<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation</title>
<!--Generated on Mon Jul 15 13:30:23 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="lifelong sequence modeling,  multi-modal retrieval" lang="en" name="keywords"/>
<base href="/html/2407.10714v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S1" title="In SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S2" title="In SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S2.SS1" title="In 2. Related Work ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Long-Term Lifelong User Behavior Modeling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S2.SS2" title="In 2. Related Work ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Multi-Modal Alignment in Recommendation and Item Quantization</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S3" title="In SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Proposed Model</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S3.SS1" title="In 3. Proposed Model ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Problem Formulation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S3.SS2" title="In 3. Proposed Model ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Aligned Lifelong Sequence of Multi-Modal Query-Item Pairs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S3.SS3" title="In 3. Proposed Model ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>SEMINAR Model Architecture</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S3.SS3.SSS1" title="In 3.3. SEMINAR Model Architecture ‣ 3. Proposed Model ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.1 </span>Pretraining Search Unit</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S3.SS3.SSS1.Px1" title="In 3.3.1. Pretraining Search Unit ‣ 3.3. SEMINAR Model Architecture ‣ 3. Proposed Model ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title">Next Pair Prediction and Multi-Head Target Attention</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S3.SS3.SSS1.Px2" title="In 3.3.1. Pretraining Search Unit ‣ 3.3. SEMINAR Model Architecture ‣ 3. Proposed Model ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title">Multi-Modal Alignment and Query-Item Relevance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S3.SS3.SSS1.Px3" title="In 3.3.1. Pretraining Search Unit ‣ 3.3. SEMINAR Model Architecture ‣ 3. Proposed Model ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title">Loss of Pretraining Search Unit</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S3.SS3.SSS2" title="In 3.3. SEMINAR Model Architecture ‣ 3. Proposed Model ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.2 </span>Fine-tuning the projection weight</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S3.SS3.SSS3" title="In 3.3. SEMINAR Model Architecture ‣ 3. Proposed Model ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.3 </span>Approximate Retrieval of Multi-Modal Query-Item Pair</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S4" title="In SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S4.SS1" title="In 4. Experiment ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental Settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S4.SS2" title="In 4. Experiment ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Experimental Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S4.SS2.SSS1" title="In 4.2. Experimental Results ‣ 4. Experiment ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.1 </span>Lifelong User Behavior Modeling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S4.SS2.SSS2" title="In 4.2. Experimental Results ‣ 4. Experiment ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.2 </span>Multi-Modal Query-Item Pairs Approximate Retrieval</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S4.SS3" title="In 4. Experiment ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Discussion and Ablation Study</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S4.SS3.SSS1" title="In 4.3. Discussion and Ablation Study ‣ 4. Experiment ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.1 </span>Influence of Pretraining Epochs Number and Ablation of Pretraining Tasks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S4.SS3.SSS2" title="In 4.3. Discussion and Ablation Study ‣ 4. Experiment ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.2 </span>Query-Item Representation Fusion Weight</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S5" title="In SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Kaiming Shen
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Ant Group</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id3.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:kaiming.skm@antgroup.com">kaiming.skm@antgroup.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xichen Ding
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.1.id1">Ant Group</span><span class="ltx_text ltx_affiliation_city" id="id5.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id6.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:xichen.dxc@antgroup.com">xichen.dxc@antgroup.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zixiang Zheng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">Ant Group</span><span class="ltx_text ltx_affiliation_city" id="id8.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id9.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zhengzixiang.zzx@antgroup.com">zhengzixiang.zzx@antgroup.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yuqi Gong
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id10.1.id1">Ant Group</span><span class="ltx_text ltx_affiliation_city" id="id11.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id12.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:gongyuqi.gyq@antgroup.com">gongyuqi.gyq@antgroup.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Qianqian Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id13.1.id1">Ant Group</span><span class="ltx_text ltx_affiliation_city" id="id14.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id15.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zixi.lqq@antgroup.com">zixi.lqq@antgroup.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhongyi Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id16.1.id1">Ant Group</span><span class="ltx_text ltx_affiliation_city" id="id17.2.id2">Hangzhou</span><span class="ltx_text ltx_affiliation_country" id="id18.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zhongyi.lzy@antgroup.com">zhongyi.lzy@antgroup.com</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Guannan Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id19.1.id1">Ant Group</span><span class="ltx_text ltx_affiliation_city" id="id20.2.id2">Hangzhou</span><span class="ltx_text ltx_affiliation_country" id="id21.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zgn138592@antgroup.com">zgn138592@antgroup.com</a>
</span></span></span>
</div>
<div class="ltx_dates">(2018)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id22.id1">The modeling of users’ behaviors is crucial in modern recommendation systems. A lot of research focuses on modeling users’ lifelong sequences, which can be extremely long and sometimes exceed thousands of items. These models use the target item to search for the most relevant items from the historical sequence. However, training lifelong sequences in click through rate (CTR) prediction or personalized search ranking (PSR) is extremely difficult due to the insufficient learning problem of ID embedding, especially when the IDs in the lifelong sequence features do not exist in the samples of training dataset. Additionally, existing target attention mechanisms struggle to learn the multi-modal representations of items in the sequence well. The distribution of multi-modal embedding (text, image and attributes) output of user’s interacted items are not properly aligned and there exist divergence across modalities. We also observe that users’ search query sequences and item browsing sequences can fully depict users’ intents and benefit from each other. To address these challenges, we propose a unified lifelong multi-modal sequence model called SEMINAR-Search Enhanced Multi-Modal Interest Network and Approximate Retrieval. Specifically, a network called Pretraining Search Unit (PSU) learns the lifelong sequences of multi-modal query-item pairs in a pretraining-finetuning manner with multiple objectives: multi-modal alignment, next query-item pair prediction, query-item relevance prediction, etc. After pretraining, the downstream model, which shares the same target attention structure with PSU, restores the pretrained embedding as initialization and finetunes the network. To accelerate the online retrieval speed of multi-modal embedding, we propose a multi-modal codebook-based product quantization strategy to approximate the exact attention calculation and significantly reduce the time complexity.</p>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id23.id1">The modeling of users’ behaviors is crucial in modern recommendation systems. A lot of research focuses on modeling users’ lifelong sequences, which can be extremely long and sometimes exceed thousands of items. These models use the target item to search for the most relevant items from the historical sequence. However, training lifelong sequences in click through rate (CTR) prediction or personalized search ranking (PSR) is extremely difficult due to the insufficient learning problem of ID embedding, especially when the IDs in the lifelong sequence features do not exist in the samples of training dataset. Additionally, existing target attention mechanisms struggle to learn the multi-modal representations of items in the sequence well. The distribution of multi-modal embedding (text, image and attributes) output of user’s interacted items are not properly aligned and there exist divergence across modalities. We also observe that users’ search query sequences and item browsing sequences can fully depict users’ intents and benefit from each other. To address these challenges, we propose a unified lifelong multi-modal sequence model called SEMINAR-Search Enhanced Multi-Modal Interest Network and Approximate Retrieval. Specifically, a network called Pretraining Search Unit (PSU) learns the lifelong sequences of multi-modal query-item pairs in a pretraining-finetuning manner with multiple objectives: multi-modal alignment, next query-item pair prediction, query-item relevance prediction, etc. After pretraining, the downstream model, which shares the same target attention structure with PSU, restores the pretrained embedding as initialization and finetunes the network. To accelerate the online retrieval speed of multi-modal embedding, we propose a multi-modal codebook-based product quantization strategy to approximate the exact attention calculation and significantly reduce the time complexity.</p>
</div>
<div class="ltx_keywords">lifelong sequence modeling, multi-modal retrieval
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmcopyright</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2018</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/1122445.1122456</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Woodstock ’18: ACM Symposium on Neural
Gaze Detection; June 03–05, 2018; Woodstock, NY</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>Woodstock ’18: ACM Symposium on Neural Gaze Detection,
June 03–05, 2018, Woodstock, NY</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_price" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">price: </span>15.00</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-XXXX-X/18/06</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id8"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommender systems</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id9"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Data mining</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.2">Users’ behavior modeling is extremely important in modern commercial recommendation systems, including online e-commerce platforms such as Amazon, Taobao, Alipay, and content platforms such as YouTube, TikTok, etc. As users spend more time on online shopping and watching short videos, the length of users’ historical behaviors has grown dramatically from a few hundreds (<math alttext="10^{2}" class="ltx_Math" display="inline" id="S1.p1.1.m1.1"><semantics id="S1.p1.1.m1.1a"><msup id="S1.p1.1.m1.1.1" xref="S1.p1.1.m1.1.1.cmml"><mn id="S1.p1.1.m1.1.1.2" xref="S1.p1.1.m1.1.1.2.cmml">10</mn><mn id="S1.p1.1.m1.1.1.3" xref="S1.p1.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S1.p1.1.m1.1b"><apply id="S1.p1.1.m1.1.1.cmml" xref="S1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p1.1.m1.1.1.1.cmml" xref="S1.p1.1.m1.1.1">superscript</csymbol><cn id="S1.p1.1.m1.1.1.2.cmml" type="integer" xref="S1.p1.1.m1.1.1.2">10</cn><cn id="S1.p1.1.m1.1.1.3.cmml" type="integer" xref="S1.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.1.m1.1c">10^{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p1.1.m1.1d">10 start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>) to more than ten-thousands (<math alttext="10^{4}" class="ltx_Math" display="inline" id="S1.p1.2.m2.1"><semantics id="S1.p1.2.m2.1a"><msup id="S1.p1.2.m2.1.1" xref="S1.p1.2.m2.1.1.cmml"><mn id="S1.p1.2.m2.1.1.2" xref="S1.p1.2.m2.1.1.2.cmml">10</mn><mn id="S1.p1.2.m2.1.1.3" xref="S1.p1.2.m2.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="S1.p1.2.m2.1b"><apply id="S1.p1.2.m2.1.1.cmml" xref="S1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p1.2.m2.1.1.1.cmml" xref="S1.p1.2.m2.1.1">superscript</csymbol><cn id="S1.p1.2.m2.1.1.2.cmml" type="integer" xref="S1.p1.2.m2.1.1.2">10</cn><cn id="S1.p1.2.m2.1.1.3.cmml" type="integer" xref="S1.p1.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.2.m2.1c">10^{4}</annotation><annotation encoding="application/x-llamapun" id="S1.p1.2.m2.1d">10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math>) in recent years. A lot of recent research focuses on modeling users’ lifelong behaviors, such as Efficient Target Attention (ETA) <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib4" title="">2022</a>)</cite>, Two-Stage Interest Network (TWIN) <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib3" title="">2023</a>)</cite>, Query-Dominant Interest Network (QIN) <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib9" title="">2023</a>)</cite>, etc. These models follow a cascading two-stage paradigm, which first uses the target item or target search query as a trigger to retrieve the top-K relevant behaviors from historical behaviors. In the second stage, it uses target attention to encode the selected behaviors as users’ interest representation. This paradigm is widely adopted in many search and recommendation tasks, such as click
through rate (CTR) prediction and personalized search ranking. The item representations in the sequence are computed using both the item ID feature and more generic attributes’ features. One easily neglected problem in existing lifelong behavior modeling is the insufficient learning problem of ID features in the lifelong sequence, such as historical item ID, author ID, etc. Many historical items in the lifelong sequence can’t be found in the current training dataset, which is collected from the most recent logs of exposures and clicks. These low frequency ID embeddings can’t be learned well by the limited dataset after being randomly initialized, which will harm the accuracy of target attention calculation.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">The second problem in existing lifelong sequence modeling is that it can’t handle multi-modal features of items in the sequence well, such as text and image features. The norm values of vectors from different modalities vary if the modalities are not properly aligned in the same embedding space. Existing target item attention calculation uses the inner product of query and keys, which may be dominated by modality vectors with large norm values. For example, the target item will only retrieve the top-K visually relevant but semantically very different items from historical behaviors, which will deteriorate the online performance of recommendation.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.4">To tackle these problems, we propose a new model called Search Enhanced Multi-Modal Interest Network and Approximate Retrieval (SEMINAR) to model users’ lifelong historical multi-modal behaviors. The users’ historical behaviors include heterogeneous behaviors of both the sequence of browsing item and the sequence of search query. We align users’ search query sequence with browsing item sequence together as a unified sequence of query-item pairs, which can be retrieved flexibly by target item or target search query in both the CTR prediction task and Personalized Search Ranking (PSR) task. SEMINAR proposes a Pretraining Search Unit (PSU) network to learn the lifelong behavior sequence of historical multi-modal query-item pairs. It introduces multiple pretraining tasks designed to solve the insufficient learning issue of historical ID features and the multi-modal alignment. In downstream tasks, the target attention module restores the learned item representations from PSU, using the pretrained ID embedding as initialization, and applies a projection weight matrix to get the transformed representation of the behavior sequence.
During online serving, calculating exact attention using the inner product of multi-modal vectors in the lifelong sequence has the time complexity of <math alttext="O(L\times M\times d)" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><mrow id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml"><mi id="S1.p3.1.m1.1.1.3" xref="S1.p3.1.m1.1.1.3.cmml">O</mi><mo id="S1.p3.1.m1.1.1.2" xref="S1.p3.1.m1.1.1.2.cmml">⁢</mo><mrow id="S1.p3.1.m1.1.1.1.1" xref="S1.p3.1.m1.1.1.1.1.1.cmml"><mo id="S1.p3.1.m1.1.1.1.1.2" stretchy="false" xref="S1.p3.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S1.p3.1.m1.1.1.1.1.1" xref="S1.p3.1.m1.1.1.1.1.1.cmml"><mi id="S1.p3.1.m1.1.1.1.1.1.2" xref="S1.p3.1.m1.1.1.1.1.1.2.cmml">L</mi><mo id="S1.p3.1.m1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S1.p3.1.m1.1.1.1.1.1.1.cmml">×</mo><mi id="S1.p3.1.m1.1.1.1.1.1.3" xref="S1.p3.1.m1.1.1.1.1.1.3.cmml">M</mi><mo id="S1.p3.1.m1.1.1.1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S1.p3.1.m1.1.1.1.1.1.1.cmml">×</mo><mi id="S1.p3.1.m1.1.1.1.1.1.4" xref="S1.p3.1.m1.1.1.1.1.1.4.cmml">d</mi></mrow><mo id="S1.p3.1.m1.1.1.1.1.3" stretchy="false" xref="S1.p3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><apply id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1"><times id="S1.p3.1.m1.1.1.2.cmml" xref="S1.p3.1.m1.1.1.2"></times><ci id="S1.p3.1.m1.1.1.3.cmml" xref="S1.p3.1.m1.1.1.3">𝑂</ci><apply id="S1.p3.1.m1.1.1.1.1.1.cmml" xref="S1.p3.1.m1.1.1.1.1"><times id="S1.p3.1.m1.1.1.1.1.1.1.cmml" xref="S1.p3.1.m1.1.1.1.1.1.1"></times><ci id="S1.p3.1.m1.1.1.1.1.1.2.cmml" xref="S1.p3.1.m1.1.1.1.1.1.2">𝐿</ci><ci id="S1.p3.1.m1.1.1.1.1.1.3.cmml" xref="S1.p3.1.m1.1.1.1.1.1.3">𝑀</ci><ci id="S1.p3.1.m1.1.1.1.1.1.4.cmml" xref="S1.p3.1.m1.1.1.1.1.1.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">O(L\times M\times d)</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">italic_O ( italic_L × italic_M × italic_d )</annotation></semantics></math>, which is time consuming. <math alttext="L" class="ltx_Math" display="inline" id="S1.p3.2.m2.1"><semantics id="S1.p3.2.m2.1a"><mi id="S1.p3.2.m2.1.1" xref="S1.p3.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S1.p3.2.m2.1b"><ci id="S1.p3.2.m2.1.1.cmml" xref="S1.p3.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S1.p3.2.m2.1d">italic_L</annotation></semantics></math> denotes the sequence length, <math alttext="M" class="ltx_Math" display="inline" id="S1.p3.3.m3.1"><semantics id="S1.p3.3.m3.1a"><mi id="S1.p3.3.m3.1.1" xref="S1.p3.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S1.p3.3.m3.1b"><ci id="S1.p3.3.m3.1.1.cmml" xref="S1.p3.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.3.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="S1.p3.3.m3.1d">italic_M</annotation></semantics></math> denotes the number of modalities and <math alttext="d" class="ltx_Math" display="inline" id="S1.p3.4.m4.1"><semantics id="S1.p3.4.m4.1a"><mi id="S1.p3.4.m4.1.1" xref="S1.p3.4.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S1.p3.4.m4.1b"><ci id="S1.p3.4.m4.1.1.cmml" xref="S1.p3.4.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.4.m4.1c">d</annotation><annotation encoding="application/x-llamapun" id="S1.p3.4.m4.1d">italic_d</annotation></semantics></math> denotes the embedding dimension.
Different from existing approximate retrieval methods, such as Locally Sensitive Hash (LSH) and Hierarchical Navigable Small World (HNSW), we exploit an approximate strategy of Product Quantization in a multi-modal setting and express the multi-modal item representations as discrete integer codes using the quantization codebooks, and sum the inner product of centroids in sub-vectors to approximate the exact attention calculation. During online serving, the attention calculation is equivalent to pre-computed distance table lookup and summation operations, which can be conducted efficiently.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In summary, the main contributions of our work are as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We identify the insufficient learning problem of ID features in lifelong behavior modeling and observe that target attention calculation is dominated by multi-modal features with large norm values. And we novelly propose SEMINAR framework, which includes the Pretraining Search Unit to effectively alleviate the insufficient learning problems of ID embedding and multi-modal alignment.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We exploit a product quantization approximation strategy in a multi-modal setting, which can reduce the time complexity during online serving of retrieval using target query item pair from historical behaviors.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We conduct extensive experiments on real-world datasets to demonstrate the effectiveness of our proposed model. And we also released the code of SEMINAR in this repository <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/paper-submission-coder/SEMINAR" title="">https://github.com/paper-submission-coder/SEMINAR</a></span></span></span> to encourage further research.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="443" id="S2.F1.g1" src="x1.png" width="885"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>Illustration of SEMINAR Model Architecture. <math alttext="S_{i}" class="ltx_Math" display="inline" id="S2.F1.2.m1.1"><semantics id="S2.F1.2.m1.1b"><msub id="S2.F1.2.m1.1.1" xref="S2.F1.2.m1.1.1.cmml"><mi id="S2.F1.2.m1.1.1.2" xref="S2.F1.2.m1.1.1.2.cmml">S</mi><mi id="S2.F1.2.m1.1.1.3" xref="S2.F1.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F1.2.m1.1c"><apply id="S2.F1.2.m1.1.1.cmml" xref="S2.F1.2.m1.1.1"><csymbol cd="ambiguous" id="S2.F1.2.m1.1.1.1.cmml" xref="S2.F1.2.m1.1.1">subscript</csymbol><ci id="S2.F1.2.m1.1.1.2.cmml" xref="S2.F1.2.m1.1.1.2">𝑆</ci><ci id="S2.F1.2.m1.1.1.3.cmml" xref="S2.F1.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.2.m1.1d">S_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.F1.2.m1.1e">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denotes the i-th behavior of query and item pair in the lifelong sequence. Each behavior has multiple channels of query and multi-modal features of text, image and attributes. PSU denotes the pretraining search unit. GSU and ESU denote the general and exact search unit respectively as the two stage paradigm. </figcaption>
</figure>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Long-Term Lifelong User Behavior Modeling</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Long-term lifelong user behavior modeling has attracted much research attention in recent years. Typical works include SIM <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib13" title="">2020</a>)</cite>, ETA <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib4" title="">2022</a>)</cite>, TWIN <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib3" title="">2023</a>)</cite>, QIN <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib9" title="">2023</a>)</cite>, etc. SIM <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib13" title="">2020</a>)</cite> introduces the General Search Unit to retrieve the top-K most relevant items from historical behaviors using the target item as a trigger, and the Exact Search Unit (ESU) to calculate the multi-head target attention (MHTA). ETA <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib4" title="">2022</a>)</cite> uses a set of hash functions to express the item representation as binary hash embedding and calculates the Hamming distance to approximate the inner product calculation. TWIN <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib3" title="">2023</a>)</cite> introduces the CP-GSU as a consistency-preserved lifelong user behavior modeling module to increase the relevance calculation consistency between the two cascading stages. QIN <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib9" title="">2023</a>)</cite> uses the search query as a trigger to retrieve the most relevant items from the historical behaviors in the first stage of the cascading models in Personalized Search Ranking. Different from the existing work, we propose the pretraining search unit (PSU) to alleviate the insufficient learning problem of ID features and multi-modal alignment in attention calculation. Furthermore, there is an increasing trend of modeling search and recommendation tasks jointly in a unified framework, such as USER <cite class="ltx_cite ltx_citemacro_citep">(Yao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib20" title="">2021</a>)</cite>, SESRec <cite class="ltx_cite ltx_citemacro_citep">(Si et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib16" title="">2023</a>)</cite>, S&amp;R Foundation <cite class="ltx_cite ltx_citemacro_citep">(Gong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib8" title="">2023</a>)</cite>, etc. To model the lifelong behaviors, we align the historical search query sequence and browsing item sequence as a unified sequence of query-item pairs, which can be applied to both CTR prediction in recommendation and personalized search ranking.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Multi-Modal Alignment in Recommendation and Item Quantization</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Multi-modal alignment is a prevalent topic, which aligns the multi-modal features such as text and image in a unified embedding space in a contrastive learning manner. Typical works include CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib14" title="">2021</a>)</cite>, etc. Some researchers have focused on modeling multi-modal user sequences in recommendation. M5 <cite class="ltx_cite ltx_citemacro_citep">(Zhao, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib22" title="">2023</a>)</cite> applies a multi-modal embedding layer to extract both ID embeddings of show ID and content-graph embeddings initialized from a meta-path pretrained model. To better increase the generalization of ID embeddings, some research is proposed to express item representations as quantized vectors in discrete codes, including Product Quantization <cite class="ltx_cite ltx_citemacro_citep">(Jégou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib11" title="">2011</a>)</cite>, VQ-VAE <cite class="ltx_cite ltx_citemacro_citep">(van den Oord et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib18" title="">2017</a>)</cite>, RQ-VAE <cite class="ltx_cite ltx_citemacro_citep">(Zeghidour et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib21" title="">2021</a>)</cite>, etc. VQ-Rec <cite class="ltx_cite ltx_citemacro_citep">(Hou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib10" title="">2023</a>)</cite> proposes to encode text as discrete codes using product quantization techniques and use transformer to learn cross-domain data in recommendation. TIGER <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib15" title="">2023</a>)</cite> learns the semantic ID from the content information and learns RQ-VAE <cite class="ltx_cite ltx_citemacro_citep">(Zeghidour et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib21" title="">2021</a>)</cite> representations for generative retrieval.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.10">Much research focuses on making fast retrieval of relevant items from an embedding database. Common methods include approximate nearest neighbor (ANN) search using HNSW <cite class="ltx_cite ltx_citemacro_citep">(Malkov and Yashunin, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib12" title="">2018</a>)</cite>, Product Quantization <cite class="ltx_cite ltx_citemacro_citep">(Jégou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib11" title="">2011</a>)</cite>, etc. Product quantization is a technique to transform a d-dimensional vector to a low-dimensional N-bit integer vector of centroid ids in the codebook. It first splits a vector <math alttext="\mathbb{x}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1"><semantics id="S2.SS2.p2.1.m1.1a"><mrow id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">𝕩</mi><mo id="S2.SS2.p2.1.m1.1.1.1" xref="S2.SS2.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml"><mi id="S2.SS2.p2.1.m1.1.1.3.2" xref="S2.SS2.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS2.p2.1.m1.1.1.3.3" xref="S2.SS2.p2.1.m1.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><in id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1.1"></in><ci id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2">𝕩</ci><apply id="S2.SS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.3.1.cmml" xref="S2.SS2.p2.1.m1.1.1.3">superscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.3.2.cmml" xref="S2.SS2.p2.1.m1.1.1.3.2">ℝ</ci><ci id="S2.SS2.p2.1.m1.1.1.3.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">\mathbb{x}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">blackboard_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> into <math alttext="N_{bit}" class="ltx_Math" display="inline" id="S2.SS2.p2.2.m2.1"><semantics id="S2.SS2.p2.2.m2.1a"><msub id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml">N</mi><mrow id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml"><mi id="S2.SS2.p2.2.m2.1.1.3.2" xref="S2.SS2.p2.2.m2.1.1.3.2.cmml">b</mi><mo id="S2.SS2.p2.2.m2.1.1.3.1" xref="S2.SS2.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.2.m2.1.1.3.3" xref="S2.SS2.p2.2.m2.1.1.3.3.cmml">i</mi><mo id="S2.SS2.p2.2.m2.1.1.3.1a" xref="S2.SS2.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.2.m2.1.1.3.4" xref="S2.SS2.p2.2.m2.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">𝑁</ci><apply id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3"><times id="S2.SS2.p2.2.m2.1.1.3.1.cmml" xref="S2.SS2.p2.2.m2.1.1.3.1"></times><ci id="S2.SS2.p2.2.m2.1.1.3.2.cmml" xref="S2.SS2.p2.2.m2.1.1.3.2">𝑏</ci><ci id="S2.SS2.p2.2.m2.1.1.3.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3.3">𝑖</ci><ci id="S2.SS2.p2.2.m2.1.1.3.4.cmml" xref="S2.SS2.p2.2.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">N_{bit}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.1d">italic_N start_POSTSUBSCRIPT italic_b italic_i italic_t end_POSTSUBSCRIPT</annotation></semantics></math> sub-vectors and applies quantization function <math alttext="q(x)" class="ltx_Math" display="inline" id="S2.SS2.p2.3.m3.1"><semantics id="S2.SS2.p2.3.m3.1a"><mrow id="S2.SS2.p2.3.m3.1.2" xref="S2.SS2.p2.3.m3.1.2.cmml"><mi id="S2.SS2.p2.3.m3.1.2.2" xref="S2.SS2.p2.3.m3.1.2.2.cmml">q</mi><mo id="S2.SS2.p2.3.m3.1.2.1" xref="S2.SS2.p2.3.m3.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.p2.3.m3.1.2.3.2" xref="S2.SS2.p2.3.m3.1.2.cmml"><mo id="S2.SS2.p2.3.m3.1.2.3.2.1" stretchy="false" xref="S2.SS2.p2.3.m3.1.2.cmml">(</mo><mi id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml">x</mi><mo id="S2.SS2.p2.3.m3.1.2.3.2.2" stretchy="false" xref="S2.SS2.p2.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.2.cmml" xref="S2.SS2.p2.3.m3.1.2"><times id="S2.SS2.p2.3.m3.1.2.1.cmml" xref="S2.SS2.p2.3.m3.1.2.1"></times><ci id="S2.SS2.p2.3.m3.1.2.2.cmml" xref="S2.SS2.p2.3.m3.1.2.2">𝑞</ci><ci id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">q(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m3.1d">italic_q ( italic_x )</annotation></semantics></math> to assign each sub-vector <math alttext="\mathbb{x}_{i}" class="ltx_Math" display="inline" id="S2.SS2.p2.4.m4.1"><semantics id="S2.SS2.p2.4.m4.1a"><msub id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><mi id="S2.SS2.p2.4.m4.1.1.2" xref="S2.SS2.p2.4.m4.1.1.2.cmml">𝕩</mi><mi id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2">𝕩</ci><ci id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">\mathbb{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.4.m4.1d">blackboard_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to the nearest centroid <math alttext="c_{i}" class="ltx_Math" display="inline" id="S2.SS2.p2.5.m5.1"><semantics id="S2.SS2.p2.5.m5.1a"><msub id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml"><mi id="S2.SS2.p2.5.m5.1.1.2" xref="S2.SS2.p2.5.m5.1.1.2.cmml">c</mi><mi id="S2.SS2.p2.5.m5.1.1.3" xref="S2.SS2.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><apply id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m5.1.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p2.5.m5.1.1.2.cmml" xref="S2.SS2.p2.5.m5.1.1.2">𝑐</ci><ci id="S2.SS2.p2.5.m5.1.1.3.cmml" xref="S2.SS2.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.5.m5.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> from a codebook <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="S2.SS2.p2.6.m6.1"><semantics id="S2.SS2.p2.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.6.m6.1.1" xref="S2.SS2.p2.6.m6.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m6.1b"><ci id="S2.SS2.p2.6.m6.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m6.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.6.m6.1d">caligraphic_C</annotation></semantics></math> as <math alttext="\mathbb{x}=[\mathbb{x}_{i}]_{1:N_{bit}}\rightarrow[q(\mathbb{x}_{i})]_{1:N_{%
bit}}=[c_{i}]_{1:N_{bit}}" class="ltx_Math" display="inline" id="S2.SS2.p2.7.m7.3"><semantics id="S2.SS2.p2.7.m7.3a"><mrow id="S2.SS2.p2.7.m7.3.3" xref="S2.SS2.p2.7.m7.3.3.cmml"><mi id="S2.SS2.p2.7.m7.3.3.5" xref="S2.SS2.p2.7.m7.3.3.5.cmml">𝕩</mi><mo id="S2.SS2.p2.7.m7.3.3.6" xref="S2.SS2.p2.7.m7.3.3.6.cmml">=</mo><msub id="S2.SS2.p2.7.m7.1.1.1" xref="S2.SS2.p2.7.m7.1.1.1.cmml"><mrow id="S2.SS2.p2.7.m7.1.1.1.1.1" xref="S2.SS2.p2.7.m7.1.1.1.1.2.cmml"><mo id="S2.SS2.p2.7.m7.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p2.7.m7.1.1.1.1.2.1.cmml">[</mo><msub id="S2.SS2.p2.7.m7.1.1.1.1.1.1" xref="S2.SS2.p2.7.m7.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.7.m7.1.1.1.1.1.1.2" xref="S2.SS2.p2.7.m7.1.1.1.1.1.1.2.cmml">𝕩</mi><mi id="S2.SS2.p2.7.m7.1.1.1.1.1.1.3" xref="S2.SS2.p2.7.m7.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS2.p2.7.m7.1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p2.7.m7.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S2.SS2.p2.7.m7.1.1.1.3" xref="S2.SS2.p2.7.m7.1.1.1.3.cmml"><mn id="S2.SS2.p2.7.m7.1.1.1.3.2" xref="S2.SS2.p2.7.m7.1.1.1.3.2.cmml">1</mn><mo id="S2.SS2.p2.7.m7.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS2.p2.7.m7.1.1.1.3.1.cmml">:</mo><msub id="S2.SS2.p2.7.m7.1.1.1.3.3" xref="S2.SS2.p2.7.m7.1.1.1.3.3.cmml"><mi id="S2.SS2.p2.7.m7.1.1.1.3.3.2" xref="S2.SS2.p2.7.m7.1.1.1.3.3.2.cmml">N</mi><mrow id="S2.SS2.p2.7.m7.1.1.1.3.3.3" xref="S2.SS2.p2.7.m7.1.1.1.3.3.3.cmml"><mi id="S2.SS2.p2.7.m7.1.1.1.3.3.3.2" xref="S2.SS2.p2.7.m7.1.1.1.3.3.3.2.cmml">b</mi><mo id="S2.SS2.p2.7.m7.1.1.1.3.3.3.1" xref="S2.SS2.p2.7.m7.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.7.m7.1.1.1.3.3.3.3" xref="S2.SS2.p2.7.m7.1.1.1.3.3.3.3.cmml">i</mi><mo id="S2.SS2.p2.7.m7.1.1.1.3.3.3.1a" xref="S2.SS2.p2.7.m7.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.7.m7.1.1.1.3.3.3.4" xref="S2.SS2.p2.7.m7.1.1.1.3.3.3.4.cmml">t</mi></mrow></msub></mrow></msub><mo id="S2.SS2.p2.7.m7.3.3.7" stretchy="false" xref="S2.SS2.p2.7.m7.3.3.7.cmml">→</mo><msub id="S2.SS2.p2.7.m7.2.2.2" xref="S2.SS2.p2.7.m7.2.2.2.cmml"><mrow id="S2.SS2.p2.7.m7.2.2.2.1.1" xref="S2.SS2.p2.7.m7.2.2.2.1.2.cmml"><mo id="S2.SS2.p2.7.m7.2.2.2.1.1.2" stretchy="false" xref="S2.SS2.p2.7.m7.2.2.2.1.2.1.cmml">[</mo><mrow id="S2.SS2.p2.7.m7.2.2.2.1.1.1" xref="S2.SS2.p2.7.m7.2.2.2.1.1.1.cmml"><mi id="S2.SS2.p2.7.m7.2.2.2.1.1.1.3" xref="S2.SS2.p2.7.m7.2.2.2.1.1.1.3.cmml">q</mi><mo id="S2.SS2.p2.7.m7.2.2.2.1.1.1.2" xref="S2.SS2.p2.7.m7.2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p2.7.m7.2.2.2.1.1.1.1.1" xref="S2.SS2.p2.7.m7.2.2.2.1.1.1.1.1.1.cmml"><mo id="S2.SS2.p2.7.m7.2.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p2.7.m7.2.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS2.p2.7.m7.2.2.2.1.1.1.1.1.1" xref="S2.SS2.p2.7.m7.2.2.2.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.7.m7.2.2.2.1.1.1.1.1.1.2" xref="S2.SS2.p2.7.m7.2.2.2.1.1.1.1.1.1.2.cmml">𝕩</mi><mi id="S2.SS2.p2.7.m7.2.2.2.1.1.1.1.1.1.3" xref="S2.SS2.p2.7.m7.2.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS2.p2.7.m7.2.2.2.1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p2.7.m7.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p2.7.m7.2.2.2.1.1.3" stretchy="false" xref="S2.SS2.p2.7.m7.2.2.2.1.2.1.cmml">]</mo></mrow><mrow id="S2.SS2.p2.7.m7.2.2.2.3" xref="S2.SS2.p2.7.m7.2.2.2.3.cmml"><mn id="S2.SS2.p2.7.m7.2.2.2.3.2" xref="S2.SS2.p2.7.m7.2.2.2.3.2.cmml">1</mn><mo id="S2.SS2.p2.7.m7.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS2.p2.7.m7.2.2.2.3.1.cmml">:</mo><msub id="S2.SS2.p2.7.m7.2.2.2.3.3" xref="S2.SS2.p2.7.m7.2.2.2.3.3.cmml"><mi id="S2.SS2.p2.7.m7.2.2.2.3.3.2" xref="S2.SS2.p2.7.m7.2.2.2.3.3.2.cmml">N</mi><mrow id="S2.SS2.p2.7.m7.2.2.2.3.3.3" xref="S2.SS2.p2.7.m7.2.2.2.3.3.3.cmml"><mi id="S2.SS2.p2.7.m7.2.2.2.3.3.3.2" xref="S2.SS2.p2.7.m7.2.2.2.3.3.3.2.cmml">b</mi><mo id="S2.SS2.p2.7.m7.2.2.2.3.3.3.1" xref="S2.SS2.p2.7.m7.2.2.2.3.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.7.m7.2.2.2.3.3.3.3" xref="S2.SS2.p2.7.m7.2.2.2.3.3.3.3.cmml">i</mi><mo id="S2.SS2.p2.7.m7.2.2.2.3.3.3.1a" xref="S2.SS2.p2.7.m7.2.2.2.3.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.7.m7.2.2.2.3.3.3.4" xref="S2.SS2.p2.7.m7.2.2.2.3.3.3.4.cmml">t</mi></mrow></msub></mrow></msub><mo id="S2.SS2.p2.7.m7.3.3.8" xref="S2.SS2.p2.7.m7.3.3.8.cmml">=</mo><msub id="S2.SS2.p2.7.m7.3.3.3" xref="S2.SS2.p2.7.m7.3.3.3.cmml"><mrow id="S2.SS2.p2.7.m7.3.3.3.1.1" xref="S2.SS2.p2.7.m7.3.3.3.1.2.cmml"><mo id="S2.SS2.p2.7.m7.3.3.3.1.1.2" stretchy="false" xref="S2.SS2.p2.7.m7.3.3.3.1.2.1.cmml">[</mo><msub id="S2.SS2.p2.7.m7.3.3.3.1.1.1" xref="S2.SS2.p2.7.m7.3.3.3.1.1.1.cmml"><mi id="S2.SS2.p2.7.m7.3.3.3.1.1.1.2" xref="S2.SS2.p2.7.m7.3.3.3.1.1.1.2.cmml">c</mi><mi id="S2.SS2.p2.7.m7.3.3.3.1.1.1.3" xref="S2.SS2.p2.7.m7.3.3.3.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS2.p2.7.m7.3.3.3.1.1.3" stretchy="false" xref="S2.SS2.p2.7.m7.3.3.3.1.2.1.cmml">]</mo></mrow><mrow id="S2.SS2.p2.7.m7.3.3.3.3" xref="S2.SS2.p2.7.m7.3.3.3.3.cmml"><mn id="S2.SS2.p2.7.m7.3.3.3.3.2" xref="S2.SS2.p2.7.m7.3.3.3.3.2.cmml">1</mn><mo id="S2.SS2.p2.7.m7.3.3.3.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS2.p2.7.m7.3.3.3.3.1.cmml">:</mo><msub id="S2.SS2.p2.7.m7.3.3.3.3.3" xref="S2.SS2.p2.7.m7.3.3.3.3.3.cmml"><mi id="S2.SS2.p2.7.m7.3.3.3.3.3.2" xref="S2.SS2.p2.7.m7.3.3.3.3.3.2.cmml">N</mi><mrow id="S2.SS2.p2.7.m7.3.3.3.3.3.3" xref="S2.SS2.p2.7.m7.3.3.3.3.3.3.cmml"><mi id="S2.SS2.p2.7.m7.3.3.3.3.3.3.2" xref="S2.SS2.p2.7.m7.3.3.3.3.3.3.2.cmml">b</mi><mo id="S2.SS2.p2.7.m7.3.3.3.3.3.3.1" xref="S2.SS2.p2.7.m7.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.7.m7.3.3.3.3.3.3.3" xref="S2.SS2.p2.7.m7.3.3.3.3.3.3.3.cmml">i</mi><mo id="S2.SS2.p2.7.m7.3.3.3.3.3.3.1a" xref="S2.SS2.p2.7.m7.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.7.m7.3.3.3.3.3.3.4" xref="S2.SS2.p2.7.m7.3.3.3.3.3.3.4.cmml">t</mi></mrow></msub></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m7.3b"><apply id="S2.SS2.p2.7.m7.3.3.cmml" xref="S2.SS2.p2.7.m7.3.3"><and id="S2.SS2.p2.7.m7.3.3a.cmml" xref="S2.SS2.p2.7.m7.3.3"></and><apply id="S2.SS2.p2.7.m7.3.3b.cmml" xref="S2.SS2.p2.7.m7.3.3"><eq id="S2.SS2.p2.7.m7.3.3.6.cmml" xref="S2.SS2.p2.7.m7.3.3.6"></eq><ci id="S2.SS2.p2.7.m7.3.3.5.cmml" xref="S2.SS2.p2.7.m7.3.3.5">𝕩</ci><apply id="S2.SS2.p2.7.m7.1.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m7.1.1.1.2.cmml" xref="S2.SS2.p2.7.m7.1.1.1">subscript</csymbol><apply id="S2.SS2.p2.7.m7.1.1.1.1.2.cmml" xref="S2.SS2.p2.7.m7.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p2.7.m7.1.1.1.1.2.1.cmml" xref="S2.SS2.p2.7.m7.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS2.p2.7.m7.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m7.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.7.m7.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.7.m7.1.1.1.1.1.1.2">𝕩</ci><ci id="S2.SS2.p2.7.m7.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.7.m7.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S2.SS2.p2.7.m7.1.1.1.3.cmml" xref="S2.SS2.p2.7.m7.1.1.1.3"><ci id="S2.SS2.p2.7.m7.1.1.1.3.1.cmml" xref="S2.SS2.p2.7.m7.1.1.1.3.1">:</ci><cn id="S2.SS2.p2.7.m7.1.1.1.3.2.cmml" type="integer" xref="S2.SS2.p2.7.m7.1.1.1.3.2">1</cn><apply id="S2.SS2.p2.7.m7.1.1.1.3.3.cmml" xref="S2.SS2.p2.7.m7.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m7.1.1.1.3.3.1.cmml" xref="S2.SS2.p2.7.m7.1.1.1.3.3">subscript</csymbol><ci id="S2.SS2.p2.7.m7.1.1.1.3.3.2.cmml" xref="S2.SS2.p2.7.m7.1.1.1.3.3.2">𝑁</ci><apply id="S2.SS2.p2.7.m7.1.1.1.3.3.3.cmml" xref="S2.SS2.p2.7.m7.1.1.1.3.3.3"><times id="S2.SS2.p2.7.m7.1.1.1.3.3.3.1.cmml" xref="S2.SS2.p2.7.m7.1.1.1.3.3.3.1"></times><ci id="S2.SS2.p2.7.m7.1.1.1.3.3.3.2.cmml" xref="S2.SS2.p2.7.m7.1.1.1.3.3.3.2">𝑏</ci><ci id="S2.SS2.p2.7.m7.1.1.1.3.3.3.3.cmml" xref="S2.SS2.p2.7.m7.1.1.1.3.3.3.3">𝑖</ci><ci id="S2.SS2.p2.7.m7.1.1.1.3.3.3.4.cmml" xref="S2.SS2.p2.7.m7.1.1.1.3.3.3.4">𝑡</ci></apply></apply></apply></apply></apply><apply id="S2.SS2.p2.7.m7.3.3c.cmml" xref="S2.SS2.p2.7.m7.3.3"><ci id="S2.SS2.p2.7.m7.3.3.7.cmml" xref="S2.SS2.p2.7.m7.3.3.7">→</ci><share href="https://arxiv.org/html/2407.10714v1#S2.SS2.p2.7.m7.1.1.1.cmml" id="S2.SS2.p2.7.m7.3.3d.cmml" xref="S2.SS2.p2.7.m7.3.3"></share><apply id="S2.SS2.p2.7.m7.2.2.2.cmml" xref="S2.SS2.p2.7.m7.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m7.2.2.2.2.cmml" xref="S2.SS2.p2.7.m7.2.2.2">subscript</csymbol><apply id="S2.SS2.p2.7.m7.2.2.2.1.2.cmml" xref="S2.SS2.p2.7.m7.2.2.2.1.1"><csymbol cd="latexml" id="S2.SS2.p2.7.m7.2.2.2.1.2.1.cmml" xref="S2.SS2.p2.7.m7.2.2.2.1.1.2">delimited-[]</csymbol><apply id="S2.SS2.p2.7.m7.2.2.2.1.1.1.cmml" xref="S2.SS2.p2.7.m7.2.2.2.1.1.1"><times id="S2.SS2.p2.7.m7.2.2.2.1.1.1.2.cmml" xref="S2.SS2.p2.7.m7.2.2.2.1.1.1.2"></times><ci id="S2.SS2.p2.7.m7.2.2.2.1.1.1.3.cmml" xref="S2.SS2.p2.7.m7.2.2.2.1.1.1.3">𝑞</ci><apply id="S2.SS2.p2.7.m7.2.2.2.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.7.m7.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m7.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.7.m7.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.7.m7.2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.7.m7.2.2.2.1.1.1.1.1.1.2">𝕩</ci><ci id="S2.SS2.p2.7.m7.2.2.2.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.7.m7.2.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S2.SS2.p2.7.m7.2.2.2.3.cmml" xref="S2.SS2.p2.7.m7.2.2.2.3"><ci id="S2.SS2.p2.7.m7.2.2.2.3.1.cmml" xref="S2.SS2.p2.7.m7.2.2.2.3.1">:</ci><cn id="S2.SS2.p2.7.m7.2.2.2.3.2.cmml" type="integer" xref="S2.SS2.p2.7.m7.2.2.2.3.2">1</cn><apply id="S2.SS2.p2.7.m7.2.2.2.3.3.cmml" xref="S2.SS2.p2.7.m7.2.2.2.3.3"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m7.2.2.2.3.3.1.cmml" xref="S2.SS2.p2.7.m7.2.2.2.3.3">subscript</csymbol><ci id="S2.SS2.p2.7.m7.2.2.2.3.3.2.cmml" xref="S2.SS2.p2.7.m7.2.2.2.3.3.2">𝑁</ci><apply id="S2.SS2.p2.7.m7.2.2.2.3.3.3.cmml" xref="S2.SS2.p2.7.m7.2.2.2.3.3.3"><times id="S2.SS2.p2.7.m7.2.2.2.3.3.3.1.cmml" xref="S2.SS2.p2.7.m7.2.2.2.3.3.3.1"></times><ci id="S2.SS2.p2.7.m7.2.2.2.3.3.3.2.cmml" xref="S2.SS2.p2.7.m7.2.2.2.3.3.3.2">𝑏</ci><ci id="S2.SS2.p2.7.m7.2.2.2.3.3.3.3.cmml" xref="S2.SS2.p2.7.m7.2.2.2.3.3.3.3">𝑖</ci><ci id="S2.SS2.p2.7.m7.2.2.2.3.3.3.4.cmml" xref="S2.SS2.p2.7.m7.2.2.2.3.3.3.4">𝑡</ci></apply></apply></apply></apply></apply><apply id="S2.SS2.p2.7.m7.3.3e.cmml" xref="S2.SS2.p2.7.m7.3.3"><eq id="S2.SS2.p2.7.m7.3.3.8.cmml" xref="S2.SS2.p2.7.m7.3.3.8"></eq><share href="https://arxiv.org/html/2407.10714v1#S2.SS2.p2.7.m7.2.2.2.cmml" id="S2.SS2.p2.7.m7.3.3f.cmml" xref="S2.SS2.p2.7.m7.3.3"></share><apply id="S2.SS2.p2.7.m7.3.3.3.cmml" xref="S2.SS2.p2.7.m7.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m7.3.3.3.2.cmml" xref="S2.SS2.p2.7.m7.3.3.3">subscript</csymbol><apply id="S2.SS2.p2.7.m7.3.3.3.1.2.cmml" xref="S2.SS2.p2.7.m7.3.3.3.1.1"><csymbol cd="latexml" id="S2.SS2.p2.7.m7.3.3.3.1.2.1.cmml" xref="S2.SS2.p2.7.m7.3.3.3.1.1.2">delimited-[]</csymbol><apply id="S2.SS2.p2.7.m7.3.3.3.1.1.1.cmml" xref="S2.SS2.p2.7.m7.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m7.3.3.3.1.1.1.1.cmml" xref="S2.SS2.p2.7.m7.3.3.3.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.7.m7.3.3.3.1.1.1.2.cmml" xref="S2.SS2.p2.7.m7.3.3.3.1.1.1.2">𝑐</ci><ci id="S2.SS2.p2.7.m7.3.3.3.1.1.1.3.cmml" xref="S2.SS2.p2.7.m7.3.3.3.1.1.1.3">𝑖</ci></apply></apply><apply id="S2.SS2.p2.7.m7.3.3.3.3.cmml" xref="S2.SS2.p2.7.m7.3.3.3.3"><ci id="S2.SS2.p2.7.m7.3.3.3.3.1.cmml" xref="S2.SS2.p2.7.m7.3.3.3.3.1">:</ci><cn id="S2.SS2.p2.7.m7.3.3.3.3.2.cmml" type="integer" xref="S2.SS2.p2.7.m7.3.3.3.3.2">1</cn><apply id="S2.SS2.p2.7.m7.3.3.3.3.3.cmml" xref="S2.SS2.p2.7.m7.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m7.3.3.3.3.3.1.cmml" xref="S2.SS2.p2.7.m7.3.3.3.3.3">subscript</csymbol><ci id="S2.SS2.p2.7.m7.3.3.3.3.3.2.cmml" xref="S2.SS2.p2.7.m7.3.3.3.3.3.2">𝑁</ci><apply id="S2.SS2.p2.7.m7.3.3.3.3.3.3.cmml" xref="S2.SS2.p2.7.m7.3.3.3.3.3.3"><times id="S2.SS2.p2.7.m7.3.3.3.3.3.3.1.cmml" xref="S2.SS2.p2.7.m7.3.3.3.3.3.3.1"></times><ci id="S2.SS2.p2.7.m7.3.3.3.3.3.3.2.cmml" xref="S2.SS2.p2.7.m7.3.3.3.3.3.3.2">𝑏</ci><ci id="S2.SS2.p2.7.m7.3.3.3.3.3.3.3.cmml" xref="S2.SS2.p2.7.m7.3.3.3.3.3.3.3">𝑖</ci><ci id="S2.SS2.p2.7.m7.3.3.3.3.3.3.4.cmml" xref="S2.SS2.p2.7.m7.3.3.3.3.3.3.4">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m7.3c">\mathbb{x}=[\mathbb{x}_{i}]_{1:N_{bit}}\rightarrow[q(\mathbb{x}_{i})]_{1:N_{%
bit}}=[c_{i}]_{1:N_{bit}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.7.m7.3d">blackboard_x = [ blackboard_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] start_POSTSUBSCRIPT 1 : italic_N start_POSTSUBSCRIPT italic_b italic_i italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT → [ italic_q ( blackboard_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ] start_POSTSUBSCRIPT 1 : italic_N start_POSTSUBSCRIPT italic_b italic_i italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT = [ italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] start_POSTSUBSCRIPT 1 : italic_N start_POSTSUBSCRIPT italic_b italic_i italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>. And the quantization function is <math alttext="q(\mathbb{x}_{i})=\arg\min_{c_{i}\in\mathcal{C}}d(\mathbb{x}_{i},e_{c_{i}})" class="ltx_Math" display="inline" id="S2.SS2.p2.8.m8.3"><semantics id="S2.SS2.p2.8.m8.3a"><mrow id="S2.SS2.p2.8.m8.3.3" xref="S2.SS2.p2.8.m8.3.3.cmml"><mrow id="S2.SS2.p2.8.m8.1.1.1" xref="S2.SS2.p2.8.m8.1.1.1.cmml"><mi id="S2.SS2.p2.8.m8.1.1.1.3" xref="S2.SS2.p2.8.m8.1.1.1.3.cmml">q</mi><mo id="S2.SS2.p2.8.m8.1.1.1.2" xref="S2.SS2.p2.8.m8.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p2.8.m8.1.1.1.1.1" xref="S2.SS2.p2.8.m8.1.1.1.1.1.1.cmml"><mo id="S2.SS2.p2.8.m8.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p2.8.m8.1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS2.p2.8.m8.1.1.1.1.1.1" xref="S2.SS2.p2.8.m8.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.8.m8.1.1.1.1.1.1.2" xref="S2.SS2.p2.8.m8.1.1.1.1.1.1.2.cmml">𝕩</mi><mi id="S2.SS2.p2.8.m8.1.1.1.1.1.1.3" xref="S2.SS2.p2.8.m8.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS2.p2.8.m8.1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p2.8.m8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p2.8.m8.3.3.4" xref="S2.SS2.p2.8.m8.3.3.4.cmml">=</mo><mrow id="S2.SS2.p2.8.m8.3.3.3" xref="S2.SS2.p2.8.m8.3.3.3.cmml"><mrow id="S2.SS2.p2.8.m8.3.3.3.4" xref="S2.SS2.p2.8.m8.3.3.3.4.cmml"><mi id="S2.SS2.p2.8.m8.3.3.3.4.1" xref="S2.SS2.p2.8.m8.3.3.3.4.1.cmml">arg</mi><mo id="S2.SS2.p2.8.m8.3.3.3.4a" lspace="0.167em" xref="S2.SS2.p2.8.m8.3.3.3.4.cmml">⁡</mo><mrow id="S2.SS2.p2.8.m8.3.3.3.4.2" xref="S2.SS2.p2.8.m8.3.3.3.4.2.cmml"><msub id="S2.SS2.p2.8.m8.3.3.3.4.2.1" xref="S2.SS2.p2.8.m8.3.3.3.4.2.1.cmml"><mi id="S2.SS2.p2.8.m8.3.3.3.4.2.1.2" xref="S2.SS2.p2.8.m8.3.3.3.4.2.1.2.cmml">min</mi><mrow id="S2.SS2.p2.8.m8.3.3.3.4.2.1.3" xref="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.cmml"><msub id="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.2" xref="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.2.cmml"><mi id="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.2.2" xref="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.2.2.cmml">c</mi><mi id="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.2.3" xref="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.2.3.cmml">i</mi></msub><mo id="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.1" xref="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.3" xref="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.3.cmml">𝒞</mi></mrow></msub><mo id="S2.SS2.p2.8.m8.3.3.3.4.2a" lspace="0.167em" xref="S2.SS2.p2.8.m8.3.3.3.4.2.cmml">⁡</mo><mi id="S2.SS2.p2.8.m8.3.3.3.4.2.2" xref="S2.SS2.p2.8.m8.3.3.3.4.2.2.cmml">d</mi></mrow></mrow><mo id="S2.SS2.p2.8.m8.3.3.3.3" xref="S2.SS2.p2.8.m8.3.3.3.3.cmml">⁢</mo><mrow id="S2.SS2.p2.8.m8.3.3.3.2.2" xref="S2.SS2.p2.8.m8.3.3.3.2.3.cmml"><mo id="S2.SS2.p2.8.m8.3.3.3.2.2.3" stretchy="false" xref="S2.SS2.p2.8.m8.3.3.3.2.3.cmml">(</mo><msub id="S2.SS2.p2.8.m8.2.2.2.1.1.1" xref="S2.SS2.p2.8.m8.2.2.2.1.1.1.cmml"><mi id="S2.SS2.p2.8.m8.2.2.2.1.1.1.2" xref="S2.SS2.p2.8.m8.2.2.2.1.1.1.2.cmml">𝕩</mi><mi id="S2.SS2.p2.8.m8.2.2.2.1.1.1.3" xref="S2.SS2.p2.8.m8.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS2.p2.8.m8.3.3.3.2.2.4" xref="S2.SS2.p2.8.m8.3.3.3.2.3.cmml">,</mo><msub id="S2.SS2.p2.8.m8.3.3.3.2.2.2" xref="S2.SS2.p2.8.m8.3.3.3.2.2.2.cmml"><mi id="S2.SS2.p2.8.m8.3.3.3.2.2.2.2" xref="S2.SS2.p2.8.m8.3.3.3.2.2.2.2.cmml">e</mi><msub id="S2.SS2.p2.8.m8.3.3.3.2.2.2.3" xref="S2.SS2.p2.8.m8.3.3.3.2.2.2.3.cmml"><mi id="S2.SS2.p2.8.m8.3.3.3.2.2.2.3.2" xref="S2.SS2.p2.8.m8.3.3.3.2.2.2.3.2.cmml">c</mi><mi id="S2.SS2.p2.8.m8.3.3.3.2.2.2.3.3" xref="S2.SS2.p2.8.m8.3.3.3.2.2.2.3.3.cmml">i</mi></msub></msub><mo id="S2.SS2.p2.8.m8.3.3.3.2.2.5" stretchy="false" xref="S2.SS2.p2.8.m8.3.3.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m8.3b"><apply id="S2.SS2.p2.8.m8.3.3.cmml" xref="S2.SS2.p2.8.m8.3.3"><eq id="S2.SS2.p2.8.m8.3.3.4.cmml" xref="S2.SS2.p2.8.m8.3.3.4"></eq><apply id="S2.SS2.p2.8.m8.1.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1.1"><times id="S2.SS2.p2.8.m8.1.1.1.2.cmml" xref="S2.SS2.p2.8.m8.1.1.1.2"></times><ci id="S2.SS2.p2.8.m8.1.1.1.3.cmml" xref="S2.SS2.p2.8.m8.1.1.1.3">𝑞</ci><apply id="S2.SS2.p2.8.m8.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.8.m8.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.1.2">𝕩</ci><ci id="S2.SS2.p2.8.m8.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S2.SS2.p2.8.m8.3.3.3.cmml" xref="S2.SS2.p2.8.m8.3.3.3"><times id="S2.SS2.p2.8.m8.3.3.3.3.cmml" xref="S2.SS2.p2.8.m8.3.3.3.3"></times><apply id="S2.SS2.p2.8.m8.3.3.3.4.cmml" xref="S2.SS2.p2.8.m8.3.3.3.4"><arg id="S2.SS2.p2.8.m8.3.3.3.4.1.cmml" xref="S2.SS2.p2.8.m8.3.3.3.4.1"></arg><apply id="S2.SS2.p2.8.m8.3.3.3.4.2.cmml" xref="S2.SS2.p2.8.m8.3.3.3.4.2"><apply id="S2.SS2.p2.8.m8.3.3.3.4.2.1.cmml" xref="S2.SS2.p2.8.m8.3.3.3.4.2.1"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.3.3.3.4.2.1.1.cmml" xref="S2.SS2.p2.8.m8.3.3.3.4.2.1">subscript</csymbol><min id="S2.SS2.p2.8.m8.3.3.3.4.2.1.2.cmml" xref="S2.SS2.p2.8.m8.3.3.3.4.2.1.2"></min><apply id="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.cmml" xref="S2.SS2.p2.8.m8.3.3.3.4.2.1.3"><in id="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.1.cmml" xref="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.1"></in><apply id="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.2.cmml" xref="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.2.1.cmml" xref="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.2">subscript</csymbol><ci id="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.2.2.cmml" xref="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.2.2">𝑐</ci><ci id="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.2.3.cmml" xref="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.2.3">𝑖</ci></apply><ci id="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.3.cmml" xref="S2.SS2.p2.8.m8.3.3.3.4.2.1.3.3">𝒞</ci></apply></apply><ci id="S2.SS2.p2.8.m8.3.3.3.4.2.2.cmml" xref="S2.SS2.p2.8.m8.3.3.3.4.2.2">𝑑</ci></apply></apply><interval closure="open" id="S2.SS2.p2.8.m8.3.3.3.2.3.cmml" xref="S2.SS2.p2.8.m8.3.3.3.2.2"><apply id="S2.SS2.p2.8.m8.2.2.2.1.1.1.cmml" xref="S2.SS2.p2.8.m8.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.2.2.2.1.1.1.1.cmml" xref="S2.SS2.p2.8.m8.2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.8.m8.2.2.2.1.1.1.2.cmml" xref="S2.SS2.p2.8.m8.2.2.2.1.1.1.2">𝕩</ci><ci id="S2.SS2.p2.8.m8.2.2.2.1.1.1.3.cmml" xref="S2.SS2.p2.8.m8.2.2.2.1.1.1.3">𝑖</ci></apply><apply id="S2.SS2.p2.8.m8.3.3.3.2.2.2.cmml" xref="S2.SS2.p2.8.m8.3.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.3.3.3.2.2.2.1.cmml" xref="S2.SS2.p2.8.m8.3.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p2.8.m8.3.3.3.2.2.2.2.cmml" xref="S2.SS2.p2.8.m8.3.3.3.2.2.2.2">𝑒</ci><apply id="S2.SS2.p2.8.m8.3.3.3.2.2.2.3.cmml" xref="S2.SS2.p2.8.m8.3.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.3.3.3.2.2.2.3.1.cmml" xref="S2.SS2.p2.8.m8.3.3.3.2.2.2.3">subscript</csymbol><ci id="S2.SS2.p2.8.m8.3.3.3.2.2.2.3.2.cmml" xref="S2.SS2.p2.8.m8.3.3.3.2.2.2.3.2">𝑐</ci><ci id="S2.SS2.p2.8.m8.3.3.3.2.2.2.3.3.cmml" xref="S2.SS2.p2.8.m8.3.3.3.2.2.2.3.3">𝑖</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m8.3c">q(\mathbb{x}_{i})=\arg\min_{c_{i}\in\mathcal{C}}d(\mathbb{x}_{i},e_{c_{i}})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.8.m8.3d">italic_q ( blackboard_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = roman_arg roman_min start_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_C end_POSTSUBSCRIPT italic_d ( blackboard_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_e start_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="e_{c_{i}}" class="ltx_Math" display="inline" id="S2.SS2.p2.9.m9.1"><semantics id="S2.SS2.p2.9.m9.1a"><msub id="S2.SS2.p2.9.m9.1.1" xref="S2.SS2.p2.9.m9.1.1.cmml"><mi id="S2.SS2.p2.9.m9.1.1.2" xref="S2.SS2.p2.9.m9.1.1.2.cmml">e</mi><msub id="S2.SS2.p2.9.m9.1.1.3" xref="S2.SS2.p2.9.m9.1.1.3.cmml"><mi id="S2.SS2.p2.9.m9.1.1.3.2" xref="S2.SS2.p2.9.m9.1.1.3.2.cmml">c</mi><mi id="S2.SS2.p2.9.m9.1.1.3.3" xref="S2.SS2.p2.9.m9.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.9.m9.1b"><apply id="S2.SS2.p2.9.m9.1.1.cmml" xref="S2.SS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m9.1.1.1.cmml" xref="S2.SS2.p2.9.m9.1.1">subscript</csymbol><ci id="S2.SS2.p2.9.m9.1.1.2.cmml" xref="S2.SS2.p2.9.m9.1.1.2">𝑒</ci><apply id="S2.SS2.p2.9.m9.1.1.3.cmml" xref="S2.SS2.p2.9.m9.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m9.1.1.3.1.cmml" xref="S2.SS2.p2.9.m9.1.1.3">subscript</csymbol><ci id="S2.SS2.p2.9.m9.1.1.3.2.cmml" xref="S2.SS2.p2.9.m9.1.1.3.2">𝑐</ci><ci id="S2.SS2.p2.9.m9.1.1.3.3.cmml" xref="S2.SS2.p2.9.m9.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.9.m9.1c">e_{c_{i}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.9.m9.1d">italic_e start_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> denotes the centroid embedding of the <math alttext="c_{i}" class="ltx_Math" display="inline" id="S2.SS2.p2.10.m10.1"><semantics id="S2.SS2.p2.10.m10.1a"><msub id="S2.SS2.p2.10.m10.1.1" xref="S2.SS2.p2.10.m10.1.1.cmml"><mi id="S2.SS2.p2.10.m10.1.1.2" xref="S2.SS2.p2.10.m10.1.1.2.cmml">c</mi><mi id="S2.SS2.p2.10.m10.1.1.3" xref="S2.SS2.p2.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.10.m10.1b"><apply id="S2.SS2.p2.10.m10.1.1.cmml" xref="S2.SS2.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.10.m10.1.1.1.cmml" xref="S2.SS2.p2.10.m10.1.1">subscript</csymbol><ci id="S2.SS2.p2.10.m10.1.1.2.cmml" xref="S2.SS2.p2.10.m10.1.1.2">𝑐</ci><ci id="S2.SS2.p2.10.m10.1.1.3.cmml" xref="S2.SS2.p2.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.10.m10.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.10.m10.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>-th centroid.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Proposed Model</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Problem Formulation</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.15">We can split the sequence of users’ behaviors into several heterogeneous sub-sequences, including the sequence of search queries <math alttext="\mathcal{Q}=\{q_{1},q_{2},..,q_{|\mathcal{Q}|}\}" class="ltx_math_unparsed" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1b"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.2">𝒬</mi><mo id="S3.SS1.p1.1.m1.1.3">=</mo><mrow id="S3.SS1.p1.1.m1.1.4"><mo id="S3.SS1.p1.1.m1.1.4.1" stretchy="false">{</mo><msub id="S3.SS1.p1.1.m1.1.4.2"><mi id="S3.SS1.p1.1.m1.1.4.2.2">q</mi><mn id="S3.SS1.p1.1.m1.1.4.2.3">1</mn></msub><mo id="S3.SS1.p1.1.m1.1.4.3">,</mo><msub id="S3.SS1.p1.1.m1.1.4.4"><mi id="S3.SS1.p1.1.m1.1.4.4.2">q</mi><mn id="S3.SS1.p1.1.m1.1.4.4.3">2</mn></msub><mo id="S3.SS1.p1.1.m1.1.4.5">,</mo><mo id="S3.SS1.p1.1.m1.1.4.6" lspace="0em" rspace="0.0835em">.</mo><mo id="S3.SS1.p1.1.m1.1.4.7" lspace="0.0835em" rspace="0.167em">.</mo><mo id="S3.SS1.p1.1.m1.1.4.8">,</mo><msub id="S3.SS1.p1.1.m1.1.4.9"><mi id="S3.SS1.p1.1.m1.1.4.9.2">q</mi><mrow id="S3.SS1.p1.1.m1.1.1.1.3"><mo id="S3.SS1.p1.1.m1.1.1.1.3.1" stretchy="false">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1.1.1">𝒬</mi><mo id="S3.SS1.p1.1.m1.1.1.1.3.2" stretchy="false">|</mo></mrow></msub><mo id="S3.SS1.p1.1.m1.1.4.10" stretchy="false">}</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathcal{Q}=\{q_{1},q_{2},..,q_{|\mathcal{Q}|}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">caligraphic_Q = { italic_q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , . . , italic_q start_POSTSUBSCRIPT | caligraphic_Q | end_POSTSUBSCRIPT }</annotation></semantics></math> of explicit intents and the sequence of browsing recommended items <math alttext="\mathcal{B}=\{i_{1},i_{2},...,i_{|\mathcal{B}|}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.5"><semantics id="S3.SS1.p1.2.m2.5a"><mrow id="S3.SS1.p1.2.m2.5.5" xref="S3.SS1.p1.2.m2.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.5.5.5" xref="S3.SS1.p1.2.m2.5.5.5.cmml">ℬ</mi><mo id="S3.SS1.p1.2.m2.5.5.4" xref="S3.SS1.p1.2.m2.5.5.4.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.5.5.3.3" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml"><mo id="S3.SS1.p1.2.m2.5.5.3.3.4" stretchy="false" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">{</mo><msub id="S3.SS1.p1.2.m2.3.3.1.1.1" xref="S3.SS1.p1.2.m2.3.3.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.3.3.1.1.1.2" xref="S3.SS1.p1.2.m2.3.3.1.1.1.2.cmml">i</mi><mn id="S3.SS1.p1.2.m2.3.3.1.1.1.3" xref="S3.SS1.p1.2.m2.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m2.5.5.3.3.5" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.4.4.2.2.2" xref="S3.SS1.p1.2.m2.4.4.2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.4.4.2.2.2.2" xref="S3.SS1.p1.2.m2.4.4.2.2.2.2.cmml">i</mi><mn id="S3.SS1.p1.2.m2.4.4.2.2.2.3" xref="S3.SS1.p1.2.m2.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.2.m2.5.5.3.3.6" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">,</mo><mi id="S3.SS1.p1.2.m2.2.2" mathvariant="normal" xref="S3.SS1.p1.2.m2.2.2.cmml">…</mi><mo id="S3.SS1.p1.2.m2.5.5.3.3.7" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.5.5.3.3.3" xref="S3.SS1.p1.2.m2.5.5.3.3.3.cmml"><mi id="S3.SS1.p1.2.m2.5.5.3.3.3.2" xref="S3.SS1.p1.2.m2.5.5.3.3.3.2.cmml">i</mi><mrow id="S3.SS1.p1.2.m2.1.1.1.3" xref="S3.SS1.p1.2.m2.1.1.1.2.cmml"><mo id="S3.SS1.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.cmml">ℬ</mi><mo id="S3.SS1.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S3.SS1.p1.2.m2.5.5.3.3.8" stretchy="false" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.5b"><apply id="S3.SS1.p1.2.m2.5.5.cmml" xref="S3.SS1.p1.2.m2.5.5"><eq id="S3.SS1.p1.2.m2.5.5.4.cmml" xref="S3.SS1.p1.2.m2.5.5.4"></eq><ci id="S3.SS1.p1.2.m2.5.5.5.cmml" xref="S3.SS1.p1.2.m2.5.5.5">ℬ</ci><set id="S3.SS1.p1.2.m2.5.5.3.4.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3"><apply id="S3.SS1.p1.2.m2.3.3.1.1.1.cmml" xref="S3.SS1.p1.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.3.3.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.3.3.1.1.1.2">𝑖</ci><cn id="S3.SS1.p1.2.m2.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.3.3.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.2.m2.4.4.2.2.2.cmml" xref="S3.SS1.p1.2.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.4.4.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.4.4.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.4.4.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.4.4.2.2.2.2">𝑖</ci><cn id="S3.SS1.p1.2.m2.4.4.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.4.4.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.2.m2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2">…</ci><apply id="S3.SS1.p1.2.m2.5.5.3.3.3.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.3.3.3.1.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.5.5.3.3.3.2.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3.3.2">𝑖</ci><apply id="S3.SS1.p1.2.m2.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3"><abs id="S3.SS1.p1.2.m2.1.1.1.2.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3.1"></abs><ci id="S3.SS1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1">ℬ</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.5c">\mathcal{B}=\{i_{1},i_{2},...,i_{|\mathcal{B}|}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.5d">caligraphic_B = { italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_i start_POSTSUBSCRIPT | caligraphic_B | end_POSTSUBSCRIPT }</annotation></semantics></math>. For search behaviors, users input a query <math alttext="q\in\mathcal{Q}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">q</mi><mo id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">𝒬</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><in id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1"></in><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑞</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝒬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">q\in\mathcal{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_q ∈ caligraphic_Q</annotation></semantics></math> and interact (click or view) with a few items related to the query, resulting in the aligned sequence of query and item pairs <math alttext="(q_{l},i_{l})" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.2"><semantics id="S3.SS1.p1.4.m4.2a"><mrow id="S3.SS1.p1.4.m4.2.2.2" xref="S3.SS1.p1.4.m4.2.2.3.cmml"><mo id="S3.SS1.p1.4.m4.2.2.2.3" stretchy="false" xref="S3.SS1.p1.4.m4.2.2.3.cmml">(</mo><msub id="S3.SS1.p1.4.m4.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.1.1.2" xref="S3.SS1.p1.4.m4.1.1.1.1.2.cmml">q</mi><mi id="S3.SS1.p1.4.m4.1.1.1.1.3" xref="S3.SS1.p1.4.m4.1.1.1.1.3.cmml">l</mi></msub><mo id="S3.SS1.p1.4.m4.2.2.2.4" xref="S3.SS1.p1.4.m4.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.4.m4.2.2.2.2" xref="S3.SS1.p1.4.m4.2.2.2.2.cmml"><mi id="S3.SS1.p1.4.m4.2.2.2.2.2" xref="S3.SS1.p1.4.m4.2.2.2.2.2.cmml">i</mi><mi id="S3.SS1.p1.4.m4.2.2.2.2.3" xref="S3.SS1.p1.4.m4.2.2.2.2.3.cmml">l</mi></msub><mo id="S3.SS1.p1.4.m4.2.2.2.5" stretchy="false" xref="S3.SS1.p1.4.m4.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.2b"><interval closure="open" id="S3.SS1.p1.4.m4.2.2.3.cmml" xref="S3.SS1.p1.4.m4.2.2.2"><apply id="S3.SS1.p1.4.m4.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.2">𝑞</ci><ci id="S3.SS1.p1.4.m4.1.1.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.3">𝑙</ci></apply><apply id="S3.SS1.p1.4.m4.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.2.2.2.1.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.2.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2.2">𝑖</ci><ci id="S3.SS1.p1.4.m4.2.2.2.2.3.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2.3">𝑙</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.2c">(q_{l},i_{l})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.2d">( italic_q start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT )</annotation></semantics></math>. For the behavior of browsing recommended items, users browse a sequence of items without explicit search intent, and we pad an empty search query <math alttext="q=\emptyset" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mrow id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">q</mi><mo id="S3.SS1.p1.5.m5.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.cmml">=</mo><mi id="S3.SS1.p1.5.m5.1.1.3" mathvariant="normal" xref="S3.SS1.p1.5.m5.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><eq id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1"></eq><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝑞</ci><emptyset id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">q=\emptyset</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_q = ∅</annotation></semantics></math> to each item to obtain the query-item pair as <math alttext="(q_{l}=\emptyset,i_{l})" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.2"><semantics id="S3.SS1.p1.6.m6.2a"><mrow id="S3.SS1.p1.6.m6.2.2.1" xref="S3.SS1.p1.6.m6.2.2.1.1.cmml"><mo id="S3.SS1.p1.6.m6.2.2.1.2" stretchy="false" xref="S3.SS1.p1.6.m6.2.2.1.1.cmml">(</mo><mrow id="S3.SS1.p1.6.m6.2.2.1.1" xref="S3.SS1.p1.6.m6.2.2.1.1.cmml"><msub id="S3.SS1.p1.6.m6.2.2.1.1.3" xref="S3.SS1.p1.6.m6.2.2.1.1.3.cmml"><mi id="S3.SS1.p1.6.m6.2.2.1.1.3.2" xref="S3.SS1.p1.6.m6.2.2.1.1.3.2.cmml">q</mi><mi id="S3.SS1.p1.6.m6.2.2.1.1.3.3" xref="S3.SS1.p1.6.m6.2.2.1.1.3.3.cmml">l</mi></msub><mo id="S3.SS1.p1.6.m6.2.2.1.1.2" xref="S3.SS1.p1.6.m6.2.2.1.1.2.cmml">=</mo><mrow id="S3.SS1.p1.6.m6.2.2.1.1.1.1" xref="S3.SS1.p1.6.m6.2.2.1.1.1.2.cmml"><mi id="S3.SS1.p1.6.m6.1.1" mathvariant="normal" xref="S3.SS1.p1.6.m6.1.1.cmml">∅</mi><mo id="S3.SS1.p1.6.m6.2.2.1.1.1.1.2" xref="S3.SS1.p1.6.m6.2.2.1.1.1.2.cmml">,</mo><msub id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.cmml">i</mi><mi id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.3" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.3.cmml">l</mi></msub></mrow></mrow><mo id="S3.SS1.p1.6.m6.2.2.1.3" stretchy="false" xref="S3.SS1.p1.6.m6.2.2.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.2b"><apply id="S3.SS1.p1.6.m6.2.2.1.1.cmml" xref="S3.SS1.p1.6.m6.2.2.1"><eq id="S3.SS1.p1.6.m6.2.2.1.1.2.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.2"></eq><apply id="S3.SS1.p1.6.m6.2.2.1.1.3.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.2.2.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.6.m6.2.2.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.3.2">𝑞</ci><ci id="S3.SS1.p1.6.m6.2.2.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.3.3">𝑙</ci></apply><list id="S3.SS1.p1.6.m6.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1"><emptyset id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"></emptyset><apply id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2">𝑖</ci><ci id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.3">𝑙</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.2c">(q_{l}=\emptyset,i_{l})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.2d">( italic_q start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = ∅ , italic_i start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT )</annotation></semantics></math>. Finally, we construct a unified sequence of aligned query-item pairs in chronological order with length <math alttext="L" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_L</annotation></semantics></math>, denoted as <math alttext="\{(q_{l},i_{l})\}_{l=1:L}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><msub id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mrow id="S3.SS1.p1.8.m8.1.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.2.cmml"><mo id="S3.SS1.p1.8.m8.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.8.m8.1.1.1.2.cmml">{</mo><mrow id="S3.SS1.p1.8.m8.1.1.1.1.1.2" xref="S3.SS1.p1.8.m8.1.1.1.1.1.3.cmml"><mo id="S3.SS1.p1.8.m8.1.1.1.1.1.2.3" stretchy="false" xref="S3.SS1.p1.8.m8.1.1.1.1.1.3.cmml">(</mo><msub id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.cmml">q</mi><mi id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S3.SS1.p1.8.m8.1.1.1.1.1.2.4" xref="S3.SS1.p1.8.m8.1.1.1.1.1.3.cmml">,</mo><msub id="S3.SS1.p1.8.m8.1.1.1.1.1.2.2" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.2.cmml">i</mi><mi id="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.3.cmml">l</mi></msub><mo id="S3.SS1.p1.8.m8.1.1.1.1.1.2.5" stretchy="false" xref="S3.SS1.p1.8.m8.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S3.SS1.p1.8.m8.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.8.m8.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml"><mrow id="S3.SS1.p1.8.m8.1.1.3.2" xref="S3.SS1.p1.8.m8.1.1.3.2.cmml"><mi id="S3.SS1.p1.8.m8.1.1.3.2.2" xref="S3.SS1.p1.8.m8.1.1.3.2.2.cmml">l</mi><mo id="S3.SS1.p1.8.m8.1.1.3.2.1" xref="S3.SS1.p1.8.m8.1.1.3.2.1.cmml">=</mo><mn id="S3.SS1.p1.8.m8.1.1.3.2.3" xref="S3.SS1.p1.8.m8.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS1.p1.8.m8.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.8.m8.1.1.3.1.cmml">:</mo><mi id="S3.SS1.p1.8.m8.1.1.3.3" xref="S3.SS1.p1.8.m8.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1">subscript</csymbol><set id="S3.SS1.p1.8.m8.1.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1"><interval closure="open" id="S3.SS1.p1.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2"><apply id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2">𝑞</ci><ci id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.3">𝑙</ci></apply><apply id="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.2">𝑖</ci><ci id="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.3">𝑙</ci></apply></interval></set><apply id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3"><ci id="S3.SS1.p1.8.m8.1.1.3.1.cmml" xref="S3.SS1.p1.8.m8.1.1.3.1">:</ci><apply id="S3.SS1.p1.8.m8.1.1.3.2.cmml" xref="S3.SS1.p1.8.m8.1.1.3.2"><eq id="S3.SS1.p1.8.m8.1.1.3.2.1.cmml" xref="S3.SS1.p1.8.m8.1.1.3.2.1"></eq><ci id="S3.SS1.p1.8.m8.1.1.3.2.2.cmml" xref="S3.SS1.p1.8.m8.1.1.3.2.2">𝑙</ci><cn id="S3.SS1.p1.8.m8.1.1.3.2.3.cmml" type="integer" xref="S3.SS1.p1.8.m8.1.1.3.2.3">1</cn></apply><ci id="S3.SS1.p1.8.m8.1.1.3.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\{(q_{l},i_{l})\}_{l=1:L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">{ ( italic_q start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_l = 1 : italic_L end_POSTSUBSCRIPT</annotation></semantics></math>. In some recommendation scenarios, such as short video recommendations of YouTube and TikTok, each item has multi-modal features such as text (title of video), image, and attributes (authors and categories). We further split the sequence of browsed items <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">caligraphic_B</annotation></semantics></math> into <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><mi id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><ci id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">italic_M</annotation></semantics></math> multi-modal sub-sequences, including a sequence of text features <math alttext="\mathcal{T}=\{T_{1},T_{2},...,T_{L}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.4"><semantics id="S3.SS1.p1.11.m11.4a"><mrow id="S3.SS1.p1.11.m11.4.4" xref="S3.SS1.p1.11.m11.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.11.m11.4.4.5" xref="S3.SS1.p1.11.m11.4.4.5.cmml">𝒯</mi><mo id="S3.SS1.p1.11.m11.4.4.4" xref="S3.SS1.p1.11.m11.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.11.m11.4.4.3.3" xref="S3.SS1.p1.11.m11.4.4.3.4.cmml"><mo id="S3.SS1.p1.11.m11.4.4.3.3.4" stretchy="false" xref="S3.SS1.p1.11.m11.4.4.3.4.cmml">{</mo><msub id="S3.SS1.p1.11.m11.2.2.1.1.1" xref="S3.SS1.p1.11.m11.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.11.m11.2.2.1.1.1.2" xref="S3.SS1.p1.11.m11.2.2.1.1.1.2.cmml">T</mi><mn id="S3.SS1.p1.11.m11.2.2.1.1.1.3" xref="S3.SS1.p1.11.m11.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.11.m11.4.4.3.3.5" xref="S3.SS1.p1.11.m11.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.11.m11.3.3.2.2.2" xref="S3.SS1.p1.11.m11.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.11.m11.3.3.2.2.2.2" xref="S3.SS1.p1.11.m11.3.3.2.2.2.2.cmml">T</mi><mn id="S3.SS1.p1.11.m11.3.3.2.2.2.3" xref="S3.SS1.p1.11.m11.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.11.m11.4.4.3.3.6" xref="S3.SS1.p1.11.m11.4.4.3.4.cmml">,</mo><mi id="S3.SS1.p1.11.m11.1.1" mathvariant="normal" xref="S3.SS1.p1.11.m11.1.1.cmml">…</mi><mo id="S3.SS1.p1.11.m11.4.4.3.3.7" xref="S3.SS1.p1.11.m11.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.11.m11.4.4.3.3.3" xref="S3.SS1.p1.11.m11.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.11.m11.4.4.3.3.3.2" xref="S3.SS1.p1.11.m11.4.4.3.3.3.2.cmml">T</mi><mi id="S3.SS1.p1.11.m11.4.4.3.3.3.3" xref="S3.SS1.p1.11.m11.4.4.3.3.3.3.cmml">L</mi></msub><mo id="S3.SS1.p1.11.m11.4.4.3.3.8" stretchy="false" xref="S3.SS1.p1.11.m11.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.4b"><apply id="S3.SS1.p1.11.m11.4.4.cmml" xref="S3.SS1.p1.11.m11.4.4"><eq id="S3.SS1.p1.11.m11.4.4.4.cmml" xref="S3.SS1.p1.11.m11.4.4.4"></eq><ci id="S3.SS1.p1.11.m11.4.4.5.cmml" xref="S3.SS1.p1.11.m11.4.4.5">𝒯</ci><set id="S3.SS1.p1.11.m11.4.4.3.4.cmml" xref="S3.SS1.p1.11.m11.4.4.3.3"><apply id="S3.SS1.p1.11.m11.2.2.1.1.1.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.11.m11.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.2">𝑇</ci><cn id="S3.SS1.p1.11.m11.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.11.m11.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.11.m11.3.3.2.2.2.cmml" xref="S3.SS1.p1.11.m11.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.11.m11.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.11.m11.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.11.m11.3.3.2.2.2.2">𝑇</ci><cn id="S3.SS1.p1.11.m11.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.11.m11.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">…</ci><apply id="S3.SS1.p1.11.m11.4.4.3.3.3.cmml" xref="S3.SS1.p1.11.m11.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.11.m11.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.11.m11.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.11.m11.4.4.3.3.3.2">𝑇</ci><ci id="S3.SS1.p1.11.m11.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.11.m11.4.4.3.3.3.3">𝐿</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.4c">\mathcal{T}=\{T_{1},T_{2},...,T_{L}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.4d">caligraphic_T = { italic_T start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_T start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_T start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT }</annotation></semantics></math>, a sequence of image features <math alttext="\mathcal{I}=\{I_{1},I_{2},...,I_{L}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.4"><semantics id="S3.SS1.p1.12.m12.4a"><mrow id="S3.SS1.p1.12.m12.4.4" xref="S3.SS1.p1.12.m12.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.12.m12.4.4.5" xref="S3.SS1.p1.12.m12.4.4.5.cmml">ℐ</mi><mo id="S3.SS1.p1.12.m12.4.4.4" xref="S3.SS1.p1.12.m12.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.12.m12.4.4.3.3" xref="S3.SS1.p1.12.m12.4.4.3.4.cmml"><mo id="S3.SS1.p1.12.m12.4.4.3.3.4" stretchy="false" xref="S3.SS1.p1.12.m12.4.4.3.4.cmml">{</mo><msub id="S3.SS1.p1.12.m12.2.2.1.1.1" xref="S3.SS1.p1.12.m12.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.12.m12.2.2.1.1.1.2" xref="S3.SS1.p1.12.m12.2.2.1.1.1.2.cmml">I</mi><mn id="S3.SS1.p1.12.m12.2.2.1.1.1.3" xref="S3.SS1.p1.12.m12.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.12.m12.4.4.3.3.5" xref="S3.SS1.p1.12.m12.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.12.m12.3.3.2.2.2" xref="S3.SS1.p1.12.m12.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.12.m12.3.3.2.2.2.2" xref="S3.SS1.p1.12.m12.3.3.2.2.2.2.cmml">I</mi><mn id="S3.SS1.p1.12.m12.3.3.2.2.2.3" xref="S3.SS1.p1.12.m12.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.12.m12.4.4.3.3.6" xref="S3.SS1.p1.12.m12.4.4.3.4.cmml">,</mo><mi id="S3.SS1.p1.12.m12.1.1" mathvariant="normal" xref="S3.SS1.p1.12.m12.1.1.cmml">…</mi><mo id="S3.SS1.p1.12.m12.4.4.3.3.7" xref="S3.SS1.p1.12.m12.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.12.m12.4.4.3.3.3" xref="S3.SS1.p1.12.m12.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.12.m12.4.4.3.3.3.2" xref="S3.SS1.p1.12.m12.4.4.3.3.3.2.cmml">I</mi><mi id="S3.SS1.p1.12.m12.4.4.3.3.3.3" xref="S3.SS1.p1.12.m12.4.4.3.3.3.3.cmml">L</mi></msub><mo id="S3.SS1.p1.12.m12.4.4.3.3.8" stretchy="false" xref="S3.SS1.p1.12.m12.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.4b"><apply id="S3.SS1.p1.12.m12.4.4.cmml" xref="S3.SS1.p1.12.m12.4.4"><eq id="S3.SS1.p1.12.m12.4.4.4.cmml" xref="S3.SS1.p1.12.m12.4.4.4"></eq><ci id="S3.SS1.p1.12.m12.4.4.5.cmml" xref="S3.SS1.p1.12.m12.4.4.5">ℐ</ci><set id="S3.SS1.p1.12.m12.4.4.3.4.cmml" xref="S3.SS1.p1.12.m12.4.4.3.3"><apply id="S3.SS1.p1.12.m12.2.2.1.1.1.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.12.m12.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.2">𝐼</ci><cn id="S3.SS1.p1.12.m12.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.12.m12.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.12.m12.3.3.2.2.2.cmml" xref="S3.SS1.p1.12.m12.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.12.m12.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.12.m12.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.12.m12.3.3.2.2.2.2">𝐼</ci><cn id="S3.SS1.p1.12.m12.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.12.m12.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">…</ci><apply id="S3.SS1.p1.12.m12.4.4.3.3.3.cmml" xref="S3.SS1.p1.12.m12.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.12.m12.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.12.m12.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.12.m12.4.4.3.3.3.2">𝐼</ci><ci id="S3.SS1.p1.12.m12.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.12.m12.4.4.3.3.3.3">𝐿</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.4c">\mathcal{I}=\{I_{1},I_{2},...,I_{L}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.4d">caligraphic_I = { italic_I start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_I start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_I start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT }</annotation></semantics></math>, and a sequence of attribute features <math alttext="\mathcal{A}=\{A_{1},A_{2},...,A_{L}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m13.4"><semantics id="S3.SS1.p1.13.m13.4a"><mrow id="S3.SS1.p1.13.m13.4.4" xref="S3.SS1.p1.13.m13.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.13.m13.4.4.5" xref="S3.SS1.p1.13.m13.4.4.5.cmml">𝒜</mi><mo id="S3.SS1.p1.13.m13.4.4.4" xref="S3.SS1.p1.13.m13.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.13.m13.4.4.3.3" xref="S3.SS1.p1.13.m13.4.4.3.4.cmml"><mo id="S3.SS1.p1.13.m13.4.4.3.3.4" stretchy="false" xref="S3.SS1.p1.13.m13.4.4.3.4.cmml">{</mo><msub id="S3.SS1.p1.13.m13.2.2.1.1.1" xref="S3.SS1.p1.13.m13.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.13.m13.2.2.1.1.1.2" xref="S3.SS1.p1.13.m13.2.2.1.1.1.2.cmml">A</mi><mn id="S3.SS1.p1.13.m13.2.2.1.1.1.3" xref="S3.SS1.p1.13.m13.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.13.m13.4.4.3.3.5" xref="S3.SS1.p1.13.m13.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.13.m13.3.3.2.2.2" xref="S3.SS1.p1.13.m13.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.13.m13.3.3.2.2.2.2" xref="S3.SS1.p1.13.m13.3.3.2.2.2.2.cmml">A</mi><mn id="S3.SS1.p1.13.m13.3.3.2.2.2.3" xref="S3.SS1.p1.13.m13.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.13.m13.4.4.3.3.6" xref="S3.SS1.p1.13.m13.4.4.3.4.cmml">,</mo><mi id="S3.SS1.p1.13.m13.1.1" mathvariant="normal" xref="S3.SS1.p1.13.m13.1.1.cmml">…</mi><mo id="S3.SS1.p1.13.m13.4.4.3.3.7" xref="S3.SS1.p1.13.m13.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.13.m13.4.4.3.3.3" xref="S3.SS1.p1.13.m13.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.13.m13.4.4.3.3.3.2" xref="S3.SS1.p1.13.m13.4.4.3.3.3.2.cmml">A</mi><mi id="S3.SS1.p1.13.m13.4.4.3.3.3.3" xref="S3.SS1.p1.13.m13.4.4.3.3.3.3.cmml">L</mi></msub><mo id="S3.SS1.p1.13.m13.4.4.3.3.8" stretchy="false" xref="S3.SS1.p1.13.m13.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.4b"><apply id="S3.SS1.p1.13.m13.4.4.cmml" xref="S3.SS1.p1.13.m13.4.4"><eq id="S3.SS1.p1.13.m13.4.4.4.cmml" xref="S3.SS1.p1.13.m13.4.4.4"></eq><ci id="S3.SS1.p1.13.m13.4.4.5.cmml" xref="S3.SS1.p1.13.m13.4.4.5">𝒜</ci><set id="S3.SS1.p1.13.m13.4.4.3.4.cmml" xref="S3.SS1.p1.13.m13.4.4.3.3"><apply id="S3.SS1.p1.13.m13.2.2.1.1.1.cmml" xref="S3.SS1.p1.13.m13.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.13.m13.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.13.m13.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.13.m13.2.2.1.1.1.2">𝐴</ci><cn id="S3.SS1.p1.13.m13.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.13.m13.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.13.m13.3.3.2.2.2.cmml" xref="S3.SS1.p1.13.m13.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.13.m13.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.13.m13.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.13.m13.3.3.2.2.2.2">𝐴</ci><cn id="S3.SS1.p1.13.m13.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.13.m13.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">…</ci><apply id="S3.SS1.p1.13.m13.4.4.3.3.3.cmml" xref="S3.SS1.p1.13.m13.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.13.m13.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.13.m13.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.13.m13.4.4.3.3.3.2">𝐴</ci><ci id="S3.SS1.p1.13.m13.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.13.m13.4.4.3.3.3.3">𝐿</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.4c">\mathcal{A}=\{A_{1},A_{2},...,A_{L}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m13.4d">caligraphic_A = { italic_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_A start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT }</annotation></semantics></math>. Finally, we let <math alttext="[\mathcal{Q},\mathcal{T},\mathcal{I},\mathcal{A}]\in\mathbb{R}^{(M+1)\times L%
\times d}" class="ltx_Math" display="inline" id="S3.SS1.p1.14.m14.5"><semantics id="S3.SS1.p1.14.m14.5a"><mrow id="S3.SS1.p1.14.m14.5.6" xref="S3.SS1.p1.14.m14.5.6.cmml"><mrow id="S3.SS1.p1.14.m14.5.6.2.2" xref="S3.SS1.p1.14.m14.5.6.2.1.cmml"><mo id="S3.SS1.p1.14.m14.5.6.2.2.1" stretchy="false" xref="S3.SS1.p1.14.m14.5.6.2.1.cmml">[</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.14.m14.2.2" xref="S3.SS1.p1.14.m14.2.2.cmml">𝒬</mi><mo id="S3.SS1.p1.14.m14.5.6.2.2.2" xref="S3.SS1.p1.14.m14.5.6.2.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.14.m14.3.3" xref="S3.SS1.p1.14.m14.3.3.cmml">𝒯</mi><mo id="S3.SS1.p1.14.m14.5.6.2.2.3" xref="S3.SS1.p1.14.m14.5.6.2.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.14.m14.4.4" xref="S3.SS1.p1.14.m14.4.4.cmml">ℐ</mi><mo id="S3.SS1.p1.14.m14.5.6.2.2.4" xref="S3.SS1.p1.14.m14.5.6.2.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.14.m14.5.5" xref="S3.SS1.p1.14.m14.5.5.cmml">𝒜</mi><mo id="S3.SS1.p1.14.m14.5.6.2.2.5" stretchy="false" xref="S3.SS1.p1.14.m14.5.6.2.1.cmml">]</mo></mrow><mo id="S3.SS1.p1.14.m14.5.6.1" xref="S3.SS1.p1.14.m14.5.6.1.cmml">∈</mo><msup id="S3.SS1.p1.14.m14.5.6.3" xref="S3.SS1.p1.14.m14.5.6.3.cmml"><mi id="S3.SS1.p1.14.m14.5.6.3.2" xref="S3.SS1.p1.14.m14.5.6.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.14.m14.1.1.1" xref="S3.SS1.p1.14.m14.1.1.1.cmml"><mrow id="S3.SS1.p1.14.m14.1.1.1.1.1" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.14.m14.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.14.m14.1.1.1.1.1.1" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.14.m14.1.1.1.1.1.1.2" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.2.cmml">M</mi><mo id="S3.SS1.p1.14.m14.1.1.1.1.1.1.1" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS1.p1.14.m14.1.1.1.1.1.1.3" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.p1.14.m14.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS1.p1.14.m14.1.1.1.2" rspace="0.222em" xref="S3.SS1.p1.14.m14.1.1.1.2.cmml">×</mo><mi id="S3.SS1.p1.14.m14.1.1.1.3" xref="S3.SS1.p1.14.m14.1.1.1.3.cmml">L</mi><mo id="S3.SS1.p1.14.m14.1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.14.m14.1.1.1.2.cmml">×</mo><mi id="S3.SS1.p1.14.m14.1.1.1.4" xref="S3.SS1.p1.14.m14.1.1.1.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.5b"><apply id="S3.SS1.p1.14.m14.5.6.cmml" xref="S3.SS1.p1.14.m14.5.6"><in id="S3.SS1.p1.14.m14.5.6.1.cmml" xref="S3.SS1.p1.14.m14.5.6.1"></in><list id="S3.SS1.p1.14.m14.5.6.2.1.cmml" xref="S3.SS1.p1.14.m14.5.6.2.2"><ci id="S3.SS1.p1.14.m14.2.2.cmml" xref="S3.SS1.p1.14.m14.2.2">𝒬</ci><ci id="S3.SS1.p1.14.m14.3.3.cmml" xref="S3.SS1.p1.14.m14.3.3">𝒯</ci><ci id="S3.SS1.p1.14.m14.4.4.cmml" xref="S3.SS1.p1.14.m14.4.4">ℐ</ci><ci id="S3.SS1.p1.14.m14.5.5.cmml" xref="S3.SS1.p1.14.m14.5.5">𝒜</ci></list><apply id="S3.SS1.p1.14.m14.5.6.3.cmml" xref="S3.SS1.p1.14.m14.5.6.3"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.5.6.3.1.cmml" xref="S3.SS1.p1.14.m14.5.6.3">superscript</csymbol><ci id="S3.SS1.p1.14.m14.5.6.3.2.cmml" xref="S3.SS1.p1.14.m14.5.6.3.2">ℝ</ci><apply id="S3.SS1.p1.14.m14.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1"><times id="S3.SS1.p1.14.m14.1.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.1.2"></times><apply id="S3.SS1.p1.14.m14.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1"><plus id="S3.SS1.p1.14.m14.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.1"></plus><ci id="S3.SS1.p1.14.m14.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.2">𝑀</ci><cn id="S3.SS1.p1.14.m14.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.SS1.p1.14.m14.1.1.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.1.3">𝐿</ci><ci id="S3.SS1.p1.14.m14.1.1.1.4.cmml" xref="S3.SS1.p1.14.m14.1.1.1.4">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.5c">[\mathcal{Q},\mathcal{T},\mathcal{I},\mathcal{A}]\in\mathbb{R}^{(M+1)\times L%
\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.14.m14.5d">[ caligraphic_Q , caligraphic_T , caligraphic_I , caligraphic_A ] ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_M + 1 ) × italic_L × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> denote the input sequence of multi-modal query-item pairs to the SEMINAR model and <math alttext="d" class="ltx_Math" display="inline" id="S3.SS1.p1.15.m15.1"><semantics id="S3.SS1.p1.15.m15.1a"><mi id="S3.SS1.p1.15.m15.1.1" xref="S3.SS1.p1.15.m15.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b"><ci id="S3.SS1.p1.15.m15.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.15.m15.1d">italic_d</annotation></semantics></math> denotes the dimension of aligned representations.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Aligned Lifelong Sequence of Multi-Modal Query-Item Pairs</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.4">The aligned sequence of multi modal query-item pairs pass the embedding layers. We let <math alttext="[\mathbb{x}_{l}=(\mathbb{x}^{query}_{l},\mathbb{x}^{item}_{l})]_{l=1:L}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mrow id="S3.SS2.p1.1.m1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.2.cmml"><mo id="S3.SS2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p1.1.m1.1.1.1.2.1.cmml">[</mo><mrow id="S3.SS2.p1.1.m1.1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.1.cmml"><msub id="S3.SS2.p1.1.m1.1.1.1.1.1.4" xref="S3.SS2.p1.1.m1.1.1.1.1.1.4.cmml"><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.4.2" xref="S3.SS2.p1.1.m1.1.1.1.1.1.4.2.cmml">𝕩</mi><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.4.3" xref="S3.SS2.p1.1.m1.1.1.1.1.1.4.3.cmml">l</mi></msub><mo id="S3.SS2.p1.1.m1.1.1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.1.1.1.3.cmml">=</mo><mrow id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.3.cmml"><mo id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.3" stretchy="false" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.3.cmml">(</mo><msubsup id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝕩</mi><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml">l</mi><mrow id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">q</mi><mo id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">u</mi><mo id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.1a" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.4" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.4.cmml">e</mi><mo id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.1b" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.5" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.5.cmml">r</mi><mo id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.1c" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.6" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.6.cmml">y</mi></mrow></msubsup><mo id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.4" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.2" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.2.cmml">𝕩</mi><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.3" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.3.cmml">l</mi><mrow id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.2" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.2.cmml">i</mi><mo id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.1" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.3" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.3.cmml">t</mi><mo id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.1a" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.4" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.4.cmml">e</mi><mo id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.1b" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.5" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.5.cmml">m</mi></mrow></msubsup><mo id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.5" stretchy="false" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p1.1.m1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mrow id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2.2" xref="S3.SS2.p1.1.m1.1.1.3.2.2.cmml">l</mi><mo id="S3.SS2.p1.1.m1.1.1.3.2.1" xref="S3.SS2.p1.1.m1.1.1.3.2.1.cmml">=</mo><mn id="S3.SS2.p1.1.m1.1.1.3.2.3" xref="S3.SS2.p1.1.m1.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS2.p1.1.m1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">:</mo><mi id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><apply id="S3.SS2.p1.1.m1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.1.m1.1.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1"><eq id="S3.SS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.3"></eq><apply id="S3.SS2.p1.1.m1.1.1.1.1.1.4.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.1.1.4.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.4.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.4.2">𝕩</ci><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.4.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.4.3">𝑙</ci></apply><interval closure="open" id="S3.SS2.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2"><apply id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2">𝕩</ci><apply id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3"><times id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.2">𝑞</ci><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.3">𝑢</ci><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.4">𝑒</ci><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.5.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.5">𝑟</ci><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.6.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.3.6">𝑦</ci></apply></apply><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply><apply id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.2">𝕩</ci><apply id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3"><times id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.1"></times><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.2">𝑖</ci><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.3">𝑡</ci><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.4.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.4">𝑒</ci><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.5.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.2.3.5">𝑚</ci></apply></apply><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.2.2.3">𝑙</ci></apply></interval></apply></apply><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><ci id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.1">:</ci><apply id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2"><eq id="S3.SS2.p1.1.m1.1.1.3.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2.1"></eq><ci id="S3.SS2.p1.1.m1.1.1.3.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2.2">𝑙</ci><cn id="S3.SS2.p1.1.m1.1.1.3.2.3.cmml" type="integer" xref="S3.SS2.p1.1.m1.1.1.3.2.3">1</cn></apply><ci id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">[\mathbb{x}_{l}=(\mathbb{x}^{query}_{l},\mathbb{x}^{item}_{l})]_{l=1:L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">[ blackboard_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = ( blackboard_x start_POSTSUPERSCRIPT italic_q italic_u italic_e italic_r italic_y end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , blackboard_x start_POSTSUPERSCRIPT italic_i italic_t italic_e italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ] start_POSTSUBSCRIPT italic_l = 1 : italic_L end_POSTSUBSCRIPT</annotation></semantics></math> denote the historical sequence of query and item pairs. <math alttext="\mathbb{x}^{query}_{l}\in\mathbb{R}^{d},\mathbb{x}^{item}_{l}=(\mathbb{x}^{%
text}_{l},\mathbb{x}^{image}_{l},\mathbb{x}^{attributes}_{l})\in\mathbb{R}^{M%
\times d}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.2"><semantics id="S3.SS2.p1.2.m2.2a"><mrow id="S3.SS2.p1.2.m2.2.2.2" xref="S3.SS2.p1.2.m2.2.2.3.cmml"><mrow id="S3.SS2.p1.2.m2.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.cmml"><msubsup id="S3.SS2.p1.2.m2.1.1.1.1.2" xref="S3.SS2.p1.2.m2.1.1.1.1.2.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1.2.2.2" xref="S3.SS2.p1.2.m2.1.1.1.1.2.2.2.cmml">𝕩</mi><mi id="S3.SS2.p1.2.m2.1.1.1.1.2.3" xref="S3.SS2.p1.2.m2.1.1.1.1.2.3.cmml">l</mi><mrow id="S3.SS2.p1.2.m2.1.1.1.1.2.2.3" xref="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.2" xref="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.2.cmml">q</mi><mo id="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.1" xref="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.3" xref="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.3.cmml">u</mi><mo id="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.1a" xref="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.4" xref="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.4.cmml">e</mi><mo id="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.1b" xref="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.5" xref="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.5.cmml">r</mi><mo id="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.1c" xref="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.6" xref="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.6.cmml">y</mi></mrow></msubsup><mo id="S3.SS2.p1.2.m2.1.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.2.m2.1.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.p1.2.m2.1.1.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.1.1.3.3.cmml">d</mi></msup></mrow><mo id="S3.SS2.p1.2.m2.2.2.2.3" xref="S3.SS2.p1.2.m2.2.2.3a.cmml">,</mo><mrow id="S3.SS2.p1.2.m2.2.2.2.2" xref="S3.SS2.p1.2.m2.2.2.2.2.cmml"><msubsup id="S3.SS2.p1.2.m2.2.2.2.2.5" xref="S3.SS2.p1.2.m2.2.2.2.2.5.cmml"><mi id="S3.SS2.p1.2.m2.2.2.2.2.5.2.2" xref="S3.SS2.p1.2.m2.2.2.2.2.5.2.2.cmml">𝕩</mi><mi id="S3.SS2.p1.2.m2.2.2.2.2.5.3" xref="S3.SS2.p1.2.m2.2.2.2.2.5.3.cmml">l</mi><mrow id="S3.SS2.p1.2.m2.2.2.2.2.5.2.3" xref="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.cmml"><mi id="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.2" xref="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.2.cmml">i</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.1" xref="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.3" xref="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.3.cmml">t</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.1a" xref="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.4" xref="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.4.cmml">e</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.1b" xref="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.5" xref="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.5.cmml">m</mi></mrow></msubsup><mo id="S3.SS2.p1.2.m2.2.2.2.2.6" xref="S3.SS2.p1.2.m2.2.2.2.2.6.cmml">=</mo><mrow id="S3.SS2.p1.2.m2.2.2.2.2.3.3" xref="S3.SS2.p1.2.m2.2.2.2.2.3.4.cmml"><mo id="S3.SS2.p1.2.m2.2.2.2.2.3.3.4" stretchy="false" xref="S3.SS2.p1.2.m2.2.2.2.2.3.4.cmml">(</mo><msubsup id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.2" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.2.cmml">𝕩</mi><mi id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.3" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.3.cmml">l</mi><mrow id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.cmml"><mi id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.2" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.2.cmml">t</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.1" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.3" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.3.cmml">e</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.1a" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.4" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.4.cmml">x</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.1b" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.5" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.5.cmml">t</mi></mrow></msubsup><mo id="S3.SS2.p1.2.m2.2.2.2.2.3.3.5" xref="S3.SS2.p1.2.m2.2.2.2.2.3.4.cmml">,</mo><msubsup id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.cmml"><mi id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.2" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.2.cmml">𝕩</mi><mi id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.3" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.3.cmml">l</mi><mrow id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.cmml"><mi id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.2" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.2.cmml">i</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.1" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.3" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.3.cmml">m</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.1a" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.4" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.4.cmml">a</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.1b" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.5" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.5.cmml">g</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.1c" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.6" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.6.cmml">e</mi></mrow></msubsup><mo id="S3.SS2.p1.2.m2.2.2.2.2.3.3.6" xref="S3.SS2.p1.2.m2.2.2.2.2.3.4.cmml">,</mo><msubsup id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.cmml"><mi id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.2" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.2.cmml">𝕩</mi><mi id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.3" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.3.cmml">l</mi><mrow id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.cmml"><mi id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.2" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.2.cmml">a</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.1" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.3" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.3.cmml">t</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.1a" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.4" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.4.cmml">t</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.1b" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.5" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.5.cmml">r</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.1c" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.6" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.6.cmml">i</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.1d" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.7" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.7.cmml">b</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.1e" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.8" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.8.cmml">u</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.1f" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.9" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.9.cmml">t</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.1g" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.10" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.10.cmml">e</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.1h" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.11" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.11.cmml">s</mi></mrow></msubsup><mo id="S3.SS2.p1.2.m2.2.2.2.2.3.3.7" stretchy="false" xref="S3.SS2.p1.2.m2.2.2.2.2.3.4.cmml">)</mo></mrow><mo id="S3.SS2.p1.2.m2.2.2.2.2.7" xref="S3.SS2.p1.2.m2.2.2.2.2.7.cmml">∈</mo><msup id="S3.SS2.p1.2.m2.2.2.2.2.8" xref="S3.SS2.p1.2.m2.2.2.2.2.8.cmml"><mi id="S3.SS2.p1.2.m2.2.2.2.2.8.2" xref="S3.SS2.p1.2.m2.2.2.2.2.8.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.2.m2.2.2.2.2.8.3" xref="S3.SS2.p1.2.m2.2.2.2.2.8.3.cmml"><mi id="S3.SS2.p1.2.m2.2.2.2.2.8.3.2" xref="S3.SS2.p1.2.m2.2.2.2.2.8.3.2.cmml">M</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.8.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.2.m2.2.2.2.2.8.3.1.cmml">×</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2.8.3.3" xref="S3.SS2.p1.2.m2.2.2.2.2.8.3.3.cmml">d</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.2b"><apply id="S3.SS2.p1.2.m2.2.2.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.2.3a.cmml" xref="S3.SS2.p1.2.m2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS2.p1.2.m2.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1"><in id="S3.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1"></in><apply id="S3.SS2.p1.2.m2.1.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.2">subscript</csymbol><apply id="S3.SS2.p1.2.m2.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.1.2.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.2">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.1.1.2.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.2.2.2">𝕩</ci><apply id="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.2.2.3"><times id="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.1"></times><ci id="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.2">𝑞</ci><ci id="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.3">𝑢</ci><ci id="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.4.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.4">𝑒</ci><ci id="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.5.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.5">𝑟</ci><ci id="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.6.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.2.2.3.6">𝑦</ci></apply></apply><ci id="S3.SS2.p1.2.m2.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.2.3">𝑙</ci></apply><apply id="S3.SS2.p1.2.m2.1.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.3.2">ℝ</ci><ci id="S3.SS2.p1.2.m2.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.3.3">𝑑</ci></apply></apply><apply id="S3.SS2.p1.2.m2.2.2.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2"><and id="S3.SS2.p1.2.m2.2.2.2.2a.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2"></and><apply id="S3.SS2.p1.2.m2.2.2.2.2b.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2"><eq id="S3.SS2.p1.2.m2.2.2.2.2.6.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.6"></eq><apply id="S3.SS2.p1.2.m2.2.2.2.2.5.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.5"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.2.2.2.5.1.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.5">subscript</csymbol><apply id="S3.SS2.p1.2.m2.2.2.2.2.5.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.5"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.2.2.2.5.2.1.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.5">superscript</csymbol><ci id="S3.SS2.p1.2.m2.2.2.2.2.5.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.5.2.2">𝕩</ci><apply id="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.5.2.3"><times id="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.1.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.1"></times><ci id="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.2">𝑖</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.3">𝑡</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.4.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.4">𝑒</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.5.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.5.2.3.5">𝑚</ci></apply></apply><ci id="S3.SS2.p1.2.m2.2.2.2.2.5.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.5.3">𝑙</ci></apply><vector id="S3.SS2.p1.2.m2.2.2.2.2.3.4.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3"><apply id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1">subscript</csymbol><apply id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1">superscript</csymbol><ci id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.2">𝕩</ci><apply id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3"><times id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.1.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.1"></times><ci id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.2">𝑡</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.3">𝑒</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.4.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.4">𝑥</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.5.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.2.3.5">𝑡</ci></apply></apply><ci id="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.1.1.1.3">𝑙</ci></apply><apply id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2">subscript</csymbol><apply id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2">superscript</csymbol><ci id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.2">𝕩</ci><apply id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3"><times id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.1.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.1"></times><ci id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.2">𝑖</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.3">𝑚</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.4.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.4">𝑎</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.5.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.5">𝑔</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.6.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.2.3.6">𝑒</ci></apply></apply><ci id="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.2.3">𝑙</ci></apply><apply id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.1.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3">subscript</csymbol><apply id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.1.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3">superscript</csymbol><ci id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.2">𝕩</ci><apply id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3"><times id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.1.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.1"></times><ci id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.2">𝑎</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.3">𝑡</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.4.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.4">𝑡</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.5.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.5">𝑟</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.6.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.6">𝑖</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.7.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.7">𝑏</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.8.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.8">𝑢</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.9.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.9">𝑡</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.10.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.10">𝑒</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.11.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.2.3.11">𝑠</ci></apply></apply><ci id="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.3.3.3.3">𝑙</ci></apply></vector></apply><apply id="S3.SS2.p1.2.m2.2.2.2.2c.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2"><in id="S3.SS2.p1.2.m2.2.2.2.2.7.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.7"></in><share href="https://arxiv.org/html/2407.10714v1#S3.SS2.p1.2.m2.2.2.2.2.3.cmml" id="S3.SS2.p1.2.m2.2.2.2.2d.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2"></share><apply id="S3.SS2.p1.2.m2.2.2.2.2.8.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.8"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.2.2.2.8.1.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.8">superscript</csymbol><ci id="S3.SS2.p1.2.m2.2.2.2.2.8.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.8.2">ℝ</ci><apply id="S3.SS2.p1.2.m2.2.2.2.2.8.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.8.3"><times id="S3.SS2.p1.2.m2.2.2.2.2.8.3.1.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.8.3.1"></times><ci id="S3.SS2.p1.2.m2.2.2.2.2.8.3.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.8.3.2">𝑀</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.8.3.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.8.3.3">𝑑</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.2c">\mathbb{x}^{query}_{l}\in\mathbb{R}^{d},\mathbb{x}^{item}_{l}=(\mathbb{x}^{%
text}_{l},\mathbb{x}^{image}_{l},\mathbb{x}^{attributes}_{l})\in\mathbb{R}^{M%
\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.2d">blackboard_x start_POSTSUPERSCRIPT italic_q italic_u italic_e italic_r italic_y end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT , blackboard_x start_POSTSUPERSCRIPT italic_i italic_t italic_e italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = ( blackboard_x start_POSTSUPERSCRIPT italic_t italic_e italic_x italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , blackboard_x start_POSTSUPERSCRIPT italic_i italic_m italic_a italic_g italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , blackboard_x start_POSTSUPERSCRIPT italic_a italic_t italic_t italic_r italic_i italic_b italic_u italic_t italic_e italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_M × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>. In CTR prediction, target attention (TA) is a structure which uses target item to retrieve the most relevant items from the sequence of historical behaviors. We extend TA from target item to target query-item pair to retrieve most relevant top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_K</annotation></semantics></math> pairs from historical sequence. We denote the target query-item pair as <math alttext="\mathbb{x}_{t}=(\mathbb{x}^{query}_{t},\mathbb{x}^{text}_{t},\mathbb{x}^{image%
}_{t},\mathbb{x}^{attributes}_{t})" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.4"><semantics id="S3.SS2.p1.4.m4.4a"><mrow id="S3.SS2.p1.4.m4.4.4" xref="S3.SS2.p1.4.m4.4.4.cmml"><msub id="S3.SS2.p1.4.m4.4.4.6" xref="S3.SS2.p1.4.m4.4.4.6.cmml"><mi id="S3.SS2.p1.4.m4.4.4.6.2" xref="S3.SS2.p1.4.m4.4.4.6.2.cmml">𝕩</mi><mi id="S3.SS2.p1.4.m4.4.4.6.3" xref="S3.SS2.p1.4.m4.4.4.6.3.cmml">t</mi></msub><mo id="S3.SS2.p1.4.m4.4.4.5" xref="S3.SS2.p1.4.m4.4.4.5.cmml">=</mo><mrow id="S3.SS2.p1.4.m4.4.4.4.4" xref="S3.SS2.p1.4.m4.4.4.4.5.cmml"><mo id="S3.SS2.p1.4.m4.4.4.4.4.5" stretchy="false" xref="S3.SS2.p1.4.m4.4.4.4.5.cmml">(</mo><msubsup id="S3.SS2.p1.4.m4.1.1.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.1.1.1.2.2" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.2.cmml">𝕩</mi><mi id="S3.SS2.p1.4.m4.1.1.1.1.1.3" xref="S3.SS2.p1.4.m4.1.1.1.1.1.3.cmml">t</mi><mrow id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.2" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.2.cmml">q</mi><mo id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.1" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.3" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.3.cmml">u</mi><mo id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.1a" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.4" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.4.cmml">e</mi><mo id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.1b" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.5" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.5.cmml">r</mi><mo id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.1c" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.6" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.6.cmml">y</mi></mrow></msubsup><mo id="S3.SS2.p1.4.m4.4.4.4.4.6" xref="S3.SS2.p1.4.m4.4.4.4.5.cmml">,</mo><msubsup id="S3.SS2.p1.4.m4.2.2.2.2.2" xref="S3.SS2.p1.4.m4.2.2.2.2.2.cmml"><mi id="S3.SS2.p1.4.m4.2.2.2.2.2.2.2" xref="S3.SS2.p1.4.m4.2.2.2.2.2.2.2.cmml">𝕩</mi><mi id="S3.SS2.p1.4.m4.2.2.2.2.2.3" xref="S3.SS2.p1.4.m4.2.2.2.2.2.3.cmml">t</mi><mrow id="S3.SS2.p1.4.m4.2.2.2.2.2.2.3" xref="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.cmml"><mi id="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.2" xref="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.1" xref="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.3" xref="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.3.cmml">e</mi><mo id="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.1a" xref="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.4" xref="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.4.cmml">x</mi><mo id="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.1b" xref="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.5" xref="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.5.cmml">t</mi></mrow></msubsup><mo id="S3.SS2.p1.4.m4.4.4.4.4.7" xref="S3.SS2.p1.4.m4.4.4.4.5.cmml">,</mo><msubsup id="S3.SS2.p1.4.m4.3.3.3.3.3" xref="S3.SS2.p1.4.m4.3.3.3.3.3.cmml"><mi id="S3.SS2.p1.4.m4.3.3.3.3.3.2.2" xref="S3.SS2.p1.4.m4.3.3.3.3.3.2.2.cmml">𝕩</mi><mi id="S3.SS2.p1.4.m4.3.3.3.3.3.3" xref="S3.SS2.p1.4.m4.3.3.3.3.3.3.cmml">t</mi><mrow id="S3.SS2.p1.4.m4.3.3.3.3.3.2.3" xref="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.cmml"><mi id="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.2" xref="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.2.cmml">i</mi><mo id="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.1" xref="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.3" xref="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.3.cmml">m</mi><mo id="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.1a" xref="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.4" xref="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.4.cmml">a</mi><mo id="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.1b" xref="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.5" xref="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.5.cmml">g</mi><mo id="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.1c" xref="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.6" xref="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.6.cmml">e</mi></mrow></msubsup><mo id="S3.SS2.p1.4.m4.4.4.4.4.8" xref="S3.SS2.p1.4.m4.4.4.4.5.cmml">,</mo><msubsup id="S3.SS2.p1.4.m4.4.4.4.4.4" xref="S3.SS2.p1.4.m4.4.4.4.4.4.cmml"><mi id="S3.SS2.p1.4.m4.4.4.4.4.4.2.2" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.2.cmml">𝕩</mi><mi id="S3.SS2.p1.4.m4.4.4.4.4.4.3" xref="S3.SS2.p1.4.m4.4.4.4.4.4.3.cmml">t</mi><mrow id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.cmml"><mi id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.2" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.2.cmml">a</mi><mo id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.1" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.3" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.3.cmml">t</mi><mo id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.1a" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.4" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.4.cmml">t</mi><mo id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.1b" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.5" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.5.cmml">r</mi><mo id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.1c" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.6" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.6.cmml">i</mi><mo id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.1d" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.7" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.7.cmml">b</mi><mo id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.1e" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.8" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.8.cmml">u</mi><mo id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.1f" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.9" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.9.cmml">t</mi><mo id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.1g" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.10" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.10.cmml">e</mi><mo id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.1h" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.11" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.11.cmml">s</mi></mrow></msubsup><mo id="S3.SS2.p1.4.m4.4.4.4.4.9" stretchy="false" xref="S3.SS2.p1.4.m4.4.4.4.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.4b"><apply id="S3.SS2.p1.4.m4.4.4.cmml" xref="S3.SS2.p1.4.m4.4.4"><eq id="S3.SS2.p1.4.m4.4.4.5.cmml" xref="S3.SS2.p1.4.m4.4.4.5"></eq><apply id="S3.SS2.p1.4.m4.4.4.6.cmml" xref="S3.SS2.p1.4.m4.4.4.6"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.4.4.6.1.cmml" xref="S3.SS2.p1.4.m4.4.4.6">subscript</csymbol><ci id="S3.SS2.p1.4.m4.4.4.6.2.cmml" xref="S3.SS2.p1.4.m4.4.4.6.2">𝕩</ci><ci id="S3.SS2.p1.4.m4.4.4.6.3.cmml" xref="S3.SS2.p1.4.m4.4.4.6.3">𝑡</ci></apply><vector id="S3.SS2.p1.4.m4.4.4.4.5.cmml" xref="S3.SS2.p1.4.m4.4.4.4.4"><apply id="S3.SS2.p1.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p1.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.2">𝕩</ci><apply id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3"><times id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.1"></times><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.2">𝑞</ci><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.3">𝑢</ci><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.4.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.4">𝑒</ci><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.5.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.5">𝑟</ci><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.6.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.6">𝑦</ci></apply></apply><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS2.p1.4.m4.2.2.2.2.2.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.2">subscript</csymbol><apply id="S3.SS2.p1.4.m4.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.2">superscript</csymbol><ci id="S3.SS2.p1.4.m4.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.2.2.2">𝕩</ci><apply id="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.2.2.3"><times id="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.1.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.1"></times><ci id="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.2.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.2">𝑡</ci><ci id="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.3.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.3">𝑒</ci><ci id="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.4.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.4">𝑥</ci><ci id="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.5.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.2.2.3.5">𝑡</ci></apply></apply><ci id="S3.SS2.p1.4.m4.2.2.2.2.2.3.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.2.3">𝑡</ci></apply><apply id="S3.SS2.p1.4.m4.3.3.3.3.3.cmml" xref="S3.SS2.p1.4.m4.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.3.3.3.3.3.1.cmml" xref="S3.SS2.p1.4.m4.3.3.3.3.3">subscript</csymbol><apply id="S3.SS2.p1.4.m4.3.3.3.3.3.2.cmml" xref="S3.SS2.p1.4.m4.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.3.3.3.3.3.2.1.cmml" xref="S3.SS2.p1.4.m4.3.3.3.3.3">superscript</csymbol><ci id="S3.SS2.p1.4.m4.3.3.3.3.3.2.2.cmml" xref="S3.SS2.p1.4.m4.3.3.3.3.3.2.2">𝕩</ci><apply id="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.cmml" xref="S3.SS2.p1.4.m4.3.3.3.3.3.2.3"><times id="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.1.cmml" xref="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.1"></times><ci id="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.2.cmml" xref="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.2">𝑖</ci><ci id="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.3.cmml" xref="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.3">𝑚</ci><ci id="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.4.cmml" xref="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.4">𝑎</ci><ci id="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.5.cmml" xref="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.5">𝑔</ci><ci id="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.6.cmml" xref="S3.SS2.p1.4.m4.3.3.3.3.3.2.3.6">𝑒</ci></apply></apply><ci id="S3.SS2.p1.4.m4.3.3.3.3.3.3.cmml" xref="S3.SS2.p1.4.m4.3.3.3.3.3.3">𝑡</ci></apply><apply id="S3.SS2.p1.4.m4.4.4.4.4.4.cmml" xref="S3.SS2.p1.4.m4.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.4.4.4.4.4.1.cmml" xref="S3.SS2.p1.4.m4.4.4.4.4.4">subscript</csymbol><apply id="S3.SS2.p1.4.m4.4.4.4.4.4.2.cmml" xref="S3.SS2.p1.4.m4.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.4.4.4.4.4.2.1.cmml" xref="S3.SS2.p1.4.m4.4.4.4.4.4">superscript</csymbol><ci id="S3.SS2.p1.4.m4.4.4.4.4.4.2.2.cmml" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.2">𝕩</ci><apply id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.cmml" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3"><times id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.1.cmml" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.1"></times><ci id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.2.cmml" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.2">𝑎</ci><ci id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.3.cmml" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.3">𝑡</ci><ci id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.4.cmml" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.4">𝑡</ci><ci id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.5.cmml" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.5">𝑟</ci><ci id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.6.cmml" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.6">𝑖</ci><ci id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.7.cmml" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.7">𝑏</ci><ci id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.8.cmml" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.8">𝑢</ci><ci id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.9.cmml" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.9">𝑡</ci><ci id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.10.cmml" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.10">𝑒</ci><ci id="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.11.cmml" xref="S3.SS2.p1.4.m4.4.4.4.4.4.2.3.11">𝑠</ci></apply></apply><ci id="S3.SS2.p1.4.m4.4.4.4.4.4.3.cmml" xref="S3.SS2.p1.4.m4.4.4.4.4.4.3">𝑡</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.4c">\mathbb{x}_{t}=(\mathbb{x}^{query}_{t},\mathbb{x}^{text}_{t},\mathbb{x}^{image%
}_{t},\mathbb{x}^{attributes}_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.4d">blackboard_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ( blackboard_x start_POSTSUPERSCRIPT italic_q italic_u italic_e italic_r italic_y end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , blackboard_x start_POSTSUPERSCRIPT italic_t italic_e italic_x italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , blackboard_x start_POSTSUPERSCRIPT italic_i italic_m italic_a italic_g italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , blackboard_x start_POSTSUPERSCRIPT italic_a italic_t italic_t italic_r italic_i italic_b italic_u italic_t italic_e italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>SEMINAR Model Architecture</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Our proposed model SEMINAR in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S2.F1" title="Figure 1 ‣ 2. Related Work ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> introduces a new network Pretraining Search Unit (PSU) to pretrain using dataset of the lifelong sequence of multi-modal query-item pairs. Section <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S3.SS3.SSS1" title="3.3.1. Pretraining Search Unit ‣ 3.3. SEMINAR Model Architecture ‣ 3. Proposed Model ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3.3.1</span></a> introduces the PSU and corresponding pretraining tasks. Section <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S3.SS3.SSS2" title="3.3.2. Fine-tuning the projection weight ‣ 3.3. SEMINAR Model Architecture ‣ 3. Proposed Model ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3.3.2</span></a> introduces how the recommendation model restores the pretrained query and item representations from PSU as initialization and applies a projection matrix to get the transformed representation of the sequence. Top-K relevant pairs are retrieved by the target pair and participate in the multi-head target attention (MHTA) calculation. Section <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S3.SS3.SSS3" title="3.3.3. Approximate Retrieval of Multi-Modal Query-Item Pair ‣ 3.3. SEMINAR Model Architecture ‣ 3. Proposed Model ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3.3.3</span></a> introduces the multi-modal product quantization approximation.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1. </span>Pretraining Search Unit</h4>
<div class="ltx_para" id="S3.SS3.SSS1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.p1.14">The input to PSU is the aligned sequence of query-item pairs as <math alttext="[\mathbb{x}_{l}]_{l=1:L}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.1.m1.1"><semantics id="S3.SS3.SSS1.p1.1.m1.1a"><msub id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml"><mrow id="S3.SS3.SSS1.p1.1.m1.1.1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.1.2.cmml"><mo id="S3.SS3.SSS1.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.p1.1.m1.1.1.1.2.1.cmml">[</mo><msub id="S3.SS3.SSS1.p1.1.m1.1.1.1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.1.m1.1.1.1.1.1.2" xref="S3.SS3.SSS1.p1.1.m1.1.1.1.1.1.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.p1.1.m1.1.1.1.1.1.3" xref="S3.SS3.SSS1.p1.1.m1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S3.SS3.SSS1.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.p1.1.m1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.SS3.SSS1.p1.1.m1.1.1.3" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.cmml"><mrow id="S3.SS3.SSS1.p1.1.m1.1.1.3.2" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.2.cmml"><mi id="S3.SS3.SSS1.p1.1.m1.1.1.3.2.2" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.2.2.cmml">l</mi><mo id="S3.SS3.SSS1.p1.1.m1.1.1.3.2.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.2.1.cmml">=</mo><mn id="S3.SS3.SSS1.p1.1.m1.1.1.3.2.3" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS3.SSS1.p1.1.m1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.1.cmml">:</mo><mi id="S3.SS3.SSS1.p1.1.m1.1.1.3.3" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.1b"><apply id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.p1.1.m1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.SSS1.p1.1.m1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS3.SSS1.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.1.1.1.2">𝕩</ci><ci id="S3.SS3.SSS1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.1.1.1.3">𝑙</ci></apply></apply><apply id="S3.SS3.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3"><ci id="S3.SS3.SSS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.1">:</ci><apply id="S3.SS3.SSS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.2"><eq id="S3.SS3.SSS1.p1.1.m1.1.1.3.2.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.2.1"></eq><ci id="S3.SS3.SSS1.p1.1.m1.1.1.3.2.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.2.2">𝑙</ci><cn id="S3.SS3.SSS1.p1.1.m1.1.1.3.2.3.cmml" type="integer" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.2.3">1</cn></apply><ci id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">[\mathbb{x}_{l}]_{l=1:L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.1.m1.1d">[ blackboard_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ] start_POSTSUBSCRIPT italic_l = 1 : italic_L end_POSTSUBSCRIPT</annotation></semantics></math>. <math alttext="L" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.2.m2.1"><semantics id="S3.SS3.SSS1.p1.2.m2.1a"><mi id="S3.SS3.SSS1.p1.2.m2.1.1" xref="S3.SS3.SSS1.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.2.m2.1b"><ci id="S3.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.2.m2.1d">italic_L</annotation></semantics></math> denotes the length of the aligned sequence and <math alttext="\mathbb{x}_{l}=(\mathbb{x}^{query}_{l},\mathbb{x}^{text}_{l},\mathbb{x}^{image%
}_{l},\mathbb{x}^{attributes}_{l})" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.3.m3.4"><semantics id="S3.SS3.SSS1.p1.3.m3.4a"><mrow id="S3.SS3.SSS1.p1.3.m3.4.4" xref="S3.SS3.SSS1.p1.3.m3.4.4.cmml"><msub id="S3.SS3.SSS1.p1.3.m3.4.4.6" xref="S3.SS3.SSS1.p1.3.m3.4.4.6.cmml"><mi id="S3.SS3.SSS1.p1.3.m3.4.4.6.2" xref="S3.SS3.SSS1.p1.3.m3.4.4.6.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.p1.3.m3.4.4.6.3" xref="S3.SS3.SSS1.p1.3.m3.4.4.6.3.cmml">l</mi></msub><mo id="S3.SS3.SSS1.p1.3.m3.4.4.5" xref="S3.SS3.SSS1.p1.3.m3.4.4.5.cmml">=</mo><mrow id="S3.SS3.SSS1.p1.3.m3.4.4.4.4" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.5.cmml"><mo id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.5" stretchy="false" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.5.cmml">(</mo><msubsup id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.2" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.3" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.3.cmml">l</mi><mrow id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.cmml"><mi id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.2" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.2.cmml">q</mi><mo id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.1" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.3" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.3.cmml">u</mi><mo id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.1a" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.4" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.4.cmml">e</mi><mo id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.1b" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.5" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.5.cmml">r</mi><mo id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.1c" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.6" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.6.cmml">y</mi></mrow></msubsup><mo id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.6" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.5.cmml">,</mo><msubsup id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.2" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.3" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.3.cmml">l</mi><mrow id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.cmml"><mi id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.2" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.1" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.3" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.3.cmml">e</mi><mo id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.1a" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.4" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.4.cmml">x</mi><mo id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.1b" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.5" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.5.cmml">t</mi></mrow></msubsup><mo id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.7" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.5.cmml">,</mo><msubsup id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.cmml"><mi id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.2" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.3" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.3.cmml">l</mi><mrow id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.cmml"><mi id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.2" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.2.cmml">i</mi><mo id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.1" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.3" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.3.cmml">m</mi><mo id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.1a" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.4" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.4.cmml">a</mi><mo id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.1b" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.5" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.5.cmml">g</mi><mo id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.1c" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.6" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.6.cmml">e</mi></mrow></msubsup><mo id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.8" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.5.cmml">,</mo><msubsup id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.cmml"><mi id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.2" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.3" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.3.cmml">l</mi><mrow id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.cmml"><mi id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.2" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.2.cmml">a</mi><mo id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.1" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.3" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.3.cmml">t</mi><mo id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.1a" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.4" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.4.cmml">t</mi><mo id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.1b" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.5" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.5.cmml">r</mi><mo id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.1c" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.6" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.6.cmml">i</mi><mo id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.1d" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.7" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.7.cmml">b</mi><mo id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.1e" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.8" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.8.cmml">u</mi><mo id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.1f" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.9" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.9.cmml">t</mi><mo id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.1g" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.10" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.10.cmml">e</mi><mo id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.1h" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.11" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.11.cmml">s</mi></mrow></msubsup><mo id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.9" stretchy="false" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.3.m3.4b"><apply id="S3.SS3.SSS1.p1.3.m3.4.4.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4"><eq id="S3.SS3.SSS1.p1.3.m3.4.4.5.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.5"></eq><apply id="S3.SS3.SSS1.p1.3.m3.4.4.6.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.6"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.3.m3.4.4.6.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.6">subscript</csymbol><ci id="S3.SS3.SSS1.p1.3.m3.4.4.6.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.6.2">𝕩</ci><ci id="S3.SS3.SSS1.p1.3.m3.4.4.6.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.6.3">𝑙</ci></apply><vector id="S3.SS3.SSS1.p1.3.m3.4.4.4.5.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4"><apply id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.2">𝕩</ci><apply id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3"><times id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.1"></times><ci id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.2">𝑞</ci><ci id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.3">𝑢</ci><ci id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.4.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.4">𝑒</ci><ci id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.5.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.5">𝑟</ci><ci id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.6.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.3.6">𝑦</ci></apply></apply><ci id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.3">𝑙</ci></apply><apply id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2">subscript</csymbol><apply id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2">superscript</csymbol><ci id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.2">𝕩</ci><apply id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3"><times id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.1"></times><ci id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.2">𝑡</ci><ci id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.3">𝑒</ci><ci id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.4.cmml" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.4">𝑥</ci><ci id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.5.cmml" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.2.3.5">𝑡</ci></apply></apply><ci id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.3">𝑙</ci></apply><apply id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3">subscript</csymbol><apply id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3">superscript</csymbol><ci id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.2">𝕩</ci><apply id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3"><times id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.1"></times><ci id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.2">𝑖</ci><ci id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.3">𝑚</ci><ci id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.4.cmml" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.4">𝑎</ci><ci id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.5.cmml" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.5">𝑔</ci><ci id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.6.cmml" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.2.3.6">𝑒</ci></apply></apply><ci id="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.3.3.3.3.3.3">𝑙</ci></apply><apply id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4">subscript</csymbol><apply id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4">superscript</csymbol><ci id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.2">𝕩</ci><apply id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3"><times id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.1"></times><ci id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.2">𝑎</ci><ci id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.3">𝑡</ci><ci id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.4.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.4">𝑡</ci><ci id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.5.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.5">𝑟</ci><ci id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.6.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.6">𝑖</ci><ci id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.7.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.7">𝑏</ci><ci id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.8.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.8">𝑢</ci><ci id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.9.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.9">𝑡</ci><ci id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.10.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.10">𝑒</ci><ci id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.11.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.2.3.11">𝑠</ci></apply></apply><ci id="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.4.4.4.4.3">𝑙</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.3.m3.4c">\mathbb{x}_{l}=(\mathbb{x}^{query}_{l},\mathbb{x}^{text}_{l},\mathbb{x}^{image%
}_{l},\mathbb{x}^{attributes}_{l})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.3.m3.4d">blackboard_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = ( blackboard_x start_POSTSUPERSCRIPT italic_q italic_u italic_e italic_r italic_y end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , blackboard_x start_POSTSUPERSCRIPT italic_t italic_e italic_x italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , blackboard_x start_POSTSUPERSCRIPT italic_i italic_m italic_a italic_g italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , blackboard_x start_POSTSUPERSCRIPT italic_a italic_t italic_t italic_r italic_i italic_b italic_u italic_t italic_e italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT )</annotation></semantics></math> represents the <math alttext="l" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.4.m4.1"><semantics id="S3.SS3.SSS1.p1.4.m4.1a"><mi id="S3.SS3.SSS1.p1.4.m4.1.1" xref="S3.SS3.SSS1.p1.4.m4.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.4.m4.1b"><ci id="S3.SS3.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.4.m4.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.4.m4.1d">italic_l</annotation></semantics></math>-th behavior in the sequence, which consists of the query embedding and multi-modal embedding. The query <math alttext="q\in\mathcal{Q}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.5.m5.1"><semantics id="S3.SS3.SSS1.p1.5.m5.1a"><mrow id="S3.SS3.SSS1.p1.5.m5.1.1" xref="S3.SS3.SSS1.p1.5.m5.1.1.cmml"><mi id="S3.SS3.SSS1.p1.5.m5.1.1.2" xref="S3.SS3.SSS1.p1.5.m5.1.1.2.cmml">q</mi><mo id="S3.SS3.SSS1.p1.5.m5.1.1.1" xref="S3.SS3.SSS1.p1.5.m5.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.5.m5.1.1.3" xref="S3.SS3.SSS1.p1.5.m5.1.1.3.cmml">𝒬</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.5.m5.1b"><apply id="S3.SS3.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1"><in id="S3.SS3.SSS1.p1.5.m5.1.1.1.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.1"></in><ci id="S3.SS3.SSS1.p1.5.m5.1.1.2.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.2">𝑞</ci><ci id="S3.SS3.SSS1.p1.5.m5.1.1.3.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.3">𝒬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.5.m5.1c">q\in\mathcal{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.5.m5.1d">italic_q ∈ caligraphic_Q</annotation></semantics></math> passes through the query feature encoder <math alttext="f(.)" class="ltx_math_unparsed" display="inline" id="S3.SS3.SSS1.p1.6.m6.1"><semantics id="S3.SS3.SSS1.p1.6.m6.1a"><mrow id="S3.SS3.SSS1.p1.6.m6.1b"><mi id="S3.SS3.SSS1.p1.6.m6.1.1">f</mi><mrow id="S3.SS3.SSS1.p1.6.m6.1.2"><mo id="S3.SS3.SSS1.p1.6.m6.1.2.1" stretchy="false">(</mo><mo id="S3.SS3.SSS1.p1.6.m6.1.2.2" lspace="0em" rspace="0.167em">.</mo><mo id="S3.SS3.SSS1.p1.6.m6.1.2.3" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.6.m6.1c">f(.)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.6.m6.1d">italic_f ( . )</annotation></semantics></math>, resulting in <math alttext="Q=f(\mathbb{x}^{query}_{1:L})\in\mathbb{R}^{L\times d_{query}}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.7.m7.1"><semantics id="S3.SS3.SSS1.p1.7.m7.1a"><mrow id="S3.SS3.SSS1.p1.7.m7.1.1" xref="S3.SS3.SSS1.p1.7.m7.1.1.cmml"><mi id="S3.SS3.SSS1.p1.7.m7.1.1.3" xref="S3.SS3.SSS1.p1.7.m7.1.1.3.cmml">Q</mi><mo id="S3.SS3.SSS1.p1.7.m7.1.1.4" xref="S3.SS3.SSS1.p1.7.m7.1.1.4.cmml">=</mo><mrow id="S3.SS3.SSS1.p1.7.m7.1.1.1" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.7.m7.1.1.1.3" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.3.cmml">f</mi><mo id="S3.SS3.SSS1.p1.7.m7.1.1.1.2" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.2" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.2.cmml">𝕩</mi><mrow id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.3" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.3.cmml"><mn id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.3.2" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.3.3" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.3.3.cmml">L</mi></mrow><mrow id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.2" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.2.cmml">q</mi><mo id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.1" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.3" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.3.cmml">u</mi><mo id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.1a" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.4" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.4.cmml">e</mi><mo id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.1b" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.5" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.5.cmml">r</mi><mo id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.1c" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.6" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.6.cmml">y</mi></mrow></msubsup><mo id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS1.p1.7.m7.1.1.5" xref="S3.SS3.SSS1.p1.7.m7.1.1.5.cmml">∈</mo><msup id="S3.SS3.SSS1.p1.7.m7.1.1.6" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.cmml"><mi id="S3.SS3.SSS1.p1.7.m7.1.1.6.2" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.p1.7.m7.1.1.6.3" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.cmml"><mi id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.2" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.2.cmml">L</mi><mo id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.1.cmml">×</mo><msub id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.cmml"><mi id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.2" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.2.cmml">d</mi><mrow id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.cmml"><mi id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.2" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.2.cmml">q</mi><mo id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.1" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.3" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.3.cmml">u</mi><mo id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.1a" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.4" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.4.cmml">e</mi><mo id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.1b" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.5" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.5.cmml">r</mi><mo id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.1c" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.6" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.6.cmml">y</mi></mrow></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.7.m7.1b"><apply id="S3.SS3.SSS1.p1.7.m7.1.1.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1"><and id="S3.SS3.SSS1.p1.7.m7.1.1a.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1"></and><apply id="S3.SS3.SSS1.p1.7.m7.1.1b.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1"><eq id="S3.SS3.SSS1.p1.7.m7.1.1.4.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.4"></eq><ci id="S3.SS3.SSS1.p1.7.m7.1.1.3.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.3">𝑄</ci><apply id="S3.SS3.SSS1.p1.7.m7.1.1.1.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.1"><times id="S3.SS3.SSS1.p1.7.m7.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.2"></times><ci id="S3.SS3.SSS1.p1.7.m7.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.3">𝑓</ci><apply id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.2">𝕩</ci><apply id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3"><times id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.1"></times><ci id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.2">𝑞</ci><ci id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.3">𝑢</ci><ci id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.4.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.4">𝑒</ci><ci id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.5.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.5">𝑟</ci><ci id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.6.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.6">𝑦</ci></apply></apply><apply id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.3"><ci id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.3.1">:</ci><cn id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.3.2">1</cn><ci id="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.1.1.1.1.3.3">𝐿</ci></apply></apply></apply></apply><apply id="S3.SS3.SSS1.p1.7.m7.1.1c.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1"><in id="S3.SS3.SSS1.p1.7.m7.1.1.5.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.5"></in><share href="https://arxiv.org/html/2407.10714v1#S3.SS3.SSS1.p1.7.m7.1.1.1.cmml" id="S3.SS3.SSS1.p1.7.m7.1.1d.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1"></share><apply id="S3.SS3.SSS1.p1.7.m7.1.1.6.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.6"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m7.1.1.6.1.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.6">superscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m7.1.1.6.2.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.2">ℝ</ci><apply id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3"><times id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.1.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.1"></times><ci id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.2.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.2">𝐿</ci><apply id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.1.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.2.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.2">𝑑</ci><apply id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3"><times id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.1.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.1"></times><ci id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.2.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.2">𝑞</ci><ci id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.3">𝑢</ci><ci id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.4.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.4">𝑒</ci><ci id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.5.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.5">𝑟</ci><ci id="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.6.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.6.3.3.3.6">𝑦</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.7.m7.1c">Q=f(\mathbb{x}^{query}_{1:L})\in\mathbb{R}^{L\times d_{query}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.7.m7.1d">italic_Q = italic_f ( blackboard_x start_POSTSUPERSCRIPT italic_q italic_u italic_e italic_r italic_y end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 : italic_L end_POSTSUBSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_L × italic_d start_POSTSUBSCRIPT italic_q italic_u italic_e italic_r italic_y end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. Following the multi-modal alignment literature such as CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib14" title="">2021</a>)</cite>, we use Transformer <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib19" title="">2023</a>)</cite> to encode the text feature as <math alttext="T=\text{Encoder}_{text}(\mathbb{x}^{text}_{1:L})\in\mathbb{R}^{L\times d_{text}}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.8.m8.1"><semantics id="S3.SS3.SSS1.p1.8.m8.1a"><mrow id="S3.SS3.SSS1.p1.8.m8.1.1" xref="S3.SS3.SSS1.p1.8.m8.1.1.cmml"><mi id="S3.SS3.SSS1.p1.8.m8.1.1.3" xref="S3.SS3.SSS1.p1.8.m8.1.1.3.cmml">T</mi><mo id="S3.SS3.SSS1.p1.8.m8.1.1.4" xref="S3.SS3.SSS1.p1.8.m8.1.1.4.cmml">=</mo><mrow id="S3.SS3.SSS1.p1.8.m8.1.1.1" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.cmml"><msub id="S3.SS3.SSS1.p1.8.m8.1.1.1.3" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.3.cmml"><mtext id="S3.SS3.SSS1.p1.8.m8.1.1.1.3.2" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.3.2a.cmml">Encoder</mtext><mrow id="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.cmml"><mi id="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.2" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.2.cmml">t</mi><mo id="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.1" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.3" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.3.cmml">e</mi><mo id="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.1a" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.4" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.4.cmml">x</mi><mo id="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.1b" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.5" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.5.cmml">t</mi></mrow></msub><mo id="S3.SS3.SSS1.p1.8.m8.1.1.1.2" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.2" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.2.cmml">𝕩</mi><mrow id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.3" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.3.cmml"><mn id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.3.2" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.3.3" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.3.3.cmml">L</mi></mrow><mrow id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.2" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.1" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.3" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.3.cmml">e</mi><mo id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.1a" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.4" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.4.cmml">x</mi><mo id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.1b" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.5" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.5.cmml">t</mi></mrow></msubsup><mo id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS1.p1.8.m8.1.1.5" xref="S3.SS3.SSS1.p1.8.m8.1.1.5.cmml">∈</mo><msup id="S3.SS3.SSS1.p1.8.m8.1.1.6" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.cmml"><mi id="S3.SS3.SSS1.p1.8.m8.1.1.6.2" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.p1.8.m8.1.1.6.3" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.cmml"><mi id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.2" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.2.cmml">L</mi><mo id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.1.cmml">×</mo><msub id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.cmml"><mi id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.2" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.2.cmml">d</mi><mrow id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.cmml"><mi id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.2" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.2.cmml">t</mi><mo id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.1" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.3" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.3.cmml">e</mi><mo id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.1a" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.4" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.4.cmml">x</mi><mo id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.1b" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.5" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.5.cmml">t</mi></mrow></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.8.m8.1b"><apply id="S3.SS3.SSS1.p1.8.m8.1.1.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1"><and id="S3.SS3.SSS1.p1.8.m8.1.1a.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1"></and><apply id="S3.SS3.SSS1.p1.8.m8.1.1b.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1"><eq id="S3.SS3.SSS1.p1.8.m8.1.1.4.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.4"></eq><ci id="S3.SS3.SSS1.p1.8.m8.1.1.3.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.3">𝑇</ci><apply id="S3.SS3.SSS1.p1.8.m8.1.1.1.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1"><times id="S3.SS3.SSS1.p1.8.m8.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.2"></times><apply id="S3.SS3.SSS1.p1.8.m8.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.8.m8.1.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.8.m8.1.1.1.3.2a.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.3.2"><mtext id="S3.SS3.SSS1.p1.8.m8.1.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.3.2">Encoder</mtext></ci><apply id="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3"><times id="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.1"></times><ci id="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.2">𝑡</ci><ci id="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.3">𝑒</ci><ci id="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.4.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.4">𝑥</ci><ci id="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.5.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.3.3.5">𝑡</ci></apply></apply><apply id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.2">𝕩</ci><apply id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3"><times id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.1"></times><ci id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.2">𝑡</ci><ci id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.3">𝑒</ci><ci id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.4.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.4">𝑥</ci><ci id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.5.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.2.3.5">𝑡</ci></apply></apply><apply id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.3"><ci id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.3.1">:</ci><cn id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.3.2">1</cn><ci id="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.1.1.1.1.3.3">𝐿</ci></apply></apply></apply></apply><apply id="S3.SS3.SSS1.p1.8.m8.1.1c.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1"><in id="S3.SS3.SSS1.p1.8.m8.1.1.5.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.5"></in><share href="https://arxiv.org/html/2407.10714v1#S3.SS3.SSS1.p1.8.m8.1.1.1.cmml" id="S3.SS3.SSS1.p1.8.m8.1.1d.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1"></share><apply id="S3.SS3.SSS1.p1.8.m8.1.1.6.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.6"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.8.m8.1.1.6.1.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.6">superscript</csymbol><ci id="S3.SS3.SSS1.p1.8.m8.1.1.6.2.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.2">ℝ</ci><apply id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3"><times id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.1.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.1"></times><ci id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.2.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.2">𝐿</ci><apply id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.1.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.2.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.2">𝑑</ci><apply id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3"><times id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.1.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.1"></times><ci id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.2.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.2">𝑡</ci><ci id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.3">𝑒</ci><ci id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.4.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.4">𝑥</ci><ci id="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.5.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.6.3.3.3.5">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.8.m8.1c">T=\text{Encoder}_{text}(\mathbb{x}^{text}_{1:L})\in\mathbb{R}^{L\times d_{text}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.8.m8.1d">italic_T = Encoder start_POSTSUBSCRIPT italic_t italic_e italic_x italic_t end_POSTSUBSCRIPT ( blackboard_x start_POSTSUPERSCRIPT italic_t italic_e italic_x italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 : italic_L end_POSTSUBSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_L × italic_d start_POSTSUBSCRIPT italic_t italic_e italic_x italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and ViT <cite class="ltx_cite ltx_citemacro_citep">(Dosovitskiy et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib6" title="">2020</a>)</cite> to encode the image features as <math alttext="I=\text{Encoder}_{image}(\mathbb{x}^{image}_{1:L})\in\mathbb{R}^{L\times d_{%
image}}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.9.m9.1"><semantics id="S3.SS3.SSS1.p1.9.m9.1a"><mrow id="S3.SS3.SSS1.p1.9.m9.1.1" xref="S3.SS3.SSS1.p1.9.m9.1.1.cmml"><mi id="S3.SS3.SSS1.p1.9.m9.1.1.3" xref="S3.SS3.SSS1.p1.9.m9.1.1.3.cmml">I</mi><mo id="S3.SS3.SSS1.p1.9.m9.1.1.4" xref="S3.SS3.SSS1.p1.9.m9.1.1.4.cmml">=</mo><mrow id="S3.SS3.SSS1.p1.9.m9.1.1.1" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.cmml"><msub id="S3.SS3.SSS1.p1.9.m9.1.1.1.3" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.cmml"><mtext id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.2" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.2a.cmml">Encoder</mtext><mrow id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.cmml"><mi id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.2" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.2.cmml">i</mi><mo id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.1" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.3" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.3.cmml">m</mi><mo id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.1a" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.4" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.4.cmml">a</mi><mo id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.1b" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.5" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.5.cmml">g</mi><mo id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.1c" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.6" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.6.cmml">e</mi></mrow></msub><mo id="S3.SS3.SSS1.p1.9.m9.1.1.1.2" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.2" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.2.cmml">𝕩</mi><mrow id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.3" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.3.cmml"><mn id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.3.2" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.3.3" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.3.3.cmml">L</mi></mrow><mrow id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.2" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.1" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.3" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.3.cmml">m</mi><mo id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.1a" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.4" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.4.cmml">a</mi><mo id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.1b" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.5" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.5.cmml">g</mi><mo id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.1c" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.6" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.6.cmml">e</mi></mrow></msubsup><mo id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS1.p1.9.m9.1.1.5" xref="S3.SS3.SSS1.p1.9.m9.1.1.5.cmml">∈</mo><msup id="S3.SS3.SSS1.p1.9.m9.1.1.6" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.cmml"><mi id="S3.SS3.SSS1.p1.9.m9.1.1.6.2" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.p1.9.m9.1.1.6.3" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.cmml"><mi id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.2" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.2.cmml">L</mi><mo id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.1.cmml">×</mo><msub id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.cmml"><mi id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.2" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.2.cmml">d</mi><mrow id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.cmml"><mi id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.2" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.2.cmml">i</mi><mo id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.1" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.3" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.3.cmml">m</mi><mo id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.1a" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.4" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.4.cmml">a</mi><mo id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.1b" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.5" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.5.cmml">g</mi><mo id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.1c" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.6" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.6.cmml">e</mi></mrow></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.9.m9.1b"><apply id="S3.SS3.SSS1.p1.9.m9.1.1.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1"><and id="S3.SS3.SSS1.p1.9.m9.1.1a.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1"></and><apply id="S3.SS3.SSS1.p1.9.m9.1.1b.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1"><eq id="S3.SS3.SSS1.p1.9.m9.1.1.4.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.4"></eq><ci id="S3.SS3.SSS1.p1.9.m9.1.1.3.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.3">𝐼</ci><apply id="S3.SS3.SSS1.p1.9.m9.1.1.1.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1"><times id="S3.SS3.SSS1.p1.9.m9.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.2"></times><apply id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.2a.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.2"><mtext id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.2">Encoder</mtext></ci><apply id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3"><times id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.1"></times><ci id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.2">𝑖</ci><ci id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.3">𝑚</ci><ci id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.4.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.4">𝑎</ci><ci id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.5.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.5">𝑔</ci><ci id="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.6.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.3.3.6">𝑒</ci></apply></apply><apply id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.2">𝕩</ci><apply id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3"><times id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.1"></times><ci id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.3">𝑚</ci><ci id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.4.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.4">𝑎</ci><ci id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.5.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.5">𝑔</ci><ci id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.6.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.2.3.6">𝑒</ci></apply></apply><apply id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.3"><ci id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.3.1">:</ci><cn id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.3.2">1</cn><ci id="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.1.1.1.1.3.3">𝐿</ci></apply></apply></apply></apply><apply id="S3.SS3.SSS1.p1.9.m9.1.1c.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1"><in id="S3.SS3.SSS1.p1.9.m9.1.1.5.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.5"></in><share href="https://arxiv.org/html/2407.10714v1#S3.SS3.SSS1.p1.9.m9.1.1.1.cmml" id="S3.SS3.SSS1.p1.9.m9.1.1d.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1"></share><apply id="S3.SS3.SSS1.p1.9.m9.1.1.6.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.6"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.9.m9.1.1.6.1.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.6">superscript</csymbol><ci id="S3.SS3.SSS1.p1.9.m9.1.1.6.2.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.2">ℝ</ci><apply id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3"><times id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.1.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.1"></times><ci id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.2.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.2">𝐿</ci><apply id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.1.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.2.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.2">𝑑</ci><apply id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3"><times id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.1.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.1"></times><ci id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.2.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.2">𝑖</ci><ci id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.3">𝑚</ci><ci id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.4.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.4">𝑎</ci><ci id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.5.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.5">𝑔</ci><ci id="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.6.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.6.3.3.3.6">𝑒</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.9.m9.1c">I=\text{Encoder}_{image}(\mathbb{x}^{image}_{1:L})\in\mathbb{R}^{L\times d_{%
image}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.9.m9.1d">italic_I = Encoder start_POSTSUBSCRIPT italic_i italic_m italic_a italic_g italic_e end_POSTSUBSCRIPT ( blackboard_x start_POSTSUPERSCRIPT italic_i italic_m italic_a italic_g italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 : italic_L end_POSTSUBSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_L × italic_d start_POSTSUBSCRIPT italic_i italic_m italic_a italic_g italic_e end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. Additionally, we encode features of the attributes using the function <math alttext="g(.)" class="ltx_math_unparsed" display="inline" id="S3.SS3.SSS1.p1.10.m10.1"><semantics id="S3.SS3.SSS1.p1.10.m10.1a"><mrow id="S3.SS3.SSS1.p1.10.m10.1b"><mi id="S3.SS3.SSS1.p1.10.m10.1.1">g</mi><mrow id="S3.SS3.SSS1.p1.10.m10.1.2"><mo id="S3.SS3.SSS1.p1.10.m10.1.2.1" stretchy="false">(</mo><mo id="S3.SS3.SSS1.p1.10.m10.1.2.2" lspace="0em" rspace="0.167em">.</mo><mo id="S3.SS3.SSS1.p1.10.m10.1.2.3" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.10.m10.1c">g(.)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.10.m10.1d">italic_g ( . )</annotation></semantics></math>. <math alttext="A=g(\mathbb{x}^{attribute}_{1:L})\in\mathbb{R}^{L\times d_{attribute}}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.11.m11.1"><semantics id="S3.SS3.SSS1.p1.11.m11.1a"><mrow id="S3.SS3.SSS1.p1.11.m11.1.1" xref="S3.SS3.SSS1.p1.11.m11.1.1.cmml"><mi id="S3.SS3.SSS1.p1.11.m11.1.1.3" xref="S3.SS3.SSS1.p1.11.m11.1.1.3.cmml">A</mi><mo id="S3.SS3.SSS1.p1.11.m11.1.1.4" xref="S3.SS3.SSS1.p1.11.m11.1.1.4.cmml">=</mo><mrow id="S3.SS3.SSS1.p1.11.m11.1.1.1" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.11.m11.1.1.1.3" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.3.cmml">g</mi><mo id="S3.SS3.SSS1.p1.11.m11.1.1.1.2" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.2" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.2.cmml">𝕩</mi><mrow id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.3" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.3.cmml"><mn id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.3.2" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.3.3" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.3.3.cmml">L</mi></mrow><mrow id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.2" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.2.cmml">a</mi><mo id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.1" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.3" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.3.cmml">t</mi><mo id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.1a" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.4" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.4.cmml">t</mi><mo id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.1b" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.5" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.5.cmml">r</mi><mo id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.1c" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.6" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.6.cmml">i</mi><mo id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.1d" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.7" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.7.cmml">b</mi><mo id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.1e" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.8" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.8.cmml">u</mi><mo id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.1f" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.9" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.9.cmml">t</mi><mo id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.1g" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.10" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.10.cmml">e</mi></mrow></msubsup><mo id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS1.p1.11.m11.1.1.5" xref="S3.SS3.SSS1.p1.11.m11.1.1.5.cmml">∈</mo><msup id="S3.SS3.SSS1.p1.11.m11.1.1.6" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.cmml"><mi id="S3.SS3.SSS1.p1.11.m11.1.1.6.2" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.p1.11.m11.1.1.6.3" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.cmml"><mi id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.2" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.2.cmml">L</mi><mo id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.1.cmml">×</mo><msub id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.cmml"><mi id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.2" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.2.cmml">d</mi><mrow id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.cmml"><mi id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.2" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.2.cmml">a</mi><mo id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.1" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.3" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.3.cmml">t</mi><mo id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.1a" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.4" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.4.cmml">t</mi><mo id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.1b" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.5" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.5.cmml">r</mi><mo id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.1c" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.6" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.6.cmml">i</mi><mo id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.1d" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.7" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.7.cmml">b</mi><mo id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.1e" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.8" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.8.cmml">u</mi><mo id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.1f" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.9" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.9.cmml">t</mi><mo id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.1g" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.10" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.10.cmml">e</mi></mrow></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.11.m11.1b"><apply id="S3.SS3.SSS1.p1.11.m11.1.1.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1"><and id="S3.SS3.SSS1.p1.11.m11.1.1a.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1"></and><apply id="S3.SS3.SSS1.p1.11.m11.1.1b.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1"><eq id="S3.SS3.SSS1.p1.11.m11.1.1.4.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.4"></eq><ci id="S3.SS3.SSS1.p1.11.m11.1.1.3.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.3">𝐴</ci><apply id="S3.SS3.SSS1.p1.11.m11.1.1.1.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1"><times id="S3.SS3.SSS1.p1.11.m11.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.2"></times><ci id="S3.SS3.SSS1.p1.11.m11.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.3">𝑔</ci><apply id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.2">𝕩</ci><apply id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3"><times id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.1"></times><ci id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.2">𝑎</ci><ci id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.3">𝑡</ci><ci id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.4.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.4">𝑡</ci><ci id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.5.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.5">𝑟</ci><ci id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.6.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.6">𝑖</ci><ci id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.7.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.7">𝑏</ci><ci id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.8.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.8">𝑢</ci><ci id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.9.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.9">𝑡</ci><ci id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.10.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.10">𝑒</ci></apply></apply><apply id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.3"><ci id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.3.1">:</ci><cn id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.3.2">1</cn><ci id="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.1.1.1.1.3.3">𝐿</ci></apply></apply></apply></apply><apply id="S3.SS3.SSS1.p1.11.m11.1.1c.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1"><in id="S3.SS3.SSS1.p1.11.m11.1.1.5.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.5"></in><share href="https://arxiv.org/html/2407.10714v1#S3.SS3.SSS1.p1.11.m11.1.1.1.cmml" id="S3.SS3.SSS1.p1.11.m11.1.1d.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1"></share><apply id="S3.SS3.SSS1.p1.11.m11.1.1.6.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.6"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.11.m11.1.1.6.1.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.6">superscript</csymbol><ci id="S3.SS3.SSS1.p1.11.m11.1.1.6.2.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.2">ℝ</ci><apply id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3"><times id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.1.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.1"></times><ci id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.2.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.2">𝐿</ci><apply id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.1.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.2.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.2">𝑑</ci><apply id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3"><times id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.1.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.1"></times><ci id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.2.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.2">𝑎</ci><ci id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.3">𝑡</ci><ci id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.4.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.4">𝑡</ci><ci id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.5.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.5">𝑟</ci><ci id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.6.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.6">𝑖</ci><ci id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.7.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.7">𝑏</ci><ci id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.8.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.8">𝑢</ci><ci id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.9.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.9">𝑡</ci><ci id="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.10.cmml" xref="S3.SS3.SSS1.p1.11.m11.1.1.6.3.3.3.10">𝑒</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.11.m11.1c">A=g(\mathbb{x}^{attribute}_{1:L})\in\mathbb{R}^{L\times d_{attribute}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.11.m11.1d">italic_A = italic_g ( blackboard_x start_POSTSUPERSCRIPT italic_a italic_t italic_t italic_r italic_i italic_b italic_u italic_t italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 : italic_L end_POSTSUBSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_L × italic_d start_POSTSUBSCRIPT italic_a italic_t italic_t italic_r italic_i italic_b italic_u italic_t italic_e end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is treated as one channel of the sub-sequence which participates in the multi-modal alignment of the item sequence. To project the representations of different channels to the same dimension <math alttext="d" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.12.m12.1"><semantics id="S3.SS3.SSS1.p1.12.m12.1a"><mi id="S3.SS3.SSS1.p1.12.m12.1.1" xref="S3.SS3.SSS1.p1.12.m12.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.12.m12.1b"><ci id="S3.SS3.SSS1.p1.12.m12.1.1.cmml" xref="S3.SS3.SSS1.p1.12.m12.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.12.m12.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.12.m12.1d">italic_d</annotation></semantics></math>, we further multiply them by linear weight matrix <math alttext="\{W_{q},W_{t},W_{i},W_{a}\}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.13.m13.4"><semantics id="S3.SS3.SSS1.p1.13.m13.4a"><mrow id="S3.SS3.SSS1.p1.13.m13.4.4.4" xref="S3.SS3.SSS1.p1.13.m13.4.4.5.cmml"><mo id="S3.SS3.SSS1.p1.13.m13.4.4.4.5" stretchy="false" xref="S3.SS3.SSS1.p1.13.m13.4.4.5.cmml">{</mo><msub id="S3.SS3.SSS1.p1.13.m13.1.1.1.1" xref="S3.SS3.SSS1.p1.13.m13.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.13.m13.1.1.1.1.2" xref="S3.SS3.SSS1.p1.13.m13.1.1.1.1.2.cmml">W</mi><mi id="S3.SS3.SSS1.p1.13.m13.1.1.1.1.3" xref="S3.SS3.SSS1.p1.13.m13.1.1.1.1.3.cmml">q</mi></msub><mo id="S3.SS3.SSS1.p1.13.m13.4.4.4.6" xref="S3.SS3.SSS1.p1.13.m13.4.4.5.cmml">,</mo><msub id="S3.SS3.SSS1.p1.13.m13.2.2.2.2" xref="S3.SS3.SSS1.p1.13.m13.2.2.2.2.cmml"><mi id="S3.SS3.SSS1.p1.13.m13.2.2.2.2.2" xref="S3.SS3.SSS1.p1.13.m13.2.2.2.2.2.cmml">W</mi><mi id="S3.SS3.SSS1.p1.13.m13.2.2.2.2.3" xref="S3.SS3.SSS1.p1.13.m13.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS3.SSS1.p1.13.m13.4.4.4.7" xref="S3.SS3.SSS1.p1.13.m13.4.4.5.cmml">,</mo><msub id="S3.SS3.SSS1.p1.13.m13.3.3.3.3" xref="S3.SS3.SSS1.p1.13.m13.3.3.3.3.cmml"><mi id="S3.SS3.SSS1.p1.13.m13.3.3.3.3.2" xref="S3.SS3.SSS1.p1.13.m13.3.3.3.3.2.cmml">W</mi><mi id="S3.SS3.SSS1.p1.13.m13.3.3.3.3.3" xref="S3.SS3.SSS1.p1.13.m13.3.3.3.3.3.cmml">i</mi></msub><mo id="S3.SS3.SSS1.p1.13.m13.4.4.4.8" xref="S3.SS3.SSS1.p1.13.m13.4.4.5.cmml">,</mo><msub id="S3.SS3.SSS1.p1.13.m13.4.4.4.4" xref="S3.SS3.SSS1.p1.13.m13.4.4.4.4.cmml"><mi id="S3.SS3.SSS1.p1.13.m13.4.4.4.4.2" xref="S3.SS3.SSS1.p1.13.m13.4.4.4.4.2.cmml">W</mi><mi id="S3.SS3.SSS1.p1.13.m13.4.4.4.4.3" xref="S3.SS3.SSS1.p1.13.m13.4.4.4.4.3.cmml">a</mi></msub><mo id="S3.SS3.SSS1.p1.13.m13.4.4.4.9" stretchy="false" xref="S3.SS3.SSS1.p1.13.m13.4.4.5.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.13.m13.4b"><set id="S3.SS3.SSS1.p1.13.m13.4.4.5.cmml" xref="S3.SS3.SSS1.p1.13.m13.4.4.4"><apply id="S3.SS3.SSS1.p1.13.m13.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.13.m13.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.13.m13.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.13.m13.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.13.m13.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.13.m13.1.1.1.1.2">𝑊</ci><ci id="S3.SS3.SSS1.p1.13.m13.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.13.m13.1.1.1.1.3">𝑞</ci></apply><apply id="S3.SS3.SSS1.p1.13.m13.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.13.m13.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.13.m13.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.p1.13.m13.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.13.m13.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.13.m13.2.2.2.2.2">𝑊</ci><ci id="S3.SS3.SSS1.p1.13.m13.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.13.m13.2.2.2.2.3">𝑡</ci></apply><apply id="S3.SS3.SSS1.p1.13.m13.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.13.m13.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.13.m13.3.3.3.3.1.cmml" xref="S3.SS3.SSS1.p1.13.m13.3.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.13.m13.3.3.3.3.2.cmml" xref="S3.SS3.SSS1.p1.13.m13.3.3.3.3.2">𝑊</ci><ci id="S3.SS3.SSS1.p1.13.m13.3.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.13.m13.3.3.3.3.3">𝑖</ci></apply><apply id="S3.SS3.SSS1.p1.13.m13.4.4.4.4.cmml" xref="S3.SS3.SSS1.p1.13.m13.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.13.m13.4.4.4.4.1.cmml" xref="S3.SS3.SSS1.p1.13.m13.4.4.4.4">subscript</csymbol><ci id="S3.SS3.SSS1.p1.13.m13.4.4.4.4.2.cmml" xref="S3.SS3.SSS1.p1.13.m13.4.4.4.4.2">𝑊</ci><ci id="S3.SS3.SSS1.p1.13.m13.4.4.4.4.3.cmml" xref="S3.SS3.SSS1.p1.13.m13.4.4.4.4.3">𝑎</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.13.m13.4c">\{W_{q},W_{t},W_{i},W_{a}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.13.m13.4d">{ italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT }</annotation></semantics></math> and get the stacked input sequence of multi-modal query-item pairs as follows: <math alttext="\mathbb{x}=[QW_{q},TW_{t},IW_{i},AW_{a}]\in\mathbb{R}^{(M+1)\times L\times d}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.14.m14.5"><semantics id="S3.SS3.SSS1.p1.14.m14.5a"><mrow id="S3.SS3.SSS1.p1.14.m14.5.5" xref="S3.SS3.SSS1.p1.14.m14.5.5.cmml"><mi id="S3.SS3.SSS1.p1.14.m14.5.5.6" xref="S3.SS3.SSS1.p1.14.m14.5.5.6.cmml">𝕩</mi><mo id="S3.SS3.SSS1.p1.14.m14.5.5.7" xref="S3.SS3.SSS1.p1.14.m14.5.5.7.cmml">=</mo><mrow id="S3.SS3.SSS1.p1.14.m14.5.5.4.4" xref="S3.SS3.SSS1.p1.14.m14.5.5.4.5.cmml"><mo id="S3.SS3.SSS1.p1.14.m14.5.5.4.4.5" stretchy="false" xref="S3.SS3.SSS1.p1.14.m14.5.5.4.5.cmml">[</mo><mrow id="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1" xref="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.2" xref="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.2.cmml">Q</mi><mo id="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.1" xref="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.1.cmml">⁢</mo><msub id="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.3" xref="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.3.cmml"><mi id="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.3.2" xref="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.3.2.cmml">W</mi><mi id="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.3.3" xref="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.3.3.cmml">q</mi></msub></mrow><mo id="S3.SS3.SSS1.p1.14.m14.5.5.4.4.6" xref="S3.SS3.SSS1.p1.14.m14.5.5.4.5.cmml">,</mo><mrow id="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2" xref="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.cmml"><mi id="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.2" xref="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.2.cmml">T</mi><mo id="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.1" xref="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.1.cmml">⁢</mo><msub id="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.3" xref="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.3.cmml"><mi id="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.3.2" xref="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.3.2.cmml">W</mi><mi id="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.3.3" xref="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.3.3.cmml">t</mi></msub></mrow><mo id="S3.SS3.SSS1.p1.14.m14.5.5.4.4.7" xref="S3.SS3.SSS1.p1.14.m14.5.5.4.5.cmml">,</mo><mrow id="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3" xref="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.cmml"><mi id="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.2" xref="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.2.cmml">I</mi><mo id="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.1" xref="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.1.cmml">⁢</mo><msub id="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.3" xref="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.3.cmml"><mi id="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.3.2" xref="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.3.2.cmml">W</mi><mi id="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.3.3" xref="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.3.3.cmml">i</mi></msub></mrow><mo id="S3.SS3.SSS1.p1.14.m14.5.5.4.4.8" xref="S3.SS3.SSS1.p1.14.m14.5.5.4.5.cmml">,</mo><mrow id="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4" xref="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.cmml"><mi id="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.2" xref="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.2.cmml">A</mi><mo id="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.1" xref="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.1.cmml">⁢</mo><msub id="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.3" xref="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.3.cmml"><mi id="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.3.2" xref="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.3.2.cmml">W</mi><mi id="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.3.3" xref="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.3.3.cmml">a</mi></msub></mrow><mo id="S3.SS3.SSS1.p1.14.m14.5.5.4.4.9" stretchy="false" xref="S3.SS3.SSS1.p1.14.m14.5.5.4.5.cmml">]</mo></mrow><mo id="S3.SS3.SSS1.p1.14.m14.5.5.8" xref="S3.SS3.SSS1.p1.14.m14.5.5.8.cmml">∈</mo><msup id="S3.SS3.SSS1.p1.14.m14.5.5.9" xref="S3.SS3.SSS1.p1.14.m14.5.5.9.cmml"><mi id="S3.SS3.SSS1.p1.14.m14.5.5.9.2" xref="S3.SS3.SSS1.p1.14.m14.5.5.9.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.p1.14.m14.1.1.1" xref="S3.SS3.SSS1.p1.14.m14.1.1.1.cmml"><mrow id="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1" xref="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1.1" xref="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1.1.2" xref="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1.1.2.cmml">M</mi><mo id="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1.1.1" xref="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1.1.3" xref="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS3.SSS1.p1.14.m14.1.1.1.2" rspace="0.222em" xref="S3.SS3.SSS1.p1.14.m14.1.1.1.2.cmml">×</mo><mi id="S3.SS3.SSS1.p1.14.m14.1.1.1.3" xref="S3.SS3.SSS1.p1.14.m14.1.1.1.3.cmml">L</mi><mo id="S3.SS3.SSS1.p1.14.m14.1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS1.p1.14.m14.1.1.1.2.cmml">×</mo><mi id="S3.SS3.SSS1.p1.14.m14.1.1.1.4" xref="S3.SS3.SSS1.p1.14.m14.1.1.1.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.14.m14.5b"><apply id="S3.SS3.SSS1.p1.14.m14.5.5.cmml" xref="S3.SS3.SSS1.p1.14.m14.5.5"><and id="S3.SS3.SSS1.p1.14.m14.5.5a.cmml" xref="S3.SS3.SSS1.p1.14.m14.5.5"></and><apply id="S3.SS3.SSS1.p1.14.m14.5.5b.cmml" xref="S3.SS3.SSS1.p1.14.m14.5.5"><eq id="S3.SS3.SSS1.p1.14.m14.5.5.7.cmml" xref="S3.SS3.SSS1.p1.14.m14.5.5.7"></eq><ci id="S3.SS3.SSS1.p1.14.m14.5.5.6.cmml" xref="S3.SS3.SSS1.p1.14.m14.5.5.6">𝕩</ci><list id="S3.SS3.SSS1.p1.14.m14.5.5.4.5.cmml" xref="S3.SS3.SSS1.p1.14.m14.5.5.4.4"><apply id="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.cmml" xref="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1"><times id="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.1"></times><ci id="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.2">𝑄</ci><apply id="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.3.2">𝑊</ci><ci id="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.14.m14.2.2.1.1.1.3.3">𝑞</ci></apply></apply><apply id="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.cmml" xref="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2"><times id="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.1.cmml" xref="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.1"></times><ci id="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.2">𝑇</ci><apply id="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.3.1.cmml" xref="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.3.2.cmml" xref="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.3.2">𝑊</ci><ci id="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.3.3.cmml" xref="S3.SS3.SSS1.p1.14.m14.3.3.2.2.2.3.3">𝑡</ci></apply></apply><apply id="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.cmml" xref="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3"><times id="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.1.cmml" xref="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.1"></times><ci id="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.2.cmml" xref="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.2">𝐼</ci><apply id="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.3.1.cmml" xref="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.3.2.cmml" xref="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.3.2">𝑊</ci><ci id="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.14.m14.4.4.3.3.3.3.3">𝑖</ci></apply></apply><apply id="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.cmml" xref="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4"><times id="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.1.cmml" xref="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.1"></times><ci id="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.2.cmml" xref="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.2">𝐴</ci><apply id="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.3.cmml" xref="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.3.1.cmml" xref="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.3.2.cmml" xref="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.3.2">𝑊</ci><ci id="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.3.3.cmml" xref="S3.SS3.SSS1.p1.14.m14.5.5.4.4.4.3.3">𝑎</ci></apply></apply></list></apply><apply id="S3.SS3.SSS1.p1.14.m14.5.5c.cmml" xref="S3.SS3.SSS1.p1.14.m14.5.5"><in id="S3.SS3.SSS1.p1.14.m14.5.5.8.cmml" xref="S3.SS3.SSS1.p1.14.m14.5.5.8"></in><share href="https://arxiv.org/html/2407.10714v1#S3.SS3.SSS1.p1.14.m14.5.5.4.cmml" id="S3.SS3.SSS1.p1.14.m14.5.5d.cmml" xref="S3.SS3.SSS1.p1.14.m14.5.5"></share><apply id="S3.SS3.SSS1.p1.14.m14.5.5.9.cmml" xref="S3.SS3.SSS1.p1.14.m14.5.5.9"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.14.m14.5.5.9.1.cmml" xref="S3.SS3.SSS1.p1.14.m14.5.5.9">superscript</csymbol><ci id="S3.SS3.SSS1.p1.14.m14.5.5.9.2.cmml" xref="S3.SS3.SSS1.p1.14.m14.5.5.9.2">ℝ</ci><apply id="S3.SS3.SSS1.p1.14.m14.1.1.1.cmml" xref="S3.SS3.SSS1.p1.14.m14.1.1.1"><times id="S3.SS3.SSS1.p1.14.m14.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.14.m14.1.1.1.2"></times><apply id="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1"><plus id="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1.1.1"></plus><ci id="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1.1.2">𝑀</ci><cn id="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.p1.14.m14.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.SS3.SSS1.p1.14.m14.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.14.m14.1.1.1.3">𝐿</ci><ci id="S3.SS3.SSS1.p1.14.m14.1.1.1.4.cmml" xref="S3.SS3.SSS1.p1.14.m14.1.1.1.4">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.14.m14.5c">\mathbb{x}=[QW_{q},TW_{t},IW_{i},AW_{a}]\in\mathbb{R}^{(M+1)\times L\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.14.m14.5d">blackboard_x = [ italic_Q italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_T italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_I italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_A italic_W start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ] ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_M + 1 ) × italic_L × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<section class="ltx_paragraph" id="S3.SS3.SSS1.Px1">
<h5 class="ltx_title ltx_font_bold ltx_title_paragraph">Next Pair Prediction and Multi-Head Target Attention</h5>
<div class="ltx_para" id="S3.SS3.SSS1.Px1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.Px1.p1.9">The intuition behind PSU is to design a pretraining network to learn from the lifelong behavior sequence, and the pretraining network should share the same structure of multi-head target attention with the cascading two-stage downstream model, such as ETA <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib4" title="">2022</a>)</cite> and TWIN <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib3" title="">2023</a>)</cite>. The downstream model restores the pretrained query and item embeddings as initialization of parameters and fine-tunes the network. Different from the masked language model (MLM) in BERT <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib5" title="">2019</a>)</cite>, which uses tokens from the context window to predict the masked token, we use next-pair prediction as a pretraining task to predict the correct last query and item pair. We intentionally leave out the last query-item pair in the sequence <math alttext="\mathbb{x}_{L}=[\mathbb{x}^{(m)}_{L}],m\in[Q,T,I,A]" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p1.1.m1.7"><semantics id="S3.SS3.SSS1.Px1.p1.1.m1.7a"><mrow id="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2" xref="S3.SS3.SSS1.Px1.p1.1.m1.7.7.3.cmml"><mrow id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.cmml"><msub id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.3" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.3.cmml"><mi id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.3.2" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.3.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.3.3" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.3.3.cmml">L</mi></msub><mo id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.2" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.2.cmml">=</mo><mrow id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.2.cmml"><mo id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.2.1.cmml">[</mo><msubsup id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1.2.2" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1.3" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1.3.cmml">L</mi><mrow id="S3.SS3.SSS1.Px1.p1.1.m1.1.1.1.3" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.Px1.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS1.Px1.p1.1.m1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p1.1.m1.1.1.1.1.cmml">m</mi><mo id="S3.SS3.SSS1.Px1.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.3" xref="S3.SS3.SSS1.Px1.p1.1.m1.7.7.3a.cmml">,</mo><mrow id="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2" xref="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.cmml"><mi id="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.2" xref="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.2.cmml">m</mi><mo id="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.1" xref="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.1.cmml">∈</mo><mrow id="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.3.2" xref="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.3.1.cmml"><mo id="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.3.2.1" stretchy="false" xref="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.3.1.cmml">[</mo><mi id="S3.SS3.SSS1.Px1.p1.1.m1.2.2" xref="S3.SS3.SSS1.Px1.p1.1.m1.2.2.cmml">Q</mi><mo id="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.3.2.2" xref="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.3.1.cmml">,</mo><mi id="S3.SS3.SSS1.Px1.p1.1.m1.3.3" xref="S3.SS3.SSS1.Px1.p1.1.m1.3.3.cmml">T</mi><mo id="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.3.2.3" xref="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.3.1.cmml">,</mo><mi id="S3.SS3.SSS1.Px1.p1.1.m1.4.4" xref="S3.SS3.SSS1.Px1.p1.1.m1.4.4.cmml">I</mi><mo id="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.3.2.4" xref="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.3.1.cmml">,</mo><mi id="S3.SS3.SSS1.Px1.p1.1.m1.5.5" xref="S3.SS3.SSS1.Px1.p1.1.m1.5.5.cmml">A</mi><mo id="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.3.2.5" stretchy="false" xref="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.3.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p1.1.m1.7b"><apply id="S3.SS3.SSS1.Px1.p1.1.m1.7.7.3.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p1.1.m1.7.7.3a.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.3">formulae-sequence</csymbol><apply id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1"><eq id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.2"></eq><apply id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.3.2">𝕩</ci><ci id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.3.3">𝐿</ci></apply><apply id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1.2.2">𝕩</ci><ci id="S3.SS3.SSS1.Px1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.1.1.1.1">𝑚</ci></apply><ci id="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.6.6.1.1.1.1.1.3">𝐿</ci></apply></apply></apply><apply id="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2"><in id="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.1"></in><ci id="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.2">𝑚</ci><list id="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.3.1.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.7.7.2.2.3.2"><ci id="S3.SS3.SSS1.Px1.p1.1.m1.2.2.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.2.2">𝑄</ci><ci id="S3.SS3.SSS1.Px1.p1.1.m1.3.3.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.3.3">𝑇</ci><ci id="S3.SS3.SSS1.Px1.p1.1.m1.4.4.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.4.4">𝐼</ci><ci id="S3.SS3.SSS1.Px1.p1.1.m1.5.5.cmml" xref="S3.SS3.SSS1.Px1.p1.1.m1.5.5">𝐴</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p1.1.m1.7c">\mathbb{x}_{L}=[\mathbb{x}^{(m)}_{L}],m\in[Q,T,I,A]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p1.1.m1.7d">blackboard_x start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT = [ blackboard_x start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ] , italic_m ∈ [ italic_Q , italic_T , italic_I , italic_A ]</annotation></semantics></math>, and treat it as the target query-item pair to retrieve from the previous <math alttext="(L-1)" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p1.2.m2.1"><semantics id="S3.SS3.SSS1.Px1.p1.2.m2.1a"><mrow id="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1" xref="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1.1" xref="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1.1.2" xref="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1.1.2.cmml">L</mi><mo id="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1.1.1.cmml">−</mo><mn id="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1.1.3" xref="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p1.2.m2.1b"><apply id="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1"><minus id="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1.1.1"></minus><ci id="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1.1.2">𝐿</ci><cn id="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p1.2.m2.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p1.2.m2.1c">(L-1)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p1.2.m2.1d">( italic_L - 1 )</annotation></semantics></math> sequence using multi-head target attention. To pad the sequence length from <math alttext="L-1" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p1.3.m3.1"><semantics id="S3.SS3.SSS1.Px1.p1.3.m3.1a"><mrow id="S3.SS3.SSS1.Px1.p1.3.m3.1.1" xref="S3.SS3.SSS1.Px1.p1.3.m3.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p1.3.m3.1.1.2" xref="S3.SS3.SSS1.Px1.p1.3.m3.1.1.2.cmml">L</mi><mo id="S3.SS3.SSS1.Px1.p1.3.m3.1.1.1" xref="S3.SS3.SSS1.Px1.p1.3.m3.1.1.1.cmml">−</mo><mn id="S3.SS3.SSS1.Px1.p1.3.m3.1.1.3" xref="S3.SS3.SSS1.Px1.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p1.3.m3.1b"><apply id="S3.SS3.SSS1.Px1.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.3.m3.1.1"><minus id="S3.SS3.SSS1.Px1.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.3.m3.1.1.1"></minus><ci id="S3.SS3.SSS1.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p1.3.m3.1.1.2">𝐿</ci><cn id="S3.SS3.SSS1.Px1.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p1.3.m3.1c">L-1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p1.3.m3.1d">italic_L - 1</annotation></semantics></math> to <math alttext="L" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p1.4.m4.1"><semantics id="S3.SS3.SSS1.Px1.p1.4.m4.1a"><mi id="S3.SS3.SSS1.Px1.p1.4.m4.1.1" xref="S3.SS3.SSS1.Px1.p1.4.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p1.4.m4.1b"><ci id="S3.SS3.SSS1.Px1.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.4.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p1.4.m4.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p1.4.m4.1d">italic_L</annotation></semantics></math>, we further add a special token <math alttext="&lt;EOS&gt;" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p1.5.m5.1"><semantics id="S3.SS3.SSS1.Px1.p1.5.m5.1a"><mrow id="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1" xref="S3.SS3.SSS1.Px1.p1.5.m5.1.1.2.cmml"><mo fence="true" id="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.2" rspace="0em" xref="S3.SS3.SSS1.Px1.p1.5.m5.1.1.2.1.cmml">&lt;</mo><mrow id="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1" xref="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1.2" xref="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1.2.cmml">E</mi><mo id="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1.3" xref="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1.3.cmml">O</mi><mo id="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1.1a" xref="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1.4" xref="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1.4.cmml">S</mi></mrow><mo fence="true" id="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.3" lspace="0em" xref="S3.SS3.SSS1.Px1.p1.5.m5.1.1.2.1.cmml">&gt;</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p1.5.m5.1b"><apply id="S3.SS3.SSS1.Px1.p1.5.m5.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1"><csymbol cd="latexml" id="S3.SS3.SSS1.Px1.p1.5.m5.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.2">expectation</csymbol><apply id="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1"><times id="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1.1"></times><ci id="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1.2">𝐸</ci><ci id="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1.3">𝑂</ci><ci id="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1.4.cmml" xref="S3.SS3.SSS1.Px1.p1.5.m5.1.1.1.1.4">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p1.5.m5.1c">&lt;EOS&gt;</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p1.5.m5.1d">&lt; italic_E italic_O italic_S &gt;</annotation></semantics></math> to the end of the previous <math alttext="L-1" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p1.6.m6.1"><semantics id="S3.SS3.SSS1.Px1.p1.6.m6.1a"><mrow id="S3.SS3.SSS1.Px1.p1.6.m6.1.1" xref="S3.SS3.SSS1.Px1.p1.6.m6.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p1.6.m6.1.1.2" xref="S3.SS3.SSS1.Px1.p1.6.m6.1.1.2.cmml">L</mi><mo id="S3.SS3.SSS1.Px1.p1.6.m6.1.1.1" xref="S3.SS3.SSS1.Px1.p1.6.m6.1.1.1.cmml">−</mo><mn id="S3.SS3.SSS1.Px1.p1.6.m6.1.1.3" xref="S3.SS3.SSS1.Px1.p1.6.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p1.6.m6.1b"><apply id="S3.SS3.SSS1.Px1.p1.6.m6.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.6.m6.1.1"><minus id="S3.SS3.SSS1.Px1.p1.6.m6.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.6.m6.1.1.1"></minus><ci id="S3.SS3.SSS1.Px1.p1.6.m6.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p1.6.m6.1.1.2">𝐿</ci><cn id="S3.SS3.SSS1.Px1.p1.6.m6.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p1.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p1.6.m6.1c">L-1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p1.6.m6.1d">italic_L - 1</annotation></semantics></math> items in the sequence <math alttext="\mathbb{x}_{1:L-1}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p1.7.m7.1"><semantics id="S3.SS3.SSS1.Px1.p1.7.m7.1a"><msub id="S3.SS3.SSS1.Px1.p1.7.m7.1.1" xref="S3.SS3.SSS1.Px1.p1.7.m7.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p1.7.m7.1.1.2" xref="S3.SS3.SSS1.Px1.p1.7.m7.1.1.2.cmml">𝕩</mi><mrow id="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3" xref="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.cmml"><mn id="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.2" xref="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.2.cmml">1</mn><mo id="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.1.cmml">:</mo><mrow id="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.3" xref="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.3.cmml"><mi id="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.3.2" xref="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.3.2.cmml">L</mi><mo id="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.3.1" xref="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.3.1.cmml">−</mo><mn id="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.3.3" xref="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p1.7.m7.1b"><apply id="S3.SS3.SSS1.Px1.p1.7.m7.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p1.7.m7.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p1.7.m7.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p1.7.m7.1.1.2">𝕩</ci><apply id="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3"><ci id="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.1">:</ci><cn id="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.2.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.2">1</cn><apply id="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.3"><minus id="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.3.1"></minus><ci id="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.3.2">𝐿</ci><cn id="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.3.3.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p1.7.m7.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p1.7.m7.1c">\mathbb{x}_{1:L-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p1.7.m7.1d">blackboard_x start_POSTSUBSCRIPT 1 : italic_L - 1 end_POSTSUBSCRIPT</annotation></semantics></math>. The next query-item pair prediction task is formulated as classification tasks: <math alttext="y=p(\mathbb{x}^{1:M+1}_{L}|\mathbb{x}^{1:M+1}_{1:L-1};\mathbb{x}^{&lt;EOS&gt;})" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p1.8.m8.2"><semantics id="S3.SS3.SSS1.Px1.p1.8.m8.2a"><mrow id="S3.SS3.SSS1.Px1.p1.8.m8.2.2" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.cmml"><mi id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.3" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.3.cmml">y</mi><mo id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.2" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.2.cmml">=</mo><mrow id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.cmml"><mi id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.3" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.3.cmml">p</mi><mo id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.2" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.cmml"><msubsup id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.cmml"><mi id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.2" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.3" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.3.cmml">L</mi><mrow id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.cmml"><mn id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.2" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.2.cmml">1</mn><mo id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.1.cmml">:</mo><mrow id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.3" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.3.cmml"><mi id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.3.2" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.3.2.cmml">M</mi><mo id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.3.1" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.3.1.cmml">+</mo><mn id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.3.3" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.3.3.cmml">1</mn></mrow></mrow></msubsup><mo fence="false" id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.3" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.3.cmml">|</mo><mrow id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.2.2" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.2.3.cmml"><msubsup id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.2" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.2.cmml">𝕩</mi><mrow id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.cmml"><mn id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.2" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.3" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.3.2" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.3.2.cmml">L</mi><mo id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.3.1" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.3.3" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow><mrow id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.cmml"><mn id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.2" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.1.cmml">:</mo><mrow id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.3" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.3.2" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.3.2.cmml">M</mi><mo id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.3.1" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.3.1.cmml">+</mo><mn id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.3.3" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.3.3.cmml">1</mn></mrow></mrow></msubsup><mo id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.2.2.3" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.2.3.cmml">;</mo><msup id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.2.2.2" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.2.2.2.cmml"><mi id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.2.2.2.2" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.2.2.2.2.cmml">𝕩</mi><mrow id="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1" xref="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.2.cmml"><mo fence="true" id="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.2" rspace="0em" xref="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.2.1.cmml">&lt;</mo><mrow id="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1.2" xref="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1.2.cmml">E</mi><mo id="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1.3" xref="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1.3.cmml">O</mi><mo id="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1.1a" xref="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1.4" xref="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1.4.cmml">S</mi></mrow><mo fence="true" id="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.3" lspace="0em" xref="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.2.1.cmml">&gt;</mo></mrow></msup></mrow></mrow><mo id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p1.8.m8.2b"><apply id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2"><eq id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.2"></eq><ci id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.3.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.3">𝑦</ci><apply id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1"><times id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.2.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.2"></times><ci id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.3.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.3">𝑝</ci><apply id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1"><csymbol cd="latexml" id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.3">conditional</csymbol><apply id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.1.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.1.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.2.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.2">𝕩</ci><apply id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3"><ci id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.1.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.1">:</ci><cn id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.2.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.2">1</cn><apply id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.3.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.3"><plus id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.3.1.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.3.1"></plus><ci id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.3.2.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.3.2">𝑀</ci><cn id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.3.3.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.2.3.3.3">1</cn></apply></apply></apply><ci id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.3.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.4.3">𝐿</ci></apply><list id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.2.2"><apply id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.2">𝕩</ci><apply id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3"><ci id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.1">:</ci><cn id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.2.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.2">1</cn><apply id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.3"><plus id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.3.1"></plus><ci id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.3.2">𝑀</ci><cn id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.3.3.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3"><ci id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.1">:</ci><cn id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.2">1</cn><apply id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.3"><minus id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.3.2">𝐿</ci><cn id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.2.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.2.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.2.2.1.1.1.1.2.2.2.2">𝕩</ci><apply id="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.2">expectation</csymbol><apply id="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1"><times id="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1.1"></times><ci id="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1.2">𝐸</ci><ci id="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1.3">𝑂</ci><ci id="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1.4.cmml" xref="S3.SS3.SSS1.Px1.p1.8.m8.1.1.1.1.1.4">𝑆</ci></apply></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p1.8.m8.2c">y=p(\mathbb{x}^{1:M+1}_{L}|\mathbb{x}^{1:M+1}_{1:L-1};\mathbb{x}^{&lt;EOS&gt;})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p1.8.m8.2d">italic_y = italic_p ( blackboard_x start_POSTSUPERSCRIPT 1 : italic_M + 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT | blackboard_x start_POSTSUPERSCRIPT 1 : italic_M + 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 : italic_L - 1 end_POSTSUBSCRIPT ; blackboard_x start_POSTSUPERSCRIPT &lt; italic_E italic_O italic_S &gt; end_POSTSUPERSCRIPT )</annotation></semantics></math> with the loss <math alttext="\mathcal{L}^{pair}_{next}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p1.9.m9.1"><semantics id="S3.SS3.SSS1.Px1.p1.9.m9.1a"><msubsup id="S3.SS3.SSS1.Px1.p1.9.m9.1.1" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.2" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.2.cmml">ℒ</mi><mrow id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.cmml"><mi id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.2" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.2.cmml">n</mi><mo id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.1" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.3" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.3.cmml">e</mi><mo id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.1a" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.4" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.4.cmml">x</mi><mo id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.1b" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.5" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.5.cmml">t</mi></mrow><mrow id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.cmml"><mi id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.2" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.2.cmml">p</mi><mo id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.1" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.3" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.3.cmml">a</mi><mo id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.1a" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.4" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.4.cmml">i</mi><mo id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.1b" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.5" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.5.cmml">r</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p1.9.m9.1b"><apply id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.2">ℒ</ci><apply id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.cmml" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3"><times id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.1.cmml" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.1"></times><ci id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.2.cmml" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.2">𝑝</ci><ci id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.3.cmml" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.3">𝑎</ci><ci id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.4.cmml" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.4">𝑖</ci><ci id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.5.cmml" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.2.3.5">𝑟</ci></apply></apply><apply id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3"><times id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.1"></times><ci id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.2">𝑛</ci><ci id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.3">𝑒</ci><ci id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.4.cmml" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.4">𝑥</ci><ci id="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.5.cmml" xref="S3.SS3.SSS1.Px1.p1.9.m9.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p1.9.m9.1c">\mathcal{L}^{pair}_{next}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p1.9.m9.1d">caligraphic_L start_POSTSUPERSCRIPT italic_p italic_a italic_i italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n italic_e italic_x italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. Positive label is assigned to the correct last pair, and negative labels are assigned to negatively sampled query-item pairs.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.Px1.p2">
<p class="ltx_p" id="S3.SS3.SSS1.Px1.p2.1">To better represent the historical behaviors and target query-item pair, we need to fuse the query and multi-modal item representations into a single vector as:</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.Px1.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbb{x}=\lambda\mathbb{x}^{query}+(1-\lambda)\sum_{i}w_{i}{\mathbb{x}^{item%
}}^{(i)}=\sum_{m\in M+1}\gamma_{m}\mathbb{x}^{(m)}" class="ltx_Math" display="block" id="S3.Ex1.m1.3"><semantics id="S3.Ex1.m1.3a"><mrow id="S3.Ex1.m1.3.3" xref="S3.Ex1.m1.3.3.cmml"><mi id="S3.Ex1.m1.3.3.3" xref="S3.Ex1.m1.3.3.3.cmml">𝕩</mi><mo id="S3.Ex1.m1.3.3.4" xref="S3.Ex1.m1.3.3.4.cmml">=</mo><mrow id="S3.Ex1.m1.3.3.1" xref="S3.Ex1.m1.3.3.1.cmml"><mrow id="S3.Ex1.m1.3.3.1.3" xref="S3.Ex1.m1.3.3.1.3.cmml"><mi id="S3.Ex1.m1.3.3.1.3.2" xref="S3.Ex1.m1.3.3.1.3.2.cmml">λ</mi><mo id="S3.Ex1.m1.3.3.1.3.1" xref="S3.Ex1.m1.3.3.1.3.1.cmml">⁢</mo><msup id="S3.Ex1.m1.3.3.1.3.3" xref="S3.Ex1.m1.3.3.1.3.3.cmml"><mi id="S3.Ex1.m1.3.3.1.3.3.2" xref="S3.Ex1.m1.3.3.1.3.3.2.cmml">𝕩</mi><mrow id="S3.Ex1.m1.3.3.1.3.3.3" xref="S3.Ex1.m1.3.3.1.3.3.3.cmml"><mi id="S3.Ex1.m1.3.3.1.3.3.3.2" xref="S3.Ex1.m1.3.3.1.3.3.3.2.cmml">q</mi><mo id="S3.Ex1.m1.3.3.1.3.3.3.1" xref="S3.Ex1.m1.3.3.1.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.3.3.1.3.3.3.3" xref="S3.Ex1.m1.3.3.1.3.3.3.3.cmml">u</mi><mo id="S3.Ex1.m1.3.3.1.3.3.3.1a" xref="S3.Ex1.m1.3.3.1.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.3.3.1.3.3.3.4" xref="S3.Ex1.m1.3.3.1.3.3.3.4.cmml">e</mi><mo id="S3.Ex1.m1.3.3.1.3.3.3.1b" xref="S3.Ex1.m1.3.3.1.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.3.3.1.3.3.3.5" xref="S3.Ex1.m1.3.3.1.3.3.3.5.cmml">r</mi><mo id="S3.Ex1.m1.3.3.1.3.3.3.1c" xref="S3.Ex1.m1.3.3.1.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.3.3.1.3.3.3.6" xref="S3.Ex1.m1.3.3.1.3.3.3.6.cmml">y</mi></mrow></msup></mrow><mo id="S3.Ex1.m1.3.3.1.2" xref="S3.Ex1.m1.3.3.1.2.cmml">+</mo><mrow id="S3.Ex1.m1.3.3.1.1" xref="S3.Ex1.m1.3.3.1.1.cmml"><mrow id="S3.Ex1.m1.3.3.1.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.cmml"><mo id="S3.Ex1.m1.3.3.1.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.3.3.1.1.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.cmml"><mn id="S3.Ex1.m1.3.3.1.1.1.1.1.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.cmml">1</mn><mo id="S3.Ex1.m1.3.3.1.1.1.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.cmml">−</mo><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.3" xref="S3.Ex1.m1.3.3.1.1.1.1.1.3.cmml">λ</mi></mrow><mo id="S3.Ex1.m1.3.3.1.1.1.1.3" stretchy="false" xref="S3.Ex1.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex1.m1.3.3.1.1.2" xref="S3.Ex1.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.3.3.1.1.3" xref="S3.Ex1.m1.3.3.1.1.3.cmml"><munder id="S3.Ex1.m1.3.3.1.1.3.1" xref="S3.Ex1.m1.3.3.1.1.3.1.cmml"><mo id="S3.Ex1.m1.3.3.1.1.3.1.2" movablelimits="false" xref="S3.Ex1.m1.3.3.1.1.3.1.2.cmml">∑</mo><mi id="S3.Ex1.m1.3.3.1.1.3.1.3" xref="S3.Ex1.m1.3.3.1.1.3.1.3.cmml">i</mi></munder><mrow id="S3.Ex1.m1.3.3.1.1.3.2" xref="S3.Ex1.m1.3.3.1.1.3.2.cmml"><msub id="S3.Ex1.m1.3.3.1.1.3.2.2" xref="S3.Ex1.m1.3.3.1.1.3.2.2.cmml"><mi id="S3.Ex1.m1.3.3.1.1.3.2.2.2" xref="S3.Ex1.m1.3.3.1.1.3.2.2.2.cmml">w</mi><mi id="S3.Ex1.m1.3.3.1.1.3.2.2.3" xref="S3.Ex1.m1.3.3.1.1.3.2.2.3.cmml">i</mi></msub><mo id="S3.Ex1.m1.3.3.1.1.3.2.1" xref="S3.Ex1.m1.3.3.1.1.3.2.1.cmml">⁢</mo><mmultiscripts id="S3.Ex1.m1.3.3.1.1.3.2.3" xref="S3.Ex1.m1.3.3.1.1.3.2.3.cmml"><mi id="S3.Ex1.m1.3.3.1.1.3.2.3.2.2" xref="S3.Ex1.m1.3.3.1.1.3.2.3.2.2.cmml">𝕩</mi><mrow id="S3.Ex1.m1.3.3.1.1.3.2.3a" xref="S3.Ex1.m1.3.3.1.1.3.2.3.cmml"></mrow><mrow id="S3.Ex1.m1.3.3.1.1.3.2.3.2.3" xref="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.cmml"><mi id="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.2" xref="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.2.cmml">i</mi><mo id="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.1" xref="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.3" xref="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.3.cmml">t</mi><mo id="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.1a" xref="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.4" xref="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.4.cmml">e</mi><mo id="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.1b" xref="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.5" xref="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.5.cmml">m</mi></mrow><mrow id="S3.Ex1.m1.3.3.1.1.3.2.3b" xref="S3.Ex1.m1.3.3.1.1.3.2.3.cmml"></mrow><mrow id="S3.Ex1.m1.1.1.1.3" xref="S3.Ex1.m1.3.3.1.1.3.2.3.cmml"><mo id="S3.Ex1.m1.1.1.1.3.1" stretchy="false" xref="S3.Ex1.m1.3.3.1.1.3.2.3.cmml">(</mo><mi id="S3.Ex1.m1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml">i</mi><mo id="S3.Ex1.m1.1.1.1.3.2" stretchy="false" xref="S3.Ex1.m1.3.3.1.1.3.2.3.cmml">)</mo></mrow></mmultiscripts></mrow></mrow></mrow></mrow><mo id="S3.Ex1.m1.3.3.5" rspace="0.111em" xref="S3.Ex1.m1.3.3.5.cmml">=</mo><mrow id="S3.Ex1.m1.3.3.6" xref="S3.Ex1.m1.3.3.6.cmml"><munder id="S3.Ex1.m1.3.3.6.1" xref="S3.Ex1.m1.3.3.6.1.cmml"><mo id="S3.Ex1.m1.3.3.6.1.2" movablelimits="false" xref="S3.Ex1.m1.3.3.6.1.2.cmml">∑</mo><mrow id="S3.Ex1.m1.3.3.6.1.3" xref="S3.Ex1.m1.3.3.6.1.3.cmml"><mi id="S3.Ex1.m1.3.3.6.1.3.2" xref="S3.Ex1.m1.3.3.6.1.3.2.cmml">m</mi><mo id="S3.Ex1.m1.3.3.6.1.3.1" xref="S3.Ex1.m1.3.3.6.1.3.1.cmml">∈</mo><mrow id="S3.Ex1.m1.3.3.6.1.3.3" xref="S3.Ex1.m1.3.3.6.1.3.3.cmml"><mi id="S3.Ex1.m1.3.3.6.1.3.3.2" xref="S3.Ex1.m1.3.3.6.1.3.3.2.cmml">M</mi><mo id="S3.Ex1.m1.3.3.6.1.3.3.1" xref="S3.Ex1.m1.3.3.6.1.3.3.1.cmml">+</mo><mn id="S3.Ex1.m1.3.3.6.1.3.3.3" xref="S3.Ex1.m1.3.3.6.1.3.3.3.cmml">1</mn></mrow></mrow></munder><mrow id="S3.Ex1.m1.3.3.6.2" xref="S3.Ex1.m1.3.3.6.2.cmml"><msub id="S3.Ex1.m1.3.3.6.2.2" xref="S3.Ex1.m1.3.3.6.2.2.cmml"><mi id="S3.Ex1.m1.3.3.6.2.2.2" xref="S3.Ex1.m1.3.3.6.2.2.2.cmml">γ</mi><mi id="S3.Ex1.m1.3.3.6.2.2.3" xref="S3.Ex1.m1.3.3.6.2.2.3.cmml">m</mi></msub><mo id="S3.Ex1.m1.3.3.6.2.1" xref="S3.Ex1.m1.3.3.6.2.1.cmml">⁢</mo><msup id="S3.Ex1.m1.3.3.6.2.3" xref="S3.Ex1.m1.3.3.6.2.3.cmml"><mi id="S3.Ex1.m1.3.3.6.2.3.2" xref="S3.Ex1.m1.3.3.6.2.3.2.cmml">𝕩</mi><mrow id="S3.Ex1.m1.2.2.1.3" xref="S3.Ex1.m1.3.3.6.2.3.cmml"><mo id="S3.Ex1.m1.2.2.1.3.1" stretchy="false" xref="S3.Ex1.m1.3.3.6.2.3.cmml">(</mo><mi id="S3.Ex1.m1.2.2.1.1" xref="S3.Ex1.m1.2.2.1.1.cmml">m</mi><mo id="S3.Ex1.m1.2.2.1.3.2" stretchy="false" xref="S3.Ex1.m1.3.3.6.2.3.cmml">)</mo></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.3b"><apply id="S3.Ex1.m1.3.3.cmml" xref="S3.Ex1.m1.3.3"><and id="S3.Ex1.m1.3.3a.cmml" xref="S3.Ex1.m1.3.3"></and><apply id="S3.Ex1.m1.3.3b.cmml" xref="S3.Ex1.m1.3.3"><eq id="S3.Ex1.m1.3.3.4.cmml" xref="S3.Ex1.m1.3.3.4"></eq><ci id="S3.Ex1.m1.3.3.3.cmml" xref="S3.Ex1.m1.3.3.3">𝕩</ci><apply id="S3.Ex1.m1.3.3.1.cmml" xref="S3.Ex1.m1.3.3.1"><plus id="S3.Ex1.m1.3.3.1.2.cmml" xref="S3.Ex1.m1.3.3.1.2"></plus><apply id="S3.Ex1.m1.3.3.1.3.cmml" xref="S3.Ex1.m1.3.3.1.3"><times id="S3.Ex1.m1.3.3.1.3.1.cmml" xref="S3.Ex1.m1.3.3.1.3.1"></times><ci id="S3.Ex1.m1.3.3.1.3.2.cmml" xref="S3.Ex1.m1.3.3.1.3.2">𝜆</ci><apply id="S3.Ex1.m1.3.3.1.3.3.cmml" xref="S3.Ex1.m1.3.3.1.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.1.3.3.1.cmml" xref="S3.Ex1.m1.3.3.1.3.3">superscript</csymbol><ci id="S3.Ex1.m1.3.3.1.3.3.2.cmml" xref="S3.Ex1.m1.3.3.1.3.3.2">𝕩</ci><apply id="S3.Ex1.m1.3.3.1.3.3.3.cmml" xref="S3.Ex1.m1.3.3.1.3.3.3"><times id="S3.Ex1.m1.3.3.1.3.3.3.1.cmml" xref="S3.Ex1.m1.3.3.1.3.3.3.1"></times><ci id="S3.Ex1.m1.3.3.1.3.3.3.2.cmml" xref="S3.Ex1.m1.3.3.1.3.3.3.2">𝑞</ci><ci id="S3.Ex1.m1.3.3.1.3.3.3.3.cmml" xref="S3.Ex1.m1.3.3.1.3.3.3.3">𝑢</ci><ci id="S3.Ex1.m1.3.3.1.3.3.3.4.cmml" xref="S3.Ex1.m1.3.3.1.3.3.3.4">𝑒</ci><ci id="S3.Ex1.m1.3.3.1.3.3.3.5.cmml" xref="S3.Ex1.m1.3.3.1.3.3.3.5">𝑟</ci><ci id="S3.Ex1.m1.3.3.1.3.3.3.6.cmml" xref="S3.Ex1.m1.3.3.1.3.3.3.6">𝑦</ci></apply></apply></apply><apply id="S3.Ex1.m1.3.3.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1"><times id="S3.Ex1.m1.3.3.1.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.2"></times><apply id="S3.Ex1.m1.3.3.1.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1"><minus id="S3.Ex1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1"></minus><cn id="S3.Ex1.m1.3.3.1.1.1.1.1.2.cmml" type="integer" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2">1</cn><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.3">𝜆</ci></apply><apply id="S3.Ex1.m1.3.3.1.1.3.cmml" xref="S3.Ex1.m1.3.3.1.1.3"><apply id="S3.Ex1.m1.3.3.1.1.3.1.cmml" xref="S3.Ex1.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.1.1.3.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.3.1">subscript</csymbol><sum id="S3.Ex1.m1.3.3.1.1.3.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.3.1.2"></sum><ci id="S3.Ex1.m1.3.3.1.1.3.1.3.cmml" xref="S3.Ex1.m1.3.3.1.1.3.1.3">𝑖</ci></apply><apply id="S3.Ex1.m1.3.3.1.1.3.2.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2"><times id="S3.Ex1.m1.3.3.1.1.3.2.1.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.1"></times><apply id="S3.Ex1.m1.3.3.1.1.3.2.2.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.1.1.3.2.2.1.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.2">subscript</csymbol><ci id="S3.Ex1.m1.3.3.1.1.3.2.2.2.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.2.2">𝑤</ci><ci id="S3.Ex1.m1.3.3.1.1.3.2.2.3.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.Ex1.m1.3.3.1.1.3.2.3.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.1.1.3.2.3.1.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.3">superscript</csymbol><apply id="S3.Ex1.m1.3.3.1.1.3.2.3.2.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.1.1.3.2.3.2.1.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.3">superscript</csymbol><ci id="S3.Ex1.m1.3.3.1.1.3.2.3.2.2.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.3.2.2">𝕩</ci><apply id="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.3.2.3"><times id="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.1.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.1"></times><ci id="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.2.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.2">𝑖</ci><ci id="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.3.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.3">𝑡</ci><ci id="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.4.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.4">𝑒</ci><ci id="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.5.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.3.2.3.5">𝑚</ci></apply></apply><ci id="S3.Ex1.m1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1">𝑖</ci></apply></apply></apply></apply></apply></apply><apply id="S3.Ex1.m1.3.3c.cmml" xref="S3.Ex1.m1.3.3"><eq id="S3.Ex1.m1.3.3.5.cmml" xref="S3.Ex1.m1.3.3.5"></eq><share href="https://arxiv.org/html/2407.10714v1#S3.Ex1.m1.3.3.1.cmml" id="S3.Ex1.m1.3.3d.cmml" xref="S3.Ex1.m1.3.3"></share><apply id="S3.Ex1.m1.3.3.6.cmml" xref="S3.Ex1.m1.3.3.6"><apply id="S3.Ex1.m1.3.3.6.1.cmml" xref="S3.Ex1.m1.3.3.6.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.6.1.1.cmml" xref="S3.Ex1.m1.3.3.6.1">subscript</csymbol><sum id="S3.Ex1.m1.3.3.6.1.2.cmml" xref="S3.Ex1.m1.3.3.6.1.2"></sum><apply id="S3.Ex1.m1.3.3.6.1.3.cmml" xref="S3.Ex1.m1.3.3.6.1.3"><in id="S3.Ex1.m1.3.3.6.1.3.1.cmml" xref="S3.Ex1.m1.3.3.6.1.3.1"></in><ci id="S3.Ex1.m1.3.3.6.1.3.2.cmml" xref="S3.Ex1.m1.3.3.6.1.3.2">𝑚</ci><apply id="S3.Ex1.m1.3.3.6.1.3.3.cmml" xref="S3.Ex1.m1.3.3.6.1.3.3"><plus id="S3.Ex1.m1.3.3.6.1.3.3.1.cmml" xref="S3.Ex1.m1.3.3.6.1.3.3.1"></plus><ci id="S3.Ex1.m1.3.3.6.1.3.3.2.cmml" xref="S3.Ex1.m1.3.3.6.1.3.3.2">𝑀</ci><cn id="S3.Ex1.m1.3.3.6.1.3.3.3.cmml" type="integer" xref="S3.Ex1.m1.3.3.6.1.3.3.3">1</cn></apply></apply></apply><apply id="S3.Ex1.m1.3.3.6.2.cmml" xref="S3.Ex1.m1.3.3.6.2"><times id="S3.Ex1.m1.3.3.6.2.1.cmml" xref="S3.Ex1.m1.3.3.6.2.1"></times><apply id="S3.Ex1.m1.3.3.6.2.2.cmml" xref="S3.Ex1.m1.3.3.6.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.6.2.2.1.cmml" xref="S3.Ex1.m1.3.3.6.2.2">subscript</csymbol><ci id="S3.Ex1.m1.3.3.6.2.2.2.cmml" xref="S3.Ex1.m1.3.3.6.2.2.2">𝛾</ci><ci id="S3.Ex1.m1.3.3.6.2.2.3.cmml" xref="S3.Ex1.m1.3.3.6.2.2.3">𝑚</ci></apply><apply id="S3.Ex1.m1.3.3.6.2.3.cmml" xref="S3.Ex1.m1.3.3.6.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.6.2.3.1.cmml" xref="S3.Ex1.m1.3.3.6.2.3">superscript</csymbol><ci id="S3.Ex1.m1.3.3.6.2.3.2.cmml" xref="S3.Ex1.m1.3.3.6.2.3.2">𝕩</ci><ci id="S3.Ex1.m1.2.2.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.3c">\mathbb{x}=\lambda\mathbb{x}^{query}+(1-\lambda)\sum_{i}w_{i}{\mathbb{x}^{item%
}}^{(i)}=\sum_{m\in M+1}\gamma_{m}\mathbb{x}^{(m)}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.3d">blackboard_x = italic_λ blackboard_x start_POSTSUPERSCRIPT italic_q italic_u italic_e italic_r italic_y end_POSTSUPERSCRIPT + ( 1 - italic_λ ) ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT blackboard_x start_POSTSUPERSCRIPT italic_i italic_t italic_e italic_m end_POSTSUPERSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = ∑ start_POSTSUBSCRIPT italic_m ∈ italic_M + 1 end_POSTSUBSCRIPT italic_γ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT blackboard_x start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.Px1.p4">
<p class="ltx_p" id="S3.SS3.SSS1.Px1.p4.12"><math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p4.1.m1.1"><semantics id="S3.SS3.SSS1.Px1.p4.1.m1.1a"><mi id="S3.SS3.SSS1.Px1.p4.1.m1.1.1" xref="S3.SS3.SSS1.Px1.p4.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p4.1.m1.1b"><ci id="S3.SS3.SSS1.Px1.p4.1.m1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p4.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p4.1.m1.1d">italic_λ</annotation></semantics></math> and <math alttext="(1-\lambda)" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p4.2.m2.1"><semantics id="S3.SS3.SSS1.Px1.p4.2.m2.1a"><mrow id="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1" xref="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1.1" xref="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1.1.cmml"><mn id="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1.1.2" xref="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1.1.2.cmml">1</mn><mo id="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1.1.1.cmml">−</mo><mi id="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1.1.3" xref="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1.1.3.cmml">λ</mi></mrow><mo id="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p4.2.m2.1b"><apply id="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1"><minus id="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1.1.1"></minus><cn id="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1.1.2.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1.1.2">1</cn><ci id="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p4.2.m2.1.1.1.1.3">𝜆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p4.2.m2.1c">(1-\lambda)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p4.2.m2.1d">( 1 - italic_λ )</annotation></semantics></math> denote the weight to merge representations of query and item vectors respectively as <math alttext="\lambda\in[0,1]" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p4.3.m3.2"><semantics id="S3.SS3.SSS1.Px1.p4.3.m3.2a"><mrow id="S3.SS3.SSS1.Px1.p4.3.m3.2.3" xref="S3.SS3.SSS1.Px1.p4.3.m3.2.3.cmml"><mi id="S3.SS3.SSS1.Px1.p4.3.m3.2.3.2" xref="S3.SS3.SSS1.Px1.p4.3.m3.2.3.2.cmml">λ</mi><mo id="S3.SS3.SSS1.Px1.p4.3.m3.2.3.1" xref="S3.SS3.SSS1.Px1.p4.3.m3.2.3.1.cmml">∈</mo><mrow id="S3.SS3.SSS1.Px1.p4.3.m3.2.3.3.2" xref="S3.SS3.SSS1.Px1.p4.3.m3.2.3.3.1.cmml"><mo id="S3.SS3.SSS1.Px1.p4.3.m3.2.3.3.2.1" stretchy="false" xref="S3.SS3.SSS1.Px1.p4.3.m3.2.3.3.1.cmml">[</mo><mn id="S3.SS3.SSS1.Px1.p4.3.m3.1.1" xref="S3.SS3.SSS1.Px1.p4.3.m3.1.1.cmml">0</mn><mo id="S3.SS3.SSS1.Px1.p4.3.m3.2.3.3.2.2" xref="S3.SS3.SSS1.Px1.p4.3.m3.2.3.3.1.cmml">,</mo><mn id="S3.SS3.SSS1.Px1.p4.3.m3.2.2" xref="S3.SS3.SSS1.Px1.p4.3.m3.2.2.cmml">1</mn><mo id="S3.SS3.SSS1.Px1.p4.3.m3.2.3.3.2.3" stretchy="false" xref="S3.SS3.SSS1.Px1.p4.3.m3.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p4.3.m3.2b"><apply id="S3.SS3.SSS1.Px1.p4.3.m3.2.3.cmml" xref="S3.SS3.SSS1.Px1.p4.3.m3.2.3"><in id="S3.SS3.SSS1.Px1.p4.3.m3.2.3.1.cmml" xref="S3.SS3.SSS1.Px1.p4.3.m3.2.3.1"></in><ci id="S3.SS3.SSS1.Px1.p4.3.m3.2.3.2.cmml" xref="S3.SS3.SSS1.Px1.p4.3.m3.2.3.2">𝜆</ci><interval closure="closed" id="S3.SS3.SSS1.Px1.p4.3.m3.2.3.3.1.cmml" xref="S3.SS3.SSS1.Px1.p4.3.m3.2.3.3.2"><cn id="S3.SS3.SSS1.Px1.p4.3.m3.1.1.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p4.3.m3.1.1">0</cn><cn id="S3.SS3.SSS1.Px1.p4.3.m3.2.2.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p4.3.m3.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p4.3.m3.2c">\lambda\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p4.3.m3.2d">italic_λ ∈ [ 0 , 1 ]</annotation></semantics></math>, and <math alttext="w_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p4.4.m4.1"><semantics id="S3.SS3.SSS1.Px1.p4.4.m4.1a"><msub id="S3.SS3.SSS1.Px1.p4.4.m4.1.1" xref="S3.SS3.SSS1.Px1.p4.4.m4.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p4.4.m4.1.1.2" xref="S3.SS3.SSS1.Px1.p4.4.m4.1.1.2.cmml">w</mi><mi id="S3.SS3.SSS1.Px1.p4.4.m4.1.1.3" xref="S3.SS3.SSS1.Px1.p4.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p4.4.m4.1b"><apply id="S3.SS3.SSS1.Px1.p4.4.m4.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p4.4.m4.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p4.4.m4.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p4.4.m4.1.1.2">𝑤</ci><ci id="S3.SS3.SSS1.Px1.p4.4.m4.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p4.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p4.4.m4.1c">w_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p4.4.m4.1d">italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denotes the weight to merge multi-modal item representations. To simplify the notations, we use a single vector <math alttext="[\gamma_{m}]^{1:M+1}\in\mathbb{R}^{M+1}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p4.5.m5.1"><semantics id="S3.SS3.SSS1.Px1.p4.5.m5.1a"><mrow id="S3.SS3.SSS1.Px1.p4.5.m5.1.1" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.cmml"><msup id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.cmml"><mrow id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.2.cmml"><mo id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.2.1.cmml">[</mo><msub id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.1.1.2" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.1.1.2.cmml">γ</mi><mi id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.1.1.3" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.1.1.3.cmml">m</mi></msub><mo id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.cmml"><mn id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.2" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.2.cmml">1</mn><mo id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.1.cmml">:</mo><mrow id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.3" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.3.cmml"><mi id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.3.2" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.3.2.cmml">M</mi><mo id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.3.1" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.3.1.cmml">+</mo><mn id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.3.3" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msup><mo id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.2" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.2.cmml">∈</mo><msup id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.cmml"><mi id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.2" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.3" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.3.cmml"><mi id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.3.2" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.3.2.cmml">M</mi><mo id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.3.1" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.3.1.cmml">+</mo><mn id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.3.3" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p4.5.m5.1b"><apply id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1"><in id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.2"></in><apply id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1">superscript</csymbol><apply id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.1.1.2">𝛾</ci><ci id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.1.1.1.3">𝑚</ci></apply></apply><apply id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3"><ci id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.1">:</ci><cn id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.2.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.2">1</cn><apply id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.3"><plus id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.3.1"></plus><ci id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.3.2">𝑀</ci><cn id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.3.3.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.3"><plus id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.3.1"></plus><ci id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.3.2">𝑀</ci><cn id="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.3.3.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p4.5.m5.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p4.5.m5.1c">[\gamma_{m}]^{1:M+1}\in\mathbb{R}^{M+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p4.5.m5.1d">[ italic_γ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ] start_POSTSUPERSCRIPT 1 : italic_M + 1 end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_M + 1 end_POSTSUPERSCRIPT</annotation></semantics></math> to represent the weight of all <math alttext="(M+1)" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p4.6.m6.1"><semantics id="S3.SS3.SSS1.Px1.p4.6.m6.1a"><mrow id="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1" xref="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1.1" xref="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1.1.2" xref="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1.1.2.cmml">M</mi><mo id="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1.1.1.cmml">+</mo><mn id="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1.1.3" xref="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p4.6.m6.1b"><apply id="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1"><plus id="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1.1.1"></plus><ci id="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1.1.2">𝑀</ci><cn id="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p4.6.m6.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p4.6.m6.1c">(M+1)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p4.6.m6.1d">( italic_M + 1 )</annotation></semantics></math> channels and the sum of the weight equals to 1 as <math alttext="\sum\gamma_{m}=1" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p4.7.m7.1"><semantics id="S3.SS3.SSS1.Px1.p4.7.m7.1a"><mrow id="S3.SS3.SSS1.Px1.p4.7.m7.1.1" xref="S3.SS3.SSS1.Px1.p4.7.m7.1.1.cmml"><mrow id="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2" xref="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2.cmml"><mo id="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2.1" xref="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2.1.cmml">∑</mo><msub id="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2.2" xref="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2.2.cmml"><mi id="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2.2.2" xref="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2.2.2.cmml">γ</mi><mi id="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2.2.3" xref="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2.2.3.cmml">m</mi></msub></mrow><mo id="S3.SS3.SSS1.Px1.p4.7.m7.1.1.1" xref="S3.SS3.SSS1.Px1.p4.7.m7.1.1.1.cmml">=</mo><mn id="S3.SS3.SSS1.Px1.p4.7.m7.1.1.3" xref="S3.SS3.SSS1.Px1.p4.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p4.7.m7.1b"><apply id="S3.SS3.SSS1.Px1.p4.7.m7.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.7.m7.1.1"><eq id="S3.SS3.SSS1.Px1.p4.7.m7.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.7.m7.1.1.1"></eq><apply id="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2"><sum id="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2.1"></sum><apply id="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2.2.2">𝛾</ci><ci id="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2.2.3.cmml" xref="S3.SS3.SSS1.Px1.p4.7.m7.1.1.2.2.3">𝑚</ci></apply></apply><cn id="S3.SS3.SSS1.Px1.p4.7.m7.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p4.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p4.7.m7.1c">\sum\gamma_{m}=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p4.7.m7.1d">∑ italic_γ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = 1</annotation></semantics></math>. The weight vector <math alttext="\gamma_{m}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p4.8.m8.1"><semantics id="S3.SS3.SSS1.Px1.p4.8.m8.1a"><msub id="S3.SS3.SSS1.Px1.p4.8.m8.1.1" xref="S3.SS3.SSS1.Px1.p4.8.m8.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p4.8.m8.1.1.2" xref="S3.SS3.SSS1.Px1.p4.8.m8.1.1.2.cmml">γ</mi><mi id="S3.SS3.SSS1.Px1.p4.8.m8.1.1.3" xref="S3.SS3.SSS1.Px1.p4.8.m8.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p4.8.m8.1b"><apply id="S3.SS3.SSS1.Px1.p4.8.m8.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p4.8.m8.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p4.8.m8.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p4.8.m8.1.1.2">𝛾</ci><ci id="S3.SS3.SSS1.Px1.p4.8.m8.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p4.8.m8.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p4.8.m8.1c">\gamma_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p4.8.m8.1d">italic_γ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> can be learned dynamically as the softmax output of a gating network. The attention is calculated as the inner product of queries and keys of the merged multi-channel representations. The final attention score will be dominated by the modals with large norm values <math alttext="|x^{(m)}|" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p4.9.m9.2"><semantics id="S3.SS3.SSS1.Px1.p4.9.m9.2a"><mrow id="S3.SS3.SSS1.Px1.p4.9.m9.2.2.1" xref="S3.SS3.SSS1.Px1.p4.9.m9.2.2.2.cmml"><mo id="S3.SS3.SSS1.Px1.p4.9.m9.2.2.1.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p4.9.m9.2.2.2.1.cmml">|</mo><msup id="S3.SS3.SSS1.Px1.p4.9.m9.2.2.1.1" xref="S3.SS3.SSS1.Px1.p4.9.m9.2.2.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p4.9.m9.2.2.1.1.2" xref="S3.SS3.SSS1.Px1.p4.9.m9.2.2.1.1.2.cmml">x</mi><mrow id="S3.SS3.SSS1.Px1.p4.9.m9.1.1.1.3" xref="S3.SS3.SSS1.Px1.p4.9.m9.2.2.1.1.cmml"><mo id="S3.SS3.SSS1.Px1.p4.9.m9.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS1.Px1.p4.9.m9.2.2.1.1.cmml">(</mo><mi id="S3.SS3.SSS1.Px1.p4.9.m9.1.1.1.1" xref="S3.SS3.SSS1.Px1.p4.9.m9.1.1.1.1.cmml">m</mi><mo id="S3.SS3.SSS1.Px1.p4.9.m9.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p4.9.m9.2.2.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS3.SSS1.Px1.p4.9.m9.2.2.1.3" stretchy="false" xref="S3.SS3.SSS1.Px1.p4.9.m9.2.2.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p4.9.m9.2b"><apply id="S3.SS3.SSS1.Px1.p4.9.m9.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p4.9.m9.2.2.1"><abs id="S3.SS3.SSS1.Px1.p4.9.m9.2.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p4.9.m9.2.2.1.2"></abs><apply id="S3.SS3.SSS1.Px1.p4.9.m9.2.2.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.9.m9.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p4.9.m9.2.2.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.9.m9.2.2.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p4.9.m9.2.2.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p4.9.m9.2.2.1.1.2">𝑥</ci><ci id="S3.SS3.SSS1.Px1.p4.9.m9.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.9.m9.1.1.1.1">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p4.9.m9.2c">|x^{(m)}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p4.9.m9.2d">| italic_x start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT |</annotation></semantics></math> and large weight <math alttext="\gamma_{m}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p4.10.m10.1"><semantics id="S3.SS3.SSS1.Px1.p4.10.m10.1a"><msub id="S3.SS3.SSS1.Px1.p4.10.m10.1.1" xref="S3.SS3.SSS1.Px1.p4.10.m10.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p4.10.m10.1.1.2" xref="S3.SS3.SSS1.Px1.p4.10.m10.1.1.2.cmml">γ</mi><mi id="S3.SS3.SSS1.Px1.p4.10.m10.1.1.3" xref="S3.SS3.SSS1.Px1.p4.10.m10.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p4.10.m10.1b"><apply id="S3.SS3.SSS1.Px1.p4.10.m10.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p4.10.m10.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.10.m10.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p4.10.m10.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p4.10.m10.1.1.2">𝛾</ci><ci id="S3.SS3.SSS1.Px1.p4.10.m10.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p4.10.m10.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p4.10.m10.1c">\gamma_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p4.10.m10.1d">italic_γ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>, and the information from other modals will be easily ignored. So we specifically decompose the attention score calculation into the norm value part <math alttext="|x^{(m)}|" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p4.11.m11.2"><semantics id="S3.SS3.SSS1.Px1.p4.11.m11.2a"><mrow id="S3.SS3.SSS1.Px1.p4.11.m11.2.2.1" xref="S3.SS3.SSS1.Px1.p4.11.m11.2.2.2.cmml"><mo id="S3.SS3.SSS1.Px1.p4.11.m11.2.2.1.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p4.11.m11.2.2.2.1.cmml">|</mo><msup id="S3.SS3.SSS1.Px1.p4.11.m11.2.2.1.1" xref="S3.SS3.SSS1.Px1.p4.11.m11.2.2.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p4.11.m11.2.2.1.1.2" xref="S3.SS3.SSS1.Px1.p4.11.m11.2.2.1.1.2.cmml">x</mi><mrow id="S3.SS3.SSS1.Px1.p4.11.m11.1.1.1.3" xref="S3.SS3.SSS1.Px1.p4.11.m11.2.2.1.1.cmml"><mo id="S3.SS3.SSS1.Px1.p4.11.m11.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS1.Px1.p4.11.m11.2.2.1.1.cmml">(</mo><mi id="S3.SS3.SSS1.Px1.p4.11.m11.1.1.1.1" xref="S3.SS3.SSS1.Px1.p4.11.m11.1.1.1.1.cmml">m</mi><mo id="S3.SS3.SSS1.Px1.p4.11.m11.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p4.11.m11.2.2.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS3.SSS1.Px1.p4.11.m11.2.2.1.3" stretchy="false" xref="S3.SS3.SSS1.Px1.p4.11.m11.2.2.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p4.11.m11.2b"><apply id="S3.SS3.SSS1.Px1.p4.11.m11.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p4.11.m11.2.2.1"><abs id="S3.SS3.SSS1.Px1.p4.11.m11.2.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p4.11.m11.2.2.1.2"></abs><apply id="S3.SS3.SSS1.Px1.p4.11.m11.2.2.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.11.m11.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p4.11.m11.2.2.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.11.m11.2.2.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p4.11.m11.2.2.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p4.11.m11.2.2.1.1.2">𝑥</ci><ci id="S3.SS3.SSS1.Px1.p4.11.m11.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.11.m11.1.1.1.1">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p4.11.m11.2c">|x^{(m)}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p4.11.m11.2d">| italic_x start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT |</annotation></semantics></math> and unit vector part <math alttext="\hat{x}^{(m)}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p4.12.m12.1"><semantics id="S3.SS3.SSS1.Px1.p4.12.m12.1a"><msup id="S3.SS3.SSS1.Px1.p4.12.m12.1.2" xref="S3.SS3.SSS1.Px1.p4.12.m12.1.2.cmml"><mover accent="true" id="S3.SS3.SSS1.Px1.p4.12.m12.1.2.2" xref="S3.SS3.SSS1.Px1.p4.12.m12.1.2.2.cmml"><mi id="S3.SS3.SSS1.Px1.p4.12.m12.1.2.2.2" xref="S3.SS3.SSS1.Px1.p4.12.m12.1.2.2.2.cmml">x</mi><mo id="S3.SS3.SSS1.Px1.p4.12.m12.1.2.2.1" xref="S3.SS3.SSS1.Px1.p4.12.m12.1.2.2.1.cmml">^</mo></mover><mrow id="S3.SS3.SSS1.Px1.p4.12.m12.1.1.1.3" xref="S3.SS3.SSS1.Px1.p4.12.m12.1.2.cmml"><mo id="S3.SS3.SSS1.Px1.p4.12.m12.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS1.Px1.p4.12.m12.1.2.cmml">(</mo><mi id="S3.SS3.SSS1.Px1.p4.12.m12.1.1.1.1" xref="S3.SS3.SSS1.Px1.p4.12.m12.1.1.1.1.cmml">m</mi><mo id="S3.SS3.SSS1.Px1.p4.12.m12.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p4.12.m12.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p4.12.m12.1b"><apply id="S3.SS3.SSS1.Px1.p4.12.m12.1.2.cmml" xref="S3.SS3.SSS1.Px1.p4.12.m12.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p4.12.m12.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p4.12.m12.1.2">superscript</csymbol><apply id="S3.SS3.SSS1.Px1.p4.12.m12.1.2.2.cmml" xref="S3.SS3.SSS1.Px1.p4.12.m12.1.2.2"><ci id="S3.SS3.SSS1.Px1.p4.12.m12.1.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p4.12.m12.1.2.2.1">^</ci><ci id="S3.SS3.SSS1.Px1.p4.12.m12.1.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p4.12.m12.1.2.2.2">𝑥</ci></apply><ci id="S3.SS3.SSS1.Px1.p4.12.m12.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p4.12.m12.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p4.12.m12.1c">\hat{x}^{(m)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p4.12.m12.1d">over^ start_ARG italic_x end_ARG start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.Px1.p5">
<p class="ltx_p" id="S3.SS3.SSS1.Px1.p5.7">We let <math alttext="q_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p5.1.m1.1"><semantics id="S3.SS3.SSS1.Px1.p5.1.m1.1a"><msub id="S3.SS3.SSS1.Px1.p5.1.m1.1.1" xref="S3.SS3.SSS1.Px1.p5.1.m1.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p5.1.m1.1.1.2" xref="S3.SS3.SSS1.Px1.p5.1.m1.1.1.2.cmml">q</mi><mi id="S3.SS3.SSS1.Px1.p5.1.m1.1.1.3" xref="S3.SS3.SSS1.Px1.p5.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p5.1.m1.1b"><apply id="S3.SS3.SSS1.Px1.p5.1.m1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p5.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p5.1.m1.1.1.2">𝑞</ci><ci id="S3.SS3.SSS1.Px1.p5.1.m1.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p5.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p5.1.m1.1c">q_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p5.1.m1.1d">italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> denote the representation of target query-item pair as <math alttext="q_{t}=\sum_{i}\gamma_{i}\mathbb{x}^{(i)}_{t}=\sum_{i}\gamma_{i}|\mathbb{x}^{(i%
)}_{t}|\hat{\mathbb{x}}^{(i)}_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p5.2.m2.4"><semantics id="S3.SS3.SSS1.Px1.p5.2.m2.4a"><mrow id="S3.SS3.SSS1.Px1.p5.2.m2.4.4" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.cmml"><msub id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.3" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.3.cmml"><mi id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.3.2" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.3.2.cmml">q</mi><mi id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.3.3" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.3.3.cmml">t</mi></msub><mo id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.4" rspace="0.111em" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.4.cmml">=</mo><mrow id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.cmml"><msub id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.1" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.1.cmml"><mo id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.1.2" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.1.2.cmml">∑</mo><mi id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.1.3" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.1.3.cmml">i</mi></msub><mrow id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.cmml"><msub id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.2" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.2.cmml"><mi id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.2.2" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.2.2.cmml">γ</mi><mi id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.2.3" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.2.3.cmml">i</mi></msub><mo id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.1" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.1.cmml">⁢</mo><msubsup id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3.cmml"><mi id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3.2.2" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3.3" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3.3.cmml">t</mi><mrow id="S3.SS3.SSS1.Px1.p5.2.m2.1.1.1.3" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3.cmml"><mo id="S3.SS3.SSS1.Px1.p5.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3.cmml">(</mo><mi id="S3.SS3.SSS1.Px1.p5.2.m2.1.1.1.1" xref="S3.SS3.SSS1.Px1.p5.2.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS1.Px1.p5.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.6" rspace="0.111em" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.6.cmml">=</mo><mrow id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.cmml"><msub id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.2" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.2.cmml"><mo id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.2.2" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.2.2.cmml">∑</mo><mi id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.2.3" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.2.3.cmml">i</mi></msub><mrow id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.cmml"><msub id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.3" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.3.cmml"><mi id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.3.2" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.3.2.cmml">γ</mi><mi id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.3.3" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.3.3.cmml">i</mi></msub><mo id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.2" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.2.cmml"><mo id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.2.1.cmml">|</mo><msubsup id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1.2.2" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1.3" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1.3.cmml">t</mi><mrow id="S3.SS3.SSS1.Px1.p5.2.m2.2.2.1.3" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.Px1.p5.2.m2.2.2.1.3.1" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS1.Px1.p5.2.m2.2.2.1.1" xref="S3.SS3.SSS1.Px1.p5.2.m2.2.2.1.1.cmml">i</mi><mo id="S3.SS3.SSS1.Px1.p5.2.m2.2.2.1.3.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.2a" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.2.cmml">⁢</mo><msubsup id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.cmml"><mover accent="true" id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.2.2" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.2.2.cmml"><mi id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.2.2.2" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.2.2.2.cmml">𝕩</mi><mo id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.2.2.1" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.3" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.3.cmml">t</mi><mrow id="S3.SS3.SSS1.Px1.p5.2.m2.3.3.1.3" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.cmml"><mo id="S3.SS3.SSS1.Px1.p5.2.m2.3.3.1.3.1" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.cmml">(</mo><mi id="S3.SS3.SSS1.Px1.p5.2.m2.3.3.1.1" xref="S3.SS3.SSS1.Px1.p5.2.m2.3.3.1.1.cmml">i</mi><mo id="S3.SS3.SSS1.Px1.p5.2.m2.3.3.1.3.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p5.2.m2.4b"><apply id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4"><and id="S3.SS3.SSS1.Px1.p5.2.m2.4.4a.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4"></and><apply id="S3.SS3.SSS1.Px1.p5.2.m2.4.4b.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4"><eq id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.4.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.4"></eq><apply id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.3.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.3.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.3">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.3.2.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.3.2">𝑞</ci><ci id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.3.3.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.3.3">𝑡</ci></apply><apply id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5"><apply id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.1">subscript</csymbol><sum id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.1.2.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.1.2"></sum><ci id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.1.3.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.1.3">𝑖</ci></apply><apply id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2"><times id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.1"></times><apply id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.2.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.2.2">𝛾</ci><ci id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.2.3.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3.2.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3.2.2.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3.2.2">𝕩</ci><ci id="S3.SS3.SSS1.Px1.p5.2.m2.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.1.1.1.1">𝑖</ci></apply><ci id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3.3.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.2.3.3">𝑡</ci></apply></apply></apply></apply><apply id="S3.SS3.SSS1.Px1.p5.2.m2.4.4c.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4"><eq id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.6.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.6"></eq><share href="https://arxiv.org/html/2407.10714v1#S3.SS3.SSS1.Px1.p5.2.m2.4.4.5.cmml" id="S3.SS3.SSS1.Px1.p5.2.m2.4.4d.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4"></share><apply id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1"><apply id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.2.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.2">subscript</csymbol><sum id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.2.2.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.2.2"></sum><ci id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.2.3.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1"><times id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.2"></times><apply id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.3.2">𝛾</ci><ci id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.3.3">𝑖</ci></apply><apply id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1"><abs id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.2"></abs><apply id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1.2.2">𝕩</ci><ci id="S3.SS3.SSS1.Px1.p5.2.m2.2.2.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.2.2.1.1">𝑖</ci></apply><ci id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.2.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4">superscript</csymbol><apply id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.2.2.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.2.2"><ci id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.2.2.1">^</ci><ci id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.2.2.2">𝕩</ci></apply><ci id="S3.SS3.SSS1.Px1.p5.2.m2.3.3.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.3.3.1.1">𝑖</ci></apply><ci id="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.3.cmml" xref="S3.SS3.SSS1.Px1.p5.2.m2.4.4.1.1.4.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p5.2.m2.4c">q_{t}=\sum_{i}\gamma_{i}\mathbb{x}^{(i)}_{t}=\sum_{i}\gamma_{i}|\mathbb{x}^{(i%
)}_{t}|\hat{\mathbb{x}}^{(i)}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p5.2.m2.4d">italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_γ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT blackboard_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_γ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | blackboard_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | over^ start_ARG blackboard_x end_ARG start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. Note that the <math alttext="|\mathbb{x}^{(i)}_{t}|" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p5.3.m3.2"><semantics id="S3.SS3.SSS1.Px1.p5.3.m3.2a"><mrow id="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1" xref="S3.SS3.SSS1.Px1.p5.3.m3.2.2.2.cmml"><mo id="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.3.m3.2.2.2.1.cmml">|</mo><msubsup id="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1" xref="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1.2.2" xref="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1.3" xref="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1.3.cmml">t</mi><mrow id="S3.SS3.SSS1.Px1.p5.3.m3.1.1.1.3" xref="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1.cmml"><mo id="S3.SS3.SSS1.Px1.p5.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1.cmml">(</mo><mi id="S3.SS3.SSS1.Px1.p5.3.m3.1.1.1.1" xref="S3.SS3.SSS1.Px1.p5.3.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS1.Px1.p5.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.3" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.3.m3.2.2.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p5.3.m3.2b"><apply id="S3.SS3.SSS1.Px1.p5.3.m3.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1"><abs id="S3.SS3.SSS1.Px1.p5.3.m3.2.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.2"></abs><apply id="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1.2.2">𝕩</ci><ci id="S3.SS3.SSS1.Px1.p5.3.m3.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.3.m3.1.1.1.1">𝑖</ci></apply><ci id="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p5.3.m3.2.2.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p5.3.m3.2c">|\mathbb{x}^{(i)}_{t}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p5.3.m3.2d">| blackboard_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT |</annotation></semantics></math> denotes the norm value of the i-th channel of target item and <math alttext="\hat{\mathbb{x}}^{(i)}_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p5.4.m4.1"><semantics id="S3.SS3.SSS1.Px1.p5.4.m4.1a"><msubsup id="S3.SS3.SSS1.Px1.p5.4.m4.1.2" xref="S3.SS3.SSS1.Px1.p5.4.m4.1.2.cmml"><mover accent="true" id="S3.SS3.SSS1.Px1.p5.4.m4.1.2.2.2" xref="S3.SS3.SSS1.Px1.p5.4.m4.1.2.2.2.cmml"><mi id="S3.SS3.SSS1.Px1.p5.4.m4.1.2.2.2.2" xref="S3.SS3.SSS1.Px1.p5.4.m4.1.2.2.2.2.cmml">𝕩</mi><mo id="S3.SS3.SSS1.Px1.p5.4.m4.1.2.2.2.1" xref="S3.SS3.SSS1.Px1.p5.4.m4.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSS1.Px1.p5.4.m4.1.2.3" xref="S3.SS3.SSS1.Px1.p5.4.m4.1.2.3.cmml">t</mi><mrow id="S3.SS3.SSS1.Px1.p5.4.m4.1.1.1.3" xref="S3.SS3.SSS1.Px1.p5.4.m4.1.2.cmml"><mo id="S3.SS3.SSS1.Px1.p5.4.m4.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.4.m4.1.2.cmml">(</mo><mi id="S3.SS3.SSS1.Px1.p5.4.m4.1.1.1.1" xref="S3.SS3.SSS1.Px1.p5.4.m4.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS1.Px1.p5.4.m4.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.4.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p5.4.m4.1b"><apply id="S3.SS3.SSS1.Px1.p5.4.m4.1.2.cmml" xref="S3.SS3.SSS1.Px1.p5.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.4.m4.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.4.m4.1.2">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p5.4.m4.1.2.2.cmml" xref="S3.SS3.SSS1.Px1.p5.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.4.m4.1.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.4.m4.1.2">superscript</csymbol><apply id="S3.SS3.SSS1.Px1.p5.4.m4.1.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p5.4.m4.1.2.2.2"><ci id="S3.SS3.SSS1.Px1.p5.4.m4.1.2.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.4.m4.1.2.2.2.1">^</ci><ci id="S3.SS3.SSS1.Px1.p5.4.m4.1.2.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p5.4.m4.1.2.2.2.2">𝕩</ci></apply><ci id="S3.SS3.SSS1.Px1.p5.4.m4.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.4.m4.1.1.1.1">𝑖</ci></apply><ci id="S3.SS3.SSS1.Px1.p5.4.m4.1.2.3.cmml" xref="S3.SS3.SSS1.Px1.p5.4.m4.1.2.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p5.4.m4.1c">\hat{\mathbb{x}}^{(i)}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p5.4.m4.1d">over^ start_ARG blackboard_x end_ARG start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is a unit vector. Similarly, we can express the <math alttext="l-th" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p5.5.m5.1"><semantics id="S3.SS3.SSS1.Px1.p5.5.m5.1a"><mrow id="S3.SS3.SSS1.Px1.p5.5.m5.1.1" xref="S3.SS3.SSS1.Px1.p5.5.m5.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p5.5.m5.1.1.2" xref="S3.SS3.SSS1.Px1.p5.5.m5.1.1.2.cmml">l</mi><mo id="S3.SS3.SSS1.Px1.p5.5.m5.1.1.1" xref="S3.SS3.SSS1.Px1.p5.5.m5.1.1.1.cmml">−</mo><mrow id="S3.SS3.SSS1.Px1.p5.5.m5.1.1.3" xref="S3.SS3.SSS1.Px1.p5.5.m5.1.1.3.cmml"><mi id="S3.SS3.SSS1.Px1.p5.5.m5.1.1.3.2" xref="S3.SS3.SSS1.Px1.p5.5.m5.1.1.3.2.cmml">t</mi><mo id="S3.SS3.SSS1.Px1.p5.5.m5.1.1.3.1" xref="S3.SS3.SSS1.Px1.p5.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p5.5.m5.1.1.3.3" xref="S3.SS3.SSS1.Px1.p5.5.m5.1.1.3.3.cmml">h</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p5.5.m5.1b"><apply id="S3.SS3.SSS1.Px1.p5.5.m5.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.5.m5.1.1"><minus id="S3.SS3.SSS1.Px1.p5.5.m5.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.5.m5.1.1.1"></minus><ci id="S3.SS3.SSS1.Px1.p5.5.m5.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p5.5.m5.1.1.2">𝑙</ci><apply id="S3.SS3.SSS1.Px1.p5.5.m5.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p5.5.m5.1.1.3"><times id="S3.SS3.SSS1.Px1.p5.5.m5.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px1.p5.5.m5.1.1.3.1"></times><ci id="S3.SS3.SSS1.Px1.p5.5.m5.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px1.p5.5.m5.1.1.3.2">𝑡</ci><ci id="S3.SS3.SSS1.Px1.p5.5.m5.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px1.p5.5.m5.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p5.5.m5.1c">l-th</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p5.5.m5.1d">italic_l - italic_t italic_h</annotation></semantics></math> historical behavior <math alttext="k_{l}\in K" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p5.6.m6.1"><semantics id="S3.SS3.SSS1.Px1.p5.6.m6.1a"><mrow id="S3.SS3.SSS1.Px1.p5.6.m6.1.1" xref="S3.SS3.SSS1.Px1.p5.6.m6.1.1.cmml"><msub id="S3.SS3.SSS1.Px1.p5.6.m6.1.1.2" xref="S3.SS3.SSS1.Px1.p5.6.m6.1.1.2.cmml"><mi id="S3.SS3.SSS1.Px1.p5.6.m6.1.1.2.2" xref="S3.SS3.SSS1.Px1.p5.6.m6.1.1.2.2.cmml">k</mi><mi id="S3.SS3.SSS1.Px1.p5.6.m6.1.1.2.3" xref="S3.SS3.SSS1.Px1.p5.6.m6.1.1.2.3.cmml">l</mi></msub><mo id="S3.SS3.SSS1.Px1.p5.6.m6.1.1.1" xref="S3.SS3.SSS1.Px1.p5.6.m6.1.1.1.cmml">∈</mo><mi id="S3.SS3.SSS1.Px1.p5.6.m6.1.1.3" xref="S3.SS3.SSS1.Px1.p5.6.m6.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p5.6.m6.1b"><apply id="S3.SS3.SSS1.Px1.p5.6.m6.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.6.m6.1.1"><in id="S3.SS3.SSS1.Px1.p5.6.m6.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.6.m6.1.1.1"></in><apply id="S3.SS3.SSS1.Px1.p5.6.m6.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p5.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.6.m6.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p5.6.m6.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px1.p5.6.m6.1.1.2.2">𝑘</ci><ci id="S3.SS3.SSS1.Px1.p5.6.m6.1.1.2.3.cmml" xref="S3.SS3.SSS1.Px1.p5.6.m6.1.1.2.3">𝑙</ci></apply><ci id="S3.SS3.SSS1.Px1.p5.6.m6.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p5.6.m6.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p5.6.m6.1c">k_{l}\in K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p5.6.m6.1d">italic_k start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∈ italic_K</annotation></semantics></math> as <math alttext="k_{l}=\sum_{j}\gamma_{j}\mathbb{x}^{(j)}_{l}=\sum_{i}\gamma_{j}|\mathbb{x}^{(j%
)}_{l}|\hat{\mathbb{x}}^{(j)}_{l}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p5.7.m7.4"><semantics id="S3.SS3.SSS1.Px1.p5.7.m7.4a"><mrow id="S3.SS3.SSS1.Px1.p5.7.m7.4.4" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.cmml"><msub id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.3" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.3.cmml"><mi id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.3.2" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.3.2.cmml">k</mi><mi id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.3.3" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.3.3.cmml">l</mi></msub><mo id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.4" rspace="0.111em" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.4.cmml">=</mo><mrow id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.cmml"><msub id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.1" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.1.cmml"><mo id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.1.2" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.1.2.cmml">∑</mo><mi id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.1.3" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.1.3.cmml">j</mi></msub><mrow id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.cmml"><msub id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.2" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.2.cmml"><mi id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.2.2" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.2.2.cmml">γ</mi><mi id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.2.3" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.2.3.cmml">j</mi></msub><mo id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.1" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.1.cmml">⁢</mo><msubsup id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3.cmml"><mi id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3.2.2" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3.3" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3.3.cmml">l</mi><mrow id="S3.SS3.SSS1.Px1.p5.7.m7.1.1.1.3" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3.cmml"><mo id="S3.SS3.SSS1.Px1.p5.7.m7.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3.cmml">(</mo><mi id="S3.SS3.SSS1.Px1.p5.7.m7.1.1.1.1" xref="S3.SS3.SSS1.Px1.p5.7.m7.1.1.1.1.cmml">j</mi><mo id="S3.SS3.SSS1.Px1.p5.7.m7.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.6" rspace="0.111em" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.6.cmml">=</mo><mrow id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.cmml"><msub id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.2" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.2.cmml"><mo id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.2.2" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.2.2.cmml">∑</mo><mi id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.2.3" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.2.3.cmml">i</mi></msub><mrow id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.cmml"><msub id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.3" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.3.cmml"><mi id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.3.2" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.3.2.cmml">γ</mi><mi id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.3.3" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.3.3.cmml">j</mi></msub><mo id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.2" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.2.cmml"><mo id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.2.1.cmml">|</mo><msubsup id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1.2.2" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1.3" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1.3.cmml">l</mi><mrow id="S3.SS3.SSS1.Px1.p5.7.m7.2.2.1.3" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.Px1.p5.7.m7.2.2.1.3.1" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS1.Px1.p5.7.m7.2.2.1.1" xref="S3.SS3.SSS1.Px1.p5.7.m7.2.2.1.1.cmml">j</mi><mo id="S3.SS3.SSS1.Px1.p5.7.m7.2.2.1.3.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.2a" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.2.cmml">⁢</mo><msubsup id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.cmml"><mover accent="true" id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.2.2" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.2.2.cmml"><mi id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.2.2.2" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.2.2.2.cmml">𝕩</mi><mo id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.2.2.1" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.3" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.3.cmml">l</mi><mrow id="S3.SS3.SSS1.Px1.p5.7.m7.3.3.1.3" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.cmml"><mo id="S3.SS3.SSS1.Px1.p5.7.m7.3.3.1.3.1" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.cmml">(</mo><mi id="S3.SS3.SSS1.Px1.p5.7.m7.3.3.1.1" xref="S3.SS3.SSS1.Px1.p5.7.m7.3.3.1.1.cmml">j</mi><mo id="S3.SS3.SSS1.Px1.p5.7.m7.3.3.1.3.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p5.7.m7.4b"><apply id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4"><and id="S3.SS3.SSS1.Px1.p5.7.m7.4.4a.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4"></and><apply id="S3.SS3.SSS1.Px1.p5.7.m7.4.4b.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4"><eq id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.4.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.4"></eq><apply id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.3.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.3.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.3">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.3.2.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.3.2">𝑘</ci><ci id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.3.3.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.3.3">𝑙</ci></apply><apply id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5"><apply id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.1">subscript</csymbol><sum id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.1.2.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.1.2"></sum><ci id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.1.3.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.1.3">𝑗</ci></apply><apply id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2"><times id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.1"></times><apply id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.2.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.2.2">𝛾</ci><ci id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.2.3.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.2.3">𝑗</ci></apply><apply id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3.2.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3.2.2.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3.2.2">𝕩</ci><ci id="S3.SS3.SSS1.Px1.p5.7.m7.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.1.1.1.1">𝑗</ci></apply><ci id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3.3.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.2.3.3">𝑙</ci></apply></apply></apply></apply><apply id="S3.SS3.SSS1.Px1.p5.7.m7.4.4c.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4"><eq id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.6.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.6"></eq><share href="https://arxiv.org/html/2407.10714v1#S3.SS3.SSS1.Px1.p5.7.m7.4.4.5.cmml" id="S3.SS3.SSS1.Px1.p5.7.m7.4.4d.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4"></share><apply id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1"><apply id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.2.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.2">subscript</csymbol><sum id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.2.2.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.2.2"></sum><ci id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.2.3.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1"><times id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.2"></times><apply id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.3.2">𝛾</ci><ci id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.3.3">𝑗</ci></apply><apply id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1"><abs id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.2"></abs><apply id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1.2.2">𝕩</ci><ci id="S3.SS3.SSS1.Px1.p5.7.m7.2.2.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.2.2.1.1">𝑗</ci></apply><ci id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.1.1.1.3">𝑙</ci></apply></apply><apply id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.2.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4">superscript</csymbol><apply id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.2.2.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.2.2"><ci id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.2.2.1">^</ci><ci id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.2.2.2">𝕩</ci></apply><ci id="S3.SS3.SSS1.Px1.p5.7.m7.3.3.1.1.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.3.3.1.1">𝑗</ci></apply><ci id="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.3.cmml" xref="S3.SS3.SSS1.Px1.p5.7.m7.4.4.1.1.4.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p5.7.m7.4c">k_{l}=\sum_{j}\gamma_{j}\mathbb{x}^{(j)}_{l}=\sum_{i}\gamma_{j}|\mathbb{x}^{(j%
)}_{l}|\hat{\mathbb{x}}^{(j)}_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p5.7.m7.4d">italic_k start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_γ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT blackboard_x start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_γ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | blackboard_x start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | over^ start_ARG blackboard_x end_ARG start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>. Note that the unit vectors of multi-modal sequence representations will participate in the multi-modal alignment task in the next section.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.Px1.p6">
<p class="ltx_p" id="S3.SS3.SSS1.Px1.p6.4">The <math alttext="h" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p6.1.m1.1"><semantics id="S3.SS3.SSS1.Px1.p6.1.m1.1a"><mi id="S3.SS3.SSS1.Px1.p6.1.m1.1.1" xref="S3.SS3.SSS1.Px1.p6.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p6.1.m1.1b"><ci id="S3.SS3.SSS1.Px1.p6.1.m1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p6.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p6.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p6.1.m1.1d">italic_h</annotation></semantics></math>-th head in the multi-head attention is represented as <math alttext="head^{PSU_{h}}=\text{Attention}_{h}(q_{t},K^{PSU},V^{PSU})" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p6.2.m2.3"><semantics id="S3.SS3.SSS1.Px1.p6.2.m2.3a"><mrow id="S3.SS3.SSS1.Px1.p6.2.m2.3.3" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.cmml"><mrow id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.cmml"><mi id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.2" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.2.cmml">h</mi><mo id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.1" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.3" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.3.cmml">e</mi><mo id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.1a" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.4" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.4.cmml">a</mi><mo id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.1b" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.1.cmml">⁢</mo><msup id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.cmml"><mi id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.2" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.2.cmml">d</mi><mrow id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.cmml"><mi id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.2" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.2.cmml">P</mi><mo id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.1" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.3" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.3.cmml">S</mi><mo id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.1a" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.1.cmml">⁢</mo><msub id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.4" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.4.cmml"><mi id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.4.2" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.4.2.cmml">U</mi><mi id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.4.3" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.4.3.cmml">h</mi></msub></mrow></msup></mrow><mo id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.4" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.4.cmml">=</mo><mrow id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.cmml"><msub id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.5" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.5.cmml"><mtext id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.5.2" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.5.2a.cmml">Attention</mtext><mi id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.5.3" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.5.3.cmml">h</mi></msub><mo id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.4" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.4.cmml">⁢</mo><mrow id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.4.cmml"><mo id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.4" stretchy="false" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.4.cmml">(</mo><msub id="S3.SS3.SSS1.Px1.p6.2.m2.1.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p6.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p6.2.m2.1.1.1.1.1.1.2" xref="S3.SS3.SSS1.Px1.p6.2.m2.1.1.1.1.1.1.2.cmml">q</mi><mi id="S3.SS3.SSS1.Px1.p6.2.m2.1.1.1.1.1.1.3" xref="S3.SS3.SSS1.Px1.p6.2.m2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.5" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.4.cmml">,</mo><msup id="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2" xref="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.2" xref="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.2.cmml">K</mi><mrow id="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3" xref="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3.cmml"><mi id="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3.2" xref="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3.2.cmml">P</mi><mo id="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3.1" xref="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3.3" xref="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3.3.cmml">S</mi><mo id="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3.1a" xref="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3.4" xref="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3.4.cmml">U</mi></mrow></msup><mo id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.6" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.4.cmml">,</mo><msup id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.cmml"><mi id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.2" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.2.cmml">V</mi><mrow id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3.cmml"><mi id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3.2" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3.2.cmml">P</mi><mo id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3.1" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3.3" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3.3.cmml">S</mi><mo id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3.1a" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3.4" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3.4.cmml">U</mi></mrow></msup><mo id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.7" stretchy="false" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p6.2.m2.3b"><apply id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3"><eq id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.4.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.4"></eq><apply id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5"><times id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.1.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.1"></times><ci id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.2.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.2">ℎ</ci><ci id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.3.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.3">𝑒</ci><ci id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.4.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.4">𝑎</ci><apply id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.1.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.2.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.2">𝑑</ci><apply id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3"><times id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.1.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.1"></times><ci id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.2.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.2">𝑃</ci><ci id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.3.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.3">𝑆</ci><apply id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.4.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.4"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.4.1.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.4">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.4.2.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.4.2">𝑈</ci><ci id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.4.3.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.5.5.3.4.3">ℎ</ci></apply></apply></apply></apply><apply id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3"><times id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.4.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.4"></times><apply id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.5.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.5"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.5.1.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.5">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.5.2a.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.5.2"><mtext id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.5.2.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.5.2">Attention</mtext></ci><ci id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.5.3.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.5.3">ℎ</ci></apply><vector id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.4.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3"><apply id="S3.SS3.SSS1.Px1.p6.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p6.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p6.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.1.1.1.1.1.1.2">𝑞</ci><ci id="S3.SS3.SSS1.Px1.p6.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.2">𝐾</ci><apply id="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3"><times id="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3.1.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3.1"></times><ci id="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3.2.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3.2">𝑃</ci><ci id="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3.3.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3.3">𝑆</ci><ci id="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3.4.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.2.2.2.2.2.2.3.4">𝑈</ci></apply></apply><apply id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.1.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.2.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.2">𝑉</ci><apply id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3"><times id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3.1.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3.1"></times><ci id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3.2.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3.2">𝑃</ci><ci id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3.3">𝑆</ci><ci id="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3.4.cmml" xref="S3.SS3.SSS1.Px1.p6.2.m2.3.3.3.3.3.3.3.4">𝑈</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p6.2.m2.3c">head^{PSU_{h}}=\text{Attention}_{h}(q_{t},K^{PSU},V^{PSU})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p6.2.m2.3d">italic_h italic_e italic_a italic_d start_POSTSUPERSCRIPT italic_P italic_S italic_U start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT = Attention start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_K start_POSTSUPERSCRIPT italic_P italic_S italic_U end_POSTSUPERSCRIPT , italic_V start_POSTSUPERSCRIPT italic_P italic_S italic_U end_POSTSUPERSCRIPT )</annotation></semantics></math>, and the attention score <math alttext="a^{PSU}_{h}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p6.3.m3.1"><semantics id="S3.SS3.SSS1.Px1.p6.3.m3.1a"><msubsup id="S3.SS3.SSS1.Px1.p6.3.m3.1.1" xref="S3.SS3.SSS1.Px1.p6.3.m3.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.2" xref="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.2.cmml">a</mi><mi id="S3.SS3.SSS1.Px1.p6.3.m3.1.1.3" xref="S3.SS3.SSS1.Px1.p6.3.m3.1.1.3.cmml">h</mi><mrow id="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3" xref="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3.cmml"><mi id="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3.2" xref="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3.2.cmml">P</mi><mo id="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3.1" xref="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3.3" xref="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3.3.cmml">S</mi><mo id="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3.1a" xref="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3.4" xref="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3.4.cmml">U</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p6.3.m3.1b"><apply id="S3.SS3.SSS1.Px1.p6.3.m3.1.1.cmml" xref="S3.SS3.SSS1.Px1.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p6.3.m3.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p6.3.m3.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p6.3.m3.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.2">𝑎</ci><apply id="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3.cmml" xref="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3"><times id="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3.1.cmml" xref="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3.1"></times><ci id="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3.2.cmml" xref="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3.2">𝑃</ci><ci id="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3.3.cmml" xref="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3.3">𝑆</ci><ci id="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3.4.cmml" xref="S3.SS3.SSS1.Px1.p6.3.m3.1.1.2.3.4">𝑈</ci></apply></apply><ci id="S3.SS3.SSS1.Px1.p6.3.m3.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p6.3.m3.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p6.3.m3.1c">a^{PSU}_{h}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p6.3.m3.1d">italic_a start_POSTSUPERSCRIPT italic_P italic_S italic_U end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> is calculated as inner product of d-dimensional vector query and keys
multiplied by a scaling factor <math alttext="\frac{1}{\sqrt{d}}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p6.4.m4.1"><semantics id="S3.SS3.SSS1.Px1.p6.4.m4.1a"><mfrac id="S3.SS3.SSS1.Px1.p6.4.m4.1.1" xref="S3.SS3.SSS1.Px1.p6.4.m4.1.1.cmml"><mn id="S3.SS3.SSS1.Px1.p6.4.m4.1.1.2" xref="S3.SS3.SSS1.Px1.p6.4.m4.1.1.2.cmml">1</mn><msqrt id="S3.SS3.SSS1.Px1.p6.4.m4.1.1.3" xref="S3.SS3.SSS1.Px1.p6.4.m4.1.1.3.cmml"><mi id="S3.SS3.SSS1.Px1.p6.4.m4.1.1.3.2" xref="S3.SS3.SSS1.Px1.p6.4.m4.1.1.3.2.cmml">d</mi></msqrt></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p6.4.m4.1b"><apply id="S3.SS3.SSS1.Px1.p6.4.m4.1.1.cmml" xref="S3.SS3.SSS1.Px1.p6.4.m4.1.1"><divide id="S3.SS3.SSS1.Px1.p6.4.m4.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p6.4.m4.1.1"></divide><cn id="S3.SS3.SSS1.Px1.p6.4.m4.1.1.2.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p6.4.m4.1.1.2">1</cn><apply id="S3.SS3.SSS1.Px1.p6.4.m4.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p6.4.m4.1.1.3"><root id="S3.SS3.SSS1.Px1.p6.4.m4.1.1.3a.cmml" xref="S3.SS3.SSS1.Px1.p6.4.m4.1.1.3"></root><ci id="S3.SS3.SSS1.Px1.p6.4.m4.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px1.p6.4.m4.1.1.3.2">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p6.4.m4.1c">\frac{1}{\sqrt{d}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p6.4.m4.1d">divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.Px1.p7">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\alpha_{h}^{PSU}=\frac{(q_{t}W^{PSU_{Q}}_{h})(K^{PSU}W^{PSU_{K}}_{h})^{T}}{%
\sqrt{d}}" class="ltx_Math" display="block" id="S3.Ex2.m1.2"><semantics id="S3.Ex2.m1.2a"><mrow id="S3.Ex2.m1.2.3" xref="S3.Ex2.m1.2.3.cmml"><msubsup id="S3.Ex2.m1.2.3.2" xref="S3.Ex2.m1.2.3.2.cmml"><mi id="S3.Ex2.m1.2.3.2.2.2" xref="S3.Ex2.m1.2.3.2.2.2.cmml">α</mi><mi id="S3.Ex2.m1.2.3.2.2.3" xref="S3.Ex2.m1.2.3.2.2.3.cmml">h</mi><mrow id="S3.Ex2.m1.2.3.2.3" xref="S3.Ex2.m1.2.3.2.3.cmml"><mi id="S3.Ex2.m1.2.3.2.3.2" xref="S3.Ex2.m1.2.3.2.3.2.cmml">P</mi><mo id="S3.Ex2.m1.2.3.2.3.1" xref="S3.Ex2.m1.2.3.2.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.2.3.2.3.3" xref="S3.Ex2.m1.2.3.2.3.3.cmml">S</mi><mo id="S3.Ex2.m1.2.3.2.3.1a" xref="S3.Ex2.m1.2.3.2.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.2.3.2.3.4" xref="S3.Ex2.m1.2.3.2.3.4.cmml">U</mi></mrow></msubsup><mo id="S3.Ex2.m1.2.3.1" xref="S3.Ex2.m1.2.3.1.cmml">=</mo><mfrac id="S3.Ex2.m1.2.2" xref="S3.Ex2.m1.2.2.cmml"><mrow id="S3.Ex2.m1.2.2.2" xref="S3.Ex2.m1.2.2.2.cmml"><mrow id="S3.Ex2.m1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.1.cmml"><mo id="S3.Ex2.m1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.1.cmml"><msub id="S3.Ex2.m1.1.1.1.1.1.1.2" xref="S3.Ex2.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex2.m1.1.1.1.1.1.1.2.2" xref="S3.Ex2.m1.1.1.1.1.1.1.2.2.cmml">q</mi><mi id="S3.Ex2.m1.1.1.1.1.1.1.2.3" xref="S3.Ex2.m1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.Ex2.m1.1.1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S3.Ex2.m1.1.1.1.1.1.1.3" xref="S3.Ex2.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex2.m1.1.1.1.1.1.1.3.2.2" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2.2.cmml">W</mi><mi id="S3.Ex2.m1.1.1.1.1.1.1.3.3" xref="S3.Ex2.m1.1.1.1.1.1.1.3.3.cmml">h</mi><mrow id="S3.Ex2.m1.1.1.1.1.1.1.3.2.3" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.2" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.2.cmml">P</mi><mo id="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.1" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.3" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.3.cmml">S</mi><mo id="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.1a" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><msub id="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.4" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.4.cmml"><mi id="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.4.2" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.4.2.cmml">U</mi><mi id="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.4.3" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.4.3.cmml">Q</mi></msub></mrow></msubsup></mrow><mo id="S3.Ex2.m1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex2.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex2.m1.2.2.2.3" xref="S3.Ex2.m1.2.2.2.3.cmml">⁢</mo><msup id="S3.Ex2.m1.2.2.2.2" xref="S3.Ex2.m1.2.2.2.2.cmml"><mrow id="S3.Ex2.m1.2.2.2.2.1.1" xref="S3.Ex2.m1.2.2.2.2.1.1.1.cmml"><mo id="S3.Ex2.m1.2.2.2.2.1.1.2" stretchy="false" xref="S3.Ex2.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.2.2.2.2.1.1.1" xref="S3.Ex2.m1.2.2.2.2.1.1.1.cmml"><msup id="S3.Ex2.m1.2.2.2.2.1.1.1.2" xref="S3.Ex2.m1.2.2.2.2.1.1.1.2.cmml"><mi id="S3.Ex2.m1.2.2.2.2.1.1.1.2.2" xref="S3.Ex2.m1.2.2.2.2.1.1.1.2.2.cmml">K</mi><mrow id="S3.Ex2.m1.2.2.2.2.1.1.1.2.3" xref="S3.Ex2.m1.2.2.2.2.1.1.1.2.3.cmml"><mi id="S3.Ex2.m1.2.2.2.2.1.1.1.2.3.2" xref="S3.Ex2.m1.2.2.2.2.1.1.1.2.3.2.cmml">P</mi><mo id="S3.Ex2.m1.2.2.2.2.1.1.1.2.3.1" xref="S3.Ex2.m1.2.2.2.2.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.2.2.2.2.1.1.1.2.3.3" xref="S3.Ex2.m1.2.2.2.2.1.1.1.2.3.3.cmml">S</mi><mo id="S3.Ex2.m1.2.2.2.2.1.1.1.2.3.1a" xref="S3.Ex2.m1.2.2.2.2.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.2.2.2.2.1.1.1.2.3.4" xref="S3.Ex2.m1.2.2.2.2.1.1.1.2.3.4.cmml">U</mi></mrow></msup><mo id="S3.Ex2.m1.2.2.2.2.1.1.1.1" xref="S3.Ex2.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><msubsup id="S3.Ex2.m1.2.2.2.2.1.1.1.3" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.cmml"><mi id="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.2" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.2.cmml">W</mi><mi id="S3.Ex2.m1.2.2.2.2.1.1.1.3.3" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.3.cmml">h</mi><mrow id="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.cmml"><mi id="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.2" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.2.cmml">P</mi><mo id="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.1" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.3" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.3.cmml">S</mi><mo id="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.1a" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.1.cmml">⁢</mo><msub id="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.4" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.4.cmml"><mi id="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.4.2" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.4.2.cmml">U</mi><mi id="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.4.3" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.4.3.cmml">K</mi></msub></mrow></msubsup></mrow><mo id="S3.Ex2.m1.2.2.2.2.1.1.3" stretchy="false" xref="S3.Ex2.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S3.Ex2.m1.2.2.2.2.3" xref="S3.Ex2.m1.2.2.2.2.3.cmml">T</mi></msup></mrow><msqrt id="S3.Ex2.m1.2.2.4" xref="S3.Ex2.m1.2.2.4.cmml"><mi id="S3.Ex2.m1.2.2.4.2" xref="S3.Ex2.m1.2.2.4.2.cmml">d</mi></msqrt></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.2b"><apply id="S3.Ex2.m1.2.3.cmml" xref="S3.Ex2.m1.2.3"><eq id="S3.Ex2.m1.2.3.1.cmml" xref="S3.Ex2.m1.2.3.1"></eq><apply id="S3.Ex2.m1.2.3.2.cmml" xref="S3.Ex2.m1.2.3.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.3.2.1.cmml" xref="S3.Ex2.m1.2.3.2">superscript</csymbol><apply id="S3.Ex2.m1.2.3.2.2.cmml" xref="S3.Ex2.m1.2.3.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.3.2.2.1.cmml" xref="S3.Ex2.m1.2.3.2">subscript</csymbol><ci id="S3.Ex2.m1.2.3.2.2.2.cmml" xref="S3.Ex2.m1.2.3.2.2.2">𝛼</ci><ci id="S3.Ex2.m1.2.3.2.2.3.cmml" xref="S3.Ex2.m1.2.3.2.2.3">ℎ</ci></apply><apply id="S3.Ex2.m1.2.3.2.3.cmml" xref="S3.Ex2.m1.2.3.2.3"><times id="S3.Ex2.m1.2.3.2.3.1.cmml" xref="S3.Ex2.m1.2.3.2.3.1"></times><ci id="S3.Ex2.m1.2.3.2.3.2.cmml" xref="S3.Ex2.m1.2.3.2.3.2">𝑃</ci><ci id="S3.Ex2.m1.2.3.2.3.3.cmml" xref="S3.Ex2.m1.2.3.2.3.3">𝑆</ci><ci id="S3.Ex2.m1.2.3.2.3.4.cmml" xref="S3.Ex2.m1.2.3.2.3.4">𝑈</ci></apply></apply><apply id="S3.Ex2.m1.2.2.cmml" xref="S3.Ex2.m1.2.2"><divide id="S3.Ex2.m1.2.2.3.cmml" xref="S3.Ex2.m1.2.2"></divide><apply id="S3.Ex2.m1.2.2.2.cmml" xref="S3.Ex2.m1.2.2.2"><times id="S3.Ex2.m1.2.2.2.3.cmml" xref="S3.Ex2.m1.2.2.2.3"></times><apply id="S3.Ex2.m1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1"><times id="S3.Ex2.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1"></times><apply id="S3.Ex2.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.2.2">𝑞</ci><ci id="S3.Ex2.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.Ex2.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.Ex2.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2.2">𝑊</ci><apply id="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2.3"><times id="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.1"></times><ci id="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.2">𝑃</ci><ci id="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.3">𝑆</ci><apply id="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.4.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.4"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.4.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.4">subscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.4.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.4.2">𝑈</ci><ci id="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.4.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2.3.4.3">𝑄</ci></apply></apply></apply><ci id="S3.Ex2.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3.3">ℎ</ci></apply></apply><apply id="S3.Ex2.m1.2.2.2.2.cmml" xref="S3.Ex2.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.2.2.2.cmml" xref="S3.Ex2.m1.2.2.2.2">superscript</csymbol><apply id="S3.Ex2.m1.2.2.2.2.1.1.1.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1"><times id="S3.Ex2.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.1"></times><apply id="S3.Ex2.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.2.2.1.1.1.2.1.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.2">superscript</csymbol><ci id="S3.Ex2.m1.2.2.2.2.1.1.1.2.2.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.2.2">𝐾</ci><apply id="S3.Ex2.m1.2.2.2.2.1.1.1.2.3.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.2.3"><times id="S3.Ex2.m1.2.2.2.2.1.1.1.2.3.1.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.2.3.1"></times><ci id="S3.Ex2.m1.2.2.2.2.1.1.1.2.3.2.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.2.3.2">𝑃</ci><ci id="S3.Ex2.m1.2.2.2.2.1.1.1.2.3.3.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.2.3.3">𝑆</ci><ci id="S3.Ex2.m1.2.2.2.2.1.1.1.2.3.4.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.2.3.4">𝑈</ci></apply></apply><apply id="S3.Ex2.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3">subscript</csymbol><apply id="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.1.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3">superscript</csymbol><ci id="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.2.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.2">𝑊</ci><apply id="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3"><times id="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.1.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.1"></times><ci id="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.2.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.2">𝑃</ci><ci id="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.3.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.3">𝑆</ci><apply id="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.4.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.4"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.4.1.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.4">subscript</csymbol><ci id="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.4.2.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.4.2">𝑈</ci><ci id="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.4.3.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.2.3.4.3">𝐾</ci></apply></apply></apply><ci id="S3.Ex2.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.1.3.3">ℎ</ci></apply></apply><ci id="S3.Ex2.m1.2.2.2.2.3.cmml" xref="S3.Ex2.m1.2.2.2.2.3">𝑇</ci></apply></apply><apply id="S3.Ex2.m1.2.2.4.cmml" xref="S3.Ex2.m1.2.2.4"><root id="S3.Ex2.m1.2.2.4a.cmml" xref="S3.Ex2.m1.2.2.4"></root><ci id="S3.Ex2.m1.2.2.4.2.cmml" xref="S3.Ex2.m1.2.2.4.2">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.2c">\alpha_{h}^{PSU}=\frac{(q_{t}W^{PSU_{Q}}_{h})(K^{PSU}W^{PSU_{K}}_{h})^{T}}{%
\sqrt{d}}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m1.2d">italic_α start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P italic_S italic_U end_POSTSUPERSCRIPT = divide start_ARG ( italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_W start_POSTSUPERSCRIPT italic_P italic_S italic_U start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) ( italic_K start_POSTSUPERSCRIPT italic_P italic_S italic_U end_POSTSUPERSCRIPT italic_W start_POSTSUPERSCRIPT italic_P italic_S italic_U start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.Px1.p8">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="=[\sum_{i}\sum_{j}\gamma_{ij}(\mathbb{\hat{x}}^{PSU(i)}_{t}W^{PSU_{Q}}_{h})({%
\mathbb{\hat{x}}^{PSU(j)}_{l}}W^{PSU_{K}}_{h})^{T}]^{L}_{l=1}" class="ltx_Math" display="block" id="S3.Ex3.m1.3"><semantics id="S3.Ex3.m1.3a"><mrow id="S3.Ex3.m1.3.3" xref="S3.Ex3.m1.3.3.cmml"><mi id="S3.Ex3.m1.3.3.3" xref="S3.Ex3.m1.3.3.3.cmml"></mi><mo id="S3.Ex3.m1.3.3.2" xref="S3.Ex3.m1.3.3.2.cmml">=</mo><msubsup id="S3.Ex3.m1.3.3.1" xref="S3.Ex3.m1.3.3.1.cmml"><mrow id="S3.Ex3.m1.3.3.1.1.1.1" xref="S3.Ex3.m1.3.3.1.1.1.2.cmml"><mo id="S3.Ex3.m1.3.3.1.1.1.1.2" stretchy="false" xref="S3.Ex3.m1.3.3.1.1.1.2.1.cmml">[</mo><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.cmml"><munder id="S3.Ex3.m1.3.3.1.1.1.1.1.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.3.cmml"><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.3.2" lspace="0em" movablelimits="false" rspace="0em" xref="S3.Ex3.m1.3.3.1.1.1.1.1.3.2.cmml">∑</mo><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.3.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.3.3.cmml">i</mi></munder><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.cmml"><munder id="S3.Ex3.m1.3.3.1.1.1.1.1.2.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.3.cmml"><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.2.3.2" movablelimits="false" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.3.2.cmml">∑</mo><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.2.3.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.3.3.cmml">j</mi></munder><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.cmml"><msub id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.cmml"><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.2.cmml">γ</mi><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.3.cmml"><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.3.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.3.2.cmml">i</mi><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.3.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.3.1.cmml">⁢</mo><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.3.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.3.3.cmml">j</mi></mrow></msub><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝕩</mi><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mrow id="S3.Ex3.m1.1.1.1" xref="S3.Ex3.m1.1.1.1.cmml"><mi id="S3.Ex3.m1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.3.cmml">P</mi><mo id="S3.Ex3.m1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.1.4" xref="S3.Ex3.m1.1.1.1.4.cmml">S</mi><mo id="S3.Ex3.m1.1.1.1.2a" xref="S3.Ex3.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.1.5" xref="S3.Ex3.m1.1.1.1.5.cmml">U</mi><mo id="S3.Ex3.m1.1.1.1.2b" xref="S3.Ex3.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex3.m1.1.1.1.6.2" xref="S3.Ex3.m1.1.1.1.cmml"><mo id="S3.Ex3.m1.1.1.1.6.2.1" stretchy="false" xref="S3.Ex3.m1.1.1.1.cmml">(</mo><mi id="S3.Ex3.m1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.cmml">i</mi><mo id="S3.Ex3.m1.1.1.1.6.2.2" stretchy="false" xref="S3.Ex3.m1.1.1.1.cmml">)</mo></mrow></mrow></msubsup><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">W</mi><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml">h</mi><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml">P</mi><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml">S</mi><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.1a" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><msub id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.4" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.4.cmml"><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.4.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.4.2.cmml">U</mi><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.4.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.4.3.cmml">Q</mi></msub></mrow></msubsup></mrow><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.3a" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.3.cmml">⁢</mo><msup id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.cmml"><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.cmml"><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.2" stretchy="false" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.cmml"><msubsup id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.cmml"><mover accent="true" id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.2.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.2.2.cmml"><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.2.2.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.2.2.2.cmml">𝕩</mi><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.2.2.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.3.cmml">l</mi><mrow id="S3.Ex3.m1.2.2.1" xref="S3.Ex3.m1.2.2.1.cmml"><mi id="S3.Ex3.m1.2.2.1.3" xref="S3.Ex3.m1.2.2.1.3.cmml">P</mi><mo id="S3.Ex3.m1.2.2.1.2" xref="S3.Ex3.m1.2.2.1.2.cmml">⁢</mo><mi id="S3.Ex3.m1.2.2.1.4" xref="S3.Ex3.m1.2.2.1.4.cmml">S</mi><mo id="S3.Ex3.m1.2.2.1.2a" xref="S3.Ex3.m1.2.2.1.2.cmml">⁢</mo><mi id="S3.Ex3.m1.2.2.1.5" xref="S3.Ex3.m1.2.2.1.5.cmml">U</mi><mo id="S3.Ex3.m1.2.2.1.2b" xref="S3.Ex3.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.Ex3.m1.2.2.1.6.2" xref="S3.Ex3.m1.2.2.1.cmml"><mo id="S3.Ex3.m1.2.2.1.6.2.1" stretchy="false" xref="S3.Ex3.m1.2.2.1.cmml">(</mo><mi id="S3.Ex3.m1.2.2.1.1" xref="S3.Ex3.m1.2.2.1.1.cmml">j</mi><mo id="S3.Ex3.m1.2.2.1.6.2.2" stretchy="false" xref="S3.Ex3.m1.2.2.1.cmml">)</mo></mrow></mrow></msubsup><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.1.cmml">⁢</mo><msubsup id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.cmml"><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.2.cmml">W</mi><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.3.cmml">h</mi><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.cmml"><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.2.cmml">P</mi><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.3.cmml">S</mi><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.1a" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.1.cmml">⁢</mo><msub id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.4" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.4.cmml"><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.4.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.4.2.cmml">U</mi><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.4.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.4.3.cmml">K</mi></msub></mrow></msubsup></mrow><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.3" stretchy="false" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.3.cmml">T</mi></msup></mrow></mrow></mrow><mo id="S3.Ex3.m1.3.3.1.1.1.1.3" stretchy="false" xref="S3.Ex3.m1.3.3.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.Ex3.m1.3.3.1.3" xref="S3.Ex3.m1.3.3.1.3.cmml"><mi id="S3.Ex3.m1.3.3.1.3.2" xref="S3.Ex3.m1.3.3.1.3.2.cmml">l</mi><mo id="S3.Ex3.m1.3.3.1.3.1" xref="S3.Ex3.m1.3.3.1.3.1.cmml">=</mo><mn id="S3.Ex3.m1.3.3.1.3.3" xref="S3.Ex3.m1.3.3.1.3.3.cmml">1</mn></mrow><mi id="S3.Ex3.m1.3.3.1.1.3" xref="S3.Ex3.m1.3.3.1.1.3.cmml">L</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.3b"><apply id="S3.Ex3.m1.3.3.cmml" xref="S3.Ex3.m1.3.3"><eq id="S3.Ex3.m1.3.3.2.cmml" xref="S3.Ex3.m1.3.3.2"></eq><csymbol cd="latexml" id="S3.Ex3.m1.3.3.3.cmml" xref="S3.Ex3.m1.3.3.3">absent</csymbol><apply id="S3.Ex3.m1.3.3.1.cmml" xref="S3.Ex3.m1.3.3.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.2.cmml" xref="S3.Ex3.m1.3.3.1">subscript</csymbol><apply id="S3.Ex3.m1.3.3.1.1.cmml" xref="S3.Ex3.m1.3.3.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.2.cmml" xref="S3.Ex3.m1.3.3.1">superscript</csymbol><apply id="S3.Ex3.m1.3.3.1.1.1.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S3.Ex3.m1.3.3.1.1.1.2.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1"><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.3">subscript</csymbol><sum id="S3.Ex3.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.3.2"></sum><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2"><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.3">subscript</csymbol><sum id="S3.Ex3.m1.3.3.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.3.2"></sum><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.3.3">𝑗</ci></apply><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2"><times id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.3"></times><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4">subscript</csymbol><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.2">𝛾</ci><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.3"><times id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.3.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.3.1"></times><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.3.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.3.2">𝑖</ci><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.3.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.4.3.3">𝑗</ci></apply></apply><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1"><times id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2"><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝕩</ci></apply><apply id="S3.Ex3.m1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1"><times id="S3.Ex3.m1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.2"></times><ci id="S3.Ex3.m1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.3">𝑃</ci><ci id="S3.Ex3.m1.1.1.1.4.cmml" xref="S3.Ex3.m1.1.1.1.4">𝑆</ci><ci id="S3.Ex3.m1.1.1.1.5.cmml" xref="S3.Ex3.m1.1.1.1.5">𝑈</ci><ci id="S3.Ex3.m1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1">𝑖</ci></apply></apply><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑊</ci><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3"><times id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.1"></times><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.2">𝑃</ci><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.3">𝑆</ci><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.4.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.4"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.4.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.4">subscript</csymbol><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.4.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.4.2">𝑈</ci><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.4.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.4.3">𝑄</ci></apply></apply></apply><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3">ℎ</ci></apply></apply><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1"><times id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.1"></times><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2">subscript</csymbol><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.2.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2">superscript</csymbol><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.2.2"><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.2.2.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.2.2.1">^</ci><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.2.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.2.2.2">𝕩</ci></apply><apply id="S3.Ex3.m1.2.2.1.cmml" xref="S3.Ex3.m1.2.2.1"><times id="S3.Ex3.m1.2.2.1.2.cmml" xref="S3.Ex3.m1.2.2.1.2"></times><ci id="S3.Ex3.m1.2.2.1.3.cmml" xref="S3.Ex3.m1.2.2.1.3">𝑃</ci><ci id="S3.Ex3.m1.2.2.1.4.cmml" xref="S3.Ex3.m1.2.2.1.4">𝑆</ci><ci id="S3.Ex3.m1.2.2.1.5.cmml" xref="S3.Ex3.m1.2.2.1.5">𝑈</ci><ci id="S3.Ex3.m1.2.2.1.1.cmml" xref="S3.Ex3.m1.2.2.1.1">𝑗</ci></apply></apply><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.2.3">𝑙</ci></apply><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3">subscript</csymbol><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3">superscript</csymbol><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.2">𝑊</ci><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3"><times id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.1"></times><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.2">𝑃</ci><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.3">𝑆</ci><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.4.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.4"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.4.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.4">subscript</csymbol><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.4.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.4.2">𝑈</ci><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.4.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.2.3.4.3">𝐾</ci></apply></apply></apply><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.1.1.1.3.3">ℎ</ci></apply></apply><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.2.2.2.3">𝑇</ci></apply></apply></apply></apply></apply><ci id="S3.Ex3.m1.3.3.1.1.3.cmml" xref="S3.Ex3.m1.3.3.1.1.3">𝐿</ci></apply><apply id="S3.Ex3.m1.3.3.1.3.cmml" xref="S3.Ex3.m1.3.3.1.3"><eq id="S3.Ex3.m1.3.3.1.3.1.cmml" xref="S3.Ex3.m1.3.3.1.3.1"></eq><ci id="S3.Ex3.m1.3.3.1.3.2.cmml" xref="S3.Ex3.m1.3.3.1.3.2">𝑙</ci><cn id="S3.Ex3.m1.3.3.1.3.3.cmml" type="integer" xref="S3.Ex3.m1.3.3.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.3c">=[\sum_{i}\sum_{j}\gamma_{ij}(\mathbb{\hat{x}}^{PSU(i)}_{t}W^{PSU_{Q}}_{h})({%
\mathbb{\hat{x}}^{PSU(j)}_{l}}W^{PSU_{K}}_{h})^{T}]^{L}_{l=1}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3.m1.3d">= [ ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_γ start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ( over^ start_ARG blackboard_x end_ARG start_POSTSUPERSCRIPT italic_P italic_S italic_U ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_W start_POSTSUPERSCRIPT italic_P italic_S italic_U start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) ( over^ start_ARG blackboard_x end_ARG start_POSTSUPERSCRIPT italic_P italic_S italic_U ( italic_j ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT italic_W start_POSTSUPERSCRIPT italic_P italic_S italic_U start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ] start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.Px1.p9">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\gamma_{ij}=\gamma_{i}\gamma_{j}|\mathbb{x}^{PSU(i)}_{t}||\mathbb{x}^{PSU(j)}_%
{l}|" class="ltx_Math" display="block" id="S3.Ex4.m1.4"><semantics id="S3.Ex4.m1.4a"><mrow id="S3.Ex4.m1.4.4" xref="S3.Ex4.m1.4.4.cmml"><msub id="S3.Ex4.m1.4.4.4" xref="S3.Ex4.m1.4.4.4.cmml"><mi id="S3.Ex4.m1.4.4.4.2" xref="S3.Ex4.m1.4.4.4.2.cmml">γ</mi><mrow id="S3.Ex4.m1.4.4.4.3" xref="S3.Ex4.m1.4.4.4.3.cmml"><mi id="S3.Ex4.m1.4.4.4.3.2" xref="S3.Ex4.m1.4.4.4.3.2.cmml">i</mi><mo id="S3.Ex4.m1.4.4.4.3.1" xref="S3.Ex4.m1.4.4.4.3.1.cmml">⁢</mo><mi id="S3.Ex4.m1.4.4.4.3.3" xref="S3.Ex4.m1.4.4.4.3.3.cmml">j</mi></mrow></msub><mo id="S3.Ex4.m1.4.4.3" xref="S3.Ex4.m1.4.4.3.cmml">=</mo><mrow id="S3.Ex4.m1.4.4.2" xref="S3.Ex4.m1.4.4.2.cmml"><msub id="S3.Ex4.m1.4.4.2.4" xref="S3.Ex4.m1.4.4.2.4.cmml"><mi id="S3.Ex4.m1.4.4.2.4.2" xref="S3.Ex4.m1.4.4.2.4.2.cmml">γ</mi><mi id="S3.Ex4.m1.4.4.2.4.3" xref="S3.Ex4.m1.4.4.2.4.3.cmml">i</mi></msub><mo id="S3.Ex4.m1.4.4.2.3" xref="S3.Ex4.m1.4.4.2.3.cmml">⁢</mo><msub id="S3.Ex4.m1.4.4.2.5" xref="S3.Ex4.m1.4.4.2.5.cmml"><mi id="S3.Ex4.m1.4.4.2.5.2" xref="S3.Ex4.m1.4.4.2.5.2.cmml">γ</mi><mi id="S3.Ex4.m1.4.4.2.5.3" xref="S3.Ex4.m1.4.4.2.5.3.cmml">j</mi></msub><mo id="S3.Ex4.m1.4.4.2.3a" xref="S3.Ex4.m1.4.4.2.3.cmml">⁢</mo><mrow id="S3.Ex4.m1.3.3.1.1.1" xref="S3.Ex4.m1.3.3.1.1.2.cmml"><mo id="S3.Ex4.m1.3.3.1.1.1.2" stretchy="false" xref="S3.Ex4.m1.3.3.1.1.2.1.cmml">|</mo><msubsup id="S3.Ex4.m1.3.3.1.1.1.1" xref="S3.Ex4.m1.3.3.1.1.1.1.cmml"><mi id="S3.Ex4.m1.3.3.1.1.1.1.2.2" xref="S3.Ex4.m1.3.3.1.1.1.1.2.2.cmml">𝕩</mi><mi id="S3.Ex4.m1.3.3.1.1.1.1.3" xref="S3.Ex4.m1.3.3.1.1.1.1.3.cmml">t</mi><mrow id="S3.Ex4.m1.1.1.1" xref="S3.Ex4.m1.1.1.1.cmml"><mi id="S3.Ex4.m1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.3.cmml">P</mi><mo id="S3.Ex4.m1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex4.m1.1.1.1.4" xref="S3.Ex4.m1.1.1.1.4.cmml">S</mi><mo id="S3.Ex4.m1.1.1.1.2a" xref="S3.Ex4.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex4.m1.1.1.1.5" xref="S3.Ex4.m1.1.1.1.5.cmml">U</mi><mo id="S3.Ex4.m1.1.1.1.2b" xref="S3.Ex4.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex4.m1.1.1.1.6.2" xref="S3.Ex4.m1.1.1.1.cmml"><mo id="S3.Ex4.m1.1.1.1.6.2.1" stretchy="false" xref="S3.Ex4.m1.1.1.1.cmml">(</mo><mi id="S3.Ex4.m1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.cmml">i</mi><mo id="S3.Ex4.m1.1.1.1.6.2.2" stretchy="false" xref="S3.Ex4.m1.1.1.1.cmml">)</mo></mrow></mrow></msubsup><mo id="S3.Ex4.m1.3.3.1.1.1.3" stretchy="false" xref="S3.Ex4.m1.3.3.1.1.2.1.cmml">|</mo></mrow><mo id="S3.Ex4.m1.4.4.2.3b" xref="S3.Ex4.m1.4.4.2.3.cmml">⁢</mo><mrow id="S3.Ex4.m1.4.4.2.2.1" xref="S3.Ex4.m1.4.4.2.2.2.cmml"><mo id="S3.Ex4.m1.4.4.2.2.1.2" stretchy="false" xref="S3.Ex4.m1.4.4.2.2.2.1.cmml">|</mo><msubsup id="S3.Ex4.m1.4.4.2.2.1.1" xref="S3.Ex4.m1.4.4.2.2.1.1.cmml"><mi id="S3.Ex4.m1.4.4.2.2.1.1.2.2" xref="S3.Ex4.m1.4.4.2.2.1.1.2.2.cmml">𝕩</mi><mi id="S3.Ex4.m1.4.4.2.2.1.1.3" xref="S3.Ex4.m1.4.4.2.2.1.1.3.cmml">l</mi><mrow id="S3.Ex4.m1.2.2.1" xref="S3.Ex4.m1.2.2.1.cmml"><mi id="S3.Ex4.m1.2.2.1.3" xref="S3.Ex4.m1.2.2.1.3.cmml">P</mi><mo id="S3.Ex4.m1.2.2.1.2" xref="S3.Ex4.m1.2.2.1.2.cmml">⁢</mo><mi id="S3.Ex4.m1.2.2.1.4" xref="S3.Ex4.m1.2.2.1.4.cmml">S</mi><mo id="S3.Ex4.m1.2.2.1.2a" xref="S3.Ex4.m1.2.2.1.2.cmml">⁢</mo><mi id="S3.Ex4.m1.2.2.1.5" xref="S3.Ex4.m1.2.2.1.5.cmml">U</mi><mo id="S3.Ex4.m1.2.2.1.2b" xref="S3.Ex4.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.Ex4.m1.2.2.1.6.2" xref="S3.Ex4.m1.2.2.1.cmml"><mo id="S3.Ex4.m1.2.2.1.6.2.1" stretchy="false" xref="S3.Ex4.m1.2.2.1.cmml">(</mo><mi id="S3.Ex4.m1.2.2.1.1" xref="S3.Ex4.m1.2.2.1.1.cmml">j</mi><mo id="S3.Ex4.m1.2.2.1.6.2.2" stretchy="false" xref="S3.Ex4.m1.2.2.1.cmml">)</mo></mrow></mrow></msubsup><mo id="S3.Ex4.m1.4.4.2.2.1.3" stretchy="false" xref="S3.Ex4.m1.4.4.2.2.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4.m1.4b"><apply id="S3.Ex4.m1.4.4.cmml" xref="S3.Ex4.m1.4.4"><eq id="S3.Ex4.m1.4.4.3.cmml" xref="S3.Ex4.m1.4.4.3"></eq><apply id="S3.Ex4.m1.4.4.4.cmml" xref="S3.Ex4.m1.4.4.4"><csymbol cd="ambiguous" id="S3.Ex4.m1.4.4.4.1.cmml" xref="S3.Ex4.m1.4.4.4">subscript</csymbol><ci id="S3.Ex4.m1.4.4.4.2.cmml" xref="S3.Ex4.m1.4.4.4.2">𝛾</ci><apply id="S3.Ex4.m1.4.4.4.3.cmml" xref="S3.Ex4.m1.4.4.4.3"><times id="S3.Ex4.m1.4.4.4.3.1.cmml" xref="S3.Ex4.m1.4.4.4.3.1"></times><ci id="S3.Ex4.m1.4.4.4.3.2.cmml" xref="S3.Ex4.m1.4.4.4.3.2">𝑖</ci><ci id="S3.Ex4.m1.4.4.4.3.3.cmml" xref="S3.Ex4.m1.4.4.4.3.3">𝑗</ci></apply></apply><apply id="S3.Ex4.m1.4.4.2.cmml" xref="S3.Ex4.m1.4.4.2"><times id="S3.Ex4.m1.4.4.2.3.cmml" xref="S3.Ex4.m1.4.4.2.3"></times><apply id="S3.Ex4.m1.4.4.2.4.cmml" xref="S3.Ex4.m1.4.4.2.4"><csymbol cd="ambiguous" id="S3.Ex4.m1.4.4.2.4.1.cmml" xref="S3.Ex4.m1.4.4.2.4">subscript</csymbol><ci id="S3.Ex4.m1.4.4.2.4.2.cmml" xref="S3.Ex4.m1.4.4.2.4.2">𝛾</ci><ci id="S3.Ex4.m1.4.4.2.4.3.cmml" xref="S3.Ex4.m1.4.4.2.4.3">𝑖</ci></apply><apply id="S3.Ex4.m1.4.4.2.5.cmml" xref="S3.Ex4.m1.4.4.2.5"><csymbol cd="ambiguous" id="S3.Ex4.m1.4.4.2.5.1.cmml" xref="S3.Ex4.m1.4.4.2.5">subscript</csymbol><ci id="S3.Ex4.m1.4.4.2.5.2.cmml" xref="S3.Ex4.m1.4.4.2.5.2">𝛾</ci><ci id="S3.Ex4.m1.4.4.2.5.3.cmml" xref="S3.Ex4.m1.4.4.2.5.3">𝑗</ci></apply><apply id="S3.Ex4.m1.3.3.1.1.2.cmml" xref="S3.Ex4.m1.3.3.1.1.1"><abs id="S3.Ex4.m1.3.3.1.1.2.1.cmml" xref="S3.Ex4.m1.3.3.1.1.1.2"></abs><apply id="S3.Ex4.m1.3.3.1.1.1.1.cmml" xref="S3.Ex4.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex4.m1.3.3.1.1.1.1.1.cmml" xref="S3.Ex4.m1.3.3.1.1.1.1">subscript</csymbol><apply id="S3.Ex4.m1.3.3.1.1.1.1.2.cmml" xref="S3.Ex4.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex4.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.Ex4.m1.3.3.1.1.1.1">superscript</csymbol><ci id="S3.Ex4.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.Ex4.m1.3.3.1.1.1.1.2.2">𝕩</ci><apply id="S3.Ex4.m1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1"><times id="S3.Ex4.m1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.2"></times><ci id="S3.Ex4.m1.1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.1.3">𝑃</ci><ci id="S3.Ex4.m1.1.1.1.4.cmml" xref="S3.Ex4.m1.1.1.1.4">𝑆</ci><ci id="S3.Ex4.m1.1.1.1.5.cmml" xref="S3.Ex4.m1.1.1.1.5">𝑈</ci><ci id="S3.Ex4.m1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1">𝑖</ci></apply></apply><ci id="S3.Ex4.m1.3.3.1.1.1.1.3.cmml" xref="S3.Ex4.m1.3.3.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.Ex4.m1.4.4.2.2.2.cmml" xref="S3.Ex4.m1.4.4.2.2.1"><abs id="S3.Ex4.m1.4.4.2.2.2.1.cmml" xref="S3.Ex4.m1.4.4.2.2.1.2"></abs><apply id="S3.Ex4.m1.4.4.2.2.1.1.cmml" xref="S3.Ex4.m1.4.4.2.2.1.1"><csymbol cd="ambiguous" id="S3.Ex4.m1.4.4.2.2.1.1.1.cmml" xref="S3.Ex4.m1.4.4.2.2.1.1">subscript</csymbol><apply id="S3.Ex4.m1.4.4.2.2.1.1.2.cmml" xref="S3.Ex4.m1.4.4.2.2.1.1"><csymbol cd="ambiguous" id="S3.Ex4.m1.4.4.2.2.1.1.2.1.cmml" xref="S3.Ex4.m1.4.4.2.2.1.1">superscript</csymbol><ci id="S3.Ex4.m1.4.4.2.2.1.1.2.2.cmml" xref="S3.Ex4.m1.4.4.2.2.1.1.2.2">𝕩</ci><apply id="S3.Ex4.m1.2.2.1.cmml" xref="S3.Ex4.m1.2.2.1"><times id="S3.Ex4.m1.2.2.1.2.cmml" xref="S3.Ex4.m1.2.2.1.2"></times><ci id="S3.Ex4.m1.2.2.1.3.cmml" xref="S3.Ex4.m1.2.2.1.3">𝑃</ci><ci id="S3.Ex4.m1.2.2.1.4.cmml" xref="S3.Ex4.m1.2.2.1.4">𝑆</ci><ci id="S3.Ex4.m1.2.2.1.5.cmml" xref="S3.Ex4.m1.2.2.1.5">𝑈</ci><ci id="S3.Ex4.m1.2.2.1.1.cmml" xref="S3.Ex4.m1.2.2.1.1">𝑗</ci></apply></apply><ci id="S3.Ex4.m1.4.4.2.2.1.1.3.cmml" xref="S3.Ex4.m1.4.4.2.2.1.1.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m1.4c">\gamma_{ij}=\gamma_{i}\gamma_{j}|\mathbb{x}^{PSU(i)}_{t}||\mathbb{x}^{PSU(j)}_%
{l}|</annotation><annotation encoding="application/x-llamapun" id="S3.Ex4.m1.4d">italic_γ start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = italic_γ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_γ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | blackboard_x start_POSTSUPERSCRIPT italic_P italic_S italic_U ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | | blackboard_x start_POSTSUPERSCRIPT italic_P italic_S italic_U ( italic_j ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.Px1.p10">
<p class="ltx_p" id="S3.SS3.SSS1.Px1.p10.12">In this formulation, <math alttext="[\mathbb{x}^{PSU(1:M+1)}_{l}]^{L}_{l=1}\in\mathbb{R}^{L\times(M+1)\times d}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p10.1.m1.4"><semantics id="S3.SS3.SSS1.Px1.p10.1.m1.4a"><mrow id="S3.SS3.SSS1.Px1.p10.1.m1.4.4" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.cmml"><msubsup id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.cmml"><mrow id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.2.cmml"><mo id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.2.1.cmml">[</mo><msubsup id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.1.2.2" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.1.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.1.3" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.1.3.cmml">l</mi><mrow id="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2" xref="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.3.cmml"><mrow id="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1.2" xref="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1.2.cmml">P</mi><mo id="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1.3" xref="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1.3.cmml">S</mi><mo id="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1.1a" xref="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1.4" xref="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1.4.cmml">U</mi></mrow><mo id="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.3" xref="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.3.cmml">⁣</mo><mrow id="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1" xref="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.cmml"><mo id="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1" xref="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.cmml"><mn id="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.2" xref="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.2.cmml">1</mn><mo id="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.1.cmml">:</mo><mrow id="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.3" xref="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.3.cmml"><mi id="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.3.2" xref="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.3.2.cmml">M</mi><mo id="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.3.1" xref="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.3.1.cmml">+</mo><mn id="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.3.3" xref="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.3.3.cmml">1</mn></mrow></mrow><mo id="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.3" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></msubsup><mo id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.3" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.3.cmml"><mi id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.3.2" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.3.2.cmml">l</mi><mo id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.3.1" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.3.1.cmml">=</mo><mn id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.3.3" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.3.3.cmml">1</mn></mrow><mi id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.3" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.3.cmml">L</mi></msubsup><mo id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.2" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.2.cmml">∈</mo><msup id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.3" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.3.cmml"><mi id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.3.2" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1" xref="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.cmml"><mi id="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.3" xref="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.3.cmml">L</mi><mo id="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.2" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.2.cmml">×</mo><mrow id="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1" xref="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1.1" xref="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1.1.2" xref="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1.1.2.cmml">M</mi><mo id="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1.1.1.cmml">+</mo><mn id="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1.1.3" xref="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.2a" rspace="0.222em" xref="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.2.cmml">×</mo><mi id="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.4" xref="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p10.1.m1.4b"><apply id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4"><in id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.2.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.2"></in><apply id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1">superscript</csymbol><apply id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.1.2.2">𝕩</ci><list id="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.3.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2"><apply id="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1"><times id="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1.1"></times><ci id="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1.2">𝑃</ci><ci id="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1.3">𝑆</ci><ci id="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1.4.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.1.1.1.1.1.4">𝑈</ci></apply><apply id="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1"><ci id="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.1">:</ci><cn id="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.2.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.2">1</cn><apply id="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.3"><plus id="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.3.1"></plus><ci id="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.3.2">𝑀</ci><cn id="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.3.3.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p10.1.m1.2.2.2.2.2.1.1.3.3">1</cn></apply></apply></list></apply><ci id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.1.1.1.3">𝑙</ci></apply></apply><ci id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.1.3">𝐿</ci></apply><apply id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.3"><eq id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.3.1.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.3.1"></eq><ci id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.3.2.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.3.2">𝑙</ci><cn id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.3.3.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.1.3.3">1</cn></apply></apply><apply id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.3.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.3.1.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.3">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p10.1.m1.4.4.3.2.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.4.4.3.2">ℝ</ci><apply id="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1"><times id="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.2"></times><ci id="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.3">𝐿</ci><apply id="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1"><plus id="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1.1.1"></plus><ci id="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1.1.2">𝑀</ci><cn id="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.1.1.1.3">1</cn></apply><ci id="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.4.cmml" xref="S3.SS3.SSS1.Px1.p10.1.m1.3.3.1.4">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p10.1.m1.4c">[\mathbb{x}^{PSU(1:M+1)}_{l}]^{L}_{l=1}\in\mathbb{R}^{L\times(M+1)\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p10.1.m1.4d">[ blackboard_x start_POSTSUPERSCRIPT italic_P italic_S italic_U ( 1 : italic_M + 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ] start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_L × ( italic_M + 1 ) × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the multi-modal embedding of items in the sequence of PSU and <math alttext="\mathbb{x}^{PSU(1:M+1)}=[Q,T,I,A]" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p10.2.m2.6"><semantics id="S3.SS3.SSS1.Px1.p10.2.m2.6a"><mrow id="S3.SS3.SSS1.Px1.p10.2.m2.6.7" xref="S3.SS3.SSS1.Px1.p10.2.m2.6.7.cmml"><msup id="S3.SS3.SSS1.Px1.p10.2.m2.6.7.2" xref="S3.SS3.SSS1.Px1.p10.2.m2.6.7.2.cmml"><mi id="S3.SS3.SSS1.Px1.p10.2.m2.6.7.2.2" xref="S3.SS3.SSS1.Px1.p10.2.m2.6.7.2.2.cmml">𝕩</mi><mrow id="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2" xref="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.3.cmml"><mrow id="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1.2" xref="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1.2.cmml">P</mi><mo id="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1.3" xref="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1.3.cmml">S</mi><mo id="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1.1a" xref="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1.4" xref="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1.4.cmml">U</mi></mrow><mo id="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.3" xref="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.3.cmml">⁣</mo><mrow id="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1" xref="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.cmml"><mo id="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1" xref="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.cmml"><mn id="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.2" xref="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.2.cmml">1</mn><mo id="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.1.cmml">:</mo><mrow id="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.3" xref="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.3.cmml"><mi id="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.3.2" xref="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.3.2.cmml">M</mi><mo id="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.3.1" xref="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.3.1.cmml">+</mo><mn id="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.3.3" xref="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.3.3.cmml">1</mn></mrow></mrow><mo id="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.3" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></msup><mo id="S3.SS3.SSS1.Px1.p10.2.m2.6.7.1" xref="S3.SS3.SSS1.Px1.p10.2.m2.6.7.1.cmml">=</mo><mrow id="S3.SS3.SSS1.Px1.p10.2.m2.6.7.3.2" xref="S3.SS3.SSS1.Px1.p10.2.m2.6.7.3.1.cmml"><mo id="S3.SS3.SSS1.Px1.p10.2.m2.6.7.3.2.1" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.2.m2.6.7.3.1.cmml">[</mo><mi id="S3.SS3.SSS1.Px1.p10.2.m2.3.3" xref="S3.SS3.SSS1.Px1.p10.2.m2.3.3.cmml">Q</mi><mo id="S3.SS3.SSS1.Px1.p10.2.m2.6.7.3.2.2" xref="S3.SS3.SSS1.Px1.p10.2.m2.6.7.3.1.cmml">,</mo><mi id="S3.SS3.SSS1.Px1.p10.2.m2.4.4" xref="S3.SS3.SSS1.Px1.p10.2.m2.4.4.cmml">T</mi><mo id="S3.SS3.SSS1.Px1.p10.2.m2.6.7.3.2.3" xref="S3.SS3.SSS1.Px1.p10.2.m2.6.7.3.1.cmml">,</mo><mi id="S3.SS3.SSS1.Px1.p10.2.m2.5.5" xref="S3.SS3.SSS1.Px1.p10.2.m2.5.5.cmml">I</mi><mo id="S3.SS3.SSS1.Px1.p10.2.m2.6.7.3.2.4" xref="S3.SS3.SSS1.Px1.p10.2.m2.6.7.3.1.cmml">,</mo><mi id="S3.SS3.SSS1.Px1.p10.2.m2.6.6" xref="S3.SS3.SSS1.Px1.p10.2.m2.6.6.cmml">A</mi><mo id="S3.SS3.SSS1.Px1.p10.2.m2.6.7.3.2.5" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.2.m2.6.7.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p10.2.m2.6b"><apply id="S3.SS3.SSS1.Px1.p10.2.m2.6.7.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.6.7"><eq id="S3.SS3.SSS1.Px1.p10.2.m2.6.7.1.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.6.7.1"></eq><apply id="S3.SS3.SSS1.Px1.p10.2.m2.6.7.2.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.6.7.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.2.m2.6.7.2.1.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.6.7.2">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p10.2.m2.6.7.2.2.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.6.7.2.2">𝕩</ci><list id="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.3.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2"><apply id="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1"><times id="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1.1"></times><ci id="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1.2">𝑃</ci><ci id="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1.3">𝑆</ci><ci id="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1.4.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.1.1.1.1.1.4">𝑈</ci></apply><apply id="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1"><ci id="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.1">:</ci><cn id="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.2.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.2">1</cn><apply id="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.3"><plus id="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.3.1"></plus><ci id="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.3.2">𝑀</ci><cn id="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.3.3.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p10.2.m2.2.2.2.2.2.1.1.3.3">1</cn></apply></apply></list></apply><list id="S3.SS3.SSS1.Px1.p10.2.m2.6.7.3.1.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.6.7.3.2"><ci id="S3.SS3.SSS1.Px1.p10.2.m2.3.3.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.3.3">𝑄</ci><ci id="S3.SS3.SSS1.Px1.p10.2.m2.4.4.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.4.4">𝑇</ci><ci id="S3.SS3.SSS1.Px1.p10.2.m2.5.5.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.5.5">𝐼</ci><ci id="S3.SS3.SSS1.Px1.p10.2.m2.6.6.cmml" xref="S3.SS3.SSS1.Px1.p10.2.m2.6.6">𝐴</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p10.2.m2.6c">\mathbb{x}^{PSU(1:M+1)}=[Q,T,I,A]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p10.2.m2.6d">blackboard_x start_POSTSUPERSCRIPT italic_P italic_S italic_U ( 1 : italic_M + 1 ) end_POSTSUPERSCRIPT = [ italic_Q , italic_T , italic_I , italic_A ]</annotation></semantics></math>. And <math alttext="K^{PSU}=[\sum_{i}\gamma_{i}\mathbb{x}^{PSU(i)}_{l}]^{L}_{l=1}\in\mathbb{R}^{L%
\times d}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p10.3.m3.2"><semantics id="S3.SS3.SSS1.Px1.p10.3.m3.2a"><mrow id="S3.SS3.SSS1.Px1.p10.3.m3.2.2" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.cmml"><msup id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.cmml"><mi id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.2" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.2.cmml">K</mi><mrow id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3.cmml"><mi id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3.2" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3.2.cmml">P</mi><mo id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3.1" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3.3" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3.3.cmml">S</mi><mo id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3.1a" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3.4" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3.4.cmml">U</mi></mrow></msup><mo id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.4" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.4.cmml">=</mo><msubsup id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.cmml"><mrow id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.2.cmml"><mo id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.2.1.cmml">[</mo><mrow id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.cmml"><msub id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.1" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.1.2" lspace="0em" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.1.2.cmml">∑</mo><mi id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.1.3" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mrow id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.cmml"><msub id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.2" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.2.cmml"><mi id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.2.2" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.2.2.cmml">γ</mi><mi id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.2.3" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.1" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.1.cmml">⁢</mo><msubsup id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.3" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.3.cmml"><mi id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.3.2.2" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.3.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.3.3" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.3.3.cmml">l</mi><mrow id="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1" xref="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.3" xref="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.3.cmml">P</mi><mo id="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.2" xref="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.4" xref="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.4.cmml">S</mi><mo id="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.2a" xref="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.5" xref="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.5.cmml">U</mi><mo id="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.2b" xref="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.6.2" xref="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.cmml"><mo id="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.6.2.1" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.1" xref="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.6.2.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.cmml">)</mo></mrow></mrow></msubsup></mrow></mrow><mo id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.3" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.3.cmml"><mi id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.3.2" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.3.2.cmml">l</mi><mo id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.3.1" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.3.1.cmml">=</mo><mn id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.3.3" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.3.3.cmml">1</mn></mrow><mi id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.3" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.3.cmml">L</mi></msubsup><mo id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.5" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.5.cmml">∈</mo><msup id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.cmml"><mi id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.2" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.3" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.3.cmml"><mi id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.3.2" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.3.2.cmml">L</mi><mo id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.3.1.cmml">×</mo><mi id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.3.3" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p10.3.m3.2b"><apply id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2"><and id="S3.SS3.SSS1.Px1.p10.3.m3.2.2a.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2"></and><apply id="S3.SS3.SSS1.Px1.p10.3.m3.2.2b.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2"><eq id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.4.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.4"></eq><apply id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.1.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.2.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.2">𝐾</ci><apply id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3"><times id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3.1.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3.1"></times><ci id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3.2.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3.2">𝑃</ci><ci id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3.3.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3.3">𝑆</ci><ci id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3.4.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.3.3.4">𝑈</ci></apply></apply><apply id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1">superscript</csymbol><apply id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1"><apply id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.1">subscript</csymbol><sum id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.1.2"></sum><ci id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2"><times id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.1"></times><apply id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.2.2">𝛾</ci><ci id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.2.3.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.3.1.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.3">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.3.2.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.3.2.1.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.3.2.2.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.3.2.2">𝕩</ci><apply id="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1"><times id="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.2"></times><ci id="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.3">𝑃</ci><ci id="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.4.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.4">𝑆</ci><ci id="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.5.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.5">𝑈</ci><ci id="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.1.1.1.1">𝑖</ci></apply></apply><ci id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.3.3.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.1.1.1.2.3.3">𝑙</ci></apply></apply></apply></apply><ci id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.1.3">𝐿</ci></apply><apply id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.3"><eq id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.3.1.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.3.1"></eq><ci id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.3.2.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.3.2">𝑙</ci><cn id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.3.3.cmml" type="integer" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.3.3">1</cn></apply></apply></apply><apply id="S3.SS3.SSS1.Px1.p10.3.m3.2.2c.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2"><in id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.5.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.5"></in><share href="https://arxiv.org/html/2407.10714v1#S3.SS3.SSS1.Px1.p10.3.m3.2.2.1.cmml" id="S3.SS3.SSS1.Px1.p10.3.m3.2.2d.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2"></share><apply id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.1.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.2.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.2">ℝ</ci><apply id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.3.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.3"><times id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.3.1.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.3.1"></times><ci id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.3.2.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.3.2">𝐿</ci><ci id="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.3.3.cmml" xref="S3.SS3.SSS1.Px1.p10.3.m3.2.2.6.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p10.3.m3.2c">K^{PSU}=[\sum_{i}\gamma_{i}\mathbb{x}^{PSU(i)}_{l}]^{L}_{l=1}\in\mathbb{R}^{L%
\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p10.3.m3.2d">italic_K start_POSTSUPERSCRIPT italic_P italic_S italic_U end_POSTSUPERSCRIPT = [ ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_γ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT blackboard_x start_POSTSUPERSCRIPT italic_P italic_S italic_U ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ] start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_L × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the merged representations of input sequence. <math alttext="W^{PSU_{Q}}_{h}\in\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p10.4.m4.1"><semantics id="S3.SS3.SSS1.Px1.p10.4.m4.1a"><mrow id="S3.SS3.SSS1.Px1.p10.4.m4.1.1" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.cmml"><msubsup id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.cmml"><mi id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.2" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.2.cmml">W</mi><mi id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.3" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.3.cmml">h</mi><mrow id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.cmml"><mi id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.2" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.2.cmml">P</mi><mo id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.1" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.3" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.3.cmml">S</mi><mo id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.1a" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.1.cmml">⁢</mo><msub id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.4" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.4.cmml"><mi id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.4.2" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.4.2.cmml">U</mi><mi id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.4.3" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.4.3.cmml">Q</mi></msub></mrow></msubsup><mo id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.1" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.cmml"><mi id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.2" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.3" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.3.cmml"><mi id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.3.2" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.3.2.cmml">d</mi><mo id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.3.3" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p10.4.m4.1b"><apply id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1"><in id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.1"></in><apply id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.2">𝑊</ci><apply id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3"><times id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.1.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.1"></times><ci id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.2.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.2">𝑃</ci><ci id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.3.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.3">𝑆</ci><apply id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.4.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.4"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.4.1.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.4">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.4.2.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.4.2">𝑈</ci><ci id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.4.3.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.2.3.4.3">𝑄</ci></apply></apply></apply><ci id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.3.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.2.3">ℎ</ci></apply><apply id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.3"><times id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.3.1"></times><ci id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.3.2">𝑑</ci><ci id="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.Px1.p10.4.m4.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p10.4.m4.1c">W^{PSU_{Q}}_{h}\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p10.4.m4.1d">italic_W start_POSTSUPERSCRIPT italic_P italic_S italic_U start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="W^{PSU_{K}}_{h}\in\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p10.5.m5.1"><semantics id="S3.SS3.SSS1.Px1.p10.5.m5.1a"><mrow id="S3.SS3.SSS1.Px1.p10.5.m5.1.1" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.cmml"><msubsup id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.cmml"><mi id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.2" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.2.cmml">W</mi><mi id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.3" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.3.cmml">h</mi><mrow id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.cmml"><mi id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.2" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.2.cmml">P</mi><mo id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.1" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.3" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.3.cmml">S</mi><mo id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.1a" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.1.cmml">⁢</mo><msub id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.4" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.4.cmml"><mi id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.4.2" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.4.2.cmml">U</mi><mi id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.4.3" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.4.3.cmml">K</mi></msub></mrow></msubsup><mo id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.1" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.cmml"><mi id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.2" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.3" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.3.cmml"><mi id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.3.2" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.3.2.cmml">d</mi><mo id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.3.3" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p10.5.m5.1b"><apply id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1"><in id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.1"></in><apply id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.2">𝑊</ci><apply id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3"><times id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.1.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.1"></times><ci id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.2.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.2">𝑃</ci><ci id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.3.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.3">𝑆</ci><apply id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.4.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.4"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.4.1.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.4">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.4.2.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.4.2">𝑈</ci><ci id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.4.3.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.2.3.4.3">𝐾</ci></apply></apply></apply><ci id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.3.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.2.3">ℎ</ci></apply><apply id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.3"><times id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.3.1"></times><ci id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.3.2">𝑑</ci><ci id="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.Px1.p10.5.m5.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p10.5.m5.1c">W^{PSU_{K}}_{h}\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p10.5.m5.1d">italic_W start_POSTSUPERSCRIPT italic_P italic_S italic_U start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> denote the projection weight matrix of query and keys in <math alttext="h" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p10.6.m6.1"><semantics id="S3.SS3.SSS1.Px1.p10.6.m6.1a"><mi id="S3.SS3.SSS1.Px1.p10.6.m6.1.1" xref="S3.SS3.SSS1.Px1.p10.6.m6.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p10.6.m6.1b"><ci id="S3.SS3.SSS1.Px1.p10.6.m6.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.6.m6.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p10.6.m6.1c">h</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p10.6.m6.1d">italic_h</annotation></semantics></math>-th head, and <math alttext="\gamma_{ij}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p10.7.m7.1"><semantics id="S3.SS3.SSS1.Px1.p10.7.m7.1a"><msub id="S3.SS3.SSS1.Px1.p10.7.m7.1.1" xref="S3.SS3.SSS1.Px1.p10.7.m7.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p10.7.m7.1.1.2" xref="S3.SS3.SSS1.Px1.p10.7.m7.1.1.2.cmml">γ</mi><mrow id="S3.SS3.SSS1.Px1.p10.7.m7.1.1.3" xref="S3.SS3.SSS1.Px1.p10.7.m7.1.1.3.cmml"><mi id="S3.SS3.SSS1.Px1.p10.7.m7.1.1.3.2" xref="S3.SS3.SSS1.Px1.p10.7.m7.1.1.3.2.cmml">i</mi><mo id="S3.SS3.SSS1.Px1.p10.7.m7.1.1.3.1" xref="S3.SS3.SSS1.Px1.p10.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p10.7.m7.1.1.3.3" xref="S3.SS3.SSS1.Px1.p10.7.m7.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p10.7.m7.1b"><apply id="S3.SS3.SSS1.Px1.p10.7.m7.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.7.m7.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p10.7.m7.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.7.m7.1.1.2">𝛾</ci><apply id="S3.SS3.SSS1.Px1.p10.7.m7.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.7.m7.1.1.3"><times id="S3.SS3.SSS1.Px1.p10.7.m7.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px1.p10.7.m7.1.1.3.1"></times><ci id="S3.SS3.SSS1.Px1.p10.7.m7.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px1.p10.7.m7.1.1.3.2">𝑖</ci><ci id="S3.SS3.SSS1.Px1.p10.7.m7.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px1.p10.7.m7.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p10.7.m7.1c">\gamma_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p10.7.m7.1d">italic_γ start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> denotes the weight of cross-modal interaction of unit query vector and unit key vector in the sequence. <math alttext="\gamma_{ij}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p10.8.m8.1"><semantics id="S3.SS3.SSS1.Px1.p10.8.m8.1a"><msub id="S3.SS3.SSS1.Px1.p10.8.m8.1.1" xref="S3.SS3.SSS1.Px1.p10.8.m8.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p10.8.m8.1.1.2" xref="S3.SS3.SSS1.Px1.p10.8.m8.1.1.2.cmml">γ</mi><mrow id="S3.SS3.SSS1.Px1.p10.8.m8.1.1.3" xref="S3.SS3.SSS1.Px1.p10.8.m8.1.1.3.cmml"><mi id="S3.SS3.SSS1.Px1.p10.8.m8.1.1.3.2" xref="S3.SS3.SSS1.Px1.p10.8.m8.1.1.3.2.cmml">i</mi><mo id="S3.SS3.SSS1.Px1.p10.8.m8.1.1.3.1" xref="S3.SS3.SSS1.Px1.p10.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p10.8.m8.1.1.3.3" xref="S3.SS3.SSS1.Px1.p10.8.m8.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p10.8.m8.1b"><apply id="S3.SS3.SSS1.Px1.p10.8.m8.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.8.m8.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p10.8.m8.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.8.m8.1.1.2">𝛾</ci><apply id="S3.SS3.SSS1.Px1.p10.8.m8.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.8.m8.1.1.3"><times id="S3.SS3.SSS1.Px1.p10.8.m8.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px1.p10.8.m8.1.1.3.1"></times><ci id="S3.SS3.SSS1.Px1.p10.8.m8.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px1.p10.8.m8.1.1.3.2">𝑖</ci><ci id="S3.SS3.SSS1.Px1.p10.8.m8.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px1.p10.8.m8.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p10.8.m8.1c">\gamma_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p10.8.m8.1d">italic_γ start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> equals to the scalar product of <math alttext="\gamma_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p10.9.m9.1"><semantics id="S3.SS3.SSS1.Px1.p10.9.m9.1a"><msub id="S3.SS3.SSS1.Px1.p10.9.m9.1.1" xref="S3.SS3.SSS1.Px1.p10.9.m9.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p10.9.m9.1.1.2" xref="S3.SS3.SSS1.Px1.p10.9.m9.1.1.2.cmml">γ</mi><mi id="S3.SS3.SSS1.Px1.p10.9.m9.1.1.3" xref="S3.SS3.SSS1.Px1.p10.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p10.9.m9.1b"><apply id="S3.SS3.SSS1.Px1.p10.9.m9.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.9.m9.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p10.9.m9.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.9.m9.1.1.2">𝛾</ci><ci id="S3.SS3.SSS1.Px1.p10.9.m9.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p10.9.m9.1c">\gamma_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p10.9.m9.1d">italic_γ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\gamma_{j}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p10.10.m10.1"><semantics id="S3.SS3.SSS1.Px1.p10.10.m10.1a"><msub id="S3.SS3.SSS1.Px1.p10.10.m10.1.1" xref="S3.SS3.SSS1.Px1.p10.10.m10.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p10.10.m10.1.1.2" xref="S3.SS3.SSS1.Px1.p10.10.m10.1.1.2.cmml">γ</mi><mi id="S3.SS3.SSS1.Px1.p10.10.m10.1.1.3" xref="S3.SS3.SSS1.Px1.p10.10.m10.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p10.10.m10.1b"><apply id="S3.SS3.SSS1.Px1.p10.10.m10.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.10.m10.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.10.m10.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.Px1.p10.10.m10.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.10.m10.1.1.2">𝛾</ci><ci id="S3.SS3.SSS1.Px1.p10.10.m10.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.10.m10.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p10.10.m10.1c">\gamma_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p10.10.m10.1d">italic_γ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, the norm value of query vector <math alttext="|\mathbb{x}^{PSU(i)}_{t}|" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p10.11.m11.2"><semantics id="S3.SS3.SSS1.Px1.p10.11.m11.2a"><mrow id="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1" xref="S3.SS3.SSS1.Px1.p10.11.m11.2.2.2.cmml"><mo id="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.11.m11.2.2.2.1.cmml">|</mo><msubsup id="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.1" xref="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.1.2.2" xref="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.1.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.1.3" xref="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.1.3.cmml">t</mi><mrow id="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1" xref="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.3" xref="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.3.cmml">P</mi><mo id="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.2" xref="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.4" xref="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.4.cmml">S</mi><mo id="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.2a" xref="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.5" xref="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.5.cmml">U</mi><mo id="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.2b" xref="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.6.2" xref="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.cmml"><mo id="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.6.2.1" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.1" xref="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.6.2.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.cmml">)</mo></mrow></mrow></msubsup><mo id="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.3" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.11.m11.2.2.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p10.11.m11.2b"><apply id="S3.SS3.SSS1.Px1.p10.11.m11.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1"><abs id="S3.SS3.SSS1.Px1.p10.11.m11.2.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.2"></abs><apply id="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.1.2.2">𝕩</ci><apply id="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1"><times id="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.2"></times><ci id="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.3">𝑃</ci><ci id="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.4.cmml" xref="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.4">𝑆</ci><ci id="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.5.cmml" xref="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.5">𝑈</ci><ci id="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.11.m11.1.1.1.1">𝑖</ci></apply></apply><ci id="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.11.m11.2.2.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p10.11.m11.2c">|\mathbb{x}^{PSU(i)}_{t}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p10.11.m11.2d">| blackboard_x start_POSTSUPERSCRIPT italic_P italic_S italic_U ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT |</annotation></semantics></math> and the norm value of key vector <math alttext="|\mathbb{x}^{PSU(j)}_{l}|" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p10.12.m12.2"><semantics id="S3.SS3.SSS1.Px1.p10.12.m12.2a"><mrow id="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1" xref="S3.SS3.SSS1.Px1.p10.12.m12.2.2.2.cmml"><mo id="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.12.m12.2.2.2.1.cmml">|</mo><msubsup id="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.1" xref="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.1.2.2" xref="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.1.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.1.3" xref="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.1.3.cmml">l</mi><mrow id="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1" xref="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.3" xref="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.3.cmml">P</mi><mo id="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.2" xref="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.4" xref="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.4.cmml">S</mi><mo id="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.2a" xref="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.5" xref="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.5.cmml">U</mi><mo id="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.2b" xref="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.6.2" xref="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.cmml"><mo id="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.6.2.1" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.1" xref="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.1.cmml">j</mi><mo id="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.6.2.2" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.cmml">)</mo></mrow></mrow></msubsup><mo id="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.3" stretchy="false" xref="S3.SS3.SSS1.Px1.p10.12.m12.2.2.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p10.12.m12.2b"><apply id="S3.SS3.SSS1.Px1.p10.12.m12.2.2.2.cmml" xref="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1"><abs id="S3.SS3.SSS1.Px1.p10.12.m12.2.2.2.1.cmml" xref="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.2"></abs><apply id="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.1.2.2">𝕩</ci><apply id="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1"><times id="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.2"></times><ci id="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.3">𝑃</ci><ci id="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.4.cmml" xref="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.4">𝑆</ci><ci id="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.5.cmml" xref="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.5">𝑈</ci><ci id="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px1.p10.12.m12.1.1.1.1">𝑗</ci></apply></apply><ci id="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.1.3.cmml" xref="S3.SS3.SSS1.Px1.p10.12.m12.2.2.1.1.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p10.12.m12.2c">|\mathbb{x}^{PSU(j)}_{l}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p10.12.m12.2d">| blackboard_x start_POSTSUPERSCRIPT italic_P italic_S italic_U ( italic_j ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT |</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS1.Px2">
<h5 class="ltx_title ltx_font_bold ltx_title_paragraph">Multi-Modal Alignment and Query-Item Relevance</h5>
<div class="ltx_para" id="S3.SS3.SSS1.Px2.p1">
<p class="ltx_p" id="S3.SS3.SSS1.Px2.p1.2">Multi-modal alignment is a crucial task, which learns the multi-modal representation in a same embedding space. Typical alignment models, such as CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib14" title="">2021</a>)</cite>, maximize the cosine similarity of the correct <math alttext="N" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px2.p1.1.m1.1"><semantics id="S3.SS3.SSS1.Px2.p1.1.m1.1a"><mi id="S3.SS3.SSS1.Px2.p1.1.m1.1.1" xref="S3.SS3.SSS1.Px2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px2.p1.1.m1.1b"><ci id="S3.SS3.SSS1.Px2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px2.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px2.p1.1.m1.1d">italic_N</annotation></semantics></math> (text-image) pairs and minimize the cosine similarity of the incorrect <math alttext="N^{2}-N" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px2.p1.2.m2.1"><semantics id="S3.SS3.SSS1.Px2.p1.2.m2.1a"><mrow id="S3.SS3.SSS1.Px2.p1.2.m2.1.1" xref="S3.SS3.SSS1.Px2.p1.2.m2.1.1.cmml"><msup id="S3.SS3.SSS1.Px2.p1.2.m2.1.1.2" xref="S3.SS3.SSS1.Px2.p1.2.m2.1.1.2.cmml"><mi id="S3.SS3.SSS1.Px2.p1.2.m2.1.1.2.2" xref="S3.SS3.SSS1.Px2.p1.2.m2.1.1.2.2.cmml">N</mi><mn id="S3.SS3.SSS1.Px2.p1.2.m2.1.1.2.3" xref="S3.SS3.SSS1.Px2.p1.2.m2.1.1.2.3.cmml">2</mn></msup><mo id="S3.SS3.SSS1.Px2.p1.2.m2.1.1.1" xref="S3.SS3.SSS1.Px2.p1.2.m2.1.1.1.cmml">−</mo><mi id="S3.SS3.SSS1.Px2.p1.2.m2.1.1.3" xref="S3.SS3.SSS1.Px2.p1.2.m2.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px2.p1.2.m2.1b"><apply id="S3.SS3.SSS1.Px2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.Px2.p1.2.m2.1.1"><minus id="S3.SS3.SSS1.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p1.2.m2.1.1.1"></minus><apply id="S3.SS3.SSS1.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS1.Px2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p1.2.m2.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px2.p1.2.m2.1.1.2">superscript</csymbol><ci id="S3.SS3.SSS1.Px2.p1.2.m2.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px2.p1.2.m2.1.1.2.2">𝑁</ci><cn id="S3.SS3.SSS1.Px2.p1.2.m2.1.1.2.3.cmml" type="integer" xref="S3.SS3.SSS1.Px2.p1.2.m2.1.1.2.3">2</cn></apply><ci id="S3.SS3.SSS1.Px2.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS1.Px2.p1.2.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px2.p1.2.m2.1c">N^{2}-N</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px2.p1.2.m2.1d">italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - italic_N</annotation></semantics></math> mismatch pairs.
We simultaneously train multi-modal alignment tasks, including text-image, image-attributes, text-attributes with the cross entropy loss of N pairs.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.Px2.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{align}=\sum_{i\in M}\sum_{j\in M\neq i}\mathcal{L}_{\text{CLIP}}(%
\mathbb{\hat{x}}^{(i)}_{1:L},\mathbb{\hat{x}}^{(j)}_{1:L}),(i,j)\in\{T,I,A\}" class="ltx_Math" display="block" id="S3.Ex5.m1.9"><semantics id="S3.Ex5.m1.9a"><mrow id="S3.Ex5.m1.9.9.2" xref="S3.Ex5.m1.9.9.3.cmml"><mrow id="S3.Ex5.m1.8.8.1.1" xref="S3.Ex5.m1.8.8.1.1.cmml"><msub id="S3.Ex5.m1.8.8.1.1.4" xref="S3.Ex5.m1.8.8.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex5.m1.8.8.1.1.4.2" xref="S3.Ex5.m1.8.8.1.1.4.2.cmml">ℒ</mi><mrow id="S3.Ex5.m1.8.8.1.1.4.3" xref="S3.Ex5.m1.8.8.1.1.4.3.cmml"><mi id="S3.Ex5.m1.8.8.1.1.4.3.2" xref="S3.Ex5.m1.8.8.1.1.4.3.2.cmml">a</mi><mo id="S3.Ex5.m1.8.8.1.1.4.3.1" xref="S3.Ex5.m1.8.8.1.1.4.3.1.cmml">⁢</mo><mi id="S3.Ex5.m1.8.8.1.1.4.3.3" xref="S3.Ex5.m1.8.8.1.1.4.3.3.cmml">l</mi><mo id="S3.Ex5.m1.8.8.1.1.4.3.1a" xref="S3.Ex5.m1.8.8.1.1.4.3.1.cmml">⁢</mo><mi id="S3.Ex5.m1.8.8.1.1.4.3.4" xref="S3.Ex5.m1.8.8.1.1.4.3.4.cmml">i</mi><mo id="S3.Ex5.m1.8.8.1.1.4.3.1b" xref="S3.Ex5.m1.8.8.1.1.4.3.1.cmml">⁢</mo><mi id="S3.Ex5.m1.8.8.1.1.4.3.5" xref="S3.Ex5.m1.8.8.1.1.4.3.5.cmml">g</mi><mo id="S3.Ex5.m1.8.8.1.1.4.3.1c" xref="S3.Ex5.m1.8.8.1.1.4.3.1.cmml">⁢</mo><mi id="S3.Ex5.m1.8.8.1.1.4.3.6" xref="S3.Ex5.m1.8.8.1.1.4.3.6.cmml">n</mi></mrow></msub><mo id="S3.Ex5.m1.8.8.1.1.3" rspace="0.111em" xref="S3.Ex5.m1.8.8.1.1.3.cmml">=</mo><mrow id="S3.Ex5.m1.8.8.1.1.2" xref="S3.Ex5.m1.8.8.1.1.2.cmml"><munder id="S3.Ex5.m1.8.8.1.1.2.3" xref="S3.Ex5.m1.8.8.1.1.2.3.cmml"><mo id="S3.Ex5.m1.8.8.1.1.2.3.2" movablelimits="false" rspace="0em" xref="S3.Ex5.m1.8.8.1.1.2.3.2.cmml">∑</mo><mrow id="S3.Ex5.m1.8.8.1.1.2.3.3" xref="S3.Ex5.m1.8.8.1.1.2.3.3.cmml"><mi id="S3.Ex5.m1.8.8.1.1.2.3.3.2" xref="S3.Ex5.m1.8.8.1.1.2.3.3.2.cmml">i</mi><mo id="S3.Ex5.m1.8.8.1.1.2.3.3.1" xref="S3.Ex5.m1.8.8.1.1.2.3.3.1.cmml">∈</mo><mi id="S3.Ex5.m1.8.8.1.1.2.3.3.3" xref="S3.Ex5.m1.8.8.1.1.2.3.3.3.cmml">M</mi></mrow></munder><mrow id="S3.Ex5.m1.8.8.1.1.2.2" xref="S3.Ex5.m1.8.8.1.1.2.2.cmml"><munder id="S3.Ex5.m1.8.8.1.1.2.2.3" xref="S3.Ex5.m1.8.8.1.1.2.2.3.cmml"><mo id="S3.Ex5.m1.8.8.1.1.2.2.3.2" movablelimits="false" xref="S3.Ex5.m1.8.8.1.1.2.2.3.2.cmml">∑</mo><mrow id="S3.Ex5.m1.8.8.1.1.2.2.3.3" xref="S3.Ex5.m1.8.8.1.1.2.2.3.3.cmml"><mi id="S3.Ex5.m1.8.8.1.1.2.2.3.3.2" xref="S3.Ex5.m1.8.8.1.1.2.2.3.3.2.cmml">j</mi><mo id="S3.Ex5.m1.8.8.1.1.2.2.3.3.3" xref="S3.Ex5.m1.8.8.1.1.2.2.3.3.3.cmml">∈</mo><mi id="S3.Ex5.m1.8.8.1.1.2.2.3.3.4" xref="S3.Ex5.m1.8.8.1.1.2.2.3.3.4.cmml">M</mi><mo id="S3.Ex5.m1.8.8.1.1.2.2.3.3.5" xref="S3.Ex5.m1.8.8.1.1.2.2.3.3.5.cmml">≠</mo><mi id="S3.Ex5.m1.8.8.1.1.2.2.3.3.6" xref="S3.Ex5.m1.8.8.1.1.2.2.3.3.6.cmml">i</mi></mrow></munder><mrow id="S3.Ex5.m1.8.8.1.1.2.2.2" xref="S3.Ex5.m1.8.8.1.1.2.2.2.cmml"><msub id="S3.Ex5.m1.8.8.1.1.2.2.2.4" xref="S3.Ex5.m1.8.8.1.1.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex5.m1.8.8.1.1.2.2.2.4.2" xref="S3.Ex5.m1.8.8.1.1.2.2.2.4.2.cmml">ℒ</mi><mtext id="S3.Ex5.m1.8.8.1.1.2.2.2.4.3" xref="S3.Ex5.m1.8.8.1.1.2.2.2.4.3a.cmml">CLIP</mtext></msub><mo id="S3.Ex5.m1.8.8.1.1.2.2.2.3" xref="S3.Ex5.m1.8.8.1.1.2.2.2.3.cmml">⁢</mo><mrow id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.3.cmml"><mo id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.3" stretchy="false" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.3.cmml">(</mo><msubsup id="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.2.2.2.cmml">𝕩</mi><mo id="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.2.2.1" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3.cmml"><mn id="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3.3.cmml">L</mi></mrow><mrow id="S3.Ex5.m1.1.1.1.3" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex5.m1.1.1.1.3.1" stretchy="false" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex5.m1.1.1.1.1" xref="S3.Ex5.m1.1.1.1.1.cmml">i</mi><mo id="S3.Ex5.m1.1.1.1.3.2" stretchy="false" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.4" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.3.cmml">,</mo><msubsup id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.cmml"><mover accent="true" id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.2.2" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.2.2.cmml"><mi id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.2.2.2" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.2.2.2.cmml">𝕩</mi><mo id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.2.2.1" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.3" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.3.cmml"><mn id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.3.2" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.3.2.cmml">1</mn><mo id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.3.1.cmml">:</mo><mi id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.3.3" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.3.3.cmml">L</mi></mrow><mrow id="S3.Ex5.m1.2.2.1.3" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.cmml"><mo id="S3.Ex5.m1.2.2.1.3.1" stretchy="false" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.cmml">(</mo><mi id="S3.Ex5.m1.2.2.1.1" xref="S3.Ex5.m1.2.2.1.1.cmml">j</mi><mo id="S3.Ex5.m1.2.2.1.3.2" stretchy="false" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.5" stretchy="false" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.Ex5.m1.9.9.2.3" xref="S3.Ex5.m1.9.9.3a.cmml">,</mo><mrow id="S3.Ex5.m1.9.9.2.2" xref="S3.Ex5.m1.9.9.2.2.cmml"><mrow id="S3.Ex5.m1.9.9.2.2.2.2" xref="S3.Ex5.m1.9.9.2.2.2.1.cmml"><mo id="S3.Ex5.m1.9.9.2.2.2.2.1" stretchy="false" xref="S3.Ex5.m1.9.9.2.2.2.1.cmml">(</mo><mi id="S3.Ex5.m1.3.3" xref="S3.Ex5.m1.3.3.cmml">i</mi><mo id="S3.Ex5.m1.9.9.2.2.2.2.2" xref="S3.Ex5.m1.9.9.2.2.2.1.cmml">,</mo><mi id="S3.Ex5.m1.4.4" xref="S3.Ex5.m1.4.4.cmml">j</mi><mo id="S3.Ex5.m1.9.9.2.2.2.2.3" stretchy="false" xref="S3.Ex5.m1.9.9.2.2.2.1.cmml">)</mo></mrow><mo id="S3.Ex5.m1.9.9.2.2.1" xref="S3.Ex5.m1.9.9.2.2.1.cmml">∈</mo><mrow id="S3.Ex5.m1.9.9.2.2.3.2" xref="S3.Ex5.m1.9.9.2.2.3.1.cmml"><mo id="S3.Ex5.m1.9.9.2.2.3.2.1" stretchy="false" xref="S3.Ex5.m1.9.9.2.2.3.1.cmml">{</mo><mi id="S3.Ex5.m1.5.5" xref="S3.Ex5.m1.5.5.cmml">T</mi><mo id="S3.Ex5.m1.9.9.2.2.3.2.2" xref="S3.Ex5.m1.9.9.2.2.3.1.cmml">,</mo><mi id="S3.Ex5.m1.6.6" xref="S3.Ex5.m1.6.6.cmml">I</mi><mo id="S3.Ex5.m1.9.9.2.2.3.2.3" xref="S3.Ex5.m1.9.9.2.2.3.1.cmml">,</mo><mi id="S3.Ex5.m1.7.7" xref="S3.Ex5.m1.7.7.cmml">A</mi><mo id="S3.Ex5.m1.9.9.2.2.3.2.4" stretchy="false" xref="S3.Ex5.m1.9.9.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex5.m1.9b"><apply id="S3.Ex5.m1.9.9.3.cmml" xref="S3.Ex5.m1.9.9.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.9.9.3a.cmml" xref="S3.Ex5.m1.9.9.2.3">formulae-sequence</csymbol><apply id="S3.Ex5.m1.8.8.1.1.cmml" xref="S3.Ex5.m1.8.8.1.1"><eq id="S3.Ex5.m1.8.8.1.1.3.cmml" xref="S3.Ex5.m1.8.8.1.1.3"></eq><apply id="S3.Ex5.m1.8.8.1.1.4.cmml" xref="S3.Ex5.m1.8.8.1.1.4"><csymbol cd="ambiguous" id="S3.Ex5.m1.8.8.1.1.4.1.cmml" xref="S3.Ex5.m1.8.8.1.1.4">subscript</csymbol><ci id="S3.Ex5.m1.8.8.1.1.4.2.cmml" xref="S3.Ex5.m1.8.8.1.1.4.2">ℒ</ci><apply id="S3.Ex5.m1.8.8.1.1.4.3.cmml" xref="S3.Ex5.m1.8.8.1.1.4.3"><times id="S3.Ex5.m1.8.8.1.1.4.3.1.cmml" xref="S3.Ex5.m1.8.8.1.1.4.3.1"></times><ci id="S3.Ex5.m1.8.8.1.1.4.3.2.cmml" xref="S3.Ex5.m1.8.8.1.1.4.3.2">𝑎</ci><ci id="S3.Ex5.m1.8.8.1.1.4.3.3.cmml" xref="S3.Ex5.m1.8.8.1.1.4.3.3">𝑙</ci><ci id="S3.Ex5.m1.8.8.1.1.4.3.4.cmml" xref="S3.Ex5.m1.8.8.1.1.4.3.4">𝑖</ci><ci id="S3.Ex5.m1.8.8.1.1.4.3.5.cmml" xref="S3.Ex5.m1.8.8.1.1.4.3.5">𝑔</ci><ci id="S3.Ex5.m1.8.8.1.1.4.3.6.cmml" xref="S3.Ex5.m1.8.8.1.1.4.3.6">𝑛</ci></apply></apply><apply id="S3.Ex5.m1.8.8.1.1.2.cmml" xref="S3.Ex5.m1.8.8.1.1.2"><apply id="S3.Ex5.m1.8.8.1.1.2.3.cmml" xref="S3.Ex5.m1.8.8.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex5.m1.8.8.1.1.2.3.1.cmml" xref="S3.Ex5.m1.8.8.1.1.2.3">subscript</csymbol><sum id="S3.Ex5.m1.8.8.1.1.2.3.2.cmml" xref="S3.Ex5.m1.8.8.1.1.2.3.2"></sum><apply id="S3.Ex5.m1.8.8.1.1.2.3.3.cmml" xref="S3.Ex5.m1.8.8.1.1.2.3.3"><in id="S3.Ex5.m1.8.8.1.1.2.3.3.1.cmml" xref="S3.Ex5.m1.8.8.1.1.2.3.3.1"></in><ci id="S3.Ex5.m1.8.8.1.1.2.3.3.2.cmml" xref="S3.Ex5.m1.8.8.1.1.2.3.3.2">𝑖</ci><ci id="S3.Ex5.m1.8.8.1.1.2.3.3.3.cmml" xref="S3.Ex5.m1.8.8.1.1.2.3.3.3">𝑀</ci></apply></apply><apply id="S3.Ex5.m1.8.8.1.1.2.2.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2"><apply id="S3.Ex5.m1.8.8.1.1.2.2.3.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.Ex5.m1.8.8.1.1.2.2.3.1.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.3">subscript</csymbol><sum id="S3.Ex5.m1.8.8.1.1.2.2.3.2.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.3.2"></sum><apply id="S3.Ex5.m1.8.8.1.1.2.2.3.3.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.3.3"><and id="S3.Ex5.m1.8.8.1.1.2.2.3.3a.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.3.3"></and><apply id="S3.Ex5.m1.8.8.1.1.2.2.3.3b.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.3.3"><in id="S3.Ex5.m1.8.8.1.1.2.2.3.3.3.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.3.3.3"></in><ci id="S3.Ex5.m1.8.8.1.1.2.2.3.3.2.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.3.3.2">𝑗</ci><ci id="S3.Ex5.m1.8.8.1.1.2.2.3.3.4.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.3.3.4">𝑀</ci></apply><apply id="S3.Ex5.m1.8.8.1.1.2.2.3.3c.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.3.3"><neq id="S3.Ex5.m1.8.8.1.1.2.2.3.3.5.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.3.3.5"></neq><share href="https://arxiv.org/html/2407.10714v1#S3.Ex5.m1.8.8.1.1.2.2.3.3.4.cmml" id="S3.Ex5.m1.8.8.1.1.2.2.3.3d.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.3.3"></share><ci id="S3.Ex5.m1.8.8.1.1.2.2.3.3.6.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.3.3.6">𝑖</ci></apply></apply></apply><apply id="S3.Ex5.m1.8.8.1.1.2.2.2.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.2"><times id="S3.Ex5.m1.8.8.1.1.2.2.2.3.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.2.3"></times><apply id="S3.Ex5.m1.8.8.1.1.2.2.2.4.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S3.Ex5.m1.8.8.1.1.2.2.2.4.1.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.2.4">subscript</csymbol><ci id="S3.Ex5.m1.8.8.1.1.2.2.2.4.2.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.2.4.2">ℒ</ci><ci id="S3.Ex5.m1.8.8.1.1.2.2.2.4.3a.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.2.4.3"><mtext id="S3.Ex5.m1.8.8.1.1.2.2.2.4.3.cmml" mathsize="70%" xref="S3.Ex5.m1.8.8.1.1.2.2.2.4.3">CLIP</mtext></ci></apply><interval closure="open" id="S3.Ex5.m1.8.8.1.1.2.2.2.2.3.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2"><apply id="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.2.2"><ci id="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.2.2.2">𝕩</ci></apply><ci id="S3.Ex5.m1.1.1.1.1.cmml" xref="S3.Ex5.m1.1.1.1.1">𝑖</ci></apply><apply id="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3"><ci id="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3.1">:</ci><cn id="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3.3">𝐿</ci></apply></apply><apply id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.1.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2">subscript</csymbol><apply id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.2.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.2.1.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2">superscript</csymbol><apply id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.2.2.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.2.2"><ci id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.2.2.1.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.2.2.1">^</ci><ci id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.2.2.2.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.2.2.2">𝕩</ci></apply><ci id="S3.Ex5.m1.2.2.1.1.cmml" xref="S3.Ex5.m1.2.2.1.1">𝑗</ci></apply><apply id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.3.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.3"><ci id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.3.1.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.3.1">:</ci><cn id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.3.2.cmml" type="integer" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.3.2">1</cn><ci id="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.3.3.cmml" xref="S3.Ex5.m1.8.8.1.1.2.2.2.2.2.2.3.3">𝐿</ci></apply></apply></interval></apply></apply></apply></apply><apply id="S3.Ex5.m1.9.9.2.2.cmml" xref="S3.Ex5.m1.9.9.2.2"><in id="S3.Ex5.m1.9.9.2.2.1.cmml" xref="S3.Ex5.m1.9.9.2.2.1"></in><interval closure="open" id="S3.Ex5.m1.9.9.2.2.2.1.cmml" xref="S3.Ex5.m1.9.9.2.2.2.2"><ci id="S3.Ex5.m1.3.3.cmml" xref="S3.Ex5.m1.3.3">𝑖</ci><ci id="S3.Ex5.m1.4.4.cmml" xref="S3.Ex5.m1.4.4">𝑗</ci></interval><set id="S3.Ex5.m1.9.9.2.2.3.1.cmml" xref="S3.Ex5.m1.9.9.2.2.3.2"><ci id="S3.Ex5.m1.5.5.cmml" xref="S3.Ex5.m1.5.5">𝑇</ci><ci id="S3.Ex5.m1.6.6.cmml" xref="S3.Ex5.m1.6.6">𝐼</ci><ci id="S3.Ex5.m1.7.7.cmml" xref="S3.Ex5.m1.7.7">𝐴</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5.m1.9c">\mathcal{L}_{align}=\sum_{i\in M}\sum_{j\in M\neq i}\mathcal{L}_{\text{CLIP}}(%
\mathbb{\hat{x}}^{(i)}_{1:L},\mathbb{\hat{x}}^{(j)}_{1:L}),(i,j)\in\{T,I,A\}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex5.m1.9d">caligraphic_L start_POSTSUBSCRIPT italic_a italic_l italic_i italic_g italic_n end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i ∈ italic_M end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_j ∈ italic_M ≠ italic_i end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT CLIP end_POSTSUBSCRIPT ( over^ start_ARG blackboard_x end_ARG start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 : italic_L end_POSTSUBSCRIPT , over^ start_ARG blackboard_x end_ARG start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 : italic_L end_POSTSUBSCRIPT ) , ( italic_i , italic_j ) ∈ { italic_T , italic_I , italic_A }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.Px2.p3">
<p class="ltx_p" id="S3.SS3.SSS1.Px2.p3.6">Sequence length <math alttext="L" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px2.p3.1.m1.1"><semantics id="S3.SS3.SSS1.Px2.p3.1.m1.1a"><mi id="S3.SS3.SSS1.Px2.p3.1.m1.1.1" xref="S3.SS3.SSS1.Px2.p3.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px2.p3.1.m1.1b"><ci id="S3.SS3.SSS1.Px2.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p3.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px2.p3.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px2.p3.1.m1.1d">italic_L</annotation></semantics></math> is usually large and the alignment has complexity of <math alttext="O(L^{2})" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px2.p3.2.m2.1"><semantics id="S3.SS3.SSS1.Px2.p3.2.m2.1a"><mrow id="S3.SS3.SSS1.Px2.p3.2.m2.1.1" xref="S3.SS3.SSS1.Px2.p3.2.m2.1.1.cmml"><mi id="S3.SS3.SSS1.Px2.p3.2.m2.1.1.3" xref="S3.SS3.SSS1.Px2.p3.2.m2.1.1.3.cmml">O</mi><mo id="S3.SS3.SSS1.Px2.p3.2.m2.1.1.2" xref="S3.SS3.SSS1.Px2.p3.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS1.Px2.p3.2.m2.1.1.1.1" xref="S3.SS3.SSS1.Px2.p3.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.Px2.p3.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.Px2.p3.2.m2.1.1.1.1.1.cmml">(</mo><msup id="S3.SS3.SSS1.Px2.p3.2.m2.1.1.1.1.1" xref="S3.SS3.SSS1.Px2.p3.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px2.p3.2.m2.1.1.1.1.1.2" xref="S3.SS3.SSS1.Px2.p3.2.m2.1.1.1.1.1.2.cmml">L</mi><mn id="S3.SS3.SSS1.Px2.p3.2.m2.1.1.1.1.1.3" xref="S3.SS3.SSS1.Px2.p3.2.m2.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.SS3.SSS1.Px2.p3.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.Px2.p3.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px2.p3.2.m2.1b"><apply id="S3.SS3.SSS1.Px2.p3.2.m2.1.1.cmml" xref="S3.SS3.SSS1.Px2.p3.2.m2.1.1"><times id="S3.SS3.SSS1.Px2.p3.2.m2.1.1.2.cmml" xref="S3.SS3.SSS1.Px2.p3.2.m2.1.1.2"></times><ci id="S3.SS3.SSS1.Px2.p3.2.m2.1.1.3.cmml" xref="S3.SS3.SSS1.Px2.p3.2.m2.1.1.3">𝑂</ci><apply id="S3.SS3.SSS1.Px2.p3.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p3.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p3.2.m2.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.Px2.p3.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px2.p3.2.m2.1.1.1.1.1.2">𝐿</ci><cn id="S3.SS3.SSS1.Px2.p3.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.Px2.p3.2.m2.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px2.p3.2.m2.1c">O(L^{2})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px2.p3.2.m2.1d">italic_O ( italic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>. To reduce the complexity, we further split the sequence into <math alttext="N_{ch}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px2.p3.3.m3.1"><semantics id="S3.SS3.SSS1.Px2.p3.3.m3.1a"><msub id="S3.SS3.SSS1.Px2.p3.3.m3.1.1" xref="S3.SS3.SSS1.Px2.p3.3.m3.1.1.cmml"><mi id="S3.SS3.SSS1.Px2.p3.3.m3.1.1.2" xref="S3.SS3.SSS1.Px2.p3.3.m3.1.1.2.cmml">N</mi><mrow id="S3.SS3.SSS1.Px2.p3.3.m3.1.1.3" xref="S3.SS3.SSS1.Px2.p3.3.m3.1.1.3.cmml"><mi id="S3.SS3.SSS1.Px2.p3.3.m3.1.1.3.2" xref="S3.SS3.SSS1.Px2.p3.3.m3.1.1.3.2.cmml">c</mi><mo id="S3.SS3.SSS1.Px2.p3.3.m3.1.1.3.1" xref="S3.SS3.SSS1.Px2.p3.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p3.3.m3.1.1.3.3" xref="S3.SS3.SSS1.Px2.p3.3.m3.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px2.p3.3.m3.1b"><apply id="S3.SS3.SSS1.Px2.p3.3.m3.1.1.cmml" xref="S3.SS3.SSS1.Px2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.3.m3.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.Px2.p3.3.m3.1.1.2.cmml" xref="S3.SS3.SSS1.Px2.p3.3.m3.1.1.2">𝑁</ci><apply id="S3.SS3.SSS1.Px2.p3.3.m3.1.1.3.cmml" xref="S3.SS3.SSS1.Px2.p3.3.m3.1.1.3"><times id="S3.SS3.SSS1.Px2.p3.3.m3.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px2.p3.3.m3.1.1.3.1"></times><ci id="S3.SS3.SSS1.Px2.p3.3.m3.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px2.p3.3.m3.1.1.3.2">𝑐</ci><ci id="S3.SS3.SSS1.Px2.p3.3.m3.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px2.p3.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px2.p3.3.m3.1c">N_{ch}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px2.p3.3.m3.1d">italic_N start_POSTSUBSCRIPT italic_c italic_h end_POSTSUBSCRIPT</annotation></semantics></math> chunks. Each chunk is a sub-sequence with length <math alttext="L_{sub}=\frac{L}{N_{ch}}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px2.p3.4.m4.1"><semantics id="S3.SS3.SSS1.Px2.p3.4.m4.1a"><mrow id="S3.SS3.SSS1.Px2.p3.4.m4.1.1" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.cmml"><msub id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.cmml"><mi id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.2" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.2.cmml">L</mi><mrow id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3.cmml"><mi id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3.2" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3.2.cmml">s</mi><mo id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3.1" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3.3" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3.3.cmml">u</mi><mo id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3.1a" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3.4" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3.4.cmml">b</mi></mrow></msub><mo id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.1" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.1.cmml">=</mo><mfrac id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.cmml"><mi id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.2" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.2.cmml">L</mi><msub id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.cmml"><mi id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.2" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.2.cmml">N</mi><mrow id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.3" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.3.2" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.3.2.cmml">c</mi><mo id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.3.1" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.3.3" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.3.3.cmml">h</mi></mrow></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px2.p3.4.m4.1b"><apply id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.cmml" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1"><eq id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.1"></eq><apply id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.cmml" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.2">𝐿</ci><apply id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3.cmml" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3"><times id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3.1.cmml" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3.1"></times><ci id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3.2.cmml" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3.2">𝑠</ci><ci id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3.3.cmml" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3.3">𝑢</ci><ci id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3.4.cmml" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.2.3.4">𝑏</ci></apply></apply><apply id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.cmml" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3"><divide id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3"></divide><ci id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.2">𝐿</ci><apply id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.2">𝑁</ci><apply id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.3"><times id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.3.1"></times><ci id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.3.2">𝑐</ci><ci id="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS1.Px2.p3.4.m4.1.1.3.3.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px2.p3.4.m4.1c">L_{sub}=\frac{L}{N_{ch}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px2.p3.4.m4.1d">italic_L start_POSTSUBSCRIPT italic_s italic_u italic_b end_POSTSUBSCRIPT = divide start_ARG italic_L end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_c italic_h end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>. The alignment loss is the sum of multiple losses within chunks as <math alttext="\mathcal{L}_{\text{CLIP}}(\mathbb{\hat{x}}^{(i)}_{1:L},\mathbb{\hat{x}}^{(j)}_%
{1:L})=\sum_{k\in N_{ch}}\mathcal{L}_{CLIP}(\mathbb{\hat{x}}^{(i)}_{L_{k}:L_{k%
+1}},\mathbb{\hat{x}}^{(j)}_{L_{k}:L_{k+1}})" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px2.p3.5.m5.8"><semantics id="S3.SS3.SSS1.Px2.p3.5.m5.8a"><mrow id="S3.SS3.SSS1.Px2.p3.5.m5.8.8" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.cmml"><mrow id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.cmml"><msub id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.4" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.4.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.4.2.cmml">ℒ</mi><mtext id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.4.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.4.3a.cmml">CLIP</mtext></msub><mo id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.3.cmml">⁢</mo><mrow id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.3.cmml"><mo id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.3" stretchy="false" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.3.cmml">(</mo><msubsup id="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.cmml"><mover accent="true" id="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.2.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.2.2.cmml"><mi id="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.2.2.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.2.2.2.cmml">𝕩</mi><mo id="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.2.2.1" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.3.cmml"><mn id="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.3.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.3.2.cmml">1</mn><mo id="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.3.1.cmml">:</mo><mi id="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.3.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.3.3.cmml">L</mi></mrow><mrow id="S3.SS3.SSS1.Px2.p3.5.m5.1.1.1.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.Px2.p3.5.m5.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS1.Px2.p3.5.m5.1.1.1.1" xref="S3.SS3.SSS1.Px2.p3.5.m5.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS1.Px2.p3.5.m5.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.4" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.3.cmml">,</mo><msubsup id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.cmml"><mover accent="true" id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.2.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.2.2.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.2.2.2.cmml">𝕩</mi><mo id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.2.2.1" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.3.cmml"><mn id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.3.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.3.2.cmml">1</mn><mo id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.3.1.cmml">:</mo><mi id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.3.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.3.3.cmml">L</mi></mrow><mrow id="S3.SS3.SSS1.Px2.p3.5.m5.2.2.1.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.cmml"><mo id="S3.SS3.SSS1.Px2.p3.5.m5.2.2.1.3.1" stretchy="false" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.cmml">(</mo><mi id="S3.SS3.SSS1.Px2.p3.5.m5.2.2.1.1" xref="S3.SS3.SSS1.Px2.p3.5.m5.2.2.1.1.cmml">j</mi><mo id="S3.SS3.SSS1.Px2.p3.5.m5.2.2.1.3.2" stretchy="false" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.5" stretchy="false" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.5" rspace="0.111em" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.5.cmml">=</mo><mrow id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.cmml"><msub id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.cmml"><mo id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.2.cmml">∑</mo><mrow id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.cmml"><mi id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.2.cmml">k</mi><mo id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.1" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.1.cmml">∈</mo><msub id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.cmml"><mi id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.2.cmml">N</mi><mrow id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.3.cmml"><mi id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.3.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.3.2.cmml">c</mi><mo id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.3.1" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.3.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.3.3.cmml">h</mi></mrow></msub></mrow></msub><mrow id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.cmml"><msub id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.2.cmml">ℒ</mi><mrow id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.cmml"><mi id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.2.cmml">C</mi><mo id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.1" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.3.cmml">L</mi><mo id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.1a" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.4" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.4.cmml">I</mi><mo id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.1b" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.5" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.5.cmml">P</mi></mrow></msub><mo id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.3.cmml">⁢</mo><mrow id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.3.cmml"><mo id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.3" stretchy="false" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.3.cmml">(</mo><msubsup id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.cmml"><mover accent="true" id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.2.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.2.2.cmml"><mi id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.2.2.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.2.2.2.cmml">𝕩</mi><mo id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.2.2.1" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.cmml"><msub id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.2.cmml"><mi id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.2.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.2.2.cmml">L</mi><mi id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.2.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.2.3.cmml">k</mi></msub><mo id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.1.cmml">:</mo><msub id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.cmml"><mi id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.2.cmml">L</mi><mrow id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.3.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.3.2.cmml">k</mi><mo id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.3.1" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.3.1.cmml">+</mo><mn id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.3.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mrow id="S3.SS3.SSS1.Px2.p3.5.m5.3.3.1.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.Px2.p3.5.m5.3.3.1.3.1" stretchy="false" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS1.Px2.p3.5.m5.3.3.1.1" xref="S3.SS3.SSS1.Px2.p3.5.m5.3.3.1.1.cmml">i</mi><mo id="S3.SS3.SSS1.Px2.p3.5.m5.3.3.1.3.2" stretchy="false" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.4" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.3.cmml">,</mo><msubsup id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.cmml"><mover accent="true" id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.2.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.2.2.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.2.2.2.cmml">𝕩</mi><mo id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.2.2.1" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.cmml"><msub id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.2.cmml"><mi id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.2.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.2.2.cmml">L</mi><mi id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.2.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.2.3.cmml">k</mi></msub><mo id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.1.cmml">:</mo><msub id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.cmml"><mi id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.2.cmml">L</mi><mrow id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.3.cmml"><mi id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.3.2" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.3.2.cmml">k</mi><mo id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.3.1" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.3.1.cmml">+</mo><mn id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.3.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mrow id="S3.SS3.SSS1.Px2.p3.5.m5.4.4.1.3" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.cmml"><mo id="S3.SS3.SSS1.Px2.p3.5.m5.4.4.1.3.1" stretchy="false" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.cmml">(</mo><mi id="S3.SS3.SSS1.Px2.p3.5.m5.4.4.1.1" xref="S3.SS3.SSS1.Px2.p3.5.m5.4.4.1.1.cmml">j</mi><mo id="S3.SS3.SSS1.Px2.p3.5.m5.4.4.1.3.2" stretchy="false" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.5" stretchy="false" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px2.p3.5.m5.8b"><apply id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8"><eq id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.5.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.5"></eq><apply id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2"><times id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.3"></times><apply id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.4.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.4"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.4.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.4">subscript</csymbol><ci id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.4.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.4.2">ℒ</ci><ci id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.4.3a.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.4.3"><mtext id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.4.3.cmml" mathsize="70%" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.4.3">CLIP</mtext></ci></apply><interval closure="open" id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2"><apply id="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1">superscript</csymbol><apply id="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.2.2"><ci id="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.2.2.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.2.2.1">^</ci><ci id="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.2.2.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.2.2.2">𝕩</ci></apply><ci id="S3.SS3.SSS1.Px2.p3.5.m5.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.1.1.1.1">𝑖</ci></apply><apply id="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.3"><ci id="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.3.1">:</ci><cn id="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.3.2.cmml" type="integer" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.3.2">1</cn><ci id="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.5.5.1.1.1.1.3.3">𝐿</ci></apply></apply><apply id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2">subscript</csymbol><apply id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2">superscript</csymbol><apply id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.2.2"><ci id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.2.2.1">^</ci><ci id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.2.2.2">𝕩</ci></apply><ci id="S3.SS3.SSS1.Px2.p3.5.m5.2.2.1.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.2.2.1.1">𝑗</ci></apply><apply id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.3"><ci id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.3.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.3.1">:</ci><cn id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.3.2.cmml" type="integer" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.3.2">1</cn><ci id="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.3.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.6.6.2.2.2.2.3.3">𝐿</ci></apply></apply></interval></apply><apply id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4"><apply id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3">subscript</csymbol><sum id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.2"></sum><apply id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3"><in id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.1"></in><ci id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.2">𝑘</ci><apply id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.2">𝑁</ci><apply id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.3"><times id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.3.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.3.1"></times><ci id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.3.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.3.2">𝑐</ci><ci id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.3.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.3.3.3.3.3">ℎ</ci></apply></apply></apply></apply><apply id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2"><times id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.3"></times><apply id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4">subscript</csymbol><ci id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.2">ℒ</ci><apply id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3"><times id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.1"></times><ci id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.2">𝐶</ci><ci id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.3">𝐿</ci><ci id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.4.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.4">𝐼</ci><ci id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.5.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.4.3.5">𝑃</ci></apply></apply><interval closure="open" id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2"><apply id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1">superscript</csymbol><apply id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.2.2"><ci id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.2.2.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.2.2.1">^</ci><ci id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.2.2.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.2.2.2">𝕩</ci></apply><ci id="S3.SS3.SSS1.Px2.p3.5.m5.3.3.1.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.3.3.1.1">𝑖</ci></apply><apply id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3"><ci id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.1">:</ci><apply id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.2.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.2">subscript</csymbol><ci id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.2.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.2.2">𝐿</ci><ci id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.2.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.2.3">𝑘</ci></apply><apply id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.2">𝐿</ci><apply id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.3"><plus id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.3.2">𝑘</ci><cn id="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.3.3.cmml" type="integer" xref="S3.SS3.SSS1.Px2.p3.5.m5.7.7.3.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply><apply id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2">subscript</csymbol><apply id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2">superscript</csymbol><apply id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.2.2"><ci id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.2.2.1">^</ci><ci id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.2.2.2">𝕩</ci></apply><ci id="S3.SS3.SSS1.Px2.p3.5.m5.4.4.1.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.4.4.1.1">𝑗</ci></apply><apply id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3"><ci id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.1">:</ci><apply id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.2.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.2">subscript</csymbol><ci id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.2.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.2.2">𝐿</ci><ci id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.2.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.2.3">𝑘</ci></apply><apply id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.2">𝐿</ci><apply id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.3.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.3"><plus id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.3.1.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.3.1"></plus><ci id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.3.2.cmml" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.3.2">𝑘</ci><cn id="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.3.3.cmml" type="integer" xref="S3.SS3.SSS1.Px2.p3.5.m5.8.8.4.2.2.2.2.3.3.3.3">1</cn></apply></apply></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px2.p3.5.m5.8c">\mathcal{L}_{\text{CLIP}}(\mathbb{\hat{x}}^{(i)}_{1:L},\mathbb{\hat{x}}^{(j)}_%
{1:L})=\sum_{k\in N_{ch}}\mathcal{L}_{CLIP}(\mathbb{\hat{x}}^{(i)}_{L_{k}:L_{k%
+1}},\mathbb{\hat{x}}^{(j)}_{L_{k}:L_{k+1}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px2.p3.5.m5.8d">caligraphic_L start_POSTSUBSCRIPT CLIP end_POSTSUBSCRIPT ( over^ start_ARG blackboard_x end_ARG start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 : italic_L end_POSTSUBSCRIPT , over^ start_ARG blackboard_x end_ARG start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 : italic_L end_POSTSUBSCRIPT ) = ∑ start_POSTSUBSCRIPT italic_k ∈ italic_N start_POSTSUBSCRIPT italic_c italic_h end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT italic_C italic_L italic_I italic_P end_POSTSUBSCRIPT ( over^ start_ARG blackboard_x end_ARG start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT : italic_L start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , over^ start_ARG blackboard_x end_ARG start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT : italic_L start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math> with complexity reduced to <math alttext="O(L^{2}/N_{ch})" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px2.p3.6.m6.1"><semantics id="S3.SS3.SSS1.Px2.p3.6.m6.1a"><mrow id="S3.SS3.SSS1.Px2.p3.6.m6.1.1" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.cmml"><mi id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.3" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.3.cmml">O</mi><mo id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.2" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.cmml"><msup id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.2" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.2.cmml"><mi id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.2.2" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.2.2.cmml">L</mi><mn id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.2.3" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.2.3.cmml">2</mn></msup><mo id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.1" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.1.cmml">/</mo><msub id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.2" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.2.cmml">N</mi><mrow id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.3" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.3.cmml"><mi id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.3.2" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.3.2.cmml">c</mi><mo id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.3.1" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.3.3" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.3.3.cmml">h</mi></mrow></msub></mrow><mo id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px2.p3.6.m6.1b"><apply id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.cmml" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1"><times id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.2.cmml" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.2"></times><ci id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.3.cmml" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.3">𝑂</ci><apply id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1"><divide id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.1"></divide><apply id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.2.2">𝐿</ci><cn id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.2.3">2</cn></apply><apply id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.2">𝑁</ci><apply id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.3"><times id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.3.1"></times><ci id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.3.2">𝑐</ci><ci id="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.Px2.p3.6.m6.1.1.1.1.1.3.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px2.p3.6.m6.1c">O(L^{2}/N_{ch})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px2.p3.6.m6.1d">italic_O ( italic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT / italic_N start_POSTSUBSCRIPT italic_c italic_h end_POSTSUBSCRIPT )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.Px2.p4">
<p class="ltx_p" id="S3.SS3.SSS1.Px2.p4.3">Additionally, query item relevance prediction is a typical search task, usually modelled as binary classification to predict the correct query-item pair from irrelevant query-item pairs. Each pair of query and item is represented as <math alttext="[\mathbb{x}^{query}_{l};\mathbb{x}^{item}_{l}=\sum_{m\in M}\gamma_{m}\mathbb{x%
}^{item^{(m)}}_{l}]" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px2.p4.1.m1.2"><semantics id="S3.SS3.SSS1.Px2.p4.1.m1.2a"><mrow id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.2.cmml"><mo id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.2" stretchy="false" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.2.1.cmml">[</mo><mrow id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.cmml"><mrow id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.3.cmml"><msubsup id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.2" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.3" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.3.cmml">l</mi><mrow id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.cmml"><mi id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.2" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.2.cmml">q</mi><mo id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.1" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.3" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.3.cmml">u</mi><mo id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.1a" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.4" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.4.cmml">e</mi><mo id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.1b" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.5" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.5.cmml">r</mi><mo id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.1c" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.6" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.6.cmml">y</mi></mrow></msubsup><mo id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.3" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.3.cmml">;</mo><msubsup id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.cmml"><mi id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.2" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.3" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.3.cmml">l</mi><mrow id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.cmml"><mi id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.2" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.2.cmml">i</mi><mo id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.1" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.3" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.3.cmml">t</mi><mo id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.1a" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.4" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.4.cmml">e</mi><mo id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.1b" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.5" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.5.cmml">m</mi></mrow></msubsup></mrow><mo id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.3" rspace="0.111em" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.cmml"><msub id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.cmml"><mo id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.2" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.2.cmml">∑</mo><mrow id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.3" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.3.cmml"><mi id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.3.2" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.3.2.cmml">m</mi><mo id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.3.1" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.3.1.cmml">∈</mo><mi id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.3.3" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.3.3.cmml">M</mi></mrow></msub><mrow id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.cmml"><msub id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.2" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.2.cmml"><mi id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.2.2" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.2.2.cmml">γ</mi><mi id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.2.3" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.2.3.cmml">m</mi></msub><mo id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.1" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.1.cmml">⁢</mo><msubsup id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.3" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.3.cmml"><mi id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.3.2.2" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.3.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.3.3" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.3.3.cmml">l</mi><mrow id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.3" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.3.cmml">i</mi><mo id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.2" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.4" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.4.cmml">t</mi><mo id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.2a" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.5" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.5.cmml">e</mi><mo id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.2b" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.2.cmml">⁢</mo><msup id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.6" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.6.cmml"><mi id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.6.2" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.6.2.cmml">m</mi><mrow id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.1.1.3" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.6.cmml"><mo id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.6.cmml">(</mo><mi id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.1.1.1" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.1.1.1.cmml">m</mi><mo id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.6.cmml">)</mo></mrow></msup></mrow></msubsup></mrow></mrow></mrow><mo id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.3" stretchy="false" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px2.p4.1.m1.2b"><apply id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.2.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1"><csymbol cd="latexml" id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.2.1.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.2">delimited-[]</csymbol><apply id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1"><eq id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.3.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.3"></eq><list id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.3.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2"><apply id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.2">𝕩</ci><apply id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3"><times id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.1.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.1"></times><ci id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.2.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.2">𝑞</ci><ci id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.3.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.3">𝑢</ci><ci id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.4.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.4">𝑒</ci><ci id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.5.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.5">𝑟</ci><ci id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.6.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.2.3.6">𝑦</ci></apply></apply><ci id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.1.1.1.3">𝑙</ci></apply><apply id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2">subscript</csymbol><apply id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2">superscript</csymbol><ci id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.2">𝕩</ci><apply id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3"><times id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.1.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.1"></times><ci id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.2.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.2">𝑖</ci><ci id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.3.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.3">𝑡</ci><ci id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.4.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.4">𝑒</ci><ci id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.5.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.2.3.5">𝑚</ci></apply></apply><ci id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.2.2.2.3">𝑙</ci></apply></list><apply id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4"><apply id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.1.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1">subscript</csymbol><sum id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.2.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.2"></sum><apply id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.3.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.3"><in id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.3.1.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.3.1"></in><ci id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.3.2.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.3.2">𝑚</ci><ci id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.3.3.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.1.3.3">𝑀</ci></apply></apply><apply id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2"><times id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.1.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.1"></times><apply id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.2.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.2.1.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.2.2.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.2.2">𝛾</ci><ci id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.2.3.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.2.3">𝑚</ci></apply><apply id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.3.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.3.1.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.3">subscript</csymbol><apply id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.3.2.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.3.2.1.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.3">superscript</csymbol><ci id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.3.2.2.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.3.2.2">𝕩</ci><apply id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1"><times id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.2"></times><ci id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.3">𝑖</ci><ci id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.4.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.4">𝑡</ci><ci id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.5.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.5">𝑒</ci><apply id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.6.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.6"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.6.1.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.6">superscript</csymbol><ci id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.6.2.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.6.2">𝑚</ci><ci id="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.1.1.1.1.1.1">𝑚</ci></apply></apply></apply><ci id="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.3.3.cmml" xref="S3.SS3.SSS1.Px2.p4.1.m1.2.2.1.1.4.2.3.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px2.p4.1.m1.2c">[\mathbb{x}^{query}_{l};\mathbb{x}^{item}_{l}=\sum_{m\in M}\gamma_{m}\mathbb{x%
}^{item^{(m)}}_{l}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px2.p4.1.m1.2d">[ blackboard_x start_POSTSUPERSCRIPT italic_q italic_u italic_e italic_r italic_y end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ; blackboard_x start_POSTSUPERSCRIPT italic_i italic_t italic_e italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_m ∈ italic_M end_POSTSUBSCRIPT italic_γ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT blackboard_x start_POSTSUPERSCRIPT italic_i italic_t italic_e italic_m start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ]</annotation></semantics></math>. Loss for query-item relevance binary classification task is <math alttext="\mathcal{L}_{query-item}=\sum\mathcal{L}_{ce}(y^{qi}_{l};\mathbb{x}^{query}_{l%
},\sum_{m\in M}\gamma_{m}\mathbb{x}^{item^{(m)}}_{l})" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px2.p4.2.m2.4"><semantics id="S3.SS3.SSS1.Px2.p4.2.m2.4a"><mrow id="S3.SS3.SSS1.Px2.p4.2.m2.4.4" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.cmml"><msub id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.2" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.2.cmml">ℒ</mi><mrow id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.cmml"><mrow id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.cmml"><mi id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.2" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.2.cmml">q</mi><mo id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.1" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.3.cmml">u</mi><mo id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.1a" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.4" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.4.cmml">e</mi><mo id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.1b" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.5" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.5.cmml">r</mi><mo id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.1c" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.6" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.6.cmml">y</mi></mrow><mo id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.1" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.1.cmml">−</mo><mrow id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.cmml"><mi id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.2" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.2.cmml">i</mi><mo id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.1" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.3.cmml">t</mi><mo id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.1a" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.4" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.4.cmml">e</mi><mo id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.1b" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.5" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.5.cmml">m</mi></mrow></mrow></msub><mo id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.4" rspace="0.111em" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.4.cmml">=</mo><mrow id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.cmml"><mo id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.4" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.4.cmml">∑</mo><mrow id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.cmml"><msub id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.2" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.2.cmml">ℒ</mi><mrow id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.3.cmml"><mi id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.3.2" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.3.2.cmml">c</mi><mo id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.3.1" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.3.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.3.3.cmml">e</mi></mrow></msub><mo id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.4" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.4.cmml">⁢</mo><mrow id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.4.cmml"><mo id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.4" stretchy="false" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.4.cmml">(</mo><msubsup id="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1" xref="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.2" xref="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.3.cmml">l</mi><mrow id="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.3.cmml"><mi id="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.3.2" xref="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.3.2.cmml">q</mi><mo id="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.3.1" xref="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.3.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.3.3.cmml">i</mi></mrow></msubsup><mo id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.5" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.4.cmml">;</mo><msubsup id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.2" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.3.cmml">l</mi><mrow id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.cmml"><mi id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.2" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.2.cmml">q</mi><mo id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.1" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.3.cmml">u</mi><mo id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.1a" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.4" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.4.cmml">e</mi><mo id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.1b" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.5" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.5.cmml">r</mi><mo id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.1c" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.6" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.6.cmml">y</mi></mrow></msubsup><mo id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.6" rspace="0em" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.4.cmml">,</mo><mrow id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.cmml"><msub id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.cmml"><mo id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.2" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.2.cmml">∑</mo><mrow id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.3.cmml"><mi id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.3.2" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.3.2.cmml">m</mi><mo id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.3.1" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.3.1.cmml">∈</mo><mi id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.3.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.3.3.cmml">M</mi></mrow></msub><mrow id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.cmml"><msub id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.2" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.2.cmml"><mi id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.2.2" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.2.2.cmml">γ</mi><mi id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.2.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.2.3.cmml">m</mi></msub><mo id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.1" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.1.cmml">⁢</mo><msubsup id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.3.cmml"><mi id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.3.2.2" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.3.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.3.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.3.3.cmml">l</mi><mrow id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.cmml"><mi id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.3.cmml">i</mi><mo id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.2" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.4" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.4.cmml">t</mi><mo id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.2a" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.5" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.5.cmml">e</mi><mo id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.2b" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.2.cmml">⁢</mo><msup id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.6" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.6.cmml"><mi id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.6.2" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.6.2.cmml">m</mi><mrow id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.1.1.3" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.6.cmml"><mo id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.6.cmml">(</mo><mi id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.1.1.1" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.1.1.1.cmml">m</mi><mo id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.6.cmml">)</mo></mrow></msup></mrow></msubsup></mrow></mrow><mo id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.7" stretchy="false" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px2.p4.2.m2.4b"><apply id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4"><eq id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.4.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.4"></eq><apply id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5">subscript</csymbol><ci id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.2">ℒ</ci><apply id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3"><minus id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.1"></minus><apply id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2"><times id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.1"></times><ci id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.2">𝑞</ci><ci id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.3">𝑢</ci><ci id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.4.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.4">𝑒</ci><ci id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.5.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.5">𝑟</ci><ci id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.6.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.2.6">𝑦</ci></apply><apply id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3"><times id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.1"></times><ci id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.2">𝑖</ci><ci id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.3">𝑡</ci><ci id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.4.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.4">𝑒</ci><ci id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.5.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.5.3.3.5">𝑚</ci></apply></apply></apply><apply id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3"><sum id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.4.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.4"></sum><apply id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3"><times id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.4.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.4"></times><apply id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5">subscript</csymbol><ci id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.2">ℒ</ci><apply id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.3"><times id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.3.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.3.1"></times><ci id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.3.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.3.2">𝑐</ci><ci id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.3.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.5.3.3">𝑒</ci></apply></apply><list id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.4.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3"><apply id="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.2">𝑦</ci><apply id="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.3"><times id="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.3.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.3.1"></times><ci id="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.3.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.3.2">𝑞</ci><ci id="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.3.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.2.2.1.1.1.1.1.3">𝑙</ci></apply><apply id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2">subscript</csymbol><apply id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2">superscript</csymbol><ci id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.2">𝕩</ci><apply id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3"><times id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.1"></times><ci id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.2">𝑞</ci><ci id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.3">𝑢</ci><ci id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.4.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.4">𝑒</ci><ci id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.5.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.5">𝑟</ci><ci id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.6.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.2.3.6">𝑦</ci></apply></apply><ci id="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.3.3.2.2.2.2.2.3">𝑙</ci></apply><apply id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3"><apply id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1">subscript</csymbol><sum id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.2"></sum><apply id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.3"><in id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.3.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.3.1"></in><ci id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.3.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.3.2">𝑚</ci><ci id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.3.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.1.3.3">𝑀</ci></apply></apply><apply id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2"><times id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.1"></times><apply id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.2.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.2.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.2.2">𝛾</ci><ci id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.2.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.2.3">𝑚</ci></apply><apply id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.3.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.3">subscript</csymbol><apply id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.3.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.3.2.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.3">superscript</csymbol><ci id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.3.2.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.3.2.2">𝕩</ci><apply id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1"><times id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.2"></times><ci id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.3">𝑖</ci><ci id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.4.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.4">𝑡</ci><ci id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.5.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.5">𝑒</ci><apply id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.6.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.6"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.6.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.6">superscript</csymbol><ci id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.6.2.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.6.2">𝑚</ci><ci id="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.1.1.1.1.1.1">𝑚</ci></apply></apply></apply><ci id="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.3.3.cmml" xref="S3.SS3.SSS1.Px2.p4.2.m2.4.4.3.3.3.3.3.2.3.3">𝑙</ci></apply></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px2.p4.2.m2.4c">\mathcal{L}_{query-item}=\sum\mathcal{L}_{ce}(y^{qi}_{l};\mathbb{x}^{query}_{l%
},\sum_{m\in M}\gamma_{m}\mathbb{x}^{item^{(m)}}_{l})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px2.p4.2.m2.4d">caligraphic_L start_POSTSUBSCRIPT italic_q italic_u italic_e italic_r italic_y - italic_i italic_t italic_e italic_m end_POSTSUBSCRIPT = ∑ caligraphic_L start_POSTSUBSCRIPT italic_c italic_e end_POSTSUBSCRIPT ( italic_y start_POSTSUPERSCRIPT italic_q italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ; blackboard_x start_POSTSUPERSCRIPT italic_q italic_u italic_e italic_r italic_y end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , ∑ start_POSTSUBSCRIPT italic_m ∈ italic_M end_POSTSUBSCRIPT italic_γ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT blackboard_x start_POSTSUPERSCRIPT italic_i italic_t italic_e italic_m start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT )</annotation></semantics></math>. <math alttext="y^{qi}_{l}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px2.p4.3.m3.1"><semantics id="S3.SS3.SSS1.Px2.p4.3.m3.1a"><msubsup id="S3.SS3.SSS1.Px2.p4.3.m3.1.1" xref="S3.SS3.SSS1.Px2.p4.3.m3.1.1.cmml"><mi id="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.2" xref="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.2.cmml">y</mi><mi id="S3.SS3.SSS1.Px2.p4.3.m3.1.1.3" xref="S3.SS3.SSS1.Px2.p4.3.m3.1.1.3.cmml">l</mi><mrow id="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.3" xref="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.3.cmml"><mi id="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.3.2" xref="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.3.2.cmml">q</mi><mo id="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.3.1" xref="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.3.3" xref="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.3.3.cmml">i</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px2.p4.3.m3.1b"><apply id="S3.SS3.SSS1.Px2.p4.3.m3.1.1.cmml" xref="S3.SS3.SSS1.Px2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.3.m3.1.1.1.cmml" xref="S3.SS3.SSS1.Px2.p4.3.m3.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.cmml" xref="S3.SS3.SSS1.Px2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px2.p4.3.m3.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.2">𝑦</ci><apply id="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.3.cmml" xref="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.3"><times id="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.3.1.cmml" xref="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.3.1"></times><ci id="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.3.2.cmml" xref="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.3.2">𝑞</ci><ci id="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.3.3.cmml" xref="S3.SS3.SSS1.Px2.p4.3.m3.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S3.SS3.SSS1.Px2.p4.3.m3.1.1.3.cmml" xref="S3.SS3.SSS1.Px2.p4.3.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px2.p4.3.m3.1c">y^{qi}_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px2.p4.3.m3.1d">italic_y start_POSTSUPERSCRIPT italic_q italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> denotes relevance label of the l-th pair in the sequence. Positive label is assigned to the correct query-item pair and negative label is assigned to randomly sampled irrelevant query-item pair.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS1.Px3">
<h5 class="ltx_title ltx_font_bold ltx_title_paragraph">Loss of Pretraining Search Unit</h5>
<div class="ltx_para" id="S3.SS3.SSS1.Px3.p1">
<p class="ltx_p" id="S3.SS3.SSS1.Px3.p1.4">The objective of Pretraining Search Unit (PSU) consists of three parts, the next query-item pair prediction loss <math alttext="\mathcal{L}^{pair}_{next}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px3.p1.1.m1.1"><semantics id="S3.SS3.SSS1.Px3.p1.1.m1.1a"><msubsup id="S3.SS3.SSS1.Px3.p1.1.m1.1.1" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.2" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.2.cmml">ℒ</mi><mrow id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.2" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.2.cmml">n</mi><mo id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.1" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.3" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.3.cmml">e</mi><mo id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.1a" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.4" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.4.cmml">x</mi><mo id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.1b" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.5" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.5.cmml">t</mi></mrow><mrow id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.cmml"><mi id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.2" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.2.cmml">p</mi><mo id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.1" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.3" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.3.cmml">a</mi><mo id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.1a" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.4" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.4.cmml">i</mi><mo id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.1b" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.5" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.5.cmml">r</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px3.p1.1.m1.1b"><apply id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.2">ℒ</ci><apply id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3"><times id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.1.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.1"></times><ci id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.2.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.2">𝑝</ci><ci id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.3.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.3">𝑎</ci><ci id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.4.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.4">𝑖</ci><ci id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.5.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.3.5">𝑟</ci></apply></apply><apply id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3"><times id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.1"></times><ci id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.2">𝑛</ci><ci id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.3">𝑒</ci><ci id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.4.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.4">𝑥</ci><ci id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.5.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px3.p1.1.m1.1c">\mathcal{L}^{pair}_{next}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px3.p1.1.m1.1d">caligraphic_L start_POSTSUPERSCRIPT italic_p italic_a italic_i italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n italic_e italic_x italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, multi-modal alignment loss <math alttext="\mathcal{L}_{align}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px3.p1.2.m2.1"><semantics id="S3.SS3.SSS1.Px3.p1.2.m2.1a"><msub id="S3.SS3.SSS1.Px3.p1.2.m2.1.1" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.2" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.2.cmml">ℒ</mi><mrow id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.cmml"><mi id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.2" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.2.cmml">a</mi><mo id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.1" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.3" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.3.cmml">l</mi><mo id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.1a" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.4" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.4.cmml">i</mi><mo id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.1b" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.5" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.5.cmml">g</mi><mo id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.1c" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.6" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px3.p1.2.m2.1b"><apply id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.2">ℒ</ci><apply id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3"><times id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.1"></times><ci id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.2">𝑎</ci><ci id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.3">𝑙</ci><ci id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.4.cmml" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.4">𝑖</ci><ci id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.5.cmml" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.5">𝑔</ci><ci id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.6.cmml" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px3.p1.2.m2.1c">\mathcal{L}_{align}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px3.p1.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT italic_a italic_l italic_i italic_g italic_n end_POSTSUBSCRIPT</annotation></semantics></math> and the query-item relevance prediction loss <math alttext="\mathcal{L}_{query-item}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px3.p1.3.m3.1"><semantics id="S3.SS3.SSS1.Px3.p1.3.m3.1a"><msub id="S3.SS3.SSS1.Px3.p1.3.m3.1.1" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.2" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.2.cmml">ℒ</mi><mrow id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.cmml"><mrow id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.cmml"><mi id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.2" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.2.cmml">q</mi><mo id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.1" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.3" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.3.cmml">u</mi><mo id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.1a" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.4" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.4.cmml">e</mi><mo id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.1b" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.5" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.5.cmml">r</mi><mo id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.1c" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.6" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.6.cmml">y</mi></mrow><mo id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.1" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.1.cmml">−</mo><mrow id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.cmml"><mi id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.2" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.2.cmml">i</mi><mo id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.1" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.3" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.3.cmml">t</mi><mo id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.1a" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.4" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.4.cmml">e</mi><mo id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.1b" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.5" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.5.cmml">m</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px3.p1.3.m3.1b"><apply id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.2">ℒ</ci><apply id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3"><minus id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.1"></minus><apply id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2"><times id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.1.cmml" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.1"></times><ci id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.2.cmml" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.2">𝑞</ci><ci id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.3.cmml" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.3">𝑢</ci><ci id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.4.cmml" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.4">𝑒</ci><ci id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.5.cmml" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.5">𝑟</ci><ci id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.6.cmml" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.2.6">𝑦</ci></apply><apply id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3"><times id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.1"></times><ci id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.2">𝑖</ci><ci id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.3">𝑡</ci><ci id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.4.cmml" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.4">𝑒</ci><ci id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.5.cmml" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.3.3.5">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px3.p1.3.m3.1c">\mathcal{L}_{query-item}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px3.p1.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT italic_q italic_u italic_e italic_r italic_y - italic_i italic_t italic_e italic_m end_POSTSUBSCRIPT</annotation></semantics></math>. <math alttext="\mathcal{L}_{PSU}=\mathcal{L}^{pair}_{next}+\mathcal{L}_{align}+\mathcal{L}_{%
query-item}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px3.p1.4.m4.1"><semantics id="S3.SS3.SSS1.Px3.p1.4.m4.1a"><mrow id="S3.SS3.SSS1.Px3.p1.4.m4.1.1" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.cmml"><msub id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.2" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.2.cmml">ℒ</mi><mrow id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3.cmml"><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3.2" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3.2.cmml">P</mi><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3.1" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3.3" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3.3.cmml">S</mi><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3.1a" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3.4" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3.4.cmml">U</mi></mrow></msub><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.1" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.cmml"><msubsup id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.2" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.2.cmml">ℒ</mi><mrow id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.cmml"><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.2" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.2.cmml">n</mi><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.1" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.3" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.3.cmml">e</mi><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.1a" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.4" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.4.cmml">x</mi><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.1b" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.5" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.5.cmml">t</mi></mrow><mrow id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.cmml"><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.2" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.2.cmml">p</mi><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.1" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.3" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.3.cmml">a</mi><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.1a" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.4" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.4.cmml">i</mi><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.1b" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.5" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.5.cmml">r</mi></mrow></msubsup><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.1" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.1.cmml">+</mo><msub id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.2" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.2.cmml">ℒ</mi><mrow id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.2" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.2.cmml">a</mi><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.1" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.3" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.3.cmml">l</mi><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.1a" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.4" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.4.cmml">i</mi><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.1b" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.5" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.5.cmml">g</mi><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.1c" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.6" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.6.cmml">n</mi></mrow></msub><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.1a" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.1.cmml">+</mo><msub id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.2" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.2.cmml">ℒ</mi><mrow id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.cmml"><mrow id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.cmml"><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.2" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.2.cmml">q</mi><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.1" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.3" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.3.cmml">u</mi><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.1a" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.4" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.4.cmml">e</mi><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.1b" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.5" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.5.cmml">r</mi><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.1c" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.6" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.6.cmml">y</mi></mrow><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.1" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.1.cmml">−</mo><mrow id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.cmml"><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.2" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.2.cmml">i</mi><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.1" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.3" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.3.cmml">t</mi><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.1a" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.4" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.4.cmml">e</mi><mo id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.1b" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.5" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.5.cmml">m</mi></mrow></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px3.p1.4.m4.1b"><apply id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1"><eq id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.1"></eq><apply id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.2">ℒ</ci><apply id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3"><times id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3.1.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3.1"></times><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3.2.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3.2">𝑃</ci><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3.3.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3.3">𝑆</ci><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3.4.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.2.3.4">𝑈</ci></apply></apply><apply id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3"><plus id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.1"></plus><apply id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.1.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2">subscript</csymbol><apply id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.1.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2">superscript</csymbol><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.2.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.2">ℒ</ci><apply id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3"><times id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.1.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.1"></times><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.2.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.2">𝑝</ci><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.3.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.3">𝑎</ci><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.4.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.4">𝑖</ci><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.5.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.2.3.5">𝑟</ci></apply></apply><apply id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3"><times id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.1.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.1"></times><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.2.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.2">𝑛</ci><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.3.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.3">𝑒</ci><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.4.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.4">𝑥</ci><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.5.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.2.3.5">𝑡</ci></apply></apply><apply id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.2">ℒ</ci><apply id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3"><times id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.1"></times><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.2">𝑎</ci><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.3">𝑙</ci><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.4.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.4">𝑖</ci><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.5.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.5">𝑔</ci><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.6.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.3.3.6">𝑛</ci></apply></apply><apply id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.1.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4">subscript</csymbol><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.2.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.2">ℒ</ci><apply id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3"><minus id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.1.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.1"></minus><apply id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2"><times id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.1.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.1"></times><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.2.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.2">𝑞</ci><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.3.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.3">𝑢</ci><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.4.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.4">𝑒</ci><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.5.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.5">𝑟</ci><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.6.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.2.6">𝑦</ci></apply><apply id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3"><times id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.1.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.1"></times><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.2.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.2">𝑖</ci><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.3.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.3">𝑡</ci><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.4.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.4">𝑒</ci><ci id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.5.cmml" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.3.4.3.3.5">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px3.p1.4.m4.1c">\mathcal{L}_{PSU}=\mathcal{L}^{pair}_{next}+\mathcal{L}_{align}+\mathcal{L}_{%
query-item}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px3.p1.4.m4.1d">caligraphic_L start_POSTSUBSCRIPT italic_P italic_S italic_U end_POSTSUBSCRIPT = caligraphic_L start_POSTSUPERSCRIPT italic_p italic_a italic_i italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n italic_e italic_x italic_t end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT italic_a italic_l italic_i italic_g italic_n end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT italic_q italic_u italic_e italic_r italic_y - italic_i italic_t italic_e italic_m end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2. </span>Fine-tuning the projection weight</h4>
<div class="ltx_para" id="S3.SS3.SSS2.p1">
<p class="ltx_p" id="S3.SS3.SSS2.p1.4">Existing lifelong sequence modeling methods follow a cascading two-stage paradigm. In the first stage, target item or query is used as trigger to retrieve the most relevant top-K items from the users’ long behaviors sequence and reduce the sequence length from <math alttext="L" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.1.m1.1"><semantics id="S3.SS3.SSS2.p1.1.m1.1a"><mi id="S3.SS3.SSS2.p1.1.m1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.1.m1.1b"><ci id="S3.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.1.m1.1d">italic_L</annotation></semantics></math> to <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.2.m2.1"><semantics id="S3.SS3.SSS2.p1.2.m2.1a"><mi id="S3.SS3.SSS2.p1.2.m2.1.1" xref="S3.SS3.SSS2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.2.m2.1b"><ci id="S3.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.2.m2.1d">italic_K</annotation></semantics></math>, such as the General Search Unit (GSU) in SIM <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib13" title="">2020</a>)</cite>, TWIN <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib3" title="">2023</a>)</cite>, and Relevance Search Unit (RSU) in QIN <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib9" title="">2023</a>)</cite>. In the second stage, a multi head target attention (MHTA) unit in Exact Search Unit (ESU) is applied to encode the selected <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.3.m3.1"><semantics id="S3.SS3.SSS2.p1.3.m3.1a"><mi id="S3.SS3.SSS2.p1.3.m3.1.1" xref="S3.SS3.SSS2.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.3.m3.1b"><ci id="S3.SS3.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.3.m3.1d">italic_K</annotation></semantics></math> relevant items as the representation of users’ behavior sequence. However, existing cascading two-stage paradigm suffers from the insufficient learning problem of ID embedding in the lifelong sequence (<math alttext="[\mathbb{x}^{query},\mathbb{x}^{text},\mathbb{x}^{image},^{attributes}]" class="ltx_math_unparsed" display="inline" id="S3.SS3.SSS2.p1.4.m4.1"><semantics id="S3.SS3.SSS2.p1.4.m4.1a"><mrow id="S3.SS3.SSS2.p1.4.m4.1b"><mo id="S3.SS3.SSS2.p1.4.m4.1.1" stretchy="false">[</mo><msup id="S3.SS3.SSS2.p1.4.m4.1.2"><mi id="S3.SS3.SSS2.p1.4.m4.1.2.2">𝕩</mi><mrow id="S3.SS3.SSS2.p1.4.m4.1.2.3"><mi id="S3.SS3.SSS2.p1.4.m4.1.2.3.2">q</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.2.3.1">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.2.3.3">u</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.2.3.1a">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.2.3.4">e</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.2.3.1b">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.2.3.5">r</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.2.3.1c">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.2.3.6">y</mi></mrow></msup><mo id="S3.SS3.SSS2.p1.4.m4.1.3">,</mo><msup id="S3.SS3.SSS2.p1.4.m4.1.4"><mi id="S3.SS3.SSS2.p1.4.m4.1.4.2">𝕩</mi><mrow id="S3.SS3.SSS2.p1.4.m4.1.4.3"><mi id="S3.SS3.SSS2.p1.4.m4.1.4.3.2">t</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.4.3.1">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.4.3.3">e</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.4.3.1a">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.4.3.4">x</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.4.3.1b">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.4.3.5">t</mi></mrow></msup><mo id="S3.SS3.SSS2.p1.4.m4.1.5">,</mo><msup id="S3.SS3.SSS2.p1.4.m4.1.6"><mi id="S3.SS3.SSS2.p1.4.m4.1.6.2">𝕩</mi><mrow id="S3.SS3.SSS2.p1.4.m4.1.6.3"><mi id="S3.SS3.SSS2.p1.4.m4.1.6.3.2">i</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.6.3.1">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.6.3.3">m</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.6.3.1a">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.6.3.4">a</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.6.3.1b">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.6.3.5">g</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.6.3.1c">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.6.3.6">e</mi></mrow></msup><msup id="S3.SS3.SSS2.p1.4.m4.1.7"><mo id="S3.SS3.SSS2.p1.4.m4.1.7.2">,</mo><mrow id="S3.SS3.SSS2.p1.4.m4.1.7.3"><mi id="S3.SS3.SSS2.p1.4.m4.1.7.3.2">a</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.7.3.1">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.7.3.3">t</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.7.3.1a">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.7.3.4">t</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.7.3.1b">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.7.3.5">r</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.7.3.1c">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.7.3.6">i</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.7.3.1d">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.7.3.7">b</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.7.3.1e">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.7.3.8">u</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.7.3.1f">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.7.3.9">t</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.7.3.1g">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.7.3.10">e</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.7.3.1h">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.7.3.11">s</mi></mrow></msup><mo id="S3.SS3.SSS2.p1.4.m4.1.8" stretchy="false">]</mo></mrow><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.4.m4.1c">[\mathbb{x}^{query},\mathbb{x}^{text},\mathbb{x}^{image},^{attributes}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.4.m4.1d">[ blackboard_x start_POSTSUPERSCRIPT italic_q italic_u italic_e italic_r italic_y end_POSTSUPERSCRIPT , blackboard_x start_POSTSUPERSCRIPT italic_t italic_e italic_x italic_t end_POSTSUPERSCRIPT , blackboard_x start_POSTSUPERSCRIPT italic_i italic_m italic_a italic_g italic_e end_POSTSUPERSCRIPT , start_POSTSUPERSCRIPT italic_a italic_t italic_t italic_r italic_i italic_b italic_u italic_t italic_e italic_s end_POSTSUPERSCRIPT ]</annotation></semantics></math>). The downstream model, e.g. CTR prediction, lacks of enough training data to learn the embedding in the sequence well. Especially when some low-frequency items in the sequence exist a long time ago (more than one year) and don’t exist in the training data, which are collected from most recently users’ logs.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p2">
<p class="ltx_p" id="S3.SS3.SSS2.p2.7">To help alleviate the insufficient learning problem of ID embedding in the lifelong sequence, the general search unit (GSU) in our proposed SEMINAR model shares the same multi-head target attention structure <math alttext="head^{GSU_{h}}=\text{Attention}_{h}(q_{t},K^{GSU},V^{GSU})" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.1.m1.3"><semantics id="S3.SS3.SSS2.p2.1.m1.3a"><mrow id="S3.SS3.SSS2.p2.1.m1.3.3" xref="S3.SS3.SSS2.p2.1.m1.3.3.cmml"><mrow id="S3.SS3.SSS2.p2.1.m1.3.3.5" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.3.3.5.2" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.2.cmml">h</mi><mo id="S3.SS3.SSS2.p2.1.m1.3.3.5.1" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.1.m1.3.3.5.3" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.3.cmml">e</mi><mo id="S3.SS3.SSS2.p2.1.m1.3.3.5.1a" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.1.m1.3.3.5.4" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.4.cmml">a</mi><mo id="S3.SS3.SSS2.p2.1.m1.3.3.5.1b" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.1.cmml">⁢</mo><msup id="S3.SS3.SSS2.p2.1.m1.3.3.5.5" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.3.3.5.5.2" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5.2.cmml">d</mi><mrow id="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.2" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.2.cmml">G</mi><mo id="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.1" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.3" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.1a" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.1.cmml">⁢</mo><msub id="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.4" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.4.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.4.2" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.4.2.cmml">U</mi><mi id="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.4.3" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.4.3.cmml">h</mi></msub></mrow></msup></mrow><mo id="S3.SS3.SSS2.p2.1.m1.3.3.4" xref="S3.SS3.SSS2.p2.1.m1.3.3.4.cmml">=</mo><mrow id="S3.SS3.SSS2.p2.1.m1.3.3.3" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.cmml"><msub id="S3.SS3.SSS2.p2.1.m1.3.3.3.5" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.5.cmml"><mtext id="S3.SS3.SSS2.p2.1.m1.3.3.3.5.2" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.5.2a.cmml">Attention</mtext><mi id="S3.SS3.SSS2.p2.1.m1.3.3.3.5.3" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.5.3.cmml">h</mi></msub><mo id="S3.SS3.SSS2.p2.1.m1.3.3.3.4" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.4.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.4.cmml"><mo id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.4" stretchy="false" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.4.cmml">(</mo><msub id="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.1" xref="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.cmml">q</mi><mi id="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.5" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.4.cmml">,</mo><msup id="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2" xref="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.2" xref="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.2.cmml">K</mi><mrow id="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3" xref="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3.2" xref="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3.2.cmml">G</mi><mo id="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3.1" xref="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3.3" xref="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3.1a" xref="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3.4" xref="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3.4.cmml">U</mi></mrow></msup><mo id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.6" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.4.cmml">,</mo><msup id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.2" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.2.cmml">V</mi><mrow id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3.2" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3.2.cmml">G</mi><mo id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3.1" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3.3" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3.1a" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3.4" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3.4.cmml">U</mi></mrow></msup><mo id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.7" stretchy="false" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.1.m1.3b"><apply id="S3.SS3.SSS2.p2.1.m1.3.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3"><eq id="S3.SS3.SSS2.p2.1.m1.3.3.4.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.4"></eq><apply id="S3.SS3.SSS2.p2.1.m1.3.3.5.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.5"><times id="S3.SS3.SSS2.p2.1.m1.3.3.5.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.1"></times><ci id="S3.SS3.SSS2.p2.1.m1.3.3.5.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.2">ℎ</ci><ci id="S3.SS3.SSS2.p2.1.m1.3.3.5.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.3">𝑒</ci><ci id="S3.SS3.SSS2.p2.1.m1.3.3.5.4.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.4">𝑎</ci><apply id="S3.SS3.SSS2.p2.1.m1.3.3.5.5.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.1.m1.3.3.5.5.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5">superscript</csymbol><ci id="S3.SS3.SSS2.p2.1.m1.3.3.5.5.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5.2">𝑑</ci><apply id="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3"><times id="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.1"></times><ci id="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.2">𝐺</ci><ci id="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.3">𝑆</ci><apply id="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.4.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.4.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.4">subscript</csymbol><ci id="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.4.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.4.2">𝑈</ci><ci id="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.4.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.5.5.3.4.3">ℎ</ci></apply></apply></apply></apply><apply id="S3.SS3.SSS2.p2.1.m1.3.3.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.3"><times id="S3.SS3.SSS2.p2.1.m1.3.3.3.4.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.4"></times><apply id="S3.SS3.SSS2.p2.1.m1.3.3.3.5.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.5"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.1.m1.3.3.3.5.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.5">subscript</csymbol><ci id="S3.SS3.SSS2.p2.1.m1.3.3.3.5.2a.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.5.2"><mtext id="S3.SS3.SSS2.p2.1.m1.3.3.3.5.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.5.2">Attention</mtext></ci><ci id="S3.SS3.SSS2.p2.1.m1.3.3.3.5.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.5.3">ℎ</ci></apply><vector id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.4.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3"><apply id="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2">𝑞</ci><ci id="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2">superscript</csymbol><ci id="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.2">𝐾</ci><apply id="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3"><times id="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3.1"></times><ci id="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3.2">𝐺</ci><ci id="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3.3">𝑆</ci><ci id="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3.4.cmml" xref="S3.SS3.SSS2.p2.1.m1.2.2.2.2.2.2.3.4">𝑈</ci></apply></apply><apply id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3">superscript</csymbol><ci id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.2">𝑉</ci><apply id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3"><times id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3.1"></times><ci id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3.2">𝐺</ci><ci id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3.3">𝑆</ci><ci id="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3.4.cmml" xref="S3.SS3.SSS2.p2.1.m1.3.3.3.3.3.3.3.4">𝑈</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.1.m1.3c">head^{GSU_{h}}=\text{Attention}_{h}(q_{t},K^{GSU},V^{GSU})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.1.m1.3d">italic_h italic_e italic_a italic_d start_POSTSUPERSCRIPT italic_G italic_S italic_U start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT = Attention start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_K start_POSTSUPERSCRIPT italic_G italic_S italic_U end_POSTSUPERSCRIPT , italic_V start_POSTSUPERSCRIPT italic_G italic_S italic_U end_POSTSUPERSCRIPT )</annotation></semantics></math> with the structure in PSU as <math alttext="head^{PSU_{h}}=\text{Attention}(q_{t},K^{PSU},V^{PSU})" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.2.m2.3"><semantics id="S3.SS3.SSS2.p2.2.m2.3a"><mrow id="S3.SS3.SSS2.p2.2.m2.3.3" xref="S3.SS3.SSS2.p2.2.m2.3.3.cmml"><mrow id="S3.SS3.SSS2.p2.2.m2.3.3.5" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.cmml"><mi id="S3.SS3.SSS2.p2.2.m2.3.3.5.2" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.2.cmml">h</mi><mo id="S3.SS3.SSS2.p2.2.m2.3.3.5.1" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.2.m2.3.3.5.3" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.3.cmml">e</mi><mo id="S3.SS3.SSS2.p2.2.m2.3.3.5.1a" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.2.m2.3.3.5.4" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.4.cmml">a</mi><mo id="S3.SS3.SSS2.p2.2.m2.3.3.5.1b" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.1.cmml">⁢</mo><msup id="S3.SS3.SSS2.p2.2.m2.3.3.5.5" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5.cmml"><mi id="S3.SS3.SSS2.p2.2.m2.3.3.5.5.2" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5.2.cmml">d</mi><mrow id="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.cmml"><mi id="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.2" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.2.cmml">P</mi><mo id="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.1" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.3" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.1a" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.1.cmml">⁢</mo><msub id="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.4" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.4.cmml"><mi id="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.4.2" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.4.2.cmml">U</mi><mi id="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.4.3" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.4.3.cmml">h</mi></msub></mrow></msup></mrow><mo id="S3.SS3.SSS2.p2.2.m2.3.3.4" xref="S3.SS3.SSS2.p2.2.m2.3.3.4.cmml">=</mo><mrow id="S3.SS3.SSS2.p2.2.m2.3.3.3" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.cmml"><mtext id="S3.SS3.SSS2.p2.2.m2.3.3.3.5" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.5a.cmml">Attention</mtext><mo id="S3.SS3.SSS2.p2.2.m2.3.3.3.4" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.4.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.4.cmml"><mo id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.4" stretchy="false" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.4.cmml">(</mo><msub id="S3.SS3.SSS2.p2.2.m2.1.1.1.1.1.1" xref="S3.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.2.cmml">q</mi><mi id="S3.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.5" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.4.cmml">,</mo><msup id="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2" xref="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.2" xref="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.2.cmml">K</mi><mrow id="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3" xref="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3.cmml"><mi id="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3.2" xref="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3.2.cmml">P</mi><mo id="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3.1" xref="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3.3" xref="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3.1a" xref="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3.4" xref="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3.4.cmml">U</mi></mrow></msup><mo id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.6" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.4.cmml">,</mo><msup id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.cmml"><mi id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.2" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.2.cmml">V</mi><mrow id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3.cmml"><mi id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3.2" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3.2.cmml">P</mi><mo id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3.1" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3.3" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3.1a" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3.4" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3.4.cmml">U</mi></mrow></msup><mo id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.7" stretchy="false" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.2.m2.3b"><apply id="S3.SS3.SSS2.p2.2.m2.3.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3"><eq id="S3.SS3.SSS2.p2.2.m2.3.3.4.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.4"></eq><apply id="S3.SS3.SSS2.p2.2.m2.3.3.5.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.5"><times id="S3.SS3.SSS2.p2.2.m2.3.3.5.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.1"></times><ci id="S3.SS3.SSS2.p2.2.m2.3.3.5.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.2">ℎ</ci><ci id="S3.SS3.SSS2.p2.2.m2.3.3.5.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.3">𝑒</ci><ci id="S3.SS3.SSS2.p2.2.m2.3.3.5.4.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.4">𝑎</ci><apply id="S3.SS3.SSS2.p2.2.m2.3.3.5.5.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.2.m2.3.3.5.5.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5">superscript</csymbol><ci id="S3.SS3.SSS2.p2.2.m2.3.3.5.5.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5.2">𝑑</ci><apply id="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3"><times id="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.1"></times><ci id="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.2">𝑃</ci><ci id="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.3">𝑆</ci><apply id="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.4.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.4.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.4">subscript</csymbol><ci id="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.4.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.4.2">𝑈</ci><ci id="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.4.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.5.5.3.4.3">ℎ</ci></apply></apply></apply></apply><apply id="S3.SS3.SSS2.p2.2.m2.3.3.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.3"><times id="S3.SS3.SSS2.p2.2.m2.3.3.3.4.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.4"></times><ci id="S3.SS3.SSS2.p2.2.m2.3.3.3.5a.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.5"><mtext id="S3.SS3.SSS2.p2.2.m2.3.3.3.5.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.5">Attention</mtext></ci><vector id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.4.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3"><apply id="S3.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.2">𝑞</ci><ci id="S3.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2">superscript</csymbol><ci id="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.2">𝐾</ci><apply id="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3"><times id="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3.1"></times><ci id="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3.2">𝑃</ci><ci id="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3.3">𝑆</ci><ci id="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3.4.cmml" xref="S3.SS3.SSS2.p2.2.m2.2.2.2.2.2.2.3.4">𝑈</ci></apply></apply><apply id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3">superscript</csymbol><ci id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.2">𝑉</ci><apply id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3"><times id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3.1"></times><ci id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3.2">𝑃</ci><ci id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3.3">𝑆</ci><ci id="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3.4.cmml" xref="S3.SS3.SSS2.p2.2.m2.3.3.3.3.3.3.3.4">𝑈</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.2.m2.3c">head^{PSU_{h}}=\text{Attention}(q_{t},K^{PSU},V^{PSU})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.2.m2.3d">italic_h italic_e italic_a italic_d start_POSTSUPERSCRIPT italic_P italic_S italic_U start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT = Attention ( italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_K start_POSTSUPERSCRIPT italic_P italic_S italic_U end_POSTSUPERSCRIPT , italic_V start_POSTSUPERSCRIPT italic_P italic_S italic_U end_POSTSUPERSCRIPT )</annotation></semantics></math>, restores the pretrained embedding from PSU and applies specific projection weight matrix <math alttext="G^{(j)}\in\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.3.m3.1"><semantics id="S3.SS3.SSS2.p2.3.m3.1a"><mrow id="S3.SS3.SSS2.p2.3.m3.1.2" xref="S3.SS3.SSS2.p2.3.m3.1.2.cmml"><msup id="S3.SS3.SSS2.p2.3.m3.1.2.2" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.cmml"><mi id="S3.SS3.SSS2.p2.3.m3.1.2.2.2" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.2.cmml">G</mi><mrow id="S3.SS3.SSS2.p2.3.m3.1.1.1.3" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.cmml"><mo id="S3.SS3.SSS2.p2.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.cmml">(</mo><mi id="S3.SS3.SSS2.p2.3.m3.1.1.1.1" xref="S3.SS3.SSS2.p2.3.m3.1.1.1.1.cmml">j</mi><mo id="S3.SS3.SSS2.p2.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.cmml">)</mo></mrow></msup><mo id="S3.SS3.SSS2.p2.3.m3.1.2.1" xref="S3.SS3.SSS2.p2.3.m3.1.2.1.cmml">∈</mo><msup id="S3.SS3.SSS2.p2.3.m3.1.2.3" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.cmml"><mi id="S3.SS3.SSS2.p2.3.m3.1.2.3.2" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS2.p2.3.m3.1.2.3.3" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.3.cmml"><mi id="S3.SS3.SSS2.p2.3.m3.1.2.3.3.2" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.3.2.cmml">d</mi><mo id="S3.SS3.SSS2.p2.3.m3.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS2.p2.3.m3.1.2.3.3.3" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.3.m3.1b"><apply id="S3.SS3.SSS2.p2.3.m3.1.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2"><in id="S3.SS3.SSS2.p2.3.m3.1.2.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.1"></in><apply id="S3.SS3.SSS2.p2.3.m3.1.2.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.3.m3.1.2.2.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.2">superscript</csymbol><ci id="S3.SS3.SSS2.p2.3.m3.1.2.2.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.2">𝐺</ci><ci id="S3.SS3.SSS2.p2.3.m3.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.1.1">𝑗</ci></apply><apply id="S3.SS3.SSS2.p2.3.m3.1.2.3.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.3.m3.1.2.3.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.3">superscript</csymbol><ci id="S3.SS3.SSS2.p2.3.m3.1.2.3.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.2">ℝ</ci><apply id="S3.SS3.SSS2.p2.3.m3.1.2.3.3.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.3"><times id="S3.SS3.SSS2.p2.3.m3.1.2.3.3.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.3.1"></times><ci id="S3.SS3.SSS2.p2.3.m3.1.2.3.3.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.3.2">𝑑</ci><ci id="S3.SS3.SSS2.p2.3.m3.1.2.3.3.3.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.3.m3.1c">G^{(j)}\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.3.m3.1d">italic_G start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> to the pretrained embedding. After the first stage retrieval, the sequence length is reduced from <math alttext="L" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.4.m4.1"><semantics id="S3.SS3.SSS2.p2.4.m4.1a"><mi id="S3.SS3.SSS2.p2.4.m4.1.1" xref="S3.SS3.SSS2.p2.4.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.4.m4.1b"><ci id="S3.SS3.SSS2.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.4.m4.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.4.m4.1d">italic_L</annotation></semantics></math> to <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.5.m5.1"><semantics id="S3.SS3.SSS2.p2.5.m5.1a"><mi id="S3.SS3.SSS2.p2.5.m5.1.1" xref="S3.SS3.SSS2.p2.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.5.m5.1b"><ci id="S3.SS3.SSS2.p2.5.m5.1.1.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.5.m5.1d">italic_K</annotation></semantics></math>, the second stage ESU also shares the same multi-head target attention structure <math alttext="head^{ESU_{h}}=\text{Attention}(q_{t},K^{ESU},V^{ESU})" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.6.m6.3"><semantics id="S3.SS3.SSS2.p2.6.m6.3a"><mrow id="S3.SS3.SSS2.p2.6.m6.3.3" xref="S3.SS3.SSS2.p2.6.m6.3.3.cmml"><mrow id="S3.SS3.SSS2.p2.6.m6.3.3.5" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.cmml"><mi id="S3.SS3.SSS2.p2.6.m6.3.3.5.2" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.2.cmml">h</mi><mo id="S3.SS3.SSS2.p2.6.m6.3.3.5.1" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.6.m6.3.3.5.3" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.3.cmml">e</mi><mo id="S3.SS3.SSS2.p2.6.m6.3.3.5.1a" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.6.m6.3.3.5.4" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.4.cmml">a</mi><mo id="S3.SS3.SSS2.p2.6.m6.3.3.5.1b" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.1.cmml">⁢</mo><msup id="S3.SS3.SSS2.p2.6.m6.3.3.5.5" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5.cmml"><mi id="S3.SS3.SSS2.p2.6.m6.3.3.5.5.2" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5.2.cmml">d</mi><mrow id="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.cmml"><mi id="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.2" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.2.cmml">E</mi><mo id="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.1" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.3" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.1a" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.1.cmml">⁢</mo><msub id="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.4" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.4.cmml"><mi id="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.4.2" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.4.2.cmml">U</mi><mi id="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.4.3" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.4.3.cmml">h</mi></msub></mrow></msup></mrow><mo id="S3.SS3.SSS2.p2.6.m6.3.3.4" xref="S3.SS3.SSS2.p2.6.m6.3.3.4.cmml">=</mo><mrow id="S3.SS3.SSS2.p2.6.m6.3.3.3" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.cmml"><mtext id="S3.SS3.SSS2.p2.6.m6.3.3.3.5" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.5a.cmml">Attention</mtext><mo id="S3.SS3.SSS2.p2.6.m6.3.3.3.4" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.4.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.4.cmml"><mo id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.4" stretchy="false" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.4.cmml">(</mo><msub id="S3.SS3.SSS2.p2.6.m6.1.1.1.1.1.1" xref="S3.SS3.SSS2.p2.6.m6.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p2.6.m6.1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p2.6.m6.1.1.1.1.1.1.2.cmml">q</mi><mi id="S3.SS3.SSS2.p2.6.m6.1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p2.6.m6.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.5" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.4.cmml">,</mo><msup id="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2" xref="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.2" xref="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.2.cmml">K</mi><mrow id="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3" xref="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3.cmml"><mi id="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3.2" xref="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3.2.cmml">E</mi><mo id="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3.1" xref="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3.3" xref="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3.1a" xref="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3.4" xref="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3.4.cmml">U</mi></mrow></msup><mo id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.6" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.4.cmml">,</mo><msup id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.cmml"><mi id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.2" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.2.cmml">V</mi><mrow id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3.cmml"><mi id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3.2" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3.2.cmml">E</mi><mo id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3.1" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3.3" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3.1a" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3.4" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3.4.cmml">U</mi></mrow></msup><mo id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.7" stretchy="false" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.6.m6.3b"><apply id="S3.SS3.SSS2.p2.6.m6.3.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3"><eq id="S3.SS3.SSS2.p2.6.m6.3.3.4.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.4"></eq><apply id="S3.SS3.SSS2.p2.6.m6.3.3.5.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.5"><times id="S3.SS3.SSS2.p2.6.m6.3.3.5.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.1"></times><ci id="S3.SS3.SSS2.p2.6.m6.3.3.5.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.2">ℎ</ci><ci id="S3.SS3.SSS2.p2.6.m6.3.3.5.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.3">𝑒</ci><ci id="S3.SS3.SSS2.p2.6.m6.3.3.5.4.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.4">𝑎</ci><apply id="S3.SS3.SSS2.p2.6.m6.3.3.5.5.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.6.m6.3.3.5.5.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5">superscript</csymbol><ci id="S3.SS3.SSS2.p2.6.m6.3.3.5.5.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5.2">𝑑</ci><apply id="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3"><times id="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.1"></times><ci id="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.2">𝐸</ci><ci id="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.3">𝑆</ci><apply id="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.4.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.4.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.4">subscript</csymbol><ci id="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.4.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.4.2">𝑈</ci><ci id="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.4.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.5.5.3.4.3">ℎ</ci></apply></apply></apply></apply><apply id="S3.SS3.SSS2.p2.6.m6.3.3.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.3"><times id="S3.SS3.SSS2.p2.6.m6.3.3.3.4.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.4"></times><ci id="S3.SS3.SSS2.p2.6.m6.3.3.3.5a.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.5"><mtext id="S3.SS3.SSS2.p2.6.m6.3.3.3.5.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.5">Attention</mtext></ci><vector id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.4.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3"><apply id="S3.SS3.SSS2.p2.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.6.m6.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.6.m6.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.1.1.1.1.2">𝑞</ci><ci id="S3.SS3.SSS2.p2.6.m6.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2">superscript</csymbol><ci id="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.2">𝐾</ci><apply id="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3"><times id="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3.1"></times><ci id="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3.2">𝐸</ci><ci id="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3.3">𝑆</ci><ci id="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3.4.cmml" xref="S3.SS3.SSS2.p2.6.m6.2.2.2.2.2.2.3.4">𝑈</ci></apply></apply><apply id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3">superscript</csymbol><ci id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.2">𝑉</ci><apply id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3"><times id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3.1"></times><ci id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3.2">𝐸</ci><ci id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3.3">𝑆</ci><ci id="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3.4.cmml" xref="S3.SS3.SSS2.p2.6.m6.3.3.3.3.3.3.3.4">𝑈</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.6.m6.3c">head^{ESU_{h}}=\text{Attention}(q_{t},K^{ESU},V^{ESU})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.6.m6.3d">italic_h italic_e italic_a italic_d start_POSTSUPERSCRIPT italic_E italic_S italic_U start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT = Attention ( italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_K start_POSTSUPERSCRIPT italic_E italic_S italic_U end_POSTSUPERSCRIPT , italic_V start_POSTSUPERSCRIPT italic_E italic_S italic_U end_POSTSUPERSCRIPT )</annotation></semantics></math> with GSU and PSU, and has specific projection weight matrix <math alttext="W^{Q}_{h},W^{K}_{h},W^{V}_{h}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.7.m7.3"><semantics id="S3.SS3.SSS2.p2.7.m7.3a"><mrow id="S3.SS3.SSS2.p2.7.m7.3.3.3" xref="S3.SS3.SSS2.p2.7.m7.3.3.4.cmml"><msubsup id="S3.SS3.SSS2.p2.7.m7.1.1.1.1" xref="S3.SS3.SSS2.p2.7.m7.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p2.7.m7.1.1.1.1.2.2" xref="S3.SS3.SSS2.p2.7.m7.1.1.1.1.2.2.cmml">W</mi><mi id="S3.SS3.SSS2.p2.7.m7.1.1.1.1.3" xref="S3.SS3.SSS2.p2.7.m7.1.1.1.1.3.cmml">h</mi><mi id="S3.SS3.SSS2.p2.7.m7.1.1.1.1.2.3" xref="S3.SS3.SSS2.p2.7.m7.1.1.1.1.2.3.cmml">Q</mi></msubsup><mo id="S3.SS3.SSS2.p2.7.m7.3.3.3.4" xref="S3.SS3.SSS2.p2.7.m7.3.3.4.cmml">,</mo><msubsup id="S3.SS3.SSS2.p2.7.m7.2.2.2.2" xref="S3.SS3.SSS2.p2.7.m7.2.2.2.2.cmml"><mi id="S3.SS3.SSS2.p2.7.m7.2.2.2.2.2.2" xref="S3.SS3.SSS2.p2.7.m7.2.2.2.2.2.2.cmml">W</mi><mi id="S3.SS3.SSS2.p2.7.m7.2.2.2.2.3" xref="S3.SS3.SSS2.p2.7.m7.2.2.2.2.3.cmml">h</mi><mi id="S3.SS3.SSS2.p2.7.m7.2.2.2.2.2.3" xref="S3.SS3.SSS2.p2.7.m7.2.2.2.2.2.3.cmml">K</mi></msubsup><mo id="S3.SS3.SSS2.p2.7.m7.3.3.3.5" xref="S3.SS3.SSS2.p2.7.m7.3.3.4.cmml">,</mo><msubsup id="S3.SS3.SSS2.p2.7.m7.3.3.3.3" xref="S3.SS3.SSS2.p2.7.m7.3.3.3.3.cmml"><mi id="S3.SS3.SSS2.p2.7.m7.3.3.3.3.2.2" xref="S3.SS3.SSS2.p2.7.m7.3.3.3.3.2.2.cmml">W</mi><mi id="S3.SS3.SSS2.p2.7.m7.3.3.3.3.3" xref="S3.SS3.SSS2.p2.7.m7.3.3.3.3.3.cmml">h</mi><mi id="S3.SS3.SSS2.p2.7.m7.3.3.3.3.2.3" xref="S3.SS3.SSS2.p2.7.m7.3.3.3.3.2.3.cmml">V</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.7.m7.3b"><list id="S3.SS3.SSS2.p2.7.m7.3.3.4.cmml" xref="S3.SS3.SSS2.p2.7.m7.3.3.3"><apply id="S3.SS3.SSS2.p2.7.m7.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.7.m7.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p2.7.m7.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.7.m7.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p2.7.m7.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.1.1.2.2">𝑊</ci><ci id="S3.SS3.SSS2.p2.7.m7.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.1.1.2.3">𝑄</ci></apply><ci id="S3.SS3.SSS2.p2.7.m7.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.1.1.3">ℎ</ci></apply><apply id="S3.SS3.SSS2.p2.7.m7.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.7.m7.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.2.2.2.2">subscript</csymbol><apply id="S3.SS3.SSS2.p2.7.m7.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.7.m7.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.2.2.2.2">superscript</csymbol><ci id="S3.SS3.SSS2.p2.7.m7.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.2.2.2.2.2.2">𝑊</ci><ci id="S3.SS3.SSS2.p2.7.m7.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p2.7.m7.2.2.2.2.2.3">𝐾</ci></apply><ci id="S3.SS3.SSS2.p2.7.m7.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p2.7.m7.2.2.2.2.3">ℎ</ci></apply><apply id="S3.SS3.SSS2.p2.7.m7.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.7.m7.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.7.m7.3.3.3.3.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.3.3.3.3">subscript</csymbol><apply id="S3.SS3.SSS2.p2.7.m7.3.3.3.3.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.7.m7.3.3.3.3.2.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.3.3.3.3">superscript</csymbol><ci id="S3.SS3.SSS2.p2.7.m7.3.3.3.3.2.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.3.3.3.3.2.2">𝑊</ci><ci id="S3.SS3.SSS2.p2.7.m7.3.3.3.3.2.3.cmml" xref="S3.SS3.SSS2.p2.7.m7.3.3.3.3.2.3">𝑉</ci></apply><ci id="S3.SS3.SSS2.p2.7.m7.3.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.7.m7.3.3.3.3.3">ℎ</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.7.m7.3c">W^{Q}_{h},W^{K}_{h},W^{V}_{h}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.7.m7.3d">italic_W start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT , italic_W start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT , italic_W start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> of each head.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p3">
<p class="ltx_p" id="S3.SS3.SSS2.p3.6">GSU restores the pretrained query item multi-modal embedding <math alttext="[E^{PSU(Q)},E^{PSU(T)},E^{PSU(I)},E^{PSU(A)}]" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.1.m1.8"><semantics id="S3.SS3.SSS2.p3.1.m1.8a"><mrow id="S3.SS3.SSS2.p3.1.m1.8.8.4" xref="S3.SS3.SSS2.p3.1.m1.8.8.5.cmml"><mo id="S3.SS3.SSS2.p3.1.m1.8.8.4.5" stretchy="false" xref="S3.SS3.SSS2.p3.1.m1.8.8.5.cmml">[</mo><msup id="S3.SS3.SSS2.p3.1.m1.5.5.1.1" xref="S3.SS3.SSS2.p3.1.m1.5.5.1.1.cmml"><mi id="S3.SS3.SSS2.p3.1.m1.5.5.1.1.2" xref="S3.SS3.SSS2.p3.1.m1.5.5.1.1.2.cmml">E</mi><mrow id="S3.SS3.SSS2.p3.1.m1.1.1.1" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p3.1.m1.1.1.1.3" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.3.cmml">P</mi><mo id="S3.SS3.SSS2.p3.1.m1.1.1.1.2" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS2.p3.1.m1.1.1.1.4" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.4.cmml">S</mi><mo id="S3.SS3.SSS2.p3.1.m1.1.1.1.2a" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS2.p3.1.m1.1.1.1.5" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.5.cmml">U</mi><mo id="S3.SS3.SSS2.p3.1.m1.1.1.1.2b" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p3.1.m1.1.1.1.6.2" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.cmml"><mo id="S3.SS3.SSS2.p3.1.m1.1.1.1.6.2.1" stretchy="false" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS2.p3.1.m1.1.1.1.1" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.1.cmml">Q</mi><mo id="S3.SS3.SSS2.p3.1.m1.1.1.1.6.2.2" stretchy="false" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.cmml">)</mo></mrow></mrow></msup><mo id="S3.SS3.SSS2.p3.1.m1.8.8.4.6" xref="S3.SS3.SSS2.p3.1.m1.8.8.5.cmml">,</mo><msup id="S3.SS3.SSS2.p3.1.m1.6.6.2.2" xref="S3.SS3.SSS2.p3.1.m1.6.6.2.2.cmml"><mi id="S3.SS3.SSS2.p3.1.m1.6.6.2.2.2" xref="S3.SS3.SSS2.p3.1.m1.6.6.2.2.2.cmml">E</mi><mrow id="S3.SS3.SSS2.p3.1.m1.2.2.1" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.cmml"><mi id="S3.SS3.SSS2.p3.1.m1.2.2.1.3" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.3.cmml">P</mi><mo id="S3.SS3.SSS2.p3.1.m1.2.2.1.2" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS2.p3.1.m1.2.2.1.4" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.4.cmml">S</mi><mo id="S3.SS3.SSS2.p3.1.m1.2.2.1.2a" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS2.p3.1.m1.2.2.1.5" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.5.cmml">U</mi><mo id="S3.SS3.SSS2.p3.1.m1.2.2.1.2b" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p3.1.m1.2.2.1.6.2" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.cmml"><mo id="S3.SS3.SSS2.p3.1.m1.2.2.1.6.2.1" stretchy="false" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.cmml">(</mo><mi id="S3.SS3.SSS2.p3.1.m1.2.2.1.1" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.1.cmml">T</mi><mo id="S3.SS3.SSS2.p3.1.m1.2.2.1.6.2.2" stretchy="false" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.cmml">)</mo></mrow></mrow></msup><mo id="S3.SS3.SSS2.p3.1.m1.8.8.4.7" xref="S3.SS3.SSS2.p3.1.m1.8.8.5.cmml">,</mo><msup id="S3.SS3.SSS2.p3.1.m1.7.7.3.3" xref="S3.SS3.SSS2.p3.1.m1.7.7.3.3.cmml"><mi id="S3.SS3.SSS2.p3.1.m1.7.7.3.3.2" xref="S3.SS3.SSS2.p3.1.m1.7.7.3.3.2.cmml">E</mi><mrow id="S3.SS3.SSS2.p3.1.m1.3.3.1" xref="S3.SS3.SSS2.p3.1.m1.3.3.1.cmml"><mi id="S3.SS3.SSS2.p3.1.m1.3.3.1.3" xref="S3.SS3.SSS2.p3.1.m1.3.3.1.3.cmml">P</mi><mo id="S3.SS3.SSS2.p3.1.m1.3.3.1.2" xref="S3.SS3.SSS2.p3.1.m1.3.3.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS2.p3.1.m1.3.3.1.4" xref="S3.SS3.SSS2.p3.1.m1.3.3.1.4.cmml">S</mi><mo id="S3.SS3.SSS2.p3.1.m1.3.3.1.2a" xref="S3.SS3.SSS2.p3.1.m1.3.3.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS2.p3.1.m1.3.3.1.5" xref="S3.SS3.SSS2.p3.1.m1.3.3.1.5.cmml">U</mi><mo id="S3.SS3.SSS2.p3.1.m1.3.3.1.2b" xref="S3.SS3.SSS2.p3.1.m1.3.3.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p3.1.m1.3.3.1.6.2" xref="S3.SS3.SSS2.p3.1.m1.3.3.1.cmml"><mo id="S3.SS3.SSS2.p3.1.m1.3.3.1.6.2.1" stretchy="false" xref="S3.SS3.SSS2.p3.1.m1.3.3.1.cmml">(</mo><mi id="S3.SS3.SSS2.p3.1.m1.3.3.1.1" xref="S3.SS3.SSS2.p3.1.m1.3.3.1.1.cmml">I</mi><mo id="S3.SS3.SSS2.p3.1.m1.3.3.1.6.2.2" stretchy="false" xref="S3.SS3.SSS2.p3.1.m1.3.3.1.cmml">)</mo></mrow></mrow></msup><mo id="S3.SS3.SSS2.p3.1.m1.8.8.4.8" xref="S3.SS3.SSS2.p3.1.m1.8.8.5.cmml">,</mo><msup id="S3.SS3.SSS2.p3.1.m1.8.8.4.4" xref="S3.SS3.SSS2.p3.1.m1.8.8.4.4.cmml"><mi id="S3.SS3.SSS2.p3.1.m1.8.8.4.4.2" xref="S3.SS3.SSS2.p3.1.m1.8.8.4.4.2.cmml">E</mi><mrow id="S3.SS3.SSS2.p3.1.m1.4.4.1" xref="S3.SS3.SSS2.p3.1.m1.4.4.1.cmml"><mi id="S3.SS3.SSS2.p3.1.m1.4.4.1.3" xref="S3.SS3.SSS2.p3.1.m1.4.4.1.3.cmml">P</mi><mo id="S3.SS3.SSS2.p3.1.m1.4.4.1.2" xref="S3.SS3.SSS2.p3.1.m1.4.4.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS2.p3.1.m1.4.4.1.4" xref="S3.SS3.SSS2.p3.1.m1.4.4.1.4.cmml">S</mi><mo id="S3.SS3.SSS2.p3.1.m1.4.4.1.2a" xref="S3.SS3.SSS2.p3.1.m1.4.4.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS2.p3.1.m1.4.4.1.5" xref="S3.SS3.SSS2.p3.1.m1.4.4.1.5.cmml">U</mi><mo id="S3.SS3.SSS2.p3.1.m1.4.4.1.2b" xref="S3.SS3.SSS2.p3.1.m1.4.4.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p3.1.m1.4.4.1.6.2" xref="S3.SS3.SSS2.p3.1.m1.4.4.1.cmml"><mo id="S3.SS3.SSS2.p3.1.m1.4.4.1.6.2.1" stretchy="false" xref="S3.SS3.SSS2.p3.1.m1.4.4.1.cmml">(</mo><mi id="S3.SS3.SSS2.p3.1.m1.4.4.1.1" xref="S3.SS3.SSS2.p3.1.m1.4.4.1.1.cmml">A</mi><mo id="S3.SS3.SSS2.p3.1.m1.4.4.1.6.2.2" stretchy="false" xref="S3.SS3.SSS2.p3.1.m1.4.4.1.cmml">)</mo></mrow></mrow></msup><mo id="S3.SS3.SSS2.p3.1.m1.8.8.4.9" stretchy="false" xref="S3.SS3.SSS2.p3.1.m1.8.8.5.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.1.m1.8b"><list id="S3.SS3.SSS2.p3.1.m1.8.8.5.cmml" xref="S3.SS3.SSS2.p3.1.m1.8.8.4"><apply id="S3.SS3.SSS2.p3.1.m1.5.5.1.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.5.5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.1.m1.5.5.1.1.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.5.5.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p3.1.m1.5.5.1.1.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.5.5.1.1.2">𝐸</ci><apply id="S3.SS3.SSS2.p3.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.1.1.1"><times id="S3.SS3.SSS2.p3.1.m1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.2"></times><ci id="S3.SS3.SSS2.p3.1.m1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.3">𝑃</ci><ci id="S3.SS3.SSS2.p3.1.m1.1.1.1.4.cmml" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.4">𝑆</ci><ci id="S3.SS3.SSS2.p3.1.m1.1.1.1.5.cmml" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.5">𝑈</ci><ci id="S3.SS3.SSS2.p3.1.m1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.1">𝑄</ci></apply></apply><apply id="S3.SS3.SSS2.p3.1.m1.6.6.2.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.6.6.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.1.m1.6.6.2.2.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.6.6.2.2">superscript</csymbol><ci id="S3.SS3.SSS2.p3.1.m1.6.6.2.2.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.6.6.2.2.2">𝐸</ci><apply id="S3.SS3.SSS2.p3.1.m1.2.2.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.2.2.1"><times id="S3.SS3.SSS2.p3.1.m1.2.2.1.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.2"></times><ci id="S3.SS3.SSS2.p3.1.m1.2.2.1.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.3">𝑃</ci><ci id="S3.SS3.SSS2.p3.1.m1.2.2.1.4.cmml" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.4">𝑆</ci><ci id="S3.SS3.SSS2.p3.1.m1.2.2.1.5.cmml" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.5">𝑈</ci><ci id="S3.SS3.SSS2.p3.1.m1.2.2.1.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.1">𝑇</ci></apply></apply><apply id="S3.SS3.SSS2.p3.1.m1.7.7.3.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.7.7.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.1.m1.7.7.3.3.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.7.7.3.3">superscript</csymbol><ci id="S3.SS3.SSS2.p3.1.m1.7.7.3.3.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.7.7.3.3.2">𝐸</ci><apply id="S3.SS3.SSS2.p3.1.m1.3.3.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.3.3.1"><times id="S3.SS3.SSS2.p3.1.m1.3.3.1.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.3.3.1.2"></times><ci id="S3.SS3.SSS2.p3.1.m1.3.3.1.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.3.3.1.3">𝑃</ci><ci id="S3.SS3.SSS2.p3.1.m1.3.3.1.4.cmml" xref="S3.SS3.SSS2.p3.1.m1.3.3.1.4">𝑆</ci><ci id="S3.SS3.SSS2.p3.1.m1.3.3.1.5.cmml" xref="S3.SS3.SSS2.p3.1.m1.3.3.1.5">𝑈</ci><ci id="S3.SS3.SSS2.p3.1.m1.3.3.1.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.3.3.1.1">𝐼</ci></apply></apply><apply id="S3.SS3.SSS2.p3.1.m1.8.8.4.4.cmml" xref="S3.SS3.SSS2.p3.1.m1.8.8.4.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.1.m1.8.8.4.4.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.8.8.4.4">superscript</csymbol><ci id="S3.SS3.SSS2.p3.1.m1.8.8.4.4.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.8.8.4.4.2">𝐸</ci><apply id="S3.SS3.SSS2.p3.1.m1.4.4.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4.1"><times id="S3.SS3.SSS2.p3.1.m1.4.4.1.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4.1.2"></times><ci id="S3.SS3.SSS2.p3.1.m1.4.4.1.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4.1.3">𝑃</ci><ci id="S3.SS3.SSS2.p3.1.m1.4.4.1.4.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4.1.4">𝑆</ci><ci id="S3.SS3.SSS2.p3.1.m1.4.4.1.5.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4.1.5">𝑈</ci><ci id="S3.SS3.SSS2.p3.1.m1.4.4.1.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4.1.1">𝐴</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.1.m1.8c">[E^{PSU(Q)},E^{PSU(T)},E^{PSU(I)},E^{PSU(A)}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.1.m1.8d">[ italic_E start_POSTSUPERSCRIPT italic_P italic_S italic_U ( italic_Q ) end_POSTSUPERSCRIPT , italic_E start_POSTSUPERSCRIPT italic_P italic_S italic_U ( italic_T ) end_POSTSUPERSCRIPT , italic_E start_POSTSUPERSCRIPT italic_P italic_S italic_U ( italic_I ) end_POSTSUPERSCRIPT , italic_E start_POSTSUPERSCRIPT italic_P italic_S italic_U ( italic_A ) end_POSTSUPERSCRIPT ]</annotation></semantics></math> from PSU, and applies projection matrix <math alttext="G^{(j)}\in\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.2.m2.1"><semantics id="S3.SS3.SSS2.p3.2.m2.1a"><mrow id="S3.SS3.SSS2.p3.2.m2.1.2" xref="S3.SS3.SSS2.p3.2.m2.1.2.cmml"><msup id="S3.SS3.SSS2.p3.2.m2.1.2.2" xref="S3.SS3.SSS2.p3.2.m2.1.2.2.cmml"><mi id="S3.SS3.SSS2.p3.2.m2.1.2.2.2" xref="S3.SS3.SSS2.p3.2.m2.1.2.2.2.cmml">G</mi><mrow id="S3.SS3.SSS2.p3.2.m2.1.1.1.3" xref="S3.SS3.SSS2.p3.2.m2.1.2.2.cmml"><mo id="S3.SS3.SSS2.p3.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS2.p3.2.m2.1.2.2.cmml">(</mo><mi id="S3.SS3.SSS2.p3.2.m2.1.1.1.1" xref="S3.SS3.SSS2.p3.2.m2.1.1.1.1.cmml">j</mi><mo id="S3.SS3.SSS2.p3.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS2.p3.2.m2.1.2.2.cmml">)</mo></mrow></msup><mo id="S3.SS3.SSS2.p3.2.m2.1.2.1" xref="S3.SS3.SSS2.p3.2.m2.1.2.1.cmml">∈</mo><msup id="S3.SS3.SSS2.p3.2.m2.1.2.3" xref="S3.SS3.SSS2.p3.2.m2.1.2.3.cmml"><mi id="S3.SS3.SSS2.p3.2.m2.1.2.3.2" xref="S3.SS3.SSS2.p3.2.m2.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS2.p3.2.m2.1.2.3.3" xref="S3.SS3.SSS2.p3.2.m2.1.2.3.3.cmml"><mi id="S3.SS3.SSS2.p3.2.m2.1.2.3.3.2" xref="S3.SS3.SSS2.p3.2.m2.1.2.3.3.2.cmml">d</mi><mo id="S3.SS3.SSS2.p3.2.m2.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS2.p3.2.m2.1.2.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS2.p3.2.m2.1.2.3.3.3" xref="S3.SS3.SSS2.p3.2.m2.1.2.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.2.m2.1b"><apply id="S3.SS3.SSS2.p3.2.m2.1.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.2"><in id="S3.SS3.SSS2.p3.2.m2.1.2.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.2.1"></in><apply id="S3.SS3.SSS2.p3.2.m2.1.2.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.1.2.2.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.2.2">superscript</csymbol><ci id="S3.SS3.SSS2.p3.2.m2.1.2.2.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.2.2.2">𝐺</ci><ci id="S3.SS3.SSS2.p3.2.m2.1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1.1.1">𝑗</ci></apply><apply id="S3.SS3.SSS2.p3.2.m2.1.2.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.1.2.3.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.2.3">superscript</csymbol><ci id="S3.SS3.SSS2.p3.2.m2.1.2.3.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.2.3.2">ℝ</ci><apply id="S3.SS3.SSS2.p3.2.m2.1.2.3.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.2.3.3"><times id="S3.SS3.SSS2.p3.2.m2.1.2.3.3.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.2.3.3.1"></times><ci id="S3.SS3.SSS2.p3.2.m2.1.2.3.3.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.2.3.3.2">𝑑</ci><ci id="S3.SS3.SSS2.p3.2.m2.1.2.3.3.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.2.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.2.m2.1c">G^{(j)}\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.2.m2.1d">italic_G start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> to get the projected embedding in GSU as <math alttext="\mathbb{x}^{GSU(j)}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.3.m3.1"><semantics id="S3.SS3.SSS2.p3.3.m3.1a"><msup id="S3.SS3.SSS2.p3.3.m3.1.2" xref="S3.SS3.SSS2.p3.3.m3.1.2.cmml"><mi id="S3.SS3.SSS2.p3.3.m3.1.2.2" xref="S3.SS3.SSS2.p3.3.m3.1.2.2.cmml">𝕩</mi><mrow id="S3.SS3.SSS2.p3.3.m3.1.1.1" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.cmml"><mi id="S3.SS3.SSS2.p3.3.m3.1.1.1.3" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.3.cmml">G</mi><mo id="S3.SS3.SSS2.p3.3.m3.1.1.1.2" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS2.p3.3.m3.1.1.1.4" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.4.cmml">S</mi><mo id="S3.SS3.SSS2.p3.3.m3.1.1.1.2a" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS2.p3.3.m3.1.1.1.5" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.5.cmml">U</mi><mo id="S3.SS3.SSS2.p3.3.m3.1.1.1.2b" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p3.3.m3.1.1.1.6.2" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.cmml"><mo id="S3.SS3.SSS2.p3.3.m3.1.1.1.6.2.1" stretchy="false" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS2.p3.3.m3.1.1.1.1" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.1.cmml">j</mi><mo id="S3.SS3.SSS2.p3.3.m3.1.1.1.6.2.2" stretchy="false" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.cmml">)</mo></mrow></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.3.m3.1b"><apply id="S3.SS3.SSS2.p3.3.m3.1.2.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.3.m3.1.2.1.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.2">superscript</csymbol><ci id="S3.SS3.SSS2.p3.3.m3.1.2.2.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.2.2">𝕩</ci><apply id="S3.SS3.SSS2.p3.3.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1.1"><times id="S3.SS3.SSS2.p3.3.m3.1.1.1.2.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.2"></times><ci id="S3.SS3.SSS2.p3.3.m3.1.1.1.3.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.3">𝐺</ci><ci id="S3.SS3.SSS2.p3.3.m3.1.1.1.4.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.4">𝑆</ci><ci id="S3.SS3.SSS2.p3.3.m3.1.1.1.5.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.5">𝑈</ci><ci id="S3.SS3.SSS2.p3.3.m3.1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.1">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.3.m3.1c">\mathbb{x}^{GSU(j)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.3.m3.1d">blackboard_x start_POSTSUPERSCRIPT italic_G italic_S italic_U ( italic_j ) end_POSTSUPERSCRIPT</annotation></semantics></math>. <math alttext="E^{PSU(*)}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.4.m4.1"><semantics id="S3.SS3.SSS2.p3.4.m4.1a"><msup id="S3.SS3.SSS2.p3.4.m4.1.2" xref="S3.SS3.SSS2.p3.4.m4.1.2.cmml"><mi id="S3.SS3.SSS2.p3.4.m4.1.2.2" xref="S3.SS3.SSS2.p3.4.m4.1.2.2.cmml">E</mi><mrow id="S3.SS3.SSS2.p3.4.m4.1.1.1" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.cmml"><mi id="S3.SS3.SSS2.p3.4.m4.1.1.1.3" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.3.cmml">P</mi><mo id="S3.SS3.SSS2.p3.4.m4.1.1.1.2" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS2.p3.4.m4.1.1.1.4" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.4.cmml">S</mi><mo id="S3.SS3.SSS2.p3.4.m4.1.1.1.2a" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS2.p3.4.m4.1.1.1.5" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.5.cmml">U</mi><mo id="S3.SS3.SSS2.p3.4.m4.1.1.1.2b" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p3.4.m4.1.1.1.6.2" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.cmml"><mo id="S3.SS3.SSS2.p3.4.m4.1.1.1.6.2.1" stretchy="false" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.cmml">(</mo><mo id="S3.SS3.SSS2.p3.4.m4.1.1.1.1" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.1.cmml">∗</mo><mo id="S3.SS3.SSS2.p3.4.m4.1.1.1.6.2.2" stretchy="false" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.cmml">)</mo></mrow></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.4.m4.1b"><apply id="S3.SS3.SSS2.p3.4.m4.1.2.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.4.m4.1.2.1.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.2">superscript</csymbol><ci id="S3.SS3.SSS2.p3.4.m4.1.2.2.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.2.2">𝐸</ci><apply id="S3.SS3.SSS2.p3.4.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1.1"><times id="S3.SS3.SSS2.p3.4.m4.1.1.1.2.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.2"></times><ci id="S3.SS3.SSS2.p3.4.m4.1.1.1.3.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.3">𝑃</ci><ci id="S3.SS3.SSS2.p3.4.m4.1.1.1.4.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.4">𝑆</ci><ci id="S3.SS3.SSS2.p3.4.m4.1.1.1.5.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.5">𝑈</ci><times id="S3.SS3.SSS2.p3.4.m4.1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.1"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.4.m4.1c">E^{PSU(*)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.4.m4.1d">italic_E start_POSTSUPERSCRIPT italic_P italic_S italic_U ( ∗ ) end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the pretrained multi-modal embedding. And the attention score <math alttext="\alpha_{h}^{GSU}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.5.m5.1"><semantics id="S3.SS3.SSS2.p3.5.m5.1a"><msubsup id="S3.SS3.SSS2.p3.5.m5.1.1" xref="S3.SS3.SSS2.p3.5.m5.1.1.cmml"><mi id="S3.SS3.SSS2.p3.5.m5.1.1.2.2" xref="S3.SS3.SSS2.p3.5.m5.1.1.2.2.cmml">α</mi><mi id="S3.SS3.SSS2.p3.5.m5.1.1.2.3" xref="S3.SS3.SSS2.p3.5.m5.1.1.2.3.cmml">h</mi><mrow id="S3.SS3.SSS2.p3.5.m5.1.1.3" xref="S3.SS3.SSS2.p3.5.m5.1.1.3.cmml"><mi id="S3.SS3.SSS2.p3.5.m5.1.1.3.2" xref="S3.SS3.SSS2.p3.5.m5.1.1.3.2.cmml">G</mi><mo id="S3.SS3.SSS2.p3.5.m5.1.1.3.1" xref="S3.SS3.SSS2.p3.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p3.5.m5.1.1.3.3" xref="S3.SS3.SSS2.p3.5.m5.1.1.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p3.5.m5.1.1.3.1a" xref="S3.SS3.SSS2.p3.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p3.5.m5.1.1.3.4" xref="S3.SS3.SSS2.p3.5.m5.1.1.3.4.cmml">U</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.5.m5.1b"><apply id="S3.SS3.SSS2.p3.5.m5.1.1.cmml" xref="S3.SS3.SSS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.5.m5.1.1.1.cmml" xref="S3.SS3.SSS2.p3.5.m5.1.1">superscript</csymbol><apply id="S3.SS3.SSS2.p3.5.m5.1.1.2.cmml" xref="S3.SS3.SSS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.5.m5.1.1.2.1.cmml" xref="S3.SS3.SSS2.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p3.5.m5.1.1.2.2.cmml" xref="S3.SS3.SSS2.p3.5.m5.1.1.2.2">𝛼</ci><ci id="S3.SS3.SSS2.p3.5.m5.1.1.2.3.cmml" xref="S3.SS3.SSS2.p3.5.m5.1.1.2.3">ℎ</ci></apply><apply id="S3.SS3.SSS2.p3.5.m5.1.1.3.cmml" xref="S3.SS3.SSS2.p3.5.m5.1.1.3"><times id="S3.SS3.SSS2.p3.5.m5.1.1.3.1.cmml" xref="S3.SS3.SSS2.p3.5.m5.1.1.3.1"></times><ci id="S3.SS3.SSS2.p3.5.m5.1.1.3.2.cmml" xref="S3.SS3.SSS2.p3.5.m5.1.1.3.2">𝐺</ci><ci id="S3.SS3.SSS2.p3.5.m5.1.1.3.3.cmml" xref="S3.SS3.SSS2.p3.5.m5.1.1.3.3">𝑆</ci><ci id="S3.SS3.SSS2.p3.5.m5.1.1.3.4.cmml" xref="S3.SS3.SSS2.p3.5.m5.1.1.3.4">𝑈</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.5.m5.1c">\alpha_{h}^{GSU}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.5.m5.1d">italic_α start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_G italic_S italic_U end_POSTSUPERSCRIPT</annotation></semantics></math> in the <math alttext="h" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.6.m6.1"><semantics id="S3.SS3.SSS2.p3.6.m6.1a"><mi id="S3.SS3.SSS2.p3.6.m6.1.1" xref="S3.SS3.SSS2.p3.6.m6.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.6.m6.1b"><ci id="S3.SS3.SSS2.p3.6.m6.1.1.cmml" xref="S3.SS3.SSS2.p3.6.m6.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.6.m6.1c">h</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.6.m6.1d">italic_h</annotation></semantics></math>-th head of GSU’s multi-head target attention is calculated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\alpha_{h}^{GSU}=\frac{(q_{t}W^{GSU_{Q}}_{h})(K^{GSU}W^{GSU_{K}}_{h})^{T}}{%
\sqrt{d}}" class="ltx_Math" display="block" id="S3.Ex6.m1.2"><semantics id="S3.Ex6.m1.2a"><mrow id="S3.Ex6.m1.2.3" xref="S3.Ex6.m1.2.3.cmml"><msubsup id="S3.Ex6.m1.2.3.2" xref="S3.Ex6.m1.2.3.2.cmml"><mi id="S3.Ex6.m1.2.3.2.2.2" xref="S3.Ex6.m1.2.3.2.2.2.cmml">α</mi><mi id="S3.Ex6.m1.2.3.2.2.3" xref="S3.Ex6.m1.2.3.2.2.3.cmml">h</mi><mrow id="S3.Ex6.m1.2.3.2.3" xref="S3.Ex6.m1.2.3.2.3.cmml"><mi id="S3.Ex6.m1.2.3.2.3.2" xref="S3.Ex6.m1.2.3.2.3.2.cmml">G</mi><mo id="S3.Ex6.m1.2.3.2.3.1" xref="S3.Ex6.m1.2.3.2.3.1.cmml">⁢</mo><mi id="S3.Ex6.m1.2.3.2.3.3" xref="S3.Ex6.m1.2.3.2.3.3.cmml">S</mi><mo id="S3.Ex6.m1.2.3.2.3.1a" xref="S3.Ex6.m1.2.3.2.3.1.cmml">⁢</mo><mi id="S3.Ex6.m1.2.3.2.3.4" xref="S3.Ex6.m1.2.3.2.3.4.cmml">U</mi></mrow></msubsup><mo id="S3.Ex6.m1.2.3.1" xref="S3.Ex6.m1.2.3.1.cmml">=</mo><mfrac id="S3.Ex6.m1.2.2" xref="S3.Ex6.m1.2.2.cmml"><mrow id="S3.Ex6.m1.2.2.2" xref="S3.Ex6.m1.2.2.2.cmml"><mrow id="S3.Ex6.m1.1.1.1.1.1" xref="S3.Ex6.m1.1.1.1.1.1.1.cmml"><mo id="S3.Ex6.m1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex6.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex6.m1.1.1.1.1.1.1" xref="S3.Ex6.m1.1.1.1.1.1.1.cmml"><msub id="S3.Ex6.m1.1.1.1.1.1.1.2" xref="S3.Ex6.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex6.m1.1.1.1.1.1.1.2.2" xref="S3.Ex6.m1.1.1.1.1.1.1.2.2.cmml">q</mi><mi id="S3.Ex6.m1.1.1.1.1.1.1.2.3" xref="S3.Ex6.m1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.Ex6.m1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S3.Ex6.m1.1.1.1.1.1.1.3" xref="S3.Ex6.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex6.m1.1.1.1.1.1.1.3.2.2" xref="S3.Ex6.m1.1.1.1.1.1.1.3.2.2.cmml">W</mi><mi id="S3.Ex6.m1.1.1.1.1.1.1.3.3" xref="S3.Ex6.m1.1.1.1.1.1.1.3.3.cmml">h</mi><mrow id="S3.Ex6.m1.1.1.1.1.1.1.3.2.3" xref="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.2" xref="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.2.cmml">G</mi><mo id="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.1" xref="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.3" xref="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.3.cmml">S</mi><mo id="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.1a" xref="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><msub id="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.4" xref="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.4.cmml"><mi id="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.4.2" xref="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.4.2.cmml">U</mi><mi id="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.4.3" xref="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.4.3.cmml">Q</mi></msub></mrow></msubsup></mrow><mo id="S3.Ex6.m1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex6.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex6.m1.2.2.2.3" xref="S3.Ex6.m1.2.2.2.3.cmml">⁢</mo><msup id="S3.Ex6.m1.2.2.2.2" xref="S3.Ex6.m1.2.2.2.2.cmml"><mrow id="S3.Ex6.m1.2.2.2.2.1.1" xref="S3.Ex6.m1.2.2.2.2.1.1.1.cmml"><mo id="S3.Ex6.m1.2.2.2.2.1.1.2" stretchy="false" xref="S3.Ex6.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.Ex6.m1.2.2.2.2.1.1.1" xref="S3.Ex6.m1.2.2.2.2.1.1.1.cmml"><msup id="S3.Ex6.m1.2.2.2.2.1.1.1.2" xref="S3.Ex6.m1.2.2.2.2.1.1.1.2.cmml"><mi id="S3.Ex6.m1.2.2.2.2.1.1.1.2.2" xref="S3.Ex6.m1.2.2.2.2.1.1.1.2.2.cmml">K</mi><mrow id="S3.Ex6.m1.2.2.2.2.1.1.1.2.3" xref="S3.Ex6.m1.2.2.2.2.1.1.1.2.3.cmml"><mi id="S3.Ex6.m1.2.2.2.2.1.1.1.2.3.2" xref="S3.Ex6.m1.2.2.2.2.1.1.1.2.3.2.cmml">G</mi><mo id="S3.Ex6.m1.2.2.2.2.1.1.1.2.3.1" xref="S3.Ex6.m1.2.2.2.2.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.Ex6.m1.2.2.2.2.1.1.1.2.3.3" xref="S3.Ex6.m1.2.2.2.2.1.1.1.2.3.3.cmml">S</mi><mo id="S3.Ex6.m1.2.2.2.2.1.1.1.2.3.1a" xref="S3.Ex6.m1.2.2.2.2.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.Ex6.m1.2.2.2.2.1.1.1.2.3.4" xref="S3.Ex6.m1.2.2.2.2.1.1.1.2.3.4.cmml">U</mi></mrow></msup><mo id="S3.Ex6.m1.2.2.2.2.1.1.1.1" xref="S3.Ex6.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><msubsup id="S3.Ex6.m1.2.2.2.2.1.1.1.3" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.cmml"><mi id="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.2" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.2.cmml">W</mi><mi id="S3.Ex6.m1.2.2.2.2.1.1.1.3.3" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.3.cmml">h</mi><mrow id="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.cmml"><mi id="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.2" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.2.cmml">G</mi><mo id="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.1" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.3" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.3.cmml">S</mi><mo id="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.1a" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.1.cmml">⁢</mo><msub id="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.4" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.4.cmml"><mi id="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.4.2" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.4.2.cmml">U</mi><mi id="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.4.3" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.4.3.cmml">K</mi></msub></mrow></msubsup></mrow><mo id="S3.Ex6.m1.2.2.2.2.1.1.3" stretchy="false" xref="S3.Ex6.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S3.Ex6.m1.2.2.2.2.3" xref="S3.Ex6.m1.2.2.2.2.3.cmml">T</mi></msup></mrow><msqrt id="S3.Ex6.m1.2.2.4" xref="S3.Ex6.m1.2.2.4.cmml"><mi id="S3.Ex6.m1.2.2.4.2" xref="S3.Ex6.m1.2.2.4.2.cmml">d</mi></msqrt></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex6.m1.2b"><apply id="S3.Ex6.m1.2.3.cmml" xref="S3.Ex6.m1.2.3"><eq id="S3.Ex6.m1.2.3.1.cmml" xref="S3.Ex6.m1.2.3.1"></eq><apply id="S3.Ex6.m1.2.3.2.cmml" xref="S3.Ex6.m1.2.3.2"><csymbol cd="ambiguous" id="S3.Ex6.m1.2.3.2.1.cmml" xref="S3.Ex6.m1.2.3.2">superscript</csymbol><apply id="S3.Ex6.m1.2.3.2.2.cmml" xref="S3.Ex6.m1.2.3.2"><csymbol cd="ambiguous" id="S3.Ex6.m1.2.3.2.2.1.cmml" xref="S3.Ex6.m1.2.3.2">subscript</csymbol><ci id="S3.Ex6.m1.2.3.2.2.2.cmml" xref="S3.Ex6.m1.2.3.2.2.2">𝛼</ci><ci id="S3.Ex6.m1.2.3.2.2.3.cmml" xref="S3.Ex6.m1.2.3.2.2.3">ℎ</ci></apply><apply id="S3.Ex6.m1.2.3.2.3.cmml" xref="S3.Ex6.m1.2.3.2.3"><times id="S3.Ex6.m1.2.3.2.3.1.cmml" xref="S3.Ex6.m1.2.3.2.3.1"></times><ci id="S3.Ex6.m1.2.3.2.3.2.cmml" xref="S3.Ex6.m1.2.3.2.3.2">𝐺</ci><ci id="S3.Ex6.m1.2.3.2.3.3.cmml" xref="S3.Ex6.m1.2.3.2.3.3">𝑆</ci><ci id="S3.Ex6.m1.2.3.2.3.4.cmml" xref="S3.Ex6.m1.2.3.2.3.4">𝑈</ci></apply></apply><apply id="S3.Ex6.m1.2.2.cmml" xref="S3.Ex6.m1.2.2"><divide id="S3.Ex6.m1.2.2.3.cmml" xref="S3.Ex6.m1.2.2"></divide><apply id="S3.Ex6.m1.2.2.2.cmml" xref="S3.Ex6.m1.2.2.2"><times id="S3.Ex6.m1.2.2.2.3.cmml" xref="S3.Ex6.m1.2.2.2.3"></times><apply id="S3.Ex6.m1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1"><times id="S3.Ex6.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1"></times><apply id="S3.Ex6.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex6.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex6.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.2.2">𝑞</ci><ci id="S3.Ex6.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.Ex6.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex6.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.Ex6.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex6.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.Ex6.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.3.2.2">𝑊</ci><apply id="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.3.2.3"><times id="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.1"></times><ci id="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.2">𝐺</ci><ci id="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.3">𝑆</ci><apply id="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.4.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.4"><csymbol cd="ambiguous" id="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.4.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.4">subscript</csymbol><ci id="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.4.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.4.2">𝑈</ci><ci id="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.4.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.3.2.3.4.3">𝑄</ci></apply></apply></apply><ci id="S3.Ex6.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.3.3">ℎ</ci></apply></apply><apply id="S3.Ex6.m1.2.2.2.2.cmml" xref="S3.Ex6.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex6.m1.2.2.2.2.2.cmml" xref="S3.Ex6.m1.2.2.2.2">superscript</csymbol><apply id="S3.Ex6.m1.2.2.2.2.1.1.1.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1"><times id="S3.Ex6.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.1"></times><apply id="S3.Ex6.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex6.m1.2.2.2.2.1.1.1.2.1.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.2">superscript</csymbol><ci id="S3.Ex6.m1.2.2.2.2.1.1.1.2.2.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.2.2">𝐾</ci><apply id="S3.Ex6.m1.2.2.2.2.1.1.1.2.3.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.2.3"><times id="S3.Ex6.m1.2.2.2.2.1.1.1.2.3.1.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.2.3.1"></times><ci id="S3.Ex6.m1.2.2.2.2.1.1.1.2.3.2.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.2.3.2">𝐺</ci><ci id="S3.Ex6.m1.2.2.2.2.1.1.1.2.3.3.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.2.3.3">𝑆</ci><ci id="S3.Ex6.m1.2.2.2.2.1.1.1.2.3.4.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.2.3.4">𝑈</ci></apply></apply><apply id="S3.Ex6.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex6.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3">subscript</csymbol><apply id="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.1.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3">superscript</csymbol><ci id="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.2.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.2">𝑊</ci><apply id="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3"><times id="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.1.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.1"></times><ci id="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.2.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.2">𝐺</ci><ci id="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.3.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.3">𝑆</ci><apply id="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.4.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.4"><csymbol cd="ambiguous" id="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.4.1.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.4">subscript</csymbol><ci id="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.4.2.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.4.2">𝑈</ci><ci id="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.4.3.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.2.3.4.3">𝐾</ci></apply></apply></apply><ci id="S3.Ex6.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S3.Ex6.m1.2.2.2.2.1.1.1.3.3">ℎ</ci></apply></apply><ci id="S3.Ex6.m1.2.2.2.2.3.cmml" xref="S3.Ex6.m1.2.2.2.2.3">𝑇</ci></apply></apply><apply id="S3.Ex6.m1.2.2.4.cmml" xref="S3.Ex6.m1.2.2.4"><root id="S3.Ex6.m1.2.2.4a.cmml" xref="S3.Ex6.m1.2.2.4"></root><ci id="S3.Ex6.m1.2.2.4.2.cmml" xref="S3.Ex6.m1.2.2.4.2">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex6.m1.2c">\alpha_{h}^{GSU}=\frac{(q_{t}W^{GSU_{Q}}_{h})(K^{GSU}W^{GSU_{K}}_{h})^{T}}{%
\sqrt{d}}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex6.m1.2d">italic_α start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_G italic_S italic_U end_POSTSUPERSCRIPT = divide start_ARG ( italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_W start_POSTSUPERSCRIPT italic_G italic_S italic_U start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) ( italic_K start_POSTSUPERSCRIPT italic_G italic_S italic_U end_POSTSUPERSCRIPT italic_W start_POSTSUPERSCRIPT italic_G italic_S italic_U start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbb{x}^{GSU(j)}=\mathbb{x}^{PSU(j)}G_{j},\forall j\in M+1" class="ltx_Math" display="block" id="S3.Ex7.m1.4"><semantics id="S3.Ex7.m1.4a"><mrow id="S3.Ex7.m1.4.4.2" xref="S3.Ex7.m1.4.4.3.cmml"><mrow id="S3.Ex7.m1.3.3.1.1" xref="S3.Ex7.m1.3.3.1.1.cmml"><msup id="S3.Ex7.m1.3.3.1.1.2" xref="S3.Ex7.m1.3.3.1.1.2.cmml"><mi id="S3.Ex7.m1.3.3.1.1.2.2" xref="S3.Ex7.m1.3.3.1.1.2.2.cmml">𝕩</mi><mrow id="S3.Ex7.m1.1.1.1" xref="S3.Ex7.m1.1.1.1.cmml"><mi id="S3.Ex7.m1.1.1.1.3" xref="S3.Ex7.m1.1.1.1.3.cmml">G</mi><mo id="S3.Ex7.m1.1.1.1.2" xref="S3.Ex7.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex7.m1.1.1.1.4" xref="S3.Ex7.m1.1.1.1.4.cmml">S</mi><mo id="S3.Ex7.m1.1.1.1.2a" xref="S3.Ex7.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex7.m1.1.1.1.5" xref="S3.Ex7.m1.1.1.1.5.cmml">U</mi><mo id="S3.Ex7.m1.1.1.1.2b" xref="S3.Ex7.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex7.m1.1.1.1.6.2" xref="S3.Ex7.m1.1.1.1.cmml"><mo id="S3.Ex7.m1.1.1.1.6.2.1" stretchy="false" xref="S3.Ex7.m1.1.1.1.cmml">(</mo><mi id="S3.Ex7.m1.1.1.1.1" xref="S3.Ex7.m1.1.1.1.1.cmml">j</mi><mo id="S3.Ex7.m1.1.1.1.6.2.2" stretchy="false" xref="S3.Ex7.m1.1.1.1.cmml">)</mo></mrow></mrow></msup><mo id="S3.Ex7.m1.3.3.1.1.1" xref="S3.Ex7.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.Ex7.m1.3.3.1.1.3" xref="S3.Ex7.m1.3.3.1.1.3.cmml"><msup id="S3.Ex7.m1.3.3.1.1.3.2" xref="S3.Ex7.m1.3.3.1.1.3.2.cmml"><mi id="S3.Ex7.m1.3.3.1.1.3.2.2" xref="S3.Ex7.m1.3.3.1.1.3.2.2.cmml">𝕩</mi><mrow id="S3.Ex7.m1.2.2.1" xref="S3.Ex7.m1.2.2.1.cmml"><mi id="S3.Ex7.m1.2.2.1.3" xref="S3.Ex7.m1.2.2.1.3.cmml">P</mi><mo id="S3.Ex7.m1.2.2.1.2" xref="S3.Ex7.m1.2.2.1.2.cmml">⁢</mo><mi id="S3.Ex7.m1.2.2.1.4" xref="S3.Ex7.m1.2.2.1.4.cmml">S</mi><mo id="S3.Ex7.m1.2.2.1.2a" xref="S3.Ex7.m1.2.2.1.2.cmml">⁢</mo><mi id="S3.Ex7.m1.2.2.1.5" xref="S3.Ex7.m1.2.2.1.5.cmml">U</mi><mo id="S3.Ex7.m1.2.2.1.2b" xref="S3.Ex7.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.Ex7.m1.2.2.1.6.2" xref="S3.Ex7.m1.2.2.1.cmml"><mo id="S3.Ex7.m1.2.2.1.6.2.1" stretchy="false" xref="S3.Ex7.m1.2.2.1.cmml">(</mo><mi id="S3.Ex7.m1.2.2.1.1" xref="S3.Ex7.m1.2.2.1.1.cmml">j</mi><mo id="S3.Ex7.m1.2.2.1.6.2.2" stretchy="false" xref="S3.Ex7.m1.2.2.1.cmml">)</mo></mrow></mrow></msup><mo id="S3.Ex7.m1.3.3.1.1.3.1" xref="S3.Ex7.m1.3.3.1.1.3.1.cmml">⁢</mo><msub id="S3.Ex7.m1.3.3.1.1.3.3" xref="S3.Ex7.m1.3.3.1.1.3.3.cmml"><mi id="S3.Ex7.m1.3.3.1.1.3.3.2" xref="S3.Ex7.m1.3.3.1.1.3.3.2.cmml">G</mi><mi id="S3.Ex7.m1.3.3.1.1.3.3.3" xref="S3.Ex7.m1.3.3.1.1.3.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.Ex7.m1.4.4.2.3" xref="S3.Ex7.m1.4.4.3a.cmml">,</mo><mrow id="S3.Ex7.m1.4.4.2.2" xref="S3.Ex7.m1.4.4.2.2.cmml"><mrow id="S3.Ex7.m1.4.4.2.2.2" xref="S3.Ex7.m1.4.4.2.2.2.cmml"><mo id="S3.Ex7.m1.4.4.2.2.2.1" rspace="0.167em" xref="S3.Ex7.m1.4.4.2.2.2.1.cmml">∀</mo><mi id="S3.Ex7.m1.4.4.2.2.2.2" xref="S3.Ex7.m1.4.4.2.2.2.2.cmml">j</mi></mrow><mo id="S3.Ex7.m1.4.4.2.2.1" xref="S3.Ex7.m1.4.4.2.2.1.cmml">∈</mo><mrow id="S3.Ex7.m1.4.4.2.2.3" xref="S3.Ex7.m1.4.4.2.2.3.cmml"><mi id="S3.Ex7.m1.4.4.2.2.3.2" xref="S3.Ex7.m1.4.4.2.2.3.2.cmml">M</mi><mo id="S3.Ex7.m1.4.4.2.2.3.1" xref="S3.Ex7.m1.4.4.2.2.3.1.cmml">+</mo><mn id="S3.Ex7.m1.4.4.2.2.3.3" xref="S3.Ex7.m1.4.4.2.2.3.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex7.m1.4b"><apply id="S3.Ex7.m1.4.4.3.cmml" xref="S3.Ex7.m1.4.4.2"><csymbol cd="ambiguous" id="S3.Ex7.m1.4.4.3a.cmml" xref="S3.Ex7.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S3.Ex7.m1.3.3.1.1.cmml" xref="S3.Ex7.m1.3.3.1.1"><eq id="S3.Ex7.m1.3.3.1.1.1.cmml" xref="S3.Ex7.m1.3.3.1.1.1"></eq><apply id="S3.Ex7.m1.3.3.1.1.2.cmml" xref="S3.Ex7.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.Ex7.m1.3.3.1.1.2.1.cmml" xref="S3.Ex7.m1.3.3.1.1.2">superscript</csymbol><ci id="S3.Ex7.m1.3.3.1.1.2.2.cmml" xref="S3.Ex7.m1.3.3.1.1.2.2">𝕩</ci><apply id="S3.Ex7.m1.1.1.1.cmml" xref="S3.Ex7.m1.1.1.1"><times id="S3.Ex7.m1.1.1.1.2.cmml" xref="S3.Ex7.m1.1.1.1.2"></times><ci id="S3.Ex7.m1.1.1.1.3.cmml" xref="S3.Ex7.m1.1.1.1.3">𝐺</ci><ci id="S3.Ex7.m1.1.1.1.4.cmml" xref="S3.Ex7.m1.1.1.1.4">𝑆</ci><ci id="S3.Ex7.m1.1.1.1.5.cmml" xref="S3.Ex7.m1.1.1.1.5">𝑈</ci><ci id="S3.Ex7.m1.1.1.1.1.cmml" xref="S3.Ex7.m1.1.1.1.1">𝑗</ci></apply></apply><apply id="S3.Ex7.m1.3.3.1.1.3.cmml" xref="S3.Ex7.m1.3.3.1.1.3"><times id="S3.Ex7.m1.3.3.1.1.3.1.cmml" xref="S3.Ex7.m1.3.3.1.1.3.1"></times><apply id="S3.Ex7.m1.3.3.1.1.3.2.cmml" xref="S3.Ex7.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex7.m1.3.3.1.1.3.2.1.cmml" xref="S3.Ex7.m1.3.3.1.1.3.2">superscript</csymbol><ci id="S3.Ex7.m1.3.3.1.1.3.2.2.cmml" xref="S3.Ex7.m1.3.3.1.1.3.2.2">𝕩</ci><apply id="S3.Ex7.m1.2.2.1.cmml" xref="S3.Ex7.m1.2.2.1"><times id="S3.Ex7.m1.2.2.1.2.cmml" xref="S3.Ex7.m1.2.2.1.2"></times><ci id="S3.Ex7.m1.2.2.1.3.cmml" xref="S3.Ex7.m1.2.2.1.3">𝑃</ci><ci id="S3.Ex7.m1.2.2.1.4.cmml" xref="S3.Ex7.m1.2.2.1.4">𝑆</ci><ci id="S3.Ex7.m1.2.2.1.5.cmml" xref="S3.Ex7.m1.2.2.1.5">𝑈</ci><ci id="S3.Ex7.m1.2.2.1.1.cmml" xref="S3.Ex7.m1.2.2.1.1">𝑗</ci></apply></apply><apply id="S3.Ex7.m1.3.3.1.1.3.3.cmml" xref="S3.Ex7.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex7.m1.3.3.1.1.3.3.1.cmml" xref="S3.Ex7.m1.3.3.1.1.3.3">subscript</csymbol><ci id="S3.Ex7.m1.3.3.1.1.3.3.2.cmml" xref="S3.Ex7.m1.3.3.1.1.3.3.2">𝐺</ci><ci id="S3.Ex7.m1.3.3.1.1.3.3.3.cmml" xref="S3.Ex7.m1.3.3.1.1.3.3.3">𝑗</ci></apply></apply></apply><apply id="S3.Ex7.m1.4.4.2.2.cmml" xref="S3.Ex7.m1.4.4.2.2"><in id="S3.Ex7.m1.4.4.2.2.1.cmml" xref="S3.Ex7.m1.4.4.2.2.1"></in><apply id="S3.Ex7.m1.4.4.2.2.2.cmml" xref="S3.Ex7.m1.4.4.2.2.2"><csymbol cd="latexml" id="S3.Ex7.m1.4.4.2.2.2.1.cmml" xref="S3.Ex7.m1.4.4.2.2.2.1">for-all</csymbol><ci id="S3.Ex7.m1.4.4.2.2.2.2.cmml" xref="S3.Ex7.m1.4.4.2.2.2.2">𝑗</ci></apply><apply id="S3.Ex7.m1.4.4.2.2.3.cmml" xref="S3.Ex7.m1.4.4.2.2.3"><plus id="S3.Ex7.m1.4.4.2.2.3.1.cmml" xref="S3.Ex7.m1.4.4.2.2.3.1"></plus><ci id="S3.Ex7.m1.4.4.2.2.3.2.cmml" xref="S3.Ex7.m1.4.4.2.2.3.2">𝑀</ci><cn id="S3.Ex7.m1.4.4.2.2.3.3.cmml" type="integer" xref="S3.Ex7.m1.4.4.2.2.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex7.m1.4c">\mathbb{x}^{GSU(j)}=\mathbb{x}^{PSU(j)}G_{j},\forall j\in M+1</annotation><annotation encoding="application/x-llamapun" id="S3.Ex7.m1.4d">blackboard_x start_POSTSUPERSCRIPT italic_G italic_S italic_U ( italic_j ) end_POSTSUPERSCRIPT = blackboard_x start_POSTSUPERSCRIPT italic_P italic_S italic_U ( italic_j ) end_POSTSUPERSCRIPT italic_G start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , ∀ italic_j ∈ italic_M + 1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p4">
<p class="ltx_p" id="S3.SS3.SSS2.p4.7">Comparing the GSU attention <math alttext="\alpha^{GSU}_{h}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.1.m1.1"><semantics id="S3.SS3.SSS2.p4.1.m1.1a"><msubsup id="S3.SS3.SSS2.p4.1.m1.1.1" xref="S3.SS3.SSS2.p4.1.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p4.1.m1.1.1.2.2" xref="S3.SS3.SSS2.p4.1.m1.1.1.2.2.cmml">α</mi><mi id="S3.SS3.SSS2.p4.1.m1.1.1.3" xref="S3.SS3.SSS2.p4.1.m1.1.1.3.cmml">h</mi><mrow id="S3.SS3.SSS2.p4.1.m1.1.1.2.3" xref="S3.SS3.SSS2.p4.1.m1.1.1.2.3.cmml"><mi id="S3.SS3.SSS2.p4.1.m1.1.1.2.3.2" xref="S3.SS3.SSS2.p4.1.m1.1.1.2.3.2.cmml">G</mi><mo id="S3.SS3.SSS2.p4.1.m1.1.1.2.3.1" xref="S3.SS3.SSS2.p4.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p4.1.m1.1.1.2.3.3" xref="S3.SS3.SSS2.p4.1.m1.1.1.2.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p4.1.m1.1.1.2.3.1a" xref="S3.SS3.SSS2.p4.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p4.1.m1.1.1.2.3.4" xref="S3.SS3.SSS2.p4.1.m1.1.1.2.3.4.cmml">U</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.1.m1.1b"><apply id="S3.SS3.SSS2.p4.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p4.1.m1.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p4.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.1.m1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p4.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p4.1.m1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p4.1.m1.1.1.2.2">𝛼</ci><apply id="S3.SS3.SSS2.p4.1.m1.1.1.2.3.cmml" xref="S3.SS3.SSS2.p4.1.m1.1.1.2.3"><times id="S3.SS3.SSS2.p4.1.m1.1.1.2.3.1.cmml" xref="S3.SS3.SSS2.p4.1.m1.1.1.2.3.1"></times><ci id="S3.SS3.SSS2.p4.1.m1.1.1.2.3.2.cmml" xref="S3.SS3.SSS2.p4.1.m1.1.1.2.3.2">𝐺</ci><ci id="S3.SS3.SSS2.p4.1.m1.1.1.2.3.3.cmml" xref="S3.SS3.SSS2.p4.1.m1.1.1.2.3.3">𝑆</ci><ci id="S3.SS3.SSS2.p4.1.m1.1.1.2.3.4.cmml" xref="S3.SS3.SSS2.p4.1.m1.1.1.2.3.4">𝑈</ci></apply></apply><ci id="S3.SS3.SSS2.p4.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p4.1.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.1.m1.1c">\alpha^{GSU}_{h}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.1.m1.1d">italic_α start_POSTSUPERSCRIPT italic_G italic_S italic_U end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> with the pretrained PSU attention <math alttext="\alpha^{PSU}_{h}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.2.m2.1"><semantics id="S3.SS3.SSS2.p4.2.m2.1a"><msubsup id="S3.SS3.SSS2.p4.2.m2.1.1" xref="S3.SS3.SSS2.p4.2.m2.1.1.cmml"><mi id="S3.SS3.SSS2.p4.2.m2.1.1.2.2" xref="S3.SS3.SSS2.p4.2.m2.1.1.2.2.cmml">α</mi><mi id="S3.SS3.SSS2.p4.2.m2.1.1.3" xref="S3.SS3.SSS2.p4.2.m2.1.1.3.cmml">h</mi><mrow id="S3.SS3.SSS2.p4.2.m2.1.1.2.3" xref="S3.SS3.SSS2.p4.2.m2.1.1.2.3.cmml"><mi id="S3.SS3.SSS2.p4.2.m2.1.1.2.3.2" xref="S3.SS3.SSS2.p4.2.m2.1.1.2.3.2.cmml">P</mi><mo id="S3.SS3.SSS2.p4.2.m2.1.1.2.3.1" xref="S3.SS3.SSS2.p4.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p4.2.m2.1.1.2.3.3" xref="S3.SS3.SSS2.p4.2.m2.1.1.2.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p4.2.m2.1.1.2.3.1a" xref="S3.SS3.SSS2.p4.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p4.2.m2.1.1.2.3.4" xref="S3.SS3.SSS2.p4.2.m2.1.1.2.3.4.cmml">U</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.2.m2.1b"><apply id="S3.SS3.SSS2.p4.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p4.2.m2.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p4.2.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.2.m2.1.1.2.1.cmml" xref="S3.SS3.SSS2.p4.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p4.2.m2.1.1.2.2.cmml" xref="S3.SS3.SSS2.p4.2.m2.1.1.2.2">𝛼</ci><apply id="S3.SS3.SSS2.p4.2.m2.1.1.2.3.cmml" xref="S3.SS3.SSS2.p4.2.m2.1.1.2.3"><times id="S3.SS3.SSS2.p4.2.m2.1.1.2.3.1.cmml" xref="S3.SS3.SSS2.p4.2.m2.1.1.2.3.1"></times><ci id="S3.SS3.SSS2.p4.2.m2.1.1.2.3.2.cmml" xref="S3.SS3.SSS2.p4.2.m2.1.1.2.3.2">𝑃</ci><ci id="S3.SS3.SSS2.p4.2.m2.1.1.2.3.3.cmml" xref="S3.SS3.SSS2.p4.2.m2.1.1.2.3.3">𝑆</ci><ci id="S3.SS3.SSS2.p4.2.m2.1.1.2.3.4.cmml" xref="S3.SS3.SSS2.p4.2.m2.1.1.2.3.4">𝑈</ci></apply></apply><ci id="S3.SS3.SSS2.p4.2.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p4.2.m2.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.2.m2.1c">\alpha^{PSU}_{h}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.2.m2.1d">italic_α start_POSTSUPERSCRIPT italic_P italic_S italic_U end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math>, we can see that the structures of multi-head target attention are exactly the same. The projection weights <math alttext="W^{GSU_{Q}}_{h}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.3.m3.1"><semantics id="S3.SS3.SSS2.p4.3.m3.1a"><msubsup id="S3.SS3.SSS2.p4.3.m3.1.1" xref="S3.SS3.SSS2.p4.3.m3.1.1.cmml"><mi id="S3.SS3.SSS2.p4.3.m3.1.1.2.2" xref="S3.SS3.SSS2.p4.3.m3.1.1.2.2.cmml">W</mi><mi id="S3.SS3.SSS2.p4.3.m3.1.1.3" xref="S3.SS3.SSS2.p4.3.m3.1.1.3.cmml">h</mi><mrow id="S3.SS3.SSS2.p4.3.m3.1.1.2.3" xref="S3.SS3.SSS2.p4.3.m3.1.1.2.3.cmml"><mi id="S3.SS3.SSS2.p4.3.m3.1.1.2.3.2" xref="S3.SS3.SSS2.p4.3.m3.1.1.2.3.2.cmml">G</mi><mo id="S3.SS3.SSS2.p4.3.m3.1.1.2.3.1" xref="S3.SS3.SSS2.p4.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p4.3.m3.1.1.2.3.3" xref="S3.SS3.SSS2.p4.3.m3.1.1.2.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p4.3.m3.1.1.2.3.1a" xref="S3.SS3.SSS2.p4.3.m3.1.1.2.3.1.cmml">⁢</mo><msub id="S3.SS3.SSS2.p4.3.m3.1.1.2.3.4" xref="S3.SS3.SSS2.p4.3.m3.1.1.2.3.4.cmml"><mi id="S3.SS3.SSS2.p4.3.m3.1.1.2.3.4.2" xref="S3.SS3.SSS2.p4.3.m3.1.1.2.3.4.2.cmml">U</mi><mi id="S3.SS3.SSS2.p4.3.m3.1.1.2.3.4.3" xref="S3.SS3.SSS2.p4.3.m3.1.1.2.3.4.3.cmml">Q</mi></msub></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.3.m3.1b"><apply id="S3.SS3.SSS2.p4.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.3.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p4.3.m3.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p4.3.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.3.m3.1.1.2.1.cmml" xref="S3.SS3.SSS2.p4.3.m3.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p4.3.m3.1.1.2.2.cmml" xref="S3.SS3.SSS2.p4.3.m3.1.1.2.2">𝑊</ci><apply id="S3.SS3.SSS2.p4.3.m3.1.1.2.3.cmml" xref="S3.SS3.SSS2.p4.3.m3.1.1.2.3"><times id="S3.SS3.SSS2.p4.3.m3.1.1.2.3.1.cmml" xref="S3.SS3.SSS2.p4.3.m3.1.1.2.3.1"></times><ci id="S3.SS3.SSS2.p4.3.m3.1.1.2.3.2.cmml" xref="S3.SS3.SSS2.p4.3.m3.1.1.2.3.2">𝐺</ci><ci id="S3.SS3.SSS2.p4.3.m3.1.1.2.3.3.cmml" xref="S3.SS3.SSS2.p4.3.m3.1.1.2.3.3">𝑆</ci><apply id="S3.SS3.SSS2.p4.3.m3.1.1.2.3.4.cmml" xref="S3.SS3.SSS2.p4.3.m3.1.1.2.3.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.3.m3.1.1.2.3.4.1.cmml" xref="S3.SS3.SSS2.p4.3.m3.1.1.2.3.4">subscript</csymbol><ci id="S3.SS3.SSS2.p4.3.m3.1.1.2.3.4.2.cmml" xref="S3.SS3.SSS2.p4.3.m3.1.1.2.3.4.2">𝑈</ci><ci id="S3.SS3.SSS2.p4.3.m3.1.1.2.3.4.3.cmml" xref="S3.SS3.SSS2.p4.3.m3.1.1.2.3.4.3">𝑄</ci></apply></apply></apply><ci id="S3.SS3.SSS2.p4.3.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p4.3.m3.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.3.m3.1c">W^{GSU_{Q}}_{h}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.3.m3.1d">italic_W start_POSTSUPERSCRIPT italic_G italic_S italic_U start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="W^{GSU_{K}}_{h}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.4.m4.1"><semantics id="S3.SS3.SSS2.p4.4.m4.1a"><msubsup id="S3.SS3.SSS2.p4.4.m4.1.1" xref="S3.SS3.SSS2.p4.4.m4.1.1.cmml"><mi id="S3.SS3.SSS2.p4.4.m4.1.1.2.2" xref="S3.SS3.SSS2.p4.4.m4.1.1.2.2.cmml">W</mi><mi id="S3.SS3.SSS2.p4.4.m4.1.1.3" xref="S3.SS3.SSS2.p4.4.m4.1.1.3.cmml">h</mi><mrow id="S3.SS3.SSS2.p4.4.m4.1.1.2.3" xref="S3.SS3.SSS2.p4.4.m4.1.1.2.3.cmml"><mi id="S3.SS3.SSS2.p4.4.m4.1.1.2.3.2" xref="S3.SS3.SSS2.p4.4.m4.1.1.2.3.2.cmml">G</mi><mo id="S3.SS3.SSS2.p4.4.m4.1.1.2.3.1" xref="S3.SS3.SSS2.p4.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p4.4.m4.1.1.2.3.3" xref="S3.SS3.SSS2.p4.4.m4.1.1.2.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p4.4.m4.1.1.2.3.1a" xref="S3.SS3.SSS2.p4.4.m4.1.1.2.3.1.cmml">⁢</mo><msub id="S3.SS3.SSS2.p4.4.m4.1.1.2.3.4" xref="S3.SS3.SSS2.p4.4.m4.1.1.2.3.4.cmml"><mi id="S3.SS3.SSS2.p4.4.m4.1.1.2.3.4.2" xref="S3.SS3.SSS2.p4.4.m4.1.1.2.3.4.2.cmml">U</mi><mi id="S3.SS3.SSS2.p4.4.m4.1.1.2.3.4.3" xref="S3.SS3.SSS2.p4.4.m4.1.1.2.3.4.3.cmml">K</mi></msub></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.4.m4.1b"><apply id="S3.SS3.SSS2.p4.4.m4.1.1.cmml" xref="S3.SS3.SSS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.4.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p4.4.m4.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p4.4.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.4.m4.1.1.2.1.cmml" xref="S3.SS3.SSS2.p4.4.m4.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p4.4.m4.1.1.2.2.cmml" xref="S3.SS3.SSS2.p4.4.m4.1.1.2.2">𝑊</ci><apply id="S3.SS3.SSS2.p4.4.m4.1.1.2.3.cmml" xref="S3.SS3.SSS2.p4.4.m4.1.1.2.3"><times id="S3.SS3.SSS2.p4.4.m4.1.1.2.3.1.cmml" xref="S3.SS3.SSS2.p4.4.m4.1.1.2.3.1"></times><ci id="S3.SS3.SSS2.p4.4.m4.1.1.2.3.2.cmml" xref="S3.SS3.SSS2.p4.4.m4.1.1.2.3.2">𝐺</ci><ci id="S3.SS3.SSS2.p4.4.m4.1.1.2.3.3.cmml" xref="S3.SS3.SSS2.p4.4.m4.1.1.2.3.3">𝑆</ci><apply id="S3.SS3.SSS2.p4.4.m4.1.1.2.3.4.cmml" xref="S3.SS3.SSS2.p4.4.m4.1.1.2.3.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.4.m4.1.1.2.3.4.1.cmml" xref="S3.SS3.SSS2.p4.4.m4.1.1.2.3.4">subscript</csymbol><ci id="S3.SS3.SSS2.p4.4.m4.1.1.2.3.4.2.cmml" xref="S3.SS3.SSS2.p4.4.m4.1.1.2.3.4.2">𝑈</ci><ci id="S3.SS3.SSS2.p4.4.m4.1.1.2.3.4.3.cmml" xref="S3.SS3.SSS2.p4.4.m4.1.1.2.3.4.3">𝐾</ci></apply></apply></apply><ci id="S3.SS3.SSS2.p4.4.m4.1.1.3.cmml" xref="S3.SS3.SSS2.p4.4.m4.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.4.m4.1c">W^{GSU_{K}}_{h}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.4.m4.1d">italic_W start_POSTSUPERSCRIPT italic_G italic_S italic_U start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> of queries and keys for each head in multi head attention are different from <math alttext="W^{PSU_{Q}}_{h}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.5.m5.1"><semantics id="S3.SS3.SSS2.p4.5.m5.1a"><msubsup id="S3.SS3.SSS2.p4.5.m5.1.1" xref="S3.SS3.SSS2.p4.5.m5.1.1.cmml"><mi id="S3.SS3.SSS2.p4.5.m5.1.1.2.2" xref="S3.SS3.SSS2.p4.5.m5.1.1.2.2.cmml">W</mi><mi id="S3.SS3.SSS2.p4.5.m5.1.1.3" xref="S3.SS3.SSS2.p4.5.m5.1.1.3.cmml">h</mi><mrow id="S3.SS3.SSS2.p4.5.m5.1.1.2.3" xref="S3.SS3.SSS2.p4.5.m5.1.1.2.3.cmml"><mi id="S3.SS3.SSS2.p4.5.m5.1.1.2.3.2" xref="S3.SS3.SSS2.p4.5.m5.1.1.2.3.2.cmml">P</mi><mo id="S3.SS3.SSS2.p4.5.m5.1.1.2.3.1" xref="S3.SS3.SSS2.p4.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p4.5.m5.1.1.2.3.3" xref="S3.SS3.SSS2.p4.5.m5.1.1.2.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p4.5.m5.1.1.2.3.1a" xref="S3.SS3.SSS2.p4.5.m5.1.1.2.3.1.cmml">⁢</mo><msub id="S3.SS3.SSS2.p4.5.m5.1.1.2.3.4" xref="S3.SS3.SSS2.p4.5.m5.1.1.2.3.4.cmml"><mi id="S3.SS3.SSS2.p4.5.m5.1.1.2.3.4.2" xref="S3.SS3.SSS2.p4.5.m5.1.1.2.3.4.2.cmml">U</mi><mi id="S3.SS3.SSS2.p4.5.m5.1.1.2.3.4.3" xref="S3.SS3.SSS2.p4.5.m5.1.1.2.3.4.3.cmml">Q</mi></msub></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.5.m5.1b"><apply id="S3.SS3.SSS2.p4.5.m5.1.1.cmml" xref="S3.SS3.SSS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.5.m5.1.1.1.cmml" xref="S3.SS3.SSS2.p4.5.m5.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p4.5.m5.1.1.2.cmml" xref="S3.SS3.SSS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.5.m5.1.1.2.1.cmml" xref="S3.SS3.SSS2.p4.5.m5.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p4.5.m5.1.1.2.2.cmml" xref="S3.SS3.SSS2.p4.5.m5.1.1.2.2">𝑊</ci><apply id="S3.SS3.SSS2.p4.5.m5.1.1.2.3.cmml" xref="S3.SS3.SSS2.p4.5.m5.1.1.2.3"><times id="S3.SS3.SSS2.p4.5.m5.1.1.2.3.1.cmml" xref="S3.SS3.SSS2.p4.5.m5.1.1.2.3.1"></times><ci id="S3.SS3.SSS2.p4.5.m5.1.1.2.3.2.cmml" xref="S3.SS3.SSS2.p4.5.m5.1.1.2.3.2">𝑃</ci><ci id="S3.SS3.SSS2.p4.5.m5.1.1.2.3.3.cmml" xref="S3.SS3.SSS2.p4.5.m5.1.1.2.3.3">𝑆</ci><apply id="S3.SS3.SSS2.p4.5.m5.1.1.2.3.4.cmml" xref="S3.SS3.SSS2.p4.5.m5.1.1.2.3.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.5.m5.1.1.2.3.4.1.cmml" xref="S3.SS3.SSS2.p4.5.m5.1.1.2.3.4">subscript</csymbol><ci id="S3.SS3.SSS2.p4.5.m5.1.1.2.3.4.2.cmml" xref="S3.SS3.SSS2.p4.5.m5.1.1.2.3.4.2">𝑈</ci><ci id="S3.SS3.SSS2.p4.5.m5.1.1.2.3.4.3.cmml" xref="S3.SS3.SSS2.p4.5.m5.1.1.2.3.4.3">𝑄</ci></apply></apply></apply><ci id="S3.SS3.SSS2.p4.5.m5.1.1.3.cmml" xref="S3.SS3.SSS2.p4.5.m5.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.5.m5.1c">W^{PSU_{Q}}_{h}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.5.m5.1d">italic_W start_POSTSUPERSCRIPT italic_P italic_S italic_U start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="W^{PSU_{K}}_{h}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.6.m6.1"><semantics id="S3.SS3.SSS2.p4.6.m6.1a"><msubsup id="S3.SS3.SSS2.p4.6.m6.1.1" xref="S3.SS3.SSS2.p4.6.m6.1.1.cmml"><mi id="S3.SS3.SSS2.p4.6.m6.1.1.2.2" xref="S3.SS3.SSS2.p4.6.m6.1.1.2.2.cmml">W</mi><mi id="S3.SS3.SSS2.p4.6.m6.1.1.3" xref="S3.SS3.SSS2.p4.6.m6.1.1.3.cmml">h</mi><mrow id="S3.SS3.SSS2.p4.6.m6.1.1.2.3" xref="S3.SS3.SSS2.p4.6.m6.1.1.2.3.cmml"><mi id="S3.SS3.SSS2.p4.6.m6.1.1.2.3.2" xref="S3.SS3.SSS2.p4.6.m6.1.1.2.3.2.cmml">P</mi><mo id="S3.SS3.SSS2.p4.6.m6.1.1.2.3.1" xref="S3.SS3.SSS2.p4.6.m6.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p4.6.m6.1.1.2.3.3" xref="S3.SS3.SSS2.p4.6.m6.1.1.2.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p4.6.m6.1.1.2.3.1a" xref="S3.SS3.SSS2.p4.6.m6.1.1.2.3.1.cmml">⁢</mo><msub id="S3.SS3.SSS2.p4.6.m6.1.1.2.3.4" xref="S3.SS3.SSS2.p4.6.m6.1.1.2.3.4.cmml"><mi id="S3.SS3.SSS2.p4.6.m6.1.1.2.3.4.2" xref="S3.SS3.SSS2.p4.6.m6.1.1.2.3.4.2.cmml">U</mi><mi id="S3.SS3.SSS2.p4.6.m6.1.1.2.3.4.3" xref="S3.SS3.SSS2.p4.6.m6.1.1.2.3.4.3.cmml">K</mi></msub></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.6.m6.1b"><apply id="S3.SS3.SSS2.p4.6.m6.1.1.cmml" xref="S3.SS3.SSS2.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.6.m6.1.1.1.cmml" xref="S3.SS3.SSS2.p4.6.m6.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p4.6.m6.1.1.2.cmml" xref="S3.SS3.SSS2.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.6.m6.1.1.2.1.cmml" xref="S3.SS3.SSS2.p4.6.m6.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p4.6.m6.1.1.2.2.cmml" xref="S3.SS3.SSS2.p4.6.m6.1.1.2.2">𝑊</ci><apply id="S3.SS3.SSS2.p4.6.m6.1.1.2.3.cmml" xref="S3.SS3.SSS2.p4.6.m6.1.1.2.3"><times id="S3.SS3.SSS2.p4.6.m6.1.1.2.3.1.cmml" xref="S3.SS3.SSS2.p4.6.m6.1.1.2.3.1"></times><ci id="S3.SS3.SSS2.p4.6.m6.1.1.2.3.2.cmml" xref="S3.SS3.SSS2.p4.6.m6.1.1.2.3.2">𝑃</ci><ci id="S3.SS3.SSS2.p4.6.m6.1.1.2.3.3.cmml" xref="S3.SS3.SSS2.p4.6.m6.1.1.2.3.3">𝑆</ci><apply id="S3.SS3.SSS2.p4.6.m6.1.1.2.3.4.cmml" xref="S3.SS3.SSS2.p4.6.m6.1.1.2.3.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.6.m6.1.1.2.3.4.1.cmml" xref="S3.SS3.SSS2.p4.6.m6.1.1.2.3.4">subscript</csymbol><ci id="S3.SS3.SSS2.p4.6.m6.1.1.2.3.4.2.cmml" xref="S3.SS3.SSS2.p4.6.m6.1.1.2.3.4.2">𝑈</ci><ci id="S3.SS3.SSS2.p4.6.m6.1.1.2.3.4.3.cmml" xref="S3.SS3.SSS2.p4.6.m6.1.1.2.3.4.3">𝐾</ci></apply></apply></apply><ci id="S3.SS3.SSS2.p4.6.m6.1.1.3.cmml" xref="S3.SS3.SSS2.p4.6.m6.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.6.m6.1c">W^{PSU_{K}}_{h}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.6.m6.1d">italic_W start_POSTSUPERSCRIPT italic_P italic_S italic_U start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math>. And the embedding projection weight matrix <math alttext="G_{j}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.7.m7.1"><semantics id="S3.SS3.SSS2.p4.7.m7.1a"><msub id="S3.SS3.SSS2.p4.7.m7.1.1" xref="S3.SS3.SSS2.p4.7.m7.1.1.cmml"><mi id="S3.SS3.SSS2.p4.7.m7.1.1.2" xref="S3.SS3.SSS2.p4.7.m7.1.1.2.cmml">G</mi><mi id="S3.SS3.SSS2.p4.7.m7.1.1.3" xref="S3.SS3.SSS2.p4.7.m7.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.7.m7.1b"><apply id="S3.SS3.SSS2.p4.7.m7.1.1.cmml" xref="S3.SS3.SSS2.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.7.m7.1.1.1.cmml" xref="S3.SS3.SSS2.p4.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p4.7.m7.1.1.2.cmml" xref="S3.SS3.SSS2.p4.7.m7.1.1.2">𝐺</ci><ci id="S3.SS3.SSS2.p4.7.m7.1.1.3.cmml" xref="S3.SS3.SSS2.p4.7.m7.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.7.m7.1c">G_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.7.m7.1d">italic_G start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is unique to GSU.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p5">
<p class="ltx_p" id="S3.SS3.SSS2.p5.1">In the second stage, the top-K relevant query-item pairs are selected from GSU and fed to Exact Search Unit (ESU) as <math alttext="head^{ESU_{h}}=\text{Attention}_{h}(q_{t},K^{ESU},V^{ESU})" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p5.1.m1.3"><semantics id="S3.SS3.SSS2.p5.1.m1.3a"><mrow id="S3.SS3.SSS2.p5.1.m1.3.3" xref="S3.SS3.SSS2.p5.1.m1.3.3.cmml"><mrow id="S3.SS3.SSS2.p5.1.m1.3.3.5" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.cmml"><mi id="S3.SS3.SSS2.p5.1.m1.3.3.5.2" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.2.cmml">h</mi><mo id="S3.SS3.SSS2.p5.1.m1.3.3.5.1" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p5.1.m1.3.3.5.3" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.3.cmml">e</mi><mo id="S3.SS3.SSS2.p5.1.m1.3.3.5.1a" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p5.1.m1.3.3.5.4" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.4.cmml">a</mi><mo id="S3.SS3.SSS2.p5.1.m1.3.3.5.1b" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.1.cmml">⁢</mo><msup id="S3.SS3.SSS2.p5.1.m1.3.3.5.5" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5.cmml"><mi id="S3.SS3.SSS2.p5.1.m1.3.3.5.5.2" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5.2.cmml">d</mi><mrow id="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.cmml"><mi id="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.2" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.2.cmml">E</mi><mo id="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.1" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.3" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.1a" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.1.cmml">⁢</mo><msub id="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.4" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.4.cmml"><mi id="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.4.2" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.4.2.cmml">U</mi><mi id="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.4.3" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.4.3.cmml">h</mi></msub></mrow></msup></mrow><mo id="S3.SS3.SSS2.p5.1.m1.3.3.4" xref="S3.SS3.SSS2.p5.1.m1.3.3.4.cmml">=</mo><mrow id="S3.SS3.SSS2.p5.1.m1.3.3.3" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.cmml"><msub id="S3.SS3.SSS2.p5.1.m1.3.3.3.5" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.5.cmml"><mtext id="S3.SS3.SSS2.p5.1.m1.3.3.3.5.2" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.5.2a.cmml">Attention</mtext><mi id="S3.SS3.SSS2.p5.1.m1.3.3.3.5.3" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.5.3.cmml">h</mi></msub><mo id="S3.SS3.SSS2.p5.1.m1.3.3.3.4" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.4.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.4.cmml"><mo id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.4" stretchy="false" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.4.cmml">(</mo><msub id="S3.SS3.SSS2.p5.1.m1.1.1.1.1.1.1" xref="S3.SS3.SSS2.p5.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p5.1.m1.1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p5.1.m1.1.1.1.1.1.1.2.cmml">q</mi><mi id="S3.SS3.SSS2.p5.1.m1.1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p5.1.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.5" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.4.cmml">,</mo><msup id="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2" xref="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.2" xref="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.2.cmml">K</mi><mrow id="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3" xref="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3.cmml"><mi id="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3.2" xref="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3.2.cmml">E</mi><mo id="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3.1" xref="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3.3" xref="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3.1a" xref="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3.4" xref="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3.4.cmml">U</mi></mrow></msup><mo id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.6" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.4.cmml">,</mo><msup id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.cmml"><mi id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.2" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.2.cmml">V</mi><mrow id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3.cmml"><mi id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3.2" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3.2.cmml">E</mi><mo id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3.1" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3.3" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3.1a" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3.4" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3.4.cmml">U</mi></mrow></msup><mo id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.7" stretchy="false" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p5.1.m1.3b"><apply id="S3.SS3.SSS2.p5.1.m1.3.3.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3"><eq id="S3.SS3.SSS2.p5.1.m1.3.3.4.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.4"></eq><apply id="S3.SS3.SSS2.p5.1.m1.3.3.5.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.5"><times id="S3.SS3.SSS2.p5.1.m1.3.3.5.1.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.1"></times><ci id="S3.SS3.SSS2.p5.1.m1.3.3.5.2.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.2">ℎ</ci><ci id="S3.SS3.SSS2.p5.1.m1.3.3.5.3.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.3">𝑒</ci><ci id="S3.SS3.SSS2.p5.1.m1.3.3.5.4.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.4">𝑎</ci><apply id="S3.SS3.SSS2.p5.1.m1.3.3.5.5.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p5.1.m1.3.3.5.5.1.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5">superscript</csymbol><ci id="S3.SS3.SSS2.p5.1.m1.3.3.5.5.2.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5.2">𝑑</ci><apply id="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3"><times id="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.1.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.1"></times><ci id="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.2.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.2">𝐸</ci><ci id="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.3.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.3">𝑆</ci><apply id="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.4.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.4.1.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.4">subscript</csymbol><ci id="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.4.2.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.4.2">𝑈</ci><ci id="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.4.3.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.5.5.3.4.3">ℎ</ci></apply></apply></apply></apply><apply id="S3.SS3.SSS2.p5.1.m1.3.3.3.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.3"><times id="S3.SS3.SSS2.p5.1.m1.3.3.3.4.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.4"></times><apply id="S3.SS3.SSS2.p5.1.m1.3.3.3.5.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.5"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p5.1.m1.3.3.3.5.1.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.5">subscript</csymbol><ci id="S3.SS3.SSS2.p5.1.m1.3.3.3.5.2a.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.5.2"><mtext id="S3.SS3.SSS2.p5.1.m1.3.3.3.5.2.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.5.2">Attention</mtext></ci><ci id="S3.SS3.SSS2.p5.1.m1.3.3.3.5.3.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.5.3">ℎ</ci></apply><vector id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.4.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3"><apply id="S3.SS3.SSS2.p5.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p5.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p5.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p5.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p5.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p5.1.m1.1.1.1.1.1.1.2">𝑞</ci><ci id="S3.SS3.SSS2.p5.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p5.1.m1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2">superscript</csymbol><ci id="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.2">𝐾</ci><apply id="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3"><times id="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3.1.cmml" xref="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3.1"></times><ci id="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3.2.cmml" xref="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3.2">𝐸</ci><ci id="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3.3.cmml" xref="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3.3">𝑆</ci><ci id="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3.4.cmml" xref="S3.SS3.SSS2.p5.1.m1.2.2.2.2.2.2.3.4">𝑈</ci></apply></apply><apply id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.1.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3">superscript</csymbol><ci id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.2.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.2">𝑉</ci><apply id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3"><times id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3.1.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3.1"></times><ci id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3.2.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3.2">𝐸</ci><ci id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3.3">𝑆</ci><ci id="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3.4.cmml" xref="S3.SS3.SSS2.p5.1.m1.3.3.3.3.3.3.3.4">𝑈</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p5.1.m1.3c">head^{ESU_{h}}=\text{Attention}_{h}(q_{t},K^{ESU},V^{ESU})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p5.1.m1.3d">italic_h italic_e italic_a italic_d start_POSTSUPERSCRIPT italic_E italic_S italic_U start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT = Attention start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_K start_POSTSUPERSCRIPT italic_E italic_S italic_U end_POSTSUPERSCRIPT , italic_V start_POSTSUPERSCRIPT italic_E italic_S italic_U end_POSTSUPERSCRIPT )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p6">
<p class="ltx_p" id="S3.SS3.SSS2.p6.4">In ESU, <math alttext="K^{ESU}=\text{TopK}(K^{GSU})\in\mathbb{R}^{(M+1)\times K\times D}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p6.1.m1.2"><semantics id="S3.SS3.SSS2.p6.1.m1.2a"><mrow id="S3.SS3.SSS2.p6.1.m1.2.2" xref="S3.SS3.SSS2.p6.1.m1.2.2.cmml"><msup id="S3.SS3.SSS2.p6.1.m1.2.2.3" xref="S3.SS3.SSS2.p6.1.m1.2.2.3.cmml"><mi id="S3.SS3.SSS2.p6.1.m1.2.2.3.2" xref="S3.SS3.SSS2.p6.1.m1.2.2.3.2.cmml">K</mi><mrow id="S3.SS3.SSS2.p6.1.m1.2.2.3.3" xref="S3.SS3.SSS2.p6.1.m1.2.2.3.3.cmml"><mi id="S3.SS3.SSS2.p6.1.m1.2.2.3.3.2" xref="S3.SS3.SSS2.p6.1.m1.2.2.3.3.2.cmml">E</mi><mo id="S3.SS3.SSS2.p6.1.m1.2.2.3.3.1" xref="S3.SS3.SSS2.p6.1.m1.2.2.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p6.1.m1.2.2.3.3.3" xref="S3.SS3.SSS2.p6.1.m1.2.2.3.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p6.1.m1.2.2.3.3.1a" xref="S3.SS3.SSS2.p6.1.m1.2.2.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p6.1.m1.2.2.3.3.4" xref="S3.SS3.SSS2.p6.1.m1.2.2.3.3.4.cmml">U</mi></mrow></msup><mo id="S3.SS3.SSS2.p6.1.m1.2.2.4" xref="S3.SS3.SSS2.p6.1.m1.2.2.4.cmml">=</mo><mrow id="S3.SS3.SSS2.p6.1.m1.2.2.1" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.cmml"><mtext id="S3.SS3.SSS2.p6.1.m1.2.2.1.3" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.3a.cmml">TopK</mtext><mo id="S3.SS3.SSS2.p6.1.m1.2.2.1.2" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.cmml"><mo id="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.cmml">(</mo><msup id="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.2" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.2.cmml">K</mi><mrow id="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3.2" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3.2.cmml">G</mi><mo id="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3.1" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3.3" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3.1a" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3.4" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3.4.cmml">U</mi></mrow></msup><mo id="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.3" stretchy="false" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS2.p6.1.m1.2.2.5" xref="S3.SS3.SSS2.p6.1.m1.2.2.5.cmml">∈</mo><msup id="S3.SS3.SSS2.p6.1.m1.2.2.6" xref="S3.SS3.SSS2.p6.1.m1.2.2.6.cmml"><mi id="S3.SS3.SSS2.p6.1.m1.2.2.6.2" xref="S3.SS3.SSS2.p6.1.m1.2.2.6.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS2.p6.1.m1.1.1.1" xref="S3.SS3.SSS2.p6.1.m1.1.1.1.cmml"><mrow id="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1" xref="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1.1" xref="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1.1.2.cmml">M</mi><mo id="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1.1.1" xref="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS3.SSS2.p6.1.m1.1.1.1.2" rspace="0.222em" xref="S3.SS3.SSS2.p6.1.m1.1.1.1.2.cmml">×</mo><mi id="S3.SS3.SSS2.p6.1.m1.1.1.1.3" xref="S3.SS3.SSS2.p6.1.m1.1.1.1.3.cmml">K</mi><mo id="S3.SS3.SSS2.p6.1.m1.1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS2.p6.1.m1.1.1.1.2.cmml">×</mo><mi id="S3.SS3.SSS2.p6.1.m1.1.1.1.4" xref="S3.SS3.SSS2.p6.1.m1.1.1.1.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.1.m1.2b"><apply id="S3.SS3.SSS2.p6.1.m1.2.2.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2"><and id="S3.SS3.SSS2.p6.1.m1.2.2a.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2"></and><apply id="S3.SS3.SSS2.p6.1.m1.2.2b.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2"><eq id="S3.SS3.SSS2.p6.1.m1.2.2.4.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.4"></eq><apply id="S3.SS3.SSS2.p6.1.m1.2.2.3.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.1.m1.2.2.3.1.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.3">superscript</csymbol><ci id="S3.SS3.SSS2.p6.1.m1.2.2.3.2.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.3.2">𝐾</ci><apply id="S3.SS3.SSS2.p6.1.m1.2.2.3.3.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.3.3"><times id="S3.SS3.SSS2.p6.1.m1.2.2.3.3.1.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.3.3.1"></times><ci id="S3.SS3.SSS2.p6.1.m1.2.2.3.3.2.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.3.3.2">𝐸</ci><ci id="S3.SS3.SSS2.p6.1.m1.2.2.3.3.3.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.3.3.3">𝑆</ci><ci id="S3.SS3.SSS2.p6.1.m1.2.2.3.3.4.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.3.3.4">𝑈</ci></apply></apply><apply id="S3.SS3.SSS2.p6.1.m1.2.2.1.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.1"><times id="S3.SS3.SSS2.p6.1.m1.2.2.1.2.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.2"></times><ci id="S3.SS3.SSS2.p6.1.m1.2.2.1.3a.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.3"><mtext id="S3.SS3.SSS2.p6.1.m1.2.2.1.3.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.3">TopK</mtext></ci><apply id="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.2">𝐾</ci><apply id="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3"><times id="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3.1"></times><ci id="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3.2">𝐺</ci><ci id="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3.3">𝑆</ci><ci id="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3.4.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.1.1.1.1.3.4">𝑈</ci></apply></apply></apply></apply><apply id="S3.SS3.SSS2.p6.1.m1.2.2c.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2"><in id="S3.SS3.SSS2.p6.1.m1.2.2.5.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.5"></in><share href="https://arxiv.org/html/2407.10714v1#S3.SS3.SSS2.p6.1.m1.2.2.1.cmml" id="S3.SS3.SSS2.p6.1.m1.2.2d.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2"></share><apply id="S3.SS3.SSS2.p6.1.m1.2.2.6.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.6"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.1.m1.2.2.6.1.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.6">superscript</csymbol><ci id="S3.SS3.SSS2.p6.1.m1.2.2.6.2.cmml" xref="S3.SS3.SSS2.p6.1.m1.2.2.6.2">ℝ</ci><apply id="S3.SS3.SSS2.p6.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p6.1.m1.1.1.1"><times id="S3.SS3.SSS2.p6.1.m1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p6.1.m1.1.1.1.2"></times><apply id="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1"><plus id="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1.1.1"></plus><ci id="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1.1.2">𝑀</ci><cn id="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS2.p6.1.m1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.SS3.SSS2.p6.1.m1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p6.1.m1.1.1.1.3">𝐾</ci><ci id="S3.SS3.SSS2.p6.1.m1.1.1.1.4.cmml" xref="S3.SS3.SSS2.p6.1.m1.1.1.1.4">𝐷</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.1.m1.2c">K^{ESU}=\text{TopK}(K^{GSU})\in\mathbb{R}^{(M+1)\times K\times D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p6.1.m1.2d">italic_K start_POSTSUPERSCRIPT italic_E italic_S italic_U end_POSTSUPERSCRIPT = TopK ( italic_K start_POSTSUPERSCRIPT italic_G italic_S italic_U end_POSTSUPERSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_M + 1 ) × italic_K × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> represents the sequence of retrieved top-K representations from <math alttext="K^{GSU}\in\mathbb{R}^{(M+1)\times L\times D}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p6.2.m2.1"><semantics id="S3.SS3.SSS2.p6.2.m2.1a"><mrow id="S3.SS3.SSS2.p6.2.m2.1.2" xref="S3.SS3.SSS2.p6.2.m2.1.2.cmml"><msup id="S3.SS3.SSS2.p6.2.m2.1.2.2" xref="S3.SS3.SSS2.p6.2.m2.1.2.2.cmml"><mi id="S3.SS3.SSS2.p6.2.m2.1.2.2.2" xref="S3.SS3.SSS2.p6.2.m2.1.2.2.2.cmml">K</mi><mrow id="S3.SS3.SSS2.p6.2.m2.1.2.2.3" xref="S3.SS3.SSS2.p6.2.m2.1.2.2.3.cmml"><mi id="S3.SS3.SSS2.p6.2.m2.1.2.2.3.2" xref="S3.SS3.SSS2.p6.2.m2.1.2.2.3.2.cmml">G</mi><mo id="S3.SS3.SSS2.p6.2.m2.1.2.2.3.1" xref="S3.SS3.SSS2.p6.2.m2.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p6.2.m2.1.2.2.3.3" xref="S3.SS3.SSS2.p6.2.m2.1.2.2.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p6.2.m2.1.2.2.3.1a" xref="S3.SS3.SSS2.p6.2.m2.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p6.2.m2.1.2.2.3.4" xref="S3.SS3.SSS2.p6.2.m2.1.2.2.3.4.cmml">U</mi></mrow></msup><mo id="S3.SS3.SSS2.p6.2.m2.1.2.1" xref="S3.SS3.SSS2.p6.2.m2.1.2.1.cmml">∈</mo><msup id="S3.SS3.SSS2.p6.2.m2.1.2.3" xref="S3.SS3.SSS2.p6.2.m2.1.2.3.cmml"><mi id="S3.SS3.SSS2.p6.2.m2.1.2.3.2" xref="S3.SS3.SSS2.p6.2.m2.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS2.p6.2.m2.1.1.1" xref="S3.SS3.SSS2.p6.2.m2.1.1.1.cmml"><mrow id="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1" xref="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1.1" xref="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1.1.2.cmml">M</mi><mo id="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1.1.1" xref="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS3.SSS2.p6.2.m2.1.1.1.2" rspace="0.222em" xref="S3.SS3.SSS2.p6.2.m2.1.1.1.2.cmml">×</mo><mi id="S3.SS3.SSS2.p6.2.m2.1.1.1.3" xref="S3.SS3.SSS2.p6.2.m2.1.1.1.3.cmml">L</mi><mo id="S3.SS3.SSS2.p6.2.m2.1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS2.p6.2.m2.1.1.1.2.cmml">×</mo><mi id="S3.SS3.SSS2.p6.2.m2.1.1.1.4" xref="S3.SS3.SSS2.p6.2.m2.1.1.1.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.2.m2.1b"><apply id="S3.SS3.SSS2.p6.2.m2.1.2.cmml" xref="S3.SS3.SSS2.p6.2.m2.1.2"><in id="S3.SS3.SSS2.p6.2.m2.1.2.1.cmml" xref="S3.SS3.SSS2.p6.2.m2.1.2.1"></in><apply id="S3.SS3.SSS2.p6.2.m2.1.2.2.cmml" xref="S3.SS3.SSS2.p6.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.2.m2.1.2.2.1.cmml" xref="S3.SS3.SSS2.p6.2.m2.1.2.2">superscript</csymbol><ci id="S3.SS3.SSS2.p6.2.m2.1.2.2.2.cmml" xref="S3.SS3.SSS2.p6.2.m2.1.2.2.2">𝐾</ci><apply id="S3.SS3.SSS2.p6.2.m2.1.2.2.3.cmml" xref="S3.SS3.SSS2.p6.2.m2.1.2.2.3"><times id="S3.SS3.SSS2.p6.2.m2.1.2.2.3.1.cmml" xref="S3.SS3.SSS2.p6.2.m2.1.2.2.3.1"></times><ci id="S3.SS3.SSS2.p6.2.m2.1.2.2.3.2.cmml" xref="S3.SS3.SSS2.p6.2.m2.1.2.2.3.2">𝐺</ci><ci id="S3.SS3.SSS2.p6.2.m2.1.2.2.3.3.cmml" xref="S3.SS3.SSS2.p6.2.m2.1.2.2.3.3">𝑆</ci><ci id="S3.SS3.SSS2.p6.2.m2.1.2.2.3.4.cmml" xref="S3.SS3.SSS2.p6.2.m2.1.2.2.3.4">𝑈</ci></apply></apply><apply id="S3.SS3.SSS2.p6.2.m2.1.2.3.cmml" xref="S3.SS3.SSS2.p6.2.m2.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.2.m2.1.2.3.1.cmml" xref="S3.SS3.SSS2.p6.2.m2.1.2.3">superscript</csymbol><ci id="S3.SS3.SSS2.p6.2.m2.1.2.3.2.cmml" xref="S3.SS3.SSS2.p6.2.m2.1.2.3.2">ℝ</ci><apply id="S3.SS3.SSS2.p6.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p6.2.m2.1.1.1"><times id="S3.SS3.SSS2.p6.2.m2.1.1.1.2.cmml" xref="S3.SS3.SSS2.p6.2.m2.1.1.1.2"></times><apply id="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1"><plus id="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1.1.1"></plus><ci id="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1.1.2">𝑀</ci><cn id="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS2.p6.2.m2.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.SS3.SSS2.p6.2.m2.1.1.1.3.cmml" xref="S3.SS3.SSS2.p6.2.m2.1.1.1.3">𝐿</ci><ci id="S3.SS3.SSS2.p6.2.m2.1.1.1.4.cmml" xref="S3.SS3.SSS2.p6.2.m2.1.1.1.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.2.m2.1c">K^{GSU}\in\mathbb{R}^{(M+1)\times L\times D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p6.2.m2.1d">italic_K start_POSTSUPERSCRIPT italic_G italic_S italic_U end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_M + 1 ) × italic_L × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>. The attention score in ESU is denoted as <math alttext="\alpha^{ESU}_{h}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p6.3.m3.1"><semantics id="S3.SS3.SSS2.p6.3.m3.1a"><msubsup id="S3.SS3.SSS2.p6.3.m3.1.1" xref="S3.SS3.SSS2.p6.3.m3.1.1.cmml"><mi id="S3.SS3.SSS2.p6.3.m3.1.1.2.2" xref="S3.SS3.SSS2.p6.3.m3.1.1.2.2.cmml">α</mi><mi id="S3.SS3.SSS2.p6.3.m3.1.1.3" xref="S3.SS3.SSS2.p6.3.m3.1.1.3.cmml">h</mi><mrow id="S3.SS3.SSS2.p6.3.m3.1.1.2.3" xref="S3.SS3.SSS2.p6.3.m3.1.1.2.3.cmml"><mi id="S3.SS3.SSS2.p6.3.m3.1.1.2.3.2" xref="S3.SS3.SSS2.p6.3.m3.1.1.2.3.2.cmml">E</mi><mo id="S3.SS3.SSS2.p6.3.m3.1.1.2.3.1" xref="S3.SS3.SSS2.p6.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p6.3.m3.1.1.2.3.3" xref="S3.SS3.SSS2.p6.3.m3.1.1.2.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p6.3.m3.1.1.2.3.1a" xref="S3.SS3.SSS2.p6.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p6.3.m3.1.1.2.3.4" xref="S3.SS3.SSS2.p6.3.m3.1.1.2.3.4.cmml">U</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.3.m3.1b"><apply id="S3.SS3.SSS2.p6.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.3.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p6.3.m3.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p6.3.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.3.m3.1.1.2.1.cmml" xref="S3.SS3.SSS2.p6.3.m3.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p6.3.m3.1.1.2.2.cmml" xref="S3.SS3.SSS2.p6.3.m3.1.1.2.2">𝛼</ci><apply id="S3.SS3.SSS2.p6.3.m3.1.1.2.3.cmml" xref="S3.SS3.SSS2.p6.3.m3.1.1.2.3"><times id="S3.SS3.SSS2.p6.3.m3.1.1.2.3.1.cmml" xref="S3.SS3.SSS2.p6.3.m3.1.1.2.3.1"></times><ci id="S3.SS3.SSS2.p6.3.m3.1.1.2.3.2.cmml" xref="S3.SS3.SSS2.p6.3.m3.1.1.2.3.2">𝐸</ci><ci id="S3.SS3.SSS2.p6.3.m3.1.1.2.3.3.cmml" xref="S3.SS3.SSS2.p6.3.m3.1.1.2.3.3">𝑆</ci><ci id="S3.SS3.SSS2.p6.3.m3.1.1.2.3.4.cmml" xref="S3.SS3.SSS2.p6.3.m3.1.1.2.3.4">𝑈</ci></apply></apply><ci id="S3.SS3.SSS2.p6.3.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p6.3.m3.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.3.m3.1c">\alpha^{ESU}_{h}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p6.3.m3.1d">italic_α start_POSTSUPERSCRIPT italic_E italic_S italic_U end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> and the ID embedding in ESU is denoted as <math alttext="\mathbb{x}^{ESU(j)}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p6.4.m4.1"><semantics id="S3.SS3.SSS2.p6.4.m4.1a"><msup id="S3.SS3.SSS2.p6.4.m4.1.2" xref="S3.SS3.SSS2.p6.4.m4.1.2.cmml"><mi id="S3.SS3.SSS2.p6.4.m4.1.2.2" xref="S3.SS3.SSS2.p6.4.m4.1.2.2.cmml">𝕩</mi><mrow id="S3.SS3.SSS2.p6.4.m4.1.1.1" xref="S3.SS3.SSS2.p6.4.m4.1.1.1.cmml"><mi id="S3.SS3.SSS2.p6.4.m4.1.1.1.3" xref="S3.SS3.SSS2.p6.4.m4.1.1.1.3.cmml">E</mi><mo id="S3.SS3.SSS2.p6.4.m4.1.1.1.2" xref="S3.SS3.SSS2.p6.4.m4.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS2.p6.4.m4.1.1.1.4" xref="S3.SS3.SSS2.p6.4.m4.1.1.1.4.cmml">S</mi><mo id="S3.SS3.SSS2.p6.4.m4.1.1.1.2a" xref="S3.SS3.SSS2.p6.4.m4.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.SSS2.p6.4.m4.1.1.1.5" xref="S3.SS3.SSS2.p6.4.m4.1.1.1.5.cmml">U</mi><mo id="S3.SS3.SSS2.p6.4.m4.1.1.1.2b" xref="S3.SS3.SSS2.p6.4.m4.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p6.4.m4.1.1.1.6.2" xref="S3.SS3.SSS2.p6.4.m4.1.1.1.cmml"><mo id="S3.SS3.SSS2.p6.4.m4.1.1.1.6.2.1" stretchy="false" xref="S3.SS3.SSS2.p6.4.m4.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS2.p6.4.m4.1.1.1.1" xref="S3.SS3.SSS2.p6.4.m4.1.1.1.1.cmml">j</mi><mo id="S3.SS3.SSS2.p6.4.m4.1.1.1.6.2.2" stretchy="false" xref="S3.SS3.SSS2.p6.4.m4.1.1.1.cmml">)</mo></mrow></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.4.m4.1b"><apply id="S3.SS3.SSS2.p6.4.m4.1.2.cmml" xref="S3.SS3.SSS2.p6.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.4.m4.1.2.1.cmml" xref="S3.SS3.SSS2.p6.4.m4.1.2">superscript</csymbol><ci id="S3.SS3.SSS2.p6.4.m4.1.2.2.cmml" xref="S3.SS3.SSS2.p6.4.m4.1.2.2">𝕩</ci><apply id="S3.SS3.SSS2.p6.4.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p6.4.m4.1.1.1"><times id="S3.SS3.SSS2.p6.4.m4.1.1.1.2.cmml" xref="S3.SS3.SSS2.p6.4.m4.1.1.1.2"></times><ci id="S3.SS3.SSS2.p6.4.m4.1.1.1.3.cmml" xref="S3.SS3.SSS2.p6.4.m4.1.1.1.3">𝐸</ci><ci id="S3.SS3.SSS2.p6.4.m4.1.1.1.4.cmml" xref="S3.SS3.SSS2.p6.4.m4.1.1.1.4">𝑆</ci><ci id="S3.SS3.SSS2.p6.4.m4.1.1.1.5.cmml" xref="S3.SS3.SSS2.p6.4.m4.1.1.1.5">𝑈</ci><ci id="S3.SS3.SSS2.p6.4.m4.1.1.1.1.cmml" xref="S3.SS3.SSS2.p6.4.m4.1.1.1.1">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.4.m4.1c">\mathbb{x}^{ESU(j)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p6.4.m4.1d">blackboard_x start_POSTSUPERSCRIPT italic_E italic_S italic_U ( italic_j ) end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p7">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\alpha^{ESU}_{h}=\frac{(q_{t}W^{ESU_{Q}}_{h})(K^{ESU}W^{ESU_{K}}_{h})^{T}}{%
\sqrt{d}}" class="ltx_Math" display="block" id="S3.Ex8.m1.2"><semantics id="S3.Ex8.m1.2a"><mrow id="S3.Ex8.m1.2.3" xref="S3.Ex8.m1.2.3.cmml"><msubsup id="S3.Ex8.m1.2.3.2" xref="S3.Ex8.m1.2.3.2.cmml"><mi id="S3.Ex8.m1.2.3.2.2.2" xref="S3.Ex8.m1.2.3.2.2.2.cmml">α</mi><mi id="S3.Ex8.m1.2.3.2.3" xref="S3.Ex8.m1.2.3.2.3.cmml">h</mi><mrow id="S3.Ex8.m1.2.3.2.2.3" xref="S3.Ex8.m1.2.3.2.2.3.cmml"><mi id="S3.Ex8.m1.2.3.2.2.3.2" xref="S3.Ex8.m1.2.3.2.2.3.2.cmml">E</mi><mo id="S3.Ex8.m1.2.3.2.2.3.1" xref="S3.Ex8.m1.2.3.2.2.3.1.cmml">⁢</mo><mi id="S3.Ex8.m1.2.3.2.2.3.3" xref="S3.Ex8.m1.2.3.2.2.3.3.cmml">S</mi><mo id="S3.Ex8.m1.2.3.2.2.3.1a" xref="S3.Ex8.m1.2.3.2.2.3.1.cmml">⁢</mo><mi id="S3.Ex8.m1.2.3.2.2.3.4" xref="S3.Ex8.m1.2.3.2.2.3.4.cmml">U</mi></mrow></msubsup><mo id="S3.Ex8.m1.2.3.1" xref="S3.Ex8.m1.2.3.1.cmml">=</mo><mfrac id="S3.Ex8.m1.2.2" xref="S3.Ex8.m1.2.2.cmml"><mrow id="S3.Ex8.m1.2.2.2" xref="S3.Ex8.m1.2.2.2.cmml"><mrow id="S3.Ex8.m1.1.1.1.1.1" xref="S3.Ex8.m1.1.1.1.1.1.1.cmml"><mo id="S3.Ex8.m1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex8.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex8.m1.1.1.1.1.1.1" xref="S3.Ex8.m1.1.1.1.1.1.1.cmml"><msub id="S3.Ex8.m1.1.1.1.1.1.1.2" xref="S3.Ex8.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex8.m1.1.1.1.1.1.1.2.2" xref="S3.Ex8.m1.1.1.1.1.1.1.2.2.cmml">q</mi><mi id="S3.Ex8.m1.1.1.1.1.1.1.2.3" xref="S3.Ex8.m1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.Ex8.m1.1.1.1.1.1.1.1" xref="S3.Ex8.m1.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S3.Ex8.m1.1.1.1.1.1.1.3" xref="S3.Ex8.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex8.m1.1.1.1.1.1.1.3.2.2" xref="S3.Ex8.m1.1.1.1.1.1.1.3.2.2.cmml">W</mi><mi id="S3.Ex8.m1.1.1.1.1.1.1.3.3" xref="S3.Ex8.m1.1.1.1.1.1.1.3.3.cmml">h</mi><mrow id="S3.Ex8.m1.1.1.1.1.1.1.3.2.3" xref="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.2" xref="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.2.cmml">E</mi><mo id="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.1" xref="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.3" xref="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.3.cmml">S</mi><mo id="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.1a" xref="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><msub id="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.4" xref="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.4.cmml"><mi id="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.4.2" xref="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.4.2.cmml">U</mi><mi id="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.4.3" xref="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.4.3.cmml">Q</mi></msub></mrow></msubsup></mrow><mo id="S3.Ex8.m1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex8.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex8.m1.2.2.2.3" xref="S3.Ex8.m1.2.2.2.3.cmml">⁢</mo><msup id="S3.Ex8.m1.2.2.2.2" xref="S3.Ex8.m1.2.2.2.2.cmml"><mrow id="S3.Ex8.m1.2.2.2.2.1.1" xref="S3.Ex8.m1.2.2.2.2.1.1.1.cmml"><mo id="S3.Ex8.m1.2.2.2.2.1.1.2" stretchy="false" xref="S3.Ex8.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.Ex8.m1.2.2.2.2.1.1.1" xref="S3.Ex8.m1.2.2.2.2.1.1.1.cmml"><msup id="S3.Ex8.m1.2.2.2.2.1.1.1.2" xref="S3.Ex8.m1.2.2.2.2.1.1.1.2.cmml"><mi id="S3.Ex8.m1.2.2.2.2.1.1.1.2.2" xref="S3.Ex8.m1.2.2.2.2.1.1.1.2.2.cmml">K</mi><mrow id="S3.Ex8.m1.2.2.2.2.1.1.1.2.3" xref="S3.Ex8.m1.2.2.2.2.1.1.1.2.3.cmml"><mi id="S3.Ex8.m1.2.2.2.2.1.1.1.2.3.2" xref="S3.Ex8.m1.2.2.2.2.1.1.1.2.3.2.cmml">E</mi><mo id="S3.Ex8.m1.2.2.2.2.1.1.1.2.3.1" xref="S3.Ex8.m1.2.2.2.2.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.Ex8.m1.2.2.2.2.1.1.1.2.3.3" xref="S3.Ex8.m1.2.2.2.2.1.1.1.2.3.3.cmml">S</mi><mo id="S3.Ex8.m1.2.2.2.2.1.1.1.2.3.1a" xref="S3.Ex8.m1.2.2.2.2.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.Ex8.m1.2.2.2.2.1.1.1.2.3.4" xref="S3.Ex8.m1.2.2.2.2.1.1.1.2.3.4.cmml">U</mi></mrow></msup><mo id="S3.Ex8.m1.2.2.2.2.1.1.1.1" xref="S3.Ex8.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><msubsup id="S3.Ex8.m1.2.2.2.2.1.1.1.3" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.cmml"><mi id="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.2" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.2.cmml">W</mi><mi id="S3.Ex8.m1.2.2.2.2.1.1.1.3.3" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.3.cmml">h</mi><mrow id="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.cmml"><mi id="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.2" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.2.cmml">E</mi><mo id="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.1" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.3" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.3.cmml">S</mi><mo id="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.1a" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.1.cmml">⁢</mo><msub id="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.4" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.4.cmml"><mi id="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.4.2" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.4.2.cmml">U</mi><mi id="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.4.3" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.4.3.cmml">K</mi></msub></mrow></msubsup></mrow><mo id="S3.Ex8.m1.2.2.2.2.1.1.3" stretchy="false" xref="S3.Ex8.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S3.Ex8.m1.2.2.2.2.3" xref="S3.Ex8.m1.2.2.2.2.3.cmml">T</mi></msup></mrow><msqrt id="S3.Ex8.m1.2.2.4" xref="S3.Ex8.m1.2.2.4.cmml"><mi id="S3.Ex8.m1.2.2.4.2" xref="S3.Ex8.m1.2.2.4.2.cmml">d</mi></msqrt></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex8.m1.2b"><apply id="S3.Ex8.m1.2.3.cmml" xref="S3.Ex8.m1.2.3"><eq id="S3.Ex8.m1.2.3.1.cmml" xref="S3.Ex8.m1.2.3.1"></eq><apply id="S3.Ex8.m1.2.3.2.cmml" xref="S3.Ex8.m1.2.3.2"><csymbol cd="ambiguous" id="S3.Ex8.m1.2.3.2.1.cmml" xref="S3.Ex8.m1.2.3.2">subscript</csymbol><apply id="S3.Ex8.m1.2.3.2.2.cmml" xref="S3.Ex8.m1.2.3.2"><csymbol cd="ambiguous" id="S3.Ex8.m1.2.3.2.2.1.cmml" xref="S3.Ex8.m1.2.3.2">superscript</csymbol><ci id="S3.Ex8.m1.2.3.2.2.2.cmml" xref="S3.Ex8.m1.2.3.2.2.2">𝛼</ci><apply id="S3.Ex8.m1.2.3.2.2.3.cmml" xref="S3.Ex8.m1.2.3.2.2.3"><times id="S3.Ex8.m1.2.3.2.2.3.1.cmml" xref="S3.Ex8.m1.2.3.2.2.3.1"></times><ci id="S3.Ex8.m1.2.3.2.2.3.2.cmml" xref="S3.Ex8.m1.2.3.2.2.3.2">𝐸</ci><ci id="S3.Ex8.m1.2.3.2.2.3.3.cmml" xref="S3.Ex8.m1.2.3.2.2.3.3">𝑆</ci><ci id="S3.Ex8.m1.2.3.2.2.3.4.cmml" xref="S3.Ex8.m1.2.3.2.2.3.4">𝑈</ci></apply></apply><ci id="S3.Ex8.m1.2.3.2.3.cmml" xref="S3.Ex8.m1.2.3.2.3">ℎ</ci></apply><apply id="S3.Ex8.m1.2.2.cmml" xref="S3.Ex8.m1.2.2"><divide id="S3.Ex8.m1.2.2.3.cmml" xref="S3.Ex8.m1.2.2"></divide><apply id="S3.Ex8.m1.2.2.2.cmml" xref="S3.Ex8.m1.2.2.2"><times id="S3.Ex8.m1.2.2.2.3.cmml" xref="S3.Ex8.m1.2.2.2.3"></times><apply id="S3.Ex8.m1.1.1.1.1.1.1.cmml" xref="S3.Ex8.m1.1.1.1.1.1"><times id="S3.Ex8.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex8.m1.1.1.1.1.1.1.1"></times><apply id="S3.Ex8.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex8.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex8.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex8.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex8.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex8.m1.1.1.1.1.1.1.2.2">𝑞</ci><ci id="S3.Ex8.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex8.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.Ex8.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex8.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex8.m1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.Ex8.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex8.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex8.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.Ex8.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex8.m1.1.1.1.1.1.1.3.2.2">𝑊</ci><apply id="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.Ex8.m1.1.1.1.1.1.1.3.2.3"><times id="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.1"></times><ci id="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.2">𝐸</ci><ci id="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.3">𝑆</ci><apply id="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.4.cmml" xref="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.4"><csymbol cd="ambiguous" id="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.4.1.cmml" xref="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.4">subscript</csymbol><ci id="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.4.2.cmml" xref="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.4.2">𝑈</ci><ci id="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.4.3.cmml" xref="S3.Ex8.m1.1.1.1.1.1.1.3.2.3.4.3">𝑄</ci></apply></apply></apply><ci id="S3.Ex8.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex8.m1.1.1.1.1.1.1.3.3">ℎ</ci></apply></apply><apply id="S3.Ex8.m1.2.2.2.2.cmml" xref="S3.Ex8.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex8.m1.2.2.2.2.2.cmml" xref="S3.Ex8.m1.2.2.2.2">superscript</csymbol><apply id="S3.Ex8.m1.2.2.2.2.1.1.1.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1"><times id="S3.Ex8.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.1"></times><apply id="S3.Ex8.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex8.m1.2.2.2.2.1.1.1.2.1.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.2">superscript</csymbol><ci id="S3.Ex8.m1.2.2.2.2.1.1.1.2.2.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.2.2">𝐾</ci><apply id="S3.Ex8.m1.2.2.2.2.1.1.1.2.3.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.2.3"><times id="S3.Ex8.m1.2.2.2.2.1.1.1.2.3.1.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.2.3.1"></times><ci id="S3.Ex8.m1.2.2.2.2.1.1.1.2.3.2.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.2.3.2">𝐸</ci><ci id="S3.Ex8.m1.2.2.2.2.1.1.1.2.3.3.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.2.3.3">𝑆</ci><ci id="S3.Ex8.m1.2.2.2.2.1.1.1.2.3.4.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.2.3.4">𝑈</ci></apply></apply><apply id="S3.Ex8.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex8.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3">subscript</csymbol><apply id="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.1.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3">superscript</csymbol><ci id="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.2.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.2">𝑊</ci><apply id="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3"><times id="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.1.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.1"></times><ci id="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.2.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.2">𝐸</ci><ci id="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.3.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.3">𝑆</ci><apply id="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.4.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.4"><csymbol cd="ambiguous" id="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.4.1.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.4">subscript</csymbol><ci id="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.4.2.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.4.2">𝑈</ci><ci id="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.4.3.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.2.3.4.3">𝐾</ci></apply></apply></apply><ci id="S3.Ex8.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S3.Ex8.m1.2.2.2.2.1.1.1.3.3">ℎ</ci></apply></apply><ci id="S3.Ex8.m1.2.2.2.2.3.cmml" xref="S3.Ex8.m1.2.2.2.2.3">𝑇</ci></apply></apply><apply id="S3.Ex8.m1.2.2.4.cmml" xref="S3.Ex8.m1.2.2.4"><root id="S3.Ex8.m1.2.2.4a.cmml" xref="S3.Ex8.m1.2.2.4"></root><ci id="S3.Ex8.m1.2.2.4.2.cmml" xref="S3.Ex8.m1.2.2.4.2">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex8.m1.2c">\alpha^{ESU}_{h}=\frac{(q_{t}W^{ESU_{Q}}_{h})(K^{ESU}W^{ESU_{K}}_{h})^{T}}{%
\sqrt{d}}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex8.m1.2d">italic_α start_POSTSUPERSCRIPT italic_E italic_S italic_U end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT = divide start_ARG ( italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_W start_POSTSUPERSCRIPT italic_E italic_S italic_U start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) ( italic_K start_POSTSUPERSCRIPT italic_E italic_S italic_U end_POSTSUPERSCRIPT italic_W start_POSTSUPERSCRIPT italic_E italic_S italic_U start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p8">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbb{x}^{ESU(j)}=\mathbb{x}^{GSU(j)}=\mathbb{x}^{PSU(j)}G^{(j)},\forall j%
\in M+1" class="ltx_Math" display="block" id="S3.Ex9.m1.6"><semantics id="S3.Ex9.m1.6a"><mrow id="S3.Ex9.m1.6.6.2" xref="S3.Ex9.m1.6.6.3.cmml"><mrow id="S3.Ex9.m1.5.5.1.1" xref="S3.Ex9.m1.5.5.1.1.cmml"><msup id="S3.Ex9.m1.5.5.1.1.2" xref="S3.Ex9.m1.5.5.1.1.2.cmml"><mi id="S3.Ex9.m1.5.5.1.1.2.2" xref="S3.Ex9.m1.5.5.1.1.2.2.cmml">𝕩</mi><mrow id="S3.Ex9.m1.1.1.1" xref="S3.Ex9.m1.1.1.1.cmml"><mi id="S3.Ex9.m1.1.1.1.3" xref="S3.Ex9.m1.1.1.1.3.cmml">E</mi><mo id="S3.Ex9.m1.1.1.1.2" xref="S3.Ex9.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex9.m1.1.1.1.4" xref="S3.Ex9.m1.1.1.1.4.cmml">S</mi><mo id="S3.Ex9.m1.1.1.1.2a" xref="S3.Ex9.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex9.m1.1.1.1.5" xref="S3.Ex9.m1.1.1.1.5.cmml">U</mi><mo id="S3.Ex9.m1.1.1.1.2b" xref="S3.Ex9.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex9.m1.1.1.1.6.2" xref="S3.Ex9.m1.1.1.1.cmml"><mo id="S3.Ex9.m1.1.1.1.6.2.1" stretchy="false" xref="S3.Ex9.m1.1.1.1.cmml">(</mo><mi id="S3.Ex9.m1.1.1.1.1" xref="S3.Ex9.m1.1.1.1.1.cmml">j</mi><mo id="S3.Ex9.m1.1.1.1.6.2.2" stretchy="false" xref="S3.Ex9.m1.1.1.1.cmml">)</mo></mrow></mrow></msup><mo id="S3.Ex9.m1.5.5.1.1.3" xref="S3.Ex9.m1.5.5.1.1.3.cmml">=</mo><msup id="S3.Ex9.m1.5.5.1.1.4" xref="S3.Ex9.m1.5.5.1.1.4.cmml"><mi id="S3.Ex9.m1.5.5.1.1.4.2" xref="S3.Ex9.m1.5.5.1.1.4.2.cmml">𝕩</mi><mrow id="S3.Ex9.m1.2.2.1" xref="S3.Ex9.m1.2.2.1.cmml"><mi id="S3.Ex9.m1.2.2.1.3" xref="S3.Ex9.m1.2.2.1.3.cmml">G</mi><mo id="S3.Ex9.m1.2.2.1.2" xref="S3.Ex9.m1.2.2.1.2.cmml">⁢</mo><mi id="S3.Ex9.m1.2.2.1.4" xref="S3.Ex9.m1.2.2.1.4.cmml">S</mi><mo id="S3.Ex9.m1.2.2.1.2a" xref="S3.Ex9.m1.2.2.1.2.cmml">⁢</mo><mi id="S3.Ex9.m1.2.2.1.5" xref="S3.Ex9.m1.2.2.1.5.cmml">U</mi><mo id="S3.Ex9.m1.2.2.1.2b" xref="S3.Ex9.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.Ex9.m1.2.2.1.6.2" xref="S3.Ex9.m1.2.2.1.cmml"><mo id="S3.Ex9.m1.2.2.1.6.2.1" stretchy="false" xref="S3.Ex9.m1.2.2.1.cmml">(</mo><mi id="S3.Ex9.m1.2.2.1.1" xref="S3.Ex9.m1.2.2.1.1.cmml">j</mi><mo id="S3.Ex9.m1.2.2.1.6.2.2" stretchy="false" xref="S3.Ex9.m1.2.2.1.cmml">)</mo></mrow></mrow></msup><mo id="S3.Ex9.m1.5.5.1.1.5" xref="S3.Ex9.m1.5.5.1.1.5.cmml">=</mo><mrow id="S3.Ex9.m1.5.5.1.1.6" xref="S3.Ex9.m1.5.5.1.1.6.cmml"><msup id="S3.Ex9.m1.5.5.1.1.6.2" xref="S3.Ex9.m1.5.5.1.1.6.2.cmml"><mi id="S3.Ex9.m1.5.5.1.1.6.2.2" xref="S3.Ex9.m1.5.5.1.1.6.2.2.cmml">𝕩</mi><mrow id="S3.Ex9.m1.3.3.1" xref="S3.Ex9.m1.3.3.1.cmml"><mi id="S3.Ex9.m1.3.3.1.3" xref="S3.Ex9.m1.3.3.1.3.cmml">P</mi><mo id="S3.Ex9.m1.3.3.1.2" xref="S3.Ex9.m1.3.3.1.2.cmml">⁢</mo><mi id="S3.Ex9.m1.3.3.1.4" xref="S3.Ex9.m1.3.3.1.4.cmml">S</mi><mo id="S3.Ex9.m1.3.3.1.2a" xref="S3.Ex9.m1.3.3.1.2.cmml">⁢</mo><mi id="S3.Ex9.m1.3.3.1.5" xref="S3.Ex9.m1.3.3.1.5.cmml">U</mi><mo id="S3.Ex9.m1.3.3.1.2b" xref="S3.Ex9.m1.3.3.1.2.cmml">⁢</mo><mrow id="S3.Ex9.m1.3.3.1.6.2" xref="S3.Ex9.m1.3.3.1.cmml"><mo id="S3.Ex9.m1.3.3.1.6.2.1" stretchy="false" xref="S3.Ex9.m1.3.3.1.cmml">(</mo><mi id="S3.Ex9.m1.3.3.1.1" xref="S3.Ex9.m1.3.3.1.1.cmml">j</mi><mo id="S3.Ex9.m1.3.3.1.6.2.2" stretchy="false" xref="S3.Ex9.m1.3.3.1.cmml">)</mo></mrow></mrow></msup><mo id="S3.Ex9.m1.5.5.1.1.6.1" xref="S3.Ex9.m1.5.5.1.1.6.1.cmml">⁢</mo><msup id="S3.Ex9.m1.5.5.1.1.6.3" xref="S3.Ex9.m1.5.5.1.1.6.3.cmml"><mi id="S3.Ex9.m1.5.5.1.1.6.3.2" xref="S3.Ex9.m1.5.5.1.1.6.3.2.cmml">G</mi><mrow id="S3.Ex9.m1.4.4.1.3" xref="S3.Ex9.m1.5.5.1.1.6.3.cmml"><mo id="S3.Ex9.m1.4.4.1.3.1" stretchy="false" xref="S3.Ex9.m1.5.5.1.1.6.3.cmml">(</mo><mi id="S3.Ex9.m1.4.4.1.1" xref="S3.Ex9.m1.4.4.1.1.cmml">j</mi><mo id="S3.Ex9.m1.4.4.1.3.2" stretchy="false" xref="S3.Ex9.m1.5.5.1.1.6.3.cmml">)</mo></mrow></msup></mrow></mrow><mo id="S3.Ex9.m1.6.6.2.3" xref="S3.Ex9.m1.6.6.3a.cmml">,</mo><mrow id="S3.Ex9.m1.6.6.2.2" xref="S3.Ex9.m1.6.6.2.2.cmml"><mrow id="S3.Ex9.m1.6.6.2.2.2" xref="S3.Ex9.m1.6.6.2.2.2.cmml"><mo id="S3.Ex9.m1.6.6.2.2.2.1" rspace="0.167em" xref="S3.Ex9.m1.6.6.2.2.2.1.cmml">∀</mo><mi id="S3.Ex9.m1.6.6.2.2.2.2" xref="S3.Ex9.m1.6.6.2.2.2.2.cmml">j</mi></mrow><mo id="S3.Ex9.m1.6.6.2.2.1" xref="S3.Ex9.m1.6.6.2.2.1.cmml">∈</mo><mrow id="S3.Ex9.m1.6.6.2.2.3" xref="S3.Ex9.m1.6.6.2.2.3.cmml"><mi id="S3.Ex9.m1.6.6.2.2.3.2" xref="S3.Ex9.m1.6.6.2.2.3.2.cmml">M</mi><mo id="S3.Ex9.m1.6.6.2.2.3.1" xref="S3.Ex9.m1.6.6.2.2.3.1.cmml">+</mo><mn id="S3.Ex9.m1.6.6.2.2.3.3" xref="S3.Ex9.m1.6.6.2.2.3.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex9.m1.6b"><apply id="S3.Ex9.m1.6.6.3.cmml" xref="S3.Ex9.m1.6.6.2"><csymbol cd="ambiguous" id="S3.Ex9.m1.6.6.3a.cmml" xref="S3.Ex9.m1.6.6.2.3">formulae-sequence</csymbol><apply id="S3.Ex9.m1.5.5.1.1.cmml" xref="S3.Ex9.m1.5.5.1.1"><and id="S3.Ex9.m1.5.5.1.1a.cmml" xref="S3.Ex9.m1.5.5.1.1"></and><apply id="S3.Ex9.m1.5.5.1.1b.cmml" xref="S3.Ex9.m1.5.5.1.1"><eq id="S3.Ex9.m1.5.5.1.1.3.cmml" xref="S3.Ex9.m1.5.5.1.1.3"></eq><apply id="S3.Ex9.m1.5.5.1.1.2.cmml" xref="S3.Ex9.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.Ex9.m1.5.5.1.1.2.1.cmml" xref="S3.Ex9.m1.5.5.1.1.2">superscript</csymbol><ci id="S3.Ex9.m1.5.5.1.1.2.2.cmml" xref="S3.Ex9.m1.5.5.1.1.2.2">𝕩</ci><apply id="S3.Ex9.m1.1.1.1.cmml" xref="S3.Ex9.m1.1.1.1"><times id="S3.Ex9.m1.1.1.1.2.cmml" xref="S3.Ex9.m1.1.1.1.2"></times><ci id="S3.Ex9.m1.1.1.1.3.cmml" xref="S3.Ex9.m1.1.1.1.3">𝐸</ci><ci id="S3.Ex9.m1.1.1.1.4.cmml" xref="S3.Ex9.m1.1.1.1.4">𝑆</ci><ci id="S3.Ex9.m1.1.1.1.5.cmml" xref="S3.Ex9.m1.1.1.1.5">𝑈</ci><ci id="S3.Ex9.m1.1.1.1.1.cmml" xref="S3.Ex9.m1.1.1.1.1">𝑗</ci></apply></apply><apply id="S3.Ex9.m1.5.5.1.1.4.cmml" xref="S3.Ex9.m1.5.5.1.1.4"><csymbol cd="ambiguous" id="S3.Ex9.m1.5.5.1.1.4.1.cmml" xref="S3.Ex9.m1.5.5.1.1.4">superscript</csymbol><ci id="S3.Ex9.m1.5.5.1.1.4.2.cmml" xref="S3.Ex9.m1.5.5.1.1.4.2">𝕩</ci><apply id="S3.Ex9.m1.2.2.1.cmml" xref="S3.Ex9.m1.2.2.1"><times id="S3.Ex9.m1.2.2.1.2.cmml" xref="S3.Ex9.m1.2.2.1.2"></times><ci id="S3.Ex9.m1.2.2.1.3.cmml" xref="S3.Ex9.m1.2.2.1.3">𝐺</ci><ci id="S3.Ex9.m1.2.2.1.4.cmml" xref="S3.Ex9.m1.2.2.1.4">𝑆</ci><ci id="S3.Ex9.m1.2.2.1.5.cmml" xref="S3.Ex9.m1.2.2.1.5">𝑈</ci><ci id="S3.Ex9.m1.2.2.1.1.cmml" xref="S3.Ex9.m1.2.2.1.1">𝑗</ci></apply></apply></apply><apply id="S3.Ex9.m1.5.5.1.1c.cmml" xref="S3.Ex9.m1.5.5.1.1"><eq id="S3.Ex9.m1.5.5.1.1.5.cmml" xref="S3.Ex9.m1.5.5.1.1.5"></eq><share href="https://arxiv.org/html/2407.10714v1#S3.Ex9.m1.5.5.1.1.4.cmml" id="S3.Ex9.m1.5.5.1.1d.cmml" xref="S3.Ex9.m1.5.5.1.1"></share><apply id="S3.Ex9.m1.5.5.1.1.6.cmml" xref="S3.Ex9.m1.5.5.1.1.6"><times id="S3.Ex9.m1.5.5.1.1.6.1.cmml" xref="S3.Ex9.m1.5.5.1.1.6.1"></times><apply id="S3.Ex9.m1.5.5.1.1.6.2.cmml" xref="S3.Ex9.m1.5.5.1.1.6.2"><csymbol cd="ambiguous" id="S3.Ex9.m1.5.5.1.1.6.2.1.cmml" xref="S3.Ex9.m1.5.5.1.1.6.2">superscript</csymbol><ci id="S3.Ex9.m1.5.5.1.1.6.2.2.cmml" xref="S3.Ex9.m1.5.5.1.1.6.2.2">𝕩</ci><apply id="S3.Ex9.m1.3.3.1.cmml" xref="S3.Ex9.m1.3.3.1"><times id="S3.Ex9.m1.3.3.1.2.cmml" xref="S3.Ex9.m1.3.3.1.2"></times><ci id="S3.Ex9.m1.3.3.1.3.cmml" xref="S3.Ex9.m1.3.3.1.3">𝑃</ci><ci id="S3.Ex9.m1.3.3.1.4.cmml" xref="S3.Ex9.m1.3.3.1.4">𝑆</ci><ci id="S3.Ex9.m1.3.3.1.5.cmml" xref="S3.Ex9.m1.3.3.1.5">𝑈</ci><ci id="S3.Ex9.m1.3.3.1.1.cmml" xref="S3.Ex9.m1.3.3.1.1">𝑗</ci></apply></apply><apply id="S3.Ex9.m1.5.5.1.1.6.3.cmml" xref="S3.Ex9.m1.5.5.1.1.6.3"><csymbol cd="ambiguous" id="S3.Ex9.m1.5.5.1.1.6.3.1.cmml" xref="S3.Ex9.m1.5.5.1.1.6.3">superscript</csymbol><ci id="S3.Ex9.m1.5.5.1.1.6.3.2.cmml" xref="S3.Ex9.m1.5.5.1.1.6.3.2">𝐺</ci><ci id="S3.Ex9.m1.4.4.1.1.cmml" xref="S3.Ex9.m1.4.4.1.1">𝑗</ci></apply></apply></apply></apply><apply id="S3.Ex9.m1.6.6.2.2.cmml" xref="S3.Ex9.m1.6.6.2.2"><in id="S3.Ex9.m1.6.6.2.2.1.cmml" xref="S3.Ex9.m1.6.6.2.2.1"></in><apply id="S3.Ex9.m1.6.6.2.2.2.cmml" xref="S3.Ex9.m1.6.6.2.2.2"><csymbol cd="latexml" id="S3.Ex9.m1.6.6.2.2.2.1.cmml" xref="S3.Ex9.m1.6.6.2.2.2.1">for-all</csymbol><ci id="S3.Ex9.m1.6.6.2.2.2.2.cmml" xref="S3.Ex9.m1.6.6.2.2.2.2">𝑗</ci></apply><apply id="S3.Ex9.m1.6.6.2.2.3.cmml" xref="S3.Ex9.m1.6.6.2.2.3"><plus id="S3.Ex9.m1.6.6.2.2.3.1.cmml" xref="S3.Ex9.m1.6.6.2.2.3.1"></plus><ci id="S3.Ex9.m1.6.6.2.2.3.2.cmml" xref="S3.Ex9.m1.6.6.2.2.3.2">𝑀</ci><cn id="S3.Ex9.m1.6.6.2.2.3.3.cmml" type="integer" xref="S3.Ex9.m1.6.6.2.2.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex9.m1.6c">\mathbb{x}^{ESU(j)}=\mathbb{x}^{GSU(j)}=\mathbb{x}^{PSU(j)}G^{(j)},\forall j%
\in M+1</annotation><annotation encoding="application/x-llamapun" id="S3.Ex9.m1.6d">blackboard_x start_POSTSUPERSCRIPT italic_E italic_S italic_U ( italic_j ) end_POSTSUPERSCRIPT = blackboard_x start_POSTSUPERSCRIPT italic_G italic_S italic_U ( italic_j ) end_POSTSUPERSCRIPT = blackboard_x start_POSTSUPERSCRIPT italic_P italic_S italic_U ( italic_j ) end_POSTSUPERSCRIPT italic_G start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT , ∀ italic_j ∈ italic_M + 1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p8.1">.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p9">
<p class="ltx_p" id="S3.SS3.SSS2.p9.6">Finally, users’ lifelong sequence representation <math alttext="\mathbb{x}_{\text{lifelong\_seq}}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p9.1.m1.1"><semantics id="S3.SS3.SSS2.p9.1.m1.1a"><msub id="S3.SS3.SSS2.p9.1.m1.1.1" xref="S3.SS3.SSS2.p9.1.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p9.1.m1.1.1.2" xref="S3.SS3.SSS2.p9.1.m1.1.1.2.cmml">𝕩</mi><mtext id="S3.SS3.SSS2.p9.1.m1.1.1.3" xref="S3.SS3.SSS2.p9.1.m1.1.1.3a.cmml">lifelong_seq</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p9.1.m1.1b"><apply id="S3.SS3.SSS2.p9.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p9.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.2">𝕩</ci><ci id="S3.SS3.SSS2.p9.1.m1.1.1.3a.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.3"><mtext id="S3.SS3.SSS2.p9.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS2.p9.1.m1.1.1.3">lifelong_seq</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p9.1.m1.1c">\mathbb{x}_{\text{lifelong\_seq}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p9.1.m1.1d">blackboard_x start_POSTSUBSCRIPT lifelong_seq end_POSTSUBSCRIPT</annotation></semantics></math> is calculated as: <math alttext="\mathbb{x}_{\text{lifelong\_seq}}=\text{Concat}(\text{head}^{ESU_{1}},...,%
\text{head}^{ESU_{H}})W^{ESU}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p9.2.m2.3"><semantics id="S3.SS3.SSS2.p9.2.m2.3a"><mrow id="S3.SS3.SSS2.p9.2.m2.3.3" xref="S3.SS3.SSS2.p9.2.m2.3.3.cmml"><msub id="S3.SS3.SSS2.p9.2.m2.3.3.4" xref="S3.SS3.SSS2.p9.2.m2.3.3.4.cmml"><mi id="S3.SS3.SSS2.p9.2.m2.3.3.4.2" xref="S3.SS3.SSS2.p9.2.m2.3.3.4.2.cmml">𝕩</mi><mtext id="S3.SS3.SSS2.p9.2.m2.3.3.4.3" xref="S3.SS3.SSS2.p9.2.m2.3.3.4.3a.cmml">lifelong_seq</mtext></msub><mo id="S3.SS3.SSS2.p9.2.m2.3.3.3" xref="S3.SS3.SSS2.p9.2.m2.3.3.3.cmml">=</mo><mrow id="S3.SS3.SSS2.p9.2.m2.3.3.2" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.cmml"><mtext id="S3.SS3.SSS2.p9.2.m2.3.3.2.4" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.4a.cmml">Concat</mtext><mo id="S3.SS3.SSS2.p9.2.m2.3.3.2.3" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.3.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.3.cmml"><mo id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.3" stretchy="false" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.3.cmml">(</mo><msup id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.cmml"><mtext id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.2" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.2a.cmml">head</mtext><mrow id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.2" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.2.cmml">E</mi><mo id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.1" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.3" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.1a" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.4" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.4.cmml"><mi id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.4.2" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.4.2.cmml">U</mi><mn id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.4.3" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.4.3.cmml">1</mn></msub></mrow></msup><mo id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.4" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS2.p9.2.m2.1.1" mathvariant="normal" xref="S3.SS3.SSS2.p9.2.m2.1.1.cmml">…</mi><mo id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.5" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.3.cmml">,</mo><msup id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.cmml"><mtext id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.2" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.2a.cmml">head</mtext><mrow id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.cmml"><mi id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.2" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.2.cmml">E</mi><mo id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.1" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.3" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.1a" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.1.cmml">⁢</mo><msub id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.4" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.4.cmml"><mi id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.4.2" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.4.2.cmml">U</mi><mi id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.4.3" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.4.3.cmml">H</mi></msub></mrow></msup><mo id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.6" stretchy="false" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.3.cmml">)</mo></mrow><mo id="S3.SS3.SSS2.p9.2.m2.3.3.2.3a" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.3.cmml">⁢</mo><msup id="S3.SS3.SSS2.p9.2.m2.3.3.2.5" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.5.cmml"><mi id="S3.SS3.SSS2.p9.2.m2.3.3.2.5.2" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.5.2.cmml">W</mi><mrow id="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3.cmml"><mi id="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3.2" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3.2.cmml">E</mi><mo id="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3.1" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3.3" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3.3.cmml">S</mi><mo id="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3.1a" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3.4" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3.4.cmml">U</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p9.2.m2.3b"><apply id="S3.SS3.SSS2.p9.2.m2.3.3.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3"><eq id="S3.SS3.SSS2.p9.2.m2.3.3.3.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.3"></eq><apply id="S3.SS3.SSS2.p9.2.m2.3.3.4.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.2.m2.3.3.4.1.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.4">subscript</csymbol><ci id="S3.SS3.SSS2.p9.2.m2.3.3.4.2.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.4.2">𝕩</ci><ci id="S3.SS3.SSS2.p9.2.m2.3.3.4.3a.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.4.3"><mtext id="S3.SS3.SSS2.p9.2.m2.3.3.4.3.cmml" mathsize="70%" xref="S3.SS3.SSS2.p9.2.m2.3.3.4.3">lifelong_seq</mtext></ci></apply><apply id="S3.SS3.SSS2.p9.2.m2.3.3.2.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2"><times id="S3.SS3.SSS2.p9.2.m2.3.3.2.3.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.3"></times><ci id="S3.SS3.SSS2.p9.2.m2.3.3.2.4a.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.4"><mtext id="S3.SS3.SSS2.p9.2.m2.3.3.2.4.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.4">Concat</mtext></ci><vector id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.3.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2"><apply id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.2a.cmml" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.2"><mtext id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.2">head</mtext></ci><apply id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3"><times id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.1"></times><ci id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.2">𝐸</ci><ci id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.3">𝑆</ci><apply id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.4.cmml" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.4.1.cmml" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.4">subscript</csymbol><ci id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.4.2.cmml" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.4.2">𝑈</ci><cn id="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.4.3.cmml" type="integer" xref="S3.SS3.SSS2.p9.2.m2.2.2.1.1.1.1.3.4.3">1</cn></apply></apply></apply><ci id="S3.SS3.SSS2.p9.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p9.2.m2.1.1">…</ci><apply id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2">superscript</csymbol><ci id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.2a.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.2"><mtext id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.2">head</mtext></ci><apply id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3"><times id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.1.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.1"></times><ci id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.2.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.2">𝐸</ci><ci id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.3.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.3">𝑆</ci><apply id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.4.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.4.1.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.4">subscript</csymbol><ci id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.4.2.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.4.2">𝑈</ci><ci id="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.4.3.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.2.2.2.3.4.3">𝐻</ci></apply></apply></apply></vector><apply id="S3.SS3.SSS2.p9.2.m2.3.3.2.5.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.5"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.2.m2.3.3.2.5.1.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.5">superscript</csymbol><ci id="S3.SS3.SSS2.p9.2.m2.3.3.2.5.2.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.5.2">𝑊</ci><apply id="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3"><times id="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3.1.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3.1"></times><ci id="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3.2.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3.2">𝐸</ci><ci id="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3.3.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3.3">𝑆</ci><ci id="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3.4.cmml" xref="S3.SS3.SSS2.p9.2.m2.3.3.2.5.3.4">𝑈</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p9.2.m2.3c">\mathbb{x}_{\text{lifelong\_seq}}=\text{Concat}(\text{head}^{ESU_{1}},...,%
\text{head}^{ESU_{H}})W^{ESU}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p9.2.m2.3d">blackboard_x start_POSTSUBSCRIPT lifelong_seq end_POSTSUBSCRIPT = Concat ( head start_POSTSUPERSCRIPT italic_E italic_S italic_U start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , … , head start_POSTSUPERSCRIPT italic_E italic_S italic_U start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ) italic_W start_POSTSUPERSCRIPT italic_E italic_S italic_U end_POSTSUPERSCRIPT</annotation></semantics></math>. And <math alttext="\mathbb{x}_{\text{lifelong\_seq}}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p9.3.m3.1"><semantics id="S3.SS3.SSS2.p9.3.m3.1a"><msub id="S3.SS3.SSS2.p9.3.m3.1.1" xref="S3.SS3.SSS2.p9.3.m3.1.1.cmml"><mi id="S3.SS3.SSS2.p9.3.m3.1.1.2" xref="S3.SS3.SSS2.p9.3.m3.1.1.2.cmml">𝕩</mi><mtext id="S3.SS3.SSS2.p9.3.m3.1.1.3" xref="S3.SS3.SSS2.p9.3.m3.1.1.3a.cmml">lifelong_seq</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p9.3.m3.1b"><apply id="S3.SS3.SSS2.p9.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p9.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.3.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p9.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p9.3.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p9.3.m3.1.1.2">𝕩</ci><ci id="S3.SS3.SSS2.p9.3.m3.1.1.3a.cmml" xref="S3.SS3.SSS2.p9.3.m3.1.1.3"><mtext id="S3.SS3.SSS2.p9.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS2.p9.3.m3.1.1.3">lifelong_seq</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p9.3.m3.1c">\mathbb{x}_{\text{lifelong\_seq}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p9.3.m3.1d">blackboard_x start_POSTSUBSCRIPT lifelong_seq end_POSTSUBSCRIPT</annotation></semantics></math> is concatenated with other user, item, user-item interaction (u2i) and context features and participate in CTR prediction. <math alttext="\hat{y}_{i}=f_{\theta_{i}}(\mathbb{x}_{\text{lifelong\_seq}},\mathbb{x}_{u},%
\mathbb{x}_{i},\mathbb{x}_{\text{u2i}},\mathbb{x}_{\text{context}})" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p9.4.m4.5"><semantics id="S3.SS3.SSS2.p9.4.m4.5a"><mrow id="S3.SS3.SSS2.p9.4.m4.5.5" xref="S3.SS3.SSS2.p9.4.m4.5.5.cmml"><msub id="S3.SS3.SSS2.p9.4.m4.5.5.7" xref="S3.SS3.SSS2.p9.4.m4.5.5.7.cmml"><mover accent="true" id="S3.SS3.SSS2.p9.4.m4.5.5.7.2" xref="S3.SS3.SSS2.p9.4.m4.5.5.7.2.cmml"><mi id="S3.SS3.SSS2.p9.4.m4.5.5.7.2.2" xref="S3.SS3.SSS2.p9.4.m4.5.5.7.2.2.cmml">y</mi><mo id="S3.SS3.SSS2.p9.4.m4.5.5.7.2.1" xref="S3.SS3.SSS2.p9.4.m4.5.5.7.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSS2.p9.4.m4.5.5.7.3" xref="S3.SS3.SSS2.p9.4.m4.5.5.7.3.cmml">i</mi></msub><mo id="S3.SS3.SSS2.p9.4.m4.5.5.6" xref="S3.SS3.SSS2.p9.4.m4.5.5.6.cmml">=</mo><mrow id="S3.SS3.SSS2.p9.4.m4.5.5.5" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.cmml"><msub id="S3.SS3.SSS2.p9.4.m4.5.5.5.7" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.7.cmml"><mi id="S3.SS3.SSS2.p9.4.m4.5.5.5.7.2" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.7.2.cmml">f</mi><msub id="S3.SS3.SSS2.p9.4.m4.5.5.5.7.3" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.7.3.cmml"><mi id="S3.SS3.SSS2.p9.4.m4.5.5.5.7.3.2" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.7.3.2.cmml">θ</mi><mi id="S3.SS3.SSS2.p9.4.m4.5.5.5.7.3.3" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.7.3.3.cmml">i</mi></msub></msub><mo id="S3.SS3.SSS2.p9.4.m4.5.5.5.6" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.6.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.5.6.cmml"><mo id="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.6" stretchy="false" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.5.6.cmml">(</mo><msub id="S3.SS3.SSS2.p9.4.m4.1.1.1.1.1.1" xref="S3.SS3.SSS2.p9.4.m4.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p9.4.m4.1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p9.4.m4.1.1.1.1.1.1.2.cmml">𝕩</mi><mtext id="S3.SS3.SSS2.p9.4.m4.1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p9.4.m4.1.1.1.1.1.1.3a.cmml">lifelong_seq</mtext></msub><mo id="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.7" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.5.6.cmml">,</mo><msub id="S3.SS3.SSS2.p9.4.m4.2.2.2.2.2.2" xref="S3.SS3.SSS2.p9.4.m4.2.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS2.p9.4.m4.2.2.2.2.2.2.2" xref="S3.SS3.SSS2.p9.4.m4.2.2.2.2.2.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS2.p9.4.m4.2.2.2.2.2.2.3" xref="S3.SS3.SSS2.p9.4.m4.2.2.2.2.2.2.3.cmml">u</mi></msub><mo id="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.8" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.5.6.cmml">,</mo><msub id="S3.SS3.SSS2.p9.4.m4.3.3.3.3.3.3" xref="S3.SS3.SSS2.p9.4.m4.3.3.3.3.3.3.cmml"><mi id="S3.SS3.SSS2.p9.4.m4.3.3.3.3.3.3.2" xref="S3.SS3.SSS2.p9.4.m4.3.3.3.3.3.3.2.cmml">𝕩</mi><mi id="S3.SS3.SSS2.p9.4.m4.3.3.3.3.3.3.3" xref="S3.SS3.SSS2.p9.4.m4.3.3.3.3.3.3.3.cmml">i</mi></msub><mo id="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.9" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.5.6.cmml">,</mo><msub id="S3.SS3.SSS2.p9.4.m4.4.4.4.4.4.4" xref="S3.SS3.SSS2.p9.4.m4.4.4.4.4.4.4.cmml"><mi id="S3.SS3.SSS2.p9.4.m4.4.4.4.4.4.4.2" xref="S3.SS3.SSS2.p9.4.m4.4.4.4.4.4.4.2.cmml">𝕩</mi><mtext id="S3.SS3.SSS2.p9.4.m4.4.4.4.4.4.4.3" xref="S3.SS3.SSS2.p9.4.m4.4.4.4.4.4.4.3a.cmml">u2i</mtext></msub><mo id="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.10" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.5.6.cmml">,</mo><msub id="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.5" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.5.cmml"><mi id="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.5.2" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.5.2.cmml">𝕩</mi><mtext id="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.5.3" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.5.3a.cmml">context</mtext></msub><mo id="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.11" stretchy="false" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.5.6.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p9.4.m4.5b"><apply id="S3.SS3.SSS2.p9.4.m4.5.5.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5"><eq id="S3.SS3.SSS2.p9.4.m4.5.5.6.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.6"></eq><apply id="S3.SS3.SSS2.p9.4.m4.5.5.7.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.7"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.4.m4.5.5.7.1.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.7">subscript</csymbol><apply id="S3.SS3.SSS2.p9.4.m4.5.5.7.2.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.7.2"><ci id="S3.SS3.SSS2.p9.4.m4.5.5.7.2.1.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.7.2.1">^</ci><ci id="S3.SS3.SSS2.p9.4.m4.5.5.7.2.2.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.7.2.2">𝑦</ci></apply><ci id="S3.SS3.SSS2.p9.4.m4.5.5.7.3.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.7.3">𝑖</ci></apply><apply id="S3.SS3.SSS2.p9.4.m4.5.5.5.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.5"><times id="S3.SS3.SSS2.p9.4.m4.5.5.5.6.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.6"></times><apply id="S3.SS3.SSS2.p9.4.m4.5.5.5.7.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.7"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.4.m4.5.5.5.7.1.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.7">subscript</csymbol><ci id="S3.SS3.SSS2.p9.4.m4.5.5.5.7.2.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.7.2">𝑓</ci><apply id="S3.SS3.SSS2.p9.4.m4.5.5.5.7.3.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.7.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.4.m4.5.5.5.7.3.1.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.7.3">subscript</csymbol><ci id="S3.SS3.SSS2.p9.4.m4.5.5.5.7.3.2.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.7.3.2">𝜃</ci><ci id="S3.SS3.SSS2.p9.4.m4.5.5.5.7.3.3.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.7.3.3">𝑖</ci></apply></apply><vector id="S3.SS3.SSS2.p9.4.m4.5.5.5.5.6.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5"><apply id="S3.SS3.SSS2.p9.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p9.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p9.4.m4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p9.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p9.4.m4.1.1.1.1.1.1.2">𝕩</ci><ci id="S3.SS3.SSS2.p9.4.m4.1.1.1.1.1.1.3a.cmml" xref="S3.SS3.SSS2.p9.4.m4.1.1.1.1.1.1.3"><mtext id="S3.SS3.SSS2.p9.4.m4.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS2.p9.4.m4.1.1.1.1.1.1.3">lifelong_seq</mtext></ci></apply><apply id="S3.SS3.SSS2.p9.4.m4.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p9.4.m4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.4.m4.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p9.4.m4.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS2.p9.4.m4.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p9.4.m4.2.2.2.2.2.2.2">𝕩</ci><ci id="S3.SS3.SSS2.p9.4.m4.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p9.4.m4.2.2.2.2.2.2.3">𝑢</ci></apply><apply id="S3.SS3.SSS2.p9.4.m4.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS2.p9.4.m4.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.4.m4.3.3.3.3.3.3.1.cmml" xref="S3.SS3.SSS2.p9.4.m4.3.3.3.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS2.p9.4.m4.3.3.3.3.3.3.2.cmml" xref="S3.SS3.SSS2.p9.4.m4.3.3.3.3.3.3.2">𝕩</ci><ci id="S3.SS3.SSS2.p9.4.m4.3.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS2.p9.4.m4.3.3.3.3.3.3.3">𝑖</ci></apply><apply id="S3.SS3.SSS2.p9.4.m4.4.4.4.4.4.4.cmml" xref="S3.SS3.SSS2.p9.4.m4.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.4.m4.4.4.4.4.4.4.1.cmml" xref="S3.SS3.SSS2.p9.4.m4.4.4.4.4.4.4">subscript</csymbol><ci id="S3.SS3.SSS2.p9.4.m4.4.4.4.4.4.4.2.cmml" xref="S3.SS3.SSS2.p9.4.m4.4.4.4.4.4.4.2">𝕩</ci><ci id="S3.SS3.SSS2.p9.4.m4.4.4.4.4.4.4.3a.cmml" xref="S3.SS3.SSS2.p9.4.m4.4.4.4.4.4.4.3"><mtext id="S3.SS3.SSS2.p9.4.m4.4.4.4.4.4.4.3.cmml" mathsize="70%" xref="S3.SS3.SSS2.p9.4.m4.4.4.4.4.4.4.3">u2i</mtext></ci></apply><apply id="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.5.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.5"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.5.1.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.5">subscript</csymbol><ci id="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.5.2.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.5.2">𝕩</ci><ci id="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.5.3a.cmml" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.5.3"><mtext id="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.5.3.cmml" mathsize="70%" xref="S3.SS3.SSS2.p9.4.m4.5.5.5.5.5.5.3">context</mtext></ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p9.4.m4.5c">\hat{y}_{i}=f_{\theta_{i}}(\mathbb{x}_{\text{lifelong\_seq}},\mathbb{x}_{u},%
\mathbb{x}_{i},\mathbb{x}_{\text{u2i}},\mathbb{x}_{\text{context}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p9.4.m4.5d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_f start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( blackboard_x start_POSTSUBSCRIPT lifelong_seq end_POSTSUBSCRIPT , blackboard_x start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , blackboard_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , blackboard_x start_POSTSUBSCRIPT u2i end_POSTSUBSCRIPT , blackboard_x start_POSTSUBSCRIPT context end_POSTSUBSCRIPT )</annotation></semantics></math> denotes the predicted value and <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p9.5.m5.1"><semantics id="S3.SS3.SSS2.p9.5.m5.1a"><msub id="S3.SS3.SSS2.p9.5.m5.1.1" xref="S3.SS3.SSS2.p9.5.m5.1.1.cmml"><mi id="S3.SS3.SSS2.p9.5.m5.1.1.2" xref="S3.SS3.SSS2.p9.5.m5.1.1.2.cmml">y</mi><mi id="S3.SS3.SSS2.p9.5.m5.1.1.3" xref="S3.SS3.SSS2.p9.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p9.5.m5.1b"><apply id="S3.SS3.SSS2.p9.5.m5.1.1.cmml" xref="S3.SS3.SSS2.p9.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.5.m5.1.1.1.cmml" xref="S3.SS3.SSS2.p9.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p9.5.m5.1.1.2.cmml" xref="S3.SS3.SSS2.p9.5.m5.1.1.2">𝑦</ci><ci id="S3.SS3.SSS2.p9.5.m5.1.1.3.cmml" xref="S3.SS3.SSS2.p9.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p9.5.m5.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p9.5.m5.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denote the actual label value. And the final loss of CTR prediction is <math alttext="\mathcal{L}_{ctr}=\sum_{i}\mathcal{L}_{ce}(y_{i},\hat{y_{i}})" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p9.6.m6.2"><semantics id="S3.SS3.SSS2.p9.6.m6.2a"><mrow id="S3.SS3.SSS2.p9.6.m6.2.2" xref="S3.SS3.SSS2.p9.6.m6.2.2.cmml"><msub id="S3.SS3.SSS2.p9.6.m6.2.2.3" xref="S3.SS3.SSS2.p9.6.m6.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p9.6.m6.2.2.3.2" xref="S3.SS3.SSS2.p9.6.m6.2.2.3.2.cmml">ℒ</mi><mrow id="S3.SS3.SSS2.p9.6.m6.2.2.3.3" xref="S3.SS3.SSS2.p9.6.m6.2.2.3.3.cmml"><mi id="S3.SS3.SSS2.p9.6.m6.2.2.3.3.2" xref="S3.SS3.SSS2.p9.6.m6.2.2.3.3.2.cmml">c</mi><mo id="S3.SS3.SSS2.p9.6.m6.2.2.3.3.1" xref="S3.SS3.SSS2.p9.6.m6.2.2.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p9.6.m6.2.2.3.3.3" xref="S3.SS3.SSS2.p9.6.m6.2.2.3.3.3.cmml">t</mi><mo id="S3.SS3.SSS2.p9.6.m6.2.2.3.3.1a" xref="S3.SS3.SSS2.p9.6.m6.2.2.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p9.6.m6.2.2.3.3.4" xref="S3.SS3.SSS2.p9.6.m6.2.2.3.3.4.cmml">r</mi></mrow></msub><mo id="S3.SS3.SSS2.p9.6.m6.2.2.2" rspace="0.111em" xref="S3.SS3.SSS2.p9.6.m6.2.2.2.cmml">=</mo><mrow id="S3.SS3.SSS2.p9.6.m6.2.2.1" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.cmml"><msub id="S3.SS3.SSS2.p9.6.m6.2.2.1.2" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.2.cmml"><mo id="S3.SS3.SSS2.p9.6.m6.2.2.1.2.2" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.2.2.cmml">∑</mo><mi id="S3.SS3.SSS2.p9.6.m6.2.2.1.2.3" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.2.3.cmml">i</mi></msub><mrow id="S3.SS3.SSS2.p9.6.m6.2.2.1.1" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.cmml"><msub id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.2" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.2.cmml">ℒ</mi><mrow id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.3" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.3.cmml"><mi id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.3.2" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.3.2.cmml">c</mi><mo id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.3.1" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.3.3" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.3.3.cmml">e</mi></mrow></msub><mo id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.2" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.1" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.2.cmml"><mo id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.2.cmml">(</mo><msub id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.1.1" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.1.1.2" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.1.1.2.cmml">y</mi><mi id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.1.1.3" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.1.3" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.2.cmml">,</mo><mover accent="true" id="S3.SS3.SSS2.p9.6.m6.1.1" xref="S3.SS3.SSS2.p9.6.m6.1.1.cmml"><msub id="S3.SS3.SSS2.p9.6.m6.1.1.2" xref="S3.SS3.SSS2.p9.6.m6.1.1.2.cmml"><mi id="S3.SS3.SSS2.p9.6.m6.1.1.2.2" xref="S3.SS3.SSS2.p9.6.m6.1.1.2.2.cmml">y</mi><mi id="S3.SS3.SSS2.p9.6.m6.1.1.2.3" xref="S3.SS3.SSS2.p9.6.m6.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS3.SSS2.p9.6.m6.1.1.1" xref="S3.SS3.SSS2.p9.6.m6.1.1.1.cmml">^</mo></mover><mo id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.1.4" stretchy="false" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p9.6.m6.2b"><apply id="S3.SS3.SSS2.p9.6.m6.2.2.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2"><eq id="S3.SS3.SSS2.p9.6.m6.2.2.2.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.2"></eq><apply id="S3.SS3.SSS2.p9.6.m6.2.2.3.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.6.m6.2.2.3.1.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.3">subscript</csymbol><ci id="S3.SS3.SSS2.p9.6.m6.2.2.3.2.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.3.2">ℒ</ci><apply id="S3.SS3.SSS2.p9.6.m6.2.2.3.3.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.3.3"><times id="S3.SS3.SSS2.p9.6.m6.2.2.3.3.1.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.3.3.1"></times><ci id="S3.SS3.SSS2.p9.6.m6.2.2.3.3.2.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.3.3.2">𝑐</ci><ci id="S3.SS3.SSS2.p9.6.m6.2.2.3.3.3.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.3.3.3">𝑡</ci><ci id="S3.SS3.SSS2.p9.6.m6.2.2.3.3.4.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.3.3.4">𝑟</ci></apply></apply><apply id="S3.SS3.SSS2.p9.6.m6.2.2.1.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.1"><apply id="S3.SS3.SSS2.p9.6.m6.2.2.1.2.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.6.m6.2.2.1.2.1.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.2">subscript</csymbol><sum id="S3.SS3.SSS2.p9.6.m6.2.2.1.2.2.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.2.2"></sum><ci id="S3.SS3.SSS2.p9.6.m6.2.2.1.2.3.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1"><times id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.2.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.2"></times><apply id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.1.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.2.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.2">ℒ</ci><apply id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.3.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.3"><times id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.3.1"></times><ci id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.3.2.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.3.2">𝑐</ci><ci id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.3.3.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.3.3.3">𝑒</ci></apply></apply><interval closure="open" id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.1"><apply id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.1.1.2">𝑦</ci><ci id="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p9.6.m6.2.2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS3.SSS2.p9.6.m6.1.1.cmml" xref="S3.SS3.SSS2.p9.6.m6.1.1"><ci id="S3.SS3.SSS2.p9.6.m6.1.1.1.cmml" xref="S3.SS3.SSS2.p9.6.m6.1.1.1">^</ci><apply id="S3.SS3.SSS2.p9.6.m6.1.1.2.cmml" xref="S3.SS3.SSS2.p9.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.6.m6.1.1.2.1.cmml" xref="S3.SS3.SSS2.p9.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS2.p9.6.m6.1.1.2.2.cmml" xref="S3.SS3.SSS2.p9.6.m6.1.1.2.2">𝑦</ci><ci id="S3.SS3.SSS2.p9.6.m6.1.1.2.3.cmml" xref="S3.SS3.SSS2.p9.6.m6.1.1.2.3">𝑖</ci></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p9.6.m6.2c">\mathcal{L}_{ctr}=\sum_{i}\mathcal{L}_{ce}(y_{i},\hat{y_{i}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p9.6.m6.2d">caligraphic_L start_POSTSUBSCRIPT italic_c italic_t italic_r end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT italic_c italic_e end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , over^ start_ARG italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG )</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.3. </span>Approximate Retrieval of Multi-Modal Query-Item Pair</h4>
<div class="ltx_para" id="S3.SS3.SSS3.p1">
<p class="ltx_p" id="S3.SS3.SSS3.p1.3">The exact calculation of the attention score between the target query-item pair <math alttext="q_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.1.m1.1"><semantics id="S3.SS3.SSS3.p1.1.m1.1a"><msub id="S3.SS3.SSS3.p1.1.m1.1.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS3.p1.1.m1.1.1.2" xref="S3.SS3.SSS3.p1.1.m1.1.1.2.cmml">q</mi><mi id="S3.SS3.SSS3.p1.1.m1.1.1.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.1.m1.1b"><apply id="S3.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.2">𝑞</ci><ci id="S3.SS3.SSS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.1.m1.1c">q_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.1.m1.1d">italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and the <math alttext="l" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.2.m2.1"><semantics id="S3.SS3.SSS3.p1.2.m2.1a"><mi id="S3.SS3.SSS3.p1.2.m2.1.1" xref="S3.SS3.SSS3.p1.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.2.m2.1b"><ci id="S3.SS3.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.2.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.2.m2.1d">italic_l</annotation></semantics></math>-th query-item behavior <math alttext="k_{l}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.3.m3.1"><semantics id="S3.SS3.SSS3.p1.3.m3.1a"><msub id="S3.SS3.SSS3.p1.3.m3.1.1" xref="S3.SS3.SSS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.SSS3.p1.3.m3.1.1.2" xref="S3.SS3.SSS3.p1.3.m3.1.1.2.cmml">k</mi><mi id="S3.SS3.SSS3.p1.3.m3.1.1.3" xref="S3.SS3.SSS3.p1.3.m3.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.3.m3.1b"><apply id="S3.SS3.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1.2">𝑘</ci><ci id="S3.SS3.SSS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.3.m3.1c">k_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.3.m3.1d">italic_k start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> is the inner product of the weighted sum of multiple vectors as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{q_{t}}^{T}k_{l}=(\sum_{i\in M+1}\gamma_{i}{x}^{(i)}_{t})^{T}(\sum_{j\in M+1}%
\gamma_{j}{x}^{(j)}_{l}),\forall l\in\{1,2,...L\}" class="ltx_Math" display="block" id="S3.Ex10.m1.6"><semantics id="S3.Ex10.m1.6a"><mrow id="S3.Ex10.m1.6.6.2" xref="S3.Ex10.m1.6.6.3.cmml"><mrow id="S3.Ex10.m1.5.5.1.1" xref="S3.Ex10.m1.5.5.1.1.cmml"><mrow id="S3.Ex10.m1.5.5.1.1.4" xref="S3.Ex10.m1.5.5.1.1.4.cmml"><mmultiscripts id="S3.Ex10.m1.5.5.1.1.4.2" xref="S3.Ex10.m1.5.5.1.1.4.2.cmml"><mi id="S3.Ex10.m1.5.5.1.1.4.2.2.2" xref="S3.Ex10.m1.5.5.1.1.4.2.2.2.cmml">q</mi><mi id="S3.Ex10.m1.5.5.1.1.4.2.2.3" xref="S3.Ex10.m1.5.5.1.1.4.2.2.3.cmml">t</mi><mrow id="S3.Ex10.m1.5.5.1.1.4.2a" xref="S3.Ex10.m1.5.5.1.1.4.2.cmml"></mrow><mrow id="S3.Ex10.m1.5.5.1.1.4.2b" xref="S3.Ex10.m1.5.5.1.1.4.2.cmml"></mrow><mi id="S3.Ex10.m1.5.5.1.1.4.2.3" xref="S3.Ex10.m1.5.5.1.1.4.2.3.cmml">T</mi></mmultiscripts><mo id="S3.Ex10.m1.5.5.1.1.4.1" xref="S3.Ex10.m1.5.5.1.1.4.1.cmml">⁢</mo><msub id="S3.Ex10.m1.5.5.1.1.4.3" xref="S3.Ex10.m1.5.5.1.1.4.3.cmml"><mi id="S3.Ex10.m1.5.5.1.1.4.3.2" xref="S3.Ex10.m1.5.5.1.1.4.3.2.cmml">k</mi><mi id="S3.Ex10.m1.5.5.1.1.4.3.3" xref="S3.Ex10.m1.5.5.1.1.4.3.3.cmml">l</mi></msub></mrow><mo id="S3.Ex10.m1.5.5.1.1.3" xref="S3.Ex10.m1.5.5.1.1.3.cmml">=</mo><mrow id="S3.Ex10.m1.5.5.1.1.2" xref="S3.Ex10.m1.5.5.1.1.2.cmml"><msup id="S3.Ex10.m1.5.5.1.1.1.1" xref="S3.Ex10.m1.5.5.1.1.1.1.cmml"><mrow id="S3.Ex10.m1.5.5.1.1.1.1.1.1" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex10.m1.5.5.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.cmml"><munder id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.2" lspace="0em" movablelimits="false" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">∑</mo><mrow id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.1" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml">∈</mo><mrow id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.3.2" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.3.2.cmml">M</mi><mo id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.3.1" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.3.3" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></munder><mrow id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.cmml"><msub id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.2" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.2.2.cmml">γ</mi><mi id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.2.3" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.1" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msubsup id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3.2.2" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3.2.2.cmml">x</mi><mi id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3.3.cmml">t</mi><mrow id="S3.Ex10.m1.1.1.1.3" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3.cmml"><mo id="S3.Ex10.m1.1.1.1.3.1" stretchy="false" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3.cmml">(</mo><mi id="S3.Ex10.m1.1.1.1.1" xref="S3.Ex10.m1.1.1.1.1.cmml">i</mi><mo id="S3.Ex10.m1.1.1.1.3.2" stretchy="false" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="S3.Ex10.m1.5.5.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.Ex10.m1.5.5.1.1.1.1.3" xref="S3.Ex10.m1.5.5.1.1.1.1.3.cmml">T</mi></msup><mo id="S3.Ex10.m1.5.5.1.1.2.3" xref="S3.Ex10.m1.5.5.1.1.2.3.cmml">⁢</mo><mrow id="S3.Ex10.m1.5.5.1.1.2.2.1" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.cmml"><mo id="S3.Ex10.m1.5.5.1.1.2.2.1.2" stretchy="false" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.cmml">(</mo><mrow id="S3.Ex10.m1.5.5.1.1.2.2.1.1" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.cmml"><munder id="S3.Ex10.m1.5.5.1.1.2.2.1.1.1" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.cmml"><mo id="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.2" lspace="0em" movablelimits="false" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.2.cmml">∑</mo><mrow id="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.cmml"><mi id="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.2" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.2.cmml">j</mi><mo id="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.1" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.1.cmml">∈</mo><mrow id="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.3" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.3.cmml"><mi id="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.3.2" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.3.2.cmml">M</mi><mo id="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.3.1" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.3.1.cmml">+</mo><mn id="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.3.3" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></munder><mrow id="S3.Ex10.m1.5.5.1.1.2.2.1.1.2" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.cmml"><msub id="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.2" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.2.cmml"><mi id="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.2.2" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.2.2.cmml">γ</mi><mi id="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.2.3" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.2.3.cmml">j</mi></msub><mo id="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.1" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.1.cmml">⁢</mo><msubsup id="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3.cmml"><mi id="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3.2.2" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3.2.2.cmml">x</mi><mi id="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3.3" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3.3.cmml">l</mi><mrow id="S3.Ex10.m1.2.2.1.3" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3.cmml"><mo id="S3.Ex10.m1.2.2.1.3.1" stretchy="false" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3.cmml">(</mo><mi id="S3.Ex10.m1.2.2.1.1" xref="S3.Ex10.m1.2.2.1.1.cmml">j</mi><mo id="S3.Ex10.m1.2.2.1.3.2" stretchy="false" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="S3.Ex10.m1.5.5.1.1.2.2.1.3" stretchy="false" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex10.m1.6.6.2.3" xref="S3.Ex10.m1.6.6.3a.cmml">,</mo><mrow id="S3.Ex10.m1.6.6.2.2" xref="S3.Ex10.m1.6.6.2.2.cmml"><mrow id="S3.Ex10.m1.6.6.2.2.3" xref="S3.Ex10.m1.6.6.2.2.3.cmml"><mo id="S3.Ex10.m1.6.6.2.2.3.1" rspace="0.167em" xref="S3.Ex10.m1.6.6.2.2.3.1.cmml">∀</mo><mi id="S3.Ex10.m1.6.6.2.2.3.2" xref="S3.Ex10.m1.6.6.2.2.3.2.cmml">l</mi></mrow><mo id="S3.Ex10.m1.6.6.2.2.2" xref="S3.Ex10.m1.6.6.2.2.2.cmml">∈</mo><mrow id="S3.Ex10.m1.6.6.2.2.1.1" xref="S3.Ex10.m1.6.6.2.2.1.2.cmml"><mo id="S3.Ex10.m1.6.6.2.2.1.1.2" stretchy="false" xref="S3.Ex10.m1.6.6.2.2.1.2.cmml">{</mo><mn id="S3.Ex10.m1.3.3" xref="S3.Ex10.m1.3.3.cmml">1</mn><mo id="S3.Ex10.m1.6.6.2.2.1.1.3" xref="S3.Ex10.m1.6.6.2.2.1.2.cmml">,</mo><mn id="S3.Ex10.m1.4.4" xref="S3.Ex10.m1.4.4.cmml">2</mn><mo id="S3.Ex10.m1.6.6.2.2.1.1.4" xref="S3.Ex10.m1.6.6.2.2.1.2.cmml">,</mo><mrow id="S3.Ex10.m1.6.6.2.2.1.1.1" xref="S3.Ex10.m1.6.6.2.2.1.1.1.cmml"><mi id="S3.Ex10.m1.6.6.2.2.1.1.1.2" mathvariant="normal" xref="S3.Ex10.m1.6.6.2.2.1.1.1.2.cmml">…</mi><mo id="S3.Ex10.m1.6.6.2.2.1.1.1.1" xref="S3.Ex10.m1.6.6.2.2.1.1.1.1.cmml">⁢</mo><mi id="S3.Ex10.m1.6.6.2.2.1.1.1.3" xref="S3.Ex10.m1.6.6.2.2.1.1.1.3.cmml">L</mi></mrow><mo id="S3.Ex10.m1.6.6.2.2.1.1.5" stretchy="false" xref="S3.Ex10.m1.6.6.2.2.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex10.m1.6b"><apply id="S3.Ex10.m1.6.6.3.cmml" xref="S3.Ex10.m1.6.6.2"><csymbol cd="ambiguous" id="S3.Ex10.m1.6.6.3a.cmml" xref="S3.Ex10.m1.6.6.2.3">formulae-sequence</csymbol><apply id="S3.Ex10.m1.5.5.1.1.cmml" xref="S3.Ex10.m1.5.5.1.1"><eq id="S3.Ex10.m1.5.5.1.1.3.cmml" xref="S3.Ex10.m1.5.5.1.1.3"></eq><apply id="S3.Ex10.m1.5.5.1.1.4.cmml" xref="S3.Ex10.m1.5.5.1.1.4"><times id="S3.Ex10.m1.5.5.1.1.4.1.cmml" xref="S3.Ex10.m1.5.5.1.1.4.1"></times><apply id="S3.Ex10.m1.5.5.1.1.4.2.cmml" xref="S3.Ex10.m1.5.5.1.1.4.2"><csymbol cd="ambiguous" id="S3.Ex10.m1.5.5.1.1.4.2.1.cmml" xref="S3.Ex10.m1.5.5.1.1.4.2">superscript</csymbol><apply id="S3.Ex10.m1.5.5.1.1.4.2.2.cmml" xref="S3.Ex10.m1.5.5.1.1.4.2"><csymbol cd="ambiguous" id="S3.Ex10.m1.5.5.1.1.4.2.2.1.cmml" xref="S3.Ex10.m1.5.5.1.1.4.2">subscript</csymbol><ci id="S3.Ex10.m1.5.5.1.1.4.2.2.2.cmml" xref="S3.Ex10.m1.5.5.1.1.4.2.2.2">𝑞</ci><ci id="S3.Ex10.m1.5.5.1.1.4.2.2.3.cmml" xref="S3.Ex10.m1.5.5.1.1.4.2.2.3">𝑡</ci></apply><ci id="S3.Ex10.m1.5.5.1.1.4.2.3.cmml" xref="S3.Ex10.m1.5.5.1.1.4.2.3">𝑇</ci></apply><apply id="S3.Ex10.m1.5.5.1.1.4.3.cmml" xref="S3.Ex10.m1.5.5.1.1.4.3"><csymbol cd="ambiguous" id="S3.Ex10.m1.5.5.1.1.4.3.1.cmml" xref="S3.Ex10.m1.5.5.1.1.4.3">subscript</csymbol><ci id="S3.Ex10.m1.5.5.1.1.4.3.2.cmml" xref="S3.Ex10.m1.5.5.1.1.4.3.2">𝑘</ci><ci id="S3.Ex10.m1.5.5.1.1.4.3.3.cmml" xref="S3.Ex10.m1.5.5.1.1.4.3.3">𝑙</ci></apply></apply><apply id="S3.Ex10.m1.5.5.1.1.2.cmml" xref="S3.Ex10.m1.5.5.1.1.2"><times id="S3.Ex10.m1.5.5.1.1.2.3.cmml" xref="S3.Ex10.m1.5.5.1.1.2.3"></times><apply id="S3.Ex10.m1.5.5.1.1.1.1.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex10.m1.5.5.1.1.1.1.2.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1">superscript</csymbol><apply id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1"><apply id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.2"></sum><apply id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3"><in id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.1"></in><ci id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.2">𝑖</ci><apply id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.3"><plus id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.3.1"></plus><ci id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.3.2">𝑀</ci><cn id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2"><times id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.1"></times><apply id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.2.2">𝛾</ci><ci id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3">subscript</csymbol><apply id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3.2.2">𝑥</ci><ci id="S3.Ex10.m1.1.1.1.1.cmml" xref="S3.Ex10.m1.1.1.1.1">𝑖</ci></apply><ci id="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply></apply><ci id="S3.Ex10.m1.5.5.1.1.1.1.3.cmml" xref="S3.Ex10.m1.5.5.1.1.1.1.3">𝑇</ci></apply><apply id="S3.Ex10.m1.5.5.1.1.2.2.1.1.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1"><apply id="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.1.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.1">subscript</csymbol><sum id="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.2.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.2"></sum><apply id="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3"><in id="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.1.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.1"></in><ci id="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.2.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.2">𝑗</ci><apply id="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.3.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.3"><plus id="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.3.1.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.3.1"></plus><ci id="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.3.2.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.3.2">𝑀</ci><cn id="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.3.3.cmml" type="integer" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2"><times id="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.1.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.1"></times><apply id="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.2.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.2.1.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.2">subscript</csymbol><ci id="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.2.2.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.2.2">𝛾</ci><ci id="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.2.3.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.2.3">𝑗</ci></apply><apply id="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3.1.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3">subscript</csymbol><apply id="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3.2.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3.2.1.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3">superscript</csymbol><ci id="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3.2.2.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3.2.2">𝑥</ci><ci id="S3.Ex10.m1.2.2.1.1.cmml" xref="S3.Ex10.m1.2.2.1.1">𝑗</ci></apply><ci id="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3.3.cmml" xref="S3.Ex10.m1.5.5.1.1.2.2.1.1.2.3.3">𝑙</ci></apply></apply></apply></apply></apply><apply id="S3.Ex10.m1.6.6.2.2.cmml" xref="S3.Ex10.m1.6.6.2.2"><in id="S3.Ex10.m1.6.6.2.2.2.cmml" xref="S3.Ex10.m1.6.6.2.2.2"></in><apply id="S3.Ex10.m1.6.6.2.2.3.cmml" xref="S3.Ex10.m1.6.6.2.2.3"><csymbol cd="latexml" id="S3.Ex10.m1.6.6.2.2.3.1.cmml" xref="S3.Ex10.m1.6.6.2.2.3.1">for-all</csymbol><ci id="S3.Ex10.m1.6.6.2.2.3.2.cmml" xref="S3.Ex10.m1.6.6.2.2.3.2">𝑙</ci></apply><set id="S3.Ex10.m1.6.6.2.2.1.2.cmml" xref="S3.Ex10.m1.6.6.2.2.1.1"><cn id="S3.Ex10.m1.3.3.cmml" type="integer" xref="S3.Ex10.m1.3.3">1</cn><cn id="S3.Ex10.m1.4.4.cmml" type="integer" xref="S3.Ex10.m1.4.4">2</cn><apply id="S3.Ex10.m1.6.6.2.2.1.1.1.cmml" xref="S3.Ex10.m1.6.6.2.2.1.1.1"><times id="S3.Ex10.m1.6.6.2.2.1.1.1.1.cmml" xref="S3.Ex10.m1.6.6.2.2.1.1.1.1"></times><ci id="S3.Ex10.m1.6.6.2.2.1.1.1.2.cmml" xref="S3.Ex10.m1.6.6.2.2.1.1.1.2">…</ci><ci id="S3.Ex10.m1.6.6.2.2.1.1.1.3.cmml" xref="S3.Ex10.m1.6.6.2.2.1.1.1.3">𝐿</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex10.m1.6c">{q_{t}}^{T}k_{l}=(\sum_{i\in M+1}\gamma_{i}{x}^{(i)}_{t})^{T}(\sum_{j\in M+1}%
\gamma_{j}{x}^{(j)}_{l}),\forall l\in\{1,2,...L\}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex10.m1.6d">italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_k start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = ( ∑ start_POSTSUBSCRIPT italic_i ∈ italic_M + 1 end_POSTSUBSCRIPT italic_γ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ( ∑ start_POSTSUBSCRIPT italic_j ∈ italic_M + 1 end_POSTSUBSCRIPT italic_γ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_x start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) , ∀ italic_l ∈ { 1 , 2 , … italic_L }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.p2">
<p class="ltx_p" id="S3.SS3.SSS3.p2.6">The exact calculation has the time complexity of <math alttext="O(L\times M\times d)" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.1.m1.1"><semantics id="S3.SS3.SSS3.p2.1.m1.1a"><mrow id="S3.SS3.SSS3.p2.1.m1.1.1" xref="S3.SS3.SSS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.SSS3.p2.1.m1.1.1.3" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.cmml">O</mi><mo id="S3.SS3.SSS3.p2.1.m1.1.1.2" xref="S3.SS3.SSS3.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p2.1.m1.1.1.1.1" xref="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS3.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1" xref="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.2" xref="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.2.cmml">L</mi><mo id="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.1.cmml">×</mo><mi id="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.3" xref="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.3.cmml">M</mi><mo id="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.1.cmml">×</mo><mi id="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.4" xref="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.4.cmml">d</mi></mrow><mo id="S3.SS3.SSS3.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.1.m1.1b"><apply id="S3.SS3.SSS3.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1"><times id="S3.SS3.SSS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.2"></times><ci id="S3.SS3.SSS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.3">𝑂</ci><apply id="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.1.1"><times id="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.1"></times><ci id="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.2">𝐿</ci><ci id="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.3">𝑀</ci><ci id="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.4.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.1.1.1.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.1.m1.1c">O(L\times M\times d)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.1.m1.1d">italic_O ( italic_L × italic_M × italic_d )</annotation></semantics></math>. <math alttext="L" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.2.m2.1"><semantics id="S3.SS3.SSS3.p2.2.m2.1a"><mi id="S3.SS3.SSS3.p2.2.m2.1.1" xref="S3.SS3.SSS3.p2.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.2.m2.1b"><ci id="S3.SS3.SSS3.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.2.m2.1d">italic_L</annotation></semantics></math> denotes the sequence length, <math alttext="M" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.3.m3.1"><semantics id="S3.SS3.SSS3.p2.3.m3.1a"><mi id="S3.SS3.SSS3.p2.3.m3.1.1" xref="S3.SS3.SSS3.p2.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.3.m3.1b"><ci id="S3.SS3.SSS3.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.3.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.3.m3.1d">italic_M</annotation></semantics></math> denotes the number of weighted sum operations of multi-modal embedding vectors of dimension <math alttext="d" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.4.m4.1"><semantics id="S3.SS3.SSS3.p2.4.m4.1a"><mi id="S3.SS3.SSS3.p2.4.m4.1.1" xref="S3.SS3.SSS3.p2.4.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.4.m4.1b"><ci id="S3.SS3.SSS3.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.4.m4.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.4.m4.1d">italic_d</annotation></semantics></math>. The calculation becomes time-consuming when <math alttext="L" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.5.m5.1"><semantics id="S3.SS3.SSS3.p2.5.m5.1a"><mi id="S3.SS3.SSS3.p2.5.m5.1.1" xref="S3.SS3.SSS3.p2.5.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.5.m5.1b"><ci id="S3.SS3.SSS3.p2.5.m5.1.1.cmml" xref="S3.SS3.SSS3.p2.5.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.5.m5.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.5.m5.1d">italic_L</annotation></semantics></math> is very large (<math alttext="10^{4}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.6.m6.1"><semantics id="S3.SS3.SSS3.p2.6.m6.1a"><msup id="S3.SS3.SSS3.p2.6.m6.1.1" xref="S3.SS3.SSS3.p2.6.m6.1.1.cmml"><mn id="S3.SS3.SSS3.p2.6.m6.1.1.2" xref="S3.SS3.SSS3.p2.6.m6.1.1.2.cmml">10</mn><mn id="S3.SS3.SSS3.p2.6.m6.1.1.3" xref="S3.SS3.SSS3.p2.6.m6.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.6.m6.1b"><apply id="S3.SS3.SSS3.p2.6.m6.1.1.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1">superscript</csymbol><cn id="S3.SS3.SSS3.p2.6.m6.1.1.2.cmml" type="integer" xref="S3.SS3.SSS3.p2.6.m6.1.1.2">10</cn><cn id="S3.SS3.SSS3.p2.6.m6.1.1.3.cmml" type="integer" xref="S3.SS3.SSS3.p2.6.m6.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.6.m6.1c">10^{4}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.6.m6.1d">10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math>) in the lifelong sequence of multi-modal query-item pairs setting.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.p3">
<p class="ltx_p" id="S3.SS3.SSS3.p3.7">One straightforward method of fast retrieval <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.1.m1.1"><semantics id="S3.SS3.SSS3.p3.1.m1.1a"><mi id="S3.SS3.SSS3.p3.1.m1.1.1" xref="S3.SS3.SSS3.p3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.1.m1.1b"><ci id="S3.SS3.SSS3.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.1.m1.1d">italic_K</annotation></semantics></math> nearest vectors given an input query vector <math alttext="q" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.2.m2.1"><semantics id="S3.SS3.SSS3.p3.2.m2.1a"><mi id="S3.SS3.SSS3.p3.2.m2.1.1" xref="S3.SS3.SSS3.p3.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.2.m2.1b"><ci id="S3.SS3.SSS3.p3.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p3.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.2.m2.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.2.m2.1d">italic_q</annotation></semantics></math> is to build an embedding index, such as HNSW <cite class="ltx_cite ltx_citemacro_citep">(Malkov and Yashunin, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib12" title="">2018</a>)</cite>, and conduct ANN (Approximate Nearest Neighbors) search. However, there are difficulties in building an embedding index to retrieve the target query-item pair from the sequence of multi-modal query-item pairs. To search the vectors of behaviors given the input target query-item pair <math alttext="q_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.3.m3.1"><semantics id="S3.SS3.SSS3.p3.3.m3.1a"><msub id="S3.SS3.SSS3.p3.3.m3.1.1" xref="S3.SS3.SSS3.p3.3.m3.1.1.cmml"><mi id="S3.SS3.SSS3.p3.3.m3.1.1.2" xref="S3.SS3.SSS3.p3.3.m3.1.1.2.cmml">q</mi><mi id="S3.SS3.SSS3.p3.3.m3.1.1.3" xref="S3.SS3.SSS3.p3.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.3.m3.1b"><apply id="S3.SS3.SSS3.p3.3.m3.1.1.cmml" xref="S3.SS3.SSS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.SSS3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.SSS3.p3.3.m3.1.1.2">𝑞</ci><ci id="S3.SS3.SSS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.SSS3.p3.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.3.m3.1c">q_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.3.m3.1d">italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> as in the exact attention calculation, we build a vector index which assigns a primary key to represent each vector, such as Item ID, Query ID, etc. However, in our aligned sequence of query-item pairs, each merged query-item representation have the joint key of (query_id, item_id), and the required amount of storage increases from the item set size <math alttext="|\mathcal{B}|" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.4.m4.1"><semantics id="S3.SS3.SSS3.p3.4.m4.1a"><mrow id="S3.SS3.SSS3.p3.4.m4.1.2.2" xref="S3.SS3.SSS3.p3.4.m4.1.2.1.cmml"><mo id="S3.SS3.SSS3.p3.4.m4.1.2.2.1" stretchy="false" xref="S3.SS3.SSS3.p3.4.m4.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p3.4.m4.1.1" xref="S3.SS3.SSS3.p3.4.m4.1.1.cmml">ℬ</mi><mo id="S3.SS3.SSS3.p3.4.m4.1.2.2.2" stretchy="false" xref="S3.SS3.SSS3.p3.4.m4.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.4.m4.1b"><apply id="S3.SS3.SSS3.p3.4.m4.1.2.1.cmml" xref="S3.SS3.SSS3.p3.4.m4.1.2.2"><abs id="S3.SS3.SSS3.p3.4.m4.1.2.1.1.cmml" xref="S3.SS3.SSS3.p3.4.m4.1.2.2.1"></abs><ci id="S3.SS3.SSS3.p3.4.m4.1.1.cmml" xref="S3.SS3.SSS3.p3.4.m4.1.1">ℬ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.4.m4.1c">|\mathcal{B}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.4.m4.1d">| caligraphic_B |</annotation></semantics></math> to the cartesian product of the query set size <math alttext="|\mathcal{Q}|" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.5.m5.1"><semantics id="S3.SS3.SSS3.p3.5.m5.1a"><mrow id="S3.SS3.SSS3.p3.5.m5.1.2.2" xref="S3.SS3.SSS3.p3.5.m5.1.2.1.cmml"><mo id="S3.SS3.SSS3.p3.5.m5.1.2.2.1" stretchy="false" xref="S3.SS3.SSS3.p3.5.m5.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p3.5.m5.1.1" xref="S3.SS3.SSS3.p3.5.m5.1.1.cmml">𝒬</mi><mo id="S3.SS3.SSS3.p3.5.m5.1.2.2.2" stretchy="false" xref="S3.SS3.SSS3.p3.5.m5.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.5.m5.1b"><apply id="S3.SS3.SSS3.p3.5.m5.1.2.1.cmml" xref="S3.SS3.SSS3.p3.5.m5.1.2.2"><abs id="S3.SS3.SSS3.p3.5.m5.1.2.1.1.cmml" xref="S3.SS3.SSS3.p3.5.m5.1.2.2.1"></abs><ci id="S3.SS3.SSS3.p3.5.m5.1.1.cmml" xref="S3.SS3.SSS3.p3.5.m5.1.1">𝒬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.5.m5.1c">|\mathcal{Q}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.5.m5.1d">| caligraphic_Q |</annotation></semantics></math> and the item set size <math alttext="|\mathcal{B}|" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.6.m6.1"><semantics id="S3.SS3.SSS3.p3.6.m6.1a"><mrow id="S3.SS3.SSS3.p3.6.m6.1.2.2" xref="S3.SS3.SSS3.p3.6.m6.1.2.1.cmml"><mo id="S3.SS3.SSS3.p3.6.m6.1.2.2.1" stretchy="false" xref="S3.SS3.SSS3.p3.6.m6.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p3.6.m6.1.1" xref="S3.SS3.SSS3.p3.6.m6.1.1.cmml">ℬ</mi><mo id="S3.SS3.SSS3.p3.6.m6.1.2.2.2" stretchy="false" xref="S3.SS3.SSS3.p3.6.m6.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.6.m6.1b"><apply id="S3.SS3.SSS3.p3.6.m6.1.2.1.cmml" xref="S3.SS3.SSS3.p3.6.m6.1.2.2"><abs id="S3.SS3.SSS3.p3.6.m6.1.2.1.1.cmml" xref="S3.SS3.SSS3.p3.6.m6.1.2.2.1"></abs><ci id="S3.SS3.SSS3.p3.6.m6.1.1.cmml" xref="S3.SS3.SSS3.p3.6.m6.1.1">ℬ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.6.m6.1c">|\mathcal{B}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.6.m6.1d">| caligraphic_B |</annotation></semantics></math> as <math alttext="|\mathcal{Q}||\mathcal{B}|" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.7.m7.2"><semantics id="S3.SS3.SSS3.p3.7.m7.2a"><mrow id="S3.SS3.SSS3.p3.7.m7.2.3" xref="S3.SS3.SSS3.p3.7.m7.2.3.cmml"><mrow id="S3.SS3.SSS3.p3.7.m7.2.3.2.2" xref="S3.SS3.SSS3.p3.7.m7.2.3.2.1.cmml"><mo id="S3.SS3.SSS3.p3.7.m7.2.3.2.2.1" stretchy="false" xref="S3.SS3.SSS3.p3.7.m7.2.3.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p3.7.m7.1.1" xref="S3.SS3.SSS3.p3.7.m7.1.1.cmml">𝒬</mi><mo id="S3.SS3.SSS3.p3.7.m7.2.3.2.2.2" stretchy="false" xref="S3.SS3.SSS3.p3.7.m7.2.3.2.1.1.cmml">|</mo></mrow><mo id="S3.SS3.SSS3.p3.7.m7.2.3.1" xref="S3.SS3.SSS3.p3.7.m7.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p3.7.m7.2.3.3.2" xref="S3.SS3.SSS3.p3.7.m7.2.3.3.1.cmml"><mo id="S3.SS3.SSS3.p3.7.m7.2.3.3.2.1" stretchy="false" xref="S3.SS3.SSS3.p3.7.m7.2.3.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p3.7.m7.2.2" xref="S3.SS3.SSS3.p3.7.m7.2.2.cmml">ℬ</mi><mo id="S3.SS3.SSS3.p3.7.m7.2.3.3.2.2" stretchy="false" xref="S3.SS3.SSS3.p3.7.m7.2.3.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.7.m7.2b"><apply id="S3.SS3.SSS3.p3.7.m7.2.3.cmml" xref="S3.SS3.SSS3.p3.7.m7.2.3"><times id="S3.SS3.SSS3.p3.7.m7.2.3.1.cmml" xref="S3.SS3.SSS3.p3.7.m7.2.3.1"></times><apply id="S3.SS3.SSS3.p3.7.m7.2.3.2.1.cmml" xref="S3.SS3.SSS3.p3.7.m7.2.3.2.2"><abs id="S3.SS3.SSS3.p3.7.m7.2.3.2.1.1.cmml" xref="S3.SS3.SSS3.p3.7.m7.2.3.2.2.1"></abs><ci id="S3.SS3.SSS3.p3.7.m7.1.1.cmml" xref="S3.SS3.SSS3.p3.7.m7.1.1">𝒬</ci></apply><apply id="S3.SS3.SSS3.p3.7.m7.2.3.3.1.cmml" xref="S3.SS3.SSS3.p3.7.m7.2.3.3.2"><abs id="S3.SS3.SSS3.p3.7.m7.2.3.3.1.1.cmml" xref="S3.SS3.SSS3.p3.7.m7.2.3.3.2.1"></abs><ci id="S3.SS3.SSS3.p3.7.m7.2.2.cmml" xref="S3.SS3.SSS3.p3.7.m7.2.2">ℬ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.7.m7.2c">|\mathcal{Q}||\mathcal{B}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.7.m7.2d">| caligraphic_Q | | caligraphic_B |</annotation></semantics></math>, which is almost infeasible to store the merged query-item pair in a single index directly.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.p4">
<p class="ltx_p" id="S3.SS3.SSS3.p4.6">An alternative cascading cross-modal strategy is considered to retrieve top-K relevant query-item pairs. Firstly, we build two separate vector indexes of the query set with size <math alttext="|\mathcal{Q}|" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p4.1.m1.1"><semantics id="S3.SS3.SSS3.p4.1.m1.1a"><mrow id="S3.SS3.SSS3.p4.1.m1.1.2.2" xref="S3.SS3.SSS3.p4.1.m1.1.2.1.cmml"><mo id="S3.SS3.SSS3.p4.1.m1.1.2.2.1" stretchy="false" xref="S3.SS3.SSS3.p4.1.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p4.1.m1.1.1" xref="S3.SS3.SSS3.p4.1.m1.1.1.cmml">𝒬</mi><mo id="S3.SS3.SSS3.p4.1.m1.1.2.2.2" stretchy="false" xref="S3.SS3.SSS3.p4.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p4.1.m1.1b"><apply id="S3.SS3.SSS3.p4.1.m1.1.2.1.cmml" xref="S3.SS3.SSS3.p4.1.m1.1.2.2"><abs id="S3.SS3.SSS3.p4.1.m1.1.2.1.1.cmml" xref="S3.SS3.SSS3.p4.1.m1.1.2.2.1"></abs><ci id="S3.SS3.SSS3.p4.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p4.1.m1.1.1">𝒬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p4.1.m1.1c">|\mathcal{Q}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p4.1.m1.1d">| caligraphic_Q |</annotation></semantics></math> and the item set with size <math alttext="|\mathcal{B}|" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p4.2.m2.1"><semantics id="S3.SS3.SSS3.p4.2.m2.1a"><mrow id="S3.SS3.SSS3.p4.2.m2.1.2.2" xref="S3.SS3.SSS3.p4.2.m2.1.2.1.cmml"><mo id="S3.SS3.SSS3.p4.2.m2.1.2.2.1" stretchy="false" xref="S3.SS3.SSS3.p4.2.m2.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p4.2.m2.1.1" xref="S3.SS3.SSS3.p4.2.m2.1.1.cmml">ℬ</mi><mo id="S3.SS3.SSS3.p4.2.m2.1.2.2.2" stretchy="false" xref="S3.SS3.SSS3.p4.2.m2.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p4.2.m2.1b"><apply id="S3.SS3.SSS3.p4.2.m2.1.2.1.cmml" xref="S3.SS3.SSS3.p4.2.m2.1.2.2"><abs id="S3.SS3.SSS3.p4.2.m2.1.2.1.1.cmml" xref="S3.SS3.SSS3.p4.2.m2.1.2.2.1"></abs><ci id="S3.SS3.SSS3.p4.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p4.2.m2.1.1">ℬ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p4.2.m2.1c">|\mathcal{B}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p4.2.m2.1d">| caligraphic_B |</annotation></semantics></math>. During the online retrieval of target query-item pairs, we conduct vector retrieval four times, including query-to-item, query-to-query, item-to-query, and item-to-item. Each retrieval keeps the top-K items with the maximum inner product. The filter in the first-stage cross-modal retrieval is <math alttext="L\rightarrow 4K" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p4.3.m3.1"><semantics id="S3.SS3.SSS3.p4.3.m3.1a"><mrow id="S3.SS3.SSS3.p4.3.m3.1.1" xref="S3.SS3.SSS3.p4.3.m3.1.1.cmml"><mi id="S3.SS3.SSS3.p4.3.m3.1.1.2" xref="S3.SS3.SSS3.p4.3.m3.1.1.2.cmml">L</mi><mo id="S3.SS3.SSS3.p4.3.m3.1.1.1" stretchy="false" xref="S3.SS3.SSS3.p4.3.m3.1.1.1.cmml">→</mo><mrow id="S3.SS3.SSS3.p4.3.m3.1.1.3" xref="S3.SS3.SSS3.p4.3.m3.1.1.3.cmml"><mn id="S3.SS3.SSS3.p4.3.m3.1.1.3.2" xref="S3.SS3.SSS3.p4.3.m3.1.1.3.2.cmml">4</mn><mo id="S3.SS3.SSS3.p4.3.m3.1.1.3.1" xref="S3.SS3.SSS3.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p4.3.m3.1.1.3.3" xref="S3.SS3.SSS3.p4.3.m3.1.1.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p4.3.m3.1b"><apply id="S3.SS3.SSS3.p4.3.m3.1.1.cmml" xref="S3.SS3.SSS3.p4.3.m3.1.1"><ci id="S3.SS3.SSS3.p4.3.m3.1.1.1.cmml" xref="S3.SS3.SSS3.p4.3.m3.1.1.1">→</ci><ci id="S3.SS3.SSS3.p4.3.m3.1.1.2.cmml" xref="S3.SS3.SSS3.p4.3.m3.1.1.2">𝐿</ci><apply id="S3.SS3.SSS3.p4.3.m3.1.1.3.cmml" xref="S3.SS3.SSS3.p4.3.m3.1.1.3"><times id="S3.SS3.SSS3.p4.3.m3.1.1.3.1.cmml" xref="S3.SS3.SSS3.p4.3.m3.1.1.3.1"></times><cn id="S3.SS3.SSS3.p4.3.m3.1.1.3.2.cmml" type="integer" xref="S3.SS3.SSS3.p4.3.m3.1.1.3.2">4</cn><ci id="S3.SS3.SSS3.p4.3.m3.1.1.3.3.cmml" xref="S3.SS3.SSS3.p4.3.m3.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p4.3.m3.1c">L\rightarrow 4K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p4.3.m3.1d">italic_L → 4 italic_K</annotation></semantics></math>. Given the potential <math alttext="4K" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p4.4.m4.1"><semantics id="S3.SS3.SSS3.p4.4.m4.1a"><mrow id="S3.SS3.SSS3.p4.4.m4.1.1" xref="S3.SS3.SSS3.p4.4.m4.1.1.cmml"><mn id="S3.SS3.SSS3.p4.4.m4.1.1.2" xref="S3.SS3.SSS3.p4.4.m4.1.1.2.cmml">4</mn><mo id="S3.SS3.SSS3.p4.4.m4.1.1.1" xref="S3.SS3.SSS3.p4.4.m4.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p4.4.m4.1.1.3" xref="S3.SS3.SSS3.p4.4.m4.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p4.4.m4.1b"><apply id="S3.SS3.SSS3.p4.4.m4.1.1.cmml" xref="S3.SS3.SSS3.p4.4.m4.1.1"><times id="S3.SS3.SSS3.p4.4.m4.1.1.1.cmml" xref="S3.SS3.SSS3.p4.4.m4.1.1.1"></times><cn id="S3.SS3.SSS3.p4.4.m4.1.1.2.cmml" type="integer" xref="S3.SS3.SSS3.p4.4.m4.1.1.2">4</cn><ci id="S3.SS3.SSS3.p4.4.m4.1.1.3.cmml" xref="S3.SS3.SSS3.p4.4.m4.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p4.4.m4.1c">4K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p4.4.m4.1d">4 italic_K</annotation></semantics></math> items, we conduct an exact attention calculation on these items to obtain the final top-K items, and the filter is <math alttext="4K\rightarrow K" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p4.5.m5.1"><semantics id="S3.SS3.SSS3.p4.5.m5.1a"><mrow id="S3.SS3.SSS3.p4.5.m5.1.1" xref="S3.SS3.SSS3.p4.5.m5.1.1.cmml"><mrow id="S3.SS3.SSS3.p4.5.m5.1.1.2" xref="S3.SS3.SSS3.p4.5.m5.1.1.2.cmml"><mn id="S3.SS3.SSS3.p4.5.m5.1.1.2.2" xref="S3.SS3.SSS3.p4.5.m5.1.1.2.2.cmml">4</mn><mo id="S3.SS3.SSS3.p4.5.m5.1.1.2.1" xref="S3.SS3.SSS3.p4.5.m5.1.1.2.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p4.5.m5.1.1.2.3" xref="S3.SS3.SSS3.p4.5.m5.1.1.2.3.cmml">K</mi></mrow><mo id="S3.SS3.SSS3.p4.5.m5.1.1.1" stretchy="false" xref="S3.SS3.SSS3.p4.5.m5.1.1.1.cmml">→</mo><mi id="S3.SS3.SSS3.p4.5.m5.1.1.3" xref="S3.SS3.SSS3.p4.5.m5.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p4.5.m5.1b"><apply id="S3.SS3.SSS3.p4.5.m5.1.1.cmml" xref="S3.SS3.SSS3.p4.5.m5.1.1"><ci id="S3.SS3.SSS3.p4.5.m5.1.1.1.cmml" xref="S3.SS3.SSS3.p4.5.m5.1.1.1">→</ci><apply id="S3.SS3.SSS3.p4.5.m5.1.1.2.cmml" xref="S3.SS3.SSS3.p4.5.m5.1.1.2"><times id="S3.SS3.SSS3.p4.5.m5.1.1.2.1.cmml" xref="S3.SS3.SSS3.p4.5.m5.1.1.2.1"></times><cn id="S3.SS3.SSS3.p4.5.m5.1.1.2.2.cmml" type="integer" xref="S3.SS3.SSS3.p4.5.m5.1.1.2.2">4</cn><ci id="S3.SS3.SSS3.p4.5.m5.1.1.2.3.cmml" xref="S3.SS3.SSS3.p4.5.m5.1.1.2.3">𝐾</ci></apply><ci id="S3.SS3.SSS3.p4.5.m5.1.1.3.cmml" xref="S3.SS3.SSS3.p4.5.m5.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p4.5.m5.1c">4K\rightarrow K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p4.5.m5.1d">4 italic_K → italic_K</annotation></semantics></math>.
The problem with the cascading cross-modal retrieval strategy is that it may achieve a suboptimal solution compared to exact full attention calculation. This is because the final inner product is a weighted average of all modalities. Additionally, top-K relevant items from one modality (e.g., query-to-query relevance) may have very low relevance in other modalities, such as query-to-item (text) or query-to-item (image), thus the overall inner product score is not optimal. <math alttext="Recall@K" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p4.6.m6.1"><semantics id="S3.SS3.SSS3.p4.6.m6.1a"><mrow id="S3.SS3.SSS3.p4.6.m6.1.1" xref="S3.SS3.SSS3.p4.6.m6.1.1.cmml"><mi id="S3.SS3.SSS3.p4.6.m6.1.1.2" xref="S3.SS3.SSS3.p4.6.m6.1.1.2.cmml">R</mi><mo id="S3.SS3.SSS3.p4.6.m6.1.1.1" xref="S3.SS3.SSS3.p4.6.m6.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p4.6.m6.1.1.3" xref="S3.SS3.SSS3.p4.6.m6.1.1.3.cmml">e</mi><mo id="S3.SS3.SSS3.p4.6.m6.1.1.1a" xref="S3.SS3.SSS3.p4.6.m6.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p4.6.m6.1.1.4" xref="S3.SS3.SSS3.p4.6.m6.1.1.4.cmml">c</mi><mo id="S3.SS3.SSS3.p4.6.m6.1.1.1b" xref="S3.SS3.SSS3.p4.6.m6.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p4.6.m6.1.1.5" xref="S3.SS3.SSS3.p4.6.m6.1.1.5.cmml">a</mi><mo id="S3.SS3.SSS3.p4.6.m6.1.1.1c" xref="S3.SS3.SSS3.p4.6.m6.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p4.6.m6.1.1.6" xref="S3.SS3.SSS3.p4.6.m6.1.1.6.cmml">l</mi><mo id="S3.SS3.SSS3.p4.6.m6.1.1.1d" xref="S3.SS3.SSS3.p4.6.m6.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p4.6.m6.1.1.7" xref="S3.SS3.SSS3.p4.6.m6.1.1.7.cmml">l</mi><mo id="S3.SS3.SSS3.p4.6.m6.1.1.1e" xref="S3.SS3.SSS3.p4.6.m6.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p4.6.m6.1.1.8" mathvariant="normal" xref="S3.SS3.SSS3.p4.6.m6.1.1.8.cmml">@</mi><mo id="S3.SS3.SSS3.p4.6.m6.1.1.1f" xref="S3.SS3.SSS3.p4.6.m6.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p4.6.m6.1.1.9" xref="S3.SS3.SSS3.p4.6.m6.1.1.9.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p4.6.m6.1b"><apply id="S3.SS3.SSS3.p4.6.m6.1.1.cmml" xref="S3.SS3.SSS3.p4.6.m6.1.1"><times id="S3.SS3.SSS3.p4.6.m6.1.1.1.cmml" xref="S3.SS3.SSS3.p4.6.m6.1.1.1"></times><ci id="S3.SS3.SSS3.p4.6.m6.1.1.2.cmml" xref="S3.SS3.SSS3.p4.6.m6.1.1.2">𝑅</ci><ci id="S3.SS3.SSS3.p4.6.m6.1.1.3.cmml" xref="S3.SS3.SSS3.p4.6.m6.1.1.3">𝑒</ci><ci id="S3.SS3.SSS3.p4.6.m6.1.1.4.cmml" xref="S3.SS3.SSS3.p4.6.m6.1.1.4">𝑐</ci><ci id="S3.SS3.SSS3.p4.6.m6.1.1.5.cmml" xref="S3.SS3.SSS3.p4.6.m6.1.1.5">𝑎</ci><ci id="S3.SS3.SSS3.p4.6.m6.1.1.6.cmml" xref="S3.SS3.SSS3.p4.6.m6.1.1.6">𝑙</ci><ci id="S3.SS3.SSS3.p4.6.m6.1.1.7.cmml" xref="S3.SS3.SSS3.p4.6.m6.1.1.7">𝑙</ci><ci id="S3.SS3.SSS3.p4.6.m6.1.1.8.cmml" xref="S3.SS3.SSS3.p4.6.m6.1.1.8">@</ci><ci id="S3.SS3.SSS3.p4.6.m6.1.1.9.cmml" xref="S3.SS3.SSS3.p4.6.m6.1.1.9">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p4.6.m6.1c">Recall@K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p4.6.m6.1d">italic_R italic_e italic_c italic_a italic_l italic_l @ italic_K</annotation></semantics></math> can evaluate the performance of the greedy strategy compared to exact calculation.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.p5">
<p class="ltx_p" id="S3.SS3.SSS3.p5.9">To help increase the recall performance while considering the retrieval speed, the key is to reduce the cardinality of the query set <math alttext="\mathcal{Q}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p5.1.m1.1"><semantics id="S3.SS3.SSS3.p5.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p5.1.m1.1.1" xref="S3.SS3.SSS3.p5.1.m1.1.1.cmml">𝒬</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p5.1.m1.1b"><ci id="S3.SS3.SSS3.p5.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p5.1.m1.1.1">𝒬</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p5.1.m1.1c">\mathcal{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p5.1.m1.1d">caligraphic_Q</annotation></semantics></math> and the item set <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p5.2.m2.1"><semantics id="S3.SS3.SSS3.p5.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p5.2.m2.1.1" xref="S3.SS3.SSS3.p5.2.m2.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p5.2.m2.1b"><ci id="S3.SS3.SSS3.p5.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p5.2.m2.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p5.2.m2.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p5.2.m2.1d">caligraphic_B</annotation></semantics></math>. We argue that product quantization is a good approximation strategy, which splits vectors into <math alttext="N_{bit}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p5.3.m3.1"><semantics id="S3.SS3.SSS3.p5.3.m3.1a"><msub id="S3.SS3.SSS3.p5.3.m3.1.1" xref="S3.SS3.SSS3.p5.3.m3.1.1.cmml"><mi id="S3.SS3.SSS3.p5.3.m3.1.1.2" xref="S3.SS3.SSS3.p5.3.m3.1.1.2.cmml">N</mi><mrow id="S3.SS3.SSS3.p5.3.m3.1.1.3" xref="S3.SS3.SSS3.p5.3.m3.1.1.3.cmml"><mi id="S3.SS3.SSS3.p5.3.m3.1.1.3.2" xref="S3.SS3.SSS3.p5.3.m3.1.1.3.2.cmml">b</mi><mo id="S3.SS3.SSS3.p5.3.m3.1.1.3.1" xref="S3.SS3.SSS3.p5.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p5.3.m3.1.1.3.3" xref="S3.SS3.SSS3.p5.3.m3.1.1.3.3.cmml">i</mi><mo id="S3.SS3.SSS3.p5.3.m3.1.1.3.1a" xref="S3.SS3.SSS3.p5.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p5.3.m3.1.1.3.4" xref="S3.SS3.SSS3.p5.3.m3.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p5.3.m3.1b"><apply id="S3.SS3.SSS3.p5.3.m3.1.1.cmml" xref="S3.SS3.SSS3.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.3.m3.1.1.1.cmml" xref="S3.SS3.SSS3.p5.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p5.3.m3.1.1.2.cmml" xref="S3.SS3.SSS3.p5.3.m3.1.1.2">𝑁</ci><apply id="S3.SS3.SSS3.p5.3.m3.1.1.3.cmml" xref="S3.SS3.SSS3.p5.3.m3.1.1.3"><times id="S3.SS3.SSS3.p5.3.m3.1.1.3.1.cmml" xref="S3.SS3.SSS3.p5.3.m3.1.1.3.1"></times><ci id="S3.SS3.SSS3.p5.3.m3.1.1.3.2.cmml" xref="S3.SS3.SSS3.p5.3.m3.1.1.3.2">𝑏</ci><ci id="S3.SS3.SSS3.p5.3.m3.1.1.3.3.cmml" xref="S3.SS3.SSS3.p5.3.m3.1.1.3.3">𝑖</ci><ci id="S3.SS3.SSS3.p5.3.m3.1.1.3.4.cmml" xref="S3.SS3.SSS3.p5.3.m3.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p5.3.m3.1c">N_{bit}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p5.3.m3.1d">italic_N start_POSTSUBSCRIPT italic_b italic_i italic_t end_POSTSUBSCRIPT</annotation></semantics></math> sub-vectors, assigns each sub-vector to the nearest centroid, and reduces the cardinality. In our formulation, we first use a set of separate <math alttext="N_{bit}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p5.4.m4.1"><semantics id="S3.SS3.SSS3.p5.4.m4.1a"><msub id="S3.SS3.SSS3.p5.4.m4.1.1" xref="S3.SS3.SSS3.p5.4.m4.1.1.cmml"><mi id="S3.SS3.SSS3.p5.4.m4.1.1.2" xref="S3.SS3.SSS3.p5.4.m4.1.1.2.cmml">N</mi><mrow id="S3.SS3.SSS3.p5.4.m4.1.1.3" xref="S3.SS3.SSS3.p5.4.m4.1.1.3.cmml"><mi id="S3.SS3.SSS3.p5.4.m4.1.1.3.2" xref="S3.SS3.SSS3.p5.4.m4.1.1.3.2.cmml">b</mi><mo id="S3.SS3.SSS3.p5.4.m4.1.1.3.1" xref="S3.SS3.SSS3.p5.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p5.4.m4.1.1.3.3" xref="S3.SS3.SSS3.p5.4.m4.1.1.3.3.cmml">i</mi><mo id="S3.SS3.SSS3.p5.4.m4.1.1.3.1a" xref="S3.SS3.SSS3.p5.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p5.4.m4.1.1.3.4" xref="S3.SS3.SSS3.p5.4.m4.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p5.4.m4.1b"><apply id="S3.SS3.SSS3.p5.4.m4.1.1.cmml" xref="S3.SS3.SSS3.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.4.m4.1.1.1.cmml" xref="S3.SS3.SSS3.p5.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p5.4.m4.1.1.2.cmml" xref="S3.SS3.SSS3.p5.4.m4.1.1.2">𝑁</ci><apply id="S3.SS3.SSS3.p5.4.m4.1.1.3.cmml" xref="S3.SS3.SSS3.p5.4.m4.1.1.3"><times id="S3.SS3.SSS3.p5.4.m4.1.1.3.1.cmml" xref="S3.SS3.SSS3.p5.4.m4.1.1.3.1"></times><ci id="S3.SS3.SSS3.p5.4.m4.1.1.3.2.cmml" xref="S3.SS3.SSS3.p5.4.m4.1.1.3.2">𝑏</ci><ci id="S3.SS3.SSS3.p5.4.m4.1.1.3.3.cmml" xref="S3.SS3.SSS3.p5.4.m4.1.1.3.3">𝑖</ci><ci id="S3.SS3.SSS3.p5.4.m4.1.1.3.4.cmml" xref="S3.SS3.SSS3.p5.4.m4.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p5.4.m4.1c">N_{bit}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p5.4.m4.1d">italic_N start_POSTSUBSCRIPT italic_b italic_i italic_t end_POSTSUBSCRIPT</annotation></semantics></math> quantization function <math alttext="[q^{(m)}_{1},q^{(m)}_{2},…,q^{(m)}_{N_{bit}}]" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p5.5.m5.7"><semantics id="S3.SS3.SSS3.p5.5.m5.7a"><mrow id="S3.SS3.SSS3.p5.5.m5.7.7.3" xref="S3.SS3.SSS3.p5.5.m5.7.7.4.cmml"><mo id="S3.SS3.SSS3.p5.5.m5.7.7.3.4" stretchy="false" xref="S3.SS3.SSS3.p5.5.m5.7.7.4.cmml">[</mo><msubsup id="S3.SS3.SSS3.p5.5.m5.5.5.1.1" xref="S3.SS3.SSS3.p5.5.m5.5.5.1.1.cmml"><mi id="S3.SS3.SSS3.p5.5.m5.5.5.1.1.2.2" xref="S3.SS3.SSS3.p5.5.m5.5.5.1.1.2.2.cmml">q</mi><mn id="S3.SS3.SSS3.p5.5.m5.5.5.1.1.3" xref="S3.SS3.SSS3.p5.5.m5.5.5.1.1.3.cmml">1</mn><mrow id="S3.SS3.SSS3.p5.5.m5.1.1.1.3" xref="S3.SS3.SSS3.p5.5.m5.5.5.1.1.cmml"><mo id="S3.SS3.SSS3.p5.5.m5.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS3.p5.5.m5.5.5.1.1.cmml">(</mo><mi id="S3.SS3.SSS3.p5.5.m5.1.1.1.1" xref="S3.SS3.SSS3.p5.5.m5.1.1.1.1.cmml">m</mi><mo id="S3.SS3.SSS3.p5.5.m5.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS3.p5.5.m5.5.5.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS3.p5.5.m5.7.7.3.5" xref="S3.SS3.SSS3.p5.5.m5.7.7.4.cmml">,</mo><msubsup id="S3.SS3.SSS3.p5.5.m5.6.6.2.2" xref="S3.SS3.SSS3.p5.5.m5.6.6.2.2.cmml"><mi id="S3.SS3.SSS3.p5.5.m5.6.6.2.2.2.2" xref="S3.SS3.SSS3.p5.5.m5.6.6.2.2.2.2.cmml">q</mi><mn id="S3.SS3.SSS3.p5.5.m5.6.6.2.2.3" xref="S3.SS3.SSS3.p5.5.m5.6.6.2.2.3.cmml">2</mn><mrow id="S3.SS3.SSS3.p5.5.m5.2.2.1.3" xref="S3.SS3.SSS3.p5.5.m5.6.6.2.2.cmml"><mo id="S3.SS3.SSS3.p5.5.m5.2.2.1.3.1" stretchy="false" xref="S3.SS3.SSS3.p5.5.m5.6.6.2.2.cmml">(</mo><mi id="S3.SS3.SSS3.p5.5.m5.2.2.1.1" xref="S3.SS3.SSS3.p5.5.m5.2.2.1.1.cmml">m</mi><mo id="S3.SS3.SSS3.p5.5.m5.2.2.1.3.2" stretchy="false" xref="S3.SS3.SSS3.p5.5.m5.6.6.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS3.p5.5.m5.7.7.3.6" xref="S3.SS3.SSS3.p5.5.m5.7.7.4.cmml">,</mo><mi id="S3.SS3.SSS3.p5.5.m5.4.4" mathvariant="normal" xref="S3.SS3.SSS3.p5.5.m5.4.4.cmml">…</mi><mo id="S3.SS3.SSS3.p5.5.m5.7.7.3.7" xref="S3.SS3.SSS3.p5.5.m5.7.7.4.cmml">,</mo><msubsup id="S3.SS3.SSS3.p5.5.m5.7.7.3.3" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.cmml"><mi id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.2.2" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.2.2.cmml">q</mi><msub id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.cmml"><mi id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.2" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.2.cmml">N</mi><mrow id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3.cmml"><mi id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3.2" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3.2.cmml">b</mi><mo id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3.1" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3.3" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3.3.cmml">i</mi><mo id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3.1a" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3.4" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3.4.cmml">t</mi></mrow></msub><mrow id="S3.SS3.SSS3.p5.5.m5.3.3.1.3" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.cmml"><mo id="S3.SS3.SSS3.p5.5.m5.3.3.1.3.1" stretchy="false" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.cmml">(</mo><mi id="S3.SS3.SSS3.p5.5.m5.3.3.1.1" xref="S3.SS3.SSS3.p5.5.m5.3.3.1.1.cmml">m</mi><mo id="S3.SS3.SSS3.p5.5.m5.3.3.1.3.2" stretchy="false" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS3.p5.5.m5.7.7.3.8" stretchy="false" xref="S3.SS3.SSS3.p5.5.m5.7.7.4.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p5.5.m5.7b"><list id="S3.SS3.SSS3.p5.5.m5.7.7.4.cmml" xref="S3.SS3.SSS3.p5.5.m5.7.7.3"><apply id="S3.SS3.SSS3.p5.5.m5.5.5.1.1.cmml" xref="S3.SS3.SSS3.p5.5.m5.5.5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.5.m5.5.5.1.1.1.cmml" xref="S3.SS3.SSS3.p5.5.m5.5.5.1.1">subscript</csymbol><apply id="S3.SS3.SSS3.p5.5.m5.5.5.1.1.2.cmml" xref="S3.SS3.SSS3.p5.5.m5.5.5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.5.m5.5.5.1.1.2.1.cmml" xref="S3.SS3.SSS3.p5.5.m5.5.5.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p5.5.m5.5.5.1.1.2.2.cmml" xref="S3.SS3.SSS3.p5.5.m5.5.5.1.1.2.2">𝑞</ci><ci id="S3.SS3.SSS3.p5.5.m5.1.1.1.1.cmml" xref="S3.SS3.SSS3.p5.5.m5.1.1.1.1">𝑚</ci></apply><cn id="S3.SS3.SSS3.p5.5.m5.5.5.1.1.3.cmml" type="integer" xref="S3.SS3.SSS3.p5.5.m5.5.5.1.1.3">1</cn></apply><apply id="S3.SS3.SSS3.p5.5.m5.6.6.2.2.cmml" xref="S3.SS3.SSS3.p5.5.m5.6.6.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.5.m5.6.6.2.2.1.cmml" xref="S3.SS3.SSS3.p5.5.m5.6.6.2.2">subscript</csymbol><apply id="S3.SS3.SSS3.p5.5.m5.6.6.2.2.2.cmml" xref="S3.SS3.SSS3.p5.5.m5.6.6.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.5.m5.6.6.2.2.2.1.cmml" xref="S3.SS3.SSS3.p5.5.m5.6.6.2.2">superscript</csymbol><ci id="S3.SS3.SSS3.p5.5.m5.6.6.2.2.2.2.cmml" xref="S3.SS3.SSS3.p5.5.m5.6.6.2.2.2.2">𝑞</ci><ci id="S3.SS3.SSS3.p5.5.m5.2.2.1.1.cmml" xref="S3.SS3.SSS3.p5.5.m5.2.2.1.1">𝑚</ci></apply><cn id="S3.SS3.SSS3.p5.5.m5.6.6.2.2.3.cmml" type="integer" xref="S3.SS3.SSS3.p5.5.m5.6.6.2.2.3">2</cn></apply><ci id="S3.SS3.SSS3.p5.5.m5.4.4.cmml" xref="S3.SS3.SSS3.p5.5.m5.4.4">…</ci><apply id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.cmml" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.1.cmml" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3">subscript</csymbol><apply id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.2.cmml" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.2.1.cmml" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3">superscript</csymbol><ci id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.2.2.cmml" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.2.2">𝑞</ci><ci id="S3.SS3.SSS3.p5.5.m5.3.3.1.1.cmml" xref="S3.SS3.SSS3.p5.5.m5.3.3.1.1">𝑚</ci></apply><apply id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.cmml" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.1.cmml" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.2.cmml" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.2">𝑁</ci><apply id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3.cmml" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3"><times id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3.1.cmml" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3.1"></times><ci id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3.2.cmml" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3.2">𝑏</ci><ci id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3.3.cmml" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3.3">𝑖</ci><ci id="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3.4.cmml" xref="S3.SS3.SSS3.p5.5.m5.7.7.3.3.3.3.4">𝑡</ci></apply></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p5.5.m5.7c">[q^{(m)}_{1},q^{(m)}_{2},…,q^{(m)}_{N_{bit}}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p5.5.m5.7d">[ italic_q start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_q start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_q start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_N start_POSTSUBSCRIPT italic_b italic_i italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ]</annotation></semantics></math> to encode embedding of vectors from the <math alttext="m" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p5.6.m6.1"><semantics id="S3.SS3.SSS3.p5.6.m6.1a"><mi id="S3.SS3.SSS3.p5.6.m6.1.1" xref="S3.SS3.SSS3.p5.6.m6.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p5.6.m6.1b"><ci id="S3.SS3.SSS3.p5.6.m6.1.1.cmml" xref="S3.SS3.SSS3.p5.6.m6.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p5.6.m6.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p5.6.m6.1d">italic_m</annotation></semantics></math>-th modal channel <math alttext="\mathbb{x}^{(m)}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p5.7.m7.1"><semantics id="S3.SS3.SSS3.p5.7.m7.1a"><msup id="S3.SS3.SSS3.p5.7.m7.1.2" xref="S3.SS3.SSS3.p5.7.m7.1.2.cmml"><mi id="S3.SS3.SSS3.p5.7.m7.1.2.2" xref="S3.SS3.SSS3.p5.7.m7.1.2.2.cmml">𝕩</mi><mrow id="S3.SS3.SSS3.p5.7.m7.1.1.1.3" xref="S3.SS3.SSS3.p5.7.m7.1.2.cmml"><mo id="S3.SS3.SSS3.p5.7.m7.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS3.p5.7.m7.1.2.cmml">(</mo><mi id="S3.SS3.SSS3.p5.7.m7.1.1.1.1" xref="S3.SS3.SSS3.p5.7.m7.1.1.1.1.cmml">m</mi><mo id="S3.SS3.SSS3.p5.7.m7.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS3.p5.7.m7.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p5.7.m7.1b"><apply id="S3.SS3.SSS3.p5.7.m7.1.2.cmml" xref="S3.SS3.SSS3.p5.7.m7.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.7.m7.1.2.1.cmml" xref="S3.SS3.SSS3.p5.7.m7.1.2">superscript</csymbol><ci id="S3.SS3.SSS3.p5.7.m7.1.2.2.cmml" xref="S3.SS3.SSS3.p5.7.m7.1.2.2">𝕩</ci><ci id="S3.SS3.SSS3.p5.7.m7.1.1.1.1.cmml" xref="S3.SS3.SSS3.p5.7.m7.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p5.7.m7.1c">\mathbb{x}^{(m)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p5.7.m7.1d">blackboard_x start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT</annotation></semantics></math> as integer vectors of <math alttext="{N_{bit}}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p5.8.m8.1"><semantics id="S3.SS3.SSS3.p5.8.m8.1a"><msub id="S3.SS3.SSS3.p5.8.m8.1.1" xref="S3.SS3.SSS3.p5.8.m8.1.1.cmml"><mi id="S3.SS3.SSS3.p5.8.m8.1.1.2" xref="S3.SS3.SSS3.p5.8.m8.1.1.2.cmml">N</mi><mrow id="S3.SS3.SSS3.p5.8.m8.1.1.3" xref="S3.SS3.SSS3.p5.8.m8.1.1.3.cmml"><mi id="S3.SS3.SSS3.p5.8.m8.1.1.3.2" xref="S3.SS3.SSS3.p5.8.m8.1.1.3.2.cmml">b</mi><mo id="S3.SS3.SSS3.p5.8.m8.1.1.3.1" xref="S3.SS3.SSS3.p5.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p5.8.m8.1.1.3.3" xref="S3.SS3.SSS3.p5.8.m8.1.1.3.3.cmml">i</mi><mo id="S3.SS3.SSS3.p5.8.m8.1.1.3.1a" xref="S3.SS3.SSS3.p5.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p5.8.m8.1.1.3.4" xref="S3.SS3.SSS3.p5.8.m8.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p5.8.m8.1b"><apply id="S3.SS3.SSS3.p5.8.m8.1.1.cmml" xref="S3.SS3.SSS3.p5.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.8.m8.1.1.1.cmml" xref="S3.SS3.SSS3.p5.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p5.8.m8.1.1.2.cmml" xref="S3.SS3.SSS3.p5.8.m8.1.1.2">𝑁</ci><apply id="S3.SS3.SSS3.p5.8.m8.1.1.3.cmml" xref="S3.SS3.SSS3.p5.8.m8.1.1.3"><times id="S3.SS3.SSS3.p5.8.m8.1.1.3.1.cmml" xref="S3.SS3.SSS3.p5.8.m8.1.1.3.1"></times><ci id="S3.SS3.SSS3.p5.8.m8.1.1.3.2.cmml" xref="S3.SS3.SSS3.p5.8.m8.1.1.3.2">𝑏</ci><ci id="S3.SS3.SSS3.p5.8.m8.1.1.3.3.cmml" xref="S3.SS3.SSS3.p5.8.m8.1.1.3.3">𝑖</ci><ci id="S3.SS3.SSS3.p5.8.m8.1.1.3.4.cmml" xref="S3.SS3.SSS3.p5.8.m8.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p5.8.m8.1c">{N_{bit}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p5.8.m8.1d">italic_N start_POSTSUBSCRIPT italic_b italic_i italic_t end_POSTSUBSCRIPT</annotation></semantics></math>-dimension, <math alttext="q({\mathbb{x}}^{(m)})=[c^{(m)}_{1},c^{(m)}_{2},...,c^{(m)}_{N_{bit}}]\in%
\mathbb{R}^{N_{bit}}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p5.9.m9.9"><semantics id="S3.SS3.SSS3.p5.9.m9.9a"><mrow id="S3.SS3.SSS3.p5.9.m9.9.9" xref="S3.SS3.SSS3.p5.9.m9.9.9.cmml"><mrow id="S3.SS3.SSS3.p5.9.m9.6.6.1" xref="S3.SS3.SSS3.p5.9.m9.6.6.1.cmml"><mi id="S3.SS3.SSS3.p5.9.m9.6.6.1.3" xref="S3.SS3.SSS3.p5.9.m9.6.6.1.3.cmml">q</mi><mo id="S3.SS3.SSS3.p5.9.m9.6.6.1.2" xref="S3.SS3.SSS3.p5.9.m9.6.6.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p5.9.m9.6.6.1.1.1" xref="S3.SS3.SSS3.p5.9.m9.6.6.1.1.1.1.cmml"><mo id="S3.SS3.SSS3.p5.9.m9.6.6.1.1.1.2" stretchy="false" xref="S3.SS3.SSS3.p5.9.m9.6.6.1.1.1.1.cmml">(</mo><msup id="S3.SS3.SSS3.p5.9.m9.6.6.1.1.1.1" xref="S3.SS3.SSS3.p5.9.m9.6.6.1.1.1.1.cmml"><mi id="S3.SS3.SSS3.p5.9.m9.6.6.1.1.1.1.2" xref="S3.SS3.SSS3.p5.9.m9.6.6.1.1.1.1.2.cmml">𝕩</mi><mrow id="S3.SS3.SSS3.p5.9.m9.1.1.1.3" xref="S3.SS3.SSS3.p5.9.m9.6.6.1.1.1.1.cmml"><mo id="S3.SS3.SSS3.p5.9.m9.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS3.p5.9.m9.6.6.1.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS3.p5.9.m9.1.1.1.1" xref="S3.SS3.SSS3.p5.9.m9.1.1.1.1.cmml">m</mi><mo id="S3.SS3.SSS3.p5.9.m9.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS3.p5.9.m9.6.6.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS3.SSS3.p5.9.m9.6.6.1.1.1.3" stretchy="false" xref="S3.SS3.SSS3.p5.9.m9.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS3.p5.9.m9.9.9.6" xref="S3.SS3.SSS3.p5.9.m9.9.9.6.cmml">=</mo><mrow id="S3.SS3.SSS3.p5.9.m9.9.9.4.3" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.4.cmml"><mo id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.4" stretchy="false" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.4.cmml">[</mo><msubsup id="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1" xref="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1.cmml"><mi id="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1.2.2" xref="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1.2.2.cmml">c</mi><mn id="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1.3" xref="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1.3.cmml">1</mn><mrow id="S3.SS3.SSS3.p5.9.m9.2.2.1.3" xref="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1.cmml"><mo id="S3.SS3.SSS3.p5.9.m9.2.2.1.3.1" stretchy="false" xref="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1.cmml">(</mo><mi id="S3.SS3.SSS3.p5.9.m9.2.2.1.1" xref="S3.SS3.SSS3.p5.9.m9.2.2.1.1.cmml">m</mi><mo id="S3.SS3.SSS3.p5.9.m9.2.2.1.3.2" stretchy="false" xref="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.5" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.4.cmml">,</mo><msubsup id="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2" xref="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2.cmml"><mi id="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2.2.2" xref="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2.2.2.cmml">c</mi><mn id="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2.3" xref="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2.3.cmml">2</mn><mrow id="S3.SS3.SSS3.p5.9.m9.3.3.1.3" xref="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2.cmml"><mo id="S3.SS3.SSS3.p5.9.m9.3.3.1.3.1" stretchy="false" xref="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2.cmml">(</mo><mi id="S3.SS3.SSS3.p5.9.m9.3.3.1.1" xref="S3.SS3.SSS3.p5.9.m9.3.3.1.1.cmml">m</mi><mo id="S3.SS3.SSS3.p5.9.m9.3.3.1.3.2" stretchy="false" xref="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.6" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.4.cmml">,</mo><mi id="S3.SS3.SSS3.p5.9.m9.5.5" mathvariant="normal" xref="S3.SS3.SSS3.p5.9.m9.5.5.cmml">…</mi><mo id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.7" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.4.cmml">,</mo><msubsup id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.cmml"><mi id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.2.2" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.2.2.cmml">c</mi><msub id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.cmml"><mi id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.2" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.2.cmml">N</mi><mrow id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3.cmml"><mi id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3.2" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3.2.cmml">b</mi><mo id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3.1" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3.3" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3.3.cmml">i</mi><mo id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3.1a" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3.4" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3.4.cmml">t</mi></mrow></msub><mrow id="S3.SS3.SSS3.p5.9.m9.4.4.1.3" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.cmml"><mo id="S3.SS3.SSS3.p5.9.m9.4.4.1.3.1" stretchy="false" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.cmml">(</mo><mi id="S3.SS3.SSS3.p5.9.m9.4.4.1.1" xref="S3.SS3.SSS3.p5.9.m9.4.4.1.1.cmml">m</mi><mo id="S3.SS3.SSS3.p5.9.m9.4.4.1.3.2" stretchy="false" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.8" stretchy="false" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.4.cmml">]</mo></mrow><mo id="S3.SS3.SSS3.p5.9.m9.9.9.7" xref="S3.SS3.SSS3.p5.9.m9.9.9.7.cmml">∈</mo><msup id="S3.SS3.SSS3.p5.9.m9.9.9.8" xref="S3.SS3.SSS3.p5.9.m9.9.9.8.cmml"><mi id="S3.SS3.SSS3.p5.9.m9.9.9.8.2" xref="S3.SS3.SSS3.p5.9.m9.9.9.8.2.cmml">ℝ</mi><msub id="S3.SS3.SSS3.p5.9.m9.9.9.8.3" xref="S3.SS3.SSS3.p5.9.m9.9.9.8.3.cmml"><mi id="S3.SS3.SSS3.p5.9.m9.9.9.8.3.2" xref="S3.SS3.SSS3.p5.9.m9.9.9.8.3.2.cmml">N</mi><mrow id="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3" xref="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3.cmml"><mi id="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3.2" xref="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3.2.cmml">b</mi><mo id="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3.1" xref="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3.3" xref="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3.3.cmml">i</mi><mo id="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3.1a" xref="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3.4" xref="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3.4.cmml">t</mi></mrow></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p5.9.m9.9b"><apply id="S3.SS3.SSS3.p5.9.m9.9.9.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9"><and id="S3.SS3.SSS3.p5.9.m9.9.9a.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9"></and><apply id="S3.SS3.SSS3.p5.9.m9.9.9b.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9"><eq id="S3.SS3.SSS3.p5.9.m9.9.9.6.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.6"></eq><apply id="S3.SS3.SSS3.p5.9.m9.6.6.1.cmml" xref="S3.SS3.SSS3.p5.9.m9.6.6.1"><times id="S3.SS3.SSS3.p5.9.m9.6.6.1.2.cmml" xref="S3.SS3.SSS3.p5.9.m9.6.6.1.2"></times><ci id="S3.SS3.SSS3.p5.9.m9.6.6.1.3.cmml" xref="S3.SS3.SSS3.p5.9.m9.6.6.1.3">𝑞</ci><apply id="S3.SS3.SSS3.p5.9.m9.6.6.1.1.1.1.cmml" xref="S3.SS3.SSS3.p5.9.m9.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.9.m9.6.6.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p5.9.m9.6.6.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p5.9.m9.6.6.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p5.9.m9.6.6.1.1.1.1.2">𝕩</ci><ci id="S3.SS3.SSS3.p5.9.m9.1.1.1.1.cmml" xref="S3.SS3.SSS3.p5.9.m9.1.1.1.1">𝑚</ci></apply></apply><list id="S3.SS3.SSS3.p5.9.m9.9.9.4.4.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3"><apply id="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1.cmml" xref="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1.1.cmml" xref="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1">subscript</csymbol><apply id="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1.2.cmml" xref="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1.2.1.cmml" xref="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1.2.2.cmml" xref="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1.2.2">𝑐</ci><ci id="S3.SS3.SSS3.p5.9.m9.2.2.1.1.cmml" xref="S3.SS3.SSS3.p5.9.m9.2.2.1.1">𝑚</ci></apply><cn id="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1.3.cmml" type="integer" xref="S3.SS3.SSS3.p5.9.m9.7.7.2.1.1.3">1</cn></apply><apply id="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2.cmml" xref="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2.1.cmml" xref="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2">subscript</csymbol><apply id="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2.2.cmml" xref="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2.2.1.cmml" xref="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2">superscript</csymbol><ci id="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2.2.2.cmml" xref="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2.2.2">𝑐</ci><ci id="S3.SS3.SSS3.p5.9.m9.3.3.1.1.cmml" xref="S3.SS3.SSS3.p5.9.m9.3.3.1.1">𝑚</ci></apply><cn id="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2.3.cmml" type="integer" xref="S3.SS3.SSS3.p5.9.m9.8.8.3.2.2.3">2</cn></apply><ci id="S3.SS3.SSS3.p5.9.m9.5.5.cmml" xref="S3.SS3.SSS3.p5.9.m9.5.5">…</ci><apply id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.1.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3">subscript</csymbol><apply id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.2.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.2.1.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3">superscript</csymbol><ci id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.2.2.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.2.2">𝑐</ci><ci id="S3.SS3.SSS3.p5.9.m9.4.4.1.1.cmml" xref="S3.SS3.SSS3.p5.9.m9.4.4.1.1">𝑚</ci></apply><apply id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.1.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.2.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.2">𝑁</ci><apply id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3"><times id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3.1.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3.1"></times><ci id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3.2.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3.2">𝑏</ci><ci id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3.3.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3.3">𝑖</ci><ci id="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3.4.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.4.3.3.3.3.4">𝑡</ci></apply></apply></apply></list></apply><apply id="S3.SS3.SSS3.p5.9.m9.9.9c.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9"><in id="S3.SS3.SSS3.p5.9.m9.9.9.7.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.7"></in><share href="https://arxiv.org/html/2407.10714v1#S3.SS3.SSS3.p5.9.m9.9.9.4.cmml" id="S3.SS3.SSS3.p5.9.m9.9.9d.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9"></share><apply id="S3.SS3.SSS3.p5.9.m9.9.9.8.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.8"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.9.m9.9.9.8.1.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.8">superscript</csymbol><ci id="S3.SS3.SSS3.p5.9.m9.9.9.8.2.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.8.2">ℝ</ci><apply id="S3.SS3.SSS3.p5.9.m9.9.9.8.3.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.8.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p5.9.m9.9.9.8.3.1.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.8.3">subscript</csymbol><ci id="S3.SS3.SSS3.p5.9.m9.9.9.8.3.2.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.8.3.2">𝑁</ci><apply id="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3"><times id="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3.1.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3.1"></times><ci id="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3.2.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3.2">𝑏</ci><ci id="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3.3.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3.3">𝑖</ci><ci id="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3.4.cmml" xref="S3.SS3.SSS3.p5.9.m9.9.9.8.3.3.4">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p5.9.m9.9c">q({\mathbb{x}}^{(m)})=[c^{(m)}_{1},c^{(m)}_{2},...,c^{(m)}_{N_{bit}}]\in%
\mathbb{R}^{N_{bit}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p5.9.m9.9d">italic_q ( blackboard_x start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT ) = [ italic_c start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_c start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_c start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_N start_POSTSUBSCRIPT italic_b italic_i italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] ∈ blackboard_R start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_b italic_i italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. Each representation of multi-modal query-item pair is expressed as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="[{\mathbb{x}}^{(1)},...,{\mathbb{x}}^{(M)}]\rightarrow[q({\mathbb{x}}^{(1)}),.%
..,q({\mathbb{x}}^{(M)})]\in\mathbb{R}^{M\times N_{bit}}" class="ltx_Math" display="block" id="S3.Ex11.m1.10"><semantics id="S3.Ex11.m1.10a"><mrow id="S3.Ex11.m1.10.10" xref="S3.Ex11.m1.10.10.cmml"><mrow id="S3.Ex11.m1.8.8.2.2" xref="S3.Ex11.m1.8.8.2.3.cmml"><mo id="S3.Ex11.m1.8.8.2.2.3" stretchy="false" xref="S3.Ex11.m1.8.8.2.3.cmml">[</mo><msup id="S3.Ex11.m1.7.7.1.1.1" xref="S3.Ex11.m1.7.7.1.1.1.cmml"><mi id="S3.Ex11.m1.7.7.1.1.1.2" xref="S3.Ex11.m1.7.7.1.1.1.2.cmml">𝕩</mi><mrow id="S3.Ex11.m1.1.1.1.3" xref="S3.Ex11.m1.7.7.1.1.1.cmml"><mo id="S3.Ex11.m1.1.1.1.3.1" stretchy="false" xref="S3.Ex11.m1.7.7.1.1.1.cmml">(</mo><mn id="S3.Ex11.m1.1.1.1.1" xref="S3.Ex11.m1.1.1.1.1.cmml">1</mn><mo id="S3.Ex11.m1.1.1.1.3.2" stretchy="false" xref="S3.Ex11.m1.7.7.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.Ex11.m1.8.8.2.2.4" xref="S3.Ex11.m1.8.8.2.3.cmml">,</mo><mi id="S3.Ex11.m1.5.5" mathvariant="normal" xref="S3.Ex11.m1.5.5.cmml">…</mi><mo id="S3.Ex11.m1.8.8.2.2.5" xref="S3.Ex11.m1.8.8.2.3.cmml">,</mo><msup id="S3.Ex11.m1.8.8.2.2.2" xref="S3.Ex11.m1.8.8.2.2.2.cmml"><mi id="S3.Ex11.m1.8.8.2.2.2.2" xref="S3.Ex11.m1.8.8.2.2.2.2.cmml">𝕩</mi><mrow id="S3.Ex11.m1.2.2.1.3" xref="S3.Ex11.m1.8.8.2.2.2.cmml"><mo id="S3.Ex11.m1.2.2.1.3.1" stretchy="false" xref="S3.Ex11.m1.8.8.2.2.2.cmml">(</mo><mi id="S3.Ex11.m1.2.2.1.1" xref="S3.Ex11.m1.2.2.1.1.cmml">M</mi><mo id="S3.Ex11.m1.2.2.1.3.2" stretchy="false" xref="S3.Ex11.m1.8.8.2.2.2.cmml">)</mo></mrow></msup><mo id="S3.Ex11.m1.8.8.2.2.6" stretchy="false" xref="S3.Ex11.m1.8.8.2.3.cmml">]</mo></mrow><mo id="S3.Ex11.m1.10.10.6" stretchy="false" xref="S3.Ex11.m1.10.10.6.cmml">→</mo><mrow id="S3.Ex11.m1.10.10.4.2" xref="S3.Ex11.m1.10.10.4.3.cmml"><mo id="S3.Ex11.m1.10.10.4.2.3" stretchy="false" xref="S3.Ex11.m1.10.10.4.3.cmml">[</mo><mrow id="S3.Ex11.m1.9.9.3.1.1" xref="S3.Ex11.m1.9.9.3.1.1.cmml"><mi id="S3.Ex11.m1.9.9.3.1.1.3" xref="S3.Ex11.m1.9.9.3.1.1.3.cmml">q</mi><mo id="S3.Ex11.m1.9.9.3.1.1.2" xref="S3.Ex11.m1.9.9.3.1.1.2.cmml">⁢</mo><mrow id="S3.Ex11.m1.9.9.3.1.1.1.1" xref="S3.Ex11.m1.9.9.3.1.1.1.1.1.cmml"><mo id="S3.Ex11.m1.9.9.3.1.1.1.1.2" stretchy="false" xref="S3.Ex11.m1.9.9.3.1.1.1.1.1.cmml">(</mo><msup id="S3.Ex11.m1.9.9.3.1.1.1.1.1" xref="S3.Ex11.m1.9.9.3.1.1.1.1.1.cmml"><mi id="S3.Ex11.m1.9.9.3.1.1.1.1.1.2" xref="S3.Ex11.m1.9.9.3.1.1.1.1.1.2.cmml">𝕩</mi><mrow id="S3.Ex11.m1.3.3.1.3" xref="S3.Ex11.m1.9.9.3.1.1.1.1.1.cmml"><mo id="S3.Ex11.m1.3.3.1.3.1" stretchy="false" xref="S3.Ex11.m1.9.9.3.1.1.1.1.1.cmml">(</mo><mn id="S3.Ex11.m1.3.3.1.1" xref="S3.Ex11.m1.3.3.1.1.cmml">1</mn><mo id="S3.Ex11.m1.3.3.1.3.2" stretchy="false" xref="S3.Ex11.m1.9.9.3.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.Ex11.m1.9.9.3.1.1.1.1.3" stretchy="false" xref="S3.Ex11.m1.9.9.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex11.m1.10.10.4.2.4" xref="S3.Ex11.m1.10.10.4.3.cmml">,</mo><mi id="S3.Ex11.m1.6.6" mathvariant="normal" xref="S3.Ex11.m1.6.6.cmml">…</mi><mo id="S3.Ex11.m1.10.10.4.2.5" xref="S3.Ex11.m1.10.10.4.3.cmml">,</mo><mrow id="S3.Ex11.m1.10.10.4.2.2" xref="S3.Ex11.m1.10.10.4.2.2.cmml"><mi id="S3.Ex11.m1.10.10.4.2.2.3" xref="S3.Ex11.m1.10.10.4.2.2.3.cmml">q</mi><mo id="S3.Ex11.m1.10.10.4.2.2.2" xref="S3.Ex11.m1.10.10.4.2.2.2.cmml">⁢</mo><mrow id="S3.Ex11.m1.10.10.4.2.2.1.1" xref="S3.Ex11.m1.10.10.4.2.2.1.1.1.cmml"><mo id="S3.Ex11.m1.10.10.4.2.2.1.1.2" stretchy="false" xref="S3.Ex11.m1.10.10.4.2.2.1.1.1.cmml">(</mo><msup id="S3.Ex11.m1.10.10.4.2.2.1.1.1" xref="S3.Ex11.m1.10.10.4.2.2.1.1.1.cmml"><mi id="S3.Ex11.m1.10.10.4.2.2.1.1.1.2" xref="S3.Ex11.m1.10.10.4.2.2.1.1.1.2.cmml">𝕩</mi><mrow id="S3.Ex11.m1.4.4.1.3" xref="S3.Ex11.m1.10.10.4.2.2.1.1.1.cmml"><mo id="S3.Ex11.m1.4.4.1.3.1" stretchy="false" xref="S3.Ex11.m1.10.10.4.2.2.1.1.1.cmml">(</mo><mi id="S3.Ex11.m1.4.4.1.1" xref="S3.Ex11.m1.4.4.1.1.cmml">M</mi><mo id="S3.Ex11.m1.4.4.1.3.2" stretchy="false" xref="S3.Ex11.m1.10.10.4.2.2.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.Ex11.m1.10.10.4.2.2.1.1.3" stretchy="false" xref="S3.Ex11.m1.10.10.4.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex11.m1.10.10.4.2.6" stretchy="false" xref="S3.Ex11.m1.10.10.4.3.cmml">]</mo></mrow><mo id="S3.Ex11.m1.10.10.7" xref="S3.Ex11.m1.10.10.7.cmml">∈</mo><msup id="S3.Ex11.m1.10.10.8" xref="S3.Ex11.m1.10.10.8.cmml"><mi id="S3.Ex11.m1.10.10.8.2" xref="S3.Ex11.m1.10.10.8.2.cmml">ℝ</mi><mrow id="S3.Ex11.m1.10.10.8.3" xref="S3.Ex11.m1.10.10.8.3.cmml"><mi id="S3.Ex11.m1.10.10.8.3.2" xref="S3.Ex11.m1.10.10.8.3.2.cmml">M</mi><mo id="S3.Ex11.m1.10.10.8.3.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex11.m1.10.10.8.3.1.cmml">×</mo><msub id="S3.Ex11.m1.10.10.8.3.3" xref="S3.Ex11.m1.10.10.8.3.3.cmml"><mi id="S3.Ex11.m1.10.10.8.3.3.2" xref="S3.Ex11.m1.10.10.8.3.3.2.cmml">N</mi><mrow id="S3.Ex11.m1.10.10.8.3.3.3" xref="S3.Ex11.m1.10.10.8.3.3.3.cmml"><mi id="S3.Ex11.m1.10.10.8.3.3.3.2" xref="S3.Ex11.m1.10.10.8.3.3.3.2.cmml">b</mi><mo id="S3.Ex11.m1.10.10.8.3.3.3.1" xref="S3.Ex11.m1.10.10.8.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex11.m1.10.10.8.3.3.3.3" xref="S3.Ex11.m1.10.10.8.3.3.3.3.cmml">i</mi><mo id="S3.Ex11.m1.10.10.8.3.3.3.1a" xref="S3.Ex11.m1.10.10.8.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex11.m1.10.10.8.3.3.3.4" xref="S3.Ex11.m1.10.10.8.3.3.3.4.cmml">t</mi></mrow></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex11.m1.10b"><apply id="S3.Ex11.m1.10.10.cmml" xref="S3.Ex11.m1.10.10"><and id="S3.Ex11.m1.10.10a.cmml" xref="S3.Ex11.m1.10.10"></and><apply id="S3.Ex11.m1.10.10b.cmml" xref="S3.Ex11.m1.10.10"><ci id="S3.Ex11.m1.10.10.6.cmml" xref="S3.Ex11.m1.10.10.6">→</ci><list id="S3.Ex11.m1.8.8.2.3.cmml" xref="S3.Ex11.m1.8.8.2.2"><apply id="S3.Ex11.m1.7.7.1.1.1.cmml" xref="S3.Ex11.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="S3.Ex11.m1.7.7.1.1.1.1.cmml" xref="S3.Ex11.m1.7.7.1.1.1">superscript</csymbol><ci id="S3.Ex11.m1.7.7.1.1.1.2.cmml" xref="S3.Ex11.m1.7.7.1.1.1.2">𝕩</ci><cn id="S3.Ex11.m1.1.1.1.1.cmml" type="integer" xref="S3.Ex11.m1.1.1.1.1">1</cn></apply><ci id="S3.Ex11.m1.5.5.cmml" xref="S3.Ex11.m1.5.5">…</ci><apply id="S3.Ex11.m1.8.8.2.2.2.cmml" xref="S3.Ex11.m1.8.8.2.2.2"><csymbol cd="ambiguous" id="S3.Ex11.m1.8.8.2.2.2.1.cmml" xref="S3.Ex11.m1.8.8.2.2.2">superscript</csymbol><ci id="S3.Ex11.m1.8.8.2.2.2.2.cmml" xref="S3.Ex11.m1.8.8.2.2.2.2">𝕩</ci><ci id="S3.Ex11.m1.2.2.1.1.cmml" xref="S3.Ex11.m1.2.2.1.1">𝑀</ci></apply></list><list id="S3.Ex11.m1.10.10.4.3.cmml" xref="S3.Ex11.m1.10.10.4.2"><apply id="S3.Ex11.m1.9.9.3.1.1.cmml" xref="S3.Ex11.m1.9.9.3.1.1"><times id="S3.Ex11.m1.9.9.3.1.1.2.cmml" xref="S3.Ex11.m1.9.9.3.1.1.2"></times><ci id="S3.Ex11.m1.9.9.3.1.1.3.cmml" xref="S3.Ex11.m1.9.9.3.1.1.3">𝑞</ci><apply id="S3.Ex11.m1.9.9.3.1.1.1.1.1.cmml" xref="S3.Ex11.m1.9.9.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex11.m1.9.9.3.1.1.1.1.1.1.cmml" xref="S3.Ex11.m1.9.9.3.1.1.1.1">superscript</csymbol><ci id="S3.Ex11.m1.9.9.3.1.1.1.1.1.2.cmml" xref="S3.Ex11.m1.9.9.3.1.1.1.1.1.2">𝕩</ci><cn id="S3.Ex11.m1.3.3.1.1.cmml" type="integer" xref="S3.Ex11.m1.3.3.1.1">1</cn></apply></apply><ci id="S3.Ex11.m1.6.6.cmml" xref="S3.Ex11.m1.6.6">…</ci><apply id="S3.Ex11.m1.10.10.4.2.2.cmml" xref="S3.Ex11.m1.10.10.4.2.2"><times id="S3.Ex11.m1.10.10.4.2.2.2.cmml" xref="S3.Ex11.m1.10.10.4.2.2.2"></times><ci id="S3.Ex11.m1.10.10.4.2.2.3.cmml" xref="S3.Ex11.m1.10.10.4.2.2.3">𝑞</ci><apply id="S3.Ex11.m1.10.10.4.2.2.1.1.1.cmml" xref="S3.Ex11.m1.10.10.4.2.2.1.1"><csymbol cd="ambiguous" id="S3.Ex11.m1.10.10.4.2.2.1.1.1.1.cmml" xref="S3.Ex11.m1.10.10.4.2.2.1.1">superscript</csymbol><ci id="S3.Ex11.m1.10.10.4.2.2.1.1.1.2.cmml" xref="S3.Ex11.m1.10.10.4.2.2.1.1.1.2">𝕩</ci><ci id="S3.Ex11.m1.4.4.1.1.cmml" xref="S3.Ex11.m1.4.4.1.1">𝑀</ci></apply></apply></list></apply><apply id="S3.Ex11.m1.10.10c.cmml" xref="S3.Ex11.m1.10.10"><in id="S3.Ex11.m1.10.10.7.cmml" xref="S3.Ex11.m1.10.10.7"></in><share href="https://arxiv.org/html/2407.10714v1#S3.Ex11.m1.10.10.4.cmml" id="S3.Ex11.m1.10.10d.cmml" xref="S3.Ex11.m1.10.10"></share><apply id="S3.Ex11.m1.10.10.8.cmml" xref="S3.Ex11.m1.10.10.8"><csymbol cd="ambiguous" id="S3.Ex11.m1.10.10.8.1.cmml" xref="S3.Ex11.m1.10.10.8">superscript</csymbol><ci id="S3.Ex11.m1.10.10.8.2.cmml" xref="S3.Ex11.m1.10.10.8.2">ℝ</ci><apply id="S3.Ex11.m1.10.10.8.3.cmml" xref="S3.Ex11.m1.10.10.8.3"><times id="S3.Ex11.m1.10.10.8.3.1.cmml" xref="S3.Ex11.m1.10.10.8.3.1"></times><ci id="S3.Ex11.m1.10.10.8.3.2.cmml" xref="S3.Ex11.m1.10.10.8.3.2">𝑀</ci><apply id="S3.Ex11.m1.10.10.8.3.3.cmml" xref="S3.Ex11.m1.10.10.8.3.3"><csymbol cd="ambiguous" id="S3.Ex11.m1.10.10.8.3.3.1.cmml" xref="S3.Ex11.m1.10.10.8.3.3">subscript</csymbol><ci id="S3.Ex11.m1.10.10.8.3.3.2.cmml" xref="S3.Ex11.m1.10.10.8.3.3.2">𝑁</ci><apply id="S3.Ex11.m1.10.10.8.3.3.3.cmml" xref="S3.Ex11.m1.10.10.8.3.3.3"><times id="S3.Ex11.m1.10.10.8.3.3.3.1.cmml" xref="S3.Ex11.m1.10.10.8.3.3.3.1"></times><ci id="S3.Ex11.m1.10.10.8.3.3.3.2.cmml" xref="S3.Ex11.m1.10.10.8.3.3.3.2">𝑏</ci><ci id="S3.Ex11.m1.10.10.8.3.3.3.3.cmml" xref="S3.Ex11.m1.10.10.8.3.3.3.3">𝑖</ci><ci id="S3.Ex11.m1.10.10.8.3.3.3.4.cmml" xref="S3.Ex11.m1.10.10.8.3.3.3.4">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex11.m1.10c">[{\mathbb{x}}^{(1)},...,{\mathbb{x}}^{(M)}]\rightarrow[q({\mathbb{x}}^{(1)}),.%
..,q({\mathbb{x}}^{(M)})]\in\mathbb{R}^{M\times N_{bit}}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex11.m1.10d">[ blackboard_x start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT , … , blackboard_x start_POSTSUPERSCRIPT ( italic_M ) end_POSTSUPERSCRIPT ] → [ italic_q ( blackboard_x start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ) , … , italic_q ( blackboard_x start_POSTSUPERSCRIPT ( italic_M ) end_POSTSUPERSCRIPT ) ] ∈ blackboard_R start_POSTSUPERSCRIPT italic_M × italic_N start_POSTSUBSCRIPT italic_b italic_i italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS3.p5.10">.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.p6">
<p class="ltx_p" id="S3.SS3.SSS3.p6.12">We pre-compute the inner product between different pairs of centroids and store the values in memory. The space complexity of the storage is <math alttext="O(M^{2}|\mathcal{C}|^{2}N_{bit})" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p6.1.m1.2"><semantics id="S3.SS3.SSS3.p6.1.m1.2a"><mrow id="S3.SS3.SSS3.p6.1.m1.2.2" xref="S3.SS3.SSS3.p6.1.m1.2.2.cmml"><mi id="S3.SS3.SSS3.p6.1.m1.2.2.3" xref="S3.SS3.SSS3.p6.1.m1.2.2.3.cmml">O</mi><mo id="S3.SS3.SSS3.p6.1.m1.2.2.2" xref="S3.SS3.SSS3.p6.1.m1.2.2.2.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p6.1.m1.2.2.1.1" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.cmml"><mo id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.2" stretchy="false" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.cmml"><msup id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.2" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.2.cmml"><mi id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.2.2" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.2.2.cmml">M</mi><mn id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.2.3" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.2.3.cmml">2</mn></msup><mo id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.1" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.1.cmml">⁢</mo><msup id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.3" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.3.cmml"><mrow id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.3.2.2" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.3.2.1.cmml"><mo id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.3.2.2.1" stretchy="false" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.3.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p6.1.m1.1.1" xref="S3.SS3.SSS3.p6.1.m1.1.1.cmml">𝒞</mi><mo id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.3.2.2.2" stretchy="false" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.3.2.1.1.cmml">|</mo></mrow><mn id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.3.3" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.3.3.cmml">2</mn></msup><mo id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.1a" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.1.cmml">⁢</mo><msub id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.cmml"><mi id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.2" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.2.cmml">N</mi><mrow id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3.cmml"><mi id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3.2" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3.2.cmml">b</mi><mo id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3.1" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3.3" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3.3.cmml">i</mi><mo id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3.1a" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3.4" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3.4.cmml">t</mi></mrow></msub></mrow><mo id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.3" stretchy="false" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p6.1.m1.2b"><apply id="S3.SS3.SSS3.p6.1.m1.2.2.cmml" xref="S3.SS3.SSS3.p6.1.m1.2.2"><times id="S3.SS3.SSS3.p6.1.m1.2.2.2.cmml" xref="S3.SS3.SSS3.p6.1.m1.2.2.2"></times><ci id="S3.SS3.SSS3.p6.1.m1.2.2.3.cmml" xref="S3.SS3.SSS3.p6.1.m1.2.2.3">𝑂</ci><apply id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1"><times id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.1"></times><apply id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.2">superscript</csymbol><ci id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.2.2">𝑀</ci><cn id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.2.3.cmml" type="integer" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.2.3">2</cn></apply><apply id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.3.1.cmml" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.3">superscript</csymbol><apply id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.3.2.1.cmml" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.3.2.2"><abs id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.3.2.1.1.cmml" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.3.2.2.1"></abs><ci id="S3.SS3.SSS3.p6.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p6.1.m1.1.1">𝒞</ci></apply><cn id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.3.3.cmml" type="integer" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.3.3">2</cn></apply><apply id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.cmml" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.1.cmml" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4">subscript</csymbol><ci id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.2.cmml" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.2">𝑁</ci><apply id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3.cmml" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3"><times id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3.1.cmml" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3.1"></times><ci id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3.2.cmml" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3.2">𝑏</ci><ci id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3.3.cmml" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3.3">𝑖</ci><ci id="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3.4.cmml" xref="S3.SS3.SSS3.p6.1.m1.2.2.1.1.1.4.3.4">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p6.1.m1.2c">O(M^{2}|\mathcal{C}|^{2}N_{bit})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p6.1.m1.2d">italic_O ( italic_M start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT | caligraphic_C | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_b italic_i italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="M" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p6.2.m2.1"><semantics id="S3.SS3.SSS3.p6.2.m2.1a"><mi id="S3.SS3.SSS3.p6.2.m2.1.1" xref="S3.SS3.SSS3.p6.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p6.2.m2.1b"><ci id="S3.SS3.SSS3.p6.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p6.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p6.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p6.2.m2.1d">italic_M</annotation></semantics></math> denotes the size of multi-modals, <math alttext="|\mathcal{C}|" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p6.3.m3.1"><semantics id="S3.SS3.SSS3.p6.3.m3.1a"><mrow id="S3.SS3.SSS3.p6.3.m3.1.2.2" xref="S3.SS3.SSS3.p6.3.m3.1.2.1.cmml"><mo id="S3.SS3.SSS3.p6.3.m3.1.2.2.1" stretchy="false" xref="S3.SS3.SSS3.p6.3.m3.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p6.3.m3.1.1" xref="S3.SS3.SSS3.p6.3.m3.1.1.cmml">𝒞</mi><mo id="S3.SS3.SSS3.p6.3.m3.1.2.2.2" stretchy="false" xref="S3.SS3.SSS3.p6.3.m3.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p6.3.m3.1b"><apply id="S3.SS3.SSS3.p6.3.m3.1.2.1.cmml" xref="S3.SS3.SSS3.p6.3.m3.1.2.2"><abs id="S3.SS3.SSS3.p6.3.m3.1.2.1.1.cmml" xref="S3.SS3.SSS3.p6.3.m3.1.2.2.1"></abs><ci id="S3.SS3.SSS3.p6.3.m3.1.1.cmml" xref="S3.SS3.SSS3.p6.3.m3.1.1">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p6.3.m3.1c">|\mathcal{C}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p6.3.m3.1d">| caligraphic_C |</annotation></semantics></math> denotes the number of centroids, and <math alttext="N_{bit}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p6.4.m4.1"><semantics id="S3.SS3.SSS3.p6.4.m4.1a"><msub id="S3.SS3.SSS3.p6.4.m4.1.1" xref="S3.SS3.SSS3.p6.4.m4.1.1.cmml"><mi id="S3.SS3.SSS3.p6.4.m4.1.1.2" xref="S3.SS3.SSS3.p6.4.m4.1.1.2.cmml">N</mi><mrow id="S3.SS3.SSS3.p6.4.m4.1.1.3" xref="S3.SS3.SSS3.p6.4.m4.1.1.3.cmml"><mi id="S3.SS3.SSS3.p6.4.m4.1.1.3.2" xref="S3.SS3.SSS3.p6.4.m4.1.1.3.2.cmml">b</mi><mo id="S3.SS3.SSS3.p6.4.m4.1.1.3.1" xref="S3.SS3.SSS3.p6.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p6.4.m4.1.1.3.3" xref="S3.SS3.SSS3.p6.4.m4.1.1.3.3.cmml">i</mi><mo id="S3.SS3.SSS3.p6.4.m4.1.1.3.1a" xref="S3.SS3.SSS3.p6.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p6.4.m4.1.1.3.4" xref="S3.SS3.SSS3.p6.4.m4.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p6.4.m4.1b"><apply id="S3.SS3.SSS3.p6.4.m4.1.1.cmml" xref="S3.SS3.SSS3.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p6.4.m4.1.1.1.cmml" xref="S3.SS3.SSS3.p6.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p6.4.m4.1.1.2.cmml" xref="S3.SS3.SSS3.p6.4.m4.1.1.2">𝑁</ci><apply id="S3.SS3.SSS3.p6.4.m4.1.1.3.cmml" xref="S3.SS3.SSS3.p6.4.m4.1.1.3"><times id="S3.SS3.SSS3.p6.4.m4.1.1.3.1.cmml" xref="S3.SS3.SSS3.p6.4.m4.1.1.3.1"></times><ci id="S3.SS3.SSS3.p6.4.m4.1.1.3.2.cmml" xref="S3.SS3.SSS3.p6.4.m4.1.1.3.2">𝑏</ci><ci id="S3.SS3.SSS3.p6.4.m4.1.1.3.3.cmml" xref="S3.SS3.SSS3.p6.4.m4.1.1.3.3">𝑖</ci><ci id="S3.SS3.SSS3.p6.4.m4.1.1.3.4.cmml" xref="S3.SS3.SSS3.p6.4.m4.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p6.4.m4.1c">N_{bit}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p6.4.m4.1d">italic_N start_POSTSUBSCRIPT italic_b italic_i italic_t end_POSTSUBSCRIPT</annotation></semantics></math> denotes the number of subvectors split in the codebook of modal <math alttext="m" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p6.5.m5.1"><semantics id="S3.SS3.SSS3.p6.5.m5.1a"><mi id="S3.SS3.SSS3.p6.5.m5.1.1" xref="S3.SS3.SSS3.p6.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p6.5.m5.1b"><ci id="S3.SS3.SSS3.p6.5.m5.1.1.cmml" xref="S3.SS3.SSS3.p6.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p6.5.m5.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p6.5.m5.1d">italic_m</annotation></semantics></math>. During online serving, the inner product
of <math alttext="{q_{t}}^{T}k_{l}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p6.6.m6.1"><semantics id="S3.SS3.SSS3.p6.6.m6.1a"><mrow id="S3.SS3.SSS3.p6.6.m6.1.1" xref="S3.SS3.SSS3.p6.6.m6.1.1.cmml"><mmultiscripts id="S3.SS3.SSS3.p6.6.m6.1.1.2" xref="S3.SS3.SSS3.p6.6.m6.1.1.2.cmml"><mi id="S3.SS3.SSS3.p6.6.m6.1.1.2.2.2" xref="S3.SS3.SSS3.p6.6.m6.1.1.2.2.2.cmml">q</mi><mi id="S3.SS3.SSS3.p6.6.m6.1.1.2.2.3" xref="S3.SS3.SSS3.p6.6.m6.1.1.2.2.3.cmml">t</mi><mrow id="S3.SS3.SSS3.p6.6.m6.1.1.2a" xref="S3.SS3.SSS3.p6.6.m6.1.1.2.cmml"></mrow><mrow id="S3.SS3.SSS3.p6.6.m6.1.1.2b" xref="S3.SS3.SSS3.p6.6.m6.1.1.2.cmml"></mrow><mi id="S3.SS3.SSS3.p6.6.m6.1.1.2.3" xref="S3.SS3.SSS3.p6.6.m6.1.1.2.3.cmml">T</mi></mmultiscripts><mo id="S3.SS3.SSS3.p6.6.m6.1.1.1" xref="S3.SS3.SSS3.p6.6.m6.1.1.1.cmml">⁢</mo><msub id="S3.SS3.SSS3.p6.6.m6.1.1.3" xref="S3.SS3.SSS3.p6.6.m6.1.1.3.cmml"><mi id="S3.SS3.SSS3.p6.6.m6.1.1.3.2" xref="S3.SS3.SSS3.p6.6.m6.1.1.3.2.cmml">k</mi><mi id="S3.SS3.SSS3.p6.6.m6.1.1.3.3" xref="S3.SS3.SSS3.p6.6.m6.1.1.3.3.cmml">l</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p6.6.m6.1b"><apply id="S3.SS3.SSS3.p6.6.m6.1.1.cmml" xref="S3.SS3.SSS3.p6.6.m6.1.1"><times id="S3.SS3.SSS3.p6.6.m6.1.1.1.cmml" xref="S3.SS3.SSS3.p6.6.m6.1.1.1"></times><apply id="S3.SS3.SSS3.p6.6.m6.1.1.2.cmml" xref="S3.SS3.SSS3.p6.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p6.6.m6.1.1.2.1.cmml" xref="S3.SS3.SSS3.p6.6.m6.1.1.2">superscript</csymbol><apply id="S3.SS3.SSS3.p6.6.m6.1.1.2.2.cmml" xref="S3.SS3.SSS3.p6.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p6.6.m6.1.1.2.2.1.cmml" xref="S3.SS3.SSS3.p6.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS3.p6.6.m6.1.1.2.2.2.cmml" xref="S3.SS3.SSS3.p6.6.m6.1.1.2.2.2">𝑞</ci><ci id="S3.SS3.SSS3.p6.6.m6.1.1.2.2.3.cmml" xref="S3.SS3.SSS3.p6.6.m6.1.1.2.2.3">𝑡</ci></apply><ci id="S3.SS3.SSS3.p6.6.m6.1.1.2.3.cmml" xref="S3.SS3.SSS3.p6.6.m6.1.1.2.3">𝑇</ci></apply><apply id="S3.SS3.SSS3.p6.6.m6.1.1.3.cmml" xref="S3.SS3.SSS3.p6.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p6.6.m6.1.1.3.1.cmml" xref="S3.SS3.SSS3.p6.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS3.p6.6.m6.1.1.3.2.cmml" xref="S3.SS3.SSS3.p6.6.m6.1.1.3.2">𝑘</ci><ci id="S3.SS3.SSS3.p6.6.m6.1.1.3.3.cmml" xref="S3.SS3.SSS3.p6.6.m6.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p6.6.m6.1c">{q_{t}}^{T}k_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p6.6.m6.1d">italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_k start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> is equivalent to <math alttext="O(M^{2}N_{bit})" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p6.7.m7.1"><semantics id="S3.SS3.SSS3.p6.7.m7.1a"><mrow id="S3.SS3.SSS3.p6.7.m7.1.1" xref="S3.SS3.SSS3.p6.7.m7.1.1.cmml"><mi id="S3.SS3.SSS3.p6.7.m7.1.1.3" xref="S3.SS3.SSS3.p6.7.m7.1.1.3.cmml">O</mi><mo id="S3.SS3.SSS3.p6.7.m7.1.1.2" xref="S3.SS3.SSS3.p6.7.m7.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p6.7.m7.1.1.1.1" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.cmml"><msup id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.2" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.2.cmml"><mi id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.2.2" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.2.2.cmml">M</mi><mn id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.2.3" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.2.3.cmml">2</mn></msup><mo id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.1" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.2" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.2.cmml">N</mi><mrow id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3.cmml"><mi id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3.2" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3.2.cmml">b</mi><mo id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3.1" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3.3" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3.3.cmml">i</mi><mo id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3.1a" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3.4" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3.4.cmml">t</mi></mrow></msub></mrow><mo id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p6.7.m7.1b"><apply id="S3.SS3.SSS3.p6.7.m7.1.1.cmml" xref="S3.SS3.SSS3.p6.7.m7.1.1"><times id="S3.SS3.SSS3.p6.7.m7.1.1.2.cmml" xref="S3.SS3.SSS3.p6.7.m7.1.1.2"></times><ci id="S3.SS3.SSS3.p6.7.m7.1.1.3.cmml" xref="S3.SS3.SSS3.p6.7.m7.1.1.3">𝑂</ci><apply id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1"><times id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.1"></times><apply id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.2.2">𝑀</ci><cn id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.2.3">2</cn></apply><apply id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.2">𝑁</ci><apply id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3"><times id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3.1.cmml" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3.1"></times><ci id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3.2.cmml" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3.2">𝑏</ci><ci id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3.3.cmml" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3.3">𝑖</ci><ci id="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3.4.cmml" xref="S3.SS3.SSS3.p6.7.m7.1.1.1.1.1.3.3.4">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p6.7.m7.1c">O(M^{2}N_{bit})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p6.7.m7.1d">italic_O ( italic_M start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_b italic_i italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> distance lookup operations, and the final score is calculated as the weighted sum of these distances. Here, <math alttext="c^{(i)}_{b}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p6.8.m8.1"><semantics id="S3.SS3.SSS3.p6.8.m8.1a"><msubsup id="S3.SS3.SSS3.p6.8.m8.1.2" xref="S3.SS3.SSS3.p6.8.m8.1.2.cmml"><mi id="S3.SS3.SSS3.p6.8.m8.1.2.2.2" xref="S3.SS3.SSS3.p6.8.m8.1.2.2.2.cmml">c</mi><mi id="S3.SS3.SSS3.p6.8.m8.1.2.3" xref="S3.SS3.SSS3.p6.8.m8.1.2.3.cmml">b</mi><mrow id="S3.SS3.SSS3.p6.8.m8.1.1.1.3" xref="S3.SS3.SSS3.p6.8.m8.1.2.cmml"><mo id="S3.SS3.SSS3.p6.8.m8.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS3.p6.8.m8.1.2.cmml">(</mo><mi id="S3.SS3.SSS3.p6.8.m8.1.1.1.1" xref="S3.SS3.SSS3.p6.8.m8.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS3.p6.8.m8.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS3.p6.8.m8.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p6.8.m8.1b"><apply id="S3.SS3.SSS3.p6.8.m8.1.2.cmml" xref="S3.SS3.SSS3.p6.8.m8.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p6.8.m8.1.2.1.cmml" xref="S3.SS3.SSS3.p6.8.m8.1.2">subscript</csymbol><apply id="S3.SS3.SSS3.p6.8.m8.1.2.2.cmml" xref="S3.SS3.SSS3.p6.8.m8.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p6.8.m8.1.2.2.1.cmml" xref="S3.SS3.SSS3.p6.8.m8.1.2">superscript</csymbol><ci id="S3.SS3.SSS3.p6.8.m8.1.2.2.2.cmml" xref="S3.SS3.SSS3.p6.8.m8.1.2.2.2">𝑐</ci><ci id="S3.SS3.SSS3.p6.8.m8.1.1.1.1.cmml" xref="S3.SS3.SSS3.p6.8.m8.1.1.1.1">𝑖</ci></apply><ci id="S3.SS3.SSS3.p6.8.m8.1.2.3.cmml" xref="S3.SS3.SSS3.p6.8.m8.1.2.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p6.8.m8.1c">c^{(i)}_{b}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p6.8.m8.1d">italic_c start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="c^{(j)}_{b}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p6.9.m9.1"><semantics id="S3.SS3.SSS3.p6.9.m9.1a"><msubsup id="S3.SS3.SSS3.p6.9.m9.1.2" xref="S3.SS3.SSS3.p6.9.m9.1.2.cmml"><mi id="S3.SS3.SSS3.p6.9.m9.1.2.2.2" xref="S3.SS3.SSS3.p6.9.m9.1.2.2.2.cmml">c</mi><mi id="S3.SS3.SSS3.p6.9.m9.1.2.3" xref="S3.SS3.SSS3.p6.9.m9.1.2.3.cmml">b</mi><mrow id="S3.SS3.SSS3.p6.9.m9.1.1.1.3" xref="S3.SS3.SSS3.p6.9.m9.1.2.cmml"><mo id="S3.SS3.SSS3.p6.9.m9.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS3.p6.9.m9.1.2.cmml">(</mo><mi id="S3.SS3.SSS3.p6.9.m9.1.1.1.1" xref="S3.SS3.SSS3.p6.9.m9.1.1.1.1.cmml">j</mi><mo id="S3.SS3.SSS3.p6.9.m9.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS3.p6.9.m9.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p6.9.m9.1b"><apply id="S3.SS3.SSS3.p6.9.m9.1.2.cmml" xref="S3.SS3.SSS3.p6.9.m9.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p6.9.m9.1.2.1.cmml" xref="S3.SS3.SSS3.p6.9.m9.1.2">subscript</csymbol><apply id="S3.SS3.SSS3.p6.9.m9.1.2.2.cmml" xref="S3.SS3.SSS3.p6.9.m9.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p6.9.m9.1.2.2.1.cmml" xref="S3.SS3.SSS3.p6.9.m9.1.2">superscript</csymbol><ci id="S3.SS3.SSS3.p6.9.m9.1.2.2.2.cmml" xref="S3.SS3.SSS3.p6.9.m9.1.2.2.2">𝑐</ci><ci id="S3.SS3.SSS3.p6.9.m9.1.1.1.1.cmml" xref="S3.SS3.SSS3.p6.9.m9.1.1.1.1">𝑗</ci></apply><ci id="S3.SS3.SSS3.p6.9.m9.1.2.3.cmml" xref="S3.SS3.SSS3.p6.9.m9.1.2.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p6.9.m9.1c">c^{(j)}_{b}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p6.9.m9.1d">italic_c start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> denotes the centroids IDs of the <math alttext="b" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p6.10.m10.1"><semantics id="S3.SS3.SSS3.p6.10.m10.1a"><mi id="S3.SS3.SSS3.p6.10.m10.1.1" xref="S3.SS3.SSS3.p6.10.m10.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p6.10.m10.1b"><ci id="S3.SS3.SSS3.p6.10.m10.1.1.cmml" xref="S3.SS3.SSS3.p6.10.m10.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p6.10.m10.1c">b</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p6.10.m10.1d">italic_b</annotation></semantics></math>-th subvector of <math alttext="\mathbb{x}^{(i)}_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p6.11.m11.1"><semantics id="S3.SS3.SSS3.p6.11.m11.1a"><msubsup id="S3.SS3.SSS3.p6.11.m11.1.2" xref="S3.SS3.SSS3.p6.11.m11.1.2.cmml"><mi id="S3.SS3.SSS3.p6.11.m11.1.2.2.2" xref="S3.SS3.SSS3.p6.11.m11.1.2.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS3.p6.11.m11.1.2.3" xref="S3.SS3.SSS3.p6.11.m11.1.2.3.cmml">t</mi><mrow id="S3.SS3.SSS3.p6.11.m11.1.1.1.3" xref="S3.SS3.SSS3.p6.11.m11.1.2.cmml"><mo id="S3.SS3.SSS3.p6.11.m11.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS3.p6.11.m11.1.2.cmml">(</mo><mi id="S3.SS3.SSS3.p6.11.m11.1.1.1.1" xref="S3.SS3.SSS3.p6.11.m11.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS3.p6.11.m11.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS3.p6.11.m11.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p6.11.m11.1b"><apply id="S3.SS3.SSS3.p6.11.m11.1.2.cmml" xref="S3.SS3.SSS3.p6.11.m11.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p6.11.m11.1.2.1.cmml" xref="S3.SS3.SSS3.p6.11.m11.1.2">subscript</csymbol><apply id="S3.SS3.SSS3.p6.11.m11.1.2.2.cmml" xref="S3.SS3.SSS3.p6.11.m11.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p6.11.m11.1.2.2.1.cmml" xref="S3.SS3.SSS3.p6.11.m11.1.2">superscript</csymbol><ci id="S3.SS3.SSS3.p6.11.m11.1.2.2.2.cmml" xref="S3.SS3.SSS3.p6.11.m11.1.2.2.2">𝕩</ci><ci id="S3.SS3.SSS3.p6.11.m11.1.1.1.1.cmml" xref="S3.SS3.SSS3.p6.11.m11.1.1.1.1">𝑖</ci></apply><ci id="S3.SS3.SSS3.p6.11.m11.1.2.3.cmml" xref="S3.SS3.SSS3.p6.11.m11.1.2.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p6.11.m11.1c">\mathbb{x}^{(i)}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p6.11.m11.1d">blackboard_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbb{x}^{(j)}_{l}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p6.12.m12.1"><semantics id="S3.SS3.SSS3.p6.12.m12.1a"><msubsup id="S3.SS3.SSS3.p6.12.m12.1.2" xref="S3.SS3.SSS3.p6.12.m12.1.2.cmml"><mi id="S3.SS3.SSS3.p6.12.m12.1.2.2.2" xref="S3.SS3.SSS3.p6.12.m12.1.2.2.2.cmml">𝕩</mi><mi id="S3.SS3.SSS3.p6.12.m12.1.2.3" xref="S3.SS3.SSS3.p6.12.m12.1.2.3.cmml">l</mi><mrow id="S3.SS3.SSS3.p6.12.m12.1.1.1.3" xref="S3.SS3.SSS3.p6.12.m12.1.2.cmml"><mo id="S3.SS3.SSS3.p6.12.m12.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS3.p6.12.m12.1.2.cmml">(</mo><mi id="S3.SS3.SSS3.p6.12.m12.1.1.1.1" xref="S3.SS3.SSS3.p6.12.m12.1.1.1.1.cmml">j</mi><mo id="S3.SS3.SSS3.p6.12.m12.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS3.p6.12.m12.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p6.12.m12.1b"><apply id="S3.SS3.SSS3.p6.12.m12.1.2.cmml" xref="S3.SS3.SSS3.p6.12.m12.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p6.12.m12.1.2.1.cmml" xref="S3.SS3.SSS3.p6.12.m12.1.2">subscript</csymbol><apply id="S3.SS3.SSS3.p6.12.m12.1.2.2.cmml" xref="S3.SS3.SSS3.p6.12.m12.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p6.12.m12.1.2.2.1.cmml" xref="S3.SS3.SSS3.p6.12.m12.1.2">superscript</csymbol><ci id="S3.SS3.SSS3.p6.12.m12.1.2.2.2.cmml" xref="S3.SS3.SSS3.p6.12.m12.1.2.2.2">𝕩</ci><ci id="S3.SS3.SSS3.p6.12.m12.1.1.1.1.cmml" xref="S3.SS3.SSS3.p6.12.m12.1.1.1.1">𝑗</ci></apply><ci id="S3.SS3.SSS3.p6.12.m12.1.2.3.cmml" xref="S3.SS3.SSS3.p6.12.m12.1.2.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p6.12.m12.1c">\mathbb{x}^{(j)}_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p6.12.m12.1d">blackboard_x start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> respectively.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.p7">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{q_{t}}^{T}k_{l}=\sum_{i}\sum_{j}\gamma_{i}\gamma_{j}\mathbb{x}^{(i)}_{t}%
\mathbb{x}^{(j)}_{l}\approx\sum_{i}\sum_{j}\gamma_{i}\gamma_{j}\sum_{b\in N_{%
bit}}\text{dist}(c^{(i)}_{b},c^{(j)}_{b})" class="ltx_Math" display="block" id="S3.Ex12.m1.6"><semantics id="S3.Ex12.m1.6a"><mrow id="S3.Ex12.m1.6.6" xref="S3.Ex12.m1.6.6.cmml"><mrow id="S3.Ex12.m1.6.6.4" xref="S3.Ex12.m1.6.6.4.cmml"><mmultiscripts id="S3.Ex12.m1.6.6.4.2" xref="S3.Ex12.m1.6.6.4.2.cmml"><mi id="S3.Ex12.m1.6.6.4.2.2.2" xref="S3.Ex12.m1.6.6.4.2.2.2.cmml">q</mi><mi id="S3.Ex12.m1.6.6.4.2.2.3" xref="S3.Ex12.m1.6.6.4.2.2.3.cmml">t</mi><mrow id="S3.Ex12.m1.6.6.4.2a" xref="S3.Ex12.m1.6.6.4.2.cmml"></mrow><mrow id="S3.Ex12.m1.6.6.4.2b" xref="S3.Ex12.m1.6.6.4.2.cmml"></mrow><mi id="S3.Ex12.m1.6.6.4.2.3" xref="S3.Ex12.m1.6.6.4.2.3.cmml">T</mi></mmultiscripts><mo id="S3.Ex12.m1.6.6.4.1" xref="S3.Ex12.m1.6.6.4.1.cmml">⁢</mo><msub id="S3.Ex12.m1.6.6.4.3" xref="S3.Ex12.m1.6.6.4.3.cmml"><mi id="S3.Ex12.m1.6.6.4.3.2" xref="S3.Ex12.m1.6.6.4.3.2.cmml">k</mi><mi id="S3.Ex12.m1.6.6.4.3.3" xref="S3.Ex12.m1.6.6.4.3.3.cmml">l</mi></msub></mrow><mo id="S3.Ex12.m1.6.6.5" rspace="0.111em" xref="S3.Ex12.m1.6.6.5.cmml">=</mo><mrow id="S3.Ex12.m1.6.6.6" xref="S3.Ex12.m1.6.6.6.cmml"><munder id="S3.Ex12.m1.6.6.6.1" xref="S3.Ex12.m1.6.6.6.1.cmml"><mo id="S3.Ex12.m1.6.6.6.1.2" movablelimits="false" rspace="0em" xref="S3.Ex12.m1.6.6.6.1.2.cmml">∑</mo><mi id="S3.Ex12.m1.6.6.6.1.3" xref="S3.Ex12.m1.6.6.6.1.3.cmml">i</mi></munder><mrow id="S3.Ex12.m1.6.6.6.2" xref="S3.Ex12.m1.6.6.6.2.cmml"><munder id="S3.Ex12.m1.6.6.6.2.1" xref="S3.Ex12.m1.6.6.6.2.1.cmml"><mo id="S3.Ex12.m1.6.6.6.2.1.2" movablelimits="false" xref="S3.Ex12.m1.6.6.6.2.1.2.cmml">∑</mo><mi id="S3.Ex12.m1.6.6.6.2.1.3" xref="S3.Ex12.m1.6.6.6.2.1.3.cmml">j</mi></munder><mrow id="S3.Ex12.m1.6.6.6.2.2" xref="S3.Ex12.m1.6.6.6.2.2.cmml"><msub id="S3.Ex12.m1.6.6.6.2.2.2" xref="S3.Ex12.m1.6.6.6.2.2.2.cmml"><mi id="S3.Ex12.m1.6.6.6.2.2.2.2" xref="S3.Ex12.m1.6.6.6.2.2.2.2.cmml">γ</mi><mi id="S3.Ex12.m1.6.6.6.2.2.2.3" xref="S3.Ex12.m1.6.6.6.2.2.2.3.cmml">i</mi></msub><mo id="S3.Ex12.m1.6.6.6.2.2.1" xref="S3.Ex12.m1.6.6.6.2.2.1.cmml">⁢</mo><msub id="S3.Ex12.m1.6.6.6.2.2.3" xref="S3.Ex12.m1.6.6.6.2.2.3.cmml"><mi id="S3.Ex12.m1.6.6.6.2.2.3.2" xref="S3.Ex12.m1.6.6.6.2.2.3.2.cmml">γ</mi><mi id="S3.Ex12.m1.6.6.6.2.2.3.3" xref="S3.Ex12.m1.6.6.6.2.2.3.3.cmml">j</mi></msub><mo id="S3.Ex12.m1.6.6.6.2.2.1a" xref="S3.Ex12.m1.6.6.6.2.2.1.cmml">⁢</mo><msubsup id="S3.Ex12.m1.6.6.6.2.2.4" xref="S3.Ex12.m1.6.6.6.2.2.4.cmml"><mi id="S3.Ex12.m1.6.6.6.2.2.4.2.2" xref="S3.Ex12.m1.6.6.6.2.2.4.2.2.cmml">𝕩</mi><mi id="S3.Ex12.m1.6.6.6.2.2.4.3" xref="S3.Ex12.m1.6.6.6.2.2.4.3.cmml">t</mi><mrow id="S3.Ex12.m1.1.1.1.3" xref="S3.Ex12.m1.6.6.6.2.2.4.cmml"><mo id="S3.Ex12.m1.1.1.1.3.1" stretchy="false" xref="S3.Ex12.m1.6.6.6.2.2.4.cmml">(</mo><mi id="S3.Ex12.m1.1.1.1.1" xref="S3.Ex12.m1.1.1.1.1.cmml">i</mi><mo id="S3.Ex12.m1.1.1.1.3.2" stretchy="false" xref="S3.Ex12.m1.6.6.6.2.2.4.cmml">)</mo></mrow></msubsup><mo id="S3.Ex12.m1.6.6.6.2.2.1b" xref="S3.Ex12.m1.6.6.6.2.2.1.cmml">⁢</mo><msubsup id="S3.Ex12.m1.6.6.6.2.2.5" xref="S3.Ex12.m1.6.6.6.2.2.5.cmml"><mi id="S3.Ex12.m1.6.6.6.2.2.5.2.2" xref="S3.Ex12.m1.6.6.6.2.2.5.2.2.cmml">𝕩</mi><mi id="S3.Ex12.m1.6.6.6.2.2.5.3" xref="S3.Ex12.m1.6.6.6.2.2.5.3.cmml">l</mi><mrow id="S3.Ex12.m1.2.2.1.3" xref="S3.Ex12.m1.6.6.6.2.2.5.cmml"><mo id="S3.Ex12.m1.2.2.1.3.1" stretchy="false" xref="S3.Ex12.m1.6.6.6.2.2.5.cmml">(</mo><mi id="S3.Ex12.m1.2.2.1.1" xref="S3.Ex12.m1.2.2.1.1.cmml">j</mi><mo id="S3.Ex12.m1.2.2.1.3.2" stretchy="false" xref="S3.Ex12.m1.6.6.6.2.2.5.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><mo id="S3.Ex12.m1.6.6.7" rspace="0.111em" xref="S3.Ex12.m1.6.6.7.cmml">≈</mo><mrow id="S3.Ex12.m1.6.6.2" xref="S3.Ex12.m1.6.6.2.cmml"><munder id="S3.Ex12.m1.6.6.2.3" xref="S3.Ex12.m1.6.6.2.3.cmml"><mo id="S3.Ex12.m1.6.6.2.3.2" movablelimits="false" rspace="0em" xref="S3.Ex12.m1.6.6.2.3.2.cmml">∑</mo><mi id="S3.Ex12.m1.6.6.2.3.3" xref="S3.Ex12.m1.6.6.2.3.3.cmml">i</mi></munder><mrow id="S3.Ex12.m1.6.6.2.2" xref="S3.Ex12.m1.6.6.2.2.cmml"><munder id="S3.Ex12.m1.6.6.2.2.3" xref="S3.Ex12.m1.6.6.2.2.3.cmml"><mo id="S3.Ex12.m1.6.6.2.2.3.2" movablelimits="false" xref="S3.Ex12.m1.6.6.2.2.3.2.cmml">∑</mo><mi id="S3.Ex12.m1.6.6.2.2.3.3" xref="S3.Ex12.m1.6.6.2.2.3.3.cmml">j</mi></munder><mrow id="S3.Ex12.m1.6.6.2.2.2" xref="S3.Ex12.m1.6.6.2.2.2.cmml"><msub id="S3.Ex12.m1.6.6.2.2.2.4" xref="S3.Ex12.m1.6.6.2.2.2.4.cmml"><mi id="S3.Ex12.m1.6.6.2.2.2.4.2" xref="S3.Ex12.m1.6.6.2.2.2.4.2.cmml">γ</mi><mi id="S3.Ex12.m1.6.6.2.2.2.4.3" xref="S3.Ex12.m1.6.6.2.2.2.4.3.cmml">i</mi></msub><mo id="S3.Ex12.m1.6.6.2.2.2.3" xref="S3.Ex12.m1.6.6.2.2.2.3.cmml">⁢</mo><msub id="S3.Ex12.m1.6.6.2.2.2.5" xref="S3.Ex12.m1.6.6.2.2.2.5.cmml"><mi id="S3.Ex12.m1.6.6.2.2.2.5.2" xref="S3.Ex12.m1.6.6.2.2.2.5.2.cmml">γ</mi><mi id="S3.Ex12.m1.6.6.2.2.2.5.3" xref="S3.Ex12.m1.6.6.2.2.2.5.3.cmml">j</mi></msub><mo id="S3.Ex12.m1.6.6.2.2.2.3a" xref="S3.Ex12.m1.6.6.2.2.2.3.cmml">⁢</mo><mrow id="S3.Ex12.m1.6.6.2.2.2.2" xref="S3.Ex12.m1.6.6.2.2.2.2.cmml"><munder id="S3.Ex12.m1.6.6.2.2.2.2.3" xref="S3.Ex12.m1.6.6.2.2.2.2.3.cmml"><mo id="S3.Ex12.m1.6.6.2.2.2.2.3.2" movablelimits="false" xref="S3.Ex12.m1.6.6.2.2.2.2.3.2.cmml">∑</mo><mrow id="S3.Ex12.m1.6.6.2.2.2.2.3.3" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.cmml"><mi id="S3.Ex12.m1.6.6.2.2.2.2.3.3.2" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.2.cmml">b</mi><mo id="S3.Ex12.m1.6.6.2.2.2.2.3.3.1" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.1.cmml">∈</mo><msub id="S3.Ex12.m1.6.6.2.2.2.2.3.3.3" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.cmml"><mi id="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.2" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.2.cmml">N</mi><mrow id="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3.cmml"><mi id="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3.2" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3.2.cmml">b</mi><mo id="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3.1" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3.3" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3.3.cmml">i</mi><mo id="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3.1a" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3.4" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3.4.cmml">t</mi></mrow></msub></mrow></munder><mrow id="S3.Ex12.m1.6.6.2.2.2.2.2" xref="S3.Ex12.m1.6.6.2.2.2.2.2.cmml"><mtext id="S3.Ex12.m1.6.6.2.2.2.2.2.4" xref="S3.Ex12.m1.6.6.2.2.2.2.2.4a.cmml">dist</mtext><mo id="S3.Ex12.m1.6.6.2.2.2.2.2.3" xref="S3.Ex12.m1.6.6.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.Ex12.m1.6.6.2.2.2.2.2.2.2" xref="S3.Ex12.m1.6.6.2.2.2.2.2.2.3.cmml"><mo id="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.3" stretchy="false" xref="S3.Ex12.m1.6.6.2.2.2.2.2.2.3.cmml">(</mo><msubsup id="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml">c</mi><mi id="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">b</mi><mrow id="S3.Ex12.m1.3.3.1.3" xref="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex12.m1.3.3.1.3.1" stretchy="false" xref="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex12.m1.3.3.1.1" xref="S3.Ex12.m1.3.3.1.1.cmml">i</mi><mo id="S3.Ex12.m1.3.3.1.3.2" stretchy="false" xref="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.4" xref="S3.Ex12.m1.6.6.2.2.2.2.2.2.3.cmml">,</mo><msubsup id="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2" xref="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2.cmml"><mi id="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2.2.2" xref="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2.2.2.cmml">c</mi><mi id="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2.3" xref="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2.3.cmml">b</mi><mrow id="S3.Ex12.m1.4.4.1.3" xref="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2.cmml"><mo id="S3.Ex12.m1.4.4.1.3.1" stretchy="false" xref="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2.cmml">(</mo><mi id="S3.Ex12.m1.4.4.1.1" xref="S3.Ex12.m1.4.4.1.1.cmml">j</mi><mo id="S3.Ex12.m1.4.4.1.3.2" stretchy="false" xref="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.5" stretchy="false" xref="S3.Ex12.m1.6.6.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex12.m1.6b"><apply id="S3.Ex12.m1.6.6.cmml" xref="S3.Ex12.m1.6.6"><and id="S3.Ex12.m1.6.6a.cmml" xref="S3.Ex12.m1.6.6"></and><apply id="S3.Ex12.m1.6.6b.cmml" xref="S3.Ex12.m1.6.6"><eq id="S3.Ex12.m1.6.6.5.cmml" xref="S3.Ex12.m1.6.6.5"></eq><apply id="S3.Ex12.m1.6.6.4.cmml" xref="S3.Ex12.m1.6.6.4"><times id="S3.Ex12.m1.6.6.4.1.cmml" xref="S3.Ex12.m1.6.6.4.1"></times><apply id="S3.Ex12.m1.6.6.4.2.cmml" xref="S3.Ex12.m1.6.6.4.2"><csymbol cd="ambiguous" id="S3.Ex12.m1.6.6.4.2.1.cmml" xref="S3.Ex12.m1.6.6.4.2">superscript</csymbol><apply id="S3.Ex12.m1.6.6.4.2.2.cmml" xref="S3.Ex12.m1.6.6.4.2"><csymbol cd="ambiguous" id="S3.Ex12.m1.6.6.4.2.2.1.cmml" xref="S3.Ex12.m1.6.6.4.2">subscript</csymbol><ci id="S3.Ex12.m1.6.6.4.2.2.2.cmml" xref="S3.Ex12.m1.6.6.4.2.2.2">𝑞</ci><ci id="S3.Ex12.m1.6.6.4.2.2.3.cmml" xref="S3.Ex12.m1.6.6.4.2.2.3">𝑡</ci></apply><ci id="S3.Ex12.m1.6.6.4.2.3.cmml" xref="S3.Ex12.m1.6.6.4.2.3">𝑇</ci></apply><apply id="S3.Ex12.m1.6.6.4.3.cmml" xref="S3.Ex12.m1.6.6.4.3"><csymbol cd="ambiguous" id="S3.Ex12.m1.6.6.4.3.1.cmml" xref="S3.Ex12.m1.6.6.4.3">subscript</csymbol><ci id="S3.Ex12.m1.6.6.4.3.2.cmml" xref="S3.Ex12.m1.6.6.4.3.2">𝑘</ci><ci id="S3.Ex12.m1.6.6.4.3.3.cmml" xref="S3.Ex12.m1.6.6.4.3.3">𝑙</ci></apply></apply><apply id="S3.Ex12.m1.6.6.6.cmml" xref="S3.Ex12.m1.6.6.6"><apply id="S3.Ex12.m1.6.6.6.1.cmml" xref="S3.Ex12.m1.6.6.6.1"><csymbol cd="ambiguous" id="S3.Ex12.m1.6.6.6.1.1.cmml" xref="S3.Ex12.m1.6.6.6.1">subscript</csymbol><sum id="S3.Ex12.m1.6.6.6.1.2.cmml" xref="S3.Ex12.m1.6.6.6.1.2"></sum><ci id="S3.Ex12.m1.6.6.6.1.3.cmml" xref="S3.Ex12.m1.6.6.6.1.3">𝑖</ci></apply><apply id="S3.Ex12.m1.6.6.6.2.cmml" xref="S3.Ex12.m1.6.6.6.2"><apply id="S3.Ex12.m1.6.6.6.2.1.cmml" xref="S3.Ex12.m1.6.6.6.2.1"><csymbol cd="ambiguous" id="S3.Ex12.m1.6.6.6.2.1.1.cmml" xref="S3.Ex12.m1.6.6.6.2.1">subscript</csymbol><sum id="S3.Ex12.m1.6.6.6.2.1.2.cmml" xref="S3.Ex12.m1.6.6.6.2.1.2"></sum><ci id="S3.Ex12.m1.6.6.6.2.1.3.cmml" xref="S3.Ex12.m1.6.6.6.2.1.3">𝑗</ci></apply><apply id="S3.Ex12.m1.6.6.6.2.2.cmml" xref="S3.Ex12.m1.6.6.6.2.2"><times id="S3.Ex12.m1.6.6.6.2.2.1.cmml" xref="S3.Ex12.m1.6.6.6.2.2.1"></times><apply id="S3.Ex12.m1.6.6.6.2.2.2.cmml" xref="S3.Ex12.m1.6.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.Ex12.m1.6.6.6.2.2.2.1.cmml" xref="S3.Ex12.m1.6.6.6.2.2.2">subscript</csymbol><ci id="S3.Ex12.m1.6.6.6.2.2.2.2.cmml" xref="S3.Ex12.m1.6.6.6.2.2.2.2">𝛾</ci><ci id="S3.Ex12.m1.6.6.6.2.2.2.3.cmml" xref="S3.Ex12.m1.6.6.6.2.2.2.3">𝑖</ci></apply><apply id="S3.Ex12.m1.6.6.6.2.2.3.cmml" xref="S3.Ex12.m1.6.6.6.2.2.3"><csymbol cd="ambiguous" id="S3.Ex12.m1.6.6.6.2.2.3.1.cmml" xref="S3.Ex12.m1.6.6.6.2.2.3">subscript</csymbol><ci id="S3.Ex12.m1.6.6.6.2.2.3.2.cmml" xref="S3.Ex12.m1.6.6.6.2.2.3.2">𝛾</ci><ci id="S3.Ex12.m1.6.6.6.2.2.3.3.cmml" xref="S3.Ex12.m1.6.6.6.2.2.3.3">𝑗</ci></apply><apply id="S3.Ex12.m1.6.6.6.2.2.4.cmml" xref="S3.Ex12.m1.6.6.6.2.2.4"><csymbol cd="ambiguous" id="S3.Ex12.m1.6.6.6.2.2.4.1.cmml" xref="S3.Ex12.m1.6.6.6.2.2.4">subscript</csymbol><apply id="S3.Ex12.m1.6.6.6.2.2.4.2.cmml" xref="S3.Ex12.m1.6.6.6.2.2.4"><csymbol cd="ambiguous" id="S3.Ex12.m1.6.6.6.2.2.4.2.1.cmml" xref="S3.Ex12.m1.6.6.6.2.2.4">superscript</csymbol><ci id="S3.Ex12.m1.6.6.6.2.2.4.2.2.cmml" xref="S3.Ex12.m1.6.6.6.2.2.4.2.2">𝕩</ci><ci id="S3.Ex12.m1.1.1.1.1.cmml" xref="S3.Ex12.m1.1.1.1.1">𝑖</ci></apply><ci id="S3.Ex12.m1.6.6.6.2.2.4.3.cmml" xref="S3.Ex12.m1.6.6.6.2.2.4.3">𝑡</ci></apply><apply id="S3.Ex12.m1.6.6.6.2.2.5.cmml" xref="S3.Ex12.m1.6.6.6.2.2.5"><csymbol cd="ambiguous" id="S3.Ex12.m1.6.6.6.2.2.5.1.cmml" xref="S3.Ex12.m1.6.6.6.2.2.5">subscript</csymbol><apply id="S3.Ex12.m1.6.6.6.2.2.5.2.cmml" xref="S3.Ex12.m1.6.6.6.2.2.5"><csymbol cd="ambiguous" id="S3.Ex12.m1.6.6.6.2.2.5.2.1.cmml" xref="S3.Ex12.m1.6.6.6.2.2.5">superscript</csymbol><ci id="S3.Ex12.m1.6.6.6.2.2.5.2.2.cmml" xref="S3.Ex12.m1.6.6.6.2.2.5.2.2">𝕩</ci><ci id="S3.Ex12.m1.2.2.1.1.cmml" xref="S3.Ex12.m1.2.2.1.1">𝑗</ci></apply><ci id="S3.Ex12.m1.6.6.6.2.2.5.3.cmml" xref="S3.Ex12.m1.6.6.6.2.2.5.3">𝑙</ci></apply></apply></apply></apply></apply><apply id="S3.Ex12.m1.6.6c.cmml" xref="S3.Ex12.m1.6.6"><approx id="S3.Ex12.m1.6.6.7.cmml" xref="S3.Ex12.m1.6.6.7"></approx><share href="https://arxiv.org/html/2407.10714v1#S3.Ex12.m1.6.6.6.cmml" id="S3.Ex12.m1.6.6d.cmml" xref="S3.Ex12.m1.6.6"></share><apply id="S3.Ex12.m1.6.6.2.cmml" xref="S3.Ex12.m1.6.6.2"><apply id="S3.Ex12.m1.6.6.2.3.cmml" xref="S3.Ex12.m1.6.6.2.3"><csymbol cd="ambiguous" id="S3.Ex12.m1.6.6.2.3.1.cmml" xref="S3.Ex12.m1.6.6.2.3">subscript</csymbol><sum id="S3.Ex12.m1.6.6.2.3.2.cmml" xref="S3.Ex12.m1.6.6.2.3.2"></sum><ci id="S3.Ex12.m1.6.6.2.3.3.cmml" xref="S3.Ex12.m1.6.6.2.3.3">𝑖</ci></apply><apply id="S3.Ex12.m1.6.6.2.2.cmml" xref="S3.Ex12.m1.6.6.2.2"><apply id="S3.Ex12.m1.6.6.2.2.3.cmml" xref="S3.Ex12.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="S3.Ex12.m1.6.6.2.2.3.1.cmml" xref="S3.Ex12.m1.6.6.2.2.3">subscript</csymbol><sum id="S3.Ex12.m1.6.6.2.2.3.2.cmml" xref="S3.Ex12.m1.6.6.2.2.3.2"></sum><ci id="S3.Ex12.m1.6.6.2.2.3.3.cmml" xref="S3.Ex12.m1.6.6.2.2.3.3">𝑗</ci></apply><apply id="S3.Ex12.m1.6.6.2.2.2.cmml" xref="S3.Ex12.m1.6.6.2.2.2"><times id="S3.Ex12.m1.6.6.2.2.2.3.cmml" xref="S3.Ex12.m1.6.6.2.2.2.3"></times><apply id="S3.Ex12.m1.6.6.2.2.2.4.cmml" xref="S3.Ex12.m1.6.6.2.2.2.4"><csymbol cd="ambiguous" id="S3.Ex12.m1.6.6.2.2.2.4.1.cmml" xref="S3.Ex12.m1.6.6.2.2.2.4">subscript</csymbol><ci id="S3.Ex12.m1.6.6.2.2.2.4.2.cmml" xref="S3.Ex12.m1.6.6.2.2.2.4.2">𝛾</ci><ci id="S3.Ex12.m1.6.6.2.2.2.4.3.cmml" xref="S3.Ex12.m1.6.6.2.2.2.4.3">𝑖</ci></apply><apply id="S3.Ex12.m1.6.6.2.2.2.5.cmml" xref="S3.Ex12.m1.6.6.2.2.2.5"><csymbol cd="ambiguous" id="S3.Ex12.m1.6.6.2.2.2.5.1.cmml" xref="S3.Ex12.m1.6.6.2.2.2.5">subscript</csymbol><ci id="S3.Ex12.m1.6.6.2.2.2.5.2.cmml" xref="S3.Ex12.m1.6.6.2.2.2.5.2">𝛾</ci><ci id="S3.Ex12.m1.6.6.2.2.2.5.3.cmml" xref="S3.Ex12.m1.6.6.2.2.2.5.3">𝑗</ci></apply><apply id="S3.Ex12.m1.6.6.2.2.2.2.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2"><apply id="S3.Ex12.m1.6.6.2.2.2.2.3.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex12.m1.6.6.2.2.2.2.3.1.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.3">subscript</csymbol><sum id="S3.Ex12.m1.6.6.2.2.2.2.3.2.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.3.2"></sum><apply id="S3.Ex12.m1.6.6.2.2.2.2.3.3.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3"><in id="S3.Ex12.m1.6.6.2.2.2.2.3.3.1.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.1"></in><ci id="S3.Ex12.m1.6.6.2.2.2.2.3.3.2.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.2">𝑏</ci><apply id="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.1.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.3">subscript</csymbol><ci id="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.2.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.2">𝑁</ci><apply id="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3"><times id="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3.1.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3.1"></times><ci id="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3.2.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3.2">𝑏</ci><ci id="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3.3.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3.3">𝑖</ci><ci id="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3.4.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.3.3.3.3.4">𝑡</ci></apply></apply></apply></apply><apply id="S3.Ex12.m1.6.6.2.2.2.2.2.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.2"><times id="S3.Ex12.m1.6.6.2.2.2.2.2.3.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.2.3"></times><ci id="S3.Ex12.m1.6.6.2.2.2.2.2.4a.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.2.4"><mtext id="S3.Ex12.m1.6.6.2.2.2.2.2.4.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.2.4">dist</mtext></ci><interval closure="open" id="S3.Ex12.m1.6.6.2.2.2.2.2.2.3.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.2.2.2"><apply id="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1.2.2">𝑐</ci><ci id="S3.Ex12.m1.3.3.1.1.cmml" xref="S3.Ex12.m1.3.3.1.1">𝑖</ci></apply><ci id="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex12.m1.5.5.1.1.1.1.1.1.1.1.3">𝑏</ci></apply><apply id="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2.1.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2">subscript</csymbol><apply id="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2.2.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2">superscript</csymbol><ci id="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2.2.2">𝑐</ci><ci id="S3.Ex12.m1.4.4.1.1.cmml" xref="S3.Ex12.m1.4.4.1.1">𝑗</ci></apply><ci id="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2.3.cmml" xref="S3.Ex12.m1.6.6.2.2.2.2.2.2.2.2.3">𝑏</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex12.m1.6c">{q_{t}}^{T}k_{l}=\sum_{i}\sum_{j}\gamma_{i}\gamma_{j}\mathbb{x}^{(i)}_{t}%
\mathbb{x}^{(j)}_{l}\approx\sum_{i}\sum_{j}\gamma_{i}\gamma_{j}\sum_{b\in N_{%
bit}}\text{dist}(c^{(i)}_{b},c^{(j)}_{b})</annotation><annotation encoding="application/x-llamapun" id="S3.Ex12.m1.6d">italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_k start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_γ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_γ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT blackboard_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT blackboard_x start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ≈ ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_γ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_γ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_b ∈ italic_N start_POSTSUBSCRIPT italic_b italic_i italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT dist ( italic_c start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT , italic_c start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.p8">
<p class="ltx_p" id="S3.SS3.SSS3.p8.10">Our proposed multi-modal product quantization strategy works quite well in real-world settings. We also compare the time complexity of different strategies, such as cascading ANN (HNSW), Locality-sensitive hashing (LSH) and our proposed Multi-Modal Product Quantization approximation. Our proposed multi-modal PQ method has the time complexity of <math alttext="O(L\times M^{2}\times N_{bit})" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p8.1.m1.1"><semantics id="S3.SS3.SSS3.p8.1.m1.1a"><mrow id="S3.SS3.SSS3.p8.1.m1.1.1" xref="S3.SS3.SSS3.p8.1.m1.1.1.cmml"><mi id="S3.SS3.SSS3.p8.1.m1.1.1.3" xref="S3.SS3.SSS3.p8.1.m1.1.1.3.cmml">O</mi><mo id="S3.SS3.SSS3.p8.1.m1.1.1.2" xref="S3.SS3.SSS3.p8.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p8.1.m1.1.1.1.1" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.2" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.2.cmml">L</mi><mo id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.1.cmml">×</mo><msup id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.3" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.3.2" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.3.2.cmml">M</mi><mn id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.3.3" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.3.3.cmml">2</mn></msup><mo id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.1.cmml">×</mo><msub id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.cmml"><mi id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.2" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.2.cmml">N</mi><mrow id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3.cmml"><mi id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3.2" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3.2.cmml">b</mi><mo id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3.1" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3.3" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3.3.cmml">i</mi><mo id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3.1a" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3.4" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3.4.cmml">t</mi></mrow></msub></mrow><mo id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p8.1.m1.1b"><apply id="S3.SS3.SSS3.p8.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p8.1.m1.1.1"><times id="S3.SS3.SSS3.p8.1.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p8.1.m1.1.1.2"></times><ci id="S3.SS3.SSS3.p8.1.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p8.1.m1.1.1.3">𝑂</ci><apply id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1"><times id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.1"></times><ci id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.2">𝐿</ci><apply id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.3.2">𝑀</ci><cn id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.3.3">2</cn></apply><apply id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.cmml" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.1.cmml" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.2.cmml" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.2">𝑁</ci><apply id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3.cmml" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3"><times id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3.1.cmml" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3.1"></times><ci id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3.2.cmml" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3.2">𝑏</ci><ci id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3.3.cmml" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3.3">𝑖</ci><ci id="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3.4.cmml" xref="S3.SS3.SSS3.p8.1.m1.1.1.1.1.1.4.3.4">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p8.1.m1.1c">O(L\times M^{2}\times N_{bit})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p8.1.m1.1d">italic_O ( italic_L × italic_M start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × italic_N start_POSTSUBSCRIPT italic_b italic_i italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>. In each attention calculation, there are <math alttext="M^{2}N_{bit}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p8.2.m2.1"><semantics id="S3.SS3.SSS3.p8.2.m2.1a"><mrow id="S3.SS3.SSS3.p8.2.m2.1.1" xref="S3.SS3.SSS3.p8.2.m2.1.1.cmml"><msup id="S3.SS3.SSS3.p8.2.m2.1.1.2" xref="S3.SS3.SSS3.p8.2.m2.1.1.2.cmml"><mi id="S3.SS3.SSS3.p8.2.m2.1.1.2.2" xref="S3.SS3.SSS3.p8.2.m2.1.1.2.2.cmml">M</mi><mn id="S3.SS3.SSS3.p8.2.m2.1.1.2.3" xref="S3.SS3.SSS3.p8.2.m2.1.1.2.3.cmml">2</mn></msup><mo id="S3.SS3.SSS3.p8.2.m2.1.1.1" xref="S3.SS3.SSS3.p8.2.m2.1.1.1.cmml">⁢</mo><msub id="S3.SS3.SSS3.p8.2.m2.1.1.3" xref="S3.SS3.SSS3.p8.2.m2.1.1.3.cmml"><mi id="S3.SS3.SSS3.p8.2.m2.1.1.3.2" xref="S3.SS3.SSS3.p8.2.m2.1.1.3.2.cmml">N</mi><mrow id="S3.SS3.SSS3.p8.2.m2.1.1.3.3" xref="S3.SS3.SSS3.p8.2.m2.1.1.3.3.cmml"><mi id="S3.SS3.SSS3.p8.2.m2.1.1.3.3.2" xref="S3.SS3.SSS3.p8.2.m2.1.1.3.3.2.cmml">b</mi><mo id="S3.SS3.SSS3.p8.2.m2.1.1.3.3.1" xref="S3.SS3.SSS3.p8.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p8.2.m2.1.1.3.3.3" xref="S3.SS3.SSS3.p8.2.m2.1.1.3.3.3.cmml">i</mi><mo id="S3.SS3.SSS3.p8.2.m2.1.1.3.3.1a" xref="S3.SS3.SSS3.p8.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p8.2.m2.1.1.3.3.4" xref="S3.SS3.SSS3.p8.2.m2.1.1.3.3.4.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p8.2.m2.1b"><apply id="S3.SS3.SSS3.p8.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p8.2.m2.1.1"><times id="S3.SS3.SSS3.p8.2.m2.1.1.1.cmml" xref="S3.SS3.SSS3.p8.2.m2.1.1.1"></times><apply id="S3.SS3.SSS3.p8.2.m2.1.1.2.cmml" xref="S3.SS3.SSS3.p8.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p8.2.m2.1.1.2.1.cmml" xref="S3.SS3.SSS3.p8.2.m2.1.1.2">superscript</csymbol><ci id="S3.SS3.SSS3.p8.2.m2.1.1.2.2.cmml" xref="S3.SS3.SSS3.p8.2.m2.1.1.2.2">𝑀</ci><cn id="S3.SS3.SSS3.p8.2.m2.1.1.2.3.cmml" type="integer" xref="S3.SS3.SSS3.p8.2.m2.1.1.2.3">2</cn></apply><apply id="S3.SS3.SSS3.p8.2.m2.1.1.3.cmml" xref="S3.SS3.SSS3.p8.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p8.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS3.p8.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS3.p8.2.m2.1.1.3.2.cmml" xref="S3.SS3.SSS3.p8.2.m2.1.1.3.2">𝑁</ci><apply id="S3.SS3.SSS3.p8.2.m2.1.1.3.3.cmml" xref="S3.SS3.SSS3.p8.2.m2.1.1.3.3"><times id="S3.SS3.SSS3.p8.2.m2.1.1.3.3.1.cmml" xref="S3.SS3.SSS3.p8.2.m2.1.1.3.3.1"></times><ci id="S3.SS3.SSS3.p8.2.m2.1.1.3.3.2.cmml" xref="S3.SS3.SSS3.p8.2.m2.1.1.3.3.2">𝑏</ci><ci id="S3.SS3.SSS3.p8.2.m2.1.1.3.3.3.cmml" xref="S3.SS3.SSS3.p8.2.m2.1.1.3.3.3">𝑖</ci><ci id="S3.SS3.SSS3.p8.2.m2.1.1.3.3.4.cmml" xref="S3.SS3.SSS3.p8.2.m2.1.1.3.3.4">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p8.2.m2.1c">M^{2}N_{bit}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p8.2.m2.1d">italic_M start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_b italic_i italic_t end_POSTSUBSCRIPT</annotation></semantics></math> distance look-up operations of <math alttext="O(1)" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p8.3.m3.1"><semantics id="S3.SS3.SSS3.p8.3.m3.1a"><mrow id="S3.SS3.SSS3.p8.3.m3.1.2" xref="S3.SS3.SSS3.p8.3.m3.1.2.cmml"><mi id="S3.SS3.SSS3.p8.3.m3.1.2.2" xref="S3.SS3.SSS3.p8.3.m3.1.2.2.cmml">O</mi><mo id="S3.SS3.SSS3.p8.3.m3.1.2.1" xref="S3.SS3.SSS3.p8.3.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p8.3.m3.1.2.3.2" xref="S3.SS3.SSS3.p8.3.m3.1.2.cmml"><mo id="S3.SS3.SSS3.p8.3.m3.1.2.3.2.1" stretchy="false" xref="S3.SS3.SSS3.p8.3.m3.1.2.cmml">(</mo><mn id="S3.SS3.SSS3.p8.3.m3.1.1" xref="S3.SS3.SSS3.p8.3.m3.1.1.cmml">1</mn><mo id="S3.SS3.SSS3.p8.3.m3.1.2.3.2.2" stretchy="false" xref="S3.SS3.SSS3.p8.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p8.3.m3.1b"><apply id="S3.SS3.SSS3.p8.3.m3.1.2.cmml" xref="S3.SS3.SSS3.p8.3.m3.1.2"><times id="S3.SS3.SSS3.p8.3.m3.1.2.1.cmml" xref="S3.SS3.SSS3.p8.3.m3.1.2.1"></times><ci id="S3.SS3.SSS3.p8.3.m3.1.2.2.cmml" xref="S3.SS3.SSS3.p8.3.m3.1.2.2">𝑂</ci><cn id="S3.SS3.SSS3.p8.3.m3.1.1.cmml" type="integer" xref="S3.SS3.SSS3.p8.3.m3.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p8.3.m3.1c">O(1)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p8.3.m3.1d">italic_O ( 1 )</annotation></semantics></math>, and the final score is calculated as the sum of these distances, which is far less than the exact calculation of the inner product of multiple vectors <math alttext="O(L\times M\times d)" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p8.4.m4.1"><semantics id="S3.SS3.SSS3.p8.4.m4.1a"><mrow id="S3.SS3.SSS3.p8.4.m4.1.1" xref="S3.SS3.SSS3.p8.4.m4.1.1.cmml"><mi id="S3.SS3.SSS3.p8.4.m4.1.1.3" xref="S3.SS3.SSS3.p8.4.m4.1.1.3.cmml">O</mi><mo id="S3.SS3.SSS3.p8.4.m4.1.1.2" xref="S3.SS3.SSS3.p8.4.m4.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p8.4.m4.1.1.1.1" xref="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS3.p8.4.m4.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1" xref="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.2" xref="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.2.cmml">L</mi><mo id="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.1.cmml">×</mo><mi id="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.3" xref="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.3.cmml">M</mi><mo id="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.1.cmml">×</mo><mi id="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.4" xref="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.4.cmml">d</mi></mrow><mo id="S3.SS3.SSS3.p8.4.m4.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p8.4.m4.1b"><apply id="S3.SS3.SSS3.p8.4.m4.1.1.cmml" xref="S3.SS3.SSS3.p8.4.m4.1.1"><times id="S3.SS3.SSS3.p8.4.m4.1.1.2.cmml" xref="S3.SS3.SSS3.p8.4.m4.1.1.2"></times><ci id="S3.SS3.SSS3.p8.4.m4.1.1.3.cmml" xref="S3.SS3.SSS3.p8.4.m4.1.1.3">𝑂</ci><apply id="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p8.4.m4.1.1.1.1"><times id="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.1"></times><ci id="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.2">𝐿</ci><ci id="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.3">𝑀</ci><ci id="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.4.cmml" xref="S3.SS3.SSS3.p8.4.m4.1.1.1.1.1.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p8.4.m4.1c">O(L\times M\times d)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p8.4.m4.1d">italic_O ( italic_L × italic_M × italic_d )</annotation></semantics></math>. As for the two stage cascading ANN (HNSW) method of retrieving query-item pairs with two filters, the first stage retrieve the <math alttext="M^{2}K" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p8.5.m5.1"><semantics id="S3.SS3.SSS3.p8.5.m5.1a"><mrow id="S3.SS3.SSS3.p8.5.m5.1.1" xref="S3.SS3.SSS3.p8.5.m5.1.1.cmml"><msup id="S3.SS3.SSS3.p8.5.m5.1.1.2" xref="S3.SS3.SSS3.p8.5.m5.1.1.2.cmml"><mi id="S3.SS3.SSS3.p8.5.m5.1.1.2.2" xref="S3.SS3.SSS3.p8.5.m5.1.1.2.2.cmml">M</mi><mn id="S3.SS3.SSS3.p8.5.m5.1.1.2.3" xref="S3.SS3.SSS3.p8.5.m5.1.1.2.3.cmml">2</mn></msup><mo id="S3.SS3.SSS3.p8.5.m5.1.1.1" xref="S3.SS3.SSS3.p8.5.m5.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p8.5.m5.1.1.3" xref="S3.SS3.SSS3.p8.5.m5.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p8.5.m5.1b"><apply id="S3.SS3.SSS3.p8.5.m5.1.1.cmml" xref="S3.SS3.SSS3.p8.5.m5.1.1"><times id="S3.SS3.SSS3.p8.5.m5.1.1.1.cmml" xref="S3.SS3.SSS3.p8.5.m5.1.1.1"></times><apply id="S3.SS3.SSS3.p8.5.m5.1.1.2.cmml" xref="S3.SS3.SSS3.p8.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p8.5.m5.1.1.2.1.cmml" xref="S3.SS3.SSS3.p8.5.m5.1.1.2">superscript</csymbol><ci id="S3.SS3.SSS3.p8.5.m5.1.1.2.2.cmml" xref="S3.SS3.SSS3.p8.5.m5.1.1.2.2">𝑀</ci><cn id="S3.SS3.SSS3.p8.5.m5.1.1.2.3.cmml" type="integer" xref="S3.SS3.SSS3.p8.5.m5.1.1.2.3">2</cn></apply><ci id="S3.SS3.SSS3.p8.5.m5.1.1.3.cmml" xref="S3.SS3.SSS3.p8.5.m5.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p8.5.m5.1c">M^{2}K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p8.5.m5.1d">italic_M start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_K</annotation></semantics></math> cross-modal candidates from <math alttext="L" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p8.6.m6.1"><semantics id="S3.SS3.SSS3.p8.6.m6.1a"><mi id="S3.SS3.SSS3.p8.6.m6.1.1" xref="S3.SS3.SSS3.p8.6.m6.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p8.6.m6.1b"><ci id="S3.SS3.SSS3.p8.6.m6.1.1.cmml" xref="S3.SS3.SSS3.p8.6.m6.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p8.6.m6.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p8.6.m6.1d">italic_L</annotation></semantics></math> sequence as <math alttext="L\rightarrow M^{2}K" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p8.7.m7.1"><semantics id="S3.SS3.SSS3.p8.7.m7.1a"><mrow id="S3.SS3.SSS3.p8.7.m7.1.1" xref="S3.SS3.SSS3.p8.7.m7.1.1.cmml"><mi id="S3.SS3.SSS3.p8.7.m7.1.1.2" xref="S3.SS3.SSS3.p8.7.m7.1.1.2.cmml">L</mi><mo id="S3.SS3.SSS3.p8.7.m7.1.1.1" stretchy="false" xref="S3.SS3.SSS3.p8.7.m7.1.1.1.cmml">→</mo><mrow id="S3.SS3.SSS3.p8.7.m7.1.1.3" xref="S3.SS3.SSS3.p8.7.m7.1.1.3.cmml"><msup id="S3.SS3.SSS3.p8.7.m7.1.1.3.2" xref="S3.SS3.SSS3.p8.7.m7.1.1.3.2.cmml"><mi id="S3.SS3.SSS3.p8.7.m7.1.1.3.2.2" xref="S3.SS3.SSS3.p8.7.m7.1.1.3.2.2.cmml">M</mi><mn id="S3.SS3.SSS3.p8.7.m7.1.1.3.2.3" xref="S3.SS3.SSS3.p8.7.m7.1.1.3.2.3.cmml">2</mn></msup><mo id="S3.SS3.SSS3.p8.7.m7.1.1.3.1" xref="S3.SS3.SSS3.p8.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p8.7.m7.1.1.3.3" xref="S3.SS3.SSS3.p8.7.m7.1.1.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p8.7.m7.1b"><apply id="S3.SS3.SSS3.p8.7.m7.1.1.cmml" xref="S3.SS3.SSS3.p8.7.m7.1.1"><ci id="S3.SS3.SSS3.p8.7.m7.1.1.1.cmml" xref="S3.SS3.SSS3.p8.7.m7.1.1.1">→</ci><ci id="S3.SS3.SSS3.p8.7.m7.1.1.2.cmml" xref="S3.SS3.SSS3.p8.7.m7.1.1.2">𝐿</ci><apply id="S3.SS3.SSS3.p8.7.m7.1.1.3.cmml" xref="S3.SS3.SSS3.p8.7.m7.1.1.3"><times id="S3.SS3.SSS3.p8.7.m7.1.1.3.1.cmml" xref="S3.SS3.SSS3.p8.7.m7.1.1.3.1"></times><apply id="S3.SS3.SSS3.p8.7.m7.1.1.3.2.cmml" xref="S3.SS3.SSS3.p8.7.m7.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p8.7.m7.1.1.3.2.1.cmml" xref="S3.SS3.SSS3.p8.7.m7.1.1.3.2">superscript</csymbol><ci id="S3.SS3.SSS3.p8.7.m7.1.1.3.2.2.cmml" xref="S3.SS3.SSS3.p8.7.m7.1.1.3.2.2">𝑀</ci><cn id="S3.SS3.SSS3.p8.7.m7.1.1.3.2.3.cmml" type="integer" xref="S3.SS3.SSS3.p8.7.m7.1.1.3.2.3">2</cn></apply><ci id="S3.SS3.SSS3.p8.7.m7.1.1.3.3.cmml" xref="S3.SS3.SSS3.p8.7.m7.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p8.7.m7.1c">L\rightarrow M^{2}K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p8.7.m7.1d">italic_L → italic_M start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_K</annotation></semantics></math>, and the second stage retrieve the final top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p8.8.m8.1"><semantics id="S3.SS3.SSS3.p8.8.m8.1a"><mi id="S3.SS3.SSS3.p8.8.m8.1.1" xref="S3.SS3.SSS3.p8.8.m8.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p8.8.m8.1b"><ci id="S3.SS3.SSS3.p8.8.m8.1.1.cmml" xref="S3.SS3.SSS3.p8.8.m8.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p8.8.m8.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p8.8.m8.1d">italic_K</annotation></semantics></math> items from first stage as <math alttext="M^{2}K\rightarrow K" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p8.9.m9.1"><semantics id="S3.SS3.SSS3.p8.9.m9.1a"><mrow id="S3.SS3.SSS3.p8.9.m9.1.1" xref="S3.SS3.SSS3.p8.9.m9.1.1.cmml"><mrow id="S3.SS3.SSS3.p8.9.m9.1.1.2" xref="S3.SS3.SSS3.p8.9.m9.1.1.2.cmml"><msup id="S3.SS3.SSS3.p8.9.m9.1.1.2.2" xref="S3.SS3.SSS3.p8.9.m9.1.1.2.2.cmml"><mi id="S3.SS3.SSS3.p8.9.m9.1.1.2.2.2" xref="S3.SS3.SSS3.p8.9.m9.1.1.2.2.2.cmml">M</mi><mn id="S3.SS3.SSS3.p8.9.m9.1.1.2.2.3" xref="S3.SS3.SSS3.p8.9.m9.1.1.2.2.3.cmml">2</mn></msup><mo id="S3.SS3.SSS3.p8.9.m9.1.1.2.1" xref="S3.SS3.SSS3.p8.9.m9.1.1.2.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p8.9.m9.1.1.2.3" xref="S3.SS3.SSS3.p8.9.m9.1.1.2.3.cmml">K</mi></mrow><mo id="S3.SS3.SSS3.p8.9.m9.1.1.1" stretchy="false" xref="S3.SS3.SSS3.p8.9.m9.1.1.1.cmml">→</mo><mi id="S3.SS3.SSS3.p8.9.m9.1.1.3" xref="S3.SS3.SSS3.p8.9.m9.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p8.9.m9.1b"><apply id="S3.SS3.SSS3.p8.9.m9.1.1.cmml" xref="S3.SS3.SSS3.p8.9.m9.1.1"><ci id="S3.SS3.SSS3.p8.9.m9.1.1.1.cmml" xref="S3.SS3.SSS3.p8.9.m9.1.1.1">→</ci><apply id="S3.SS3.SSS3.p8.9.m9.1.1.2.cmml" xref="S3.SS3.SSS3.p8.9.m9.1.1.2"><times id="S3.SS3.SSS3.p8.9.m9.1.1.2.1.cmml" xref="S3.SS3.SSS3.p8.9.m9.1.1.2.1"></times><apply id="S3.SS3.SSS3.p8.9.m9.1.1.2.2.cmml" xref="S3.SS3.SSS3.p8.9.m9.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p8.9.m9.1.1.2.2.1.cmml" xref="S3.SS3.SSS3.p8.9.m9.1.1.2.2">superscript</csymbol><ci id="S3.SS3.SSS3.p8.9.m9.1.1.2.2.2.cmml" xref="S3.SS3.SSS3.p8.9.m9.1.1.2.2.2">𝑀</ci><cn id="S3.SS3.SSS3.p8.9.m9.1.1.2.2.3.cmml" type="integer" xref="S3.SS3.SSS3.p8.9.m9.1.1.2.2.3">2</cn></apply><ci id="S3.SS3.SSS3.p8.9.m9.1.1.2.3.cmml" xref="S3.SS3.SSS3.p8.9.m9.1.1.2.3">𝐾</ci></apply><ci id="S3.SS3.SSS3.p8.9.m9.1.1.3.cmml" xref="S3.SS3.SSS3.p8.9.m9.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p8.9.m9.1c">M^{2}K\rightarrow K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p8.9.m9.1d">italic_M start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_K → italic_K</annotation></semantics></math>. Total time complexity of cascading ANN method is <math alttext="O(M^{2}\log(L)d+M^{2}Kd)" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p8.10.m10.3"><semantics id="S3.SS3.SSS3.p8.10.m10.3a"><mrow id="S3.SS3.SSS3.p8.10.m10.3.3" xref="S3.SS3.SSS3.p8.10.m10.3.3.cmml"><mi id="S3.SS3.SSS3.p8.10.m10.3.3.3" xref="S3.SS3.SSS3.p8.10.m10.3.3.3.cmml">O</mi><mo id="S3.SS3.SSS3.p8.10.m10.3.3.2" xref="S3.SS3.SSS3.p8.10.m10.3.3.2.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p8.10.m10.3.3.1.1" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.cmml"><mo id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.2" stretchy="false" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.cmml"><mrow id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.cmml"><msup id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.2" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.2.cmml"><mi id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.2.2" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.2.2.cmml">M</mi><mn id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.2.3" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.2.3.cmml">2</mn></msup><mo id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.1" lspace="0.167em" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.3.2" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.3.1.cmml"><mi id="S3.SS3.SSS3.p8.10.m10.1.1" xref="S3.SS3.SSS3.p8.10.m10.1.1.cmml">log</mi><mo id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.3.2a" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.3.1.cmml">⁡</mo><mrow id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.3.2.1" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.3.1.cmml"><mo id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.3.2.1.1" stretchy="false" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.3.1.cmml">(</mo><mi id="S3.SS3.SSS3.p8.10.m10.2.2" xref="S3.SS3.SSS3.p8.10.m10.2.2.cmml">L</mi><mo id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.3.2.1.2" stretchy="false" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.1a" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.4" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.4.cmml">d</mi></mrow><mo id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.1" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.1.cmml">+</mo><mrow id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.cmml"><msup id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.2" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.2.cmml"><mi id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.2.2" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.2.2.cmml">M</mi><mn id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.2.3" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.2.3.cmml">2</mn></msup><mo id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.1" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.3" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.3.cmml">K</mi><mo id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.1a" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.4" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.4.cmml">d</mi></mrow></mrow><mo id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.3" stretchy="false" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p8.10.m10.3b"><apply id="S3.SS3.SSS3.p8.10.m10.3.3.cmml" xref="S3.SS3.SSS3.p8.10.m10.3.3"><times id="S3.SS3.SSS3.p8.10.m10.3.3.2.cmml" xref="S3.SS3.SSS3.p8.10.m10.3.3.2"></times><ci id="S3.SS3.SSS3.p8.10.m10.3.3.3.cmml" xref="S3.SS3.SSS3.p8.10.m10.3.3.3">𝑂</ci><apply id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.cmml" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1"><plus id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.1"></plus><apply id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.cmml" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2"><times id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.1.cmml" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.1"></times><apply id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.2.cmml" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.2.1.cmml" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.2">superscript</csymbol><ci id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.2.2.cmml" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.2.2">𝑀</ci><cn id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.2.3.cmml" type="integer" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.2.3">2</cn></apply><apply id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.3.1.cmml" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.3.2"><log id="S3.SS3.SSS3.p8.10.m10.1.1.cmml" xref="S3.SS3.SSS3.p8.10.m10.1.1"></log><ci id="S3.SS3.SSS3.p8.10.m10.2.2.cmml" xref="S3.SS3.SSS3.p8.10.m10.2.2">𝐿</ci></apply><ci id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.4.cmml" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.2.4">𝑑</ci></apply><apply id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.cmml" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3"><times id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.1.cmml" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.1"></times><apply id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.2.cmml" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.2.1.cmml" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.2">superscript</csymbol><ci id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.2.2.cmml" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.2.2">𝑀</ci><cn id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.2.3.cmml" type="integer" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.2.3">2</cn></apply><ci id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.3.cmml" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.3">𝐾</ci><ci id="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.4.cmml" xref="S3.SS3.SSS3.p8.10.m10.3.3.1.1.1.3.4">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p8.10.m10.3c">O(M^{2}\log(L)d+M^{2}Kd)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p8.10.m10.3d">italic_O ( italic_M start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_log ( italic_L ) italic_d + italic_M start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_K italic_d )</annotation></semantics></math>, which is faster than our PQ strategy but may achieve sub-optimal recall performance in multiple experiments as reported in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S4.F2" title="Figure 2 ‣ 4.2. Experimental Results ‣ 4. Experiment ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experiment</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Experimental Settings</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">Dataset</span>
We evaluate our proposed SEMINAR model on three datasets: two public datasets including Amazon review dataset (Movies and TV subset) <span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://cseweb.ucsd.edu/~jmcauley/datasets/amazon_v2/" title="">https://cseweb.ucsd.edu/~jmcauley/datasets/amazon_v2/</a></span></span></span> and the KuaiSAR <span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://zenodo.org/records/8181109" title="">https://zenodo.org/records/8181109</a></span></span></span> search and recommendation dataset, one industrial dataset Alipay short video dataset. The average length of users’ sequence has the magnitude of <math alttext="L=2000,1000,100" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.3"><semantics id="S4.SS1.p1.1.m1.3a"><mrow id="S4.SS1.p1.1.m1.3.4" xref="S4.SS1.p1.1.m1.3.4.cmml"><mi id="S4.SS1.p1.1.m1.3.4.2" xref="S4.SS1.p1.1.m1.3.4.2.cmml">L</mi><mo id="S4.SS1.p1.1.m1.3.4.1" xref="S4.SS1.p1.1.m1.3.4.1.cmml">=</mo><mrow id="S4.SS1.p1.1.m1.3.4.3.2" xref="S4.SS1.p1.1.m1.3.4.3.1.cmml"><mn id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">2000</mn><mo id="S4.SS1.p1.1.m1.3.4.3.2.1" xref="S4.SS1.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="S4.SS1.p1.1.m1.2.2" xref="S4.SS1.p1.1.m1.2.2.cmml">1000</mn><mo id="S4.SS1.p1.1.m1.3.4.3.2.2" xref="S4.SS1.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="S4.SS1.p1.1.m1.3.3" xref="S4.SS1.p1.1.m1.3.3.cmml">100</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.3b"><apply id="S4.SS1.p1.1.m1.3.4.cmml" xref="S4.SS1.p1.1.m1.3.4"><eq id="S4.SS1.p1.1.m1.3.4.1.cmml" xref="S4.SS1.p1.1.m1.3.4.1"></eq><ci id="S4.SS1.p1.1.m1.3.4.2.cmml" xref="S4.SS1.p1.1.m1.3.4.2">𝐿</ci><list id="S4.SS1.p1.1.m1.3.4.3.1.cmml" xref="S4.SS1.p1.1.m1.3.4.3.2"><cn id="S4.SS1.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS1.p1.1.m1.1.1">2000</cn><cn id="S4.SS1.p1.1.m1.2.2.cmml" type="integer" xref="S4.SS1.p1.1.m1.2.2">1000</cn><cn id="S4.SS1.p1.1.m1.3.3.cmml" type="integer" xref="S4.SS1.p1.1.m1.3.3">100</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.3c">L=2000,1000,100</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.3d">italic_L = 2000 , 1000 , 100</annotation></semantics></math> for the Alipay, KuaiSAR and Amazon datasets. The detailed statistics can be found in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S4.T1" title="Table 1 ‣ 4.1. Experimental Settings ‣ 4. Experiment ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">Amazon Reviews</span>
We select Movies and TV subset of the public Amazon reviews dataset for experiment. The meta-information of items is also provided in the dataset. We use the image thumbnails as the inputs to the sequence of image modal. To get the aligned query sequence, we generate a query relevant to each item from its description in the meta information as in <cite class="ltx_cite ltx_citemacro_citep">(Ai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib2" title="">2017</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib9" title="">2023</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1">KuaiSAR</span> <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib17" title="">2023</a>)</cite>
KuaiSAR is a real-world public large scale dataset containing both search and recommendation behaviors collected from Kuaishou<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>https://www.kuaishou.com/en</span></span></span>, a leading short-video app. We construct a unified sequence of query and item pairs to compare different lifelong behaviors sequences models.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.1.1">Alipay Short Video</span>
The Alipay short video dataset is a real-world industrial dataset collected from exposures and clicks logs of short-video recommendation and search ranking scenario of Alipay app. We convert the title of the short video as the input to the text modal, and the image thumbnails to the image modal. Users’ search queries are collected and aligned to corresponding viewed items.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.7">We process the datasets of Amazon and KuaiSAR as in literature <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib23" title="">2020</a>)</cite> and repo <span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/RUCAIBox/CIKM2020-S3Rec" title="">https://github.com/RUCAIBox/CIKM2020-S3Rec</a></span></span></span>. User with <math alttext="N" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mi id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">italic_N</annotation></semantics></math> actions will generate N-1 samples. We use the first <math alttext="i-1" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><mrow id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mi id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml">i</mi><mo id="S4.SS1.p3.2.m2.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.cmml">−</mo><mn id="S4.SS1.p3.2.m2.1.1.3" xref="S4.SS1.p3.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><minus id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1"></minus><ci id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2">𝑖</ci><cn id="S4.SS1.p3.2.m2.1.1.3.cmml" type="integer" xref="S4.SS1.p3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">i-1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">italic_i - 1</annotation></semantics></math> actions to predict whether the user will interact with the <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.1"><semantics id="S4.SS1.p3.3.m3.1a"><mi id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><ci id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m3.1d">italic_i</annotation></semantics></math>-th item (<math alttext="0&lt;i&lt;=N" class="ltx_Math" display="inline" id="S4.SS1.p3.4.m4.1"><semantics id="S4.SS1.p3.4.m4.1a"><mrow id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml"><mn id="S4.SS1.p3.4.m4.1.1.2" xref="S4.SS1.p3.4.m4.1.1.2.cmml">0</mn><mo id="S4.SS1.p3.4.m4.1.1.3" xref="S4.SS1.p3.4.m4.1.1.3.cmml">&lt;</mo><mi id="S4.SS1.p3.4.m4.1.1.4" xref="S4.SS1.p3.4.m4.1.1.4.cmml">i</mi><mo id="S4.SS1.p3.4.m4.1.1.5" xref="S4.SS1.p3.4.m4.1.1.5.cmml">&lt;=</mo><mi id="S4.SS1.p3.4.m4.1.1.6" xref="S4.SS1.p3.4.m4.1.1.6.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"><and id="S4.SS1.p3.4.m4.1.1a.cmml" xref="S4.SS1.p3.4.m4.1.1"></and><apply id="S4.SS1.p3.4.m4.1.1b.cmml" xref="S4.SS1.p3.4.m4.1.1"><lt id="S4.SS1.p3.4.m4.1.1.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3"></lt><cn id="S4.SS1.p3.4.m4.1.1.2.cmml" type="integer" xref="S4.SS1.p3.4.m4.1.1.2">0</cn><ci id="S4.SS1.p3.4.m4.1.1.4.cmml" xref="S4.SS1.p3.4.m4.1.1.4">𝑖</ci></apply><apply id="S4.SS1.p3.4.m4.1.1c.cmml" xref="S4.SS1.p3.4.m4.1.1"><leq id="S4.SS1.p3.4.m4.1.1.5.cmml" xref="S4.SS1.p3.4.m4.1.1.5"></leq><share href="https://arxiv.org/html/2407.10714v1#S4.SS1.p3.4.m4.1.1.4.cmml" id="S4.SS1.p3.4.m4.1.1d.cmml" xref="S4.SS1.p3.4.m4.1.1"></share><ci id="S4.SS1.p3.4.m4.1.1.6.cmml" xref="S4.SS1.p3.4.m4.1.1.6">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">0&lt;i&lt;=N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.4.m4.1d">0 &lt; italic_i &lt; = italic_N</annotation></semantics></math>). Additionally, we apply the leave-one-out strategy, using the <math alttext="(N-1)" class="ltx_Math" display="inline" id="S4.SS1.p3.5.m5.1"><semantics id="S4.SS1.p3.5.m5.1a"><mrow id="S4.SS1.p3.5.m5.1.1.1" xref="S4.SS1.p3.5.m5.1.1.1.1.cmml"><mo id="S4.SS1.p3.5.m5.1.1.1.2" stretchy="false" xref="S4.SS1.p3.5.m5.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p3.5.m5.1.1.1.1" xref="S4.SS1.p3.5.m5.1.1.1.1.cmml"><mi id="S4.SS1.p3.5.m5.1.1.1.1.2" xref="S4.SS1.p3.5.m5.1.1.1.1.2.cmml">N</mi><mo id="S4.SS1.p3.5.m5.1.1.1.1.1" xref="S4.SS1.p3.5.m5.1.1.1.1.1.cmml">−</mo><mn id="S4.SS1.p3.5.m5.1.1.1.1.3" xref="S4.SS1.p3.5.m5.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS1.p3.5.m5.1.1.1.3" stretchy="false" xref="S4.SS1.p3.5.m5.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><apply id="S4.SS1.p3.5.m5.1.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1.1"><minus id="S4.SS1.p3.5.m5.1.1.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.1"></minus><ci id="S4.SS1.p3.5.m5.1.1.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.2">𝑁</ci><cn id="S4.SS1.p3.5.m5.1.1.1.1.3.cmml" type="integer" xref="S4.SS1.p3.5.m5.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">(N-1)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.5.m5.1d">( italic_N - 1 )</annotation></semantics></math>-th action as the validation set, the <math alttext="N" class="ltx_Math" display="inline" id="S4.SS1.p3.6.m6.1"><semantics id="S4.SS1.p3.6.m6.1a"><mi id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.1b"><ci id="S4.SS1.p3.6.m6.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.6.m6.1d">italic_N</annotation></semantics></math>-th action as positive in test set and randomly sampled negatives in the test set. The remaining samples are used as training and pretraining set. In the industrial Alipay short video dataset, exposed clicks are treated as positive samples and exposed non-clicks are considered as negative samples. The training and validation sets are randomly split using data from past [0,T-1] days (T=60), and the test set come from the <math alttext="T" class="ltx_Math" display="inline" id="S4.SS1.p3.7.m7.1"><semantics id="S4.SS1.p3.7.m7.1a"><mi id="S4.SS1.p3.7.m7.1.1" xref="S4.SS1.p3.7.m7.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.7.m7.1b"><ci id="S4.SS1.p3.7.m7.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.7.m7.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.7.m7.1d">italic_T</annotation></semantics></math>-th day.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1. </span>Statistics of the Amazon Movies and TV, the Alipay Short Video and KuaiSAR datasets. K denotes thousand.</figcaption>
<table class="ltx_tabular ltx_align_middle" id="S4.T1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.1.1.1.1">Dataset</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.2">User</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.3">Item</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.4">Query</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.5">U-I</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.1.2.2.1">Amazon Movies &amp; TV</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.2.2.2">297 K</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.2.2.3">181 K</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.2.2.4">-</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.2.2.5">3,293 K</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.1.3.3.1">Alipay Short Video</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.3.3.2">35,065 K</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.3.3.3">1,132 K</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.3.3.4">51 K</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.3.3.5">62,948 K</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.4.4">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.1.4.4.1">KuaiSAR</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T1.1.4.4.2">25,877</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T1.1.4.4.3">6,890,707</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T1.1.4.4.4">453,667</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T1.1.4.4.5">19,664,885</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2. </span>Results of lifelong behavior sequence modeling of KuaiSAR dataset, Amazon Review dataset and Alipay short video recommendation dataset.* indicates best performing model. </figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T2.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.1.1.1">
<td class="ltx_td ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.1.1.1.1"></td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="3" id="S4.T2.1.1.1.2">KuaiSAR</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="3" id="S4.T2.1.1.1.3">Amazon Movies and TV</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.1.1.4">Alipay Short Video</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.1.2.2.1">Method</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.2.2.2">NDCG@5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.2.2.3">NDCG@10</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.2.2.4">NDCG@50</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.2.2.5">NDCG@5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.2.2.6">NDCG@10</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.2.2.7">NDCG@50</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.2.2.8">AUC</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.1.3.3.1">SIM</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.3.3.2">0.2523</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.3.3.3">0.2661</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.3.3.4">0.3293</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.3.3.5">0.3573</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.3.3.6">0.3959</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.3.3.7">0.4577</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.3.3.8">0.7382</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.4.4">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.1.4.4.1">QIN</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.4.4.2">0.2535</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.4.4.3">0.2672</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.4.4.4">0.3312</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.4.4.5">0.3650</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.4.4.6">0.4038</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.4.4.7">0.4630</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.4.4.8">0.7239</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.5.5">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.1.5.5.1">ETA</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.5.5.2">0.2642</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.5.5.3">0.2756</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.5.5.4">0.3313</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.5.5.5">0.3626</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.5.5.6">0.4008</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.5.5.7">0.4607</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.5.5.8">0.7262</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.6.6">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.1.6.6.1">TWIN</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.6.6.2">0.2558</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.6.6.3">0.2709</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.6.6.4">0.3294</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.6.6.5">0.3627</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.6.6.6">0.4017</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.6.6.7">0.4605</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.6.6.8">0.7376</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.7.7">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.1.7.7.1">SEMINAR</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.7.7.2">*0.2816</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.7.7.3">*0.2969</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.7.7.4">*0.3457</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.7.7.5">*0.3661</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.7.7.6">*0.4041</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.7.7.7">*0.4636</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.7.7.8">*0.7503</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.8.8">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.1.8.8.1">Absolute Impr.</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T2.1.8.8.2">+0.0292</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T2.1.8.8.3">+0.0308</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T2.1.8.8.4">+0.0164</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T2.1.8.8.5">+0.0088</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T2.1.8.8.6">+0.0082</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T2.1.8.8.7">+0.0059</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T2.1.8.8.8">+0.0264</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3. </span>Ablation Studies of Different PSU pretraining tasks on KuaiSAR Dataset. N@K denotes <span class="ltx_text ltx_markedasmath" id="S4.T3.4.1">NDCG@K</span>.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.5">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.5.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.5.1.1.1">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T3.5.1.1.2">N@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T3.5.1.1.3">N@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T3.5.1.1.4">N@50</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.5.2.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.5.2.1.1">SEMINAR</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.2.1.2">0.2816</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.2.1.3">0.2969</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.2.1.4">0.3457</td>
</tr>
<tr class="ltx_tr" id="S4.T3.5.3.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.5.3.2.1">w/o pretraining</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.3.2.2">0.2564</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.3.2.3">0.2738</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.3.2.4">0.3310</td>
</tr>
<tr class="ltx_tr" id="S4.T3.5.4.3">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.5.4.3.1">w. align, w/o next-predict,q-i relev.</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.4.3.2">0.2702</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.4.3.3">0.2832</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.4.3.4">0.3420</td>
</tr>
<tr class="ltx_tr" id="S4.T3.5.5.4">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.5.5.4.1">w. next-predict, w/o align,q-i relev.</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.5.4.2">0.2675</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.5.4.3">0.2813</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.5.4.4">0.3408</td>
</tr>
<tr class="ltx_tr" id="S4.T3.5.6.5">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.5.6.5.1">w. q-i relev., w/o align, next-predict</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.5.6.5.2">0.2633</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.5.6.5.3">0.2754</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.5.6.5.4">0.3357</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.5">To evaluate the recall performance of different approximation fast retrieval methods, we conduct experiments on two datasets: the multi-modal embedding of the Alipay short video dataset with sequence length <math alttext="L=2,000" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.2"><semantics id="S4.SS1.p4.1.m1.2a"><mrow id="S4.SS1.p4.1.m1.2.3" xref="S4.SS1.p4.1.m1.2.3.cmml"><mi id="S4.SS1.p4.1.m1.2.3.2" xref="S4.SS1.p4.1.m1.2.3.2.cmml">L</mi><mo id="S4.SS1.p4.1.m1.2.3.1" xref="S4.SS1.p4.1.m1.2.3.1.cmml">=</mo><mrow id="S4.SS1.p4.1.m1.2.3.3.2" xref="S4.SS1.p4.1.m1.2.3.3.1.cmml"><mn id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml">2</mn><mo id="S4.SS1.p4.1.m1.2.3.3.2.1" xref="S4.SS1.p4.1.m1.2.3.3.1.cmml">,</mo><mn id="S4.SS1.p4.1.m1.2.2" xref="S4.SS1.p4.1.m1.2.2.cmml">000</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.2b"><apply id="S4.SS1.p4.1.m1.2.3.cmml" xref="S4.SS1.p4.1.m1.2.3"><eq id="S4.SS1.p4.1.m1.2.3.1.cmml" xref="S4.SS1.p4.1.m1.2.3.1"></eq><ci id="S4.SS1.p4.1.m1.2.3.2.cmml" xref="S4.SS1.p4.1.m1.2.3.2">𝐿</ci><list id="S4.SS1.p4.1.m1.2.3.3.1.cmml" xref="S4.SS1.p4.1.m1.2.3.3.2"><cn id="S4.SS1.p4.1.m1.1.1.cmml" type="integer" xref="S4.SS1.p4.1.m1.1.1">2</cn><cn id="S4.SS1.p4.1.m1.2.2.cmml" type="integer" xref="S4.SS1.p4.1.m1.2.2">000</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.2c">L=2,000</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.1.m1.2d">italic_L = 2 , 000</annotation></semantics></math> and a synthetic dataset. The purpose of the synthetic dataset is to test the performance of different retrieval methods on extremely long sequence (e.g. <math alttext="L=10,000" class="ltx_Math" display="inline" id="S4.SS1.p4.2.m2.2"><semantics id="S4.SS1.p4.2.m2.2a"><mrow id="S4.SS1.p4.2.m2.2.3" xref="S4.SS1.p4.2.m2.2.3.cmml"><mi id="S4.SS1.p4.2.m2.2.3.2" xref="S4.SS1.p4.2.m2.2.3.2.cmml">L</mi><mo id="S4.SS1.p4.2.m2.2.3.1" xref="S4.SS1.p4.2.m2.2.3.1.cmml">=</mo><mrow id="S4.SS1.p4.2.m2.2.3.3.2" xref="S4.SS1.p4.2.m2.2.3.3.1.cmml"><mn id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml">10</mn><mo id="S4.SS1.p4.2.m2.2.3.3.2.1" xref="S4.SS1.p4.2.m2.2.3.3.1.cmml">,</mo><mn id="S4.SS1.p4.2.m2.2.2" xref="S4.SS1.p4.2.m2.2.2.cmml">000</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.2b"><apply id="S4.SS1.p4.2.m2.2.3.cmml" xref="S4.SS1.p4.2.m2.2.3"><eq id="S4.SS1.p4.2.m2.2.3.1.cmml" xref="S4.SS1.p4.2.m2.2.3.1"></eq><ci id="S4.SS1.p4.2.m2.2.3.2.cmml" xref="S4.SS1.p4.2.m2.2.3.2">𝐿</ci><list id="S4.SS1.p4.2.m2.2.3.3.1.cmml" xref="S4.SS1.p4.2.m2.2.3.3.2"><cn id="S4.SS1.p4.2.m2.1.1.cmml" type="integer" xref="S4.SS1.p4.2.m2.1.1">10</cn><cn id="S4.SS1.p4.2.m2.2.2.cmml" type="integer" xref="S4.SS1.p4.2.m2.2.2">000</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.2c">L=10,000</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.2.m2.2d">italic_L = 10 , 000</annotation></semantics></math>), which is not available in public datasets. The synthetic dataset consists of query, text, image, and attribute vectors generated by i.i.d. normal distribution <math alttext="N(\mu,\sigma^{2})" class="ltx_Math" display="inline" id="S4.SS1.p4.3.m3.2"><semantics id="S4.SS1.p4.3.m3.2a"><mrow id="S4.SS1.p4.3.m3.2.2" xref="S4.SS1.p4.3.m3.2.2.cmml"><mi id="S4.SS1.p4.3.m3.2.2.3" xref="S4.SS1.p4.3.m3.2.2.3.cmml">N</mi><mo id="S4.SS1.p4.3.m3.2.2.2" xref="S4.SS1.p4.3.m3.2.2.2.cmml">⁢</mo><mrow id="S4.SS1.p4.3.m3.2.2.1.1" xref="S4.SS1.p4.3.m3.2.2.1.2.cmml"><mo id="S4.SS1.p4.3.m3.2.2.1.1.2" stretchy="false" xref="S4.SS1.p4.3.m3.2.2.1.2.cmml">(</mo><mi id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml">μ</mi><mo id="S4.SS1.p4.3.m3.2.2.1.1.3" xref="S4.SS1.p4.3.m3.2.2.1.2.cmml">,</mo><msup id="S4.SS1.p4.3.m3.2.2.1.1.1" xref="S4.SS1.p4.3.m3.2.2.1.1.1.cmml"><mi id="S4.SS1.p4.3.m3.2.2.1.1.1.2" xref="S4.SS1.p4.3.m3.2.2.1.1.1.2.cmml">σ</mi><mn id="S4.SS1.p4.3.m3.2.2.1.1.1.3" xref="S4.SS1.p4.3.m3.2.2.1.1.1.3.cmml">2</mn></msup><mo id="S4.SS1.p4.3.m3.2.2.1.1.4" stretchy="false" xref="S4.SS1.p4.3.m3.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.2b"><apply id="S4.SS1.p4.3.m3.2.2.cmml" xref="S4.SS1.p4.3.m3.2.2"><times id="S4.SS1.p4.3.m3.2.2.2.cmml" xref="S4.SS1.p4.3.m3.2.2.2"></times><ci id="S4.SS1.p4.3.m3.2.2.3.cmml" xref="S4.SS1.p4.3.m3.2.2.3">𝑁</ci><interval closure="open" id="S4.SS1.p4.3.m3.2.2.1.2.cmml" xref="S4.SS1.p4.3.m3.2.2.1.1"><ci id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1">𝜇</ci><apply id="S4.SS1.p4.3.m3.2.2.1.1.1.cmml" xref="S4.SS1.p4.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m3.2.2.1.1.1.1.cmml" xref="S4.SS1.p4.3.m3.2.2.1.1.1">superscript</csymbol><ci id="S4.SS1.p4.3.m3.2.2.1.1.1.2.cmml" xref="S4.SS1.p4.3.m3.2.2.1.1.1.2">𝜎</ci><cn id="S4.SS1.p4.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS1.p4.3.m3.2.2.1.1.1.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.2c">N(\mu,\sigma^{2})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.3.m3.2d">italic_N ( italic_μ , italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> with different values of mean <math alttext="\mu" class="ltx_Math" display="inline" id="S4.SS1.p4.4.m4.1"><semantics id="S4.SS1.p4.4.m4.1a"><mi id="S4.SS1.p4.4.m4.1.1" xref="S4.SS1.p4.4.m4.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.1b"><ci id="S4.SS1.p4.4.m4.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.4.m4.1d">italic_μ</annotation></semantics></math> and variance <math alttext="\sigma^{2}" class="ltx_Math" display="inline" id="S4.SS1.p4.5.m5.1"><semantics id="S4.SS1.p4.5.m5.1a"><msup id="S4.SS1.p4.5.m5.1.1" xref="S4.SS1.p4.5.m5.1.1.cmml"><mi id="S4.SS1.p4.5.m5.1.1.2" xref="S4.SS1.p4.5.m5.1.1.2.cmml">σ</mi><mn id="S4.SS1.p4.5.m5.1.1.3" xref="S4.SS1.p4.5.m5.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.5.m5.1b"><apply id="S4.SS1.p4.5.m5.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.5.m5.1.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1">superscript</csymbol><ci id="S4.SS1.p4.5.m5.1.1.2.cmml" xref="S4.SS1.p4.5.m5.1.1.2">𝜎</ci><cn id="S4.SS1.p4.5.m5.1.1.3.cmml" type="integer" xref="S4.SS1.p4.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.5.m5.1c">\sigma^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.5.m5.1d">italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>, to imitate various norm values of multi-modal vectors of query-item pairs.</p>
</div>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4. </span><span class="ltx_text ltx_markedasmath" id="S4.T4.4.1">Recall@K</span> Evaluation of Approximate Retrieval Methods on Alipay Short Video Recommendation Dataset</figcaption>
<table class="ltx_tabular ltx_align_middle" id="S4.T4.5">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.5.1.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T4.5.1.1.1">Method</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.5.1.1.2">R@32</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.5.1.1.3">R@64</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.5.1.1.4">R@128</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.5.1.1.5">R@256</td>
</tr>
<tr class="ltx_tr" id="S4.T4.5.2.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T4.5.2.2.1">ANN (HNSW)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.5.2.2.2">0.7881</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.5.2.2.3">0.8603</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.5.2.2.4">0.9288</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.5.2.2.5">0.9409</td>
</tr>
<tr class="ltx_tr" id="S4.T4.5.3.3">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T4.5.3.3.1">LSH</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.5.3.3.2">0.7528</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.5.3.3.3">0.8175</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.5.3.3.4">0.8721</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.5.3.3.5">0.9257</td>
</tr>
<tr class="ltx_tr" id="S4.T4.5.4.4">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T4.5.4.4.1">RQ-VAE</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.5.4.4.2">0.8225</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.5.4.4.3">0.8422</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.5.4.4.4">0.8633</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.5.4.4.5">0.8995</td>
</tr>
<tr class="ltx_tr" id="S4.T4.5.5.5">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S4.T4.5.5.5.1">Multi-Modal PQ</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T4.5.5.5.2">0.9638</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T4.5.5.5.3">0.9769</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T4.5.5.5.4">0.9797</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T4.5.5.5.5">0.9874</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p5.1.1">Comparison Methods</span></p>
</div>
<div class="ltx_para" id="S4.SS1.p6">
<p class="ltx_p" id="S4.SS1.p6.1">We compared several strong lifelong sequence modeling baselines with our proposed SEMINAR model:</p>
</div>
<div class="ltx_para" id="S4.SS1.p7">
<ul class="ltx_itemize" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i1.p1.1.1">SIM</span> <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib13" title="">2020</a>)</cite>
SIM adopts cascading search unit GSU and ESU to extract the relevant behaviors of the candidate item and applies multi-head target attention to model users’ interest.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i2.p1.1.1">ETA</span> <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib4" title="">2022</a>)</cite>
Efficient Target Attention encodes query and keys as binary hash vectors using a multi-round random projection matrix. The retrieval is calculated as the Hamming distance between the target item and the items in the sequence.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i3.p1">
<p class="ltx_p" id="S4.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i3.p1.1.1">TWIN</span> <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib3" title="">2023</a>)</cite>
Two-Stage Interest Network adopts the same relevance metric between the target behavior and historical behaviors as the target attention in two cascading stages GSU and ESU.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i4.p1">
<p class="ltx_p" id="S4.I2.i4.p1.2"><span class="ltx_text ltx_font_bold" id="S4.I2.i4.p1.2.1">QIN</span> <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib9" title="">2023</a>)</cite>
QIN network uses the query as first trigger to retrieve top <math alttext="K1" class="ltx_Math" display="inline" id="S4.I2.i4.p1.1.m1.1"><semantics id="S4.I2.i4.p1.1.m1.1a"><mrow id="S4.I2.i4.p1.1.m1.1.1" xref="S4.I2.i4.p1.1.m1.1.1.cmml"><mi id="S4.I2.i4.p1.1.m1.1.1.2" xref="S4.I2.i4.p1.1.m1.1.1.2.cmml">K</mi><mo id="S4.I2.i4.p1.1.m1.1.1.1" xref="S4.I2.i4.p1.1.m1.1.1.1.cmml">⁢</mo><mn id="S4.I2.i4.p1.1.m1.1.1.3" xref="S4.I2.i4.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i4.p1.1.m1.1b"><apply id="S4.I2.i4.p1.1.m1.1.1.cmml" xref="S4.I2.i4.p1.1.m1.1.1"><times id="S4.I2.i4.p1.1.m1.1.1.1.cmml" xref="S4.I2.i4.p1.1.m1.1.1.1"></times><ci id="S4.I2.i4.p1.1.m1.1.1.2.cmml" xref="S4.I2.i4.p1.1.m1.1.1.2">𝐾</ci><cn id="S4.I2.i4.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.I2.i4.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i4.p1.1.m1.1c">K1</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i4.p1.1.m1.1d">italic_K 1</annotation></semantics></math> behaviors, and target item as the second trigger to retrieve top <math alttext="K2" class="ltx_Math" display="inline" id="S4.I2.i4.p1.2.m2.1"><semantics id="S4.I2.i4.p1.2.m2.1a"><mrow id="S4.I2.i4.p1.2.m2.1.1" xref="S4.I2.i4.p1.2.m2.1.1.cmml"><mi id="S4.I2.i4.p1.2.m2.1.1.2" xref="S4.I2.i4.p1.2.m2.1.1.2.cmml">K</mi><mo id="S4.I2.i4.p1.2.m2.1.1.1" xref="S4.I2.i4.p1.2.m2.1.1.1.cmml">⁢</mo><mn id="S4.I2.i4.p1.2.m2.1.1.3" xref="S4.I2.i4.p1.2.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i4.p1.2.m2.1b"><apply id="S4.I2.i4.p1.2.m2.1.1.cmml" xref="S4.I2.i4.p1.2.m2.1.1"><times id="S4.I2.i4.p1.2.m2.1.1.1.cmml" xref="S4.I2.i4.p1.2.m2.1.1.1"></times><ci id="S4.I2.i4.p1.2.m2.1.1.2.cmml" xref="S4.I2.i4.p1.2.m2.1.1.2">𝐾</ci><cn id="S4.I2.i4.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.I2.i4.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i4.p1.2.m2.1c">K2</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i4.p1.2.m2.1d">italic_K 2</annotation></semantics></math> relevant items afterwards.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS1.p8">
<p class="ltx_p" id="S4.SS1.p8.1">The input features to all baseline models are the same, including the query and multi-modal item features in all datasets.</p>
</div>
<div class="ltx_para" id="S4.SS1.p9">
<p class="ltx_p" id="S4.SS1.p9.1">For the online approximate retrieval performance, we compared our proposed multi-modal product quantization <cite class="ltx_cite ltx_citemacro_citep">(Jégou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib11" title="">2011</a>)</cite> strategy with some widely adopted vector retrieval methods in the query-item multi-modal pairs retrieval setting, including:</p>
</div>
<div class="ltx_para" id="S4.SS1.p10">
<ul class="ltx_itemize" id="S4.I3">
<li class="ltx_item" id="S4.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i1.p1">
<p class="ltx_p" id="S4.I3.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i1.p1.1.1">HNSW</span> <cite class="ltx_cite ltx_citemacro_citep">(Malkov and Yashunin, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib12" title="">2018</a>)</cite>
Navigable Small World Graphs</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i2.p1">
<p class="ltx_p" id="S4.I3.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i2.p1.1.1">LSH</span>
Locality Sensitive Hashing</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i3.p1">
<p class="ltx_p" id="S4.I3.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i3.p1.1.1">RQ-VAE</span> <cite class="ltx_cite ltx_citemacro_citep">(Zeghidour et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib21" title="">2021</a>)</cite>
Residual Vector Quantization VAE (RQ-VAE) follows an encoder-decoder structure and uses the multi-stage vector quantizer to regress original inputs, with multi-scale spectral reconstruction loss as constraints.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS1.p11">
<p class="ltx_p" id="S4.SS1.p11.4"><span class="ltx_text ltx_font_bold" id="S4.SS1.p11.4.1">Evaluation Metrics</span>
We use <span class="ltx_text ltx_markedasmath" id="S4.SS1.p11.4.2">NDCG@K</span> to evaluate the recommendation performance on Amazon review and KuaiSAR dataset, and <span class="ltx_text ltx_markedasmath" id="S4.SS1.p11.4.3">AUC</span> (Area Under the Curve) to evaluate the CTR prediction performance of exposures and clicks in Alipay short video dataset. Secondly, to evaluate the performance of multi-modal query-item retrieval, we calculate the exact attention on all the items in the sequence using the target query-item pair as a trigger and regard the real top-K relevant items as ground truth. Different fast retrieval strategies are evaluated by <span class="ltx_text ltx_markedasmath" id="S4.SS1.p11.4.4">Recall@K</span> at different <math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p11.4.m4.1"><semantics id="S4.SS1.p11.4.m4.1a"><mi id="S4.SS1.p11.4.m4.1.1" xref="S4.SS1.p11.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p11.4.m4.1b"><ci id="S4.SS1.p11.4.m4.1.1.cmml" xref="S4.SS1.p11.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p11.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p11.4.m4.1d">italic_K</annotation></semantics></math> levels, which measures how many top-K relevant ground truth items are recalled by the approximation strategy.</p>
</div>
<div class="ltx_para" id="S4.SS1.p12">
<p class="ltx_p" id="S4.SS1.p12.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p12.1.1">Implementation Details</span>

We implement the baseline methods and our proposed SEMINAR model using PyTorch. Secondly, the baselines of different approximate retrieval methods, ANN(HNSW), and our Multi-Modal Product Quantization are implemented using the Python library faiss <cite class="ltx_cite ltx_citemacro_citep">(Douze et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib7" title="">2024</a>)</cite> <span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/facebookresearch/faiss" title="">https://github.com/facebookresearch/faiss</a></span></span></span>, and the RQ-VAE <cite class="ltx_cite ltx_citemacro_citep">(Zeghidour et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib21" title="">2021</a>)</cite> is implemented using the Python library vector_quantize_pytorch <span class="ltx_note ltx_role_footnote" id="footnote7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/lucidrains/vector-quantize-pytorch" title="">https://github.com/lucidrains/vector-quantize-pytorch</a></span></span></span>.
The code of SEMINAR is available at the repo: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/paper-submission-coder/SEMINAR" title="">https://github.com/paper-submission-coder/SEMINAR</a> and the public datasets Amazon and KuaiSAR can be downloaded following the instructions in the README file.</p>
</div>
<div class="ltx_para" id="S4.SS1.p13">
<p class="ltx_p" id="S4.SS1.p13.17">For the hyperparameter settings of recommendation models, we set the sequence length <math alttext="L" class="ltx_Math" display="inline" id="S4.SS1.p13.1.m1.1"><semantics id="S4.SS1.p13.1.m1.1a"><mi id="S4.SS1.p13.1.m1.1.1" xref="S4.SS1.p13.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p13.1.m1.1b"><ci id="S4.SS1.p13.1.m1.1.1.cmml" xref="S4.SS1.p13.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p13.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p13.1.m1.1d">italic_L</annotation></semantics></math> to 2000,1000 and 100 for Alipay Short Video, KuaiSAR, and Amazon Review datasets and retrieve <math alttext="K=200,200,50" class="ltx_Math" display="inline" id="S4.SS1.p13.2.m2.3"><semantics id="S4.SS1.p13.2.m2.3a"><mrow id="S4.SS1.p13.2.m2.3.4" xref="S4.SS1.p13.2.m2.3.4.cmml"><mi id="S4.SS1.p13.2.m2.3.4.2" xref="S4.SS1.p13.2.m2.3.4.2.cmml">K</mi><mo id="S4.SS1.p13.2.m2.3.4.1" xref="S4.SS1.p13.2.m2.3.4.1.cmml">=</mo><mrow id="S4.SS1.p13.2.m2.3.4.3.2" xref="S4.SS1.p13.2.m2.3.4.3.1.cmml"><mn id="S4.SS1.p13.2.m2.1.1" xref="S4.SS1.p13.2.m2.1.1.cmml">200</mn><mo id="S4.SS1.p13.2.m2.3.4.3.2.1" xref="S4.SS1.p13.2.m2.3.4.3.1.cmml">,</mo><mn id="S4.SS1.p13.2.m2.2.2" xref="S4.SS1.p13.2.m2.2.2.cmml">200</mn><mo id="S4.SS1.p13.2.m2.3.4.3.2.2" xref="S4.SS1.p13.2.m2.3.4.3.1.cmml">,</mo><mn id="S4.SS1.p13.2.m2.3.3" xref="S4.SS1.p13.2.m2.3.3.cmml">50</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p13.2.m2.3b"><apply id="S4.SS1.p13.2.m2.3.4.cmml" xref="S4.SS1.p13.2.m2.3.4"><eq id="S4.SS1.p13.2.m2.3.4.1.cmml" xref="S4.SS1.p13.2.m2.3.4.1"></eq><ci id="S4.SS1.p13.2.m2.3.4.2.cmml" xref="S4.SS1.p13.2.m2.3.4.2">𝐾</ci><list id="S4.SS1.p13.2.m2.3.4.3.1.cmml" xref="S4.SS1.p13.2.m2.3.4.3.2"><cn id="S4.SS1.p13.2.m2.1.1.cmml" type="integer" xref="S4.SS1.p13.2.m2.1.1">200</cn><cn id="S4.SS1.p13.2.m2.2.2.cmml" type="integer" xref="S4.SS1.p13.2.m2.2.2">200</cn><cn id="S4.SS1.p13.2.m2.3.3.cmml" type="integer" xref="S4.SS1.p13.2.m2.3.3">50</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p13.2.m2.3c">K=200,200,50</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p13.2.m2.3d">italic_K = 200 , 200 , 50</annotation></semantics></math> most relevant items, based on users’ average interaction length in different datasets. The embedding of multi-modal text and image channels are outputs from pretrained ViT-B/32 <span class="ltx_note ltx_role_footnote" id="footnote8"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">8</sup><span class="ltx_tag ltx_tag_note">8</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/openai/CLIP" title="">https://github.com/openai/CLIP</a></span></span></span> model of CLIP with original dimension 512, then linearly projected to dimension 64. And the weight of query representation <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS1.p13.3.m3.1"><semantics id="S4.SS1.p13.3.m3.1a"><mi id="S4.SS1.p13.3.m3.1.1" xref="S4.SS1.p13.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p13.3.m3.1b"><ci id="S4.SS1.p13.3.m3.1.1.cmml" xref="S4.SS1.p13.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p13.3.m3.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p13.3.m3.1d">italic_λ</annotation></semantics></math> in section <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S3.Ex1" title="Next Pair Prediction and Multi-Head Target Attention ‣ 3.3.1. Pretraining Search Unit ‣ 3.3. SEMINAR Model Architecture ‣ 3. Proposed Model ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3.3.1</span></a> is set to 0.5 to fuse query embedding and multi-modal item embedding. We also compare different <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS1.p13.4.m4.1"><semantics id="S4.SS1.p13.4.m4.1a"><mi id="S4.SS1.p13.4.m4.1.1" xref="S4.SS1.p13.4.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p13.4.m4.1b"><ci id="S4.SS1.p13.4.m4.1.1.cmml" xref="S4.SS1.p13.4.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p13.4.m4.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p13.4.m4.1d">italic_λ</annotation></semantics></math> values (<math alttext="\lambda=0.1,0.3,0.5,0.7,0.9" class="ltx_Math" display="inline" id="S4.SS1.p13.5.m5.5"><semantics id="S4.SS1.p13.5.m5.5a"><mrow id="S4.SS1.p13.5.m5.5.6" xref="S4.SS1.p13.5.m5.5.6.cmml"><mi id="S4.SS1.p13.5.m5.5.6.2" xref="S4.SS1.p13.5.m5.5.6.2.cmml">λ</mi><mo id="S4.SS1.p13.5.m5.5.6.1" xref="S4.SS1.p13.5.m5.5.6.1.cmml">=</mo><mrow id="S4.SS1.p13.5.m5.5.6.3.2" xref="S4.SS1.p13.5.m5.5.6.3.1.cmml"><mn id="S4.SS1.p13.5.m5.1.1" xref="S4.SS1.p13.5.m5.1.1.cmml">0.1</mn><mo id="S4.SS1.p13.5.m5.5.6.3.2.1" xref="S4.SS1.p13.5.m5.5.6.3.1.cmml">,</mo><mn id="S4.SS1.p13.5.m5.2.2" xref="S4.SS1.p13.5.m5.2.2.cmml">0.3</mn><mo id="S4.SS1.p13.5.m5.5.6.3.2.2" xref="S4.SS1.p13.5.m5.5.6.3.1.cmml">,</mo><mn id="S4.SS1.p13.5.m5.3.3" xref="S4.SS1.p13.5.m5.3.3.cmml">0.5</mn><mo id="S4.SS1.p13.5.m5.5.6.3.2.3" xref="S4.SS1.p13.5.m5.5.6.3.1.cmml">,</mo><mn id="S4.SS1.p13.5.m5.4.4" xref="S4.SS1.p13.5.m5.4.4.cmml">0.7</mn><mo id="S4.SS1.p13.5.m5.5.6.3.2.4" xref="S4.SS1.p13.5.m5.5.6.3.1.cmml">,</mo><mn id="S4.SS1.p13.5.m5.5.5" xref="S4.SS1.p13.5.m5.5.5.cmml">0.9</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p13.5.m5.5b"><apply id="S4.SS1.p13.5.m5.5.6.cmml" xref="S4.SS1.p13.5.m5.5.6"><eq id="S4.SS1.p13.5.m5.5.6.1.cmml" xref="S4.SS1.p13.5.m5.5.6.1"></eq><ci id="S4.SS1.p13.5.m5.5.6.2.cmml" xref="S4.SS1.p13.5.m5.5.6.2">𝜆</ci><list id="S4.SS1.p13.5.m5.5.6.3.1.cmml" xref="S4.SS1.p13.5.m5.5.6.3.2"><cn id="S4.SS1.p13.5.m5.1.1.cmml" type="float" xref="S4.SS1.p13.5.m5.1.1">0.1</cn><cn id="S4.SS1.p13.5.m5.2.2.cmml" type="float" xref="S4.SS1.p13.5.m5.2.2">0.3</cn><cn id="S4.SS1.p13.5.m5.3.3.cmml" type="float" xref="S4.SS1.p13.5.m5.3.3">0.5</cn><cn id="S4.SS1.p13.5.m5.4.4.cmml" type="float" xref="S4.SS1.p13.5.m5.4.4">0.7</cn><cn id="S4.SS1.p13.5.m5.5.5.cmml" type="float" xref="S4.SS1.p13.5.m5.5.5">0.9</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p13.5.m5.5c">\lambda=0.1,0.3,0.5,0.7,0.9</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p13.5.m5.5d">italic_λ = 0.1 , 0.3 , 0.5 , 0.7 , 0.9</annotation></semantics></math>) in the following section of ablation study. For the multi-head target attention, we set number of heads as 4. The batch size is set to 256 and we are using Adam optimizer with learning rate set to 0.001. The number of pretraining epochs is set to <math alttext="5,1,1" class="ltx_Math" display="inline" id="S4.SS1.p13.6.m6.3"><semantics id="S4.SS1.p13.6.m6.3a"><mrow id="S4.SS1.p13.6.m6.3.4.2" xref="S4.SS1.p13.6.m6.3.4.1.cmml"><mn id="S4.SS1.p13.6.m6.1.1" xref="S4.SS1.p13.6.m6.1.1.cmml">5</mn><mo id="S4.SS1.p13.6.m6.3.4.2.1" xref="S4.SS1.p13.6.m6.3.4.1.cmml">,</mo><mn id="S4.SS1.p13.6.m6.2.2" xref="S4.SS1.p13.6.m6.2.2.cmml">1</mn><mo id="S4.SS1.p13.6.m6.3.4.2.2" xref="S4.SS1.p13.6.m6.3.4.1.cmml">,</mo><mn id="S4.SS1.p13.6.m6.3.3" xref="S4.SS1.p13.6.m6.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p13.6.m6.3b"><list id="S4.SS1.p13.6.m6.3.4.1.cmml" xref="S4.SS1.p13.6.m6.3.4.2"><cn id="S4.SS1.p13.6.m6.1.1.cmml" type="integer" xref="S4.SS1.p13.6.m6.1.1">5</cn><cn id="S4.SS1.p13.6.m6.2.2.cmml" type="integer" xref="S4.SS1.p13.6.m6.2.2">1</cn><cn id="S4.SS1.p13.6.m6.3.3.cmml" type="integer" xref="S4.SS1.p13.6.m6.3.3">1</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p13.6.m6.3c">5,1,1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p13.6.m6.3d">5 , 1 , 1</annotation></semantics></math> on KuaiSAR, Amazon and Alipay datasets respectively, and the number of training epochs are the same for all models in comparison. The checkpoint is exported by best NDCG metrics on evaluation dataset. For the implementation of our multi-modal production quantization, number of modals <math alttext="M" class="ltx_Math" display="inline" id="S4.SS1.p13.7.m7.1"><semantics id="S4.SS1.p13.7.m7.1a"><mi id="S4.SS1.p13.7.m7.1.1" xref="S4.SS1.p13.7.m7.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p13.7.m7.1b"><ci id="S4.SS1.p13.7.m7.1.1.cmml" xref="S4.SS1.p13.7.m7.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p13.7.m7.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p13.7.m7.1d">italic_M</annotation></semantics></math> is set to 4. And the original 64-dimension dense embedding vectors are expressed as <math alttext="N_{bit}=8" class="ltx_Math" display="inline" id="S4.SS1.p13.8.m8.1"><semantics id="S4.SS1.p13.8.m8.1a"><mrow id="S4.SS1.p13.8.m8.1.1" xref="S4.SS1.p13.8.m8.1.1.cmml"><msub id="S4.SS1.p13.8.m8.1.1.2" xref="S4.SS1.p13.8.m8.1.1.2.cmml"><mi id="S4.SS1.p13.8.m8.1.1.2.2" xref="S4.SS1.p13.8.m8.1.1.2.2.cmml">N</mi><mrow id="S4.SS1.p13.8.m8.1.1.2.3" xref="S4.SS1.p13.8.m8.1.1.2.3.cmml"><mi id="S4.SS1.p13.8.m8.1.1.2.3.2" xref="S4.SS1.p13.8.m8.1.1.2.3.2.cmml">b</mi><mo id="S4.SS1.p13.8.m8.1.1.2.3.1" xref="S4.SS1.p13.8.m8.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p13.8.m8.1.1.2.3.3" xref="S4.SS1.p13.8.m8.1.1.2.3.3.cmml">i</mi><mo id="S4.SS1.p13.8.m8.1.1.2.3.1a" xref="S4.SS1.p13.8.m8.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p13.8.m8.1.1.2.3.4" xref="S4.SS1.p13.8.m8.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S4.SS1.p13.8.m8.1.1.1" xref="S4.SS1.p13.8.m8.1.1.1.cmml">=</mo><mn id="S4.SS1.p13.8.m8.1.1.3" xref="S4.SS1.p13.8.m8.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p13.8.m8.1b"><apply id="S4.SS1.p13.8.m8.1.1.cmml" xref="S4.SS1.p13.8.m8.1.1"><eq id="S4.SS1.p13.8.m8.1.1.1.cmml" xref="S4.SS1.p13.8.m8.1.1.1"></eq><apply id="S4.SS1.p13.8.m8.1.1.2.cmml" xref="S4.SS1.p13.8.m8.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p13.8.m8.1.1.2.1.cmml" xref="S4.SS1.p13.8.m8.1.1.2">subscript</csymbol><ci id="S4.SS1.p13.8.m8.1.1.2.2.cmml" xref="S4.SS1.p13.8.m8.1.1.2.2">𝑁</ci><apply id="S4.SS1.p13.8.m8.1.1.2.3.cmml" xref="S4.SS1.p13.8.m8.1.1.2.3"><times id="S4.SS1.p13.8.m8.1.1.2.3.1.cmml" xref="S4.SS1.p13.8.m8.1.1.2.3.1"></times><ci id="S4.SS1.p13.8.m8.1.1.2.3.2.cmml" xref="S4.SS1.p13.8.m8.1.1.2.3.2">𝑏</ci><ci id="S4.SS1.p13.8.m8.1.1.2.3.3.cmml" xref="S4.SS1.p13.8.m8.1.1.2.3.3">𝑖</ci><ci id="S4.SS1.p13.8.m8.1.1.2.3.4.cmml" xref="S4.SS1.p13.8.m8.1.1.2.3.4">𝑡</ci></apply></apply><cn id="S4.SS1.p13.8.m8.1.1.3.cmml" type="integer" xref="S4.SS1.p13.8.m8.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p13.8.m8.1c">N_{bit}=8</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p13.8.m8.1d">italic_N start_POSTSUBSCRIPT italic_b italic_i italic_t end_POSTSUBSCRIPT = 8</annotation></semantics></math> bits vectors of integer codes. Each bit of the integer vectors represents the codebook assignment of centroids <math alttext="c^{(m)}_{i}\in\{1,2,…,|\mathcal{C}_{m}|\}" class="ltx_Math" display="inline" id="S4.SS1.p13.9.m9.5"><semantics id="S4.SS1.p13.9.m9.5a"><mrow id="S4.SS1.p13.9.m9.5.5" xref="S4.SS1.p13.9.m9.5.5.cmml"><msubsup id="S4.SS1.p13.9.m9.5.5.3" xref="S4.SS1.p13.9.m9.5.5.3.cmml"><mi id="S4.SS1.p13.9.m9.5.5.3.2.2" xref="S4.SS1.p13.9.m9.5.5.3.2.2.cmml">c</mi><mi id="S4.SS1.p13.9.m9.5.5.3.3" xref="S4.SS1.p13.9.m9.5.5.3.3.cmml">i</mi><mrow id="S4.SS1.p13.9.m9.1.1.1.3" xref="S4.SS1.p13.9.m9.5.5.3.cmml"><mo id="S4.SS1.p13.9.m9.1.1.1.3.1" stretchy="false" xref="S4.SS1.p13.9.m9.5.5.3.cmml">(</mo><mi id="S4.SS1.p13.9.m9.1.1.1.1" xref="S4.SS1.p13.9.m9.1.1.1.1.cmml">m</mi><mo id="S4.SS1.p13.9.m9.1.1.1.3.2" stretchy="false" xref="S4.SS1.p13.9.m9.5.5.3.cmml">)</mo></mrow></msubsup><mo id="S4.SS1.p13.9.m9.5.5.2" xref="S4.SS1.p13.9.m9.5.5.2.cmml">∈</mo><mrow id="S4.SS1.p13.9.m9.5.5.1.1" xref="S4.SS1.p13.9.m9.5.5.1.2.cmml"><mo id="S4.SS1.p13.9.m9.5.5.1.1.2" stretchy="false" xref="S4.SS1.p13.9.m9.5.5.1.2.cmml">{</mo><mn id="S4.SS1.p13.9.m9.2.2" xref="S4.SS1.p13.9.m9.2.2.cmml">1</mn><mo id="S4.SS1.p13.9.m9.5.5.1.1.3" xref="S4.SS1.p13.9.m9.5.5.1.2.cmml">,</mo><mn id="S4.SS1.p13.9.m9.3.3" xref="S4.SS1.p13.9.m9.3.3.cmml">2</mn><mo id="S4.SS1.p13.9.m9.5.5.1.1.4" xref="S4.SS1.p13.9.m9.5.5.1.2.cmml">,</mo><mi id="S4.SS1.p13.9.m9.4.4" mathvariant="normal" xref="S4.SS1.p13.9.m9.4.4.cmml">…</mi><mo id="S4.SS1.p13.9.m9.5.5.1.1.5" xref="S4.SS1.p13.9.m9.5.5.1.2.cmml">,</mo><mrow id="S4.SS1.p13.9.m9.5.5.1.1.1.1" xref="S4.SS1.p13.9.m9.5.5.1.1.1.2.cmml"><mo id="S4.SS1.p13.9.m9.5.5.1.1.1.1.2" stretchy="false" xref="S4.SS1.p13.9.m9.5.5.1.1.1.2.1.cmml">|</mo><msub id="S4.SS1.p13.9.m9.5.5.1.1.1.1.1" xref="S4.SS1.p13.9.m9.5.5.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p13.9.m9.5.5.1.1.1.1.1.2" xref="S4.SS1.p13.9.m9.5.5.1.1.1.1.1.2.cmml">𝒞</mi><mi id="S4.SS1.p13.9.m9.5.5.1.1.1.1.1.3" xref="S4.SS1.p13.9.m9.5.5.1.1.1.1.1.3.cmml">m</mi></msub><mo id="S4.SS1.p13.9.m9.5.5.1.1.1.1.3" stretchy="false" xref="S4.SS1.p13.9.m9.5.5.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.SS1.p13.9.m9.5.5.1.1.6" stretchy="false" xref="S4.SS1.p13.9.m9.5.5.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p13.9.m9.5b"><apply id="S4.SS1.p13.9.m9.5.5.cmml" xref="S4.SS1.p13.9.m9.5.5"><in id="S4.SS1.p13.9.m9.5.5.2.cmml" xref="S4.SS1.p13.9.m9.5.5.2"></in><apply id="S4.SS1.p13.9.m9.5.5.3.cmml" xref="S4.SS1.p13.9.m9.5.5.3"><csymbol cd="ambiguous" id="S4.SS1.p13.9.m9.5.5.3.1.cmml" xref="S4.SS1.p13.9.m9.5.5.3">subscript</csymbol><apply id="S4.SS1.p13.9.m9.5.5.3.2.cmml" xref="S4.SS1.p13.9.m9.5.5.3"><csymbol cd="ambiguous" id="S4.SS1.p13.9.m9.5.5.3.2.1.cmml" xref="S4.SS1.p13.9.m9.5.5.3">superscript</csymbol><ci id="S4.SS1.p13.9.m9.5.5.3.2.2.cmml" xref="S4.SS1.p13.9.m9.5.5.3.2.2">𝑐</ci><ci id="S4.SS1.p13.9.m9.1.1.1.1.cmml" xref="S4.SS1.p13.9.m9.1.1.1.1">𝑚</ci></apply><ci id="S4.SS1.p13.9.m9.5.5.3.3.cmml" xref="S4.SS1.p13.9.m9.5.5.3.3">𝑖</ci></apply><set id="S4.SS1.p13.9.m9.5.5.1.2.cmml" xref="S4.SS1.p13.9.m9.5.5.1.1"><cn id="S4.SS1.p13.9.m9.2.2.cmml" type="integer" xref="S4.SS1.p13.9.m9.2.2">1</cn><cn id="S4.SS1.p13.9.m9.3.3.cmml" type="integer" xref="S4.SS1.p13.9.m9.3.3">2</cn><ci id="S4.SS1.p13.9.m9.4.4.cmml" xref="S4.SS1.p13.9.m9.4.4">…</ci><apply id="S4.SS1.p13.9.m9.5.5.1.1.1.2.cmml" xref="S4.SS1.p13.9.m9.5.5.1.1.1.1"><abs id="S4.SS1.p13.9.m9.5.5.1.1.1.2.1.cmml" xref="S4.SS1.p13.9.m9.5.5.1.1.1.1.2"></abs><apply id="S4.SS1.p13.9.m9.5.5.1.1.1.1.1.cmml" xref="S4.SS1.p13.9.m9.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p13.9.m9.5.5.1.1.1.1.1.1.cmml" xref="S4.SS1.p13.9.m9.5.5.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p13.9.m9.5.5.1.1.1.1.1.2.cmml" xref="S4.SS1.p13.9.m9.5.5.1.1.1.1.1.2">𝒞</ci><ci id="S4.SS1.p13.9.m9.5.5.1.1.1.1.1.3.cmml" xref="S4.SS1.p13.9.m9.5.5.1.1.1.1.1.3">𝑚</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p13.9.m9.5c">c^{(m)}_{i}\in\{1,2,…,|\mathcal{C}_{m}|\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p13.9.m9.5d">italic_c start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ { 1 , 2 , … , | caligraphic_C start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT | }</annotation></semantics></math>. The cardinality of each dimension <math alttext="|\mathcal{C}_{m}|" class="ltx_Math" display="inline" id="S4.SS1.p13.10.m10.1"><semantics id="S4.SS1.p13.10.m10.1a"><mrow id="S4.SS1.p13.10.m10.1.1.1" xref="S4.SS1.p13.10.m10.1.1.2.cmml"><mo id="S4.SS1.p13.10.m10.1.1.1.2" stretchy="false" xref="S4.SS1.p13.10.m10.1.1.2.1.cmml">|</mo><msub id="S4.SS1.p13.10.m10.1.1.1.1" xref="S4.SS1.p13.10.m10.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p13.10.m10.1.1.1.1.2" xref="S4.SS1.p13.10.m10.1.1.1.1.2.cmml">𝒞</mi><mi id="S4.SS1.p13.10.m10.1.1.1.1.3" xref="S4.SS1.p13.10.m10.1.1.1.1.3.cmml">m</mi></msub><mo id="S4.SS1.p13.10.m10.1.1.1.3" stretchy="false" xref="S4.SS1.p13.10.m10.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p13.10.m10.1b"><apply id="S4.SS1.p13.10.m10.1.1.2.cmml" xref="S4.SS1.p13.10.m10.1.1.1"><abs id="S4.SS1.p13.10.m10.1.1.2.1.cmml" xref="S4.SS1.p13.10.m10.1.1.1.2"></abs><apply id="S4.SS1.p13.10.m10.1.1.1.1.cmml" xref="S4.SS1.p13.10.m10.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p13.10.m10.1.1.1.1.1.cmml" xref="S4.SS1.p13.10.m10.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p13.10.m10.1.1.1.1.2.cmml" xref="S4.SS1.p13.10.m10.1.1.1.1.2">𝒞</ci><ci id="S4.SS1.p13.10.m10.1.1.1.1.3.cmml" xref="S4.SS1.p13.10.m10.1.1.1.1.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p13.10.m10.1c">|\mathcal{C}_{m}|</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p13.10.m10.1d">| caligraphic_C start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT |</annotation></semantics></math> is set to 512. To generate the synthetic dataset with extremely long sequence <math alttext="L=10,000" class="ltx_Math" display="inline" id="S4.SS1.p13.11.m11.2"><semantics id="S4.SS1.p13.11.m11.2a"><mrow id="S4.SS1.p13.11.m11.2.3" xref="S4.SS1.p13.11.m11.2.3.cmml"><mi id="S4.SS1.p13.11.m11.2.3.2" xref="S4.SS1.p13.11.m11.2.3.2.cmml">L</mi><mo id="S4.SS1.p13.11.m11.2.3.1" xref="S4.SS1.p13.11.m11.2.3.1.cmml">=</mo><mrow id="S4.SS1.p13.11.m11.2.3.3.2" xref="S4.SS1.p13.11.m11.2.3.3.1.cmml"><mn id="S4.SS1.p13.11.m11.1.1" xref="S4.SS1.p13.11.m11.1.1.cmml">10</mn><mo id="S4.SS1.p13.11.m11.2.3.3.2.1" xref="S4.SS1.p13.11.m11.2.3.3.1.cmml">,</mo><mn id="S4.SS1.p13.11.m11.2.2" xref="S4.SS1.p13.11.m11.2.2.cmml">000</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p13.11.m11.2b"><apply id="S4.SS1.p13.11.m11.2.3.cmml" xref="S4.SS1.p13.11.m11.2.3"><eq id="S4.SS1.p13.11.m11.2.3.1.cmml" xref="S4.SS1.p13.11.m11.2.3.1"></eq><ci id="S4.SS1.p13.11.m11.2.3.2.cmml" xref="S4.SS1.p13.11.m11.2.3.2">𝐿</ci><list id="S4.SS1.p13.11.m11.2.3.3.1.cmml" xref="S4.SS1.p13.11.m11.2.3.3.2"><cn id="S4.SS1.p13.11.m11.1.1.cmml" type="integer" xref="S4.SS1.p13.11.m11.1.1">10</cn><cn id="S4.SS1.p13.11.m11.2.2.cmml" type="integer" xref="S4.SS1.p13.11.m11.2.2">000</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p13.11.m11.2c">L=10,000</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p13.11.m11.2d">italic_L = 10 , 000</annotation></semantics></math>, We generate multi-modal embedding of sequence with different norm values across modals as normally distributed variables <math alttext="N(\mu,\sigma^{2})" class="ltx_Math" display="inline" id="S4.SS1.p13.12.m12.2"><semantics id="S4.SS1.p13.12.m12.2a"><mrow id="S4.SS1.p13.12.m12.2.2" xref="S4.SS1.p13.12.m12.2.2.cmml"><mi id="S4.SS1.p13.12.m12.2.2.3" xref="S4.SS1.p13.12.m12.2.2.3.cmml">N</mi><mo id="S4.SS1.p13.12.m12.2.2.2" xref="S4.SS1.p13.12.m12.2.2.2.cmml">⁢</mo><mrow id="S4.SS1.p13.12.m12.2.2.1.1" xref="S4.SS1.p13.12.m12.2.2.1.2.cmml"><mo id="S4.SS1.p13.12.m12.2.2.1.1.2" stretchy="false" xref="S4.SS1.p13.12.m12.2.2.1.2.cmml">(</mo><mi id="S4.SS1.p13.12.m12.1.1" xref="S4.SS1.p13.12.m12.1.1.cmml">μ</mi><mo id="S4.SS1.p13.12.m12.2.2.1.1.3" xref="S4.SS1.p13.12.m12.2.2.1.2.cmml">,</mo><msup id="S4.SS1.p13.12.m12.2.2.1.1.1" xref="S4.SS1.p13.12.m12.2.2.1.1.1.cmml"><mi id="S4.SS1.p13.12.m12.2.2.1.1.1.2" xref="S4.SS1.p13.12.m12.2.2.1.1.1.2.cmml">σ</mi><mn id="S4.SS1.p13.12.m12.2.2.1.1.1.3" xref="S4.SS1.p13.12.m12.2.2.1.1.1.3.cmml">2</mn></msup><mo id="S4.SS1.p13.12.m12.2.2.1.1.4" stretchy="false" xref="S4.SS1.p13.12.m12.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p13.12.m12.2b"><apply id="S4.SS1.p13.12.m12.2.2.cmml" xref="S4.SS1.p13.12.m12.2.2"><times id="S4.SS1.p13.12.m12.2.2.2.cmml" xref="S4.SS1.p13.12.m12.2.2.2"></times><ci id="S4.SS1.p13.12.m12.2.2.3.cmml" xref="S4.SS1.p13.12.m12.2.2.3">𝑁</ci><interval closure="open" id="S4.SS1.p13.12.m12.2.2.1.2.cmml" xref="S4.SS1.p13.12.m12.2.2.1.1"><ci id="S4.SS1.p13.12.m12.1.1.cmml" xref="S4.SS1.p13.12.m12.1.1">𝜇</ci><apply id="S4.SS1.p13.12.m12.2.2.1.1.1.cmml" xref="S4.SS1.p13.12.m12.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p13.12.m12.2.2.1.1.1.1.cmml" xref="S4.SS1.p13.12.m12.2.2.1.1.1">superscript</csymbol><ci id="S4.SS1.p13.12.m12.2.2.1.1.1.2.cmml" xref="S4.SS1.p13.12.m12.2.2.1.1.1.2">𝜎</ci><cn id="S4.SS1.p13.12.m12.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS1.p13.12.m12.2.2.1.1.1.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p13.12.m12.2c">N(\mu,\sigma^{2})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p13.12.m12.2d">italic_N ( italic_μ , italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>. We set <math alttext="\mu=0.25,0.5,1.0,2.0" class="ltx_Math" display="inline" id="S4.SS1.p13.13.m13.4"><semantics id="S4.SS1.p13.13.m13.4a"><mrow id="S4.SS1.p13.13.m13.4.5" xref="S4.SS1.p13.13.m13.4.5.cmml"><mi id="S4.SS1.p13.13.m13.4.5.2" xref="S4.SS1.p13.13.m13.4.5.2.cmml">μ</mi><mo id="S4.SS1.p13.13.m13.4.5.1" xref="S4.SS1.p13.13.m13.4.5.1.cmml">=</mo><mrow id="S4.SS1.p13.13.m13.4.5.3.2" xref="S4.SS1.p13.13.m13.4.5.3.1.cmml"><mn id="S4.SS1.p13.13.m13.1.1" xref="S4.SS1.p13.13.m13.1.1.cmml">0.25</mn><mo id="S4.SS1.p13.13.m13.4.5.3.2.1" xref="S4.SS1.p13.13.m13.4.5.3.1.cmml">,</mo><mn id="S4.SS1.p13.13.m13.2.2" xref="S4.SS1.p13.13.m13.2.2.cmml">0.5</mn><mo id="S4.SS1.p13.13.m13.4.5.3.2.2" xref="S4.SS1.p13.13.m13.4.5.3.1.cmml">,</mo><mn id="S4.SS1.p13.13.m13.3.3" xref="S4.SS1.p13.13.m13.3.3.cmml">1.0</mn><mo id="S4.SS1.p13.13.m13.4.5.3.2.3" xref="S4.SS1.p13.13.m13.4.5.3.1.cmml">,</mo><mn id="S4.SS1.p13.13.m13.4.4" xref="S4.SS1.p13.13.m13.4.4.cmml">2.0</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p13.13.m13.4b"><apply id="S4.SS1.p13.13.m13.4.5.cmml" xref="S4.SS1.p13.13.m13.4.5"><eq id="S4.SS1.p13.13.m13.4.5.1.cmml" xref="S4.SS1.p13.13.m13.4.5.1"></eq><ci id="S4.SS1.p13.13.m13.4.5.2.cmml" xref="S4.SS1.p13.13.m13.4.5.2">𝜇</ci><list id="S4.SS1.p13.13.m13.4.5.3.1.cmml" xref="S4.SS1.p13.13.m13.4.5.3.2"><cn id="S4.SS1.p13.13.m13.1.1.cmml" type="float" xref="S4.SS1.p13.13.m13.1.1">0.25</cn><cn id="S4.SS1.p13.13.m13.2.2.cmml" type="float" xref="S4.SS1.p13.13.m13.2.2">0.5</cn><cn id="S4.SS1.p13.13.m13.3.3.cmml" type="float" xref="S4.SS1.p13.13.m13.3.3">1.0</cn><cn id="S4.SS1.p13.13.m13.4.4.cmml" type="float" xref="S4.SS1.p13.13.m13.4.4">2.0</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p13.13.m13.4c">\mu=0.25,0.5,1.0,2.0</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p13.13.m13.4d">italic_μ = 0.25 , 0.5 , 1.0 , 2.0</annotation></semantics></math> and <math alttext="\sigma=1.0" class="ltx_Math" display="inline" id="S4.SS1.p13.14.m14.1"><semantics id="S4.SS1.p13.14.m14.1a"><mrow id="S4.SS1.p13.14.m14.1.1" xref="S4.SS1.p13.14.m14.1.1.cmml"><mi id="S4.SS1.p13.14.m14.1.1.2" xref="S4.SS1.p13.14.m14.1.1.2.cmml">σ</mi><mo id="S4.SS1.p13.14.m14.1.1.1" xref="S4.SS1.p13.14.m14.1.1.1.cmml">=</mo><mn id="S4.SS1.p13.14.m14.1.1.3" xref="S4.SS1.p13.14.m14.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p13.14.m14.1b"><apply id="S4.SS1.p13.14.m14.1.1.cmml" xref="S4.SS1.p13.14.m14.1.1"><eq id="S4.SS1.p13.14.m14.1.1.1.cmml" xref="S4.SS1.p13.14.m14.1.1.1"></eq><ci id="S4.SS1.p13.14.m14.1.1.2.cmml" xref="S4.SS1.p13.14.m14.1.1.2">𝜎</ci><cn id="S4.SS1.p13.14.m14.1.1.3.cmml" type="float" xref="S4.SS1.p13.14.m14.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p13.14.m14.1c">\sigma=1.0</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p13.14.m14.1d">italic_σ = 1.0</annotation></semantics></math> to query, attribute, text and image modals respectively. To investigate the influence of different fusion weight <math alttext="\gamma_{m}" class="ltx_Math" display="inline" id="S4.SS1.p13.15.m15.1"><semantics id="S4.SS1.p13.15.m15.1a"><msub id="S4.SS1.p13.15.m15.1.1" xref="S4.SS1.p13.15.m15.1.1.cmml"><mi id="S4.SS1.p13.15.m15.1.1.2" xref="S4.SS1.p13.15.m15.1.1.2.cmml">γ</mi><mi id="S4.SS1.p13.15.m15.1.1.3" xref="S4.SS1.p13.15.m15.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p13.15.m15.1b"><apply id="S4.SS1.p13.15.m15.1.1.cmml" xref="S4.SS1.p13.15.m15.1.1"><csymbol cd="ambiguous" id="S4.SS1.p13.15.m15.1.1.1.cmml" xref="S4.SS1.p13.15.m15.1.1">subscript</csymbol><ci id="S4.SS1.p13.15.m15.1.1.2.cmml" xref="S4.SS1.p13.15.m15.1.1.2">𝛾</ci><ci id="S4.SS1.p13.15.m15.1.1.3.cmml" xref="S4.SS1.p13.15.m15.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p13.15.m15.1c">\gamma_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p13.15.m15.1d">italic_γ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> of multi-modal embedding, we conduct different experiments of equal weights <math alttext="\gamma_{m}=[0.25,0.25,0.25,0.25]" class="ltx_Math" display="inline" id="S4.SS1.p13.16.m16.4"><semantics id="S4.SS1.p13.16.m16.4a"><mrow id="S4.SS1.p13.16.m16.4.5" xref="S4.SS1.p13.16.m16.4.5.cmml"><msub id="S4.SS1.p13.16.m16.4.5.2" xref="S4.SS1.p13.16.m16.4.5.2.cmml"><mi id="S4.SS1.p13.16.m16.4.5.2.2" xref="S4.SS1.p13.16.m16.4.5.2.2.cmml">γ</mi><mi id="S4.SS1.p13.16.m16.4.5.2.3" xref="S4.SS1.p13.16.m16.4.5.2.3.cmml">m</mi></msub><mo id="S4.SS1.p13.16.m16.4.5.1" xref="S4.SS1.p13.16.m16.4.5.1.cmml">=</mo><mrow id="S4.SS1.p13.16.m16.4.5.3.2" xref="S4.SS1.p13.16.m16.4.5.3.1.cmml"><mo id="S4.SS1.p13.16.m16.4.5.3.2.1" stretchy="false" xref="S4.SS1.p13.16.m16.4.5.3.1.cmml">[</mo><mn id="S4.SS1.p13.16.m16.1.1" xref="S4.SS1.p13.16.m16.1.1.cmml">0.25</mn><mo id="S4.SS1.p13.16.m16.4.5.3.2.2" xref="S4.SS1.p13.16.m16.4.5.3.1.cmml">,</mo><mn id="S4.SS1.p13.16.m16.2.2" xref="S4.SS1.p13.16.m16.2.2.cmml">0.25</mn><mo id="S4.SS1.p13.16.m16.4.5.3.2.3" xref="S4.SS1.p13.16.m16.4.5.3.1.cmml">,</mo><mn id="S4.SS1.p13.16.m16.3.3" xref="S4.SS1.p13.16.m16.3.3.cmml">0.25</mn><mo id="S4.SS1.p13.16.m16.4.5.3.2.4" xref="S4.SS1.p13.16.m16.4.5.3.1.cmml">,</mo><mn id="S4.SS1.p13.16.m16.4.4" xref="S4.SS1.p13.16.m16.4.4.cmml">0.25</mn><mo id="S4.SS1.p13.16.m16.4.5.3.2.5" stretchy="false" xref="S4.SS1.p13.16.m16.4.5.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p13.16.m16.4b"><apply id="S4.SS1.p13.16.m16.4.5.cmml" xref="S4.SS1.p13.16.m16.4.5"><eq id="S4.SS1.p13.16.m16.4.5.1.cmml" xref="S4.SS1.p13.16.m16.4.5.1"></eq><apply id="S4.SS1.p13.16.m16.4.5.2.cmml" xref="S4.SS1.p13.16.m16.4.5.2"><csymbol cd="ambiguous" id="S4.SS1.p13.16.m16.4.5.2.1.cmml" xref="S4.SS1.p13.16.m16.4.5.2">subscript</csymbol><ci id="S4.SS1.p13.16.m16.4.5.2.2.cmml" xref="S4.SS1.p13.16.m16.4.5.2.2">𝛾</ci><ci id="S4.SS1.p13.16.m16.4.5.2.3.cmml" xref="S4.SS1.p13.16.m16.4.5.2.3">𝑚</ci></apply><list id="S4.SS1.p13.16.m16.4.5.3.1.cmml" xref="S4.SS1.p13.16.m16.4.5.3.2"><cn id="S4.SS1.p13.16.m16.1.1.cmml" type="float" xref="S4.SS1.p13.16.m16.1.1">0.25</cn><cn id="S4.SS1.p13.16.m16.2.2.cmml" type="float" xref="S4.SS1.p13.16.m16.2.2">0.25</cn><cn id="S4.SS1.p13.16.m16.3.3.cmml" type="float" xref="S4.SS1.p13.16.m16.3.3">0.25</cn><cn id="S4.SS1.p13.16.m16.4.4.cmml" type="float" xref="S4.SS1.p13.16.m16.4.4">0.25</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p13.16.m16.4c">\gamma_{m}=[0.25,0.25,0.25,0.25]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p13.16.m16.4d">italic_γ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = [ 0.25 , 0.25 , 0.25 , 0.25 ]</annotation></semantics></math> and different weights <math alttext="\gamma_{m}=[0.1,0.2,0.3,0.4]" class="ltx_Math" display="inline" id="S4.SS1.p13.17.m17.4"><semantics id="S4.SS1.p13.17.m17.4a"><mrow id="S4.SS1.p13.17.m17.4.5" xref="S4.SS1.p13.17.m17.4.5.cmml"><msub id="S4.SS1.p13.17.m17.4.5.2" xref="S4.SS1.p13.17.m17.4.5.2.cmml"><mi id="S4.SS1.p13.17.m17.4.5.2.2" xref="S4.SS1.p13.17.m17.4.5.2.2.cmml">γ</mi><mi id="S4.SS1.p13.17.m17.4.5.2.3" xref="S4.SS1.p13.17.m17.4.5.2.3.cmml">m</mi></msub><mo id="S4.SS1.p13.17.m17.4.5.1" xref="S4.SS1.p13.17.m17.4.5.1.cmml">=</mo><mrow id="S4.SS1.p13.17.m17.4.5.3.2" xref="S4.SS1.p13.17.m17.4.5.3.1.cmml"><mo id="S4.SS1.p13.17.m17.4.5.3.2.1" stretchy="false" xref="S4.SS1.p13.17.m17.4.5.3.1.cmml">[</mo><mn id="S4.SS1.p13.17.m17.1.1" xref="S4.SS1.p13.17.m17.1.1.cmml">0.1</mn><mo id="S4.SS1.p13.17.m17.4.5.3.2.2" xref="S4.SS1.p13.17.m17.4.5.3.1.cmml">,</mo><mn id="S4.SS1.p13.17.m17.2.2" xref="S4.SS1.p13.17.m17.2.2.cmml">0.2</mn><mo id="S4.SS1.p13.17.m17.4.5.3.2.3" xref="S4.SS1.p13.17.m17.4.5.3.1.cmml">,</mo><mn id="S4.SS1.p13.17.m17.3.3" xref="S4.SS1.p13.17.m17.3.3.cmml">0.3</mn><mo id="S4.SS1.p13.17.m17.4.5.3.2.4" xref="S4.SS1.p13.17.m17.4.5.3.1.cmml">,</mo><mn id="S4.SS1.p13.17.m17.4.4" xref="S4.SS1.p13.17.m17.4.4.cmml">0.4</mn><mo id="S4.SS1.p13.17.m17.4.5.3.2.5" stretchy="false" xref="S4.SS1.p13.17.m17.4.5.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p13.17.m17.4b"><apply id="S4.SS1.p13.17.m17.4.5.cmml" xref="S4.SS1.p13.17.m17.4.5"><eq id="S4.SS1.p13.17.m17.4.5.1.cmml" xref="S4.SS1.p13.17.m17.4.5.1"></eq><apply id="S4.SS1.p13.17.m17.4.5.2.cmml" xref="S4.SS1.p13.17.m17.4.5.2"><csymbol cd="ambiguous" id="S4.SS1.p13.17.m17.4.5.2.1.cmml" xref="S4.SS1.p13.17.m17.4.5.2">subscript</csymbol><ci id="S4.SS1.p13.17.m17.4.5.2.2.cmml" xref="S4.SS1.p13.17.m17.4.5.2.2">𝛾</ci><ci id="S4.SS1.p13.17.m17.4.5.2.3.cmml" xref="S4.SS1.p13.17.m17.4.5.2.3">𝑚</ci></apply><list id="S4.SS1.p13.17.m17.4.5.3.1.cmml" xref="S4.SS1.p13.17.m17.4.5.3.2"><cn id="S4.SS1.p13.17.m17.1.1.cmml" type="float" xref="S4.SS1.p13.17.m17.1.1">0.1</cn><cn id="S4.SS1.p13.17.m17.2.2.cmml" type="float" xref="S4.SS1.p13.17.m17.2.2">0.2</cn><cn id="S4.SS1.p13.17.m17.3.3.cmml" type="float" xref="S4.SS1.p13.17.m17.3.3">0.3</cn><cn id="S4.SS1.p13.17.m17.4.4.cmml" type="float" xref="S4.SS1.p13.17.m17.4.4">0.4</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p13.17.m17.4c">\gamma_{m}=[0.1,0.2,0.3,0.4]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p13.17.m17.4d">italic_γ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = [ 0.1 , 0.2 , 0.3 , 0.4 ]</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Experimental Results</h3>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="612" id="S4.F2.g1" src="x2.png" width="996"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2. </span><span class="ltx_text ltx_markedasmath" id="S4.F2.16.1">Recall@K</span> Evaluation of Different Approximate Fast Retrieval Methods on Synthetic Dataset of the Multi-Modal Lifelong Sequence. Plots in the first row denote the group of same norm <math alttext="|x^{(m)}|" class="ltx_Math" display="inline" id="S4.F2.9.m2.2"><semantics id="S4.F2.9.m2.2b"><mrow id="S4.F2.9.m2.2.2.1" xref="S4.F2.9.m2.2.2.2.cmml"><mo id="S4.F2.9.m2.2.2.1.2" stretchy="false" xref="S4.F2.9.m2.2.2.2.1.cmml">|</mo><msup id="S4.F2.9.m2.2.2.1.1" xref="S4.F2.9.m2.2.2.1.1.cmml"><mi id="S4.F2.9.m2.2.2.1.1.2" xref="S4.F2.9.m2.2.2.1.1.2.cmml">x</mi><mrow id="S4.F2.9.m2.1.1.1.3" xref="S4.F2.9.m2.2.2.1.1.cmml"><mo id="S4.F2.9.m2.1.1.1.3.1" stretchy="false" xref="S4.F2.9.m2.2.2.1.1.cmml">(</mo><mi id="S4.F2.9.m2.1.1.1.1" xref="S4.F2.9.m2.1.1.1.1.cmml">m</mi><mo id="S4.F2.9.m2.1.1.1.3.2" stretchy="false" xref="S4.F2.9.m2.2.2.1.1.cmml">)</mo></mrow></msup><mo id="S4.F2.9.m2.2.2.1.3" stretchy="false" xref="S4.F2.9.m2.2.2.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.9.m2.2c"><apply id="S4.F2.9.m2.2.2.2.cmml" xref="S4.F2.9.m2.2.2.1"><abs id="S4.F2.9.m2.2.2.2.1.cmml" xref="S4.F2.9.m2.2.2.1.2"></abs><apply id="S4.F2.9.m2.2.2.1.1.cmml" xref="S4.F2.9.m2.2.2.1.1"><csymbol cd="ambiguous" id="S4.F2.9.m2.2.2.1.1.1.cmml" xref="S4.F2.9.m2.2.2.1.1">superscript</csymbol><ci id="S4.F2.9.m2.2.2.1.1.2.cmml" xref="S4.F2.9.m2.2.2.1.1.2">𝑥</ci><ci id="S4.F2.9.m2.1.1.1.1.cmml" xref="S4.F2.9.m2.1.1.1.1">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.9.m2.2d">|x^{(m)}|</annotation><annotation encoding="application/x-llamapun" id="S4.F2.9.m2.2e">| italic_x start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT |</annotation></semantics></math> same weight <math alttext="|\gamma_{m}|" class="ltx_Math" display="inline" id="S4.F2.10.m3.1"><semantics id="S4.F2.10.m3.1b"><mrow id="S4.F2.10.m3.1.1.1" xref="S4.F2.10.m3.1.1.2.cmml"><mo id="S4.F2.10.m3.1.1.1.2" stretchy="false" xref="S4.F2.10.m3.1.1.2.1.cmml">|</mo><msub id="S4.F2.10.m3.1.1.1.1" xref="S4.F2.10.m3.1.1.1.1.cmml"><mi id="S4.F2.10.m3.1.1.1.1.2" xref="S4.F2.10.m3.1.1.1.1.2.cmml">γ</mi><mi id="S4.F2.10.m3.1.1.1.1.3" xref="S4.F2.10.m3.1.1.1.1.3.cmml">m</mi></msub><mo id="S4.F2.10.m3.1.1.1.3" stretchy="false" xref="S4.F2.10.m3.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.10.m3.1c"><apply id="S4.F2.10.m3.1.1.2.cmml" xref="S4.F2.10.m3.1.1.1"><abs id="S4.F2.10.m3.1.1.2.1.cmml" xref="S4.F2.10.m3.1.1.1.2"></abs><apply id="S4.F2.10.m3.1.1.1.1.cmml" xref="S4.F2.10.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.F2.10.m3.1.1.1.1.1.cmml" xref="S4.F2.10.m3.1.1.1.1">subscript</csymbol><ci id="S4.F2.10.m3.1.1.1.1.2.cmml" xref="S4.F2.10.m3.1.1.1.1.2">𝛾</ci><ci id="S4.F2.10.m3.1.1.1.1.3.cmml" xref="S4.F2.10.m3.1.1.1.1.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.10.m3.1d">|\gamma_{m}|</annotation><annotation encoding="application/x-llamapun" id="S4.F2.10.m3.1e">| italic_γ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT |</annotation></semantics></math>, plots in the second row denote the group of different norm <math alttext="|x^{(m)}|" class="ltx_Math" display="inline" id="S4.F2.11.m4.2"><semantics id="S4.F2.11.m4.2b"><mrow id="S4.F2.11.m4.2.2.1" xref="S4.F2.11.m4.2.2.2.cmml"><mo id="S4.F2.11.m4.2.2.1.2" stretchy="false" xref="S4.F2.11.m4.2.2.2.1.cmml">|</mo><msup id="S4.F2.11.m4.2.2.1.1" xref="S4.F2.11.m4.2.2.1.1.cmml"><mi id="S4.F2.11.m4.2.2.1.1.2" xref="S4.F2.11.m4.2.2.1.1.2.cmml">x</mi><mrow id="S4.F2.11.m4.1.1.1.3" xref="S4.F2.11.m4.2.2.1.1.cmml"><mo id="S4.F2.11.m4.1.1.1.3.1" stretchy="false" xref="S4.F2.11.m4.2.2.1.1.cmml">(</mo><mi id="S4.F2.11.m4.1.1.1.1" xref="S4.F2.11.m4.1.1.1.1.cmml">m</mi><mo id="S4.F2.11.m4.1.1.1.3.2" stretchy="false" xref="S4.F2.11.m4.2.2.1.1.cmml">)</mo></mrow></msup><mo id="S4.F2.11.m4.2.2.1.3" stretchy="false" xref="S4.F2.11.m4.2.2.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.11.m4.2c"><apply id="S4.F2.11.m4.2.2.2.cmml" xref="S4.F2.11.m4.2.2.1"><abs id="S4.F2.11.m4.2.2.2.1.cmml" xref="S4.F2.11.m4.2.2.1.2"></abs><apply id="S4.F2.11.m4.2.2.1.1.cmml" xref="S4.F2.11.m4.2.2.1.1"><csymbol cd="ambiguous" id="S4.F2.11.m4.2.2.1.1.1.cmml" xref="S4.F2.11.m4.2.2.1.1">superscript</csymbol><ci id="S4.F2.11.m4.2.2.1.1.2.cmml" xref="S4.F2.11.m4.2.2.1.1.2">𝑥</ci><ci id="S4.F2.11.m4.1.1.1.1.cmml" xref="S4.F2.11.m4.1.1.1.1">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.11.m4.2d">|x^{(m)}|</annotation><annotation encoding="application/x-llamapun" id="S4.F2.11.m4.2e">| italic_x start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT |</annotation></semantics></math> and same weight <math alttext="|\gamma_{m}|" class="ltx_Math" display="inline" id="S4.F2.12.m5.1"><semantics id="S4.F2.12.m5.1b"><mrow id="S4.F2.12.m5.1.1.1" xref="S4.F2.12.m5.1.1.2.cmml"><mo id="S4.F2.12.m5.1.1.1.2" stretchy="false" xref="S4.F2.12.m5.1.1.2.1.cmml">|</mo><msub id="S4.F2.12.m5.1.1.1.1" xref="S4.F2.12.m5.1.1.1.1.cmml"><mi id="S4.F2.12.m5.1.1.1.1.2" xref="S4.F2.12.m5.1.1.1.1.2.cmml">γ</mi><mi id="S4.F2.12.m5.1.1.1.1.3" xref="S4.F2.12.m5.1.1.1.1.3.cmml">m</mi></msub><mo id="S4.F2.12.m5.1.1.1.3" stretchy="false" xref="S4.F2.12.m5.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.12.m5.1c"><apply id="S4.F2.12.m5.1.1.2.cmml" xref="S4.F2.12.m5.1.1.1"><abs id="S4.F2.12.m5.1.1.2.1.cmml" xref="S4.F2.12.m5.1.1.1.2"></abs><apply id="S4.F2.12.m5.1.1.1.1.cmml" xref="S4.F2.12.m5.1.1.1.1"><csymbol cd="ambiguous" id="S4.F2.12.m5.1.1.1.1.1.cmml" xref="S4.F2.12.m5.1.1.1.1">subscript</csymbol><ci id="S4.F2.12.m5.1.1.1.1.2.cmml" xref="S4.F2.12.m5.1.1.1.1.2">𝛾</ci><ci id="S4.F2.12.m5.1.1.1.1.3.cmml" xref="S4.F2.12.m5.1.1.1.1.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.12.m5.1d">|\gamma_{m}|</annotation><annotation encoding="application/x-llamapun" id="S4.F2.12.m5.1e">| italic_γ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT |</annotation></semantics></math>, and plots in the third row denote the group of the same norm <math alttext="|x^{(m)}|" class="ltx_Math" display="inline" id="S4.F2.13.m6.2"><semantics id="S4.F2.13.m6.2b"><mrow id="S4.F2.13.m6.2.2.1" xref="S4.F2.13.m6.2.2.2.cmml"><mo id="S4.F2.13.m6.2.2.1.2" stretchy="false" xref="S4.F2.13.m6.2.2.2.1.cmml">|</mo><msup id="S4.F2.13.m6.2.2.1.1" xref="S4.F2.13.m6.2.2.1.1.cmml"><mi id="S4.F2.13.m6.2.2.1.1.2" xref="S4.F2.13.m6.2.2.1.1.2.cmml">x</mi><mrow id="S4.F2.13.m6.1.1.1.3" xref="S4.F2.13.m6.2.2.1.1.cmml"><mo id="S4.F2.13.m6.1.1.1.3.1" stretchy="false" xref="S4.F2.13.m6.2.2.1.1.cmml">(</mo><mi id="S4.F2.13.m6.1.1.1.1" xref="S4.F2.13.m6.1.1.1.1.cmml">m</mi><mo id="S4.F2.13.m6.1.1.1.3.2" stretchy="false" xref="S4.F2.13.m6.2.2.1.1.cmml">)</mo></mrow></msup><mo id="S4.F2.13.m6.2.2.1.3" stretchy="false" xref="S4.F2.13.m6.2.2.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.13.m6.2c"><apply id="S4.F2.13.m6.2.2.2.cmml" xref="S4.F2.13.m6.2.2.1"><abs id="S4.F2.13.m6.2.2.2.1.cmml" xref="S4.F2.13.m6.2.2.1.2"></abs><apply id="S4.F2.13.m6.2.2.1.1.cmml" xref="S4.F2.13.m6.2.2.1.1"><csymbol cd="ambiguous" id="S4.F2.13.m6.2.2.1.1.1.cmml" xref="S4.F2.13.m6.2.2.1.1">superscript</csymbol><ci id="S4.F2.13.m6.2.2.1.1.2.cmml" xref="S4.F2.13.m6.2.2.1.1.2">𝑥</ci><ci id="S4.F2.13.m6.1.1.1.1.cmml" xref="S4.F2.13.m6.1.1.1.1">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.13.m6.2d">|x^{(m)}|</annotation><annotation encoding="application/x-llamapun" id="S4.F2.13.m6.2e">| italic_x start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT |</annotation></semantics></math> and different weight <math alttext="|\gamma_{m}|" class="ltx_Math" display="inline" id="S4.F2.14.m7.1"><semantics id="S4.F2.14.m7.1b"><mrow id="S4.F2.14.m7.1.1.1" xref="S4.F2.14.m7.1.1.2.cmml"><mo id="S4.F2.14.m7.1.1.1.2" stretchy="false" xref="S4.F2.14.m7.1.1.2.1.cmml">|</mo><msub id="S4.F2.14.m7.1.1.1.1" xref="S4.F2.14.m7.1.1.1.1.cmml"><mi id="S4.F2.14.m7.1.1.1.1.2" xref="S4.F2.14.m7.1.1.1.1.2.cmml">γ</mi><mi id="S4.F2.14.m7.1.1.1.1.3" xref="S4.F2.14.m7.1.1.1.1.3.cmml">m</mi></msub><mo id="S4.F2.14.m7.1.1.1.3" stretchy="false" xref="S4.F2.14.m7.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.14.m7.1c"><apply id="S4.F2.14.m7.1.1.2.cmml" xref="S4.F2.14.m7.1.1.1"><abs id="S4.F2.14.m7.1.1.2.1.cmml" xref="S4.F2.14.m7.1.1.1.2"></abs><apply id="S4.F2.14.m7.1.1.1.1.cmml" xref="S4.F2.14.m7.1.1.1.1"><csymbol cd="ambiguous" id="S4.F2.14.m7.1.1.1.1.1.cmml" xref="S4.F2.14.m7.1.1.1.1">subscript</csymbol><ci id="S4.F2.14.m7.1.1.1.1.2.cmml" xref="S4.F2.14.m7.1.1.1.1.2">𝛾</ci><ci id="S4.F2.14.m7.1.1.1.1.3.cmml" xref="S4.F2.14.m7.1.1.1.1.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.14.m7.1d">|\gamma_{m}|</annotation><annotation encoding="application/x-llamapun" id="S4.F2.14.m7.1e">| italic_γ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT |</annotation></semantics></math>.</figcaption>
</figure>
<section class="ltx_subsubsection" id="S4.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1. </span>Lifelong User Behavior Modeling</h4>
<div class="ltx_para" id="S4.SS2.SSS1.p1">
<p class="ltx_p" id="S4.SS2.SSS1.p1.5">We report the performance on different datasets from multiple domains, including <span class="ltx_text ltx_markedasmath" id="S4.SS2.SSS1.p1.5.1">NDCG@K</span> on KuaiSAR dataset, the Movie and TV subset of the Amazon review dataset and <span class="ltx_text ltx_markedasmath" id="S4.SS2.SSS1.p1.5.2">AUC</span> performance on the Alipay short video recommendation dataset in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S4.T2" title="Table 2 ‣ 4.1. Experimental Settings ‣ 4. Experiment ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>. The asterisk (*) denotes the best performance achieved in each task. We can see that SEMINAR achieved the best performance on the KuaiSAR dataset with improvement of +0.0292, +0.0308, +0.0164 in <math alttext="\text{NDCG@K}=5,10,50" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.3.m3.3"><semantics id="S4.SS2.SSS1.p1.3.m3.3a"><mrow id="S4.SS2.SSS1.p1.3.m3.3.4" xref="S4.SS2.SSS1.p1.3.m3.3.4.cmml"><mtext id="S4.SS2.SSS1.p1.3.m3.3.4.2" xref="S4.SS2.SSS1.p1.3.m3.3.4.2a.cmml">NDCG@K</mtext><mo id="S4.SS2.SSS1.p1.3.m3.3.4.1" xref="S4.SS2.SSS1.p1.3.m3.3.4.1.cmml">=</mo><mrow id="S4.SS2.SSS1.p1.3.m3.3.4.3.2" xref="S4.SS2.SSS1.p1.3.m3.3.4.3.1.cmml"><mn id="S4.SS2.SSS1.p1.3.m3.1.1" xref="S4.SS2.SSS1.p1.3.m3.1.1.cmml">5</mn><mo id="S4.SS2.SSS1.p1.3.m3.3.4.3.2.1" xref="S4.SS2.SSS1.p1.3.m3.3.4.3.1.cmml">,</mo><mn id="S4.SS2.SSS1.p1.3.m3.2.2" xref="S4.SS2.SSS1.p1.3.m3.2.2.cmml">10</mn><mo id="S4.SS2.SSS1.p1.3.m3.3.4.3.2.2" xref="S4.SS2.SSS1.p1.3.m3.3.4.3.1.cmml">,</mo><mn id="S4.SS2.SSS1.p1.3.m3.3.3" xref="S4.SS2.SSS1.p1.3.m3.3.3.cmml">50</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.3.m3.3b"><apply id="S4.SS2.SSS1.p1.3.m3.3.4.cmml" xref="S4.SS2.SSS1.p1.3.m3.3.4"><eq id="S4.SS2.SSS1.p1.3.m3.3.4.1.cmml" xref="S4.SS2.SSS1.p1.3.m3.3.4.1"></eq><ci id="S4.SS2.SSS1.p1.3.m3.3.4.2a.cmml" xref="S4.SS2.SSS1.p1.3.m3.3.4.2"><mtext id="S4.SS2.SSS1.p1.3.m3.3.4.2.cmml" xref="S4.SS2.SSS1.p1.3.m3.3.4.2">NDCG@K</mtext></ci><list id="S4.SS2.SSS1.p1.3.m3.3.4.3.1.cmml" xref="S4.SS2.SSS1.p1.3.m3.3.4.3.2"><cn id="S4.SS2.SSS1.p1.3.m3.1.1.cmml" type="integer" xref="S4.SS2.SSS1.p1.3.m3.1.1">5</cn><cn id="S4.SS2.SSS1.p1.3.m3.2.2.cmml" type="integer" xref="S4.SS2.SSS1.p1.3.m3.2.2">10</cn><cn id="S4.SS2.SSS1.p1.3.m3.3.3.cmml" type="integer" xref="S4.SS2.SSS1.p1.3.m3.3.3">50</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.3.m3.3c">\text{NDCG@K}=5,10,50</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.3.m3.3d">NDCG@K = 5 , 10 , 50</annotation></semantics></math> and improvement of +0.0088, +0.0082, +0.0059 in <math alttext="\text{NDCG@K}=5,10,50" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.4.m4.3"><semantics id="S4.SS2.SSS1.p1.4.m4.3a"><mrow id="S4.SS2.SSS1.p1.4.m4.3.4" xref="S4.SS2.SSS1.p1.4.m4.3.4.cmml"><mtext id="S4.SS2.SSS1.p1.4.m4.3.4.2" xref="S4.SS2.SSS1.p1.4.m4.3.4.2a.cmml">NDCG@K</mtext><mo id="S4.SS2.SSS1.p1.4.m4.3.4.1" xref="S4.SS2.SSS1.p1.4.m4.3.4.1.cmml">=</mo><mrow id="S4.SS2.SSS1.p1.4.m4.3.4.3.2" xref="S4.SS2.SSS1.p1.4.m4.3.4.3.1.cmml"><mn id="S4.SS2.SSS1.p1.4.m4.1.1" xref="S4.SS2.SSS1.p1.4.m4.1.1.cmml">5</mn><mo id="S4.SS2.SSS1.p1.4.m4.3.4.3.2.1" xref="S4.SS2.SSS1.p1.4.m4.3.4.3.1.cmml">,</mo><mn id="S4.SS2.SSS1.p1.4.m4.2.2" xref="S4.SS2.SSS1.p1.4.m4.2.2.cmml">10</mn><mo id="S4.SS2.SSS1.p1.4.m4.3.4.3.2.2" xref="S4.SS2.SSS1.p1.4.m4.3.4.3.1.cmml">,</mo><mn id="S4.SS2.SSS1.p1.4.m4.3.3" xref="S4.SS2.SSS1.p1.4.m4.3.3.cmml">50</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.4.m4.3b"><apply id="S4.SS2.SSS1.p1.4.m4.3.4.cmml" xref="S4.SS2.SSS1.p1.4.m4.3.4"><eq id="S4.SS2.SSS1.p1.4.m4.3.4.1.cmml" xref="S4.SS2.SSS1.p1.4.m4.3.4.1"></eq><ci id="S4.SS2.SSS1.p1.4.m4.3.4.2a.cmml" xref="S4.SS2.SSS1.p1.4.m4.3.4.2"><mtext id="S4.SS2.SSS1.p1.4.m4.3.4.2.cmml" xref="S4.SS2.SSS1.p1.4.m4.3.4.2">NDCG@K</mtext></ci><list id="S4.SS2.SSS1.p1.4.m4.3.4.3.1.cmml" xref="S4.SS2.SSS1.p1.4.m4.3.4.3.2"><cn id="S4.SS2.SSS1.p1.4.m4.1.1.cmml" type="integer" xref="S4.SS2.SSS1.p1.4.m4.1.1">5</cn><cn id="S4.SS2.SSS1.p1.4.m4.2.2.cmml" type="integer" xref="S4.SS2.SSS1.p1.4.m4.2.2">10</cn><cn id="S4.SS2.SSS1.p1.4.m4.3.3.cmml" type="integer" xref="S4.SS2.SSS1.p1.4.m4.3.3">50</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.4.m4.3c">\text{NDCG@K}=5,10,50</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.4.m4.3d">NDCG@K = 5 , 10 , 50</annotation></semantics></math> on Amazon dataset compared to SIM. Additionally, SEMINAR also achieved the best <span class="ltx_text ltx_markedasmath" id="S4.SS2.SSS1.p1.5.3">AUC</span> performance on the Alipay short video recommendation dataset with improvement of +0.0264 compared to multiple strong SOTA baselines.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2. </span>Multi-Modal Query-Item Pairs Approximate Retrieval</h4>
<div class="ltx_para" id="S4.SS2.SSS2.p1">
<p class="ltx_p" id="S4.SS2.SSS2.p1.16">To compare multi-modal query-item approximate retrieval methods, we report the <span class="ltx_text ltx_markedasmath" id="S4.SS2.SSS2.p1.16.1">Recall@K</span> performance of the industrial Alipay Short Video dataset in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S4.T4" title="Table 4 ‣ 4.1. Experimental Settings ‣ 4. Experiment ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> and the performance of the synthetic dataset in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S4.F2" title="Figure 2 ‣ 4.2. Experimental Results ‣ 4. Experiment ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>.
From the result of Alipay Short Video dataset, we observe that our proposed Multi-Modal Product Quantization strategy achieves the highest <span class="ltx_text ltx_markedasmath" id="S4.SS2.SSS2.p1.16.2">Recall@K</span> compared to other approximation methods under different values of <math alttext="K=[32,64,128,256]" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.3.m3.4"><semantics id="S4.SS2.SSS2.p1.3.m3.4a"><mrow id="S4.SS2.SSS2.p1.3.m3.4.5" xref="S4.SS2.SSS2.p1.3.m3.4.5.cmml"><mi id="S4.SS2.SSS2.p1.3.m3.4.5.2" xref="S4.SS2.SSS2.p1.3.m3.4.5.2.cmml">K</mi><mo id="S4.SS2.SSS2.p1.3.m3.4.5.1" xref="S4.SS2.SSS2.p1.3.m3.4.5.1.cmml">=</mo><mrow id="S4.SS2.SSS2.p1.3.m3.4.5.3.2" xref="S4.SS2.SSS2.p1.3.m3.4.5.3.1.cmml"><mo id="S4.SS2.SSS2.p1.3.m3.4.5.3.2.1" stretchy="false" xref="S4.SS2.SSS2.p1.3.m3.4.5.3.1.cmml">[</mo><mn id="S4.SS2.SSS2.p1.3.m3.1.1" xref="S4.SS2.SSS2.p1.3.m3.1.1.cmml">32</mn><mo id="S4.SS2.SSS2.p1.3.m3.4.5.3.2.2" xref="S4.SS2.SSS2.p1.3.m3.4.5.3.1.cmml">,</mo><mn id="S4.SS2.SSS2.p1.3.m3.2.2" xref="S4.SS2.SSS2.p1.3.m3.2.2.cmml">64</mn><mo id="S4.SS2.SSS2.p1.3.m3.4.5.3.2.3" xref="S4.SS2.SSS2.p1.3.m3.4.5.3.1.cmml">,</mo><mn id="S4.SS2.SSS2.p1.3.m3.3.3" xref="S4.SS2.SSS2.p1.3.m3.3.3.cmml">128</mn><mo id="S4.SS2.SSS2.p1.3.m3.4.5.3.2.4" xref="S4.SS2.SSS2.p1.3.m3.4.5.3.1.cmml">,</mo><mn id="S4.SS2.SSS2.p1.3.m3.4.4" xref="S4.SS2.SSS2.p1.3.m3.4.4.cmml">256</mn><mo id="S4.SS2.SSS2.p1.3.m3.4.5.3.2.5" stretchy="false" xref="S4.SS2.SSS2.p1.3.m3.4.5.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.3.m3.4b"><apply id="S4.SS2.SSS2.p1.3.m3.4.5.cmml" xref="S4.SS2.SSS2.p1.3.m3.4.5"><eq id="S4.SS2.SSS2.p1.3.m3.4.5.1.cmml" xref="S4.SS2.SSS2.p1.3.m3.4.5.1"></eq><ci id="S4.SS2.SSS2.p1.3.m3.4.5.2.cmml" xref="S4.SS2.SSS2.p1.3.m3.4.5.2">𝐾</ci><list id="S4.SS2.SSS2.p1.3.m3.4.5.3.1.cmml" xref="S4.SS2.SSS2.p1.3.m3.4.5.3.2"><cn id="S4.SS2.SSS2.p1.3.m3.1.1.cmml" type="integer" xref="S4.SS2.SSS2.p1.3.m3.1.1">32</cn><cn id="S4.SS2.SSS2.p1.3.m3.2.2.cmml" type="integer" xref="S4.SS2.SSS2.p1.3.m3.2.2">64</cn><cn id="S4.SS2.SSS2.p1.3.m3.3.3.cmml" type="integer" xref="S4.SS2.SSS2.p1.3.m3.3.3">128</cn><cn id="S4.SS2.SSS2.p1.3.m3.4.4.cmml" type="integer" xref="S4.SS2.SSS2.p1.3.m3.4.4">256</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.3.m3.4c">K=[32,64,128,256]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.3.m3.4d">italic_K = [ 32 , 64 , 128 , 256 ]</annotation></semantics></math> and <math alttext="L=2000" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.4.m4.1"><semantics id="S4.SS2.SSS2.p1.4.m4.1a"><mrow id="S4.SS2.SSS2.p1.4.m4.1.1" xref="S4.SS2.SSS2.p1.4.m4.1.1.cmml"><mi id="S4.SS2.SSS2.p1.4.m4.1.1.2" xref="S4.SS2.SSS2.p1.4.m4.1.1.2.cmml">L</mi><mo id="S4.SS2.SSS2.p1.4.m4.1.1.1" xref="S4.SS2.SSS2.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS2.p1.4.m4.1.1.3" xref="S4.SS2.SSS2.p1.4.m4.1.1.3.cmml">2000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.4.m4.1b"><apply id="S4.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1"><eq id="S4.SS2.SSS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1.1"></eq><ci id="S4.SS2.SSS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1.2">𝐿</ci><cn id="S4.SS2.SSS2.p1.4.m4.1.1.3.cmml" type="integer" xref="S4.SS2.SSS2.p1.4.m4.1.1.3">2000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.4.m4.1c">L=2000</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.4.m4.1d">italic_L = 2000</annotation></semantics></math>. Secondly, we observe that in the synthetic dataset, experimental groups are designed with different sequence length <math alttext="L=2000,5000,10000" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.5.m5.3"><semantics id="S4.SS2.SSS2.p1.5.m5.3a"><mrow id="S4.SS2.SSS2.p1.5.m5.3.4" xref="S4.SS2.SSS2.p1.5.m5.3.4.cmml"><mi id="S4.SS2.SSS2.p1.5.m5.3.4.2" xref="S4.SS2.SSS2.p1.5.m5.3.4.2.cmml">L</mi><mo id="S4.SS2.SSS2.p1.5.m5.3.4.1" xref="S4.SS2.SSS2.p1.5.m5.3.4.1.cmml">=</mo><mrow id="S4.SS2.SSS2.p1.5.m5.3.4.3.2" xref="S4.SS2.SSS2.p1.5.m5.3.4.3.1.cmml"><mn id="S4.SS2.SSS2.p1.5.m5.1.1" xref="S4.SS2.SSS2.p1.5.m5.1.1.cmml">2000</mn><mo id="S4.SS2.SSS2.p1.5.m5.3.4.3.2.1" xref="S4.SS2.SSS2.p1.5.m5.3.4.3.1.cmml">,</mo><mn id="S4.SS2.SSS2.p1.5.m5.2.2" xref="S4.SS2.SSS2.p1.5.m5.2.2.cmml">5000</mn><mo id="S4.SS2.SSS2.p1.5.m5.3.4.3.2.2" xref="S4.SS2.SSS2.p1.5.m5.3.4.3.1.cmml">,</mo><mn id="S4.SS2.SSS2.p1.5.m5.3.3" xref="S4.SS2.SSS2.p1.5.m5.3.3.cmml">10000</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.5.m5.3b"><apply id="S4.SS2.SSS2.p1.5.m5.3.4.cmml" xref="S4.SS2.SSS2.p1.5.m5.3.4"><eq id="S4.SS2.SSS2.p1.5.m5.3.4.1.cmml" xref="S4.SS2.SSS2.p1.5.m5.3.4.1"></eq><ci id="S4.SS2.SSS2.p1.5.m5.3.4.2.cmml" xref="S4.SS2.SSS2.p1.5.m5.3.4.2">𝐿</ci><list id="S4.SS2.SSS2.p1.5.m5.3.4.3.1.cmml" xref="S4.SS2.SSS2.p1.5.m5.3.4.3.2"><cn id="S4.SS2.SSS2.p1.5.m5.1.1.cmml" type="integer" xref="S4.SS2.SSS2.p1.5.m5.1.1">2000</cn><cn id="S4.SS2.SSS2.p1.5.m5.2.2.cmml" type="integer" xref="S4.SS2.SSS2.p1.5.m5.2.2">5000</cn><cn id="S4.SS2.SSS2.p1.5.m5.3.3.cmml" type="integer" xref="S4.SS2.SSS2.p1.5.m5.3.3">10000</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.5.m5.3c">L=2000,5000,10000</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.5.m5.3d">italic_L = 2000 , 5000 , 10000</annotation></semantics></math>, different settings of norm values <math alttext="|\mathbb{x}^{(m)}|" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.6.m6.2"><semantics id="S4.SS2.SSS2.p1.6.m6.2a"><mrow id="S4.SS2.SSS2.p1.6.m6.2.2.1" xref="S4.SS2.SSS2.p1.6.m6.2.2.2.cmml"><mo id="S4.SS2.SSS2.p1.6.m6.2.2.1.2" stretchy="false" xref="S4.SS2.SSS2.p1.6.m6.2.2.2.1.cmml">|</mo><msup id="S4.SS2.SSS2.p1.6.m6.2.2.1.1" xref="S4.SS2.SSS2.p1.6.m6.2.2.1.1.cmml"><mi id="S4.SS2.SSS2.p1.6.m6.2.2.1.1.2" xref="S4.SS2.SSS2.p1.6.m6.2.2.1.1.2.cmml">𝕩</mi><mrow id="S4.SS2.SSS2.p1.6.m6.1.1.1.3" xref="S4.SS2.SSS2.p1.6.m6.2.2.1.1.cmml"><mo id="S4.SS2.SSS2.p1.6.m6.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS2.p1.6.m6.2.2.1.1.cmml">(</mo><mi id="S4.SS2.SSS2.p1.6.m6.1.1.1.1" xref="S4.SS2.SSS2.p1.6.m6.1.1.1.1.cmml">m</mi><mo id="S4.SS2.SSS2.p1.6.m6.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS2.p1.6.m6.2.2.1.1.cmml">)</mo></mrow></msup><mo id="S4.SS2.SSS2.p1.6.m6.2.2.1.3" stretchy="false" xref="S4.SS2.SSS2.p1.6.m6.2.2.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.6.m6.2b"><apply id="S4.SS2.SSS2.p1.6.m6.2.2.2.cmml" xref="S4.SS2.SSS2.p1.6.m6.2.2.1"><abs id="S4.SS2.SSS2.p1.6.m6.2.2.2.1.cmml" xref="S4.SS2.SSS2.p1.6.m6.2.2.1.2"></abs><apply id="S4.SS2.SSS2.p1.6.m6.2.2.1.1.cmml" xref="S4.SS2.SSS2.p1.6.m6.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.6.m6.2.2.1.1.1.cmml" xref="S4.SS2.SSS2.p1.6.m6.2.2.1.1">superscript</csymbol><ci id="S4.SS2.SSS2.p1.6.m6.2.2.1.1.2.cmml" xref="S4.SS2.SSS2.p1.6.m6.2.2.1.1.2">𝕩</ci><ci id="S4.SS2.SSS2.p1.6.m6.1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.6.m6.1.1.1.1">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.6.m6.2c">|\mathbb{x}^{(m)}|</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.6.m6.2d">| blackboard_x start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT |</annotation></semantics></math> across modalities, and different settings of weight <math alttext="\gamma_{m}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.7.m7.1"><semantics id="S4.SS2.SSS2.p1.7.m7.1a"><msub id="S4.SS2.SSS2.p1.7.m7.1.1" xref="S4.SS2.SSS2.p1.7.m7.1.1.cmml"><mi id="S4.SS2.SSS2.p1.7.m7.1.1.2" xref="S4.SS2.SSS2.p1.7.m7.1.1.2.cmml">γ</mi><mi id="S4.SS2.SSS2.p1.7.m7.1.1.3" xref="S4.SS2.SSS2.p1.7.m7.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.7.m7.1b"><apply id="S4.SS2.SSS2.p1.7.m7.1.1.cmml" xref="S4.SS2.SSS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.7.m7.1.1.1.cmml" xref="S4.SS2.SSS2.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p1.7.m7.1.1.2.cmml" xref="S4.SS2.SSS2.p1.7.m7.1.1.2">𝛾</ci><ci id="S4.SS2.SSS2.p1.7.m7.1.1.3.cmml" xref="S4.SS2.SSS2.p1.7.m7.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.7.m7.1c">\gamma_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.7.m7.1d">italic_γ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> across modalities as in section <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S4.T4" title="Table 4 ‣ 4.1. Experimental Settings ‣ 4. Experiment ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> of detailed implementation. Our proposed method of multi-modal product quantization strategy consistently achieves the best <span class="ltx_text ltx_markedasmath" id="S4.SS2.SSS2.p1.16.3">Recall@K</span> at different <math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.9.m9.1"><semantics id="S4.SS2.SSS2.p1.9.m9.1a"><mi id="S4.SS2.SSS2.p1.9.m9.1.1" xref="S4.SS2.SSS2.p1.9.m9.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.9.m9.1b"><ci id="S4.SS2.SSS2.p1.9.m9.1.1.cmml" xref="S4.SS2.SSS2.p1.9.m9.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.9.m9.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.9.m9.1d">italic_K</annotation></semantics></math> levels (<math alttext="K=[32,64,128,256]" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.10.m10.4"><semantics id="S4.SS2.SSS2.p1.10.m10.4a"><mrow id="S4.SS2.SSS2.p1.10.m10.4.5" xref="S4.SS2.SSS2.p1.10.m10.4.5.cmml"><mi id="S4.SS2.SSS2.p1.10.m10.4.5.2" xref="S4.SS2.SSS2.p1.10.m10.4.5.2.cmml">K</mi><mo id="S4.SS2.SSS2.p1.10.m10.4.5.1" xref="S4.SS2.SSS2.p1.10.m10.4.5.1.cmml">=</mo><mrow id="S4.SS2.SSS2.p1.10.m10.4.5.3.2" xref="S4.SS2.SSS2.p1.10.m10.4.5.3.1.cmml"><mo id="S4.SS2.SSS2.p1.10.m10.4.5.3.2.1" stretchy="false" xref="S4.SS2.SSS2.p1.10.m10.4.5.3.1.cmml">[</mo><mn id="S4.SS2.SSS2.p1.10.m10.1.1" xref="S4.SS2.SSS2.p1.10.m10.1.1.cmml">32</mn><mo id="S4.SS2.SSS2.p1.10.m10.4.5.3.2.2" xref="S4.SS2.SSS2.p1.10.m10.4.5.3.1.cmml">,</mo><mn id="S4.SS2.SSS2.p1.10.m10.2.2" xref="S4.SS2.SSS2.p1.10.m10.2.2.cmml">64</mn><mo id="S4.SS2.SSS2.p1.10.m10.4.5.3.2.3" xref="S4.SS2.SSS2.p1.10.m10.4.5.3.1.cmml">,</mo><mn id="S4.SS2.SSS2.p1.10.m10.3.3" xref="S4.SS2.SSS2.p1.10.m10.3.3.cmml">128</mn><mo id="S4.SS2.SSS2.p1.10.m10.4.5.3.2.4" xref="S4.SS2.SSS2.p1.10.m10.4.5.3.1.cmml">,</mo><mn id="S4.SS2.SSS2.p1.10.m10.4.4" xref="S4.SS2.SSS2.p1.10.m10.4.4.cmml">256</mn><mo id="S4.SS2.SSS2.p1.10.m10.4.5.3.2.5" stretchy="false" xref="S4.SS2.SSS2.p1.10.m10.4.5.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.10.m10.4b"><apply id="S4.SS2.SSS2.p1.10.m10.4.5.cmml" xref="S4.SS2.SSS2.p1.10.m10.4.5"><eq id="S4.SS2.SSS2.p1.10.m10.4.5.1.cmml" xref="S4.SS2.SSS2.p1.10.m10.4.5.1"></eq><ci id="S4.SS2.SSS2.p1.10.m10.4.5.2.cmml" xref="S4.SS2.SSS2.p1.10.m10.4.5.2">𝐾</ci><list id="S4.SS2.SSS2.p1.10.m10.4.5.3.1.cmml" xref="S4.SS2.SSS2.p1.10.m10.4.5.3.2"><cn id="S4.SS2.SSS2.p1.10.m10.1.1.cmml" type="integer" xref="S4.SS2.SSS2.p1.10.m10.1.1">32</cn><cn id="S4.SS2.SSS2.p1.10.m10.2.2.cmml" type="integer" xref="S4.SS2.SSS2.p1.10.m10.2.2">64</cn><cn id="S4.SS2.SSS2.p1.10.m10.3.3.cmml" type="integer" xref="S4.SS2.SSS2.p1.10.m10.3.3">128</cn><cn id="S4.SS2.SSS2.p1.10.m10.4.4.cmml" type="integer" xref="S4.SS2.SSS2.p1.10.m10.4.4">256</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.10.m10.4c">K=[32,64,128,256]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.10.m10.4d">italic_K = [ 32 , 64 , 128 , 256 ]</annotation></semantics></math>), with only a few exceptions of falling behind the cascading ANN (HNSW) method for large <math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.11.m11.1"><semantics id="S4.SS2.SSS2.p1.11.m11.1a"><mi id="S4.SS2.SSS2.p1.11.m11.1.1" xref="S4.SS2.SSS2.p1.11.m11.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.11.m11.1b"><ci id="S4.SS2.SSS2.p1.11.m11.1.1.cmml" xref="S4.SS2.SSS2.p1.11.m11.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.11.m11.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.11.m11.1d">italic_K</annotation></semantics></math> values under <math alttext="L=2000,5000" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.12.m12.2"><semantics id="S4.SS2.SSS2.p1.12.m12.2a"><mrow id="S4.SS2.SSS2.p1.12.m12.2.3" xref="S4.SS2.SSS2.p1.12.m12.2.3.cmml"><mi id="S4.SS2.SSS2.p1.12.m12.2.3.2" xref="S4.SS2.SSS2.p1.12.m12.2.3.2.cmml">L</mi><mo id="S4.SS2.SSS2.p1.12.m12.2.3.1" xref="S4.SS2.SSS2.p1.12.m12.2.3.1.cmml">=</mo><mrow id="S4.SS2.SSS2.p1.12.m12.2.3.3.2" xref="S4.SS2.SSS2.p1.12.m12.2.3.3.1.cmml"><mn id="S4.SS2.SSS2.p1.12.m12.1.1" xref="S4.SS2.SSS2.p1.12.m12.1.1.cmml">2000</mn><mo id="S4.SS2.SSS2.p1.12.m12.2.3.3.2.1" xref="S4.SS2.SSS2.p1.12.m12.2.3.3.1.cmml">,</mo><mn id="S4.SS2.SSS2.p1.12.m12.2.2" xref="S4.SS2.SSS2.p1.12.m12.2.2.cmml">5000</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.12.m12.2b"><apply id="S4.SS2.SSS2.p1.12.m12.2.3.cmml" xref="S4.SS2.SSS2.p1.12.m12.2.3"><eq id="S4.SS2.SSS2.p1.12.m12.2.3.1.cmml" xref="S4.SS2.SSS2.p1.12.m12.2.3.1"></eq><ci id="S4.SS2.SSS2.p1.12.m12.2.3.2.cmml" xref="S4.SS2.SSS2.p1.12.m12.2.3.2">𝐿</ci><list id="S4.SS2.SSS2.p1.12.m12.2.3.3.1.cmml" xref="S4.SS2.SSS2.p1.12.m12.2.3.3.2"><cn id="S4.SS2.SSS2.p1.12.m12.1.1.cmml" type="integer" xref="S4.SS2.SSS2.p1.12.m12.1.1">2000</cn><cn id="S4.SS2.SSS2.p1.12.m12.2.2.cmml" type="integer" xref="S4.SS2.SSS2.p1.12.m12.2.2">5000</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.12.m12.2c">L=2000,5000</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.12.m12.2d">italic_L = 2000 , 5000</annotation></semantics></math>. For the first method, cascading ANN (HNSW), we observe that the greedy strategy of cascading ANN achieves poor results at small values of <math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.13.m13.1"><semantics id="S4.SS2.SSS2.p1.13.m13.1a"><mi id="S4.SS2.SSS2.p1.13.m13.1.1" xref="S4.SS2.SSS2.p1.13.m13.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.13.m13.1b"><ci id="S4.SS2.SSS2.p1.13.m13.1.1.cmml" xref="S4.SS2.SSS2.p1.13.m13.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.13.m13.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.13.m13.1d">italic_K</annotation></semantics></math> (e.g., L=10000, Recall@32=0.2719), and the performance increases dramatically as <math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.14.m14.1"><semantics id="S4.SS2.SSS2.p1.14.m14.1a"><mi id="S4.SS2.SSS2.p1.14.m14.1.1" xref="S4.SS2.SSS2.p1.14.m14.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.14.m14.1b"><ci id="S4.SS2.SSS2.p1.14.m14.1.1.cmml" xref="S4.SS2.SSS2.p1.14.m14.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.14.m14.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.14.m14.1d">italic_K</annotation></semantics></math> increases to 256 (L=10000, Recall@256=0.7289). This aligns with our expectation that in the setting of weighted sum of multiple vectors, as <math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.15.m15.1"><semantics id="S4.SS2.SSS2.p1.15.m15.1a"><mi id="S4.SS2.SSS2.p1.15.m15.1.1" xref="S4.SS2.SSS2.p1.15.m15.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.15.m15.1b"><ci id="S4.SS2.SSS2.p1.15.m15.1.1.cmml" xref="S4.SS2.SSS2.p1.15.m15.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.15.m15.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.15.m15.1d">italic_K</annotation></semantics></math> increases, the real top-K relevant pairs to the target pair have higher probability of being recalled by the greedy strategy of <math alttext="M^{2}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.16.m16.1"><semantics id="S4.SS2.SSS2.p1.16.m16.1a"><msup id="S4.SS2.SSS2.p1.16.m16.1.1" xref="S4.SS2.SSS2.p1.16.m16.1.1.cmml"><mi id="S4.SS2.SSS2.p1.16.m16.1.1.2" xref="S4.SS2.SSS2.p1.16.m16.1.1.2.cmml">M</mi><mn id="S4.SS2.SSS2.p1.16.m16.1.1.3" xref="S4.SS2.SSS2.p1.16.m16.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.16.m16.1b"><apply id="S4.SS2.SSS2.p1.16.m16.1.1.cmml" xref="S4.SS2.SSS2.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.16.m16.1.1.1.cmml" xref="S4.SS2.SSS2.p1.16.m16.1.1">superscript</csymbol><ci id="S4.SS2.SSS2.p1.16.m16.1.1.2.cmml" xref="S4.SS2.SSS2.p1.16.m16.1.1.2">𝑀</ci><cn id="S4.SS2.SSS2.p1.16.m16.1.1.3.cmml" type="integer" xref="S4.SS2.SSS2.p1.16.m16.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.16.m16.1c">M^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.16.m16.1d">italic_M start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> cascading cross-modal ANN retrieval.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS2.p2">
<p class="ltx_p" id="S4.SS2.SSS2.p2.9">To analyze the effect of different variables for approximate retrieval, e.g. merging weights <math alttext="\gamma_{m}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.1.m1.1"><semantics id="S4.SS2.SSS2.p2.1.m1.1a"><msub id="S4.SS2.SSS2.p2.1.m1.1.1" xref="S4.SS2.SSS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.SSS2.p2.1.m1.1.1.2" xref="S4.SS2.SSS2.p2.1.m1.1.1.2.cmml">γ</mi><mi id="S4.SS2.SSS2.p2.1.m1.1.1.3" xref="S4.SS2.SSS2.p2.1.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.1.m1.1b"><apply id="S4.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1.2">𝛾</ci><ci id="S4.SS2.SSS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.1.m1.1c">\gamma_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.1.m1.1d">italic_γ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> of modalities, different norm values <math alttext="|\mathbb{x}^{(m)}|" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.2.m2.2"><semantics id="S4.SS2.SSS2.p2.2.m2.2a"><mrow id="S4.SS2.SSS2.p2.2.m2.2.2.1" xref="S4.SS2.SSS2.p2.2.m2.2.2.2.cmml"><mo id="S4.SS2.SSS2.p2.2.m2.2.2.1.2" stretchy="false" xref="S4.SS2.SSS2.p2.2.m2.2.2.2.1.cmml">|</mo><msup id="S4.SS2.SSS2.p2.2.m2.2.2.1.1" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.cmml"><mi id="S4.SS2.SSS2.p2.2.m2.2.2.1.1.2" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.2.cmml">𝕩</mi><mrow id="S4.SS2.SSS2.p2.2.m2.1.1.1.3" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.cmml"><mo id="S4.SS2.SSS2.p2.2.m2.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.cmml">(</mo><mi id="S4.SS2.SSS2.p2.2.m2.1.1.1.1" xref="S4.SS2.SSS2.p2.2.m2.1.1.1.1.cmml">m</mi><mo id="S4.SS2.SSS2.p2.2.m2.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.cmml">)</mo></mrow></msup><mo id="S4.SS2.SSS2.p2.2.m2.2.2.1.3" stretchy="false" xref="S4.SS2.SSS2.p2.2.m2.2.2.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.2.m2.2b"><apply id="S4.SS2.SSS2.p2.2.m2.2.2.2.cmml" xref="S4.SS2.SSS2.p2.2.m2.2.2.1"><abs id="S4.SS2.SSS2.p2.2.m2.2.2.2.1.cmml" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.2"></abs><apply id="S4.SS2.SSS2.p2.2.m2.2.2.1.1.cmml" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.cmml" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1">superscript</csymbol><ci id="S4.SS2.SSS2.p2.2.m2.2.2.1.1.2.cmml" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.2">𝕩</ci><ci id="S4.SS2.SSS2.p2.2.m2.1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1.1.1">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.2.m2.2c">|\mathbb{x}^{(m)}|</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.2.m2.2d">| blackboard_x start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT |</annotation></semantics></math>, we plot the line chart of <span class="ltx_text ltx_markedasmath" id="S4.SS2.SSS2.p2.9.1">Recall@K</span> as <math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.4.m4.1"><semantics id="S4.SS2.SSS2.p2.4.m4.1a"><mi id="S4.SS2.SSS2.p2.4.m4.1.1" xref="S4.SS2.SSS2.p2.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.4.m4.1b"><ci id="S4.SS2.SSS2.p2.4.m4.1.1.cmml" xref="S4.SS2.SSS2.p2.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.4.m4.1d">italic_K</annotation></semantics></math> increases in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S4.F2" title="Figure 2 ‣ 4.2. Experimental Results ‣ 4. Experiment ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>. From the chart, we can observe that different norm values of multi-modal vectors influence the overall <span class="ltx_text ltx_markedasmath" id="S4.SS2.SSS2.p2.9.2">Recall@K</span> dramatically. Under the same sequence length <math alttext="L=10000" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.6.m6.1"><semantics id="S4.SS2.SSS2.p2.6.m6.1a"><mrow id="S4.SS2.SSS2.p2.6.m6.1.1" xref="S4.SS2.SSS2.p2.6.m6.1.1.cmml"><mi id="S4.SS2.SSS2.p2.6.m6.1.1.2" xref="S4.SS2.SSS2.p2.6.m6.1.1.2.cmml">L</mi><mo id="S4.SS2.SSS2.p2.6.m6.1.1.1" xref="S4.SS2.SSS2.p2.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS2.p2.6.m6.1.1.3" xref="S4.SS2.SSS2.p2.6.m6.1.1.3.cmml">10000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.6.m6.1b"><apply id="S4.SS2.SSS2.p2.6.m6.1.1.cmml" xref="S4.SS2.SSS2.p2.6.m6.1.1"><eq id="S4.SS2.SSS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.SSS2.p2.6.m6.1.1.1"></eq><ci id="S4.SS2.SSS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.SSS2.p2.6.m6.1.1.2">𝐿</ci><cn id="S4.SS2.SSS2.p2.6.m6.1.1.3.cmml" type="integer" xref="S4.SS2.SSS2.p2.6.m6.1.1.3">10000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.6.m6.1c">L=10000</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.6.m6.1d">italic_L = 10000</annotation></semantics></math> and <math alttext="K=256" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.7.m7.1"><semantics id="S4.SS2.SSS2.p2.7.m7.1a"><mrow id="S4.SS2.SSS2.p2.7.m7.1.1" xref="S4.SS2.SSS2.p2.7.m7.1.1.cmml"><mi id="S4.SS2.SSS2.p2.7.m7.1.1.2" xref="S4.SS2.SSS2.p2.7.m7.1.1.2.cmml">K</mi><mo id="S4.SS2.SSS2.p2.7.m7.1.1.1" xref="S4.SS2.SSS2.p2.7.m7.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS2.p2.7.m7.1.1.3" xref="S4.SS2.SSS2.p2.7.m7.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.7.m7.1b"><apply id="S4.SS2.SSS2.p2.7.m7.1.1.cmml" xref="S4.SS2.SSS2.p2.7.m7.1.1"><eq id="S4.SS2.SSS2.p2.7.m7.1.1.1.cmml" xref="S4.SS2.SSS2.p2.7.m7.1.1.1"></eq><ci id="S4.SS2.SSS2.p2.7.m7.1.1.2.cmml" xref="S4.SS2.SSS2.p2.7.m7.1.1.2">𝐾</ci><cn id="S4.SS2.SSS2.p2.7.m7.1.1.3.cmml" type="integer" xref="S4.SS2.SSS2.p2.7.m7.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.7.m7.1c">K=256</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.7.m7.1d">italic_K = 256</annotation></semantics></math>, the <span class="ltx_text ltx_markedasmath" id="S4.SS2.SSS2.p2.9.3">Recall@K</span> of the group with different norm values is on average -0.14 below the group with the same norm values. The varied norm values of multi-modal vectors make it more challenging to achieve high <span class="ltx_text ltx_markedasmath" id="S4.SS2.SSS2.p2.9.4">Recall@K</span> compared to the equal norm values counterpart.</p>
</div>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="221" id="S4.F3.g1" src="x3.png" width="443"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>Influence of Number of Pretraining Epochs on <span class="ltx_text ltx_markedasmath" id="S4.F3.4.1">NDCG@K</span> performance of KuaiSAR Dataset</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="221" id="S4.F4.g1" src="x4.png" width="443"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>Influence of Query and Item Representation Fusion Weight <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.F4.2.m1.1"><semantics id="S4.F4.2.m1.1b"><mi id="S4.F4.2.m1.1.1" xref="S4.F4.2.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.F4.2.m1.1c"><ci id="S4.F4.2.m1.1.1.cmml" xref="S4.F4.2.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.2.m1.1d">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.F4.2.m1.1e">italic_λ</annotation></semantics></math> on <span class="ltx_text" id="S4.F4.4.1">NDCG@K</span> performance of KuaiSAR Dataset</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Discussion and Ablation Study</h3>
<section class="ltx_subsubsection" id="S4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1. </span>Influence of Pretraining Epochs Number and Ablation of Pretraining Tasks</h4>
<div class="ltx_para" id="S4.SS3.SSS1.p1">
<p class="ltx_p" id="S4.SS3.SSS1.p1.1">To investigate the influence of different pretraining epochs and without pretraining of the SEMINAR model, we reported the <span class="ltx_text ltx_markedasmath" id="S4.SS3.SSS1.p1.1.1">NDCG@K</span> performance on KuaiSAR dataset with sequence length 1000 in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S4.F3" title="Figure 3 ‣ 4.2.2. Multi-Modal Query-Item Pairs Approximate Retrieval ‣ 4.2. Experimental Results ‣ 4. Experiment ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>. We can see that the SEMINAR model achieve largest improvement compared to the group of without pretraining in the first 5 pretraining epochs, and additional pretraining epochs up to 10 contribute only marginally to the performance.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS1.p2">
<p class="ltx_p" id="S4.SS3.SSS1.p2.1">As for the ablation study of different pretraining tasks of SEMINAR, we trained different models on KuaiSAR dataset, including without pretraining, with only one pretraining task and without the other two tasks (e.g., w. alignment and w/o next pair prediction, query-item relevance). The results of the ablation study are reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S4.T3" title="Table 3 ‣ 4.1. Experimental Settings ‣ 4. Experiment ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>. Compared to the group of SEMINAR without pretraining, multi-modal alignment task contributes largest to the performance improvement, followed by next pair prediction and query-item relevance.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2. </span>Query-Item Representation Fusion Weight</h4>
<div class="ltx_para" id="S4.SS3.SSS2.p1">
<p class="ltx_p" id="S4.SS3.SSS2.p1.5">To investigate the influence of different weight <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p1.1.m1.1"><semantics id="S4.SS3.SSS2.p1.1.m1.1a"><mi id="S4.SS3.SSS2.p1.1.m1.1.1" xref="S4.SS3.SSS2.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.1.m1.1b"><ci id="S4.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p1.1.m1.1d">italic_λ</annotation></semantics></math> to fusion query and item representation, we conduct different experiments <math alttext="\lambda=[0.1,0.3,0.5,0.7,0.9]" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p1.2.m2.5"><semantics id="S4.SS3.SSS2.p1.2.m2.5a"><mrow id="S4.SS3.SSS2.p1.2.m2.5.6" xref="S4.SS3.SSS2.p1.2.m2.5.6.cmml"><mi id="S4.SS3.SSS2.p1.2.m2.5.6.2" xref="S4.SS3.SSS2.p1.2.m2.5.6.2.cmml">λ</mi><mo id="S4.SS3.SSS2.p1.2.m2.5.6.1" xref="S4.SS3.SSS2.p1.2.m2.5.6.1.cmml">=</mo><mrow id="S4.SS3.SSS2.p1.2.m2.5.6.3.2" xref="S4.SS3.SSS2.p1.2.m2.5.6.3.1.cmml"><mo id="S4.SS3.SSS2.p1.2.m2.5.6.3.2.1" stretchy="false" xref="S4.SS3.SSS2.p1.2.m2.5.6.3.1.cmml">[</mo><mn id="S4.SS3.SSS2.p1.2.m2.1.1" xref="S4.SS3.SSS2.p1.2.m2.1.1.cmml">0.1</mn><mo id="S4.SS3.SSS2.p1.2.m2.5.6.3.2.2" xref="S4.SS3.SSS2.p1.2.m2.5.6.3.1.cmml">,</mo><mn id="S4.SS3.SSS2.p1.2.m2.2.2" xref="S4.SS3.SSS2.p1.2.m2.2.2.cmml">0.3</mn><mo id="S4.SS3.SSS2.p1.2.m2.5.6.3.2.3" xref="S4.SS3.SSS2.p1.2.m2.5.6.3.1.cmml">,</mo><mn id="S4.SS3.SSS2.p1.2.m2.3.3" xref="S4.SS3.SSS2.p1.2.m2.3.3.cmml">0.5</mn><mo id="S4.SS3.SSS2.p1.2.m2.5.6.3.2.4" xref="S4.SS3.SSS2.p1.2.m2.5.6.3.1.cmml">,</mo><mn id="S4.SS3.SSS2.p1.2.m2.4.4" xref="S4.SS3.SSS2.p1.2.m2.4.4.cmml">0.7</mn><mo id="S4.SS3.SSS2.p1.2.m2.5.6.3.2.5" xref="S4.SS3.SSS2.p1.2.m2.5.6.3.1.cmml">,</mo><mn id="S4.SS3.SSS2.p1.2.m2.5.5" xref="S4.SS3.SSS2.p1.2.m2.5.5.cmml">0.9</mn><mo id="S4.SS3.SSS2.p1.2.m2.5.6.3.2.6" stretchy="false" xref="S4.SS3.SSS2.p1.2.m2.5.6.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.2.m2.5b"><apply id="S4.SS3.SSS2.p1.2.m2.5.6.cmml" xref="S4.SS3.SSS2.p1.2.m2.5.6"><eq id="S4.SS3.SSS2.p1.2.m2.5.6.1.cmml" xref="S4.SS3.SSS2.p1.2.m2.5.6.1"></eq><ci id="S4.SS3.SSS2.p1.2.m2.5.6.2.cmml" xref="S4.SS3.SSS2.p1.2.m2.5.6.2">𝜆</ci><list id="S4.SS3.SSS2.p1.2.m2.5.6.3.1.cmml" xref="S4.SS3.SSS2.p1.2.m2.5.6.3.2"><cn id="S4.SS3.SSS2.p1.2.m2.1.1.cmml" type="float" xref="S4.SS3.SSS2.p1.2.m2.1.1">0.1</cn><cn id="S4.SS3.SSS2.p1.2.m2.2.2.cmml" type="float" xref="S4.SS3.SSS2.p1.2.m2.2.2">0.3</cn><cn id="S4.SS3.SSS2.p1.2.m2.3.3.cmml" type="float" xref="S4.SS3.SSS2.p1.2.m2.3.3">0.5</cn><cn id="S4.SS3.SSS2.p1.2.m2.4.4.cmml" type="float" xref="S4.SS3.SSS2.p1.2.m2.4.4">0.7</cn><cn id="S4.SS3.SSS2.p1.2.m2.5.5.cmml" type="float" xref="S4.SS3.SSS2.p1.2.m2.5.5">0.9</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.2.m2.5c">\lambda=[0.1,0.3,0.5,0.7,0.9]</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p1.2.m2.5d">italic_λ = [ 0.1 , 0.3 , 0.5 , 0.7 , 0.9 ]</annotation></semantics></math> of SEMINAR model on KuaiSAR dataset. The results are reported in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#S4.F4" title="Figure 4 ‣ 4.2.2. Multi-Modal Query-Item Pairs Approximate Retrieval ‣ 4.2. Experimental Results ‣ 4. Experiment ‣ SEMINAR: Search Enhanced Multi-modal Interest Network and Approximate Retrieval for Lifelong Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>. The best performance is achieved at <math alttext="\lambda=0.3" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p1.3.m3.1"><semantics id="S4.SS3.SSS2.p1.3.m3.1a"><mrow id="S4.SS3.SSS2.p1.3.m3.1.1" xref="S4.SS3.SSS2.p1.3.m3.1.1.cmml"><mi id="S4.SS3.SSS2.p1.3.m3.1.1.2" xref="S4.SS3.SSS2.p1.3.m3.1.1.2.cmml">λ</mi><mo id="S4.SS3.SSS2.p1.3.m3.1.1.1" xref="S4.SS3.SSS2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS2.p1.3.m3.1.1.3" xref="S4.SS3.SSS2.p1.3.m3.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.3.m3.1b"><apply id="S4.SS3.SSS2.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS2.p1.3.m3.1.1"><eq id="S4.SS3.SSS2.p1.3.m3.1.1.1.cmml" xref="S4.SS3.SSS2.p1.3.m3.1.1.1"></eq><ci id="S4.SS3.SSS2.p1.3.m3.1.1.2.cmml" xref="S4.SS3.SSS2.p1.3.m3.1.1.2">𝜆</ci><cn id="S4.SS3.SSS2.p1.3.m3.1.1.3.cmml" type="float" xref="S4.SS3.SSS2.p1.3.m3.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.3.m3.1c">\lambda=0.3</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p1.3.m3.1d">italic_λ = 0.3</annotation></semantics></math>. We speculate that optimal value of fusion weight <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p1.4.m4.1"><semantics id="S4.SS3.SSS2.p1.4.m4.1a"><mi id="S4.SS3.SSS2.p1.4.m4.1.1" xref="S4.SS3.SSS2.p1.4.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.4.m4.1b"><ci id="S4.SS3.SSS2.p1.4.m4.1.1.cmml" xref="S4.SS3.SSS2.p1.4.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.4.m4.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p1.4.m4.1d">italic_λ</annotation></semantics></math> depends on the distribution of search and recommendation behaviors in the unified sequence of query-item pair. For example, in KuaiSAR dataset search actions consist of 25.7% of overall users’ actions, and recommendation actions consist of 74.3% of total actions as in <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.10714v1#bib.bib17" title="">2023</a>)</cite> . The optimal value of <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p1.5.m5.1"><semantics id="S4.SS3.SSS2.p1.5.m5.1a"><mi id="S4.SS3.SSS2.p1.5.m5.1.1" xref="S4.SS3.SSS2.p1.5.m5.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.5.m5.1b"><ci id="S4.SS3.SSS2.p1.5.m5.1.1.cmml" xref="S4.SS3.SSS2.p1.5.m5.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.5.m5.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p1.5.m5.1d">italic_λ</annotation></semantics></math> may vary across different domains and datasets, which need further investigation in future research.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we proposed SEMINAR to model users’ lifelong behavior sequence of query and item pairs. We introduced the Pretraining Search Unit to help alleviate the issues of insufficient learning of ID embeddings in lifelong sequence and multi-modal alignment. For online fast approximate retrieval, a multi-modal product-quantization based strategy is also proposed. Extensive evaluations on multiple datasets demonstrate the effectiveness of our method.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ai et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Qingyao Ai, Yongfeng Zhang, Keping Bi, Xu Chen, and W. Bruce Croft. 2017.

</span>
<span class="ltx_bibblock">Learning a Hierarchical Embedding Model for Personalized Product Search. In <em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">Proceedings of the 40th International ACM SIGIR Conference on Research and Development in Information Retrieval</em> (Shinjuku, Tokyo, Japan) <em class="ltx_emph ltx_font_italic" id="bib.bib2.4.2">(SIGIR ’17)</em>. Association for Computing Machinery, New York, NY, USA, 645–654.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3077136.3080813" title="">https://doi.org/10.1145/3077136.3080813</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chang et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jianxin Chang, Chenbin Zhang, Zhiyi Fu, Xiaoxue Zang, Lin Guan, Jing Lu, Yiqun Hui, Dewei Leng, Yanan Niu, Yang Song, and Kun Gai. 2023.

</span>
<span class="ltx_bibblock">TWIN: TWo-stage Interest Network for Lifelong User Behavior Modeling in CTR Prediction at Kuaishou. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em> (¡conf-loc¿, ¡city¿Long Beach¡/city¿, ¡state¿CA¡/state¿, ¡country¿USA¡/country¿, ¡/conf-loc¿) <em class="ltx_emph ltx_font_italic" id="bib.bib3.4.2">(KDD ’23)</em>. Association for Computing Machinery, New York, NY, USA, 3785–3794.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3580305.3599922" title="">https://doi.org/10.1145/3580305.3599922</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Qiwei Chen, Yue Xu, Changhua Pei, Shanshan Lv, Tao Zhuang, and Junfeng Ge. 2022.

</span>
<span class="ltx_bibblock">Efficient Long Sequential User Data Modeling for Click-Through Rate Prediction.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2209.12212 [cs.IR]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. 2019.

</span>
<span class="ltx_bibblock">BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:1810.04805 [cs.CL]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn, Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg Heigold, Sylvain Gelly, Jakob Uszkoreit, and Neil Houlsby. 2020.

</span>
<span class="ltx_bibblock">An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">CoRR</em> abs/2010.11929 (2020).

</span>
<span class="ltx_bibblock">arXiv:2010.11929

<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2010.11929" title="">https://arxiv.org/abs/2010.11929</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Douze et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Matthijs Douze, Alexandr Guzhva, Chengqi Deng, Jeff Johnson, Gergely Szilvasy, Pierre-Emmanuel Mazaré, Maria Lomeli, Lucas Hosseini, and Hervé Jégou. 2024.

</span>
<span class="ltx_bibblock">The Faiss library.

</span>
<span class="ltx_bibblock">(2024).

</span>
<span class="ltx_bibblock">arXiv:2401.08281 [cs.LG]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yuqi Gong, Xichen Ding, Yehui Su, Kaiming Shen, Zhongyi Liu, and Guannan Zhang. 2023.

</span>
<span class="ltx_bibblock">An Unified Search and Recommendation Foundation Model for Cold-Start Scenario. In <em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">Proceedings of the 32nd ACM International Conference on Information and Knowledge Management</em> (¡conf-loc¿, ¡city¿Birmingham¡/city¿, ¡country¿United Kingdom¡/country¿, ¡/conf-loc¿) <em class="ltx_emph ltx_font_italic" id="bib.bib8.4.2">(CIKM ’23)</em>. Association for Computing Machinery, New York, NY, USA, 4595–4601.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3583780.3614657" title="">https://doi.org/10.1145/3583780.3614657</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Tong Guo, Xuanping Li, Haitao Yang, Xiao Liang, Yong Yuan, Jingyou Hou, Bingqing Ke, Chao Zhang, Junlin He, Shunyu Zhang, Enyun Yu, and Wenwu Ou. 2023.

</span>
<span class="ltx_bibblock">Query-dominant User Interest Network for Large-Scale Search Ranking. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Proceedings of the 32nd ACM International Conference on Information and Knowledge Management</em> (¡conf-loc¿, ¡city¿Birmingham¡/city¿, ¡country¿United Kingdom¡/country¿, ¡/conf-loc¿) <em class="ltx_emph ltx_font_italic" id="bib.bib9.4.2">(CIKM ’23)</em>. Association for Computing Machinery, New York, NY, USA, 629–638.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3583780.3615022" title="">https://doi.org/10.1145/3583780.3615022</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yupeng Hou, Zhankui He, Julian McAuley, and Wayne Xin Zhao. 2023.

</span>
<span class="ltx_bibblock">Learning Vector-Quantized Item Representation for Transferable Sequential Recommenders.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2210.12316 [cs.IR]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jégou et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2011)</span>
<span class="ltx_bibblock">
Herve Jégou, Matthijs Douze, and Cordelia Schmid. 2011.

</span>
<span class="ltx_bibblock">Product Quantization for Nearest Neighbor Search.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">IEEE Transactions on Pattern Analysis and Machine Intelligence</em> 33, 1 (2011), 117–128.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/TPAMI.2010.57" title="">https://doi.org/10.1109/TPAMI.2010.57</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Malkov and Yashunin (2018)</span>
<span class="ltx_bibblock">
Yu. A. Malkov and D. A. Yashunin. 2018.

</span>
<span class="ltx_bibblock">Efficient and robust approximate nearest neighbor search using Hierarchical Navigable Small World graphs.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:1603.09320 [cs.DS]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pi et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Qi Pi, Guorui Zhou, Yujing Zhang, Zhe Wang, Lejian Ren, Ying Fan, Xiaoqiang Zhu, and Kun Gai. 2020.

</span>
<span class="ltx_bibblock">Search-based User Interest Modeling with Lifelong Sequential Behavior Data for Click-Through Rate Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">Proceedings of the 29th ACM International Conference on Information &amp; Knowledge Management</em> (Virtual Event, Ireland) <em class="ltx_emph ltx_font_italic" id="bib.bib13.4.2">(CIKM ’20)</em>. Association for Computing Machinery, New York, NY, USA, 2685–2692.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3340531.3412744" title="">https://doi.org/10.1145/3340531.3412744</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, Gretchen Krueger, and Ilya Sutskever. 2021.

</span>
<span class="ltx_bibblock">Learning Transferable Visual Models From Natural Language Supervision.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2103.00020 [cs.CV]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajput et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Shashank Rajput, Nikhil Mehta, Anima Singh, Raghunandan H. Keshavan, Trung Vu, Lukasz Heldt, Lichan Hong, Yi Tay, Vinh Q. Tran, Jonah Samost, Maciej Kula, Ed H. Chi, and Maheswaran Sathiamoorthy. 2023.

</span>
<span class="ltx_bibblock">Recommender Systems with Generative Retrieval.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2305.05065 [cs.IR]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Si et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Zihua Si, Zhongxiang Sun, Xiao Zhang, Jun Xu, Xiaoxue Zang, Yang Song, Kun Gai, and Ji-Rong Wen. 2023.

</span>
<span class="ltx_bibblock">When Search Meets Recommendation: Learning Disentangled Search Representation for Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval</em> (, Taipei, Taiwan,) <em class="ltx_emph ltx_font_italic" id="bib.bib16.4.2">(SIGIR ’23)</em>. Association for Computing Machinery, New York, NY, USA, 1313–1323.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3539618.3591786" title="">https://doi.org/10.1145/3539618.3591786</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Zhongxiang Sun, Zihua Si, Xiaoxue Zang, Dewei Leng, Yanan Niu, Yang Song, Xiao Zhang, and Jun Xu. 2023.

</span>
<span class="ltx_bibblock">KuaiSAR: A Unified Search And Recommendation Dataset. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">Proceedings of the 32nd ACM International Conference on Information and Knowledge Management</em> (¡conf-loc¿, ¡city¿Birmingham¡/city¿, ¡country¿United Kingdom¡/country¿, ¡/conf-loc¿) <em class="ltx_emph ltx_font_italic" id="bib.bib17.4.2">(CIKM ’23)</em>. Association for Computing Machinery, New York, NY, USA, 5407–5411.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3583780.3615123" title="">https://doi.org/10.1145/3583780.3615123</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">van den Oord et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Aaron van den Oord, Oriol Vinyals, and Koray Kavukcuoglu. 2017.

</span>
<span class="ltx_bibblock">Neural discrete representation learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">Proceedings of the 31st International Conference on Neural Information Processing Systems</em> (Long Beach, California, USA) <em class="ltx_emph ltx_font_italic" id="bib.bib18.4.2">(NIPS’17)</em>. Curran Associates Inc., Red Hook, NY, USA, 6309–6318.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N. Gomez, Lukasz Kaiser, and Illia Polosukhin. 2023.

</span>
<span class="ltx_bibblock">Attention Is All You Need.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:1706.03762 [cs.CL]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Jing Yao, Zhicheng Dou, Ruobing Xie, Yanxiong Lu, Zhiping Wang, and Ji-Rong Wen. 2021.

</span>
<span class="ltx_bibblock">USER: A Unified Information Search and Recommendation Model based on Integrated Behavior Sequence. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Proceedings of the 30th ACM International Conference on Information &amp; Knowledge Management</em> (Virtual Event, Queensland, Australia) <em class="ltx_emph ltx_font_italic" id="bib.bib20.4.2">(CIKM ’21)</em>. Association for Computing Machinery, New York, NY, USA, 2373–2382.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3459637.3482489" title="">https://doi.org/10.1145/3459637.3482489</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zeghidour et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Neil Zeghidour, Alejandro Luebs, Ahmed Omran, Jan Skoglund, and Marco Tagliasacchi. 2021.

</span>
<span class="ltx_bibblock">SoundStream: An End-to-End Neural Audio Codec.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2107.03312 [cs.SD]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao (2023)</span>
<span class="ltx_bibblock">
Pengyu et al. Zhao. 2023.

</span>
<span class="ltx_bibblock">M5: Multi-Modal Multi-Interest Multi-Scenario Matching for Over-the-Top Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em> (¡conf-loc¿, ¡city¿Long Beach¡/city¿, ¡state¿CA¡/state¿, ¡country¿USA¡/country¿, ¡/conf-loc¿) <em class="ltx_emph ltx_font_italic" id="bib.bib22.2.2">(KDD ’23)</em>. Association for Computing Machinery, New York, NY, USA, 3785–3794.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3580305.3599863" title="">https://doi.org/10.1145/3580305.3599863</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Kun Zhou, Hui Wang, Wayne Xin Zhao, Yutao Zhu, Sirui Wang, Fuzheng Zhang, Zhongyuan Wang, and Ji-Rong Wen. 2020.

</span>
<span class="ltx_bibblock">S3-Rec: Self-Supervised Learning for Sequential Recommendation with Mutual Information Maximization. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">Proceedings of the 29th ACM International Conference on Information &amp; Knowledge Management</em> (Virtual Event, Ireland) <em class="ltx_emph ltx_font_italic" id="bib.bib23.4.2">(CIKM ’20)</em>. Association for Computing Machinery, New York, NY, USA, 1893–1902.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3340531.3411954" title="">https://doi.org/10.1145/3340531.3411954</a>
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Jul 15 13:30:23 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
