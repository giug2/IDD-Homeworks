<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2008.09092] Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation</title><meta property="og:description" content="Procedural models are being widely used to synthesize scenes for graphics, gaming, and to create (labeled) synthetic datasets for ML. In order to produce realistic and diverse scenes, a number of parameters governing t…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2008.09092">

<!--Generated on Sat Mar  2 09:44:11 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span id="id4" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span><sup id="id4.1" class="ltx_sup">1</sup>NVIDIA    <sup id="id4.2" class="ltx_sup">2</sup>University of Toronto
   <sup id="id4.3" class="ltx_sup">3</sup>University of Waterloo    <sup id="id4.4" class="ltx_sup">4</sup>Vector Institute</span></span></span>
<h1 class="ltx_title ltx_title_document">Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jeevan Devaranjan<sup id="id8.2.id1" class="ltx_sup"><span id="id8.2.id1.1" class="ltx_text ltx_font_italic">1,3</span></sup>
</span><span class="ltx_author_notes">authors contributed equally, work done during JD’s internship at NVIDIA</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Amlan Kar<sup id="id9.2.id1" class="ltx_sup"><span id="id9.2.id1.1" class="ltx_text ltx_font_italic">⋆1,2,4</span></sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sanja Fidler<sup id="id10.2.id1" class="ltx_sup"><span id="id10.2.id1.1" class="ltx_text ltx_font_italic">1,2,4</span></sup>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id11.id1" class="ltx_p">Procedural models are being widely used to synthesize scenes for graphics, gaming, and to create (labeled) synthetic datasets for ML. In order to produce realistic and diverse scenes, a number of parameters governing the procedural models have to be carefully tuned by experts. These parameters control both the <em id="id11.id1.1" class="ltx_emph ltx_font_italic">structure</em> of scenes being generated (<em id="id11.id1.2" class="ltx_emph ltx_font_italic">e.g. </em>how many cars in the scene), as well as <em id="id11.id1.3" class="ltx_emph ltx_font_italic">parameters</em> which place objects in valid configurations. Meta-Sim aimed at automatically tuning parameters given a target collection of real images in an unsupervised way. In Meta-Sim2, we aim to learn the scene <em id="id11.id1.4" class="ltx_emph ltx_font_italic">structure</em> in addition to parameters, which is a challenging problem due to its discrete nature. Meta-Sim2 proceeds by learning to sequentially sample rule expansions from a given probabilistic scene grammar. Due to the discrete nature of the problem, we use Reinforcement Learning to train our model, and design a feature space divergence between our synthesized and target images that is key to successful training. Experiments on a real driving dataset show that, without any supervision, we can successfully learn to generate data that captures discrete structural statistics of objects, such as their frequency, in real images. We also show that this leads to downstream improvement in the performance of an object detector trained on our generated dataset as opposed to other baseline simulation methods. Project page: <a target="_blank" href="https://nv-tlabs.github.io/meta-sim-structure/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://nv-tlabs.github.io/meta-sim-structure/</a>.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Synthetic datasets are creating an appealing opportunity for training machine learning models <em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">e.g. </em>for perception and planning in driving <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>, indoor scene perception <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>, <a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>, and robotic control <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite>.
Via graphics engines, synthetic datasets come with perfect ground-truth for tasks in which labels are expensive or even impossible to obtain, such as segmentation, depth or material information. Adding a new type of label to synthetic datasets is as simple as calling a renderer, rather than embarking on a time consuming annotation endeavor that requires new tooling and hiring, training and overseeing annotators.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">Creating synthetic datasets comes with its own hurdles. While content, such as 3D CAD models that make up a scene are available on online asset stores, artists write complex procedural models that synthesize scenes by placing these assets in realistic layouts. This often requires browsing through massive amounts of real imagery to carefully tune a procedural model – a time consuming task. For scenarios such as street scenes, creating synthetic scenes relevant for one city may require tuning a procedural model made for another city from scratch. In this paper, we propose an automatic method to carry out this task.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2008.09092/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="282" height="147" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>We present a method that learns to generate synthetic scenes from real imagery in an unsupervised fashion. It does so by learning a generative model of scene structure, samples from which (with additional scene parameters) can be rendered to create synthetic images and labels.</figcaption>
</figure>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">Recently, Meta-Sim <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> proposed to optimize scene parameters in a synthetically generated scene by exploiting the visual similarity of (rendered) generated synthetic data with real data. They represent scene structure and parameters in a <em id="S1.p3.1.1" class="ltx_emph ltx_font_italic">scene graph</em>, and generate data by sampling a random scene structure (and parameters) from a given <em id="S1.p3.1.2" class="ltx_emph ltx_font_italic">probabilistic grammar</em> of scenes, and then modifying the scene parameters using a learnt model. Since they only learn scene parameters, a sim-to-real gap in the scene structure remains. For example, one would likely find more cars, people and buildings in Manhattan over a quaint village in Italy. Other work on generative models of structural data such as graphs and grammar strings <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> require large amounts of ground truth data for training to generate realistic samples. However, scene structures are extremely cumbersome to annotate and thus not available in most real datasets.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">In this paper, we propose a procedural generative model of synthetic scenes that is learned unsupervised from real imagery. We generate <em id="S1.p4.1.1" class="ltx_emph ltx_font_italic">scene graphs</em> object-by-object by learning to sample rule expansions from a given probabilistic scene grammar and generate scene parameters using <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. Learning without supervision here is a challenging problem due to the discrete nature of the scene structures we aim to generate and the presence of a non-differentiable renderer in the generative process.
To this end, we propose a feature space divergence to compare (rendered) generated scenes with real scenes, which can be computed per scene and is key to allowing credit assignment for training with reinforcement learning.</p>
</div>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.1" class="ltx_p">We evaluate our method on two synthetic datasets and a real driving dataset and find that our approach significantly reduces the distribution gap between scene structures in our generated and target data, improving over human priors on scene structure by learning to closely align with target structure distributions. On the real driving dataset, starting from minimal human priors, we show that we can almost exactly recover the structural distribution in the real target scenes (measured using GT annotations available for cars) – an exciting result given that the model is trained without any labels. We show that an object detector trained on our generated data outperforms those trained on data generated with human priors or by  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, and show improvements in distribution similarity measures of our generated rendered images with real data.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Synthetic Content Creation</h3>

<div id="S2.SS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS1.p1.1" class="ltx_p">Synthetic content creation has been receiving significant interest as a promising alternative to dataset collection and annotation. Various works have proposed generating synthetic data for tasks such as perception and planning in driving <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib53" title="" class="ltx_ref">53</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>, <a href="#bib.bib68" title="" class="ltx_ref">68</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, indoor scene perception <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib70" title="" class="ltx_ref">70</a>, <a href="#bib.bib75" title="" class="ltx_ref">75</a>, <a href="#bib.bib46" title="" class="ltx_ref">46</a>, <a href="#bib.bib57" title="" class="ltx_ref">57</a>, <a href="#bib.bib59" title="" class="ltx_ref">59</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, game playing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, robotic control <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib63" title="" class="ltx_ref">63</a>, <a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite>, optical flow estimation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>, home robotics <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> amongst many others, utilizing procedural modeling, existing simulators or human generated scenarios.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para ltx_noindent">
<p id="S2.SS1.p2.1" class="ltx_p"><span id="S2.SS1.p2.1.1" class="ltx_text ltx_font_bold">Learnt Scene Generation</span> brings a data-driven nature to scene generation.  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib74" title="" class="ltx_ref">74</a>, <a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite> propose learning hierarchical spatial priors between furniture, that is integrated into a hand-crafted cost used to generate optimized indoor scene layouts. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite> similarly learn to synthesize indoor scenes using a probabilistic scene grammar and human-centric learning by leveraging affordances. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite> learn to generate intermediate object relationship graphs and instantiate scenes conditioned on them. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib76" title="" class="ltx_ref">76</a>]</cite> use a scene graph representation and learn adding objects into existing scenes. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib65" title="" class="ltx_ref">65</a>]</cite> propose methods for learning deep priors from data for indoor scene synthesis. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> introduce a generative model that sequentially adds objects into scenes, while  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> propose a generative model for object layouts in 2D given a label set. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite> generate batches of data using a neural network that is used to train a task model, and learn by differentiating through the learning process of the task model. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> propose learning to generate scenes by modifying the parameters of objects in scenes that are sampled from a probabilistic scene grammar. We argue that this ignores learning structural aspects of the scene, which we focus on in our work. Similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, and contrary to other works, we learn this in an unsupervised manner <em id="S2.SS1.p2.1.2" class="ltx_emph ltx_font_italic">i.e. </em>given only target images as input.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para ltx_noindent">
<p id="S2.SS1.p3.1" class="ltx_p"><span id="S2.SS1.p3.1.1" class="ltx_text ltx_font_bold">Learning with Simulators:</span> Methods in Approximate Bayesian Inference have looked into inferring the parameters of a simulator that generate a particular data point <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> provide a great overview of advances in simulator based inference. Instead of running inference per scene <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>, <a href="#bib.bib69" title="" class="ltx_ref">69</a>]</cite>, we aim to generate new data that resembles a target distribution. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> learn to optimize non-differentiable simulators using a variational upper bound of a GAN-like objective. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> learn to optimize simulator parameters for robotic control tasks by directly comparing trajectories between a real and a simulated robot. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> train an agent to paint images using brush strokes in an adversarial setting with Reinforcement Learning. We learn to generate discrete scene structures constrained to a grammar, while optimizing a distribution matching objective (with Reinforcement Learning) instead of training adversarially. Compared to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>, we generate large and complex scenes, as opposed to images of single objects or faces.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Graph Generation</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Generative models of graphs and trees  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib73" title="" class="ltx_ref">73</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> generally produce graphs with richer structure with more flexibility over grammar based models, but often fail to produce syntactically correct graphs for cases with a defined syntax such as programs and scene graphs. <span id="S2.SS2.p1.1.1" class="ltx_text ltx_font_bold">Grammar based methods</span> have been used for a variety of tasks such as program translation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, conditional program generation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib71" title="" class="ltx_ref">71</a>, <a href="#bib.bib72" title="" class="ltx_ref">72</a>]</cite>, grammar induction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> and generative modelling on structures with syntax <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, such as molecules. These methods, however, assume access to ground-truth graph structures for learning. We take inspiration from these methods, but show how to learn our model unsupervised <em id="S2.SS2.p1.1.2" class="ltx_emph ltx_font_italic">i.e. </em>without any ground truth scene graph annotations.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2008.09092/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="282" height="103" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Example scene graph (structure and parameters) and depiction of its rendering</figcaption>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.9" class="ltx_p">We aim to learn a generative model of synthetic scenes. In particular, given a dataset of real imagery
<math id="S3.p1.1.m1.1" class="ltx_Math" alttext="X_{R}" display="inline"><semantics id="S3.p1.1.m1.1a"><msub id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml">X</mi><mi id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml">R</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2">𝑋</ci><ci id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">X_{R}</annotation></semantics></math>, the problem is to create synthetic data <math id="S3.p1.2.m2.5" class="ltx_Math" alttext="D(\theta)=(X(\theta),Y(\theta))" display="inline"><semantics id="S3.p1.2.m2.5a"><mrow id="S3.p1.2.m2.5.5" xref="S3.p1.2.m2.5.5.cmml"><mrow id="S3.p1.2.m2.5.5.4" xref="S3.p1.2.m2.5.5.4.cmml"><mi id="S3.p1.2.m2.5.5.4.2" xref="S3.p1.2.m2.5.5.4.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S3.p1.2.m2.5.5.4.1" xref="S3.p1.2.m2.5.5.4.1.cmml">​</mo><mrow id="S3.p1.2.m2.5.5.4.3.2" xref="S3.p1.2.m2.5.5.4.cmml"><mo stretchy="false" id="S3.p1.2.m2.5.5.4.3.2.1" xref="S3.p1.2.m2.5.5.4.cmml">(</mo><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">θ</mi><mo stretchy="false" id="S3.p1.2.m2.5.5.4.3.2.2" xref="S3.p1.2.m2.5.5.4.cmml">)</mo></mrow></mrow><mo id="S3.p1.2.m2.5.5.3" xref="S3.p1.2.m2.5.5.3.cmml">=</mo><mrow id="S3.p1.2.m2.5.5.2.2" xref="S3.p1.2.m2.5.5.2.3.cmml"><mo stretchy="false" id="S3.p1.2.m2.5.5.2.2.3" xref="S3.p1.2.m2.5.5.2.3.cmml">(</mo><mrow id="S3.p1.2.m2.4.4.1.1.1" xref="S3.p1.2.m2.4.4.1.1.1.cmml"><mi id="S3.p1.2.m2.4.4.1.1.1.2" xref="S3.p1.2.m2.4.4.1.1.1.2.cmml">X</mi><mo lspace="0em" rspace="0em" id="S3.p1.2.m2.4.4.1.1.1.1" xref="S3.p1.2.m2.4.4.1.1.1.1.cmml">​</mo><mrow id="S3.p1.2.m2.4.4.1.1.1.3.2" xref="S3.p1.2.m2.4.4.1.1.1.cmml"><mo stretchy="false" id="S3.p1.2.m2.4.4.1.1.1.3.2.1" xref="S3.p1.2.m2.4.4.1.1.1.cmml">(</mo><mi id="S3.p1.2.m2.2.2" xref="S3.p1.2.m2.2.2.cmml">θ</mi><mo stretchy="false" id="S3.p1.2.m2.4.4.1.1.1.3.2.2" xref="S3.p1.2.m2.4.4.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p1.2.m2.5.5.2.2.4" xref="S3.p1.2.m2.5.5.2.3.cmml">,</mo><mrow id="S3.p1.2.m2.5.5.2.2.2" xref="S3.p1.2.m2.5.5.2.2.2.cmml"><mi id="S3.p1.2.m2.5.5.2.2.2.2" xref="S3.p1.2.m2.5.5.2.2.2.2.cmml">Y</mi><mo lspace="0em" rspace="0em" id="S3.p1.2.m2.5.5.2.2.2.1" xref="S3.p1.2.m2.5.5.2.2.2.1.cmml">​</mo><mrow id="S3.p1.2.m2.5.5.2.2.2.3.2" xref="S3.p1.2.m2.5.5.2.2.2.cmml"><mo stretchy="false" id="S3.p1.2.m2.5.5.2.2.2.3.2.1" xref="S3.p1.2.m2.5.5.2.2.2.cmml">(</mo><mi id="S3.p1.2.m2.3.3" xref="S3.p1.2.m2.3.3.cmml">θ</mi><mo stretchy="false" id="S3.p1.2.m2.5.5.2.2.2.3.2.2" xref="S3.p1.2.m2.5.5.2.2.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.p1.2.m2.5.5.2.2.5" xref="S3.p1.2.m2.5.5.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.5b"><apply id="S3.p1.2.m2.5.5.cmml" xref="S3.p1.2.m2.5.5"><eq id="S3.p1.2.m2.5.5.3.cmml" xref="S3.p1.2.m2.5.5.3"></eq><apply id="S3.p1.2.m2.5.5.4.cmml" xref="S3.p1.2.m2.5.5.4"><times id="S3.p1.2.m2.5.5.4.1.cmml" xref="S3.p1.2.m2.5.5.4.1"></times><ci id="S3.p1.2.m2.5.5.4.2.cmml" xref="S3.p1.2.m2.5.5.4.2">𝐷</ci><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝜃</ci></apply><interval closure="open" id="S3.p1.2.m2.5.5.2.3.cmml" xref="S3.p1.2.m2.5.5.2.2"><apply id="S3.p1.2.m2.4.4.1.1.1.cmml" xref="S3.p1.2.m2.4.4.1.1.1"><times id="S3.p1.2.m2.4.4.1.1.1.1.cmml" xref="S3.p1.2.m2.4.4.1.1.1.1"></times><ci id="S3.p1.2.m2.4.4.1.1.1.2.cmml" xref="S3.p1.2.m2.4.4.1.1.1.2">𝑋</ci><ci id="S3.p1.2.m2.2.2.cmml" xref="S3.p1.2.m2.2.2">𝜃</ci></apply><apply id="S3.p1.2.m2.5.5.2.2.2.cmml" xref="S3.p1.2.m2.5.5.2.2.2"><times id="S3.p1.2.m2.5.5.2.2.2.1.cmml" xref="S3.p1.2.m2.5.5.2.2.2.1"></times><ci id="S3.p1.2.m2.5.5.2.2.2.2.cmml" xref="S3.p1.2.m2.5.5.2.2.2.2">𝑌</ci><ci id="S3.p1.2.m2.3.3.cmml" xref="S3.p1.2.m2.3.3">𝜃</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.5c">D(\theta)=(X(\theta),Y(\theta))</annotation></semantics></math> of images <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="X(\theta)" display="inline"><semantics id="S3.p1.3.m3.1a"><mrow id="S3.p1.3.m3.1.2" xref="S3.p1.3.m3.1.2.cmml"><mi id="S3.p1.3.m3.1.2.2" xref="S3.p1.3.m3.1.2.2.cmml">X</mi><mo lspace="0em" rspace="0em" id="S3.p1.3.m3.1.2.1" xref="S3.p1.3.m3.1.2.1.cmml">​</mo><mrow id="S3.p1.3.m3.1.2.3.2" xref="S3.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S3.p1.3.m3.1.2.3.2.1" xref="S3.p1.3.m3.1.2.cmml">(</mo><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">θ</mi><mo stretchy="false" id="S3.p1.3.m3.1.2.3.2.2" xref="S3.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><apply id="S3.p1.3.m3.1.2.cmml" xref="S3.p1.3.m3.1.2"><times id="S3.p1.3.m3.1.2.1.cmml" xref="S3.p1.3.m3.1.2.1"></times><ci id="S3.p1.3.m3.1.2.2.cmml" xref="S3.p1.3.m3.1.2.2">𝑋</ci><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">X(\theta)</annotation></semantics></math> and labels <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="Y(\theta)" display="inline"><semantics id="S3.p1.4.m4.1a"><mrow id="S3.p1.4.m4.1.2" xref="S3.p1.4.m4.1.2.cmml"><mi id="S3.p1.4.m4.1.2.2" xref="S3.p1.4.m4.1.2.2.cmml">Y</mi><mo lspace="0em" rspace="0em" id="S3.p1.4.m4.1.2.1" xref="S3.p1.4.m4.1.2.1.cmml">​</mo><mrow id="S3.p1.4.m4.1.2.3.2" xref="S3.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S3.p1.4.m4.1.2.3.2.1" xref="S3.p1.4.m4.1.2.cmml">(</mo><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">θ</mi><mo stretchy="false" id="S3.p1.4.m4.1.2.3.2.2" xref="S3.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.2.cmml" xref="S3.p1.4.m4.1.2"><times id="S3.p1.4.m4.1.2.1.cmml" xref="S3.p1.4.m4.1.2.1"></times><ci id="S3.p1.4.m4.1.2.2.cmml" xref="S3.p1.4.m4.1.2.2">𝑌</ci><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">Y(\theta)</annotation></semantics></math> that is representative of <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="X_{R}" display="inline"><semantics id="S3.p1.5.m5.1a"><msub id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><mi id="S3.p1.5.m5.1.1.2" xref="S3.p1.5.m5.1.1.2.cmml">X</mi><mi id="S3.p1.5.m5.1.1.3" xref="S3.p1.5.m5.1.1.3.cmml">R</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2">𝑋</ci><ci id="S3.p1.5.m5.1.1.3.cmml" xref="S3.p1.5.m5.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">X_{R}</annotation></semantics></math>, where <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.p1.6.m6.1a"><mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">\theta</annotation></semantics></math> represents the parameters of the generative model. We exploit advances in graphics engines and rendering, by stipulating that the synthetic data <math id="S3.p1.7.m7.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.p1.7.m7.1a"><mi id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><ci id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">D</annotation></semantics></math> is the output of creating an abstract scene representation and rendering it with a graphics engine. Rendering ensures that low level pixel information in <math id="S3.p1.8.m8.1" class="ltx_Math" alttext="X(\theta)" display="inline"><semantics id="S3.p1.8.m8.1a"><mrow id="S3.p1.8.m8.1.2" xref="S3.p1.8.m8.1.2.cmml"><mi id="S3.p1.8.m8.1.2.2" xref="S3.p1.8.m8.1.2.2.cmml">X</mi><mo lspace="0em" rspace="0em" id="S3.p1.8.m8.1.2.1" xref="S3.p1.8.m8.1.2.1.cmml">​</mo><mrow id="S3.p1.8.m8.1.2.3.2" xref="S3.p1.8.m8.1.2.cmml"><mo stretchy="false" id="S3.p1.8.m8.1.2.3.2.1" xref="S3.p1.8.m8.1.2.cmml">(</mo><mi id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml">θ</mi><mo stretchy="false" id="S3.p1.8.m8.1.2.3.2.2" xref="S3.p1.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><apply id="S3.p1.8.m8.1.2.cmml" xref="S3.p1.8.m8.1.2"><times id="S3.p1.8.m8.1.2.1.cmml" xref="S3.p1.8.m8.1.2.1"></times><ci id="S3.p1.8.m8.1.2.2.cmml" xref="S3.p1.8.m8.1.2.2">𝑋</ci><ci id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">X(\theta)</annotation></semantics></math> (and its corresponding annotation <math id="S3.p1.9.m9.1" class="ltx_Math" alttext="Y(\theta)" display="inline"><semantics id="S3.p1.9.m9.1a"><mrow id="S3.p1.9.m9.1.2" xref="S3.p1.9.m9.1.2.cmml"><mi id="S3.p1.9.m9.1.2.2" xref="S3.p1.9.m9.1.2.2.cmml">Y</mi><mo lspace="0em" rspace="0em" id="S3.p1.9.m9.1.2.1" xref="S3.p1.9.m9.1.2.1.cmml">​</mo><mrow id="S3.p1.9.m9.1.2.3.2" xref="S3.p1.9.m9.1.2.cmml"><mo stretchy="false" id="S3.p1.9.m9.1.2.3.2.1" xref="S3.p1.9.m9.1.2.cmml">(</mo><mi id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml">θ</mi><mo stretchy="false" id="S3.p1.9.m9.1.2.3.2.2" xref="S3.p1.9.m9.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><apply id="S3.p1.9.m9.1.2.cmml" xref="S3.p1.9.m9.1.2"><times id="S3.p1.9.m9.1.2.1.cmml" xref="S3.p1.9.m9.1.2.1"></times><ci id="S3.p1.9.m9.1.2.2.cmml" xref="S3.p1.9.m9.1.2.2">𝑌</ci><ci id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">Y(\theta)</annotation></semantics></math>) does not need to be modelled, which has been the focus of recent research in generative modeling of images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite>. Ensuring the semantic <em id="S3.p1.9.1" class="ltx_emph ltx_font_italic">validity</em> of sampled scenes requires imposing constraints on their structure. Scene grammars use a set of rules to greatly reduce the space of scenes that can be sampled, making learning a more structured and tractable problem. For example, it could explicitly enforce that a car can only be on a road which then need not be implicitly learned, thus leading us to use probabilistic scene grammars. Meta-Sim <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> sampled <em id="S3.p1.9.2" class="ltx_emph ltx_font_italic">scene graph</em> structures (see Fig. <a href="#S2.F2" title="Figure 2 ‣ 2.2 Graph Generation ‣ 2 Related Work ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) from a prior imposed on a Probabilistic Context-Free Grammar (PCFG), which we call the <em id="S3.p1.9.3" class="ltx_emph ltx_font_italic">structure prior</em>. They sampled parameters for every node in the scene graph from a <em id="S3.p1.9.4" class="ltx_emph ltx_font_italic">parameter prior</em> and learned to predict new parameters for each node, keeping the structure intact. Their generated scenes therefore come from a structure prior (which is context-free) and the learnt parameter distribution, resulting in an untackled sim-to-real gap in the scene structures. In our work, we aim to alleviate this by learning a context-dependent structure distribution <em id="S3.p1.9.5" class="ltx_emph ltx_font_italic">unsupervised</em> of synthetic scenes from images.</p>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.1" class="ltx_p">We utilize <em id="S3.p2.1.1" class="ltx_emph ltx_font_italic">scene graphs</em> as our abstract scene representation, that are rendered into a corresponding image with labels (Sec <a href="#S3.SS1" title="3.1 Representing Synthetic Scenes ‣ 3 Methodology ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>). Our generative model sequentially samples expansion rules from a given probabilistic scene grammar (Sec <a href="#S3.SS2" title="3.2 Generative Model ‣ 3 Methodology ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>) to generate a scene graph which is rendered. We train the model <em id="S3.p2.1.2" class="ltx_emph ltx_font_italic">unsupervised</em> and with reinforcement learning, using a feature-matching based distribution divergence specifically designed to be amenable to our setting (Sec <a href="#S3.SS3" title="3.3 Training ‣ 3 Methodology ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>).</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2008.09092/assets/x3.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="328" height="79" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Representation of our generative process for a scene graph. The logits and mask are of shape <math id="S3.F3.2.m1.1" class="ltx_Math" alttext="T_{max}\times K" display="inline"><semantics id="S3.F3.2.m1.1b"><mrow id="S3.F3.2.m1.1.1" xref="S3.F3.2.m1.1.1.cmml"><msub id="S3.F3.2.m1.1.1.2" xref="S3.F3.2.m1.1.1.2.cmml"><mi id="S3.F3.2.m1.1.1.2.2" xref="S3.F3.2.m1.1.1.2.2.cmml">T</mi><mrow id="S3.F3.2.m1.1.1.2.3" xref="S3.F3.2.m1.1.1.2.3.cmml"><mi id="S3.F3.2.m1.1.1.2.3.2" xref="S3.F3.2.m1.1.1.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.F3.2.m1.1.1.2.3.1" xref="S3.F3.2.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.F3.2.m1.1.1.2.3.3" xref="S3.F3.2.m1.1.1.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.F3.2.m1.1.1.2.3.1b" xref="S3.F3.2.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.F3.2.m1.1.1.2.3.4" xref="S3.F3.2.m1.1.1.2.3.4.cmml">x</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.F3.2.m1.1.1.1" xref="S3.F3.2.m1.1.1.1.cmml">×</mo><mi id="S3.F3.2.m1.1.1.3" xref="S3.F3.2.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.2.m1.1c"><apply id="S3.F3.2.m1.1.1.cmml" xref="S3.F3.2.m1.1.1"><times id="S3.F3.2.m1.1.1.1.cmml" xref="S3.F3.2.m1.1.1.1"></times><apply id="S3.F3.2.m1.1.1.2.cmml" xref="S3.F3.2.m1.1.1.2"><csymbol cd="ambiguous" id="S3.F3.2.m1.1.1.2.1.cmml" xref="S3.F3.2.m1.1.1.2">subscript</csymbol><ci id="S3.F3.2.m1.1.1.2.2.cmml" xref="S3.F3.2.m1.1.1.2.2">𝑇</ci><apply id="S3.F3.2.m1.1.1.2.3.cmml" xref="S3.F3.2.m1.1.1.2.3"><times id="S3.F3.2.m1.1.1.2.3.1.cmml" xref="S3.F3.2.m1.1.1.2.3.1"></times><ci id="S3.F3.2.m1.1.1.2.3.2.cmml" xref="S3.F3.2.m1.1.1.2.3.2">𝑚</ci><ci id="S3.F3.2.m1.1.1.2.3.3.cmml" xref="S3.F3.2.m1.1.1.2.3.3">𝑎</ci><ci id="S3.F3.2.m1.1.1.2.3.4.cmml" xref="S3.F3.2.m1.1.1.2.3.4">𝑥</ci></apply></apply><ci id="S3.F3.2.m1.1.1.3.cmml" xref="S3.F3.2.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.2.m1.1d">T_{max}\times K</annotation></semantics></math>. Green represents a higher value and red is lower. At every time step, we autoregressively sample a rule and predict the logits for the next rule conditioned on the sample (capturing context dependencies). The figure on the right shows how sampled rules from the grammar are converted into a graph structure (only objects that are renderable are kept from the full grammar string). Parameters for every node can be sampled from a prior or optionally learnt with the method of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. A generated scene graph can be rendered as shown in Fig. <a href="#S2.F2" title="Figure 2 ‣ 2.2 Graph Generation ‣ 2 Related Work ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</figcaption>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Representing Synthetic Scenes</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.1" class="ltx_p">In Computer Graphics and Vision, <span id="S3.SS1.p1.1.1" class="ltx_text ltx_font_bold">Scene Graphs</span> are commonly used to describe scenes in a concise hierarchical manner, where each node describes an object in the scene along with its parameters such as the 3D asset, pose etc. Parent-child relationships define the child’s parameters relative to its parent, enabling easy scene editing and manipulation. Additionally, camera, lighting,
weather etc. are also encoded into the scene graph. Generating corresponding
pixels and annotations amounts to placing objects into the scene in a graphics engine
and rendering with the defined parameters (see Fig. <a href="#S2.F2" title="Figure 2 ‣ 2.2 Graph Generation ‣ 2 Related Work ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).</p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.6" class="ltx_p"><span id="S3.SS1.p2.6.1" class="ltx_text ltx_font_bold">Notation:</span> A context-free grammar <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">G</annotation></semantics></math> is defined as a list of symbols (terminal and non-terminal) and expansion rules. Non-terminal symbols have at least one expansion rule into a new set of symbols. Sampling from a grammar involves expanding a start symbol till only non-terminal symbols remain. We denote the total number of expansion rules in a grammar <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">G</annotation></semantics></math> as <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">K</annotation></semantics></math>. We define scene grammars and represent strings sampled from the grammar as scene graphs following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> (see Fig. <a href="#S3.F3" title="Figure 3 ‣ 3 Methodology ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). For each scene graph, a structure <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">T</annotation></semantics></math> is sampled from the grammar <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">G</annotation></semantics></math> followed by sampling corresponding parameters <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><mi id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">\alpha</annotation></semantics></math> for every node in the graph.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Generative Model</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.5" class="ltx_p">We take inspiration from previous work on learning generative models of graphs that are constrained by a grammar <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> for our architecture. Specifically, we map a latent vector <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">z</annotation></semantics></math> to unnormalized probabilities over all possible grammar rules in an autoregressive manner, using a recurrent neural network till a maximum of <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="T_{max}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">T</mi><mrow id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.2.m2.1.1.3.1" xref="S3.SS2.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.2.m2.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.2.m2.1.1.3.1a" xref="S3.SS2.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.2.m2.1.1.3.4" xref="S3.SS2.p1.2.m2.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝑇</ci><apply id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><times id="S3.SS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3.1"></times><ci id="S3.SS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.2">𝑚</ci><ci id="S3.SS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3">𝑎</ci><ci id="S3.SS2.p1.2.m2.1.1.3.4.cmml" xref="S3.SS2.p1.2.m2.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">T_{max}</annotation></semantics></math> steps. Deviating from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>, we sample one rule <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="r_{t}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">r</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑟</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">r_{t}</annotation></semantics></math> at every time step and use it to predict the logits for the next rule <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="f_{t+1}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">f</mi><mrow id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.3.2" xref="S3.SS2.p1.4.m4.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p1.4.m4.1.1.3.1" xref="S3.SS2.p1.4.m4.1.1.3.1.cmml">+</mo><mn id="S3.SS2.p1.4.m4.1.1.3.3" xref="S3.SS2.p1.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑓</ci><apply id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3"><plus id="S3.SS2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3.1"></plus><ci id="S3.SS2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">f_{t+1}</annotation></semantics></math>. This allows our model to capture context-dependent relationships easily, as opposed to the context-free nature of scene graphs in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. Given a list of at most <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="T_{max}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><msub id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">T</mi><mrow id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml"><mi id="S3.SS2.p1.5.m5.1.1.3.2" xref="S3.SS2.p1.5.m5.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m5.1.1.3.1" xref="S3.SS2.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.5.m5.1.1.3.3" xref="S3.SS2.p1.5.m5.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m5.1.1.3.1a" xref="S3.SS2.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.5.m5.1.1.3.4" xref="S3.SS2.p1.5.m5.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">𝑇</ci><apply id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3"><times id="S3.SS2.p1.5.m5.1.1.3.1.cmml" xref="S3.SS2.p1.5.m5.1.1.3.1"></times><ci id="S3.SS2.p1.5.m5.1.1.3.2.cmml" xref="S3.SS2.p1.5.m5.1.1.3.2">𝑚</ci><ci id="S3.SS2.p1.5.m5.1.1.3.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3.3">𝑎</ci><ci id="S3.SS2.p1.5.m5.1.1.3.4.cmml" xref="S3.SS2.p1.5.m5.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">T_{max}</annotation></semantics></math> sampled rules, the corresponding scene graph is generated by treating each rule expansion as a node expansion in the graph (see Fig. <a href="#S3.F3" title="Figure 3 ‣ 3 Methodology ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.5" class="ltx_p"><span id="S3.SS2.p2.5.1" class="ltx_text ltx_font_bold">Sampling Correct Rules: </span> To ensure the validity of sampled rules in each time step <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">t</annotation></semantics></math>, we follow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> and maintain a last-in-first-out (LIFO) stack of unexpanded non-terminal nodes. Nodes are popped from the stack, expanded according to the sampled rule-expansion, and the resulting new non-terminal nodes are pushed to the stack. When a non-terminal is popped, we create a mask <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="m_{t}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">m</mi><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝑚</ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">m_{t}</annotation></semantics></math> of size <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">K</annotation></semantics></math> which is 1 for valid rules from that non-terminal and 0 otherwise. Given the logits for the next expansion <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="f_{t}" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><msub id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">f</mi><mi id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">𝑓</ci><ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">f_{t}</annotation></semantics></math>, the probability of a rule <math id="S3.SS2.p2.5.m5.2" class="ltx_Math" alttext="r_{t,k}" display="inline"><semantics id="S3.SS2.p2.5.m5.2a"><msub id="S3.SS2.p2.5.m5.2.3" xref="S3.SS2.p2.5.m5.2.3.cmml"><mi id="S3.SS2.p2.5.m5.2.3.2" xref="S3.SS2.p2.5.m5.2.3.2.cmml">r</mi><mrow id="S3.SS2.p2.5.m5.2.2.2.4" xref="S3.SS2.p2.5.m5.2.2.2.3.cmml"><mi id="S3.SS2.p2.5.m5.1.1.1.1" xref="S3.SS2.p2.5.m5.1.1.1.1.cmml">t</mi><mo id="S3.SS2.p2.5.m5.2.2.2.4.1" xref="S3.SS2.p2.5.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p2.5.m5.2.2.2.2" xref="S3.SS2.p2.5.m5.2.2.2.2.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.2b"><apply id="S3.SS2.p2.5.m5.2.3.cmml" xref="S3.SS2.p2.5.m5.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.2.3.1.cmml" xref="S3.SS2.p2.5.m5.2.3">subscript</csymbol><ci id="S3.SS2.p2.5.m5.2.3.2.cmml" xref="S3.SS2.p2.5.m5.2.3.2">𝑟</ci><list id="S3.SS2.p2.5.m5.2.2.2.3.cmml" xref="S3.SS2.p2.5.m5.2.2.2.4"><ci id="S3.SS2.p2.5.m5.1.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1.1.1">𝑡</ci><ci id="S3.SS2.p2.5.m5.2.2.2.2.cmml" xref="S3.SS2.p2.5.m5.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.2c">r_{t,k}</annotation></semantics></math> is represented as,</p>
<table id="S6.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1.m1.11" class="ltx_Math" alttext="\displaystyle p(r_{t}=k|f_{t})=\frac{m_{t,k}exp(f_{t,k})}{\sum_{j=1}^{K}m_{t,j}exp(f_{t,j})}" display="inline"><semantics id="S3.Ex1.m1.11a"><mrow id="S3.Ex1.m1.11.11" xref="S3.Ex1.m1.11.11.cmml"><mrow id="S3.Ex1.m1.11.11.1" xref="S3.Ex1.m1.11.11.1.cmml"><mi id="S3.Ex1.m1.11.11.1.3" xref="S3.Ex1.m1.11.11.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.11.11.1.2" xref="S3.Ex1.m1.11.11.1.2.cmml">​</mo><mrow id="S3.Ex1.m1.11.11.1.1.1" xref="S3.Ex1.m1.11.11.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.11.11.1.1.1.2" xref="S3.Ex1.m1.11.11.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.11.11.1.1.1.1" xref="S3.Ex1.m1.11.11.1.1.1.1.cmml"><msub id="S3.Ex1.m1.11.11.1.1.1.1.2" xref="S3.Ex1.m1.11.11.1.1.1.1.2.cmml"><mi id="S3.Ex1.m1.11.11.1.1.1.1.2.2" xref="S3.Ex1.m1.11.11.1.1.1.1.2.2.cmml">r</mi><mi id="S3.Ex1.m1.11.11.1.1.1.1.2.3" xref="S3.Ex1.m1.11.11.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.Ex1.m1.11.11.1.1.1.1.1" xref="S3.Ex1.m1.11.11.1.1.1.1.1.cmml">=</mo><mrow id="S3.Ex1.m1.11.11.1.1.1.1.3" xref="S3.Ex1.m1.11.11.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.11.11.1.1.1.1.3.2" xref="S3.Ex1.m1.11.11.1.1.1.1.3.2.cmml">k</mi><mo fence="false" id="S3.Ex1.m1.11.11.1.1.1.1.3.1" xref="S3.Ex1.m1.11.11.1.1.1.1.3.1.cmml">|</mo><msub id="S3.Ex1.m1.11.11.1.1.1.1.3.3" xref="S3.Ex1.m1.11.11.1.1.1.1.3.3.cmml"><mi id="S3.Ex1.m1.11.11.1.1.1.1.3.3.2" xref="S3.Ex1.m1.11.11.1.1.1.1.3.3.2.cmml">f</mi><mi id="S3.Ex1.m1.11.11.1.1.1.1.3.3.3" xref="S3.Ex1.m1.11.11.1.1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><mo stretchy="false" id="S3.Ex1.m1.11.11.1.1.1.3" xref="S3.Ex1.m1.11.11.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.11.11.2" xref="S3.Ex1.m1.11.11.2.cmml">=</mo><mstyle displaystyle="true" id="S3.Ex1.m1.10.10" xref="S3.Ex1.m1.10.10.cmml"><mfrac id="S3.Ex1.m1.10.10a" xref="S3.Ex1.m1.10.10.cmml"><mrow id="S3.Ex1.m1.5.5.5" xref="S3.Ex1.m1.5.5.5.cmml"><msub id="S3.Ex1.m1.5.5.5.7" xref="S3.Ex1.m1.5.5.5.7.cmml"><mi id="S3.Ex1.m1.5.5.5.7.2" xref="S3.Ex1.m1.5.5.5.7.2.cmml">m</mi><mrow id="S3.Ex1.m1.2.2.2.2.2.4" xref="S3.Ex1.m1.2.2.2.2.2.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml">t</mi><mo id="S3.Ex1.m1.2.2.2.2.2.4.1" xref="S3.Ex1.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S3.Ex1.m1.2.2.2.2.2.2" xref="S3.Ex1.m1.2.2.2.2.2.2.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.5.5.5.6" xref="S3.Ex1.m1.5.5.5.6.cmml">​</mo><mi id="S3.Ex1.m1.5.5.5.8" xref="S3.Ex1.m1.5.5.5.8.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.5.5.5.6a" xref="S3.Ex1.m1.5.5.5.6.cmml">​</mo><mi id="S3.Ex1.m1.5.5.5.9" xref="S3.Ex1.m1.5.5.5.9.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.5.5.5.6b" xref="S3.Ex1.m1.5.5.5.6.cmml">​</mo><mi id="S3.Ex1.m1.5.5.5.10" xref="S3.Ex1.m1.5.5.5.10.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.5.5.5.6c" xref="S3.Ex1.m1.5.5.5.6.cmml">​</mo><mrow id="S3.Ex1.m1.5.5.5.5.1" xref="S3.Ex1.m1.5.5.5.5.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.5.5.5.5.1.2" xref="S3.Ex1.m1.5.5.5.5.1.1.cmml">(</mo><msub id="S3.Ex1.m1.5.5.5.5.1.1" xref="S3.Ex1.m1.5.5.5.5.1.1.cmml"><mi id="S3.Ex1.m1.5.5.5.5.1.1.2" xref="S3.Ex1.m1.5.5.5.5.1.1.2.cmml">f</mi><mrow id="S3.Ex1.m1.4.4.4.4.2.4" xref="S3.Ex1.m1.4.4.4.4.2.3.cmml"><mi id="S3.Ex1.m1.3.3.3.3.1.1" xref="S3.Ex1.m1.3.3.3.3.1.1.cmml">t</mi><mo id="S3.Ex1.m1.4.4.4.4.2.4.1" xref="S3.Ex1.m1.4.4.4.4.2.3.cmml">,</mo><mi id="S3.Ex1.m1.4.4.4.4.2.2" xref="S3.Ex1.m1.4.4.4.4.2.2.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.Ex1.m1.5.5.5.5.1.3" xref="S3.Ex1.m1.5.5.5.5.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.Ex1.m1.10.10.10" xref="S3.Ex1.m1.10.10.10.cmml"><msubsup id="S3.Ex1.m1.10.10.10.6" xref="S3.Ex1.m1.10.10.10.6.cmml"><mo id="S3.Ex1.m1.10.10.10.6.2.2" xref="S3.Ex1.m1.10.10.10.6.2.2.cmml">∑</mo><mrow id="S3.Ex1.m1.10.10.10.6.2.3" xref="S3.Ex1.m1.10.10.10.6.2.3.cmml"><mi id="S3.Ex1.m1.10.10.10.6.2.3.2" xref="S3.Ex1.m1.10.10.10.6.2.3.2.cmml">j</mi><mo id="S3.Ex1.m1.10.10.10.6.2.3.1" xref="S3.Ex1.m1.10.10.10.6.2.3.1.cmml">=</mo><mn id="S3.Ex1.m1.10.10.10.6.2.3.3" xref="S3.Ex1.m1.10.10.10.6.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1.m1.10.10.10.6.3" xref="S3.Ex1.m1.10.10.10.6.3.cmml">K</mi></msubsup><mrow id="S3.Ex1.m1.10.10.10.5" xref="S3.Ex1.m1.10.10.10.5.cmml"><msub id="S3.Ex1.m1.10.10.10.5.3" xref="S3.Ex1.m1.10.10.10.5.3.cmml"><mi id="S3.Ex1.m1.10.10.10.5.3.2" xref="S3.Ex1.m1.10.10.10.5.3.2.cmml">m</mi><mrow id="S3.Ex1.m1.7.7.7.2.2.4" xref="S3.Ex1.m1.7.7.7.2.2.3.cmml"><mi id="S3.Ex1.m1.6.6.6.1.1.1" xref="S3.Ex1.m1.6.6.6.1.1.1.cmml">t</mi><mo id="S3.Ex1.m1.7.7.7.2.2.4.1" xref="S3.Ex1.m1.7.7.7.2.2.3.cmml">,</mo><mi id="S3.Ex1.m1.7.7.7.2.2.2" xref="S3.Ex1.m1.7.7.7.2.2.2.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.10.10.10.5.2" xref="S3.Ex1.m1.10.10.10.5.2.cmml">​</mo><mi id="S3.Ex1.m1.10.10.10.5.4" xref="S3.Ex1.m1.10.10.10.5.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.10.10.10.5.2a" xref="S3.Ex1.m1.10.10.10.5.2.cmml">​</mo><mi id="S3.Ex1.m1.10.10.10.5.5" xref="S3.Ex1.m1.10.10.10.5.5.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.10.10.10.5.2b" xref="S3.Ex1.m1.10.10.10.5.2.cmml">​</mo><mi id="S3.Ex1.m1.10.10.10.5.6" xref="S3.Ex1.m1.10.10.10.5.6.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.10.10.10.5.2c" xref="S3.Ex1.m1.10.10.10.5.2.cmml">​</mo><mrow id="S3.Ex1.m1.10.10.10.5.1.1" xref="S3.Ex1.m1.10.10.10.5.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.10.10.10.5.1.1.2" xref="S3.Ex1.m1.10.10.10.5.1.1.1.cmml">(</mo><msub id="S3.Ex1.m1.10.10.10.5.1.1.1" xref="S3.Ex1.m1.10.10.10.5.1.1.1.cmml"><mi id="S3.Ex1.m1.10.10.10.5.1.1.1.2" xref="S3.Ex1.m1.10.10.10.5.1.1.1.2.cmml">f</mi><mrow id="S3.Ex1.m1.9.9.9.4.2.4" xref="S3.Ex1.m1.9.9.9.4.2.3.cmml"><mi id="S3.Ex1.m1.8.8.8.3.1.1" xref="S3.Ex1.m1.8.8.8.3.1.1.cmml">t</mi><mo id="S3.Ex1.m1.9.9.9.4.2.4.1" xref="S3.Ex1.m1.9.9.9.4.2.3.cmml">,</mo><mi id="S3.Ex1.m1.9.9.9.4.2.2" xref="S3.Ex1.m1.9.9.9.4.2.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.Ex1.m1.10.10.10.5.1.1.3" xref="S3.Ex1.m1.10.10.10.5.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.11b"><apply id="S3.Ex1.m1.11.11.cmml" xref="S3.Ex1.m1.11.11"><eq id="S3.Ex1.m1.11.11.2.cmml" xref="S3.Ex1.m1.11.11.2"></eq><apply id="S3.Ex1.m1.11.11.1.cmml" xref="S3.Ex1.m1.11.11.1"><times id="S3.Ex1.m1.11.11.1.2.cmml" xref="S3.Ex1.m1.11.11.1.2"></times><ci id="S3.Ex1.m1.11.11.1.3.cmml" xref="S3.Ex1.m1.11.11.1.3">𝑝</ci><apply id="S3.Ex1.m1.11.11.1.1.1.1.cmml" xref="S3.Ex1.m1.11.11.1.1.1"><eq id="S3.Ex1.m1.11.11.1.1.1.1.1.cmml" xref="S3.Ex1.m1.11.11.1.1.1.1.1"></eq><apply id="S3.Ex1.m1.11.11.1.1.1.1.2.cmml" xref="S3.Ex1.m1.11.11.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.11.11.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.11.11.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1.m1.11.11.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.11.11.1.1.1.1.2.2">𝑟</ci><ci id="S3.Ex1.m1.11.11.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.11.11.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.Ex1.m1.11.11.1.1.1.1.3.cmml" xref="S3.Ex1.m1.11.11.1.1.1.1.3"><csymbol cd="latexml" id="S3.Ex1.m1.11.11.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.11.11.1.1.1.1.3.1">conditional</csymbol><ci id="S3.Ex1.m1.11.11.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.11.11.1.1.1.1.3.2">𝑘</ci><apply id="S3.Ex1.m1.11.11.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.11.11.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.11.11.1.1.1.1.3.3.1.cmml" xref="S3.Ex1.m1.11.11.1.1.1.1.3.3">subscript</csymbol><ci id="S3.Ex1.m1.11.11.1.1.1.1.3.3.2.cmml" xref="S3.Ex1.m1.11.11.1.1.1.1.3.3.2">𝑓</ci><ci id="S3.Ex1.m1.11.11.1.1.1.1.3.3.3.cmml" xref="S3.Ex1.m1.11.11.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply><apply id="S3.Ex1.m1.10.10.cmml" xref="S3.Ex1.m1.10.10"><divide id="S3.Ex1.m1.10.10.11.cmml" xref="S3.Ex1.m1.10.10"></divide><apply id="S3.Ex1.m1.5.5.5.cmml" xref="S3.Ex1.m1.5.5.5"><times id="S3.Ex1.m1.5.5.5.6.cmml" xref="S3.Ex1.m1.5.5.5.6"></times><apply id="S3.Ex1.m1.5.5.5.7.cmml" xref="S3.Ex1.m1.5.5.5.7"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.5.7.1.cmml" xref="S3.Ex1.m1.5.5.5.7">subscript</csymbol><ci id="S3.Ex1.m1.5.5.5.7.2.cmml" xref="S3.Ex1.m1.5.5.5.7.2">𝑚</ci><list id="S3.Ex1.m1.2.2.2.2.2.3.cmml" xref="S3.Ex1.m1.2.2.2.2.2.4"><ci id="S3.Ex1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1">𝑡</ci><ci id="S3.Ex1.m1.2.2.2.2.2.2.cmml" xref="S3.Ex1.m1.2.2.2.2.2.2">𝑘</ci></list></apply><ci id="S3.Ex1.m1.5.5.5.8.cmml" xref="S3.Ex1.m1.5.5.5.8">𝑒</ci><ci id="S3.Ex1.m1.5.5.5.9.cmml" xref="S3.Ex1.m1.5.5.5.9">𝑥</ci><ci id="S3.Ex1.m1.5.5.5.10.cmml" xref="S3.Ex1.m1.5.5.5.10">𝑝</ci><apply id="S3.Ex1.m1.5.5.5.5.1.1.cmml" xref="S3.Ex1.m1.5.5.5.5.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.5.5.1.1.1.cmml" xref="S3.Ex1.m1.5.5.5.5.1">subscript</csymbol><ci id="S3.Ex1.m1.5.5.5.5.1.1.2.cmml" xref="S3.Ex1.m1.5.5.5.5.1.1.2">𝑓</ci><list id="S3.Ex1.m1.4.4.4.4.2.3.cmml" xref="S3.Ex1.m1.4.4.4.4.2.4"><ci id="S3.Ex1.m1.3.3.3.3.1.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1">𝑡</ci><ci id="S3.Ex1.m1.4.4.4.4.2.2.cmml" xref="S3.Ex1.m1.4.4.4.4.2.2">𝑘</ci></list></apply></apply><apply id="S3.Ex1.m1.10.10.10.cmml" xref="S3.Ex1.m1.10.10.10"><apply id="S3.Ex1.m1.10.10.10.6.cmml" xref="S3.Ex1.m1.10.10.10.6"><csymbol cd="ambiguous" id="S3.Ex1.m1.10.10.10.6.1.cmml" xref="S3.Ex1.m1.10.10.10.6">superscript</csymbol><apply id="S3.Ex1.m1.10.10.10.6.2.cmml" xref="S3.Ex1.m1.10.10.10.6"><csymbol cd="ambiguous" id="S3.Ex1.m1.10.10.10.6.2.1.cmml" xref="S3.Ex1.m1.10.10.10.6">subscript</csymbol><sum id="S3.Ex1.m1.10.10.10.6.2.2.cmml" xref="S3.Ex1.m1.10.10.10.6.2.2"></sum><apply id="S3.Ex1.m1.10.10.10.6.2.3.cmml" xref="S3.Ex1.m1.10.10.10.6.2.3"><eq id="S3.Ex1.m1.10.10.10.6.2.3.1.cmml" xref="S3.Ex1.m1.10.10.10.6.2.3.1"></eq><ci id="S3.Ex1.m1.10.10.10.6.2.3.2.cmml" xref="S3.Ex1.m1.10.10.10.6.2.3.2">𝑗</ci><cn type="integer" id="S3.Ex1.m1.10.10.10.6.2.3.3.cmml" xref="S3.Ex1.m1.10.10.10.6.2.3.3">1</cn></apply></apply><ci id="S3.Ex1.m1.10.10.10.6.3.cmml" xref="S3.Ex1.m1.10.10.10.6.3">𝐾</ci></apply><apply id="S3.Ex1.m1.10.10.10.5.cmml" xref="S3.Ex1.m1.10.10.10.5"><times id="S3.Ex1.m1.10.10.10.5.2.cmml" xref="S3.Ex1.m1.10.10.10.5.2"></times><apply id="S3.Ex1.m1.10.10.10.5.3.cmml" xref="S3.Ex1.m1.10.10.10.5.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.10.10.10.5.3.1.cmml" xref="S3.Ex1.m1.10.10.10.5.3">subscript</csymbol><ci id="S3.Ex1.m1.10.10.10.5.3.2.cmml" xref="S3.Ex1.m1.10.10.10.5.3.2">𝑚</ci><list id="S3.Ex1.m1.7.7.7.2.2.3.cmml" xref="S3.Ex1.m1.7.7.7.2.2.4"><ci id="S3.Ex1.m1.6.6.6.1.1.1.cmml" xref="S3.Ex1.m1.6.6.6.1.1.1">𝑡</ci><ci id="S3.Ex1.m1.7.7.7.2.2.2.cmml" xref="S3.Ex1.m1.7.7.7.2.2.2">𝑗</ci></list></apply><ci id="S3.Ex1.m1.10.10.10.5.4.cmml" xref="S3.Ex1.m1.10.10.10.5.4">𝑒</ci><ci id="S3.Ex1.m1.10.10.10.5.5.cmml" xref="S3.Ex1.m1.10.10.10.5.5">𝑥</ci><ci id="S3.Ex1.m1.10.10.10.5.6.cmml" xref="S3.Ex1.m1.10.10.10.5.6">𝑝</ci><apply id="S3.Ex1.m1.10.10.10.5.1.1.1.cmml" xref="S3.Ex1.m1.10.10.10.5.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.10.10.10.5.1.1.1.1.cmml" xref="S3.Ex1.m1.10.10.10.5.1.1">subscript</csymbol><ci id="S3.Ex1.m1.10.10.10.5.1.1.1.2.cmml" xref="S3.Ex1.m1.10.10.10.5.1.1.1.2">𝑓</ci><list id="S3.Ex1.m1.9.9.9.4.2.3.cmml" xref="S3.Ex1.m1.9.9.9.4.2.4"><ci id="S3.Ex1.m1.8.8.8.3.1.1.cmml" xref="S3.Ex1.m1.8.8.8.3.1.1">𝑡</ci><ci id="S3.Ex1.m1.9.9.9.4.2.2.cmml" xref="S3.Ex1.m1.9.9.9.4.2.2">𝑗</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.11c">\displaystyle p(r_{t}=k|f_{t})=\frac{m_{t,k}exp(f_{t,k})}{\sum_{j=1}^{K}m_{t,j}exp(f_{t,j})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.9" class="ltx_p">Sampling from this masked multinomial distribution ensures that only valid rules are sampled as <math id="S3.SS2.p2.6.m1.1" class="ltx_Math" alttext="r_{t}" display="inline"><semantics id="S3.SS2.p2.6.m1.1a"><msub id="S3.SS2.p2.6.m1.1.1" xref="S3.SS2.p2.6.m1.1.1.cmml"><mi id="S3.SS2.p2.6.m1.1.1.2" xref="S3.SS2.p2.6.m1.1.1.2.cmml">r</mi><mi id="S3.SS2.p2.6.m1.1.1.3" xref="S3.SS2.p2.6.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m1.1b"><apply id="S3.SS2.p2.6.m1.1.1.cmml" xref="S3.SS2.p2.6.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m1.1.1.1.cmml" xref="S3.SS2.p2.6.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.6.m1.1.1.2.cmml" xref="S3.SS2.p2.6.m1.1.1.2">𝑟</ci><ci id="S3.SS2.p2.6.m1.1.1.3.cmml" xref="S3.SS2.p2.6.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m1.1c">r_{t}</annotation></semantics></math>.
Given the logits and sampled rules, <math id="S3.SS2.p2.7.m2.2" class="ltx_Math" alttext="(f_{t},r_{t})\forall t\in{1\ldots T_{max}}" display="inline"><semantics id="S3.SS2.p2.7.m2.2a"><mrow id="S3.SS2.p2.7.m2.2.2" xref="S3.SS2.p2.7.m2.2.2.cmml"><mrow id="S3.SS2.p2.7.m2.2.2.2" xref="S3.SS2.p2.7.m2.2.2.2.cmml"><mrow id="S3.SS2.p2.7.m2.2.2.2.2.2" xref="S3.SS2.p2.7.m2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p2.7.m2.2.2.2.2.2.3" xref="S3.SS2.p2.7.m2.2.2.2.2.3.cmml">(</mo><msub id="S3.SS2.p2.7.m2.1.1.1.1.1.1" xref="S3.SS2.p2.7.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.7.m2.1.1.1.1.1.1.2" xref="S3.SS2.p2.7.m2.1.1.1.1.1.1.2.cmml">f</mi><mi id="S3.SS2.p2.7.m2.1.1.1.1.1.1.3" xref="S3.SS2.p2.7.m2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS2.p2.7.m2.2.2.2.2.2.4" xref="S3.SS2.p2.7.m2.2.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p2.7.m2.2.2.2.2.2.2" xref="S3.SS2.p2.7.m2.2.2.2.2.2.2.cmml"><mi id="S3.SS2.p2.7.m2.2.2.2.2.2.2.2" xref="S3.SS2.p2.7.m2.2.2.2.2.2.2.2.cmml">r</mi><mi id="S3.SS2.p2.7.m2.2.2.2.2.2.2.3" xref="S3.SS2.p2.7.m2.2.2.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S3.SS2.p2.7.m2.2.2.2.2.2.5" xref="S3.SS2.p2.7.m2.2.2.2.2.3.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S3.SS2.p2.7.m2.2.2.2.3" xref="S3.SS2.p2.7.m2.2.2.2.3.cmml">​</mo><mrow id="S3.SS2.p2.7.m2.2.2.2.4" xref="S3.SS2.p2.7.m2.2.2.2.4.cmml"><mo rspace="0.167em" id="S3.SS2.p2.7.m2.2.2.2.4.1" xref="S3.SS2.p2.7.m2.2.2.2.4.1.cmml">∀</mo><mi id="S3.SS2.p2.7.m2.2.2.2.4.2" xref="S3.SS2.p2.7.m2.2.2.2.4.2.cmml">t</mi></mrow></mrow><mo id="S3.SS2.p2.7.m2.2.2.3" xref="S3.SS2.p2.7.m2.2.2.3.cmml">∈</mo><mrow id="S3.SS2.p2.7.m2.2.2.4" xref="S3.SS2.p2.7.m2.2.2.4.cmml"><mn id="S3.SS2.p2.7.m2.2.2.4.2" xref="S3.SS2.p2.7.m2.2.2.4.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S3.SS2.p2.7.m2.2.2.4.1" xref="S3.SS2.p2.7.m2.2.2.4.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS2.p2.7.m2.2.2.4.3" xref="S3.SS2.p2.7.m2.2.2.4.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.7.m2.2.2.4.1a" xref="S3.SS2.p2.7.m2.2.2.4.1.cmml">​</mo><msub id="S3.SS2.p2.7.m2.2.2.4.4" xref="S3.SS2.p2.7.m2.2.2.4.4.cmml"><mi id="S3.SS2.p2.7.m2.2.2.4.4.2" xref="S3.SS2.p2.7.m2.2.2.4.4.2.cmml">T</mi><mrow id="S3.SS2.p2.7.m2.2.2.4.4.3" xref="S3.SS2.p2.7.m2.2.2.4.4.3.cmml"><mi id="S3.SS2.p2.7.m2.2.2.4.4.3.2" xref="S3.SS2.p2.7.m2.2.2.4.4.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.7.m2.2.2.4.4.3.1" xref="S3.SS2.p2.7.m2.2.2.4.4.3.1.cmml">​</mo><mi id="S3.SS2.p2.7.m2.2.2.4.4.3.3" xref="S3.SS2.p2.7.m2.2.2.4.4.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.7.m2.2.2.4.4.3.1a" xref="S3.SS2.p2.7.m2.2.2.4.4.3.1.cmml">​</mo><mi id="S3.SS2.p2.7.m2.2.2.4.4.3.4" xref="S3.SS2.p2.7.m2.2.2.4.4.3.4.cmml">x</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m2.2b"><apply id="S3.SS2.p2.7.m2.2.2.cmml" xref="S3.SS2.p2.7.m2.2.2"><in id="S3.SS2.p2.7.m2.2.2.3.cmml" xref="S3.SS2.p2.7.m2.2.2.3"></in><apply id="S3.SS2.p2.7.m2.2.2.2.cmml" xref="S3.SS2.p2.7.m2.2.2.2"><times id="S3.SS2.p2.7.m2.2.2.2.3.cmml" xref="S3.SS2.p2.7.m2.2.2.2.3"></times><interval closure="open" id="S3.SS2.p2.7.m2.2.2.2.2.3.cmml" xref="S3.SS2.p2.7.m2.2.2.2.2.2"><apply id="S3.SS2.p2.7.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.7.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.7.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.7.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.7.m2.1.1.1.1.1.1.2">𝑓</ci><ci id="S3.SS2.p2.7.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.7.m2.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS2.p2.7.m2.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.7.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m2.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p2.7.m2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.7.m2.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.7.m2.2.2.2.2.2.2.2">𝑟</ci><ci id="S3.SS2.p2.7.m2.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p2.7.m2.2.2.2.2.2.2.3">𝑡</ci></apply></interval><apply id="S3.SS2.p2.7.m2.2.2.2.4.cmml" xref="S3.SS2.p2.7.m2.2.2.2.4"><csymbol cd="latexml" id="S3.SS2.p2.7.m2.2.2.2.4.1.cmml" xref="S3.SS2.p2.7.m2.2.2.2.4.1">for-all</csymbol><ci id="S3.SS2.p2.7.m2.2.2.2.4.2.cmml" xref="S3.SS2.p2.7.m2.2.2.2.4.2">𝑡</ci></apply></apply><apply id="S3.SS2.p2.7.m2.2.2.4.cmml" xref="S3.SS2.p2.7.m2.2.2.4"><times id="S3.SS2.p2.7.m2.2.2.4.1.cmml" xref="S3.SS2.p2.7.m2.2.2.4.1"></times><cn type="integer" id="S3.SS2.p2.7.m2.2.2.4.2.cmml" xref="S3.SS2.p2.7.m2.2.2.4.2">1</cn><ci id="S3.SS2.p2.7.m2.2.2.4.3.cmml" xref="S3.SS2.p2.7.m2.2.2.4.3">…</ci><apply id="S3.SS2.p2.7.m2.2.2.4.4.cmml" xref="S3.SS2.p2.7.m2.2.2.4.4"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m2.2.2.4.4.1.cmml" xref="S3.SS2.p2.7.m2.2.2.4.4">subscript</csymbol><ci id="S3.SS2.p2.7.m2.2.2.4.4.2.cmml" xref="S3.SS2.p2.7.m2.2.2.4.4.2">𝑇</ci><apply id="S3.SS2.p2.7.m2.2.2.4.4.3.cmml" xref="S3.SS2.p2.7.m2.2.2.4.4.3"><times id="S3.SS2.p2.7.m2.2.2.4.4.3.1.cmml" xref="S3.SS2.p2.7.m2.2.2.4.4.3.1"></times><ci id="S3.SS2.p2.7.m2.2.2.4.4.3.2.cmml" xref="S3.SS2.p2.7.m2.2.2.4.4.3.2">𝑚</ci><ci id="S3.SS2.p2.7.m2.2.2.4.4.3.3.cmml" xref="S3.SS2.p2.7.m2.2.2.4.4.3.3">𝑎</ci><ci id="S3.SS2.p2.7.m2.2.2.4.4.3.4.cmml" xref="S3.SS2.p2.7.m2.2.2.4.4.3.4">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m2.2c">(f_{t},r_{t})\forall t\in{1\ldots T_{max}}</annotation></semantics></math>, the
probability of the corresponding scene structure <math id="S3.SS2.p2.8.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS2.p2.8.m3.1a"><mi id="S3.SS2.p2.8.m3.1.1" xref="S3.SS2.p2.8.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m3.1b"><ci id="S3.SS2.p2.8.m3.1.1.cmml" xref="S3.SS2.p2.8.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m3.1c">T</annotation></semantics></math> given <math id="S3.SS2.p2.9.m4.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.SS2.p2.9.m4.1a"><mi id="S3.SS2.p2.9.m4.1.1" xref="S3.SS2.p2.9.m4.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m4.1b"><ci id="S3.SS2.p2.9.m4.1.1.cmml" xref="S3.SS2.p2.9.m4.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m4.1c">z</annotation></semantics></math> is simply,</p>
<table id="S6.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex2.m1.2" class="ltx_Math" alttext="\displaystyle q_{\theta}(T|z)=\sum_{t=1}^{T_{max}}p(r_{t}|f_{t})" display="inline"><semantics id="S3.Ex2.m1.2a"><mrow id="S3.Ex2.m1.2.2" xref="S3.Ex2.m1.2.2.cmml"><mrow id="S3.Ex2.m1.1.1.1" xref="S3.Ex2.m1.1.1.1.cmml"><msub id="S3.Ex2.m1.1.1.1.3" xref="S3.Ex2.m1.1.1.1.3.cmml"><mi id="S3.Ex2.m1.1.1.1.3.2" xref="S3.Ex2.m1.1.1.1.3.2.cmml">q</mi><mi id="S3.Ex2.m1.1.1.1.3.3" xref="S3.Ex2.m1.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.1.1.1.2" xref="S3.Ex2.m1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex2.m1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex2.m1.1.1.1.1.1.2" xref="S3.Ex2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.1.cmml"><mi id="S3.Ex2.m1.1.1.1.1.1.1.2" xref="S3.Ex2.m1.1.1.1.1.1.1.2.cmml">T</mi><mo fence="false" id="S3.Ex2.m1.1.1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.Ex2.m1.1.1.1.1.1.1.3" xref="S3.Ex2.m1.1.1.1.1.1.1.3.cmml">z</mi></mrow><mo stretchy="false" id="S3.Ex2.m1.1.1.1.1.1.3" xref="S3.Ex2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex2.m1.2.2.3" xref="S3.Ex2.m1.2.2.3.cmml">=</mo><mrow id="S3.Ex2.m1.2.2.2" xref="S3.Ex2.m1.2.2.2.cmml"><mstyle displaystyle="true" id="S3.Ex2.m1.2.2.2.2" xref="S3.Ex2.m1.2.2.2.2.cmml"><munderover id="S3.Ex2.m1.2.2.2.2a" xref="S3.Ex2.m1.2.2.2.2.cmml"><mo movablelimits="false" id="S3.Ex2.m1.2.2.2.2.2.2" xref="S3.Ex2.m1.2.2.2.2.2.2.cmml">∑</mo><mrow id="S3.Ex2.m1.2.2.2.2.2.3" xref="S3.Ex2.m1.2.2.2.2.2.3.cmml"><mi id="S3.Ex2.m1.2.2.2.2.2.3.2" xref="S3.Ex2.m1.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.Ex2.m1.2.2.2.2.2.3.1" xref="S3.Ex2.m1.2.2.2.2.2.3.1.cmml">=</mo><mn id="S3.Ex2.m1.2.2.2.2.2.3.3" xref="S3.Ex2.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><msub id="S3.Ex2.m1.2.2.2.2.3" xref="S3.Ex2.m1.2.2.2.2.3.cmml"><mi id="S3.Ex2.m1.2.2.2.2.3.2" xref="S3.Ex2.m1.2.2.2.2.3.2.cmml">T</mi><mrow id="S3.Ex2.m1.2.2.2.2.3.3" xref="S3.Ex2.m1.2.2.2.2.3.3.cmml"><mi id="S3.Ex2.m1.2.2.2.2.3.3.2" xref="S3.Ex2.m1.2.2.2.2.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.2.2.2.2.3.3.1" xref="S3.Ex2.m1.2.2.2.2.3.3.1.cmml">​</mo><mi id="S3.Ex2.m1.2.2.2.2.3.3.3" xref="S3.Ex2.m1.2.2.2.2.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.2.2.2.2.3.3.1a" xref="S3.Ex2.m1.2.2.2.2.3.3.1.cmml">​</mo><mi id="S3.Ex2.m1.2.2.2.2.3.3.4" xref="S3.Ex2.m1.2.2.2.2.3.3.4.cmml">x</mi></mrow></msub></munderover></mstyle><mrow id="S3.Ex2.m1.2.2.2.1" xref="S3.Ex2.m1.2.2.2.1.cmml"><mi id="S3.Ex2.m1.2.2.2.1.3" xref="S3.Ex2.m1.2.2.2.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.2.2.2.1.2" xref="S3.Ex2.m1.2.2.2.1.2.cmml">​</mo><mrow id="S3.Ex2.m1.2.2.2.1.1.1" xref="S3.Ex2.m1.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex2.m1.2.2.2.1.1.1.2" xref="S3.Ex2.m1.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.2.2.2.1.1.1.1" xref="S3.Ex2.m1.2.2.2.1.1.1.1.cmml"><msub id="S3.Ex2.m1.2.2.2.1.1.1.1.2" xref="S3.Ex2.m1.2.2.2.1.1.1.1.2.cmml"><mi id="S3.Ex2.m1.2.2.2.1.1.1.1.2.2" xref="S3.Ex2.m1.2.2.2.1.1.1.1.2.2.cmml">r</mi><mi id="S3.Ex2.m1.2.2.2.1.1.1.1.2.3" xref="S3.Ex2.m1.2.2.2.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.Ex2.m1.2.2.2.1.1.1.1.1" xref="S3.Ex2.m1.2.2.2.1.1.1.1.1.cmml">|</mo><msub id="S3.Ex2.m1.2.2.2.1.1.1.1.3" xref="S3.Ex2.m1.2.2.2.1.1.1.1.3.cmml"><mi id="S3.Ex2.m1.2.2.2.1.1.1.1.3.2" xref="S3.Ex2.m1.2.2.2.1.1.1.1.3.2.cmml">f</mi><mi id="S3.Ex2.m1.2.2.2.1.1.1.1.3.3" xref="S3.Ex2.m1.2.2.2.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.Ex2.m1.2.2.2.1.1.1.3" xref="S3.Ex2.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.2b"><apply id="S3.Ex2.m1.2.2.cmml" xref="S3.Ex2.m1.2.2"><eq id="S3.Ex2.m1.2.2.3.cmml" xref="S3.Ex2.m1.2.2.3"></eq><apply id="S3.Ex2.m1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1"><times id="S3.Ex2.m1.1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.1.2"></times><apply id="S3.Ex2.m1.1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.3.1.cmml" xref="S3.Ex2.m1.1.1.1.3">subscript</csymbol><ci id="S3.Ex2.m1.1.1.1.3.2.cmml" xref="S3.Ex2.m1.1.1.1.3.2">𝑞</ci><ci id="S3.Ex2.m1.1.1.1.3.3.cmml" xref="S3.Ex2.m1.1.1.1.3.3">𝜃</ci></apply><apply id="S3.Ex2.m1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex2.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.Ex2.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.2">𝑇</ci><ci id="S3.Ex2.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3">𝑧</ci></apply></apply><apply id="S3.Ex2.m1.2.2.2.cmml" xref="S3.Ex2.m1.2.2.2"><apply id="S3.Ex2.m1.2.2.2.2.cmml" xref="S3.Ex2.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.2.2.1.cmml" xref="S3.Ex2.m1.2.2.2.2">superscript</csymbol><apply id="S3.Ex2.m1.2.2.2.2.2.cmml" xref="S3.Ex2.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.2.2.2.1.cmml" xref="S3.Ex2.m1.2.2.2.2">subscript</csymbol><sum id="S3.Ex2.m1.2.2.2.2.2.2.cmml" xref="S3.Ex2.m1.2.2.2.2.2.2"></sum><apply id="S3.Ex2.m1.2.2.2.2.2.3.cmml" xref="S3.Ex2.m1.2.2.2.2.2.3"><eq id="S3.Ex2.m1.2.2.2.2.2.3.1.cmml" xref="S3.Ex2.m1.2.2.2.2.2.3.1"></eq><ci id="S3.Ex2.m1.2.2.2.2.2.3.2.cmml" xref="S3.Ex2.m1.2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.Ex2.m1.2.2.2.2.2.3.3.cmml" xref="S3.Ex2.m1.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="S3.Ex2.m1.2.2.2.2.3.cmml" xref="S3.Ex2.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.2.2.3.1.cmml" xref="S3.Ex2.m1.2.2.2.2.3">subscript</csymbol><ci id="S3.Ex2.m1.2.2.2.2.3.2.cmml" xref="S3.Ex2.m1.2.2.2.2.3.2">𝑇</ci><apply id="S3.Ex2.m1.2.2.2.2.3.3.cmml" xref="S3.Ex2.m1.2.2.2.2.3.3"><times id="S3.Ex2.m1.2.2.2.2.3.3.1.cmml" xref="S3.Ex2.m1.2.2.2.2.3.3.1"></times><ci id="S3.Ex2.m1.2.2.2.2.3.3.2.cmml" xref="S3.Ex2.m1.2.2.2.2.3.3.2">𝑚</ci><ci id="S3.Ex2.m1.2.2.2.2.3.3.3.cmml" xref="S3.Ex2.m1.2.2.2.2.3.3.3">𝑎</ci><ci id="S3.Ex2.m1.2.2.2.2.3.3.4.cmml" xref="S3.Ex2.m1.2.2.2.2.3.3.4">𝑥</ci></apply></apply></apply><apply id="S3.Ex2.m1.2.2.2.1.cmml" xref="S3.Ex2.m1.2.2.2.1"><times id="S3.Ex2.m1.2.2.2.1.2.cmml" xref="S3.Ex2.m1.2.2.2.1.2"></times><ci id="S3.Ex2.m1.2.2.2.1.3.cmml" xref="S3.Ex2.m1.2.2.2.1.3">𝑝</ci><apply id="S3.Ex2.m1.2.2.2.1.1.1.1.cmml" xref="S3.Ex2.m1.2.2.2.1.1.1"><csymbol cd="latexml" id="S3.Ex2.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.Ex2.m1.2.2.2.1.1.1.1.1">conditional</csymbol><apply id="S3.Ex2.m1.2.2.2.1.1.1.1.2.cmml" xref="S3.Ex2.m1.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.2.1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex2.m1.2.2.2.1.1.1.1.2.2.cmml" xref="S3.Ex2.m1.2.2.2.1.1.1.1.2.2">𝑟</ci><ci id="S3.Ex2.m1.2.2.2.1.1.1.1.2.3.cmml" xref="S3.Ex2.m1.2.2.2.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.Ex2.m1.2.2.2.1.1.1.1.3.cmml" xref="S3.Ex2.m1.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.2.1.1.1.1.3.1.cmml" xref="S3.Ex2.m1.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex2.m1.2.2.2.1.1.1.1.3.2.cmml" xref="S3.Ex2.m1.2.2.2.1.1.1.1.3.2">𝑓</ci><ci id="S3.Ex2.m1.2.2.2.1.1.1.1.3.3.cmml" xref="S3.Ex2.m1.2.2.2.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.2c">\displaystyle q_{\theta}(T|z)=\sum_{t=1}^{T_{max}}p(r_{t}|f_{t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.15" class="ltx_p">Putting it together, images are generated by sampling a scene structure <math id="S3.SS2.p2.10.m1.1" class="ltx_math_unparsed" alttext="T\sim q_{\theta}(\cdot|z)" display="inline"><semantics id="S3.SS2.p2.10.m1.1a"><mrow id="S3.SS2.p2.10.m1.1b"><mi id="S3.SS2.p2.10.m1.1.1">T</mi><mo id="S3.SS2.p2.10.m1.1.2">∼</mo><msub id="S3.SS2.p2.10.m1.1.3"><mi id="S3.SS2.p2.10.m1.1.3.2">q</mi><mi id="S3.SS2.p2.10.m1.1.3.3">θ</mi></msub><mrow id="S3.SS2.p2.10.m1.1.4"><mo stretchy="false" id="S3.SS2.p2.10.m1.1.4.1">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p2.10.m1.1.4.2">⋅</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS2.p2.10.m1.1.4.3">|</mo><mi id="S3.SS2.p2.10.m1.1.4.4">z</mi><mo stretchy="false" id="S3.SS2.p2.10.m1.1.4.5">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m1.1c">T\sim q_{\theta}(\cdot|z)</annotation></semantics></math> from the model, followed by sampling parameters for every node in the scene <math id="S3.SS2.p2.11.m2.1" class="ltx_math_unparsed" alttext="\alpha\sim q(\cdot|T)" display="inline"><semantics id="S3.SS2.p2.11.m2.1a"><mrow id="S3.SS2.p2.11.m2.1b"><mi id="S3.SS2.p2.11.m2.1.1">α</mi><mo id="S3.SS2.p2.11.m2.1.2">∼</mo><mi id="S3.SS2.p2.11.m2.1.3">q</mi><mrow id="S3.SS2.p2.11.m2.1.4"><mo stretchy="false" id="S3.SS2.p2.11.m2.1.4.1">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p2.11.m2.1.4.2">⋅</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS2.p2.11.m2.1.4.3">|</mo><mi id="S3.SS2.p2.11.m2.1.4.4">T</mi><mo stretchy="false" id="S3.SS2.p2.11.m2.1.4.5">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m2.1c">\alpha\sim q(\cdot|T)</annotation></semantics></math> and rendering an image <math id="S3.SS2.p2.12.m3.2" class="ltx_Math" alttext="v^{\prime}=R(T,\alpha)\sim q_{I}" display="inline"><semantics id="S3.SS2.p2.12.m3.2a"><mrow id="S3.SS2.p2.12.m3.2.3" xref="S3.SS2.p2.12.m3.2.3.cmml"><msup id="S3.SS2.p2.12.m3.2.3.2" xref="S3.SS2.p2.12.m3.2.3.2.cmml"><mi id="S3.SS2.p2.12.m3.2.3.2.2" xref="S3.SS2.p2.12.m3.2.3.2.2.cmml">v</mi><mo id="S3.SS2.p2.12.m3.2.3.2.3" xref="S3.SS2.p2.12.m3.2.3.2.3.cmml">′</mo></msup><mo id="S3.SS2.p2.12.m3.2.3.3" xref="S3.SS2.p2.12.m3.2.3.3.cmml">=</mo><mrow id="S3.SS2.p2.12.m3.2.3.4" xref="S3.SS2.p2.12.m3.2.3.4.cmml"><mi id="S3.SS2.p2.12.m3.2.3.4.2" xref="S3.SS2.p2.12.m3.2.3.4.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.12.m3.2.3.4.1" xref="S3.SS2.p2.12.m3.2.3.4.1.cmml">​</mo><mrow id="S3.SS2.p2.12.m3.2.3.4.3.2" xref="S3.SS2.p2.12.m3.2.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS2.p2.12.m3.2.3.4.3.2.1" xref="S3.SS2.p2.12.m3.2.3.4.3.1.cmml">(</mo><mi id="S3.SS2.p2.12.m3.1.1" xref="S3.SS2.p2.12.m3.1.1.cmml">T</mi><mo id="S3.SS2.p2.12.m3.2.3.4.3.2.2" xref="S3.SS2.p2.12.m3.2.3.4.3.1.cmml">,</mo><mi id="S3.SS2.p2.12.m3.2.2" xref="S3.SS2.p2.12.m3.2.2.cmml">α</mi><mo stretchy="false" id="S3.SS2.p2.12.m3.2.3.4.3.2.3" xref="S3.SS2.p2.12.m3.2.3.4.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p2.12.m3.2.3.5" xref="S3.SS2.p2.12.m3.2.3.5.cmml">∼</mo><msub id="S3.SS2.p2.12.m3.2.3.6" xref="S3.SS2.p2.12.m3.2.3.6.cmml"><mi id="S3.SS2.p2.12.m3.2.3.6.2" xref="S3.SS2.p2.12.m3.2.3.6.2.cmml">q</mi><mi id="S3.SS2.p2.12.m3.2.3.6.3" xref="S3.SS2.p2.12.m3.2.3.6.3.cmml">I</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.12.m3.2b"><apply id="S3.SS2.p2.12.m3.2.3.cmml" xref="S3.SS2.p2.12.m3.2.3"><and id="S3.SS2.p2.12.m3.2.3a.cmml" xref="S3.SS2.p2.12.m3.2.3"></and><apply id="S3.SS2.p2.12.m3.2.3b.cmml" xref="S3.SS2.p2.12.m3.2.3"><eq id="S3.SS2.p2.12.m3.2.3.3.cmml" xref="S3.SS2.p2.12.m3.2.3.3"></eq><apply id="S3.SS2.p2.12.m3.2.3.2.cmml" xref="S3.SS2.p2.12.m3.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.12.m3.2.3.2.1.cmml" xref="S3.SS2.p2.12.m3.2.3.2">superscript</csymbol><ci id="S3.SS2.p2.12.m3.2.3.2.2.cmml" xref="S3.SS2.p2.12.m3.2.3.2.2">𝑣</ci><ci id="S3.SS2.p2.12.m3.2.3.2.3.cmml" xref="S3.SS2.p2.12.m3.2.3.2.3">′</ci></apply><apply id="S3.SS2.p2.12.m3.2.3.4.cmml" xref="S3.SS2.p2.12.m3.2.3.4"><times id="S3.SS2.p2.12.m3.2.3.4.1.cmml" xref="S3.SS2.p2.12.m3.2.3.4.1"></times><ci id="S3.SS2.p2.12.m3.2.3.4.2.cmml" xref="S3.SS2.p2.12.m3.2.3.4.2">𝑅</ci><interval closure="open" id="S3.SS2.p2.12.m3.2.3.4.3.1.cmml" xref="S3.SS2.p2.12.m3.2.3.4.3.2"><ci id="S3.SS2.p2.12.m3.1.1.cmml" xref="S3.SS2.p2.12.m3.1.1">𝑇</ci><ci id="S3.SS2.p2.12.m3.2.2.cmml" xref="S3.SS2.p2.12.m3.2.2">𝛼</ci></interval></apply></apply><apply id="S3.SS2.p2.12.m3.2.3c.cmml" xref="S3.SS2.p2.12.m3.2.3"><csymbol cd="latexml" id="S3.SS2.p2.12.m3.2.3.5.cmml" xref="S3.SS2.p2.12.m3.2.3.5">similar-to</csymbol><share href="#S3.SS2.p2.12.m3.2.3.4.cmml" id="S3.SS2.p2.12.m3.2.3d.cmml" xref="S3.SS2.p2.12.m3.2.3"></share><apply id="S3.SS2.p2.12.m3.2.3.6.cmml" xref="S3.SS2.p2.12.m3.2.3.6"><csymbol cd="ambiguous" id="S3.SS2.p2.12.m3.2.3.6.1.cmml" xref="S3.SS2.p2.12.m3.2.3.6">subscript</csymbol><ci id="S3.SS2.p2.12.m3.2.3.6.2.cmml" xref="S3.SS2.p2.12.m3.2.3.6.2">𝑞</ci><ci id="S3.SS2.p2.12.m3.2.3.6.3.cmml" xref="S3.SS2.p2.12.m3.2.3.6.3">𝐼</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.12.m3.2c">v^{\prime}=R(T,\alpha)\sim q_{I}</annotation></semantics></math>. For some <math id="S3.SS2.p2.13.m4.1" class="ltx_Math" alttext="v^{\prime}\sim q_{I}" display="inline"><semantics id="S3.SS2.p2.13.m4.1a"><mrow id="S3.SS2.p2.13.m4.1.1" xref="S3.SS2.p2.13.m4.1.1.cmml"><msup id="S3.SS2.p2.13.m4.1.1.2" xref="S3.SS2.p2.13.m4.1.1.2.cmml"><mi id="S3.SS2.p2.13.m4.1.1.2.2" xref="S3.SS2.p2.13.m4.1.1.2.2.cmml">v</mi><mo id="S3.SS2.p2.13.m4.1.1.2.3" xref="S3.SS2.p2.13.m4.1.1.2.3.cmml">′</mo></msup><mo id="S3.SS2.p2.13.m4.1.1.1" xref="S3.SS2.p2.13.m4.1.1.1.cmml">∼</mo><msub id="S3.SS2.p2.13.m4.1.1.3" xref="S3.SS2.p2.13.m4.1.1.3.cmml"><mi id="S3.SS2.p2.13.m4.1.1.3.2" xref="S3.SS2.p2.13.m4.1.1.3.2.cmml">q</mi><mi id="S3.SS2.p2.13.m4.1.1.3.3" xref="S3.SS2.p2.13.m4.1.1.3.3.cmml">I</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.13.m4.1b"><apply id="S3.SS2.p2.13.m4.1.1.cmml" xref="S3.SS2.p2.13.m4.1.1"><csymbol cd="latexml" id="S3.SS2.p2.13.m4.1.1.1.cmml" xref="S3.SS2.p2.13.m4.1.1.1">similar-to</csymbol><apply id="S3.SS2.p2.13.m4.1.1.2.cmml" xref="S3.SS2.p2.13.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.13.m4.1.1.2.1.cmml" xref="S3.SS2.p2.13.m4.1.1.2">superscript</csymbol><ci id="S3.SS2.p2.13.m4.1.1.2.2.cmml" xref="S3.SS2.p2.13.m4.1.1.2.2">𝑣</ci><ci id="S3.SS2.p2.13.m4.1.1.2.3.cmml" xref="S3.SS2.p2.13.m4.1.1.2.3">′</ci></apply><apply id="S3.SS2.p2.13.m4.1.1.3.cmml" xref="S3.SS2.p2.13.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.13.m4.1.1.3.1.cmml" xref="S3.SS2.p2.13.m4.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.13.m4.1.1.3.2.cmml" xref="S3.SS2.p2.13.m4.1.1.3.2">𝑞</ci><ci id="S3.SS2.p2.13.m4.1.1.3.3.cmml" xref="S3.SS2.p2.13.m4.1.1.3.3">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.13.m4.1c">v^{\prime}\sim q_{I}</annotation></semantics></math>, with parameters <math id="S3.SS2.p2.14.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS2.p2.14.m5.1a"><mi id="S3.SS2.p2.14.m5.1.1" xref="S3.SS2.p2.14.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.14.m5.1b"><ci id="S3.SS2.p2.14.m5.1.1.cmml" xref="S3.SS2.p2.14.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.14.m5.1c">\alpha</annotation></semantics></math> and structure <math id="S3.SS2.p2.15.m6.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS2.p2.15.m6.1a"><mi id="S3.SS2.p2.15.m6.1.1" xref="S3.SS2.p2.15.m6.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.15.m6.1b"><ci id="S3.SS2.p2.15.m6.1.1.cmml" xref="S3.SS2.p2.15.m6.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.15.m6.1c">T</annotation></semantics></math>, we assume<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>This equality does not hold in general for rendering, but it worked well in practice</span></span></span>,</p>
<table id="S6.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex3.m1.3" class="ltx_Math" alttext="\displaystyle q_{I}(v^{\prime}|z)=q(\alpha|T)q_{\theta}(T|z)" display="inline"><semantics id="S3.Ex3.m1.3a"><mrow id="S3.Ex3.m1.3.3" xref="S3.Ex3.m1.3.3.cmml"><mrow id="S3.Ex3.m1.1.1.1" xref="S3.Ex3.m1.1.1.1.cmml"><msub id="S3.Ex3.m1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.3.cmml"><mi id="S3.Ex3.m1.1.1.1.3.2" xref="S3.Ex3.m1.1.1.1.3.2.cmml">q</mi><mi id="S3.Ex3.m1.1.1.1.3.3" xref="S3.Ex3.m1.1.1.1.3.3.cmml">I</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex3.m1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex3.m1.1.1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml"><msup id="S3.Ex3.m1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.2.2" xref="S3.Ex3.m1.1.1.1.1.1.1.2.2.cmml">v</mi><mo id="S3.Ex3.m1.1.1.1.1.1.1.2.3" xref="S3.Ex3.m1.1.1.1.1.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="S3.Ex3.m1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.Ex3.m1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.1.3.cmml">z</mi></mrow><mo stretchy="false" id="S3.Ex3.m1.1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex3.m1.3.3.4" xref="S3.Ex3.m1.3.3.4.cmml">=</mo><mrow id="S3.Ex3.m1.3.3.3" xref="S3.Ex3.m1.3.3.3.cmml"><mi id="S3.Ex3.m1.3.3.3.4" xref="S3.Ex3.m1.3.3.3.4.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.3.3.3.3" xref="S3.Ex3.m1.3.3.3.3.cmml">​</mo><mrow id="S3.Ex3.m1.2.2.2.1.1" xref="S3.Ex3.m1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.Ex3.m1.2.2.2.1.1.2" xref="S3.Ex3.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.2.2.2.1.1.1" xref="S3.Ex3.m1.2.2.2.1.1.1.cmml"><mi id="S3.Ex3.m1.2.2.2.1.1.1.2" xref="S3.Ex3.m1.2.2.2.1.1.1.2.cmml">α</mi><mo fence="false" id="S3.Ex3.m1.2.2.2.1.1.1.1" xref="S3.Ex3.m1.2.2.2.1.1.1.1.cmml">|</mo><mi id="S3.Ex3.m1.2.2.2.1.1.1.3" xref="S3.Ex3.m1.2.2.2.1.1.1.3.cmml">T</mi></mrow><mo stretchy="false" id="S3.Ex3.m1.2.2.2.1.1.3" xref="S3.Ex3.m1.2.2.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.3.3.3.3a" xref="S3.Ex3.m1.3.3.3.3.cmml">​</mo><msub id="S3.Ex3.m1.3.3.3.5" xref="S3.Ex3.m1.3.3.3.5.cmml"><mi id="S3.Ex3.m1.3.3.3.5.2" xref="S3.Ex3.m1.3.3.3.5.2.cmml">q</mi><mi id="S3.Ex3.m1.3.3.3.5.3" xref="S3.Ex3.m1.3.3.3.5.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.3.3.3.3b" xref="S3.Ex3.m1.3.3.3.3.cmml">​</mo><mrow id="S3.Ex3.m1.3.3.3.2.1" xref="S3.Ex3.m1.3.3.3.2.1.1.cmml"><mo stretchy="false" id="S3.Ex3.m1.3.3.3.2.1.2" xref="S3.Ex3.m1.3.3.3.2.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.3.3.3.2.1.1" xref="S3.Ex3.m1.3.3.3.2.1.1.cmml"><mi id="S3.Ex3.m1.3.3.3.2.1.1.2" xref="S3.Ex3.m1.3.3.3.2.1.1.2.cmml">T</mi><mo fence="false" id="S3.Ex3.m1.3.3.3.2.1.1.1" xref="S3.Ex3.m1.3.3.3.2.1.1.1.cmml">|</mo><mi id="S3.Ex3.m1.3.3.3.2.1.1.3" xref="S3.Ex3.m1.3.3.3.2.1.1.3.cmml">z</mi></mrow><mo stretchy="false" id="S3.Ex3.m1.3.3.3.2.1.3" xref="S3.Ex3.m1.3.3.3.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.3b"><apply id="S3.Ex3.m1.3.3.cmml" xref="S3.Ex3.m1.3.3"><eq id="S3.Ex3.m1.3.3.4.cmml" xref="S3.Ex3.m1.3.3.4"></eq><apply id="S3.Ex3.m1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1"><times id="S3.Ex3.m1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.2"></times><apply id="S3.Ex3.m1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.3.1.cmml" xref="S3.Ex3.m1.1.1.1.3">subscript</csymbol><ci id="S3.Ex3.m1.1.1.1.3.2.cmml" xref="S3.Ex3.m1.1.1.1.3.2">𝑞</ci><ci id="S3.Ex3.m1.1.1.1.3.3.cmml" xref="S3.Ex3.m1.1.1.1.3.3">𝐼</ci></apply><apply id="S3.Ex3.m1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex3.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.Ex3.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2.2">𝑣</ci><ci id="S3.Ex3.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="S3.Ex3.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.3">𝑧</ci></apply></apply><apply id="S3.Ex3.m1.3.3.3.cmml" xref="S3.Ex3.m1.3.3.3"><times id="S3.Ex3.m1.3.3.3.3.cmml" xref="S3.Ex3.m1.3.3.3.3"></times><ci id="S3.Ex3.m1.3.3.3.4.cmml" xref="S3.Ex3.m1.3.3.3.4">𝑞</ci><apply id="S3.Ex3.m1.2.2.2.1.1.1.cmml" xref="S3.Ex3.m1.2.2.2.1.1"><csymbol cd="latexml" id="S3.Ex3.m1.2.2.2.1.1.1.1.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1">conditional</csymbol><ci id="S3.Ex3.m1.2.2.2.1.1.1.2.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.2">𝛼</ci><ci id="S3.Ex3.m1.2.2.2.1.1.1.3.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.3">𝑇</ci></apply><apply id="S3.Ex3.m1.3.3.3.5.cmml" xref="S3.Ex3.m1.3.3.3.5"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.3.5.1.cmml" xref="S3.Ex3.m1.3.3.3.5">subscript</csymbol><ci id="S3.Ex3.m1.3.3.3.5.2.cmml" xref="S3.Ex3.m1.3.3.3.5.2">𝑞</ci><ci id="S3.Ex3.m1.3.3.3.5.3.cmml" xref="S3.Ex3.m1.3.3.3.5.3">𝜃</ci></apply><apply id="S3.Ex3.m1.3.3.3.2.1.1.cmml" xref="S3.Ex3.m1.3.3.3.2.1"><csymbol cd="latexml" id="S3.Ex3.m1.3.3.3.2.1.1.1.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1">conditional</csymbol><ci id="S3.Ex3.m1.3.3.3.2.1.1.2.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.2">𝑇</ci><ci id="S3.Ex3.m1.3.3.3.2.1.1.3.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.3">𝑧</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.3c">\displaystyle q_{I}(v^{\prime}|z)=q(\alpha|T)q_{\theta}(T|z)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Training</h3>

<div id="S3.SS3.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.p1.1" class="ltx_p">Training such a generative model is commonly done using <em id="S3.SS3.p1.1.1" class="ltx_emph ltx_font_italic">variational inference</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>
or by optimizing a measure of <em id="S3.SS3.p1.1.2" class="ltx_emph ltx_font_italic">distribution similarity</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>.
Variational Inference allows using reconstruction based objectives by introducing an approximate learnt posterior. Our attempts at using variational inference to train this model failed due to the
complexity coming from discrete sampling and having a renderer in the generative process. Moreover,
the recognition network here would amount to doing inverse graphics – an extremely
challenging problem <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> in itself. Hence, we optimize a measure of distribution similarity of the generated and target data. We do not explore using a <em id="S3.SS3.p1.1.3" class="ltx_emph ltx_font_italic">trained critic</em> due to the clear visual discrepancy between rendered and real images that a critic can exploit. Moreover, adversarial training is known to be notoriously difficult for discrete data. We note that recent work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> has succeeded in adversarial training of a generative model of discrete brush strokes with reinforcement learning (RL), by carefully limiting the critic’s capacity. We similarly employ RL to train our discrete generative model of scene graphs. While <em id="S3.SS3.p1.1.4" class="ltx_emph ltx_font_italic">two sample tests</em>, such as MMD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> have been used in previous work to estimate and minimize the distance between two empirical distributions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, training with MMD and RL resulted in credit-assignment issues as it is a single score for the similarity of two full sets(batches) of data. Instead, our metric can be computed for every sample, which greatly helps training as shown empirically in Sec. <a href="#S4" title="4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.p2.10" class="ltx_p"><span id="S3.SS3.p2.10.1" class="ltx_text ltx_font_bold">Distribution Matching:</span>
We train the generative model to match the distribution of features of the real data
in the latent space of some feature extractor <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="\varphi" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">φ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝜑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\varphi</annotation></semantics></math>. We define the real feature distribution <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="p_{f}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><msub id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">p</mi><mi id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">𝑝</ci><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">p_{f}</annotation></semantics></math> s.t <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="F\sim p_{f}\iff F=\varphi(v)" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1.2" xref="S3.SS3.p2.3.m3.1.2.cmml"><mrow id="S3.SS3.p2.3.m3.1.2.2" xref="S3.SS3.p2.3.m3.1.2.2.cmml"><mi id="S3.SS3.p2.3.m3.1.2.2.2" xref="S3.SS3.p2.3.m3.1.2.2.2.cmml">F</mi><mo id="S3.SS3.p2.3.m3.1.2.2.1" xref="S3.SS3.p2.3.m3.1.2.2.1.cmml">∼</mo><msub id="S3.SS3.p2.3.m3.1.2.2.3" xref="S3.SS3.p2.3.m3.1.2.2.3.cmml"><mi id="S3.SS3.p2.3.m3.1.2.2.3.2" xref="S3.SS3.p2.3.m3.1.2.2.3.2.cmml">p</mi><mi id="S3.SS3.p2.3.m3.1.2.2.3.3" xref="S3.SS3.p2.3.m3.1.2.2.3.3.cmml">f</mi></msub></mrow><mo stretchy="false" id="S3.SS3.p2.3.m3.1.2.1" xref="S3.SS3.p2.3.m3.1.2.1.cmml">⇔</mo><mrow id="S3.SS3.p2.3.m3.1.2.3" xref="S3.SS3.p2.3.m3.1.2.3.cmml"><mi id="S3.SS3.p2.3.m3.1.2.3.2" xref="S3.SS3.p2.3.m3.1.2.3.2.cmml">F</mi><mo id="S3.SS3.p2.3.m3.1.2.3.1" xref="S3.SS3.p2.3.m3.1.2.3.1.cmml">=</mo><mrow id="S3.SS3.p2.3.m3.1.2.3.3" xref="S3.SS3.p2.3.m3.1.2.3.3.cmml"><mi id="S3.SS3.p2.3.m3.1.2.3.3.2" xref="S3.SS3.p2.3.m3.1.2.3.3.2.cmml">φ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.3.m3.1.2.3.3.1" xref="S3.SS3.p2.3.m3.1.2.3.3.1.cmml">​</mo><mrow id="S3.SS3.p2.3.m3.1.2.3.3.3.2" xref="S3.SS3.p2.3.m3.1.2.3.3.cmml"><mo stretchy="false" id="S3.SS3.p2.3.m3.1.2.3.3.3.2.1" xref="S3.SS3.p2.3.m3.1.2.3.3.cmml">(</mo><mi id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">v</mi><mo stretchy="false" id="S3.SS3.p2.3.m3.1.2.3.3.3.2.2" xref="S3.SS3.p2.3.m3.1.2.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.2.cmml" xref="S3.SS3.p2.3.m3.1.2"><csymbol cd="latexml" id="S3.SS3.p2.3.m3.1.2.1.cmml" xref="S3.SS3.p2.3.m3.1.2.1">iff</csymbol><apply id="S3.SS3.p2.3.m3.1.2.2.cmml" xref="S3.SS3.p2.3.m3.1.2.2"><csymbol cd="latexml" id="S3.SS3.p2.3.m3.1.2.2.1.cmml" xref="S3.SS3.p2.3.m3.1.2.2.1">similar-to</csymbol><ci id="S3.SS3.p2.3.m3.1.2.2.2.cmml" xref="S3.SS3.p2.3.m3.1.2.2.2">𝐹</ci><apply id="S3.SS3.p2.3.m3.1.2.2.3.cmml" xref="S3.SS3.p2.3.m3.1.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.2.2.3.1.cmml" xref="S3.SS3.p2.3.m3.1.2.2.3">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.2.2.3.2.cmml" xref="S3.SS3.p2.3.m3.1.2.2.3.2">𝑝</ci><ci id="S3.SS3.p2.3.m3.1.2.2.3.3.cmml" xref="S3.SS3.p2.3.m3.1.2.2.3.3">𝑓</ci></apply></apply><apply id="S3.SS3.p2.3.m3.1.2.3.cmml" xref="S3.SS3.p2.3.m3.1.2.3"><eq id="S3.SS3.p2.3.m3.1.2.3.1.cmml" xref="S3.SS3.p2.3.m3.1.2.3.1"></eq><ci id="S3.SS3.p2.3.m3.1.2.3.2.cmml" xref="S3.SS3.p2.3.m3.1.2.3.2">𝐹</ci><apply id="S3.SS3.p2.3.m3.1.2.3.3.cmml" xref="S3.SS3.p2.3.m3.1.2.3.3"><times id="S3.SS3.p2.3.m3.1.2.3.3.1.cmml" xref="S3.SS3.p2.3.m3.1.2.3.3.1"></times><ci id="S3.SS3.p2.3.m3.1.2.3.3.2.cmml" xref="S3.SS3.p2.3.m3.1.2.3.3.2">𝜑</ci><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">F\sim p_{f}\iff F=\varphi(v)</annotation></semantics></math>
for some <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="v\sim p_{I}" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><mrow id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">v</mi><mo id="S3.SS3.p2.4.m4.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.cmml">∼</mo><msub id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml"><mi id="S3.SS3.p2.4.m4.1.1.3.2" xref="S3.SS3.p2.4.m4.1.1.3.2.cmml">p</mi><mi id="S3.SS3.p2.4.m4.1.1.3.3" xref="S3.SS3.p2.4.m4.1.1.3.3.cmml">I</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="latexml" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1">similar-to</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">𝑣</ci><apply id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.3.1.cmml" xref="S3.SS3.p2.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.3.2.cmml" xref="S3.SS3.p2.4.m4.1.1.3.2">𝑝</ci><ci id="S3.SS3.p2.4.m4.1.1.3.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3.3">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">v\sim p_{I}</annotation></semantics></math>. Similarly we define the generated feature distribution <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="q_{f}" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><msub id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">q</mi><mi id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">𝑞</ci><ci id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">q_{f}</annotation></semantics></math> s.t <math id="S3.SS3.p2.6.m6.1" class="ltx_Math" alttext="F\sim q_{f}\iff F=\varphi(v)" display="inline"><semantics id="S3.SS3.p2.6.m6.1a"><mrow id="S3.SS3.p2.6.m6.1.2" xref="S3.SS3.p2.6.m6.1.2.cmml"><mrow id="S3.SS3.p2.6.m6.1.2.2" xref="S3.SS3.p2.6.m6.1.2.2.cmml"><mi id="S3.SS3.p2.6.m6.1.2.2.2" xref="S3.SS3.p2.6.m6.1.2.2.2.cmml">F</mi><mo id="S3.SS3.p2.6.m6.1.2.2.1" xref="S3.SS3.p2.6.m6.1.2.2.1.cmml">∼</mo><msub id="S3.SS3.p2.6.m6.1.2.2.3" xref="S3.SS3.p2.6.m6.1.2.2.3.cmml"><mi id="S3.SS3.p2.6.m6.1.2.2.3.2" xref="S3.SS3.p2.6.m6.1.2.2.3.2.cmml">q</mi><mi id="S3.SS3.p2.6.m6.1.2.2.3.3" xref="S3.SS3.p2.6.m6.1.2.2.3.3.cmml">f</mi></msub></mrow><mo stretchy="false" id="S3.SS3.p2.6.m6.1.2.1" xref="S3.SS3.p2.6.m6.1.2.1.cmml">⇔</mo><mrow id="S3.SS3.p2.6.m6.1.2.3" xref="S3.SS3.p2.6.m6.1.2.3.cmml"><mi id="S3.SS3.p2.6.m6.1.2.3.2" xref="S3.SS3.p2.6.m6.1.2.3.2.cmml">F</mi><mo id="S3.SS3.p2.6.m6.1.2.3.1" xref="S3.SS3.p2.6.m6.1.2.3.1.cmml">=</mo><mrow id="S3.SS3.p2.6.m6.1.2.3.3" xref="S3.SS3.p2.6.m6.1.2.3.3.cmml"><mi id="S3.SS3.p2.6.m6.1.2.3.3.2" xref="S3.SS3.p2.6.m6.1.2.3.3.2.cmml">φ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m6.1.2.3.3.1" xref="S3.SS3.p2.6.m6.1.2.3.3.1.cmml">​</mo><mrow id="S3.SS3.p2.6.m6.1.2.3.3.3.2" xref="S3.SS3.p2.6.m6.1.2.3.3.cmml"><mo stretchy="false" id="S3.SS3.p2.6.m6.1.2.3.3.3.2.1" xref="S3.SS3.p2.6.m6.1.2.3.3.cmml">(</mo><mi id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml">v</mi><mo stretchy="false" id="S3.SS3.p2.6.m6.1.2.3.3.3.2.2" xref="S3.SS3.p2.6.m6.1.2.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><apply id="S3.SS3.p2.6.m6.1.2.cmml" xref="S3.SS3.p2.6.m6.1.2"><csymbol cd="latexml" id="S3.SS3.p2.6.m6.1.2.1.cmml" xref="S3.SS3.p2.6.m6.1.2.1">iff</csymbol><apply id="S3.SS3.p2.6.m6.1.2.2.cmml" xref="S3.SS3.p2.6.m6.1.2.2"><csymbol cd="latexml" id="S3.SS3.p2.6.m6.1.2.2.1.cmml" xref="S3.SS3.p2.6.m6.1.2.2.1">similar-to</csymbol><ci id="S3.SS3.p2.6.m6.1.2.2.2.cmml" xref="S3.SS3.p2.6.m6.1.2.2.2">𝐹</ci><apply id="S3.SS3.p2.6.m6.1.2.2.3.cmml" xref="S3.SS3.p2.6.m6.1.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.1.2.2.3.1.cmml" xref="S3.SS3.p2.6.m6.1.2.2.3">subscript</csymbol><ci id="S3.SS3.p2.6.m6.1.2.2.3.2.cmml" xref="S3.SS3.p2.6.m6.1.2.2.3.2">𝑞</ci><ci id="S3.SS3.p2.6.m6.1.2.2.3.3.cmml" xref="S3.SS3.p2.6.m6.1.2.2.3.3">𝑓</ci></apply></apply><apply id="S3.SS3.p2.6.m6.1.2.3.cmml" xref="S3.SS3.p2.6.m6.1.2.3"><eq id="S3.SS3.p2.6.m6.1.2.3.1.cmml" xref="S3.SS3.p2.6.m6.1.2.3.1"></eq><ci id="S3.SS3.p2.6.m6.1.2.3.2.cmml" xref="S3.SS3.p2.6.m6.1.2.3.2">𝐹</ci><apply id="S3.SS3.p2.6.m6.1.2.3.3.cmml" xref="S3.SS3.p2.6.m6.1.2.3.3"><times id="S3.SS3.p2.6.m6.1.2.3.3.1.cmml" xref="S3.SS3.p2.6.m6.1.2.3.3.1"></times><ci id="S3.SS3.p2.6.m6.1.2.3.3.2.cmml" xref="S3.SS3.p2.6.m6.1.2.3.3.2">𝜑</ci><ci id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">F\sim q_{f}\iff F=\varphi(v)</annotation></semantics></math>
for some <math id="S3.SS3.p2.7.m7.1" class="ltx_Math" alttext="v\sim q_{I}" display="inline"><semantics id="S3.SS3.p2.7.m7.1a"><mrow id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml"><mi id="S3.SS3.p2.7.m7.1.1.2" xref="S3.SS3.p2.7.m7.1.1.2.cmml">v</mi><mo id="S3.SS3.p2.7.m7.1.1.1" xref="S3.SS3.p2.7.m7.1.1.1.cmml">∼</mo><msub id="S3.SS3.p2.7.m7.1.1.3" xref="S3.SS3.p2.7.m7.1.1.3.cmml"><mi id="S3.SS3.p2.7.m7.1.1.3.2" xref="S3.SS3.p2.7.m7.1.1.3.2.cmml">q</mi><mi id="S3.SS3.p2.7.m7.1.1.3.3" xref="S3.SS3.p2.7.m7.1.1.3.3.cmml">I</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><apply id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1"><csymbol cd="latexml" id="S3.SS3.p2.7.m7.1.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1.1">similar-to</csymbol><ci id="S3.SS3.p2.7.m7.1.1.2.cmml" xref="S3.SS3.p2.7.m7.1.1.2">𝑣</ci><apply id="S3.SS3.p2.7.m7.1.1.3.cmml" xref="S3.SS3.p2.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m7.1.1.3.1.cmml" xref="S3.SS3.p2.7.m7.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.7.m7.1.1.3.2.cmml" xref="S3.SS3.p2.7.m7.1.1.3.2">𝑞</ci><ci id="S3.SS3.p2.7.m7.1.1.3.3.cmml" xref="S3.SS3.p2.7.m7.1.1.3.3">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">v\sim q_{I}</annotation></semantics></math>. We accomplish distribution matching by approximately computing <math id="S3.SS3.p2.8.m8.2" class="ltx_Math" alttext="p_{f},q_{f}" display="inline"><semantics id="S3.SS3.p2.8.m8.2a"><mrow id="S3.SS3.p2.8.m8.2.2.2" xref="S3.SS3.p2.8.m8.2.2.3.cmml"><msub id="S3.SS3.p2.8.m8.1.1.1.1" xref="S3.SS3.p2.8.m8.1.1.1.1.cmml"><mi id="S3.SS3.p2.8.m8.1.1.1.1.2" xref="S3.SS3.p2.8.m8.1.1.1.1.2.cmml">p</mi><mi id="S3.SS3.p2.8.m8.1.1.1.1.3" xref="S3.SS3.p2.8.m8.1.1.1.1.3.cmml">f</mi></msub><mo id="S3.SS3.p2.8.m8.2.2.2.3" xref="S3.SS3.p2.8.m8.2.2.3.cmml">,</mo><msub id="S3.SS3.p2.8.m8.2.2.2.2" xref="S3.SS3.p2.8.m8.2.2.2.2.cmml"><mi id="S3.SS3.p2.8.m8.2.2.2.2.2" xref="S3.SS3.p2.8.m8.2.2.2.2.2.cmml">q</mi><mi id="S3.SS3.p2.8.m8.2.2.2.2.3" xref="S3.SS3.p2.8.m8.2.2.2.2.3.cmml">f</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.2b"><list id="S3.SS3.p2.8.m8.2.2.3.cmml" xref="S3.SS3.p2.8.m8.2.2.2"><apply id="S3.SS3.p2.8.m8.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.1.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.8.m8.1.1.1.1.2.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.2">𝑝</ci><ci id="S3.SS3.p2.8.m8.1.1.1.1.3.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.3">𝑓</ci></apply><apply id="S3.SS3.p2.8.m8.2.2.2.2.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.2.2.2.2.1.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p2.8.m8.2.2.2.2.2.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.2">𝑞</ci><ci id="S3.SS3.p2.8.m8.2.2.2.2.3.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.3">𝑓</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.2c">p_{f},q_{f}</annotation></semantics></math> from samples and minimizing the KL divergence from <math id="S3.SS3.p2.9.m9.1" class="ltx_Math" alttext="p_{f}" display="inline"><semantics id="S3.SS3.p2.9.m9.1a"><msub id="S3.SS3.p2.9.m9.1.1" xref="S3.SS3.p2.9.m9.1.1.cmml"><mi id="S3.SS3.p2.9.m9.1.1.2" xref="S3.SS3.p2.9.m9.1.1.2.cmml">p</mi><mi id="S3.SS3.p2.9.m9.1.1.3" xref="S3.SS3.p2.9.m9.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m9.1b"><apply id="S3.SS3.p2.9.m9.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m9.1.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.p2.9.m9.1.1.2.cmml" xref="S3.SS3.p2.9.m9.1.1.2">𝑝</ci><ci id="S3.SS3.p2.9.m9.1.1.3.cmml" xref="S3.SS3.p2.9.m9.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m9.1c">p_{f}</annotation></semantics></math> to
<math id="S3.SS3.p2.10.m10.1" class="ltx_Math" alttext="q_{f}" display="inline"><semantics id="S3.SS3.p2.10.m10.1a"><msub id="S3.SS3.p2.10.m10.1.1" xref="S3.SS3.p2.10.m10.1.1.cmml"><mi id="S3.SS3.p2.10.m10.1.1.2" xref="S3.SS3.p2.10.m10.1.1.2.cmml">q</mi><mi id="S3.SS3.p2.10.m10.1.1.3" xref="S3.SS3.p2.10.m10.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m10.1b"><apply id="S3.SS3.p2.10.m10.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.10.m10.1.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS3.p2.10.m10.1.1.2.cmml" xref="S3.SS3.p2.10.m10.1.1.2">𝑞</ci><ci id="S3.SS3.p2.10.m10.1.1.3.cmml" xref="S3.SS3.p2.10.m10.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m10.1c">q_{f}</annotation></semantics></math>. Our training objective is</p>
<table id="S6.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex4.m1.1" class="ltx_Math" alttext="\displaystyle\min_{\theta}" display="inline"><semantics id="S3.Ex4.m1.1a"><munder id="S3.Ex4.m1.1.1" xref="S3.Ex4.m1.1.1.cmml"><mi id="S3.Ex4.m1.1.1.2" xref="S3.Ex4.m1.1.1.2.cmml">min</mi><mi id="S3.Ex4.m1.1.1.3" xref="S3.Ex4.m1.1.1.3.cmml">θ</mi></munder><annotation-xml encoding="MathML-Content" id="S3.Ex4.m1.1b"><apply id="S3.Ex4.m1.1.1.cmml" xref="S3.Ex4.m1.1.1"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.1.cmml" xref="S3.Ex4.m1.1.1">subscript</csymbol><min id="S3.Ex4.m1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.2"></min><ci id="S3.Ex4.m1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m1.1c">\displaystyle\min_{\theta}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex4.m2.1" class="ltx_math_unparsed" alttext="\displaystyle\quad KL(q_{f}||p_{f})" display="inline"><semantics id="S3.Ex4.m2.1a"><mrow id="S3.Ex4.m2.1b"><mi id="S3.Ex4.m2.1.1">K</mi><mi id="S3.Ex4.m2.1.2">L</mi><mrow id="S3.Ex4.m2.1.3"><mo stretchy="false" id="S3.Ex4.m2.1.3.1">(</mo><msub id="S3.Ex4.m2.1.3.2"><mi id="S3.Ex4.m2.1.3.2.2">q</mi><mi id="S3.Ex4.m2.1.3.2.3">f</mi></msub><mo fence="false" rspace="0.167em" stretchy="false" id="S3.Ex4.m2.1.3.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.Ex4.m2.1.3.4">|</mo><msub id="S3.Ex4.m2.1.3.5"><mi id="S3.Ex4.m2.1.3.5.2">p</mi><mi id="S3.Ex4.m2.1.3.5.3">f</mi></msub><mo stretchy="false" id="S3.Ex4.m2.1.3.6">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.Ex4.m2.1c">\displaystyle\quad KL(q_{f}||p_{f})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex5.m1.1" class="ltx_Math" alttext="\displaystyle\min_{\theta}" display="inline"><semantics id="S3.Ex5.m1.1a"><munder id="S3.Ex5.m1.1.1" xref="S3.Ex5.m1.1.1.cmml"><mi id="S3.Ex5.m1.1.1.2" xref="S3.Ex5.m1.1.1.2.cmml">min</mi><mi id="S3.Ex5.m1.1.1.3" xref="S3.Ex5.m1.1.1.3.cmml">θ</mi></munder><annotation-xml encoding="MathML-Content" id="S3.Ex5.m1.1b"><apply id="S3.Ex5.m1.1.1.cmml" xref="S3.Ex5.m1.1.1"><csymbol cd="ambiguous" id="S3.Ex5.m1.1.1.1.cmml" xref="S3.Ex5.m1.1.1">subscript</csymbol><min id="S3.Ex5.m1.1.1.2.cmml" xref="S3.Ex5.m1.1.1.2"></min><ci id="S3.Ex5.m1.1.1.3.cmml" xref="S3.Ex5.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5.m1.1c">\displaystyle\min_{\theta}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex5.m2.3" class="ltx_Math" alttext="\displaystyle\quad\mathbb{E}_{F\sim q_{f}}[\log q_{f}(F)-\log p_{f}(F)]" display="inline"><semantics id="S3.Ex5.m2.3a"><mrow id="S3.Ex5.m2.3.3" xref="S3.Ex5.m2.3.3.cmml"><msub id="S3.Ex5.m2.3.3.3" xref="S3.Ex5.m2.3.3.3.cmml"><mi id="S3.Ex5.m2.3.3.3.2" xref="S3.Ex5.m2.3.3.3.2.cmml">𝔼</mi><mrow id="S3.Ex5.m2.3.3.3.3" xref="S3.Ex5.m2.3.3.3.3.cmml"><mi id="S3.Ex5.m2.3.3.3.3.2" xref="S3.Ex5.m2.3.3.3.3.2.cmml">F</mi><mo id="S3.Ex5.m2.3.3.3.3.1" xref="S3.Ex5.m2.3.3.3.3.1.cmml">∼</mo><msub id="S3.Ex5.m2.3.3.3.3.3" xref="S3.Ex5.m2.3.3.3.3.3.cmml"><mi id="S3.Ex5.m2.3.3.3.3.3.2" xref="S3.Ex5.m2.3.3.3.3.3.2.cmml">q</mi><mi id="S3.Ex5.m2.3.3.3.3.3.3" xref="S3.Ex5.m2.3.3.3.3.3.3.cmml">f</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex5.m2.3.3.2" xref="S3.Ex5.m2.3.3.2.cmml">​</mo><mrow id="S3.Ex5.m2.3.3.1.1" xref="S3.Ex5.m2.3.3.1.2.cmml"><mo stretchy="false" id="S3.Ex5.m2.3.3.1.1.2" xref="S3.Ex5.m2.3.3.1.2.1.cmml">[</mo><mrow id="S3.Ex5.m2.3.3.1.1.1" xref="S3.Ex5.m2.3.3.1.1.1.cmml"><mrow id="S3.Ex5.m2.3.3.1.1.1.2" xref="S3.Ex5.m2.3.3.1.1.1.2.cmml"><mrow id="S3.Ex5.m2.3.3.1.1.1.2.2" xref="S3.Ex5.m2.3.3.1.1.1.2.2.cmml"><mi id="S3.Ex5.m2.3.3.1.1.1.2.2.1" xref="S3.Ex5.m2.3.3.1.1.1.2.2.1.cmml">log</mi><mo lspace="0.167em" id="S3.Ex5.m2.3.3.1.1.1.2.2a" xref="S3.Ex5.m2.3.3.1.1.1.2.2.cmml">⁡</mo><msub id="S3.Ex5.m2.3.3.1.1.1.2.2.2" xref="S3.Ex5.m2.3.3.1.1.1.2.2.2.cmml"><mi id="S3.Ex5.m2.3.3.1.1.1.2.2.2.2" xref="S3.Ex5.m2.3.3.1.1.1.2.2.2.2.cmml">q</mi><mi id="S3.Ex5.m2.3.3.1.1.1.2.2.2.3" xref="S3.Ex5.m2.3.3.1.1.1.2.2.2.3.cmml">f</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.Ex5.m2.3.3.1.1.1.2.1" xref="S3.Ex5.m2.3.3.1.1.1.2.1.cmml">​</mo><mrow id="S3.Ex5.m2.3.3.1.1.1.2.3.2" xref="S3.Ex5.m2.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex5.m2.3.3.1.1.1.2.3.2.1" xref="S3.Ex5.m2.3.3.1.1.1.2.cmml">(</mo><mi id="S3.Ex5.m2.1.1" xref="S3.Ex5.m2.1.1.cmml">F</mi><mo stretchy="false" id="S3.Ex5.m2.3.3.1.1.1.2.3.2.2" xref="S3.Ex5.m2.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex5.m2.3.3.1.1.1.1" xref="S3.Ex5.m2.3.3.1.1.1.1.cmml">−</mo><mrow id="S3.Ex5.m2.3.3.1.1.1.3" xref="S3.Ex5.m2.3.3.1.1.1.3.cmml"><mrow id="S3.Ex5.m2.3.3.1.1.1.3.2" xref="S3.Ex5.m2.3.3.1.1.1.3.2.cmml"><mi id="S3.Ex5.m2.3.3.1.1.1.3.2.1" xref="S3.Ex5.m2.3.3.1.1.1.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S3.Ex5.m2.3.3.1.1.1.3.2a" xref="S3.Ex5.m2.3.3.1.1.1.3.2.cmml">⁡</mo><msub id="S3.Ex5.m2.3.3.1.1.1.3.2.2" xref="S3.Ex5.m2.3.3.1.1.1.3.2.2.cmml"><mi id="S3.Ex5.m2.3.3.1.1.1.3.2.2.2" xref="S3.Ex5.m2.3.3.1.1.1.3.2.2.2.cmml">p</mi><mi id="S3.Ex5.m2.3.3.1.1.1.3.2.2.3" xref="S3.Ex5.m2.3.3.1.1.1.3.2.2.3.cmml">f</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.Ex5.m2.3.3.1.1.1.3.1" xref="S3.Ex5.m2.3.3.1.1.1.3.1.cmml">​</mo><mrow id="S3.Ex5.m2.3.3.1.1.1.3.3.2" xref="S3.Ex5.m2.3.3.1.1.1.3.cmml"><mo stretchy="false" id="S3.Ex5.m2.3.3.1.1.1.3.3.2.1" xref="S3.Ex5.m2.3.3.1.1.1.3.cmml">(</mo><mi id="S3.Ex5.m2.2.2" xref="S3.Ex5.m2.2.2.cmml">F</mi><mo stretchy="false" id="S3.Ex5.m2.3.3.1.1.1.3.3.2.2" xref="S3.Ex5.m2.3.3.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.Ex5.m2.3.3.1.1.3" xref="S3.Ex5.m2.3.3.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex5.m2.3b"><apply id="S3.Ex5.m2.3.3.cmml" xref="S3.Ex5.m2.3.3"><times id="S3.Ex5.m2.3.3.2.cmml" xref="S3.Ex5.m2.3.3.2"></times><apply id="S3.Ex5.m2.3.3.3.cmml" xref="S3.Ex5.m2.3.3.3"><csymbol cd="ambiguous" id="S3.Ex5.m2.3.3.3.1.cmml" xref="S3.Ex5.m2.3.3.3">subscript</csymbol><ci id="S3.Ex5.m2.3.3.3.2.cmml" xref="S3.Ex5.m2.3.3.3.2">𝔼</ci><apply id="S3.Ex5.m2.3.3.3.3.cmml" xref="S3.Ex5.m2.3.3.3.3"><csymbol cd="latexml" id="S3.Ex5.m2.3.3.3.3.1.cmml" xref="S3.Ex5.m2.3.3.3.3.1">similar-to</csymbol><ci id="S3.Ex5.m2.3.3.3.3.2.cmml" xref="S3.Ex5.m2.3.3.3.3.2">𝐹</ci><apply id="S3.Ex5.m2.3.3.3.3.3.cmml" xref="S3.Ex5.m2.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.Ex5.m2.3.3.3.3.3.1.cmml" xref="S3.Ex5.m2.3.3.3.3.3">subscript</csymbol><ci id="S3.Ex5.m2.3.3.3.3.3.2.cmml" xref="S3.Ex5.m2.3.3.3.3.3.2">𝑞</ci><ci id="S3.Ex5.m2.3.3.3.3.3.3.cmml" xref="S3.Ex5.m2.3.3.3.3.3.3">𝑓</ci></apply></apply></apply><apply id="S3.Ex5.m2.3.3.1.2.cmml" xref="S3.Ex5.m2.3.3.1.1"><csymbol cd="latexml" id="S3.Ex5.m2.3.3.1.2.1.cmml" xref="S3.Ex5.m2.3.3.1.1.2">delimited-[]</csymbol><apply id="S3.Ex5.m2.3.3.1.1.1.cmml" xref="S3.Ex5.m2.3.3.1.1.1"><minus id="S3.Ex5.m2.3.3.1.1.1.1.cmml" xref="S3.Ex5.m2.3.3.1.1.1.1"></minus><apply id="S3.Ex5.m2.3.3.1.1.1.2.cmml" xref="S3.Ex5.m2.3.3.1.1.1.2"><times id="S3.Ex5.m2.3.3.1.1.1.2.1.cmml" xref="S3.Ex5.m2.3.3.1.1.1.2.1"></times><apply id="S3.Ex5.m2.3.3.1.1.1.2.2.cmml" xref="S3.Ex5.m2.3.3.1.1.1.2.2"><log id="S3.Ex5.m2.3.3.1.1.1.2.2.1.cmml" xref="S3.Ex5.m2.3.3.1.1.1.2.2.1"></log><apply id="S3.Ex5.m2.3.3.1.1.1.2.2.2.cmml" xref="S3.Ex5.m2.3.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex5.m2.3.3.1.1.1.2.2.2.1.cmml" xref="S3.Ex5.m2.3.3.1.1.1.2.2.2">subscript</csymbol><ci id="S3.Ex5.m2.3.3.1.1.1.2.2.2.2.cmml" xref="S3.Ex5.m2.3.3.1.1.1.2.2.2.2">𝑞</ci><ci id="S3.Ex5.m2.3.3.1.1.1.2.2.2.3.cmml" xref="S3.Ex5.m2.3.3.1.1.1.2.2.2.3">𝑓</ci></apply></apply><ci id="S3.Ex5.m2.1.1.cmml" xref="S3.Ex5.m2.1.1">𝐹</ci></apply><apply id="S3.Ex5.m2.3.3.1.1.1.3.cmml" xref="S3.Ex5.m2.3.3.1.1.1.3"><times id="S3.Ex5.m2.3.3.1.1.1.3.1.cmml" xref="S3.Ex5.m2.3.3.1.1.1.3.1"></times><apply id="S3.Ex5.m2.3.3.1.1.1.3.2.cmml" xref="S3.Ex5.m2.3.3.1.1.1.3.2"><log id="S3.Ex5.m2.3.3.1.1.1.3.2.1.cmml" xref="S3.Ex5.m2.3.3.1.1.1.3.2.1"></log><apply id="S3.Ex5.m2.3.3.1.1.1.3.2.2.cmml" xref="S3.Ex5.m2.3.3.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.Ex5.m2.3.3.1.1.1.3.2.2.1.cmml" xref="S3.Ex5.m2.3.3.1.1.1.3.2.2">subscript</csymbol><ci id="S3.Ex5.m2.3.3.1.1.1.3.2.2.2.cmml" xref="S3.Ex5.m2.3.3.1.1.1.3.2.2.2">𝑝</ci><ci id="S3.Ex5.m2.3.3.1.1.1.3.2.2.3.cmml" xref="S3.Ex5.m2.3.3.1.1.1.3.2.2.3">𝑓</ci></apply></apply><ci id="S3.Ex5.m2.2.2.cmml" xref="S3.Ex5.m2.2.2">𝐹</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5.m2.3c">\displaystyle\quad\mathbb{E}_{F\sim q_{f}}[\log q_{f}(F)-\log p_{f}(F)]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.11" class="ltx_p">Using the feature distribution definition above, we have the equivalent objective</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.3" class="ltx_Math" alttext="\min_{\theta}\mathbb{E}_{v\sim q_{I}}[\log q_{f}(\varphi(v))-\log p_{f}(\varphi(v))]" display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml"><mrow id="S3.E1.m1.3.3.3" xref="S3.E1.m1.3.3.3.cmml"><munder id="S3.E1.m1.3.3.3.1" xref="S3.E1.m1.3.3.3.1.cmml"><mi id="S3.E1.m1.3.3.3.1.2" xref="S3.E1.m1.3.3.3.1.2.cmml">min</mi><mi id="S3.E1.m1.3.3.3.1.3" xref="S3.E1.m1.3.3.3.1.3.cmml">θ</mi></munder><mo lspace="0.167em" id="S3.E1.m1.3.3.3a" xref="S3.E1.m1.3.3.3.cmml">⁡</mo><msub id="S3.E1.m1.3.3.3.2" xref="S3.E1.m1.3.3.3.2.cmml"><mi id="S3.E1.m1.3.3.3.2.2" xref="S3.E1.m1.3.3.3.2.2.cmml">𝔼</mi><mrow id="S3.E1.m1.3.3.3.2.3" xref="S3.E1.m1.3.3.3.2.3.cmml"><mi id="S3.E1.m1.3.3.3.2.3.2" xref="S3.E1.m1.3.3.3.2.3.2.cmml">v</mi><mo id="S3.E1.m1.3.3.3.2.3.1" xref="S3.E1.m1.3.3.3.2.3.1.cmml">∼</mo><msub id="S3.E1.m1.3.3.3.2.3.3" xref="S3.E1.m1.3.3.3.2.3.3.cmml"><mi id="S3.E1.m1.3.3.3.2.3.3.2" xref="S3.E1.m1.3.3.3.2.3.3.2.cmml">q</mi><mi id="S3.E1.m1.3.3.3.2.3.3.3" xref="S3.E1.m1.3.3.3.2.3.3.3.cmml">I</mi></msub></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.2" xref="S3.E1.m1.3.3.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.2.1.cmml">[</mo><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.3.1" xref="S3.E1.m1.3.3.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E1.m1.3.3.1.1.1.1.3a" xref="S3.E1.m1.3.3.1.1.1.1.3.cmml">⁡</mo><msub id="S3.E1.m1.3.3.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.3.2.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.3.2.2" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.cmml">q</mi><mi id="S3.E1.m1.3.3.1.1.1.1.3.2.3" xref="S3.E1.m1.3.3.1.1.1.1.3.2.3.cmml">f</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml">φ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">v</mi><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.3.cmml">−</mo><mrow id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.2.cmml"><mrow id="S3.E1.m1.3.3.1.1.1.2.3" xref="S3.E1.m1.3.3.1.1.1.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.2.3.1" xref="S3.E1.m1.3.3.1.1.1.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E1.m1.3.3.1.1.1.2.3a" xref="S3.E1.m1.3.3.1.1.1.2.3.cmml">⁡</mo><msub id="S3.E1.m1.3.3.1.1.1.2.3.2" xref="S3.E1.m1.3.3.1.1.1.2.3.2.cmml"><mi id="S3.E1.m1.3.3.1.1.1.2.3.2.2" xref="S3.E1.m1.3.3.1.1.1.2.3.2.2.cmml">p</mi><mi id="S3.E1.m1.3.3.1.1.1.2.3.2.3" xref="S3.E1.m1.3.3.1.1.1.2.3.2.3.cmml">f</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.1.2.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1.2.1.1" xref="S3.E1.m1.3.3.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.2.1.1.2" xref="S3.E1.m1.3.3.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.1.2.1.1.1" xref="S3.E1.m1.3.3.1.1.1.2.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.2.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.2.1.1.1.2.cmml">φ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.2.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.2.1.1.1.1.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1.2.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.2.1.1.1.3.2.1" xref="S3.E1.m1.3.3.1.1.1.2.1.1.1.cmml">(</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">v</mi><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.2.1.1.1.3.2.2" xref="S3.E1.m1.3.3.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.2.1.1.3" xref="S3.E1.m1.3.3.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3"><times id="S3.E1.m1.3.3.2.cmml" xref="S3.E1.m1.3.3.2"></times><apply id="S3.E1.m1.3.3.3.cmml" xref="S3.E1.m1.3.3.3"><apply id="S3.E1.m1.3.3.3.1.cmml" xref="S3.E1.m1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.1.1.cmml" xref="S3.E1.m1.3.3.3.1">subscript</csymbol><min id="S3.E1.m1.3.3.3.1.2.cmml" xref="S3.E1.m1.3.3.3.1.2"></min><ci id="S3.E1.m1.3.3.3.1.3.cmml" xref="S3.E1.m1.3.3.3.1.3">𝜃</ci></apply><apply id="S3.E1.m1.3.3.3.2.cmml" xref="S3.E1.m1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.2.1.cmml" xref="S3.E1.m1.3.3.3.2">subscript</csymbol><ci id="S3.E1.m1.3.3.3.2.2.cmml" xref="S3.E1.m1.3.3.3.2.2">𝔼</ci><apply id="S3.E1.m1.3.3.3.2.3.cmml" xref="S3.E1.m1.3.3.3.2.3"><csymbol cd="latexml" id="S3.E1.m1.3.3.3.2.3.1.cmml" xref="S3.E1.m1.3.3.3.2.3.1">similar-to</csymbol><ci id="S3.E1.m1.3.3.3.2.3.2.cmml" xref="S3.E1.m1.3.3.3.2.3.2">𝑣</ci><apply id="S3.E1.m1.3.3.3.2.3.3.cmml" xref="S3.E1.m1.3.3.3.2.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.2.3.3.1.cmml" xref="S3.E1.m1.3.3.3.2.3.3">subscript</csymbol><ci id="S3.E1.m1.3.3.3.2.3.3.2.cmml" xref="S3.E1.m1.3.3.3.2.3.3.2">𝑞</ci><ci id="S3.E1.m1.3.3.3.2.3.3.3.cmml" xref="S3.E1.m1.3.3.3.2.3.3.3">𝐼</ci></apply></apply></apply></apply><apply id="S3.E1.m1.3.3.1.2.cmml" xref="S3.E1.m1.3.3.1.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2">delimited-[]</csymbol><apply id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><minus id="S3.E1.m1.3.3.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3"></minus><apply id="S3.E1.m1.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2"></times><apply id="S3.E1.m1.3.3.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3"><log id="S3.E1.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.1"></log><apply id="S3.E1.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2">𝑞</ci><ci id="S3.E1.m1.3.3.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.3">𝑓</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1"></times><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2">𝜑</ci><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑣</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2"><times id="S3.E1.m1.3.3.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2.2"></times><apply id="S3.E1.m1.3.3.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.2.3"><log id="S3.E1.m1.3.3.1.1.1.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.2.3.1"></log><apply id="S3.E1.m1.3.3.1.1.1.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.2.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.2.3.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.2.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2.3.2.2">𝑝</ci><ci id="S3.E1.m1.3.3.1.1.1.2.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.2.3.2.3">𝑓</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.1.2.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.2.1.1"><times id="S3.E1.m1.3.3.1.1.1.2.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.2.1.1.1.1"></times><ci id="S3.E1.m1.3.3.1.1.1.2.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2.1.1.1.2">𝜑</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝑣</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\min_{\theta}\mathbb{E}_{v\sim q_{I}}[\log q_{f}(\varphi(v))-\log p_{f}(\varphi(v))]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS3.p3.8" class="ltx_p">The true underlying feature distributions <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="q_{f}" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><msub id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">q</mi><mi id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">𝑞</ci><ci id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">q_{f}</annotation></semantics></math> and <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="p_{f}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><msub id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">p</mi><mi id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">𝑝</ci><ci id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">p_{f}</annotation></semantics></math> are usually
intractable to compute. We use approximations <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="\tilde{q}_{f}(F)" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><mrow id="S3.SS3.p3.3.m3.1.2" xref="S3.SS3.p3.3.m3.1.2.cmml"><msub id="S3.SS3.p3.3.m3.1.2.2" xref="S3.SS3.p3.3.m3.1.2.2.cmml"><mover accent="true" id="S3.SS3.p3.3.m3.1.2.2.2" xref="S3.SS3.p3.3.m3.1.2.2.2.cmml"><mi id="S3.SS3.p3.3.m3.1.2.2.2.2" xref="S3.SS3.p3.3.m3.1.2.2.2.2.cmml">q</mi><mo id="S3.SS3.p3.3.m3.1.2.2.2.1" xref="S3.SS3.p3.3.m3.1.2.2.2.1.cmml">~</mo></mover><mi id="S3.SS3.p3.3.m3.1.2.2.3" xref="S3.SS3.p3.3.m3.1.2.2.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p3.3.m3.1.2.1" xref="S3.SS3.p3.3.m3.1.2.1.cmml">​</mo><mrow id="S3.SS3.p3.3.m3.1.2.3.2" xref="S3.SS3.p3.3.m3.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.3.m3.1.2.3.2.1" xref="S3.SS3.p3.3.m3.1.2.cmml">(</mo><mi id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">F</mi><mo stretchy="false" id="S3.SS3.p3.3.m3.1.2.3.2.2" xref="S3.SS3.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.2.cmml" xref="S3.SS3.p3.3.m3.1.2"><times id="S3.SS3.p3.3.m3.1.2.1.cmml" xref="S3.SS3.p3.3.m3.1.2.1"></times><apply id="S3.SS3.p3.3.m3.1.2.2.cmml" xref="S3.SS3.p3.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.2.2.1.cmml" xref="S3.SS3.p3.3.m3.1.2.2">subscript</csymbol><apply id="S3.SS3.p3.3.m3.1.2.2.2.cmml" xref="S3.SS3.p3.3.m3.1.2.2.2"><ci id="S3.SS3.p3.3.m3.1.2.2.2.1.cmml" xref="S3.SS3.p3.3.m3.1.2.2.2.1">~</ci><ci id="S3.SS3.p3.3.m3.1.2.2.2.2.cmml" xref="S3.SS3.p3.3.m3.1.2.2.2.2">𝑞</ci></apply><ci id="S3.SS3.p3.3.m3.1.2.2.3.cmml" xref="S3.SS3.p3.3.m3.1.2.2.3">𝑓</ci></apply><ci id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">\tilde{q}_{f}(F)</annotation></semantics></math> and <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="\tilde{p}_{f}(F)" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><mrow id="S3.SS3.p3.4.m4.1.2" xref="S3.SS3.p3.4.m4.1.2.cmml"><msub id="S3.SS3.p3.4.m4.1.2.2" xref="S3.SS3.p3.4.m4.1.2.2.cmml"><mover accent="true" id="S3.SS3.p3.4.m4.1.2.2.2" xref="S3.SS3.p3.4.m4.1.2.2.2.cmml"><mi id="S3.SS3.p3.4.m4.1.2.2.2.2" xref="S3.SS3.p3.4.m4.1.2.2.2.2.cmml">p</mi><mo id="S3.SS3.p3.4.m4.1.2.2.2.1" xref="S3.SS3.p3.4.m4.1.2.2.2.1.cmml">~</mo></mover><mi id="S3.SS3.p3.4.m4.1.2.2.3" xref="S3.SS3.p3.4.m4.1.2.2.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p3.4.m4.1.2.1" xref="S3.SS3.p3.4.m4.1.2.1.cmml">​</mo><mrow id="S3.SS3.p3.4.m4.1.2.3.2" xref="S3.SS3.p3.4.m4.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.4.m4.1.2.3.2.1" xref="S3.SS3.p3.4.m4.1.2.cmml">(</mo><mi id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml">F</mi><mo stretchy="false" id="S3.SS3.p3.4.m4.1.2.3.2.2" xref="S3.SS3.p3.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><apply id="S3.SS3.p3.4.m4.1.2.cmml" xref="S3.SS3.p3.4.m4.1.2"><times id="S3.SS3.p3.4.m4.1.2.1.cmml" xref="S3.SS3.p3.4.m4.1.2.1"></times><apply id="S3.SS3.p3.4.m4.1.2.2.cmml" xref="S3.SS3.p3.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.1.2.2.1.cmml" xref="S3.SS3.p3.4.m4.1.2.2">subscript</csymbol><apply id="S3.SS3.p3.4.m4.1.2.2.2.cmml" xref="S3.SS3.p3.4.m4.1.2.2.2"><ci id="S3.SS3.p3.4.m4.1.2.2.2.1.cmml" xref="S3.SS3.p3.4.m4.1.2.2.2.1">~</ci><ci id="S3.SS3.p3.4.m4.1.2.2.2.2.cmml" xref="S3.SS3.p3.4.m4.1.2.2.2.2">𝑝</ci></apply><ci id="S3.SS3.p3.4.m4.1.2.2.3.cmml" xref="S3.SS3.p3.4.m4.1.2.2.3">𝑓</ci></apply><ci id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">\tilde{p}_{f}(F)</annotation></semantics></math>, computed using kernel density estimation (KDE).
Let <math id="S3.SS3.p3.5.m5.3" class="ltx_Math" alttext="V=\{v_{1},\ldots,v_{l}\}" display="inline"><semantics id="S3.SS3.p3.5.m5.3a"><mrow id="S3.SS3.p3.5.m5.3.3" xref="S3.SS3.p3.5.m5.3.3.cmml"><mi id="S3.SS3.p3.5.m5.3.3.4" xref="S3.SS3.p3.5.m5.3.3.4.cmml">V</mi><mo id="S3.SS3.p3.5.m5.3.3.3" xref="S3.SS3.p3.5.m5.3.3.3.cmml">=</mo><mrow id="S3.SS3.p3.5.m5.3.3.2.2" xref="S3.SS3.p3.5.m5.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS3.p3.5.m5.3.3.2.2.3" xref="S3.SS3.p3.5.m5.3.3.2.3.cmml">{</mo><msub id="S3.SS3.p3.5.m5.2.2.1.1.1" xref="S3.SS3.p3.5.m5.2.2.1.1.1.cmml"><mi id="S3.SS3.p3.5.m5.2.2.1.1.1.2" xref="S3.SS3.p3.5.m5.2.2.1.1.1.2.cmml">v</mi><mn id="S3.SS3.p3.5.m5.2.2.1.1.1.3" xref="S3.SS3.p3.5.m5.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p3.5.m5.3.3.2.2.4" xref="S3.SS3.p3.5.m5.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml">…</mi><mo id="S3.SS3.p3.5.m5.3.3.2.2.5" xref="S3.SS3.p3.5.m5.3.3.2.3.cmml">,</mo><msub id="S3.SS3.p3.5.m5.3.3.2.2.2" xref="S3.SS3.p3.5.m5.3.3.2.2.2.cmml"><mi id="S3.SS3.p3.5.m5.3.3.2.2.2.2" xref="S3.SS3.p3.5.m5.3.3.2.2.2.2.cmml">v</mi><mi id="S3.SS3.p3.5.m5.3.3.2.2.2.3" xref="S3.SS3.p3.5.m5.3.3.2.2.2.3.cmml">l</mi></msub><mo stretchy="false" id="S3.SS3.p3.5.m5.3.3.2.2.6" xref="S3.SS3.p3.5.m5.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.3b"><apply id="S3.SS3.p3.5.m5.3.3.cmml" xref="S3.SS3.p3.5.m5.3.3"><eq id="S3.SS3.p3.5.m5.3.3.3.cmml" xref="S3.SS3.p3.5.m5.3.3.3"></eq><ci id="S3.SS3.p3.5.m5.3.3.4.cmml" xref="S3.SS3.p3.5.m5.3.3.4">𝑉</ci><set id="S3.SS3.p3.5.m5.3.3.2.3.cmml" xref="S3.SS3.p3.5.m5.3.3.2.2"><apply id="S3.SS3.p3.5.m5.2.2.1.1.1.cmml" xref="S3.SS3.p3.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS3.p3.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.5.m5.2.2.1.1.1.2.cmml" xref="S3.SS3.p3.5.m5.2.2.1.1.1.2">𝑣</ci><cn type="integer" id="S3.SS3.p3.5.m5.2.2.1.1.1.3.cmml" xref="S3.SS3.p3.5.m5.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">…</ci><apply id="S3.SS3.p3.5.m5.3.3.2.2.2.cmml" xref="S3.SS3.p3.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.3.3.2.2.2.1.cmml" xref="S3.SS3.p3.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.p3.5.m5.3.3.2.2.2.2.cmml" xref="S3.SS3.p3.5.m5.3.3.2.2.2.2">𝑣</ci><ci id="S3.SS3.p3.5.m5.3.3.2.2.2.3.cmml" xref="S3.SS3.p3.5.m5.3.3.2.2.2.3">𝑙</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.3c">V=\{v_{1},\ldots,v_{l}\}</annotation></semantics></math> and <math id="S3.SS3.p3.6.m6.3" class="ltx_Math" alttext="B=\{v^{\prime}_{1},\ldots,v^{\prime}_{m}\}" display="inline"><semantics id="S3.SS3.p3.6.m6.3a"><mrow id="S3.SS3.p3.6.m6.3.3" xref="S3.SS3.p3.6.m6.3.3.cmml"><mi id="S3.SS3.p3.6.m6.3.3.4" xref="S3.SS3.p3.6.m6.3.3.4.cmml">B</mi><mo id="S3.SS3.p3.6.m6.3.3.3" xref="S3.SS3.p3.6.m6.3.3.3.cmml">=</mo><mrow id="S3.SS3.p3.6.m6.3.3.2.2" xref="S3.SS3.p3.6.m6.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS3.p3.6.m6.3.3.2.2.3" xref="S3.SS3.p3.6.m6.3.3.2.3.cmml">{</mo><msubsup id="S3.SS3.p3.6.m6.2.2.1.1.1" xref="S3.SS3.p3.6.m6.2.2.1.1.1.cmml"><mi id="S3.SS3.p3.6.m6.2.2.1.1.1.2.2" xref="S3.SS3.p3.6.m6.2.2.1.1.1.2.2.cmml">v</mi><mn id="S3.SS3.p3.6.m6.2.2.1.1.1.3" xref="S3.SS3.p3.6.m6.2.2.1.1.1.3.cmml">1</mn><mo id="S3.SS3.p3.6.m6.2.2.1.1.1.2.3" xref="S3.SS3.p3.6.m6.2.2.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.SS3.p3.6.m6.3.3.2.2.4" xref="S3.SS3.p3.6.m6.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p3.6.m6.1.1" xref="S3.SS3.p3.6.m6.1.1.cmml">…</mi><mo id="S3.SS3.p3.6.m6.3.3.2.2.5" xref="S3.SS3.p3.6.m6.3.3.2.3.cmml">,</mo><msubsup id="S3.SS3.p3.6.m6.3.3.2.2.2" xref="S3.SS3.p3.6.m6.3.3.2.2.2.cmml"><mi id="S3.SS3.p3.6.m6.3.3.2.2.2.2.2" xref="S3.SS3.p3.6.m6.3.3.2.2.2.2.2.cmml">v</mi><mi id="S3.SS3.p3.6.m6.3.3.2.2.2.3" xref="S3.SS3.p3.6.m6.3.3.2.2.2.3.cmml">m</mi><mo id="S3.SS3.p3.6.m6.3.3.2.2.2.2.3" xref="S3.SS3.p3.6.m6.3.3.2.2.2.2.3.cmml">′</mo></msubsup><mo stretchy="false" id="S3.SS3.p3.6.m6.3.3.2.2.6" xref="S3.SS3.p3.6.m6.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.3b"><apply id="S3.SS3.p3.6.m6.3.3.cmml" xref="S3.SS3.p3.6.m6.3.3"><eq id="S3.SS3.p3.6.m6.3.3.3.cmml" xref="S3.SS3.p3.6.m6.3.3.3"></eq><ci id="S3.SS3.p3.6.m6.3.3.4.cmml" xref="S3.SS3.p3.6.m6.3.3.4">𝐵</ci><set id="S3.SS3.p3.6.m6.3.3.2.3.cmml" xref="S3.SS3.p3.6.m6.3.3.2.2"><apply id="S3.SS3.p3.6.m6.2.2.1.1.1.cmml" xref="S3.SS3.p3.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS3.p3.6.m6.2.2.1.1.1">subscript</csymbol><apply id="S3.SS3.p3.6.m6.2.2.1.1.1.2.cmml" xref="S3.SS3.p3.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.2.2.1.1.1.2.1.cmml" xref="S3.SS3.p3.6.m6.2.2.1.1.1">superscript</csymbol><ci id="S3.SS3.p3.6.m6.2.2.1.1.1.2.2.cmml" xref="S3.SS3.p3.6.m6.2.2.1.1.1.2.2">𝑣</ci><ci id="S3.SS3.p3.6.m6.2.2.1.1.1.2.3.cmml" xref="S3.SS3.p3.6.m6.2.2.1.1.1.2.3">′</ci></apply><cn type="integer" id="S3.SS3.p3.6.m6.2.2.1.1.1.3.cmml" xref="S3.SS3.p3.6.m6.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS3.p3.6.m6.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1">…</ci><apply id="S3.SS3.p3.6.m6.3.3.2.2.2.cmml" xref="S3.SS3.p3.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.3.3.2.2.2.1.cmml" xref="S3.SS3.p3.6.m6.3.3.2.2.2">subscript</csymbol><apply id="S3.SS3.p3.6.m6.3.3.2.2.2.2.cmml" xref="S3.SS3.p3.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.3.3.2.2.2.2.1.cmml" xref="S3.SS3.p3.6.m6.3.3.2.2.2">superscript</csymbol><ci id="S3.SS3.p3.6.m6.3.3.2.2.2.2.2.cmml" xref="S3.SS3.p3.6.m6.3.3.2.2.2.2.2">𝑣</ci><ci id="S3.SS3.p3.6.m6.3.3.2.2.2.2.3.cmml" xref="S3.SS3.p3.6.m6.3.3.2.2.2.2.3">′</ci></apply><ci id="S3.SS3.p3.6.m6.3.3.2.2.2.3.cmml" xref="S3.SS3.p3.6.m6.3.3.2.2.2.3">𝑚</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.3c">B=\{v^{\prime}_{1},\ldots,v^{\prime}_{m}\}</annotation></semantics></math> be a batch of real and generated images. KDE with <math id="S3.SS3.p3.7.m7.2" class="ltx_Math" alttext="B,V" display="inline"><semantics id="S3.SS3.p3.7.m7.2a"><mrow id="S3.SS3.p3.7.m7.2.3.2" xref="S3.SS3.p3.7.m7.2.3.1.cmml"><mi id="S3.SS3.p3.7.m7.1.1" xref="S3.SS3.p3.7.m7.1.1.cmml">B</mi><mo id="S3.SS3.p3.7.m7.2.3.2.1" xref="S3.SS3.p3.7.m7.2.3.1.cmml">,</mo><mi id="S3.SS3.p3.7.m7.2.2" xref="S3.SS3.p3.7.m7.2.2.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m7.2b"><list id="S3.SS3.p3.7.m7.2.3.1.cmml" xref="S3.SS3.p3.7.m7.2.3.2"><ci id="S3.SS3.p3.7.m7.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1">𝐵</ci><ci id="S3.SS3.p3.7.m7.2.2.cmml" xref="S3.SS3.p3.7.m7.2.2">𝑉</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m7.2c">B,V</annotation></semantics></math> to estimate <math id="S3.SS3.p3.8.m8.2" class="ltx_Math" alttext="q_{f},p_{f}" display="inline"><semantics id="S3.SS3.p3.8.m8.2a"><mrow id="S3.SS3.p3.8.m8.2.2.2" xref="S3.SS3.p3.8.m8.2.2.3.cmml"><msub id="S3.SS3.p3.8.m8.1.1.1.1" xref="S3.SS3.p3.8.m8.1.1.1.1.cmml"><mi id="S3.SS3.p3.8.m8.1.1.1.1.2" xref="S3.SS3.p3.8.m8.1.1.1.1.2.cmml">q</mi><mi id="S3.SS3.p3.8.m8.1.1.1.1.3" xref="S3.SS3.p3.8.m8.1.1.1.1.3.cmml">f</mi></msub><mo id="S3.SS3.p3.8.m8.2.2.2.3" xref="S3.SS3.p3.8.m8.2.2.3.cmml">,</mo><msub id="S3.SS3.p3.8.m8.2.2.2.2" xref="S3.SS3.p3.8.m8.2.2.2.2.cmml"><mi id="S3.SS3.p3.8.m8.2.2.2.2.2" xref="S3.SS3.p3.8.m8.2.2.2.2.2.cmml">p</mi><mi id="S3.SS3.p3.8.m8.2.2.2.2.3" xref="S3.SS3.p3.8.m8.2.2.2.2.3.cmml">f</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m8.2b"><list id="S3.SS3.p3.8.m8.2.2.3.cmml" xref="S3.SS3.p3.8.m8.2.2.2"><apply id="S3.SS3.p3.8.m8.1.1.1.1.cmml" xref="S3.SS3.p3.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.8.m8.1.1.1.1.1.cmml" xref="S3.SS3.p3.8.m8.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.8.m8.1.1.1.1.2.cmml" xref="S3.SS3.p3.8.m8.1.1.1.1.2">𝑞</ci><ci id="S3.SS3.p3.8.m8.1.1.1.1.3.cmml" xref="S3.SS3.p3.8.m8.1.1.1.1.3">𝑓</ci></apply><apply id="S3.SS3.p3.8.m8.2.2.2.2.cmml" xref="S3.SS3.p3.8.m8.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.8.m8.2.2.2.2.1.cmml" xref="S3.SS3.p3.8.m8.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p3.8.m8.2.2.2.2.2.cmml" xref="S3.SS3.p3.8.m8.2.2.2.2.2">𝑝</ci><ci id="S3.SS3.p3.8.m8.2.2.2.2.3.cmml" xref="S3.SS3.p3.8.m8.2.2.2.2.3">𝑓</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m8.2c">q_{f},p_{f}</annotation></semantics></math> yield</p>
<table id="S6.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex6.m1.2" class="ltx_Math" alttext="\displaystyle\tilde{q}_{f}(F)=\frac{1}{m}\sum_{j=1}^{m}K_{H}(F-\varphi(v_{j}^{\prime}))" display="inline"><semantics id="S3.Ex6.m1.2a"><mrow id="S3.Ex6.m1.2.2" xref="S3.Ex6.m1.2.2.cmml"><mrow id="S3.Ex6.m1.2.2.3" xref="S3.Ex6.m1.2.2.3.cmml"><msub id="S3.Ex6.m1.2.2.3.2" xref="S3.Ex6.m1.2.2.3.2.cmml"><mover accent="true" id="S3.Ex6.m1.2.2.3.2.2" xref="S3.Ex6.m1.2.2.3.2.2.cmml"><mi id="S3.Ex6.m1.2.2.3.2.2.2" xref="S3.Ex6.m1.2.2.3.2.2.2.cmml">q</mi><mo id="S3.Ex6.m1.2.2.3.2.2.1" xref="S3.Ex6.m1.2.2.3.2.2.1.cmml">~</mo></mover><mi id="S3.Ex6.m1.2.2.3.2.3" xref="S3.Ex6.m1.2.2.3.2.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.2.2.3.1" xref="S3.Ex6.m1.2.2.3.1.cmml">​</mo><mrow id="S3.Ex6.m1.2.2.3.3.2" xref="S3.Ex6.m1.2.2.3.cmml"><mo stretchy="false" id="S3.Ex6.m1.2.2.3.3.2.1" xref="S3.Ex6.m1.2.2.3.cmml">(</mo><mi id="S3.Ex6.m1.1.1" xref="S3.Ex6.m1.1.1.cmml">F</mi><mo stretchy="false" id="S3.Ex6.m1.2.2.3.3.2.2" xref="S3.Ex6.m1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.Ex6.m1.2.2.2" xref="S3.Ex6.m1.2.2.2.cmml">=</mo><mrow id="S3.Ex6.m1.2.2.1" xref="S3.Ex6.m1.2.2.1.cmml"><mstyle displaystyle="true" id="S3.Ex6.m1.2.2.1.3" xref="S3.Ex6.m1.2.2.1.3.cmml"><mfrac id="S3.Ex6.m1.2.2.1.3a" xref="S3.Ex6.m1.2.2.1.3.cmml"><mn id="S3.Ex6.m1.2.2.1.3.2" xref="S3.Ex6.m1.2.2.1.3.2.cmml">1</mn><mi id="S3.Ex6.m1.2.2.1.3.3" xref="S3.Ex6.m1.2.2.1.3.3.cmml">m</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.2.2.1.2" xref="S3.Ex6.m1.2.2.1.2.cmml">​</mo><mrow id="S3.Ex6.m1.2.2.1.1" xref="S3.Ex6.m1.2.2.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex6.m1.2.2.1.1.2" xref="S3.Ex6.m1.2.2.1.1.2.cmml"><munderover id="S3.Ex6.m1.2.2.1.1.2a" xref="S3.Ex6.m1.2.2.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex6.m1.2.2.1.1.2.2.2" xref="S3.Ex6.m1.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="S3.Ex6.m1.2.2.1.1.2.2.3" xref="S3.Ex6.m1.2.2.1.1.2.2.3.cmml"><mi id="S3.Ex6.m1.2.2.1.1.2.2.3.2" xref="S3.Ex6.m1.2.2.1.1.2.2.3.2.cmml">j</mi><mo id="S3.Ex6.m1.2.2.1.1.2.2.3.1" xref="S3.Ex6.m1.2.2.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex6.m1.2.2.1.1.2.2.3.3" xref="S3.Ex6.m1.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex6.m1.2.2.1.1.2.3" xref="S3.Ex6.m1.2.2.1.1.2.3.cmml">m</mi></munderover></mstyle><mrow id="S3.Ex6.m1.2.2.1.1.1" xref="S3.Ex6.m1.2.2.1.1.1.cmml"><msub id="S3.Ex6.m1.2.2.1.1.1.3" xref="S3.Ex6.m1.2.2.1.1.1.3.cmml"><mi id="S3.Ex6.m1.2.2.1.1.1.3.2" xref="S3.Ex6.m1.2.2.1.1.1.3.2.cmml">K</mi><mi id="S3.Ex6.m1.2.2.1.1.1.3.3" xref="S3.Ex6.m1.2.2.1.1.1.3.3.cmml">H</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.2.2.1.1.1.2" xref="S3.Ex6.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.Ex6.m1.2.2.1.1.1.1.1" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex6.m1.2.2.1.1.1.1.1.2" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex6.m1.2.2.1.1.1.1.1.1" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.Ex6.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.3.cmml">F</mi><mo id="S3.Ex6.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.3.cmml">φ</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">v</mi><mi id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi><mo id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo stretchy="false" id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.Ex6.m1.2.2.1.1.1.1.1.3" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex6.m1.2b"><apply id="S3.Ex6.m1.2.2.cmml" xref="S3.Ex6.m1.2.2"><eq id="S3.Ex6.m1.2.2.2.cmml" xref="S3.Ex6.m1.2.2.2"></eq><apply id="S3.Ex6.m1.2.2.3.cmml" xref="S3.Ex6.m1.2.2.3"><times id="S3.Ex6.m1.2.2.3.1.cmml" xref="S3.Ex6.m1.2.2.3.1"></times><apply id="S3.Ex6.m1.2.2.3.2.cmml" xref="S3.Ex6.m1.2.2.3.2"><csymbol cd="ambiguous" id="S3.Ex6.m1.2.2.3.2.1.cmml" xref="S3.Ex6.m1.2.2.3.2">subscript</csymbol><apply id="S3.Ex6.m1.2.2.3.2.2.cmml" xref="S3.Ex6.m1.2.2.3.2.2"><ci id="S3.Ex6.m1.2.2.3.2.2.1.cmml" xref="S3.Ex6.m1.2.2.3.2.2.1">~</ci><ci id="S3.Ex6.m1.2.2.3.2.2.2.cmml" xref="S3.Ex6.m1.2.2.3.2.2.2">𝑞</ci></apply><ci id="S3.Ex6.m1.2.2.3.2.3.cmml" xref="S3.Ex6.m1.2.2.3.2.3">𝑓</ci></apply><ci id="S3.Ex6.m1.1.1.cmml" xref="S3.Ex6.m1.1.1">𝐹</ci></apply><apply id="S3.Ex6.m1.2.2.1.cmml" xref="S3.Ex6.m1.2.2.1"><times id="S3.Ex6.m1.2.2.1.2.cmml" xref="S3.Ex6.m1.2.2.1.2"></times><apply id="S3.Ex6.m1.2.2.1.3.cmml" xref="S3.Ex6.m1.2.2.1.3"><divide id="S3.Ex6.m1.2.2.1.3.1.cmml" xref="S3.Ex6.m1.2.2.1.3"></divide><cn type="integer" id="S3.Ex6.m1.2.2.1.3.2.cmml" xref="S3.Ex6.m1.2.2.1.3.2">1</cn><ci id="S3.Ex6.m1.2.2.1.3.3.cmml" xref="S3.Ex6.m1.2.2.1.3.3">𝑚</ci></apply><apply id="S3.Ex6.m1.2.2.1.1.cmml" xref="S3.Ex6.m1.2.2.1.1"><apply id="S3.Ex6.m1.2.2.1.1.2.cmml" xref="S3.Ex6.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.Ex6.m1.2.2.1.1.2.1.cmml" xref="S3.Ex6.m1.2.2.1.1.2">superscript</csymbol><apply id="S3.Ex6.m1.2.2.1.1.2.2.cmml" xref="S3.Ex6.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.Ex6.m1.2.2.1.1.2.2.1.cmml" xref="S3.Ex6.m1.2.2.1.1.2">subscript</csymbol><sum id="S3.Ex6.m1.2.2.1.1.2.2.2.cmml" xref="S3.Ex6.m1.2.2.1.1.2.2.2"></sum><apply id="S3.Ex6.m1.2.2.1.1.2.2.3.cmml" xref="S3.Ex6.m1.2.2.1.1.2.2.3"><eq id="S3.Ex6.m1.2.2.1.1.2.2.3.1.cmml" xref="S3.Ex6.m1.2.2.1.1.2.2.3.1"></eq><ci id="S3.Ex6.m1.2.2.1.1.2.2.3.2.cmml" xref="S3.Ex6.m1.2.2.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S3.Ex6.m1.2.2.1.1.2.2.3.3.cmml" xref="S3.Ex6.m1.2.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.Ex6.m1.2.2.1.1.2.3.cmml" xref="S3.Ex6.m1.2.2.1.1.2.3">𝑚</ci></apply><apply id="S3.Ex6.m1.2.2.1.1.1.cmml" xref="S3.Ex6.m1.2.2.1.1.1"><times id="S3.Ex6.m1.2.2.1.1.1.2.cmml" xref="S3.Ex6.m1.2.2.1.1.1.2"></times><apply id="S3.Ex6.m1.2.2.1.1.1.3.cmml" xref="S3.Ex6.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex6.m1.2.2.1.1.1.3.1.cmml" xref="S3.Ex6.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.Ex6.m1.2.2.1.1.1.3.2.cmml" xref="S3.Ex6.m1.2.2.1.1.1.3.2">𝐾</ci><ci id="S3.Ex6.m1.2.2.1.1.1.3.3.cmml" xref="S3.Ex6.m1.2.2.1.1.1.3.3">𝐻</ci></apply><apply id="S3.Ex6.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1"><minus id="S3.Ex6.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.2"></minus><ci id="S3.Ex6.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.3">𝐹</ci><apply id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1"><times id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.2"></times><ci id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.3">𝜑</ci><apply id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2">𝑣</ci><ci id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">′</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex6.m1.2c">\displaystyle\tilde{q}_{f}(F)=\frac{1}{m}\sum_{j=1}^{m}K_{H}(F-\varphi(v_{j}^{\prime}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex7.m1.2" class="ltx_Math" alttext="\displaystyle\tilde{p}_{f}(F)=\frac{1}{l}\sum_{j=1}^{l}K_{H}(F-\varphi(v_{j}))" display="inline"><semantics id="S3.Ex7.m1.2a"><mrow id="S3.Ex7.m1.2.2" xref="S3.Ex7.m1.2.2.cmml"><mrow id="S3.Ex7.m1.2.2.3" xref="S3.Ex7.m1.2.2.3.cmml"><msub id="S3.Ex7.m1.2.2.3.2" xref="S3.Ex7.m1.2.2.3.2.cmml"><mover accent="true" id="S3.Ex7.m1.2.2.3.2.2" xref="S3.Ex7.m1.2.2.3.2.2.cmml"><mi id="S3.Ex7.m1.2.2.3.2.2.2" xref="S3.Ex7.m1.2.2.3.2.2.2.cmml">p</mi><mo id="S3.Ex7.m1.2.2.3.2.2.1" xref="S3.Ex7.m1.2.2.3.2.2.1.cmml">~</mo></mover><mi id="S3.Ex7.m1.2.2.3.2.3" xref="S3.Ex7.m1.2.2.3.2.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex7.m1.2.2.3.1" xref="S3.Ex7.m1.2.2.3.1.cmml">​</mo><mrow id="S3.Ex7.m1.2.2.3.3.2" xref="S3.Ex7.m1.2.2.3.cmml"><mo stretchy="false" id="S3.Ex7.m1.2.2.3.3.2.1" xref="S3.Ex7.m1.2.2.3.cmml">(</mo><mi id="S3.Ex7.m1.1.1" xref="S3.Ex7.m1.1.1.cmml">F</mi><mo stretchy="false" id="S3.Ex7.m1.2.2.3.3.2.2" xref="S3.Ex7.m1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.Ex7.m1.2.2.2" xref="S3.Ex7.m1.2.2.2.cmml">=</mo><mrow id="S3.Ex7.m1.2.2.1" xref="S3.Ex7.m1.2.2.1.cmml"><mstyle displaystyle="true" id="S3.Ex7.m1.2.2.1.3" xref="S3.Ex7.m1.2.2.1.3.cmml"><mfrac id="S3.Ex7.m1.2.2.1.3a" xref="S3.Ex7.m1.2.2.1.3.cmml"><mn id="S3.Ex7.m1.2.2.1.3.2" xref="S3.Ex7.m1.2.2.1.3.2.cmml">1</mn><mi id="S3.Ex7.m1.2.2.1.3.3" xref="S3.Ex7.m1.2.2.1.3.3.cmml">l</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.Ex7.m1.2.2.1.2" xref="S3.Ex7.m1.2.2.1.2.cmml">​</mo><mrow id="S3.Ex7.m1.2.2.1.1" xref="S3.Ex7.m1.2.2.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex7.m1.2.2.1.1.2" xref="S3.Ex7.m1.2.2.1.1.2.cmml"><munderover id="S3.Ex7.m1.2.2.1.1.2a" xref="S3.Ex7.m1.2.2.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex7.m1.2.2.1.1.2.2.2" xref="S3.Ex7.m1.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="S3.Ex7.m1.2.2.1.1.2.2.3" xref="S3.Ex7.m1.2.2.1.1.2.2.3.cmml"><mi id="S3.Ex7.m1.2.2.1.1.2.2.3.2" xref="S3.Ex7.m1.2.2.1.1.2.2.3.2.cmml">j</mi><mo id="S3.Ex7.m1.2.2.1.1.2.2.3.1" xref="S3.Ex7.m1.2.2.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex7.m1.2.2.1.1.2.2.3.3" xref="S3.Ex7.m1.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex7.m1.2.2.1.1.2.3" xref="S3.Ex7.m1.2.2.1.1.2.3.cmml">l</mi></munderover></mstyle><mrow id="S3.Ex7.m1.2.2.1.1.1" xref="S3.Ex7.m1.2.2.1.1.1.cmml"><msub id="S3.Ex7.m1.2.2.1.1.1.3" xref="S3.Ex7.m1.2.2.1.1.1.3.cmml"><mi id="S3.Ex7.m1.2.2.1.1.1.3.2" xref="S3.Ex7.m1.2.2.1.1.1.3.2.cmml">K</mi><mi id="S3.Ex7.m1.2.2.1.1.1.3.3" xref="S3.Ex7.m1.2.2.1.1.1.3.3.cmml">H</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex7.m1.2.2.1.1.1.2" xref="S3.Ex7.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.Ex7.m1.2.2.1.1.1.1.1" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex7.m1.2.2.1.1.1.1.1.2" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex7.m1.2.2.1.1.1.1.1.1" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.Ex7.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.3.cmml">F</mi><mo id="S3.Ex7.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.Ex7.m1.2.2.1.1.1.1.1.1.1" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.3.cmml">φ</mi><mo lspace="0em" rspace="0em" id="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.Ex7.m1.2.2.1.1.1.1.1.3" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex7.m1.2b"><apply id="S3.Ex7.m1.2.2.cmml" xref="S3.Ex7.m1.2.2"><eq id="S3.Ex7.m1.2.2.2.cmml" xref="S3.Ex7.m1.2.2.2"></eq><apply id="S3.Ex7.m1.2.2.3.cmml" xref="S3.Ex7.m1.2.2.3"><times id="S3.Ex7.m1.2.2.3.1.cmml" xref="S3.Ex7.m1.2.2.3.1"></times><apply id="S3.Ex7.m1.2.2.3.2.cmml" xref="S3.Ex7.m1.2.2.3.2"><csymbol cd="ambiguous" id="S3.Ex7.m1.2.2.3.2.1.cmml" xref="S3.Ex7.m1.2.2.3.2">subscript</csymbol><apply id="S3.Ex7.m1.2.2.3.2.2.cmml" xref="S3.Ex7.m1.2.2.3.2.2"><ci id="S3.Ex7.m1.2.2.3.2.2.1.cmml" xref="S3.Ex7.m1.2.2.3.2.2.1">~</ci><ci id="S3.Ex7.m1.2.2.3.2.2.2.cmml" xref="S3.Ex7.m1.2.2.3.2.2.2">𝑝</ci></apply><ci id="S3.Ex7.m1.2.2.3.2.3.cmml" xref="S3.Ex7.m1.2.2.3.2.3">𝑓</ci></apply><ci id="S3.Ex7.m1.1.1.cmml" xref="S3.Ex7.m1.1.1">𝐹</ci></apply><apply id="S3.Ex7.m1.2.2.1.cmml" xref="S3.Ex7.m1.2.2.1"><times id="S3.Ex7.m1.2.2.1.2.cmml" xref="S3.Ex7.m1.2.2.1.2"></times><apply id="S3.Ex7.m1.2.2.1.3.cmml" xref="S3.Ex7.m1.2.2.1.3"><divide id="S3.Ex7.m1.2.2.1.3.1.cmml" xref="S3.Ex7.m1.2.2.1.3"></divide><cn type="integer" id="S3.Ex7.m1.2.2.1.3.2.cmml" xref="S3.Ex7.m1.2.2.1.3.2">1</cn><ci id="S3.Ex7.m1.2.2.1.3.3.cmml" xref="S3.Ex7.m1.2.2.1.3.3">𝑙</ci></apply><apply id="S3.Ex7.m1.2.2.1.1.cmml" xref="S3.Ex7.m1.2.2.1.1"><apply id="S3.Ex7.m1.2.2.1.1.2.cmml" xref="S3.Ex7.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.Ex7.m1.2.2.1.1.2.1.cmml" xref="S3.Ex7.m1.2.2.1.1.2">superscript</csymbol><apply id="S3.Ex7.m1.2.2.1.1.2.2.cmml" xref="S3.Ex7.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.Ex7.m1.2.2.1.1.2.2.1.cmml" xref="S3.Ex7.m1.2.2.1.1.2">subscript</csymbol><sum id="S3.Ex7.m1.2.2.1.1.2.2.2.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.2"></sum><apply id="S3.Ex7.m1.2.2.1.1.2.2.3.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3"><eq id="S3.Ex7.m1.2.2.1.1.2.2.3.1.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3.1"></eq><ci id="S3.Ex7.m1.2.2.1.1.2.2.3.2.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S3.Ex7.m1.2.2.1.1.2.2.3.3.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.Ex7.m1.2.2.1.1.2.3.cmml" xref="S3.Ex7.m1.2.2.1.1.2.3">𝑙</ci></apply><apply id="S3.Ex7.m1.2.2.1.1.1.cmml" xref="S3.Ex7.m1.2.2.1.1.1"><times id="S3.Ex7.m1.2.2.1.1.1.2.cmml" xref="S3.Ex7.m1.2.2.1.1.1.2"></times><apply id="S3.Ex7.m1.2.2.1.1.1.3.cmml" xref="S3.Ex7.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex7.m1.2.2.1.1.1.3.1.cmml" xref="S3.Ex7.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.Ex7.m1.2.2.1.1.1.3.2.cmml" xref="S3.Ex7.m1.2.2.1.1.1.3.2">𝐾</ci><ci id="S3.Ex7.m1.2.2.1.1.1.3.3.cmml" xref="S3.Ex7.m1.2.2.1.1.1.3.3">𝐻</ci></apply><apply id="S3.Ex7.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.2.2.1.1.1.1.1"><minus id="S3.Ex7.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.2"></minus><ci id="S3.Ex7.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.3">𝐹</ci><apply id="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.1"><times id="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.2"></times><ci id="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.3">𝜑</ci><apply id="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex7.m1.2c">\displaystyle\tilde{p}_{f}(F)=\frac{1}{l}\sum_{j=1}^{l}K_{H}(F-\varphi(v_{j}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.12" class="ltx_p">where <math id="S3.SS3.p3.9.m1.1" class="ltx_Math" alttext="K_{H}" display="inline"><semantics id="S3.SS3.p3.9.m1.1a"><msub id="S3.SS3.p3.9.m1.1.1" xref="S3.SS3.p3.9.m1.1.1.cmml"><mi id="S3.SS3.p3.9.m1.1.1.2" xref="S3.SS3.p3.9.m1.1.1.2.cmml">K</mi><mi id="S3.SS3.p3.9.m1.1.1.3" xref="S3.SS3.p3.9.m1.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.9.m1.1b"><apply id="S3.SS3.p3.9.m1.1.1.cmml" xref="S3.SS3.p3.9.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m1.1.1.1.cmml" xref="S3.SS3.p3.9.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.9.m1.1.1.2.cmml" xref="S3.SS3.p3.9.m1.1.1.2">𝐾</ci><ci id="S3.SS3.p3.9.m1.1.1.3.cmml" xref="S3.SS3.p3.9.m1.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.9.m1.1c">K_{H}</annotation></semantics></math> is the standard multivariate normal kernel with bandwidth matrix <math id="S3.SS3.p3.10.m2.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S3.SS3.p3.10.m2.1a"><mi id="S3.SS3.p3.10.m2.1.1" xref="S3.SS3.p3.10.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.10.m2.1b"><ci id="S3.SS3.p3.10.m2.1.1.cmml" xref="S3.SS3.p3.10.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.10.m2.1c">H</annotation></semantics></math>. We use <math id="S3.SS3.p3.11.m3.1" class="ltx_Math" alttext="H=dI" display="inline"><semantics id="S3.SS3.p3.11.m3.1a"><mrow id="S3.SS3.p3.11.m3.1.1" xref="S3.SS3.p3.11.m3.1.1.cmml"><mi id="S3.SS3.p3.11.m3.1.1.2" xref="S3.SS3.p3.11.m3.1.1.2.cmml">H</mi><mo id="S3.SS3.p3.11.m3.1.1.1" xref="S3.SS3.p3.11.m3.1.1.1.cmml">=</mo><mrow id="S3.SS3.p3.11.m3.1.1.3" xref="S3.SS3.p3.11.m3.1.1.3.cmml"><mi id="S3.SS3.p3.11.m3.1.1.3.2" xref="S3.SS3.p3.11.m3.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.11.m3.1.1.3.1" xref="S3.SS3.p3.11.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p3.11.m3.1.1.3.3" xref="S3.SS3.p3.11.m3.1.1.3.3.cmml">I</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.11.m3.1b"><apply id="S3.SS3.p3.11.m3.1.1.cmml" xref="S3.SS3.p3.11.m3.1.1"><eq id="S3.SS3.p3.11.m3.1.1.1.cmml" xref="S3.SS3.p3.11.m3.1.1.1"></eq><ci id="S3.SS3.p3.11.m3.1.1.2.cmml" xref="S3.SS3.p3.11.m3.1.1.2">𝐻</ci><apply id="S3.SS3.p3.11.m3.1.1.3.cmml" xref="S3.SS3.p3.11.m3.1.1.3"><times id="S3.SS3.p3.11.m3.1.1.3.1.cmml" xref="S3.SS3.p3.11.m3.1.1.3.1"></times><ci id="S3.SS3.p3.11.m3.1.1.3.2.cmml" xref="S3.SS3.p3.11.m3.1.1.3.2">𝑑</ci><ci id="S3.SS3.p3.11.m3.1.1.3.3.cmml" xref="S3.SS3.p3.11.m3.1.1.3.3">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.11.m3.1c">H=dI</annotation></semantics></math> where <math id="S3.SS3.p3.12.m4.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS3.p3.12.m4.1a"><mi id="S3.SS3.p3.12.m4.1.1" xref="S3.SS3.p3.12.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.12.m4.1b"><ci id="S3.SS3.p3.12.m4.1.1.cmml" xref="S3.SS3.p3.12.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.12.m4.1c">d</annotation></semantics></math> is the dimensionality of the feature space.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para ltx_noindent">
<p id="S3.SS3.p4.3" class="ltx_p">Our generative model involves making a discrete (non-differentiable) choice at each
step, leading us to optimize our objective using reinforcement learning techniques<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>We did not explore sampling from a continuous relaxation of the discrete variable here</span></span></span>.
Specifically, using the REINFORCE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib67" title="" class="ltx_ref">67</a>]</cite> score function estimator along with a moving average baseline, we approximate the gradients of Eq. <a href="#S3.E1" title="In 3.3 Training ‣ 3 Methodology ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> as</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.2" class="ltx_Math" alttext="\nabla_{\theta}\mathcal{L}\approx\frac{1}{M}\sum_{j=1}^{m}(\log\tilde{q}_{f}(\varphi(v_{j}^{\prime}))-\log\tilde{p}_{f}(\varphi(v_{j}^{\prime})))\nabla_{\theta}\log q_{I}(v_{j}^{\prime})" display="block"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><mrow id="S3.E2.m1.2.2.4" xref="S3.E2.m1.2.2.4.cmml"><msub id="S3.E2.m1.2.2.4.1" xref="S3.E2.m1.2.2.4.1.cmml"><mo id="S3.E2.m1.2.2.4.1.2" xref="S3.E2.m1.2.2.4.1.2.cmml">∇</mo><mi id="S3.E2.m1.2.2.4.1.3" xref="S3.E2.m1.2.2.4.1.3.cmml">θ</mi></msub><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.4.2" xref="S3.E2.m1.2.2.4.2.cmml">ℒ</mi></mrow><mo id="S3.E2.m1.2.2.3" xref="S3.E2.m1.2.2.3.cmml">≈</mo><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml"><mfrac id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.4.cmml"><mn id="S3.E2.m1.2.2.2.4.2" xref="S3.E2.m1.2.2.2.4.2.cmml">1</mn><mi id="S3.E2.m1.2.2.2.4.3" xref="S3.E2.m1.2.2.2.4.3.cmml">M</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.2.3.cmml">​</mo><mrow id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml"><munderover id="S3.E2.m1.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.3.cmml"><mo movablelimits="false" rspace="0em" id="S3.E2.m1.2.2.2.2.3.2.2" xref="S3.E2.m1.2.2.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E2.m1.2.2.2.2.3.2.3" xref="S3.E2.m1.2.2.2.2.3.2.3.cmml"><mi id="S3.E2.m1.2.2.2.2.3.2.3.2" xref="S3.E2.m1.2.2.2.2.3.2.3.2.cmml">j</mi><mo id="S3.E2.m1.2.2.2.2.3.2.3.1" xref="S3.E2.m1.2.2.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E2.m1.2.2.2.2.3.2.3.3" xref="S3.E2.m1.2.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.2.2.2.2.3.3" xref="S3.E2.m1.2.2.2.2.3.3.cmml">m</mi></munderover><mrow id="S3.E2.m1.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3a" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mover accent="true" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">q</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.2.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml">~</mo></mover><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">f</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">φ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">v</mi><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E2.m1.1.1.1.1.1.1.1.1.2.3a" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.cmml">⁡</mo><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2.cmml"><mover accent="true" id="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2.2.2.cmml">p</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2.2.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2.2.1.cmml">~</mo></mover><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2.3.cmml">f</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.2.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml">φ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml">v</mi><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml">j</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S3.E2.m1.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.3.cmml">​</mo><mrow id="S3.E2.m1.2.2.2.2.2.4" xref="S3.E2.m1.2.2.2.2.2.4.cmml"><mrow id="S3.E2.m1.2.2.2.2.2.4.1" xref="S3.E2.m1.2.2.2.2.2.4.1.cmml"><msub id="S3.E2.m1.2.2.2.2.2.4.1.1" xref="S3.E2.m1.2.2.2.2.2.4.1.1.cmml"><mo rspace="0.167em" id="S3.E2.m1.2.2.2.2.2.4.1.1.2" xref="S3.E2.m1.2.2.2.2.2.4.1.1.2.cmml">∇</mo><mi id="S3.E2.m1.2.2.2.2.2.4.1.1.3" xref="S3.E2.m1.2.2.2.2.2.4.1.1.3.cmml">θ</mi></msub><mi id="S3.E2.m1.2.2.2.2.2.4.1.2" xref="S3.E2.m1.2.2.2.2.2.4.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="S3.E2.m1.2.2.2.2.2.4a" xref="S3.E2.m1.2.2.2.2.2.4.cmml">⁡</mo><msub id="S3.E2.m1.2.2.2.2.2.4.2" xref="S3.E2.m1.2.2.2.2.2.4.2.cmml"><mi id="S3.E2.m1.2.2.2.2.2.4.2.2" xref="S3.E2.m1.2.2.2.2.2.4.2.2.cmml">q</mi><mi id="S3.E2.m1.2.2.2.2.2.4.2.3" xref="S3.E2.m1.2.2.2.2.2.4.2.3.cmml">I</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.2.3a" xref="S3.E2.m1.2.2.2.2.2.3.cmml">​</mo><mrow id="S3.E2.m1.2.2.2.2.2.2.1" xref="S3.E2.m1.2.2.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.2.2.2.1.2" xref="S3.E2.m1.2.2.2.2.2.2.1.1.cmml">(</mo><msubsup id="S3.E2.m1.2.2.2.2.2.2.1.1" xref="S3.E2.m1.2.2.2.2.2.2.1.1.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.1.1.2.2" xref="S3.E2.m1.2.2.2.2.2.2.1.1.2.2.cmml">v</mi><mi id="S3.E2.m1.2.2.2.2.2.2.1.1.2.3" xref="S3.E2.m1.2.2.2.2.2.2.1.1.2.3.cmml">j</mi><mo id="S3.E2.m1.2.2.2.2.2.2.1.1.3" xref="S3.E2.m1.2.2.2.2.2.2.1.1.3.cmml">′</mo></msubsup><mo stretchy="false" id="S3.E2.m1.2.2.2.2.2.2.1.3" xref="S3.E2.m1.2.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><approx id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2.3"></approx><apply id="S3.E2.m1.2.2.4.cmml" xref="S3.E2.m1.2.2.4"><apply id="S3.E2.m1.2.2.4.1.cmml" xref="S3.E2.m1.2.2.4.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.4.1.1.cmml" xref="S3.E2.m1.2.2.4.1">subscript</csymbol><ci id="S3.E2.m1.2.2.4.1.2.cmml" xref="S3.E2.m1.2.2.4.1.2">∇</ci><ci id="S3.E2.m1.2.2.4.1.3.cmml" xref="S3.E2.m1.2.2.4.1.3">𝜃</ci></apply><ci id="S3.E2.m1.2.2.4.2.cmml" xref="S3.E2.m1.2.2.4.2">ℒ</ci></apply><apply id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"><times id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.3"></times><apply id="S3.E2.m1.2.2.2.4.cmml" xref="S3.E2.m1.2.2.2.4"><divide id="S3.E2.m1.2.2.2.4.1.cmml" xref="S3.E2.m1.2.2.2.4"></divide><cn type="integer" id="S3.E2.m1.2.2.2.4.2.cmml" xref="S3.E2.m1.2.2.2.4.2">1</cn><ci id="S3.E2.m1.2.2.2.4.3.cmml" xref="S3.E2.m1.2.2.2.4.3">𝑀</ci></apply><apply id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2"><apply id="S3.E2.m1.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.3.1.cmml" xref="S3.E2.m1.2.2.2.2.3">superscript</csymbol><apply id="S3.E2.m1.2.2.2.2.3.2.cmml" xref="S3.E2.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.3.2.1.cmml" xref="S3.E2.m1.2.2.2.2.3">subscript</csymbol><sum id="S3.E2.m1.2.2.2.2.3.2.2.cmml" xref="S3.E2.m1.2.2.2.2.3.2.2"></sum><apply id="S3.E2.m1.2.2.2.2.3.2.3.cmml" xref="S3.E2.m1.2.2.2.2.3.2.3"><eq id="S3.E2.m1.2.2.2.2.3.2.3.1.cmml" xref="S3.E2.m1.2.2.2.2.3.2.3.1"></eq><ci id="S3.E2.m1.2.2.2.2.3.2.3.2.cmml" xref="S3.E2.m1.2.2.2.2.3.2.3.2">𝑗</ci><cn type="integer" id="S3.E2.m1.2.2.2.2.3.2.3.3.cmml" xref="S3.E2.m1.2.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.2.2.2.2.3.3.cmml" xref="S3.E2.m1.2.2.2.2.3.3">𝑚</ci></apply><apply id="S3.E2.m1.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2"><times id="S3.E2.m1.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.3"></times><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1"><minus id="S3.E2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3"></minus><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3"><log id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.1"></log><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.2"><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.2.1">~</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.2.2">𝑞</ci></apply><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3">𝑓</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝜑</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑣</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">′</ci></apply></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2"><times id="S3.E2.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.2"></times><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.3"><log id="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.1"></log><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2">subscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2.2"><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2.2.1">~</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2.2.2">𝑝</ci></apply><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.3.2.3">𝑓</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1"><times id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.2"></times><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.3">𝜑</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.2">𝑣</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3">′</ci></apply></apply></apply></apply><apply id="S3.E2.m1.2.2.2.2.2.4.cmml" xref="S3.E2.m1.2.2.2.2.2.4"><apply id="S3.E2.m1.2.2.2.2.2.4.1.cmml" xref="S3.E2.m1.2.2.2.2.2.4.1"><apply id="S3.E2.m1.2.2.2.2.2.4.1.1.cmml" xref="S3.E2.m1.2.2.2.2.2.4.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.4.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.2.4.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.4.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.2.4.1.1.2">∇</ci><ci id="S3.E2.m1.2.2.2.2.2.4.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.2.4.1.1.3">𝜃</ci></apply><log id="S3.E2.m1.2.2.2.2.2.4.1.2.cmml" xref="S3.E2.m1.2.2.2.2.2.4.1.2"></log></apply><apply id="S3.E2.m1.2.2.2.2.2.4.2.cmml" xref="S3.E2.m1.2.2.2.2.2.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.4.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2.4.2">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.4.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.4.2.2">𝑞</ci><ci id="S3.E2.m1.2.2.2.2.2.4.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.4.2.3">𝐼</ci></apply></apply><apply id="S3.E2.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1">superscript</csymbol><apply id="S3.E2.m1.2.2.2.2.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.2.1.1.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.2.1.1.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.1.2.2">𝑣</ci><ci id="S3.E2.m1.2.2.2.2.2.2.1.1.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.1.2.3">𝑗</ci></apply><ci id="S3.E2.m1.2.2.2.2.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.1.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">\nabla_{\theta}\mathcal{L}\approx\frac{1}{M}\sum_{j=1}^{m}(\log\tilde{q}_{f}(\varphi(v_{j}^{\prime}))-\log\tilde{p}_{f}(\varphi(v_{j}^{\prime})))\nabla_{\theta}\log q_{I}(v_{j}^{\prime})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p4.2" class="ltx_p">where M is the batch size, <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="\tilde{q}_{f}(F)" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mrow id="S3.SS3.p4.1.m1.1.2" xref="S3.SS3.p4.1.m1.1.2.cmml"><msub id="S3.SS3.p4.1.m1.1.2.2" xref="S3.SS3.p4.1.m1.1.2.2.cmml"><mover accent="true" id="S3.SS3.p4.1.m1.1.2.2.2" xref="S3.SS3.p4.1.m1.1.2.2.2.cmml"><mi id="S3.SS3.p4.1.m1.1.2.2.2.2" xref="S3.SS3.p4.1.m1.1.2.2.2.2.cmml">q</mi><mo id="S3.SS3.p4.1.m1.1.2.2.2.1" xref="S3.SS3.p4.1.m1.1.2.2.2.1.cmml">~</mo></mover><mi id="S3.SS3.p4.1.m1.1.2.2.3" xref="S3.SS3.p4.1.m1.1.2.2.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p4.1.m1.1.2.1" xref="S3.SS3.p4.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS3.p4.1.m1.1.2.3.2" xref="S3.SS3.p4.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p4.1.m1.1.2.3.2.1" xref="S3.SS3.p4.1.m1.1.2.cmml">(</mo><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">F</mi><mo stretchy="false" id="S3.SS3.p4.1.m1.1.2.3.2.2" xref="S3.SS3.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.2"><times id="S3.SS3.p4.1.m1.1.2.1.cmml" xref="S3.SS3.p4.1.m1.1.2.1"></times><apply id="S3.SS3.p4.1.m1.1.2.2.cmml" xref="S3.SS3.p4.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.2.2.1.cmml" xref="S3.SS3.p4.1.m1.1.2.2">subscript</csymbol><apply id="S3.SS3.p4.1.m1.1.2.2.2.cmml" xref="S3.SS3.p4.1.m1.1.2.2.2"><ci id="S3.SS3.p4.1.m1.1.2.2.2.1.cmml" xref="S3.SS3.p4.1.m1.1.2.2.2.1">~</ci><ci id="S3.SS3.p4.1.m1.1.2.2.2.2.cmml" xref="S3.SS3.p4.1.m1.1.2.2.2.2">𝑞</ci></apply><ci id="S3.SS3.p4.1.m1.1.2.2.3.cmml" xref="S3.SS3.p4.1.m1.1.2.2.3">𝑓</ci></apply><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">\tilde{q}_{f}(F)</annotation></semantics></math> and <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="\tilde{p}_{f}(F)" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><mrow id="S3.SS3.p4.2.m2.1.2" xref="S3.SS3.p4.2.m2.1.2.cmml"><msub id="S3.SS3.p4.2.m2.1.2.2" xref="S3.SS3.p4.2.m2.1.2.2.cmml"><mover accent="true" id="S3.SS3.p4.2.m2.1.2.2.2" xref="S3.SS3.p4.2.m2.1.2.2.2.cmml"><mi id="S3.SS3.p4.2.m2.1.2.2.2.2" xref="S3.SS3.p4.2.m2.1.2.2.2.2.cmml">p</mi><mo id="S3.SS3.p4.2.m2.1.2.2.2.1" xref="S3.SS3.p4.2.m2.1.2.2.2.1.cmml">~</mo></mover><mi id="S3.SS3.p4.2.m2.1.2.2.3" xref="S3.SS3.p4.2.m2.1.2.2.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.2.1" xref="S3.SS3.p4.2.m2.1.2.1.cmml">​</mo><mrow id="S3.SS3.p4.2.m2.1.2.3.2" xref="S3.SS3.p4.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS3.p4.2.m2.1.2.3.2.1" xref="S3.SS3.p4.2.m2.1.2.cmml">(</mo><mi id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml">F</mi><mo stretchy="false" id="S3.SS3.p4.2.m2.1.2.3.2.2" xref="S3.SS3.p4.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.2.cmml" xref="S3.SS3.p4.2.m2.1.2"><times id="S3.SS3.p4.2.m2.1.2.1.cmml" xref="S3.SS3.p4.2.m2.1.2.1"></times><apply id="S3.SS3.p4.2.m2.1.2.2.cmml" xref="S3.SS3.p4.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.2.2.1.cmml" xref="S3.SS3.p4.2.m2.1.2.2">subscript</csymbol><apply id="S3.SS3.p4.2.m2.1.2.2.2.cmml" xref="S3.SS3.p4.2.m2.1.2.2.2"><ci id="S3.SS3.p4.2.m2.1.2.2.2.1.cmml" xref="S3.SS3.p4.2.m2.1.2.2.2.1">~</ci><ci id="S3.SS3.p4.2.m2.1.2.2.2.2.cmml" xref="S3.SS3.p4.2.m2.1.2.2.2.2">𝑝</ci></apply><ci id="S3.SS3.p4.2.m2.1.2.2.3.cmml" xref="S3.SS3.p4.2.m2.1.2.2.3">𝑓</ci></apply><ci id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">\tilde{p}_{f}(F)</annotation></semantics></math> are density estimates defined above.</p>
</div>
<div id="S3.SS3.p5" class="ltx_para ltx_noindent">
<p id="S3.SS3.p5.5" class="ltx_p">Notice that the gradient above requires computing the marginal
probability <math id="S3.SS3.p5.1.m1.1" class="ltx_Math" alttext="q_{I}(v^{\prime})" display="inline"><semantics id="S3.SS3.p5.1.m1.1a"><mrow id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml"><msub id="S3.SS3.p5.1.m1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.3.cmml"><mi id="S3.SS3.p5.1.m1.1.1.3.2" xref="S3.SS3.p5.1.m1.1.1.3.2.cmml">q</mi><mi id="S3.SS3.p5.1.m1.1.1.3.3" xref="S3.SS3.p5.1.m1.1.1.3.3.cmml">I</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p5.1.m1.1.1.2" xref="S3.SS3.p5.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p5.1.m1.1.1.1.1" xref="S3.SS3.p5.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p5.1.m1.1.1.1.1.2" xref="S3.SS3.p5.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S3.SS3.p5.1.m1.1.1.1.1.1" xref="S3.SS3.p5.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.p5.1.m1.1.1.1.1.1.2" xref="S3.SS3.p5.1.m1.1.1.1.1.1.2.cmml">v</mi><mo id="S3.SS3.p5.1.m1.1.1.1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.1.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="S3.SS3.p5.1.m1.1.1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><apply id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1"><times id="S3.SS3.p5.1.m1.1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.1.2"></times><apply id="S3.SS3.p5.1.m1.1.1.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.1.1.3.1.cmml" xref="S3.SS3.p5.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.p5.1.m1.1.1.3.2.cmml" xref="S3.SS3.p5.1.m1.1.1.3.2">𝑞</ci><ci id="S3.SS3.p5.1.m1.1.1.3.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3.3">𝐼</ci></apply><apply id="S3.SS3.p5.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p5.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS3.p5.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1.1.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">q_{I}(v^{\prime})</annotation></semantics></math> of a generated image <math id="S3.SS3.p5.2.m2.1" class="ltx_Math" alttext="v^{\prime}" display="inline"><semantics id="S3.SS3.p5.2.m2.1a"><msup id="S3.SS3.p5.2.m2.1.1" xref="S3.SS3.p5.2.m2.1.1.cmml"><mi id="S3.SS3.p5.2.m2.1.1.2" xref="S3.SS3.p5.2.m2.1.1.2.cmml">v</mi><mo id="S3.SS3.p5.2.m2.1.1.3" xref="S3.SS3.p5.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.1b"><apply id="S3.SS3.p5.2.m2.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.2.m2.1.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.p5.2.m2.1.1.2.cmml" xref="S3.SS3.p5.2.m2.1.1.2">𝑣</ci><ci id="S3.SS3.p5.2.m2.1.1.3.cmml" xref="S3.SS3.p5.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">v^{\prime}</annotation></semantics></math>, instead of the conditional
<math id="S3.SS3.p5.3.m3.1" class="ltx_Math" alttext="q_{I}(v^{\prime}|z)" display="inline"><semantics id="S3.SS3.p5.3.m3.1a"><mrow id="S3.SS3.p5.3.m3.1.1" xref="S3.SS3.p5.3.m3.1.1.cmml"><msub id="S3.SS3.p5.3.m3.1.1.3" xref="S3.SS3.p5.3.m3.1.1.3.cmml"><mi id="S3.SS3.p5.3.m3.1.1.3.2" xref="S3.SS3.p5.3.m3.1.1.3.2.cmml">q</mi><mi id="S3.SS3.p5.3.m3.1.1.3.3" xref="S3.SS3.p5.3.m3.1.1.3.3.cmml">I</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p5.3.m3.1.1.2" xref="S3.SS3.p5.3.m3.1.1.2.cmml">​</mo><mrow id="S3.SS3.p5.3.m3.1.1.1.1" xref="S3.SS3.p5.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p5.3.m3.1.1.1.1.2" xref="S3.SS3.p5.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p5.3.m3.1.1.1.1.1" xref="S3.SS3.p5.3.m3.1.1.1.1.1.cmml"><msup id="S3.SS3.p5.3.m3.1.1.1.1.1.2" xref="S3.SS3.p5.3.m3.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p5.3.m3.1.1.1.1.1.2.2" xref="S3.SS3.p5.3.m3.1.1.1.1.1.2.2.cmml">v</mi><mo id="S3.SS3.p5.3.m3.1.1.1.1.1.2.3" xref="S3.SS3.p5.3.m3.1.1.1.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="S3.SS3.p5.3.m3.1.1.1.1.1.1" xref="S3.SS3.p5.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS3.p5.3.m3.1.1.1.1.1.3" xref="S3.SS3.p5.3.m3.1.1.1.1.1.3.cmml">z</mi></mrow><mo stretchy="false" id="S3.SS3.p5.3.m3.1.1.1.1.3" xref="S3.SS3.p5.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.3.m3.1b"><apply id="S3.SS3.p5.3.m3.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1"><times id="S3.SS3.p5.3.m3.1.1.2.cmml" xref="S3.SS3.p5.3.m3.1.1.2"></times><apply id="S3.SS3.p5.3.m3.1.1.3.cmml" xref="S3.SS3.p5.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.1.1.3.1.cmml" xref="S3.SS3.p5.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS3.p5.3.m3.1.1.3.2.cmml" xref="S3.SS3.p5.3.m3.1.1.3.2">𝑞</ci><ci id="S3.SS3.p5.3.m3.1.1.3.3.cmml" xref="S3.SS3.p5.3.m3.1.1.3.3">𝐼</ci></apply><apply id="S3.SS3.p5.3.m3.1.1.1.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p5.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS3.p5.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS3.p5.3.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p5.3.m3.1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS3.p5.3.m3.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p5.3.m3.1.1.1.1.1.2.2">𝑣</ci><ci id="S3.SS3.p5.3.m3.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p5.3.m3.1.1.1.1.1.2.3">′</ci></apply><ci id="S3.SS3.p5.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS3.p5.3.m3.1.1.1.1.1.3">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.3.m3.1c">q_{I}(v^{\prime}|z)</annotation></semantics></math>. Computing the <span id="S3.SS3.p5.5.1" class="ltx_text ltx_font_bold">marginal probability of a generated image</span> requires an intractable marginalization over the latent
variable <math id="S3.SS3.p5.4.m4.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.SS3.p5.4.m4.1a"><mi id="S3.SS3.p5.4.m4.1.1" xref="S3.SS3.p5.4.m4.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.4.m4.1b"><ci id="S3.SS3.p5.4.m4.1.1.cmml" xref="S3.SS3.p5.4.m4.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.4.m4.1c">z</annotation></semantics></math>. To circumvent this, we use a fixed finite number of latent vectors from a set <math id="S3.SS3.p5.5.m5.1" class="ltx_Math" alttext="Z" display="inline"><semantics id="S3.SS3.p5.5.m5.1a"><mi id="S3.SS3.p5.5.m5.1.1" xref="S3.SS3.p5.5.m5.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.5.m5.1b"><ci id="S3.SS3.p5.5.m5.1.1.cmml" xref="S3.SS3.p5.5.m5.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.5.m5.1c">Z</annotation></semantics></math> sampled uniformly, enabling easy marginalization.
This translates to,</p>
<table id="S6.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex8.m1.1" class="ltx_Math" alttext="\displaystyle q_{\theta}(T)" display="inline"><semantics id="S3.Ex8.m1.1a"><mrow id="S3.Ex8.m1.1.2" xref="S3.Ex8.m1.1.2.cmml"><msub id="S3.Ex8.m1.1.2.2" xref="S3.Ex8.m1.1.2.2.cmml"><mi id="S3.Ex8.m1.1.2.2.2" xref="S3.Ex8.m1.1.2.2.2.cmml">q</mi><mi id="S3.Ex8.m1.1.2.2.3" xref="S3.Ex8.m1.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex8.m1.1.2.1" xref="S3.Ex8.m1.1.2.1.cmml">​</mo><mrow id="S3.Ex8.m1.1.2.3.2" xref="S3.Ex8.m1.1.2.cmml"><mo stretchy="false" id="S3.Ex8.m1.1.2.3.2.1" xref="S3.Ex8.m1.1.2.cmml">(</mo><mi id="S3.Ex8.m1.1.1" xref="S3.Ex8.m1.1.1.cmml">T</mi><mo stretchy="false" id="S3.Ex8.m1.1.2.3.2.2" xref="S3.Ex8.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex8.m1.1b"><apply id="S3.Ex8.m1.1.2.cmml" xref="S3.Ex8.m1.1.2"><times id="S3.Ex8.m1.1.2.1.cmml" xref="S3.Ex8.m1.1.2.1"></times><apply id="S3.Ex8.m1.1.2.2.cmml" xref="S3.Ex8.m1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex8.m1.1.2.2.1.cmml" xref="S3.Ex8.m1.1.2.2">subscript</csymbol><ci id="S3.Ex8.m1.1.2.2.2.cmml" xref="S3.Ex8.m1.1.2.2.2">𝑞</ci><ci id="S3.Ex8.m1.1.2.2.3.cmml" xref="S3.Ex8.m1.1.2.2.3">𝜃</ci></apply><ci id="S3.Ex8.m1.1.1.cmml" xref="S3.Ex8.m1.1.1">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex8.m1.1c">\displaystyle q_{\theta}(T)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex8.m2.2" class="ltx_Math" alttext="\displaystyle=\frac{1}{|Z|}\sum_{z\in Z}q_{\theta}(T|z)" display="inline"><semantics id="S3.Ex8.m2.2a"><mrow id="S3.Ex8.m2.2.2" xref="S3.Ex8.m2.2.2.cmml"><mi id="S3.Ex8.m2.2.2.3" xref="S3.Ex8.m2.2.2.3.cmml"></mi><mo id="S3.Ex8.m2.2.2.2" xref="S3.Ex8.m2.2.2.2.cmml">=</mo><mrow id="S3.Ex8.m2.2.2.1" xref="S3.Ex8.m2.2.2.1.cmml"><mstyle displaystyle="true" id="S3.Ex8.m2.1.1" xref="S3.Ex8.m2.1.1.cmml"><mfrac id="S3.Ex8.m2.1.1a" xref="S3.Ex8.m2.1.1.cmml"><mn id="S3.Ex8.m2.1.1.3" xref="S3.Ex8.m2.1.1.3.cmml">1</mn><mrow id="S3.Ex8.m2.1.1.1.3" xref="S3.Ex8.m2.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex8.m2.1.1.1.3.1" xref="S3.Ex8.m2.1.1.1.2.1.cmml">|</mo><mi id="S3.Ex8.m2.1.1.1.1" xref="S3.Ex8.m2.1.1.1.1.cmml">Z</mi><mo stretchy="false" id="S3.Ex8.m2.1.1.1.3.2" xref="S3.Ex8.m2.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.Ex8.m2.2.2.1.2" xref="S3.Ex8.m2.2.2.1.2.cmml">​</mo><mrow id="S3.Ex8.m2.2.2.1.1" xref="S3.Ex8.m2.2.2.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex8.m2.2.2.1.1.2" xref="S3.Ex8.m2.2.2.1.1.2.cmml"><munder id="S3.Ex8.m2.2.2.1.1.2a" xref="S3.Ex8.m2.2.2.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex8.m2.2.2.1.1.2.2" xref="S3.Ex8.m2.2.2.1.1.2.2.cmml">∑</mo><mrow id="S3.Ex8.m2.2.2.1.1.2.3" xref="S3.Ex8.m2.2.2.1.1.2.3.cmml"><mi id="S3.Ex8.m2.2.2.1.1.2.3.2" xref="S3.Ex8.m2.2.2.1.1.2.3.2.cmml">z</mi><mo id="S3.Ex8.m2.2.2.1.1.2.3.1" xref="S3.Ex8.m2.2.2.1.1.2.3.1.cmml">∈</mo><mi id="S3.Ex8.m2.2.2.1.1.2.3.3" xref="S3.Ex8.m2.2.2.1.1.2.3.3.cmml">Z</mi></mrow></munder></mstyle><mrow id="S3.Ex8.m2.2.2.1.1.1" xref="S3.Ex8.m2.2.2.1.1.1.cmml"><msub id="S3.Ex8.m2.2.2.1.1.1.3" xref="S3.Ex8.m2.2.2.1.1.1.3.cmml"><mi id="S3.Ex8.m2.2.2.1.1.1.3.2" xref="S3.Ex8.m2.2.2.1.1.1.3.2.cmml">q</mi><mi id="S3.Ex8.m2.2.2.1.1.1.3.3" xref="S3.Ex8.m2.2.2.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex8.m2.2.2.1.1.1.2" xref="S3.Ex8.m2.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.Ex8.m2.2.2.1.1.1.1.1" xref="S3.Ex8.m2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex8.m2.2.2.1.1.1.1.1.2" xref="S3.Ex8.m2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex8.m2.2.2.1.1.1.1.1.1" xref="S3.Ex8.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.Ex8.m2.2.2.1.1.1.1.1.1.2" xref="S3.Ex8.m2.2.2.1.1.1.1.1.1.2.cmml">T</mi><mo fence="false" id="S3.Ex8.m2.2.2.1.1.1.1.1.1.1" xref="S3.Ex8.m2.2.2.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.Ex8.m2.2.2.1.1.1.1.1.1.3" xref="S3.Ex8.m2.2.2.1.1.1.1.1.1.3.cmml">z</mi></mrow><mo stretchy="false" id="S3.Ex8.m2.2.2.1.1.1.1.1.3" xref="S3.Ex8.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex8.m2.2b"><apply id="S3.Ex8.m2.2.2.cmml" xref="S3.Ex8.m2.2.2"><eq id="S3.Ex8.m2.2.2.2.cmml" xref="S3.Ex8.m2.2.2.2"></eq><csymbol cd="latexml" id="S3.Ex8.m2.2.2.3.cmml" xref="S3.Ex8.m2.2.2.3">absent</csymbol><apply id="S3.Ex8.m2.2.2.1.cmml" xref="S3.Ex8.m2.2.2.1"><times id="S3.Ex8.m2.2.2.1.2.cmml" xref="S3.Ex8.m2.2.2.1.2"></times><apply id="S3.Ex8.m2.1.1.cmml" xref="S3.Ex8.m2.1.1"><divide id="S3.Ex8.m2.1.1.2.cmml" xref="S3.Ex8.m2.1.1"></divide><cn type="integer" id="S3.Ex8.m2.1.1.3.cmml" xref="S3.Ex8.m2.1.1.3">1</cn><apply id="S3.Ex8.m2.1.1.1.2.cmml" xref="S3.Ex8.m2.1.1.1.3"><abs id="S3.Ex8.m2.1.1.1.2.1.cmml" xref="S3.Ex8.m2.1.1.1.3.1"></abs><ci id="S3.Ex8.m2.1.1.1.1.cmml" xref="S3.Ex8.m2.1.1.1.1">𝑍</ci></apply></apply><apply id="S3.Ex8.m2.2.2.1.1.cmml" xref="S3.Ex8.m2.2.2.1.1"><apply id="S3.Ex8.m2.2.2.1.1.2.cmml" xref="S3.Ex8.m2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.Ex8.m2.2.2.1.1.2.1.cmml" xref="S3.Ex8.m2.2.2.1.1.2">subscript</csymbol><sum id="S3.Ex8.m2.2.2.1.1.2.2.cmml" xref="S3.Ex8.m2.2.2.1.1.2.2"></sum><apply id="S3.Ex8.m2.2.2.1.1.2.3.cmml" xref="S3.Ex8.m2.2.2.1.1.2.3"><in id="S3.Ex8.m2.2.2.1.1.2.3.1.cmml" xref="S3.Ex8.m2.2.2.1.1.2.3.1"></in><ci id="S3.Ex8.m2.2.2.1.1.2.3.2.cmml" xref="S3.Ex8.m2.2.2.1.1.2.3.2">𝑧</ci><ci id="S3.Ex8.m2.2.2.1.1.2.3.3.cmml" xref="S3.Ex8.m2.2.2.1.1.2.3.3">𝑍</ci></apply></apply><apply id="S3.Ex8.m2.2.2.1.1.1.cmml" xref="S3.Ex8.m2.2.2.1.1.1"><times id="S3.Ex8.m2.2.2.1.1.1.2.cmml" xref="S3.Ex8.m2.2.2.1.1.1.2"></times><apply id="S3.Ex8.m2.2.2.1.1.1.3.cmml" xref="S3.Ex8.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex8.m2.2.2.1.1.1.3.1.cmml" xref="S3.Ex8.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.Ex8.m2.2.2.1.1.1.3.2.cmml" xref="S3.Ex8.m2.2.2.1.1.1.3.2">𝑞</ci><ci id="S3.Ex8.m2.2.2.1.1.1.3.3.cmml" xref="S3.Ex8.m2.2.2.1.1.1.3.3">𝜃</ci></apply><apply id="S3.Ex8.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex8.m2.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex8.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex8.m2.2.2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.Ex8.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex8.m2.2.2.1.1.1.1.1.1.2">𝑇</ci><ci id="S3.Ex8.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.Ex8.m2.2.2.1.1.1.1.1.1.3">𝑧</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex8.m2.2c">\displaystyle=\frac{1}{|Z|}\sum_{z\in Z}q_{\theta}(T|z)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex9.m1.1" class="ltx_Math" alttext="\displaystyle q_{I}(v^{\prime})" display="inline"><semantics id="S3.Ex9.m1.1a"><mrow id="S3.Ex9.m1.1.1" xref="S3.Ex9.m1.1.1.cmml"><msub id="S3.Ex9.m1.1.1.3" xref="S3.Ex9.m1.1.1.3.cmml"><mi id="S3.Ex9.m1.1.1.3.2" xref="S3.Ex9.m1.1.1.3.2.cmml">q</mi><mi id="S3.Ex9.m1.1.1.3.3" xref="S3.Ex9.m1.1.1.3.3.cmml">I</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex9.m1.1.1.2" xref="S3.Ex9.m1.1.1.2.cmml">​</mo><mrow id="S3.Ex9.m1.1.1.1.1" xref="S3.Ex9.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex9.m1.1.1.1.1.2" xref="S3.Ex9.m1.1.1.1.1.1.cmml">(</mo><msup id="S3.Ex9.m1.1.1.1.1.1" xref="S3.Ex9.m1.1.1.1.1.1.cmml"><mi id="S3.Ex9.m1.1.1.1.1.1.2" xref="S3.Ex9.m1.1.1.1.1.1.2.cmml">v</mi><mo id="S3.Ex9.m1.1.1.1.1.1.3" xref="S3.Ex9.m1.1.1.1.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="S3.Ex9.m1.1.1.1.1.3" xref="S3.Ex9.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex9.m1.1b"><apply id="S3.Ex9.m1.1.1.cmml" xref="S3.Ex9.m1.1.1"><times id="S3.Ex9.m1.1.1.2.cmml" xref="S3.Ex9.m1.1.1.2"></times><apply id="S3.Ex9.m1.1.1.3.cmml" xref="S3.Ex9.m1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex9.m1.1.1.3.1.cmml" xref="S3.Ex9.m1.1.1.3">subscript</csymbol><ci id="S3.Ex9.m1.1.1.3.2.cmml" xref="S3.Ex9.m1.1.1.3.2">𝑞</ci><ci id="S3.Ex9.m1.1.1.3.3.cmml" xref="S3.Ex9.m1.1.1.3.3">𝐼</ci></apply><apply id="S3.Ex9.m1.1.1.1.1.1.cmml" xref="S3.Ex9.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex9.m1.1.1.1.1.1.1.cmml" xref="S3.Ex9.m1.1.1.1.1">superscript</csymbol><ci id="S3.Ex9.m1.1.1.1.1.1.2.cmml" xref="S3.Ex9.m1.1.1.1.1.1.2">𝑣</ci><ci id="S3.Ex9.m1.1.1.1.1.1.3.cmml" xref="S3.Ex9.m1.1.1.1.1.1.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex9.m1.1c">\displaystyle q_{I}(v^{\prime})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex9.m2.2" class="ltx_Math" alttext="\displaystyle=q(\alpha|T)q_{\theta}(T)" display="inline"><semantics id="S3.Ex9.m2.2a"><mrow id="S3.Ex9.m2.2.2" xref="S3.Ex9.m2.2.2.cmml"><mi id="S3.Ex9.m2.2.2.3" xref="S3.Ex9.m2.2.2.3.cmml"></mi><mo id="S3.Ex9.m2.2.2.2" xref="S3.Ex9.m2.2.2.2.cmml">=</mo><mrow id="S3.Ex9.m2.2.2.1" xref="S3.Ex9.m2.2.2.1.cmml"><mi id="S3.Ex9.m2.2.2.1.3" xref="S3.Ex9.m2.2.2.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.Ex9.m2.2.2.1.2" xref="S3.Ex9.m2.2.2.1.2.cmml">​</mo><mrow id="S3.Ex9.m2.2.2.1.1.1" xref="S3.Ex9.m2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex9.m2.2.2.1.1.1.2" xref="S3.Ex9.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.Ex9.m2.2.2.1.1.1.1" xref="S3.Ex9.m2.2.2.1.1.1.1.cmml"><mi id="S3.Ex9.m2.2.2.1.1.1.1.2" xref="S3.Ex9.m2.2.2.1.1.1.1.2.cmml">α</mi><mo fence="false" id="S3.Ex9.m2.2.2.1.1.1.1.1" xref="S3.Ex9.m2.2.2.1.1.1.1.1.cmml">|</mo><mi id="S3.Ex9.m2.2.2.1.1.1.1.3" xref="S3.Ex9.m2.2.2.1.1.1.1.3.cmml">T</mi></mrow><mo stretchy="false" id="S3.Ex9.m2.2.2.1.1.1.3" xref="S3.Ex9.m2.2.2.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex9.m2.2.2.1.2a" xref="S3.Ex9.m2.2.2.1.2.cmml">​</mo><msub id="S3.Ex9.m2.2.2.1.4" xref="S3.Ex9.m2.2.2.1.4.cmml"><mi id="S3.Ex9.m2.2.2.1.4.2" xref="S3.Ex9.m2.2.2.1.4.2.cmml">q</mi><mi id="S3.Ex9.m2.2.2.1.4.3" xref="S3.Ex9.m2.2.2.1.4.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex9.m2.2.2.1.2b" xref="S3.Ex9.m2.2.2.1.2.cmml">​</mo><mrow id="S3.Ex9.m2.2.2.1.5.2" xref="S3.Ex9.m2.2.2.1.cmml"><mo stretchy="false" id="S3.Ex9.m2.2.2.1.5.2.1" xref="S3.Ex9.m2.2.2.1.cmml">(</mo><mi id="S3.Ex9.m2.1.1" xref="S3.Ex9.m2.1.1.cmml">T</mi><mo stretchy="false" id="S3.Ex9.m2.2.2.1.5.2.2" xref="S3.Ex9.m2.2.2.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex9.m2.2b"><apply id="S3.Ex9.m2.2.2.cmml" xref="S3.Ex9.m2.2.2"><eq id="S3.Ex9.m2.2.2.2.cmml" xref="S3.Ex9.m2.2.2.2"></eq><csymbol cd="latexml" id="S3.Ex9.m2.2.2.3.cmml" xref="S3.Ex9.m2.2.2.3">absent</csymbol><apply id="S3.Ex9.m2.2.2.1.cmml" xref="S3.Ex9.m2.2.2.1"><times id="S3.Ex9.m2.2.2.1.2.cmml" xref="S3.Ex9.m2.2.2.1.2"></times><ci id="S3.Ex9.m2.2.2.1.3.cmml" xref="S3.Ex9.m2.2.2.1.3">𝑞</ci><apply id="S3.Ex9.m2.2.2.1.1.1.1.cmml" xref="S3.Ex9.m2.2.2.1.1.1"><csymbol cd="latexml" id="S3.Ex9.m2.2.2.1.1.1.1.1.cmml" xref="S3.Ex9.m2.2.2.1.1.1.1.1">conditional</csymbol><ci id="S3.Ex9.m2.2.2.1.1.1.1.2.cmml" xref="S3.Ex9.m2.2.2.1.1.1.1.2">𝛼</ci><ci id="S3.Ex9.m2.2.2.1.1.1.1.3.cmml" xref="S3.Ex9.m2.2.2.1.1.1.1.3">𝑇</ci></apply><apply id="S3.Ex9.m2.2.2.1.4.cmml" xref="S3.Ex9.m2.2.2.1.4"><csymbol cd="ambiguous" id="S3.Ex9.m2.2.2.1.4.1.cmml" xref="S3.Ex9.m2.2.2.1.4">subscript</csymbol><ci id="S3.Ex9.m2.2.2.1.4.2.cmml" xref="S3.Ex9.m2.2.2.1.4.2">𝑞</ci><ci id="S3.Ex9.m2.2.2.1.4.3.cmml" xref="S3.Ex9.m2.2.2.1.4.3">𝜃</ci></apply><ci id="S3.Ex9.m2.1.1.cmml" xref="S3.Ex9.m2.1.1">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex9.m2.2c">\displaystyle=q(\alpha|T)q_{\theta}(T)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p5.6" class="ltx_p">We find that this still has enough modeling capacity, since there are only finitely many scene graphs of a maximum
length <math id="S3.SS3.p5.6.m1.1" class="ltx_Math" alttext="T_{max}" display="inline"><semantics id="S3.SS3.p5.6.m1.1a"><msub id="S3.SS3.p5.6.m1.1.1" xref="S3.SS3.p5.6.m1.1.1.cmml"><mi id="S3.SS3.p5.6.m1.1.1.2" xref="S3.SS3.p5.6.m1.1.1.2.cmml">T</mi><mrow id="S3.SS3.p5.6.m1.1.1.3" xref="S3.SS3.p5.6.m1.1.1.3.cmml"><mi id="S3.SS3.p5.6.m1.1.1.3.2" xref="S3.SS3.p5.6.m1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.6.m1.1.1.3.1" xref="S3.SS3.p5.6.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p5.6.m1.1.1.3.3" xref="S3.SS3.p5.6.m1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.6.m1.1.1.3.1a" xref="S3.SS3.p5.6.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p5.6.m1.1.1.3.4" xref="S3.SS3.p5.6.m1.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.6.m1.1b"><apply id="S3.SS3.p5.6.m1.1.1.cmml" xref="S3.SS3.p5.6.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.6.m1.1.1.1.cmml" xref="S3.SS3.p5.6.m1.1.1">subscript</csymbol><ci id="S3.SS3.p5.6.m1.1.1.2.cmml" xref="S3.SS3.p5.6.m1.1.1.2">𝑇</ci><apply id="S3.SS3.p5.6.m1.1.1.3.cmml" xref="S3.SS3.p5.6.m1.1.1.3"><times id="S3.SS3.p5.6.m1.1.1.3.1.cmml" xref="S3.SS3.p5.6.m1.1.1.3.1"></times><ci id="S3.SS3.p5.6.m1.1.1.3.2.cmml" xref="S3.SS3.p5.6.m1.1.1.3.2">𝑚</ci><ci id="S3.SS3.p5.6.m1.1.1.3.3.cmml" xref="S3.SS3.p5.6.m1.1.1.3.3">𝑎</ci><ci id="S3.SS3.p5.6.m1.1.1.3.4.cmml" xref="S3.SS3.p5.6.m1.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.6.m1.1c">T_{max}</annotation></semantics></math> that can be sampled from the grammar. Empirically, we find using one latent vector to be enough in our
experiments. Essentially, stochasticity in the rule sampling makes up for lost stochasticity in the latent space.</p>
</div>
<div id="S3.SS3.p6" class="ltx_para ltx_noindent">
<p id="S3.SS3.p6.1" class="ltx_p"><span id="S3.SS3.p6.1.1" class="ltx_text ltx_font_bold">Pretraining</span> is an essential step for our method. In every experiment, we define a simple handcrafted
prior on scene structure. For example, a simple prior could be to put one car on one road in a driving
scene. We pre-train the model by sampling strings (scene graphs) from the grammar prior, and training
the model to maximize the log-likelihood of these scene graphs. We provide specific details about the priors
used in Sec <a href="#S4" title="4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S3.SS3.p7" class="ltx_para ltx_noindent">
<p id="S3.SS3.p7.1" class="ltx_p"><span id="S3.SS3.p7.1.1" class="ltx_text ltx_font_bold">Feature Extraction</span> for distribution matching is a crucial step since
the features need to capture structural scene information such as the number of objects and their contextual spatial relationships for effective training.
We describe the feature extractor used and its training for each experiment in
Sec <a href="#S4" title="4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S3.SS3.p8" class="ltx_para ltx_noindent">
<p id="S3.SS3.p8.9" class="ltx_p"><span id="S3.SS3.p8.9.1" class="ltx_text ltx_font_bold">Ensuring termination:</span> During training, sampling can result in incomplete strings generated with at most <math id="S3.SS3.p8.1.m1.1" class="ltx_Math" alttext="T_{\text{max}}" display="inline"><semantics id="S3.SS3.p8.1.m1.1a"><msub id="S3.SS3.p8.1.m1.1.1" xref="S3.SS3.p8.1.m1.1.1.cmml"><mi id="S3.SS3.p8.1.m1.1.1.2" xref="S3.SS3.p8.1.m1.1.1.2.cmml">T</mi><mtext id="S3.SS3.p8.1.m1.1.1.3" xref="S3.SS3.p8.1.m1.1.1.3a.cmml">max</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.1.m1.1b"><apply id="S3.SS3.p8.1.m1.1.1.cmml" xref="S3.SS3.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p8.1.m1.1.1.1.cmml" xref="S3.SS3.p8.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p8.1.m1.1.1.2.cmml" xref="S3.SS3.p8.1.m1.1.1.2">𝑇</ci><ci id="S3.SS3.p8.1.m1.1.1.3a.cmml" xref="S3.SS3.p8.1.m1.1.1.3"><mtext mathsize="70%" id="S3.SS3.p8.1.m1.1.1.3.cmml" xref="S3.SS3.p8.1.m1.1.1.3">max</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.1.m1.1c">T_{\text{max}}</annotation></semantics></math> steps. Thus, we repeately sample a scene graph <math id="S3.SS3.p8.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS3.p8.2.m2.1a"><mi id="S3.SS3.p8.2.m2.1.1" xref="S3.SS3.p8.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.2.m2.1b"><ci id="S3.SS3.p8.2.m2.1.1.cmml" xref="S3.SS3.p8.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.2.m2.1c">T</annotation></semantics></math> until its length is at most <math id="S3.SS3.p8.3.m3.1" class="ltx_Math" alttext="T_{\text{max}}" display="inline"><semantics id="S3.SS3.p8.3.m3.1a"><msub id="S3.SS3.p8.3.m3.1.1" xref="S3.SS3.p8.3.m3.1.1.cmml"><mi id="S3.SS3.p8.3.m3.1.1.2" xref="S3.SS3.p8.3.m3.1.1.2.cmml">T</mi><mtext id="S3.SS3.p8.3.m3.1.1.3" xref="S3.SS3.p8.3.m3.1.1.3a.cmml">max</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.3.m3.1b"><apply id="S3.SS3.p8.3.m3.1.1.cmml" xref="S3.SS3.p8.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p8.3.m3.1.1.1.cmml" xref="S3.SS3.p8.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p8.3.m3.1.1.2.cmml" xref="S3.SS3.p8.3.m3.1.1.2">𝑇</ci><ci id="S3.SS3.p8.3.m3.1.1.3a.cmml" xref="S3.SS3.p8.3.m3.1.1.3"><mtext mathsize="70%" id="S3.SS3.p8.3.m3.1.1.3.cmml" xref="S3.SS3.p8.3.m3.1.1.3">max</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.3.m3.1c">T_{\text{max}}</annotation></semantics></math>. To ensure that we do not require too many attempts, we record the rejection rate <math id="S3.SS3.p8.4.m4.1" class="ltx_Math" alttext="r_{\text{reject}}(F)" display="inline"><semantics id="S3.SS3.p8.4.m4.1a"><mrow id="S3.SS3.p8.4.m4.1.2" xref="S3.SS3.p8.4.m4.1.2.cmml"><msub id="S3.SS3.p8.4.m4.1.2.2" xref="S3.SS3.p8.4.m4.1.2.2.cmml"><mi id="S3.SS3.p8.4.m4.1.2.2.2" xref="S3.SS3.p8.4.m4.1.2.2.2.cmml">r</mi><mtext id="S3.SS3.p8.4.m4.1.2.2.3" xref="S3.SS3.p8.4.m4.1.2.2.3a.cmml">reject</mtext></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p8.4.m4.1.2.1" xref="S3.SS3.p8.4.m4.1.2.1.cmml">​</mo><mrow id="S3.SS3.p8.4.m4.1.2.3.2" xref="S3.SS3.p8.4.m4.1.2.cmml"><mo stretchy="false" id="S3.SS3.p8.4.m4.1.2.3.2.1" xref="S3.SS3.p8.4.m4.1.2.cmml">(</mo><mi id="S3.SS3.p8.4.m4.1.1" xref="S3.SS3.p8.4.m4.1.1.cmml">F</mi><mo stretchy="false" id="S3.SS3.p8.4.m4.1.2.3.2.2" xref="S3.SS3.p8.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.4.m4.1b"><apply id="S3.SS3.p8.4.m4.1.2.cmml" xref="S3.SS3.p8.4.m4.1.2"><times id="S3.SS3.p8.4.m4.1.2.1.cmml" xref="S3.SS3.p8.4.m4.1.2.1"></times><apply id="S3.SS3.p8.4.m4.1.2.2.cmml" xref="S3.SS3.p8.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p8.4.m4.1.2.2.1.cmml" xref="S3.SS3.p8.4.m4.1.2.2">subscript</csymbol><ci id="S3.SS3.p8.4.m4.1.2.2.2.cmml" xref="S3.SS3.p8.4.m4.1.2.2.2">𝑟</ci><ci id="S3.SS3.p8.4.m4.1.2.2.3a.cmml" xref="S3.SS3.p8.4.m4.1.2.2.3"><mtext mathsize="70%" id="S3.SS3.p8.4.m4.1.2.2.3.cmml" xref="S3.SS3.p8.4.m4.1.2.2.3">reject</mtext></ci></apply><ci id="S3.SS3.p8.4.m4.1.1.cmml" xref="S3.SS3.p8.4.m4.1.1">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.4.m4.1c">r_{\text{reject}}(F)</annotation></semantics></math> of a sampled feature <math id="S3.SS3.p8.5.m5.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S3.SS3.p8.5.m5.1a"><mi id="S3.SS3.p8.5.m5.1.1" xref="S3.SS3.p8.5.m5.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.5.m5.1b"><ci id="S3.SS3.p8.5.m5.1.1.cmml" xref="S3.SS3.p8.5.m5.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.5.m5.1c">F</annotation></semantics></math> as the average failed sampling attempts when sampling the single scene graph used to generate <math id="S3.SS3.p8.6.m6.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S3.SS3.p8.6.m6.1a"><mi id="S3.SS3.p8.6.m6.1.1" xref="S3.SS3.p8.6.m6.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.6.m6.1b"><ci id="S3.SS3.p8.6.m6.1.1.cmml" xref="S3.SS3.p8.6.m6.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.6.m6.1c">F</annotation></semantics></math>. We set a threshold <math id="S3.SS3.p8.7.m7.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S3.SS3.p8.7.m7.1a"><mi id="S3.SS3.p8.7.m7.1.1" xref="S3.SS3.p8.7.m7.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.7.m7.1b"><ci id="S3.SS3.p8.7.m7.1.1.cmml" xref="S3.SS3.p8.7.m7.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.7.m7.1c">\epsilon</annotation></semantics></math> on <math id="S3.SS3.p8.8.m8.1" class="ltx_Math" alttext="r_{\text{reject}}(F)" display="inline"><semantics id="S3.SS3.p8.8.m8.1a"><mrow id="S3.SS3.p8.8.m8.1.2" xref="S3.SS3.p8.8.m8.1.2.cmml"><msub id="S3.SS3.p8.8.m8.1.2.2" xref="S3.SS3.p8.8.m8.1.2.2.cmml"><mi id="S3.SS3.p8.8.m8.1.2.2.2" xref="S3.SS3.p8.8.m8.1.2.2.2.cmml">r</mi><mtext id="S3.SS3.p8.8.m8.1.2.2.3" xref="S3.SS3.p8.8.m8.1.2.2.3a.cmml">reject</mtext></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p8.8.m8.1.2.1" xref="S3.SS3.p8.8.m8.1.2.1.cmml">​</mo><mrow id="S3.SS3.p8.8.m8.1.2.3.2" xref="S3.SS3.p8.8.m8.1.2.cmml"><mo stretchy="false" id="S3.SS3.p8.8.m8.1.2.3.2.1" xref="S3.SS3.p8.8.m8.1.2.cmml">(</mo><mi id="S3.SS3.p8.8.m8.1.1" xref="S3.SS3.p8.8.m8.1.1.cmml">F</mi><mo stretchy="false" id="S3.SS3.p8.8.m8.1.2.3.2.2" xref="S3.SS3.p8.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.8.m8.1b"><apply id="S3.SS3.p8.8.m8.1.2.cmml" xref="S3.SS3.p8.8.m8.1.2"><times id="S3.SS3.p8.8.m8.1.2.1.cmml" xref="S3.SS3.p8.8.m8.1.2.1"></times><apply id="S3.SS3.p8.8.m8.1.2.2.cmml" xref="S3.SS3.p8.8.m8.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p8.8.m8.1.2.2.1.cmml" xref="S3.SS3.p8.8.m8.1.2.2">subscript</csymbol><ci id="S3.SS3.p8.8.m8.1.2.2.2.cmml" xref="S3.SS3.p8.8.m8.1.2.2.2">𝑟</ci><ci id="S3.SS3.p8.8.m8.1.2.2.3a.cmml" xref="S3.SS3.p8.8.m8.1.2.2.3"><mtext mathsize="70%" id="S3.SS3.p8.8.m8.1.2.2.3.cmml" xref="S3.SS3.p8.8.m8.1.2.2.3">reject</mtext></ci></apply><ci id="S3.SS3.p8.8.m8.1.1.cmml" xref="S3.SS3.p8.8.m8.1.1">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.8.m8.1c">r_{\text{reject}}(F)</annotation></semantics></math> (representing the maximum allowable rejections) and weight <math id="S3.SS3.p8.9.m9.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS3.p8.9.m9.1a"><mi id="S3.SS3.p8.9.m9.1.1" xref="S3.SS3.p8.9.m9.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.9.m9.1b"><ci id="S3.SS3.p8.9.m9.1.1.cmml" xref="S3.SS3.p8.9.m9.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.9.m9.1c">\lambda</annotation></semantics></math> and add it to our original loss as,</p>
<table id="S6.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex10.m1.6" class="ltx_Math" alttext="\displaystyle\mathcal{L}^{\prime}=\mathbb{E}_{F\sim q_{F}}[\log q_{f}(F)-\log p_{f}(F)+\lambda\mathbf{1}_{(\epsilon,\infty)}(r_{\text{reject}}(F))]" display="inline"><semantics id="S3.Ex10.m1.6a"><mrow id="S3.Ex10.m1.6.6" xref="S3.Ex10.m1.6.6.cmml"><msup id="S3.Ex10.m1.6.6.3" xref="S3.Ex10.m1.6.6.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex10.m1.6.6.3.2" xref="S3.Ex10.m1.6.6.3.2.cmml">ℒ</mi><mo id="S3.Ex10.m1.6.6.3.3" xref="S3.Ex10.m1.6.6.3.3.cmml">′</mo></msup><mo id="S3.Ex10.m1.6.6.2" xref="S3.Ex10.m1.6.6.2.cmml">=</mo><mrow id="S3.Ex10.m1.6.6.1" xref="S3.Ex10.m1.6.6.1.cmml"><msub id="S3.Ex10.m1.6.6.1.3" xref="S3.Ex10.m1.6.6.1.3.cmml"><mi id="S3.Ex10.m1.6.6.1.3.2" xref="S3.Ex10.m1.6.6.1.3.2.cmml">𝔼</mi><mrow id="S3.Ex10.m1.6.6.1.3.3" xref="S3.Ex10.m1.6.6.1.3.3.cmml"><mi id="S3.Ex10.m1.6.6.1.3.3.2" xref="S3.Ex10.m1.6.6.1.3.3.2.cmml">F</mi><mo id="S3.Ex10.m1.6.6.1.3.3.1" xref="S3.Ex10.m1.6.6.1.3.3.1.cmml">∼</mo><msub id="S3.Ex10.m1.6.6.1.3.3.3" xref="S3.Ex10.m1.6.6.1.3.3.3.cmml"><mi id="S3.Ex10.m1.6.6.1.3.3.3.2" xref="S3.Ex10.m1.6.6.1.3.3.3.2.cmml">q</mi><mi id="S3.Ex10.m1.6.6.1.3.3.3.3" xref="S3.Ex10.m1.6.6.1.3.3.3.3.cmml">F</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex10.m1.6.6.1.2" xref="S3.Ex10.m1.6.6.1.2.cmml">​</mo><mrow id="S3.Ex10.m1.6.6.1.1.1" xref="S3.Ex10.m1.6.6.1.1.2.cmml"><mo stretchy="false" id="S3.Ex10.m1.6.6.1.1.1.2" xref="S3.Ex10.m1.6.6.1.1.2.1.cmml">[</mo><mrow id="S3.Ex10.m1.6.6.1.1.1.1" xref="S3.Ex10.m1.6.6.1.1.1.1.cmml"><mrow id="S3.Ex10.m1.6.6.1.1.1.1.3" xref="S3.Ex10.m1.6.6.1.1.1.1.3.cmml"><mrow id="S3.Ex10.m1.6.6.1.1.1.1.3.2" xref="S3.Ex10.m1.6.6.1.1.1.1.3.2.cmml"><mrow id="S3.Ex10.m1.6.6.1.1.1.1.3.2.2" xref="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.cmml"><mi id="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.1" xref="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.1.cmml">log</mi><mo lspace="0.167em" id="S3.Ex10.m1.6.6.1.1.1.1.3.2.2a" xref="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.cmml">⁡</mo><msub id="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.2" xref="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.2.cmml"><mi id="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.2.2" xref="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.2.2.cmml">q</mi><mi id="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.2.3" xref="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.2.3.cmml">f</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.Ex10.m1.6.6.1.1.1.1.3.2.1" xref="S3.Ex10.m1.6.6.1.1.1.1.3.2.1.cmml">​</mo><mrow id="S3.Ex10.m1.6.6.1.1.1.1.3.2.3.2" xref="S3.Ex10.m1.6.6.1.1.1.1.3.2.cmml"><mo stretchy="false" id="S3.Ex10.m1.6.6.1.1.1.1.3.2.3.2.1" xref="S3.Ex10.m1.6.6.1.1.1.1.3.2.cmml">(</mo><mi id="S3.Ex10.m1.3.3" xref="S3.Ex10.m1.3.3.cmml">F</mi><mo stretchy="false" id="S3.Ex10.m1.6.6.1.1.1.1.3.2.3.2.2" xref="S3.Ex10.m1.6.6.1.1.1.1.3.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex10.m1.6.6.1.1.1.1.3.1" xref="S3.Ex10.m1.6.6.1.1.1.1.3.1.cmml">−</mo><mrow id="S3.Ex10.m1.6.6.1.1.1.1.3.3" xref="S3.Ex10.m1.6.6.1.1.1.1.3.3.cmml"><mrow id="S3.Ex10.m1.6.6.1.1.1.1.3.3.2" xref="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.cmml"><mi id="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.1" xref="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S3.Ex10.m1.6.6.1.1.1.1.3.3.2a" xref="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.cmml">⁡</mo><msub id="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.2" xref="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.2.cmml"><mi id="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.2.2" xref="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.2.2.cmml">p</mi><mi id="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.2.3" xref="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.2.3.cmml">f</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.Ex10.m1.6.6.1.1.1.1.3.3.1" xref="S3.Ex10.m1.6.6.1.1.1.1.3.3.1.cmml">​</mo><mrow id="S3.Ex10.m1.6.6.1.1.1.1.3.3.3.2" xref="S3.Ex10.m1.6.6.1.1.1.1.3.3.cmml"><mo stretchy="false" id="S3.Ex10.m1.6.6.1.1.1.1.3.3.3.2.1" xref="S3.Ex10.m1.6.6.1.1.1.1.3.3.cmml">(</mo><mi id="S3.Ex10.m1.4.4" xref="S3.Ex10.m1.4.4.cmml">F</mi><mo stretchy="false" id="S3.Ex10.m1.6.6.1.1.1.1.3.3.3.2.2" xref="S3.Ex10.m1.6.6.1.1.1.1.3.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex10.m1.6.6.1.1.1.1.2" xref="S3.Ex10.m1.6.6.1.1.1.1.2.cmml">+</mo><mrow id="S3.Ex10.m1.6.6.1.1.1.1.1" xref="S3.Ex10.m1.6.6.1.1.1.1.1.cmml"><mi id="S3.Ex10.m1.6.6.1.1.1.1.1.3" xref="S3.Ex10.m1.6.6.1.1.1.1.1.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.Ex10.m1.6.6.1.1.1.1.1.2" xref="S3.Ex10.m1.6.6.1.1.1.1.1.2.cmml">​</mo><msub id="S3.Ex10.m1.6.6.1.1.1.1.1.4" xref="S3.Ex10.m1.6.6.1.1.1.1.1.4.cmml"><mn id="S3.Ex10.m1.6.6.1.1.1.1.1.4.2" xref="S3.Ex10.m1.6.6.1.1.1.1.1.4.2.cmml">𝟏</mn><mrow id="S3.Ex10.m1.2.2.2.4" xref="S3.Ex10.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.Ex10.m1.2.2.2.4.1" xref="S3.Ex10.m1.2.2.2.3.cmml">(</mo><mi id="S3.Ex10.m1.1.1.1.1" xref="S3.Ex10.m1.1.1.1.1.cmml">ϵ</mi><mo id="S3.Ex10.m1.2.2.2.4.2" xref="S3.Ex10.m1.2.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.Ex10.m1.2.2.2.2" xref="S3.Ex10.m1.2.2.2.2.cmml">∞</mi><mo stretchy="false" id="S3.Ex10.m1.2.2.2.4.3" xref="S3.Ex10.m1.2.2.2.3.cmml">)</mo></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex10.m1.6.6.1.1.1.1.1.2a" xref="S3.Ex10.m1.6.6.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex10.m1.6.6.1.1.1.1.1.1.1" xref="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.2" xref="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1" xref="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.2" xref="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.2.2.cmml">r</mi><mtext id="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.2.3a.cmml">reject</mtext></msub><mo lspace="0em" rspace="0em" id="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.3.2.1" xref="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex10.m1.5.5" xref="S3.Ex10.m1.5.5.cmml">F</mi><mo stretchy="false" id="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.3.2.2" xref="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.3" xref="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.Ex10.m1.6.6.1.1.1.3" xref="S3.Ex10.m1.6.6.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex10.m1.6b"><apply id="S3.Ex10.m1.6.6.cmml" xref="S3.Ex10.m1.6.6"><eq id="S3.Ex10.m1.6.6.2.cmml" xref="S3.Ex10.m1.6.6.2"></eq><apply id="S3.Ex10.m1.6.6.3.cmml" xref="S3.Ex10.m1.6.6.3"><csymbol cd="ambiguous" id="S3.Ex10.m1.6.6.3.1.cmml" xref="S3.Ex10.m1.6.6.3">superscript</csymbol><ci id="S3.Ex10.m1.6.6.3.2.cmml" xref="S3.Ex10.m1.6.6.3.2">ℒ</ci><ci id="S3.Ex10.m1.6.6.3.3.cmml" xref="S3.Ex10.m1.6.6.3.3">′</ci></apply><apply id="S3.Ex10.m1.6.6.1.cmml" xref="S3.Ex10.m1.6.6.1"><times id="S3.Ex10.m1.6.6.1.2.cmml" xref="S3.Ex10.m1.6.6.1.2"></times><apply id="S3.Ex10.m1.6.6.1.3.cmml" xref="S3.Ex10.m1.6.6.1.3"><csymbol cd="ambiguous" id="S3.Ex10.m1.6.6.1.3.1.cmml" xref="S3.Ex10.m1.6.6.1.3">subscript</csymbol><ci id="S3.Ex10.m1.6.6.1.3.2.cmml" xref="S3.Ex10.m1.6.6.1.3.2">𝔼</ci><apply id="S3.Ex10.m1.6.6.1.3.3.cmml" xref="S3.Ex10.m1.6.6.1.3.3"><csymbol cd="latexml" id="S3.Ex10.m1.6.6.1.3.3.1.cmml" xref="S3.Ex10.m1.6.6.1.3.3.1">similar-to</csymbol><ci id="S3.Ex10.m1.6.6.1.3.3.2.cmml" xref="S3.Ex10.m1.6.6.1.3.3.2">𝐹</ci><apply id="S3.Ex10.m1.6.6.1.3.3.3.cmml" xref="S3.Ex10.m1.6.6.1.3.3.3"><csymbol cd="ambiguous" id="S3.Ex10.m1.6.6.1.3.3.3.1.cmml" xref="S3.Ex10.m1.6.6.1.3.3.3">subscript</csymbol><ci id="S3.Ex10.m1.6.6.1.3.3.3.2.cmml" xref="S3.Ex10.m1.6.6.1.3.3.3.2">𝑞</ci><ci id="S3.Ex10.m1.6.6.1.3.3.3.3.cmml" xref="S3.Ex10.m1.6.6.1.3.3.3.3">𝐹</ci></apply></apply></apply><apply id="S3.Ex10.m1.6.6.1.1.2.cmml" xref="S3.Ex10.m1.6.6.1.1.1"><csymbol cd="latexml" id="S3.Ex10.m1.6.6.1.1.2.1.cmml" xref="S3.Ex10.m1.6.6.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex10.m1.6.6.1.1.1.1.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1"><plus id="S3.Ex10.m1.6.6.1.1.1.1.2.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.2"></plus><apply id="S3.Ex10.m1.6.6.1.1.1.1.3.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.3"><minus id="S3.Ex10.m1.6.6.1.1.1.1.3.1.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.3.1"></minus><apply id="S3.Ex10.m1.6.6.1.1.1.1.3.2.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.3.2"><times id="S3.Ex10.m1.6.6.1.1.1.1.3.2.1.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.3.2.1"></times><apply id="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.3.2.2"><log id="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.1.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.1"></log><apply id="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.2.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.2.1.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.2.2.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.2.2">𝑞</ci><ci id="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.2.3.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.3.2.2.2.3">𝑓</ci></apply></apply><ci id="S3.Ex10.m1.3.3.cmml" xref="S3.Ex10.m1.3.3">𝐹</ci></apply><apply id="S3.Ex10.m1.6.6.1.1.1.1.3.3.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.3.3"><times id="S3.Ex10.m1.6.6.1.1.1.1.3.3.1.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.3.3.1"></times><apply id="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.3.3.2"><log id="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.1.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.1"></log><apply id="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.2.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.2.1.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.2">subscript</csymbol><ci id="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.2.2.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.2.2">𝑝</ci><ci id="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.2.3.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.3.3.2.2.3">𝑓</ci></apply></apply><ci id="S3.Ex10.m1.4.4.cmml" xref="S3.Ex10.m1.4.4">𝐹</ci></apply></apply><apply id="S3.Ex10.m1.6.6.1.1.1.1.1.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.1"><times id="S3.Ex10.m1.6.6.1.1.1.1.1.2.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.1.2"></times><ci id="S3.Ex10.m1.6.6.1.1.1.1.1.3.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.1.3">𝜆</ci><apply id="S3.Ex10.m1.6.6.1.1.1.1.1.4.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.Ex10.m1.6.6.1.1.1.1.1.4.1.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.1.4">subscript</csymbol><cn type="integer" id="S3.Ex10.m1.6.6.1.1.1.1.1.4.2.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.1.4.2">1</cn><interval closure="open" id="S3.Ex10.m1.2.2.2.3.cmml" xref="S3.Ex10.m1.2.2.2.4"><ci id="S3.Ex10.m1.1.1.1.1.cmml" xref="S3.Ex10.m1.1.1.1.1">italic-ϵ</ci><infinity id="S3.Ex10.m1.2.2.2.2.cmml" xref="S3.Ex10.m1.2.2.2.2"></infinity></interval></apply><apply id="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.1.1.1"><times id="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.1"></times><apply id="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.2.2">𝑟</ci><ci id="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex10.m1.6.6.1.1.1.1.1.1.1.1.2.3">reject</mtext></ci></apply><ci id="S3.Ex10.m1.5.5.cmml" xref="S3.Ex10.m1.5.5">𝐹</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex10.m1.6c">\displaystyle\mathcal{L}^{\prime}=\mathbb{E}_{F\sim q_{F}}[\log q_{f}(F)-\log p_{f}(F)+\lambda\mathbf{1}_{(\epsilon,\infty)}(r_{\text{reject}}(F))]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p8.11" class="ltx_p">We found that <math id="S3.SS3.p8.10.m1.1" class="ltx_Math" alttext="\lambda=10^{-2}" display="inline"><semantics id="S3.SS3.p8.10.m1.1a"><mrow id="S3.SS3.p8.10.m1.1.1" xref="S3.SS3.p8.10.m1.1.1.cmml"><mi id="S3.SS3.p8.10.m1.1.1.2" xref="S3.SS3.p8.10.m1.1.1.2.cmml">λ</mi><mo id="S3.SS3.p8.10.m1.1.1.1" xref="S3.SS3.p8.10.m1.1.1.1.cmml">=</mo><msup id="S3.SS3.p8.10.m1.1.1.3" xref="S3.SS3.p8.10.m1.1.1.3.cmml"><mn id="S3.SS3.p8.10.m1.1.1.3.2" xref="S3.SS3.p8.10.m1.1.1.3.2.cmml">10</mn><mrow id="S3.SS3.p8.10.m1.1.1.3.3" xref="S3.SS3.p8.10.m1.1.1.3.3.cmml"><mo id="S3.SS3.p8.10.m1.1.1.3.3a" xref="S3.SS3.p8.10.m1.1.1.3.3.cmml">−</mo><mn id="S3.SS3.p8.10.m1.1.1.3.3.2" xref="S3.SS3.p8.10.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.10.m1.1b"><apply id="S3.SS3.p8.10.m1.1.1.cmml" xref="S3.SS3.p8.10.m1.1.1"><eq id="S3.SS3.p8.10.m1.1.1.1.cmml" xref="S3.SS3.p8.10.m1.1.1.1"></eq><ci id="S3.SS3.p8.10.m1.1.1.2.cmml" xref="S3.SS3.p8.10.m1.1.1.2">𝜆</ci><apply id="S3.SS3.p8.10.m1.1.1.3.cmml" xref="S3.SS3.p8.10.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p8.10.m1.1.1.3.1.cmml" xref="S3.SS3.p8.10.m1.1.1.3">superscript</csymbol><cn type="integer" id="S3.SS3.p8.10.m1.1.1.3.2.cmml" xref="S3.SS3.p8.10.m1.1.1.3.2">10</cn><apply id="S3.SS3.p8.10.m1.1.1.3.3.cmml" xref="S3.SS3.p8.10.m1.1.1.3.3"><minus id="S3.SS3.p8.10.m1.1.1.3.3.1.cmml" xref="S3.SS3.p8.10.m1.1.1.3.3"></minus><cn type="integer" id="S3.SS3.p8.10.m1.1.1.3.3.2.cmml" xref="S3.SS3.p8.10.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.10.m1.1c">\lambda=10^{-2}</annotation></semantics></math> and <math id="S3.SS3.p8.11.m2.1" class="ltx_Math" alttext="\epsilon=1" display="inline"><semantics id="S3.SS3.p8.11.m2.1a"><mrow id="S3.SS3.p8.11.m2.1.1" xref="S3.SS3.p8.11.m2.1.1.cmml"><mi id="S3.SS3.p8.11.m2.1.1.2" xref="S3.SS3.p8.11.m2.1.1.2.cmml">ϵ</mi><mo id="S3.SS3.p8.11.m2.1.1.1" xref="S3.SS3.p8.11.m2.1.1.1.cmml">=</mo><mn id="S3.SS3.p8.11.m2.1.1.3" xref="S3.SS3.p8.11.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.11.m2.1b"><apply id="S3.SS3.p8.11.m2.1.1.cmml" xref="S3.SS3.p8.11.m2.1.1"><eq id="S3.SS3.p8.11.m2.1.1.1.cmml" xref="S3.SS3.p8.11.m2.1.1.1"></eq><ci id="S3.SS3.p8.11.m2.1.1.2.cmml" xref="S3.SS3.p8.11.m2.1.1.2">italic-ϵ</ci><cn type="integer" id="S3.SS3.p8.11.m2.1.1.3.cmml" xref="S3.SS3.p8.11.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.11.m2.1c">\epsilon=1</annotation></semantics></math> worked well for all of our experiments.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p">We show two controlled experiments, on the MNIST dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> (Sec. <a href="#S4.SS1" title="4.1 Multi MNIST ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>) and on synthetic aerial imagery <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> (Sec. <a href="#S4.SS2" title="4.2 Aerial 2D ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>), where we showcase the ability of our model to learn synthetic structure distributions <span id="S4.p1.1.1" class="ltx_text ltx_font_bold">unsupervised</span>. Finally, we show an experiment on generating 3D driving scenes (Sec. <a href="#S4.SS3" title="4.3 3D Driving Scenes ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>), mimicking structure distributions on the KITTI <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> driving dataset and showing the performance of an object detector trained on our generated data. The renderers used in each experiment are adapted from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>.
For each experiment, we first dicuss the corresponding scene grammar. Then, we discuss the feature extractor and its training. Finally, we describe the structure prior used to pre-train the model, the target data, and show results on learning to mimic structures in the target data without any access to ground-truth structures. Additionally, we show comparisons with learning with MMD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> (Sec. <a href="#S4.SS1" title="4.1 Multi MNIST ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>) and show how our model can learn to generate context-dependent scene graphs from the grammar (Sec. <a href="#S4.SS2" title="4.2 Aerial 2D ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>).</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Multi MNIST</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.2" class="ltx_p">We first evaluate our approach on a toy example of learning to generate scenes with multiple digits. The grammar defining the scene structure is:</p>
<table id="S6.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.Ex11.m1.6" class="ltx_Math" alttext="\displaystyle\text{Scene}\to bg\ \text{Digits},\quad\text{Digits}\to\text{Digit}\ \text{Digits}\ |\ \epsilon,\quad\text{Digit}\to 0\ |\ 1\ |\ 2\ |\ \cdots\ |\ 9" display="inline"><semantics id="S4.Ex11.m1.6a"><mrow id="S4.Ex11.m1.6.6.2" xref="S4.Ex11.m1.6.6.3.cmml"><mrow id="S4.Ex11.m1.5.5.1.1" xref="S4.Ex11.m1.5.5.1.1.cmml"><mtext id="S4.Ex11.m1.5.5.1.1.2" xref="S4.Ex11.m1.5.5.1.1.2a.cmml">Scene</mtext><mo stretchy="false" id="S4.Ex11.m1.5.5.1.1.1" xref="S4.Ex11.m1.5.5.1.1.1.cmml">→</mo><mrow id="S4.Ex11.m1.5.5.1.1.3" xref="S4.Ex11.m1.5.5.1.1.3.cmml"><mi id="S4.Ex11.m1.5.5.1.1.3.2" xref="S4.Ex11.m1.5.5.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.Ex11.m1.5.5.1.1.3.1" xref="S4.Ex11.m1.5.5.1.1.3.1.cmml">​</mo><mi id="S4.Ex11.m1.5.5.1.1.3.3" xref="S4.Ex11.m1.5.5.1.1.3.3.cmml">g</mi><mo lspace="0.500em" rspace="0em" id="S4.Ex11.m1.5.5.1.1.3.1a" xref="S4.Ex11.m1.5.5.1.1.3.1.cmml">​</mo><mtext id="S4.Ex11.m1.5.5.1.1.3.4" xref="S4.Ex11.m1.5.5.1.1.3.4a.cmml">Digits</mtext></mrow></mrow><mo rspace="1.167em" id="S4.Ex11.m1.6.6.2.3" xref="S4.Ex11.m1.6.6.3a.cmml">,</mo><mrow id="S4.Ex11.m1.6.6.2.2" xref="S4.Ex11.m1.6.6.2.2.cmml"><mtext id="S4.Ex11.m1.6.6.2.2.2" xref="S4.Ex11.m1.6.6.2.2.2a.cmml">Digits</mtext><mo stretchy="false" id="S4.Ex11.m1.6.6.2.2.3" xref="S4.Ex11.m1.6.6.2.2.3.cmml">→</mo><mrow id="S4.Ex11.m1.6.6.2.2.4" xref="S4.Ex11.m1.6.6.2.2.4.cmml"><mrow id="S4.Ex11.m1.6.6.2.2.4.2" xref="S4.Ex11.m1.6.6.2.2.4.2.cmml"><mtext id="S4.Ex11.m1.6.6.2.2.4.2.2" xref="S4.Ex11.m1.6.6.2.2.4.2.2a.cmml">Digit</mtext><mo lspace="0.500em" rspace="0em" id="S4.Ex11.m1.6.6.2.2.4.2.1" xref="S4.Ex11.m1.6.6.2.2.4.2.1.cmml">​</mo><mtext id="S4.Ex11.m1.6.6.2.2.4.2.3" xref="S4.Ex11.m1.6.6.2.2.4.2.3a.cmml">Digits</mtext></mrow><mo fence="false" lspace="0.778em" rspace="0.778em" id="S4.Ex11.m1.6.6.2.2.4.1" xref="S4.Ex11.m1.6.6.2.2.4.1.cmml">|</mo><mrow id="S4.Ex11.m1.6.6.2.2.4.3.2" xref="S4.Ex11.m1.6.6.2.2.4.3.1.cmml"><mi id="S4.Ex11.m1.1.1" xref="S4.Ex11.m1.1.1.cmml">ϵ</mi><mo rspace="1.167em" id="S4.Ex11.m1.6.6.2.2.4.3.2.1" xref="S4.Ex11.m1.6.6.2.2.4.3.1.cmml">,</mo><mtext id="S4.Ex11.m1.2.2" xref="S4.Ex11.m1.2.2a.cmml">Digit</mtext></mrow></mrow><mo stretchy="false" id="S4.Ex11.m1.6.6.2.2.5" xref="S4.Ex11.m1.6.6.2.2.5.cmml">→</mo><mrow id="S4.Ex11.m1.6.6.2.2.6" xref="S4.Ex11.m1.6.6.2.2.6.cmml"><mn id="S4.Ex11.m1.6.6.2.2.6.2" xref="S4.Ex11.m1.6.6.2.2.6.2.cmml">0</mn><mo lspace="0.500em" rspace="0em" id="S4.Ex11.m1.6.6.2.2.6.1" xref="S4.Ex11.m1.6.6.2.2.6.1.cmml">​</mo><mrow id="S4.Ex11.m1.6.6.2.2.6.3.2" xref="S4.Ex11.m1.6.6.2.2.6.3.1.cmml"><mo stretchy="false" id="S4.Ex11.m1.6.6.2.2.6.3.2.1" xref="S4.Ex11.m1.6.6.2.2.6.3.1.1.cmml">|</mo><mn id="S4.Ex11.m1.3.3" xref="S4.Ex11.m1.3.3.cmml"> 1</mn><mo lspace="0.500em" stretchy="false" id="S4.Ex11.m1.6.6.2.2.6.3.2.2" xref="S4.Ex11.m1.6.6.2.2.6.3.1.1.cmml">|</mo></mrow><mo lspace="0em" rspace="0em" id="S4.Ex11.m1.6.6.2.2.6.1a" xref="S4.Ex11.m1.6.6.2.2.6.1.cmml">​</mo><mn id="S4.Ex11.m1.6.6.2.2.6.4" xref="S4.Ex11.m1.6.6.2.2.6.4.cmml"> 2</mn><mo lspace="0.500em" rspace="0em" id="S4.Ex11.m1.6.6.2.2.6.1b" xref="S4.Ex11.m1.6.6.2.2.6.1.cmml">​</mo><mrow id="S4.Ex11.m1.6.6.2.2.6.5.2" xref="S4.Ex11.m1.6.6.2.2.6.5.1.cmml"><mo rspace="0.500em" stretchy="false" id="S4.Ex11.m1.6.6.2.2.6.5.2.1" xref="S4.Ex11.m1.6.6.2.2.6.5.1.1.cmml">|</mo><mi mathvariant="normal" id="S4.Ex11.m1.4.4" xref="S4.Ex11.m1.4.4.cmml">⋯</mi><mo lspace="0.500em" stretchy="false" id="S4.Ex11.m1.6.6.2.2.6.5.2.2" xref="S4.Ex11.m1.6.6.2.2.6.5.1.1.cmml">|</mo></mrow><mo lspace="0em" rspace="0em" id="S4.Ex11.m1.6.6.2.2.6.1c" xref="S4.Ex11.m1.6.6.2.2.6.1.cmml">​</mo><mn id="S4.Ex11.m1.6.6.2.2.6.6" xref="S4.Ex11.m1.6.6.2.2.6.6.cmml"> 9</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex11.m1.6b"><apply id="S4.Ex11.m1.6.6.3.cmml" xref="S4.Ex11.m1.6.6.2"><csymbol cd="ambiguous" id="S4.Ex11.m1.6.6.3a.cmml" xref="S4.Ex11.m1.6.6.2.3">formulae-sequence</csymbol><apply id="S4.Ex11.m1.5.5.1.1.cmml" xref="S4.Ex11.m1.5.5.1.1"><ci id="S4.Ex11.m1.5.5.1.1.1.cmml" xref="S4.Ex11.m1.5.5.1.1.1">→</ci><ci id="S4.Ex11.m1.5.5.1.1.2a.cmml" xref="S4.Ex11.m1.5.5.1.1.2"><mtext id="S4.Ex11.m1.5.5.1.1.2.cmml" xref="S4.Ex11.m1.5.5.1.1.2">Scene</mtext></ci><apply id="S4.Ex11.m1.5.5.1.1.3.cmml" xref="S4.Ex11.m1.5.5.1.1.3"><times id="S4.Ex11.m1.5.5.1.1.3.1.cmml" xref="S4.Ex11.m1.5.5.1.1.3.1"></times><ci id="S4.Ex11.m1.5.5.1.1.3.2.cmml" xref="S4.Ex11.m1.5.5.1.1.3.2">𝑏</ci><ci id="S4.Ex11.m1.5.5.1.1.3.3.cmml" xref="S4.Ex11.m1.5.5.1.1.3.3">𝑔</ci><ci id="S4.Ex11.m1.5.5.1.1.3.4a.cmml" xref="S4.Ex11.m1.5.5.1.1.3.4"><mtext id="S4.Ex11.m1.5.5.1.1.3.4.cmml" xref="S4.Ex11.m1.5.5.1.1.3.4">Digits</mtext></ci></apply></apply><apply id="S4.Ex11.m1.6.6.2.2.cmml" xref="S4.Ex11.m1.6.6.2.2"><and id="S4.Ex11.m1.6.6.2.2a.cmml" xref="S4.Ex11.m1.6.6.2.2"></and><apply id="S4.Ex11.m1.6.6.2.2b.cmml" xref="S4.Ex11.m1.6.6.2.2"><ci id="S4.Ex11.m1.6.6.2.2.3.cmml" xref="S4.Ex11.m1.6.6.2.2.3">→</ci><ci id="S4.Ex11.m1.6.6.2.2.2a.cmml" xref="S4.Ex11.m1.6.6.2.2.2"><mtext id="S4.Ex11.m1.6.6.2.2.2.cmml" xref="S4.Ex11.m1.6.6.2.2.2">Digits</mtext></ci><apply id="S4.Ex11.m1.6.6.2.2.4.cmml" xref="S4.Ex11.m1.6.6.2.2.4"><csymbol cd="latexml" id="S4.Ex11.m1.6.6.2.2.4.1.cmml" xref="S4.Ex11.m1.6.6.2.2.4.1">conditional</csymbol><apply id="S4.Ex11.m1.6.6.2.2.4.2.cmml" xref="S4.Ex11.m1.6.6.2.2.4.2"><times id="S4.Ex11.m1.6.6.2.2.4.2.1.cmml" xref="S4.Ex11.m1.6.6.2.2.4.2.1"></times><ci id="S4.Ex11.m1.6.6.2.2.4.2.2a.cmml" xref="S4.Ex11.m1.6.6.2.2.4.2.2"><mtext id="S4.Ex11.m1.6.6.2.2.4.2.2.cmml" xref="S4.Ex11.m1.6.6.2.2.4.2.2">Digit</mtext></ci><ci id="S4.Ex11.m1.6.6.2.2.4.2.3a.cmml" xref="S4.Ex11.m1.6.6.2.2.4.2.3"><mtext id="S4.Ex11.m1.6.6.2.2.4.2.3.cmml" xref="S4.Ex11.m1.6.6.2.2.4.2.3">Digits</mtext></ci></apply><list id="S4.Ex11.m1.6.6.2.2.4.3.1.cmml" xref="S4.Ex11.m1.6.6.2.2.4.3.2"><ci id="S4.Ex11.m1.1.1.cmml" xref="S4.Ex11.m1.1.1">italic-ϵ</ci><ci id="S4.Ex11.m1.2.2a.cmml" xref="S4.Ex11.m1.2.2"><mtext id="S4.Ex11.m1.2.2.cmml" xref="S4.Ex11.m1.2.2">Digit</mtext></ci></list></apply></apply><apply id="S4.Ex11.m1.6.6.2.2c.cmml" xref="S4.Ex11.m1.6.6.2.2"><ci id="S4.Ex11.m1.6.6.2.2.5.cmml" xref="S4.Ex11.m1.6.6.2.2.5">→</ci><share href="#S4.Ex11.m1.6.6.2.2.4.cmml" id="S4.Ex11.m1.6.6.2.2d.cmml" xref="S4.Ex11.m1.6.6.2.2"></share><apply id="S4.Ex11.m1.6.6.2.2.6.cmml" xref="S4.Ex11.m1.6.6.2.2.6"><times id="S4.Ex11.m1.6.6.2.2.6.1.cmml" xref="S4.Ex11.m1.6.6.2.2.6.1"></times><cn type="integer" id="S4.Ex11.m1.6.6.2.2.6.2.cmml" xref="S4.Ex11.m1.6.6.2.2.6.2">0</cn><apply id="S4.Ex11.m1.6.6.2.2.6.3.1.cmml" xref="S4.Ex11.m1.6.6.2.2.6.3.2"><abs id="S4.Ex11.m1.6.6.2.2.6.3.1.1.cmml" xref="S4.Ex11.m1.6.6.2.2.6.3.2.1"></abs><cn type="integer" id="S4.Ex11.m1.3.3.cmml" xref="S4.Ex11.m1.3.3">1</cn></apply><cn type="integer" id="S4.Ex11.m1.6.6.2.2.6.4.cmml" xref="S4.Ex11.m1.6.6.2.2.6.4">2</cn><apply id="S4.Ex11.m1.6.6.2.2.6.5.1.cmml" xref="S4.Ex11.m1.6.6.2.2.6.5.2"><abs id="S4.Ex11.m1.6.6.2.2.6.5.1.1.cmml" xref="S4.Ex11.m1.6.6.2.2.6.5.2.1"></abs><ci id="S4.Ex11.m1.4.4.cmml" xref="S4.Ex11.m1.4.4">⋯</ci></apply><cn type="integer" id="S4.Ex11.m1.6.6.2.2.6.6.cmml" xref="S4.Ex11.m1.6.6.2.2.6.6">9</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex11.m1.6c">\displaystyle\text{Scene}\to bg\ \text{Digits},\quad\text{Digits}\to\text{Digit}\ \text{Digits}\ |\ \epsilon,\quad\text{Digit}\to 0\ |\ 1\ |\ 2\ |\ \cdots\ |\ 9</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.1" class="ltx_p">Sampled digits are placed onto a black canvas of size <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="256\times 256" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mn id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">256</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.1.m1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><times id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1"></times><cn type="integer" id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">256</cn><cn type="integer" id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">256\times 256</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_bold">Feature Extraction Network:</span>
We train a network to determine the binary presence of a digit class in the scene. We use a Resnet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> made up of three residual blocks each containing two <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="3\times 3" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mn id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p2.1.m1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><times id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1"></times><cn type="integer" id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">3</cn><cn type="integer" id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">3\times 3</annotation></semantics></math> convolutional layers to produce an image embedding and three fully connected layers from the image embedding to make the prediction. We use the Resnet embeddings as our image features. We train the network on synthetic data generated by our simple prior for both structure and continuous parameters. Training is done with a simple binary cross-entropy criterion for each class. The exact prior and target data used is explained below.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.4" class="ltx_p"><span id="S4.SS1.p3.4.1" class="ltx_text ltx_font_bold">Prior and Target Data:</span>
We sample the number of digits in the scene <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="n_{d}" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><msub id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mi id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">n</mi><mi id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">𝑛</ci><ci id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">n_{d}</annotation></semantics></math> uniformly from <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><mn id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><cn type="integer" id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">0</cn></annotation-xml></semantics></math> to <math id="S4.SS1.p3.3.m3.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.SS1.p3.3.m3.1a"><mn id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><cn type="integer" id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">10</annotation></semantics></math>, and sample <math id="S4.SS1.p3.4.m4.1" class="ltx_Math" alttext="n_{d}" display="inline"><semantics id="S4.SS1.p3.4.m4.1a"><msub id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml"><mi id="S4.SS1.p3.4.m4.1.1.2" xref="S4.SS1.p3.4.m4.1.1.2.cmml">n</mi><mi id="S4.SS1.p3.4.m4.1.1.3" xref="S4.SS1.p3.4.m4.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2">𝑛</ci><ci id="S4.SS1.p3.4.m4.1.1.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">n_{d}</annotation></semantics></math> digits uniformly to place on the scene. The digits are placed(parameters) uniformly on the canvas. The target data has digits upright in a straight line in the middle of the canvas. Fig. <a href="#S4.F7" title="Figure 7 ‣ 4.1 Multi MNIST ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> shows example prior samples, and target data. We show we can learn scene structures with a gap remaining in the parameters by using the parameter prior during training.</p>
</div>
<figure id="S4.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F7.2" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:212.5pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2008.09092/assets/x4.jpg" id="S4.F7.1.g1" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="266" height="91" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2008.09092/assets/x5.jpg" id="S4.F7.2.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="266" height="183" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Prior (Left) and Validation (Right) example for MultiMNIST experiments</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F7.4" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:212.5pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2008.09092/assets/x6.jpg" id="S4.F7.3.g1" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="266" height="93" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2008.09092/assets/x7.jpg" id="S4.F7.4.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="266" height="93" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Prior (Left) and Validation (Right) example for Aerial 2D experiments</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F7.6" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:212.5pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2008.09092/assets/x8.png" id="S4.F7.5.g1" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="162" height="108" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2008.09092/assets/x9.png" id="S4.F7.6.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="162" height="108" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Distributions of classes and number of digits, in the prior, learned and target scene structures</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F7.8" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:212.5pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2008.09092/assets/x10.png" id="S4.F7.7.g1" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="162" height="108" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2008.09092/assets/x11.png" id="S4.F7.8.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="162" height="108" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Distributions of classes and number of digits, comparing learning with MMD, ours and the target</figcaption>
</figure>
</div>
</div>
</figure>
<div id="S4.SS1.p4" class="ltx_para ltx_noindent">
<p id="S4.SS1.p4.1" class="ltx_p">We attempt <span id="S4.SS1.p4.1.1" class="ltx_text ltx_font_bold">learning a random distribution of number of digits</span> with random classes in the scene. Fig. <a href="#S4.F7" title="Figure 7 ‣ 4.1 Multi MNIST ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> shows the prior, target and learnt distribution of the number of digits and their class distribution. We see that our model can faithfully approximate the target, even while learning it unsupervised. We also <span id="S4.SS1.p4.1.2" class="ltx_text ltx_font_bold">train with MMD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite></span>, computed using two batches of real and generated images and used as the reward for every generated scene. Fig. <a href="#S4.F7" title="Figure 7 ‣ 4.1 Multi MNIST ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> shows that using MMD results in the model learning a smoothed approximation of the target distribution, which comes from the lack of credit assignment in the score, that we get with our objective.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Aerial 2D</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.1" class="ltx_p">Next, we evaluate our approach on a harder synthetic scenario of aerial views of driving scenes. The grammar and the corresponding rendered scenes offer additional complexity to test the model. The grammar here is as follows:</p>
<table id="S6.EGx9" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex12.m1.1" class="ltx_Math" alttext="\displaystyle\text{Scene}\to\text{Roads},\quad" display="inline"><semantics id="S4.Ex12.m1.1a"><mrow id="S4.Ex12.m1.1.1.1" xref="S4.Ex12.m1.1.1.1.1.cmml"><mrow id="S4.Ex12.m1.1.1.1.1" xref="S4.Ex12.m1.1.1.1.1.cmml"><mtext id="S4.Ex12.m1.1.1.1.1.2" xref="S4.Ex12.m1.1.1.1.1.2a.cmml">Scene</mtext><mo stretchy="false" id="S4.Ex12.m1.1.1.1.1.1" xref="S4.Ex12.m1.1.1.1.1.1.cmml">→</mo><mtext id="S4.Ex12.m1.1.1.1.1.3" xref="S4.Ex12.m1.1.1.1.1.3a.cmml">Roads</mtext></mrow><mo id="S4.Ex12.m1.1.1.1.2" xref="S4.Ex12.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex12.m1.1b"><apply id="S4.Ex12.m1.1.1.1.1.cmml" xref="S4.Ex12.m1.1.1.1"><ci id="S4.Ex12.m1.1.1.1.1.1.cmml" xref="S4.Ex12.m1.1.1.1.1.1">→</ci><ci id="S4.Ex12.m1.1.1.1.1.2a.cmml" xref="S4.Ex12.m1.1.1.1.1.2"><mtext id="S4.Ex12.m1.1.1.1.1.2.cmml" xref="S4.Ex12.m1.1.1.1.1.2">Scene</mtext></ci><ci id="S4.Ex12.m1.1.1.1.1.3a.cmml" xref="S4.Ex12.m1.1.1.1.1.3"><mtext id="S4.Ex12.m1.1.1.1.1.3.cmml" xref="S4.Ex12.m1.1.1.1.1.3">Roads</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex12.m1.1c">\displaystyle\text{Scene}\to\text{Roads},\quad</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.Ex12.m2.1" class="ltx_Math" alttext="\displaystyle\text{Roads}\to\text{Road}\ \text{Roads}\ |\ \epsilon" display="inline"><semantics id="S4.Ex12.m2.1a"><mrow id="S4.Ex12.m2.1.1" xref="S4.Ex12.m2.1.1.cmml"><mtext id="S4.Ex12.m2.1.1.2" xref="S4.Ex12.m2.1.1.2a.cmml">Roads</mtext><mo stretchy="false" id="S4.Ex12.m2.1.1.1" xref="S4.Ex12.m2.1.1.1.cmml">→</mo><mrow id="S4.Ex12.m2.1.1.3" xref="S4.Ex12.m2.1.1.3.cmml"><mrow id="S4.Ex12.m2.1.1.3.2" xref="S4.Ex12.m2.1.1.3.2.cmml"><mtext id="S4.Ex12.m2.1.1.3.2.2" xref="S4.Ex12.m2.1.1.3.2.2a.cmml">Road</mtext><mo lspace="0.500em" rspace="0em" id="S4.Ex12.m2.1.1.3.2.1" xref="S4.Ex12.m2.1.1.3.2.1.cmml">​</mo><mtext id="S4.Ex12.m2.1.1.3.2.3" xref="S4.Ex12.m2.1.1.3.2.3a.cmml">Roads</mtext></mrow><mo fence="false" lspace="0.778em" rspace="0.778em" id="S4.Ex12.m2.1.1.3.1" xref="S4.Ex12.m2.1.1.3.1.cmml">|</mo><mi id="S4.Ex12.m2.1.1.3.3" xref="S4.Ex12.m2.1.1.3.3.cmml">ϵ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex12.m2.1b"><apply id="S4.Ex12.m2.1.1.cmml" xref="S4.Ex12.m2.1.1"><ci id="S4.Ex12.m2.1.1.1.cmml" xref="S4.Ex12.m2.1.1.1">→</ci><ci id="S4.Ex12.m2.1.1.2a.cmml" xref="S4.Ex12.m2.1.1.2"><mtext id="S4.Ex12.m2.1.1.2.cmml" xref="S4.Ex12.m2.1.1.2">Roads</mtext></ci><apply id="S4.Ex12.m2.1.1.3.cmml" xref="S4.Ex12.m2.1.1.3"><csymbol cd="latexml" id="S4.Ex12.m2.1.1.3.1.cmml" xref="S4.Ex12.m2.1.1.3.1">conditional</csymbol><apply id="S4.Ex12.m2.1.1.3.2.cmml" xref="S4.Ex12.m2.1.1.3.2"><times id="S4.Ex12.m2.1.1.3.2.1.cmml" xref="S4.Ex12.m2.1.1.3.2.1"></times><ci id="S4.Ex12.m2.1.1.3.2.2a.cmml" xref="S4.Ex12.m2.1.1.3.2.2"><mtext id="S4.Ex12.m2.1.1.3.2.2.cmml" xref="S4.Ex12.m2.1.1.3.2.2">Road</mtext></ci><ci id="S4.Ex12.m2.1.1.3.2.3a.cmml" xref="S4.Ex12.m2.1.1.3.2.3"><mtext id="S4.Ex12.m2.1.1.3.2.3.cmml" xref="S4.Ex12.m2.1.1.3.2.3">Roads</mtext></ci></apply><ci id="S4.Ex12.m2.1.1.3.3.cmml" xref="S4.Ex12.m2.1.1.3.3">italic-ϵ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex12.m2.1c">\displaystyle\text{Roads}\to\text{Road}\ \text{Roads}\ |\ \epsilon</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.Ex13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex13.m1.1" class="ltx_Math" alttext="\displaystyle\text{Road}\to\text{Cars},\quad" display="inline"><semantics id="S4.Ex13.m1.1a"><mrow id="S4.Ex13.m1.1.1.1" xref="S4.Ex13.m1.1.1.1.1.cmml"><mrow id="S4.Ex13.m1.1.1.1.1" xref="S4.Ex13.m1.1.1.1.1.cmml"><mtext id="S4.Ex13.m1.1.1.1.1.2" xref="S4.Ex13.m1.1.1.1.1.2a.cmml">Road</mtext><mo stretchy="false" id="S4.Ex13.m1.1.1.1.1.1" xref="S4.Ex13.m1.1.1.1.1.1.cmml">→</mo><mtext id="S4.Ex13.m1.1.1.1.1.3" xref="S4.Ex13.m1.1.1.1.1.3a.cmml">Cars</mtext></mrow><mo id="S4.Ex13.m1.1.1.1.2" xref="S4.Ex13.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex13.m1.1b"><apply id="S4.Ex13.m1.1.1.1.1.cmml" xref="S4.Ex13.m1.1.1.1"><ci id="S4.Ex13.m1.1.1.1.1.1.cmml" xref="S4.Ex13.m1.1.1.1.1.1">→</ci><ci id="S4.Ex13.m1.1.1.1.1.2a.cmml" xref="S4.Ex13.m1.1.1.1.1.2"><mtext id="S4.Ex13.m1.1.1.1.1.2.cmml" xref="S4.Ex13.m1.1.1.1.1.2">Road</mtext></ci><ci id="S4.Ex13.m1.1.1.1.1.3a.cmml" xref="S4.Ex13.m1.1.1.1.1.3"><mtext id="S4.Ex13.m1.1.1.1.1.3.cmml" xref="S4.Ex13.m1.1.1.1.1.3">Cars</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex13.m1.1c">\displaystyle\text{Road}\to\text{Cars},\quad</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.Ex13.m2.1" class="ltx_Math" alttext="\displaystyle\text{Cars}\to car\ \text{Cars}\ |\ \epsilon" display="inline"><semantics id="S4.Ex13.m2.1a"><mrow id="S4.Ex13.m2.1.1" xref="S4.Ex13.m2.1.1.cmml"><mtext id="S4.Ex13.m2.1.1.2" xref="S4.Ex13.m2.1.1.2a.cmml">Cars</mtext><mo stretchy="false" id="S4.Ex13.m2.1.1.1" xref="S4.Ex13.m2.1.1.1.cmml">→</mo><mrow id="S4.Ex13.m2.1.1.3" xref="S4.Ex13.m2.1.1.3.cmml"><mrow id="S4.Ex13.m2.1.1.3.2" xref="S4.Ex13.m2.1.1.3.2.cmml"><mi id="S4.Ex13.m2.1.1.3.2.2" xref="S4.Ex13.m2.1.1.3.2.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.Ex13.m2.1.1.3.2.1" xref="S4.Ex13.m2.1.1.3.2.1.cmml">​</mo><mi id="S4.Ex13.m2.1.1.3.2.3" xref="S4.Ex13.m2.1.1.3.2.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.Ex13.m2.1.1.3.2.1a" xref="S4.Ex13.m2.1.1.3.2.1.cmml">​</mo><mi id="S4.Ex13.m2.1.1.3.2.4" xref="S4.Ex13.m2.1.1.3.2.4.cmml">r</mi><mo lspace="0.500em" rspace="0em" id="S4.Ex13.m2.1.1.3.2.1b" xref="S4.Ex13.m2.1.1.3.2.1.cmml">​</mo><mtext id="S4.Ex13.m2.1.1.3.2.5" xref="S4.Ex13.m2.1.1.3.2.5a.cmml">Cars</mtext></mrow><mo fence="false" lspace="0.778em" rspace="0.778em" id="S4.Ex13.m2.1.1.3.1" xref="S4.Ex13.m2.1.1.3.1.cmml">|</mo><mi id="S4.Ex13.m2.1.1.3.3" xref="S4.Ex13.m2.1.1.3.3.cmml">ϵ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex13.m2.1b"><apply id="S4.Ex13.m2.1.1.cmml" xref="S4.Ex13.m2.1.1"><ci id="S4.Ex13.m2.1.1.1.cmml" xref="S4.Ex13.m2.1.1.1">→</ci><ci id="S4.Ex13.m2.1.1.2a.cmml" xref="S4.Ex13.m2.1.1.2"><mtext id="S4.Ex13.m2.1.1.2.cmml" xref="S4.Ex13.m2.1.1.2">Cars</mtext></ci><apply id="S4.Ex13.m2.1.1.3.cmml" xref="S4.Ex13.m2.1.1.3"><csymbol cd="latexml" id="S4.Ex13.m2.1.1.3.1.cmml" xref="S4.Ex13.m2.1.1.3.1">conditional</csymbol><apply id="S4.Ex13.m2.1.1.3.2.cmml" xref="S4.Ex13.m2.1.1.3.2"><times id="S4.Ex13.m2.1.1.3.2.1.cmml" xref="S4.Ex13.m2.1.1.3.2.1"></times><ci id="S4.Ex13.m2.1.1.3.2.2.cmml" xref="S4.Ex13.m2.1.1.3.2.2">𝑐</ci><ci id="S4.Ex13.m2.1.1.3.2.3.cmml" xref="S4.Ex13.m2.1.1.3.2.3">𝑎</ci><ci id="S4.Ex13.m2.1.1.3.2.4.cmml" xref="S4.Ex13.m2.1.1.3.2.4">𝑟</ci><ci id="S4.Ex13.m2.1.1.3.2.5a.cmml" xref="S4.Ex13.m2.1.1.3.2.5"><mtext id="S4.Ex13.m2.1.1.3.2.5.cmml" xref="S4.Ex13.m2.1.1.3.2.5">Cars</mtext></ci></apply><ci id="S4.Ex13.m2.1.1.3.3.cmml" xref="S4.Ex13.m2.1.1.3.3">italic-ϵ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex13.m2.1c">\displaystyle\text{Cars}\to car\ \text{Cars}\ |\ \epsilon</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.2" class="ltx_p"><span id="S4.SS2.p1.2.1" class="ltx_text ltx_font_bold">Feature Extraction Network:</span>
We use the same Resnet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> architecture from the MNIST experiment with the FC layers outputting the number of cars, roads, houses and trees in the scene as 1-hot labels. We train by minimizing the cross entropies these labels, trained on samples generated from the prior.</p>
</div>
<figure id="S4.F8" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2008.09092/assets/x12.png" id="S4.F8.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="106" height="61" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2008.09092/assets/x13.png" id="S4.F8.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="106" height="61" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>#cars distribution learned in the Aerial 2D experiment. We can learn <em id="S4.F8.2.1" class="ltx_emph ltx_font_italic">context dependent</em> relationships, placing different number of cars on different roads</figcaption>
</figure>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.4" class="ltx_p"><span id="S4.SS2.p2.4.1" class="ltx_text ltx_font_bold">Prior:</span>
We sample the number of roads <math id="S4.SS2.p2.1.m1.2" class="ltx_Math" alttext="n_{r}\in[0,4]" display="inline"><semantics id="S4.SS2.p2.1.m1.2a"><mrow id="S4.SS2.p2.1.m1.2.3" xref="S4.SS2.p2.1.m1.2.3.cmml"><msub id="S4.SS2.p2.1.m1.2.3.2" xref="S4.SS2.p2.1.m1.2.3.2.cmml"><mi id="S4.SS2.p2.1.m1.2.3.2.2" xref="S4.SS2.p2.1.m1.2.3.2.2.cmml">n</mi><mi id="S4.SS2.p2.1.m1.2.3.2.3" xref="S4.SS2.p2.1.m1.2.3.2.3.cmml">r</mi></msub><mo id="S4.SS2.p2.1.m1.2.3.1" xref="S4.SS2.p2.1.m1.2.3.1.cmml">∈</mo><mrow id="S4.SS2.p2.1.m1.2.3.3.2" xref="S4.SS2.p2.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS2.p2.1.m1.2.3.3.2.1" xref="S4.SS2.p2.1.m1.2.3.3.1.cmml">[</mo><mn id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">0</mn><mo id="S4.SS2.p2.1.m1.2.3.3.2.2" xref="S4.SS2.p2.1.m1.2.3.3.1.cmml">,</mo><mn id="S4.SS2.p2.1.m1.2.2" xref="S4.SS2.p2.1.m1.2.2.cmml">4</mn><mo stretchy="false" id="S4.SS2.p2.1.m1.2.3.3.2.3" xref="S4.SS2.p2.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.2b"><apply id="S4.SS2.p2.1.m1.2.3.cmml" xref="S4.SS2.p2.1.m1.2.3"><in id="S4.SS2.p2.1.m1.2.3.1.cmml" xref="S4.SS2.p2.1.m1.2.3.1"></in><apply id="S4.SS2.p2.1.m1.2.3.2.cmml" xref="S4.SS2.p2.1.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.2.3.2.1.cmml" xref="S4.SS2.p2.1.m1.2.3.2">subscript</csymbol><ci id="S4.SS2.p2.1.m1.2.3.2.2.cmml" xref="S4.SS2.p2.1.m1.2.3.2.2">𝑛</ci><ci id="S4.SS2.p2.1.m1.2.3.2.3.cmml" xref="S4.SS2.p2.1.m1.2.3.2.3">𝑟</ci></apply><interval closure="closed" id="S4.SS2.p2.1.m1.2.3.3.1.cmml" xref="S4.SS2.p2.1.m1.2.3.3.2"><cn type="integer" id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">0</cn><cn type="integer" id="S4.SS2.p2.1.m1.2.2.cmml" xref="S4.SS2.p2.1.m1.2.2">4</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.2c">n_{r}\in[0,4]</annotation></semantics></math> uniformly. On each road, we sample <math id="S4.SS2.p2.2.m2.2" class="ltx_Math" alttext="c\in[0,8]" display="inline"><semantics id="S4.SS2.p2.2.m2.2a"><mrow id="S4.SS2.p2.2.m2.2.3" xref="S4.SS2.p2.2.m2.2.3.cmml"><mi id="S4.SS2.p2.2.m2.2.3.2" xref="S4.SS2.p2.2.m2.2.3.2.cmml">c</mi><mo id="S4.SS2.p2.2.m2.2.3.1" xref="S4.SS2.p2.2.m2.2.3.1.cmml">∈</mo><mrow id="S4.SS2.p2.2.m2.2.3.3.2" xref="S4.SS2.p2.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS2.p2.2.m2.2.3.3.2.1" xref="S4.SS2.p2.2.m2.2.3.3.1.cmml">[</mo><mn id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">0</mn><mo id="S4.SS2.p2.2.m2.2.3.3.2.2" xref="S4.SS2.p2.2.m2.2.3.3.1.cmml">,</mo><mn id="S4.SS2.p2.2.m2.2.2" xref="S4.SS2.p2.2.m2.2.2.cmml">8</mn><mo stretchy="false" id="S4.SS2.p2.2.m2.2.3.3.2.3" xref="S4.SS2.p2.2.m2.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.2b"><apply id="S4.SS2.p2.2.m2.2.3.cmml" xref="S4.SS2.p2.2.m2.2.3"><in id="S4.SS2.p2.2.m2.2.3.1.cmml" xref="S4.SS2.p2.2.m2.2.3.1"></in><ci id="S4.SS2.p2.2.m2.2.3.2.cmml" xref="S4.SS2.p2.2.m2.2.3.2">𝑐</ci><interval closure="closed" id="S4.SS2.p2.2.m2.2.3.3.1.cmml" xref="S4.SS2.p2.2.m2.2.3.3.2"><cn type="integer" id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">0</cn><cn type="integer" id="S4.SS2.p2.2.m2.2.2.cmml" xref="S4.SS2.p2.2.m2.2.2">8</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.2c">c\in[0,8]</annotation></semantics></math> cars uniformly. Roads are placed sequentially by sampling a random distance <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mi id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><ci id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">d</annotation></semantics></math> and placing the road <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mi id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><ci id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">d</annotation></semantics></math> pixels in front of the previous one. Cars are placed on the road with uniform random position and rotation (Fig. <a href="#S4.F7" title="Figure 7 ‣ 4.1 Multi MNIST ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>).</p>
</div>
<div id="S4.SS2.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.p3.3" class="ltx_p"><span id="S4.SS2.p3.3.1" class="ltx_text ltx_font_bold">Learning context-dependent relationships:</span>
For the target dataset, we sample the number of roads <math id="S4.SS2.p3.1.m1.2" class="ltx_Math" alttext="n_{r}\in[0,4]" display="inline"><semantics id="S4.SS2.p3.1.m1.2a"><mrow id="S4.SS2.p3.1.m1.2.3" xref="S4.SS2.p3.1.m1.2.3.cmml"><msub id="S4.SS2.p3.1.m1.2.3.2" xref="S4.SS2.p3.1.m1.2.3.2.cmml"><mi id="S4.SS2.p3.1.m1.2.3.2.2" xref="S4.SS2.p3.1.m1.2.3.2.2.cmml">n</mi><mi id="S4.SS2.p3.1.m1.2.3.2.3" xref="S4.SS2.p3.1.m1.2.3.2.3.cmml">r</mi></msub><mo id="S4.SS2.p3.1.m1.2.3.1" xref="S4.SS2.p3.1.m1.2.3.1.cmml">∈</mo><mrow id="S4.SS2.p3.1.m1.2.3.3.2" xref="S4.SS2.p3.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS2.p3.1.m1.2.3.3.2.1" xref="S4.SS2.p3.1.m1.2.3.3.1.cmml">[</mo><mn id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">0</mn><mo id="S4.SS2.p3.1.m1.2.3.3.2.2" xref="S4.SS2.p3.1.m1.2.3.3.1.cmml">,</mo><mn id="S4.SS2.p3.1.m1.2.2" xref="S4.SS2.p3.1.m1.2.2.cmml">4</mn><mo stretchy="false" id="S4.SS2.p3.1.m1.2.3.3.2.3" xref="S4.SS2.p3.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.2b"><apply id="S4.SS2.p3.1.m1.2.3.cmml" xref="S4.SS2.p3.1.m1.2.3"><in id="S4.SS2.p3.1.m1.2.3.1.cmml" xref="S4.SS2.p3.1.m1.2.3.1"></in><apply id="S4.SS2.p3.1.m1.2.3.2.cmml" xref="S4.SS2.p3.1.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.2.3.2.1.cmml" xref="S4.SS2.p3.1.m1.2.3.2">subscript</csymbol><ci id="S4.SS2.p3.1.m1.2.3.2.2.cmml" xref="S4.SS2.p3.1.m1.2.3.2.2">𝑛</ci><ci id="S4.SS2.p3.1.m1.2.3.2.3.cmml" xref="S4.SS2.p3.1.m1.2.3.2.3">𝑟</ci></apply><interval closure="closed" id="S4.SS2.p3.1.m1.2.3.3.1.cmml" xref="S4.SS2.p3.1.m1.2.3.3.2"><cn type="integer" id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">0</cn><cn type="integer" id="S4.SS2.p3.1.m1.2.2.cmml" xref="S4.SS2.p3.1.m1.2.2">4</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.2c">n_{r}\in[0,4]</annotation></semantics></math> with probabilities (0.05, 0.15, 0.4, 0.4). On the first road we sample <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="n_{1}\sim\text{Poisson}(9)" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mrow id="S4.SS2.p3.2.m2.1.2" xref="S4.SS2.p3.2.m2.1.2.cmml"><msub id="S4.SS2.p3.2.m2.1.2.2" xref="S4.SS2.p3.2.m2.1.2.2.cmml"><mi id="S4.SS2.p3.2.m2.1.2.2.2" xref="S4.SS2.p3.2.m2.1.2.2.2.cmml">n</mi><mn id="S4.SS2.p3.2.m2.1.2.2.3" xref="S4.SS2.p3.2.m2.1.2.2.3.cmml">1</mn></msub><mo id="S4.SS2.p3.2.m2.1.2.1" xref="S4.SS2.p3.2.m2.1.2.1.cmml">∼</mo><mrow id="S4.SS2.p3.2.m2.1.2.3" xref="S4.SS2.p3.2.m2.1.2.3.cmml"><mtext id="S4.SS2.p3.2.m2.1.2.3.2" xref="S4.SS2.p3.2.m2.1.2.3.2a.cmml">Poisson</mtext><mo lspace="0em" rspace="0em" id="S4.SS2.p3.2.m2.1.2.3.1" xref="S4.SS2.p3.2.m2.1.2.3.1.cmml">​</mo><mrow id="S4.SS2.p3.2.m2.1.2.3.3.2" xref="S4.SS2.p3.2.m2.1.2.3.cmml"><mo stretchy="false" id="S4.SS2.p3.2.m2.1.2.3.3.2.1" xref="S4.SS2.p3.2.m2.1.2.3.cmml">(</mo><mn id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">9</mn><mo stretchy="false" id="S4.SS2.p3.2.m2.1.2.3.3.2.2" xref="S4.SS2.p3.2.m2.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.2.cmml" xref="S4.SS2.p3.2.m2.1.2"><csymbol cd="latexml" id="S4.SS2.p3.2.m2.1.2.1.cmml" xref="S4.SS2.p3.2.m2.1.2.1">similar-to</csymbol><apply id="S4.SS2.p3.2.m2.1.2.2.cmml" xref="S4.SS2.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.2.2.1.cmml" xref="S4.SS2.p3.2.m2.1.2.2">subscript</csymbol><ci id="S4.SS2.p3.2.m2.1.2.2.2.cmml" xref="S4.SS2.p3.2.m2.1.2.2.2">𝑛</ci><cn type="integer" id="S4.SS2.p3.2.m2.1.2.2.3.cmml" xref="S4.SS2.p3.2.m2.1.2.2.3">1</cn></apply><apply id="S4.SS2.p3.2.m2.1.2.3.cmml" xref="S4.SS2.p3.2.m2.1.2.3"><times id="S4.SS2.p3.2.m2.1.2.3.1.cmml" xref="S4.SS2.p3.2.m2.1.2.3.1"></times><ci id="S4.SS2.p3.2.m2.1.2.3.2a.cmml" xref="S4.SS2.p3.2.m2.1.2.3.2"><mtext id="S4.SS2.p3.2.m2.1.2.3.2.cmml" xref="S4.SS2.p3.2.m2.1.2.3.2">Poisson</mtext></ci><cn type="integer" id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">9</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">n_{1}\sim\text{Poisson}(9)</annotation></semantics></math> cars and <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="n_{i}\sim\text{Poisson}(3)" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mrow id="S4.SS2.p3.3.m3.1.2" xref="S4.SS2.p3.3.m3.1.2.cmml"><msub id="S4.SS2.p3.3.m3.1.2.2" xref="S4.SS2.p3.3.m3.1.2.2.cmml"><mi id="S4.SS2.p3.3.m3.1.2.2.2" xref="S4.SS2.p3.3.m3.1.2.2.2.cmml">n</mi><mi id="S4.SS2.p3.3.m3.1.2.2.3" xref="S4.SS2.p3.3.m3.1.2.2.3.cmml">i</mi></msub><mo id="S4.SS2.p3.3.m3.1.2.1" xref="S4.SS2.p3.3.m3.1.2.1.cmml">∼</mo><mrow id="S4.SS2.p3.3.m3.1.2.3" xref="S4.SS2.p3.3.m3.1.2.3.cmml"><mtext id="S4.SS2.p3.3.m3.1.2.3.2" xref="S4.SS2.p3.3.m3.1.2.3.2a.cmml">Poisson</mtext><mo lspace="0em" rspace="0em" id="S4.SS2.p3.3.m3.1.2.3.1" xref="S4.SS2.p3.3.m3.1.2.3.1.cmml">​</mo><mrow id="S4.SS2.p3.3.m3.1.2.3.3.2" xref="S4.SS2.p3.3.m3.1.2.3.cmml"><mo stretchy="false" id="S4.SS2.p3.3.m3.1.2.3.3.2.1" xref="S4.SS2.p3.3.m3.1.2.3.cmml">(</mo><mn id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">3</mn><mo stretchy="false" id="S4.SS2.p3.3.m3.1.2.3.3.2.2" xref="S4.SS2.p3.3.m3.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.2.cmml" xref="S4.SS2.p3.3.m3.1.2"><csymbol cd="latexml" id="S4.SS2.p3.3.m3.1.2.1.cmml" xref="S4.SS2.p3.3.m3.1.2.1">similar-to</csymbol><apply id="S4.SS2.p3.3.m3.1.2.2.cmml" xref="S4.SS2.p3.3.m3.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.1.2.2.1.cmml" xref="S4.SS2.p3.3.m3.1.2.2">subscript</csymbol><ci id="S4.SS2.p3.3.m3.1.2.2.2.cmml" xref="S4.SS2.p3.3.m3.1.2.2.2">𝑛</ci><ci id="S4.SS2.p3.3.m3.1.2.2.3.cmml" xref="S4.SS2.p3.3.m3.1.2.2.3">𝑖</ci></apply><apply id="S4.SS2.p3.3.m3.1.2.3.cmml" xref="S4.SS2.p3.3.m3.1.2.3"><times id="S4.SS2.p3.3.m3.1.2.3.1.cmml" xref="S4.SS2.p3.3.m3.1.2.3.1"></times><ci id="S4.SS2.p3.3.m3.1.2.3.2a.cmml" xref="S4.SS2.p3.3.m3.1.2.3.2"><mtext id="S4.SS2.p3.3.m3.1.2.3.2.cmml" xref="S4.SS2.p3.3.m3.1.2.3.2">Poisson</mtext></ci><cn type="integer" id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">n_{i}\sim\text{Poisson}(3)</annotation></semantics></math> cars for each of the remaining roads. All cars are placed well spaced on their respective road. Unlike the Multi-MNIST experiment, these structures cannot be modelled by a Probabilistic-CFG, and thus by  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. We see that our model can learn this context-dependent distribution faithfully as well in Fig. <a href="#S4.F8" title="Figure 8 ‣ 4.2 Aerial 2D ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>3D Driving Scenes</h3>

<div id="S4.SS3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.p1.1" class="ltx_p">We experiment on the KITTI  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> dataset, which was captured with a camera
mounted on top of a car driving around the city of Karlsruhe, Germany. The dataset contains a wide variety of road scenes, ranging from urban traffic scenarios to highways and more rural neighborhoods. We utilize the same grammar and renderer used for road scenes in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. Our model, although trained unsupervised, can learn to get closer to the underlying structure distribution, improve measures of image generation, and the performance of a downstream task model.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.p2.1" class="ltx_p"><span id="S4.SS3.p2.1.1" class="ltx_text ltx_font_bold">Prior and Training:</span>
Following SDR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>, we define three different priors to capture three different modes in the KITTI dataset. They are the ’Rural’, ’Suburban’ and ’Urban’ scenarios, as defined in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>. We train three different versions of our model, one for each of the structural priors, and sample from each of them uniformly. We use the scene parameter prior and learnt scene parameter model from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> to produce parameters for our generated scene structures to get the final scene graphs, which are rendered and used for our distribution matching.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para ltx_noindent">
<p id="S4.SS3.p3.1" class="ltx_p"><span id="S4.SS3.p3.1.1" class="ltx_text ltx_font_bold">Feature Extraction Network:</span>
We use the pool-3 layer of an Inception-V3 network, pre-trained on the ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> dataset as our feature extractor. Interestingly, we found this to work as well as using features from Mask-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> trained on driving scenes.</p>
</div>
<figure id="S4.F9" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/Selection/full_prior/000014.jpg" id="S4.F9.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/Selection/struct_trained_and_params/000080.jpg" id="S4.F9.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/Selection/kitti/004551.jpg" id="S4.F9.g3" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/Selection/full_prior/000161.jpg" id="S4.F9.g4" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/Selection/struct_trained_and_params/000104.jpg" id="S4.F9.g5" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/Selection/kitti/rural.jpg" id="S4.F9.g6" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/Selection/full_prior/000339.jpg" id="S4.F9.g7" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/Selection/struct_trained_and_params/000254.jpg" id="S4.F9.g8" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/Selection/kitti/suburban.jpg" id="S4.F9.g9" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/x14.jpg" id="S4.F9.g10" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="212" height="50" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/x15.jpg" id="S4.F9.g11" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="212" height="50" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/x16.jpg" id="S4.F9.g12" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="212" height="50" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Generated images (good prior expt.). (Left) Using both the structure and parameter prior, (Middle) Using our learnt structure and parameters from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, (Right) Real KITTI samples. Our model (middle), although unsupervised, adds diverse scene elements like vegetation, pedestrians, signs etc. to better resemble the real dataset.</figcaption>
</figure>
<figure id="S4.F10" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2008.09092/assets/x17.png" id="S4.F10.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="106" height="61" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2008.09092/assets/x18.png" id="S4.F10.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="106" height="61" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>#cars/scene learned from a simple prior (left) and good prior (right) on KITTI</figcaption>
</figure>
<figure id="S4.F11" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/BAD_PRIOR/000029.jpg" id="S4.F11.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/BAD_TRAINED/000103.jpg" id="S4.F11.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/Selection/kitti/004551.jpg" id="S4.F11.g3" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/BAD_PRIOR/000236.jpg" id="S4.F11.g4" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/BAD_TRAINED/000219.jpg" id="S4.F11.g5" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/Selection/kitti/rural.jpg" id="S4.F11.g6" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/BAD_PRIOR/000027.jpg" id="S4.F11.g7" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/BAD_TRAINED/000069.jpg" id="S4.F11.g8" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/Selection/kitti/suburban.jpg" id="S4.F11.g9" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/x19.jpg" id="S4.F11.g10" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="212" height="50" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/x20.jpg" id="S4.F11.g11" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="212" height="50" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/x21.jpg" id="S4.F11.g12" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="212" height="50" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Generated images (simple prior expt.). (Left) Using both the structure and parameter prior, (Middle) Using our learnt structure and parameters from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, (Right) Real samples from KITTI. Our model, although trained unsupervised, learns to add an appropriate frequency and diversity of scene elements to resemble the real data, even when trained from a very weak prior.</figcaption>
</figure>
<div id="S4.SS3.p4" class="ltx_para ltx_noindent">
<p id="S4.SS3.p4.1" class="ltx_p"><span id="S4.SS3.p4.1.1" class="ltx_text ltx_font_bold">Distribution similarity metrics:</span> In generative modeling of images, the Frechet Inception Distance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, and the Kernel Inception Distance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> have been used to measure progress. We report FID and KID in Tab. <a href="#S4.T2" title="Table 2 ‣ 4.3 3D Driving Scenes ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, <a href="#S4.T2" title="Table 2 ‣ 4.3 3D Driving Scenes ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> between our generated synthetic dataset and the KITTI-train set. We do so by generating 10K synthetic samples and using the full KITTI-train set, computed using the pool-3 features of an Inception-v3 network. Fig. <a href="#S4.F10" title="Figure 10 ‣ 4.3 3D Driving Scenes ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> (left) shows the distribution of the number of cars generated by the prior, learnt model and in the KITTI dataset (since we have GT for cars). We do not have ground truth for which KITTI scenes could be classified into rural/suburban/urban, so we compare against the global distribution of the whole dataset. We notice that the model bridges the gap between this particular distribution well after training.</p>
</div>
<div id="S4.SS3.p5" class="ltx_para ltx_noindent">
<p id="S4.SS3.p5.3" class="ltx_p"><span id="S4.SS3.p5.3.1" class="ltx_text ltx_font_bold">Task Performance:</span> We report average precision for detection at 0.5 IoU <em id="S4.SS3.p5.3.2" class="ltx_emph ltx_font_italic">i.e. </em>AP@0.5 (following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>) of an object detector trained to convergence on our synthetic data and tested on the KITTI validation set. We use the detection head from Mask-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> with a Resnet-50-FPN backbone initialized with pre-trained ImageNet weights as our object detector. The task network in each result row of Tab. <a href="#S4.T2" title="Table 2 ‣ 4.3 3D Driving Scenes ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> is finetuned from the snapshot of the previous row. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> show results with adding Image-to-Image translation to the generated images to reduce the <em id="S4.SS3.p5.3.3" class="ltx_emph ltx_font_italic">appearance gap</em> and results with training on a small amount of real data. We omit those experiments here and refer the reader to their paper for a sketch of expected results in these settings. Training this model directly on the full KITTI training set obtains AP@0.5 of <math id="S4.SS3.p5.1.m1.1" class="ltx_Math" alttext="81.52(\text{easy})" display="inline"><semantics id="S4.SS3.p5.1.m1.1a"><mrow id="S4.SS3.p5.1.m1.1.2" xref="S4.SS3.p5.1.m1.1.2.cmml"><mn id="S4.SS3.p5.1.m1.1.2.2" xref="S4.SS3.p5.1.m1.1.2.2.cmml">81.52</mn><mo lspace="0em" rspace="0em" id="S4.SS3.p5.1.m1.1.2.1" xref="S4.SS3.p5.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS3.p5.1.m1.1.2.3.2" xref="S4.SS3.p5.1.m1.1.1a.cmml"><mo stretchy="false" id="S4.SS3.p5.1.m1.1.2.3.2.1" xref="S4.SS3.p5.1.m1.1.1a.cmml">(</mo><mtext id="S4.SS3.p5.1.m1.1.1" xref="S4.SS3.p5.1.m1.1.1.cmml">easy</mtext><mo stretchy="false" id="S4.SS3.p5.1.m1.1.2.3.2.2" xref="S4.SS3.p5.1.m1.1.1a.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.1b"><apply id="S4.SS3.p5.1.m1.1.2.cmml" xref="S4.SS3.p5.1.m1.1.2"><times id="S4.SS3.p5.1.m1.1.2.1.cmml" xref="S4.SS3.p5.1.m1.1.2.1"></times><cn type="float" id="S4.SS3.p5.1.m1.1.2.2.cmml" xref="S4.SS3.p5.1.m1.1.2.2">81.52</cn><ci id="S4.SS3.p5.1.m1.1.1a.cmml" xref="S4.SS3.p5.1.m1.1.2.3.2"><mtext id="S4.SS3.p5.1.m1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1">easy</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.1c">81.52(\text{easy})</annotation></semantics></math>, <math id="S4.SS3.p5.2.m2.1" class="ltx_Math" alttext="83.58(\text{medium})" display="inline"><semantics id="S4.SS3.p5.2.m2.1a"><mrow id="S4.SS3.p5.2.m2.1.2" xref="S4.SS3.p5.2.m2.1.2.cmml"><mn id="S4.SS3.p5.2.m2.1.2.2" xref="S4.SS3.p5.2.m2.1.2.2.cmml">83.58</mn><mo lspace="0em" rspace="0em" id="S4.SS3.p5.2.m2.1.2.1" xref="S4.SS3.p5.2.m2.1.2.1.cmml">​</mo><mrow id="S4.SS3.p5.2.m2.1.2.3.2" xref="S4.SS3.p5.2.m2.1.1a.cmml"><mo stretchy="false" id="S4.SS3.p5.2.m2.1.2.3.2.1" xref="S4.SS3.p5.2.m2.1.1a.cmml">(</mo><mtext id="S4.SS3.p5.2.m2.1.1" xref="S4.SS3.p5.2.m2.1.1.cmml">medium</mtext><mo stretchy="false" id="S4.SS3.p5.2.m2.1.2.3.2.2" xref="S4.SS3.p5.2.m2.1.1a.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.2.m2.1b"><apply id="S4.SS3.p5.2.m2.1.2.cmml" xref="S4.SS3.p5.2.m2.1.2"><times id="S4.SS3.p5.2.m2.1.2.1.cmml" xref="S4.SS3.p5.2.m2.1.2.1"></times><cn type="float" id="S4.SS3.p5.2.m2.1.2.2.cmml" xref="S4.SS3.p5.2.m2.1.2.2">83.58</cn><ci id="S4.SS3.p5.2.m2.1.1a.cmml" xref="S4.SS3.p5.2.m2.1.2.3.2"><mtext id="S4.SS3.p5.2.m2.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1">medium</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.2.m2.1c">83.58(\text{medium})</annotation></semantics></math> and <math id="S4.SS3.p5.3.m3.1" class="ltx_Math" alttext="84.48(\text{hard})" display="inline"><semantics id="S4.SS3.p5.3.m3.1a"><mrow id="S4.SS3.p5.3.m3.1.2" xref="S4.SS3.p5.3.m3.1.2.cmml"><mn id="S4.SS3.p5.3.m3.1.2.2" xref="S4.SS3.p5.3.m3.1.2.2.cmml">84.48</mn><mo lspace="0em" rspace="0em" id="S4.SS3.p5.3.m3.1.2.1" xref="S4.SS3.p5.3.m3.1.2.1.cmml">​</mo><mrow id="S4.SS3.p5.3.m3.1.2.3.2" xref="S4.SS3.p5.3.m3.1.1a.cmml"><mo stretchy="false" id="S4.SS3.p5.3.m3.1.2.3.2.1" xref="S4.SS3.p5.3.m3.1.1a.cmml">(</mo><mtext id="S4.SS3.p5.3.m3.1.1" xref="S4.SS3.p5.3.m3.1.1.cmml">hard</mtext><mo stretchy="false" id="S4.SS3.p5.3.m3.1.2.3.2.2" xref="S4.SS3.p5.3.m3.1.1a.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.3.m3.1b"><apply id="S4.SS3.p5.3.m3.1.2.cmml" xref="S4.SS3.p5.3.m3.1.2"><times id="S4.SS3.p5.3.m3.1.2.1.cmml" xref="S4.SS3.p5.3.m3.1.2.1"></times><cn type="float" id="S4.SS3.p5.3.m3.1.2.2.cmml" xref="S4.SS3.p5.3.m3.1.2.2">84.48</cn><ci id="S4.SS3.p5.3.m3.1.1a.cmml" xref="S4.SS3.p5.3.m3.1.2.3.2"><mtext id="S4.SS3.p5.3.m3.1.1.cmml" xref="S4.SS3.p5.3.m3.1.1">hard</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.3.m3.1c">84.48(\text{hard})</annotation></semantics></math>, denoting a large sim-to-real performance gap left to bridge.</p>
</div>
<div id="S4.SS3.p6" class="ltx_para ltx_noindent">
<p id="S4.SS3.p6.1" class="ltx_p"><span id="S4.SS3.p6.1.1" class="ltx_text ltx_font_bold">Using a simple prior:</span> The priors on the structure in the previous experiments were taken from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>. These priors already involved some human intervention, which we aim to minimize. Therefore, we repeat the experiments above with a very simple and quick to create prior on the scene structure, where a few instances of each kind of object (car, house etc.) is placed in the scene (see Fig. <a href="#S4.F11" title="Figure 11 ‣ 4.3 3D Driving Scenes ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> (Left)). <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> requires a decently crafted structure prior to train the parameter network. Thus, we use the prior parameters while training our structure generator in this experiment (showing the robustness of training with randomized prior parameters), and learn the parameter network later (Tab. <a href="#S4.T2" title="Table 2 ‣ 4.3 3D Driving Scenes ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). Fig. <a href="#S4.F10" title="Figure 10 ‣ 4.3 3D Driving Scenes ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> (right) shows that the method learned the distribution of the number of cars well (unsupervised), even when initialized from a bad prior. Notice that the FID/KID of the learnt model from the simple prior in Tab. <a href="#S4.T2" title="Table 2 ‣ 4.3 3D Driving Scenes ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> is comparable to that trained from a tuned prior in Tab. <a href="#S4.T2" title="Table 2 ‣ 4.3 3D Driving Scenes ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, which we believe is an exciting result.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_1">
<table id="S4.T2.1" class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.1.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><span id="S4.T2.1.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S4.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><span id="S4.T2.1.1.1.2.1" class="ltx_text ltx_font_bold">Structure</span></th>
<th id="S4.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><span id="S4.T2.1.1.1.3.1" class="ltx_text ltx_font_bold">Parameters</span></th>
<th id="S4.T2.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><span id="S4.T2.1.1.1.4.1" class="ltx_text ltx_font_bold">Easy</span></th>
<th id="S4.T2.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><span id="S4.T2.1.1.1.5.1" class="ltx_text ltx_font_bold">Medium</span></th>
<th id="S4.T2.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><span id="S4.T2.1.1.1.6.1" class="ltx_text ltx_font_bold">Hard</span></th>
<th id="S4.T2.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">
<span id="S4.T2.1.1.1.7.1" class="ltx_text ltx_font_bold">KID</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>
</th>
<th id="S4.T2.1.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S4.T2.1.1.1.8.1" class="ltx_text ltx_font_bold">FID</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.1.2.1" class="ltx_tr">
<td id="S4.T2.1.2.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">Prob. Grammar</td>
<td id="S4.T2.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">Prior</td>
<td id="S4.T2.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">Prior</td>
<td id="S4.T2.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">63.7</td>
<td id="S4.T2.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">63.7</td>
<td id="S4.T2.1.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">62.2</td>
<td id="S4.T2.1.2.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">0.066</td>
<td id="S4.T2.1.2.1.8" class="ltx_td ltx_align_center ltx_border_tt">106.6</td>
</tr>
<tr id="S4.T2.1.3.2" class="ltx_tr">
<td id="S4.T2.1.3.2.1" class="ltx_td ltx_align_center ltx_border_r">Meta-Sim* <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>
</td>
<td id="S4.T2.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r">Prior</td>
<td id="S4.T2.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r">Learnt</td>
<td id="S4.T2.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r">66.5</td>
<td id="S4.T2.1.3.2.5" class="ltx_td ltx_align_center ltx_border_r">66.3</td>
<td id="S4.T2.1.3.2.6" class="ltx_td ltx_align_center ltx_border_r">65.8</td>
<td id="S4.T2.1.3.2.7" class="ltx_td ltx_align_center ltx_border_r">0.072</td>
<td id="S4.T2.1.3.2.8" class="ltx_td ltx_align_center">111.6</td>
</tr>
<tr id="S4.T2.1.4.3" class="ltx_tr">
<td id="S4.T2.1.4.3.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">Ours</td>
<td id="S4.T2.1.4.3.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">Learnt</td>
<td id="S4.T2.1.4.3.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">Learnt</td>
<td id="S4.T2.1.4.3.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.1.4.3.4.1" class="ltx_text ltx_font_bold">67.0</span></td>
<td id="S4.T2.1.4.3.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.1.4.3.5.1" class="ltx_text ltx_font_bold">67.0</span></td>
<td id="S4.T2.1.4.3.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.1.4.3.6.1" class="ltx_text ltx_font_bold">66.2</span></td>
<td id="S4.T2.1.4.3.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.1.4.3.7.1" class="ltx_text ltx_font_bold">0.054</span></td>
<td id="S4.T2.1.4.3.8" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.1.4.3.8.1" class="ltx_text ltx_font_bold">99.7</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>AP@0.5 on KITTI-val and distribution similarity metrics between generated synthetic data and KITTI-train. Learnt parameters are used from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. *Results from  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> are our reproduced numbers, and we show learning the structure additionally helps close the distribution gap and improves downstream task performance.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table id="S4.T2.2" class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.2.1.1" class="ltx_tr">
<th id="S4.T2.2.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><span id="S4.T2.2.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S4.T2.2.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><span id="S4.T2.2.1.1.2.1" class="ltx_text ltx_font_bold">Structure</span></th>
<th id="S4.T2.2.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><span id="S4.T2.2.1.1.3.1" class="ltx_text ltx_font_bold">Parameters</span></th>
<th id="S4.T2.2.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><span id="S4.T2.2.1.1.4.1" class="ltx_text ltx_font_bold">Easy</span></th>
<th id="S4.T2.2.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><span id="S4.T2.2.1.1.5.1" class="ltx_text ltx_font_bold">Medium</span></th>
<th id="S4.T2.2.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><span id="S4.T2.2.1.1.6.1" class="ltx_text ltx_font_bold">Hard</span></th>
<th id="S4.T2.2.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">
<span id="S4.T2.2.1.1.7.1" class="ltx_text ltx_font_bold">KID</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>
</th>
<th id="S4.T2.2.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S4.T2.2.1.1.8.1" class="ltx_text ltx_font_bold">FID</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.2.2.1" class="ltx_tr">
<td id="S4.T2.2.2.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">Prob. Grammar</td>
<td id="S4.T2.2.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">Prior*</td>
<td id="S4.T2.2.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">Prior</td>
<td id="S4.T2.2.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">61.3</td>
<td id="S4.T2.2.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">59.8</td>
<td id="S4.T2.2.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">58.0</td>
<td id="S4.T2.2.2.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">0.101</td>
<td id="S4.T2.2.2.1.8" class="ltx_td ltx_align_center ltx_border_tt">130.3</td>
</tr>
<tr id="S4.T2.2.3.2" class="ltx_tr">
<td id="S4.T2.2.3.2.1" class="ltx_td ltx_align_center ltx_border_r">Ours</td>
<td id="S4.T2.2.3.2.2" class="ltx_td ltx_align_center ltx_border_r">Learnt</td>
<td id="S4.T2.2.3.2.3" class="ltx_td ltx_align_center ltx_border_r">Prior</td>
<td id="S4.T2.2.3.2.4" class="ltx_td ltx_align_center ltx_border_r">63.2</td>
<td id="S4.T2.2.3.2.5" class="ltx_td ltx_align_center ltx_border_r">62.5</td>
<td id="S4.T2.2.3.2.6" class="ltx_td ltx_align_center ltx_border_r">61.2</td>
<td id="S4.T2.2.3.2.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.2.3.2.7.1" class="ltx_text ltx_font_bold">0.059</span></td>
<td id="S4.T2.2.3.2.8" class="ltx_td ltx_align_center"><span id="S4.T2.2.3.2.8.1" class="ltx_text ltx_font_bold">100.0</span></td>
</tr>
<tr id="S4.T2.2.4.3" class="ltx_tr">
<td id="S4.T2.2.4.3.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">Ours</td>
<td id="S4.T2.2.4.3.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">Learnt</td>
<td id="S4.T2.2.4.3.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">Learnt</td>
<td id="S4.T2.2.4.3.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.2.4.3.4.1" class="ltx_text ltx_font_bold">65.2</span></td>
<td id="S4.T2.2.4.3.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.2.4.3.5.1" class="ltx_text ltx_font_bold">64.7</span></td>
<td id="S4.T2.2.4.3.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.2.4.3.6.1" class="ltx_text ltx_font_bold">63.4</span></td>
<td id="S4.T2.2.4.3.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">0.060</td>
<td id="S4.T2.2.4.3.8" class="ltx_td ltx_align_center ltx_border_b">101.7</td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Repeat of experiments in Tab. <a href="#S4.T2" title="Table 2 ‣ 4.3 3D Driving Scenes ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> with a *<em id="S4.T2.4.1" class="ltx_emph ltx_font_italic">simple</em> prior on the scene structure. Parameters are learnt using <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. We observe a significant boost in both task performance and distribution similarity metrics, by learning the structure and parameters.</figcaption>
</figure>
<div id="S4.SS3.p7" class="ltx_para ltx_noindent">
<p id="S4.SS3.p7.1" class="ltx_p"><span id="S4.SS3.p7.1.1" class="ltx_text ltx_font_bold">Discussion:</span> We noticed that our method worked better when initialized with more spread out priors than more localized priors (Tab. <a href="#S4.T2" title="Table 2 ‣ 4.3 3D Driving Scenes ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, <a href="#S4.T2" title="Table 2 ‣ 4.3 3D Driving Scenes ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, Fig. <a href="#S4.F10" title="Figure 10 ‣ 4.3 3D Driving Scenes ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>) We hypothesize this is due to the distribution matching metric we use being the the reverse-KL divergence between the generated and real data (feature) distributions, which is mode-seeking instead of being mode-covering. Therefore, an initialization with a narrow distribution around one of the modes has low incentive to move away from it, hampering learning. Even then, we see a significant improvement in performance when starting from a peaky prior as shown in Tab. <a href="#S4.T2" title="Table 2 ‣ 4.3 3D Driving Scenes ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. We also note the importance of pre-training the task network. Rows in Tab. <a href="#S4.T2" title="Table 2 ‣ 4.3 3D Driving Scenes ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and Tab. <a href="#S4.T2" title="Table 2 ‣ 4.3 3D Driving Scenes ‣ 4 Experiments ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> were finetuned from the checkpoint of the previous row. The first row (Prob. Grammar) is a form of Domain Randomization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib62" title="" class="ltx_ref">62</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>, which has been shown to be crucial for sim-to-real adaptation. Our method, in essence, reduces the randomization in the generated scenes (by learning to generate scenes similar to the target data), and we observe that progressively training the task network with our (more specialized) generated data improves its performance. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite> show the opposite behavior, where increasing randomization (or environment difficulty) through task training results in improved performance. A detailed analysis of this phenomemon is beyond the current scope and is left for future work.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">We introduced an approach to unsupervised learning of a generative model of synthetic scene structures by optimizing for visual similarity to the real data. Inferring scene structures is known to be notoriously hard even when annotations are provided. Our method is able to perform the generative side of it without any ground truth information. Experiments on two toy and one real dataset showcase the ability of our model to learn a plausible posterior over scene structures, significantly improving over manually designed priors.
Our current method needs to optimize for both the scene structure and parameters of a synthetic scene generator in order to produce good results. This process has many moving parts and is generally cumbersome to make work in a new application scenario. Doing so, such as learning the grammar itself, requires further investigation, and opens an exciting direction for future work.</p>
</div>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.1" class="ltx_p"><span id="S5.p2.1.1" class="ltx_text ltx_font_bold">Acknowledgement:</span> We would like to acknowledge contributions through helpful discussions and technical support from Frank Cheng, Eric Cameracci, Marc Law, Aayush Prakash and Rev Lebaredian.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Supplementary Material</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.1" class="ltx_p">In the Supplementary Material, we present all experimental details in Sec. <a href="#S6.SS1" title="6.1 Experimental Details ‣ 6 Supplementary Material ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.1</span></a> and
show additional qualitative results in Sec. <a href="#S6.SS2" title="6.2 Additional Qualitative Results ‣ 6 Supplementary Material ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.2</span></a>.</p>
</div>
<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Experimental Details</h3>

<section id="S6.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.1.1 </span>Loss gradient scale</h4>

<div id="S6.SS1.SSS1.p1" class="ltx_para ltx_noindent">
<p id="S6.SS1.SSS1.p1.5" class="ltx_p">We estimate the log ratio <math id="S6.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\ln\frac{q_{f}}{p_{f}}" display="inline"><semantics id="S6.SS1.SSS1.p1.1.m1.1a"><mrow id="S6.SS1.SSS1.p1.1.m1.1.1" xref="S6.SS1.SSS1.p1.1.m1.1.1.cmml"><mi id="S6.SS1.SSS1.p1.1.m1.1.1.1" xref="S6.SS1.SSS1.p1.1.m1.1.1.1.cmml">ln</mi><mo lspace="0.167em" id="S6.SS1.SSS1.p1.1.m1.1.1a" xref="S6.SS1.SSS1.p1.1.m1.1.1.cmml">⁡</mo><mfrac id="S6.SS1.SSS1.p1.1.m1.1.1.2" xref="S6.SS1.SSS1.p1.1.m1.1.1.2.cmml"><msub id="S6.SS1.SSS1.p1.1.m1.1.1.2.2" xref="S6.SS1.SSS1.p1.1.m1.1.1.2.2.cmml"><mi id="S6.SS1.SSS1.p1.1.m1.1.1.2.2.2" xref="S6.SS1.SSS1.p1.1.m1.1.1.2.2.2.cmml">q</mi><mi id="S6.SS1.SSS1.p1.1.m1.1.1.2.2.3" xref="S6.SS1.SSS1.p1.1.m1.1.1.2.2.3.cmml">f</mi></msub><msub id="S6.SS1.SSS1.p1.1.m1.1.1.2.3" xref="S6.SS1.SSS1.p1.1.m1.1.1.2.3.cmml"><mi id="S6.SS1.SSS1.p1.1.m1.1.1.2.3.2" xref="S6.SS1.SSS1.p1.1.m1.1.1.2.3.2.cmml">p</mi><mi id="S6.SS1.SSS1.p1.1.m1.1.1.2.3.3" xref="S6.SS1.SSS1.p1.1.m1.1.1.2.3.3.cmml">f</mi></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p1.1.m1.1b"><apply id="S6.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S6.SS1.SSS1.p1.1.m1.1.1"><ln id="S6.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S6.SS1.SSS1.p1.1.m1.1.1.1"></ln><apply id="S6.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="S6.SS1.SSS1.p1.1.m1.1.1.2"><divide id="S6.SS1.SSS1.p1.1.m1.1.1.2.1.cmml" xref="S6.SS1.SSS1.p1.1.m1.1.1.2"></divide><apply id="S6.SS1.SSS1.p1.1.m1.1.1.2.2.cmml" xref="S6.SS1.SSS1.p1.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p1.1.m1.1.1.2.2.1.cmml" xref="S6.SS1.SSS1.p1.1.m1.1.1.2.2">subscript</csymbol><ci id="S6.SS1.SSS1.p1.1.m1.1.1.2.2.2.cmml" xref="S6.SS1.SSS1.p1.1.m1.1.1.2.2.2">𝑞</ci><ci id="S6.SS1.SSS1.p1.1.m1.1.1.2.2.3.cmml" xref="S6.SS1.SSS1.p1.1.m1.1.1.2.2.3">𝑓</ci></apply><apply id="S6.SS1.SSS1.p1.1.m1.1.1.2.3.cmml" xref="S6.SS1.SSS1.p1.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p1.1.m1.1.1.2.3.1.cmml" xref="S6.SS1.SSS1.p1.1.m1.1.1.2.3">subscript</csymbol><ci id="S6.SS1.SSS1.p1.1.m1.1.1.2.3.2.cmml" xref="S6.SS1.SSS1.p1.1.m1.1.1.2.3.2">𝑝</ci><ci id="S6.SS1.SSS1.p1.1.m1.1.1.2.3.3.cmml" xref="S6.SS1.SSS1.p1.1.m1.1.1.2.3.3">𝑓</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p1.1.m1.1c">\ln\frac{q_{f}}{p_{f}}</annotation></semantics></math> using kernel density estimators. The magnitude of this value can be large and lead to unstable training. We scale this value by <math id="S6.SS1.SSS1.p1.2.m2.1" class="ltx_Math" alttext="10^{-2}" display="inline"><semantics id="S6.SS1.SSS1.p1.2.m2.1a"><msup id="S6.SS1.SSS1.p1.2.m2.1.1" xref="S6.SS1.SSS1.p1.2.m2.1.1.cmml"><mn id="S6.SS1.SSS1.p1.2.m2.1.1.2" xref="S6.SS1.SSS1.p1.2.m2.1.1.2.cmml">10</mn><mrow id="S6.SS1.SSS1.p1.2.m2.1.1.3" xref="S6.SS1.SSS1.p1.2.m2.1.1.3.cmml"><mo id="S6.SS1.SSS1.p1.2.m2.1.1.3a" xref="S6.SS1.SSS1.p1.2.m2.1.1.3.cmml">−</mo><mn id="S6.SS1.SSS1.p1.2.m2.1.1.3.2" xref="S6.SS1.SSS1.p1.2.m2.1.1.3.2.cmml">2</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p1.2.m2.1b"><apply id="S6.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S6.SS1.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p1.2.m2.1.1.1.cmml" xref="S6.SS1.SSS1.p1.2.m2.1.1">superscript</csymbol><cn type="integer" id="S6.SS1.SSS1.p1.2.m2.1.1.2.cmml" xref="S6.SS1.SSS1.p1.2.m2.1.1.2">10</cn><apply id="S6.SS1.SSS1.p1.2.m2.1.1.3.cmml" xref="S6.SS1.SSS1.p1.2.m2.1.1.3"><minus id="S6.SS1.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S6.SS1.SSS1.p1.2.m2.1.1.3"></minus><cn type="integer" id="S6.SS1.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S6.SS1.SSS1.p1.2.m2.1.1.3.2">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p1.2.m2.1c">10^{-2}</annotation></semantics></math>. This was chosen empirically in order to match the magnitude of the MMD. Since we have <math id="S6.SS1.SSS1.p1.3.m3.1" class="ltx_Math" alttext="\lambda=10^{-2}" display="inline"><semantics id="S6.SS1.SSS1.p1.3.m3.1a"><mrow id="S6.SS1.SSS1.p1.3.m3.1.1" xref="S6.SS1.SSS1.p1.3.m3.1.1.cmml"><mi id="S6.SS1.SSS1.p1.3.m3.1.1.2" xref="S6.SS1.SSS1.p1.3.m3.1.1.2.cmml">λ</mi><mo id="S6.SS1.SSS1.p1.3.m3.1.1.1" xref="S6.SS1.SSS1.p1.3.m3.1.1.1.cmml">=</mo><msup id="S6.SS1.SSS1.p1.3.m3.1.1.3" xref="S6.SS1.SSS1.p1.3.m3.1.1.3.cmml"><mn id="S6.SS1.SSS1.p1.3.m3.1.1.3.2" xref="S6.SS1.SSS1.p1.3.m3.1.1.3.2.cmml">10</mn><mrow id="S6.SS1.SSS1.p1.3.m3.1.1.3.3" xref="S6.SS1.SSS1.p1.3.m3.1.1.3.3.cmml"><mo id="S6.SS1.SSS1.p1.3.m3.1.1.3.3a" xref="S6.SS1.SSS1.p1.3.m3.1.1.3.3.cmml">−</mo><mn id="S6.SS1.SSS1.p1.3.m3.1.1.3.3.2" xref="S6.SS1.SSS1.p1.3.m3.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p1.3.m3.1b"><apply id="S6.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S6.SS1.SSS1.p1.3.m3.1.1"><eq id="S6.SS1.SSS1.p1.3.m3.1.1.1.cmml" xref="S6.SS1.SSS1.p1.3.m3.1.1.1"></eq><ci id="S6.SS1.SSS1.p1.3.m3.1.1.2.cmml" xref="S6.SS1.SSS1.p1.3.m3.1.1.2">𝜆</ci><apply id="S6.SS1.SSS1.p1.3.m3.1.1.3.cmml" xref="S6.SS1.SSS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p1.3.m3.1.1.3.1.cmml" xref="S6.SS1.SSS1.p1.3.m3.1.1.3">superscript</csymbol><cn type="integer" id="S6.SS1.SSS1.p1.3.m3.1.1.3.2.cmml" xref="S6.SS1.SSS1.p1.3.m3.1.1.3.2">10</cn><apply id="S6.SS1.SSS1.p1.3.m3.1.1.3.3.cmml" xref="S6.SS1.SSS1.p1.3.m3.1.1.3.3"><minus id="S6.SS1.SSS1.p1.3.m3.1.1.3.3.1.cmml" xref="S6.SS1.SSS1.p1.3.m3.1.1.3.3"></minus><cn type="integer" id="S6.SS1.SSS1.p1.3.m3.1.1.3.3.2.cmml" xref="S6.SS1.SSS1.p1.3.m3.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p1.3.m3.1c">\lambda=10^{-2}</annotation></semantics></math> in our original loss and <math id="S6.SS1.SSS1.p1.4.m4.1" class="ltx_Math" alttext="r_{\text{reject}}(F)" display="inline"><semantics id="S6.SS1.SSS1.p1.4.m4.1a"><mrow id="S6.SS1.SSS1.p1.4.m4.1.2" xref="S6.SS1.SSS1.p1.4.m4.1.2.cmml"><msub id="S6.SS1.SSS1.p1.4.m4.1.2.2" xref="S6.SS1.SSS1.p1.4.m4.1.2.2.cmml"><mi id="S6.SS1.SSS1.p1.4.m4.1.2.2.2" xref="S6.SS1.SSS1.p1.4.m4.1.2.2.2.cmml">r</mi><mtext id="S6.SS1.SSS1.p1.4.m4.1.2.2.3" xref="S6.SS1.SSS1.p1.4.m4.1.2.2.3a.cmml">reject</mtext></msub><mo lspace="0em" rspace="0em" id="S6.SS1.SSS1.p1.4.m4.1.2.1" xref="S6.SS1.SSS1.p1.4.m4.1.2.1.cmml">​</mo><mrow id="S6.SS1.SSS1.p1.4.m4.1.2.3.2" xref="S6.SS1.SSS1.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S6.SS1.SSS1.p1.4.m4.1.2.3.2.1" xref="S6.SS1.SSS1.p1.4.m4.1.2.cmml">(</mo><mi id="S6.SS1.SSS1.p1.4.m4.1.1" xref="S6.SS1.SSS1.p1.4.m4.1.1.cmml">F</mi><mo stretchy="false" id="S6.SS1.SSS1.p1.4.m4.1.2.3.2.2" xref="S6.SS1.SSS1.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p1.4.m4.1b"><apply id="S6.SS1.SSS1.p1.4.m4.1.2.cmml" xref="S6.SS1.SSS1.p1.4.m4.1.2"><times id="S6.SS1.SSS1.p1.4.m4.1.2.1.cmml" xref="S6.SS1.SSS1.p1.4.m4.1.2.1"></times><apply id="S6.SS1.SSS1.p1.4.m4.1.2.2.cmml" xref="S6.SS1.SSS1.p1.4.m4.1.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p1.4.m4.1.2.2.1.cmml" xref="S6.SS1.SSS1.p1.4.m4.1.2.2">subscript</csymbol><ci id="S6.SS1.SSS1.p1.4.m4.1.2.2.2.cmml" xref="S6.SS1.SSS1.p1.4.m4.1.2.2.2">𝑟</ci><ci id="S6.SS1.SSS1.p1.4.m4.1.2.2.3a.cmml" xref="S6.SS1.SSS1.p1.4.m4.1.2.2.3"><mtext mathsize="70%" id="S6.SS1.SSS1.p1.4.m4.1.2.2.3.cmml" xref="S6.SS1.SSS1.p1.4.m4.1.2.2.3">reject</mtext></ci></apply><ci id="S6.SS1.SSS1.p1.4.m4.1.1.cmml" xref="S6.SS1.SSS1.p1.4.m4.1.1">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p1.4.m4.1c">r_{\text{reject}}(F)</annotation></semantics></math> is independent of <math id="S6.SS1.SSS1.p1.5.m5.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S6.SS1.SSS1.p1.5.m5.1a"><mi id="S6.SS1.SSS1.p1.5.m5.1.1" xref="S6.SS1.SSS1.p1.5.m5.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p1.5.m5.1b"><ci id="S6.SS1.SSS1.p1.5.m5.1.1.cmml" xref="S6.SS1.SSS1.p1.5.m5.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p1.5.m5.1c">F</annotation></semantics></math> and dependent only on the structure generation model we rewrite the loss gradient as</p>
<table id="S6.EGx10" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S6.Ex14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S6.Ex14.m1.3" class="ltx_Math" alttext="\displaystyle\nabla_{\theta}\mathcal{L}\approx 10^{-2}\bigg{(}\frac{1}{M}\sum_{j=1}^{m}(\ln\tilde{q}_{f}(\varphi(v_{j}^{\prime}))-\ln\tilde{p}_{f}(\varphi(v_{j}^{\prime})))\nabla_{\theta}\log q_{I}(v_{j}^{\prime})+\mathbf{1}_{(1,\infty)}(r_{\text{reject}})\bigg{)}" display="inline"><semantics id="S6.Ex14.m1.3a"><mrow id="S6.Ex14.m1.3.3" xref="S6.Ex14.m1.3.3.cmml"><mrow id="S6.Ex14.m1.3.3.3" xref="S6.Ex14.m1.3.3.3.cmml"><msub id="S6.Ex14.m1.3.3.3.1" xref="S6.Ex14.m1.3.3.3.1.cmml"><mo id="S6.Ex14.m1.3.3.3.1.2" xref="S6.Ex14.m1.3.3.3.1.2.cmml">∇</mo><mi id="S6.Ex14.m1.3.3.3.1.3" xref="S6.Ex14.m1.3.3.3.1.3.cmml">θ</mi></msub><mi class="ltx_font_mathcaligraphic" id="S6.Ex14.m1.3.3.3.2" xref="S6.Ex14.m1.3.3.3.2.cmml">ℒ</mi></mrow><mo id="S6.Ex14.m1.3.3.2" xref="S6.Ex14.m1.3.3.2.cmml">≈</mo><mrow id="S6.Ex14.m1.3.3.1" xref="S6.Ex14.m1.3.3.1.cmml"><msup id="S6.Ex14.m1.3.3.1.3" xref="S6.Ex14.m1.3.3.1.3.cmml"><mn id="S6.Ex14.m1.3.3.1.3.2" xref="S6.Ex14.m1.3.3.1.3.2.cmml">10</mn><mrow id="S6.Ex14.m1.3.3.1.3.3" xref="S6.Ex14.m1.3.3.1.3.3.cmml"><mo id="S6.Ex14.m1.3.3.1.3.3a" xref="S6.Ex14.m1.3.3.1.3.3.cmml">−</mo><mn id="S6.Ex14.m1.3.3.1.3.3.2" xref="S6.Ex14.m1.3.3.1.3.3.2.cmml">2</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S6.Ex14.m1.3.3.1.2" xref="S6.Ex14.m1.3.3.1.2.cmml">​</mo><mrow id="S6.Ex14.m1.3.3.1.1.1" xref="S6.Ex14.m1.3.3.1.1.1.1.cmml"><mo maxsize="210%" minsize="210%" id="S6.Ex14.m1.3.3.1.1.1.2" xref="S6.Ex14.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S6.Ex14.m1.3.3.1.1.1.1" xref="S6.Ex14.m1.3.3.1.1.1.1.cmml"><mrow id="S6.Ex14.m1.3.3.1.1.1.1.2" xref="S6.Ex14.m1.3.3.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S6.Ex14.m1.3.3.1.1.1.1.2.4" xref="S6.Ex14.m1.3.3.1.1.1.1.2.4.cmml"><mfrac id="S6.Ex14.m1.3.3.1.1.1.1.2.4a" xref="S6.Ex14.m1.3.3.1.1.1.1.2.4.cmml"><mn id="S6.Ex14.m1.3.3.1.1.1.1.2.4.2" xref="S6.Ex14.m1.3.3.1.1.1.1.2.4.2.cmml">1</mn><mi id="S6.Ex14.m1.3.3.1.1.1.1.2.4.3" xref="S6.Ex14.m1.3.3.1.1.1.1.2.4.3.cmml">M</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S6.Ex14.m1.3.3.1.1.1.1.2.3" xref="S6.Ex14.m1.3.3.1.1.1.1.2.3.cmml">​</mo><mrow id="S6.Ex14.m1.3.3.1.1.1.1.2.2" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.cmml"><mstyle displaystyle="true" id="S6.Ex14.m1.3.3.1.1.1.1.2.2.3" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.cmml"><munderover id="S6.Ex14.m1.3.3.1.1.1.1.2.2.3a" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.cmml"><mo movablelimits="false" id="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.2" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.3" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.3.cmml"><mi id="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.3.2" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.3.2.cmml">j</mi><mo id="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.3.1" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.3.3" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.3" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.3.cmml">m</mi></munderover></mstyle><mrow id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.cmml"><mrow id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">ln</mi><mo lspace="0.167em" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3a" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mover accent="true" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.2" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">q</mi><mo id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.1" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml">~</mo></mover><mi id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">f</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">φ</mi><mo lspace="0em" rspace="0em" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">v</mi><mi id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi><mo id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo stretchy="false" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">ln</mi><mo lspace="0.167em" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3a" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml">⁡</mo><msub id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml"><mover accent="true" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml"><mi id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2.2" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2.2.cmml">p</mi><mo id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2.1" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2.1.cmml">~</mo></mover><mi id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.3" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml">f</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml">​</mo><mrow id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.2" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml">φ</mi><mo lspace="0em" rspace="0em" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">​</mo><mrow id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.2" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><msubsup id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.2" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml">v</mi><mi id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.3" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml">j</mi><mo id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo stretchy="false" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.3" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.3" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.3" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.3.cmml">​</mo><mrow id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.cmml"><mrow id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1.cmml"><msub id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1.1" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1.1.cmml"><mo rspace="0.167em" id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1.1.2" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1.1.2.cmml">∇</mo><mi id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1.1.3" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1.1.3.cmml">θ</mi></msub><mi id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1.2" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4a" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.cmml">⁡</mo><msub id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.2" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.2.cmml"><mi id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.2.2" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.2.2.cmml">q</mi><mi id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.2.3" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.2.3.cmml">I</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.3a" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.3.cmml">​</mo><mrow id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.2" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1.cmml">(</mo><msubsup id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1.cmml"><mi id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1.2.2" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1.2.2.cmml">v</mi><mi id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1.2.3" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1.2.3.cmml">j</mi><mo id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1.3" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1.3.cmml">′</mo></msubsup><mo stretchy="false" id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.3" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S6.Ex14.m1.3.3.1.1.1.1.4" xref="S6.Ex14.m1.3.3.1.1.1.1.4.cmml">+</mo><mrow id="S6.Ex14.m1.3.3.1.1.1.1.3" xref="S6.Ex14.m1.3.3.1.1.1.1.3.cmml"><msub id="S6.Ex14.m1.3.3.1.1.1.1.3.3" xref="S6.Ex14.m1.3.3.1.1.1.1.3.3.cmml"><mn id="S6.Ex14.m1.3.3.1.1.1.1.3.3.2" xref="S6.Ex14.m1.3.3.1.1.1.1.3.3.2.cmml">𝟏</mn><mrow id="S6.Ex14.m1.2.2.2.4" xref="S6.Ex14.m1.2.2.2.3.cmml"><mo stretchy="false" id="S6.Ex14.m1.2.2.2.4.1" xref="S6.Ex14.m1.2.2.2.3.cmml">(</mo><mn id="S6.Ex14.m1.1.1.1.1" xref="S6.Ex14.m1.1.1.1.1.cmml">1</mn><mo id="S6.Ex14.m1.2.2.2.4.2" xref="S6.Ex14.m1.2.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S6.Ex14.m1.2.2.2.2" xref="S6.Ex14.m1.2.2.2.2.cmml">∞</mi><mo stretchy="false" id="S6.Ex14.m1.2.2.2.4.3" xref="S6.Ex14.m1.2.2.2.3.cmml">)</mo></mrow></msub><mo lspace="0em" rspace="0em" id="S6.Ex14.m1.3.3.1.1.1.1.3.2" xref="S6.Ex14.m1.3.3.1.1.1.1.3.2.cmml">​</mo><mrow id="S6.Ex14.m1.3.3.1.1.1.1.3.1.1" xref="S6.Ex14.m1.3.3.1.1.1.1.3.1.1.1.cmml"><mo stretchy="false" id="S6.Ex14.m1.3.3.1.1.1.1.3.1.1.2" xref="S6.Ex14.m1.3.3.1.1.1.1.3.1.1.1.cmml">(</mo><msub id="S6.Ex14.m1.3.3.1.1.1.1.3.1.1.1" xref="S6.Ex14.m1.3.3.1.1.1.1.3.1.1.1.cmml"><mi id="S6.Ex14.m1.3.3.1.1.1.1.3.1.1.1.2" xref="S6.Ex14.m1.3.3.1.1.1.1.3.1.1.1.2.cmml">r</mi><mtext id="S6.Ex14.m1.3.3.1.1.1.1.3.1.1.1.3" xref="S6.Ex14.m1.3.3.1.1.1.1.3.1.1.1.3a.cmml">reject</mtext></msub><mo stretchy="false" id="S6.Ex14.m1.3.3.1.1.1.1.3.1.1.3" xref="S6.Ex14.m1.3.3.1.1.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo maxsize="210%" minsize="210%" id="S6.Ex14.m1.3.3.1.1.1.3" xref="S6.Ex14.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex14.m1.3b"><apply id="S6.Ex14.m1.3.3.cmml" xref="S6.Ex14.m1.3.3"><approx id="S6.Ex14.m1.3.3.2.cmml" xref="S6.Ex14.m1.3.3.2"></approx><apply id="S6.Ex14.m1.3.3.3.cmml" xref="S6.Ex14.m1.3.3.3"><apply id="S6.Ex14.m1.3.3.3.1.cmml" xref="S6.Ex14.m1.3.3.3.1"><csymbol cd="ambiguous" id="S6.Ex14.m1.3.3.3.1.1.cmml" xref="S6.Ex14.m1.3.3.3.1">subscript</csymbol><ci id="S6.Ex14.m1.3.3.3.1.2.cmml" xref="S6.Ex14.m1.3.3.3.1.2">∇</ci><ci id="S6.Ex14.m1.3.3.3.1.3.cmml" xref="S6.Ex14.m1.3.3.3.1.3">𝜃</ci></apply><ci id="S6.Ex14.m1.3.3.3.2.cmml" xref="S6.Ex14.m1.3.3.3.2">ℒ</ci></apply><apply id="S6.Ex14.m1.3.3.1.cmml" xref="S6.Ex14.m1.3.3.1"><times id="S6.Ex14.m1.3.3.1.2.cmml" xref="S6.Ex14.m1.3.3.1.2"></times><apply id="S6.Ex14.m1.3.3.1.3.cmml" xref="S6.Ex14.m1.3.3.1.3"><csymbol cd="ambiguous" id="S6.Ex14.m1.3.3.1.3.1.cmml" xref="S6.Ex14.m1.3.3.1.3">superscript</csymbol><cn type="integer" id="S6.Ex14.m1.3.3.1.3.2.cmml" xref="S6.Ex14.m1.3.3.1.3.2">10</cn><apply id="S6.Ex14.m1.3.3.1.3.3.cmml" xref="S6.Ex14.m1.3.3.1.3.3"><minus id="S6.Ex14.m1.3.3.1.3.3.1.cmml" xref="S6.Ex14.m1.3.3.1.3.3"></minus><cn type="integer" id="S6.Ex14.m1.3.3.1.3.3.2.cmml" xref="S6.Ex14.m1.3.3.1.3.3.2">2</cn></apply></apply><apply id="S6.Ex14.m1.3.3.1.1.1.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1"><plus id="S6.Ex14.m1.3.3.1.1.1.1.4.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.4"></plus><apply id="S6.Ex14.m1.3.3.1.1.1.1.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2"><times id="S6.Ex14.m1.3.3.1.1.1.1.2.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.3"></times><apply id="S6.Ex14.m1.3.3.1.1.1.1.2.4.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.4"><divide id="S6.Ex14.m1.3.3.1.1.1.1.2.4.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.4"></divide><cn type="integer" id="S6.Ex14.m1.3.3.1.1.1.1.2.4.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.4.2">1</cn><ci id="S6.Ex14.m1.3.3.1.1.1.1.2.4.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.4.3">𝑀</ci></apply><apply id="S6.Ex14.m1.3.3.1.1.1.1.2.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2"><apply id="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.3">superscript</csymbol><apply id="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.3">subscript</csymbol><sum id="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.2"></sum><apply id="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.3"><eq id="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.3.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.3.1"></eq><ci id="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.3.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.3.2">𝑗</ci><cn type="integer" id="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.3.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.2.3.3">1</cn></apply></apply><ci id="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.3.3">𝑚</ci></apply><apply id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2"><times id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.3"></times><apply id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1"><minus id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.3"></minus><apply id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><times id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3"><ln id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1"></ln><apply id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><apply id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2"><ci id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.1">~</ci><ci id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.2">𝑞</ci></apply><ci id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑓</ci></apply></apply><apply id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝜑</ci><apply id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑣</ci><ci id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">′</ci></apply></apply></apply><apply id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2"><times id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2"></times><apply id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3"><ln id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.1"></ln><apply id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2">subscript</csymbol><apply id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2"><ci id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2.1">~</ci><ci id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2.2">𝑝</ci></apply><ci id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.3">𝑓</ci></apply></apply><apply id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1"><times id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2"></times><ci id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3">𝜑</ci><apply id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1">superscript</csymbol><apply id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1">subscript</csymbol><ci id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.2">𝑣</ci><ci id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3">′</ci></apply></apply></apply></apply><apply id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4"><apply id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1"><apply id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1.1"><csymbol cd="ambiguous" id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1.1.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1.1">subscript</csymbol><ci id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1.1.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1.1.2">∇</ci><ci id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1.1.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1.1.3">𝜃</ci></apply><log id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.1.2"></log></apply><apply id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.2"><csymbol cd="ambiguous" id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.2.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.2">subscript</csymbol><ci id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.2.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.2.2">𝑞</ci><ci id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.2.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.4.2.3">𝐼</ci></apply></apply><apply id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1"><csymbol cd="ambiguous" id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1">superscript</csymbol><apply id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1"><csymbol cd="ambiguous" id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1.2.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1">subscript</csymbol><ci id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1.2.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1.2.2">𝑣</ci><ci id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1.2.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1.2.3">𝑗</ci></apply><ci id="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.2.2.2.2.1.1.3">′</ci></apply></apply></apply></apply><apply id="S6.Ex14.m1.3.3.1.1.1.1.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.3"><times id="S6.Ex14.m1.3.3.1.1.1.1.3.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.3.2"></times><apply id="S6.Ex14.m1.3.3.1.1.1.1.3.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S6.Ex14.m1.3.3.1.1.1.1.3.3.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.3.3">subscript</csymbol><cn type="integer" id="S6.Ex14.m1.3.3.1.1.1.1.3.3.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.3.3.2">1</cn><interval closure="open" id="S6.Ex14.m1.2.2.2.3.cmml" xref="S6.Ex14.m1.2.2.2.4"><cn type="integer" id="S6.Ex14.m1.1.1.1.1.cmml" xref="S6.Ex14.m1.1.1.1.1">1</cn><infinity id="S6.Ex14.m1.2.2.2.2.cmml" xref="S6.Ex14.m1.2.2.2.2"></infinity></interval></apply><apply id="S6.Ex14.m1.3.3.1.1.1.1.3.1.1.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="S6.Ex14.m1.3.3.1.1.1.1.3.1.1.1.1.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.3.1.1">subscript</csymbol><ci id="S6.Ex14.m1.3.3.1.1.1.1.3.1.1.1.2.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.3.1.1.1.2">𝑟</ci><ci id="S6.Ex14.m1.3.3.1.1.1.1.3.1.1.1.3a.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.3.1.1.1.3"><mtext mathsize="70%" id="S6.Ex14.m1.3.3.1.1.1.1.3.1.1.1.3.cmml" xref="S6.Ex14.m1.3.3.1.1.1.1.3.1.1.1.3">reject</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex14.m1.3c">\displaystyle\nabla_{\theta}\mathcal{L}\approx 10^{-2}\bigg{(}\frac{1}{M}\sum_{j=1}^{m}(\ln\tilde{q}_{f}(\varphi(v_{j}^{\prime}))-\ln\tilde{p}_{f}(\varphi(v_{j}^{\prime})))\nabla_{\theta}\log q_{I}(v_{j}^{\prime})+\mathbf{1}_{(1,\infty)}(r_{\text{reject}})\bigg{)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S6.SS1.SSS1.p1.7" class="ltx_p">where <math id="S6.SS1.SSS1.p1.6.m1.1" class="ltx_Math" alttext="r_{\text{reject}}" display="inline"><semantics id="S6.SS1.SSS1.p1.6.m1.1a"><msub id="S6.SS1.SSS1.p1.6.m1.1.1" xref="S6.SS1.SSS1.p1.6.m1.1.1.cmml"><mi id="S6.SS1.SSS1.p1.6.m1.1.1.2" xref="S6.SS1.SSS1.p1.6.m1.1.1.2.cmml">r</mi><mtext id="S6.SS1.SSS1.p1.6.m1.1.1.3" xref="S6.SS1.SSS1.p1.6.m1.1.1.3a.cmml">reject</mtext></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p1.6.m1.1b"><apply id="S6.SS1.SSS1.p1.6.m1.1.1.cmml" xref="S6.SS1.SSS1.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p1.6.m1.1.1.1.cmml" xref="S6.SS1.SSS1.p1.6.m1.1.1">subscript</csymbol><ci id="S6.SS1.SSS1.p1.6.m1.1.1.2.cmml" xref="S6.SS1.SSS1.p1.6.m1.1.1.2">𝑟</ci><ci id="S6.SS1.SSS1.p1.6.m1.1.1.3a.cmml" xref="S6.SS1.SSS1.p1.6.m1.1.1.3"><mtext mathsize="70%" id="S6.SS1.SSS1.p1.6.m1.1.1.3.cmml" xref="S6.SS1.SSS1.p1.6.m1.1.1.3">reject</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p1.6.m1.1c">r_{\text{reject}}</annotation></semantics></math> is the rejection rate (rejections per successful sample) of the model when sampling the <math id="S6.SS1.SSS1.p1.7.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S6.SS1.SSS1.p1.7.m2.1a"><mi id="S6.SS1.SSS1.p1.7.m2.1.1" xref="S6.SS1.SSS1.p1.7.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p1.7.m2.1b"><ci id="S6.SS1.SSS1.p1.7.m2.1.1.cmml" xref="S6.SS1.SSS1.p1.7.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p1.7.m2.1c">m</annotation></semantics></math> images in the batch.</p>
</div>
</section>
<section id="S6.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.1.2 </span>Multi-MNIST</h4>

<div id="S6.SS1.SSS2.p1" class="ltx_para ltx_noindent">
<p id="S6.SS1.SSS2.p1.1" class="ltx_p"><span id="S6.SS1.SSS2.p1.1.1" class="ltx_text ltx_font_bold">Feature Network Architecture:</span> We use a ResNet architecture consisting of 6 residual blocks and 3 fully connected layers. We use the standard residual block consisting of two 3x3 convolutions with batch normalization and leaky relu activations. Average pooling is performed before passing the output to the fully connected layers. The final fully-connected layer outputs a vector of dimension 10 which corresponding to the logits for detecting whether a given digit class is in the scene. Since the Multi-MNIST images are grayscale, we duplicate them across channels to create a 3-channel image. The Multi-MNIST images are 256x256. The features used for training our structure generation model come from the average pool layer and the first two fully connected layers.</p>
</div>
<div id="S6.SS1.SSS2.p2" class="ltx_para ltx_noindent">
<p id="S6.SS1.SSS2.p2.1" class="ltx_p"><span id="S6.SS1.SSS2.p2.1.1" class="ltx_text ltx_font_bold">Structure Generation Model Architecture:</span> The logits used for sampling are generated in an autoregressive fashion using an LSTM. The input of the LSTM is a one-hot encoding of the previous rule index (70 dimensional, in the Multi-MNIST case). We used a hidden dimension of 50 for the LSTM. The embedding of the one-hot encodings are computing using a fully connected layer. The output of the LSTM is produced by a fully connected layer which takes the hidden state of the LSTM as input and produces the logits used for rule sampling.</p>
</div>
<div id="S6.SS1.SSS2.p3" class="ltx_para ltx_noindent">
<p id="S6.SS1.SSS2.p3.3" class="ltx_p"><span id="S6.SS1.SSS2.p3.3.1" class="ltx_text ltx_font_bold">Feature Network Training:</span> We first sample 5000 prior structures and their corresponding images, then train our feature network until we reach 75% accuracy on digit detections (around 10 epochs). We use the sigmoid cross entropy loss, and use the ADAM optimizer with learning rate <math id="S6.SS1.SSS2.p3.1.m1.1" class="ltx_Math" alttext="\epsilon=10^{-3}" display="inline"><semantics id="S6.SS1.SSS2.p3.1.m1.1a"><mrow id="S6.SS1.SSS2.p3.1.m1.1.1" xref="S6.SS1.SSS2.p3.1.m1.1.1.cmml"><mi id="S6.SS1.SSS2.p3.1.m1.1.1.2" xref="S6.SS1.SSS2.p3.1.m1.1.1.2.cmml">ϵ</mi><mo id="S6.SS1.SSS2.p3.1.m1.1.1.1" xref="S6.SS1.SSS2.p3.1.m1.1.1.1.cmml">=</mo><msup id="S6.SS1.SSS2.p3.1.m1.1.1.3" xref="S6.SS1.SSS2.p3.1.m1.1.1.3.cmml"><mn id="S6.SS1.SSS2.p3.1.m1.1.1.3.2" xref="S6.SS1.SSS2.p3.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.SS1.SSS2.p3.1.m1.1.1.3.3" xref="S6.SS1.SSS2.p3.1.m1.1.1.3.3.cmml"><mo id="S6.SS1.SSS2.p3.1.m1.1.1.3.3a" xref="S6.SS1.SSS2.p3.1.m1.1.1.3.3.cmml">−</mo><mn id="S6.SS1.SSS2.p3.1.m1.1.1.3.3.2" xref="S6.SS1.SSS2.p3.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p3.1.m1.1b"><apply id="S6.SS1.SSS2.p3.1.m1.1.1.cmml" xref="S6.SS1.SSS2.p3.1.m1.1.1"><eq id="S6.SS1.SSS2.p3.1.m1.1.1.1.cmml" xref="S6.SS1.SSS2.p3.1.m1.1.1.1"></eq><ci id="S6.SS1.SSS2.p3.1.m1.1.1.2.cmml" xref="S6.SS1.SSS2.p3.1.m1.1.1.2">italic-ϵ</ci><apply id="S6.SS1.SSS2.p3.1.m1.1.1.3.cmml" xref="S6.SS1.SSS2.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p3.1.m1.1.1.3.1.cmml" xref="S6.SS1.SSS2.p3.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.SS1.SSS2.p3.1.m1.1.1.3.2.cmml" xref="S6.SS1.SSS2.p3.1.m1.1.1.3.2">10</cn><apply id="S6.SS1.SSS2.p3.1.m1.1.1.3.3.cmml" xref="S6.SS1.SSS2.p3.1.m1.1.1.3.3"><minus id="S6.SS1.SSS2.p3.1.m1.1.1.3.3.1.cmml" xref="S6.SS1.SSS2.p3.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.SS1.SSS2.p3.1.m1.1.1.3.3.2.cmml" xref="S6.SS1.SSS2.p3.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p3.1.m1.1c">\epsilon=10^{-3}</annotation></semantics></math>, <math id="S6.SS1.SSS2.p3.2.m2.1" class="ltx_Math" alttext="\beta_{1}=0.9" display="inline"><semantics id="S6.SS1.SSS2.p3.2.m2.1a"><mrow id="S6.SS1.SSS2.p3.2.m2.1.1" xref="S6.SS1.SSS2.p3.2.m2.1.1.cmml"><msub id="S6.SS1.SSS2.p3.2.m2.1.1.2" xref="S6.SS1.SSS2.p3.2.m2.1.1.2.cmml"><mi id="S6.SS1.SSS2.p3.2.m2.1.1.2.2" xref="S6.SS1.SSS2.p3.2.m2.1.1.2.2.cmml">β</mi><mn id="S6.SS1.SSS2.p3.2.m2.1.1.2.3" xref="S6.SS1.SSS2.p3.2.m2.1.1.2.3.cmml">1</mn></msub><mo id="S6.SS1.SSS2.p3.2.m2.1.1.1" xref="S6.SS1.SSS2.p3.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS2.p3.2.m2.1.1.3" xref="S6.SS1.SSS2.p3.2.m2.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p3.2.m2.1b"><apply id="S6.SS1.SSS2.p3.2.m2.1.1.cmml" xref="S6.SS1.SSS2.p3.2.m2.1.1"><eq id="S6.SS1.SSS2.p3.2.m2.1.1.1.cmml" xref="S6.SS1.SSS2.p3.2.m2.1.1.1"></eq><apply id="S6.SS1.SSS2.p3.2.m2.1.1.2.cmml" xref="S6.SS1.SSS2.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p3.2.m2.1.1.2.1.cmml" xref="S6.SS1.SSS2.p3.2.m2.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS2.p3.2.m2.1.1.2.2.cmml" xref="S6.SS1.SSS2.p3.2.m2.1.1.2.2">𝛽</ci><cn type="integer" id="S6.SS1.SSS2.p3.2.m2.1.1.2.3.cmml" xref="S6.SS1.SSS2.p3.2.m2.1.1.2.3">1</cn></apply><cn type="float" id="S6.SS1.SSS2.p3.2.m2.1.1.3.cmml" xref="S6.SS1.SSS2.p3.2.m2.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p3.2.m2.1c">\beta_{1}=0.9</annotation></semantics></math> and <math id="S6.SS1.SSS2.p3.3.m3.1" class="ltx_Math" alttext="\beta_{2}=0.999" display="inline"><semantics id="S6.SS1.SSS2.p3.3.m3.1a"><mrow id="S6.SS1.SSS2.p3.3.m3.1.1" xref="S6.SS1.SSS2.p3.3.m3.1.1.cmml"><msub id="S6.SS1.SSS2.p3.3.m3.1.1.2" xref="S6.SS1.SSS2.p3.3.m3.1.1.2.cmml"><mi id="S6.SS1.SSS2.p3.3.m3.1.1.2.2" xref="S6.SS1.SSS2.p3.3.m3.1.1.2.2.cmml">β</mi><mn id="S6.SS1.SSS2.p3.3.m3.1.1.2.3" xref="S6.SS1.SSS2.p3.3.m3.1.1.2.3.cmml">2</mn></msub><mo id="S6.SS1.SSS2.p3.3.m3.1.1.1" xref="S6.SS1.SSS2.p3.3.m3.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS2.p3.3.m3.1.1.3" xref="S6.SS1.SSS2.p3.3.m3.1.1.3.cmml">0.999</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p3.3.m3.1b"><apply id="S6.SS1.SSS2.p3.3.m3.1.1.cmml" xref="S6.SS1.SSS2.p3.3.m3.1.1"><eq id="S6.SS1.SSS2.p3.3.m3.1.1.1.cmml" xref="S6.SS1.SSS2.p3.3.m3.1.1.1"></eq><apply id="S6.SS1.SSS2.p3.3.m3.1.1.2.cmml" xref="S6.SS1.SSS2.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p3.3.m3.1.1.2.1.cmml" xref="S6.SS1.SSS2.p3.3.m3.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS2.p3.3.m3.1.1.2.2.cmml" xref="S6.SS1.SSS2.p3.3.m3.1.1.2.2">𝛽</ci><cn type="integer" id="S6.SS1.SSS2.p3.3.m3.1.1.2.3.cmml" xref="S6.SS1.SSS2.p3.3.m3.1.1.2.3">2</cn></apply><cn type="float" id="S6.SS1.SSS2.p3.3.m3.1.1.3.cmml" xref="S6.SS1.SSS2.p3.3.m3.1.1.3">0.999</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p3.3.m3.1c">\beta_{2}=0.999</annotation></semantics></math> with a batch size of 50.</p>
</div>
<div id="S6.SS1.SSS2.p4" class="ltx_para ltx_noindent">
<p id="S6.SS1.SSS2.p4.3" class="ltx_p"><span id="S6.SS1.SSS2.p4.3.1" class="ltx_text ltx_font_bold">Structure Generation Model Pre-Training:</span> Using the 5000 prior structures generated for training the feature network, we train our structure generation model to minimize the negative log likelihood of the generated structures. This is done for 10 epochs using the ADAM optimizer with learning rate <math id="S6.SS1.SSS2.p4.1.m1.1" class="ltx_Math" alttext="\epsilon=10^{-3}" display="inline"><semantics id="S6.SS1.SSS2.p4.1.m1.1a"><mrow id="S6.SS1.SSS2.p4.1.m1.1.1" xref="S6.SS1.SSS2.p4.1.m1.1.1.cmml"><mi id="S6.SS1.SSS2.p4.1.m1.1.1.2" xref="S6.SS1.SSS2.p4.1.m1.1.1.2.cmml">ϵ</mi><mo id="S6.SS1.SSS2.p4.1.m1.1.1.1" xref="S6.SS1.SSS2.p4.1.m1.1.1.1.cmml">=</mo><msup id="S6.SS1.SSS2.p4.1.m1.1.1.3" xref="S6.SS1.SSS2.p4.1.m1.1.1.3.cmml"><mn id="S6.SS1.SSS2.p4.1.m1.1.1.3.2" xref="S6.SS1.SSS2.p4.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.SS1.SSS2.p4.1.m1.1.1.3.3" xref="S6.SS1.SSS2.p4.1.m1.1.1.3.3.cmml"><mo id="S6.SS1.SSS2.p4.1.m1.1.1.3.3a" xref="S6.SS1.SSS2.p4.1.m1.1.1.3.3.cmml">−</mo><mn id="S6.SS1.SSS2.p4.1.m1.1.1.3.3.2" xref="S6.SS1.SSS2.p4.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p4.1.m1.1b"><apply id="S6.SS1.SSS2.p4.1.m1.1.1.cmml" xref="S6.SS1.SSS2.p4.1.m1.1.1"><eq id="S6.SS1.SSS2.p4.1.m1.1.1.1.cmml" xref="S6.SS1.SSS2.p4.1.m1.1.1.1"></eq><ci id="S6.SS1.SSS2.p4.1.m1.1.1.2.cmml" xref="S6.SS1.SSS2.p4.1.m1.1.1.2">italic-ϵ</ci><apply id="S6.SS1.SSS2.p4.1.m1.1.1.3.cmml" xref="S6.SS1.SSS2.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p4.1.m1.1.1.3.1.cmml" xref="S6.SS1.SSS2.p4.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.SS1.SSS2.p4.1.m1.1.1.3.2.cmml" xref="S6.SS1.SSS2.p4.1.m1.1.1.3.2">10</cn><apply id="S6.SS1.SSS2.p4.1.m1.1.1.3.3.cmml" xref="S6.SS1.SSS2.p4.1.m1.1.1.3.3"><minus id="S6.SS1.SSS2.p4.1.m1.1.1.3.3.1.cmml" xref="S6.SS1.SSS2.p4.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.SS1.SSS2.p4.1.m1.1.1.3.3.2.cmml" xref="S6.SS1.SSS2.p4.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p4.1.m1.1c">\epsilon=10^{-3}</annotation></semantics></math>, <math id="S6.SS1.SSS2.p4.2.m2.1" class="ltx_Math" alttext="\beta_{1}=0.9" display="inline"><semantics id="S6.SS1.SSS2.p4.2.m2.1a"><mrow id="S6.SS1.SSS2.p4.2.m2.1.1" xref="S6.SS1.SSS2.p4.2.m2.1.1.cmml"><msub id="S6.SS1.SSS2.p4.2.m2.1.1.2" xref="S6.SS1.SSS2.p4.2.m2.1.1.2.cmml"><mi id="S6.SS1.SSS2.p4.2.m2.1.1.2.2" xref="S6.SS1.SSS2.p4.2.m2.1.1.2.2.cmml">β</mi><mn id="S6.SS1.SSS2.p4.2.m2.1.1.2.3" xref="S6.SS1.SSS2.p4.2.m2.1.1.2.3.cmml">1</mn></msub><mo id="S6.SS1.SSS2.p4.2.m2.1.1.1" xref="S6.SS1.SSS2.p4.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS2.p4.2.m2.1.1.3" xref="S6.SS1.SSS2.p4.2.m2.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p4.2.m2.1b"><apply id="S6.SS1.SSS2.p4.2.m2.1.1.cmml" xref="S6.SS1.SSS2.p4.2.m2.1.1"><eq id="S6.SS1.SSS2.p4.2.m2.1.1.1.cmml" xref="S6.SS1.SSS2.p4.2.m2.1.1.1"></eq><apply id="S6.SS1.SSS2.p4.2.m2.1.1.2.cmml" xref="S6.SS1.SSS2.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p4.2.m2.1.1.2.1.cmml" xref="S6.SS1.SSS2.p4.2.m2.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS2.p4.2.m2.1.1.2.2.cmml" xref="S6.SS1.SSS2.p4.2.m2.1.1.2.2">𝛽</ci><cn type="integer" id="S6.SS1.SSS2.p4.2.m2.1.1.2.3.cmml" xref="S6.SS1.SSS2.p4.2.m2.1.1.2.3">1</cn></apply><cn type="float" id="S6.SS1.SSS2.p4.2.m2.1.1.3.cmml" xref="S6.SS1.SSS2.p4.2.m2.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p4.2.m2.1c">\beta_{1}=0.9</annotation></semantics></math> and <math id="S6.SS1.SSS2.p4.3.m3.1" class="ltx_Math" alttext="\beta_{2}=0.999" display="inline"><semantics id="S6.SS1.SSS2.p4.3.m3.1a"><mrow id="S6.SS1.SSS2.p4.3.m3.1.1" xref="S6.SS1.SSS2.p4.3.m3.1.1.cmml"><msub id="S6.SS1.SSS2.p4.3.m3.1.1.2" xref="S6.SS1.SSS2.p4.3.m3.1.1.2.cmml"><mi id="S6.SS1.SSS2.p4.3.m3.1.1.2.2" xref="S6.SS1.SSS2.p4.3.m3.1.1.2.2.cmml">β</mi><mn id="S6.SS1.SSS2.p4.3.m3.1.1.2.3" xref="S6.SS1.SSS2.p4.3.m3.1.1.2.3.cmml">2</mn></msub><mo id="S6.SS1.SSS2.p4.3.m3.1.1.1" xref="S6.SS1.SSS2.p4.3.m3.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS2.p4.3.m3.1.1.3" xref="S6.SS1.SSS2.p4.3.m3.1.1.3.cmml">0.999</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p4.3.m3.1b"><apply id="S6.SS1.SSS2.p4.3.m3.1.1.cmml" xref="S6.SS1.SSS2.p4.3.m3.1.1"><eq id="S6.SS1.SSS2.p4.3.m3.1.1.1.cmml" xref="S6.SS1.SSS2.p4.3.m3.1.1.1"></eq><apply id="S6.SS1.SSS2.p4.3.m3.1.1.2.cmml" xref="S6.SS1.SSS2.p4.3.m3.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p4.3.m3.1.1.2.1.cmml" xref="S6.SS1.SSS2.p4.3.m3.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS2.p4.3.m3.1.1.2.2.cmml" xref="S6.SS1.SSS2.p4.3.m3.1.1.2.2">𝛽</ci><cn type="integer" id="S6.SS1.SSS2.p4.3.m3.1.1.2.3.cmml" xref="S6.SS1.SSS2.p4.3.m3.1.1.2.3">2</cn></apply><cn type="float" id="S6.SS1.SSS2.p4.3.m3.1.1.3.cmml" xref="S6.SS1.SSS2.p4.3.m3.1.1.3">0.999</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p4.3.m3.1c">\beta_{2}=0.999</annotation></semantics></math> with a batch size of 100.</p>
</div>
<div id="S6.SS1.SSS2.p5" class="ltx_para ltx_noindent">
<p id="S6.SS1.SSS2.p5.6" class="ltx_p"><span id="S6.SS1.SSS2.p5.6.1" class="ltx_text ltx_font_bold">Structure Generation Model Training:</span> We train using 5000 target images. We use a batch size of <math id="S6.SS1.SSS2.p5.1.m1.1" class="ltx_Math" alttext="m=500" display="inline"><semantics id="S6.SS1.SSS2.p5.1.m1.1a"><mrow id="S6.SS1.SSS2.p5.1.m1.1.1" xref="S6.SS1.SSS2.p5.1.m1.1.1.cmml"><mi id="S6.SS1.SSS2.p5.1.m1.1.1.2" xref="S6.SS1.SSS2.p5.1.m1.1.1.2.cmml">m</mi><mo id="S6.SS1.SSS2.p5.1.m1.1.1.1" xref="S6.SS1.SSS2.p5.1.m1.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS2.p5.1.m1.1.1.3" xref="S6.SS1.SSS2.p5.1.m1.1.1.3.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p5.1.m1.1b"><apply id="S6.SS1.SSS2.p5.1.m1.1.1.cmml" xref="S6.SS1.SSS2.p5.1.m1.1.1"><eq id="S6.SS1.SSS2.p5.1.m1.1.1.1.cmml" xref="S6.SS1.SSS2.p5.1.m1.1.1.1"></eq><ci id="S6.SS1.SSS2.p5.1.m1.1.1.2.cmml" xref="S6.SS1.SSS2.p5.1.m1.1.1.2">𝑚</ci><cn type="integer" id="S6.SS1.SSS2.p5.1.m1.1.1.3.cmml" xref="S6.SS1.SSS2.p5.1.m1.1.1.3">500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p5.1.m1.1c">m=500</annotation></semantics></math> and <math id="S6.SS1.SSS2.p5.2.m2.1" class="ltx_Math" alttext="l=500" display="inline"><semantics id="S6.SS1.SSS2.p5.2.m2.1a"><mrow id="S6.SS1.SSS2.p5.2.m2.1.1" xref="S6.SS1.SSS2.p5.2.m2.1.1.cmml"><mi id="S6.SS1.SSS2.p5.2.m2.1.1.2" xref="S6.SS1.SSS2.p5.2.m2.1.1.2.cmml">l</mi><mo id="S6.SS1.SSS2.p5.2.m2.1.1.1" xref="S6.SS1.SSS2.p5.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS2.p5.2.m2.1.1.3" xref="S6.SS1.SSS2.p5.2.m2.1.1.3.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p5.2.m2.1b"><apply id="S6.SS1.SSS2.p5.2.m2.1.1.cmml" xref="S6.SS1.SSS2.p5.2.m2.1.1"><eq id="S6.SS1.SSS2.p5.2.m2.1.1.1.cmml" xref="S6.SS1.SSS2.p5.2.m2.1.1.1"></eq><ci id="S6.SS1.SSS2.p5.2.m2.1.1.2.cmml" xref="S6.SS1.SSS2.p5.2.m2.1.1.2">𝑙</ci><cn type="integer" id="S6.SS1.SSS2.p5.2.m2.1.1.3.cmml" xref="S6.SS1.SSS2.p5.2.m2.1.1.3">500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p5.2.m2.1c">l=500</annotation></semantics></math> for both the generated and real images. We train for 20 epochs. We use the ADAM optimizer with a learning rate of <math id="S6.SS1.SSS2.p5.3.m3.1" class="ltx_Math" alttext="\epsilon=10^{-4}" display="inline"><semantics id="S6.SS1.SSS2.p5.3.m3.1a"><mrow id="S6.SS1.SSS2.p5.3.m3.1.1" xref="S6.SS1.SSS2.p5.3.m3.1.1.cmml"><mi id="S6.SS1.SSS2.p5.3.m3.1.1.2" xref="S6.SS1.SSS2.p5.3.m3.1.1.2.cmml">ϵ</mi><mo id="S6.SS1.SSS2.p5.3.m3.1.1.1" xref="S6.SS1.SSS2.p5.3.m3.1.1.1.cmml">=</mo><msup id="S6.SS1.SSS2.p5.3.m3.1.1.3" xref="S6.SS1.SSS2.p5.3.m3.1.1.3.cmml"><mn id="S6.SS1.SSS2.p5.3.m3.1.1.3.2" xref="S6.SS1.SSS2.p5.3.m3.1.1.3.2.cmml">10</mn><mrow id="S6.SS1.SSS2.p5.3.m3.1.1.3.3" xref="S6.SS1.SSS2.p5.3.m3.1.1.3.3.cmml"><mo id="S6.SS1.SSS2.p5.3.m3.1.1.3.3a" xref="S6.SS1.SSS2.p5.3.m3.1.1.3.3.cmml">−</mo><mn id="S6.SS1.SSS2.p5.3.m3.1.1.3.3.2" xref="S6.SS1.SSS2.p5.3.m3.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p5.3.m3.1b"><apply id="S6.SS1.SSS2.p5.3.m3.1.1.cmml" xref="S6.SS1.SSS2.p5.3.m3.1.1"><eq id="S6.SS1.SSS2.p5.3.m3.1.1.1.cmml" xref="S6.SS1.SSS2.p5.3.m3.1.1.1"></eq><ci id="S6.SS1.SSS2.p5.3.m3.1.1.2.cmml" xref="S6.SS1.SSS2.p5.3.m3.1.1.2">italic-ϵ</ci><apply id="S6.SS1.SSS2.p5.3.m3.1.1.3.cmml" xref="S6.SS1.SSS2.p5.3.m3.1.1.3"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p5.3.m3.1.1.3.1.cmml" xref="S6.SS1.SSS2.p5.3.m3.1.1.3">superscript</csymbol><cn type="integer" id="S6.SS1.SSS2.p5.3.m3.1.1.3.2.cmml" xref="S6.SS1.SSS2.p5.3.m3.1.1.3.2">10</cn><apply id="S6.SS1.SSS2.p5.3.m3.1.1.3.3.cmml" xref="S6.SS1.SSS2.p5.3.m3.1.1.3.3"><minus id="S6.SS1.SSS2.p5.3.m3.1.1.3.3.1.cmml" xref="S6.SS1.SSS2.p5.3.m3.1.1.3.3"></minus><cn type="integer" id="S6.SS1.SSS2.p5.3.m3.1.1.3.3.2.cmml" xref="S6.SS1.SSS2.p5.3.m3.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p5.3.m3.1c">\epsilon=10^{-4}</annotation></semantics></math>, <math id="S6.SS1.SSS2.p5.4.m4.1" class="ltx_Math" alttext="\beta_{1}=0.9" display="inline"><semantics id="S6.SS1.SSS2.p5.4.m4.1a"><mrow id="S6.SS1.SSS2.p5.4.m4.1.1" xref="S6.SS1.SSS2.p5.4.m4.1.1.cmml"><msub id="S6.SS1.SSS2.p5.4.m4.1.1.2" xref="S6.SS1.SSS2.p5.4.m4.1.1.2.cmml"><mi id="S6.SS1.SSS2.p5.4.m4.1.1.2.2" xref="S6.SS1.SSS2.p5.4.m4.1.1.2.2.cmml">β</mi><mn id="S6.SS1.SSS2.p5.4.m4.1.1.2.3" xref="S6.SS1.SSS2.p5.4.m4.1.1.2.3.cmml">1</mn></msub><mo id="S6.SS1.SSS2.p5.4.m4.1.1.1" xref="S6.SS1.SSS2.p5.4.m4.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS2.p5.4.m4.1.1.3" xref="S6.SS1.SSS2.p5.4.m4.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p5.4.m4.1b"><apply id="S6.SS1.SSS2.p5.4.m4.1.1.cmml" xref="S6.SS1.SSS2.p5.4.m4.1.1"><eq id="S6.SS1.SSS2.p5.4.m4.1.1.1.cmml" xref="S6.SS1.SSS2.p5.4.m4.1.1.1"></eq><apply id="S6.SS1.SSS2.p5.4.m4.1.1.2.cmml" xref="S6.SS1.SSS2.p5.4.m4.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p5.4.m4.1.1.2.1.cmml" xref="S6.SS1.SSS2.p5.4.m4.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS2.p5.4.m4.1.1.2.2.cmml" xref="S6.SS1.SSS2.p5.4.m4.1.1.2.2">𝛽</ci><cn type="integer" id="S6.SS1.SSS2.p5.4.m4.1.1.2.3.cmml" xref="S6.SS1.SSS2.p5.4.m4.1.1.2.3">1</cn></apply><cn type="float" id="S6.SS1.SSS2.p5.4.m4.1.1.3.cmml" xref="S6.SS1.SSS2.p5.4.m4.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p5.4.m4.1c">\beta_{1}=0.9</annotation></semantics></math> and <math id="S6.SS1.SSS2.p5.5.m5.1" class="ltx_Math" alttext="\beta_{2}=0.999" display="inline"><semantics id="S6.SS1.SSS2.p5.5.m5.1a"><mrow id="S6.SS1.SSS2.p5.5.m5.1.1" xref="S6.SS1.SSS2.p5.5.m5.1.1.cmml"><msub id="S6.SS1.SSS2.p5.5.m5.1.1.2" xref="S6.SS1.SSS2.p5.5.m5.1.1.2.cmml"><mi id="S6.SS1.SSS2.p5.5.m5.1.1.2.2" xref="S6.SS1.SSS2.p5.5.m5.1.1.2.2.cmml">β</mi><mn id="S6.SS1.SSS2.p5.5.m5.1.1.2.3" xref="S6.SS1.SSS2.p5.5.m5.1.1.2.3.cmml">2</mn></msub><mo id="S6.SS1.SSS2.p5.5.m5.1.1.1" xref="S6.SS1.SSS2.p5.5.m5.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS2.p5.5.m5.1.1.3" xref="S6.SS1.SSS2.p5.5.m5.1.1.3.cmml">0.999</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p5.5.m5.1b"><apply id="S6.SS1.SSS2.p5.5.m5.1.1.cmml" xref="S6.SS1.SSS2.p5.5.m5.1.1"><eq id="S6.SS1.SSS2.p5.5.m5.1.1.1.cmml" xref="S6.SS1.SSS2.p5.5.m5.1.1.1"></eq><apply id="S6.SS1.SSS2.p5.5.m5.1.1.2.cmml" xref="S6.SS1.SSS2.p5.5.m5.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p5.5.m5.1.1.2.1.cmml" xref="S6.SS1.SSS2.p5.5.m5.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS2.p5.5.m5.1.1.2.2.cmml" xref="S6.SS1.SSS2.p5.5.m5.1.1.2.2">𝛽</ci><cn type="integer" id="S6.SS1.SSS2.p5.5.m5.1.1.2.3.cmml" xref="S6.SS1.SSS2.p5.5.m5.1.1.2.3">2</cn></apply><cn type="float" id="S6.SS1.SSS2.p5.5.m5.1.1.3.cmml" xref="S6.SS1.SSS2.p5.5.m5.1.1.3">0.999</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p5.5.m5.1c">\beta_{2}=0.999</annotation></semantics></math>. We also use a moving average baseline with <math id="S6.SS1.SSS2.p5.6.m6.1" class="ltx_Math" alttext="\alpha=0.05" display="inline"><semantics id="S6.SS1.SSS2.p5.6.m6.1a"><mrow id="S6.SS1.SSS2.p5.6.m6.1.1" xref="S6.SS1.SSS2.p5.6.m6.1.1.cmml"><mi id="S6.SS1.SSS2.p5.6.m6.1.1.2" xref="S6.SS1.SSS2.p5.6.m6.1.1.2.cmml">α</mi><mo id="S6.SS1.SSS2.p5.6.m6.1.1.1" xref="S6.SS1.SSS2.p5.6.m6.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS2.p5.6.m6.1.1.3" xref="S6.SS1.SSS2.p5.6.m6.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p5.6.m6.1b"><apply id="S6.SS1.SSS2.p5.6.m6.1.1.cmml" xref="S6.SS1.SSS2.p5.6.m6.1.1"><eq id="S6.SS1.SSS2.p5.6.m6.1.1.1.cmml" xref="S6.SS1.SSS2.p5.6.m6.1.1.1"></eq><ci id="S6.SS1.SSS2.p5.6.m6.1.1.2.cmml" xref="S6.SS1.SSS2.p5.6.m6.1.1.2">𝛼</ci><cn type="float" id="S6.SS1.SSS2.p5.6.m6.1.1.3.cmml" xref="S6.SS1.SSS2.p5.6.m6.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p5.6.m6.1c">\alpha=0.05</annotation></semantics></math> in order to reduce the variance of the REINFORCE estimator.</p>
</div>
</section>
<section id="S6.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.1.3 </span>Aerial 2D</h4>

<div id="S6.SS1.SSS3.p1" class="ltx_para ltx_noindent">
<p id="S6.SS1.SSS3.p1.1" class="ltx_p"><span id="S6.SS1.SSS3.p1.1.1" class="ltx_text ltx_font_bold">Feature Network Architecture:</span> We use the same feature network architecture as the Multi-MNIST with the final fully connected layer producing a vector of dimension 100. This vector is then split into 4 vectors of dimension 25 which correspond to the logits for one hot encodings. The one hot encodings represent (ranging from 0 to 24) represent the total number of objects of that class (cars, roads, trees and houses) in the scene. Aerial images are 256x256. The features used for training our structure generation model come from the average pool layer and the first two fully connected layers.</p>
</div>
<div id="S6.SS1.SSS3.p2" class="ltx_para ltx_noindent">
<p id="S6.SS1.SSS3.p2.3" class="ltx_p"><span id="S6.SS1.SSS3.p2.3.1" class="ltx_text ltx_font_bold">Feature Network Training:</span> We first sample 5000 prior structures and their corresponding images, then train our feature network until we reach 75% accuracy on car counting and road counting while ignoring the accuracy figures for trees and houses. Our loss function is the average of the cross entropy loss for each scene element. We use the ADAM optimizer with learning rate <math id="S6.SS1.SSS3.p2.1.m1.1" class="ltx_Math" alttext="\epsilon=10^{-3}" display="inline"><semantics id="S6.SS1.SSS3.p2.1.m1.1a"><mrow id="S6.SS1.SSS3.p2.1.m1.1.1" xref="S6.SS1.SSS3.p2.1.m1.1.1.cmml"><mi id="S6.SS1.SSS3.p2.1.m1.1.1.2" xref="S6.SS1.SSS3.p2.1.m1.1.1.2.cmml">ϵ</mi><mo id="S6.SS1.SSS3.p2.1.m1.1.1.1" xref="S6.SS1.SSS3.p2.1.m1.1.1.1.cmml">=</mo><msup id="S6.SS1.SSS3.p2.1.m1.1.1.3" xref="S6.SS1.SSS3.p2.1.m1.1.1.3.cmml"><mn id="S6.SS1.SSS3.p2.1.m1.1.1.3.2" xref="S6.SS1.SSS3.p2.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.SS1.SSS3.p2.1.m1.1.1.3.3" xref="S6.SS1.SSS3.p2.1.m1.1.1.3.3.cmml"><mo id="S6.SS1.SSS3.p2.1.m1.1.1.3.3a" xref="S6.SS1.SSS3.p2.1.m1.1.1.3.3.cmml">−</mo><mn id="S6.SS1.SSS3.p2.1.m1.1.1.3.3.2" xref="S6.SS1.SSS3.p2.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS3.p2.1.m1.1b"><apply id="S6.SS1.SSS3.p2.1.m1.1.1.cmml" xref="S6.SS1.SSS3.p2.1.m1.1.1"><eq id="S6.SS1.SSS3.p2.1.m1.1.1.1.cmml" xref="S6.SS1.SSS3.p2.1.m1.1.1.1"></eq><ci id="S6.SS1.SSS3.p2.1.m1.1.1.2.cmml" xref="S6.SS1.SSS3.p2.1.m1.1.1.2">italic-ϵ</ci><apply id="S6.SS1.SSS3.p2.1.m1.1.1.3.cmml" xref="S6.SS1.SSS3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.SS1.SSS3.p2.1.m1.1.1.3.1.cmml" xref="S6.SS1.SSS3.p2.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.SS1.SSS3.p2.1.m1.1.1.3.2.cmml" xref="S6.SS1.SSS3.p2.1.m1.1.1.3.2">10</cn><apply id="S6.SS1.SSS3.p2.1.m1.1.1.3.3.cmml" xref="S6.SS1.SSS3.p2.1.m1.1.1.3.3"><minus id="S6.SS1.SSS3.p2.1.m1.1.1.3.3.1.cmml" xref="S6.SS1.SSS3.p2.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.SS1.SSS3.p2.1.m1.1.1.3.3.2.cmml" xref="S6.SS1.SSS3.p2.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS3.p2.1.m1.1c">\epsilon=10^{-3}</annotation></semantics></math>, <math id="S6.SS1.SSS3.p2.2.m2.1" class="ltx_Math" alttext="\beta_{1}=0.9" display="inline"><semantics id="S6.SS1.SSS3.p2.2.m2.1a"><mrow id="S6.SS1.SSS3.p2.2.m2.1.1" xref="S6.SS1.SSS3.p2.2.m2.1.1.cmml"><msub id="S6.SS1.SSS3.p2.2.m2.1.1.2" xref="S6.SS1.SSS3.p2.2.m2.1.1.2.cmml"><mi id="S6.SS1.SSS3.p2.2.m2.1.1.2.2" xref="S6.SS1.SSS3.p2.2.m2.1.1.2.2.cmml">β</mi><mn id="S6.SS1.SSS3.p2.2.m2.1.1.2.3" xref="S6.SS1.SSS3.p2.2.m2.1.1.2.3.cmml">1</mn></msub><mo id="S6.SS1.SSS3.p2.2.m2.1.1.1" xref="S6.SS1.SSS3.p2.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS3.p2.2.m2.1.1.3" xref="S6.SS1.SSS3.p2.2.m2.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS3.p2.2.m2.1b"><apply id="S6.SS1.SSS3.p2.2.m2.1.1.cmml" xref="S6.SS1.SSS3.p2.2.m2.1.1"><eq id="S6.SS1.SSS3.p2.2.m2.1.1.1.cmml" xref="S6.SS1.SSS3.p2.2.m2.1.1.1"></eq><apply id="S6.SS1.SSS3.p2.2.m2.1.1.2.cmml" xref="S6.SS1.SSS3.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS3.p2.2.m2.1.1.2.1.cmml" xref="S6.SS1.SSS3.p2.2.m2.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS3.p2.2.m2.1.1.2.2.cmml" xref="S6.SS1.SSS3.p2.2.m2.1.1.2.2">𝛽</ci><cn type="integer" id="S6.SS1.SSS3.p2.2.m2.1.1.2.3.cmml" xref="S6.SS1.SSS3.p2.2.m2.1.1.2.3">1</cn></apply><cn type="float" id="S6.SS1.SSS3.p2.2.m2.1.1.3.cmml" xref="S6.SS1.SSS3.p2.2.m2.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS3.p2.2.m2.1c">\beta_{1}=0.9</annotation></semantics></math> and <math id="S6.SS1.SSS3.p2.3.m3.1" class="ltx_Math" alttext="\beta_{2}=0.999" display="inline"><semantics id="S6.SS1.SSS3.p2.3.m3.1a"><mrow id="S6.SS1.SSS3.p2.3.m3.1.1" xref="S6.SS1.SSS3.p2.3.m3.1.1.cmml"><msub id="S6.SS1.SSS3.p2.3.m3.1.1.2" xref="S6.SS1.SSS3.p2.3.m3.1.1.2.cmml"><mi id="S6.SS1.SSS3.p2.3.m3.1.1.2.2" xref="S6.SS1.SSS3.p2.3.m3.1.1.2.2.cmml">β</mi><mn id="S6.SS1.SSS3.p2.3.m3.1.1.2.3" xref="S6.SS1.SSS3.p2.3.m3.1.1.2.3.cmml">2</mn></msub><mo id="S6.SS1.SSS3.p2.3.m3.1.1.1" xref="S6.SS1.SSS3.p2.3.m3.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS3.p2.3.m3.1.1.3" xref="S6.SS1.SSS3.p2.3.m3.1.1.3.cmml">0.999</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS3.p2.3.m3.1b"><apply id="S6.SS1.SSS3.p2.3.m3.1.1.cmml" xref="S6.SS1.SSS3.p2.3.m3.1.1"><eq id="S6.SS1.SSS3.p2.3.m3.1.1.1.cmml" xref="S6.SS1.SSS3.p2.3.m3.1.1.1"></eq><apply id="S6.SS1.SSS3.p2.3.m3.1.1.2.cmml" xref="S6.SS1.SSS3.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS3.p2.3.m3.1.1.2.1.cmml" xref="S6.SS1.SSS3.p2.3.m3.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS3.p2.3.m3.1.1.2.2.cmml" xref="S6.SS1.SSS3.p2.3.m3.1.1.2.2">𝛽</ci><cn type="integer" id="S6.SS1.SSS3.p2.3.m3.1.1.2.3.cmml" xref="S6.SS1.SSS3.p2.3.m3.1.1.2.3">2</cn></apply><cn type="float" id="S6.SS1.SSS3.p2.3.m3.1.1.3.cmml" xref="S6.SS1.SSS3.p2.3.m3.1.1.3">0.999</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS3.p2.3.m3.1c">\beta_{2}=0.999</annotation></semantics></math>.</p>
</div>
<div id="S6.SS1.SSS3.p3" class="ltx_para ltx_noindent">
<p id="S6.SS1.SSS3.p3.3" class="ltx_p"><span id="S6.SS1.SSS3.p3.3.1" class="ltx_text ltx_font_bold">Structure Generation Model Pre-Training:</span> Using the 5000 prior structures generated for training the feature network, we train our structure generation model to minimize the negative log likelihood of the generated structures. This is done for 10 epochs using the ADAM optimizer with learning rate <math id="S6.SS1.SSS3.p3.1.m1.1" class="ltx_Math" alttext="\epsilon=10^{-3}" display="inline"><semantics id="S6.SS1.SSS3.p3.1.m1.1a"><mrow id="S6.SS1.SSS3.p3.1.m1.1.1" xref="S6.SS1.SSS3.p3.1.m1.1.1.cmml"><mi id="S6.SS1.SSS3.p3.1.m1.1.1.2" xref="S6.SS1.SSS3.p3.1.m1.1.1.2.cmml">ϵ</mi><mo id="S6.SS1.SSS3.p3.1.m1.1.1.1" xref="S6.SS1.SSS3.p3.1.m1.1.1.1.cmml">=</mo><msup id="S6.SS1.SSS3.p3.1.m1.1.1.3" xref="S6.SS1.SSS3.p3.1.m1.1.1.3.cmml"><mn id="S6.SS1.SSS3.p3.1.m1.1.1.3.2" xref="S6.SS1.SSS3.p3.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.SS1.SSS3.p3.1.m1.1.1.3.3" xref="S6.SS1.SSS3.p3.1.m1.1.1.3.3.cmml"><mo id="S6.SS1.SSS3.p3.1.m1.1.1.3.3a" xref="S6.SS1.SSS3.p3.1.m1.1.1.3.3.cmml">−</mo><mn id="S6.SS1.SSS3.p3.1.m1.1.1.3.3.2" xref="S6.SS1.SSS3.p3.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS3.p3.1.m1.1b"><apply id="S6.SS1.SSS3.p3.1.m1.1.1.cmml" xref="S6.SS1.SSS3.p3.1.m1.1.1"><eq id="S6.SS1.SSS3.p3.1.m1.1.1.1.cmml" xref="S6.SS1.SSS3.p3.1.m1.1.1.1"></eq><ci id="S6.SS1.SSS3.p3.1.m1.1.1.2.cmml" xref="S6.SS1.SSS3.p3.1.m1.1.1.2">italic-ϵ</ci><apply id="S6.SS1.SSS3.p3.1.m1.1.1.3.cmml" xref="S6.SS1.SSS3.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.SS1.SSS3.p3.1.m1.1.1.3.1.cmml" xref="S6.SS1.SSS3.p3.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.SS1.SSS3.p3.1.m1.1.1.3.2.cmml" xref="S6.SS1.SSS3.p3.1.m1.1.1.3.2">10</cn><apply id="S6.SS1.SSS3.p3.1.m1.1.1.3.3.cmml" xref="S6.SS1.SSS3.p3.1.m1.1.1.3.3"><minus id="S6.SS1.SSS3.p3.1.m1.1.1.3.3.1.cmml" xref="S6.SS1.SSS3.p3.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.SS1.SSS3.p3.1.m1.1.1.3.3.2.cmml" xref="S6.SS1.SSS3.p3.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS3.p3.1.m1.1c">\epsilon=10^{-3}</annotation></semantics></math>, <math id="S6.SS1.SSS3.p3.2.m2.1" class="ltx_Math" alttext="\beta_{1}=0.9" display="inline"><semantics id="S6.SS1.SSS3.p3.2.m2.1a"><mrow id="S6.SS1.SSS3.p3.2.m2.1.1" xref="S6.SS1.SSS3.p3.2.m2.1.1.cmml"><msub id="S6.SS1.SSS3.p3.2.m2.1.1.2" xref="S6.SS1.SSS3.p3.2.m2.1.1.2.cmml"><mi id="S6.SS1.SSS3.p3.2.m2.1.1.2.2" xref="S6.SS1.SSS3.p3.2.m2.1.1.2.2.cmml">β</mi><mn id="S6.SS1.SSS3.p3.2.m2.1.1.2.3" xref="S6.SS1.SSS3.p3.2.m2.1.1.2.3.cmml">1</mn></msub><mo id="S6.SS1.SSS3.p3.2.m2.1.1.1" xref="S6.SS1.SSS3.p3.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS3.p3.2.m2.1.1.3" xref="S6.SS1.SSS3.p3.2.m2.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS3.p3.2.m2.1b"><apply id="S6.SS1.SSS3.p3.2.m2.1.1.cmml" xref="S6.SS1.SSS3.p3.2.m2.1.1"><eq id="S6.SS1.SSS3.p3.2.m2.1.1.1.cmml" xref="S6.SS1.SSS3.p3.2.m2.1.1.1"></eq><apply id="S6.SS1.SSS3.p3.2.m2.1.1.2.cmml" xref="S6.SS1.SSS3.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS3.p3.2.m2.1.1.2.1.cmml" xref="S6.SS1.SSS3.p3.2.m2.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS3.p3.2.m2.1.1.2.2.cmml" xref="S6.SS1.SSS3.p3.2.m2.1.1.2.2">𝛽</ci><cn type="integer" id="S6.SS1.SSS3.p3.2.m2.1.1.2.3.cmml" xref="S6.SS1.SSS3.p3.2.m2.1.1.2.3">1</cn></apply><cn type="float" id="S6.SS1.SSS3.p3.2.m2.1.1.3.cmml" xref="S6.SS1.SSS3.p3.2.m2.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS3.p3.2.m2.1c">\beta_{1}=0.9</annotation></semantics></math> and <math id="S6.SS1.SSS3.p3.3.m3.1" class="ltx_Math" alttext="\beta_{2}=0.999" display="inline"><semantics id="S6.SS1.SSS3.p3.3.m3.1a"><mrow id="S6.SS1.SSS3.p3.3.m3.1.1" xref="S6.SS1.SSS3.p3.3.m3.1.1.cmml"><msub id="S6.SS1.SSS3.p3.3.m3.1.1.2" xref="S6.SS1.SSS3.p3.3.m3.1.1.2.cmml"><mi id="S6.SS1.SSS3.p3.3.m3.1.1.2.2" xref="S6.SS1.SSS3.p3.3.m3.1.1.2.2.cmml">β</mi><mn id="S6.SS1.SSS3.p3.3.m3.1.1.2.3" xref="S6.SS1.SSS3.p3.3.m3.1.1.2.3.cmml">2</mn></msub><mo id="S6.SS1.SSS3.p3.3.m3.1.1.1" xref="S6.SS1.SSS3.p3.3.m3.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS3.p3.3.m3.1.1.3" xref="S6.SS1.SSS3.p3.3.m3.1.1.3.cmml">0.999</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS3.p3.3.m3.1b"><apply id="S6.SS1.SSS3.p3.3.m3.1.1.cmml" xref="S6.SS1.SSS3.p3.3.m3.1.1"><eq id="S6.SS1.SSS3.p3.3.m3.1.1.1.cmml" xref="S6.SS1.SSS3.p3.3.m3.1.1.1"></eq><apply id="S6.SS1.SSS3.p3.3.m3.1.1.2.cmml" xref="S6.SS1.SSS3.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS3.p3.3.m3.1.1.2.1.cmml" xref="S6.SS1.SSS3.p3.3.m3.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS3.p3.3.m3.1.1.2.2.cmml" xref="S6.SS1.SSS3.p3.3.m3.1.1.2.2">𝛽</ci><cn type="integer" id="S6.SS1.SSS3.p3.3.m3.1.1.2.3.cmml" xref="S6.SS1.SSS3.p3.3.m3.1.1.2.3">2</cn></apply><cn type="float" id="S6.SS1.SSS3.p3.3.m3.1.1.3.cmml" xref="S6.SS1.SSS3.p3.3.m3.1.1.3">0.999</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS3.p3.3.m3.1c">\beta_{2}=0.999</annotation></semantics></math> with a batch size of 100.</p>
</div>
<div id="S6.SS1.SSS3.p4" class="ltx_para ltx_noindent">
<p id="S6.SS1.SSS3.p4.6" class="ltx_p"><span id="S6.SS1.SSS3.p4.6.1" class="ltx_text ltx_font_bold">Structure Generation Model Training:</span> We train using 5000 target images only (no structure ground truth). We use a batch size of <math id="S6.SS1.SSS3.p4.1.m1.1" class="ltx_Math" alttext="m=500" display="inline"><semantics id="S6.SS1.SSS3.p4.1.m1.1a"><mrow id="S6.SS1.SSS3.p4.1.m1.1.1" xref="S6.SS1.SSS3.p4.1.m1.1.1.cmml"><mi id="S6.SS1.SSS3.p4.1.m1.1.1.2" xref="S6.SS1.SSS3.p4.1.m1.1.1.2.cmml">m</mi><mo id="S6.SS1.SSS3.p4.1.m1.1.1.1" xref="S6.SS1.SSS3.p4.1.m1.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS3.p4.1.m1.1.1.3" xref="S6.SS1.SSS3.p4.1.m1.1.1.3.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS3.p4.1.m1.1b"><apply id="S6.SS1.SSS3.p4.1.m1.1.1.cmml" xref="S6.SS1.SSS3.p4.1.m1.1.1"><eq id="S6.SS1.SSS3.p4.1.m1.1.1.1.cmml" xref="S6.SS1.SSS3.p4.1.m1.1.1.1"></eq><ci id="S6.SS1.SSS3.p4.1.m1.1.1.2.cmml" xref="S6.SS1.SSS3.p4.1.m1.1.1.2">𝑚</ci><cn type="integer" id="S6.SS1.SSS3.p4.1.m1.1.1.3.cmml" xref="S6.SS1.SSS3.p4.1.m1.1.1.3">500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS3.p4.1.m1.1c">m=500</annotation></semantics></math> and <math id="S6.SS1.SSS3.p4.2.m2.1" class="ltx_Math" alttext="l=500" display="inline"><semantics id="S6.SS1.SSS3.p4.2.m2.1a"><mrow id="S6.SS1.SSS3.p4.2.m2.1.1" xref="S6.SS1.SSS3.p4.2.m2.1.1.cmml"><mi id="S6.SS1.SSS3.p4.2.m2.1.1.2" xref="S6.SS1.SSS3.p4.2.m2.1.1.2.cmml">l</mi><mo id="S6.SS1.SSS3.p4.2.m2.1.1.1" xref="S6.SS1.SSS3.p4.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS3.p4.2.m2.1.1.3" xref="S6.SS1.SSS3.p4.2.m2.1.1.3.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS3.p4.2.m2.1b"><apply id="S6.SS1.SSS3.p4.2.m2.1.1.cmml" xref="S6.SS1.SSS3.p4.2.m2.1.1"><eq id="S6.SS1.SSS3.p4.2.m2.1.1.1.cmml" xref="S6.SS1.SSS3.p4.2.m2.1.1.1"></eq><ci id="S6.SS1.SSS3.p4.2.m2.1.1.2.cmml" xref="S6.SS1.SSS3.p4.2.m2.1.1.2">𝑙</ci><cn type="integer" id="S6.SS1.SSS3.p4.2.m2.1.1.3.cmml" xref="S6.SS1.SSS3.p4.2.m2.1.1.3">500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS3.p4.2.m2.1c">l=500</annotation></semantics></math> for both the generated and real images. We train for 20 epochs. We use the ADAM optimizer with a learning rate of <math id="S6.SS1.SSS3.p4.3.m3.1" class="ltx_Math" alttext="\epsilon=10^{-4}" display="inline"><semantics id="S6.SS1.SSS3.p4.3.m3.1a"><mrow id="S6.SS1.SSS3.p4.3.m3.1.1" xref="S6.SS1.SSS3.p4.3.m3.1.1.cmml"><mi id="S6.SS1.SSS3.p4.3.m3.1.1.2" xref="S6.SS1.SSS3.p4.3.m3.1.1.2.cmml">ϵ</mi><mo id="S6.SS1.SSS3.p4.3.m3.1.1.1" xref="S6.SS1.SSS3.p4.3.m3.1.1.1.cmml">=</mo><msup id="S6.SS1.SSS3.p4.3.m3.1.1.3" xref="S6.SS1.SSS3.p4.3.m3.1.1.3.cmml"><mn id="S6.SS1.SSS3.p4.3.m3.1.1.3.2" xref="S6.SS1.SSS3.p4.3.m3.1.1.3.2.cmml">10</mn><mrow id="S6.SS1.SSS3.p4.3.m3.1.1.3.3" xref="S6.SS1.SSS3.p4.3.m3.1.1.3.3.cmml"><mo id="S6.SS1.SSS3.p4.3.m3.1.1.3.3a" xref="S6.SS1.SSS3.p4.3.m3.1.1.3.3.cmml">−</mo><mn id="S6.SS1.SSS3.p4.3.m3.1.1.3.3.2" xref="S6.SS1.SSS3.p4.3.m3.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS3.p4.3.m3.1b"><apply id="S6.SS1.SSS3.p4.3.m3.1.1.cmml" xref="S6.SS1.SSS3.p4.3.m3.1.1"><eq id="S6.SS1.SSS3.p4.3.m3.1.1.1.cmml" xref="S6.SS1.SSS3.p4.3.m3.1.1.1"></eq><ci id="S6.SS1.SSS3.p4.3.m3.1.1.2.cmml" xref="S6.SS1.SSS3.p4.3.m3.1.1.2">italic-ϵ</ci><apply id="S6.SS1.SSS3.p4.3.m3.1.1.3.cmml" xref="S6.SS1.SSS3.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="S6.SS1.SSS3.p4.3.m3.1.1.3.1.cmml" xref="S6.SS1.SSS3.p4.3.m3.1.1.3">superscript</csymbol><cn type="integer" id="S6.SS1.SSS3.p4.3.m3.1.1.3.2.cmml" xref="S6.SS1.SSS3.p4.3.m3.1.1.3.2">10</cn><apply id="S6.SS1.SSS3.p4.3.m3.1.1.3.3.cmml" xref="S6.SS1.SSS3.p4.3.m3.1.1.3.3"><minus id="S6.SS1.SSS3.p4.3.m3.1.1.3.3.1.cmml" xref="S6.SS1.SSS3.p4.3.m3.1.1.3.3"></minus><cn type="integer" id="S6.SS1.SSS3.p4.3.m3.1.1.3.3.2.cmml" xref="S6.SS1.SSS3.p4.3.m3.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS3.p4.3.m3.1c">\epsilon=10^{-4}</annotation></semantics></math>, <math id="S6.SS1.SSS3.p4.4.m4.1" class="ltx_Math" alttext="\beta_{1}=0.9" display="inline"><semantics id="S6.SS1.SSS3.p4.4.m4.1a"><mrow id="S6.SS1.SSS3.p4.4.m4.1.1" xref="S6.SS1.SSS3.p4.4.m4.1.1.cmml"><msub id="S6.SS1.SSS3.p4.4.m4.1.1.2" xref="S6.SS1.SSS3.p4.4.m4.1.1.2.cmml"><mi id="S6.SS1.SSS3.p4.4.m4.1.1.2.2" xref="S6.SS1.SSS3.p4.4.m4.1.1.2.2.cmml">β</mi><mn id="S6.SS1.SSS3.p4.4.m4.1.1.2.3" xref="S6.SS1.SSS3.p4.4.m4.1.1.2.3.cmml">1</mn></msub><mo id="S6.SS1.SSS3.p4.4.m4.1.1.1" xref="S6.SS1.SSS3.p4.4.m4.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS3.p4.4.m4.1.1.3" xref="S6.SS1.SSS3.p4.4.m4.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS3.p4.4.m4.1b"><apply id="S6.SS1.SSS3.p4.4.m4.1.1.cmml" xref="S6.SS1.SSS3.p4.4.m4.1.1"><eq id="S6.SS1.SSS3.p4.4.m4.1.1.1.cmml" xref="S6.SS1.SSS3.p4.4.m4.1.1.1"></eq><apply id="S6.SS1.SSS3.p4.4.m4.1.1.2.cmml" xref="S6.SS1.SSS3.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS3.p4.4.m4.1.1.2.1.cmml" xref="S6.SS1.SSS3.p4.4.m4.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS3.p4.4.m4.1.1.2.2.cmml" xref="S6.SS1.SSS3.p4.4.m4.1.1.2.2">𝛽</ci><cn type="integer" id="S6.SS1.SSS3.p4.4.m4.1.1.2.3.cmml" xref="S6.SS1.SSS3.p4.4.m4.1.1.2.3">1</cn></apply><cn type="float" id="S6.SS1.SSS3.p4.4.m4.1.1.3.cmml" xref="S6.SS1.SSS3.p4.4.m4.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS3.p4.4.m4.1c">\beta_{1}=0.9</annotation></semantics></math> and <math id="S6.SS1.SSS3.p4.5.m5.1" class="ltx_Math" alttext="\beta_{2}=0.999" display="inline"><semantics id="S6.SS1.SSS3.p4.5.m5.1a"><mrow id="S6.SS1.SSS3.p4.5.m5.1.1" xref="S6.SS1.SSS3.p4.5.m5.1.1.cmml"><msub id="S6.SS1.SSS3.p4.5.m5.1.1.2" xref="S6.SS1.SSS3.p4.5.m5.1.1.2.cmml"><mi id="S6.SS1.SSS3.p4.5.m5.1.1.2.2" xref="S6.SS1.SSS3.p4.5.m5.1.1.2.2.cmml">β</mi><mn id="S6.SS1.SSS3.p4.5.m5.1.1.2.3" xref="S6.SS1.SSS3.p4.5.m5.1.1.2.3.cmml">2</mn></msub><mo id="S6.SS1.SSS3.p4.5.m5.1.1.1" xref="S6.SS1.SSS3.p4.5.m5.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS3.p4.5.m5.1.1.3" xref="S6.SS1.SSS3.p4.5.m5.1.1.3.cmml">0.999</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS3.p4.5.m5.1b"><apply id="S6.SS1.SSS3.p4.5.m5.1.1.cmml" xref="S6.SS1.SSS3.p4.5.m5.1.1"><eq id="S6.SS1.SSS3.p4.5.m5.1.1.1.cmml" xref="S6.SS1.SSS3.p4.5.m5.1.1.1"></eq><apply id="S6.SS1.SSS3.p4.5.m5.1.1.2.cmml" xref="S6.SS1.SSS3.p4.5.m5.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS3.p4.5.m5.1.1.2.1.cmml" xref="S6.SS1.SSS3.p4.5.m5.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS3.p4.5.m5.1.1.2.2.cmml" xref="S6.SS1.SSS3.p4.5.m5.1.1.2.2">𝛽</ci><cn type="integer" id="S6.SS1.SSS3.p4.5.m5.1.1.2.3.cmml" xref="S6.SS1.SSS3.p4.5.m5.1.1.2.3">2</cn></apply><cn type="float" id="S6.SS1.SSS3.p4.5.m5.1.1.3.cmml" xref="S6.SS1.SSS3.p4.5.m5.1.1.3">0.999</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS3.p4.5.m5.1c">\beta_{2}=0.999</annotation></semantics></math>. We also use a moving average baseline with <math id="S6.SS1.SSS3.p4.6.m6.1" class="ltx_Math" alttext="\alpha=0.05" display="inline"><semantics id="S6.SS1.SSS3.p4.6.m6.1a"><mrow id="S6.SS1.SSS3.p4.6.m6.1.1" xref="S6.SS1.SSS3.p4.6.m6.1.1.cmml"><mi id="S6.SS1.SSS3.p4.6.m6.1.1.2" xref="S6.SS1.SSS3.p4.6.m6.1.1.2.cmml">α</mi><mo id="S6.SS1.SSS3.p4.6.m6.1.1.1" xref="S6.SS1.SSS3.p4.6.m6.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS3.p4.6.m6.1.1.3" xref="S6.SS1.SSS3.p4.6.m6.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS3.p4.6.m6.1b"><apply id="S6.SS1.SSS3.p4.6.m6.1.1.cmml" xref="S6.SS1.SSS3.p4.6.m6.1.1"><eq id="S6.SS1.SSS3.p4.6.m6.1.1.1.cmml" xref="S6.SS1.SSS3.p4.6.m6.1.1.1"></eq><ci id="S6.SS1.SSS3.p4.6.m6.1.1.2.cmml" xref="S6.SS1.SSS3.p4.6.m6.1.1.2">𝛼</ci><cn type="float" id="S6.SS1.SSS3.p4.6.m6.1.1.3.cmml" xref="S6.SS1.SSS3.p4.6.m6.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS3.p4.6.m6.1c">\alpha=0.05</annotation></semantics></math> in order to reduce the variance of the REINFORCE estimator.</p>
</div>
</section>
<section id="S6.SS1.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.1.4 </span>3D Driving Scenes</h4>

<div id="S6.SS1.SSS4.p1" class="ltx_para ltx_noindent">
<p id="S6.SS1.SSS4.p1.1" class="ltx_p"><span id="S6.SS1.SSS4.p1.1.1" class="ltx_text ltx_font_bold">Structure Generation Model Architecture:</span> We use the same architecture as the previous experiments except we use 3 models in conjunction with three scenarios, as defined by  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>. Each scenario has a slightly different grammar, as described below.</p>
</div>
<div id="S6.SS1.SSS4.p2" class="ltx_para ltx_noindent">
<p id="S6.SS1.SSS4.p2.3" class="ltx_p"><span id="S6.SS1.SSS4.p2.3.1" class="ltx_text ltx_font_bold">Scenario Grammars:</span>
Different grammars are used for each scenario following SDR. The most general is the city scenario grammar</p>
<table id="S6.EGx11" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S6.Ex15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S6.Ex15.m1.1" class="ltx_Math" alttext="\displaystyle\text{S}_{\text{city}}" display="inline"><semantics id="S6.Ex15.m1.1a"><msub id="S6.Ex15.m1.1.1" xref="S6.Ex15.m1.1.1.cmml"><mtext id="S6.Ex15.m1.1.1.2" xref="S6.Ex15.m1.1.1.2a.cmml">S</mtext><mtext id="S6.Ex15.m1.1.1.3" xref="S6.Ex15.m1.1.1.3a.cmml">city</mtext></msub><annotation-xml encoding="MathML-Content" id="S6.Ex15.m1.1b"><apply id="S6.Ex15.m1.1.1.cmml" xref="S6.Ex15.m1.1.1"><csymbol cd="ambiguous" id="S6.Ex15.m1.1.1.1.cmml" xref="S6.Ex15.m1.1.1">subscript</csymbol><ci id="S6.Ex15.m1.1.1.2a.cmml" xref="S6.Ex15.m1.1.1.2"><mtext id="S6.Ex15.m1.1.1.2.cmml" xref="S6.Ex15.m1.1.1.2">S</mtext></ci><ci id="S6.Ex15.m1.1.1.3a.cmml" xref="S6.Ex15.m1.1.1.3"><mtext mathsize="70%" id="S6.Ex15.m1.1.1.3.cmml" xref="S6.Ex15.m1.1.1.3">city</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex15.m1.1c">\displaystyle\text{S}_{\text{city}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex15.m2.3" class="ltx_Math" alttext="\displaystyle\to\text{Street}\ \ \text{Outer}_{L}\ \ \text{Outer}_{R}" display="inline"><semantics id="S6.Ex15.m2.3a"><mrow id="S6.Ex15.m2.3.3" xref="S6.Ex15.m2.3.3.cmml"><mi id="S6.Ex15.m2.3.3.4" xref="S6.Ex15.m2.3.3.4.cmml"></mi><mo stretchy="false" id="S6.Ex15.m2.3.3.3" xref="S6.Ex15.m2.3.3.3.cmml">→</mo><mrow id="S6.Ex15.m2.3.3.2.2" xref="S6.Ex15.m2.3.3.2.3.cmml"><mtext id="S6.Ex15.m2.1.1" xref="S6.Ex15.m2.1.1a.cmml">Street</mtext><mspace width="1em" id="S6.Ex15.m2.3.3.2.2.3" xref="S6.Ex15.m2.3.3.2.3.cmml"></mspace><msub id="S6.Ex15.m2.2.2.1.1.1" xref="S6.Ex15.m2.2.2.1.1.1.cmml"><mtext id="S6.Ex15.m2.2.2.1.1.1.2" xref="S6.Ex15.m2.2.2.1.1.1.2a.cmml">Outer</mtext><mi id="S6.Ex15.m2.2.2.1.1.1.3" xref="S6.Ex15.m2.2.2.1.1.1.3.cmml">L</mi></msub><mspace width="1em" id="S6.Ex15.m2.3.3.2.2.4" xref="S6.Ex15.m2.3.3.2.3.cmml"></mspace><msub id="S6.Ex15.m2.3.3.2.2.2" xref="S6.Ex15.m2.3.3.2.2.2.cmml"><mtext id="S6.Ex15.m2.3.3.2.2.2.2" xref="S6.Ex15.m2.3.3.2.2.2.2a.cmml">Outer</mtext><mi id="S6.Ex15.m2.3.3.2.2.2.3" xref="S6.Ex15.m2.3.3.2.2.2.3.cmml">R</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex15.m2.3b"><apply id="S6.Ex15.m2.3.3.cmml" xref="S6.Ex15.m2.3.3"><ci id="S6.Ex15.m2.3.3.3.cmml" xref="S6.Ex15.m2.3.3.3">→</ci><csymbol cd="latexml" id="S6.Ex15.m2.3.3.4.cmml" xref="S6.Ex15.m2.3.3.4">absent</csymbol><list id="S6.Ex15.m2.3.3.2.3.cmml" xref="S6.Ex15.m2.3.3.2.2"><ci id="S6.Ex15.m2.1.1a.cmml" xref="S6.Ex15.m2.1.1"><mtext id="S6.Ex15.m2.1.1.cmml" xref="S6.Ex15.m2.1.1">Street</mtext></ci><apply id="S6.Ex15.m2.2.2.1.1.1.cmml" xref="S6.Ex15.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.Ex15.m2.2.2.1.1.1.1.cmml" xref="S6.Ex15.m2.2.2.1.1.1">subscript</csymbol><ci id="S6.Ex15.m2.2.2.1.1.1.2a.cmml" xref="S6.Ex15.m2.2.2.1.1.1.2"><mtext id="S6.Ex15.m2.2.2.1.1.1.2.cmml" xref="S6.Ex15.m2.2.2.1.1.1.2">Outer</mtext></ci><ci id="S6.Ex15.m2.2.2.1.1.1.3.cmml" xref="S6.Ex15.m2.2.2.1.1.1.3">𝐿</ci></apply><apply id="S6.Ex15.m2.3.3.2.2.2.cmml" xref="S6.Ex15.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.Ex15.m2.3.3.2.2.2.1.cmml" xref="S6.Ex15.m2.3.3.2.2.2">subscript</csymbol><ci id="S6.Ex15.m2.3.3.2.2.2.2a.cmml" xref="S6.Ex15.m2.3.3.2.2.2.2"><mtext id="S6.Ex15.m2.3.3.2.2.2.2.cmml" xref="S6.Ex15.m2.3.3.2.2.2.2">Outer</mtext></ci><ci id="S6.Ex15.m2.3.3.2.2.2.3.cmml" xref="S6.Ex15.m2.3.3.2.2.2.3">𝑅</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex15.m2.3c">\displaystyle\to\text{Street}\ \ \text{Outer}_{L}\ \ \text{Outer}_{R}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S6.Ex16.2.1.1.1" class="ltx_text ltx_markedasmath">Street</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex16.m2.1" class="ltx_math_unparsed" alttext="\displaystyle\to\text{Median}\ \text{Cars}\ |\ \text{Median}\ \text{Cars}\ \text{Cars}\ |\ \text{Cars}\ \text{Median}\ \text{Cars}\ |" display="inline"><semantics id="S6.Ex16.m2.1a"><mrow id="S6.Ex16.m2.1b"><mo stretchy="false" id="S6.Ex16.m2.1.1">→</mo><mtext id="S6.Ex16.m2.1.2">Median</mtext><mtext id="S6.Ex16.m2.1.3">Cars</mtext><mo fence="false" lspace="0.500em" rspace="0.667em" stretchy="false" id="S6.Ex16.m2.1.4">|</mo><mtext id="S6.Ex16.m2.1.5">Median</mtext><mtext id="S6.Ex16.m2.1.6">Cars</mtext><mtext id="S6.Ex16.m2.1.7">Cars</mtext><mo fence="false" lspace="0.500em" rspace="0.667em" stretchy="false" id="S6.Ex16.m2.1.8">|</mo><mtext id="S6.Ex16.m2.1.9">Cars</mtext><mtext id="S6.Ex16.m2.1.10">Median</mtext><mtext id="S6.Ex16.m2.1.11">Cars</mtext><mo fence="false" lspace="0.500em" stretchy="false" id="S6.Ex16.m2.1.12">|</mo></mrow><annotation encoding="application/x-tex" id="S6.Ex16.m2.1c">\displaystyle\to\text{Median}\ \text{Cars}\ |\ \text{Median}\ \text{Cars}\ \text{Cars}\ |\ \text{Cars}\ \text{Median}\ \text{Cars}\ |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex17.m1.1" class="ltx_Math" alttext="\displaystyle\ \text{Cars}\ \text{Median}\ \text{Cars}\ \text{Cars}\ |\ \text{Cars}\ \text{Cars}\ \text{Median}\ \text{Cars}\ |" display="inline"><semantics id="S6.Ex17.m1.1a"><mrow id="S6.Ex17.m1.1.1" xref="S6.Ex17.m1.1.1.cmml"><mtext id="S6.Ex17.m1.1.1.3" xref="S6.Ex17.m1.1.1.3a.cmml">Cars</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex17.m1.1.1.2" xref="S6.Ex17.m1.1.1.2.cmml">​</mo><mtext id="S6.Ex17.m1.1.1.4" xref="S6.Ex17.m1.1.1.4a.cmml">Median</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex17.m1.1.1.2a" xref="S6.Ex17.m1.1.1.2.cmml">​</mo><mtext id="S6.Ex17.m1.1.1.5" xref="S6.Ex17.m1.1.1.5a.cmml">Cars</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex17.m1.1.1.2b" xref="S6.Ex17.m1.1.1.2.cmml">​</mo><mtext id="S6.Ex17.m1.1.1.6" xref="S6.Ex17.m1.1.1.6a.cmml">Cars</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex17.m1.1.1.2c" xref="S6.Ex17.m1.1.1.2.cmml">​</mo><mrow id="S6.Ex17.m1.1.1.1.1" xref="S6.Ex17.m1.1.1.1.2.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex17.m1.1.1.1.1.2" xref="S6.Ex17.m1.1.1.1.2.1.cmml">|</mo><mrow id="S6.Ex17.m1.1.1.1.1.1" xref="S6.Ex17.m1.1.1.1.1.1.cmml"><mtext id="S6.Ex17.m1.1.1.1.1.1.2" xref="S6.Ex17.m1.1.1.1.1.1.2a.cmml">Cars</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex17.m1.1.1.1.1.1.1" xref="S6.Ex17.m1.1.1.1.1.1.1.cmml">​</mo><mtext id="S6.Ex17.m1.1.1.1.1.1.3" xref="S6.Ex17.m1.1.1.1.1.1.3a.cmml">Cars</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex17.m1.1.1.1.1.1.1a" xref="S6.Ex17.m1.1.1.1.1.1.1.cmml">​</mo><mtext id="S6.Ex17.m1.1.1.1.1.1.4" xref="S6.Ex17.m1.1.1.1.1.1.4a.cmml">Median</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex17.m1.1.1.1.1.1.1b" xref="S6.Ex17.m1.1.1.1.1.1.1.cmml">​</mo><mtext id="S6.Ex17.m1.1.1.1.1.1.5" xref="S6.Ex17.m1.1.1.1.1.1.5a.cmml">Cars</mtext></mrow><mo lspace="0.500em" stretchy="false" id="S6.Ex17.m1.1.1.1.1.3" xref="S6.Ex17.m1.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex17.m1.1b"><apply id="S6.Ex17.m1.1.1.cmml" xref="S6.Ex17.m1.1.1"><times id="S6.Ex17.m1.1.1.2.cmml" xref="S6.Ex17.m1.1.1.2"></times><ci id="S6.Ex17.m1.1.1.3a.cmml" xref="S6.Ex17.m1.1.1.3"><mtext id="S6.Ex17.m1.1.1.3.cmml" xref="S6.Ex17.m1.1.1.3">Cars</mtext></ci><ci id="S6.Ex17.m1.1.1.4a.cmml" xref="S6.Ex17.m1.1.1.4"><mtext id="S6.Ex17.m1.1.1.4.cmml" xref="S6.Ex17.m1.1.1.4">Median</mtext></ci><ci id="S6.Ex17.m1.1.1.5a.cmml" xref="S6.Ex17.m1.1.1.5"><mtext id="S6.Ex17.m1.1.1.5.cmml" xref="S6.Ex17.m1.1.1.5">Cars</mtext></ci><ci id="S6.Ex17.m1.1.1.6a.cmml" xref="S6.Ex17.m1.1.1.6"><mtext id="S6.Ex17.m1.1.1.6.cmml" xref="S6.Ex17.m1.1.1.6">Cars</mtext></ci><apply id="S6.Ex17.m1.1.1.1.2.cmml" xref="S6.Ex17.m1.1.1.1.1"><abs id="S6.Ex17.m1.1.1.1.2.1.cmml" xref="S6.Ex17.m1.1.1.1.1.2"></abs><apply id="S6.Ex17.m1.1.1.1.1.1.cmml" xref="S6.Ex17.m1.1.1.1.1.1"><times id="S6.Ex17.m1.1.1.1.1.1.1.cmml" xref="S6.Ex17.m1.1.1.1.1.1.1"></times><ci id="S6.Ex17.m1.1.1.1.1.1.2a.cmml" xref="S6.Ex17.m1.1.1.1.1.1.2"><mtext id="S6.Ex17.m1.1.1.1.1.1.2.cmml" xref="S6.Ex17.m1.1.1.1.1.1.2">Cars</mtext></ci><ci id="S6.Ex17.m1.1.1.1.1.1.3a.cmml" xref="S6.Ex17.m1.1.1.1.1.1.3"><mtext id="S6.Ex17.m1.1.1.1.1.1.3.cmml" xref="S6.Ex17.m1.1.1.1.1.1.3">Cars</mtext></ci><ci id="S6.Ex17.m1.1.1.1.1.1.4a.cmml" xref="S6.Ex17.m1.1.1.1.1.1.4"><mtext id="S6.Ex17.m1.1.1.1.1.1.4.cmml" xref="S6.Ex17.m1.1.1.1.1.1.4">Median</mtext></ci><ci id="S6.Ex17.m1.1.1.1.1.1.5a.cmml" xref="S6.Ex17.m1.1.1.1.1.1.5"><mtext id="S6.Ex17.m1.1.1.1.1.1.5.cmml" xref="S6.Ex17.m1.1.1.1.1.1.5">Cars</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex17.m1.1c">\displaystyle\ \text{Cars}\ \text{Median}\ \text{Cars}\ \text{Cars}\ |\ \text{Cars}\ \text{Cars}\ \text{Median}\ \text{Cars}\ |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell">
<span id="S6.Ex18.8.7.2.1" class="ltx_text ltx_markedasmath">Cars</span><span id="S6.Ex18.8.7.2.2" class="ltx_text ltx_markedasmath">Cars</span><span id="S6.Ex18.8.7.2.3" class="ltx_text ltx_markedasmath">Median</span><span id="S6.Ex18.8.7.2.4" class="ltx_text ltx_markedasmath">Cars</span><span id="S6.Ex18.8.7.2.5" class="ltx_text ltx_markedasmath">Cars</span>
</td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S6.Ex19.m1.1" class="ltx_Math" alttext="\displaystyle\text{Outer}_{L}" display="inline"><semantics id="S6.Ex19.m1.1a"><msub id="S6.Ex19.m1.1.1" xref="S6.Ex19.m1.1.1.cmml"><mtext id="S6.Ex19.m1.1.1.2" xref="S6.Ex19.m1.1.1.2a.cmml">Outer</mtext><mi id="S6.Ex19.m1.1.1.3" xref="S6.Ex19.m1.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S6.Ex19.m1.1b"><apply id="S6.Ex19.m1.1.1.cmml" xref="S6.Ex19.m1.1.1"><csymbol cd="ambiguous" id="S6.Ex19.m1.1.1.1.cmml" xref="S6.Ex19.m1.1.1">subscript</csymbol><ci id="S6.Ex19.m1.1.1.2a.cmml" xref="S6.Ex19.m1.1.1.2"><mtext id="S6.Ex19.m1.1.1.2.cmml" xref="S6.Ex19.m1.1.1.2">Outer</mtext></ci><ci id="S6.Ex19.m1.1.1.3.cmml" xref="S6.Ex19.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex19.m1.1c">\displaystyle\text{Outer}_{L}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex19.m2.1" class="ltx_Math" alttext="\displaystyle\to\text{Sidewalk}\ \text{Buildings}\ \text{Buildings}\ \text{Foliage}" display="inline"><semantics id="S6.Ex19.m2.1a"><mrow id="S6.Ex19.m2.1.1" xref="S6.Ex19.m2.1.1.cmml"><mi id="S6.Ex19.m2.1.1.2" xref="S6.Ex19.m2.1.1.2.cmml"></mi><mo stretchy="false" id="S6.Ex19.m2.1.1.1" xref="S6.Ex19.m2.1.1.1.cmml">→</mo><mrow id="S6.Ex19.m2.1.1.3" xref="S6.Ex19.m2.1.1.3.cmml"><mtext id="S6.Ex19.m2.1.1.3.2" xref="S6.Ex19.m2.1.1.3.2a.cmml">Sidewalk</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex19.m2.1.1.3.1" xref="S6.Ex19.m2.1.1.3.1.cmml">​</mo><mtext id="S6.Ex19.m2.1.1.3.3" xref="S6.Ex19.m2.1.1.3.3a.cmml">Buildings</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex19.m2.1.1.3.1a" xref="S6.Ex19.m2.1.1.3.1.cmml">​</mo><mtext id="S6.Ex19.m2.1.1.3.4" xref="S6.Ex19.m2.1.1.3.4a.cmml">Buildings</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex19.m2.1.1.3.1b" xref="S6.Ex19.m2.1.1.3.1.cmml">​</mo><mtext id="S6.Ex19.m2.1.1.3.5" xref="S6.Ex19.m2.1.1.3.5a.cmml">Foliage</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex19.m2.1b"><apply id="S6.Ex19.m2.1.1.cmml" xref="S6.Ex19.m2.1.1"><ci id="S6.Ex19.m2.1.1.1.cmml" xref="S6.Ex19.m2.1.1.1">→</ci><csymbol cd="latexml" id="S6.Ex19.m2.1.1.2.cmml" xref="S6.Ex19.m2.1.1.2">absent</csymbol><apply id="S6.Ex19.m2.1.1.3.cmml" xref="S6.Ex19.m2.1.1.3"><times id="S6.Ex19.m2.1.1.3.1.cmml" xref="S6.Ex19.m2.1.1.3.1"></times><ci id="S6.Ex19.m2.1.1.3.2a.cmml" xref="S6.Ex19.m2.1.1.3.2"><mtext id="S6.Ex19.m2.1.1.3.2.cmml" xref="S6.Ex19.m2.1.1.3.2">Sidewalk</mtext></ci><ci id="S6.Ex19.m2.1.1.3.3a.cmml" xref="S6.Ex19.m2.1.1.3.3"><mtext id="S6.Ex19.m2.1.1.3.3.cmml" xref="S6.Ex19.m2.1.1.3.3">Buildings</mtext></ci><ci id="S6.Ex19.m2.1.1.3.4a.cmml" xref="S6.Ex19.m2.1.1.3.4"><mtext id="S6.Ex19.m2.1.1.3.4.cmml" xref="S6.Ex19.m2.1.1.3.4">Buildings</mtext></ci><ci id="S6.Ex19.m2.1.1.3.5a.cmml" xref="S6.Ex19.m2.1.1.3.5"><mtext id="S6.Ex19.m2.1.1.3.5.cmml" xref="S6.Ex19.m2.1.1.3.5">Foliage</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex19.m2.1c">\displaystyle\to\text{Sidewalk}\ \text{Buildings}\ \text{Buildings}\ \text{Foliage}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S6.Ex20.m1.1" class="ltx_Math" alttext="\displaystyle\text{Outer}_{R}" display="inline"><semantics id="S6.Ex20.m1.1a"><msub id="S6.Ex20.m1.1.1" xref="S6.Ex20.m1.1.1.cmml"><mtext id="S6.Ex20.m1.1.1.2" xref="S6.Ex20.m1.1.1.2a.cmml">Outer</mtext><mi id="S6.Ex20.m1.1.1.3" xref="S6.Ex20.m1.1.1.3.cmml">R</mi></msub><annotation-xml encoding="MathML-Content" id="S6.Ex20.m1.1b"><apply id="S6.Ex20.m1.1.1.cmml" xref="S6.Ex20.m1.1.1"><csymbol cd="ambiguous" id="S6.Ex20.m1.1.1.1.cmml" xref="S6.Ex20.m1.1.1">subscript</csymbol><ci id="S6.Ex20.m1.1.1.2a.cmml" xref="S6.Ex20.m1.1.1.2"><mtext id="S6.Ex20.m1.1.1.2.cmml" xref="S6.Ex20.m1.1.1.2">Outer</mtext></ci><ci id="S6.Ex20.m1.1.1.3.cmml" xref="S6.Ex20.m1.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex20.m1.1c">\displaystyle\text{Outer}_{R}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex20.m2.1" class="ltx_Math" alttext="\displaystyle\to\text{Sidewalk}\ \text{Buildings}\ \text{Buildings}\ \text{Foliage}" display="inline"><semantics id="S6.Ex20.m2.1a"><mrow id="S6.Ex20.m2.1.1" xref="S6.Ex20.m2.1.1.cmml"><mi id="S6.Ex20.m2.1.1.2" xref="S6.Ex20.m2.1.1.2.cmml"></mi><mo stretchy="false" id="S6.Ex20.m2.1.1.1" xref="S6.Ex20.m2.1.1.1.cmml">→</mo><mrow id="S6.Ex20.m2.1.1.3" xref="S6.Ex20.m2.1.1.3.cmml"><mtext id="S6.Ex20.m2.1.1.3.2" xref="S6.Ex20.m2.1.1.3.2a.cmml">Sidewalk</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex20.m2.1.1.3.1" xref="S6.Ex20.m2.1.1.3.1.cmml">​</mo><mtext id="S6.Ex20.m2.1.1.3.3" xref="S6.Ex20.m2.1.1.3.3a.cmml">Buildings</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex20.m2.1.1.3.1a" xref="S6.Ex20.m2.1.1.3.1.cmml">​</mo><mtext id="S6.Ex20.m2.1.1.3.4" xref="S6.Ex20.m2.1.1.3.4a.cmml">Buildings</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex20.m2.1.1.3.1b" xref="S6.Ex20.m2.1.1.3.1.cmml">​</mo><mtext id="S6.Ex20.m2.1.1.3.5" xref="S6.Ex20.m2.1.1.3.5a.cmml">Foliage</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex20.m2.1b"><apply id="S6.Ex20.m2.1.1.cmml" xref="S6.Ex20.m2.1.1"><ci id="S6.Ex20.m2.1.1.1.cmml" xref="S6.Ex20.m2.1.1.1">→</ci><csymbol cd="latexml" id="S6.Ex20.m2.1.1.2.cmml" xref="S6.Ex20.m2.1.1.2">absent</csymbol><apply id="S6.Ex20.m2.1.1.3.cmml" xref="S6.Ex20.m2.1.1.3"><times id="S6.Ex20.m2.1.1.3.1.cmml" xref="S6.Ex20.m2.1.1.3.1"></times><ci id="S6.Ex20.m2.1.1.3.2a.cmml" xref="S6.Ex20.m2.1.1.3.2"><mtext id="S6.Ex20.m2.1.1.3.2.cmml" xref="S6.Ex20.m2.1.1.3.2">Sidewalk</mtext></ci><ci id="S6.Ex20.m2.1.1.3.3a.cmml" xref="S6.Ex20.m2.1.1.3.3"><mtext id="S6.Ex20.m2.1.1.3.3.cmml" xref="S6.Ex20.m2.1.1.3.3">Buildings</mtext></ci><ci id="S6.Ex20.m2.1.1.3.4a.cmml" xref="S6.Ex20.m2.1.1.3.4"><mtext id="S6.Ex20.m2.1.1.3.4.cmml" xref="S6.Ex20.m2.1.1.3.4">Buildings</mtext></ci><ci id="S6.Ex20.m2.1.1.3.5a.cmml" xref="S6.Ex20.m2.1.1.3.5"><mtext id="S6.Ex20.m2.1.1.3.5.cmml" xref="S6.Ex20.m2.1.1.3.5">Foliage</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex20.m2.1c">\displaystyle\to\text{Sidewalk}\ \text{Buildings}\ \text{Buildings}\ \text{Foliage}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex21"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S6.Ex21.2.1.1.1" class="ltx_text ltx_markedasmath">Cars</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex21.m2.1" class="ltx_Math" alttext="\displaystyle\to\text{car}\ |\ \epsilon\ |\ \text{Cars}" display="inline"><semantics id="S6.Ex21.m2.1a"><mrow id="S6.Ex21.m2.1.2" xref="S6.Ex21.m2.1.2.cmml"><mi id="S6.Ex21.m2.1.2.2" xref="S6.Ex21.m2.1.2.2.cmml"></mi><mo stretchy="false" id="S6.Ex21.m2.1.2.1" xref="S6.Ex21.m2.1.2.1.cmml">→</mo><mrow id="S6.Ex21.m2.1.2.3" xref="S6.Ex21.m2.1.2.3.cmml"><mtext id="S6.Ex21.m2.1.2.3.2" xref="S6.Ex21.m2.1.2.3.2a.cmml">car</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex21.m2.1.2.3.1" xref="S6.Ex21.m2.1.2.3.1.cmml">​</mo><mrow id="S6.Ex21.m2.1.2.3.3.2" xref="S6.Ex21.m2.1.2.3.3.1.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex21.m2.1.2.3.3.2.1" xref="S6.Ex21.m2.1.2.3.3.1.1.cmml">|</mo><mi id="S6.Ex21.m2.1.1" xref="S6.Ex21.m2.1.1.cmml">ϵ</mi><mo lspace="0.500em" stretchy="false" id="S6.Ex21.m2.1.2.3.3.2.2" xref="S6.Ex21.m2.1.2.3.3.1.1.cmml">|</mo></mrow><mo lspace="0.500em" rspace="0em" id="S6.Ex21.m2.1.2.3.1a" xref="S6.Ex21.m2.1.2.3.1.cmml">​</mo><mtext id="S6.Ex21.m2.1.2.3.4" xref="S6.Ex21.m2.1.2.3.4a.cmml">Cars</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex21.m2.1b"><apply id="S6.Ex21.m2.1.2.cmml" xref="S6.Ex21.m2.1.2"><ci id="S6.Ex21.m2.1.2.1.cmml" xref="S6.Ex21.m2.1.2.1">→</ci><csymbol cd="latexml" id="S6.Ex21.m2.1.2.2.cmml" xref="S6.Ex21.m2.1.2.2">absent</csymbol><apply id="S6.Ex21.m2.1.2.3.cmml" xref="S6.Ex21.m2.1.2.3"><times id="S6.Ex21.m2.1.2.3.1.cmml" xref="S6.Ex21.m2.1.2.3.1"></times><ci id="S6.Ex21.m2.1.2.3.2a.cmml" xref="S6.Ex21.m2.1.2.3.2"><mtext id="S6.Ex21.m2.1.2.3.2.cmml" xref="S6.Ex21.m2.1.2.3.2">car</mtext></ci><apply id="S6.Ex21.m2.1.2.3.3.1.cmml" xref="S6.Ex21.m2.1.2.3.3.2"><abs id="S6.Ex21.m2.1.2.3.3.1.1.cmml" xref="S6.Ex21.m2.1.2.3.3.2.1"></abs><ci id="S6.Ex21.m2.1.1.cmml" xref="S6.Ex21.m2.1.1">italic-ϵ</ci></apply><ci id="S6.Ex21.m2.1.2.3.4a.cmml" xref="S6.Ex21.m2.1.2.3.4"><mtext id="S6.Ex21.m2.1.2.3.4.cmml" xref="S6.Ex21.m2.1.2.3.4">Cars</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex21.m2.1c">\displaystyle\to\text{car}\ |\ \epsilon\ |\ \text{Cars}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex22"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S6.Ex22.2.1.1.1" class="ltx_text ltx_markedasmath">Foliage</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex22.m2.1" class="ltx_Math" alttext="\displaystyle\to\text{tree}\ |\ \epsilon\ |\ \text{Foliage}" display="inline"><semantics id="S6.Ex22.m2.1a"><mrow id="S6.Ex22.m2.1.2" xref="S6.Ex22.m2.1.2.cmml"><mi id="S6.Ex22.m2.1.2.2" xref="S6.Ex22.m2.1.2.2.cmml"></mi><mo stretchy="false" id="S6.Ex22.m2.1.2.1" xref="S6.Ex22.m2.1.2.1.cmml">→</mo><mrow id="S6.Ex22.m2.1.2.3" xref="S6.Ex22.m2.1.2.3.cmml"><mtext id="S6.Ex22.m2.1.2.3.2" xref="S6.Ex22.m2.1.2.3.2a.cmml">tree</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex22.m2.1.2.3.1" xref="S6.Ex22.m2.1.2.3.1.cmml">​</mo><mrow id="S6.Ex22.m2.1.2.3.3.2" xref="S6.Ex22.m2.1.2.3.3.1.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex22.m2.1.2.3.3.2.1" xref="S6.Ex22.m2.1.2.3.3.1.1.cmml">|</mo><mi id="S6.Ex22.m2.1.1" xref="S6.Ex22.m2.1.1.cmml">ϵ</mi><mo lspace="0.500em" stretchy="false" id="S6.Ex22.m2.1.2.3.3.2.2" xref="S6.Ex22.m2.1.2.3.3.1.1.cmml">|</mo></mrow><mo lspace="0.500em" rspace="0em" id="S6.Ex22.m2.1.2.3.1a" xref="S6.Ex22.m2.1.2.3.1.cmml">​</mo><mtext id="S6.Ex22.m2.1.2.3.4" xref="S6.Ex22.m2.1.2.3.4a.cmml">Foliage</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex22.m2.1b"><apply id="S6.Ex22.m2.1.2.cmml" xref="S6.Ex22.m2.1.2"><ci id="S6.Ex22.m2.1.2.1.cmml" xref="S6.Ex22.m2.1.2.1">→</ci><csymbol cd="latexml" id="S6.Ex22.m2.1.2.2.cmml" xref="S6.Ex22.m2.1.2.2">absent</csymbol><apply id="S6.Ex22.m2.1.2.3.cmml" xref="S6.Ex22.m2.1.2.3"><times id="S6.Ex22.m2.1.2.3.1.cmml" xref="S6.Ex22.m2.1.2.3.1"></times><ci id="S6.Ex22.m2.1.2.3.2a.cmml" xref="S6.Ex22.m2.1.2.3.2"><mtext id="S6.Ex22.m2.1.2.3.2.cmml" xref="S6.Ex22.m2.1.2.3.2">tree</mtext></ci><apply id="S6.Ex22.m2.1.2.3.3.1.cmml" xref="S6.Ex22.m2.1.2.3.3.2"><abs id="S6.Ex22.m2.1.2.3.3.1.1.cmml" xref="S6.Ex22.m2.1.2.3.3.2.1"></abs><ci id="S6.Ex22.m2.1.1.cmml" xref="S6.Ex22.m2.1.1">italic-ϵ</ci></apply><ci id="S6.Ex22.m2.1.2.3.4a.cmml" xref="S6.Ex22.m2.1.2.3.4"><mtext id="S6.Ex22.m2.1.2.3.4.cmml" xref="S6.Ex22.m2.1.2.3.4">Foliage</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex22.m2.1c">\displaystyle\to\text{tree}\ |\ \epsilon\ |\ \text{Foliage}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex23"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S6.Ex23.2.1.1.1" class="ltx_text ltx_markedasmath">Buildings</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex23.m2.1" class="ltx_Math" alttext="\displaystyle\to\text{building}\ |\ \epsilon\ |\ \text{Buildings}" display="inline"><semantics id="S6.Ex23.m2.1a"><mrow id="S6.Ex23.m2.1.2" xref="S6.Ex23.m2.1.2.cmml"><mi id="S6.Ex23.m2.1.2.2" xref="S6.Ex23.m2.1.2.2.cmml"></mi><mo stretchy="false" id="S6.Ex23.m2.1.2.1" xref="S6.Ex23.m2.1.2.1.cmml">→</mo><mrow id="S6.Ex23.m2.1.2.3" xref="S6.Ex23.m2.1.2.3.cmml"><mtext id="S6.Ex23.m2.1.2.3.2" xref="S6.Ex23.m2.1.2.3.2a.cmml">building</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex23.m2.1.2.3.1" xref="S6.Ex23.m2.1.2.3.1.cmml">​</mo><mrow id="S6.Ex23.m2.1.2.3.3.2" xref="S6.Ex23.m2.1.2.3.3.1.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex23.m2.1.2.3.3.2.1" xref="S6.Ex23.m2.1.2.3.3.1.1.cmml">|</mo><mi id="S6.Ex23.m2.1.1" xref="S6.Ex23.m2.1.1.cmml">ϵ</mi><mo lspace="0.500em" stretchy="false" id="S6.Ex23.m2.1.2.3.3.2.2" xref="S6.Ex23.m2.1.2.3.3.1.1.cmml">|</mo></mrow><mo lspace="0.500em" rspace="0em" id="S6.Ex23.m2.1.2.3.1a" xref="S6.Ex23.m2.1.2.3.1.cmml">​</mo><mtext id="S6.Ex23.m2.1.2.3.4" xref="S6.Ex23.m2.1.2.3.4a.cmml">Buildings</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex23.m2.1b"><apply id="S6.Ex23.m2.1.2.cmml" xref="S6.Ex23.m2.1.2"><ci id="S6.Ex23.m2.1.2.1.cmml" xref="S6.Ex23.m2.1.2.1">→</ci><csymbol cd="latexml" id="S6.Ex23.m2.1.2.2.cmml" xref="S6.Ex23.m2.1.2.2">absent</csymbol><apply id="S6.Ex23.m2.1.2.3.cmml" xref="S6.Ex23.m2.1.2.3"><times id="S6.Ex23.m2.1.2.3.1.cmml" xref="S6.Ex23.m2.1.2.3.1"></times><ci id="S6.Ex23.m2.1.2.3.2a.cmml" xref="S6.Ex23.m2.1.2.3.2"><mtext id="S6.Ex23.m2.1.2.3.2.cmml" xref="S6.Ex23.m2.1.2.3.2">building</mtext></ci><apply id="S6.Ex23.m2.1.2.3.3.1.cmml" xref="S6.Ex23.m2.1.2.3.3.2"><abs id="S6.Ex23.m2.1.2.3.3.1.1.cmml" xref="S6.Ex23.m2.1.2.3.3.2.1"></abs><ci id="S6.Ex23.m2.1.1.cmml" xref="S6.Ex23.m2.1.1">italic-ϵ</ci></apply><ci id="S6.Ex23.m2.1.2.3.4a.cmml" xref="S6.Ex23.m2.1.2.3.4"><mtext id="S6.Ex23.m2.1.2.3.4.cmml" xref="S6.Ex23.m2.1.2.3.4">Buildings</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex23.m2.1c">\displaystyle\to\text{building}\ |\ \epsilon\ |\ \text{Buildings}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex24"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S6.Ex24.2.1.1.1" class="ltx_text ltx_markedasmath">Sidewalk</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex24.m2.3" class="ltx_Math" alttext="\displaystyle\to\text{pole}\ |\ \text{sign}\ |\ \text{pedestrian}\ |\ \text{object}\ |\ \text{bike}\ |\ \epsilon\ |\ \text{Sidewalk}" display="inline"><semantics id="S6.Ex24.m2.3a"><mrow id="S6.Ex24.m2.3.4" xref="S6.Ex24.m2.3.4.cmml"><mi id="S6.Ex24.m2.3.4.2" xref="S6.Ex24.m2.3.4.2.cmml"></mi><mo stretchy="false" id="S6.Ex24.m2.3.4.1" xref="S6.Ex24.m2.3.4.1.cmml">→</mo><mrow id="S6.Ex24.m2.3.4.3" xref="S6.Ex24.m2.3.4.3.cmml"><mtext id="S6.Ex24.m2.3.4.3.2" xref="S6.Ex24.m2.3.4.3.2a.cmml">pole</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex24.m2.3.4.3.1" xref="S6.Ex24.m2.3.4.3.1.cmml">​</mo><mrow id="S6.Ex24.m2.3.4.3.3.2" xref="S6.Ex24.m2.3.4.3.3.1.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex24.m2.3.4.3.3.2.1" xref="S6.Ex24.m2.3.4.3.3.1.1.cmml">|</mo><mtext id="S6.Ex24.m2.1.1" xref="S6.Ex24.m2.1.1a.cmml">sign</mtext><mo lspace="0.500em" stretchy="false" id="S6.Ex24.m2.3.4.3.3.2.2" xref="S6.Ex24.m2.3.4.3.3.1.1.cmml">|</mo></mrow><mo lspace="0.500em" rspace="0em" id="S6.Ex24.m2.3.4.3.1a" xref="S6.Ex24.m2.3.4.3.1.cmml">​</mo><mtext id="S6.Ex24.m2.3.4.3.4" xref="S6.Ex24.m2.3.4.3.4a.cmml">pedestrian</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex24.m2.3.4.3.1b" xref="S6.Ex24.m2.3.4.3.1.cmml">​</mo><mrow id="S6.Ex24.m2.3.4.3.5.2" xref="S6.Ex24.m2.3.4.3.5.1.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex24.m2.3.4.3.5.2.1" xref="S6.Ex24.m2.3.4.3.5.1.1.cmml">|</mo><mtext id="S6.Ex24.m2.2.2" xref="S6.Ex24.m2.2.2a.cmml">object</mtext><mo lspace="0.500em" stretchy="false" id="S6.Ex24.m2.3.4.3.5.2.2" xref="S6.Ex24.m2.3.4.3.5.1.1.cmml">|</mo></mrow><mo lspace="0.500em" rspace="0em" id="S6.Ex24.m2.3.4.3.1c" xref="S6.Ex24.m2.3.4.3.1.cmml">​</mo><mtext id="S6.Ex24.m2.3.4.3.6" xref="S6.Ex24.m2.3.4.3.6a.cmml">bike</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex24.m2.3.4.3.1d" xref="S6.Ex24.m2.3.4.3.1.cmml">​</mo><mrow id="S6.Ex24.m2.3.4.3.7.2" xref="S6.Ex24.m2.3.4.3.7.1.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex24.m2.3.4.3.7.2.1" xref="S6.Ex24.m2.3.4.3.7.1.1.cmml">|</mo><mi id="S6.Ex24.m2.3.3" xref="S6.Ex24.m2.3.3.cmml">ϵ</mi><mo lspace="0.500em" stretchy="false" id="S6.Ex24.m2.3.4.3.7.2.2" xref="S6.Ex24.m2.3.4.3.7.1.1.cmml">|</mo></mrow><mo lspace="0.500em" rspace="0em" id="S6.Ex24.m2.3.4.3.1e" xref="S6.Ex24.m2.3.4.3.1.cmml">​</mo><mtext id="S6.Ex24.m2.3.4.3.8" xref="S6.Ex24.m2.3.4.3.8a.cmml">Sidewalk</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex24.m2.3b"><apply id="S6.Ex24.m2.3.4.cmml" xref="S6.Ex24.m2.3.4"><ci id="S6.Ex24.m2.3.4.1.cmml" xref="S6.Ex24.m2.3.4.1">→</ci><csymbol cd="latexml" id="S6.Ex24.m2.3.4.2.cmml" xref="S6.Ex24.m2.3.4.2">absent</csymbol><apply id="S6.Ex24.m2.3.4.3.cmml" xref="S6.Ex24.m2.3.4.3"><times id="S6.Ex24.m2.3.4.3.1.cmml" xref="S6.Ex24.m2.3.4.3.1"></times><ci id="S6.Ex24.m2.3.4.3.2a.cmml" xref="S6.Ex24.m2.3.4.3.2"><mtext id="S6.Ex24.m2.3.4.3.2.cmml" xref="S6.Ex24.m2.3.4.3.2">pole</mtext></ci><apply id="S6.Ex24.m2.3.4.3.3.1.cmml" xref="S6.Ex24.m2.3.4.3.3.2"><abs id="S6.Ex24.m2.3.4.3.3.1.1.cmml" xref="S6.Ex24.m2.3.4.3.3.2.1"></abs><ci id="S6.Ex24.m2.1.1a.cmml" xref="S6.Ex24.m2.1.1"><mtext id="S6.Ex24.m2.1.1.cmml" xref="S6.Ex24.m2.1.1">sign</mtext></ci></apply><ci id="S6.Ex24.m2.3.4.3.4a.cmml" xref="S6.Ex24.m2.3.4.3.4"><mtext id="S6.Ex24.m2.3.4.3.4.cmml" xref="S6.Ex24.m2.3.4.3.4">pedestrian</mtext></ci><apply id="S6.Ex24.m2.3.4.3.5.1.cmml" xref="S6.Ex24.m2.3.4.3.5.2"><abs id="S6.Ex24.m2.3.4.3.5.1.1.cmml" xref="S6.Ex24.m2.3.4.3.5.2.1"></abs><ci id="S6.Ex24.m2.2.2a.cmml" xref="S6.Ex24.m2.2.2"><mtext id="S6.Ex24.m2.2.2.cmml" xref="S6.Ex24.m2.2.2">object</mtext></ci></apply><ci id="S6.Ex24.m2.3.4.3.6a.cmml" xref="S6.Ex24.m2.3.4.3.6"><mtext id="S6.Ex24.m2.3.4.3.6.cmml" xref="S6.Ex24.m2.3.4.3.6">bike</mtext></ci><apply id="S6.Ex24.m2.3.4.3.7.1.cmml" xref="S6.Ex24.m2.3.4.3.7.2"><abs id="S6.Ex24.m2.3.4.3.7.1.1.cmml" xref="S6.Ex24.m2.3.4.3.7.2.1"></abs><ci id="S6.Ex24.m2.3.3.cmml" xref="S6.Ex24.m2.3.3">italic-ϵ</ci></apply><ci id="S6.Ex24.m2.3.4.3.8a.cmml" xref="S6.Ex24.m2.3.4.3.8"><mtext id="S6.Ex24.m2.3.4.3.8.cmml" xref="S6.Ex24.m2.3.4.3.8">Sidewalk</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex24.m2.3c">\displaystyle\to\text{pole}\ |\ \text{sign}\ |\ \text{pedestrian}\ |\ \text{object}\ |\ \text{bike}\ |\ \epsilon\ |\ \text{Sidewalk}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex25"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S6.Ex25.2.1.1.1" class="ltx_text ltx_markedasmath">Median</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex25.m2.2" class="ltx_Math" alttext="\displaystyle\to\ \text{bush}\ |\ \text{object}\ |\ \text{tree}\ |\ \epsilon\ |\ M" display="inline"><semantics id="S6.Ex25.m2.2a"><mrow id="S6.Ex25.m2.2.3" xref="S6.Ex25.m2.2.3.cmml"><mi id="S6.Ex25.m2.2.3.2" xref="S6.Ex25.m2.2.3.2.cmml"></mi><mo rspace="0.778em" stretchy="false" id="S6.Ex25.m2.2.3.1" xref="S6.Ex25.m2.2.3.1.cmml">→</mo><mrow id="S6.Ex25.m2.2.3.3" xref="S6.Ex25.m2.2.3.3.cmml"><mtext id="S6.Ex25.m2.2.3.3.2" xref="S6.Ex25.m2.2.3.3.2a.cmml">bush</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex25.m2.2.3.3.1" xref="S6.Ex25.m2.2.3.3.1.cmml">​</mo><mrow id="S6.Ex25.m2.2.3.3.3.2" xref="S6.Ex25.m2.2.3.3.3.1.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex25.m2.2.3.3.3.2.1" xref="S6.Ex25.m2.2.3.3.3.1.1.cmml">|</mo><mtext id="S6.Ex25.m2.1.1" xref="S6.Ex25.m2.1.1a.cmml">object</mtext><mo lspace="0.500em" stretchy="false" id="S6.Ex25.m2.2.3.3.3.2.2" xref="S6.Ex25.m2.2.3.3.3.1.1.cmml">|</mo></mrow><mo lspace="0.500em" rspace="0em" id="S6.Ex25.m2.2.3.3.1a" xref="S6.Ex25.m2.2.3.3.1.cmml">​</mo><mtext id="S6.Ex25.m2.2.3.3.4" xref="S6.Ex25.m2.2.3.3.4a.cmml">tree</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex25.m2.2.3.3.1b" xref="S6.Ex25.m2.2.3.3.1.cmml">​</mo><mrow id="S6.Ex25.m2.2.3.3.5.2" xref="S6.Ex25.m2.2.3.3.5.1.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex25.m2.2.3.3.5.2.1" xref="S6.Ex25.m2.2.3.3.5.1.1.cmml">|</mo><mi id="S6.Ex25.m2.2.2" xref="S6.Ex25.m2.2.2.cmml">ϵ</mi><mo lspace="0.500em" stretchy="false" id="S6.Ex25.m2.2.3.3.5.2.2" xref="S6.Ex25.m2.2.3.3.5.1.1.cmml">|</mo></mrow><mo lspace="0.500em" rspace="0em" id="S6.Ex25.m2.2.3.3.1c" xref="S6.Ex25.m2.2.3.3.1.cmml">​</mo><mi id="S6.Ex25.m2.2.3.3.6" xref="S6.Ex25.m2.2.3.3.6.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex25.m2.2b"><apply id="S6.Ex25.m2.2.3.cmml" xref="S6.Ex25.m2.2.3"><ci id="S6.Ex25.m2.2.3.1.cmml" xref="S6.Ex25.m2.2.3.1">→</ci><csymbol cd="latexml" id="S6.Ex25.m2.2.3.2.cmml" xref="S6.Ex25.m2.2.3.2">absent</csymbol><apply id="S6.Ex25.m2.2.3.3.cmml" xref="S6.Ex25.m2.2.3.3"><times id="S6.Ex25.m2.2.3.3.1.cmml" xref="S6.Ex25.m2.2.3.3.1"></times><ci id="S6.Ex25.m2.2.3.3.2a.cmml" xref="S6.Ex25.m2.2.3.3.2"><mtext id="S6.Ex25.m2.2.3.3.2.cmml" xref="S6.Ex25.m2.2.3.3.2">bush</mtext></ci><apply id="S6.Ex25.m2.2.3.3.3.1.cmml" xref="S6.Ex25.m2.2.3.3.3.2"><abs id="S6.Ex25.m2.2.3.3.3.1.1.cmml" xref="S6.Ex25.m2.2.3.3.3.2.1"></abs><ci id="S6.Ex25.m2.1.1a.cmml" xref="S6.Ex25.m2.1.1"><mtext id="S6.Ex25.m2.1.1.cmml" xref="S6.Ex25.m2.1.1">object</mtext></ci></apply><ci id="S6.Ex25.m2.2.3.3.4a.cmml" xref="S6.Ex25.m2.2.3.3.4"><mtext id="S6.Ex25.m2.2.3.3.4.cmml" xref="S6.Ex25.m2.2.3.3.4">tree</mtext></ci><apply id="S6.Ex25.m2.2.3.3.5.1.cmml" xref="S6.Ex25.m2.2.3.3.5.2"><abs id="S6.Ex25.m2.2.3.3.5.1.1.cmml" xref="S6.Ex25.m2.2.3.3.5.2.1"></abs><ci id="S6.Ex25.m2.2.2.cmml" xref="S6.Ex25.m2.2.2">italic-ϵ</ci></apply><ci id="S6.Ex25.m2.2.3.3.6.cmml" xref="S6.Ex25.m2.2.3.3.6">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex25.m2.2c">\displaystyle\to\ \text{bush}\ |\ \text{object}\ |\ \text{tree}\ |\ \epsilon\ |\ M</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S6.SS1.SSS4.p2.2" class="ltx_p">The suburban grammar is a restriction of the city grammar, specifically having one collection of buildings in the <math id="S6.SS1.SSS4.p2.1.m1.1" class="ltx_Math" alttext="\text{Outer}_{L}" display="inline"><semantics id="S6.SS1.SSS4.p2.1.m1.1a"><msub id="S6.SS1.SSS4.p2.1.m1.1.1" xref="S6.SS1.SSS4.p2.1.m1.1.1.cmml"><mtext id="S6.SS1.SSS4.p2.1.m1.1.1.2" xref="S6.SS1.SSS4.p2.1.m1.1.1.2a.cmml">Outer</mtext><mi id="S6.SS1.SSS4.p2.1.m1.1.1.3" xref="S6.SS1.SSS4.p2.1.m1.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p2.1.m1.1b"><apply id="S6.SS1.SSS4.p2.1.m1.1.1.cmml" xref="S6.SS1.SSS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p2.1.m1.1.1.1.cmml" xref="S6.SS1.SSS4.p2.1.m1.1.1">subscript</csymbol><ci id="S6.SS1.SSS4.p2.1.m1.1.1.2a.cmml" xref="S6.SS1.SSS4.p2.1.m1.1.1.2"><mtext id="S6.SS1.SSS4.p2.1.m1.1.1.2.cmml" xref="S6.SS1.SSS4.p2.1.m1.1.1.2">Outer</mtext></ci><ci id="S6.SS1.SSS4.p2.1.m1.1.1.3.cmml" xref="S6.SS1.SSS4.p2.1.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p2.1.m1.1c">\text{Outer}_{L}</annotation></semantics></math> and <math id="S6.SS1.SSS4.p2.2.m2.1" class="ltx_Math" alttext="\text{Outer}_{R}" display="inline"><semantics id="S6.SS1.SSS4.p2.2.m2.1a"><msub id="S6.SS1.SSS4.p2.2.m2.1.1" xref="S6.SS1.SSS4.p2.2.m2.1.1.cmml"><mtext id="S6.SS1.SSS4.p2.2.m2.1.1.2" xref="S6.SS1.SSS4.p2.2.m2.1.1.2a.cmml">Outer</mtext><mi id="S6.SS1.SSS4.p2.2.m2.1.1.3" xref="S6.SS1.SSS4.p2.2.m2.1.1.3.cmml">R</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p2.2.m2.1b"><apply id="S6.SS1.SSS4.p2.2.m2.1.1.cmml" xref="S6.SS1.SSS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p2.2.m2.1.1.1.cmml" xref="S6.SS1.SSS4.p2.2.m2.1.1">subscript</csymbol><ci id="S6.SS1.SSS4.p2.2.m2.1.1.2a.cmml" xref="S6.SS1.SSS4.p2.2.m2.1.1.2"><mtext id="S6.SS1.SSS4.p2.2.m2.1.1.2.cmml" xref="S6.SS1.SSS4.p2.2.m2.1.1.2">Outer</mtext></ci><ci id="S6.SS1.SSS4.p2.2.m2.1.1.3.cmml" xref="S6.SS1.SSS4.p2.2.m2.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p2.2.m2.1c">\text{Outer}_{R}</annotation></semantics></math> non-terminals.</p>
<table id="S6.EGx12" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S6.Ex26"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S6.Ex26.m1.1" class="ltx_Math" alttext="\displaystyle\text{S}_{\text{suburban}}" display="inline"><semantics id="S6.Ex26.m1.1a"><msub id="S6.Ex26.m1.1.1" xref="S6.Ex26.m1.1.1.cmml"><mtext id="S6.Ex26.m1.1.1.2" xref="S6.Ex26.m1.1.1.2a.cmml">S</mtext><mtext id="S6.Ex26.m1.1.1.3" xref="S6.Ex26.m1.1.1.3a.cmml">suburban</mtext></msub><annotation-xml encoding="MathML-Content" id="S6.Ex26.m1.1b"><apply id="S6.Ex26.m1.1.1.cmml" xref="S6.Ex26.m1.1.1"><csymbol cd="ambiguous" id="S6.Ex26.m1.1.1.1.cmml" xref="S6.Ex26.m1.1.1">subscript</csymbol><ci id="S6.Ex26.m1.1.1.2a.cmml" xref="S6.Ex26.m1.1.1.2"><mtext id="S6.Ex26.m1.1.1.2.cmml" xref="S6.Ex26.m1.1.1.2">S</mtext></ci><ci id="S6.Ex26.m1.1.1.3a.cmml" xref="S6.Ex26.m1.1.1.3"><mtext mathsize="70%" id="S6.Ex26.m1.1.1.3.cmml" xref="S6.Ex26.m1.1.1.3">suburban</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex26.m1.1c">\displaystyle\text{S}_{\text{suburban}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex26.m2.3" class="ltx_Math" alttext="\displaystyle\to\text{Street}\ \ \text{Outer}_{L}\ \ \text{Outer}_{R}" display="inline"><semantics id="S6.Ex26.m2.3a"><mrow id="S6.Ex26.m2.3.3" xref="S6.Ex26.m2.3.3.cmml"><mi id="S6.Ex26.m2.3.3.4" xref="S6.Ex26.m2.3.3.4.cmml"></mi><mo stretchy="false" id="S6.Ex26.m2.3.3.3" xref="S6.Ex26.m2.3.3.3.cmml">→</mo><mrow id="S6.Ex26.m2.3.3.2.2" xref="S6.Ex26.m2.3.3.2.3.cmml"><mtext id="S6.Ex26.m2.1.1" xref="S6.Ex26.m2.1.1a.cmml">Street</mtext><mspace width="1em" id="S6.Ex26.m2.3.3.2.2.3" xref="S6.Ex26.m2.3.3.2.3.cmml"></mspace><msub id="S6.Ex26.m2.2.2.1.1.1" xref="S6.Ex26.m2.2.2.1.1.1.cmml"><mtext id="S6.Ex26.m2.2.2.1.1.1.2" xref="S6.Ex26.m2.2.2.1.1.1.2a.cmml">Outer</mtext><mi id="S6.Ex26.m2.2.2.1.1.1.3" xref="S6.Ex26.m2.2.2.1.1.1.3.cmml">L</mi></msub><mspace width="1em" id="S6.Ex26.m2.3.3.2.2.4" xref="S6.Ex26.m2.3.3.2.3.cmml"></mspace><msub id="S6.Ex26.m2.3.3.2.2.2" xref="S6.Ex26.m2.3.3.2.2.2.cmml"><mtext id="S6.Ex26.m2.3.3.2.2.2.2" xref="S6.Ex26.m2.3.3.2.2.2.2a.cmml">Outer</mtext><mi id="S6.Ex26.m2.3.3.2.2.2.3" xref="S6.Ex26.m2.3.3.2.2.2.3.cmml">R</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex26.m2.3b"><apply id="S6.Ex26.m2.3.3.cmml" xref="S6.Ex26.m2.3.3"><ci id="S6.Ex26.m2.3.3.3.cmml" xref="S6.Ex26.m2.3.3.3">→</ci><csymbol cd="latexml" id="S6.Ex26.m2.3.3.4.cmml" xref="S6.Ex26.m2.3.3.4">absent</csymbol><list id="S6.Ex26.m2.3.3.2.3.cmml" xref="S6.Ex26.m2.3.3.2.2"><ci id="S6.Ex26.m2.1.1a.cmml" xref="S6.Ex26.m2.1.1"><mtext id="S6.Ex26.m2.1.1.cmml" xref="S6.Ex26.m2.1.1">Street</mtext></ci><apply id="S6.Ex26.m2.2.2.1.1.1.cmml" xref="S6.Ex26.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.Ex26.m2.2.2.1.1.1.1.cmml" xref="S6.Ex26.m2.2.2.1.1.1">subscript</csymbol><ci id="S6.Ex26.m2.2.2.1.1.1.2a.cmml" xref="S6.Ex26.m2.2.2.1.1.1.2"><mtext id="S6.Ex26.m2.2.2.1.1.1.2.cmml" xref="S6.Ex26.m2.2.2.1.1.1.2">Outer</mtext></ci><ci id="S6.Ex26.m2.2.2.1.1.1.3.cmml" xref="S6.Ex26.m2.2.2.1.1.1.3">𝐿</ci></apply><apply id="S6.Ex26.m2.3.3.2.2.2.cmml" xref="S6.Ex26.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.Ex26.m2.3.3.2.2.2.1.cmml" xref="S6.Ex26.m2.3.3.2.2.2">subscript</csymbol><ci id="S6.Ex26.m2.3.3.2.2.2.2a.cmml" xref="S6.Ex26.m2.3.3.2.2.2.2"><mtext id="S6.Ex26.m2.3.3.2.2.2.2.cmml" xref="S6.Ex26.m2.3.3.2.2.2.2">Outer</mtext></ci><ci id="S6.Ex26.m2.3.3.2.2.2.3.cmml" xref="S6.Ex26.m2.3.3.2.2.2.3">𝑅</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex26.m2.3c">\displaystyle\to\text{Street}\ \ \text{Outer}_{L}\ \ \text{Outer}_{R}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex27"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S6.Ex27.2.1.1.1" class="ltx_text ltx_markedasmath">Street</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex27.m2.1" class="ltx_math_unparsed" alttext="\displaystyle\to\text{Median}\ \text{Cars}\ |\ \text{Median}\ \text{Cars}\ \text{Cars}\ |\ \text{Cars}\ \text{Median}\ \text{Cars}\ |" display="inline"><semantics id="S6.Ex27.m2.1a"><mrow id="S6.Ex27.m2.1b"><mo stretchy="false" id="S6.Ex27.m2.1.1">→</mo><mtext id="S6.Ex27.m2.1.2">Median</mtext><mtext id="S6.Ex27.m2.1.3">Cars</mtext><mo fence="false" lspace="0.500em" rspace="0.667em" stretchy="false" id="S6.Ex27.m2.1.4">|</mo><mtext id="S6.Ex27.m2.1.5">Median</mtext><mtext id="S6.Ex27.m2.1.6">Cars</mtext><mtext id="S6.Ex27.m2.1.7">Cars</mtext><mo fence="false" lspace="0.500em" rspace="0.667em" stretchy="false" id="S6.Ex27.m2.1.8">|</mo><mtext id="S6.Ex27.m2.1.9">Cars</mtext><mtext id="S6.Ex27.m2.1.10">Median</mtext><mtext id="S6.Ex27.m2.1.11">Cars</mtext><mo fence="false" lspace="0.500em" stretchy="false" id="S6.Ex27.m2.1.12">|</mo></mrow><annotation encoding="application/x-tex" id="S6.Ex27.m2.1c">\displaystyle\to\text{Median}\ \text{Cars}\ |\ \text{Median}\ \text{Cars}\ \text{Cars}\ |\ \text{Cars}\ \text{Median}\ \text{Cars}\ |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex28"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex28.m1.1" class="ltx_Math" alttext="\displaystyle\ \text{Cars}\ \text{Median}\ \text{Cars}\ \text{Cars}\ |\ \text{Cars}\ \text{Cars}\ \text{Median}\ \text{Cars}\ |" display="inline"><semantics id="S6.Ex28.m1.1a"><mrow id="S6.Ex28.m1.1.1" xref="S6.Ex28.m1.1.1.cmml"><mtext id="S6.Ex28.m1.1.1.3" xref="S6.Ex28.m1.1.1.3a.cmml">Cars</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex28.m1.1.1.2" xref="S6.Ex28.m1.1.1.2.cmml">​</mo><mtext id="S6.Ex28.m1.1.1.4" xref="S6.Ex28.m1.1.1.4a.cmml">Median</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex28.m1.1.1.2a" xref="S6.Ex28.m1.1.1.2.cmml">​</mo><mtext id="S6.Ex28.m1.1.1.5" xref="S6.Ex28.m1.1.1.5a.cmml">Cars</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex28.m1.1.1.2b" xref="S6.Ex28.m1.1.1.2.cmml">​</mo><mtext id="S6.Ex28.m1.1.1.6" xref="S6.Ex28.m1.1.1.6a.cmml">Cars</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex28.m1.1.1.2c" xref="S6.Ex28.m1.1.1.2.cmml">​</mo><mrow id="S6.Ex28.m1.1.1.1.1" xref="S6.Ex28.m1.1.1.1.2.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex28.m1.1.1.1.1.2" xref="S6.Ex28.m1.1.1.1.2.1.cmml">|</mo><mrow id="S6.Ex28.m1.1.1.1.1.1" xref="S6.Ex28.m1.1.1.1.1.1.cmml"><mtext id="S6.Ex28.m1.1.1.1.1.1.2" xref="S6.Ex28.m1.1.1.1.1.1.2a.cmml">Cars</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex28.m1.1.1.1.1.1.1" xref="S6.Ex28.m1.1.1.1.1.1.1.cmml">​</mo><mtext id="S6.Ex28.m1.1.1.1.1.1.3" xref="S6.Ex28.m1.1.1.1.1.1.3a.cmml">Cars</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex28.m1.1.1.1.1.1.1a" xref="S6.Ex28.m1.1.1.1.1.1.1.cmml">​</mo><mtext id="S6.Ex28.m1.1.1.1.1.1.4" xref="S6.Ex28.m1.1.1.1.1.1.4a.cmml">Median</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex28.m1.1.1.1.1.1.1b" xref="S6.Ex28.m1.1.1.1.1.1.1.cmml">​</mo><mtext id="S6.Ex28.m1.1.1.1.1.1.5" xref="S6.Ex28.m1.1.1.1.1.1.5a.cmml">Cars</mtext></mrow><mo lspace="0.500em" stretchy="false" id="S6.Ex28.m1.1.1.1.1.3" xref="S6.Ex28.m1.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex28.m1.1b"><apply id="S6.Ex28.m1.1.1.cmml" xref="S6.Ex28.m1.1.1"><times id="S6.Ex28.m1.1.1.2.cmml" xref="S6.Ex28.m1.1.1.2"></times><ci id="S6.Ex28.m1.1.1.3a.cmml" xref="S6.Ex28.m1.1.1.3"><mtext id="S6.Ex28.m1.1.1.3.cmml" xref="S6.Ex28.m1.1.1.3">Cars</mtext></ci><ci id="S6.Ex28.m1.1.1.4a.cmml" xref="S6.Ex28.m1.1.1.4"><mtext id="S6.Ex28.m1.1.1.4.cmml" xref="S6.Ex28.m1.1.1.4">Median</mtext></ci><ci id="S6.Ex28.m1.1.1.5a.cmml" xref="S6.Ex28.m1.1.1.5"><mtext id="S6.Ex28.m1.1.1.5.cmml" xref="S6.Ex28.m1.1.1.5">Cars</mtext></ci><ci id="S6.Ex28.m1.1.1.6a.cmml" xref="S6.Ex28.m1.1.1.6"><mtext id="S6.Ex28.m1.1.1.6.cmml" xref="S6.Ex28.m1.1.1.6">Cars</mtext></ci><apply id="S6.Ex28.m1.1.1.1.2.cmml" xref="S6.Ex28.m1.1.1.1.1"><abs id="S6.Ex28.m1.1.1.1.2.1.cmml" xref="S6.Ex28.m1.1.1.1.1.2"></abs><apply id="S6.Ex28.m1.1.1.1.1.1.cmml" xref="S6.Ex28.m1.1.1.1.1.1"><times id="S6.Ex28.m1.1.1.1.1.1.1.cmml" xref="S6.Ex28.m1.1.1.1.1.1.1"></times><ci id="S6.Ex28.m1.1.1.1.1.1.2a.cmml" xref="S6.Ex28.m1.1.1.1.1.1.2"><mtext id="S6.Ex28.m1.1.1.1.1.1.2.cmml" xref="S6.Ex28.m1.1.1.1.1.1.2">Cars</mtext></ci><ci id="S6.Ex28.m1.1.1.1.1.1.3a.cmml" xref="S6.Ex28.m1.1.1.1.1.1.3"><mtext id="S6.Ex28.m1.1.1.1.1.1.3.cmml" xref="S6.Ex28.m1.1.1.1.1.1.3">Cars</mtext></ci><ci id="S6.Ex28.m1.1.1.1.1.1.4a.cmml" xref="S6.Ex28.m1.1.1.1.1.1.4"><mtext id="S6.Ex28.m1.1.1.1.1.1.4.cmml" xref="S6.Ex28.m1.1.1.1.1.1.4">Median</mtext></ci><ci id="S6.Ex28.m1.1.1.1.1.1.5a.cmml" xref="S6.Ex28.m1.1.1.1.1.1.5"><mtext id="S6.Ex28.m1.1.1.1.1.1.5.cmml" xref="S6.Ex28.m1.1.1.1.1.1.5">Cars</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex28.m1.1c">\displaystyle\ \text{Cars}\ \text{Median}\ \text{Cars}\ \text{Cars}\ |\ \text{Cars}\ \text{Cars}\ \text{Median}\ \text{Cars}\ |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex29"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell">
<span id="S6.Ex29.8.7.2.1" class="ltx_text ltx_markedasmath">Cars</span><span id="S6.Ex29.8.7.2.2" class="ltx_text ltx_markedasmath">Cars</span><span id="S6.Ex29.8.7.2.3" class="ltx_text ltx_markedasmath">Median</span><span id="S6.Ex29.8.7.2.4" class="ltx_text ltx_markedasmath">Cars</span><span id="S6.Ex29.8.7.2.5" class="ltx_text ltx_markedasmath">Cars</span>
</td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex30"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S6.Ex30.m1.1" class="ltx_Math" alttext="\displaystyle\text{Outer}_{L}" display="inline"><semantics id="S6.Ex30.m1.1a"><msub id="S6.Ex30.m1.1.1" xref="S6.Ex30.m1.1.1.cmml"><mtext id="S6.Ex30.m1.1.1.2" xref="S6.Ex30.m1.1.1.2a.cmml">Outer</mtext><mi id="S6.Ex30.m1.1.1.3" xref="S6.Ex30.m1.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S6.Ex30.m1.1b"><apply id="S6.Ex30.m1.1.1.cmml" xref="S6.Ex30.m1.1.1"><csymbol cd="ambiguous" id="S6.Ex30.m1.1.1.1.cmml" xref="S6.Ex30.m1.1.1">subscript</csymbol><ci id="S6.Ex30.m1.1.1.2a.cmml" xref="S6.Ex30.m1.1.1.2"><mtext id="S6.Ex30.m1.1.1.2.cmml" xref="S6.Ex30.m1.1.1.2">Outer</mtext></ci><ci id="S6.Ex30.m1.1.1.3.cmml" xref="S6.Ex30.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex30.m1.1c">\displaystyle\text{Outer}_{L}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex30.m2.1" class="ltx_Math" alttext="\displaystyle\to\text{Sidewalk}\ \text{Buildings}\ \text{Foliage}" display="inline"><semantics id="S6.Ex30.m2.1a"><mrow id="S6.Ex30.m2.1.1" xref="S6.Ex30.m2.1.1.cmml"><mi id="S6.Ex30.m2.1.1.2" xref="S6.Ex30.m2.1.1.2.cmml"></mi><mo stretchy="false" id="S6.Ex30.m2.1.1.1" xref="S6.Ex30.m2.1.1.1.cmml">→</mo><mrow id="S6.Ex30.m2.1.1.3" xref="S6.Ex30.m2.1.1.3.cmml"><mtext id="S6.Ex30.m2.1.1.3.2" xref="S6.Ex30.m2.1.1.3.2a.cmml">Sidewalk</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex30.m2.1.1.3.1" xref="S6.Ex30.m2.1.1.3.1.cmml">​</mo><mtext id="S6.Ex30.m2.1.1.3.3" xref="S6.Ex30.m2.1.1.3.3a.cmml">Buildings</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex30.m2.1.1.3.1a" xref="S6.Ex30.m2.1.1.3.1.cmml">​</mo><mtext id="S6.Ex30.m2.1.1.3.4" xref="S6.Ex30.m2.1.1.3.4a.cmml">Foliage</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex30.m2.1b"><apply id="S6.Ex30.m2.1.1.cmml" xref="S6.Ex30.m2.1.1"><ci id="S6.Ex30.m2.1.1.1.cmml" xref="S6.Ex30.m2.1.1.1">→</ci><csymbol cd="latexml" id="S6.Ex30.m2.1.1.2.cmml" xref="S6.Ex30.m2.1.1.2">absent</csymbol><apply id="S6.Ex30.m2.1.1.3.cmml" xref="S6.Ex30.m2.1.1.3"><times id="S6.Ex30.m2.1.1.3.1.cmml" xref="S6.Ex30.m2.1.1.3.1"></times><ci id="S6.Ex30.m2.1.1.3.2a.cmml" xref="S6.Ex30.m2.1.1.3.2"><mtext id="S6.Ex30.m2.1.1.3.2.cmml" xref="S6.Ex30.m2.1.1.3.2">Sidewalk</mtext></ci><ci id="S6.Ex30.m2.1.1.3.3a.cmml" xref="S6.Ex30.m2.1.1.3.3"><mtext id="S6.Ex30.m2.1.1.3.3.cmml" xref="S6.Ex30.m2.1.1.3.3">Buildings</mtext></ci><ci id="S6.Ex30.m2.1.1.3.4a.cmml" xref="S6.Ex30.m2.1.1.3.4"><mtext id="S6.Ex30.m2.1.1.3.4.cmml" xref="S6.Ex30.m2.1.1.3.4">Foliage</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex30.m2.1c">\displaystyle\to\text{Sidewalk}\ \text{Buildings}\ \text{Foliage}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex31"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S6.Ex31.m1.1" class="ltx_Math" alttext="\displaystyle\text{Outer}_{R}" display="inline"><semantics id="S6.Ex31.m1.1a"><msub id="S6.Ex31.m1.1.1" xref="S6.Ex31.m1.1.1.cmml"><mtext id="S6.Ex31.m1.1.1.2" xref="S6.Ex31.m1.1.1.2a.cmml">Outer</mtext><mi id="S6.Ex31.m1.1.1.3" xref="S6.Ex31.m1.1.1.3.cmml">R</mi></msub><annotation-xml encoding="MathML-Content" id="S6.Ex31.m1.1b"><apply id="S6.Ex31.m1.1.1.cmml" xref="S6.Ex31.m1.1.1"><csymbol cd="ambiguous" id="S6.Ex31.m1.1.1.1.cmml" xref="S6.Ex31.m1.1.1">subscript</csymbol><ci id="S6.Ex31.m1.1.1.2a.cmml" xref="S6.Ex31.m1.1.1.2"><mtext id="S6.Ex31.m1.1.1.2.cmml" xref="S6.Ex31.m1.1.1.2">Outer</mtext></ci><ci id="S6.Ex31.m1.1.1.3.cmml" xref="S6.Ex31.m1.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex31.m1.1c">\displaystyle\text{Outer}_{R}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex31.m2.1" class="ltx_Math" alttext="\displaystyle\to\text{Sidewalk}\ \text{Buildings}\ \text{Foliage}" display="inline"><semantics id="S6.Ex31.m2.1a"><mrow id="S6.Ex31.m2.1.1" xref="S6.Ex31.m2.1.1.cmml"><mi id="S6.Ex31.m2.1.1.2" xref="S6.Ex31.m2.1.1.2.cmml"></mi><mo stretchy="false" id="S6.Ex31.m2.1.1.1" xref="S6.Ex31.m2.1.1.1.cmml">→</mo><mrow id="S6.Ex31.m2.1.1.3" xref="S6.Ex31.m2.1.1.3.cmml"><mtext id="S6.Ex31.m2.1.1.3.2" xref="S6.Ex31.m2.1.1.3.2a.cmml">Sidewalk</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex31.m2.1.1.3.1" xref="S6.Ex31.m2.1.1.3.1.cmml">​</mo><mtext id="S6.Ex31.m2.1.1.3.3" xref="S6.Ex31.m2.1.1.3.3a.cmml">Buildings</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex31.m2.1.1.3.1a" xref="S6.Ex31.m2.1.1.3.1.cmml">​</mo><mtext id="S6.Ex31.m2.1.1.3.4" xref="S6.Ex31.m2.1.1.3.4a.cmml">Foliage</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex31.m2.1b"><apply id="S6.Ex31.m2.1.1.cmml" xref="S6.Ex31.m2.1.1"><ci id="S6.Ex31.m2.1.1.1.cmml" xref="S6.Ex31.m2.1.1.1">→</ci><csymbol cd="latexml" id="S6.Ex31.m2.1.1.2.cmml" xref="S6.Ex31.m2.1.1.2">absent</csymbol><apply id="S6.Ex31.m2.1.1.3.cmml" xref="S6.Ex31.m2.1.1.3"><times id="S6.Ex31.m2.1.1.3.1.cmml" xref="S6.Ex31.m2.1.1.3.1"></times><ci id="S6.Ex31.m2.1.1.3.2a.cmml" xref="S6.Ex31.m2.1.1.3.2"><mtext id="S6.Ex31.m2.1.1.3.2.cmml" xref="S6.Ex31.m2.1.1.3.2">Sidewalk</mtext></ci><ci id="S6.Ex31.m2.1.1.3.3a.cmml" xref="S6.Ex31.m2.1.1.3.3"><mtext id="S6.Ex31.m2.1.1.3.3.cmml" xref="S6.Ex31.m2.1.1.3.3">Buildings</mtext></ci><ci id="S6.Ex31.m2.1.1.3.4a.cmml" xref="S6.Ex31.m2.1.1.3.4"><mtext id="S6.Ex31.m2.1.1.3.4.cmml" xref="S6.Ex31.m2.1.1.3.4">Foliage</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex31.m2.1c">\displaystyle\to\text{Sidewalk}\ \text{Buildings}\ \text{Foliage}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex32"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S6.Ex32.2.1.1.1" class="ltx_text ltx_markedasmath">Cars</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex32.m2.1" class="ltx_Math" alttext="\displaystyle\to\text{car}\ |\ \epsilon\ |\ \text{Cars}" display="inline"><semantics id="S6.Ex32.m2.1a"><mrow id="S6.Ex32.m2.1.2" xref="S6.Ex32.m2.1.2.cmml"><mi id="S6.Ex32.m2.1.2.2" xref="S6.Ex32.m2.1.2.2.cmml"></mi><mo stretchy="false" id="S6.Ex32.m2.1.2.1" xref="S6.Ex32.m2.1.2.1.cmml">→</mo><mrow id="S6.Ex32.m2.1.2.3" xref="S6.Ex32.m2.1.2.3.cmml"><mtext id="S6.Ex32.m2.1.2.3.2" xref="S6.Ex32.m2.1.2.3.2a.cmml">car</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex32.m2.1.2.3.1" xref="S6.Ex32.m2.1.2.3.1.cmml">​</mo><mrow id="S6.Ex32.m2.1.2.3.3.2" xref="S6.Ex32.m2.1.2.3.3.1.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex32.m2.1.2.3.3.2.1" xref="S6.Ex32.m2.1.2.3.3.1.1.cmml">|</mo><mi id="S6.Ex32.m2.1.1" xref="S6.Ex32.m2.1.1.cmml">ϵ</mi><mo lspace="0.500em" stretchy="false" id="S6.Ex32.m2.1.2.3.3.2.2" xref="S6.Ex32.m2.1.2.3.3.1.1.cmml">|</mo></mrow><mo lspace="0.500em" rspace="0em" id="S6.Ex32.m2.1.2.3.1a" xref="S6.Ex32.m2.1.2.3.1.cmml">​</mo><mtext id="S6.Ex32.m2.1.2.3.4" xref="S6.Ex32.m2.1.2.3.4a.cmml">Cars</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex32.m2.1b"><apply id="S6.Ex32.m2.1.2.cmml" xref="S6.Ex32.m2.1.2"><ci id="S6.Ex32.m2.1.2.1.cmml" xref="S6.Ex32.m2.1.2.1">→</ci><csymbol cd="latexml" id="S6.Ex32.m2.1.2.2.cmml" xref="S6.Ex32.m2.1.2.2">absent</csymbol><apply id="S6.Ex32.m2.1.2.3.cmml" xref="S6.Ex32.m2.1.2.3"><times id="S6.Ex32.m2.1.2.3.1.cmml" xref="S6.Ex32.m2.1.2.3.1"></times><ci id="S6.Ex32.m2.1.2.3.2a.cmml" xref="S6.Ex32.m2.1.2.3.2"><mtext id="S6.Ex32.m2.1.2.3.2.cmml" xref="S6.Ex32.m2.1.2.3.2">car</mtext></ci><apply id="S6.Ex32.m2.1.2.3.3.1.cmml" xref="S6.Ex32.m2.1.2.3.3.2"><abs id="S6.Ex32.m2.1.2.3.3.1.1.cmml" xref="S6.Ex32.m2.1.2.3.3.2.1"></abs><ci id="S6.Ex32.m2.1.1.cmml" xref="S6.Ex32.m2.1.1">italic-ϵ</ci></apply><ci id="S6.Ex32.m2.1.2.3.4a.cmml" xref="S6.Ex32.m2.1.2.3.4"><mtext id="S6.Ex32.m2.1.2.3.4.cmml" xref="S6.Ex32.m2.1.2.3.4">Cars</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex32.m2.1c">\displaystyle\to\text{car}\ |\ \epsilon\ |\ \text{Cars}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex33"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S6.Ex33.2.1.1.1" class="ltx_text ltx_markedasmath">Foliage</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex33.m2.1" class="ltx_Math" alttext="\displaystyle\to\text{tree}\ |\ \epsilon\ |\ \text{Foliage}" display="inline"><semantics id="S6.Ex33.m2.1a"><mrow id="S6.Ex33.m2.1.2" xref="S6.Ex33.m2.1.2.cmml"><mi id="S6.Ex33.m2.1.2.2" xref="S6.Ex33.m2.1.2.2.cmml"></mi><mo stretchy="false" id="S6.Ex33.m2.1.2.1" xref="S6.Ex33.m2.1.2.1.cmml">→</mo><mrow id="S6.Ex33.m2.1.2.3" xref="S6.Ex33.m2.1.2.3.cmml"><mtext id="S6.Ex33.m2.1.2.3.2" xref="S6.Ex33.m2.1.2.3.2a.cmml">tree</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex33.m2.1.2.3.1" xref="S6.Ex33.m2.1.2.3.1.cmml">​</mo><mrow id="S6.Ex33.m2.1.2.3.3.2" xref="S6.Ex33.m2.1.2.3.3.1.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex33.m2.1.2.3.3.2.1" xref="S6.Ex33.m2.1.2.3.3.1.1.cmml">|</mo><mi id="S6.Ex33.m2.1.1" xref="S6.Ex33.m2.1.1.cmml">ϵ</mi><mo lspace="0.500em" stretchy="false" id="S6.Ex33.m2.1.2.3.3.2.2" xref="S6.Ex33.m2.1.2.3.3.1.1.cmml">|</mo></mrow><mo lspace="0.500em" rspace="0em" id="S6.Ex33.m2.1.2.3.1a" xref="S6.Ex33.m2.1.2.3.1.cmml">​</mo><mtext id="S6.Ex33.m2.1.2.3.4" xref="S6.Ex33.m2.1.2.3.4a.cmml">Foliage</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex33.m2.1b"><apply id="S6.Ex33.m2.1.2.cmml" xref="S6.Ex33.m2.1.2"><ci id="S6.Ex33.m2.1.2.1.cmml" xref="S6.Ex33.m2.1.2.1">→</ci><csymbol cd="latexml" id="S6.Ex33.m2.1.2.2.cmml" xref="S6.Ex33.m2.1.2.2">absent</csymbol><apply id="S6.Ex33.m2.1.2.3.cmml" xref="S6.Ex33.m2.1.2.3"><times id="S6.Ex33.m2.1.2.3.1.cmml" xref="S6.Ex33.m2.1.2.3.1"></times><ci id="S6.Ex33.m2.1.2.3.2a.cmml" xref="S6.Ex33.m2.1.2.3.2"><mtext id="S6.Ex33.m2.1.2.3.2.cmml" xref="S6.Ex33.m2.1.2.3.2">tree</mtext></ci><apply id="S6.Ex33.m2.1.2.3.3.1.cmml" xref="S6.Ex33.m2.1.2.3.3.2"><abs id="S6.Ex33.m2.1.2.3.3.1.1.cmml" xref="S6.Ex33.m2.1.2.3.3.2.1"></abs><ci id="S6.Ex33.m2.1.1.cmml" xref="S6.Ex33.m2.1.1">italic-ϵ</ci></apply><ci id="S6.Ex33.m2.1.2.3.4a.cmml" xref="S6.Ex33.m2.1.2.3.4"><mtext id="S6.Ex33.m2.1.2.3.4.cmml" xref="S6.Ex33.m2.1.2.3.4">Foliage</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex33.m2.1c">\displaystyle\to\text{tree}\ |\ \epsilon\ |\ \text{Foliage}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex34"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S6.Ex34.2.1.1.1" class="ltx_text ltx_markedasmath">Buildings</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex34.m2.1" class="ltx_Math" alttext="\displaystyle\to\text{building}\ |\ \epsilon\ |\ \text{Buildings}" display="inline"><semantics id="S6.Ex34.m2.1a"><mrow id="S6.Ex34.m2.1.2" xref="S6.Ex34.m2.1.2.cmml"><mi id="S6.Ex34.m2.1.2.2" xref="S6.Ex34.m2.1.2.2.cmml"></mi><mo stretchy="false" id="S6.Ex34.m2.1.2.1" xref="S6.Ex34.m2.1.2.1.cmml">→</mo><mrow id="S6.Ex34.m2.1.2.3" xref="S6.Ex34.m2.1.2.3.cmml"><mtext id="S6.Ex34.m2.1.2.3.2" xref="S6.Ex34.m2.1.2.3.2a.cmml">building</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex34.m2.1.2.3.1" xref="S6.Ex34.m2.1.2.3.1.cmml">​</mo><mrow id="S6.Ex34.m2.1.2.3.3.2" xref="S6.Ex34.m2.1.2.3.3.1.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex34.m2.1.2.3.3.2.1" xref="S6.Ex34.m2.1.2.3.3.1.1.cmml">|</mo><mi id="S6.Ex34.m2.1.1" xref="S6.Ex34.m2.1.1.cmml">ϵ</mi><mo lspace="0.500em" stretchy="false" id="S6.Ex34.m2.1.2.3.3.2.2" xref="S6.Ex34.m2.1.2.3.3.1.1.cmml">|</mo></mrow><mo lspace="0.500em" rspace="0em" id="S6.Ex34.m2.1.2.3.1a" xref="S6.Ex34.m2.1.2.3.1.cmml">​</mo><mtext id="S6.Ex34.m2.1.2.3.4" xref="S6.Ex34.m2.1.2.3.4a.cmml">Buildings</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex34.m2.1b"><apply id="S6.Ex34.m2.1.2.cmml" xref="S6.Ex34.m2.1.2"><ci id="S6.Ex34.m2.1.2.1.cmml" xref="S6.Ex34.m2.1.2.1">→</ci><csymbol cd="latexml" id="S6.Ex34.m2.1.2.2.cmml" xref="S6.Ex34.m2.1.2.2">absent</csymbol><apply id="S6.Ex34.m2.1.2.3.cmml" xref="S6.Ex34.m2.1.2.3"><times id="S6.Ex34.m2.1.2.3.1.cmml" xref="S6.Ex34.m2.1.2.3.1"></times><ci id="S6.Ex34.m2.1.2.3.2a.cmml" xref="S6.Ex34.m2.1.2.3.2"><mtext id="S6.Ex34.m2.1.2.3.2.cmml" xref="S6.Ex34.m2.1.2.3.2">building</mtext></ci><apply id="S6.Ex34.m2.1.2.3.3.1.cmml" xref="S6.Ex34.m2.1.2.3.3.2"><abs id="S6.Ex34.m2.1.2.3.3.1.1.cmml" xref="S6.Ex34.m2.1.2.3.3.2.1"></abs><ci id="S6.Ex34.m2.1.1.cmml" xref="S6.Ex34.m2.1.1">italic-ϵ</ci></apply><ci id="S6.Ex34.m2.1.2.3.4a.cmml" xref="S6.Ex34.m2.1.2.3.4"><mtext id="S6.Ex34.m2.1.2.3.4.cmml" xref="S6.Ex34.m2.1.2.3.4">Buildings</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex34.m2.1c">\displaystyle\to\text{building}\ |\ \epsilon\ |\ \text{Buildings}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex35"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S6.Ex35.2.1.1.1" class="ltx_text ltx_markedasmath">Sidewalk</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex35.m2.3" class="ltx_Math" alttext="\displaystyle\to\text{pole}\ |\ \text{sign}\ |\ \text{pedestrian}\ |\ \text{object}\ |\ \text{bike}\ |\ \epsilon\ |\ \text{Sidewalk}" display="inline"><semantics id="S6.Ex35.m2.3a"><mrow id="S6.Ex35.m2.3.4" xref="S6.Ex35.m2.3.4.cmml"><mi id="S6.Ex35.m2.3.4.2" xref="S6.Ex35.m2.3.4.2.cmml"></mi><mo stretchy="false" id="S6.Ex35.m2.3.4.1" xref="S6.Ex35.m2.3.4.1.cmml">→</mo><mrow id="S6.Ex35.m2.3.4.3" xref="S6.Ex35.m2.3.4.3.cmml"><mtext id="S6.Ex35.m2.3.4.3.2" xref="S6.Ex35.m2.3.4.3.2a.cmml">pole</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex35.m2.3.4.3.1" xref="S6.Ex35.m2.3.4.3.1.cmml">​</mo><mrow id="S6.Ex35.m2.3.4.3.3.2" xref="S6.Ex35.m2.3.4.3.3.1.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex35.m2.3.4.3.3.2.1" xref="S6.Ex35.m2.3.4.3.3.1.1.cmml">|</mo><mtext id="S6.Ex35.m2.1.1" xref="S6.Ex35.m2.1.1a.cmml">sign</mtext><mo lspace="0.500em" stretchy="false" id="S6.Ex35.m2.3.4.3.3.2.2" xref="S6.Ex35.m2.3.4.3.3.1.1.cmml">|</mo></mrow><mo lspace="0.500em" rspace="0em" id="S6.Ex35.m2.3.4.3.1a" xref="S6.Ex35.m2.3.4.3.1.cmml">​</mo><mtext id="S6.Ex35.m2.3.4.3.4" xref="S6.Ex35.m2.3.4.3.4a.cmml">pedestrian</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex35.m2.3.4.3.1b" xref="S6.Ex35.m2.3.4.3.1.cmml">​</mo><mrow id="S6.Ex35.m2.3.4.3.5.2" xref="S6.Ex35.m2.3.4.3.5.1.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex35.m2.3.4.3.5.2.1" xref="S6.Ex35.m2.3.4.3.5.1.1.cmml">|</mo><mtext id="S6.Ex35.m2.2.2" xref="S6.Ex35.m2.2.2a.cmml">object</mtext><mo lspace="0.500em" stretchy="false" id="S6.Ex35.m2.3.4.3.5.2.2" xref="S6.Ex35.m2.3.4.3.5.1.1.cmml">|</mo></mrow><mo lspace="0.500em" rspace="0em" id="S6.Ex35.m2.3.4.3.1c" xref="S6.Ex35.m2.3.4.3.1.cmml">​</mo><mtext id="S6.Ex35.m2.3.4.3.6" xref="S6.Ex35.m2.3.4.3.6a.cmml">bike</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex35.m2.3.4.3.1d" xref="S6.Ex35.m2.3.4.3.1.cmml">​</mo><mrow id="S6.Ex35.m2.3.4.3.7.2" xref="S6.Ex35.m2.3.4.3.7.1.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex35.m2.3.4.3.7.2.1" xref="S6.Ex35.m2.3.4.3.7.1.1.cmml">|</mo><mi id="S6.Ex35.m2.3.3" xref="S6.Ex35.m2.3.3.cmml">ϵ</mi><mo lspace="0.500em" stretchy="false" id="S6.Ex35.m2.3.4.3.7.2.2" xref="S6.Ex35.m2.3.4.3.7.1.1.cmml">|</mo></mrow><mo lspace="0.500em" rspace="0em" id="S6.Ex35.m2.3.4.3.1e" xref="S6.Ex35.m2.3.4.3.1.cmml">​</mo><mtext id="S6.Ex35.m2.3.4.3.8" xref="S6.Ex35.m2.3.4.3.8a.cmml">Sidewalk</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex35.m2.3b"><apply id="S6.Ex35.m2.3.4.cmml" xref="S6.Ex35.m2.3.4"><ci id="S6.Ex35.m2.3.4.1.cmml" xref="S6.Ex35.m2.3.4.1">→</ci><csymbol cd="latexml" id="S6.Ex35.m2.3.4.2.cmml" xref="S6.Ex35.m2.3.4.2">absent</csymbol><apply id="S6.Ex35.m2.3.4.3.cmml" xref="S6.Ex35.m2.3.4.3"><times id="S6.Ex35.m2.3.4.3.1.cmml" xref="S6.Ex35.m2.3.4.3.1"></times><ci id="S6.Ex35.m2.3.4.3.2a.cmml" xref="S6.Ex35.m2.3.4.3.2"><mtext id="S6.Ex35.m2.3.4.3.2.cmml" xref="S6.Ex35.m2.3.4.3.2">pole</mtext></ci><apply id="S6.Ex35.m2.3.4.3.3.1.cmml" xref="S6.Ex35.m2.3.4.3.3.2"><abs id="S6.Ex35.m2.3.4.3.3.1.1.cmml" xref="S6.Ex35.m2.3.4.3.3.2.1"></abs><ci id="S6.Ex35.m2.1.1a.cmml" xref="S6.Ex35.m2.1.1"><mtext id="S6.Ex35.m2.1.1.cmml" xref="S6.Ex35.m2.1.1">sign</mtext></ci></apply><ci id="S6.Ex35.m2.3.4.3.4a.cmml" xref="S6.Ex35.m2.3.4.3.4"><mtext id="S6.Ex35.m2.3.4.3.4.cmml" xref="S6.Ex35.m2.3.4.3.4">pedestrian</mtext></ci><apply id="S6.Ex35.m2.3.4.3.5.1.cmml" xref="S6.Ex35.m2.3.4.3.5.2"><abs id="S6.Ex35.m2.3.4.3.5.1.1.cmml" xref="S6.Ex35.m2.3.4.3.5.2.1"></abs><ci id="S6.Ex35.m2.2.2a.cmml" xref="S6.Ex35.m2.2.2"><mtext id="S6.Ex35.m2.2.2.cmml" xref="S6.Ex35.m2.2.2">object</mtext></ci></apply><ci id="S6.Ex35.m2.3.4.3.6a.cmml" xref="S6.Ex35.m2.3.4.3.6"><mtext id="S6.Ex35.m2.3.4.3.6.cmml" xref="S6.Ex35.m2.3.4.3.6">bike</mtext></ci><apply id="S6.Ex35.m2.3.4.3.7.1.cmml" xref="S6.Ex35.m2.3.4.3.7.2"><abs id="S6.Ex35.m2.3.4.3.7.1.1.cmml" xref="S6.Ex35.m2.3.4.3.7.2.1"></abs><ci id="S6.Ex35.m2.3.3.cmml" xref="S6.Ex35.m2.3.3">italic-ϵ</ci></apply><ci id="S6.Ex35.m2.3.4.3.8a.cmml" xref="S6.Ex35.m2.3.4.3.8"><mtext id="S6.Ex35.m2.3.4.3.8.cmml" xref="S6.Ex35.m2.3.4.3.8">Sidewalk</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex35.m2.3c">\displaystyle\to\text{pole}\ |\ \text{sign}\ |\ \text{pedestrian}\ |\ \text{object}\ |\ \text{bike}\ |\ \epsilon\ |\ \text{Sidewalk}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex36"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S6.Ex36.2.1.1.1" class="ltx_text ltx_markedasmath">Median</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex36.m2.2" class="ltx_Math" alttext="\displaystyle\to\ \text{bush}\ |\ \text{object}\ |\ \text{tree}\ |\ \epsilon\ |\ M" display="inline"><semantics id="S6.Ex36.m2.2a"><mrow id="S6.Ex36.m2.2.3" xref="S6.Ex36.m2.2.3.cmml"><mi id="S6.Ex36.m2.2.3.2" xref="S6.Ex36.m2.2.3.2.cmml"></mi><mo rspace="0.778em" stretchy="false" id="S6.Ex36.m2.2.3.1" xref="S6.Ex36.m2.2.3.1.cmml">→</mo><mrow id="S6.Ex36.m2.2.3.3" xref="S6.Ex36.m2.2.3.3.cmml"><mtext id="S6.Ex36.m2.2.3.3.2" xref="S6.Ex36.m2.2.3.3.2a.cmml">bush</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex36.m2.2.3.3.1" xref="S6.Ex36.m2.2.3.3.1.cmml">​</mo><mrow id="S6.Ex36.m2.2.3.3.3.2" xref="S6.Ex36.m2.2.3.3.3.1.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex36.m2.2.3.3.3.2.1" xref="S6.Ex36.m2.2.3.3.3.1.1.cmml">|</mo><mtext id="S6.Ex36.m2.1.1" xref="S6.Ex36.m2.1.1a.cmml">object</mtext><mo lspace="0.500em" stretchy="false" id="S6.Ex36.m2.2.3.3.3.2.2" xref="S6.Ex36.m2.2.3.3.3.1.1.cmml">|</mo></mrow><mo lspace="0.500em" rspace="0em" id="S6.Ex36.m2.2.3.3.1a" xref="S6.Ex36.m2.2.3.3.1.cmml">​</mo><mtext id="S6.Ex36.m2.2.3.3.4" xref="S6.Ex36.m2.2.3.3.4a.cmml">tree</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex36.m2.2.3.3.1b" xref="S6.Ex36.m2.2.3.3.1.cmml">​</mo><mrow id="S6.Ex36.m2.2.3.3.5.2" xref="S6.Ex36.m2.2.3.3.5.1.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex36.m2.2.3.3.5.2.1" xref="S6.Ex36.m2.2.3.3.5.1.1.cmml">|</mo><mi id="S6.Ex36.m2.2.2" xref="S6.Ex36.m2.2.2.cmml">ϵ</mi><mo lspace="0.500em" stretchy="false" id="S6.Ex36.m2.2.3.3.5.2.2" xref="S6.Ex36.m2.2.3.3.5.1.1.cmml">|</mo></mrow><mo lspace="0.500em" rspace="0em" id="S6.Ex36.m2.2.3.3.1c" xref="S6.Ex36.m2.2.3.3.1.cmml">​</mo><mi id="S6.Ex36.m2.2.3.3.6" xref="S6.Ex36.m2.2.3.3.6.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex36.m2.2b"><apply id="S6.Ex36.m2.2.3.cmml" xref="S6.Ex36.m2.2.3"><ci id="S6.Ex36.m2.2.3.1.cmml" xref="S6.Ex36.m2.2.3.1">→</ci><csymbol cd="latexml" id="S6.Ex36.m2.2.3.2.cmml" xref="S6.Ex36.m2.2.3.2">absent</csymbol><apply id="S6.Ex36.m2.2.3.3.cmml" xref="S6.Ex36.m2.2.3.3"><times id="S6.Ex36.m2.2.3.3.1.cmml" xref="S6.Ex36.m2.2.3.3.1"></times><ci id="S6.Ex36.m2.2.3.3.2a.cmml" xref="S6.Ex36.m2.2.3.3.2"><mtext id="S6.Ex36.m2.2.3.3.2.cmml" xref="S6.Ex36.m2.2.3.3.2">bush</mtext></ci><apply id="S6.Ex36.m2.2.3.3.3.1.cmml" xref="S6.Ex36.m2.2.3.3.3.2"><abs id="S6.Ex36.m2.2.3.3.3.1.1.cmml" xref="S6.Ex36.m2.2.3.3.3.2.1"></abs><ci id="S6.Ex36.m2.1.1a.cmml" xref="S6.Ex36.m2.1.1"><mtext id="S6.Ex36.m2.1.1.cmml" xref="S6.Ex36.m2.1.1">object</mtext></ci></apply><ci id="S6.Ex36.m2.2.3.3.4a.cmml" xref="S6.Ex36.m2.2.3.3.4"><mtext id="S6.Ex36.m2.2.3.3.4.cmml" xref="S6.Ex36.m2.2.3.3.4">tree</mtext></ci><apply id="S6.Ex36.m2.2.3.3.5.1.cmml" xref="S6.Ex36.m2.2.3.3.5.2"><abs id="S6.Ex36.m2.2.3.3.5.1.1.cmml" xref="S6.Ex36.m2.2.3.3.5.2.1"></abs><ci id="S6.Ex36.m2.2.2.cmml" xref="S6.Ex36.m2.2.2">italic-ϵ</ci></apply><ci id="S6.Ex36.m2.2.3.3.6.cmml" xref="S6.Ex36.m2.2.3.3.6">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex36.m2.2c">\displaystyle\to\ \text{bush}\ |\ \text{object}\ |\ \text{tree}\ |\ \epsilon\ |\ M</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S6.SS1.SSS4.p2.4" class="ltx_p">The rural grammar is a further restriction with the addition of a shoulder instead of a sidewalk</p>
<table id="S6.EGx13" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S6.Ex37"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S6.Ex37.m1.1" class="ltx_Math" alttext="\displaystyle\text{S}_{\text{rural}}" display="inline"><semantics id="S6.Ex37.m1.1a"><msub id="S6.Ex37.m1.1.1" xref="S6.Ex37.m1.1.1.cmml"><mtext id="S6.Ex37.m1.1.1.2" xref="S6.Ex37.m1.1.1.2a.cmml">S</mtext><mtext id="S6.Ex37.m1.1.1.3" xref="S6.Ex37.m1.1.1.3a.cmml">rural</mtext></msub><annotation-xml encoding="MathML-Content" id="S6.Ex37.m1.1b"><apply id="S6.Ex37.m1.1.1.cmml" xref="S6.Ex37.m1.1.1"><csymbol cd="ambiguous" id="S6.Ex37.m1.1.1.1.cmml" xref="S6.Ex37.m1.1.1">subscript</csymbol><ci id="S6.Ex37.m1.1.1.2a.cmml" xref="S6.Ex37.m1.1.1.2"><mtext id="S6.Ex37.m1.1.1.2.cmml" xref="S6.Ex37.m1.1.1.2">S</mtext></ci><ci id="S6.Ex37.m1.1.1.3a.cmml" xref="S6.Ex37.m1.1.1.3"><mtext mathsize="70%" id="S6.Ex37.m1.1.1.3.cmml" xref="S6.Ex37.m1.1.1.3">rural</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex37.m1.1c">\displaystyle\text{S}_{\text{rural}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex37.m2.3" class="ltx_Math" alttext="\displaystyle\to\text{Street}\ \ \text{Outer}_{L}\ \ \text{Outer}_{R}" display="inline"><semantics id="S6.Ex37.m2.3a"><mrow id="S6.Ex37.m2.3.3" xref="S6.Ex37.m2.3.3.cmml"><mi id="S6.Ex37.m2.3.3.4" xref="S6.Ex37.m2.3.3.4.cmml"></mi><mo stretchy="false" id="S6.Ex37.m2.3.3.3" xref="S6.Ex37.m2.3.3.3.cmml">→</mo><mrow id="S6.Ex37.m2.3.3.2.2" xref="S6.Ex37.m2.3.3.2.3.cmml"><mtext id="S6.Ex37.m2.1.1" xref="S6.Ex37.m2.1.1a.cmml">Street</mtext><mspace width="1em" id="S6.Ex37.m2.3.3.2.2.3" xref="S6.Ex37.m2.3.3.2.3.cmml"></mspace><msub id="S6.Ex37.m2.2.2.1.1.1" xref="S6.Ex37.m2.2.2.1.1.1.cmml"><mtext id="S6.Ex37.m2.2.2.1.1.1.2" xref="S6.Ex37.m2.2.2.1.1.1.2a.cmml">Outer</mtext><mi id="S6.Ex37.m2.2.2.1.1.1.3" xref="S6.Ex37.m2.2.2.1.1.1.3.cmml">L</mi></msub><mspace width="1em" id="S6.Ex37.m2.3.3.2.2.4" xref="S6.Ex37.m2.3.3.2.3.cmml"></mspace><msub id="S6.Ex37.m2.3.3.2.2.2" xref="S6.Ex37.m2.3.3.2.2.2.cmml"><mtext id="S6.Ex37.m2.3.3.2.2.2.2" xref="S6.Ex37.m2.3.3.2.2.2.2a.cmml">Outer</mtext><mi id="S6.Ex37.m2.3.3.2.2.2.3" xref="S6.Ex37.m2.3.3.2.2.2.3.cmml">R</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex37.m2.3b"><apply id="S6.Ex37.m2.3.3.cmml" xref="S6.Ex37.m2.3.3"><ci id="S6.Ex37.m2.3.3.3.cmml" xref="S6.Ex37.m2.3.3.3">→</ci><csymbol cd="latexml" id="S6.Ex37.m2.3.3.4.cmml" xref="S6.Ex37.m2.3.3.4">absent</csymbol><list id="S6.Ex37.m2.3.3.2.3.cmml" xref="S6.Ex37.m2.3.3.2.2"><ci id="S6.Ex37.m2.1.1a.cmml" xref="S6.Ex37.m2.1.1"><mtext id="S6.Ex37.m2.1.1.cmml" xref="S6.Ex37.m2.1.1">Street</mtext></ci><apply id="S6.Ex37.m2.2.2.1.1.1.cmml" xref="S6.Ex37.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.Ex37.m2.2.2.1.1.1.1.cmml" xref="S6.Ex37.m2.2.2.1.1.1">subscript</csymbol><ci id="S6.Ex37.m2.2.2.1.1.1.2a.cmml" xref="S6.Ex37.m2.2.2.1.1.1.2"><mtext id="S6.Ex37.m2.2.2.1.1.1.2.cmml" xref="S6.Ex37.m2.2.2.1.1.1.2">Outer</mtext></ci><ci id="S6.Ex37.m2.2.2.1.1.1.3.cmml" xref="S6.Ex37.m2.2.2.1.1.1.3">𝐿</ci></apply><apply id="S6.Ex37.m2.3.3.2.2.2.cmml" xref="S6.Ex37.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.Ex37.m2.3.3.2.2.2.1.cmml" xref="S6.Ex37.m2.3.3.2.2.2">subscript</csymbol><ci id="S6.Ex37.m2.3.3.2.2.2.2a.cmml" xref="S6.Ex37.m2.3.3.2.2.2.2"><mtext id="S6.Ex37.m2.3.3.2.2.2.2.cmml" xref="S6.Ex37.m2.3.3.2.2.2.2">Outer</mtext></ci><ci id="S6.Ex37.m2.3.3.2.2.2.3.cmml" xref="S6.Ex37.m2.3.3.2.2.2.3">𝑅</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex37.m2.3c">\displaystyle\to\text{Street}\ \ \text{Outer}_{L}\ \ \text{Outer}_{R}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex38"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S6.Ex38.2.1.1.1" class="ltx_text ltx_markedasmath">Street</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex38.m2.1" class="ltx_Math" alttext="\displaystyle\to\text{Cars}\ \text{Median}\ \text{Cars}\ |\ \text{Cars}\ \text{Median}\ \text{Cars}\ \text{Cars}\ |" display="inline"><semantics id="S6.Ex38.m2.1a"><mrow id="S6.Ex38.m2.1.1" xref="S6.Ex38.m2.1.1.cmml"><mi id="S6.Ex38.m2.1.1.3" xref="S6.Ex38.m2.1.1.3.cmml"></mi><mo stretchy="false" id="S6.Ex38.m2.1.1.2" xref="S6.Ex38.m2.1.1.2.cmml">→</mo><mrow id="S6.Ex38.m2.1.1.1" xref="S6.Ex38.m2.1.1.1.cmml"><mtext id="S6.Ex38.m2.1.1.1.3" xref="S6.Ex38.m2.1.1.1.3a.cmml">Cars</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex38.m2.1.1.1.2" xref="S6.Ex38.m2.1.1.1.2.cmml">​</mo><mtext id="S6.Ex38.m2.1.1.1.4" xref="S6.Ex38.m2.1.1.1.4a.cmml">Median</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex38.m2.1.1.1.2a" xref="S6.Ex38.m2.1.1.1.2.cmml">​</mo><mtext id="S6.Ex38.m2.1.1.1.5" xref="S6.Ex38.m2.1.1.1.5a.cmml">Cars</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex38.m2.1.1.1.2b" xref="S6.Ex38.m2.1.1.1.2.cmml">​</mo><mrow id="S6.Ex38.m2.1.1.1.1.1" xref="S6.Ex38.m2.1.1.1.1.2.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex38.m2.1.1.1.1.1.2" xref="S6.Ex38.m2.1.1.1.1.2.1.cmml">|</mo><mrow id="S6.Ex38.m2.1.1.1.1.1.1" xref="S6.Ex38.m2.1.1.1.1.1.1.cmml"><mtext id="S6.Ex38.m2.1.1.1.1.1.1.2" xref="S6.Ex38.m2.1.1.1.1.1.1.2a.cmml">Cars</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex38.m2.1.1.1.1.1.1.1" xref="S6.Ex38.m2.1.1.1.1.1.1.1.cmml">​</mo><mtext id="S6.Ex38.m2.1.1.1.1.1.1.3" xref="S6.Ex38.m2.1.1.1.1.1.1.3a.cmml">Median</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex38.m2.1.1.1.1.1.1.1a" xref="S6.Ex38.m2.1.1.1.1.1.1.1.cmml">​</mo><mtext id="S6.Ex38.m2.1.1.1.1.1.1.4" xref="S6.Ex38.m2.1.1.1.1.1.1.4a.cmml">Cars</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex38.m2.1.1.1.1.1.1.1b" xref="S6.Ex38.m2.1.1.1.1.1.1.1.cmml">​</mo><mtext id="S6.Ex38.m2.1.1.1.1.1.1.5" xref="S6.Ex38.m2.1.1.1.1.1.1.5a.cmml">Cars</mtext></mrow><mo lspace="0.500em" stretchy="false" id="S6.Ex38.m2.1.1.1.1.1.3" xref="S6.Ex38.m2.1.1.1.1.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex38.m2.1b"><apply id="S6.Ex38.m2.1.1.cmml" xref="S6.Ex38.m2.1.1"><ci id="S6.Ex38.m2.1.1.2.cmml" xref="S6.Ex38.m2.1.1.2">→</ci><csymbol cd="latexml" id="S6.Ex38.m2.1.1.3.cmml" xref="S6.Ex38.m2.1.1.3">absent</csymbol><apply id="S6.Ex38.m2.1.1.1.cmml" xref="S6.Ex38.m2.1.1.1"><times id="S6.Ex38.m2.1.1.1.2.cmml" xref="S6.Ex38.m2.1.1.1.2"></times><ci id="S6.Ex38.m2.1.1.1.3a.cmml" xref="S6.Ex38.m2.1.1.1.3"><mtext id="S6.Ex38.m2.1.1.1.3.cmml" xref="S6.Ex38.m2.1.1.1.3">Cars</mtext></ci><ci id="S6.Ex38.m2.1.1.1.4a.cmml" xref="S6.Ex38.m2.1.1.1.4"><mtext id="S6.Ex38.m2.1.1.1.4.cmml" xref="S6.Ex38.m2.1.1.1.4">Median</mtext></ci><ci id="S6.Ex38.m2.1.1.1.5a.cmml" xref="S6.Ex38.m2.1.1.1.5"><mtext id="S6.Ex38.m2.1.1.1.5.cmml" xref="S6.Ex38.m2.1.1.1.5">Cars</mtext></ci><apply id="S6.Ex38.m2.1.1.1.1.2.cmml" xref="S6.Ex38.m2.1.1.1.1.1"><abs id="S6.Ex38.m2.1.1.1.1.2.1.cmml" xref="S6.Ex38.m2.1.1.1.1.1.2"></abs><apply id="S6.Ex38.m2.1.1.1.1.1.1.cmml" xref="S6.Ex38.m2.1.1.1.1.1.1"><times id="S6.Ex38.m2.1.1.1.1.1.1.1.cmml" xref="S6.Ex38.m2.1.1.1.1.1.1.1"></times><ci id="S6.Ex38.m2.1.1.1.1.1.1.2a.cmml" xref="S6.Ex38.m2.1.1.1.1.1.1.2"><mtext id="S6.Ex38.m2.1.1.1.1.1.1.2.cmml" xref="S6.Ex38.m2.1.1.1.1.1.1.2">Cars</mtext></ci><ci id="S6.Ex38.m2.1.1.1.1.1.1.3a.cmml" xref="S6.Ex38.m2.1.1.1.1.1.1.3"><mtext id="S6.Ex38.m2.1.1.1.1.1.1.3.cmml" xref="S6.Ex38.m2.1.1.1.1.1.1.3">Median</mtext></ci><ci id="S6.Ex38.m2.1.1.1.1.1.1.4a.cmml" xref="S6.Ex38.m2.1.1.1.1.1.1.4"><mtext id="S6.Ex38.m2.1.1.1.1.1.1.4.cmml" xref="S6.Ex38.m2.1.1.1.1.1.1.4">Cars</mtext></ci><ci id="S6.Ex38.m2.1.1.1.1.1.1.5a.cmml" xref="S6.Ex38.m2.1.1.1.1.1.1.5"><mtext id="S6.Ex38.m2.1.1.1.1.1.1.5.cmml" xref="S6.Ex38.m2.1.1.1.1.1.1.5">Cars</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex38.m2.1c">\displaystyle\to\text{Cars}\ \text{Median}\ \text{Cars}\ |\ \text{Cars}\ \text{Median}\ \text{Cars}\ \text{Cars}\ |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex39"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex39.m1.1" class="ltx_Math" alttext="\displaystyle\ \text{Cars}\ \text{Cars}\ \text{Median}\ \text{Cars}\ |\ \text{Cars}\ \text{Cars}\ \text{Median}\ \text{Cars}\ \text{Cars}" display="inline"><semantics id="S6.Ex39.m1.1a"><mrow id="S6.Ex39.m1.1.1" xref="S6.Ex39.m1.1.1.cmml"><mrow id="S6.Ex39.m1.1.1.2" xref="S6.Ex39.m1.1.1.2.cmml"><mtext id="S6.Ex39.m1.1.1.2.2" xref="S6.Ex39.m1.1.1.2.2a.cmml">Cars</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex39.m1.1.1.2.1" xref="S6.Ex39.m1.1.1.2.1.cmml">​</mo><mtext id="S6.Ex39.m1.1.1.2.3" xref="S6.Ex39.m1.1.1.2.3a.cmml">Cars</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex39.m1.1.1.2.1a" xref="S6.Ex39.m1.1.1.2.1.cmml">​</mo><mtext id="S6.Ex39.m1.1.1.2.4" xref="S6.Ex39.m1.1.1.2.4a.cmml">Median</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex39.m1.1.1.2.1b" xref="S6.Ex39.m1.1.1.2.1.cmml">​</mo><mtext id="S6.Ex39.m1.1.1.2.5" xref="S6.Ex39.m1.1.1.2.5a.cmml">Cars</mtext></mrow><mo fence="false" lspace="0.778em" rspace="0.778em" id="S6.Ex39.m1.1.1.1" xref="S6.Ex39.m1.1.1.1.cmml">|</mo><mrow id="S6.Ex39.m1.1.1.3" xref="S6.Ex39.m1.1.1.3.cmml"><mtext id="S6.Ex39.m1.1.1.3.2" xref="S6.Ex39.m1.1.1.3.2a.cmml">Cars</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex39.m1.1.1.3.1" xref="S6.Ex39.m1.1.1.3.1.cmml">​</mo><mtext id="S6.Ex39.m1.1.1.3.3" xref="S6.Ex39.m1.1.1.3.3a.cmml">Cars</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex39.m1.1.1.3.1a" xref="S6.Ex39.m1.1.1.3.1.cmml">​</mo><mtext id="S6.Ex39.m1.1.1.3.4" xref="S6.Ex39.m1.1.1.3.4a.cmml">Median</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex39.m1.1.1.3.1b" xref="S6.Ex39.m1.1.1.3.1.cmml">​</mo><mtext id="S6.Ex39.m1.1.1.3.5" xref="S6.Ex39.m1.1.1.3.5a.cmml">Cars</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex39.m1.1.1.3.1c" xref="S6.Ex39.m1.1.1.3.1.cmml">​</mo><mtext id="S6.Ex39.m1.1.1.3.6" xref="S6.Ex39.m1.1.1.3.6a.cmml">Cars</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex39.m1.1b"><apply id="S6.Ex39.m1.1.1.cmml" xref="S6.Ex39.m1.1.1"><csymbol cd="latexml" id="S6.Ex39.m1.1.1.1.cmml" xref="S6.Ex39.m1.1.1.1">conditional</csymbol><apply id="S6.Ex39.m1.1.1.2.cmml" xref="S6.Ex39.m1.1.1.2"><times id="S6.Ex39.m1.1.1.2.1.cmml" xref="S6.Ex39.m1.1.1.2.1"></times><ci id="S6.Ex39.m1.1.1.2.2a.cmml" xref="S6.Ex39.m1.1.1.2.2"><mtext id="S6.Ex39.m1.1.1.2.2.cmml" xref="S6.Ex39.m1.1.1.2.2">Cars</mtext></ci><ci id="S6.Ex39.m1.1.1.2.3a.cmml" xref="S6.Ex39.m1.1.1.2.3"><mtext id="S6.Ex39.m1.1.1.2.3.cmml" xref="S6.Ex39.m1.1.1.2.3">Cars</mtext></ci><ci id="S6.Ex39.m1.1.1.2.4a.cmml" xref="S6.Ex39.m1.1.1.2.4"><mtext id="S6.Ex39.m1.1.1.2.4.cmml" xref="S6.Ex39.m1.1.1.2.4">Median</mtext></ci><ci id="S6.Ex39.m1.1.1.2.5a.cmml" xref="S6.Ex39.m1.1.1.2.5"><mtext id="S6.Ex39.m1.1.1.2.5.cmml" xref="S6.Ex39.m1.1.1.2.5">Cars</mtext></ci></apply><apply id="S6.Ex39.m1.1.1.3.cmml" xref="S6.Ex39.m1.1.1.3"><times id="S6.Ex39.m1.1.1.3.1.cmml" xref="S6.Ex39.m1.1.1.3.1"></times><ci id="S6.Ex39.m1.1.1.3.2a.cmml" xref="S6.Ex39.m1.1.1.3.2"><mtext id="S6.Ex39.m1.1.1.3.2.cmml" xref="S6.Ex39.m1.1.1.3.2">Cars</mtext></ci><ci id="S6.Ex39.m1.1.1.3.3a.cmml" xref="S6.Ex39.m1.1.1.3.3"><mtext id="S6.Ex39.m1.1.1.3.3.cmml" xref="S6.Ex39.m1.1.1.3.3">Cars</mtext></ci><ci id="S6.Ex39.m1.1.1.3.4a.cmml" xref="S6.Ex39.m1.1.1.3.4"><mtext id="S6.Ex39.m1.1.1.3.4.cmml" xref="S6.Ex39.m1.1.1.3.4">Median</mtext></ci><ci id="S6.Ex39.m1.1.1.3.5a.cmml" xref="S6.Ex39.m1.1.1.3.5"><mtext id="S6.Ex39.m1.1.1.3.5.cmml" xref="S6.Ex39.m1.1.1.3.5">Cars</mtext></ci><ci id="S6.Ex39.m1.1.1.3.6a.cmml" xref="S6.Ex39.m1.1.1.3.6"><mtext id="S6.Ex39.m1.1.1.3.6.cmml" xref="S6.Ex39.m1.1.1.3.6">Cars</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex39.m1.1c">\displaystyle\ \text{Cars}\ \text{Cars}\ \text{Median}\ \text{Cars}\ |\ \text{Cars}\ \text{Cars}\ \text{Median}\ \text{Cars}\ \text{Cars}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex40"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S6.Ex40.m1.1" class="ltx_Math" alttext="\displaystyle\text{Outer}_{L}" display="inline"><semantics id="S6.Ex40.m1.1a"><msub id="S6.Ex40.m1.1.1" xref="S6.Ex40.m1.1.1.cmml"><mtext id="S6.Ex40.m1.1.1.2" xref="S6.Ex40.m1.1.1.2a.cmml">Outer</mtext><mi id="S6.Ex40.m1.1.1.3" xref="S6.Ex40.m1.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S6.Ex40.m1.1b"><apply id="S6.Ex40.m1.1.1.cmml" xref="S6.Ex40.m1.1.1"><csymbol cd="ambiguous" id="S6.Ex40.m1.1.1.1.cmml" xref="S6.Ex40.m1.1.1">subscript</csymbol><ci id="S6.Ex40.m1.1.1.2a.cmml" xref="S6.Ex40.m1.1.1.2"><mtext id="S6.Ex40.m1.1.1.2.cmml" xref="S6.Ex40.m1.1.1.2">Outer</mtext></ci><ci id="S6.Ex40.m1.1.1.3.cmml" xref="S6.Ex40.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex40.m1.1c">\displaystyle\text{Outer}_{L}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex40.m2.1" class="ltx_Math" alttext="\displaystyle\to\text{Shoulder}\ \text{Foliage}" display="inline"><semantics id="S6.Ex40.m2.1a"><mrow id="S6.Ex40.m2.1.1" xref="S6.Ex40.m2.1.1.cmml"><mi id="S6.Ex40.m2.1.1.2" xref="S6.Ex40.m2.1.1.2.cmml"></mi><mo stretchy="false" id="S6.Ex40.m2.1.1.1" xref="S6.Ex40.m2.1.1.1.cmml">→</mo><mrow id="S6.Ex40.m2.1.1.3" xref="S6.Ex40.m2.1.1.3.cmml"><mtext id="S6.Ex40.m2.1.1.3.2" xref="S6.Ex40.m2.1.1.3.2a.cmml">Shoulder</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex40.m2.1.1.3.1" xref="S6.Ex40.m2.1.1.3.1.cmml">​</mo><mtext id="S6.Ex40.m2.1.1.3.3" xref="S6.Ex40.m2.1.1.3.3a.cmml">Foliage</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex40.m2.1b"><apply id="S6.Ex40.m2.1.1.cmml" xref="S6.Ex40.m2.1.1"><ci id="S6.Ex40.m2.1.1.1.cmml" xref="S6.Ex40.m2.1.1.1">→</ci><csymbol cd="latexml" id="S6.Ex40.m2.1.1.2.cmml" xref="S6.Ex40.m2.1.1.2">absent</csymbol><apply id="S6.Ex40.m2.1.1.3.cmml" xref="S6.Ex40.m2.1.1.3"><times id="S6.Ex40.m2.1.1.3.1.cmml" xref="S6.Ex40.m2.1.1.3.1"></times><ci id="S6.Ex40.m2.1.1.3.2a.cmml" xref="S6.Ex40.m2.1.1.3.2"><mtext id="S6.Ex40.m2.1.1.3.2.cmml" xref="S6.Ex40.m2.1.1.3.2">Shoulder</mtext></ci><ci id="S6.Ex40.m2.1.1.3.3a.cmml" xref="S6.Ex40.m2.1.1.3.3"><mtext id="S6.Ex40.m2.1.1.3.3.cmml" xref="S6.Ex40.m2.1.1.3.3">Foliage</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex40.m2.1c">\displaystyle\to\text{Shoulder}\ \text{Foliage}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex41"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S6.Ex41.m1.1" class="ltx_Math" alttext="\displaystyle\text{Outer}_{R}" display="inline"><semantics id="S6.Ex41.m1.1a"><msub id="S6.Ex41.m1.1.1" xref="S6.Ex41.m1.1.1.cmml"><mtext id="S6.Ex41.m1.1.1.2" xref="S6.Ex41.m1.1.1.2a.cmml">Outer</mtext><mi id="S6.Ex41.m1.1.1.3" xref="S6.Ex41.m1.1.1.3.cmml">R</mi></msub><annotation-xml encoding="MathML-Content" id="S6.Ex41.m1.1b"><apply id="S6.Ex41.m1.1.1.cmml" xref="S6.Ex41.m1.1.1"><csymbol cd="ambiguous" id="S6.Ex41.m1.1.1.1.cmml" xref="S6.Ex41.m1.1.1">subscript</csymbol><ci id="S6.Ex41.m1.1.1.2a.cmml" xref="S6.Ex41.m1.1.1.2"><mtext id="S6.Ex41.m1.1.1.2.cmml" xref="S6.Ex41.m1.1.1.2">Outer</mtext></ci><ci id="S6.Ex41.m1.1.1.3.cmml" xref="S6.Ex41.m1.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex41.m1.1c">\displaystyle\text{Outer}_{R}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex41.m2.1" class="ltx_Math" alttext="\displaystyle\to\text{Shoulder}\ \text{Foliage}" display="inline"><semantics id="S6.Ex41.m2.1a"><mrow id="S6.Ex41.m2.1.1" xref="S6.Ex41.m2.1.1.cmml"><mi id="S6.Ex41.m2.1.1.2" xref="S6.Ex41.m2.1.1.2.cmml"></mi><mo stretchy="false" id="S6.Ex41.m2.1.1.1" xref="S6.Ex41.m2.1.1.1.cmml">→</mo><mrow id="S6.Ex41.m2.1.1.3" xref="S6.Ex41.m2.1.1.3.cmml"><mtext id="S6.Ex41.m2.1.1.3.2" xref="S6.Ex41.m2.1.1.3.2a.cmml">Shoulder</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex41.m2.1.1.3.1" xref="S6.Ex41.m2.1.1.3.1.cmml">​</mo><mtext id="S6.Ex41.m2.1.1.3.3" xref="S6.Ex41.m2.1.1.3.3a.cmml">Foliage</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex41.m2.1b"><apply id="S6.Ex41.m2.1.1.cmml" xref="S6.Ex41.m2.1.1"><ci id="S6.Ex41.m2.1.1.1.cmml" xref="S6.Ex41.m2.1.1.1">→</ci><csymbol cd="latexml" id="S6.Ex41.m2.1.1.2.cmml" xref="S6.Ex41.m2.1.1.2">absent</csymbol><apply id="S6.Ex41.m2.1.1.3.cmml" xref="S6.Ex41.m2.1.1.3"><times id="S6.Ex41.m2.1.1.3.1.cmml" xref="S6.Ex41.m2.1.1.3.1"></times><ci id="S6.Ex41.m2.1.1.3.2a.cmml" xref="S6.Ex41.m2.1.1.3.2"><mtext id="S6.Ex41.m2.1.1.3.2.cmml" xref="S6.Ex41.m2.1.1.3.2">Shoulder</mtext></ci><ci id="S6.Ex41.m2.1.1.3.3a.cmml" xref="S6.Ex41.m2.1.1.3.3"><mtext id="S6.Ex41.m2.1.1.3.3.cmml" xref="S6.Ex41.m2.1.1.3.3">Foliage</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex41.m2.1c">\displaystyle\to\text{Shoulder}\ \text{Foliage}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex42"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S6.Ex42.2.1.1.1" class="ltx_text ltx_markedasmath">Cars</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex42.m2.1" class="ltx_Math" alttext="\displaystyle\to\text{car}\ |\ \epsilon\ |\ \text{Cars}" display="inline"><semantics id="S6.Ex42.m2.1a"><mrow id="S6.Ex42.m2.1.2" xref="S6.Ex42.m2.1.2.cmml"><mi id="S6.Ex42.m2.1.2.2" xref="S6.Ex42.m2.1.2.2.cmml"></mi><mo stretchy="false" id="S6.Ex42.m2.1.2.1" xref="S6.Ex42.m2.1.2.1.cmml">→</mo><mrow id="S6.Ex42.m2.1.2.3" xref="S6.Ex42.m2.1.2.3.cmml"><mtext id="S6.Ex42.m2.1.2.3.2" xref="S6.Ex42.m2.1.2.3.2a.cmml">car</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex42.m2.1.2.3.1" xref="S6.Ex42.m2.1.2.3.1.cmml">​</mo><mrow id="S6.Ex42.m2.1.2.3.3.2" xref="S6.Ex42.m2.1.2.3.3.1.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex42.m2.1.2.3.3.2.1" xref="S6.Ex42.m2.1.2.3.3.1.1.cmml">|</mo><mi id="S6.Ex42.m2.1.1" xref="S6.Ex42.m2.1.1.cmml">ϵ</mi><mo lspace="0.500em" stretchy="false" id="S6.Ex42.m2.1.2.3.3.2.2" xref="S6.Ex42.m2.1.2.3.3.1.1.cmml">|</mo></mrow><mo lspace="0.500em" rspace="0em" id="S6.Ex42.m2.1.2.3.1a" xref="S6.Ex42.m2.1.2.3.1.cmml">​</mo><mtext id="S6.Ex42.m2.1.2.3.4" xref="S6.Ex42.m2.1.2.3.4a.cmml">Cars</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex42.m2.1b"><apply id="S6.Ex42.m2.1.2.cmml" xref="S6.Ex42.m2.1.2"><ci id="S6.Ex42.m2.1.2.1.cmml" xref="S6.Ex42.m2.1.2.1">→</ci><csymbol cd="latexml" id="S6.Ex42.m2.1.2.2.cmml" xref="S6.Ex42.m2.1.2.2">absent</csymbol><apply id="S6.Ex42.m2.1.2.3.cmml" xref="S6.Ex42.m2.1.2.3"><times id="S6.Ex42.m2.1.2.3.1.cmml" xref="S6.Ex42.m2.1.2.3.1"></times><ci id="S6.Ex42.m2.1.2.3.2a.cmml" xref="S6.Ex42.m2.1.2.3.2"><mtext id="S6.Ex42.m2.1.2.3.2.cmml" xref="S6.Ex42.m2.1.2.3.2">car</mtext></ci><apply id="S6.Ex42.m2.1.2.3.3.1.cmml" xref="S6.Ex42.m2.1.2.3.3.2"><abs id="S6.Ex42.m2.1.2.3.3.1.1.cmml" xref="S6.Ex42.m2.1.2.3.3.2.1"></abs><ci id="S6.Ex42.m2.1.1.cmml" xref="S6.Ex42.m2.1.1">italic-ϵ</ci></apply><ci id="S6.Ex42.m2.1.2.3.4a.cmml" xref="S6.Ex42.m2.1.2.3.4"><mtext id="S6.Ex42.m2.1.2.3.4.cmml" xref="S6.Ex42.m2.1.2.3.4">Cars</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex42.m2.1c">\displaystyle\to\text{car}\ |\ \epsilon\ |\ \text{Cars}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex43"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S6.Ex43.2.1.1.1" class="ltx_text ltx_markedasmath">Foliage</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex43.m2.1" class="ltx_Math" alttext="\displaystyle\to\text{tree}\ |\ \epsilon\ |\ \text{Foliage}" display="inline"><semantics id="S6.Ex43.m2.1a"><mrow id="S6.Ex43.m2.1.2" xref="S6.Ex43.m2.1.2.cmml"><mi id="S6.Ex43.m2.1.2.2" xref="S6.Ex43.m2.1.2.2.cmml"></mi><mo stretchy="false" id="S6.Ex43.m2.1.2.1" xref="S6.Ex43.m2.1.2.1.cmml">→</mo><mrow id="S6.Ex43.m2.1.2.3" xref="S6.Ex43.m2.1.2.3.cmml"><mtext id="S6.Ex43.m2.1.2.3.2" xref="S6.Ex43.m2.1.2.3.2a.cmml">tree</mtext><mo lspace="0.500em" rspace="0em" id="S6.Ex43.m2.1.2.3.1" xref="S6.Ex43.m2.1.2.3.1.cmml">​</mo><mrow id="S6.Ex43.m2.1.2.3.3.2" xref="S6.Ex43.m2.1.2.3.3.1.cmml"><mo rspace="0.500em" stretchy="false" id="S6.Ex43.m2.1.2.3.3.2.1" xref="S6.Ex43.m2.1.2.3.3.1.1.cmml">|</mo><mi id="S6.Ex43.m2.1.1" xref="S6.Ex43.m2.1.1.cmml">ϵ</mi><mo lspace="0.500em" stretchy="false" id="S6.Ex43.m2.1.2.3.3.2.2" xref="S6.Ex43.m2.1.2.3.3.1.1.cmml">|</mo></mrow><mo lspace="0.500em" rspace="0em" id="S6.Ex43.m2.1.2.3.1a" xref="S6.Ex43.m2.1.2.3.1.cmml">​</mo><mtext id="S6.Ex43.m2.1.2.3.4" xref="S6.Ex43.m2.1.2.3.4a.cmml">Foliage</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex43.m2.1b"><apply id="S6.Ex43.m2.1.2.cmml" xref="S6.Ex43.m2.1.2"><ci id="S6.Ex43.m2.1.2.1.cmml" xref="S6.Ex43.m2.1.2.1">→</ci><csymbol cd="latexml" id="S6.Ex43.m2.1.2.2.cmml" xref="S6.Ex43.m2.1.2.2">absent</csymbol><apply id="S6.Ex43.m2.1.2.3.cmml" xref="S6.Ex43.m2.1.2.3"><times id="S6.Ex43.m2.1.2.3.1.cmml" xref="S6.Ex43.m2.1.2.3.1"></times><ci id="S6.Ex43.m2.1.2.3.2a.cmml" xref="S6.Ex43.m2.1.2.3.2"><mtext id="S6.Ex43.m2.1.2.3.2.cmml" xref="S6.Ex43.m2.1.2.3.2">tree</mtext></ci><apply id="S6.Ex43.m2.1.2.3.3.1.cmml" xref="S6.Ex43.m2.1.2.3.3.2"><abs id="S6.Ex43.m2.1.2.3.3.1.1.cmml" xref="S6.Ex43.m2.1.2.3.3.2.1"></abs><ci id="S6.Ex43.m2.1.1.cmml" xref="S6.Ex43.m2.1.1">italic-ϵ</ci></apply><ci id="S6.Ex43.m2.1.2.3.4a.cmml" xref="S6.Ex43.m2.1.2.3.4"><mtext id="S6.Ex43.m2.1.2.3.4.cmml" xref="S6.Ex43.m2.1.2.3.4">Foliage</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex43.m2.1c">\displaystyle\to\text{tree}\ |\ \epsilon\ |\ \text{Foliage}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex44"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S6.Ex44.2.1.1.1" class="ltx_text ltx_markedasmath">Median</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.Ex44.m2.1" class="ltx_Math" alttext="\displaystyle\to\epsilon" display="inline"><semantics id="S6.Ex44.m2.1a"><mrow id="S6.Ex44.m2.1.1" xref="S6.Ex44.m2.1.1.cmml"><mi id="S6.Ex44.m2.1.1.2" xref="S6.Ex44.m2.1.1.2.cmml"></mi><mo stretchy="false" id="S6.Ex44.m2.1.1.1" xref="S6.Ex44.m2.1.1.1.cmml">→</mo><mi id="S6.Ex44.m2.1.1.3" xref="S6.Ex44.m2.1.1.3.cmml">ϵ</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex44.m2.1b"><apply id="S6.Ex44.m2.1.1.cmml" xref="S6.Ex44.m2.1.1"><ci id="S6.Ex44.m2.1.1.1.cmml" xref="S6.Ex44.m2.1.1.1">→</ci><csymbol cd="latexml" id="S6.Ex44.m2.1.1.2.cmml" xref="S6.Ex44.m2.1.1.2">absent</csymbol><ci id="S6.Ex44.m2.1.1.3.cmml" xref="S6.Ex44.m2.1.1.3">italic-ϵ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex44.m2.1c">\displaystyle\to\epsilon</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S6.SS1.SSS4.p2.5" class="ltx_p">The Median non-terminal represents a grass or stone median that divides the left and right portions of the street. Note that the order of non-terminals in a production rule does not always reflection position on the scene but rather the order in sampling. The position of a child object within its parent is decided by its parameters, that come from either a prior or are learnt, using the method of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>.</p>
</div>
<div id="S6.SS1.SSS4.p3" class="ltx_para ltx_noindent">
<p id="S6.SS1.SSS4.p3.1" class="ltx_p"><span id="S6.SS1.SSS4.p3.1.1" class="ltx_text ltx_font_bold">Feature Network Architecture:</span> We use the pool-3 layer of the inception-v3 network pre-trained on imagenet as our feature network.</p>
</div>
<div id="S6.SS1.SSS4.p4" class="ltx_para ltx_noindent">
<p id="S6.SS1.SSS4.p4.6" class="ltx_p"><span id="S6.SS1.SSS4.p4.6.1" class="ltx_text ltx_font_bold">Structure Generation Model Pre-Training:</span> We sample 2000 prior structures for each scenario. We train the structure generation model of each scenario to minimize the negative log likelihood of the generated structures for the given scenario. This is done for 10 epochs using the default ADAM optimizer with a batch size of 100. We have two different priors for sampling structures. The prior from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> and a simple prior. Both priors have the same sampling procedure but differ in terms of the distribution. In general sampling is done by sampling a random number of objects to be placed onto each container (the containers being Street, Outer, Shoulder, Sidewalk and Median). The sampling is done using a uniform distribution bounded by <math id="S6.SS1.SSS4.p4.1.m1.1" class="ltx_Math" alttext="n_{\text{min}}" display="inline"><semantics id="S6.SS1.SSS4.p4.1.m1.1a"><msub id="S6.SS1.SSS4.p4.1.m1.1.1" xref="S6.SS1.SSS4.p4.1.m1.1.1.cmml"><mi id="S6.SS1.SSS4.p4.1.m1.1.1.2" xref="S6.SS1.SSS4.p4.1.m1.1.1.2.cmml">n</mi><mtext id="S6.SS1.SSS4.p4.1.m1.1.1.3" xref="S6.SS1.SSS4.p4.1.m1.1.1.3a.cmml">min</mtext></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p4.1.m1.1b"><apply id="S6.SS1.SSS4.p4.1.m1.1.1.cmml" xref="S6.SS1.SSS4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p4.1.m1.1.1.1.cmml" xref="S6.SS1.SSS4.p4.1.m1.1.1">subscript</csymbol><ci id="S6.SS1.SSS4.p4.1.m1.1.1.2.cmml" xref="S6.SS1.SSS4.p4.1.m1.1.1.2">𝑛</ci><ci id="S6.SS1.SSS4.p4.1.m1.1.1.3a.cmml" xref="S6.SS1.SSS4.p4.1.m1.1.1.3"><mtext mathsize="70%" id="S6.SS1.SSS4.p4.1.m1.1.1.3.cmml" xref="S6.SS1.SSS4.p4.1.m1.1.1.3">min</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p4.1.m1.1c">n_{\text{min}}</annotation></semantics></math> and <math id="S6.SS1.SSS4.p4.2.m2.1" class="ltx_Math" alttext="n_{\text{max}}" display="inline"><semantics id="S6.SS1.SSS4.p4.2.m2.1a"><msub id="S6.SS1.SSS4.p4.2.m2.1.1" xref="S6.SS1.SSS4.p4.2.m2.1.1.cmml"><mi id="S6.SS1.SSS4.p4.2.m2.1.1.2" xref="S6.SS1.SSS4.p4.2.m2.1.1.2.cmml">n</mi><mtext id="S6.SS1.SSS4.p4.2.m2.1.1.3" xref="S6.SS1.SSS4.p4.2.m2.1.1.3a.cmml">max</mtext></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p4.2.m2.1b"><apply id="S6.SS1.SSS4.p4.2.m2.1.1.cmml" xref="S6.SS1.SSS4.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p4.2.m2.1.1.1.cmml" xref="S6.SS1.SSS4.p4.2.m2.1.1">subscript</csymbol><ci id="S6.SS1.SSS4.p4.2.m2.1.1.2.cmml" xref="S6.SS1.SSS4.p4.2.m2.1.1.2">𝑛</ci><ci id="S6.SS1.SSS4.p4.2.m2.1.1.3a.cmml" xref="S6.SS1.SSS4.p4.2.m2.1.1.3"><mtext mathsize="70%" id="S6.SS1.SSS4.p4.2.m2.1.1.3.cmml" xref="S6.SS1.SSS4.p4.2.m2.1.1.3">max</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p4.2.m2.1c">n_{\text{max}}</annotation></semantics></math> which determine the minimum and maximum number of objects in the container. In both priors the objects (i.e pole, sign, bike) are sampled with equal probability with replacement from the set of allowable objects in that specific container. An additional detail is determining the number of lanes on the road and whether or not the scene has a Median container and where should it be placed in the rural and urban scenarios. In both priors the number of lanes is sampled uniformly from 1 to 4 and the probability of a road having a median is 0.5. This can be interpreted as selecting a random production rule for the Street non terminal. Where the priors differ is in their choices of <math id="S6.SS1.SSS4.p4.3.m3.2" class="ltx_Math" alttext="(n_{\text{min}},n_{\text{max}})" display="inline"><semantics id="S6.SS1.SSS4.p4.3.m3.2a"><mrow id="S6.SS1.SSS4.p4.3.m3.2.2.2" xref="S6.SS1.SSS4.p4.3.m3.2.2.3.cmml"><mo stretchy="false" id="S6.SS1.SSS4.p4.3.m3.2.2.2.3" xref="S6.SS1.SSS4.p4.3.m3.2.2.3.cmml">(</mo><msub id="S6.SS1.SSS4.p4.3.m3.1.1.1.1" xref="S6.SS1.SSS4.p4.3.m3.1.1.1.1.cmml"><mi id="S6.SS1.SSS4.p4.3.m3.1.1.1.1.2" xref="S6.SS1.SSS4.p4.3.m3.1.1.1.1.2.cmml">n</mi><mtext id="S6.SS1.SSS4.p4.3.m3.1.1.1.1.3" xref="S6.SS1.SSS4.p4.3.m3.1.1.1.1.3a.cmml">min</mtext></msub><mo id="S6.SS1.SSS4.p4.3.m3.2.2.2.4" xref="S6.SS1.SSS4.p4.3.m3.2.2.3.cmml">,</mo><msub id="S6.SS1.SSS4.p4.3.m3.2.2.2.2" xref="S6.SS1.SSS4.p4.3.m3.2.2.2.2.cmml"><mi id="S6.SS1.SSS4.p4.3.m3.2.2.2.2.2" xref="S6.SS1.SSS4.p4.3.m3.2.2.2.2.2.cmml">n</mi><mtext id="S6.SS1.SSS4.p4.3.m3.2.2.2.2.3" xref="S6.SS1.SSS4.p4.3.m3.2.2.2.2.3a.cmml">max</mtext></msub><mo stretchy="false" id="S6.SS1.SSS4.p4.3.m3.2.2.2.5" xref="S6.SS1.SSS4.p4.3.m3.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p4.3.m3.2b"><interval closure="open" id="S6.SS1.SSS4.p4.3.m3.2.2.3.cmml" xref="S6.SS1.SSS4.p4.3.m3.2.2.2"><apply id="S6.SS1.SSS4.p4.3.m3.1.1.1.1.cmml" xref="S6.SS1.SSS4.p4.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p4.3.m3.1.1.1.1.1.cmml" xref="S6.SS1.SSS4.p4.3.m3.1.1.1.1">subscript</csymbol><ci id="S6.SS1.SSS4.p4.3.m3.1.1.1.1.2.cmml" xref="S6.SS1.SSS4.p4.3.m3.1.1.1.1.2">𝑛</ci><ci id="S6.SS1.SSS4.p4.3.m3.1.1.1.1.3a.cmml" xref="S6.SS1.SSS4.p4.3.m3.1.1.1.1.3"><mtext mathsize="70%" id="S6.SS1.SSS4.p4.3.m3.1.1.1.1.3.cmml" xref="S6.SS1.SSS4.p4.3.m3.1.1.1.1.3">min</mtext></ci></apply><apply id="S6.SS1.SSS4.p4.3.m3.2.2.2.2.cmml" xref="S6.SS1.SSS4.p4.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p4.3.m3.2.2.2.2.1.cmml" xref="S6.SS1.SSS4.p4.3.m3.2.2.2.2">subscript</csymbol><ci id="S6.SS1.SSS4.p4.3.m3.2.2.2.2.2.cmml" xref="S6.SS1.SSS4.p4.3.m3.2.2.2.2.2">𝑛</ci><ci id="S6.SS1.SSS4.p4.3.m3.2.2.2.2.3a.cmml" xref="S6.SS1.SSS4.p4.3.m3.2.2.2.2.3"><mtext mathsize="70%" id="S6.SS1.SSS4.p4.3.m3.2.2.2.2.3.cmml" xref="S6.SS1.SSS4.p4.3.m3.2.2.2.2.3">max</mtext></ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p4.3.m3.2c">(n_{\text{min}},n_{\text{max}})</annotation></semantics></math> for each container. In the prior from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> the bounds are chosen to match the given scenario. For example in the rural setting there is a large bound on the number of foliage while in the urban setting it is smaller. Thus each container has a unique <math id="S6.SS1.SSS4.p4.4.m4.1" class="ltx_Math" alttext="(n_{\text{min}}n_{\text{max}})" display="inline"><semantics id="S6.SS1.SSS4.p4.4.m4.1a"><mrow id="S6.SS1.SSS4.p4.4.m4.1.1.1" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.cmml"><mo stretchy="false" id="S6.SS1.SSS4.p4.4.m4.1.1.1.2" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.cmml">(</mo><mrow id="S6.SS1.SSS4.p4.4.m4.1.1.1.1" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.cmml"><msub id="S6.SS1.SSS4.p4.4.m4.1.1.1.1.2" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.2.cmml"><mi id="S6.SS1.SSS4.p4.4.m4.1.1.1.1.2.2" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.2.2.cmml">n</mi><mtext id="S6.SS1.SSS4.p4.4.m4.1.1.1.1.2.3" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.2.3a.cmml">min</mtext></msub><mo lspace="0em" rspace="0em" id="S6.SS1.SSS4.p4.4.m4.1.1.1.1.1" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.1.cmml">​</mo><msub id="S6.SS1.SSS4.p4.4.m4.1.1.1.1.3" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.3.cmml"><mi id="S6.SS1.SSS4.p4.4.m4.1.1.1.1.3.2" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.3.2.cmml">n</mi><mtext id="S6.SS1.SSS4.p4.4.m4.1.1.1.1.3.3" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.3.3a.cmml">max</mtext></msub></mrow><mo stretchy="false" id="S6.SS1.SSS4.p4.4.m4.1.1.1.3" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p4.4.m4.1b"><apply id="S6.SS1.SSS4.p4.4.m4.1.1.1.1.cmml" xref="S6.SS1.SSS4.p4.4.m4.1.1.1"><times id="S6.SS1.SSS4.p4.4.m4.1.1.1.1.1.cmml" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.1"></times><apply id="S6.SS1.SSS4.p4.4.m4.1.1.1.1.2.cmml" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p4.4.m4.1.1.1.1.2.1.cmml" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS4.p4.4.m4.1.1.1.1.2.2.cmml" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.2.2">𝑛</ci><ci id="S6.SS1.SSS4.p4.4.m4.1.1.1.1.2.3a.cmml" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.2.3"><mtext mathsize="70%" id="S6.SS1.SSS4.p4.4.m4.1.1.1.1.2.3.cmml" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.2.3">min</mtext></ci></apply><apply id="S6.SS1.SSS4.p4.4.m4.1.1.1.1.3.cmml" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p4.4.m4.1.1.1.1.3.1.cmml" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.3">subscript</csymbol><ci id="S6.SS1.SSS4.p4.4.m4.1.1.1.1.3.2.cmml" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.3.2">𝑛</ci><ci id="S6.SS1.SSS4.p4.4.m4.1.1.1.1.3.3a.cmml" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.3.3"><mtext mathsize="70%" id="S6.SS1.SSS4.p4.4.m4.1.1.1.1.3.3.cmml" xref="S6.SS1.SSS4.p4.4.m4.1.1.1.1.3.3">max</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p4.4.m4.1c">(n_{\text{min}}n_{\text{max}})</annotation></semantics></math> that is determined by the scenario. In the simple prior we restrict <math id="S6.SS1.SSS4.p4.5.m5.1" class="ltx_Math" alttext="n_{\text{min}}=0" display="inline"><semantics id="S6.SS1.SSS4.p4.5.m5.1a"><mrow id="S6.SS1.SSS4.p4.5.m5.1.1" xref="S6.SS1.SSS4.p4.5.m5.1.1.cmml"><msub id="S6.SS1.SSS4.p4.5.m5.1.1.2" xref="S6.SS1.SSS4.p4.5.m5.1.1.2.cmml"><mi id="S6.SS1.SSS4.p4.5.m5.1.1.2.2" xref="S6.SS1.SSS4.p4.5.m5.1.1.2.2.cmml">n</mi><mtext id="S6.SS1.SSS4.p4.5.m5.1.1.2.3" xref="S6.SS1.SSS4.p4.5.m5.1.1.2.3a.cmml">min</mtext></msub><mo id="S6.SS1.SSS4.p4.5.m5.1.1.1" xref="S6.SS1.SSS4.p4.5.m5.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS4.p4.5.m5.1.1.3" xref="S6.SS1.SSS4.p4.5.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p4.5.m5.1b"><apply id="S6.SS1.SSS4.p4.5.m5.1.1.cmml" xref="S6.SS1.SSS4.p4.5.m5.1.1"><eq id="S6.SS1.SSS4.p4.5.m5.1.1.1.cmml" xref="S6.SS1.SSS4.p4.5.m5.1.1.1"></eq><apply id="S6.SS1.SSS4.p4.5.m5.1.1.2.cmml" xref="S6.SS1.SSS4.p4.5.m5.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p4.5.m5.1.1.2.1.cmml" xref="S6.SS1.SSS4.p4.5.m5.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS4.p4.5.m5.1.1.2.2.cmml" xref="S6.SS1.SSS4.p4.5.m5.1.1.2.2">𝑛</ci><ci id="S6.SS1.SSS4.p4.5.m5.1.1.2.3a.cmml" xref="S6.SS1.SSS4.p4.5.m5.1.1.2.3"><mtext mathsize="70%" id="S6.SS1.SSS4.p4.5.m5.1.1.2.3.cmml" xref="S6.SS1.SSS4.p4.5.m5.1.1.2.3">min</mtext></ci></apply><cn type="integer" id="S6.SS1.SSS4.p4.5.m5.1.1.3.cmml" xref="S6.SS1.SSS4.p4.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p4.5.m5.1c">n_{\text{min}}=0</annotation></semantics></math> and <math id="S6.SS1.SSS4.p4.6.m6.1" class="ltx_Math" alttext="n_{\text{max}}=2" display="inline"><semantics id="S6.SS1.SSS4.p4.6.m6.1a"><mrow id="S6.SS1.SSS4.p4.6.m6.1.1" xref="S6.SS1.SSS4.p4.6.m6.1.1.cmml"><msub id="S6.SS1.SSS4.p4.6.m6.1.1.2" xref="S6.SS1.SSS4.p4.6.m6.1.1.2.cmml"><mi id="S6.SS1.SSS4.p4.6.m6.1.1.2.2" xref="S6.SS1.SSS4.p4.6.m6.1.1.2.2.cmml">n</mi><mtext id="S6.SS1.SSS4.p4.6.m6.1.1.2.3" xref="S6.SS1.SSS4.p4.6.m6.1.1.2.3a.cmml">max</mtext></msub><mo id="S6.SS1.SSS4.p4.6.m6.1.1.1" xref="S6.SS1.SSS4.p4.6.m6.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS4.p4.6.m6.1.1.3" xref="S6.SS1.SSS4.p4.6.m6.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p4.6.m6.1b"><apply id="S6.SS1.SSS4.p4.6.m6.1.1.cmml" xref="S6.SS1.SSS4.p4.6.m6.1.1"><eq id="S6.SS1.SSS4.p4.6.m6.1.1.1.cmml" xref="S6.SS1.SSS4.p4.6.m6.1.1.1"></eq><apply id="S6.SS1.SSS4.p4.6.m6.1.1.2.cmml" xref="S6.SS1.SSS4.p4.6.m6.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p4.6.m6.1.1.2.1.cmml" xref="S6.SS1.SSS4.p4.6.m6.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS4.p4.6.m6.1.1.2.2.cmml" xref="S6.SS1.SSS4.p4.6.m6.1.1.2.2">𝑛</ci><ci id="S6.SS1.SSS4.p4.6.m6.1.1.2.3a.cmml" xref="S6.SS1.SSS4.p4.6.m6.1.1.2.3"><mtext mathsize="70%" id="S6.SS1.SSS4.p4.6.m6.1.1.2.3.cmml" xref="S6.SS1.SSS4.p4.6.m6.1.1.2.3">max</mtext></ci></apply><cn type="integer" id="S6.SS1.SSS4.p4.6.m6.1.1.3.cmml" xref="S6.SS1.SSS4.p4.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p4.6.m6.1c">n_{\text{max}}=2</annotation></semantics></math> for all containers in all scenarios.</p>
</div>
<div id="S6.SS1.SSS4.p5" class="ltx_para ltx_noindent">
<p id="S6.SS1.SSS4.p5.5" class="ltx_p"><span id="S6.SS1.SSS4.p5.5.1" class="ltx_text ltx_font_bold">Structure Generation Model Training:</span> We use a batch size of <math id="S6.SS1.SSS4.p5.1.m1.1" class="ltx_Math" alttext="l=300" display="inline"><semantics id="S6.SS1.SSS4.p5.1.m1.1a"><mrow id="S6.SS1.SSS4.p5.1.m1.1.1" xref="S6.SS1.SSS4.p5.1.m1.1.1.cmml"><mi id="S6.SS1.SSS4.p5.1.m1.1.1.2" xref="S6.SS1.SSS4.p5.1.m1.1.1.2.cmml">l</mi><mo id="S6.SS1.SSS4.p5.1.m1.1.1.1" xref="S6.SS1.SSS4.p5.1.m1.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS4.p5.1.m1.1.1.3" xref="S6.SS1.SSS4.p5.1.m1.1.1.3.cmml">300</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p5.1.m1.1b"><apply id="S6.SS1.SSS4.p5.1.m1.1.1.cmml" xref="S6.SS1.SSS4.p5.1.m1.1.1"><eq id="S6.SS1.SSS4.p5.1.m1.1.1.1.cmml" xref="S6.SS1.SSS4.p5.1.m1.1.1.1"></eq><ci id="S6.SS1.SSS4.p5.1.m1.1.1.2.cmml" xref="S6.SS1.SSS4.p5.1.m1.1.1.2">𝑙</ci><cn type="integer" id="S6.SS1.SSS4.p5.1.m1.1.1.3.cmml" xref="S6.SS1.SSS4.p5.1.m1.1.1.3">300</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p5.1.m1.1c">l=300</annotation></semantics></math> for the real images <math id="S6.SS1.SSS4.p5.2.m2.3" class="ltx_Math" alttext="V=\{v_{1},\ldots,v_{l}\}" display="inline"><semantics id="S6.SS1.SSS4.p5.2.m2.3a"><mrow id="S6.SS1.SSS4.p5.2.m2.3.3" xref="S6.SS1.SSS4.p5.2.m2.3.3.cmml"><mi id="S6.SS1.SSS4.p5.2.m2.3.3.4" xref="S6.SS1.SSS4.p5.2.m2.3.3.4.cmml">V</mi><mo id="S6.SS1.SSS4.p5.2.m2.3.3.3" xref="S6.SS1.SSS4.p5.2.m2.3.3.3.cmml">=</mo><mrow id="S6.SS1.SSS4.p5.2.m2.3.3.2.2" xref="S6.SS1.SSS4.p5.2.m2.3.3.2.3.cmml"><mo stretchy="false" id="S6.SS1.SSS4.p5.2.m2.3.3.2.2.3" xref="S6.SS1.SSS4.p5.2.m2.3.3.2.3.cmml">{</mo><msub id="S6.SS1.SSS4.p5.2.m2.2.2.1.1.1" xref="S6.SS1.SSS4.p5.2.m2.2.2.1.1.1.cmml"><mi id="S6.SS1.SSS4.p5.2.m2.2.2.1.1.1.2" xref="S6.SS1.SSS4.p5.2.m2.2.2.1.1.1.2.cmml">v</mi><mn id="S6.SS1.SSS4.p5.2.m2.2.2.1.1.1.3" xref="S6.SS1.SSS4.p5.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S6.SS1.SSS4.p5.2.m2.3.3.2.2.4" xref="S6.SS1.SSS4.p5.2.m2.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S6.SS1.SSS4.p5.2.m2.1.1" xref="S6.SS1.SSS4.p5.2.m2.1.1.cmml">…</mi><mo id="S6.SS1.SSS4.p5.2.m2.3.3.2.2.5" xref="S6.SS1.SSS4.p5.2.m2.3.3.2.3.cmml">,</mo><msub id="S6.SS1.SSS4.p5.2.m2.3.3.2.2.2" xref="S6.SS1.SSS4.p5.2.m2.3.3.2.2.2.cmml"><mi id="S6.SS1.SSS4.p5.2.m2.3.3.2.2.2.2" xref="S6.SS1.SSS4.p5.2.m2.3.3.2.2.2.2.cmml">v</mi><mi id="S6.SS1.SSS4.p5.2.m2.3.3.2.2.2.3" xref="S6.SS1.SSS4.p5.2.m2.3.3.2.2.2.3.cmml">l</mi></msub><mo stretchy="false" id="S6.SS1.SSS4.p5.2.m2.3.3.2.2.6" xref="S6.SS1.SSS4.p5.2.m2.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p5.2.m2.3b"><apply id="S6.SS1.SSS4.p5.2.m2.3.3.cmml" xref="S6.SS1.SSS4.p5.2.m2.3.3"><eq id="S6.SS1.SSS4.p5.2.m2.3.3.3.cmml" xref="S6.SS1.SSS4.p5.2.m2.3.3.3"></eq><ci id="S6.SS1.SSS4.p5.2.m2.3.3.4.cmml" xref="S6.SS1.SSS4.p5.2.m2.3.3.4">𝑉</ci><set id="S6.SS1.SSS4.p5.2.m2.3.3.2.3.cmml" xref="S6.SS1.SSS4.p5.2.m2.3.3.2.2"><apply id="S6.SS1.SSS4.p5.2.m2.2.2.1.1.1.cmml" xref="S6.SS1.SSS4.p5.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p5.2.m2.2.2.1.1.1.1.cmml" xref="S6.SS1.SSS4.p5.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S6.SS1.SSS4.p5.2.m2.2.2.1.1.1.2.cmml" xref="S6.SS1.SSS4.p5.2.m2.2.2.1.1.1.2">𝑣</ci><cn type="integer" id="S6.SS1.SSS4.p5.2.m2.2.2.1.1.1.3.cmml" xref="S6.SS1.SSS4.p5.2.m2.2.2.1.1.1.3">1</cn></apply><ci id="S6.SS1.SSS4.p5.2.m2.1.1.cmml" xref="S6.SS1.SSS4.p5.2.m2.1.1">…</ci><apply id="S6.SS1.SSS4.p5.2.m2.3.3.2.2.2.cmml" xref="S6.SS1.SSS4.p5.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p5.2.m2.3.3.2.2.2.1.cmml" xref="S6.SS1.SSS4.p5.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S6.SS1.SSS4.p5.2.m2.3.3.2.2.2.2.cmml" xref="S6.SS1.SSS4.p5.2.m2.3.3.2.2.2.2">𝑣</ci><ci id="S6.SS1.SSS4.p5.2.m2.3.3.2.2.2.3.cmml" xref="S6.SS1.SSS4.p5.2.m2.3.3.2.2.2.3">𝑙</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p5.2.m2.3c">V=\{v_{1},\ldots,v_{l}\}</annotation></semantics></math>. The real images are taken from the train split of the KITTI dataset. To produce our generated batch we sample <math id="S6.SS1.SSS4.p5.3.m3.1" class="ltx_Math" alttext="m=100" display="inline"><semantics id="S6.SS1.SSS4.p5.3.m3.1a"><mrow id="S6.SS1.SSS4.p5.3.m3.1.1" xref="S6.SS1.SSS4.p5.3.m3.1.1.cmml"><mi id="S6.SS1.SSS4.p5.3.m3.1.1.2" xref="S6.SS1.SSS4.p5.3.m3.1.1.2.cmml">m</mi><mo id="S6.SS1.SSS4.p5.3.m3.1.1.1" xref="S6.SS1.SSS4.p5.3.m3.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS4.p5.3.m3.1.1.3" xref="S6.SS1.SSS4.p5.3.m3.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p5.3.m3.1b"><apply id="S6.SS1.SSS4.p5.3.m3.1.1.cmml" xref="S6.SS1.SSS4.p5.3.m3.1.1"><eq id="S6.SS1.SSS4.p5.3.m3.1.1.1.cmml" xref="S6.SS1.SSS4.p5.3.m3.1.1.1"></eq><ci id="S6.SS1.SSS4.p5.3.m3.1.1.2.cmml" xref="S6.SS1.SSS4.p5.3.m3.1.1.2">𝑚</ci><cn type="integer" id="S6.SS1.SSS4.p5.3.m3.1.1.3.cmml" xref="S6.SS1.SSS4.p5.3.m3.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p5.3.m3.1c">m=100</annotation></semantics></math> images <math id="S6.SS1.SSS4.p5.4.m4.3" class="ltx_Math" alttext="B^{s}=\{v^{s}_{1},\ldots,v^{s}_{m}\}" display="inline"><semantics id="S6.SS1.SSS4.p5.4.m4.3a"><mrow id="S6.SS1.SSS4.p5.4.m4.3.3" xref="S6.SS1.SSS4.p5.4.m4.3.3.cmml"><msup id="S6.SS1.SSS4.p5.4.m4.3.3.4" xref="S6.SS1.SSS4.p5.4.m4.3.3.4.cmml"><mi id="S6.SS1.SSS4.p5.4.m4.3.3.4.2" xref="S6.SS1.SSS4.p5.4.m4.3.3.4.2.cmml">B</mi><mi id="S6.SS1.SSS4.p5.4.m4.3.3.4.3" xref="S6.SS1.SSS4.p5.4.m4.3.3.4.3.cmml">s</mi></msup><mo id="S6.SS1.SSS4.p5.4.m4.3.3.3" xref="S6.SS1.SSS4.p5.4.m4.3.3.3.cmml">=</mo><mrow id="S6.SS1.SSS4.p5.4.m4.3.3.2.2" xref="S6.SS1.SSS4.p5.4.m4.3.3.2.3.cmml"><mo stretchy="false" id="S6.SS1.SSS4.p5.4.m4.3.3.2.2.3" xref="S6.SS1.SSS4.p5.4.m4.3.3.2.3.cmml">{</mo><msubsup id="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1" xref="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1.cmml"><mi id="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1.2.2" xref="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1.2.2.cmml">v</mi><mn id="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1.3" xref="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1.3.cmml">1</mn><mi id="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1.2.3" xref="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1.2.3.cmml">s</mi></msubsup><mo id="S6.SS1.SSS4.p5.4.m4.3.3.2.2.4" xref="S6.SS1.SSS4.p5.4.m4.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S6.SS1.SSS4.p5.4.m4.1.1" xref="S6.SS1.SSS4.p5.4.m4.1.1.cmml">…</mi><mo id="S6.SS1.SSS4.p5.4.m4.3.3.2.2.5" xref="S6.SS1.SSS4.p5.4.m4.3.3.2.3.cmml">,</mo><msubsup id="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2" xref="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2.cmml"><mi id="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2.2.2" xref="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2.2.2.cmml">v</mi><mi id="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2.3" xref="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2.3.cmml">m</mi><mi id="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2.2.3" xref="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2.2.3.cmml">s</mi></msubsup><mo stretchy="false" id="S6.SS1.SSS4.p5.4.m4.3.3.2.2.6" xref="S6.SS1.SSS4.p5.4.m4.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p5.4.m4.3b"><apply id="S6.SS1.SSS4.p5.4.m4.3.3.cmml" xref="S6.SS1.SSS4.p5.4.m4.3.3"><eq id="S6.SS1.SSS4.p5.4.m4.3.3.3.cmml" xref="S6.SS1.SSS4.p5.4.m4.3.3.3"></eq><apply id="S6.SS1.SSS4.p5.4.m4.3.3.4.cmml" xref="S6.SS1.SSS4.p5.4.m4.3.3.4"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p5.4.m4.3.3.4.1.cmml" xref="S6.SS1.SSS4.p5.4.m4.3.3.4">superscript</csymbol><ci id="S6.SS1.SSS4.p5.4.m4.3.3.4.2.cmml" xref="S6.SS1.SSS4.p5.4.m4.3.3.4.2">𝐵</ci><ci id="S6.SS1.SSS4.p5.4.m4.3.3.4.3.cmml" xref="S6.SS1.SSS4.p5.4.m4.3.3.4.3">𝑠</ci></apply><set id="S6.SS1.SSS4.p5.4.m4.3.3.2.3.cmml" xref="S6.SS1.SSS4.p5.4.m4.3.3.2.2"><apply id="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1.cmml" xref="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1.1.cmml" xref="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1">subscript</csymbol><apply id="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1.2.cmml" xref="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1.2.1.cmml" xref="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1">superscript</csymbol><ci id="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1.2.2.cmml" xref="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1.2.2">𝑣</ci><ci id="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1.2.3.cmml" xref="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1.2.3">𝑠</ci></apply><cn type="integer" id="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1.3.cmml" xref="S6.SS1.SSS4.p5.4.m4.2.2.1.1.1.3">1</cn></apply><ci id="S6.SS1.SSS4.p5.4.m4.1.1.cmml" xref="S6.SS1.SSS4.p5.4.m4.1.1">…</ci><apply id="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2.cmml" xref="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2.1.cmml" xref="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2">subscript</csymbol><apply id="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2.2.cmml" xref="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2.2.1.cmml" xref="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2">superscript</csymbol><ci id="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2.2.2.cmml" xref="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2.2.2">𝑣</ci><ci id="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2.2.3.cmml" xref="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2.2.3">𝑠</ci></apply><ci id="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2.3.cmml" xref="S6.SS1.SSS4.p5.4.m4.3.3.2.2.2.3">𝑚</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p5.4.m4.3c">B^{s}=\{v^{s}_{1},\ldots,v^{s}_{m}\}</annotation></semantics></math> for each scenario <math id="S6.SS1.SSS4.p5.5.m5.3" class="ltx_Math" alttext="s\in\{\text{city},\text{suburban},\text{rural}\}" display="inline"><semantics id="S6.SS1.SSS4.p5.5.m5.3a"><mrow id="S6.SS1.SSS4.p5.5.m5.3.4" xref="S6.SS1.SSS4.p5.5.m5.3.4.cmml"><mi id="S6.SS1.SSS4.p5.5.m5.3.4.2" xref="S6.SS1.SSS4.p5.5.m5.3.4.2.cmml">s</mi><mo id="S6.SS1.SSS4.p5.5.m5.3.4.1" xref="S6.SS1.SSS4.p5.5.m5.3.4.1.cmml">∈</mo><mrow id="S6.SS1.SSS4.p5.5.m5.3.4.3.2" xref="S6.SS1.SSS4.p5.5.m5.3.4.3.1.cmml"><mo stretchy="false" id="S6.SS1.SSS4.p5.5.m5.3.4.3.2.1" xref="S6.SS1.SSS4.p5.5.m5.3.4.3.1.cmml">{</mo><mtext id="S6.SS1.SSS4.p5.5.m5.1.1" xref="S6.SS1.SSS4.p5.5.m5.1.1a.cmml">city</mtext><mo id="S6.SS1.SSS4.p5.5.m5.3.4.3.2.2" xref="S6.SS1.SSS4.p5.5.m5.3.4.3.1.cmml">,</mo><mtext id="S6.SS1.SSS4.p5.5.m5.2.2" xref="S6.SS1.SSS4.p5.5.m5.2.2a.cmml">suburban</mtext><mo id="S6.SS1.SSS4.p5.5.m5.3.4.3.2.3" xref="S6.SS1.SSS4.p5.5.m5.3.4.3.1.cmml">,</mo><mtext id="S6.SS1.SSS4.p5.5.m5.3.3" xref="S6.SS1.SSS4.p5.5.m5.3.3a.cmml">rural</mtext><mo stretchy="false" id="S6.SS1.SSS4.p5.5.m5.3.4.3.2.4" xref="S6.SS1.SSS4.p5.5.m5.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p5.5.m5.3b"><apply id="S6.SS1.SSS4.p5.5.m5.3.4.cmml" xref="S6.SS1.SSS4.p5.5.m5.3.4"><in id="S6.SS1.SSS4.p5.5.m5.3.4.1.cmml" xref="S6.SS1.SSS4.p5.5.m5.3.4.1"></in><ci id="S6.SS1.SSS4.p5.5.m5.3.4.2.cmml" xref="S6.SS1.SSS4.p5.5.m5.3.4.2">𝑠</ci><set id="S6.SS1.SSS4.p5.5.m5.3.4.3.1.cmml" xref="S6.SS1.SSS4.p5.5.m5.3.4.3.2"><ci id="S6.SS1.SSS4.p5.5.m5.1.1a.cmml" xref="S6.SS1.SSS4.p5.5.m5.1.1"><mtext id="S6.SS1.SSS4.p5.5.m5.1.1.cmml" xref="S6.SS1.SSS4.p5.5.m5.1.1">city</mtext></ci><ci id="S6.SS1.SSS4.p5.5.m5.2.2a.cmml" xref="S6.SS1.SSS4.p5.5.m5.2.2"><mtext id="S6.SS1.SSS4.p5.5.m5.2.2.cmml" xref="S6.SS1.SSS4.p5.5.m5.2.2">suburban</mtext></ci><ci id="S6.SS1.SSS4.p5.5.m5.3.3a.cmml" xref="S6.SS1.SSS4.p5.5.m5.3.3"><mtext id="S6.SS1.SSS4.p5.5.m5.3.3.cmml" xref="S6.SS1.SSS4.p5.5.m5.3.3">rural</mtext></ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p5.5.m5.3c">s\in\{\text{city},\text{suburban},\text{rural}\}</annotation></semantics></math>. We then get KDE estimates</p>
<table id="S6.EGx14" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S6.Ex45"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S6.Ex45.m1.2" class="ltx_Math" alttext="\displaystyle\tilde{p}_{f}(F)=\frac{1}{3m}\sum_{s}\sum_{j=1}^{m}K_{H}(F-\varphi(v_{j}^{s}))" display="inline"><semantics id="S6.Ex45.m1.2a"><mrow id="S6.Ex45.m1.2.2" xref="S6.Ex45.m1.2.2.cmml"><mrow id="S6.Ex45.m1.2.2.3" xref="S6.Ex45.m1.2.2.3.cmml"><msub id="S6.Ex45.m1.2.2.3.2" xref="S6.Ex45.m1.2.2.3.2.cmml"><mover accent="true" id="S6.Ex45.m1.2.2.3.2.2" xref="S6.Ex45.m1.2.2.3.2.2.cmml"><mi id="S6.Ex45.m1.2.2.3.2.2.2" xref="S6.Ex45.m1.2.2.3.2.2.2.cmml">p</mi><mo id="S6.Ex45.m1.2.2.3.2.2.1" xref="S6.Ex45.m1.2.2.3.2.2.1.cmml">~</mo></mover><mi id="S6.Ex45.m1.2.2.3.2.3" xref="S6.Ex45.m1.2.2.3.2.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S6.Ex45.m1.2.2.3.1" xref="S6.Ex45.m1.2.2.3.1.cmml">​</mo><mrow id="S6.Ex45.m1.2.2.3.3.2" xref="S6.Ex45.m1.2.2.3.cmml"><mo stretchy="false" id="S6.Ex45.m1.2.2.3.3.2.1" xref="S6.Ex45.m1.2.2.3.cmml">(</mo><mi id="S6.Ex45.m1.1.1" xref="S6.Ex45.m1.1.1.cmml">F</mi><mo stretchy="false" id="S6.Ex45.m1.2.2.3.3.2.2" xref="S6.Ex45.m1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S6.Ex45.m1.2.2.2" xref="S6.Ex45.m1.2.2.2.cmml">=</mo><mrow id="S6.Ex45.m1.2.2.1" xref="S6.Ex45.m1.2.2.1.cmml"><mstyle displaystyle="true" id="S6.Ex45.m1.2.2.1.3" xref="S6.Ex45.m1.2.2.1.3.cmml"><mfrac id="S6.Ex45.m1.2.2.1.3a" xref="S6.Ex45.m1.2.2.1.3.cmml"><mn id="S6.Ex45.m1.2.2.1.3.2" xref="S6.Ex45.m1.2.2.1.3.2.cmml">1</mn><mrow id="S6.Ex45.m1.2.2.1.3.3" xref="S6.Ex45.m1.2.2.1.3.3.cmml"><mn id="S6.Ex45.m1.2.2.1.3.3.2" xref="S6.Ex45.m1.2.2.1.3.3.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="S6.Ex45.m1.2.2.1.3.3.1" xref="S6.Ex45.m1.2.2.1.3.3.1.cmml">​</mo><mi id="S6.Ex45.m1.2.2.1.3.3.3" xref="S6.Ex45.m1.2.2.1.3.3.3.cmml">m</mi></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S6.Ex45.m1.2.2.1.2" xref="S6.Ex45.m1.2.2.1.2.cmml">​</mo><mrow id="S6.Ex45.m1.2.2.1.1" xref="S6.Ex45.m1.2.2.1.1.cmml"><mstyle displaystyle="true" id="S6.Ex45.m1.2.2.1.1.2" xref="S6.Ex45.m1.2.2.1.1.2.cmml"><munder id="S6.Ex45.m1.2.2.1.1.2a" xref="S6.Ex45.m1.2.2.1.1.2.cmml"><mo movablelimits="false" id="S6.Ex45.m1.2.2.1.1.2.2" xref="S6.Ex45.m1.2.2.1.1.2.2.cmml">∑</mo><mi id="S6.Ex45.m1.2.2.1.1.2.3" xref="S6.Ex45.m1.2.2.1.1.2.3.cmml">s</mi></munder></mstyle><mrow id="S6.Ex45.m1.2.2.1.1.1" xref="S6.Ex45.m1.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="S6.Ex45.m1.2.2.1.1.1.2" xref="S6.Ex45.m1.2.2.1.1.1.2.cmml"><munderover id="S6.Ex45.m1.2.2.1.1.1.2a" xref="S6.Ex45.m1.2.2.1.1.1.2.cmml"><mo movablelimits="false" id="S6.Ex45.m1.2.2.1.1.1.2.2.2" xref="S6.Ex45.m1.2.2.1.1.1.2.2.2.cmml">∑</mo><mrow id="S6.Ex45.m1.2.2.1.1.1.2.2.3" xref="S6.Ex45.m1.2.2.1.1.1.2.2.3.cmml"><mi id="S6.Ex45.m1.2.2.1.1.1.2.2.3.2" xref="S6.Ex45.m1.2.2.1.1.1.2.2.3.2.cmml">j</mi><mo id="S6.Ex45.m1.2.2.1.1.1.2.2.3.1" xref="S6.Ex45.m1.2.2.1.1.1.2.2.3.1.cmml">=</mo><mn id="S6.Ex45.m1.2.2.1.1.1.2.2.3.3" xref="S6.Ex45.m1.2.2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S6.Ex45.m1.2.2.1.1.1.2.3" xref="S6.Ex45.m1.2.2.1.1.1.2.3.cmml">m</mi></munderover></mstyle><mrow id="S6.Ex45.m1.2.2.1.1.1.1" xref="S6.Ex45.m1.2.2.1.1.1.1.cmml"><msub id="S6.Ex45.m1.2.2.1.1.1.1.3" xref="S6.Ex45.m1.2.2.1.1.1.1.3.cmml"><mi id="S6.Ex45.m1.2.2.1.1.1.1.3.2" xref="S6.Ex45.m1.2.2.1.1.1.1.3.2.cmml">K</mi><mi id="S6.Ex45.m1.2.2.1.1.1.1.3.3" xref="S6.Ex45.m1.2.2.1.1.1.1.3.3.cmml">H</mi></msub><mo lspace="0em" rspace="0em" id="S6.Ex45.m1.2.2.1.1.1.1.2" xref="S6.Ex45.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S6.Ex45.m1.2.2.1.1.1.1.1.1" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.Ex45.m1.2.2.1.1.1.1.1.1.2" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.3" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.3.cmml">F</mi><mo id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.2" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">φ</mi><mo lspace="0em" rspace="0em" id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">v</mi><mi id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi><mi id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msubsup><mo stretchy="false" id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S6.Ex45.m1.2.2.1.1.1.1.1.1.3" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex45.m1.2b"><apply id="S6.Ex45.m1.2.2.cmml" xref="S6.Ex45.m1.2.2"><eq id="S6.Ex45.m1.2.2.2.cmml" xref="S6.Ex45.m1.2.2.2"></eq><apply id="S6.Ex45.m1.2.2.3.cmml" xref="S6.Ex45.m1.2.2.3"><times id="S6.Ex45.m1.2.2.3.1.cmml" xref="S6.Ex45.m1.2.2.3.1"></times><apply id="S6.Ex45.m1.2.2.3.2.cmml" xref="S6.Ex45.m1.2.2.3.2"><csymbol cd="ambiguous" id="S6.Ex45.m1.2.2.3.2.1.cmml" xref="S6.Ex45.m1.2.2.3.2">subscript</csymbol><apply id="S6.Ex45.m1.2.2.3.2.2.cmml" xref="S6.Ex45.m1.2.2.3.2.2"><ci id="S6.Ex45.m1.2.2.3.2.2.1.cmml" xref="S6.Ex45.m1.2.2.3.2.2.1">~</ci><ci id="S6.Ex45.m1.2.2.3.2.2.2.cmml" xref="S6.Ex45.m1.2.2.3.2.2.2">𝑝</ci></apply><ci id="S6.Ex45.m1.2.2.3.2.3.cmml" xref="S6.Ex45.m1.2.2.3.2.3">𝑓</ci></apply><ci id="S6.Ex45.m1.1.1.cmml" xref="S6.Ex45.m1.1.1">𝐹</ci></apply><apply id="S6.Ex45.m1.2.2.1.cmml" xref="S6.Ex45.m1.2.2.1"><times id="S6.Ex45.m1.2.2.1.2.cmml" xref="S6.Ex45.m1.2.2.1.2"></times><apply id="S6.Ex45.m1.2.2.1.3.cmml" xref="S6.Ex45.m1.2.2.1.3"><divide id="S6.Ex45.m1.2.2.1.3.1.cmml" xref="S6.Ex45.m1.2.2.1.3"></divide><cn type="integer" id="S6.Ex45.m1.2.2.1.3.2.cmml" xref="S6.Ex45.m1.2.2.1.3.2">1</cn><apply id="S6.Ex45.m1.2.2.1.3.3.cmml" xref="S6.Ex45.m1.2.2.1.3.3"><times id="S6.Ex45.m1.2.2.1.3.3.1.cmml" xref="S6.Ex45.m1.2.2.1.3.3.1"></times><cn type="integer" id="S6.Ex45.m1.2.2.1.3.3.2.cmml" xref="S6.Ex45.m1.2.2.1.3.3.2">3</cn><ci id="S6.Ex45.m1.2.2.1.3.3.3.cmml" xref="S6.Ex45.m1.2.2.1.3.3.3">𝑚</ci></apply></apply><apply id="S6.Ex45.m1.2.2.1.1.cmml" xref="S6.Ex45.m1.2.2.1.1"><apply id="S6.Ex45.m1.2.2.1.1.2.cmml" xref="S6.Ex45.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S6.Ex45.m1.2.2.1.1.2.1.cmml" xref="S6.Ex45.m1.2.2.1.1.2">subscript</csymbol><sum id="S6.Ex45.m1.2.2.1.1.2.2.cmml" xref="S6.Ex45.m1.2.2.1.1.2.2"></sum><ci id="S6.Ex45.m1.2.2.1.1.2.3.cmml" xref="S6.Ex45.m1.2.2.1.1.2.3">𝑠</ci></apply><apply id="S6.Ex45.m1.2.2.1.1.1.cmml" xref="S6.Ex45.m1.2.2.1.1.1"><apply id="S6.Ex45.m1.2.2.1.1.1.2.cmml" xref="S6.Ex45.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S6.Ex45.m1.2.2.1.1.1.2.1.cmml" xref="S6.Ex45.m1.2.2.1.1.1.2">superscript</csymbol><apply id="S6.Ex45.m1.2.2.1.1.1.2.2.cmml" xref="S6.Ex45.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S6.Ex45.m1.2.2.1.1.1.2.2.1.cmml" xref="S6.Ex45.m1.2.2.1.1.1.2">subscript</csymbol><sum id="S6.Ex45.m1.2.2.1.1.1.2.2.2.cmml" xref="S6.Ex45.m1.2.2.1.1.1.2.2.2"></sum><apply id="S6.Ex45.m1.2.2.1.1.1.2.2.3.cmml" xref="S6.Ex45.m1.2.2.1.1.1.2.2.3"><eq id="S6.Ex45.m1.2.2.1.1.1.2.2.3.1.cmml" xref="S6.Ex45.m1.2.2.1.1.1.2.2.3.1"></eq><ci id="S6.Ex45.m1.2.2.1.1.1.2.2.3.2.cmml" xref="S6.Ex45.m1.2.2.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S6.Ex45.m1.2.2.1.1.1.2.2.3.3.cmml" xref="S6.Ex45.m1.2.2.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S6.Ex45.m1.2.2.1.1.1.2.3.cmml" xref="S6.Ex45.m1.2.2.1.1.1.2.3">𝑚</ci></apply><apply id="S6.Ex45.m1.2.2.1.1.1.1.cmml" xref="S6.Ex45.m1.2.2.1.1.1.1"><times id="S6.Ex45.m1.2.2.1.1.1.1.2.cmml" xref="S6.Ex45.m1.2.2.1.1.1.1.2"></times><apply id="S6.Ex45.m1.2.2.1.1.1.1.3.cmml" xref="S6.Ex45.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.Ex45.m1.2.2.1.1.1.1.3.1.cmml" xref="S6.Ex45.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S6.Ex45.m1.2.2.1.1.1.1.3.2.cmml" xref="S6.Ex45.m1.2.2.1.1.1.1.3.2">𝐾</ci><ci id="S6.Ex45.m1.2.2.1.1.1.1.3.3.cmml" xref="S6.Ex45.m1.2.2.1.1.1.1.3.3">𝐻</ci></apply><apply id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1"><minus id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.2"></minus><ci id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.3">𝐹</ci><apply id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1"><times id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.2"></times><ci id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.3">𝜑</ci><apply id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑣</ci><ci id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.Ex45.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex45.m1.2c">\displaystyle\tilde{p}_{f}(F)=\frac{1}{3m}\sum_{s}\sum_{j=1}^{m}K_{H}(F-\varphi(v_{j}^{s}))</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S6.Ex45.m2.2" class="ltx_Math" alttext="\displaystyle\tilde{q}_{f}(F)=\frac{1}{l}\sum_{j=1}^{l}K_{H}(F-\varphi(v_{j}))" display="inline"><semantics id="S6.Ex45.m2.2a"><mrow id="S6.Ex45.m2.2.2" xref="S6.Ex45.m2.2.2.cmml"><mrow id="S6.Ex45.m2.2.2.3" xref="S6.Ex45.m2.2.2.3.cmml"><msub id="S6.Ex45.m2.2.2.3.2" xref="S6.Ex45.m2.2.2.3.2.cmml"><mover accent="true" id="S6.Ex45.m2.2.2.3.2.2" xref="S6.Ex45.m2.2.2.3.2.2.cmml"><mi id="S6.Ex45.m2.2.2.3.2.2.2" xref="S6.Ex45.m2.2.2.3.2.2.2.cmml">q</mi><mo id="S6.Ex45.m2.2.2.3.2.2.1" xref="S6.Ex45.m2.2.2.3.2.2.1.cmml">~</mo></mover><mi id="S6.Ex45.m2.2.2.3.2.3" xref="S6.Ex45.m2.2.2.3.2.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S6.Ex45.m2.2.2.3.1" xref="S6.Ex45.m2.2.2.3.1.cmml">​</mo><mrow id="S6.Ex45.m2.2.2.3.3.2" xref="S6.Ex45.m2.2.2.3.cmml"><mo stretchy="false" id="S6.Ex45.m2.2.2.3.3.2.1" xref="S6.Ex45.m2.2.2.3.cmml">(</mo><mi id="S6.Ex45.m2.1.1" xref="S6.Ex45.m2.1.1.cmml">F</mi><mo stretchy="false" id="S6.Ex45.m2.2.2.3.3.2.2" xref="S6.Ex45.m2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S6.Ex45.m2.2.2.2" xref="S6.Ex45.m2.2.2.2.cmml">=</mo><mrow id="S6.Ex45.m2.2.2.1" xref="S6.Ex45.m2.2.2.1.cmml"><mstyle displaystyle="true" id="S6.Ex45.m2.2.2.1.3" xref="S6.Ex45.m2.2.2.1.3.cmml"><mfrac id="S6.Ex45.m2.2.2.1.3a" xref="S6.Ex45.m2.2.2.1.3.cmml"><mn id="S6.Ex45.m2.2.2.1.3.2" xref="S6.Ex45.m2.2.2.1.3.2.cmml">1</mn><mi id="S6.Ex45.m2.2.2.1.3.3" xref="S6.Ex45.m2.2.2.1.3.3.cmml">l</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S6.Ex45.m2.2.2.1.2" xref="S6.Ex45.m2.2.2.1.2.cmml">​</mo><mrow id="S6.Ex45.m2.2.2.1.1" xref="S6.Ex45.m2.2.2.1.1.cmml"><mstyle displaystyle="true" id="S6.Ex45.m2.2.2.1.1.2" xref="S6.Ex45.m2.2.2.1.1.2.cmml"><munderover id="S6.Ex45.m2.2.2.1.1.2a" xref="S6.Ex45.m2.2.2.1.1.2.cmml"><mo movablelimits="false" id="S6.Ex45.m2.2.2.1.1.2.2.2" xref="S6.Ex45.m2.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="S6.Ex45.m2.2.2.1.1.2.2.3" xref="S6.Ex45.m2.2.2.1.1.2.2.3.cmml"><mi id="S6.Ex45.m2.2.2.1.1.2.2.3.2" xref="S6.Ex45.m2.2.2.1.1.2.2.3.2.cmml">j</mi><mo id="S6.Ex45.m2.2.2.1.1.2.2.3.1" xref="S6.Ex45.m2.2.2.1.1.2.2.3.1.cmml">=</mo><mn id="S6.Ex45.m2.2.2.1.1.2.2.3.3" xref="S6.Ex45.m2.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S6.Ex45.m2.2.2.1.1.2.3" xref="S6.Ex45.m2.2.2.1.1.2.3.cmml">l</mi></munderover></mstyle><mrow id="S6.Ex45.m2.2.2.1.1.1" xref="S6.Ex45.m2.2.2.1.1.1.cmml"><msub id="S6.Ex45.m2.2.2.1.1.1.3" xref="S6.Ex45.m2.2.2.1.1.1.3.cmml"><mi id="S6.Ex45.m2.2.2.1.1.1.3.2" xref="S6.Ex45.m2.2.2.1.1.1.3.2.cmml">K</mi><mi id="S6.Ex45.m2.2.2.1.1.1.3.3" xref="S6.Ex45.m2.2.2.1.1.1.3.3.cmml">H</mi></msub><mo lspace="0em" rspace="0em" id="S6.Ex45.m2.2.2.1.1.1.2" xref="S6.Ex45.m2.2.2.1.1.1.2.cmml">​</mo><mrow id="S6.Ex45.m2.2.2.1.1.1.1.1" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.Ex45.m2.2.2.1.1.1.1.1.2" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.Ex45.m2.2.2.1.1.1.1.1.1" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S6.Ex45.m2.2.2.1.1.1.1.1.1.3" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.3.cmml">F</mi><mo id="S6.Ex45.m2.2.2.1.1.1.1.1.1.2" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S6.Ex45.m2.2.2.1.1.1.1.1.1.1" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.3" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.3.cmml">φ</mi><mo lspace="0em" rspace="0em" id="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.2" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.1.1" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.1.1.2" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.1.1.1" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.1.1.3" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S6.Ex45.m2.2.2.1.1.1.1.1.3" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex45.m2.2b"><apply id="S6.Ex45.m2.2.2.cmml" xref="S6.Ex45.m2.2.2"><eq id="S6.Ex45.m2.2.2.2.cmml" xref="S6.Ex45.m2.2.2.2"></eq><apply id="S6.Ex45.m2.2.2.3.cmml" xref="S6.Ex45.m2.2.2.3"><times id="S6.Ex45.m2.2.2.3.1.cmml" xref="S6.Ex45.m2.2.2.3.1"></times><apply id="S6.Ex45.m2.2.2.3.2.cmml" xref="S6.Ex45.m2.2.2.3.2"><csymbol cd="ambiguous" id="S6.Ex45.m2.2.2.3.2.1.cmml" xref="S6.Ex45.m2.2.2.3.2">subscript</csymbol><apply id="S6.Ex45.m2.2.2.3.2.2.cmml" xref="S6.Ex45.m2.2.2.3.2.2"><ci id="S6.Ex45.m2.2.2.3.2.2.1.cmml" xref="S6.Ex45.m2.2.2.3.2.2.1">~</ci><ci id="S6.Ex45.m2.2.2.3.2.2.2.cmml" xref="S6.Ex45.m2.2.2.3.2.2.2">𝑞</ci></apply><ci id="S6.Ex45.m2.2.2.3.2.3.cmml" xref="S6.Ex45.m2.2.2.3.2.3">𝑓</ci></apply><ci id="S6.Ex45.m2.1.1.cmml" xref="S6.Ex45.m2.1.1">𝐹</ci></apply><apply id="S6.Ex45.m2.2.2.1.cmml" xref="S6.Ex45.m2.2.2.1"><times id="S6.Ex45.m2.2.2.1.2.cmml" xref="S6.Ex45.m2.2.2.1.2"></times><apply id="S6.Ex45.m2.2.2.1.3.cmml" xref="S6.Ex45.m2.2.2.1.3"><divide id="S6.Ex45.m2.2.2.1.3.1.cmml" xref="S6.Ex45.m2.2.2.1.3"></divide><cn type="integer" id="S6.Ex45.m2.2.2.1.3.2.cmml" xref="S6.Ex45.m2.2.2.1.3.2">1</cn><ci id="S6.Ex45.m2.2.2.1.3.3.cmml" xref="S6.Ex45.m2.2.2.1.3.3">𝑙</ci></apply><apply id="S6.Ex45.m2.2.2.1.1.cmml" xref="S6.Ex45.m2.2.2.1.1"><apply id="S6.Ex45.m2.2.2.1.1.2.cmml" xref="S6.Ex45.m2.2.2.1.1.2"><csymbol cd="ambiguous" id="S6.Ex45.m2.2.2.1.1.2.1.cmml" xref="S6.Ex45.m2.2.2.1.1.2">superscript</csymbol><apply id="S6.Ex45.m2.2.2.1.1.2.2.cmml" xref="S6.Ex45.m2.2.2.1.1.2"><csymbol cd="ambiguous" id="S6.Ex45.m2.2.2.1.1.2.2.1.cmml" xref="S6.Ex45.m2.2.2.1.1.2">subscript</csymbol><sum id="S6.Ex45.m2.2.2.1.1.2.2.2.cmml" xref="S6.Ex45.m2.2.2.1.1.2.2.2"></sum><apply id="S6.Ex45.m2.2.2.1.1.2.2.3.cmml" xref="S6.Ex45.m2.2.2.1.1.2.2.3"><eq id="S6.Ex45.m2.2.2.1.1.2.2.3.1.cmml" xref="S6.Ex45.m2.2.2.1.1.2.2.3.1"></eq><ci id="S6.Ex45.m2.2.2.1.1.2.2.3.2.cmml" xref="S6.Ex45.m2.2.2.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S6.Ex45.m2.2.2.1.1.2.2.3.3.cmml" xref="S6.Ex45.m2.2.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S6.Ex45.m2.2.2.1.1.2.3.cmml" xref="S6.Ex45.m2.2.2.1.1.2.3">𝑙</ci></apply><apply id="S6.Ex45.m2.2.2.1.1.1.cmml" xref="S6.Ex45.m2.2.2.1.1.1"><times id="S6.Ex45.m2.2.2.1.1.1.2.cmml" xref="S6.Ex45.m2.2.2.1.1.1.2"></times><apply id="S6.Ex45.m2.2.2.1.1.1.3.cmml" xref="S6.Ex45.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S6.Ex45.m2.2.2.1.1.1.3.1.cmml" xref="S6.Ex45.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S6.Ex45.m2.2.2.1.1.1.3.2.cmml" xref="S6.Ex45.m2.2.2.1.1.1.3.2">𝐾</ci><ci id="S6.Ex45.m2.2.2.1.1.1.3.3.cmml" xref="S6.Ex45.m2.2.2.1.1.1.3.3">𝐻</ci></apply><apply id="S6.Ex45.m2.2.2.1.1.1.1.1.1.cmml" xref="S6.Ex45.m2.2.2.1.1.1.1.1"><minus id="S6.Ex45.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.2"></minus><ci id="S6.Ex45.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.3">𝐹</ci><apply id="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.1"><times id="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.2"></times><ci id="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.3">𝜑</ci><apply id="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.Ex45.m2.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex45.m2.2c">\displaystyle\tilde{q}_{f}(F)=\frac{1}{l}\sum_{j=1}^{l}K_{H}(F-\varphi(v_{j}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S6.SS1.SSS4.p5.10" class="ltx_p">The gradient of the loss for a single structure generation model is given by</p>
<table id="S6.EGx15" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S6.Ex46"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S6.Ex46.m1.3" class="ltx_Math" alttext="\displaystyle\nabla_{\theta}\mathcal{L}^{s}\approx 10^{-2}\bigg{(}\frac{1}{M}\sum_{j=1}^{m}(\ln\tilde{q}_{f}(\varphi(v_{j}^{s}))-\ln\tilde{p}_{f}(\varphi(v_{j}^{s})))\nabla_{\theta}\log q_{I}(v_{j}^{s})+\mathbf{1}_{(1,\infty)}(r_{\text{reject}}^{s})\bigg{)}" display="inline"><semantics id="S6.Ex46.m1.3a"><mrow id="S6.Ex46.m1.3.3" xref="S6.Ex46.m1.3.3.cmml"><mrow id="S6.Ex46.m1.3.3.3" xref="S6.Ex46.m1.3.3.3.cmml"><msub id="S6.Ex46.m1.3.3.3.1" xref="S6.Ex46.m1.3.3.3.1.cmml"><mo id="S6.Ex46.m1.3.3.3.1.2" xref="S6.Ex46.m1.3.3.3.1.2.cmml">∇</mo><mi id="S6.Ex46.m1.3.3.3.1.3" xref="S6.Ex46.m1.3.3.3.1.3.cmml">θ</mi></msub><msup id="S6.Ex46.m1.3.3.3.2" xref="S6.Ex46.m1.3.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.Ex46.m1.3.3.3.2.2" xref="S6.Ex46.m1.3.3.3.2.2.cmml">ℒ</mi><mi id="S6.Ex46.m1.3.3.3.2.3" xref="S6.Ex46.m1.3.3.3.2.3.cmml">s</mi></msup></mrow><mo id="S6.Ex46.m1.3.3.2" xref="S6.Ex46.m1.3.3.2.cmml">≈</mo><mrow id="S6.Ex46.m1.3.3.1" xref="S6.Ex46.m1.3.3.1.cmml"><msup id="S6.Ex46.m1.3.3.1.3" xref="S6.Ex46.m1.3.3.1.3.cmml"><mn id="S6.Ex46.m1.3.3.1.3.2" xref="S6.Ex46.m1.3.3.1.3.2.cmml">10</mn><mrow id="S6.Ex46.m1.3.3.1.3.3" xref="S6.Ex46.m1.3.3.1.3.3.cmml"><mo id="S6.Ex46.m1.3.3.1.3.3a" xref="S6.Ex46.m1.3.3.1.3.3.cmml">−</mo><mn id="S6.Ex46.m1.3.3.1.3.3.2" xref="S6.Ex46.m1.3.3.1.3.3.2.cmml">2</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S6.Ex46.m1.3.3.1.2" xref="S6.Ex46.m1.3.3.1.2.cmml">​</mo><mrow id="S6.Ex46.m1.3.3.1.1.1" xref="S6.Ex46.m1.3.3.1.1.1.1.cmml"><mo maxsize="210%" minsize="210%" id="S6.Ex46.m1.3.3.1.1.1.2" xref="S6.Ex46.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S6.Ex46.m1.3.3.1.1.1.1" xref="S6.Ex46.m1.3.3.1.1.1.1.cmml"><mrow id="S6.Ex46.m1.3.3.1.1.1.1.2" xref="S6.Ex46.m1.3.3.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S6.Ex46.m1.3.3.1.1.1.1.2.4" xref="S6.Ex46.m1.3.3.1.1.1.1.2.4.cmml"><mfrac id="S6.Ex46.m1.3.3.1.1.1.1.2.4a" xref="S6.Ex46.m1.3.3.1.1.1.1.2.4.cmml"><mn id="S6.Ex46.m1.3.3.1.1.1.1.2.4.2" xref="S6.Ex46.m1.3.3.1.1.1.1.2.4.2.cmml">1</mn><mi id="S6.Ex46.m1.3.3.1.1.1.1.2.4.3" xref="S6.Ex46.m1.3.3.1.1.1.1.2.4.3.cmml">M</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S6.Ex46.m1.3.3.1.1.1.1.2.3" xref="S6.Ex46.m1.3.3.1.1.1.1.2.3.cmml">​</mo><mrow id="S6.Ex46.m1.3.3.1.1.1.1.2.2" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.cmml"><mstyle displaystyle="true" id="S6.Ex46.m1.3.3.1.1.1.1.2.2.3" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.cmml"><munderover id="S6.Ex46.m1.3.3.1.1.1.1.2.2.3a" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.cmml"><mo movablelimits="false" id="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.2" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.3" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.3.cmml"><mi id="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.3.2" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.3.2.cmml">j</mi><mo id="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.3.1" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.3.3" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.3" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.3.cmml">m</mi></munderover></mstyle><mrow id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.cmml"><mrow id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">ln</mi><mo lspace="0.167em" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3a" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mover accent="true" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.2" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">q</mi><mo id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.1" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml">~</mo></mover><mi id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">f</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">φ</mi><mo lspace="0em" rspace="0em" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">v</mi><mi id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi><mi id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msubsup><mo stretchy="false" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">ln</mi><mo lspace="0.167em" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3a" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml">⁡</mo><msub id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml"><mover accent="true" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml"><mi id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2.2" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2.2.cmml">p</mi><mo id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2.1" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2.1.cmml">~</mo></mover><mi id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.3" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml">f</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml">​</mo><mrow id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.2" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml">φ</mi><mo lspace="0em" rspace="0em" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">​</mo><mrow id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.2" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><msubsup id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.2" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml">v</mi><mi id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.3" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml">j</mi><mi id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml">s</mi></msubsup><mo stretchy="false" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.3" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.3" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.3" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.3.cmml">​</mo><mrow id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.cmml"><mrow id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1.cmml"><msub id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1.1" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1.1.cmml"><mo rspace="0.167em" id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1.1.2" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1.1.2.cmml">∇</mo><mi id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1.1.3" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1.1.3.cmml">θ</mi></msub><mi id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1.2" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4a" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.cmml">⁡</mo><msub id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.2" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.2.cmml"><mi id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.2.2" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.2.2.cmml">q</mi><mi id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.2.3" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.2.3.cmml">I</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.3a" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.3.cmml">​</mo><mrow id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.2" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1.cmml">(</mo><msubsup id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1.cmml"><mi id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1.2.2" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1.2.2.cmml">v</mi><mi id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1.2.3" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1.2.3.cmml">j</mi><mi id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1.3" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1.3.cmml">s</mi></msubsup><mo stretchy="false" id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.3" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S6.Ex46.m1.3.3.1.1.1.1.4" xref="S6.Ex46.m1.3.3.1.1.1.1.4.cmml">+</mo><mrow id="S6.Ex46.m1.3.3.1.1.1.1.3" xref="S6.Ex46.m1.3.3.1.1.1.1.3.cmml"><msub id="S6.Ex46.m1.3.3.1.1.1.1.3.3" xref="S6.Ex46.m1.3.3.1.1.1.1.3.3.cmml"><mn id="S6.Ex46.m1.3.3.1.1.1.1.3.3.2" xref="S6.Ex46.m1.3.3.1.1.1.1.3.3.2.cmml">𝟏</mn><mrow id="S6.Ex46.m1.2.2.2.4" xref="S6.Ex46.m1.2.2.2.3.cmml"><mo stretchy="false" id="S6.Ex46.m1.2.2.2.4.1" xref="S6.Ex46.m1.2.2.2.3.cmml">(</mo><mn id="S6.Ex46.m1.1.1.1.1" xref="S6.Ex46.m1.1.1.1.1.cmml">1</mn><mo id="S6.Ex46.m1.2.2.2.4.2" xref="S6.Ex46.m1.2.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S6.Ex46.m1.2.2.2.2" xref="S6.Ex46.m1.2.2.2.2.cmml">∞</mi><mo stretchy="false" id="S6.Ex46.m1.2.2.2.4.3" xref="S6.Ex46.m1.2.2.2.3.cmml">)</mo></mrow></msub><mo lspace="0em" rspace="0em" id="S6.Ex46.m1.3.3.1.1.1.1.3.2" xref="S6.Ex46.m1.3.3.1.1.1.1.3.2.cmml">​</mo><mrow id="S6.Ex46.m1.3.3.1.1.1.1.3.1.1" xref="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.cmml"><mo stretchy="false" id="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.2" xref="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.cmml">(</mo><msubsup id="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1" xref="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.cmml"><mi id="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.2.2" xref="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.2.2.cmml">r</mi><mtext id="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.2.3" xref="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.2.3a.cmml">reject</mtext><mi id="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.3" xref="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.3.cmml">s</mi></msubsup><mo stretchy="false" id="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.3" xref="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo maxsize="210%" minsize="210%" id="S6.Ex46.m1.3.3.1.1.1.3" xref="S6.Ex46.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex46.m1.3b"><apply id="S6.Ex46.m1.3.3.cmml" xref="S6.Ex46.m1.3.3"><approx id="S6.Ex46.m1.3.3.2.cmml" xref="S6.Ex46.m1.3.3.2"></approx><apply id="S6.Ex46.m1.3.3.3.cmml" xref="S6.Ex46.m1.3.3.3"><apply id="S6.Ex46.m1.3.3.3.1.cmml" xref="S6.Ex46.m1.3.3.3.1"><csymbol cd="ambiguous" id="S6.Ex46.m1.3.3.3.1.1.cmml" xref="S6.Ex46.m1.3.3.3.1">subscript</csymbol><ci id="S6.Ex46.m1.3.3.3.1.2.cmml" xref="S6.Ex46.m1.3.3.3.1.2">∇</ci><ci id="S6.Ex46.m1.3.3.3.1.3.cmml" xref="S6.Ex46.m1.3.3.3.1.3">𝜃</ci></apply><apply id="S6.Ex46.m1.3.3.3.2.cmml" xref="S6.Ex46.m1.3.3.3.2"><csymbol cd="ambiguous" id="S6.Ex46.m1.3.3.3.2.1.cmml" xref="S6.Ex46.m1.3.3.3.2">superscript</csymbol><ci id="S6.Ex46.m1.3.3.3.2.2.cmml" xref="S6.Ex46.m1.3.3.3.2.2">ℒ</ci><ci id="S6.Ex46.m1.3.3.3.2.3.cmml" xref="S6.Ex46.m1.3.3.3.2.3">𝑠</ci></apply></apply><apply id="S6.Ex46.m1.3.3.1.cmml" xref="S6.Ex46.m1.3.3.1"><times id="S6.Ex46.m1.3.3.1.2.cmml" xref="S6.Ex46.m1.3.3.1.2"></times><apply id="S6.Ex46.m1.3.3.1.3.cmml" xref="S6.Ex46.m1.3.3.1.3"><csymbol cd="ambiguous" id="S6.Ex46.m1.3.3.1.3.1.cmml" xref="S6.Ex46.m1.3.3.1.3">superscript</csymbol><cn type="integer" id="S6.Ex46.m1.3.3.1.3.2.cmml" xref="S6.Ex46.m1.3.3.1.3.2">10</cn><apply id="S6.Ex46.m1.3.3.1.3.3.cmml" xref="S6.Ex46.m1.3.3.1.3.3"><minus id="S6.Ex46.m1.3.3.1.3.3.1.cmml" xref="S6.Ex46.m1.3.3.1.3.3"></minus><cn type="integer" id="S6.Ex46.m1.3.3.1.3.3.2.cmml" xref="S6.Ex46.m1.3.3.1.3.3.2">2</cn></apply></apply><apply id="S6.Ex46.m1.3.3.1.1.1.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1"><plus id="S6.Ex46.m1.3.3.1.1.1.1.4.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.4"></plus><apply id="S6.Ex46.m1.3.3.1.1.1.1.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2"><times id="S6.Ex46.m1.3.3.1.1.1.1.2.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.3"></times><apply id="S6.Ex46.m1.3.3.1.1.1.1.2.4.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.4"><divide id="S6.Ex46.m1.3.3.1.1.1.1.2.4.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.4"></divide><cn type="integer" id="S6.Ex46.m1.3.3.1.1.1.1.2.4.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.4.2">1</cn><ci id="S6.Ex46.m1.3.3.1.1.1.1.2.4.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.4.3">𝑀</ci></apply><apply id="S6.Ex46.m1.3.3.1.1.1.1.2.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2"><apply id="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.3">superscript</csymbol><apply id="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.3">subscript</csymbol><sum id="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.2"></sum><apply id="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.3"><eq id="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.3.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.3.1"></eq><ci id="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.3.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.3.2">𝑗</ci><cn type="integer" id="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.3.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.2.3.3">1</cn></apply></apply><ci id="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.3.3">𝑚</ci></apply><apply id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2"><times id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.3"></times><apply id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1"><minus id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.3"></minus><apply id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><times id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3"><ln id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1"></ln><apply id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><apply id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2"><ci id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.1">~</ci><ci id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.2">𝑞</ci></apply><ci id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑓</ci></apply></apply><apply id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝜑</ci><apply id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑣</ci><ci id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply><apply id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2"><times id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2"></times><apply id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3"><ln id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.1"></ln><apply id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2">subscript</csymbol><apply id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2"><ci id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2.1">~</ci><ci id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2.2">𝑝</ci></apply><ci id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.3">𝑓</ci></apply></apply><apply id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1"><times id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2"></times><ci id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3">𝜑</ci><apply id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1">superscript</csymbol><apply id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1">subscript</csymbol><ci id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.2">𝑣</ci><ci id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply></apply><apply id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4"><apply id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1"><apply id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1.1"><csymbol cd="ambiguous" id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1.1.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1.1">subscript</csymbol><ci id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1.1.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1.1.2">∇</ci><ci id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1.1.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1.1.3">𝜃</ci></apply><log id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.1.2"></log></apply><apply id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.2"><csymbol cd="ambiguous" id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.2.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.2">subscript</csymbol><ci id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.2.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.2.2">𝑞</ci><ci id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.2.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.4.2.3">𝐼</ci></apply></apply><apply id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1"><csymbol cd="ambiguous" id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1">superscript</csymbol><apply id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1"><csymbol cd="ambiguous" id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1.2.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1">subscript</csymbol><ci id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1.2.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1.2.2">𝑣</ci><ci id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1.2.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1.2.3">𝑗</ci></apply><ci id="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.2.2.2.2.1.1.3">𝑠</ci></apply></apply></apply></apply><apply id="S6.Ex46.m1.3.3.1.1.1.1.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.3"><times id="S6.Ex46.m1.3.3.1.1.1.1.3.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.3.2"></times><apply id="S6.Ex46.m1.3.3.1.1.1.1.3.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S6.Ex46.m1.3.3.1.1.1.1.3.3.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.3.3">subscript</csymbol><cn type="integer" id="S6.Ex46.m1.3.3.1.1.1.1.3.3.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.3.3.2">1</cn><interval closure="open" id="S6.Ex46.m1.2.2.2.3.cmml" xref="S6.Ex46.m1.2.2.2.4"><cn type="integer" id="S6.Ex46.m1.1.1.1.1.cmml" xref="S6.Ex46.m1.1.1.1.1">1</cn><infinity id="S6.Ex46.m1.2.2.2.2.cmml" xref="S6.Ex46.m1.2.2.2.2"></infinity></interval></apply><apply id="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.3.1.1">superscript</csymbol><apply id="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.2.1.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.3.1.1">subscript</csymbol><ci id="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.2.2.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.2.2">𝑟</ci><ci id="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.2.3a.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.2.3"><mtext mathsize="70%" id="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.2.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.2.3">reject</mtext></ci></apply><ci id="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.3.cmml" xref="S6.Ex46.m1.3.3.1.1.1.1.3.1.1.1.3">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex46.m1.3c">\displaystyle\nabla_{\theta}\mathcal{L}^{s}\approx 10^{-2}\bigg{(}\frac{1}{M}\sum_{j=1}^{m}(\ln\tilde{q}_{f}(\varphi(v_{j}^{s}))-\ln\tilde{p}_{f}(\varphi(v_{j}^{s})))\nabla_{\theta}\log q_{I}(v_{j}^{s})+\mathbf{1}_{(1,\infty)}(r_{\text{reject}}^{s})\bigg{)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S6.SS1.SSS4.p5.9" class="ltx_p">so the densities are calculated using the whole generated set but only use images generated by that scenario for the REINFORCE sample. We use the ADAM optimizer with learning rate <math id="S6.SS1.SSS4.p5.6.m1.1" class="ltx_Math" alttext="\epsilon=10^{-4}" display="inline"><semantics id="S6.SS1.SSS4.p5.6.m1.1a"><mrow id="S6.SS1.SSS4.p5.6.m1.1.1" xref="S6.SS1.SSS4.p5.6.m1.1.1.cmml"><mi id="S6.SS1.SSS4.p5.6.m1.1.1.2" xref="S6.SS1.SSS4.p5.6.m1.1.1.2.cmml">ϵ</mi><mo id="S6.SS1.SSS4.p5.6.m1.1.1.1" xref="S6.SS1.SSS4.p5.6.m1.1.1.1.cmml">=</mo><msup id="S6.SS1.SSS4.p5.6.m1.1.1.3" xref="S6.SS1.SSS4.p5.6.m1.1.1.3.cmml"><mn id="S6.SS1.SSS4.p5.6.m1.1.1.3.2" xref="S6.SS1.SSS4.p5.6.m1.1.1.3.2.cmml">10</mn><mrow id="S6.SS1.SSS4.p5.6.m1.1.1.3.3" xref="S6.SS1.SSS4.p5.6.m1.1.1.3.3.cmml"><mo id="S6.SS1.SSS4.p5.6.m1.1.1.3.3a" xref="S6.SS1.SSS4.p5.6.m1.1.1.3.3.cmml">−</mo><mn id="S6.SS1.SSS4.p5.6.m1.1.1.3.3.2" xref="S6.SS1.SSS4.p5.6.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p5.6.m1.1b"><apply id="S6.SS1.SSS4.p5.6.m1.1.1.cmml" xref="S6.SS1.SSS4.p5.6.m1.1.1"><eq id="S6.SS1.SSS4.p5.6.m1.1.1.1.cmml" xref="S6.SS1.SSS4.p5.6.m1.1.1.1"></eq><ci id="S6.SS1.SSS4.p5.6.m1.1.1.2.cmml" xref="S6.SS1.SSS4.p5.6.m1.1.1.2">italic-ϵ</ci><apply id="S6.SS1.SSS4.p5.6.m1.1.1.3.cmml" xref="S6.SS1.SSS4.p5.6.m1.1.1.3"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p5.6.m1.1.1.3.1.cmml" xref="S6.SS1.SSS4.p5.6.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.SS1.SSS4.p5.6.m1.1.1.3.2.cmml" xref="S6.SS1.SSS4.p5.6.m1.1.1.3.2">10</cn><apply id="S6.SS1.SSS4.p5.6.m1.1.1.3.3.cmml" xref="S6.SS1.SSS4.p5.6.m1.1.1.3.3"><minus id="S6.SS1.SSS4.p5.6.m1.1.1.3.3.1.cmml" xref="S6.SS1.SSS4.p5.6.m1.1.1.3.3"></minus><cn type="integer" id="S6.SS1.SSS4.p5.6.m1.1.1.3.3.2.cmml" xref="S6.SS1.SSS4.p5.6.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p5.6.m1.1c">\epsilon=10^{-4}</annotation></semantics></math>, <math id="S6.SS1.SSS4.p5.7.m2.1" class="ltx_Math" alttext="\beta_{1}=0.9" display="inline"><semantics id="S6.SS1.SSS4.p5.7.m2.1a"><mrow id="S6.SS1.SSS4.p5.7.m2.1.1" xref="S6.SS1.SSS4.p5.7.m2.1.1.cmml"><msub id="S6.SS1.SSS4.p5.7.m2.1.1.2" xref="S6.SS1.SSS4.p5.7.m2.1.1.2.cmml"><mi id="S6.SS1.SSS4.p5.7.m2.1.1.2.2" xref="S6.SS1.SSS4.p5.7.m2.1.1.2.2.cmml">β</mi><mn id="S6.SS1.SSS4.p5.7.m2.1.1.2.3" xref="S6.SS1.SSS4.p5.7.m2.1.1.2.3.cmml">1</mn></msub><mo id="S6.SS1.SSS4.p5.7.m2.1.1.1" xref="S6.SS1.SSS4.p5.7.m2.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS4.p5.7.m2.1.1.3" xref="S6.SS1.SSS4.p5.7.m2.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p5.7.m2.1b"><apply id="S6.SS1.SSS4.p5.7.m2.1.1.cmml" xref="S6.SS1.SSS4.p5.7.m2.1.1"><eq id="S6.SS1.SSS4.p5.7.m2.1.1.1.cmml" xref="S6.SS1.SSS4.p5.7.m2.1.1.1"></eq><apply id="S6.SS1.SSS4.p5.7.m2.1.1.2.cmml" xref="S6.SS1.SSS4.p5.7.m2.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p5.7.m2.1.1.2.1.cmml" xref="S6.SS1.SSS4.p5.7.m2.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS4.p5.7.m2.1.1.2.2.cmml" xref="S6.SS1.SSS4.p5.7.m2.1.1.2.2">𝛽</ci><cn type="integer" id="S6.SS1.SSS4.p5.7.m2.1.1.2.3.cmml" xref="S6.SS1.SSS4.p5.7.m2.1.1.2.3">1</cn></apply><cn type="float" id="S6.SS1.SSS4.p5.7.m2.1.1.3.cmml" xref="S6.SS1.SSS4.p5.7.m2.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p5.7.m2.1c">\beta_{1}=0.9</annotation></semantics></math> and <math id="S6.SS1.SSS4.p5.8.m3.1" class="ltx_Math" alttext="\beta_{2}=0.999" display="inline"><semantics id="S6.SS1.SSS4.p5.8.m3.1a"><mrow id="S6.SS1.SSS4.p5.8.m3.1.1" xref="S6.SS1.SSS4.p5.8.m3.1.1.cmml"><msub id="S6.SS1.SSS4.p5.8.m3.1.1.2" xref="S6.SS1.SSS4.p5.8.m3.1.1.2.cmml"><mi id="S6.SS1.SSS4.p5.8.m3.1.1.2.2" xref="S6.SS1.SSS4.p5.8.m3.1.1.2.2.cmml">β</mi><mn id="S6.SS1.SSS4.p5.8.m3.1.1.2.3" xref="S6.SS1.SSS4.p5.8.m3.1.1.2.3.cmml">2</mn></msub><mo id="S6.SS1.SSS4.p5.8.m3.1.1.1" xref="S6.SS1.SSS4.p5.8.m3.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS4.p5.8.m3.1.1.3" xref="S6.SS1.SSS4.p5.8.m3.1.1.3.cmml">0.999</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p5.8.m3.1b"><apply id="S6.SS1.SSS4.p5.8.m3.1.1.cmml" xref="S6.SS1.SSS4.p5.8.m3.1.1"><eq id="S6.SS1.SSS4.p5.8.m3.1.1.1.cmml" xref="S6.SS1.SSS4.p5.8.m3.1.1.1"></eq><apply id="S6.SS1.SSS4.p5.8.m3.1.1.2.cmml" xref="S6.SS1.SSS4.p5.8.m3.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p5.8.m3.1.1.2.1.cmml" xref="S6.SS1.SSS4.p5.8.m3.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS4.p5.8.m3.1.1.2.2.cmml" xref="S6.SS1.SSS4.p5.8.m3.1.1.2.2">𝛽</ci><cn type="integer" id="S6.SS1.SSS4.p5.8.m3.1.1.2.3.cmml" xref="S6.SS1.SSS4.p5.8.m3.1.1.2.3">2</cn></apply><cn type="float" id="S6.SS1.SSS4.p5.8.m3.1.1.3.cmml" xref="S6.SS1.SSS4.p5.8.m3.1.1.3">0.999</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p5.8.m3.1c">\beta_{2}=0.999</annotation></semantics></math>. We train for 5 epochs and use a moving average baseline with <math id="S6.SS1.SSS4.p5.9.m4.1" class="ltx_Math" alttext="\alpha=0.05" display="inline"><semantics id="S6.SS1.SSS4.p5.9.m4.1a"><mrow id="S6.SS1.SSS4.p5.9.m4.1.1" xref="S6.SS1.SSS4.p5.9.m4.1.1.cmml"><mi id="S6.SS1.SSS4.p5.9.m4.1.1.2" xref="S6.SS1.SSS4.p5.9.m4.1.1.2.cmml">α</mi><mo id="S6.SS1.SSS4.p5.9.m4.1.1.1" xref="S6.SS1.SSS4.p5.9.m4.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS4.p5.9.m4.1.1.3" xref="S6.SS1.SSS4.p5.9.m4.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p5.9.m4.1b"><apply id="S6.SS1.SSS4.p5.9.m4.1.1.cmml" xref="S6.SS1.SSS4.p5.9.m4.1.1"><eq id="S6.SS1.SSS4.p5.9.m4.1.1.1.cmml" xref="S6.SS1.SSS4.p5.9.m4.1.1.1"></eq><ci id="S6.SS1.SSS4.p5.9.m4.1.1.2.cmml" xref="S6.SS1.SSS4.p5.9.m4.1.1.2">𝛼</ci><cn type="float" id="S6.SS1.SSS4.p5.9.m4.1.1.3.cmml" xref="S6.SS1.SSS4.p5.9.m4.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p5.9.m4.1c">\alpha=0.05</annotation></semantics></math> in order to reduce the variance of the REINFORCE estimator.</p>
</div>
<div id="S6.SS1.SSS4.p6" class="ltx_para ltx_noindent">
<p id="S6.SS1.SSS4.p6.1" class="ltx_p"><span id="S6.SS1.SSS4.p6.1.1" class="ltx_text ltx_font_bold">Mask-RCNN Training:</span> We train a Mask-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite><span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>Using code from: https://github.com/facebookresearch/maskrcnn-benchmark</span></span></span> network on a generated training set and then test on the KITTI validation set <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. In both the original and simple prior experiments we produce the generated image set by generating 10K samples for each experiment setting, with the scenario being chosen uniformly. For training, we render images with random saturation and contrast, which we observed to work better. Both the good prior and simple prior have 3 experiment settings which correspond to the rows of the Tab. 1 and 2. The training procedure for both experiments is the same.
<br class="ltx_break"></p>
</div>
<div id="S6.SS1.SSS4.p7" class="ltx_para ltx_noindent">
<p id="S6.SS1.SSS4.p7.5" class="ltx_p">First, we train on 10K samples from the probabilistic grammar. We use the ADAM optimizer with learning rate <math id="S6.SS1.SSS4.p7.1.m1.1" class="ltx_Math" alttext="\epsilon=10^{-3}" display="inline"><semantics id="S6.SS1.SSS4.p7.1.m1.1a"><mrow id="S6.SS1.SSS4.p7.1.m1.1.1" xref="S6.SS1.SSS4.p7.1.m1.1.1.cmml"><mi id="S6.SS1.SSS4.p7.1.m1.1.1.2" xref="S6.SS1.SSS4.p7.1.m1.1.1.2.cmml">ϵ</mi><mo id="S6.SS1.SSS4.p7.1.m1.1.1.1" xref="S6.SS1.SSS4.p7.1.m1.1.1.1.cmml">=</mo><msup id="S6.SS1.SSS4.p7.1.m1.1.1.3" xref="S6.SS1.SSS4.p7.1.m1.1.1.3.cmml"><mn id="S6.SS1.SSS4.p7.1.m1.1.1.3.2" xref="S6.SS1.SSS4.p7.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.SS1.SSS4.p7.1.m1.1.1.3.3" xref="S6.SS1.SSS4.p7.1.m1.1.1.3.3.cmml"><mo id="S6.SS1.SSS4.p7.1.m1.1.1.3.3a" xref="S6.SS1.SSS4.p7.1.m1.1.1.3.3.cmml">−</mo><mn id="S6.SS1.SSS4.p7.1.m1.1.1.3.3.2" xref="S6.SS1.SSS4.p7.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p7.1.m1.1b"><apply id="S6.SS1.SSS4.p7.1.m1.1.1.cmml" xref="S6.SS1.SSS4.p7.1.m1.1.1"><eq id="S6.SS1.SSS4.p7.1.m1.1.1.1.cmml" xref="S6.SS1.SSS4.p7.1.m1.1.1.1"></eq><ci id="S6.SS1.SSS4.p7.1.m1.1.1.2.cmml" xref="S6.SS1.SSS4.p7.1.m1.1.1.2">italic-ϵ</ci><apply id="S6.SS1.SSS4.p7.1.m1.1.1.3.cmml" xref="S6.SS1.SSS4.p7.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p7.1.m1.1.1.3.1.cmml" xref="S6.SS1.SSS4.p7.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.SS1.SSS4.p7.1.m1.1.1.3.2.cmml" xref="S6.SS1.SSS4.p7.1.m1.1.1.3.2">10</cn><apply id="S6.SS1.SSS4.p7.1.m1.1.1.3.3.cmml" xref="S6.SS1.SSS4.p7.1.m1.1.1.3.3"><minus id="S6.SS1.SSS4.p7.1.m1.1.1.3.3.1.cmml" xref="S6.SS1.SSS4.p7.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.SS1.SSS4.p7.1.m1.1.1.3.3.2.cmml" xref="S6.SS1.SSS4.p7.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p7.1.m1.1c">\epsilon=10^{-3}</annotation></semantics></math>, <math id="S6.SS1.SSS4.p7.2.m2.1" class="ltx_Math" alttext="\beta_{1}=0.9" display="inline"><semantics id="S6.SS1.SSS4.p7.2.m2.1a"><mrow id="S6.SS1.SSS4.p7.2.m2.1.1" xref="S6.SS1.SSS4.p7.2.m2.1.1.cmml"><msub id="S6.SS1.SSS4.p7.2.m2.1.1.2" xref="S6.SS1.SSS4.p7.2.m2.1.1.2.cmml"><mi id="S6.SS1.SSS4.p7.2.m2.1.1.2.2" xref="S6.SS1.SSS4.p7.2.m2.1.1.2.2.cmml">β</mi><mn id="S6.SS1.SSS4.p7.2.m2.1.1.2.3" xref="S6.SS1.SSS4.p7.2.m2.1.1.2.3.cmml">1</mn></msub><mo id="S6.SS1.SSS4.p7.2.m2.1.1.1" xref="S6.SS1.SSS4.p7.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS4.p7.2.m2.1.1.3" xref="S6.SS1.SSS4.p7.2.m2.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p7.2.m2.1b"><apply id="S6.SS1.SSS4.p7.2.m2.1.1.cmml" xref="S6.SS1.SSS4.p7.2.m2.1.1"><eq id="S6.SS1.SSS4.p7.2.m2.1.1.1.cmml" xref="S6.SS1.SSS4.p7.2.m2.1.1.1"></eq><apply id="S6.SS1.SSS4.p7.2.m2.1.1.2.cmml" xref="S6.SS1.SSS4.p7.2.m2.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p7.2.m2.1.1.2.1.cmml" xref="S6.SS1.SSS4.p7.2.m2.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS4.p7.2.m2.1.1.2.2.cmml" xref="S6.SS1.SSS4.p7.2.m2.1.1.2.2">𝛽</ci><cn type="integer" id="S6.SS1.SSS4.p7.2.m2.1.1.2.3.cmml" xref="S6.SS1.SSS4.p7.2.m2.1.1.2.3">1</cn></apply><cn type="float" id="S6.SS1.SSS4.p7.2.m2.1.1.3.cmml" xref="S6.SS1.SSS4.p7.2.m2.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p7.2.m2.1c">\beta_{1}=0.9</annotation></semantics></math> and <math id="S6.SS1.SSS4.p7.3.m3.1" class="ltx_Math" alttext="\beta_{2}=0.999" display="inline"><semantics id="S6.SS1.SSS4.p7.3.m3.1a"><mrow id="S6.SS1.SSS4.p7.3.m3.1.1" xref="S6.SS1.SSS4.p7.3.m3.1.1.cmml"><msub id="S6.SS1.SSS4.p7.3.m3.1.1.2" xref="S6.SS1.SSS4.p7.3.m3.1.1.2.cmml"><mi id="S6.SS1.SSS4.p7.3.m3.1.1.2.2" xref="S6.SS1.SSS4.p7.3.m3.1.1.2.2.cmml">β</mi><mn id="S6.SS1.SSS4.p7.3.m3.1.1.2.3" xref="S6.SS1.SSS4.p7.3.m3.1.1.2.3.cmml">2</mn></msub><mo id="S6.SS1.SSS4.p7.3.m3.1.1.1" xref="S6.SS1.SSS4.p7.3.m3.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS4.p7.3.m3.1.1.3" xref="S6.SS1.SSS4.p7.3.m3.1.1.3.cmml">0.999</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p7.3.m3.1b"><apply id="S6.SS1.SSS4.p7.3.m3.1.1.cmml" xref="S6.SS1.SSS4.p7.3.m3.1.1"><eq id="S6.SS1.SSS4.p7.3.m3.1.1.1.cmml" xref="S6.SS1.SSS4.p7.3.m3.1.1.1"></eq><apply id="S6.SS1.SSS4.p7.3.m3.1.1.2.cmml" xref="S6.SS1.SSS4.p7.3.m3.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p7.3.m3.1.1.2.1.cmml" xref="S6.SS1.SSS4.p7.3.m3.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS4.p7.3.m3.1.1.2.2.cmml" xref="S6.SS1.SSS4.p7.3.m3.1.1.2.2">𝛽</ci><cn type="integer" id="S6.SS1.SSS4.p7.3.m3.1.1.2.3.cmml" xref="S6.SS1.SSS4.p7.3.m3.1.1.2.3">2</cn></apply><cn type="float" id="S6.SS1.SSS4.p7.3.m3.1.1.3.cmml" xref="S6.SS1.SSS4.p7.3.m3.1.1.3">0.999</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p7.3.m3.1c">\beta_{2}=0.999</annotation></semantics></math> with a batch size of 2. We finetune every row of Tab. 1 and Tab. 2 from the previous row. For the next two rounds (corresponding to the second and third rows of Tab. 1 and 2), we use learning rates of <math id="S6.SS1.SSS4.p7.4.m4.1" class="ltx_Math" alttext="5*10^{-4}" display="inline"><semantics id="S6.SS1.SSS4.p7.4.m4.1a"><mrow id="S6.SS1.SSS4.p7.4.m4.1.1" xref="S6.SS1.SSS4.p7.4.m4.1.1.cmml"><mn id="S6.SS1.SSS4.p7.4.m4.1.1.2" xref="S6.SS1.SSS4.p7.4.m4.1.1.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S6.SS1.SSS4.p7.4.m4.1.1.1" xref="S6.SS1.SSS4.p7.4.m4.1.1.1.cmml">∗</mo><msup id="S6.SS1.SSS4.p7.4.m4.1.1.3" xref="S6.SS1.SSS4.p7.4.m4.1.1.3.cmml"><mn id="S6.SS1.SSS4.p7.4.m4.1.1.3.2" xref="S6.SS1.SSS4.p7.4.m4.1.1.3.2.cmml">10</mn><mrow id="S6.SS1.SSS4.p7.4.m4.1.1.3.3" xref="S6.SS1.SSS4.p7.4.m4.1.1.3.3.cmml"><mo id="S6.SS1.SSS4.p7.4.m4.1.1.3.3a" xref="S6.SS1.SSS4.p7.4.m4.1.1.3.3.cmml">−</mo><mn id="S6.SS1.SSS4.p7.4.m4.1.1.3.3.2" xref="S6.SS1.SSS4.p7.4.m4.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p7.4.m4.1b"><apply id="S6.SS1.SSS4.p7.4.m4.1.1.cmml" xref="S6.SS1.SSS4.p7.4.m4.1.1"><times id="S6.SS1.SSS4.p7.4.m4.1.1.1.cmml" xref="S6.SS1.SSS4.p7.4.m4.1.1.1"></times><cn type="integer" id="S6.SS1.SSS4.p7.4.m4.1.1.2.cmml" xref="S6.SS1.SSS4.p7.4.m4.1.1.2">5</cn><apply id="S6.SS1.SSS4.p7.4.m4.1.1.3.cmml" xref="S6.SS1.SSS4.p7.4.m4.1.1.3"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p7.4.m4.1.1.3.1.cmml" xref="S6.SS1.SSS4.p7.4.m4.1.1.3">superscript</csymbol><cn type="integer" id="S6.SS1.SSS4.p7.4.m4.1.1.3.2.cmml" xref="S6.SS1.SSS4.p7.4.m4.1.1.3.2">10</cn><apply id="S6.SS1.SSS4.p7.4.m4.1.1.3.3.cmml" xref="S6.SS1.SSS4.p7.4.m4.1.1.3.3"><minus id="S6.SS1.SSS4.p7.4.m4.1.1.3.3.1.cmml" xref="S6.SS1.SSS4.p7.4.m4.1.1.3.3"></minus><cn type="integer" id="S6.SS1.SSS4.p7.4.m4.1.1.3.3.2.cmml" xref="S6.SS1.SSS4.p7.4.m4.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p7.4.m4.1c">5*10^{-4}</annotation></semantics></math> and <math id="S6.SS1.SSS4.p7.5.m5.1" class="ltx_Math" alttext="10^{-4}" display="inline"><semantics id="S6.SS1.SSS4.p7.5.m5.1a"><msup id="S6.SS1.SSS4.p7.5.m5.1.1" xref="S6.SS1.SSS4.p7.5.m5.1.1.cmml"><mn id="S6.SS1.SSS4.p7.5.m5.1.1.2" xref="S6.SS1.SSS4.p7.5.m5.1.1.2.cmml">10</mn><mrow id="S6.SS1.SSS4.p7.5.m5.1.1.3" xref="S6.SS1.SSS4.p7.5.m5.1.1.3.cmml"><mo id="S6.SS1.SSS4.p7.5.m5.1.1.3a" xref="S6.SS1.SSS4.p7.5.m5.1.1.3.cmml">−</mo><mn id="S6.SS1.SSS4.p7.5.m5.1.1.3.2" xref="S6.SS1.SSS4.p7.5.m5.1.1.3.2.cmml">4</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS4.p7.5.m5.1b"><apply id="S6.SS1.SSS4.p7.5.m5.1.1.cmml" xref="S6.SS1.SSS4.p7.5.m5.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS4.p7.5.m5.1.1.1.cmml" xref="S6.SS1.SSS4.p7.5.m5.1.1">superscript</csymbol><cn type="integer" id="S6.SS1.SSS4.p7.5.m5.1.1.2.cmml" xref="S6.SS1.SSS4.p7.5.m5.1.1.2">10</cn><apply id="S6.SS1.SSS4.p7.5.m5.1.1.3.cmml" xref="S6.SS1.SSS4.p7.5.m5.1.1.3"><minus id="S6.SS1.SSS4.p7.5.m5.1.1.3.1.cmml" xref="S6.SS1.SSS4.p7.5.m5.1.1.3"></minus><cn type="integer" id="S6.SS1.SSS4.p7.5.m5.1.1.3.2.cmml" xref="S6.SS1.SSS4.p7.5.m5.1.1.3.2">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS4.p7.5.m5.1c">10^{-4}</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Additional Qualitative Results</h3>

<div id="S6.SS2.p1" class="ltx_para ltx_noindent">
<p id="S6.SS2.p1.1" class="ltx_p">We show additonal generated images for the simple prior experiment in Fig. <a href="#S6.F12" title="Figure 12 ‣ 6.2 Additional Qualitative Results ‣ 6 Supplementary Material ‣ Meta-Sim2: Unsupervised Learning of Scene Structure for Synthetic Data Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>. Notice how the prior images (left) are mostly empty, while our learnt generated images have a structure that matches the real images much better. We notice that our method is restricted by the quality of the grammar, and therefore cannot generate structures such as parking side lanes (Row 5 KITTI Image) or intersubsections (Row 7.11 KITTI image) etc. With more work on writing a grammar, we hope to learn much better structures to cover more scenarios. Training for data generation is still very important after the effort on making the grammar, since for different downstream domains (such as driving in different countries), the target dataset can change drastically and appropriate synthetic data must be generated, where learning can help mitigate long cycles of careful tuning of scene parameters by humans.</p>
</div>
<figure id="S6.F12" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_BAD_PRIOR/000085.jpg" id="S6.F12.g1" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_TRAINED/000003.jpg" id="S6.F12.g2" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/KITTI_RESTRICT/001354.jpg" id="S6.F12.g3" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_BAD_PRIOR/000159.jpg" id="S6.F12.g4" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_TRAINED/000169.jpg" id="S6.F12.g5" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/KITTI_RESTRICT/002034.jpg" id="S6.F12.g6" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_BAD_PRIOR/000202.jpg" id="S6.F12.g7" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_TRAINED/000015.jpg" id="S6.F12.g8" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/KITTI_RESTRICT/002902.jpg" id="S6.F12.g9" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_BAD_PRIOR/000211.jpg" id="S6.F12.g10" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_TRAINED/000191.jpg" id="S6.F12.g11" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/KITTI_RESTRICT/004464.jpg" id="S6.F12.g12" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_BAD_PRIOR/000223.jpg" id="S6.F12.g13" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_TRAINED/000022.jpg" id="S6.F12.g14" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/KITTI_RESTRICT/004857.jpg" id="S6.F12.g15" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_BAD_PRIOR/000368.jpg" id="S6.F12.g16" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_TRAINED/000137.jpg" id="S6.F12.g17" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/KITTI_RESTRICT/005354.jpg" id="S6.F12.g18" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_BAD_PRIOR/000370.jpg" id="S6.F12.g19" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_TRAINED/000191.jpg" id="S6.F12.g20" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/KITTI_RESTRICT/005535.jpg" id="S6.F12.g21" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_BAD_PRIOR/000409.jpg" id="S6.F12.g22" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_TRAINED/000019.jpg" id="S6.F12.g23" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/KITTI_RESTRICT/005657.jpg" id="S6.F12.g24" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_BAD_PRIOR/000438.jpg" id="S6.F12.g25" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_TRAINED/000287.jpg" id="S6.F12.g26" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/KITTI_RESTRICT/006262.jpg" id="S6.F12.g27" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_BAD_PRIOR/000425.jpg" id="S6.F12.g28" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_TRAINED/000006.jpg" id="S6.F12.g29" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/KITTI_RESTRICT/006407.jpg" id="S6.F12.g30" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_BAD_PRIOR/000465.jpg" id="S6.F12.g31" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/SUPPL_TRAINED/000131.jpg" id="S6.F12.g32" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2008.09092/assets/figures/KITTI_RESTRICT/007259.jpg" id="S6.F12.g33" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="192" height="58" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>Random generated samples from the simple prior experiment. (Left) Using both the structure and parameter prior, (Middle) Using our learnt structure and parameters and (Right) random KITTI images Note: images in the same row are not correlated</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Akkaya, I., Andrychowicz, M., Chociej, M., Litwin, M., McGrew, B., Petron, A.,
Paino, A., Plappert, M., Powell, G., Ribas, R., et al.: Solving rubik’s cube
with a robot hand. arXiv preprint arXiv:1910.07113 (2019)

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Alhaija, H.A., Mustikovela, S.K., Mescheder, L., Geiger, A., Rother, C.:
Augmented reality meets computer vision: Efficient data generation for urban
driving scenes. International Journal of Computer Vision <span id="bib.bib2.1.1" class="ltx_text ltx_font_bold">126</span>(9),
961–972 (2018)

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Alvarez-Melis, D., Jaakkola, T.S.: Tree-structured decoding with
doubly-recurrent neural networks (2016)

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Armeni, I., He, Z.Y., Gwak, J., Zamir, A.R., Fischer, M., Malik, J., Savarese,
S.: 3d scene graph: A structure for unified semantics, 3d space, and camera.
In: Proceedings of the IEEE International Conference on Computer Vision
(2019)

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Bińkowski, M., Sutherland, D.J., Arbel, M., Gretton, A.: Demystifying mmd
gans. ICLR (2018)

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Brockman, G., Cheung, V., Pettersson, L., Schneider, J., Schulman, J., Tang,
J., Zaremba, W.: Openai gym. In: arXiv:1606.01540 (2016)

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Butler, D.J., Wulff, J., Stanley, G.B., Black, M.J.: A naturalistic open source
movie for optical flow evaluation. In: A. Fitzgibbon et al. (Eds.) (ed.)
ECCV. pp. 611–625. Part IV, LNCS 7577, Springer-Verlag (2012)

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Chebotar, Y., Handa, A., Makoviychuk, V., Macklin, M., Issac, J., Ratliff, N.,
Fox, D.: Closing the sim-to-real loop: Adapting simulation randomization with
real world experience. arXiv preprint arXiv:1810.05687 (2018)

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Chen, X., Liu, C., Song, D.: Tree-to-tree neural networks for program
translation. In: Bengio, S., Wallach, H., Larochelle, H., Grauman, K.,
Cesa-Bianchi, N., Garnett, R. (eds.) Advances in Neural Information
Processing Systems 31, pp. 2547–2557. Curran Associates, Inc. (2018),
<a target="_blank" href="http://papers.nips.cc/paper/7521-tree-to-tree-neural-networks-for-program-translation.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://papers.nips.cc/paper/7521-tree-to-tree-neural-networks-for-program-translation.pdf</a>

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Chu, H., Li, D., Acuna, D., Kar, A., Shugrina, M., Wei, X., Liu, M.Y.,
Torralba, A., Fidler, S.: Neural turtle graphics for modeling city road
layouts. In: Proceedings of the IEEE International Conference on Computer
Vision. pp. 4522–4530 (2019)

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Cranmer, K., Brehmer, J., Louppe, G.: The frontier of simulation-based
inference. arXiv preprint arXiv:1911.01429 (2019)

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Dai, H., Tian, Y., Dai, B., Skiena, S., Song, L.: Syntax-directed variational
autoencoder for structured data. arXiv preprint arXiv:1802.08786 (2018)

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Deng, J., Dong, W., Socher, R., Li, L.J., Li, K., Fei-Fei, L.: Imagenet: A
large-scale hierarchical image database. In: 2009 IEEE conference on computer
vision and pattern recognition. pp. 248–255. Ieee (2009)

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Dosovitskiy, A., Ros, G., Codevilla, F., Lopez, A., Koltun, V.: CARLA: An
open urban driving simulator. In: CORL. pp. 1–16 (2017)

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Dziugaite, G.K., Roy, D.M., Ghahramani, Z.: Training generative neural networks
via maximum mean discrepancy optimization. In: UAI (2015)

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Eslami, S.A., Heess, N., Weber, T., Tassa, Y., Szepesvari, D., Hinton, G.E.,
et al.: Attend, infer, repeat: Fast scene understanding with generative
models. In: Advances in Neural Information Processing Systems. pp. 3225–3233
(2016)

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Fan, S., Huang, B.: Labeled graph generative adversarial networks. CoRR
<span id="bib.bib17.1.1" class="ltx_text ltx_font_bold">abs/1906.03220</span> (2019), <a target="_blank" href="http://arxiv.org/abs/1906.03220" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1906.03220</a>

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Gaidon, A., Wang, Q., Cabon, Y., Vig, E.: Virtual worlds as proxy for
multi-object tracking analysis. In: CVPR (2016)

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Ganin, Y., Kulkarni, T., Babuschkin, I., Eslami, S., Vinyals, O.: Synthesizing
programs for images using reinforced adversarial learning. arXiv preprint
arXiv:1804.01118 (2018)

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Gao, X., Gong, R., Shu, T., Xie, X., Wang, S., Zhu, S.: Vrkitchen: an
interactive 3d virtual environment for task-oriented learning. arXiv
<span id="bib.bib20.1.1" class="ltx_text ltx_font_bold">abs/1903.05757</span> (2019)

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Geiger, A., Lenz, P., Urtasun, R.: Are we ready for Autonomous Driving? The
KITTI Vision Benchmark Suite. In: CVPR (2012)

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Goodfellow, I., Pouget-Abadie, J., Mirza, M., Xu, B., Warde-Farley, D., Ozair,
S., Courville, A., Bengio, Y.: Generative adversarial nets. In: NIPS (2014)

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Gretton, A., Borgwardt, K.M., Rasch, M.J., Schölkopf, B., Smola, A.: A
kernel two-sample test. JMLR (2012)

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Handa, A., Patraucean, V., Badrinarayanan, V., Stent, S., Cipolla, R.:
Understanding real world indoor scenes with synthetic data. In: Proceedings
of the IEEE Conference on Computer Vision and Pattern Recognition. pp.
4077–4085 (2016)

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
He, K., Gkioxari, G., Dollár, P., Girshick, R.: Mask r-cnn. In: Proceedings
of the IEEE international conference on computer vision. pp. 2961–2969
(2017)

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
He, K., Zhang, X., Ren, S., Sun, J.: Deep residual learning for image
recognition. CoRR <span id="bib.bib26.1.1" class="ltx_text ltx_font_bold">abs/1512.03385</span> (2015),
<a target="_blank" href="http://arxiv.org/abs/1512.03385" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1512.03385</a>

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Heusel, M., Ramsauer, H., Unterthiner, T., Nessler, B., Hochreiter, S.: Gans
trained by a two time-scale update rule converge to a local nash equilibrium.
In: Advances in Neural Information Processing Systems. pp. 6626–6637 (2017)

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Juliani, A., Berges, V.P., Vckay, E., Gao, Y., Henry, H., Mattar, M., Lange,
D.: Unity: A general platform for intelligent agents. arXiv preprint
arXiv:1809.02627 (2018)

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Jyothi, A.A., Durand, T., He, J., Sigal, L., Mori, G.: Layoutvae: Stochastic
scene layout generation from a label set. In: The IEEE International
Conference on Computer Vision (ICCV) (October 2019)

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Kar, A., Prakash, A., Liu, M.Y., Cameracci, E., Yuan, J., Rusiniak, M., Acuna,
D., Torralba, A., Fidler, S.: Meta-sim: Learning to generate synthetic
datasets. In: ICCV (2019)

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Karras, T., Laine, S., Aila, T.: A style-based generator architecture for
generative adversarial networks. arXiv preprint arXiv:1812.04948 (2018)

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Kim, Y., Dyer, C., Rush, A.M.: Compound probabilistic context-free grammars for
grammar induction. vol. abs/1906.10225 (2019),
<a target="_blank" href="http://arxiv.org/abs/1906.10225" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1906.10225</a>

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Kingma, D.P., Welling, M.: Auto-encoding variational bayes. arXiv preprint
arXiv:1312.6114 (2013)

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Kolve, E., Mottaghi, R., Gordon, D., Zhu, Y., Gupta, A., Farhadi, A.: Ai2-thor:
An interactive 3d environment for visual ai. In: arXiv:1712.05474 (2017)

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Kulkarni, T.D., Kohli, P., Tenenbaum, J.B., Mansinghka, V.: Picture: A
probabilistic programming language for scene perception. In: Proceedings of
the ieee conference on computer vision and pattern recognition. pp.
4390–4399 (2015)

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Kulkarni, T.D., Whitney, W.F., Kohli, P., Tenenbaum, J.: Deep convolutional
inverse graphics network. In: NIPS. pp. 2539–2547 (2015)

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Kusner, M.J., Paige, B., Hernández-Lobato, J.M.: Grammar variational
autoencoder. In: Proceedings of the 34th International Conference on Machine
Learning - Volume 70. pp. 1945–1954. ICML’17, JMLR.org (2017),
<a target="_blank" href="http://dl.acm.org/citation.cfm?id=3305381.3305582" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://dl.acm.org/citation.cfm?id=3305381.3305582</a>

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
LeCun, Y.: The mnist database of handwritten digits. http://yann. lecun.
com/exdb/mnist/

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Li, C.L., Chang, W.C., Cheng, Y., Yang, Y., Póczos, B.: Mmd gan: Towards
deeper understanding of moment matching network. In: NIPS (2017)

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Li, M., Patil, A.G., Xu, K., Chaudhuri, S., Khan, O., Shamir, A., Tu, C., Chen,
B., Cohen-Or, D., Zhang, H.: Grains: Generative recursive autoencoders for
indoor scenes. ACM Transactions on Graphics (TOG) <span id="bib.bib40.1.1" class="ltx_text ltx_font_bold">38</span>(2),  12 (2019)

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Li, Y., Swersky, K., Zemel, R.: Generative moment matching networks. In: ICML
(2015)

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Li, Y., Vinyals, O., Dyer, C., Pascanu, R., Battaglia, P.: Learning deep
generative models of graphs. arXiv preprint arXiv:1803.03324 (2018)

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Liao, R., Li, Y., Song, Y., Wang, S., Nash, C., Hamilton, W.L., Duvenaud, D.,
Urtasun, R., Zemel, R.S.: Efficient graph generation with graph recurrent
attention networks. arXiv preprint arXiv:1910.00760 (2019)

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Louppe, G., Cranmer, K.: Adversarial variational optimization of
non-differentiable simulators. arXiv preprint arXiv:1707.07113 (2017)

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Mansinghka, V.K., Kulkarni, T.D., Perov, Y.N., Tenenbaum, J.: Approximate
bayesian image interpretation using generative probabilistic graphics
programs. In: Advances in Neural Information Processing Systems. pp.
1520–1528 (2013)

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
McCormac, J., Handa, A., Leutenegger, S., Davison, A.J.: Scenenet rgb-d: 5m
photorealistic images of synthetic indoor trajectories with ground truth.
arXiv preprint arXiv:1612.05079 (2016)

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Mellor, J.F.J., Park, E., Ganin, Y., Babuschkin, I., Kulkarni, T., Rosenbaum,
D., Ballard, A., Weber, T., Vinyals, O., Eslami, S.M.A.: Unsupervised
doodling and painting with improved spiral (2019)

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Prakash, A., Boochoon, S., Brophy, M., Acuna, D., Cameracci, E., State, G.,
Shapira, O., Birchfield, S.: Structured domain randomization: Bridging the
reality gap by context-aware synthetic data. In: arXiv:1810.10093 (2018)

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Puig, X., Ra, K., Boben, M., Li, J., Wang, T., Fidler, S., Torralba, A.:
Virtualhome: Simulating household activities via programs. In: CVPR (2018)

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Qi, S., Zhu, Y., Huang, S., Jiang, C., Zhu, S.C.: Human-centric indoor scene
synthesis using stochastic grammar. In: Proceedings of the IEEE Conference on
Computer Vision and Pattern Recognition. pp. 5899–5908 (2018)

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
Razavi, A., Oord, A.v.d., Vinyals, O.: Generating diverse high-fidelity images
with vq-vae-2. arXiv preprint arXiv:1906.00446 (2019)

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
Rezende, D.J., Mohamed, S., Wierstra, D.: Stochastic backpropagation and
approximate inference in deep generative models. arXiv preprint
arXiv:1401.4082 (2014)

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
Richter, S.R., Vineet, V., Roth, S., Koltun, V.: Playing for data: Ground truth
from computer games. In: ECCV (2016)

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
Ritchie, D., Wang, K., Lin, Y.A.: Fast and flexible indoor scene synthesis via
deep convolutional generative models. In: The IEEE Conference on Computer
Vision and Pattern Recognition (CVPR) (June 2019)

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
Ros, G., Sellart, L., Materzynska, J., Vazquez, D., Lopez, A.: The SYNTHIA
Dataset: A large collection of synthetic images for semantic segmentation of
urban scenes. In: CVPR (2016)

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
Sadeghi, F., Levine, S.: Cad2rl: Real single-image flight without a single real
image. arXiv preprint arXiv:1611.04201 (2016)

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
Savva, M., Kadian, A., Maksymets, O., Zhao, Y., Wijmans, E., Jain, B., Straub,
J., Liu, J., Koltun, V., Malik, J., et al.: Habitat: A platform for embodied
ai research. arXiv preprint arXiv:1904.01201 (2019)

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
Shugrina, M., Liang, Z., Kar, A., Li, J., Singh, A., Singh, K., Fidler, S.:
Creative flow+ dataset. In: Proceedings of the IEEE Conference on Computer
Vision and Pattern Recognition. pp. 5384–5393 (2019)

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
Song, S., Yu, F., Zeng, A., Chang, A.X., Savva, M., Funkhouser, T.: Semantic
scene completion from a single depth image. Proceedings of 30th IEEE
Conference on Computer Vision and Pattern Recognition (2017)

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
Such, F.P., Rawal, A., Lehman, J., Stanley, K.O., Clune, J.: Generative
teaching networks: Accelerating neural architecture search by learning to
generate synthetic training data. arXiv preprint arXiv:1912.07768 (2019)

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
Tassa, Y., Doron, Y., Muldal, A., Erez, T., Li, Y., de Las Casas, D., Budden,
D., Abdolmaleki, A., Merel, J., Lefrancq, A., Lillicrap, T., Riedmiller, M.:
DeepMind control suite. Tech. rep., DeepMind (Jan 2018),
<a target="_blank" href="https://arxiv.org/abs/1801.00690" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/1801.00690</a>

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
Tobin, J., Fong, R., Ray, A., Schneider, J., Zaremba, W., Abbeel, P.: Domain
randomization for transferring deep neural networks from simulation to the
real world. In: IROS (2017)

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock">
Todorov, E., Erez, T., Tassa, Y.: Mujoco: A physics engine for model-based
control. In: Intl. Conf. on Intelligent Robots and Systems (2012)

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock">
Wang, K., Lin, Y.A., Weissmann, B., Savva, M., Chang, A.X., Ritchie, D.:
Planit: Planning and instantiating indoor scenes with relation graph and
spatial prior networks. ACM Transactions on Graphics (TOG) <span id="bib.bib64.1.1" class="ltx_text ltx_font_bold">38</span>(4),
 132 (2019)

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock">
Wang, K., Savva, M., Chang, A.X., Ritchie, D.: Deep convolutional priors for
indoor scene synthesis. ACM Transactions on Graphics (TOG) <span id="bib.bib65.1.1" class="ltx_text ltx_font_bold">37</span>(4),
 70 (2018)

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock">
Wang, R., Lehman, J., Clune, J., Stanley, K.O.: Poet: open-ended coevolution of
environments and their optimized solutions. In: Proceedings of the Genetic
and Evolutionary Computation Conference. pp. 142–151 (2019)

</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[67]</span>
<span class="ltx_bibblock">
Williams, R.J.: Simple statistical gradient-following algorithms for
connectionist reinforcement learning. Machine learning (1992)

</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[68]</span>
<span class="ltx_bibblock">
Wrenninge, M., Unger, J.: Synscapes: A photorealistic synthetic dataset for
street scene parsing. In: arXiv:1810.08705 (2018)

</span>
</li>
<li id="bib.bib69" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[69]</span>
<span class="ltx_bibblock">
Wu, J., Tenenbaum, J.B., Kohli, P.: Neural scene de-rendering. In: IEEE
Conference on Computer Vision and Pattern Recognition (CVPR) (2017)

</span>
</li>
<li id="bib.bib70" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[70]</span>
<span class="ltx_bibblock">
Wu, Y., Wu, Y., Gkioxari, G., Tiani, Y.: Building generalizable agents with a
realistic and rich 3d environment. In: arXiv:1801.02209 (2018)

</span>
</li>
<li id="bib.bib71" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[71]</span>
<span class="ltx_bibblock">
Yin, P., Neubig, G.: A syntactic neural model for general-purpose code
generation. CoRR <span id="bib.bib71.1.1" class="ltx_text ltx_font_bold">abs/1704.01696</span> (2017),
<a target="_blank" href="http://arxiv.org/abs/1704.01696" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1704.01696</a>

</span>
</li>
<li id="bib.bib72" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[72]</span>
<span class="ltx_bibblock">
Yin, P., Zhou, C., He, J., Neubig, G.: Structvae: Tree-structured latent
variable models for semi-supervised semantic parsing. CoRR
<span id="bib.bib72.1.1" class="ltx_text ltx_font_bold">abs/1806.07832</span> (2018), <a target="_blank" href="http://arxiv.org/abs/1806.07832" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1806.07832</a>

</span>
</li>
<li id="bib.bib73" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[73]</span>
<span class="ltx_bibblock">
You, J., Ying, R., Ren, X., Hamilton, W., Leskovec, J.: Graphrnn: Generating
realistic graphs with deep auto-regressive models. In: International
Conference on Machine Learning. pp. 5694–5703 (2018)

</span>
</li>
<li id="bib.bib74" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[74]</span>
<span class="ltx_bibblock">
Yu, L.F., Yeung, S.K., Tang, C.K., Terzopoulos, D., Chan, T.F., Osher, S.: Make
it home: automatic optimization of furniture arrangement. ACM Trans. Graph.
<span id="bib.bib74.1.1" class="ltx_text ltx_font_bold">30</span>(4),  86 (2011)

</span>
</li>
<li id="bib.bib75" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[75]</span>
<span class="ltx_bibblock">
Zhang, Y., Song, S., Yumer, E., Savva, M., Lee, J.Y., Jin, H., Funkhouser, T.:
Physically-based rendering for indoor scene understanding using convolutional
neural networks. In: The IEEE Conference on Computer Vision and Pattern
Recognition (CVPR) (July 2017)

</span>
</li>
<li id="bib.bib76" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[76]</span>
<span class="ltx_bibblock">
Zhou, Y., While, Z., Kalogerakis, E.: Scenegraphnet: Neural message passing for
3d indoor scene augmentation. In: The IEEE International Conference on
Computer Vision (ICCV) (October 2019)

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2008.09091" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2008.09092" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2008.09092">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2008.09092" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2008.09093" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Mar  2 09:44:11 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
