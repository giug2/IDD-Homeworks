<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Attention-based sequential recommendation system using multimodal data</title>
<!--Generated on Tue May 28 08:26:45 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2405.17959v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S1" title="In Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S2" title="In Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S2.SS1" title="In 2 Related work ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Sequential recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S2.SS2" title="In 2 Related work ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Attention-based sequential recommendation to reflect side information</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S3" title="In Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Proposed method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S3.SS1" title="In 3 Proposed method ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Task definition and overall framework</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S3.SS2" title="In 3 Proposed method ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Embedding module</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S3.SS3" title="In 3 Proposed method ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Multimodal fusion module</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S3.SS4" title="In 3 Proposed method ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Prediction module</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4" title="In Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4.SS1" title="In 4 Experiments ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Datasets and evaluation metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4.SS2" title="In 4 Experiments ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Hyperparameter settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4.SS3" title="In 4 Experiments ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Benchmark methods</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4.SS4" title="In 4 Experiments ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Experimental results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4.SS5" title="In 4 Experiments ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Analysis on attention fusion functions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4.SS6" title="In 4 Experiments ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6 </span>Analysis on utilizing multimodal data</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4.SS7" title="In 4 Experiments ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.7 </span>Analysis on multi-task loss</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4.SS8" title="In 4 Experiments ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.8 </span>Attention weight visualization</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S5" title="In Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_fleqn">
<h1 class="ltx_title ltx_title_document">Attention-based sequential recommendation system using multimodal data</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hyungtaik Oh
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:colin45@naver.com">colin45@naver.com</a>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wonkeun Jo
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:jowonkun@g.cnu.ac.kr">jowonkun@g.cnu.ac.kr</a>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Dongil Kim
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:d.kim@ewha.ac.kr">d.kim@ewha.ac.kr</a>
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">Sequential recommendation systems that model dynamic preferences based on a user’s past behavior are crucial to e-commerce.
Recent studies on these systems have considered various types of information such as images and texts.
However, multimodal data have not yet been utilized directly to recommend products to users.
In this study, we propose an attention-based sequential recommendation method that employs multimodal data of items such as images, texts, and categories.
First, we extract image and text features from pre-trained VGG and BERT and convert categories into multi-labeled forms.
Subsequently, attention operations are performed independent of the item sequence and multimodal representations.
Finally, the individual attention information is integrated through an attention fusion function.
In addition, we apply multitask learning loss for each modality to improve the generalization performance.
The experimental results obtained from the Amazon datasets show that the proposed method outperforms those of conventional sequential recommendation systems.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>
Recommendation system, Sequential recommendation, Multimodal data, Attention mechanism, Deep learning

</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journal" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journal: </span>Expert Systems with Applications</span></span></span>
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\useunder</span>
<p class="ltx_p" id="p1.2"><span class="ltx_text ltx_ulem_uline" id="p1.2.1"></span><span class="ltx_ERROR undefined" id="p1.2.2">\ul</span>
</p>
</div>
<div class="ltx_para" id="p2">
<span class="ltx_ERROR undefined" id="p2.1">\affiliation</span>
<p class="ltx_p" id="p2.2">[label1]organization=Department of Computer Science and Engineering, Chungnam National University,addressline=99 Daehak–ro,
city=Yuseong–gu,
postcode=34134,
state=Daejeon,
country=Republic of Korea
<span class="ltx_ERROR undefined" id="p2.2.1">\affiliation</span>[label2]organization=Department of Data Science, Ewha Womans University,addressline=52 Ewhayeodae–gil,
city=Seodaemun–gu,
postcode=03760,
state=Seoul,
country=Republic of Korea</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recommendation systems provide information on items preferred by users on e-commerce websites <cite class="ltx_cite ltx_citemacro_citep">(Shao et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib16" title="">2021</a>)</cite>.
Although they change dynamically, user preferences can be deduced from the purchase history of users.
For example, a user who purchases a shirt may subsequently purchase a jacket or pants.
In this manner, a sequential recommendation system models dynamic preferences from the past purchase behavior of users and recommends the next item to purchase <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib9" title="">2018</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">1</span></a>, users usually check various sources of information, such as item image, description, and satisfaction scores, on an e-commerce website before purchasing an item. Such multimodal data contain important information about user behavior and can be used to train recommendation models <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib2" title="">2019</a>)</cite>. For example, various types of information, such as thumbnails, movie storylines, and casts, can play a key role in video recommendation <cite class="ltx_cite ltx_citemacro_citep">(Wei et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib21" title="">2019</a>)</cite>. However, utilizing multimodal data is challenging because they have different forms that require preprocessing steps.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="302" id="S1.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">A sequence of items purchased by the user, which contains multimodal data such as images, text, and categories.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Neural networks have been applied to sequential recommendation systems to improve their performance by utilizing various types of data.
Convolution neural networks (CNNs) were employed to learn the user sequence patterns as image data, whereas recurrent neural networks (RNNs) were employed to learn the user sequence patterns with recurrent hidden states <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib6" title="">2015</a>; Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib18" title="">2018</a>)</cite>.
In addition, some studies showed that using an RNN can extract useful information from multimodal data such as images and text <cite class="ltx_cite ltx_citemacro_citep">(Cui et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib3" title="">2018</a>; Yan and Zhang, <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib23" title="">2019</a>)</cite>.
Meanwhile, the attention mechanism is a popular calculation module in neural networks and shows promising results when applied to sequential recommendation systems <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib19" title="">2017</a>)</cite>.
For example, self-attention networks can solve long-range dependency problems by adaptively assigning weights to the previous items in a sequence.
Recent research has also attempted to reflect side information, such as categories and positions, in attention-based sequential recommendation systems <cite class="ltx_cite ltx_citemacro_citep">(Xie et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib22" title="">2022</a>; Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib24" title="">2019</a>; Zhou et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib26" title="">2020</a>)</cite>.
These methods resulted in a significant improvement in performance.
However, they only used a limited amount of structured information, and not unstructured multimodal data such as images and text.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this study, we propose a novel attention-based sequential recommendation system using multimodal data.
Using a <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">M</span>ultimodal <span class="ltx_text ltx_font_bold" id="S1.p4.1.2">A</span>ttention <span class="ltx_text ltx_font_bold" id="S1.p4.1.3">F</span>usion (MAF) method, the proposed system applies multimodal information extracted from images, texts, and categories to predict the next purchase items of users through attention-based sequential recommendation.
The multimodal data of users’ sequential behavior were collected from the purchase history, item image, item description text, and item category information, and the image and text features were extracted using pre-trained models.
These data were, subsequently, used as input data for neural networks with attention modules, and attention operations were performed independently of item sequence and multimodal representation.
The attention fusion function combines each attention result to adjust the different weights of the sequential multimodal representations.
In the training process, multitask learning was employed to better represent each data modality.
The experimental results show that the proposed method improved the recommendation performance on the Amazon datasets.
The main contributions of this study are summarized as follows:</p>
</div>
<div class="ltx_para" id="S1.p5">
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><math alttext="\bullet" class="ltx_Math" display="inline" id="S1.I1.ix1.1.1.m1.1"><semantics id="S1.I1.ix1.1.1.m1.1b"><mo id="S1.I1.ix1.1.1.m1.1.1" xref="S1.I1.ix1.1.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S1.I1.ix1.1.1.m1.1c"><ci id="S1.I1.ix1.1.1.m1.1.1.cmml" xref="S1.I1.ix1.1.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.ix1.1.1.m1.1d">\bullet</annotation><annotation encoding="application/x-llamapun" id="S1.I1.ix1.1.1.m1.1e">∙</annotation></semantics></math></span>
<div class="ltx_para" id="S1.I1.ix1.p1">
<p class="ltx_p" id="S1.I1.ix1.p1.1">The proposed method utilizes multimodal data from images, text, and categories.
Features are extracted directly from each modality and the attention operations are performed, following which, the information is combined by the MAF.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.ix2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><math alttext="\bullet" class="ltx_Math" display="inline" id="S1.I1.ix2.1.1.m1.1"><semantics id="S1.I1.ix2.1.1.m1.1b"><mo id="S1.I1.ix2.1.1.m1.1.1" xref="S1.I1.ix2.1.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S1.I1.ix2.1.1.m1.1c"><ci id="S1.I1.ix2.1.1.m1.1.1.cmml" xref="S1.I1.ix2.1.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.ix2.1.1.m1.1d">\bullet</annotation><annotation encoding="application/x-llamapun" id="S1.I1.ix2.1.1.m1.1e">∙</annotation></semantics></math></span>
<div class="ltx_para" id="S1.I1.ix2.p1">
<p class="ltx_p" id="S1.I1.ix2.p1.1">Multitask learning is employed for a better generalization performance.
In the training process, the loss function comprises each task-specific loss for predicting the item ID, image, text, and category.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.ix3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><math alttext="\bullet" class="ltx_Math" display="inline" id="S1.I1.ix3.1.1.m1.1"><semantics id="S1.I1.ix3.1.1.m1.1b"><mo id="S1.I1.ix3.1.1.m1.1.1" xref="S1.I1.ix3.1.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S1.I1.ix3.1.1.m1.1c"><ci id="S1.I1.ix3.1.1.m1.1.1.cmml" xref="S1.I1.ix3.1.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.ix3.1.1.m1.1d">\bullet</annotation><annotation encoding="application/x-llamapun" id="S1.I1.ix3.1.1.m1.1e">∙</annotation></semantics></math></span>
<div class="ltx_para" id="S1.I1.ix3.p1">
<p class="ltx_p" id="S1.I1.ix3.p1.1">Experiments on four datasets collected from Amazon show that our model outperforms other recently proposed models.</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Sequential recommendation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">The recommendation system have been widely studied based on collaborative filtering <cite class="ltx_cite ltx_citemacro_citep">(Sarwar et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib15" title="">2001</a>)</cite>, matrix factorization <cite class="ltx_cite ltx_citemacro_citep">(Koren et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib10" title="">2009</a>; Mnih and Salakhutdinov, <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib13" title="">2007</a>)</cite>, top–N recommendation <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib7" title="">2008</a>; Pan et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib14" title="">2008</a>)</cite>, and their hybrid method <cite class="ltx_cite ltx_citemacro_citep">(Walek and Fojtik, <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib20" title="">2020</a>)</cite>; however, most of them cannot easily model the sequential purchasing patterns of users.
To overcome this drawback of the conventional methods, sequential recommendation system has recently been studied to model the purchasing patterns of users. Moreover, deep learning techniques have enabled us to apply sequential recommendation to neural networks to more effectively model user-item interaction.
For example, the convolutional sequence embedding recommendation model (CASER) <cite class="ltx_cite ltx_citemacro_citep">(Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib18" title="">2018</a>)</cite>, which uses a convolutional filter, considers the item sequence of users as an image and learns sequential information through convolutional operations.
RNNs have also been utilized with a gated recurrent unit (GRU) to learn the sequential patterns of users (GRU4Rec) <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib6" title="">2015</a>)</cite>.
The RNN unit enables us to input the hidden state and the current input at each point in time, while considering the sequential dependencies between items purchased by the user.
In addition, self-attentive sequential recommendation (SASRec) methods perform extremely well owing e to their ability to capture long-range dependencies between items.
SASRec excels in the unidirectional learning of user sequential patterns through self-attention technique, and computes results faster than previously proposed CNN/RNN-based sequential models <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib9" title="">2018</a>)</cite>.
Finally, sequential recommendation with bidirectional encoder representations from transformer (BERT4Rec) is an improved model that performs bidirectional self-attention by applying random masking to the input sequence <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib17" title="">2019</a>)</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Attention-based sequential recommendation to reflect side information</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Previous studies have proved that images and text are useful features for recommending new items <cite class="ltx_cite ltx_citemacro_citep">(Han et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib4" title="">2021</a>; He and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib5" title="">2016</a>; Iqbal et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib8" title="">2018</a>; Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib12" title="">2019</a>)</cite>.
Recently, attempts have been made to integrate the side information of items such as category and location into attention-based sequential recommendations.
SASRecF, which is an improved version of SASRec, uses multimodal item information.
The embedding layer of SASRecF directly employs the side information of the item with the sequence to be used as the input for the model.
The feature-level deeper self-attention (FDSA) method integrates several types of side information via a vanilla attention mechanism and performs self-attention operations on the sequences and side information <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib24" title="">2019</a>)</cite>.
It subsequently concatenates the outputs of sequences and multimodal blocks into fully connected layers for next-item recommendations.
The decoupled side information fusion for sequential recommendation (DIF-SR) is another method that reflects side information.
It decouples the information between attention operations and learns the relative importance of each type of side information.
Consequently, this method has high attention representation capacity and flexibility because the decoupled attention improves the final representation by breaking the rank bottleneck <cite class="ltx_cite ltx_citemacro_citep">(Xie et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib22" title="">2022</a>)</cite>.
Moreover, a multi-task training method was used to further activate side formation.
All the above-mentioned methods consider side information in attention-based sequential recommendation.
However, the side information does not include complicated information such as images and texts; only simple data such as categories and positions are considered.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed method</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Task definition and overall framework</h3>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="278" id="S3.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S3.F2.3.2" style="font-size:90%;">Proposed model’s structure: 1) Features are extracted with pre-trained VGG, BERT, and etc., 2) the attention operation with multimodal representations, and 3) multi-task learning for better generalization.</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.27">The problem addressed in this study can be formulated with the following notation: Let <math alttext="I" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">I</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_I</annotation></semantics></math> and <math alttext="U" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">U</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_U</annotation></semantics></math> denote the sets of items and users, respectively.
For multimodal data, we used <math alttext="V,T," class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.3"><semantics id="S3.SS1.p1.3.m3.3a"><mrow id="S3.SS1.p1.3.m3.3.3.1"><mrow id="S3.SS1.p1.3.m3.3.3.1.1.2" xref="S3.SS1.p1.3.m3.3.3.1.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">V</mi><mo id="S3.SS1.p1.3.m3.3.3.1.1.2.1" xref="S3.SS1.p1.3.m3.3.3.1.1.1.cmml">,</mo><mi id="S3.SS1.p1.3.m3.2.2" xref="S3.SS1.p1.3.m3.2.2.cmml">T</mi></mrow><mo id="S3.SS1.p1.3.m3.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.3b"><list id="S3.SS1.p1.3.m3.3.3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.3.3.1.1.2"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑉</ci><ci id="S3.SS1.p1.3.m3.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2">𝑇</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.3c">V,T,</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.3d">italic_V , italic_T ,</annotation></semantics></math> and <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_C</annotation></semantics></math> to represent sets of images, text, and categories, respectively.
For each user <math alttext="u\in U" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mrow id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">u</mi><mo id="S3.SS1.p1.5.m5.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.cmml">∈</mo><mi id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">U</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><in id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1"></in><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝑢</ci><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">𝑈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">u\in U</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_u ∈ italic_U</annotation></semantics></math>, we used <math alttext="i_{1:n}=\{i_{1},i_{2},\cdots,i_{n}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.4"><semantics id="S3.SS1.p1.6.m6.4a"><mrow id="S3.SS1.p1.6.m6.4.4" xref="S3.SS1.p1.6.m6.4.4.cmml"><msub id="S3.SS1.p1.6.m6.4.4.5" xref="S3.SS1.p1.6.m6.4.4.5.cmml"><mi id="S3.SS1.p1.6.m6.4.4.5.2" xref="S3.SS1.p1.6.m6.4.4.5.2.cmml">i</mi><mrow id="S3.SS1.p1.6.m6.4.4.5.3" xref="S3.SS1.p1.6.m6.4.4.5.3.cmml"><mn id="S3.SS1.p1.6.m6.4.4.5.3.2" xref="S3.SS1.p1.6.m6.4.4.5.3.2.cmml">1</mn><mo id="S3.SS1.p1.6.m6.4.4.5.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.6.m6.4.4.5.3.1.cmml">:</mo><mi id="S3.SS1.p1.6.m6.4.4.5.3.3" xref="S3.SS1.p1.6.m6.4.4.5.3.3.cmml">n</mi></mrow></msub><mo id="S3.SS1.p1.6.m6.4.4.4" xref="S3.SS1.p1.6.m6.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.6.m6.4.4.3.3" xref="S3.SS1.p1.6.m6.4.4.3.4.cmml"><mo id="S3.SS1.p1.6.m6.4.4.3.3.4" stretchy="false" xref="S3.SS1.p1.6.m6.4.4.3.4.cmml">{</mo><msub id="S3.SS1.p1.6.m6.2.2.1.1.1" xref="S3.SS1.p1.6.m6.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.6.m6.2.2.1.1.1.2" xref="S3.SS1.p1.6.m6.2.2.1.1.1.2.cmml">i</mi><mn id="S3.SS1.p1.6.m6.2.2.1.1.1.3" xref="S3.SS1.p1.6.m6.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.6.m6.4.4.3.3.5" xref="S3.SS1.p1.6.m6.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.6.m6.3.3.2.2.2" xref="S3.SS1.p1.6.m6.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.6.m6.3.3.2.2.2.2" xref="S3.SS1.p1.6.m6.3.3.2.2.2.2.cmml">i</mi><mn id="S3.SS1.p1.6.m6.3.3.2.2.2.3" xref="S3.SS1.p1.6.m6.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.6.m6.4.4.3.3.6" xref="S3.SS1.p1.6.m6.4.4.3.4.cmml">,</mo><mi id="S3.SS1.p1.6.m6.1.1" mathvariant="normal" xref="S3.SS1.p1.6.m6.1.1.cmml">⋯</mi><mo id="S3.SS1.p1.6.m6.4.4.3.3.7" xref="S3.SS1.p1.6.m6.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.6.m6.4.4.3.3.3" xref="S3.SS1.p1.6.m6.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.6.m6.4.4.3.3.3.2" xref="S3.SS1.p1.6.m6.4.4.3.3.3.2.cmml">i</mi><mi id="S3.SS1.p1.6.m6.4.4.3.3.3.3" xref="S3.SS1.p1.6.m6.4.4.3.3.3.3.cmml">n</mi></msub><mo id="S3.SS1.p1.6.m6.4.4.3.3.8" stretchy="false" xref="S3.SS1.p1.6.m6.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.4b"><apply id="S3.SS1.p1.6.m6.4.4.cmml" xref="S3.SS1.p1.6.m6.4.4"><eq id="S3.SS1.p1.6.m6.4.4.4.cmml" xref="S3.SS1.p1.6.m6.4.4.4"></eq><apply id="S3.SS1.p1.6.m6.4.4.5.cmml" xref="S3.SS1.p1.6.m6.4.4.5"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.4.4.5.1.cmml" xref="S3.SS1.p1.6.m6.4.4.5">subscript</csymbol><ci id="S3.SS1.p1.6.m6.4.4.5.2.cmml" xref="S3.SS1.p1.6.m6.4.4.5.2">𝑖</ci><apply id="S3.SS1.p1.6.m6.4.4.5.3.cmml" xref="S3.SS1.p1.6.m6.4.4.5.3"><ci id="S3.SS1.p1.6.m6.4.4.5.3.1.cmml" xref="S3.SS1.p1.6.m6.4.4.5.3.1">:</ci><cn id="S3.SS1.p1.6.m6.4.4.5.3.2.cmml" type="integer" xref="S3.SS1.p1.6.m6.4.4.5.3.2">1</cn><ci id="S3.SS1.p1.6.m6.4.4.5.3.3.cmml" xref="S3.SS1.p1.6.m6.4.4.5.3.3">𝑛</ci></apply></apply><set id="S3.SS1.p1.6.m6.4.4.3.4.cmml" xref="S3.SS1.p1.6.m6.4.4.3.3"><apply id="S3.SS1.p1.6.m6.2.2.1.1.1.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.2">𝑖</ci><cn id="S3.SS1.p1.6.m6.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.6.m6.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.6.m6.3.3.2.2.2.cmml" xref="S3.SS1.p1.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.6.m6.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.6.m6.3.3.2.2.2.2">𝑖</ci><cn id="S3.SS1.p1.6.m6.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.6.m6.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">⋯</ci><apply id="S3.SS1.p1.6.m6.4.4.3.3.3.cmml" xref="S3.SS1.p1.6.m6.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.6.m6.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.6.m6.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.6.m6.4.4.3.3.3.2">𝑖</ci><ci id="S3.SS1.p1.6.m6.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.6.m6.4.4.3.3.3.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.4c">i_{1:n}=\{i_{1},i_{2},\cdots,i_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.4d">italic_i start_POSTSUBSCRIPT 1 : italic_n end_POSTSUBSCRIPT = { italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_i start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> to represent the purchased item ID sequence where <math alttext="n" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_n</annotation></semantics></math> represents the sequence length.
Similarly, <math alttext="v_{1:n}=\{v_{1},v_{2},\cdots,v_{n}\},t_{1:n}=\{t_{1},t_{2},\cdots,t_{n}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.4"><semantics id="S3.SS1.p1.8.m8.4a"><mrow id="S3.SS1.p1.8.m8.4.4.2" xref="S3.SS1.p1.8.m8.4.4.3.cmml"><mrow id="S3.SS1.p1.8.m8.3.3.1.1" xref="S3.SS1.p1.8.m8.3.3.1.1.cmml"><msub id="S3.SS1.p1.8.m8.3.3.1.1.5" xref="S3.SS1.p1.8.m8.3.3.1.1.5.cmml"><mi id="S3.SS1.p1.8.m8.3.3.1.1.5.2" xref="S3.SS1.p1.8.m8.3.3.1.1.5.2.cmml">v</mi><mrow id="S3.SS1.p1.8.m8.3.3.1.1.5.3" xref="S3.SS1.p1.8.m8.3.3.1.1.5.3.cmml"><mn id="S3.SS1.p1.8.m8.3.3.1.1.5.3.2" xref="S3.SS1.p1.8.m8.3.3.1.1.5.3.2.cmml">1</mn><mo id="S3.SS1.p1.8.m8.3.3.1.1.5.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.8.m8.3.3.1.1.5.3.1.cmml">:</mo><mi id="S3.SS1.p1.8.m8.3.3.1.1.5.3.3" xref="S3.SS1.p1.8.m8.3.3.1.1.5.3.3.cmml">n</mi></mrow></msub><mo id="S3.SS1.p1.8.m8.3.3.1.1.4" xref="S3.SS1.p1.8.m8.3.3.1.1.4.cmml">=</mo><mrow id="S3.SS1.p1.8.m8.3.3.1.1.3.3" xref="S3.SS1.p1.8.m8.3.3.1.1.3.4.cmml"><mo id="S3.SS1.p1.8.m8.3.3.1.1.3.3.4" stretchy="false" xref="S3.SS1.p1.8.m8.3.3.1.1.3.4.cmml">{</mo><msub id="S3.SS1.p1.8.m8.3.3.1.1.1.1.1" xref="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.2" xref="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.2.cmml">v</mi><mn id="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.3" xref="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.8.m8.3.3.1.1.3.3.5" xref="S3.SS1.p1.8.m8.3.3.1.1.3.4.cmml">,</mo><msub id="S3.SS1.p1.8.m8.3.3.1.1.2.2.2" xref="S3.SS1.p1.8.m8.3.3.1.1.2.2.2.cmml"><mi id="S3.SS1.p1.8.m8.3.3.1.1.2.2.2.2" xref="S3.SS1.p1.8.m8.3.3.1.1.2.2.2.2.cmml">v</mi><mn id="S3.SS1.p1.8.m8.3.3.1.1.2.2.2.3" xref="S3.SS1.p1.8.m8.3.3.1.1.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.8.m8.3.3.1.1.3.3.6" xref="S3.SS1.p1.8.m8.3.3.1.1.3.4.cmml">,</mo><mi id="S3.SS1.p1.8.m8.1.1" mathvariant="normal" xref="S3.SS1.p1.8.m8.1.1.cmml">⋯</mi><mo id="S3.SS1.p1.8.m8.3.3.1.1.3.3.7" xref="S3.SS1.p1.8.m8.3.3.1.1.3.4.cmml">,</mo><msub id="S3.SS1.p1.8.m8.3.3.1.1.3.3.3" xref="S3.SS1.p1.8.m8.3.3.1.1.3.3.3.cmml"><mi id="S3.SS1.p1.8.m8.3.3.1.1.3.3.3.2" xref="S3.SS1.p1.8.m8.3.3.1.1.3.3.3.2.cmml">v</mi><mi id="S3.SS1.p1.8.m8.3.3.1.1.3.3.3.3" xref="S3.SS1.p1.8.m8.3.3.1.1.3.3.3.3.cmml">n</mi></msub><mo id="S3.SS1.p1.8.m8.3.3.1.1.3.3.8" stretchy="false" xref="S3.SS1.p1.8.m8.3.3.1.1.3.4.cmml">}</mo></mrow></mrow><mo id="S3.SS1.p1.8.m8.4.4.2.3" xref="S3.SS1.p1.8.m8.4.4.3a.cmml">,</mo><mrow id="S3.SS1.p1.8.m8.4.4.2.2" xref="S3.SS1.p1.8.m8.4.4.2.2.cmml"><msub id="S3.SS1.p1.8.m8.4.4.2.2.5" xref="S3.SS1.p1.8.m8.4.4.2.2.5.cmml"><mi id="S3.SS1.p1.8.m8.4.4.2.2.5.2" xref="S3.SS1.p1.8.m8.4.4.2.2.5.2.cmml">t</mi><mrow id="S3.SS1.p1.8.m8.4.4.2.2.5.3" xref="S3.SS1.p1.8.m8.4.4.2.2.5.3.cmml"><mn id="S3.SS1.p1.8.m8.4.4.2.2.5.3.2" xref="S3.SS1.p1.8.m8.4.4.2.2.5.3.2.cmml">1</mn><mo id="S3.SS1.p1.8.m8.4.4.2.2.5.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.8.m8.4.4.2.2.5.3.1.cmml">:</mo><mi id="S3.SS1.p1.8.m8.4.4.2.2.5.3.3" xref="S3.SS1.p1.8.m8.4.4.2.2.5.3.3.cmml">n</mi></mrow></msub><mo id="S3.SS1.p1.8.m8.4.4.2.2.4" xref="S3.SS1.p1.8.m8.4.4.2.2.4.cmml">=</mo><mrow id="S3.SS1.p1.8.m8.4.4.2.2.3.3" xref="S3.SS1.p1.8.m8.4.4.2.2.3.4.cmml"><mo id="S3.SS1.p1.8.m8.4.4.2.2.3.3.4" stretchy="false" xref="S3.SS1.p1.8.m8.4.4.2.2.3.4.cmml">{</mo><msub id="S3.SS1.p1.8.m8.4.4.2.2.1.1.1" xref="S3.SS1.p1.8.m8.4.4.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.8.m8.4.4.2.2.1.1.1.2" xref="S3.SS1.p1.8.m8.4.4.2.2.1.1.1.2.cmml">t</mi><mn id="S3.SS1.p1.8.m8.4.4.2.2.1.1.1.3" xref="S3.SS1.p1.8.m8.4.4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.8.m8.4.4.2.2.3.3.5" xref="S3.SS1.p1.8.m8.4.4.2.2.3.4.cmml">,</mo><msub id="S3.SS1.p1.8.m8.4.4.2.2.2.2.2" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.2" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.2.cmml">t</mi><mn id="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.3" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.8.m8.4.4.2.2.3.3.6" xref="S3.SS1.p1.8.m8.4.4.2.2.3.4.cmml">,</mo><mi id="S3.SS1.p1.8.m8.2.2" mathvariant="normal" xref="S3.SS1.p1.8.m8.2.2.cmml">⋯</mi><mo id="S3.SS1.p1.8.m8.4.4.2.2.3.3.7" xref="S3.SS1.p1.8.m8.4.4.2.2.3.4.cmml">,</mo><msub id="S3.SS1.p1.8.m8.4.4.2.2.3.3.3" xref="S3.SS1.p1.8.m8.4.4.2.2.3.3.3.cmml"><mi id="S3.SS1.p1.8.m8.4.4.2.2.3.3.3.2" xref="S3.SS1.p1.8.m8.4.4.2.2.3.3.3.2.cmml">t</mi><mi id="S3.SS1.p1.8.m8.4.4.2.2.3.3.3.3" xref="S3.SS1.p1.8.m8.4.4.2.2.3.3.3.3.cmml">n</mi></msub><mo id="S3.SS1.p1.8.m8.4.4.2.2.3.3.8" stretchy="false" xref="S3.SS1.p1.8.m8.4.4.2.2.3.4.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.4b"><apply id="S3.SS1.p1.8.m8.4.4.3.cmml" xref="S3.SS1.p1.8.m8.4.4.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.4.4.3a.cmml" xref="S3.SS1.p1.8.m8.4.4.2.3">formulae-sequence</csymbol><apply id="S3.SS1.p1.8.m8.3.3.1.1.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1"><eq id="S3.SS1.p1.8.m8.3.3.1.1.4.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.4"></eq><apply id="S3.SS1.p1.8.m8.3.3.1.1.5.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.5"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.3.3.1.1.5.1.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.5">subscript</csymbol><ci id="S3.SS1.p1.8.m8.3.3.1.1.5.2.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.5.2">𝑣</ci><apply id="S3.SS1.p1.8.m8.3.3.1.1.5.3.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.5.3"><ci id="S3.SS1.p1.8.m8.3.3.1.1.5.3.1.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.5.3.1">:</ci><cn id="S3.SS1.p1.8.m8.3.3.1.1.5.3.2.cmml" type="integer" xref="S3.SS1.p1.8.m8.3.3.1.1.5.3.2">1</cn><ci id="S3.SS1.p1.8.m8.3.3.1.1.5.3.3.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.5.3.3">𝑛</ci></apply></apply><set id="S3.SS1.p1.8.m8.3.3.1.1.3.4.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.3.3"><apply id="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.2">𝑣</ci><cn id="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.8.m8.3.3.1.1.2.2.2.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.3.3.1.1.2.2.2.1.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.8.m8.3.3.1.1.2.2.2.2.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.2.2.2.2">𝑣</ci><cn id="S3.SS1.p1.8.m8.3.3.1.1.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.8.m8.3.3.1.1.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">⋯</ci><apply id="S3.SS1.p1.8.m8.3.3.1.1.3.3.3.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.3.3.1.1.3.3.3.1.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.8.m8.3.3.1.1.3.3.3.2.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.3.3.3.2">𝑣</ci><ci id="S3.SS1.p1.8.m8.3.3.1.1.3.3.3.3.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.3.3.3.3">𝑛</ci></apply></set></apply><apply id="S3.SS1.p1.8.m8.4.4.2.2.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2"><eq id="S3.SS1.p1.8.m8.4.4.2.2.4.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.4"></eq><apply id="S3.SS1.p1.8.m8.4.4.2.2.5.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.5"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.4.4.2.2.5.1.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.5">subscript</csymbol><ci id="S3.SS1.p1.8.m8.4.4.2.2.5.2.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.5.2">𝑡</ci><apply id="S3.SS1.p1.8.m8.4.4.2.2.5.3.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.5.3"><ci id="S3.SS1.p1.8.m8.4.4.2.2.5.3.1.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.5.3.1">:</ci><cn id="S3.SS1.p1.8.m8.4.4.2.2.5.3.2.cmml" type="integer" xref="S3.SS1.p1.8.m8.4.4.2.2.5.3.2">1</cn><ci id="S3.SS1.p1.8.m8.4.4.2.2.5.3.3.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.5.3.3">𝑛</ci></apply></apply><set id="S3.SS1.p1.8.m8.4.4.2.2.3.4.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.3.3"><apply id="S3.SS1.p1.8.m8.4.4.2.2.1.1.1.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.4.4.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.4.4.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.1.1.1.2">𝑡</ci><cn id="S3.SS1.p1.8.m8.4.4.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.8.m8.4.4.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.2">𝑡</ci><cn id="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.8.m8.2.2.cmml" xref="S3.SS1.p1.8.m8.2.2">⋯</ci><apply id="S3.SS1.p1.8.m8.4.4.2.2.3.3.3.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.4.4.2.2.3.3.3.1.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.8.m8.4.4.2.2.3.3.3.2.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.3.3.3.2">𝑡</ci><ci id="S3.SS1.p1.8.m8.4.4.2.2.3.3.3.3.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.3.3.3.3">𝑛</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.4c">v_{1:n}=\{v_{1},v_{2},\cdots,v_{n}\},t_{1:n}=\{t_{1},t_{2},\cdots,t_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.4d">italic_v start_POSTSUBSCRIPT 1 : italic_n end_POSTSUBSCRIPT = { italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_v start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT } , italic_t start_POSTSUBSCRIPT 1 : italic_n end_POSTSUBSCRIPT = { italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_t start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math>, and <math alttext="c_{1:n}=\{c_{1},c_{2},\cdots,c_{n}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.4"><semantics id="S3.SS1.p1.9.m9.4a"><mrow id="S3.SS1.p1.9.m9.4.4" xref="S3.SS1.p1.9.m9.4.4.cmml"><msub id="S3.SS1.p1.9.m9.4.4.5" xref="S3.SS1.p1.9.m9.4.4.5.cmml"><mi id="S3.SS1.p1.9.m9.4.4.5.2" xref="S3.SS1.p1.9.m9.4.4.5.2.cmml">c</mi><mrow id="S3.SS1.p1.9.m9.4.4.5.3" xref="S3.SS1.p1.9.m9.4.4.5.3.cmml"><mn id="S3.SS1.p1.9.m9.4.4.5.3.2" xref="S3.SS1.p1.9.m9.4.4.5.3.2.cmml">1</mn><mo id="S3.SS1.p1.9.m9.4.4.5.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.9.m9.4.4.5.3.1.cmml">:</mo><mi id="S3.SS1.p1.9.m9.4.4.5.3.3" xref="S3.SS1.p1.9.m9.4.4.5.3.3.cmml">n</mi></mrow></msub><mo id="S3.SS1.p1.9.m9.4.4.4" xref="S3.SS1.p1.9.m9.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.9.m9.4.4.3.3" xref="S3.SS1.p1.9.m9.4.4.3.4.cmml"><mo id="S3.SS1.p1.9.m9.4.4.3.3.4" stretchy="false" xref="S3.SS1.p1.9.m9.4.4.3.4.cmml">{</mo><msub id="S3.SS1.p1.9.m9.2.2.1.1.1" xref="S3.SS1.p1.9.m9.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.9.m9.2.2.1.1.1.2" xref="S3.SS1.p1.9.m9.2.2.1.1.1.2.cmml">c</mi><mn id="S3.SS1.p1.9.m9.2.2.1.1.1.3" xref="S3.SS1.p1.9.m9.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.9.m9.4.4.3.3.5" xref="S3.SS1.p1.9.m9.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.9.m9.3.3.2.2.2" xref="S3.SS1.p1.9.m9.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.9.m9.3.3.2.2.2.2" xref="S3.SS1.p1.9.m9.3.3.2.2.2.2.cmml">c</mi><mn id="S3.SS1.p1.9.m9.3.3.2.2.2.3" xref="S3.SS1.p1.9.m9.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.9.m9.4.4.3.3.6" xref="S3.SS1.p1.9.m9.4.4.3.4.cmml">,</mo><mi id="S3.SS1.p1.9.m9.1.1" mathvariant="normal" xref="S3.SS1.p1.9.m9.1.1.cmml">⋯</mi><mo id="S3.SS1.p1.9.m9.4.4.3.3.7" xref="S3.SS1.p1.9.m9.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.9.m9.4.4.3.3.3" xref="S3.SS1.p1.9.m9.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.9.m9.4.4.3.3.3.2" xref="S3.SS1.p1.9.m9.4.4.3.3.3.2.cmml">c</mi><mi id="S3.SS1.p1.9.m9.4.4.3.3.3.3" xref="S3.SS1.p1.9.m9.4.4.3.3.3.3.cmml">n</mi></msub><mo id="S3.SS1.p1.9.m9.4.4.3.3.8" stretchy="false" xref="S3.SS1.p1.9.m9.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.4b"><apply id="S3.SS1.p1.9.m9.4.4.cmml" xref="S3.SS1.p1.9.m9.4.4"><eq id="S3.SS1.p1.9.m9.4.4.4.cmml" xref="S3.SS1.p1.9.m9.4.4.4"></eq><apply id="S3.SS1.p1.9.m9.4.4.5.cmml" xref="S3.SS1.p1.9.m9.4.4.5"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.4.4.5.1.cmml" xref="S3.SS1.p1.9.m9.4.4.5">subscript</csymbol><ci id="S3.SS1.p1.9.m9.4.4.5.2.cmml" xref="S3.SS1.p1.9.m9.4.4.5.2">𝑐</ci><apply id="S3.SS1.p1.9.m9.4.4.5.3.cmml" xref="S3.SS1.p1.9.m9.4.4.5.3"><ci id="S3.SS1.p1.9.m9.4.4.5.3.1.cmml" xref="S3.SS1.p1.9.m9.4.4.5.3.1">:</ci><cn id="S3.SS1.p1.9.m9.4.4.5.3.2.cmml" type="integer" xref="S3.SS1.p1.9.m9.4.4.5.3.2">1</cn><ci id="S3.SS1.p1.9.m9.4.4.5.3.3.cmml" xref="S3.SS1.p1.9.m9.4.4.5.3.3">𝑛</ci></apply></apply><set id="S3.SS1.p1.9.m9.4.4.3.4.cmml" xref="S3.SS1.p1.9.m9.4.4.3.3"><apply id="S3.SS1.p1.9.m9.2.2.1.1.1.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m9.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1.2">𝑐</ci><cn id="S3.SS1.p1.9.m9.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.9.m9.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.9.m9.3.3.2.2.2.cmml" xref="S3.SS1.p1.9.m9.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.9.m9.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.9.m9.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.9.m9.3.3.2.2.2.2">𝑐</ci><cn id="S3.SS1.p1.9.m9.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.9.m9.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">⋯</ci><apply id="S3.SS1.p1.9.m9.4.4.3.3.3.cmml" xref="S3.SS1.p1.9.m9.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.9.m9.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.9.m9.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.9.m9.4.4.3.3.3.2">𝑐</ci><ci id="S3.SS1.p1.9.m9.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.9.m9.4.4.3.3.3.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.4c">c_{1:n}=\{c_{1},c_{2},\cdots,c_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.4d">italic_c start_POSTSUBSCRIPT 1 : italic_n end_POSTSUBSCRIPT = { italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_c start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> denote the corresponding visual, text and category, respectively.
We use <math alttext="i_{k}" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><msub id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">i</mi><mi id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2">𝑖</ci><ci id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">i_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">italic_i start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> to represent the items that user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.1"><semantics id="S3.SS1.p1.11.m11.1a"><mi id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><ci id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.1d">italic_u</annotation></semantics></math> interacted with at the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.1"><semantics id="S3.SS1.p1.12.m12.1a"><mi id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><ci id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.1d">italic_k</annotation></semantics></math>-th time step, and <math alttext="v_{k}" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m13.1"><semantics id="S3.SS1.p1.13.m13.1a"><msub id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml"><mi id="S3.SS1.p1.13.m13.1.1.2" xref="S3.SS1.p1.13.m13.1.1.2.cmml">v</mi><mi id="S3.SS1.p1.13.m13.1.1.3" xref="S3.SS1.p1.13.m13.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><apply id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2">𝑣</ci><ci id="S3.SS1.p1.13.m13.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">v_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m13.1d">italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="t_{k}" class="ltx_Math" display="inline" id="S3.SS1.p1.14.m14.1"><semantics id="S3.SS1.p1.14.m14.1a"><msub id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml"><mi id="S3.SS1.p1.14.m14.1.1.2" xref="S3.SS1.p1.14.m14.1.1.2.cmml">t</mi><mi id="S3.SS1.p1.14.m14.1.1.3" xref="S3.SS1.p1.14.m14.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b"><apply id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1">subscript</csymbol><ci id="S3.SS1.p1.14.m14.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.2">𝑡</ci><ci id="S3.SS1.p1.14.m14.1.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">t_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.14.m14.1d">italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="c_{k}" class="ltx_Math" display="inline" id="S3.SS1.p1.15.m15.1"><semantics id="S3.SS1.p1.15.m15.1a"><msub id="S3.SS1.p1.15.m15.1.1" xref="S3.SS1.p1.15.m15.1.1.cmml"><mi id="S3.SS1.p1.15.m15.1.1.2" xref="S3.SS1.p1.15.m15.1.1.2.cmml">c</mi><mi id="S3.SS1.p1.15.m15.1.1.3" xref="S3.SS1.p1.15.m15.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b"><apply id="S3.SS1.p1.15.m15.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1">subscript</csymbol><ci id="S3.SS1.p1.15.m15.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.2">𝑐</ci><ci id="S3.SS1.p1.15.m15.1.1.3.cmml" xref="S3.SS1.p1.15.m15.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">c_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.15.m15.1d">italic_c start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> are the corresponding visuals, texts, and categories of <math alttext="i_{k}" class="ltx_Math" display="inline" id="S3.SS1.p1.16.m16.1"><semantics id="S3.SS1.p1.16.m16.1a"><msub id="S3.SS1.p1.16.m16.1.1" xref="S3.SS1.p1.16.m16.1.1.cmml"><mi id="S3.SS1.p1.16.m16.1.1.2" xref="S3.SS1.p1.16.m16.1.1.2.cmml">i</mi><mi id="S3.SS1.p1.16.m16.1.1.3" xref="S3.SS1.p1.16.m16.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m16.1b"><apply id="S3.SS1.p1.16.m16.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m16.1.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1">subscript</csymbol><ci id="S3.SS1.p1.16.m16.1.1.2.cmml" xref="S3.SS1.p1.16.m16.1.1.2">𝑖</ci><ci id="S3.SS1.p1.16.m16.1.1.3.cmml" xref="S3.SS1.p1.16.m16.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m16.1c">i_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.16.m16.1d">italic_i start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.
Based on these notations, the task of our sequential recommendations is to learn an objective function <math alttext="f(\cdot)" class="ltx_Math" display="inline" id="S3.SS1.p1.17.m17.1"><semantics id="S3.SS1.p1.17.m17.1a"><mrow id="S3.SS1.p1.17.m17.1.2" xref="S3.SS1.p1.17.m17.1.2.cmml"><mi id="S3.SS1.p1.17.m17.1.2.2" xref="S3.SS1.p1.17.m17.1.2.2.cmml">f</mi><mo id="S3.SS1.p1.17.m17.1.2.1" xref="S3.SS1.p1.17.m17.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p1.17.m17.1.2.3.2" xref="S3.SS1.p1.17.m17.1.2.cmml"><mo id="S3.SS1.p1.17.m17.1.2.3.2.1" stretchy="false" xref="S3.SS1.p1.17.m17.1.2.cmml">(</mo><mo id="S3.SS1.p1.17.m17.1.1" lspace="0em" rspace="0em" xref="S3.SS1.p1.17.m17.1.1.cmml">⋅</mo><mo id="S3.SS1.p1.17.m17.1.2.3.2.2" stretchy="false" xref="S3.SS1.p1.17.m17.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m17.1b"><apply id="S3.SS1.p1.17.m17.1.2.cmml" xref="S3.SS1.p1.17.m17.1.2"><times id="S3.SS1.p1.17.m17.1.2.1.cmml" xref="S3.SS1.p1.17.m17.1.2.1"></times><ci id="S3.SS1.p1.17.m17.1.2.2.cmml" xref="S3.SS1.p1.17.m17.1.2.2">𝑓</ci><ci id="S3.SS1.p1.17.m17.1.1.cmml" xref="S3.SS1.p1.17.m17.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.17.m17.1c">f(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.17.m17.1d">italic_f ( ⋅ )</annotation></semantics></math> that recommends the possible purchase item after the <math alttext="n" class="ltx_Math" display="inline" id="S3.SS1.p1.18.m18.1"><semantics id="S3.SS1.p1.18.m18.1a"><mi id="S3.SS1.p1.18.m18.1.1" xref="S3.SS1.p1.18.m18.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.18.m18.1b"><ci id="S3.SS1.p1.18.m18.1.1.cmml" xref="S3.SS1.p1.18.m18.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.18.m18.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.18.m18.1d">italic_n</annotation></semantics></math>-th item that the user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p1.19.m19.1"><semantics id="S3.SS1.p1.19.m19.1a"><mi id="S3.SS1.p1.19.m19.1.1" xref="S3.SS1.p1.19.m19.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.19.m19.1b"><ci id="S3.SS1.p1.19.m19.1.1.cmml" xref="S3.SS1.p1.19.m19.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.19.m19.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.19.m19.1d">italic_u</annotation></semantics></math> will interact with at time <math alttext="i_{n+1}" class="ltx_Math" display="inline" id="S3.SS1.p1.20.m20.1"><semantics id="S3.SS1.p1.20.m20.1a"><msub id="S3.SS1.p1.20.m20.1.1" xref="S3.SS1.p1.20.m20.1.1.cmml"><mi id="S3.SS1.p1.20.m20.1.1.2" xref="S3.SS1.p1.20.m20.1.1.2.cmml">i</mi><mrow id="S3.SS1.p1.20.m20.1.1.3" xref="S3.SS1.p1.20.m20.1.1.3.cmml"><mi id="S3.SS1.p1.20.m20.1.1.3.2" xref="S3.SS1.p1.20.m20.1.1.3.2.cmml">n</mi><mo id="S3.SS1.p1.20.m20.1.1.3.1" xref="S3.SS1.p1.20.m20.1.1.3.1.cmml">+</mo><mn id="S3.SS1.p1.20.m20.1.1.3.3" xref="S3.SS1.p1.20.m20.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.20.m20.1b"><apply id="S3.SS1.p1.20.m20.1.1.cmml" xref="S3.SS1.p1.20.m20.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.20.m20.1.1.1.cmml" xref="S3.SS1.p1.20.m20.1.1">subscript</csymbol><ci id="S3.SS1.p1.20.m20.1.1.2.cmml" xref="S3.SS1.p1.20.m20.1.1.2">𝑖</ci><apply id="S3.SS1.p1.20.m20.1.1.3.cmml" xref="S3.SS1.p1.20.m20.1.1.3"><plus id="S3.SS1.p1.20.m20.1.1.3.1.cmml" xref="S3.SS1.p1.20.m20.1.1.3.1"></plus><ci id="S3.SS1.p1.20.m20.1.1.3.2.cmml" xref="S3.SS1.p1.20.m20.1.1.3.2">𝑛</ci><cn id="S3.SS1.p1.20.m20.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.20.m20.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.20.m20.1c">i_{n+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.20.m20.1d">italic_i start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT</annotation></semantics></math> given multimodal data from <math alttext="i_{1:n}\in\mathbb{R}^{n\times d}" class="ltx_Math" display="inline" id="S3.SS1.p1.21.m21.1"><semantics id="S3.SS1.p1.21.m21.1a"><mrow id="S3.SS1.p1.21.m21.1.1" xref="S3.SS1.p1.21.m21.1.1.cmml"><msub id="S3.SS1.p1.21.m21.1.1.2" xref="S3.SS1.p1.21.m21.1.1.2.cmml"><mi id="S3.SS1.p1.21.m21.1.1.2.2" xref="S3.SS1.p1.21.m21.1.1.2.2.cmml">i</mi><mrow id="S3.SS1.p1.21.m21.1.1.2.3" xref="S3.SS1.p1.21.m21.1.1.2.3.cmml"><mn id="S3.SS1.p1.21.m21.1.1.2.3.2" xref="S3.SS1.p1.21.m21.1.1.2.3.2.cmml">1</mn><mo id="S3.SS1.p1.21.m21.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.21.m21.1.1.2.3.1.cmml">:</mo><mi id="S3.SS1.p1.21.m21.1.1.2.3.3" xref="S3.SS1.p1.21.m21.1.1.2.3.3.cmml">n</mi></mrow></msub><mo id="S3.SS1.p1.21.m21.1.1.1" xref="S3.SS1.p1.21.m21.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.21.m21.1.1.3" xref="S3.SS1.p1.21.m21.1.1.3.cmml"><mi id="S3.SS1.p1.21.m21.1.1.3.2" xref="S3.SS1.p1.21.m21.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.21.m21.1.1.3.3" xref="S3.SS1.p1.21.m21.1.1.3.3.cmml"><mi id="S3.SS1.p1.21.m21.1.1.3.3.2" xref="S3.SS1.p1.21.m21.1.1.3.3.2.cmml">n</mi><mo id="S3.SS1.p1.21.m21.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.21.m21.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.21.m21.1.1.3.3.3" xref="S3.SS1.p1.21.m21.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.21.m21.1b"><apply id="S3.SS1.p1.21.m21.1.1.cmml" xref="S3.SS1.p1.21.m21.1.1"><in id="S3.SS1.p1.21.m21.1.1.1.cmml" xref="S3.SS1.p1.21.m21.1.1.1"></in><apply id="S3.SS1.p1.21.m21.1.1.2.cmml" xref="S3.SS1.p1.21.m21.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.21.m21.1.1.2.1.cmml" xref="S3.SS1.p1.21.m21.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.21.m21.1.1.2.2.cmml" xref="S3.SS1.p1.21.m21.1.1.2.2">𝑖</ci><apply id="S3.SS1.p1.21.m21.1.1.2.3.cmml" xref="S3.SS1.p1.21.m21.1.1.2.3"><ci id="S3.SS1.p1.21.m21.1.1.2.3.1.cmml" xref="S3.SS1.p1.21.m21.1.1.2.3.1">:</ci><cn id="S3.SS1.p1.21.m21.1.1.2.3.2.cmml" type="integer" xref="S3.SS1.p1.21.m21.1.1.2.3.2">1</cn><ci id="S3.SS1.p1.21.m21.1.1.2.3.3.cmml" xref="S3.SS1.p1.21.m21.1.1.2.3.3">𝑛</ci></apply></apply><apply id="S3.SS1.p1.21.m21.1.1.3.cmml" xref="S3.SS1.p1.21.m21.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.21.m21.1.1.3.1.cmml" xref="S3.SS1.p1.21.m21.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.21.m21.1.1.3.2.cmml" xref="S3.SS1.p1.21.m21.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.21.m21.1.1.3.3.cmml" xref="S3.SS1.p1.21.m21.1.1.3.3"><times id="S3.SS1.p1.21.m21.1.1.3.3.1.cmml" xref="S3.SS1.p1.21.m21.1.1.3.3.1"></times><ci id="S3.SS1.p1.21.m21.1.1.3.3.2.cmml" xref="S3.SS1.p1.21.m21.1.1.3.3.2">𝑛</ci><ci id="S3.SS1.p1.21.m21.1.1.3.3.3.cmml" xref="S3.SS1.p1.21.m21.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.21.m21.1c">i_{1:n}\in\mathbb{R}^{n\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.21.m21.1d">italic_i start_POSTSUBSCRIPT 1 : italic_n end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="v_{1:n}\in\mathbb{R}^{n\times d_{v}}" class="ltx_Math" display="inline" id="S3.SS1.p1.22.m22.1"><semantics id="S3.SS1.p1.22.m22.1a"><mrow id="S3.SS1.p1.22.m22.1.1" xref="S3.SS1.p1.22.m22.1.1.cmml"><msub id="S3.SS1.p1.22.m22.1.1.2" xref="S3.SS1.p1.22.m22.1.1.2.cmml"><mi id="S3.SS1.p1.22.m22.1.1.2.2" xref="S3.SS1.p1.22.m22.1.1.2.2.cmml">v</mi><mrow id="S3.SS1.p1.22.m22.1.1.2.3" xref="S3.SS1.p1.22.m22.1.1.2.3.cmml"><mn id="S3.SS1.p1.22.m22.1.1.2.3.2" xref="S3.SS1.p1.22.m22.1.1.2.3.2.cmml">1</mn><mo id="S3.SS1.p1.22.m22.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.22.m22.1.1.2.3.1.cmml">:</mo><mi id="S3.SS1.p1.22.m22.1.1.2.3.3" xref="S3.SS1.p1.22.m22.1.1.2.3.3.cmml">n</mi></mrow></msub><mo id="S3.SS1.p1.22.m22.1.1.1" xref="S3.SS1.p1.22.m22.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.22.m22.1.1.3" xref="S3.SS1.p1.22.m22.1.1.3.cmml"><mi id="S3.SS1.p1.22.m22.1.1.3.2" xref="S3.SS1.p1.22.m22.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.22.m22.1.1.3.3" xref="S3.SS1.p1.22.m22.1.1.3.3.cmml"><mi id="S3.SS1.p1.22.m22.1.1.3.3.2" xref="S3.SS1.p1.22.m22.1.1.3.3.2.cmml">n</mi><mo id="S3.SS1.p1.22.m22.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.22.m22.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p1.22.m22.1.1.3.3.3" xref="S3.SS1.p1.22.m22.1.1.3.3.3.cmml"><mi id="S3.SS1.p1.22.m22.1.1.3.3.3.2" xref="S3.SS1.p1.22.m22.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS1.p1.22.m22.1.1.3.3.3.3" xref="S3.SS1.p1.22.m22.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.22.m22.1b"><apply id="S3.SS1.p1.22.m22.1.1.cmml" xref="S3.SS1.p1.22.m22.1.1"><in id="S3.SS1.p1.22.m22.1.1.1.cmml" xref="S3.SS1.p1.22.m22.1.1.1"></in><apply id="S3.SS1.p1.22.m22.1.1.2.cmml" xref="S3.SS1.p1.22.m22.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.22.m22.1.1.2.1.cmml" xref="S3.SS1.p1.22.m22.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.22.m22.1.1.2.2.cmml" xref="S3.SS1.p1.22.m22.1.1.2.2">𝑣</ci><apply id="S3.SS1.p1.22.m22.1.1.2.3.cmml" xref="S3.SS1.p1.22.m22.1.1.2.3"><ci id="S3.SS1.p1.22.m22.1.1.2.3.1.cmml" xref="S3.SS1.p1.22.m22.1.1.2.3.1">:</ci><cn id="S3.SS1.p1.22.m22.1.1.2.3.2.cmml" type="integer" xref="S3.SS1.p1.22.m22.1.1.2.3.2">1</cn><ci id="S3.SS1.p1.22.m22.1.1.2.3.3.cmml" xref="S3.SS1.p1.22.m22.1.1.2.3.3">𝑛</ci></apply></apply><apply id="S3.SS1.p1.22.m22.1.1.3.cmml" xref="S3.SS1.p1.22.m22.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.22.m22.1.1.3.1.cmml" xref="S3.SS1.p1.22.m22.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.22.m22.1.1.3.2.cmml" xref="S3.SS1.p1.22.m22.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.22.m22.1.1.3.3.cmml" xref="S3.SS1.p1.22.m22.1.1.3.3"><times id="S3.SS1.p1.22.m22.1.1.3.3.1.cmml" xref="S3.SS1.p1.22.m22.1.1.3.3.1"></times><ci id="S3.SS1.p1.22.m22.1.1.3.3.2.cmml" xref="S3.SS1.p1.22.m22.1.1.3.3.2">𝑛</ci><apply id="S3.SS1.p1.22.m22.1.1.3.3.3.cmml" xref="S3.SS1.p1.22.m22.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.22.m22.1.1.3.3.3.1.cmml" xref="S3.SS1.p1.22.m22.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.22.m22.1.1.3.3.3.2.cmml" xref="S3.SS1.p1.22.m22.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS1.p1.22.m22.1.1.3.3.3.3.cmml" xref="S3.SS1.p1.22.m22.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.22.m22.1c">v_{1:n}\in\mathbb{R}^{n\times d_{v}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.22.m22.1d">italic_v start_POSTSUBSCRIPT 1 : italic_n end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="t_{1:n}\in\mathbb{R}^{n\times d_{t}}" class="ltx_Math" display="inline" id="S3.SS1.p1.23.m23.1"><semantics id="S3.SS1.p1.23.m23.1a"><mrow id="S3.SS1.p1.23.m23.1.1" xref="S3.SS1.p1.23.m23.1.1.cmml"><msub id="S3.SS1.p1.23.m23.1.1.2" xref="S3.SS1.p1.23.m23.1.1.2.cmml"><mi id="S3.SS1.p1.23.m23.1.1.2.2" xref="S3.SS1.p1.23.m23.1.1.2.2.cmml">t</mi><mrow id="S3.SS1.p1.23.m23.1.1.2.3" xref="S3.SS1.p1.23.m23.1.1.2.3.cmml"><mn id="S3.SS1.p1.23.m23.1.1.2.3.2" xref="S3.SS1.p1.23.m23.1.1.2.3.2.cmml">1</mn><mo id="S3.SS1.p1.23.m23.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.23.m23.1.1.2.3.1.cmml">:</mo><mi id="S3.SS1.p1.23.m23.1.1.2.3.3" xref="S3.SS1.p1.23.m23.1.1.2.3.3.cmml">n</mi></mrow></msub><mo id="S3.SS1.p1.23.m23.1.1.1" xref="S3.SS1.p1.23.m23.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.23.m23.1.1.3" xref="S3.SS1.p1.23.m23.1.1.3.cmml"><mi id="S3.SS1.p1.23.m23.1.1.3.2" xref="S3.SS1.p1.23.m23.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.23.m23.1.1.3.3" xref="S3.SS1.p1.23.m23.1.1.3.3.cmml"><mi id="S3.SS1.p1.23.m23.1.1.3.3.2" xref="S3.SS1.p1.23.m23.1.1.3.3.2.cmml">n</mi><mo id="S3.SS1.p1.23.m23.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.23.m23.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p1.23.m23.1.1.3.3.3" xref="S3.SS1.p1.23.m23.1.1.3.3.3.cmml"><mi id="S3.SS1.p1.23.m23.1.1.3.3.3.2" xref="S3.SS1.p1.23.m23.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS1.p1.23.m23.1.1.3.3.3.3" xref="S3.SS1.p1.23.m23.1.1.3.3.3.3.cmml">t</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.23.m23.1b"><apply id="S3.SS1.p1.23.m23.1.1.cmml" xref="S3.SS1.p1.23.m23.1.1"><in id="S3.SS1.p1.23.m23.1.1.1.cmml" xref="S3.SS1.p1.23.m23.1.1.1"></in><apply id="S3.SS1.p1.23.m23.1.1.2.cmml" xref="S3.SS1.p1.23.m23.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.23.m23.1.1.2.1.cmml" xref="S3.SS1.p1.23.m23.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.23.m23.1.1.2.2.cmml" xref="S3.SS1.p1.23.m23.1.1.2.2">𝑡</ci><apply id="S3.SS1.p1.23.m23.1.1.2.3.cmml" xref="S3.SS1.p1.23.m23.1.1.2.3"><ci id="S3.SS1.p1.23.m23.1.1.2.3.1.cmml" xref="S3.SS1.p1.23.m23.1.1.2.3.1">:</ci><cn id="S3.SS1.p1.23.m23.1.1.2.3.2.cmml" type="integer" xref="S3.SS1.p1.23.m23.1.1.2.3.2">1</cn><ci id="S3.SS1.p1.23.m23.1.1.2.3.3.cmml" xref="S3.SS1.p1.23.m23.1.1.2.3.3">𝑛</ci></apply></apply><apply id="S3.SS1.p1.23.m23.1.1.3.cmml" xref="S3.SS1.p1.23.m23.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.23.m23.1.1.3.1.cmml" xref="S3.SS1.p1.23.m23.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.23.m23.1.1.3.2.cmml" xref="S3.SS1.p1.23.m23.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.23.m23.1.1.3.3.cmml" xref="S3.SS1.p1.23.m23.1.1.3.3"><times id="S3.SS1.p1.23.m23.1.1.3.3.1.cmml" xref="S3.SS1.p1.23.m23.1.1.3.3.1"></times><ci id="S3.SS1.p1.23.m23.1.1.3.3.2.cmml" xref="S3.SS1.p1.23.m23.1.1.3.3.2">𝑛</ci><apply id="S3.SS1.p1.23.m23.1.1.3.3.3.cmml" xref="S3.SS1.p1.23.m23.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.23.m23.1.1.3.3.3.1.cmml" xref="S3.SS1.p1.23.m23.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.23.m23.1.1.3.3.3.2.cmml" xref="S3.SS1.p1.23.m23.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS1.p1.23.m23.1.1.3.3.3.3.cmml" xref="S3.SS1.p1.23.m23.1.1.3.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.23.m23.1c">t_{1:n}\in\mathbb{R}^{n\times d_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.23.m23.1d">italic_t start_POSTSUBSCRIPT 1 : italic_n end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="c_{1:n}\in\mathbb{R}^{n\times d_{c}}" class="ltx_Math" display="inline" id="S3.SS1.p1.24.m24.1"><semantics id="S3.SS1.p1.24.m24.1a"><mrow id="S3.SS1.p1.24.m24.1.1" xref="S3.SS1.p1.24.m24.1.1.cmml"><msub id="S3.SS1.p1.24.m24.1.1.2" xref="S3.SS1.p1.24.m24.1.1.2.cmml"><mi id="S3.SS1.p1.24.m24.1.1.2.2" xref="S3.SS1.p1.24.m24.1.1.2.2.cmml">c</mi><mrow id="S3.SS1.p1.24.m24.1.1.2.3" xref="S3.SS1.p1.24.m24.1.1.2.3.cmml"><mn id="S3.SS1.p1.24.m24.1.1.2.3.2" xref="S3.SS1.p1.24.m24.1.1.2.3.2.cmml">1</mn><mo id="S3.SS1.p1.24.m24.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.24.m24.1.1.2.3.1.cmml">:</mo><mi id="S3.SS1.p1.24.m24.1.1.2.3.3" xref="S3.SS1.p1.24.m24.1.1.2.3.3.cmml">n</mi></mrow></msub><mo id="S3.SS1.p1.24.m24.1.1.1" xref="S3.SS1.p1.24.m24.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.24.m24.1.1.3" xref="S3.SS1.p1.24.m24.1.1.3.cmml"><mi id="S3.SS1.p1.24.m24.1.1.3.2" xref="S3.SS1.p1.24.m24.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.24.m24.1.1.3.3" xref="S3.SS1.p1.24.m24.1.1.3.3.cmml"><mi id="S3.SS1.p1.24.m24.1.1.3.3.2" xref="S3.SS1.p1.24.m24.1.1.3.3.2.cmml">n</mi><mo id="S3.SS1.p1.24.m24.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.24.m24.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p1.24.m24.1.1.3.3.3" xref="S3.SS1.p1.24.m24.1.1.3.3.3.cmml"><mi id="S3.SS1.p1.24.m24.1.1.3.3.3.2" xref="S3.SS1.p1.24.m24.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS1.p1.24.m24.1.1.3.3.3.3" xref="S3.SS1.p1.24.m24.1.1.3.3.3.3.cmml">c</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.24.m24.1b"><apply id="S3.SS1.p1.24.m24.1.1.cmml" xref="S3.SS1.p1.24.m24.1.1"><in id="S3.SS1.p1.24.m24.1.1.1.cmml" xref="S3.SS1.p1.24.m24.1.1.1"></in><apply id="S3.SS1.p1.24.m24.1.1.2.cmml" xref="S3.SS1.p1.24.m24.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.24.m24.1.1.2.1.cmml" xref="S3.SS1.p1.24.m24.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.24.m24.1.1.2.2.cmml" xref="S3.SS1.p1.24.m24.1.1.2.2">𝑐</ci><apply id="S3.SS1.p1.24.m24.1.1.2.3.cmml" xref="S3.SS1.p1.24.m24.1.1.2.3"><ci id="S3.SS1.p1.24.m24.1.1.2.3.1.cmml" xref="S3.SS1.p1.24.m24.1.1.2.3.1">:</ci><cn id="S3.SS1.p1.24.m24.1.1.2.3.2.cmml" type="integer" xref="S3.SS1.p1.24.m24.1.1.2.3.2">1</cn><ci id="S3.SS1.p1.24.m24.1.1.2.3.3.cmml" xref="S3.SS1.p1.24.m24.1.1.2.3.3">𝑛</ci></apply></apply><apply id="S3.SS1.p1.24.m24.1.1.3.cmml" xref="S3.SS1.p1.24.m24.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.24.m24.1.1.3.1.cmml" xref="S3.SS1.p1.24.m24.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.24.m24.1.1.3.2.cmml" xref="S3.SS1.p1.24.m24.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.24.m24.1.1.3.3.cmml" xref="S3.SS1.p1.24.m24.1.1.3.3"><times id="S3.SS1.p1.24.m24.1.1.3.3.1.cmml" xref="S3.SS1.p1.24.m24.1.1.3.3.1"></times><ci id="S3.SS1.p1.24.m24.1.1.3.3.2.cmml" xref="S3.SS1.p1.24.m24.1.1.3.3.2">𝑛</ci><apply id="S3.SS1.p1.24.m24.1.1.3.3.3.cmml" xref="S3.SS1.p1.24.m24.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.24.m24.1.1.3.3.3.1.cmml" xref="S3.SS1.p1.24.m24.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.24.m24.1.1.3.3.3.2.cmml" xref="S3.SS1.p1.24.m24.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS1.p1.24.m24.1.1.3.3.3.3.cmml" xref="S3.SS1.p1.24.m24.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.24.m24.1c">c_{1:n}\in\mathbb{R}^{n\times d_{c}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.24.m24.1d">italic_c start_POSTSUBSCRIPT 1 : italic_n end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> as shown in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S3.E1" title="Equation 1 ‣ 3.1 Task definition and overall framework ‣ 3 Proposed method ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">1</span></a>.
Here, <math alttext="d" class="ltx_Math" display="inline" id="S3.SS1.p1.25.m25.1"><semantics id="S3.SS1.p1.25.m25.1a"><mi id="S3.SS1.p1.25.m25.1.1" xref="S3.SS1.p1.25.m25.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.25.m25.1b"><ci id="S3.SS1.p1.25.m25.1.1.cmml" xref="S3.SS1.p1.25.m25.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.25.m25.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.25.m25.1d">italic_d</annotation></semantics></math> indicates the latent (hidden) size of item ID, and <math alttext="d_{v},d_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.26.m26.2"><semantics id="S3.SS1.p1.26.m26.2a"><mrow id="S3.SS1.p1.26.m26.2.2.2" xref="S3.SS1.p1.26.m26.2.2.3.cmml"><msub id="S3.SS1.p1.26.m26.1.1.1.1" xref="S3.SS1.p1.26.m26.1.1.1.1.cmml"><mi id="S3.SS1.p1.26.m26.1.1.1.1.2" xref="S3.SS1.p1.26.m26.1.1.1.1.2.cmml">d</mi><mi id="S3.SS1.p1.26.m26.1.1.1.1.3" xref="S3.SS1.p1.26.m26.1.1.1.1.3.cmml">v</mi></msub><mo id="S3.SS1.p1.26.m26.2.2.2.3" xref="S3.SS1.p1.26.m26.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.26.m26.2.2.2.2" xref="S3.SS1.p1.26.m26.2.2.2.2.cmml"><mi id="S3.SS1.p1.26.m26.2.2.2.2.2" xref="S3.SS1.p1.26.m26.2.2.2.2.2.cmml">d</mi><mi id="S3.SS1.p1.26.m26.2.2.2.2.3" xref="S3.SS1.p1.26.m26.2.2.2.2.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.26.m26.2b"><list id="S3.SS1.p1.26.m26.2.2.3.cmml" xref="S3.SS1.p1.26.m26.2.2.2"><apply id="S3.SS1.p1.26.m26.1.1.1.1.cmml" xref="S3.SS1.p1.26.m26.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.26.m26.1.1.1.1.1.cmml" xref="S3.SS1.p1.26.m26.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.26.m26.1.1.1.1.2.cmml" xref="S3.SS1.p1.26.m26.1.1.1.1.2">𝑑</ci><ci id="S3.SS1.p1.26.m26.1.1.1.1.3.cmml" xref="S3.SS1.p1.26.m26.1.1.1.1.3">𝑣</ci></apply><apply id="S3.SS1.p1.26.m26.2.2.2.2.cmml" xref="S3.SS1.p1.26.m26.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.26.m26.2.2.2.2.1.cmml" xref="S3.SS1.p1.26.m26.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.26.m26.2.2.2.2.2.cmml" xref="S3.SS1.p1.26.m26.2.2.2.2.2">𝑑</ci><ci id="S3.SS1.p1.26.m26.2.2.2.2.3.cmml" xref="S3.SS1.p1.26.m26.2.2.2.2.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.26.m26.2c">d_{v},d_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.26.m26.2d">italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT , italic_d start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="d_{c}" class="ltx_Math" display="inline" id="S3.SS1.p1.27.m27.1"><semantics id="S3.SS1.p1.27.m27.1a"><msub id="S3.SS1.p1.27.m27.1.1" xref="S3.SS1.p1.27.m27.1.1.cmml"><mi id="S3.SS1.p1.27.m27.1.1.2" xref="S3.SS1.p1.27.m27.1.1.2.cmml">d</mi><mi id="S3.SS1.p1.27.m27.1.1.3" xref="S3.SS1.p1.27.m27.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.27.m27.1b"><apply id="S3.SS1.p1.27.m27.1.1.cmml" xref="S3.SS1.p1.27.m27.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.27.m27.1.1.1.cmml" xref="S3.SS1.p1.27.m27.1.1">subscript</csymbol><ci id="S3.SS1.p1.27.m27.1.1.2.cmml" xref="S3.SS1.p1.27.m27.1.1.2">𝑑</ci><ci id="S3.SS1.p1.27.m27.1.1.3.cmml" xref="S3.SS1.p1.27.m27.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.27.m27.1c">d_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.27.m27.1d">italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> denotes the latent size of each multimodal piece of information.
The overall model structure is illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S3.F2" title="Figure 2 ‣ 3.1 Task definition and overall framework ‣ 3 Proposed method ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">2</span></a> and comprises three main modules: <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.27.1">Embedding module, Multimodal fusion module, Prediction module</span>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="f(i_{1:n},v_{1:n},t_{1:n},c_{1:n})\to i_{n+1}" class="ltx_Math" display="block" id="S3.E1.m1.4"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml"><mrow id="S3.E1.m1.4.4.4" xref="S3.E1.m1.4.4.4.cmml"><mi id="S3.E1.m1.4.4.4.6" xref="S3.E1.m1.4.4.4.6.cmml">f</mi><mo id="S3.E1.m1.4.4.4.5" xref="S3.E1.m1.4.4.4.5.cmml">⁢</mo><mrow id="S3.E1.m1.4.4.4.4.4" xref="S3.E1.m1.4.4.4.4.5.cmml"><mo id="S3.E1.m1.4.4.4.4.4.5" stretchy="false" xref="S3.E1.m1.4.4.4.4.5.cmml">(</mo><msub id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml">i</mi><mrow id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml"><mn id="S3.E1.m1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S3.E1.m1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E1.m1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S3.E1.m1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.3.3.cmml">n</mi></mrow></msub><mo id="S3.E1.m1.4.4.4.4.4.6" xref="S3.E1.m1.4.4.4.4.5.cmml">,</mo><msub id="S3.E1.m1.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.2.cmml">v</mi><mrow id="S3.E1.m1.2.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.2.2.3.cmml"><mn id="S3.E1.m1.2.2.2.2.2.2.3.2" xref="S3.E1.m1.2.2.2.2.2.2.3.2.cmml">1</mn><mo id="S3.E1.m1.2.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E1.m1.2.2.2.2.2.2.3.1.cmml">:</mo><mi id="S3.E1.m1.2.2.2.2.2.2.3.3" xref="S3.E1.m1.2.2.2.2.2.2.3.3.cmml">n</mi></mrow></msub><mo id="S3.E1.m1.4.4.4.4.4.7" xref="S3.E1.m1.4.4.4.4.5.cmml">,</mo><msub id="S3.E1.m1.3.3.3.3.3.3" xref="S3.E1.m1.3.3.3.3.3.3.cmml"><mi id="S3.E1.m1.3.3.3.3.3.3.2" xref="S3.E1.m1.3.3.3.3.3.3.2.cmml">t</mi><mrow id="S3.E1.m1.3.3.3.3.3.3.3" xref="S3.E1.m1.3.3.3.3.3.3.3.cmml"><mn id="S3.E1.m1.3.3.3.3.3.3.3.2" xref="S3.E1.m1.3.3.3.3.3.3.3.2.cmml">1</mn><mo id="S3.E1.m1.3.3.3.3.3.3.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E1.m1.3.3.3.3.3.3.3.1.cmml">:</mo><mi id="S3.E1.m1.3.3.3.3.3.3.3.3" xref="S3.E1.m1.3.3.3.3.3.3.3.3.cmml">n</mi></mrow></msub><mo id="S3.E1.m1.4.4.4.4.4.8" xref="S3.E1.m1.4.4.4.4.5.cmml">,</mo><msub id="S3.E1.m1.4.4.4.4.4.4" xref="S3.E1.m1.4.4.4.4.4.4.cmml"><mi id="S3.E1.m1.4.4.4.4.4.4.2" xref="S3.E1.m1.4.4.4.4.4.4.2.cmml">c</mi><mrow id="S3.E1.m1.4.4.4.4.4.4.3" xref="S3.E1.m1.4.4.4.4.4.4.3.cmml"><mn id="S3.E1.m1.4.4.4.4.4.4.3.2" xref="S3.E1.m1.4.4.4.4.4.4.3.2.cmml">1</mn><mo id="S3.E1.m1.4.4.4.4.4.4.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E1.m1.4.4.4.4.4.4.3.1.cmml">:</mo><mi id="S3.E1.m1.4.4.4.4.4.4.3.3" xref="S3.E1.m1.4.4.4.4.4.4.3.3.cmml">n</mi></mrow></msub><mo id="S3.E1.m1.4.4.4.4.4.9" stretchy="false" xref="S3.E1.m1.4.4.4.4.5.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.4.5" stretchy="false" xref="S3.E1.m1.4.4.5.cmml">→</mo><msub id="S3.E1.m1.4.4.6" xref="S3.E1.m1.4.4.6.cmml"><mi id="S3.E1.m1.4.4.6.2" xref="S3.E1.m1.4.4.6.2.cmml">i</mi><mrow id="S3.E1.m1.4.4.6.3" xref="S3.E1.m1.4.4.6.3.cmml"><mi id="S3.E1.m1.4.4.6.3.2" xref="S3.E1.m1.4.4.6.3.2.cmml">n</mi><mo id="S3.E1.m1.4.4.6.3.1" xref="S3.E1.m1.4.4.6.3.1.cmml">+</mo><mn id="S3.E1.m1.4.4.6.3.3" xref="S3.E1.m1.4.4.6.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4"><ci id="S3.E1.m1.4.4.5.cmml" xref="S3.E1.m1.4.4.5">→</ci><apply id="S3.E1.m1.4.4.4.cmml" xref="S3.E1.m1.4.4.4"><times id="S3.E1.m1.4.4.4.5.cmml" xref="S3.E1.m1.4.4.4.5"></times><ci id="S3.E1.m1.4.4.4.6.cmml" xref="S3.E1.m1.4.4.4.6">𝑓</ci><vector id="S3.E1.m1.4.4.4.4.5.cmml" xref="S3.E1.m1.4.4.4.4.4"><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2">𝑖</ci><apply id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3"><ci id="S3.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.1">:</ci><cn id="S3.E1.m1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.1.1.3.2">1</cn><ci id="S3.E1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3">𝑛</ci></apply></apply><apply id="S3.E1.m1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.2">𝑣</ci><apply id="S3.E1.m1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.3"><ci id="S3.E1.m1.2.2.2.2.2.2.3.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.3.1">:</ci><cn id="S3.E1.m1.2.2.2.2.2.2.3.2.cmml" type="integer" xref="S3.E1.m1.2.2.2.2.2.2.3.2">1</cn><ci id="S3.E1.m1.2.2.2.2.2.2.3.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.3.3">𝑛</ci></apply></apply><apply id="S3.E1.m1.3.3.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.3.3.3.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3">subscript</csymbol><ci id="S3.E1.m1.3.3.3.3.3.3.2.cmml" xref="S3.E1.m1.3.3.3.3.3.3.2">𝑡</ci><apply id="S3.E1.m1.3.3.3.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3.3"><ci id="S3.E1.m1.3.3.3.3.3.3.3.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.3.1">:</ci><cn id="S3.E1.m1.3.3.3.3.3.3.3.2.cmml" type="integer" xref="S3.E1.m1.3.3.3.3.3.3.3.2">1</cn><ci id="S3.E1.m1.3.3.3.3.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3.3.3">𝑛</ci></apply></apply><apply id="S3.E1.m1.4.4.4.4.4.4.cmml" xref="S3.E1.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.4.4.4.1.cmml" xref="S3.E1.m1.4.4.4.4.4.4">subscript</csymbol><ci id="S3.E1.m1.4.4.4.4.4.4.2.cmml" xref="S3.E1.m1.4.4.4.4.4.4.2">𝑐</ci><apply id="S3.E1.m1.4.4.4.4.4.4.3.cmml" xref="S3.E1.m1.4.4.4.4.4.4.3"><ci id="S3.E1.m1.4.4.4.4.4.4.3.1.cmml" xref="S3.E1.m1.4.4.4.4.4.4.3.1">:</ci><cn id="S3.E1.m1.4.4.4.4.4.4.3.2.cmml" type="integer" xref="S3.E1.m1.4.4.4.4.4.4.3.2">1</cn><ci id="S3.E1.m1.4.4.4.4.4.4.3.3.cmml" xref="S3.E1.m1.4.4.4.4.4.4.3.3">𝑛</ci></apply></apply></vector></apply><apply id="S3.E1.m1.4.4.6.cmml" xref="S3.E1.m1.4.4.6"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.6.1.cmml" xref="S3.E1.m1.4.4.6">subscript</csymbol><ci id="S3.E1.m1.4.4.6.2.cmml" xref="S3.E1.m1.4.4.6.2">𝑖</ci><apply id="S3.E1.m1.4.4.6.3.cmml" xref="S3.E1.m1.4.4.6.3"><plus id="S3.E1.m1.4.4.6.3.1.cmml" xref="S3.E1.m1.4.4.6.3.1"></plus><ci id="S3.E1.m1.4.4.6.3.2.cmml" xref="S3.E1.m1.4.4.6.3.2">𝑛</ci><cn id="S3.E1.m1.4.4.6.3.3.cmml" type="integer" xref="S3.E1.m1.4.4.6.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">f(i_{1:n},v_{1:n},t_{1:n},c_{1:n})\to i_{n+1}</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.4d">italic_f ( italic_i start_POSTSUBSCRIPT 1 : italic_n end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 1 : italic_n end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT 1 : italic_n end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT 1 : italic_n end_POSTSUBSCRIPT ) → italic_i start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Embedding module</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.8">The embedding module extracts the embedding vector for each data point from the input sequence of the user.
To use multimodal data, image and text features are extracted using a pre-trained VGG network, denoted as <math alttext="v_{i}\in\mathbb{R}^{1\times d_{v}}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><msub id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2.2" xref="S3.SS2.p1.1.m1.1.1.2.2.cmml">v</mi><mi id="S3.SS2.p1.1.m1.1.1.2.3" xref="S3.SS2.p1.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml"><mn id="S3.SS2.p1.1.m1.1.1.3.3.2" xref="S3.SS2.p1.1.m1.1.1.3.3.2.cmml">1</mn><mo id="S3.SS2.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.p1.1.m1.1.1.3.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.3.3.2" xref="S3.SS2.p1.1.m1.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS2.p1.1.m1.1.1.3.3.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><in id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"></in><apply id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2.2">𝑣</ci><ci id="S3.SS2.p1.1.m1.1.1.2.3.cmml" xref="S3.SS2.p1.1.m1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3"><times id="S3.SS2.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.1"></times><cn id="S3.SS2.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S3.SS2.p1.1.m1.1.1.3.3.2">1</cn><apply id="S3.SS2.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.p1.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">v_{i}\in\mathbb{R}^{1\times d_{v}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 1 × italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and a pre-trained BERT network, denoted as <math alttext="t_{i}\in\mathbb{R}^{1\times d_{t}}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><msub id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2.2" xref="S3.SS2.p1.2.m2.1.1.2.2.cmml">t</mi><mi id="S3.SS2.p1.2.m2.1.1.2.3" xref="S3.SS2.p1.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.2.m2.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.cmml"><mn id="S3.SS2.p1.2.m2.1.1.3.3.2" xref="S3.SS2.p1.2.m2.1.1.3.3.2.cmml">1</mn><mo id="S3.SS2.p1.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.2.m2.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.p1.2.m2.1.1.3.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.3.3.2" xref="S3.SS2.p1.2.m2.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS2.p1.2.m2.1.1.3.3.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.3.3.cmml">t</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><in id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1"></in><apply id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2">𝑡</ci><ci id="S3.SS2.p1.2.m2.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3"><times id="S3.SS2.p1.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3.1"></times><cn id="S3.SS2.p1.2.m2.1.1.3.3.2.cmml" type="integer" xref="S3.SS2.p1.2.m2.1.1.3.3.2">1</cn><apply id="S3.SS2.p1.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.3.3.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.3.3.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.p1.2.m2.1.1.3.3.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">t_{i}\in\mathbb{R}^{1\times d_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 1 × italic_d start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, respectively.
Subsequently, the category is transformed into a multi-label form, denoted as <math alttext="c_{i}\in\mathbb{R}^{1\times d_{c}}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><msub id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2.2" xref="S3.SS2.p1.3.m3.1.1.2.2.cmml">c</mi><mi id="S3.SS2.p1.3.m3.1.1.2.3" xref="S3.SS2.p1.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.3.m3.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml"><mi id="S3.SS2.p1.3.m3.1.1.3.2" xref="S3.SS2.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.3.m3.1.1.3.3" xref="S3.SS2.p1.3.m3.1.1.3.3.cmml"><mn id="S3.SS2.p1.3.m3.1.1.3.3.2" xref="S3.SS2.p1.3.m3.1.1.3.3.2.cmml">1</mn><mo id="S3.SS2.p1.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.3.m3.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.p1.3.m3.1.1.3.3.3" xref="S3.SS2.p1.3.m3.1.1.3.3.3.cmml"><mi id="S3.SS2.p1.3.m3.1.1.3.3.3.2" xref="S3.SS2.p1.3.m3.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS2.p1.3.m3.1.1.3.3.3.3" xref="S3.SS2.p1.3.m3.1.1.3.3.3.3.cmml">c</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><in id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1"></in><apply id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.2.1.cmml" xref="S3.SS2.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2.2">𝑐</ci><ci id="S3.SS2.p1.3.m3.1.1.2.3.cmml" xref="S3.SS2.p1.3.m3.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.3.1.cmml" xref="S3.SS2.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.3.2.cmml" xref="S3.SS2.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.3.m3.1.1.3.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3"><times id="S3.SS2.p1.3.m3.1.1.3.3.1.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.1"></times><cn id="S3.SS2.p1.3.m3.1.1.3.3.2.cmml" type="integer" xref="S3.SS2.p1.3.m3.1.1.3.3.2">1</cn><apply id="S3.SS2.p1.3.m3.1.1.3.3.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.3.3.3.1.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.3.3.3.2.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.p1.3.m3.1.1.3.3.3.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">c_{i}\in\mathbb{R}^{1\times d_{c}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 1 × italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.
Because each user has different interaction times with items, the data is pre-processed using a fixed length <math alttext="n" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_n</annotation></semantics></math> for a neural network.
If the length of the sequence is less than <math alttext="n" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">italic_n</annotation></semantics></math>, it replaces the value with padding; otherwise, it is truncated by <math alttext="n" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><mi id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">italic_n</annotation></semantics></math>.
The user item embeddings <math alttext="E_{ID}" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m7.1"><semantics id="S3.SS2.p1.7.m7.1a"><msub id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">E</mi><mrow id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml"><mi id="S3.SS2.p1.7.m7.1.1.3.2" xref="S3.SS2.p1.7.m7.1.1.3.2.cmml">I</mi><mo id="S3.SS2.p1.7.m7.1.1.3.1" xref="S3.SS2.p1.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.7.m7.1.1.3.3" xref="S3.SS2.p1.7.m7.1.1.3.3.cmml">D</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2">𝐸</ci><apply id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3"><times id="S3.SS2.p1.7.m7.1.1.3.1.cmml" xref="S3.SS2.p1.7.m7.1.1.3.1"></times><ci id="S3.SS2.p1.7.m7.1.1.3.2.cmml" xref="S3.SS2.p1.7.m7.1.1.3.2">𝐼</ci><ci id="S3.SS2.p1.7.m7.1.1.3.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">E_{ID}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.1d">italic_E start_POSTSUBSCRIPT italic_I italic_D end_POSTSUBSCRIPT</annotation></semantics></math> and multimodal data embeddings <math alttext="E_{v},E_{t},E_{c}" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m8.3"><semantics id="S3.SS2.p1.8.m8.3a"><mrow id="S3.SS2.p1.8.m8.3.3.3" xref="S3.SS2.p1.8.m8.3.3.4.cmml"><msub id="S3.SS2.p1.8.m8.1.1.1.1" xref="S3.SS2.p1.8.m8.1.1.1.1.cmml"><mi id="S3.SS2.p1.8.m8.1.1.1.1.2" xref="S3.SS2.p1.8.m8.1.1.1.1.2.cmml">E</mi><mi id="S3.SS2.p1.8.m8.1.1.1.1.3" xref="S3.SS2.p1.8.m8.1.1.1.1.3.cmml">v</mi></msub><mo id="S3.SS2.p1.8.m8.3.3.3.4" xref="S3.SS2.p1.8.m8.3.3.4.cmml">,</mo><msub id="S3.SS2.p1.8.m8.2.2.2.2" xref="S3.SS2.p1.8.m8.2.2.2.2.cmml"><mi id="S3.SS2.p1.8.m8.2.2.2.2.2" xref="S3.SS2.p1.8.m8.2.2.2.2.2.cmml">E</mi><mi id="S3.SS2.p1.8.m8.2.2.2.2.3" xref="S3.SS2.p1.8.m8.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS2.p1.8.m8.3.3.3.5" xref="S3.SS2.p1.8.m8.3.3.4.cmml">,</mo><msub id="S3.SS2.p1.8.m8.3.3.3.3" xref="S3.SS2.p1.8.m8.3.3.3.3.cmml"><mi id="S3.SS2.p1.8.m8.3.3.3.3.2" xref="S3.SS2.p1.8.m8.3.3.3.3.2.cmml">E</mi><mi id="S3.SS2.p1.8.m8.3.3.3.3.3" xref="S3.SS2.p1.8.m8.3.3.3.3.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.3b"><list id="S3.SS2.p1.8.m8.3.3.4.cmml" xref="S3.SS2.p1.8.m8.3.3.3"><apply id="S3.SS2.p1.8.m8.1.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.2">𝐸</ci><ci id="S3.SS2.p1.8.m8.1.1.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.3">𝑣</ci></apply><apply id="S3.SS2.p1.8.m8.2.2.2.2.cmml" xref="S3.SS2.p1.8.m8.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.2.2.2.2.1.cmml" xref="S3.SS2.p1.8.m8.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.8.m8.2.2.2.2.2.cmml" xref="S3.SS2.p1.8.m8.2.2.2.2.2">𝐸</ci><ci id="S3.SS2.p1.8.m8.2.2.2.2.3.cmml" xref="S3.SS2.p1.8.m8.2.2.2.2.3">𝑡</ci></apply><apply id="S3.SS2.p1.8.m8.3.3.3.3.cmml" xref="S3.SS2.p1.8.m8.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.3.3.3.3.1.cmml" xref="S3.SS2.p1.8.m8.3.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.8.m8.3.3.3.3.2.cmml" xref="S3.SS2.p1.8.m8.3.3.3.3.2">𝐸</ci><ci id="S3.SS2.p1.8.m8.3.3.3.3.3.cmml" xref="S3.SS2.p1.8.m8.3.3.3.3.3">𝑐</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.3c">E_{v},E_{t},E_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m8.3d">italic_E start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT , italic_E start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_E start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> are obtained via the embedding module and can be represented by Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S3.E2" title="Equation 2 ‣ 3.2 Embedding module ‣ 3 Proposed method ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\begin{split}E_{ID}&amp;=\mathrm{concat}([i_{1},i_{2},\cdots,i_{n}])\\
E_{v}&amp;=\mathrm{concat}([v_{1},v_{2},\cdots,v_{n}])\\
E_{t}&amp;=\mathrm{concat}([t_{1},t_{2},\cdots,t_{n}])\\
E_{c}&amp;=\mathrm{concat}([c_{1},c_{2},\cdots,c_{n}])\end{split}" class="ltx_Math" display="block" id="S3.E2.m1.80"><semantics id="S3.E2.m1.80a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E2.m1.80.80.8" rowspacing="0pt" xref="S3.E2.m1.76.76.4.cmml"><mtr id="S3.E2.m1.80.80.8a" xref="S3.E2.m1.76.76.4.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E2.m1.80.80.8b" xref="S3.E2.m1.76.76.4.cmml"><msub id="S3.E2.m1.2.2.2.2.2" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml">E</mi><mrow id="S3.E2.m1.2.2.2.2.2.2.1" xref="S3.E2.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.1.2" xref="S3.E2.m1.2.2.2.2.2.2.1.2.cmml">I</mi><mo id="S3.E2.m1.2.2.2.2.2.2.1.1" xref="S3.E2.m1.2.2.2.2.2.2.1.1.cmml">⁢</mo><mi id="S3.E2.m1.2.2.2.2.2.2.1.3" xref="S3.E2.m1.2.2.2.2.2.2.1.3.cmml">D</mi></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E2.m1.80.80.8c" xref="S3.E2.m1.76.76.4.cmml"><mrow id="S3.E2.m1.77.77.5.73.19.17" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.77.77.5.73.19.17.18" xref="S3.E2.m1.76.76.4a.cmml"></mi><mo id="S3.E2.m1.3.3.3.3.1.1" xref="S3.E2.m1.3.3.3.3.1.1.cmml">=</mo><mrow id="S3.E2.m1.77.77.5.73.19.17.17" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.4.4.4.4.2.2" xref="S3.E2.m1.4.4.4.4.2.2.cmml">concat</mi><mo id="S3.E2.m1.77.77.5.73.19.17.17.2" xref="S3.E2.m1.76.76.4a.cmml">⁢</mo><mrow id="S3.E2.m1.77.77.5.73.19.17.17.1.1" xref="S3.E2.m1.76.76.4.cmml"><mo id="S3.E2.m1.5.5.5.5.3.3" stretchy="false" xref="S3.E2.m1.76.76.4a.cmml">(</mo><mrow id="S3.E2.m1.77.77.5.73.19.17.17.1.1.1" xref="S3.E2.m1.76.76.4.cmml"><mo id="S3.E2.m1.6.6.6.6.4.4" stretchy="false" xref="S3.E2.m1.76.76.4a.cmml">[</mo><msub id="S3.E2.m1.77.77.5.73.19.17.17.1.1.1.1.1" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.7.7.7.7.5.5" xref="S3.E2.m1.7.7.7.7.5.5.cmml">i</mi><mn id="S3.E2.m1.8.8.8.8.6.6.1" xref="S3.E2.m1.8.8.8.8.6.6.1.cmml">1</mn></msub><mo id="S3.E2.m1.9.9.9.9.7.7" xref="S3.E2.m1.76.76.4a.cmml">,</mo><msub id="S3.E2.m1.77.77.5.73.19.17.17.1.1.1.2.2" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.10.10.10.10.8.8" xref="S3.E2.m1.10.10.10.10.8.8.cmml">i</mi><mn id="S3.E2.m1.11.11.11.11.9.9.1" xref="S3.E2.m1.11.11.11.11.9.9.1.cmml">2</mn></msub><mo id="S3.E2.m1.12.12.12.12.10.10" xref="S3.E2.m1.76.76.4a.cmml">,</mo><mi id="S3.E2.m1.13.13.13.13.11.11" mathvariant="normal" xref="S3.E2.m1.13.13.13.13.11.11.cmml">⋯</mi><mo id="S3.E2.m1.14.14.14.14.12.12" xref="S3.E2.m1.76.76.4a.cmml">,</mo><msub id="S3.E2.m1.77.77.5.73.19.17.17.1.1.1.3.3" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.15.15.15.15.13.13" xref="S3.E2.m1.15.15.15.15.13.13.cmml">i</mi><mi id="S3.E2.m1.16.16.16.16.14.14.1" xref="S3.E2.m1.16.16.16.16.14.14.1.cmml">n</mi></msub><mo id="S3.E2.m1.17.17.17.17.15.15" stretchy="false" xref="S3.E2.m1.76.76.4a.cmml">]</mo></mrow><mo id="S3.E2.m1.18.18.18.18.16.16" stretchy="false" xref="S3.E2.m1.76.76.4a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E2.m1.80.80.8d" xref="S3.E2.m1.76.76.4.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E2.m1.80.80.8e" xref="S3.E2.m1.76.76.4.cmml"><msub id="S3.E2.m1.20.20.20.2.2" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.19.19.19.1.1.1" xref="S3.E2.m1.19.19.19.1.1.1.cmml">E</mi><mi id="S3.E2.m1.20.20.20.2.2.2.1" xref="S3.E2.m1.20.20.20.2.2.2.1.cmml">v</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E2.m1.80.80.8f" xref="S3.E2.m1.76.76.4.cmml"><mrow id="S3.E2.m1.78.78.6.74.19.17" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.78.78.6.74.19.17.18" xref="S3.E2.m1.76.76.4a.cmml"></mi><mo id="S3.E2.m1.21.21.21.3.1.1" xref="S3.E2.m1.21.21.21.3.1.1.cmml">=</mo><mrow id="S3.E2.m1.78.78.6.74.19.17.17" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.22.22.22.4.2.2" xref="S3.E2.m1.22.22.22.4.2.2.cmml">concat</mi><mo id="S3.E2.m1.78.78.6.74.19.17.17.2" xref="S3.E2.m1.76.76.4a.cmml">⁢</mo><mrow id="S3.E2.m1.78.78.6.74.19.17.17.1.1" xref="S3.E2.m1.76.76.4.cmml"><mo id="S3.E2.m1.23.23.23.5.3.3" stretchy="false" xref="S3.E2.m1.76.76.4a.cmml">(</mo><mrow id="S3.E2.m1.78.78.6.74.19.17.17.1.1.1" xref="S3.E2.m1.76.76.4.cmml"><mo id="S3.E2.m1.24.24.24.6.4.4" stretchy="false" xref="S3.E2.m1.76.76.4a.cmml">[</mo><msub id="S3.E2.m1.78.78.6.74.19.17.17.1.1.1.1.1" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.25.25.25.7.5.5" xref="S3.E2.m1.25.25.25.7.5.5.cmml">v</mi><mn id="S3.E2.m1.26.26.26.8.6.6.1" xref="S3.E2.m1.26.26.26.8.6.6.1.cmml">1</mn></msub><mo id="S3.E2.m1.27.27.27.9.7.7" xref="S3.E2.m1.76.76.4a.cmml">,</mo><msub id="S3.E2.m1.78.78.6.74.19.17.17.1.1.1.2.2" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.28.28.28.10.8.8" xref="S3.E2.m1.28.28.28.10.8.8.cmml">v</mi><mn id="S3.E2.m1.29.29.29.11.9.9.1" xref="S3.E2.m1.29.29.29.11.9.9.1.cmml">2</mn></msub><mo id="S3.E2.m1.30.30.30.12.10.10" xref="S3.E2.m1.76.76.4a.cmml">,</mo><mi id="S3.E2.m1.31.31.31.13.11.11" mathvariant="normal" xref="S3.E2.m1.31.31.31.13.11.11.cmml">⋯</mi><mo id="S3.E2.m1.32.32.32.14.12.12" xref="S3.E2.m1.76.76.4a.cmml">,</mo><msub id="S3.E2.m1.78.78.6.74.19.17.17.1.1.1.3.3" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.33.33.33.15.13.13" xref="S3.E2.m1.33.33.33.15.13.13.cmml">v</mi><mi id="S3.E2.m1.34.34.34.16.14.14.1" xref="S3.E2.m1.34.34.34.16.14.14.1.cmml">n</mi></msub><mo id="S3.E2.m1.35.35.35.17.15.15" stretchy="false" xref="S3.E2.m1.76.76.4a.cmml">]</mo></mrow><mo id="S3.E2.m1.36.36.36.18.16.16" stretchy="false" xref="S3.E2.m1.76.76.4a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E2.m1.80.80.8g" xref="S3.E2.m1.76.76.4.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E2.m1.80.80.8h" xref="S3.E2.m1.76.76.4.cmml"><msub id="S3.E2.m1.38.38.38.2.2" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.37.37.37.1.1.1" xref="S3.E2.m1.37.37.37.1.1.1.cmml">E</mi><mi id="S3.E2.m1.38.38.38.2.2.2.1" xref="S3.E2.m1.38.38.38.2.2.2.1.cmml">t</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E2.m1.80.80.8i" xref="S3.E2.m1.76.76.4.cmml"><mrow id="S3.E2.m1.79.79.7.75.19.17" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.79.79.7.75.19.17.18" xref="S3.E2.m1.76.76.4a.cmml"></mi><mo id="S3.E2.m1.39.39.39.3.1.1" xref="S3.E2.m1.39.39.39.3.1.1.cmml">=</mo><mrow id="S3.E2.m1.79.79.7.75.19.17.17" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.40.40.40.4.2.2" xref="S3.E2.m1.40.40.40.4.2.2.cmml">concat</mi><mo id="S3.E2.m1.79.79.7.75.19.17.17.2" xref="S3.E2.m1.76.76.4a.cmml">⁢</mo><mrow id="S3.E2.m1.79.79.7.75.19.17.17.1.1" xref="S3.E2.m1.76.76.4.cmml"><mo id="S3.E2.m1.41.41.41.5.3.3" stretchy="false" xref="S3.E2.m1.76.76.4a.cmml">(</mo><mrow id="S3.E2.m1.79.79.7.75.19.17.17.1.1.1" xref="S3.E2.m1.76.76.4.cmml"><mo id="S3.E2.m1.42.42.42.6.4.4" stretchy="false" xref="S3.E2.m1.76.76.4a.cmml">[</mo><msub id="S3.E2.m1.79.79.7.75.19.17.17.1.1.1.1.1" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.43.43.43.7.5.5" xref="S3.E2.m1.43.43.43.7.5.5.cmml">t</mi><mn id="S3.E2.m1.44.44.44.8.6.6.1" xref="S3.E2.m1.44.44.44.8.6.6.1.cmml">1</mn></msub><mo id="S3.E2.m1.45.45.45.9.7.7" xref="S3.E2.m1.76.76.4a.cmml">,</mo><msub id="S3.E2.m1.79.79.7.75.19.17.17.1.1.1.2.2" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.46.46.46.10.8.8" xref="S3.E2.m1.46.46.46.10.8.8.cmml">t</mi><mn id="S3.E2.m1.47.47.47.11.9.9.1" xref="S3.E2.m1.47.47.47.11.9.9.1.cmml">2</mn></msub><mo id="S3.E2.m1.48.48.48.12.10.10" xref="S3.E2.m1.76.76.4a.cmml">,</mo><mi id="S3.E2.m1.49.49.49.13.11.11" mathvariant="normal" xref="S3.E2.m1.49.49.49.13.11.11.cmml">⋯</mi><mo id="S3.E2.m1.50.50.50.14.12.12" xref="S3.E2.m1.76.76.4a.cmml">,</mo><msub id="S3.E2.m1.79.79.7.75.19.17.17.1.1.1.3.3" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.51.51.51.15.13.13" xref="S3.E2.m1.51.51.51.15.13.13.cmml">t</mi><mi id="S3.E2.m1.52.52.52.16.14.14.1" xref="S3.E2.m1.52.52.52.16.14.14.1.cmml">n</mi></msub><mo id="S3.E2.m1.53.53.53.17.15.15" stretchy="false" xref="S3.E2.m1.76.76.4a.cmml">]</mo></mrow><mo id="S3.E2.m1.54.54.54.18.16.16" stretchy="false" xref="S3.E2.m1.76.76.4a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E2.m1.80.80.8j" xref="S3.E2.m1.76.76.4.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E2.m1.80.80.8k" xref="S3.E2.m1.76.76.4.cmml"><msub id="S3.E2.m1.56.56.56.2.2" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.55.55.55.1.1.1" xref="S3.E2.m1.55.55.55.1.1.1.cmml">E</mi><mi id="S3.E2.m1.56.56.56.2.2.2.1" xref="S3.E2.m1.56.56.56.2.2.2.1.cmml">c</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E2.m1.80.80.8l" xref="S3.E2.m1.76.76.4.cmml"><mrow id="S3.E2.m1.80.80.8.76.19.17" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.80.80.8.76.19.17.18" xref="S3.E2.m1.76.76.4a.cmml"></mi><mo id="S3.E2.m1.57.57.57.3.1.1" xref="S3.E2.m1.57.57.57.3.1.1.cmml">=</mo><mrow id="S3.E2.m1.80.80.8.76.19.17.17" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.58.58.58.4.2.2" xref="S3.E2.m1.58.58.58.4.2.2.cmml">concat</mi><mo id="S3.E2.m1.80.80.8.76.19.17.17.2" xref="S3.E2.m1.76.76.4a.cmml">⁢</mo><mrow id="S3.E2.m1.80.80.8.76.19.17.17.1.1" xref="S3.E2.m1.76.76.4.cmml"><mo id="S3.E2.m1.59.59.59.5.3.3" stretchy="false" xref="S3.E2.m1.76.76.4a.cmml">(</mo><mrow id="S3.E2.m1.80.80.8.76.19.17.17.1.1.1" xref="S3.E2.m1.76.76.4.cmml"><mo id="S3.E2.m1.60.60.60.6.4.4" stretchy="false" xref="S3.E2.m1.76.76.4a.cmml">[</mo><msub id="S3.E2.m1.80.80.8.76.19.17.17.1.1.1.1.1" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.61.61.61.7.5.5" xref="S3.E2.m1.61.61.61.7.5.5.cmml">c</mi><mn id="S3.E2.m1.62.62.62.8.6.6.1" xref="S3.E2.m1.62.62.62.8.6.6.1.cmml">1</mn></msub><mo id="S3.E2.m1.63.63.63.9.7.7" xref="S3.E2.m1.76.76.4a.cmml">,</mo><msub id="S3.E2.m1.80.80.8.76.19.17.17.1.1.1.2.2" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.64.64.64.10.8.8" xref="S3.E2.m1.64.64.64.10.8.8.cmml">c</mi><mn id="S3.E2.m1.65.65.65.11.9.9.1" xref="S3.E2.m1.65.65.65.11.9.9.1.cmml">2</mn></msub><mo id="S3.E2.m1.66.66.66.12.10.10" xref="S3.E2.m1.76.76.4a.cmml">,</mo><mi id="S3.E2.m1.67.67.67.13.11.11" mathvariant="normal" xref="S3.E2.m1.67.67.67.13.11.11.cmml">⋯</mi><mo id="S3.E2.m1.68.68.68.14.12.12" xref="S3.E2.m1.76.76.4a.cmml">,</mo><msub id="S3.E2.m1.80.80.8.76.19.17.17.1.1.1.3.3" xref="S3.E2.m1.76.76.4.cmml"><mi id="S3.E2.m1.69.69.69.15.13.13" xref="S3.E2.m1.69.69.69.15.13.13.cmml">c</mi><mi id="S3.E2.m1.70.70.70.16.14.14.1" xref="S3.E2.m1.70.70.70.16.14.14.1.cmml">n</mi></msub><mo id="S3.E2.m1.71.71.71.17.15.15" stretchy="false" xref="S3.E2.m1.76.76.4a.cmml">]</mo></mrow><mo id="S3.E2.m1.72.72.72.18.16.16" stretchy="false" xref="S3.E2.m1.76.76.4a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E2.m1.80b"><apply id="S3.E2.m1.76.76.4.cmml" xref="S3.E2.m1.80.80.8"><and id="S3.E2.m1.76.76.4a.cmml" xref="S3.E2.m1.77.77.5.73.19.17.18"></and><apply id="S3.E2.m1.76.76.4b.cmml" xref="S3.E2.m1.80.80.8"><eq id="S3.E2.m1.3.3.3.3.1.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1"></eq><apply id="S3.E2.m1.76.76.4.6.cmml" xref="S3.E2.m1.80.80.8"><csymbol cd="ambiguous" id="S3.E2.m1.76.76.4.6.1.cmml" xref="S3.E2.m1.77.77.5.73.19.17.18">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">𝐸</ci><apply id="S3.E2.m1.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1"><times id="S3.E2.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.1"></times><ci id="S3.E2.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.2">𝐼</ci><ci id="S3.E2.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.3">𝐷</ci></apply></apply><apply id="S3.E2.m1.73.73.1.1.cmml" xref="S3.E2.m1.80.80.8"><times id="S3.E2.m1.73.73.1.1.2.cmml" xref="S3.E2.m1.77.77.5.73.19.17.18"></times><ci id="S3.E2.m1.4.4.4.4.2.2.cmml" xref="S3.E2.m1.4.4.4.4.2.2">concat</ci><list id="S3.E2.m1.73.73.1.1.1.1.1.4.cmml" xref="S3.E2.m1.80.80.8"><apply id="S3.E2.m1.73.73.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.80.80.8"><csymbol cd="ambiguous" id="S3.E2.m1.73.73.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.80.80.8">subscript</csymbol><ci id="S3.E2.m1.7.7.7.7.5.5.cmml" xref="S3.E2.m1.7.7.7.7.5.5">𝑖</ci><cn id="S3.E2.m1.8.8.8.8.6.6.1.cmml" type="integer" xref="S3.E2.m1.8.8.8.8.6.6.1">1</cn></apply><apply id="S3.E2.m1.73.73.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.80.80.8"><csymbol cd="ambiguous" id="S3.E2.m1.73.73.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.80.80.8">subscript</csymbol><ci id="S3.E2.m1.10.10.10.10.8.8.cmml" xref="S3.E2.m1.10.10.10.10.8.8">𝑖</ci><cn id="S3.E2.m1.11.11.11.11.9.9.1.cmml" type="integer" xref="S3.E2.m1.11.11.11.11.9.9.1">2</cn></apply><ci id="S3.E2.m1.13.13.13.13.11.11.cmml" xref="S3.E2.m1.13.13.13.13.11.11">⋯</ci><apply id="S3.E2.m1.73.73.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.80.80.8"><csymbol cd="ambiguous" id="S3.E2.m1.73.73.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.80.80.8">subscript</csymbol><ci id="S3.E2.m1.15.15.15.15.13.13.cmml" xref="S3.E2.m1.15.15.15.15.13.13">𝑖</ci><ci id="S3.E2.m1.16.16.16.16.14.14.1.cmml" xref="S3.E2.m1.16.16.16.16.14.14.1">𝑛</ci></apply></list><apply id="S3.E2.m1.73.73.1.1.4.cmml" xref="S3.E2.m1.80.80.8"><csymbol cd="ambiguous" id="S3.E2.m1.73.73.1.1.4.1.cmml" xref="S3.E2.m1.77.77.5.73.19.17.18">subscript</csymbol><ci id="S3.E2.m1.19.19.19.1.1.1.cmml" xref="S3.E2.m1.19.19.19.1.1.1">𝐸</ci><ci id="S3.E2.m1.20.20.20.2.2.2.1.cmml" xref="S3.E2.m1.20.20.20.2.2.2.1">𝑣</ci></apply></apply></apply><apply id="S3.E2.m1.76.76.4c.cmml" xref="S3.E2.m1.80.80.8"><eq id="S3.E2.m1.21.21.21.3.1.1.cmml" xref="S3.E2.m1.21.21.21.3.1.1"></eq><share href="https://arxiv.org/html/2405.17959v1#S3.E2.m1.73.73.1.1.cmml" id="S3.E2.m1.76.76.4d.cmml" xref="S3.E2.m1.77.77.5.73.19.17.18"></share><apply id="S3.E2.m1.74.74.2.2.cmml" xref="S3.E2.m1.80.80.8"><times id="S3.E2.m1.74.74.2.2.2.cmml" xref="S3.E2.m1.77.77.5.73.19.17.18"></times><ci id="S3.E2.m1.22.22.22.4.2.2.cmml" xref="S3.E2.m1.22.22.22.4.2.2">concat</ci><list id="S3.E2.m1.74.74.2.2.1.1.1.4.cmml" xref="S3.E2.m1.80.80.8"><apply id="S3.E2.m1.74.74.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.80.80.8"><csymbol cd="ambiguous" id="S3.E2.m1.74.74.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.80.80.8">subscript</csymbol><ci id="S3.E2.m1.25.25.25.7.5.5.cmml" xref="S3.E2.m1.25.25.25.7.5.5">𝑣</ci><cn id="S3.E2.m1.26.26.26.8.6.6.1.cmml" type="integer" xref="S3.E2.m1.26.26.26.8.6.6.1">1</cn></apply><apply id="S3.E2.m1.74.74.2.2.1.1.1.2.2.cmml" xref="S3.E2.m1.80.80.8"><csymbol cd="ambiguous" id="S3.E2.m1.74.74.2.2.1.1.1.2.2.1.cmml" xref="S3.E2.m1.80.80.8">subscript</csymbol><ci id="S3.E2.m1.28.28.28.10.8.8.cmml" xref="S3.E2.m1.28.28.28.10.8.8">𝑣</ci><cn id="S3.E2.m1.29.29.29.11.9.9.1.cmml" type="integer" xref="S3.E2.m1.29.29.29.11.9.9.1">2</cn></apply><ci id="S3.E2.m1.31.31.31.13.11.11.cmml" xref="S3.E2.m1.31.31.31.13.11.11">⋯</ci><apply id="S3.E2.m1.74.74.2.2.1.1.1.3.3.cmml" xref="S3.E2.m1.80.80.8"><csymbol cd="ambiguous" id="S3.E2.m1.74.74.2.2.1.1.1.3.3.1.cmml" xref="S3.E2.m1.80.80.8">subscript</csymbol><ci id="S3.E2.m1.33.33.33.15.13.13.cmml" xref="S3.E2.m1.33.33.33.15.13.13">𝑣</ci><ci id="S3.E2.m1.34.34.34.16.14.14.1.cmml" xref="S3.E2.m1.34.34.34.16.14.14.1">𝑛</ci></apply></list><apply id="S3.E2.m1.74.74.2.2.4.cmml" xref="S3.E2.m1.80.80.8"><csymbol cd="ambiguous" id="S3.E2.m1.74.74.2.2.4.1.cmml" xref="S3.E2.m1.77.77.5.73.19.17.18">subscript</csymbol><ci id="S3.E2.m1.37.37.37.1.1.1.cmml" xref="S3.E2.m1.37.37.37.1.1.1">𝐸</ci><ci id="S3.E2.m1.38.38.38.2.2.2.1.cmml" xref="S3.E2.m1.38.38.38.2.2.2.1">𝑡</ci></apply></apply></apply><apply id="S3.E2.m1.76.76.4e.cmml" xref="S3.E2.m1.80.80.8"><eq id="S3.E2.m1.39.39.39.3.1.1.cmml" xref="S3.E2.m1.39.39.39.3.1.1"></eq><share href="https://arxiv.org/html/2405.17959v1#S3.E2.m1.74.74.2.2.cmml" id="S3.E2.m1.76.76.4f.cmml" xref="S3.E2.m1.77.77.5.73.19.17.18"></share><apply id="S3.E2.m1.75.75.3.3.cmml" xref="S3.E2.m1.80.80.8"><times id="S3.E2.m1.75.75.3.3.2.cmml" xref="S3.E2.m1.77.77.5.73.19.17.18"></times><ci id="S3.E2.m1.40.40.40.4.2.2.cmml" xref="S3.E2.m1.40.40.40.4.2.2">concat</ci><list id="S3.E2.m1.75.75.3.3.1.1.1.4.cmml" xref="S3.E2.m1.80.80.8"><apply id="S3.E2.m1.75.75.3.3.1.1.1.1.1.cmml" xref="S3.E2.m1.80.80.8"><csymbol cd="ambiguous" id="S3.E2.m1.75.75.3.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.80.80.8">subscript</csymbol><ci id="S3.E2.m1.43.43.43.7.5.5.cmml" xref="S3.E2.m1.43.43.43.7.5.5">𝑡</ci><cn id="S3.E2.m1.44.44.44.8.6.6.1.cmml" type="integer" xref="S3.E2.m1.44.44.44.8.6.6.1">1</cn></apply><apply id="S3.E2.m1.75.75.3.3.1.1.1.2.2.cmml" xref="S3.E2.m1.80.80.8"><csymbol cd="ambiguous" id="S3.E2.m1.75.75.3.3.1.1.1.2.2.1.cmml" xref="S3.E2.m1.80.80.8">subscript</csymbol><ci id="S3.E2.m1.46.46.46.10.8.8.cmml" xref="S3.E2.m1.46.46.46.10.8.8">𝑡</ci><cn id="S3.E2.m1.47.47.47.11.9.9.1.cmml" type="integer" xref="S3.E2.m1.47.47.47.11.9.9.1">2</cn></apply><ci id="S3.E2.m1.49.49.49.13.11.11.cmml" xref="S3.E2.m1.49.49.49.13.11.11">⋯</ci><apply id="S3.E2.m1.75.75.3.3.1.1.1.3.3.cmml" xref="S3.E2.m1.80.80.8"><csymbol cd="ambiguous" id="S3.E2.m1.75.75.3.3.1.1.1.3.3.1.cmml" xref="S3.E2.m1.80.80.8">subscript</csymbol><ci id="S3.E2.m1.51.51.51.15.13.13.cmml" xref="S3.E2.m1.51.51.51.15.13.13">𝑡</ci><ci id="S3.E2.m1.52.52.52.16.14.14.1.cmml" xref="S3.E2.m1.52.52.52.16.14.14.1">𝑛</ci></apply></list><apply id="S3.E2.m1.75.75.3.3.4.cmml" xref="S3.E2.m1.80.80.8"><csymbol cd="ambiguous" id="S3.E2.m1.75.75.3.3.4.1.cmml" xref="S3.E2.m1.77.77.5.73.19.17.18">subscript</csymbol><ci id="S3.E2.m1.55.55.55.1.1.1.cmml" xref="S3.E2.m1.55.55.55.1.1.1">𝐸</ci><ci id="S3.E2.m1.56.56.56.2.2.2.1.cmml" xref="S3.E2.m1.56.56.56.2.2.2.1">𝑐</ci></apply></apply></apply><apply id="S3.E2.m1.76.76.4g.cmml" xref="S3.E2.m1.80.80.8"><eq id="S3.E2.m1.57.57.57.3.1.1.cmml" xref="S3.E2.m1.57.57.57.3.1.1"></eq><share href="https://arxiv.org/html/2405.17959v1#S3.E2.m1.75.75.3.3.cmml" id="S3.E2.m1.76.76.4h.cmml" xref="S3.E2.m1.77.77.5.73.19.17.18"></share><apply id="S3.E2.m1.76.76.4.4.cmml" xref="S3.E2.m1.80.80.8"><times id="S3.E2.m1.76.76.4.4.2.cmml" xref="S3.E2.m1.77.77.5.73.19.17.18"></times><ci id="S3.E2.m1.58.58.58.4.2.2.cmml" xref="S3.E2.m1.58.58.58.4.2.2">concat</ci><list id="S3.E2.m1.76.76.4.4.1.1.1.4.cmml" xref="S3.E2.m1.80.80.8"><apply id="S3.E2.m1.76.76.4.4.1.1.1.1.1.cmml" xref="S3.E2.m1.80.80.8"><csymbol cd="ambiguous" id="S3.E2.m1.76.76.4.4.1.1.1.1.1.1.cmml" xref="S3.E2.m1.80.80.8">subscript</csymbol><ci id="S3.E2.m1.61.61.61.7.5.5.cmml" xref="S3.E2.m1.61.61.61.7.5.5">𝑐</ci><cn id="S3.E2.m1.62.62.62.8.6.6.1.cmml" type="integer" xref="S3.E2.m1.62.62.62.8.6.6.1">1</cn></apply><apply id="S3.E2.m1.76.76.4.4.1.1.1.2.2.cmml" xref="S3.E2.m1.80.80.8"><csymbol cd="ambiguous" id="S3.E2.m1.76.76.4.4.1.1.1.2.2.1.cmml" xref="S3.E2.m1.80.80.8">subscript</csymbol><ci id="S3.E2.m1.64.64.64.10.8.8.cmml" xref="S3.E2.m1.64.64.64.10.8.8">𝑐</ci><cn id="S3.E2.m1.65.65.65.11.9.9.1.cmml" type="integer" xref="S3.E2.m1.65.65.65.11.9.9.1">2</cn></apply><ci id="S3.E2.m1.67.67.67.13.11.11.cmml" xref="S3.E2.m1.67.67.67.13.11.11">⋯</ci><apply id="S3.E2.m1.76.76.4.4.1.1.1.3.3.cmml" xref="S3.E2.m1.80.80.8"><csymbol cd="ambiguous" id="S3.E2.m1.76.76.4.4.1.1.1.3.3.1.cmml" xref="S3.E2.m1.80.80.8">subscript</csymbol><ci id="S3.E2.m1.69.69.69.15.13.13.cmml" xref="S3.E2.m1.69.69.69.15.13.13">𝑐</ci><ci id="S3.E2.m1.70.70.70.16.14.14.1.cmml" xref="S3.E2.m1.70.70.70.16.14.14.1">𝑛</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.80c">\begin{split}E_{ID}&amp;=\mathrm{concat}([i_{1},i_{2},\cdots,i_{n}])\\
E_{v}&amp;=\mathrm{concat}([v_{1},v_{2},\cdots,v_{n}])\\
E_{t}&amp;=\mathrm{concat}([t_{1},t_{2},\cdots,t_{n}])\\
E_{c}&amp;=\mathrm{concat}([c_{1},c_{2},\cdots,c_{n}])\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.80d">start_ROW start_CELL italic_E start_POSTSUBSCRIPT italic_I italic_D end_POSTSUBSCRIPT end_CELL start_CELL = roman_concat ( [ italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_i start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ] ) end_CELL end_ROW start_ROW start_CELL italic_E start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_CELL start_CELL = roman_concat ( [ italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_v start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ] ) end_CELL end_ROW start_ROW start_CELL italic_E start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_CELL start_CELL = roman_concat ( [ italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_t start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ] ) end_CELL end_ROW start_ROW start_CELL italic_E start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_CELL start_CELL = roman_concat ( [ italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_c start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ] ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Multimodal fusion module</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.4">The multimodal fusion module comprises an MAF and feed-forward layer.
The MAF layer contains independent attention operations and an attention fusion function that combines sequential multimodal representations.
For the attention operation, multimodal data of different dimensions were processed to obtain data with the same dimension through linear transformations.
Because images, texts, and categories extracted from each item contains information related to each other, they are added and expressed as one multimodal, as shown in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S3.E3" title="Equation 3 ‣ 3.3 Multimodal fusion module ‣ 3 Proposed method ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">3</span></a>, where the <math alttext="W_{v}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><msub id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">W</mi><mi id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝑊</ci><ci id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">W_{v}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="W_{t}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><msub id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">W</mi><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝑊</ci><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">W_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="W_{c}" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><msub id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">W</mi><mi id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝑊</ci><ci id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">W_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_W start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="d^{\prime}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><msup id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">d</mi><mo id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝑑</ci><ci id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">d^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> indicate the linear embedding matrix for each data point and the dimension for connecting multimodal data <cite class="ltx_cite ltx_citemacro_citep">(Cui et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib3" title="">2018</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\begin{split}E_{m}=E_{v}W_{v}+E_{t}W_{t}+E_{c}W_{c}\\
W_{v}\in\mathbb{R}^{d_{v}\times d^{\prime}},W_{t}\in\mathbb{R}^{d_{t}\times d^%
{\prime}},W_{c}\in\mathbb{R}^{d_{c}\times d^{\prime}}\end{split}" class="ltx_Math" display="block" id="S3.E3.m1.38"><semantics id="S3.E3.m1.38a"><mtable displaystyle="true" id="S3.E3.m1.38.38.4" rowspacing="0pt"><mtr id="S3.E3.m1.38.38.4a"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.38.38.4b"><mrow id="S3.E3.m1.17.17.17.17.17"><msub id="S3.E3.m1.17.17.17.17.17.18"><mi id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml">E</mi><mi id="S3.E3.m1.2.2.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.2.2.1.cmml">m</mi></msub><mo id="S3.E3.m1.3.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S3.E3.m1.17.17.17.17.17.19"><mrow id="S3.E3.m1.17.17.17.17.17.19.1"><msub id="S3.E3.m1.17.17.17.17.17.19.1.2"><mi id="S3.E3.m1.4.4.4.4.4.4" xref="S3.E3.m1.4.4.4.4.4.4.cmml">E</mi><mi id="S3.E3.m1.5.5.5.5.5.5.1" xref="S3.E3.m1.5.5.5.5.5.5.1.cmml">v</mi></msub><mo id="S3.E3.m1.17.17.17.17.17.19.1.1" xref="S3.E3.m1.36.36.2.3.cmml">⁢</mo><msub id="S3.E3.m1.17.17.17.17.17.19.1.3"><mi id="S3.E3.m1.6.6.6.6.6.6" xref="S3.E3.m1.6.6.6.6.6.6.cmml">W</mi><mi id="S3.E3.m1.7.7.7.7.7.7.1" xref="S3.E3.m1.7.7.7.7.7.7.1.cmml">v</mi></msub></mrow><mo id="S3.E3.m1.8.8.8.8.8.8" xref="S3.E3.m1.8.8.8.8.8.8.cmml">+</mo><mrow id="S3.E3.m1.17.17.17.17.17.19.2"><msub id="S3.E3.m1.17.17.17.17.17.19.2.2"><mi id="S3.E3.m1.9.9.9.9.9.9" xref="S3.E3.m1.9.9.9.9.9.9.cmml">E</mi><mi id="S3.E3.m1.10.10.10.10.10.10.1" xref="S3.E3.m1.10.10.10.10.10.10.1.cmml">t</mi></msub><mo id="S3.E3.m1.17.17.17.17.17.19.2.1" xref="S3.E3.m1.36.36.2.3.cmml">⁢</mo><msub id="S3.E3.m1.17.17.17.17.17.19.2.3"><mi id="S3.E3.m1.11.11.11.11.11.11" xref="S3.E3.m1.11.11.11.11.11.11.cmml">W</mi><mi id="S3.E3.m1.12.12.12.12.12.12.1" xref="S3.E3.m1.12.12.12.12.12.12.1.cmml">t</mi></msub></mrow><mo id="S3.E3.m1.8.8.8.8.8.8a" xref="S3.E3.m1.8.8.8.8.8.8.cmml">+</mo><mrow id="S3.E3.m1.17.17.17.17.17.19.3"><msub id="S3.E3.m1.17.17.17.17.17.19.3.2"><mi id="S3.E3.m1.14.14.14.14.14.14" xref="S3.E3.m1.14.14.14.14.14.14.cmml">E</mi><mi id="S3.E3.m1.15.15.15.15.15.15.1" xref="S3.E3.m1.15.15.15.15.15.15.1.cmml">c</mi></msub><mo id="S3.E3.m1.17.17.17.17.17.19.3.1" xref="S3.E3.m1.36.36.2.3.cmml">⁢</mo><msub id="S3.E3.m1.17.17.17.17.17.19.3.3"><mi id="S3.E3.m1.16.16.16.16.16.16" xref="S3.E3.m1.16.16.16.16.16.16.cmml">W</mi><mi id="S3.E3.m1.17.17.17.17.17.17.1" xref="S3.E3.m1.17.17.17.17.17.17.1.cmml">c</mi></msub></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E3.m1.38.38.4c"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.38.38.4d"><mrow id="S3.E3.m1.38.38.4.36.19.19.19"><mrow id="S3.E3.m1.37.37.3.35.18.18.18.1"><msub id="S3.E3.m1.37.37.3.35.18.18.18.1.1"><mi id="S3.E3.m1.18.18.18.1.1.1" xref="S3.E3.m1.18.18.18.1.1.1.cmml">W</mi><mi id="S3.E3.m1.19.19.19.2.2.2.1" xref="S3.E3.m1.19.19.19.2.2.2.1.cmml">v</mi></msub><mo id="S3.E3.m1.20.20.20.3.3.3" xref="S3.E3.m1.20.20.20.3.3.3.cmml">∈</mo><msup id="S3.E3.m1.37.37.3.35.18.18.18.1.2"><mi id="S3.E3.m1.21.21.21.4.4.4" xref="S3.E3.m1.21.21.21.4.4.4.cmml">ℝ</mi><mrow id="S3.E3.m1.22.22.22.5.5.5.1" xref="S3.E3.m1.22.22.22.5.5.5.1.cmml"><msub id="S3.E3.m1.22.22.22.5.5.5.1.2" xref="S3.E3.m1.22.22.22.5.5.5.1.2.cmml"><mi id="S3.E3.m1.22.22.22.5.5.5.1.2.2" xref="S3.E3.m1.22.22.22.5.5.5.1.2.2.cmml">d</mi><mi id="S3.E3.m1.22.22.22.5.5.5.1.2.3" xref="S3.E3.m1.22.22.22.5.5.5.1.2.3.cmml">v</mi></msub><mo id="S3.E3.m1.22.22.22.5.5.5.1.1" lspace="0.222em" rspace="0.222em" xref="S3.E3.m1.22.22.22.5.5.5.1.1.cmml">×</mo><msup id="S3.E3.m1.22.22.22.5.5.5.1.3" xref="S3.E3.m1.22.22.22.5.5.5.1.3.cmml"><mi id="S3.E3.m1.22.22.22.5.5.5.1.3.2" xref="S3.E3.m1.22.22.22.5.5.5.1.3.2.cmml">d</mi><mo id="S3.E3.m1.22.22.22.5.5.5.1.3.3" xref="S3.E3.m1.22.22.22.5.5.5.1.3.3.cmml">′</mo></msup></mrow></msup></mrow><mo id="S3.E3.m1.23.23.23.6.6.6" xref="S3.E3.m1.36.36.2.3.cmml">,</mo><mrow id="S3.E3.m1.38.38.4.36.19.19.19.2"><mrow id="S3.E3.m1.38.38.4.36.19.19.19.2.1.1"><msub id="S3.E3.m1.38.38.4.36.19.19.19.2.1.1.1"><mi id="S3.E3.m1.24.24.24.7.7.7" xref="S3.E3.m1.24.24.24.7.7.7.cmml">W</mi><mi id="S3.E3.m1.25.25.25.8.8.8.1" xref="S3.E3.m1.25.25.25.8.8.8.1.cmml">t</mi></msub><mo id="S3.E3.m1.26.26.26.9.9.9" xref="S3.E3.m1.26.26.26.9.9.9.cmml">∈</mo><msup id="S3.E3.m1.38.38.4.36.19.19.19.2.1.1.2"><mi id="S3.E3.m1.27.27.27.10.10.10" xref="S3.E3.m1.27.27.27.10.10.10.cmml">ℝ</mi><mrow id="S3.E3.m1.28.28.28.11.11.11.1" xref="S3.E3.m1.28.28.28.11.11.11.1.cmml"><msub id="S3.E3.m1.28.28.28.11.11.11.1.2" xref="S3.E3.m1.28.28.28.11.11.11.1.2.cmml"><mi id="S3.E3.m1.28.28.28.11.11.11.1.2.2" xref="S3.E3.m1.28.28.28.11.11.11.1.2.2.cmml">d</mi><mi id="S3.E3.m1.28.28.28.11.11.11.1.2.3" xref="S3.E3.m1.28.28.28.11.11.11.1.2.3.cmml">t</mi></msub><mo id="S3.E3.m1.28.28.28.11.11.11.1.1" lspace="0.222em" rspace="0.222em" xref="S3.E3.m1.28.28.28.11.11.11.1.1.cmml">×</mo><msup id="S3.E3.m1.28.28.28.11.11.11.1.3" xref="S3.E3.m1.28.28.28.11.11.11.1.3.cmml"><mi id="S3.E3.m1.28.28.28.11.11.11.1.3.2" xref="S3.E3.m1.28.28.28.11.11.11.1.3.2.cmml">d</mi><mo id="S3.E3.m1.28.28.28.11.11.11.1.3.3" xref="S3.E3.m1.28.28.28.11.11.11.1.3.3.cmml">′</mo></msup></mrow></msup></mrow><mo id="S3.E3.m1.29.29.29.12.12.12" xref="S3.E3.m1.36.36.2.3.cmml">,</mo><mrow id="S3.E3.m1.38.38.4.36.19.19.19.2.2.2"><msub id="S3.E3.m1.38.38.4.36.19.19.19.2.2.2.1"><mi id="S3.E3.m1.30.30.30.13.13.13" xref="S3.E3.m1.30.30.30.13.13.13.cmml">W</mi><mi id="S3.E3.m1.31.31.31.14.14.14.1" xref="S3.E3.m1.31.31.31.14.14.14.1.cmml">c</mi></msub><mo id="S3.E3.m1.32.32.32.15.15.15" xref="S3.E3.m1.32.32.32.15.15.15.cmml">∈</mo><msup id="S3.E3.m1.38.38.4.36.19.19.19.2.2.2.2"><mi id="S3.E3.m1.33.33.33.16.16.16" xref="S3.E3.m1.33.33.33.16.16.16.cmml">ℝ</mi><mrow id="S3.E3.m1.34.34.34.17.17.17.1" xref="S3.E3.m1.34.34.34.17.17.17.1.cmml"><msub id="S3.E3.m1.34.34.34.17.17.17.1.2" xref="S3.E3.m1.34.34.34.17.17.17.1.2.cmml"><mi id="S3.E3.m1.34.34.34.17.17.17.1.2.2" xref="S3.E3.m1.34.34.34.17.17.17.1.2.2.cmml">d</mi><mi id="S3.E3.m1.34.34.34.17.17.17.1.2.3" xref="S3.E3.m1.34.34.34.17.17.17.1.2.3.cmml">c</mi></msub><mo id="S3.E3.m1.34.34.34.17.17.17.1.1" lspace="0.222em" rspace="0.222em" xref="S3.E3.m1.34.34.34.17.17.17.1.1.cmml">×</mo><msup id="S3.E3.m1.34.34.34.17.17.17.1.3" xref="S3.E3.m1.34.34.34.17.17.17.1.3.cmml"><mi id="S3.E3.m1.34.34.34.17.17.17.1.3.2" xref="S3.E3.m1.34.34.34.17.17.17.1.3.2.cmml">d</mi><mo id="S3.E3.m1.34.34.34.17.17.17.1.3.3" xref="S3.E3.m1.34.34.34.17.17.17.1.3.3.cmml">′</mo></msup></mrow></msup></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E3.m1.38b"><apply id="S3.E3.m1.36.36.2.3.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.36.36.2.3a.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1">formulae-sequence</csymbol><apply id="S3.E3.m1.35.35.1.1.1.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><and id="S3.E3.m1.35.35.1.1.1a.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"></and><apply id="S3.E3.m1.35.35.1.1.1b.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><eq id="S3.E3.m1.3.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3"></eq><apply id="S3.E3.m1.35.35.1.1.1.2.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.35.35.1.1.1.2.1.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">𝐸</ci><ci id="S3.E3.m1.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1">𝑚</ci></apply><apply id="S3.E3.m1.35.35.1.1.1.4.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><plus id="S3.E3.m1.8.8.8.8.8.8.cmml" xref="S3.E3.m1.8.8.8.8.8.8"></plus><apply id="S3.E3.m1.35.35.1.1.1.4.2.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><times id="S3.E3.m1.35.35.1.1.1.4.2.1.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"></times><apply id="S3.E3.m1.35.35.1.1.1.4.2.2.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.35.35.1.1.1.4.2.2.1.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1">subscript</csymbol><ci id="S3.E3.m1.4.4.4.4.4.4.cmml" xref="S3.E3.m1.4.4.4.4.4.4">𝐸</ci><ci id="S3.E3.m1.5.5.5.5.5.5.1.cmml" xref="S3.E3.m1.5.5.5.5.5.5.1">𝑣</ci></apply><apply id="S3.E3.m1.35.35.1.1.1.4.2.3.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.35.35.1.1.1.4.2.3.1.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1">subscript</csymbol><ci id="S3.E3.m1.6.6.6.6.6.6.cmml" xref="S3.E3.m1.6.6.6.6.6.6">𝑊</ci><ci id="S3.E3.m1.7.7.7.7.7.7.1.cmml" xref="S3.E3.m1.7.7.7.7.7.7.1">𝑣</ci></apply></apply><apply id="S3.E3.m1.35.35.1.1.1.4.3.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><times id="S3.E3.m1.35.35.1.1.1.4.3.1.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"></times><apply id="S3.E3.m1.35.35.1.1.1.4.3.2.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.35.35.1.1.1.4.3.2.1.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1">subscript</csymbol><ci id="S3.E3.m1.9.9.9.9.9.9.cmml" xref="S3.E3.m1.9.9.9.9.9.9">𝐸</ci><ci id="S3.E3.m1.10.10.10.10.10.10.1.cmml" xref="S3.E3.m1.10.10.10.10.10.10.1">𝑡</ci></apply><apply id="S3.E3.m1.35.35.1.1.1.4.3.3.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.35.35.1.1.1.4.3.3.1.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1">subscript</csymbol><ci id="S3.E3.m1.11.11.11.11.11.11.cmml" xref="S3.E3.m1.11.11.11.11.11.11">𝑊</ci><ci id="S3.E3.m1.12.12.12.12.12.12.1.cmml" xref="S3.E3.m1.12.12.12.12.12.12.1">𝑡</ci></apply></apply><apply id="S3.E3.m1.35.35.1.1.1.4.4.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><times id="S3.E3.m1.35.35.1.1.1.4.4.1.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"></times><apply id="S3.E3.m1.35.35.1.1.1.4.4.2.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.35.35.1.1.1.4.4.2.1.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1">subscript</csymbol><ci id="S3.E3.m1.14.14.14.14.14.14.cmml" xref="S3.E3.m1.14.14.14.14.14.14">𝐸</ci><ci id="S3.E3.m1.15.15.15.15.15.15.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1">𝑐</ci></apply><apply id="S3.E3.m1.35.35.1.1.1.4.4.3.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.35.35.1.1.1.4.4.3.1.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1">subscript</csymbol><ci id="S3.E3.m1.16.16.16.16.16.16.cmml" xref="S3.E3.m1.16.16.16.16.16.16">𝑊</ci><ci id="S3.E3.m1.17.17.17.17.17.17.1.cmml" xref="S3.E3.m1.17.17.17.17.17.17.1">𝑐</ci></apply><apply id="S3.E3.m1.35.35.1.1.1.4.4.4.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.35.35.1.1.1.4.4.4.1.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1">subscript</csymbol><ci id="S3.E3.m1.18.18.18.1.1.1.cmml" xref="S3.E3.m1.18.18.18.1.1.1">𝑊</ci><ci id="S3.E3.m1.19.19.19.2.2.2.1.cmml" xref="S3.E3.m1.19.19.19.2.2.2.1">𝑣</ci></apply></apply></apply></apply><apply id="S3.E3.m1.35.35.1.1.1c.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><in id="S3.E3.m1.20.20.20.3.3.3.cmml" xref="S3.E3.m1.20.20.20.3.3.3"></in><share href="https://arxiv.org/html/2405.17959v1#S3.E3.m1.35.35.1.1.1.4.cmml" id="S3.E3.m1.35.35.1.1.1d.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"></share><apply id="S3.E3.m1.35.35.1.1.1.6.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.35.35.1.1.1.6.1.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1">superscript</csymbol><ci id="S3.E3.m1.21.21.21.4.4.4.cmml" xref="S3.E3.m1.21.21.21.4.4.4">ℝ</ci><apply id="S3.E3.m1.22.22.22.5.5.5.1.cmml" xref="S3.E3.m1.22.22.22.5.5.5.1"><times id="S3.E3.m1.22.22.22.5.5.5.1.1.cmml" xref="S3.E3.m1.22.22.22.5.5.5.1.1"></times><apply id="S3.E3.m1.22.22.22.5.5.5.1.2.cmml" xref="S3.E3.m1.22.22.22.5.5.5.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.22.22.22.5.5.5.1.2.1.cmml" xref="S3.E3.m1.22.22.22.5.5.5.1.2">subscript</csymbol><ci id="S3.E3.m1.22.22.22.5.5.5.1.2.2.cmml" xref="S3.E3.m1.22.22.22.5.5.5.1.2.2">𝑑</ci><ci id="S3.E3.m1.22.22.22.5.5.5.1.2.3.cmml" xref="S3.E3.m1.22.22.22.5.5.5.1.2.3">𝑣</ci></apply><apply id="S3.E3.m1.22.22.22.5.5.5.1.3.cmml" xref="S3.E3.m1.22.22.22.5.5.5.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.22.22.22.5.5.5.1.3.1.cmml" xref="S3.E3.m1.22.22.22.5.5.5.1.3">superscript</csymbol><ci id="S3.E3.m1.22.22.22.5.5.5.1.3.2.cmml" xref="S3.E3.m1.22.22.22.5.5.5.1.3.2">𝑑</ci><ci id="S3.E3.m1.22.22.22.5.5.5.1.3.3.cmml" xref="S3.E3.m1.22.22.22.5.5.5.1.3.3">′</ci></apply></apply></apply></apply></apply><apply id="S3.E3.m1.36.36.2.2.2.3.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.36.36.2.2.2.3a.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1">formulae-sequence</csymbol><apply id="S3.E3.m1.36.36.2.2.2.1.1.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><in id="S3.E3.m1.26.26.26.9.9.9.cmml" xref="S3.E3.m1.26.26.26.9.9.9"></in><apply id="S3.E3.m1.36.36.2.2.2.1.1.2.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.36.36.2.2.2.1.1.2.1.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1">subscript</csymbol><ci id="S3.E3.m1.24.24.24.7.7.7.cmml" xref="S3.E3.m1.24.24.24.7.7.7">𝑊</ci><ci id="S3.E3.m1.25.25.25.8.8.8.1.cmml" xref="S3.E3.m1.25.25.25.8.8.8.1">𝑡</ci></apply><apply id="S3.E3.m1.36.36.2.2.2.1.1.3.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.36.36.2.2.2.1.1.3.1.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1">superscript</csymbol><ci id="S3.E3.m1.27.27.27.10.10.10.cmml" xref="S3.E3.m1.27.27.27.10.10.10">ℝ</ci><apply id="S3.E3.m1.28.28.28.11.11.11.1.cmml" xref="S3.E3.m1.28.28.28.11.11.11.1"><times id="S3.E3.m1.28.28.28.11.11.11.1.1.cmml" xref="S3.E3.m1.28.28.28.11.11.11.1.1"></times><apply id="S3.E3.m1.28.28.28.11.11.11.1.2.cmml" xref="S3.E3.m1.28.28.28.11.11.11.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.28.28.28.11.11.11.1.2.1.cmml" xref="S3.E3.m1.28.28.28.11.11.11.1.2">subscript</csymbol><ci id="S3.E3.m1.28.28.28.11.11.11.1.2.2.cmml" xref="S3.E3.m1.28.28.28.11.11.11.1.2.2">𝑑</ci><ci id="S3.E3.m1.28.28.28.11.11.11.1.2.3.cmml" xref="S3.E3.m1.28.28.28.11.11.11.1.2.3">𝑡</ci></apply><apply id="S3.E3.m1.28.28.28.11.11.11.1.3.cmml" xref="S3.E3.m1.28.28.28.11.11.11.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.28.28.28.11.11.11.1.3.1.cmml" xref="S3.E3.m1.28.28.28.11.11.11.1.3">superscript</csymbol><ci id="S3.E3.m1.28.28.28.11.11.11.1.3.2.cmml" xref="S3.E3.m1.28.28.28.11.11.11.1.3.2">𝑑</ci><ci id="S3.E3.m1.28.28.28.11.11.11.1.3.3.cmml" xref="S3.E3.m1.28.28.28.11.11.11.1.3.3">′</ci></apply></apply></apply></apply><apply id="S3.E3.m1.36.36.2.2.2.2.2.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><in id="S3.E3.m1.32.32.32.15.15.15.cmml" xref="S3.E3.m1.32.32.32.15.15.15"></in><apply id="S3.E3.m1.36.36.2.2.2.2.2.2.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.36.36.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1">subscript</csymbol><ci id="S3.E3.m1.30.30.30.13.13.13.cmml" xref="S3.E3.m1.30.30.30.13.13.13">𝑊</ci><ci id="S3.E3.m1.31.31.31.14.14.14.1.cmml" xref="S3.E3.m1.31.31.31.14.14.14.1">𝑐</ci></apply><apply id="S3.E3.m1.36.36.2.2.2.2.2.3.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.36.36.2.2.2.2.2.3.1.cmml" xref="S3.E3.m1.17.17.17.17.17.19.1.1">superscript</csymbol><ci id="S3.E3.m1.33.33.33.16.16.16.cmml" xref="S3.E3.m1.33.33.33.16.16.16">ℝ</ci><apply id="S3.E3.m1.34.34.34.17.17.17.1.cmml" xref="S3.E3.m1.34.34.34.17.17.17.1"><times id="S3.E3.m1.34.34.34.17.17.17.1.1.cmml" xref="S3.E3.m1.34.34.34.17.17.17.1.1"></times><apply id="S3.E3.m1.34.34.34.17.17.17.1.2.cmml" xref="S3.E3.m1.34.34.34.17.17.17.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.34.34.34.17.17.17.1.2.1.cmml" xref="S3.E3.m1.34.34.34.17.17.17.1.2">subscript</csymbol><ci id="S3.E3.m1.34.34.34.17.17.17.1.2.2.cmml" xref="S3.E3.m1.34.34.34.17.17.17.1.2.2">𝑑</ci><ci id="S3.E3.m1.34.34.34.17.17.17.1.2.3.cmml" xref="S3.E3.m1.34.34.34.17.17.17.1.2.3">𝑐</ci></apply><apply id="S3.E3.m1.34.34.34.17.17.17.1.3.cmml" xref="S3.E3.m1.34.34.34.17.17.17.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.34.34.34.17.17.17.1.3.1.cmml" xref="S3.E3.m1.34.34.34.17.17.17.1.3">superscript</csymbol><ci id="S3.E3.m1.34.34.34.17.17.17.1.3.2.cmml" xref="S3.E3.m1.34.34.34.17.17.17.1.3.2">𝑑</ci><ci id="S3.E3.m1.34.34.34.17.17.17.1.3.3.cmml" xref="S3.E3.m1.34.34.34.17.17.17.1.3.3">′</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.38c">\begin{split}E_{m}=E_{v}W_{v}+E_{t}W_{t}+E_{c}W_{c}\\
W_{v}\in\mathbb{R}^{d_{v}\times d^{\prime}},W_{t}\in\mathbb{R}^{d_{t}\times d^%
{\prime}},W_{c}\in\mathbb{R}^{d_{c}\times d^{\prime}}\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.38d">start_ROW start_CELL italic_E start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = italic_E start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT + italic_E start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_E start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT × italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT × italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.7">When performing the attention operation, the SASRec’s attention calculation process was employed <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib9" title="">2018</a>)</cite>.
Additionally, multimodal representations are added directly block by block, reducing the computational complexity and preventing overfitting <cite class="ltx_cite ltx_citemacro_citep">(Xie et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib22" title="">2022</a>)</cite>.
The formula for the overall structure of the fusion module can be expressed as shown in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S3.E4" title="Equation 4 ‣ 3.3 Multimodal fusion module ‣ 3 Proposed method ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">4</span></a>:
<math alttext="R^{k}" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><msup id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">R</mi><mi id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">𝑅</ci><ci id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">R^{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">italic_R start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the updated sequence that has passed through the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.1"><semantics id="S3.SS3.p3.2.m2.1a"><mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.m2.1d">italic_k</annotation></semantics></math>–th block from the sequence and the multimodal input, <math alttext="FFN" class="ltx_Math" display="inline" id="S3.SS3.p3.3.m3.1"><semantics id="S3.SS3.p3.3.m3.1a"><mrow id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2" xref="S3.SS3.p3.3.m3.1.1.2.cmml">F</mi><mo id="S3.SS3.p3.3.m3.1.1.1" xref="S3.SS3.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3.cmml">F</mi><mo id="S3.SS3.p3.3.m3.1.1.1a" xref="S3.SS3.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p3.3.m3.1.1.4" xref="S3.SS3.p3.3.m3.1.1.4.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><times id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1.1"></times><ci id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2">𝐹</ci><ci id="S3.SS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3">𝐹</ci><ci id="S3.SS3.p3.3.m3.1.1.4.cmml" xref="S3.SS3.p3.3.m3.1.1.4">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">FFN</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.3.m3.1d">italic_F italic_F italic_N</annotation></semantics></math> is a fully connected feed-forward network, and <math alttext="LN" class="ltx_Math" display="inline" id="S3.SS3.p3.4.m4.1"><semantics id="S3.SS3.p3.4.m4.1a"><mrow id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml"><mi id="S3.SS3.p3.4.m4.1.1.2" xref="S3.SS3.p3.4.m4.1.1.2.cmml">L</mi><mo id="S3.SS3.p3.4.m4.1.1.1" xref="S3.SS3.p3.4.m4.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p3.4.m4.1.1.3" xref="S3.SS3.p3.4.m4.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><apply id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1"><times id="S3.SS3.p3.4.m4.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1.1"></times><ci id="S3.SS3.p3.4.m4.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2">𝐿</ci><ci id="S3.SS3.p3.4.m4.1.1.3.cmml" xref="S3.SS3.p3.4.m4.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">LN</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.4.m4.1d">italic_L italic_N</annotation></semantics></math> is the layer normalization.
When <math alttext="k=1" class="ltx_Math" display="inline" id="S3.SS3.p3.5.m5.1"><semantics id="S3.SS3.p3.5.m5.1a"><mrow id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml"><mi id="S3.SS3.p3.5.m5.1.1.2" xref="S3.SS3.p3.5.m5.1.1.2.cmml">k</mi><mo id="S3.SS3.p3.5.m5.1.1.1" xref="S3.SS3.p3.5.m5.1.1.1.cmml">=</mo><mn id="S3.SS3.p3.5.m5.1.1.3" xref="S3.SS3.p3.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><apply id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1"><eq id="S3.SS3.p3.5.m5.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1.1"></eq><ci id="S3.SS3.p3.5.m5.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2">𝑘</ci><cn id="S3.SS3.p3.5.m5.1.1.3.cmml" type="integer" xref="S3.SS3.p3.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">k=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.5.m5.1d">italic_k = 1</annotation></semantics></math>, <math alttext="R^{1}" class="ltx_Math" display="inline" id="S3.SS3.p3.6.m6.1"><semantics id="S3.SS3.p3.6.m6.1a"><msup id="S3.SS3.p3.6.m6.1.1" xref="S3.SS3.p3.6.m6.1.1.cmml"><mi id="S3.SS3.p3.6.m6.1.1.2" xref="S3.SS3.p3.6.m6.1.1.2.cmml">R</mi><mn id="S3.SS3.p3.6.m6.1.1.3" xref="S3.SS3.p3.6.m6.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.1b"><apply id="S3.SS3.p3.6.m6.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1">superscript</csymbol><ci id="S3.SS3.p3.6.m6.1.1.2.cmml" xref="S3.SS3.p3.6.m6.1.1.2">𝑅</ci><cn id="S3.SS3.p3.6.m6.1.1.3.cmml" type="integer" xref="S3.SS3.p3.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.1c">R^{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.6.m6.1d">italic_R start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math> refers to the <math alttext="E_{ID}" class="ltx_Math" display="inline" id="S3.SS3.p3.7.m7.1"><semantics id="S3.SS3.p3.7.m7.1a"><msub id="S3.SS3.p3.7.m7.1.1" xref="S3.SS3.p3.7.m7.1.1.cmml"><mi id="S3.SS3.p3.7.m7.1.1.2" xref="S3.SS3.p3.7.m7.1.1.2.cmml">E</mi><mrow id="S3.SS3.p3.7.m7.1.1.3" xref="S3.SS3.p3.7.m7.1.1.3.cmml"><mi id="S3.SS3.p3.7.m7.1.1.3.2" xref="S3.SS3.p3.7.m7.1.1.3.2.cmml">I</mi><mo id="S3.SS3.p3.7.m7.1.1.3.1" xref="S3.SS3.p3.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.7.m7.1.1.3.3" xref="S3.SS3.p3.7.m7.1.1.3.3.cmml">D</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m7.1b"><apply id="S3.SS3.p3.7.m7.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m7.1.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p3.7.m7.1.1.2.cmml" xref="S3.SS3.p3.7.m7.1.1.2">𝐸</ci><apply id="S3.SS3.p3.7.m7.1.1.3.cmml" xref="S3.SS3.p3.7.m7.1.1.3"><times id="S3.SS3.p3.7.m7.1.1.3.1.cmml" xref="S3.SS3.p3.7.m7.1.1.3.1"></times><ci id="S3.SS3.p3.7.m7.1.1.3.2.cmml" xref="S3.SS3.p3.7.m7.1.1.3.2">𝐼</ci><ci id="S3.SS3.p3.7.m7.1.1.3.3.cmml" xref="S3.SS3.p3.7.m7.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m7.1c">E_{ID}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.7.m7.1d">italic_E start_POSTSUBSCRIPT italic_I italic_D end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="R^{k+1}=LN(FFN(MAF(R^{k},E_{m})))" class="ltx_Math" display="block" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><msup id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.3.2" xref="S3.E4.m1.1.1.3.2.cmml">R</mi><mrow id="S3.E4.m1.1.1.3.3" xref="S3.E4.m1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.3.3.2" xref="S3.E4.m1.1.1.3.3.2.cmml">k</mi><mo id="S3.E4.m1.1.1.3.3.1" xref="S3.E4.m1.1.1.3.3.1.cmml">+</mo><mn id="S3.E4.m1.1.1.3.3.3" xref="S3.E4.m1.1.1.3.3.3.cmml">1</mn></mrow></msup><mo id="S3.E4.m1.1.1.2" xref="S3.E4.m1.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.3.cmml">L</mi><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.E4.m1.1.1.1.4" xref="S3.E4.m1.1.1.1.4.cmml">N</mi><mo id="S3.E4.m1.1.1.1.2a" xref="S3.E4.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.3.cmml">F</mi><mo id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E4.m1.1.1.1.1.1.1.4" xref="S3.E4.m1.1.1.1.1.1.1.4.cmml">F</mi><mo id="S3.E4.m1.1.1.1.1.1.1.2a" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E4.m1.1.1.1.1.1.1.5" xref="S3.E4.m1.1.1.1.1.1.1.5.cmml">N</mi><mo id="S3.E4.m1.1.1.1.1.1.1.2b" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.4" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.4.cmml">M</mi><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.5" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.5.cmml">A</mi><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3a" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.6" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.6.cmml">F</mi><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3b" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msup id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">R</mi><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.4" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">E</mi><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">m</mi></msub><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><eq id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1.2"></eq><apply id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.3">superscript</csymbol><ci id="S3.E4.m1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.3.2">𝑅</ci><apply id="S3.E4.m1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.3.3"><plus id="S3.E4.m1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.3.3.1"></plus><ci id="S3.E4.m1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.3.3.2">𝑘</ci><cn id="S3.E4.m1.1.1.3.3.3.cmml" type="integer" xref="S3.E4.m1.1.1.3.3.3">1</cn></apply></apply><apply id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><times id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.2"></times><ci id="S3.E4.m1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.3">𝐿</ci><ci id="S3.E4.m1.1.1.1.4.cmml" xref="S3.E4.m1.1.1.1.4">𝑁</ci><apply id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2"></times><ci id="S3.E4.m1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3">𝐹</ci><ci id="S3.E4.m1.1.1.1.1.1.1.4.cmml" xref="S3.E4.m1.1.1.1.1.1.1.4">𝐹</ci><ci id="S3.E4.m1.1.1.1.1.1.1.5.cmml" xref="S3.E4.m1.1.1.1.1.1.1.5">𝑁</ci><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3"></times><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.4">𝑀</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.5">𝐴</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.6.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.6">𝐹</ci><interval closure="open" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑅</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝐸</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑚</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">R^{k+1}=LN(FFN(MAF(R^{k},E_{m})))</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">italic_R start_POSTSUPERSCRIPT italic_k + 1 end_POSTSUPERSCRIPT = italic_L italic_N ( italic_F italic_F italic_N ( italic_M italic_A italic_F ( italic_R start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT , italic_E start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ) ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.12">In the case of <math alttext="MAF(\cdot)" class="ltx_Math" display="inline" id="S3.SS3.p5.1.m1.1"><semantics id="S3.SS3.p5.1.m1.1a"><mrow id="S3.SS3.p5.1.m1.1.2" xref="S3.SS3.p5.1.m1.1.2.cmml"><mi id="S3.SS3.p5.1.m1.1.2.2" xref="S3.SS3.p5.1.m1.1.2.2.cmml">M</mi><mo id="S3.SS3.p5.1.m1.1.2.1" xref="S3.SS3.p5.1.m1.1.2.1.cmml">⁢</mo><mi id="S3.SS3.p5.1.m1.1.2.3" xref="S3.SS3.p5.1.m1.1.2.3.cmml">A</mi><mo id="S3.SS3.p5.1.m1.1.2.1a" xref="S3.SS3.p5.1.m1.1.2.1.cmml">⁢</mo><mi id="S3.SS3.p5.1.m1.1.2.4" xref="S3.SS3.p5.1.m1.1.2.4.cmml">F</mi><mo id="S3.SS3.p5.1.m1.1.2.1b" xref="S3.SS3.p5.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p5.1.m1.1.2.5.2" xref="S3.SS3.p5.1.m1.1.2.cmml"><mo id="S3.SS3.p5.1.m1.1.2.5.2.1" stretchy="false" xref="S3.SS3.p5.1.m1.1.2.cmml">(</mo><mo id="S3.SS3.p5.1.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS3.p5.1.m1.1.1.cmml">⋅</mo><mo id="S3.SS3.p5.1.m1.1.2.5.2.2" stretchy="false" xref="S3.SS3.p5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><apply id="S3.SS3.p5.1.m1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.2"><times id="S3.SS3.p5.1.m1.1.2.1.cmml" xref="S3.SS3.p5.1.m1.1.2.1"></times><ci id="S3.SS3.p5.1.m1.1.2.2.cmml" xref="S3.SS3.p5.1.m1.1.2.2">𝑀</ci><ci id="S3.SS3.p5.1.m1.1.2.3.cmml" xref="S3.SS3.p5.1.m1.1.2.3">𝐴</ci><ci id="S3.SS3.p5.1.m1.1.2.4.cmml" xref="S3.SS3.p5.1.m1.1.2.4">𝐹</ci><ci id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">MAF(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.1.m1.1d">italic_M italic_A italic_F ( ⋅ )</annotation></semantics></math>, independent attention operations have a flexible gradient and higher rank, thus improving the representation of the model, enabling it to adaptively learn sequences and multimodality <cite class="ltx_cite ltx_citemacro_citep">(Xie et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib22" title="">2022</a>)</cite>.
The item ID attention matrix <math alttext="att_{ID}^{i}" class="ltx_Math" display="inline" id="S3.SS3.p5.2.m2.1"><semantics id="S3.SS3.p5.2.m2.1a"><mrow id="S3.SS3.p5.2.m2.1.1" xref="S3.SS3.p5.2.m2.1.1.cmml"><mi id="S3.SS3.p5.2.m2.1.1.2" xref="S3.SS3.p5.2.m2.1.1.2.cmml">a</mi><mo id="S3.SS3.p5.2.m2.1.1.1" xref="S3.SS3.p5.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p5.2.m2.1.1.3" xref="S3.SS3.p5.2.m2.1.1.3.cmml">t</mi><mo id="S3.SS3.p5.2.m2.1.1.1a" xref="S3.SS3.p5.2.m2.1.1.1.cmml">⁢</mo><msubsup id="S3.SS3.p5.2.m2.1.1.4" xref="S3.SS3.p5.2.m2.1.1.4.cmml"><mi id="S3.SS3.p5.2.m2.1.1.4.2.2" xref="S3.SS3.p5.2.m2.1.1.4.2.2.cmml">t</mi><mrow id="S3.SS3.p5.2.m2.1.1.4.2.3" xref="S3.SS3.p5.2.m2.1.1.4.2.3.cmml"><mi id="S3.SS3.p5.2.m2.1.1.4.2.3.2" xref="S3.SS3.p5.2.m2.1.1.4.2.3.2.cmml">I</mi><mo id="S3.SS3.p5.2.m2.1.1.4.2.3.1" xref="S3.SS3.p5.2.m2.1.1.4.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p5.2.m2.1.1.4.2.3.3" xref="S3.SS3.p5.2.m2.1.1.4.2.3.3.cmml">D</mi></mrow><mi id="S3.SS3.p5.2.m2.1.1.4.3" xref="S3.SS3.p5.2.m2.1.1.4.3.cmml">i</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.1b"><apply id="S3.SS3.p5.2.m2.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1"><times id="S3.SS3.p5.2.m2.1.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1.1"></times><ci id="S3.SS3.p5.2.m2.1.1.2.cmml" xref="S3.SS3.p5.2.m2.1.1.2">𝑎</ci><ci id="S3.SS3.p5.2.m2.1.1.3.cmml" xref="S3.SS3.p5.2.m2.1.1.3">𝑡</ci><apply id="S3.SS3.p5.2.m2.1.1.4.cmml" xref="S3.SS3.p5.2.m2.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p5.2.m2.1.1.4.1.cmml" xref="S3.SS3.p5.2.m2.1.1.4">superscript</csymbol><apply id="S3.SS3.p5.2.m2.1.1.4.2.cmml" xref="S3.SS3.p5.2.m2.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p5.2.m2.1.1.4.2.1.cmml" xref="S3.SS3.p5.2.m2.1.1.4">subscript</csymbol><ci id="S3.SS3.p5.2.m2.1.1.4.2.2.cmml" xref="S3.SS3.p5.2.m2.1.1.4.2.2">𝑡</ci><apply id="S3.SS3.p5.2.m2.1.1.4.2.3.cmml" xref="S3.SS3.p5.2.m2.1.1.4.2.3"><times id="S3.SS3.p5.2.m2.1.1.4.2.3.1.cmml" xref="S3.SS3.p5.2.m2.1.1.4.2.3.1"></times><ci id="S3.SS3.p5.2.m2.1.1.4.2.3.2.cmml" xref="S3.SS3.p5.2.m2.1.1.4.2.3.2">𝐼</ci><ci id="S3.SS3.p5.2.m2.1.1.4.2.3.3.cmml" xref="S3.SS3.p5.2.m2.1.1.4.2.3.3">𝐷</ci></apply></apply><ci id="S3.SS3.p5.2.m2.1.1.4.3.cmml" xref="S3.SS3.p5.2.m2.1.1.4.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">att_{ID}^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.2.m2.1d">italic_a italic_t italic_t start_POSTSUBSCRIPT italic_I italic_D end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> is calculated by <math alttext="W_{Q}^{i},W_{K}^{i},W_{V}^{i}\in\mathbb{R}^{d_{i}\times d_{h}}" class="ltx_Math" display="inline" id="S3.SS3.p5.3.m3.3"><semantics id="S3.SS3.p5.3.m3.3a"><mrow id="S3.SS3.p5.3.m3.3.3" xref="S3.SS3.p5.3.m3.3.3.cmml"><mrow id="S3.SS3.p5.3.m3.3.3.3.3" xref="S3.SS3.p5.3.m3.3.3.3.4.cmml"><msubsup id="S3.SS3.p5.3.m3.1.1.1.1.1" xref="S3.SS3.p5.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS3.p5.3.m3.1.1.1.1.1.2.2" xref="S3.SS3.p5.3.m3.1.1.1.1.1.2.2.cmml">W</mi><mi id="S3.SS3.p5.3.m3.1.1.1.1.1.2.3" xref="S3.SS3.p5.3.m3.1.1.1.1.1.2.3.cmml">Q</mi><mi id="S3.SS3.p5.3.m3.1.1.1.1.1.3" xref="S3.SS3.p5.3.m3.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.SS3.p5.3.m3.3.3.3.3.4" xref="S3.SS3.p5.3.m3.3.3.3.4.cmml">,</mo><msubsup id="S3.SS3.p5.3.m3.2.2.2.2.2" xref="S3.SS3.p5.3.m3.2.2.2.2.2.cmml"><mi id="S3.SS3.p5.3.m3.2.2.2.2.2.2.2" xref="S3.SS3.p5.3.m3.2.2.2.2.2.2.2.cmml">W</mi><mi id="S3.SS3.p5.3.m3.2.2.2.2.2.2.3" xref="S3.SS3.p5.3.m3.2.2.2.2.2.2.3.cmml">K</mi><mi id="S3.SS3.p5.3.m3.2.2.2.2.2.3" xref="S3.SS3.p5.3.m3.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S3.SS3.p5.3.m3.3.3.3.3.5" xref="S3.SS3.p5.3.m3.3.3.3.4.cmml">,</mo><msubsup id="S3.SS3.p5.3.m3.3.3.3.3.3" xref="S3.SS3.p5.3.m3.3.3.3.3.3.cmml"><mi id="S3.SS3.p5.3.m3.3.3.3.3.3.2.2" xref="S3.SS3.p5.3.m3.3.3.3.3.3.2.2.cmml">W</mi><mi id="S3.SS3.p5.3.m3.3.3.3.3.3.2.3" xref="S3.SS3.p5.3.m3.3.3.3.3.3.2.3.cmml">V</mi><mi id="S3.SS3.p5.3.m3.3.3.3.3.3.3" xref="S3.SS3.p5.3.m3.3.3.3.3.3.3.cmml">i</mi></msubsup></mrow><mo id="S3.SS3.p5.3.m3.3.3.4" xref="S3.SS3.p5.3.m3.3.3.4.cmml">∈</mo><msup id="S3.SS3.p5.3.m3.3.3.5" xref="S3.SS3.p5.3.m3.3.3.5.cmml"><mi id="S3.SS3.p5.3.m3.3.3.5.2" xref="S3.SS3.p5.3.m3.3.3.5.2.cmml">ℝ</mi><mrow id="S3.SS3.p5.3.m3.3.3.5.3" xref="S3.SS3.p5.3.m3.3.3.5.3.cmml"><msub id="S3.SS3.p5.3.m3.3.3.5.3.2" xref="S3.SS3.p5.3.m3.3.3.5.3.2.cmml"><mi id="S3.SS3.p5.3.m3.3.3.5.3.2.2" xref="S3.SS3.p5.3.m3.3.3.5.3.2.2.cmml">d</mi><mi id="S3.SS3.p5.3.m3.3.3.5.3.2.3" xref="S3.SS3.p5.3.m3.3.3.5.3.2.3.cmml">i</mi></msub><mo id="S3.SS3.p5.3.m3.3.3.5.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p5.3.m3.3.3.5.3.1.cmml">×</mo><msub id="S3.SS3.p5.3.m3.3.3.5.3.3" xref="S3.SS3.p5.3.m3.3.3.5.3.3.cmml"><mi id="S3.SS3.p5.3.m3.3.3.5.3.3.2" xref="S3.SS3.p5.3.m3.3.3.5.3.3.2.cmml">d</mi><mi id="S3.SS3.p5.3.m3.3.3.5.3.3.3" xref="S3.SS3.p5.3.m3.3.3.5.3.3.3.cmml">h</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.3.m3.3b"><apply id="S3.SS3.p5.3.m3.3.3.cmml" xref="S3.SS3.p5.3.m3.3.3"><in id="S3.SS3.p5.3.m3.3.3.4.cmml" xref="S3.SS3.p5.3.m3.3.3.4"></in><list id="S3.SS3.p5.3.m3.3.3.3.4.cmml" xref="S3.SS3.p5.3.m3.3.3.3.3"><apply id="S3.SS3.p5.3.m3.1.1.1.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p5.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS3.p5.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p5.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p5.3.m3.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p5.3.m3.1.1.1.1.1.2.2">𝑊</ci><ci id="S3.SS3.p5.3.m3.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p5.3.m3.1.1.1.1.1.2.3">𝑄</ci></apply><ci id="S3.SS3.p5.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS3.p5.3.m3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS3.p5.3.m3.2.2.2.2.2.cmml" xref="S3.SS3.p5.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.2.2.2.2.2.1.cmml" xref="S3.SS3.p5.3.m3.2.2.2.2.2">superscript</csymbol><apply id="S3.SS3.p5.3.m3.2.2.2.2.2.2.cmml" xref="S3.SS3.p5.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.2.2.2.2.2.2.1.cmml" xref="S3.SS3.p5.3.m3.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p5.3.m3.2.2.2.2.2.2.2.cmml" xref="S3.SS3.p5.3.m3.2.2.2.2.2.2.2">𝑊</ci><ci id="S3.SS3.p5.3.m3.2.2.2.2.2.2.3.cmml" xref="S3.SS3.p5.3.m3.2.2.2.2.2.2.3">𝐾</ci></apply><ci id="S3.SS3.p5.3.m3.2.2.2.2.2.3.cmml" xref="S3.SS3.p5.3.m3.2.2.2.2.2.3">𝑖</ci></apply><apply id="S3.SS3.p5.3.m3.3.3.3.3.3.cmml" xref="S3.SS3.p5.3.m3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.3.3.3.3.3.1.cmml" xref="S3.SS3.p5.3.m3.3.3.3.3.3">superscript</csymbol><apply id="S3.SS3.p5.3.m3.3.3.3.3.3.2.cmml" xref="S3.SS3.p5.3.m3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.3.3.3.3.3.2.1.cmml" xref="S3.SS3.p5.3.m3.3.3.3.3.3">subscript</csymbol><ci id="S3.SS3.p5.3.m3.3.3.3.3.3.2.2.cmml" xref="S3.SS3.p5.3.m3.3.3.3.3.3.2.2">𝑊</ci><ci id="S3.SS3.p5.3.m3.3.3.3.3.3.2.3.cmml" xref="S3.SS3.p5.3.m3.3.3.3.3.3.2.3">𝑉</ci></apply><ci id="S3.SS3.p5.3.m3.3.3.3.3.3.3.cmml" xref="S3.SS3.p5.3.m3.3.3.3.3.3.3">𝑖</ci></apply></list><apply id="S3.SS3.p5.3.m3.3.3.5.cmml" xref="S3.SS3.p5.3.m3.3.3.5"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.3.3.5.1.cmml" xref="S3.SS3.p5.3.m3.3.3.5">superscript</csymbol><ci id="S3.SS3.p5.3.m3.3.3.5.2.cmml" xref="S3.SS3.p5.3.m3.3.3.5.2">ℝ</ci><apply id="S3.SS3.p5.3.m3.3.3.5.3.cmml" xref="S3.SS3.p5.3.m3.3.3.5.3"><times id="S3.SS3.p5.3.m3.3.3.5.3.1.cmml" xref="S3.SS3.p5.3.m3.3.3.5.3.1"></times><apply id="S3.SS3.p5.3.m3.3.3.5.3.2.cmml" xref="S3.SS3.p5.3.m3.3.3.5.3.2"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.3.3.5.3.2.1.cmml" xref="S3.SS3.p5.3.m3.3.3.5.3.2">subscript</csymbol><ci id="S3.SS3.p5.3.m3.3.3.5.3.2.2.cmml" xref="S3.SS3.p5.3.m3.3.3.5.3.2.2">𝑑</ci><ci id="S3.SS3.p5.3.m3.3.3.5.3.2.3.cmml" xref="S3.SS3.p5.3.m3.3.3.5.3.2.3">𝑖</ci></apply><apply id="S3.SS3.p5.3.m3.3.3.5.3.3.cmml" xref="S3.SS3.p5.3.m3.3.3.5.3.3"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.3.3.5.3.3.1.cmml" xref="S3.SS3.p5.3.m3.3.3.5.3.3">subscript</csymbol><ci id="S3.SS3.p5.3.m3.3.3.5.3.3.2.cmml" xref="S3.SS3.p5.3.m3.3.3.5.3.3.2">𝑑</ci><ci id="S3.SS3.p5.3.m3.3.3.5.3.3.3.cmml" xref="S3.SS3.p5.3.m3.3.3.5.3.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.3.m3.3c">W_{Q}^{i},W_{K}^{i},W_{V}^{i}\in\mathbb{R}^{d_{i}\times d_{h}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.3.m3.3d">italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> that is divided by the size <math alttext="d_{h}=d/h" class="ltx_Math" display="inline" id="S3.SS3.p5.4.m4.1"><semantics id="S3.SS3.p5.4.m4.1a"><mrow id="S3.SS3.p5.4.m4.1.1" xref="S3.SS3.p5.4.m4.1.1.cmml"><msub id="S3.SS3.p5.4.m4.1.1.2" xref="S3.SS3.p5.4.m4.1.1.2.cmml"><mi id="S3.SS3.p5.4.m4.1.1.2.2" xref="S3.SS3.p5.4.m4.1.1.2.2.cmml">d</mi><mi id="S3.SS3.p5.4.m4.1.1.2.3" xref="S3.SS3.p5.4.m4.1.1.2.3.cmml">h</mi></msub><mo id="S3.SS3.p5.4.m4.1.1.1" xref="S3.SS3.p5.4.m4.1.1.1.cmml">=</mo><mrow id="S3.SS3.p5.4.m4.1.1.3" xref="S3.SS3.p5.4.m4.1.1.3.cmml"><mi id="S3.SS3.p5.4.m4.1.1.3.2" xref="S3.SS3.p5.4.m4.1.1.3.2.cmml">d</mi><mo id="S3.SS3.p5.4.m4.1.1.3.1" xref="S3.SS3.p5.4.m4.1.1.3.1.cmml">/</mo><mi id="S3.SS3.p5.4.m4.1.1.3.3" xref="S3.SS3.p5.4.m4.1.1.3.3.cmml">h</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.4.m4.1b"><apply id="S3.SS3.p5.4.m4.1.1.cmml" xref="S3.SS3.p5.4.m4.1.1"><eq id="S3.SS3.p5.4.m4.1.1.1.cmml" xref="S3.SS3.p5.4.m4.1.1.1"></eq><apply id="S3.SS3.p5.4.m4.1.1.2.cmml" xref="S3.SS3.p5.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p5.4.m4.1.1.2.1.cmml" xref="S3.SS3.p5.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.p5.4.m4.1.1.2.2.cmml" xref="S3.SS3.p5.4.m4.1.1.2.2">𝑑</ci><ci id="S3.SS3.p5.4.m4.1.1.2.3.cmml" xref="S3.SS3.p5.4.m4.1.1.2.3">ℎ</ci></apply><apply id="S3.SS3.p5.4.m4.1.1.3.cmml" xref="S3.SS3.p5.4.m4.1.1.3"><divide id="S3.SS3.p5.4.m4.1.1.3.1.cmml" xref="S3.SS3.p5.4.m4.1.1.3.1"></divide><ci id="S3.SS3.p5.4.m4.1.1.3.2.cmml" xref="S3.SS3.p5.4.m4.1.1.3.2">𝑑</ci><ci id="S3.SS3.p5.4.m4.1.1.3.3.cmml" xref="S3.SS3.p5.4.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.4.m4.1c">d_{h}=d/h</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.4.m4.1d">italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT = italic_d / italic_h</annotation></semantics></math> for <math alttext="h" class="ltx_Math" display="inline" id="S3.SS3.p5.5.m5.1"><semantics id="S3.SS3.p5.5.m5.1a"><mi id="S3.SS3.p5.5.m5.1.1" xref="S3.SS3.p5.5.m5.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.5.m5.1b"><ci id="S3.SS3.p5.5.m5.1.1.cmml" xref="S3.SS3.p5.5.m5.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.5.m5.1c">h</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.5.m5.1d">italic_h</annotation></semantics></math>’s multi heads among all dimensions <math alttext="d" class="ltx_Math" display="inline" id="S3.SS3.p5.6.m6.1"><semantics id="S3.SS3.p5.6.m6.1a"><mi id="S3.SS3.p5.6.m6.1.1" xref="S3.SS3.p5.6.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.6.m6.1b"><ci id="S3.SS3.p5.6.m6.1.1.cmml" xref="S3.SS3.p5.6.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.6.m6.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.6.m6.1d">italic_d</annotation></semantics></math> from the sequence <math alttext="R^{k}" class="ltx_Math" display="inline" id="S3.SS3.p5.7.m7.1"><semantics id="S3.SS3.p5.7.m7.1a"><msup id="S3.SS3.p5.7.m7.1.1" xref="S3.SS3.p5.7.m7.1.1.cmml"><mi id="S3.SS3.p5.7.m7.1.1.2" xref="S3.SS3.p5.7.m7.1.1.2.cmml">R</mi><mi id="S3.SS3.p5.7.m7.1.1.3" xref="S3.SS3.p5.7.m7.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.7.m7.1b"><apply id="S3.SS3.p5.7.m7.1.1.cmml" xref="S3.SS3.p5.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.7.m7.1.1.1.cmml" xref="S3.SS3.p5.7.m7.1.1">superscript</csymbol><ci id="S3.SS3.p5.7.m7.1.1.2.cmml" xref="S3.SS3.p5.7.m7.1.1.2">𝑅</ci><ci id="S3.SS3.p5.7.m7.1.1.3.cmml" xref="S3.SS3.p5.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.7.m7.1c">R^{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.7.m7.1d">italic_R start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>.
Similarly, <math alttext="W_{Q}^{m}" class="ltx_Math" display="inline" id="S3.SS3.p5.8.m8.1"><semantics id="S3.SS3.p5.8.m8.1a"><msubsup id="S3.SS3.p5.8.m8.1.1" xref="S3.SS3.p5.8.m8.1.1.cmml"><mi id="S3.SS3.p5.8.m8.1.1.2.2" xref="S3.SS3.p5.8.m8.1.1.2.2.cmml">W</mi><mi id="S3.SS3.p5.8.m8.1.1.2.3" xref="S3.SS3.p5.8.m8.1.1.2.3.cmml">Q</mi><mi id="S3.SS3.p5.8.m8.1.1.3" xref="S3.SS3.p5.8.m8.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.8.m8.1b"><apply id="S3.SS3.p5.8.m8.1.1.cmml" xref="S3.SS3.p5.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.8.m8.1.1.1.cmml" xref="S3.SS3.p5.8.m8.1.1">superscript</csymbol><apply id="S3.SS3.p5.8.m8.1.1.2.cmml" xref="S3.SS3.p5.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.8.m8.1.1.2.1.cmml" xref="S3.SS3.p5.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.p5.8.m8.1.1.2.2.cmml" xref="S3.SS3.p5.8.m8.1.1.2.2">𝑊</ci><ci id="S3.SS3.p5.8.m8.1.1.2.3.cmml" xref="S3.SS3.p5.8.m8.1.1.2.3">𝑄</ci></apply><ci id="S3.SS3.p5.8.m8.1.1.3.cmml" xref="S3.SS3.p5.8.m8.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.8.m8.1c">W_{Q}^{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.8.m8.1d">italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="W_{K}^{m}\in\mathbb{R}^{d^{\prime}\times d^{\prime}_{h}}" class="ltx_Math" display="inline" id="S3.SS3.p5.9.m9.1"><semantics id="S3.SS3.p5.9.m9.1a"><mrow id="S3.SS3.p5.9.m9.1.1" xref="S3.SS3.p5.9.m9.1.1.cmml"><msubsup id="S3.SS3.p5.9.m9.1.1.2" xref="S3.SS3.p5.9.m9.1.1.2.cmml"><mi id="S3.SS3.p5.9.m9.1.1.2.2.2" xref="S3.SS3.p5.9.m9.1.1.2.2.2.cmml">W</mi><mi id="S3.SS3.p5.9.m9.1.1.2.2.3" xref="S3.SS3.p5.9.m9.1.1.2.2.3.cmml">K</mi><mi id="S3.SS3.p5.9.m9.1.1.2.3" xref="S3.SS3.p5.9.m9.1.1.2.3.cmml">m</mi></msubsup><mo id="S3.SS3.p5.9.m9.1.1.1" xref="S3.SS3.p5.9.m9.1.1.1.cmml">∈</mo><msup id="S3.SS3.p5.9.m9.1.1.3" xref="S3.SS3.p5.9.m9.1.1.3.cmml"><mi id="S3.SS3.p5.9.m9.1.1.3.2" xref="S3.SS3.p5.9.m9.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p5.9.m9.1.1.3.3" xref="S3.SS3.p5.9.m9.1.1.3.3.cmml"><msup id="S3.SS3.p5.9.m9.1.1.3.3.2" xref="S3.SS3.p5.9.m9.1.1.3.3.2.cmml"><mi id="S3.SS3.p5.9.m9.1.1.3.3.2.2" xref="S3.SS3.p5.9.m9.1.1.3.3.2.2.cmml">d</mi><mo id="S3.SS3.p5.9.m9.1.1.3.3.2.3" xref="S3.SS3.p5.9.m9.1.1.3.3.2.3.cmml">′</mo></msup><mo id="S3.SS3.p5.9.m9.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p5.9.m9.1.1.3.3.1.cmml">×</mo><msubsup id="S3.SS3.p5.9.m9.1.1.3.3.3" xref="S3.SS3.p5.9.m9.1.1.3.3.3.cmml"><mi id="S3.SS3.p5.9.m9.1.1.3.3.3.2.2" xref="S3.SS3.p5.9.m9.1.1.3.3.3.2.2.cmml">d</mi><mi id="S3.SS3.p5.9.m9.1.1.3.3.3.3" xref="S3.SS3.p5.9.m9.1.1.3.3.3.3.cmml">h</mi><mo id="S3.SS3.p5.9.m9.1.1.3.3.3.2.3" xref="S3.SS3.p5.9.m9.1.1.3.3.3.2.3.cmml">′</mo></msubsup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.9.m9.1b"><apply id="S3.SS3.p5.9.m9.1.1.cmml" xref="S3.SS3.p5.9.m9.1.1"><in id="S3.SS3.p5.9.m9.1.1.1.cmml" xref="S3.SS3.p5.9.m9.1.1.1"></in><apply id="S3.SS3.p5.9.m9.1.1.2.cmml" xref="S3.SS3.p5.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p5.9.m9.1.1.2.1.cmml" xref="S3.SS3.p5.9.m9.1.1.2">superscript</csymbol><apply id="S3.SS3.p5.9.m9.1.1.2.2.cmml" xref="S3.SS3.p5.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p5.9.m9.1.1.2.2.1.cmml" xref="S3.SS3.p5.9.m9.1.1.2">subscript</csymbol><ci id="S3.SS3.p5.9.m9.1.1.2.2.2.cmml" xref="S3.SS3.p5.9.m9.1.1.2.2.2">𝑊</ci><ci id="S3.SS3.p5.9.m9.1.1.2.2.3.cmml" xref="S3.SS3.p5.9.m9.1.1.2.2.3">𝐾</ci></apply><ci id="S3.SS3.p5.9.m9.1.1.2.3.cmml" xref="S3.SS3.p5.9.m9.1.1.2.3">𝑚</ci></apply><apply id="S3.SS3.p5.9.m9.1.1.3.cmml" xref="S3.SS3.p5.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.9.m9.1.1.3.1.cmml" xref="S3.SS3.p5.9.m9.1.1.3">superscript</csymbol><ci id="S3.SS3.p5.9.m9.1.1.3.2.cmml" xref="S3.SS3.p5.9.m9.1.1.3.2">ℝ</ci><apply id="S3.SS3.p5.9.m9.1.1.3.3.cmml" xref="S3.SS3.p5.9.m9.1.1.3.3"><times id="S3.SS3.p5.9.m9.1.1.3.3.1.cmml" xref="S3.SS3.p5.9.m9.1.1.3.3.1"></times><apply id="S3.SS3.p5.9.m9.1.1.3.3.2.cmml" xref="S3.SS3.p5.9.m9.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p5.9.m9.1.1.3.3.2.1.cmml" xref="S3.SS3.p5.9.m9.1.1.3.3.2">superscript</csymbol><ci id="S3.SS3.p5.9.m9.1.1.3.3.2.2.cmml" xref="S3.SS3.p5.9.m9.1.1.3.3.2.2">𝑑</ci><ci id="S3.SS3.p5.9.m9.1.1.3.3.2.3.cmml" xref="S3.SS3.p5.9.m9.1.1.3.3.2.3">′</ci></apply><apply id="S3.SS3.p5.9.m9.1.1.3.3.3.cmml" xref="S3.SS3.p5.9.m9.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p5.9.m9.1.1.3.3.3.1.cmml" xref="S3.SS3.p5.9.m9.1.1.3.3.3">subscript</csymbol><apply id="S3.SS3.p5.9.m9.1.1.3.3.3.2.cmml" xref="S3.SS3.p5.9.m9.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p5.9.m9.1.1.3.3.3.2.1.cmml" xref="S3.SS3.p5.9.m9.1.1.3.3.3">superscript</csymbol><ci id="S3.SS3.p5.9.m9.1.1.3.3.3.2.2.cmml" xref="S3.SS3.p5.9.m9.1.1.3.3.3.2.2">𝑑</ci><ci id="S3.SS3.p5.9.m9.1.1.3.3.3.2.3.cmml" xref="S3.SS3.p5.9.m9.1.1.3.3.3.2.3">′</ci></apply><ci id="S3.SS3.p5.9.m9.1.1.3.3.3.3.cmml" xref="S3.SS3.p5.9.m9.1.1.3.3.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.9.m9.1c">W_{K}^{m}\in\mathbb{R}^{d^{\prime}\times d^{\prime}_{h}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.9.m9.1d">italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT × italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is used to compute the multimodal attention matrix <math alttext="att_{m}^{i}" class="ltx_Math" display="inline" id="S3.SS3.p5.10.m10.1"><semantics id="S3.SS3.p5.10.m10.1a"><mrow id="S3.SS3.p5.10.m10.1.1" xref="S3.SS3.p5.10.m10.1.1.cmml"><mi id="S3.SS3.p5.10.m10.1.1.2" xref="S3.SS3.p5.10.m10.1.1.2.cmml">a</mi><mo id="S3.SS3.p5.10.m10.1.1.1" xref="S3.SS3.p5.10.m10.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p5.10.m10.1.1.3" xref="S3.SS3.p5.10.m10.1.1.3.cmml">t</mi><mo id="S3.SS3.p5.10.m10.1.1.1a" xref="S3.SS3.p5.10.m10.1.1.1.cmml">⁢</mo><msubsup id="S3.SS3.p5.10.m10.1.1.4" xref="S3.SS3.p5.10.m10.1.1.4.cmml"><mi id="S3.SS3.p5.10.m10.1.1.4.2.2" xref="S3.SS3.p5.10.m10.1.1.4.2.2.cmml">t</mi><mi id="S3.SS3.p5.10.m10.1.1.4.2.3" xref="S3.SS3.p5.10.m10.1.1.4.2.3.cmml">m</mi><mi id="S3.SS3.p5.10.m10.1.1.4.3" xref="S3.SS3.p5.10.m10.1.1.4.3.cmml">i</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.10.m10.1b"><apply id="S3.SS3.p5.10.m10.1.1.cmml" xref="S3.SS3.p5.10.m10.1.1"><times id="S3.SS3.p5.10.m10.1.1.1.cmml" xref="S3.SS3.p5.10.m10.1.1.1"></times><ci id="S3.SS3.p5.10.m10.1.1.2.cmml" xref="S3.SS3.p5.10.m10.1.1.2">𝑎</ci><ci id="S3.SS3.p5.10.m10.1.1.3.cmml" xref="S3.SS3.p5.10.m10.1.1.3">𝑡</ci><apply id="S3.SS3.p5.10.m10.1.1.4.cmml" xref="S3.SS3.p5.10.m10.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p5.10.m10.1.1.4.1.cmml" xref="S3.SS3.p5.10.m10.1.1.4">superscript</csymbol><apply id="S3.SS3.p5.10.m10.1.1.4.2.cmml" xref="S3.SS3.p5.10.m10.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p5.10.m10.1.1.4.2.1.cmml" xref="S3.SS3.p5.10.m10.1.1.4">subscript</csymbol><ci id="S3.SS3.p5.10.m10.1.1.4.2.2.cmml" xref="S3.SS3.p5.10.m10.1.1.4.2.2">𝑡</ci><ci id="S3.SS3.p5.10.m10.1.1.4.2.3.cmml" xref="S3.SS3.p5.10.m10.1.1.4.2.3">𝑚</ci></apply><ci id="S3.SS3.p5.10.m10.1.1.4.3.cmml" xref="S3.SS3.p5.10.m10.1.1.4.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.10.m10.1c">att_{m}^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.10.m10.1d">italic_a italic_t italic_t start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>.
In this case, the multimodal dimension <math alttext="d^{\prime}" class="ltx_Math" display="inline" id="S3.SS3.p5.11.m11.1"><semantics id="S3.SS3.p5.11.m11.1a"><msup id="S3.SS3.p5.11.m11.1.1" xref="S3.SS3.p5.11.m11.1.1.cmml"><mi id="S3.SS3.p5.11.m11.1.1.2" xref="S3.SS3.p5.11.m11.1.1.2.cmml">d</mi><mo id="S3.SS3.p5.11.m11.1.1.3" xref="S3.SS3.p5.11.m11.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.11.m11.1b"><apply id="S3.SS3.p5.11.m11.1.1.cmml" xref="S3.SS3.p5.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.11.m11.1.1.1.cmml" xref="S3.SS3.p5.11.m11.1.1">superscript</csymbol><ci id="S3.SS3.p5.11.m11.1.1.2.cmml" xref="S3.SS3.p5.11.m11.1.1.2">𝑑</ci><ci id="S3.SS3.p5.11.m11.1.1.3.cmml" xref="S3.SS3.p5.11.m11.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.11.m11.1c">d^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.11.m11.1d">italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> should be smaller than or equal to the sequence dimension <math alttext="d" class="ltx_Math" display="inline" id="S3.SS3.p5.12.m12.1"><semantics id="S3.SS3.p5.12.m12.1a"><mi id="S3.SS3.p5.12.m12.1.1" xref="S3.SS3.p5.12.m12.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.12.m12.1b"><ci id="S3.SS3.p5.12.m12.1.1.cmml" xref="S3.SS3.p5.12.m12.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.12.m12.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.12.m12.1d">italic_d</annotation></semantics></math> to prevent overfitting and to reduce the amount of computation.
Attention scores for item ID representation and multimodal representation are calculated as follows:</p>
</div>
<div class="ltx_para" id="S3.SS3.p6">
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\begin{split}att_{ID}^{i}&amp;=(R^{k}W_{Q}^{i})(R^{k}W_{K}^{i})^{\mathsf{T}}\\
att_{m}^{i}&amp;=(E_{m}W_{Q}^{m})(E_{m}W_{K}^{m})^{\mathsf{T}}\end{split}" class="ltx_Math" display="block" id="S3.E5.m1.50"><semantics id="S3.E5.m1.50a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E5.m1.50.50.8" rowspacing="0pt" xref="S3.E5.m1.46.46.4.cmml"><mtr id="S3.E5.m1.50.50.8a" xref="S3.E5.m1.46.46.4.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.50.50.8b" xref="S3.E5.m1.46.46.4.cmml"><mrow id="S3.E5.m1.5.5.5.5.5" xref="S3.E5.m1.46.46.4.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml">a</mi><mo id="S3.E5.m1.5.5.5.5.5.6" xref="S3.E5.m1.46.46.4a.cmml">⁢</mo><mi id="S3.E5.m1.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.cmml">t</mi><mo id="S3.E5.m1.5.5.5.5.5.6a" xref="S3.E5.m1.46.46.4a.cmml">⁢</mo><msubsup id="S3.E5.m1.5.5.5.5.5.7" xref="S3.E5.m1.46.46.4.cmml"><mi id="S3.E5.m1.3.3.3.3.3.3" xref="S3.E5.m1.3.3.3.3.3.3.cmml">t</mi><mrow id="S3.E5.m1.4.4.4.4.4.4.1" xref="S3.E5.m1.4.4.4.4.4.4.1.cmml"><mi id="S3.E5.m1.4.4.4.4.4.4.1.2" xref="S3.E5.m1.4.4.4.4.4.4.1.2.cmml">I</mi><mo id="S3.E5.m1.4.4.4.4.4.4.1.1" xref="S3.E5.m1.4.4.4.4.4.4.1.1.cmml">⁢</mo><mi id="S3.E5.m1.4.4.4.4.4.4.1.3" xref="S3.E5.m1.4.4.4.4.4.4.1.3.cmml">D</mi></mrow><mi id="S3.E5.m1.5.5.5.5.5.5.1" xref="S3.E5.m1.5.5.5.5.5.5.1.cmml">i</mi></msubsup></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.50.50.8c" xref="S3.E5.m1.46.46.4.cmml"><mrow id="S3.E5.m1.48.48.6.44.23.18" xref="S3.E5.m1.46.46.4.cmml"><mi id="S3.E5.m1.48.48.6.44.23.18.19" xref="S3.E5.m1.46.46.4a.cmml"></mi><mo id="S3.E5.m1.6.6.6.6.1.1" xref="S3.E5.m1.6.6.6.6.1.1.cmml">=</mo><mrow id="S3.E5.m1.48.48.6.44.23.18.18" xref="S3.E5.m1.46.46.4.cmml"><mrow id="S3.E5.m1.47.47.5.43.22.17.17.1.1" xref="S3.E5.m1.46.46.4.cmml"><mo id="S3.E5.m1.7.7.7.7.2.2" stretchy="false" xref="S3.E5.m1.46.46.4a.cmml">(</mo><mrow id="S3.E5.m1.47.47.5.43.22.17.17.1.1.1" xref="S3.E5.m1.46.46.4.cmml"><msup id="S3.E5.m1.47.47.5.43.22.17.17.1.1.1.2" xref="S3.E5.m1.46.46.4.cmml"><mi id="S3.E5.m1.8.8.8.8.3.3" xref="S3.E5.m1.8.8.8.8.3.3.cmml">R</mi><mi id="S3.E5.m1.9.9.9.9.4.4.1" xref="S3.E5.m1.9.9.9.9.4.4.1.cmml">k</mi></msup><mo id="S3.E5.m1.47.47.5.43.22.17.17.1.1.1.1" xref="S3.E5.m1.46.46.4a.cmml">⁢</mo><msubsup id="S3.E5.m1.47.47.5.43.22.17.17.1.1.1.3" xref="S3.E5.m1.46.46.4.cmml"><mi id="S3.E5.m1.10.10.10.10.5.5" xref="S3.E5.m1.10.10.10.10.5.5.cmml">W</mi><mi id="S3.E5.m1.11.11.11.11.6.6.1" xref="S3.E5.m1.11.11.11.11.6.6.1.cmml">Q</mi><mi id="S3.E5.m1.12.12.12.12.7.7.1" xref="S3.E5.m1.12.12.12.12.7.7.1.cmml">i</mi></msubsup></mrow><mo id="S3.E5.m1.13.13.13.13.8.8" stretchy="false" xref="S3.E5.m1.46.46.4a.cmml">)</mo></mrow><mo id="S3.E5.m1.48.48.6.44.23.18.18.3" xref="S3.E5.m1.46.46.4a.cmml">⁢</mo><msup id="S3.E5.m1.48.48.6.44.23.18.18.2" xref="S3.E5.m1.46.46.4.cmml"><mrow id="S3.E5.m1.48.48.6.44.23.18.18.2.1.1" xref="S3.E5.m1.46.46.4.cmml"><mo id="S3.E5.m1.14.14.14.14.9.9" stretchy="false" xref="S3.E5.m1.46.46.4a.cmml">(</mo><mrow id="S3.E5.m1.48.48.6.44.23.18.18.2.1.1.1" xref="S3.E5.m1.46.46.4.cmml"><msup id="S3.E5.m1.48.48.6.44.23.18.18.2.1.1.1.2" xref="S3.E5.m1.46.46.4.cmml"><mi id="S3.E5.m1.15.15.15.15.10.10" xref="S3.E5.m1.15.15.15.15.10.10.cmml">R</mi><mi id="S3.E5.m1.16.16.16.16.11.11.1" xref="S3.E5.m1.16.16.16.16.11.11.1.cmml">k</mi></msup><mo id="S3.E5.m1.48.48.6.44.23.18.18.2.1.1.1.1" xref="S3.E5.m1.46.46.4a.cmml">⁢</mo><msubsup id="S3.E5.m1.48.48.6.44.23.18.18.2.1.1.1.3" xref="S3.E5.m1.46.46.4.cmml"><mi id="S3.E5.m1.17.17.17.17.12.12" xref="S3.E5.m1.17.17.17.17.12.12.cmml">W</mi><mi id="S3.E5.m1.18.18.18.18.13.13.1" xref="S3.E5.m1.18.18.18.18.13.13.1.cmml">K</mi><mi id="S3.E5.m1.19.19.19.19.14.14.1" xref="S3.E5.m1.19.19.19.19.14.14.1.cmml">i</mi></msubsup></mrow><mo id="S3.E5.m1.20.20.20.20.15.15" stretchy="false" xref="S3.E5.m1.46.46.4a.cmml">)</mo></mrow><mi id="S3.E5.m1.21.21.21.21.16.16.1" xref="S3.E5.m1.21.21.21.21.16.16.1.cmml">𝖳</mi></msup></mrow></mrow></mtd></mtr><mtr id="S3.E5.m1.50.50.8d" xref="S3.E5.m1.46.46.4.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.50.50.8e" xref="S3.E5.m1.46.46.4.cmml"><mrow id="S3.E5.m1.26.26.26.5.5" xref="S3.E5.m1.46.46.4.cmml"><mi id="S3.E5.m1.22.22.22.1.1.1" xref="S3.E5.m1.22.22.22.1.1.1.cmml">a</mi><mo id="S3.E5.m1.26.26.26.5.5.6" xref="S3.E5.m1.46.46.4a.cmml">⁢</mo><mi id="S3.E5.m1.23.23.23.2.2.2" xref="S3.E5.m1.23.23.23.2.2.2.cmml">t</mi><mo id="S3.E5.m1.26.26.26.5.5.6a" xref="S3.E5.m1.46.46.4a.cmml">⁢</mo><msubsup id="S3.E5.m1.26.26.26.5.5.7" xref="S3.E5.m1.46.46.4.cmml"><mi id="S3.E5.m1.24.24.24.3.3.3" xref="S3.E5.m1.24.24.24.3.3.3.cmml">t</mi><mi id="S3.E5.m1.25.25.25.4.4.4.1" xref="S3.E5.m1.25.25.25.4.4.4.1.cmml">m</mi><mi id="S3.E5.m1.26.26.26.5.5.5.1" xref="S3.E5.m1.26.26.26.5.5.5.1.cmml">i</mi></msubsup></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.50.50.8f" xref="S3.E5.m1.46.46.4.cmml"><mrow id="S3.E5.m1.50.50.8.46.23.18" xref="S3.E5.m1.46.46.4.cmml"><mi id="S3.E5.m1.50.50.8.46.23.18.19" xref="S3.E5.m1.46.46.4a.cmml"></mi><mo id="S3.E5.m1.27.27.27.6.1.1" xref="S3.E5.m1.27.27.27.6.1.1.cmml">=</mo><mrow id="S3.E5.m1.50.50.8.46.23.18.18" xref="S3.E5.m1.46.46.4.cmml"><mrow id="S3.E5.m1.49.49.7.45.22.17.17.1.1" xref="S3.E5.m1.46.46.4.cmml"><mo id="S3.E5.m1.28.28.28.7.2.2" stretchy="false" xref="S3.E5.m1.46.46.4a.cmml">(</mo><mrow id="S3.E5.m1.49.49.7.45.22.17.17.1.1.1" xref="S3.E5.m1.46.46.4.cmml"><msub id="S3.E5.m1.49.49.7.45.22.17.17.1.1.1.2" xref="S3.E5.m1.46.46.4.cmml"><mi id="S3.E5.m1.29.29.29.8.3.3" xref="S3.E5.m1.29.29.29.8.3.3.cmml">E</mi><mi id="S3.E5.m1.30.30.30.9.4.4.1" xref="S3.E5.m1.30.30.30.9.4.4.1.cmml">m</mi></msub><mo id="S3.E5.m1.49.49.7.45.22.17.17.1.1.1.1" xref="S3.E5.m1.46.46.4a.cmml">⁢</mo><msubsup id="S3.E5.m1.49.49.7.45.22.17.17.1.1.1.3" xref="S3.E5.m1.46.46.4.cmml"><mi id="S3.E5.m1.31.31.31.10.5.5" xref="S3.E5.m1.31.31.31.10.5.5.cmml">W</mi><mi id="S3.E5.m1.32.32.32.11.6.6.1" xref="S3.E5.m1.32.32.32.11.6.6.1.cmml">Q</mi><mi id="S3.E5.m1.33.33.33.12.7.7.1" xref="S3.E5.m1.33.33.33.12.7.7.1.cmml">m</mi></msubsup></mrow><mo id="S3.E5.m1.34.34.34.13.8.8" stretchy="false" xref="S3.E5.m1.46.46.4a.cmml">)</mo></mrow><mo id="S3.E5.m1.50.50.8.46.23.18.18.3" xref="S3.E5.m1.46.46.4a.cmml">⁢</mo><msup id="S3.E5.m1.50.50.8.46.23.18.18.2" xref="S3.E5.m1.46.46.4.cmml"><mrow id="S3.E5.m1.50.50.8.46.23.18.18.2.1.1" xref="S3.E5.m1.46.46.4.cmml"><mo id="S3.E5.m1.35.35.35.14.9.9" stretchy="false" xref="S3.E5.m1.46.46.4a.cmml">(</mo><mrow id="S3.E5.m1.50.50.8.46.23.18.18.2.1.1.1" xref="S3.E5.m1.46.46.4.cmml"><msub id="S3.E5.m1.50.50.8.46.23.18.18.2.1.1.1.2" xref="S3.E5.m1.46.46.4.cmml"><mi id="S3.E5.m1.36.36.36.15.10.10" xref="S3.E5.m1.36.36.36.15.10.10.cmml">E</mi><mi id="S3.E5.m1.37.37.37.16.11.11.1" xref="S3.E5.m1.37.37.37.16.11.11.1.cmml">m</mi></msub><mo id="S3.E5.m1.50.50.8.46.23.18.18.2.1.1.1.1" xref="S3.E5.m1.46.46.4a.cmml">⁢</mo><msubsup id="S3.E5.m1.50.50.8.46.23.18.18.2.1.1.1.3" xref="S3.E5.m1.46.46.4.cmml"><mi id="S3.E5.m1.38.38.38.17.12.12" xref="S3.E5.m1.38.38.38.17.12.12.cmml">W</mi><mi id="S3.E5.m1.39.39.39.18.13.13.1" xref="S3.E5.m1.39.39.39.18.13.13.1.cmml">K</mi><mi id="S3.E5.m1.40.40.40.19.14.14.1" xref="S3.E5.m1.40.40.40.19.14.14.1.cmml">m</mi></msubsup></mrow><mo id="S3.E5.m1.41.41.41.20.15.15" stretchy="false" xref="S3.E5.m1.46.46.4a.cmml">)</mo></mrow><mi id="S3.E5.m1.42.42.42.21.16.16.1" xref="S3.E5.m1.42.42.42.21.16.16.1.cmml">𝖳</mi></msup></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E5.m1.50b"><apply id="S3.E5.m1.46.46.4.cmml" xref="S3.E5.m1.50.50.8"><and id="S3.E5.m1.46.46.4a.cmml" xref="S3.E5.m1.5.5.5.5.5.6"></and><apply id="S3.E5.m1.46.46.4b.cmml" xref="S3.E5.m1.50.50.8"><eq id="S3.E5.m1.6.6.6.6.1.1.cmml" xref="S3.E5.m1.6.6.6.6.1.1"></eq><apply id="S3.E5.m1.46.46.4.6.cmml" xref="S3.E5.m1.50.50.8"><times id="S3.E5.m1.46.46.4.6.1.cmml" xref="S3.E5.m1.5.5.5.5.5.6"></times><ci id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1">𝑎</ci><ci id="S3.E5.m1.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2">𝑡</ci><apply id="S3.E5.m1.46.46.4.6.4.cmml" xref="S3.E5.m1.50.50.8"><csymbol cd="ambiguous" id="S3.E5.m1.46.46.4.6.4.1.cmml" xref="S3.E5.m1.5.5.5.5.5.6">superscript</csymbol><apply id="S3.E5.m1.46.46.4.6.4.2.cmml" xref="S3.E5.m1.50.50.8"><csymbol cd="ambiguous" id="S3.E5.m1.46.46.4.6.4.2.1.cmml" xref="S3.E5.m1.5.5.5.5.5.6">subscript</csymbol><ci id="S3.E5.m1.3.3.3.3.3.3.cmml" xref="S3.E5.m1.3.3.3.3.3.3">𝑡</ci><apply id="S3.E5.m1.4.4.4.4.4.4.1.cmml" xref="S3.E5.m1.4.4.4.4.4.4.1"><times id="S3.E5.m1.4.4.4.4.4.4.1.1.cmml" xref="S3.E5.m1.4.4.4.4.4.4.1.1"></times><ci id="S3.E5.m1.4.4.4.4.4.4.1.2.cmml" xref="S3.E5.m1.4.4.4.4.4.4.1.2">𝐼</ci><ci id="S3.E5.m1.4.4.4.4.4.4.1.3.cmml" xref="S3.E5.m1.4.4.4.4.4.4.1.3">𝐷</ci></apply></apply><ci id="S3.E5.m1.5.5.5.5.5.5.1.cmml" xref="S3.E5.m1.5.5.5.5.5.5.1">𝑖</ci></apply></apply><apply id="S3.E5.m1.44.44.2.2.cmml" xref="S3.E5.m1.50.50.8"><times id="S3.E5.m1.44.44.2.2.3.cmml" xref="S3.E5.m1.5.5.5.5.5.6"></times><apply id="S3.E5.m1.43.43.1.1.1.1.1.cmml" xref="S3.E5.m1.50.50.8"><times id="S3.E5.m1.43.43.1.1.1.1.1.1.cmml" xref="S3.E5.m1.50.50.8"></times><apply id="S3.E5.m1.43.43.1.1.1.1.1.2.cmml" xref="S3.E5.m1.50.50.8"><csymbol cd="ambiguous" id="S3.E5.m1.43.43.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.50.50.8">superscript</csymbol><ci id="S3.E5.m1.8.8.8.8.3.3.cmml" xref="S3.E5.m1.8.8.8.8.3.3">𝑅</ci><ci id="S3.E5.m1.9.9.9.9.4.4.1.cmml" xref="S3.E5.m1.9.9.9.9.4.4.1">𝑘</ci></apply><apply id="S3.E5.m1.43.43.1.1.1.1.1.3.cmml" xref="S3.E5.m1.50.50.8"><csymbol cd="ambiguous" id="S3.E5.m1.43.43.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.50.50.8">superscript</csymbol><apply id="S3.E5.m1.43.43.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.50.50.8"><csymbol cd="ambiguous" id="S3.E5.m1.43.43.1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.50.50.8">subscript</csymbol><ci id="S3.E5.m1.10.10.10.10.5.5.cmml" xref="S3.E5.m1.10.10.10.10.5.5">𝑊</ci><ci id="S3.E5.m1.11.11.11.11.6.6.1.cmml" xref="S3.E5.m1.11.11.11.11.6.6.1">𝑄</ci></apply><ci id="S3.E5.m1.12.12.12.12.7.7.1.cmml" xref="S3.E5.m1.12.12.12.12.7.7.1">𝑖</ci></apply></apply><apply id="S3.E5.m1.44.44.2.2.2.cmml" xref="S3.E5.m1.50.50.8"><csymbol cd="ambiguous" id="S3.E5.m1.44.44.2.2.2.2.cmml" xref="S3.E5.m1.5.5.5.5.5.6">superscript</csymbol><apply id="S3.E5.m1.44.44.2.2.2.1.1.1.cmml" xref="S3.E5.m1.50.50.8"><times id="S3.E5.m1.44.44.2.2.2.1.1.1.1.cmml" xref="S3.E5.m1.50.50.8"></times><apply id="S3.E5.m1.44.44.2.2.2.1.1.1.2.cmml" xref="S3.E5.m1.50.50.8"><csymbol cd="ambiguous" id="S3.E5.m1.44.44.2.2.2.1.1.1.2.1.cmml" xref="S3.E5.m1.50.50.8">superscript</csymbol><ci id="S3.E5.m1.15.15.15.15.10.10.cmml" xref="S3.E5.m1.15.15.15.15.10.10">𝑅</ci><ci id="S3.E5.m1.16.16.16.16.11.11.1.cmml" xref="S3.E5.m1.16.16.16.16.11.11.1">𝑘</ci></apply><apply id="S3.E5.m1.44.44.2.2.2.1.1.1.3.cmml" xref="S3.E5.m1.50.50.8"><csymbol cd="ambiguous" id="S3.E5.m1.44.44.2.2.2.1.1.1.3.1.cmml" xref="S3.E5.m1.50.50.8">superscript</csymbol><apply id="S3.E5.m1.44.44.2.2.2.1.1.1.3.2.cmml" xref="S3.E5.m1.50.50.8"><csymbol cd="ambiguous" id="S3.E5.m1.44.44.2.2.2.1.1.1.3.2.1.cmml" xref="S3.E5.m1.50.50.8">subscript</csymbol><ci id="S3.E5.m1.17.17.17.17.12.12.cmml" xref="S3.E5.m1.17.17.17.17.12.12">𝑊</ci><ci id="S3.E5.m1.18.18.18.18.13.13.1.cmml" xref="S3.E5.m1.18.18.18.18.13.13.1">𝐾</ci></apply><ci id="S3.E5.m1.19.19.19.19.14.14.1.cmml" xref="S3.E5.m1.19.19.19.19.14.14.1">𝑖</ci></apply></apply><ci id="S3.E5.m1.21.21.21.21.16.16.1.cmml" xref="S3.E5.m1.21.21.21.21.16.16.1">𝖳</ci></apply><ci id="S3.E5.m1.22.22.22.1.1.1.cmml" xref="S3.E5.m1.22.22.22.1.1.1">𝑎</ci><ci id="S3.E5.m1.23.23.23.2.2.2.cmml" xref="S3.E5.m1.23.23.23.2.2.2">𝑡</ci><apply id="S3.E5.m1.44.44.2.2.6.cmml" xref="S3.E5.m1.50.50.8"><csymbol cd="ambiguous" id="S3.E5.m1.44.44.2.2.6.1.cmml" xref="S3.E5.m1.5.5.5.5.5.6">superscript</csymbol><apply id="S3.E5.m1.44.44.2.2.6.2.cmml" xref="S3.E5.m1.50.50.8"><csymbol cd="ambiguous" id="S3.E5.m1.44.44.2.2.6.2.1.cmml" xref="S3.E5.m1.5.5.5.5.5.6">subscript</csymbol><ci id="S3.E5.m1.24.24.24.3.3.3.cmml" xref="S3.E5.m1.24.24.24.3.3.3">𝑡</ci><ci id="S3.E5.m1.25.25.25.4.4.4.1.cmml" xref="S3.E5.m1.25.25.25.4.4.4.1">𝑚</ci></apply><ci id="S3.E5.m1.26.26.26.5.5.5.1.cmml" xref="S3.E5.m1.26.26.26.5.5.5.1">𝑖</ci></apply></apply></apply><apply id="S3.E5.m1.46.46.4c.cmml" xref="S3.E5.m1.50.50.8"><eq id="S3.E5.m1.27.27.27.6.1.1.cmml" xref="S3.E5.m1.27.27.27.6.1.1"></eq><share href="https://arxiv.org/html/2405.17959v1#S3.E5.m1.44.44.2.2.cmml" id="S3.E5.m1.46.46.4d.cmml" xref="S3.E5.m1.5.5.5.5.5.6"></share><apply id="S3.E5.m1.46.46.4.4.cmml" xref="S3.E5.m1.50.50.8"><times id="S3.E5.m1.46.46.4.4.3.cmml" xref="S3.E5.m1.5.5.5.5.5.6"></times><apply id="S3.E5.m1.45.45.3.3.1.1.1.cmml" xref="S3.E5.m1.50.50.8"><times id="S3.E5.m1.45.45.3.3.1.1.1.1.cmml" xref="S3.E5.m1.50.50.8"></times><apply id="S3.E5.m1.45.45.3.3.1.1.1.2.cmml" xref="S3.E5.m1.50.50.8"><csymbol cd="ambiguous" id="S3.E5.m1.45.45.3.3.1.1.1.2.1.cmml" xref="S3.E5.m1.50.50.8">subscript</csymbol><ci id="S3.E5.m1.29.29.29.8.3.3.cmml" xref="S3.E5.m1.29.29.29.8.3.3">𝐸</ci><ci id="S3.E5.m1.30.30.30.9.4.4.1.cmml" xref="S3.E5.m1.30.30.30.9.4.4.1">𝑚</ci></apply><apply id="S3.E5.m1.45.45.3.3.1.1.1.3.cmml" xref="S3.E5.m1.50.50.8"><csymbol cd="ambiguous" id="S3.E5.m1.45.45.3.3.1.1.1.3.1.cmml" xref="S3.E5.m1.50.50.8">superscript</csymbol><apply id="S3.E5.m1.45.45.3.3.1.1.1.3.2.cmml" xref="S3.E5.m1.50.50.8"><csymbol cd="ambiguous" id="S3.E5.m1.45.45.3.3.1.1.1.3.2.1.cmml" xref="S3.E5.m1.50.50.8">subscript</csymbol><ci id="S3.E5.m1.31.31.31.10.5.5.cmml" xref="S3.E5.m1.31.31.31.10.5.5">𝑊</ci><ci id="S3.E5.m1.32.32.32.11.6.6.1.cmml" xref="S3.E5.m1.32.32.32.11.6.6.1">𝑄</ci></apply><ci id="S3.E5.m1.33.33.33.12.7.7.1.cmml" xref="S3.E5.m1.33.33.33.12.7.7.1">𝑚</ci></apply></apply><apply id="S3.E5.m1.46.46.4.4.2.cmml" xref="S3.E5.m1.50.50.8"><csymbol cd="ambiguous" id="S3.E5.m1.46.46.4.4.2.2.cmml" xref="S3.E5.m1.5.5.5.5.5.6">superscript</csymbol><apply id="S3.E5.m1.46.46.4.4.2.1.1.1.cmml" xref="S3.E5.m1.50.50.8"><times id="S3.E5.m1.46.46.4.4.2.1.1.1.1.cmml" xref="S3.E5.m1.50.50.8"></times><apply id="S3.E5.m1.46.46.4.4.2.1.1.1.2.cmml" xref="S3.E5.m1.50.50.8"><csymbol cd="ambiguous" id="S3.E5.m1.46.46.4.4.2.1.1.1.2.1.cmml" xref="S3.E5.m1.50.50.8">subscript</csymbol><ci id="S3.E5.m1.36.36.36.15.10.10.cmml" xref="S3.E5.m1.36.36.36.15.10.10">𝐸</ci><ci id="S3.E5.m1.37.37.37.16.11.11.1.cmml" xref="S3.E5.m1.37.37.37.16.11.11.1">𝑚</ci></apply><apply id="S3.E5.m1.46.46.4.4.2.1.1.1.3.cmml" xref="S3.E5.m1.50.50.8"><csymbol cd="ambiguous" id="S3.E5.m1.46.46.4.4.2.1.1.1.3.1.cmml" xref="S3.E5.m1.50.50.8">superscript</csymbol><apply id="S3.E5.m1.46.46.4.4.2.1.1.1.3.2.cmml" xref="S3.E5.m1.50.50.8"><csymbol cd="ambiguous" id="S3.E5.m1.46.46.4.4.2.1.1.1.3.2.1.cmml" xref="S3.E5.m1.50.50.8">subscript</csymbol><ci id="S3.E5.m1.38.38.38.17.12.12.cmml" xref="S3.E5.m1.38.38.38.17.12.12">𝑊</ci><ci id="S3.E5.m1.39.39.39.18.13.13.1.cmml" xref="S3.E5.m1.39.39.39.18.13.13.1">𝐾</ci></apply><ci id="S3.E5.m1.40.40.40.19.14.14.1.cmml" xref="S3.E5.m1.40.40.40.19.14.14.1">𝑚</ci></apply></apply><ci id="S3.E5.m1.42.42.42.21.16.16.1.cmml" xref="S3.E5.m1.42.42.42.21.16.16.1">𝖳</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.50c">\begin{split}att_{ID}^{i}&amp;=(R^{k}W_{Q}^{i})(R^{k}W_{K}^{i})^{\mathsf{T}}\\
att_{m}^{i}&amp;=(E_{m}W_{Q}^{m})(E_{m}W_{K}^{m})^{\mathsf{T}}\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.50d">start_ROW start_CELL italic_a italic_t italic_t start_POSTSUBSCRIPT italic_I italic_D end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT end_CELL start_CELL = ( italic_R start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) ( italic_R start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT end_CELL end_ROW start_ROW start_CELL italic_a italic_t italic_t start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT end_CELL start_CELL = ( italic_E start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ) ( italic_E start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p7">
<p class="ltx_p" id="S3.SS3.p7.5">The <span class="ltx_text ltx_font_italic" id="S3.SS3.p7.5.1">Sum</span>, <span class="ltx_text ltx_font_italic" id="S3.SS3.p7.5.2">Concat</span>, and <span class="ltx_text ltx_font_italic" id="S3.SS3.p7.5.3">Gate</span> functions proposed in previous studies were used to combine the sequences and multimodal attention fusion function <math alttext="F(\cdot)" class="ltx_Math" display="inline" id="S3.SS3.p7.1.m1.1"><semantics id="S3.SS3.p7.1.m1.1a"><mrow id="S3.SS3.p7.1.m1.1.2" xref="S3.SS3.p7.1.m1.1.2.cmml"><mi id="S3.SS3.p7.1.m1.1.2.2" xref="S3.SS3.p7.1.m1.1.2.2.cmml">F</mi><mo id="S3.SS3.p7.1.m1.1.2.1" xref="S3.SS3.p7.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p7.1.m1.1.2.3.2" xref="S3.SS3.p7.1.m1.1.2.cmml"><mo id="S3.SS3.p7.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS3.p7.1.m1.1.2.cmml">(</mo><mo id="S3.SS3.p7.1.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS3.p7.1.m1.1.1.cmml">⋅</mo><mo id="S3.SS3.p7.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS3.p7.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.1.m1.1b"><apply id="S3.SS3.p7.1.m1.1.2.cmml" xref="S3.SS3.p7.1.m1.1.2"><times id="S3.SS3.p7.1.m1.1.2.1.cmml" xref="S3.SS3.p7.1.m1.1.2.1"></times><ci id="S3.SS3.p7.1.m1.1.2.2.cmml" xref="S3.SS3.p7.1.m1.1.2.2">𝐹</ci><ci id="S3.SS3.p7.1.m1.1.1.cmml" xref="S3.SS3.p7.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.1.m1.1c">F(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.1.m1.1d">italic_F ( ⋅ )</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib11" title="">2021</a>)</cite>.
<math alttext="MAF_{att}^{i}" class="ltx_Math" display="inline" id="S3.SS3.p7.2.m2.1"><semantics id="S3.SS3.p7.2.m2.1a"><mrow id="S3.SS3.p7.2.m2.1.1" xref="S3.SS3.p7.2.m2.1.1.cmml"><mi id="S3.SS3.p7.2.m2.1.1.2" xref="S3.SS3.p7.2.m2.1.1.2.cmml">M</mi><mo id="S3.SS3.p7.2.m2.1.1.1" xref="S3.SS3.p7.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p7.2.m2.1.1.3" xref="S3.SS3.p7.2.m2.1.1.3.cmml">A</mi><mo id="S3.SS3.p7.2.m2.1.1.1a" xref="S3.SS3.p7.2.m2.1.1.1.cmml">⁢</mo><msubsup id="S3.SS3.p7.2.m2.1.1.4" xref="S3.SS3.p7.2.m2.1.1.4.cmml"><mi id="S3.SS3.p7.2.m2.1.1.4.2.2" xref="S3.SS3.p7.2.m2.1.1.4.2.2.cmml">F</mi><mrow id="S3.SS3.p7.2.m2.1.1.4.2.3" xref="S3.SS3.p7.2.m2.1.1.4.2.3.cmml"><mi id="S3.SS3.p7.2.m2.1.1.4.2.3.2" xref="S3.SS3.p7.2.m2.1.1.4.2.3.2.cmml">a</mi><mo id="S3.SS3.p7.2.m2.1.1.4.2.3.1" xref="S3.SS3.p7.2.m2.1.1.4.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p7.2.m2.1.1.4.2.3.3" xref="S3.SS3.p7.2.m2.1.1.4.2.3.3.cmml">t</mi><mo id="S3.SS3.p7.2.m2.1.1.4.2.3.1a" xref="S3.SS3.p7.2.m2.1.1.4.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p7.2.m2.1.1.4.2.3.4" xref="S3.SS3.p7.2.m2.1.1.4.2.3.4.cmml">t</mi></mrow><mi id="S3.SS3.p7.2.m2.1.1.4.3" xref="S3.SS3.p7.2.m2.1.1.4.3.cmml">i</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.2.m2.1b"><apply id="S3.SS3.p7.2.m2.1.1.cmml" xref="S3.SS3.p7.2.m2.1.1"><times id="S3.SS3.p7.2.m2.1.1.1.cmml" xref="S3.SS3.p7.2.m2.1.1.1"></times><ci id="S3.SS3.p7.2.m2.1.1.2.cmml" xref="S3.SS3.p7.2.m2.1.1.2">𝑀</ci><ci id="S3.SS3.p7.2.m2.1.1.3.cmml" xref="S3.SS3.p7.2.m2.1.1.3">𝐴</ci><apply id="S3.SS3.p7.2.m2.1.1.4.cmml" xref="S3.SS3.p7.2.m2.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p7.2.m2.1.1.4.1.cmml" xref="S3.SS3.p7.2.m2.1.1.4">superscript</csymbol><apply id="S3.SS3.p7.2.m2.1.1.4.2.cmml" xref="S3.SS3.p7.2.m2.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p7.2.m2.1.1.4.2.1.cmml" xref="S3.SS3.p7.2.m2.1.1.4">subscript</csymbol><ci id="S3.SS3.p7.2.m2.1.1.4.2.2.cmml" xref="S3.SS3.p7.2.m2.1.1.4.2.2">𝐹</ci><apply id="S3.SS3.p7.2.m2.1.1.4.2.3.cmml" xref="S3.SS3.p7.2.m2.1.1.4.2.3"><times id="S3.SS3.p7.2.m2.1.1.4.2.3.1.cmml" xref="S3.SS3.p7.2.m2.1.1.4.2.3.1"></times><ci id="S3.SS3.p7.2.m2.1.1.4.2.3.2.cmml" xref="S3.SS3.p7.2.m2.1.1.4.2.3.2">𝑎</ci><ci id="S3.SS3.p7.2.m2.1.1.4.2.3.3.cmml" xref="S3.SS3.p7.2.m2.1.1.4.2.3.3">𝑡</ci><ci id="S3.SS3.p7.2.m2.1.1.4.2.3.4.cmml" xref="S3.SS3.p7.2.m2.1.1.4.2.3.4">𝑡</ci></apply></apply><ci id="S3.SS3.p7.2.m2.1.1.4.3.cmml" xref="S3.SS3.p7.2.m2.1.1.4.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.2.m2.1c">MAF_{att}^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.2.m2.1d">italic_M italic_A italic_F start_POSTSUBSCRIPT italic_a italic_t italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> is obtained with the <math alttext="W_{V}^{i}" class="ltx_Math" display="inline" id="S3.SS3.p7.3.m3.1"><semantics id="S3.SS3.p7.3.m3.1a"><msubsup id="S3.SS3.p7.3.m3.1.1" xref="S3.SS3.p7.3.m3.1.1.cmml"><mi id="S3.SS3.p7.3.m3.1.1.2.2" xref="S3.SS3.p7.3.m3.1.1.2.2.cmml">W</mi><mi id="S3.SS3.p7.3.m3.1.1.2.3" xref="S3.SS3.p7.3.m3.1.1.2.3.cmml">V</mi><mi id="S3.SS3.p7.3.m3.1.1.3" xref="S3.SS3.p7.3.m3.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.3.m3.1b"><apply id="S3.SS3.p7.3.m3.1.1.cmml" xref="S3.SS3.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.3.m3.1.1.1.cmml" xref="S3.SS3.p7.3.m3.1.1">superscript</csymbol><apply id="S3.SS3.p7.3.m3.1.1.2.cmml" xref="S3.SS3.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.3.m3.1.1.2.1.cmml" xref="S3.SS3.p7.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p7.3.m3.1.1.2.2.cmml" xref="S3.SS3.p7.3.m3.1.1.2.2">𝑊</ci><ci id="S3.SS3.p7.3.m3.1.1.2.3.cmml" xref="S3.SS3.p7.3.m3.1.1.2.3">𝑉</ci></apply><ci id="S3.SS3.p7.3.m3.1.1.3.cmml" xref="S3.SS3.p7.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.3.m3.1c">W_{V}^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.3.m3.1d">italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> from the attention fusion function <math alttext="F" class="ltx_Math" display="inline" id="S3.SS3.p7.4.m4.1"><semantics id="S3.SS3.p7.4.m4.1a"><mi id="S3.SS3.p7.4.m4.1.1" xref="S3.SS3.p7.4.m4.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.4.m4.1b"><ci id="S3.SS3.p7.4.m4.1.1.cmml" xref="S3.SS3.p7.4.m4.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.4.m4.1c">F</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.4.m4.1d">italic_F</annotation></semantics></math> for mixing two attention matrices.
<math alttext="\sqrt{d}" class="ltx_Math" display="inline" id="S3.SS3.p7.5.m5.1"><semantics id="S3.SS3.p7.5.m5.1a"><msqrt id="S3.SS3.p7.5.m5.1.1" xref="S3.SS3.p7.5.m5.1.1.cmml"><mi id="S3.SS3.p7.5.m5.1.1.2" xref="S3.SS3.p7.5.m5.1.1.2.cmml">d</mi></msqrt><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.5.m5.1b"><apply id="S3.SS3.p7.5.m5.1.1.cmml" xref="S3.SS3.p7.5.m5.1.1"><root id="S3.SS3.p7.5.m5.1.1a.cmml" xref="S3.SS3.p7.5.m5.1.1"></root><ci id="S3.SS3.p7.5.m5.1.1.2.cmml" xref="S3.SS3.p7.5.m5.1.1.2">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.5.m5.1c">\sqrt{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.5.m5.1d">square-root start_ARG italic_d end_ARG</annotation></semantics></math> is a scale factor that avoids overgrowth values for the inner products.
Finally, the result outputs of all the attention heads are concatenated and fed into the feed-forward layers and layer normalization.
This process is represented as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\begin{split}MAF_{att}^{i}&amp;=F(att_{ID}^{i},att_{m}^{i})\\
MAF_{head}^{i}&amp;=softmax(\frac{MAF_{att}^{i}}{\sqrt{d}})(R^{k}W_{V}^{i})\\
MAF(R^{k},E_{m})&amp;=\mathrm{concat}([MAF_{head}^{1},\cdots,MAF_{head}^{i}])\end{split}" class="ltx_Math" display="block" id="S3.E6.m1.84"><semantics id="S3.E6.m1.84a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E6.m1.84.84.12" rowspacing="0pt" xref="S3.E6.m1.78.78.6.cmml"><mtr id="S3.E6.m1.84.84.12a" xref="S3.E6.m1.78.78.6.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.84.84.12b" xref="S3.E6.m1.78.78.6.cmml"><mrow id="S3.E6.m1.5.5.5.5.5" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml">M</mi><mo id="S3.E6.m1.5.5.5.5.5.6" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><mi id="S3.E6.m1.2.2.2.2.2.2" xref="S3.E6.m1.2.2.2.2.2.2.cmml">A</mi><mo id="S3.E6.m1.5.5.5.5.5.6a" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><msubsup id="S3.E6.m1.5.5.5.5.5.7" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.3.3.3.3.3.3" xref="S3.E6.m1.3.3.3.3.3.3.cmml">F</mi><mrow id="S3.E6.m1.4.4.4.4.4.4.1" xref="S3.E6.m1.4.4.4.4.4.4.1.cmml"><mi id="S3.E6.m1.4.4.4.4.4.4.1.2" xref="S3.E6.m1.4.4.4.4.4.4.1.2.cmml">a</mi><mo id="S3.E6.m1.4.4.4.4.4.4.1.1" xref="S3.E6.m1.4.4.4.4.4.4.1.1.cmml">⁢</mo><mi id="S3.E6.m1.4.4.4.4.4.4.1.3" xref="S3.E6.m1.4.4.4.4.4.4.1.3.cmml">t</mi><mo id="S3.E6.m1.4.4.4.4.4.4.1.1a" xref="S3.E6.m1.4.4.4.4.4.4.1.1.cmml">⁢</mo><mi id="S3.E6.m1.4.4.4.4.4.4.1.4" xref="S3.E6.m1.4.4.4.4.4.4.1.4.cmml">t</mi></mrow><mi id="S3.E6.m1.5.5.5.5.5.5.1" xref="S3.E6.m1.5.5.5.5.5.5.1.cmml">i</mi></msubsup></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.84.84.12c" xref="S3.E6.m1.78.78.6.cmml"><mrow id="S3.E6.m1.80.80.8.74.22.17" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.80.80.8.74.22.17.18" xref="S3.E6.m1.78.78.6a.cmml"></mi><mo id="S3.E6.m1.6.6.6.6.1.1" xref="S3.E6.m1.6.6.6.6.1.1.cmml">=</mo><mrow id="S3.E6.m1.80.80.8.74.22.17.17" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.7.7.7.7.2.2" xref="S3.E6.m1.7.7.7.7.2.2.cmml">F</mi><mo id="S3.E6.m1.80.80.8.74.22.17.17.3" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><mrow id="S3.E6.m1.80.80.8.74.22.17.17.2.2" xref="S3.E6.m1.78.78.6.cmml"><mo id="S3.E6.m1.8.8.8.8.3.3" stretchy="false" xref="S3.E6.m1.78.78.6a.cmml">(</mo><mrow id="S3.E6.m1.79.79.7.73.21.16.16.1.1.1" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.9.9.9.9.4.4" xref="S3.E6.m1.9.9.9.9.4.4.cmml">a</mi><mo id="S3.E6.m1.79.79.7.73.21.16.16.1.1.1.1" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><mi id="S3.E6.m1.10.10.10.10.5.5" xref="S3.E6.m1.10.10.10.10.5.5.cmml">t</mi><mo id="S3.E6.m1.79.79.7.73.21.16.16.1.1.1.1a" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><msubsup id="S3.E6.m1.79.79.7.73.21.16.16.1.1.1.2" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.11.11.11.11.6.6" xref="S3.E6.m1.11.11.11.11.6.6.cmml">t</mi><mrow id="S3.E6.m1.12.12.12.12.7.7.1" xref="S3.E6.m1.12.12.12.12.7.7.1.cmml"><mi id="S3.E6.m1.12.12.12.12.7.7.1.2" xref="S3.E6.m1.12.12.12.12.7.7.1.2.cmml">I</mi><mo id="S3.E6.m1.12.12.12.12.7.7.1.1" xref="S3.E6.m1.12.12.12.12.7.7.1.1.cmml">⁢</mo><mi id="S3.E6.m1.12.12.12.12.7.7.1.3" xref="S3.E6.m1.12.12.12.12.7.7.1.3.cmml">D</mi></mrow><mi id="S3.E6.m1.13.13.13.13.8.8.1" xref="S3.E6.m1.13.13.13.13.8.8.1.cmml">i</mi></msubsup></mrow><mo id="S3.E6.m1.14.14.14.14.9.9" xref="S3.E6.m1.78.78.6a.cmml">,</mo><mrow id="S3.E6.m1.80.80.8.74.22.17.17.2.2.2" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.15.15.15.15.10.10" xref="S3.E6.m1.15.15.15.15.10.10.cmml">a</mi><mo id="S3.E6.m1.80.80.8.74.22.17.17.2.2.2.1" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><mi id="S3.E6.m1.16.16.16.16.11.11" xref="S3.E6.m1.16.16.16.16.11.11.cmml">t</mi><mo id="S3.E6.m1.80.80.8.74.22.17.17.2.2.2.1a" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><msubsup id="S3.E6.m1.80.80.8.74.22.17.17.2.2.2.2" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.17.17.17.17.12.12" xref="S3.E6.m1.17.17.17.17.12.12.cmml">t</mi><mi id="S3.E6.m1.18.18.18.18.13.13.1" xref="S3.E6.m1.18.18.18.18.13.13.1.cmml">m</mi><mi id="S3.E6.m1.19.19.19.19.14.14.1" xref="S3.E6.m1.19.19.19.19.14.14.1.cmml">i</mi></msubsup></mrow><mo id="S3.E6.m1.20.20.20.20.15.15" stretchy="false" xref="S3.E6.m1.78.78.6a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E6.m1.84.84.12d" xref="S3.E6.m1.78.78.6.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.84.84.12e" xref="S3.E6.m1.78.78.6.cmml"><mrow id="S3.E6.m1.25.25.25.5.5" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.21.21.21.1.1.1" xref="S3.E6.m1.21.21.21.1.1.1.cmml">M</mi><mo id="S3.E6.m1.25.25.25.5.5.6" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><mi id="S3.E6.m1.22.22.22.2.2.2" xref="S3.E6.m1.22.22.22.2.2.2.cmml">A</mi><mo id="S3.E6.m1.25.25.25.5.5.6a" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><msubsup id="S3.E6.m1.25.25.25.5.5.7" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.23.23.23.3.3.3" xref="S3.E6.m1.23.23.23.3.3.3.cmml">F</mi><mrow id="S3.E6.m1.24.24.24.4.4.4.1" xref="S3.E6.m1.24.24.24.4.4.4.1.cmml"><mi id="S3.E6.m1.24.24.24.4.4.4.1.2" xref="S3.E6.m1.24.24.24.4.4.4.1.2.cmml">h</mi><mo id="S3.E6.m1.24.24.24.4.4.4.1.1" xref="S3.E6.m1.24.24.24.4.4.4.1.1.cmml">⁢</mo><mi id="S3.E6.m1.24.24.24.4.4.4.1.3" xref="S3.E6.m1.24.24.24.4.4.4.1.3.cmml">e</mi><mo id="S3.E6.m1.24.24.24.4.4.4.1.1a" xref="S3.E6.m1.24.24.24.4.4.4.1.1.cmml">⁢</mo><mi id="S3.E6.m1.24.24.24.4.4.4.1.4" xref="S3.E6.m1.24.24.24.4.4.4.1.4.cmml">a</mi><mo id="S3.E6.m1.24.24.24.4.4.4.1.1b" xref="S3.E6.m1.24.24.24.4.4.4.1.1.cmml">⁢</mo><mi id="S3.E6.m1.24.24.24.4.4.4.1.5" xref="S3.E6.m1.24.24.24.4.4.4.1.5.cmml">d</mi></mrow><mi id="S3.E6.m1.25.25.25.5.5.5.1" xref="S3.E6.m1.25.25.25.5.5.5.1.cmml">i</mi></msubsup></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.84.84.12f" xref="S3.E6.m1.78.78.6.cmml"><mrow id="S3.E6.m1.81.81.9.75.24.19" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.81.81.9.75.24.19.20" xref="S3.E6.m1.78.78.6a.cmml"></mi><mo id="S3.E6.m1.26.26.26.6.1.1" xref="S3.E6.m1.26.26.26.6.1.1.cmml">=</mo><mrow id="S3.E6.m1.81.81.9.75.24.19.19" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.27.27.27.7.2.2" xref="S3.E6.m1.27.27.27.7.2.2.cmml">s</mi><mo id="S3.E6.m1.81.81.9.75.24.19.19.2" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><mi id="S3.E6.m1.28.28.28.8.3.3" xref="S3.E6.m1.28.28.28.8.3.3.cmml">o</mi><mo id="S3.E6.m1.81.81.9.75.24.19.19.2a" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><mi id="S3.E6.m1.29.29.29.9.4.4" xref="S3.E6.m1.29.29.29.9.4.4.cmml">f</mi><mo id="S3.E6.m1.81.81.9.75.24.19.19.2b" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><mi id="S3.E6.m1.30.30.30.10.5.5" xref="S3.E6.m1.30.30.30.10.5.5.cmml">t</mi><mo id="S3.E6.m1.81.81.9.75.24.19.19.2c" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><mi id="S3.E6.m1.31.31.31.11.6.6" xref="S3.E6.m1.31.31.31.11.6.6.cmml">m</mi><mo id="S3.E6.m1.81.81.9.75.24.19.19.2d" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><mi id="S3.E6.m1.32.32.32.12.7.7" xref="S3.E6.m1.32.32.32.12.7.7.cmml">a</mi><mo id="S3.E6.m1.81.81.9.75.24.19.19.2e" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><mi id="S3.E6.m1.33.33.33.13.8.8" xref="S3.E6.m1.33.33.33.13.8.8.cmml">x</mi><mo id="S3.E6.m1.81.81.9.75.24.19.19.2f" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><mrow id="S3.E6.m1.81.81.9.75.24.19.19.3" xref="S3.E6.m1.78.78.6.cmml"><mo id="S3.E6.m1.34.34.34.14.9.9" stretchy="false" xref="S3.E6.m1.78.78.6a.cmml">(</mo><mfrac id="S3.E6.m1.35.35.35.15.10.10" xref="S3.E6.m1.35.35.35.15.10.10.cmml"><mrow id="S3.E6.m1.35.35.35.15.10.10.2" xref="S3.E6.m1.35.35.35.15.10.10.2.cmml"><mi id="S3.E6.m1.35.35.35.15.10.10.2.2" xref="S3.E6.m1.35.35.35.15.10.10.2.2.cmml">M</mi><mo id="S3.E6.m1.35.35.35.15.10.10.2.1" xref="S3.E6.m1.35.35.35.15.10.10.2.1.cmml">⁢</mo><mi id="S3.E6.m1.35.35.35.15.10.10.2.3" xref="S3.E6.m1.35.35.35.15.10.10.2.3.cmml">A</mi><mo id="S3.E6.m1.35.35.35.15.10.10.2.1a" xref="S3.E6.m1.35.35.35.15.10.10.2.1.cmml">⁢</mo><msubsup id="S3.E6.m1.35.35.35.15.10.10.2.4" xref="S3.E6.m1.35.35.35.15.10.10.2.4.cmml"><mi id="S3.E6.m1.35.35.35.15.10.10.2.4.2.2" xref="S3.E6.m1.35.35.35.15.10.10.2.4.2.2.cmml">F</mi><mrow id="S3.E6.m1.35.35.35.15.10.10.2.4.2.3" xref="S3.E6.m1.35.35.35.15.10.10.2.4.2.3.cmml"><mi id="S3.E6.m1.35.35.35.15.10.10.2.4.2.3.2" xref="S3.E6.m1.35.35.35.15.10.10.2.4.2.3.2.cmml">a</mi><mo id="S3.E6.m1.35.35.35.15.10.10.2.4.2.3.1" xref="S3.E6.m1.35.35.35.15.10.10.2.4.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.35.35.35.15.10.10.2.4.2.3.3" xref="S3.E6.m1.35.35.35.15.10.10.2.4.2.3.3.cmml">t</mi><mo id="S3.E6.m1.35.35.35.15.10.10.2.4.2.3.1a" xref="S3.E6.m1.35.35.35.15.10.10.2.4.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.35.35.35.15.10.10.2.4.2.3.4" xref="S3.E6.m1.35.35.35.15.10.10.2.4.2.3.4.cmml">t</mi></mrow><mi id="S3.E6.m1.35.35.35.15.10.10.2.4.3" xref="S3.E6.m1.35.35.35.15.10.10.2.4.3.cmml">i</mi></msubsup></mrow><msqrt id="S3.E6.m1.35.35.35.15.10.10.3" xref="S3.E6.m1.35.35.35.15.10.10.3.cmml"><mi id="S3.E6.m1.35.35.35.15.10.10.3.2" xref="S3.E6.m1.35.35.35.15.10.10.3.2.cmml">d</mi></msqrt></mfrac><mo id="S3.E6.m1.36.36.36.16.11.11" stretchy="false" xref="S3.E6.m1.78.78.6a.cmml">)</mo></mrow><mo id="S3.E6.m1.81.81.9.75.24.19.19.2g" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><mrow id="S3.E6.m1.81.81.9.75.24.19.19.1.1" xref="S3.E6.m1.78.78.6.cmml"><mo id="S3.E6.m1.37.37.37.17.12.12" stretchy="false" xref="S3.E6.m1.78.78.6a.cmml">(</mo><mrow id="S3.E6.m1.81.81.9.75.24.19.19.1.1.1" xref="S3.E6.m1.78.78.6.cmml"><msup id="S3.E6.m1.81.81.9.75.24.19.19.1.1.1.2" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.38.38.38.18.13.13" xref="S3.E6.m1.38.38.38.18.13.13.cmml">R</mi><mi id="S3.E6.m1.39.39.39.19.14.14.1" xref="S3.E6.m1.39.39.39.19.14.14.1.cmml">k</mi></msup><mo id="S3.E6.m1.81.81.9.75.24.19.19.1.1.1.1" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><msubsup id="S3.E6.m1.81.81.9.75.24.19.19.1.1.1.3" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.40.40.40.20.15.15" xref="S3.E6.m1.40.40.40.20.15.15.cmml">W</mi><mi id="S3.E6.m1.41.41.41.21.16.16.1" xref="S3.E6.m1.41.41.41.21.16.16.1.cmml">V</mi><mi id="S3.E6.m1.42.42.42.22.17.17.1" xref="S3.E6.m1.42.42.42.22.17.17.1.cmml">i</mi></msubsup></mrow><mo id="S3.E6.m1.43.43.43.23.18.18" stretchy="false" xref="S3.E6.m1.78.78.6a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E6.m1.84.84.12g" xref="S3.E6.m1.78.78.6.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.84.84.12h" xref="S3.E6.m1.78.78.6.cmml"><mrow id="S3.E6.m1.83.83.11.77.31.12" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.44.44.44.1.1.1" xref="S3.E6.m1.44.44.44.1.1.1.cmml">M</mi><mo id="S3.E6.m1.83.83.11.77.31.12.13" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><mi id="S3.E6.m1.45.45.45.2.2.2" xref="S3.E6.m1.45.45.45.2.2.2.cmml">A</mi><mo id="S3.E6.m1.83.83.11.77.31.12.13a" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><mi id="S3.E6.m1.46.46.46.3.3.3" xref="S3.E6.m1.46.46.46.3.3.3.cmml">F</mi><mo id="S3.E6.m1.83.83.11.77.31.12.13b" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><mrow id="S3.E6.m1.83.83.11.77.31.12.12.2" xref="S3.E6.m1.78.78.6.cmml"><mo id="S3.E6.m1.47.47.47.4.4.4" stretchy="false" xref="S3.E6.m1.78.78.6a.cmml">(</mo><msup id="S3.E6.m1.82.82.10.76.30.11.11.1.1" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.48.48.48.5.5.5" xref="S3.E6.m1.48.48.48.5.5.5.cmml">R</mi><mi id="S3.E6.m1.49.49.49.6.6.6.1" xref="S3.E6.m1.49.49.49.6.6.6.1.cmml">k</mi></msup><mo id="S3.E6.m1.50.50.50.7.7.7" xref="S3.E6.m1.78.78.6a.cmml">,</mo><msub id="S3.E6.m1.83.83.11.77.31.12.12.2.2" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.51.51.51.8.8.8" xref="S3.E6.m1.51.51.51.8.8.8.cmml">E</mi><mi id="S3.E6.m1.52.52.52.9.9.9.1" xref="S3.E6.m1.52.52.52.9.9.9.1.cmml">m</mi></msub><mo id="S3.E6.m1.53.53.53.10.10.10" stretchy="false" xref="S3.E6.m1.78.78.6a.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.84.84.12i" xref="S3.E6.m1.78.78.6.cmml"><mrow id="S3.E6.m1.84.84.12.78.32.20" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.84.84.12.78.32.20.21" xref="S3.E6.m1.78.78.6a.cmml"></mi><mo id="S3.E6.m1.54.54.54.11.1.1" xref="S3.E6.m1.54.54.54.11.1.1.cmml">=</mo><mrow id="S3.E6.m1.84.84.12.78.32.20.20" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.55.55.55.12.2.2" xref="S3.E6.m1.55.55.55.12.2.2.cmml">concat</mi><mo id="S3.E6.m1.84.84.12.78.32.20.20.2" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><mrow id="S3.E6.m1.84.84.12.78.32.20.20.1.1" xref="S3.E6.m1.78.78.6.cmml"><mo id="S3.E6.m1.56.56.56.13.3.3" stretchy="false" xref="S3.E6.m1.78.78.6a.cmml">(</mo><mrow id="S3.E6.m1.84.84.12.78.32.20.20.1.1.1" xref="S3.E6.m1.78.78.6.cmml"><mo id="S3.E6.m1.57.57.57.14.4.4" stretchy="false" xref="S3.E6.m1.78.78.6a.cmml">[</mo><mrow id="S3.E6.m1.84.84.12.78.32.20.20.1.1.1.1.1" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.58.58.58.15.5.5" xref="S3.E6.m1.58.58.58.15.5.5.cmml">M</mi><mo id="S3.E6.m1.84.84.12.78.32.20.20.1.1.1.1.1.1" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><mi id="S3.E6.m1.59.59.59.16.6.6" xref="S3.E6.m1.59.59.59.16.6.6.cmml">A</mi><mo id="S3.E6.m1.84.84.12.78.32.20.20.1.1.1.1.1.1a" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><msubsup id="S3.E6.m1.84.84.12.78.32.20.20.1.1.1.1.1.2" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.60.60.60.17.7.7" xref="S3.E6.m1.60.60.60.17.7.7.cmml">F</mi><mrow id="S3.E6.m1.61.61.61.18.8.8.1" xref="S3.E6.m1.61.61.61.18.8.8.1.cmml"><mi id="S3.E6.m1.61.61.61.18.8.8.1.2" xref="S3.E6.m1.61.61.61.18.8.8.1.2.cmml">h</mi><mo id="S3.E6.m1.61.61.61.18.8.8.1.1" xref="S3.E6.m1.61.61.61.18.8.8.1.1.cmml">⁢</mo><mi id="S3.E6.m1.61.61.61.18.8.8.1.3" xref="S3.E6.m1.61.61.61.18.8.8.1.3.cmml">e</mi><mo id="S3.E6.m1.61.61.61.18.8.8.1.1a" xref="S3.E6.m1.61.61.61.18.8.8.1.1.cmml">⁢</mo><mi id="S3.E6.m1.61.61.61.18.8.8.1.4" xref="S3.E6.m1.61.61.61.18.8.8.1.4.cmml">a</mi><mo id="S3.E6.m1.61.61.61.18.8.8.1.1b" xref="S3.E6.m1.61.61.61.18.8.8.1.1.cmml">⁢</mo><mi id="S3.E6.m1.61.61.61.18.8.8.1.5" xref="S3.E6.m1.61.61.61.18.8.8.1.5.cmml">d</mi></mrow><mn id="S3.E6.m1.62.62.62.19.9.9.1" xref="S3.E6.m1.62.62.62.19.9.9.1.cmml">1</mn></msubsup></mrow><mo id="S3.E6.m1.63.63.63.20.10.10" xref="S3.E6.m1.78.78.6a.cmml">,</mo><mi id="S3.E6.m1.64.64.64.21.11.11" mathvariant="normal" xref="S3.E6.m1.64.64.64.21.11.11.cmml">⋯</mi><mo id="S3.E6.m1.65.65.65.22.12.12" xref="S3.E6.m1.78.78.6a.cmml">,</mo><mrow id="S3.E6.m1.84.84.12.78.32.20.20.1.1.1.2.2" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.66.66.66.23.13.13" xref="S3.E6.m1.66.66.66.23.13.13.cmml">M</mi><mo id="S3.E6.m1.84.84.12.78.32.20.20.1.1.1.2.2.1" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><mi id="S3.E6.m1.67.67.67.24.14.14" xref="S3.E6.m1.67.67.67.24.14.14.cmml">A</mi><mo id="S3.E6.m1.84.84.12.78.32.20.20.1.1.1.2.2.1a" xref="S3.E6.m1.78.78.6a.cmml">⁢</mo><msubsup id="S3.E6.m1.84.84.12.78.32.20.20.1.1.1.2.2.2" xref="S3.E6.m1.78.78.6.cmml"><mi id="S3.E6.m1.68.68.68.25.15.15" xref="S3.E6.m1.68.68.68.25.15.15.cmml">F</mi><mrow id="S3.E6.m1.69.69.69.26.16.16.1" xref="S3.E6.m1.69.69.69.26.16.16.1.cmml"><mi id="S3.E6.m1.69.69.69.26.16.16.1.2" xref="S3.E6.m1.69.69.69.26.16.16.1.2.cmml">h</mi><mo id="S3.E6.m1.69.69.69.26.16.16.1.1" xref="S3.E6.m1.69.69.69.26.16.16.1.1.cmml">⁢</mo><mi id="S3.E6.m1.69.69.69.26.16.16.1.3" xref="S3.E6.m1.69.69.69.26.16.16.1.3.cmml">e</mi><mo id="S3.E6.m1.69.69.69.26.16.16.1.1a" xref="S3.E6.m1.69.69.69.26.16.16.1.1.cmml">⁢</mo><mi id="S3.E6.m1.69.69.69.26.16.16.1.4" xref="S3.E6.m1.69.69.69.26.16.16.1.4.cmml">a</mi><mo id="S3.E6.m1.69.69.69.26.16.16.1.1b" xref="S3.E6.m1.69.69.69.26.16.16.1.1.cmml">⁢</mo><mi id="S3.E6.m1.69.69.69.26.16.16.1.5" xref="S3.E6.m1.69.69.69.26.16.16.1.5.cmml">d</mi></mrow><mi id="S3.E6.m1.70.70.70.27.17.17.1" xref="S3.E6.m1.70.70.70.27.17.17.1.cmml">i</mi></msubsup></mrow><mo id="S3.E6.m1.71.71.71.28.18.18" stretchy="false" xref="S3.E6.m1.78.78.6a.cmml">]</mo></mrow><mo id="S3.E6.m1.72.72.72.29.19.19" stretchy="false" xref="S3.E6.m1.78.78.6a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E6.m1.84b"><apply id="S3.E6.m1.78.78.6.cmml" xref="S3.E6.m1.84.84.12"><and id="S3.E6.m1.78.78.6a.cmml" xref="S3.E6.m1.5.5.5.5.5.6"></and><apply id="S3.E6.m1.78.78.6b.cmml" xref="S3.E6.m1.84.84.12"><eq id="S3.E6.m1.6.6.6.6.1.1.cmml" xref="S3.E6.m1.6.6.6.6.1.1"></eq><apply id="S3.E6.m1.78.78.6.8.cmml" xref="S3.E6.m1.84.84.12"><times id="S3.E6.m1.78.78.6.8.1.cmml" xref="S3.E6.m1.5.5.5.5.5.6"></times><ci id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1">𝑀</ci><ci id="S3.E6.m1.2.2.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2.2.2">𝐴</ci><apply id="S3.E6.m1.78.78.6.8.4.cmml" xref="S3.E6.m1.84.84.12"><csymbol cd="ambiguous" id="S3.E6.m1.78.78.6.8.4.1.cmml" xref="S3.E6.m1.5.5.5.5.5.6">superscript</csymbol><apply id="S3.E6.m1.78.78.6.8.4.2.cmml" xref="S3.E6.m1.84.84.12"><csymbol cd="ambiguous" id="S3.E6.m1.78.78.6.8.4.2.1.cmml" xref="S3.E6.m1.5.5.5.5.5.6">subscript</csymbol><ci id="S3.E6.m1.3.3.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3.3.3">𝐹</ci><apply id="S3.E6.m1.4.4.4.4.4.4.1.cmml" xref="S3.E6.m1.4.4.4.4.4.4.1"><times id="S3.E6.m1.4.4.4.4.4.4.1.1.cmml" xref="S3.E6.m1.4.4.4.4.4.4.1.1"></times><ci id="S3.E6.m1.4.4.4.4.4.4.1.2.cmml" xref="S3.E6.m1.4.4.4.4.4.4.1.2">𝑎</ci><ci id="S3.E6.m1.4.4.4.4.4.4.1.3.cmml" xref="S3.E6.m1.4.4.4.4.4.4.1.3">𝑡</ci><ci id="S3.E6.m1.4.4.4.4.4.4.1.4.cmml" xref="S3.E6.m1.4.4.4.4.4.4.1.4">𝑡</ci></apply></apply><ci id="S3.E6.m1.5.5.5.5.5.5.1.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1">𝑖</ci></apply></apply><apply id="S3.E6.m1.74.74.2.2.cmml" xref="S3.E6.m1.84.84.12"><times id="S3.E6.m1.74.74.2.2.3.cmml" xref="S3.E6.m1.5.5.5.5.5.6"></times><ci id="S3.E6.m1.7.7.7.7.2.2.cmml" xref="S3.E6.m1.7.7.7.7.2.2">𝐹</ci><interval closure="open" id="S3.E6.m1.74.74.2.2.2.3.cmml" xref="S3.E6.m1.84.84.12"><apply id="S3.E6.m1.73.73.1.1.1.1.1.cmml" xref="S3.E6.m1.84.84.12"><times id="S3.E6.m1.73.73.1.1.1.1.1.1.cmml" xref="S3.E6.m1.84.84.12"></times><ci id="S3.E6.m1.9.9.9.9.4.4.cmml" xref="S3.E6.m1.9.9.9.9.4.4">𝑎</ci><ci id="S3.E6.m1.10.10.10.10.5.5.cmml" xref="S3.E6.m1.10.10.10.10.5.5">𝑡</ci><apply id="S3.E6.m1.73.73.1.1.1.1.1.4.cmml" xref="S3.E6.m1.84.84.12"><csymbol cd="ambiguous" id="S3.E6.m1.73.73.1.1.1.1.1.4.1.cmml" xref="S3.E6.m1.84.84.12">superscript</csymbol><apply id="S3.E6.m1.73.73.1.1.1.1.1.4.2.cmml" xref="S3.E6.m1.84.84.12"><csymbol cd="ambiguous" id="S3.E6.m1.73.73.1.1.1.1.1.4.2.1.cmml" xref="S3.E6.m1.84.84.12">subscript</csymbol><ci id="S3.E6.m1.11.11.11.11.6.6.cmml" xref="S3.E6.m1.11.11.11.11.6.6">𝑡</ci><apply id="S3.E6.m1.12.12.12.12.7.7.1.cmml" xref="S3.E6.m1.12.12.12.12.7.7.1"><times id="S3.E6.m1.12.12.12.12.7.7.1.1.cmml" xref="S3.E6.m1.12.12.12.12.7.7.1.1"></times><ci id="S3.E6.m1.12.12.12.12.7.7.1.2.cmml" xref="S3.E6.m1.12.12.12.12.7.7.1.2">𝐼</ci><ci id="S3.E6.m1.12.12.12.12.7.7.1.3.cmml" xref="S3.E6.m1.12.12.12.12.7.7.1.3">𝐷</ci></apply></apply><ci id="S3.E6.m1.13.13.13.13.8.8.1.cmml" xref="S3.E6.m1.13.13.13.13.8.8.1">𝑖</ci></apply></apply><apply id="S3.E6.m1.74.74.2.2.2.2.2.cmml" xref="S3.E6.m1.84.84.12"><times id="S3.E6.m1.74.74.2.2.2.2.2.1.cmml" xref="S3.E6.m1.84.84.12"></times><ci id="S3.E6.m1.15.15.15.15.10.10.cmml" xref="S3.E6.m1.15.15.15.15.10.10">𝑎</ci><ci id="S3.E6.m1.16.16.16.16.11.11.cmml" xref="S3.E6.m1.16.16.16.16.11.11">𝑡</ci><apply id="S3.E6.m1.74.74.2.2.2.2.2.4.cmml" xref="S3.E6.m1.84.84.12"><csymbol cd="ambiguous" id="S3.E6.m1.74.74.2.2.2.2.2.4.1.cmml" xref="S3.E6.m1.84.84.12">superscript</csymbol><apply id="S3.E6.m1.74.74.2.2.2.2.2.4.2.cmml" xref="S3.E6.m1.84.84.12"><csymbol cd="ambiguous" id="S3.E6.m1.74.74.2.2.2.2.2.4.2.1.cmml" xref="S3.E6.m1.84.84.12">subscript</csymbol><ci id="S3.E6.m1.17.17.17.17.12.12.cmml" xref="S3.E6.m1.17.17.17.17.12.12">𝑡</ci><ci id="S3.E6.m1.18.18.18.18.13.13.1.cmml" xref="S3.E6.m1.18.18.18.18.13.13.1">𝑚</ci></apply><ci id="S3.E6.m1.19.19.19.19.14.14.1.cmml" xref="S3.E6.m1.19.19.19.19.14.14.1">𝑖</ci></apply></apply></interval><ci id="S3.E6.m1.21.21.21.1.1.1.cmml" xref="S3.E6.m1.21.21.21.1.1.1">𝑀</ci><ci id="S3.E6.m1.22.22.22.2.2.2.cmml" xref="S3.E6.m1.22.22.22.2.2.2">𝐴</ci><apply id="S3.E6.m1.74.74.2.2.7.cmml" xref="S3.E6.m1.84.84.12"><csymbol cd="ambiguous" id="S3.E6.m1.74.74.2.2.7.1.cmml" xref="S3.E6.m1.5.5.5.5.5.6">superscript</csymbol><apply id="S3.E6.m1.74.74.2.2.7.2.cmml" xref="S3.E6.m1.84.84.12"><csymbol cd="ambiguous" id="S3.E6.m1.74.74.2.2.7.2.1.cmml" xref="S3.E6.m1.5.5.5.5.5.6">subscript</csymbol><ci id="S3.E6.m1.23.23.23.3.3.3.cmml" xref="S3.E6.m1.23.23.23.3.3.3">𝐹</ci><apply id="S3.E6.m1.24.24.24.4.4.4.1.cmml" xref="S3.E6.m1.24.24.24.4.4.4.1"><times id="S3.E6.m1.24.24.24.4.4.4.1.1.cmml" xref="S3.E6.m1.24.24.24.4.4.4.1.1"></times><ci id="S3.E6.m1.24.24.24.4.4.4.1.2.cmml" xref="S3.E6.m1.24.24.24.4.4.4.1.2">ℎ</ci><ci id="S3.E6.m1.24.24.24.4.4.4.1.3.cmml" xref="S3.E6.m1.24.24.24.4.4.4.1.3">𝑒</ci><ci id="S3.E6.m1.24.24.24.4.4.4.1.4.cmml" xref="S3.E6.m1.24.24.24.4.4.4.1.4">𝑎</ci><ci id="S3.E6.m1.24.24.24.4.4.4.1.5.cmml" xref="S3.E6.m1.24.24.24.4.4.4.1.5">𝑑</ci></apply></apply><ci id="S3.E6.m1.25.25.25.5.5.5.1.cmml" xref="S3.E6.m1.25.25.25.5.5.5.1">𝑖</ci></apply></apply></apply><apply id="S3.E6.m1.78.78.6c.cmml" xref="S3.E6.m1.84.84.12"><eq id="S3.E6.m1.26.26.26.6.1.1.cmml" xref="S3.E6.m1.26.26.26.6.1.1"></eq><share href="https://arxiv.org/html/2405.17959v1#S3.E6.m1.74.74.2.2.cmml" id="S3.E6.m1.78.78.6d.cmml" xref="S3.E6.m1.5.5.5.5.5.6"></share><apply id="S3.E6.m1.77.77.5.5.cmml" xref="S3.E6.m1.84.84.12"><times id="S3.E6.m1.77.77.5.5.4.cmml" xref="S3.E6.m1.5.5.5.5.5.6"></times><ci id="S3.E6.m1.27.27.27.7.2.2.cmml" xref="S3.E6.m1.27.27.27.7.2.2">𝑠</ci><ci id="S3.E6.m1.28.28.28.8.3.3.cmml" xref="S3.E6.m1.28.28.28.8.3.3">𝑜</ci><ci id="S3.E6.m1.29.29.29.9.4.4.cmml" xref="S3.E6.m1.29.29.29.9.4.4">𝑓</ci><ci id="S3.E6.m1.30.30.30.10.5.5.cmml" xref="S3.E6.m1.30.30.30.10.5.5">𝑡</ci><ci id="S3.E6.m1.31.31.31.11.6.6.cmml" xref="S3.E6.m1.31.31.31.11.6.6">𝑚</ci><ci id="S3.E6.m1.32.32.32.12.7.7.cmml" xref="S3.E6.m1.32.32.32.12.7.7">𝑎</ci><ci id="S3.E6.m1.33.33.33.13.8.8.cmml" xref="S3.E6.m1.33.33.33.13.8.8">𝑥</ci><apply id="S3.E6.m1.35.35.35.15.10.10.cmml" xref="S3.E6.m1.35.35.35.15.10.10"><divide id="S3.E6.m1.35.35.35.15.10.10.1.cmml" xref="S3.E6.m1.35.35.35.15.10.10"></divide><apply id="S3.E6.m1.35.35.35.15.10.10.2.cmml" xref="S3.E6.m1.35.35.35.15.10.10.2"><times id="S3.E6.m1.35.35.35.15.10.10.2.1.cmml" xref="S3.E6.m1.35.35.35.15.10.10.2.1"></times><ci id="S3.E6.m1.35.35.35.15.10.10.2.2.cmml" xref="S3.E6.m1.35.35.35.15.10.10.2.2">𝑀</ci><ci id="S3.E6.m1.35.35.35.15.10.10.2.3.cmml" xref="S3.E6.m1.35.35.35.15.10.10.2.3">𝐴</ci><apply id="S3.E6.m1.35.35.35.15.10.10.2.4.cmml" xref="S3.E6.m1.35.35.35.15.10.10.2.4"><csymbol cd="ambiguous" id="S3.E6.m1.35.35.35.15.10.10.2.4.1.cmml" xref="S3.E6.m1.35.35.35.15.10.10.2.4">superscript</csymbol><apply id="S3.E6.m1.35.35.35.15.10.10.2.4.2.cmml" xref="S3.E6.m1.35.35.35.15.10.10.2.4"><csymbol cd="ambiguous" id="S3.E6.m1.35.35.35.15.10.10.2.4.2.1.cmml" xref="S3.E6.m1.35.35.35.15.10.10.2.4">subscript</csymbol><ci id="S3.E6.m1.35.35.35.15.10.10.2.4.2.2.cmml" xref="S3.E6.m1.35.35.35.15.10.10.2.4.2.2">𝐹</ci><apply id="S3.E6.m1.35.35.35.15.10.10.2.4.2.3.cmml" xref="S3.E6.m1.35.35.35.15.10.10.2.4.2.3"><times id="S3.E6.m1.35.35.35.15.10.10.2.4.2.3.1.cmml" xref="S3.E6.m1.35.35.35.15.10.10.2.4.2.3.1"></times><ci id="S3.E6.m1.35.35.35.15.10.10.2.4.2.3.2.cmml" xref="S3.E6.m1.35.35.35.15.10.10.2.4.2.3.2">𝑎</ci><ci id="S3.E6.m1.35.35.35.15.10.10.2.4.2.3.3.cmml" xref="S3.E6.m1.35.35.35.15.10.10.2.4.2.3.3">𝑡</ci><ci id="S3.E6.m1.35.35.35.15.10.10.2.4.2.3.4.cmml" xref="S3.E6.m1.35.35.35.15.10.10.2.4.2.3.4">𝑡</ci></apply></apply><ci id="S3.E6.m1.35.35.35.15.10.10.2.4.3.cmml" xref="S3.E6.m1.35.35.35.15.10.10.2.4.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.35.35.35.15.10.10.3.cmml" xref="S3.E6.m1.35.35.35.15.10.10.3"><root id="S3.E6.m1.35.35.35.15.10.10.3a.cmml" xref="S3.E6.m1.35.35.35.15.10.10.3"></root><ci id="S3.E6.m1.35.35.35.15.10.10.3.2.cmml" xref="S3.E6.m1.35.35.35.15.10.10.3.2">𝑑</ci></apply></apply><apply id="S3.E6.m1.75.75.3.3.1.1.1.cmml" xref="S3.E6.m1.84.84.12"><times id="S3.E6.m1.75.75.3.3.1.1.1.1.cmml" xref="S3.E6.m1.84.84.12"></times><apply id="S3.E6.m1.75.75.3.3.1.1.1.2.cmml" xref="S3.E6.m1.84.84.12"><csymbol cd="ambiguous" id="S3.E6.m1.75.75.3.3.1.1.1.2.1.cmml" xref="S3.E6.m1.84.84.12">superscript</csymbol><ci id="S3.E6.m1.38.38.38.18.13.13.cmml" xref="S3.E6.m1.38.38.38.18.13.13">𝑅</ci><ci id="S3.E6.m1.39.39.39.19.14.14.1.cmml" xref="S3.E6.m1.39.39.39.19.14.14.1">𝑘</ci></apply><apply id="S3.E6.m1.75.75.3.3.1.1.1.3.cmml" xref="S3.E6.m1.84.84.12"><csymbol cd="ambiguous" id="S3.E6.m1.75.75.3.3.1.1.1.3.1.cmml" xref="S3.E6.m1.84.84.12">superscript</csymbol><apply id="S3.E6.m1.75.75.3.3.1.1.1.3.2.cmml" xref="S3.E6.m1.84.84.12"><csymbol cd="ambiguous" id="S3.E6.m1.75.75.3.3.1.1.1.3.2.1.cmml" xref="S3.E6.m1.84.84.12">subscript</csymbol><ci id="S3.E6.m1.40.40.40.20.15.15.cmml" xref="S3.E6.m1.40.40.40.20.15.15">𝑊</ci><ci id="S3.E6.m1.41.41.41.21.16.16.1.cmml" xref="S3.E6.m1.41.41.41.21.16.16.1">𝑉</ci></apply><ci id="S3.E6.m1.42.42.42.22.17.17.1.cmml" xref="S3.E6.m1.42.42.42.22.17.17.1">𝑖</ci></apply></apply><ci id="S3.E6.m1.44.44.44.1.1.1.cmml" xref="S3.E6.m1.44.44.44.1.1.1">𝑀</ci><ci id="S3.E6.m1.45.45.45.2.2.2.cmml" xref="S3.E6.m1.45.45.45.2.2.2">𝐴</ci><ci id="S3.E6.m1.46.46.46.3.3.3.cmml" xref="S3.E6.m1.46.46.46.3.3.3">𝐹</ci><interval closure="open" id="S3.E6.m1.77.77.5.5.3.3.cmml" xref="S3.E6.m1.84.84.12"><apply id="S3.E6.m1.76.76.4.4.2.1.1.cmml" xref="S3.E6.m1.84.84.12"><csymbol cd="ambiguous" id="S3.E6.m1.76.76.4.4.2.1.1.1.cmml" xref="S3.E6.m1.84.84.12">superscript</csymbol><ci id="S3.E6.m1.48.48.48.5.5.5.cmml" xref="S3.E6.m1.48.48.48.5.5.5">𝑅</ci><ci id="S3.E6.m1.49.49.49.6.6.6.1.cmml" xref="S3.E6.m1.49.49.49.6.6.6.1">𝑘</ci></apply><apply id="S3.E6.m1.77.77.5.5.3.2.2.cmml" xref="S3.E6.m1.84.84.12"><csymbol cd="ambiguous" id="S3.E6.m1.77.77.5.5.3.2.2.1.cmml" xref="S3.E6.m1.84.84.12">subscript</csymbol><ci id="S3.E6.m1.51.51.51.8.8.8.cmml" xref="S3.E6.m1.51.51.51.8.8.8">𝐸</ci><ci id="S3.E6.m1.52.52.52.9.9.9.1.cmml" xref="S3.E6.m1.52.52.52.9.9.9.1">𝑚</ci></apply></interval></apply></apply><apply id="S3.E6.m1.78.78.6e.cmml" xref="S3.E6.m1.84.84.12"><eq id="S3.E6.m1.54.54.54.11.1.1.cmml" xref="S3.E6.m1.54.54.54.11.1.1"></eq><share href="https://arxiv.org/html/2405.17959v1#S3.E6.m1.77.77.5.5.cmml" id="S3.E6.m1.78.78.6f.cmml" xref="S3.E6.m1.5.5.5.5.5.6"></share><apply id="S3.E6.m1.78.78.6.6.cmml" xref="S3.E6.m1.84.84.12"><times id="S3.E6.m1.78.78.6.6.2.cmml" xref="S3.E6.m1.5.5.5.5.5.6"></times><ci id="S3.E6.m1.55.55.55.12.2.2.cmml" xref="S3.E6.m1.55.55.55.12.2.2">concat</ci><list id="S3.E6.m1.78.78.6.6.1.1.1.3.cmml" xref="S3.E6.m1.84.84.12"><apply id="S3.E6.m1.78.78.6.6.1.1.1.1.1.cmml" xref="S3.E6.m1.84.84.12"><times id="S3.E6.m1.78.78.6.6.1.1.1.1.1.1.cmml" xref="S3.E6.m1.84.84.12"></times><ci id="S3.E6.m1.58.58.58.15.5.5.cmml" xref="S3.E6.m1.58.58.58.15.5.5">𝑀</ci><ci id="S3.E6.m1.59.59.59.16.6.6.cmml" xref="S3.E6.m1.59.59.59.16.6.6">𝐴</ci><apply id="S3.E6.m1.78.78.6.6.1.1.1.1.1.4.cmml" xref="S3.E6.m1.84.84.12"><csymbol cd="ambiguous" id="S3.E6.m1.78.78.6.6.1.1.1.1.1.4.1.cmml" xref="S3.E6.m1.84.84.12">superscript</csymbol><apply id="S3.E6.m1.78.78.6.6.1.1.1.1.1.4.2.cmml" xref="S3.E6.m1.84.84.12"><csymbol cd="ambiguous" id="S3.E6.m1.78.78.6.6.1.1.1.1.1.4.2.1.cmml" xref="S3.E6.m1.84.84.12">subscript</csymbol><ci id="S3.E6.m1.60.60.60.17.7.7.cmml" xref="S3.E6.m1.60.60.60.17.7.7">𝐹</ci><apply id="S3.E6.m1.61.61.61.18.8.8.1.cmml" xref="S3.E6.m1.61.61.61.18.8.8.1"><times id="S3.E6.m1.61.61.61.18.8.8.1.1.cmml" xref="S3.E6.m1.61.61.61.18.8.8.1.1"></times><ci id="S3.E6.m1.61.61.61.18.8.8.1.2.cmml" xref="S3.E6.m1.61.61.61.18.8.8.1.2">ℎ</ci><ci id="S3.E6.m1.61.61.61.18.8.8.1.3.cmml" xref="S3.E6.m1.61.61.61.18.8.8.1.3">𝑒</ci><ci id="S3.E6.m1.61.61.61.18.8.8.1.4.cmml" xref="S3.E6.m1.61.61.61.18.8.8.1.4">𝑎</ci><ci id="S3.E6.m1.61.61.61.18.8.8.1.5.cmml" xref="S3.E6.m1.61.61.61.18.8.8.1.5">𝑑</ci></apply></apply><cn id="S3.E6.m1.62.62.62.19.9.9.1.cmml" type="integer" xref="S3.E6.m1.62.62.62.19.9.9.1">1</cn></apply></apply><ci id="S3.E6.m1.64.64.64.21.11.11.cmml" xref="S3.E6.m1.64.64.64.21.11.11">⋯</ci><apply id="S3.E6.m1.78.78.6.6.1.1.1.2.2.cmml" xref="S3.E6.m1.84.84.12"><times id="S3.E6.m1.78.78.6.6.1.1.1.2.2.1.cmml" xref="S3.E6.m1.84.84.12"></times><ci id="S3.E6.m1.66.66.66.23.13.13.cmml" xref="S3.E6.m1.66.66.66.23.13.13">𝑀</ci><ci id="S3.E6.m1.67.67.67.24.14.14.cmml" xref="S3.E6.m1.67.67.67.24.14.14">𝐴</ci><apply id="S3.E6.m1.78.78.6.6.1.1.1.2.2.4.cmml" xref="S3.E6.m1.84.84.12"><csymbol cd="ambiguous" id="S3.E6.m1.78.78.6.6.1.1.1.2.2.4.1.cmml" xref="S3.E6.m1.84.84.12">superscript</csymbol><apply id="S3.E6.m1.78.78.6.6.1.1.1.2.2.4.2.cmml" xref="S3.E6.m1.84.84.12"><csymbol cd="ambiguous" id="S3.E6.m1.78.78.6.6.1.1.1.2.2.4.2.1.cmml" xref="S3.E6.m1.84.84.12">subscript</csymbol><ci id="S3.E6.m1.68.68.68.25.15.15.cmml" xref="S3.E6.m1.68.68.68.25.15.15">𝐹</ci><apply id="S3.E6.m1.69.69.69.26.16.16.1.cmml" xref="S3.E6.m1.69.69.69.26.16.16.1"><times id="S3.E6.m1.69.69.69.26.16.16.1.1.cmml" xref="S3.E6.m1.69.69.69.26.16.16.1.1"></times><ci id="S3.E6.m1.69.69.69.26.16.16.1.2.cmml" xref="S3.E6.m1.69.69.69.26.16.16.1.2">ℎ</ci><ci id="S3.E6.m1.69.69.69.26.16.16.1.3.cmml" xref="S3.E6.m1.69.69.69.26.16.16.1.3">𝑒</ci><ci id="S3.E6.m1.69.69.69.26.16.16.1.4.cmml" xref="S3.E6.m1.69.69.69.26.16.16.1.4">𝑎</ci><ci id="S3.E6.m1.69.69.69.26.16.16.1.5.cmml" xref="S3.E6.m1.69.69.69.26.16.16.1.5">𝑑</ci></apply></apply><ci id="S3.E6.m1.70.70.70.27.17.17.1.cmml" xref="S3.E6.m1.70.70.70.27.17.17.1">𝑖</ci></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.84c">\begin{split}MAF_{att}^{i}&amp;=F(att_{ID}^{i},att_{m}^{i})\\
MAF_{head}^{i}&amp;=softmax(\frac{MAF_{att}^{i}}{\sqrt{d}})(R^{k}W_{V}^{i})\\
MAF(R^{k},E_{m})&amp;=\mathrm{concat}([MAF_{head}^{1},\cdots,MAF_{head}^{i}])\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.84d">start_ROW start_CELL italic_M italic_A italic_F start_POSTSUBSCRIPT italic_a italic_t italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT end_CELL start_CELL = italic_F ( italic_a italic_t italic_t start_POSTSUBSCRIPT italic_I italic_D end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_a italic_t italic_t start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) end_CELL end_ROW start_ROW start_CELL italic_M italic_A italic_F start_POSTSUBSCRIPT italic_h italic_e italic_a italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT end_CELL start_CELL = italic_s italic_o italic_f italic_t italic_m italic_a italic_x ( divide start_ARG italic_M italic_A italic_F start_POSTSUBSCRIPT italic_a italic_t italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG ) ( italic_R start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) end_CELL end_ROW start_ROW start_CELL italic_M italic_A italic_F ( italic_R start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT , italic_E start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ) end_CELL start_CELL = roman_concat ( [ italic_M italic_A italic_F start_POSTSUBSCRIPT italic_h italic_e italic_a italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , ⋯ , italic_M italic_A italic_F start_POSTSUBSCRIPT italic_h italic_e italic_a italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ] ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Prediction module</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.5">To recommend a new item, the last element <math alttext="R_{n}^{L}\in\mathbb{R}^{1\times d}" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><mrow id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><msubsup id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2.2.2" xref="S3.SS4.p1.1.m1.1.1.2.2.2.cmml">R</mi><mi id="S3.SS4.p1.1.m1.1.1.2.2.3" xref="S3.SS4.p1.1.m1.1.1.2.2.3.cmml">n</mi><mi id="S3.SS4.p1.1.m1.1.1.2.3" xref="S3.SS4.p1.1.m1.1.1.2.3.cmml">L</mi></msubsup><mo id="S3.SS4.p1.1.m1.1.1.1" xref="S3.SS4.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml"><mi id="S3.SS4.p1.1.m1.1.1.3.2" xref="S3.SS4.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.1.m1.1.1.3.3" xref="S3.SS4.p1.1.m1.1.1.3.3.cmml"><mn id="S3.SS4.p1.1.m1.1.1.3.3.2" xref="S3.SS4.p1.1.m1.1.1.3.3.2.cmml">1</mn><mo id="S3.SS4.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS4.p1.1.m1.1.1.3.3.3" xref="S3.SS4.p1.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><in id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1.1"></in><apply id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.2.1.cmml" xref="S3.SS4.p1.1.m1.1.1.2">superscript</csymbol><apply id="S3.SS4.p1.1.m1.1.1.2.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.2.2.1.cmml" xref="S3.SS4.p1.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.2.2.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2.2.2">𝑅</ci><ci id="S3.SS4.p1.1.m1.1.1.2.2.3.cmml" xref="S3.SS4.p1.1.m1.1.1.2.2.3">𝑛</ci></apply><ci id="S3.SS4.p1.1.m1.1.1.2.3.cmml" xref="S3.SS4.p1.1.m1.1.1.2.3">𝐿</ci></apply><apply id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.3.1.cmml" xref="S3.SS4.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.3.2.cmml" xref="S3.SS4.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.1.m1.1.1.3.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3"><times id="S3.SS4.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3.1"></times><cn id="S3.SS4.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S3.SS4.p1.1.m1.1.1.3.3.2">1</cn><ci id="S3.SS4.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">R_{n}^{L}\in\mathbb{R}^{1\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">italic_R start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 1 × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> is taken from the final representation <math alttext="R^{L}" class="ltx_Math" display="inline" id="S3.SS4.p1.2.m2.1"><semantics id="S3.SS4.p1.2.m2.1a"><msup id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">R</mi><mi id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml">L</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2">𝑅</ci><ci id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">R^{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.2.m2.1d">italic_R start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>.
<math alttext="R_{n}^{L}" class="ltx_Math" display="inline" id="S3.SS4.p1.3.m3.1"><semantics id="S3.SS4.p1.3.m3.1a"><msubsup id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml"><mi id="S3.SS4.p1.3.m3.1.1.2.2" xref="S3.SS4.p1.3.m3.1.1.2.2.cmml">R</mi><mi id="S3.SS4.p1.3.m3.1.1.2.3" xref="S3.SS4.p1.3.m3.1.1.2.3.cmml">n</mi><mi id="S3.SS4.p1.3.m3.1.1.3" xref="S3.SS4.p1.3.m3.1.1.3.cmml">L</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">superscript</csymbol><apply id="S3.SS4.p1.3.m3.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.2.1.cmml" xref="S3.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p1.3.m3.1.1.2.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2.2">𝑅</ci><ci id="S3.SS4.p1.3.m3.1.1.2.3.cmml" xref="S3.SS4.p1.3.m3.1.1.2.3">𝑛</ci></apply><ci id="S3.SS4.p1.3.m3.1.1.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">R_{n}^{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.3.m3.1d">italic_R start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math> computes to the inner product with the item embedding table <math alttext="M_{id}\in\mathbb{R}^{d\times|I|}" class="ltx_Math" display="inline" id="S3.SS4.p1.4.m4.1"><semantics id="S3.SS4.p1.4.m4.1a"><mrow id="S3.SS4.p1.4.m4.1.2" xref="S3.SS4.p1.4.m4.1.2.cmml"><msub id="S3.SS4.p1.4.m4.1.2.2" xref="S3.SS4.p1.4.m4.1.2.2.cmml"><mi id="S3.SS4.p1.4.m4.1.2.2.2" xref="S3.SS4.p1.4.m4.1.2.2.2.cmml">M</mi><mrow id="S3.SS4.p1.4.m4.1.2.2.3" xref="S3.SS4.p1.4.m4.1.2.2.3.cmml"><mi id="S3.SS4.p1.4.m4.1.2.2.3.2" xref="S3.SS4.p1.4.m4.1.2.2.3.2.cmml">i</mi><mo id="S3.SS4.p1.4.m4.1.2.2.3.1" xref="S3.SS4.p1.4.m4.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.4.m4.1.2.2.3.3" xref="S3.SS4.p1.4.m4.1.2.2.3.3.cmml">d</mi></mrow></msub><mo id="S3.SS4.p1.4.m4.1.2.1" xref="S3.SS4.p1.4.m4.1.2.1.cmml">∈</mo><msup id="S3.SS4.p1.4.m4.1.2.3" xref="S3.SS4.p1.4.m4.1.2.3.cmml"><mi id="S3.SS4.p1.4.m4.1.2.3.2" xref="S3.SS4.p1.4.m4.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.4.m4.1.1.1" xref="S3.SS4.p1.4.m4.1.1.1.cmml"><mi id="S3.SS4.p1.4.m4.1.1.1.3" xref="S3.SS4.p1.4.m4.1.1.1.3.cmml">d</mi><mo id="S3.SS4.p1.4.m4.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p1.4.m4.1.1.1.2.cmml">×</mo><mrow id="S3.SS4.p1.4.m4.1.1.1.4.2" xref="S3.SS4.p1.4.m4.1.1.1.4.1.cmml"><mo id="S3.SS4.p1.4.m4.1.1.1.4.2.1" stretchy="false" xref="S3.SS4.p1.4.m4.1.1.1.4.1.1.cmml">|</mo><mi id="S3.SS4.p1.4.m4.1.1.1.1" xref="S3.SS4.p1.4.m4.1.1.1.1.cmml">I</mi><mo id="S3.SS4.p1.4.m4.1.1.1.4.2.2" stretchy="false" xref="S3.SS4.p1.4.m4.1.1.1.4.1.1.cmml">|</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><apply id="S3.SS4.p1.4.m4.1.2.cmml" xref="S3.SS4.p1.4.m4.1.2"><in id="S3.SS4.p1.4.m4.1.2.1.cmml" xref="S3.SS4.p1.4.m4.1.2.1"></in><apply id="S3.SS4.p1.4.m4.1.2.2.cmml" xref="S3.SS4.p1.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.2.2.1.cmml" xref="S3.SS4.p1.4.m4.1.2.2">subscript</csymbol><ci id="S3.SS4.p1.4.m4.1.2.2.2.cmml" xref="S3.SS4.p1.4.m4.1.2.2.2">𝑀</ci><apply id="S3.SS4.p1.4.m4.1.2.2.3.cmml" xref="S3.SS4.p1.4.m4.1.2.2.3"><times id="S3.SS4.p1.4.m4.1.2.2.3.1.cmml" xref="S3.SS4.p1.4.m4.1.2.2.3.1"></times><ci id="S3.SS4.p1.4.m4.1.2.2.3.2.cmml" xref="S3.SS4.p1.4.m4.1.2.2.3.2">𝑖</ci><ci id="S3.SS4.p1.4.m4.1.2.2.3.3.cmml" xref="S3.SS4.p1.4.m4.1.2.2.3.3">𝑑</ci></apply></apply><apply id="S3.SS4.p1.4.m4.1.2.3.cmml" xref="S3.SS4.p1.4.m4.1.2.3"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.2.3.1.cmml" xref="S3.SS4.p1.4.m4.1.2.3">superscript</csymbol><ci id="S3.SS4.p1.4.m4.1.2.3.2.cmml" xref="S3.SS4.p1.4.m4.1.2.3.2">ℝ</ci><apply id="S3.SS4.p1.4.m4.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1.1"><times id="S3.SS4.p1.4.m4.1.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1.1.2"></times><ci id="S3.SS4.p1.4.m4.1.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.1.3">𝑑</ci><apply id="S3.SS4.p1.4.m4.1.1.1.4.1.cmml" xref="S3.SS4.p1.4.m4.1.1.1.4.2"><abs id="S3.SS4.p1.4.m4.1.1.1.4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1.1.4.2.1"></abs><ci id="S3.SS4.p1.4.m4.1.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1.1.1">𝐼</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">M_{id}\in\mathbb{R}^{d\times|I|}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.4.m4.1d">italic_M start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × | italic_I | end_POSTSUPERSCRIPT</annotation></semantics></math>, Where <math alttext="|I|" class="ltx_Math" display="inline" id="S3.SS4.p1.5.m5.1"><semantics id="S3.SS4.p1.5.m5.1a"><mrow id="S3.SS4.p1.5.m5.1.2.2" xref="S3.SS4.p1.5.m5.1.2.1.cmml"><mo id="S3.SS4.p1.5.m5.1.2.2.1" stretchy="false" xref="S3.SS4.p1.5.m5.1.2.1.1.cmml">|</mo><mi id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml">I</mi><mo id="S3.SS4.p1.5.m5.1.2.2.2" stretchy="false" xref="S3.SS4.p1.5.m5.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><apply id="S3.SS4.p1.5.m5.1.2.1.cmml" xref="S3.SS4.p1.5.m5.1.2.2"><abs id="S3.SS4.p1.5.m5.1.2.1.1.cmml" xref="S3.SS4.p1.5.m5.1.2.2.1"></abs><ci id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">|I|</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.5.m5.1d">| italic_I |</annotation></semantics></math> represents the total number of distinct items.
In addition, the softmax function can be used to derive the probability value of the item that the user will purchase.
According to Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S3.E7" title="Equation 7 ‣ 3.4 Prediction module ‣ 3 Proposed method ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">7</span></a>, a cross-entropy loss with softmax helps to decrease the difference in probabilities between the actual user-purchased items and the predicted items.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\begin{split}\hat{i}_{n+1}&amp;=softmax(R_{n}^{L}M_{id})\\
L_{id}&amp;=-\sum_{i=1}^{|l|}i_{n+1}\log\hat{i}_{n+1}\end{split}" class="ltx_Math" display="block" id="S3.E7.m1.31"><semantics id="S3.E7.m1.31a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E7.m1.31.31.2" rowspacing="0pt" xref="S3.E7.m1.30.30.1.cmml"><mtr id="S3.E7.m1.31.31.2a" xref="S3.E7.m1.30.30.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E7.m1.31.31.2b" xref="S3.E7.m1.30.30.1.cmml"><msub id="S3.E7.m1.2.2.2.2.2" xref="S3.E7.m1.30.30.1.cmml"><mover accent="true" id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.2.cmml">i</mi><mo id="S3.E7.m1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml">^</mo></mover><mrow id="S3.E7.m1.2.2.2.2.2.2.1" xref="S3.E7.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2.1.2" xref="S3.E7.m1.2.2.2.2.2.2.1.2.cmml">n</mi><mo id="S3.E7.m1.2.2.2.2.2.2.1.1" xref="S3.E7.m1.2.2.2.2.2.2.1.1.cmml">+</mo><mn id="S3.E7.m1.2.2.2.2.2.2.1.3" xref="S3.E7.m1.2.2.2.2.2.2.1.3.cmml">1</mn></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m1.31.31.2c" xref="S3.E7.m1.30.30.1.cmml"><mrow id="S3.E7.m1.31.31.2.30.18.16" xref="S3.E7.m1.30.30.1.cmml"><mi id="S3.E7.m1.31.31.2.30.18.16.17" xref="S3.E7.m1.30.30.1a.cmml"></mi><mo id="S3.E7.m1.3.3.3.3.1.1" xref="S3.E7.m1.3.3.3.3.1.1.cmml">=</mo><mrow id="S3.E7.m1.31.31.2.30.18.16.16" xref="S3.E7.m1.30.30.1.cmml"><mi id="S3.E7.m1.4.4.4.4.2.2" xref="S3.E7.m1.4.4.4.4.2.2.cmml">s</mi><mo id="S3.E7.m1.31.31.2.30.18.16.16.2" xref="S3.E7.m1.30.30.1a.cmml">⁢</mo><mi id="S3.E7.m1.5.5.5.5.3.3" xref="S3.E7.m1.5.5.5.5.3.3.cmml">o</mi><mo id="S3.E7.m1.31.31.2.30.18.16.16.2a" xref="S3.E7.m1.30.30.1a.cmml">⁢</mo><mi id="S3.E7.m1.6.6.6.6.4.4" xref="S3.E7.m1.6.6.6.6.4.4.cmml">f</mi><mo id="S3.E7.m1.31.31.2.30.18.16.16.2b" xref="S3.E7.m1.30.30.1a.cmml">⁢</mo><mi id="S3.E7.m1.7.7.7.7.5.5" xref="S3.E7.m1.7.7.7.7.5.5.cmml">t</mi><mo id="S3.E7.m1.31.31.2.30.18.16.16.2c" xref="S3.E7.m1.30.30.1a.cmml">⁢</mo><mi id="S3.E7.m1.8.8.8.8.6.6" xref="S3.E7.m1.8.8.8.8.6.6.cmml">m</mi><mo id="S3.E7.m1.31.31.2.30.18.16.16.2d" xref="S3.E7.m1.30.30.1a.cmml">⁢</mo><mi id="S3.E7.m1.9.9.9.9.7.7" xref="S3.E7.m1.9.9.9.9.7.7.cmml">a</mi><mo id="S3.E7.m1.31.31.2.30.18.16.16.2e" xref="S3.E7.m1.30.30.1a.cmml">⁢</mo><mi id="S3.E7.m1.10.10.10.10.8.8" xref="S3.E7.m1.10.10.10.10.8.8.cmml">x</mi><mo id="S3.E7.m1.31.31.2.30.18.16.16.2f" xref="S3.E7.m1.30.30.1a.cmml">⁢</mo><mrow id="S3.E7.m1.31.31.2.30.18.16.16.1.1" xref="S3.E7.m1.30.30.1.cmml"><mo id="S3.E7.m1.11.11.11.11.9.9" stretchy="false" xref="S3.E7.m1.30.30.1a.cmml">(</mo><mrow id="S3.E7.m1.31.31.2.30.18.16.16.1.1.1" xref="S3.E7.m1.30.30.1.cmml"><msubsup id="S3.E7.m1.31.31.2.30.18.16.16.1.1.1.2" xref="S3.E7.m1.30.30.1.cmml"><mi id="S3.E7.m1.12.12.12.12.10.10" xref="S3.E7.m1.12.12.12.12.10.10.cmml">R</mi><mi id="S3.E7.m1.13.13.13.13.11.11.1" xref="S3.E7.m1.13.13.13.13.11.11.1.cmml">n</mi><mi id="S3.E7.m1.14.14.14.14.12.12.1" xref="S3.E7.m1.14.14.14.14.12.12.1.cmml">L</mi></msubsup><mo id="S3.E7.m1.31.31.2.30.18.16.16.1.1.1.1" xref="S3.E7.m1.30.30.1a.cmml">⁢</mo><msub id="S3.E7.m1.31.31.2.30.18.16.16.1.1.1.3" xref="S3.E7.m1.30.30.1.cmml"><mi id="S3.E7.m1.15.15.15.15.13.13" xref="S3.E7.m1.15.15.15.15.13.13.cmml">M</mi><mrow id="S3.E7.m1.16.16.16.16.14.14.1" xref="S3.E7.m1.16.16.16.16.14.14.1.cmml"><mi id="S3.E7.m1.16.16.16.16.14.14.1.2" xref="S3.E7.m1.16.16.16.16.14.14.1.2.cmml">i</mi><mo id="S3.E7.m1.16.16.16.16.14.14.1.1" xref="S3.E7.m1.16.16.16.16.14.14.1.1.cmml">⁢</mo><mi id="S3.E7.m1.16.16.16.16.14.14.1.3" xref="S3.E7.m1.16.16.16.16.14.14.1.3.cmml">d</mi></mrow></msub></mrow><mo id="S3.E7.m1.17.17.17.17.15.15" stretchy="false" xref="S3.E7.m1.30.30.1a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E7.m1.31.31.2d" xref="S3.E7.m1.30.30.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E7.m1.31.31.2e" xref="S3.E7.m1.30.30.1.cmml"><msub id="S3.E7.m1.19.19.19.2.2" xref="S3.E7.m1.30.30.1.cmml"><mi id="S3.E7.m1.18.18.18.1.1.1" xref="S3.E7.m1.18.18.18.1.1.1.cmml">L</mi><mrow id="S3.E7.m1.19.19.19.2.2.2.1" xref="S3.E7.m1.19.19.19.2.2.2.1.cmml"><mi id="S3.E7.m1.19.19.19.2.2.2.1.2" xref="S3.E7.m1.19.19.19.2.2.2.1.2.cmml">i</mi><mo id="S3.E7.m1.19.19.19.2.2.2.1.1" xref="S3.E7.m1.19.19.19.2.2.2.1.1.cmml">⁢</mo><mi id="S3.E7.m1.19.19.19.2.2.2.1.3" xref="S3.E7.m1.19.19.19.2.2.2.1.3.cmml">d</mi></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m1.31.31.2f" xref="S3.E7.m1.30.30.1.cmml"><mrow id="S3.E7.m1.29.29.29.12.10" xref="S3.E7.m1.30.30.1.cmml"><mi id="S3.E7.m1.29.29.29.12.10.11" xref="S3.E7.m1.30.30.1a.cmml"></mi><mo id="S3.E7.m1.20.20.20.3.1.1" xref="S3.E7.m1.20.20.20.3.1.1.cmml">=</mo><mrow id="S3.E7.m1.29.29.29.12.10.12" xref="S3.E7.m1.30.30.1.cmml"><mo id="S3.E7.m1.29.29.29.12.10.12a" xref="S3.E7.m1.30.30.1a.cmml">−</mo><mrow id="S3.E7.m1.29.29.29.12.10.12.1" xref="S3.E7.m1.30.30.1.cmml"><munderover id="S3.E7.m1.29.29.29.12.10.12.1.1" xref="S3.E7.m1.30.30.1.cmml"><mo id="S3.E7.m1.22.22.22.5.3.3" movablelimits="false" xref="S3.E7.m1.22.22.22.5.3.3.cmml">∑</mo><mrow id="S3.E7.m1.23.23.23.6.4.4.1" xref="S3.E7.m1.23.23.23.6.4.4.1.cmml"><mi id="S3.E7.m1.23.23.23.6.4.4.1.2" xref="S3.E7.m1.23.23.23.6.4.4.1.2.cmml">i</mi><mo id="S3.E7.m1.23.23.23.6.4.4.1.1" xref="S3.E7.m1.23.23.23.6.4.4.1.1.cmml">=</mo><mn id="S3.E7.m1.23.23.23.6.4.4.1.3" xref="S3.E7.m1.23.23.23.6.4.4.1.3.cmml">1</mn></mrow><mrow id="S3.E7.m1.24.24.24.7.5.5.1.3" xref="S3.E7.m1.24.24.24.7.5.5.1.2.cmml"><mo id="S3.E7.m1.24.24.24.7.5.5.1.3.1" stretchy="false" xref="S3.E7.m1.24.24.24.7.5.5.1.2.1.cmml">|</mo><mi id="S3.E7.m1.24.24.24.7.5.5.1.1" xref="S3.E7.m1.24.24.24.7.5.5.1.1.cmml">l</mi><mo id="S3.E7.m1.24.24.24.7.5.5.1.3.2" stretchy="false" xref="S3.E7.m1.24.24.24.7.5.5.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S3.E7.m1.29.29.29.12.10.12.1.2" xref="S3.E7.m1.30.30.1.cmml"><msub id="S3.E7.m1.29.29.29.12.10.12.1.2.2" xref="S3.E7.m1.30.30.1.cmml"><mi id="S3.E7.m1.25.25.25.8.6.6" xref="S3.E7.m1.25.25.25.8.6.6.cmml">i</mi><mrow id="S3.E7.m1.26.26.26.9.7.7.1" xref="S3.E7.m1.26.26.26.9.7.7.1.cmml"><mi id="S3.E7.m1.26.26.26.9.7.7.1.2" xref="S3.E7.m1.26.26.26.9.7.7.1.2.cmml">n</mi><mo id="S3.E7.m1.26.26.26.9.7.7.1.1" xref="S3.E7.m1.26.26.26.9.7.7.1.1.cmml">+</mo><mn id="S3.E7.m1.26.26.26.9.7.7.1.3" xref="S3.E7.m1.26.26.26.9.7.7.1.3.cmml">1</mn></mrow></msub><mo id="S3.E7.m1.29.29.29.12.10.12.1.2.1" lspace="0.167em" xref="S3.E7.m1.30.30.1a.cmml">⁢</mo><mrow id="S3.E7.m1.29.29.29.12.10.12.1.2.3" xref="S3.E7.m1.30.30.1.cmml"><mi id="S3.E7.m1.27.27.27.10.8.8" xref="S3.E7.m1.27.27.27.10.8.8.cmml">log</mi><mo id="S3.E7.m1.29.29.29.12.10.12.1.2.3a" lspace="0.167em" xref="S3.E7.m1.30.30.1a.cmml">⁡</mo><msub id="S3.E7.m1.29.29.29.12.10.12.1.2.3.1" xref="S3.E7.m1.30.30.1.cmml"><mover accent="true" id="S3.E7.m1.28.28.28.11.9.9" xref="S3.E7.m1.28.28.28.11.9.9.cmml"><mi id="S3.E7.m1.28.28.28.11.9.9.2" xref="S3.E7.m1.28.28.28.11.9.9.2.cmml">i</mi><mo id="S3.E7.m1.28.28.28.11.9.9.1" xref="S3.E7.m1.28.28.28.11.9.9.1.cmml">^</mo></mover><mrow id="S3.E7.m1.29.29.29.12.10.10.1" xref="S3.E7.m1.29.29.29.12.10.10.1.cmml"><mi id="S3.E7.m1.29.29.29.12.10.10.1.2" xref="S3.E7.m1.29.29.29.12.10.10.1.2.cmml">n</mi><mo id="S3.E7.m1.29.29.29.12.10.10.1.1" xref="S3.E7.m1.29.29.29.12.10.10.1.1.cmml">+</mo><mn id="S3.E7.m1.29.29.29.12.10.10.1.3" xref="S3.E7.m1.29.29.29.12.10.10.1.3.cmml">1</mn></mrow></msub></mrow></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E7.m1.31b"><apply id="S3.E7.m1.30.30.1.cmml" xref="S3.E7.m1.31.31.2"><and id="S3.E7.m1.30.30.1a.cmml" xref="S3.E7.m1.31.31.2.30.18.16.17"></and><apply id="S3.E7.m1.30.30.1b.cmml" xref="S3.E7.m1.31.31.2"><eq id="S3.E7.m1.3.3.3.3.1.1.cmml" xref="S3.E7.m1.3.3.3.3.1.1"></eq><apply id="S3.E7.m1.30.30.1.3.cmml" xref="S3.E7.m1.31.31.2"><csymbol cd="ambiguous" id="S3.E7.m1.30.30.1.3.1.cmml" xref="S3.E7.m1.31.31.2.30.18.16.17">subscript</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1"><ci id="S3.E7.m1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1">^</ci><ci id="S3.E7.m1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2">𝑖</ci></apply><apply id="S3.E7.m1.2.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1"><plus id="S3.E7.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1"></plus><ci id="S3.E7.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.2">𝑛</ci><cn id="S3.E7.m1.2.2.2.2.2.2.1.3.cmml" type="integer" xref="S3.E7.m1.2.2.2.2.2.2.1.3">1</cn></apply></apply><apply id="S3.E7.m1.30.30.1.1.cmml" xref="S3.E7.m1.31.31.2"><times id="S3.E7.m1.30.30.1.1.2.cmml" xref="S3.E7.m1.31.31.2.30.18.16.17"></times><ci id="S3.E7.m1.4.4.4.4.2.2.cmml" xref="S3.E7.m1.4.4.4.4.2.2">𝑠</ci><ci id="S3.E7.m1.5.5.5.5.3.3.cmml" xref="S3.E7.m1.5.5.5.5.3.3">𝑜</ci><ci id="S3.E7.m1.6.6.6.6.4.4.cmml" xref="S3.E7.m1.6.6.6.6.4.4">𝑓</ci><ci id="S3.E7.m1.7.7.7.7.5.5.cmml" xref="S3.E7.m1.7.7.7.7.5.5">𝑡</ci><ci id="S3.E7.m1.8.8.8.8.6.6.cmml" xref="S3.E7.m1.8.8.8.8.6.6">𝑚</ci><ci id="S3.E7.m1.9.9.9.9.7.7.cmml" xref="S3.E7.m1.9.9.9.9.7.7">𝑎</ci><ci id="S3.E7.m1.10.10.10.10.8.8.cmml" xref="S3.E7.m1.10.10.10.10.8.8">𝑥</ci><apply id="S3.E7.m1.30.30.1.1.1.1.1.cmml" xref="S3.E7.m1.31.31.2"><times id="S3.E7.m1.30.30.1.1.1.1.1.1.cmml" xref="S3.E7.m1.31.31.2"></times><apply id="S3.E7.m1.30.30.1.1.1.1.1.2.cmml" xref="S3.E7.m1.31.31.2"><csymbol cd="ambiguous" id="S3.E7.m1.30.30.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.31.31.2">superscript</csymbol><apply id="S3.E7.m1.30.30.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.31.31.2"><csymbol cd="ambiguous" id="S3.E7.m1.30.30.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.31.31.2">subscript</csymbol><ci id="S3.E7.m1.12.12.12.12.10.10.cmml" xref="S3.E7.m1.12.12.12.12.10.10">𝑅</ci><ci id="S3.E7.m1.13.13.13.13.11.11.1.cmml" xref="S3.E7.m1.13.13.13.13.11.11.1">𝑛</ci></apply><ci id="S3.E7.m1.14.14.14.14.12.12.1.cmml" xref="S3.E7.m1.14.14.14.14.12.12.1">𝐿</ci></apply><apply id="S3.E7.m1.30.30.1.1.1.1.1.3.cmml" xref="S3.E7.m1.31.31.2"><csymbol cd="ambiguous" id="S3.E7.m1.30.30.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.31.31.2">subscript</csymbol><ci id="S3.E7.m1.15.15.15.15.13.13.cmml" xref="S3.E7.m1.15.15.15.15.13.13">𝑀</ci><apply id="S3.E7.m1.16.16.16.16.14.14.1.cmml" xref="S3.E7.m1.16.16.16.16.14.14.1"><times id="S3.E7.m1.16.16.16.16.14.14.1.1.cmml" xref="S3.E7.m1.16.16.16.16.14.14.1.1"></times><ci id="S3.E7.m1.16.16.16.16.14.14.1.2.cmml" xref="S3.E7.m1.16.16.16.16.14.14.1.2">𝑖</ci><ci id="S3.E7.m1.16.16.16.16.14.14.1.3.cmml" xref="S3.E7.m1.16.16.16.16.14.14.1.3">𝑑</ci></apply></apply></apply><apply id="S3.E7.m1.30.30.1.1.10.cmml" xref="S3.E7.m1.31.31.2"><csymbol cd="ambiguous" id="S3.E7.m1.30.30.1.1.10.1.cmml" xref="S3.E7.m1.31.31.2.30.18.16.17">subscript</csymbol><ci id="S3.E7.m1.18.18.18.1.1.1.cmml" xref="S3.E7.m1.18.18.18.1.1.1">𝐿</ci><apply id="S3.E7.m1.19.19.19.2.2.2.1.cmml" xref="S3.E7.m1.19.19.19.2.2.2.1"><times id="S3.E7.m1.19.19.19.2.2.2.1.1.cmml" xref="S3.E7.m1.19.19.19.2.2.2.1.1"></times><ci id="S3.E7.m1.19.19.19.2.2.2.1.2.cmml" xref="S3.E7.m1.19.19.19.2.2.2.1.2">𝑖</ci><ci id="S3.E7.m1.19.19.19.2.2.2.1.3.cmml" xref="S3.E7.m1.19.19.19.2.2.2.1.3">𝑑</ci></apply></apply></apply></apply><apply id="S3.E7.m1.30.30.1c.cmml" xref="S3.E7.m1.31.31.2"><eq id="S3.E7.m1.20.20.20.3.1.1.cmml" xref="S3.E7.m1.20.20.20.3.1.1"></eq><share href="https://arxiv.org/html/2405.17959v1#S3.E7.m1.30.30.1.1.cmml" id="S3.E7.m1.30.30.1d.cmml" xref="S3.E7.m1.31.31.2.30.18.16.17"></share><apply id="S3.E7.m1.30.30.1.6.cmml" xref="S3.E7.m1.31.31.2"><minus id="S3.E7.m1.21.21.21.4.2.2.cmml" xref="S3.E7.m1.31.31.2"></minus><apply id="S3.E7.m1.30.30.1.6.2.cmml" xref="S3.E7.m1.31.31.2"><apply id="S3.E7.m1.30.30.1.6.2.1.cmml" xref="S3.E7.m1.31.31.2"><csymbol cd="ambiguous" id="S3.E7.m1.30.30.1.6.2.1.1.cmml" xref="S3.E7.m1.31.31.2.30.18.16.17">superscript</csymbol><apply id="S3.E7.m1.30.30.1.6.2.1.2.cmml" xref="S3.E7.m1.31.31.2"><csymbol cd="ambiguous" id="S3.E7.m1.30.30.1.6.2.1.2.1.cmml" xref="S3.E7.m1.31.31.2.30.18.16.17">subscript</csymbol><sum id="S3.E7.m1.22.22.22.5.3.3.cmml" xref="S3.E7.m1.22.22.22.5.3.3"></sum><apply id="S3.E7.m1.23.23.23.6.4.4.1.cmml" xref="S3.E7.m1.23.23.23.6.4.4.1"><eq id="S3.E7.m1.23.23.23.6.4.4.1.1.cmml" xref="S3.E7.m1.23.23.23.6.4.4.1.1"></eq><ci id="S3.E7.m1.23.23.23.6.4.4.1.2.cmml" xref="S3.E7.m1.23.23.23.6.4.4.1.2">𝑖</ci><cn id="S3.E7.m1.23.23.23.6.4.4.1.3.cmml" type="integer" xref="S3.E7.m1.23.23.23.6.4.4.1.3">1</cn></apply></apply><apply id="S3.E7.m1.24.24.24.7.5.5.1.2.cmml" xref="S3.E7.m1.24.24.24.7.5.5.1.3"><abs id="S3.E7.m1.24.24.24.7.5.5.1.2.1.cmml" xref="S3.E7.m1.24.24.24.7.5.5.1.3.1"></abs><ci id="S3.E7.m1.24.24.24.7.5.5.1.1.cmml" xref="S3.E7.m1.24.24.24.7.5.5.1.1">𝑙</ci></apply></apply><apply id="S3.E7.m1.30.30.1.6.2.2.cmml" xref="S3.E7.m1.31.31.2"><times id="S3.E7.m1.30.30.1.6.2.2.1.cmml" xref="S3.E7.m1.31.31.2.30.18.16.17"></times><apply id="S3.E7.m1.30.30.1.6.2.2.2.cmml" xref="S3.E7.m1.31.31.2"><csymbol cd="ambiguous" id="S3.E7.m1.30.30.1.6.2.2.2.1.cmml" xref="S3.E7.m1.31.31.2.30.18.16.17">subscript</csymbol><ci id="S3.E7.m1.25.25.25.8.6.6.cmml" xref="S3.E7.m1.25.25.25.8.6.6">𝑖</ci><apply id="S3.E7.m1.26.26.26.9.7.7.1.cmml" xref="S3.E7.m1.26.26.26.9.7.7.1"><plus id="S3.E7.m1.26.26.26.9.7.7.1.1.cmml" xref="S3.E7.m1.26.26.26.9.7.7.1.1"></plus><ci id="S3.E7.m1.26.26.26.9.7.7.1.2.cmml" xref="S3.E7.m1.26.26.26.9.7.7.1.2">𝑛</ci><cn id="S3.E7.m1.26.26.26.9.7.7.1.3.cmml" type="integer" xref="S3.E7.m1.26.26.26.9.7.7.1.3">1</cn></apply></apply><apply id="S3.E7.m1.30.30.1.6.2.2.3.cmml" xref="S3.E7.m1.31.31.2"><log id="S3.E7.m1.27.27.27.10.8.8.cmml" xref="S3.E7.m1.27.27.27.10.8.8"></log><apply id="S3.E7.m1.30.30.1.6.2.2.3.2.cmml" xref="S3.E7.m1.31.31.2"><csymbol cd="ambiguous" id="S3.E7.m1.30.30.1.6.2.2.3.2.1.cmml" xref="S3.E7.m1.31.31.2.30.18.16.17">subscript</csymbol><apply id="S3.E7.m1.28.28.28.11.9.9.cmml" xref="S3.E7.m1.28.28.28.11.9.9"><ci id="S3.E7.m1.28.28.28.11.9.9.1.cmml" xref="S3.E7.m1.28.28.28.11.9.9.1">^</ci><ci id="S3.E7.m1.28.28.28.11.9.9.2.cmml" xref="S3.E7.m1.28.28.28.11.9.9.2">𝑖</ci></apply><apply id="S3.E7.m1.29.29.29.12.10.10.1.cmml" xref="S3.E7.m1.29.29.29.12.10.10.1"><plus id="S3.E7.m1.29.29.29.12.10.10.1.1.cmml" xref="S3.E7.m1.29.29.29.12.10.10.1.1"></plus><ci id="S3.E7.m1.29.29.29.12.10.10.1.2.cmml" xref="S3.E7.m1.29.29.29.12.10.10.1.2">𝑛</ci><cn id="S3.E7.m1.29.29.29.12.10.10.1.3.cmml" type="integer" xref="S3.E7.m1.29.29.29.12.10.10.1.3">1</cn></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.31c">\begin{split}\hat{i}_{n+1}&amp;=softmax(R_{n}^{L}M_{id})\\
L_{id}&amp;=-\sum_{i=1}^{|l|}i_{n+1}\log\hat{i}_{n+1}\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.31d">start_ROW start_CELL over^ start_ARG italic_i end_ARG start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT end_CELL start_CELL = italic_s italic_o italic_f italic_t italic_m italic_a italic_x ( italic_R start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT italic_M start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL italic_L start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT end_CELL start_CELL = - ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_l | end_POSTSUPERSCRIPT italic_i start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT roman_log over^ start_ARG italic_i end_ARG start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.8">Furthermore, the use of multi-task learning can improve the generalization of the model and obtain more diverse informations from multimodal data <cite class="ltx_cite ltx_citemacro_citep">(Han et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib4" title="">2021</a>)</cite>.
For images and text in multimodal data, the reconstruction loss function can be used to compute the difference between the original representation <math alttext="v_{n+1},t_{n+1}" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.2"><semantics id="S3.SS4.p2.1.m1.2a"><mrow id="S3.SS4.p2.1.m1.2.2.2" xref="S3.SS4.p2.1.m1.2.2.3.cmml"><msub id="S3.SS4.p2.1.m1.1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.1.cmml"><mi id="S3.SS4.p2.1.m1.1.1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.1.1.2.cmml">v</mi><mrow id="S3.SS4.p2.1.m1.1.1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.1.1.3.cmml"><mi id="S3.SS4.p2.1.m1.1.1.1.1.3.2" xref="S3.SS4.p2.1.m1.1.1.1.1.3.2.cmml">n</mi><mo id="S3.SS4.p2.1.m1.1.1.1.1.3.1" xref="S3.SS4.p2.1.m1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.SS4.p2.1.m1.1.1.1.1.3.3" xref="S3.SS4.p2.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS4.p2.1.m1.2.2.2.3" xref="S3.SS4.p2.1.m1.2.2.3.cmml">,</mo><msub id="S3.SS4.p2.1.m1.2.2.2.2" xref="S3.SS4.p2.1.m1.2.2.2.2.cmml"><mi id="S3.SS4.p2.1.m1.2.2.2.2.2" xref="S3.SS4.p2.1.m1.2.2.2.2.2.cmml">t</mi><mrow id="S3.SS4.p2.1.m1.2.2.2.2.3" xref="S3.SS4.p2.1.m1.2.2.2.2.3.cmml"><mi id="S3.SS4.p2.1.m1.2.2.2.2.3.2" xref="S3.SS4.p2.1.m1.2.2.2.2.3.2.cmml">n</mi><mo id="S3.SS4.p2.1.m1.2.2.2.2.3.1" xref="S3.SS4.p2.1.m1.2.2.2.2.3.1.cmml">+</mo><mn id="S3.SS4.p2.1.m1.2.2.2.2.3.3" xref="S3.SS4.p2.1.m1.2.2.2.2.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.2b"><list id="S3.SS4.p2.1.m1.2.2.3.cmml" xref="S3.SS4.p2.1.m1.2.2.2"><apply id="S3.SS4.p2.1.m1.1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.2">𝑣</ci><apply id="S3.SS4.p2.1.m1.1.1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.3"><plus id="S3.SS4.p2.1.m1.1.1.1.1.3.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.3.1"></plus><ci id="S3.SS4.p2.1.m1.1.1.1.1.3.2.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.3.2">𝑛</ci><cn id="S3.SS4.p2.1.m1.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS4.p2.1.m1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS4.p2.1.m1.2.2.2.2.cmml" xref="S3.SS4.p2.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.2.2.2.2.1.cmml" xref="S3.SS4.p2.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p2.1.m1.2.2.2.2.2.cmml" xref="S3.SS4.p2.1.m1.2.2.2.2.2">𝑡</ci><apply id="S3.SS4.p2.1.m1.2.2.2.2.3.cmml" xref="S3.SS4.p2.1.m1.2.2.2.2.3"><plus id="S3.SS4.p2.1.m1.2.2.2.2.3.1.cmml" xref="S3.SS4.p2.1.m1.2.2.2.2.3.1"></plus><ci id="S3.SS4.p2.1.m1.2.2.2.2.3.2.cmml" xref="S3.SS4.p2.1.m1.2.2.2.2.3.2">𝑛</ci><cn id="S3.SS4.p2.1.m1.2.2.2.2.3.3.cmml" type="integer" xref="S3.SS4.p2.1.m1.2.2.2.2.3.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.2c">v_{n+1},t_{n+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.1.m1.2d">italic_v start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT</annotation></semantics></math> and the representation output from the attention fusion module <math alttext="\hat{v}_{n+1},\hat{t}_{n+1}" class="ltx_Math" display="inline" id="S3.SS4.p2.2.m2.2"><semantics id="S3.SS4.p2.2.m2.2a"><mrow id="S3.SS4.p2.2.m2.2.2.2" xref="S3.SS4.p2.2.m2.2.2.3.cmml"><msub id="S3.SS4.p2.2.m2.1.1.1.1" xref="S3.SS4.p2.2.m2.1.1.1.1.cmml"><mover accent="true" id="S3.SS4.p2.2.m2.1.1.1.1.2" xref="S3.SS4.p2.2.m2.1.1.1.1.2.cmml"><mi id="S3.SS4.p2.2.m2.1.1.1.1.2.2" xref="S3.SS4.p2.2.m2.1.1.1.1.2.2.cmml">v</mi><mo id="S3.SS4.p2.2.m2.1.1.1.1.2.1" xref="S3.SS4.p2.2.m2.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS4.p2.2.m2.1.1.1.1.3" xref="S3.SS4.p2.2.m2.1.1.1.1.3.cmml"><mi id="S3.SS4.p2.2.m2.1.1.1.1.3.2" xref="S3.SS4.p2.2.m2.1.1.1.1.3.2.cmml">n</mi><mo id="S3.SS4.p2.2.m2.1.1.1.1.3.1" xref="S3.SS4.p2.2.m2.1.1.1.1.3.1.cmml">+</mo><mn id="S3.SS4.p2.2.m2.1.1.1.1.3.3" xref="S3.SS4.p2.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS4.p2.2.m2.2.2.2.3" xref="S3.SS4.p2.2.m2.2.2.3.cmml">,</mo><msub id="S3.SS4.p2.2.m2.2.2.2.2" xref="S3.SS4.p2.2.m2.2.2.2.2.cmml"><mover accent="true" id="S3.SS4.p2.2.m2.2.2.2.2.2" xref="S3.SS4.p2.2.m2.2.2.2.2.2.cmml"><mi id="S3.SS4.p2.2.m2.2.2.2.2.2.2" xref="S3.SS4.p2.2.m2.2.2.2.2.2.2.cmml">t</mi><mo id="S3.SS4.p2.2.m2.2.2.2.2.2.1" xref="S3.SS4.p2.2.m2.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="S3.SS4.p2.2.m2.2.2.2.2.3" xref="S3.SS4.p2.2.m2.2.2.2.2.3.cmml"><mi id="S3.SS4.p2.2.m2.2.2.2.2.3.2" xref="S3.SS4.p2.2.m2.2.2.2.2.3.2.cmml">n</mi><mo id="S3.SS4.p2.2.m2.2.2.2.2.3.1" xref="S3.SS4.p2.2.m2.2.2.2.2.3.1.cmml">+</mo><mn id="S3.SS4.p2.2.m2.2.2.2.2.3.3" xref="S3.SS4.p2.2.m2.2.2.2.2.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.2b"><list id="S3.SS4.p2.2.m2.2.2.3.cmml" xref="S3.SS4.p2.2.m2.2.2.2"><apply id="S3.SS4.p2.2.m2.1.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1">subscript</csymbol><apply id="S3.SS4.p2.2.m2.1.1.1.1.2.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1.2"><ci id="S3.SS4.p2.2.m2.1.1.1.1.2.1.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1.2.1">^</ci><ci id="S3.SS4.p2.2.m2.1.1.1.1.2.2.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1.2.2">𝑣</ci></apply><apply id="S3.SS4.p2.2.m2.1.1.1.1.3.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1.3"><plus id="S3.SS4.p2.2.m2.1.1.1.1.3.1.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1.3.1"></plus><ci id="S3.SS4.p2.2.m2.1.1.1.1.3.2.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1.3.2">𝑛</ci><cn id="S3.SS4.p2.2.m2.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS4.p2.2.m2.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS4.p2.2.m2.2.2.2.2.cmml" xref="S3.SS4.p2.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.2.2.2.2.1.cmml" xref="S3.SS4.p2.2.m2.2.2.2.2">subscript</csymbol><apply id="S3.SS4.p2.2.m2.2.2.2.2.2.cmml" xref="S3.SS4.p2.2.m2.2.2.2.2.2"><ci id="S3.SS4.p2.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS4.p2.2.m2.2.2.2.2.2.1">^</ci><ci id="S3.SS4.p2.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS4.p2.2.m2.2.2.2.2.2.2">𝑡</ci></apply><apply id="S3.SS4.p2.2.m2.2.2.2.2.3.cmml" xref="S3.SS4.p2.2.m2.2.2.2.2.3"><plus id="S3.SS4.p2.2.m2.2.2.2.2.3.1.cmml" xref="S3.SS4.p2.2.m2.2.2.2.2.3.1"></plus><ci id="S3.SS4.p2.2.m2.2.2.2.2.3.2.cmml" xref="S3.SS4.p2.2.m2.2.2.2.2.3.2">𝑛</ci><cn id="S3.SS4.p2.2.m2.2.2.2.2.3.3.cmml" type="integer" xref="S3.SS4.p2.2.m2.2.2.2.2.3.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.2c">\hat{v}_{n+1},\hat{t}_{n+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.2.m2.2d">over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT , over^ start_ARG italic_t end_ARG start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT</annotation></semantics></math>, as shown in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S3.E8" title="Equation 8 ‣ 3.4 Prediction module ‣ 3 Proposed method ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">8</span></a>.
<math alttext="W_{v}^{\prime}\in\mathbb{R}^{d\times d_{v}}" class="ltx_Math" display="inline" id="S3.SS4.p2.3.m3.1"><semantics id="S3.SS4.p2.3.m3.1a"><mrow id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml"><msubsup id="S3.SS4.p2.3.m3.1.1.2" xref="S3.SS4.p2.3.m3.1.1.2.cmml"><mi id="S3.SS4.p2.3.m3.1.1.2.2.2" xref="S3.SS4.p2.3.m3.1.1.2.2.2.cmml">W</mi><mi id="S3.SS4.p2.3.m3.1.1.2.2.3" xref="S3.SS4.p2.3.m3.1.1.2.2.3.cmml">v</mi><mo id="S3.SS4.p2.3.m3.1.1.2.3" xref="S3.SS4.p2.3.m3.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.SS4.p2.3.m3.1.1.1" xref="S3.SS4.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS4.p2.3.m3.1.1.3" xref="S3.SS4.p2.3.m3.1.1.3.cmml"><mi id="S3.SS4.p2.3.m3.1.1.3.2" xref="S3.SS4.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p2.3.m3.1.1.3.3" xref="S3.SS4.p2.3.m3.1.1.3.3.cmml"><mi id="S3.SS4.p2.3.m3.1.1.3.3.2" xref="S3.SS4.p2.3.m3.1.1.3.3.2.cmml">d</mi><mo id="S3.SS4.p2.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p2.3.m3.1.1.3.3.1.cmml">×</mo><msub id="S3.SS4.p2.3.m3.1.1.3.3.3" xref="S3.SS4.p2.3.m3.1.1.3.3.3.cmml"><mi id="S3.SS4.p2.3.m3.1.1.3.3.3.2" xref="S3.SS4.p2.3.m3.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS4.p2.3.m3.1.1.3.3.3.3" xref="S3.SS4.p2.3.m3.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.1b"><apply id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1"><in id="S3.SS4.p2.3.m3.1.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1.1"></in><apply id="S3.SS4.p2.3.m3.1.1.2.cmml" xref="S3.SS4.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.1.1.2.1.cmml" xref="S3.SS4.p2.3.m3.1.1.2">superscript</csymbol><apply id="S3.SS4.p2.3.m3.1.1.2.2.cmml" xref="S3.SS4.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.1.1.2.2.1.cmml" xref="S3.SS4.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS4.p2.3.m3.1.1.2.2.2.cmml" xref="S3.SS4.p2.3.m3.1.1.2.2.2">𝑊</ci><ci id="S3.SS4.p2.3.m3.1.1.2.2.3.cmml" xref="S3.SS4.p2.3.m3.1.1.2.2.3">𝑣</ci></apply><ci id="S3.SS4.p2.3.m3.1.1.2.3.cmml" xref="S3.SS4.p2.3.m3.1.1.2.3">′</ci></apply><apply id="S3.SS4.p2.3.m3.1.1.3.cmml" xref="S3.SS4.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.1.1.3.1.cmml" xref="S3.SS4.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS4.p2.3.m3.1.1.3.2.cmml" xref="S3.SS4.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS4.p2.3.m3.1.1.3.3.cmml" xref="S3.SS4.p2.3.m3.1.1.3.3"><times id="S3.SS4.p2.3.m3.1.1.3.3.1.cmml" xref="S3.SS4.p2.3.m3.1.1.3.3.1"></times><ci id="S3.SS4.p2.3.m3.1.1.3.3.2.cmml" xref="S3.SS4.p2.3.m3.1.1.3.3.2">𝑑</ci><apply id="S3.SS4.p2.3.m3.1.1.3.3.3.cmml" xref="S3.SS4.p2.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.1.1.3.3.3.1.cmml" xref="S3.SS4.p2.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS4.p2.3.m3.1.1.3.3.3.2.cmml" xref="S3.SS4.p2.3.m3.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS4.p2.3.m3.1.1.3.3.3.3.cmml" xref="S3.SS4.p2.3.m3.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.1c">W_{v}^{\prime}\in\mathbb{R}^{d\times d_{v}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.3.m3.1d">italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="b_{v}^{\prime}\in\mathbb{R}^{1\times d_{v}}" class="ltx_Math" display="inline" id="S3.SS4.p2.4.m4.1"><semantics id="S3.SS4.p2.4.m4.1a"><mrow id="S3.SS4.p2.4.m4.1.1" xref="S3.SS4.p2.4.m4.1.1.cmml"><msubsup id="S3.SS4.p2.4.m4.1.1.2" xref="S3.SS4.p2.4.m4.1.1.2.cmml"><mi id="S3.SS4.p2.4.m4.1.1.2.2.2" xref="S3.SS4.p2.4.m4.1.1.2.2.2.cmml">b</mi><mi id="S3.SS4.p2.4.m4.1.1.2.2.3" xref="S3.SS4.p2.4.m4.1.1.2.2.3.cmml">v</mi><mo id="S3.SS4.p2.4.m4.1.1.2.3" xref="S3.SS4.p2.4.m4.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.SS4.p2.4.m4.1.1.1" xref="S3.SS4.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS4.p2.4.m4.1.1.3" xref="S3.SS4.p2.4.m4.1.1.3.cmml"><mi id="S3.SS4.p2.4.m4.1.1.3.2" xref="S3.SS4.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p2.4.m4.1.1.3.3" xref="S3.SS4.p2.4.m4.1.1.3.3.cmml"><mn id="S3.SS4.p2.4.m4.1.1.3.3.2" xref="S3.SS4.p2.4.m4.1.1.3.3.2.cmml">1</mn><mo id="S3.SS4.p2.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p2.4.m4.1.1.3.3.1.cmml">×</mo><msub id="S3.SS4.p2.4.m4.1.1.3.3.3" xref="S3.SS4.p2.4.m4.1.1.3.3.3.cmml"><mi id="S3.SS4.p2.4.m4.1.1.3.3.3.2" xref="S3.SS4.p2.4.m4.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS4.p2.4.m4.1.1.3.3.3.3" xref="S3.SS4.p2.4.m4.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.1b"><apply id="S3.SS4.p2.4.m4.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1"><in id="S3.SS4.p2.4.m4.1.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1.1"></in><apply id="S3.SS4.p2.4.m4.1.1.2.cmml" xref="S3.SS4.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m4.1.1.2.1.cmml" xref="S3.SS4.p2.4.m4.1.1.2">superscript</csymbol><apply id="S3.SS4.p2.4.m4.1.1.2.2.cmml" xref="S3.SS4.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m4.1.1.2.2.1.cmml" xref="S3.SS4.p2.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS4.p2.4.m4.1.1.2.2.2.cmml" xref="S3.SS4.p2.4.m4.1.1.2.2.2">𝑏</ci><ci id="S3.SS4.p2.4.m4.1.1.2.2.3.cmml" xref="S3.SS4.p2.4.m4.1.1.2.2.3">𝑣</ci></apply><ci id="S3.SS4.p2.4.m4.1.1.2.3.cmml" xref="S3.SS4.p2.4.m4.1.1.2.3">′</ci></apply><apply id="S3.SS4.p2.4.m4.1.1.3.cmml" xref="S3.SS4.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m4.1.1.3.1.cmml" xref="S3.SS4.p2.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS4.p2.4.m4.1.1.3.2.cmml" xref="S3.SS4.p2.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS4.p2.4.m4.1.1.3.3.cmml" xref="S3.SS4.p2.4.m4.1.1.3.3"><times id="S3.SS4.p2.4.m4.1.1.3.3.1.cmml" xref="S3.SS4.p2.4.m4.1.1.3.3.1"></times><cn id="S3.SS4.p2.4.m4.1.1.3.3.2.cmml" type="integer" xref="S3.SS4.p2.4.m4.1.1.3.3.2">1</cn><apply id="S3.SS4.p2.4.m4.1.1.3.3.3.cmml" xref="S3.SS4.p2.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m4.1.1.3.3.3.1.cmml" xref="S3.SS4.p2.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S3.SS4.p2.4.m4.1.1.3.3.3.2.cmml" xref="S3.SS4.p2.4.m4.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS4.p2.4.m4.1.1.3.3.3.3.cmml" xref="S3.SS4.p2.4.m4.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.1c">b_{v}^{\prime}\in\mathbb{R}^{1\times d_{v}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.4.m4.1d">italic_b start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 1 × italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="W_{t}^{\prime}\in\mathbb{R}^{d\times d_{t}}" class="ltx_Math" display="inline" id="S3.SS4.p2.5.m5.1"><semantics id="S3.SS4.p2.5.m5.1a"><mrow id="S3.SS4.p2.5.m5.1.1" xref="S3.SS4.p2.5.m5.1.1.cmml"><msubsup id="S3.SS4.p2.5.m5.1.1.2" xref="S3.SS4.p2.5.m5.1.1.2.cmml"><mi id="S3.SS4.p2.5.m5.1.1.2.2.2" xref="S3.SS4.p2.5.m5.1.1.2.2.2.cmml">W</mi><mi id="S3.SS4.p2.5.m5.1.1.2.2.3" xref="S3.SS4.p2.5.m5.1.1.2.2.3.cmml">t</mi><mo id="S3.SS4.p2.5.m5.1.1.2.3" xref="S3.SS4.p2.5.m5.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.SS4.p2.5.m5.1.1.1" xref="S3.SS4.p2.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS4.p2.5.m5.1.1.3" xref="S3.SS4.p2.5.m5.1.1.3.cmml"><mi id="S3.SS4.p2.5.m5.1.1.3.2" xref="S3.SS4.p2.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p2.5.m5.1.1.3.3" xref="S3.SS4.p2.5.m5.1.1.3.3.cmml"><mi id="S3.SS4.p2.5.m5.1.1.3.3.2" xref="S3.SS4.p2.5.m5.1.1.3.3.2.cmml">d</mi><mo id="S3.SS4.p2.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p2.5.m5.1.1.3.3.1.cmml">×</mo><msub id="S3.SS4.p2.5.m5.1.1.3.3.3" xref="S3.SS4.p2.5.m5.1.1.3.3.3.cmml"><mi id="S3.SS4.p2.5.m5.1.1.3.3.3.2" xref="S3.SS4.p2.5.m5.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS4.p2.5.m5.1.1.3.3.3.3" xref="S3.SS4.p2.5.m5.1.1.3.3.3.3.cmml">t</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.5.m5.1b"><apply id="S3.SS4.p2.5.m5.1.1.cmml" xref="S3.SS4.p2.5.m5.1.1"><in id="S3.SS4.p2.5.m5.1.1.1.cmml" xref="S3.SS4.p2.5.m5.1.1.1"></in><apply id="S3.SS4.p2.5.m5.1.1.2.cmml" xref="S3.SS4.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m5.1.1.2.1.cmml" xref="S3.SS4.p2.5.m5.1.1.2">superscript</csymbol><apply id="S3.SS4.p2.5.m5.1.1.2.2.cmml" xref="S3.SS4.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m5.1.1.2.2.1.cmml" xref="S3.SS4.p2.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS4.p2.5.m5.1.1.2.2.2.cmml" xref="S3.SS4.p2.5.m5.1.1.2.2.2">𝑊</ci><ci id="S3.SS4.p2.5.m5.1.1.2.2.3.cmml" xref="S3.SS4.p2.5.m5.1.1.2.2.3">𝑡</ci></apply><ci id="S3.SS4.p2.5.m5.1.1.2.3.cmml" xref="S3.SS4.p2.5.m5.1.1.2.3">′</ci></apply><apply id="S3.SS4.p2.5.m5.1.1.3.cmml" xref="S3.SS4.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m5.1.1.3.1.cmml" xref="S3.SS4.p2.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS4.p2.5.m5.1.1.3.2.cmml" xref="S3.SS4.p2.5.m5.1.1.3.2">ℝ</ci><apply id="S3.SS4.p2.5.m5.1.1.3.3.cmml" xref="S3.SS4.p2.5.m5.1.1.3.3"><times id="S3.SS4.p2.5.m5.1.1.3.3.1.cmml" xref="S3.SS4.p2.5.m5.1.1.3.3.1"></times><ci id="S3.SS4.p2.5.m5.1.1.3.3.2.cmml" xref="S3.SS4.p2.5.m5.1.1.3.3.2">𝑑</ci><apply id="S3.SS4.p2.5.m5.1.1.3.3.3.cmml" xref="S3.SS4.p2.5.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m5.1.1.3.3.3.1.cmml" xref="S3.SS4.p2.5.m5.1.1.3.3.3">subscript</csymbol><ci id="S3.SS4.p2.5.m5.1.1.3.3.3.2.cmml" xref="S3.SS4.p2.5.m5.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS4.p2.5.m5.1.1.3.3.3.3.cmml" xref="S3.SS4.p2.5.m5.1.1.3.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.5.m5.1c">W_{t}^{\prime}\in\mathbb{R}^{d\times d_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.5.m5.1d">italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="b_{t}^{\prime}\in\mathbb{R}^{1\times d_{t}}" class="ltx_Math" display="inline" id="S3.SS4.p2.6.m6.1"><semantics id="S3.SS4.p2.6.m6.1a"><mrow id="S3.SS4.p2.6.m6.1.1" xref="S3.SS4.p2.6.m6.1.1.cmml"><msubsup id="S3.SS4.p2.6.m6.1.1.2" xref="S3.SS4.p2.6.m6.1.1.2.cmml"><mi id="S3.SS4.p2.6.m6.1.1.2.2.2" xref="S3.SS4.p2.6.m6.1.1.2.2.2.cmml">b</mi><mi id="S3.SS4.p2.6.m6.1.1.2.2.3" xref="S3.SS4.p2.6.m6.1.1.2.2.3.cmml">t</mi><mo id="S3.SS4.p2.6.m6.1.1.2.3" xref="S3.SS4.p2.6.m6.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.SS4.p2.6.m6.1.1.1" xref="S3.SS4.p2.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS4.p2.6.m6.1.1.3" xref="S3.SS4.p2.6.m6.1.1.3.cmml"><mi id="S3.SS4.p2.6.m6.1.1.3.2" xref="S3.SS4.p2.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p2.6.m6.1.1.3.3" xref="S3.SS4.p2.6.m6.1.1.3.3.cmml"><mn id="S3.SS4.p2.6.m6.1.1.3.3.2" xref="S3.SS4.p2.6.m6.1.1.3.3.2.cmml">1</mn><mo id="S3.SS4.p2.6.m6.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p2.6.m6.1.1.3.3.1.cmml">×</mo><msub id="S3.SS4.p2.6.m6.1.1.3.3.3" xref="S3.SS4.p2.6.m6.1.1.3.3.3.cmml"><mi id="S3.SS4.p2.6.m6.1.1.3.3.3.2" xref="S3.SS4.p2.6.m6.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS4.p2.6.m6.1.1.3.3.3.3" xref="S3.SS4.p2.6.m6.1.1.3.3.3.3.cmml">t</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.6.m6.1b"><apply id="S3.SS4.p2.6.m6.1.1.cmml" xref="S3.SS4.p2.6.m6.1.1"><in id="S3.SS4.p2.6.m6.1.1.1.cmml" xref="S3.SS4.p2.6.m6.1.1.1"></in><apply id="S3.SS4.p2.6.m6.1.1.2.cmml" xref="S3.SS4.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.1.1.2.1.cmml" xref="S3.SS4.p2.6.m6.1.1.2">superscript</csymbol><apply id="S3.SS4.p2.6.m6.1.1.2.2.cmml" xref="S3.SS4.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.1.1.2.2.1.cmml" xref="S3.SS4.p2.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS4.p2.6.m6.1.1.2.2.2.cmml" xref="S3.SS4.p2.6.m6.1.1.2.2.2">𝑏</ci><ci id="S3.SS4.p2.6.m6.1.1.2.2.3.cmml" xref="S3.SS4.p2.6.m6.1.1.2.2.3">𝑡</ci></apply><ci id="S3.SS4.p2.6.m6.1.1.2.3.cmml" xref="S3.SS4.p2.6.m6.1.1.2.3">′</ci></apply><apply id="S3.SS4.p2.6.m6.1.1.3.cmml" xref="S3.SS4.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.1.1.3.1.cmml" xref="S3.SS4.p2.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS4.p2.6.m6.1.1.3.2.cmml" xref="S3.SS4.p2.6.m6.1.1.3.2">ℝ</ci><apply id="S3.SS4.p2.6.m6.1.1.3.3.cmml" xref="S3.SS4.p2.6.m6.1.1.3.3"><times id="S3.SS4.p2.6.m6.1.1.3.3.1.cmml" xref="S3.SS4.p2.6.m6.1.1.3.3.1"></times><cn id="S3.SS4.p2.6.m6.1.1.3.3.2.cmml" type="integer" xref="S3.SS4.p2.6.m6.1.1.3.3.2">1</cn><apply id="S3.SS4.p2.6.m6.1.1.3.3.3.cmml" xref="S3.SS4.p2.6.m6.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.1.1.3.3.3.1.cmml" xref="S3.SS4.p2.6.m6.1.1.3.3.3">subscript</csymbol><ci id="S3.SS4.p2.6.m6.1.1.3.3.3.2.cmml" xref="S3.SS4.p2.6.m6.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS4.p2.6.m6.1.1.3.3.3.3.cmml" xref="S3.SS4.p2.6.m6.1.1.3.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.6.m6.1c">b_{t}^{\prime}\in\mathbb{R}^{1\times d_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.6.m6.1d">italic_b start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 1 × italic_d start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> are learnable parameters that aim to remove noise generated through layers and enhance the representations of image and text data <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib1" title="">2012</a>)</cite>.
<math alttext="|V|" class="ltx_Math" display="inline" id="S3.SS4.p2.7.m7.1"><semantics id="S3.SS4.p2.7.m7.1a"><mrow id="S3.SS4.p2.7.m7.1.2.2" xref="S3.SS4.p2.7.m7.1.2.1.cmml"><mo id="S3.SS4.p2.7.m7.1.2.2.1" stretchy="false" xref="S3.SS4.p2.7.m7.1.2.1.1.cmml">|</mo><mi id="S3.SS4.p2.7.m7.1.1" xref="S3.SS4.p2.7.m7.1.1.cmml">V</mi><mo id="S3.SS4.p2.7.m7.1.2.2.2" stretchy="false" xref="S3.SS4.p2.7.m7.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.7.m7.1b"><apply id="S3.SS4.p2.7.m7.1.2.1.cmml" xref="S3.SS4.p2.7.m7.1.2.2"><abs id="S3.SS4.p2.7.m7.1.2.1.1.cmml" xref="S3.SS4.p2.7.m7.1.2.2.1"></abs><ci id="S3.SS4.p2.7.m7.1.1.cmml" xref="S3.SS4.p2.7.m7.1.1">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.7.m7.1c">|V|</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.7.m7.1d">| italic_V |</annotation></semantics></math> and <math alttext="|T|" class="ltx_Math" display="inline" id="S3.SS4.p2.8.m8.1"><semantics id="S3.SS4.p2.8.m8.1a"><mrow id="S3.SS4.p2.8.m8.1.2.2" xref="S3.SS4.p2.8.m8.1.2.1.cmml"><mo id="S3.SS4.p2.8.m8.1.2.2.1" stretchy="false" xref="S3.SS4.p2.8.m8.1.2.1.1.cmml">|</mo><mi id="S3.SS4.p2.8.m8.1.1" xref="S3.SS4.p2.8.m8.1.1.cmml">T</mi><mo id="S3.SS4.p2.8.m8.1.2.2.2" stretchy="false" xref="S3.SS4.p2.8.m8.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.8.m8.1b"><apply id="S3.SS4.p2.8.m8.1.2.1.cmml" xref="S3.SS4.p2.8.m8.1.2.2"><abs id="S3.SS4.p2.8.m8.1.2.1.1.cmml" xref="S3.SS4.p2.8.m8.1.2.2.1"></abs><ci id="S3.SS4.p2.8.m8.1.1.cmml" xref="S3.SS4.p2.8.m8.1.1">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.8.m8.1c">|T|</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.8.m8.1d">| italic_T |</annotation></semantics></math> represent the total number of distinct images and the total number of distinct texts.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\begin{split}\hat{v}_{n+1}&amp;=R_{n}^{L}W^{\prime}_{v}+b_{v}^{\prime}\qquad L_{v}%
=\sum_{v=1}^{|V|}\left\|v_{n+1}-\hat{v}_{n+1}\right\|^{2}\\
\hat{t}_{n+1}&amp;=R_{n}^{L}W^{\prime}_{t}+b_{t}^{\prime}\qquad L_{t}=\sum_{t=1}^{%
|T|}\left\|t_{n+1}-\hat{t}_{n+1}\right\|^{2}\end{split}" class="ltx_Math" display="block" id="S3.E8.m1.60"><semantics id="S3.E8.m1.60a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E8.m1.60.60.6" rowspacing="0pt"><mtr id="S3.E8.m1.60.60.6a"><mtd class="ltx_align_right" columnalign="right" id="S3.E8.m1.60.60.6b"><msub id="S3.E8.m1.2.2.2.2.2"><mover accent="true" id="S3.E8.m1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.2.cmml">v</mi><mo id="S3.E8.m1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml">^</mo></mover><mrow id="S3.E8.m1.2.2.2.2.2.2.1" xref="S3.E8.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.E8.m1.2.2.2.2.2.2.1.2" xref="S3.E8.m1.2.2.2.2.2.2.1.2.cmml">n</mi><mo id="S3.E8.m1.2.2.2.2.2.2.1.1" xref="S3.E8.m1.2.2.2.2.2.2.1.1.cmml">+</mo><mn id="S3.E8.m1.2.2.2.2.2.2.1.3" xref="S3.E8.m1.2.2.2.2.2.2.1.3.cmml">1</mn></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E8.m1.60.60.6c"><mrow id="S3.E8.m1.58.58.4.56.29.27.27"><mrow id="S3.E8.m1.57.57.3.55.28.26.26.1"><mi id="S3.E8.m1.57.57.3.55.28.26.26.1.1" xref="S3.E8.m1.56.56.2.3.cmml"></mi><mo id="S3.E8.m1.3.3.3.3.1.1" xref="S3.E8.m1.3.3.3.3.1.1.cmml">=</mo><mrow id="S3.E8.m1.57.57.3.55.28.26.26.1.2"><mrow id="S3.E8.m1.57.57.3.55.28.26.26.1.2.1"><msubsup id="S3.E8.m1.57.57.3.55.28.26.26.1.2.1.2"><mi id="S3.E8.m1.4.4.4.4.2.2" xref="S3.E8.m1.4.4.4.4.2.2.cmml">R</mi><mi id="S3.E8.m1.5.5.5.5.3.3.1" xref="S3.E8.m1.5.5.5.5.3.3.1.cmml">n</mi><mi id="S3.E8.m1.6.6.6.6.4.4.1" xref="S3.E8.m1.6.6.6.6.4.4.1.cmml">L</mi></msubsup><mo id="S3.E8.m1.57.57.3.55.28.26.26.1.2.1.1" xref="S3.E8.m1.56.56.2.3.cmml">⁢</mo><msubsup id="S3.E8.m1.57.57.3.55.28.26.26.1.2.1.3"><mi id="S3.E8.m1.7.7.7.7.5.5" xref="S3.E8.m1.7.7.7.7.5.5.cmml">W</mi><mi id="S3.E8.m1.9.9.9.9.7.7.1" xref="S3.E8.m1.9.9.9.9.7.7.1.cmml">v</mi><mo id="S3.E8.m1.8.8.8.8.6.6.1" xref="S3.E8.m1.8.8.8.8.6.6.1.cmml">′</mo></msubsup></mrow><mo id="S3.E8.m1.10.10.10.10.8.8" xref="S3.E8.m1.10.10.10.10.8.8.cmml">+</mo><msubsup id="S3.E8.m1.57.57.3.55.28.26.26.1.2.2"><mi id="S3.E8.m1.11.11.11.11.9.9" xref="S3.E8.m1.11.11.11.11.9.9.cmml">b</mi><mi id="S3.E8.m1.12.12.12.12.10.10.1" xref="S3.E8.m1.12.12.12.12.10.10.1.cmml">v</mi><mo id="S3.E8.m1.13.13.13.13.11.11.1" xref="S3.E8.m1.13.13.13.13.11.11.1.cmml">′</mo></msubsup></mrow></mrow><mspace id="S3.E8.m1.58.58.4.56.29.27.27.3" width="2em" xref="S3.E8.m1.56.56.2.3.cmml"></mspace><mrow id="S3.E8.m1.58.58.4.56.29.27.27.2"><msub id="S3.E8.m1.58.58.4.56.29.27.27.2.2"><mi id="S3.E8.m1.14.14.14.14.12.12" xref="S3.E8.m1.14.14.14.14.12.12.cmml">L</mi><mi id="S3.E8.m1.15.15.15.15.13.13.1" xref="S3.E8.m1.15.15.15.15.13.13.1.cmml">v</mi></msub><mo id="S3.E8.m1.16.16.16.16.14.14" rspace="0.111em" xref="S3.E8.m1.16.16.16.16.14.14.cmml">=</mo><mrow id="S3.E8.m1.58.58.4.56.29.27.27.2.1"><munderover id="S3.E8.m1.58.58.4.56.29.27.27.2.1.2"><mo id="S3.E8.m1.17.17.17.17.15.15" movablelimits="false" rspace="0em" xref="S3.E8.m1.17.17.17.17.15.15.cmml">∑</mo><mrow id="S3.E8.m1.18.18.18.18.16.16.1" xref="S3.E8.m1.18.18.18.18.16.16.1.cmml"><mi id="S3.E8.m1.18.18.18.18.16.16.1.2" xref="S3.E8.m1.18.18.18.18.16.16.1.2.cmml">v</mi><mo id="S3.E8.m1.18.18.18.18.16.16.1.1" xref="S3.E8.m1.18.18.18.18.16.16.1.1.cmml">=</mo><mn id="S3.E8.m1.18.18.18.18.16.16.1.3" xref="S3.E8.m1.18.18.18.18.16.16.1.3.cmml">1</mn></mrow><mrow id="S3.E8.m1.19.19.19.19.17.17.1.3" xref="S3.E8.m1.19.19.19.19.17.17.1.2.cmml"><mo id="S3.E8.m1.19.19.19.19.17.17.1.3.1" stretchy="false" xref="S3.E8.m1.19.19.19.19.17.17.1.2.1.cmml">|</mo><mi id="S3.E8.m1.19.19.19.19.17.17.1.1" xref="S3.E8.m1.19.19.19.19.17.17.1.1.cmml">V</mi><mo id="S3.E8.m1.19.19.19.19.17.17.1.3.2" stretchy="false" xref="S3.E8.m1.19.19.19.19.17.17.1.2.1.cmml">|</mo></mrow></munderover><msup id="S3.E8.m1.58.58.4.56.29.27.27.2.1.1"><mrow id="S3.E8.m1.58.58.4.56.29.27.27.2.1.1.1.1"><mo id="S3.E8.m1.20.20.20.20.18.18" xref="S3.E8.m1.56.56.2.3.cmml">‖</mo><mrow id="S3.E8.m1.58.58.4.56.29.27.27.2.1.1.1.1.1"><msub id="S3.E8.m1.58.58.4.56.29.27.27.2.1.1.1.1.1.1"><mi id="S3.E8.m1.21.21.21.21.19.19" xref="S3.E8.m1.21.21.21.21.19.19.cmml">v</mi><mrow id="S3.E8.m1.22.22.22.22.20.20.1" xref="S3.E8.m1.22.22.22.22.20.20.1.cmml"><mi id="S3.E8.m1.22.22.22.22.20.20.1.2" xref="S3.E8.m1.22.22.22.22.20.20.1.2.cmml">n</mi><mo id="S3.E8.m1.22.22.22.22.20.20.1.1" xref="S3.E8.m1.22.22.22.22.20.20.1.1.cmml">+</mo><mn id="S3.E8.m1.22.22.22.22.20.20.1.3" xref="S3.E8.m1.22.22.22.22.20.20.1.3.cmml">1</mn></mrow></msub><mo id="S3.E8.m1.23.23.23.23.21.21" xref="S3.E8.m1.23.23.23.23.21.21.cmml">−</mo><msub id="S3.E8.m1.58.58.4.56.29.27.27.2.1.1.1.1.1.2"><mover accent="true" id="S3.E8.m1.24.24.24.24.22.22" xref="S3.E8.m1.24.24.24.24.22.22.cmml"><mi id="S3.E8.m1.24.24.24.24.22.22.2" xref="S3.E8.m1.24.24.24.24.22.22.2.cmml">v</mi><mo id="S3.E8.m1.24.24.24.24.22.22.1" xref="S3.E8.m1.24.24.24.24.22.22.1.cmml">^</mo></mover><mrow id="S3.E8.m1.25.25.25.25.23.23.1" xref="S3.E8.m1.25.25.25.25.23.23.1.cmml"><mi id="S3.E8.m1.25.25.25.25.23.23.1.2" xref="S3.E8.m1.25.25.25.25.23.23.1.2.cmml">n</mi><mo id="S3.E8.m1.25.25.25.25.23.23.1.1" xref="S3.E8.m1.25.25.25.25.23.23.1.1.cmml">+</mo><mn id="S3.E8.m1.25.25.25.25.23.23.1.3" xref="S3.E8.m1.25.25.25.25.23.23.1.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E8.m1.26.26.26.26.24.24" xref="S3.E8.m1.56.56.2.3.cmml">‖</mo></mrow><mn id="S3.E8.m1.27.27.27.27.25.25.1" xref="S3.E8.m1.27.27.27.27.25.25.1.cmml">2</mn></msup></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E8.m1.60.60.6d"><mtd class="ltx_align_right" columnalign="right" id="S3.E8.m1.60.60.6e"><msub id="S3.E8.m1.29.29.29.2.2"><mover accent="true" id="S3.E8.m1.28.28.28.1.1.1" xref="S3.E8.m1.28.28.28.1.1.1.cmml"><mi id="S3.E8.m1.28.28.28.1.1.1.2" xref="S3.E8.m1.28.28.28.1.1.1.2.cmml">t</mi><mo id="S3.E8.m1.28.28.28.1.1.1.1" xref="S3.E8.m1.28.28.28.1.1.1.1.cmml">^</mo></mover><mrow id="S3.E8.m1.29.29.29.2.2.2.1" xref="S3.E8.m1.29.29.29.2.2.2.1.cmml"><mi id="S3.E8.m1.29.29.29.2.2.2.1.2" xref="S3.E8.m1.29.29.29.2.2.2.1.2.cmml">n</mi><mo id="S3.E8.m1.29.29.29.2.2.2.1.1" xref="S3.E8.m1.29.29.29.2.2.2.1.1.cmml">+</mo><mn id="S3.E8.m1.29.29.29.2.2.2.1.3" xref="S3.E8.m1.29.29.29.2.2.2.1.3.cmml">1</mn></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E8.m1.60.60.6f"><mrow id="S3.E8.m1.60.60.6.58.29.27.27"><mrow id="S3.E8.m1.59.59.5.57.28.26.26.1"><mi id="S3.E8.m1.59.59.5.57.28.26.26.1.1" xref="S3.E8.m1.56.56.2.3.cmml"></mi><mo id="S3.E8.m1.30.30.30.3.1.1" xref="S3.E8.m1.30.30.30.3.1.1.cmml">=</mo><mrow id="S3.E8.m1.59.59.5.57.28.26.26.1.2"><mrow id="S3.E8.m1.59.59.5.57.28.26.26.1.2.1"><msubsup id="S3.E8.m1.59.59.5.57.28.26.26.1.2.1.2"><mi id="S3.E8.m1.31.31.31.4.2.2" xref="S3.E8.m1.31.31.31.4.2.2.cmml">R</mi><mi id="S3.E8.m1.32.32.32.5.3.3.1" xref="S3.E8.m1.32.32.32.5.3.3.1.cmml">n</mi><mi id="S3.E8.m1.33.33.33.6.4.4.1" xref="S3.E8.m1.33.33.33.6.4.4.1.cmml">L</mi></msubsup><mo id="S3.E8.m1.59.59.5.57.28.26.26.1.2.1.1" xref="S3.E8.m1.56.56.2.3.cmml">⁢</mo><msubsup id="S3.E8.m1.59.59.5.57.28.26.26.1.2.1.3"><mi id="S3.E8.m1.34.34.34.7.5.5" xref="S3.E8.m1.34.34.34.7.5.5.cmml">W</mi><mi id="S3.E8.m1.36.36.36.9.7.7.1" xref="S3.E8.m1.36.36.36.9.7.7.1.cmml">t</mi><mo id="S3.E8.m1.35.35.35.8.6.6.1" xref="S3.E8.m1.35.35.35.8.6.6.1.cmml">′</mo></msubsup></mrow><mo id="S3.E8.m1.37.37.37.10.8.8" xref="S3.E8.m1.37.37.37.10.8.8.cmml">+</mo><msubsup id="S3.E8.m1.59.59.5.57.28.26.26.1.2.2"><mi id="S3.E8.m1.38.38.38.11.9.9" xref="S3.E8.m1.38.38.38.11.9.9.cmml">b</mi><mi id="S3.E8.m1.39.39.39.12.10.10.1" xref="S3.E8.m1.39.39.39.12.10.10.1.cmml">t</mi><mo id="S3.E8.m1.40.40.40.13.11.11.1" xref="S3.E8.m1.40.40.40.13.11.11.1.cmml">′</mo></msubsup></mrow></mrow><mspace id="S3.E8.m1.60.60.6.58.29.27.27.3" width="2em" xref="S3.E8.m1.56.56.2.3.cmml"></mspace><mrow id="S3.E8.m1.60.60.6.58.29.27.27.2"><msub id="S3.E8.m1.60.60.6.58.29.27.27.2.2"><mi id="S3.E8.m1.41.41.41.14.12.12" xref="S3.E8.m1.41.41.41.14.12.12.cmml">L</mi><mi id="S3.E8.m1.42.42.42.15.13.13.1" xref="S3.E8.m1.42.42.42.15.13.13.1.cmml">t</mi></msub><mo id="S3.E8.m1.43.43.43.16.14.14" rspace="0.111em" xref="S3.E8.m1.43.43.43.16.14.14.cmml">=</mo><mrow id="S3.E8.m1.60.60.6.58.29.27.27.2.1"><munderover id="S3.E8.m1.60.60.6.58.29.27.27.2.1.2"><mo id="S3.E8.m1.44.44.44.17.15.15" movablelimits="false" rspace="0em" xref="S3.E8.m1.44.44.44.17.15.15.cmml">∑</mo><mrow id="S3.E8.m1.45.45.45.18.16.16.1" xref="S3.E8.m1.45.45.45.18.16.16.1.cmml"><mi id="S3.E8.m1.45.45.45.18.16.16.1.2" xref="S3.E8.m1.45.45.45.18.16.16.1.2.cmml">t</mi><mo id="S3.E8.m1.45.45.45.18.16.16.1.1" xref="S3.E8.m1.45.45.45.18.16.16.1.1.cmml">=</mo><mn id="S3.E8.m1.45.45.45.18.16.16.1.3" xref="S3.E8.m1.45.45.45.18.16.16.1.3.cmml">1</mn></mrow><mrow id="S3.E8.m1.46.46.46.19.17.17.1.3" xref="S3.E8.m1.46.46.46.19.17.17.1.2.cmml"><mo id="S3.E8.m1.46.46.46.19.17.17.1.3.1" stretchy="false" xref="S3.E8.m1.46.46.46.19.17.17.1.2.1.cmml">|</mo><mi id="S3.E8.m1.46.46.46.19.17.17.1.1" xref="S3.E8.m1.46.46.46.19.17.17.1.1.cmml">T</mi><mo id="S3.E8.m1.46.46.46.19.17.17.1.3.2" stretchy="false" xref="S3.E8.m1.46.46.46.19.17.17.1.2.1.cmml">|</mo></mrow></munderover><msup id="S3.E8.m1.60.60.6.58.29.27.27.2.1.1"><mrow id="S3.E8.m1.60.60.6.58.29.27.27.2.1.1.1.1"><mo id="S3.E8.m1.47.47.47.20.18.18" xref="S3.E8.m1.56.56.2.3.cmml">‖</mo><mrow id="S3.E8.m1.60.60.6.58.29.27.27.2.1.1.1.1.1"><msub id="S3.E8.m1.60.60.6.58.29.27.27.2.1.1.1.1.1.1"><mi id="S3.E8.m1.48.48.48.21.19.19" xref="S3.E8.m1.48.48.48.21.19.19.cmml">t</mi><mrow id="S3.E8.m1.49.49.49.22.20.20.1" xref="S3.E8.m1.49.49.49.22.20.20.1.cmml"><mi id="S3.E8.m1.49.49.49.22.20.20.1.2" xref="S3.E8.m1.49.49.49.22.20.20.1.2.cmml">n</mi><mo id="S3.E8.m1.49.49.49.22.20.20.1.1" xref="S3.E8.m1.49.49.49.22.20.20.1.1.cmml">+</mo><mn id="S3.E8.m1.49.49.49.22.20.20.1.3" xref="S3.E8.m1.49.49.49.22.20.20.1.3.cmml">1</mn></mrow></msub><mo id="S3.E8.m1.50.50.50.23.21.21" xref="S3.E8.m1.50.50.50.23.21.21.cmml">−</mo><msub id="S3.E8.m1.60.60.6.58.29.27.27.2.1.1.1.1.1.2"><mover accent="true" id="S3.E8.m1.51.51.51.24.22.22" xref="S3.E8.m1.51.51.51.24.22.22.cmml"><mi id="S3.E8.m1.51.51.51.24.22.22.2" xref="S3.E8.m1.51.51.51.24.22.22.2.cmml">t</mi><mo id="S3.E8.m1.51.51.51.24.22.22.1" xref="S3.E8.m1.51.51.51.24.22.22.1.cmml">^</mo></mover><mrow id="S3.E8.m1.52.52.52.25.23.23.1" xref="S3.E8.m1.52.52.52.25.23.23.1.cmml"><mi id="S3.E8.m1.52.52.52.25.23.23.1.2" xref="S3.E8.m1.52.52.52.25.23.23.1.2.cmml">n</mi><mo id="S3.E8.m1.52.52.52.25.23.23.1.1" xref="S3.E8.m1.52.52.52.25.23.23.1.1.cmml">+</mo><mn id="S3.E8.m1.52.52.52.25.23.23.1.3" xref="S3.E8.m1.52.52.52.25.23.23.1.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E8.m1.53.53.53.26.24.24" xref="S3.E8.m1.56.56.2.3.cmml">‖</mo></mrow><mn id="S3.E8.m1.54.54.54.27.25.25.1" xref="S3.E8.m1.54.54.54.27.25.25.1.cmml">2</mn></msup></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E8.m1.60b"><apply id="S3.E8.m1.56.56.2.3.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.56.56.2.3a.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">formulae-sequence</csymbol><apply id="S3.E8.m1.55.55.1.1.1.3.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.3a.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">formulae-sequence</csymbol><apply id="S3.E8.m1.55.55.1.1.1.1.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><eq id="S3.E8.m1.3.3.3.3.1.1.cmml" xref="S3.E8.m1.3.3.3.3.1.1"></eq><apply id="S3.E8.m1.55.55.1.1.1.1.1.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">subscript</csymbol><apply id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1"><ci id="S3.E8.m1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1">^</ci><ci id="S3.E8.m1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2">𝑣</ci></apply><apply id="S3.E8.m1.2.2.2.2.2.2.1.cmml" xref="S3.E8.m1.2.2.2.2.2.2.1"><plus id="S3.E8.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E8.m1.2.2.2.2.2.2.1.1"></plus><ci id="S3.E8.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E8.m1.2.2.2.2.2.2.1.2">𝑛</ci><cn id="S3.E8.m1.2.2.2.2.2.2.1.3.cmml" type="integer" xref="S3.E8.m1.2.2.2.2.2.2.1.3">1</cn></apply></apply><apply id="S3.E8.m1.55.55.1.1.1.1.1.3.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><plus id="S3.E8.m1.10.10.10.10.8.8.cmml" xref="S3.E8.m1.10.10.10.10.8.8"></plus><apply id="S3.E8.m1.55.55.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><times id="S3.E8.m1.55.55.1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"></times><apply id="S3.E8.m1.55.55.1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">superscript</csymbol><apply id="S3.E8.m1.55.55.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">subscript</csymbol><ci id="S3.E8.m1.4.4.4.4.2.2.cmml" xref="S3.E8.m1.4.4.4.4.2.2">𝑅</ci><ci id="S3.E8.m1.5.5.5.5.3.3.1.cmml" xref="S3.E8.m1.5.5.5.5.3.3.1">𝑛</ci></apply><ci id="S3.E8.m1.6.6.6.6.4.4.1.cmml" xref="S3.E8.m1.6.6.6.6.4.4.1">𝐿</ci></apply><apply id="S3.E8.m1.55.55.1.1.1.1.1.3.2.3.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">subscript</csymbol><apply id="S3.E8.m1.55.55.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.1.1.3.2.3.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">superscript</csymbol><ci id="S3.E8.m1.7.7.7.7.5.5.cmml" xref="S3.E8.m1.7.7.7.7.5.5">𝑊</ci><ci id="S3.E8.m1.8.8.8.8.6.6.1.cmml" xref="S3.E8.m1.8.8.8.8.6.6.1">′</ci></apply><ci id="S3.E8.m1.9.9.9.9.7.7.1.cmml" xref="S3.E8.m1.9.9.9.9.7.7.1">𝑣</ci></apply></apply><apply id="S3.E8.m1.55.55.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">superscript</csymbol><apply id="S3.E8.m1.55.55.1.1.1.1.1.3.3.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.1.1.3.3.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">subscript</csymbol><ci id="S3.E8.m1.11.11.11.11.9.9.cmml" xref="S3.E8.m1.11.11.11.11.9.9">𝑏</ci><ci id="S3.E8.m1.12.12.12.12.10.10.1.cmml" xref="S3.E8.m1.12.12.12.12.10.10.1">𝑣</ci></apply><ci id="S3.E8.m1.13.13.13.13.11.11.1.cmml" xref="S3.E8.m1.13.13.13.13.11.11.1">′</ci></apply></apply></apply><apply id="S3.E8.m1.55.55.1.1.1.2.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><and id="S3.E8.m1.55.55.1.1.1.2.2a.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"></and><apply id="S3.E8.m1.55.55.1.1.1.2.2b.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><eq id="S3.E8.m1.16.16.16.16.14.14.cmml" xref="S3.E8.m1.16.16.16.16.14.14"></eq><apply id="S3.E8.m1.55.55.1.1.1.2.2.3.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.2.2.3.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">subscript</csymbol><ci id="S3.E8.m1.14.14.14.14.12.12.cmml" xref="S3.E8.m1.14.14.14.14.12.12">𝐿</ci><ci id="S3.E8.m1.15.15.15.15.13.13.1.cmml" xref="S3.E8.m1.15.15.15.15.13.13.1">𝑣</ci></apply><apply id="S3.E8.m1.55.55.1.1.1.2.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><apply id="S3.E8.m1.55.55.1.1.1.2.2.1.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.2.2.1.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">superscript</csymbol><apply id="S3.E8.m1.55.55.1.1.1.2.2.1.2.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.2.2.1.2.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">subscript</csymbol><sum id="S3.E8.m1.17.17.17.17.15.15.cmml" xref="S3.E8.m1.17.17.17.17.15.15"></sum><apply id="S3.E8.m1.18.18.18.18.16.16.1.cmml" xref="S3.E8.m1.18.18.18.18.16.16.1"><eq id="S3.E8.m1.18.18.18.18.16.16.1.1.cmml" xref="S3.E8.m1.18.18.18.18.16.16.1.1"></eq><ci id="S3.E8.m1.18.18.18.18.16.16.1.2.cmml" xref="S3.E8.m1.18.18.18.18.16.16.1.2">𝑣</ci><cn id="S3.E8.m1.18.18.18.18.16.16.1.3.cmml" type="integer" xref="S3.E8.m1.18.18.18.18.16.16.1.3">1</cn></apply></apply><apply id="S3.E8.m1.19.19.19.19.17.17.1.2.cmml" xref="S3.E8.m1.19.19.19.19.17.17.1.3"><abs id="S3.E8.m1.19.19.19.19.17.17.1.2.1.cmml" xref="S3.E8.m1.19.19.19.19.17.17.1.3.1"></abs><ci id="S3.E8.m1.19.19.19.19.17.17.1.1.cmml" xref="S3.E8.m1.19.19.19.19.17.17.1.1">𝑉</ci></apply></apply><apply id="S3.E8.m1.55.55.1.1.1.2.2.1.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><times id="S3.E8.m1.55.55.1.1.1.2.2.1.1.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"></times><apply id="S3.E8.m1.55.55.1.1.1.2.2.1.1.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.2.2.1.1.1.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">superscript</csymbol><apply id="S3.E8.m1.55.55.1.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="latexml" id="S3.E8.m1.55.55.1.1.1.2.2.1.1.1.1.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">delimited-∥∥</csymbol><apply id="S3.E8.m1.55.55.1.1.1.2.2.1.1.1.1.1.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><minus id="S3.E8.m1.23.23.23.23.21.21.cmml" xref="S3.E8.m1.23.23.23.23.21.21"></minus><apply id="S3.E8.m1.55.55.1.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">subscript</csymbol><ci id="S3.E8.m1.21.21.21.21.19.19.cmml" xref="S3.E8.m1.21.21.21.21.19.19">𝑣</ci><apply id="S3.E8.m1.22.22.22.22.20.20.1.cmml" xref="S3.E8.m1.22.22.22.22.20.20.1"><plus id="S3.E8.m1.22.22.22.22.20.20.1.1.cmml" xref="S3.E8.m1.22.22.22.22.20.20.1.1"></plus><ci id="S3.E8.m1.22.22.22.22.20.20.1.2.cmml" xref="S3.E8.m1.22.22.22.22.20.20.1.2">𝑛</ci><cn id="S3.E8.m1.22.22.22.22.20.20.1.3.cmml" type="integer" xref="S3.E8.m1.22.22.22.22.20.20.1.3">1</cn></apply></apply><apply id="S3.E8.m1.55.55.1.1.1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">subscript</csymbol><apply id="S3.E8.m1.24.24.24.24.22.22.cmml" xref="S3.E8.m1.24.24.24.24.22.22"><ci id="S3.E8.m1.24.24.24.24.22.22.1.cmml" xref="S3.E8.m1.24.24.24.24.22.22.1">^</ci><ci id="S3.E8.m1.24.24.24.24.22.22.2.cmml" xref="S3.E8.m1.24.24.24.24.22.22.2">𝑣</ci></apply><apply id="S3.E8.m1.25.25.25.25.23.23.1.cmml" xref="S3.E8.m1.25.25.25.25.23.23.1"><plus id="S3.E8.m1.25.25.25.25.23.23.1.1.cmml" xref="S3.E8.m1.25.25.25.25.23.23.1.1"></plus><ci id="S3.E8.m1.25.25.25.25.23.23.1.2.cmml" xref="S3.E8.m1.25.25.25.25.23.23.1.2">𝑛</ci><cn id="S3.E8.m1.25.25.25.25.23.23.1.3.cmml" type="integer" xref="S3.E8.m1.25.25.25.25.23.23.1.3">1</cn></apply></apply></apply></apply><cn id="S3.E8.m1.27.27.27.27.25.25.1.cmml" type="integer" xref="S3.E8.m1.27.27.27.27.25.25.1">2</cn></apply><apply id="S3.E8.m1.55.55.1.1.1.2.2.1.1.3.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.2.2.1.1.3.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">subscript</csymbol><apply id="S3.E8.m1.28.28.28.1.1.1.cmml" xref="S3.E8.m1.28.28.28.1.1.1"><ci id="S3.E8.m1.28.28.28.1.1.1.1.cmml" xref="S3.E8.m1.28.28.28.1.1.1.1">^</ci><ci id="S3.E8.m1.28.28.28.1.1.1.2.cmml" xref="S3.E8.m1.28.28.28.1.1.1.2">𝑡</ci></apply><apply id="S3.E8.m1.29.29.29.2.2.2.1.cmml" xref="S3.E8.m1.29.29.29.2.2.2.1"><plus id="S3.E8.m1.29.29.29.2.2.2.1.1.cmml" xref="S3.E8.m1.29.29.29.2.2.2.1.1"></plus><ci id="S3.E8.m1.29.29.29.2.2.2.1.2.cmml" xref="S3.E8.m1.29.29.29.2.2.2.1.2">𝑛</ci><cn id="S3.E8.m1.29.29.29.2.2.2.1.3.cmml" type="integer" xref="S3.E8.m1.29.29.29.2.2.2.1.3">1</cn></apply></apply></apply></apply></apply><apply id="S3.E8.m1.55.55.1.1.1.2.2c.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><eq id="S3.E8.m1.30.30.30.3.1.1.cmml" xref="S3.E8.m1.30.30.30.3.1.1"></eq><share href="https://arxiv.org/html/2405.17959v1#S3.E8.m1.55.55.1.1.1.2.2.1.cmml" id="S3.E8.m1.55.55.1.1.1.2.2d.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"></share><apply id="S3.E8.m1.55.55.1.1.1.2.2.6.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><plus id="S3.E8.m1.37.37.37.10.8.8.cmml" xref="S3.E8.m1.37.37.37.10.8.8"></plus><apply id="S3.E8.m1.55.55.1.1.1.2.2.6.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><times id="S3.E8.m1.55.55.1.1.1.2.2.6.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"></times><apply id="S3.E8.m1.55.55.1.1.1.2.2.6.2.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.2.2.6.2.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">superscript</csymbol><apply id="S3.E8.m1.55.55.1.1.1.2.2.6.2.2.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.2.2.6.2.2.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">subscript</csymbol><ci id="S3.E8.m1.31.31.31.4.2.2.cmml" xref="S3.E8.m1.31.31.31.4.2.2">𝑅</ci><ci id="S3.E8.m1.32.32.32.5.3.3.1.cmml" xref="S3.E8.m1.32.32.32.5.3.3.1">𝑛</ci></apply><ci id="S3.E8.m1.33.33.33.6.4.4.1.cmml" xref="S3.E8.m1.33.33.33.6.4.4.1">𝐿</ci></apply><apply id="S3.E8.m1.55.55.1.1.1.2.2.6.2.3.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.2.2.6.2.3.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">subscript</csymbol><apply id="S3.E8.m1.55.55.1.1.1.2.2.6.2.3.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.2.2.6.2.3.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">superscript</csymbol><ci id="S3.E8.m1.34.34.34.7.5.5.cmml" xref="S3.E8.m1.34.34.34.7.5.5">𝑊</ci><ci id="S3.E8.m1.35.35.35.8.6.6.1.cmml" xref="S3.E8.m1.35.35.35.8.6.6.1">′</ci></apply><ci id="S3.E8.m1.36.36.36.9.7.7.1.cmml" xref="S3.E8.m1.36.36.36.9.7.7.1">𝑡</ci></apply></apply><apply id="S3.E8.m1.55.55.1.1.1.2.2.6.3.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.2.2.6.3.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">superscript</csymbol><apply id="S3.E8.m1.55.55.1.1.1.2.2.6.3.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.55.55.1.1.1.2.2.6.3.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">subscript</csymbol><ci id="S3.E8.m1.38.38.38.11.9.9.cmml" xref="S3.E8.m1.38.38.38.11.9.9">𝑏</ci><ci id="S3.E8.m1.39.39.39.12.10.10.1.cmml" xref="S3.E8.m1.39.39.39.12.10.10.1">𝑡</ci></apply><ci id="S3.E8.m1.40.40.40.13.11.11.1.cmml" xref="S3.E8.m1.40.40.40.13.11.11.1">′</ci></apply></apply></apply></apply></apply><apply id="S3.E8.m1.56.56.2.2.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><eq id="S3.E8.m1.43.43.43.16.14.14.cmml" xref="S3.E8.m1.43.43.43.16.14.14"></eq><apply id="S3.E8.m1.56.56.2.2.2.3.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.56.56.2.2.2.3.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">subscript</csymbol><ci id="S3.E8.m1.41.41.41.14.12.12.cmml" xref="S3.E8.m1.41.41.41.14.12.12">𝐿</ci><ci id="S3.E8.m1.42.42.42.15.13.13.1.cmml" xref="S3.E8.m1.42.42.42.15.13.13.1">𝑡</ci></apply><apply id="S3.E8.m1.56.56.2.2.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><apply id="S3.E8.m1.56.56.2.2.2.1.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.56.56.2.2.2.1.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">superscript</csymbol><apply id="S3.E8.m1.56.56.2.2.2.1.2.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.56.56.2.2.2.1.2.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">subscript</csymbol><sum id="S3.E8.m1.44.44.44.17.15.15.cmml" xref="S3.E8.m1.44.44.44.17.15.15"></sum><apply id="S3.E8.m1.45.45.45.18.16.16.1.cmml" xref="S3.E8.m1.45.45.45.18.16.16.1"><eq id="S3.E8.m1.45.45.45.18.16.16.1.1.cmml" xref="S3.E8.m1.45.45.45.18.16.16.1.1"></eq><ci id="S3.E8.m1.45.45.45.18.16.16.1.2.cmml" xref="S3.E8.m1.45.45.45.18.16.16.1.2">𝑡</ci><cn id="S3.E8.m1.45.45.45.18.16.16.1.3.cmml" type="integer" xref="S3.E8.m1.45.45.45.18.16.16.1.3">1</cn></apply></apply><apply id="S3.E8.m1.46.46.46.19.17.17.1.2.cmml" xref="S3.E8.m1.46.46.46.19.17.17.1.3"><abs id="S3.E8.m1.46.46.46.19.17.17.1.2.1.cmml" xref="S3.E8.m1.46.46.46.19.17.17.1.3.1"></abs><ci id="S3.E8.m1.46.46.46.19.17.17.1.1.cmml" xref="S3.E8.m1.46.46.46.19.17.17.1.1">𝑇</ci></apply></apply><apply id="S3.E8.m1.56.56.2.2.2.1.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.56.56.2.2.2.1.1.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">superscript</csymbol><apply id="S3.E8.m1.56.56.2.2.2.1.1.1.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="latexml" id="S3.E8.m1.56.56.2.2.2.1.1.1.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">delimited-∥∥</csymbol><apply id="S3.E8.m1.56.56.2.2.2.1.1.1.1.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><minus id="S3.E8.m1.50.50.50.23.21.21.cmml" xref="S3.E8.m1.50.50.50.23.21.21"></minus><apply id="S3.E8.m1.56.56.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.56.56.2.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">subscript</csymbol><ci id="S3.E8.m1.48.48.48.21.19.19.cmml" xref="S3.E8.m1.48.48.48.21.19.19">𝑡</ci><apply id="S3.E8.m1.49.49.49.22.20.20.1.cmml" xref="S3.E8.m1.49.49.49.22.20.20.1"><plus id="S3.E8.m1.49.49.49.22.20.20.1.1.cmml" xref="S3.E8.m1.49.49.49.22.20.20.1.1"></plus><ci id="S3.E8.m1.49.49.49.22.20.20.1.2.cmml" xref="S3.E8.m1.49.49.49.22.20.20.1.2">𝑛</ci><cn id="S3.E8.m1.49.49.49.22.20.20.1.3.cmml" type="integer" xref="S3.E8.m1.49.49.49.22.20.20.1.3">1</cn></apply></apply><apply id="S3.E8.m1.56.56.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.56.56.2.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.57.57.3.55.28.26.26.1.1">subscript</csymbol><apply id="S3.E8.m1.51.51.51.24.22.22.cmml" xref="S3.E8.m1.51.51.51.24.22.22"><ci id="S3.E8.m1.51.51.51.24.22.22.1.cmml" xref="S3.E8.m1.51.51.51.24.22.22.1">^</ci><ci id="S3.E8.m1.51.51.51.24.22.22.2.cmml" xref="S3.E8.m1.51.51.51.24.22.22.2">𝑡</ci></apply><apply id="S3.E8.m1.52.52.52.25.23.23.1.cmml" xref="S3.E8.m1.52.52.52.25.23.23.1"><plus id="S3.E8.m1.52.52.52.25.23.23.1.1.cmml" xref="S3.E8.m1.52.52.52.25.23.23.1.1"></plus><ci id="S3.E8.m1.52.52.52.25.23.23.1.2.cmml" xref="S3.E8.m1.52.52.52.25.23.23.1.2">𝑛</ci><cn id="S3.E8.m1.52.52.52.25.23.23.1.3.cmml" type="integer" xref="S3.E8.m1.52.52.52.25.23.23.1.3">1</cn></apply></apply></apply></apply><cn id="S3.E8.m1.54.54.54.27.25.25.1.cmml" type="integer" xref="S3.E8.m1.54.54.54.27.25.25.1">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.60c">\begin{split}\hat{v}_{n+1}&amp;=R_{n}^{L}W^{\prime}_{v}+b_{v}^{\prime}\qquad L_{v}%
=\sum_{v=1}^{|V|}\left\|v_{n+1}-\hat{v}_{n+1}\right\|^{2}\\
\hat{t}_{n+1}&amp;=R_{n}^{L}W^{\prime}_{t}+b_{t}^{\prime}\qquad L_{t}=\sum_{t=1}^{%
|T|}\left\|t_{n+1}-\hat{t}_{n+1}\right\|^{2}\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.60d">start_ROW start_CELL over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT end_CELL start_CELL = italic_R start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT italic_W start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_v = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_V | end_POSTSUPERSCRIPT ∥ italic_v start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT - over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_CELL end_ROW start_ROW start_CELL over^ start_ARG italic_t end_ARG start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT end_CELL start_CELL = italic_R start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT italic_W start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_T | end_POSTSUPERSCRIPT ∥ italic_t start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT - over^ start_ARG italic_t end_ARG start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS4.p3">
<p class="ltx_p" id="S3.SS4.p3.6">For categories that show multiple label forms, the real category <math alttext="c_{n+1}" class="ltx_Math" display="inline" id="S3.SS4.p3.1.m1.1"><semantics id="S3.SS4.p3.1.m1.1a"><msub id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml"><mi id="S3.SS4.p3.1.m1.1.1.2" xref="S3.SS4.p3.1.m1.1.1.2.cmml">c</mi><mrow id="S3.SS4.p3.1.m1.1.1.3" xref="S3.SS4.p3.1.m1.1.1.3.cmml"><mi id="S3.SS4.p3.1.m1.1.1.3.2" xref="S3.SS4.p3.1.m1.1.1.3.2.cmml">n</mi><mo id="S3.SS4.p3.1.m1.1.1.3.1" xref="S3.SS4.p3.1.m1.1.1.3.1.cmml">+</mo><mn id="S3.SS4.p3.1.m1.1.1.3.3" xref="S3.SS4.p3.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><apply id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p3.1.m1.1.1.2.cmml" xref="S3.SS4.p3.1.m1.1.1.2">𝑐</ci><apply id="S3.SS4.p3.1.m1.1.1.3.cmml" xref="S3.SS4.p3.1.m1.1.1.3"><plus id="S3.SS4.p3.1.m1.1.1.3.1.cmml" xref="S3.SS4.p3.1.m1.1.1.3.1"></plus><ci id="S3.SS4.p3.1.m1.1.1.3.2.cmml" xref="S3.SS4.p3.1.m1.1.1.3.2">𝑛</ci><cn id="S3.SS4.p3.1.m1.1.1.3.3.cmml" type="integer" xref="S3.SS4.p3.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">c_{n+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.1.m1.1d">italic_c start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT</annotation></semantics></math> of items and the predicted category <math alttext="\hat{c}_{n+1}" class="ltx_Math" display="inline" id="S3.SS4.p3.2.m2.1"><semantics id="S3.SS4.p3.2.m2.1a"><msub id="S3.SS4.p3.2.m2.1.1" xref="S3.SS4.p3.2.m2.1.1.cmml"><mover accent="true" id="S3.SS4.p3.2.m2.1.1.2" xref="S3.SS4.p3.2.m2.1.1.2.cmml"><mi id="S3.SS4.p3.2.m2.1.1.2.2" xref="S3.SS4.p3.2.m2.1.1.2.2.cmml">c</mi><mo id="S3.SS4.p3.2.m2.1.1.2.1" xref="S3.SS4.p3.2.m2.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS4.p3.2.m2.1.1.3" xref="S3.SS4.p3.2.m2.1.1.3.cmml"><mi id="S3.SS4.p3.2.m2.1.1.3.2" xref="S3.SS4.p3.2.m2.1.1.3.2.cmml">n</mi><mo id="S3.SS4.p3.2.m2.1.1.3.1" xref="S3.SS4.p3.2.m2.1.1.3.1.cmml">+</mo><mn id="S3.SS4.p3.2.m2.1.1.3.3" xref="S3.SS4.p3.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b"><apply id="S3.SS4.p3.2.m2.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1">subscript</csymbol><apply id="S3.SS4.p3.2.m2.1.1.2.cmml" xref="S3.SS4.p3.2.m2.1.1.2"><ci id="S3.SS4.p3.2.m2.1.1.2.1.cmml" xref="S3.SS4.p3.2.m2.1.1.2.1">^</ci><ci id="S3.SS4.p3.2.m2.1.1.2.2.cmml" xref="S3.SS4.p3.2.m2.1.1.2.2">𝑐</ci></apply><apply id="S3.SS4.p3.2.m2.1.1.3.cmml" xref="S3.SS4.p3.2.m2.1.1.3"><plus id="S3.SS4.p3.2.m2.1.1.3.1.cmml" xref="S3.SS4.p3.2.m2.1.1.3.1"></plus><ci id="S3.SS4.p3.2.m2.1.1.3.2.cmml" xref="S3.SS4.p3.2.m2.1.1.3.2">𝑛</ci><cn id="S3.SS4.p3.2.m2.1.1.3.3.cmml" type="integer" xref="S3.SS4.p3.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">\hat{c}_{n+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.2.m2.1d">over^ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT</annotation></semantics></math> from the attention fusion module are learned using a binary cross-entropy loss, as expressed in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S3.E9" title="Equation 9 ‣ 3.4 Prediction module ‣ 3 Proposed method ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">9</span></a>. <math alttext="W_{c}^{\prime}\in\mathbb{R}^{d\times d_{c}}" class="ltx_Math" display="inline" id="S3.SS4.p3.3.m3.1"><semantics id="S3.SS4.p3.3.m3.1a"><mrow id="S3.SS4.p3.3.m3.1.1" xref="S3.SS4.p3.3.m3.1.1.cmml"><msubsup id="S3.SS4.p3.3.m3.1.1.2" xref="S3.SS4.p3.3.m3.1.1.2.cmml"><mi id="S3.SS4.p3.3.m3.1.1.2.2.2" xref="S3.SS4.p3.3.m3.1.1.2.2.2.cmml">W</mi><mi id="S3.SS4.p3.3.m3.1.1.2.2.3" xref="S3.SS4.p3.3.m3.1.1.2.2.3.cmml">c</mi><mo id="S3.SS4.p3.3.m3.1.1.2.3" xref="S3.SS4.p3.3.m3.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.SS4.p3.3.m3.1.1.1" xref="S3.SS4.p3.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS4.p3.3.m3.1.1.3" xref="S3.SS4.p3.3.m3.1.1.3.cmml"><mi id="S3.SS4.p3.3.m3.1.1.3.2" xref="S3.SS4.p3.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p3.3.m3.1.1.3.3" xref="S3.SS4.p3.3.m3.1.1.3.3.cmml"><mi id="S3.SS4.p3.3.m3.1.1.3.3.2" xref="S3.SS4.p3.3.m3.1.1.3.3.2.cmml">d</mi><mo id="S3.SS4.p3.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p3.3.m3.1.1.3.3.1.cmml">×</mo><msub id="S3.SS4.p3.3.m3.1.1.3.3.3" xref="S3.SS4.p3.3.m3.1.1.3.3.3.cmml"><mi id="S3.SS4.p3.3.m3.1.1.3.3.3.2" xref="S3.SS4.p3.3.m3.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS4.p3.3.m3.1.1.3.3.3.3" xref="S3.SS4.p3.3.m3.1.1.3.3.3.3.cmml">c</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m3.1b"><apply id="S3.SS4.p3.3.m3.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1"><in id="S3.SS4.p3.3.m3.1.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1.1"></in><apply id="S3.SS4.p3.3.m3.1.1.2.cmml" xref="S3.SS4.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p3.3.m3.1.1.2.1.cmml" xref="S3.SS4.p3.3.m3.1.1.2">superscript</csymbol><apply id="S3.SS4.p3.3.m3.1.1.2.2.cmml" xref="S3.SS4.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p3.3.m3.1.1.2.2.1.cmml" xref="S3.SS4.p3.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS4.p3.3.m3.1.1.2.2.2.cmml" xref="S3.SS4.p3.3.m3.1.1.2.2.2">𝑊</ci><ci id="S3.SS4.p3.3.m3.1.1.2.2.3.cmml" xref="S3.SS4.p3.3.m3.1.1.2.2.3">𝑐</ci></apply><ci id="S3.SS4.p3.3.m3.1.1.2.3.cmml" xref="S3.SS4.p3.3.m3.1.1.2.3">′</ci></apply><apply id="S3.SS4.p3.3.m3.1.1.3.cmml" xref="S3.SS4.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p3.3.m3.1.1.3.1.cmml" xref="S3.SS4.p3.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS4.p3.3.m3.1.1.3.2.cmml" xref="S3.SS4.p3.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS4.p3.3.m3.1.1.3.3.cmml" xref="S3.SS4.p3.3.m3.1.1.3.3"><times id="S3.SS4.p3.3.m3.1.1.3.3.1.cmml" xref="S3.SS4.p3.3.m3.1.1.3.3.1"></times><ci id="S3.SS4.p3.3.m3.1.1.3.3.2.cmml" xref="S3.SS4.p3.3.m3.1.1.3.3.2">𝑑</ci><apply id="S3.SS4.p3.3.m3.1.1.3.3.3.cmml" xref="S3.SS4.p3.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p3.3.m3.1.1.3.3.3.1.cmml" xref="S3.SS4.p3.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS4.p3.3.m3.1.1.3.3.3.2.cmml" xref="S3.SS4.p3.3.m3.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS4.p3.3.m3.1.1.3.3.3.3.cmml" xref="S3.SS4.p3.3.m3.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.3.m3.1c">W_{c}^{\prime}\in\mathbb{R}^{d\times d_{c}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.3.m3.1d">italic_W start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="b_{c}^{\prime}\in\mathbb{R}^{1\times d_{c}}" class="ltx_Math" display="inline" id="S3.SS4.p3.4.m4.1"><semantics id="S3.SS4.p3.4.m4.1a"><mrow id="S3.SS4.p3.4.m4.1.1" xref="S3.SS4.p3.4.m4.1.1.cmml"><msubsup id="S3.SS4.p3.4.m4.1.1.2" xref="S3.SS4.p3.4.m4.1.1.2.cmml"><mi id="S3.SS4.p3.4.m4.1.1.2.2.2" xref="S3.SS4.p3.4.m4.1.1.2.2.2.cmml">b</mi><mi id="S3.SS4.p3.4.m4.1.1.2.2.3" xref="S3.SS4.p3.4.m4.1.1.2.2.3.cmml">c</mi><mo id="S3.SS4.p3.4.m4.1.1.2.3" xref="S3.SS4.p3.4.m4.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.SS4.p3.4.m4.1.1.1" xref="S3.SS4.p3.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS4.p3.4.m4.1.1.3" xref="S3.SS4.p3.4.m4.1.1.3.cmml"><mi id="S3.SS4.p3.4.m4.1.1.3.2" xref="S3.SS4.p3.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p3.4.m4.1.1.3.3" xref="S3.SS4.p3.4.m4.1.1.3.3.cmml"><mn id="S3.SS4.p3.4.m4.1.1.3.3.2" xref="S3.SS4.p3.4.m4.1.1.3.3.2.cmml">1</mn><mo id="S3.SS4.p3.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p3.4.m4.1.1.3.3.1.cmml">×</mo><msub id="S3.SS4.p3.4.m4.1.1.3.3.3" xref="S3.SS4.p3.4.m4.1.1.3.3.3.cmml"><mi id="S3.SS4.p3.4.m4.1.1.3.3.3.2" xref="S3.SS4.p3.4.m4.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS4.p3.4.m4.1.1.3.3.3.3" xref="S3.SS4.p3.4.m4.1.1.3.3.3.3.cmml">c</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.4.m4.1b"><apply id="S3.SS4.p3.4.m4.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1"><in id="S3.SS4.p3.4.m4.1.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1.1"></in><apply id="S3.SS4.p3.4.m4.1.1.2.cmml" xref="S3.SS4.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p3.4.m4.1.1.2.1.cmml" xref="S3.SS4.p3.4.m4.1.1.2">superscript</csymbol><apply id="S3.SS4.p3.4.m4.1.1.2.2.cmml" xref="S3.SS4.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p3.4.m4.1.1.2.2.1.cmml" xref="S3.SS4.p3.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS4.p3.4.m4.1.1.2.2.2.cmml" xref="S3.SS4.p3.4.m4.1.1.2.2.2">𝑏</ci><ci id="S3.SS4.p3.4.m4.1.1.2.2.3.cmml" xref="S3.SS4.p3.4.m4.1.1.2.2.3">𝑐</ci></apply><ci id="S3.SS4.p3.4.m4.1.1.2.3.cmml" xref="S3.SS4.p3.4.m4.1.1.2.3">′</ci></apply><apply id="S3.SS4.p3.4.m4.1.1.3.cmml" xref="S3.SS4.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p3.4.m4.1.1.3.1.cmml" xref="S3.SS4.p3.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS4.p3.4.m4.1.1.3.2.cmml" xref="S3.SS4.p3.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS4.p3.4.m4.1.1.3.3.cmml" xref="S3.SS4.p3.4.m4.1.1.3.3"><times id="S3.SS4.p3.4.m4.1.1.3.3.1.cmml" xref="S3.SS4.p3.4.m4.1.1.3.3.1"></times><cn id="S3.SS4.p3.4.m4.1.1.3.3.2.cmml" type="integer" xref="S3.SS4.p3.4.m4.1.1.3.3.2">1</cn><apply id="S3.SS4.p3.4.m4.1.1.3.3.3.cmml" xref="S3.SS4.p3.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p3.4.m4.1.1.3.3.3.1.cmml" xref="S3.SS4.p3.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S3.SS4.p3.4.m4.1.1.3.3.3.2.cmml" xref="S3.SS4.p3.4.m4.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS4.p3.4.m4.1.1.3.3.3.3.cmml" xref="S3.SS4.p3.4.m4.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.4.m4.1c">b_{c}^{\prime}\in\mathbb{R}^{1\times d_{c}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.4.m4.1d">italic_b start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 1 × italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> are learnable parameters, <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS4.p3.5.m5.1"><semantics id="S3.SS4.p3.5.m5.1a"><mi id="S3.SS4.p3.5.m5.1.1" xref="S3.SS4.p3.5.m5.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.5.m5.1b"><ci id="S3.SS4.p3.5.m5.1.1.cmml" xref="S3.SS4.p3.5.m5.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.5.m5.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.5.m5.1d">italic_σ</annotation></semantics></math> is sigmoid. Where <math alttext="|C|" class="ltx_Math" display="inline" id="S3.SS4.p3.6.m6.1"><semantics id="S3.SS4.p3.6.m6.1a"><mrow id="S3.SS4.p3.6.m6.1.2.2" xref="S3.SS4.p3.6.m6.1.2.1.cmml"><mo id="S3.SS4.p3.6.m6.1.2.2.1" stretchy="false" xref="S3.SS4.p3.6.m6.1.2.1.1.cmml">|</mo><mi id="S3.SS4.p3.6.m6.1.1" xref="S3.SS4.p3.6.m6.1.1.cmml">C</mi><mo id="S3.SS4.p3.6.m6.1.2.2.2" stretchy="false" xref="S3.SS4.p3.6.m6.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.6.m6.1b"><apply id="S3.SS4.p3.6.m6.1.2.1.cmml" xref="S3.SS4.p3.6.m6.1.2.2"><abs id="S3.SS4.p3.6.m6.1.2.1.1.cmml" xref="S3.SS4.p3.6.m6.1.2.2.1"></abs><ci id="S3.SS4.p3.6.m6.1.1.cmml" xref="S3.SS4.p3.6.m6.1.1">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.6.m6.1c">|C|</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.6.m6.1d">| italic_C |</annotation></semantics></math> represents the total number of item-specific categories.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\begin{split}\hat{c}_{n+1}&amp;=\sigma(R_{n}^{L}W_{c}^{\prime}+b_{c}^{\prime})\\
L_{c}&amp;=-\sum_{c=1}^{|C|}c_{n+1}\log\hat{c}_{n+1}+(1-c_{n+1})\log(1-\hat{c}_{n+%
1})\end{split}" class="ltx_Math" display="block" id="S3.E9.m1.48"><semantics id="S3.E9.m1.48a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E9.m1.48.48.6" rowspacing="0pt" xref="S3.E9.m1.45.45.3.cmml"><mtr id="S3.E9.m1.48.48.6a" xref="S3.E9.m1.45.45.3.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E9.m1.48.48.6b" xref="S3.E9.m1.45.45.3.cmml"><msub id="S3.E9.m1.2.2.2.2.2" xref="S3.E9.m1.45.45.3.cmml"><mover accent="true" id="S3.E9.m1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.2.cmml">c</mi><mo id="S3.E9.m1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.cmml">^</mo></mover><mrow id="S3.E9.m1.2.2.2.2.2.2.1" xref="S3.E9.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.E9.m1.2.2.2.2.2.2.1.2" xref="S3.E9.m1.2.2.2.2.2.2.1.2.cmml">n</mi><mo id="S3.E9.m1.2.2.2.2.2.2.1.1" xref="S3.E9.m1.2.2.2.2.2.2.1.1.cmml">+</mo><mn id="S3.E9.m1.2.2.2.2.2.2.1.3" xref="S3.E9.m1.2.2.2.2.2.2.1.3.cmml">1</mn></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E9.m1.48.48.6c" xref="S3.E9.m1.45.45.3.cmml"><mrow id="S3.E9.m1.46.46.4.43.17.15" xref="S3.E9.m1.45.45.3.cmml"><mi id="S3.E9.m1.46.46.4.43.17.15.16" xref="S3.E9.m1.45.45.3a.cmml"></mi><mo id="S3.E9.m1.3.3.3.3.1.1" xref="S3.E9.m1.3.3.3.3.1.1.cmml">=</mo><mrow id="S3.E9.m1.46.46.4.43.17.15.15" xref="S3.E9.m1.45.45.3.cmml"><mi id="S3.E9.m1.4.4.4.4.2.2" xref="S3.E9.m1.4.4.4.4.2.2.cmml">σ</mi><mo id="S3.E9.m1.46.46.4.43.17.15.15.2" xref="S3.E9.m1.45.45.3a.cmml">⁢</mo><mrow id="S3.E9.m1.46.46.4.43.17.15.15.1.1" xref="S3.E9.m1.45.45.3.cmml"><mo id="S3.E9.m1.5.5.5.5.3.3" stretchy="false" xref="S3.E9.m1.45.45.3a.cmml">(</mo><mrow id="S3.E9.m1.46.46.4.43.17.15.15.1.1.1" xref="S3.E9.m1.45.45.3.cmml"><mrow id="S3.E9.m1.46.46.4.43.17.15.15.1.1.1.1" xref="S3.E9.m1.45.45.3.cmml"><msubsup id="S3.E9.m1.46.46.4.43.17.15.15.1.1.1.1.2" xref="S3.E9.m1.45.45.3.cmml"><mi id="S3.E9.m1.6.6.6.6.4.4" xref="S3.E9.m1.6.6.6.6.4.4.cmml">R</mi><mi id="S3.E9.m1.7.7.7.7.5.5.1" xref="S3.E9.m1.7.7.7.7.5.5.1.cmml">n</mi><mi id="S3.E9.m1.8.8.8.8.6.6.1" xref="S3.E9.m1.8.8.8.8.6.6.1.cmml">L</mi></msubsup><mo id="S3.E9.m1.46.46.4.43.17.15.15.1.1.1.1.1" xref="S3.E9.m1.45.45.3a.cmml">⁢</mo><msubsup id="S3.E9.m1.46.46.4.43.17.15.15.1.1.1.1.3" xref="S3.E9.m1.45.45.3.cmml"><mi id="S3.E9.m1.9.9.9.9.7.7" xref="S3.E9.m1.9.9.9.9.7.7.cmml">W</mi><mi id="S3.E9.m1.10.10.10.10.8.8.1" xref="S3.E9.m1.10.10.10.10.8.8.1.cmml">c</mi><mo id="S3.E9.m1.11.11.11.11.9.9.1" xref="S3.E9.m1.11.11.11.11.9.9.1.cmml">′</mo></msubsup></mrow><mo id="S3.E9.m1.12.12.12.12.10.10" xref="S3.E9.m1.12.12.12.12.10.10.cmml">+</mo><msubsup id="S3.E9.m1.46.46.4.43.17.15.15.1.1.1.2" xref="S3.E9.m1.45.45.3.cmml"><mi id="S3.E9.m1.13.13.13.13.11.11" xref="S3.E9.m1.13.13.13.13.11.11.cmml">b</mi><mi id="S3.E9.m1.14.14.14.14.12.12.1" xref="S3.E9.m1.14.14.14.14.12.12.1.cmml">c</mi><mo id="S3.E9.m1.15.15.15.15.13.13.1" xref="S3.E9.m1.15.15.15.15.13.13.1.cmml">′</mo></msubsup></mrow><mo id="S3.E9.m1.16.16.16.16.14.14" stretchy="false" xref="S3.E9.m1.45.45.3a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E9.m1.48.48.6d" xref="S3.E9.m1.45.45.3.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E9.m1.48.48.6e" xref="S3.E9.m1.45.45.3.cmml"><msub id="S3.E9.m1.18.18.18.2.2" xref="S3.E9.m1.45.45.3.cmml"><mi id="S3.E9.m1.17.17.17.1.1.1" xref="S3.E9.m1.17.17.17.1.1.1.cmml">L</mi><mi id="S3.E9.m1.18.18.18.2.2.2.1" xref="S3.E9.m1.18.18.18.2.2.2.1.cmml">c</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E9.m1.48.48.6f" xref="S3.E9.m1.45.45.3.cmml"><mrow id="S3.E9.m1.48.48.6.45.28.26" xref="S3.E9.m1.45.45.3.cmml"><mi id="S3.E9.m1.48.48.6.45.28.26.27" xref="S3.E9.m1.45.45.3a.cmml"></mi><mo id="S3.E9.m1.19.19.19.3.1.1" xref="S3.E9.m1.19.19.19.3.1.1.cmml">=</mo><mrow id="S3.E9.m1.48.48.6.45.28.26.26" xref="S3.E9.m1.45.45.3.cmml"><mrow id="S3.E9.m1.48.48.6.45.28.26.26.3" xref="S3.E9.m1.45.45.3.cmml"><mo id="S3.E9.m1.48.48.6.45.28.26.26.3a" xref="S3.E9.m1.45.45.3a.cmml">−</mo><mrow id="S3.E9.m1.48.48.6.45.28.26.26.3.1" xref="S3.E9.m1.45.45.3.cmml"><munderover id="S3.E9.m1.48.48.6.45.28.26.26.3.1.1" xref="S3.E9.m1.45.45.3.cmml"><mo id="S3.E9.m1.21.21.21.5.3.3" movablelimits="false" xref="S3.E9.m1.21.21.21.5.3.3.cmml">∑</mo><mrow id="S3.E9.m1.22.22.22.6.4.4.1" xref="S3.E9.m1.22.22.22.6.4.4.1.cmml"><mi id="S3.E9.m1.22.22.22.6.4.4.1.2" xref="S3.E9.m1.22.22.22.6.4.4.1.2.cmml">c</mi><mo id="S3.E9.m1.22.22.22.6.4.4.1.1" xref="S3.E9.m1.22.22.22.6.4.4.1.1.cmml">=</mo><mn id="S3.E9.m1.22.22.22.6.4.4.1.3" xref="S3.E9.m1.22.22.22.6.4.4.1.3.cmml">1</mn></mrow><mrow id="S3.E9.m1.23.23.23.7.5.5.1.3" xref="S3.E9.m1.23.23.23.7.5.5.1.2.cmml"><mo id="S3.E9.m1.23.23.23.7.5.5.1.3.1" stretchy="false" xref="S3.E9.m1.23.23.23.7.5.5.1.2.1.cmml">|</mo><mi id="S3.E9.m1.23.23.23.7.5.5.1.1" xref="S3.E9.m1.23.23.23.7.5.5.1.1.cmml">C</mi><mo id="S3.E9.m1.23.23.23.7.5.5.1.3.2" stretchy="false" xref="S3.E9.m1.23.23.23.7.5.5.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S3.E9.m1.48.48.6.45.28.26.26.3.1.2" xref="S3.E9.m1.45.45.3.cmml"><msub id="S3.E9.m1.48.48.6.45.28.26.26.3.1.2.2" xref="S3.E9.m1.45.45.3.cmml"><mi id="S3.E9.m1.24.24.24.8.6.6" xref="S3.E9.m1.24.24.24.8.6.6.cmml">c</mi><mrow id="S3.E9.m1.25.25.25.9.7.7.1" xref="S3.E9.m1.25.25.25.9.7.7.1.cmml"><mi id="S3.E9.m1.25.25.25.9.7.7.1.2" xref="S3.E9.m1.25.25.25.9.7.7.1.2.cmml">n</mi><mo id="S3.E9.m1.25.25.25.9.7.7.1.1" xref="S3.E9.m1.25.25.25.9.7.7.1.1.cmml">+</mo><mn id="S3.E9.m1.25.25.25.9.7.7.1.3" xref="S3.E9.m1.25.25.25.9.7.7.1.3.cmml">1</mn></mrow></msub><mo id="S3.E9.m1.48.48.6.45.28.26.26.3.1.2.1" lspace="0.167em" xref="S3.E9.m1.45.45.3a.cmml">⁢</mo><mrow id="S3.E9.m1.48.48.6.45.28.26.26.3.1.2.3" xref="S3.E9.m1.45.45.3.cmml"><mi id="S3.E9.m1.26.26.26.10.8.8" xref="S3.E9.m1.26.26.26.10.8.8.cmml">log</mi><mo id="S3.E9.m1.48.48.6.45.28.26.26.3.1.2.3a" lspace="0.167em" xref="S3.E9.m1.45.45.3a.cmml">⁡</mo><msub id="S3.E9.m1.48.48.6.45.28.26.26.3.1.2.3.1" xref="S3.E9.m1.45.45.3.cmml"><mover accent="true" id="S3.E9.m1.27.27.27.11.9.9" xref="S3.E9.m1.27.27.27.11.9.9.cmml"><mi id="S3.E9.m1.27.27.27.11.9.9.2" xref="S3.E9.m1.27.27.27.11.9.9.2.cmml">c</mi><mo id="S3.E9.m1.27.27.27.11.9.9.1" xref="S3.E9.m1.27.27.27.11.9.9.1.cmml">^</mo></mover><mrow id="S3.E9.m1.28.28.28.12.10.10.1" xref="S3.E9.m1.28.28.28.12.10.10.1.cmml"><mi id="S3.E9.m1.28.28.28.12.10.10.1.2" xref="S3.E9.m1.28.28.28.12.10.10.1.2.cmml">n</mi><mo id="S3.E9.m1.28.28.28.12.10.10.1.1" xref="S3.E9.m1.28.28.28.12.10.10.1.1.cmml">+</mo><mn id="S3.E9.m1.28.28.28.12.10.10.1.3" xref="S3.E9.m1.28.28.28.12.10.10.1.3.cmml">1</mn></mrow></msub></mrow></mrow></mrow></mrow><mo id="S3.E9.m1.29.29.29.13.11.11" xref="S3.E9.m1.29.29.29.13.11.11.cmml">+</mo><mrow id="S3.E9.m1.48.48.6.45.28.26.26.2" xref="S3.E9.m1.45.45.3.cmml"><mrow id="S3.E9.m1.47.47.5.44.27.25.25.1.1.1" xref="S3.E9.m1.45.45.3.cmml"><mo id="S3.E9.m1.30.30.30.14.12.12" stretchy="false" xref="S3.E9.m1.45.45.3a.cmml">(</mo><mrow id="S3.E9.m1.47.47.5.44.27.25.25.1.1.1.1" xref="S3.E9.m1.45.45.3.cmml"><mn id="S3.E9.m1.31.31.31.15.13.13" xref="S3.E9.m1.31.31.31.15.13.13.cmml">1</mn><mo id="S3.E9.m1.32.32.32.16.14.14" xref="S3.E9.m1.32.32.32.16.14.14.cmml">−</mo><msub id="S3.E9.m1.47.47.5.44.27.25.25.1.1.1.1.1" xref="S3.E9.m1.45.45.3.cmml"><mi id="S3.E9.m1.33.33.33.17.15.15" xref="S3.E9.m1.33.33.33.17.15.15.cmml">c</mi><mrow id="S3.E9.m1.34.34.34.18.16.16.1" xref="S3.E9.m1.34.34.34.18.16.16.1.cmml"><mi id="S3.E9.m1.34.34.34.18.16.16.1.2" xref="S3.E9.m1.34.34.34.18.16.16.1.2.cmml">n</mi><mo id="S3.E9.m1.34.34.34.18.16.16.1.1" xref="S3.E9.m1.34.34.34.18.16.16.1.1.cmml">+</mo><mn id="S3.E9.m1.34.34.34.18.16.16.1.3" xref="S3.E9.m1.34.34.34.18.16.16.1.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E9.m1.35.35.35.19.17.17" stretchy="false" xref="S3.E9.m1.45.45.3a.cmml">)</mo></mrow><mo id="S3.E9.m1.48.48.6.45.28.26.26.2.3" lspace="0.167em" xref="S3.E9.m1.45.45.3a.cmml">⁢</mo><mrow id="S3.E9.m1.48.48.6.45.28.26.26.2.2.1" xref="S3.E9.m1.45.45.3.cmml"><mi id="S3.E9.m1.36.36.36.20.18.18" xref="S3.E9.m1.36.36.36.20.18.18.cmml">log</mi><mo id="S3.E9.m1.48.48.6.45.28.26.26.2.2.1a" xref="S3.E9.m1.45.45.3a.cmml">⁡</mo><mrow id="S3.E9.m1.48.48.6.45.28.26.26.2.2.1.1" xref="S3.E9.m1.45.45.3.cmml"><mo id="S3.E9.m1.37.37.37.21.19.19" stretchy="false" xref="S3.E9.m1.45.45.3a.cmml">(</mo><mrow id="S3.E9.m1.48.48.6.45.28.26.26.2.2.1.1.1" xref="S3.E9.m1.45.45.3.cmml"><mn id="S3.E9.m1.38.38.38.22.20.20" xref="S3.E9.m1.38.38.38.22.20.20.cmml">1</mn><mo id="S3.E9.m1.39.39.39.23.21.21" xref="S3.E9.m1.39.39.39.23.21.21.cmml">−</mo><msub id="S3.E9.m1.48.48.6.45.28.26.26.2.2.1.1.1.1" xref="S3.E9.m1.45.45.3.cmml"><mover accent="true" id="S3.E9.m1.40.40.40.24.22.22" xref="S3.E9.m1.40.40.40.24.22.22.cmml"><mi id="S3.E9.m1.40.40.40.24.22.22.2" xref="S3.E9.m1.40.40.40.24.22.22.2.cmml">c</mi><mo id="S3.E9.m1.40.40.40.24.22.22.1" xref="S3.E9.m1.40.40.40.24.22.22.1.cmml">^</mo></mover><mrow id="S3.E9.m1.41.41.41.25.23.23.1" xref="S3.E9.m1.41.41.41.25.23.23.1.cmml"><mi id="S3.E9.m1.41.41.41.25.23.23.1.2" xref="S3.E9.m1.41.41.41.25.23.23.1.2.cmml">n</mi><mo id="S3.E9.m1.41.41.41.25.23.23.1.1" xref="S3.E9.m1.41.41.41.25.23.23.1.1.cmml">+</mo><mn id="S3.E9.m1.41.41.41.25.23.23.1.3" xref="S3.E9.m1.41.41.41.25.23.23.1.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E9.m1.42.42.42.26.24.24" stretchy="false" xref="S3.E9.m1.45.45.3a.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E9.m1.48b"><apply id="S3.E9.m1.45.45.3.cmml" xref="S3.E9.m1.48.48.6"><and id="S3.E9.m1.45.45.3a.cmml" xref="S3.E9.m1.46.46.4.43.17.15.16"></and><apply id="S3.E9.m1.45.45.3b.cmml" xref="S3.E9.m1.48.48.6"><eq id="S3.E9.m1.3.3.3.3.1.1.cmml" xref="S3.E9.m1.3.3.3.3.1.1"></eq><apply id="S3.E9.m1.45.45.3.5.cmml" xref="S3.E9.m1.48.48.6"><csymbol cd="ambiguous" id="S3.E9.m1.45.45.3.5.1.cmml" xref="S3.E9.m1.46.46.4.43.17.15.16">subscript</csymbol><apply id="S3.E9.m1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1"><ci id="S3.E9.m1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1">^</ci><ci id="S3.E9.m1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2">𝑐</ci></apply><apply id="S3.E9.m1.2.2.2.2.2.2.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1"><plus id="S3.E9.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1"></plus><ci id="S3.E9.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.2">𝑛</ci><cn id="S3.E9.m1.2.2.2.2.2.2.1.3.cmml" type="integer" xref="S3.E9.m1.2.2.2.2.2.2.1.3">1</cn></apply></apply><apply id="S3.E9.m1.43.43.1.1.cmml" xref="S3.E9.m1.48.48.6"><times id="S3.E9.m1.43.43.1.1.2.cmml" xref="S3.E9.m1.46.46.4.43.17.15.16"></times><ci id="S3.E9.m1.4.4.4.4.2.2.cmml" xref="S3.E9.m1.4.4.4.4.2.2">𝜎</ci><apply id="S3.E9.m1.43.43.1.1.1.1.1.cmml" xref="S3.E9.m1.48.48.6"><plus id="S3.E9.m1.12.12.12.12.10.10.cmml" xref="S3.E9.m1.12.12.12.12.10.10"></plus><apply id="S3.E9.m1.43.43.1.1.1.1.1.2.cmml" xref="S3.E9.m1.48.48.6"><times id="S3.E9.m1.43.43.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.48.48.6"></times><apply id="S3.E9.m1.43.43.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.48.48.6"><csymbol cd="ambiguous" id="S3.E9.m1.43.43.1.1.1.1.1.2.2.1.cmml" xref="S3.E9.m1.48.48.6">superscript</csymbol><apply id="S3.E9.m1.43.43.1.1.1.1.1.2.2.2.cmml" xref="S3.E9.m1.48.48.6"><csymbol cd="ambiguous" id="S3.E9.m1.43.43.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E9.m1.48.48.6">subscript</csymbol><ci id="S3.E9.m1.6.6.6.6.4.4.cmml" xref="S3.E9.m1.6.6.6.6.4.4">𝑅</ci><ci id="S3.E9.m1.7.7.7.7.5.5.1.cmml" xref="S3.E9.m1.7.7.7.7.5.5.1">𝑛</ci></apply><ci id="S3.E9.m1.8.8.8.8.6.6.1.cmml" xref="S3.E9.m1.8.8.8.8.6.6.1">𝐿</ci></apply><apply id="S3.E9.m1.43.43.1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.48.48.6"><csymbol cd="ambiguous" id="S3.E9.m1.43.43.1.1.1.1.1.2.3.1.cmml" xref="S3.E9.m1.48.48.6">superscript</csymbol><apply id="S3.E9.m1.43.43.1.1.1.1.1.2.3.2.cmml" xref="S3.E9.m1.48.48.6"><csymbol cd="ambiguous" id="S3.E9.m1.43.43.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E9.m1.48.48.6">subscript</csymbol><ci id="S3.E9.m1.9.9.9.9.7.7.cmml" xref="S3.E9.m1.9.9.9.9.7.7">𝑊</ci><ci id="S3.E9.m1.10.10.10.10.8.8.1.cmml" xref="S3.E9.m1.10.10.10.10.8.8.1">𝑐</ci></apply><ci id="S3.E9.m1.11.11.11.11.9.9.1.cmml" xref="S3.E9.m1.11.11.11.11.9.9.1">′</ci></apply></apply><apply id="S3.E9.m1.43.43.1.1.1.1.1.3.cmml" xref="S3.E9.m1.48.48.6"><csymbol cd="ambiguous" id="S3.E9.m1.43.43.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.48.48.6">superscript</csymbol><apply id="S3.E9.m1.43.43.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.48.48.6"><csymbol cd="ambiguous" id="S3.E9.m1.43.43.1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.48.48.6">subscript</csymbol><ci id="S3.E9.m1.13.13.13.13.11.11.cmml" xref="S3.E9.m1.13.13.13.13.11.11">𝑏</ci><ci id="S3.E9.m1.14.14.14.14.12.12.1.cmml" xref="S3.E9.m1.14.14.14.14.12.12.1">𝑐</ci></apply><ci id="S3.E9.m1.15.15.15.15.13.13.1.cmml" xref="S3.E9.m1.15.15.15.15.13.13.1">′</ci></apply></apply><apply id="S3.E9.m1.43.43.1.1.4.cmml" xref="S3.E9.m1.48.48.6"><csymbol cd="ambiguous" id="S3.E9.m1.43.43.1.1.4.1.cmml" xref="S3.E9.m1.46.46.4.43.17.15.16">subscript</csymbol><ci id="S3.E9.m1.17.17.17.1.1.1.cmml" xref="S3.E9.m1.17.17.17.1.1.1">𝐿</ci><ci id="S3.E9.m1.18.18.18.2.2.2.1.cmml" xref="S3.E9.m1.18.18.18.2.2.2.1">𝑐</ci></apply></apply></apply><apply id="S3.E9.m1.45.45.3c.cmml" xref="S3.E9.m1.48.48.6"><eq id="S3.E9.m1.19.19.19.3.1.1.cmml" xref="S3.E9.m1.19.19.19.3.1.1"></eq><share href="https://arxiv.org/html/2405.17959v1#S3.E9.m1.43.43.1.1.cmml" id="S3.E9.m1.45.45.3d.cmml" xref="S3.E9.m1.46.46.4.43.17.15.16"></share><apply id="S3.E9.m1.45.45.3.3.cmml" xref="S3.E9.m1.48.48.6"><plus id="S3.E9.m1.29.29.29.13.11.11.cmml" xref="S3.E9.m1.29.29.29.13.11.11"></plus><apply id="S3.E9.m1.45.45.3.3.4.cmml" xref="S3.E9.m1.48.48.6"><minus id="S3.E9.m1.20.20.20.4.2.2.cmml" xref="S3.E9.m1.48.48.6"></minus><apply id="S3.E9.m1.45.45.3.3.4.2.cmml" xref="S3.E9.m1.48.48.6"><apply id="S3.E9.m1.45.45.3.3.4.2.1.cmml" xref="S3.E9.m1.48.48.6"><csymbol cd="ambiguous" id="S3.E9.m1.45.45.3.3.4.2.1.1.cmml" xref="S3.E9.m1.46.46.4.43.17.15.16">superscript</csymbol><apply id="S3.E9.m1.45.45.3.3.4.2.1.2.cmml" xref="S3.E9.m1.48.48.6"><csymbol cd="ambiguous" id="S3.E9.m1.45.45.3.3.4.2.1.2.1.cmml" xref="S3.E9.m1.46.46.4.43.17.15.16">subscript</csymbol><sum id="S3.E9.m1.21.21.21.5.3.3.cmml" xref="S3.E9.m1.21.21.21.5.3.3"></sum><apply id="S3.E9.m1.22.22.22.6.4.4.1.cmml" xref="S3.E9.m1.22.22.22.6.4.4.1"><eq id="S3.E9.m1.22.22.22.6.4.4.1.1.cmml" xref="S3.E9.m1.22.22.22.6.4.4.1.1"></eq><ci id="S3.E9.m1.22.22.22.6.4.4.1.2.cmml" xref="S3.E9.m1.22.22.22.6.4.4.1.2">𝑐</ci><cn id="S3.E9.m1.22.22.22.6.4.4.1.3.cmml" type="integer" xref="S3.E9.m1.22.22.22.6.4.4.1.3">1</cn></apply></apply><apply id="S3.E9.m1.23.23.23.7.5.5.1.2.cmml" xref="S3.E9.m1.23.23.23.7.5.5.1.3"><abs id="S3.E9.m1.23.23.23.7.5.5.1.2.1.cmml" xref="S3.E9.m1.23.23.23.7.5.5.1.3.1"></abs><ci id="S3.E9.m1.23.23.23.7.5.5.1.1.cmml" xref="S3.E9.m1.23.23.23.7.5.5.1.1">𝐶</ci></apply></apply><apply id="S3.E9.m1.45.45.3.3.4.2.2.cmml" xref="S3.E9.m1.48.48.6"><times id="S3.E9.m1.45.45.3.3.4.2.2.1.cmml" xref="S3.E9.m1.46.46.4.43.17.15.16"></times><apply id="S3.E9.m1.45.45.3.3.4.2.2.2.cmml" xref="S3.E9.m1.48.48.6"><csymbol cd="ambiguous" id="S3.E9.m1.45.45.3.3.4.2.2.2.1.cmml" xref="S3.E9.m1.46.46.4.43.17.15.16">subscript</csymbol><ci id="S3.E9.m1.24.24.24.8.6.6.cmml" xref="S3.E9.m1.24.24.24.8.6.6">𝑐</ci><apply id="S3.E9.m1.25.25.25.9.7.7.1.cmml" xref="S3.E9.m1.25.25.25.9.7.7.1"><plus id="S3.E9.m1.25.25.25.9.7.7.1.1.cmml" xref="S3.E9.m1.25.25.25.9.7.7.1.1"></plus><ci id="S3.E9.m1.25.25.25.9.7.7.1.2.cmml" xref="S3.E9.m1.25.25.25.9.7.7.1.2">𝑛</ci><cn id="S3.E9.m1.25.25.25.9.7.7.1.3.cmml" type="integer" xref="S3.E9.m1.25.25.25.9.7.7.1.3">1</cn></apply></apply><apply id="S3.E9.m1.45.45.3.3.4.2.2.3.cmml" xref="S3.E9.m1.48.48.6"><log id="S3.E9.m1.26.26.26.10.8.8.cmml" xref="S3.E9.m1.26.26.26.10.8.8"></log><apply id="S3.E9.m1.45.45.3.3.4.2.2.3.2.cmml" xref="S3.E9.m1.48.48.6"><csymbol cd="ambiguous" id="S3.E9.m1.45.45.3.3.4.2.2.3.2.1.cmml" xref="S3.E9.m1.46.46.4.43.17.15.16">subscript</csymbol><apply id="S3.E9.m1.27.27.27.11.9.9.cmml" xref="S3.E9.m1.27.27.27.11.9.9"><ci id="S3.E9.m1.27.27.27.11.9.9.1.cmml" xref="S3.E9.m1.27.27.27.11.9.9.1">^</ci><ci id="S3.E9.m1.27.27.27.11.9.9.2.cmml" xref="S3.E9.m1.27.27.27.11.9.9.2">𝑐</ci></apply><apply id="S3.E9.m1.28.28.28.12.10.10.1.cmml" xref="S3.E9.m1.28.28.28.12.10.10.1"><plus id="S3.E9.m1.28.28.28.12.10.10.1.1.cmml" xref="S3.E9.m1.28.28.28.12.10.10.1.1"></plus><ci id="S3.E9.m1.28.28.28.12.10.10.1.2.cmml" xref="S3.E9.m1.28.28.28.12.10.10.1.2">𝑛</ci><cn id="S3.E9.m1.28.28.28.12.10.10.1.3.cmml" type="integer" xref="S3.E9.m1.28.28.28.12.10.10.1.3">1</cn></apply></apply></apply></apply></apply></apply><apply id="S3.E9.m1.45.45.3.3.2.cmml" xref="S3.E9.m1.48.48.6"><times id="S3.E9.m1.45.45.3.3.2.3.cmml" xref="S3.E9.m1.46.46.4.43.17.15.16"></times><apply id="S3.E9.m1.44.44.2.2.1.1.1.1.cmml" xref="S3.E9.m1.48.48.6"><minus id="S3.E9.m1.32.32.32.16.14.14.cmml" xref="S3.E9.m1.32.32.32.16.14.14"></minus><cn id="S3.E9.m1.31.31.31.15.13.13.cmml" type="integer" xref="S3.E9.m1.31.31.31.15.13.13">1</cn><apply id="S3.E9.m1.44.44.2.2.1.1.1.1.3.cmml" xref="S3.E9.m1.48.48.6"><csymbol cd="ambiguous" id="S3.E9.m1.44.44.2.2.1.1.1.1.3.1.cmml" xref="S3.E9.m1.48.48.6">subscript</csymbol><ci id="S3.E9.m1.33.33.33.17.15.15.cmml" xref="S3.E9.m1.33.33.33.17.15.15">𝑐</ci><apply id="S3.E9.m1.34.34.34.18.16.16.1.cmml" xref="S3.E9.m1.34.34.34.18.16.16.1"><plus id="S3.E9.m1.34.34.34.18.16.16.1.1.cmml" xref="S3.E9.m1.34.34.34.18.16.16.1.1"></plus><ci id="S3.E9.m1.34.34.34.18.16.16.1.2.cmml" xref="S3.E9.m1.34.34.34.18.16.16.1.2">𝑛</ci><cn id="S3.E9.m1.34.34.34.18.16.16.1.3.cmml" type="integer" xref="S3.E9.m1.34.34.34.18.16.16.1.3">1</cn></apply></apply></apply><apply id="S3.E9.m1.45.45.3.3.2.2.2.cmml" xref="S3.E9.m1.48.48.6"><log id="S3.E9.m1.36.36.36.20.18.18.cmml" xref="S3.E9.m1.36.36.36.20.18.18"></log><apply id="S3.E9.m1.45.45.3.3.2.2.1.1.1.cmml" xref="S3.E9.m1.48.48.6"><minus id="S3.E9.m1.39.39.39.23.21.21.cmml" xref="S3.E9.m1.39.39.39.23.21.21"></minus><cn id="S3.E9.m1.38.38.38.22.20.20.cmml" type="integer" xref="S3.E9.m1.38.38.38.22.20.20">1</cn><apply id="S3.E9.m1.45.45.3.3.2.2.1.1.1.3.cmml" xref="S3.E9.m1.48.48.6"><csymbol cd="ambiguous" id="S3.E9.m1.45.45.3.3.2.2.1.1.1.3.1.cmml" xref="S3.E9.m1.48.48.6">subscript</csymbol><apply id="S3.E9.m1.40.40.40.24.22.22.cmml" xref="S3.E9.m1.40.40.40.24.22.22"><ci id="S3.E9.m1.40.40.40.24.22.22.1.cmml" xref="S3.E9.m1.40.40.40.24.22.22.1">^</ci><ci id="S3.E9.m1.40.40.40.24.22.22.2.cmml" xref="S3.E9.m1.40.40.40.24.22.22.2">𝑐</ci></apply><apply id="S3.E9.m1.41.41.41.25.23.23.1.cmml" xref="S3.E9.m1.41.41.41.25.23.23.1"><plus id="S3.E9.m1.41.41.41.25.23.23.1.1.cmml" xref="S3.E9.m1.41.41.41.25.23.23.1.1"></plus><ci id="S3.E9.m1.41.41.41.25.23.23.1.2.cmml" xref="S3.E9.m1.41.41.41.25.23.23.1.2">𝑛</ci><cn id="S3.E9.m1.41.41.41.25.23.23.1.3.cmml" type="integer" xref="S3.E9.m1.41.41.41.25.23.23.1.3">1</cn></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.48c">\begin{split}\hat{c}_{n+1}&amp;=\sigma(R_{n}^{L}W_{c}^{\prime}+b_{c}^{\prime})\\
L_{c}&amp;=-\sum_{c=1}^{|C|}c_{n+1}\log\hat{c}_{n+1}+(1-c_{n+1})\log(1-\hat{c}_{n+%
1})\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.48d">start_ROW start_CELL over^ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT end_CELL start_CELL = italic_σ ( italic_R start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT + italic_b start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) end_CELL end_ROW start_ROW start_CELL italic_L start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_CELL start_CELL = - ∑ start_POSTSUBSCRIPT italic_c = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_C | end_POSTSUPERSCRIPT italic_c start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT roman_log over^ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT + ( 1 - italic_c start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT ) roman_log ( 1 - over^ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p3.7">The final loss function comprises the sum of the sequence loss and the multimodal loss, as in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S3.E10" title="Equation 10 ‣ 3.4 Prediction module ‣ 3 Proposed method ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">10</span></a>. <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS4.p3.7.m1.1"><semantics id="S3.SS4.p3.7.m1.1a"><mi id="S3.SS4.p3.7.m1.1.1" xref="S3.SS4.p3.7.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.7.m1.1b"><ci id="S3.SS4.p3.7.m1.1.1.cmml" xref="S3.SS4.p3.7.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.7.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.7.m1.1d">italic_λ</annotation></semantics></math> is a hyperparameter that adjusts for the influence of each loss function.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="L=L_{id}+\lambda\sum_{j\in{v,t,c}}L_{j}" class="ltx_Math" display="block" id="S3.E10.m1.3"><semantics id="S3.E10.m1.3a"><mrow id="S3.E10.m1.3.4" xref="S3.E10.m1.3.4.cmml"><mi id="S3.E10.m1.3.4.2" xref="S3.E10.m1.3.4.2.cmml">L</mi><mo id="S3.E10.m1.3.4.1" xref="S3.E10.m1.3.4.1.cmml">=</mo><mrow id="S3.E10.m1.3.4.3" xref="S3.E10.m1.3.4.3.cmml"><msub id="S3.E10.m1.3.4.3.2" xref="S3.E10.m1.3.4.3.2.cmml"><mi id="S3.E10.m1.3.4.3.2.2" xref="S3.E10.m1.3.4.3.2.2.cmml">L</mi><mrow id="S3.E10.m1.3.4.3.2.3" xref="S3.E10.m1.3.4.3.2.3.cmml"><mi id="S3.E10.m1.3.4.3.2.3.2" xref="S3.E10.m1.3.4.3.2.3.2.cmml">i</mi><mo id="S3.E10.m1.3.4.3.2.3.1" xref="S3.E10.m1.3.4.3.2.3.1.cmml">⁢</mo><mi id="S3.E10.m1.3.4.3.2.3.3" xref="S3.E10.m1.3.4.3.2.3.3.cmml">d</mi></mrow></msub><mo id="S3.E10.m1.3.4.3.1" xref="S3.E10.m1.3.4.3.1.cmml">+</mo><mrow id="S3.E10.m1.3.4.3.3" xref="S3.E10.m1.3.4.3.3.cmml"><mi id="S3.E10.m1.3.4.3.3.2" xref="S3.E10.m1.3.4.3.3.2.cmml">λ</mi><mo id="S3.E10.m1.3.4.3.3.1" xref="S3.E10.m1.3.4.3.3.1.cmml">⁢</mo><mrow id="S3.E10.m1.3.4.3.3.3" xref="S3.E10.m1.3.4.3.3.3.cmml"><munder id="S3.E10.m1.3.4.3.3.3.1" xref="S3.E10.m1.3.4.3.3.3.1.cmml"><mo id="S3.E10.m1.3.4.3.3.3.1.2" movablelimits="false" xref="S3.E10.m1.3.4.3.3.3.1.2.cmml">∑</mo><mrow id="S3.E10.m1.3.3.3" xref="S3.E10.m1.3.3.3.cmml"><mi id="S3.E10.m1.3.3.3.5" xref="S3.E10.m1.3.3.3.5.cmml">j</mi><mo id="S3.E10.m1.3.3.3.4" xref="S3.E10.m1.3.3.3.4.cmml">∈</mo><mrow id="S3.E10.m1.3.3.3.6.2" xref="S3.E10.m1.3.3.3.6.1.cmml"><mi id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml">v</mi><mo id="S3.E10.m1.3.3.3.6.2.1" xref="S3.E10.m1.3.3.3.6.1.cmml">,</mo><mi id="S3.E10.m1.2.2.2.2" xref="S3.E10.m1.2.2.2.2.cmml">t</mi><mo id="S3.E10.m1.3.3.3.6.2.2" xref="S3.E10.m1.3.3.3.6.1.cmml">,</mo><mi id="S3.E10.m1.3.3.3.3" xref="S3.E10.m1.3.3.3.3.cmml">c</mi></mrow></mrow></munder><msub id="S3.E10.m1.3.4.3.3.3.2" xref="S3.E10.m1.3.4.3.3.3.2.cmml"><mi id="S3.E10.m1.3.4.3.3.3.2.2" xref="S3.E10.m1.3.4.3.3.3.2.2.cmml">L</mi><mi id="S3.E10.m1.3.4.3.3.3.2.3" xref="S3.E10.m1.3.4.3.3.3.2.3.cmml">j</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.3b"><apply id="S3.E10.m1.3.4.cmml" xref="S3.E10.m1.3.4"><eq id="S3.E10.m1.3.4.1.cmml" xref="S3.E10.m1.3.4.1"></eq><ci id="S3.E10.m1.3.4.2.cmml" xref="S3.E10.m1.3.4.2">𝐿</ci><apply id="S3.E10.m1.3.4.3.cmml" xref="S3.E10.m1.3.4.3"><plus id="S3.E10.m1.3.4.3.1.cmml" xref="S3.E10.m1.3.4.3.1"></plus><apply id="S3.E10.m1.3.4.3.2.cmml" xref="S3.E10.m1.3.4.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.3.4.3.2.1.cmml" xref="S3.E10.m1.3.4.3.2">subscript</csymbol><ci id="S3.E10.m1.3.4.3.2.2.cmml" xref="S3.E10.m1.3.4.3.2.2">𝐿</ci><apply id="S3.E10.m1.3.4.3.2.3.cmml" xref="S3.E10.m1.3.4.3.2.3"><times id="S3.E10.m1.3.4.3.2.3.1.cmml" xref="S3.E10.m1.3.4.3.2.3.1"></times><ci id="S3.E10.m1.3.4.3.2.3.2.cmml" xref="S3.E10.m1.3.4.3.2.3.2">𝑖</ci><ci id="S3.E10.m1.3.4.3.2.3.3.cmml" xref="S3.E10.m1.3.4.3.2.3.3">𝑑</ci></apply></apply><apply id="S3.E10.m1.3.4.3.3.cmml" xref="S3.E10.m1.3.4.3.3"><times id="S3.E10.m1.3.4.3.3.1.cmml" xref="S3.E10.m1.3.4.3.3.1"></times><ci id="S3.E10.m1.3.4.3.3.2.cmml" xref="S3.E10.m1.3.4.3.3.2">𝜆</ci><apply id="S3.E10.m1.3.4.3.3.3.cmml" xref="S3.E10.m1.3.4.3.3.3"><apply id="S3.E10.m1.3.4.3.3.3.1.cmml" xref="S3.E10.m1.3.4.3.3.3.1"><csymbol cd="ambiguous" id="S3.E10.m1.3.4.3.3.3.1.1.cmml" xref="S3.E10.m1.3.4.3.3.3.1">subscript</csymbol><sum id="S3.E10.m1.3.4.3.3.3.1.2.cmml" xref="S3.E10.m1.3.4.3.3.3.1.2"></sum><apply id="S3.E10.m1.3.3.3.cmml" xref="S3.E10.m1.3.3.3"><in id="S3.E10.m1.3.3.3.4.cmml" xref="S3.E10.m1.3.3.3.4"></in><ci id="S3.E10.m1.3.3.3.5.cmml" xref="S3.E10.m1.3.3.3.5">𝑗</ci><list id="S3.E10.m1.3.3.3.6.1.cmml" xref="S3.E10.m1.3.3.3.6.2"><ci id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1">𝑣</ci><ci id="S3.E10.m1.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2">𝑡</ci><ci id="S3.E10.m1.3.3.3.3.cmml" xref="S3.E10.m1.3.3.3.3">𝑐</ci></list></apply></apply><apply id="S3.E10.m1.3.4.3.3.3.2.cmml" xref="S3.E10.m1.3.4.3.3.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.3.4.3.3.3.2.1.cmml" xref="S3.E10.m1.3.4.3.3.3.2">subscript</csymbol><ci id="S3.E10.m1.3.4.3.3.3.2.2.cmml" xref="S3.E10.m1.3.4.3.3.3.2.2">𝐿</ci><ci id="S3.E10.m1.3.4.3.3.3.2.3.cmml" xref="S3.E10.m1.3.4.3.3.3.2.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.3c">L=L_{id}+\lambda\sum_{j\in{v,t,c}}L_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.3d">italic_L = italic_L start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT + italic_λ ∑ start_POSTSUBSCRIPT italic_j ∈ italic_v , italic_t , italic_c end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets and evaluation metrics</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.2">We used the Video Games and Clothing&amp;Shoes datasets provided by Amazon to evaluate the proposed model.
The Clothing&amp;Shoes dataset contained three categories: Boys&amp;Girls, Women, and Men.
To consider user trends, we selected only user transaction data from 2016 to 2017.
We removed items that did not have multimodal features such as images, descriptions, and categories.
In addition, users and items with fewer than 5 sequential interactions were excluded.
To use multimodal data, we utilized the pre-trained VGG and BERT to obtain 4096 and 768 dimensional representations for image and text, respectively, and categorical data were converted into a multi-label form.
Table <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4.T1" title="Table 1 ‣ 4.1 Datasets and evaluation metrics ‣ 4 Experiments ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">1</span></a> summarizes the dataset used in the experiment.
In an experimental evaluation method, the proposed model was evaluated using a leave-one-out strategy as in previous studies <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib9" title="">2018</a>; Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib17" title="">2019</a>)</cite>.
The last item in the user-purchased sequence is used as the test data, and the item before the last one is used as the validation data.
We used Recall@k and NDCG@k as the evaluation metrics as shown in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4.E11" title="Equation 11 ‣ 4.1 Datasets and evaluation metrics ‣ 4 Experiments ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">11</span></a>.
Recall@k indicates whether the user includes recommended item k among the items of interest.
NDCG@k applies weight values differently in the order of preference, assigning higher weights to higher orders (<math alttext="G_{i}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><msub id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">G</mi><mi id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝐺</ci><ci id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">G_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="G_{i}^{ideal}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><msubsup id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2.2" xref="S4.SS1.p1.2.m2.1.1.2.2.cmml">G</mi><mi id="S4.SS1.p1.2.m2.1.1.2.3" xref="S4.SS1.p1.2.m2.1.1.2.3.cmml">i</mi><mrow id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml"><mi id="S4.SS1.p1.2.m2.1.1.3.2" xref="S4.SS1.p1.2.m2.1.1.3.2.cmml">i</mi><mo id="S4.SS1.p1.2.m2.1.1.3.1" xref="S4.SS1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.2.m2.1.1.3.3" xref="S4.SS1.p1.2.m2.1.1.3.3.cmml">d</mi><mo id="S4.SS1.p1.2.m2.1.1.3.1a" xref="S4.SS1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.2.m2.1.1.3.4" xref="S4.SS1.p1.2.m2.1.1.3.4.cmml">e</mi><mo id="S4.SS1.p1.2.m2.1.1.3.1b" xref="S4.SS1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.2.m2.1.1.3.5" xref="S4.SS1.p1.2.m2.1.1.3.5.cmml">a</mi><mo id="S4.SS1.p1.2.m2.1.1.3.1c" xref="S4.SS1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.2.m2.1.1.3.6" xref="S4.SS1.p1.2.m2.1.1.3.6.cmml">l</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">superscript</csymbol><apply id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2.2">𝐺</ci><ci id="S4.SS1.p1.2.m2.1.1.2.3.cmml" xref="S4.SS1.p1.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3"><times id="S4.SS1.p1.2.m2.1.1.3.1.cmml" xref="S4.SS1.p1.2.m2.1.1.3.1"></times><ci id="S4.SS1.p1.2.m2.1.1.3.2.cmml" xref="S4.SS1.p1.2.m2.1.1.3.2">𝑖</ci><ci id="S4.SS1.p1.2.m2.1.1.3.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3">𝑑</ci><ci id="S4.SS1.p1.2.m2.1.1.3.4.cmml" xref="S4.SS1.p1.2.m2.1.1.3.4">𝑒</ci><ci id="S4.SS1.p1.2.m2.1.1.3.5.cmml" xref="S4.SS1.p1.2.m2.1.1.3.5">𝑎</ci><ci id="S4.SS1.p1.2.m2.1.1.3.6.cmml" xref="S4.SS1.p1.2.m2.1.1.3.6">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">G_{i}^{ideal}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">italic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i italic_d italic_e italic_a italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> denote a relevant item and an ideal sequence of relevant items, respectively).
In our experiments, the value of k was set to 10 and 20 to compare the results of Recall@k and NDCG@k.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T1.2.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S4.T1.3.2" style="font-size:90%;">Statistics of datasets for experiments.</span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S4.T1.4" style="width:433.6pt;height:142.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(52.9pt,-17.4pt) scale(1.3230181778753,1.3230181778753) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.4.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S4.T1.4.1.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.4.1.1.1.2">Video Games</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.4.1.1.1.3">Boys&amp;Girls</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.4.1.1.1.4">Women</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.4.1.1.1.5">Men</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.4.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.4.1.2.1.1">#Users</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.2.1.2">4,940</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.2.1.3">1,405</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.2.1.4">105,558</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.2.1.5">51,892</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.4.1.3.2.1">#Items</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.3.2.2">11,002</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.3.2.3">15,603</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.3.2.4">122,701</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.3.2.5">56,325</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.4.1.4.3.1">#Avg. Actions/User</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.4.3.2">7.4</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.4.3.3">6.8</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.4.3.4">7.7</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.4.3.5">7.4</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.4.1.5.4.1">#Avg. Actions/Item</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.5.4.2">16.3</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.5.4.3">35</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.5.4.4">22.4</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.5.4.5">35.8</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" id="S4.T1.4.1.6.5.1">#Interactions</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.4.1.6.5.2">36,752</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.4.1.6.5.3">9,587</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.4.1.6.5.4">810,245</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.4.1.6.5.5">383,148</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S4.SS1.p2">
<table class="ltx_equation ltx_eqn_table" id="S4.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\begin{split}Recall@k=\frac{\#\mathrm{~{}of~{}recommendations~{}that~{}are~{}%
relevant}}{\#\mathrm{~{}of~{}all~{}possible~{}relevant~{}items}}\\
NDCG@k=\frac{\mathrm{DCG@k}}{\mathrm{IDCG@k}}\\
where~{}DCG@k=\sum_{i=1}^{k}\frac{G_{i}}{log_{2}(i+1)},IDCG@k=\sum_{i=1}^{k_{%
ideal}}\frac{G_{i}^{ideal}}{log_{2}(i+1)}\end{split}" class="ltx_Math" display="block" id="S4.E11.m1.49"><semantics id="S4.E11.m1.49a"><mtable displaystyle="true" id="S4.E11.m1.49.49.4" rowspacing="0pt"><mtr id="S4.E11.m1.49.49.4a"><mtd class="ltx_align_right" columnalign="right" id="S4.E11.m1.49.49.4b"><mrow id="S4.E11.m1.10.10.10.10.10"><mrow id="S4.E11.m1.10.10.10.10.10.11"><mi id="S4.E11.m1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.cmml">R</mi><mo id="S4.E11.m1.10.10.10.10.10.11.1" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.2.2.2.2.2.2" xref="S4.E11.m1.2.2.2.2.2.2.cmml">e</mi><mo id="S4.E11.m1.10.10.10.10.10.11.1a" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.3.3.3.3.3.3" xref="S4.E11.m1.3.3.3.3.3.3.cmml">c</mi><mo id="S4.E11.m1.10.10.10.10.10.11.1b" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.4.4.4.4.4.4" xref="S4.E11.m1.4.4.4.4.4.4.cmml">a</mi><mo id="S4.E11.m1.10.10.10.10.10.11.1c" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.5.5.5.5.5.5" xref="S4.E11.m1.5.5.5.5.5.5.cmml">l</mi><mo id="S4.E11.m1.10.10.10.10.10.11.1d" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.6.6.6.6.6.6" xref="S4.E11.m1.6.6.6.6.6.6.cmml">l</mi><mo id="S4.E11.m1.10.10.10.10.10.11.1e" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.7.7.7.7.7.7" mathvariant="normal" xref="S4.E11.m1.7.7.7.7.7.7.cmml">@</mi><mo id="S4.E11.m1.10.10.10.10.10.11.1f" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.8.8.8.8.8.8" xref="S4.E11.m1.8.8.8.8.8.8.cmml">k</mi></mrow><mo id="S4.E11.m1.9.9.9.9.9.9" xref="S4.E11.m1.9.9.9.9.9.9.cmml">=</mo><mfrac id="S4.E11.m1.10.10.10.10.10.10" xref="S4.E11.m1.10.10.10.10.10.10.cmml"><mrow id="S4.E11.m1.10.10.10.10.10.10.2" xref="S4.E11.m1.10.10.10.10.10.10.2.cmml"><mi id="S4.E11.m1.10.10.10.10.10.10.2.2" mathvariant="normal" xref="S4.E11.m1.10.10.10.10.10.10.2.2.cmml">#</mi><mo id="S4.E11.m1.10.10.10.10.10.10.2.1" lspace="0.330em" xref="S4.E11.m1.10.10.10.10.10.10.2.1.cmml">⁢</mo><mi id="S4.E11.m1.10.10.10.10.10.10.2.3" xref="S4.E11.m1.10.10.10.10.10.10.2.3.cmml">of</mi><mo id="S4.E11.m1.10.10.10.10.10.10.2.1a" lspace="0.330em" xref="S4.E11.m1.10.10.10.10.10.10.2.1.cmml">⁢</mo><mi id="S4.E11.m1.10.10.10.10.10.10.2.4" xref="S4.E11.m1.10.10.10.10.10.10.2.4.cmml">recommendations</mi><mo id="S4.E11.m1.10.10.10.10.10.10.2.1b" lspace="0.330em" xref="S4.E11.m1.10.10.10.10.10.10.2.1.cmml">⁢</mo><mi id="S4.E11.m1.10.10.10.10.10.10.2.5" xref="S4.E11.m1.10.10.10.10.10.10.2.5.cmml">that</mi><mo id="S4.E11.m1.10.10.10.10.10.10.2.1c" lspace="0.330em" xref="S4.E11.m1.10.10.10.10.10.10.2.1.cmml">⁢</mo><mi id="S4.E11.m1.10.10.10.10.10.10.2.6" xref="S4.E11.m1.10.10.10.10.10.10.2.6.cmml">are</mi><mo id="S4.E11.m1.10.10.10.10.10.10.2.1d" lspace="0.330em" xref="S4.E11.m1.10.10.10.10.10.10.2.1.cmml">⁢</mo><mi id="S4.E11.m1.10.10.10.10.10.10.2.7" xref="S4.E11.m1.10.10.10.10.10.10.2.7.cmml">relevant</mi></mrow><mrow id="S4.E11.m1.10.10.10.10.10.10.3" xref="S4.E11.m1.10.10.10.10.10.10.3.cmml"><mi id="S4.E11.m1.10.10.10.10.10.10.3.2" mathvariant="normal" xref="S4.E11.m1.10.10.10.10.10.10.3.2.cmml">#</mi><mo id="S4.E11.m1.10.10.10.10.10.10.3.1" lspace="0.330em" xref="S4.E11.m1.10.10.10.10.10.10.3.1.cmml">⁢</mo><mi id="S4.E11.m1.10.10.10.10.10.10.3.3" xref="S4.E11.m1.10.10.10.10.10.10.3.3.cmml">of</mi><mo id="S4.E11.m1.10.10.10.10.10.10.3.1a" lspace="0.330em" xref="S4.E11.m1.10.10.10.10.10.10.3.1.cmml">⁢</mo><mi id="S4.E11.m1.10.10.10.10.10.10.3.4" xref="S4.E11.m1.10.10.10.10.10.10.3.4.cmml">all</mi><mo id="S4.E11.m1.10.10.10.10.10.10.3.1b" lspace="0.330em" xref="S4.E11.m1.10.10.10.10.10.10.3.1.cmml">⁢</mo><mi id="S4.E11.m1.10.10.10.10.10.10.3.5" xref="S4.E11.m1.10.10.10.10.10.10.3.5.cmml">possible</mi><mo id="S4.E11.m1.10.10.10.10.10.10.3.1c" lspace="0.330em" xref="S4.E11.m1.10.10.10.10.10.10.3.1.cmml">⁢</mo><mi id="S4.E11.m1.10.10.10.10.10.10.3.6" xref="S4.E11.m1.10.10.10.10.10.10.3.6.cmml">relevant</mi><mo id="S4.E11.m1.10.10.10.10.10.10.3.1d" lspace="0.330em" xref="S4.E11.m1.10.10.10.10.10.10.3.1.cmml">⁢</mo><mi id="S4.E11.m1.10.10.10.10.10.10.3.7" xref="S4.E11.m1.10.10.10.10.10.10.3.7.cmml">items</mi></mrow></mfrac></mrow></mtd></mtr><mtr id="S4.E11.m1.49.49.4c"><mtd class="ltx_align_right" columnalign="right" id="S4.E11.m1.49.49.4d"><mrow id="S4.E11.m1.18.18.18.8.8"><mrow id="S4.E11.m1.18.18.18.8.8.9"><mi id="S4.E11.m1.11.11.11.1.1.1" xref="S4.E11.m1.11.11.11.1.1.1.cmml">N</mi><mo id="S4.E11.m1.18.18.18.8.8.9.1" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.12.12.12.2.2.2" xref="S4.E11.m1.12.12.12.2.2.2.cmml">D</mi><mo id="S4.E11.m1.18.18.18.8.8.9.1a" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.13.13.13.3.3.3" xref="S4.E11.m1.13.13.13.3.3.3.cmml">C</mi><mo id="S4.E11.m1.18.18.18.8.8.9.1b" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.14.14.14.4.4.4" xref="S4.E11.m1.14.14.14.4.4.4.cmml">G</mi><mo id="S4.E11.m1.18.18.18.8.8.9.1c" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.15.15.15.5.5.5" mathvariant="normal" xref="S4.E11.m1.15.15.15.5.5.5.cmml">@</mi><mo id="S4.E11.m1.18.18.18.8.8.9.1d" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.16.16.16.6.6.6" xref="S4.E11.m1.16.16.16.6.6.6.cmml">k</mi></mrow><mo id="S4.E11.m1.17.17.17.7.7.7" xref="S4.E11.m1.17.17.17.7.7.7.cmml">=</mo><mfrac id="S4.E11.m1.18.18.18.8.8.8" xref="S4.E11.m1.18.18.18.8.8.8.cmml"><mrow id="S4.E11.m1.18.18.18.8.8.8.2" xref="S4.E11.m1.18.18.18.8.8.8.2.cmml"><mi id="S4.E11.m1.18.18.18.8.8.8.2.2" xref="S4.E11.m1.18.18.18.8.8.8.2.2.cmml">DCG</mi><mo id="S4.E11.m1.18.18.18.8.8.8.2.1" xref="S4.E11.m1.18.18.18.8.8.8.2.1.cmml">⁢</mo><mi id="S4.E11.m1.18.18.18.8.8.8.2.3" mathvariant="normal" xref="S4.E11.m1.18.18.18.8.8.8.2.3.cmml">@</mi><mo id="S4.E11.m1.18.18.18.8.8.8.2.1a" xref="S4.E11.m1.18.18.18.8.8.8.2.1.cmml">⁢</mo><mi id="S4.E11.m1.18.18.18.8.8.8.2.4" mathvariant="normal" xref="S4.E11.m1.18.18.18.8.8.8.2.4.cmml">k</mi></mrow><mrow id="S4.E11.m1.18.18.18.8.8.8.3" xref="S4.E11.m1.18.18.18.8.8.8.3.cmml"><mi id="S4.E11.m1.18.18.18.8.8.8.3.2" xref="S4.E11.m1.18.18.18.8.8.8.3.2.cmml">IDCG</mi><mo id="S4.E11.m1.18.18.18.8.8.8.3.1" xref="S4.E11.m1.18.18.18.8.8.8.3.1.cmml">⁢</mo><mi id="S4.E11.m1.18.18.18.8.8.8.3.3" mathvariant="normal" xref="S4.E11.m1.18.18.18.8.8.8.3.3.cmml">@</mi><mo id="S4.E11.m1.18.18.18.8.8.8.3.1a" xref="S4.E11.m1.18.18.18.8.8.8.3.1.cmml">⁢</mo><mi id="S4.E11.m1.18.18.18.8.8.8.3.4" mathvariant="normal" xref="S4.E11.m1.18.18.18.8.8.8.3.4.cmml">k</mi></mrow></mfrac></mrow></mtd></mtr><mtr id="S4.E11.m1.49.49.4e"><mtd class="ltx_align_right" columnalign="right" id="S4.E11.m1.49.49.4f"><mrow id="S4.E11.m1.49.49.4.47.29.29.29"><mrow id="S4.E11.m1.48.48.3.46.28.28.28.1"><mrow id="S4.E11.m1.48.48.3.46.28.28.28.1.1"><mi id="S4.E11.m1.19.19.19.1.1.1" xref="S4.E11.m1.19.19.19.1.1.1.cmml">w</mi><mo id="S4.E11.m1.48.48.3.46.28.28.28.1.1.1" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.20.20.20.2.2.2" xref="S4.E11.m1.20.20.20.2.2.2.cmml">h</mi><mo id="S4.E11.m1.48.48.3.46.28.28.28.1.1.1a" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.21.21.21.3.3.3" xref="S4.E11.m1.21.21.21.3.3.3.cmml">e</mi><mo id="S4.E11.m1.48.48.3.46.28.28.28.1.1.1b" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.22.22.22.4.4.4" xref="S4.E11.m1.22.22.22.4.4.4.cmml">r</mi><mo id="S4.E11.m1.48.48.3.46.28.28.28.1.1.1c" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.23.23.23.5.5.5" xref="S4.E11.m1.23.23.23.5.5.5.cmml">e</mi><mo id="S4.E11.m1.48.48.3.46.28.28.28.1.1.1d" lspace="0.330em" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.24.24.24.6.6.6" xref="S4.E11.m1.24.24.24.6.6.6.cmml">D</mi><mo id="S4.E11.m1.48.48.3.46.28.28.28.1.1.1e" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.25.25.25.7.7.7" xref="S4.E11.m1.25.25.25.7.7.7.cmml">C</mi><mo id="S4.E11.m1.48.48.3.46.28.28.28.1.1.1f" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.26.26.26.8.8.8" xref="S4.E11.m1.26.26.26.8.8.8.cmml">G</mi><mo id="S4.E11.m1.48.48.3.46.28.28.28.1.1.1g" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.27.27.27.9.9.9" mathvariant="normal" xref="S4.E11.m1.27.27.27.9.9.9.cmml">@</mi><mo id="S4.E11.m1.48.48.3.46.28.28.28.1.1.1h" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.28.28.28.10.10.10" xref="S4.E11.m1.28.28.28.10.10.10.cmml">k</mi></mrow><mo id="S4.E11.m1.29.29.29.11.11.11" rspace="0.111em" xref="S4.E11.m1.29.29.29.11.11.11.cmml">=</mo><mrow id="S4.E11.m1.48.48.3.46.28.28.28.1.2"><munderover id="S4.E11.m1.48.48.3.46.28.28.28.1.2.1"><mo id="S4.E11.m1.30.30.30.12.12.12" movablelimits="false" xref="S4.E11.m1.30.30.30.12.12.12.cmml">∑</mo><mrow id="S4.E11.m1.31.31.31.13.13.13.1" xref="S4.E11.m1.31.31.31.13.13.13.1.cmml"><mi id="S4.E11.m1.31.31.31.13.13.13.1.2" xref="S4.E11.m1.31.31.31.13.13.13.1.2.cmml">i</mi><mo id="S4.E11.m1.31.31.31.13.13.13.1.1" xref="S4.E11.m1.31.31.31.13.13.13.1.1.cmml">=</mo><mn id="S4.E11.m1.31.31.31.13.13.13.1.3" xref="S4.E11.m1.31.31.31.13.13.13.1.3.cmml">1</mn></mrow><mi id="S4.E11.m1.32.32.32.14.14.14.1" xref="S4.E11.m1.32.32.32.14.14.14.1.cmml">k</mi></munderover><mfrac id="S4.E11.m1.33.33.33.15.15.15" xref="S4.E11.m1.33.33.33.15.15.15.cmml"><msub id="S4.E11.m1.33.33.33.15.15.15.3" xref="S4.E11.m1.33.33.33.15.15.15.3.cmml"><mi id="S4.E11.m1.33.33.33.15.15.15.3.2" xref="S4.E11.m1.33.33.33.15.15.15.3.2.cmml">G</mi><mi id="S4.E11.m1.33.33.33.15.15.15.3.3" xref="S4.E11.m1.33.33.33.15.15.15.3.3.cmml">i</mi></msub><mrow id="S4.E11.m1.33.33.33.15.15.15.1" xref="S4.E11.m1.33.33.33.15.15.15.1.cmml"><mi id="S4.E11.m1.33.33.33.15.15.15.1.3" xref="S4.E11.m1.33.33.33.15.15.15.1.3.cmml">l</mi><mo id="S4.E11.m1.33.33.33.15.15.15.1.2" xref="S4.E11.m1.33.33.33.15.15.15.1.2.cmml">⁢</mo><mi id="S4.E11.m1.33.33.33.15.15.15.1.4" xref="S4.E11.m1.33.33.33.15.15.15.1.4.cmml">o</mi><mo id="S4.E11.m1.33.33.33.15.15.15.1.2a" xref="S4.E11.m1.33.33.33.15.15.15.1.2.cmml">⁢</mo><msub id="S4.E11.m1.33.33.33.15.15.15.1.5" xref="S4.E11.m1.33.33.33.15.15.15.1.5.cmml"><mi id="S4.E11.m1.33.33.33.15.15.15.1.5.2" xref="S4.E11.m1.33.33.33.15.15.15.1.5.2.cmml">g</mi><mn id="S4.E11.m1.33.33.33.15.15.15.1.5.3" xref="S4.E11.m1.33.33.33.15.15.15.1.5.3.cmml">2</mn></msub><mo id="S4.E11.m1.33.33.33.15.15.15.1.2b" xref="S4.E11.m1.33.33.33.15.15.15.1.2.cmml">⁢</mo><mrow id="S4.E11.m1.33.33.33.15.15.15.1.1.1" xref="S4.E11.m1.33.33.33.15.15.15.1.1.1.1.cmml"><mo id="S4.E11.m1.33.33.33.15.15.15.1.1.1.2" stretchy="false" xref="S4.E11.m1.33.33.33.15.15.15.1.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.33.33.33.15.15.15.1.1.1.1" xref="S4.E11.m1.33.33.33.15.15.15.1.1.1.1.cmml"><mi id="S4.E11.m1.33.33.33.15.15.15.1.1.1.1.2" xref="S4.E11.m1.33.33.33.15.15.15.1.1.1.1.2.cmml">i</mi><mo id="S4.E11.m1.33.33.33.15.15.15.1.1.1.1.1" xref="S4.E11.m1.33.33.33.15.15.15.1.1.1.1.1.cmml">+</mo><mn id="S4.E11.m1.33.33.33.15.15.15.1.1.1.1.3" xref="S4.E11.m1.33.33.33.15.15.15.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E11.m1.33.33.33.15.15.15.1.1.1.3" stretchy="false" xref="S4.E11.m1.33.33.33.15.15.15.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="S4.E11.m1.34.34.34.16.16.16" xref="S4.E11.m1.47.47.2.3.cmml">,</mo><mrow id="S4.E11.m1.49.49.4.47.29.29.29.2"><mrow id="S4.E11.m1.49.49.4.47.29.29.29.2.1"><mi id="S4.E11.m1.35.35.35.17.17.17" xref="S4.E11.m1.35.35.35.17.17.17.cmml">I</mi><mo id="S4.E11.m1.49.49.4.47.29.29.29.2.1.1" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.36.36.36.18.18.18" xref="S4.E11.m1.36.36.36.18.18.18.cmml">D</mi><mo id="S4.E11.m1.49.49.4.47.29.29.29.2.1.1a" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.37.37.37.19.19.19" xref="S4.E11.m1.37.37.37.19.19.19.cmml">C</mi><mo id="S4.E11.m1.49.49.4.47.29.29.29.2.1.1b" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.38.38.38.20.20.20" xref="S4.E11.m1.38.38.38.20.20.20.cmml">G</mi><mo id="S4.E11.m1.49.49.4.47.29.29.29.2.1.1c" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.39.39.39.21.21.21" mathvariant="normal" xref="S4.E11.m1.39.39.39.21.21.21.cmml">@</mi><mo id="S4.E11.m1.49.49.4.47.29.29.29.2.1.1d" xref="S4.E11.m1.47.47.2.3.cmml">⁢</mo><mi id="S4.E11.m1.40.40.40.22.22.22" xref="S4.E11.m1.40.40.40.22.22.22.cmml">k</mi></mrow><mo id="S4.E11.m1.41.41.41.23.23.23" rspace="0.111em" xref="S4.E11.m1.41.41.41.23.23.23.cmml">=</mo><mrow id="S4.E11.m1.49.49.4.47.29.29.29.2.2"><munderover id="S4.E11.m1.49.49.4.47.29.29.29.2.2.1"><mo id="S4.E11.m1.42.42.42.24.24.24" movablelimits="false" xref="S4.E11.m1.42.42.42.24.24.24.cmml">∑</mo><mrow id="S4.E11.m1.43.43.43.25.25.25.1" xref="S4.E11.m1.43.43.43.25.25.25.1.cmml"><mi id="S4.E11.m1.43.43.43.25.25.25.1.2" xref="S4.E11.m1.43.43.43.25.25.25.1.2.cmml">i</mi><mo id="S4.E11.m1.43.43.43.25.25.25.1.1" xref="S4.E11.m1.43.43.43.25.25.25.1.1.cmml">=</mo><mn id="S4.E11.m1.43.43.43.25.25.25.1.3" xref="S4.E11.m1.43.43.43.25.25.25.1.3.cmml">1</mn></mrow><msub id="S4.E11.m1.44.44.44.26.26.26.1" xref="S4.E11.m1.44.44.44.26.26.26.1.cmml"><mi id="S4.E11.m1.44.44.44.26.26.26.1.2" xref="S4.E11.m1.44.44.44.26.26.26.1.2.cmml">k</mi><mrow id="S4.E11.m1.44.44.44.26.26.26.1.3" xref="S4.E11.m1.44.44.44.26.26.26.1.3.cmml"><mi id="S4.E11.m1.44.44.44.26.26.26.1.3.2" xref="S4.E11.m1.44.44.44.26.26.26.1.3.2.cmml">i</mi><mo id="S4.E11.m1.44.44.44.26.26.26.1.3.1" xref="S4.E11.m1.44.44.44.26.26.26.1.3.1.cmml">⁢</mo><mi id="S4.E11.m1.44.44.44.26.26.26.1.3.3" xref="S4.E11.m1.44.44.44.26.26.26.1.3.3.cmml">d</mi><mo id="S4.E11.m1.44.44.44.26.26.26.1.3.1a" xref="S4.E11.m1.44.44.44.26.26.26.1.3.1.cmml">⁢</mo><mi id="S4.E11.m1.44.44.44.26.26.26.1.3.4" xref="S4.E11.m1.44.44.44.26.26.26.1.3.4.cmml">e</mi><mo id="S4.E11.m1.44.44.44.26.26.26.1.3.1b" xref="S4.E11.m1.44.44.44.26.26.26.1.3.1.cmml">⁢</mo><mi id="S4.E11.m1.44.44.44.26.26.26.1.3.5" xref="S4.E11.m1.44.44.44.26.26.26.1.3.5.cmml">a</mi><mo id="S4.E11.m1.44.44.44.26.26.26.1.3.1c" xref="S4.E11.m1.44.44.44.26.26.26.1.3.1.cmml">⁢</mo><mi id="S4.E11.m1.44.44.44.26.26.26.1.3.6" xref="S4.E11.m1.44.44.44.26.26.26.1.3.6.cmml">l</mi></mrow></msub></munderover><mfrac id="S4.E11.m1.45.45.45.27.27.27" xref="S4.E11.m1.45.45.45.27.27.27.cmml"><msubsup id="S4.E11.m1.45.45.45.27.27.27.3" xref="S4.E11.m1.45.45.45.27.27.27.3.cmml"><mi id="S4.E11.m1.45.45.45.27.27.27.3.2.2" xref="S4.E11.m1.45.45.45.27.27.27.3.2.2.cmml">G</mi><mi id="S4.E11.m1.45.45.45.27.27.27.3.2.3" xref="S4.E11.m1.45.45.45.27.27.27.3.2.3.cmml">i</mi><mrow id="S4.E11.m1.45.45.45.27.27.27.3.3" xref="S4.E11.m1.45.45.45.27.27.27.3.3.cmml"><mi id="S4.E11.m1.45.45.45.27.27.27.3.3.2" xref="S4.E11.m1.45.45.45.27.27.27.3.3.2.cmml">i</mi><mo id="S4.E11.m1.45.45.45.27.27.27.3.3.1" xref="S4.E11.m1.45.45.45.27.27.27.3.3.1.cmml">⁢</mo><mi id="S4.E11.m1.45.45.45.27.27.27.3.3.3" xref="S4.E11.m1.45.45.45.27.27.27.3.3.3.cmml">d</mi><mo id="S4.E11.m1.45.45.45.27.27.27.3.3.1a" xref="S4.E11.m1.45.45.45.27.27.27.3.3.1.cmml">⁢</mo><mi id="S4.E11.m1.45.45.45.27.27.27.3.3.4" xref="S4.E11.m1.45.45.45.27.27.27.3.3.4.cmml">e</mi><mo id="S4.E11.m1.45.45.45.27.27.27.3.3.1b" xref="S4.E11.m1.45.45.45.27.27.27.3.3.1.cmml">⁢</mo><mi id="S4.E11.m1.45.45.45.27.27.27.3.3.5" xref="S4.E11.m1.45.45.45.27.27.27.3.3.5.cmml">a</mi><mo id="S4.E11.m1.45.45.45.27.27.27.3.3.1c" xref="S4.E11.m1.45.45.45.27.27.27.3.3.1.cmml">⁢</mo><mi id="S4.E11.m1.45.45.45.27.27.27.3.3.6" xref="S4.E11.m1.45.45.45.27.27.27.3.3.6.cmml">l</mi></mrow></msubsup><mrow id="S4.E11.m1.45.45.45.27.27.27.1" xref="S4.E11.m1.45.45.45.27.27.27.1.cmml"><mi id="S4.E11.m1.45.45.45.27.27.27.1.3" xref="S4.E11.m1.45.45.45.27.27.27.1.3.cmml">l</mi><mo id="S4.E11.m1.45.45.45.27.27.27.1.2" xref="S4.E11.m1.45.45.45.27.27.27.1.2.cmml">⁢</mo><mi id="S4.E11.m1.45.45.45.27.27.27.1.4" xref="S4.E11.m1.45.45.45.27.27.27.1.4.cmml">o</mi><mo id="S4.E11.m1.45.45.45.27.27.27.1.2a" xref="S4.E11.m1.45.45.45.27.27.27.1.2.cmml">⁢</mo><msub id="S4.E11.m1.45.45.45.27.27.27.1.5" xref="S4.E11.m1.45.45.45.27.27.27.1.5.cmml"><mi id="S4.E11.m1.45.45.45.27.27.27.1.5.2" xref="S4.E11.m1.45.45.45.27.27.27.1.5.2.cmml">g</mi><mn id="S4.E11.m1.45.45.45.27.27.27.1.5.3" xref="S4.E11.m1.45.45.45.27.27.27.1.5.3.cmml">2</mn></msub><mo id="S4.E11.m1.45.45.45.27.27.27.1.2b" xref="S4.E11.m1.45.45.45.27.27.27.1.2.cmml">⁢</mo><mrow id="S4.E11.m1.45.45.45.27.27.27.1.1.1" xref="S4.E11.m1.45.45.45.27.27.27.1.1.1.1.cmml"><mo id="S4.E11.m1.45.45.45.27.27.27.1.1.1.2" stretchy="false" xref="S4.E11.m1.45.45.45.27.27.27.1.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.45.45.45.27.27.27.1.1.1.1" xref="S4.E11.m1.45.45.45.27.27.27.1.1.1.1.cmml"><mi id="S4.E11.m1.45.45.45.27.27.27.1.1.1.1.2" xref="S4.E11.m1.45.45.45.27.27.27.1.1.1.1.2.cmml">i</mi><mo id="S4.E11.m1.45.45.45.27.27.27.1.1.1.1.1" xref="S4.E11.m1.45.45.45.27.27.27.1.1.1.1.1.cmml">+</mo><mn id="S4.E11.m1.45.45.45.27.27.27.1.1.1.1.3" xref="S4.E11.m1.45.45.45.27.27.27.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E11.m1.45.45.45.27.27.27.1.1.1.3" stretchy="false" xref="S4.E11.m1.45.45.45.27.27.27.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E11.m1.49b"><apply id="S4.E11.m1.47.47.2.3.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"><csymbol cd="ambiguous" id="S4.E11.m1.47.47.2.3a.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1">formulae-sequence</csymbol><apply id="S4.E11.m1.46.46.1.1.1.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"><and id="S4.E11.m1.46.46.1.1.1a.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"></and><apply id="S4.E11.m1.46.46.1.1.1b.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"><eq id="S4.E11.m1.9.9.9.9.9.9.cmml" xref="S4.E11.m1.9.9.9.9.9.9"></eq><apply id="S4.E11.m1.46.46.1.1.1.2.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"><times id="S4.E11.m1.46.46.1.1.1.2.1.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"></times><ci id="S4.E11.m1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1">𝑅</ci><ci id="S4.E11.m1.2.2.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2.2.2">𝑒</ci><ci id="S4.E11.m1.3.3.3.3.3.3.cmml" xref="S4.E11.m1.3.3.3.3.3.3">𝑐</ci><ci id="S4.E11.m1.4.4.4.4.4.4.cmml" xref="S4.E11.m1.4.4.4.4.4.4">𝑎</ci><ci id="S4.E11.m1.5.5.5.5.5.5.cmml" xref="S4.E11.m1.5.5.5.5.5.5">𝑙</ci><ci id="S4.E11.m1.6.6.6.6.6.6.cmml" xref="S4.E11.m1.6.6.6.6.6.6">𝑙</ci><ci id="S4.E11.m1.7.7.7.7.7.7.cmml" xref="S4.E11.m1.7.7.7.7.7.7">@</ci><ci id="S4.E11.m1.8.8.8.8.8.8.cmml" xref="S4.E11.m1.8.8.8.8.8.8">𝑘</ci></apply><apply id="S4.E11.m1.46.46.1.1.1.4.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"><times id="S4.E11.m1.46.46.1.1.1.4.1.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"></times><apply id="S4.E11.m1.10.10.10.10.10.10.cmml" xref="S4.E11.m1.10.10.10.10.10.10"><divide id="S4.E11.m1.10.10.10.10.10.10.1.cmml" xref="S4.E11.m1.10.10.10.10.10.10"></divide><apply id="S4.E11.m1.10.10.10.10.10.10.2.cmml" xref="S4.E11.m1.10.10.10.10.10.10.2"><times id="S4.E11.m1.10.10.10.10.10.10.2.1.cmml" xref="S4.E11.m1.10.10.10.10.10.10.2.1"></times><ci id="S4.E11.m1.10.10.10.10.10.10.2.2.cmml" xref="S4.E11.m1.10.10.10.10.10.10.2.2">#</ci><ci id="S4.E11.m1.10.10.10.10.10.10.2.3.cmml" xref="S4.E11.m1.10.10.10.10.10.10.2.3">of</ci><ci id="S4.E11.m1.10.10.10.10.10.10.2.4.cmml" xref="S4.E11.m1.10.10.10.10.10.10.2.4">recommendations</ci><ci id="S4.E11.m1.10.10.10.10.10.10.2.5.cmml" xref="S4.E11.m1.10.10.10.10.10.10.2.5">that</ci><ci id="S4.E11.m1.10.10.10.10.10.10.2.6.cmml" xref="S4.E11.m1.10.10.10.10.10.10.2.6">are</ci><ci id="S4.E11.m1.10.10.10.10.10.10.2.7.cmml" xref="S4.E11.m1.10.10.10.10.10.10.2.7">relevant</ci></apply><apply id="S4.E11.m1.10.10.10.10.10.10.3.cmml" xref="S4.E11.m1.10.10.10.10.10.10.3"><times id="S4.E11.m1.10.10.10.10.10.10.3.1.cmml" xref="S4.E11.m1.10.10.10.10.10.10.3.1"></times><ci id="S4.E11.m1.10.10.10.10.10.10.3.2.cmml" xref="S4.E11.m1.10.10.10.10.10.10.3.2">#</ci><ci id="S4.E11.m1.10.10.10.10.10.10.3.3.cmml" xref="S4.E11.m1.10.10.10.10.10.10.3.3">of</ci><ci id="S4.E11.m1.10.10.10.10.10.10.3.4.cmml" xref="S4.E11.m1.10.10.10.10.10.10.3.4">all</ci><ci id="S4.E11.m1.10.10.10.10.10.10.3.5.cmml" xref="S4.E11.m1.10.10.10.10.10.10.3.5">possible</ci><ci id="S4.E11.m1.10.10.10.10.10.10.3.6.cmml" xref="S4.E11.m1.10.10.10.10.10.10.3.6">relevant</ci><ci id="S4.E11.m1.10.10.10.10.10.10.3.7.cmml" xref="S4.E11.m1.10.10.10.10.10.10.3.7">items</ci></apply></apply><ci id="S4.E11.m1.11.11.11.1.1.1.cmml" xref="S4.E11.m1.11.11.11.1.1.1">𝑁</ci><ci id="S4.E11.m1.12.12.12.2.2.2.cmml" xref="S4.E11.m1.12.12.12.2.2.2">𝐷</ci><ci id="S4.E11.m1.13.13.13.3.3.3.cmml" xref="S4.E11.m1.13.13.13.3.3.3">𝐶</ci><ci id="S4.E11.m1.14.14.14.4.4.4.cmml" xref="S4.E11.m1.14.14.14.4.4.4">𝐺</ci><ci id="S4.E11.m1.15.15.15.5.5.5.cmml" xref="S4.E11.m1.15.15.15.5.5.5">@</ci><ci id="S4.E11.m1.16.16.16.6.6.6.cmml" xref="S4.E11.m1.16.16.16.6.6.6">𝑘</ci></apply></apply><apply id="S4.E11.m1.46.46.1.1.1c.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"><eq id="S4.E11.m1.17.17.17.7.7.7.cmml" xref="S4.E11.m1.17.17.17.7.7.7"></eq><share href="https://arxiv.org/html/2405.17959v1#S4.E11.m1.46.46.1.1.1.4.cmml" id="S4.E11.m1.46.46.1.1.1d.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"></share><apply id="S4.E11.m1.46.46.1.1.1.6.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"><times id="S4.E11.m1.46.46.1.1.1.6.1.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"></times><apply id="S4.E11.m1.18.18.18.8.8.8.cmml" xref="S4.E11.m1.18.18.18.8.8.8"><divide id="S4.E11.m1.18.18.18.8.8.8.1.cmml" xref="S4.E11.m1.18.18.18.8.8.8"></divide><apply id="S4.E11.m1.18.18.18.8.8.8.2.cmml" xref="S4.E11.m1.18.18.18.8.8.8.2"><times id="S4.E11.m1.18.18.18.8.8.8.2.1.cmml" xref="S4.E11.m1.18.18.18.8.8.8.2.1"></times><ci id="S4.E11.m1.18.18.18.8.8.8.2.2.cmml" xref="S4.E11.m1.18.18.18.8.8.8.2.2">DCG</ci><ci id="S4.E11.m1.18.18.18.8.8.8.2.3.cmml" xref="S4.E11.m1.18.18.18.8.8.8.2.3">@</ci><ci id="S4.E11.m1.18.18.18.8.8.8.2.4.cmml" xref="S4.E11.m1.18.18.18.8.8.8.2.4">k</ci></apply><apply id="S4.E11.m1.18.18.18.8.8.8.3.cmml" xref="S4.E11.m1.18.18.18.8.8.8.3"><times id="S4.E11.m1.18.18.18.8.8.8.3.1.cmml" xref="S4.E11.m1.18.18.18.8.8.8.3.1"></times><ci id="S4.E11.m1.18.18.18.8.8.8.3.2.cmml" xref="S4.E11.m1.18.18.18.8.8.8.3.2">IDCG</ci><ci id="S4.E11.m1.18.18.18.8.8.8.3.3.cmml" xref="S4.E11.m1.18.18.18.8.8.8.3.3">@</ci><ci id="S4.E11.m1.18.18.18.8.8.8.3.4.cmml" xref="S4.E11.m1.18.18.18.8.8.8.3.4">k</ci></apply></apply><ci id="S4.E11.m1.19.19.19.1.1.1.cmml" xref="S4.E11.m1.19.19.19.1.1.1">𝑤</ci><ci id="S4.E11.m1.20.20.20.2.2.2.cmml" xref="S4.E11.m1.20.20.20.2.2.2">ℎ</ci><ci id="S4.E11.m1.21.21.21.3.3.3.cmml" xref="S4.E11.m1.21.21.21.3.3.3">𝑒</ci><ci id="S4.E11.m1.22.22.22.4.4.4.cmml" xref="S4.E11.m1.22.22.22.4.4.4">𝑟</ci><ci id="S4.E11.m1.23.23.23.5.5.5.cmml" xref="S4.E11.m1.23.23.23.5.5.5">𝑒</ci><ci id="S4.E11.m1.24.24.24.6.6.6.cmml" xref="S4.E11.m1.24.24.24.6.6.6">𝐷</ci><ci id="S4.E11.m1.25.25.25.7.7.7.cmml" xref="S4.E11.m1.25.25.25.7.7.7">𝐶</ci><ci id="S4.E11.m1.26.26.26.8.8.8.cmml" xref="S4.E11.m1.26.26.26.8.8.8">𝐺</ci><ci id="S4.E11.m1.27.27.27.9.9.9.cmml" xref="S4.E11.m1.27.27.27.9.9.9">@</ci><ci id="S4.E11.m1.28.28.28.10.10.10.cmml" xref="S4.E11.m1.28.28.28.10.10.10">𝑘</ci></apply></apply><apply id="S4.E11.m1.46.46.1.1.1e.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"><eq id="S4.E11.m1.29.29.29.11.11.11.cmml" xref="S4.E11.m1.29.29.29.11.11.11"></eq><share href="https://arxiv.org/html/2405.17959v1#S4.E11.m1.46.46.1.1.1.6.cmml" id="S4.E11.m1.46.46.1.1.1f.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"></share><apply id="S4.E11.m1.46.46.1.1.1.8.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"><apply id="S4.E11.m1.46.46.1.1.1.8.1.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"><csymbol cd="ambiguous" id="S4.E11.m1.46.46.1.1.1.8.1.1.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1">superscript</csymbol><apply id="S4.E11.m1.46.46.1.1.1.8.1.2.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"><csymbol cd="ambiguous" id="S4.E11.m1.46.46.1.1.1.8.1.2.1.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1">subscript</csymbol><sum id="S4.E11.m1.30.30.30.12.12.12.cmml" xref="S4.E11.m1.30.30.30.12.12.12"></sum><apply id="S4.E11.m1.31.31.31.13.13.13.1.cmml" xref="S4.E11.m1.31.31.31.13.13.13.1"><eq id="S4.E11.m1.31.31.31.13.13.13.1.1.cmml" xref="S4.E11.m1.31.31.31.13.13.13.1.1"></eq><ci id="S4.E11.m1.31.31.31.13.13.13.1.2.cmml" xref="S4.E11.m1.31.31.31.13.13.13.1.2">𝑖</ci><cn id="S4.E11.m1.31.31.31.13.13.13.1.3.cmml" type="integer" xref="S4.E11.m1.31.31.31.13.13.13.1.3">1</cn></apply></apply><ci id="S4.E11.m1.32.32.32.14.14.14.1.cmml" xref="S4.E11.m1.32.32.32.14.14.14.1">𝑘</ci></apply><apply id="S4.E11.m1.33.33.33.15.15.15.cmml" xref="S4.E11.m1.33.33.33.15.15.15"><divide id="S4.E11.m1.33.33.33.15.15.15.2.cmml" xref="S4.E11.m1.33.33.33.15.15.15"></divide><apply id="S4.E11.m1.33.33.33.15.15.15.3.cmml" xref="S4.E11.m1.33.33.33.15.15.15.3"><csymbol cd="ambiguous" id="S4.E11.m1.33.33.33.15.15.15.3.1.cmml" xref="S4.E11.m1.33.33.33.15.15.15.3">subscript</csymbol><ci id="S4.E11.m1.33.33.33.15.15.15.3.2.cmml" xref="S4.E11.m1.33.33.33.15.15.15.3.2">𝐺</ci><ci id="S4.E11.m1.33.33.33.15.15.15.3.3.cmml" xref="S4.E11.m1.33.33.33.15.15.15.3.3">𝑖</ci></apply><apply id="S4.E11.m1.33.33.33.15.15.15.1.cmml" xref="S4.E11.m1.33.33.33.15.15.15.1"><times id="S4.E11.m1.33.33.33.15.15.15.1.2.cmml" xref="S4.E11.m1.33.33.33.15.15.15.1.2"></times><ci id="S4.E11.m1.33.33.33.15.15.15.1.3.cmml" xref="S4.E11.m1.33.33.33.15.15.15.1.3">𝑙</ci><ci id="S4.E11.m1.33.33.33.15.15.15.1.4.cmml" xref="S4.E11.m1.33.33.33.15.15.15.1.4">𝑜</ci><apply id="S4.E11.m1.33.33.33.15.15.15.1.5.cmml" xref="S4.E11.m1.33.33.33.15.15.15.1.5"><csymbol cd="ambiguous" id="S4.E11.m1.33.33.33.15.15.15.1.5.1.cmml" xref="S4.E11.m1.33.33.33.15.15.15.1.5">subscript</csymbol><ci id="S4.E11.m1.33.33.33.15.15.15.1.5.2.cmml" xref="S4.E11.m1.33.33.33.15.15.15.1.5.2">𝑔</ci><cn id="S4.E11.m1.33.33.33.15.15.15.1.5.3.cmml" type="integer" xref="S4.E11.m1.33.33.33.15.15.15.1.5.3">2</cn></apply><apply id="S4.E11.m1.33.33.33.15.15.15.1.1.1.1.cmml" xref="S4.E11.m1.33.33.33.15.15.15.1.1.1"><plus id="S4.E11.m1.33.33.33.15.15.15.1.1.1.1.1.cmml" xref="S4.E11.m1.33.33.33.15.15.15.1.1.1.1.1"></plus><ci id="S4.E11.m1.33.33.33.15.15.15.1.1.1.1.2.cmml" xref="S4.E11.m1.33.33.33.15.15.15.1.1.1.1.2">𝑖</ci><cn id="S4.E11.m1.33.33.33.15.15.15.1.1.1.1.3.cmml" type="integer" xref="S4.E11.m1.33.33.33.15.15.15.1.1.1.1.3">1</cn></apply></apply></apply></apply></apply></apply><apply id="S4.E11.m1.47.47.2.2.2.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"><eq id="S4.E11.m1.41.41.41.23.23.23.cmml" xref="S4.E11.m1.41.41.41.23.23.23"></eq><apply id="S4.E11.m1.47.47.2.2.2.2.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"><times id="S4.E11.m1.47.47.2.2.2.2.1.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"></times><ci id="S4.E11.m1.35.35.35.17.17.17.cmml" xref="S4.E11.m1.35.35.35.17.17.17">𝐼</ci><ci id="S4.E11.m1.36.36.36.18.18.18.cmml" xref="S4.E11.m1.36.36.36.18.18.18">𝐷</ci><ci id="S4.E11.m1.37.37.37.19.19.19.cmml" xref="S4.E11.m1.37.37.37.19.19.19">𝐶</ci><ci id="S4.E11.m1.38.38.38.20.20.20.cmml" xref="S4.E11.m1.38.38.38.20.20.20">𝐺</ci><ci id="S4.E11.m1.39.39.39.21.21.21.cmml" xref="S4.E11.m1.39.39.39.21.21.21">@</ci><ci id="S4.E11.m1.40.40.40.22.22.22.cmml" xref="S4.E11.m1.40.40.40.22.22.22">𝑘</ci></apply><apply id="S4.E11.m1.47.47.2.2.2.3.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"><apply id="S4.E11.m1.47.47.2.2.2.3.1.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"><csymbol cd="ambiguous" id="S4.E11.m1.47.47.2.2.2.3.1.1.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1">superscript</csymbol><apply id="S4.E11.m1.47.47.2.2.2.3.1.2.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1"><csymbol cd="ambiguous" id="S4.E11.m1.47.47.2.2.2.3.1.2.1.cmml" xref="S4.E11.m1.10.10.10.10.10.11.1">subscript</csymbol><sum id="S4.E11.m1.42.42.42.24.24.24.cmml" xref="S4.E11.m1.42.42.42.24.24.24"></sum><apply id="S4.E11.m1.43.43.43.25.25.25.1.cmml" xref="S4.E11.m1.43.43.43.25.25.25.1"><eq id="S4.E11.m1.43.43.43.25.25.25.1.1.cmml" xref="S4.E11.m1.43.43.43.25.25.25.1.1"></eq><ci id="S4.E11.m1.43.43.43.25.25.25.1.2.cmml" xref="S4.E11.m1.43.43.43.25.25.25.1.2">𝑖</ci><cn id="S4.E11.m1.43.43.43.25.25.25.1.3.cmml" type="integer" xref="S4.E11.m1.43.43.43.25.25.25.1.3">1</cn></apply></apply><apply id="S4.E11.m1.44.44.44.26.26.26.1.cmml" xref="S4.E11.m1.44.44.44.26.26.26.1"><csymbol cd="ambiguous" id="S4.E11.m1.44.44.44.26.26.26.1.1.cmml" xref="S4.E11.m1.44.44.44.26.26.26.1">subscript</csymbol><ci id="S4.E11.m1.44.44.44.26.26.26.1.2.cmml" xref="S4.E11.m1.44.44.44.26.26.26.1.2">𝑘</ci><apply id="S4.E11.m1.44.44.44.26.26.26.1.3.cmml" xref="S4.E11.m1.44.44.44.26.26.26.1.3"><times id="S4.E11.m1.44.44.44.26.26.26.1.3.1.cmml" xref="S4.E11.m1.44.44.44.26.26.26.1.3.1"></times><ci id="S4.E11.m1.44.44.44.26.26.26.1.3.2.cmml" xref="S4.E11.m1.44.44.44.26.26.26.1.3.2">𝑖</ci><ci id="S4.E11.m1.44.44.44.26.26.26.1.3.3.cmml" xref="S4.E11.m1.44.44.44.26.26.26.1.3.3">𝑑</ci><ci id="S4.E11.m1.44.44.44.26.26.26.1.3.4.cmml" xref="S4.E11.m1.44.44.44.26.26.26.1.3.4">𝑒</ci><ci id="S4.E11.m1.44.44.44.26.26.26.1.3.5.cmml" xref="S4.E11.m1.44.44.44.26.26.26.1.3.5">𝑎</ci><ci id="S4.E11.m1.44.44.44.26.26.26.1.3.6.cmml" xref="S4.E11.m1.44.44.44.26.26.26.1.3.6">𝑙</ci></apply></apply></apply><apply id="S4.E11.m1.45.45.45.27.27.27.cmml" xref="S4.E11.m1.45.45.45.27.27.27"><divide id="S4.E11.m1.45.45.45.27.27.27.2.cmml" xref="S4.E11.m1.45.45.45.27.27.27"></divide><apply id="S4.E11.m1.45.45.45.27.27.27.3.cmml" xref="S4.E11.m1.45.45.45.27.27.27.3"><csymbol cd="ambiguous" id="S4.E11.m1.45.45.45.27.27.27.3.1.cmml" xref="S4.E11.m1.45.45.45.27.27.27.3">superscript</csymbol><apply id="S4.E11.m1.45.45.45.27.27.27.3.2.cmml" xref="S4.E11.m1.45.45.45.27.27.27.3"><csymbol cd="ambiguous" id="S4.E11.m1.45.45.45.27.27.27.3.2.1.cmml" xref="S4.E11.m1.45.45.45.27.27.27.3">subscript</csymbol><ci id="S4.E11.m1.45.45.45.27.27.27.3.2.2.cmml" xref="S4.E11.m1.45.45.45.27.27.27.3.2.2">𝐺</ci><ci id="S4.E11.m1.45.45.45.27.27.27.3.2.3.cmml" xref="S4.E11.m1.45.45.45.27.27.27.3.2.3">𝑖</ci></apply><apply id="S4.E11.m1.45.45.45.27.27.27.3.3.cmml" xref="S4.E11.m1.45.45.45.27.27.27.3.3"><times id="S4.E11.m1.45.45.45.27.27.27.3.3.1.cmml" xref="S4.E11.m1.45.45.45.27.27.27.3.3.1"></times><ci id="S4.E11.m1.45.45.45.27.27.27.3.3.2.cmml" xref="S4.E11.m1.45.45.45.27.27.27.3.3.2">𝑖</ci><ci id="S4.E11.m1.45.45.45.27.27.27.3.3.3.cmml" xref="S4.E11.m1.45.45.45.27.27.27.3.3.3">𝑑</ci><ci id="S4.E11.m1.45.45.45.27.27.27.3.3.4.cmml" xref="S4.E11.m1.45.45.45.27.27.27.3.3.4">𝑒</ci><ci id="S4.E11.m1.45.45.45.27.27.27.3.3.5.cmml" xref="S4.E11.m1.45.45.45.27.27.27.3.3.5">𝑎</ci><ci id="S4.E11.m1.45.45.45.27.27.27.3.3.6.cmml" xref="S4.E11.m1.45.45.45.27.27.27.3.3.6">𝑙</ci></apply></apply><apply id="S4.E11.m1.45.45.45.27.27.27.1.cmml" xref="S4.E11.m1.45.45.45.27.27.27.1"><times id="S4.E11.m1.45.45.45.27.27.27.1.2.cmml" xref="S4.E11.m1.45.45.45.27.27.27.1.2"></times><ci id="S4.E11.m1.45.45.45.27.27.27.1.3.cmml" xref="S4.E11.m1.45.45.45.27.27.27.1.3">𝑙</ci><ci id="S4.E11.m1.45.45.45.27.27.27.1.4.cmml" xref="S4.E11.m1.45.45.45.27.27.27.1.4">𝑜</ci><apply id="S4.E11.m1.45.45.45.27.27.27.1.5.cmml" xref="S4.E11.m1.45.45.45.27.27.27.1.5"><csymbol cd="ambiguous" id="S4.E11.m1.45.45.45.27.27.27.1.5.1.cmml" xref="S4.E11.m1.45.45.45.27.27.27.1.5">subscript</csymbol><ci id="S4.E11.m1.45.45.45.27.27.27.1.5.2.cmml" xref="S4.E11.m1.45.45.45.27.27.27.1.5.2">𝑔</ci><cn id="S4.E11.m1.45.45.45.27.27.27.1.5.3.cmml" type="integer" xref="S4.E11.m1.45.45.45.27.27.27.1.5.3">2</cn></apply><apply id="S4.E11.m1.45.45.45.27.27.27.1.1.1.1.cmml" xref="S4.E11.m1.45.45.45.27.27.27.1.1.1"><plus id="S4.E11.m1.45.45.45.27.27.27.1.1.1.1.1.cmml" xref="S4.E11.m1.45.45.45.27.27.27.1.1.1.1.1"></plus><ci id="S4.E11.m1.45.45.45.27.27.27.1.1.1.1.2.cmml" xref="S4.E11.m1.45.45.45.27.27.27.1.1.1.1.2">𝑖</ci><cn id="S4.E11.m1.45.45.45.27.27.27.1.1.1.1.3.cmml" type="integer" xref="S4.E11.m1.45.45.45.27.27.27.1.1.1.1.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.49c">\begin{split}Recall@k=\frac{\#\mathrm{~{}of~{}recommendations~{}that~{}are~{}%
relevant}}{\#\mathrm{~{}of~{}all~{}possible~{}relevant~{}items}}\\
NDCG@k=\frac{\mathrm{DCG@k}}{\mathrm{IDCG@k}}\\
where~{}DCG@k=\sum_{i=1}^{k}\frac{G_{i}}{log_{2}(i+1)},IDCG@k=\sum_{i=1}^{k_{%
ideal}}\frac{G_{i}^{ideal}}{log_{2}(i+1)}\end{split}</annotation><annotation encoding="application/x-llamapun" id="S4.E11.m1.49d">start_ROW start_CELL italic_R italic_e italic_c italic_a italic_l italic_l @ italic_k = divide start_ARG # roman_of roman_recommendations roman_that roman_are roman_relevant end_ARG start_ARG # roman_of roman_all roman_possible roman_relevant roman_items end_ARG end_CELL end_ROW start_ROW start_CELL italic_N italic_D italic_C italic_G @ italic_k = divide start_ARG roman_DCG @ roman_k end_ARG start_ARG roman_IDCG @ roman_k end_ARG end_CELL end_ROW start_ROW start_CELL italic_w italic_h italic_e italic_r italic_e italic_D italic_C italic_G @ italic_k = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT divide start_ARG italic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG italic_l italic_o italic_g start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_i + 1 ) end_ARG , italic_I italic_D italic_C italic_G @ italic_k = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k start_POSTSUBSCRIPT italic_i italic_d italic_e italic_a italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT divide start_ARG italic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i italic_d italic_e italic_a italic_l end_POSTSUPERSCRIPT end_ARG start_ARG italic_l italic_o italic_g start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_i + 1 ) end_ARG end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Hyperparameter settings</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.9">The proposed and baseline models used the RecBole <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib25" title="">2021</a>)</cite> framework and summarized the results with five random seed changes.
The hyperparameters of the experimental model were trained with a learning rate of 1e-4 and 200 epochs using the Adam optimizer.
The hidden size <math alttext="d" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_d</annotation></semantics></math> was set to 256 for the proposed as well as all the attention-based models.
Similarly, the attention layer <math alttext="L" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">italic_L</annotation></semantics></math> was set to 4, and the attention head <math alttext="h" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">h</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">italic_h</annotation></semantics></math> was set to 8.
Other hyperparameters use grid search to find the best settings for the model.
The searching space was: hidden size for multimodal <math alttext="d^{\prime}" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.1"><semantics id="S4.SS2.p1.4.m4.1a"><msup id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mi id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">d</mi><mo id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">superscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">𝑑</ci><ci id="S4.SS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">d^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> <math alttext="\in" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m5.1"><semantics id="S4.SS2.p1.5.m5.1a"><mo id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><in id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">\in</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m5.1d">∈</annotation></semantics></math> {32, 64, 128, 256}, <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS2.p1.6.m6.1"><semantics id="S4.SS2.p1.6.m6.1a"><mi id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><ci id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.6.m6.1d">italic_λ</annotation></semantics></math> <math alttext="\in" class="ltx_Math" display="inline" id="S4.SS2.p1.7.m7.1"><semantics id="S4.SS2.p1.7.m7.1a"><mo id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><in id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">\in</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.7.m7.1d">∈</annotation></semantics></math> {5, 10, 15, 20, 25}, <math alttext="F" class="ltx_Math" display="inline" id="S4.SS2.p1.8.m8.1"><semantics id="S4.SS2.p1.8.m8.1a"><mi id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><ci id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">F</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.8.m8.1d">italic_F</annotation></semantics></math> <math alttext="\in" class="ltx_Math" display="inline" id="S4.SS2.p1.9.m9.1"><semantics id="S4.SS2.p1.9.m9.1a"><mo id="S4.SS2.p1.9.m9.1.1" xref="S4.SS2.p1.9.m9.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m9.1b"><in id="S4.SS2.p1.9.m9.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m9.1c">\in</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.9.m9.1d">∈</annotation></semantics></math> {<span class="ltx_text ltx_font_italic" id="S4.SS2.p1.9.1">Gate</span>, <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.9.2">Concat</span>, and <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.9.3">Sum</span>}.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Benchmark methods</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">The model shown below is the baseline models that were used for the experiments. There are two types of models: basic sequential recommendation methods that use only item sequences (<a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4.I1.i1" title="Example 1 ‣ 4.3 Benchmark methods ‣ 4 Experiments ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">1</span></a>–<a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4.I1.i4" title="Example 4 ‣ 4.3 Benchmark methods ‣ 4 Experiments ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">4</span></a>) and sequential recommendation methods that use multimodal information (<a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4.I1.i5" title="Example 5 ‣ 4.3 Benchmark methods ‣ 4 Experiments ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">5</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4.I1.i6" title="Example 6 ‣ 4.3 Benchmark methods ‣ 4 Experiments ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">6</span></a>).
The hyperparameters of the baseline model used a default setting and the attention-based model used the same layer, head and hidden sizes as the proposed model.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<ol class="ltx_enumerate" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1">GRU4Rec <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib6" title="">2015</a>)</cite>: A sequential recommendation model using RNNs.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1">Caser <cite class="ltx_cite ltx_citemacro_citep">(Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib18" title="">2018</a>)</cite>: A CNN-based sequential recommendation model that uses horizontal and vertical convolution filters.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1">SASRec <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib9" title="">2018</a>)</cite>: An attention-based model that learns sequential patterns using self-attention.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.1">BERT4Rec <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib17" title="">2019</a>)</cite>: A bidirectional attention-based model that masks a user’s sequential patterns for learning.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span>
<div class="ltx_para" id="S4.I1.i5.p1">
<p class="ltx_p" id="S4.I1.i5.p1.1">SASRecF: An extension of the SASRec model that fuses items and their corresponding side information into embedding layers.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">6.</span>
<div class="ltx_para" id="S4.I1.i6.p1">
<p class="ltx_p" id="S4.I1.i6.p1.1">FDSA <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#bib.bib24" title="">2019</a>)</cite>: A self-attention model that learns the sequential patterns and side information of users through independent self-attention blocks.</p>
</div>
</li>
</ol>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.2.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S4.T2.3.2" style="font-size:90%;">Performance comparison between the benchmark model and the proposed model.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.4" style="width:433.6pt;height:276.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-23.2pt,14.8pt) scale(0.903452016776689,0.903452016776689) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.4.1.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.4.1.1.1.2">Metric</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.1.1.3">GRU4Rec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.1.1.4">Caser</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.1.1.5">SASRec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.1.1.6">BERT4Rec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.1.1.7">SASRecF</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T2.4.1.1.1.8">FDSA</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.1.1.9">Proposal</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.4.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.4.1.2.1.1" rowspan="4"><span class="ltx_text" id="S4.T2.4.1.2.1.1.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T2.4.1.2.1.1.1.1">
<span class="ltx_tr" id="S4.T2.4.1.2.1.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T2.4.1.2.1.1.1.1.1.1">Video</span></span>
<span class="ltx_tr" id="S4.T2.4.1.2.1.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T2.4.1.2.1.1.1.1.2.1">Games</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.4.1.2.1.2">Recall@10</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.2.1.3">0.1120</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.2.1.4">0.0733</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.2.1.5">
<span class="ltx_ERROR undefined" id="S4.T2.4.1.2.1.5.1">\ul</span>0.1689</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.2.1.6">0.0705</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.2.1.7">0.1513</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.1.2.1.8">0.1518</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.2.1.9"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.2.1.9.1">0.1714</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.1.3.2.1">Recall@20</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.3.2.2">0.1733</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.3.2.3">0.1136</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.3.2.4">
<span class="ltx_ERROR undefined" id="S4.T2.4.1.3.2.4.1">\ul</span>0.2429</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.3.2.5">0.1263</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.3.2.6">0.2154</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.1.3.2.7">0.2120</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.3.2.8"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.3.2.8.1">0.2499</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.1.4.3.1">NDCG@10</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.4.3.2">0.0615</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.4.3.3">0.0406</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.4.3.4">0.0904</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.4.3.5">0.0344</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.4.3.6">0.0907</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.1.4.3.7"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.4.3.7.1">0.0959</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.4.3.8">
<span class="ltx_ERROR undefined" id="S4.T2.4.1.4.3.8.1">\ul</span>0.0941</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.1.5.4.1">NDCG@20</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.5.4.2">0.0769</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.5.4.3">0.0507</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.5.4.4">0.1090</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.5.4.5">0.0483</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.5.4.6">0.1069</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.1.5.4.7">
<span class="ltx_ERROR undefined" id="S4.T2.4.1.5.4.7.1">\ul</span>0.1111</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.5.4.8"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.5.4.8.1">0.1138</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.4.1.6.5.1" rowspan="4"><span class="ltx_text" id="S4.T2.4.1.6.5.1.1">Boys&amp;Girls</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.4.1.6.5.2">Recall@10</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.6.5.3">0.6859</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.6.5.4">0.7372</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.6.5.5">
<span class="ltx_ERROR undefined" id="S4.T2.4.1.6.5.5.1">\ul</span>0.7877</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.6.5.6">0.6774</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.6.5.7">0.7791</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.1.6.5.8">0.7688</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.6.5.9"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.6.5.9.1">0.7906</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.1.7.6.1">Recall@20</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.7.6.2">0.7123</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.7.6.3">0.7675</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.7.6.4">0.8056</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.7.6.5">0.7251</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.7.6.6">
<span class="ltx_ERROR undefined" id="S4.T2.4.1.7.6.6.1">\ul</span>0.8107</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.1.7.6.7">0.7893</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.7.6.8"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.7.6.8.1">0.8262</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.8.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.1.8.7.1">NDCG@10</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.8.7.2">0.6430</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.8.7.3">0.6702</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.8.7.4">0.7112</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.8.7.5">0.3292</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.8.7.6"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.8.7.6.1">0.7151</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.1.8.7.7">0.7092</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.8.7.8">
<span class="ltx_ERROR undefined" id="S4.T2.4.1.8.7.8.1">\ul</span>0.7125</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.9.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.1.9.8.1">NDCG@20</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.9.8.2">0.6496</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.9.8.3">0.6774</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.9.8.4">0.7157</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.9.8.5">0.3412</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.9.8.6"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.9.8.6.1">0.7230</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.1.9.8.7">0.7144</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.9.8.8">
<span class="ltx_ERROR undefined" id="S4.T2.4.1.9.8.8.1">\ul</span>0.7216</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.10.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.4.1.10.9.1" rowspan="4"><span class="ltx_text" id="S4.T2.4.1.10.9.1.1">Women</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.4.1.10.9.2">Recall@10</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.10.9.3">0.2048</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.10.9.4">0.1817</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.10.9.5">
<span class="ltx_ERROR undefined" id="S4.T2.4.1.10.9.5.1">\ul</span>0.2323</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.10.9.6">0.1806</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.10.9.7">0.2283</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.1.10.9.8">0.2306</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.10.9.9"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.10.9.9.1">0.2325</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.11.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.1.11.10.1">Recall@20</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.11.10.2">0.2109</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.11.10.3">0.1889</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.11.10.4">
<span class="ltx_ERROR undefined" id="S4.T2.4.1.11.10.4.1">\ul</span>0.2419</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.11.10.5">0.1926</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.11.10.6">0.2370</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.1.11.10.7">0.2395</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.11.10.8"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.11.10.8.1">0.2422</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.12.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.1.12.11.1">NDCG@10</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.12.11.2">0.1932</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.12.11.3">0.1661</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.12.11.4">0.2162</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.12.11.5">0.0927</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.12.11.6">0.2151</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.1.12.11.7"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.12.11.7.1">0.2171</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.12.11.8"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.12.11.8.1">0.2171</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.13.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.1.13.12.1">NDCG@20</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.13.12.2">0.1948</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.13.12.3">0.1679</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.13.12.4">0.2186</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.13.12.5">0.0957</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.13.12.6">0.2173</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.1.13.12.7">
<span class="ltx_ERROR undefined" id="S4.T2.4.1.13.12.7.1">\ul</span>0.2193</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.13.12.8"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.13.12.8.1">0.2196</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.14.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S4.T2.4.1.14.13.1" rowspan="4"><span class="ltx_text" id="S4.T2.4.1.14.13.1.1">Men</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.4.1.14.13.2">Recall@10</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.14.13.3">0.4561</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.14.13.4">0.4285</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.14.13.5">0.4857</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.14.13.6">0.4193</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.14.13.7">0.4863</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.1.14.13.8">
<span class="ltx_ERROR undefined" id="S4.T2.4.1.14.13.8.1">\ul</span>0.4865</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.14.13.9"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.14.13.9.1">0.4884</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.15.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.1.15.14.1">Recall@20</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.15.14.2">0.4659</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.15.14.3">0.4398</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.15.14.4">
<span class="ltx_ERROR undefined" id="S4.T2.4.1.15.14.4.1">\ul</span>0.4978</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.15.14.5">0.4354</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.15.14.6">0.4965</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.1.15.14.7">0.4966</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.15.14.8"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.15.14.8.1">0.5001</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.16.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.1.16.15.1">NDCG@10</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.16.15.2">0.4390</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.16.15.3">0.4060</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.16.15.4">0.4661</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.16.15.5">0.2291</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.16.15.6">0.4658</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.1.16.15.7">
<span class="ltx_ERROR undefined" id="S4.T2.4.1.16.15.7.1">\ul</span>0.4677</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.16.15.8"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.16.15.8.1">0.4691</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.17.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T2.4.1.17.16.1">NDCG@20</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.4.1.17.16.2">0.4414</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.4.1.17.16.3">0.4088</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.4.1.17.16.4">0.4692</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.4.1.17.16.5">0.2332</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.4.1.17.16.6">0.4684</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T2.4.1.17.16.7">
<span class="ltx_ERROR undefined" id="S4.T2.4.1.17.16.7.1">\ul</span>0.4703</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.4.1.17.16.8"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.17.16.8.1">0.4720</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Experimental results</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4.T2" title="Table 2 ‣ 4.3 Benchmark methods ‣ 4 Experiments ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">2</span></a> compares the proposed model with various sequential recommendations on four datasets collected from Amazon.
<span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.1">Bold</span> text in the table indicates the best result of the comparative models, and <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS4.p1.1.2">underlined</span> text denotes the second-best result.
First, the result for the GRU4Rec, Caser, SASRec, and BERT4Rec models, which cannot receive multimodal information, show that the attention-based SASRec perform best, which demonstrates that the attention mechanism is often a useful structure for learning sequential patterns fo users.
Attention-based sequential recommendations SASRecF and FDSA that can receive multimodal information often perform worse than SASRec which uses only user-item information.
In the case of SASRecF, which integrates multimodal data via an embedding layer, the model receives diverse information and has difficulty learning sequential patterns of the users.
In contrast, the FDSA model learns user sequence patterns and multimodal data via an independent self-attention block.
Neverthelss, FDSA consistently performs worse when it used complex multimodal data than when it used only user sequences.
In all the datasets, the proposed model mostly outperforms the baselines in terms of the metrics.
Furthermore, various types of data contribute to different performance improvements depending on the dataset size.
For large-scale datasets such as the Women and Men datasets, the use of Recall@20 improves the performance of the proposed model by 0.12% and 0.46%, respectively, compared with the SASRec model, which only considers sequences.
For small-scale datasets, such as Video Games and Boys &amp; Girls the corresponding performance increased by 2.9% and 2.6%, respectively, indicating that multimodal data has a significant effect on relatively small datasets.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Analysis on attention fusion functions</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4.T3" title="Table 3 ‣ 4.5 Analysis on attention fusion functions ‣ 4 Experiments ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">3</span></a> compares the overall performance when applying different attention fusion functions to the four experimental datasets.
<span class="ltx_text ltx_font_bold" id="S4.SS5.p1.1.1">Bold</span> in the table indicates the best result among the models. Three types of attention fusion, viz.
<span class="ltx_text ltx_font_italic" id="S4.SS5.p1.1.2">Gate</span>, <span class="ltx_text ltx_font_italic" id="S4.SS5.p1.1.3">Concat</span>, and <span class="ltx_text ltx_font_italic" id="S4.SS5.p1.1.4">Sum</span>, were used to aggregate sequence representation and multimodal representation after performing query-key attention operations independently.
The results in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4.T3" title="Table 3 ‣ 4.5 Analysis on attention fusion functions ‣ 4 Experiments ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">3</span></a> show small performance differences between attention fusions.
However, <span class="ltx_text ltx_font_italic" id="S4.SS5.p1.1.5">Concat</span> and <span class="ltx_text ltx_font_italic" id="S4.SS5.p1.1.6">Gate</span> perform poorly on most of the datasets.
the simple attention fusion function <span class="ltx_text ltx_font_italic" id="S4.SS5.p1.1.7">Sum</span> performs best on the four datasets without increasing the capacity of the model.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T3.2.1.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="S4.T3.3.2" style="font-size:90%;">Attention fusion function comparison experiment result.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T3.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.4.1.1.1"><span class="ltx_text" id="S4.T3.4.1.1.1.1" style="font-size:90%;">Dataset</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.4.1.1.2"><span class="ltx_text" id="S4.T3.4.1.1.2.1" style="font-size:90%;">Metric</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.1.3"><span class="ltx_text ltx_font_italic" id="S4.T3.4.1.1.3.1" style="font-size:90%;">Sum</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.1.4"><span class="ltx_text ltx_font_italic" id="S4.T3.4.1.1.4.1" style="font-size:90%;">Concat</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.1.5"><span class="ltx_text ltx_font_italic" id="S4.T3.4.1.1.5.1" style="font-size:90%;">Gate</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.4.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.4.2.1.1" rowspan="4"><span class="ltx_text" id="S4.T3.4.2.1.1.1" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S4.T3.4.2.1.1.1.1">
<span class="ltx_tr" id="S4.T3.4.2.1.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T3.4.2.1.1.1.1.1.1">Video</span></span>
<span class="ltx_tr" id="S4.T3.4.2.1.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T3.4.2.1.1.1.1.2.1">Games</span></span>
</span></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.4.2.1.2"><span class="ltx_text" id="S4.T3.4.2.1.2.1" style="font-size:90%;">Recall@10</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.4.2.1.3"><span class="ltx_text" id="S4.T3.4.2.1.3.1" style="font-size:90%;">0.1714</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.4.2.1.4"><span class="ltx_text ltx_font_bold" id="S4.T3.4.2.1.4.1" style="font-size:90%;">0.1729</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.4.2.1.5"><span class="ltx_text" id="S4.T3.4.2.1.5.1" style="font-size:90%;">0.1725</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.4.3.2.1"><span class="ltx_text" id="S4.T3.4.3.2.1.1" style="font-size:90%;">Recall@20</span></th>
<td class="ltx_td ltx_align_left" id="S4.T3.4.3.2.2"><span class="ltx_text ltx_font_bold" id="S4.T3.4.3.2.2.1" style="font-size:90%;">0.2499</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.3.2.3"><span class="ltx_text" id="S4.T3.4.3.2.3.1" style="font-size:90%;">0.2479</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.3.2.4"><span class="ltx_text" id="S4.T3.4.3.2.4.1" style="font-size:90%;">0.2469</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.4.4.3.1"><span class="ltx_text" id="S4.T3.4.4.3.1.1" style="font-size:90%;">NDCG@10</span></th>
<td class="ltx_td ltx_align_left" id="S4.T3.4.4.3.2"><span class="ltx_text ltx_font_bold" id="S4.T3.4.4.3.2.1" style="font-size:90%;">0.0941</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.4.3.3"><span class="ltx_text" id="S4.T3.4.4.3.3.1" style="font-size:90%;">0.0929</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.4.3.4"><span class="ltx_text" id="S4.T3.4.4.3.4.1" style="font-size:90%;">0.0937</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.4.5.4.1"><span class="ltx_text" id="S4.T3.4.5.4.1.1" style="font-size:90%;">NDCG@20</span></th>
<td class="ltx_td ltx_align_left" id="S4.T3.4.5.4.2"><span class="ltx_text ltx_font_bold" id="S4.T3.4.5.4.2.1" style="font-size:90%;">0.1138</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.5.4.3"><span class="ltx_text" id="S4.T3.4.5.4.3.1" style="font-size:90%;">0.1117</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.5.4.4"><span class="ltx_text" id="S4.T3.4.5.4.4.1" style="font-size:90%;">0.1124</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.4.6.5.1" rowspan="4"><span class="ltx_text" id="S4.T3.4.6.5.1.1" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S4.T3.4.6.5.1.1.1">
<span class="ltx_tr" id="S4.T3.4.6.5.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T3.4.6.5.1.1.1.1.1">Boys &amp;</span></span>
<span class="ltx_tr" id="S4.T3.4.6.5.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T3.4.6.5.1.1.1.2.1">Girls</span></span>
</span></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.4.6.5.2"><span class="ltx_text" id="S4.T3.4.6.5.2.1" style="font-size:90%;">Recall@10</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.4.6.5.3"><span class="ltx_text" id="S4.T3.4.6.5.3.1" style="font-size:90%;">0.7883</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.4.6.5.4"><span class="ltx_text" id="S4.T3.4.6.5.4.1" style="font-size:90%;">0.7855</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.4.6.5.5"><span class="ltx_text ltx_font_bold" id="S4.T3.4.6.5.5.1" style="font-size:90%;">0.7910</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.4.7.6.1"><span class="ltx_text" id="S4.T3.4.7.6.1.1" style="font-size:90%;">Recall@20</span></th>
<td class="ltx_td ltx_align_left" id="S4.T3.4.7.6.2"><span class="ltx_text ltx_font_bold" id="S4.T3.4.7.6.2.1" style="font-size:90%;">0.8208</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.7.6.3"><span class="ltx_text" id="S4.T3.4.7.6.3.1" style="font-size:90%;">0.8180</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.7.6.4"><span class="ltx_text" id="S4.T3.4.7.6.4.1" style="font-size:90%;">0.8187</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.4.8.7.1"><span class="ltx_text" id="S4.T3.4.8.7.1.1" style="font-size:90%;">NDCG@10</span></th>
<td class="ltx_td ltx_align_left" id="S4.T3.4.8.7.2"><span class="ltx_text" id="S4.T3.4.8.7.2.1" style="font-size:90%;">0.7099</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.8.7.3"><span class="ltx_text" id="S4.T3.4.8.7.3.1" style="font-size:90%;">0.7074</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.8.7.4"><span class="ltx_text ltx_font_bold" id="S4.T3.4.8.7.4.1" style="font-size:90%;">0.7134</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.9.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.4.9.8.1"><span class="ltx_text" id="S4.T3.4.9.8.1.1" style="font-size:90%;">NDCG@20</span></th>
<td class="ltx_td ltx_align_left" id="S4.T3.4.9.8.2"><span class="ltx_text" id="S4.T3.4.9.8.2.1" style="font-size:90%;">0.7182</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.9.8.3"><span class="ltx_text" id="S4.T3.4.9.8.3.1" style="font-size:90%;">0.7156</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.9.8.4"><span class="ltx_text ltx_font_bold" id="S4.T3.4.9.8.4.1" style="font-size:90%;">0.7204</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.10.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.4.10.9.1" rowspan="4"><span class="ltx_text" id="S4.T3.4.10.9.1.1" style="font-size:90%;">Women</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.4.10.9.2"><span class="ltx_text" id="S4.T3.4.10.9.2.1" style="font-size:90%;">Recall@10</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.4.10.9.3"><span class="ltx_text ltx_font_bold" id="S4.T3.4.10.9.3.1" style="font-size:90%;">0.2327</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.4.10.9.4"><span class="ltx_text" id="S4.T3.4.10.9.4.1" style="font-size:90%;">0.2314</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.4.10.9.5"><span class="ltx_text" id="S4.T3.4.10.9.5.1" style="font-size:90%;">0.2319</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.11.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.4.11.10.1"><span class="ltx_text" id="S4.T3.4.11.10.1.1" style="font-size:90%;">Recall@20</span></th>
<td class="ltx_td ltx_align_left" id="S4.T3.4.11.10.2"><span class="ltx_text ltx_font_bold" id="S4.T3.4.11.10.2.1" style="font-size:90%;">0.2421</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.11.10.3"><span class="ltx_text" id="S4.T3.4.11.10.3.1" style="font-size:90%;">0.2410</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.11.10.4"><span class="ltx_text" id="S4.T3.4.11.10.4.1" style="font-size:90%;">0.2414</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.12.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.4.12.11.1"><span class="ltx_text" id="S4.T3.4.12.11.1.1" style="font-size:90%;">NDCG@10</span></th>
<td class="ltx_td ltx_align_left" id="S4.T3.4.12.11.2"><span class="ltx_text ltx_font_bold" id="S4.T3.4.12.11.2.1" style="font-size:90%;">0.2163</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.12.11.3"><span class="ltx_text" id="S4.T3.4.12.11.3.1" style="font-size:90%;">0.2153</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.12.11.4"><span class="ltx_text" id="S4.T3.4.12.11.4.1" style="font-size:90%;">0.2151</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.13.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.4.13.12.1"><span class="ltx_text" id="S4.T3.4.13.12.1.1" style="font-size:90%;">NDCG@20</span></th>
<td class="ltx_td ltx_align_left" id="S4.T3.4.13.12.2"><span class="ltx_text ltx_font_bold" id="S4.T3.4.13.12.2.1" style="font-size:90%;">0.2186</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.13.12.3"><span class="ltx_text" id="S4.T3.4.13.12.3.1" style="font-size:90%;">0.2177</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.13.12.4"><span class="ltx_text" id="S4.T3.4.13.12.4.1" style="font-size:90%;">0.2175</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.14.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.4.14.13.1" rowspan="4"><span class="ltx_text" id="S4.T3.4.14.13.1.1" style="font-size:90%;">Men</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.4.14.13.2"><span class="ltx_text" id="S4.T3.4.14.13.2.1" style="font-size:90%;">Recall@10</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.4.14.13.3"><span class="ltx_text ltx_font_bold" id="S4.T3.4.14.13.3.1" style="font-size:90%;">0.4880</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.4.14.13.4"><span class="ltx_text" id="S4.T3.4.14.13.4.1" style="font-size:90%;">0.4867</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.4.14.13.5"><span class="ltx_text" id="S4.T3.4.14.13.5.1" style="font-size:90%;">0.4875</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.15.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.4.15.14.1"><span class="ltx_text" id="S4.T3.4.15.14.1.1" style="font-size:90%;">Recall@20</span></th>
<td class="ltx_td ltx_align_left" id="S4.T3.4.15.14.2"><span class="ltx_text ltx_font_bold" id="S4.T3.4.15.14.2.1" style="font-size:90%;">0.4995</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.15.14.3"><span class="ltx_text" id="S4.T3.4.15.14.3.1" style="font-size:90%;">0.4978</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.15.14.4"><span class="ltx_text" id="S4.T3.4.15.14.4.1" style="font-size:90%;">0.4987</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.16.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.4.16.15.1"><span class="ltx_text" id="S4.T3.4.16.15.1.1" style="font-size:90%;">NDCG@10</span></th>
<td class="ltx_td ltx_align_left" id="S4.T3.4.16.15.2"><span class="ltx_text ltx_font_bold" id="S4.T3.4.16.15.2.1" style="font-size:90%;">0.4685</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.16.15.3"><span class="ltx_text" id="S4.T3.4.16.15.3.1" style="font-size:90%;">0.4682</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.4.16.15.4"><span class="ltx_text" id="S4.T3.4.16.15.4.1" style="font-size:90%;">0.4655</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.17.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T3.4.17.16.1"><span class="ltx_text" id="S4.T3.4.17.16.1.1" style="font-size:90%;">NDCG@20</span></th>
<td class="ltx_td ltx_align_left ltx_border_b" id="S4.T3.4.17.16.2"><span class="ltx_text ltx_font_bold" id="S4.T3.4.17.16.2.1" style="font-size:90%;">0.4714</span></td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S4.T3.4.17.16.3"><span class="ltx_text" id="S4.T3.4.17.16.3.1" style="font-size:90%;">0.4710</span></td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S4.T3.4.17.16.4"><span class="ltx_text" id="S4.T3.4.17.16.4.1" style="font-size:90%;">0.4683</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Analysis on utilizing multimodal data</h3>
<div class="ltx_para" id="S4.SS6.p1">
<p class="ltx_p" id="S4.SS6.p1.1">Fig. <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4.F3" title="Figure 3 ‣ 4.6 Analysis on utilizing multimodal data ‣ 4 Experiments ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">3</span></a> shows a comparative experiment using images, text, and categories to determine the contribution of various multimodal data in the proposed model.
The results show that each dataset and evaluation metric yielded different results.
In Recall@20, item categories of the video game and women datasets perform best among the multimodal data.
For Boys &amp; Girls and Men, images containing visual information about clothing perform the best.
In the case of NDCG@20, the image data show the best results for the Women and Men datasets.
In addition, textual data performs best on the Video Games dataset, and category data performs best on the Boys &amp; Girls dataset.
Both results indicate that multimodal data have different levels of importance depending on the characteristics of the dataset.
However, on combining images, text, and categories to form multimodal data, they complement each other, resulting in improved model performance on most experimental datasets.</p>
</div>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="214" id="S4.F3.g1" src="extracted/5625834/Multimodal_ablation.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S4.F3.3.2" style="font-size:90%;">Comparison of multimodal data performance of four datasets.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.7 </span>Analysis on multi-task loss</h3>
<div class="ltx_para" id="S4.SS7.p1">
<p class="ltx_p" id="S4.SS7.p1.1">To examine the effect of the multitask learning method applied to the proposed model, comparative experiments were performed with and without multitask loss, as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4.T4" title="Table 4 ‣ 4.7 Analysis on multi-task loss ‣ 4 Experiments ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">4</span></a>.
In most cases, the use of multitask loss resulted in better model performance because it can activate beneficial interactions of multimodal data.</p>
</div>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T4.5.2.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="S4.T4.2.1" style="font-size:90%;">Performance comparison with and without multi-task learning (MTL) applied to the proposed model: <math alttext="\%" class="ltx_Math" display="inline" id="S4.T4.2.1.m1.1"><semantics id="S4.T4.2.1.m1.1b"><mo id="S4.T4.2.1.m1.1.1" xref="S4.T4.2.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T4.2.1.m1.1c"><csymbol cd="latexml" id="S4.T4.2.1.m1.1.1.cmml" xref="S4.T4.2.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.1.m1.1d">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T4.2.1.m1.1e">%</annotation></semantics></math> Improved indicates the percentage of performance improved with MTL.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T4.3">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.3.1.2"><span class="ltx_text" id="S4.T4.3.1.2.1" style="font-size:90%;">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.3.1.3"><span class="ltx_text" id="S4.T4.3.1.3.1" style="font-size:90%;">Metric</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.1.4"><span class="ltx_text" id="S4.T4.3.1.4.1" style="font-size:90%;">w/ MTL</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.1.5"><span class="ltx_text" id="S4.T4.3.1.5.1" style="font-size:90%;">w/o MTL</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.1.1">
<math alttext="\%" class="ltx_Math" display="inline" id="S4.T4.3.1.1.m1.1"><semantics id="S4.T4.3.1.1.m1.1a"><mo id="S4.T4.3.1.1.m1.1.1" mathsize="90%" xref="S4.T4.3.1.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T4.3.1.1.m1.1b"><csymbol cd="latexml" id="S4.T4.3.1.1.m1.1.1.cmml" xref="S4.T4.3.1.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.1.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T4.3.1.1.m1.1d">%</annotation></semantics></math><span class="ltx_text" id="S4.T4.3.1.1.1" style="font-size:90%;"> Improved</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.3.2.1.1" rowspan="4"><span class="ltx_text" id="S4.T4.3.2.1.1.1" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S4.T4.3.2.1.1.1.1">
<span class="ltx_tr" id="S4.T4.3.2.1.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.3.2.1.1.1.1.1.1">Video</span></span>
<span class="ltx_tr" id="S4.T4.3.2.1.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.3.2.1.1.1.1.2.1">Games</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.3.2.1.2"><span class="ltx_text" id="S4.T4.3.2.1.2.1" style="font-size:90%;">Recall@10</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.2.1.3"><span class="ltx_text" id="S4.T4.3.2.1.3.1" style="font-size:90%;">0.1714</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.2.1.4"><span class="ltx_text" id="S4.T4.3.2.1.4.1" style="font-size:90%;">0.1732</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.2.1.5"><span class="ltx_text" id="S4.T4.3.2.1.5.1" style="font-size:90%;">-1.05%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.3.3.2.1"><span class="ltx_text" id="S4.T4.3.3.2.1.1" style="font-size:90%;">Recall@20</span></th>
<td class="ltx_td ltx_align_center" id="S4.T4.3.3.2.2"><span class="ltx_text" id="S4.T4.3.3.2.2.1" style="font-size:90%;">0.2499</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.3.2.3"><span class="ltx_text" id="S4.T4.3.3.2.3.1" style="font-size:90%;">0.2465</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.3.2.4"><span class="ltx_text" id="S4.T4.3.3.2.4.1" style="font-size:90%;">1.38%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.3.4.3.1"><span class="ltx_text" id="S4.T4.3.4.3.1.1" style="font-size:90%;">NDCG@10</span></th>
<td class="ltx_td ltx_align_center" id="S4.T4.3.4.3.2"><span class="ltx_text" id="S4.T4.3.4.3.2.1" style="font-size:90%;">0.0941</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.4.3.3"><span class="ltx_text" id="S4.T4.3.4.3.3.1" style="font-size:90%;">0.0934</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.4.3.4"><span class="ltx_text" id="S4.T4.3.4.3.4.1" style="font-size:90%;">0.75%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.3.5.4.1"><span class="ltx_text" id="S4.T4.3.5.4.1.1" style="font-size:90%;">NDCG@20</span></th>
<td class="ltx_td ltx_align_center" id="S4.T4.3.5.4.2"><span class="ltx_text" id="S4.T4.3.5.4.2.1" style="font-size:90%;">0.1138</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.5.4.3"><span class="ltx_text" id="S4.T4.3.5.4.3.1" style="font-size:90%;">0.1119</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.5.4.4"><span class="ltx_text" id="S4.T4.3.5.4.4.1" style="font-size:90%;">1.7%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.3.6.5.1" rowspan="4"><span class="ltx_text" id="S4.T4.3.6.5.1.1" style="font-size:90%;">Boys&amp;Girls</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.3.6.5.2"><span class="ltx_text" id="S4.T4.3.6.5.2.1" style="font-size:90%;">Recall@10</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.6.5.3"><span class="ltx_text" id="S4.T4.3.6.5.3.1" style="font-size:90%;">0.7906</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.6.5.4"><span class="ltx_text" id="S4.T4.3.6.5.4.1" style="font-size:90%;">0.7926</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.6.5.5"><span class="ltx_text" id="S4.T4.3.6.5.5.1" style="font-size:90%;">-0.25%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.3.7.6.1"><span class="ltx_text" id="S4.T4.3.7.6.1.1" style="font-size:90%;">Recall@20</span></th>
<td class="ltx_td ltx_align_center" id="S4.T4.3.7.6.2"><span class="ltx_text" id="S4.T4.3.7.6.2.1" style="font-size:90%;">0.8262</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.7.6.3"><span class="ltx_text" id="S4.T4.3.7.6.3.1" style="font-size:90%;">0.8225</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.7.6.4"><span class="ltx_text" id="S4.T4.3.7.6.4.1" style="font-size:90%;">0.45%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.8.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.3.8.7.1"><span class="ltx_text" id="S4.T4.3.8.7.1.1" style="font-size:90%;">NDCG@10</span></th>
<td class="ltx_td ltx_align_center" id="S4.T4.3.8.7.2"><span class="ltx_text" id="S4.T4.3.8.7.2.1" style="font-size:90%;">0.7125</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.8.7.3"><span class="ltx_text" id="S4.T4.3.8.7.3.1" style="font-size:90%;">0.7123</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.8.7.4"><span class="ltx_text" id="S4.T4.3.8.7.4.1" style="font-size:90%;">0.03%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.9.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.3.9.8.1"><span class="ltx_text" id="S4.T4.3.9.8.1.1" style="font-size:90%;">NDCG@20</span></th>
<td class="ltx_td ltx_align_center" id="S4.T4.3.9.8.2"><span class="ltx_text" id="S4.T4.3.9.8.2.1" style="font-size:90%;">0.7216</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.9.8.3"><span class="ltx_text" id="S4.T4.3.9.8.3.1" style="font-size:90%;">0.7199</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.9.8.4"><span class="ltx_text" id="S4.T4.3.9.8.4.1" style="font-size:90%;">0.24%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.10.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.3.10.9.1" rowspan="4"><span class="ltx_text" id="S4.T4.3.10.9.1.1" style="font-size:90%;">Women</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.3.10.9.2"><span class="ltx_text" id="S4.T4.3.10.9.2.1" style="font-size:90%;">Recall@10</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.10.9.3"><span class="ltx_text" id="S4.T4.3.10.9.3.1" style="font-size:90%;">0.2325</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.10.9.4"><span class="ltx_text" id="S4.T4.3.10.9.4.1" style="font-size:90%;">0.2321</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.10.9.5"><span class="ltx_text" id="S4.T4.3.10.9.5.1" style="font-size:90%;">0.17%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.11.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.3.11.10.1"><span class="ltx_text" id="S4.T4.3.11.10.1.1" style="font-size:90%;">Recall@20</span></th>
<td class="ltx_td ltx_align_center" id="S4.T4.3.11.10.2"><span class="ltx_text" id="S4.T4.3.11.10.2.1" style="font-size:90%;">0.2422</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.11.10.3"><span class="ltx_text" id="S4.T4.3.11.10.3.1" style="font-size:90%;">0.2410</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.11.10.4"><span class="ltx_text" id="S4.T4.3.11.10.4.1" style="font-size:90%;">0.5%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.12.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.3.12.11.1"><span class="ltx_text" id="S4.T4.3.12.11.1.1" style="font-size:90%;">NDCG@10</span></th>
<td class="ltx_td ltx_align_center" id="S4.T4.3.12.11.2"><span class="ltx_text" id="S4.T4.3.12.11.2.1" style="font-size:90%;">0.2171</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.12.11.3"><span class="ltx_text" id="S4.T4.3.12.11.3.1" style="font-size:90%;">0.2157</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.12.11.4"><span class="ltx_text" id="S4.T4.3.12.11.4.1" style="font-size:90%;">0.65%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.13.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.3.13.12.1"><span class="ltx_text" id="S4.T4.3.13.12.1.1" style="font-size:90%;">NDCG@20</span></th>
<td class="ltx_td ltx_align_center" id="S4.T4.3.13.12.2"><span class="ltx_text" id="S4.T4.3.13.12.2.1" style="font-size:90%;">0.2196</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.13.12.3"><span class="ltx_text" id="S4.T4.3.13.12.3.1" style="font-size:90%;">0.2179</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.13.12.4"><span class="ltx_text" id="S4.T4.3.13.12.4.1" style="font-size:90%;">0.78%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.14.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S4.T4.3.14.13.1" rowspan="4"><span class="ltx_text" id="S4.T4.3.14.13.1.1" style="font-size:90%;">Men</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.3.14.13.2"><span class="ltx_text" id="S4.T4.3.14.13.2.1" style="font-size:90%;">Recall@10</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.14.13.3"><span class="ltx_text" id="S4.T4.3.14.13.3.1" style="font-size:90%;">0.4884</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.14.13.4"><span class="ltx_text" id="S4.T4.3.14.13.4.1" style="font-size:90%;">0.4873</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.14.13.5"><span class="ltx_text" id="S4.T4.3.14.13.5.1" style="font-size:90%;">0.23%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.15.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.3.15.14.1"><span class="ltx_text" id="S4.T4.3.15.14.1.1" style="font-size:90%;">Recall@20</span></th>
<td class="ltx_td ltx_align_center" id="S4.T4.3.15.14.2"><span class="ltx_text" id="S4.T4.3.15.14.2.1" style="font-size:90%;">0.5001</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.15.14.3"><span class="ltx_text" id="S4.T4.3.15.14.3.1" style="font-size:90%;">0.4985</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.15.14.4"><span class="ltx_text" id="S4.T4.3.15.14.4.1" style="font-size:90%;">0.32%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.16.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.3.16.15.1"><span class="ltx_text" id="S4.T4.3.16.15.1.1" style="font-size:90%;">NDCG@10</span></th>
<td class="ltx_td ltx_align_center" id="S4.T4.3.16.15.2"><span class="ltx_text" id="S4.T4.3.16.15.2.1" style="font-size:90%;">0.4691</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.16.15.3"><span class="ltx_text" id="S4.T4.3.16.15.3.1" style="font-size:90%;">0.4680</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.16.15.4"><span class="ltx_text" id="S4.T4.3.16.15.4.1" style="font-size:90%;">0.24%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.17.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T4.3.17.16.1"><span class="ltx_text" id="S4.T4.3.17.16.1.1" style="font-size:90%;">NDCG@20</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.3.17.16.2"><span class="ltx_text" id="S4.T4.3.17.16.2.1" style="font-size:90%;">0.4720</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.3.17.16.3"><span class="ltx_text" id="S4.T4.3.17.16.3.1" style="font-size:90%;">0.4709</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.3.17.16.4"><span class="ltx_text" id="S4.T4.3.17.16.4.1" style="font-size:90%;">0.23%</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.8 </span>Attention weight visualization</h3>
<div class="ltx_para" id="S4.SS8.p1">
<p class="ltx_p" id="S4.SS8.p1.1">Fig. <a class="ltx_ref" href="https://arxiv.org/html/2405.17959v1#S4.F4" title="Figure 4 ‣ 4.8 Attention weight visualization ‣ 4 Experiments ‣ Attention-based sequential recommendation system using multimodal data"><span class="ltx_text ltx_ref_tag">4</span></a>. shows the attention weight, which provides an interpretation of the model.
The Figure shows the results visualized through the last attention layer of the video game dataset extracted from the randomly sampled attention heads.
Because the MAF focused on the interactions between the past purchased items and multimodal features, we applied the masked attention operation.
The last <math alttext="15^{th}" class="ltx_Math" display="inline" id="S4.SS8.p1.1.m1.1"><semantics id="S4.SS8.p1.1.m1.1a"><msup id="S4.SS8.p1.1.m1.1.1" xref="S4.SS8.p1.1.m1.1.1.cmml"><mn id="S4.SS8.p1.1.m1.1.1.2" xref="S4.SS8.p1.1.m1.1.1.2.cmml">15</mn><mrow id="S4.SS8.p1.1.m1.1.1.3" xref="S4.SS8.p1.1.m1.1.1.3.cmml"><mi id="S4.SS8.p1.1.m1.1.1.3.2" xref="S4.SS8.p1.1.m1.1.1.3.2.cmml">t</mi><mo id="S4.SS8.p1.1.m1.1.1.3.1" xref="S4.SS8.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS8.p1.1.m1.1.1.3.3" xref="S4.SS8.p1.1.m1.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS8.p1.1.m1.1b"><apply id="S4.SS8.p1.1.m1.1.1.cmml" xref="S4.SS8.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS8.p1.1.m1.1.1.1.cmml" xref="S4.SS8.p1.1.m1.1.1">superscript</csymbol><cn id="S4.SS8.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS8.p1.1.m1.1.1.2">15</cn><apply id="S4.SS8.p1.1.m1.1.1.3.cmml" xref="S4.SS8.p1.1.m1.1.1.3"><times id="S4.SS8.p1.1.m1.1.1.3.1.cmml" xref="S4.SS8.p1.1.m1.1.1.3.1"></times><ci id="S4.SS8.p1.1.m1.1.1.3.2.cmml" xref="S4.SS8.p1.1.m1.1.1.3.2">𝑡</ci><ci id="S4.SS8.p1.1.m1.1.1.3.3.cmml" xref="S4.SS8.p1.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p1.1.m1.1c">15^{th}</annotation><annotation encoding="application/x-llamapun" id="S4.SS8.p1.1.m1.1d">15 start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> time and position of the length of the entire sequence are represented in the Figure; a darker color indicates a higher attention weight.
The item attention matrix and multimodal attention matrix represent the different attention weights, which demonstrates that the sequence and multimodal data have different impacts when the model performs operations.
In addition, the fusion attention matrix coordinates the contributions of sequence and multimodal data and integrates them into significant patterns.</p>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="214" id="S4.F4.g1" src="extracted/5625834/Attention_weight.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.2.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S4.F4.3.2" style="font-size:90%;">Video Games attention weight visualization.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this study, we proposed an attention-based sequential recommendation system model that utilizes multimodal data such as images, texts, and categories.
The image and text features of the items were extracted from pre-trained VGG and BERT, and the category was converted into a multi-label form to add multimodal information.
In the proposed method, as each feature information is combined with one multimodal representation, the attention operation is performed by separating the item and multimodal representations.
In addition, through multi-task learning, both item representation and multimodal representation were learned to refine multimodal information effectively.
The experiments were conducted on a total of four datasets: Video Games, Boys&amp;Girls, Women, and Men, which were collected from Amazon.
The use of the multimodal information in the sequential recommendation system results in a significant performance improvement.
Through experiments and attention weight visualization, the MAF of the proposed method aids in complementing the ID attention with multimodal information.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">However, the applicability of the proposed method is limited by its relatively high computational cost.
Therefore, in future work, we plan to improve the efficiency of the proposed method using a compressed attention operation to implement an online real-time recommendation system.
Furthermore, in this study, experiments were conducted on only four categories of the Amazon dataset.
We plan to expand our experiments to include other datasets.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">CRediT authorship contribution statement</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1"><span class="ltx_text ltx_font_bold" id="Sx1.p1.1.1">Hyuyngtaik Oh</span>: Conceptualization, Software, Validation, Writing – Original Draft. <span class="ltx_text ltx_font_bold" id="Sx1.p1.1.2">Wonkeun Jo</span>: Methodology, Software, Writing – Original Draft. <span class="ltx_text ltx_font_bold" id="Sx1.p1.1.3">Dongil Kim</span>: Conceptualization, Methodology, Supervision, Writing – Review &amp; Editing.</p>
</div>
</section>
<section class="ltx_section" id="Sx2">
<h2 class="ltx_title ltx_title_section">Declaration of Competing Interest</h2>
<div class="ltx_para" id="Sx2.p1">
<p class="ltx_p" id="Sx2.p1.1">The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.</p>
</div>
</section>
<section class="ltx_section" id="Sx3">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>
<div class="ltx_para" id="Sx3.p1">
<p class="ltx_p" id="Sx3.p1.3">This work was supported by the Ewha Womans University Research Grant of 2023. This work was partially supported by Institute of Information <math alttext="\&amp;" class="ltx_Math" display="inline" id="Sx3.p1.1.m1.1"><semantics id="Sx3.p1.1.m1.1a"><mo id="Sx3.p1.1.m1.1.1" xref="Sx3.p1.1.m1.1.1.cmml">&amp;</mo><annotation-xml encoding="MathML-Content" id="Sx3.p1.1.m1.1b"><and id="Sx3.p1.1.m1.1.1.cmml" xref="Sx3.p1.1.m1.1.1"></and></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p1.1.m1.1c">\&amp;</annotation><annotation encoding="application/x-llamapun" id="Sx3.p1.1.m1.1d">&amp;</annotation></semantics></math> communications Technology Planning <math alttext="\&amp;" class="ltx_Math" display="inline" id="Sx3.p1.2.m2.1"><semantics id="Sx3.p1.2.m2.1a"><mo id="Sx3.p1.2.m2.1.1" xref="Sx3.p1.2.m2.1.1.cmml">&amp;</mo><annotation-xml encoding="MathML-Content" id="Sx3.p1.2.m2.1b"><and id="Sx3.p1.2.m2.1.1.cmml" xref="Sx3.p1.2.m2.1.1"></and></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p1.2.m2.1c">\&amp;</annotation><annotation encoding="application/x-llamapun" id="Sx3.p1.2.m2.1d">&amp;</annotation></semantics></math> Evaluation (IITP) grant funded by the Korea government(MSIT) (No. RS-2022-00155966, Artificial Intelligence Convergence Innovation Human Resources Development (Ewha Womans University)), Research-centric Hospital R<math alttext="\&amp;" class="ltx_Math" display="inline" id="Sx3.p1.3.m3.1"><semantics id="Sx3.p1.3.m3.1a"><mo id="Sx3.p1.3.m3.1.1" xref="Sx3.p1.3.m3.1.1.cmml">&amp;</mo><annotation-xml encoding="MathML-Content" id="Sx3.p1.3.m3.1b"><and id="Sx3.p1.3.m3.1.1.cmml" xref="Sx3.p1.3.m3.1.1"></and></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p1.3.m3.1c">\&amp;</annotation><annotation encoding="application/x-llamapun" id="Sx3.p1.3.m3.1d">&amp;</annotation></semantics></math>D grant funded by the Korean government (MOHW) (No. HI21C0198), and Basic Science Research Program through the National Research Foundation of Korea(NRF) funded by the Ministry of Education(No. 2022R1A6A3A13056750).</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2012)</span>
<span class="ltx_bibblock">
Chen, M., Xu, Z.,
Weinberger, K., Sha, F.,
2012.

</span>
<span class="ltx_bibblock">Marginalized denoising autoencoders for domain
adaptation.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1206.4683 .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2019)</span>
<span class="ltx_bibblock">
Chen, W., Huang, P., Xu,
J., Guo, X., Guo, C.,
Sun, F., Li, C.,
Pfadler, A., Zhao, H.,
Zhao, B., 2019.

</span>
<span class="ltx_bibblock">Pog: personalized outfit generation for fashion
recommendation at alibaba ifashion, in: Proceedings of
the 25th ACM SIGKDD international conference on knowledge discovery &amp; data
mining, pp. 2662–2670.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cui et al. (2018)</span>
<span class="ltx_bibblock">
Cui, Q., Wu, S., Liu, Q.,
Zhong, W., Wang, L.,
2018.

</span>
<span class="ltx_bibblock">Mv-rnn: A multi-view recurrent neural network for
sequential recommendation.

</span>
<span class="ltx_bibblock">IEEE Transactions on Knowledge and Data
Engineering 32, 317–331.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al. (2021)</span>
<span class="ltx_bibblock">
Han, T., Niu, S., Wang,
P., 2021.

</span>
<span class="ltx_bibblock">Multimodal-adaptive hierarchical network for
multimedia sequential recommendation.

</span>
<span class="ltx_bibblock">Pattern Recognition Letters 152,
10–17.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He and McAuley (2016)</span>
<span class="ltx_bibblock">
He, R., McAuley, J., 2016.

</span>
<span class="ltx_bibblock">Vbpr: visual bayesian personalized ranking from
implicit feedback, in: Proceedings of the AAAI
conference on artificial intelligence.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi et al. (2015)</span>
<span class="ltx_bibblock">
Hidasi, B., Karatzoglou, A.,
Baltrunas, L., Tikk, D.,
2015.

</span>
<span class="ltx_bibblock">Session-based recommendations with recurrent neural
networks.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1511.06939 .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2008)</span>
<span class="ltx_bibblock">
Hu, Y., Koren, Y.,
Volinsky, C., 2008.

</span>
<span class="ltx_bibblock">Collaborative filtering for implicit feedback
datasets, in: 2008 Eighth IEEE international conference
on data mining, Ieee. pp. 263–272.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Iqbal et al. (2018)</span>
<span class="ltx_bibblock">
Iqbal, M., Kovac, A.,
Aryafar, K., 2018.

</span>
<span class="ltx_bibblock">A multimodal recommender system for large-scale
assortment generation in e-commerce.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1806.11226 .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2018)</span>
<span class="ltx_bibblock">
Kang, W.C., McAuley, J.,
2018.

</span>
<span class="ltx_bibblock">Self-attentive sequential recommendation, in:
2018 IEEE international conference on data mining
(ICDM), IEEE. pp. 197–206.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Koren et al. (2009)</span>
<span class="ltx_bibblock">
Koren, Y., Bell, R.,
Volinsky, C., 2009.

</span>
<span class="ltx_bibblock">Matrix factorization techniques for recommender
systems.

</span>
<span class="ltx_bibblock">Computer 42,
30–37.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2021)</span>
<span class="ltx_bibblock">
Liu, C., Li, X., Cai, G.,
Dong, Z., Zhu, H.,
Shang, L., 2021.

</span>
<span class="ltx_bibblock">Noninvasive self-attention for side information
fusion in sequential recommendation, in: Proceedings of
the AAAI Conference on Artificial Intelligence, pp.
4249–4256.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2019)</span>
<span class="ltx_bibblock">
Liu, T., Wang, Z., Tang,
J., Yang, S., Huang, G.Y.,
Liu, Z., 2019.

</span>
<span class="ltx_bibblock">Recommender systems with heterogeneous side
information, in: The world wide web conference, pp.
3027–3033.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mnih and Salakhutdinov (2007)</span>
<span class="ltx_bibblock">
Mnih, A., Salakhutdinov, R.R.,
2007.

</span>
<span class="ltx_bibblock">Probabilistic matrix factorization.

</span>
<span class="ltx_bibblock">Advances in neural information processing systems
20.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan et al. (2008)</span>
<span class="ltx_bibblock">
Pan, R., Zhou, Y., Cao,
B., Liu, N.N., Lukose, R.,
Scholz, M., Yang, Q.,
2008.

</span>
<span class="ltx_bibblock">One-class collaborative filtering, in:
2008 Eighth IEEE International Conference on Data
Mining, IEEE. pp. 502–511.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sarwar et al. (2001)</span>
<span class="ltx_bibblock">
Sarwar, B., Karypis, G.,
Konstan, J., Riedl, J.,
2001.

</span>
<span class="ltx_bibblock">Item-based collaborative filtering recommendation
algorithms, in: Proceedings of the 10th international
conference on World Wide Web, pp. 285–295.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shao et al. (2021)</span>
<span class="ltx_bibblock">
Shao, B., Li, X., Bian,
G., 2021.

</span>
<span class="ltx_bibblock">A survey of research hotspots and frontier trends of
recommendation systems from the perspective of knowledge graph.

</span>
<span class="ltx_bibblock">Expert Systems with Applications
165, 113764.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2019)</span>
<span class="ltx_bibblock">
Sun, F., Liu, J., Wu, J.,
Pei, C., Lin, X., Ou,
W., Jiang, P., 2019.

</span>
<span class="ltx_bibblock">Bert4rec: Sequential recommendation with
bidirectional encoder representations from transformer, in:
Proceedings of the 28th ACM international conference on
information and knowledge management, pp. 1441–1450.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang and Wang (2018)</span>
<span class="ltx_bibblock">
Tang, J., Wang, K., 2018.

</span>
<span class="ltx_bibblock">Personalized top-n sequential recommendation via
convolutional sequence embedding, in: Proceedings of the
eleventh ACM international conference on web search and data mining, pp.
565–573.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Vaswani, A., Shazeer, N.,
Parmar, N., Uszkoreit, J.,
Jones, L., Gomez, A.N.,
Kaiser, Ł., Polosukhin, I.,
2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">Advances in neural information processing systems
30.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Walek and Fojtik (2020)</span>
<span class="ltx_bibblock">
Walek, B., Fojtik, V.,
2020.

</span>
<span class="ltx_bibblock">A hybrid recommender system for recommending relevant
movies using an expert system.

</span>
<span class="ltx_bibblock">Expert Systems with Applications
158, 113452.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. (2019)</span>
<span class="ltx_bibblock">
Wei, Y., Wang, X., Nie,
L., He, X., Hong, R.,
Chua, T.S., 2019.

</span>
<span class="ltx_bibblock">Mmgcn: Multi-modal graph convolution network for
personalized recommendation of micro-video, in:
Proceedings of the 27th ACM International Conference on
Multimedia, pp. 1437–1445.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al. (2022)</span>
<span class="ltx_bibblock">
Xie, Y., Zhou, P., Kim,
S., 2022.

</span>
<span class="ltx_bibblock">Decoupled side information fusion for sequential
recommendation.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:2204.11046 .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan and Zhang (2019)</span>
<span class="ltx_bibblock">
Yan, C., Zhang, Q., 2019.

</span>
<span class="ltx_bibblock">Merging visual features and temporal dynamics in
sequential recommendation.

</span>
<span class="ltx_bibblock">Neurocomputing 362,
11–18.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2019)</span>
<span class="ltx_bibblock">
Zhang, T., Zhao, P., Liu,
Y., Sheng, V.S., Xu, J.,
Wang, D., Liu, G., Zhou,
X., 2019.

</span>
<span class="ltx_bibblock">Feature-level deeper self-attention network for
sequential recommendation., in: IJCAI, pp.
4320–4326.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2021)</span>
<span class="ltx_bibblock">
Zhao, W.X., Mu, S., Hou,
Y., Lin, Z., Chen, Y.,
Pan, X., Li, K., Lu,
Y., Wang, H., Tian, C., et al.,
2021.

</span>
<span class="ltx_bibblock">Recbole: Towards a unified, comprehensive and
efficient framework for recommendation algorithms, in:
Proceedings of the 30th ACM International Conference on
Information &amp; Knowledge Management, pp. 4653–4664.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2020)</span>
<span class="ltx_bibblock">
Zhou, K., Wang, H., Zhao,
W.X., Zhu, Y., Wang, S.,
Zhang, F., Wang, Z.,
Wen, J.R., 2020.

</span>
<span class="ltx_bibblock">S3-rec: Self-supervised learning for sequential
recommendation with mutual information maximization, in:
Proceedings of the 29th ACM International Conference on
Information &amp; Knowledge Management, pp. 1893–1902.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue May 28 08:26:45 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
