<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2309.06692] Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization</title><meta property="og:description" content="Federated learning (FL) is a privacy-preserving paradigm for collaboratively training a global model from decentralized clients.
However, the performance of FL is hindered by non-independent and identically distributed…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2309.06692">

<!--Generated on Mon Feb 26 21:06:26 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Xinyu Zhang 
<br class="ltx_break">Nanjing University 
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">xinyuzhang@smail.nju.edu.cn</span> 
<br class="ltx_break">&amp;Weiyu Sun 
<br class="ltx_break">Nanjing University 
<br class="ltx_break"><span id="id2.2.id2" class="ltx_text ltx_font_typewriter">weiyusun@smail.nju.edu.cn</span> 
<br class="ltx_break">&amp;Ying Chen 
<br class="ltx_break">Nanjing University 
<br class="ltx_break"><span id="id3.3.id3" class="ltx_text ltx_font_typewriter">yingchen@nju.edu.cn</span> 
<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id4.id1" class="ltx_p">Federated learning (FL) is a privacy-preserving paradigm for collaboratively training a global model from decentralized clients.
However, the performance of FL is hindered by non-independent and identically distributed (non-IID) data and device heterogeneity.
In this work, we revisit this key challenge through the lens of gradient conflicts on the server side.
Specifically, we first investigate the gradient conflict phenomenon among multiple clients and reveal that stronger heterogeneity leads to more severe gradient conflicts.
To tackle this issue, we propose FedGH, a simple yet effective method that mitigates local drifts through Gradient Harmonization.
This technique projects one gradient vector onto the orthogonal plane of the other within conflicting client pairs.
Extensive experiments demonstrate that FedGH consistently enhances multiple state-of-the-art FL baselines across diverse benchmarks and non-IID scenarios.
Notably, FedGH yields more significant improvements in scenarios with stronger heterogeneity. As a plug-and-play module,
FedGH can be seamlessly integrated into any FL framework without requiring hyperparameter tuning.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Under the prevalence of large deep-learning models <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib21" title="" class="ltx_ref">2018</a>; Dosovitskiy et al., <a href="#bib.bib5" title="" class="ltx_ref">2020</a>)</cite>, the demand for massive data overgrows.
However, these datasets are usually dispersed across heterogeneous devices (e.g., mobile devices, personal computers, company servers, etc.),
and conventional centralized training is constrained due to privacy concerns <cite class="ltx_cite ltx_citemacro_citep">(Abadi et al., <a href="#bib.bib1" title="" class="ltx_ref">2016</a>; Kaissis et al., <a href="#bib.bib11" title="" class="ltx_ref">2020</a>; Geiping et al., <a href="#bib.bib6" title="" class="ltx_ref">2020</a>)</cite>. In this scenario, federated learning (FL) <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib17" title="" class="ltx_ref">2017</a>)</cite>,
a privacy-preserving distributed training strategy, has emerged as a promising alternative.
FL aims to collaboratively learn a global model based on multiple clients without data sharing.
Specifically, each communication round in FL can be divided into three steps <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib17" title="" class="ltx_ref">2017</a>)</cite>. First, clients download the global model to update the local one.
Next, each client performs local training and uploads the local model. Finally, the server aggregates local models and updates the global model.
Driven by the growing need for privacy protection and decentralized training, FL has been applied widely, including but not limited to face recognition <cite class="ltx_cite ltx_citemacro_citep">(Niu and Deng, <a href="#bib.bib19" title="" class="ltx_ref">2022</a>)</cite>, semantic segmentation <cite class="ltx_cite ltx_citemacro_citep">(Miao et al., <a href="#bib.bib18" title="" class="ltx_ref">2023</a>)</cite>,
medical image analysis <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al., <a href="#bib.bib10" title="" class="ltx_ref">2022</a>)</cite>, and wireless communication <cite class="ltx_cite ltx_citemacro_citep">(Yan et al., <a href="#bib.bib30" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Despite its advanced characteristics,
FL suffers from local drifts <cite class="ltx_cite ltx_citemacro_citep">(Karimireddy et al., <a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite> across multiple clients due to the non-independent and identically distributed (non-IID) issue,
as illustrated in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
In homogenous scenario (Fig. <a href="#S1.F1.sf2" title="In Figure 1 ‣ 1 Introduction ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(b)</span></a>), each client has a similar local objective function due to the IID data and homogenous devices.
As a result, the global update follows a similar optimization direction as observed in centralized training (Fig. <a href="#S1.F1.sf1" title="In Figure 1 ‣ 1 Introduction ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(a)</span></a>).
Unfortunately, in practice, individual clients in FL often exhibit significant heterogeneity,
as depicted in Fig. <a href="#S1.F1.sf3" title="In Figure 1 ‣ 1 Introduction ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(c)</span></a>.
First, <em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">Heterogenous data</em> induces diverse local optimization directions,
straying from global minima <cite class="ltx_cite ltx_citemacro_citep">(Karimireddy et al., <a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite>.
Moreover, <em id="S1.p2.1.2" class="ltx_emph ltx_font_italic">heterogeneous devices</em> (e.g., client 3 in Fig. <a href="#S1.F1.sf3" title="In Figure 1 ‣ 1 Introduction ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(c)</span></a>) with varying computational speeds and communication capacities exacerbate the situation <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite> ,
leading to decreased convergence rate and compromised performance.
Recently, corresponding solutions have been proposed to address the non-IID issue from different FL steps,
including regularization <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib14" title="" class="ltx_ref">2020</a>; Acar et al., <a href="#bib.bib2" title="" class="ltx_ref">2021</a>; Shi et al., <a href="#bib.bib24" title="" class="ltx_ref">2022</a>)</cite>, contrastive learning <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite>, variance reduction <cite class="ltx_cite ltx_citemacro_citep">(Karimireddy et al., <a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite> during local training,
and normalized averaging <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib28" title="" class="ltx_ref">2020b</a>)</cite>, momentum update <cite class="ltx_cite ltx_citemacro_citep">(Hsu et al., <a href="#bib.bib8" title="" class="ltx_ref">2019</a>; Wang et al., <a href="#bib.bib27" title="" class="ltx_ref">2019a</a>; Reddi et al., <a href="#bib.bib22" title="" class="ltx_ref">2020</a>)</cite> during server aggregation.
Additionally, personalized federated learning (pFL) methods <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib9" title="" class="ltx_ref">2021</a>; Ma et al., <a href="#bib.bib15" title="" class="ltx_ref">2022</a>)</cite> tackle the non-IID issue by training customized local model on each client.
However, these methods are not aware of gradient conflicts across clients or invesgate the relationship between the non-IID issue and the gradient conflict phenomenon in FL.</p>
</div>
<figure id="S1.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S1.F1.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.06692/assets/x1.png" id="S1.F1.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="106" height="81" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S1.F1.sf1.3.2" class="ltx_text" style="font-size:90%;">Centralized training.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S1.F1.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.06692/assets/x2.png" id="S1.F1.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="106" height="80" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S1.F1.sf2.3.2" class="ltx_text" style="font-size:90%;">Homogenous FL.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S1.F1.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.06692/assets/x3.png" id="S1.F1.sf3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="115" height="80" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S1.F1.sf3.3.2" class="ltx_text" style="font-size:90%;">Heterogeneous FL.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">Illustration of optimization directions from centralized training, homogenous FL, and heterogeneous FL with gradient conflicts.</span></figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this work, we propose FedGH, a simple yet effective method that addresses local drifts through Gradient Harmonization.
Since the non-IID issue causes weight divergence <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib32" title="" class="ltx_ref">2018</a>)</cite>, we first study the gradient conflict phenomenon that emerges between local models on the server side.
Intriguingly, we find that as the degree of local heterogeneity increases,
the severity of gradient conflicts escalates. Motivated by this observation,
we subsequently explore the mitigation of local drifts through gradient deconfliction.
Specifically, if two gradients conflict, we execute a projection of one gradient onto the orthogonal plane of the other.
This gradient harmonization strategy aims to enhance client consensus during server aggregation.
Finally, we conduct extensive experiments on three widely used benchmarks, including CIFAR-10, CIFAR-100, and Tiny-ImageNet, with diverse degrees of non-IID challenge.
Experimental results demonstrate that FedGH yields more performance boosting in more severe heterogeneous scenarios while maintaining a consistent improvement over multiple baselines <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib17" title="" class="ltx_ref">2017</a>; Li et al., <a href="#bib.bib14" title="" class="ltx_ref">2020</a>; Wang et al., <a href="#bib.bib28" title="" class="ltx_ref">2020b</a>; Shi et al., <a href="#bib.bib24" title="" class="ltx_ref">2022</a>)</cite>,
including the latest state-of-the-art FedDecorr <cite class="ltx_cite ltx_citemacro_citep">(Shi et al., <a href="#bib.bib24" title="" class="ltx_ref">2022</a>)</cite>.
As a plug-and-play module, FedGH is easily integrated with any FL frameworks, requiring no hyperparameter tuning.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Our contributions in this work can be summarized as follows.
First, we uncover that non-IID issue induces gradient conflicts between local models.
Second, we propose a novel method called FedGH, which effectively mitigates local drifts via gradient harmonization during server aggregation.
Third, we validate the efficacy of FedGH through comprehensive experiments, showcasing its consistent improvement over multiple baselines.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Federated Learning</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib17" title="" class="ltx_ref">2017</a>)</cite> propose a solid baseline in FL termed FedAvg,
which directly averages local models to update the global model.
However, <cite class="ltx_cite ltx_citemacro_cite">Karimireddy et al. (<a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite> identify that FedAvg yields unstable and slow convergence in heterogeneous scenarios,
and <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite> further subdivide the non-IID issue into systems heterogeneity and statistical heterogeneity.
To tackle this key challenge, researchers have elaborated different strategies from different steps of FL.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">During local training, many promising methods focus on regularizing the local objective.
Specifically, <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite> introduce a proximal term to minimize the gap between local and global models,
while <cite class="ltx_cite ltx_citemacro_cite">Acar et al. (<a href="#bib.bib2" title="" class="ltx_ref">2021</a>)</cite> align these models via dynamic regularization.
Additionally, <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite> employ model-level contrastive learning to correct local updates,
and <cite class="ltx_cite ltx_citemacro_cite">Shi et al. (<a href="#bib.bib24" title="" class="ltx_ref">2022</a>)</cite> tackle the non-IID issue from the dimensional collapse perspective.
Moreover, the pursuit of flatter local minima is explored in <cite class="ltx_cite ltx_citemacro_cite">Qu et al. (<a href="#bib.bib20" title="" class="ltx_ref">2022</a>)</cite> and <cite class="ltx_cite ltx_citemacro_cite">Caldarola et al. (<a href="#bib.bib3" title="" class="ltx_ref">2022</a>)</cite> by applying a sharpness-aware optimizer.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p">On the server side, aggregation of local models and updating of the global model are two directions for addressing the non-IID problem.
<cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a href="#bib.bib28" title="" class="ltx_ref">2020b</a>)</cite> propose a normalized averaging scheme instead of the naïve aggregation in FedAvg.
In addition, <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a href="#bib.bib26" title="" class="ltx_ref">2020a</a>)</cite> and <cite class="ltx_cite ltx_citemacro_cite">Ma et al. (<a href="#bib.bib15" title="" class="ltx_ref">2022</a>)</cite> aggregate local models in a layer-wise manner, while <cite class="ltx_cite ltx_citemacro_cite">Uddin et al. (<a href="#bib.bib25" title="" class="ltx_ref">2022</a>)</cite> introduce an outlier pruning strategy before aggregation.
On the other hand, <cite class="ltx_cite ltx_citemacro_cite">Hsu et al. (<a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite>, <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a href="#bib.bib27" title="" class="ltx_ref">2019a</a>)</cite>, and <cite class="ltx_cite ltx_citemacro_cite">Reddi et al. (<a href="#bib.bib22" title="" class="ltx_ref">2020</a>)</cite> demonstrate that incorporating momentum-based updates into the global model is beneficial for mitigating local drift.
However, our proposed FedGH is orthogonal to these methods and can be easily embedded in other FL frameworks.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Gradient Surgery</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_cite">Yu et al. (<a href="#bib.bib31" title="" class="ltx_ref">2020</a>)</cite> first identify that conflicting gradients lead to performance degradation in multi-task learning,
introducing PCGrad to enhance optimization performance via gradient surgery.
Subsequently, <cite class="ltx_cite ltx_citemacro_cite">Mansilla et al. (<a href="#bib.bib16" title="" class="ltx_ref">2021</a>)</cite> extend this insight to domain generation, presenting two gradient agreement strategies to alleviate gradient conflict.
Moreover, DOHA introduce a sample-wise gradient deconfliction technique to boost generalization performance. In contrast, we uncover the gradient conflict phenomenon in FL caused by the non-IID issue.
Our work centers on client-wise gradient harmonization during server aggregation rather than gradient surgery in every training iteration <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a href="#bib.bib31" title="" class="ltx_ref">2020</a>; Mansilla et al., <a href="#bib.bib16" title="" class="ltx_ref">2021</a>)</cite>. Thus, FedGH is computationally efficient without introducing any extra communication costs.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Problem Definition</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.10" class="ltx_p">FedGH aims to collaboratively learn a generalized model <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">w</annotation></semantics></math> from <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">K</annotation></semantics></math> clients over the dataset <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{D}=\cup_{k\in[K]}\mathcal{D}_{k}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.2" xref="S3.SS1.p1.3.m3.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.2.2" xref="S3.SS1.p1.3.m3.1.2.2.cmml">𝒟</mi><mo rspace="0em" id="S3.SS1.p1.3.m3.1.2.1" xref="S3.SS1.p1.3.m3.1.2.1.cmml">=</mo><mrow id="S3.SS1.p1.3.m3.1.2.3" xref="S3.SS1.p1.3.m3.1.2.3.cmml"><msub id="S3.SS1.p1.3.m3.1.2.3.1" xref="S3.SS1.p1.3.m3.1.2.3.1.cmml"><mo lspace="0em" id="S3.SS1.p1.3.m3.1.2.3.1.2" xref="S3.SS1.p1.3.m3.1.2.3.1.2.cmml">∪</mo><mrow id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.1.3" xref="S3.SS1.p1.3.m3.1.1.1.3.cmml">k</mi><mo id="S3.SS1.p1.3.m3.1.1.1.2" xref="S3.SS1.p1.3.m3.1.1.1.2.cmml">∈</mo><mrow id="S3.SS1.p1.3.m3.1.1.1.4.2" xref="S3.SS1.p1.3.m3.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.SS1.p1.3.m3.1.1.1.4.2.1" xref="S3.SS1.p1.3.m3.1.1.1.4.1.1.cmml">[</mo><mi id="S3.SS1.p1.3.m3.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.cmml">K</mi><mo stretchy="false" id="S3.SS1.p1.3.m3.1.1.1.4.2.2" xref="S3.SS1.p1.3.m3.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></msub><msub id="S3.SS1.p1.3.m3.1.2.3.2" xref="S3.SS1.p1.3.m3.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.2.3.2.2" xref="S3.SS1.p1.3.m3.1.2.3.2.2.cmml">𝒟</mi><mi id="S3.SS1.p1.3.m3.1.2.3.2.3" xref="S3.SS1.p1.3.m3.1.2.3.2.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.2.cmml" xref="S3.SS1.p1.3.m3.1.2"><eq id="S3.SS1.p1.3.m3.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.2.1"></eq><ci id="S3.SS1.p1.3.m3.1.2.2.cmml" xref="S3.SS1.p1.3.m3.1.2.2">𝒟</ci><apply id="S3.SS1.p1.3.m3.1.2.3.cmml" xref="S3.SS1.p1.3.m3.1.2.3"><apply id="S3.SS1.p1.3.m3.1.2.3.1.cmml" xref="S3.SS1.p1.3.m3.1.2.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.2.3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.2.3.1">subscript</csymbol><union id="S3.SS1.p1.3.m3.1.2.3.1.2.cmml" xref="S3.SS1.p1.3.m3.1.2.3.1.2"></union><apply id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1"><in id="S3.SS1.p1.3.m3.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.2"></in><ci id="S3.SS1.p1.3.m3.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.3">𝑘</ci><apply id="S3.SS1.p1.3.m3.1.1.1.4.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.4.2"><csymbol cd="latexml" id="S3.SS1.p1.3.m3.1.1.1.4.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.SS1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1">𝐾</ci></apply></apply></apply><apply id="S3.SS1.p1.3.m3.1.2.3.2.cmml" xref="S3.SS1.p1.3.m3.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.2.3.2.1.cmml" xref="S3.SS1.p1.3.m3.1.2.3.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.2.3.2.2.cmml" xref="S3.SS1.p1.3.m3.1.2.3.2.2">𝒟</ci><ci id="S3.SS1.p1.3.m3.1.2.3.2.3.cmml" xref="S3.SS1.p1.3.m3.1.2.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\mathcal{D}=\cup_{k\in[K]}\mathcal{D}_{k}</annotation></semantics></math>.
The global objective is min<math id="S3.SS1.p1.4.m4.2" class="ltx_Math" alttext="{}_{w}L(w)=\sum_{k=1}^{K}\frac{n_{k}}{n}L_{k}(w)" display="inline"><semantics id="S3.SS1.p1.4.m4.2a"><mrow id="S3.SS1.p1.4.m4.2.3" xref="S3.SS1.p1.4.m4.2.3.cmml"><mrow id="S3.SS1.p1.4.m4.2.3.2" xref="S3.SS1.p1.4.m4.2.3.2.cmml"><mmultiscripts id="S3.SS1.p1.4.m4.2.3.2.2" xref="S3.SS1.p1.4.m4.2.3.2.2.cmml"><mi id="S3.SS1.p1.4.m4.2.3.2.2.2" xref="S3.SS1.p1.4.m4.2.3.2.2.2.cmml">L</mi><mprescripts id="S3.SS1.p1.4.m4.2.3.2.2a" xref="S3.SS1.p1.4.m4.2.3.2.2.cmml"></mprescripts><mi id="S3.SS1.p1.4.m4.2.3.2.2.3" xref="S3.SS1.p1.4.m4.2.3.2.2.3.cmml">w</mi><mrow id="S3.SS1.p1.4.m4.2.3.2.2b" xref="S3.SS1.p1.4.m4.2.3.2.2.cmml"></mrow></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.SS1.p1.4.m4.2.3.2.1" xref="S3.SS1.p1.4.m4.2.3.2.1.cmml">​</mo><mrow id="S3.SS1.p1.4.m4.2.3.2.3.2" xref="S3.SS1.p1.4.m4.2.3.2.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m4.2.3.2.3.2.1" xref="S3.SS1.p1.4.m4.2.3.2.cmml">(</mo><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">w</mi><mo stretchy="false" id="S3.SS1.p1.4.m4.2.3.2.3.2.2" xref="S3.SS1.p1.4.m4.2.3.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.SS1.p1.4.m4.2.3.1" xref="S3.SS1.p1.4.m4.2.3.1.cmml">=</mo><mrow id="S3.SS1.p1.4.m4.2.3.3" xref="S3.SS1.p1.4.m4.2.3.3.cmml"><msubsup id="S3.SS1.p1.4.m4.2.3.3.1" xref="S3.SS1.p1.4.m4.2.3.3.1.cmml"><mo id="S3.SS1.p1.4.m4.2.3.3.1.2.2" xref="S3.SS1.p1.4.m4.2.3.3.1.2.2.cmml">∑</mo><mrow id="S3.SS1.p1.4.m4.2.3.3.1.2.3" xref="S3.SS1.p1.4.m4.2.3.3.1.2.3.cmml"><mi id="S3.SS1.p1.4.m4.2.3.3.1.2.3.2" xref="S3.SS1.p1.4.m4.2.3.3.1.2.3.2.cmml">k</mi><mo id="S3.SS1.p1.4.m4.2.3.3.1.2.3.1" xref="S3.SS1.p1.4.m4.2.3.3.1.2.3.1.cmml">=</mo><mn id="S3.SS1.p1.4.m4.2.3.3.1.2.3.3" xref="S3.SS1.p1.4.m4.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.4.m4.2.3.3.1.3" xref="S3.SS1.p1.4.m4.2.3.3.1.3.cmml">K</mi></msubsup><mrow id="S3.SS1.p1.4.m4.2.3.3.2" xref="S3.SS1.p1.4.m4.2.3.3.2.cmml"><mfrac id="S3.SS1.p1.4.m4.2.3.3.2.2" xref="S3.SS1.p1.4.m4.2.3.3.2.2.cmml"><msub id="S3.SS1.p1.4.m4.2.3.3.2.2.2" xref="S3.SS1.p1.4.m4.2.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.4.m4.2.3.3.2.2.2.2" xref="S3.SS1.p1.4.m4.2.3.3.2.2.2.2.cmml">n</mi><mi id="S3.SS1.p1.4.m4.2.3.3.2.2.2.3" xref="S3.SS1.p1.4.m4.2.3.3.2.2.2.3.cmml">k</mi></msub><mi id="S3.SS1.p1.4.m4.2.3.3.2.2.3" xref="S3.SS1.p1.4.m4.2.3.3.2.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.SS1.p1.4.m4.2.3.3.2.1" xref="S3.SS1.p1.4.m4.2.3.3.2.1.cmml">​</mo><msub id="S3.SS1.p1.4.m4.2.3.3.2.3" xref="S3.SS1.p1.4.m4.2.3.3.2.3.cmml"><mi id="S3.SS1.p1.4.m4.2.3.3.2.3.2" xref="S3.SS1.p1.4.m4.2.3.3.2.3.2.cmml">L</mi><mi id="S3.SS1.p1.4.m4.2.3.3.2.3.3" xref="S3.SS1.p1.4.m4.2.3.3.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.4.m4.2.3.3.2.1a" xref="S3.SS1.p1.4.m4.2.3.3.2.1.cmml">​</mo><mrow id="S3.SS1.p1.4.m4.2.3.3.2.4.2" xref="S3.SS1.p1.4.m4.2.3.3.2.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m4.2.3.3.2.4.2.1" xref="S3.SS1.p1.4.m4.2.3.3.2.cmml">(</mo><mi id="S3.SS1.p1.4.m4.2.2" xref="S3.SS1.p1.4.m4.2.2.cmml">w</mi><mo stretchy="false" id="S3.SS1.p1.4.m4.2.3.3.2.4.2.2" xref="S3.SS1.p1.4.m4.2.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.2b"><apply id="S3.SS1.p1.4.m4.2.3.cmml" xref="S3.SS1.p1.4.m4.2.3"><eq id="S3.SS1.p1.4.m4.2.3.1.cmml" xref="S3.SS1.p1.4.m4.2.3.1"></eq><apply id="S3.SS1.p1.4.m4.2.3.2.cmml" xref="S3.SS1.p1.4.m4.2.3.2"><times id="S3.SS1.p1.4.m4.2.3.2.1.cmml" xref="S3.SS1.p1.4.m4.2.3.2.1"></times><apply id="S3.SS1.p1.4.m4.2.3.2.2.cmml" xref="S3.SS1.p1.4.m4.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.3.2.2.1.cmml" xref="S3.SS1.p1.4.m4.2.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.2.3.2.2.2.cmml" xref="S3.SS1.p1.4.m4.2.3.2.2.2">𝐿</ci><ci id="S3.SS1.p1.4.m4.2.3.2.2.3.cmml" xref="S3.SS1.p1.4.m4.2.3.2.2.3">𝑤</ci></apply><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑤</ci></apply><apply id="S3.SS1.p1.4.m4.2.3.3.cmml" xref="S3.SS1.p1.4.m4.2.3.3"><apply id="S3.SS1.p1.4.m4.2.3.3.1.cmml" xref="S3.SS1.p1.4.m4.2.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.3.3.1.1.cmml" xref="S3.SS1.p1.4.m4.2.3.3.1">superscript</csymbol><apply id="S3.SS1.p1.4.m4.2.3.3.1.2.cmml" xref="S3.SS1.p1.4.m4.2.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.3.3.1.2.1.cmml" xref="S3.SS1.p1.4.m4.2.3.3.1">subscript</csymbol><sum id="S3.SS1.p1.4.m4.2.3.3.1.2.2.cmml" xref="S3.SS1.p1.4.m4.2.3.3.1.2.2"></sum><apply id="S3.SS1.p1.4.m4.2.3.3.1.2.3.cmml" xref="S3.SS1.p1.4.m4.2.3.3.1.2.3"><eq id="S3.SS1.p1.4.m4.2.3.3.1.2.3.1.cmml" xref="S3.SS1.p1.4.m4.2.3.3.1.2.3.1"></eq><ci id="S3.SS1.p1.4.m4.2.3.3.1.2.3.2.cmml" xref="S3.SS1.p1.4.m4.2.3.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS1.p1.4.m4.2.3.3.1.2.3.3.cmml" xref="S3.SS1.p1.4.m4.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.4.m4.2.3.3.1.3.cmml" xref="S3.SS1.p1.4.m4.2.3.3.1.3">𝐾</ci></apply><apply id="S3.SS1.p1.4.m4.2.3.3.2.cmml" xref="S3.SS1.p1.4.m4.2.3.3.2"><times id="S3.SS1.p1.4.m4.2.3.3.2.1.cmml" xref="S3.SS1.p1.4.m4.2.3.3.2.1"></times><apply id="S3.SS1.p1.4.m4.2.3.3.2.2.cmml" xref="S3.SS1.p1.4.m4.2.3.3.2.2"><divide id="S3.SS1.p1.4.m4.2.3.3.2.2.1.cmml" xref="S3.SS1.p1.4.m4.2.3.3.2.2"></divide><apply id="S3.SS1.p1.4.m4.2.3.3.2.2.2.cmml" xref="S3.SS1.p1.4.m4.2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.4.m4.2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.2.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.2.3.3.2.2.2.2">𝑛</ci><ci id="S3.SS1.p1.4.m4.2.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.4.m4.2.3.3.2.2.2.3">𝑘</ci></apply><ci id="S3.SS1.p1.4.m4.2.3.3.2.2.3.cmml" xref="S3.SS1.p1.4.m4.2.3.3.2.2.3">𝑛</ci></apply><apply id="S3.SS1.p1.4.m4.2.3.3.2.3.cmml" xref="S3.SS1.p1.4.m4.2.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.3.3.2.3.1.cmml" xref="S3.SS1.p1.4.m4.2.3.3.2.3">subscript</csymbol><ci id="S3.SS1.p1.4.m4.2.3.3.2.3.2.cmml" xref="S3.SS1.p1.4.m4.2.3.3.2.3.2">𝐿</ci><ci id="S3.SS1.p1.4.m4.2.3.3.2.3.3.cmml" xref="S3.SS1.p1.4.m4.2.3.3.2.3.3">𝑘</ci></apply><ci id="S3.SS1.p1.4.m4.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.2c">{}_{w}L(w)=\sum_{k=1}^{K}\frac{n_{k}}{n}L_{k}(w)</annotation></semantics></math>,
where <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="n=\sum_{k=1}^{K}n_{k}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mrow id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">n</mi><mo rspace="0.111em" id="S3.SS1.p1.5.m5.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.cmml">=</mo><mrow id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml"><msubsup id="S3.SS1.p1.5.m5.1.1.3.1" xref="S3.SS1.p1.5.m5.1.1.3.1.cmml"><mo id="S3.SS1.p1.5.m5.1.1.3.1.2.2" xref="S3.SS1.p1.5.m5.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.SS1.p1.5.m5.1.1.3.1.2.3" xref="S3.SS1.p1.5.m5.1.1.3.1.2.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.3.1.2.3.2" xref="S3.SS1.p1.5.m5.1.1.3.1.2.3.2.cmml">k</mi><mo id="S3.SS1.p1.5.m5.1.1.3.1.2.3.1" xref="S3.SS1.p1.5.m5.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.SS1.p1.5.m5.1.1.3.1.2.3.3" xref="S3.SS1.p1.5.m5.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.5.m5.1.1.3.1.3" xref="S3.SS1.p1.5.m5.1.1.3.1.3.cmml">K</mi></msubsup><msub id="S3.SS1.p1.5.m5.1.1.3.2" xref="S3.SS1.p1.5.m5.1.1.3.2.cmml"><mi id="S3.SS1.p1.5.m5.1.1.3.2.2" xref="S3.SS1.p1.5.m5.1.1.3.2.2.cmml">n</mi><mi id="S3.SS1.p1.5.m5.1.1.3.2.3" xref="S3.SS1.p1.5.m5.1.1.3.2.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><eq id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1"></eq><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝑛</ci><apply id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3"><apply id="S3.SS1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.3.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.1">superscript</csymbol><apply id="S3.SS1.p1.5.m5.1.1.3.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.3.1.2.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.1">subscript</csymbol><sum id="S3.SS1.p1.5.m5.1.1.3.1.2.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.1.2.2"></sum><apply id="S3.SS1.p1.5.m5.1.1.3.1.2.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.1.2.3"><eq id="S3.SS1.p1.5.m5.1.1.3.1.2.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.1.2.3.1"></eq><ci id="S3.SS1.p1.5.m5.1.1.3.1.2.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS1.p1.5.m5.1.1.3.1.2.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.5.m5.1.1.3.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.1.3">𝐾</ci></apply><apply id="S3.SS1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.3.2.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.3.2.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2.2">𝑛</ci><ci id="S3.SS1.p1.5.m5.1.1.3.2.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">n=\sum_{k=1}^{K}n_{k}</annotation></semantics></math> is the number of samples in <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\mathcal{D}</annotation></semantics></math>. For client <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">k</annotation></semantics></math>, <math id="S3.SS1.p1.8.m8.7" class="ltx_Math" alttext="L_{k}(w)=\mathbb{E}_{(x,y)\sim\mathcal{D}_{k}}\ell(w;(x,y))" display="inline"><semantics id="S3.SS1.p1.8.m8.7a"><mrow id="S3.SS1.p1.8.m8.7.7" xref="S3.SS1.p1.8.m8.7.7.cmml"><mrow id="S3.SS1.p1.8.m8.7.7.3" xref="S3.SS1.p1.8.m8.7.7.3.cmml"><msub id="S3.SS1.p1.8.m8.7.7.3.2" xref="S3.SS1.p1.8.m8.7.7.3.2.cmml"><mi id="S3.SS1.p1.8.m8.7.7.3.2.2" xref="S3.SS1.p1.8.m8.7.7.3.2.2.cmml">L</mi><mi id="S3.SS1.p1.8.m8.7.7.3.2.3" xref="S3.SS1.p1.8.m8.7.7.3.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.8.m8.7.7.3.1" xref="S3.SS1.p1.8.m8.7.7.3.1.cmml">​</mo><mrow id="S3.SS1.p1.8.m8.7.7.3.3.2" xref="S3.SS1.p1.8.m8.7.7.3.cmml"><mo stretchy="false" id="S3.SS1.p1.8.m8.7.7.3.3.2.1" xref="S3.SS1.p1.8.m8.7.7.3.cmml">(</mo><mi id="S3.SS1.p1.8.m8.3.3" xref="S3.SS1.p1.8.m8.3.3.cmml">w</mi><mo stretchy="false" id="S3.SS1.p1.8.m8.7.7.3.3.2.2" xref="S3.SS1.p1.8.m8.7.7.3.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.8.m8.7.7.2" xref="S3.SS1.p1.8.m8.7.7.2.cmml">=</mo><mrow id="S3.SS1.p1.8.m8.7.7.1" xref="S3.SS1.p1.8.m8.7.7.1.cmml"><msub id="S3.SS1.p1.8.m8.7.7.1.3" xref="S3.SS1.p1.8.m8.7.7.1.3.cmml"><mi id="S3.SS1.p1.8.m8.7.7.1.3.2" xref="S3.SS1.p1.8.m8.7.7.1.3.2.cmml">𝔼</mi><mrow id="S3.SS1.p1.8.m8.2.2.2" xref="S3.SS1.p1.8.m8.2.2.2.cmml"><mrow id="S3.SS1.p1.8.m8.2.2.2.4.2" xref="S3.SS1.p1.8.m8.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.SS1.p1.8.m8.2.2.2.4.2.1" xref="S3.SS1.p1.8.m8.2.2.2.4.1.cmml">(</mo><mi id="S3.SS1.p1.8.m8.1.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.1.cmml">x</mi><mo id="S3.SS1.p1.8.m8.2.2.2.4.2.2" xref="S3.SS1.p1.8.m8.2.2.2.4.1.cmml">,</mo><mi id="S3.SS1.p1.8.m8.2.2.2.2" xref="S3.SS1.p1.8.m8.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS1.p1.8.m8.2.2.2.4.2.3" xref="S3.SS1.p1.8.m8.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.SS1.p1.8.m8.2.2.2.3" xref="S3.SS1.p1.8.m8.2.2.2.3.cmml">∼</mo><msub id="S3.SS1.p1.8.m8.2.2.2.5" xref="S3.SS1.p1.8.m8.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.2.2.2.5.2" xref="S3.SS1.p1.8.m8.2.2.2.5.2.cmml">𝒟</mi><mi id="S3.SS1.p1.8.m8.2.2.2.5.3" xref="S3.SS1.p1.8.m8.2.2.2.5.3.cmml">k</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.8.m8.7.7.1.2" xref="S3.SS1.p1.8.m8.7.7.1.2.cmml">​</mo><mi mathvariant="normal" id="S3.SS1.p1.8.m8.7.7.1.4" xref="S3.SS1.p1.8.m8.7.7.1.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.8.m8.7.7.1.2a" xref="S3.SS1.p1.8.m8.7.7.1.2.cmml">​</mo><mrow id="S3.SS1.p1.8.m8.7.7.1.1.1" xref="S3.SS1.p1.8.m8.7.7.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.8.m8.7.7.1.1.1.2" xref="S3.SS1.p1.8.m8.7.7.1.1.2.cmml">(</mo><mi id="S3.SS1.p1.8.m8.6.6" xref="S3.SS1.p1.8.m8.6.6.cmml">w</mi><mo id="S3.SS1.p1.8.m8.7.7.1.1.1.3" xref="S3.SS1.p1.8.m8.7.7.1.1.2.cmml">;</mo><mrow id="S3.SS1.p1.8.m8.7.7.1.1.1.1.2" xref="S3.SS1.p1.8.m8.7.7.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.8.m8.7.7.1.1.1.1.2.1" xref="S3.SS1.p1.8.m8.7.7.1.1.1.1.1.cmml">(</mo><mi id="S3.SS1.p1.8.m8.4.4" xref="S3.SS1.p1.8.m8.4.4.cmml">x</mi><mo id="S3.SS1.p1.8.m8.7.7.1.1.1.1.2.2" xref="S3.SS1.p1.8.m8.7.7.1.1.1.1.1.cmml">,</mo><mi id="S3.SS1.p1.8.m8.5.5" xref="S3.SS1.p1.8.m8.5.5.cmml">y</mi><mo stretchy="false" id="S3.SS1.p1.8.m8.7.7.1.1.1.1.2.3" xref="S3.SS1.p1.8.m8.7.7.1.1.1.1.1.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS1.p1.8.m8.7.7.1.1.1.4" xref="S3.SS1.p1.8.m8.7.7.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.7b"><apply id="S3.SS1.p1.8.m8.7.7.cmml" xref="S3.SS1.p1.8.m8.7.7"><eq id="S3.SS1.p1.8.m8.7.7.2.cmml" xref="S3.SS1.p1.8.m8.7.7.2"></eq><apply id="S3.SS1.p1.8.m8.7.7.3.cmml" xref="S3.SS1.p1.8.m8.7.7.3"><times id="S3.SS1.p1.8.m8.7.7.3.1.cmml" xref="S3.SS1.p1.8.m8.7.7.3.1"></times><apply id="S3.SS1.p1.8.m8.7.7.3.2.cmml" xref="S3.SS1.p1.8.m8.7.7.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.7.7.3.2.1.cmml" xref="S3.SS1.p1.8.m8.7.7.3.2">subscript</csymbol><ci id="S3.SS1.p1.8.m8.7.7.3.2.2.cmml" xref="S3.SS1.p1.8.m8.7.7.3.2.2">𝐿</ci><ci id="S3.SS1.p1.8.m8.7.7.3.2.3.cmml" xref="S3.SS1.p1.8.m8.7.7.3.2.3">𝑘</ci></apply><ci id="S3.SS1.p1.8.m8.3.3.cmml" xref="S3.SS1.p1.8.m8.3.3">𝑤</ci></apply><apply id="S3.SS1.p1.8.m8.7.7.1.cmml" xref="S3.SS1.p1.8.m8.7.7.1"><times id="S3.SS1.p1.8.m8.7.7.1.2.cmml" xref="S3.SS1.p1.8.m8.7.7.1.2"></times><apply id="S3.SS1.p1.8.m8.7.7.1.3.cmml" xref="S3.SS1.p1.8.m8.7.7.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.7.7.1.3.1.cmml" xref="S3.SS1.p1.8.m8.7.7.1.3">subscript</csymbol><ci id="S3.SS1.p1.8.m8.7.7.1.3.2.cmml" xref="S3.SS1.p1.8.m8.7.7.1.3.2">𝔼</ci><apply id="S3.SS1.p1.8.m8.2.2.2.cmml" xref="S3.SS1.p1.8.m8.2.2.2"><csymbol cd="latexml" id="S3.SS1.p1.8.m8.2.2.2.3.cmml" xref="S3.SS1.p1.8.m8.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.SS1.p1.8.m8.2.2.2.4.1.cmml" xref="S3.SS1.p1.8.m8.2.2.2.4.2"><ci id="S3.SS1.p1.8.m8.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1">𝑥</ci><ci id="S3.SS1.p1.8.m8.2.2.2.2.cmml" xref="S3.SS1.p1.8.m8.2.2.2.2">𝑦</ci></interval><apply id="S3.SS1.p1.8.m8.2.2.2.5.cmml" xref="S3.SS1.p1.8.m8.2.2.2.5"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.2.2.2.5.1.cmml" xref="S3.SS1.p1.8.m8.2.2.2.5">subscript</csymbol><ci id="S3.SS1.p1.8.m8.2.2.2.5.2.cmml" xref="S3.SS1.p1.8.m8.2.2.2.5.2">𝒟</ci><ci id="S3.SS1.p1.8.m8.2.2.2.5.3.cmml" xref="S3.SS1.p1.8.m8.2.2.2.5.3">𝑘</ci></apply></apply></apply><ci id="S3.SS1.p1.8.m8.7.7.1.4.cmml" xref="S3.SS1.p1.8.m8.7.7.1.4">ℓ</ci><list id="S3.SS1.p1.8.m8.7.7.1.1.2.cmml" xref="S3.SS1.p1.8.m8.7.7.1.1.1"><ci id="S3.SS1.p1.8.m8.6.6.cmml" xref="S3.SS1.p1.8.m8.6.6">𝑤</ci><interval closure="open" id="S3.SS1.p1.8.m8.7.7.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.7.7.1.1.1.1.2"><ci id="S3.SS1.p1.8.m8.4.4.cmml" xref="S3.SS1.p1.8.m8.4.4">𝑥</ci><ci id="S3.SS1.p1.8.m8.5.5.cmml" xref="S3.SS1.p1.8.m8.5.5">𝑦</ci></interval></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.7c">L_{k}(w)=\mathbb{E}_{(x,y)\sim\mathcal{D}_{k}}\ell(w;(x,y))</annotation></semantics></math>,
where <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><msub id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2">𝒟</ci><ci id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">\mathcal{D}_{k}</annotation></semantics></math> is the local dataset.
Noteworthy, data is typically non-IID among <math id="S3.SS1.p1.10.m10.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.10.m10.1a"><mi id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><ci id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">K</annotation></semantics></math> clients and cannot be shared due to privacy constraints.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Gradient Conflict in Heterogeneous FL</h3>

<figure id="S3.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.06692/assets/x4.png" id="S3.F2.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="151" height="80" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S3.F2.sf1.3.2" class="ltx_text" style="font-size:90%;">Sorted similarity of gradient vectors between 5 clients.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.06692/assets/x5.png" id="S3.F2.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="121" height="92" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S3.F2.sf2.3.2" class="ltx_text" style="font-size:90%;">Gradient conflict ratio during training.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.F2.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.06692/assets/x6.png" id="S3.F2.sf3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="287" height="95" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S3.F2.sf3.3.2" class="ltx_text" style="font-size:90%;">Sorted similarity of gradient vectors between 10 clients.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.8.4.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.6.3" class="ltx_text" style="font-size:90%;">The non-IID issue causes gradient conflicts among (a) 5 and (c) 10 clients, with <math id="S3.F2.4.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.F2.4.1.m1.1b"><mi id="S3.F2.4.1.m1.1.1" xref="S3.F2.4.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.F2.4.1.m1.1c"><ci id="S3.F2.4.1.m1.1.1.cmml" xref="S3.F2.4.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.4.1.m1.1d">\alpha</annotation></semantics></math> = 0.1 and 0.01, respectively. The <math id="S3.F2.5.2.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.F2.5.2.m2.1b"><mi id="S3.F2.5.2.m2.1.1" xref="S3.F2.5.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.F2.5.2.m2.1c"><ci id="S3.F2.5.2.m2.1.1.cmml" xref="S3.F2.5.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.5.2.m2.1d">x</annotation></semantics></math>-axis is client index pairs, while the <math id="S3.F2.6.3.m3.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.F2.6.3.m3.1b"><mi id="S3.F2.6.3.m3.1.1" xref="S3.F2.6.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.F2.6.3.m3.1c"><ci id="S3.F2.6.3.m3.1.1.cmml" xref="S3.F2.6.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.6.3.m3.1d">y</annotation></semantics></math>-axis
shows cosine similarity between gradient vectors. The change in gradient conflict ratio during training is depicted in (b).</span></figcaption>
</figure>
<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.12" class="ltx_p">We first probe the gradient conflict phenomenon under different degrees of non-IID.
Toward this end, we first simulate the non-IID data among different clients using the Dirichlet distribution <cite class="ltx_cite ltx_citemacro_citep">(Hsu et al., <a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite>.
Specifically, we sample <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="P_{c}\sim Dir_{K}(\alpha)" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.2" xref="S3.SS2.p1.1.m1.1.2.cmml"><msub id="S3.SS2.p1.1.m1.1.2.2" xref="S3.SS2.p1.1.m1.1.2.2.cmml"><mi id="S3.SS2.p1.1.m1.1.2.2.2" xref="S3.SS2.p1.1.m1.1.2.2.2.cmml">P</mi><mi id="S3.SS2.p1.1.m1.1.2.2.3" xref="S3.SS2.p1.1.m1.1.2.2.3.cmml">c</mi></msub><mo id="S3.SS2.p1.1.m1.1.2.1" xref="S3.SS2.p1.1.m1.1.2.1.cmml">∼</mo><mrow id="S3.SS2.p1.1.m1.1.2.3" xref="S3.SS2.p1.1.m1.1.2.3.cmml"><mi id="S3.SS2.p1.1.m1.1.2.3.2" xref="S3.SS2.p1.1.m1.1.2.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.1.2.3.1" xref="S3.SS2.p1.1.m1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.p1.1.m1.1.2.3.3" xref="S3.SS2.p1.1.m1.1.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.1.2.3.1a" xref="S3.SS2.p1.1.m1.1.2.3.1.cmml">​</mo><msub id="S3.SS2.p1.1.m1.1.2.3.4" xref="S3.SS2.p1.1.m1.1.2.3.4.cmml"><mi id="S3.SS2.p1.1.m1.1.2.3.4.2" xref="S3.SS2.p1.1.m1.1.2.3.4.2.cmml">r</mi><mi id="S3.SS2.p1.1.m1.1.2.3.4.3" xref="S3.SS2.p1.1.m1.1.2.3.4.3.cmml">K</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.1.2.3.1b" xref="S3.SS2.p1.1.m1.1.2.3.1.cmml">​</mo><mrow id="S3.SS2.p1.1.m1.1.2.3.5.2" xref="S3.SS2.p1.1.m1.1.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.1.2.3.5.2.1" xref="S3.SS2.p1.1.m1.1.2.3.cmml">(</mo><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">α</mi><mo stretchy="false" id="S3.SS2.p1.1.m1.1.2.3.5.2.2" xref="S3.SS2.p1.1.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.2"><csymbol cd="latexml" id="S3.SS2.p1.1.m1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.1.2.1">similar-to</csymbol><apply id="S3.SS2.p1.1.m1.1.2.2.cmml" xref="S3.SS2.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.2.2.1.cmml" xref="S3.SS2.p1.1.m1.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.2.2.2.cmml" xref="S3.SS2.p1.1.m1.1.2.2.2">𝑃</ci><ci id="S3.SS2.p1.1.m1.1.2.2.3.cmml" xref="S3.SS2.p1.1.m1.1.2.2.3">𝑐</ci></apply><apply id="S3.SS2.p1.1.m1.1.2.3.cmml" xref="S3.SS2.p1.1.m1.1.2.3"><times id="S3.SS2.p1.1.m1.1.2.3.1.cmml" xref="S3.SS2.p1.1.m1.1.2.3.1"></times><ci id="S3.SS2.p1.1.m1.1.2.3.2.cmml" xref="S3.SS2.p1.1.m1.1.2.3.2">𝐷</ci><ci id="S3.SS2.p1.1.m1.1.2.3.3.cmml" xref="S3.SS2.p1.1.m1.1.2.3.3">𝑖</ci><apply id="S3.SS2.p1.1.m1.1.2.3.4.cmml" xref="S3.SS2.p1.1.m1.1.2.3.4"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.2.3.4.1.cmml" xref="S3.SS2.p1.1.m1.1.2.3.4">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.2.3.4.2.cmml" xref="S3.SS2.p1.1.m1.1.2.3.4.2">𝑟</ci><ci id="S3.SS2.p1.1.m1.1.2.3.4.3.cmml" xref="S3.SS2.p1.1.m1.1.2.3.4.3">𝐾</ci></apply><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝛼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">P_{c}\sim Dir_{K}(\alpha)</annotation></semantics></math> and allocate a <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="p_{c}^{k}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msubsup id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2.2" xref="S3.SS2.p1.2.m2.1.1.2.2.cmml">p</mi><mi id="S3.SS2.p1.2.m2.1.1.2.3" xref="S3.SS2.p1.2.m2.1.1.2.3.cmml">c</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">superscript</csymbol><apply id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2">𝑝</ci><ci id="S3.SS2.p1.2.m2.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3">𝑐</ci></apply><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">p_{c}^{k}</annotation></semantics></math> proportion of the samples of class <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">c</annotation></semantics></math> to client <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">k</annotation></semantics></math>.
Here, <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\alpha</annotation></semantics></math> denotes the concentration parameter, with smaller values indicating stronger heterogeneity.
In non-IID scenarios, we set <math id="S3.SS2.p1.6.m6.2" class="ltx_Math" alttext="\alpha\in\{0.01,0.1\}" display="inline"><semantics id="S3.SS2.p1.6.m6.2a"><mrow id="S3.SS2.p1.6.m6.2.3" xref="S3.SS2.p1.6.m6.2.3.cmml"><mi id="S3.SS2.p1.6.m6.2.3.2" xref="S3.SS2.p1.6.m6.2.3.2.cmml">α</mi><mo id="S3.SS2.p1.6.m6.2.3.1" xref="S3.SS2.p1.6.m6.2.3.1.cmml">∈</mo><mrow id="S3.SS2.p1.6.m6.2.3.3.2" xref="S3.SS2.p1.6.m6.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p1.6.m6.2.3.3.2.1" xref="S3.SS2.p1.6.m6.2.3.3.1.cmml">{</mo><mn id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">0.01</mn><mo id="S3.SS2.p1.6.m6.2.3.3.2.2" xref="S3.SS2.p1.6.m6.2.3.3.1.cmml">,</mo><mn id="S3.SS2.p1.6.m6.2.2" xref="S3.SS2.p1.6.m6.2.2.cmml">0.1</mn><mo stretchy="false" id="S3.SS2.p1.6.m6.2.3.3.2.3" xref="S3.SS2.p1.6.m6.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.2b"><apply id="S3.SS2.p1.6.m6.2.3.cmml" xref="S3.SS2.p1.6.m6.2.3"><in id="S3.SS2.p1.6.m6.2.3.1.cmml" xref="S3.SS2.p1.6.m6.2.3.1"></in><ci id="S3.SS2.p1.6.m6.2.3.2.cmml" xref="S3.SS2.p1.6.m6.2.3.2">𝛼</ci><set id="S3.SS2.p1.6.m6.2.3.3.1.cmml" xref="S3.SS2.p1.6.m6.2.3.3.2"><cn type="float" id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">0.01</cn><cn type="float" id="S3.SS2.p1.6.m6.2.2.cmml" xref="S3.SS2.p1.6.m6.2.2">0.1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.2c">\alpha\in\{0.01,0.1\}</annotation></semantics></math>, and also set <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="\alpha=\infty" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mrow id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">α</mi><mo id="S3.SS2.p1.7.m7.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.cmml">=</mo><mi mathvariant="normal" id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><eq id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1"></eq><ci id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2">𝛼</ci><infinity id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">\alpha=\infty</annotation></semantics></math> to simulate the IID scenario.
Then, we implement FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib17" title="" class="ltx_ref">2017</a>)</cite> to train a convolutional neural network (CNN) utilized in <cite class="ltx_cite ltx_citemacro_citep">(Reddi et al., <a href="#bib.bib22" title="" class="ltx_ref">2020</a>)</cite> on the CIFAR-10 dataset.
Assuming that each client has uploaded the local model at the <math id="S3.SS2.p1.8.m8.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p1.8.m8.1a"><mi id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><ci id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">t</annotation></semantics></math>-th communication round,
we calculate the average gradient vector <math id="S3.SS2.p1.9.m9.4" class="ltx_Math" alttext="G_{t}=(g_{t}^{1},g_{t}^{2},…,g_{t}^{K})" display="inline"><semantics id="S3.SS2.p1.9.m9.4a"><mrow id="S3.SS2.p1.9.m9.4.4" xref="S3.SS2.p1.9.m9.4.4.cmml"><msub id="S3.SS2.p1.9.m9.4.4.5" xref="S3.SS2.p1.9.m9.4.4.5.cmml"><mi id="S3.SS2.p1.9.m9.4.4.5.2" xref="S3.SS2.p1.9.m9.4.4.5.2.cmml">G</mi><mi id="S3.SS2.p1.9.m9.4.4.5.3" xref="S3.SS2.p1.9.m9.4.4.5.3.cmml">t</mi></msub><mo id="S3.SS2.p1.9.m9.4.4.4" xref="S3.SS2.p1.9.m9.4.4.4.cmml">=</mo><mrow id="S3.SS2.p1.9.m9.4.4.3.3" xref="S3.SS2.p1.9.m9.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS2.p1.9.m9.4.4.3.3.4" xref="S3.SS2.p1.9.m9.4.4.3.4.cmml">(</mo><msubsup id="S3.SS2.p1.9.m9.2.2.1.1.1" xref="S3.SS2.p1.9.m9.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.9.m9.2.2.1.1.1.2.2" xref="S3.SS2.p1.9.m9.2.2.1.1.1.2.2.cmml">g</mi><mi id="S3.SS2.p1.9.m9.2.2.1.1.1.2.3" xref="S3.SS2.p1.9.m9.2.2.1.1.1.2.3.cmml">t</mi><mn id="S3.SS2.p1.9.m9.2.2.1.1.1.3" xref="S3.SS2.p1.9.m9.2.2.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS2.p1.9.m9.4.4.3.3.5" xref="S3.SS2.p1.9.m9.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.p1.9.m9.3.3.2.2.2" xref="S3.SS2.p1.9.m9.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.9.m9.3.3.2.2.2.2.2" xref="S3.SS2.p1.9.m9.3.3.2.2.2.2.2.cmml">g</mi><mi id="S3.SS2.p1.9.m9.3.3.2.2.2.2.3" xref="S3.SS2.p1.9.m9.3.3.2.2.2.2.3.cmml">t</mi><mn id="S3.SS2.p1.9.m9.3.3.2.2.2.3" xref="S3.SS2.p1.9.m9.3.3.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS2.p1.9.m9.4.4.3.3.6" xref="S3.SS2.p1.9.m9.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml">…</mi><mo id="S3.SS2.p1.9.m9.4.4.3.3.7" xref="S3.SS2.p1.9.m9.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.p1.9.m9.4.4.3.3.3" xref="S3.SS2.p1.9.m9.4.4.3.3.3.cmml"><mi id="S3.SS2.p1.9.m9.4.4.3.3.3.2.2" xref="S3.SS2.p1.9.m9.4.4.3.3.3.2.2.cmml">g</mi><mi id="S3.SS2.p1.9.m9.4.4.3.3.3.2.3" xref="S3.SS2.p1.9.m9.4.4.3.3.3.2.3.cmml">t</mi><mi id="S3.SS2.p1.9.m9.4.4.3.3.3.3" xref="S3.SS2.p1.9.m9.4.4.3.3.3.3.cmml">K</mi></msubsup><mo stretchy="false" id="S3.SS2.p1.9.m9.4.4.3.3.8" xref="S3.SS2.p1.9.m9.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.4b"><apply id="S3.SS2.p1.9.m9.4.4.cmml" xref="S3.SS2.p1.9.m9.4.4"><eq id="S3.SS2.p1.9.m9.4.4.4.cmml" xref="S3.SS2.p1.9.m9.4.4.4"></eq><apply id="S3.SS2.p1.9.m9.4.4.5.cmml" xref="S3.SS2.p1.9.m9.4.4.5"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.4.4.5.1.cmml" xref="S3.SS2.p1.9.m9.4.4.5">subscript</csymbol><ci id="S3.SS2.p1.9.m9.4.4.5.2.cmml" xref="S3.SS2.p1.9.m9.4.4.5.2">𝐺</ci><ci id="S3.SS2.p1.9.m9.4.4.5.3.cmml" xref="S3.SS2.p1.9.m9.4.4.5.3">𝑡</ci></apply><vector id="S3.SS2.p1.9.m9.4.4.3.4.cmml" xref="S3.SS2.p1.9.m9.4.4.3.3"><apply id="S3.SS2.p1.9.m9.2.2.1.1.1.cmml" xref="S3.SS2.p1.9.m9.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.9.m9.2.2.1.1.1">superscript</csymbol><apply id="S3.SS2.p1.9.m9.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.9.m9.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.2.2.1.1.1.2.1.cmml" xref="S3.SS2.p1.9.m9.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.9.m9.2.2.1.1.1.2.2.cmml" xref="S3.SS2.p1.9.m9.2.2.1.1.1.2.2">𝑔</ci><ci id="S3.SS2.p1.9.m9.2.2.1.1.1.2.3.cmml" xref="S3.SS2.p1.9.m9.2.2.1.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS2.p1.9.m9.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.9.m9.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS2.p1.9.m9.3.3.2.2.2.cmml" xref="S3.SS2.p1.9.m9.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.9.m9.3.3.2.2.2">superscript</csymbol><apply id="S3.SS2.p1.9.m9.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.9.m9.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.3.3.2.2.2.2.1.cmml" xref="S3.SS2.p1.9.m9.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.9.m9.3.3.2.2.2.2.2.cmml" xref="S3.SS2.p1.9.m9.3.3.2.2.2.2.2">𝑔</ci><ci id="S3.SS2.p1.9.m9.3.3.2.2.2.2.3.cmml" xref="S3.SS2.p1.9.m9.3.3.2.2.2.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS2.p1.9.m9.3.3.2.2.2.3.cmml" xref="S3.SS2.p1.9.m9.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">…</ci><apply id="S3.SS2.p1.9.m9.4.4.3.3.3.cmml" xref="S3.SS2.p1.9.m9.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.4.4.3.3.3.1.cmml" xref="S3.SS2.p1.9.m9.4.4.3.3.3">superscript</csymbol><apply id="S3.SS2.p1.9.m9.4.4.3.3.3.2.cmml" xref="S3.SS2.p1.9.m9.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.4.4.3.3.3.2.1.cmml" xref="S3.SS2.p1.9.m9.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.9.m9.4.4.3.3.3.2.2.cmml" xref="S3.SS2.p1.9.m9.4.4.3.3.3.2.2">𝑔</ci><ci id="S3.SS2.p1.9.m9.4.4.3.3.3.2.3.cmml" xref="S3.SS2.p1.9.m9.4.4.3.3.3.2.3">𝑡</ci></apply><ci id="S3.SS2.p1.9.m9.4.4.3.3.3.3.cmml" xref="S3.SS2.p1.9.m9.4.4.3.3.3.3">𝐾</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.4c">G_{t}=(g_{t}^{1},g_{t}^{2},…,g_{t}^{K})</annotation></semantics></math> during the local training period.
The occurrence of gradient conflict is identified when the cosine similarity between <math id="S3.SS2.p1.10.m10.1" class="ltx_Math" alttext="g_{t}^{i}" display="inline"><semantics id="S3.SS2.p1.10.m10.1a"><msubsup id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml"><mi id="S3.SS2.p1.10.m10.1.1.2.2" xref="S3.SS2.p1.10.m10.1.1.2.2.cmml">g</mi><mi id="S3.SS2.p1.10.m10.1.1.2.3" xref="S3.SS2.p1.10.m10.1.1.2.3.cmml">t</mi><mi id="S3.SS2.p1.10.m10.1.1.3" xref="S3.SS2.p1.10.m10.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><apply id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">superscript</csymbol><apply id="S3.SS2.p1.10.m10.1.1.2.cmml" xref="S3.SS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.2.1.cmml" xref="S3.SS2.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.p1.10.m10.1.1.2.2.cmml" xref="S3.SS2.p1.10.m10.1.1.2.2">𝑔</ci><ci id="S3.SS2.p1.10.m10.1.1.2.3.cmml" xref="S3.SS2.p1.10.m10.1.1.2.3">𝑡</ci></apply><ci id="S3.SS2.p1.10.m10.1.1.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">g_{t}^{i}</annotation></semantics></math> and <math id="S3.SS2.p1.11.m11.2" class="ltx_Math" alttext="g_{t}^{j},\forall j\neq i" display="inline"><semantics id="S3.SS2.p1.11.m11.2a"><mrow id="S3.SS2.p1.11.m11.2.2" xref="S3.SS2.p1.11.m11.2.2.cmml"><mrow id="S3.SS2.p1.11.m11.2.2.2.2" xref="S3.SS2.p1.11.m11.2.2.2.3.cmml"><msubsup id="S3.SS2.p1.11.m11.1.1.1.1.1" xref="S3.SS2.p1.11.m11.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.11.m11.1.1.1.1.1.2.2" xref="S3.SS2.p1.11.m11.1.1.1.1.1.2.2.cmml">g</mi><mi id="S3.SS2.p1.11.m11.1.1.1.1.1.2.3" xref="S3.SS2.p1.11.m11.1.1.1.1.1.2.3.cmml">t</mi><mi id="S3.SS2.p1.11.m11.1.1.1.1.1.3" xref="S3.SS2.p1.11.m11.1.1.1.1.1.3.cmml">j</mi></msubsup><mo id="S3.SS2.p1.11.m11.2.2.2.2.3" xref="S3.SS2.p1.11.m11.2.2.2.3.cmml">,</mo><mrow id="S3.SS2.p1.11.m11.2.2.2.2.2" xref="S3.SS2.p1.11.m11.2.2.2.2.2.cmml"><mo rspace="0.167em" id="S3.SS2.p1.11.m11.2.2.2.2.2.1" xref="S3.SS2.p1.11.m11.2.2.2.2.2.1.cmml">∀</mo><mi id="S3.SS2.p1.11.m11.2.2.2.2.2.2" xref="S3.SS2.p1.11.m11.2.2.2.2.2.2.cmml">j</mi></mrow></mrow><mo id="S3.SS2.p1.11.m11.2.2.3" xref="S3.SS2.p1.11.m11.2.2.3.cmml">≠</mo><mi id="S3.SS2.p1.11.m11.2.2.4" xref="S3.SS2.p1.11.m11.2.2.4.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m11.2b"><apply id="S3.SS2.p1.11.m11.2.2.cmml" xref="S3.SS2.p1.11.m11.2.2"><neq id="S3.SS2.p1.11.m11.2.2.3.cmml" xref="S3.SS2.p1.11.m11.2.2.3"></neq><list id="S3.SS2.p1.11.m11.2.2.2.3.cmml" xref="S3.SS2.p1.11.m11.2.2.2.2"><apply id="S3.SS2.p1.11.m11.1.1.1.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m11.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1.1.1.1">superscript</csymbol><apply id="S3.SS2.p1.11.m11.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m11.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.11.m11.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.11.m11.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.11.m11.1.1.1.1.1.2.2">𝑔</ci><ci id="S3.SS2.p1.11.m11.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.11.m11.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS2.p1.11.m11.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.11.m11.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS2.p1.11.m11.2.2.2.2.2.cmml" xref="S3.SS2.p1.11.m11.2.2.2.2.2"><csymbol cd="latexml" id="S3.SS2.p1.11.m11.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.11.m11.2.2.2.2.2.1">for-all</csymbol><ci id="S3.SS2.p1.11.m11.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.11.m11.2.2.2.2.2.2">𝑗</ci></apply></list><ci id="S3.SS2.p1.11.m11.2.2.4.cmml" xref="S3.SS2.p1.11.m11.2.2.4">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m11.2c">g_{t}^{j},\forall j\neq i</annotation></semantics></math> becomes negative,
i.e., <math id="S3.SS2.p1.12.m12.1" class="ltx_Math" alttext="g_{t}^{i}\cdot g_{t}^{j}&lt;0" display="inline"><semantics id="S3.SS2.p1.12.m12.1a"><mrow id="S3.SS2.p1.12.m12.1.1" xref="S3.SS2.p1.12.m12.1.1.cmml"><mrow id="S3.SS2.p1.12.m12.1.1.2" xref="S3.SS2.p1.12.m12.1.1.2.cmml"><msubsup id="S3.SS2.p1.12.m12.1.1.2.2" xref="S3.SS2.p1.12.m12.1.1.2.2.cmml"><mi id="S3.SS2.p1.12.m12.1.1.2.2.2.2" xref="S3.SS2.p1.12.m12.1.1.2.2.2.2.cmml">g</mi><mi id="S3.SS2.p1.12.m12.1.1.2.2.2.3" xref="S3.SS2.p1.12.m12.1.1.2.2.2.3.cmml">t</mi><mi id="S3.SS2.p1.12.m12.1.1.2.2.3" xref="S3.SS2.p1.12.m12.1.1.2.2.3.cmml">i</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.12.m12.1.1.2.1" xref="S3.SS2.p1.12.m12.1.1.2.1.cmml">⋅</mo><msubsup id="S3.SS2.p1.12.m12.1.1.2.3" xref="S3.SS2.p1.12.m12.1.1.2.3.cmml"><mi id="S3.SS2.p1.12.m12.1.1.2.3.2.2" xref="S3.SS2.p1.12.m12.1.1.2.3.2.2.cmml">g</mi><mi id="S3.SS2.p1.12.m12.1.1.2.3.2.3" xref="S3.SS2.p1.12.m12.1.1.2.3.2.3.cmml">t</mi><mi id="S3.SS2.p1.12.m12.1.1.2.3.3" xref="S3.SS2.p1.12.m12.1.1.2.3.3.cmml">j</mi></msubsup></mrow><mo id="S3.SS2.p1.12.m12.1.1.1" xref="S3.SS2.p1.12.m12.1.1.1.cmml">&lt;</mo><mn id="S3.SS2.p1.12.m12.1.1.3" xref="S3.SS2.p1.12.m12.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m12.1b"><apply id="S3.SS2.p1.12.m12.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1"><lt id="S3.SS2.p1.12.m12.1.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1.1"></lt><apply id="S3.SS2.p1.12.m12.1.1.2.cmml" xref="S3.SS2.p1.12.m12.1.1.2"><ci id="S3.SS2.p1.12.m12.1.1.2.1.cmml" xref="S3.SS2.p1.12.m12.1.1.2.1">⋅</ci><apply id="S3.SS2.p1.12.m12.1.1.2.2.cmml" xref="S3.SS2.p1.12.m12.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m12.1.1.2.2.1.cmml" xref="S3.SS2.p1.12.m12.1.1.2.2">superscript</csymbol><apply id="S3.SS2.p1.12.m12.1.1.2.2.2.cmml" xref="S3.SS2.p1.12.m12.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m12.1.1.2.2.2.1.cmml" xref="S3.SS2.p1.12.m12.1.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.12.m12.1.1.2.2.2.2.cmml" xref="S3.SS2.p1.12.m12.1.1.2.2.2.2">𝑔</ci><ci id="S3.SS2.p1.12.m12.1.1.2.2.2.3.cmml" xref="S3.SS2.p1.12.m12.1.1.2.2.2.3">𝑡</ci></apply><ci id="S3.SS2.p1.12.m12.1.1.2.2.3.cmml" xref="S3.SS2.p1.12.m12.1.1.2.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.12.m12.1.1.2.3.cmml" xref="S3.SS2.p1.12.m12.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m12.1.1.2.3.1.cmml" xref="S3.SS2.p1.12.m12.1.1.2.3">superscript</csymbol><apply id="S3.SS2.p1.12.m12.1.1.2.3.2.cmml" xref="S3.SS2.p1.12.m12.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m12.1.1.2.3.2.1.cmml" xref="S3.SS2.p1.12.m12.1.1.2.3">subscript</csymbol><ci id="S3.SS2.p1.12.m12.1.1.2.3.2.2.cmml" xref="S3.SS2.p1.12.m12.1.1.2.3.2.2">𝑔</ci><ci id="S3.SS2.p1.12.m12.1.1.2.3.2.3.cmml" xref="S3.SS2.p1.12.m12.1.1.2.3.2.3">𝑡</ci></apply><ci id="S3.SS2.p1.12.m12.1.1.2.3.3.cmml" xref="S3.SS2.p1.12.m12.1.1.2.3.3">𝑗</ci></apply></apply><cn type="integer" id="S3.SS2.p1.12.m12.1.1.3.cmml" xref="S3.SS2.p1.12.m12.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m12.1c">g_{t}^{i}\cdot g_{t}^{j}&lt;0</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">First, we run 100 communication rounds involving 5 clients within two distinct non-IID scenarios.
Subsequently, we visualize the sorted gradient similarity between each pair of clients in the final round,
as illustrated in Fig. <a href="#S3.F2.sf1" title="In Figure 2 ‣ 3.2 Gradient Conflict in Heterogeneous FL ‣ 3 Methodology ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(a)</span></a>. Our observation reveals the presence of gradient conflicts in heterogeneous settings,
while a stronger heterogeneity results in a more severe conflict,
as evidenced by the minimum similarity decreasing from -0.06 to -0.12.
Next, we increase the number of clients to 10; the results are presented in Fig. <a href="#S3.F2.sf3" title="In Figure 2 ‣ 3.2 Gradient Conflict in Heterogeneous FL ‣ 3 Methodology ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(c)</span></a>.
We find that a larger number of clients further exacerbates the gradient conflict phenomenon,
indicated by the reduction in minimum similarity from -0.12 to -0.22.
Finally, we compute the frequency of gradient conflicts occurring to unveil the variation of the gradient conflict over all communication rounds.
We observe from Fig. <a href="#S3.F2.sf2" title="In Figure 2 ‣ 3.2 Gradient Conflict in Heterogeneous FL ‣ 3 Methodology ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(b)</span></a> that as the training advances, gradient conflicts become more frequent.
This phenomenon is consistent with the understanding that the non-IID issue causes local minima to deviate from global minima.
Moreover, gradient conflict is widespread in FL, even within the IID setting,
and becomes notably more severe in non-IID scenarios.
These experiments demonstrate that stronger heterogeneity leads to more substantial local drifts,
consequently inducing more violent gradient conflicts.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Tackling the Non-IID Issue by Gradient Harmonization</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.15" class="ltx_p">Motivated by intuitive insights on gradient conflicts in FL, we propose FedGH, a simple yet effective method,
to tackle the non-IID issue by gradient harmonization. FedGH proceeds as follows:
(1) First, FedGH recalculates average gradient vectors <math id="S3.SS3.p1.1.m1.4" class="ltx_Math" alttext="G_{t}=(g_{t}^{1},g_{t}^{2},…,g_{t}^{K})" display="inline"><semantics id="S3.SS3.p1.1.m1.4a"><mrow id="S3.SS3.p1.1.m1.4.4" xref="S3.SS3.p1.1.m1.4.4.cmml"><msub id="S3.SS3.p1.1.m1.4.4.5" xref="S3.SS3.p1.1.m1.4.4.5.cmml"><mi id="S3.SS3.p1.1.m1.4.4.5.2" xref="S3.SS3.p1.1.m1.4.4.5.2.cmml">G</mi><mi id="S3.SS3.p1.1.m1.4.4.5.3" xref="S3.SS3.p1.1.m1.4.4.5.3.cmml">t</mi></msub><mo id="S3.SS3.p1.1.m1.4.4.4" xref="S3.SS3.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS3.p1.1.m1.4.4.3.3" xref="S3.SS3.p1.1.m1.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS3.p1.1.m1.4.4.3.3.4" xref="S3.SS3.p1.1.m1.4.4.3.4.cmml">(</mo><msubsup id="S3.SS3.p1.1.m1.2.2.1.1.1" xref="S3.SS3.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.2.2.1.1.1.2.2" xref="S3.SS3.p1.1.m1.2.2.1.1.1.2.2.cmml">g</mi><mi id="S3.SS3.p1.1.m1.2.2.1.1.1.2.3" xref="S3.SS3.p1.1.m1.2.2.1.1.1.2.3.cmml">t</mi><mn id="S3.SS3.p1.1.m1.2.2.1.1.1.3" xref="S3.SS3.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS3.p1.1.m1.4.4.3.3.5" xref="S3.SS3.p1.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS3.p1.1.m1.3.3.2.2.2" xref="S3.SS3.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS3.p1.1.m1.3.3.2.2.2.2.2" xref="S3.SS3.p1.1.m1.3.3.2.2.2.2.2.cmml">g</mi><mi id="S3.SS3.p1.1.m1.3.3.2.2.2.2.3" xref="S3.SS3.p1.1.m1.3.3.2.2.2.2.3.cmml">t</mi><mn id="S3.SS3.p1.1.m1.3.3.2.2.2.3" xref="S3.SS3.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS3.p1.1.m1.4.4.3.3.6" xref="S3.SS3.p1.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS3.p1.1.m1.4.4.3.3.7" xref="S3.SS3.p1.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS3.p1.1.m1.4.4.3.3.3" xref="S3.SS3.p1.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS3.p1.1.m1.4.4.3.3.3.2.2" xref="S3.SS3.p1.1.m1.4.4.3.3.3.2.2.cmml">g</mi><mi id="S3.SS3.p1.1.m1.4.4.3.3.3.2.3" xref="S3.SS3.p1.1.m1.4.4.3.3.3.2.3.cmml">t</mi><mi id="S3.SS3.p1.1.m1.4.4.3.3.3.3" xref="S3.SS3.p1.1.m1.4.4.3.3.3.3.cmml">K</mi></msubsup><mo stretchy="false" id="S3.SS3.p1.1.m1.4.4.3.3.8" xref="S3.SS3.p1.1.m1.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.4b"><apply id="S3.SS3.p1.1.m1.4.4.cmml" xref="S3.SS3.p1.1.m1.4.4"><eq id="S3.SS3.p1.1.m1.4.4.4.cmml" xref="S3.SS3.p1.1.m1.4.4.4"></eq><apply id="S3.SS3.p1.1.m1.4.4.5.cmml" xref="S3.SS3.p1.1.m1.4.4.5"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.4.4.5.1.cmml" xref="S3.SS3.p1.1.m1.4.4.5">subscript</csymbol><ci id="S3.SS3.p1.1.m1.4.4.5.2.cmml" xref="S3.SS3.p1.1.m1.4.4.5.2">𝐺</ci><ci id="S3.SS3.p1.1.m1.4.4.5.3.cmml" xref="S3.SS3.p1.1.m1.4.4.5.3">𝑡</ci></apply><vector id="S3.SS3.p1.1.m1.4.4.3.4.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3"><apply id="S3.SS3.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1">superscript</csymbol><apply id="S3.SS3.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1.2.2">𝑔</ci><ci id="S3.SS3.p1.1.m1.2.2.1.1.1.2.3.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS3.p1.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS3.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2">superscript</csymbol><apply id="S3.SS3.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2.2.2">𝑔</ci><ci id="S3.SS3.p1.1.m1.3.3.2.2.2.2.3.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS3.p1.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">…</ci><apply id="S3.SS3.p1.1.m1.4.4.3.3.3.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3.3">superscript</csymbol><apply id="S3.SS3.p1.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.4.4.3.3.3.2.1.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS3.p1.1.m1.4.4.3.3.3.2.2.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3.3.2.2">𝑔</ci><ci id="S3.SS3.p1.1.m1.4.4.3.3.3.2.3.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3.3.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3.3.3">𝐾</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.4c">G_{t}=(g_{t}^{1},g_{t}^{2},…,g_{t}^{K})</annotation></semantics></math> based on uploaded local models
<math id="S3.SS3.p1.2.m2.4" class="ltx_Math" alttext="W_{t}=(w_{t}^{1},w_{t}^{2},…,w_{t}^{K})" display="inline"><semantics id="S3.SS3.p1.2.m2.4a"><mrow id="S3.SS3.p1.2.m2.4.4" xref="S3.SS3.p1.2.m2.4.4.cmml"><msub id="S3.SS3.p1.2.m2.4.4.5" xref="S3.SS3.p1.2.m2.4.4.5.cmml"><mi id="S3.SS3.p1.2.m2.4.4.5.2" xref="S3.SS3.p1.2.m2.4.4.5.2.cmml">W</mi><mi id="S3.SS3.p1.2.m2.4.4.5.3" xref="S3.SS3.p1.2.m2.4.4.5.3.cmml">t</mi></msub><mo id="S3.SS3.p1.2.m2.4.4.4" xref="S3.SS3.p1.2.m2.4.4.4.cmml">=</mo><mrow id="S3.SS3.p1.2.m2.4.4.3.3" xref="S3.SS3.p1.2.m2.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS3.p1.2.m2.4.4.3.3.4" xref="S3.SS3.p1.2.m2.4.4.3.4.cmml">(</mo><msubsup id="S3.SS3.p1.2.m2.2.2.1.1.1" xref="S3.SS3.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS3.p1.2.m2.2.2.1.1.1.2.2" xref="S3.SS3.p1.2.m2.2.2.1.1.1.2.2.cmml">w</mi><mi id="S3.SS3.p1.2.m2.2.2.1.1.1.2.3" xref="S3.SS3.p1.2.m2.2.2.1.1.1.2.3.cmml">t</mi><mn id="S3.SS3.p1.2.m2.2.2.1.1.1.3" xref="S3.SS3.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS3.p1.2.m2.4.4.3.3.5" xref="S3.SS3.p1.2.m2.4.4.3.4.cmml">,</mo><msubsup id="S3.SS3.p1.2.m2.3.3.2.2.2" xref="S3.SS3.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS3.p1.2.m2.3.3.2.2.2.2.2" xref="S3.SS3.p1.2.m2.3.3.2.2.2.2.2.cmml">w</mi><mi id="S3.SS3.p1.2.m2.3.3.2.2.2.2.3" xref="S3.SS3.p1.2.m2.3.3.2.2.2.2.3.cmml">t</mi><mn id="S3.SS3.p1.2.m2.3.3.2.2.2.3" xref="S3.SS3.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS3.p1.2.m2.4.4.3.3.6" xref="S3.SS3.p1.2.m2.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS3.p1.2.m2.4.4.3.3.7" xref="S3.SS3.p1.2.m2.4.4.3.4.cmml">,</mo><msubsup id="S3.SS3.p1.2.m2.4.4.3.3.3" xref="S3.SS3.p1.2.m2.4.4.3.3.3.cmml"><mi id="S3.SS3.p1.2.m2.4.4.3.3.3.2.2" xref="S3.SS3.p1.2.m2.4.4.3.3.3.2.2.cmml">w</mi><mi id="S3.SS3.p1.2.m2.4.4.3.3.3.2.3" xref="S3.SS3.p1.2.m2.4.4.3.3.3.2.3.cmml">t</mi><mi id="S3.SS3.p1.2.m2.4.4.3.3.3.3" xref="S3.SS3.p1.2.m2.4.4.3.3.3.3.cmml">K</mi></msubsup><mo stretchy="false" id="S3.SS3.p1.2.m2.4.4.3.3.8" xref="S3.SS3.p1.2.m2.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.4b"><apply id="S3.SS3.p1.2.m2.4.4.cmml" xref="S3.SS3.p1.2.m2.4.4"><eq id="S3.SS3.p1.2.m2.4.4.4.cmml" xref="S3.SS3.p1.2.m2.4.4.4"></eq><apply id="S3.SS3.p1.2.m2.4.4.5.cmml" xref="S3.SS3.p1.2.m2.4.4.5"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.4.4.5.1.cmml" xref="S3.SS3.p1.2.m2.4.4.5">subscript</csymbol><ci id="S3.SS3.p1.2.m2.4.4.5.2.cmml" xref="S3.SS3.p1.2.m2.4.4.5.2">𝑊</ci><ci id="S3.SS3.p1.2.m2.4.4.5.3.cmml" xref="S3.SS3.p1.2.m2.4.4.5.3">𝑡</ci></apply><vector id="S3.SS3.p1.2.m2.4.4.3.4.cmml" xref="S3.SS3.p1.2.m2.4.4.3.3"><apply id="S3.SS3.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.2.m2.2.2.1.1.1">superscript</csymbol><apply id="S3.SS3.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS3.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.2.2.1.1.1.2.1.cmml" xref="S3.SS3.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.2.2.1.1.1.2.2.cmml" xref="S3.SS3.p1.2.m2.2.2.1.1.1.2.2">𝑤</ci><ci id="S3.SS3.p1.2.m2.2.2.1.1.1.2.3.cmml" xref="S3.SS3.p1.2.m2.2.2.1.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS3.p1.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS3.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS3.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS3.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS3.p1.2.m2.3.3.2.2.2">superscript</csymbol><apply id="S3.SS3.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS3.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.3.3.2.2.2.2.1.cmml" xref="S3.SS3.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.2.m2.3.3.2.2.2.2.2.cmml" xref="S3.SS3.p1.2.m2.3.3.2.2.2.2.2">𝑤</ci><ci id="S3.SS3.p1.2.m2.3.3.2.2.2.2.3.cmml" xref="S3.SS3.p1.2.m2.3.3.2.2.2.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS3.p1.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS3.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">…</ci><apply id="S3.SS3.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS3.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS3.p1.2.m2.4.4.3.3.3">superscript</csymbol><apply id="S3.SS3.p1.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS3.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.4.4.3.3.3.2.1.cmml" xref="S3.SS3.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.SS3.p1.2.m2.4.4.3.3.3.2.2.cmml" xref="S3.SS3.p1.2.m2.4.4.3.3.3.2.2">𝑤</ci><ci id="S3.SS3.p1.2.m2.4.4.3.3.3.2.3.cmml" xref="S3.SS3.p1.2.m2.4.4.3.3.3.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS3.p1.2.m2.4.4.3.3.3.3">𝐾</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.4c">W_{t}=(w_{t}^{1},w_{t}^{2},…,w_{t}^{K})</annotation></semantics></math>. For client <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">k</annotation></semantics></math>, <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="g_{t}^{k}=\frac{1}{\eta}(w_{t}^{k}-w_{t})" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mrow id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><msubsup id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml"><mi id="S3.SS3.p1.4.m4.1.1.3.2.2" xref="S3.SS3.p1.4.m4.1.1.3.2.2.cmml">g</mi><mi id="S3.SS3.p1.4.m4.1.1.3.2.3" xref="S3.SS3.p1.4.m4.1.1.3.2.3.cmml">t</mi><mi id="S3.SS3.p1.4.m4.1.1.3.3" xref="S3.SS3.p1.4.m4.1.1.3.3.cmml">k</mi></msubsup><mo id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">=</mo><mrow id="S3.SS3.p1.4.m4.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.cmml"><mfrac id="S3.SS3.p1.4.m4.1.1.1.3" xref="S3.SS3.p1.4.m4.1.1.1.3.cmml"><mn id="S3.SS3.p1.4.m4.1.1.1.3.2" xref="S3.SS3.p1.4.m4.1.1.1.3.2.cmml">1</mn><mi id="S3.SS3.p1.4.m4.1.1.1.3.3" xref="S3.SS3.p1.4.m4.1.1.1.3.3.cmml">η</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.SS3.p1.4.m4.1.1.1.2" xref="S3.SS3.p1.4.m4.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p1.4.m4.1.1.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.4.m4.1.1.1.1.1.2" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p1.4.m4.1.1.1.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.cmml"><msubsup id="S3.SS3.p1.4.m4.1.1.1.1.1.1.2" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p1.4.m4.1.1.1.1.1.1.2.2.2" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.2.2.2.cmml">w</mi><mi id="S3.SS3.p1.4.m4.1.1.1.1.1.1.2.2.3" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.2.2.3.cmml">t</mi><mi id="S3.SS3.p1.4.m4.1.1.1.1.1.1.2.3" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.SS3.p1.4.m4.1.1.1.1.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.SS3.p1.4.m4.1.1.1.1.1.1.3" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p1.4.m4.1.1.1.1.1.1.3.2" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.3.2.cmml">w</mi><mi id="S3.SS3.p1.4.m4.1.1.1.1.1.1.3.3" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.SS3.p1.4.m4.1.1.1.1.1.3" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><eq id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2"></eq><apply id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.3">superscript</csymbol><apply id="S3.SS3.p1.4.m4.1.1.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.3.2.1.cmml" xref="S3.SS3.p1.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.3.2.2.cmml" xref="S3.SS3.p1.4.m4.1.1.3.2.2">𝑔</ci><ci id="S3.SS3.p1.4.m4.1.1.3.2.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.4.m4.1.1.3.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3.3">𝑘</ci></apply><apply id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1"><times id="S3.SS3.p1.4.m4.1.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.1.2"></times><apply id="S3.SS3.p1.4.m4.1.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.1.3"><divide id="S3.SS3.p1.4.m4.1.1.1.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.3"></divide><cn type="integer" id="S3.SS3.p1.4.m4.1.1.1.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.1.3.2">1</cn><ci id="S3.SS3.p1.4.m4.1.1.1.3.3.cmml" xref="S3.SS3.p1.4.m4.1.1.1.3.3">𝜂</ci></apply><apply id="S3.SS3.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.1"><minus id="S3.SS3.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.1"></minus><apply id="S3.SS3.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.SS3.p1.4.m4.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.2.2.2">𝑤</ci><ci id="S3.SS3.p1.4.m4.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.4.m4.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S3.SS3.p1.4.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.3.2">𝑤</ci><ci id="S3.SS3.p1.4.m4.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">g_{t}^{k}=\frac{1}{\eta}(w_{t}^{k}-w_{t})</annotation></semantics></math>,
where <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="w_{t}" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><msub id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml"><mi id="S3.SS3.p1.5.m5.1.1.2" xref="S3.SS3.p1.5.m5.1.1.2.cmml">w</mi><mi id="S3.SS3.p1.5.m5.1.1.3" xref="S3.SS3.p1.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2">𝑤</ci><ci id="S3.SS3.p1.5.m5.1.1.3.cmml" xref="S3.SS3.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">w_{t}</annotation></semantics></math> is the global model and <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><mi id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">\eta</annotation></semantics></math> is the learning rate. Note that gradients from distinct layers are flattened to a 1-d vector.
(2) FedGH computes the cosine similarity between each gradient vector pair (<math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="g_{t}^{i}" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><msubsup id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml"><mi id="S3.SS3.p1.7.m7.1.1.2.2" xref="S3.SS3.p1.7.m7.1.1.2.2.cmml">g</mi><mi id="S3.SS3.p1.7.m7.1.1.2.3" xref="S3.SS3.p1.7.m7.1.1.2.3.cmml">t</mi><mi id="S3.SS3.p1.7.m7.1.1.3" xref="S3.SS3.p1.7.m7.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><apply id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.1.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">superscript</csymbol><apply id="S3.SS3.p1.7.m7.1.1.2.cmml" xref="S3.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.1.1.2.1.cmml" xref="S3.SS3.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p1.7.m7.1.1.2.2.cmml" xref="S3.SS3.p1.7.m7.1.1.2.2">𝑔</ci><ci id="S3.SS3.p1.7.m7.1.1.2.3.cmml" xref="S3.SS3.p1.7.m7.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.7.m7.1.1.3.cmml" xref="S3.SS3.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">g_{t}^{i}</annotation></semantics></math>, <math id="S3.SS3.p1.8.m8.1" class="ltx_Math" alttext="g_{t}^{j}" display="inline"><semantics id="S3.SS3.p1.8.m8.1a"><msubsup id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml"><mi id="S3.SS3.p1.8.m8.1.1.2.2" xref="S3.SS3.p1.8.m8.1.1.2.2.cmml">g</mi><mi id="S3.SS3.p1.8.m8.1.1.2.3" xref="S3.SS3.p1.8.m8.1.1.2.3.cmml">t</mi><mi id="S3.SS3.p1.8.m8.1.1.3" xref="S3.SS3.p1.8.m8.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><apply id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.1.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">superscript</csymbol><apply id="S3.SS3.p1.8.m8.1.1.2.cmml" xref="S3.SS3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.1.1.2.1.cmml" xref="S3.SS3.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.p1.8.m8.1.1.2.2.cmml" xref="S3.SS3.p1.8.m8.1.1.2.2">𝑔</ci><ci id="S3.SS3.p1.8.m8.1.1.2.3.cmml" xref="S3.SS3.p1.8.m8.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.8.m8.1.1.3.cmml" xref="S3.SS3.p1.8.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">g_{t}^{j}</annotation></semantics></math>), <math id="S3.SS3.p1.9.m9.1" class="ltx_Math" alttext="\forall i\neq j" display="inline"><semantics id="S3.SS3.p1.9.m9.1a"><mrow id="S3.SS3.p1.9.m9.1.1" xref="S3.SS3.p1.9.m9.1.1.cmml"><mrow id="S3.SS3.p1.9.m9.1.1.2" xref="S3.SS3.p1.9.m9.1.1.2.cmml"><mo rspace="0.167em" id="S3.SS3.p1.9.m9.1.1.2.1" xref="S3.SS3.p1.9.m9.1.1.2.1.cmml">∀</mo><mi id="S3.SS3.p1.9.m9.1.1.2.2" xref="S3.SS3.p1.9.m9.1.1.2.2.cmml">i</mi></mrow><mo id="S3.SS3.p1.9.m9.1.1.1" xref="S3.SS3.p1.9.m9.1.1.1.cmml">≠</mo><mi id="S3.SS3.p1.9.m9.1.1.3" xref="S3.SS3.p1.9.m9.1.1.3.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m9.1b"><apply id="S3.SS3.p1.9.m9.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1"><neq id="S3.SS3.p1.9.m9.1.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1.1"></neq><apply id="S3.SS3.p1.9.m9.1.1.2.cmml" xref="S3.SS3.p1.9.m9.1.1.2"><csymbol cd="latexml" id="S3.SS3.p1.9.m9.1.1.2.1.cmml" xref="S3.SS3.p1.9.m9.1.1.2.1">for-all</csymbol><ci id="S3.SS3.p1.9.m9.1.1.2.2.cmml" xref="S3.SS3.p1.9.m9.1.1.2.2">𝑖</ci></apply><ci id="S3.SS3.p1.9.m9.1.1.3.cmml" xref="S3.SS3.p1.9.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m9.1c">\forall i\neq j</annotation></semantics></math>.
If the value is negative, indicating an obtuse angle between two gradient vectors,
a gradient conflict between clients <math id="S3.SS3.p1.10.m10.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p1.10.m10.1a"><mi id="S3.SS3.p1.10.m10.1.1" xref="S3.SS3.p1.10.m10.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m10.1b"><ci id="S3.SS3.p1.10.m10.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m10.1c">i</annotation></semantics></math> and <math id="S3.SS3.p1.11.m11.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS3.p1.11.m11.1a"><mi id="S3.SS3.p1.11.m11.1.1" xref="S3.SS3.p1.11.m11.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m11.1b"><ci id="S3.SS3.p1.11.m11.1.1.cmml" xref="S3.SS3.p1.11.m11.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m11.1c">j</annotation></semantics></math> is identified. (3) For each conflicting gradient pair (<math id="S3.SS3.p1.12.m12.1" class="ltx_Math" alttext="g_{t}^{i}" display="inline"><semantics id="S3.SS3.p1.12.m12.1a"><msubsup id="S3.SS3.p1.12.m12.1.1" xref="S3.SS3.p1.12.m12.1.1.cmml"><mi id="S3.SS3.p1.12.m12.1.1.2.2" xref="S3.SS3.p1.12.m12.1.1.2.2.cmml">g</mi><mi id="S3.SS3.p1.12.m12.1.1.2.3" xref="S3.SS3.p1.12.m12.1.1.2.3.cmml">t</mi><mi id="S3.SS3.p1.12.m12.1.1.3" xref="S3.SS3.p1.12.m12.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.12.m12.1b"><apply id="S3.SS3.p1.12.m12.1.1.cmml" xref="S3.SS3.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.12.m12.1.1.1.cmml" xref="S3.SS3.p1.12.m12.1.1">superscript</csymbol><apply id="S3.SS3.p1.12.m12.1.1.2.cmml" xref="S3.SS3.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.12.m12.1.1.2.1.cmml" xref="S3.SS3.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS3.p1.12.m12.1.1.2.2.cmml" xref="S3.SS3.p1.12.m12.1.1.2.2">𝑔</ci><ci id="S3.SS3.p1.12.m12.1.1.2.3.cmml" xref="S3.SS3.p1.12.m12.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.12.m12.1.1.3.cmml" xref="S3.SS3.p1.12.m12.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.12.m12.1c">g_{t}^{i}</annotation></semantics></math>, <math id="S3.SS3.p1.13.m13.1" class="ltx_Math" alttext="g_{t}^{j}" display="inline"><semantics id="S3.SS3.p1.13.m13.1a"><msubsup id="S3.SS3.p1.13.m13.1.1" xref="S3.SS3.p1.13.m13.1.1.cmml"><mi id="S3.SS3.p1.13.m13.1.1.2.2" xref="S3.SS3.p1.13.m13.1.1.2.2.cmml">g</mi><mi id="S3.SS3.p1.13.m13.1.1.2.3" xref="S3.SS3.p1.13.m13.1.1.2.3.cmml">t</mi><mi id="S3.SS3.p1.13.m13.1.1.3" xref="S3.SS3.p1.13.m13.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.13.m13.1b"><apply id="S3.SS3.p1.13.m13.1.1.cmml" xref="S3.SS3.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.13.m13.1.1.1.cmml" xref="S3.SS3.p1.13.m13.1.1">superscript</csymbol><apply id="S3.SS3.p1.13.m13.1.1.2.cmml" xref="S3.SS3.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.13.m13.1.1.2.1.cmml" xref="S3.SS3.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS3.p1.13.m13.1.1.2.2.cmml" xref="S3.SS3.p1.13.m13.1.1.2.2">𝑔</ci><ci id="S3.SS3.p1.13.m13.1.1.2.3.cmml" xref="S3.SS3.p1.13.m13.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.13.m13.1.1.3.cmml" xref="S3.SS3.p1.13.m13.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.13.m13.1c">g_{t}^{j}</annotation></semantics></math>),
FedGH executes harmonization by projecting <math id="S3.SS3.p1.14.m14.1" class="ltx_Math" alttext="g_{t}^{i}" display="inline"><semantics id="S3.SS3.p1.14.m14.1a"><msubsup id="S3.SS3.p1.14.m14.1.1" xref="S3.SS3.p1.14.m14.1.1.cmml"><mi id="S3.SS3.p1.14.m14.1.1.2.2" xref="S3.SS3.p1.14.m14.1.1.2.2.cmml">g</mi><mi id="S3.SS3.p1.14.m14.1.1.2.3" xref="S3.SS3.p1.14.m14.1.1.2.3.cmml">t</mi><mi id="S3.SS3.p1.14.m14.1.1.3" xref="S3.SS3.p1.14.m14.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.14.m14.1b"><apply id="S3.SS3.p1.14.m14.1.1.cmml" xref="S3.SS3.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m14.1.1.1.cmml" xref="S3.SS3.p1.14.m14.1.1">superscript</csymbol><apply id="S3.SS3.p1.14.m14.1.1.2.cmml" xref="S3.SS3.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m14.1.1.2.1.cmml" xref="S3.SS3.p1.14.m14.1.1">subscript</csymbol><ci id="S3.SS3.p1.14.m14.1.1.2.2.cmml" xref="S3.SS3.p1.14.m14.1.1.2.2">𝑔</ci><ci id="S3.SS3.p1.14.m14.1.1.2.3.cmml" xref="S3.SS3.p1.14.m14.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.14.m14.1.1.3.cmml" xref="S3.SS3.p1.14.m14.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.14.m14.1c">g_{t}^{i}</annotation></semantics></math> and <math id="S3.SS3.p1.15.m15.1" class="ltx_Math" alttext="g_{t}^{j}" display="inline"><semantics id="S3.SS3.p1.15.m15.1a"><msubsup id="S3.SS3.p1.15.m15.1.1" xref="S3.SS3.p1.15.m15.1.1.cmml"><mi id="S3.SS3.p1.15.m15.1.1.2.2" xref="S3.SS3.p1.15.m15.1.1.2.2.cmml">g</mi><mi id="S3.SS3.p1.15.m15.1.1.2.3" xref="S3.SS3.p1.15.m15.1.1.2.3.cmml">t</mi><mi id="S3.SS3.p1.15.m15.1.1.3" xref="S3.SS3.p1.15.m15.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.15.m15.1b"><apply id="S3.SS3.p1.15.m15.1.1.cmml" xref="S3.SS3.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.15.m15.1.1.1.cmml" xref="S3.SS3.p1.15.m15.1.1">superscript</csymbol><apply id="S3.SS3.p1.15.m15.1.1.2.cmml" xref="S3.SS3.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.15.m15.1.1.2.1.cmml" xref="S3.SS3.p1.15.m15.1.1">subscript</csymbol><ci id="S3.SS3.p1.15.m15.1.1.2.2.cmml" xref="S3.SS3.p1.15.m15.1.1.2.2">𝑔</ci><ci id="S3.SS3.p1.15.m15.1.1.2.3.cmml" xref="S3.SS3.p1.15.m15.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.15.m15.1.1.3.cmml" xref="S3.SS3.p1.15.m15.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.15.m15.1c">g_{t}^{j}</annotation></semantics></math> onto each other’s orthogonal planes as follows:</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<table id="S3.E1" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E1X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle g_{t}^{i}" display="inline"><semantics id="S3.E1X.2.1.1.m1.1a"><msubsup id="S3.E1X.2.1.1.m1.1.1" xref="S3.E1X.2.1.1.m1.1.1.cmml"><mi id="S3.E1X.2.1.1.m1.1.1.2.2" xref="S3.E1X.2.1.1.m1.1.1.2.2.cmml">g</mi><mi id="S3.E1X.2.1.1.m1.1.1.2.3" xref="S3.E1X.2.1.1.m1.1.1.2.3.cmml">t</mi><mi id="S3.E1X.2.1.1.m1.1.1.3" xref="S3.E1X.2.1.1.m1.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.E1X.2.1.1.m1.1b"><apply id="S3.E1X.2.1.1.m1.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.1.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.1">superscript</csymbol><apply id="S3.E1X.2.1.1.m1.1.1.2.cmml" xref="S3.E1X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E1X.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E1X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E1X.2.1.1.m1.1.1.2.2">𝑔</ci><ci id="S3.E1X.2.1.1.m1.1.1.2.3.cmml" xref="S3.E1X.2.1.1.m1.1.1.2.3">𝑡</ci></apply><ci id="S3.E1X.2.1.1.m1.1.1.3.cmml" xref="S3.E1X.2.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1X.2.1.1.m1.1c">\displaystyle g_{t}^{i}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1X.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle\leftarrow g_{t}^{i}-\frac{g_{t}^{i}\cdot\widetilde{g}_{t}^{j}}{{\|\widetilde{g}_{t}^{j}\|}^{2}}\widetilde{g}_{t}^{j}" display="inline"><semantics id="S3.E1X.3.2.2.m1.1a"><mrow id="S3.E1X.3.2.2.m1.1.2" xref="S3.E1X.3.2.2.m1.1.2.cmml"><mi id="S3.E1X.3.2.2.m1.1.2.2" xref="S3.E1X.3.2.2.m1.1.2.2.cmml"></mi><mo stretchy="false" id="S3.E1X.3.2.2.m1.1.2.1" xref="S3.E1X.3.2.2.m1.1.2.1.cmml">←</mo><mrow id="S3.E1X.3.2.2.m1.1.2.3" xref="S3.E1X.3.2.2.m1.1.2.3.cmml"><msubsup id="S3.E1X.3.2.2.m1.1.2.3.2" xref="S3.E1X.3.2.2.m1.1.2.3.2.cmml"><mi id="S3.E1X.3.2.2.m1.1.2.3.2.2.2" xref="S3.E1X.3.2.2.m1.1.2.3.2.2.2.cmml">g</mi><mi id="S3.E1X.3.2.2.m1.1.2.3.2.2.3" xref="S3.E1X.3.2.2.m1.1.2.3.2.2.3.cmml">t</mi><mi id="S3.E1X.3.2.2.m1.1.2.3.2.3" xref="S3.E1X.3.2.2.m1.1.2.3.2.3.cmml">i</mi></msubsup><mo id="S3.E1X.3.2.2.m1.1.2.3.1" xref="S3.E1X.3.2.2.m1.1.2.3.1.cmml">−</mo><mrow id="S3.E1X.3.2.2.m1.1.2.3.3" xref="S3.E1X.3.2.2.m1.1.2.3.3.cmml"><mstyle displaystyle="true" id="S3.E1X.3.2.2.m1.1.1" xref="S3.E1X.3.2.2.m1.1.1.cmml"><mfrac id="S3.E1X.3.2.2.m1.1.1a" xref="S3.E1X.3.2.2.m1.1.1.cmml"><mrow id="S3.E1X.3.2.2.m1.1.1.3" xref="S3.E1X.3.2.2.m1.1.1.3.cmml"><msubsup id="S3.E1X.3.2.2.m1.1.1.3.2" xref="S3.E1X.3.2.2.m1.1.1.3.2.cmml"><mi id="S3.E1X.3.2.2.m1.1.1.3.2.2.2" xref="S3.E1X.3.2.2.m1.1.1.3.2.2.2.cmml">g</mi><mi id="S3.E1X.3.2.2.m1.1.1.3.2.2.3" xref="S3.E1X.3.2.2.m1.1.1.3.2.2.3.cmml">t</mi><mi id="S3.E1X.3.2.2.m1.1.1.3.2.3" xref="S3.E1X.3.2.2.m1.1.1.3.2.3.cmml">i</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E1X.3.2.2.m1.1.1.3.1" xref="S3.E1X.3.2.2.m1.1.1.3.1.cmml">⋅</mo><msubsup id="S3.E1X.3.2.2.m1.1.1.3.3" xref="S3.E1X.3.2.2.m1.1.1.3.3.cmml"><mover accent="true" id="S3.E1X.3.2.2.m1.1.1.3.3.2.2" xref="S3.E1X.3.2.2.m1.1.1.3.3.2.2.cmml"><mi id="S3.E1X.3.2.2.m1.1.1.3.3.2.2.2" xref="S3.E1X.3.2.2.m1.1.1.3.3.2.2.2.cmml">g</mi><mo id="S3.E1X.3.2.2.m1.1.1.3.3.2.2.1" xref="S3.E1X.3.2.2.m1.1.1.3.3.2.2.1.cmml">~</mo></mover><mi id="S3.E1X.3.2.2.m1.1.1.3.3.2.3" xref="S3.E1X.3.2.2.m1.1.1.3.3.2.3.cmml">t</mi><mi id="S3.E1X.3.2.2.m1.1.1.3.3.3" xref="S3.E1X.3.2.2.m1.1.1.3.3.3.cmml">j</mi></msubsup></mrow><msup id="S3.E1X.3.2.2.m1.1.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.cmml"><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1X.3.2.2.m1.1.1.1.1.1.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.1.cmml">‖</mo><msubsup id="S3.E1X.3.2.2.m1.1.1.1.1.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.2.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.2.2.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.2.2.2.cmml">g</mi><mo id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.2.2.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.2.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.3.cmml">j</mi></msubsup><mo stretchy="false" id="S3.E1X.3.2.2.m1.1.1.1.1.1.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E1X.3.2.2.m1.1.1.1.3" xref="S3.E1X.3.2.2.m1.1.1.1.3.cmml">2</mn></msup></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E1X.3.2.2.m1.1.2.3.3.1" xref="S3.E1X.3.2.2.m1.1.2.3.3.1.cmml">​</mo><msubsup id="S3.E1X.3.2.2.m1.1.2.3.3.2" xref="S3.E1X.3.2.2.m1.1.2.3.3.2.cmml"><mover accent="true" id="S3.E1X.3.2.2.m1.1.2.3.3.2.2.2" xref="S3.E1X.3.2.2.m1.1.2.3.3.2.2.2.cmml"><mi id="S3.E1X.3.2.2.m1.1.2.3.3.2.2.2.2" xref="S3.E1X.3.2.2.m1.1.2.3.3.2.2.2.2.cmml">g</mi><mo id="S3.E1X.3.2.2.m1.1.2.3.3.2.2.2.1" xref="S3.E1X.3.2.2.m1.1.2.3.3.2.2.2.1.cmml">~</mo></mover><mi id="S3.E1X.3.2.2.m1.1.2.3.3.2.2.3" xref="S3.E1X.3.2.2.m1.1.2.3.3.2.2.3.cmml">t</mi><mi id="S3.E1X.3.2.2.m1.1.2.3.3.2.3" xref="S3.E1X.3.2.2.m1.1.2.3.3.2.3.cmml">j</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1X.3.2.2.m1.1b"><apply id="S3.E1X.3.2.2.m1.1.2.cmml" xref="S3.E1X.3.2.2.m1.1.2"><ci id="S3.E1X.3.2.2.m1.1.2.1.cmml" xref="S3.E1X.3.2.2.m1.1.2.1">←</ci><csymbol cd="latexml" id="S3.E1X.3.2.2.m1.1.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.2.2">absent</csymbol><apply id="S3.E1X.3.2.2.m1.1.2.3.cmml" xref="S3.E1X.3.2.2.m1.1.2.3"><minus id="S3.E1X.3.2.2.m1.1.2.3.1.cmml" xref="S3.E1X.3.2.2.m1.1.2.3.1"></minus><apply id="S3.E1X.3.2.2.m1.1.2.3.2.cmml" xref="S3.E1X.3.2.2.m1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.1.2.3.2.1.cmml" xref="S3.E1X.3.2.2.m1.1.2.3.2">superscript</csymbol><apply id="S3.E1X.3.2.2.m1.1.2.3.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.1.2.3.2.2.1.cmml" xref="S3.E1X.3.2.2.m1.1.2.3.2">subscript</csymbol><ci id="S3.E1X.3.2.2.m1.1.2.3.2.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.2.3.2.2.2">𝑔</ci><ci id="S3.E1X.3.2.2.m1.1.2.3.2.2.3.cmml" xref="S3.E1X.3.2.2.m1.1.2.3.2.2.3">𝑡</ci></apply><ci id="S3.E1X.3.2.2.m1.1.2.3.2.3.cmml" xref="S3.E1X.3.2.2.m1.1.2.3.2.3">𝑖</ci></apply><apply id="S3.E1X.3.2.2.m1.1.2.3.3.cmml" xref="S3.E1X.3.2.2.m1.1.2.3.3"><times id="S3.E1X.3.2.2.m1.1.2.3.3.1.cmml" xref="S3.E1X.3.2.2.m1.1.2.3.3.1"></times><apply id="S3.E1X.3.2.2.m1.1.1.cmml" xref="S3.E1X.3.2.2.m1.1.1"><divide id="S3.E1X.3.2.2.m1.1.1.2.cmml" xref="S3.E1X.3.2.2.m1.1.1"></divide><apply id="S3.E1X.3.2.2.m1.1.1.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.3"><ci id="S3.E1X.3.2.2.m1.1.1.3.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.3.1">⋅</ci><apply id="S3.E1X.3.2.2.m1.1.1.3.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.1.1.3.2.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.3.2">superscript</csymbol><apply id="S3.E1X.3.2.2.m1.1.1.3.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.1.1.3.2.2.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.3.2">subscript</csymbol><ci id="S3.E1X.3.2.2.m1.1.1.3.2.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.3.2.2.2">𝑔</ci><ci id="S3.E1X.3.2.2.m1.1.1.3.2.2.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.3.2.2.3">𝑡</ci></apply><ci id="S3.E1X.3.2.2.m1.1.1.3.2.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.3.2.3">𝑖</ci></apply><apply id="S3.E1X.3.2.2.m1.1.1.3.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.1.1.3.3.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.3.3">superscript</csymbol><apply id="S3.E1X.3.2.2.m1.1.1.3.3.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.1.1.3.3.2.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.3.3">subscript</csymbol><apply id="S3.E1X.3.2.2.m1.1.1.3.3.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.3.3.2.2"><ci id="S3.E1X.3.2.2.m1.1.1.3.3.2.2.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.3.3.2.2.1">~</ci><ci id="S3.E1X.3.2.2.m1.1.1.3.3.2.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.3.3.2.2.2">𝑔</ci></apply><ci id="S3.E1X.3.2.2.m1.1.1.3.3.2.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.3.3.2.3">𝑡</ci></apply><ci id="S3.E1X.3.2.2.m1.1.1.3.3.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S3.E1X.3.2.2.m1.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.1.1.1.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1">superscript</csymbol><apply id="S3.E1X.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1X.3.2.2.m1.1.1.1.1.2.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.2.2"><ci id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.2.2.1">~</ci><ci id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.2.2.2">𝑔</ci></apply><ci id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><cn type="integer" id="S3.E1X.3.2.2.m1.1.1.1.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.3">2</cn></apply></apply><apply id="S3.E1X.3.2.2.m1.1.2.3.3.2.cmml" xref="S3.E1X.3.2.2.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.1.2.3.3.2.1.cmml" xref="S3.E1X.3.2.2.m1.1.2.3.3.2">superscript</csymbol><apply id="S3.E1X.3.2.2.m1.1.2.3.3.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.1.2.3.3.2.2.1.cmml" xref="S3.E1X.3.2.2.m1.1.2.3.3.2">subscript</csymbol><apply id="S3.E1X.3.2.2.m1.1.2.3.3.2.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.2.3.3.2.2.2"><ci id="S3.E1X.3.2.2.m1.1.2.3.3.2.2.2.1.cmml" xref="S3.E1X.3.2.2.m1.1.2.3.3.2.2.2.1">~</ci><ci id="S3.E1X.3.2.2.m1.1.2.3.3.2.2.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.2.3.3.2.2.2.2">𝑔</ci></apply><ci id="S3.E1X.3.2.2.m1.1.2.3.3.2.2.3.cmml" xref="S3.E1X.3.2.2.m1.1.2.3.3.2.2.3">𝑡</ci></apply><ci id="S3.E1X.3.2.2.m1.1.2.3.3.2.3.cmml" xref="S3.E1X.3.2.2.m1.1.2.3.3.2.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1X.3.2.2.m1.1c">\displaystyle\leftarrow g_{t}^{i}-\frac{g_{t}^{i}\cdot\widetilde{g}_{t}^{j}}{{\|\widetilde{g}_{t}^{j}\|}^{2}}\widetilde{g}_{t}^{j}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(1)</span></td>
</tr>
<tr id="S3.E1Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle g_{t}^{j}" display="inline"><semantics id="S3.E1Xa.2.1.1.m1.1a"><msubsup id="S3.E1Xa.2.1.1.m1.1.1" xref="S3.E1Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E1Xa.2.1.1.m1.1.1.2.2" xref="S3.E1Xa.2.1.1.m1.1.1.2.2.cmml">g</mi><mi id="S3.E1Xa.2.1.1.m1.1.1.2.3" xref="S3.E1Xa.2.1.1.m1.1.1.2.3.cmml">t</mi><mi id="S3.E1Xa.2.1.1.m1.1.1.3" xref="S3.E1Xa.2.1.1.m1.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.E1Xa.2.1.1.m1.1b"><apply id="S3.E1Xa.2.1.1.m1.1.1.cmml" xref="S3.E1Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E1Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E1Xa.2.1.1.m1.1.1">superscript</csymbol><apply id="S3.E1Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E1Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E1Xa.2.1.1.m1.1.1.2.1.cmml" xref="S3.E1Xa.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E1Xa.2.1.1.m1.1.1.2.2.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.2.2">𝑔</ci><ci id="S3.E1Xa.2.1.1.m1.1.1.2.3.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.2.3">𝑡</ci></apply><ci id="S3.E1Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1Xa.2.1.1.m1.1c">\displaystyle g_{t}^{j}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1Xa.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle\leftarrow g_{t}^{j}-\frac{g_{t}^{j}\cdot\widetilde{g}_{t}^{i}}{{\|\widetilde{g}_{t}^{i}\|}^{2}}\widetilde{g}_{t}^{i}" display="inline"><semantics id="S3.E1Xa.3.2.2.m1.1a"><mrow id="S3.E1Xa.3.2.2.m1.1.2" xref="S3.E1Xa.3.2.2.m1.1.2.cmml"><mi id="S3.E1Xa.3.2.2.m1.1.2.2" xref="S3.E1Xa.3.2.2.m1.1.2.2.cmml"></mi><mo stretchy="false" id="S3.E1Xa.3.2.2.m1.1.2.1" xref="S3.E1Xa.3.2.2.m1.1.2.1.cmml">←</mo><mrow id="S3.E1Xa.3.2.2.m1.1.2.3" xref="S3.E1Xa.3.2.2.m1.1.2.3.cmml"><msubsup id="S3.E1Xa.3.2.2.m1.1.2.3.2" xref="S3.E1Xa.3.2.2.m1.1.2.3.2.cmml"><mi id="S3.E1Xa.3.2.2.m1.1.2.3.2.2.2" xref="S3.E1Xa.3.2.2.m1.1.2.3.2.2.2.cmml">g</mi><mi id="S3.E1Xa.3.2.2.m1.1.2.3.2.2.3" xref="S3.E1Xa.3.2.2.m1.1.2.3.2.2.3.cmml">t</mi><mi id="S3.E1Xa.3.2.2.m1.1.2.3.2.3" xref="S3.E1Xa.3.2.2.m1.1.2.3.2.3.cmml">j</mi></msubsup><mo id="S3.E1Xa.3.2.2.m1.1.2.3.1" xref="S3.E1Xa.3.2.2.m1.1.2.3.1.cmml">−</mo><mrow id="S3.E1Xa.3.2.2.m1.1.2.3.3" xref="S3.E1Xa.3.2.2.m1.1.2.3.3.cmml"><mstyle displaystyle="true" id="S3.E1Xa.3.2.2.m1.1.1" xref="S3.E1Xa.3.2.2.m1.1.1.cmml"><mfrac id="S3.E1Xa.3.2.2.m1.1.1a" xref="S3.E1Xa.3.2.2.m1.1.1.cmml"><mrow id="S3.E1Xa.3.2.2.m1.1.1.3" xref="S3.E1Xa.3.2.2.m1.1.1.3.cmml"><msubsup id="S3.E1Xa.3.2.2.m1.1.1.3.2" xref="S3.E1Xa.3.2.2.m1.1.1.3.2.cmml"><mi id="S3.E1Xa.3.2.2.m1.1.1.3.2.2.2" xref="S3.E1Xa.3.2.2.m1.1.1.3.2.2.2.cmml">g</mi><mi id="S3.E1Xa.3.2.2.m1.1.1.3.2.2.3" xref="S3.E1Xa.3.2.2.m1.1.1.3.2.2.3.cmml">t</mi><mi id="S3.E1Xa.3.2.2.m1.1.1.3.2.3" xref="S3.E1Xa.3.2.2.m1.1.1.3.2.3.cmml">j</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E1Xa.3.2.2.m1.1.1.3.1" xref="S3.E1Xa.3.2.2.m1.1.1.3.1.cmml">⋅</mo><msubsup id="S3.E1Xa.3.2.2.m1.1.1.3.3" xref="S3.E1Xa.3.2.2.m1.1.1.3.3.cmml"><mover accent="true" id="S3.E1Xa.3.2.2.m1.1.1.3.3.2.2" xref="S3.E1Xa.3.2.2.m1.1.1.3.3.2.2.cmml"><mi id="S3.E1Xa.3.2.2.m1.1.1.3.3.2.2.2" xref="S3.E1Xa.3.2.2.m1.1.1.3.3.2.2.2.cmml">g</mi><mo id="S3.E1Xa.3.2.2.m1.1.1.3.3.2.2.1" xref="S3.E1Xa.3.2.2.m1.1.1.3.3.2.2.1.cmml">~</mo></mover><mi id="S3.E1Xa.3.2.2.m1.1.1.3.3.2.3" xref="S3.E1Xa.3.2.2.m1.1.1.3.3.2.3.cmml">t</mi><mi id="S3.E1Xa.3.2.2.m1.1.1.3.3.3" xref="S3.E1Xa.3.2.2.m1.1.1.3.3.3.cmml">i</mi></msubsup></mrow><msup id="S3.E1Xa.3.2.2.m1.1.1.1" xref="S3.E1Xa.3.2.2.m1.1.1.1.cmml"><mrow id="S3.E1Xa.3.2.2.m1.1.1.1.1.1" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.2" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.2.1.cmml">‖</mo><msubsup id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.cmml">g</mi><mo id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.1" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.3" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.3" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E1Xa.3.2.2.m1.1.1.1.3" xref="S3.E1Xa.3.2.2.m1.1.1.1.3.cmml">2</mn></msup></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E1Xa.3.2.2.m1.1.2.3.3.1" xref="S3.E1Xa.3.2.2.m1.1.2.3.3.1.cmml">​</mo><msubsup id="S3.E1Xa.3.2.2.m1.1.2.3.3.2" xref="S3.E1Xa.3.2.2.m1.1.2.3.3.2.cmml"><mover accent="true" id="S3.E1Xa.3.2.2.m1.1.2.3.3.2.2.2" xref="S3.E1Xa.3.2.2.m1.1.2.3.3.2.2.2.cmml"><mi id="S3.E1Xa.3.2.2.m1.1.2.3.3.2.2.2.2" xref="S3.E1Xa.3.2.2.m1.1.2.3.3.2.2.2.2.cmml">g</mi><mo id="S3.E1Xa.3.2.2.m1.1.2.3.3.2.2.2.1" xref="S3.E1Xa.3.2.2.m1.1.2.3.3.2.2.2.1.cmml">~</mo></mover><mi id="S3.E1Xa.3.2.2.m1.1.2.3.3.2.2.3" xref="S3.E1Xa.3.2.2.m1.1.2.3.3.2.2.3.cmml">t</mi><mi id="S3.E1Xa.3.2.2.m1.1.2.3.3.2.3" xref="S3.E1Xa.3.2.2.m1.1.2.3.3.2.3.cmml">i</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1Xa.3.2.2.m1.1b"><apply id="S3.E1Xa.3.2.2.m1.1.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.2"><ci id="S3.E1Xa.3.2.2.m1.1.2.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.1">←</ci><csymbol cd="latexml" id="S3.E1Xa.3.2.2.m1.1.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.2">absent</csymbol><apply id="S3.E1Xa.3.2.2.m1.1.2.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.3"><minus id="S3.E1Xa.3.2.2.m1.1.2.3.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.3.1"></minus><apply id="S3.E1Xa.3.2.2.m1.1.2.3.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E1Xa.3.2.2.m1.1.2.3.2.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.3.2">superscript</csymbol><apply id="S3.E1Xa.3.2.2.m1.1.2.3.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E1Xa.3.2.2.m1.1.2.3.2.2.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.3.2">subscript</csymbol><ci id="S3.E1Xa.3.2.2.m1.1.2.3.2.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.3.2.2.2">𝑔</ci><ci id="S3.E1Xa.3.2.2.m1.1.2.3.2.2.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.3.2.2.3">𝑡</ci></apply><ci id="S3.E1Xa.3.2.2.m1.1.2.3.2.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.3.2.3">𝑗</ci></apply><apply id="S3.E1Xa.3.2.2.m1.1.2.3.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.3.3"><times id="S3.E1Xa.3.2.2.m1.1.2.3.3.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.3.3.1"></times><apply id="S3.E1Xa.3.2.2.m1.1.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1"><divide id="S3.E1Xa.3.2.2.m1.1.1.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1"></divide><apply id="S3.E1Xa.3.2.2.m1.1.1.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.3"><ci id="S3.E1Xa.3.2.2.m1.1.1.3.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.3.1">⋅</ci><apply id="S3.E1Xa.3.2.2.m1.1.1.3.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1Xa.3.2.2.m1.1.1.3.2.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.3.2">superscript</csymbol><apply id="S3.E1Xa.3.2.2.m1.1.1.3.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1Xa.3.2.2.m1.1.1.3.2.2.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.3.2">subscript</csymbol><ci id="S3.E1Xa.3.2.2.m1.1.1.3.2.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.3.2.2.2">𝑔</ci><ci id="S3.E1Xa.3.2.2.m1.1.1.3.2.2.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.3.2.2.3">𝑡</ci></apply><ci id="S3.E1Xa.3.2.2.m1.1.1.3.2.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.3.2.3">𝑗</ci></apply><apply id="S3.E1Xa.3.2.2.m1.1.1.3.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1Xa.3.2.2.m1.1.1.3.3.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.3.3">superscript</csymbol><apply id="S3.E1Xa.3.2.2.m1.1.1.3.3.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1Xa.3.2.2.m1.1.1.3.3.2.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.3.3">subscript</csymbol><apply id="S3.E1Xa.3.2.2.m1.1.1.3.3.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.3.3.2.2"><ci id="S3.E1Xa.3.2.2.m1.1.1.3.3.2.2.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.3.3.2.2.1">~</ci><ci id="S3.E1Xa.3.2.2.m1.1.1.3.3.2.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.3.3.2.2.2">𝑔</ci></apply><ci id="S3.E1Xa.3.2.2.m1.1.1.3.3.2.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.3.3.2.3">𝑡</ci></apply><ci id="S3.E1Xa.3.2.2.m1.1.1.3.3.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S3.E1Xa.3.2.2.m1.1.1.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E1Xa.3.2.2.m1.1.1.1.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1">superscript</csymbol><apply id="S3.E1Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1Xa.3.2.2.m1.1.1.1.1.2.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2"><ci id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.1">~</ci><ci id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2">𝑔</ci></apply><ci id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn type="integer" id="S3.E1Xa.3.2.2.m1.1.1.1.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.3">2</cn></apply></apply><apply id="S3.E1Xa.3.2.2.m1.1.2.3.3.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="S3.E1Xa.3.2.2.m1.1.2.3.3.2.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.3.3.2">superscript</csymbol><apply id="S3.E1Xa.3.2.2.m1.1.2.3.3.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="S3.E1Xa.3.2.2.m1.1.2.3.3.2.2.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.3.3.2">subscript</csymbol><apply id="S3.E1Xa.3.2.2.m1.1.2.3.3.2.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.3.3.2.2.2"><ci id="S3.E1Xa.3.2.2.m1.1.2.3.3.2.2.2.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.3.3.2.2.2.1">~</ci><ci id="S3.E1Xa.3.2.2.m1.1.2.3.3.2.2.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.3.3.2.2.2.2">𝑔</ci></apply><ci id="S3.E1Xa.3.2.2.m1.1.2.3.3.2.2.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.3.3.2.2.3">𝑡</ci></apply><ci id="S3.E1Xa.3.2.2.m1.1.2.3.3.2.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.2.3.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1Xa.3.2.2.m1.1c">\displaystyle\leftarrow g_{t}^{j}-\frac{g_{t}^{j}\cdot\widetilde{g}_{t}^{i}}{{\|\widetilde{g}_{t}^{i}\|}^{2}}\widetilde{g}_{t}^{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.2" class="ltx_p">Where <math id="S3.SS3.p3.1.m1.4" class="ltx_Math" alttext="\widetilde{G}_{t}=(\widetilde{g}_{t}^{1},\widetilde{g}_{t}^{2},…,\widetilde{g}_{t}^{K})" display="inline"><semantics id="S3.SS3.p3.1.m1.4a"><mrow id="S3.SS3.p3.1.m1.4.4" xref="S3.SS3.p3.1.m1.4.4.cmml"><msub id="S3.SS3.p3.1.m1.4.4.5" xref="S3.SS3.p3.1.m1.4.4.5.cmml"><mover accent="true" id="S3.SS3.p3.1.m1.4.4.5.2" xref="S3.SS3.p3.1.m1.4.4.5.2.cmml"><mi id="S3.SS3.p3.1.m1.4.4.5.2.2" xref="S3.SS3.p3.1.m1.4.4.5.2.2.cmml">G</mi><mo id="S3.SS3.p3.1.m1.4.4.5.2.1" xref="S3.SS3.p3.1.m1.4.4.5.2.1.cmml">~</mo></mover><mi id="S3.SS3.p3.1.m1.4.4.5.3" xref="S3.SS3.p3.1.m1.4.4.5.3.cmml">t</mi></msub><mo id="S3.SS3.p3.1.m1.4.4.4" xref="S3.SS3.p3.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS3.p3.1.m1.4.4.3.3" xref="S3.SS3.p3.1.m1.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS3.p3.1.m1.4.4.3.3.4" xref="S3.SS3.p3.1.m1.4.4.3.4.cmml">(</mo><msubsup id="S3.SS3.p3.1.m1.2.2.1.1.1" xref="S3.SS3.p3.1.m1.2.2.1.1.1.cmml"><mover accent="true" id="S3.SS3.p3.1.m1.2.2.1.1.1.2.2" xref="S3.SS3.p3.1.m1.2.2.1.1.1.2.2.cmml"><mi id="S3.SS3.p3.1.m1.2.2.1.1.1.2.2.2" xref="S3.SS3.p3.1.m1.2.2.1.1.1.2.2.2.cmml">g</mi><mo id="S3.SS3.p3.1.m1.2.2.1.1.1.2.2.1" xref="S3.SS3.p3.1.m1.2.2.1.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.SS3.p3.1.m1.2.2.1.1.1.2.3" xref="S3.SS3.p3.1.m1.2.2.1.1.1.2.3.cmml">t</mi><mn id="S3.SS3.p3.1.m1.2.2.1.1.1.3" xref="S3.SS3.p3.1.m1.2.2.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS3.p3.1.m1.4.4.3.3.5" xref="S3.SS3.p3.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS3.p3.1.m1.3.3.2.2.2" xref="S3.SS3.p3.1.m1.3.3.2.2.2.cmml"><mover accent="true" id="S3.SS3.p3.1.m1.3.3.2.2.2.2.2" xref="S3.SS3.p3.1.m1.3.3.2.2.2.2.2.cmml"><mi id="S3.SS3.p3.1.m1.3.3.2.2.2.2.2.2" xref="S3.SS3.p3.1.m1.3.3.2.2.2.2.2.2.cmml">g</mi><mo id="S3.SS3.p3.1.m1.3.3.2.2.2.2.2.1" xref="S3.SS3.p3.1.m1.3.3.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S3.SS3.p3.1.m1.3.3.2.2.2.2.3" xref="S3.SS3.p3.1.m1.3.3.2.2.2.2.3.cmml">t</mi><mn id="S3.SS3.p3.1.m1.3.3.2.2.2.3" xref="S3.SS3.p3.1.m1.3.3.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS3.p3.1.m1.4.4.3.3.6" xref="S3.SS3.p3.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">…</mi><mo id="S3.SS3.p3.1.m1.4.4.3.3.7" xref="S3.SS3.p3.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS3.p3.1.m1.4.4.3.3.3" xref="S3.SS3.p3.1.m1.4.4.3.3.3.cmml"><mover accent="true" id="S3.SS3.p3.1.m1.4.4.3.3.3.2.2" xref="S3.SS3.p3.1.m1.4.4.3.3.3.2.2.cmml"><mi id="S3.SS3.p3.1.m1.4.4.3.3.3.2.2.2" xref="S3.SS3.p3.1.m1.4.4.3.3.3.2.2.2.cmml">g</mi><mo id="S3.SS3.p3.1.m1.4.4.3.3.3.2.2.1" xref="S3.SS3.p3.1.m1.4.4.3.3.3.2.2.1.cmml">~</mo></mover><mi id="S3.SS3.p3.1.m1.4.4.3.3.3.2.3" xref="S3.SS3.p3.1.m1.4.4.3.3.3.2.3.cmml">t</mi><mi id="S3.SS3.p3.1.m1.4.4.3.3.3.3" xref="S3.SS3.p3.1.m1.4.4.3.3.3.3.cmml">K</mi></msubsup><mo stretchy="false" id="S3.SS3.p3.1.m1.4.4.3.3.8" xref="S3.SS3.p3.1.m1.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.4b"><apply id="S3.SS3.p3.1.m1.4.4.cmml" xref="S3.SS3.p3.1.m1.4.4"><eq id="S3.SS3.p3.1.m1.4.4.4.cmml" xref="S3.SS3.p3.1.m1.4.4.4"></eq><apply id="S3.SS3.p3.1.m1.4.4.5.cmml" xref="S3.SS3.p3.1.m1.4.4.5"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.4.4.5.1.cmml" xref="S3.SS3.p3.1.m1.4.4.5">subscript</csymbol><apply id="S3.SS3.p3.1.m1.4.4.5.2.cmml" xref="S3.SS3.p3.1.m1.4.4.5.2"><ci id="S3.SS3.p3.1.m1.4.4.5.2.1.cmml" xref="S3.SS3.p3.1.m1.4.4.5.2.1">~</ci><ci id="S3.SS3.p3.1.m1.4.4.5.2.2.cmml" xref="S3.SS3.p3.1.m1.4.4.5.2.2">𝐺</ci></apply><ci id="S3.SS3.p3.1.m1.4.4.5.3.cmml" xref="S3.SS3.p3.1.m1.4.4.5.3">𝑡</ci></apply><vector id="S3.SS3.p3.1.m1.4.4.3.4.cmml" xref="S3.SS3.p3.1.m1.4.4.3.3"><apply id="S3.SS3.p3.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.p3.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.2.2.1.1.1">superscript</csymbol><apply id="S3.SS3.p3.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS3.p3.1.m1.2.2.1.1.1">subscript</csymbol><apply id="S3.SS3.p3.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS3.p3.1.m1.2.2.1.1.1.2.2"><ci id="S3.SS3.p3.1.m1.2.2.1.1.1.2.2.1.cmml" xref="S3.SS3.p3.1.m1.2.2.1.1.1.2.2.1">~</ci><ci id="S3.SS3.p3.1.m1.2.2.1.1.1.2.2.2.cmml" xref="S3.SS3.p3.1.m1.2.2.1.1.1.2.2.2">𝑔</ci></apply><ci id="S3.SS3.p3.1.m1.2.2.1.1.1.2.3.cmml" xref="S3.SS3.p3.1.m1.2.2.1.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS3.p3.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS3.p3.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.p3.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS3.p3.1.m1.3.3.2.2.2">superscript</csymbol><apply id="S3.SS3.p3.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS3.p3.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS3.p3.1.m1.3.3.2.2.2">subscript</csymbol><apply id="S3.SS3.p3.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS3.p3.1.m1.3.3.2.2.2.2.2"><ci id="S3.SS3.p3.1.m1.3.3.2.2.2.2.2.1.cmml" xref="S3.SS3.p3.1.m1.3.3.2.2.2.2.2.1">~</ci><ci id="S3.SS3.p3.1.m1.3.3.2.2.2.2.2.2.cmml" xref="S3.SS3.p3.1.m1.3.3.2.2.2.2.2.2">𝑔</ci></apply><ci id="S3.SS3.p3.1.m1.3.3.2.2.2.2.3.cmml" xref="S3.SS3.p3.1.m1.3.3.2.2.2.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS3.p3.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS3.p3.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">…</ci><apply id="S3.SS3.p3.1.m1.4.4.3.3.3.cmml" xref="S3.SS3.p3.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS3.p3.1.m1.4.4.3.3.3">superscript</csymbol><apply id="S3.SS3.p3.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS3.p3.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.4.4.3.3.3.2.1.cmml" xref="S3.SS3.p3.1.m1.4.4.3.3.3">subscript</csymbol><apply id="S3.SS3.p3.1.m1.4.4.3.3.3.2.2.cmml" xref="S3.SS3.p3.1.m1.4.4.3.3.3.2.2"><ci id="S3.SS3.p3.1.m1.4.4.3.3.3.2.2.1.cmml" xref="S3.SS3.p3.1.m1.4.4.3.3.3.2.2.1">~</ci><ci id="S3.SS3.p3.1.m1.4.4.3.3.3.2.2.2.cmml" xref="S3.SS3.p3.1.m1.4.4.3.3.3.2.2.2">𝑔</ci></apply><ci id="S3.SS3.p3.1.m1.4.4.3.3.3.2.3.cmml" xref="S3.SS3.p3.1.m1.4.4.3.3.3.2.3">𝑡</ci></apply><ci id="S3.SS3.p3.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS3.p3.1.m1.4.4.3.3.3.3">𝐾</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.4c">\widetilde{G}_{t}=(\widetilde{g}_{t}^{1},\widetilde{g}_{t}^{2},…,\widetilde{g}_{t}^{K})</annotation></semantics></math> is the deepcopy of <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="G_{t}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><msub id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">G</mi><mi id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">𝐺</ci><ci id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">G_{t}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.4" class="ltx_p">(4) Finally, local models <math id="S3.SS3.p4.1.m1.4" class="ltx_Math" alttext="W_{t}=(w_{t}^{1},w_{t}^{2},…,w_{t}^{K})" display="inline"><semantics id="S3.SS3.p4.1.m1.4a"><mrow id="S3.SS3.p4.1.m1.4.4" xref="S3.SS3.p4.1.m1.4.4.cmml"><msub id="S3.SS3.p4.1.m1.4.4.5" xref="S3.SS3.p4.1.m1.4.4.5.cmml"><mi id="S3.SS3.p4.1.m1.4.4.5.2" xref="S3.SS3.p4.1.m1.4.4.5.2.cmml">W</mi><mi id="S3.SS3.p4.1.m1.4.4.5.3" xref="S3.SS3.p4.1.m1.4.4.5.3.cmml">t</mi></msub><mo id="S3.SS3.p4.1.m1.4.4.4" xref="S3.SS3.p4.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS3.p4.1.m1.4.4.3.3" xref="S3.SS3.p4.1.m1.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS3.p4.1.m1.4.4.3.3.4" xref="S3.SS3.p4.1.m1.4.4.3.4.cmml">(</mo><msubsup id="S3.SS3.p4.1.m1.2.2.1.1.1" xref="S3.SS3.p4.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.p4.1.m1.2.2.1.1.1.2.2" xref="S3.SS3.p4.1.m1.2.2.1.1.1.2.2.cmml">w</mi><mi id="S3.SS3.p4.1.m1.2.2.1.1.1.2.3" xref="S3.SS3.p4.1.m1.2.2.1.1.1.2.3.cmml">t</mi><mn id="S3.SS3.p4.1.m1.2.2.1.1.1.3" xref="S3.SS3.p4.1.m1.2.2.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS3.p4.1.m1.4.4.3.3.5" xref="S3.SS3.p4.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS3.p4.1.m1.3.3.2.2.2" xref="S3.SS3.p4.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS3.p4.1.m1.3.3.2.2.2.2.2" xref="S3.SS3.p4.1.m1.3.3.2.2.2.2.2.cmml">w</mi><mi id="S3.SS3.p4.1.m1.3.3.2.2.2.2.3" xref="S3.SS3.p4.1.m1.3.3.2.2.2.2.3.cmml">t</mi><mn id="S3.SS3.p4.1.m1.3.3.2.2.2.3" xref="S3.SS3.p4.1.m1.3.3.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS3.p4.1.m1.4.4.3.3.6" xref="S3.SS3.p4.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">…</mi><mo id="S3.SS3.p4.1.m1.4.4.3.3.7" xref="S3.SS3.p4.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS3.p4.1.m1.4.4.3.3.3" xref="S3.SS3.p4.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS3.p4.1.m1.4.4.3.3.3.2.2" xref="S3.SS3.p4.1.m1.4.4.3.3.3.2.2.cmml">w</mi><mi id="S3.SS3.p4.1.m1.4.4.3.3.3.2.3" xref="S3.SS3.p4.1.m1.4.4.3.3.3.2.3.cmml">t</mi><mi id="S3.SS3.p4.1.m1.4.4.3.3.3.3" xref="S3.SS3.p4.1.m1.4.4.3.3.3.3.cmml">K</mi></msubsup><mo stretchy="false" id="S3.SS3.p4.1.m1.4.4.3.3.8" xref="S3.SS3.p4.1.m1.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.4b"><apply id="S3.SS3.p4.1.m1.4.4.cmml" xref="S3.SS3.p4.1.m1.4.4"><eq id="S3.SS3.p4.1.m1.4.4.4.cmml" xref="S3.SS3.p4.1.m1.4.4.4"></eq><apply id="S3.SS3.p4.1.m1.4.4.5.cmml" xref="S3.SS3.p4.1.m1.4.4.5"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.4.4.5.1.cmml" xref="S3.SS3.p4.1.m1.4.4.5">subscript</csymbol><ci id="S3.SS3.p4.1.m1.4.4.5.2.cmml" xref="S3.SS3.p4.1.m1.4.4.5.2">𝑊</ci><ci id="S3.SS3.p4.1.m1.4.4.5.3.cmml" xref="S3.SS3.p4.1.m1.4.4.5.3">𝑡</ci></apply><vector id="S3.SS3.p4.1.m1.4.4.3.4.cmml" xref="S3.SS3.p4.1.m1.4.4.3.3"><apply id="S3.SS3.p4.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.p4.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.2.2.1.1.1">superscript</csymbol><apply id="S3.SS3.p4.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS3.p4.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p4.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS3.p4.1.m1.2.2.1.1.1.2.2">𝑤</ci><ci id="S3.SS3.p4.1.m1.2.2.1.1.1.2.3.cmml" xref="S3.SS3.p4.1.m1.2.2.1.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS3.p4.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS3.p4.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.p4.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS3.p4.1.m1.3.3.2.2.2">superscript</csymbol><apply id="S3.SS3.p4.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS3.p4.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS3.p4.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.p4.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS3.p4.1.m1.3.3.2.2.2.2.2">𝑤</ci><ci id="S3.SS3.p4.1.m1.3.3.2.2.2.2.3.cmml" xref="S3.SS3.p4.1.m1.3.3.2.2.2.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS3.p4.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS3.p4.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">…</ci><apply id="S3.SS3.p4.1.m1.4.4.3.3.3.cmml" xref="S3.SS3.p4.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS3.p4.1.m1.4.4.3.3.3">superscript</csymbol><apply id="S3.SS3.p4.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS3.p4.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.4.4.3.3.3.2.1.cmml" xref="S3.SS3.p4.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS3.p4.1.m1.4.4.3.3.3.2.2.cmml" xref="S3.SS3.p4.1.m1.4.4.3.3.3.2.2">𝑤</ci><ci id="S3.SS3.p4.1.m1.4.4.3.3.3.2.3.cmml" xref="S3.SS3.p4.1.m1.4.4.3.3.3.2.3">𝑡</ci></apply><ci id="S3.SS3.p4.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS3.p4.1.m1.4.4.3.3.3.3">𝐾</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.4c">W_{t}=(w_{t}^{1},w_{t}^{2},…,w_{t}^{K})</annotation></semantics></math> are updated using the adjusted gradients
<math id="S3.SS3.p4.2.m2.4" class="ltx_Math" alttext="G_{t}=(g_{t}^{1},g_{t}^{2},…,g_{t}^{K})" display="inline"><semantics id="S3.SS3.p4.2.m2.4a"><mrow id="S3.SS3.p4.2.m2.4.4" xref="S3.SS3.p4.2.m2.4.4.cmml"><msub id="S3.SS3.p4.2.m2.4.4.5" xref="S3.SS3.p4.2.m2.4.4.5.cmml"><mi id="S3.SS3.p4.2.m2.4.4.5.2" xref="S3.SS3.p4.2.m2.4.4.5.2.cmml">G</mi><mi id="S3.SS3.p4.2.m2.4.4.5.3" xref="S3.SS3.p4.2.m2.4.4.5.3.cmml">t</mi></msub><mo id="S3.SS3.p4.2.m2.4.4.4" xref="S3.SS3.p4.2.m2.4.4.4.cmml">=</mo><mrow id="S3.SS3.p4.2.m2.4.4.3.3" xref="S3.SS3.p4.2.m2.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS3.p4.2.m2.4.4.3.3.4" xref="S3.SS3.p4.2.m2.4.4.3.4.cmml">(</mo><msubsup id="S3.SS3.p4.2.m2.2.2.1.1.1" xref="S3.SS3.p4.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS3.p4.2.m2.2.2.1.1.1.2.2" xref="S3.SS3.p4.2.m2.2.2.1.1.1.2.2.cmml">g</mi><mi id="S3.SS3.p4.2.m2.2.2.1.1.1.2.3" xref="S3.SS3.p4.2.m2.2.2.1.1.1.2.3.cmml">t</mi><mn id="S3.SS3.p4.2.m2.2.2.1.1.1.3" xref="S3.SS3.p4.2.m2.2.2.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS3.p4.2.m2.4.4.3.3.5" xref="S3.SS3.p4.2.m2.4.4.3.4.cmml">,</mo><msubsup id="S3.SS3.p4.2.m2.3.3.2.2.2" xref="S3.SS3.p4.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS3.p4.2.m2.3.3.2.2.2.2.2" xref="S3.SS3.p4.2.m2.3.3.2.2.2.2.2.cmml">g</mi><mi id="S3.SS3.p4.2.m2.3.3.2.2.2.2.3" xref="S3.SS3.p4.2.m2.3.3.2.2.2.2.3.cmml">t</mi><mn id="S3.SS3.p4.2.m2.3.3.2.2.2.3" xref="S3.SS3.p4.2.m2.3.3.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS3.p4.2.m2.4.4.3.3.6" xref="S3.SS3.p4.2.m2.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml">…</mi><mo id="S3.SS3.p4.2.m2.4.4.3.3.7" xref="S3.SS3.p4.2.m2.4.4.3.4.cmml">,</mo><msubsup id="S3.SS3.p4.2.m2.4.4.3.3.3" xref="S3.SS3.p4.2.m2.4.4.3.3.3.cmml"><mi id="S3.SS3.p4.2.m2.4.4.3.3.3.2.2" xref="S3.SS3.p4.2.m2.4.4.3.3.3.2.2.cmml">g</mi><mi id="S3.SS3.p4.2.m2.4.4.3.3.3.2.3" xref="S3.SS3.p4.2.m2.4.4.3.3.3.2.3.cmml">t</mi><mi id="S3.SS3.p4.2.m2.4.4.3.3.3.3" xref="S3.SS3.p4.2.m2.4.4.3.3.3.3.cmml">K</mi></msubsup><mo stretchy="false" id="S3.SS3.p4.2.m2.4.4.3.3.8" xref="S3.SS3.p4.2.m2.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.4b"><apply id="S3.SS3.p4.2.m2.4.4.cmml" xref="S3.SS3.p4.2.m2.4.4"><eq id="S3.SS3.p4.2.m2.4.4.4.cmml" xref="S3.SS3.p4.2.m2.4.4.4"></eq><apply id="S3.SS3.p4.2.m2.4.4.5.cmml" xref="S3.SS3.p4.2.m2.4.4.5"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.4.4.5.1.cmml" xref="S3.SS3.p4.2.m2.4.4.5">subscript</csymbol><ci id="S3.SS3.p4.2.m2.4.4.5.2.cmml" xref="S3.SS3.p4.2.m2.4.4.5.2">𝐺</ci><ci id="S3.SS3.p4.2.m2.4.4.5.3.cmml" xref="S3.SS3.p4.2.m2.4.4.5.3">𝑡</ci></apply><vector id="S3.SS3.p4.2.m2.4.4.3.4.cmml" xref="S3.SS3.p4.2.m2.4.4.3.3"><apply id="S3.SS3.p4.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1">superscript</csymbol><apply id="S3.SS3.p4.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.2.2.1.1.1.2.1.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p4.2.m2.2.2.1.1.1.2.2.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.2.2">𝑔</ci><ci id="S3.SS3.p4.2.m2.2.2.1.1.1.2.3.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS3.p4.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS3.p4.2.m2.3.3.2.2.2.cmml" xref="S3.SS3.p4.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS3.p4.2.m2.3.3.2.2.2">superscript</csymbol><apply id="S3.SS3.p4.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS3.p4.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.3.3.2.2.2.2.1.cmml" xref="S3.SS3.p4.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.p4.2.m2.3.3.2.2.2.2.2.cmml" xref="S3.SS3.p4.2.m2.3.3.2.2.2.2.2">𝑔</ci><ci id="S3.SS3.p4.2.m2.3.3.2.2.2.2.3.cmml" xref="S3.SS3.p4.2.m2.3.3.2.2.2.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS3.p4.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS3.p4.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">…</ci><apply id="S3.SS3.p4.2.m2.4.4.3.3.3.cmml" xref="S3.SS3.p4.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS3.p4.2.m2.4.4.3.3.3">superscript</csymbol><apply id="S3.SS3.p4.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS3.p4.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.4.4.3.3.3.2.1.cmml" xref="S3.SS3.p4.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.SS3.p4.2.m2.4.4.3.3.3.2.2.cmml" xref="S3.SS3.p4.2.m2.4.4.3.3.3.2.2">𝑔</ci><ci id="S3.SS3.p4.2.m2.4.4.3.3.3.2.3.cmml" xref="S3.SS3.p4.2.m2.4.4.3.3.3.2.3">𝑡</ci></apply><ci id="S3.SS3.p4.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS3.p4.2.m2.4.4.3.3.3.3">𝐾</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.4c">G_{t}=(g_{t}^{1},g_{t}^{2},…,g_{t}^{K})</annotation></semantics></math> derived from gradient harmonization. For client <math id="S3.SS3.p4.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p4.3.m3.1a"><mi id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><ci id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">k</annotation></semantics></math>, <math id="S3.SS3.p4.4.m4.1" class="ltx_Math" alttext="w_{t}^{k}=w_{t}+\eta g_{t}^{k}" display="inline"><semantics id="S3.SS3.p4.4.m4.1a"><mrow id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml"><msubsup id="S3.SS3.p4.4.m4.1.1.2" xref="S3.SS3.p4.4.m4.1.1.2.cmml"><mi id="S3.SS3.p4.4.m4.1.1.2.2.2" xref="S3.SS3.p4.4.m4.1.1.2.2.2.cmml">w</mi><mi id="S3.SS3.p4.4.m4.1.1.2.2.3" xref="S3.SS3.p4.4.m4.1.1.2.2.3.cmml">t</mi><mi id="S3.SS3.p4.4.m4.1.1.2.3" xref="S3.SS3.p4.4.m4.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.SS3.p4.4.m4.1.1.1" xref="S3.SS3.p4.4.m4.1.1.1.cmml">=</mo><mrow id="S3.SS3.p4.4.m4.1.1.3" xref="S3.SS3.p4.4.m4.1.1.3.cmml"><msub id="S3.SS3.p4.4.m4.1.1.3.2" xref="S3.SS3.p4.4.m4.1.1.3.2.cmml"><mi id="S3.SS3.p4.4.m4.1.1.3.2.2" xref="S3.SS3.p4.4.m4.1.1.3.2.2.cmml">w</mi><mi id="S3.SS3.p4.4.m4.1.1.3.2.3" xref="S3.SS3.p4.4.m4.1.1.3.2.3.cmml">t</mi></msub><mo id="S3.SS3.p4.4.m4.1.1.3.1" xref="S3.SS3.p4.4.m4.1.1.3.1.cmml">+</mo><mrow id="S3.SS3.p4.4.m4.1.1.3.3" xref="S3.SS3.p4.4.m4.1.1.3.3.cmml"><mi id="S3.SS3.p4.4.m4.1.1.3.3.2" xref="S3.SS3.p4.4.m4.1.1.3.3.2.cmml">η</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m4.1.1.3.3.1" xref="S3.SS3.p4.4.m4.1.1.3.3.1.cmml">​</mo><msubsup id="S3.SS3.p4.4.m4.1.1.3.3.3" xref="S3.SS3.p4.4.m4.1.1.3.3.3.cmml"><mi id="S3.SS3.p4.4.m4.1.1.3.3.3.2.2" xref="S3.SS3.p4.4.m4.1.1.3.3.3.2.2.cmml">g</mi><mi id="S3.SS3.p4.4.m4.1.1.3.3.3.2.3" xref="S3.SS3.p4.4.m4.1.1.3.3.3.2.3.cmml">t</mi><mi id="S3.SS3.p4.4.m4.1.1.3.3.3.3" xref="S3.SS3.p4.4.m4.1.1.3.3.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><apply id="S3.SS3.p4.4.m4.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1"><eq id="S3.SS3.p4.4.m4.1.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1.1"></eq><apply id="S3.SS3.p4.4.m4.1.1.2.cmml" xref="S3.SS3.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.2.1.cmml" xref="S3.SS3.p4.4.m4.1.1.2">superscript</csymbol><apply id="S3.SS3.p4.4.m4.1.1.2.2.cmml" xref="S3.SS3.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.2.2.1.cmml" xref="S3.SS3.p4.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.2.2.2.cmml" xref="S3.SS3.p4.4.m4.1.1.2.2.2">𝑤</ci><ci id="S3.SS3.p4.4.m4.1.1.2.2.3.cmml" xref="S3.SS3.p4.4.m4.1.1.2.2.3">𝑡</ci></apply><ci id="S3.SS3.p4.4.m4.1.1.2.3.cmml" xref="S3.SS3.p4.4.m4.1.1.2.3">𝑘</ci></apply><apply id="S3.SS3.p4.4.m4.1.1.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3"><plus id="S3.SS3.p4.4.m4.1.1.3.1.cmml" xref="S3.SS3.p4.4.m4.1.1.3.1"></plus><apply id="S3.SS3.p4.4.m4.1.1.3.2.cmml" xref="S3.SS3.p4.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.3.2.1.cmml" xref="S3.SS3.p4.4.m4.1.1.3.2">subscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.3.2.2.cmml" xref="S3.SS3.p4.4.m4.1.1.3.2.2">𝑤</ci><ci id="S3.SS3.p4.4.m4.1.1.3.2.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3.2.3">𝑡</ci></apply><apply id="S3.SS3.p4.4.m4.1.1.3.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3"><times id="S3.SS3.p4.4.m4.1.1.3.3.1.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.1"></times><ci id="S3.SS3.p4.4.m4.1.1.3.3.2.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.2">𝜂</ci><apply id="S3.SS3.p4.4.m4.1.1.3.3.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.3.3.3.1.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.3">superscript</csymbol><apply id="S3.SS3.p4.4.m4.1.1.3.3.3.2.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.3.3.3.2.1.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.3.3.3.2.2.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.3.2.2">𝑔</ci><ci id="S3.SS3.p4.4.m4.1.1.3.3.3.2.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.3.2.3">𝑡</ci></apply><ci id="S3.SS3.p4.4.m4.1.1.3.3.3.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">w_{t}^{k}=w_{t}+\eta g_{t}^{k}</annotation></semantics></math>.
Subsequently, the server aggregates the updated local models to acquire the global model.
The complete FedGH procedure is detailed in Algorithm <a href="#algorithm1" title="In 3.3 Tackling the Non-IID Issue by Gradient Harmonization ‣ 3 Methodology ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S3.SS3.p5" class="ltx_para">
<p id="S3.SS3.p5.1" class="ltx_p">The effectiveness of FedGH is illustrated in Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.3 Tackling the Non-IID Issue by Gradient Harmonization ‣ 3 Methodology ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
In a scenario where the sum of two conflicting clients exhibits an optimization direction towards global minima,
FedGH yields a faster convergence rate by discarding conflicting components of the gradient vector.
Conversely, in cases where the optimization direction deviates from global minima,
FedGH mitigates local drifts and rectifies the global update by enhancing local consensus across all clients.
Moreover, compared with other notable methods <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib14" title="" class="ltx_ref">2020</a>; Qu et al., <a href="#bib.bib20" title="" class="ltx_ref">2022</a>; Li et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite>,
FedGH can be easily plugged into any FL framework without hyperparameter tuning or added communication costs.
In our extensive experiments, we integrate FedGH with baselines that address the non-IID issue from local training <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib14" title="" class="ltx_ref">2020</a>; Shi et al., <a href="#bib.bib24" title="" class="ltx_ref">2022</a>)</cite> and global aggregation <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib17" title="" class="ltx_ref">2017</a>; Wang et al., <a href="#bib.bib28" title="" class="ltx_ref">2020b</a>)</cite>.
Consistent performance boosting has been achieved on different benchmarks based on multiple baselines,
proving the significance of minimizing gradient conflicts in FL.</p>
</div>
<div id="S3.SS3.1" class="ltx_logical-block ltx_minipage ltx_align_middle" style="width:433.6pt;">
<figure id="algorithm1" class="ltx_float ltx_minipage ltx_align_middle" style="width:260.2pt;">
<div id="algorithm1.34" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.5.5" class="ltx_listingline">

<span id="algorithm1.5.5.1" class="ltx_text"><span id="algorithm1.5.5.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>number of clients <math id="algorithm1.1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="algorithm1.1.1.m1.1a"><mi id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.1b"><ci id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.1c">K</annotation></semantics></math>, number of communication rounds <math id="algorithm1.2.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="algorithm1.2.2.m2.1a"><mi id="algorithm1.2.2.m2.1.1" xref="algorithm1.2.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m2.1b"><ci id="algorithm1.2.2.m2.1.1.cmml" xref="algorithm1.2.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m2.1c">T</annotation></semantics></math>, learning rate <math id="algorithm1.3.3.m3.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="algorithm1.3.3.m3.1a"><mi id="algorithm1.3.3.m3.1.1" xref="algorithm1.3.3.m3.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m3.1b"><ci id="algorithm1.3.3.m3.1.1.cmml" xref="algorithm1.3.3.m3.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m3.1c">\eta</annotation></semantics></math>,
local minibatch size <math id="algorithm1.4.4.m4.1" class="ltx_Math" alttext="B" display="inline"><semantics id="algorithm1.4.4.m4.1a"><mi id="algorithm1.4.4.m4.1.1" xref="algorithm1.4.4.m4.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m4.1b"><ci id="algorithm1.4.4.m4.1.1.cmml" xref="algorithm1.4.4.m4.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m4.1c">B</annotation></semantics></math>, number of local epochs <math id="algorithm1.5.5.m5.1" class="ltx_Math" alttext="E" display="inline"><semantics id="algorithm1.5.5.m5.1a"><mi id="algorithm1.5.5.m5.1.1" xref="algorithm1.5.5.m5.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.m5.1b"><ci id="algorithm1.5.5.m5.1.1.cmml" xref="algorithm1.5.5.m5.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.m5.1c">E</annotation></semantics></math>
</div>
<div id="algorithm1.6.6" class="ltx_listingline">
<span id="algorithm1.6.6.1" class="ltx_text"><span id="algorithm1.6.6.1.1" class="ltx_text ltx_font_bold">Output:</span> </span>global model <math id="algorithm1.6.6.m1.1" class="ltx_Math" alttext="w_{T}" display="inline"><semantics id="algorithm1.6.6.m1.1a"><msub id="algorithm1.6.6.m1.1.1" xref="algorithm1.6.6.m1.1.1.cmml"><mi id="algorithm1.6.6.m1.1.1.2" xref="algorithm1.6.6.m1.1.1.2.cmml">w</mi><mi id="algorithm1.6.6.m1.1.1.3" xref="algorithm1.6.6.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.m1.1b"><apply id="algorithm1.6.6.m1.1.1.cmml" xref="algorithm1.6.6.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.6.6.m1.1.1.1.cmml" xref="algorithm1.6.6.m1.1.1">subscript</csymbol><ci id="algorithm1.6.6.m1.1.1.2.cmml" xref="algorithm1.6.6.m1.1.1.2">𝑤</ci><ci id="algorithm1.6.6.m1.1.1.3.cmml" xref="algorithm1.6.6.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.m1.1c">w_{T}</annotation></semantics></math>
</div>
<div id="algorithm1.34.35" class="ltx_listingline">

</div>
<div id="algorithm1.34.36" class="ltx_listingline">
<em id="algorithm1.34.36.1" class="ltx_emph ltx_font_bold ltx_font_italic">Server executes</em><span id="algorithm1.34.36.2" class="ltx_text ltx_font_bold">:</span>
</div>
<div id="algorithm1.7.7" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
initialize <math id="algorithm1.7.7.m1.1" class="ltx_Math" alttext="w_{0}" display="inline"><semantics id="algorithm1.7.7.m1.1a"><msub id="algorithm1.7.7.m1.1.1" xref="algorithm1.7.7.m1.1.1.cmml"><mi id="algorithm1.7.7.m1.1.1.2" xref="algorithm1.7.7.m1.1.1.2.cmml">w</mi><mn id="algorithm1.7.7.m1.1.1.3" xref="algorithm1.7.7.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.m1.1b"><apply id="algorithm1.7.7.m1.1.1.cmml" xref="algorithm1.7.7.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.7.7.m1.1.1.1.cmml" xref="algorithm1.7.7.m1.1.1">subscript</csymbol><ci id="algorithm1.7.7.m1.1.1.2.cmml" xref="algorithm1.7.7.m1.1.1.2">𝑤</ci><cn type="integer" id="algorithm1.7.7.m1.1.1.3.cmml" xref="algorithm1.7.7.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.m1.1c">w_{0}</annotation></semantics></math> 
</div>
<div id="algorithm1.8.8" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.8.8.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.8.8.1" class="ltx_emph ltx_font_italic">each round <math id="algorithm1.8.8.1.m1.3" class="ltx_Math" alttext="t=0,...,T-1" display="inline"><semantics id="algorithm1.8.8.1.m1.3a"><mrow id="algorithm1.8.8.1.m1.3.3" xref="algorithm1.8.8.1.m1.3.3.cmml"><mi id="algorithm1.8.8.1.m1.3.3.3" xref="algorithm1.8.8.1.m1.3.3.3.cmml">t</mi><mo id="algorithm1.8.8.1.m1.3.3.2" xref="algorithm1.8.8.1.m1.3.3.2.cmml">=</mo><mrow id="algorithm1.8.8.1.m1.3.3.1.1" xref="algorithm1.8.8.1.m1.3.3.1.2.cmml"><mn id="algorithm1.8.8.1.m1.1.1" xref="algorithm1.8.8.1.m1.1.1.cmml">0</mn><mo id="algorithm1.8.8.1.m1.3.3.1.1.2" xref="algorithm1.8.8.1.m1.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="algorithm1.8.8.1.m1.2.2" xref="algorithm1.8.8.1.m1.2.2.cmml">…</mi><mo id="algorithm1.8.8.1.m1.3.3.1.1.3" xref="algorithm1.8.8.1.m1.3.3.1.2.cmml">,</mo><mrow id="algorithm1.8.8.1.m1.3.3.1.1.1" xref="algorithm1.8.8.1.m1.3.3.1.1.1.cmml"><mi id="algorithm1.8.8.1.m1.3.3.1.1.1.2" xref="algorithm1.8.8.1.m1.3.3.1.1.1.2.cmml">T</mi><mo id="algorithm1.8.8.1.m1.3.3.1.1.1.1" xref="algorithm1.8.8.1.m1.3.3.1.1.1.1.cmml">−</mo><mn id="algorithm1.8.8.1.m1.3.3.1.1.1.3" xref="algorithm1.8.8.1.m1.3.3.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.1.m1.3b"><apply id="algorithm1.8.8.1.m1.3.3.cmml" xref="algorithm1.8.8.1.m1.3.3"><eq id="algorithm1.8.8.1.m1.3.3.2.cmml" xref="algorithm1.8.8.1.m1.3.3.2"></eq><ci id="algorithm1.8.8.1.m1.3.3.3.cmml" xref="algorithm1.8.8.1.m1.3.3.3">𝑡</ci><list id="algorithm1.8.8.1.m1.3.3.1.2.cmml" xref="algorithm1.8.8.1.m1.3.3.1.1"><cn type="integer" id="algorithm1.8.8.1.m1.1.1.cmml" xref="algorithm1.8.8.1.m1.1.1">0</cn><ci id="algorithm1.8.8.1.m1.2.2.cmml" xref="algorithm1.8.8.1.m1.2.2">…</ci><apply id="algorithm1.8.8.1.m1.3.3.1.1.1.cmml" xref="algorithm1.8.8.1.m1.3.3.1.1.1"><minus id="algorithm1.8.8.1.m1.3.3.1.1.1.1.cmml" xref="algorithm1.8.8.1.m1.3.3.1.1.1.1"></minus><ci id="algorithm1.8.8.1.m1.3.3.1.1.1.2.cmml" xref="algorithm1.8.8.1.m1.3.3.1.1.1.2">𝑇</ci><cn type="integer" id="algorithm1.8.8.1.m1.3.3.1.1.1.3.cmml" xref="algorithm1.8.8.1.m1.3.3.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.1.m1.3c">t=0,...,T-1</annotation></semantics></math></em> <span id="algorithm1.8.8.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="algorithm1.10.10" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.9.9.m1.1" class="ltx_Math" alttext="S_{t}\leftarrow" display="inline"><semantics id="algorithm1.9.9.m1.1a"><mrow id="algorithm1.9.9.m1.1.1" xref="algorithm1.9.9.m1.1.1.cmml"><msub id="algorithm1.9.9.m1.1.1.2" xref="algorithm1.9.9.m1.1.1.2.cmml"><mi id="algorithm1.9.9.m1.1.1.2.2" xref="algorithm1.9.9.m1.1.1.2.2.cmml">S</mi><mi id="algorithm1.9.9.m1.1.1.2.3" xref="algorithm1.9.9.m1.1.1.2.3.cmml">t</mi></msub><mo stretchy="false" id="algorithm1.9.9.m1.1.1.1" xref="algorithm1.9.9.m1.1.1.1.cmml">←</mo><mi id="algorithm1.9.9.m1.1.1.3" xref="algorithm1.9.9.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.m1.1b"><apply id="algorithm1.9.9.m1.1.1.cmml" xref="algorithm1.9.9.m1.1.1"><ci id="algorithm1.9.9.m1.1.1.1.cmml" xref="algorithm1.9.9.m1.1.1.1">←</ci><apply id="algorithm1.9.9.m1.1.1.2.cmml" xref="algorithm1.9.9.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.9.9.m1.1.1.2.1.cmml" xref="algorithm1.9.9.m1.1.1.2">subscript</csymbol><ci id="algorithm1.9.9.m1.1.1.2.2.cmml" xref="algorithm1.9.9.m1.1.1.2.2">𝑆</ci><ci id="algorithm1.9.9.m1.1.1.2.3.cmml" xref="algorithm1.9.9.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="algorithm1.9.9.m1.1.1.3.cmml" xref="algorithm1.9.9.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.m1.1c">S_{t}\leftarrow</annotation></semantics></math> (random set of <math id="algorithm1.10.10.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="algorithm1.10.10.m2.1a"><mi id="algorithm1.10.10.m2.1.1" xref="algorithm1.10.10.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.m2.1b"><ci id="algorithm1.10.10.m2.1.1.cmml" xref="algorithm1.10.10.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.m2.1c">K</annotation></semantics></math> clients) 
</div>
<div id="algorithm1.11.11" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.11.11.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.11.11.1" class="ltx_emph ltx_font_italic">client <math id="algorithm1.11.11.1.m1.1" class="ltx_Math" alttext="k\in S_{t}" display="inline"><semantics id="algorithm1.11.11.1.m1.1a"><mrow id="algorithm1.11.11.1.m1.1.1" xref="algorithm1.11.11.1.m1.1.1.cmml"><mi id="algorithm1.11.11.1.m1.1.1.2" xref="algorithm1.11.11.1.m1.1.1.2.cmml">k</mi><mo id="algorithm1.11.11.1.m1.1.1.1" xref="algorithm1.11.11.1.m1.1.1.1.cmml">∈</mo><msub id="algorithm1.11.11.1.m1.1.1.3" xref="algorithm1.11.11.1.m1.1.1.3.cmml"><mi id="algorithm1.11.11.1.m1.1.1.3.2" xref="algorithm1.11.11.1.m1.1.1.3.2.cmml">S</mi><mi id="algorithm1.11.11.1.m1.1.1.3.3" xref="algorithm1.11.11.1.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.1.m1.1b"><apply id="algorithm1.11.11.1.m1.1.1.cmml" xref="algorithm1.11.11.1.m1.1.1"><in id="algorithm1.11.11.1.m1.1.1.1.cmml" xref="algorithm1.11.11.1.m1.1.1.1"></in><ci id="algorithm1.11.11.1.m1.1.1.2.cmml" xref="algorithm1.11.11.1.m1.1.1.2">𝑘</ci><apply id="algorithm1.11.11.1.m1.1.1.3.cmml" xref="algorithm1.11.11.1.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.11.11.1.m1.1.1.3.1.cmml" xref="algorithm1.11.11.1.m1.1.1.3">subscript</csymbol><ci id="algorithm1.11.11.1.m1.1.1.3.2.cmml" xref="algorithm1.11.11.1.m1.1.1.3.2">𝑆</ci><ci id="algorithm1.11.11.1.m1.1.1.3.3.cmml" xref="algorithm1.11.11.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.1.m1.1c">k\in S_{t}</annotation></semantics></math> in parallel</em> <span id="algorithm1.11.11.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="algorithm1.14.14" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.12.12.m1.1" class="ltx_Math" alttext="w_{t+1}^{k}\leftarrow" display="inline"><semantics id="algorithm1.12.12.m1.1a"><mrow id="algorithm1.12.12.m1.1.1" xref="algorithm1.12.12.m1.1.1.cmml"><msubsup id="algorithm1.12.12.m1.1.1.2" xref="algorithm1.12.12.m1.1.1.2.cmml"><mi id="algorithm1.12.12.m1.1.1.2.2.2" xref="algorithm1.12.12.m1.1.1.2.2.2.cmml">w</mi><mrow id="algorithm1.12.12.m1.1.1.2.2.3" xref="algorithm1.12.12.m1.1.1.2.2.3.cmml"><mi id="algorithm1.12.12.m1.1.1.2.2.3.2" xref="algorithm1.12.12.m1.1.1.2.2.3.2.cmml">t</mi><mo id="algorithm1.12.12.m1.1.1.2.2.3.1" xref="algorithm1.12.12.m1.1.1.2.2.3.1.cmml">+</mo><mn id="algorithm1.12.12.m1.1.1.2.2.3.3" xref="algorithm1.12.12.m1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="algorithm1.12.12.m1.1.1.2.3" xref="algorithm1.12.12.m1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="algorithm1.12.12.m1.1.1.1" xref="algorithm1.12.12.m1.1.1.1.cmml">←</mo><mi id="algorithm1.12.12.m1.1.1.3" xref="algorithm1.12.12.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.m1.1b"><apply id="algorithm1.12.12.m1.1.1.cmml" xref="algorithm1.12.12.m1.1.1"><ci id="algorithm1.12.12.m1.1.1.1.cmml" xref="algorithm1.12.12.m1.1.1.1">←</ci><apply id="algorithm1.12.12.m1.1.1.2.cmml" xref="algorithm1.12.12.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.1.1.2.1.cmml" xref="algorithm1.12.12.m1.1.1.2">superscript</csymbol><apply id="algorithm1.12.12.m1.1.1.2.2.cmml" xref="algorithm1.12.12.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.1.1.2.2.1.cmml" xref="algorithm1.12.12.m1.1.1.2">subscript</csymbol><ci id="algorithm1.12.12.m1.1.1.2.2.2.cmml" xref="algorithm1.12.12.m1.1.1.2.2.2">𝑤</ci><apply id="algorithm1.12.12.m1.1.1.2.2.3.cmml" xref="algorithm1.12.12.m1.1.1.2.2.3"><plus id="algorithm1.12.12.m1.1.1.2.2.3.1.cmml" xref="algorithm1.12.12.m1.1.1.2.2.3.1"></plus><ci id="algorithm1.12.12.m1.1.1.2.2.3.2.cmml" xref="algorithm1.12.12.m1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.12.12.m1.1.1.2.2.3.3.cmml" xref="algorithm1.12.12.m1.1.1.2.2.3.3">1</cn></apply></apply><ci id="algorithm1.12.12.m1.1.1.2.3.cmml" xref="algorithm1.12.12.m1.1.1.2.3">𝑘</ci></apply><csymbol cd="latexml" id="algorithm1.12.12.m1.1.1.3.cmml" xref="algorithm1.12.12.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.m1.1c">w_{t+1}^{k}\leftarrow</annotation></semantics></math> ClientUpdate(<math id="algorithm1.13.13.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algorithm1.13.13.m2.1a"><mi id="algorithm1.13.13.m2.1.1" xref="algorithm1.13.13.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m2.1b"><ci id="algorithm1.13.13.m2.1.1.cmml" xref="algorithm1.13.13.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m2.1c">k</annotation></semantics></math>, <math id="algorithm1.14.14.m3.1" class="ltx_Math" alttext="w_{t}" display="inline"><semantics id="algorithm1.14.14.m3.1a"><msub id="algorithm1.14.14.m3.1.1" xref="algorithm1.14.14.m3.1.1.cmml"><mi id="algorithm1.14.14.m3.1.1.2" xref="algorithm1.14.14.m3.1.1.2.cmml">w</mi><mi id="algorithm1.14.14.m3.1.1.3" xref="algorithm1.14.14.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.m3.1b"><apply id="algorithm1.14.14.m3.1.1.cmml" xref="algorithm1.14.14.m3.1.1"><csymbol cd="ambiguous" id="algorithm1.14.14.m3.1.1.1.cmml" xref="algorithm1.14.14.m3.1.1">subscript</csymbol><ci id="algorithm1.14.14.m3.1.1.2.cmml" xref="algorithm1.14.14.m3.1.1.2">𝑤</ci><ci id="algorithm1.14.14.m3.1.1.3.cmml" xref="algorithm1.14.14.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.m3.1c">w_{t}</annotation></semantics></math>) 
</div>
<div id="algorithm1.16.16" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.15.15.m1.1" class="ltx_Math" alttext="g_{t+1}^{k}\leftarrow" display="inline"><semantics id="algorithm1.15.15.m1.1a"><mrow id="algorithm1.15.15.m1.1.1" xref="algorithm1.15.15.m1.1.1.cmml"><msubsup id="algorithm1.15.15.m1.1.1.2" xref="algorithm1.15.15.m1.1.1.2.cmml"><mi mathcolor="#BF0040" id="algorithm1.15.15.m1.1.1.2.2.2" xref="algorithm1.15.15.m1.1.1.2.2.2.cmml">g</mi><mrow id="algorithm1.15.15.m1.1.1.2.2.3" xref="algorithm1.15.15.m1.1.1.2.2.3.cmml"><mi mathcolor="#BF0040" id="algorithm1.15.15.m1.1.1.2.2.3.2" xref="algorithm1.15.15.m1.1.1.2.2.3.2.cmml">t</mi><mo mathcolor="#BF0040" id="algorithm1.15.15.m1.1.1.2.2.3.1" xref="algorithm1.15.15.m1.1.1.2.2.3.1.cmml">+</mo><mn mathcolor="#BF0040" id="algorithm1.15.15.m1.1.1.2.2.3.3" xref="algorithm1.15.15.m1.1.1.2.2.3.3.cmml">1</mn></mrow><mi mathcolor="#BF0040" id="algorithm1.15.15.m1.1.1.2.3" xref="algorithm1.15.15.m1.1.1.2.3.cmml">k</mi></msubsup><mo mathcolor="#BF0040" stretchy="false" id="algorithm1.15.15.m1.1.1.1" xref="algorithm1.15.15.m1.1.1.1.cmml">←</mo><mi id="algorithm1.15.15.m1.1.1.3" xref="algorithm1.15.15.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.15.15.m1.1b"><apply id="algorithm1.15.15.m1.1.1.cmml" xref="algorithm1.15.15.m1.1.1"><ci id="algorithm1.15.15.m1.1.1.1.cmml" xref="algorithm1.15.15.m1.1.1.1">←</ci><apply id="algorithm1.15.15.m1.1.1.2.cmml" xref="algorithm1.15.15.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.1.1.2.1.cmml" xref="algorithm1.15.15.m1.1.1.2">superscript</csymbol><apply id="algorithm1.15.15.m1.1.1.2.2.cmml" xref="algorithm1.15.15.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.1.1.2.2.1.cmml" xref="algorithm1.15.15.m1.1.1.2">subscript</csymbol><ci id="algorithm1.15.15.m1.1.1.2.2.2.cmml" xref="algorithm1.15.15.m1.1.1.2.2.2">𝑔</ci><apply id="algorithm1.15.15.m1.1.1.2.2.3.cmml" xref="algorithm1.15.15.m1.1.1.2.2.3"><plus id="algorithm1.15.15.m1.1.1.2.2.3.1.cmml" xref="algorithm1.15.15.m1.1.1.2.2.3.1"></plus><ci id="algorithm1.15.15.m1.1.1.2.2.3.2.cmml" xref="algorithm1.15.15.m1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.15.15.m1.1.1.2.2.3.3.cmml" xref="algorithm1.15.15.m1.1.1.2.2.3.3">1</cn></apply></apply><ci id="algorithm1.15.15.m1.1.1.2.3.cmml" xref="algorithm1.15.15.m1.1.1.2.3">𝑘</ci></apply><csymbol cd="latexml" id="algorithm1.15.15.m1.1.1.3.cmml" xref="algorithm1.15.15.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.15.m1.1c">g_{t+1}^{k}\leftarrow</annotation></semantics></math><span id="algorithm1.16.16.1" class="ltx_text" style="color:#BF0040;"> <math id="algorithm1.16.16.1.m1.1" class="ltx_Math" alttext="\frac{1}{\eta}(w_{t+1}^{k}-w_{t})" display="inline"><semantics id="algorithm1.16.16.1.m1.1a"><mrow id="algorithm1.16.16.1.m1.1.1" xref="algorithm1.16.16.1.m1.1.1.cmml"><mfrac mathcolor="#BF0040" id="algorithm1.16.16.1.m1.1.1.3" xref="algorithm1.16.16.1.m1.1.1.3.cmml"><mn mathcolor="#BF0040" id="algorithm1.16.16.1.m1.1.1.3.2" xref="algorithm1.16.16.1.m1.1.1.3.2.cmml">1</mn><mi mathcolor="#BF0040" id="algorithm1.16.16.1.m1.1.1.3.3" xref="algorithm1.16.16.1.m1.1.1.3.3.cmml">η</mi></mfrac><mo lspace="0em" rspace="0em" id="algorithm1.16.16.1.m1.1.1.2" xref="algorithm1.16.16.1.m1.1.1.2.cmml">​</mo><mrow id="algorithm1.16.16.1.m1.1.1.1.1" xref="algorithm1.16.16.1.m1.1.1.1.1.1.cmml"><mo mathcolor="#BF0040" stretchy="false" id="algorithm1.16.16.1.m1.1.1.1.1.2" xref="algorithm1.16.16.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.16.16.1.m1.1.1.1.1.1" xref="algorithm1.16.16.1.m1.1.1.1.1.1.cmml"><msubsup id="algorithm1.16.16.1.m1.1.1.1.1.1.2" xref="algorithm1.16.16.1.m1.1.1.1.1.1.2.cmml"><mi mathcolor="#BF0040" id="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.2" xref="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.2.cmml">w</mi><mrow id="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.3" xref="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.3.cmml"><mi mathcolor="#BF0040" id="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.3.2" xref="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo mathcolor="#BF0040" id="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.3.1" xref="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.3.1.cmml">+</mo><mn mathcolor="#BF0040" id="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.3.3" xref="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi mathcolor="#BF0040" id="algorithm1.16.16.1.m1.1.1.1.1.1.2.3" xref="algorithm1.16.16.1.m1.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo mathcolor="#BF0040" id="algorithm1.16.16.1.m1.1.1.1.1.1.1" xref="algorithm1.16.16.1.m1.1.1.1.1.1.1.cmml">−</mo><msub id="algorithm1.16.16.1.m1.1.1.1.1.1.3" xref="algorithm1.16.16.1.m1.1.1.1.1.1.3.cmml"><mi mathcolor="#BF0040" id="algorithm1.16.16.1.m1.1.1.1.1.1.3.2" xref="algorithm1.16.16.1.m1.1.1.1.1.1.3.2.cmml">w</mi><mi mathcolor="#BF0040" id="algorithm1.16.16.1.m1.1.1.1.1.1.3.3" xref="algorithm1.16.16.1.m1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo mathcolor="#BF0040" stretchy="false" id="algorithm1.16.16.1.m1.1.1.1.1.3" xref="algorithm1.16.16.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.16.16.1.m1.1b"><apply id="algorithm1.16.16.1.m1.1.1.cmml" xref="algorithm1.16.16.1.m1.1.1"><times id="algorithm1.16.16.1.m1.1.1.2.cmml" xref="algorithm1.16.16.1.m1.1.1.2"></times><apply id="algorithm1.16.16.1.m1.1.1.3.cmml" xref="algorithm1.16.16.1.m1.1.1.3"><divide id="algorithm1.16.16.1.m1.1.1.3.1.cmml" xref="algorithm1.16.16.1.m1.1.1.3"></divide><cn type="integer" id="algorithm1.16.16.1.m1.1.1.3.2.cmml" xref="algorithm1.16.16.1.m1.1.1.3.2">1</cn><ci id="algorithm1.16.16.1.m1.1.1.3.3.cmml" xref="algorithm1.16.16.1.m1.1.1.3.3">𝜂</ci></apply><apply id="algorithm1.16.16.1.m1.1.1.1.1.1.cmml" xref="algorithm1.16.16.1.m1.1.1.1.1"><minus id="algorithm1.16.16.1.m1.1.1.1.1.1.1.cmml" xref="algorithm1.16.16.1.m1.1.1.1.1.1.1"></minus><apply id="algorithm1.16.16.1.m1.1.1.1.1.1.2.cmml" xref="algorithm1.16.16.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.16.16.1.m1.1.1.1.1.1.2.1.cmml" xref="algorithm1.16.16.1.m1.1.1.1.1.1.2">superscript</csymbol><apply id="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.cmml" xref="algorithm1.16.16.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.1.cmml" xref="algorithm1.16.16.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.2.cmml" xref="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.2">𝑤</ci><apply id="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.3.cmml" xref="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.3"><plus id="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.3.1.cmml" xref="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.3.1"></plus><ci id="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.3.2.cmml" xref="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.3.3.cmml" xref="algorithm1.16.16.1.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="algorithm1.16.16.1.m1.1.1.1.1.1.2.3.cmml" xref="algorithm1.16.16.1.m1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="algorithm1.16.16.1.m1.1.1.1.1.1.3.cmml" xref="algorithm1.16.16.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.16.16.1.m1.1.1.1.1.1.3.1.cmml" xref="algorithm1.16.16.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="algorithm1.16.16.1.m1.1.1.1.1.1.3.2.cmml" xref="algorithm1.16.16.1.m1.1.1.1.1.1.3.2">𝑤</ci><ci id="algorithm1.16.16.1.m1.1.1.1.1.1.3.3.cmml" xref="algorithm1.16.16.1.m1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.16.1.m1.1c">\frac{1}{\eta}(w_{t+1}^{k}-w_{t})</annotation></semantics></math></span>

</div>
<div id="algorithm1.17.17" class="ltx_listingline">
<span id="algorithm1.17.17.2" class="ltx_text" style="color:#BF0040;">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   </span><span id="algorithm1.17.17.1" class="ltx_text" style="color:#BF0040;">
<math id="algorithm1.17.17.1.m1.1" class="ltx_Math" alttext="\widetilde{G}_{t+1}\leftarrow G_{t+1}" display="inline"><semantics id="algorithm1.17.17.1.m1.1a"><mrow id="algorithm1.17.17.1.m1.1.1" xref="algorithm1.17.17.1.m1.1.1.cmml"><msub id="algorithm1.17.17.1.m1.1.1.2" xref="algorithm1.17.17.1.m1.1.1.2.cmml"><mover accent="true" id="algorithm1.17.17.1.m1.1.1.2.2" xref="algorithm1.17.17.1.m1.1.1.2.2.cmml"><mi mathcolor="#BF0040" id="algorithm1.17.17.1.m1.1.1.2.2.2" xref="algorithm1.17.17.1.m1.1.1.2.2.2.cmml">G</mi><mo mathcolor="#BF0040" id="algorithm1.17.17.1.m1.1.1.2.2.1" xref="algorithm1.17.17.1.m1.1.1.2.2.1.cmml">~</mo></mover><mrow id="algorithm1.17.17.1.m1.1.1.2.3" xref="algorithm1.17.17.1.m1.1.1.2.3.cmml"><mi mathcolor="#BF0040" id="algorithm1.17.17.1.m1.1.1.2.3.2" xref="algorithm1.17.17.1.m1.1.1.2.3.2.cmml">t</mi><mo mathcolor="#BF0040" id="algorithm1.17.17.1.m1.1.1.2.3.1" xref="algorithm1.17.17.1.m1.1.1.2.3.1.cmml">+</mo><mn mathcolor="#BF0040" id="algorithm1.17.17.1.m1.1.1.2.3.3" xref="algorithm1.17.17.1.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo mathcolor="#BF0040" stretchy="false" id="algorithm1.17.17.1.m1.1.1.1" xref="algorithm1.17.17.1.m1.1.1.1.cmml">←</mo><msub id="algorithm1.17.17.1.m1.1.1.3" xref="algorithm1.17.17.1.m1.1.1.3.cmml"><mi mathcolor="#BF0040" id="algorithm1.17.17.1.m1.1.1.3.2" xref="algorithm1.17.17.1.m1.1.1.3.2.cmml">G</mi><mrow id="algorithm1.17.17.1.m1.1.1.3.3" xref="algorithm1.17.17.1.m1.1.1.3.3.cmml"><mi mathcolor="#BF0040" id="algorithm1.17.17.1.m1.1.1.3.3.2" xref="algorithm1.17.17.1.m1.1.1.3.3.2.cmml">t</mi><mo mathcolor="#BF0040" id="algorithm1.17.17.1.m1.1.1.3.3.1" xref="algorithm1.17.17.1.m1.1.1.3.3.1.cmml">+</mo><mn mathcolor="#BF0040" id="algorithm1.17.17.1.m1.1.1.3.3.3" xref="algorithm1.17.17.1.m1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.17.17.1.m1.1b"><apply id="algorithm1.17.17.1.m1.1.1.cmml" xref="algorithm1.17.17.1.m1.1.1"><ci id="algorithm1.17.17.1.m1.1.1.1.cmml" xref="algorithm1.17.17.1.m1.1.1.1">←</ci><apply id="algorithm1.17.17.1.m1.1.1.2.cmml" xref="algorithm1.17.17.1.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.17.17.1.m1.1.1.2.1.cmml" xref="algorithm1.17.17.1.m1.1.1.2">subscript</csymbol><apply id="algorithm1.17.17.1.m1.1.1.2.2.cmml" xref="algorithm1.17.17.1.m1.1.1.2.2"><ci id="algorithm1.17.17.1.m1.1.1.2.2.1.cmml" xref="algorithm1.17.17.1.m1.1.1.2.2.1">~</ci><ci id="algorithm1.17.17.1.m1.1.1.2.2.2.cmml" xref="algorithm1.17.17.1.m1.1.1.2.2.2">𝐺</ci></apply><apply id="algorithm1.17.17.1.m1.1.1.2.3.cmml" xref="algorithm1.17.17.1.m1.1.1.2.3"><plus id="algorithm1.17.17.1.m1.1.1.2.3.1.cmml" xref="algorithm1.17.17.1.m1.1.1.2.3.1"></plus><ci id="algorithm1.17.17.1.m1.1.1.2.3.2.cmml" xref="algorithm1.17.17.1.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.17.17.1.m1.1.1.2.3.3.cmml" xref="algorithm1.17.17.1.m1.1.1.2.3.3">1</cn></apply></apply><apply id="algorithm1.17.17.1.m1.1.1.3.cmml" xref="algorithm1.17.17.1.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.17.17.1.m1.1.1.3.1.cmml" xref="algorithm1.17.17.1.m1.1.1.3">subscript</csymbol><ci id="algorithm1.17.17.1.m1.1.1.3.2.cmml" xref="algorithm1.17.17.1.m1.1.1.3.2">𝐺</ci><apply id="algorithm1.17.17.1.m1.1.1.3.3.cmml" xref="algorithm1.17.17.1.m1.1.1.3.3"><plus id="algorithm1.17.17.1.m1.1.1.3.3.1.cmml" xref="algorithm1.17.17.1.m1.1.1.3.3.1"></plus><ci id="algorithm1.17.17.1.m1.1.1.3.3.2.cmml" xref="algorithm1.17.17.1.m1.1.1.3.3.2">𝑡</ci><cn type="integer" id="algorithm1.17.17.1.m1.1.1.3.3.3.cmml" xref="algorithm1.17.17.1.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.17.1.m1.1c">\widetilde{G}_{t+1}\leftarrow G_{t+1}</annotation></semantics></math> </span>
</div>
<div id="algorithm1.18.18" class="ltx_listingline">
<span id="algorithm1.18.18.2" class="ltx_text" style="color:#BF0040;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.18.18.3" class="ltx_text" style="color:#BF0040;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.18.18.4" class="ltx_text" style="color:#BF0040;">   </span><span id="algorithm1.18.18.5" class="ltx_text" style="color:#BF0040;">
</span><span id="algorithm1.18.18.6" class="ltx_text ltx_font_bold" style="color:#BF0040;">for</span><span id="algorithm1.18.18.7" class="ltx_text" style="color:#BF0040;"> </span><em id="algorithm1.18.18.1" class="ltx_emph ltx_font_italic" style="color:#BF0040;"><math id="algorithm1.18.18.1.m1.1" class="ltx_Math" alttext="k\in S_{t}" display="inline"><semantics id="algorithm1.18.18.1.m1.1a"><mrow id="algorithm1.18.18.1.m1.1.1" xref="algorithm1.18.18.1.m1.1.1.cmml"><mi mathcolor="#BF0040" id="algorithm1.18.18.1.m1.1.1.2" xref="algorithm1.18.18.1.m1.1.1.2.cmml">k</mi><mo mathcolor="#BF0040" id="algorithm1.18.18.1.m1.1.1.1" xref="algorithm1.18.18.1.m1.1.1.1.cmml">∈</mo><msub id="algorithm1.18.18.1.m1.1.1.3" xref="algorithm1.18.18.1.m1.1.1.3.cmml"><mi mathcolor="#BF0040" id="algorithm1.18.18.1.m1.1.1.3.2" xref="algorithm1.18.18.1.m1.1.1.3.2.cmml">S</mi><mi mathcolor="#BF0040" id="algorithm1.18.18.1.m1.1.1.3.3" xref="algorithm1.18.18.1.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.18.18.1.m1.1b"><apply id="algorithm1.18.18.1.m1.1.1.cmml" xref="algorithm1.18.18.1.m1.1.1"><in id="algorithm1.18.18.1.m1.1.1.1.cmml" xref="algorithm1.18.18.1.m1.1.1.1"></in><ci id="algorithm1.18.18.1.m1.1.1.2.cmml" xref="algorithm1.18.18.1.m1.1.1.2">𝑘</ci><apply id="algorithm1.18.18.1.m1.1.1.3.cmml" xref="algorithm1.18.18.1.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.18.18.1.m1.1.1.3.1.cmml" xref="algorithm1.18.18.1.m1.1.1.3">subscript</csymbol><ci id="algorithm1.18.18.1.m1.1.1.3.2.cmml" xref="algorithm1.18.18.1.m1.1.1.3.2">𝑆</ci><ci id="algorithm1.18.18.1.m1.1.1.3.3.cmml" xref="algorithm1.18.18.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.18.18.1.m1.1c">k\in S_{t}</annotation></semantics></math></em><span id="algorithm1.18.18.8" class="ltx_text" style="color:#BF0040;"> </span><span id="algorithm1.18.18.9" class="ltx_text ltx_font_bold" style="color:#BF0040;">do</span>
</div>
<div id="algorithm1.19.19" class="ltx_listingline">
<span id="algorithm1.19.19.2" class="ltx_text" style="color:#BF0040;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.19.19.3" class="ltx_text" style="color:#BF0040;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.19.19.4" class="ltx_text" style="color:#BF0040;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.19.19.5" class="ltx_text" style="color:#BF0040;">   </span><span id="algorithm1.19.19.6" class="ltx_text" style="color:#BF0040;">
</span><span id="algorithm1.19.19.7" class="ltx_text ltx_font_bold" style="color:#BF0040;">for</span><span id="algorithm1.19.19.8" class="ltx_text" style="color:#BF0040;"> </span><em id="algorithm1.19.19.1" class="ltx_emph ltx_font_italic" style="color:#BF0040;"><math id="algorithm1.19.19.1.m1.1" class="ltx_Math" alttext="j\in S_{t}\backslash k" display="inline"><semantics id="algorithm1.19.19.1.m1.1a"><mrow id="algorithm1.19.19.1.m1.1.1" xref="algorithm1.19.19.1.m1.1.1.cmml"><mi mathcolor="#BF0040" id="algorithm1.19.19.1.m1.1.1.2" xref="algorithm1.19.19.1.m1.1.1.2.cmml">j</mi><mo mathcolor="#BF0040" id="algorithm1.19.19.1.m1.1.1.1" xref="algorithm1.19.19.1.m1.1.1.1.cmml">∈</mo><mrow id="algorithm1.19.19.1.m1.1.1.3" xref="algorithm1.19.19.1.m1.1.1.3.cmml"><msub id="algorithm1.19.19.1.m1.1.1.3.2" xref="algorithm1.19.19.1.m1.1.1.3.2.cmml"><mi mathcolor="#BF0040" id="algorithm1.19.19.1.m1.1.1.3.2.2" xref="algorithm1.19.19.1.m1.1.1.3.2.2.cmml">S</mi><mi mathcolor="#BF0040" id="algorithm1.19.19.1.m1.1.1.3.2.3" xref="algorithm1.19.19.1.m1.1.1.3.2.3.cmml">t</mi></msub><mo lspace="0.222em" mathcolor="#BF0040" rspace="0.222em" id="algorithm1.19.19.1.m1.1.1.3.1" xref="algorithm1.19.19.1.m1.1.1.3.1.cmml">\</mo><mi mathcolor="#BF0040" id="algorithm1.19.19.1.m1.1.1.3.3" xref="algorithm1.19.19.1.m1.1.1.3.3.cmml">k</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.19.19.1.m1.1b"><apply id="algorithm1.19.19.1.m1.1.1.cmml" xref="algorithm1.19.19.1.m1.1.1"><in id="algorithm1.19.19.1.m1.1.1.1.cmml" xref="algorithm1.19.19.1.m1.1.1.1"></in><ci id="algorithm1.19.19.1.m1.1.1.2.cmml" xref="algorithm1.19.19.1.m1.1.1.2">𝑗</ci><apply id="algorithm1.19.19.1.m1.1.1.3.cmml" xref="algorithm1.19.19.1.m1.1.1.3"><ci id="algorithm1.19.19.1.m1.1.1.3.1.cmml" xref="algorithm1.19.19.1.m1.1.1.3.1">\</ci><apply id="algorithm1.19.19.1.m1.1.1.3.2.cmml" xref="algorithm1.19.19.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.19.19.1.m1.1.1.3.2.1.cmml" xref="algorithm1.19.19.1.m1.1.1.3.2">subscript</csymbol><ci id="algorithm1.19.19.1.m1.1.1.3.2.2.cmml" xref="algorithm1.19.19.1.m1.1.1.3.2.2">𝑆</ci><ci id="algorithm1.19.19.1.m1.1.1.3.2.3.cmml" xref="algorithm1.19.19.1.m1.1.1.3.2.3">𝑡</ci></apply><ci id="algorithm1.19.19.1.m1.1.1.3.3.cmml" xref="algorithm1.19.19.1.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.19.19.1.m1.1c">j\in S_{t}\backslash k</annotation></semantics></math> in random order do</em><span id="algorithm1.19.19.9" class="ltx_text" style="color:#BF0040;"> </span><span id="algorithm1.19.19.10" class="ltx_text ltx_font_bold" style="color:#BF0040;">do</span>
</div>
<div id="algorithm1.20.20" class="ltx_listingline">
<span id="algorithm1.20.20.2" class="ltx_text" style="color:#BF0040;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.20.20.3" class="ltx_text" style="color:#BF0040;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.20.20.4" class="ltx_text" style="color:#BF0040;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.20.20.5" class="ltx_text" style="color:#BF0040;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.20.20.6" class="ltx_text" style="color:#BF0040;">   </span><span id="algorithm1.20.20.7" class="ltx_text" style="color:#BF0040;">
</span><span id="algorithm1.20.20.8" class="ltx_text ltx_font_bold" style="color:#BF0040;">if</span><span id="algorithm1.20.20.9" class="ltx_text" style="color:#BF0040;"> </span><em id="algorithm1.20.20.1" class="ltx_emph ltx_font_italic" style="color:#BF0040;"><math id="algorithm1.20.20.1.m1.1" class="ltx_Math" alttext="g_{t+1}^{k}\cdot\widetilde{g}_{t+1}^{j}&lt;0" display="inline"><semantics id="algorithm1.20.20.1.m1.1a"><mrow id="algorithm1.20.20.1.m1.1.1" xref="algorithm1.20.20.1.m1.1.1.cmml"><mrow id="algorithm1.20.20.1.m1.1.1.2" xref="algorithm1.20.20.1.m1.1.1.2.cmml"><msubsup id="algorithm1.20.20.1.m1.1.1.2.2" xref="algorithm1.20.20.1.m1.1.1.2.2.cmml"><mi mathcolor="#BF0040" id="algorithm1.20.20.1.m1.1.1.2.2.2.2" xref="algorithm1.20.20.1.m1.1.1.2.2.2.2.cmml">g</mi><mrow id="algorithm1.20.20.1.m1.1.1.2.2.2.3" xref="algorithm1.20.20.1.m1.1.1.2.2.2.3.cmml"><mi mathcolor="#BF0040" id="algorithm1.20.20.1.m1.1.1.2.2.2.3.2" xref="algorithm1.20.20.1.m1.1.1.2.2.2.3.2.cmml">t</mi><mo mathcolor="#BF0040" id="algorithm1.20.20.1.m1.1.1.2.2.2.3.1" xref="algorithm1.20.20.1.m1.1.1.2.2.2.3.1.cmml">+</mo><mn mathcolor="#BF0040" id="algorithm1.20.20.1.m1.1.1.2.2.2.3.3" xref="algorithm1.20.20.1.m1.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi mathcolor="#BF0040" id="algorithm1.20.20.1.m1.1.1.2.2.3" xref="algorithm1.20.20.1.m1.1.1.2.2.3.cmml">k</mi></msubsup><mo lspace="0.222em" mathcolor="#BF0040" rspace="0.222em" id="algorithm1.20.20.1.m1.1.1.2.1" xref="algorithm1.20.20.1.m1.1.1.2.1.cmml">⋅</mo><msubsup id="algorithm1.20.20.1.m1.1.1.2.3" xref="algorithm1.20.20.1.m1.1.1.2.3.cmml"><mover accent="true" id="algorithm1.20.20.1.m1.1.1.2.3.2.2" xref="algorithm1.20.20.1.m1.1.1.2.3.2.2.cmml"><mi mathcolor="#BF0040" id="algorithm1.20.20.1.m1.1.1.2.3.2.2.2" xref="algorithm1.20.20.1.m1.1.1.2.3.2.2.2.cmml">g</mi><mo mathcolor="#BF0040" id="algorithm1.20.20.1.m1.1.1.2.3.2.2.1" xref="algorithm1.20.20.1.m1.1.1.2.3.2.2.1.cmml">~</mo></mover><mrow id="algorithm1.20.20.1.m1.1.1.2.3.2.3" xref="algorithm1.20.20.1.m1.1.1.2.3.2.3.cmml"><mi mathcolor="#BF0040" id="algorithm1.20.20.1.m1.1.1.2.3.2.3.2" xref="algorithm1.20.20.1.m1.1.1.2.3.2.3.2.cmml">t</mi><mo mathcolor="#BF0040" id="algorithm1.20.20.1.m1.1.1.2.3.2.3.1" xref="algorithm1.20.20.1.m1.1.1.2.3.2.3.1.cmml">+</mo><mn mathcolor="#BF0040" id="algorithm1.20.20.1.m1.1.1.2.3.2.3.3" xref="algorithm1.20.20.1.m1.1.1.2.3.2.3.3.cmml">1</mn></mrow><mi mathcolor="#BF0040" id="algorithm1.20.20.1.m1.1.1.2.3.3" xref="algorithm1.20.20.1.m1.1.1.2.3.3.cmml">j</mi></msubsup></mrow><mo mathcolor="#BF0040" id="algorithm1.20.20.1.m1.1.1.1" xref="algorithm1.20.20.1.m1.1.1.1.cmml">&lt;</mo><mn mathcolor="#BF0040" id="algorithm1.20.20.1.m1.1.1.3" xref="algorithm1.20.20.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.20.20.1.m1.1b"><apply id="algorithm1.20.20.1.m1.1.1.cmml" xref="algorithm1.20.20.1.m1.1.1"><lt id="algorithm1.20.20.1.m1.1.1.1.cmml" xref="algorithm1.20.20.1.m1.1.1.1"></lt><apply id="algorithm1.20.20.1.m1.1.1.2.cmml" xref="algorithm1.20.20.1.m1.1.1.2"><ci id="algorithm1.20.20.1.m1.1.1.2.1.cmml" xref="algorithm1.20.20.1.m1.1.1.2.1">⋅</ci><apply id="algorithm1.20.20.1.m1.1.1.2.2.cmml" xref="algorithm1.20.20.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="algorithm1.20.20.1.m1.1.1.2.2.1.cmml" xref="algorithm1.20.20.1.m1.1.1.2.2">superscript</csymbol><apply id="algorithm1.20.20.1.m1.1.1.2.2.2.cmml" xref="algorithm1.20.20.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="algorithm1.20.20.1.m1.1.1.2.2.2.1.cmml" xref="algorithm1.20.20.1.m1.1.1.2.2">subscript</csymbol><ci id="algorithm1.20.20.1.m1.1.1.2.2.2.2.cmml" xref="algorithm1.20.20.1.m1.1.1.2.2.2.2">𝑔</ci><apply id="algorithm1.20.20.1.m1.1.1.2.2.2.3.cmml" xref="algorithm1.20.20.1.m1.1.1.2.2.2.3"><plus id="algorithm1.20.20.1.m1.1.1.2.2.2.3.1.cmml" xref="algorithm1.20.20.1.m1.1.1.2.2.2.3.1"></plus><ci id="algorithm1.20.20.1.m1.1.1.2.2.2.3.2.cmml" xref="algorithm1.20.20.1.m1.1.1.2.2.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.20.20.1.m1.1.1.2.2.2.3.3.cmml" xref="algorithm1.20.20.1.m1.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="algorithm1.20.20.1.m1.1.1.2.2.3.cmml" xref="algorithm1.20.20.1.m1.1.1.2.2.3">𝑘</ci></apply><apply id="algorithm1.20.20.1.m1.1.1.2.3.cmml" xref="algorithm1.20.20.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="algorithm1.20.20.1.m1.1.1.2.3.1.cmml" xref="algorithm1.20.20.1.m1.1.1.2.3">superscript</csymbol><apply id="algorithm1.20.20.1.m1.1.1.2.3.2.cmml" xref="algorithm1.20.20.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="algorithm1.20.20.1.m1.1.1.2.3.2.1.cmml" xref="algorithm1.20.20.1.m1.1.1.2.3">subscript</csymbol><apply id="algorithm1.20.20.1.m1.1.1.2.3.2.2.cmml" xref="algorithm1.20.20.1.m1.1.1.2.3.2.2"><ci id="algorithm1.20.20.1.m1.1.1.2.3.2.2.1.cmml" xref="algorithm1.20.20.1.m1.1.1.2.3.2.2.1">~</ci><ci id="algorithm1.20.20.1.m1.1.1.2.3.2.2.2.cmml" xref="algorithm1.20.20.1.m1.1.1.2.3.2.2.2">𝑔</ci></apply><apply id="algorithm1.20.20.1.m1.1.1.2.3.2.3.cmml" xref="algorithm1.20.20.1.m1.1.1.2.3.2.3"><plus id="algorithm1.20.20.1.m1.1.1.2.3.2.3.1.cmml" xref="algorithm1.20.20.1.m1.1.1.2.3.2.3.1"></plus><ci id="algorithm1.20.20.1.m1.1.1.2.3.2.3.2.cmml" xref="algorithm1.20.20.1.m1.1.1.2.3.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.20.20.1.m1.1.1.2.3.2.3.3.cmml" xref="algorithm1.20.20.1.m1.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="algorithm1.20.20.1.m1.1.1.2.3.3.cmml" xref="algorithm1.20.20.1.m1.1.1.2.3.3">𝑗</ci></apply></apply><cn type="integer" id="algorithm1.20.20.1.m1.1.1.3.cmml" xref="algorithm1.20.20.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.20.20.1.m1.1c">g_{t+1}^{k}\cdot\widetilde{g}_{t+1}^{j}&lt;0</annotation></semantics></math></em><span id="algorithm1.20.20.10" class="ltx_text" style="color:#BF0040;"> </span><span id="algorithm1.20.20.11" class="ltx_text ltx_font_bold" style="color:#BF0040;">then</span>
</div>
<div id="algorithm1.21.21" class="ltx_listingline">
<span id="algorithm1.21.21.1" class="ltx_text" style="color:#BF0040;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.21.21.2" class="ltx_text" style="color:#BF0040;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.21.21.3" class="ltx_text" style="color:#BF0040;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.21.21.4" class="ltx_text" style="color:#BF0040;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.21.21.5" class="ltx_text" style="color:#BF0040;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.21.21.6" class="ltx_text" style="color:#BF0040;">   </span><span id="algorithm1.21.21.7" class="ltx_text" style="color:#BF0040;">
</span><math id="algorithm1.21.21.m1.1" class="ltx_Math" alttext="g_{t+1}^{k}\leftarrow g_{t+1}^{k}-\frac{g_{t+1}^{k}\cdot\widetilde{g}_{t+1}^{j}}{{\|\widetilde{g}_{t+1}^{j}\|}^{2}}\widetilde{g}_{t+1}^{j}" display="inline"><semantics id="algorithm1.21.21.m1.1a"><mrow id="algorithm1.21.21.m1.1.2" xref="algorithm1.21.21.m1.1.2.cmml"><msubsup id="algorithm1.21.21.m1.1.2.2" xref="algorithm1.21.21.m1.1.2.2.cmml"><mi mathcolor="#BF0040" id="algorithm1.21.21.m1.1.2.2.2.2" xref="algorithm1.21.21.m1.1.2.2.2.2.cmml">g</mi><mrow id="algorithm1.21.21.m1.1.2.2.2.3" xref="algorithm1.21.21.m1.1.2.2.2.3.cmml"><mi mathcolor="#BF0040" id="algorithm1.21.21.m1.1.2.2.2.3.2" xref="algorithm1.21.21.m1.1.2.2.2.3.2.cmml">t</mi><mo mathcolor="#BF0040" id="algorithm1.21.21.m1.1.2.2.2.3.1" xref="algorithm1.21.21.m1.1.2.2.2.3.1.cmml">+</mo><mn mathcolor="#BF0040" id="algorithm1.21.21.m1.1.2.2.2.3.3" xref="algorithm1.21.21.m1.1.2.2.2.3.3.cmml">1</mn></mrow><mi mathcolor="#BF0040" id="algorithm1.21.21.m1.1.2.2.3" xref="algorithm1.21.21.m1.1.2.2.3.cmml">k</mi></msubsup><mo mathcolor="#BF0040" stretchy="false" id="algorithm1.21.21.m1.1.2.1" xref="algorithm1.21.21.m1.1.2.1.cmml">←</mo><mrow id="algorithm1.21.21.m1.1.2.3" xref="algorithm1.21.21.m1.1.2.3.cmml"><msubsup id="algorithm1.21.21.m1.1.2.3.2" xref="algorithm1.21.21.m1.1.2.3.2.cmml"><mi mathcolor="#BF0040" id="algorithm1.21.21.m1.1.2.3.2.2.2" xref="algorithm1.21.21.m1.1.2.3.2.2.2.cmml">g</mi><mrow id="algorithm1.21.21.m1.1.2.3.2.2.3" xref="algorithm1.21.21.m1.1.2.3.2.2.3.cmml"><mi mathcolor="#BF0040" id="algorithm1.21.21.m1.1.2.3.2.2.3.2" xref="algorithm1.21.21.m1.1.2.3.2.2.3.2.cmml">t</mi><mo mathcolor="#BF0040" id="algorithm1.21.21.m1.1.2.3.2.2.3.1" xref="algorithm1.21.21.m1.1.2.3.2.2.3.1.cmml">+</mo><mn mathcolor="#BF0040" id="algorithm1.21.21.m1.1.2.3.2.2.3.3" xref="algorithm1.21.21.m1.1.2.3.2.2.3.3.cmml">1</mn></mrow><mi mathcolor="#BF0040" id="algorithm1.21.21.m1.1.2.3.2.3" xref="algorithm1.21.21.m1.1.2.3.2.3.cmml">k</mi></msubsup><mo mathcolor="#BF0040" id="algorithm1.21.21.m1.1.2.3.1" xref="algorithm1.21.21.m1.1.2.3.1.cmml">−</mo><mrow id="algorithm1.21.21.m1.1.2.3.3" xref="algorithm1.21.21.m1.1.2.3.3.cmml"><mfrac mathcolor="#BF0040" id="algorithm1.21.21.m1.1.1" xref="algorithm1.21.21.m1.1.1.cmml"><mrow id="algorithm1.21.21.m1.1.1.3" xref="algorithm1.21.21.m1.1.1.3.cmml"><msubsup id="algorithm1.21.21.m1.1.1.3.2" xref="algorithm1.21.21.m1.1.1.3.2.cmml"><mi mathcolor="#BF0040" id="algorithm1.21.21.m1.1.1.3.2.2.2" xref="algorithm1.21.21.m1.1.1.3.2.2.2.cmml">g</mi><mrow id="algorithm1.21.21.m1.1.1.3.2.2.3" xref="algorithm1.21.21.m1.1.1.3.2.2.3.cmml"><mi mathcolor="#BF0040" id="algorithm1.21.21.m1.1.1.3.2.2.3.2" xref="algorithm1.21.21.m1.1.1.3.2.2.3.2.cmml">t</mi><mo mathcolor="#BF0040" id="algorithm1.21.21.m1.1.1.3.2.2.3.1" xref="algorithm1.21.21.m1.1.1.3.2.2.3.1.cmml">+</mo><mn mathcolor="#BF0040" id="algorithm1.21.21.m1.1.1.3.2.2.3.3" xref="algorithm1.21.21.m1.1.1.3.2.2.3.3.cmml">1</mn></mrow><mi mathcolor="#BF0040" id="algorithm1.21.21.m1.1.1.3.2.3" xref="algorithm1.21.21.m1.1.1.3.2.3.cmml">k</mi></msubsup><mo lspace="0.222em" mathcolor="#BF0040" rspace="0.222em" id="algorithm1.21.21.m1.1.1.3.1" xref="algorithm1.21.21.m1.1.1.3.1.cmml">⋅</mo><msubsup id="algorithm1.21.21.m1.1.1.3.3" xref="algorithm1.21.21.m1.1.1.3.3.cmml"><mover accent="true" id="algorithm1.21.21.m1.1.1.3.3.2.2" xref="algorithm1.21.21.m1.1.1.3.3.2.2.cmml"><mi mathcolor="#BF0040" id="algorithm1.21.21.m1.1.1.3.3.2.2.2" xref="algorithm1.21.21.m1.1.1.3.3.2.2.2.cmml">g</mi><mo mathcolor="#BF0040" id="algorithm1.21.21.m1.1.1.3.3.2.2.1" xref="algorithm1.21.21.m1.1.1.3.3.2.2.1.cmml">~</mo></mover><mrow id="algorithm1.21.21.m1.1.1.3.3.2.3" xref="algorithm1.21.21.m1.1.1.3.3.2.3.cmml"><mi mathcolor="#BF0040" id="algorithm1.21.21.m1.1.1.3.3.2.3.2" xref="algorithm1.21.21.m1.1.1.3.3.2.3.2.cmml">t</mi><mo mathcolor="#BF0040" id="algorithm1.21.21.m1.1.1.3.3.2.3.1" xref="algorithm1.21.21.m1.1.1.3.3.2.3.1.cmml">+</mo><mn mathcolor="#BF0040" id="algorithm1.21.21.m1.1.1.3.3.2.3.3" xref="algorithm1.21.21.m1.1.1.3.3.2.3.3.cmml">1</mn></mrow><mi mathcolor="#BF0040" id="algorithm1.21.21.m1.1.1.3.3.3" xref="algorithm1.21.21.m1.1.1.3.3.3.cmml">j</mi></msubsup></mrow><msup id="algorithm1.21.21.m1.1.1.1" xref="algorithm1.21.21.m1.1.1.1.cmml"><mrow id="algorithm1.21.21.m1.1.1.1.1.1" xref="algorithm1.21.21.m1.1.1.1.1.2.cmml"><mo mathcolor="#BF0040" stretchy="false" id="algorithm1.21.21.m1.1.1.1.1.1.2" xref="algorithm1.21.21.m1.1.1.1.1.2.1.cmml">‖</mo><msubsup id="algorithm1.21.21.m1.1.1.1.1.1.1" xref="algorithm1.21.21.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="algorithm1.21.21.m1.1.1.1.1.1.1.2.2" xref="algorithm1.21.21.m1.1.1.1.1.1.1.2.2.cmml"><mi mathcolor="#BF0040" id="algorithm1.21.21.m1.1.1.1.1.1.1.2.2.2" xref="algorithm1.21.21.m1.1.1.1.1.1.1.2.2.2.cmml">g</mi><mo mathcolor="#BF0040" id="algorithm1.21.21.m1.1.1.1.1.1.1.2.2.1" xref="algorithm1.21.21.m1.1.1.1.1.1.1.2.2.1.cmml">~</mo></mover><mrow id="algorithm1.21.21.m1.1.1.1.1.1.1.2.3" xref="algorithm1.21.21.m1.1.1.1.1.1.1.2.3.cmml"><mi mathcolor="#BF0040" id="algorithm1.21.21.m1.1.1.1.1.1.1.2.3.2" xref="algorithm1.21.21.m1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo mathcolor="#BF0040" id="algorithm1.21.21.m1.1.1.1.1.1.1.2.3.1" xref="algorithm1.21.21.m1.1.1.1.1.1.1.2.3.1.cmml">+</mo><mn mathcolor="#BF0040" id="algorithm1.21.21.m1.1.1.1.1.1.1.2.3.3" xref="algorithm1.21.21.m1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi mathcolor="#BF0040" id="algorithm1.21.21.m1.1.1.1.1.1.1.3" xref="algorithm1.21.21.m1.1.1.1.1.1.1.3.cmml">j</mi></msubsup><mo mathcolor="#BF0040" stretchy="false" id="algorithm1.21.21.m1.1.1.1.1.1.3" xref="algorithm1.21.21.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn mathcolor="#BF0040" id="algorithm1.21.21.m1.1.1.1.3" xref="algorithm1.21.21.m1.1.1.1.3.cmml">2</mn></msup></mfrac><mo lspace="0em" rspace="0em" id="algorithm1.21.21.m1.1.2.3.3.1" xref="algorithm1.21.21.m1.1.2.3.3.1.cmml">​</mo><msubsup id="algorithm1.21.21.m1.1.2.3.3.2" xref="algorithm1.21.21.m1.1.2.3.3.2.cmml"><mover accent="true" id="algorithm1.21.21.m1.1.2.3.3.2.2.2" xref="algorithm1.21.21.m1.1.2.3.3.2.2.2.cmml"><mi mathcolor="#BF0040" id="algorithm1.21.21.m1.1.2.3.3.2.2.2.2" xref="algorithm1.21.21.m1.1.2.3.3.2.2.2.2.cmml">g</mi><mo mathcolor="#BF0040" id="algorithm1.21.21.m1.1.2.3.3.2.2.2.1" xref="algorithm1.21.21.m1.1.2.3.3.2.2.2.1.cmml">~</mo></mover><mrow id="algorithm1.21.21.m1.1.2.3.3.2.2.3" xref="algorithm1.21.21.m1.1.2.3.3.2.2.3.cmml"><mi mathcolor="#BF0040" id="algorithm1.21.21.m1.1.2.3.3.2.2.3.2" xref="algorithm1.21.21.m1.1.2.3.3.2.2.3.2.cmml">t</mi><mo mathcolor="#BF0040" id="algorithm1.21.21.m1.1.2.3.3.2.2.3.1" xref="algorithm1.21.21.m1.1.2.3.3.2.2.3.1.cmml">+</mo><mn mathcolor="#BF0040" id="algorithm1.21.21.m1.1.2.3.3.2.2.3.3" xref="algorithm1.21.21.m1.1.2.3.3.2.2.3.3.cmml">1</mn></mrow><mi mathcolor="#BF0040" id="algorithm1.21.21.m1.1.2.3.3.2.3" xref="algorithm1.21.21.m1.1.2.3.3.2.3.cmml">j</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.21.21.m1.1b"><apply id="algorithm1.21.21.m1.1.2.cmml" xref="algorithm1.21.21.m1.1.2"><ci id="algorithm1.21.21.m1.1.2.1.cmml" xref="algorithm1.21.21.m1.1.2.1">←</ci><apply id="algorithm1.21.21.m1.1.2.2.cmml" xref="algorithm1.21.21.m1.1.2.2"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.2.2.1.cmml" xref="algorithm1.21.21.m1.1.2.2">superscript</csymbol><apply id="algorithm1.21.21.m1.1.2.2.2.cmml" xref="algorithm1.21.21.m1.1.2.2"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.2.2.2.1.cmml" xref="algorithm1.21.21.m1.1.2.2">subscript</csymbol><ci id="algorithm1.21.21.m1.1.2.2.2.2.cmml" xref="algorithm1.21.21.m1.1.2.2.2.2">𝑔</ci><apply id="algorithm1.21.21.m1.1.2.2.2.3.cmml" xref="algorithm1.21.21.m1.1.2.2.2.3"><plus id="algorithm1.21.21.m1.1.2.2.2.3.1.cmml" xref="algorithm1.21.21.m1.1.2.2.2.3.1"></plus><ci id="algorithm1.21.21.m1.1.2.2.2.3.2.cmml" xref="algorithm1.21.21.m1.1.2.2.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.21.21.m1.1.2.2.2.3.3.cmml" xref="algorithm1.21.21.m1.1.2.2.2.3.3">1</cn></apply></apply><ci id="algorithm1.21.21.m1.1.2.2.3.cmml" xref="algorithm1.21.21.m1.1.2.2.3">𝑘</ci></apply><apply id="algorithm1.21.21.m1.1.2.3.cmml" xref="algorithm1.21.21.m1.1.2.3"><minus id="algorithm1.21.21.m1.1.2.3.1.cmml" xref="algorithm1.21.21.m1.1.2.3.1"></minus><apply id="algorithm1.21.21.m1.1.2.3.2.cmml" xref="algorithm1.21.21.m1.1.2.3.2"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.2.3.2.1.cmml" xref="algorithm1.21.21.m1.1.2.3.2">superscript</csymbol><apply id="algorithm1.21.21.m1.1.2.3.2.2.cmml" xref="algorithm1.21.21.m1.1.2.3.2"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.2.3.2.2.1.cmml" xref="algorithm1.21.21.m1.1.2.3.2">subscript</csymbol><ci id="algorithm1.21.21.m1.1.2.3.2.2.2.cmml" xref="algorithm1.21.21.m1.1.2.3.2.2.2">𝑔</ci><apply id="algorithm1.21.21.m1.1.2.3.2.2.3.cmml" xref="algorithm1.21.21.m1.1.2.3.2.2.3"><plus id="algorithm1.21.21.m1.1.2.3.2.2.3.1.cmml" xref="algorithm1.21.21.m1.1.2.3.2.2.3.1"></plus><ci id="algorithm1.21.21.m1.1.2.3.2.2.3.2.cmml" xref="algorithm1.21.21.m1.1.2.3.2.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.21.21.m1.1.2.3.2.2.3.3.cmml" xref="algorithm1.21.21.m1.1.2.3.2.2.3.3">1</cn></apply></apply><ci id="algorithm1.21.21.m1.1.2.3.2.3.cmml" xref="algorithm1.21.21.m1.1.2.3.2.3">𝑘</ci></apply><apply id="algorithm1.21.21.m1.1.2.3.3.cmml" xref="algorithm1.21.21.m1.1.2.3.3"><times id="algorithm1.21.21.m1.1.2.3.3.1.cmml" xref="algorithm1.21.21.m1.1.2.3.3.1"></times><apply id="algorithm1.21.21.m1.1.1.cmml" xref="algorithm1.21.21.m1.1.1"><divide id="algorithm1.21.21.m1.1.1.2.cmml" xref="algorithm1.21.21.m1.1.1"></divide><apply id="algorithm1.21.21.m1.1.1.3.cmml" xref="algorithm1.21.21.m1.1.1.3"><ci id="algorithm1.21.21.m1.1.1.3.1.cmml" xref="algorithm1.21.21.m1.1.1.3.1">⋅</ci><apply id="algorithm1.21.21.m1.1.1.3.2.cmml" xref="algorithm1.21.21.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.1.3.2.1.cmml" xref="algorithm1.21.21.m1.1.1.3.2">superscript</csymbol><apply id="algorithm1.21.21.m1.1.1.3.2.2.cmml" xref="algorithm1.21.21.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.1.3.2.2.1.cmml" xref="algorithm1.21.21.m1.1.1.3.2">subscript</csymbol><ci id="algorithm1.21.21.m1.1.1.3.2.2.2.cmml" xref="algorithm1.21.21.m1.1.1.3.2.2.2">𝑔</ci><apply id="algorithm1.21.21.m1.1.1.3.2.2.3.cmml" xref="algorithm1.21.21.m1.1.1.3.2.2.3"><plus id="algorithm1.21.21.m1.1.1.3.2.2.3.1.cmml" xref="algorithm1.21.21.m1.1.1.3.2.2.3.1"></plus><ci id="algorithm1.21.21.m1.1.1.3.2.2.3.2.cmml" xref="algorithm1.21.21.m1.1.1.3.2.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.21.21.m1.1.1.3.2.2.3.3.cmml" xref="algorithm1.21.21.m1.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="algorithm1.21.21.m1.1.1.3.2.3.cmml" xref="algorithm1.21.21.m1.1.1.3.2.3">𝑘</ci></apply><apply id="algorithm1.21.21.m1.1.1.3.3.cmml" xref="algorithm1.21.21.m1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.1.3.3.1.cmml" xref="algorithm1.21.21.m1.1.1.3.3">superscript</csymbol><apply id="algorithm1.21.21.m1.1.1.3.3.2.cmml" xref="algorithm1.21.21.m1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.1.3.3.2.1.cmml" xref="algorithm1.21.21.m1.1.1.3.3">subscript</csymbol><apply id="algorithm1.21.21.m1.1.1.3.3.2.2.cmml" xref="algorithm1.21.21.m1.1.1.3.3.2.2"><ci id="algorithm1.21.21.m1.1.1.3.3.2.2.1.cmml" xref="algorithm1.21.21.m1.1.1.3.3.2.2.1">~</ci><ci id="algorithm1.21.21.m1.1.1.3.3.2.2.2.cmml" xref="algorithm1.21.21.m1.1.1.3.3.2.2.2">𝑔</ci></apply><apply id="algorithm1.21.21.m1.1.1.3.3.2.3.cmml" xref="algorithm1.21.21.m1.1.1.3.3.2.3"><plus id="algorithm1.21.21.m1.1.1.3.3.2.3.1.cmml" xref="algorithm1.21.21.m1.1.1.3.3.2.3.1"></plus><ci id="algorithm1.21.21.m1.1.1.3.3.2.3.2.cmml" xref="algorithm1.21.21.m1.1.1.3.3.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.21.21.m1.1.1.3.3.2.3.3.cmml" xref="algorithm1.21.21.m1.1.1.3.3.2.3.3">1</cn></apply></apply><ci id="algorithm1.21.21.m1.1.1.3.3.3.cmml" xref="algorithm1.21.21.m1.1.1.3.3.3">𝑗</ci></apply></apply><apply id="algorithm1.21.21.m1.1.1.1.cmml" xref="algorithm1.21.21.m1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.1.1.2.cmml" xref="algorithm1.21.21.m1.1.1.1">superscript</csymbol><apply id="algorithm1.21.21.m1.1.1.1.1.2.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1"><csymbol cd="latexml" id="algorithm1.21.21.m1.1.1.1.1.2.1.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.2">norm</csymbol><apply id="algorithm1.21.21.m1.1.1.1.1.1.1.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1">superscript</csymbol><apply id="algorithm1.21.21.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.1.1.1.1.1.2.1.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1">subscript</csymbol><apply id="algorithm1.21.21.m1.1.1.1.1.1.1.2.2.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1.2.2"><ci id="algorithm1.21.21.m1.1.1.1.1.1.1.2.2.1.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1.2.2.1">~</ci><ci id="algorithm1.21.21.m1.1.1.1.1.1.1.2.2.2.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1.2.2.2">𝑔</ci></apply><apply id="algorithm1.21.21.m1.1.1.1.1.1.1.2.3.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1.2.3"><plus id="algorithm1.21.21.m1.1.1.1.1.1.1.2.3.1.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1.2.3.1"></plus><ci id="algorithm1.21.21.m1.1.1.1.1.1.1.2.3.2.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.21.21.m1.1.1.1.1.1.1.2.3.3.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="algorithm1.21.21.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><cn type="integer" id="algorithm1.21.21.m1.1.1.1.3.cmml" xref="algorithm1.21.21.m1.1.1.1.3">2</cn></apply></apply><apply id="algorithm1.21.21.m1.1.2.3.3.2.cmml" xref="algorithm1.21.21.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.2.3.3.2.1.cmml" xref="algorithm1.21.21.m1.1.2.3.3.2">superscript</csymbol><apply id="algorithm1.21.21.m1.1.2.3.3.2.2.cmml" xref="algorithm1.21.21.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.2.3.3.2.2.1.cmml" xref="algorithm1.21.21.m1.1.2.3.3.2">subscript</csymbol><apply id="algorithm1.21.21.m1.1.2.3.3.2.2.2.cmml" xref="algorithm1.21.21.m1.1.2.3.3.2.2.2"><ci id="algorithm1.21.21.m1.1.2.3.3.2.2.2.1.cmml" xref="algorithm1.21.21.m1.1.2.3.3.2.2.2.1">~</ci><ci id="algorithm1.21.21.m1.1.2.3.3.2.2.2.2.cmml" xref="algorithm1.21.21.m1.1.2.3.3.2.2.2.2">𝑔</ci></apply><apply id="algorithm1.21.21.m1.1.2.3.3.2.2.3.cmml" xref="algorithm1.21.21.m1.1.2.3.3.2.2.3"><plus id="algorithm1.21.21.m1.1.2.3.3.2.2.3.1.cmml" xref="algorithm1.21.21.m1.1.2.3.3.2.2.3.1"></plus><ci id="algorithm1.21.21.m1.1.2.3.3.2.2.3.2.cmml" xref="algorithm1.21.21.m1.1.2.3.3.2.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.21.21.m1.1.2.3.3.2.2.3.3.cmml" xref="algorithm1.21.21.m1.1.2.3.3.2.2.3.3">1</cn></apply></apply><ci id="algorithm1.21.21.m1.1.2.3.3.2.3.cmml" xref="algorithm1.21.21.m1.1.2.3.3.2.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.21.21.m1.1c">g_{t+1}^{k}\leftarrow g_{t+1}^{k}-\frac{g_{t+1}^{k}\cdot\widetilde{g}_{t+1}^{j}}{{\|\widetilde{g}_{t+1}^{j}\|}^{2}}\widetilde{g}_{t+1}^{j}</annotation></semantics></math><span id="algorithm1.21.21.8" class="ltx_text" style="color:#BF0040;">
</span>
</div>
<div id="algorithm1.22.22" class="ltx_listingline">
<span id="algorithm1.22.22.1" class="ltx_text" style="color:#BF0040;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.22.22.2" class="ltx_text" style="color:#BF0040;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.22.22.3" class="ltx_text" style="color:#BF0040;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.22.22.4" class="ltx_text" style="color:#BF0040;">   </span><math id="algorithm1.22.22.m1.1" class="ltx_Math" alttext="w_{t+1}^{k}\leftarrow w_{t}+\eta g_{t+1}^{k}" display="inline"><semantics id="algorithm1.22.22.m1.1a"><mrow id="algorithm1.22.22.m1.1.1" xref="algorithm1.22.22.m1.1.1.cmml"><msubsup id="algorithm1.22.22.m1.1.1.2" xref="algorithm1.22.22.m1.1.1.2.cmml"><mi mathcolor="#BF0040" id="algorithm1.22.22.m1.1.1.2.2.2" xref="algorithm1.22.22.m1.1.1.2.2.2.cmml">w</mi><mrow id="algorithm1.22.22.m1.1.1.2.2.3" xref="algorithm1.22.22.m1.1.1.2.2.3.cmml"><mi mathcolor="#BF0040" id="algorithm1.22.22.m1.1.1.2.2.3.2" xref="algorithm1.22.22.m1.1.1.2.2.3.2.cmml">t</mi><mo mathcolor="#BF0040" id="algorithm1.22.22.m1.1.1.2.2.3.1" xref="algorithm1.22.22.m1.1.1.2.2.3.1.cmml">+</mo><mn mathcolor="#BF0040" id="algorithm1.22.22.m1.1.1.2.2.3.3" xref="algorithm1.22.22.m1.1.1.2.2.3.3.cmml">1</mn></mrow><mi mathcolor="#BF0040" id="algorithm1.22.22.m1.1.1.2.3" xref="algorithm1.22.22.m1.1.1.2.3.cmml">k</mi></msubsup><mo mathcolor="#BF0040" stretchy="false" id="algorithm1.22.22.m1.1.1.1" xref="algorithm1.22.22.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.22.22.m1.1.1.3" xref="algorithm1.22.22.m1.1.1.3.cmml"><msub id="algorithm1.22.22.m1.1.1.3.2" xref="algorithm1.22.22.m1.1.1.3.2.cmml"><mi mathcolor="#BF0040" id="algorithm1.22.22.m1.1.1.3.2.2" xref="algorithm1.22.22.m1.1.1.3.2.2.cmml">w</mi><mi mathcolor="#BF0040" id="algorithm1.22.22.m1.1.1.3.2.3" xref="algorithm1.22.22.m1.1.1.3.2.3.cmml">t</mi></msub><mo mathcolor="#BF0040" id="algorithm1.22.22.m1.1.1.3.1" xref="algorithm1.22.22.m1.1.1.3.1.cmml">+</mo><mrow id="algorithm1.22.22.m1.1.1.3.3" xref="algorithm1.22.22.m1.1.1.3.3.cmml"><mi mathcolor="#BF0040" id="algorithm1.22.22.m1.1.1.3.3.2" xref="algorithm1.22.22.m1.1.1.3.3.2.cmml">η</mi><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.1.1.3.3.1" xref="algorithm1.22.22.m1.1.1.3.3.1.cmml">​</mo><msubsup id="algorithm1.22.22.m1.1.1.3.3.3" xref="algorithm1.22.22.m1.1.1.3.3.3.cmml"><mi mathcolor="#BF0040" id="algorithm1.22.22.m1.1.1.3.3.3.2.2" xref="algorithm1.22.22.m1.1.1.3.3.3.2.2.cmml">g</mi><mrow id="algorithm1.22.22.m1.1.1.3.3.3.2.3" xref="algorithm1.22.22.m1.1.1.3.3.3.2.3.cmml"><mi mathcolor="#BF0040" id="algorithm1.22.22.m1.1.1.3.3.3.2.3.2" xref="algorithm1.22.22.m1.1.1.3.3.3.2.3.2.cmml">t</mi><mo mathcolor="#BF0040" id="algorithm1.22.22.m1.1.1.3.3.3.2.3.1" xref="algorithm1.22.22.m1.1.1.3.3.3.2.3.1.cmml">+</mo><mn mathcolor="#BF0040" id="algorithm1.22.22.m1.1.1.3.3.3.2.3.3" xref="algorithm1.22.22.m1.1.1.3.3.3.2.3.3.cmml">1</mn></mrow><mi mathcolor="#BF0040" id="algorithm1.22.22.m1.1.1.3.3.3.3" xref="algorithm1.22.22.m1.1.1.3.3.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.22.22.m1.1b"><apply id="algorithm1.22.22.m1.1.1.cmml" xref="algorithm1.22.22.m1.1.1"><ci id="algorithm1.22.22.m1.1.1.1.cmml" xref="algorithm1.22.22.m1.1.1.1">←</ci><apply id="algorithm1.22.22.m1.1.1.2.cmml" xref="algorithm1.22.22.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.1.1.2.1.cmml" xref="algorithm1.22.22.m1.1.1.2">superscript</csymbol><apply id="algorithm1.22.22.m1.1.1.2.2.cmml" xref="algorithm1.22.22.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.1.1.2.2.1.cmml" xref="algorithm1.22.22.m1.1.1.2">subscript</csymbol><ci id="algorithm1.22.22.m1.1.1.2.2.2.cmml" xref="algorithm1.22.22.m1.1.1.2.2.2">𝑤</ci><apply id="algorithm1.22.22.m1.1.1.2.2.3.cmml" xref="algorithm1.22.22.m1.1.1.2.2.3"><plus id="algorithm1.22.22.m1.1.1.2.2.3.1.cmml" xref="algorithm1.22.22.m1.1.1.2.2.3.1"></plus><ci id="algorithm1.22.22.m1.1.1.2.2.3.2.cmml" xref="algorithm1.22.22.m1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.22.22.m1.1.1.2.2.3.3.cmml" xref="algorithm1.22.22.m1.1.1.2.2.3.3">1</cn></apply></apply><ci id="algorithm1.22.22.m1.1.1.2.3.cmml" xref="algorithm1.22.22.m1.1.1.2.3">𝑘</ci></apply><apply id="algorithm1.22.22.m1.1.1.3.cmml" xref="algorithm1.22.22.m1.1.1.3"><plus id="algorithm1.22.22.m1.1.1.3.1.cmml" xref="algorithm1.22.22.m1.1.1.3.1"></plus><apply id="algorithm1.22.22.m1.1.1.3.2.cmml" xref="algorithm1.22.22.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.1.1.3.2.1.cmml" xref="algorithm1.22.22.m1.1.1.3.2">subscript</csymbol><ci id="algorithm1.22.22.m1.1.1.3.2.2.cmml" xref="algorithm1.22.22.m1.1.1.3.2.2">𝑤</ci><ci id="algorithm1.22.22.m1.1.1.3.2.3.cmml" xref="algorithm1.22.22.m1.1.1.3.2.3">𝑡</ci></apply><apply id="algorithm1.22.22.m1.1.1.3.3.cmml" xref="algorithm1.22.22.m1.1.1.3.3"><times id="algorithm1.22.22.m1.1.1.3.3.1.cmml" xref="algorithm1.22.22.m1.1.1.3.3.1"></times><ci id="algorithm1.22.22.m1.1.1.3.3.2.cmml" xref="algorithm1.22.22.m1.1.1.3.3.2">𝜂</ci><apply id="algorithm1.22.22.m1.1.1.3.3.3.cmml" xref="algorithm1.22.22.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.1.1.3.3.3.1.cmml" xref="algorithm1.22.22.m1.1.1.3.3.3">superscript</csymbol><apply id="algorithm1.22.22.m1.1.1.3.3.3.2.cmml" xref="algorithm1.22.22.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.1.1.3.3.3.2.1.cmml" xref="algorithm1.22.22.m1.1.1.3.3.3">subscript</csymbol><ci id="algorithm1.22.22.m1.1.1.3.3.3.2.2.cmml" xref="algorithm1.22.22.m1.1.1.3.3.3.2.2">𝑔</ci><apply id="algorithm1.22.22.m1.1.1.3.3.3.2.3.cmml" xref="algorithm1.22.22.m1.1.1.3.3.3.2.3"><plus id="algorithm1.22.22.m1.1.1.3.3.3.2.3.1.cmml" xref="algorithm1.22.22.m1.1.1.3.3.3.2.3.1"></plus><ci id="algorithm1.22.22.m1.1.1.3.3.3.2.3.2.cmml" xref="algorithm1.22.22.m1.1.1.3.3.3.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.22.22.m1.1.1.3.3.3.2.3.3.cmml" xref="algorithm1.22.22.m1.1.1.3.3.3.2.3.3">1</cn></apply></apply><ci id="algorithm1.22.22.m1.1.1.3.3.3.3.cmml" xref="algorithm1.22.22.m1.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.22.22.m1.1c">w_{t+1}^{k}\leftarrow w_{t}+\eta g_{t+1}^{k}</annotation></semantics></math><span id="algorithm1.22.22.5" class="ltx_text" style="color:#BF0040;">
</span>
</div>
<div id="algorithm1.23.23" class="ltx_listingline">
<span id="algorithm1.23.23.2" class="ltx_text">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   </span><span id="algorithm1.23.23.1" class="ltx_text">
<math id="algorithm1.23.23.1.m1.1" class="ltx_Math" alttext="{w}_{t+1}\leftarrow\sum_{k\in S_{t}}\frac{n_{k}}{n}w_{t+1}^{k}" display="inline"><semantics id="algorithm1.23.23.1.m1.1a"><mrow id="algorithm1.23.23.1.m1.1.1" xref="algorithm1.23.23.1.m1.1.1.cmml"><msub id="algorithm1.23.23.1.m1.1.1.2" xref="algorithm1.23.23.1.m1.1.1.2.cmml"><mi id="algorithm1.23.23.1.m1.1.1.2.2" xref="algorithm1.23.23.1.m1.1.1.2.2.cmml">w</mi><mrow id="algorithm1.23.23.1.m1.1.1.2.3" xref="algorithm1.23.23.1.m1.1.1.2.3.cmml"><mi id="algorithm1.23.23.1.m1.1.1.2.3.2" xref="algorithm1.23.23.1.m1.1.1.2.3.2.cmml">t</mi><mo id="algorithm1.23.23.1.m1.1.1.2.3.1" xref="algorithm1.23.23.1.m1.1.1.2.3.1.cmml">+</mo><mn id="algorithm1.23.23.1.m1.1.1.2.3.3" xref="algorithm1.23.23.1.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo rspace="0.111em" stretchy="false" id="algorithm1.23.23.1.m1.1.1.1" xref="algorithm1.23.23.1.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.23.23.1.m1.1.1.3" xref="algorithm1.23.23.1.m1.1.1.3.cmml"><msub id="algorithm1.23.23.1.m1.1.1.3.1" xref="algorithm1.23.23.1.m1.1.1.3.1.cmml"><mo id="algorithm1.23.23.1.m1.1.1.3.1.2" xref="algorithm1.23.23.1.m1.1.1.3.1.2.cmml">∑</mo><mrow id="algorithm1.23.23.1.m1.1.1.3.1.3" xref="algorithm1.23.23.1.m1.1.1.3.1.3.cmml"><mi id="algorithm1.23.23.1.m1.1.1.3.1.3.2" xref="algorithm1.23.23.1.m1.1.1.3.1.3.2.cmml">k</mi><mo id="algorithm1.23.23.1.m1.1.1.3.1.3.1" xref="algorithm1.23.23.1.m1.1.1.3.1.3.1.cmml">∈</mo><msub id="algorithm1.23.23.1.m1.1.1.3.1.3.3" xref="algorithm1.23.23.1.m1.1.1.3.1.3.3.cmml"><mi id="algorithm1.23.23.1.m1.1.1.3.1.3.3.2" xref="algorithm1.23.23.1.m1.1.1.3.1.3.3.2.cmml">S</mi><mi id="algorithm1.23.23.1.m1.1.1.3.1.3.3.3" xref="algorithm1.23.23.1.m1.1.1.3.1.3.3.3.cmml">t</mi></msub></mrow></msub><mrow id="algorithm1.23.23.1.m1.1.1.3.2" xref="algorithm1.23.23.1.m1.1.1.3.2.cmml"><mfrac id="algorithm1.23.23.1.m1.1.1.3.2.2" xref="algorithm1.23.23.1.m1.1.1.3.2.2.cmml"><msub id="algorithm1.23.23.1.m1.1.1.3.2.2.2" xref="algorithm1.23.23.1.m1.1.1.3.2.2.2.cmml"><mi id="algorithm1.23.23.1.m1.1.1.3.2.2.2.2" xref="algorithm1.23.23.1.m1.1.1.3.2.2.2.2.cmml">n</mi><mi id="algorithm1.23.23.1.m1.1.1.3.2.2.2.3" xref="algorithm1.23.23.1.m1.1.1.3.2.2.2.3.cmml">k</mi></msub><mi id="algorithm1.23.23.1.m1.1.1.3.2.2.3" xref="algorithm1.23.23.1.m1.1.1.3.2.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="algorithm1.23.23.1.m1.1.1.3.2.1" xref="algorithm1.23.23.1.m1.1.1.3.2.1.cmml">​</mo><msubsup id="algorithm1.23.23.1.m1.1.1.3.2.3" xref="algorithm1.23.23.1.m1.1.1.3.2.3.cmml"><mi id="algorithm1.23.23.1.m1.1.1.3.2.3.2.2" xref="algorithm1.23.23.1.m1.1.1.3.2.3.2.2.cmml">w</mi><mrow id="algorithm1.23.23.1.m1.1.1.3.2.3.2.3" xref="algorithm1.23.23.1.m1.1.1.3.2.3.2.3.cmml"><mi id="algorithm1.23.23.1.m1.1.1.3.2.3.2.3.2" xref="algorithm1.23.23.1.m1.1.1.3.2.3.2.3.2.cmml">t</mi><mo id="algorithm1.23.23.1.m1.1.1.3.2.3.2.3.1" xref="algorithm1.23.23.1.m1.1.1.3.2.3.2.3.1.cmml">+</mo><mn id="algorithm1.23.23.1.m1.1.1.3.2.3.2.3.3" xref="algorithm1.23.23.1.m1.1.1.3.2.3.2.3.3.cmml">1</mn></mrow><mi id="algorithm1.23.23.1.m1.1.1.3.2.3.3" xref="algorithm1.23.23.1.m1.1.1.3.2.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.23.23.1.m1.1b"><apply id="algorithm1.23.23.1.m1.1.1.cmml" xref="algorithm1.23.23.1.m1.1.1"><ci id="algorithm1.23.23.1.m1.1.1.1.cmml" xref="algorithm1.23.23.1.m1.1.1.1">←</ci><apply id="algorithm1.23.23.1.m1.1.1.2.cmml" xref="algorithm1.23.23.1.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.23.23.1.m1.1.1.2.1.cmml" xref="algorithm1.23.23.1.m1.1.1.2">subscript</csymbol><ci id="algorithm1.23.23.1.m1.1.1.2.2.cmml" xref="algorithm1.23.23.1.m1.1.1.2.2">𝑤</ci><apply id="algorithm1.23.23.1.m1.1.1.2.3.cmml" xref="algorithm1.23.23.1.m1.1.1.2.3"><plus id="algorithm1.23.23.1.m1.1.1.2.3.1.cmml" xref="algorithm1.23.23.1.m1.1.1.2.3.1"></plus><ci id="algorithm1.23.23.1.m1.1.1.2.3.2.cmml" xref="algorithm1.23.23.1.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.23.23.1.m1.1.1.2.3.3.cmml" xref="algorithm1.23.23.1.m1.1.1.2.3.3">1</cn></apply></apply><apply id="algorithm1.23.23.1.m1.1.1.3.cmml" xref="algorithm1.23.23.1.m1.1.1.3"><apply id="algorithm1.23.23.1.m1.1.1.3.1.cmml" xref="algorithm1.23.23.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="algorithm1.23.23.1.m1.1.1.3.1.1.cmml" xref="algorithm1.23.23.1.m1.1.1.3.1">subscript</csymbol><sum id="algorithm1.23.23.1.m1.1.1.3.1.2.cmml" xref="algorithm1.23.23.1.m1.1.1.3.1.2"></sum><apply id="algorithm1.23.23.1.m1.1.1.3.1.3.cmml" xref="algorithm1.23.23.1.m1.1.1.3.1.3"><in id="algorithm1.23.23.1.m1.1.1.3.1.3.1.cmml" xref="algorithm1.23.23.1.m1.1.1.3.1.3.1"></in><ci id="algorithm1.23.23.1.m1.1.1.3.1.3.2.cmml" xref="algorithm1.23.23.1.m1.1.1.3.1.3.2">𝑘</ci><apply id="algorithm1.23.23.1.m1.1.1.3.1.3.3.cmml" xref="algorithm1.23.23.1.m1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="algorithm1.23.23.1.m1.1.1.3.1.3.3.1.cmml" xref="algorithm1.23.23.1.m1.1.1.3.1.3.3">subscript</csymbol><ci id="algorithm1.23.23.1.m1.1.1.3.1.3.3.2.cmml" xref="algorithm1.23.23.1.m1.1.1.3.1.3.3.2">𝑆</ci><ci id="algorithm1.23.23.1.m1.1.1.3.1.3.3.3.cmml" xref="algorithm1.23.23.1.m1.1.1.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="algorithm1.23.23.1.m1.1.1.3.2.cmml" xref="algorithm1.23.23.1.m1.1.1.3.2"><times id="algorithm1.23.23.1.m1.1.1.3.2.1.cmml" xref="algorithm1.23.23.1.m1.1.1.3.2.1"></times><apply id="algorithm1.23.23.1.m1.1.1.3.2.2.cmml" xref="algorithm1.23.23.1.m1.1.1.3.2.2"><divide id="algorithm1.23.23.1.m1.1.1.3.2.2.1.cmml" xref="algorithm1.23.23.1.m1.1.1.3.2.2"></divide><apply id="algorithm1.23.23.1.m1.1.1.3.2.2.2.cmml" xref="algorithm1.23.23.1.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="algorithm1.23.23.1.m1.1.1.3.2.2.2.1.cmml" xref="algorithm1.23.23.1.m1.1.1.3.2.2.2">subscript</csymbol><ci id="algorithm1.23.23.1.m1.1.1.3.2.2.2.2.cmml" xref="algorithm1.23.23.1.m1.1.1.3.2.2.2.2">𝑛</ci><ci id="algorithm1.23.23.1.m1.1.1.3.2.2.2.3.cmml" xref="algorithm1.23.23.1.m1.1.1.3.2.2.2.3">𝑘</ci></apply><ci id="algorithm1.23.23.1.m1.1.1.3.2.2.3.cmml" xref="algorithm1.23.23.1.m1.1.1.3.2.2.3">𝑛</ci></apply><apply id="algorithm1.23.23.1.m1.1.1.3.2.3.cmml" xref="algorithm1.23.23.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="algorithm1.23.23.1.m1.1.1.3.2.3.1.cmml" xref="algorithm1.23.23.1.m1.1.1.3.2.3">superscript</csymbol><apply id="algorithm1.23.23.1.m1.1.1.3.2.3.2.cmml" xref="algorithm1.23.23.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="algorithm1.23.23.1.m1.1.1.3.2.3.2.1.cmml" xref="algorithm1.23.23.1.m1.1.1.3.2.3">subscript</csymbol><ci id="algorithm1.23.23.1.m1.1.1.3.2.3.2.2.cmml" xref="algorithm1.23.23.1.m1.1.1.3.2.3.2.2">𝑤</ci><apply id="algorithm1.23.23.1.m1.1.1.3.2.3.2.3.cmml" xref="algorithm1.23.23.1.m1.1.1.3.2.3.2.3"><plus id="algorithm1.23.23.1.m1.1.1.3.2.3.2.3.1.cmml" xref="algorithm1.23.23.1.m1.1.1.3.2.3.2.3.1"></plus><ci id="algorithm1.23.23.1.m1.1.1.3.2.3.2.3.2.cmml" xref="algorithm1.23.23.1.m1.1.1.3.2.3.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.23.23.1.m1.1.1.3.2.3.2.3.3.cmml" xref="algorithm1.23.23.1.m1.1.1.3.2.3.2.3.3">1</cn></apply></apply><ci id="algorithm1.23.23.1.m1.1.1.3.2.3.3.cmml" xref="algorithm1.23.23.1.m1.1.1.3.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.23.23.1.m1.1c">{w}_{t+1}\leftarrow\sum_{k\in S_{t}}\frac{n_{k}}{n}w_{t+1}^{k}</annotation></semantics></math> </span>
</div>
<div id="algorithm1.34.37" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm1.24.24" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm1.24.24.1" class="ltx_text ltx_font_bold">return</span> <math id="algorithm1.24.24.m1.1" class="ltx_Math" alttext="w_{T}" display="inline"><semantics id="algorithm1.24.24.m1.1a"><msub id="algorithm1.24.24.m1.1.1" xref="algorithm1.24.24.m1.1.1.cmml"><mi id="algorithm1.24.24.m1.1.1.2" xref="algorithm1.24.24.m1.1.1.2.cmml">w</mi><mi id="algorithm1.24.24.m1.1.1.3" xref="algorithm1.24.24.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.24.24.m1.1b"><apply id="algorithm1.24.24.m1.1.1.cmml" xref="algorithm1.24.24.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.1.1.1.cmml" xref="algorithm1.24.24.m1.1.1">subscript</csymbol><ci id="algorithm1.24.24.m1.1.1.2.cmml" xref="algorithm1.24.24.m1.1.1.2">𝑤</ci><ci id="algorithm1.24.24.m1.1.1.3.cmml" xref="algorithm1.24.24.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.24.24.m1.1c">w_{T}</annotation></semantics></math>

</div>
<div id="algorithm1.26.26" class="ltx_listingline">
<em id="algorithm1.26.26.2" class="ltx_emph ltx_font_italic"><span id="algorithm1.26.26.2.3" class="ltx_text ltx_font_bold">ClientUpdate</span><span id="algorithm1.26.26.2.2" class="ltx_text ltx_font_upright">(<math id="algorithm1.25.25.1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algorithm1.25.25.1.1.m1.1a"><mi id="algorithm1.25.25.1.1.m1.1.1" xref="algorithm1.25.25.1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algorithm1.25.25.1.1.m1.1b"><ci id="algorithm1.25.25.1.1.m1.1.1.cmml" xref="algorithm1.25.25.1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.25.25.1.1.m1.1c">k</annotation></semantics></math>, <math id="algorithm1.26.26.2.2.m2.1" class="ltx_Math" alttext="w_{t}" display="inline"><semantics id="algorithm1.26.26.2.2.m2.1a"><msub id="algorithm1.26.26.2.2.m2.1.1" xref="algorithm1.26.26.2.2.m2.1.1.cmml"><mi id="algorithm1.26.26.2.2.m2.1.1.2" xref="algorithm1.26.26.2.2.m2.1.1.2.cmml">w</mi><mi id="algorithm1.26.26.2.2.m2.1.1.3" xref="algorithm1.26.26.2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.26.26.2.2.m2.1b"><apply id="algorithm1.26.26.2.2.m2.1.1.cmml" xref="algorithm1.26.26.2.2.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.26.26.2.2.m2.1.1.1.cmml" xref="algorithm1.26.26.2.2.m2.1.1">subscript</csymbol><ci id="algorithm1.26.26.2.2.m2.1.1.2.cmml" xref="algorithm1.26.26.2.2.m2.1.1.2">𝑤</ci><ci id="algorithm1.26.26.2.2.m2.1.1.3.cmml" xref="algorithm1.26.26.2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.26.26.2.2.m2.1c">w_{t}</annotation></semantics></math>)</span></em><span id="algorithm1.26.26.3" class="ltx_text ltx_font_bold">:</span>
</div>
<div id="algorithm1.27.27" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.27.27.m1.1" class="ltx_Math" alttext="w_{t+1}^{k}\leftarrow w_{t}" display="inline"><semantics id="algorithm1.27.27.m1.1a"><mrow id="algorithm1.27.27.m1.1.1" xref="algorithm1.27.27.m1.1.1.cmml"><msubsup id="algorithm1.27.27.m1.1.1.2" xref="algorithm1.27.27.m1.1.1.2.cmml"><mi id="algorithm1.27.27.m1.1.1.2.2.2" xref="algorithm1.27.27.m1.1.1.2.2.2.cmml">w</mi><mrow id="algorithm1.27.27.m1.1.1.2.2.3" xref="algorithm1.27.27.m1.1.1.2.2.3.cmml"><mi id="algorithm1.27.27.m1.1.1.2.2.3.2" xref="algorithm1.27.27.m1.1.1.2.2.3.2.cmml">t</mi><mo id="algorithm1.27.27.m1.1.1.2.2.3.1" xref="algorithm1.27.27.m1.1.1.2.2.3.1.cmml">+</mo><mn id="algorithm1.27.27.m1.1.1.2.2.3.3" xref="algorithm1.27.27.m1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="algorithm1.27.27.m1.1.1.2.3" xref="algorithm1.27.27.m1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="algorithm1.27.27.m1.1.1.1" xref="algorithm1.27.27.m1.1.1.1.cmml">←</mo><msub id="algorithm1.27.27.m1.1.1.3" xref="algorithm1.27.27.m1.1.1.3.cmml"><mi id="algorithm1.27.27.m1.1.1.3.2" xref="algorithm1.27.27.m1.1.1.3.2.cmml">w</mi><mi id="algorithm1.27.27.m1.1.1.3.3" xref="algorithm1.27.27.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.27.27.m1.1b"><apply id="algorithm1.27.27.m1.1.1.cmml" xref="algorithm1.27.27.m1.1.1"><ci id="algorithm1.27.27.m1.1.1.1.cmml" xref="algorithm1.27.27.m1.1.1.1">←</ci><apply id="algorithm1.27.27.m1.1.1.2.cmml" xref="algorithm1.27.27.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.27.27.m1.1.1.2.1.cmml" xref="algorithm1.27.27.m1.1.1.2">superscript</csymbol><apply id="algorithm1.27.27.m1.1.1.2.2.cmml" xref="algorithm1.27.27.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.27.27.m1.1.1.2.2.1.cmml" xref="algorithm1.27.27.m1.1.1.2">subscript</csymbol><ci id="algorithm1.27.27.m1.1.1.2.2.2.cmml" xref="algorithm1.27.27.m1.1.1.2.2.2">𝑤</ci><apply id="algorithm1.27.27.m1.1.1.2.2.3.cmml" xref="algorithm1.27.27.m1.1.1.2.2.3"><plus id="algorithm1.27.27.m1.1.1.2.2.3.1.cmml" xref="algorithm1.27.27.m1.1.1.2.2.3.1"></plus><ci id="algorithm1.27.27.m1.1.1.2.2.3.2.cmml" xref="algorithm1.27.27.m1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.27.27.m1.1.1.2.2.3.3.cmml" xref="algorithm1.27.27.m1.1.1.2.2.3.3">1</cn></apply></apply><ci id="algorithm1.27.27.m1.1.1.2.3.cmml" xref="algorithm1.27.27.m1.1.1.2.3">𝑘</ci></apply><apply id="algorithm1.27.27.m1.1.1.3.cmml" xref="algorithm1.27.27.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.27.27.m1.1.1.3.1.cmml" xref="algorithm1.27.27.m1.1.1.3">subscript</csymbol><ci id="algorithm1.27.27.m1.1.1.3.2.cmml" xref="algorithm1.27.27.m1.1.1.3.2">𝑤</ci><ci id="algorithm1.27.27.m1.1.1.3.3.cmml" xref="algorithm1.27.27.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.27.27.m1.1c">w_{t+1}^{k}\leftarrow w_{t}</annotation></semantics></math> 
</div>
<div id="algorithm1.30.30" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.28.28.m1.1" class="ltx_Math" alttext="\mathcal{B}\leftarrow" display="inline"><semantics id="algorithm1.28.28.m1.1a"><mrow id="algorithm1.28.28.m1.1.1" xref="algorithm1.28.28.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.28.28.m1.1.1.2" xref="algorithm1.28.28.m1.1.1.2.cmml">ℬ</mi><mo stretchy="false" id="algorithm1.28.28.m1.1.1.1" xref="algorithm1.28.28.m1.1.1.1.cmml">←</mo><mi id="algorithm1.28.28.m1.1.1.3" xref="algorithm1.28.28.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.28.28.m1.1b"><apply id="algorithm1.28.28.m1.1.1.cmml" xref="algorithm1.28.28.m1.1.1"><ci id="algorithm1.28.28.m1.1.1.1.cmml" xref="algorithm1.28.28.m1.1.1.1">←</ci><ci id="algorithm1.28.28.m1.1.1.2.cmml" xref="algorithm1.28.28.m1.1.1.2">ℬ</ci><csymbol cd="latexml" id="algorithm1.28.28.m1.1.1.3.cmml" xref="algorithm1.28.28.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.28.28.m1.1c">\mathcal{B}\leftarrow</annotation></semantics></math> (split <math id="algorithm1.29.29.m2.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="algorithm1.29.29.m2.1a"><msub id="algorithm1.29.29.m2.1.1" xref="algorithm1.29.29.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.29.29.m2.1.1.2" xref="algorithm1.29.29.m2.1.1.2.cmml">𝒟</mi><mi id="algorithm1.29.29.m2.1.1.3" xref="algorithm1.29.29.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.29.29.m2.1b"><apply id="algorithm1.29.29.m2.1.1.cmml" xref="algorithm1.29.29.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.29.29.m2.1.1.1.cmml" xref="algorithm1.29.29.m2.1.1">subscript</csymbol><ci id="algorithm1.29.29.m2.1.1.2.cmml" xref="algorithm1.29.29.m2.1.1.2">𝒟</ci><ci id="algorithm1.29.29.m2.1.1.3.cmml" xref="algorithm1.29.29.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.29.29.m2.1c">\mathcal{D}_{k}</annotation></semantics></math> into batches of size <math id="algorithm1.30.30.m3.1" class="ltx_Math" alttext="B" display="inline"><semantics id="algorithm1.30.30.m3.1a"><mi id="algorithm1.30.30.m3.1.1" xref="algorithm1.30.30.m3.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="algorithm1.30.30.m3.1b"><ci id="algorithm1.30.30.m3.1.1.cmml" xref="algorithm1.30.30.m3.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.30.30.m3.1c">B</annotation></semantics></math>) 
</div>
<div id="algorithm1.31.31" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.31.31.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.31.31.1" class="ltx_emph ltx_font_italic">local epoch <math id="algorithm1.31.31.1.m1.3" class="ltx_Math" alttext="i=0,...,E-1" display="inline"><semantics id="algorithm1.31.31.1.m1.3a"><mrow id="algorithm1.31.31.1.m1.3.3" xref="algorithm1.31.31.1.m1.3.3.cmml"><mi id="algorithm1.31.31.1.m1.3.3.3" xref="algorithm1.31.31.1.m1.3.3.3.cmml">i</mi><mo id="algorithm1.31.31.1.m1.3.3.2" xref="algorithm1.31.31.1.m1.3.3.2.cmml">=</mo><mrow id="algorithm1.31.31.1.m1.3.3.1.1" xref="algorithm1.31.31.1.m1.3.3.1.2.cmml"><mn id="algorithm1.31.31.1.m1.1.1" xref="algorithm1.31.31.1.m1.1.1.cmml">0</mn><mo id="algorithm1.31.31.1.m1.3.3.1.1.2" xref="algorithm1.31.31.1.m1.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="algorithm1.31.31.1.m1.2.2" xref="algorithm1.31.31.1.m1.2.2.cmml">…</mi><mo id="algorithm1.31.31.1.m1.3.3.1.1.3" xref="algorithm1.31.31.1.m1.3.3.1.2.cmml">,</mo><mrow id="algorithm1.31.31.1.m1.3.3.1.1.1" xref="algorithm1.31.31.1.m1.3.3.1.1.1.cmml"><mi id="algorithm1.31.31.1.m1.3.3.1.1.1.2" xref="algorithm1.31.31.1.m1.3.3.1.1.1.2.cmml">E</mi><mo id="algorithm1.31.31.1.m1.3.3.1.1.1.1" xref="algorithm1.31.31.1.m1.3.3.1.1.1.1.cmml">−</mo><mn id="algorithm1.31.31.1.m1.3.3.1.1.1.3" xref="algorithm1.31.31.1.m1.3.3.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.31.31.1.m1.3b"><apply id="algorithm1.31.31.1.m1.3.3.cmml" xref="algorithm1.31.31.1.m1.3.3"><eq id="algorithm1.31.31.1.m1.3.3.2.cmml" xref="algorithm1.31.31.1.m1.3.3.2"></eq><ci id="algorithm1.31.31.1.m1.3.3.3.cmml" xref="algorithm1.31.31.1.m1.3.3.3">𝑖</ci><list id="algorithm1.31.31.1.m1.3.3.1.2.cmml" xref="algorithm1.31.31.1.m1.3.3.1.1"><cn type="integer" id="algorithm1.31.31.1.m1.1.1.cmml" xref="algorithm1.31.31.1.m1.1.1">0</cn><ci id="algorithm1.31.31.1.m1.2.2.cmml" xref="algorithm1.31.31.1.m1.2.2">…</ci><apply id="algorithm1.31.31.1.m1.3.3.1.1.1.cmml" xref="algorithm1.31.31.1.m1.3.3.1.1.1"><minus id="algorithm1.31.31.1.m1.3.3.1.1.1.1.cmml" xref="algorithm1.31.31.1.m1.3.3.1.1.1.1"></minus><ci id="algorithm1.31.31.1.m1.3.3.1.1.1.2.cmml" xref="algorithm1.31.31.1.m1.3.3.1.1.1.2">𝐸</ci><cn type="integer" id="algorithm1.31.31.1.m1.3.3.1.1.1.3.cmml" xref="algorithm1.31.31.1.m1.3.3.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.31.31.1.m1.3c">i=0,...,E-1</annotation></semantics></math></em> <span id="algorithm1.31.31.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="algorithm1.32.32" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.32.32.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.32.32.1" class="ltx_emph ltx_font_italic">batch <math id="algorithm1.32.32.1.m1.1" class="ltx_Math" alttext="b\in\mathcal{B}" display="inline"><semantics id="algorithm1.32.32.1.m1.1a"><mrow id="algorithm1.32.32.1.m1.1.1" xref="algorithm1.32.32.1.m1.1.1.cmml"><mi id="algorithm1.32.32.1.m1.1.1.2" xref="algorithm1.32.32.1.m1.1.1.2.cmml">b</mi><mo id="algorithm1.32.32.1.m1.1.1.1" xref="algorithm1.32.32.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="algorithm1.32.32.1.m1.1.1.3" xref="algorithm1.32.32.1.m1.1.1.3.cmml">ℬ</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.32.32.1.m1.1b"><apply id="algorithm1.32.32.1.m1.1.1.cmml" xref="algorithm1.32.32.1.m1.1.1"><in id="algorithm1.32.32.1.m1.1.1.1.cmml" xref="algorithm1.32.32.1.m1.1.1.1"></in><ci id="algorithm1.32.32.1.m1.1.1.2.cmml" xref="algorithm1.32.32.1.m1.1.1.2">𝑏</ci><ci id="algorithm1.32.32.1.m1.1.1.3.cmml" xref="algorithm1.32.32.1.m1.1.1.3">ℬ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.32.32.1.m1.1c">b\in\mathcal{B}</annotation></semantics></math></em> <span id="algorithm1.32.32.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="algorithm1.33.33" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.33.33.m1.2" class="ltx_Math" alttext="w_{t+1}^{k}\leftarrow w_{t+1}^{k}-\eta\nabla\ell(w_{t+1}^{k};b)" display="inline"><semantics id="algorithm1.33.33.m1.2a"><mrow id="algorithm1.33.33.m1.2.2" xref="algorithm1.33.33.m1.2.2.cmml"><msubsup id="algorithm1.33.33.m1.2.2.3" xref="algorithm1.33.33.m1.2.2.3.cmml"><mi id="algorithm1.33.33.m1.2.2.3.2.2" xref="algorithm1.33.33.m1.2.2.3.2.2.cmml">w</mi><mrow id="algorithm1.33.33.m1.2.2.3.2.3" xref="algorithm1.33.33.m1.2.2.3.2.3.cmml"><mi id="algorithm1.33.33.m1.2.2.3.2.3.2" xref="algorithm1.33.33.m1.2.2.3.2.3.2.cmml">t</mi><mo id="algorithm1.33.33.m1.2.2.3.2.3.1" xref="algorithm1.33.33.m1.2.2.3.2.3.1.cmml">+</mo><mn id="algorithm1.33.33.m1.2.2.3.2.3.3" xref="algorithm1.33.33.m1.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="algorithm1.33.33.m1.2.2.3.3" xref="algorithm1.33.33.m1.2.2.3.3.cmml">k</mi></msubsup><mo stretchy="false" id="algorithm1.33.33.m1.2.2.2" xref="algorithm1.33.33.m1.2.2.2.cmml">←</mo><mrow id="algorithm1.33.33.m1.2.2.1" xref="algorithm1.33.33.m1.2.2.1.cmml"><msubsup id="algorithm1.33.33.m1.2.2.1.3" xref="algorithm1.33.33.m1.2.2.1.3.cmml"><mi id="algorithm1.33.33.m1.2.2.1.3.2.2" xref="algorithm1.33.33.m1.2.2.1.3.2.2.cmml">w</mi><mrow id="algorithm1.33.33.m1.2.2.1.3.2.3" xref="algorithm1.33.33.m1.2.2.1.3.2.3.cmml"><mi id="algorithm1.33.33.m1.2.2.1.3.2.3.2" xref="algorithm1.33.33.m1.2.2.1.3.2.3.2.cmml">t</mi><mo id="algorithm1.33.33.m1.2.2.1.3.2.3.1" xref="algorithm1.33.33.m1.2.2.1.3.2.3.1.cmml">+</mo><mn id="algorithm1.33.33.m1.2.2.1.3.2.3.3" xref="algorithm1.33.33.m1.2.2.1.3.2.3.3.cmml">1</mn></mrow><mi id="algorithm1.33.33.m1.2.2.1.3.3" xref="algorithm1.33.33.m1.2.2.1.3.3.cmml">k</mi></msubsup><mo id="algorithm1.33.33.m1.2.2.1.2" xref="algorithm1.33.33.m1.2.2.1.2.cmml">−</mo><mrow id="algorithm1.33.33.m1.2.2.1.1" xref="algorithm1.33.33.m1.2.2.1.1.cmml"><mi id="algorithm1.33.33.m1.2.2.1.1.3" xref="algorithm1.33.33.m1.2.2.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="algorithm1.33.33.m1.2.2.1.1.2" xref="algorithm1.33.33.m1.2.2.1.1.2.cmml">​</mo><mrow id="algorithm1.33.33.m1.2.2.1.1.4" xref="algorithm1.33.33.m1.2.2.1.1.4.cmml"><mo rspace="0.167em" id="algorithm1.33.33.m1.2.2.1.1.4.1" xref="algorithm1.33.33.m1.2.2.1.1.4.1.cmml">∇</mo><mi mathvariant="normal" id="algorithm1.33.33.m1.2.2.1.1.4.2" xref="algorithm1.33.33.m1.2.2.1.1.4.2.cmml">ℓ</mi></mrow><mo lspace="0em" rspace="0em" id="algorithm1.33.33.m1.2.2.1.1.2a" xref="algorithm1.33.33.m1.2.2.1.1.2.cmml">​</mo><mrow id="algorithm1.33.33.m1.2.2.1.1.1.1" xref="algorithm1.33.33.m1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="algorithm1.33.33.m1.2.2.1.1.1.1.2" xref="algorithm1.33.33.m1.2.2.1.1.1.2.cmml">(</mo><msubsup id="algorithm1.33.33.m1.2.2.1.1.1.1.1" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1.cmml"><mi id="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.2" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.2.cmml">w</mi><mrow id="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.3" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.3.cmml"><mi id="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.3.2" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.3.1" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.3.3" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="algorithm1.33.33.m1.2.2.1.1.1.1.1.3" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="algorithm1.33.33.m1.2.2.1.1.1.1.3" xref="algorithm1.33.33.m1.2.2.1.1.1.2.cmml">;</mo><mi id="algorithm1.33.33.m1.1.1" xref="algorithm1.33.33.m1.1.1.cmml">b</mi><mo stretchy="false" id="algorithm1.33.33.m1.2.2.1.1.1.1.4" xref="algorithm1.33.33.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.33.33.m1.2b"><apply id="algorithm1.33.33.m1.2.2.cmml" xref="algorithm1.33.33.m1.2.2"><ci id="algorithm1.33.33.m1.2.2.2.cmml" xref="algorithm1.33.33.m1.2.2.2">←</ci><apply id="algorithm1.33.33.m1.2.2.3.cmml" xref="algorithm1.33.33.m1.2.2.3"><csymbol cd="ambiguous" id="algorithm1.33.33.m1.2.2.3.1.cmml" xref="algorithm1.33.33.m1.2.2.3">superscript</csymbol><apply id="algorithm1.33.33.m1.2.2.3.2.cmml" xref="algorithm1.33.33.m1.2.2.3"><csymbol cd="ambiguous" id="algorithm1.33.33.m1.2.2.3.2.1.cmml" xref="algorithm1.33.33.m1.2.2.3">subscript</csymbol><ci id="algorithm1.33.33.m1.2.2.3.2.2.cmml" xref="algorithm1.33.33.m1.2.2.3.2.2">𝑤</ci><apply id="algorithm1.33.33.m1.2.2.3.2.3.cmml" xref="algorithm1.33.33.m1.2.2.3.2.3"><plus id="algorithm1.33.33.m1.2.2.3.2.3.1.cmml" xref="algorithm1.33.33.m1.2.2.3.2.3.1"></plus><ci id="algorithm1.33.33.m1.2.2.3.2.3.2.cmml" xref="algorithm1.33.33.m1.2.2.3.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.33.33.m1.2.2.3.2.3.3.cmml" xref="algorithm1.33.33.m1.2.2.3.2.3.3">1</cn></apply></apply><ci id="algorithm1.33.33.m1.2.2.3.3.cmml" xref="algorithm1.33.33.m1.2.2.3.3">𝑘</ci></apply><apply id="algorithm1.33.33.m1.2.2.1.cmml" xref="algorithm1.33.33.m1.2.2.1"><minus id="algorithm1.33.33.m1.2.2.1.2.cmml" xref="algorithm1.33.33.m1.2.2.1.2"></minus><apply id="algorithm1.33.33.m1.2.2.1.3.cmml" xref="algorithm1.33.33.m1.2.2.1.3"><csymbol cd="ambiguous" id="algorithm1.33.33.m1.2.2.1.3.1.cmml" xref="algorithm1.33.33.m1.2.2.1.3">superscript</csymbol><apply id="algorithm1.33.33.m1.2.2.1.3.2.cmml" xref="algorithm1.33.33.m1.2.2.1.3"><csymbol cd="ambiguous" id="algorithm1.33.33.m1.2.2.1.3.2.1.cmml" xref="algorithm1.33.33.m1.2.2.1.3">subscript</csymbol><ci id="algorithm1.33.33.m1.2.2.1.3.2.2.cmml" xref="algorithm1.33.33.m1.2.2.1.3.2.2">𝑤</ci><apply id="algorithm1.33.33.m1.2.2.1.3.2.3.cmml" xref="algorithm1.33.33.m1.2.2.1.3.2.3"><plus id="algorithm1.33.33.m1.2.2.1.3.2.3.1.cmml" xref="algorithm1.33.33.m1.2.2.1.3.2.3.1"></plus><ci id="algorithm1.33.33.m1.2.2.1.3.2.3.2.cmml" xref="algorithm1.33.33.m1.2.2.1.3.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.33.33.m1.2.2.1.3.2.3.3.cmml" xref="algorithm1.33.33.m1.2.2.1.3.2.3.3">1</cn></apply></apply><ci id="algorithm1.33.33.m1.2.2.1.3.3.cmml" xref="algorithm1.33.33.m1.2.2.1.3.3">𝑘</ci></apply><apply id="algorithm1.33.33.m1.2.2.1.1.cmml" xref="algorithm1.33.33.m1.2.2.1.1"><times id="algorithm1.33.33.m1.2.2.1.1.2.cmml" xref="algorithm1.33.33.m1.2.2.1.1.2"></times><ci id="algorithm1.33.33.m1.2.2.1.1.3.cmml" xref="algorithm1.33.33.m1.2.2.1.1.3">𝜂</ci><apply id="algorithm1.33.33.m1.2.2.1.1.4.cmml" xref="algorithm1.33.33.m1.2.2.1.1.4"><ci id="algorithm1.33.33.m1.2.2.1.1.4.1.cmml" xref="algorithm1.33.33.m1.2.2.1.1.4.1">∇</ci><ci id="algorithm1.33.33.m1.2.2.1.1.4.2.cmml" xref="algorithm1.33.33.m1.2.2.1.1.4.2">ℓ</ci></apply><list id="algorithm1.33.33.m1.2.2.1.1.1.2.cmml" xref="algorithm1.33.33.m1.2.2.1.1.1.1"><apply id="algorithm1.33.33.m1.2.2.1.1.1.1.1.cmml" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.33.33.m1.2.2.1.1.1.1.1.1.cmml" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1">superscript</csymbol><apply id="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.cmml" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.1.cmml" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.2.cmml" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.2">𝑤</ci><apply id="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.3.cmml" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.3"><plus id="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.3.1.cmml" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.3.1"></plus><ci id="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.3.2.cmml" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.3.3.cmml" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="algorithm1.33.33.m1.2.2.1.1.1.1.1.3.cmml" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1.3">𝑘</ci></apply><ci id="algorithm1.33.33.m1.1.1.cmml" xref="algorithm1.33.33.m1.1.1">𝑏</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.33.33.m1.2c">w_{t+1}^{k}\leftarrow w_{t+1}^{k}-\eta\nabla\ell(w_{t+1}^{k};b)</annotation></semantics></math>

</div>
<div id="algorithm1.34.34" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm1.34.34.1" class="ltx_text ltx_font_bold">return</span> <math id="algorithm1.34.34.m1.1" class="ltx_Math" alttext="w_{t+1}^{k}" display="inline"><semantics id="algorithm1.34.34.m1.1a"><msubsup id="algorithm1.34.34.m1.1.1" xref="algorithm1.34.34.m1.1.1.cmml"><mi id="algorithm1.34.34.m1.1.1.2.2" xref="algorithm1.34.34.m1.1.1.2.2.cmml">w</mi><mrow id="algorithm1.34.34.m1.1.1.2.3" xref="algorithm1.34.34.m1.1.1.2.3.cmml"><mi id="algorithm1.34.34.m1.1.1.2.3.2" xref="algorithm1.34.34.m1.1.1.2.3.2.cmml">t</mi><mo id="algorithm1.34.34.m1.1.1.2.3.1" xref="algorithm1.34.34.m1.1.1.2.3.1.cmml">+</mo><mn id="algorithm1.34.34.m1.1.1.2.3.3" xref="algorithm1.34.34.m1.1.1.2.3.3.cmml">1</mn></mrow><mi id="algorithm1.34.34.m1.1.1.3" xref="algorithm1.34.34.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.34.34.m1.1b"><apply id="algorithm1.34.34.m1.1.1.cmml" xref="algorithm1.34.34.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.34.34.m1.1.1.1.cmml" xref="algorithm1.34.34.m1.1.1">superscript</csymbol><apply id="algorithm1.34.34.m1.1.1.2.cmml" xref="algorithm1.34.34.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.34.34.m1.1.1.2.1.cmml" xref="algorithm1.34.34.m1.1.1">subscript</csymbol><ci id="algorithm1.34.34.m1.1.1.2.2.cmml" xref="algorithm1.34.34.m1.1.1.2.2">𝑤</ci><apply id="algorithm1.34.34.m1.1.1.2.3.cmml" xref="algorithm1.34.34.m1.1.1.2.3"><plus id="algorithm1.34.34.m1.1.1.2.3.1.cmml" xref="algorithm1.34.34.m1.1.1.2.3.1"></plus><ci id="algorithm1.34.34.m1.1.1.2.3.2.cmml" xref="algorithm1.34.34.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.34.34.m1.1.1.2.3.3.cmml" xref="algorithm1.34.34.m1.1.1.2.3.3">1</cn></apply></apply><ci id="algorithm1.34.34.m1.1.1.3.cmml" xref="algorithm1.34.34.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.34.34.m1.1c">w_{t+1}^{k}</annotation></semantics></math>

</div>
<div id="algorithm1.34.38" class="ltx_listingline">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.37.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>Federated Averaging with <span id="algorithm1.38.2" class="ltx_text" style="color:#BF0040;">Gradient Harmonization (<span id="algorithm1.38.2.1" class="ltx_text ltx_font_typewriter">FedGH</span>)</span></figcaption>
</figure>
<figure id="S3.F3" class="ltx_figure ltx_minipage ltx_align_middle" style="width:173.4pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.06692/assets/x7.png" id="S3.F3.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="166" height="86" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S3.F3.sf1.3.2" class="ltx_text" style="font-size:90%;">Faster convergence rate.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.06692/assets/x8.png" id="S3.F3.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="166" height="86" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S3.F3.sf2.3.2" class="ltx_text" style="font-size:90%;">Mitigating local drifts.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.12.6.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S3.F3.10.5" class="ltx_text" style="font-size:90%;">Illustration of FedGH’s effectiveness. If gradient conflict occurs between clients <math id="S3.F3.6.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.F3.6.1.m1.1b"><mi id="S3.F3.6.1.m1.1.1" xref="S3.F3.6.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.F3.6.1.m1.1c"><ci id="S3.F3.6.1.m1.1.1.cmml" xref="S3.F3.6.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.6.1.m1.1d">i</annotation></semantics></math> and <math id="S3.F3.7.2.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.F3.7.2.m2.1b"><mi id="S3.F3.7.2.m2.1.1" xref="S3.F3.7.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.F3.7.2.m2.1c"><ci id="S3.F3.7.2.m2.1.1.cmml" xref="S3.F3.7.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.7.2.m2.1d">j</annotation></semantics></math> in round <math id="S3.F3.8.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.F3.8.3.m3.1b"><mi id="S3.F3.8.3.m3.1.1" xref="S3.F3.8.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.F3.8.3.m3.1c"><ci id="S3.F3.8.3.m3.1.1.cmml" xref="S3.F3.8.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.8.3.m3.1d">t</annotation></semantics></math>, FedGH projects <math id="S3.F3.9.4.m4.1" class="ltx_Math" alttext="g_{t}^{i}" display="inline"><semantics id="S3.F3.9.4.m4.1b"><msubsup id="S3.F3.9.4.m4.1.1" xref="S3.F3.9.4.m4.1.1.cmml"><mi id="S3.F3.9.4.m4.1.1.2.2" xref="S3.F3.9.4.m4.1.1.2.2.cmml">g</mi><mi id="S3.F3.9.4.m4.1.1.2.3" xref="S3.F3.9.4.m4.1.1.2.3.cmml">t</mi><mi id="S3.F3.9.4.m4.1.1.3" xref="S3.F3.9.4.m4.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.F3.9.4.m4.1c"><apply id="S3.F3.9.4.m4.1.1.cmml" xref="S3.F3.9.4.m4.1.1"><csymbol cd="ambiguous" id="S3.F3.9.4.m4.1.1.1.cmml" xref="S3.F3.9.4.m4.1.1">superscript</csymbol><apply id="S3.F3.9.4.m4.1.1.2.cmml" xref="S3.F3.9.4.m4.1.1"><csymbol cd="ambiguous" id="S3.F3.9.4.m4.1.1.2.1.cmml" xref="S3.F3.9.4.m4.1.1">subscript</csymbol><ci id="S3.F3.9.4.m4.1.1.2.2.cmml" xref="S3.F3.9.4.m4.1.1.2.2">𝑔</ci><ci id="S3.F3.9.4.m4.1.1.2.3.cmml" xref="S3.F3.9.4.m4.1.1.2.3">𝑡</ci></apply><ci id="S3.F3.9.4.m4.1.1.3.cmml" xref="S3.F3.9.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.9.4.m4.1d">g_{t}^{i}</annotation></semantics></math> and <math id="S3.F3.10.5.m5.1" class="ltx_Math" alttext="g_{t}^{j}" display="inline"><semantics id="S3.F3.10.5.m5.1b"><msubsup id="S3.F3.10.5.m5.1.1" xref="S3.F3.10.5.m5.1.1.cmml"><mi id="S3.F3.10.5.m5.1.1.2.2" xref="S3.F3.10.5.m5.1.1.2.2.cmml">g</mi><mi id="S3.F3.10.5.m5.1.1.2.3" xref="S3.F3.10.5.m5.1.1.2.3.cmml">t</mi><mi id="S3.F3.10.5.m5.1.1.3" xref="S3.F3.10.5.m5.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.F3.10.5.m5.1c"><apply id="S3.F3.10.5.m5.1.1.cmml" xref="S3.F3.10.5.m5.1.1"><csymbol cd="ambiguous" id="S3.F3.10.5.m5.1.1.1.cmml" xref="S3.F3.10.5.m5.1.1">superscript</csymbol><apply id="S3.F3.10.5.m5.1.1.2.cmml" xref="S3.F3.10.5.m5.1.1"><csymbol cd="ambiguous" id="S3.F3.10.5.m5.1.1.2.1.cmml" xref="S3.F3.10.5.m5.1.1">subscript</csymbol><ci id="S3.F3.10.5.m5.1.1.2.2.cmml" xref="S3.F3.10.5.m5.1.1.2.2">𝑔</ci><ci id="S3.F3.10.5.m5.1.1.2.3.cmml" xref="S3.F3.10.5.m5.1.1.2.3">𝑡</ci></apply><ci id="S3.F3.10.5.m5.1.1.3.cmml" xref="S3.F3.10.5.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.10.5.m5.1d">g_{t}^{j}</annotation></semantics></math> onto each other’s orthogonal planes. We highlight that FedGH yields a faster convergence rate in (a) while effectively mitigating local drifts from global minima in (b).</span></figcaption>
</figure>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Implementation Details</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.2" class="ltx_p">We reproduce four competitive FL baselines,
including FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib17" title="" class="ltx_ref">2017</a>)</cite>, FedProx <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite>, FedNova <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib28" title="" class="ltx_ref">2020b</a>)</cite>, and the state-of-the-art FedDecorr <cite class="ltx_cite ltx_citemacro_citep">(Shi et al., <a href="#bib.bib24" title="" class="ltx_ref">2022</a>)</cite>,
based on the code implementation from <cite class="ltx_cite ltx_citemacro_cite">Shi et al. (<a href="#bib.bib24" title="" class="ltx_ref">2022</a>)</cite>. Noteworthy, FedProx and FedDecorr address the non-IID issue in the local training step,
while FedNova and the proposed FedGH tackle it during the server aggregation step.
To achieve optimal performance, we set <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\mu</annotation></semantics></math> and <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\beta</annotation></semantics></math> to 0.1 in FedProx and FedDecorr, respectively.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">We conduct extensive experiments in three widely used benchmarks:
CIFAR-10 (50,000 training samples, 10,000 test samples with 10 classes),
CIFAR-100 (50,000 training samples, 10,000 test samples with 100 classes),
and Tiny-ImageNet (100,000 training samples, 10,000 test samples with 200 classes).
For CIFAR-10, we use a CNN model with two convolution layers <cite class="ltx_cite ltx_citemacro_citep">(Reddi et al., <a href="#bib.bib22" title="" class="ltx_ref">2020</a>)</cite>, as mentioned in Sec. <a href="#S3.SS2" title="3.2 Gradient Conflict in Heterogeneous FL ‣ 3 Methodology ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>.
For the more challenging CIFAR-100 and Tiny-ImageNet, we employ the MobileNetV2 <cite class="ltx_cite ltx_citemacro_citep">(Sandler et al., <a href="#bib.bib23" title="" class="ltx_ref">2018</a>)</cite> as the backbone, following <cite class="ltx_cite ltx_citemacro_citep">(Shi et al., <a href="#bib.bib24" title="" class="ltx_ref">2022</a>)</cite>.
Our experiments are implemented on an NVIDIA GeForce RTX 3090 GPU using Pytorch 2.0.0.
For all datasets, we partition the data into 20 clients with Autoaugment <cite class="ltx_cite ltx_citemacro_citep">(Cubuk et al., <a href="#bib.bib4" title="" class="ltx_ref">2018</a>)</cite>.
During local training, we use the SGD optimizer with a momentum of 0.9.
The learning rate and the batch size are set to 0.01 and 64, respectively.
We train each client for 5 local epochs and conduct 100 communication rounds for CIFAR-10 and CIFAR-100,
and 50 communication rounds for Tiny-ImageNet, unless otherwise specified.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.6" class="ltx_p">To validate the effectiveness of FedGH, we simulate multiple non-IID scenarios from cross-silo and cross-device perspectives <cite class="ltx_cite ltx_citemacro_citep">(Reddi et al., <a href="#bib.bib22" title="" class="ltx_ref">2020</a>)</cite>.
First, we generate <em id="S4.SS1.p3.6.1" class="ltx_emph ltx_font_italic">heterogeneous data</em> using the Dirichlet distribution detailed in Sec. <a href="#S3.SS2" title="3.2 Gradient Conflict in Heterogeneous FL ‣ 3 Methodology ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>.
Specifically, for CIFAR-10, we disperse three datasets with <math id="S4.SS1.p3.1.m1.2" class="ltx_Math" alttext="\alpha\in\{0.1,1.0\}" display="inline"><semantics id="S4.SS1.p3.1.m1.2a"><mrow id="S4.SS1.p3.1.m1.2.3" xref="S4.SS1.p3.1.m1.2.3.cmml"><mi id="S4.SS1.p3.1.m1.2.3.2" xref="S4.SS1.p3.1.m1.2.3.2.cmml">α</mi><mo id="S4.SS1.p3.1.m1.2.3.1" xref="S4.SS1.p3.1.m1.2.3.1.cmml">∈</mo><mrow id="S4.SS1.p3.1.m1.2.3.3.2" xref="S4.SS1.p3.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p3.1.m1.2.3.3.2.1" xref="S4.SS1.p3.1.m1.2.3.3.1.cmml">{</mo><mn id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">0.1</mn><mo id="S4.SS1.p3.1.m1.2.3.3.2.2" xref="S4.SS1.p3.1.m1.2.3.3.1.cmml">,</mo><mn id="S4.SS1.p3.1.m1.2.2" xref="S4.SS1.p3.1.m1.2.2.cmml">1.0</mn><mo stretchy="false" id="S4.SS1.p3.1.m1.2.3.3.2.3" xref="S4.SS1.p3.1.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.2b"><apply id="S4.SS1.p3.1.m1.2.3.cmml" xref="S4.SS1.p3.1.m1.2.3"><in id="S4.SS1.p3.1.m1.2.3.1.cmml" xref="S4.SS1.p3.1.m1.2.3.1"></in><ci id="S4.SS1.p3.1.m1.2.3.2.cmml" xref="S4.SS1.p3.1.m1.2.3.2">𝛼</ci><set id="S4.SS1.p3.1.m1.2.3.3.1.cmml" xref="S4.SS1.p3.1.m1.2.3.3.2"><cn type="float" id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">0.1</cn><cn type="float" id="S4.SS1.p3.1.m1.2.2.cmml" xref="S4.SS1.p3.1.m1.2.2">1.0</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.2c">\alpha\in\{0.1,1.0\}</annotation></semantics></math>.
As for CIFAR-100 and Tiny-ImageNet, we set <math id="S4.SS1.p3.2.m2.2" class="ltx_Math" alttext="\alpha\in\{0.01,0.1\}" display="inline"><semantics id="S4.SS1.p3.2.m2.2a"><mrow id="S4.SS1.p3.2.m2.2.3" xref="S4.SS1.p3.2.m2.2.3.cmml"><mi id="S4.SS1.p3.2.m2.2.3.2" xref="S4.SS1.p3.2.m2.2.3.2.cmml">α</mi><mo id="S4.SS1.p3.2.m2.2.3.1" xref="S4.SS1.p3.2.m2.2.3.1.cmml">∈</mo><mrow id="S4.SS1.p3.2.m2.2.3.3.2" xref="S4.SS1.p3.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p3.2.m2.2.3.3.2.1" xref="S4.SS1.p3.2.m2.2.3.3.1.cmml">{</mo><mn id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">0.01</mn><mo id="S4.SS1.p3.2.m2.2.3.3.2.2" xref="S4.SS1.p3.2.m2.2.3.3.1.cmml">,</mo><mn id="S4.SS1.p3.2.m2.2.2" xref="S4.SS1.p3.2.m2.2.2.cmml">0.1</mn><mo stretchy="false" id="S4.SS1.p3.2.m2.2.3.3.2.3" xref="S4.SS1.p3.2.m2.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.2b"><apply id="S4.SS1.p3.2.m2.2.3.cmml" xref="S4.SS1.p3.2.m2.2.3"><in id="S4.SS1.p3.2.m2.2.3.1.cmml" xref="S4.SS1.p3.2.m2.2.3.1"></in><ci id="S4.SS1.p3.2.m2.2.3.2.cmml" xref="S4.SS1.p3.2.m2.2.3.2">𝛼</ci><set id="S4.SS1.p3.2.m2.2.3.3.1.cmml" xref="S4.SS1.p3.2.m2.2.3.3.2"><cn type="float" id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">0.01</cn><cn type="float" id="S4.SS1.p3.2.m2.2.2.cmml" xref="S4.SS1.p3.2.m2.2.2">0.1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.2c">\alpha\in\{0.01,0.1\}</annotation></semantics></math>. Also, we follow <cite class="ltx_cite ltx_citemacro_citep">(Zhuang et al., <a href="#bib.bib34" title="" class="ltx_ref">2022</a>, <a href="#bib.bib33" title="" class="ltx_ref">2021</a>)</cite> to split the dataset into <math id="S4.SS1.p3.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS1.p3.3.m3.1a"><mi id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><ci id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">K</annotation></semantics></math> clients based on
different classes, resulting in each client containing <math id="S4.SS1.p3.4.m4.1" class="ltx_Math" alttext="\frac{100}{K}" display="inline"><semantics id="S4.SS1.p3.4.m4.1a"><mfrac id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml"><mn id="S4.SS1.p3.4.m4.1.1.2" xref="S4.SS1.p3.4.m4.1.1.2.cmml">100</mn><mi id="S4.SS1.p3.4.m4.1.1.3" xref="S4.SS1.p3.4.m4.1.1.3.cmml">K</mi></mfrac><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"><divide id="S4.SS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"></divide><cn type="integer" id="S4.SS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2">100</cn><ci id="S4.SS1.p3.4.m4.1.1.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">\frac{100}{K}</annotation></semantics></math> and <math id="S4.SS1.p3.5.m5.1" class="ltx_Math" alttext="\frac{200}{K}" display="inline"><semantics id="S4.SS1.p3.5.m5.1a"><mfrac id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml"><mn id="S4.SS1.p3.5.m5.1.1.2" xref="S4.SS1.p3.5.m5.1.1.2.cmml">200</mn><mi id="S4.SS1.p3.5.m5.1.1.3" xref="S4.SS1.p3.5.m5.1.1.3.cmml">K</mi></mfrac><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><apply id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1"><divide id="S4.SS1.p3.5.m5.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1"></divide><cn type="integer" id="S4.SS1.p3.5.m5.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.2">200</cn><ci id="S4.SS1.p3.5.m5.1.1.3.cmml" xref="S4.SS1.p3.5.m5.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">\frac{200}{K}</annotation></semantics></math> classes for CIFAR-100 and Tiny-ImageNet, respectively.
Moreover, we simulate <em id="S4.SS1.p3.6.2" class="ltx_emph ltx_font_italic">heterogeneous devices</em> by randomly selecting 20 out of 100 clients in each communication round,
denoted as the client fraction <math id="S4.SS1.p3.6.m6.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS1.p3.6.m6.1a"><mi id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.1b"><ci id="S4.SS1.p3.6.m6.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.1c">C</annotation></semantics></math> = 0.2.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Performance Boosting</h3>

<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.12" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.12.13.1" class="ltx_tr">
<th id="S4.T1.12.13.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="2"><span id="S4.T1.12.13.1.1.1" class="ltx_text">Method</span></th>
<th id="S4.T1.12.13.1.2" class="ltx_td ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<th id="S4.T1.12.13.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="3">CIFAR-10 (%)</th>
<th id="S4.T1.12.13.1.4" class="ltx_td ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<th id="S4.T1.12.13.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="3">CIFAR-100 (%)</th>
</tr>
<tr id="S4.T1.12.12" class="ltx_tr">
<th id="S4.T1.12.12.13" class="ltx_td ltx_th ltx_th_column" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<th id="S4.T1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<table id="S4.T1.2.2.2.2" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.1.1.1.1.1" class="ltx_tr">
<td id="S4.T1.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<math id="S4.T1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T1.1.1.1.1.1.1.m1.1a"><mi id="S4.T1.1.1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.1.1.m1.1c">\alpha</annotation></semantics></math> = 0.1</td>
</tr>
<tr id="S4.T1.2.2.2.2.2" class="ltx_tr">
<td id="S4.T1.2.2.2.2.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<math id="S4.T1.2.2.2.2.2.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.T1.2.2.2.2.2.1.m1.1a"><mi id="S4.T1.2.2.2.2.2.1.m1.1.1" xref="S4.T1.2.2.2.2.2.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.2.2.1.m1.1b"><ci id="S4.T1.2.2.2.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.2.2.2.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.2.2.1.m1.1c">C</annotation></semantics></math> = 1.0</td>
</tr>
</table>
</th>
<th id="S4.T1.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<table id="S4.T1.4.4.4.2" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.3.3.3.1.1" class="ltx_tr">
<td id="S4.T1.3.3.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<math id="S4.T1.3.3.3.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T1.3.3.3.1.1.1.m1.1a"><mi id="S4.T1.3.3.3.1.1.1.m1.1.1" xref="S4.T1.3.3.3.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.1.1.1.m1.1b"><ci id="S4.T1.3.3.3.1.1.1.m1.1.1.cmml" xref="S4.T1.3.3.3.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.1.1.1.m1.1c">\alpha</annotation></semantics></math> = 1.0</td>
</tr>
<tr id="S4.T1.4.4.4.2.2" class="ltx_tr">
<td id="S4.T1.4.4.4.2.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<math id="S4.T1.4.4.4.2.2.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.T1.4.4.4.2.2.1.m1.1a"><mi id="S4.T1.4.4.4.2.2.1.m1.1.1" xref="S4.T1.4.4.4.2.2.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.2.2.1.m1.1b"><ci id="S4.T1.4.4.4.2.2.1.m1.1.1.cmml" xref="S4.T1.4.4.4.2.2.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.2.2.1.m1.1c">C</annotation></semantics></math> = 0.2</td>
</tr>
</table>
</th>
<th id="S4.T1.6.6.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<table id="S4.T1.6.6.6.2" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.5.5.5.1.1" class="ltx_tr">
<td id="S4.T1.5.5.5.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<math id="S4.T1.5.5.5.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T1.5.5.5.1.1.1.m1.1a"><mi id="S4.T1.5.5.5.1.1.1.m1.1.1" xref="S4.T1.5.5.5.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.5.1.1.1.m1.1b"><ci id="S4.T1.5.5.5.1.1.1.m1.1.1.cmml" xref="S4.T1.5.5.5.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.5.1.1.1.m1.1c">\alpha</annotation></semantics></math> = 1.0</td>
</tr>
<tr id="S4.T1.6.6.6.2.2" class="ltx_tr">
<td id="S4.T1.6.6.6.2.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<math id="S4.T1.6.6.6.2.2.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.T1.6.6.6.2.2.1.m1.1a"><mi id="S4.T1.6.6.6.2.2.1.m1.1.1" xref="S4.T1.6.6.6.2.2.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.6.2.2.1.m1.1b"><ci id="S4.T1.6.6.6.2.2.1.m1.1.1.cmml" xref="S4.T1.6.6.6.2.2.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.6.2.2.1.m1.1c">C</annotation></semantics></math> = 1.0</td>
</tr>
</table>
</th>
<th id="S4.T1.12.12.14" class="ltx_td ltx_th ltx_th_column" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<th id="S4.T1.8.8.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<table id="S4.T1.8.8.8.2" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.7.7.7.1.1" class="ltx_tr">
<td id="S4.T1.7.7.7.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<math id="S4.T1.7.7.7.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T1.7.7.7.1.1.1.m1.1a"><mi id="S4.T1.7.7.7.1.1.1.m1.1.1" xref="S4.T1.7.7.7.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T1.7.7.7.1.1.1.m1.1b"><ci id="S4.T1.7.7.7.1.1.1.m1.1.1.cmml" xref="S4.T1.7.7.7.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.7.7.1.1.1.m1.1c">\alpha</annotation></semantics></math> = 0.01</td>
</tr>
<tr id="S4.T1.8.8.8.2.2" class="ltx_tr">
<td id="S4.T1.8.8.8.2.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<math id="S4.T1.8.8.8.2.2.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.T1.8.8.8.2.2.1.m1.1a"><mi id="S4.T1.8.8.8.2.2.1.m1.1.1" xref="S4.T1.8.8.8.2.2.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.T1.8.8.8.2.2.1.m1.1b"><ci id="S4.T1.8.8.8.2.2.1.m1.1.1.cmml" xref="S4.T1.8.8.8.2.2.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.8.8.2.2.1.m1.1c">C</annotation></semantics></math> = 1.0</td>
</tr>
</table>
</th>
<th id="S4.T1.10.10.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<table id="S4.T1.10.10.10.2" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.9.9.9.1.1" class="ltx_tr">
<td id="S4.T1.9.9.9.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<math id="S4.T1.9.9.9.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T1.9.9.9.1.1.1.m1.1a"><mi id="S4.T1.9.9.9.1.1.1.m1.1.1" xref="S4.T1.9.9.9.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T1.9.9.9.1.1.1.m1.1b"><ci id="S4.T1.9.9.9.1.1.1.m1.1.1.cmml" xref="S4.T1.9.9.9.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.9.9.1.1.1.m1.1c">\alpha</annotation></semantics></math> = 0.1</td>
</tr>
<tr id="S4.T1.10.10.10.2.2" class="ltx_tr">
<td id="S4.T1.10.10.10.2.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<math id="S4.T1.10.10.10.2.2.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.T1.10.10.10.2.2.1.m1.1a"><mi id="S4.T1.10.10.10.2.2.1.m1.1.1" xref="S4.T1.10.10.10.2.2.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.T1.10.10.10.2.2.1.m1.1b"><ci id="S4.T1.10.10.10.2.2.1.m1.1.1.cmml" xref="S4.T1.10.10.10.2.2.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.10.10.2.2.1.m1.1c">C</annotation></semantics></math> = 0.2</td>
</tr>
</table>
</th>
<th id="S4.T1.12.12.12" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<table id="S4.T1.12.12.12.2" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.11.11.11.1.1" class="ltx_tr">
<td id="S4.T1.11.11.11.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<math id="S4.T1.11.11.11.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T1.11.11.11.1.1.1.m1.1a"><mi id="S4.T1.11.11.11.1.1.1.m1.1.1" xref="S4.T1.11.11.11.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T1.11.11.11.1.1.1.m1.1b"><ci id="S4.T1.11.11.11.1.1.1.m1.1.1.cmml" xref="S4.T1.11.11.11.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.11.11.1.1.1.m1.1c">\alpha</annotation></semantics></math> = 0.1</td>
</tr>
<tr id="S4.T1.12.12.12.2.2" class="ltx_tr">
<td id="S4.T1.12.12.12.2.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<math id="S4.T1.12.12.12.2.2.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.T1.12.12.12.2.2.1.m1.1a"><mi id="S4.T1.12.12.12.2.2.1.m1.1.1" xref="S4.T1.12.12.12.2.2.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.T1.12.12.12.2.2.1.m1.1b"><ci id="S4.T1.12.12.12.2.2.1.m1.1.1.cmml" xref="S4.T1.12.12.12.2.2.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.12.12.12.2.2.1.m1.1c">C</annotation></semantics></math> = 1.0</td>
</tr>
</table>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.12.14.1" class="ltx_tr">
<td id="S4.T1.12.14.1.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedAvg</td>
<td id="S4.T1.12.14.1.2" class="ltx_td ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T1.12.14.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">68.66</td>
<td id="S4.T1.12.14.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.40</td>
<td id="S4.T1.12.14.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">75.28</td>
<td id="S4.T1.12.14.1.6" class="ltx_td ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T1.12.14.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">41.00</td>
<td id="S4.T1.12.14.1.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">42.15</td>
<td id="S4.T1.12.14.1.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">61.50</td>
</tr>
<tr id="S4.T1.12.15.2" class="ltx_tr">
<td id="S4.T1.12.15.2.1" class="ltx_td ltx_align_left" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.15.2.1.1" class="ltx_text" style="background-color:#DCDCDC;">+ FedGH</span></td>
<td id="S4.T1.12.15.2.2" class="ltx_td" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T1.12.15.2.3" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.15.2.3.1" class="ltx_text" style="background-color:#DCDCDC;">70.67</span></td>
<td id="S4.T1.12.15.2.4" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.15.2.4.1" class="ltx_text" style="background-color:#DCDCDC;">66.00</span></td>
<td id="S4.T1.12.15.2.5" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.15.2.5.1" class="ltx_text" style="background-color:#DCDCDC;">75.61</span></td>
<td id="S4.T1.12.15.2.6" class="ltx_td" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T1.12.15.2.7" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.15.2.7.1" class="ltx_text" style="background-color:#DCDCDC;">43.86</span></td>
<td id="S4.T1.12.15.2.8" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.15.2.8.1" class="ltx_text" style="background-color:#DCDCDC;">45.80</span></td>
<td id="S4.T1.12.15.2.9" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.15.2.9.1" class="ltx_text" style="background-color:#DCDCDC;">62.68</span></td>
</tr>
<tr id="S4.T1.12.16.3" class="ltx_tr">
<td id="S4.T1.12.16.3.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedProx</td>
<td id="S4.T1.12.16.3.2" class="ltx_td ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T1.12.16.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">69.63</td>
<td id="S4.T1.12.16.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.32</td>
<td id="S4.T1.12.16.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">74.84</td>
<td id="S4.T1.12.16.3.6" class="ltx_td ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T1.12.16.3.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">41.05</td>
<td id="S4.T1.12.16.3.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">42.38</td>
<td id="S4.T1.12.16.3.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">61.46</td>
</tr>
<tr id="S4.T1.12.17.4" class="ltx_tr">
<td id="S4.T1.12.17.4.1" class="ltx_td ltx_align_left" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.17.4.1.1" class="ltx_text" style="background-color:#DCDCDC;">+ FedGH</span></td>
<td id="S4.T1.12.17.4.2" class="ltx_td" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T1.12.17.4.3" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.17.4.3.1" class="ltx_text ltx_font_bold" style="background-color:#DCDCDC;">71.80</span></td>
<td id="S4.T1.12.17.4.4" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.17.4.4.1" class="ltx_text ltx_font_bold" style="background-color:#DCDCDC;">66.27</span></td>
<td id="S4.T1.12.17.4.5" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.17.4.5.1" class="ltx_text" style="background-color:#DCDCDC;">75.00</span></td>
<td id="S4.T1.12.17.4.6" class="ltx_td" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T1.12.17.4.7" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.17.4.7.1" class="ltx_text" style="background-color:#DCDCDC;">44.16</span></td>
<td id="S4.T1.12.17.4.8" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.17.4.8.1" class="ltx_text" style="background-color:#DCDCDC;">44.62</span></td>
<td id="S4.T1.12.17.4.9" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.17.4.9.1" class="ltx_text" style="background-color:#DCDCDC;">62.14</span></td>
</tr>
<tr id="S4.T1.12.18.5" class="ltx_tr">
<td id="S4.T1.12.18.5.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedNova</td>
<td id="S4.T1.12.18.5.2" class="ltx_td ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T1.12.18.5.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.08</td>
<td id="S4.T1.12.18.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.33</td>
<td id="S4.T1.12.18.5.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">75.75</td>
<td id="S4.T1.12.18.5.6" class="ltx_td ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T1.12.18.5.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">39.72</td>
<td id="S4.T1.12.18.5.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">43.13</td>
<td id="S4.T1.12.18.5.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">62.01</td>
</tr>
<tr id="S4.T1.12.19.6" class="ltx_tr">
<td id="S4.T1.12.19.6.1" class="ltx_td ltx_align_left" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.19.6.1.1" class="ltx_text" style="background-color:#DCDCDC;">+ FedGH</span></td>
<td id="S4.T1.12.19.6.2" class="ltx_td" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T1.12.19.6.3" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.19.6.3.1" class="ltx_text" style="background-color:#DCDCDC;">67.56</span></td>
<td id="S4.T1.12.19.6.4" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.19.6.4.1" class="ltx_text" style="background-color:#DCDCDC;">66.15</span></td>
<td id="S4.T1.12.19.6.5" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.19.6.5.1" class="ltx_text ltx_font_bold" style="background-color:#DCDCDC;">75.97</span></td>
<td id="S4.T1.12.19.6.6" class="ltx_td" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T1.12.19.6.7" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.19.6.7.1" class="ltx_text" style="background-color:#DCDCDC;">42.75</span></td>
<td id="S4.T1.12.19.6.8" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.19.6.8.1" class="ltx_text" style="background-color:#DCDCDC;">44.66</span></td>
<td id="S4.T1.12.19.6.9" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.19.6.9.1" class="ltx_text ltx_font_bold" style="background-color:#DCDCDC;">62.96</span></td>
</tr>
<tr id="S4.T1.12.20.7" class="ltx_tr">
<td id="S4.T1.12.20.7.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedDecorr</td>
<td id="S4.T1.12.20.7.2" class="ltx_td ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T1.12.20.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">61.04</td>
<td id="S4.T1.12.20.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">61.61</td>
<td id="S4.T1.12.20.7.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">69.50</td>
<td id="S4.T1.12.20.7.6" class="ltx_td ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T1.12.20.7.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">47.32</td>
<td id="S4.T1.12.20.7.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">45.51</td>
<td id="S4.T1.12.20.7.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">62.14</td>
</tr>
<tr id="S4.T1.12.21.8" class="ltx_tr">
<td id="S4.T1.12.21.8.1" class="ltx_td ltx_align_left ltx_border_bb" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.21.8.1.1" class="ltx_text" style="background-color:#DCDCDC;">+ FedGH</span></td>
<td id="S4.T1.12.21.8.2" class="ltx_td ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T1.12.21.8.3" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.21.8.3.1" class="ltx_text" style="background-color:#DCDCDC;">60.61</span></td>
<td id="S4.T1.12.21.8.4" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.21.8.4.1" class="ltx_text" style="background-color:#DCDCDC;">62.71</span></td>
<td id="S4.T1.12.21.8.5" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.21.8.5.1" class="ltx_text" style="background-color:#DCDCDC;">70.33</span></td>
<td id="S4.T1.12.21.8.6" class="ltx_td ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T1.12.21.8.7" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.21.8.7.1" class="ltx_text ltx_font_bold" style="background-color:#DCDCDC;">49.21</span></td>
<td id="S4.T1.12.21.8.8" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.21.8.8.1" class="ltx_text ltx_font_bold" style="background-color:#DCDCDC;">47.59</span></td>
<td id="S4.T1.12.21.8.9" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.12.21.8.9.1" class="ltx_text" style="background-color:#DCDCDC;">62.88</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.15.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S4.T1.16.2" class="ltx_text" style="font-size:90%;">Top-1 test accuracy on the CIFAR-10 and CIFAR-100 datasets under multiple non-IID scenarios. All results are reported from the last communication round, and the highest accuracy in each scenario is highlighted in <span id="S4.T1.16.2.1" class="ltx_text ltx_font_bold">Bold</span>.</span></figcaption>
</figure>
<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.06692/assets/x9.png" id="S4.F4.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="169" height="130" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F4.sf1.3.2" class="ltx_text" style="font-size:90%;">Top-1 test accuracy.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.06692/assets/x10.png" id="S4.F4.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="169" height="128" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F4.sf2.3.2" class="ltx_text" style="font-size:90%;">Test loss.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.4.2.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S4.F4.2.1" class="ltx_text" style="font-size:90%;">(a) Top-1 test accuracy and (b) test loss of the global model at each communication round in CIFAR-100, where <math id="S4.F4.2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.F4.2.1.m1.1b"><mi id="S4.F4.2.1.m1.1.1" xref="S4.F4.2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.F4.2.1.m1.1c"><ci id="S4.F4.2.1.m1.1.1.cmml" xref="S4.F4.2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.2.1.m1.1d">\alpha</annotation></semantics></math> = 0.01.</span></figcaption>
</figure>
<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.4" class="ltx_p">Tab. <a href="#S4.T1" title="Table 1 ‣ 4.2 Performance Boosting ‣ 4 Experiments ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> demonstrates the top-1 test accuracy on CIFAR-10 and CIFAR-100 datasets under various non-IID scenarios.
Noteworthy, we fix the random seed for fair comparison, and all results are reported from the last communication round.
We can observe that FedGH consistently improves all FL baselines across diverse heterogeneous settings.
Specifically, (1) FedGH improves different backbones. We use a simple CNN model for CIFAR-10 and the more complex MobileNetV2 for CIFAR-100.
The improvements observed on both datasets underscore the effectiveness of FedGH across different backbones.
(2) FedGH improves multiple baselines. Each column in Tab. <a href="#S4.T1" title="Table 1 ‣ 4.2 Performance Boosting ‣ 4 Experiments ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the results of incorporating FedGH into different FL baselines.
When integrated with different FL baselines, FedGH achieves substantial performance gains.
For instance, on CIFAR-10, FedGH enhances FedNova and FedProx by 2.48% and 2.17%, respectively.
In CIFAR-100, FedGH improves 3.11% and 3.03% with FedNova and FedProx.
Notably, FedGH boosts the latest FedDecorr by up to 2.08%,
demonstrating its significant performance and generalizability.
(3) FedGH achieves greater performance enhancement in more severe non-IID scenarios.
Each row in Tab. <a href="#S4.T1" title="Table 1 ‣ 4.2 Performance Boosting ‣ 4 Experiments ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> corresponds to a distinct non-IID scenario.
A similar trend can be observed in CIFAR-10 and CIFAR-100,
where FedGH yields more substantial improvements in cases of stronger heterogeneity (i.e., smaller <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\alpha</annotation></semantics></math> and <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">C</annotation></semantics></math>).
This trend results in a 0.16% <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mo id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><csymbol cd="latexml" id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\sim</annotation></semantics></math> 1.18% enhancement in less severe heterogeneity and a 1.89% <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mo id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><csymbol cd="latexml" id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">\sim</annotation></semantics></math> 3.11% improvement in the strongest heterogeneous scenario.
This effect can be attributed to the fact that stronger heterogeneity leads to more severe gradient conflicts among clients,
as discussed in Section <a href="#S3.SS2" title="3.2 Gradient Conflict in Heterogeneous FL ‣ 3 Methodology ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<table id="S4.T2.6" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.6.7.1" class="ltx_tr">
<th id="S4.T2.6.7.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="2"><span id="S4.T2.6.7.1.1.1" class="ltx_text">Method</span></th>
<th id="S4.T2.6.7.1.2" class="ltx_td ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<th id="S4.T2.6.7.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="3">Tiny-ImageNet (%)</th>
</tr>
<tr id="S4.T2.6.6" class="ltx_tr">
<th id="S4.T2.6.6.7" class="ltx_td ltx_th ltx_th_column" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<th id="S4.T2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<table id="S4.T2.2.2.2.2" class="ltx_tabular ltx_align_middle">
<tr id="S4.T2.1.1.1.1.1" class="ltx_tr">
<td id="S4.T2.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<math id="S4.T2.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T2.1.1.1.1.1.1.m1.1a"><mi id="S4.T2.1.1.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.1.1.m1.1c">\alpha</annotation></semantics></math> = 0.01</td>
</tr>
<tr id="S4.T2.2.2.2.2.2" class="ltx_tr">
<td id="S4.T2.2.2.2.2.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<math id="S4.T2.2.2.2.2.2.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.T2.2.2.2.2.2.1.m1.1a"><mi id="S4.T2.2.2.2.2.2.1.m1.1.1" xref="S4.T2.2.2.2.2.2.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.2.1.m1.1b"><ci id="S4.T2.2.2.2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.2.2.2.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.2.1.m1.1c">C</annotation></semantics></math> = 1.0</td>
</tr>
</table>
</th>
<th id="S4.T2.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<table id="S4.T2.4.4.4.2" class="ltx_tabular ltx_align_middle">
<tr id="S4.T2.3.3.3.1.1" class="ltx_tr">
<td id="S4.T2.3.3.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<math id="S4.T2.3.3.3.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T2.3.3.3.1.1.1.m1.1a"><mi id="S4.T2.3.3.3.1.1.1.m1.1.1" xref="S4.T2.3.3.3.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.1.1.1.m1.1b"><ci id="S4.T2.3.3.3.1.1.1.m1.1.1.cmml" xref="S4.T2.3.3.3.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.1.1.1.m1.1c">\alpha</annotation></semantics></math> = 0.1</td>
</tr>
<tr id="S4.T2.4.4.4.2.2" class="ltx_tr">
<td id="S4.T2.4.4.4.2.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<math id="S4.T2.4.4.4.2.2.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.T2.4.4.4.2.2.1.m1.1a"><mi id="S4.T2.4.4.4.2.2.1.m1.1.1" xref="S4.T2.4.4.4.2.2.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.2.2.1.m1.1b"><ci id="S4.T2.4.4.4.2.2.1.m1.1.1.cmml" xref="S4.T2.4.4.4.2.2.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.2.2.1.m1.1c">C</annotation></semantics></math> = 0.2</td>
</tr>
</table>
</th>
<th id="S4.T2.6.6.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<table id="S4.T2.6.6.6.2" class="ltx_tabular ltx_align_middle">
<tr id="S4.T2.5.5.5.1.1" class="ltx_tr">
<td id="S4.T2.5.5.5.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<math id="S4.T2.5.5.5.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T2.5.5.5.1.1.1.m1.1a"><mi id="S4.T2.5.5.5.1.1.1.m1.1.1" xref="S4.T2.5.5.5.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.1.1.1.m1.1b"><ci id="S4.T2.5.5.5.1.1.1.m1.1.1.cmml" xref="S4.T2.5.5.5.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.1.1.1.m1.1c">\alpha</annotation></semantics></math> = 0.1</td>
</tr>
<tr id="S4.T2.6.6.6.2.2" class="ltx_tr">
<td id="S4.T2.6.6.6.2.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<math id="S4.T2.6.6.6.2.2.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.T2.6.6.6.2.2.1.m1.1a"><mi id="S4.T2.6.6.6.2.2.1.m1.1.1" xref="S4.T2.6.6.6.2.2.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.6.2.2.1.m1.1b"><ci id="S4.T2.6.6.6.2.2.1.m1.1.1.cmml" xref="S4.T2.6.6.6.2.2.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.6.2.2.1.m1.1c">C</annotation></semantics></math> = 1.0</td>
</tr>
</table>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.6.8.1" class="ltx_tr">
<td id="S4.T2.6.8.1.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedAvg</td>
<td id="S4.T2.6.8.1.2" class="ltx_td ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T2.6.8.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">31.44</td>
<td id="S4.T2.6.8.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">25.98</td>
<td id="S4.T2.6.8.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">46.64</td>
</tr>
<tr id="S4.T2.6.9.2" class="ltx_tr">
<td id="S4.T2.6.9.2.1" class="ltx_td ltx_align_left" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.6.9.2.1.1" class="ltx_text" style="background-color:#DCDCDC;">+ FedGH</span></td>
<td id="S4.T2.6.9.2.2" class="ltx_td" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T2.6.9.2.3" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.6.9.2.3.1" class="ltx_text" style="background-color:#DCDCDC;">32.94</span></td>
<td id="S4.T2.6.9.2.4" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.6.9.2.4.1" class="ltx_text" style="background-color:#DCDCDC;">26.28</span></td>
<td id="S4.T2.6.9.2.5" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.6.9.2.5.1" class="ltx_text" style="background-color:#DCDCDC;">47.45</span></td>
</tr>
<tr id="S4.T2.6.10.3" class="ltx_tr">
<td id="S4.T2.6.10.3.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedProx</td>
<td id="S4.T2.6.10.3.2" class="ltx_td ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T2.6.10.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">31.42</td>
<td id="S4.T2.6.10.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">25.91</td>
<td id="S4.T2.6.10.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">46.67</td>
</tr>
<tr id="S4.T2.6.11.4" class="ltx_tr">
<td id="S4.T2.6.11.4.1" class="ltx_td ltx_align_left" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.6.11.4.1.1" class="ltx_text" style="background-color:#DCDCDC;">+ FedGH</span></td>
<td id="S4.T2.6.11.4.2" class="ltx_td" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T2.6.11.4.3" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.6.11.4.3.1" class="ltx_text" style="background-color:#DCDCDC;">32.83</span></td>
<td id="S4.T2.6.11.4.4" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.6.11.4.4.1" class="ltx_text" style="background-color:#DCDCDC;">26.58</span></td>
<td id="S4.T2.6.11.4.5" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.6.11.4.5.1" class="ltx_text" style="background-color:#DCDCDC;">47.23</span></td>
</tr>
<tr id="S4.T2.6.12.5" class="ltx_tr">
<td id="S4.T2.6.12.5.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedNova</td>
<td id="S4.T2.6.12.5.2" class="ltx_td ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T2.6.12.5.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">30.96</td>
<td id="S4.T2.6.12.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">25.65</td>
<td id="S4.T2.6.12.5.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">46.52</td>
</tr>
<tr id="S4.T2.6.13.6" class="ltx_tr">
<td id="S4.T2.6.13.6.1" class="ltx_td ltx_align_left" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.6.13.6.1.1" class="ltx_text" style="background-color:#DCDCDC;">+ FedGH</span></td>
<td id="S4.T2.6.13.6.2" class="ltx_td" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T2.6.13.6.3" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.6.13.6.3.1" class="ltx_text" style="background-color:#DCDCDC;">33.03</span></td>
<td id="S4.T2.6.13.6.4" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.6.13.6.4.1" class="ltx_text" style="background-color:#DCDCDC;">26.74</span></td>
<td id="S4.T2.6.13.6.5" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.6.13.6.5.1" class="ltx_text" style="background-color:#DCDCDC;">47.13</span></td>
</tr>
<tr id="S4.T2.6.14.7" class="ltx_tr">
<td id="S4.T2.6.14.7.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedDecorr</td>
<td id="S4.T2.6.14.7.2" class="ltx_td ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T2.6.14.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">36.36</td>
<td id="S4.T2.6.14.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">29.76</td>
<td id="S4.T2.6.14.7.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">47.87</td>
</tr>
<tr id="S4.T2.6.15.8" class="ltx_tr">
<td id="S4.T2.6.15.8.1" class="ltx_td ltx_align_left ltx_border_bb" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.6.15.8.1.1" class="ltx_text" style="background-color:#DCDCDC;">+ FedGH</span></td>
<td id="S4.T2.6.15.8.2" class="ltx_td ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;"></td>
<td id="S4.T2.6.15.8.3" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.6.15.8.3.1" class="ltx_text ltx_font_bold" style="background-color:#DCDCDC;">37.89</span></td>
<td id="S4.T2.6.15.8.4" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.6.15.8.4.1" class="ltx_text ltx_font_bold" style="background-color:#DCDCDC;">30.31</span></td>
<td id="S4.T2.6.15.8.5" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.6.15.8.5.1" class="ltx_text ltx_font_bold" style="background-color:#DCDCDC;">48.60</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.9.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S4.T2.10.2" class="ltx_text" style="font-size:90%;">Top-1 test accuracy on the Tiny-ImageNet under multiple non-IID scenarios. All results are reported from the last communication round, and the highest accuracy in each scenario is highlighted in <span id="S4.T2.10.2.1" class="ltx_text ltx_font_bold">Bold</span>.</span></figcaption>
</figure>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">Tab. <a href="#S4.T2" title="Table 2 ‣ 4.2 Performance Boosting ‣ 4 Experiments ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> presents the top-1 test accuracy achieved on the Tiny-ImageNet dataset.
A consistent pattern emerges, demonstrating that FedGH consistently enhances performance across different baselines,
with a more pronounced improvement in more severe non-IID scenarios.
In particular, FedGH results in a 0.73% to 1.53% enhancement on FedDecorr across various degrees of heterogeneity and leads to a 2.07% improvement on FedNova when <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\alpha</annotation></semantics></math> = 0.01.
These experimental results demonstrate the efficacy of addressing the non-IID issue through gradient harmonization.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">Furthermore, we visualize the test accuracy of the global model at each communication round in Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.2 Performance Boosting ‣ 4 Experiments ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.
It is evident that the incorporation of FedGH results in accelerated convergence and heightened performance.
Moreover, FedGH achieves comparable performance with reduced communication rounds: 75% for FedAvg and 78% for FedDecorr,
highlighting its capacity to enhance performance while significantly improving communication efficiency.</p>
</div>
<figure id="S4.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F5.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.06692/assets/x11.png" id="S4.F5.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="166" height="127" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F5.sf1.3.2" class="ltx_text" style="font-size:90%;">Top-1 accuracy in CIFAR-100, where each client contains 5 classes.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F5.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.06692/assets/x12.png" id="S4.F5.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="166" height="127" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F5.sf2.3.2" class="ltx_text" style="font-size:90%;">Top-1 accuracy in Tiny-ImageNet, where each client contains 10 classes.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.2.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S4.F5.3.2" class="ltx_text" style="font-size:90%;">Top-1 test accuracy on the (a) CIFAR-100 and (b) Tiny-ImageNet datasets, where datasets are split into 20 clients based on different classes.</span></figcaption>
</figure>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.1" class="ltx_p">Finally, in addition to Dirichlet distribution-based heterogeneity,
we partition the dataset into <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><mi id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><ci id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">K</annotation></semantics></math> clients based on different classes,
following the setting described in Sec. <a href="#S4.SS1" title="4.1 Implementation Details ‣ 4 Experiments ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>. In this scenario,
we train 20 clients with 100 communication rounds,
where each client contains 5 and 10 classes in CIFAR-100 and Tiny-ImageNet, respectively.
Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.2 Performance Boosting ‣ 4 Experiments ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> illustrates that incorporating FedGH leads to a faster convergence rate and higher performance,
especially when the baseline is the state-of-the-art FedDecorr.
This enhancement amounts to a 1.93% improvement in CIFAR-100 and a 1.77% increase in Tiny-ImageNet over FedDecorr in the last communication round.
Experimental results demonstrate that as a plug-and-play module, FedGH requires no hyperparameter tuning,
making it straightforward to incorporate into diverse supervised or unsupervised FL frameworks <cite class="ltx_cite ltx_citemacro_citep">(Zhuang et al., <a href="#bib.bib33" title="" class="ltx_ref">2021</a>, <a href="#bib.bib34" title="" class="ltx_ref">2022</a>; Han et al., <a href="#bib.bib7" title="" class="ltx_ref">2022</a>)</cite>,
as well as various deep-learning tasks.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Ablation study on the number of clients</h3>

<figure id="S4.T3" class="ltx_table">
<table id="S4.T3.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.1.1" class="ltx_tr">
<th id="S4.T3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;"><math id="S4.T3.1.1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.T3.1.1.1.m1.1a"><mi id="S4.T3.1.1.1.m1.1.1" xref="S4.T3.1.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.m1.1b"><ci id="S4.T3.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.m1.1c">K</annotation></semantics></math></th>
<th id="S4.T3.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Method</th>
<th id="S4.T3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">CIFAR-10</th>
<th id="S4.T3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">CIFAR-100</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.1.2.1" class="ltx_tr">
<th id="S4.T3.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="2"><span id="S4.T3.1.2.1.1.1" class="ltx_text">5</span></th>
<th id="S4.T3.1.2.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedAvg</th>
<td id="S4.T3.1.2.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.93</td>
<td id="S4.T3.1.2.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">62.93</td>
</tr>
<tr id="S4.T3.1.3.2" class="ltx_tr">
<th id="S4.T3.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.1.3.2.1.1" class="ltx_text" style="background-color:#DCDCDC;">+ FedGH</span></th>
<td id="S4.T3.1.3.2.2" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.1.3.2.2.1" class="ltx_text" style="background-color:#DCDCDC;">64.75</span></td>
<td id="S4.T3.1.3.2.3" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.1.3.2.3.1" class="ltx_text" style="background-color:#DCDCDC;">63.14</span></td>
</tr>
<tr id="S4.T3.1.4.3" class="ltx_tr">
<th id="S4.T3.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="2"><span id="S4.T3.1.4.3.1.1" class="ltx_text">10</span></th>
<th id="S4.T3.1.4.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedAvg</th>
<td id="S4.T3.1.4.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">69.74</td>
<td id="S4.T3.1.4.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">56.12</td>
</tr>
<tr id="S4.T3.1.5.4" class="ltx_tr">
<th id="S4.T3.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.1.5.4.1.1" class="ltx_text" style="background-color:#DCDCDC;">+ FedGH</span></th>
<td id="S4.T3.1.5.4.2" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.1.5.4.2.1" class="ltx_text" style="background-color:#DCDCDC;">72.23</span></td>
<td id="S4.T3.1.5.4.3" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.1.5.4.3.1" class="ltx_text" style="background-color:#DCDCDC;">56.84</span></td>
</tr>
<tr id="S4.T3.1.6.5" class="ltx_tr">
<th id="S4.T3.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="2"><span id="S4.T3.1.6.5.1.1" class="ltx_text">20</span></th>
<th id="S4.T3.1.6.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedAvg</th>
<td id="S4.T3.1.6.5.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">68.66</td>
<td id="S4.T3.1.6.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">41.00</td>
</tr>
<tr id="S4.T3.1.7.6" class="ltx_tr">
<th id="S4.T3.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.1.7.6.1.1" class="ltx_text" style="background-color:#DCDCDC;">+ FedGH</span></th>
<td id="S4.T3.1.7.6.2" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.1.7.6.2.1" class="ltx_text" style="background-color:#DCDCDC;">70.67</span></td>
<td id="S4.T3.1.7.6.3" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.1.7.6.3.1" class="ltx_text" style="background-color:#DCDCDC;">43.86</span></td>
</tr>
<tr id="S4.T3.1.8.7" class="ltx_tr">
<th id="S4.T3.1.8.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="2"><span id="S4.T3.1.8.7.1.1" class="ltx_text">30</span></th>
<th id="S4.T3.1.8.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedAvg</th>
<td id="S4.T3.1.8.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.21</td>
<td id="S4.T3.1.8.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">32.16</td>
</tr>
<tr id="S4.T3.1.9.8" class="ltx_tr">
<th id="S4.T3.1.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.1.9.8.1.1" class="ltx_text" style="background-color:#DCDCDC;">+ FedGH</span></th>
<td id="S4.T3.1.9.8.2" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.1.9.8.2.1" class="ltx_text" style="background-color:#DCDCDC;">67.04</span></td>
<td id="S4.T3.1.9.8.3" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.1.9.8.3.1" class="ltx_text" style="background-color:#DCDCDC;">36.21</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.7.3.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S4.T3.5.2" class="ltx_text" style="font-size:90%;">Top-1 test accuracy with different number of cliens <math id="S4.T3.4.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.T3.4.1.m1.1b"><mi id="S4.T3.4.1.m1.1.1" xref="S4.T3.4.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.T3.4.1.m1.1c"><ci id="S4.T3.4.1.m1.1.1.cmml" xref="S4.T3.4.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.1.m1.1d">K</annotation></semantics></math>. <math id="S4.T3.5.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T3.5.2.m2.1b"><mi id="S4.T3.5.2.m2.1.1" xref="S4.T3.5.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T3.5.2.m2.1c"><ci id="S4.T3.5.2.m2.1.1.cmml" xref="S4.T3.5.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.2.m2.1d">\alpha</annotation></semantics></math> is set to 0.1 and 0.01 for CIFAR-10 and CIFAR-100, respectively.</span></figcaption>
</figure>
<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.6" class="ltx_p">As discussed in Sec. <a href="#S3.SS2" title="3.2 Gradient Conflict in Heterogeneous FL ‣ 3 Methodology ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>, having more clients increases the occurrences of gradient conflicts.
Thus, we investigate the effectiveness of FedGH with different numbers of clients (<math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">K</annotation></semantics></math>) to determine whether it yields greater performance improvements with more clients.
All experiments follow the same settings as presented in Sec. <a href="#S4.SS1" title="4.1 Implementation Details ‣ 4 Experiments ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a> and results are reported from the last communication round.
We test FedGH in conjunction with FedAvg under the challenging non-IID scenario,
where <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><mi id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\alpha</annotation></semantics></math> is set to 0.1 and 0.01 for CIFAR-10 and CIFAR-100, respectively.
As shown in Tab. <a href="#S4.T3" title="Table 3 ‣ 4.3 Ablation study on the number of clients ‣ 4 Experiments ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, it is evident that FedGH has only a slight impact on the baseline when <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><mi id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><ci id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">K</annotation></semantics></math> = 5.
However, FedGH significantly enhances FedAvg as <math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><mi id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><ci id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">K</annotation></semantics></math> increases, resulting in a 2.01% <math id="S4.SS3.p1.5.m5.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.SS3.p1.5.m5.1a"><mo id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><csymbol cd="latexml" id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">\sim</annotation></semantics></math> 2.49% improvement in CIFAR-10 and 0.72% <math id="S4.SS3.p1.6.m6.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.SS3.p1.6.m6.1a"><mo id="S4.SS3.p1.6.m6.1.1" xref="S4.SS3.p1.6.m6.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m6.1b"><csymbol cd="latexml" id="S4.SS3.p1.6.m6.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m6.1c">\sim</annotation></semantics></math> 4.05% in CIFAR-100.
Furthermore, we observe that FedGH achieves the most substantial performance improvement with the highest number of clients in CIFAR-100,
demonstrating the scalability of FedGH.
This observation also underscores that FedGH is particularly suitable for cross-device FL scenarios involving a large number of clients <cite class="ltx_cite ltx_citemacro_citep">(Qu et al., <a href="#bib.bib20" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Ablation study on the number of local epochs</h3>

<figure id="S4.T4" class="ltx_table">
<table id="S4.T4.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.1.1" class="ltx_tr">
<th id="S4.T4.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;"><math id="S4.T4.1.1.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.T4.1.1.1.m1.1a"><mi id="S4.T4.1.1.1.m1.1.1" xref="S4.T4.1.1.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.m1.1b"><ci id="S4.T4.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.m1.1c">E</annotation></semantics></math></th>
<th id="S4.T4.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Method</th>
<th id="S4.T4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">CIFAR-10</th>
<th id="S4.T4.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">CIFAR-100</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.1.2.1" class="ltx_tr">
<th id="S4.T4.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="2"><span id="S4.T4.1.2.1.1.1" class="ltx_text">1</span></th>
<th id="S4.T4.1.2.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedAvg</th>
<td id="S4.T4.1.2.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">57.45</td>
<td id="S4.T4.1.2.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">29.49</td>
</tr>
<tr id="S4.T4.1.3.2" class="ltx_tr">
<th id="S4.T4.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T4.1.3.2.1.1" class="ltx_text" style="background-color:#DCDCDC;">+ FedGH</span></th>
<td id="S4.T4.1.3.2.2" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T4.1.3.2.2.1" class="ltx_text" style="background-color:#DCDCDC;">58.55</span></td>
<td id="S4.T4.1.3.2.3" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T4.1.3.2.3.1" class="ltx_text" style="background-color:#DCDCDC;">33.42</span></td>
</tr>
<tr id="S4.T4.1.4.3" class="ltx_tr">
<th id="S4.T4.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="2"><span id="S4.T4.1.4.3.1.1" class="ltx_text">5</span></th>
<th id="S4.T4.1.4.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedAvg</th>
<td id="S4.T4.1.4.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">68.66</td>
<td id="S4.T4.1.4.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">41.00</td>
</tr>
<tr id="S4.T4.1.5.4" class="ltx_tr">
<th id="S4.T4.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T4.1.5.4.1.1" class="ltx_text" style="background-color:#DCDCDC;">+ FedGH</span></th>
<td id="S4.T4.1.5.4.2" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T4.1.5.4.2.1" class="ltx_text" style="background-color:#DCDCDC;">70.67</span></td>
<td id="S4.T4.1.5.4.3" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T4.1.5.4.3.1" class="ltx_text" style="background-color:#DCDCDC;">43.86</span></td>
</tr>
<tr id="S4.T4.1.6.5" class="ltx_tr">
<th id="S4.T4.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="2"><span id="S4.T4.1.6.5.1.1" class="ltx_text">10</span></th>
<th id="S4.T4.1.6.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedAvg</th>
<td id="S4.T4.1.6.5.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">69.56</td>
<td id="S4.T4.1.6.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">45.01</td>
</tr>
<tr id="S4.T4.1.7.6" class="ltx_tr">
<th id="S4.T4.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T4.1.7.6.1.1" class="ltx_text" style="background-color:#DCDCDC;">+ FedGH</span></th>
<td id="S4.T4.1.7.6.2" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T4.1.7.6.2.1" class="ltx_text" style="background-color:#DCDCDC;">70.42</span></td>
<td id="S4.T4.1.7.6.3" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T4.1.7.6.3.1" class="ltx_text" style="background-color:#DCDCDC;">45.54</span></td>
</tr>
<tr id="S4.T4.1.8.7" class="ltx_tr">
<th id="S4.T4.1.8.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="2"><span id="S4.T4.1.8.7.1.1" class="ltx_text">15</span></th>
<th id="S4.T4.1.8.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedAvg</th>
<td id="S4.T4.1.8.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.86</td>
<td id="S4.T4.1.8.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">44.33</td>
</tr>
<tr id="S4.T4.1.9.8" class="ltx_tr">
<th id="S4.T4.1.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T4.1.9.8.1.1" class="ltx_text" style="background-color:#DCDCDC;">+ FedGH</span></th>
<td id="S4.T4.1.9.8.2" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T4.1.9.8.2.1" class="ltx_text" style="background-color:#DCDCDC;">70.62</span></td>
<td id="S4.T4.1.9.8.3" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#DCDCDC;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T4.1.9.8.3.1" class="ltx_text" style="background-color:#DCDCDC;">45.34</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T4.7.3.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="S4.T4.5.2" class="ltx_text" style="font-size:90%;">Top-1 test accuracy with different number of local epochs <math id="S4.T4.4.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.T4.4.1.m1.1b"><mi id="S4.T4.4.1.m1.1.1" xref="S4.T4.4.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.T4.4.1.m1.1c"><ci id="S4.T4.4.1.m1.1.1.cmml" xref="S4.T4.4.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.1.m1.1d">E</annotation></semantics></math>. <math id="S4.T4.5.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T4.5.2.m2.1b"><mi id="S4.T4.5.2.m2.1.1" xref="S4.T4.5.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T4.5.2.m2.1c"><ci id="S4.T4.5.2.m2.1.1.cmml" xref="S4.T4.5.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.5.2.m2.1d">\alpha</annotation></semantics></math> is set to 0.1 and 0.01 for CIFAR-10 and CIFAR-100, respectively.</span></figcaption>
</figure>
<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.5" class="ltx_p">We also conduct an ablation study on the number of local epochs (<math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><mi id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">E</annotation></semantics></math>) under the same non-IID scenario,
as shown in Tab. <a href="#S4.T4" title="Table 4 ‣ 4.4 Ablation study on the number of local epochs ‣ 4 Experiments ‣ Tackling the Non-IID Issue in Heterogeneous Federated Learning by Gradient Harmonization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. In CIFAR-10, we consistently observe performance improvements by FedGH from 0.86% to 2.76%.
Additionally, when <math id="S4.SS4.p1.2.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.SS4.p1.2.m2.1a"><mi id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><ci id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">E</annotation></semantics></math> is set to 15, each client is susceptible to overfitting in relatively small-scale heterogeneous data.
Interestingly, FedGH maintains high performance compared to <math id="S4.SS4.p1.3.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.SS4.p1.3.m3.1a"><mi id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><ci id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">E</annotation></semantics></math> = 10, while FedAvg exhibits a notable degradation.
This suggests that FedGH can mitigate local drifts and correct the optimization direction towards global minima.
In CIFAR-100, FedGH achieves the most significant performance improvements of 3.93% and 2.86% at <math id="S4.SS4.p1.4.m4.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.SS4.p1.4.m4.1a"><mi id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><ci id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">E</annotation></semantics></math> = 1 and <math id="S4.SS4.p1.5.m5.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.SS4.p1.5.m5.1a"><mi id="S4.SS4.p1.5.m5.1.1" xref="S4.SS4.p1.5.m5.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m5.1b"><ci id="S4.SS4.p1.5.m5.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m5.1c">E</annotation></semantics></math> = 5,
respectively. Furthermore, FedGH consistently enhances FedAvg as the number of local epochs increases. These observations demonstrate that FedGH can expedite the convergence rate of the global model, especially when local training resources are limited,
making it suitable for scenarios where local computing power is constrained <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib29" title="" class="ltx_ref">2019b</a>)</cite>.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">The non-IID issue has become a key challenge as federated learning research progresses. In this work, we first investigate the gradient conflict phenomenon among multiple clients in FL. Then, we propose a simple yet effective method called FedGH to tackle the non-IID issue through gradient harmonization. FedGH can seamlessly integrate into any FL frameworks without hyperparameters tuning. Extensive experiments demonstrate that FedGH consistently improves multiple state-of-the-art baselines across different degrees of heterogeneity, indicating its potential for real-world applications.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Abadi et al. [2016]</span>
<span class="ltx_bibblock">
Martin Abadi, Andy Chu, Ian Goodfellow, H Brendan McMahan, Ilya Mironov, Kunal Talwar, and Li Zhang.

</span>
<span class="ltx_bibblock">Deep learning with differential privacy.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2016 ACM SIGSAC conference on computer and communications security</em>, pages 308–318, 2016.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Acar et al. [2021]</span>
<span class="ltx_bibblock">
Durmus Alp Emre Acar, Yue Zhao, Ramon Matas Navarro, Matthew Mattina, Paul N Whatmough, and Venkatesh Saligrama.

</span>
<span class="ltx_bibblock">Federated learning based on dynamic regularization.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2111.04263</em>, 2021.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caldarola et al. [2022]</span>
<span class="ltx_bibblock">
Debora Caldarola, Barbara Caputo, and Marco Ciccone.

</span>
<span class="ltx_bibblock">Improving generalization in federated learning by seeking flat minima.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">European Conference on Computer Vision</em>, pages 654–672. Springer, 2022.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cubuk et al. [2018]</span>
<span class="ltx_bibblock">
Ekin D Cubuk, Barret Zoph, Dandelion Mane, Vijay Vasudevan, and Quoc V Le.

</span>
<span class="ltx_bibblock">Autoaugment: Learning augmentation policies from data.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1805.09501</em>, 2018.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy et al. [2020]</span>
<span class="ltx_bibblock">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn, Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg Heigold, Sylvain Gelly, et al.

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at scale.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.11929</em>, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geiping et al. [2020]</span>
<span class="ltx_bibblock">
Jonas Geiping, Hartmut Bauermeister, Hannah Dröge, and Michael Moeller.

</span>
<span class="ltx_bibblock">Inverting gradients-how easy is it to break privacy in federated learning?

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33:16937–16947, 2020.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al. [2022]</span>
<span class="ltx_bibblock">
Sungwon Han, Sungwon Park, Fangzhao Wu, Sundong Kim, Chuhan Wu, Xing Xie, and Meeyoung Cha.

</span>
<span class="ltx_bibblock">Fedx: Unsupervised federated learning with cross knowledge distillation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">European Conference on Computer Vision</em>, pages 691–707. Springer, 2022.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu et al. [2019]</span>
<span class="ltx_bibblock">
Tzu-Ming Harry Hsu, Hang Qi, and Matthew Brown.

</span>
<span class="ltx_bibblock">Measuring the effects of non-identical data distribution for federated visual classification.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1909.06335</em>, 2019.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. [2021]</span>
<span class="ltx_bibblock">
Yutao Huang, Lingyang Chu, Zirui Zhou, Lanjun Wang, Jiangchuan Liu, Jian Pei, and Yong Zhang.

</span>
<span class="ltx_bibblock">Personalized cross-silo federated learning on non-iid data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI conference on artificial intelligence</em>, volume 35, pages 7865–7873, 2021.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. [2022]</span>
<span class="ltx_bibblock">
Meirui Jiang, Zirui Wang, and Qi Dou.

</span>
<span class="ltx_bibblock">Harmofl: Harmonizing local and global drifts in federated learning on heterogeneous medical images.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em>, volume 36, pages 1087–1095, 2022.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaissis et al. [2020]</span>
<span class="ltx_bibblock">
Georgios A Kaissis, Marcus R Makowski, Daniel Rückert, and Rickmer F Braren.

</span>
<span class="ltx_bibblock">Secure, privacy-preserving and federated machine learning in medical imaging.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Nature Machine Intelligence</em>, 2(6):305–311, 2020.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. [2020]</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank Reddi, Sebastian Stich, and Ananda Theertha Suresh.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, pages 5132–5143. PMLR, 2020.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2021]</span>
<span class="ltx_bibblock">
Qinbin Li, Bingsheng He, and Dawn Song.

</span>
<span class="ltx_bibblock">Model-contrastive federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 10713–10722, 2021.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2020]</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine learning and systems</em>, 2:429–450, 2020.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. [2022]</span>
<span class="ltx_bibblock">
Xiaosong Ma, Jie Zhang, Song Guo, and Wenchao Xu.

</span>
<span class="ltx_bibblock">Layer-wised model aggregation for personalized federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 10092–10101, 2022.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mansilla et al. [2021]</span>
<span class="ltx_bibblock">
Lucas Mansilla, Rodrigo Echeveste, Diego H Milone, and Enzo Ferrante.

</span>
<span class="ltx_bibblock">Domain generalization via gradient surgery.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF international conference on computer vision</em>, pages 6630–6638, 2021.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. [2017]</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>, pages 1273–1282. PMLR, 2017.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Miao et al. [2023]</span>
<span class="ltx_bibblock">
Jiaxu Miao, Zongxin Yang, Leilei Fan, and Yi Yang.

</span>
<span class="ltx_bibblock">Fedseg: Class-heterogeneous federated learning for semantic segmentation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pages 8042–8052, 2023.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Niu and Deng [2022]</span>
<span class="ltx_bibblock">
Yifan Niu and Weihong Deng.

</span>
<span class="ltx_bibblock">Federated learning for face recognition with gradient correction.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em>, volume 36, pages 1999–2007, 2022.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qu et al. [2022]</span>
<span class="ltx_bibblock">
Zhe Qu, Xingyu Li, Rui Duan, Yao Liu, Bo Tang, and Zhuo Lu.

</span>
<span class="ltx_bibblock">Generalized federated learning via sharpness aware minimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pages 18250–18280. PMLR, 2022.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. [2018]</span>
<span class="ltx_bibblock">
Alec Radford, Karthik Narasimhan, Tim Salimans, Ilya Sutskever, et al.

</span>
<span class="ltx_bibblock">Improving language understanding by generative pre-training.

</span>
<span class="ltx_bibblock">2018.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddi et al. [2020]</span>
<span class="ltx_bibblock">
Sashank Reddi, Zachary Charles, Manzil Zaheer, Zachary Garrett, Keith Rush, Jakub Konečnỳ, Sanjiv Kumar, and H Brendan McMahan.

</span>
<span class="ltx_bibblock">Adaptive federated optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2003.00295</em>, 2020.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sandler et al. [2018]</span>
<span class="ltx_bibblock">
Mark Sandler, Andrew Howard, Menglong Zhu, Andrey Zhmoginov, and Liang-Chieh Chen.

</span>
<span class="ltx_bibblock">Mobilenetv2: Inverted residuals and linear bottlenecks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pages 4510–4520, 2018.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al. [2022]</span>
<span class="ltx_bibblock">
Yujun Shi, Jian Liang, Wenqing Zhang, Vincent YF Tan, and Song Bai.

</span>
<span class="ltx_bibblock">Towards understanding and mitigating dimensional collapse in heterogeneous federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2210.00226</em>, 2022.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Uddin et al. [2022]</span>
<span class="ltx_bibblock">
Md Palash Uddin, Yong Xiang, John Yearwood, and Longxiang Gao.

</span>
<span class="ltx_bibblock">Robust federated averaging via outlier pruning.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing Letters</em>, 29:409–413, 2022.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/LSP.2021.3134893</span>.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2020a]</span>
<span class="ltx_bibblock">
Hongyi Wang, Mikhail Yurochkin, Yuekai Sun, Dimitris Papailiopoulos, and Yasaman Khazaeni.

</span>
<span class="ltx_bibblock">Federated learning with matched averaging.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.06440</em>, 2020a.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2019a]</span>
<span class="ltx_bibblock">
Jianyu Wang, Vinayak Tantia, Nicolas Ballas, and Michael Rabbat.

</span>
<span class="ltx_bibblock">Slowmo: Improving communication-efficient distributed sgd with slow momentum.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.00643</em>, 2019a.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2020b]</span>
<span class="ltx_bibblock">
Jianyu Wang, Qinghua Liu, Hao Liang, Gauri Joshi, and H Vincent Poor.

</span>
<span class="ltx_bibblock">Tackling the objective inconsistency problem in heterogeneous federated optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 33:7611–7623, 2020b.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2019b]</span>
<span class="ltx_bibblock">
Shiqiang Wang, Tiffany Tuor, Theodoros Salonidis, Kin K Leung, Christian Makaya, Ting He, and Kevin Chan.

</span>
<span class="ltx_bibblock">Adaptive federated learning in resource constrained edge computing systems.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">IEEE journal on selected areas in communications</em>, 37(6):1205–1221, 2019b.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan et al. [2022]</span>
<span class="ltx_bibblock">
Na Yan, Kezhi Wang, Cunhua Pan, and Kok Keong Chai.

</span>
<span class="ltx_bibblock">Performance analysis for channel-weighted federated learning in oma wireless networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing Letters</em>, 29:772–776, 2022.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. [2020]</span>
<span class="ltx_bibblock">
Tianhe Yu, Saurabh Kumar, Abhishek Gupta, Sergey Levine, Karol Hausman, and Chelsea Finn.

</span>
<span class="ltx_bibblock">Gradient surgery for multi-task learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33:5824–5836, 2020.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. [2018]</span>
<span class="ltx_bibblock">
Yue Zhao, Meng Li, Liangzhen Lai, Naveen Suda, Damon Civin, and Vikas Chandra.

</span>
<span class="ltx_bibblock">Federated learning with non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>, 2018.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhuang et al. [2021]</span>
<span class="ltx_bibblock">
Weiming Zhuang, Xin Gan, Yonggang Wen, Shuai Zhang, and Shuai Yi.

</span>
<span class="ltx_bibblock">Collaborative unsupervised visual representation learning from decentralized data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF international conference on computer vision</em>, pages 4912–4921, 2021.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhuang et al. [2022]</span>
<span class="ltx_bibblock">
Weiming Zhuang, Yonggang Wen, and Shuai Zhang.

</span>
<span class="ltx_bibblock">Divergence-aware federated self-supervised learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2204.04385</em>, 2022.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2309.06691" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2309.06692" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2309.06692">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2309.06692" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2309.06693" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Feb 26 21:06:26 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
