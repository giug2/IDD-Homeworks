<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2309.07189] Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization</title><meta property="og:description" content="Federated learning algorithms perform reasonably well on independent and identically distributed (IID) data. They, on the other hand, suffer greatly from heterogeneous environments, i.e., Non-IID data. Despite the fact…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2309.07189">

<!--Generated on Wed Feb 28 06:38:56 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
<span id="id1.id1" class="ltx_text ltx_font_italic">Learning From Drift</span>: 
<br class="ltx_break">Federated Learning on Non-IID Data via Drift Regularization</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Yeachan Kim<sup id="id2.1.id1" class="ltx_sup">1</sup>, Bonggun Shin<sup id="id3.2.id2" class="ltx_sup">2</sup>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id4.id1" class="ltx_p">Federated learning algorithms perform reasonably well on independent and identically distributed (IID) data. They, on the other hand, suffer greatly from heterogeneous environments, i.e., Non-IID data. Despite the fact that many research projects have been done to address this issue, recent findings indicate that they are still sub-optimal when compared to training on IID data. In this work, we carefully analyze the existing methods in heterogeneous environments. Interestingly, we find that regularizing the classifier’s outputs is quite effective in preventing performance degradation on Non-IID data. Motivated by this, we propose Learning from Drift (LfD), a novel method for effectively training the model in heterogeneous settings. Our scheme encapsulates two key components: drift estimation and drift regularization. Specifically, LfD first estimates how different the local model is from the global model (i.e., drift). The local model is then regularized such that it does not fall in the direction of the estimated drift. In the experiment, we evaluate each method through the lens of the five aspects of federated learning, i.e., Generalization, Heterogeneity, Scalability, Forgetting, and Efficiency. Comprehensive evaluation results clearly support the superiority of LfD in federated learning with Non-IID data.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">With the increasing privacy concerns, transmitting privacy-sensitive data (e.g., browsing history, electronic health records, or data containing intellectual property) to outside of local networks makes the training on different sources further difficult. To address the above challenge, federated learning enables multiple parties (i.e., regions, devices, and users) to cooperatively train a neural model without sending the local data between participants <cite class="ltx_cite ltx_citemacro_citep">(Konečnỳ et al. <a href="#bib.bib9" title="" class="ltx_ref">2016</a>; McMahan et al. <a href="#bib.bib22" title="" class="ltx_ref">2017</a>; Yang et al. <a href="#bib.bib27" title="" class="ltx_ref">2019</a>; Li et al. <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib22" title="" class="ltx_ref">2017</a>)</cite> is the most widely used method in practice. In this method, a centralized server distributes an initial model to participants, and they perform a local optimization on their local data. After the optimization, the trained models are aggregated on the server by averaging the trained parameters from different participants. However, as the local models<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>In this paper, we use the terms <span id="footnote1.1" class="ltx_text ltx_font_italic">locally trained model</span> and <span id="footnote1.2" class="ltx_text ltx_font_italic">local model</span> interchangeably. Similarly, we give no difference the terms between <span id="footnote1.3" class="ltx_text ltx_font_italic">aggregated model</span> and <span id="footnote1.4" class="ltx_text ltx_font_italic">global model</span>.</span></span></span> are trained to fit the local data distribution instead of the global data distribution, heterogeneity of data distribution (i.e., Non-IID data) degrades the performance of the federated learning <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib16" title="" class="ltx_ref">2018</a>, <a href="#bib.bib18" title="" class="ltx_ref">2019</a>; Karimireddy et al. <a href="#bib.bib8" title="" class="ltx_ref">2020</a>; Li, He, and Song <a href="#bib.bib15" title="" class="ltx_ref">2021</a>; Li et al. <a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite>. The promising way to overcome such degradation is to constrain the local optimization using the global model which is typically treated as more reliable and generalized than the local models <cite class="ltx_cite ltx_citemacro_citep">(Li, He, and Song <a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite>. However, recent works find that these approaches still suffer performance degradation and show no advantages over FedAvg in several heterogeneity settings <cite class="ltx_cite ltx_citemacro_citep">(Luo et al. <a href="#bib.bib21" title="" class="ltx_ref">2021</a>; Li, He, and Song <a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To further understand the performance degradation, we perform an in-depth analysis about the robustness against client drift when constraining outputs <cite class="ltx_cite ltx_citemacro_citep">(Li, He, and Song <a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite> and parameters <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib16" title="" class="ltx_ref">2018</a>; Luo et al. <a href="#bib.bib21" title="" class="ltx_ref">2021</a>)</cite> of different layers on the settings of heterogeneous federated learning. Interestingly, we observe that regularizing the classifier’s outputs, which is not the target in most works, is quite effective to prevent the drift while constraining others still suffer from the client drift.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Motivated by our upfront analysis, we propose a novel method to prevent client drift in the heterogeneous environment, coined Learning from Drift (LfD). Unlike the previous works that the model is constrained to generate the same features and parameters as the global model, our scheme mainly focuses on the prediction differences on the same data between the local and the global model (we denote the difference as <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">drift</span>), and it roughly contains how the local model differs from the global model over the categorical distribution. Based on that, the model is trained with the drift regularization, which enforces the training model not to fall in the drift direction.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We compare LfD with strong baselines through the lens of five important factors for federated learning on heterogeneous environments, which are generalization, heterogeneity, scalability, catastrophic forgetting, and efficiency. Comprehensive results show that LfD effectively prevents client drift while yielding strong performance for federated learning. For example, compared to strong baselines, LfD achieves the state-of-the-art performance and shows nearly the same performance as the training on the total dataset in several heterogeneous settings. In summary, our contributions include followings:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We perform an in-depth analysis about the client drift when constraining different parts of the local model. Interestingly, we find that constraining classifier’s output is most effective to prevent the client drift while others still suffer from the drift (Section <a href="#S3" title="3 Global constraint on Federated Learning ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">Based on our analysis, we propose a robust federated learning algorithm against diverse heterogeneous settings by explicitly estimating the drift and regularizing local models over the prediction space. (Section <a href="#S4" title="4 Learning from Drift (LfD) ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We compare the proposed method with the strong baselines via the five important aspects of federated learning and observe that LfD achieves the best performance over diverse heterogeneous settings and datasets (Section <a href="#S5" title="5 Evaluations ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>).</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Problem setup</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.8" class="ltx_p"><span id="S2.p1.8.1" class="ltx_text ltx_font_bold">Federated Learning.</span> We assume there is a central server that can transmit and receive messages from <math id="S2.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">K</annotation></semantics></math> client devices in federated learning. Each client <math id="S2.p1.2.m2.1" class="ltx_Math" alttext="k\in[K]" display="inline"><semantics id="S2.p1.2.m2.1a"><mrow id="S2.p1.2.m2.1.2" xref="S2.p1.2.m2.1.2.cmml"><mi id="S2.p1.2.m2.1.2.2" xref="S2.p1.2.m2.1.2.2.cmml">k</mi><mo id="S2.p1.2.m2.1.2.1" xref="S2.p1.2.m2.1.2.1.cmml">∈</mo><mrow id="S2.p1.2.m2.1.2.3.2" xref="S2.p1.2.m2.1.2.3.1.cmml"><mo stretchy="false" id="S2.p1.2.m2.1.2.3.2.1" xref="S2.p1.2.m2.1.2.3.1.1.cmml">[</mo><mi id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">K</mi><mo stretchy="false" id="S2.p1.2.m2.1.2.3.2.2" xref="S2.p1.2.m2.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><apply id="S2.p1.2.m2.1.2.cmml" xref="S2.p1.2.m2.1.2"><in id="S2.p1.2.m2.1.2.1.cmml" xref="S2.p1.2.m2.1.2.1"></in><ci id="S2.p1.2.m2.1.2.2.cmml" xref="S2.p1.2.m2.1.2.2">𝑘</ci><apply id="S2.p1.2.m2.1.2.3.1.cmml" xref="S2.p1.2.m2.1.2.3.2"><csymbol cd="latexml" id="S2.p1.2.m2.1.2.3.1.1.cmml" xref="S2.p1.2.m2.1.2.3.2.1">delimited-[]</csymbol><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">k\in[K]</annotation></semantics></math> has its local data <math id="S2.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S2.p1.3.m3.1a"><msub id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.3.m3.1.1.2" xref="S2.p1.3.m3.1.1.2.cmml">𝒟</mi><mi id="S2.p1.3.m3.1.1.3" xref="S2.p1.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><apply id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.1.cmml" xref="S2.p1.3.m3.1.1">subscript</csymbol><ci id="S2.p1.3.m3.1.1.2.cmml" xref="S2.p1.3.m3.1.1.2">𝒟</ci><ci id="S2.p1.3.m3.1.1.3.cmml" xref="S2.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">\mathcal{D}_{k}</annotation></semantics></math> which consists of <math id="S2.p1.4.m4.1" class="ltx_Math" alttext="N_{k}" display="inline"><semantics id="S2.p1.4.m4.1a"><msub id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml"><mi id="S2.p1.4.m4.1.1.2" xref="S2.p1.4.m4.1.1.2.cmml">N</mi><mi id="S2.p1.4.m4.1.1.3" xref="S2.p1.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><apply id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.1.cmml" xref="S2.p1.4.m4.1.1">subscript</csymbol><ci id="S2.p1.4.m4.1.1.2.cmml" xref="S2.p1.4.m4.1.1.2">𝑁</ci><ci id="S2.p1.4.m4.1.1.3.cmml" xref="S2.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">N_{k}</annotation></semantics></math> training instances in the form of input features <math id="S2.p1.5.m5.1" class="ltx_Math" alttext="\boldsymbol{x}" display="inline"><semantics id="S2.p1.5.m5.1a"><mi id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><ci id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">\boldsymbol{x}</annotation></semantics></math> and its corresponding label <math id="S2.p1.6.m6.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S2.p1.6.m6.1a"><mi id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><ci id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">y</annotation></semantics></math>. The objective for federated learning is to learn a single model that performs well on the distributed dataset without sharing the data between clients. To this end, the server first sends a global model parameterized by <math id="S2.p1.7.m7.1" class="ltx_Math" alttext="\boldsymbol{\omega}_{t}" display="inline"><semantics id="S2.p1.7.m7.1a"><msub id="S2.p1.7.m7.1.1" xref="S2.p1.7.m7.1.1.cmml"><mi id="S2.p1.7.m7.1.1.2" xref="S2.p1.7.m7.1.1.2.cmml">𝝎</mi><mi id="S2.p1.7.m7.1.1.3" xref="S2.p1.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.7.m7.1b"><apply id="S2.p1.7.m7.1.1.cmml" xref="S2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.p1.7.m7.1.1.1.cmml" xref="S2.p1.7.m7.1.1">subscript</csymbol><ci id="S2.p1.7.m7.1.1.2.cmml" xref="S2.p1.7.m7.1.1.2">𝝎</ci><ci id="S2.p1.7.m7.1.1.3.cmml" xref="S2.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m7.1c">\boldsymbol{\omega}_{t}</annotation></semantics></math> to each client where subscript <math id="S2.p1.8.m8.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.p1.8.m8.1a"><mi id="S2.p1.8.m8.1.1" xref="S2.p1.8.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p1.8.m8.1b"><ci id="S2.p1.8.m8.1.1.cmml" xref="S2.p1.8.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m8.1c">t</annotation></semantics></math> indicates the current communication round, and the clients update the received model by optimizing the following local objective:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.2" class="ltx_math_unparsed" alttext="\min_{\boldsymbol{\omega}_{t}^{k}}\mathop{\mathbb{E}}{}_{(\boldsymbol{x},y)\sim\mathcal{D}_{k}}[\mathcal{L}(\boldsymbol{x},y;\boldsymbol{\omega}_{t}^{k})]" display="block"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2b"><munder id="S2.E1.m1.2.3"><mi id="S2.E1.m1.2.3.2">min</mi><msubsup id="S2.E1.m1.2.3.3"><mi id="S2.E1.m1.2.3.3.2.2">𝝎</mi><mi id="S2.E1.m1.2.3.3.2.3">t</mi><mi id="S2.E1.m1.2.3.3.3">k</mi></msubsup></munder><mo lspace="0.167em" movablelimits="false" rspace="0em" id="S2.E1.m1.2.4">𝔼</mo><mmultiscripts id="S2.E1.m1.2.5"><mrow id="S2.E1.m1.2.5.2"><mo stretchy="false" id="S2.E1.m1.2.5.2.1">[</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.2.5.2.2">ℒ</mi><mrow id="S2.E1.m1.2.5.2.3"><mo stretchy="false" id="S2.E1.m1.2.5.2.3.1">(</mo><mi id="S2.E1.m1.2.5.2.3.2">𝒙</mi><mo id="S2.E1.m1.2.5.2.3.3">,</mo><mi id="S2.E1.m1.2.5.2.3.4">y</mi><mo id="S2.E1.m1.2.5.2.3.5">;</mo><msubsup id="S2.E1.m1.2.5.2.3.6"><mi id="S2.E1.m1.2.5.2.3.6.2.2">𝝎</mi><mi id="S2.E1.m1.2.5.2.3.6.2.3">t</mi><mi id="S2.E1.m1.2.5.2.3.6.3">k</mi></msubsup><mo stretchy="false" id="S2.E1.m1.2.5.2.3.7">)</mo></mrow><mo stretchy="false" id="S2.E1.m1.2.5.2.4">]</mo></mrow><mprescripts id="S2.E1.m1.2.5a"></mprescripts><mrow id="S2.E1.m1.2.2.2"><mrow id="S2.E1.m1.2.2.2.4.2"><mo stretchy="false" id="S2.E1.m1.2.2.2.4.2.1">(</mo><mi id="S2.E1.m1.1.1.1.1">𝒙</mi><mo id="S2.E1.m1.2.2.2.4.2.2">,</mo><mi id="S2.E1.m1.2.2.2.2">y</mi><mo stretchy="false" id="S2.E1.m1.2.2.2.4.2.3">)</mo></mrow><mo id="S2.E1.m1.2.2.2.3">∼</mo><msub id="S2.E1.m1.2.2.2.5"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.2.2.2.5.2">𝒟</mi><mi id="S2.E1.m1.2.2.2.5.3">k</mi></msub></mrow><mrow id="S2.E1.m1.2.5b"></mrow></mmultiscripts></mrow><annotation encoding="application/x-tex" id="S2.E1.m1.2c">\min_{\boldsymbol{\omega}_{t}^{k}}\mathop{\mathbb{E}}{}_{(\boldsymbol{x},y)\sim\mathcal{D}_{k}}[\mathcal{L}(\boldsymbol{x},y;\boldsymbol{\omega}_{t}^{k})]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.p1.12" class="ltx_p">where <math id="S2.p1.9.m1.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S2.p1.9.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.9.m1.1.1" xref="S2.p1.9.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S2.p1.9.m1.1b"><ci id="S2.p1.9.m1.1.1.cmml" xref="S2.p1.9.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.9.m1.1c">\mathcal{L}</annotation></semantics></math> is the algorithm-dependent loss function, and <math id="S2.p1.10.m2.1" class="ltx_Math" alttext="\boldsymbol{\omega}_{t}^{k}" display="inline"><semantics id="S2.p1.10.m2.1a"><msubsup id="S2.p1.10.m2.1.1" xref="S2.p1.10.m2.1.1.cmml"><mi id="S2.p1.10.m2.1.1.2.2" xref="S2.p1.10.m2.1.1.2.2.cmml">𝝎</mi><mi id="S2.p1.10.m2.1.1.2.3" xref="S2.p1.10.m2.1.1.2.3.cmml">t</mi><mi id="S2.p1.10.m2.1.1.3" xref="S2.p1.10.m2.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p1.10.m2.1b"><apply id="S2.p1.10.m2.1.1.cmml" xref="S2.p1.10.m2.1.1"><csymbol cd="ambiguous" id="S2.p1.10.m2.1.1.1.cmml" xref="S2.p1.10.m2.1.1">superscript</csymbol><apply id="S2.p1.10.m2.1.1.2.cmml" xref="S2.p1.10.m2.1.1"><csymbol cd="ambiguous" id="S2.p1.10.m2.1.1.2.1.cmml" xref="S2.p1.10.m2.1.1">subscript</csymbol><ci id="S2.p1.10.m2.1.1.2.2.cmml" xref="S2.p1.10.m2.1.1.2.2">𝝎</ci><ci id="S2.p1.10.m2.1.1.2.3.cmml" xref="S2.p1.10.m2.1.1.2.3">𝑡</ci></apply><ci id="S2.p1.10.m2.1.1.3.cmml" xref="S2.p1.10.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.10.m2.1c">\boldsymbol{\omega}_{t}^{k}</annotation></semantics></math> indicates the locally optimized model initialized by the global model <math id="S2.p1.11.m3.1" class="ltx_Math" alttext="\boldsymbol{\omega}_{t}" display="inline"><semantics id="S2.p1.11.m3.1a"><msub id="S2.p1.11.m3.1.1" xref="S2.p1.11.m3.1.1.cmml"><mi id="S2.p1.11.m3.1.1.2" xref="S2.p1.11.m3.1.1.2.cmml">𝝎</mi><mi id="S2.p1.11.m3.1.1.3" xref="S2.p1.11.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.11.m3.1b"><apply id="S2.p1.11.m3.1.1.cmml" xref="S2.p1.11.m3.1.1"><csymbol cd="ambiguous" id="S2.p1.11.m3.1.1.1.cmml" xref="S2.p1.11.m3.1.1">subscript</csymbol><ci id="S2.p1.11.m3.1.1.2.cmml" xref="S2.p1.11.m3.1.1.2">𝝎</ci><ci id="S2.p1.11.m3.1.1.3.cmml" xref="S2.p1.11.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.11.m3.1c">\boldsymbol{\omega}_{t}</annotation></semantics></math>. After the local optimization, the server aggregates the local models <math id="S2.p1.12.m4.3" class="ltx_Math" alttext="\boldsymbol{\omega}_{t}^{i}\text{ where }i\in\{1,2,...K\}" display="inline"><semantics id="S2.p1.12.m4.3a"><mrow id="S2.p1.12.m4.3.3" xref="S2.p1.12.m4.3.3.cmml"><mrow id="S2.p1.12.m4.3.3.3" xref="S2.p1.12.m4.3.3.3.cmml"><msubsup id="S2.p1.12.m4.3.3.3.2" xref="S2.p1.12.m4.3.3.3.2.cmml"><mi id="S2.p1.12.m4.3.3.3.2.2.2" xref="S2.p1.12.m4.3.3.3.2.2.2.cmml">𝝎</mi><mi id="S2.p1.12.m4.3.3.3.2.2.3" xref="S2.p1.12.m4.3.3.3.2.2.3.cmml">t</mi><mi id="S2.p1.12.m4.3.3.3.2.3" xref="S2.p1.12.m4.3.3.3.2.3.cmml">i</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.p1.12.m4.3.3.3.1" xref="S2.p1.12.m4.3.3.3.1.cmml">​</mo><mtext id="S2.p1.12.m4.3.3.3.3" xref="S2.p1.12.m4.3.3.3.3a.cmml"> where </mtext><mo lspace="0em" rspace="0em" id="S2.p1.12.m4.3.3.3.1a" xref="S2.p1.12.m4.3.3.3.1.cmml">​</mo><mi id="S2.p1.12.m4.3.3.3.4" xref="S2.p1.12.m4.3.3.3.4.cmml">i</mi></mrow><mo id="S2.p1.12.m4.3.3.2" xref="S2.p1.12.m4.3.3.2.cmml">∈</mo><mrow id="S2.p1.12.m4.3.3.1.1" xref="S2.p1.12.m4.3.3.1.2.cmml"><mo stretchy="false" id="S2.p1.12.m4.3.3.1.1.2" xref="S2.p1.12.m4.3.3.1.2.cmml">{</mo><mn id="S2.p1.12.m4.1.1" xref="S2.p1.12.m4.1.1.cmml">1</mn><mo id="S2.p1.12.m4.3.3.1.1.3" xref="S2.p1.12.m4.3.3.1.2.cmml">,</mo><mn id="S2.p1.12.m4.2.2" xref="S2.p1.12.m4.2.2.cmml">2</mn><mo id="S2.p1.12.m4.3.3.1.1.4" xref="S2.p1.12.m4.3.3.1.2.cmml">,</mo><mrow id="S2.p1.12.m4.3.3.1.1.1" xref="S2.p1.12.m4.3.3.1.1.1.cmml"><mi mathvariant="normal" id="S2.p1.12.m4.3.3.1.1.1.2" xref="S2.p1.12.m4.3.3.1.1.1.2.cmml">…</mi><mo lspace="0em" rspace="0em" id="S2.p1.12.m4.3.3.1.1.1.1" xref="S2.p1.12.m4.3.3.1.1.1.1.cmml">​</mo><mi id="S2.p1.12.m4.3.3.1.1.1.3" xref="S2.p1.12.m4.3.3.1.1.1.3.cmml">K</mi></mrow><mo stretchy="false" id="S2.p1.12.m4.3.3.1.1.5" xref="S2.p1.12.m4.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.12.m4.3b"><apply id="S2.p1.12.m4.3.3.cmml" xref="S2.p1.12.m4.3.3"><in id="S2.p1.12.m4.3.3.2.cmml" xref="S2.p1.12.m4.3.3.2"></in><apply id="S2.p1.12.m4.3.3.3.cmml" xref="S2.p1.12.m4.3.3.3"><times id="S2.p1.12.m4.3.3.3.1.cmml" xref="S2.p1.12.m4.3.3.3.1"></times><apply id="S2.p1.12.m4.3.3.3.2.cmml" xref="S2.p1.12.m4.3.3.3.2"><csymbol cd="ambiguous" id="S2.p1.12.m4.3.3.3.2.1.cmml" xref="S2.p1.12.m4.3.3.3.2">superscript</csymbol><apply id="S2.p1.12.m4.3.3.3.2.2.cmml" xref="S2.p1.12.m4.3.3.3.2"><csymbol cd="ambiguous" id="S2.p1.12.m4.3.3.3.2.2.1.cmml" xref="S2.p1.12.m4.3.3.3.2">subscript</csymbol><ci id="S2.p1.12.m4.3.3.3.2.2.2.cmml" xref="S2.p1.12.m4.3.3.3.2.2.2">𝝎</ci><ci id="S2.p1.12.m4.3.3.3.2.2.3.cmml" xref="S2.p1.12.m4.3.3.3.2.2.3">𝑡</ci></apply><ci id="S2.p1.12.m4.3.3.3.2.3.cmml" xref="S2.p1.12.m4.3.3.3.2.3">𝑖</ci></apply><ci id="S2.p1.12.m4.3.3.3.3a.cmml" xref="S2.p1.12.m4.3.3.3.3"><mtext id="S2.p1.12.m4.3.3.3.3.cmml" xref="S2.p1.12.m4.3.3.3.3"> where </mtext></ci><ci id="S2.p1.12.m4.3.3.3.4.cmml" xref="S2.p1.12.m4.3.3.3.4">𝑖</ci></apply><set id="S2.p1.12.m4.3.3.1.2.cmml" xref="S2.p1.12.m4.3.3.1.1"><cn type="integer" id="S2.p1.12.m4.1.1.cmml" xref="S2.p1.12.m4.1.1">1</cn><cn type="integer" id="S2.p1.12.m4.2.2.cmml" xref="S2.p1.12.m4.2.2">2</cn><apply id="S2.p1.12.m4.3.3.1.1.1.cmml" xref="S2.p1.12.m4.3.3.1.1.1"><times id="S2.p1.12.m4.3.3.1.1.1.1.cmml" xref="S2.p1.12.m4.3.3.1.1.1.1"></times><ci id="S2.p1.12.m4.3.3.1.1.1.2.cmml" xref="S2.p1.12.m4.3.3.1.1.1.2">…</ci><ci id="S2.p1.12.m4.3.3.1.1.1.3.cmml" xref="S2.p1.12.m4.3.3.1.1.1.3">𝐾</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.12.m4.3c">\boldsymbol{\omega}_{t}^{i}\text{ where }i\in\{1,2,...K\}</annotation></semantics></math> to update the global model by weighted averaging the models:</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.1" class="ltx_Math" alttext="\boldsymbol{\omega}_{t+1}=\sum_{k=1}^{K}p_{k}\boldsymbol{\omega}_{t}^{k}" display="block"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><msub id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml"><mi id="S2.E2.m1.1.1.2.2" xref="S2.E2.m1.1.1.2.2.cmml">𝝎</mi><mrow id="S2.E2.m1.1.1.2.3" xref="S2.E2.m1.1.1.2.3.cmml"><mi id="S2.E2.m1.1.1.2.3.2" xref="S2.E2.m1.1.1.2.3.2.cmml">t</mi><mo id="S2.E2.m1.1.1.2.3.1" xref="S2.E2.m1.1.1.2.3.1.cmml">+</mo><mn id="S2.E2.m1.1.1.2.3.3" xref="S2.E2.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo rspace="0.111em" id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.cmml">=</mo><mrow id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml"><munderover id="S2.E2.m1.1.1.3.1" xref="S2.E2.m1.1.1.3.1.cmml"><mo movablelimits="false" id="S2.E2.m1.1.1.3.1.2.2" xref="S2.E2.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E2.m1.1.1.3.1.2.3" xref="S2.E2.m1.1.1.3.1.2.3.cmml"><mi id="S2.E2.m1.1.1.3.1.2.3.2" xref="S2.E2.m1.1.1.3.1.2.3.2.cmml">k</mi><mo id="S2.E2.m1.1.1.3.1.2.3.1" xref="S2.E2.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.E2.m1.1.1.3.1.2.3.3" xref="S2.E2.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E2.m1.1.1.3.1.3" xref="S2.E2.m1.1.1.3.1.3.cmml">K</mi></munderover><mrow id="S2.E2.m1.1.1.3.2" xref="S2.E2.m1.1.1.3.2.cmml"><msub id="S2.E2.m1.1.1.3.2.2" xref="S2.E2.m1.1.1.3.2.2.cmml"><mi id="S2.E2.m1.1.1.3.2.2.2" xref="S2.E2.m1.1.1.3.2.2.2.cmml">p</mi><mi id="S2.E2.m1.1.1.3.2.2.3" xref="S2.E2.m1.1.1.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.3.2.1" xref="S2.E2.m1.1.1.3.2.1.cmml">​</mo><msubsup id="S2.E2.m1.1.1.3.2.3" xref="S2.E2.m1.1.1.3.2.3.cmml"><mi id="S2.E2.m1.1.1.3.2.3.2.2" xref="S2.E2.m1.1.1.3.2.3.2.2.cmml">𝝎</mi><mi id="S2.E2.m1.1.1.3.2.3.2.3" xref="S2.E2.m1.1.1.3.2.3.2.3.cmml">t</mi><mi id="S2.E2.m1.1.1.3.2.3.3" xref="S2.E2.m1.1.1.3.2.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><eq id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"></eq><apply id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.2.2">𝝎</ci><apply id="S2.E2.m1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.2.3"><plus id="S2.E2.m1.1.1.2.3.1.cmml" xref="S2.E2.m1.1.1.2.3.1"></plus><ci id="S2.E2.m1.1.1.2.3.2.cmml" xref="S2.E2.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S2.E2.m1.1.1.2.3.3.cmml" xref="S2.E2.m1.1.1.2.3.3">1</cn></apply></apply><apply id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3"><apply id="S2.E2.m1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.1.1.cmml" xref="S2.E2.m1.1.1.3.1">superscript</csymbol><apply id="S2.E2.m1.1.1.3.1.2.cmml" xref="S2.E2.m1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.1.2.1.cmml" xref="S2.E2.m1.1.1.3.1">subscript</csymbol><sum id="S2.E2.m1.1.1.3.1.2.2.cmml" xref="S2.E2.m1.1.1.3.1.2.2"></sum><apply id="S2.E2.m1.1.1.3.1.2.3.cmml" xref="S2.E2.m1.1.1.3.1.2.3"><eq id="S2.E2.m1.1.1.3.1.2.3.1.cmml" xref="S2.E2.m1.1.1.3.1.2.3.1"></eq><ci id="S2.E2.m1.1.1.3.1.2.3.2.cmml" xref="S2.E2.m1.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="S2.E2.m1.1.1.3.1.2.3.3.cmml" xref="S2.E2.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.1.1.3.1.3.cmml" xref="S2.E2.m1.1.1.3.1.3">𝐾</ci></apply><apply id="S2.E2.m1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.3.2"><times id="S2.E2.m1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.3.2.1"></times><apply id="S2.E2.m1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.2.2.1.cmml" xref="S2.E2.m1.1.1.3.2.2">subscript</csymbol><ci id="S2.E2.m1.1.1.3.2.2.2.cmml" xref="S2.E2.m1.1.1.3.2.2.2">𝑝</ci><ci id="S2.E2.m1.1.1.3.2.2.3.cmml" xref="S2.E2.m1.1.1.3.2.2.3">𝑘</ci></apply><apply id="S2.E2.m1.1.1.3.2.3.cmml" xref="S2.E2.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.2.3.1.cmml" xref="S2.E2.m1.1.1.3.2.3">superscript</csymbol><apply id="S2.E2.m1.1.1.3.2.3.2.cmml" xref="S2.E2.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.2.3.2.1.cmml" xref="S2.E2.m1.1.1.3.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.3.2.3.2.2.cmml" xref="S2.E2.m1.1.1.3.2.3.2.2">𝝎</ci><ci id="S2.E2.m1.1.1.3.2.3.2.3.cmml" xref="S2.E2.m1.1.1.3.2.3.2.3">𝑡</ci></apply><ci id="S2.E2.m1.1.1.3.2.3.3.cmml" xref="S2.E2.m1.1.1.3.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\boldsymbol{\omega}_{t+1}=\sum_{k=1}^{K}p_{k}\boldsymbol{\omega}_{t}^{k}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.p1.14" class="ltx_p">where the weight <math id="S2.p1.13.m1.1" class="ltx_Math" alttext="p_{k}" display="inline"><semantics id="S2.p1.13.m1.1a"><msub id="S2.p1.13.m1.1.1" xref="S2.p1.13.m1.1.1.cmml"><mi id="S2.p1.13.m1.1.1.2" xref="S2.p1.13.m1.1.1.2.cmml">p</mi><mi id="S2.p1.13.m1.1.1.3" xref="S2.p1.13.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.13.m1.1b"><apply id="S2.p1.13.m1.1.1.cmml" xref="S2.p1.13.m1.1.1"><csymbol cd="ambiguous" id="S2.p1.13.m1.1.1.1.cmml" xref="S2.p1.13.m1.1.1">subscript</csymbol><ci id="S2.p1.13.m1.1.1.2.cmml" xref="S2.p1.13.m1.1.1.2">𝑝</ci><ci id="S2.p1.13.m1.1.1.3.cmml" xref="S2.p1.13.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.13.m1.1c">p_{k}</annotation></semantics></math> is typically determined by the number of the local data over the entire dataset, i.e., <math id="S2.p1.14.m2.2" class="ltx_Math" alttext="p_{k}=|\mathcal{D}_{k}|/\sum_{j=1}^{K}|\mathcal{D}_{j}|" display="inline"><semantics id="S2.p1.14.m2.2a"><mrow id="S2.p1.14.m2.2.2" xref="S2.p1.14.m2.2.2.cmml"><msub id="S2.p1.14.m2.2.2.4" xref="S2.p1.14.m2.2.2.4.cmml"><mi id="S2.p1.14.m2.2.2.4.2" xref="S2.p1.14.m2.2.2.4.2.cmml">p</mi><mi id="S2.p1.14.m2.2.2.4.3" xref="S2.p1.14.m2.2.2.4.3.cmml">k</mi></msub><mo id="S2.p1.14.m2.2.2.3" xref="S2.p1.14.m2.2.2.3.cmml">=</mo><mrow id="S2.p1.14.m2.2.2.2" xref="S2.p1.14.m2.2.2.2.cmml"><mrow id="S2.p1.14.m2.1.1.1.1.1" xref="S2.p1.14.m2.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.p1.14.m2.1.1.1.1.1.2" xref="S2.p1.14.m2.1.1.1.1.2.1.cmml">|</mo><msub id="S2.p1.14.m2.1.1.1.1.1.1" xref="S2.p1.14.m2.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.14.m2.1.1.1.1.1.1.2" xref="S2.p1.14.m2.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S2.p1.14.m2.1.1.1.1.1.1.3" xref="S2.p1.14.m2.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.p1.14.m2.1.1.1.1.1.3" xref="S2.p1.14.m2.1.1.1.1.2.1.cmml">|</mo></mrow><mo rspace="0.055em" id="S2.p1.14.m2.2.2.2.3" xref="S2.p1.14.m2.2.2.2.3.cmml">/</mo><mrow id="S2.p1.14.m2.2.2.2.2" xref="S2.p1.14.m2.2.2.2.2.cmml"><msubsup id="S2.p1.14.m2.2.2.2.2.2" xref="S2.p1.14.m2.2.2.2.2.2.cmml"><mo rspace="0em" id="S2.p1.14.m2.2.2.2.2.2.2.2" xref="S2.p1.14.m2.2.2.2.2.2.2.2.cmml">∑</mo><mrow id="S2.p1.14.m2.2.2.2.2.2.2.3" xref="S2.p1.14.m2.2.2.2.2.2.2.3.cmml"><mi id="S2.p1.14.m2.2.2.2.2.2.2.3.2" xref="S2.p1.14.m2.2.2.2.2.2.2.3.2.cmml">j</mi><mo id="S2.p1.14.m2.2.2.2.2.2.2.3.1" xref="S2.p1.14.m2.2.2.2.2.2.2.3.1.cmml">=</mo><mn id="S2.p1.14.m2.2.2.2.2.2.2.3.3" xref="S2.p1.14.m2.2.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S2.p1.14.m2.2.2.2.2.2.3" xref="S2.p1.14.m2.2.2.2.2.2.3.cmml">K</mi></msubsup><mrow id="S2.p1.14.m2.2.2.2.2.1.1" xref="S2.p1.14.m2.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S2.p1.14.m2.2.2.2.2.1.1.2" xref="S2.p1.14.m2.2.2.2.2.1.2.1.cmml">|</mo><msub id="S2.p1.14.m2.2.2.2.2.1.1.1" xref="S2.p1.14.m2.2.2.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.14.m2.2.2.2.2.1.1.1.2" xref="S2.p1.14.m2.2.2.2.2.1.1.1.2.cmml">𝒟</mi><mi id="S2.p1.14.m2.2.2.2.2.1.1.1.3" xref="S2.p1.14.m2.2.2.2.2.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S2.p1.14.m2.2.2.2.2.1.1.3" xref="S2.p1.14.m2.2.2.2.2.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.14.m2.2b"><apply id="S2.p1.14.m2.2.2.cmml" xref="S2.p1.14.m2.2.2"><eq id="S2.p1.14.m2.2.2.3.cmml" xref="S2.p1.14.m2.2.2.3"></eq><apply id="S2.p1.14.m2.2.2.4.cmml" xref="S2.p1.14.m2.2.2.4"><csymbol cd="ambiguous" id="S2.p1.14.m2.2.2.4.1.cmml" xref="S2.p1.14.m2.2.2.4">subscript</csymbol><ci id="S2.p1.14.m2.2.2.4.2.cmml" xref="S2.p1.14.m2.2.2.4.2">𝑝</ci><ci id="S2.p1.14.m2.2.2.4.3.cmml" xref="S2.p1.14.m2.2.2.4.3">𝑘</ci></apply><apply id="S2.p1.14.m2.2.2.2.cmml" xref="S2.p1.14.m2.2.2.2"><divide id="S2.p1.14.m2.2.2.2.3.cmml" xref="S2.p1.14.m2.2.2.2.3"></divide><apply id="S2.p1.14.m2.1.1.1.1.2.cmml" xref="S2.p1.14.m2.1.1.1.1.1"><abs id="S2.p1.14.m2.1.1.1.1.2.1.cmml" xref="S2.p1.14.m2.1.1.1.1.1.2"></abs><apply id="S2.p1.14.m2.1.1.1.1.1.1.cmml" xref="S2.p1.14.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.14.m2.1.1.1.1.1.1.1.cmml" xref="S2.p1.14.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.14.m2.1.1.1.1.1.1.2.cmml" xref="S2.p1.14.m2.1.1.1.1.1.1.2">𝒟</ci><ci id="S2.p1.14.m2.1.1.1.1.1.1.3.cmml" xref="S2.p1.14.m2.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S2.p1.14.m2.2.2.2.2.cmml" xref="S2.p1.14.m2.2.2.2.2"><apply id="S2.p1.14.m2.2.2.2.2.2.cmml" xref="S2.p1.14.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p1.14.m2.2.2.2.2.2.1.cmml" xref="S2.p1.14.m2.2.2.2.2.2">superscript</csymbol><apply id="S2.p1.14.m2.2.2.2.2.2.2.cmml" xref="S2.p1.14.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p1.14.m2.2.2.2.2.2.2.1.cmml" xref="S2.p1.14.m2.2.2.2.2.2">subscript</csymbol><sum id="S2.p1.14.m2.2.2.2.2.2.2.2.cmml" xref="S2.p1.14.m2.2.2.2.2.2.2.2"></sum><apply id="S2.p1.14.m2.2.2.2.2.2.2.3.cmml" xref="S2.p1.14.m2.2.2.2.2.2.2.3"><eq id="S2.p1.14.m2.2.2.2.2.2.2.3.1.cmml" xref="S2.p1.14.m2.2.2.2.2.2.2.3.1"></eq><ci id="S2.p1.14.m2.2.2.2.2.2.2.3.2.cmml" xref="S2.p1.14.m2.2.2.2.2.2.2.3.2">𝑗</ci><cn type="integer" id="S2.p1.14.m2.2.2.2.2.2.2.3.3.cmml" xref="S2.p1.14.m2.2.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S2.p1.14.m2.2.2.2.2.2.3.cmml" xref="S2.p1.14.m2.2.2.2.2.2.3">𝐾</ci></apply><apply id="S2.p1.14.m2.2.2.2.2.1.2.cmml" xref="S2.p1.14.m2.2.2.2.2.1.1"><abs id="S2.p1.14.m2.2.2.2.2.1.2.1.cmml" xref="S2.p1.14.m2.2.2.2.2.1.1.2"></abs><apply id="S2.p1.14.m2.2.2.2.2.1.1.1.cmml" xref="S2.p1.14.m2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.p1.14.m2.2.2.2.2.1.1.1.1.cmml" xref="S2.p1.14.m2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.p1.14.m2.2.2.2.2.1.1.1.2.cmml" xref="S2.p1.14.m2.2.2.2.2.1.1.1.2">𝒟</ci><ci id="S2.p1.14.m2.2.2.2.2.1.1.1.3.cmml" xref="S2.p1.14.m2.2.2.2.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.14.m2.2c">p_{k}=|\mathcal{D}_{k}|/\sum_{j=1}^{K}|\mathcal{D}_{j}|</annotation></semantics></math>. The server and participants repeat the above procedures until the the global model converges.</p>
</div>
<figure id="S2.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S2.F1.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.07189/assets/x1.png" id="S2.F1.sf1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="295" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S2.F1.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.07189/assets/x2.png" id="S2.F1.sf2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="301" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>CKA similarities and KL divergences during the local optimization with different global constraints.</figcaption>
</figure>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Global constraint on Federated Learning</h2>

<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Top-1 Test accuracy (%) of the methods with global constraints. The model without constraints is the same as FedAvg.</figcaption>
<p id="S3.T1.17" class="ltx_p ltx_align_center"><span id="S3.T1.17.17" class="ltx_text">
<span id="S3.T1.17.17.17" class="ltx_inline-block ltx_transformed_outer" style="width:285.2pt;height:108pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S3.T1.17.17.17.17" class="ltx_p"><span id="S3.T1.17.17.17.17.17" class="ltx_text">
<span id="S3.T1.17.17.17.17.17.17" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_thead">
<span id="S3.T1.17.17.17.17.17.17.18.1" class="ltx_tr">
<span id="S3.T1.17.17.17.17.17.17.18.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">Method</span>
<span id="S3.T1.17.17.17.17.17.17.18.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Feature constraint</span>
<span id="S3.T1.17.17.17.17.17.17.18.1.3" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt">Parameter constraint</span></span>
<span id="S3.T1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="S3.T1.1.1.1.1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">No constraint</span>
<span id="S3.T1.1.1.1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t ltx_colspan ltx_colspan_2">69.1 <math id="S3.T1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S3.T1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.1.1.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.1.1.1.1.1.m1.1b"><csymbol cd="latexml" id="S3.T1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.1.1.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.1.1.1.1.1.m1.1c">\pm</annotation></semantics></math> 0.6</span></span>
</span>
<span class="ltx_tbody">
<span id="S3.T1.5.5.5.5.5.5.5" class="ltx_tr">
<span id="S3.T1.5.5.5.5.5.5.5.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt">All</span>
<span id="S3.T1.3.3.3.3.3.3.3.2" class="ltx_td ltx_align_center ltx_border_tt">67.3 <math id="S3.T1.2.2.2.2.2.2.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.2.2.2.2.2.2.2.1.m1.1a"><mo id="S3.T1.2.2.2.2.2.2.2.1.m1.1.1" xref="S3.T1.2.2.2.2.2.2.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.2.2.2.2.1.m1.1b"><csymbol cd="latexml" id="S3.T1.2.2.2.2.2.2.2.1.m1.1.1.cmml" xref="S3.T1.2.2.2.2.2.2.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.2.2.2.2.1.m1.1c">\pm</annotation></semantics></math> 0.8 <span id="S3.T1.3.3.3.3.3.3.3.2.1" class="ltx_text" style="color:#BF0040;">(<math id="S3.T1.3.3.3.3.3.3.3.2.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S3.T1.3.3.3.3.3.3.3.2.1.m1.1a"><mo mathcolor="#BF0040" stretchy="false" id="S3.T1.3.3.3.3.3.3.3.2.1.m1.1.1" xref="S3.T1.3.3.3.3.3.3.3.2.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.3.3.3.3.3.2.1.m1.1b"><ci id="S3.T1.3.3.3.3.3.3.3.2.1.m1.1.1.cmml" xref="S3.T1.3.3.3.3.3.3.3.2.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.3.3.3.3.3.2.1.m1.1c">\downarrow</annotation></semantics></math> 1.8)</span></span>
<span id="S3.T1.5.5.5.5.5.5.5.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt">68.6 <math id="S3.T1.4.4.4.4.4.4.4.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.4.4.4.4.4.4.4.3.m1.1a"><mo id="S3.T1.4.4.4.4.4.4.4.3.m1.1.1" xref="S3.T1.4.4.4.4.4.4.4.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.4.4.4.4.4.3.m1.1b"><csymbol cd="latexml" id="S3.T1.4.4.4.4.4.4.4.3.m1.1.1.cmml" xref="S3.T1.4.4.4.4.4.4.4.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.4.4.4.4.4.3.m1.1c">\pm</annotation></semantics></math> 0.2 <span id="S3.T1.5.5.5.5.5.5.5.4.1" class="ltx_text" style="color:#BF0040;">(<math id="S3.T1.5.5.5.5.5.5.5.4.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S3.T1.5.5.5.5.5.5.5.4.1.m1.1a"><mo mathcolor="#BF0040" stretchy="false" id="S3.T1.5.5.5.5.5.5.5.4.1.m1.1.1" xref="S3.T1.5.5.5.5.5.5.5.4.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.5.5.5.5.5.4.1.m1.1b"><ci id="S3.T1.5.5.5.5.5.5.5.4.1.m1.1.1.cmml" xref="S3.T1.5.5.5.5.5.5.5.4.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.5.5.5.5.5.4.1.m1.1c">\downarrow</annotation></semantics></math> 0.5)</span></span></span>
<span id="S3.T1.9.9.9.9.9.9.9" class="ltx_tr">
<span id="S3.T1.9.9.9.9.9.9.9.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">Feature extractor</span>
<span id="S3.T1.7.7.7.7.7.7.7.2" class="ltx_td ltx_align_center">68.9 <math id="S3.T1.6.6.6.6.6.6.6.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.6.6.6.6.6.6.6.1.m1.1a"><mo id="S3.T1.6.6.6.6.6.6.6.1.m1.1.1" xref="S3.T1.6.6.6.6.6.6.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.6.6.6.6.6.1.m1.1b"><csymbol cd="latexml" id="S3.T1.6.6.6.6.6.6.6.1.m1.1.1.cmml" xref="S3.T1.6.6.6.6.6.6.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.6.6.6.6.6.1.m1.1c">\pm</annotation></semantics></math> 0.3 <span id="S3.T1.7.7.7.7.7.7.7.2.1" class="ltx_text" style="color:#BF0040;">(<math id="S3.T1.7.7.7.7.7.7.7.2.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S3.T1.7.7.7.7.7.7.7.2.1.m1.1a"><mo mathcolor="#BF0040" stretchy="false" id="S3.T1.7.7.7.7.7.7.7.2.1.m1.1.1" xref="S3.T1.7.7.7.7.7.7.7.2.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.7.7.7.7.7.2.1.m1.1b"><ci id="S3.T1.7.7.7.7.7.7.7.2.1.m1.1.1.cmml" xref="S3.T1.7.7.7.7.7.7.7.2.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.7.7.7.7.7.2.1.m1.1c">\downarrow</annotation></semantics></math> 0.2)</span></span>
<span id="S3.T1.9.9.9.9.9.9.9.4" class="ltx_td ltx_nopad_r ltx_align_center">69.5 <math id="S3.T1.8.8.8.8.8.8.8.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.8.8.8.8.8.8.8.3.m1.1a"><mo id="S3.T1.8.8.8.8.8.8.8.3.m1.1.1" xref="S3.T1.8.8.8.8.8.8.8.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.8.8.8.8.8.3.m1.1b"><csymbol cd="latexml" id="S3.T1.8.8.8.8.8.8.8.3.m1.1.1.cmml" xref="S3.T1.8.8.8.8.8.8.8.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.8.8.8.8.8.3.m1.1c">\pm</annotation></semantics></math> 0.3 <span id="S3.T1.9.9.9.9.9.9.9.4.1" class="ltx_text" style="color:#008080;">(<math id="S3.T1.9.9.9.9.9.9.9.4.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S3.T1.9.9.9.9.9.9.9.4.1.m1.1a"><mo mathcolor="#008080" stretchy="false" id="S3.T1.9.9.9.9.9.9.9.4.1.m1.1.1" xref="S3.T1.9.9.9.9.9.9.9.4.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.9.9.9.9.9.4.1.m1.1b"><ci id="S3.T1.9.9.9.9.9.9.9.4.1.m1.1.1.cmml" xref="S3.T1.9.9.9.9.9.9.9.4.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.9.9.9.9.9.4.1.m1.1c">\uparrow</annotation></semantics></math> 0.4)</span></span></span>
<span id="S3.T1.13.13.13.13.13.13.13" class="ltx_tr">
<span id="S3.T1.13.13.13.13.13.13.13.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">Header</span>
<span id="S3.T1.11.11.11.11.11.11.11.2" class="ltx_td ltx_align_center">69.6 <math id="S3.T1.10.10.10.10.10.10.10.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.10.10.10.10.10.10.10.1.m1.1a"><mo id="S3.T1.10.10.10.10.10.10.10.1.m1.1.1" xref="S3.T1.10.10.10.10.10.10.10.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.10.10.10.10.10.1.m1.1b"><csymbol cd="latexml" id="S3.T1.10.10.10.10.10.10.10.1.m1.1.1.cmml" xref="S3.T1.10.10.10.10.10.10.10.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.10.10.10.10.10.1.m1.1c">\pm</annotation></semantics></math> 0.5 <span id="S3.T1.11.11.11.11.11.11.11.2.1" class="ltx_text" style="color:#008080;">(<math id="S3.T1.11.11.11.11.11.11.11.2.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S3.T1.11.11.11.11.11.11.11.2.1.m1.1a"><mo mathcolor="#008080" stretchy="false" id="S3.T1.11.11.11.11.11.11.11.2.1.m1.1.1" xref="S3.T1.11.11.11.11.11.11.11.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.11.11.11.11.11.11.11.2.1.m1.1b"><ci id="S3.T1.11.11.11.11.11.11.11.2.1.m1.1.1.cmml" xref="S3.T1.11.11.11.11.11.11.11.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.11.11.11.11.11.11.2.1.m1.1c">\uparrow</annotation></semantics></math> 0.5)</span></span>
<span id="S3.T1.13.13.13.13.13.13.13.4" class="ltx_td ltx_nopad_r ltx_align_center">69.3 <math id="S3.T1.12.12.12.12.12.12.12.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.12.12.12.12.12.12.12.3.m1.1a"><mo id="S3.T1.12.12.12.12.12.12.12.3.m1.1.1" xref="S3.T1.12.12.12.12.12.12.12.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.12.12.12.12.12.12.12.3.m1.1b"><csymbol cd="latexml" id="S3.T1.12.12.12.12.12.12.12.3.m1.1.1.cmml" xref="S3.T1.12.12.12.12.12.12.12.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.12.12.12.12.12.12.3.m1.1c">\pm</annotation></semantics></math> 0.9 <span id="S3.T1.13.13.13.13.13.13.13.4.1" class="ltx_text" style="color:#008080;">(<math id="S3.T1.13.13.13.13.13.13.13.4.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S3.T1.13.13.13.13.13.13.13.4.1.m1.1a"><mo mathcolor="#008080" stretchy="false" id="S3.T1.13.13.13.13.13.13.13.4.1.m1.1.1" xref="S3.T1.13.13.13.13.13.13.13.4.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.13.13.13.13.13.13.13.4.1.m1.1b"><ci id="S3.T1.13.13.13.13.13.13.13.4.1.m1.1.1.cmml" xref="S3.T1.13.13.13.13.13.13.13.4.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.13.13.13.13.13.13.13.4.1.m1.1c">\uparrow</annotation></semantics></math> 0.2)</span></span></span>
<span id="S3.T1.17.17.17.17.17.17.17" class="ltx_tr">
<span id="S3.T1.17.17.17.17.17.17.17.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Classifier</span>
<span id="S3.T1.15.15.15.15.15.15.15.2" class="ltx_td ltx_align_center ltx_border_bb">70.8 <math id="S3.T1.14.14.14.14.14.14.14.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.14.14.14.14.14.14.14.1.m1.1a"><mo id="S3.T1.14.14.14.14.14.14.14.1.m1.1.1" xref="S3.T1.14.14.14.14.14.14.14.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.14.14.14.14.14.14.14.1.m1.1b"><csymbol cd="latexml" id="S3.T1.14.14.14.14.14.14.14.1.m1.1.1.cmml" xref="S3.T1.14.14.14.14.14.14.14.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.14.14.14.14.14.14.14.1.m1.1c">\pm</annotation></semantics></math> 0.4 <span id="S3.T1.15.15.15.15.15.15.15.2.1" class="ltx_text" style="color:#008080;">(<math id="S3.T1.15.15.15.15.15.15.15.2.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S3.T1.15.15.15.15.15.15.15.2.1.m1.1a"><mo mathcolor="#008080" stretchy="false" id="S3.T1.15.15.15.15.15.15.15.2.1.m1.1.1" xref="S3.T1.15.15.15.15.15.15.15.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.15.15.15.15.15.15.15.2.1.m1.1b"><ci id="S3.T1.15.15.15.15.15.15.15.2.1.m1.1.1.cmml" xref="S3.T1.15.15.15.15.15.15.15.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.15.15.15.15.15.15.15.2.1.m1.1c">\uparrow</annotation></semantics></math> 1.7)</span></span>
<span id="S3.T1.17.17.17.17.17.17.17.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb">69.7 <math id="S3.T1.16.16.16.16.16.16.16.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.16.16.16.16.16.16.16.3.m1.1a"><mo id="S3.T1.16.16.16.16.16.16.16.3.m1.1.1" xref="S3.T1.16.16.16.16.16.16.16.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.16.16.16.16.16.16.16.3.m1.1b"><csymbol cd="latexml" id="S3.T1.16.16.16.16.16.16.16.3.m1.1.1.cmml" xref="S3.T1.16.16.16.16.16.16.16.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.16.16.16.16.16.16.16.3.m1.1c">\pm</annotation></semantics></math> 0.5 <span id="S3.T1.17.17.17.17.17.17.17.4.1" class="ltx_text" style="color:#008080;">(<math id="S3.T1.17.17.17.17.17.17.17.4.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S3.T1.17.17.17.17.17.17.17.4.1.m1.1a"><mo mathcolor="#008080" stretchy="false" id="S3.T1.17.17.17.17.17.17.17.4.1.m1.1.1" xref="S3.T1.17.17.17.17.17.17.17.4.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.17.17.17.17.17.17.17.4.1.m1.1b"><ci id="S3.T1.17.17.17.17.17.17.17.4.1.m1.1.1.cmml" xref="S3.T1.17.17.17.17.17.17.17.4.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.17.17.17.17.17.17.17.4.1.m1.1c">\uparrow</annotation></semantics></math> 0.6)</span></span></span>
</span>
</span></span></span>
</span></span></span></p>
</figure>
<figure id="S3.F2" class="ltx_figure">
<div id="S3.F2.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:152.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-14.0pt,4.9pt) scale(0.93935,0.93935) ;">
<p id="S3.F2.1.1" class="ltx_p"><span id="S3.F2.1.1.1" class="ltx_text">
<span id="S3.F2.1.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:461.6pt;height:162.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S3.F2.1.1.1.1.1" class="ltx_p"><span id="S3.F2.1.1.1.1.1.1" class="ltx_text"><img src="/html/2309.07189/assets/x3.png" id="S3.F2.1.1.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="457" height="173" alt="Refer to caption"></span></span>
</span></span></span></p>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overview of the proposed method (LfD). Here, the client has the imbalanced data distribution where the samples for <span id="S3.F2.8.1" class="ltx_text ltx_font_italic">dog</span> are the majority while the samples for <span id="S3.F2.9.2" class="ltx_text ltx_font_italic">cat</span> are the minority. In this case, LfD estimates that the client reveals over-confidence to the class <span id="S3.F2.10.3" class="ltx_text ltx_font_italic">dog</span> and under-confidence to the class <span id="S3.F2.11.4" class="ltx_text ltx_font_italic">cat</span>. Afterward, LfD regularizes the local model to predict the same input with slightly lower confidence for <span id="S3.F2.12.5" class="ltx_text ltx_font_italic">dog</span> and higher confidence for <span id="S3.F2.13.6" class="ltx_text ltx_font_italic">cat</span> so as to align with the global model.</figcaption>
</figure>
<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">One of the widely-used approaches to prevent client-drift is to constrain the model not to deviate from the global model. To understand how these constraints affect the training model in federated learning on Non-IID data, we perform an analysis by conducting experiments on heterogeneous environments. The setting includes ten clients with heterogeneously distributed CIFAR-10 data (see Section <a href="#S5.SS1.SSSx1" title="Federated Simulation ‣ 5.1 Experimental Setup ‣ 5 Evaluations ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.1</span></a> for more information). Here, we constrain the model by minimizing the distance between the training local model and the global model, and the minimizing targets are feature vectors and parameters which are the representative targets in recent studies<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>For the feature constraint, the targets are the outputs from each component. For the parameter constraints, the targets are the trainable parameters of each layer.</span></span></span> <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib16" title="" class="ltx_ref">2018</a>; Li, He, and Song <a href="#bib.bib15" title="" class="ltx_ref">2021</a>; Luo et al. <a href="#bib.bib21" title="" class="ltx_ref">2021</a>)</cite>. The targets are further decomposed by their positions in the network architectures which are classifier, header<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>Header indicates the projection layers that are located between feature extractor and the classifier (i.e., the last layer). Headers are usually used at contrastive learning <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite>.</span></span></span>, and feature extractor. We trace the output logits’ similarity and prediction divergence to the global model during the local optimization to see the effects of the above constraints. For the similarity measure, we use centered kernel alignment (CKA) <cite class="ltx_cite ltx_citemacro_citep">(Kornblith et al. <a href="#bib.bib10" title="" class="ltx_ref">2019</a>)</cite> similarity and calculate the prediction divergence based on kullback-libeler divergence (KLD).</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">Figure <a href="#S2.F1" title="Figure 1 ‣ 2 Problem setup ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> reports the above measures during the local optimization. We first observe that the feature constraint encourages the training model to generate more similar features to the global model compared to the parameter constraint. When it comes to the divergence in the prediction, both constraints tend to show progressively deviating from the global model (i.e., increasing KL divergence) revealing that the model still suffers from the drift. However, it is noticeable that constraining the logits from the classifier makes the model less deviate from the global model, whereas regularizing the parameters of the classifier does not exhibit significant differences compared to other targets.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.1" class="ltx_p">As it is susceptible that constraining logits does not learn the local data while preserving the global knowledge, we estimate the federated learning performance of each constraint in Table <a href="#S3.T1" title="Table 1 ‣ 3 Global constraint on Federated Learning ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. From the evaluations, we first observe that the performance is more improved as regularization targets are deeper. In particular, we experimentally find that constraining the logits from the classifier is most effective to prevent the drift compared to other targets. Our finding is aligned with the recent work that demonstrates the deeper layers are vernerable to the client drift <cite class="ltx_cite ltx_citemacro_citep">(Luo et al. <a href="#bib.bib21" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Learning from Drift (LfD)</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this work, we propose a novel federated learning algorithm, coined Learning from Drift (LfD), for training a model in heterogeneous environments effectively. In an overview, LfD works in two major steps: drift estimation and drift regularization. In the first phase, LfD explicitly estimates the drift between the global model and the locally trained models on the logit space (Section <a href="#S4.SS1" title="4.1 Drift Estimation by Prediction Discrepancy ‣ 4 Learning from Drift (LfD) ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>). Afterward, the model in each client is trained with the regularization, thereby leading the model not to fall in the drift direction during the local optimization (Section <a href="#S4.SS2" title="4.2 Drift Regularization ‣ 4 Learning from Drift (LfD) ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>). Figure <a href="#S3.F2" title="Figure 2 ‣ 3 Global constraint on Federated Learning ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the overview of our method.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Drift Estimation by Prediction Discrepancy</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.3" class="ltx_p">Based on our upfront analysis, we quantify the degree of the client drift by estimating prediction discrepancy between locally trained models (i.e., <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\omega}_{t-1}^{k}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><msubsup id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2.2" xref="S4.SS1.p1.1.m1.1.1.2.2.cmml">𝝎</mi><mrow id="S4.SS1.p1.1.m1.1.1.2.3" xref="S4.SS1.p1.1.m1.1.1.2.3.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2.3.2" xref="S4.SS1.p1.1.m1.1.1.2.3.2.cmml">t</mi><mo id="S4.SS1.p1.1.m1.1.1.2.3.1" xref="S4.SS1.p1.1.m1.1.1.2.3.1.cmml">−</mo><mn id="S4.SS1.p1.1.m1.1.1.2.3.3" xref="S4.SS1.p1.1.m1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">superscript</csymbol><apply id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2.2">𝝎</ci><apply id="S4.SS1.p1.1.m1.1.1.2.3.cmml" xref="S4.SS1.p1.1.m1.1.1.2.3"><minus id="S4.SS1.p1.1.m1.1.1.2.3.1.cmml" xref="S4.SS1.p1.1.m1.1.1.2.3.1"></minus><ci id="S4.SS1.p1.1.m1.1.1.2.3.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S4.SS1.p1.1.m1.1.1.2.3.3.cmml" xref="S4.SS1.p1.1.m1.1.1.2.3.3">1</cn></apply></apply><ci id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\boldsymbol{\omega}_{t-1}^{k}</annotation></semantics></math>) in the previous communication and their aggregated model (i.e., <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\boldsymbol{\omega}_{t}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><msub id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">𝝎</mi><mi id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝝎</ci><ci id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\boldsymbol{\omega}_{t}</annotation></semantics></math>). The probability distribution over classes can be used to represent the prediction, and the drift for input <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">x</annotation></semantics></math> is defined as follows:</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.36" class="ltx_math_unparsed" alttext="\begin{split}f^{y_{i}}_{D}(x)&amp;=\log(\sigma(f^{y_{i}}_{P}(x))-\log(\sigma(f^{y_{i}}_{G}(x))\text{ , }\forall y_{i}\in\mathcal{Y}\end{split}" display="block"><semantics id="S4.E3.m1.36a"><mtable columnspacing="0pt" displaystyle="true" id="S4.E3.m1.36.36"><mtr id="S4.E3.m1.36.36a"><mtd class="ltx_align_right" columnalign="right" id="S4.E3.m1.36.36b"><mrow id="S4.E3.m1.6.6.6.6.6"><msubsup id="S4.E3.m1.6.6.6.6.6.8"><mi id="S4.E3.m1.1.1.1.1.1.1">f</mi><mi id="S4.E3.m1.3.3.3.3.3.3.1">D</mi><msub id="S4.E3.m1.2.2.2.2.2.2.1"><mi id="S4.E3.m1.2.2.2.2.2.2.1.2">y</mi><mi id="S4.E3.m1.2.2.2.2.2.2.1.3">i</mi></msub></msubsup><mo lspace="0em" rspace="0em" id="S4.E3.m1.6.6.6.6.6.7">​</mo><mrow id="S4.E3.m1.6.6.6.6.6.9"><mo stretchy="false" id="S4.E3.m1.4.4.4.4.4.4">(</mo><mi id="S4.E3.m1.5.5.5.5.5.5">x</mi><mo stretchy="false" id="S4.E3.m1.6.6.6.6.6.6">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E3.m1.36.36c"><mrow id="S4.E3.m1.36.36.36.36.30"><mo id="S4.E3.m1.7.7.7.7.1.1">=</mo><mi id="S4.E3.m1.8.8.8.8.2.2">log</mi><mrow id="S4.E3.m1.36.36.36.36.30.31"><mo stretchy="false" id="S4.E3.m1.9.9.9.9.3.3">(</mo><mi id="S4.E3.m1.10.10.10.10.4.4">σ</mi><mrow id="S4.E3.m1.36.36.36.36.30.31.1"><mo stretchy="false" id="S4.E3.m1.11.11.11.11.5.5">(</mo><msubsup id="S4.E3.m1.36.36.36.36.30.31.1.1"><mi id="S4.E3.m1.12.12.12.12.6.6">f</mi><mi id="S4.E3.m1.14.14.14.14.8.8.1">P</mi><msub id="S4.E3.m1.13.13.13.13.7.7.1"><mi id="S4.E3.m1.13.13.13.13.7.7.1.2">y</mi><mi id="S4.E3.m1.13.13.13.13.7.7.1.3">i</mi></msub></msubsup><mrow id="S4.E3.m1.36.36.36.36.30.31.1.2"><mo stretchy="false" id="S4.E3.m1.15.15.15.15.9.9">(</mo><mi id="S4.E3.m1.16.16.16.16.10.10">x</mi><mo stretchy="false" id="S4.E3.m1.17.17.17.17.11.11">)</mo></mrow><mo stretchy="false" id="S4.E3.m1.18.18.18.18.12.12">)</mo></mrow><mo id="S4.E3.m1.19.19.19.19.13.13">−</mo><mi id="S4.E3.m1.20.20.20.20.14.14">log</mi><mrow id="S4.E3.m1.36.36.36.36.30.31.2"><mo stretchy="false" id="S4.E3.m1.21.21.21.21.15.15">(</mo><mi id="S4.E3.m1.22.22.22.22.16.16">σ</mi><mrow id="S4.E3.m1.36.36.36.36.30.31.2.1"><mo stretchy="false" id="S4.E3.m1.23.23.23.23.17.17">(</mo><msubsup id="S4.E3.m1.36.36.36.36.30.31.2.1.1"><mi id="S4.E3.m1.24.24.24.24.18.18">f</mi><mi id="S4.E3.m1.26.26.26.26.20.20.1">G</mi><msub id="S4.E3.m1.25.25.25.25.19.19.1"><mi id="S4.E3.m1.25.25.25.25.19.19.1.2">y</mi><mi id="S4.E3.m1.25.25.25.25.19.19.1.3">i</mi></msub></msubsup><mrow id="S4.E3.m1.36.36.36.36.30.31.2.1.2"><mo stretchy="false" id="S4.E3.m1.27.27.27.27.21.21">(</mo><mi id="S4.E3.m1.28.28.28.28.22.22">x</mi><mo stretchy="false" id="S4.E3.m1.29.29.29.29.23.23">)</mo></mrow><mo stretchy="false" id="S4.E3.m1.30.30.30.30.24.24">)</mo></mrow><mtext id="S4.E3.m1.31.31.31.31.25.25"> , </mtext><mo lspace="0.167em" rspace="0.167em" id="S4.E3.m1.32.32.32.32.26.26">∀</mo><msub id="S4.E3.m1.36.36.36.36.30.31.2.2"><mi id="S4.E3.m1.33.33.33.33.27.27">y</mi><mi id="S4.E3.m1.34.34.34.34.28.28.1">i</mi></msub><mo id="S4.E3.m1.35.35.35.35.29.29">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.36.36.36.36.30.30">𝒴</mi></mrow></mrow></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S4.E3.m1.36b">\begin{split}f^{y_{i}}_{D}(x)&amp;=\log(\sigma(f^{y_{i}}_{P}(x))-\log(\sigma(f^{y_{i}}_{G}(x))\text{ , }\forall y_{i}\in\mathcal{Y}\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.7" class="ltx_p">where <math id="S4.SS1.p1.4.m1.1" class="ltx_Math" alttext="\sigma(\cdot)" display="inline"><semantics id="S4.SS1.p1.4.m1.1a"><mrow id="S4.SS1.p1.4.m1.1.2" xref="S4.SS1.p1.4.m1.1.2.cmml"><mi id="S4.SS1.p1.4.m1.1.2.2" xref="S4.SS1.p1.4.m1.1.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.4.m1.1.2.1" xref="S4.SS1.p1.4.m1.1.2.1.cmml">​</mo><mrow id="S4.SS1.p1.4.m1.1.2.3.2" xref="S4.SS1.p1.4.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.4.m1.1.2.3.2.1" xref="S4.SS1.p1.4.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.p1.4.m1.1.1" xref="S4.SS1.p1.4.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.p1.4.m1.1.2.3.2.2" xref="S4.SS1.p1.4.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m1.1b"><apply id="S4.SS1.p1.4.m1.1.2.cmml" xref="S4.SS1.p1.4.m1.1.2"><times id="S4.SS1.p1.4.m1.1.2.1.cmml" xref="S4.SS1.p1.4.m1.1.2.1"></times><ci id="S4.SS1.p1.4.m1.1.2.2.cmml" xref="S4.SS1.p1.4.m1.1.2.2">𝜎</ci><ci id="S4.SS1.p1.4.m1.1.1.cmml" xref="S4.SS1.p1.4.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m1.1c">\sigma(\cdot)</annotation></semantics></math> is the softmax function, and <math id="S4.SS1.p1.5.m2.4" class="ltx_Math" alttext="f^{y_{i}}_{P}(\cdot),f^{y_{i}}_{G}(\cdot)" display="inline"><semantics id="S4.SS1.p1.5.m2.4a"><mrow id="S4.SS1.p1.5.m2.4.4.2" xref="S4.SS1.p1.5.m2.4.4.3.cmml"><mrow id="S4.SS1.p1.5.m2.3.3.1.1" xref="S4.SS1.p1.5.m2.3.3.1.1.cmml"><msubsup id="S4.SS1.p1.5.m2.3.3.1.1.2" xref="S4.SS1.p1.5.m2.3.3.1.1.2.cmml"><mi id="S4.SS1.p1.5.m2.3.3.1.1.2.2.2" xref="S4.SS1.p1.5.m2.3.3.1.1.2.2.2.cmml">f</mi><mi id="S4.SS1.p1.5.m2.3.3.1.1.2.3" xref="S4.SS1.p1.5.m2.3.3.1.1.2.3.cmml">P</mi><msub id="S4.SS1.p1.5.m2.3.3.1.1.2.2.3" xref="S4.SS1.p1.5.m2.3.3.1.1.2.2.3.cmml"><mi id="S4.SS1.p1.5.m2.3.3.1.1.2.2.3.2" xref="S4.SS1.p1.5.m2.3.3.1.1.2.2.3.2.cmml">y</mi><mi id="S4.SS1.p1.5.m2.3.3.1.1.2.2.3.3" xref="S4.SS1.p1.5.m2.3.3.1.1.2.2.3.3.cmml">i</mi></msub></msubsup><mo lspace="0em" rspace="0em" id="S4.SS1.p1.5.m2.3.3.1.1.1" xref="S4.SS1.p1.5.m2.3.3.1.1.1.cmml">​</mo><mrow id="S4.SS1.p1.5.m2.3.3.1.1.3.2" xref="S4.SS1.p1.5.m2.3.3.1.1.cmml"><mo stretchy="false" id="S4.SS1.p1.5.m2.3.3.1.1.3.2.1" xref="S4.SS1.p1.5.m2.3.3.1.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.p1.5.m2.1.1" xref="S4.SS1.p1.5.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.p1.5.m2.3.3.1.1.3.2.2" xref="S4.SS1.p1.5.m2.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p1.5.m2.4.4.2.3" xref="S4.SS1.p1.5.m2.4.4.3.cmml">,</mo><mrow id="S4.SS1.p1.5.m2.4.4.2.2" xref="S4.SS1.p1.5.m2.4.4.2.2.cmml"><msubsup id="S4.SS1.p1.5.m2.4.4.2.2.2" xref="S4.SS1.p1.5.m2.4.4.2.2.2.cmml"><mi id="S4.SS1.p1.5.m2.4.4.2.2.2.2.2" xref="S4.SS1.p1.5.m2.4.4.2.2.2.2.2.cmml">f</mi><mi id="S4.SS1.p1.5.m2.4.4.2.2.2.3" xref="S4.SS1.p1.5.m2.4.4.2.2.2.3.cmml">G</mi><msub id="S4.SS1.p1.5.m2.4.4.2.2.2.2.3" xref="S4.SS1.p1.5.m2.4.4.2.2.2.2.3.cmml"><mi id="S4.SS1.p1.5.m2.4.4.2.2.2.2.3.2" xref="S4.SS1.p1.5.m2.4.4.2.2.2.2.3.2.cmml">y</mi><mi id="S4.SS1.p1.5.m2.4.4.2.2.2.2.3.3" xref="S4.SS1.p1.5.m2.4.4.2.2.2.2.3.3.cmml">i</mi></msub></msubsup><mo lspace="0em" rspace="0em" id="S4.SS1.p1.5.m2.4.4.2.2.1" xref="S4.SS1.p1.5.m2.4.4.2.2.1.cmml">​</mo><mrow id="S4.SS1.p1.5.m2.4.4.2.2.3.2" xref="S4.SS1.p1.5.m2.4.4.2.2.cmml"><mo stretchy="false" id="S4.SS1.p1.5.m2.4.4.2.2.3.2.1" xref="S4.SS1.p1.5.m2.4.4.2.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.p1.5.m2.2.2" xref="S4.SS1.p1.5.m2.2.2.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.p1.5.m2.4.4.2.2.3.2.2" xref="S4.SS1.p1.5.m2.4.4.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m2.4b"><list id="S4.SS1.p1.5.m2.4.4.3.cmml" xref="S4.SS1.p1.5.m2.4.4.2"><apply id="S4.SS1.p1.5.m2.3.3.1.1.cmml" xref="S4.SS1.p1.5.m2.3.3.1.1"><times id="S4.SS1.p1.5.m2.3.3.1.1.1.cmml" xref="S4.SS1.p1.5.m2.3.3.1.1.1"></times><apply id="S4.SS1.p1.5.m2.3.3.1.1.2.cmml" xref="S4.SS1.p1.5.m2.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m2.3.3.1.1.2.1.cmml" xref="S4.SS1.p1.5.m2.3.3.1.1.2">subscript</csymbol><apply id="S4.SS1.p1.5.m2.3.3.1.1.2.2.cmml" xref="S4.SS1.p1.5.m2.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m2.3.3.1.1.2.2.1.cmml" xref="S4.SS1.p1.5.m2.3.3.1.1.2">superscript</csymbol><ci id="S4.SS1.p1.5.m2.3.3.1.1.2.2.2.cmml" xref="S4.SS1.p1.5.m2.3.3.1.1.2.2.2">𝑓</ci><apply id="S4.SS1.p1.5.m2.3.3.1.1.2.2.3.cmml" xref="S4.SS1.p1.5.m2.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m2.3.3.1.1.2.2.3.1.cmml" xref="S4.SS1.p1.5.m2.3.3.1.1.2.2.3">subscript</csymbol><ci id="S4.SS1.p1.5.m2.3.3.1.1.2.2.3.2.cmml" xref="S4.SS1.p1.5.m2.3.3.1.1.2.2.3.2">𝑦</ci><ci id="S4.SS1.p1.5.m2.3.3.1.1.2.2.3.3.cmml" xref="S4.SS1.p1.5.m2.3.3.1.1.2.2.3.3">𝑖</ci></apply></apply><ci id="S4.SS1.p1.5.m2.3.3.1.1.2.3.cmml" xref="S4.SS1.p1.5.m2.3.3.1.1.2.3">𝑃</ci></apply><ci id="S4.SS1.p1.5.m2.1.1.cmml" xref="S4.SS1.p1.5.m2.1.1">⋅</ci></apply><apply id="S4.SS1.p1.5.m2.4.4.2.2.cmml" xref="S4.SS1.p1.5.m2.4.4.2.2"><times id="S4.SS1.p1.5.m2.4.4.2.2.1.cmml" xref="S4.SS1.p1.5.m2.4.4.2.2.1"></times><apply id="S4.SS1.p1.5.m2.4.4.2.2.2.cmml" xref="S4.SS1.p1.5.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m2.4.4.2.2.2.1.cmml" xref="S4.SS1.p1.5.m2.4.4.2.2.2">subscript</csymbol><apply id="S4.SS1.p1.5.m2.4.4.2.2.2.2.cmml" xref="S4.SS1.p1.5.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m2.4.4.2.2.2.2.1.cmml" xref="S4.SS1.p1.5.m2.4.4.2.2.2">superscript</csymbol><ci id="S4.SS1.p1.5.m2.4.4.2.2.2.2.2.cmml" xref="S4.SS1.p1.5.m2.4.4.2.2.2.2.2">𝑓</ci><apply id="S4.SS1.p1.5.m2.4.4.2.2.2.2.3.cmml" xref="S4.SS1.p1.5.m2.4.4.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m2.4.4.2.2.2.2.3.1.cmml" xref="S4.SS1.p1.5.m2.4.4.2.2.2.2.3">subscript</csymbol><ci id="S4.SS1.p1.5.m2.4.4.2.2.2.2.3.2.cmml" xref="S4.SS1.p1.5.m2.4.4.2.2.2.2.3.2">𝑦</ci><ci id="S4.SS1.p1.5.m2.4.4.2.2.2.2.3.3.cmml" xref="S4.SS1.p1.5.m2.4.4.2.2.2.2.3.3">𝑖</ci></apply></apply><ci id="S4.SS1.p1.5.m2.4.4.2.2.2.3.cmml" xref="S4.SS1.p1.5.m2.4.4.2.2.2.3">𝐺</ci></apply><ci id="S4.SS1.p1.5.m2.2.2.cmml" xref="S4.SS1.p1.5.m2.2.2">⋅</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m2.4c">f^{y_{i}}_{P}(\cdot),f^{y_{i}}_{G}(\cdot)</annotation></semantics></math> are the logits of the local model trained in previous communication and its aggregated model (i.e., global model) for the class <math id="S4.SS1.p1.6.m3.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S4.SS1.p1.6.m3.1a"><msub id="S4.SS1.p1.6.m3.1.1" xref="S4.SS1.p1.6.m3.1.1.cmml"><mi id="S4.SS1.p1.6.m3.1.1.2" xref="S4.SS1.p1.6.m3.1.1.2.cmml">y</mi><mi id="S4.SS1.p1.6.m3.1.1.3" xref="S4.SS1.p1.6.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m3.1b"><apply id="S4.SS1.p1.6.m3.1.1.cmml" xref="S4.SS1.p1.6.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m3.1.1.1.cmml" xref="S4.SS1.p1.6.m3.1.1">subscript</csymbol><ci id="S4.SS1.p1.6.m3.1.1.2.cmml" xref="S4.SS1.p1.6.m3.1.1.2">𝑦</ci><ci id="S4.SS1.p1.6.m3.1.1.3.cmml" xref="S4.SS1.p1.6.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m3.1c">y_{i}</annotation></semantics></math>, respectively. The estimated drift indicates how confident the local model is compared to the global model for each class. If the local model reveals more confidence<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>We define the confidence as the predicted probability to the specific class (e.g., ground-truth).</span></span></span> than the global model on the given input <math id="S4.SS1.p1.7.m4.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS1.p1.7.m4.1a"><mi id="S4.SS1.p1.7.m4.1.1" xref="S4.SS1.p1.7.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m4.1b"><ci id="S4.SS1.p1.7.m4.1.1.cmml" xref="S4.SS1.p1.7.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m4.1c">x</annotation></semantics></math>, the large drift is estimated, and it can be interpreted as the local model was overfitted to the sample because the global model’s confidence is more reliable and generalized than others <cite class="ltx_cite ltx_citemacro_citep">(Li, He, and Song <a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.5" class="ltx_p">To prevent the drift, it is important to precisely estimate the drift by comparing the confidences between models. However, the confidences between the local models and the global model are not directly comparable due to the inconsistency between the magnitudes of the softmax weights and features. The softmax function for the prediction can be represented with the magnitudes and angles between input features and classifier weights.</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.20" class="ltx_Math" alttext="\begin{split}\sigma(f^{y_{i}}(x;\omega))&amp;=\frac{e^{f^{y_{i}}(x)}}{\sum_{j=1}^{|\mathcal{Y}|}e^{f^{y_{j}}(x)}}=\frac{e^{W_{i}^{T}u}}{\sum_{j=1}^{|\mathcal{Y}|}e^{W_{j}^{T}u}}\\
&amp;=\frac{e^{\|W_{i}\|\|u\|\cos\theta_{i}}}{\sum_{j=1}^{|\mathcal{Y}|}e^{\|W_{j}\|\|u\|\cos\theta_{ij}}},\end{split}" display="block"><semantics id="S4.E4.m1.20a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S4.E4.m1.20.20.3"><mtr id="S4.E4.m1.20.20.3a"><mtd class="ltx_align_right" columnalign="right" id="S4.E4.m1.20.20.3b"><mrow id="S4.E4.m1.19.19.2.18.15.11"><mi id="S4.E4.m1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.19.19.2.18.15.11.12" xref="S4.E4.m1.18.18.1.1.1.cmml">​</mo><mrow id="S4.E4.m1.19.19.2.18.15.11.11.1"><mo stretchy="false" id="S4.E4.m1.2.2.2.2.2.2" xref="S4.E4.m1.18.18.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.19.19.2.18.15.11.11.1.1"><msup id="S4.E4.m1.19.19.2.18.15.11.11.1.1.2"><mi id="S4.E4.m1.3.3.3.3.3.3" xref="S4.E4.m1.3.3.3.3.3.3.cmml">f</mi><msub id="S4.E4.m1.4.4.4.4.4.4.1" xref="S4.E4.m1.4.4.4.4.4.4.1.cmml"><mi id="S4.E4.m1.4.4.4.4.4.4.1.2" xref="S4.E4.m1.4.4.4.4.4.4.1.2.cmml">y</mi><mi id="S4.E4.m1.4.4.4.4.4.4.1.3" xref="S4.E4.m1.4.4.4.4.4.4.1.3.cmml">i</mi></msub></msup><mo lspace="0em" rspace="0em" id="S4.E4.m1.19.19.2.18.15.11.11.1.1.1" xref="S4.E4.m1.18.18.1.1.1.cmml">​</mo><mrow id="S4.E4.m1.19.19.2.18.15.11.11.1.1.3"><mo stretchy="false" id="S4.E4.m1.5.5.5.5.5.5" xref="S4.E4.m1.18.18.1.1.1.cmml">(</mo><mi id="S4.E4.m1.6.6.6.6.6.6" xref="S4.E4.m1.6.6.6.6.6.6.cmml">x</mi><mo id="S4.E4.m1.7.7.7.7.7.7" xref="S4.E4.m1.18.18.1.1.1.cmml">;</mo><mi id="S4.E4.m1.8.8.8.8.8.8" xref="S4.E4.m1.8.8.8.8.8.8.cmml">ω</mi><mo stretchy="false" id="S4.E4.m1.9.9.9.9.9.9" xref="S4.E4.m1.18.18.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E4.m1.10.10.10.10.10.10" xref="S4.E4.m1.18.18.1.1.1.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E4.m1.20.20.3c"><mrow id="S4.E4.m1.14.14.14.14.4"><mi id="S4.E4.m1.14.14.14.14.4.6" xref="S4.E4.m1.18.18.1.1.1.cmml"></mi><mo id="S4.E4.m1.11.11.11.11.1.1" xref="S4.E4.m1.11.11.11.11.1.1.cmml">=</mo><mfrac id="S4.E4.m1.12.12.12.12.2.2" xref="S4.E4.m1.12.12.12.12.2.2.cmml"><msup id="S4.E4.m1.12.12.12.12.2.2.1" xref="S4.E4.m1.12.12.12.12.2.2.1.cmml"><mi id="S4.E4.m1.12.12.12.12.2.2.1.3" xref="S4.E4.m1.12.12.12.12.2.2.1.3.cmml">e</mi><mrow id="S4.E4.m1.12.12.12.12.2.2.1.1.1" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1.cmml"><msup id="S4.E4.m1.12.12.12.12.2.2.1.1.1.3" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.cmml"><mi id="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.2" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.2.cmml">f</mi><msub id="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.3" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.3.cmml"><mi id="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.3.2" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.3.2.cmml">y</mi><mi id="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.3.3" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.3.3.cmml">i</mi></msub></msup><mo lspace="0em" rspace="0em" id="S4.E4.m1.12.12.12.12.2.2.1.1.1.2" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.12.12.12.12.2.2.1.1.1.4.2" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.12.12.12.12.2.2.1.1.1.4.2.1" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1.cmml">(</mo><mi id="S4.E4.m1.12.12.12.12.2.2.1.1.1.1" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1.1.cmml">x</mi><mo stretchy="false" id="S4.E4.m1.12.12.12.12.2.2.1.1.1.4.2.2" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1.cmml">)</mo></mrow></mrow></msup><mrow id="S4.E4.m1.12.12.12.12.2.2.3" xref="S4.E4.m1.12.12.12.12.2.2.3.cmml"><msubsup id="S4.E4.m1.12.12.12.12.2.2.3.3" xref="S4.E4.m1.12.12.12.12.2.2.3.3.cmml"><mo id="S4.E4.m1.12.12.12.12.2.2.3.3.2.2" xref="S4.E4.m1.12.12.12.12.2.2.3.3.2.2.cmml">∑</mo><mrow id="S4.E4.m1.12.12.12.12.2.2.3.3.2.3" xref="S4.E4.m1.12.12.12.12.2.2.3.3.2.3.cmml"><mi id="S4.E4.m1.12.12.12.12.2.2.3.3.2.3.2" xref="S4.E4.m1.12.12.12.12.2.2.3.3.2.3.2.cmml">j</mi><mo id="S4.E4.m1.12.12.12.12.2.2.3.3.2.3.1" xref="S4.E4.m1.12.12.12.12.2.2.3.3.2.3.1.cmml">=</mo><mn id="S4.E4.m1.12.12.12.12.2.2.3.3.2.3.3" xref="S4.E4.m1.12.12.12.12.2.2.3.3.2.3.3.cmml">1</mn></mrow><mrow id="S4.E4.m1.12.12.12.12.2.2.2.1.1.3" xref="S4.E4.m1.12.12.12.12.2.2.2.1.1.2.cmml"><mo stretchy="false" id="S4.E4.m1.12.12.12.12.2.2.2.1.1.3.1" xref="S4.E4.m1.12.12.12.12.2.2.2.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.12.12.12.12.2.2.2.1.1.1" xref="S4.E4.m1.12.12.12.12.2.2.2.1.1.1.cmml">𝒴</mi><mo stretchy="false" id="S4.E4.m1.12.12.12.12.2.2.2.1.1.3.2" xref="S4.E4.m1.12.12.12.12.2.2.2.1.1.2.1.cmml">|</mo></mrow></msubsup><msup id="S4.E4.m1.12.12.12.12.2.2.3.4" xref="S4.E4.m1.12.12.12.12.2.2.3.4.cmml"><mi id="S4.E4.m1.12.12.12.12.2.2.3.4.2" xref="S4.E4.m1.12.12.12.12.2.2.3.4.2.cmml">e</mi><mrow id="S4.E4.m1.12.12.12.12.2.2.3.2.1" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1.cmml"><msup id="S4.E4.m1.12.12.12.12.2.2.3.2.1.3" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.cmml"><mi id="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.2" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.2.cmml">f</mi><msub id="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.3" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.3.cmml"><mi id="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.3.2" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.3.2.cmml">y</mi><mi id="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.3.3" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.3.3.cmml">j</mi></msub></msup><mo lspace="0em" rspace="0em" id="S4.E4.m1.12.12.12.12.2.2.3.2.1.2" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1.2.cmml">​</mo><mrow id="S4.E4.m1.12.12.12.12.2.2.3.2.1.4.2" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1.cmml"><mo stretchy="false" id="S4.E4.m1.12.12.12.12.2.2.3.2.1.4.2.1" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1.cmml">(</mo><mi id="S4.E4.m1.12.12.12.12.2.2.3.2.1.1" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1.1.cmml">x</mi><mo stretchy="false" id="S4.E4.m1.12.12.12.12.2.2.3.2.1.4.2.2" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1.cmml">)</mo></mrow></mrow></msup></mrow></mfrac><mo id="S4.E4.m1.13.13.13.13.3.3" xref="S4.E4.m1.13.13.13.13.3.3.cmml">=</mo><mfrac id="S4.E4.m1.14.14.14.14.4.4" xref="S4.E4.m1.14.14.14.14.4.4.cmml"><msup id="S4.E4.m1.14.14.14.14.4.4.3" xref="S4.E4.m1.14.14.14.14.4.4.3.cmml"><mi id="S4.E4.m1.14.14.14.14.4.4.3.2" xref="S4.E4.m1.14.14.14.14.4.4.3.2.cmml">e</mi><mrow id="S4.E4.m1.14.14.14.14.4.4.3.3" xref="S4.E4.m1.14.14.14.14.4.4.3.3.cmml"><msubsup id="S4.E4.m1.14.14.14.14.4.4.3.3.2" xref="S4.E4.m1.14.14.14.14.4.4.3.3.2.cmml"><mi id="S4.E4.m1.14.14.14.14.4.4.3.3.2.2.2" xref="S4.E4.m1.14.14.14.14.4.4.3.3.2.2.2.cmml">W</mi><mi id="S4.E4.m1.14.14.14.14.4.4.3.3.2.2.3" xref="S4.E4.m1.14.14.14.14.4.4.3.3.2.2.3.cmml">i</mi><mi id="S4.E4.m1.14.14.14.14.4.4.3.3.2.3" xref="S4.E4.m1.14.14.14.14.4.4.3.3.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E4.m1.14.14.14.14.4.4.3.3.1" xref="S4.E4.m1.14.14.14.14.4.4.3.3.1.cmml">​</mo><mi id="S4.E4.m1.14.14.14.14.4.4.3.3.3" xref="S4.E4.m1.14.14.14.14.4.4.3.3.3.cmml">u</mi></mrow></msup><mrow id="S4.E4.m1.14.14.14.14.4.4.1" xref="S4.E4.m1.14.14.14.14.4.4.1.cmml"><msubsup id="S4.E4.m1.14.14.14.14.4.4.1.2" xref="S4.E4.m1.14.14.14.14.4.4.1.2.cmml"><mo id="S4.E4.m1.14.14.14.14.4.4.1.2.2.2" xref="S4.E4.m1.14.14.14.14.4.4.1.2.2.2.cmml">∑</mo><mrow id="S4.E4.m1.14.14.14.14.4.4.1.2.2.3" xref="S4.E4.m1.14.14.14.14.4.4.1.2.2.3.cmml"><mi id="S4.E4.m1.14.14.14.14.4.4.1.2.2.3.2" xref="S4.E4.m1.14.14.14.14.4.4.1.2.2.3.2.cmml">j</mi><mo id="S4.E4.m1.14.14.14.14.4.4.1.2.2.3.1" xref="S4.E4.m1.14.14.14.14.4.4.1.2.2.3.1.cmml">=</mo><mn id="S4.E4.m1.14.14.14.14.4.4.1.2.2.3.3" xref="S4.E4.m1.14.14.14.14.4.4.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S4.E4.m1.14.14.14.14.4.4.1.1.1.3" xref="S4.E4.m1.14.14.14.14.4.4.1.1.1.2.cmml"><mo stretchy="false" id="S4.E4.m1.14.14.14.14.4.4.1.1.1.3.1" xref="S4.E4.m1.14.14.14.14.4.4.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.14.14.14.14.4.4.1.1.1.1" xref="S4.E4.m1.14.14.14.14.4.4.1.1.1.1.cmml">𝒴</mi><mo stretchy="false" id="S4.E4.m1.14.14.14.14.4.4.1.1.1.3.2" xref="S4.E4.m1.14.14.14.14.4.4.1.1.1.2.1.cmml">|</mo></mrow></msubsup><msup id="S4.E4.m1.14.14.14.14.4.4.1.3" xref="S4.E4.m1.14.14.14.14.4.4.1.3.cmml"><mi id="S4.E4.m1.14.14.14.14.4.4.1.3.2" xref="S4.E4.m1.14.14.14.14.4.4.1.3.2.cmml">e</mi><mrow id="S4.E4.m1.14.14.14.14.4.4.1.3.3" xref="S4.E4.m1.14.14.14.14.4.4.1.3.3.cmml"><msubsup id="S4.E4.m1.14.14.14.14.4.4.1.3.3.2" xref="S4.E4.m1.14.14.14.14.4.4.1.3.3.2.cmml"><mi id="S4.E4.m1.14.14.14.14.4.4.1.3.3.2.2.2" xref="S4.E4.m1.14.14.14.14.4.4.1.3.3.2.2.2.cmml">W</mi><mi id="S4.E4.m1.14.14.14.14.4.4.1.3.3.2.2.3" xref="S4.E4.m1.14.14.14.14.4.4.1.3.3.2.2.3.cmml">j</mi><mi id="S4.E4.m1.14.14.14.14.4.4.1.3.3.2.3" xref="S4.E4.m1.14.14.14.14.4.4.1.3.3.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E4.m1.14.14.14.14.4.4.1.3.3.1" xref="S4.E4.m1.14.14.14.14.4.4.1.3.3.1.cmml">​</mo><mi id="S4.E4.m1.14.14.14.14.4.4.1.3.3.3" xref="S4.E4.m1.14.14.14.14.4.4.1.3.3.3.cmml">u</mi></mrow></msup></mrow></mfrac></mrow></mtd></mtr><mtr id="S4.E4.m1.20.20.3d"><mtd id="S4.E4.m1.20.20.3e" xref="S4.E4.m1.18.18.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E4.m1.20.20.3f"><mrow id="S4.E4.m1.20.20.3.19.4.4.4"><mrow id="S4.E4.m1.20.20.3.19.4.4.4.1"><mi id="S4.E4.m1.20.20.3.19.4.4.4.1.1" xref="S4.E4.m1.18.18.1.1.1.cmml"></mi><mo id="S4.E4.m1.15.15.15.1.1.1" xref="S4.E4.m1.15.15.15.1.1.1.cmml">=</mo><mfrac id="S4.E4.m1.16.16.16.2.2.2" xref="S4.E4.m1.16.16.16.2.2.2.cmml"><msup id="S4.E4.m1.16.16.16.2.2.2.2" xref="S4.E4.m1.16.16.16.2.2.2.2.cmml"><mi id="S4.E4.m1.16.16.16.2.2.2.2.4" xref="S4.E4.m1.16.16.16.2.2.2.2.4.cmml">e</mi><mrow id="S4.E4.m1.16.16.16.2.2.2.2.2.2" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.cmml"><mrow id="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.1" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.2.cmml"><mo stretchy="false" id="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.1.2" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.2.1.cmml">‖</mo><msub id="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.1.1" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.1.1.cmml"><mi id="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.1.1.2" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.1.1.2.cmml">W</mi><mi id="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.1.1.3" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.1.3" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.2.1.cmml">‖</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E4.m1.16.16.16.2.2.2.2.2.2.3" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.3.cmml">​</mo><mrow id="S4.E4.m1.16.16.16.2.2.2.2.2.2.4.2" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.4.1.cmml"><mo stretchy="false" id="S4.E4.m1.16.16.16.2.2.2.2.2.2.4.2.1" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.4.1.1.cmml">‖</mo><mi id="S4.E4.m1.16.16.16.2.2.2.1.1.1.1" xref="S4.E4.m1.16.16.16.2.2.2.1.1.1.1.cmml">u</mi><mo stretchy="false" id="S4.E4.m1.16.16.16.2.2.2.2.2.2.4.2.2" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.4.1.1.cmml">‖</mo></mrow><mo lspace="0.167em" rspace="0em" id="S4.E4.m1.16.16.16.2.2.2.2.2.2.3a" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.3.cmml">​</mo><mrow id="S4.E4.m1.16.16.16.2.2.2.2.2.2.5" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.cmml"><mi id="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.1" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.1.cmml">cos</mi><mo lspace="0.167em" id="S4.E4.m1.16.16.16.2.2.2.2.2.2.5a" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.cmml">⁡</mo><msub id="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.2" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.2.cmml"><mi id="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.2.2" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.2.2.cmml">θ</mi><mi id="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.2.3" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.2.3.cmml">i</mi></msub></mrow></mrow></msup><mrow id="S4.E4.m1.16.16.16.2.2.2.5" xref="S4.E4.m1.16.16.16.2.2.2.5.cmml"><msubsup id="S4.E4.m1.16.16.16.2.2.2.5.4" xref="S4.E4.m1.16.16.16.2.2.2.5.4.cmml"><mo id="S4.E4.m1.16.16.16.2.2.2.5.4.2.2" xref="S4.E4.m1.16.16.16.2.2.2.5.4.2.2.cmml">∑</mo><mrow id="S4.E4.m1.16.16.16.2.2.2.5.4.2.3" xref="S4.E4.m1.16.16.16.2.2.2.5.4.2.3.cmml"><mi id="S4.E4.m1.16.16.16.2.2.2.5.4.2.3.2" xref="S4.E4.m1.16.16.16.2.2.2.5.4.2.3.2.cmml">j</mi><mo id="S4.E4.m1.16.16.16.2.2.2.5.4.2.3.1" xref="S4.E4.m1.16.16.16.2.2.2.5.4.2.3.1.cmml">=</mo><mn id="S4.E4.m1.16.16.16.2.2.2.5.4.2.3.3" xref="S4.E4.m1.16.16.16.2.2.2.5.4.2.3.3.cmml">1</mn></mrow><mrow id="S4.E4.m1.16.16.16.2.2.2.3.1.1.3" xref="S4.E4.m1.16.16.16.2.2.2.3.1.1.2.cmml"><mo stretchy="false" id="S4.E4.m1.16.16.16.2.2.2.3.1.1.3.1" xref="S4.E4.m1.16.16.16.2.2.2.3.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.16.16.16.2.2.2.3.1.1.1" xref="S4.E4.m1.16.16.16.2.2.2.3.1.1.1.cmml">𝒴</mi><mo stretchy="false" id="S4.E4.m1.16.16.16.2.2.2.3.1.1.3.2" xref="S4.E4.m1.16.16.16.2.2.2.3.1.1.2.1.cmml">|</mo></mrow></msubsup><msup id="S4.E4.m1.16.16.16.2.2.2.5.5" xref="S4.E4.m1.16.16.16.2.2.2.5.5.cmml"><mi id="S4.E4.m1.16.16.16.2.2.2.5.5.2" xref="S4.E4.m1.16.16.16.2.2.2.5.5.2.cmml">e</mi><mrow id="S4.E4.m1.16.16.16.2.2.2.5.3.2" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.cmml"><mrow id="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.1" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.2.cmml"><mo stretchy="false" id="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.1.2" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.2.1.cmml">‖</mo><msub id="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.1.1" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.1.1.cmml"><mi id="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.1.1.2" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.1.1.2.cmml">W</mi><mi id="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.1.1.3" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.1.3" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.2.1.cmml">‖</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E4.m1.16.16.16.2.2.2.5.3.2.3" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.3.cmml">​</mo><mrow id="S4.E4.m1.16.16.16.2.2.2.5.3.2.4.2" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.4.1.cmml"><mo stretchy="false" id="S4.E4.m1.16.16.16.2.2.2.5.3.2.4.2.1" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.4.1.1.cmml">‖</mo><mi id="S4.E4.m1.16.16.16.2.2.2.4.2.1.1" xref="S4.E4.m1.16.16.16.2.2.2.4.2.1.1.cmml">u</mi><mo stretchy="false" id="S4.E4.m1.16.16.16.2.2.2.5.3.2.4.2.2" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.4.1.1.cmml">‖</mo></mrow><mo lspace="0.167em" rspace="0em" id="S4.E4.m1.16.16.16.2.2.2.5.3.2.3a" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.3.cmml">​</mo><mrow id="S4.E4.m1.16.16.16.2.2.2.5.3.2.5" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.cmml"><mi id="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.1" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.1.cmml">cos</mi><mo lspace="0.167em" id="S4.E4.m1.16.16.16.2.2.2.5.3.2.5a" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.cmml">⁡</mo><msub id="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.cmml"><mi id="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.2" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.2.cmml">θ</mi><mrow id="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.3" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.3.cmml"><mi id="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.3.2" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.3.1" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.3.1.cmml">​</mo><mi id="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.3.3" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.3.3.cmml">j</mi></mrow></msub></mrow></mrow></msup></mrow></mfrac></mrow><mo id="S4.E4.m1.17.17.17.3.3.3" xref="S4.E4.m1.18.18.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E4.m1.20b"><apply id="S4.E4.m1.18.18.1.1.1.cmml" xref="S4.E4.m1.19.19.2.18.15.11.12"><and id="S4.E4.m1.18.18.1.1.1a.cmml" xref="S4.E4.m1.19.19.2.18.15.11.12"></and><apply id="S4.E4.m1.18.18.1.1.1b.cmml" xref="S4.E4.m1.19.19.2.18.15.11.12"><eq id="S4.E4.m1.11.11.11.11.1.1.cmml" xref="S4.E4.m1.11.11.11.11.1.1"></eq><apply id="S4.E4.m1.18.18.1.1.1.1.cmml" xref="S4.E4.m1.19.19.2.18.15.11.12"><times id="S4.E4.m1.18.18.1.1.1.1.2.cmml" xref="S4.E4.m1.19.19.2.18.15.11.12"></times><ci id="S4.E4.m1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1">𝜎</ci><apply id="S4.E4.m1.18.18.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.19.19.2.18.15.11.12"><times id="S4.E4.m1.18.18.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.19.19.2.18.15.11.12"></times><apply id="S4.E4.m1.18.18.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.19.19.2.18.15.11.12"><csymbol cd="ambiguous" id="S4.E4.m1.18.18.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.19.19.2.18.15.11.12">superscript</csymbol><ci id="S4.E4.m1.3.3.3.3.3.3.cmml" xref="S4.E4.m1.3.3.3.3.3.3">𝑓</ci><apply id="S4.E4.m1.4.4.4.4.4.4.1.cmml" xref="S4.E4.m1.4.4.4.4.4.4.1"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.4.4.4.4.1.1.cmml" xref="S4.E4.m1.4.4.4.4.4.4.1">subscript</csymbol><ci id="S4.E4.m1.4.4.4.4.4.4.1.2.cmml" xref="S4.E4.m1.4.4.4.4.4.4.1.2">𝑦</ci><ci id="S4.E4.m1.4.4.4.4.4.4.1.3.cmml" xref="S4.E4.m1.4.4.4.4.4.4.1.3">𝑖</ci></apply></apply><list id="S4.E4.m1.18.18.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.19.19.2.18.15.11.12"><ci id="S4.E4.m1.6.6.6.6.6.6.cmml" xref="S4.E4.m1.6.6.6.6.6.6">𝑥</ci><ci id="S4.E4.m1.8.8.8.8.8.8.cmml" xref="S4.E4.m1.8.8.8.8.8.8">𝜔</ci></list></apply></apply><apply id="S4.E4.m1.12.12.12.12.2.2.cmml" xref="S4.E4.m1.12.12.12.12.2.2"><divide id="S4.E4.m1.12.12.12.12.2.2.4.cmml" xref="S4.E4.m1.12.12.12.12.2.2"></divide><apply id="S4.E4.m1.12.12.12.12.2.2.1.cmml" xref="S4.E4.m1.12.12.12.12.2.2.1"><csymbol cd="ambiguous" id="S4.E4.m1.12.12.12.12.2.2.1.2.cmml" xref="S4.E4.m1.12.12.12.12.2.2.1">superscript</csymbol><ci id="S4.E4.m1.12.12.12.12.2.2.1.3.cmml" xref="S4.E4.m1.12.12.12.12.2.2.1.3">𝑒</ci><apply id="S4.E4.m1.12.12.12.12.2.2.1.1.1.cmml" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1"><times id="S4.E4.m1.12.12.12.12.2.2.1.1.1.2.cmml" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1.2"></times><apply id="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.cmml" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.1.cmml" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1.3">superscript</csymbol><ci id="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.2.cmml" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.2">𝑓</ci><apply id="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.3.cmml" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.3.1.cmml" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.3">subscript</csymbol><ci id="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.3.2.cmml" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.3.2">𝑦</ci><ci id="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.3.3.cmml" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1.3.3.3">𝑖</ci></apply></apply><ci id="S4.E4.m1.12.12.12.12.2.2.1.1.1.1.cmml" xref="S4.E4.m1.12.12.12.12.2.2.1.1.1.1">𝑥</ci></apply></apply><apply id="S4.E4.m1.12.12.12.12.2.2.3.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3"><apply id="S4.E4.m1.12.12.12.12.2.2.3.3.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.3"><csymbol cd="ambiguous" id="S4.E4.m1.12.12.12.12.2.2.3.3.1.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.3">superscript</csymbol><apply id="S4.E4.m1.12.12.12.12.2.2.3.3.2.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.3"><csymbol cd="ambiguous" id="S4.E4.m1.12.12.12.12.2.2.3.3.2.1.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.3">subscript</csymbol><sum id="S4.E4.m1.12.12.12.12.2.2.3.3.2.2.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.3.2.2"></sum><apply id="S4.E4.m1.12.12.12.12.2.2.3.3.2.3.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.3.2.3"><eq id="S4.E4.m1.12.12.12.12.2.2.3.3.2.3.1.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.3.2.3.1"></eq><ci id="S4.E4.m1.12.12.12.12.2.2.3.3.2.3.2.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.3.2.3.2">𝑗</ci><cn type="integer" id="S4.E4.m1.12.12.12.12.2.2.3.3.2.3.3.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.3.2.3.3">1</cn></apply></apply><apply id="S4.E4.m1.12.12.12.12.2.2.2.1.1.2.cmml" xref="S4.E4.m1.12.12.12.12.2.2.2.1.1.3"><abs id="S4.E4.m1.12.12.12.12.2.2.2.1.1.2.1.cmml" xref="S4.E4.m1.12.12.12.12.2.2.2.1.1.3.1"></abs><ci id="S4.E4.m1.12.12.12.12.2.2.2.1.1.1.cmml" xref="S4.E4.m1.12.12.12.12.2.2.2.1.1.1">𝒴</ci></apply></apply><apply id="S4.E4.m1.12.12.12.12.2.2.3.4.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.4"><csymbol cd="ambiguous" id="S4.E4.m1.12.12.12.12.2.2.3.4.1.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.4">superscript</csymbol><ci id="S4.E4.m1.12.12.12.12.2.2.3.4.2.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.4.2">𝑒</ci><apply id="S4.E4.m1.12.12.12.12.2.2.3.2.1.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1"><times id="S4.E4.m1.12.12.12.12.2.2.3.2.1.2.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1.2"></times><apply id="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.1.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1.3">superscript</csymbol><ci id="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.2.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.2">𝑓</ci><apply id="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.3.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.3"><csymbol cd="ambiguous" id="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.3.1.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.3">subscript</csymbol><ci id="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.3.2.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.3.2">𝑦</ci><ci id="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.3.3.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1.3.3.3">𝑗</ci></apply></apply><ci id="S4.E4.m1.12.12.12.12.2.2.3.2.1.1.cmml" xref="S4.E4.m1.12.12.12.12.2.2.3.2.1.1">𝑥</ci></apply></apply></apply></apply></apply><apply id="S4.E4.m1.18.18.1.1.1c.cmml" xref="S4.E4.m1.19.19.2.18.15.11.12"><eq id="S4.E4.m1.13.13.13.13.3.3.cmml" xref="S4.E4.m1.13.13.13.13.3.3"></eq><share href="#S4.E4.m1.18.18.1.1.1.4.cmml" id="S4.E4.m1.18.18.1.1.1d.cmml" xref="S4.E4.m1.19.19.2.18.15.11.12"></share><apply id="S4.E4.m1.14.14.14.14.4.4.cmml" xref="S4.E4.m1.14.14.14.14.4.4"><divide id="S4.E4.m1.14.14.14.14.4.4.2.cmml" xref="S4.E4.m1.14.14.14.14.4.4"></divide><apply id="S4.E4.m1.14.14.14.14.4.4.3.cmml" xref="S4.E4.m1.14.14.14.14.4.4.3"><csymbol cd="ambiguous" id="S4.E4.m1.14.14.14.14.4.4.3.1.cmml" xref="S4.E4.m1.14.14.14.14.4.4.3">superscript</csymbol><ci id="S4.E4.m1.14.14.14.14.4.4.3.2.cmml" xref="S4.E4.m1.14.14.14.14.4.4.3.2">𝑒</ci><apply id="S4.E4.m1.14.14.14.14.4.4.3.3.cmml" xref="S4.E4.m1.14.14.14.14.4.4.3.3"><times id="S4.E4.m1.14.14.14.14.4.4.3.3.1.cmml" xref="S4.E4.m1.14.14.14.14.4.4.3.3.1"></times><apply id="S4.E4.m1.14.14.14.14.4.4.3.3.2.cmml" xref="S4.E4.m1.14.14.14.14.4.4.3.3.2"><csymbol cd="ambiguous" id="S4.E4.m1.14.14.14.14.4.4.3.3.2.1.cmml" xref="S4.E4.m1.14.14.14.14.4.4.3.3.2">superscript</csymbol><apply id="S4.E4.m1.14.14.14.14.4.4.3.3.2.2.cmml" xref="S4.E4.m1.14.14.14.14.4.4.3.3.2"><csymbol cd="ambiguous" id="S4.E4.m1.14.14.14.14.4.4.3.3.2.2.1.cmml" xref="S4.E4.m1.14.14.14.14.4.4.3.3.2">subscript</csymbol><ci id="S4.E4.m1.14.14.14.14.4.4.3.3.2.2.2.cmml" xref="S4.E4.m1.14.14.14.14.4.4.3.3.2.2.2">𝑊</ci><ci id="S4.E4.m1.14.14.14.14.4.4.3.3.2.2.3.cmml" xref="S4.E4.m1.14.14.14.14.4.4.3.3.2.2.3">𝑖</ci></apply><ci id="S4.E4.m1.14.14.14.14.4.4.3.3.2.3.cmml" xref="S4.E4.m1.14.14.14.14.4.4.3.3.2.3">𝑇</ci></apply><ci id="S4.E4.m1.14.14.14.14.4.4.3.3.3.cmml" xref="S4.E4.m1.14.14.14.14.4.4.3.3.3">𝑢</ci></apply></apply><apply id="S4.E4.m1.14.14.14.14.4.4.1.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1"><apply id="S4.E4.m1.14.14.14.14.4.4.1.2.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.14.14.14.14.4.4.1.2.1.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.2">superscript</csymbol><apply id="S4.E4.m1.14.14.14.14.4.4.1.2.2.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.14.14.14.14.4.4.1.2.2.1.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.2">subscript</csymbol><sum id="S4.E4.m1.14.14.14.14.4.4.1.2.2.2.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.2.2.2"></sum><apply id="S4.E4.m1.14.14.14.14.4.4.1.2.2.3.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.2.2.3"><eq id="S4.E4.m1.14.14.14.14.4.4.1.2.2.3.1.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.2.2.3.1"></eq><ci id="S4.E4.m1.14.14.14.14.4.4.1.2.2.3.2.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.2.2.3.2">𝑗</ci><cn type="integer" id="S4.E4.m1.14.14.14.14.4.4.1.2.2.3.3.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.2.2.3.3">1</cn></apply></apply><apply id="S4.E4.m1.14.14.14.14.4.4.1.1.1.2.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.1.1.3"><abs id="S4.E4.m1.14.14.14.14.4.4.1.1.1.2.1.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.1.1.3.1"></abs><ci id="S4.E4.m1.14.14.14.14.4.4.1.1.1.1.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.1.1.1">𝒴</ci></apply></apply><apply id="S4.E4.m1.14.14.14.14.4.4.1.3.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.14.14.14.14.4.4.1.3.1.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.3">superscript</csymbol><ci id="S4.E4.m1.14.14.14.14.4.4.1.3.2.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.3.2">𝑒</ci><apply id="S4.E4.m1.14.14.14.14.4.4.1.3.3.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.3.3"><times id="S4.E4.m1.14.14.14.14.4.4.1.3.3.1.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.3.3.1"></times><apply id="S4.E4.m1.14.14.14.14.4.4.1.3.3.2.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.3.3.2"><csymbol cd="ambiguous" id="S4.E4.m1.14.14.14.14.4.4.1.3.3.2.1.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.3.3.2">superscript</csymbol><apply id="S4.E4.m1.14.14.14.14.4.4.1.3.3.2.2.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.3.3.2"><csymbol cd="ambiguous" id="S4.E4.m1.14.14.14.14.4.4.1.3.3.2.2.1.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.3.3.2">subscript</csymbol><ci id="S4.E4.m1.14.14.14.14.4.4.1.3.3.2.2.2.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.3.3.2.2.2">𝑊</ci><ci id="S4.E4.m1.14.14.14.14.4.4.1.3.3.2.2.3.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.3.3.2.2.3">𝑗</ci></apply><ci id="S4.E4.m1.14.14.14.14.4.4.1.3.3.2.3.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.3.3.2.3">𝑇</ci></apply><ci id="S4.E4.m1.14.14.14.14.4.4.1.3.3.3.cmml" xref="S4.E4.m1.14.14.14.14.4.4.1.3.3.3">𝑢</ci></apply></apply></apply></apply></apply><apply id="S4.E4.m1.18.18.1.1.1e.cmml" xref="S4.E4.m1.19.19.2.18.15.11.12"><eq id="S4.E4.m1.15.15.15.1.1.1.cmml" xref="S4.E4.m1.15.15.15.1.1.1"></eq><share href="#S4.E4.m1.18.18.1.1.1.6.cmml" id="S4.E4.m1.18.18.1.1.1f.cmml" xref="S4.E4.m1.19.19.2.18.15.11.12"></share><apply id="S4.E4.m1.16.16.16.2.2.2.cmml" xref="S4.E4.m1.16.16.16.2.2.2"><divide id="S4.E4.m1.16.16.16.2.2.2.6.cmml" xref="S4.E4.m1.16.16.16.2.2.2"></divide><apply id="S4.E4.m1.16.16.16.2.2.2.2.cmml" xref="S4.E4.m1.16.16.16.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.16.16.16.2.2.2.2.3.cmml" xref="S4.E4.m1.16.16.16.2.2.2.2">superscript</csymbol><ci id="S4.E4.m1.16.16.16.2.2.2.2.4.cmml" xref="S4.E4.m1.16.16.16.2.2.2.2.4">𝑒</ci><apply id="S4.E4.m1.16.16.16.2.2.2.2.2.2.cmml" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2"><times id="S4.E4.m1.16.16.16.2.2.2.2.2.2.3.cmml" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.3"></times><apply id="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.2.cmml" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.1"><csymbol cd="latexml" id="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.2.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.1.2">norm</csymbol><apply id="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.1.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.1.1.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.1.1.2.cmml" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.1.1.2">𝑊</ci><ci id="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.1.1.3.cmml" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.2.1.1.3">𝑖</ci></apply></apply><apply id="S4.E4.m1.16.16.16.2.2.2.2.2.2.4.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.4.2"><csymbol cd="latexml" id="S4.E4.m1.16.16.16.2.2.2.2.2.2.4.1.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.4.2.1">norm</csymbol><ci id="S4.E4.m1.16.16.16.2.2.2.1.1.1.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.1.1.1.1">𝑢</ci></apply><apply id="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.cmml" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.5"><cos id="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.1"></cos><apply id="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.2.cmml" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.2"><csymbol cd="ambiguous" id="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.2.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.2">subscript</csymbol><ci id="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.2.2.cmml" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.2.2">𝜃</ci><ci id="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.2.3.cmml" xref="S4.E4.m1.16.16.16.2.2.2.2.2.2.5.2.3">𝑖</ci></apply></apply></apply></apply><apply id="S4.E4.m1.16.16.16.2.2.2.5.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5"><apply id="S4.E4.m1.16.16.16.2.2.2.5.4.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.4"><csymbol cd="ambiguous" id="S4.E4.m1.16.16.16.2.2.2.5.4.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.4">superscript</csymbol><apply id="S4.E4.m1.16.16.16.2.2.2.5.4.2.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.4"><csymbol cd="ambiguous" id="S4.E4.m1.16.16.16.2.2.2.5.4.2.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.4">subscript</csymbol><sum id="S4.E4.m1.16.16.16.2.2.2.5.4.2.2.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.4.2.2"></sum><apply id="S4.E4.m1.16.16.16.2.2.2.5.4.2.3.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.4.2.3"><eq id="S4.E4.m1.16.16.16.2.2.2.5.4.2.3.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.4.2.3.1"></eq><ci id="S4.E4.m1.16.16.16.2.2.2.5.4.2.3.2.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.4.2.3.2">𝑗</ci><cn type="integer" id="S4.E4.m1.16.16.16.2.2.2.5.4.2.3.3.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.4.2.3.3">1</cn></apply></apply><apply id="S4.E4.m1.16.16.16.2.2.2.3.1.1.2.cmml" xref="S4.E4.m1.16.16.16.2.2.2.3.1.1.3"><abs id="S4.E4.m1.16.16.16.2.2.2.3.1.1.2.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.3.1.1.3.1"></abs><ci id="S4.E4.m1.16.16.16.2.2.2.3.1.1.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.3.1.1.1">𝒴</ci></apply></apply><apply id="S4.E4.m1.16.16.16.2.2.2.5.5.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.5"><csymbol cd="ambiguous" id="S4.E4.m1.16.16.16.2.2.2.5.5.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.5">superscript</csymbol><ci id="S4.E4.m1.16.16.16.2.2.2.5.5.2.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.5.2">𝑒</ci><apply id="S4.E4.m1.16.16.16.2.2.2.5.3.2.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2"><times id="S4.E4.m1.16.16.16.2.2.2.5.3.2.3.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.3"></times><apply id="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.2.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.1"><csymbol cd="latexml" id="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.2.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.1.2">norm</csymbol><apply id="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.1.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.1.1.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.1.1">subscript</csymbol><ci id="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.1.1.2.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.1.1.2">𝑊</ci><ci id="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.1.1.3.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.2.1.1.3">𝑗</ci></apply></apply><apply id="S4.E4.m1.16.16.16.2.2.2.5.3.2.4.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.4.2"><csymbol cd="latexml" id="S4.E4.m1.16.16.16.2.2.2.5.3.2.4.1.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.4.2.1">norm</csymbol><ci id="S4.E4.m1.16.16.16.2.2.2.4.2.1.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.4.2.1.1">𝑢</ci></apply><apply id="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.5"><cos id="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.1"></cos><apply id="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2"><csymbol cd="ambiguous" id="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2">subscript</csymbol><ci id="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.2.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.2">𝜃</ci><apply id="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.3.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.3"><times id="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.3.1.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.3.1"></times><ci id="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.3.2.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.3.2">𝑖</ci><ci id="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.3.3.cmml" xref="S4.E4.m1.16.16.16.2.2.2.5.3.2.5.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.20c">\begin{split}\sigma(f^{y_{i}}(x;\omega))&amp;=\frac{e^{f^{y_{i}}(x)}}{\sum_{j=1}^{|\mathcal{Y}|}e^{f^{y_{j}}(x)}}=\frac{e^{W_{i}^{T}u}}{\sum_{j=1}^{|\mathcal{Y}|}e^{W_{j}^{T}u}}\\
&amp;=\frac{e^{\|W_{i}\|\|u\|\cos\theta_{i}}}{\sum_{j=1}^{|\mathcal{Y}|}e^{\|W_{j}\|\|u\|\cos\theta_{ij}}},\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.4" class="ltx_p">ewhere <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><msub id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">θ</mi><mi id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">𝜃</ci><ci id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\theta_{i}</annotation></semantics></math> is the intersection angle between pre-activated features <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="u" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">u</annotation></semantics></math> and classifier weights <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><msub id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mi id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">W</mi><mi id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2">𝑊</ci><ci id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">W_{i}</annotation></semantics></math> for the class <math id="S4.SS1.p2.4.m4.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S4.SS1.p2.4.m4.1a"><msub id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml"><mi id="S4.SS1.p2.4.m4.1.1.2" xref="S4.SS1.p2.4.m4.1.1.2.cmml">y</mi><mi id="S4.SS1.p2.4.m4.1.1.3" xref="S4.SS1.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><apply id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p2.4.m4.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.2">𝑦</ci><ci id="S4.SS1.p2.4.m4.1.1.3.cmml" xref="S4.SS1.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">y_{i}</annotation></semantics></math>. As can be seen from the above equation, the magnitudes of features and the classifier weights can affect the confidence of the prediction by similarly serving as the different temperature. Different temperatures between classifiers (i.e., global and locals) result in different predictions in terms of the confidence, making the precise estimation of the drift difficult. Furthermore, the differences are more evident in the heterogeneous environments because this setting makes the classifier weights to be biased toward majority classes <cite class="ltx_cite ltx_citemacro_citep">(Zhong et al. <a href="#bib.bib31" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.4" class="ltx_p">To estimate the drift precisely and comparably, we constrain the magnitudes by normalizing the classifier weights and features during the local optimization.</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.3" class="ltx_Math" alttext="\hat{u}=\frac{u}{\|u\|},\hat{W_{i}}=\frac{W_{i}}{\|W_{i}\|},\forall i\in\mathcal{Y}," display="block"><semantics id="S4.E5.m1.3a"><mrow id="S4.E5.m1.3.3.1"><mrow id="S4.E5.m1.3.3.1.1.2" xref="S4.E5.m1.3.3.1.1.3.cmml"><mrow id="S4.E5.m1.3.3.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.cmml"><mover accent="true" id="S4.E5.m1.3.3.1.1.1.1.2" xref="S4.E5.m1.3.3.1.1.1.1.2.cmml"><mi id="S4.E5.m1.3.3.1.1.1.1.2.2" xref="S4.E5.m1.3.3.1.1.1.1.2.2.cmml">u</mi><mo id="S4.E5.m1.3.3.1.1.1.1.2.1" xref="S4.E5.m1.3.3.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S4.E5.m1.3.3.1.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.cmml">=</mo><mfrac id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml"><mi id="S4.E5.m1.1.1.3" xref="S4.E5.m1.1.1.3.cmml">u</mi><mrow id="S4.E5.m1.1.1.1.3" xref="S4.E5.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E5.m1.1.1.1.3.1" xref="S4.E5.m1.1.1.1.2.1.cmml">‖</mo><mi id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml">u</mi><mo stretchy="false" id="S4.E5.m1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.2.1.cmml">‖</mo></mrow></mfrac></mrow><mo id="S4.E5.m1.3.3.1.1.2.3" xref="S4.E5.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S4.E5.m1.3.3.1.1.2.2.2" xref="S4.E5.m1.3.3.1.1.2.2.3.cmml"><mrow id="S4.E5.m1.3.3.1.1.2.2.1.1" xref="S4.E5.m1.3.3.1.1.2.2.1.1.cmml"><mover accent="true" id="S4.E5.m1.3.3.1.1.2.2.1.1.2" xref="S4.E5.m1.3.3.1.1.2.2.1.1.2.cmml"><msub id="S4.E5.m1.3.3.1.1.2.2.1.1.2.2" xref="S4.E5.m1.3.3.1.1.2.2.1.1.2.2.cmml"><mi id="S4.E5.m1.3.3.1.1.2.2.1.1.2.2.2" xref="S4.E5.m1.3.3.1.1.2.2.1.1.2.2.2.cmml">W</mi><mi id="S4.E5.m1.3.3.1.1.2.2.1.1.2.2.3" xref="S4.E5.m1.3.3.1.1.2.2.1.1.2.2.3.cmml">i</mi></msub><mo id="S4.E5.m1.3.3.1.1.2.2.1.1.2.1" xref="S4.E5.m1.3.3.1.1.2.2.1.1.2.1.cmml">^</mo></mover><mo id="S4.E5.m1.3.3.1.1.2.2.1.1.1" xref="S4.E5.m1.3.3.1.1.2.2.1.1.1.cmml">=</mo><mfrac id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml"><msub id="S4.E5.m1.2.2.3" xref="S4.E5.m1.2.2.3.cmml"><mi id="S4.E5.m1.2.2.3.2" xref="S4.E5.m1.2.2.3.2.cmml">W</mi><mi id="S4.E5.m1.2.2.3.3" xref="S4.E5.m1.2.2.3.3.cmml">i</mi></msub><mrow id="S4.E5.m1.2.2.1.1" xref="S4.E5.m1.2.2.1.2.cmml"><mo stretchy="false" id="S4.E5.m1.2.2.1.1.2" xref="S4.E5.m1.2.2.1.2.1.cmml">‖</mo><msub id="S4.E5.m1.2.2.1.1.1" xref="S4.E5.m1.2.2.1.1.1.cmml"><mi id="S4.E5.m1.2.2.1.1.1.2" xref="S4.E5.m1.2.2.1.1.1.2.cmml">W</mi><mi id="S4.E5.m1.2.2.1.1.1.3" xref="S4.E5.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E5.m1.2.2.1.1.3" xref="S4.E5.m1.2.2.1.2.1.cmml">‖</mo></mrow></mfrac></mrow><mo id="S4.E5.m1.3.3.1.1.2.2.2.3" xref="S4.E5.m1.3.3.1.1.2.2.3a.cmml">,</mo><mrow id="S4.E5.m1.3.3.1.1.2.2.2.2" xref="S4.E5.m1.3.3.1.1.2.2.2.2.cmml"><mrow id="S4.E5.m1.3.3.1.1.2.2.2.2.2" xref="S4.E5.m1.3.3.1.1.2.2.2.2.2.cmml"><mo rspace="0.167em" id="S4.E5.m1.3.3.1.1.2.2.2.2.2.1" xref="S4.E5.m1.3.3.1.1.2.2.2.2.2.1.cmml">∀</mo><mi id="S4.E5.m1.3.3.1.1.2.2.2.2.2.2" xref="S4.E5.m1.3.3.1.1.2.2.2.2.2.2.cmml">i</mi></mrow><mo id="S4.E5.m1.3.3.1.1.2.2.2.2.1" xref="S4.E5.m1.3.3.1.1.2.2.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.3.3.1.1.2.2.2.2.3" xref="S4.E5.m1.3.3.1.1.2.2.2.2.3.cmml">𝒴</mi></mrow></mrow></mrow><mo id="S4.E5.m1.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.3b"><apply id="S4.E5.m1.3.3.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.3a.cmml" xref="S4.E5.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E5.m1.3.3.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1"><eq id="S4.E5.m1.3.3.1.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1"></eq><apply id="S4.E5.m1.3.3.1.1.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.2"><ci id="S4.E5.m1.3.3.1.1.1.1.2.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.2.1">^</ci><ci id="S4.E5.m1.3.3.1.1.1.1.2.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.2.2">𝑢</ci></apply><apply id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1"><divide id="S4.E5.m1.1.1.2.cmml" xref="S4.E5.m1.1.1"></divide><ci id="S4.E5.m1.1.1.3.cmml" xref="S4.E5.m1.1.1.3">𝑢</ci><apply id="S4.E5.m1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.3"><csymbol cd="latexml" id="S4.E5.m1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.3.1">norm</csymbol><ci id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1">𝑢</ci></apply></apply></apply><apply id="S4.E5.m1.3.3.1.1.2.2.3.cmml" xref="S4.E5.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.2.2.3a.cmml" xref="S4.E5.m1.3.3.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E5.m1.3.3.1.1.2.2.1.1.cmml" xref="S4.E5.m1.3.3.1.1.2.2.1.1"><eq id="S4.E5.m1.3.3.1.1.2.2.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.2.2.1.1.1"></eq><apply id="S4.E5.m1.3.3.1.1.2.2.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.2.2.1.1.2"><ci id="S4.E5.m1.3.3.1.1.2.2.1.1.2.1.cmml" xref="S4.E5.m1.3.3.1.1.2.2.1.1.2.1">^</ci><apply id="S4.E5.m1.3.3.1.1.2.2.1.1.2.2.cmml" xref="S4.E5.m1.3.3.1.1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.2.2.1.1.2.2.1.cmml" xref="S4.E5.m1.3.3.1.1.2.2.1.1.2.2">subscript</csymbol><ci id="S4.E5.m1.3.3.1.1.2.2.1.1.2.2.2.cmml" xref="S4.E5.m1.3.3.1.1.2.2.1.1.2.2.2">𝑊</ci><ci id="S4.E5.m1.3.3.1.1.2.2.1.1.2.2.3.cmml" xref="S4.E5.m1.3.3.1.1.2.2.1.1.2.2.3">𝑖</ci></apply></apply><apply id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2"><divide id="S4.E5.m1.2.2.2.cmml" xref="S4.E5.m1.2.2"></divide><apply id="S4.E5.m1.2.2.3.cmml" xref="S4.E5.m1.2.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.3.1.cmml" xref="S4.E5.m1.2.2.3">subscript</csymbol><ci id="S4.E5.m1.2.2.3.2.cmml" xref="S4.E5.m1.2.2.3.2">𝑊</ci><ci id="S4.E5.m1.2.2.3.3.cmml" xref="S4.E5.m1.2.2.3.3">𝑖</ci></apply><apply id="S4.E5.m1.2.2.1.2.cmml" xref="S4.E5.m1.2.2.1.1"><csymbol cd="latexml" id="S4.E5.m1.2.2.1.2.1.cmml" xref="S4.E5.m1.2.2.1.1.2">norm</csymbol><apply id="S4.E5.m1.2.2.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.E5.m1.2.2.1.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.1.2">𝑊</ci><ci id="S4.E5.m1.2.2.1.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="S4.E5.m1.3.3.1.1.2.2.2.2.cmml" xref="S4.E5.m1.3.3.1.1.2.2.2.2"><in id="S4.E5.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S4.E5.m1.3.3.1.1.2.2.2.2.1"></in><apply id="S4.E5.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S4.E5.m1.3.3.1.1.2.2.2.2.2"><csymbol cd="latexml" id="S4.E5.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S4.E5.m1.3.3.1.1.2.2.2.2.2.1">for-all</csymbol><ci id="S4.E5.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S4.E5.m1.3.3.1.1.2.2.2.2.2.2">𝑖</ci></apply><ci id="S4.E5.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S4.E5.m1.3.3.1.1.2.2.2.2.3">𝒴</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.3c">\hat{u}=\frac{u}{\|u\|},\hat{W_{i}}=\frac{W_{i}}{\|W_{i}\|},\forall i\in\mathcal{Y},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p3.5" class="ltx_p">Based on the normalized features and classifier weights, the softmax function can be represented as:</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.3" class="ltx_Math" alttext="\sigma(f^{y_{i}}(x_{i};\omega))=\frac{e^{\cos\theta_{i}}}{\sum_{k=1}^{|\mathcal{Y}|}e^{\cos\theta_{k}}}," display="block"><semantics id="S4.E6.m1.3a"><mrow id="S4.E6.m1.3.3.1" xref="S4.E6.m1.3.3.1.1.cmml"><mrow id="S4.E6.m1.3.3.1.1" xref="S4.E6.m1.3.3.1.1.cmml"><mrow id="S4.E6.m1.3.3.1.1.1" xref="S4.E6.m1.3.3.1.1.1.cmml"><mi id="S4.E6.m1.3.3.1.1.1.3" xref="S4.E6.m1.3.3.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.3.3.1.1.1.2" xref="S4.E6.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S4.E6.m1.3.3.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.3.3.1.1.1.1.1.2" xref="S4.E6.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.3.3.1.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.1.1.1.1.cmml"><msup id="S4.E6.m1.3.3.1.1.1.1.1.1.3" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.3.3.1.1.1.1.1.1.3.2" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.2.cmml">f</mi><msub id="S4.E6.m1.3.3.1.1.1.1.1.1.3.3" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E6.m1.3.3.1.1.1.1.1.1.3.3.2" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.3.2.cmml">y</mi><mi id="S4.E6.m1.3.3.1.1.1.1.1.1.3.3.3" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></msup><mo lspace="0em" rspace="0em" id="S4.E6.m1.3.3.1.1.1.1.1.1.2" xref="S4.E6.m1.3.3.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.2.cmml">;</mo><mi id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml">ω</mi><mo stretchy="false" id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.4" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E6.m1.3.3.1.1.1.1.1.3" xref="S4.E6.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.3.3.1.1.2" xref="S4.E6.m1.3.3.1.1.2.cmml">=</mo><mfrac id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml"><msup id="S4.E6.m1.1.1.3" xref="S4.E6.m1.1.1.3.cmml"><mi id="S4.E6.m1.1.1.3.2" xref="S4.E6.m1.1.1.3.2.cmml">e</mi><mrow id="S4.E6.m1.1.1.3.3" xref="S4.E6.m1.1.1.3.3.cmml"><mi id="S4.E6.m1.1.1.3.3.1" xref="S4.E6.m1.1.1.3.3.1.cmml">cos</mi><mo lspace="0.167em" id="S4.E6.m1.1.1.3.3a" xref="S4.E6.m1.1.1.3.3.cmml">⁡</mo><msub id="S4.E6.m1.1.1.3.3.2" xref="S4.E6.m1.1.1.3.3.2.cmml"><mi id="S4.E6.m1.1.1.3.3.2.2" xref="S4.E6.m1.1.1.3.3.2.2.cmml">θ</mi><mi id="S4.E6.m1.1.1.3.3.2.3" xref="S4.E6.m1.1.1.3.3.2.3.cmml">i</mi></msub></mrow></msup><mrow id="S4.E6.m1.1.1.1" xref="S4.E6.m1.1.1.1.cmml"><msubsup id="S4.E6.m1.1.1.1.2" xref="S4.E6.m1.1.1.1.2.cmml"><mo id="S4.E6.m1.1.1.1.2.2.2" xref="S4.E6.m1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E6.m1.1.1.1.2.2.3" xref="S4.E6.m1.1.1.1.2.2.3.cmml"><mi id="S4.E6.m1.1.1.1.2.2.3.2" xref="S4.E6.m1.1.1.1.2.2.3.2.cmml">k</mi><mo id="S4.E6.m1.1.1.1.2.2.3.1" xref="S4.E6.m1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E6.m1.1.1.1.2.2.3.3" xref="S4.E6.m1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S4.E6.m1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E6.m1.1.1.1.1.1.3.1" xref="S4.E6.m1.1.1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.cmml">𝒴</mi><mo stretchy="false" id="S4.E6.m1.1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.1.2.1.cmml">|</mo></mrow></msubsup><msup id="S4.E6.m1.1.1.1.3" xref="S4.E6.m1.1.1.1.3.cmml"><mi id="S4.E6.m1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.3.2.cmml">e</mi><mrow id="S4.E6.m1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.3.3.cmml"><mi id="S4.E6.m1.1.1.1.3.3.1" xref="S4.E6.m1.1.1.1.3.3.1.cmml">cos</mi><mo lspace="0.167em" id="S4.E6.m1.1.1.1.3.3a" xref="S4.E6.m1.1.1.1.3.3.cmml">⁡</mo><msub id="S4.E6.m1.1.1.1.3.3.2" xref="S4.E6.m1.1.1.1.3.3.2.cmml"><mi id="S4.E6.m1.1.1.1.3.3.2.2" xref="S4.E6.m1.1.1.1.3.3.2.2.cmml">θ</mi><mi id="S4.E6.m1.1.1.1.3.3.2.3" xref="S4.E6.m1.1.1.1.3.3.2.3.cmml">k</mi></msub></mrow></msup></mrow></mfrac></mrow><mo id="S4.E6.m1.3.3.1.2" xref="S4.E6.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.3b"><apply id="S4.E6.m1.3.3.1.1.cmml" xref="S4.E6.m1.3.3.1"><eq id="S4.E6.m1.3.3.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.2"></eq><apply id="S4.E6.m1.3.3.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1"><times id="S4.E6.m1.3.3.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.1.2"></times><ci id="S4.E6.m1.3.3.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.1.3">𝜎</ci><apply id="S4.E6.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1"><times id="S4.E6.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.2"></times><apply id="S4.E6.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E6.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.2">𝑓</ci><apply id="S4.E6.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E6.m1.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.3.2">𝑦</ci><ci id="S4.E6.m1.3.3.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply><list id="S4.E6.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.1"><apply id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2">𝜔</ci></list></apply></apply><apply id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1"><divide id="S4.E6.m1.1.1.2.cmml" xref="S4.E6.m1.1.1"></divide><apply id="S4.E6.m1.1.1.3.cmml" xref="S4.E6.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.3">superscript</csymbol><ci id="S4.E6.m1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.3.2">𝑒</ci><apply id="S4.E6.m1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.3.3"><cos id="S4.E6.m1.1.1.3.3.1.cmml" xref="S4.E6.m1.1.1.3.3.1"></cos><apply id="S4.E6.m1.1.1.3.3.2.cmml" xref="S4.E6.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.3.3.2.1.cmml" xref="S4.E6.m1.1.1.3.3.2">subscript</csymbol><ci id="S4.E6.m1.1.1.3.3.2.2.cmml" xref="S4.E6.m1.1.1.3.3.2.2">𝜃</ci><ci id="S4.E6.m1.1.1.3.3.2.3.cmml" xref="S4.E6.m1.1.1.3.3.2.3">𝑖</ci></apply></apply></apply><apply id="S4.E6.m1.1.1.1.cmml" xref="S4.E6.m1.1.1.1"><apply id="S4.E6.m1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.2">superscript</csymbol><apply id="S4.E6.m1.1.1.1.2.2.cmml" xref="S4.E6.m1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.2.2.1.cmml" xref="S4.E6.m1.1.1.1.2">subscript</csymbol><sum id="S4.E6.m1.1.1.1.2.2.2.cmml" xref="S4.E6.m1.1.1.1.2.2.2"></sum><apply id="S4.E6.m1.1.1.1.2.2.3.cmml" xref="S4.E6.m1.1.1.1.2.2.3"><eq id="S4.E6.m1.1.1.1.2.2.3.1.cmml" xref="S4.E6.m1.1.1.1.2.2.3.1"></eq><ci id="S4.E6.m1.1.1.1.2.2.3.2.cmml" xref="S4.E6.m1.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S4.E6.m1.1.1.1.2.2.3.3.cmml" xref="S4.E6.m1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S4.E6.m1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.3"><abs id="S4.E6.m1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.3.1"></abs><ci id="S4.E6.m1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1">𝒴</ci></apply></apply><apply id="S4.E6.m1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.3">superscript</csymbol><ci id="S4.E6.m1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.3.2">𝑒</ci><apply id="S4.E6.m1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.3.3"><cos id="S4.E6.m1.1.1.1.3.3.1.cmml" xref="S4.E6.m1.1.1.1.3.3.1"></cos><apply id="S4.E6.m1.1.1.1.3.3.2.cmml" xref="S4.E6.m1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.3.3.2.1.cmml" xref="S4.E6.m1.1.1.1.3.3.2">subscript</csymbol><ci id="S4.E6.m1.1.1.1.3.3.2.2.cmml" xref="S4.E6.m1.1.1.1.3.3.2.2">𝜃</ci><ci id="S4.E6.m1.1.1.1.3.3.2.3.cmml" xref="S4.E6.m1.1.1.1.3.3.2.3">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.3c">\sigma(f^{y_{i}}(x_{i};\omega))=\frac{e^{\cos\theta_{i}}}{\sum_{k=1}^{|\mathcal{Y}|}e^{\cos\theta_{k}}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p3.6" class="ltx_p">However, as the logit range is limited between zero to one (i.e., cosine range), the model can be slowly converged in the training. We thus give a margin to the ground-truth class to encourage the model to converge faster with the normalization constraint.</p>
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E7.m1.7" class="ltx_Math" alttext="\sigma(f^{y_{i}}(x_{i};\omega))=\frac{e^{(\cos\theta_{i}-m)/\tau}}{e^{(\cos\theta_{i}-m)/\tau}+\sum_{k=1,k\neq i}^{|\mathcal{Y}|}e^{\cos\theta_{k}/\tau}}," display="block"><semantics id="S4.E7.m1.7a"><mrow id="S4.E7.m1.7.7.1" xref="S4.E7.m1.7.7.1.1.cmml"><mrow id="S4.E7.m1.7.7.1.1" xref="S4.E7.m1.7.7.1.1.cmml"><mrow id="S4.E7.m1.7.7.1.1.1" xref="S4.E7.m1.7.7.1.1.1.cmml"><mi id="S4.E7.m1.7.7.1.1.1.3" xref="S4.E7.m1.7.7.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.7.7.1.1.1.2" xref="S4.E7.m1.7.7.1.1.1.2.cmml">​</mo><mrow id="S4.E7.m1.7.7.1.1.1.1.1" xref="S4.E7.m1.7.7.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E7.m1.7.7.1.1.1.1.1.2" xref="S4.E7.m1.7.7.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.7.7.1.1.1.1.1.1" xref="S4.E7.m1.7.7.1.1.1.1.1.1.cmml"><msup id="S4.E7.m1.7.7.1.1.1.1.1.1.3" xref="S4.E7.m1.7.7.1.1.1.1.1.1.3.cmml"><mi id="S4.E7.m1.7.7.1.1.1.1.1.1.3.2" xref="S4.E7.m1.7.7.1.1.1.1.1.1.3.2.cmml">f</mi><msub id="S4.E7.m1.7.7.1.1.1.1.1.1.3.3" xref="S4.E7.m1.7.7.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E7.m1.7.7.1.1.1.1.1.1.3.3.2" xref="S4.E7.m1.7.7.1.1.1.1.1.1.3.3.2.cmml">y</mi><mi id="S4.E7.m1.7.7.1.1.1.1.1.1.3.3.3" xref="S4.E7.m1.7.7.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></msup><mo lspace="0em" rspace="0em" id="S4.E7.m1.7.7.1.1.1.1.1.1.2" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E7.m1.7.7.1.1.1.1.1.1.1.1" xref="S4.E7.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E7.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.7.7.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S4.E7.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.E7.m1.7.7.1.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E7.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.7.7.1.1.1.1.1.1.1.2.cmml">;</mo><mi id="S4.E7.m1.6.6" xref="S4.E7.m1.6.6.cmml">ω</mi><mo stretchy="false" id="S4.E7.m1.7.7.1.1.1.1.1.1.1.1.4" xref="S4.E7.m1.7.7.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E7.m1.7.7.1.1.1.1.1.3" xref="S4.E7.m1.7.7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.7.7.1.1.2" xref="S4.E7.m1.7.7.1.1.2.cmml">=</mo><mfrac id="S4.E7.m1.5.5" xref="S4.E7.m1.5.5.cmml"><msup id="S4.E7.m1.1.1.1" xref="S4.E7.m1.1.1.1.cmml"><mi id="S4.E7.m1.1.1.1.3" xref="S4.E7.m1.1.1.1.3.cmml">e</mi><mrow id="S4.E7.m1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.cmml"><mrow id="S4.E7.m1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E7.m1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E7.m1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.2.1" xref="S4.E7.m1.1.1.1.1.1.1.1.1.2.1.cmml">cos</mi><mo lspace="0.167em" id="S4.E7.m1.1.1.1.1.1.1.1.1.2a" xref="S4.E7.m1.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><msub id="S4.E7.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E7.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E7.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">θ</mi><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub></mrow><mo id="S4.E7.m1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.3.cmml">m</mi></mrow><mo stretchy="false" id="S4.E7.m1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E7.m1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.2.cmml">/</mo><mi id="S4.E7.m1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.3.cmml">τ</mi></mrow></msup><mrow id="S4.E7.m1.5.5.5" xref="S4.E7.m1.5.5.5.cmml"><msup id="S4.E7.m1.5.5.5.6" xref="S4.E7.m1.5.5.5.6.cmml"><mi id="S4.E7.m1.5.5.5.6.2" xref="S4.E7.m1.5.5.5.6.2.cmml">e</mi><mrow id="S4.E7.m1.2.2.2.1.1" xref="S4.E7.m1.2.2.2.1.1.cmml"><mrow id="S4.E7.m1.2.2.2.1.1.1.1" xref="S4.E7.m1.2.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E7.m1.2.2.2.1.1.1.1.2" xref="S4.E7.m1.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.2.2.2.1.1.1.1.1" xref="S4.E7.m1.2.2.2.1.1.1.1.1.cmml"><mrow id="S4.E7.m1.2.2.2.1.1.1.1.1.2" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.2.2.2.1.1.1.1.1.2.1" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.1.cmml">cos</mi><mo lspace="0.167em" id="S4.E7.m1.2.2.2.1.1.1.1.1.2a" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.cmml">⁡</mo><msub id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.cmml"><mi id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2.cmml">θ</mi><mi id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.3" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.3.cmml">i</mi></msub></mrow><mo id="S4.E7.m1.2.2.2.1.1.1.1.1.1" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.cmml">−</mo><mi id="S4.E7.m1.2.2.2.1.1.1.1.1.3" xref="S4.E7.m1.2.2.2.1.1.1.1.1.3.cmml">m</mi></mrow><mo stretchy="false" id="S4.E7.m1.2.2.2.1.1.1.1.3" xref="S4.E7.m1.2.2.2.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E7.m1.2.2.2.1.1.2" xref="S4.E7.m1.2.2.2.1.1.2.cmml">/</mo><mi id="S4.E7.m1.2.2.2.1.1.3" xref="S4.E7.m1.2.2.2.1.1.3.cmml">τ</mi></mrow></msup><mo rspace="0.055em" id="S4.E7.m1.5.5.5.5" xref="S4.E7.m1.5.5.5.5.cmml">+</mo><mrow id="S4.E7.m1.5.5.5.7" xref="S4.E7.m1.5.5.5.7.cmml"><msubsup id="S4.E7.m1.5.5.5.7.1" xref="S4.E7.m1.5.5.5.7.1.cmml"><mo id="S4.E7.m1.5.5.5.7.1.2.2" xref="S4.E7.m1.5.5.5.7.1.2.2.cmml">∑</mo><mrow id="S4.E7.m1.4.4.4.3.2.2" xref="S4.E7.m1.4.4.4.3.2.3.cmml"><mrow id="S4.E7.m1.3.3.3.2.1.1.1" xref="S4.E7.m1.3.3.3.2.1.1.1.cmml"><mi id="S4.E7.m1.3.3.3.2.1.1.1.2" xref="S4.E7.m1.3.3.3.2.1.1.1.2.cmml">k</mi><mo id="S4.E7.m1.3.3.3.2.1.1.1.1" xref="S4.E7.m1.3.3.3.2.1.1.1.1.cmml">=</mo><mn id="S4.E7.m1.3.3.3.2.1.1.1.3" xref="S4.E7.m1.3.3.3.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E7.m1.4.4.4.3.2.2.3" xref="S4.E7.m1.4.4.4.3.2.3a.cmml">,</mo><mrow id="S4.E7.m1.4.4.4.3.2.2.2" xref="S4.E7.m1.4.4.4.3.2.2.2.cmml"><mi id="S4.E7.m1.4.4.4.3.2.2.2.2" xref="S4.E7.m1.4.4.4.3.2.2.2.2.cmml">k</mi><mo id="S4.E7.m1.4.4.4.3.2.2.2.1" xref="S4.E7.m1.4.4.4.3.2.2.2.1.cmml">≠</mo><mi id="S4.E7.m1.4.4.4.3.2.2.2.3" xref="S4.E7.m1.4.4.4.3.2.2.2.3.cmml">i</mi></mrow></mrow><mrow id="S4.E7.m1.5.5.5.4.1.3" xref="S4.E7.m1.5.5.5.4.1.2.cmml"><mo stretchy="false" id="S4.E7.m1.5.5.5.4.1.3.1" xref="S4.E7.m1.5.5.5.4.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.5.5.5.4.1.1" xref="S4.E7.m1.5.5.5.4.1.1.cmml">𝒴</mi><mo stretchy="false" id="S4.E7.m1.5.5.5.4.1.3.2" xref="S4.E7.m1.5.5.5.4.1.2.1.cmml">|</mo></mrow></msubsup><msup id="S4.E7.m1.5.5.5.7.2" xref="S4.E7.m1.5.5.5.7.2.cmml"><mi id="S4.E7.m1.5.5.5.7.2.2" xref="S4.E7.m1.5.5.5.7.2.2.cmml">e</mi><mrow id="S4.E7.m1.5.5.5.7.2.3" xref="S4.E7.m1.5.5.5.7.2.3.cmml"><mi id="S4.E7.m1.5.5.5.7.2.3.1" xref="S4.E7.m1.5.5.5.7.2.3.1.cmml">cos</mi><mo lspace="0.167em" id="S4.E7.m1.5.5.5.7.2.3a" xref="S4.E7.m1.5.5.5.7.2.3.cmml">⁡</mo><mrow id="S4.E7.m1.5.5.5.7.2.3.2" xref="S4.E7.m1.5.5.5.7.2.3.2.cmml"><msub id="S4.E7.m1.5.5.5.7.2.3.2.2" xref="S4.E7.m1.5.5.5.7.2.3.2.2.cmml"><mi id="S4.E7.m1.5.5.5.7.2.3.2.2.2" xref="S4.E7.m1.5.5.5.7.2.3.2.2.2.cmml">θ</mi><mi id="S4.E7.m1.5.5.5.7.2.3.2.2.3" xref="S4.E7.m1.5.5.5.7.2.3.2.2.3.cmml">k</mi></msub><mo id="S4.E7.m1.5.5.5.7.2.3.2.1" xref="S4.E7.m1.5.5.5.7.2.3.2.1.cmml">/</mo><mi id="S4.E7.m1.5.5.5.7.2.3.2.3" xref="S4.E7.m1.5.5.5.7.2.3.2.3.cmml">τ</mi></mrow></mrow></msup></mrow></mrow></mfrac></mrow><mo id="S4.E7.m1.7.7.1.2" xref="S4.E7.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.7b"><apply id="S4.E7.m1.7.7.1.1.cmml" xref="S4.E7.m1.7.7.1"><eq id="S4.E7.m1.7.7.1.1.2.cmml" xref="S4.E7.m1.7.7.1.1.2"></eq><apply id="S4.E7.m1.7.7.1.1.1.cmml" xref="S4.E7.m1.7.7.1.1.1"><times id="S4.E7.m1.7.7.1.1.1.2.cmml" xref="S4.E7.m1.7.7.1.1.1.2"></times><ci id="S4.E7.m1.7.7.1.1.1.3.cmml" xref="S4.E7.m1.7.7.1.1.1.3">𝜎</ci><apply id="S4.E7.m1.7.7.1.1.1.1.1.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1"><times id="S4.E7.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2"></times><apply id="S4.E7.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.1.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E7.m1.7.7.1.1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.3.2">𝑓</ci><apply id="S4.E7.m1.7.7.1.1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E7.m1.7.7.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.3.3.2">𝑦</ci><ci id="S4.E7.m1.7.7.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply><list id="S4.E7.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.1.1"><apply id="S4.E7.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.E7.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S4.E7.m1.6.6.cmml" xref="S4.E7.m1.6.6">𝜔</ci></list></apply></apply><apply id="S4.E7.m1.5.5.cmml" xref="S4.E7.m1.5.5"><divide id="S4.E7.m1.5.5.6.cmml" xref="S4.E7.m1.5.5"></divide><apply id="S4.E7.m1.1.1.1.cmml" xref="S4.E7.m1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1">superscript</csymbol><ci id="S4.E7.m1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.3">𝑒</ci><apply id="S4.E7.m1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1"><divide id="S4.E7.m1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.2"></divide><apply id="S4.E7.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1"><minus id="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E7.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.2"><cos id="S4.E7.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.2.1"></cos><apply id="S4.E7.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.2.2.2">𝜃</ci><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></apply><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.3">𝑚</ci></apply><ci id="S4.E7.m1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.3">𝜏</ci></apply></apply><apply id="S4.E7.m1.5.5.5.cmml" xref="S4.E7.m1.5.5.5"><plus id="S4.E7.m1.5.5.5.5.cmml" xref="S4.E7.m1.5.5.5.5"></plus><apply id="S4.E7.m1.5.5.5.6.cmml" xref="S4.E7.m1.5.5.5.6"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.5.6.1.cmml" xref="S4.E7.m1.5.5.5.6">superscript</csymbol><ci id="S4.E7.m1.5.5.5.6.2.cmml" xref="S4.E7.m1.5.5.5.6.2">𝑒</ci><apply id="S4.E7.m1.2.2.2.1.1.cmml" xref="S4.E7.m1.2.2.2.1.1"><divide id="S4.E7.m1.2.2.2.1.1.2.cmml" xref="S4.E7.m1.2.2.2.1.1.2"></divide><apply id="S4.E7.m1.2.2.2.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1"><minus id="S4.E7.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1"></minus><apply id="S4.E7.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2"><cos id="S4.E7.m1.2.2.2.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.1"></cos><apply id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2">𝜃</ci><ci id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.3.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.3">𝑖</ci></apply></apply><ci id="S4.E7.m1.2.2.2.1.1.1.1.1.3.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.3">𝑚</ci></apply><ci id="S4.E7.m1.2.2.2.1.1.3.cmml" xref="S4.E7.m1.2.2.2.1.1.3">𝜏</ci></apply></apply><apply id="S4.E7.m1.5.5.5.7.cmml" xref="S4.E7.m1.5.5.5.7"><apply id="S4.E7.m1.5.5.5.7.1.cmml" xref="S4.E7.m1.5.5.5.7.1"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.5.7.1.1.cmml" xref="S4.E7.m1.5.5.5.7.1">superscript</csymbol><apply id="S4.E7.m1.5.5.5.7.1.2.cmml" xref="S4.E7.m1.5.5.5.7.1"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.5.7.1.2.1.cmml" xref="S4.E7.m1.5.5.5.7.1">subscript</csymbol><sum id="S4.E7.m1.5.5.5.7.1.2.2.cmml" xref="S4.E7.m1.5.5.5.7.1.2.2"></sum><apply id="S4.E7.m1.4.4.4.3.2.3.cmml" xref="S4.E7.m1.4.4.4.3.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.4.3.2.3a.cmml" xref="S4.E7.m1.4.4.4.3.2.2.3">formulae-sequence</csymbol><apply id="S4.E7.m1.3.3.3.2.1.1.1.cmml" xref="S4.E7.m1.3.3.3.2.1.1.1"><eq id="S4.E7.m1.3.3.3.2.1.1.1.1.cmml" xref="S4.E7.m1.3.3.3.2.1.1.1.1"></eq><ci id="S4.E7.m1.3.3.3.2.1.1.1.2.cmml" xref="S4.E7.m1.3.3.3.2.1.1.1.2">𝑘</ci><cn type="integer" id="S4.E7.m1.3.3.3.2.1.1.1.3.cmml" xref="S4.E7.m1.3.3.3.2.1.1.1.3">1</cn></apply><apply id="S4.E7.m1.4.4.4.3.2.2.2.cmml" xref="S4.E7.m1.4.4.4.3.2.2.2"><neq id="S4.E7.m1.4.4.4.3.2.2.2.1.cmml" xref="S4.E7.m1.4.4.4.3.2.2.2.1"></neq><ci id="S4.E7.m1.4.4.4.3.2.2.2.2.cmml" xref="S4.E7.m1.4.4.4.3.2.2.2.2">𝑘</ci><ci id="S4.E7.m1.4.4.4.3.2.2.2.3.cmml" xref="S4.E7.m1.4.4.4.3.2.2.2.3">𝑖</ci></apply></apply></apply><apply id="S4.E7.m1.5.5.5.4.1.2.cmml" xref="S4.E7.m1.5.5.5.4.1.3"><abs id="S4.E7.m1.5.5.5.4.1.2.1.cmml" xref="S4.E7.m1.5.5.5.4.1.3.1"></abs><ci id="S4.E7.m1.5.5.5.4.1.1.cmml" xref="S4.E7.m1.5.5.5.4.1.1">𝒴</ci></apply></apply><apply id="S4.E7.m1.5.5.5.7.2.cmml" xref="S4.E7.m1.5.5.5.7.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.5.7.2.1.cmml" xref="S4.E7.m1.5.5.5.7.2">superscript</csymbol><ci id="S4.E7.m1.5.5.5.7.2.2.cmml" xref="S4.E7.m1.5.5.5.7.2.2">𝑒</ci><apply id="S4.E7.m1.5.5.5.7.2.3.cmml" xref="S4.E7.m1.5.5.5.7.2.3"><cos id="S4.E7.m1.5.5.5.7.2.3.1.cmml" xref="S4.E7.m1.5.5.5.7.2.3.1"></cos><apply id="S4.E7.m1.5.5.5.7.2.3.2.cmml" xref="S4.E7.m1.5.5.5.7.2.3.2"><divide id="S4.E7.m1.5.5.5.7.2.3.2.1.cmml" xref="S4.E7.m1.5.5.5.7.2.3.2.1"></divide><apply id="S4.E7.m1.5.5.5.7.2.3.2.2.cmml" xref="S4.E7.m1.5.5.5.7.2.3.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.5.7.2.3.2.2.1.cmml" xref="S4.E7.m1.5.5.5.7.2.3.2.2">subscript</csymbol><ci id="S4.E7.m1.5.5.5.7.2.3.2.2.2.cmml" xref="S4.E7.m1.5.5.5.7.2.3.2.2.2">𝜃</ci><ci id="S4.E7.m1.5.5.5.7.2.3.2.2.3.cmml" xref="S4.E7.m1.5.5.5.7.2.3.2.2.3">𝑘</ci></apply><ci id="S4.E7.m1.5.5.5.7.2.3.2.3.cmml" xref="S4.E7.m1.5.5.5.7.2.3.2.3">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.7c">\sigma(f^{y_{i}}(x_{i};\omega))=\frac{e^{(\cos\theta_{i}-m)/\tau}}{e^{(\cos\theta_{i}-m)/\tau}+\sum_{k=1,k\neq i}^{|\mathcal{Y}|}e^{\cos\theta_{k}/\tau}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p3.3" class="ltx_p">where <math id="S4.SS1.p3.1.m1.2" class="ltx_Math" alttext="m\in[0,1]" display="inline"><semantics id="S4.SS1.p3.1.m1.2a"><mrow id="S4.SS1.p3.1.m1.2.3" xref="S4.SS1.p3.1.m1.2.3.cmml"><mi id="S4.SS1.p3.1.m1.2.3.2" xref="S4.SS1.p3.1.m1.2.3.2.cmml">m</mi><mo id="S4.SS1.p3.1.m1.2.3.1" xref="S4.SS1.p3.1.m1.2.3.1.cmml">∈</mo><mrow id="S4.SS1.p3.1.m1.2.3.3.2" xref="S4.SS1.p3.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p3.1.m1.2.3.3.2.1" xref="S4.SS1.p3.1.m1.2.3.3.1.cmml">[</mo><mn id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">0</mn><mo id="S4.SS1.p3.1.m1.2.3.3.2.2" xref="S4.SS1.p3.1.m1.2.3.3.1.cmml">,</mo><mn id="S4.SS1.p3.1.m1.2.2" xref="S4.SS1.p3.1.m1.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS1.p3.1.m1.2.3.3.2.3" xref="S4.SS1.p3.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.2b"><apply id="S4.SS1.p3.1.m1.2.3.cmml" xref="S4.SS1.p3.1.m1.2.3"><in id="S4.SS1.p3.1.m1.2.3.1.cmml" xref="S4.SS1.p3.1.m1.2.3.1"></in><ci id="S4.SS1.p3.1.m1.2.3.2.cmml" xref="S4.SS1.p3.1.m1.2.3.2">𝑚</ci><interval closure="closed" id="S4.SS1.p3.1.m1.2.3.3.1.cmml" xref="S4.SS1.p3.1.m1.2.3.3.2"><cn type="integer" id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">0</cn><cn type="integer" id="S4.SS1.p3.1.m1.2.2.cmml" xref="S4.SS1.p3.1.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.2c">m\in[0,1]</annotation></semantics></math> is the margin which is the hyper-parameter, <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><mi id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><ci id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">\tau</annotation></semantics></math> indicates the temperature. The margin encourages the training model to predict the ground-truth label while having the margin <math id="S4.SS1.p3.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS1.p3.3.m3.1a"><mi id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><ci id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">m</annotation></semantics></math> to other classes on the logit<span id="footnote5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>Note that we use the margin only in the training phase.</span></span></span>. This strategy allows to more correctly estimate the drift without slow convergence in the training.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Drift Regularization</h3>

<figure id="S4.F3" class="ltx_figure">
<div id="S4.F3.1" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:149.4pt;vertical-align:-6.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-37.1pt,12.2pt) scale(0.85396,0.85396) ;">
<p id="S4.F3.1.1" class="ltx_p"><span id="S4.F3.1.1.1" class="ltx_text">
<span id="S4.F3.1.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:507.8pt;height:174.8pt;vertical-align:-7.9pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S4.F3.1.1.1.1.1" class="ltx_p"><span id="S4.F3.1.1.1.1.1.1" class="ltx_text"><img src="/html/2309.07189/assets/x4.png" id="S4.F3.1.1.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="538" height="177" alt="Refer to caption"></span></span>
</span></span></span></p>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Confidence differences between global model, local model and local model with LfD. This shows that training with LfD encourages the local model to have the similar confidence to the global model.</figcaption>
</figure>
<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">After estimating the drift for each sample, the local optimization is performed such that the model does not fall in the drift direction. To this end, the model should be learned in the reverse direction to the estimated drift. We control the learning direction of the local optimization by regularizing the model with the auxiliary label containing the reverse direction of the estimated drift. We define the regularization term <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\mathcal{R}</annotation></semantics></math> to prevent the drift as follows:</p>
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.42" class="ltx_Math" alttext="\mathcal{R}^{y_{i}}(x_{i})=-\hat{y_{i}}\cdot\log(\sigma(f^{y_{i}}(x_{i})))\text{ where }\hat{y_{i}}=\sigma(-f^{y_{i}}_{D}(x_{i}))" display="block"><semantics id="S4.E8.m1.42a"><mtable displaystyle="true" id="S4.E8.m1.42.42.6" xref="S4.E8.m1.39.39.3.cmml"><mtr id="S4.E8.m1.42.42.6a" xref="S4.E8.m1.39.39.3.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E8.m1.42.42.6b" xref="S4.E8.m1.39.39.3.cmml"><mrow id="S4.E8.m1.42.42.6.39.39.39" xref="S4.E8.m1.39.39.3.cmml"><mrow id="S4.E8.m1.40.40.4.37.37.37.37" xref="S4.E8.m1.39.39.3.cmml"><msup id="S4.E8.m1.40.40.4.37.37.37.37.3" xref="S4.E8.m1.39.39.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml">ℛ</mi><msub id="S4.E8.m1.2.2.2.2.2.2.1" xref="S4.E8.m1.2.2.2.2.2.2.1.cmml"><mi id="S4.E8.m1.2.2.2.2.2.2.1.2" xref="S4.E8.m1.2.2.2.2.2.2.1.2.cmml">y</mi><mi id="S4.E8.m1.2.2.2.2.2.2.1.3" xref="S4.E8.m1.2.2.2.2.2.2.1.3.cmml">i</mi></msub></msup><mo lspace="0em" rspace="0em" id="S4.E8.m1.40.40.4.37.37.37.37.2" xref="S4.E8.m1.39.39.3a.cmml">​</mo><mrow id="S4.E8.m1.40.40.4.37.37.37.37.1.1" xref="S4.E8.m1.39.39.3.cmml"><mo stretchy="false" id="S4.E8.m1.3.3.3.3.3.3" xref="S4.E8.m1.39.39.3a.cmml">(</mo><msub id="S4.E8.m1.40.40.4.37.37.37.37.1.1.1" xref="S4.E8.m1.39.39.3.cmml"><mi id="S4.E8.m1.4.4.4.4.4.4" xref="S4.E8.m1.4.4.4.4.4.4.cmml">x</mi><mi id="S4.E8.m1.5.5.5.5.5.5.1" xref="S4.E8.m1.5.5.5.5.5.5.1.cmml">i</mi></msub><mo stretchy="false" id="S4.E8.m1.6.6.6.6.6.6" xref="S4.E8.m1.39.39.3a.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.7.7.7.7.7.7" xref="S4.E8.m1.7.7.7.7.7.7.cmml">=</mo><mrow id="S4.E8.m1.41.41.5.38.38.38.38" xref="S4.E8.m1.39.39.3.cmml"><mo id="S4.E8.m1.41.41.5.38.38.38.38a" xref="S4.E8.m1.39.39.3a.cmml">−</mo><mrow id="S4.E8.m1.41.41.5.38.38.38.38.1" xref="S4.E8.m1.39.39.3.cmml"><mrow id="S4.E8.m1.41.41.5.38.38.38.38.1.1" xref="S4.E8.m1.39.39.3.cmml"><mover accent="true" id="S4.E8.m1.9.9.9.9.9.9" xref="S4.E8.m1.9.9.9.9.9.9.cmml"><msub id="S4.E8.m1.9.9.9.9.9.9.2" xref="S4.E8.m1.9.9.9.9.9.9.2.cmml"><mi id="S4.E8.m1.9.9.9.9.9.9.2.2" xref="S4.E8.m1.9.9.9.9.9.9.2.2.cmml">y</mi><mi id="S4.E8.m1.9.9.9.9.9.9.2.3" xref="S4.E8.m1.9.9.9.9.9.9.2.3.cmml">i</mi></msub><mo id="S4.E8.m1.9.9.9.9.9.9.1" xref="S4.E8.m1.9.9.9.9.9.9.1.cmml">^</mo></mover><mo lspace="0.222em" rspace="0.222em" id="S4.E8.m1.10.10.10.10.10.10" xref="S4.E8.m1.10.10.10.10.10.10.cmml">⋅</mo><mrow id="S4.E8.m1.41.41.5.38.38.38.38.1.1.1.1" xref="S4.E8.m1.39.39.3.cmml"><mi id="S4.E8.m1.11.11.11.11.11.11" xref="S4.E8.m1.11.11.11.11.11.11.cmml">log</mi><mo id="S4.E8.m1.41.41.5.38.38.38.38.1.1.1.1a" xref="S4.E8.m1.39.39.3a.cmml">⁡</mo><mrow id="S4.E8.m1.41.41.5.38.38.38.38.1.1.1.1.1" xref="S4.E8.m1.39.39.3.cmml"><mo stretchy="false" id="S4.E8.m1.12.12.12.12.12.12" xref="S4.E8.m1.39.39.3a.cmml">(</mo><mrow id="S4.E8.m1.41.41.5.38.38.38.38.1.1.1.1.1.1" xref="S4.E8.m1.39.39.3.cmml"><mi id="S4.E8.m1.13.13.13.13.13.13" xref="S4.E8.m1.13.13.13.13.13.13.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.41.41.5.38.38.38.38.1.1.1.1.1.1.2" xref="S4.E8.m1.39.39.3a.cmml">​</mo><mrow id="S4.E8.m1.41.41.5.38.38.38.38.1.1.1.1.1.1.1.1" xref="S4.E8.m1.39.39.3.cmml"><mo stretchy="false" id="S4.E8.m1.14.14.14.14.14.14" xref="S4.E8.m1.39.39.3a.cmml">(</mo><mrow id="S4.E8.m1.41.41.5.38.38.38.38.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.39.39.3.cmml"><msup id="S4.E8.m1.41.41.5.38.38.38.38.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.39.39.3.cmml"><mi id="S4.E8.m1.15.15.15.15.15.15" xref="S4.E8.m1.15.15.15.15.15.15.cmml">f</mi><msub id="S4.E8.m1.16.16.16.16.16.16.1" xref="S4.E8.m1.16.16.16.16.16.16.1.cmml"><mi id="S4.E8.m1.16.16.16.16.16.16.1.2" xref="S4.E8.m1.16.16.16.16.16.16.1.2.cmml">y</mi><mi id="S4.E8.m1.16.16.16.16.16.16.1.3" xref="S4.E8.m1.16.16.16.16.16.16.1.3.cmml">i</mi></msub></msup><mo lspace="0em" rspace="0em" id="S4.E8.m1.41.41.5.38.38.38.38.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.39.39.3a.cmml">​</mo><mrow id="S4.E8.m1.41.41.5.38.38.38.38.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.39.39.3.cmml"><mo stretchy="false" id="S4.E8.m1.17.17.17.17.17.17" xref="S4.E8.m1.39.39.3a.cmml">(</mo><msub id="S4.E8.m1.41.41.5.38.38.38.38.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.39.39.3.cmml"><mi id="S4.E8.m1.18.18.18.18.18.18" xref="S4.E8.m1.18.18.18.18.18.18.cmml">x</mi><mi id="S4.E8.m1.19.19.19.19.19.19.1" xref="S4.E8.m1.19.19.19.19.19.19.1.cmml">i</mi></msub><mo stretchy="false" id="S4.E8.m1.20.20.20.20.20.20" xref="S4.E8.m1.39.39.3a.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E8.m1.21.21.21.21.21.21" xref="S4.E8.m1.39.39.3a.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E8.m1.22.22.22.22.22.22" xref="S4.E8.m1.39.39.3a.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" rspace="0em" id="S4.E8.m1.41.41.5.38.38.38.38.1.2" xref="S4.E8.m1.39.39.3a.cmml">​</mo><mtext id="S4.E8.m1.23.23.23.23.23.23" xref="S4.E8.m1.23.23.23.23.23.23a.cmml"> where </mtext><mo lspace="0em" rspace="0em" id="S4.E8.m1.41.41.5.38.38.38.38.1.2a" xref="S4.E8.m1.39.39.3a.cmml">​</mo><mover accent="true" id="S4.E8.m1.24.24.24.24.24.24" xref="S4.E8.m1.24.24.24.24.24.24.cmml"><msub id="S4.E8.m1.24.24.24.24.24.24.2" xref="S4.E8.m1.24.24.24.24.24.24.2.cmml"><mi id="S4.E8.m1.24.24.24.24.24.24.2.2" xref="S4.E8.m1.24.24.24.24.24.24.2.2.cmml">y</mi><mi id="S4.E8.m1.24.24.24.24.24.24.2.3" xref="S4.E8.m1.24.24.24.24.24.24.2.3.cmml">i</mi></msub><mo id="S4.E8.m1.24.24.24.24.24.24.1" xref="S4.E8.m1.24.24.24.24.24.24.1.cmml">^</mo></mover></mrow></mrow><mo id="S4.E8.m1.25.25.25.25.25.25" xref="S4.E8.m1.25.25.25.25.25.25.cmml">=</mo><mrow id="S4.E8.m1.42.42.6.39.39.39.39" xref="S4.E8.m1.39.39.3.cmml"><mi id="S4.E8.m1.26.26.26.26.26.26" xref="S4.E8.m1.26.26.26.26.26.26.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.42.42.6.39.39.39.39.2" xref="S4.E8.m1.39.39.3a.cmml">​</mo><mrow id="S4.E8.m1.42.42.6.39.39.39.39.1.1" xref="S4.E8.m1.39.39.3.cmml"><mo stretchy="false" id="S4.E8.m1.27.27.27.27.27.27" xref="S4.E8.m1.39.39.3a.cmml">(</mo><mrow id="S4.E8.m1.42.42.6.39.39.39.39.1.1.1" xref="S4.E8.m1.39.39.3.cmml"><mo id="S4.E8.m1.42.42.6.39.39.39.39.1.1.1a" xref="S4.E8.m1.39.39.3a.cmml">−</mo><mrow id="S4.E8.m1.42.42.6.39.39.39.39.1.1.1.1" xref="S4.E8.m1.39.39.3.cmml"><msubsup id="S4.E8.m1.42.42.6.39.39.39.39.1.1.1.1.3" xref="S4.E8.m1.39.39.3.cmml"><mi id="S4.E8.m1.29.29.29.29.29.29" xref="S4.E8.m1.29.29.29.29.29.29.cmml">f</mi><mi id="S4.E8.m1.31.31.31.31.31.31.1" xref="S4.E8.m1.31.31.31.31.31.31.1.cmml">D</mi><msub id="S4.E8.m1.30.30.30.30.30.30.1" xref="S4.E8.m1.30.30.30.30.30.30.1.cmml"><mi id="S4.E8.m1.30.30.30.30.30.30.1.2" xref="S4.E8.m1.30.30.30.30.30.30.1.2.cmml">y</mi><mi id="S4.E8.m1.30.30.30.30.30.30.1.3" xref="S4.E8.m1.30.30.30.30.30.30.1.3.cmml">i</mi></msub></msubsup><mo lspace="0em" rspace="0em" id="S4.E8.m1.42.42.6.39.39.39.39.1.1.1.1.2" xref="S4.E8.m1.39.39.3a.cmml">​</mo><mrow id="S4.E8.m1.42.42.6.39.39.39.39.1.1.1.1.1.1" xref="S4.E8.m1.39.39.3.cmml"><mo stretchy="false" id="S4.E8.m1.32.32.32.32.32.32" xref="S4.E8.m1.39.39.3a.cmml">(</mo><msub id="S4.E8.m1.42.42.6.39.39.39.39.1.1.1.1.1.1.1" xref="S4.E8.m1.39.39.3.cmml"><mi id="S4.E8.m1.33.33.33.33.33.33" xref="S4.E8.m1.33.33.33.33.33.33.cmml">x</mi><mi id="S4.E8.m1.34.34.34.34.34.34.1" xref="S4.E8.m1.34.34.34.34.34.34.1.cmml">i</mi></msub><mo stretchy="false" id="S4.E8.m1.35.35.35.35.35.35" xref="S4.E8.m1.39.39.3a.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.E8.m1.36.36.36.36.36.36" xref="S4.E8.m1.39.39.3a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E8.m1.42b"><apply id="S4.E8.m1.39.39.3.cmml" xref="S4.E8.m1.42.42.6"><and id="S4.E8.m1.39.39.3a.cmml" xref="S4.E8.m1.40.40.4.37.37.37.37.2"></and><apply id="S4.E8.m1.39.39.3b.cmml" xref="S4.E8.m1.42.42.6"><eq id="S4.E8.m1.7.7.7.7.7.7.cmml" xref="S4.E8.m1.7.7.7.7.7.7"></eq><apply id="S4.E8.m1.37.37.1.1.cmml" xref="S4.E8.m1.42.42.6"><times id="S4.E8.m1.37.37.1.1.2.cmml" xref="S4.E8.m1.40.40.4.37.37.37.37.2"></times><apply id="S4.E8.m1.37.37.1.1.3.cmml" xref="S4.E8.m1.42.42.6"><csymbol cd="ambiguous" id="S4.E8.m1.37.37.1.1.3.1.cmml" xref="S4.E8.m1.40.40.4.37.37.37.37.2">superscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1">ℛ</ci><apply id="S4.E8.m1.2.2.2.2.2.2.1.cmml" xref="S4.E8.m1.2.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.2.2.2.1.1.cmml" xref="S4.E8.m1.2.2.2.2.2.2.1">subscript</csymbol><ci id="S4.E8.m1.2.2.2.2.2.2.1.2.cmml" xref="S4.E8.m1.2.2.2.2.2.2.1.2">𝑦</ci><ci id="S4.E8.m1.2.2.2.2.2.2.1.3.cmml" xref="S4.E8.m1.2.2.2.2.2.2.1.3">𝑖</ci></apply></apply><apply id="S4.E8.m1.37.37.1.1.1.1.1.cmml" xref="S4.E8.m1.42.42.6"><csymbol cd="ambiguous" id="S4.E8.m1.37.37.1.1.1.1.1.1.cmml" xref="S4.E8.m1.42.42.6">subscript</csymbol><ci id="S4.E8.m1.4.4.4.4.4.4.cmml" xref="S4.E8.m1.4.4.4.4.4.4">𝑥</ci><ci id="S4.E8.m1.5.5.5.5.5.5.1.cmml" xref="S4.E8.m1.5.5.5.5.5.5.1">𝑖</ci></apply></apply><apply id="S4.E8.m1.38.38.2.2.cmml" xref="S4.E8.m1.42.42.6"><minus id="S4.E8.m1.8.8.8.8.8.8.cmml" xref="S4.E8.m1.42.42.6"></minus><apply id="S4.E8.m1.38.38.2.2.1.cmml" xref="S4.E8.m1.42.42.6"><times id="S4.E8.m1.38.38.2.2.1.2.cmml" xref="S4.E8.m1.40.40.4.37.37.37.37.2"></times><apply id="S4.E8.m1.38.38.2.2.1.1.cmml" xref="S4.E8.m1.42.42.6"><ci id="S4.E8.m1.10.10.10.10.10.10.cmml" xref="S4.E8.m1.10.10.10.10.10.10">⋅</ci><apply id="S4.E8.m1.9.9.9.9.9.9.cmml" xref="S4.E8.m1.9.9.9.9.9.9"><ci id="S4.E8.m1.9.9.9.9.9.9.1.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1">^</ci><apply id="S4.E8.m1.9.9.9.9.9.9.2.cmml" xref="S4.E8.m1.9.9.9.9.9.9.2"><csymbol cd="ambiguous" id="S4.E8.m1.9.9.9.9.9.9.2.1.cmml" xref="S4.E8.m1.9.9.9.9.9.9.2">subscript</csymbol><ci id="S4.E8.m1.9.9.9.9.9.9.2.2.cmml" xref="S4.E8.m1.9.9.9.9.9.9.2.2">𝑦</ci><ci id="S4.E8.m1.9.9.9.9.9.9.2.3.cmml" xref="S4.E8.m1.9.9.9.9.9.9.2.3">𝑖</ci></apply></apply><apply id="S4.E8.m1.38.38.2.2.1.1.1.2.cmml" xref="S4.E8.m1.42.42.6"><log id="S4.E8.m1.11.11.11.11.11.11.cmml" xref="S4.E8.m1.11.11.11.11.11.11"></log><apply id="S4.E8.m1.38.38.2.2.1.1.1.1.1.1.cmml" xref="S4.E8.m1.42.42.6"><times id="S4.E8.m1.38.38.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.42.42.6"></times><ci id="S4.E8.m1.13.13.13.13.13.13.cmml" xref="S4.E8.m1.13.13.13.13.13.13">𝜎</ci><apply id="S4.E8.m1.38.38.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.42.42.6"><times id="S4.E8.m1.38.38.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.42.42.6"></times><apply id="S4.E8.m1.38.38.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.42.42.6"><csymbol cd="ambiguous" id="S4.E8.m1.38.38.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.42.42.6">superscript</csymbol><ci id="S4.E8.m1.15.15.15.15.15.15.cmml" xref="S4.E8.m1.15.15.15.15.15.15">𝑓</ci><apply id="S4.E8.m1.16.16.16.16.16.16.1.cmml" xref="S4.E8.m1.16.16.16.16.16.16.1"><csymbol cd="ambiguous" id="S4.E8.m1.16.16.16.16.16.16.1.1.cmml" xref="S4.E8.m1.16.16.16.16.16.16.1">subscript</csymbol><ci id="S4.E8.m1.16.16.16.16.16.16.1.2.cmml" xref="S4.E8.m1.16.16.16.16.16.16.1.2">𝑦</ci><ci id="S4.E8.m1.16.16.16.16.16.16.1.3.cmml" xref="S4.E8.m1.16.16.16.16.16.16.1.3">𝑖</ci></apply></apply><apply id="S4.E8.m1.38.38.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.42.42.6"><csymbol cd="ambiguous" id="S4.E8.m1.38.38.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.42.42.6">subscript</csymbol><ci id="S4.E8.m1.18.18.18.18.18.18.cmml" xref="S4.E8.m1.18.18.18.18.18.18">𝑥</ci><ci id="S4.E8.m1.19.19.19.19.19.19.1.cmml" xref="S4.E8.m1.19.19.19.19.19.19.1">𝑖</ci></apply></apply></apply></apply></apply><ci id="S4.E8.m1.23.23.23.23.23.23a.cmml" xref="S4.E8.m1.23.23.23.23.23.23"><mtext id="S4.E8.m1.23.23.23.23.23.23.cmml" xref="S4.E8.m1.23.23.23.23.23.23"> where </mtext></ci><apply id="S4.E8.m1.24.24.24.24.24.24.cmml" xref="S4.E8.m1.24.24.24.24.24.24"><ci id="S4.E8.m1.24.24.24.24.24.24.1.cmml" xref="S4.E8.m1.24.24.24.24.24.24.1">^</ci><apply id="S4.E8.m1.24.24.24.24.24.24.2.cmml" xref="S4.E8.m1.24.24.24.24.24.24.2"><csymbol cd="ambiguous" id="S4.E8.m1.24.24.24.24.24.24.2.1.cmml" xref="S4.E8.m1.24.24.24.24.24.24.2">subscript</csymbol><ci id="S4.E8.m1.24.24.24.24.24.24.2.2.cmml" xref="S4.E8.m1.24.24.24.24.24.24.2.2">𝑦</ci><ci id="S4.E8.m1.24.24.24.24.24.24.2.3.cmml" xref="S4.E8.m1.24.24.24.24.24.24.2.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S4.E8.m1.39.39.3c.cmml" xref="S4.E8.m1.42.42.6"><eq id="S4.E8.m1.25.25.25.25.25.25.cmml" xref="S4.E8.m1.25.25.25.25.25.25"></eq><share href="#S4.E8.m1.38.38.2.2.cmml" id="S4.E8.m1.39.39.3d.cmml" xref="S4.E8.m1.40.40.4.37.37.37.37.2"></share><apply id="S4.E8.m1.39.39.3.3.cmml" xref="S4.E8.m1.42.42.6"><times id="S4.E8.m1.39.39.3.3.2.cmml" xref="S4.E8.m1.40.40.4.37.37.37.37.2"></times><ci id="S4.E8.m1.26.26.26.26.26.26.cmml" xref="S4.E8.m1.26.26.26.26.26.26">𝜎</ci><apply id="S4.E8.m1.39.39.3.3.1.1.1.cmml" xref="S4.E8.m1.42.42.6"><minus id="S4.E8.m1.28.28.28.28.28.28.cmml" xref="S4.E8.m1.42.42.6"></minus><apply id="S4.E8.m1.39.39.3.3.1.1.1.1.cmml" xref="S4.E8.m1.42.42.6"><times id="S4.E8.m1.39.39.3.3.1.1.1.1.2.cmml" xref="S4.E8.m1.42.42.6"></times><apply id="S4.E8.m1.39.39.3.3.1.1.1.1.3.cmml" xref="S4.E8.m1.42.42.6"><csymbol cd="ambiguous" id="S4.E8.m1.39.39.3.3.1.1.1.1.3.1.cmml" xref="S4.E8.m1.42.42.6">subscript</csymbol><apply id="S4.E8.m1.39.39.3.3.1.1.1.1.3.2.cmml" xref="S4.E8.m1.42.42.6"><csymbol cd="ambiguous" id="S4.E8.m1.39.39.3.3.1.1.1.1.3.2.1.cmml" xref="S4.E8.m1.42.42.6">superscript</csymbol><ci id="S4.E8.m1.29.29.29.29.29.29.cmml" xref="S4.E8.m1.29.29.29.29.29.29">𝑓</ci><apply id="S4.E8.m1.30.30.30.30.30.30.1.cmml" xref="S4.E8.m1.30.30.30.30.30.30.1"><csymbol cd="ambiguous" id="S4.E8.m1.30.30.30.30.30.30.1.1.cmml" xref="S4.E8.m1.30.30.30.30.30.30.1">subscript</csymbol><ci id="S4.E8.m1.30.30.30.30.30.30.1.2.cmml" xref="S4.E8.m1.30.30.30.30.30.30.1.2">𝑦</ci><ci id="S4.E8.m1.30.30.30.30.30.30.1.3.cmml" xref="S4.E8.m1.30.30.30.30.30.30.1.3">𝑖</ci></apply></apply><ci id="S4.E8.m1.31.31.31.31.31.31.1.cmml" xref="S4.E8.m1.31.31.31.31.31.31.1">𝐷</ci></apply><apply id="S4.E8.m1.39.39.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.42.42.6"><csymbol cd="ambiguous" id="S4.E8.m1.39.39.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.42.42.6">subscript</csymbol><ci id="S4.E8.m1.33.33.33.33.33.33.cmml" xref="S4.E8.m1.33.33.33.33.33.33">𝑥</ci><ci id="S4.E8.m1.34.34.34.34.34.34.1.cmml" xref="S4.E8.m1.34.34.34.34.34.34.1">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.42c">\mathcal{R}^{y_{i}}(x_{i})=-\hat{y_{i}}\cdot\log(\sigma(f^{y_{i}}(x_{i})))\text{ where }\hat{y_{i}}=\sigma(-f^{y_{i}}_{D}(x_{i}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.2" class="ltx_p">We derive the reverse direction of the drift by taking the negative form of the estimated drift <math id="S4.SS2.p1.2.m1.1" class="ltx_Math" alttext="f^{y_{i}}_{D}(x_{i})" display="inline"><semantics id="S4.SS2.p1.2.m1.1a"><mrow id="S4.SS2.p1.2.m1.1.1" xref="S4.SS2.p1.2.m1.1.1.cmml"><msubsup id="S4.SS2.p1.2.m1.1.1.3" xref="S4.SS2.p1.2.m1.1.1.3.cmml"><mi id="S4.SS2.p1.2.m1.1.1.3.2.2" xref="S4.SS2.p1.2.m1.1.1.3.2.2.cmml">f</mi><mi id="S4.SS2.p1.2.m1.1.1.3.3" xref="S4.SS2.p1.2.m1.1.1.3.3.cmml">D</mi><msub id="S4.SS2.p1.2.m1.1.1.3.2.3" xref="S4.SS2.p1.2.m1.1.1.3.2.3.cmml"><mi id="S4.SS2.p1.2.m1.1.1.3.2.3.2" xref="S4.SS2.p1.2.m1.1.1.3.2.3.2.cmml">y</mi><mi id="S4.SS2.p1.2.m1.1.1.3.2.3.3" xref="S4.SS2.p1.2.m1.1.1.3.2.3.3.cmml">i</mi></msub></msubsup><mo lspace="0em" rspace="0em" id="S4.SS2.p1.2.m1.1.1.2" xref="S4.SS2.p1.2.m1.1.1.2.cmml">​</mo><mrow id="S4.SS2.p1.2.m1.1.1.1.1" xref="S4.SS2.p1.2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.2.m1.1.1.1.1.2" xref="S4.SS2.p1.2.m1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS2.p1.2.m1.1.1.1.1.1" xref="S4.SS2.p1.2.m1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.2.m1.1.1.1.1.1.2" xref="S4.SS2.p1.2.m1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.SS2.p1.2.m1.1.1.1.1.1.3" xref="S4.SS2.p1.2.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS2.p1.2.m1.1.1.1.1.3" xref="S4.SS2.p1.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m1.1b"><apply id="S4.SS2.p1.2.m1.1.1.cmml" xref="S4.SS2.p1.2.m1.1.1"><times id="S4.SS2.p1.2.m1.1.1.2.cmml" xref="S4.SS2.p1.2.m1.1.1.2"></times><apply id="S4.SS2.p1.2.m1.1.1.3.cmml" xref="S4.SS2.p1.2.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.1.1.3.1.cmml" xref="S4.SS2.p1.2.m1.1.1.3">subscript</csymbol><apply id="S4.SS2.p1.2.m1.1.1.3.2.cmml" xref="S4.SS2.p1.2.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.1.1.3.2.1.cmml" xref="S4.SS2.p1.2.m1.1.1.3">superscript</csymbol><ci id="S4.SS2.p1.2.m1.1.1.3.2.2.cmml" xref="S4.SS2.p1.2.m1.1.1.3.2.2">𝑓</ci><apply id="S4.SS2.p1.2.m1.1.1.3.2.3.cmml" xref="S4.SS2.p1.2.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.1.1.3.2.3.1.cmml" xref="S4.SS2.p1.2.m1.1.1.3.2.3">subscript</csymbol><ci id="S4.SS2.p1.2.m1.1.1.3.2.3.2.cmml" xref="S4.SS2.p1.2.m1.1.1.3.2.3.2">𝑦</ci><ci id="S4.SS2.p1.2.m1.1.1.3.2.3.3.cmml" xref="S4.SS2.p1.2.m1.1.1.3.2.3.3">𝑖</ci></apply></apply><ci id="S4.SS2.p1.2.m1.1.1.3.3.cmml" xref="S4.SS2.p1.2.m1.1.1.3.3">𝐷</ci></apply><apply id="S4.SS2.p1.2.m1.1.1.1.1.1.cmml" xref="S4.SS2.p1.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.2.m1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.2.m1.1.1.1.1.1.2">𝑥</ci><ci id="S4.SS2.p1.2.m1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.2.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m1.1c">f^{y_{i}}_{D}(x_{i})</annotation></semantics></math> and normalizing it by the softmax function. With this regularization, the local objective of each client can be formulated as:</p>
<table id="S4.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E9.m1.8" class="ltx_Math" alttext="\mathcal{L}(\mathcal{D},\omega)=-\sum_{(x,y)\in\mathcal{D}_{k}}\sum_{i=1}^{|\mathcal{Y}|}(y_{i}\log\sigma(f^{y_{i}}(x))+\mathcal{R}^{y_{i}}(x))" display="block"><semantics id="S4.E9.m1.8a"><mrow id="S4.E9.m1.8.8" xref="S4.E9.m1.8.8.cmml"><mrow id="S4.E9.m1.8.8.3" xref="S4.E9.m1.8.8.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.8.8.3.2" xref="S4.E9.m1.8.8.3.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.8.8.3.1" xref="S4.E9.m1.8.8.3.1.cmml">​</mo><mrow id="S4.E9.m1.8.8.3.3.2" xref="S4.E9.m1.8.8.3.3.1.cmml"><mo stretchy="false" id="S4.E9.m1.8.8.3.3.2.1" xref="S4.E9.m1.8.8.3.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.4.4" xref="S4.E9.m1.4.4.cmml">𝒟</mi><mo id="S4.E9.m1.8.8.3.3.2.2" xref="S4.E9.m1.8.8.3.3.1.cmml">,</mo><mi id="S4.E9.m1.5.5" xref="S4.E9.m1.5.5.cmml">ω</mi><mo stretchy="false" id="S4.E9.m1.8.8.3.3.2.3" xref="S4.E9.m1.8.8.3.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.8.8.2" xref="S4.E9.m1.8.8.2.cmml">=</mo><mrow id="S4.E9.m1.8.8.1" xref="S4.E9.m1.8.8.1.cmml"><mo id="S4.E9.m1.8.8.1a" xref="S4.E9.m1.8.8.1.cmml">−</mo><mrow id="S4.E9.m1.8.8.1.1" xref="S4.E9.m1.8.8.1.1.cmml"><munder id="S4.E9.m1.8.8.1.1.2" xref="S4.E9.m1.8.8.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S4.E9.m1.8.8.1.1.2.2" xref="S4.E9.m1.8.8.1.1.2.2.cmml">∑</mo><mrow id="S4.E9.m1.2.2.2" xref="S4.E9.m1.2.2.2.cmml"><mrow id="S4.E9.m1.2.2.2.4.2" xref="S4.E9.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S4.E9.m1.2.2.2.4.2.1" xref="S4.E9.m1.2.2.2.4.1.cmml">(</mo><mi id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml">x</mi><mo id="S4.E9.m1.2.2.2.4.2.2" xref="S4.E9.m1.2.2.2.4.1.cmml">,</mo><mi id="S4.E9.m1.2.2.2.2" xref="S4.E9.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S4.E9.m1.2.2.2.4.2.3" xref="S4.E9.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S4.E9.m1.2.2.2.3" xref="S4.E9.m1.2.2.2.3.cmml">∈</mo><msub id="S4.E9.m1.2.2.2.5" xref="S4.E9.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.2.2.2.5.2" xref="S4.E9.m1.2.2.2.5.2.cmml">𝒟</mi><mi id="S4.E9.m1.2.2.2.5.3" xref="S4.E9.m1.2.2.2.5.3.cmml">k</mi></msub></mrow></munder><mrow id="S4.E9.m1.8.8.1.1.1" xref="S4.E9.m1.8.8.1.1.1.cmml"><munderover id="S4.E9.m1.8.8.1.1.1.2" xref="S4.E9.m1.8.8.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S4.E9.m1.8.8.1.1.1.2.2.2" xref="S4.E9.m1.8.8.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E9.m1.8.8.1.1.1.2.2.3" xref="S4.E9.m1.8.8.1.1.1.2.2.3.cmml"><mi id="S4.E9.m1.8.8.1.1.1.2.2.3.2" xref="S4.E9.m1.8.8.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E9.m1.8.8.1.1.1.2.2.3.1" xref="S4.E9.m1.8.8.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E9.m1.8.8.1.1.1.2.2.3.3" xref="S4.E9.m1.8.8.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S4.E9.m1.3.3.1.3" xref="S4.E9.m1.3.3.1.2.cmml"><mo stretchy="false" id="S4.E9.m1.3.3.1.3.1" xref="S4.E9.m1.3.3.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.3.3.1.1" xref="S4.E9.m1.3.3.1.1.cmml">𝒴</mi><mo stretchy="false" id="S4.E9.m1.3.3.1.3.2" xref="S4.E9.m1.3.3.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S4.E9.m1.8.8.1.1.1.1.1" xref="S4.E9.m1.8.8.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E9.m1.8.8.1.1.1.1.1.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.8.8.1.1.1.1.1.1" xref="S4.E9.m1.8.8.1.1.1.1.1.1.cmml"><mrow id="S4.E9.m1.8.8.1.1.1.1.1.1.1" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.cmml"><msub id="S4.E9.m1.8.8.1.1.1.1.1.1.1.3" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E9.m1.8.8.1.1.1.1.1.1.1.3.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="S4.E9.m1.8.8.1.1.1.1.1.1.1.3.3" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S4.E9.m1.8.8.1.1.1.1.1.1.1.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E9.m1.8.8.1.1.1.1.1.1.1.4" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.4.cmml"><mi id="S4.E9.m1.8.8.1.1.1.1.1.1.1.4.1" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.4.1.cmml">log</mi><mo lspace="0.167em" id="S4.E9.m1.8.8.1.1.1.1.1.1.1.4a" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.4.cmml">⁡</mo><mi id="S4.E9.m1.8.8.1.1.1.1.1.1.1.4.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.4.2.cmml">σ</mi></mrow><mo lspace="0em" rspace="0em" id="S4.E9.m1.8.8.1.1.1.1.1.1.1.2a" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml"><msup id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><msub id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">y</mi><mi id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub></msup><mo lspace="0em" rspace="0em" id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E9.m1.6.6" xref="S4.E9.m1.6.6.cmml">x</mi><mo stretchy="false" id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.8.8.1.1.1.1.1.1.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S4.E9.m1.8.8.1.1.1.1.1.1.3" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.cmml"><msup id="S4.E9.m1.8.8.1.1.1.1.1.1.3.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.2.cmml">ℛ</mi><msub id="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.3" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.3.cmml"><mi id="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.3.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.3.2.cmml">y</mi><mi id="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.3.3" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.3.3.cmml">i</mi></msub></msup><mo lspace="0em" rspace="0em" id="S4.E9.m1.8.8.1.1.1.1.1.1.3.1" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S4.E9.m1.8.8.1.1.1.1.1.1.3.3.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.E9.m1.8.8.1.1.1.1.1.1.3.3.2.1" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.cmml">(</mo><mi id="S4.E9.m1.7.7" xref="S4.E9.m1.7.7.cmml">x</mi><mo stretchy="false" id="S4.E9.m1.8.8.1.1.1.1.1.1.3.3.2.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.E9.m1.8.8.1.1.1.1.1.3" xref="S4.E9.m1.8.8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.8b"><apply id="S4.E9.m1.8.8.cmml" xref="S4.E9.m1.8.8"><eq id="S4.E9.m1.8.8.2.cmml" xref="S4.E9.m1.8.8.2"></eq><apply id="S4.E9.m1.8.8.3.cmml" xref="S4.E9.m1.8.8.3"><times id="S4.E9.m1.8.8.3.1.cmml" xref="S4.E9.m1.8.8.3.1"></times><ci id="S4.E9.m1.8.8.3.2.cmml" xref="S4.E9.m1.8.8.3.2">ℒ</ci><interval closure="open" id="S4.E9.m1.8.8.3.3.1.cmml" xref="S4.E9.m1.8.8.3.3.2"><ci id="S4.E9.m1.4.4.cmml" xref="S4.E9.m1.4.4">𝒟</ci><ci id="S4.E9.m1.5.5.cmml" xref="S4.E9.m1.5.5">𝜔</ci></interval></apply><apply id="S4.E9.m1.8.8.1.cmml" xref="S4.E9.m1.8.8.1"><minus id="S4.E9.m1.8.8.1.2.cmml" xref="S4.E9.m1.8.8.1"></minus><apply id="S4.E9.m1.8.8.1.1.cmml" xref="S4.E9.m1.8.8.1.1"><apply id="S4.E9.m1.8.8.1.1.2.cmml" xref="S4.E9.m1.8.8.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.1.1.2.1.cmml" xref="S4.E9.m1.8.8.1.1.2">subscript</csymbol><sum id="S4.E9.m1.8.8.1.1.2.2.cmml" xref="S4.E9.m1.8.8.1.1.2.2"></sum><apply id="S4.E9.m1.2.2.2.cmml" xref="S4.E9.m1.2.2.2"><in id="S4.E9.m1.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.3"></in><interval closure="open" id="S4.E9.m1.2.2.2.4.1.cmml" xref="S4.E9.m1.2.2.2.4.2"><ci id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1">𝑥</ci><ci id="S4.E9.m1.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2">𝑦</ci></interval><apply id="S4.E9.m1.2.2.2.5.cmml" xref="S4.E9.m1.2.2.2.5"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.5.1.cmml" xref="S4.E9.m1.2.2.2.5">subscript</csymbol><ci id="S4.E9.m1.2.2.2.5.2.cmml" xref="S4.E9.m1.2.2.2.5.2">𝒟</ci><ci id="S4.E9.m1.2.2.2.5.3.cmml" xref="S4.E9.m1.2.2.2.5.3">𝑘</ci></apply></apply></apply><apply id="S4.E9.m1.8.8.1.1.1.cmml" xref="S4.E9.m1.8.8.1.1.1"><apply id="S4.E9.m1.8.8.1.1.1.2.cmml" xref="S4.E9.m1.8.8.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.1.1.1.2.1.cmml" xref="S4.E9.m1.8.8.1.1.1.2">superscript</csymbol><apply id="S4.E9.m1.8.8.1.1.1.2.2.cmml" xref="S4.E9.m1.8.8.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.1.1.1.2.2.1.cmml" xref="S4.E9.m1.8.8.1.1.1.2">subscript</csymbol><sum id="S4.E9.m1.8.8.1.1.1.2.2.2.cmml" xref="S4.E9.m1.8.8.1.1.1.2.2.2"></sum><apply id="S4.E9.m1.8.8.1.1.1.2.2.3.cmml" xref="S4.E9.m1.8.8.1.1.1.2.2.3"><eq id="S4.E9.m1.8.8.1.1.1.2.2.3.1.cmml" xref="S4.E9.m1.8.8.1.1.1.2.2.3.1"></eq><ci id="S4.E9.m1.8.8.1.1.1.2.2.3.2.cmml" xref="S4.E9.m1.8.8.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S4.E9.m1.8.8.1.1.1.2.2.3.3.cmml" xref="S4.E9.m1.8.8.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S4.E9.m1.3.3.1.2.cmml" xref="S4.E9.m1.3.3.1.3"><abs id="S4.E9.m1.3.3.1.2.1.cmml" xref="S4.E9.m1.3.3.1.3.1"></abs><ci id="S4.E9.m1.3.3.1.1.cmml" xref="S4.E9.m1.3.3.1.1">𝒴</ci></apply></apply><apply id="S4.E9.m1.8.8.1.1.1.1.1.1.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1"><plus id="S4.E9.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.2"></plus><apply id="S4.E9.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1"><times id="S4.E9.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.2"></times><apply id="S4.E9.m1.8.8.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.8.8.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S4.E9.m1.8.8.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S4.E9.m1.8.8.1.1.1.1.1.1.1.4.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.4"><log id="S4.E9.m1.8.8.1.1.1.1.1.1.1.4.1.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.4.1"></log><ci id="S4.E9.m1.8.8.1.1.1.1.1.1.1.4.2.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.4.2">𝜎</ci></apply><apply id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1"><times id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2">𝑓</ci><apply id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑦</ci><ci id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S4.E9.m1.6.6.cmml" xref="S4.E9.m1.6.6">𝑥</ci></apply></apply><apply id="S4.E9.m1.8.8.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3"><times id="S4.E9.m1.8.8.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.1"></times><apply id="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.2">ℛ</ci><apply id="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.3.1.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.3.2.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.3.2">𝑦</ci><ci id="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.3.3.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.3.3">𝑖</ci></apply></apply><ci id="S4.E9.m1.7.7.cmml" xref="S4.E9.m1.7.7">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.8c">\mathcal{L}(\mathcal{D},\omega)=-\sum_{(x,y)\in\mathcal{D}_{k}}\sum_{i=1}^{|\mathcal{Y}|}(y_{i}\log\sigma(f^{y_{i}}(x))+\mathcal{R}^{y_{i}}(x))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.3" class="ltx_p">where the first term is the cross-entropy with the ground-truth label, and the second term is the regularization with the auxiliary label. As the auxiliary label <math id="S4.SS2.p1.3.m1.1" class="ltx_Math" alttext="\hat{y_{i}}" display="inline"><semantics id="S4.SS2.p1.3.m1.1a"><mover accent="true" id="S4.SS2.p1.3.m1.1.1" xref="S4.SS2.p1.3.m1.1.1.cmml"><msub id="S4.SS2.p1.3.m1.1.1.2" xref="S4.SS2.p1.3.m1.1.1.2.cmml"><mi id="S4.SS2.p1.3.m1.1.1.2.2" xref="S4.SS2.p1.3.m1.1.1.2.2.cmml">y</mi><mi id="S4.SS2.p1.3.m1.1.1.2.3" xref="S4.SS2.p1.3.m1.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS2.p1.3.m1.1.1.1" xref="S4.SS2.p1.3.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m1.1b"><apply id="S4.SS2.p1.3.m1.1.1.cmml" xref="S4.SS2.p1.3.m1.1.1"><ci id="S4.SS2.p1.3.m1.1.1.1.cmml" xref="S4.SS2.p1.3.m1.1.1.1">^</ci><apply id="S4.SS2.p1.3.m1.1.1.2.cmml" xref="S4.SS2.p1.3.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m1.1.1.2.1.cmml" xref="S4.SS2.p1.3.m1.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.3.m1.1.1.2.2.cmml" xref="S4.SS2.p1.3.m1.1.1.2.2">𝑦</ci><ci id="S4.SS2.p1.3.m1.1.1.2.3.cmml" xref="S4.SS2.p1.3.m1.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m1.1c">\hat{y_{i}}</annotation></semantics></math> includes the supervision for every class compared to the ground-truth, the objective can be decomposed according to the ground-truth and others.</p>
<table id="S4.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E10.m1.6" class="ltx_Math" alttext="\mathcal{L}(x,\omega)=\begin{cases}-(1+\hat{y_{i}})\cdot\log\sigma(f^{y_{i}}(x))&amp;\text{ if }y_{i}=1\\
-\hat{y_{i}}\cdot\log\sigma(f^{y_{i}}(x))&amp;\text{otherwise.}\end{cases}" display="block"><semantics id="S4.E10.m1.6a"><mrow id="S4.E10.m1.6.7" xref="S4.E10.m1.6.7.cmml"><mrow id="S4.E10.m1.6.7.2" xref="S4.E10.m1.6.7.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.6.7.2.2" xref="S4.E10.m1.6.7.2.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.6.7.2.1" xref="S4.E10.m1.6.7.2.1.cmml">​</mo><mrow id="S4.E10.m1.6.7.2.3.2" xref="S4.E10.m1.6.7.2.3.1.cmml"><mo stretchy="false" id="S4.E10.m1.6.7.2.3.2.1" xref="S4.E10.m1.6.7.2.3.1.cmml">(</mo><mi id="S4.E10.m1.5.5" xref="S4.E10.m1.5.5.cmml">x</mi><mo id="S4.E10.m1.6.7.2.3.2.2" xref="S4.E10.m1.6.7.2.3.1.cmml">,</mo><mi id="S4.E10.m1.6.6" xref="S4.E10.m1.6.6.cmml">ω</mi><mo stretchy="false" id="S4.E10.m1.6.7.2.3.2.3" xref="S4.E10.m1.6.7.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.6.7.1" xref="S4.E10.m1.6.7.1.cmml">=</mo><mrow id="S4.E10.m1.4.4" xref="S4.E10.m1.6.7.3.1.cmml"><mo id="S4.E10.m1.4.4.5" xref="S4.E10.m1.6.7.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S4.E10.m1.4.4.4" xref="S4.E10.m1.6.7.3.1.cmml"><mtr id="S4.E10.m1.4.4.4a" xref="S4.E10.m1.6.7.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E10.m1.4.4.4b" xref="S4.E10.m1.6.7.3.1.cmml"><mrow id="S4.E10.m1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.cmml"><mo id="S4.E10.m1.1.1.1.1.1.1a" xref="S4.E10.m1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E10.m1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.3.cmml"><mrow id="S4.E10.m1.1.1.1.1.1.1.2.1" xref="S4.E10.m1.1.1.1.1.1.1.2.1.cmml"><mrow id="S4.E10.m1.1.1.1.1.1.1.2.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.cmml"><mn id="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.2.cmml">1</mn><mo id="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.1.cmml">+</mo><mover accent="true" id="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3.cmml"><msub id="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3.2" xref="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3.2.cmml"><mi id="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3.2.2" xref="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3.2.2.cmml">y</mi><mi id="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3.2.3" xref="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3.2.3.cmml">i</mi></msub><mo id="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3.1" xref="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3.1.cmml">^</mo></mover></mrow><mo rspace="0.055em" stretchy="false" id="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S4.E10.m1.1.1.1.1.1.1.2.1.2" xref="S4.E10.m1.1.1.1.1.1.1.2.1.2.cmml">⋅</mo><mrow id="S4.E10.m1.1.1.1.1.1.1.2.1.3" xref="S4.E10.m1.1.1.1.1.1.1.2.1.3.cmml"><mi id="S4.E10.m1.1.1.1.1.1.1.2.1.3.1" xref="S4.E10.m1.1.1.1.1.1.1.2.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.E10.m1.1.1.1.1.1.1.2.1.3a" xref="S4.E10.m1.1.1.1.1.1.1.2.1.3.cmml">⁡</mo><mi id="S4.E10.m1.1.1.1.1.1.1.2.1.3.2" xref="S4.E10.m1.1.1.1.1.1.1.2.1.3.2.cmml">σ</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S4.E10.m1.1.1.1.1.1.1.3.3" xref="S4.E10.m1.1.1.1.1.1.1.3.3.cmml">​</mo><mrow id="S4.E10.m1.1.1.1.1.1.1.3.2.1" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.cmml"><mo stretchy="false" id="S4.E10.m1.1.1.1.1.1.1.3.2.1.2" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.cmml">(</mo><mrow id="S4.E10.m1.1.1.1.1.1.1.3.2.1.1" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.cmml"><msup id="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.cmml"><mi id="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.2" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.2.cmml">f</mi><msub id="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.3" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.3.cmml"><mi id="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.3.2" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.3.2.cmml">y</mi><mi id="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.3.3" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.3.3.cmml">i</mi></msub></msup><mo lspace="0em" rspace="0em" id="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.1.cmml">​</mo><mrow id="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.3.2" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.cmml"><mo stretchy="false" id="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.3.2.1" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.cmml">(</mo><mi id="S4.E10.m1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.cmml">x</mi><mo stretchy="false" id="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.3.2.2" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E10.m1.1.1.1.1.1.1.3.2.1.3" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.cmml">)</mo></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E10.m1.4.4.4c" xref="S4.E10.m1.6.7.3.1.cmml"><mrow id="S4.E10.m1.2.2.2.2.2.1" xref="S4.E10.m1.2.2.2.2.2.1.cmml"><mrow id="S4.E10.m1.2.2.2.2.2.1.2" xref="S4.E10.m1.2.2.2.2.2.1.2.cmml"><mtext id="S4.E10.m1.2.2.2.2.2.1.2.2" xref="S4.E10.m1.2.2.2.2.2.1.2.2a.cmml"> if </mtext><mo lspace="0em" rspace="0em" id="S4.E10.m1.2.2.2.2.2.1.2.1" xref="S4.E10.m1.2.2.2.2.2.1.2.1.cmml">​</mo><msub id="S4.E10.m1.2.2.2.2.2.1.2.3" xref="S4.E10.m1.2.2.2.2.2.1.2.3.cmml"><mi id="S4.E10.m1.2.2.2.2.2.1.2.3.2" xref="S4.E10.m1.2.2.2.2.2.1.2.3.2.cmml">y</mi><mi id="S4.E10.m1.2.2.2.2.2.1.2.3.3" xref="S4.E10.m1.2.2.2.2.2.1.2.3.3.cmml">i</mi></msub></mrow><mo id="S4.E10.m1.2.2.2.2.2.1.1" xref="S4.E10.m1.2.2.2.2.2.1.1.cmml">=</mo><mn id="S4.E10.m1.2.2.2.2.2.1.3" xref="S4.E10.m1.2.2.2.2.2.1.3.cmml">1</mn></mrow></mtd></mtr><mtr id="S4.E10.m1.4.4.4d" xref="S4.E10.m1.6.7.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E10.m1.4.4.4e" xref="S4.E10.m1.6.7.3.1.cmml"><mrow id="S4.E10.m1.3.3.3.3.1.1" xref="S4.E10.m1.3.3.3.3.1.1.cmml"><mo id="S4.E10.m1.3.3.3.3.1.1a" xref="S4.E10.m1.3.3.3.3.1.1.cmml">−</mo><mrow id="S4.E10.m1.3.3.3.3.1.1.2" xref="S4.E10.m1.3.3.3.3.1.1.2.cmml"><mrow id="S4.E10.m1.3.3.3.3.1.1.2.3" xref="S4.E10.m1.3.3.3.3.1.1.2.3.cmml"><mover accent="true" id="S4.E10.m1.3.3.3.3.1.1.2.3.2" xref="S4.E10.m1.3.3.3.3.1.1.2.3.2.cmml"><msub id="S4.E10.m1.3.3.3.3.1.1.2.3.2.2" xref="S4.E10.m1.3.3.3.3.1.1.2.3.2.2.cmml"><mi id="S4.E10.m1.3.3.3.3.1.1.2.3.2.2.2" xref="S4.E10.m1.3.3.3.3.1.1.2.3.2.2.2.cmml">y</mi><mi id="S4.E10.m1.3.3.3.3.1.1.2.3.2.2.3" xref="S4.E10.m1.3.3.3.3.1.1.2.3.2.2.3.cmml">i</mi></msub><mo id="S4.E10.m1.3.3.3.3.1.1.2.3.2.1" xref="S4.E10.m1.3.3.3.3.1.1.2.3.2.1.cmml">^</mo></mover><mo lspace="0.222em" rspace="0.222em" id="S4.E10.m1.3.3.3.3.1.1.2.3.1" xref="S4.E10.m1.3.3.3.3.1.1.2.3.1.cmml">⋅</mo><mrow id="S4.E10.m1.3.3.3.3.1.1.2.3.3" xref="S4.E10.m1.3.3.3.3.1.1.2.3.3.cmml"><mi id="S4.E10.m1.3.3.3.3.1.1.2.3.3.1" xref="S4.E10.m1.3.3.3.3.1.1.2.3.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.E10.m1.3.3.3.3.1.1.2.3.3a" xref="S4.E10.m1.3.3.3.3.1.1.2.3.3.cmml">⁡</mo><mi id="S4.E10.m1.3.3.3.3.1.1.2.3.3.2" xref="S4.E10.m1.3.3.3.3.1.1.2.3.3.2.cmml">σ</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S4.E10.m1.3.3.3.3.1.1.2.2" xref="S4.E10.m1.3.3.3.3.1.1.2.2.cmml">​</mo><mrow id="S4.E10.m1.3.3.3.3.1.1.2.1.1" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S4.E10.m1.3.3.3.3.1.1.2.1.1.2" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.cmml">(</mo><mrow id="S4.E10.m1.3.3.3.3.1.1.2.1.1.1" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.cmml"><msup id="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.cmml"><mi id="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.2" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.2.cmml">f</mi><msub id="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.3" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.3.cmml"><mi id="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.3.2" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.3.2.cmml">y</mi><mi id="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.3.3" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.3.3.cmml">i</mi></msub></msup><mo lspace="0em" rspace="0em" id="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.1" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.1.cmml">​</mo><mrow id="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.3.2" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.3.2.1" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.cmml">(</mo><mi id="S4.E10.m1.3.3.3.3.1.1.1" xref="S4.E10.m1.3.3.3.3.1.1.1.cmml">x</mi><mo stretchy="false" id="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.3.2.2" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E10.m1.3.3.3.3.1.1.2.1.1.3" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E10.m1.4.4.4f" xref="S4.E10.m1.6.7.3.1.cmml"><mtext id="S4.E10.m1.4.4.4.4.2.1" xref="S4.E10.m1.4.4.4.4.2.1a.cmml">otherwise.</mtext></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.6b"><apply id="S4.E10.m1.6.7.cmml" xref="S4.E10.m1.6.7"><eq id="S4.E10.m1.6.7.1.cmml" xref="S4.E10.m1.6.7.1"></eq><apply id="S4.E10.m1.6.7.2.cmml" xref="S4.E10.m1.6.7.2"><times id="S4.E10.m1.6.7.2.1.cmml" xref="S4.E10.m1.6.7.2.1"></times><ci id="S4.E10.m1.6.7.2.2.cmml" xref="S4.E10.m1.6.7.2.2">ℒ</ci><interval closure="open" id="S4.E10.m1.6.7.2.3.1.cmml" xref="S4.E10.m1.6.7.2.3.2"><ci id="S4.E10.m1.5.5.cmml" xref="S4.E10.m1.5.5">𝑥</ci><ci id="S4.E10.m1.6.6.cmml" xref="S4.E10.m1.6.6">𝜔</ci></interval></apply><apply id="S4.E10.m1.6.7.3.1.cmml" xref="S4.E10.m1.4.4"><csymbol cd="latexml" id="S4.E10.m1.6.7.3.1.1.cmml" xref="S4.E10.m1.4.4.5">cases</csymbol><apply id="S4.E10.m1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1"><minus id="S4.E10.m1.1.1.1.1.1.1.4.cmml" xref="S4.E10.m1.1.1.1.1.1.1"></minus><apply id="S4.E10.m1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3"><times id="S4.E10.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.3"></times><apply id="S4.E10.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2.1"><ci id="S4.E10.m1.1.1.1.1.1.1.2.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2.1.2">⋅</ci><apply id="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2.1.1.1"><plus id="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.1"></plus><cn type="integer" id="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.2">1</cn><apply id="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3"><ci id="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3.1">^</ci><apply id="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3.2.2">𝑦</ci><ci id="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3.2.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2.1.1.1.1.3.2.3">𝑖</ci></apply></apply></apply><apply id="S4.E10.m1.1.1.1.1.1.1.2.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2.1.3"><log id="S4.E10.m1.1.1.1.1.1.1.2.1.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2.1.3.1"></log><ci id="S4.E10.m1.1.1.1.1.1.1.2.1.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2.1.3.2">𝜎</ci></apply></apply><apply id="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1"><times id="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.1"></times><apply id="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2">superscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.2">𝑓</ci><apply id="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.3">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.3.2">𝑦</ci><ci id="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.3.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.2.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S4.E10.m1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1">𝑥</ci></apply></apply></apply><apply id="S4.E10.m1.2.2.2.2.2.1.cmml" xref="S4.E10.m1.2.2.2.2.2.1"><eq id="S4.E10.m1.2.2.2.2.2.1.1.cmml" xref="S4.E10.m1.2.2.2.2.2.1.1"></eq><apply id="S4.E10.m1.2.2.2.2.2.1.2.cmml" xref="S4.E10.m1.2.2.2.2.2.1.2"><times id="S4.E10.m1.2.2.2.2.2.1.2.1.cmml" xref="S4.E10.m1.2.2.2.2.2.1.2.1"></times><ci id="S4.E10.m1.2.2.2.2.2.1.2.2a.cmml" xref="S4.E10.m1.2.2.2.2.2.1.2.2"><mtext id="S4.E10.m1.2.2.2.2.2.1.2.2.cmml" xref="S4.E10.m1.2.2.2.2.2.1.2.2"> if </mtext></ci><apply id="S4.E10.m1.2.2.2.2.2.1.2.3.cmml" xref="S4.E10.m1.2.2.2.2.2.1.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.2.2.2.1.2.3.1.cmml" xref="S4.E10.m1.2.2.2.2.2.1.2.3">subscript</csymbol><ci id="S4.E10.m1.2.2.2.2.2.1.2.3.2.cmml" xref="S4.E10.m1.2.2.2.2.2.1.2.3.2">𝑦</ci><ci id="S4.E10.m1.2.2.2.2.2.1.2.3.3.cmml" xref="S4.E10.m1.2.2.2.2.2.1.2.3.3">𝑖</ci></apply></apply><cn type="integer" id="S4.E10.m1.2.2.2.2.2.1.3.cmml" xref="S4.E10.m1.2.2.2.2.2.1.3">1</cn></apply><apply id="S4.E10.m1.3.3.3.3.1.1.cmml" xref="S4.E10.m1.3.3.3.3.1.1"><minus id="S4.E10.m1.3.3.3.3.1.1.3.cmml" xref="S4.E10.m1.3.3.3.3.1.1"></minus><apply id="S4.E10.m1.3.3.3.3.1.1.2.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2"><times id="S4.E10.m1.3.3.3.3.1.1.2.2.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.2"></times><apply id="S4.E10.m1.3.3.3.3.1.1.2.3.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.3"><ci id="S4.E10.m1.3.3.3.3.1.1.2.3.1.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.3.1">⋅</ci><apply id="S4.E10.m1.3.3.3.3.1.1.2.3.2.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.3.2"><ci id="S4.E10.m1.3.3.3.3.1.1.2.3.2.1.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.3.2.1">^</ci><apply id="S4.E10.m1.3.3.3.3.1.1.2.3.2.2.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.3.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.3.3.1.1.2.3.2.2.1.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.3.2.2">subscript</csymbol><ci id="S4.E10.m1.3.3.3.3.1.1.2.3.2.2.2.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.3.2.2.2">𝑦</ci><ci id="S4.E10.m1.3.3.3.3.1.1.2.3.2.2.3.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.3.2.2.3">𝑖</ci></apply></apply><apply id="S4.E10.m1.3.3.3.3.1.1.2.3.3.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.3.3"><log id="S4.E10.m1.3.3.3.3.1.1.2.3.3.1.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.3.3.1"></log><ci id="S4.E10.m1.3.3.3.3.1.1.2.3.3.2.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.3.3.2">𝜎</ci></apply></apply><apply id="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1"><times id="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.1.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.1"></times><apply id="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.1.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2">superscript</csymbol><ci id="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.2.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.2">𝑓</ci><apply id="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.3.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.3.1.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.3">subscript</csymbol><ci id="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.3.2.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.3.2">𝑦</ci><ci id="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.3.3.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2.1.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S4.E10.m1.3.3.3.3.1.1.1.cmml" xref="S4.E10.m1.3.3.3.3.1.1.1">𝑥</ci></apply></apply></apply><ci id="S4.E10.m1.4.4.4.4.2.1a.cmml" xref="S4.E10.m1.4.4.4.4.2.1"><mtext id="S4.E10.m1.4.4.4.4.2.1.cmml" xref="S4.E10.m1.4.4.4.4.2.1">otherwise.</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.6c">\mathcal{L}(x,\omega)=\begin{cases}-(1+\hat{y_{i}})\cdot\log\sigma(f^{y_{i}}(x))&amp;\text{ if }y_{i}=1\\
-\hat{y_{i}}\cdot\log\sigma(f^{y_{i}}(x))&amp;\text{otherwise.}\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.4" class="ltx_p">For the ground-truth class, the regularization gives upward weights to the loss. The degree of the weights is determined by the confidence of the local model compared to the global model. The upward weights are set to low values if the local model reveals overconfidence. In contrast, higher upward weights are applied to samples for which the global model has higher confidence than the local model so as to avoid deviating from the global model. Figure <a href="#S4.F3" title="Figure 3 ‣ 4.2 Drift Regularization ‣ 4 Learning from Drift (LfD) ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the prediction confidence of the global model, the local model, and the local model regularized by LfD. It shows that the global and local models have different confidence, especially for the minority classes of the local data distribution. However, LfD effectively regularizes the local model to have similar confidence to the global model.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">For the other classes, the regularization <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\mathcal{R}</annotation></semantics></math> works similarly to knowledge distillation <cite class="ltx_cite ltx_citemacro_citep">(Hinton, Vinyals, and Dean <a href="#bib.bib6" title="" class="ltx_ref">2015</a>)</cite> or label smoothing <cite class="ltx_cite ltx_citemacro_citep">(Szegedy et al. <a href="#bib.bib24" title="" class="ltx_ref">2016</a>)</cite> by providing non-zero weights to other classes. It prevents the local model from forgetting inter-class similarities learned from the global model. This is particularly important when the client data distribution does not cover all classes in global data distribution. In the experiment, we show that the term prevents the model from forgetting the learned knowledge of the global model.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">After the model is trained with LfD, the local models are sent to the central server for the aggregation (i.e., Eq. (<a href="#S2.E2" title="In 2 Problem setup ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>)). We provide the overall process of LfD in Algorithm <a href="#alg1" title="Algorithm 1 ‣ Appendix A Algorithm for LfD ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> in the supplementary material (Section <a href="#A1" title="Appendix A Algorithm for LfD ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>).</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Evaluations</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental Setup</h3>

<section id="S5.SS1.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Federated Simulation</h4>

<div id="S5.SS1.SSSx1.p1" class="ltx_para">
<p id="S5.SS1.SSSx1.p1.8" class="ltx_p">We mainly consider FedML benchmark <cite class="ltx_cite ltx_citemacro_citep">(He et al. <a href="#bib.bib4" title="" class="ltx_ref">2020</a>)</cite> to evaluate each method on the federated learning scenario, <span id="S5.SS1.SSSx1.p1.8.1" class="ltx_text ltx_font_italic">i.e.,</span> CIFAR-10 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky, Hinton et al. <a href="#bib.bib11" title="" class="ltx_ref">2009</a>)</cite>, CIFAR-100 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky, Hinton et al. <a href="#bib.bib11" title="" class="ltx_ref">2009</a>)</cite>, and CINIC-10 <cite class="ltx_cite ltx_citemacro_citep">(Darlow et al. <a href="#bib.bib3" title="" class="ltx_ref">2018</a>)</cite>. We also validate our method on other domains to extend our knowledge to different domains, i.e., AGNews <cite class="ltx_cite ltx_citemacro_citep">(Zhang, Zhao, and LeCun <a href="#bib.bib29" title="" class="ltx_ref">2015</a>)</cite> for natural language processing and BindingDB <cite class="ltx_cite ltx_citemacro_citep">(Liu et al. <a href="#bib.bib20" title="" class="ltx_ref">2007</a>)</cite> for biology. To simulate federated learning, we randomly split the training samples of each dataset into <math id="S5.SS1.SSSx1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.SS1.SSSx1.p1.1.m1.1a"><mi id="S5.SS1.SSSx1.p1.1.m1.1.1" xref="S5.SS1.SSSx1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSSx1.p1.1.m1.1b"><ci id="S5.SS1.SSSx1.p1.1.m1.1.1.cmml" xref="S5.SS1.SSSx1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSSx1.p1.1.m1.1c">K</annotation></semantics></math> batches (i.e., the number of clients, 10 by default), and assign one training batch to each client. As we are interested in Non-IID setting, we use Dirichlet distribution to generate the Non-IID data partition among participants. Specifically, we sample <math id="S5.SS1.SSSx1.p1.2.m2.1" class="ltx_Math" alttext="p_{ik}\sim{Dir}_{K}(\beta)" display="inline"><semantics id="S5.SS1.SSSx1.p1.2.m2.1a"><mrow id="S5.SS1.SSSx1.p1.2.m2.1.2" xref="S5.SS1.SSSx1.p1.2.m2.1.2.cmml"><msub id="S5.SS1.SSSx1.p1.2.m2.1.2.2" xref="S5.SS1.SSSx1.p1.2.m2.1.2.2.cmml"><mi id="S5.SS1.SSSx1.p1.2.m2.1.2.2.2" xref="S5.SS1.SSSx1.p1.2.m2.1.2.2.2.cmml">p</mi><mrow id="S5.SS1.SSSx1.p1.2.m2.1.2.2.3" xref="S5.SS1.SSSx1.p1.2.m2.1.2.2.3.cmml"><mi id="S5.SS1.SSSx1.p1.2.m2.1.2.2.3.2" xref="S5.SS1.SSSx1.p1.2.m2.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.SS1.SSSx1.p1.2.m2.1.2.2.3.1" xref="S5.SS1.SSSx1.p1.2.m2.1.2.2.3.1.cmml">​</mo><mi id="S5.SS1.SSSx1.p1.2.m2.1.2.2.3.3" xref="S5.SS1.SSSx1.p1.2.m2.1.2.2.3.3.cmml">k</mi></mrow></msub><mo id="S5.SS1.SSSx1.p1.2.m2.1.2.1" xref="S5.SS1.SSSx1.p1.2.m2.1.2.1.cmml">∼</mo><mrow id="S5.SS1.SSSx1.p1.2.m2.1.2.3" xref="S5.SS1.SSSx1.p1.2.m2.1.2.3.cmml"><mi id="S5.SS1.SSSx1.p1.2.m2.1.2.3.2" xref="S5.SS1.SSSx1.p1.2.m2.1.2.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S5.SS1.SSSx1.p1.2.m2.1.2.3.1" xref="S5.SS1.SSSx1.p1.2.m2.1.2.3.1.cmml">​</mo><mi id="S5.SS1.SSSx1.p1.2.m2.1.2.3.3" xref="S5.SS1.SSSx1.p1.2.m2.1.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.SS1.SSSx1.p1.2.m2.1.2.3.1a" xref="S5.SS1.SSSx1.p1.2.m2.1.2.3.1.cmml">​</mo><msub id="S5.SS1.SSSx1.p1.2.m2.1.2.3.4" xref="S5.SS1.SSSx1.p1.2.m2.1.2.3.4.cmml"><mi id="S5.SS1.SSSx1.p1.2.m2.1.2.3.4.2" xref="S5.SS1.SSSx1.p1.2.m2.1.2.3.4.2.cmml">r</mi><mi id="S5.SS1.SSSx1.p1.2.m2.1.2.3.4.3" xref="S5.SS1.SSSx1.p1.2.m2.1.2.3.4.3.cmml">K</mi></msub><mo lspace="0em" rspace="0em" id="S5.SS1.SSSx1.p1.2.m2.1.2.3.1b" xref="S5.SS1.SSSx1.p1.2.m2.1.2.3.1.cmml">​</mo><mrow id="S5.SS1.SSSx1.p1.2.m2.1.2.3.5.2" xref="S5.SS1.SSSx1.p1.2.m2.1.2.3.cmml"><mo stretchy="false" id="S5.SS1.SSSx1.p1.2.m2.1.2.3.5.2.1" xref="S5.SS1.SSSx1.p1.2.m2.1.2.3.cmml">(</mo><mi id="S5.SS1.SSSx1.p1.2.m2.1.1" xref="S5.SS1.SSSx1.p1.2.m2.1.1.cmml">β</mi><mo stretchy="false" id="S5.SS1.SSSx1.p1.2.m2.1.2.3.5.2.2" xref="S5.SS1.SSSx1.p1.2.m2.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSSx1.p1.2.m2.1b"><apply id="S5.SS1.SSSx1.p1.2.m2.1.2.cmml" xref="S5.SS1.SSSx1.p1.2.m2.1.2"><csymbol cd="latexml" id="S5.SS1.SSSx1.p1.2.m2.1.2.1.cmml" xref="S5.SS1.SSSx1.p1.2.m2.1.2.1">similar-to</csymbol><apply id="S5.SS1.SSSx1.p1.2.m2.1.2.2.cmml" xref="S5.SS1.SSSx1.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S5.SS1.SSSx1.p1.2.m2.1.2.2.1.cmml" xref="S5.SS1.SSSx1.p1.2.m2.1.2.2">subscript</csymbol><ci id="S5.SS1.SSSx1.p1.2.m2.1.2.2.2.cmml" xref="S5.SS1.SSSx1.p1.2.m2.1.2.2.2">𝑝</ci><apply id="S5.SS1.SSSx1.p1.2.m2.1.2.2.3.cmml" xref="S5.SS1.SSSx1.p1.2.m2.1.2.2.3"><times id="S5.SS1.SSSx1.p1.2.m2.1.2.2.3.1.cmml" xref="S5.SS1.SSSx1.p1.2.m2.1.2.2.3.1"></times><ci id="S5.SS1.SSSx1.p1.2.m2.1.2.2.3.2.cmml" xref="S5.SS1.SSSx1.p1.2.m2.1.2.2.3.2">𝑖</ci><ci id="S5.SS1.SSSx1.p1.2.m2.1.2.2.3.3.cmml" xref="S5.SS1.SSSx1.p1.2.m2.1.2.2.3.3">𝑘</ci></apply></apply><apply id="S5.SS1.SSSx1.p1.2.m2.1.2.3.cmml" xref="S5.SS1.SSSx1.p1.2.m2.1.2.3"><times id="S5.SS1.SSSx1.p1.2.m2.1.2.3.1.cmml" xref="S5.SS1.SSSx1.p1.2.m2.1.2.3.1"></times><ci id="S5.SS1.SSSx1.p1.2.m2.1.2.3.2.cmml" xref="S5.SS1.SSSx1.p1.2.m2.1.2.3.2">𝐷</ci><ci id="S5.SS1.SSSx1.p1.2.m2.1.2.3.3.cmml" xref="S5.SS1.SSSx1.p1.2.m2.1.2.3.3">𝑖</ci><apply id="S5.SS1.SSSx1.p1.2.m2.1.2.3.4.cmml" xref="S5.SS1.SSSx1.p1.2.m2.1.2.3.4"><csymbol cd="ambiguous" id="S5.SS1.SSSx1.p1.2.m2.1.2.3.4.1.cmml" xref="S5.SS1.SSSx1.p1.2.m2.1.2.3.4">subscript</csymbol><ci id="S5.SS1.SSSx1.p1.2.m2.1.2.3.4.2.cmml" xref="S5.SS1.SSSx1.p1.2.m2.1.2.3.4.2">𝑟</ci><ci id="S5.SS1.SSSx1.p1.2.m2.1.2.3.4.3.cmml" xref="S5.SS1.SSSx1.p1.2.m2.1.2.3.4.3">𝐾</ci></apply><ci id="S5.SS1.SSSx1.p1.2.m2.1.1.cmml" xref="S5.SS1.SSSx1.p1.2.m2.1.1">𝛽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSSx1.p1.2.m2.1c">p_{ik}\sim{Dir}_{K}(\beta)</annotation></semantics></math> and allocate a <math id="S5.SS1.SSSx1.p1.3.m3.1" class="ltx_Math" alttext="p_{ik}" display="inline"><semantics id="S5.SS1.SSSx1.p1.3.m3.1a"><msub id="S5.SS1.SSSx1.p1.3.m3.1.1" xref="S5.SS1.SSSx1.p1.3.m3.1.1.cmml"><mi id="S5.SS1.SSSx1.p1.3.m3.1.1.2" xref="S5.SS1.SSSx1.p1.3.m3.1.1.2.cmml">p</mi><mrow id="S5.SS1.SSSx1.p1.3.m3.1.1.3" xref="S5.SS1.SSSx1.p1.3.m3.1.1.3.cmml"><mi id="S5.SS1.SSSx1.p1.3.m3.1.1.3.2" xref="S5.SS1.SSSx1.p1.3.m3.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.SS1.SSSx1.p1.3.m3.1.1.3.1" xref="S5.SS1.SSSx1.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS1.SSSx1.p1.3.m3.1.1.3.3" xref="S5.SS1.SSSx1.p1.3.m3.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSSx1.p1.3.m3.1b"><apply id="S5.SS1.SSSx1.p1.3.m3.1.1.cmml" xref="S5.SS1.SSSx1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSSx1.p1.3.m3.1.1.1.cmml" xref="S5.SS1.SSSx1.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS1.SSSx1.p1.3.m3.1.1.2.cmml" xref="S5.SS1.SSSx1.p1.3.m3.1.1.2">𝑝</ci><apply id="S5.SS1.SSSx1.p1.3.m3.1.1.3.cmml" xref="S5.SS1.SSSx1.p1.3.m3.1.1.3"><times id="S5.SS1.SSSx1.p1.3.m3.1.1.3.1.cmml" xref="S5.SS1.SSSx1.p1.3.m3.1.1.3.1"></times><ci id="S5.SS1.SSSx1.p1.3.m3.1.1.3.2.cmml" xref="S5.SS1.SSSx1.p1.3.m3.1.1.3.2">𝑖</ci><ci id="S5.SS1.SSSx1.p1.3.m3.1.1.3.3.cmml" xref="S5.SS1.SSSx1.p1.3.m3.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSSx1.p1.3.m3.1c">p_{ik}</annotation></semantics></math> proportion of the instances of class <math id="S5.SS1.SSSx1.p1.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.SS1.SSSx1.p1.4.m4.1a"><mi id="S5.SS1.SSSx1.p1.4.m4.1.1" xref="S5.SS1.SSSx1.p1.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSSx1.p1.4.m4.1b"><ci id="S5.SS1.SSSx1.p1.4.m4.1.1.cmml" xref="S5.SS1.SSSx1.p1.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSSx1.p1.4.m4.1c">i</annotation></semantics></math> to client <math id="S5.SS1.SSSx1.p1.5.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS1.SSSx1.p1.5.m5.1a"><mi id="S5.SS1.SSSx1.p1.5.m5.1.1" xref="S5.SS1.SSSx1.p1.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSSx1.p1.5.m5.1b"><ci id="S5.SS1.SSSx1.p1.5.m5.1.1.cmml" xref="S5.SS1.SSSx1.p1.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSSx1.p1.5.m5.1c">k</annotation></semantics></math>, where <math id="S5.SS1.SSSx1.p1.6.m6.1" class="ltx_Math" alttext="Dir(\beta)" display="inline"><semantics id="S5.SS1.SSSx1.p1.6.m6.1a"><mrow id="S5.SS1.SSSx1.p1.6.m6.1.2" xref="S5.SS1.SSSx1.p1.6.m6.1.2.cmml"><mi id="S5.SS1.SSSx1.p1.6.m6.1.2.2" xref="S5.SS1.SSSx1.p1.6.m6.1.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S5.SS1.SSSx1.p1.6.m6.1.2.1" xref="S5.SS1.SSSx1.p1.6.m6.1.2.1.cmml">​</mo><mi id="S5.SS1.SSSx1.p1.6.m6.1.2.3" xref="S5.SS1.SSSx1.p1.6.m6.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.SS1.SSSx1.p1.6.m6.1.2.1a" xref="S5.SS1.SSSx1.p1.6.m6.1.2.1.cmml">​</mo><mi id="S5.SS1.SSSx1.p1.6.m6.1.2.4" xref="S5.SS1.SSSx1.p1.6.m6.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.SS1.SSSx1.p1.6.m6.1.2.1b" xref="S5.SS1.SSSx1.p1.6.m6.1.2.1.cmml">​</mo><mrow id="S5.SS1.SSSx1.p1.6.m6.1.2.5.2" xref="S5.SS1.SSSx1.p1.6.m6.1.2.cmml"><mo stretchy="false" id="S5.SS1.SSSx1.p1.6.m6.1.2.5.2.1" xref="S5.SS1.SSSx1.p1.6.m6.1.2.cmml">(</mo><mi id="S5.SS1.SSSx1.p1.6.m6.1.1" xref="S5.SS1.SSSx1.p1.6.m6.1.1.cmml">β</mi><mo stretchy="false" id="S5.SS1.SSSx1.p1.6.m6.1.2.5.2.2" xref="S5.SS1.SSSx1.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSSx1.p1.6.m6.1b"><apply id="S5.SS1.SSSx1.p1.6.m6.1.2.cmml" xref="S5.SS1.SSSx1.p1.6.m6.1.2"><times id="S5.SS1.SSSx1.p1.6.m6.1.2.1.cmml" xref="S5.SS1.SSSx1.p1.6.m6.1.2.1"></times><ci id="S5.SS1.SSSx1.p1.6.m6.1.2.2.cmml" xref="S5.SS1.SSSx1.p1.6.m6.1.2.2">𝐷</ci><ci id="S5.SS1.SSSx1.p1.6.m6.1.2.3.cmml" xref="S5.SS1.SSSx1.p1.6.m6.1.2.3">𝑖</ci><ci id="S5.SS1.SSSx1.p1.6.m6.1.2.4.cmml" xref="S5.SS1.SSSx1.p1.6.m6.1.2.4">𝑟</ci><ci id="S5.SS1.SSSx1.p1.6.m6.1.1.cmml" xref="S5.SS1.SSSx1.p1.6.m6.1.1">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSSx1.p1.6.m6.1c">Dir(\beta)</annotation></semantics></math> is the Dirichlet distribution with a concentration parameter <math id="S5.SS1.SSSx1.p1.7.m7.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.SS1.SSSx1.p1.7.m7.1a"><mi id="S5.SS1.SSSx1.p1.7.m7.1.1" xref="S5.SS1.SSSx1.p1.7.m7.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSSx1.p1.7.m7.1b"><ci id="S5.SS1.SSSx1.p1.7.m7.1.1.cmml" xref="S5.SS1.SSSx1.p1.7.m7.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSSx1.p1.7.m7.1c">\beta</annotation></semantics></math> (0.5 by default), and smaller <math id="S5.SS1.SSSx1.p1.8.m8.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.SS1.SSSx1.p1.8.m8.1a"><mi id="S5.SS1.SSSx1.p1.8.m8.1.1" xref="S5.SS1.SSSx1.p1.8.m8.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSSx1.p1.8.m8.1b"><ci id="S5.SS1.SSSx1.p1.8.m8.1.1.cmml" xref="S5.SS1.SSSx1.p1.8.m8.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSSx1.p1.8.m8.1c">\beta</annotation></semantics></math> makes more heterogeneous data distribution.</p>
</div>
</section>
<section id="S5.SS1.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Baselines and Implementations</h4>

<div id="S5.SS1.SSSx2.p1" class="ltx_para">
<p id="S5.SS1.SSSx2.p1.4" class="ltx_p">We consider comparing the test accuracies of the representative federated learning algorithms: FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib22" title="" class="ltx_ref">2017</a>)</cite>, FedProx <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib16" title="" class="ltx_ref">2018</a>)</cite>, FedAvgM <cite class="ltx_cite ltx_citemacro_citep">(Hsu, Qi, and Brown <a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite>, and state-of-the-art method MOON <cite class="ltx_cite ltx_citemacro_citep">(Li, He, and Song <a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite>. We carefully choose the best hyper-parameters used in FedProx (<span id="S5.SS1.SSSx2.p1.4.1" class="ltx_text ltx_font_italic">i.e.,</span> weighting factor <math id="S5.SS1.SSSx2.p1.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S5.SS1.SSSx2.p1.1.m1.1a"><mi id="S5.SS1.SSSx2.p1.1.m1.1.1" xref="S5.SS1.SSSx2.p1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSSx2.p1.1.m1.1b"><ci id="S5.SS1.SSSx2.p1.1.m1.1.1.cmml" xref="S5.SS1.SSSx2.p1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSSx2.p1.1.m1.1c">\mu</annotation></semantics></math> for euclidean distance), FedAvgM (<span id="S5.SS1.SSSx2.p1.4.2" class="ltx_text ltx_font_italic">i.e.,</span> <math id="S5.SS1.SSSx2.p1.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.SS1.SSSx2.p1.2.m2.1a"><mi id="S5.SS1.SSSx2.p1.2.m2.1.1" xref="S5.SS1.SSSx2.p1.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSSx2.p1.2.m2.1b"><ci id="S5.SS1.SSSx2.p1.2.m2.1.1.cmml" xref="S5.SS1.SSSx2.p1.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSSx2.p1.2.m2.1c">\beta</annotation></semantics></math> momentum factor) and MOON (<span id="S5.SS1.SSSx2.p1.4.3" class="ltx_text ltx_font_italic">i.e.,</span> <math id="S5.SS1.SSSx2.p1.3.m3.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S5.SS1.SSSx2.p1.3.m3.1a"><mi id="S5.SS1.SSSx2.p1.3.m3.1.1" xref="S5.SS1.SSSx2.p1.3.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSSx2.p1.3.m3.1b"><ci id="S5.SS1.SSSx2.p1.3.m3.1.1.cmml" xref="S5.SS1.SSSx2.p1.3.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSSx2.p1.3.m3.1c">\tau</annotation></semantics></math> temperature and <math id="S5.SS1.SSSx2.p1.4.m4.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S5.SS1.SSSx2.p1.4.m4.1a"><mi id="S5.SS1.SSSx2.p1.4.m4.1.1" xref="S5.SS1.SSSx2.p1.4.m4.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSSx2.p1.4.m4.1b"><ci id="S5.SS1.SSSx2.p1.4.m4.1.1.cmml" xref="S5.SS1.SSSx2.p1.4.m4.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSSx2.p1.4.m4.1c">\mu</annotation></semantics></math> weighting factor for contrastive learning) through the validation set. For our method, we set the temperature as 0.1 (CIFAR-10, CINIC-10), 0.05 (CIFAR-100) for all softmax functions<span id="footnote6" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>We use the small temperature due to the normalization.</span></span></span> and set the margin as 0.15 by default.</p>
</div>
<div id="S5.SS1.SSSx2.p2" class="ltx_para">
<p id="S5.SS1.SSSx2.p2.1" class="ltx_p">We use a simple 2-layers CNNs with 2-layers MLP projection networks for CIFAR-10. For CIFAR100 and CINIC-10, we adopt ResNet-18 <cite class="ltx_cite ltx_citemacro_citep">(He et al. <a href="#bib.bib5" title="" class="ltx_ref">2016</a>)</cite>. For a fair comparison, we use the same networks and augmentation for all methods. For the optimization, we use the SGD optimizer with a learning rate 0.01 for all approaches. The SGD weight decay is set to 0.00001 and the SGD momentum is set to 0.9. The batch size is set to 128. The number of local epochs is set to 300 for Union. The number of local epochs is set to 10 for all federated learning approaches unless explicitly specified. Each result is averaged result over three trials and these are implemented by PyTorch 1.7 on the NVIDIA A100 GPUs.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>(Generalization) Top-1 Test Accuracy (%) on CIFAR-10, CIFAR-100, BindingDB and AGNews. Best and second best results are highlighted in <span id="S5.T2.27.1" class="ltx_text ltx_font_bold">boldface</span> and <span id="S5.T2.28.2" class="ltx_text ltx_framed ltx_framed_underline">underlined</span>, respectively.</figcaption>
<p id="S5.T2.24" class="ltx_p"><span id="S5.T2.24.24" class="ltx_text">
<span id="S5.T2.24.24.24" class="ltx_inline-block ltx_transformed_outer" style="width:292.3pt;height:126pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S5.T2.24.24.24.24" class="ltx_p"><span id="S5.T2.24.24.24.24.24" class="ltx_text">
<span id="S5.T2.24.24.24.24.24.24" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_thead">
<span id="S5.T2.24.24.24.24.24.24.25.1" class="ltx_tr">
<span id="S5.T2.24.24.24.24.24.24.25.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">Method</span>
<span id="S5.T2.24.24.24.24.24.24.25.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">CIFAR-10</span>
<span id="S5.T2.24.24.24.24.24.24.25.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">CIFAR-100</span>
<span id="S5.T2.24.24.24.24.24.24.25.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">BindingDB</span>
<span id="S5.T2.24.24.24.24.24.24.25.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt">AGNews</span></span>
<span id="S5.T2.4.4.4.4.4.4.4" class="ltx_tr">
<span id="S5.T2.4.4.4.4.4.4.4.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">Union</span>
<span id="S5.T2.1.1.1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">74.5 <math id="S5.T2.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.1.1.1.1.1.1.1.1.m1.1a"><mo id="S5.T2.1.1.1.1.1.1.1.1.m1.1.1" xref="S5.T2.1.1.1.1.1.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.1.1.1.1.1.m1.1b"><csymbol cd="latexml" id="S5.T2.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.1.1.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.1.1.1.1.1.m1.1c">\pm</annotation></semantics></math> 0.9</span>
<span id="S5.T2.2.2.2.2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">70.9 <math id="S5.T2.2.2.2.2.2.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.2.2.2.2.2.2.2.2.m1.1a"><mo id="S5.T2.2.2.2.2.2.2.2.2.m1.1.1" xref="S5.T2.2.2.2.2.2.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.2.2.2.2.2.m1.1b"><csymbol cd="latexml" id="S5.T2.2.2.2.2.2.2.2.2.m1.1.1.cmml" xref="S5.T2.2.2.2.2.2.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.2.2.2.2.2.m1.1c">\pm</annotation></semantics></math> 0.4</span>
<span id="S5.T2.3.3.3.3.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">89.5 <math id="S5.T2.3.3.3.3.3.3.3.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.3.3.3.3.3.3.3.3.m1.1a"><mo id="S5.T2.3.3.3.3.3.3.3.3.m1.1.1" xref="S5.T2.3.3.3.3.3.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.3.3.3.3.3.m1.1b"><csymbol cd="latexml" id="S5.T2.3.3.3.3.3.3.3.3.m1.1.1.cmml" xref="S5.T2.3.3.3.3.3.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.3.3.3.3.3.3.m1.1c">\pm</annotation></semantics></math> 1.2</span>
<span id="S5.T2.4.4.4.4.4.4.4.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t">90.1 <math id="S5.T2.4.4.4.4.4.4.4.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.4.4.4.4.4.4.4.4.m1.1a"><mo id="S5.T2.4.4.4.4.4.4.4.4.m1.1.1" xref="S5.T2.4.4.4.4.4.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.4.4.4.4.4.4.4.4.m1.1b"><csymbol cd="latexml" id="S5.T2.4.4.4.4.4.4.4.4.m1.1.1.cmml" xref="S5.T2.4.4.4.4.4.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.4.4.4.4.4.4.4.m1.1c">\pm</annotation></semantics></math> 0.7</span></span>
</span>
<span class="ltx_tbody">
<span id="S5.T2.8.8.8.8.8.8.8" class="ltx_tr">
<span id="S5.T2.8.8.8.8.8.8.8.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt">FedAvg</span>
<span id="S5.T2.5.5.5.5.5.5.5.1" class="ltx_td ltx_align_center ltx_border_tt">69.1 <math id="S5.T2.5.5.5.5.5.5.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.5.5.5.5.5.5.5.1.m1.1a"><mo id="S5.T2.5.5.5.5.5.5.5.1.m1.1.1" xref="S5.T2.5.5.5.5.5.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.5.5.5.5.5.5.5.1.m1.1b"><csymbol cd="latexml" id="S5.T2.5.5.5.5.5.5.5.1.m1.1.1.cmml" xref="S5.T2.5.5.5.5.5.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.5.5.5.5.5.5.1.m1.1c">\pm</annotation></semantics></math> 0.6</span>
<span id="S5.T2.6.6.6.6.6.6.6.2" class="ltx_td ltx_align_center ltx_border_tt">64.0 <math id="S5.T2.6.6.6.6.6.6.6.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.6.6.6.6.6.6.6.2.m1.1a"><mo id="S5.T2.6.6.6.6.6.6.6.2.m1.1.1" xref="S5.T2.6.6.6.6.6.6.6.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.6.6.6.6.6.6.6.2.m1.1b"><csymbol cd="latexml" id="S5.T2.6.6.6.6.6.6.6.2.m1.1.1.cmml" xref="S5.T2.6.6.6.6.6.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.6.6.6.6.6.6.2.m1.1c">\pm</annotation></semantics></math> 0.3</span>
<span id="S5.T2.7.7.7.7.7.7.7.3" class="ltx_td ltx_align_center ltx_border_tt">85.7 <math id="S5.T2.7.7.7.7.7.7.7.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.7.7.7.7.7.7.7.3.m1.1a"><mo id="S5.T2.7.7.7.7.7.7.7.3.m1.1.1" xref="S5.T2.7.7.7.7.7.7.7.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.7.7.7.7.7.7.7.3.m1.1b"><csymbol cd="latexml" id="S5.T2.7.7.7.7.7.7.7.3.m1.1.1.cmml" xref="S5.T2.7.7.7.7.7.7.7.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.7.7.7.7.7.7.3.m1.1c">\pm</annotation></semantics></math> 0.8</span>
<span id="S5.T2.8.8.8.8.8.8.8.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt">85.6 <math id="S5.T2.8.8.8.8.8.8.8.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.8.8.8.8.8.8.8.4.m1.1a"><mo id="S5.T2.8.8.8.8.8.8.8.4.m1.1.1" xref="S5.T2.8.8.8.8.8.8.8.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.8.8.8.8.8.8.8.4.m1.1b"><csymbol cd="latexml" id="S5.T2.8.8.8.8.8.8.8.4.m1.1.1.cmml" xref="S5.T2.8.8.8.8.8.8.8.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.8.8.8.8.8.8.4.m1.1c">\pm</annotation></semantics></math> 1.2</span></span>
<span id="S5.T2.12.12.12.12.12.12.12" class="ltx_tr">
<span id="S5.T2.12.12.12.12.12.12.12.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedAvgM</span>
<span id="S5.T2.9.9.9.9.9.9.9.1" class="ltx_td ltx_align_center">69.9 <math id="S5.T2.9.9.9.9.9.9.9.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.9.9.9.9.9.9.9.1.m1.1a"><mo id="S5.T2.9.9.9.9.9.9.9.1.m1.1.1" xref="S5.T2.9.9.9.9.9.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.9.9.9.9.9.9.9.1.m1.1b"><csymbol cd="latexml" id="S5.T2.9.9.9.9.9.9.9.1.m1.1.1.cmml" xref="S5.T2.9.9.9.9.9.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.9.9.9.9.9.9.9.1.m1.1c">\pm</annotation></semantics></math> 1.1</span>
<span id="S5.T2.10.10.10.10.10.10.10.2" class="ltx_td ltx_align_center">64.1 <math id="S5.T2.10.10.10.10.10.10.10.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.10.10.10.10.10.10.10.2.m1.1a"><mo id="S5.T2.10.10.10.10.10.10.10.2.m1.1.1" xref="S5.T2.10.10.10.10.10.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.10.10.10.10.10.10.10.2.m1.1b"><csymbol cd="latexml" id="S5.T2.10.10.10.10.10.10.10.2.m1.1.1.cmml" xref="S5.T2.10.10.10.10.10.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.10.10.10.10.10.10.10.2.m1.1c">\pm</annotation></semantics></math> 0.9</span>
<span id="S5.T2.11.11.11.11.11.11.11.3" class="ltx_td ltx_align_center">86.5 <math id="S5.T2.11.11.11.11.11.11.11.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.11.11.11.11.11.11.11.3.m1.1a"><mo id="S5.T2.11.11.11.11.11.11.11.3.m1.1.1" xref="S5.T2.11.11.11.11.11.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.11.11.11.11.11.11.11.3.m1.1b"><csymbol cd="latexml" id="S5.T2.11.11.11.11.11.11.11.3.m1.1.1.cmml" xref="S5.T2.11.11.11.11.11.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.11.11.11.11.11.11.11.3.m1.1c">\pm</annotation></semantics></math> 1.5</span>
<span id="S5.T2.12.12.12.12.12.12.12.4" class="ltx_td ltx_nopad_r ltx_align_center">86.1 <math id="S5.T2.12.12.12.12.12.12.12.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.12.12.12.12.12.12.12.4.m1.1a"><mo id="S5.T2.12.12.12.12.12.12.12.4.m1.1.1" xref="S5.T2.12.12.12.12.12.12.12.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.12.12.12.12.12.12.12.4.m1.1b"><csymbol cd="latexml" id="S5.T2.12.12.12.12.12.12.12.4.m1.1.1.cmml" xref="S5.T2.12.12.12.12.12.12.12.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.12.12.12.12.12.12.12.4.m1.1c">\pm</annotation></semantics></math> 0.8</span></span>
<span id="S5.T2.16.16.16.16.16.16.16" class="ltx_tr">
<span id="S5.T2.16.16.16.16.16.16.16.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedProx</span>
<span id="S5.T2.13.13.13.13.13.13.13.1" class="ltx_td ltx_align_center">68.6 <math id="S5.T2.13.13.13.13.13.13.13.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.13.13.13.13.13.13.13.1.m1.1a"><mo id="S5.T2.13.13.13.13.13.13.13.1.m1.1.1" xref="S5.T2.13.13.13.13.13.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.13.13.13.13.13.13.13.1.m1.1b"><csymbol cd="latexml" id="S5.T2.13.13.13.13.13.13.13.1.m1.1.1.cmml" xref="S5.T2.13.13.13.13.13.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.13.13.13.13.13.13.13.1.m1.1c">\pm</annotation></semantics></math> 0.9</span>
<span id="S5.T2.14.14.14.14.14.14.14.2" class="ltx_td ltx_align_center">63.1 <math id="S5.T2.14.14.14.14.14.14.14.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.14.14.14.14.14.14.14.2.m1.1a"><mo id="S5.T2.14.14.14.14.14.14.14.2.m1.1.1" xref="S5.T2.14.14.14.14.14.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.14.14.14.14.14.14.14.2.m1.1b"><csymbol cd="latexml" id="S5.T2.14.14.14.14.14.14.14.2.m1.1.1.cmml" xref="S5.T2.14.14.14.14.14.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.14.14.14.14.14.14.14.2.m1.1c">\pm</annotation></semantics></math> 0.7</span>
<span id="S5.T2.15.15.15.15.15.15.15.3" class="ltx_td ltx_align_center">86.1 <math id="S5.T2.15.15.15.15.15.15.15.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.15.15.15.15.15.15.15.3.m1.1a"><mo id="S5.T2.15.15.15.15.15.15.15.3.m1.1.1" xref="S5.T2.15.15.15.15.15.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.15.15.15.15.15.15.15.3.m1.1b"><csymbol cd="latexml" id="S5.T2.15.15.15.15.15.15.15.3.m1.1.1.cmml" xref="S5.T2.15.15.15.15.15.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.15.15.15.15.15.15.15.3.m1.1c">\pm</annotation></semantics></math> 0.5</span>
<span id="S5.T2.16.16.16.16.16.16.16.4" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.T2.16.16.16.16.16.16.16.4.1" class="ltx_text ltx_framed ltx_framed_underline">86.9</span> <math id="S5.T2.16.16.16.16.16.16.16.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.16.16.16.16.16.16.16.4.m1.1a"><mo id="S5.T2.16.16.16.16.16.16.16.4.m1.1.1" xref="S5.T2.16.16.16.16.16.16.16.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.16.16.16.16.16.16.16.4.m1.1b"><csymbol cd="latexml" id="S5.T2.16.16.16.16.16.16.16.4.m1.1.1.cmml" xref="S5.T2.16.16.16.16.16.16.16.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.16.16.16.16.16.16.16.4.m1.1c">\pm</annotation></semantics></math> 0.5</span></span>
<span id="S5.T2.20.20.20.20.20.20.20" class="ltx_tr">
<span id="S5.T2.20.20.20.20.20.20.20.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">MOON</span>
<span id="S5.T2.17.17.17.17.17.17.17.1" class="ltx_td ltx_align_center"><span id="S5.T2.17.17.17.17.17.17.17.1.1" class="ltx_text ltx_framed ltx_framed_underline">71.2</span> <math id="S5.T2.17.17.17.17.17.17.17.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.17.17.17.17.17.17.17.1.m1.1a"><mo id="S5.T2.17.17.17.17.17.17.17.1.m1.1.1" xref="S5.T2.17.17.17.17.17.17.17.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.17.17.17.17.17.17.17.1.m1.1b"><csymbol cd="latexml" id="S5.T2.17.17.17.17.17.17.17.1.m1.1.1.cmml" xref="S5.T2.17.17.17.17.17.17.17.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.17.17.17.17.17.17.17.1.m1.1c">\pm</annotation></semantics></math> 0.5</span>
<span id="S5.T2.18.18.18.18.18.18.18.2" class="ltx_td ltx_align_center"><span id="S5.T2.18.18.18.18.18.18.18.2.1" class="ltx_text ltx_framed ltx_framed_underline">64.3</span> <math id="S5.T2.18.18.18.18.18.18.18.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.18.18.18.18.18.18.18.2.m1.1a"><mo id="S5.T2.18.18.18.18.18.18.18.2.m1.1.1" xref="S5.T2.18.18.18.18.18.18.18.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.18.18.18.18.18.18.18.2.m1.1b"><csymbol cd="latexml" id="S5.T2.18.18.18.18.18.18.18.2.m1.1.1.cmml" xref="S5.T2.18.18.18.18.18.18.18.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.18.18.18.18.18.18.18.2.m1.1c">\pm</annotation></semantics></math> 0.8</span>
<span id="S5.T2.19.19.19.19.19.19.19.3" class="ltx_td ltx_align_center"><span id="S5.T2.19.19.19.19.19.19.19.3.1" class="ltx_text ltx_font_bold">89.0</span> <math id="S5.T2.19.19.19.19.19.19.19.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.19.19.19.19.19.19.19.3.m1.1a"><mo id="S5.T2.19.19.19.19.19.19.19.3.m1.1.1" xref="S5.T2.19.19.19.19.19.19.19.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.19.19.19.19.19.19.19.3.m1.1b"><csymbol cd="latexml" id="S5.T2.19.19.19.19.19.19.19.3.m1.1.1.cmml" xref="S5.T2.19.19.19.19.19.19.19.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.19.19.19.19.19.19.19.3.m1.1c">\pm</annotation></semantics></math> 0.3</span>
<span id="S5.T2.20.20.20.20.20.20.20.4" class="ltx_td ltx_nopad_r ltx_align_center">85.4 <math id="S5.T2.20.20.20.20.20.20.20.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.20.20.20.20.20.20.20.4.m1.1a"><mo id="S5.T2.20.20.20.20.20.20.20.4.m1.1.1" xref="S5.T2.20.20.20.20.20.20.20.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.20.20.20.20.20.20.20.4.m1.1b"><csymbol cd="latexml" id="S5.T2.20.20.20.20.20.20.20.4.m1.1.1.cmml" xref="S5.T2.20.20.20.20.20.20.20.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.20.20.20.20.20.20.20.4.m1.1c">\pm</annotation></semantics></math> 0.4</span></span>
<span id="S5.T2.24.24.24.24.24.24.24" class="ltx_tr">
<span id="S5.T2.24.24.24.24.24.24.24.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">LfD (ours)</span>
<span id="S5.T2.21.21.21.21.21.21.21.1" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.21.21.21.21.21.21.21.1.1" class="ltx_text ltx_font_bold">74.1</span> <math id="S5.T2.21.21.21.21.21.21.21.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.21.21.21.21.21.21.21.1.m1.1a"><mo id="S5.T2.21.21.21.21.21.21.21.1.m1.1.1" xref="S5.T2.21.21.21.21.21.21.21.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.21.21.21.21.21.21.21.1.m1.1b"><csymbol cd="latexml" id="S5.T2.21.21.21.21.21.21.21.1.m1.1.1.cmml" xref="S5.T2.21.21.21.21.21.21.21.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.21.21.21.21.21.21.21.1.m1.1c">\pm</annotation></semantics></math> 0.4</span>
<span id="S5.T2.22.22.22.22.22.22.22.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.22.22.22.22.22.22.22.2.1" class="ltx_text ltx_font_bold">69.4</span> <math id="S5.T2.22.22.22.22.22.22.22.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.22.22.22.22.22.22.22.2.m1.1a"><mo id="S5.T2.22.22.22.22.22.22.22.2.m1.1.1" xref="S5.T2.22.22.22.22.22.22.22.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.22.22.22.22.22.22.22.2.m1.1b"><csymbol cd="latexml" id="S5.T2.22.22.22.22.22.22.22.2.m1.1.1.cmml" xref="S5.T2.22.22.22.22.22.22.22.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.22.22.22.22.22.22.22.2.m1.1c">\pm</annotation></semantics></math> 0.5</span>
<span id="S5.T2.23.23.23.23.23.23.23.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.23.23.23.23.23.23.23.3.1" class="ltx_text ltx_framed ltx_framed_underline">88.1</span> <math id="S5.T2.23.23.23.23.23.23.23.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.23.23.23.23.23.23.23.3.m1.1a"><mo id="S5.T2.23.23.23.23.23.23.23.3.m1.1.1" xref="S5.T2.23.23.23.23.23.23.23.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.23.23.23.23.23.23.23.3.m1.1b"><csymbol cd="latexml" id="S5.T2.23.23.23.23.23.23.23.3.m1.1.1.cmml" xref="S5.T2.23.23.23.23.23.23.23.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.23.23.23.23.23.23.23.3.m1.1c">\pm</annotation></semantics></math> 0.4</span>
<span id="S5.T2.24.24.24.24.24.24.24.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb"><span id="S5.T2.24.24.24.24.24.24.24.4.1" class="ltx_text ltx_font_bold">88.4</span> <math id="S5.T2.24.24.24.24.24.24.24.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.24.24.24.24.24.24.24.4.m1.1a"><mo id="S5.T2.24.24.24.24.24.24.24.4.m1.1.1" xref="S5.T2.24.24.24.24.24.24.24.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.24.24.24.24.24.24.24.4.m1.1b"><csymbol cd="latexml" id="S5.T2.24.24.24.24.24.24.24.4.m1.1.1.cmml" xref="S5.T2.24.24.24.24.24.24.24.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.24.24.24.24.24.24.24.4.m1.1c">\pm</annotation></semantics></math> 0.5</span></span>
</span>
</span></span></span>
</span></span></span></p>
</figure>
</section>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Experimental Results</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">We evaluate each method on following viewpoints to see the strength of the proposed methods in federated learning:</p>
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p"><span id="S5.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Generalization</span>: The federated learning algorithm should be well generalized to diverse domains and datasets.</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p"><span id="S5.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Heterogeneity</span>: The federated learning algorithm should be robust on different levels of heterogeneity, <span id="S5.I1.i2.p1.1.2" class="ltx_text ltx_font_italic">i.e.,</span> class skewness and training data distribution.</p>
</div>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.1" class="ltx_p"><span id="S5.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Scalability</span>: In reality, the number of clients is highly variable depending on the application. Moreover, there is no guarantee that all participants join the update steps due to communication loss or battery issues. Therefore, the federated learning method should work well with a large number of clients and the variation of the participating clients for the global update.</p>
</div>
</li>
<li id="S5.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i4.p1" class="ltx_para">
<p id="S5.I1.i4.p1.1" class="ltx_p"><span id="S5.I1.i4.p1.1.1" class="ltx_text ltx_font_bold">Forgetting</span>: One of the challenges for federated learning with Non-IID data is the class distribution’s discrepancy, which interferes with the converge of the global model. To mitigate such a bad effect, the local model should maintain the knowledge learned from the global model during the local optimization.</p>
</div>
</li>
<li id="S5.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i5.p1" class="ltx_para">
<p id="S5.I1.i5.p1.1" class="ltx_p"><span id="S5.I1.i5.p1.1.1" class="ltx_text ltx_font_bold">Efficiency</span>: Since the communication between clients and server is the main source of energy consumption <cite class="ltx_cite ltx_citemacro_citep">(Yadav and Yadav <a href="#bib.bib26" title="" class="ltx_ref">2016</a>; Latré et al. <a href="#bib.bib12" title="" class="ltx_ref">2011</a>)</cite>, it is important that federated learning methods should achieve strong accuracy with the small number of communications.</p>
</div>
</li>
</ul>
</div>
<section id="S5.SS2.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Generalization</h4>

<div id="S5.SS2.SSSx1.p1" class="ltx_para">
<p id="S5.SS2.SSSx1.p1.1" class="ltx_p">We first evaluate whether each method can be generalized to different domains and datasets. We conduct the experiments on three different domains, i.e., image (CIFAR-10/100), drug discovery (BindingDB), and natural language (AGNews), and the evaluation results are tabulated in Table <a href="#S5.T2" title="Table 2 ‣ Baselines and Implementations ‣ 5.1 Experimental Setup ‣ 5 Evaluations ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. It can be observed that the model learned by LfD yields strong accuracies on all domains (e.g., LfD achieves three state-of-the-art performances out of four domains), revealing that explicitly regularizing the local model based on the estimated drift is quite effective. Particularly, the models with global constraints, i.e., FedProx and MOON, often fail to achieve a great advantage over FedAvg. In contrast, LfD consistently shows improved accuracies by a large margin over FedAvg without considering domains and datasets. It further confirms the necessity of learning from the drift not just from the global constraints.</p>
</div>
</section>
<section id="S5.SS2.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Heterogeneity</h4>

<div id="S5.SS2.SSSx2.p1" class="ltx_para">
<p id="S5.SS2.SSSx2.p1.3" class="ltx_p">We confirm whether each method still works well with the different levels of heterogeneity and the shift of training data distribution. To this end, we adjust the concentration parameter <math id="S5.SS2.SSSx2.p1.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.SS2.SSSx2.p1.1.m1.1a"><mi id="S5.SS2.SSSx2.p1.1.m1.1.1" xref="S5.SS2.SSSx2.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSSx2.p1.1.m1.1b"><ci id="S5.SS2.SSSx2.p1.1.m1.1.1.cmml" xref="S5.SS2.SSSx2.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSSx2.p1.1.m1.1c">\beta</annotation></semantics></math> to increase the level of heterogeneity (i.e, <math id="S5.SS2.SSSx2.p1.2.m2.3" class="ltx_Math" alttext="\beta\in\{0.5,0.1,0.05\}" display="inline"><semantics id="S5.SS2.SSSx2.p1.2.m2.3a"><mrow id="S5.SS2.SSSx2.p1.2.m2.3.4" xref="S5.SS2.SSSx2.p1.2.m2.3.4.cmml"><mi id="S5.SS2.SSSx2.p1.2.m2.3.4.2" xref="S5.SS2.SSSx2.p1.2.m2.3.4.2.cmml">β</mi><mo id="S5.SS2.SSSx2.p1.2.m2.3.4.1" xref="S5.SS2.SSSx2.p1.2.m2.3.4.1.cmml">∈</mo><mrow id="S5.SS2.SSSx2.p1.2.m2.3.4.3.2" xref="S5.SS2.SSSx2.p1.2.m2.3.4.3.1.cmml"><mo stretchy="false" id="S5.SS2.SSSx2.p1.2.m2.3.4.3.2.1" xref="S5.SS2.SSSx2.p1.2.m2.3.4.3.1.cmml">{</mo><mn id="S5.SS2.SSSx2.p1.2.m2.1.1" xref="S5.SS2.SSSx2.p1.2.m2.1.1.cmml">0.5</mn><mo id="S5.SS2.SSSx2.p1.2.m2.3.4.3.2.2" xref="S5.SS2.SSSx2.p1.2.m2.3.4.3.1.cmml">,</mo><mn id="S5.SS2.SSSx2.p1.2.m2.2.2" xref="S5.SS2.SSSx2.p1.2.m2.2.2.cmml">0.1</mn><mo id="S5.SS2.SSSx2.p1.2.m2.3.4.3.2.3" xref="S5.SS2.SSSx2.p1.2.m2.3.4.3.1.cmml">,</mo><mn id="S5.SS2.SSSx2.p1.2.m2.3.3" xref="S5.SS2.SSSx2.p1.2.m2.3.3.cmml">0.05</mn><mo stretchy="false" id="S5.SS2.SSSx2.p1.2.m2.3.4.3.2.4" xref="S5.SS2.SSSx2.p1.2.m2.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSSx2.p1.2.m2.3b"><apply id="S5.SS2.SSSx2.p1.2.m2.3.4.cmml" xref="S5.SS2.SSSx2.p1.2.m2.3.4"><in id="S5.SS2.SSSx2.p1.2.m2.3.4.1.cmml" xref="S5.SS2.SSSx2.p1.2.m2.3.4.1"></in><ci id="S5.SS2.SSSx2.p1.2.m2.3.4.2.cmml" xref="S5.SS2.SSSx2.p1.2.m2.3.4.2">𝛽</ci><set id="S5.SS2.SSSx2.p1.2.m2.3.4.3.1.cmml" xref="S5.SS2.SSSx2.p1.2.m2.3.4.3.2"><cn type="float" id="S5.SS2.SSSx2.p1.2.m2.1.1.cmml" xref="S5.SS2.SSSx2.p1.2.m2.1.1">0.5</cn><cn type="float" id="S5.SS2.SSSx2.p1.2.m2.2.2.cmml" xref="S5.SS2.SSSx2.p1.2.m2.2.2">0.1</cn><cn type="float" id="S5.SS2.SSSx2.p1.2.m2.3.3.cmml" xref="S5.SS2.SSSx2.p1.2.m2.3.3">0.05</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSSx2.p1.2.m2.3c">\beta\in\{0.5,0.1,0.05\}</annotation></semantics></math>) and perform the experiment on CINIC-10 which is constructed from ImageNet <cite class="ltx_cite ltx_citemacro_citep">(Russakovsky et al. <a href="#bib.bib23" title="" class="ltx_ref">2015</a>)</cite> and CIFAR10. As the samples from CINIC-10 are not drawn from an identical distribution, we can naturally evaluate how sensitive each method is to the distribution shift. We tabulate the evaluation results on Table <a href="#S5.T3" title="Table 3 ‣ Heterogeneity ‣ 5.2 Experimental Results ‣ 5 Evaluations ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. We see that the state-of-the-art method, MOON, starts to largely lose accuracy as the level of heterogeneity increases. Specifically, when the local dataset is highly skewed (i.e., <math id="S5.SS2.SSSx2.p1.3.m3.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.SS2.SSSx2.p1.3.m3.1a"><mi id="S5.SS2.SSSx2.p1.3.m3.1.1" xref="S5.SS2.SSSx2.p1.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSSx2.p1.3.m3.1b"><ci id="S5.SS2.SSSx2.p1.3.m3.1.1.cmml" xref="S5.SS2.SSSx2.p1.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSSx2.p1.3.m3.1c">\beta</annotation></semantics></math> = 0.05), MOON shows roughly 10% lower accuracy than FedAvg. Similar observation is observed in recent work <cite class="ltx_cite ltx_citemacro_citep">(Luo et al. <a href="#bib.bib21" title="" class="ltx_ref">2021</a>)</cite>. In contrast, LfD consistently yields higher accuracy than other baselines. For the case where the training distribution is shifted, i.e., CINIC-10, we can see LfD still works well, revealing that LfD is robust on both the different levels and types of heterogeneity.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>(Heterogeneity) Top-1 Test Accuracy (%) on CIFAR-10 with different level of heterogeneity (<math id="S5.T3.2.m1.1" class="ltx_Math" alttext="\beta\in" display="inline"><semantics id="S5.T3.2.m1.1b"><mrow id="S5.T3.2.m1.1.1" xref="S5.T3.2.m1.1.1.cmml"><mi id="S5.T3.2.m1.1.1.2" xref="S5.T3.2.m1.1.1.2.cmml">β</mi><mo id="S5.T3.2.m1.1.1.1" xref="S5.T3.2.m1.1.1.1.cmml">∈</mo><mi id="S5.T3.2.m1.1.1.3" xref="S5.T3.2.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.2.m1.1c"><apply id="S5.T3.2.m1.1.1.cmml" xref="S5.T3.2.m1.1.1"><in id="S5.T3.2.m1.1.1.1.cmml" xref="S5.T3.2.m1.1.1.1"></in><ci id="S5.T3.2.m1.1.1.2.cmml" xref="S5.T3.2.m1.1.1.2">𝛽</ci><csymbol cd="latexml" id="S5.T3.2.m1.1.1.3.cmml" xref="S5.T3.2.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.m1.1d">\beta\in</annotation></semantics></math> {0.5, 0.1, 0.05}), and CINIC-10. Best and second best results are highlighted in <span id="S5.T3.28.1" class="ltx_text ltx_font_bold">boldface</span> and <span id="S5.T3.29.2" class="ltx_text ltx_framed ltx_framed_underline">underlined</span>, respectively.</figcaption>
<p id="S5.T3.25" class="ltx_p"><span id="S5.T3.25.23" class="ltx_text">
<span id="S5.T3.25.23.23" class="ltx_inline-block ltx_transformed_outer" style="width:293.1pt;height:108pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S5.T3.25.23.23.23" class="ltx_p"><span id="S5.T3.25.23.23.23.23" class="ltx_text">
<span id="S5.T3.25.23.23.23.23.23" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_thead">
<span id="S5.T3.5.3.3.3.3.3.3" class="ltx_tr">
<span id="S5.T3.5.3.3.3.3.3.3.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">Method</span>
<span id="S5.T3.3.1.1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="S5.T3.3.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\beta=0.5" display="inline"><semantics id="S5.T3.3.1.1.1.1.1.1.1.m1.1a"><mrow id="S5.T3.3.1.1.1.1.1.1.1.m1.1.1" xref="S5.T3.3.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S5.T3.3.1.1.1.1.1.1.1.m1.1.1.2" xref="S5.T3.3.1.1.1.1.1.1.1.m1.1.1.2.cmml">β</mi><mo id="S5.T3.3.1.1.1.1.1.1.1.m1.1.1.1" xref="S5.T3.3.1.1.1.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S5.T3.3.1.1.1.1.1.1.1.m1.1.1.3" xref="S5.T3.3.1.1.1.1.1.1.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.3.1.1.1.1.1.1.1.m1.1b"><apply id="S5.T3.3.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S5.T3.3.1.1.1.1.1.1.1.m1.1.1"><eq id="S5.T3.3.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S5.T3.3.1.1.1.1.1.1.1.m1.1.1.1"></eq><ci id="S5.T3.3.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S5.T3.3.1.1.1.1.1.1.1.m1.1.1.2">𝛽</ci><cn type="float" id="S5.T3.3.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S5.T3.3.1.1.1.1.1.1.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.1.1.1.1.1.1.1.m1.1c">\beta=0.5</annotation></semantics></math></span>
<span id="S5.T3.4.2.2.2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="S5.T3.4.2.2.2.2.2.2.2.m1.1" class="ltx_Math" alttext="\beta=0.1" display="inline"><semantics id="S5.T3.4.2.2.2.2.2.2.2.m1.1a"><mrow id="S5.T3.4.2.2.2.2.2.2.2.m1.1.1" xref="S5.T3.4.2.2.2.2.2.2.2.m1.1.1.cmml"><mi id="S5.T3.4.2.2.2.2.2.2.2.m1.1.1.2" xref="S5.T3.4.2.2.2.2.2.2.2.m1.1.1.2.cmml">β</mi><mo id="S5.T3.4.2.2.2.2.2.2.2.m1.1.1.1" xref="S5.T3.4.2.2.2.2.2.2.2.m1.1.1.1.cmml">=</mo><mn id="S5.T3.4.2.2.2.2.2.2.2.m1.1.1.3" xref="S5.T3.4.2.2.2.2.2.2.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.4.2.2.2.2.2.2.2.m1.1b"><apply id="S5.T3.4.2.2.2.2.2.2.2.m1.1.1.cmml" xref="S5.T3.4.2.2.2.2.2.2.2.m1.1.1"><eq id="S5.T3.4.2.2.2.2.2.2.2.m1.1.1.1.cmml" xref="S5.T3.4.2.2.2.2.2.2.2.m1.1.1.1"></eq><ci id="S5.T3.4.2.2.2.2.2.2.2.m1.1.1.2.cmml" xref="S5.T3.4.2.2.2.2.2.2.2.m1.1.1.2">𝛽</ci><cn type="float" id="S5.T3.4.2.2.2.2.2.2.2.m1.1.1.3.cmml" xref="S5.T3.4.2.2.2.2.2.2.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.2.2.2.2.2.2.2.m1.1c">\beta=0.1</annotation></semantics></math></span>
<span id="S5.T3.5.3.3.3.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="S5.T3.5.3.3.3.3.3.3.3.m1.1" class="ltx_Math" alttext="\beta=0.05" display="inline"><semantics id="S5.T3.5.3.3.3.3.3.3.3.m1.1a"><mrow id="S5.T3.5.3.3.3.3.3.3.3.m1.1.1" xref="S5.T3.5.3.3.3.3.3.3.3.m1.1.1.cmml"><mi id="S5.T3.5.3.3.3.3.3.3.3.m1.1.1.2" xref="S5.T3.5.3.3.3.3.3.3.3.m1.1.1.2.cmml">β</mi><mo id="S5.T3.5.3.3.3.3.3.3.3.m1.1.1.1" xref="S5.T3.5.3.3.3.3.3.3.3.m1.1.1.1.cmml">=</mo><mn id="S5.T3.5.3.3.3.3.3.3.3.m1.1.1.3" xref="S5.T3.5.3.3.3.3.3.3.3.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.5.3.3.3.3.3.3.3.m1.1b"><apply id="S5.T3.5.3.3.3.3.3.3.3.m1.1.1.cmml" xref="S5.T3.5.3.3.3.3.3.3.3.m1.1.1"><eq id="S5.T3.5.3.3.3.3.3.3.3.m1.1.1.1.cmml" xref="S5.T3.5.3.3.3.3.3.3.3.m1.1.1.1"></eq><ci id="S5.T3.5.3.3.3.3.3.3.3.m1.1.1.2.cmml" xref="S5.T3.5.3.3.3.3.3.3.3.m1.1.1.2">𝛽</ci><cn type="float" id="S5.T3.5.3.3.3.3.3.3.3.m1.1.1.3.cmml" xref="S5.T3.5.3.3.3.3.3.3.3.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.5.3.3.3.3.3.3.3.m1.1c">\beta=0.05</annotation></semantics></math></span>
<span id="S5.T3.5.3.3.3.3.3.3.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">CINIC-10</span></span>
</span>
<span class="ltx_tbody">
<span id="S5.T3.9.7.7.7.7.7.7" class="ltx_tr">
<span id="S5.T3.9.7.7.7.7.7.7.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">FedAvg</span>
<span id="S5.T3.6.4.4.4.4.4.4.1" class="ltx_td ltx_align_center ltx_border_t">69.1 <math id="S5.T3.6.4.4.4.4.4.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.6.4.4.4.4.4.4.1.m1.1a"><mo id="S5.T3.6.4.4.4.4.4.4.1.m1.1.1" xref="S5.T3.6.4.4.4.4.4.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.6.4.4.4.4.4.4.1.m1.1b"><csymbol cd="latexml" id="S5.T3.6.4.4.4.4.4.4.1.m1.1.1.cmml" xref="S5.T3.6.4.4.4.4.4.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.6.4.4.4.4.4.4.1.m1.1c">\pm</annotation></semantics></math> 0.6</span>
<span id="S5.T3.7.5.5.5.5.5.5.2" class="ltx_td ltx_align_center ltx_border_t">62.4 <math id="S5.T3.7.5.5.5.5.5.5.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.7.5.5.5.5.5.5.2.m1.1a"><mo id="S5.T3.7.5.5.5.5.5.5.2.m1.1.1" xref="S5.T3.7.5.5.5.5.5.5.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.7.5.5.5.5.5.5.2.m1.1b"><csymbol cd="latexml" id="S5.T3.7.5.5.5.5.5.5.2.m1.1.1.cmml" xref="S5.T3.7.5.5.5.5.5.5.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.7.5.5.5.5.5.5.2.m1.1c">\pm</annotation></semantics></math> 1.1</span>
<span id="S5.T3.8.6.6.6.6.6.6.3" class="ltx_td ltx_align_center ltx_border_t">55.3 <math id="S5.T3.8.6.6.6.6.6.6.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.8.6.6.6.6.6.6.3.m1.1a"><mo id="S5.T3.8.6.6.6.6.6.6.3.m1.1.1" xref="S5.T3.8.6.6.6.6.6.6.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.8.6.6.6.6.6.6.3.m1.1b"><csymbol cd="latexml" id="S5.T3.8.6.6.6.6.6.6.3.m1.1.1.cmml" xref="S5.T3.8.6.6.6.6.6.6.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.8.6.6.6.6.6.6.3.m1.1c">\pm</annotation></semantics></math> 0.4</span>
<span id="S5.T3.9.7.7.7.7.7.7.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">74.2 <math id="S5.T3.9.7.7.7.7.7.7.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.9.7.7.7.7.7.7.4.m1.1a"><mo id="S5.T3.9.7.7.7.7.7.7.4.m1.1.1" xref="S5.T3.9.7.7.7.7.7.7.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.9.7.7.7.7.7.7.4.m1.1b"><csymbol cd="latexml" id="S5.T3.9.7.7.7.7.7.7.4.m1.1.1.cmml" xref="S5.T3.9.7.7.7.7.7.7.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.9.7.7.7.7.7.7.4.m1.1c">\pm</annotation></semantics></math> 1.9</span></span>
<span id="S5.T3.13.11.11.11.11.11.11" class="ltx_tr">
<span id="S5.T3.13.11.11.11.11.11.11.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedAvgM</span>
<span id="S5.T3.10.8.8.8.8.8.8.1" class="ltx_td ltx_align_center">69.9 <math id="S5.T3.10.8.8.8.8.8.8.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.10.8.8.8.8.8.8.1.m1.1a"><mo id="S5.T3.10.8.8.8.8.8.8.1.m1.1.1" xref="S5.T3.10.8.8.8.8.8.8.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.10.8.8.8.8.8.8.1.m1.1b"><csymbol cd="latexml" id="S5.T3.10.8.8.8.8.8.8.1.m1.1.1.cmml" xref="S5.T3.10.8.8.8.8.8.8.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.10.8.8.8.8.8.8.1.m1.1c">\pm</annotation></semantics></math> 1.1</span>
<span id="S5.T3.11.9.9.9.9.9.9.2" class="ltx_td ltx_align_center"><span id="S5.T3.11.9.9.9.9.9.9.2.1" class="ltx_text ltx_framed ltx_framed_underline">63.4</span> <math id="S5.T3.11.9.9.9.9.9.9.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.11.9.9.9.9.9.9.2.m1.1a"><mo id="S5.T3.11.9.9.9.9.9.9.2.m1.1.1" xref="S5.T3.11.9.9.9.9.9.9.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.11.9.9.9.9.9.9.2.m1.1b"><csymbol cd="latexml" id="S5.T3.11.9.9.9.9.9.9.2.m1.1.1.cmml" xref="S5.T3.11.9.9.9.9.9.9.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.11.9.9.9.9.9.9.2.m1.1c">\pm</annotation></semantics></math> 1.3</span>
<span id="S5.T3.12.10.10.10.10.10.10.3" class="ltx_td ltx_align_center"><span id="S5.T3.12.10.10.10.10.10.10.3.1" class="ltx_text ltx_framed ltx_framed_underline">55.9</span> <math id="S5.T3.12.10.10.10.10.10.10.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.12.10.10.10.10.10.10.3.m1.1a"><mo id="S5.T3.12.10.10.10.10.10.10.3.m1.1.1" xref="S5.T3.12.10.10.10.10.10.10.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.12.10.10.10.10.10.10.3.m1.1b"><csymbol cd="latexml" id="S5.T3.12.10.10.10.10.10.10.3.m1.1.1.cmml" xref="S5.T3.12.10.10.10.10.10.10.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.12.10.10.10.10.10.10.3.m1.1c">\pm</annotation></semantics></math> 0.9</span>
<span id="S5.T3.13.11.11.11.11.11.11.4" class="ltx_td ltx_nopad_r ltx_align_center">74.8 <math id="S5.T3.13.11.11.11.11.11.11.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.13.11.11.11.11.11.11.4.m1.1a"><mo id="S5.T3.13.11.11.11.11.11.11.4.m1.1.1" xref="S5.T3.13.11.11.11.11.11.11.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.13.11.11.11.11.11.11.4.m1.1b"><csymbol cd="latexml" id="S5.T3.13.11.11.11.11.11.11.4.m1.1.1.cmml" xref="S5.T3.13.11.11.11.11.11.11.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.13.11.11.11.11.11.11.4.m1.1c">\pm</annotation></semantics></math> 0.3</span></span>
<span id="S5.T3.17.15.15.15.15.15.15" class="ltx_tr">
<span id="S5.T3.17.15.15.15.15.15.15.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedProx</span>
<span id="S5.T3.14.12.12.12.12.12.12.1" class="ltx_td ltx_align_center">68.6 <math id="S5.T3.14.12.12.12.12.12.12.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.14.12.12.12.12.12.12.1.m1.1a"><mo id="S5.T3.14.12.12.12.12.12.12.1.m1.1.1" xref="S5.T3.14.12.12.12.12.12.12.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.14.12.12.12.12.12.12.1.m1.1b"><csymbol cd="latexml" id="S5.T3.14.12.12.12.12.12.12.1.m1.1.1.cmml" xref="S5.T3.14.12.12.12.12.12.12.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.14.12.12.12.12.12.12.1.m1.1c">\pm</annotation></semantics></math> 0.9</span>
<span id="S5.T3.15.13.13.13.13.13.13.2" class="ltx_td ltx_align_center">63.1 <math id="S5.T3.15.13.13.13.13.13.13.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.15.13.13.13.13.13.13.2.m1.1a"><mo id="S5.T3.15.13.13.13.13.13.13.2.m1.1.1" xref="S5.T3.15.13.13.13.13.13.13.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.15.13.13.13.13.13.13.2.m1.1b"><csymbol cd="latexml" id="S5.T3.15.13.13.13.13.13.13.2.m1.1.1.cmml" xref="S5.T3.15.13.13.13.13.13.13.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.15.13.13.13.13.13.13.2.m1.1c">\pm</annotation></semantics></math> 0.4</span>
<span id="S5.T3.16.14.14.14.14.14.14.3" class="ltx_td ltx_align_center">54.9 <math id="S5.T3.16.14.14.14.14.14.14.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.16.14.14.14.14.14.14.3.m1.1a"><mo id="S5.T3.16.14.14.14.14.14.14.3.m1.1.1" xref="S5.T3.16.14.14.14.14.14.14.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.16.14.14.14.14.14.14.3.m1.1b"><csymbol cd="latexml" id="S5.T3.16.14.14.14.14.14.14.3.m1.1.1.cmml" xref="S5.T3.16.14.14.14.14.14.14.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.16.14.14.14.14.14.14.3.m1.1c">\pm</annotation></semantics></math> 0.8</span>
<span id="S5.T3.17.15.15.15.15.15.15.4" class="ltx_td ltx_nopad_r ltx_align_center">73.9 <math id="S5.T3.17.15.15.15.15.15.15.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.17.15.15.15.15.15.15.4.m1.1a"><mo id="S5.T3.17.15.15.15.15.15.15.4.m1.1.1" xref="S5.T3.17.15.15.15.15.15.15.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.17.15.15.15.15.15.15.4.m1.1b"><csymbol cd="latexml" id="S5.T3.17.15.15.15.15.15.15.4.m1.1.1.cmml" xref="S5.T3.17.15.15.15.15.15.15.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.17.15.15.15.15.15.15.4.m1.1c">\pm</annotation></semantics></math> 1.5</span></span>
<span id="S5.T3.21.19.19.19.19.19.19" class="ltx_tr">
<span id="S5.T3.21.19.19.19.19.19.19.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">MOON</span>
<span id="S5.T3.18.16.16.16.16.16.16.1" class="ltx_td ltx_align_center"><span id="S5.T3.18.16.16.16.16.16.16.1.1" class="ltx_text ltx_framed ltx_framed_underline">71.2</span> <math id="S5.T3.18.16.16.16.16.16.16.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.18.16.16.16.16.16.16.1.m1.1a"><mo id="S5.T3.18.16.16.16.16.16.16.1.m1.1.1" xref="S5.T3.18.16.16.16.16.16.16.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.18.16.16.16.16.16.16.1.m1.1b"><csymbol cd="latexml" id="S5.T3.18.16.16.16.16.16.16.1.m1.1.1.cmml" xref="S5.T3.18.16.16.16.16.16.16.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.18.16.16.16.16.16.16.1.m1.1c">\pm</annotation></semantics></math> 0.5</span>
<span id="S5.T3.19.17.17.17.17.17.17.2" class="ltx_td ltx_align_center">61.6 <math id="S5.T3.19.17.17.17.17.17.17.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.19.17.17.17.17.17.17.2.m1.1a"><mo id="S5.T3.19.17.17.17.17.17.17.2.m1.1.1" xref="S5.T3.19.17.17.17.17.17.17.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.19.17.17.17.17.17.17.2.m1.1b"><csymbol cd="latexml" id="S5.T3.19.17.17.17.17.17.17.2.m1.1.1.cmml" xref="S5.T3.19.17.17.17.17.17.17.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.19.17.17.17.17.17.17.2.m1.1c">\pm</annotation></semantics></math> 0.7</span>
<span id="S5.T3.20.18.18.18.18.18.18.3" class="ltx_td ltx_align_center">50.9 <math id="S5.T3.20.18.18.18.18.18.18.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.20.18.18.18.18.18.18.3.m1.1a"><mo id="S5.T3.20.18.18.18.18.18.18.3.m1.1.1" xref="S5.T3.20.18.18.18.18.18.18.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.20.18.18.18.18.18.18.3.m1.1b"><csymbol cd="latexml" id="S5.T3.20.18.18.18.18.18.18.3.m1.1.1.cmml" xref="S5.T3.20.18.18.18.18.18.18.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.20.18.18.18.18.18.18.3.m1.1c">\pm</annotation></semantics></math> 2.1</span>
<span id="S5.T3.21.19.19.19.19.19.19.4" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.T3.21.19.19.19.19.19.19.4.1" class="ltx_text ltx_framed ltx_framed_underline">77.1</span> <math id="S5.T3.21.19.19.19.19.19.19.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.21.19.19.19.19.19.19.4.m1.1a"><mo id="S5.T3.21.19.19.19.19.19.19.4.m1.1.1" xref="S5.T3.21.19.19.19.19.19.19.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.21.19.19.19.19.19.19.4.m1.1b"><csymbol cd="latexml" id="S5.T3.21.19.19.19.19.19.19.4.m1.1.1.cmml" xref="S5.T3.21.19.19.19.19.19.19.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.21.19.19.19.19.19.19.4.m1.1c">\pm</annotation></semantics></math> 1.7</span></span>
<span id="S5.T3.25.23.23.23.23.23.23" class="ltx_tr">
<span id="S5.T3.25.23.23.23.23.23.23.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">LfD (ours)</span>
<span id="S5.T3.22.20.20.20.20.20.20.1" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T3.22.20.20.20.20.20.20.1.1" class="ltx_text ltx_font_bold">74.1</span> <math id="S5.T3.22.20.20.20.20.20.20.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.22.20.20.20.20.20.20.1.m1.1a"><mo id="S5.T3.22.20.20.20.20.20.20.1.m1.1.1" xref="S5.T3.22.20.20.20.20.20.20.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.22.20.20.20.20.20.20.1.m1.1b"><csymbol cd="latexml" id="S5.T3.22.20.20.20.20.20.20.1.m1.1.1.cmml" xref="S5.T3.22.20.20.20.20.20.20.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.22.20.20.20.20.20.20.1.m1.1c">\pm</annotation></semantics></math> 0.4</span>
<span id="S5.T3.23.21.21.21.21.21.21.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T3.23.21.21.21.21.21.21.2.1" class="ltx_text ltx_font_bold">65.1</span> <math id="S5.T3.23.21.21.21.21.21.21.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.23.21.21.21.21.21.21.2.m1.1a"><mo id="S5.T3.23.21.21.21.21.21.21.2.m1.1.1" xref="S5.T3.23.21.21.21.21.21.21.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.23.21.21.21.21.21.21.2.m1.1b"><csymbol cd="latexml" id="S5.T3.23.21.21.21.21.21.21.2.m1.1.1.cmml" xref="S5.T3.23.21.21.21.21.21.21.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.23.21.21.21.21.21.21.2.m1.1c">\pm</annotation></semantics></math> 0.3</span>
<span id="S5.T3.24.22.22.22.22.22.22.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T3.24.22.22.22.22.22.22.3.1" class="ltx_text ltx_font_bold">58.2</span> <math id="S5.T3.24.22.22.22.22.22.22.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.24.22.22.22.22.22.22.3.m1.1a"><mo id="S5.T3.24.22.22.22.22.22.22.3.m1.1.1" xref="S5.T3.24.22.22.22.22.22.22.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.24.22.22.22.22.22.22.3.m1.1b"><csymbol cd="latexml" id="S5.T3.24.22.22.22.22.22.22.3.m1.1.1.cmml" xref="S5.T3.24.22.22.22.22.22.22.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.24.22.22.22.22.22.22.3.m1.1c">\pm</annotation></semantics></math> 0.6</span>
<span id="S5.T3.25.23.23.23.23.23.23.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb"><span id="S5.T3.25.23.23.23.23.23.23.4.1" class="ltx_text ltx_font_bold">79.8</span> <math id="S5.T3.25.23.23.23.23.23.23.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.25.23.23.23.23.23.23.4.m1.1a"><mo id="S5.T3.25.23.23.23.23.23.23.4.m1.1.1" xref="S5.T3.25.23.23.23.23.23.23.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.25.23.23.23.23.23.23.4.m1.1b"><csymbol cd="latexml" id="S5.T3.25.23.23.23.23.23.23.4.m1.1.1.cmml" xref="S5.T3.25.23.23.23.23.23.23.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.25.23.23.23.23.23.23.4.m1.1c">\pm</annotation></semantics></math> 1.1</span></span>
</span>
</span></span></span>
</span></span></span></p>
</figure>
</section>
<section id="S5.SS2.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Scalability</h4>

<div id="S5.SS2.SSSx3.p1" class="ltx_para">
<p id="S5.SS2.SSSx3.p1.1" class="ltx_p">We evaluate the scalability to verify that each method can be extended to the more realistic scenario, i.e., the more number of clients and the randomly active clients. For the evaluation, we increase the number of clients to 50 and 100, i.e., <math id="S5.SS2.SSSx3.p1.1.m1.2" class="ltx_Math" alttext="K\in\{50,100\}" display="inline"><semantics id="S5.SS2.SSSx3.p1.1.m1.2a"><mrow id="S5.SS2.SSSx3.p1.1.m1.2.3" xref="S5.SS2.SSSx3.p1.1.m1.2.3.cmml"><mi id="S5.SS2.SSSx3.p1.1.m1.2.3.2" xref="S5.SS2.SSSx3.p1.1.m1.2.3.2.cmml">K</mi><mo id="S5.SS2.SSSx3.p1.1.m1.2.3.1" xref="S5.SS2.SSSx3.p1.1.m1.2.3.1.cmml">∈</mo><mrow id="S5.SS2.SSSx3.p1.1.m1.2.3.3.2" xref="S5.SS2.SSSx3.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S5.SS2.SSSx3.p1.1.m1.2.3.3.2.1" xref="S5.SS2.SSSx3.p1.1.m1.2.3.3.1.cmml">{</mo><mn id="S5.SS2.SSSx3.p1.1.m1.1.1" xref="S5.SS2.SSSx3.p1.1.m1.1.1.cmml">50</mn><mo id="S5.SS2.SSSx3.p1.1.m1.2.3.3.2.2" xref="S5.SS2.SSSx3.p1.1.m1.2.3.3.1.cmml">,</mo><mn id="S5.SS2.SSSx3.p1.1.m1.2.2" xref="S5.SS2.SSSx3.p1.1.m1.2.2.cmml">100</mn><mo stretchy="false" id="S5.SS2.SSSx3.p1.1.m1.2.3.3.2.3" xref="S5.SS2.SSSx3.p1.1.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSSx3.p1.1.m1.2b"><apply id="S5.SS2.SSSx3.p1.1.m1.2.3.cmml" xref="S5.SS2.SSSx3.p1.1.m1.2.3"><in id="S5.SS2.SSSx3.p1.1.m1.2.3.1.cmml" xref="S5.SS2.SSSx3.p1.1.m1.2.3.1"></in><ci id="S5.SS2.SSSx3.p1.1.m1.2.3.2.cmml" xref="S5.SS2.SSSx3.p1.1.m1.2.3.2">𝐾</ci><set id="S5.SS2.SSSx3.p1.1.m1.2.3.3.1.cmml" xref="S5.SS2.SSSx3.p1.1.m1.2.3.3.2"><cn type="integer" id="S5.SS2.SSSx3.p1.1.m1.1.1.cmml" xref="S5.SS2.SSSx3.p1.1.m1.1.1">50</cn><cn type="integer" id="S5.SS2.SSSx3.p1.1.m1.2.2.cmml" xref="S5.SS2.SSSx3.p1.1.m1.2.2">100</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSSx3.p1.1.m1.2c">K\in\{50,100\}</annotation></semantics></math>, while decreasing the active clients<span id="footnote7" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span>We denote <span id="footnote7.1" class="ltx_text ltx_font_italic">active client</span> as the clients who participate in the aggregation in Eq. (<a href="#S2.E2" title="In 2 Problem setup ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).</span></span></span> to 25% and 50%. The overall results are shown in Table <a href="#S5.T4" title="Table 4 ‣ Scalability ‣ 5.2 Experimental Results ‣ 5 Evaluations ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. It can be observed that increasing the number of clients and reducing the percentage of active clients degrades the performance of all methods because these adjustments can be one of the factors increasing the heterogeneity. However, LfD outperforms all baselines in all settings, demonstrating that Lfd performs well on the more realistic scenarios.</p>
</div>
<figure id="S5.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>(Scalability) Top-1 Test Accuracy (%) on CIFAR-10 with different number of participants (<math id="S5.T4.3.m1.1" class="ltx_Math" alttext="|\mathcal{P}|\in" display="inline"><semantics id="S5.T4.3.m1.1b"><mrow id="S5.T4.3.m1.1.2" xref="S5.T4.3.m1.1.2.cmml"><mrow id="S5.T4.3.m1.1.2.2.2" xref="S5.T4.3.m1.1.2.2.1.cmml"><mo stretchy="false" id="S5.T4.3.m1.1.2.2.2.1" xref="S5.T4.3.m1.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S5.T4.3.m1.1.1" xref="S5.T4.3.m1.1.1.cmml">𝒫</mi><mo stretchy="false" id="S5.T4.3.m1.1.2.2.2.2" xref="S5.T4.3.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S5.T4.3.m1.1.2.1" xref="S5.T4.3.m1.1.2.1.cmml">∈</mo><mi id="S5.T4.3.m1.1.2.3" xref="S5.T4.3.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.3.m1.1c"><apply id="S5.T4.3.m1.1.2.cmml" xref="S5.T4.3.m1.1.2"><in id="S5.T4.3.m1.1.2.1.cmml" xref="S5.T4.3.m1.1.2.1"></in><apply id="S5.T4.3.m1.1.2.2.1.cmml" xref="S5.T4.3.m1.1.2.2.2"><abs id="S5.T4.3.m1.1.2.2.1.1.cmml" xref="S5.T4.3.m1.1.2.2.2.1"></abs><ci id="S5.T4.3.m1.1.1.cmml" xref="S5.T4.3.m1.1.1">𝒫</ci></apply><csymbol cd="latexml" id="S5.T4.3.m1.1.2.3.cmml" xref="S5.T4.3.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.3.m1.1d">|\mathcal{P}|\in</annotation></semantics></math> {10, 50, 100}) and active clients in each communication(<math id="S5.T4.4.m2.2" class="ltx_Math" alttext="r\in\{0.25,0.5\}" display="inline"><semantics id="S5.T4.4.m2.2b"><mrow id="S5.T4.4.m2.2.3" xref="S5.T4.4.m2.2.3.cmml"><mi id="S5.T4.4.m2.2.3.2" xref="S5.T4.4.m2.2.3.2.cmml">r</mi><mo id="S5.T4.4.m2.2.3.1" xref="S5.T4.4.m2.2.3.1.cmml">∈</mo><mrow id="S5.T4.4.m2.2.3.3.2" xref="S5.T4.4.m2.2.3.3.1.cmml"><mo stretchy="false" id="S5.T4.4.m2.2.3.3.2.1" xref="S5.T4.4.m2.2.3.3.1.cmml">{</mo><mn id="S5.T4.4.m2.1.1" xref="S5.T4.4.m2.1.1.cmml">0.25</mn><mo id="S5.T4.4.m2.2.3.3.2.2" xref="S5.T4.4.m2.2.3.3.1.cmml">,</mo><mn id="S5.T4.4.m2.2.2" xref="S5.T4.4.m2.2.2.cmml">0.5</mn><mo stretchy="false" id="S5.T4.4.m2.2.3.3.2.3" xref="S5.T4.4.m2.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.4.m2.2c"><apply id="S5.T4.4.m2.2.3.cmml" xref="S5.T4.4.m2.2.3"><in id="S5.T4.4.m2.2.3.1.cmml" xref="S5.T4.4.m2.2.3.1"></in><ci id="S5.T4.4.m2.2.3.2.cmml" xref="S5.T4.4.m2.2.3.2">𝑟</ci><set id="S5.T4.4.m2.2.3.3.1.cmml" xref="S5.T4.4.m2.2.3.3.2"><cn type="float" id="S5.T4.4.m2.1.1.cmml" xref="S5.T4.4.m2.1.1">0.25</cn><cn type="float" id="S5.T4.4.m2.2.2.cmml" xref="S5.T4.4.m2.2.2">0.5</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.4.m2.2d">r\in\{0.25,0.5\}</annotation></semantics></math>). Best and second best results are highlighted in <span id="S5.T4.33.1" class="ltx_text ltx_font_bold">boldface</span> and <span id="S5.T4.34.2" class="ltx_text ltx_framed ltx_framed_underline">underlined</span>, respectively.</figcaption>
<p id="S5.T4.30" class="ltx_p ltx_align_center"><span id="S5.T4.30.26" class="ltx_text">
<span id="S5.T4.30.26.26" class="ltx_inline-block ltx_transformed_outer" style="width:309.8pt;height:126pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S5.T4.30.26.26.26" class="ltx_p"><span id="S5.T4.30.26.26.26.26" class="ltx_text">
<span id="S5.T4.30.26.26.26.26.26" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_thead">
<span id="S5.T4.6.2.2.2.2.2.2" class="ltx_tr">
<span id="S5.T4.6.2.2.2.2.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt ltx_rowspan ltx_rowspan_2"><span id="S5.T4.6.2.2.2.2.2.2.3.1" class="ltx_text">Method</span></span>
<span id="S5.T4.5.1.1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_2"><math id="S5.T4.5.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.T4.5.1.1.1.1.1.1.1.m1.1a"><mi id="S5.T4.5.1.1.1.1.1.1.1.m1.1.1" xref="S5.T4.5.1.1.1.1.1.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.T4.5.1.1.1.1.1.1.1.m1.1b"><ci id="S5.T4.5.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S5.T4.5.1.1.1.1.1.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.5.1.1.1.1.1.1.1.m1.1c">K</annotation></semantics></math> = 50</span>
<span id="S5.T4.6.2.2.2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_2"><math id="S5.T4.6.2.2.2.2.2.2.2.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.T4.6.2.2.2.2.2.2.2.m1.1a"><mi id="S5.T4.6.2.2.2.2.2.2.2.m1.1.1" xref="S5.T4.6.2.2.2.2.2.2.2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.T4.6.2.2.2.2.2.2.2.m1.1b"><ci id="S5.T4.6.2.2.2.2.2.2.2.m1.1.1.cmml" xref="S5.T4.6.2.2.2.2.2.2.2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.6.2.2.2.2.2.2.2.m1.1c">K</annotation></semantics></math> = 100</span></span>
<span id="S5.T4.10.6.6.6.6.6.6" class="ltx_tr">
<span id="S5.T4.7.3.3.3.3.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><math id="S5.T4.7.3.3.3.3.3.3.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S5.T4.7.3.3.3.3.3.3.1.m1.1a"><mi id="S5.T4.7.3.3.3.3.3.3.1.m1.1.1" xref="S5.T4.7.3.3.3.3.3.3.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S5.T4.7.3.3.3.3.3.3.1.m1.1b"><ci id="S5.T4.7.3.3.3.3.3.3.1.m1.1.1.cmml" xref="S5.T4.7.3.3.3.3.3.3.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.7.3.3.3.3.3.3.1.m1.1c">r</annotation></semantics></math> = 0.25</span>
<span id="S5.T4.8.4.4.4.4.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><math id="S5.T4.8.4.4.4.4.4.4.2.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S5.T4.8.4.4.4.4.4.4.2.m1.1a"><mi id="S5.T4.8.4.4.4.4.4.4.2.m1.1.1" xref="S5.T4.8.4.4.4.4.4.4.2.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S5.T4.8.4.4.4.4.4.4.2.m1.1b"><ci id="S5.T4.8.4.4.4.4.4.4.2.m1.1.1.cmml" xref="S5.T4.8.4.4.4.4.4.4.2.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.8.4.4.4.4.4.4.2.m1.1c">r</annotation></semantics></math> = 0.5</span>
<span id="S5.T4.9.5.5.5.5.5.5.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><math id="S5.T4.9.5.5.5.5.5.5.3.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S5.T4.9.5.5.5.5.5.5.3.m1.1a"><mi id="S5.T4.9.5.5.5.5.5.5.3.m1.1.1" xref="S5.T4.9.5.5.5.5.5.5.3.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S5.T4.9.5.5.5.5.5.5.3.m1.1b"><ci id="S5.T4.9.5.5.5.5.5.5.3.m1.1.1.cmml" xref="S5.T4.9.5.5.5.5.5.5.3.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.9.5.5.5.5.5.5.3.m1.1c">r</annotation></semantics></math> = 0.25</span>
<span id="S5.T4.10.6.6.6.6.6.6.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><math id="S5.T4.10.6.6.6.6.6.6.4.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S5.T4.10.6.6.6.6.6.6.4.m1.1a"><mi id="S5.T4.10.6.6.6.6.6.6.4.m1.1.1" xref="S5.T4.10.6.6.6.6.6.6.4.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S5.T4.10.6.6.6.6.6.6.4.m1.1b"><ci id="S5.T4.10.6.6.6.6.6.6.4.m1.1.1.cmml" xref="S5.T4.10.6.6.6.6.6.6.4.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.10.6.6.6.6.6.6.4.m1.1c">r</annotation></semantics></math> = 0.5</span></span>
</span>
<span class="ltx_tbody">
<span id="S5.T4.14.10.10.10.10.10.10" class="ltx_tr">
<span id="S5.T4.14.10.10.10.10.10.10.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">FedAvg</span>
<span id="S5.T4.11.7.7.7.7.7.7.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.11.7.7.7.7.7.7.1.1" class="ltx_text ltx_framed ltx_framed_underline">61.6</span> <math id="S5.T4.11.7.7.7.7.7.7.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.11.7.7.7.7.7.7.1.m1.1a"><mo id="S5.T4.11.7.7.7.7.7.7.1.m1.1.1" xref="S5.T4.11.7.7.7.7.7.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.11.7.7.7.7.7.7.1.m1.1b"><csymbol cd="latexml" id="S5.T4.11.7.7.7.7.7.7.1.m1.1.1.cmml" xref="S5.T4.11.7.7.7.7.7.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.11.7.7.7.7.7.7.1.m1.1c">\pm</annotation></semantics></math> 1.5</span>
<span id="S5.T4.12.8.8.8.8.8.8.2" class="ltx_td ltx_align_center ltx_border_t">62.6 <math id="S5.T4.12.8.8.8.8.8.8.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.12.8.8.8.8.8.8.2.m1.1a"><mo id="S5.T4.12.8.8.8.8.8.8.2.m1.1.1" xref="S5.T4.12.8.8.8.8.8.8.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.12.8.8.8.8.8.8.2.m1.1b"><csymbol cd="latexml" id="S5.T4.12.8.8.8.8.8.8.2.m1.1.1.cmml" xref="S5.T4.12.8.8.8.8.8.8.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.12.8.8.8.8.8.8.2.m1.1c">\pm</annotation></semantics></math> 0.8</span>
<span id="S5.T4.13.9.9.9.9.9.9.3" class="ltx_td ltx_align_center ltx_border_t">55.8 <math id="S5.T4.13.9.9.9.9.9.9.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.13.9.9.9.9.9.9.3.m1.1a"><mo id="S5.T4.13.9.9.9.9.9.9.3.m1.1.1" xref="S5.T4.13.9.9.9.9.9.9.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.13.9.9.9.9.9.9.3.m1.1b"><csymbol cd="latexml" id="S5.T4.13.9.9.9.9.9.9.3.m1.1.1.cmml" xref="S5.T4.13.9.9.9.9.9.9.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.13.9.9.9.9.9.9.3.m1.1c">\pm</annotation></semantics></math> 2.3</span>
<span id="S5.T4.14.10.10.10.10.10.10.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">58.3 <math id="S5.T4.14.10.10.10.10.10.10.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.14.10.10.10.10.10.10.4.m1.1a"><mo id="S5.T4.14.10.10.10.10.10.10.4.m1.1.1" xref="S5.T4.14.10.10.10.10.10.10.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.14.10.10.10.10.10.10.4.m1.1b"><csymbol cd="latexml" id="S5.T4.14.10.10.10.10.10.10.4.m1.1.1.cmml" xref="S5.T4.14.10.10.10.10.10.10.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.14.10.10.10.10.10.10.4.m1.1c">\pm</annotation></semantics></math> 1.6</span></span>
<span id="S5.T4.18.14.14.14.14.14.14" class="ltx_tr">
<span id="S5.T4.18.14.14.14.14.14.14.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedAvgM</span>
<span id="S5.T4.15.11.11.11.11.11.11.1" class="ltx_td ltx_align_center">60.6 <math id="S5.T4.15.11.11.11.11.11.11.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.15.11.11.11.11.11.11.1.m1.1a"><mo id="S5.T4.15.11.11.11.11.11.11.1.m1.1.1" xref="S5.T4.15.11.11.11.11.11.11.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.15.11.11.11.11.11.11.1.m1.1b"><csymbol cd="latexml" id="S5.T4.15.11.11.11.11.11.11.1.m1.1.1.cmml" xref="S5.T4.15.11.11.11.11.11.11.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.15.11.11.11.11.11.11.1.m1.1c">\pm</annotation></semantics></math> 0.8</span>
<span id="S5.T4.16.12.12.12.12.12.12.2" class="ltx_td ltx_align_center">61.5 <math id="S5.T4.16.12.12.12.12.12.12.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.16.12.12.12.12.12.12.2.m1.1a"><mo id="S5.T4.16.12.12.12.12.12.12.2.m1.1.1" xref="S5.T4.16.12.12.12.12.12.12.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.16.12.12.12.12.12.12.2.m1.1b"><csymbol cd="latexml" id="S5.T4.16.12.12.12.12.12.12.2.m1.1.1.cmml" xref="S5.T4.16.12.12.12.12.12.12.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.16.12.12.12.12.12.12.2.m1.1c">\pm</annotation></semantics></math> 0.2</span>
<span id="S5.T4.17.13.13.13.13.13.13.3" class="ltx_td ltx_align_center"><span id="S5.T4.17.13.13.13.13.13.13.3.1" class="ltx_text ltx_framed ltx_framed_underline">59.5</span> <math id="S5.T4.17.13.13.13.13.13.13.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.17.13.13.13.13.13.13.3.m1.1a"><mo id="S5.T4.17.13.13.13.13.13.13.3.m1.1.1" xref="S5.T4.17.13.13.13.13.13.13.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.17.13.13.13.13.13.13.3.m1.1b"><csymbol cd="latexml" id="S5.T4.17.13.13.13.13.13.13.3.m1.1.1.cmml" xref="S5.T4.17.13.13.13.13.13.13.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.17.13.13.13.13.13.13.3.m1.1c">\pm</annotation></semantics></math> 0.9</span>
<span id="S5.T4.18.14.14.14.14.14.14.4" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.T4.18.14.14.14.14.14.14.4.1" class="ltx_text ltx_framed ltx_framed_underline">61.2</span> <math id="S5.T4.18.14.14.14.14.14.14.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.18.14.14.14.14.14.14.4.m1.1a"><mo id="S5.T4.18.14.14.14.14.14.14.4.m1.1.1" xref="S5.T4.18.14.14.14.14.14.14.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.18.14.14.14.14.14.14.4.m1.1b"><csymbol cd="latexml" id="S5.T4.18.14.14.14.14.14.14.4.m1.1.1.cmml" xref="S5.T4.18.14.14.14.14.14.14.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.18.14.14.14.14.14.14.4.m1.1c">\pm</annotation></semantics></math> 0.5</span></span>
<span id="S5.T4.22.18.18.18.18.18.18" class="ltx_tr">
<span id="S5.T4.22.18.18.18.18.18.18.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedProx</span>
<span id="S5.T4.19.15.15.15.15.15.15.1" class="ltx_td ltx_align_center">61.5 <math id="S5.T4.19.15.15.15.15.15.15.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.19.15.15.15.15.15.15.1.m1.1a"><mo id="S5.T4.19.15.15.15.15.15.15.1.m1.1.1" xref="S5.T4.19.15.15.15.15.15.15.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.19.15.15.15.15.15.15.1.m1.1b"><csymbol cd="latexml" id="S5.T4.19.15.15.15.15.15.15.1.m1.1.1.cmml" xref="S5.T4.19.15.15.15.15.15.15.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.19.15.15.15.15.15.15.1.m1.1c">\pm</annotation></semantics></math> 1.3</span>
<span id="S5.T4.20.16.16.16.16.16.16.2" class="ltx_td ltx_align_center">62.1 <math id="S5.T4.20.16.16.16.16.16.16.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.20.16.16.16.16.16.16.2.m1.1a"><mo id="S5.T4.20.16.16.16.16.16.16.2.m1.1.1" xref="S5.T4.20.16.16.16.16.16.16.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.20.16.16.16.16.16.16.2.m1.1b"><csymbol cd="latexml" id="S5.T4.20.16.16.16.16.16.16.2.m1.1.1.cmml" xref="S5.T4.20.16.16.16.16.16.16.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.20.16.16.16.16.16.16.2.m1.1c">\pm</annotation></semantics></math> 0.6</span>
<span id="S5.T4.21.17.17.17.17.17.17.3" class="ltx_td ltx_align_center">56.8 <math id="S5.T4.21.17.17.17.17.17.17.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.21.17.17.17.17.17.17.3.m1.1a"><mo id="S5.T4.21.17.17.17.17.17.17.3.m1.1.1" xref="S5.T4.21.17.17.17.17.17.17.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.21.17.17.17.17.17.17.3.m1.1b"><csymbol cd="latexml" id="S5.T4.21.17.17.17.17.17.17.3.m1.1.1.cmml" xref="S5.T4.21.17.17.17.17.17.17.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.21.17.17.17.17.17.17.3.m1.1c">\pm</annotation></semantics></math> 1.7</span>
<span id="S5.T4.22.18.18.18.18.18.18.4" class="ltx_td ltx_nopad_r ltx_align_center">59.8 <math id="S5.T4.22.18.18.18.18.18.18.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.22.18.18.18.18.18.18.4.m1.1a"><mo id="S5.T4.22.18.18.18.18.18.18.4.m1.1.1" xref="S5.T4.22.18.18.18.18.18.18.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.22.18.18.18.18.18.18.4.m1.1b"><csymbol cd="latexml" id="S5.T4.22.18.18.18.18.18.18.4.m1.1.1.cmml" xref="S5.T4.22.18.18.18.18.18.18.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.22.18.18.18.18.18.18.4.m1.1c">\pm</annotation></semantics></math> 0.4</span></span>
<span id="S5.T4.26.22.22.22.22.22.22" class="ltx_tr">
<span id="S5.T4.26.22.22.22.22.22.22.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">MOON</span>
<span id="S5.T4.23.19.19.19.19.19.19.1" class="ltx_td ltx_align_center">61.4 <math id="S5.T4.23.19.19.19.19.19.19.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.23.19.19.19.19.19.19.1.m1.1a"><mo id="S5.T4.23.19.19.19.19.19.19.1.m1.1.1" xref="S5.T4.23.19.19.19.19.19.19.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.23.19.19.19.19.19.19.1.m1.1b"><csymbol cd="latexml" id="S5.T4.23.19.19.19.19.19.19.1.m1.1.1.cmml" xref="S5.T4.23.19.19.19.19.19.19.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.23.19.19.19.19.19.19.1.m1.1c">\pm</annotation></semantics></math> 0.9</span>
<span id="S5.T4.24.20.20.20.20.20.20.2" class="ltx_td ltx_align_center"><span id="S5.T4.24.20.20.20.20.20.20.2.1" class="ltx_text ltx_framed ltx_framed_underline">63.2</span> <math id="S5.T4.24.20.20.20.20.20.20.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.24.20.20.20.20.20.20.2.m1.1a"><mo id="S5.T4.24.20.20.20.20.20.20.2.m1.1.1" xref="S5.T4.24.20.20.20.20.20.20.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.24.20.20.20.20.20.20.2.m1.1b"><csymbol cd="latexml" id="S5.T4.24.20.20.20.20.20.20.2.m1.1.1.cmml" xref="S5.T4.24.20.20.20.20.20.20.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.24.20.20.20.20.20.20.2.m1.1c">\pm</annotation></semantics></math> 1.2</span>
<span id="S5.T4.25.21.21.21.21.21.21.3" class="ltx_td ltx_align_center">56.3 <math id="S5.T4.25.21.21.21.21.21.21.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.25.21.21.21.21.21.21.3.m1.1a"><mo id="S5.T4.25.21.21.21.21.21.21.3.m1.1.1" xref="S5.T4.25.21.21.21.21.21.21.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.25.21.21.21.21.21.21.3.m1.1b"><csymbol cd="latexml" id="S5.T4.25.21.21.21.21.21.21.3.m1.1.1.cmml" xref="S5.T4.25.21.21.21.21.21.21.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.25.21.21.21.21.21.21.3.m1.1c">\pm</annotation></semantics></math> 2.7</span>
<span id="S5.T4.26.22.22.22.22.22.22.4" class="ltx_td ltx_nopad_r ltx_align_center">59.5 <math id="S5.T4.26.22.22.22.22.22.22.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.26.22.22.22.22.22.22.4.m1.1a"><mo id="S5.T4.26.22.22.22.22.22.22.4.m1.1.1" xref="S5.T4.26.22.22.22.22.22.22.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.26.22.22.22.22.22.22.4.m1.1b"><csymbol cd="latexml" id="S5.T4.26.22.22.22.22.22.22.4.m1.1.1.cmml" xref="S5.T4.26.22.22.22.22.22.22.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.26.22.22.22.22.22.22.4.m1.1c">\pm</annotation></semantics></math> 0.9</span></span>
<span id="S5.T4.30.26.26.26.26.26.26" class="ltx_tr">
<span id="S5.T4.30.26.26.26.26.26.26.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">LfD (ours)</span>
<span id="S5.T4.27.23.23.23.23.23.23.1" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T4.27.23.23.23.23.23.23.1.1" class="ltx_text ltx_font_bold">64.8</span> <math id="S5.T4.27.23.23.23.23.23.23.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.27.23.23.23.23.23.23.1.m1.1a"><mo id="S5.T4.27.23.23.23.23.23.23.1.m1.1.1" xref="S5.T4.27.23.23.23.23.23.23.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.27.23.23.23.23.23.23.1.m1.1b"><csymbol cd="latexml" id="S5.T4.27.23.23.23.23.23.23.1.m1.1.1.cmml" xref="S5.T4.27.23.23.23.23.23.23.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.27.23.23.23.23.23.23.1.m1.1c">\pm</annotation></semantics></math> 0.6</span>
<span id="S5.T4.28.24.24.24.24.24.24.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T4.28.24.24.24.24.24.24.2.1" class="ltx_text ltx_font_bold">66.2</span> <math id="S5.T4.28.24.24.24.24.24.24.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.28.24.24.24.24.24.24.2.m1.1a"><mo id="S5.T4.28.24.24.24.24.24.24.2.m1.1.1" xref="S5.T4.28.24.24.24.24.24.24.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.28.24.24.24.24.24.24.2.m1.1b"><csymbol cd="latexml" id="S5.T4.28.24.24.24.24.24.24.2.m1.1.1.cmml" xref="S5.T4.28.24.24.24.24.24.24.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.28.24.24.24.24.24.24.2.m1.1c">\pm</annotation></semantics></math> 0.7</span>
<span id="S5.T4.29.25.25.25.25.25.25.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T4.29.25.25.25.25.25.25.3.1" class="ltx_text ltx_font_bold">61.3</span> <math id="S5.T4.29.25.25.25.25.25.25.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.29.25.25.25.25.25.25.3.m1.1a"><mo id="S5.T4.29.25.25.25.25.25.25.3.m1.1.1" xref="S5.T4.29.25.25.25.25.25.25.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.29.25.25.25.25.25.25.3.m1.1b"><csymbol cd="latexml" id="S5.T4.29.25.25.25.25.25.25.3.m1.1.1.cmml" xref="S5.T4.29.25.25.25.25.25.25.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.29.25.25.25.25.25.25.3.m1.1c">\pm</annotation></semantics></math> 1.7</span>
<span id="S5.T4.30.26.26.26.26.26.26.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb"><span id="S5.T4.30.26.26.26.26.26.26.4.1" class="ltx_text ltx_font_bold">62.7</span> <math id="S5.T4.30.26.26.26.26.26.26.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.30.26.26.26.26.26.26.4.m1.1a"><mo id="S5.T4.30.26.26.26.26.26.26.4.m1.1.1" xref="S5.T4.30.26.26.26.26.26.26.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.30.26.26.26.26.26.26.4.m1.1b"><csymbol cd="latexml" id="S5.T4.30.26.26.26.26.26.26.4.m1.1.1.cmml" xref="S5.T4.30.26.26.26.26.26.26.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.30.26.26.26.26.26.26.4.m1.1c">\pm</annotation></semantics></math> 1.1</span></span>
</span>
</span></span></span>
</span></span></span></p>
</figure>
</section>
<section id="S5.SS2.SSSx4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Forgetting</h4>

<div id="S5.SS2.SSSx4.p1" class="ltx_para">
<p id="S5.SS2.SSSx4.p1.7" class="ltx_p">The global model usually has the better knowledge for the global distribution <cite class="ltx_cite ltx_citemacro_citep">(Li, He, and Song <a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite>. However, the learned knowledge can be forgotten after the local optimization as the training makes the model fit the local distribution. Such forgetting phenomena is called <span id="S5.SS2.SSSx4.p1.7.1" class="ltx_text ltx_font_italic">catastrophic forgetting</span>, and it is widely known that the forgetting leads to the slow convergence and worse performance on federated learning <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib16" title="" class="ltx_ref">2018</a>; Zhao et al. <a href="#bib.bib30" title="" class="ltx_ref">2018</a>)</cite>. To estimate how much each method forgets or maintains the learned knowledge, we calculate the accuracy for existing and absence classes before and after the local optimization and quantify the forgetting by defining learning performance (LP) as:</p>
<table id="S5.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.E11.m1.8" class="ltx_Math" alttext="LP(\mathcal{D}^{test};\omega_{t}^{k},\omega_{t})=\frac{1}{|\mathcal{Y}|}\sum_{y_{i}\in\mathcal{Y}}\frac{Acc(\mathcal{D}^{test}(y_{i}),\omega_{t}^{k})}{Acc(\mathcal{D}^{test}(y_{i}),\omega_{t})}" display="block"><semantics id="S5.E11.m1.8a"><mrow id="S5.E11.m1.8.8" xref="S5.E11.m1.8.8.cmml"><mrow id="S5.E11.m1.8.8.3" xref="S5.E11.m1.8.8.3.cmml"><mi id="S5.E11.m1.8.8.3.5" xref="S5.E11.m1.8.8.3.5.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.E11.m1.8.8.3.4" xref="S5.E11.m1.8.8.3.4.cmml">​</mo><mi id="S5.E11.m1.8.8.3.6" xref="S5.E11.m1.8.8.3.6.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.E11.m1.8.8.3.4a" xref="S5.E11.m1.8.8.3.4.cmml">​</mo><mrow id="S5.E11.m1.8.8.3.3.3" xref="S5.E11.m1.8.8.3.3.4.cmml"><mo stretchy="false" id="S5.E11.m1.8.8.3.3.3.4" xref="S5.E11.m1.8.8.3.3.4.cmml">(</mo><msup id="S5.E11.m1.6.6.1.1.1.1" xref="S5.E11.m1.6.6.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E11.m1.6.6.1.1.1.1.2" xref="S5.E11.m1.6.6.1.1.1.1.2.cmml">𝒟</mi><mrow id="S5.E11.m1.6.6.1.1.1.1.3" xref="S5.E11.m1.6.6.1.1.1.1.3.cmml"><mi id="S5.E11.m1.6.6.1.1.1.1.3.2" xref="S5.E11.m1.6.6.1.1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.E11.m1.6.6.1.1.1.1.3.1" xref="S5.E11.m1.6.6.1.1.1.1.3.1.cmml">​</mo><mi id="S5.E11.m1.6.6.1.1.1.1.3.3" xref="S5.E11.m1.6.6.1.1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.E11.m1.6.6.1.1.1.1.3.1a" xref="S5.E11.m1.6.6.1.1.1.1.3.1.cmml">​</mo><mi id="S5.E11.m1.6.6.1.1.1.1.3.4" xref="S5.E11.m1.6.6.1.1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S5.E11.m1.6.6.1.1.1.1.3.1b" xref="S5.E11.m1.6.6.1.1.1.1.3.1.cmml">​</mo><mi id="S5.E11.m1.6.6.1.1.1.1.3.5" xref="S5.E11.m1.6.6.1.1.1.1.3.5.cmml">t</mi></mrow></msup><mo id="S5.E11.m1.8.8.3.3.3.5" xref="S5.E11.m1.8.8.3.3.4.cmml">;</mo><msubsup id="S5.E11.m1.7.7.2.2.2.2" xref="S5.E11.m1.7.7.2.2.2.2.cmml"><mi id="S5.E11.m1.7.7.2.2.2.2.2.2" xref="S5.E11.m1.7.7.2.2.2.2.2.2.cmml">ω</mi><mi id="S5.E11.m1.7.7.2.2.2.2.2.3" xref="S5.E11.m1.7.7.2.2.2.2.2.3.cmml">t</mi><mi id="S5.E11.m1.7.7.2.2.2.2.3" xref="S5.E11.m1.7.7.2.2.2.2.3.cmml">k</mi></msubsup><mo id="S5.E11.m1.8.8.3.3.3.6" xref="S5.E11.m1.8.8.3.3.4.cmml">,</mo><msub id="S5.E11.m1.8.8.3.3.3.3" xref="S5.E11.m1.8.8.3.3.3.3.cmml"><mi id="S5.E11.m1.8.8.3.3.3.3.2" xref="S5.E11.m1.8.8.3.3.3.3.2.cmml">ω</mi><mi id="S5.E11.m1.8.8.3.3.3.3.3" xref="S5.E11.m1.8.8.3.3.3.3.3.cmml">t</mi></msub><mo stretchy="false" id="S5.E11.m1.8.8.3.3.3.7" xref="S5.E11.m1.8.8.3.3.4.cmml">)</mo></mrow></mrow><mo id="S5.E11.m1.8.8.4" xref="S5.E11.m1.8.8.4.cmml">=</mo><mrow id="S5.E11.m1.8.8.5" xref="S5.E11.m1.8.8.5.cmml"><mfrac id="S5.E11.m1.1.1" xref="S5.E11.m1.1.1.cmml"><mn id="S5.E11.m1.1.1.3" xref="S5.E11.m1.1.1.3.cmml">1</mn><mrow id="S5.E11.m1.1.1.1.3" xref="S5.E11.m1.1.1.1.2.cmml"><mo stretchy="false" id="S5.E11.m1.1.1.1.3.1" xref="S5.E11.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S5.E11.m1.1.1.1.1" xref="S5.E11.m1.1.1.1.1.cmml">𝒴</mi><mo stretchy="false" id="S5.E11.m1.1.1.1.3.2" xref="S5.E11.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S5.E11.m1.8.8.5.1" xref="S5.E11.m1.8.8.5.1.cmml">​</mo><mrow id="S5.E11.m1.8.8.5.2" xref="S5.E11.m1.8.8.5.2.cmml"><munder id="S5.E11.m1.8.8.5.2.1" xref="S5.E11.m1.8.8.5.2.1.cmml"><mo movablelimits="false" id="S5.E11.m1.8.8.5.2.1.2" xref="S5.E11.m1.8.8.5.2.1.2.cmml">∑</mo><mrow id="S5.E11.m1.8.8.5.2.1.3" xref="S5.E11.m1.8.8.5.2.1.3.cmml"><msub id="S5.E11.m1.8.8.5.2.1.3.2" xref="S5.E11.m1.8.8.5.2.1.3.2.cmml"><mi id="S5.E11.m1.8.8.5.2.1.3.2.2" xref="S5.E11.m1.8.8.5.2.1.3.2.2.cmml">y</mi><mi id="S5.E11.m1.8.8.5.2.1.3.2.3" xref="S5.E11.m1.8.8.5.2.1.3.2.3.cmml">i</mi></msub><mo id="S5.E11.m1.8.8.5.2.1.3.1" xref="S5.E11.m1.8.8.5.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S5.E11.m1.8.8.5.2.1.3.3" xref="S5.E11.m1.8.8.5.2.1.3.3.cmml">𝒴</mi></mrow></munder><mfrac id="S5.E11.m1.5.5" xref="S5.E11.m1.5.5.cmml"><mrow id="S5.E11.m1.3.3.2" xref="S5.E11.m1.3.3.2.cmml"><mi id="S5.E11.m1.3.3.2.4" xref="S5.E11.m1.3.3.2.4.cmml">A</mi><mo lspace="0em" rspace="0em" id="S5.E11.m1.3.3.2.3" xref="S5.E11.m1.3.3.2.3.cmml">​</mo><mi id="S5.E11.m1.3.3.2.5" xref="S5.E11.m1.3.3.2.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="S5.E11.m1.3.3.2.3a" xref="S5.E11.m1.3.3.2.3.cmml">​</mo><mi id="S5.E11.m1.3.3.2.6" xref="S5.E11.m1.3.3.2.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="S5.E11.m1.3.3.2.3b" xref="S5.E11.m1.3.3.2.3.cmml">​</mo><mrow id="S5.E11.m1.3.3.2.2.2" xref="S5.E11.m1.3.3.2.2.3.cmml"><mo stretchy="false" id="S5.E11.m1.3.3.2.2.2.3" xref="S5.E11.m1.3.3.2.2.3.cmml">(</mo><mrow id="S5.E11.m1.2.2.1.1.1.1" xref="S5.E11.m1.2.2.1.1.1.1.cmml"><msup id="S5.E11.m1.2.2.1.1.1.1.3" xref="S5.E11.m1.2.2.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E11.m1.2.2.1.1.1.1.3.2" xref="S5.E11.m1.2.2.1.1.1.1.3.2.cmml">𝒟</mi><mrow id="S5.E11.m1.2.2.1.1.1.1.3.3" xref="S5.E11.m1.2.2.1.1.1.1.3.3.cmml"><mi id="S5.E11.m1.2.2.1.1.1.1.3.3.2" xref="S5.E11.m1.2.2.1.1.1.1.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.E11.m1.2.2.1.1.1.1.3.3.1" xref="S5.E11.m1.2.2.1.1.1.1.3.3.1.cmml">​</mo><mi id="S5.E11.m1.2.2.1.1.1.1.3.3.3" xref="S5.E11.m1.2.2.1.1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.E11.m1.2.2.1.1.1.1.3.3.1a" xref="S5.E11.m1.2.2.1.1.1.1.3.3.1.cmml">​</mo><mi id="S5.E11.m1.2.2.1.1.1.1.3.3.4" xref="S5.E11.m1.2.2.1.1.1.1.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S5.E11.m1.2.2.1.1.1.1.3.3.1b" xref="S5.E11.m1.2.2.1.1.1.1.3.3.1.cmml">​</mo><mi id="S5.E11.m1.2.2.1.1.1.1.3.3.5" xref="S5.E11.m1.2.2.1.1.1.1.3.3.5.cmml">t</mi></mrow></msup><mo lspace="0em" rspace="0em" id="S5.E11.m1.2.2.1.1.1.1.2" xref="S5.E11.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S5.E11.m1.2.2.1.1.1.1.1.1" xref="S5.E11.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.E11.m1.2.2.1.1.1.1.1.1.2" xref="S5.E11.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S5.E11.m1.2.2.1.1.1.1.1.1.1" xref="S5.E11.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S5.E11.m1.2.2.1.1.1.1.1.1.1.2" xref="S5.E11.m1.2.2.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S5.E11.m1.2.2.1.1.1.1.1.1.1.3" xref="S5.E11.m1.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S5.E11.m1.2.2.1.1.1.1.1.1.3" xref="S5.E11.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.E11.m1.3.3.2.2.2.4" xref="S5.E11.m1.3.3.2.2.3.cmml">,</mo><msubsup id="S5.E11.m1.3.3.2.2.2.2" xref="S5.E11.m1.3.3.2.2.2.2.cmml"><mi id="S5.E11.m1.3.3.2.2.2.2.2.2" xref="S5.E11.m1.3.3.2.2.2.2.2.2.cmml">ω</mi><mi id="S5.E11.m1.3.3.2.2.2.2.2.3" xref="S5.E11.m1.3.3.2.2.2.2.2.3.cmml">t</mi><mi id="S5.E11.m1.3.3.2.2.2.2.3" xref="S5.E11.m1.3.3.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S5.E11.m1.3.3.2.2.2.5" xref="S5.E11.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S5.E11.m1.5.5.4" xref="S5.E11.m1.5.5.4.cmml"><mi id="S5.E11.m1.5.5.4.4" xref="S5.E11.m1.5.5.4.4.cmml">A</mi><mo lspace="0em" rspace="0em" id="S5.E11.m1.5.5.4.3" xref="S5.E11.m1.5.5.4.3.cmml">​</mo><mi id="S5.E11.m1.5.5.4.5" xref="S5.E11.m1.5.5.4.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="S5.E11.m1.5.5.4.3a" xref="S5.E11.m1.5.5.4.3.cmml">​</mo><mi id="S5.E11.m1.5.5.4.6" xref="S5.E11.m1.5.5.4.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="S5.E11.m1.5.5.4.3b" xref="S5.E11.m1.5.5.4.3.cmml">​</mo><mrow id="S5.E11.m1.5.5.4.2.2" xref="S5.E11.m1.5.5.4.2.3.cmml"><mo stretchy="false" id="S5.E11.m1.5.5.4.2.2.3" xref="S5.E11.m1.5.5.4.2.3.cmml">(</mo><mrow id="S5.E11.m1.4.4.3.1.1.1" xref="S5.E11.m1.4.4.3.1.1.1.cmml"><msup id="S5.E11.m1.4.4.3.1.1.1.3" xref="S5.E11.m1.4.4.3.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E11.m1.4.4.3.1.1.1.3.2" xref="S5.E11.m1.4.4.3.1.1.1.3.2.cmml">𝒟</mi><mrow id="S5.E11.m1.4.4.3.1.1.1.3.3" xref="S5.E11.m1.4.4.3.1.1.1.3.3.cmml"><mi id="S5.E11.m1.4.4.3.1.1.1.3.3.2" xref="S5.E11.m1.4.4.3.1.1.1.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.E11.m1.4.4.3.1.1.1.3.3.1" xref="S5.E11.m1.4.4.3.1.1.1.3.3.1.cmml">​</mo><mi id="S5.E11.m1.4.4.3.1.1.1.3.3.3" xref="S5.E11.m1.4.4.3.1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.E11.m1.4.4.3.1.1.1.3.3.1a" xref="S5.E11.m1.4.4.3.1.1.1.3.3.1.cmml">​</mo><mi id="S5.E11.m1.4.4.3.1.1.1.3.3.4" xref="S5.E11.m1.4.4.3.1.1.1.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S5.E11.m1.4.4.3.1.1.1.3.3.1b" xref="S5.E11.m1.4.4.3.1.1.1.3.3.1.cmml">​</mo><mi id="S5.E11.m1.4.4.3.1.1.1.3.3.5" xref="S5.E11.m1.4.4.3.1.1.1.3.3.5.cmml">t</mi></mrow></msup><mo lspace="0em" rspace="0em" id="S5.E11.m1.4.4.3.1.1.1.2" xref="S5.E11.m1.4.4.3.1.1.1.2.cmml">​</mo><mrow id="S5.E11.m1.4.4.3.1.1.1.1.1" xref="S5.E11.m1.4.4.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.E11.m1.4.4.3.1.1.1.1.1.2" xref="S5.E11.m1.4.4.3.1.1.1.1.1.1.cmml">(</mo><msub id="S5.E11.m1.4.4.3.1.1.1.1.1.1" xref="S5.E11.m1.4.4.3.1.1.1.1.1.1.cmml"><mi id="S5.E11.m1.4.4.3.1.1.1.1.1.1.2" xref="S5.E11.m1.4.4.3.1.1.1.1.1.1.2.cmml">y</mi><mi id="S5.E11.m1.4.4.3.1.1.1.1.1.1.3" xref="S5.E11.m1.4.4.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S5.E11.m1.4.4.3.1.1.1.1.1.3" xref="S5.E11.m1.4.4.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.E11.m1.5.5.4.2.2.4" xref="S5.E11.m1.5.5.4.2.3.cmml">,</mo><msub id="S5.E11.m1.5.5.4.2.2.2" xref="S5.E11.m1.5.5.4.2.2.2.cmml"><mi id="S5.E11.m1.5.5.4.2.2.2.2" xref="S5.E11.m1.5.5.4.2.2.2.2.cmml">ω</mi><mi id="S5.E11.m1.5.5.4.2.2.2.3" xref="S5.E11.m1.5.5.4.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S5.E11.m1.5.5.4.2.2.5" xref="S5.E11.m1.5.5.4.2.3.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E11.m1.8b"><apply id="S5.E11.m1.8.8.cmml" xref="S5.E11.m1.8.8"><eq id="S5.E11.m1.8.8.4.cmml" xref="S5.E11.m1.8.8.4"></eq><apply id="S5.E11.m1.8.8.3.cmml" xref="S5.E11.m1.8.8.3"><times id="S5.E11.m1.8.8.3.4.cmml" xref="S5.E11.m1.8.8.3.4"></times><ci id="S5.E11.m1.8.8.3.5.cmml" xref="S5.E11.m1.8.8.3.5">𝐿</ci><ci id="S5.E11.m1.8.8.3.6.cmml" xref="S5.E11.m1.8.8.3.6">𝑃</ci><list id="S5.E11.m1.8.8.3.3.4.cmml" xref="S5.E11.m1.8.8.3.3.3"><apply id="S5.E11.m1.6.6.1.1.1.1.cmml" xref="S5.E11.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S5.E11.m1.6.6.1.1.1.1.1.cmml" xref="S5.E11.m1.6.6.1.1.1.1">superscript</csymbol><ci id="S5.E11.m1.6.6.1.1.1.1.2.cmml" xref="S5.E11.m1.6.6.1.1.1.1.2">𝒟</ci><apply id="S5.E11.m1.6.6.1.1.1.1.3.cmml" xref="S5.E11.m1.6.6.1.1.1.1.3"><times id="S5.E11.m1.6.6.1.1.1.1.3.1.cmml" xref="S5.E11.m1.6.6.1.1.1.1.3.1"></times><ci id="S5.E11.m1.6.6.1.1.1.1.3.2.cmml" xref="S5.E11.m1.6.6.1.1.1.1.3.2">𝑡</ci><ci id="S5.E11.m1.6.6.1.1.1.1.3.3.cmml" xref="S5.E11.m1.6.6.1.1.1.1.3.3">𝑒</ci><ci id="S5.E11.m1.6.6.1.1.1.1.3.4.cmml" xref="S5.E11.m1.6.6.1.1.1.1.3.4">𝑠</ci><ci id="S5.E11.m1.6.6.1.1.1.1.3.5.cmml" xref="S5.E11.m1.6.6.1.1.1.1.3.5">𝑡</ci></apply></apply><apply id="S5.E11.m1.7.7.2.2.2.2.cmml" xref="S5.E11.m1.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S5.E11.m1.7.7.2.2.2.2.1.cmml" xref="S5.E11.m1.7.7.2.2.2.2">superscript</csymbol><apply id="S5.E11.m1.7.7.2.2.2.2.2.cmml" xref="S5.E11.m1.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S5.E11.m1.7.7.2.2.2.2.2.1.cmml" xref="S5.E11.m1.7.7.2.2.2.2">subscript</csymbol><ci id="S5.E11.m1.7.7.2.2.2.2.2.2.cmml" xref="S5.E11.m1.7.7.2.2.2.2.2.2">𝜔</ci><ci id="S5.E11.m1.7.7.2.2.2.2.2.3.cmml" xref="S5.E11.m1.7.7.2.2.2.2.2.3">𝑡</ci></apply><ci id="S5.E11.m1.7.7.2.2.2.2.3.cmml" xref="S5.E11.m1.7.7.2.2.2.2.3">𝑘</ci></apply><apply id="S5.E11.m1.8.8.3.3.3.3.cmml" xref="S5.E11.m1.8.8.3.3.3.3"><csymbol cd="ambiguous" id="S5.E11.m1.8.8.3.3.3.3.1.cmml" xref="S5.E11.m1.8.8.3.3.3.3">subscript</csymbol><ci id="S5.E11.m1.8.8.3.3.3.3.2.cmml" xref="S5.E11.m1.8.8.3.3.3.3.2">𝜔</ci><ci id="S5.E11.m1.8.8.3.3.3.3.3.cmml" xref="S5.E11.m1.8.8.3.3.3.3.3">𝑡</ci></apply></list></apply><apply id="S5.E11.m1.8.8.5.cmml" xref="S5.E11.m1.8.8.5"><times id="S5.E11.m1.8.8.5.1.cmml" xref="S5.E11.m1.8.8.5.1"></times><apply id="S5.E11.m1.1.1.cmml" xref="S5.E11.m1.1.1"><divide id="S5.E11.m1.1.1.2.cmml" xref="S5.E11.m1.1.1"></divide><cn type="integer" id="S5.E11.m1.1.1.3.cmml" xref="S5.E11.m1.1.1.3">1</cn><apply id="S5.E11.m1.1.1.1.2.cmml" xref="S5.E11.m1.1.1.1.3"><abs id="S5.E11.m1.1.1.1.2.1.cmml" xref="S5.E11.m1.1.1.1.3.1"></abs><ci id="S5.E11.m1.1.1.1.1.cmml" xref="S5.E11.m1.1.1.1.1">𝒴</ci></apply></apply><apply id="S5.E11.m1.8.8.5.2.cmml" xref="S5.E11.m1.8.8.5.2"><apply id="S5.E11.m1.8.8.5.2.1.cmml" xref="S5.E11.m1.8.8.5.2.1"><csymbol cd="ambiguous" id="S5.E11.m1.8.8.5.2.1.1.cmml" xref="S5.E11.m1.8.8.5.2.1">subscript</csymbol><sum id="S5.E11.m1.8.8.5.2.1.2.cmml" xref="S5.E11.m1.8.8.5.2.1.2"></sum><apply id="S5.E11.m1.8.8.5.2.1.3.cmml" xref="S5.E11.m1.8.8.5.2.1.3"><in id="S5.E11.m1.8.8.5.2.1.3.1.cmml" xref="S5.E11.m1.8.8.5.2.1.3.1"></in><apply id="S5.E11.m1.8.8.5.2.1.3.2.cmml" xref="S5.E11.m1.8.8.5.2.1.3.2"><csymbol cd="ambiguous" id="S5.E11.m1.8.8.5.2.1.3.2.1.cmml" xref="S5.E11.m1.8.8.5.2.1.3.2">subscript</csymbol><ci id="S5.E11.m1.8.8.5.2.1.3.2.2.cmml" xref="S5.E11.m1.8.8.5.2.1.3.2.2">𝑦</ci><ci id="S5.E11.m1.8.8.5.2.1.3.2.3.cmml" xref="S5.E11.m1.8.8.5.2.1.3.2.3">𝑖</ci></apply><ci id="S5.E11.m1.8.8.5.2.1.3.3.cmml" xref="S5.E11.m1.8.8.5.2.1.3.3">𝒴</ci></apply></apply><apply id="S5.E11.m1.5.5.cmml" xref="S5.E11.m1.5.5"><divide id="S5.E11.m1.5.5.5.cmml" xref="S5.E11.m1.5.5"></divide><apply id="S5.E11.m1.3.3.2.cmml" xref="S5.E11.m1.3.3.2"><times id="S5.E11.m1.3.3.2.3.cmml" xref="S5.E11.m1.3.3.2.3"></times><ci id="S5.E11.m1.3.3.2.4.cmml" xref="S5.E11.m1.3.3.2.4">𝐴</ci><ci id="S5.E11.m1.3.3.2.5.cmml" xref="S5.E11.m1.3.3.2.5">𝑐</ci><ci id="S5.E11.m1.3.3.2.6.cmml" xref="S5.E11.m1.3.3.2.6">𝑐</ci><interval closure="open" id="S5.E11.m1.3.3.2.2.3.cmml" xref="S5.E11.m1.3.3.2.2.2"><apply id="S5.E11.m1.2.2.1.1.1.1.cmml" xref="S5.E11.m1.2.2.1.1.1.1"><times id="S5.E11.m1.2.2.1.1.1.1.2.cmml" xref="S5.E11.m1.2.2.1.1.1.1.2"></times><apply id="S5.E11.m1.2.2.1.1.1.1.3.cmml" xref="S5.E11.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E11.m1.2.2.1.1.1.1.3.1.cmml" xref="S5.E11.m1.2.2.1.1.1.1.3">superscript</csymbol><ci id="S5.E11.m1.2.2.1.1.1.1.3.2.cmml" xref="S5.E11.m1.2.2.1.1.1.1.3.2">𝒟</ci><apply id="S5.E11.m1.2.2.1.1.1.1.3.3.cmml" xref="S5.E11.m1.2.2.1.1.1.1.3.3"><times id="S5.E11.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S5.E11.m1.2.2.1.1.1.1.3.3.1"></times><ci id="S5.E11.m1.2.2.1.1.1.1.3.3.2.cmml" xref="S5.E11.m1.2.2.1.1.1.1.3.3.2">𝑡</ci><ci id="S5.E11.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S5.E11.m1.2.2.1.1.1.1.3.3.3">𝑒</ci><ci id="S5.E11.m1.2.2.1.1.1.1.3.3.4.cmml" xref="S5.E11.m1.2.2.1.1.1.1.3.3.4">𝑠</ci><ci id="S5.E11.m1.2.2.1.1.1.1.3.3.5.cmml" xref="S5.E11.m1.2.2.1.1.1.1.3.3.5">𝑡</ci></apply></apply><apply id="S5.E11.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S5.E11.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E11.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S5.E11.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S5.E11.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S5.E11.m1.2.2.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S5.E11.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S5.E11.m1.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S5.E11.m1.3.3.2.2.2.2.cmml" xref="S5.E11.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S5.E11.m1.3.3.2.2.2.2.1.cmml" xref="S5.E11.m1.3.3.2.2.2.2">superscript</csymbol><apply id="S5.E11.m1.3.3.2.2.2.2.2.cmml" xref="S5.E11.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S5.E11.m1.3.3.2.2.2.2.2.1.cmml" xref="S5.E11.m1.3.3.2.2.2.2">subscript</csymbol><ci id="S5.E11.m1.3.3.2.2.2.2.2.2.cmml" xref="S5.E11.m1.3.3.2.2.2.2.2.2">𝜔</ci><ci id="S5.E11.m1.3.3.2.2.2.2.2.3.cmml" xref="S5.E11.m1.3.3.2.2.2.2.2.3">𝑡</ci></apply><ci id="S5.E11.m1.3.3.2.2.2.2.3.cmml" xref="S5.E11.m1.3.3.2.2.2.2.3">𝑘</ci></apply></interval></apply><apply id="S5.E11.m1.5.5.4.cmml" xref="S5.E11.m1.5.5.4"><times id="S5.E11.m1.5.5.4.3.cmml" xref="S5.E11.m1.5.5.4.3"></times><ci id="S5.E11.m1.5.5.4.4.cmml" xref="S5.E11.m1.5.5.4.4">𝐴</ci><ci id="S5.E11.m1.5.5.4.5.cmml" xref="S5.E11.m1.5.5.4.5">𝑐</ci><ci id="S5.E11.m1.5.5.4.6.cmml" xref="S5.E11.m1.5.5.4.6">𝑐</ci><interval closure="open" id="S5.E11.m1.5.5.4.2.3.cmml" xref="S5.E11.m1.5.5.4.2.2"><apply id="S5.E11.m1.4.4.3.1.1.1.cmml" xref="S5.E11.m1.4.4.3.1.1.1"><times id="S5.E11.m1.4.4.3.1.1.1.2.cmml" xref="S5.E11.m1.4.4.3.1.1.1.2"></times><apply id="S5.E11.m1.4.4.3.1.1.1.3.cmml" xref="S5.E11.m1.4.4.3.1.1.1.3"><csymbol cd="ambiguous" id="S5.E11.m1.4.4.3.1.1.1.3.1.cmml" xref="S5.E11.m1.4.4.3.1.1.1.3">superscript</csymbol><ci id="S5.E11.m1.4.4.3.1.1.1.3.2.cmml" xref="S5.E11.m1.4.4.3.1.1.1.3.2">𝒟</ci><apply id="S5.E11.m1.4.4.3.1.1.1.3.3.cmml" xref="S5.E11.m1.4.4.3.1.1.1.3.3"><times id="S5.E11.m1.4.4.3.1.1.1.3.3.1.cmml" xref="S5.E11.m1.4.4.3.1.1.1.3.3.1"></times><ci id="S5.E11.m1.4.4.3.1.1.1.3.3.2.cmml" xref="S5.E11.m1.4.4.3.1.1.1.3.3.2">𝑡</ci><ci id="S5.E11.m1.4.4.3.1.1.1.3.3.3.cmml" xref="S5.E11.m1.4.4.3.1.1.1.3.3.3">𝑒</ci><ci id="S5.E11.m1.4.4.3.1.1.1.3.3.4.cmml" xref="S5.E11.m1.4.4.3.1.1.1.3.3.4">𝑠</ci><ci id="S5.E11.m1.4.4.3.1.1.1.3.3.5.cmml" xref="S5.E11.m1.4.4.3.1.1.1.3.3.5">𝑡</ci></apply></apply><apply id="S5.E11.m1.4.4.3.1.1.1.1.1.1.cmml" xref="S5.E11.m1.4.4.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E11.m1.4.4.3.1.1.1.1.1.1.1.cmml" xref="S5.E11.m1.4.4.3.1.1.1.1.1">subscript</csymbol><ci id="S5.E11.m1.4.4.3.1.1.1.1.1.1.2.cmml" xref="S5.E11.m1.4.4.3.1.1.1.1.1.1.2">𝑦</ci><ci id="S5.E11.m1.4.4.3.1.1.1.1.1.1.3.cmml" xref="S5.E11.m1.4.4.3.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S5.E11.m1.5.5.4.2.2.2.cmml" xref="S5.E11.m1.5.5.4.2.2.2"><csymbol cd="ambiguous" id="S5.E11.m1.5.5.4.2.2.2.1.cmml" xref="S5.E11.m1.5.5.4.2.2.2">subscript</csymbol><ci id="S5.E11.m1.5.5.4.2.2.2.2.cmml" xref="S5.E11.m1.5.5.4.2.2.2.2">𝜔</ci><ci id="S5.E11.m1.5.5.4.2.2.2.3.cmml" xref="S5.E11.m1.5.5.4.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E11.m1.8c">LP(\mathcal{D}^{test};\omega_{t}^{k},\omega_{t})=\frac{1}{|\mathcal{Y}|}\sum_{y_{i}\in\mathcal{Y}}\frac{Acc(\mathcal{D}^{test}(y_{i}),\omega_{t}^{k})}{Acc(\mathcal{D}^{test}(y_{i}),\omega_{t})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S5.SS2.SSSx4.p1.6" class="ltx_p">where <math id="S5.SS2.SSSx4.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}^{test}(y_{i})" display="inline"><semantics id="S5.SS2.SSSx4.p1.1.m1.1a"><mrow id="S5.SS2.SSSx4.p1.1.m1.1.1" xref="S5.SS2.SSSx4.p1.1.m1.1.1.cmml"><msup id="S5.SS2.SSSx4.p1.1.m1.1.1.3" xref="S5.SS2.SSSx4.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.SSSx4.p1.1.m1.1.1.3.2" xref="S5.SS2.SSSx4.p1.1.m1.1.1.3.2.cmml">𝒟</mi><mrow id="S5.SS2.SSSx4.p1.1.m1.1.1.3.3" xref="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.cmml"><mi id="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.2" xref="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.1" xref="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.3" xref="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.1a" xref="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.4" xref="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.1b" xref="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.5" xref="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.5.cmml">t</mi></mrow></msup><mo lspace="0em" rspace="0em" id="S5.SS2.SSSx4.p1.1.m1.1.1.2" xref="S5.SS2.SSSx4.p1.1.m1.1.1.2.cmml">​</mo><mrow id="S5.SS2.SSSx4.p1.1.m1.1.1.1.1" xref="S5.SS2.SSSx4.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.SS2.SSSx4.p1.1.m1.1.1.1.1.2" xref="S5.SS2.SSSx4.p1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S5.SS2.SSSx4.p1.1.m1.1.1.1.1.1" xref="S5.SS2.SSSx4.p1.1.m1.1.1.1.1.1.cmml"><mi id="S5.SS2.SSSx4.p1.1.m1.1.1.1.1.1.2" xref="S5.SS2.SSSx4.p1.1.m1.1.1.1.1.1.2.cmml">y</mi><mi id="S5.SS2.SSSx4.p1.1.m1.1.1.1.1.1.3" xref="S5.SS2.SSSx4.p1.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S5.SS2.SSSx4.p1.1.m1.1.1.1.1.3" xref="S5.SS2.SSSx4.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSSx4.p1.1.m1.1b"><apply id="S5.SS2.SSSx4.p1.1.m1.1.1.cmml" xref="S5.SS2.SSSx4.p1.1.m1.1.1"><times id="S5.SS2.SSSx4.p1.1.m1.1.1.2.cmml" xref="S5.SS2.SSSx4.p1.1.m1.1.1.2"></times><apply id="S5.SS2.SSSx4.p1.1.m1.1.1.3.cmml" xref="S5.SS2.SSSx4.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.SSSx4.p1.1.m1.1.1.3.1.cmml" xref="S5.SS2.SSSx4.p1.1.m1.1.1.3">superscript</csymbol><ci id="S5.SS2.SSSx4.p1.1.m1.1.1.3.2.cmml" xref="S5.SS2.SSSx4.p1.1.m1.1.1.3.2">𝒟</ci><apply id="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.cmml" xref="S5.SS2.SSSx4.p1.1.m1.1.1.3.3"><times id="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.1.cmml" xref="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.1"></times><ci id="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.2.cmml" xref="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.2">𝑡</ci><ci id="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.3.cmml" xref="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.3">𝑒</ci><ci id="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.4.cmml" xref="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.4">𝑠</ci><ci id="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.5.cmml" xref="S5.SS2.SSSx4.p1.1.m1.1.1.3.3.5">𝑡</ci></apply></apply><apply id="S5.SS2.SSSx4.p1.1.m1.1.1.1.1.1.cmml" xref="S5.SS2.SSSx4.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSSx4.p1.1.m1.1.1.1.1.1.1.cmml" xref="S5.SS2.SSSx4.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S5.SS2.SSSx4.p1.1.m1.1.1.1.1.1.2.cmml" xref="S5.SS2.SSSx4.p1.1.m1.1.1.1.1.1.2">𝑦</ci><ci id="S5.SS2.SSSx4.p1.1.m1.1.1.1.1.1.3.cmml" xref="S5.SS2.SSSx4.p1.1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSSx4.p1.1.m1.1c">\mathcal{D}^{test}(y_{i})</annotation></semantics></math> is the test dataset that contains samples belonging the class <math id="S5.SS2.SSSx4.p1.2.m2.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S5.SS2.SSSx4.p1.2.m2.1a"><msub id="S5.SS2.SSSx4.p1.2.m2.1.1" xref="S5.SS2.SSSx4.p1.2.m2.1.1.cmml"><mi id="S5.SS2.SSSx4.p1.2.m2.1.1.2" xref="S5.SS2.SSSx4.p1.2.m2.1.1.2.cmml">y</mi><mi id="S5.SS2.SSSx4.p1.2.m2.1.1.3" xref="S5.SS2.SSSx4.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSSx4.p1.2.m2.1b"><apply id="S5.SS2.SSSx4.p1.2.m2.1.1.cmml" xref="S5.SS2.SSSx4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSSx4.p1.2.m2.1.1.1.cmml" xref="S5.SS2.SSSx4.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS2.SSSx4.p1.2.m2.1.1.2.cmml" xref="S5.SS2.SSSx4.p1.2.m2.1.1.2">𝑦</ci><ci id="S5.SS2.SSSx4.p1.2.m2.1.1.3.cmml" xref="S5.SS2.SSSx4.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSSx4.p1.2.m2.1c">y_{i}</annotation></semantics></math>, and <math id="S5.SS2.SSSx4.p1.3.m3.1" class="ltx_Math" alttext="Acc()" display="inline"><semantics id="S5.SS2.SSSx4.p1.3.m3.1a"><mrow id="S5.SS2.SSSx4.p1.3.m3.1.1" xref="S5.SS2.SSSx4.p1.3.m3.1.1.cmml"><mi id="S5.SS2.SSSx4.p1.3.m3.1.1.2" xref="S5.SS2.SSSx4.p1.3.m3.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSSx4.p1.3.m3.1.1.1" xref="S5.SS2.SSSx4.p1.3.m3.1.1.1.cmml">​</mo><mi id="S5.SS2.SSSx4.p1.3.m3.1.1.3" xref="S5.SS2.SSSx4.p1.3.m3.1.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSSx4.p1.3.m3.1.1.1a" xref="S5.SS2.SSSx4.p1.3.m3.1.1.1.cmml">​</mo><mi id="S5.SS2.SSSx4.p1.3.m3.1.1.4" xref="S5.SS2.SSSx4.p1.3.m3.1.1.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSSx4.p1.3.m3.1.1.1b" xref="S5.SS2.SSSx4.p1.3.m3.1.1.1.cmml">​</mo><mrow id="S5.SS2.SSSx4.p1.3.m3.1.1.5.2" xref="S5.SS2.SSSx4.p1.3.m3.1.1.cmml"><mo stretchy="false" id="S5.SS2.SSSx4.p1.3.m3.1.1.5.2.1" xref="S5.SS2.SSSx4.p1.3.m3.1.1.5.1.cmml">(</mo><mo stretchy="false" id="S5.SS2.SSSx4.p1.3.m3.1.1.5.2.2" xref="S5.SS2.SSSx4.p1.3.m3.1.1.5.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSSx4.p1.3.m3.1b"><apply id="S5.SS2.SSSx4.p1.3.m3.1.1.cmml" xref="S5.SS2.SSSx4.p1.3.m3.1.1"><times id="S5.SS2.SSSx4.p1.3.m3.1.1.1.cmml" xref="S5.SS2.SSSx4.p1.3.m3.1.1.1"></times><ci id="S5.SS2.SSSx4.p1.3.m3.1.1.2.cmml" xref="S5.SS2.SSSx4.p1.3.m3.1.1.2">𝐴</ci><ci id="S5.SS2.SSSx4.p1.3.m3.1.1.3.cmml" xref="S5.SS2.SSSx4.p1.3.m3.1.1.3">𝑐</ci><ci id="S5.SS2.SSSx4.p1.3.m3.1.1.4.cmml" xref="S5.SS2.SSSx4.p1.3.m3.1.1.4">𝑐</ci><list id="S5.SS2.SSSx4.p1.3.m3.1.1.5.1.cmml" xref="S5.SS2.SSSx4.p1.3.m3.1.1.5.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSSx4.p1.3.m3.1c">Acc()</annotation></semantics></math> is the accuracy on the given dataset and classifier. <math id="S5.SS2.SSSx4.p1.4.m4.1" class="ltx_Math" alttext="LP(\cdot)" display="inline"><semantics id="S5.SS2.SSSx4.p1.4.m4.1a"><mrow id="S5.SS2.SSSx4.p1.4.m4.1.2" xref="S5.SS2.SSSx4.p1.4.m4.1.2.cmml"><mi id="S5.SS2.SSSx4.p1.4.m4.1.2.2" xref="S5.SS2.SSSx4.p1.4.m4.1.2.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSSx4.p1.4.m4.1.2.1" xref="S5.SS2.SSSx4.p1.4.m4.1.2.1.cmml">​</mo><mi id="S5.SS2.SSSx4.p1.4.m4.1.2.3" xref="S5.SS2.SSSx4.p1.4.m4.1.2.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSSx4.p1.4.m4.1.2.1a" xref="S5.SS2.SSSx4.p1.4.m4.1.2.1.cmml">​</mo><mrow id="S5.SS2.SSSx4.p1.4.m4.1.2.4.2" xref="S5.SS2.SSSx4.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S5.SS2.SSSx4.p1.4.m4.1.2.4.2.1" xref="S5.SS2.SSSx4.p1.4.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S5.SS2.SSSx4.p1.4.m4.1.1" xref="S5.SS2.SSSx4.p1.4.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="S5.SS2.SSSx4.p1.4.m4.1.2.4.2.2" xref="S5.SS2.SSSx4.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSSx4.p1.4.m4.1b"><apply id="S5.SS2.SSSx4.p1.4.m4.1.2.cmml" xref="S5.SS2.SSSx4.p1.4.m4.1.2"><times id="S5.SS2.SSSx4.p1.4.m4.1.2.1.cmml" xref="S5.SS2.SSSx4.p1.4.m4.1.2.1"></times><ci id="S5.SS2.SSSx4.p1.4.m4.1.2.2.cmml" xref="S5.SS2.SSSx4.p1.4.m4.1.2.2">𝐿</ci><ci id="S5.SS2.SSSx4.p1.4.m4.1.2.3.cmml" xref="S5.SS2.SSSx4.p1.4.m4.1.2.3">𝑃</ci><ci id="S5.SS2.SSSx4.p1.4.m4.1.1.cmml" xref="S5.SS2.SSSx4.p1.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSSx4.p1.4.m4.1c">LP(\cdot)</annotation></semantics></math> is the relative metric estimating how the categorical accuracy is changed after the local optimization. For the case where <math id="S5.SS2.SSSx4.p1.5.m5.1" class="ltx_Math" alttext="LP(\cdot)" display="inline"><semantics id="S5.SS2.SSSx4.p1.5.m5.1a"><mrow id="S5.SS2.SSSx4.p1.5.m5.1.2" xref="S5.SS2.SSSx4.p1.5.m5.1.2.cmml"><mi id="S5.SS2.SSSx4.p1.5.m5.1.2.2" xref="S5.SS2.SSSx4.p1.5.m5.1.2.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSSx4.p1.5.m5.1.2.1" xref="S5.SS2.SSSx4.p1.5.m5.1.2.1.cmml">​</mo><mi id="S5.SS2.SSSx4.p1.5.m5.1.2.3" xref="S5.SS2.SSSx4.p1.5.m5.1.2.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSSx4.p1.5.m5.1.2.1a" xref="S5.SS2.SSSx4.p1.5.m5.1.2.1.cmml">​</mo><mrow id="S5.SS2.SSSx4.p1.5.m5.1.2.4.2" xref="S5.SS2.SSSx4.p1.5.m5.1.2.cmml"><mo stretchy="false" id="S5.SS2.SSSx4.p1.5.m5.1.2.4.2.1" xref="S5.SS2.SSSx4.p1.5.m5.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S5.SS2.SSSx4.p1.5.m5.1.1" xref="S5.SS2.SSSx4.p1.5.m5.1.1.cmml">⋅</mo><mo stretchy="false" id="S5.SS2.SSSx4.p1.5.m5.1.2.4.2.2" xref="S5.SS2.SSSx4.p1.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSSx4.p1.5.m5.1b"><apply id="S5.SS2.SSSx4.p1.5.m5.1.2.cmml" xref="S5.SS2.SSSx4.p1.5.m5.1.2"><times id="S5.SS2.SSSx4.p1.5.m5.1.2.1.cmml" xref="S5.SS2.SSSx4.p1.5.m5.1.2.1"></times><ci id="S5.SS2.SSSx4.p1.5.m5.1.2.2.cmml" xref="S5.SS2.SSSx4.p1.5.m5.1.2.2">𝐿</ci><ci id="S5.SS2.SSSx4.p1.5.m5.1.2.3.cmml" xref="S5.SS2.SSSx4.p1.5.m5.1.2.3">𝑃</ci><ci id="S5.SS2.SSSx4.p1.5.m5.1.1.cmml" xref="S5.SS2.SSSx4.p1.5.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSSx4.p1.5.m5.1c">LP(\cdot)</annotation></semantics></math> is larger than the value of one, we can interpret this as the improved accuracy after the optimization. In contrast, the lower value of one indicates the forgetting after the optimization. Based on this metric, we select the specific client who has the only half of categories and estimate <math id="S5.SS2.SSSx4.p1.6.m6.1" class="ltx_Math" alttext="LP" display="inline"><semantics id="S5.SS2.SSSx4.p1.6.m6.1a"><mrow id="S5.SS2.SSSx4.p1.6.m6.1.1" xref="S5.SS2.SSSx4.p1.6.m6.1.1.cmml"><mi id="S5.SS2.SSSx4.p1.6.m6.1.1.2" xref="S5.SS2.SSSx4.p1.6.m6.1.1.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSSx4.p1.6.m6.1.1.1" xref="S5.SS2.SSSx4.p1.6.m6.1.1.1.cmml">​</mo><mi id="S5.SS2.SSSx4.p1.6.m6.1.1.3" xref="S5.SS2.SSSx4.p1.6.m6.1.1.3.cmml">P</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSSx4.p1.6.m6.1b"><apply id="S5.SS2.SSSx4.p1.6.m6.1.1.cmml" xref="S5.SS2.SSSx4.p1.6.m6.1.1"><times id="S5.SS2.SSSx4.p1.6.m6.1.1.1.cmml" xref="S5.SS2.SSSx4.p1.6.m6.1.1.1"></times><ci id="S5.SS2.SSSx4.p1.6.m6.1.1.2.cmml" xref="S5.SS2.SSSx4.p1.6.m6.1.1.2">𝐿</ci><ci id="S5.SS2.SSSx4.p1.6.m6.1.1.3.cmml" xref="S5.SS2.SSSx4.p1.6.m6.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSSx4.p1.6.m6.1c">LP</annotation></semantics></math> for existing and absence categories. Table <a href="#S5.T5" title="Table 5 ‣ Forgetting ‣ 5.2 Experimental Results ‣ 5 Evaluations ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> and Figure <a href="#S5.F4" title="Figure 4 ‣ Forgetting ‣ 5.2 Experimental Results ‣ 5 Evaluations ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the LP performance and its dynamics during the local optimization, respectively<span id="footnote8" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">8</sup><span class="ltx_tag ltx_tag_note">8</span>Here, we use the trained models from each method that have nearly similar test accuracy to the global model.</span></span></span>. From the table, the accuracy for existing categories is improved after the optimization in all baselines. However, the baselines completely forget the discriminative ability for the absence classes. Interestingly, Lfd maintains the learned knowledge to some extent without learning any samples for the corresponding classes. The results can be explained by the distillation effect of the drift regularization on Eq. (<a href="#S4.E3" title="In 4.1 Drift Estimation by Prediction Discrepancy ‣ 4 Learning from Drift (LfD) ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).</p>
</div>
<figure id="S5.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>(Forgetting) Learning performance on CIFAR10 for existing and absence classes.</figcaption>
<p id="S5.T5.1" class="ltx_p ltx_align_center"><span id="S5.T5.1.1" class="ltx_text">
<span id="S5.T5.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:253.4pt;height:108pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S5.T5.1.1.1.1" class="ltx_p"><span id="S5.T5.1.1.1.1.1" class="ltx_text">
<span id="S5.T5.1.1.1.1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_thead">
<span id="S5.T5.1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="S5.T5.1.1.1.1.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">Method</span>
<span id="S5.T5.1.1.1.1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Existing categories</span>
<span id="S5.T5.1.1.1.1.1.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Absence categories</span></span>
</span>
<span class="ltx_tbody">
<span id="S5.T5.1.1.1.1.1.1.2.1" class="ltx_tr">
<span id="S5.T5.1.1.1.1.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">FedAvg</span>
<span id="S5.T5.1.1.1.1.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">1.06</span>
<span id="S5.T5.1.1.1.1.1.1.2.1.3" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">0.00</span></span>
<span id="S5.T5.1.1.1.1.1.1.3.2" class="ltx_tr">
<span id="S5.T5.1.1.1.1.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedAvgM</span>
<span id="S5.T5.1.1.1.1.1.1.3.2.2" class="ltx_td ltx_align_center">1.04</span>
<span id="S5.T5.1.1.1.1.1.1.3.2.3" class="ltx_td ltx_nopad_r ltx_align_center">0.00</span></span>
<span id="S5.T5.1.1.1.1.1.1.4.3" class="ltx_tr">
<span id="S5.T5.1.1.1.1.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedProx</span>
<span id="S5.T5.1.1.1.1.1.1.4.3.2" class="ltx_td ltx_align_center">1.05</span>
<span id="S5.T5.1.1.1.1.1.1.4.3.3" class="ltx_td ltx_nopad_r ltx_align_center">0.03</span></span>
<span id="S5.T5.1.1.1.1.1.1.5.4" class="ltx_tr">
<span id="S5.T5.1.1.1.1.1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">MOON</span>
<span id="S5.T5.1.1.1.1.1.1.5.4.2" class="ltx_td ltx_align_center">1.05</span>
<span id="S5.T5.1.1.1.1.1.1.5.4.3" class="ltx_td ltx_nopad_r ltx_align_center">0.02</span></span>
<span id="S5.T5.1.1.1.1.1.1.6.5" class="ltx_tr">
<span id="S5.T5.1.1.1.1.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">LfD (ours)</span>
<span id="S5.T5.1.1.1.1.1.1.6.5.2" class="ltx_td ltx_align_center ltx_border_bb">1.07</span>
<span id="S5.T5.1.1.1.1.1.1.6.5.3" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb">0.27</span></span>
</span>
</span></span></span>
</span></span></span></p>
</figure>
<figure id="S5.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.07189/assets/x5.png" id="S5.F4.sf1.g1" class="ltx_graphics ltx_img_landscape" width="415" height="162" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.07189/assets/x6.png" id="S5.F4.sf2.g1" class="ltx_graphics ltx_img_landscape" width="415" height="166" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Test accuracy (%) for existing (Top) and absence (Bottom) classes during the local optimization. This shows that only LfD maintains the knowledge for the absence classes.</figcaption>
</figure>
<figure id="S5.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F5.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.07189/assets/x7.png" id="S5.F5.sf1.g1" class="ltx_graphics ltx_img_landscape" width="401" height="160" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F5.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.07189/assets/x8.png" id="S5.F5.sf2.g1" class="ltx_graphics ltx_img_landscape" width="401" height="160" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Test accuracy over the different number of communication rounds (Top) and local optimization steps (Bottom).</figcaption>
</figure>
</section>
<section id="S5.SS2.SSSx5" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Efficiency</h4>

<div id="S5.SS2.SSSx5.p1" class="ltx_para">
<p id="S5.SS2.SSSx5.p1.1" class="ltx_p">We analyze how the number of communication rounds and local optimizations affect the performance of the global model. The experimental settings are the same for the CIFAR-10 dataset. Figure <a href="#S5.F5" title="Figure 5 ‣ Forgetting ‣ 5.2 Experimental Results ‣ 5 Evaluations ‣ Learning From Drift: Federated Learning on Non-IID Data via Drift Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows the results. For communication efficiency, LfD reaches the best performance of other baselines in earlier rounds (e.g., LfD achieves 71.5% on 22 rounds), indicating that the proposed method is less affected by the heterogeneous distributions. The analysis of computation efficiency could support the above results. LfD tends to obtain better performance on more local optimizations while other baselines start to lose the accuracy after between 5 and 30 epochs due to the client drift, which is commonly observed in other studies <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib16" title="" class="ltx_ref">2018</a>; Li, He, and Song <a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite>. These results validate that LfD can achieve strong accuracy with the small number of communication and computation costs.</p>
</div>
</section>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Related work</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this section, we mainly review the federated learning algorithms dealing with Non-IID data because it is one of the most challenging settings that degrade the performance and slow down the convergence <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib16" title="" class="ltx_ref">2018</a>, <a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Global Regularization</h3>

<div id="S6.SS1.p1" class="ltx_para">
<p id="S6.SS1.p1.1" class="ltx_p">While the FedAvg method works well with IID data, the performance significantly degrades with increasing heterogeneity on data distribution <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib16" title="" class="ltx_ref">2018</a>)</cite>. To prevent the worse effect, one of the mainstream is to give constraint to local optimization by maximizing agreement with the global model. SCAFFOLD <cite class="ltx_cite ltx_citemacro_citep">(Karimireddy et al. <a href="#bib.bib8" title="" class="ltx_ref">2020</a>)</cite> corrects local optimization by introducing <span id="S6.SS1.p1.1.1" class="ltx_text ltx_font_italic">control variate</span> from the global model. FedProx <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib16" title="" class="ltx_ref">2018</a>)</cite> regularize the networks by minimizing the euclidean distance to the global model. However, recent work <cite class="ltx_cite ltx_citemacro_citep">(Li, He, and Song <a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite> shows that those works have little or even no advantage over FedAvg and propose MOON which adopts the contrastive learning to increase agreement with the global model based on projected head vectors. FedDyn <cite class="ltx_cite ltx_citemacro_citep">(Acar et al. <a href="#bib.bib1" title="" class="ltx_ref">2021</a>)</cite> changes the local optimization to ensure that the local optimum on each client is asymptotically consistent with the stationary points of the global objective.</p>
</div>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Model Aggregation</h3>

<div id="S6.SS2.p1" class="ltx_para">
<p id="S6.SS2.p1.1" class="ltx_p">Instead of naively averaging the model weights, some of the works revise the aggregation step in the orchestration server. FedAvgM <cite class="ltx_cite ltx_citemacro_citep">(Hsu, Qi, and Brown <a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite> updates the aggregated model with server momentum. FedMA <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib25" title="" class="ltx_ref">2020</a>)</cite> mitigate the model heterogeneity by matching similar neurons (e.g., convolutional filters and hidden states in LSTMs) between clients and performing the average to build the global model. Similarly, Fed<sup id="S6.SS2.p1.1.1" class="ltx_sup">2</sup> <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a href="#bib.bib28" title="" class="ltx_ref">2021</a>)</cite> align similar features by model structure adaptation and feature-paired averaging on similar functioning neurons.</p>
</div>
</section>
<section id="S6.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Data Sharing and Generation</h3>

<div id="S6.SS3.p1" class="ltx_para">
<p id="S6.SS3.p1.1" class="ltx_p">Sharing the local data between clients is prohibited in the federated learning scenario. One of the practices is to share public data <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al. <a href="#bib.bib30" title="" class="ltx_ref">2018</a>; Li and Wang <a href="#bib.bib13" title="" class="ltx_ref">2019</a>)</cite> and unlabeled or synthesized data points <cite class="ltx_cite ltx_citemacro_citep">(Lin et al. <a href="#bib.bib19" title="" class="ltx_ref">2020</a>)</cite>. Instead of sharing or generating input points, <cite class="ltx_cite ltx_citemacro_citep">(Luo et al. <a href="#bib.bib21" title="" class="ltx_ref">2021</a>)</cite> estimate the feature statistics and augment the features followed the global distribution to calibrate the classifier. These works are promising but have potential risks for privacy preservation.</p>
</div>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">In this work, we have analyzed the existing federated learning algorithms that employ the global model to prevent client drift. We have observed that regularizing the features on logit space is most effective, whereas constraining other features and parameters does not provide much improvement over FedAvg. Based on the upfront analysis, we propose a federated learning algorithm, coined Learning from Drift (LfD). LfD explicitly estimates the client drift over logit space and regularizes the local model to learn the inverse direction of the estimated drift. In the experiments, we have evaluated our method and strong baselines with regard to five perspectives (i.e., Generalization, Heterogeneity, Scalability, Forgetting, and Efficiency). Comprehensive evaluation results clearly show that LfD effectively prevents client drift and achieves state-of-the-art results on experiments with diverse heterogeneous settings.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Acar et al. (2021)</span>
<span class="ltx_bibblock">
Acar, D. A. E.; Zhao, Y.; Navarro, R. M.; Mattina, M.; Whatmough, P. N.; and
Saligrama, V. 2021.

</span>
<span class="ltx_bibblock">Federated learning based on dynamic regularization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proc. The International Conference on Learning
Representations (ICLR)</em>.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2020)</span>
<span class="ltx_bibblock">
Chen, T.; Kornblith, S.; Norouzi, M.; and Hinton, G. 2020.

</span>
<span class="ltx_bibblock">A simple framework for contrastive learning of visual
representations.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proc. the International Conference on Machine Learning
(ICML)</em>.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Darlow et al. (2018)</span>
<span class="ltx_bibblock">
Darlow, L. N.; Crowley, E. J.; Antoniou, A.; and Storkey, A. J. 2018.

</span>
<span class="ltx_bibblock">Cinic-10 is not imagenet or cifar-10.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1810.03505</em>.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2020)</span>
<span class="ltx_bibblock">
He, C.; Li, S.; So, J.; Zeng, X.; Zhang, M.; Wang, H.; Wang, X.; Vepakomma, P.;
Singh, A.; Qiu, H.; et al. 2020.

</span>
<span class="ltx_bibblock">Fedml: A research library and benchmark for federated machine
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2007.13518</em>.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2016)</span>
<span class="ltx_bibblock">
He, K.; Zhang, X.; Ren, S.; and Sun, J. 2016.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proc. the Conference on Computer Vision and Pattern
Recognition (CVPR)</em>, 770–778.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hinton, Vinyals, and Dean (2015)</span>
<span class="ltx_bibblock">
Hinton, G.; Vinyals, O.; and Dean, J. 2015.

</span>
<span class="ltx_bibblock">Distilling the knowledge in a neural network.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1503.02531</em>.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu, Qi, and Brown (2020)</span>
<span class="ltx_bibblock">
Hsu, T.-M. H.; Qi, H.; and Brown, M. 2020.

</span>
<span class="ltx_bibblock">Federated visual classification with real-world data distribution.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proc. the European Conference on Computer Vision (ECCV)</em>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. (2020)</span>
<span class="ltx_bibblock">
Karimireddy, S. P.; Kale, S.; Mohri, M.; Reddi, S.; Stich, S.; and Suresh,
A. T. 2020.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proc. the International Conference on Machine Learning
(ICML)</em>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Konečnỳ et al. (2016)</span>
<span class="ltx_bibblock">
Konečnỳ, J.; McMahan, H. B.; Yu, F. X.; Richtárik, P.; Suresh,
A. T.; and Bacon, D. 2016.

</span>
<span class="ltx_bibblock">Federated learning: Strategies for improving communication
efficiency.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1610.05492</em>.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kornblith et al. (2019)</span>
<span class="ltx_bibblock">
Kornblith, S.; Norouzi, M.; Lee, H.; and Hinton, G. 2019.

</span>
<span class="ltx_bibblock">Similarity of neural network representations revisited.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proc. the International Conference on Machine Learning
(ICML)</em>.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky, Hinton et al. (2009)</span>
<span class="ltx_bibblock">
Krizhevsky, A.; Hinton, G.; et al. 2009.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Latré et al. (2011)</span>
<span class="ltx_bibblock">
Latré, B.; Braem, B.; Moerman, I.; Blondia, C.; and Demeester, P. 2011.

</span>
<span class="ltx_bibblock">A survey on wireless body area networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Wireless networks</em>, 17(1): 1–18.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li and Wang (2019)</span>
<span class="ltx_bibblock">
Li, D.; and Wang, J. 2019.

</span>
<span class="ltx_bibblock">Fedmd: Heterogenous federated learning via model distillation.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.03581</em>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2021)</span>
<span class="ltx_bibblock">
Li, Q.; Diao, Y.; Chen, Q.; and He, B. 2021.

</span>
<span class="ltx_bibblock">Federated learning on non-iid data silos: An experimental study.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2102.02079</em>.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li, He, and Song (2021)</span>
<span class="ltx_bibblock">
Li, Q.; He, B.; and Song, D. 2021.

</span>
<span class="ltx_bibblock">Model-Contrastive Federated Learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proc. the Conference on Computer Vision and Pattern
Recognition (CVPR)</em>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2018)</span>
<span class="ltx_bibblock">
Li, T.; Sahu, A. K.; Zaheer, M.; Sanjabi, M.; Talwalkar, A.; and Smith, V.
2018.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1812.06127</em>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Li, T.; Sahu, A. K.; Zaheer, M.; Sanjabi, M.; Talwalkar, A.; and Smith, V.
2020.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems</em>, 2: 429–450.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2019)</span>
<span class="ltx_bibblock">
Li, X.; Huang, K.; Yang, W.; Wang, S.; and Zhang, Z. 2019.

</span>
<span class="ltx_bibblock">On the Convergence of FedAvg on Non-IID Data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proc. The International Conference on Learning
Representations (ICLR)</em>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2020)</span>
<span class="ltx_bibblock">
Lin, T.; Kong, L.; Stich, S. U.; and Jaggi, M. 2020.

</span>
<span class="ltx_bibblock">Ensemble distillation for robust model fusion in federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Proc. the Advances in Neural Information Processing Systems
(NeurIPS)</em>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2007)</span>
<span class="ltx_bibblock">
Liu, T.; Lin, Y.; Wen, X.; Jorissen, R. N.; and Gilson, M. K. 2007.

</span>
<span class="ltx_bibblock">BindingDB: a web-accessible database of experimentally determined
protein–ligand binding affinities.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Nucleic acids research</em>, 35(suppl_1): D198–D201.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. (2021)</span>
<span class="ltx_bibblock">
Luo, M.; Chen, F.; Hu, D.; Zhang, Y.; Liang, J.; and Feng, J. 2021.

</span>
<span class="ltx_bibblock">No Fear of Heterogeneity: Classifier Calibration for Federated
Learning with Non-IID Data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proc. the Advances in Neural Information Processing Systems
(NeurIPS)</em>.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B.; Moore, E.; Ramage, D.; Hampson, S.; and y Arcas, B. A. 2017.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proc. the International Conference on Artificial
Intelligence and Statistics (AISTAT)</em>.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Russakovsky et al. (2015)</span>
<span class="ltx_bibblock">
Russakovsky, O.; Deng, J.; Su, H.; Krause, J.; Satheesh, S.; Ma, S.; Huang, Z.;
Karpathy, A.; Khosla, A.; Bernstein, M.; et al. 2015.

</span>
<span class="ltx_bibblock">Imagenet large scale visual recognition challenge.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">International journal of computer vision</em>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Szegedy et al. (2016)</span>
<span class="ltx_bibblock">
Szegedy, C.; Vanhoucke, V.; Ioffe, S.; Shlens, J.; and Wojna, Z. 2016.

</span>
<span class="ltx_bibblock">Rethinking the inception architecture for computer vision.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proc. the Conference on Computer Vision and Pattern
Recognition (CVPR)</em>.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020)</span>
<span class="ltx_bibblock">
Wang, H.; Yurochkin, M.; Sun, Y.; Papailiopoulos, D.; and Khazaeni, Y. 2020.

</span>
<span class="ltx_bibblock">Federated learning with matched averaging.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Proc. The International Conference on Learning
Representations (ICLR)</em>.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yadav and Yadav (2016)</span>
<span class="ltx_bibblock">
Yadav, S.; and Yadav, R. S. 2016.

</span>
<span class="ltx_bibblock">A review on energy efficient protocols in wireless sensor networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Wireless Networks</em>, 22(1): 335–350.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2019)</span>
<span class="ltx_bibblock">
Yang, Q.; Liu, Y.; Chen, T.; and Tong, Y. 2019.

</span>
<span class="ltx_bibblock">Federated machine learning: Concept and applications.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">ACM Transactions on Intelligent Systems and Technology (TIST)</em>.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2021)</span>
<span class="ltx_bibblock">
Yu, F.; Zhang, W.; Qin, Z.; Xu, Z.; Wang, D.; Liu, C.; Tian, Z.; and Chen, X.
2021.

</span>
<span class="ltx_bibblock">Fed2: Feature-Aligned Federated Learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proc. the ACM SIGKDD International Conference on Knowledge
Discovery and Data Mining (KDD)</em>, 2066–2074.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang, Zhao, and LeCun (2015)</span>
<span class="ltx_bibblock">
Zhang, X.; Zhao, J.; and LeCun, Y. 2015.

</span>
<span class="ltx_bibblock">Character-level convolutional networks for text classification.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proc. the Advances in Neural Information Processing Systems
(NeurIPS)</em>.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2018)</span>
<span class="ltx_bibblock">
Zhao, Y.; Li, M.; Lai, L.; Suda, N.; Civin, D.; and Chandra, V. 2018.

</span>
<span class="ltx_bibblock">Federated learning with non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhong et al. (2021)</span>
<span class="ltx_bibblock">
Zhong, Z.; Cui, J.; Liu, S.; and Jia, J. 2021.

</span>
<span class="ltx_bibblock">Improving Calibration for Long-Tailed Recognition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Proc. the Conference on Computer Vision and Pattern
Recognition (CVPR)</em>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p ltx_align_center"><span id="p1.1.1" class="ltx_text ltx_font_bold">Supplementary Materials for LfD</span></p>
</div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Algorithm for LfD</h2>

<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Federated Learning with LfD</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>Number of communication rounds <math id="alg1.l1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">T</annotation></semantics></math>, Number of local optimization epochs <math id="alg1.l1.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">E</annotation></semantics></math>, Local learning rate <math id="alg1.l1.m3.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.l1.m3.1a"><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">\eta</annotation></semantics></math>, Number of clients <math id="alg1.l1.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.l1.m4.1a"><mi id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">K</annotation></semantics></math> and their local data <math id="alg1.l1.m5.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="alg1.l1.m5.1a"><msub id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m5.1.1.2" xref="alg1.l1.m5.1.1.2.cmml">𝒟</mi><mi id="alg1.l1.m5.1.1.3" xref="alg1.l1.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><apply id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1"><csymbol cd="ambiguous" id="alg1.l1.m5.1.1.1.cmml" xref="alg1.l1.m5.1.1">subscript</csymbol><ci id="alg1.l1.m5.1.1.2.cmml" xref="alg1.l1.m5.1.1.2">𝒟</ci><ci id="alg1.l1.m5.1.1.3.cmml" xref="alg1.l1.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">\mathcal{D}_{k}</annotation></semantics></math> <math id="alg1.l1.m6.4" class="ltx_Math" alttext="\forall k\in\{1,2,...,K\}" display="inline"><semantics id="alg1.l1.m6.4a"><mrow id="alg1.l1.m6.4.5" xref="alg1.l1.m6.4.5.cmml"><mrow id="alg1.l1.m6.4.5.2" xref="alg1.l1.m6.4.5.2.cmml"><mo rspace="0.167em" id="alg1.l1.m6.4.5.2.1" xref="alg1.l1.m6.4.5.2.1.cmml">∀</mo><mi id="alg1.l1.m6.4.5.2.2" xref="alg1.l1.m6.4.5.2.2.cmml">k</mi></mrow><mo id="alg1.l1.m6.4.5.1" xref="alg1.l1.m6.4.5.1.cmml">∈</mo><mrow id="alg1.l1.m6.4.5.3.2" xref="alg1.l1.m6.4.5.3.1.cmml"><mo stretchy="false" id="alg1.l1.m6.4.5.3.2.1" xref="alg1.l1.m6.4.5.3.1.cmml">{</mo><mn id="alg1.l1.m6.1.1" xref="alg1.l1.m6.1.1.cmml">1</mn><mo id="alg1.l1.m6.4.5.3.2.2" xref="alg1.l1.m6.4.5.3.1.cmml">,</mo><mn id="alg1.l1.m6.2.2" xref="alg1.l1.m6.2.2.cmml">2</mn><mo id="alg1.l1.m6.4.5.3.2.3" xref="alg1.l1.m6.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l1.m6.3.3" xref="alg1.l1.m6.3.3.cmml">…</mi><mo id="alg1.l1.m6.4.5.3.2.4" xref="alg1.l1.m6.4.5.3.1.cmml">,</mo><mi id="alg1.l1.m6.4.4" xref="alg1.l1.m6.4.4.cmml">K</mi><mo stretchy="false" id="alg1.l1.m6.4.5.3.2.5" xref="alg1.l1.m6.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m6.4b"><apply id="alg1.l1.m6.4.5.cmml" xref="alg1.l1.m6.4.5"><in id="alg1.l1.m6.4.5.1.cmml" xref="alg1.l1.m6.4.5.1"></in><apply id="alg1.l1.m6.4.5.2.cmml" xref="alg1.l1.m6.4.5.2"><csymbol cd="latexml" id="alg1.l1.m6.4.5.2.1.cmml" xref="alg1.l1.m6.4.5.2.1">for-all</csymbol><ci id="alg1.l1.m6.4.5.2.2.cmml" xref="alg1.l1.m6.4.5.2.2">𝑘</ci></apply><set id="alg1.l1.m6.4.5.3.1.cmml" xref="alg1.l1.m6.4.5.3.2"><cn type="integer" id="alg1.l1.m6.1.1.cmml" xref="alg1.l1.m6.1.1">1</cn><cn type="integer" id="alg1.l1.m6.2.2.cmml" xref="alg1.l1.m6.2.2">2</cn><ci id="alg1.l1.m6.3.3.cmml" xref="alg1.l1.m6.3.3">…</ci><ci id="alg1.l1.m6.4.4.cmml" xref="alg1.l1.m6.4.4">𝐾</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m6.4c">\forall k\in\{1,2,...,K\}</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span><span id="alg1.l2.1" class="ltx_text" style="color:#808080;">// Server side:</span>  

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span><span id="alg1.l3.1" class="ltx_text ltx_font_bold">for</span> t <math id="alg1.l3.m1.4" class="ltx_Math" alttext="\in\{1,2,...,T\}" display="inline"><semantics id="alg1.l3.m1.4a"><mrow id="alg1.l3.m1.4.5" xref="alg1.l3.m1.4.5.cmml"><mi id="alg1.l3.m1.4.5.2" xref="alg1.l3.m1.4.5.2.cmml"></mi><mo id="alg1.l3.m1.4.5.1" xref="alg1.l3.m1.4.5.1.cmml">∈</mo><mrow id="alg1.l3.m1.4.5.3.2" xref="alg1.l3.m1.4.5.3.1.cmml"><mo stretchy="false" id="alg1.l3.m1.4.5.3.2.1" xref="alg1.l3.m1.4.5.3.1.cmml">{</mo><mn id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">1</mn><mo id="alg1.l3.m1.4.5.3.2.2" xref="alg1.l3.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">2</mn><mo id="alg1.l3.m1.4.5.3.2.3" xref="alg1.l3.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml">…</mi><mo id="alg1.l3.m1.4.5.3.2.4" xref="alg1.l3.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l3.m1.4.4" xref="alg1.l3.m1.4.4.cmml">T</mi><mo stretchy="false" id="alg1.l3.m1.4.5.3.2.5" xref="alg1.l3.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.4b"><apply id="alg1.l3.m1.4.5.cmml" xref="alg1.l3.m1.4.5"><in id="alg1.l3.m1.4.5.1.cmml" xref="alg1.l3.m1.4.5.1"></in><csymbol cd="latexml" id="alg1.l3.m1.4.5.2.cmml" xref="alg1.l3.m1.4.5.2">absent</csymbol><set id="alg1.l3.m1.4.5.3.1.cmml" xref="alg1.l3.m1.4.5.3.2"><cn type="integer" id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">1</cn><cn type="integer" id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">2</cn><ci id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3">…</ci><ci id="alg1.l3.m1.4.4.cmml" xref="alg1.l3.m1.4.4">𝑇</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.4c">\in\{1,2,...,T\}</annotation></semantics></math> <span id="alg1.l3.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>     <span id="alg1.l4.1" class="ltx_text ltx_font_bold">for</span> k <math id="alg1.l4.m1.4" class="ltx_Math" alttext="\in\{1,2,...,K\}" display="inline"><semantics id="alg1.l4.m1.4a"><mrow id="alg1.l4.m1.4.5" xref="alg1.l4.m1.4.5.cmml"><mi id="alg1.l4.m1.4.5.2" xref="alg1.l4.m1.4.5.2.cmml"></mi><mo id="alg1.l4.m1.4.5.1" xref="alg1.l4.m1.4.5.1.cmml">∈</mo><mrow id="alg1.l4.m1.4.5.3.2" xref="alg1.l4.m1.4.5.3.1.cmml"><mo stretchy="false" id="alg1.l4.m1.4.5.3.2.1" xref="alg1.l4.m1.4.5.3.1.cmml">{</mo><mn id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">1</mn><mo id="alg1.l4.m1.4.5.3.2.2" xref="alg1.l4.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml">2</mn><mo id="alg1.l4.m1.4.5.3.2.3" xref="alg1.l4.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l4.m1.3.3" xref="alg1.l4.m1.3.3.cmml">…</mi><mo id="alg1.l4.m1.4.5.3.2.4" xref="alg1.l4.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l4.m1.4.4" xref="alg1.l4.m1.4.4.cmml">K</mi><mo stretchy="false" id="alg1.l4.m1.4.5.3.2.5" xref="alg1.l4.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.4b"><apply id="alg1.l4.m1.4.5.cmml" xref="alg1.l4.m1.4.5"><in id="alg1.l4.m1.4.5.1.cmml" xref="alg1.l4.m1.4.5.1"></in><csymbol cd="latexml" id="alg1.l4.m1.4.5.2.cmml" xref="alg1.l4.m1.4.5.2">absent</csymbol><set id="alg1.l4.m1.4.5.3.1.cmml" xref="alg1.l4.m1.4.5.3.2"><cn type="integer" id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">1</cn><cn type="integer" id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2">2</cn><ci id="alg1.l4.m1.3.3.cmml" xref="alg1.l4.m1.3.3">…</ci><ci id="alg1.l4.m1.4.4.cmml" xref="alg1.l4.m1.4.4">𝐾</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.4c">\in\{1,2,...,K\}</annotation></semantics></math> <span id="alg1.l4.2" class="ltx_text ltx_font_bold">do</span> (<span id="alg1.l4.3" class="ltx_text ltx_font_bold">parallel process</span>)

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>         send the global model <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\omega_{t}" display="inline"><semantics id="alg1.l5.m1.1a"><msub id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">ω</mi><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝜔</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\omega_{t}</annotation></semantics></math> to client <math id="alg1.l5.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.l5.m2.1a"><mi id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><ci id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">k</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>         <math id="alg1.l6.m1.1" class="ltx_Math" alttext="\omega^{k}_{t}" display="inline"><semantics id="alg1.l6.m1.1a"><msubsup id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2.2" xref="alg1.l6.m1.1.1.2.2.cmml">ω</mi><mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">t</mi><mi id="alg1.l6.m1.1.1.2.3" xref="alg1.l6.m1.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1">subscript</csymbol><apply id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1">superscript</csymbol><ci id="alg1.l6.m1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.2.2">𝜔</ci><ci id="alg1.l6.m1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\omega^{k}_{t}</annotation></semantics></math> <math id="alg1.l6.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l6.m2.1a"><mo stretchy="false" id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><ci id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">\leftarrow</annotation></semantics></math> <span id="alg1.l6.1" class="ltx_text ltx_font_bold">LocalOptimization</span>(<math id="alg1.l6.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.l6.m3.1a"><mi id="alg1.l6.m3.1.1" xref="alg1.l6.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m3.1b"><ci id="alg1.l6.m3.1.1.cmml" xref="alg1.l6.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m3.1c">k</annotation></semantics></math>, <math id="alg1.l6.m4.1" class="ltx_Math" alttext="\omega_{t}" display="inline"><semantics id="alg1.l6.m4.1a"><msub id="alg1.l6.m4.1.1" xref="alg1.l6.m4.1.1.cmml"><mi id="alg1.l6.m4.1.1.2" xref="alg1.l6.m4.1.1.2.cmml">ω</mi><mi id="alg1.l6.m4.1.1.3" xref="alg1.l6.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m4.1b"><apply id="alg1.l6.m4.1.1.cmml" xref="alg1.l6.m4.1.1"><csymbol cd="ambiguous" id="alg1.l6.m4.1.1.1.cmml" xref="alg1.l6.m4.1.1">subscript</csymbol><ci id="alg1.l6.m4.1.1.2.cmml" xref="alg1.l6.m4.1.1.2">𝜔</ci><ci id="alg1.l6.m4.1.1.3.cmml" xref="alg1.l6.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m4.1c">\omega_{t}</annotation></semantics></math>)
     
</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>     aggregate the local model to build the global model <math id="alg1.l7.m1.1" class="ltx_Math" alttext="\omega_{t+1}" display="inline"><semantics id="alg1.l7.m1.1a"><msub id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">ω</mi><mrow id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"><mi id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2.cmml">t</mi><mo id="alg1.l7.m1.1.1.3.1" xref="alg1.l7.m1.1.1.3.1.cmml">+</mo><mn id="alg1.l7.m1.1.1.3.3" xref="alg1.l7.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝜔</ci><apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"><plus id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3.1"></plus><ci id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l7.m1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">\omega_{t+1}</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <math id="alg1.l8.m1.2" class="ltx_Math" alttext="{\omega}_{t+1}\leftarrow\sum_{k=1}^{K}\frac{|\mathcal{D}_{k}|}{|\mathcal{D}|}\cdot\omega_{t}^{k}" display="inline"><semantics id="alg1.l8.m1.2a"><mrow id="alg1.l8.m1.2.3" xref="alg1.l8.m1.2.3.cmml"><msub id="alg1.l8.m1.2.3.2" xref="alg1.l8.m1.2.3.2.cmml"><mi id="alg1.l8.m1.2.3.2.2" xref="alg1.l8.m1.2.3.2.2.cmml">ω</mi><mrow id="alg1.l8.m1.2.3.2.3" xref="alg1.l8.m1.2.3.2.3.cmml"><mi id="alg1.l8.m1.2.3.2.3.2" xref="alg1.l8.m1.2.3.2.3.2.cmml">t</mi><mo id="alg1.l8.m1.2.3.2.3.1" xref="alg1.l8.m1.2.3.2.3.1.cmml">+</mo><mn id="alg1.l8.m1.2.3.2.3.3" xref="alg1.l8.m1.2.3.2.3.3.cmml">1</mn></mrow></msub><mo rspace="0.111em" stretchy="false" id="alg1.l8.m1.2.3.1" xref="alg1.l8.m1.2.3.1.cmml">←</mo><mrow id="alg1.l8.m1.2.3.3" xref="alg1.l8.m1.2.3.3.cmml"><msubsup id="alg1.l8.m1.2.3.3.1" xref="alg1.l8.m1.2.3.3.1.cmml"><mo id="alg1.l8.m1.2.3.3.1.2.2" xref="alg1.l8.m1.2.3.3.1.2.2.cmml">∑</mo><mrow id="alg1.l8.m1.2.3.3.1.2.3" xref="alg1.l8.m1.2.3.3.1.2.3.cmml"><mi id="alg1.l8.m1.2.3.3.1.2.3.2" xref="alg1.l8.m1.2.3.3.1.2.3.2.cmml">k</mi><mo id="alg1.l8.m1.2.3.3.1.2.3.1" xref="alg1.l8.m1.2.3.3.1.2.3.1.cmml">=</mo><mn id="alg1.l8.m1.2.3.3.1.2.3.3" xref="alg1.l8.m1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l8.m1.2.3.3.1.3" xref="alg1.l8.m1.2.3.3.1.3.cmml">K</mi></msubsup><mrow id="alg1.l8.m1.2.3.3.2" xref="alg1.l8.m1.2.3.3.2.cmml"><mfrac id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml"><mrow id="alg1.l8.m1.1.1.1.1" xref="alg1.l8.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l8.m1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.2.1.cmml">|</mo><msub id="alg1.l8.m1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="alg1.l8.m1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.l8.m1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="alg1.l8.m1.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.cmml"><mo stretchy="false" id="alg1.l8.m1.2.2.2.3.1" xref="alg1.l8.m1.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.2.2.2.1" xref="alg1.l8.m1.2.2.2.1.cmml">𝒟</mi><mo stretchy="false" id="alg1.l8.m1.2.2.2.3.2" xref="alg1.l8.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0.222em" rspace="0.222em" id="alg1.l8.m1.2.3.3.2.1" xref="alg1.l8.m1.2.3.3.2.1.cmml">⋅</mo><msubsup id="alg1.l8.m1.2.3.3.2.2" xref="alg1.l8.m1.2.3.3.2.2.cmml"><mi id="alg1.l8.m1.2.3.3.2.2.2.2" xref="alg1.l8.m1.2.3.3.2.2.2.2.cmml">ω</mi><mi id="alg1.l8.m1.2.3.3.2.2.2.3" xref="alg1.l8.m1.2.3.3.2.2.2.3.cmml">t</mi><mi id="alg1.l8.m1.2.3.3.2.2.3" xref="alg1.l8.m1.2.3.3.2.2.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.2b"><apply id="alg1.l8.m1.2.3.cmml" xref="alg1.l8.m1.2.3"><ci id="alg1.l8.m1.2.3.1.cmml" xref="alg1.l8.m1.2.3.1">←</ci><apply id="alg1.l8.m1.2.3.2.cmml" xref="alg1.l8.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.3.2.1.cmml" xref="alg1.l8.m1.2.3.2">subscript</csymbol><ci id="alg1.l8.m1.2.3.2.2.cmml" xref="alg1.l8.m1.2.3.2.2">𝜔</ci><apply id="alg1.l8.m1.2.3.2.3.cmml" xref="alg1.l8.m1.2.3.2.3"><plus id="alg1.l8.m1.2.3.2.3.1.cmml" xref="alg1.l8.m1.2.3.2.3.1"></plus><ci id="alg1.l8.m1.2.3.2.3.2.cmml" xref="alg1.l8.m1.2.3.2.3.2">𝑡</ci><cn type="integer" id="alg1.l8.m1.2.3.2.3.3.cmml" xref="alg1.l8.m1.2.3.2.3.3">1</cn></apply></apply><apply id="alg1.l8.m1.2.3.3.cmml" xref="alg1.l8.m1.2.3.3"><apply id="alg1.l8.m1.2.3.3.1.cmml" xref="alg1.l8.m1.2.3.3.1"><csymbol cd="ambiguous" id="alg1.l8.m1.2.3.3.1.1.cmml" xref="alg1.l8.m1.2.3.3.1">superscript</csymbol><apply id="alg1.l8.m1.2.3.3.1.2.cmml" xref="alg1.l8.m1.2.3.3.1"><csymbol cd="ambiguous" id="alg1.l8.m1.2.3.3.1.2.1.cmml" xref="alg1.l8.m1.2.3.3.1">subscript</csymbol><sum id="alg1.l8.m1.2.3.3.1.2.2.cmml" xref="alg1.l8.m1.2.3.3.1.2.2"></sum><apply id="alg1.l8.m1.2.3.3.1.2.3.cmml" xref="alg1.l8.m1.2.3.3.1.2.3"><eq id="alg1.l8.m1.2.3.3.1.2.3.1.cmml" xref="alg1.l8.m1.2.3.3.1.2.3.1"></eq><ci id="alg1.l8.m1.2.3.3.1.2.3.2.cmml" xref="alg1.l8.m1.2.3.3.1.2.3.2">𝑘</ci><cn type="integer" id="alg1.l8.m1.2.3.3.1.2.3.3.cmml" xref="alg1.l8.m1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l8.m1.2.3.3.1.3.cmml" xref="alg1.l8.m1.2.3.3.1.3">𝐾</ci></apply><apply id="alg1.l8.m1.2.3.3.2.cmml" xref="alg1.l8.m1.2.3.3.2"><ci id="alg1.l8.m1.2.3.3.2.1.cmml" xref="alg1.l8.m1.2.3.3.2.1">⋅</ci><apply id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2"><divide id="alg1.l8.m1.2.2.3.cmml" xref="alg1.l8.m1.2.2"></divide><apply id="alg1.l8.m1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1"><abs id="alg1.l8.m1.1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.2"></abs><apply id="alg1.l8.m1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.2">𝒟</ci><ci id="alg1.l8.m1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="alg1.l8.m1.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.3"><abs id="alg1.l8.m1.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.3.1"></abs><ci id="alg1.l8.m1.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.1">𝒟</ci></apply></apply><apply id="alg1.l8.m1.2.3.3.2.2.cmml" xref="alg1.l8.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.3.3.2.2.1.cmml" xref="alg1.l8.m1.2.3.3.2.2">superscript</csymbol><apply id="alg1.l8.m1.2.3.3.2.2.2.cmml" xref="alg1.l8.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.3.3.2.2.2.1.cmml" xref="alg1.l8.m1.2.3.3.2.2">subscript</csymbol><ci id="alg1.l8.m1.2.3.3.2.2.2.2.cmml" xref="alg1.l8.m1.2.3.3.2.2.2.2">𝜔</ci><ci id="alg1.l8.m1.2.3.3.2.2.2.3.cmml" xref="alg1.l8.m1.2.3.3.2.2.2.3">𝑡</ci></apply><ci id="alg1.l8.m1.2.3.3.2.2.3.cmml" xref="alg1.l8.m1.2.3.3.2.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.2c">{\omega}_{t+1}\leftarrow\sum_{k=1}^{K}\frac{|\mathcal{D}_{k}|}{|\mathcal{D}|}\cdot\omega_{t}^{k}</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span><span id="alg1.l9.1" class="ltx_text" style="color:#808080;">// Client side:</span>  

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span><span id="alg1.l10.1" class="ltx_text ltx_font_bold">LocalOptimization</span>(k, <math id="alg1.l10.m1.1" class="ltx_Math" alttext="\omega_{t}" display="inline"><semantics id="alg1.l10.m1.1a"><msub id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">ω</mi><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝜔</ci><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\omega_{t}</annotation></semantics></math>):

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span><math id="alg1.l11.m1.1" class="ltx_Math" alttext="\omega^{k}_{t}\leftarrow\omega_{t}" display="inline"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><msubsup id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml"><mi id="alg1.l11.m1.1.1.2.2.2" xref="alg1.l11.m1.1.1.2.2.2.cmml">ω</mi><mi id="alg1.l11.m1.1.1.2.3" xref="alg1.l11.m1.1.1.2.3.cmml">t</mi><mi id="alg1.l11.m1.1.1.2.2.3" xref="alg1.l11.m1.1.1.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml">←</mo><msub id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml"><mi id="alg1.l11.m1.1.1.3.2" xref="alg1.l11.m1.1.1.3.2.cmml">ω</mi><mi id="alg1.l11.m1.1.1.3.3" xref="alg1.l11.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><ci id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1">←</ci><apply id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.2.1.cmml" xref="alg1.l11.m1.1.1.2">subscript</csymbol><apply id="alg1.l11.m1.1.1.2.2.cmml" xref="alg1.l11.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.2.2.1.cmml" xref="alg1.l11.m1.1.1.2">superscript</csymbol><ci id="alg1.l11.m1.1.1.2.2.2.cmml" xref="alg1.l11.m1.1.1.2.2.2">𝜔</ci><ci id="alg1.l11.m1.1.1.2.2.3.cmml" xref="alg1.l11.m1.1.1.2.2.3">𝑘</ci></apply><ci id="alg1.l11.m1.1.1.2.3.cmml" xref="alg1.l11.m1.1.1.2.3">𝑡</ci></apply><apply id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.3">subscript</csymbol><ci id="alg1.l11.m1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.3.2">𝜔</ci><ci id="alg1.l11.m1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\omega^{k}_{t}\leftarrow\omega_{t}</annotation></semantics></math>

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span><span id="alg1.l12.1" class="ltx_text ltx_font_bold">for</span> e <math id="alg1.l12.m1.4" class="ltx_Math" alttext="\in\{1,2,...,E\}" display="inline"><semantics id="alg1.l12.m1.4a"><mrow id="alg1.l12.m1.4.5" xref="alg1.l12.m1.4.5.cmml"><mi id="alg1.l12.m1.4.5.2" xref="alg1.l12.m1.4.5.2.cmml"></mi><mo id="alg1.l12.m1.4.5.1" xref="alg1.l12.m1.4.5.1.cmml">∈</mo><mrow id="alg1.l12.m1.4.5.3.2" xref="alg1.l12.m1.4.5.3.1.cmml"><mo stretchy="false" id="alg1.l12.m1.4.5.3.2.1" xref="alg1.l12.m1.4.5.3.1.cmml">{</mo><mn id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">1</mn><mo id="alg1.l12.m1.4.5.3.2.2" xref="alg1.l12.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l12.m1.2.2" xref="alg1.l12.m1.2.2.cmml">2</mn><mo id="alg1.l12.m1.4.5.3.2.3" xref="alg1.l12.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l12.m1.3.3" xref="alg1.l12.m1.3.3.cmml">…</mi><mo id="alg1.l12.m1.4.5.3.2.4" xref="alg1.l12.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l12.m1.4.4" xref="alg1.l12.m1.4.4.cmml">E</mi><mo stretchy="false" id="alg1.l12.m1.4.5.3.2.5" xref="alg1.l12.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.4b"><apply id="alg1.l12.m1.4.5.cmml" xref="alg1.l12.m1.4.5"><in id="alg1.l12.m1.4.5.1.cmml" xref="alg1.l12.m1.4.5.1"></in><csymbol cd="latexml" id="alg1.l12.m1.4.5.2.cmml" xref="alg1.l12.m1.4.5.2">absent</csymbol><set id="alg1.l12.m1.4.5.3.1.cmml" xref="alg1.l12.m1.4.5.3.2"><cn type="integer" id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">1</cn><cn type="integer" id="alg1.l12.m1.2.2.cmml" xref="alg1.l12.m1.2.2">2</cn><ci id="alg1.l12.m1.3.3.cmml" xref="alg1.l12.m1.3.3">…</ci><ci id="alg1.l12.m1.4.4.cmml" xref="alg1.l12.m1.4.4">𝐸</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.4c">\in\{1,2,...,E\}</annotation></semantics></math> <span id="alg1.l12.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span>     <span id="alg1.l13.1" class="ltx_text ltx_font_bold">for each</span> batch <math id="alg1.l13.m1.2" class="ltx_Math" alttext="B=\{b_{x},b_{y}\}\in\mathcal{D}_{k}" display="inline"><semantics id="alg1.l13.m1.2a"><mrow id="alg1.l13.m1.2.2" xref="alg1.l13.m1.2.2.cmml"><mi id="alg1.l13.m1.2.2.4" xref="alg1.l13.m1.2.2.4.cmml">B</mi><mo id="alg1.l13.m1.2.2.5" xref="alg1.l13.m1.2.2.5.cmml">=</mo><mrow id="alg1.l13.m1.2.2.2.2" xref="alg1.l13.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l13.m1.2.2.2.2.3" xref="alg1.l13.m1.2.2.2.3.cmml">{</mo><msub id="alg1.l13.m1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.2" xref="alg1.l13.m1.1.1.1.1.1.2.cmml">b</mi><mi id="alg1.l13.m1.1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.1.3.cmml">x</mi></msub><mo id="alg1.l13.m1.2.2.2.2.4" xref="alg1.l13.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l13.m1.2.2.2.2.2" xref="alg1.l13.m1.2.2.2.2.2.cmml"><mi id="alg1.l13.m1.2.2.2.2.2.2" xref="alg1.l13.m1.2.2.2.2.2.2.cmml">b</mi><mi id="alg1.l13.m1.2.2.2.2.2.3" xref="alg1.l13.m1.2.2.2.2.2.3.cmml">y</mi></msub><mo stretchy="false" id="alg1.l13.m1.2.2.2.2.5" xref="alg1.l13.m1.2.2.2.3.cmml">}</mo></mrow><mo id="alg1.l13.m1.2.2.6" xref="alg1.l13.m1.2.2.6.cmml">∈</mo><msub id="alg1.l13.m1.2.2.7" xref="alg1.l13.m1.2.2.7.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.2.2.7.2" xref="alg1.l13.m1.2.2.7.2.cmml">𝒟</mi><mi id="alg1.l13.m1.2.2.7.3" xref="alg1.l13.m1.2.2.7.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.2b"><apply id="alg1.l13.m1.2.2.cmml" xref="alg1.l13.m1.2.2"><and id="alg1.l13.m1.2.2a.cmml" xref="alg1.l13.m1.2.2"></and><apply id="alg1.l13.m1.2.2b.cmml" xref="alg1.l13.m1.2.2"><eq id="alg1.l13.m1.2.2.5.cmml" xref="alg1.l13.m1.2.2.5"></eq><ci id="alg1.l13.m1.2.2.4.cmml" xref="alg1.l13.m1.2.2.4">𝐵</ci><set id="alg1.l13.m1.2.2.2.3.cmml" xref="alg1.l13.m1.2.2.2.2"><apply id="alg1.l13.m1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.2">𝑏</ci><ci id="alg1.l13.m1.1.1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.3">𝑥</ci></apply><apply id="alg1.l13.m1.2.2.2.2.2.cmml" xref="alg1.l13.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.2.2.2.1.cmml" xref="alg1.l13.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l13.m1.2.2.2.2.2.2.cmml" xref="alg1.l13.m1.2.2.2.2.2.2">𝑏</ci><ci id="alg1.l13.m1.2.2.2.2.2.3.cmml" xref="alg1.l13.m1.2.2.2.2.2.3">𝑦</ci></apply></set></apply><apply id="alg1.l13.m1.2.2c.cmml" xref="alg1.l13.m1.2.2"><in id="alg1.l13.m1.2.2.6.cmml" xref="alg1.l13.m1.2.2.6"></in><share href="#alg1.l13.m1.2.2.2.cmml" id="alg1.l13.m1.2.2d.cmml" xref="alg1.l13.m1.2.2"></share><apply id="alg1.l13.m1.2.2.7.cmml" xref="alg1.l13.m1.2.2.7"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.7.1.cmml" xref="alg1.l13.m1.2.2.7">subscript</csymbol><ci id="alg1.l13.m1.2.2.7.2.cmml" xref="alg1.l13.m1.2.2.7.2">𝒟</ci><ci id="alg1.l13.m1.2.2.7.3.cmml" xref="alg1.l13.m1.2.2.7.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.2c">B=\{b_{x},b_{y}\}\in\mathcal{D}_{k}</annotation></semantics></math> <span id="alg1.l13.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span>         <span id="alg1.l14.1" class="ltx_text" style="color:#808080;">// (1) Drift Estimation</span>  

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span>         <math id="alg1.l15.m1.1" class="ltx_math_unparsed" alttext="f_{D}(b_{x})\leftarrow\log(\sigma(f_{P}(b_{x}))-\log(\sigma(f_{G}(b_{x}))" display="inline"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1b"><msub id="alg1.l15.m1.1.1"><mi id="alg1.l15.m1.1.1.2">f</mi><mi id="alg1.l15.m1.1.1.3">D</mi></msub><mrow id="alg1.l15.m1.1.2"><mo stretchy="false" id="alg1.l15.m1.1.2.1">(</mo><msub id="alg1.l15.m1.1.2.2"><mi id="alg1.l15.m1.1.2.2.2">b</mi><mi id="alg1.l15.m1.1.2.2.3">x</mi></msub><mo stretchy="false" id="alg1.l15.m1.1.2.3">)</mo></mrow><mo stretchy="false" id="alg1.l15.m1.1.3">←</mo><mi id="alg1.l15.m1.1.4">log</mi><mrow id="alg1.l15.m1.1.5"><mo stretchy="false" id="alg1.l15.m1.1.5.1">(</mo><mi id="alg1.l15.m1.1.5.2">σ</mi><mrow id="alg1.l15.m1.1.5.3"><mo stretchy="false" id="alg1.l15.m1.1.5.3.1">(</mo><msub id="alg1.l15.m1.1.5.3.2"><mi id="alg1.l15.m1.1.5.3.2.2">f</mi><mi id="alg1.l15.m1.1.5.3.2.3">P</mi></msub><mrow id="alg1.l15.m1.1.5.3.3"><mo stretchy="false" id="alg1.l15.m1.1.5.3.3.1">(</mo><msub id="alg1.l15.m1.1.5.3.3.2"><mi id="alg1.l15.m1.1.5.3.3.2.2">b</mi><mi id="alg1.l15.m1.1.5.3.3.2.3">x</mi></msub><mo stretchy="false" id="alg1.l15.m1.1.5.3.3.3">)</mo></mrow><mo stretchy="false" id="alg1.l15.m1.1.5.3.4">)</mo></mrow><mo id="alg1.l15.m1.1.5.4">−</mo><mi id="alg1.l15.m1.1.5.5">log</mi><mrow id="alg1.l15.m1.1.5.6"><mo stretchy="false" id="alg1.l15.m1.1.5.6.1">(</mo><mi id="alg1.l15.m1.1.5.6.2">σ</mi><mrow id="alg1.l15.m1.1.5.6.3"><mo stretchy="false" id="alg1.l15.m1.1.5.6.3.1">(</mo><msub id="alg1.l15.m1.1.5.6.3.2"><mi id="alg1.l15.m1.1.5.6.3.2.2">f</mi><mi id="alg1.l15.m1.1.5.6.3.2.3">G</mi></msub><mrow id="alg1.l15.m1.1.5.6.3.3"><mo stretchy="false" id="alg1.l15.m1.1.5.6.3.3.1">(</mo><msub id="alg1.l15.m1.1.5.6.3.3.2"><mi id="alg1.l15.m1.1.5.6.3.3.2.2">b</mi><mi id="alg1.l15.m1.1.5.6.3.3.2.3">x</mi></msub><mo stretchy="false" id="alg1.l15.m1.1.5.6.3.3.3">)</mo></mrow><mo stretchy="false" id="alg1.l15.m1.1.5.6.3.4">)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">f_{D}(b_{x})\leftarrow\log(\sigma(f_{P}(b_{x}))-\log(\sigma(f_{G}(b_{x}))</annotation></semantics></math>

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16:</span>         <math id="alg1.l16.m1.1" class="ltx_Math" alttext="\hat{b}_{y}\leftarrow\sigma(-f_{D}(b_{x}))" display="inline"><semantics id="alg1.l16.m1.1a"><mrow id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><msub id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml"><mover accent="true" id="alg1.l16.m1.1.1.3.2" xref="alg1.l16.m1.1.1.3.2.cmml"><mi id="alg1.l16.m1.1.1.3.2.2" xref="alg1.l16.m1.1.1.3.2.2.cmml">b</mi><mo id="alg1.l16.m1.1.1.3.2.1" xref="alg1.l16.m1.1.1.3.2.1.cmml">^</mo></mover><mi id="alg1.l16.m1.1.1.3.3" xref="alg1.l16.m1.1.1.3.3.cmml">y</mi></msub><mo stretchy="false" id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml">←</mo><mrow id="alg1.l16.m1.1.1.1" xref="alg1.l16.m1.1.1.1.cmml"><mi id="alg1.l16.m1.1.1.1.3" xref="alg1.l16.m1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.1.2" xref="alg1.l16.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l16.m1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l16.m1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l16.m1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l16.m1.1.1.1.1.1.1a" xref="alg1.l16.m1.1.1.1.1.1.1.cmml">−</mo><mrow id="alg1.l16.m1.1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l16.m1.1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.1.1.3.2" xref="alg1.l16.m1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="alg1.l16.m1.1.1.1.1.1.1.1.3.3" xref="alg1.l16.m1.1.1.1.1.1.1.1.3.3.cmml">D</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l16.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">b</mi><mi id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">x</mi></msub><mo stretchy="false" id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="alg1.l16.m1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><ci id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2">←</ci><apply id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.3">subscript</csymbol><apply id="alg1.l16.m1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.3.2"><ci id="alg1.l16.m1.1.1.3.2.1.cmml" xref="alg1.l16.m1.1.1.3.2.1">^</ci><ci id="alg1.l16.m1.1.1.3.2.2.cmml" xref="alg1.l16.m1.1.1.3.2.2">𝑏</ci></apply><ci id="alg1.l16.m1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.3.3">𝑦</ci></apply><apply id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1"><times id="alg1.l16.m1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.2"></times><ci id="alg1.l16.m1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.3">𝜎</ci><apply id="alg1.l16.m1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1"><minus id="alg1.l16.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1"></minus><apply id="alg1.l16.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1"><times id="alg1.l16.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.2"></times><apply id="alg1.l16.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="alg1.l16.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.3.3">𝐷</ci></apply><apply id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.2">𝑏</ci><ci id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">\hat{b}_{y}\leftarrow\sigma(-f_{D}(b_{x}))</annotation></semantics></math>

</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17:</span>         <span id="alg1.l17.1" class="ltx_text" style="color:#808080;">// (2) Drift Regularization</span>  

</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18:</span>         <math id="alg1.l18.m1.3" class="ltx_Math" alttext="\mathcal{R}(B)\leftarrow CrossEntropy(f(b_{x}),\hat{b}_{y})" display="inline"><semantics id="alg1.l18.m1.3a"><mrow id="alg1.l18.m1.3.3" xref="alg1.l18.m1.3.3.cmml"><mrow id="alg1.l18.m1.3.3.4" xref="alg1.l18.m1.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l18.m1.3.3.4.2" xref="alg1.l18.m1.3.3.4.2.cmml">ℛ</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.3.3.4.1" xref="alg1.l18.m1.3.3.4.1.cmml">​</mo><mrow id="alg1.l18.m1.3.3.4.3.2" xref="alg1.l18.m1.3.3.4.cmml"><mo stretchy="false" id="alg1.l18.m1.3.3.4.3.2.1" xref="alg1.l18.m1.3.3.4.cmml">(</mo><mi id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml">B</mi><mo stretchy="false" id="alg1.l18.m1.3.3.4.3.2.2" xref="alg1.l18.m1.3.3.4.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l18.m1.3.3.3" xref="alg1.l18.m1.3.3.3.cmml">←</mo><mrow id="alg1.l18.m1.3.3.2" xref="alg1.l18.m1.3.3.2.cmml"><mi id="alg1.l18.m1.3.3.2.4" xref="alg1.l18.m1.3.3.2.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.3.3.2.3" xref="alg1.l18.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l18.m1.3.3.2.5" xref="alg1.l18.m1.3.3.2.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.3.3.2.3a" xref="alg1.l18.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l18.m1.3.3.2.6" xref="alg1.l18.m1.3.3.2.6.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.3.3.2.3b" xref="alg1.l18.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l18.m1.3.3.2.7" xref="alg1.l18.m1.3.3.2.7.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.3.3.2.3c" xref="alg1.l18.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l18.m1.3.3.2.8" xref="alg1.l18.m1.3.3.2.8.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.3.3.2.3d" xref="alg1.l18.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l18.m1.3.3.2.9" xref="alg1.l18.m1.3.3.2.9.cmml">E</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.3.3.2.3e" xref="alg1.l18.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l18.m1.3.3.2.10" xref="alg1.l18.m1.3.3.2.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.3.3.2.3f" xref="alg1.l18.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l18.m1.3.3.2.11" xref="alg1.l18.m1.3.3.2.11.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.3.3.2.3g" xref="alg1.l18.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l18.m1.3.3.2.12" xref="alg1.l18.m1.3.3.2.12.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.3.3.2.3h" xref="alg1.l18.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l18.m1.3.3.2.13" xref="alg1.l18.m1.3.3.2.13.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.3.3.2.3i" xref="alg1.l18.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l18.m1.3.3.2.14" xref="alg1.l18.m1.3.3.2.14.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.3.3.2.3j" xref="alg1.l18.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l18.m1.3.3.2.15" xref="alg1.l18.m1.3.3.2.15.cmml">y</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.3.3.2.3k" xref="alg1.l18.m1.3.3.2.3.cmml">​</mo><mrow id="alg1.l18.m1.3.3.2.2.2" xref="alg1.l18.m1.3.3.2.2.3.cmml"><mo stretchy="false" id="alg1.l18.m1.3.3.2.2.2.3" xref="alg1.l18.m1.3.3.2.2.3.cmml">(</mo><mrow id="alg1.l18.m1.2.2.1.1.1.1" xref="alg1.l18.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l18.m1.2.2.1.1.1.1.3" xref="alg1.l18.m1.2.2.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.2.2.1.1.1.1.2" xref="alg1.l18.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l18.m1.2.2.1.1.1.1.1.1" xref="alg1.l18.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l18.m1.2.2.1.1.1.1.1.1.2" xref="alg1.l18.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l18.m1.2.2.1.1.1.1.1.1.1" xref="alg1.l18.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="alg1.l18.m1.2.2.1.1.1.1.1.1.1.2" xref="alg1.l18.m1.2.2.1.1.1.1.1.1.1.2.cmml">b</mi><mi id="alg1.l18.m1.2.2.1.1.1.1.1.1.1.3" xref="alg1.l18.m1.2.2.1.1.1.1.1.1.1.3.cmml">x</mi></msub><mo stretchy="false" id="alg1.l18.m1.2.2.1.1.1.1.1.1.3" xref="alg1.l18.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l18.m1.3.3.2.2.2.4" xref="alg1.l18.m1.3.3.2.2.3.cmml">,</mo><msub id="alg1.l18.m1.3.3.2.2.2.2" xref="alg1.l18.m1.3.3.2.2.2.2.cmml"><mover accent="true" id="alg1.l18.m1.3.3.2.2.2.2.2" xref="alg1.l18.m1.3.3.2.2.2.2.2.cmml"><mi id="alg1.l18.m1.3.3.2.2.2.2.2.2" xref="alg1.l18.m1.3.3.2.2.2.2.2.2.cmml">b</mi><mo id="alg1.l18.m1.3.3.2.2.2.2.2.1" xref="alg1.l18.m1.3.3.2.2.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l18.m1.3.3.2.2.2.2.3" xref="alg1.l18.m1.3.3.2.2.2.2.3.cmml">y</mi></msub><mo stretchy="false" id="alg1.l18.m1.3.3.2.2.2.5" xref="alg1.l18.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.3b"><apply id="alg1.l18.m1.3.3.cmml" xref="alg1.l18.m1.3.3"><ci id="alg1.l18.m1.3.3.3.cmml" xref="alg1.l18.m1.3.3.3">←</ci><apply id="alg1.l18.m1.3.3.4.cmml" xref="alg1.l18.m1.3.3.4"><times id="alg1.l18.m1.3.3.4.1.cmml" xref="alg1.l18.m1.3.3.4.1"></times><ci id="alg1.l18.m1.3.3.4.2.cmml" xref="alg1.l18.m1.3.3.4.2">ℛ</ci><ci id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1">𝐵</ci></apply><apply id="alg1.l18.m1.3.3.2.cmml" xref="alg1.l18.m1.3.3.2"><times id="alg1.l18.m1.3.3.2.3.cmml" xref="alg1.l18.m1.3.3.2.3"></times><ci id="alg1.l18.m1.3.3.2.4.cmml" xref="alg1.l18.m1.3.3.2.4">𝐶</ci><ci id="alg1.l18.m1.3.3.2.5.cmml" xref="alg1.l18.m1.3.3.2.5">𝑟</ci><ci id="alg1.l18.m1.3.3.2.6.cmml" xref="alg1.l18.m1.3.3.2.6">𝑜</ci><ci id="alg1.l18.m1.3.3.2.7.cmml" xref="alg1.l18.m1.3.3.2.7">𝑠</ci><ci id="alg1.l18.m1.3.3.2.8.cmml" xref="alg1.l18.m1.3.3.2.8">𝑠</ci><ci id="alg1.l18.m1.3.3.2.9.cmml" xref="alg1.l18.m1.3.3.2.9">𝐸</ci><ci id="alg1.l18.m1.3.3.2.10.cmml" xref="alg1.l18.m1.3.3.2.10">𝑛</ci><ci id="alg1.l18.m1.3.3.2.11.cmml" xref="alg1.l18.m1.3.3.2.11">𝑡</ci><ci id="alg1.l18.m1.3.3.2.12.cmml" xref="alg1.l18.m1.3.3.2.12">𝑟</ci><ci id="alg1.l18.m1.3.3.2.13.cmml" xref="alg1.l18.m1.3.3.2.13">𝑜</ci><ci id="alg1.l18.m1.3.3.2.14.cmml" xref="alg1.l18.m1.3.3.2.14">𝑝</ci><ci id="alg1.l18.m1.3.3.2.15.cmml" xref="alg1.l18.m1.3.3.2.15">𝑦</ci><interval closure="open" id="alg1.l18.m1.3.3.2.2.3.cmml" xref="alg1.l18.m1.3.3.2.2.2"><apply id="alg1.l18.m1.2.2.1.1.1.1.cmml" xref="alg1.l18.m1.2.2.1.1.1.1"><times id="alg1.l18.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l18.m1.2.2.1.1.1.1.2"></times><ci id="alg1.l18.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l18.m1.2.2.1.1.1.1.3">𝑓</ci><apply id="alg1.l18.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l18.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.2.2.1.1.1.1.1.1.1.2">𝑏</ci><ci id="alg1.l18.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.2.2.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="alg1.l18.m1.3.3.2.2.2.2.cmml" xref="alg1.l18.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.3.3.2.2.2.2.1.cmml" xref="alg1.l18.m1.3.3.2.2.2.2">subscript</csymbol><apply id="alg1.l18.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l18.m1.3.3.2.2.2.2.2"><ci id="alg1.l18.m1.3.3.2.2.2.2.2.1.cmml" xref="alg1.l18.m1.3.3.2.2.2.2.2.1">^</ci><ci id="alg1.l18.m1.3.3.2.2.2.2.2.2.cmml" xref="alg1.l18.m1.3.3.2.2.2.2.2.2">𝑏</ci></apply><ci id="alg1.l18.m1.3.3.2.2.2.2.3.cmml" xref="alg1.l18.m1.3.3.2.2.2.2.3">𝑦</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.3c">\mathcal{R}(B)\leftarrow CrossEntropy(f(b_{x}),\hat{b}_{y})</annotation></semantics></math>

</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19:</span>         <math id="alg1.l19.m1.3" class="ltx_Math" alttext="\mathcal{L}(B)\leftarrow CrossEntropy(f(b_{x}),{b}_{y})" display="inline"><semantics id="alg1.l19.m1.3a"><mrow id="alg1.l19.m1.3.3" xref="alg1.l19.m1.3.3.cmml"><mrow id="alg1.l19.m1.3.3.4" xref="alg1.l19.m1.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l19.m1.3.3.4.2" xref="alg1.l19.m1.3.3.4.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="alg1.l19.m1.3.3.4.1" xref="alg1.l19.m1.3.3.4.1.cmml">​</mo><mrow id="alg1.l19.m1.3.3.4.3.2" xref="alg1.l19.m1.3.3.4.cmml"><mo stretchy="false" id="alg1.l19.m1.3.3.4.3.2.1" xref="alg1.l19.m1.3.3.4.cmml">(</mo><mi id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml">B</mi><mo stretchy="false" id="alg1.l19.m1.3.3.4.3.2.2" xref="alg1.l19.m1.3.3.4.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l19.m1.3.3.3" xref="alg1.l19.m1.3.3.3.cmml">←</mo><mrow id="alg1.l19.m1.3.3.2" xref="alg1.l19.m1.3.3.2.cmml"><mi id="alg1.l19.m1.3.3.2.4" xref="alg1.l19.m1.3.3.2.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.l19.m1.3.3.2.3" xref="alg1.l19.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l19.m1.3.3.2.5" xref="alg1.l19.m1.3.3.2.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l19.m1.3.3.2.3a" xref="alg1.l19.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l19.m1.3.3.2.6" xref="alg1.l19.m1.3.3.2.6.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l19.m1.3.3.2.3b" xref="alg1.l19.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l19.m1.3.3.2.7" xref="alg1.l19.m1.3.3.2.7.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l19.m1.3.3.2.3c" xref="alg1.l19.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l19.m1.3.3.2.8" xref="alg1.l19.m1.3.3.2.8.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l19.m1.3.3.2.3d" xref="alg1.l19.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l19.m1.3.3.2.9" xref="alg1.l19.m1.3.3.2.9.cmml">E</mi><mo lspace="0em" rspace="0em" id="alg1.l19.m1.3.3.2.3e" xref="alg1.l19.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l19.m1.3.3.2.10" xref="alg1.l19.m1.3.3.2.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l19.m1.3.3.2.3f" xref="alg1.l19.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l19.m1.3.3.2.11" xref="alg1.l19.m1.3.3.2.11.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l19.m1.3.3.2.3g" xref="alg1.l19.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l19.m1.3.3.2.12" xref="alg1.l19.m1.3.3.2.12.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l19.m1.3.3.2.3h" xref="alg1.l19.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l19.m1.3.3.2.13" xref="alg1.l19.m1.3.3.2.13.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l19.m1.3.3.2.3i" xref="alg1.l19.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l19.m1.3.3.2.14" xref="alg1.l19.m1.3.3.2.14.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l19.m1.3.3.2.3j" xref="alg1.l19.m1.3.3.2.3.cmml">​</mo><mi id="alg1.l19.m1.3.3.2.15" xref="alg1.l19.m1.3.3.2.15.cmml">y</mi><mo lspace="0em" rspace="0em" id="alg1.l19.m1.3.3.2.3k" xref="alg1.l19.m1.3.3.2.3.cmml">​</mo><mrow id="alg1.l19.m1.3.3.2.2.2" xref="alg1.l19.m1.3.3.2.2.3.cmml"><mo stretchy="false" id="alg1.l19.m1.3.3.2.2.2.3" xref="alg1.l19.m1.3.3.2.2.3.cmml">(</mo><mrow id="alg1.l19.m1.2.2.1.1.1.1" xref="alg1.l19.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l19.m1.2.2.1.1.1.1.3" xref="alg1.l19.m1.2.2.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="alg1.l19.m1.2.2.1.1.1.1.2" xref="alg1.l19.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l19.m1.2.2.1.1.1.1.1.1" xref="alg1.l19.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l19.m1.2.2.1.1.1.1.1.1.2" xref="alg1.l19.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l19.m1.2.2.1.1.1.1.1.1.1" xref="alg1.l19.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="alg1.l19.m1.2.2.1.1.1.1.1.1.1.2" xref="alg1.l19.m1.2.2.1.1.1.1.1.1.1.2.cmml">b</mi><mi id="alg1.l19.m1.2.2.1.1.1.1.1.1.1.3" xref="alg1.l19.m1.2.2.1.1.1.1.1.1.1.3.cmml">x</mi></msub><mo stretchy="false" id="alg1.l19.m1.2.2.1.1.1.1.1.1.3" xref="alg1.l19.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l19.m1.3.3.2.2.2.4" xref="alg1.l19.m1.3.3.2.2.3.cmml">,</mo><msub id="alg1.l19.m1.3.3.2.2.2.2" xref="alg1.l19.m1.3.3.2.2.2.2.cmml"><mi id="alg1.l19.m1.3.3.2.2.2.2.2" xref="alg1.l19.m1.3.3.2.2.2.2.2.cmml">b</mi><mi id="alg1.l19.m1.3.3.2.2.2.2.3" xref="alg1.l19.m1.3.3.2.2.2.2.3.cmml">y</mi></msub><mo stretchy="false" id="alg1.l19.m1.3.3.2.2.2.5" xref="alg1.l19.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.3b"><apply id="alg1.l19.m1.3.3.cmml" xref="alg1.l19.m1.3.3"><ci id="alg1.l19.m1.3.3.3.cmml" xref="alg1.l19.m1.3.3.3">←</ci><apply id="alg1.l19.m1.3.3.4.cmml" xref="alg1.l19.m1.3.3.4"><times id="alg1.l19.m1.3.3.4.1.cmml" xref="alg1.l19.m1.3.3.4.1"></times><ci id="alg1.l19.m1.3.3.4.2.cmml" xref="alg1.l19.m1.3.3.4.2">ℒ</ci><ci id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1">𝐵</ci></apply><apply id="alg1.l19.m1.3.3.2.cmml" xref="alg1.l19.m1.3.3.2"><times id="alg1.l19.m1.3.3.2.3.cmml" xref="alg1.l19.m1.3.3.2.3"></times><ci id="alg1.l19.m1.3.3.2.4.cmml" xref="alg1.l19.m1.3.3.2.4">𝐶</ci><ci id="alg1.l19.m1.3.3.2.5.cmml" xref="alg1.l19.m1.3.3.2.5">𝑟</ci><ci id="alg1.l19.m1.3.3.2.6.cmml" xref="alg1.l19.m1.3.3.2.6">𝑜</ci><ci id="alg1.l19.m1.3.3.2.7.cmml" xref="alg1.l19.m1.3.3.2.7">𝑠</ci><ci id="alg1.l19.m1.3.3.2.8.cmml" xref="alg1.l19.m1.3.3.2.8">𝑠</ci><ci id="alg1.l19.m1.3.3.2.9.cmml" xref="alg1.l19.m1.3.3.2.9">𝐸</ci><ci id="alg1.l19.m1.3.3.2.10.cmml" xref="alg1.l19.m1.3.3.2.10">𝑛</ci><ci id="alg1.l19.m1.3.3.2.11.cmml" xref="alg1.l19.m1.3.3.2.11">𝑡</ci><ci id="alg1.l19.m1.3.3.2.12.cmml" xref="alg1.l19.m1.3.3.2.12">𝑟</ci><ci id="alg1.l19.m1.3.3.2.13.cmml" xref="alg1.l19.m1.3.3.2.13">𝑜</ci><ci id="alg1.l19.m1.3.3.2.14.cmml" xref="alg1.l19.m1.3.3.2.14">𝑝</ci><ci id="alg1.l19.m1.3.3.2.15.cmml" xref="alg1.l19.m1.3.3.2.15">𝑦</ci><interval closure="open" id="alg1.l19.m1.3.3.2.2.3.cmml" xref="alg1.l19.m1.3.3.2.2.2"><apply id="alg1.l19.m1.2.2.1.1.1.1.cmml" xref="alg1.l19.m1.2.2.1.1.1.1"><times id="alg1.l19.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l19.m1.2.2.1.1.1.1.2"></times><ci id="alg1.l19.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l19.m1.2.2.1.1.1.1.3">𝑓</ci><apply id="alg1.l19.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l19.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l19.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l19.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg1.l19.m1.2.2.1.1.1.1.1.1.1.2">𝑏</ci><ci id="alg1.l19.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg1.l19.m1.2.2.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="alg1.l19.m1.3.3.2.2.2.2.cmml" xref="alg1.l19.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l19.m1.3.3.2.2.2.2.1.cmml" xref="alg1.l19.m1.3.3.2.2.2.2">subscript</csymbol><ci id="alg1.l19.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l19.m1.3.3.2.2.2.2.2">𝑏</ci><ci id="alg1.l19.m1.3.3.2.2.2.2.3.cmml" xref="alg1.l19.m1.3.3.2.2.2.2.3">𝑦</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.3c">\mathcal{L}(B)\leftarrow CrossEntropy(f(b_{x}),{b}_{y})</annotation></semantics></math>

</div>
<div id="alg1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20:</span>         <math id="alg1.l20.m1.4" class="ltx_Math" alttext="\omega_{t}^{k}\leftarrow\omega_{t}^{k}-\eta\nabla_{\omega_{t}^{k}}(\mathcal{L}(B)+\mathcal{R}(B))" display="inline"><semantics id="alg1.l20.m1.4a"><mrow id="alg1.l20.m1.4.4" xref="alg1.l20.m1.4.4.cmml"><msubsup id="alg1.l20.m1.4.4.4" xref="alg1.l20.m1.4.4.4.cmml"><mi id="alg1.l20.m1.4.4.4.2.2" xref="alg1.l20.m1.4.4.4.2.2.cmml">ω</mi><mi id="alg1.l20.m1.4.4.4.2.3" xref="alg1.l20.m1.4.4.4.2.3.cmml">t</mi><mi id="alg1.l20.m1.4.4.4.3" xref="alg1.l20.m1.4.4.4.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l20.m1.4.4.3" xref="alg1.l20.m1.4.4.3.cmml">←</mo><mrow id="alg1.l20.m1.4.4.2" xref="alg1.l20.m1.4.4.2.cmml"><msubsup id="alg1.l20.m1.4.4.2.4" xref="alg1.l20.m1.4.4.2.4.cmml"><mi id="alg1.l20.m1.4.4.2.4.2.2" xref="alg1.l20.m1.4.4.2.4.2.2.cmml">ω</mi><mi id="alg1.l20.m1.4.4.2.4.2.3" xref="alg1.l20.m1.4.4.2.4.2.3.cmml">t</mi><mi id="alg1.l20.m1.4.4.2.4.3" xref="alg1.l20.m1.4.4.2.4.3.cmml">k</mi></msubsup><mo id="alg1.l20.m1.4.4.2.3" xref="alg1.l20.m1.4.4.2.3.cmml">−</mo><mrow id="alg1.l20.m1.4.4.2.2" xref="alg1.l20.m1.4.4.2.2.cmml"><mi id="alg1.l20.m1.4.4.2.2.4" xref="alg1.l20.m1.4.4.2.2.4.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l20.m1.4.4.2.2.3" xref="alg1.l20.m1.4.4.2.2.3.cmml">​</mo><mrow id="alg1.l20.m1.4.4.2.2.2.2" xref="alg1.l20.m1.4.4.2.2.2.3.cmml"><msub id="alg1.l20.m1.3.3.1.1.1.1.1" xref="alg1.l20.m1.3.3.1.1.1.1.1.cmml"><mo id="alg1.l20.m1.3.3.1.1.1.1.1.2" xref="alg1.l20.m1.3.3.1.1.1.1.1.2.cmml">∇</mo><msubsup id="alg1.l20.m1.3.3.1.1.1.1.1.3" xref="alg1.l20.m1.3.3.1.1.1.1.1.3.cmml"><mi id="alg1.l20.m1.3.3.1.1.1.1.1.3.2.2" xref="alg1.l20.m1.3.3.1.1.1.1.1.3.2.2.cmml">ω</mi><mi id="alg1.l20.m1.3.3.1.1.1.1.1.3.2.3" xref="alg1.l20.m1.3.3.1.1.1.1.1.3.2.3.cmml">t</mi><mi id="alg1.l20.m1.3.3.1.1.1.1.1.3.3" xref="alg1.l20.m1.3.3.1.1.1.1.1.3.3.cmml">k</mi></msubsup></msub><mrow id="alg1.l20.m1.4.4.2.2.2.2.2" xref="alg1.l20.m1.4.4.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l20.m1.4.4.2.2.2.2.2.2" xref="alg1.l20.m1.4.4.2.2.2.3.cmml">(</mo><mrow id="alg1.l20.m1.4.4.2.2.2.2.2.1" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.cmml"><mrow id="alg1.l20.m1.4.4.2.2.2.2.2.1.2" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l20.m1.4.4.2.2.2.2.2.1.2.2" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.2.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.4.4.2.2.2.2.2.1.2.1" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.2.1.cmml">​</mo><mrow id="alg1.l20.m1.4.4.2.2.2.2.2.1.2.3.2" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.2.cmml"><mo stretchy="false" id="alg1.l20.m1.4.4.2.2.2.2.2.1.2.3.2.1" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.2.cmml">(</mo><mi id="alg1.l20.m1.1.1" xref="alg1.l20.m1.1.1.cmml">B</mi><mo stretchy="false" id="alg1.l20.m1.4.4.2.2.2.2.2.1.2.3.2.2" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="alg1.l20.m1.4.4.2.2.2.2.2.1.1" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.1.cmml">+</mo><mrow id="alg1.l20.m1.4.4.2.2.2.2.2.1.3" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l20.m1.4.4.2.2.2.2.2.1.3.2" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.3.2.cmml">ℛ</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.4.4.2.2.2.2.2.1.3.1" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.3.1.cmml">​</mo><mrow id="alg1.l20.m1.4.4.2.2.2.2.2.1.3.3.2" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.3.cmml"><mo stretchy="false" id="alg1.l20.m1.4.4.2.2.2.2.2.1.3.3.2.1" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.3.cmml">(</mo><mi id="alg1.l20.m1.2.2" xref="alg1.l20.m1.2.2.cmml">B</mi><mo stretchy="false" id="alg1.l20.m1.4.4.2.2.2.2.2.1.3.3.2.2" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="alg1.l20.m1.4.4.2.2.2.2.2.3" xref="alg1.l20.m1.4.4.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.4b"><apply id="alg1.l20.m1.4.4.cmml" xref="alg1.l20.m1.4.4"><ci id="alg1.l20.m1.4.4.3.cmml" xref="alg1.l20.m1.4.4.3">←</ci><apply id="alg1.l20.m1.4.4.4.cmml" xref="alg1.l20.m1.4.4.4"><csymbol cd="ambiguous" id="alg1.l20.m1.4.4.4.1.cmml" xref="alg1.l20.m1.4.4.4">superscript</csymbol><apply id="alg1.l20.m1.4.4.4.2.cmml" xref="alg1.l20.m1.4.4.4"><csymbol cd="ambiguous" id="alg1.l20.m1.4.4.4.2.1.cmml" xref="alg1.l20.m1.4.4.4">subscript</csymbol><ci id="alg1.l20.m1.4.4.4.2.2.cmml" xref="alg1.l20.m1.4.4.4.2.2">𝜔</ci><ci id="alg1.l20.m1.4.4.4.2.3.cmml" xref="alg1.l20.m1.4.4.4.2.3">𝑡</ci></apply><ci id="alg1.l20.m1.4.4.4.3.cmml" xref="alg1.l20.m1.4.4.4.3">𝑘</ci></apply><apply id="alg1.l20.m1.4.4.2.cmml" xref="alg1.l20.m1.4.4.2"><minus id="alg1.l20.m1.4.4.2.3.cmml" xref="alg1.l20.m1.4.4.2.3"></minus><apply id="alg1.l20.m1.4.4.2.4.cmml" xref="alg1.l20.m1.4.4.2.4"><csymbol cd="ambiguous" id="alg1.l20.m1.4.4.2.4.1.cmml" xref="alg1.l20.m1.4.4.2.4">superscript</csymbol><apply id="alg1.l20.m1.4.4.2.4.2.cmml" xref="alg1.l20.m1.4.4.2.4"><csymbol cd="ambiguous" id="alg1.l20.m1.4.4.2.4.2.1.cmml" xref="alg1.l20.m1.4.4.2.4">subscript</csymbol><ci id="alg1.l20.m1.4.4.2.4.2.2.cmml" xref="alg1.l20.m1.4.4.2.4.2.2">𝜔</ci><ci id="alg1.l20.m1.4.4.2.4.2.3.cmml" xref="alg1.l20.m1.4.4.2.4.2.3">𝑡</ci></apply><ci id="alg1.l20.m1.4.4.2.4.3.cmml" xref="alg1.l20.m1.4.4.2.4.3">𝑘</ci></apply><apply id="alg1.l20.m1.4.4.2.2.cmml" xref="alg1.l20.m1.4.4.2.2"><times id="alg1.l20.m1.4.4.2.2.3.cmml" xref="alg1.l20.m1.4.4.2.2.3"></times><ci id="alg1.l20.m1.4.4.2.2.4.cmml" xref="alg1.l20.m1.4.4.2.2.4">𝜂</ci><apply id="alg1.l20.m1.4.4.2.2.2.3.cmml" xref="alg1.l20.m1.4.4.2.2.2.2"><apply id="alg1.l20.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l20.m1.3.3.1.1.1.1.1.1.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="alg1.l20.m1.3.3.1.1.1.1.1.2.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.1.2">∇</ci><apply id="alg1.l20.m1.3.3.1.1.1.1.1.3.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l20.m1.3.3.1.1.1.1.1.3.1.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.1.3">superscript</csymbol><apply id="alg1.l20.m1.3.3.1.1.1.1.1.3.2.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l20.m1.3.3.1.1.1.1.1.3.2.1.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l20.m1.3.3.1.1.1.1.1.3.2.2.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.1.3.2.2">𝜔</ci><ci id="alg1.l20.m1.3.3.1.1.1.1.1.3.2.3.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="alg1.l20.m1.3.3.1.1.1.1.1.3.3.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="alg1.l20.m1.4.4.2.2.2.2.2.1.cmml" xref="alg1.l20.m1.4.4.2.2.2.2.2.1"><plus id="alg1.l20.m1.4.4.2.2.2.2.2.1.1.cmml" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.1"></plus><apply id="alg1.l20.m1.4.4.2.2.2.2.2.1.2.cmml" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.2"><times id="alg1.l20.m1.4.4.2.2.2.2.2.1.2.1.cmml" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.2.1"></times><ci id="alg1.l20.m1.4.4.2.2.2.2.2.1.2.2.cmml" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.2.2">ℒ</ci><ci id="alg1.l20.m1.1.1.cmml" xref="alg1.l20.m1.1.1">𝐵</ci></apply><apply id="alg1.l20.m1.4.4.2.2.2.2.2.1.3.cmml" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.3"><times id="alg1.l20.m1.4.4.2.2.2.2.2.1.3.1.cmml" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.3.1"></times><ci id="alg1.l20.m1.4.4.2.2.2.2.2.1.3.2.cmml" xref="alg1.l20.m1.4.4.2.2.2.2.2.1.3.2">ℛ</ci><ci id="alg1.l20.m1.2.2.cmml" xref="alg1.l20.m1.2.2">𝐵</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.4c">\omega_{t}^{k}\leftarrow\omega_{t}^{k}-\eta\nabla_{\omega_{t}^{k}}(\mathcal{L}(B)+\mathcal{R}(B))</annotation></semantics></math>
     <span id="alg1.l20.1" class="ltx_text ltx_font_bold">return</span> the locally trained model <math id="alg1.l20.m2.1" class="ltx_Math" alttext="\omega^{k}_{t}" display="inline"><semantics id="alg1.l20.m2.1a"><msubsup id="alg1.l20.m2.1.1" xref="alg1.l20.m2.1.1.cmml"><mi id="alg1.l20.m2.1.1.2.2" xref="alg1.l20.m2.1.1.2.2.cmml">ω</mi><mi id="alg1.l20.m2.1.1.3" xref="alg1.l20.m2.1.1.3.cmml">t</mi><mi id="alg1.l20.m2.1.1.2.3" xref="alg1.l20.m2.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l20.m2.1b"><apply id="alg1.l20.m2.1.1.cmml" xref="alg1.l20.m2.1.1"><csymbol cd="ambiguous" id="alg1.l20.m2.1.1.1.cmml" xref="alg1.l20.m2.1.1">subscript</csymbol><apply id="alg1.l20.m2.1.1.2.cmml" xref="alg1.l20.m2.1.1"><csymbol cd="ambiguous" id="alg1.l20.m2.1.1.2.1.cmml" xref="alg1.l20.m2.1.1">superscript</csymbol><ci id="alg1.l20.m2.1.1.2.2.cmml" xref="alg1.l20.m2.1.1.2.2">𝜔</ci><ci id="alg1.l20.m2.1.1.2.3.cmml" xref="alg1.l20.m2.1.1.2.3">𝑘</ci></apply><ci id="alg1.l20.m2.1.1.3.cmml" xref="alg1.l20.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m2.1c">\omega^{k}_{t}</annotation></semantics></math>

</div>
</div>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2309.07188" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2309.07189" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2309.07189">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2309.07189" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2309.07190" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 06:38:56 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
