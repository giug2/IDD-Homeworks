<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Med-TTT: Vision Test-Time Training model for Medical Image Segmentation</title>
<!--Generated on Thu Oct  3 14:30:23 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.02523v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#S1" title="In Med-TTT: Vision Test-Time Training model for Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#S2" title="In Med-TTT: Vision Test-Time Training model for Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#S2.SS1" title="In 2 Preliminaries ‣ Med-TTT: Vision Test-Time Training model for Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Theoretical Equivalence</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#S2.SS2" title="In 2 Preliminaries ‣ Med-TTT: Vision Test-Time Training model for Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Linear Complexity Implementation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#S3" title="In Med-TTT: Vision Test-Time Training model for Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#S3.SS1" title="In 3 Method ‣ Med-TTT: Vision Test-Time Training model for Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Vision-TTT Layer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#S3.SS2" title="In 3 Method ‣ Med-TTT: Vision Test-Time Training model for Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Multi-Resolution Fusion and Frequency Domain Information Integration</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#S3.SS3" title="In 3 Method ‣ Med-TTT: Vision Test-Time Training model for Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Loss function</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#S4" title="In Med-TTT: Vision Test-Time Training model for Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#S4.SS1" title="In 4 Experiment ‣ Med-TTT: Vision Test-Time Training model for Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#S4.SS2" title="In 4 Experiment ‣ Med-TTT: Vision Test-Time Training model for Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Comparison with SOTA models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#S4.SS3" title="In 4 Experiment ‣ Med-TTT: Vision Test-Time Training model for Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Ablation experiments</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#S5" title="In Med-TTT: Vision Test-Time Training model for Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Med-TTT: Vision Test-Time Training model for Medical Image Segmentation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Jiashu Xu 
<br class="ltx_break"/>School of Science
<br class="ltx_break"/>Harbin Institute of Technology, Shenzhen
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id1.1.id1">jiashu.xu04@gmail.com</span>
<br class="ltx_break"/>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id2.id1">Medical image segmentation plays a crucial role in clinical diagnosis and treatment planning. Although models based on convolutional neural networks (CNNs) and Transformers have achieved remarkable success in medical image segmentation tasks, they still face challenges such as high computational complexity and the loss of local features when capturing long-range dependencies. To address these limitations, we propose Med-TTT, a visual backbone network integrated with Test-Time Training (TTT) layers, which incorporates dynamic adjustment capabilities. Med-TTT introduces the Vision-TTT layer, which enables effective modeling of long-range dependencies with linear computational complexity and adaptive parameter adjustment during inference. Furthermore, we designed a multi-resolution fusion mechanism to combine image features at different scales, facilitating the identification of subtle lesion characteristics in complex backgrounds. At the same time, we adopt a frequency domain feature enhancement strategy based on high pass filtering, which can better capture texture and fine-grained details in images. Experimental results demonstrate that Med-TTT significantly outperforms existing methods on multiple medical image datasets, exhibiting strong segmentation capabilities, particularly in complex image backgrounds. The model achieves leading performance in terms of accuracy, sensitivity, and Dice coefficient, providing an efficient and robust solution for the field of medical image segmentation.The code is available at <a class="ltx_ref ltx_href" href="https://github.com/Jiashu-Xu/Med-TTT" title="">https://github.com/Jiashu-Xu/Med-TTT</a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="p1">
<p class="ltx_p" id="p1.2"><em class="ltx_emph ltx_font_bold ltx_font_italic" id="p1.2.1">K</em><span class="ltx_text ltx_font_bold" id="p1.2.2">eywords</span> Medical image segmentation  <math alttext="\cdot" class="ltx_Math" display="inline" id="p1.1.m1.1"><semantics id="p1.1.m1.1a"><mo id="p1.1.m1.1.1" xref="p1.1.m1.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.1.m1.1b"><ci id="p1.1.m1.1.1.cmml" xref="p1.1.m1.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.1.m1.1c">\cdot</annotation><annotation encoding="application/x-llamapun" id="p1.1.m1.1d">⋅</annotation></semantics></math>
TTT  <math alttext="\cdot" class="ltx_Math" display="inline" id="p1.2.m2.1"><semantics id="p1.2.m2.1a"><mo id="p1.2.m2.1.1" xref="p1.2.m2.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.2.m2.1b"><ci id="p1.2.m2.1.1.cmml" xref="p1.2.m2.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.2.m2.1c">\cdot</annotation><annotation encoding="application/x-llamapun" id="p1.2.m2.1d">⋅</annotation></semantics></math>
multi-resolution</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Modern medical research is heavily reliant on various types of medical imaging.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib1" title="">1</a>]</cite> Medical images aim to provide accurate visual representations of the structure and function of different tissues and organs in the human body, assisting medical professionals and researchers in comprehensively understanding normal and pathological conditions. Whether in cutting-edge laboratory research or in clinical disease diagnosis, the rich information provided by medical image analysis is crucial for making scientific inferences and accurate diagnoses.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib2" title="">2</a>]</cite> Furthermore, automatic medical image segmentation technology can assist doctors in faster pathological diagnosis, thereby improving patient care efficiency.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Due to their strong feature representation capabilities, Convolutional Neural Networks (CNNs) have been widely applied in the field of medical image segmentation and have achieved promising results<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib3" title="">3</a>]</cite>. Fully Convolutional Networks (FCNs)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib4" title="">4</a>]</cite>, as an advanced version of CNNs, enable pixel-level segmentation of images of any size. With further research, U-Net emerged as a novel approach based on FCNs<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib5" title="">5</a>]</cite>, using a symmetric encoder-decoder structure with skip connections to effectively enhance contextual information. Raj et al.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib6" title="">6</a>]</cite> demonstrated that U-Net-based methods could achieve effective segmentation on MRI data, while Safi et al.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib7" title="">7</a>]</cite> showed the effectiveness of CNNs in handling brain tumors with varying sizes, locations, and blurred boundaries. These studies underscore the strong performance of CNNs in the field of medical image segmentation, particularly for brain tumor segmentation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Although CNN based models have excellent representation capabilities, they exhibit inherent limitations in modeling long-range dependencies within images due to the locality of convolutional kernels. The Transformer model can naturally capture global context, so research interest based on the Transformer model is becoming increasingly strong. TransUnet<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib8" title="">8</a>]</cite>, a pioneering Transformer-based model, first utilizes the Vision Transformer (ViT) for feature extraction during the encoding stage and then employs CNNs for decoding, demonstrating strong capabilities in capturing global information. TransFuse<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib9" title="">9</a>]</cite> combines ViT and CNN in a parallel architecture, capturing both local and global features simultaneously. In addition, Swin-UNet<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib10" title="">10</a>]</cite> integrates the Swin Transformer into a U-shaped architecture, introducing the first purely Transformer-based U-Net model.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Although Transformer-based models have demonstrated excellent performance in global context modeling, the quadratic complexity of the self-attention mechanism leads to high computational overhead, particularly for dense prediction tasks like medical image segmentation. These challenges prompted us to develop a novel medical image segmentation architecture aimed at capturing robust long-range information while maintaining computational complexity within a manageable range.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">In recent years, Test-Time Training (TTT) has emerged as a novel sequence modeling layer, demonstrating linear complexity and highly expressive hidden states<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib11" title="">11</a>]</cite>. TTT treats the traditional fixed hidden state as a model that can be dynamically updated through machine learning and optimized using a self-supervised learning mechanism. This dynamic adjustment enables the model to fine-tune its parameters based on test data, thereby exhibiting greater flexibility and expressive power in capturing complex long-range dependencies. Compared to Transformers and Mamba, TTT layers maintain efficiency while demonstrating superior performance in handling long-context sequences.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">In medical image segmentation tasks, targets often exhibit considerable diversity in shape and size<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib13" title="">13</a>]</cite>. Consequently, it is of paramount importance to ensure that these variations are effectively captured, as this significantly impacts the performance of the model. Conventional single-resolution extraction techniques often fail to effectively capture this variability. Multi-resolution features can capture information at various levels: high-resolution branches focus on details such as edges and textures, while low-resolution branches emphasize global structure and context. By combining these multi-scale features, the model can gain a more comprehensive understanding of target regions in complex medical images. Additionally, multi-resolution fusion enables the model to effectively integrate information across different branches, thereby improving segmentation precision. This capability is especially valuable when handling small lesions or complex structures, as multi-level feature fusion significantly enhances the model’s ability to identify important regions.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">Moreover, the majority of extant models are predominantly spatial in nature, which may result in the inadvertent omission of crucial information present within the frequency domain. Information in the frequency domain can reveal periodic patterns and global characteristics of images, thereby facilitating the identification of nuances that may prove challenging to discern in the spatial domain<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib15" title="">15</a>]</cite>. These include textures, edges, and periodic structures. This information is of paramount importance for the accurate capture of subtle differences within images.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">In this paper, we introduce Med-TTT, a model that integrates the Vision-TTT backbone network, aiming to overcome the limitations of long-range dependency modeling in biomedical image segmentation tasks. The Vision-TTT layer enables dynamic parameter adjustment during testing, making it more effective in capturing both local details and long-range dependencies. Additionally, we incorporated a multi-resolution fusion mechanism and high-pass filtered frequency domain information. Extensive experiments on multiple medical imaging datasets demonstrate that Med-TTT achieves a good balance between model complexity and performance, validating its effectiveness and practicality for medical image segmentation tasks.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p9">
<p class="ltx_p" id="S1.p9.1">In summary, our contributions are as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We introduced Vision-TTT, a visual backbone network integrated with Test-Time Training (TTT) layers, which enables long-range dependency modeling with linear computational complexity while performing self-supervised adaptation during testing. This hybrid design effectively addresses the challenges of long-term dependency modeling and enhances the model’s generalization ability across diverse data distributions.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We incorporated a multi-resolution fusion mechanism and frequency domain information through high-pass filtering. The inclusion of these two mechanisms brings more feature diversity to the TTT-based Vision-TTT, significantly boosting the model’s performance.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We conducted extensive performance evaluations of the proposed model. The results demonstrate that our model achieves high accuracy (96.07%), mIoU (78.83%), and DSC (88.16%), validating its effectiveness.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminaries</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Theoretical Equivalence</h3>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.2">Consider the linear complexity TTT layer model, with a learning rate of <math alttext="\eta=\frac{1}{2}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mrow id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml">η</mi><mo id="S2.SS1.p1.1.m1.1.1.1" xref="S2.SS1.p1.1.m1.1.1.1.cmml">=</mo><mfrac id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml"><mn id="S2.SS1.p1.1.m1.1.1.3.2" xref="S2.SS1.p1.1.m1.1.1.3.2.cmml">1</mn><mn id="S2.SS1.p1.1.m1.1.1.3.3" xref="S2.SS1.p1.1.m1.1.1.3.3.cmml">2</mn></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><eq id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1"></eq><ci id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2">𝜂</ci><apply id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3"><divide id="S2.SS1.p1.1.m1.1.1.3.1.cmml" xref="S2.SS1.p1.1.m1.1.1.3"></divide><cn id="S2.SS1.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S2.SS1.p1.1.m1.1.1.3.2">1</cn><cn id="S2.SS1.p1.1.m1.1.1.3.3.cmml" type="integer" xref="S2.SS1.p1.1.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\eta=\frac{1}{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_η = divide start_ARG 1 end_ARG start_ARG 2 end_ARG</annotation></semantics></math> using batch gradient descent, and an initial weight of <math alttext="W_{0}=0" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mrow id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><msub id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml"><mi id="S2.SS1.p1.2.m2.1.1.2.2" xref="S2.SS1.p1.2.m2.1.1.2.2.cmml">W</mi><mn id="S2.SS1.p1.2.m2.1.1.2.3" xref="S2.SS1.p1.2.m2.1.1.2.3.cmml">0</mn></msub><mo id="S2.SS1.p1.2.m2.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><eq id="S2.SS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1"></eq><apply id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.2.1.cmml" xref="S2.SS1.p1.2.m2.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.2.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2.2">𝑊</ci><cn id="S2.SS1.p1.2.m2.1.1.2.3.cmml" type="integer" xref="S2.SS1.p1.2.m2.1.1.2.3">0</cn></apply><cn id="S2.SS1.p1.2.m2.1.1.3.cmml" type="integer" xref="S2.SS1.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">W_{0}=0</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_W start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = 0</annotation></semantics></math>.
The loss function is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\ell(W;x_{t})=\left|W\theta_{K}x_{t}-\theta_{V}x_{t}\right|^{2}." class="ltx_Math" display="block" id="S2.E1.m1.2"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2.2.1" xref="S2.E1.m1.2.2.1.1.cmml"><mrow id="S2.E1.m1.2.2.1.1" xref="S2.E1.m1.2.2.1.1.cmml"><mrow id="S2.E1.m1.2.2.1.1.1" xref="S2.E1.m1.2.2.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.1.3" mathvariant="normal" xref="S2.E1.m1.2.2.1.1.1.3.cmml">ℓ</mi><mo id="S2.E1.m1.2.2.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.2.2.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.2.cmml"><mo id="S2.E1.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.2.2.1.1.1.1.2.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">W</mi><mo id="S2.E1.m1.2.2.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.2.cmml">;</mo><msub id="S2.E1.m1.2.2.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E1.m1.2.2.1.1.1.1.1.4" stretchy="false" xref="S2.E1.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.2.2.1.1.3" xref="S2.E1.m1.2.2.1.1.3.cmml">=</mo><msup id="S2.E1.m1.2.2.1.1.2" xref="S2.E1.m1.2.2.1.1.2.cmml"><mrow id="S2.E1.m1.2.2.1.1.2.1.1" xref="S2.E1.m1.2.2.1.1.2.1.2.cmml"><mo id="S2.E1.m1.2.2.1.1.2.1.1.2" xref="S2.E1.m1.2.2.1.1.2.1.2.1.cmml">|</mo><mrow id="S2.E1.m1.2.2.1.1.2.1.1.1" xref="S2.E1.m1.2.2.1.1.2.1.1.1.cmml"><mrow id="S2.E1.m1.2.2.1.1.2.1.1.1.2" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.cmml"><mi id="S2.E1.m1.2.2.1.1.2.1.1.1.2.2" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.2.cmml">W</mi><mo id="S2.E1.m1.2.2.1.1.2.1.1.1.2.1" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.1.cmml">⁢</mo><msub id="S2.E1.m1.2.2.1.1.2.1.1.1.2.3" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.3.cmml"><mi id="S2.E1.m1.2.2.1.1.2.1.1.1.2.3.2" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.3.2.cmml">θ</mi><mi id="S2.E1.m1.2.2.1.1.2.1.1.1.2.3.3" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.3.3.cmml">K</mi></msub><mo id="S2.E1.m1.2.2.1.1.2.1.1.1.2.1a" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.1.cmml">⁢</mo><msub id="S2.E1.m1.2.2.1.1.2.1.1.1.2.4" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.4.cmml"><mi id="S2.E1.m1.2.2.1.1.2.1.1.1.2.4.2" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.4.2.cmml">x</mi><mi id="S2.E1.m1.2.2.1.1.2.1.1.1.2.4.3" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.4.3.cmml">t</mi></msub></mrow><mo id="S2.E1.m1.2.2.1.1.2.1.1.1.1" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.cmml">−</mo><mrow id="S2.E1.m1.2.2.1.1.2.1.1.1.3" xref="S2.E1.m1.2.2.1.1.2.1.1.1.3.cmml"><msub id="S2.E1.m1.2.2.1.1.2.1.1.1.3.2" xref="S2.E1.m1.2.2.1.1.2.1.1.1.3.2.cmml"><mi id="S2.E1.m1.2.2.1.1.2.1.1.1.3.2.2" xref="S2.E1.m1.2.2.1.1.2.1.1.1.3.2.2.cmml">θ</mi><mi id="S2.E1.m1.2.2.1.1.2.1.1.1.3.2.3" xref="S2.E1.m1.2.2.1.1.2.1.1.1.3.2.3.cmml">V</mi></msub><mo id="S2.E1.m1.2.2.1.1.2.1.1.1.3.1" xref="S2.E1.m1.2.2.1.1.2.1.1.1.3.1.cmml">⁢</mo><msub id="S2.E1.m1.2.2.1.1.2.1.1.1.3.3" xref="S2.E1.m1.2.2.1.1.2.1.1.1.3.3.cmml"><mi id="S2.E1.m1.2.2.1.1.2.1.1.1.3.3.2" xref="S2.E1.m1.2.2.1.1.2.1.1.1.3.3.2.cmml">x</mi><mi id="S2.E1.m1.2.2.1.1.2.1.1.1.3.3.3" xref="S2.E1.m1.2.2.1.1.2.1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><mo id="S2.E1.m1.2.2.1.1.2.1.1.3" xref="S2.E1.m1.2.2.1.1.2.1.2.1.cmml">|</mo></mrow><mn id="S2.E1.m1.2.2.1.1.2.3" xref="S2.E1.m1.2.2.1.1.2.3.cmml">2</mn></msup></mrow><mo id="S2.E1.m1.2.2.1.2" lspace="0em" xref="S2.E1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.2b"><apply id="S2.E1.m1.2.2.1.1.cmml" xref="S2.E1.m1.2.2.1"><eq id="S2.E1.m1.2.2.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.3"></eq><apply id="S2.E1.m1.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1"><times id="S2.E1.m1.2.2.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.2"></times><ci id="S2.E1.m1.2.2.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.1.3">ℓ</ci><list id="S2.E1.m1.2.2.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1"><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝑊</ci><apply id="S2.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3">𝑡</ci></apply></list></apply><apply id="S2.E1.m1.2.2.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2">superscript</csymbol><apply id="S2.E1.m1.2.2.1.1.2.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1"><abs id="S2.E1.m1.2.2.1.1.2.1.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.2"></abs><apply id="S2.E1.m1.2.2.1.1.2.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1"><minus id="S2.E1.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1"></minus><apply id="S2.E1.m1.2.2.1.1.2.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2"><times id="S2.E1.m1.2.2.1.1.2.1.1.1.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.1"></times><ci id="S2.E1.m1.2.2.1.1.2.1.1.1.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.2">𝑊</ci><apply id="S2.E1.m1.2.2.1.1.2.1.1.1.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.1.1.1.2.3.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.3">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.2.1.1.1.2.3.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.3.2">𝜃</ci><ci id="S2.E1.m1.2.2.1.1.2.1.1.1.2.3.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.3.3">𝐾</ci></apply><apply id="S2.E1.m1.2.2.1.1.2.1.1.1.2.4.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.1.1.1.2.4.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.4">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.2.1.1.1.2.4.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.4.2">𝑥</ci><ci id="S2.E1.m1.2.2.1.1.2.1.1.1.2.4.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.4.3">𝑡</ci></apply></apply><apply id="S2.E1.m1.2.2.1.1.2.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.3"><times id="S2.E1.m1.2.2.1.1.2.1.1.1.3.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.3.1"></times><apply id="S2.E1.m1.2.2.1.1.2.1.1.1.3.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.1.1.1.3.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.3.2">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.2.1.1.1.3.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.3.2.2">𝜃</ci><ci id="S2.E1.m1.2.2.1.1.2.1.1.1.3.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.3.2.3">𝑉</ci></apply><apply id="S2.E1.m1.2.2.1.1.2.1.1.1.3.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.1.1.1.3.3.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.3.3">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.2.1.1.1.3.3.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.3.3.2">𝑥</ci><ci id="S2.E1.m1.2.2.1.1.2.1.1.1.3.3.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply><cn id="S2.E1.m1.2.2.1.1.2.3.cmml" type="integer" xref="S2.E1.m1.2.2.1.1.2.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.2c">\ell(W;x_{t})=\left|W\theta_{K}x_{t}-\theta_{V}x_{t}\right|^{2}.</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.2d">roman_ℓ ( italic_W ; italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = | italic_W italic_θ start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - italic_θ start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p1.3">Taking the derivative with respect to <math alttext="W" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m1.1"><semantics id="S2.SS1.p1.3.m1.1a"><mi id="S2.SS1.p1.3.m1.1.1" xref="S2.SS1.p1.3.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m1.1b"><ci id="S2.SS1.p1.3.m1.1.1.cmml" xref="S2.SS1.p1.3.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m1.1c">W</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m1.1d">italic_W</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla_{W}\ell(W;x_{t})=2\left(W\theta_{K}x_{t}-\theta_{V}x_{t}\right)\left(%
\theta_{K}x_{t}\right)^{T}." class="ltx_Math" display="block" id="S2.E2.m1.2"><semantics id="S2.E2.m1.2a"><mrow id="S2.E2.m1.2.2.1" xref="S2.E2.m1.2.2.1.1.cmml"><mrow id="S2.E2.m1.2.2.1.1" xref="S2.E2.m1.2.2.1.1.cmml"><mrow id="S2.E2.m1.2.2.1.1.1" xref="S2.E2.m1.2.2.1.1.1.cmml"><mrow id="S2.E2.m1.2.2.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.3.cmml"><msub id="S2.E2.m1.2.2.1.1.1.3.1" xref="S2.E2.m1.2.2.1.1.1.3.1.cmml"><mo id="S2.E2.m1.2.2.1.1.1.3.1.2" xref="S2.E2.m1.2.2.1.1.1.3.1.2.cmml">∇</mo><mi id="S2.E2.m1.2.2.1.1.1.3.1.3" xref="S2.E2.m1.2.2.1.1.1.3.1.3.cmml">W</mi></msub><mi id="S2.E2.m1.2.2.1.1.1.3.2" mathvariant="normal" xref="S2.E2.m1.2.2.1.1.1.3.2.cmml">ℓ</mi></mrow><mo id="S2.E2.m1.2.2.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.2.cmml"><mo id="S2.E2.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.2.2.1.1.1.1.2.cmml">(</mo><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">W</mi><mo id="S2.E2.m1.2.2.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.2.cmml">;</mo><msub id="S2.E2.m1.2.2.1.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E2.m1.2.2.1.1.1.1.1.4" stretchy="false" xref="S2.E2.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.2.2.1.1.4" xref="S2.E2.m1.2.2.1.1.4.cmml">=</mo><mrow id="S2.E2.m1.2.2.1.1.3" xref="S2.E2.m1.2.2.1.1.3.cmml"><mn id="S2.E2.m1.2.2.1.1.3.4" xref="S2.E2.m1.2.2.1.1.3.4.cmml">2</mn><mo id="S2.E2.m1.2.2.1.1.3.3" xref="S2.E2.m1.2.2.1.1.3.3.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.1.1.2.1.1" xref="S2.E2.m1.2.2.1.1.2.1.1.1.cmml"><mo id="S2.E2.m1.2.2.1.1.2.1.1.2" xref="S2.E2.m1.2.2.1.1.2.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.2.2.1.1.2.1.1.1" xref="S2.E2.m1.2.2.1.1.2.1.1.1.cmml"><mrow id="S2.E2.m1.2.2.1.1.2.1.1.1.2" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.cmml"><mi id="S2.E2.m1.2.2.1.1.2.1.1.1.2.2" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.2.cmml">W</mi><mo id="S2.E2.m1.2.2.1.1.2.1.1.1.2.1" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.1.cmml">⁢</mo><msub id="S2.E2.m1.2.2.1.1.2.1.1.1.2.3" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.3.cmml"><mi id="S2.E2.m1.2.2.1.1.2.1.1.1.2.3.2" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.3.2.cmml">θ</mi><mi id="S2.E2.m1.2.2.1.1.2.1.1.1.2.3.3" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.3.3.cmml">K</mi></msub><mo id="S2.E2.m1.2.2.1.1.2.1.1.1.2.1a" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.1.cmml">⁢</mo><msub id="S2.E2.m1.2.2.1.1.2.1.1.1.2.4" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.4.cmml"><mi id="S2.E2.m1.2.2.1.1.2.1.1.1.2.4.2" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.4.2.cmml">x</mi><mi id="S2.E2.m1.2.2.1.1.2.1.1.1.2.4.3" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.4.3.cmml">t</mi></msub></mrow><mo id="S2.E2.m1.2.2.1.1.2.1.1.1.1" xref="S2.E2.m1.2.2.1.1.2.1.1.1.1.cmml">−</mo><mrow id="S2.E2.m1.2.2.1.1.2.1.1.1.3" xref="S2.E2.m1.2.2.1.1.2.1.1.1.3.cmml"><msub id="S2.E2.m1.2.2.1.1.2.1.1.1.3.2" xref="S2.E2.m1.2.2.1.1.2.1.1.1.3.2.cmml"><mi id="S2.E2.m1.2.2.1.1.2.1.1.1.3.2.2" xref="S2.E2.m1.2.2.1.1.2.1.1.1.3.2.2.cmml">θ</mi><mi id="S2.E2.m1.2.2.1.1.2.1.1.1.3.2.3" xref="S2.E2.m1.2.2.1.1.2.1.1.1.3.2.3.cmml">V</mi></msub><mo id="S2.E2.m1.2.2.1.1.2.1.1.1.3.1" xref="S2.E2.m1.2.2.1.1.2.1.1.1.3.1.cmml">⁢</mo><msub id="S2.E2.m1.2.2.1.1.2.1.1.1.3.3" xref="S2.E2.m1.2.2.1.1.2.1.1.1.3.3.cmml"><mi id="S2.E2.m1.2.2.1.1.2.1.1.1.3.3.2" xref="S2.E2.m1.2.2.1.1.2.1.1.1.3.3.2.cmml">x</mi><mi id="S2.E2.m1.2.2.1.1.2.1.1.1.3.3.3" xref="S2.E2.m1.2.2.1.1.2.1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><mo id="S2.E2.m1.2.2.1.1.2.1.1.3" xref="S2.E2.m1.2.2.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="S2.E2.m1.2.2.1.1.3.3a" xref="S2.E2.m1.2.2.1.1.3.3.cmml">⁢</mo><msup id="S2.E2.m1.2.2.1.1.3.2" xref="S2.E2.m1.2.2.1.1.3.2.cmml"><mrow id="S2.E2.m1.2.2.1.1.3.2.1.1" xref="S2.E2.m1.2.2.1.1.3.2.1.1.1.cmml"><mo id="S2.E2.m1.2.2.1.1.3.2.1.1.2" xref="S2.E2.m1.2.2.1.1.3.2.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.2.2.1.1.3.2.1.1.1" xref="S2.E2.m1.2.2.1.1.3.2.1.1.1.cmml"><msub id="S2.E2.m1.2.2.1.1.3.2.1.1.1.2" xref="S2.E2.m1.2.2.1.1.3.2.1.1.1.2.cmml"><mi id="S2.E2.m1.2.2.1.1.3.2.1.1.1.2.2" xref="S2.E2.m1.2.2.1.1.3.2.1.1.1.2.2.cmml">θ</mi><mi id="S2.E2.m1.2.2.1.1.3.2.1.1.1.2.3" xref="S2.E2.m1.2.2.1.1.3.2.1.1.1.2.3.cmml">K</mi></msub><mo id="S2.E2.m1.2.2.1.1.3.2.1.1.1.1" xref="S2.E2.m1.2.2.1.1.3.2.1.1.1.1.cmml">⁢</mo><msub id="S2.E2.m1.2.2.1.1.3.2.1.1.1.3" xref="S2.E2.m1.2.2.1.1.3.2.1.1.1.3.cmml"><mi id="S2.E2.m1.2.2.1.1.3.2.1.1.1.3.2" xref="S2.E2.m1.2.2.1.1.3.2.1.1.1.3.2.cmml">x</mi><mi id="S2.E2.m1.2.2.1.1.3.2.1.1.1.3.3" xref="S2.E2.m1.2.2.1.1.3.2.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.E2.m1.2.2.1.1.3.2.1.1.3" xref="S2.E2.m1.2.2.1.1.3.2.1.1.1.cmml">)</mo></mrow><mi id="S2.E2.m1.2.2.1.1.3.2.3" xref="S2.E2.m1.2.2.1.1.3.2.3.cmml">T</mi></msup></mrow></mrow><mo id="S2.E2.m1.2.2.1.2" lspace="0em" xref="S2.E2.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.2b"><apply id="S2.E2.m1.2.2.1.1.cmml" xref="S2.E2.m1.2.2.1"><eq id="S2.E2.m1.2.2.1.1.4.cmml" xref="S2.E2.m1.2.2.1.1.4"></eq><apply id="S2.E2.m1.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1"><times id="S2.E2.m1.2.2.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.2"></times><apply id="S2.E2.m1.2.2.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.3"><apply id="S2.E2.m1.2.2.1.1.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.3.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.3.1">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.3.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.3.1.2">∇</ci><ci id="S2.E2.m1.2.2.1.1.1.3.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.3.1.3">𝑊</ci></apply><ci id="S2.E2.m1.2.2.1.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.3.2">ℓ</ci></apply><list id="S2.E2.m1.2.2.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1"><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">𝑊</ci><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3">𝑡</ci></apply></list></apply><apply id="S2.E2.m1.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.3"><times id="S2.E2.m1.2.2.1.1.3.3.cmml" xref="S2.E2.m1.2.2.1.1.3.3"></times><cn id="S2.E2.m1.2.2.1.1.3.4.cmml" type="integer" xref="S2.E2.m1.2.2.1.1.3.4">2</cn><apply id="S2.E2.m1.2.2.1.1.2.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1"><minus id="S2.E2.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.1"></minus><apply id="S2.E2.m1.2.2.1.1.2.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2"><times id="S2.E2.m1.2.2.1.1.2.1.1.1.2.1.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.1"></times><ci id="S2.E2.m1.2.2.1.1.2.1.1.1.2.2.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.2">𝑊</ci><apply id="S2.E2.m1.2.2.1.1.2.1.1.1.2.3.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.2.1.1.1.2.3.1.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.3">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.2.1.1.1.2.3.2.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.3.2">𝜃</ci><ci id="S2.E2.m1.2.2.1.1.2.1.1.1.2.3.3.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.3.3">𝐾</ci></apply><apply id="S2.E2.m1.2.2.1.1.2.1.1.1.2.4.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.2.1.1.1.2.4.1.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.4">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.2.1.1.1.2.4.2.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.4.2">𝑥</ci><ci id="S2.E2.m1.2.2.1.1.2.1.1.1.2.4.3.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.4.3">𝑡</ci></apply></apply><apply id="S2.E2.m1.2.2.1.1.2.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.3"><times id="S2.E2.m1.2.2.1.1.2.1.1.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.3.1"></times><apply id="S2.E2.m1.2.2.1.1.2.1.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.2.1.1.1.3.2.1.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.3.2">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.2.1.1.1.3.2.2.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.3.2.2">𝜃</ci><ci id="S2.E2.m1.2.2.1.1.2.1.1.1.3.2.3.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.3.2.3">𝑉</ci></apply><apply id="S2.E2.m1.2.2.1.1.2.1.1.1.3.3.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.2.1.1.1.3.3.1.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.3.3">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.2.1.1.1.3.3.2.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.3.3.2">𝑥</ci><ci id="S2.E2.m1.2.2.1.1.2.1.1.1.3.3.3.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S2.E2.m1.2.2.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.3.2.2.cmml" xref="S2.E2.m1.2.2.1.1.3.2">superscript</csymbol><apply id="S2.E2.m1.2.2.1.1.3.2.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.3.2.1.1"><times id="S2.E2.m1.2.2.1.1.3.2.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.3.2.1.1.1.1"></times><apply id="S2.E2.m1.2.2.1.1.3.2.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.3.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.3.2.1.1.1.2.1.cmml" xref="S2.E2.m1.2.2.1.1.3.2.1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.3.2.1.1.1.2.2.cmml" xref="S2.E2.m1.2.2.1.1.3.2.1.1.1.2.2">𝜃</ci><ci id="S2.E2.m1.2.2.1.1.3.2.1.1.1.2.3.cmml" xref="S2.E2.m1.2.2.1.1.3.2.1.1.1.2.3">𝐾</ci></apply><apply id="S2.E2.m1.2.2.1.1.3.2.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.3.2.1.1.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.3.2.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.3.2.1.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.3.2.1.1.1.3.2">𝑥</ci><ci id="S2.E2.m1.2.2.1.1.3.2.1.1.1.3.3.cmml" xref="S2.E2.m1.2.2.1.1.3.2.1.1.1.3.3">𝑡</ci></apply></apply><ci id="S2.E2.m1.2.2.1.1.3.2.3.cmml" xref="S2.E2.m1.2.2.1.1.3.2.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.2c">\nabla_{W}\ell(W;x_{t})=2\left(W\theta_{K}x_{t}-\theta_{V}x_{t}\right)\left(%
\theta_{K}x_{t}\right)^{T}.</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.2d">∇ start_POSTSUBSCRIPT italic_W end_POSTSUBSCRIPT roman_ℓ ( italic_W ; italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = 2 ( italic_W italic_θ start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - italic_θ start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ( italic_θ start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p1.4">Substituting <math alttext="W=W_{0}=0" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m1.1"><semantics id="S2.SS1.p1.4.m1.1a"><mrow id="S2.SS1.p1.4.m1.1.1" xref="S2.SS1.p1.4.m1.1.1.cmml"><mi id="S2.SS1.p1.4.m1.1.1.2" xref="S2.SS1.p1.4.m1.1.1.2.cmml">W</mi><mo id="S2.SS1.p1.4.m1.1.1.3" xref="S2.SS1.p1.4.m1.1.1.3.cmml">=</mo><msub id="S2.SS1.p1.4.m1.1.1.4" xref="S2.SS1.p1.4.m1.1.1.4.cmml"><mi id="S2.SS1.p1.4.m1.1.1.4.2" xref="S2.SS1.p1.4.m1.1.1.4.2.cmml">W</mi><mn id="S2.SS1.p1.4.m1.1.1.4.3" xref="S2.SS1.p1.4.m1.1.1.4.3.cmml">0</mn></msub><mo id="S2.SS1.p1.4.m1.1.1.5" xref="S2.SS1.p1.4.m1.1.1.5.cmml">=</mo><mn id="S2.SS1.p1.4.m1.1.1.6" xref="S2.SS1.p1.4.m1.1.1.6.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m1.1b"><apply id="S2.SS1.p1.4.m1.1.1.cmml" xref="S2.SS1.p1.4.m1.1.1"><and id="S2.SS1.p1.4.m1.1.1a.cmml" xref="S2.SS1.p1.4.m1.1.1"></and><apply id="S2.SS1.p1.4.m1.1.1b.cmml" xref="S2.SS1.p1.4.m1.1.1"><eq id="S2.SS1.p1.4.m1.1.1.3.cmml" xref="S2.SS1.p1.4.m1.1.1.3"></eq><ci id="S2.SS1.p1.4.m1.1.1.2.cmml" xref="S2.SS1.p1.4.m1.1.1.2">𝑊</ci><apply id="S2.SS1.p1.4.m1.1.1.4.cmml" xref="S2.SS1.p1.4.m1.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m1.1.1.4.1.cmml" xref="S2.SS1.p1.4.m1.1.1.4">subscript</csymbol><ci id="S2.SS1.p1.4.m1.1.1.4.2.cmml" xref="S2.SS1.p1.4.m1.1.1.4.2">𝑊</ci><cn id="S2.SS1.p1.4.m1.1.1.4.3.cmml" type="integer" xref="S2.SS1.p1.4.m1.1.1.4.3">0</cn></apply></apply><apply id="S2.SS1.p1.4.m1.1.1c.cmml" xref="S2.SS1.p1.4.m1.1.1"><eq id="S2.SS1.p1.4.m1.1.1.5.cmml" xref="S2.SS1.p1.4.m1.1.1.5"></eq><share href="https://arxiv.org/html/2410.02523v1#S2.SS1.p1.4.m1.1.1.4.cmml" id="S2.SS1.p1.4.m1.1.1d.cmml" xref="S2.SS1.p1.4.m1.1.1"></share><cn id="S2.SS1.p1.4.m1.1.1.6.cmml" type="integer" xref="S2.SS1.p1.4.m1.1.1.6">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m1.1c">W=W_{0}=0</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m1.1d">italic_W = italic_W start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = 0</annotation></semantics></math>, we have:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla\ell(W_{0};x_{t})=-2\left(\theta_{V}x_{t}\right)\left(\theta_{K}x_{t}%
\right)^{T}." class="ltx_Math" display="block" id="S2.E3.m1.1"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.2.cmml"><mrow id="S2.E3.m1.1.1.1.1.2.4" xref="S2.E3.m1.1.1.1.1.2.4.cmml"><mo id="S2.E3.m1.1.1.1.1.2.4.1" rspace="0.167em" xref="S2.E3.m1.1.1.1.1.2.4.1.cmml">∇</mo><mi id="S2.E3.m1.1.1.1.1.2.4.2" mathvariant="normal" xref="S2.E3.m1.1.1.1.1.2.4.2.cmml">ℓ</mi></mrow><mo id="S2.E3.m1.1.1.1.1.2.3" xref="S2.E3.m1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S2.E3.m1.1.1.1.1.2.2.2" xref="S2.E3.m1.1.1.1.1.2.2.3.cmml"><mo id="S2.E3.m1.1.1.1.1.2.2.2.3" stretchy="false" xref="S2.E3.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S2.E3.m1.1.1.1.1.2.2.2.4" xref="S2.E3.m1.1.1.1.1.2.2.3.cmml">;</mo><msub id="S2.E3.m1.1.1.1.1.2.2.2.2" xref="S2.E3.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E3.m1.1.1.1.1.2.2.2.2.2" xref="S2.E3.m1.1.1.1.1.2.2.2.2.2.cmml">x</mi><mi id="S2.E3.m1.1.1.1.1.2.2.2.2.3" xref="S2.E3.m1.1.1.1.1.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.E3.m1.1.1.1.1.2.2.2.5" stretchy="false" xref="S2.E3.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.1.1.1.1.5" xref="S2.E3.m1.1.1.1.1.5.cmml">=</mo><mrow id="S2.E3.m1.1.1.1.1.4" xref="S2.E3.m1.1.1.1.1.4.cmml"><mo id="S2.E3.m1.1.1.1.1.4a" xref="S2.E3.m1.1.1.1.1.4.cmml">−</mo><mrow id="S2.E3.m1.1.1.1.1.4.2" xref="S2.E3.m1.1.1.1.1.4.2.cmml"><mn id="S2.E3.m1.1.1.1.1.4.2.4" xref="S2.E3.m1.1.1.1.1.4.2.4.cmml">2</mn><mo id="S2.E3.m1.1.1.1.1.4.2.3" xref="S2.E3.m1.1.1.1.1.4.2.3.cmml">⁢</mo><mrow id="S2.E3.m1.1.1.1.1.3.1.1.1" xref="S2.E3.m1.1.1.1.1.3.1.1.1.1.cmml"><mo id="S2.E3.m1.1.1.1.1.3.1.1.1.2" xref="S2.E3.m1.1.1.1.1.3.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.1.1.1.1.3.1.1.1.1" xref="S2.E3.m1.1.1.1.1.3.1.1.1.1.cmml"><msub id="S2.E3.m1.1.1.1.1.3.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.3.1.1.1.1.2.cmml"><mi id="S2.E3.m1.1.1.1.1.3.1.1.1.1.2.2" xref="S2.E3.m1.1.1.1.1.3.1.1.1.1.2.2.cmml">θ</mi><mi id="S2.E3.m1.1.1.1.1.3.1.1.1.1.2.3" xref="S2.E3.m1.1.1.1.1.3.1.1.1.1.2.3.cmml">V</mi></msub><mo id="S2.E3.m1.1.1.1.1.3.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.3.1.1.1.1.1.cmml">⁢</mo><msub id="S2.E3.m1.1.1.1.1.3.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.3.1.1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.3.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.3.1.1.1.1.3.2.cmml">x</mi><mi id="S2.E3.m1.1.1.1.1.3.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.3.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.E3.m1.1.1.1.1.3.1.1.1.3" xref="S2.E3.m1.1.1.1.1.3.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E3.m1.1.1.1.1.4.2.3a" xref="S2.E3.m1.1.1.1.1.4.2.3.cmml">⁢</mo><msup id="S2.E3.m1.1.1.1.1.4.2.2" xref="S2.E3.m1.1.1.1.1.4.2.2.cmml"><mrow id="S2.E3.m1.1.1.1.1.4.2.2.1.1" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.cmml"><mo id="S2.E3.m1.1.1.1.1.4.2.2.1.1.2" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.1.1.1.1.4.2.2.1.1.1" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.cmml"><msub id="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.2" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.2.cmml"><mi id="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.2.2" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.2.2.cmml">θ</mi><mi id="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.2.3" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.2.3.cmml">K</mi></msub><mo id="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.1" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.1.cmml">⁢</mo><msub id="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.3" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.3.2.cmml">x</mi><mi id="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.E3.m1.1.1.1.1.4.2.2.1.1.3" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.cmml">)</mo></mrow><mi id="S2.E3.m1.1.1.1.1.4.2.2.3" xref="S2.E3.m1.1.1.1.1.4.2.2.3.cmml">T</mi></msup></mrow></mrow></mrow><mo id="S2.E3.m1.1.1.1.2" lspace="0em" xref="S2.E3.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><eq id="S2.E3.m1.1.1.1.1.5.cmml" xref="S2.E3.m1.1.1.1.1.5"></eq><apply id="S2.E3.m1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.2"><times id="S2.E3.m1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.1.1.2.3"></times><apply id="S2.E3.m1.1.1.1.1.2.4.cmml" xref="S2.E3.m1.1.1.1.1.2.4"><ci id="S2.E3.m1.1.1.1.1.2.4.1.cmml" xref="S2.E3.m1.1.1.1.1.2.4.1">∇</ci><ci id="S2.E3.m1.1.1.1.1.2.4.2.cmml" xref="S2.E3.m1.1.1.1.1.2.4.2">ℓ</ci></apply><list id="S2.E3.m1.1.1.1.1.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.2.2.2"><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2">𝑊</ci><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3">0</cn></apply><apply id="S2.E3.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E3.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.2.2.2.2.2">𝑥</ci><ci id="S2.E3.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.2.2.2.2.3">𝑡</ci></apply></list></apply><apply id="S2.E3.m1.1.1.1.1.4.cmml" xref="S2.E3.m1.1.1.1.1.4"><minus id="S2.E3.m1.1.1.1.1.4.3.cmml" xref="S2.E3.m1.1.1.1.1.4"></minus><apply id="S2.E3.m1.1.1.1.1.4.2.cmml" xref="S2.E3.m1.1.1.1.1.4.2"><times id="S2.E3.m1.1.1.1.1.4.2.3.cmml" xref="S2.E3.m1.1.1.1.1.4.2.3"></times><cn id="S2.E3.m1.1.1.1.1.4.2.4.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.4.2.4">2</cn><apply id="S2.E3.m1.1.1.1.1.3.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.3.1.1.1"><times id="S2.E3.m1.1.1.1.1.3.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.3.1.1.1.1.1"></times><apply id="S2.E3.m1.1.1.1.1.3.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.3.1.1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.1.1.3.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.3.1.1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.1.1.3.1.1.1.1.2.2">𝜃</ci><ci id="S2.E3.m1.1.1.1.1.3.1.1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.1.1.3.1.1.1.1.2.3">𝑉</ci></apply><apply id="S2.E3.m1.1.1.1.1.3.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.3.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.3.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.1.1.1.1.3.2">𝑥</ci><ci id="S2.E3.m1.1.1.1.1.3.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S2.E3.m1.1.1.1.1.4.2.2.cmml" xref="S2.E3.m1.1.1.1.1.4.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.4.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.4.2.2">superscript</csymbol><apply id="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1"><times id="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.1"></times><apply id="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.2.2">𝜃</ci><ci id="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.2.3">𝐾</ci></apply><apply id="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.3.2">𝑥</ci><ci id="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.4.2.2.1.1.1.3.3">𝑡</ci></apply></apply><ci id="S2.E3.m1.1.1.1.1.4.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.4.2.2.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\nabla\ell(W_{0};x_{t})=-2\left(\theta_{V}x_{t}\right)\left(\theta_{K}x_{t}%
\right)^{T}.</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.1d">∇ roman_ℓ ( italic_W start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ; italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = - 2 ( italic_θ start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ( italic_θ start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p1.5">Using the update formula for <math alttext="W_{t}" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m1.1"><semantics id="S2.SS1.p1.5.m1.1a"><msub id="S2.SS1.p1.5.m1.1.1" xref="S2.SS1.p1.5.m1.1.1.cmml"><mi id="S2.SS1.p1.5.m1.1.1.2" xref="S2.SS1.p1.5.m1.1.1.2.cmml">W</mi><mi id="S2.SS1.p1.5.m1.1.1.3" xref="S2.SS1.p1.5.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m1.1b"><apply id="S2.SS1.p1.5.m1.1.1.cmml" xref="S2.SS1.p1.5.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m1.1.1.1.cmml" xref="S2.SS1.p1.5.m1.1.1">subscript</csymbol><ci id="S2.SS1.p1.5.m1.1.1.2.cmml" xref="S2.SS1.p1.5.m1.1.1.2">𝑊</ci><ci id="S2.SS1.p1.5.m1.1.1.3.cmml" xref="S2.SS1.p1.5.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m1.1c">W_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m1.1d">italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="W_{t}=W_{t-1}-\eta\nabla\ell(W_{0};x_{t})=W_{0}-\eta\sum_{s=1}^{t}\nabla\ell(W%
_{0};x_{s})=\sum_{s=1}^{t}\left(\theta_{V}x_{s}\right)\left(\theta_{K}x_{s}%
\right)^{T}." class="ltx_Math" display="block" id="S2.E4.m1.1"><semantics id="S2.E4.m1.1a"><mrow id="S2.E4.m1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml"><mrow id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml"><msub id="S2.E4.m1.1.1.1.1.8" xref="S2.E4.m1.1.1.1.1.8.cmml"><mi id="S2.E4.m1.1.1.1.1.8.2" xref="S2.E4.m1.1.1.1.1.8.2.cmml">W</mi><mi id="S2.E4.m1.1.1.1.1.8.3" xref="S2.E4.m1.1.1.1.1.8.3.cmml">t</mi></msub><mo id="S2.E4.m1.1.1.1.1.9" xref="S2.E4.m1.1.1.1.1.9.cmml">=</mo><mrow id="S2.E4.m1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.2.cmml"><msub id="S2.E4.m1.1.1.1.1.2.4" xref="S2.E4.m1.1.1.1.1.2.4.cmml"><mi id="S2.E4.m1.1.1.1.1.2.4.2" xref="S2.E4.m1.1.1.1.1.2.4.2.cmml">W</mi><mrow id="S2.E4.m1.1.1.1.1.2.4.3" xref="S2.E4.m1.1.1.1.1.2.4.3.cmml"><mi id="S2.E4.m1.1.1.1.1.2.4.3.2" xref="S2.E4.m1.1.1.1.1.2.4.3.2.cmml">t</mi><mo id="S2.E4.m1.1.1.1.1.2.4.3.1" xref="S2.E4.m1.1.1.1.1.2.4.3.1.cmml">−</mo><mn id="S2.E4.m1.1.1.1.1.2.4.3.3" xref="S2.E4.m1.1.1.1.1.2.4.3.3.cmml">1</mn></mrow></msub><mo id="S2.E4.m1.1.1.1.1.2.3" xref="S2.E4.m1.1.1.1.1.2.3.cmml">−</mo><mrow id="S2.E4.m1.1.1.1.1.2.2" xref="S2.E4.m1.1.1.1.1.2.2.cmml"><mi id="S2.E4.m1.1.1.1.1.2.2.4" xref="S2.E4.m1.1.1.1.1.2.2.4.cmml">η</mi><mo id="S2.E4.m1.1.1.1.1.2.2.3" lspace="0.167em" xref="S2.E4.m1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S2.E4.m1.1.1.1.1.2.2.5" xref="S2.E4.m1.1.1.1.1.2.2.5.cmml"><mo id="S2.E4.m1.1.1.1.1.2.2.5.1" rspace="0.167em" xref="S2.E4.m1.1.1.1.1.2.2.5.1.cmml">∇</mo><mi id="S2.E4.m1.1.1.1.1.2.2.5.2" mathvariant="normal" xref="S2.E4.m1.1.1.1.1.2.2.5.2.cmml">ℓ</mi></mrow><mo id="S2.E4.m1.1.1.1.1.2.2.3a" xref="S2.E4.m1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S2.E4.m1.1.1.1.1.2.2.2.2" xref="S2.E4.m1.1.1.1.1.2.2.2.3.cmml"><mo id="S2.E4.m1.1.1.1.1.2.2.2.2.3" stretchy="false" xref="S2.E4.m1.1.1.1.1.2.2.2.3.cmml">(</mo><msub id="S2.E4.m1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mn id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S2.E4.m1.1.1.1.1.2.2.2.2.4" xref="S2.E4.m1.1.1.1.1.2.2.2.3.cmml">;</mo><msub id="S2.E4.m1.1.1.1.1.2.2.2.2.2" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S2.E4.m1.1.1.1.1.2.2.2.2.2.2" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.cmml">x</mi><mi id="S2.E4.m1.1.1.1.1.2.2.2.2.2.3" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.E4.m1.1.1.1.1.2.2.2.2.5" stretchy="false" xref="S2.E4.m1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m1.1.1.1.1.10" xref="S2.E4.m1.1.1.1.1.10.cmml">=</mo><mrow id="S2.E4.m1.1.1.1.1.4" xref="S2.E4.m1.1.1.1.1.4.cmml"><msub id="S2.E4.m1.1.1.1.1.4.4" xref="S2.E4.m1.1.1.1.1.4.4.cmml"><mi id="S2.E4.m1.1.1.1.1.4.4.2" xref="S2.E4.m1.1.1.1.1.4.4.2.cmml">W</mi><mn id="S2.E4.m1.1.1.1.1.4.4.3" xref="S2.E4.m1.1.1.1.1.4.4.3.cmml">0</mn></msub><mo id="S2.E4.m1.1.1.1.1.4.3" xref="S2.E4.m1.1.1.1.1.4.3.cmml">−</mo><mrow id="S2.E4.m1.1.1.1.1.4.2" xref="S2.E4.m1.1.1.1.1.4.2.cmml"><mi id="S2.E4.m1.1.1.1.1.4.2.4" xref="S2.E4.m1.1.1.1.1.4.2.4.cmml">η</mi><mo id="S2.E4.m1.1.1.1.1.4.2.3" xref="S2.E4.m1.1.1.1.1.4.2.3.cmml">⁢</mo><mrow id="S2.E4.m1.1.1.1.1.4.2.2" xref="S2.E4.m1.1.1.1.1.4.2.2.cmml"><munderover id="S2.E4.m1.1.1.1.1.4.2.2.3" xref="S2.E4.m1.1.1.1.1.4.2.2.3.cmml"><mo id="S2.E4.m1.1.1.1.1.4.2.2.3.2.2" movablelimits="false" xref="S2.E4.m1.1.1.1.1.4.2.2.3.2.2.cmml">∑</mo><mrow id="S2.E4.m1.1.1.1.1.4.2.2.3.2.3" xref="S2.E4.m1.1.1.1.1.4.2.2.3.2.3.cmml"><mi id="S2.E4.m1.1.1.1.1.4.2.2.3.2.3.2" xref="S2.E4.m1.1.1.1.1.4.2.2.3.2.3.2.cmml">s</mi><mo id="S2.E4.m1.1.1.1.1.4.2.2.3.2.3.1" xref="S2.E4.m1.1.1.1.1.4.2.2.3.2.3.1.cmml">=</mo><mn id="S2.E4.m1.1.1.1.1.4.2.2.3.2.3.3" xref="S2.E4.m1.1.1.1.1.4.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E4.m1.1.1.1.1.4.2.2.3.3" xref="S2.E4.m1.1.1.1.1.4.2.2.3.3.cmml">t</mi></munderover><mrow id="S2.E4.m1.1.1.1.1.4.2.2.2" xref="S2.E4.m1.1.1.1.1.4.2.2.2.cmml"><mrow id="S2.E4.m1.1.1.1.1.4.2.2.2.4" xref="S2.E4.m1.1.1.1.1.4.2.2.2.4.cmml"><mo id="S2.E4.m1.1.1.1.1.4.2.2.2.4.1" rspace="0.167em" xref="S2.E4.m1.1.1.1.1.4.2.2.2.4.1.cmml">∇</mo><mi id="S2.E4.m1.1.1.1.1.4.2.2.2.4.2" mathvariant="normal" xref="S2.E4.m1.1.1.1.1.4.2.2.2.4.2.cmml">ℓ</mi></mrow><mo id="S2.E4.m1.1.1.1.1.4.2.2.2.3" xref="S2.E4.m1.1.1.1.1.4.2.2.2.3.cmml">⁢</mo><mrow id="S2.E4.m1.1.1.1.1.4.2.2.2.2.2" xref="S2.E4.m1.1.1.1.1.4.2.2.2.2.3.cmml"><mo id="S2.E4.m1.1.1.1.1.4.2.2.2.2.2.3" stretchy="false" xref="S2.E4.m1.1.1.1.1.4.2.2.2.2.3.cmml">(</mo><msub id="S2.E4.m1.1.1.1.1.3.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.3.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.1.1.1.1.3.1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.3.1.1.1.1.1.1.2.cmml">W</mi><mn id="S2.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S2.E4.m1.1.1.1.1.4.2.2.2.2.2.4" xref="S2.E4.m1.1.1.1.1.4.2.2.2.2.3.cmml">;</mo><msub id="S2.E4.m1.1.1.1.1.4.2.2.2.2.2.2" xref="S2.E4.m1.1.1.1.1.4.2.2.2.2.2.2.cmml"><mi id="S2.E4.m1.1.1.1.1.4.2.2.2.2.2.2.2" xref="S2.E4.m1.1.1.1.1.4.2.2.2.2.2.2.2.cmml">x</mi><mi id="S2.E4.m1.1.1.1.1.4.2.2.2.2.2.2.3" xref="S2.E4.m1.1.1.1.1.4.2.2.2.2.2.2.3.cmml">s</mi></msub><mo id="S2.E4.m1.1.1.1.1.4.2.2.2.2.2.5" stretchy="false" xref="S2.E4.m1.1.1.1.1.4.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E4.m1.1.1.1.1.11" rspace="0.111em" xref="S2.E4.m1.1.1.1.1.11.cmml">=</mo><mrow id="S2.E4.m1.1.1.1.1.6" xref="S2.E4.m1.1.1.1.1.6.cmml"><munderover id="S2.E4.m1.1.1.1.1.6.3" xref="S2.E4.m1.1.1.1.1.6.3.cmml"><mo id="S2.E4.m1.1.1.1.1.6.3.2.2" movablelimits="false" rspace="0em" xref="S2.E4.m1.1.1.1.1.6.3.2.2.cmml">∑</mo><mrow id="S2.E4.m1.1.1.1.1.6.3.2.3" xref="S2.E4.m1.1.1.1.1.6.3.2.3.cmml"><mi id="S2.E4.m1.1.1.1.1.6.3.2.3.2" xref="S2.E4.m1.1.1.1.1.6.3.2.3.2.cmml">s</mi><mo id="S2.E4.m1.1.1.1.1.6.3.2.3.1" xref="S2.E4.m1.1.1.1.1.6.3.2.3.1.cmml">=</mo><mn id="S2.E4.m1.1.1.1.1.6.3.2.3.3" xref="S2.E4.m1.1.1.1.1.6.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E4.m1.1.1.1.1.6.3.3" xref="S2.E4.m1.1.1.1.1.6.3.3.cmml">t</mi></munderover><mrow id="S2.E4.m1.1.1.1.1.6.2" xref="S2.E4.m1.1.1.1.1.6.2.cmml"><mrow id="S2.E4.m1.1.1.1.1.5.1.1.1" xref="S2.E4.m1.1.1.1.1.5.1.1.1.1.cmml"><mo id="S2.E4.m1.1.1.1.1.5.1.1.1.2" xref="S2.E4.m1.1.1.1.1.5.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.1.1.1.1.5.1.1.1.1" xref="S2.E4.m1.1.1.1.1.5.1.1.1.1.cmml"><msub id="S2.E4.m1.1.1.1.1.5.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.5.1.1.1.1.2.cmml"><mi id="S2.E4.m1.1.1.1.1.5.1.1.1.1.2.2" xref="S2.E4.m1.1.1.1.1.5.1.1.1.1.2.2.cmml">θ</mi><mi id="S2.E4.m1.1.1.1.1.5.1.1.1.1.2.3" xref="S2.E4.m1.1.1.1.1.5.1.1.1.1.2.3.cmml">V</mi></msub><mo id="S2.E4.m1.1.1.1.1.5.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.5.1.1.1.1.1.cmml">⁢</mo><msub id="S2.E4.m1.1.1.1.1.5.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.5.1.1.1.1.3.cmml"><mi id="S2.E4.m1.1.1.1.1.5.1.1.1.1.3.2" xref="S2.E4.m1.1.1.1.1.5.1.1.1.1.3.2.cmml">x</mi><mi id="S2.E4.m1.1.1.1.1.5.1.1.1.1.3.3" xref="S2.E4.m1.1.1.1.1.5.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo id="S2.E4.m1.1.1.1.1.5.1.1.1.3" xref="S2.E4.m1.1.1.1.1.5.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E4.m1.1.1.1.1.6.2.3" xref="S2.E4.m1.1.1.1.1.6.2.3.cmml">⁢</mo><msup id="S2.E4.m1.1.1.1.1.6.2.2" xref="S2.E4.m1.1.1.1.1.6.2.2.cmml"><mrow id="S2.E4.m1.1.1.1.1.6.2.2.1.1" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.cmml"><mo id="S2.E4.m1.1.1.1.1.6.2.2.1.1.2" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.1.1.1.1.6.2.2.1.1.1" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.cmml"><msub id="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.2" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.2.cmml"><mi id="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.2.2" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.2.2.cmml">θ</mi><mi id="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.2.3" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.2.3.cmml">K</mi></msub><mo id="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.1" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.1.cmml">⁢</mo><msub id="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.3" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.3.cmml"><mi id="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.3.2" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.3.2.cmml">x</mi><mi id="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.3.3" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.3.3.cmml">s</mi></msub></mrow><mo id="S2.E4.m1.1.1.1.1.6.2.2.1.1.3" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.cmml">)</mo></mrow><mi id="S2.E4.m1.1.1.1.1.6.2.2.3" xref="S2.E4.m1.1.1.1.1.6.2.2.3.cmml">T</mi></msup></mrow></mrow></mrow><mo id="S2.E4.m1.1.1.1.2" lspace="0em" xref="S2.E4.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1"><and id="S2.E4.m1.1.1.1.1a.cmml" xref="S2.E4.m1.1.1.1"></and><apply id="S2.E4.m1.1.1.1.1b.cmml" xref="S2.E4.m1.1.1.1"><eq id="S2.E4.m1.1.1.1.1.9.cmml" xref="S2.E4.m1.1.1.1.1.9"></eq><apply id="S2.E4.m1.1.1.1.1.8.cmml" xref="S2.E4.m1.1.1.1.1.8"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.8.1.cmml" xref="S2.E4.m1.1.1.1.1.8">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.8.2.cmml" xref="S2.E4.m1.1.1.1.1.8.2">𝑊</ci><ci id="S2.E4.m1.1.1.1.1.8.3.cmml" xref="S2.E4.m1.1.1.1.1.8.3">𝑡</ci></apply><apply id="S2.E4.m1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.2"><minus id="S2.E4.m1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.1.1.1.1.2.3"></minus><apply id="S2.E4.m1.1.1.1.1.2.4.cmml" xref="S2.E4.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.2.4.1.cmml" xref="S2.E4.m1.1.1.1.1.2.4">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.2.4.2.cmml" xref="S2.E4.m1.1.1.1.1.2.4.2">𝑊</ci><apply id="S2.E4.m1.1.1.1.1.2.4.3.cmml" xref="S2.E4.m1.1.1.1.1.2.4.3"><minus id="S2.E4.m1.1.1.1.1.2.4.3.1.cmml" xref="S2.E4.m1.1.1.1.1.2.4.3.1"></minus><ci id="S2.E4.m1.1.1.1.1.2.4.3.2.cmml" xref="S2.E4.m1.1.1.1.1.2.4.3.2">𝑡</ci><cn id="S2.E4.m1.1.1.1.1.2.4.3.3.cmml" type="integer" xref="S2.E4.m1.1.1.1.1.2.4.3.3">1</cn></apply></apply><apply id="S2.E4.m1.1.1.1.1.2.2.cmml" xref="S2.E4.m1.1.1.1.1.2.2"><times id="S2.E4.m1.1.1.1.1.2.2.3.cmml" xref="S2.E4.m1.1.1.1.1.2.2.3"></times><ci id="S2.E4.m1.1.1.1.1.2.2.4.cmml" xref="S2.E4.m1.1.1.1.1.2.2.4">𝜂</ci><apply id="S2.E4.m1.1.1.1.1.2.2.5.cmml" xref="S2.E4.m1.1.1.1.1.2.2.5"><ci id="S2.E4.m1.1.1.1.1.2.2.5.1.cmml" xref="S2.E4.m1.1.1.1.1.2.2.5.1">∇</ci><ci id="S2.E4.m1.1.1.1.1.2.2.5.2.cmml" xref="S2.E4.m1.1.1.1.1.2.2.5.2">ℓ</ci></apply><list id="S2.E4.m1.1.1.1.1.2.2.2.3.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2"><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><cn id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3">0</cn></apply><apply id="S2.E4.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.2">𝑥</ci><ci id="S2.E4.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.3">𝑡</ci></apply></list></apply></apply></apply><apply id="S2.E4.m1.1.1.1.1c.cmml" xref="S2.E4.m1.1.1.1"><eq id="S2.E4.m1.1.1.1.1.10.cmml" xref="S2.E4.m1.1.1.1.1.10"></eq><share href="https://arxiv.org/html/2410.02523v1#S2.E4.m1.1.1.1.1.2.cmml" id="S2.E4.m1.1.1.1.1d.cmml" xref="S2.E4.m1.1.1.1"></share><apply id="S2.E4.m1.1.1.1.1.4.cmml" xref="S2.E4.m1.1.1.1.1.4"><minus id="S2.E4.m1.1.1.1.1.4.3.cmml" xref="S2.E4.m1.1.1.1.1.4.3"></minus><apply id="S2.E4.m1.1.1.1.1.4.4.cmml" xref="S2.E4.m1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.4.4.1.cmml" xref="S2.E4.m1.1.1.1.1.4.4">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.4.4.2.cmml" xref="S2.E4.m1.1.1.1.1.4.4.2">𝑊</ci><cn id="S2.E4.m1.1.1.1.1.4.4.3.cmml" type="integer" xref="S2.E4.m1.1.1.1.1.4.4.3">0</cn></apply><apply id="S2.E4.m1.1.1.1.1.4.2.cmml" xref="S2.E4.m1.1.1.1.1.4.2"><times id="S2.E4.m1.1.1.1.1.4.2.3.cmml" xref="S2.E4.m1.1.1.1.1.4.2.3"></times><ci id="S2.E4.m1.1.1.1.1.4.2.4.cmml" xref="S2.E4.m1.1.1.1.1.4.2.4">𝜂</ci><apply id="S2.E4.m1.1.1.1.1.4.2.2.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2"><apply id="S2.E4.m1.1.1.1.1.4.2.2.3.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.4.2.2.3.1.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2.3">superscript</csymbol><apply id="S2.E4.m1.1.1.1.1.4.2.2.3.2.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.4.2.2.3.2.1.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2.3">subscript</csymbol><sum id="S2.E4.m1.1.1.1.1.4.2.2.3.2.2.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2.3.2.2"></sum><apply id="S2.E4.m1.1.1.1.1.4.2.2.3.2.3.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2.3.2.3"><eq id="S2.E4.m1.1.1.1.1.4.2.2.3.2.3.1.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2.3.2.3.1"></eq><ci id="S2.E4.m1.1.1.1.1.4.2.2.3.2.3.2.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2.3.2.3.2">𝑠</ci><cn id="S2.E4.m1.1.1.1.1.4.2.2.3.2.3.3.cmml" type="integer" xref="S2.E4.m1.1.1.1.1.4.2.2.3.2.3.3">1</cn></apply></apply><ci id="S2.E4.m1.1.1.1.1.4.2.2.3.3.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2.3.3">𝑡</ci></apply><apply id="S2.E4.m1.1.1.1.1.4.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2.2"><times id="S2.E4.m1.1.1.1.1.4.2.2.2.3.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2.2.3"></times><apply id="S2.E4.m1.1.1.1.1.4.2.2.2.4.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2.2.4"><ci id="S2.E4.m1.1.1.1.1.4.2.2.2.4.1.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2.2.4.1">∇</ci><ci id="S2.E4.m1.1.1.1.1.4.2.2.2.4.2.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2.2.4.2">ℓ</ci></apply><list id="S2.E4.m1.1.1.1.1.4.2.2.2.2.3.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2.2.2.2"><apply id="S2.E4.m1.1.1.1.1.3.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.3.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.3.1.1.1.1.1.1.2">𝑊</ci><cn id="S2.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3">0</cn></apply><apply id="S2.E4.m1.1.1.1.1.4.2.2.2.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.4.2.2.2.2.2.2.1.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.4.2.2.2.2.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2.2.2.2.2.2">𝑥</ci><ci id="S2.E4.m1.1.1.1.1.4.2.2.2.2.2.2.3.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2.2.2.2.2.3">𝑠</ci></apply></list></apply></apply></apply></apply></apply><apply id="S2.E4.m1.1.1.1.1e.cmml" xref="S2.E4.m1.1.1.1"><eq id="S2.E4.m1.1.1.1.1.11.cmml" xref="S2.E4.m1.1.1.1.1.11"></eq><share href="https://arxiv.org/html/2410.02523v1#S2.E4.m1.1.1.1.1.4.cmml" id="S2.E4.m1.1.1.1.1f.cmml" xref="S2.E4.m1.1.1.1"></share><apply id="S2.E4.m1.1.1.1.1.6.cmml" xref="S2.E4.m1.1.1.1.1.6"><apply id="S2.E4.m1.1.1.1.1.6.3.cmml" xref="S2.E4.m1.1.1.1.1.6.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.6.3.1.cmml" xref="S2.E4.m1.1.1.1.1.6.3">superscript</csymbol><apply id="S2.E4.m1.1.1.1.1.6.3.2.cmml" xref="S2.E4.m1.1.1.1.1.6.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.6.3.2.1.cmml" xref="S2.E4.m1.1.1.1.1.6.3">subscript</csymbol><sum id="S2.E4.m1.1.1.1.1.6.3.2.2.cmml" xref="S2.E4.m1.1.1.1.1.6.3.2.2"></sum><apply id="S2.E4.m1.1.1.1.1.6.3.2.3.cmml" xref="S2.E4.m1.1.1.1.1.6.3.2.3"><eq id="S2.E4.m1.1.1.1.1.6.3.2.3.1.cmml" xref="S2.E4.m1.1.1.1.1.6.3.2.3.1"></eq><ci id="S2.E4.m1.1.1.1.1.6.3.2.3.2.cmml" xref="S2.E4.m1.1.1.1.1.6.3.2.3.2">𝑠</ci><cn id="S2.E4.m1.1.1.1.1.6.3.2.3.3.cmml" type="integer" xref="S2.E4.m1.1.1.1.1.6.3.2.3.3">1</cn></apply></apply><ci id="S2.E4.m1.1.1.1.1.6.3.3.cmml" xref="S2.E4.m1.1.1.1.1.6.3.3">𝑡</ci></apply><apply id="S2.E4.m1.1.1.1.1.6.2.cmml" xref="S2.E4.m1.1.1.1.1.6.2"><times id="S2.E4.m1.1.1.1.1.6.2.3.cmml" xref="S2.E4.m1.1.1.1.1.6.2.3"></times><apply id="S2.E4.m1.1.1.1.1.5.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.5.1.1.1"><times id="S2.E4.m1.1.1.1.1.5.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.5.1.1.1.1.1"></times><apply id="S2.E4.m1.1.1.1.1.5.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.5.1.1.1.1.2.1.cmml" xref="S2.E4.m1.1.1.1.1.5.1.1.1.1.2">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.5.1.1.1.1.2.2.cmml" xref="S2.E4.m1.1.1.1.1.5.1.1.1.1.2.2">𝜃</ci><ci id="S2.E4.m1.1.1.1.1.5.1.1.1.1.2.3.cmml" xref="S2.E4.m1.1.1.1.1.5.1.1.1.1.2.3">𝑉</ci></apply><apply id="S2.E4.m1.1.1.1.1.5.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.5.1.1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.1.5.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.5.1.1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.1.5.1.1.1.1.3.2">𝑥</ci><ci id="S2.E4.m1.1.1.1.1.5.1.1.1.1.3.3.cmml" xref="S2.E4.m1.1.1.1.1.5.1.1.1.1.3.3">𝑠</ci></apply></apply><apply id="S2.E4.m1.1.1.1.1.6.2.2.cmml" xref="S2.E4.m1.1.1.1.1.6.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.6.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.6.2.2">superscript</csymbol><apply id="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1"><times id="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.1"></times><apply id="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.2.1.cmml" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.2">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.2.2.cmml" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.2.2">𝜃</ci><ci id="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.2.3.cmml" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.2.3">𝐾</ci></apply><apply id="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.3.2">𝑥</ci><ci id="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.3.3.cmml" xref="S2.E4.m1.1.1.1.1.6.2.2.1.1.1.3.3">𝑠</ci></apply></apply><ci id="S2.E4.m1.1.1.1.1.6.2.2.3.cmml" xref="S2.E4.m1.1.1.1.1.6.2.2.3">𝑇</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">W_{t}=W_{t-1}-\eta\nabla\ell(W_{0};x_{t})=W_{0}-\eta\sum_{s=1}^{t}\nabla\ell(W%
_{0};x_{s})=\sum_{s=1}^{t}\left(\theta_{V}x_{s}\right)\left(\theta_{K}x_{s}%
\right)^{T}.</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.1d">italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_W start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT - italic_η ∇ roman_ℓ ( italic_W start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ; italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = italic_W start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - italic_η ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ∇ roman_ℓ ( italic_W start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ; italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) = ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ( italic_θ start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) ( italic_θ start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p1.6">Thus, the output <math alttext="z_{t}" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m1.1"><semantics id="S2.SS1.p1.6.m1.1a"><msub id="S2.SS1.p1.6.m1.1.1" xref="S2.SS1.p1.6.m1.1.1.cmml"><mi id="S2.SS1.p1.6.m1.1.1.2" xref="S2.SS1.p1.6.m1.1.1.2.cmml">z</mi><mi id="S2.SS1.p1.6.m1.1.1.3" xref="S2.SS1.p1.6.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m1.1b"><apply id="S2.SS1.p1.6.m1.1.1.cmml" xref="S2.SS1.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m1.1.1.1.cmml" xref="S2.SS1.p1.6.m1.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m1.1.1.2.cmml" xref="S2.SS1.p1.6.m1.1.1.2">𝑧</ci><ci id="S2.SS1.p1.6.m1.1.1.3.cmml" xref="S2.SS1.p1.6.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m1.1c">z_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m1.1d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> becomes:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="z_{t}=f\left(\theta_{Q}x_{t};W_{t}\right)=\sum_{s=1}^{t}\left(\theta_{V}x_{s}%
\right)\left(\theta_{K}x_{s}\right)^{T}\left(\theta_{Q}x_{t}\right)," class="ltx_Math" display="block" id="S2.E5.m1.1"><semantics id="S2.E5.m1.1a"><mrow id="S2.E5.m1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml"><mrow id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml"><msub id="S2.E5.m1.1.1.1.1.7" xref="S2.E5.m1.1.1.1.1.7.cmml"><mi id="S2.E5.m1.1.1.1.1.7.2" xref="S2.E5.m1.1.1.1.1.7.2.cmml">z</mi><mi id="S2.E5.m1.1.1.1.1.7.3" xref="S2.E5.m1.1.1.1.1.7.3.cmml">t</mi></msub><mo id="S2.E5.m1.1.1.1.1.8" xref="S2.E5.m1.1.1.1.1.8.cmml">=</mo><mrow id="S2.E5.m1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.2.cmml"><mi id="S2.E5.m1.1.1.1.1.2.4" xref="S2.E5.m1.1.1.1.1.2.4.cmml">f</mi><mo id="S2.E5.m1.1.1.1.1.2.3" xref="S2.E5.m1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S2.E5.m1.1.1.1.1.2.2.2" xref="S2.E5.m1.1.1.1.1.2.2.3.cmml"><mo id="S2.E5.m1.1.1.1.1.2.2.2.3" xref="S2.E5.m1.1.1.1.1.2.2.3.cmml">(</mo><mrow id="S2.E5.m1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E5.m1.1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.2.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.2.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.3.cmml">Q</mi></msub><mo id="S2.E5.m1.1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S2.E5.m1.1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.3.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.3.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.E5.m1.1.1.1.1.2.2.2.4" xref="S2.E5.m1.1.1.1.1.2.2.3.cmml">;</mo><msub id="S2.E5.m1.1.1.1.1.2.2.2.2" xref="S2.E5.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E5.m1.1.1.1.1.2.2.2.2.2" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.cmml">W</mi><mi id="S2.E5.m1.1.1.1.1.2.2.2.2.3" xref="S2.E5.m1.1.1.1.1.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.E5.m1.1.1.1.1.2.2.2.5" xref="S2.E5.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.1.1.1.1.9" rspace="0.111em" xref="S2.E5.m1.1.1.1.1.9.cmml">=</mo><mrow id="S2.E5.m1.1.1.1.1.5" xref="S2.E5.m1.1.1.1.1.5.cmml"><munderover id="S2.E5.m1.1.1.1.1.5.4" xref="S2.E5.m1.1.1.1.1.5.4.cmml"><mo id="S2.E5.m1.1.1.1.1.5.4.2.2" movablelimits="false" rspace="0em" xref="S2.E5.m1.1.1.1.1.5.4.2.2.cmml">∑</mo><mrow id="S2.E5.m1.1.1.1.1.5.4.2.3" xref="S2.E5.m1.1.1.1.1.5.4.2.3.cmml"><mi id="S2.E5.m1.1.1.1.1.5.4.2.3.2" xref="S2.E5.m1.1.1.1.1.5.4.2.3.2.cmml">s</mi><mo id="S2.E5.m1.1.1.1.1.5.4.2.3.1" xref="S2.E5.m1.1.1.1.1.5.4.2.3.1.cmml">=</mo><mn id="S2.E5.m1.1.1.1.1.5.4.2.3.3" xref="S2.E5.m1.1.1.1.1.5.4.2.3.3.cmml">1</mn></mrow><mi id="S2.E5.m1.1.1.1.1.5.4.3" xref="S2.E5.m1.1.1.1.1.5.4.3.cmml">t</mi></munderover><mrow id="S2.E5.m1.1.1.1.1.5.3" xref="S2.E5.m1.1.1.1.1.5.3.cmml"><mrow id="S2.E5.m1.1.1.1.1.3.1.1.1" xref="S2.E5.m1.1.1.1.1.3.1.1.1.1.cmml"><mo id="S2.E5.m1.1.1.1.1.3.1.1.1.2" xref="S2.E5.m1.1.1.1.1.3.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.1.1.1.1.3.1.1.1.1" xref="S2.E5.m1.1.1.1.1.3.1.1.1.1.cmml"><msub id="S2.E5.m1.1.1.1.1.3.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.3.1.1.1.1.2.cmml"><mi id="S2.E5.m1.1.1.1.1.3.1.1.1.1.2.2" xref="S2.E5.m1.1.1.1.1.3.1.1.1.1.2.2.cmml">θ</mi><mi id="S2.E5.m1.1.1.1.1.3.1.1.1.1.2.3" xref="S2.E5.m1.1.1.1.1.3.1.1.1.1.2.3.cmml">V</mi></msub><mo id="S2.E5.m1.1.1.1.1.3.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.3.1.1.1.1.1.cmml">⁢</mo><msub id="S2.E5.m1.1.1.1.1.3.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.3.1.1.1.1.3.cmml"><mi id="S2.E5.m1.1.1.1.1.3.1.1.1.1.3.2" xref="S2.E5.m1.1.1.1.1.3.1.1.1.1.3.2.cmml">x</mi><mi id="S2.E5.m1.1.1.1.1.3.1.1.1.1.3.3" xref="S2.E5.m1.1.1.1.1.3.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo id="S2.E5.m1.1.1.1.1.3.1.1.1.3" xref="S2.E5.m1.1.1.1.1.3.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E5.m1.1.1.1.1.5.3.4" xref="S2.E5.m1.1.1.1.1.5.3.4.cmml">⁢</mo><msup id="S2.E5.m1.1.1.1.1.4.2.2" xref="S2.E5.m1.1.1.1.1.4.2.2.cmml"><mrow id="S2.E5.m1.1.1.1.1.4.2.2.1.1" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.cmml"><mo id="S2.E5.m1.1.1.1.1.4.2.2.1.1.2" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.1.1.1.1.4.2.2.1.1.1" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.cmml"><msub id="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.2" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.2.cmml"><mi id="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.2.2" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.2.2.cmml">θ</mi><mi id="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.2.3" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.2.3.cmml">K</mi></msub><mo id="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.1" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.1.cmml">⁢</mo><msub id="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.3" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.3.cmml"><mi id="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.3.2" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.3.2.cmml">x</mi><mi id="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.3.3" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.3.3.cmml">s</mi></msub></mrow><mo id="S2.E5.m1.1.1.1.1.4.2.2.1.1.3" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.cmml">)</mo></mrow><mi id="S2.E5.m1.1.1.1.1.4.2.2.3" xref="S2.E5.m1.1.1.1.1.4.2.2.3.cmml">T</mi></msup><mo id="S2.E5.m1.1.1.1.1.5.3.4a" xref="S2.E5.m1.1.1.1.1.5.3.4.cmml">⁢</mo><mrow id="S2.E5.m1.1.1.1.1.5.3.3.1" xref="S2.E5.m1.1.1.1.1.5.3.3.1.1.cmml"><mo id="S2.E5.m1.1.1.1.1.5.3.3.1.2" xref="S2.E5.m1.1.1.1.1.5.3.3.1.1.cmml">(</mo><mrow id="S2.E5.m1.1.1.1.1.5.3.3.1.1" xref="S2.E5.m1.1.1.1.1.5.3.3.1.1.cmml"><msub id="S2.E5.m1.1.1.1.1.5.3.3.1.1.2" xref="S2.E5.m1.1.1.1.1.5.3.3.1.1.2.cmml"><mi id="S2.E5.m1.1.1.1.1.5.3.3.1.1.2.2" xref="S2.E5.m1.1.1.1.1.5.3.3.1.1.2.2.cmml">θ</mi><mi id="S2.E5.m1.1.1.1.1.5.3.3.1.1.2.3" xref="S2.E5.m1.1.1.1.1.5.3.3.1.1.2.3.cmml">Q</mi></msub><mo id="S2.E5.m1.1.1.1.1.5.3.3.1.1.1" xref="S2.E5.m1.1.1.1.1.5.3.3.1.1.1.cmml">⁢</mo><msub id="S2.E5.m1.1.1.1.1.5.3.3.1.1.3" xref="S2.E5.m1.1.1.1.1.5.3.3.1.1.3.cmml"><mi id="S2.E5.m1.1.1.1.1.5.3.3.1.1.3.2" xref="S2.E5.m1.1.1.1.1.5.3.3.1.1.3.2.cmml">x</mi><mi id="S2.E5.m1.1.1.1.1.5.3.3.1.1.3.3" xref="S2.E5.m1.1.1.1.1.5.3.3.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.E5.m1.1.1.1.1.5.3.3.1.3" xref="S2.E5.m1.1.1.1.1.5.3.3.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E5.m1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.1b"><apply id="S2.E5.m1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1"><and id="S2.E5.m1.1.1.1.1a.cmml" xref="S2.E5.m1.1.1.1"></and><apply id="S2.E5.m1.1.1.1.1b.cmml" xref="S2.E5.m1.1.1.1"><eq id="S2.E5.m1.1.1.1.1.8.cmml" xref="S2.E5.m1.1.1.1.1.8"></eq><apply id="S2.E5.m1.1.1.1.1.7.cmml" xref="S2.E5.m1.1.1.1.1.7"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.7.1.cmml" xref="S2.E5.m1.1.1.1.1.7">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.7.2.cmml" xref="S2.E5.m1.1.1.1.1.7.2">𝑧</ci><ci id="S2.E5.m1.1.1.1.1.7.3.cmml" xref="S2.E5.m1.1.1.1.1.7.3">𝑡</ci></apply><apply id="S2.E5.m1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.2"><times id="S2.E5.m1.1.1.1.1.2.3.cmml" xref="S2.E5.m1.1.1.1.1.2.3"></times><ci id="S2.E5.m1.1.1.1.1.2.4.cmml" xref="S2.E5.m1.1.1.1.1.2.4">𝑓</ci><list id="S2.E5.m1.1.1.1.1.2.2.3.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2"><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1"><times id="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1"></times><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.2">𝜃</ci><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.3">𝑄</ci></apply><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S2.E5.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2">𝑊</ci><ci id="S2.E5.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.3">𝑡</ci></apply></list></apply></apply><apply id="S2.E5.m1.1.1.1.1c.cmml" xref="S2.E5.m1.1.1.1"><eq id="S2.E5.m1.1.1.1.1.9.cmml" xref="S2.E5.m1.1.1.1.1.9"></eq><share href="https://arxiv.org/html/2410.02523v1#S2.E5.m1.1.1.1.1.2.cmml" id="S2.E5.m1.1.1.1.1d.cmml" xref="S2.E5.m1.1.1.1"></share><apply id="S2.E5.m1.1.1.1.1.5.cmml" xref="S2.E5.m1.1.1.1.1.5"><apply id="S2.E5.m1.1.1.1.1.5.4.cmml" xref="S2.E5.m1.1.1.1.1.5.4"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.5.4.1.cmml" xref="S2.E5.m1.1.1.1.1.5.4">superscript</csymbol><apply id="S2.E5.m1.1.1.1.1.5.4.2.cmml" xref="S2.E5.m1.1.1.1.1.5.4"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.5.4.2.1.cmml" xref="S2.E5.m1.1.1.1.1.5.4">subscript</csymbol><sum id="S2.E5.m1.1.1.1.1.5.4.2.2.cmml" xref="S2.E5.m1.1.1.1.1.5.4.2.2"></sum><apply id="S2.E5.m1.1.1.1.1.5.4.2.3.cmml" xref="S2.E5.m1.1.1.1.1.5.4.2.3"><eq id="S2.E5.m1.1.1.1.1.5.4.2.3.1.cmml" xref="S2.E5.m1.1.1.1.1.5.4.2.3.1"></eq><ci id="S2.E5.m1.1.1.1.1.5.4.2.3.2.cmml" xref="S2.E5.m1.1.1.1.1.5.4.2.3.2">𝑠</ci><cn id="S2.E5.m1.1.1.1.1.5.4.2.3.3.cmml" type="integer" xref="S2.E5.m1.1.1.1.1.5.4.2.3.3">1</cn></apply></apply><ci id="S2.E5.m1.1.1.1.1.5.4.3.cmml" xref="S2.E5.m1.1.1.1.1.5.4.3">𝑡</ci></apply><apply id="S2.E5.m1.1.1.1.1.5.3.cmml" xref="S2.E5.m1.1.1.1.1.5.3"><times id="S2.E5.m1.1.1.1.1.5.3.4.cmml" xref="S2.E5.m1.1.1.1.1.5.3.4"></times><apply id="S2.E5.m1.1.1.1.1.3.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.3.1.1.1"><times id="S2.E5.m1.1.1.1.1.3.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.3.1.1.1.1.1"></times><apply id="S2.E5.m1.1.1.1.1.3.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.3.1.1.1.1.2.1.cmml" xref="S2.E5.m1.1.1.1.1.3.1.1.1.1.2">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.3.1.1.1.1.2.2.cmml" xref="S2.E5.m1.1.1.1.1.3.1.1.1.1.2.2">𝜃</ci><ci id="S2.E5.m1.1.1.1.1.3.1.1.1.1.2.3.cmml" xref="S2.E5.m1.1.1.1.1.3.1.1.1.1.2.3">𝑉</ci></apply><apply id="S2.E5.m1.1.1.1.1.3.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.3.1.1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1.1.3.1.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.3.1.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.1.3.1.1.1.1.3.2">𝑥</ci><ci id="S2.E5.m1.1.1.1.1.3.1.1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.1.1.3.1.1.1.1.3.3">𝑠</ci></apply></apply><apply id="S2.E5.m1.1.1.1.1.4.2.2.cmml" xref="S2.E5.m1.1.1.1.1.4.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.4.2.2.2.cmml" xref="S2.E5.m1.1.1.1.1.4.2.2">superscript</csymbol><apply id="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1"><times id="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.1"></times><apply id="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.2.1.cmml" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.2">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.2.2.cmml" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.2.2">𝜃</ci><ci id="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.2.3.cmml" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.2.3">𝐾</ci></apply><apply id="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.3.2">𝑥</ci><ci id="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.1.1.4.2.2.1.1.1.3.3">𝑠</ci></apply></apply><ci id="S2.E5.m1.1.1.1.1.4.2.2.3.cmml" xref="S2.E5.m1.1.1.1.1.4.2.2.3">𝑇</ci></apply><apply id="S2.E5.m1.1.1.1.1.5.3.3.1.1.cmml" xref="S2.E5.m1.1.1.1.1.5.3.3.1"><times id="S2.E5.m1.1.1.1.1.5.3.3.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.5.3.3.1.1.1"></times><apply id="S2.E5.m1.1.1.1.1.5.3.3.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.5.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.5.3.3.1.1.2.1.cmml" xref="S2.E5.m1.1.1.1.1.5.3.3.1.1.2">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.5.3.3.1.1.2.2.cmml" xref="S2.E5.m1.1.1.1.1.5.3.3.1.1.2.2">𝜃</ci><ci id="S2.E5.m1.1.1.1.1.5.3.3.1.1.2.3.cmml" xref="S2.E5.m1.1.1.1.1.5.3.3.1.1.2.3">𝑄</ci></apply><apply id="S2.E5.m1.1.1.1.1.5.3.3.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.5.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.5.3.3.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1.1.5.3.3.1.1.3">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.5.3.3.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.1.5.3.3.1.1.3.2">𝑥</ci><ci id="S2.E5.m1.1.1.1.1.5.3.3.1.1.3.3.cmml" xref="S2.E5.m1.1.1.1.1.5.3.3.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.1c">z_{t}=f\left(\theta_{Q}x_{t};W_{t}\right)=\sum_{s=1}^{t}\left(\theta_{V}x_{s}%
\right)\left(\theta_{K}x_{s}\right)^{T}\left(\theta_{Q}x_{t}\right),</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.1d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_f ( italic_θ start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ; italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ( italic_θ start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) ( italic_θ start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ( italic_θ start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p1.7">which is equivalent to linear self-attention.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.3">For non-parametric models <math alttext="f" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">italic_f</annotation></semantics></math>, since <math alttext="w_{t}" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.1"><semantics id="S2.SS1.p2.2.m2.1a"><msub id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml"><mi id="S2.SS1.p2.2.m2.1.1.2" xref="S2.SS1.p2.2.m2.1.1.2.cmml">w</mi><mi id="S2.SS1.p2.2.m2.1.1.3" xref="S2.SS1.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><apply id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.1.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p2.2.m2.1.1.2.cmml" xref="S2.SS1.p2.2.m2.1.1.2">𝑤</ci><ci id="S2.SS1.p2.2.m2.1.1.3.cmml" xref="S2.SS1.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">w_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.1d">italic_w start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> does not exist, we use the notation <math alttext="f(x;x_{1},\ldots,x_{t})" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m3.4"><semantics id="S2.SS1.p2.3.m3.4a"><mrow id="S2.SS1.p2.3.m3.4.4" xref="S2.SS1.p2.3.m3.4.4.cmml"><mi id="S2.SS1.p2.3.m3.4.4.4" xref="S2.SS1.p2.3.m3.4.4.4.cmml">f</mi><mo id="S2.SS1.p2.3.m3.4.4.3" xref="S2.SS1.p2.3.m3.4.4.3.cmml">⁢</mo><mrow id="S2.SS1.p2.3.m3.4.4.2.2" xref="S2.SS1.p2.3.m3.4.4.2.3.cmml"><mo id="S2.SS1.p2.3.m3.4.4.2.2.3" stretchy="false" xref="S2.SS1.p2.3.m3.4.4.2.3.cmml">(</mo><mi id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml">x</mi><mo id="S2.SS1.p2.3.m3.4.4.2.2.4" xref="S2.SS1.p2.3.m3.4.4.2.3.cmml">;</mo><msub id="S2.SS1.p2.3.m3.3.3.1.1.1" xref="S2.SS1.p2.3.m3.3.3.1.1.1.cmml"><mi id="S2.SS1.p2.3.m3.3.3.1.1.1.2" xref="S2.SS1.p2.3.m3.3.3.1.1.1.2.cmml">x</mi><mn id="S2.SS1.p2.3.m3.3.3.1.1.1.3" xref="S2.SS1.p2.3.m3.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p2.3.m3.4.4.2.2.5" xref="S2.SS1.p2.3.m3.4.4.2.3.cmml">,</mo><mi id="S2.SS1.p2.3.m3.2.2" mathvariant="normal" xref="S2.SS1.p2.3.m3.2.2.cmml">…</mi><mo id="S2.SS1.p2.3.m3.4.4.2.2.6" xref="S2.SS1.p2.3.m3.4.4.2.3.cmml">,</mo><msub id="S2.SS1.p2.3.m3.4.4.2.2.2" xref="S2.SS1.p2.3.m3.4.4.2.2.2.cmml"><mi id="S2.SS1.p2.3.m3.4.4.2.2.2.2" xref="S2.SS1.p2.3.m3.4.4.2.2.2.2.cmml">x</mi><mi id="S2.SS1.p2.3.m3.4.4.2.2.2.3" xref="S2.SS1.p2.3.m3.4.4.2.2.2.3.cmml">t</mi></msub><mo id="S2.SS1.p2.3.m3.4.4.2.2.7" stretchy="false" xref="S2.SS1.p2.3.m3.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.4b"><apply id="S2.SS1.p2.3.m3.4.4.cmml" xref="S2.SS1.p2.3.m3.4.4"><times id="S2.SS1.p2.3.m3.4.4.3.cmml" xref="S2.SS1.p2.3.m3.4.4.3"></times><ci id="S2.SS1.p2.3.m3.4.4.4.cmml" xref="S2.SS1.p2.3.m3.4.4.4">𝑓</ci><list id="S2.SS1.p2.3.m3.4.4.2.3.cmml" xref="S2.SS1.p2.3.m3.4.4.2.2"><ci id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">𝑥</ci><apply id="S2.SS1.p2.3.m3.3.3.1.1.1.cmml" xref="S2.SS1.p2.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.3.3.1.1.1.1.cmml" xref="S2.SS1.p2.3.m3.3.3.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.3.m3.3.3.1.1.1.2.cmml" xref="S2.SS1.p2.3.m3.3.3.1.1.1.2">𝑥</ci><cn id="S2.SS1.p2.3.m3.3.3.1.1.1.3.cmml" type="integer" xref="S2.SS1.p2.3.m3.3.3.1.1.1.3">1</cn></apply><ci id="S2.SS1.p2.3.m3.2.2.cmml" xref="S2.SS1.p2.3.m3.2.2">…</ci><apply id="S2.SS1.p2.3.m3.4.4.2.2.2.cmml" xref="S2.SS1.p2.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.4.4.2.2.2.1.cmml" xref="S2.SS1.p2.3.m3.4.4.2.2.2">subscript</csymbol><ci id="S2.SS1.p2.3.m3.4.4.2.2.2.2.cmml" xref="S2.SS1.p2.3.m3.4.4.2.2.2.2">𝑥</ci><ci id="S2.SS1.p2.3.m3.4.4.2.2.2.3.cmml" xref="S2.SS1.p2.3.m3.4.4.2.2.2.3">𝑡</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.4c">f(x;x_{1},\ldots,x_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.4d">italic_f ( italic_x ; italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>. Consider the TTT layer using the Nadaraya-Watson estimator, defined as:</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p3">
<table class="ltx_equation ltx_eqn_table" id="S2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f(x;x_{1},\ldots,x_{t})=\frac{\sum_{s=1}^{t}\kappa(x,x_{s})y_{s}}{\sum_{s=1}^{%
t}\kappa(x,x_{s})}," class="ltx_Math" display="block" id="S2.E6.m1.7"><semantics id="S2.E6.m1.7a"><mrow id="S2.E6.m1.7.7.1" xref="S2.E6.m1.7.7.1.1.cmml"><mrow id="S2.E6.m1.7.7.1.1" xref="S2.E6.m1.7.7.1.1.cmml"><mrow id="S2.E6.m1.7.7.1.1.2" xref="S2.E6.m1.7.7.1.1.2.cmml"><mi id="S2.E6.m1.7.7.1.1.2.4" xref="S2.E6.m1.7.7.1.1.2.4.cmml">f</mi><mo id="S2.E6.m1.7.7.1.1.2.3" xref="S2.E6.m1.7.7.1.1.2.3.cmml">⁢</mo><mrow id="S2.E6.m1.7.7.1.1.2.2.2" xref="S2.E6.m1.7.7.1.1.2.2.3.cmml"><mo id="S2.E6.m1.7.7.1.1.2.2.2.3" stretchy="false" xref="S2.E6.m1.7.7.1.1.2.2.3.cmml">(</mo><mi id="S2.E6.m1.5.5" xref="S2.E6.m1.5.5.cmml">x</mi><mo id="S2.E6.m1.7.7.1.1.2.2.2.4" xref="S2.E6.m1.7.7.1.1.2.2.3.cmml">;</mo><msub id="S2.E6.m1.7.7.1.1.1.1.1.1" xref="S2.E6.m1.7.7.1.1.1.1.1.1.cmml"><mi id="S2.E6.m1.7.7.1.1.1.1.1.1.2" xref="S2.E6.m1.7.7.1.1.1.1.1.1.2.cmml">x</mi><mn id="S2.E6.m1.7.7.1.1.1.1.1.1.3" xref="S2.E6.m1.7.7.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.E6.m1.7.7.1.1.2.2.2.5" xref="S2.E6.m1.7.7.1.1.2.2.3.cmml">,</mo><mi id="S2.E6.m1.6.6" mathvariant="normal" xref="S2.E6.m1.6.6.cmml">…</mi><mo id="S2.E6.m1.7.7.1.1.2.2.2.6" xref="S2.E6.m1.7.7.1.1.2.2.3.cmml">,</mo><msub id="S2.E6.m1.7.7.1.1.2.2.2.2" xref="S2.E6.m1.7.7.1.1.2.2.2.2.cmml"><mi id="S2.E6.m1.7.7.1.1.2.2.2.2.2" xref="S2.E6.m1.7.7.1.1.2.2.2.2.2.cmml">x</mi><mi id="S2.E6.m1.7.7.1.1.2.2.2.2.3" xref="S2.E6.m1.7.7.1.1.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.E6.m1.7.7.1.1.2.2.2.7" stretchy="false" xref="S2.E6.m1.7.7.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E6.m1.7.7.1.1.3" xref="S2.E6.m1.7.7.1.1.3.cmml">=</mo><mfrac id="S2.E6.m1.4.4" xref="S2.E6.m1.4.4.cmml"><mrow id="S2.E6.m1.2.2.2" xref="S2.E6.m1.2.2.2.cmml"><msubsup id="S2.E6.m1.2.2.2.3" xref="S2.E6.m1.2.2.2.3.cmml"><mo id="S2.E6.m1.2.2.2.3.2.2" xref="S2.E6.m1.2.2.2.3.2.2.cmml">∑</mo><mrow id="S2.E6.m1.2.2.2.3.2.3" xref="S2.E6.m1.2.2.2.3.2.3.cmml"><mi id="S2.E6.m1.2.2.2.3.2.3.2" xref="S2.E6.m1.2.2.2.3.2.3.2.cmml">s</mi><mo id="S2.E6.m1.2.2.2.3.2.3.1" xref="S2.E6.m1.2.2.2.3.2.3.1.cmml">=</mo><mn id="S2.E6.m1.2.2.2.3.2.3.3" xref="S2.E6.m1.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E6.m1.2.2.2.3.3" xref="S2.E6.m1.2.2.2.3.3.cmml">t</mi></msubsup><mrow id="S2.E6.m1.2.2.2.2" xref="S2.E6.m1.2.2.2.2.cmml"><mi id="S2.E6.m1.2.2.2.2.3" xref="S2.E6.m1.2.2.2.2.3.cmml">κ</mi><mo id="S2.E6.m1.2.2.2.2.2" xref="S2.E6.m1.2.2.2.2.2.cmml">⁢</mo><mrow id="S2.E6.m1.2.2.2.2.1.1" xref="S2.E6.m1.2.2.2.2.1.2.cmml"><mo id="S2.E6.m1.2.2.2.2.1.1.2" stretchy="false" xref="S2.E6.m1.2.2.2.2.1.2.cmml">(</mo><mi id="S2.E6.m1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.cmml">x</mi><mo id="S2.E6.m1.2.2.2.2.1.1.3" xref="S2.E6.m1.2.2.2.2.1.2.cmml">,</mo><msub id="S2.E6.m1.2.2.2.2.1.1.1" xref="S2.E6.m1.2.2.2.2.1.1.1.cmml"><mi id="S2.E6.m1.2.2.2.2.1.1.1.2" xref="S2.E6.m1.2.2.2.2.1.1.1.2.cmml">x</mi><mi id="S2.E6.m1.2.2.2.2.1.1.1.3" xref="S2.E6.m1.2.2.2.2.1.1.1.3.cmml">s</mi></msub><mo id="S2.E6.m1.2.2.2.2.1.1.4" stretchy="false" xref="S2.E6.m1.2.2.2.2.1.2.cmml">)</mo></mrow><mo id="S2.E6.m1.2.2.2.2.2a" xref="S2.E6.m1.2.2.2.2.2.cmml">⁢</mo><msub id="S2.E6.m1.2.2.2.2.4" xref="S2.E6.m1.2.2.2.2.4.cmml"><mi id="S2.E6.m1.2.2.2.2.4.2" xref="S2.E6.m1.2.2.2.2.4.2.cmml">y</mi><mi id="S2.E6.m1.2.2.2.2.4.3" xref="S2.E6.m1.2.2.2.2.4.3.cmml">s</mi></msub></mrow></mrow><mrow id="S2.E6.m1.4.4.4" xref="S2.E6.m1.4.4.4.cmml"><msubsup id="S2.E6.m1.4.4.4.3" xref="S2.E6.m1.4.4.4.3.cmml"><mo id="S2.E6.m1.4.4.4.3.2.2" xref="S2.E6.m1.4.4.4.3.2.2.cmml">∑</mo><mrow id="S2.E6.m1.4.4.4.3.2.3" xref="S2.E6.m1.4.4.4.3.2.3.cmml"><mi id="S2.E6.m1.4.4.4.3.2.3.2" xref="S2.E6.m1.4.4.4.3.2.3.2.cmml">s</mi><mo id="S2.E6.m1.4.4.4.3.2.3.1" xref="S2.E6.m1.4.4.4.3.2.3.1.cmml">=</mo><mn id="S2.E6.m1.4.4.4.3.2.3.3" xref="S2.E6.m1.4.4.4.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E6.m1.4.4.4.3.3" xref="S2.E6.m1.4.4.4.3.3.cmml">t</mi></msubsup><mrow id="S2.E6.m1.4.4.4.2" xref="S2.E6.m1.4.4.4.2.cmml"><mi id="S2.E6.m1.4.4.4.2.3" xref="S2.E6.m1.4.4.4.2.3.cmml">κ</mi><mo id="S2.E6.m1.4.4.4.2.2" xref="S2.E6.m1.4.4.4.2.2.cmml">⁢</mo><mrow id="S2.E6.m1.4.4.4.2.1.1" xref="S2.E6.m1.4.4.4.2.1.2.cmml"><mo id="S2.E6.m1.4.4.4.2.1.1.2" stretchy="false" xref="S2.E6.m1.4.4.4.2.1.2.cmml">(</mo><mi id="S2.E6.m1.3.3.3.1" xref="S2.E6.m1.3.3.3.1.cmml">x</mi><mo id="S2.E6.m1.4.4.4.2.1.1.3" xref="S2.E6.m1.4.4.4.2.1.2.cmml">,</mo><msub id="S2.E6.m1.4.4.4.2.1.1.1" xref="S2.E6.m1.4.4.4.2.1.1.1.cmml"><mi id="S2.E6.m1.4.4.4.2.1.1.1.2" xref="S2.E6.m1.4.4.4.2.1.1.1.2.cmml">x</mi><mi id="S2.E6.m1.4.4.4.2.1.1.1.3" xref="S2.E6.m1.4.4.4.2.1.1.1.3.cmml">s</mi></msub><mo id="S2.E6.m1.4.4.4.2.1.1.4" stretchy="false" xref="S2.E6.m1.4.4.4.2.1.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S2.E6.m1.7.7.1.2" xref="S2.E6.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.7b"><apply id="S2.E6.m1.7.7.1.1.cmml" xref="S2.E6.m1.7.7.1"><eq id="S2.E6.m1.7.7.1.1.3.cmml" xref="S2.E6.m1.7.7.1.1.3"></eq><apply id="S2.E6.m1.7.7.1.1.2.cmml" xref="S2.E6.m1.7.7.1.1.2"><times id="S2.E6.m1.7.7.1.1.2.3.cmml" xref="S2.E6.m1.7.7.1.1.2.3"></times><ci id="S2.E6.m1.7.7.1.1.2.4.cmml" xref="S2.E6.m1.7.7.1.1.2.4">𝑓</ci><list id="S2.E6.m1.7.7.1.1.2.2.3.cmml" xref="S2.E6.m1.7.7.1.1.2.2.2"><ci id="S2.E6.m1.5.5.cmml" xref="S2.E6.m1.5.5">𝑥</ci><apply id="S2.E6.m1.7.7.1.1.1.1.1.1.cmml" xref="S2.E6.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.7.7.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E6.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.7.7.1.1.1.1.1.1.2">𝑥</ci><cn id="S2.E6.m1.7.7.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E6.m1.7.7.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.E6.m1.6.6.cmml" xref="S2.E6.m1.6.6">…</ci><apply id="S2.E6.m1.7.7.1.1.2.2.2.2.cmml" xref="S2.E6.m1.7.7.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E6.m1.7.7.1.1.2.2.2.2.1.cmml" xref="S2.E6.m1.7.7.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E6.m1.7.7.1.1.2.2.2.2.2.cmml" xref="S2.E6.m1.7.7.1.1.2.2.2.2.2">𝑥</ci><ci id="S2.E6.m1.7.7.1.1.2.2.2.2.3.cmml" xref="S2.E6.m1.7.7.1.1.2.2.2.2.3">𝑡</ci></apply></list></apply><apply id="S2.E6.m1.4.4.cmml" xref="S2.E6.m1.4.4"><divide id="S2.E6.m1.4.4.5.cmml" xref="S2.E6.m1.4.4"></divide><apply id="S2.E6.m1.2.2.2.cmml" xref="S2.E6.m1.2.2.2"><apply id="S2.E6.m1.2.2.2.3.cmml" xref="S2.E6.m1.2.2.2.3"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.2.3.1.cmml" xref="S2.E6.m1.2.2.2.3">superscript</csymbol><apply id="S2.E6.m1.2.2.2.3.2.cmml" xref="S2.E6.m1.2.2.2.3"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.2.3.2.1.cmml" xref="S2.E6.m1.2.2.2.3">subscript</csymbol><sum id="S2.E6.m1.2.2.2.3.2.2.cmml" xref="S2.E6.m1.2.2.2.3.2.2"></sum><apply id="S2.E6.m1.2.2.2.3.2.3.cmml" xref="S2.E6.m1.2.2.2.3.2.3"><eq id="S2.E6.m1.2.2.2.3.2.3.1.cmml" xref="S2.E6.m1.2.2.2.3.2.3.1"></eq><ci id="S2.E6.m1.2.2.2.3.2.3.2.cmml" xref="S2.E6.m1.2.2.2.3.2.3.2">𝑠</ci><cn id="S2.E6.m1.2.2.2.3.2.3.3.cmml" type="integer" xref="S2.E6.m1.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S2.E6.m1.2.2.2.3.3.cmml" xref="S2.E6.m1.2.2.2.3.3">𝑡</ci></apply><apply id="S2.E6.m1.2.2.2.2.cmml" xref="S2.E6.m1.2.2.2.2"><times id="S2.E6.m1.2.2.2.2.2.cmml" xref="S2.E6.m1.2.2.2.2.2"></times><ci id="S2.E6.m1.2.2.2.2.3.cmml" xref="S2.E6.m1.2.2.2.2.3">𝜅</ci><interval closure="open" id="S2.E6.m1.2.2.2.2.1.2.cmml" xref="S2.E6.m1.2.2.2.2.1.1"><ci id="S2.E6.m1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1">𝑥</ci><apply id="S2.E6.m1.2.2.2.2.1.1.1.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.2.2.1.1.1.1.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E6.m1.2.2.2.2.1.1.1.2.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1.2">𝑥</ci><ci id="S2.E6.m1.2.2.2.2.1.1.1.3.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1.3">𝑠</ci></apply></interval><apply id="S2.E6.m1.2.2.2.2.4.cmml" xref="S2.E6.m1.2.2.2.2.4"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.2.2.4.1.cmml" xref="S2.E6.m1.2.2.2.2.4">subscript</csymbol><ci id="S2.E6.m1.2.2.2.2.4.2.cmml" xref="S2.E6.m1.2.2.2.2.4.2">𝑦</ci><ci id="S2.E6.m1.2.2.2.2.4.3.cmml" xref="S2.E6.m1.2.2.2.2.4.3">𝑠</ci></apply></apply></apply><apply id="S2.E6.m1.4.4.4.cmml" xref="S2.E6.m1.4.4.4"><apply id="S2.E6.m1.4.4.4.3.cmml" xref="S2.E6.m1.4.4.4.3"><csymbol cd="ambiguous" id="S2.E6.m1.4.4.4.3.1.cmml" xref="S2.E6.m1.4.4.4.3">superscript</csymbol><apply id="S2.E6.m1.4.4.4.3.2.cmml" xref="S2.E6.m1.4.4.4.3"><csymbol cd="ambiguous" id="S2.E6.m1.4.4.4.3.2.1.cmml" xref="S2.E6.m1.4.4.4.3">subscript</csymbol><sum id="S2.E6.m1.4.4.4.3.2.2.cmml" xref="S2.E6.m1.4.4.4.3.2.2"></sum><apply id="S2.E6.m1.4.4.4.3.2.3.cmml" xref="S2.E6.m1.4.4.4.3.2.3"><eq id="S2.E6.m1.4.4.4.3.2.3.1.cmml" xref="S2.E6.m1.4.4.4.3.2.3.1"></eq><ci id="S2.E6.m1.4.4.4.3.2.3.2.cmml" xref="S2.E6.m1.4.4.4.3.2.3.2">𝑠</ci><cn id="S2.E6.m1.4.4.4.3.2.3.3.cmml" type="integer" xref="S2.E6.m1.4.4.4.3.2.3.3">1</cn></apply></apply><ci id="S2.E6.m1.4.4.4.3.3.cmml" xref="S2.E6.m1.4.4.4.3.3">𝑡</ci></apply><apply id="S2.E6.m1.4.4.4.2.cmml" xref="S2.E6.m1.4.4.4.2"><times id="S2.E6.m1.4.4.4.2.2.cmml" xref="S2.E6.m1.4.4.4.2.2"></times><ci id="S2.E6.m1.4.4.4.2.3.cmml" xref="S2.E6.m1.4.4.4.2.3">𝜅</ci><interval closure="open" id="S2.E6.m1.4.4.4.2.1.2.cmml" xref="S2.E6.m1.4.4.4.2.1.1"><ci id="S2.E6.m1.3.3.3.1.cmml" xref="S2.E6.m1.3.3.3.1">𝑥</ci><apply id="S2.E6.m1.4.4.4.2.1.1.1.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.4.4.4.2.1.1.1.1.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1">subscript</csymbol><ci id="S2.E6.m1.4.4.4.2.1.1.1.2.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1.2">𝑥</ci><ci id="S2.E6.m1.4.4.4.2.1.1.1.3.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1.3">𝑠</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.7c">f(x;x_{1},\ldots,x_{t})=\frac{\sum_{s=1}^{t}\kappa(x,x_{s})y_{s}}{\sum_{s=1}^{%
t}\kappa(x,x_{s})},</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.7d">italic_f ( italic_x ; italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = divide start_ARG ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_κ ( italic_x , italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) italic_y start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_κ ( italic_x , italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p4">
<p class="ltx_p" id="S2.SS1.p4.4">where <math alttext="y_{s}=\theta_{V}x_{s}" class="ltx_Math" display="inline" id="S2.SS1.p4.1.m1.1"><semantics id="S2.SS1.p4.1.m1.1a"><mrow id="S2.SS1.p4.1.m1.1.1" xref="S2.SS1.p4.1.m1.1.1.cmml"><msub id="S2.SS1.p4.1.m1.1.1.2" xref="S2.SS1.p4.1.m1.1.1.2.cmml"><mi id="S2.SS1.p4.1.m1.1.1.2.2" xref="S2.SS1.p4.1.m1.1.1.2.2.cmml">y</mi><mi id="S2.SS1.p4.1.m1.1.1.2.3" xref="S2.SS1.p4.1.m1.1.1.2.3.cmml">s</mi></msub><mo id="S2.SS1.p4.1.m1.1.1.1" xref="S2.SS1.p4.1.m1.1.1.1.cmml">=</mo><mrow id="S2.SS1.p4.1.m1.1.1.3" xref="S2.SS1.p4.1.m1.1.1.3.cmml"><msub id="S2.SS1.p4.1.m1.1.1.3.2" xref="S2.SS1.p4.1.m1.1.1.3.2.cmml"><mi id="S2.SS1.p4.1.m1.1.1.3.2.2" xref="S2.SS1.p4.1.m1.1.1.3.2.2.cmml">θ</mi><mi id="S2.SS1.p4.1.m1.1.1.3.2.3" xref="S2.SS1.p4.1.m1.1.1.3.2.3.cmml">V</mi></msub><mo id="S2.SS1.p4.1.m1.1.1.3.1" xref="S2.SS1.p4.1.m1.1.1.3.1.cmml">⁢</mo><msub id="S2.SS1.p4.1.m1.1.1.3.3" xref="S2.SS1.p4.1.m1.1.1.3.3.cmml"><mi id="S2.SS1.p4.1.m1.1.1.3.3.2" xref="S2.SS1.p4.1.m1.1.1.3.3.2.cmml">x</mi><mi id="S2.SS1.p4.1.m1.1.1.3.3.3" xref="S2.SS1.p4.1.m1.1.1.3.3.3.cmml">s</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.1b"><apply id="S2.SS1.p4.1.m1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1"><eq id="S2.SS1.p4.1.m1.1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1.1"></eq><apply id="S2.SS1.p4.1.m1.1.1.2.cmml" xref="S2.SS1.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.1.1.2.1.cmml" xref="S2.SS1.p4.1.m1.1.1.2">subscript</csymbol><ci id="S2.SS1.p4.1.m1.1.1.2.2.cmml" xref="S2.SS1.p4.1.m1.1.1.2.2">𝑦</ci><ci id="S2.SS1.p4.1.m1.1.1.2.3.cmml" xref="S2.SS1.p4.1.m1.1.1.2.3">𝑠</ci></apply><apply id="S2.SS1.p4.1.m1.1.1.3.cmml" xref="S2.SS1.p4.1.m1.1.1.3"><times id="S2.SS1.p4.1.m1.1.1.3.1.cmml" xref="S2.SS1.p4.1.m1.1.1.3.1"></times><apply id="S2.SS1.p4.1.m1.1.1.3.2.cmml" xref="S2.SS1.p4.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.1.1.3.2.1.cmml" xref="S2.SS1.p4.1.m1.1.1.3.2">subscript</csymbol><ci id="S2.SS1.p4.1.m1.1.1.3.2.2.cmml" xref="S2.SS1.p4.1.m1.1.1.3.2.2">𝜃</ci><ci id="S2.SS1.p4.1.m1.1.1.3.2.3.cmml" xref="S2.SS1.p4.1.m1.1.1.3.2.3">𝑉</ci></apply><apply id="S2.SS1.p4.1.m1.1.1.3.3.cmml" xref="S2.SS1.p4.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.1.1.3.3.1.cmml" xref="S2.SS1.p4.1.m1.1.1.3.3">subscript</csymbol><ci id="S2.SS1.p4.1.m1.1.1.3.3.2.cmml" xref="S2.SS1.p4.1.m1.1.1.3.3.2">𝑥</ci><ci id="S2.SS1.p4.1.m1.1.1.3.3.3.cmml" xref="S2.SS1.p4.1.m1.1.1.3.3.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.1c">y_{s}=\theta_{V}x_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.1.m1.1d">italic_y start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = italic_θ start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\kappa(x,x^{\prime};\theta_{K},\theta_{Q})\propto e^{(\theta_{K}x)^{T}(\theta_%
{Q}x^{\prime})}" class="ltx_Math" display="inline" id="S2.SS1.p4.2.m2.6"><semantics id="S2.SS1.p4.2.m2.6a"><mrow id="S2.SS1.p4.2.m2.6.6" xref="S2.SS1.p4.2.m2.6.6.cmml"><mrow id="S2.SS1.p4.2.m2.6.6.3" xref="S2.SS1.p4.2.m2.6.6.3.cmml"><mi id="S2.SS1.p4.2.m2.6.6.3.5" xref="S2.SS1.p4.2.m2.6.6.3.5.cmml">κ</mi><mo id="S2.SS1.p4.2.m2.6.6.3.4" xref="S2.SS1.p4.2.m2.6.6.3.4.cmml">⁢</mo><mrow id="S2.SS1.p4.2.m2.6.6.3.3.3" xref="S2.SS1.p4.2.m2.6.6.3.3.4.cmml"><mo id="S2.SS1.p4.2.m2.6.6.3.3.3.4" stretchy="false" xref="S2.SS1.p4.2.m2.6.6.3.3.4.cmml">(</mo><mi id="S2.SS1.p4.2.m2.3.3" xref="S2.SS1.p4.2.m2.3.3.cmml">x</mi><mo id="S2.SS1.p4.2.m2.6.6.3.3.3.5" xref="S2.SS1.p4.2.m2.6.6.3.3.4.cmml">,</mo><msup id="S2.SS1.p4.2.m2.4.4.1.1.1.1" xref="S2.SS1.p4.2.m2.4.4.1.1.1.1.cmml"><mi id="S2.SS1.p4.2.m2.4.4.1.1.1.1.2" xref="S2.SS1.p4.2.m2.4.4.1.1.1.1.2.cmml">x</mi><mo id="S2.SS1.p4.2.m2.4.4.1.1.1.1.3" xref="S2.SS1.p4.2.m2.4.4.1.1.1.1.3.cmml">′</mo></msup><mo id="S2.SS1.p4.2.m2.6.6.3.3.3.6" xref="S2.SS1.p4.2.m2.6.6.3.3.4.cmml">;</mo><msub id="S2.SS1.p4.2.m2.5.5.2.2.2.2" xref="S2.SS1.p4.2.m2.5.5.2.2.2.2.cmml"><mi id="S2.SS1.p4.2.m2.5.5.2.2.2.2.2" xref="S2.SS1.p4.2.m2.5.5.2.2.2.2.2.cmml">θ</mi><mi id="S2.SS1.p4.2.m2.5.5.2.2.2.2.3" xref="S2.SS1.p4.2.m2.5.5.2.2.2.2.3.cmml">K</mi></msub><mo id="S2.SS1.p4.2.m2.6.6.3.3.3.7" xref="S2.SS1.p4.2.m2.6.6.3.3.4.cmml">,</mo><msub id="S2.SS1.p4.2.m2.6.6.3.3.3.3" xref="S2.SS1.p4.2.m2.6.6.3.3.3.3.cmml"><mi id="S2.SS1.p4.2.m2.6.6.3.3.3.3.2" xref="S2.SS1.p4.2.m2.6.6.3.3.3.3.2.cmml">θ</mi><mi id="S2.SS1.p4.2.m2.6.6.3.3.3.3.3" xref="S2.SS1.p4.2.m2.6.6.3.3.3.3.3.cmml">Q</mi></msub><mo id="S2.SS1.p4.2.m2.6.6.3.3.3.8" stretchy="false" xref="S2.SS1.p4.2.m2.6.6.3.3.4.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p4.2.m2.6.6.4" xref="S2.SS1.p4.2.m2.6.6.4.cmml">∝</mo><msup id="S2.SS1.p4.2.m2.6.6.5" xref="S2.SS1.p4.2.m2.6.6.5.cmml"><mi id="S2.SS1.p4.2.m2.6.6.5.2" xref="S2.SS1.p4.2.m2.6.6.5.2.cmml">e</mi><mrow id="S2.SS1.p4.2.m2.2.2.2" xref="S2.SS1.p4.2.m2.2.2.2.cmml"><msup id="S2.SS1.p4.2.m2.1.1.1.1" xref="S2.SS1.p4.2.m2.1.1.1.1.cmml"><mrow id="S2.SS1.p4.2.m2.1.1.1.1.1.1" xref="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.cmml"><mo id="S2.SS1.p4.2.m2.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p4.2.m2.1.1.1.1.1.1.1" xref="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.cmml"><msub id="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.2" xref="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.2.2" xref="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mi id="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.2.3" xref="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.2.3.cmml">K</mi></msub><mo id="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.1" xref="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.3" xref="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS1.p4.2.m2.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S2.SS1.p4.2.m2.1.1.1.1.3" xref="S2.SS1.p4.2.m2.1.1.1.1.3.cmml">T</mi></msup><mo id="S2.SS1.p4.2.m2.2.2.2.3" xref="S2.SS1.p4.2.m2.2.2.2.3.cmml">⁢</mo><mrow id="S2.SS1.p4.2.m2.2.2.2.2.1" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.cmml"><mo id="S2.SS1.p4.2.m2.2.2.2.2.1.2" stretchy="false" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.cmml">(</mo><mrow id="S2.SS1.p4.2.m2.2.2.2.2.1.1" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.cmml"><msub id="S2.SS1.p4.2.m2.2.2.2.2.1.1.2" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.2.cmml"><mi id="S2.SS1.p4.2.m2.2.2.2.2.1.1.2.2" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.2.2.cmml">θ</mi><mi id="S2.SS1.p4.2.m2.2.2.2.2.1.1.2.3" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.2.3.cmml">Q</mi></msub><mo id="S2.SS1.p4.2.m2.2.2.2.2.1.1.1" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.1.cmml">⁢</mo><msup id="S2.SS1.p4.2.m2.2.2.2.2.1.1.3" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.3.cmml"><mi id="S2.SS1.p4.2.m2.2.2.2.2.1.1.3.2" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.3.2.cmml">x</mi><mo id="S2.SS1.p4.2.m2.2.2.2.2.1.1.3.3" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.3.3.cmml">′</mo></msup></mrow><mo id="S2.SS1.p4.2.m2.2.2.2.2.1.3" stretchy="false" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.2.m2.6b"><apply id="S2.SS1.p4.2.m2.6.6.cmml" xref="S2.SS1.p4.2.m2.6.6"><csymbol cd="latexml" id="S2.SS1.p4.2.m2.6.6.4.cmml" xref="S2.SS1.p4.2.m2.6.6.4">proportional-to</csymbol><apply id="S2.SS1.p4.2.m2.6.6.3.cmml" xref="S2.SS1.p4.2.m2.6.6.3"><times id="S2.SS1.p4.2.m2.6.6.3.4.cmml" xref="S2.SS1.p4.2.m2.6.6.3.4"></times><ci id="S2.SS1.p4.2.m2.6.6.3.5.cmml" xref="S2.SS1.p4.2.m2.6.6.3.5">𝜅</ci><vector id="S2.SS1.p4.2.m2.6.6.3.3.4.cmml" xref="S2.SS1.p4.2.m2.6.6.3.3.3"><ci id="S2.SS1.p4.2.m2.3.3.cmml" xref="S2.SS1.p4.2.m2.3.3">𝑥</ci><apply id="S2.SS1.p4.2.m2.4.4.1.1.1.1.cmml" xref="S2.SS1.p4.2.m2.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.2.m2.4.4.1.1.1.1.1.cmml" xref="S2.SS1.p4.2.m2.4.4.1.1.1.1">superscript</csymbol><ci id="S2.SS1.p4.2.m2.4.4.1.1.1.1.2.cmml" xref="S2.SS1.p4.2.m2.4.4.1.1.1.1.2">𝑥</ci><ci id="S2.SS1.p4.2.m2.4.4.1.1.1.1.3.cmml" xref="S2.SS1.p4.2.m2.4.4.1.1.1.1.3">′</ci></apply><apply id="S2.SS1.p4.2.m2.5.5.2.2.2.2.cmml" xref="S2.SS1.p4.2.m2.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p4.2.m2.5.5.2.2.2.2.1.cmml" xref="S2.SS1.p4.2.m2.5.5.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p4.2.m2.5.5.2.2.2.2.2.cmml" xref="S2.SS1.p4.2.m2.5.5.2.2.2.2.2">𝜃</ci><ci id="S2.SS1.p4.2.m2.5.5.2.2.2.2.3.cmml" xref="S2.SS1.p4.2.m2.5.5.2.2.2.2.3">𝐾</ci></apply><apply id="S2.SS1.p4.2.m2.6.6.3.3.3.3.cmml" xref="S2.SS1.p4.2.m2.6.6.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p4.2.m2.6.6.3.3.3.3.1.cmml" xref="S2.SS1.p4.2.m2.6.6.3.3.3.3">subscript</csymbol><ci id="S2.SS1.p4.2.m2.6.6.3.3.3.3.2.cmml" xref="S2.SS1.p4.2.m2.6.6.3.3.3.3.2">𝜃</ci><ci id="S2.SS1.p4.2.m2.6.6.3.3.3.3.3.cmml" xref="S2.SS1.p4.2.m2.6.6.3.3.3.3.3">𝑄</ci></apply></vector></apply><apply id="S2.SS1.p4.2.m2.6.6.5.cmml" xref="S2.SS1.p4.2.m2.6.6.5"><csymbol cd="ambiguous" id="S2.SS1.p4.2.m2.6.6.5.1.cmml" xref="S2.SS1.p4.2.m2.6.6.5">superscript</csymbol><ci id="S2.SS1.p4.2.m2.6.6.5.2.cmml" xref="S2.SS1.p4.2.m2.6.6.5.2">𝑒</ci><apply id="S2.SS1.p4.2.m2.2.2.2.cmml" xref="S2.SS1.p4.2.m2.2.2.2"><times id="S2.SS1.p4.2.m2.2.2.2.3.cmml" xref="S2.SS1.p4.2.m2.2.2.2.3"></times><apply id="S2.SS1.p4.2.m2.1.1.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.2.m2.1.1.1.1.2.cmml" xref="S2.SS1.p4.2.m2.1.1.1.1">superscript</csymbol><apply id="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1.1.1.1.1"><times id="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.1"></times><apply id="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.2.2">𝜃</ci><ci id="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.2.3">𝐾</ci></apply><ci id="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p4.2.m2.1.1.1.1.1.1.1.3">𝑥</ci></apply><ci id="S2.SS1.p4.2.m2.1.1.1.1.3.cmml" xref="S2.SS1.p4.2.m2.1.1.1.1.3">𝑇</ci></apply><apply id="S2.SS1.p4.2.m2.2.2.2.2.1.1.cmml" xref="S2.SS1.p4.2.m2.2.2.2.2.1"><times id="S2.SS1.p4.2.m2.2.2.2.2.1.1.1.cmml" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.1"></times><apply id="S2.SS1.p4.2.m2.2.2.2.2.1.1.2.cmml" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p4.2.m2.2.2.2.2.1.1.2.1.cmml" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.2">subscript</csymbol><ci id="S2.SS1.p4.2.m2.2.2.2.2.1.1.2.2.cmml" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.2.2">𝜃</ci><ci id="S2.SS1.p4.2.m2.2.2.2.2.1.1.2.3.cmml" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.2.3">𝑄</ci></apply><apply id="S2.SS1.p4.2.m2.2.2.2.2.1.1.3.cmml" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p4.2.m2.2.2.2.2.1.1.3.1.cmml" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.3">superscript</csymbol><ci id="S2.SS1.p4.2.m2.2.2.2.2.1.1.3.2.cmml" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.3.2">𝑥</ci><ci id="S2.SS1.p4.2.m2.2.2.2.2.1.1.3.3.cmml" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.3.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.2.m2.6c">\kappa(x,x^{\prime};\theta_{K},\theta_{Q})\propto e^{(\theta_{K}x)^{T}(\theta_%
{Q}x^{\prime})}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.2.m2.6d">italic_κ ( italic_x , italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ; italic_θ start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT , italic_θ start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ) ∝ italic_e start_POSTSUPERSCRIPT ( italic_θ start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT italic_x ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ( italic_θ start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) end_POSTSUPERSCRIPT</annotation></semantics></math> is a kernel function with parameters <math alttext="\theta_{K}" class="ltx_Math" display="inline" id="S2.SS1.p4.3.m3.1"><semantics id="S2.SS1.p4.3.m3.1a"><msub id="S2.SS1.p4.3.m3.1.1" xref="S2.SS1.p4.3.m3.1.1.cmml"><mi id="S2.SS1.p4.3.m3.1.1.2" xref="S2.SS1.p4.3.m3.1.1.2.cmml">θ</mi><mi id="S2.SS1.p4.3.m3.1.1.3" xref="S2.SS1.p4.3.m3.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.3.m3.1b"><apply id="S2.SS1.p4.3.m3.1.1.cmml" xref="S2.SS1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.3.m3.1.1.1.cmml" xref="S2.SS1.p4.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p4.3.m3.1.1.2.cmml" xref="S2.SS1.p4.3.m3.1.1.2">𝜃</ci><ci id="S2.SS1.p4.3.m3.1.1.3.cmml" xref="S2.SS1.p4.3.m3.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.3.m3.1c">\theta_{K}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.3.m3.1d">italic_θ start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\theta_{Q}" class="ltx_Math" display="inline" id="S2.SS1.p4.4.m4.1"><semantics id="S2.SS1.p4.4.m4.1a"><msub id="S2.SS1.p4.4.m4.1.1" xref="S2.SS1.p4.4.m4.1.1.cmml"><mi id="S2.SS1.p4.4.m4.1.1.2" xref="S2.SS1.p4.4.m4.1.1.2.cmml">θ</mi><mi id="S2.SS1.p4.4.m4.1.1.3" xref="S2.SS1.p4.4.m4.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.4.m4.1b"><apply id="S2.SS1.p4.4.m4.1.1.cmml" xref="S2.SS1.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.4.m4.1.1.1.cmml" xref="S2.SS1.p4.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p4.4.m4.1.1.2.cmml" xref="S2.SS1.p4.4.m4.1.1.2">𝜃</ci><ci id="S2.SS1.p4.4.m4.1.1.3.cmml" xref="S2.SS1.p4.4.m4.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.4.m4.1c">\theta_{Q}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.4.m4.1d">italic_θ start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p5">
<p class="ltx_p" id="S2.SS1.p5.1">Substituting the kernel function into <math alttext="f" class="ltx_Math" display="inline" id="S2.SS1.p5.1.m1.1"><semantics id="S2.SS1.p5.1.m1.1a"><mi id="S2.SS1.p5.1.m1.1.1" xref="S2.SS1.p5.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.1.m1.1b"><ci id="S2.SS1.p5.1.m1.1.1.cmml" xref="S2.SS1.p5.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.1.m1.1d">italic_f</annotation></semantics></math>, we obtain:</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p6">
<table class="ltx_equation ltx_eqn_table" id="S2.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f(x;x_{1},\ldots,x_{t})=\frac{\sum_{s=1}^{t}\exp\left((\theta_{K}x)^{T}(\theta%
_{Q}x_{s})\right)y_{s}}{\sum_{s=1}^{t}\exp\left((\theta_{K}x)^{T}(\theta_{Q}x_%
{s})\right)}." class="ltx_Math" display="block" id="S2.E7.m1.7"><semantics id="S2.E7.m1.7a"><mrow id="S2.E7.m1.7.7.1" xref="S2.E7.m1.7.7.1.1.cmml"><mrow id="S2.E7.m1.7.7.1.1" xref="S2.E7.m1.7.7.1.1.cmml"><mrow id="S2.E7.m1.7.7.1.1.2" xref="S2.E7.m1.7.7.1.1.2.cmml"><mi id="S2.E7.m1.7.7.1.1.2.4" xref="S2.E7.m1.7.7.1.1.2.4.cmml">f</mi><mo id="S2.E7.m1.7.7.1.1.2.3" xref="S2.E7.m1.7.7.1.1.2.3.cmml">⁢</mo><mrow id="S2.E7.m1.7.7.1.1.2.2.2" xref="S2.E7.m1.7.7.1.1.2.2.3.cmml"><mo id="S2.E7.m1.7.7.1.1.2.2.2.3" stretchy="false" xref="S2.E7.m1.7.7.1.1.2.2.3.cmml">(</mo><mi id="S2.E7.m1.5.5" xref="S2.E7.m1.5.5.cmml">x</mi><mo id="S2.E7.m1.7.7.1.1.2.2.2.4" xref="S2.E7.m1.7.7.1.1.2.2.3.cmml">;</mo><msub id="S2.E7.m1.7.7.1.1.1.1.1.1" xref="S2.E7.m1.7.7.1.1.1.1.1.1.cmml"><mi id="S2.E7.m1.7.7.1.1.1.1.1.1.2" xref="S2.E7.m1.7.7.1.1.1.1.1.1.2.cmml">x</mi><mn id="S2.E7.m1.7.7.1.1.1.1.1.1.3" xref="S2.E7.m1.7.7.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.E7.m1.7.7.1.1.2.2.2.5" xref="S2.E7.m1.7.7.1.1.2.2.3.cmml">,</mo><mi id="S2.E7.m1.6.6" mathvariant="normal" xref="S2.E7.m1.6.6.cmml">…</mi><mo id="S2.E7.m1.7.7.1.1.2.2.2.6" xref="S2.E7.m1.7.7.1.1.2.2.3.cmml">,</mo><msub id="S2.E7.m1.7.7.1.1.2.2.2.2" xref="S2.E7.m1.7.7.1.1.2.2.2.2.cmml"><mi id="S2.E7.m1.7.7.1.1.2.2.2.2.2" xref="S2.E7.m1.7.7.1.1.2.2.2.2.2.cmml">x</mi><mi id="S2.E7.m1.7.7.1.1.2.2.2.2.3" xref="S2.E7.m1.7.7.1.1.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.E7.m1.7.7.1.1.2.2.2.7" stretchy="false" xref="S2.E7.m1.7.7.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E7.m1.7.7.1.1.3" xref="S2.E7.m1.7.7.1.1.3.cmml">=</mo><mfrac id="S2.E7.m1.4.4" xref="S2.E7.m1.4.4.cmml"><mrow id="S2.E7.m1.2.2.2" xref="S2.E7.m1.2.2.2.cmml"><msubsup id="S2.E7.m1.2.2.2.3" xref="S2.E7.m1.2.2.2.3.cmml"><mo id="S2.E7.m1.2.2.2.3.2.2" xref="S2.E7.m1.2.2.2.3.2.2.cmml">∑</mo><mrow id="S2.E7.m1.2.2.2.3.2.3" xref="S2.E7.m1.2.2.2.3.2.3.cmml"><mi id="S2.E7.m1.2.2.2.3.2.3.2" xref="S2.E7.m1.2.2.2.3.2.3.2.cmml">s</mi><mo id="S2.E7.m1.2.2.2.3.2.3.1" xref="S2.E7.m1.2.2.2.3.2.3.1.cmml">=</mo><mn id="S2.E7.m1.2.2.2.3.2.3.3" xref="S2.E7.m1.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E7.m1.2.2.2.3.3" xref="S2.E7.m1.2.2.2.3.3.cmml">t</mi></msubsup><mrow id="S2.E7.m1.2.2.2.2" xref="S2.E7.m1.2.2.2.2.cmml"><mrow id="S2.E7.m1.2.2.2.2.1.1" xref="S2.E7.m1.2.2.2.2.1.2.cmml"><mi id="S2.E7.m1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.cmml">exp</mi><mo id="S2.E7.m1.2.2.2.2.1.1a" xref="S2.E7.m1.2.2.2.2.1.2.cmml">⁡</mo><mrow id="S2.E7.m1.2.2.2.2.1.1.1" xref="S2.E7.m1.2.2.2.2.1.2.cmml"><mo id="S2.E7.m1.2.2.2.2.1.1.1.2" xref="S2.E7.m1.2.2.2.2.1.2.cmml">(</mo><mrow id="S2.E7.m1.2.2.2.2.1.1.1.1" xref="S2.E7.m1.2.2.2.2.1.1.1.1.cmml"><msup id="S2.E7.m1.2.2.2.2.1.1.1.1.1" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1.cmml"><mrow id="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mi id="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.cmml">K</mi></msub><mo id="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S2.E7.m1.2.2.2.2.1.1.1.1.1.3" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1.3.cmml">T</mi></msup><mo id="S2.E7.m1.2.2.2.2.1.1.1.1.3" xref="S2.E7.m1.2.2.2.2.1.1.1.1.3.cmml">⁢</mo><mrow id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.cmml"><mo id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.2" stretchy="false" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.cmml">(</mo><mrow id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.cmml"><msub id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.2" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.2.cmml"><mi id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.2.2" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.2.2.cmml">θ</mi><mi id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.2.3" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.2.3.cmml">Q</mi></msub><mo id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.1" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.1.cmml">⁢</mo><msub id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.3" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.3.cmml"><mi id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.3.2" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.3.2.cmml">x</mi><mi id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.3.3" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.3.3.cmml">s</mi></msub></mrow><mo id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.3" stretchy="false" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E7.m1.2.2.2.2.1.1.1.3" xref="S2.E7.m1.2.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E7.m1.2.2.2.2.2" xref="S2.E7.m1.2.2.2.2.2.cmml">⁢</mo><msub id="S2.E7.m1.2.2.2.2.3" xref="S2.E7.m1.2.2.2.2.3.cmml"><mi id="S2.E7.m1.2.2.2.2.3.2" xref="S2.E7.m1.2.2.2.2.3.2.cmml">y</mi><mi id="S2.E7.m1.2.2.2.2.3.3" xref="S2.E7.m1.2.2.2.2.3.3.cmml">s</mi></msub></mrow></mrow><mrow id="S2.E7.m1.4.4.4" xref="S2.E7.m1.4.4.4.cmml"><msubsup id="S2.E7.m1.4.4.4.3" xref="S2.E7.m1.4.4.4.3.cmml"><mo id="S2.E7.m1.4.4.4.3.2.2" xref="S2.E7.m1.4.4.4.3.2.2.cmml">∑</mo><mrow id="S2.E7.m1.4.4.4.3.2.3" xref="S2.E7.m1.4.4.4.3.2.3.cmml"><mi id="S2.E7.m1.4.4.4.3.2.3.2" xref="S2.E7.m1.4.4.4.3.2.3.2.cmml">s</mi><mo id="S2.E7.m1.4.4.4.3.2.3.1" xref="S2.E7.m1.4.4.4.3.2.3.1.cmml">=</mo><mn id="S2.E7.m1.4.4.4.3.2.3.3" xref="S2.E7.m1.4.4.4.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E7.m1.4.4.4.3.3" xref="S2.E7.m1.4.4.4.3.3.cmml">t</mi></msubsup><mrow id="S2.E7.m1.4.4.4.2.1" xref="S2.E7.m1.4.4.4.2.2.cmml"><mi id="S2.E7.m1.3.3.3.1" xref="S2.E7.m1.3.3.3.1.cmml">exp</mi><mo id="S2.E7.m1.4.4.4.2.1a" xref="S2.E7.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S2.E7.m1.4.4.4.2.1.1" xref="S2.E7.m1.4.4.4.2.2.cmml"><mo id="S2.E7.m1.4.4.4.2.1.1.2" xref="S2.E7.m1.4.4.4.2.2.cmml">(</mo><mrow id="S2.E7.m1.4.4.4.2.1.1.1" xref="S2.E7.m1.4.4.4.2.1.1.1.cmml"><msup id="S2.E7.m1.4.4.4.2.1.1.1.1" xref="S2.E7.m1.4.4.4.2.1.1.1.1.cmml"><mrow id="S2.E7.m1.4.4.4.2.1.1.1.1.1.1" xref="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.cmml"><mo id="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.2" stretchy="false" xref="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1" xref="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.cmml"><msub id="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.2" xref="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.2.2" xref="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mi id="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.2.3" xref="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.2.3.cmml">K</mi></msub><mo id="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1" xref="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.3" xref="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.3" stretchy="false" xref="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S2.E7.m1.4.4.4.2.1.1.1.1.3" xref="S2.E7.m1.4.4.4.2.1.1.1.1.3.cmml">T</mi></msup><mo id="S2.E7.m1.4.4.4.2.1.1.1.3" xref="S2.E7.m1.4.4.4.2.1.1.1.3.cmml">⁢</mo><mrow id="S2.E7.m1.4.4.4.2.1.1.1.2.1" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.cmml"><mo id="S2.E7.m1.4.4.4.2.1.1.1.2.1.2" stretchy="false" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.cmml">(</mo><mrow id="S2.E7.m1.4.4.4.2.1.1.1.2.1.1" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.cmml"><msub id="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.2" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.2.cmml"><mi id="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.2.2" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.2.2.cmml">θ</mi><mi id="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.2.3" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.2.3.cmml">Q</mi></msub><mo id="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.1" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.1.cmml">⁢</mo><msub id="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.3" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.3.cmml"><mi id="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.3.2" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.3.2.cmml">x</mi><mi id="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.3.3" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.3.3.cmml">s</mi></msub></mrow><mo id="S2.E7.m1.4.4.4.2.1.1.1.2.1.3" stretchy="false" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E7.m1.4.4.4.2.1.1.3" xref="S2.E7.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S2.E7.m1.7.7.1.2" lspace="0em" xref="S2.E7.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.7b"><apply id="S2.E7.m1.7.7.1.1.cmml" xref="S2.E7.m1.7.7.1"><eq id="S2.E7.m1.7.7.1.1.3.cmml" xref="S2.E7.m1.7.7.1.1.3"></eq><apply id="S2.E7.m1.7.7.1.1.2.cmml" xref="S2.E7.m1.7.7.1.1.2"><times id="S2.E7.m1.7.7.1.1.2.3.cmml" xref="S2.E7.m1.7.7.1.1.2.3"></times><ci id="S2.E7.m1.7.7.1.1.2.4.cmml" xref="S2.E7.m1.7.7.1.1.2.4">𝑓</ci><list id="S2.E7.m1.7.7.1.1.2.2.3.cmml" xref="S2.E7.m1.7.7.1.1.2.2.2"><ci id="S2.E7.m1.5.5.cmml" xref="S2.E7.m1.5.5">𝑥</ci><apply id="S2.E7.m1.7.7.1.1.1.1.1.1.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E7.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.2">𝑥</ci><cn id="S2.E7.m1.7.7.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E7.m1.7.7.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.E7.m1.6.6.cmml" xref="S2.E7.m1.6.6">…</ci><apply id="S2.E7.m1.7.7.1.1.2.2.2.2.cmml" xref="S2.E7.m1.7.7.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E7.m1.7.7.1.1.2.2.2.2.1.cmml" xref="S2.E7.m1.7.7.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E7.m1.7.7.1.1.2.2.2.2.2.cmml" xref="S2.E7.m1.7.7.1.1.2.2.2.2.2">𝑥</ci><ci id="S2.E7.m1.7.7.1.1.2.2.2.2.3.cmml" xref="S2.E7.m1.7.7.1.1.2.2.2.2.3">𝑡</ci></apply></list></apply><apply id="S2.E7.m1.4.4.cmml" xref="S2.E7.m1.4.4"><divide id="S2.E7.m1.4.4.5.cmml" xref="S2.E7.m1.4.4"></divide><apply id="S2.E7.m1.2.2.2.cmml" xref="S2.E7.m1.2.2.2"><apply id="S2.E7.m1.2.2.2.3.cmml" xref="S2.E7.m1.2.2.2.3"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.2.3.1.cmml" xref="S2.E7.m1.2.2.2.3">superscript</csymbol><apply id="S2.E7.m1.2.2.2.3.2.cmml" xref="S2.E7.m1.2.2.2.3"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.2.3.2.1.cmml" xref="S2.E7.m1.2.2.2.3">subscript</csymbol><sum id="S2.E7.m1.2.2.2.3.2.2.cmml" xref="S2.E7.m1.2.2.2.3.2.2"></sum><apply id="S2.E7.m1.2.2.2.3.2.3.cmml" xref="S2.E7.m1.2.2.2.3.2.3"><eq id="S2.E7.m1.2.2.2.3.2.3.1.cmml" xref="S2.E7.m1.2.2.2.3.2.3.1"></eq><ci id="S2.E7.m1.2.2.2.3.2.3.2.cmml" xref="S2.E7.m1.2.2.2.3.2.3.2">𝑠</ci><cn id="S2.E7.m1.2.2.2.3.2.3.3.cmml" type="integer" xref="S2.E7.m1.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S2.E7.m1.2.2.2.3.3.cmml" xref="S2.E7.m1.2.2.2.3.3">𝑡</ci></apply><apply id="S2.E7.m1.2.2.2.2.cmml" xref="S2.E7.m1.2.2.2.2"><times id="S2.E7.m1.2.2.2.2.2.cmml" xref="S2.E7.m1.2.2.2.2.2"></times><apply id="S2.E7.m1.2.2.2.2.1.2.cmml" xref="S2.E7.m1.2.2.2.2.1.1"><exp id="S2.E7.m1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1"></exp><apply id="S2.E7.m1.2.2.2.2.1.1.1.1.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1"><times id="S2.E7.m1.2.2.2.2.1.1.1.1.3.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.3"></times><apply id="S2.E7.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1">superscript</csymbol><apply id="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1"><times id="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.1"></times><apply id="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2">𝜃</ci><ci id="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3">𝐾</ci></apply><ci id="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.3">𝑥</ci></apply><ci id="S2.E7.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.1.3">𝑇</ci></apply><apply id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1"><times id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.1.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.1"></times><apply id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.2.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.2.1.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.2">subscript</csymbol><ci id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.2.2.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.2.2">𝜃</ci><ci id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.2.3.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.2.3">𝑄</ci></apply><apply id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.3.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.3.1.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.3">subscript</csymbol><ci id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.3.2.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.3.2">𝑥</ci><ci id="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.3.3.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1.2.1.1.3.3">𝑠</ci></apply></apply></apply></apply><apply id="S2.E7.m1.2.2.2.2.3.cmml" xref="S2.E7.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.2.2.3.1.cmml" xref="S2.E7.m1.2.2.2.2.3">subscript</csymbol><ci id="S2.E7.m1.2.2.2.2.3.2.cmml" xref="S2.E7.m1.2.2.2.2.3.2">𝑦</ci><ci id="S2.E7.m1.2.2.2.2.3.3.cmml" xref="S2.E7.m1.2.2.2.2.3.3">𝑠</ci></apply></apply></apply><apply id="S2.E7.m1.4.4.4.cmml" xref="S2.E7.m1.4.4.4"><apply id="S2.E7.m1.4.4.4.3.cmml" xref="S2.E7.m1.4.4.4.3"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.4.3.1.cmml" xref="S2.E7.m1.4.4.4.3">superscript</csymbol><apply id="S2.E7.m1.4.4.4.3.2.cmml" xref="S2.E7.m1.4.4.4.3"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.4.3.2.1.cmml" xref="S2.E7.m1.4.4.4.3">subscript</csymbol><sum id="S2.E7.m1.4.4.4.3.2.2.cmml" xref="S2.E7.m1.4.4.4.3.2.2"></sum><apply id="S2.E7.m1.4.4.4.3.2.3.cmml" xref="S2.E7.m1.4.4.4.3.2.3"><eq id="S2.E7.m1.4.4.4.3.2.3.1.cmml" xref="S2.E7.m1.4.4.4.3.2.3.1"></eq><ci id="S2.E7.m1.4.4.4.3.2.3.2.cmml" xref="S2.E7.m1.4.4.4.3.2.3.2">𝑠</ci><cn id="S2.E7.m1.4.4.4.3.2.3.3.cmml" type="integer" xref="S2.E7.m1.4.4.4.3.2.3.3">1</cn></apply></apply><ci id="S2.E7.m1.4.4.4.3.3.cmml" xref="S2.E7.m1.4.4.4.3.3">𝑡</ci></apply><apply id="S2.E7.m1.4.4.4.2.2.cmml" xref="S2.E7.m1.4.4.4.2.1"><exp id="S2.E7.m1.3.3.3.1.cmml" xref="S2.E7.m1.3.3.3.1"></exp><apply id="S2.E7.m1.4.4.4.2.1.1.1.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1"><times id="S2.E7.m1.4.4.4.2.1.1.1.3.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.3"></times><apply id="S2.E7.m1.4.4.4.2.1.1.1.1.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.4.2.1.1.1.1.2.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.1">superscript</csymbol><apply id="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.1.1.1"><times id="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1"></times><apply id="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.2.2">𝜃</ci><ci id="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.2.3">𝐾</ci></apply><ci id="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.1.1.1.1.3">𝑥</ci></apply><ci id="S2.E7.m1.4.4.4.2.1.1.1.1.3.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.1.3">𝑇</ci></apply><apply id="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1"><times id="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.1.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.1"></times><apply id="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.2.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.2.1.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.2">subscript</csymbol><ci id="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.2.2.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.2.2">𝜃</ci><ci id="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.2.3.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.2.3">𝑄</ci></apply><apply id="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.3.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.3.1.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.3">subscript</csymbol><ci id="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.3.2.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.3.2">𝑥</ci><ci id="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.3.3.cmml" xref="S2.E7.m1.4.4.4.2.1.1.1.2.1.1.3.3">𝑠</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.7c">f(x;x_{1},\ldots,x_{t})=\frac{\sum_{s=1}^{t}\exp\left((\theta_{K}x)^{T}(\theta%
_{Q}x_{s})\right)y_{s}}{\sum_{s=1}^{t}\exp\left((\theta_{K}x)^{T}(\theta_{Q}x_%
{s})\right)}.</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m1.7d">italic_f ( italic_x ; italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = divide start_ARG ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT roman_exp ( ( italic_θ start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT italic_x ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ( italic_θ start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) ) italic_y start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT roman_exp ( ( italic_θ start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT italic_x ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ( italic_θ start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p7">
<p class="ltx_p" id="S2.SS1.p7.1">Since <math alttext="\text{softmax}(x)=\frac{\exp(x)}{\sum\exp(x)}" class="ltx_Math" display="inline" id="S2.SS1.p7.1.m1.5"><semantics id="S2.SS1.p7.1.m1.5a"><mrow id="S2.SS1.p7.1.m1.5.6" xref="S2.SS1.p7.1.m1.5.6.cmml"><mrow id="S2.SS1.p7.1.m1.5.6.2" xref="S2.SS1.p7.1.m1.5.6.2.cmml"><mtext id="S2.SS1.p7.1.m1.5.6.2.2" xref="S2.SS1.p7.1.m1.5.6.2.2a.cmml">softmax</mtext><mo id="S2.SS1.p7.1.m1.5.6.2.1" xref="S2.SS1.p7.1.m1.5.6.2.1.cmml">⁢</mo><mrow id="S2.SS1.p7.1.m1.5.6.2.3.2" xref="S2.SS1.p7.1.m1.5.6.2.cmml"><mo id="S2.SS1.p7.1.m1.5.6.2.3.2.1" stretchy="false" xref="S2.SS1.p7.1.m1.5.6.2.cmml">(</mo><mi id="S2.SS1.p7.1.m1.5.5" xref="S2.SS1.p7.1.m1.5.5.cmml">x</mi><mo id="S2.SS1.p7.1.m1.5.6.2.3.2.2" stretchy="false" xref="S2.SS1.p7.1.m1.5.6.2.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p7.1.m1.5.6.1" xref="S2.SS1.p7.1.m1.5.6.1.cmml">=</mo><mfrac id="S2.SS1.p7.1.m1.4.4" xref="S2.SS1.p7.1.m1.4.4.cmml"><mrow id="S2.SS1.p7.1.m1.2.2.2.4" xref="S2.SS1.p7.1.m1.2.2.2.3.cmml"><mi id="S2.SS1.p7.1.m1.1.1.1.1" xref="S2.SS1.p7.1.m1.1.1.1.1.cmml">exp</mi><mo id="S2.SS1.p7.1.m1.2.2.2.4a" xref="S2.SS1.p7.1.m1.2.2.2.3.cmml">⁡</mo><mrow id="S2.SS1.p7.1.m1.2.2.2.4.1" xref="S2.SS1.p7.1.m1.2.2.2.3.cmml"><mo id="S2.SS1.p7.1.m1.2.2.2.4.1.1" stretchy="false" xref="S2.SS1.p7.1.m1.2.2.2.3.cmml">(</mo><mi id="S2.SS1.p7.1.m1.2.2.2.2" xref="S2.SS1.p7.1.m1.2.2.2.2.cmml">x</mi><mo id="S2.SS1.p7.1.m1.2.2.2.4.1.2" stretchy="false" xref="S2.SS1.p7.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mstyle id="S2.SS1.p7.1.m1.4.4.4" scriptlevel="-1" xref="S2.SS1.p7.1.m1.4.4.4.cmml"><mrow id="S2.SS1.p7.1.m1.4.4.4a" xref="S2.SS1.p7.1.m1.4.4.4.cmml"><mo id="S2.SS1.p7.1.m1.4.4.4.3" xref="S2.SS1.p7.1.m1.4.4.4.3.cmml">∑</mo><mrow id="S2.SS1.p7.1.m1.4.4.4.4.2" xref="S2.SS1.p7.1.m1.4.4.4.4.1.cmml"><mi id="S2.SS1.p7.1.m1.3.3.3.1" xref="S2.SS1.p7.1.m1.3.3.3.1.cmml">exp</mi><mo id="S2.SS1.p7.1.m1.4.4.4.4.2a" xref="S2.SS1.p7.1.m1.4.4.4.4.1.cmml">⁡</mo><mrow id="S2.SS1.p7.1.m1.4.4.4.4.2.1" xref="S2.SS1.p7.1.m1.4.4.4.4.1.cmml"><mo id="S2.SS1.p7.1.m1.4.4.4.4.2.1.1" stretchy="false" xref="S2.SS1.p7.1.m1.4.4.4.4.1.cmml">(</mo><mi id="S2.SS1.p7.1.m1.4.4.4.2" xref="S2.SS1.p7.1.m1.4.4.4.2.cmml">x</mi><mo id="S2.SS1.p7.1.m1.4.4.4.4.2.1.2" stretchy="false" xref="S2.SS1.p7.1.m1.4.4.4.4.1.cmml">)</mo></mrow></mrow></mrow></mstyle></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p7.1.m1.5b"><apply id="S2.SS1.p7.1.m1.5.6.cmml" xref="S2.SS1.p7.1.m1.5.6"><eq id="S2.SS1.p7.1.m1.5.6.1.cmml" xref="S2.SS1.p7.1.m1.5.6.1"></eq><apply id="S2.SS1.p7.1.m1.5.6.2.cmml" xref="S2.SS1.p7.1.m1.5.6.2"><times id="S2.SS1.p7.1.m1.5.6.2.1.cmml" xref="S2.SS1.p7.1.m1.5.6.2.1"></times><ci id="S2.SS1.p7.1.m1.5.6.2.2a.cmml" xref="S2.SS1.p7.1.m1.5.6.2.2"><mtext id="S2.SS1.p7.1.m1.5.6.2.2.cmml" xref="S2.SS1.p7.1.m1.5.6.2.2">softmax</mtext></ci><ci id="S2.SS1.p7.1.m1.5.5.cmml" xref="S2.SS1.p7.1.m1.5.5">𝑥</ci></apply><apply id="S2.SS1.p7.1.m1.4.4.cmml" xref="S2.SS1.p7.1.m1.4.4"><divide id="S2.SS1.p7.1.m1.4.4.5.cmml" xref="S2.SS1.p7.1.m1.4.4"></divide><apply id="S2.SS1.p7.1.m1.2.2.2.3.cmml" xref="S2.SS1.p7.1.m1.2.2.2.4"><exp id="S2.SS1.p7.1.m1.1.1.1.1.cmml" xref="S2.SS1.p7.1.m1.1.1.1.1"></exp><ci id="S2.SS1.p7.1.m1.2.2.2.2.cmml" xref="S2.SS1.p7.1.m1.2.2.2.2">𝑥</ci></apply><apply id="S2.SS1.p7.1.m1.4.4.4.cmml" xref="S2.SS1.p7.1.m1.4.4.4"><sum id="S2.SS1.p7.1.m1.4.4.4.3.cmml" xref="S2.SS1.p7.1.m1.4.4.4.3"></sum><apply id="S2.SS1.p7.1.m1.4.4.4.4.1.cmml" xref="S2.SS1.p7.1.m1.4.4.4.4.2"><exp id="S2.SS1.p7.1.m1.3.3.3.1.cmml" xref="S2.SS1.p7.1.m1.3.3.3.1"></exp><ci id="S2.SS1.p7.1.m1.4.4.4.2.cmml" xref="S2.SS1.p7.1.m1.4.4.4.2">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p7.1.m1.5c">\text{softmax}(x)=\frac{\exp(x)}{\sum\exp(x)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p7.1.m1.5d">softmax ( italic_x ) = divide start_ARG roman_exp ( italic_x ) end_ARG start_ARG ∑ roman_exp ( italic_x ) end_ARG</annotation></semantics></math>, it can be observed that this is equivalent to the self-attention output:</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p8">
<table class="ltx_equation ltx_eqn_table" id="S2.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="z_{t}=\sum_{s=1}^{t}\text{softmax}\left(\frac{(\theta_{K}x_{s})^{T}(\theta_{Q}%
x_{t})}{\sqrt{d_{k}}}\right)y_{s}." class="ltx_Math" display="block" id="S2.E8.m1.3"><semantics id="S2.E8.m1.3a"><mrow id="S2.E8.m1.3.3.1" xref="S2.E8.m1.3.3.1.1.cmml"><mrow id="S2.E8.m1.3.3.1.1" xref="S2.E8.m1.3.3.1.1.cmml"><msub id="S2.E8.m1.3.3.1.1.2" xref="S2.E8.m1.3.3.1.1.2.cmml"><mi id="S2.E8.m1.3.3.1.1.2.2" xref="S2.E8.m1.3.3.1.1.2.2.cmml">z</mi><mi id="S2.E8.m1.3.3.1.1.2.3" xref="S2.E8.m1.3.3.1.1.2.3.cmml">t</mi></msub><mo id="S2.E8.m1.3.3.1.1.1" rspace="0.111em" xref="S2.E8.m1.3.3.1.1.1.cmml">=</mo><mrow id="S2.E8.m1.3.3.1.1.3" xref="S2.E8.m1.3.3.1.1.3.cmml"><munderover id="S2.E8.m1.3.3.1.1.3.1" xref="S2.E8.m1.3.3.1.1.3.1.cmml"><mo id="S2.E8.m1.3.3.1.1.3.1.2.2" movablelimits="false" xref="S2.E8.m1.3.3.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E8.m1.3.3.1.1.3.1.2.3" xref="S2.E8.m1.3.3.1.1.3.1.2.3.cmml"><mi id="S2.E8.m1.3.3.1.1.3.1.2.3.2" xref="S2.E8.m1.3.3.1.1.3.1.2.3.2.cmml">s</mi><mo id="S2.E8.m1.3.3.1.1.3.1.2.3.1" xref="S2.E8.m1.3.3.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.E8.m1.3.3.1.1.3.1.2.3.3" xref="S2.E8.m1.3.3.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E8.m1.3.3.1.1.3.1.3" xref="S2.E8.m1.3.3.1.1.3.1.3.cmml">t</mi></munderover><mrow id="S2.E8.m1.3.3.1.1.3.2" xref="S2.E8.m1.3.3.1.1.3.2.cmml"><mtext id="S2.E8.m1.3.3.1.1.3.2.2" xref="S2.E8.m1.3.3.1.1.3.2.2a.cmml">softmax</mtext><mo id="S2.E8.m1.3.3.1.1.3.2.1" xref="S2.E8.m1.3.3.1.1.3.2.1.cmml">⁢</mo><mrow id="S2.E8.m1.3.3.1.1.3.2.3.2" xref="S2.E8.m1.2.2.cmml"><mo id="S2.E8.m1.3.3.1.1.3.2.3.2.1" xref="S2.E8.m1.2.2.cmml">(</mo><mfrac id="S2.E8.m1.2.2" xref="S2.E8.m1.2.2.cmml"><mrow id="S2.E8.m1.2.2.2" xref="S2.E8.m1.2.2.2.cmml"><msup id="S2.E8.m1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.cmml"><mrow id="S2.E8.m1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.1.cmml"><mo id="S2.E8.m1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E8.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E8.m1.1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.1.cmml"><msub id="S2.E8.m1.1.1.1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E8.m1.1.1.1.1.1.1.1.2.2" xref="S2.E8.m1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mi id="S2.E8.m1.1.1.1.1.1.1.1.2.3" xref="S2.E8.m1.1.1.1.1.1.1.1.2.3.cmml">K</mi></msub><mo id="S2.E8.m1.1.1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S2.E8.m1.1.1.1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E8.m1.1.1.1.1.1.1.1.3.2" xref="S2.E8.m1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mi id="S2.E8.m1.1.1.1.1.1.1.1.3.3" xref="S2.E8.m1.1.1.1.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo id="S2.E8.m1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E8.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S2.E8.m1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.3.cmml">T</mi></msup><mo id="S2.E8.m1.2.2.2.3" xref="S2.E8.m1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E8.m1.2.2.2.2.1" xref="S2.E8.m1.2.2.2.2.1.1.cmml"><mo id="S2.E8.m1.2.2.2.2.1.2" stretchy="false" xref="S2.E8.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S2.E8.m1.2.2.2.2.1.1" xref="S2.E8.m1.2.2.2.2.1.1.cmml"><msub id="S2.E8.m1.2.2.2.2.1.1.2" xref="S2.E8.m1.2.2.2.2.1.1.2.cmml"><mi id="S2.E8.m1.2.2.2.2.1.1.2.2" xref="S2.E8.m1.2.2.2.2.1.1.2.2.cmml">θ</mi><mi id="S2.E8.m1.2.2.2.2.1.1.2.3" xref="S2.E8.m1.2.2.2.2.1.1.2.3.cmml">Q</mi></msub><mo id="S2.E8.m1.2.2.2.2.1.1.1" xref="S2.E8.m1.2.2.2.2.1.1.1.cmml">⁢</mo><msub id="S2.E8.m1.2.2.2.2.1.1.3" xref="S2.E8.m1.2.2.2.2.1.1.3.cmml"><mi id="S2.E8.m1.2.2.2.2.1.1.3.2" xref="S2.E8.m1.2.2.2.2.1.1.3.2.cmml">x</mi><mi id="S2.E8.m1.2.2.2.2.1.1.3.3" xref="S2.E8.m1.2.2.2.2.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.E8.m1.2.2.2.2.1.3" stretchy="false" xref="S2.E8.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><msqrt id="S2.E8.m1.2.2.4" xref="S2.E8.m1.2.2.4.cmml"><msub id="S2.E8.m1.2.2.4.2" xref="S2.E8.m1.2.2.4.2.cmml"><mi id="S2.E8.m1.2.2.4.2.2" xref="S2.E8.m1.2.2.4.2.2.cmml">d</mi><mi id="S2.E8.m1.2.2.4.2.3" xref="S2.E8.m1.2.2.4.2.3.cmml">k</mi></msub></msqrt></mfrac><mo id="S2.E8.m1.3.3.1.1.3.2.3.2.2" xref="S2.E8.m1.2.2.cmml">)</mo></mrow><mo id="S2.E8.m1.3.3.1.1.3.2.1a" xref="S2.E8.m1.3.3.1.1.3.2.1.cmml">⁢</mo><msub id="S2.E8.m1.3.3.1.1.3.2.4" xref="S2.E8.m1.3.3.1.1.3.2.4.cmml"><mi id="S2.E8.m1.3.3.1.1.3.2.4.2" xref="S2.E8.m1.3.3.1.1.3.2.4.2.cmml">y</mi><mi id="S2.E8.m1.3.3.1.1.3.2.4.3" xref="S2.E8.m1.3.3.1.1.3.2.4.3.cmml">s</mi></msub></mrow></mrow></mrow><mo id="S2.E8.m1.3.3.1.2" lspace="0em" xref="S2.E8.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.3b"><apply id="S2.E8.m1.3.3.1.1.cmml" xref="S2.E8.m1.3.3.1"><eq id="S2.E8.m1.3.3.1.1.1.cmml" xref="S2.E8.m1.3.3.1.1.1"></eq><apply id="S2.E8.m1.3.3.1.1.2.cmml" xref="S2.E8.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.2.1.cmml" xref="S2.E8.m1.3.3.1.1.2">subscript</csymbol><ci id="S2.E8.m1.3.3.1.1.2.2.cmml" xref="S2.E8.m1.3.3.1.1.2.2">𝑧</ci><ci id="S2.E8.m1.3.3.1.1.2.3.cmml" xref="S2.E8.m1.3.3.1.1.2.3">𝑡</ci></apply><apply id="S2.E8.m1.3.3.1.1.3.cmml" xref="S2.E8.m1.3.3.1.1.3"><apply id="S2.E8.m1.3.3.1.1.3.1.cmml" xref="S2.E8.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.3.1.1.cmml" xref="S2.E8.m1.3.3.1.1.3.1">superscript</csymbol><apply id="S2.E8.m1.3.3.1.1.3.1.2.cmml" xref="S2.E8.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.3.1.2.1.cmml" xref="S2.E8.m1.3.3.1.1.3.1">subscript</csymbol><sum id="S2.E8.m1.3.3.1.1.3.1.2.2.cmml" xref="S2.E8.m1.3.3.1.1.3.1.2.2"></sum><apply id="S2.E8.m1.3.3.1.1.3.1.2.3.cmml" xref="S2.E8.m1.3.3.1.1.3.1.2.3"><eq id="S2.E8.m1.3.3.1.1.3.1.2.3.1.cmml" xref="S2.E8.m1.3.3.1.1.3.1.2.3.1"></eq><ci id="S2.E8.m1.3.3.1.1.3.1.2.3.2.cmml" xref="S2.E8.m1.3.3.1.1.3.1.2.3.2">𝑠</ci><cn id="S2.E8.m1.3.3.1.1.3.1.2.3.3.cmml" type="integer" xref="S2.E8.m1.3.3.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E8.m1.3.3.1.1.3.1.3.cmml" xref="S2.E8.m1.3.3.1.1.3.1.3">𝑡</ci></apply><apply id="S2.E8.m1.3.3.1.1.3.2.cmml" xref="S2.E8.m1.3.3.1.1.3.2"><times id="S2.E8.m1.3.3.1.1.3.2.1.cmml" xref="S2.E8.m1.3.3.1.1.3.2.1"></times><ci id="S2.E8.m1.3.3.1.1.3.2.2a.cmml" xref="S2.E8.m1.3.3.1.1.3.2.2"><mtext id="S2.E8.m1.3.3.1.1.3.2.2.cmml" xref="S2.E8.m1.3.3.1.1.3.2.2">softmax</mtext></ci><apply id="S2.E8.m1.2.2.cmml" xref="S2.E8.m1.3.3.1.1.3.2.3.2"><divide id="S2.E8.m1.2.2.3.cmml" xref="S2.E8.m1.3.3.1.1.3.2.3.2"></divide><apply id="S2.E8.m1.2.2.2.cmml" xref="S2.E8.m1.2.2.2"><times id="S2.E8.m1.2.2.2.3.cmml" xref="S2.E8.m1.2.2.2.3"></times><apply id="S2.E8.m1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1">superscript</csymbol><apply id="S2.E8.m1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1"><times id="S2.E8.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1"></times><apply id="S2.E8.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E8.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.2.2">𝜃</ci><ci id="S2.E8.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.2.3">𝐾</ci></apply><apply id="S2.E8.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E8.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.3.2">𝑥</ci><ci id="S2.E8.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><ci id="S2.E8.m1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.3">𝑇</ci></apply><apply id="S2.E8.m1.2.2.2.2.1.1.cmml" xref="S2.E8.m1.2.2.2.2.1"><times id="S2.E8.m1.2.2.2.2.1.1.1.cmml" xref="S2.E8.m1.2.2.2.2.1.1.1"></times><apply id="S2.E8.m1.2.2.2.2.1.1.2.cmml" xref="S2.E8.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.2.2.1.1.2.1.cmml" xref="S2.E8.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S2.E8.m1.2.2.2.2.1.1.2.2.cmml" xref="S2.E8.m1.2.2.2.2.1.1.2.2">𝜃</ci><ci id="S2.E8.m1.2.2.2.2.1.1.2.3.cmml" xref="S2.E8.m1.2.2.2.2.1.1.2.3">𝑄</ci></apply><apply id="S2.E8.m1.2.2.2.2.1.1.3.cmml" xref="S2.E8.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.2.2.1.1.3.1.cmml" xref="S2.E8.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S2.E8.m1.2.2.2.2.1.1.3.2.cmml" xref="S2.E8.m1.2.2.2.2.1.1.3.2">𝑥</ci><ci id="S2.E8.m1.2.2.2.2.1.1.3.3.cmml" xref="S2.E8.m1.2.2.2.2.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S2.E8.m1.2.2.4.cmml" xref="S2.E8.m1.2.2.4"><root id="S2.E8.m1.2.2.4a.cmml" xref="S2.E8.m1.2.2.4"></root><apply id="S2.E8.m1.2.2.4.2.cmml" xref="S2.E8.m1.2.2.4.2"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.4.2.1.cmml" xref="S2.E8.m1.2.2.4.2">subscript</csymbol><ci id="S2.E8.m1.2.2.4.2.2.cmml" xref="S2.E8.m1.2.2.4.2.2">𝑑</ci><ci id="S2.E8.m1.2.2.4.2.3.cmml" xref="S2.E8.m1.2.2.4.2.3">𝑘</ci></apply></apply></apply><apply id="S2.E8.m1.3.3.1.1.3.2.4.cmml" xref="S2.E8.m1.3.3.1.1.3.2.4"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.3.2.4.1.cmml" xref="S2.E8.m1.3.3.1.1.3.2.4">subscript</csymbol><ci id="S2.E8.m1.3.3.1.1.3.2.4.2.cmml" xref="S2.E8.m1.3.3.1.1.3.2.4.2">𝑦</ci><ci id="S2.E8.m1.3.3.1.1.3.2.4.3.cmml" xref="S2.E8.m1.3.3.1.1.3.2.4.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.3c">z_{t}=\sum_{s=1}^{t}\text{softmax}\left(\frac{(\theta_{K}x_{s})^{T}(\theta_{Q}%
x_{t})}{\sqrt{d_{k}}}\right)y_{s}.</annotation><annotation encoding="application/x-llamapun" id="S2.E8.m1.3d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT softmax ( divide start_ARG ( italic_θ start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ( italic_θ start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG end_ARG ) italic_y start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p9">
<p class="ltx_p" id="S2.SS1.p9.1">These equivalence demonstrates that the TTT layer can be considered a generalization of the self-attention mechanism, allowing it to not only match existing performance but also introduce new flexibility for handling non-parametric learning tasks, such as non-parametric models and mini-batch gradient descent in various learning methods.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Linear Complexity Implementation</h3>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.3">The TTT layer introduces a mini-batch gradient descent method. In standard online gradient descent, each time step’s hidden state is sequentially updated. To achieve parallelism, the TTT layer utilizes mini-batches to compute gradients and update hidden states simultaneously. Specifically, the input is divided into mini-batches of size <math alttext="K\times K" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mrow id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">K</mi><mo id="S2.SS2.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p1.1.m1.1.1.1.cmml">×</mo><mi id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><times id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1"></times><ci id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2">𝐾</ci><ci id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">K\times K</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_K × italic_K</annotation></semantics></math>, with a total of <math alttext="{\frac{H}{K}}\times{\frac{W}{K}}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><mrow id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml"><mfrac id="S2.SS2.p1.2.m2.1.1.2" xref="S2.SS2.p1.2.m2.1.1.2.cmml"><mi id="S2.SS2.p1.2.m2.1.1.2.2" xref="S2.SS2.p1.2.m2.1.1.2.2.cmml">H</mi><mi id="S2.SS2.p1.2.m2.1.1.2.3" xref="S2.SS2.p1.2.m2.1.1.2.3.cmml">K</mi></mfrac><mo id="S2.SS2.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p1.2.m2.1.1.1.cmml">×</mo><mfrac id="S2.SS2.p1.2.m2.1.1.3" xref="S2.SS2.p1.2.m2.1.1.3.cmml"><mi id="S2.SS2.p1.2.m2.1.1.3.2" xref="S2.SS2.p1.2.m2.1.1.3.2.cmml">W</mi><mi id="S2.SS2.p1.2.m2.1.1.3.3" xref="S2.SS2.p1.2.m2.1.1.3.3.cmml">K</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1"><times id="S2.SS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1.1"></times><apply id="S2.SS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2"><divide id="S2.SS2.p1.2.m2.1.1.2.1.cmml" xref="S2.SS2.p1.2.m2.1.1.2"></divide><ci id="S2.SS2.p1.2.m2.1.1.2.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2.2">𝐻</ci><ci id="S2.SS2.p1.2.m2.1.1.2.3.cmml" xref="S2.SS2.p1.2.m2.1.1.2.3">𝐾</ci></apply><apply id="S2.SS2.p1.2.m2.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.3"><divide id="S2.SS2.p1.2.m2.1.1.3.1.cmml" xref="S2.SS2.p1.2.m2.1.1.3"></divide><ci id="S2.SS2.p1.2.m2.1.1.3.2.cmml" xref="S2.SS2.p1.2.m2.1.1.3.2">𝑊</ci><ci id="S2.SS2.p1.2.m2.1.1.3.3.cmml" xref="S2.SS2.p1.2.m2.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">{\frac{H}{K}}\times{\frac{W}{K}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">divide start_ARG italic_H end_ARG start_ARG italic_K end_ARG × divide start_ARG italic_W end_ARG start_ARG italic_K end_ARG</annotation></semantics></math> mini-batches. The gradient calculation within each mini-batch can be parallelized, resulting in a computational complexity of <math alttext="O(K^{2})" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.1"><semantics id="S2.SS2.p1.3.m3.1a"><mrow id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml"><mi id="S2.SS2.p1.3.m3.1.1.3" xref="S2.SS2.p1.3.m3.1.1.3.cmml">O</mi><mo id="S2.SS2.p1.3.m3.1.1.2" xref="S2.SS2.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.3.m3.1.1.1.1" xref="S2.SS2.p1.3.m3.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.3.m3.1.1.1.1.1.cmml">(</mo><msup id="S2.SS2.p1.3.m3.1.1.1.1.1" xref="S2.SS2.p1.3.m3.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.3.m3.1.1.1.1.1.2" xref="S2.SS2.p1.3.m3.1.1.1.1.1.2.cmml">K</mi><mn id="S2.SS2.p1.3.m3.1.1.1.1.1.3" xref="S2.SS2.p1.3.m3.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S2.SS2.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><apply id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1"><times id="S2.SS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.2"></times><ci id="S2.SS2.p1.3.m3.1.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3">𝑂</ci><apply id="S2.SS2.p1.3.m3.1.1.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.2">𝐾</ci><cn id="S2.SS2.p1.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS2.p1.3.m3.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">O(K^{2})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.1d">italic_O ( italic_K start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> for a single mini-batch. Consequently, the overall complexity is:</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p2">
<table class="ltx_equation ltx_eqn_table" id="S2.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="O\left(\frac{H}{K}\times\frac{W}{K}\times K^{2}\right)=O(H\times W)=O(N)" class="ltx_Math" display="block" id="S2.E9.m1.3"><semantics id="S2.E9.m1.3a"><mrow id="S2.E9.m1.3.3" xref="S2.E9.m1.3.3.cmml"><mrow id="S2.E9.m1.2.2.1" xref="S2.E9.m1.2.2.1.cmml"><mi id="S2.E9.m1.2.2.1.3" xref="S2.E9.m1.2.2.1.3.cmml">O</mi><mo id="S2.E9.m1.2.2.1.2" xref="S2.E9.m1.2.2.1.2.cmml">⁢</mo><mrow id="S2.E9.m1.2.2.1.1.1" xref="S2.E9.m1.2.2.1.1.1.1.cmml"><mo id="S2.E9.m1.2.2.1.1.1.2" xref="S2.E9.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.E9.m1.2.2.1.1.1.1" xref="S2.E9.m1.2.2.1.1.1.1.cmml"><mfrac id="S2.E9.m1.2.2.1.1.1.1.2" xref="S2.E9.m1.2.2.1.1.1.1.2.cmml"><mi id="S2.E9.m1.2.2.1.1.1.1.2.2" xref="S2.E9.m1.2.2.1.1.1.1.2.2.cmml">H</mi><mi id="S2.E9.m1.2.2.1.1.1.1.2.3" xref="S2.E9.m1.2.2.1.1.1.1.2.3.cmml">K</mi></mfrac><mo id="S2.E9.m1.2.2.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.E9.m1.2.2.1.1.1.1.1.cmml">×</mo><mfrac id="S2.E9.m1.2.2.1.1.1.1.3" xref="S2.E9.m1.2.2.1.1.1.1.3.cmml"><mi id="S2.E9.m1.2.2.1.1.1.1.3.2" xref="S2.E9.m1.2.2.1.1.1.1.3.2.cmml">W</mi><mi id="S2.E9.m1.2.2.1.1.1.1.3.3" xref="S2.E9.m1.2.2.1.1.1.1.3.3.cmml">K</mi></mfrac><mo id="S2.E9.m1.2.2.1.1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S2.E9.m1.2.2.1.1.1.1.1.cmml">×</mo><msup id="S2.E9.m1.2.2.1.1.1.1.4" xref="S2.E9.m1.2.2.1.1.1.1.4.cmml"><mi id="S2.E9.m1.2.2.1.1.1.1.4.2" xref="S2.E9.m1.2.2.1.1.1.1.4.2.cmml">K</mi><mn id="S2.E9.m1.2.2.1.1.1.1.4.3" xref="S2.E9.m1.2.2.1.1.1.1.4.3.cmml">2</mn></msup></mrow><mo id="S2.E9.m1.2.2.1.1.1.3" xref="S2.E9.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E9.m1.3.3.4" xref="S2.E9.m1.3.3.4.cmml">=</mo><mrow id="S2.E9.m1.3.3.2" xref="S2.E9.m1.3.3.2.cmml"><mi id="S2.E9.m1.3.3.2.3" xref="S2.E9.m1.3.3.2.3.cmml">O</mi><mo id="S2.E9.m1.3.3.2.2" xref="S2.E9.m1.3.3.2.2.cmml">⁢</mo><mrow id="S2.E9.m1.3.3.2.1.1" xref="S2.E9.m1.3.3.2.1.1.1.cmml"><mo id="S2.E9.m1.3.3.2.1.1.2" stretchy="false" xref="S2.E9.m1.3.3.2.1.1.1.cmml">(</mo><mrow id="S2.E9.m1.3.3.2.1.1.1" xref="S2.E9.m1.3.3.2.1.1.1.cmml"><mi id="S2.E9.m1.3.3.2.1.1.1.2" xref="S2.E9.m1.3.3.2.1.1.1.2.cmml">H</mi><mo id="S2.E9.m1.3.3.2.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.E9.m1.3.3.2.1.1.1.1.cmml">×</mo><mi id="S2.E9.m1.3.3.2.1.1.1.3" xref="S2.E9.m1.3.3.2.1.1.1.3.cmml">W</mi></mrow><mo id="S2.E9.m1.3.3.2.1.1.3" stretchy="false" xref="S2.E9.m1.3.3.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E9.m1.3.3.5" xref="S2.E9.m1.3.3.5.cmml">=</mo><mrow id="S2.E9.m1.3.3.6" xref="S2.E9.m1.3.3.6.cmml"><mi id="S2.E9.m1.3.3.6.2" xref="S2.E9.m1.3.3.6.2.cmml">O</mi><mo id="S2.E9.m1.3.3.6.1" xref="S2.E9.m1.3.3.6.1.cmml">⁢</mo><mrow id="S2.E9.m1.3.3.6.3.2" xref="S2.E9.m1.3.3.6.cmml"><mo id="S2.E9.m1.3.3.6.3.2.1" stretchy="false" xref="S2.E9.m1.3.3.6.cmml">(</mo><mi id="S2.E9.m1.1.1" xref="S2.E9.m1.1.1.cmml">N</mi><mo id="S2.E9.m1.3.3.6.3.2.2" stretchy="false" xref="S2.E9.m1.3.3.6.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m1.3b"><apply id="S2.E9.m1.3.3.cmml" xref="S2.E9.m1.3.3"><and id="S2.E9.m1.3.3a.cmml" xref="S2.E9.m1.3.3"></and><apply id="S2.E9.m1.3.3b.cmml" xref="S2.E9.m1.3.3"><eq id="S2.E9.m1.3.3.4.cmml" xref="S2.E9.m1.3.3.4"></eq><apply id="S2.E9.m1.2.2.1.cmml" xref="S2.E9.m1.2.2.1"><times id="S2.E9.m1.2.2.1.2.cmml" xref="S2.E9.m1.2.2.1.2"></times><ci id="S2.E9.m1.2.2.1.3.cmml" xref="S2.E9.m1.2.2.1.3">𝑂</ci><apply id="S2.E9.m1.2.2.1.1.1.1.cmml" xref="S2.E9.m1.2.2.1.1.1"><times id="S2.E9.m1.2.2.1.1.1.1.1.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1"></times><apply id="S2.E9.m1.2.2.1.1.1.1.2.cmml" xref="S2.E9.m1.2.2.1.1.1.1.2"><divide id="S2.E9.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E9.m1.2.2.1.1.1.1.2"></divide><ci id="S2.E9.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.E9.m1.2.2.1.1.1.1.2.2">𝐻</ci><ci id="S2.E9.m1.2.2.1.1.1.1.2.3.cmml" xref="S2.E9.m1.2.2.1.1.1.1.2.3">𝐾</ci></apply><apply id="S2.E9.m1.2.2.1.1.1.1.3.cmml" xref="S2.E9.m1.2.2.1.1.1.1.3"><divide id="S2.E9.m1.2.2.1.1.1.1.3.1.cmml" xref="S2.E9.m1.2.2.1.1.1.1.3"></divide><ci id="S2.E9.m1.2.2.1.1.1.1.3.2.cmml" xref="S2.E9.m1.2.2.1.1.1.1.3.2">𝑊</ci><ci id="S2.E9.m1.2.2.1.1.1.1.3.3.cmml" xref="S2.E9.m1.2.2.1.1.1.1.3.3">𝐾</ci></apply><apply id="S2.E9.m1.2.2.1.1.1.1.4.cmml" xref="S2.E9.m1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.1.1.1.1.4.1.cmml" xref="S2.E9.m1.2.2.1.1.1.1.4">superscript</csymbol><ci id="S2.E9.m1.2.2.1.1.1.1.4.2.cmml" xref="S2.E9.m1.2.2.1.1.1.1.4.2">𝐾</ci><cn id="S2.E9.m1.2.2.1.1.1.1.4.3.cmml" type="integer" xref="S2.E9.m1.2.2.1.1.1.1.4.3">2</cn></apply></apply></apply><apply id="S2.E9.m1.3.3.2.cmml" xref="S2.E9.m1.3.3.2"><times id="S2.E9.m1.3.3.2.2.cmml" xref="S2.E9.m1.3.3.2.2"></times><ci id="S2.E9.m1.3.3.2.3.cmml" xref="S2.E9.m1.3.3.2.3">𝑂</ci><apply id="S2.E9.m1.3.3.2.1.1.1.cmml" xref="S2.E9.m1.3.3.2.1.1"><times id="S2.E9.m1.3.3.2.1.1.1.1.cmml" xref="S2.E9.m1.3.3.2.1.1.1.1"></times><ci id="S2.E9.m1.3.3.2.1.1.1.2.cmml" xref="S2.E9.m1.3.3.2.1.1.1.2">𝐻</ci><ci id="S2.E9.m1.3.3.2.1.1.1.3.cmml" xref="S2.E9.m1.3.3.2.1.1.1.3">𝑊</ci></apply></apply></apply><apply id="S2.E9.m1.3.3c.cmml" xref="S2.E9.m1.3.3"><eq id="S2.E9.m1.3.3.5.cmml" xref="S2.E9.m1.3.3.5"></eq><share href="https://arxiv.org/html/2410.02523v1#S2.E9.m1.3.3.2.cmml" id="S2.E9.m1.3.3d.cmml" xref="S2.E9.m1.3.3"></share><apply id="S2.E9.m1.3.3.6.cmml" xref="S2.E9.m1.3.3.6"><times id="S2.E9.m1.3.3.6.1.cmml" xref="S2.E9.m1.3.3.6.1"></times><ci id="S2.E9.m1.3.3.6.2.cmml" xref="S2.E9.m1.3.3.6.2">𝑂</ci><ci id="S2.E9.m1.1.1.cmml" xref="S2.E9.m1.1.1">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m1.3c">O\left(\frac{H}{K}\times\frac{W}{K}\times K^{2}\right)=O(H\times W)=O(N)</annotation><annotation encoding="application/x-llamapun" id="S2.E9.m1.3d">italic_O ( divide start_ARG italic_H end_ARG start_ARG italic_K end_ARG × divide start_ARG italic_W end_ARG start_ARG italic_K end_ARG × italic_K start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) = italic_O ( italic_H × italic_W ) = italic_O ( italic_N )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">where <math alttext="N" class="ltx_Math" display="inline" id="S2.SS2.p3.1.m1.1"><semantics id="S2.SS2.p3.1.m1.1a"><mi id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><ci id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.1.m1.1d">italic_N</annotation></semantics></math> represents the total number of pixels in the image. In this way, the TTT layer reduces the traditional quadratic complexity (e.g., the self-attention mechanism in Transformers) to linear complexity. The hidden states are updated through parallel computation, significantly enhancing efficiency. Additionally, the TTT layer confines the computation within each mini-batch, further lowering the overall computational cost. This optimization allows the TTT layer to more effectively handle long-range contextual information while maintaining efficient sequence modeling, even under limited computational resources.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">The structure of Med-TTT is shown in fig <a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#S3.F1" title="Figure 1 ‣ 3 Method ‣ Med-TTT: Vision Test-Time Training model for Medical Image Segmentation"><span class="ltx_text ltx_ref_tag">1</span></a>. Med-TTT aims to achieve more accurate medical image segmentation by integrating multi-resolution fusion, frequency domain information, and the Vision-TTT layer based on TTT.</p>
</div>
<figure class="ltx_figure" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="256" id="S3.F1.g1" src="extracted/5898954/model-structure.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Model structure</figcaption>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Vision-TTT Layer</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.12">Traditional sequence modeling methods, such as Recurrent Neural Networks (RNNs), compress the context of a sequence input <math alttext="x_{1},\ldots,x_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.3"><semantics id="S3.SS1.p1.1.m1.3a"><mrow id="S3.SS1.p1.1.m1.3.3.2" xref="S3.SS1.p1.1.m1.3.3.3.cmml"><msub id="S3.SS1.p1.1.m1.2.2.1.1" xref="S3.SS1.p1.1.m1.2.2.1.1.cmml"><mi id="S3.SS1.p1.1.m1.2.2.1.1.2" xref="S3.SS1.p1.1.m1.2.2.1.1.2.cmml">x</mi><mn id="S3.SS1.p1.1.m1.2.2.1.1.3" xref="S3.SS1.p1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.1.m1.3.3.2.3" xref="S3.SS1.p1.1.m1.3.3.3.cmml">,</mo><mi id="S3.SS1.p1.1.m1.1.1" mathvariant="normal" xref="S3.SS1.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS1.p1.1.m1.3.3.2.4" xref="S3.SS1.p1.1.m1.3.3.3.cmml">,</mo><msub id="S3.SS1.p1.1.m1.3.3.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.cmml"><mi id="S3.SS1.p1.1.m1.3.3.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.cmml">x</mi><mi id="S3.SS1.p1.1.m1.3.3.2.2.3" xref="S3.SS1.p1.1.m1.3.3.2.2.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.3b"><list id="S3.SS1.p1.1.m1.3.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3.2"><apply id="S3.SS1.p1.1.m1.2.2.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.2.1.1.2.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.2">𝑥</ci><cn id="S3.SS1.p1.1.m1.2.2.1.1.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">…</ci><apply id="S3.SS1.p1.1.m1.3.3.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.3.3.2.2.1.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2">𝑥</ci><ci id="S3.SS1.p1.1.m1.3.3.2.2.3.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.3c">x_{1},\ldots,x_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.3d">italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> into a fixed-size hidden state <math alttext="h_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">h</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">ℎ</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">h_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. In RNN-based models, the hidden state <math alttext="h_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">h</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">ℎ</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">h_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> at time step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_t</annotation></semantics></math> is updated based on the hidden state <math alttext="h_{t-1}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">h</mi><mrow id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.3.2" xref="S3.SS1.p1.5.m5.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p1.5.m5.1.1.3.1" xref="S3.SS1.p1.5.m5.1.1.3.1.cmml">−</mo><mn id="S3.SS1.p1.5.m5.1.1.3.3" xref="S3.SS1.p1.5.m5.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">ℎ</ci><apply id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3"><minus id="S3.SS1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.1"></minus><ci id="S3.SS1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2">𝑡</ci><cn id="S3.SS1.p1.5.m5.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">h_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math> from the previous time step and the current input <math alttext="x_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><msub id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">x</mi><mi id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝑥</ci><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">x_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> using linear transformation matrices <math alttext="\theta_{h}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><msub id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">θ</mi><mi id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">𝜃</ci><ci id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">\theta_{h}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_θ start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\theta_{x}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><msub id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">θ</mi><mi id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">𝜃</ci><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\theta_{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">italic_θ start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math>, along with a non-linear activation function <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">italic_σ</annotation></semantics></math>:<math alttext="h_{t}=\sigma(\theta_{h}h_{t-1}+\theta_{x}x_{t})" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><mrow id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><msub id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml"><mi id="S3.SS1.p1.10.m10.1.1.3.2" xref="S3.SS1.p1.10.m10.1.1.3.2.cmml">h</mi><mi id="S3.SS1.p1.10.m10.1.1.3.3" xref="S3.SS1.p1.10.m10.1.1.3.3.cmml">t</mi></msub><mo id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">=</mo><mrow id="S3.SS1.p1.10.m10.1.1.1" xref="S3.SS1.p1.10.m10.1.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.1.3" xref="S3.SS1.p1.10.m10.1.1.1.3.cmml">σ</mi><mo id="S3.SS1.p1.10.m10.1.1.1.2" xref="S3.SS1.p1.10.m10.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.10.m10.1.1.1.1.1" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.10.m10.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.10.m10.1.1.1.1.1.1" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.cmml"><mrow id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.cmml"><msub id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.2.2.cmml">θ</mi><mi id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.2.3.cmml">h</mi></msub><mo id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.1" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.2" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.2.cmml">h</mi><mrow id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.3" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.3.2" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.3.2.cmml">t</mi><mo id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.3.1" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.3.1.cmml">−</mo><mn id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.3.3" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.SS1.p1.10.m10.1.1.1.1.1.1.1" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.SS1.p1.10.m10.1.1.1.1.1.1.3" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.cmml"><msub id="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.2" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.2.cmml"><mi id="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.2.2" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.2.2.cmml">θ</mi><mi id="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.2.3" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.2.3.cmml">x</mi></msub><mo id="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.1" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.3" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.3.2" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.3.2.cmml">x</mi><mi id="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.3.3" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.SS1.p1.10.m10.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><eq id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2"></eq><apply id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.3.1.cmml" xref="S3.SS1.p1.10.m10.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.3.2.cmml" xref="S3.SS1.p1.10.m10.1.1.3.2">ℎ</ci><ci id="S3.SS1.p1.10.m10.1.1.3.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3.3">𝑡</ci></apply><apply id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1"><times id="S3.SS1.p1.10.m10.1.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.1.2"></times><ci id="S3.SS1.p1.10.m10.1.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.1.3">𝜎</ci><apply id="S3.SS1.p1.10.m10.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1"><plus id="S3.SS1.p1.10.m10.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.1"></plus><apply id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2"><times id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.1"></times><apply id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.2.2">𝜃</ci><ci id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.2.3">ℎ</ci></apply><apply id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.2">ℎ</ci><apply id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.3"><minus id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.3.1"></minus><ci id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.3.2">𝑡</ci><cn id="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.3.3.cmml" type="integer" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.3"><times id="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.1"></times><apply id="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.2.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.2.2.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.2.2">𝜃</ci><ci id="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.2.3.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.2.3">𝑥</ci></apply><apply id="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.3.2">𝑥</ci><ci id="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">h_{t}=\sigma(\theta_{h}h_{t-1}+\theta_{x}x_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_σ ( italic_θ start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT + italic_θ start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, the output <math alttext="z_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.1"><semantics id="S3.SS1.p1.11.m11.1a"><msub id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml"><mi id="S3.SS1.p1.11.m11.1.1.2" xref="S3.SS1.p1.11.m11.1.1.2.cmml">z</mi><mi id="S3.SS1.p1.11.m11.1.1.3" xref="S3.SS1.p1.11.m11.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2">𝑧</ci><ci id="S3.SS1.p1.11.m11.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">z_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.1d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is then generated from the hidden state:<math alttext="z_{t}=\phi(h_{t})" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.1"><semantics id="S3.SS1.p1.12.m12.1a"><mrow id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml"><msub id="S3.SS1.p1.12.m12.1.1.3" xref="S3.SS1.p1.12.m12.1.1.3.cmml"><mi id="S3.SS1.p1.12.m12.1.1.3.2" xref="S3.SS1.p1.12.m12.1.1.3.2.cmml">z</mi><mi id="S3.SS1.p1.12.m12.1.1.3.3" xref="S3.SS1.p1.12.m12.1.1.3.3.cmml">t</mi></msub><mo id="S3.SS1.p1.12.m12.1.1.2" xref="S3.SS1.p1.12.m12.1.1.2.cmml">=</mo><mrow id="S3.SS1.p1.12.m12.1.1.1" xref="S3.SS1.p1.12.m12.1.1.1.cmml"><mi id="S3.SS1.p1.12.m12.1.1.1.3" xref="S3.SS1.p1.12.m12.1.1.1.3.cmml">ϕ</mi><mo id="S3.SS1.p1.12.m12.1.1.1.2" xref="S3.SS1.p1.12.m12.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.12.m12.1.1.1.1.1" xref="S3.SS1.p1.12.m12.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.12.m12.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.12.m12.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p1.12.m12.1.1.1.1.1.1" xref="S3.SS1.p1.12.m12.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.12.m12.1.1.1.1.1.1.2" xref="S3.SS1.p1.12.m12.1.1.1.1.1.1.2.cmml">h</mi><mi id="S3.SS1.p1.12.m12.1.1.1.1.1.1.3" xref="S3.SS1.p1.12.m12.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.p1.12.m12.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.12.m12.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1"><eq id="S3.SS1.p1.12.m12.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2"></eq><apply id="S3.SS1.p1.12.m12.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.3.1.cmml" xref="S3.SS1.p1.12.m12.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.3.2.cmml" xref="S3.SS1.p1.12.m12.1.1.3.2">𝑧</ci><ci id="S3.SS1.p1.12.m12.1.1.3.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3.3">𝑡</ci></apply><apply id="S3.SS1.p1.12.m12.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1.1"><times id="S3.SS1.p1.12.m12.1.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.1.2"></times><ci id="S3.SS1.p1.12.m12.1.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.1.3">italic-ϕ</ci><apply id="S3.SS1.p1.12.m12.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.SS1.p1.12.m12.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">z_{t}=\phi(h_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.1d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_ϕ ( italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">Although such methods have achieved some success in handling sequential data, the fixed-size hidden state limits the model’s ability to capture long-range dependencies, especially when the sequence length exceeds the effective representation capacity of the hidden state. To overcome this limitation, we introduce the Vision-TTT layer, a dynamically updated sequence modeling layer.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.4">In the Vision-TTT layer, the hidden state at time step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_t</annotation></semantics></math> is treated as a trainable model <math alttext="f" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">italic_f</annotation></semantics></math> with a weight matrix <math alttext="W_{t}" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><msub id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><mi id="S3.SS1.p3.3.m3.1.1.2" xref="S3.SS1.p3.3.m3.1.1.2.cmml">W</mi><mi id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2">𝑊</ci><ci id="S3.SS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">W_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> that is updated based on the current input <math alttext="X_{t}" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.1"><semantics id="S3.SS1.p3.4.m4.1a"><msub id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml"><mi id="S3.SS1.p3.4.m4.1.1.2" xref="S3.SS1.p3.4.m4.1.1.2.cmml">X</mi><mi id="S3.SS1.p3.4.m4.1.1.3" xref="S3.SS1.p3.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2">𝑋</ci><ci id="S3.SS1.p3.4.m4.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">X_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.1d">italic_X start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="W_{t}=W_{t-1}-\eta\nabla\mathcal{L}(W_{t-1},x_{t})" class="ltx_Math" display="block" id="S3.E10.m1.2"><semantics id="S3.E10.m1.2a"><mrow id="S3.E10.m1.2.2" xref="S3.E10.m1.2.2.cmml"><msub id="S3.E10.m1.2.2.4" xref="S3.E10.m1.2.2.4.cmml"><mi id="S3.E10.m1.2.2.4.2" xref="S3.E10.m1.2.2.4.2.cmml">W</mi><mi id="S3.E10.m1.2.2.4.3" xref="S3.E10.m1.2.2.4.3.cmml">t</mi></msub><mo id="S3.E10.m1.2.2.3" xref="S3.E10.m1.2.2.3.cmml">=</mo><mrow id="S3.E10.m1.2.2.2" xref="S3.E10.m1.2.2.2.cmml"><msub id="S3.E10.m1.2.2.2.4" xref="S3.E10.m1.2.2.2.4.cmml"><mi id="S3.E10.m1.2.2.2.4.2" xref="S3.E10.m1.2.2.2.4.2.cmml">W</mi><mrow id="S3.E10.m1.2.2.2.4.3" xref="S3.E10.m1.2.2.2.4.3.cmml"><mi id="S3.E10.m1.2.2.2.4.3.2" xref="S3.E10.m1.2.2.2.4.3.2.cmml">t</mi><mo id="S3.E10.m1.2.2.2.4.3.1" xref="S3.E10.m1.2.2.2.4.3.1.cmml">−</mo><mn id="S3.E10.m1.2.2.2.4.3.3" xref="S3.E10.m1.2.2.2.4.3.3.cmml">1</mn></mrow></msub><mo id="S3.E10.m1.2.2.2.3" xref="S3.E10.m1.2.2.2.3.cmml">−</mo><mrow id="S3.E10.m1.2.2.2.2" xref="S3.E10.m1.2.2.2.2.cmml"><mi id="S3.E10.m1.2.2.2.2.4" xref="S3.E10.m1.2.2.2.2.4.cmml">η</mi><mo id="S3.E10.m1.2.2.2.2.3" lspace="0.167em" xref="S3.E10.m1.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E10.m1.2.2.2.2.5" xref="S3.E10.m1.2.2.2.2.5.cmml"><mo id="S3.E10.m1.2.2.2.2.5.1" rspace="0.167em" xref="S3.E10.m1.2.2.2.2.5.1.cmml">∇</mo><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.2.2.2.2.5.2" xref="S3.E10.m1.2.2.2.2.5.2.cmml">ℒ</mi></mrow><mo id="S3.E10.m1.2.2.2.2.3a" xref="S3.E10.m1.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E10.m1.2.2.2.2.2.2" xref="S3.E10.m1.2.2.2.2.2.3.cmml"><mo id="S3.E10.m1.2.2.2.2.2.2.3" stretchy="false" xref="S3.E10.m1.2.2.2.2.2.3.cmml">(</mo><msub id="S3.E10.m1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.2.cmml">W</mi><mrow id="S3.E10.m1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E10.m1.1.1.1.1.1.1.1.3.1" xref="S3.E10.m1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E10.m1.1.1.1.1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E10.m1.2.2.2.2.2.2.4" xref="S3.E10.m1.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E10.m1.2.2.2.2.2.2.2" xref="S3.E10.m1.2.2.2.2.2.2.2.cmml"><mi id="S3.E10.m1.2.2.2.2.2.2.2.2" xref="S3.E10.m1.2.2.2.2.2.2.2.2.cmml">x</mi><mi id="S3.E10.m1.2.2.2.2.2.2.2.3" xref="S3.E10.m1.2.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.E10.m1.2.2.2.2.2.2.5" stretchy="false" xref="S3.E10.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.2b"><apply id="S3.E10.m1.2.2.cmml" xref="S3.E10.m1.2.2"><eq id="S3.E10.m1.2.2.3.cmml" xref="S3.E10.m1.2.2.3"></eq><apply id="S3.E10.m1.2.2.4.cmml" xref="S3.E10.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.4.1.cmml" xref="S3.E10.m1.2.2.4">subscript</csymbol><ci id="S3.E10.m1.2.2.4.2.cmml" xref="S3.E10.m1.2.2.4.2">𝑊</ci><ci id="S3.E10.m1.2.2.4.3.cmml" xref="S3.E10.m1.2.2.4.3">𝑡</ci></apply><apply id="S3.E10.m1.2.2.2.cmml" xref="S3.E10.m1.2.2.2"><minus id="S3.E10.m1.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.3"></minus><apply id="S3.E10.m1.2.2.2.4.cmml" xref="S3.E10.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.4.1.cmml" xref="S3.E10.m1.2.2.2.4">subscript</csymbol><ci id="S3.E10.m1.2.2.2.4.2.cmml" xref="S3.E10.m1.2.2.2.4.2">𝑊</ci><apply id="S3.E10.m1.2.2.2.4.3.cmml" xref="S3.E10.m1.2.2.2.4.3"><minus id="S3.E10.m1.2.2.2.4.3.1.cmml" xref="S3.E10.m1.2.2.2.4.3.1"></minus><ci id="S3.E10.m1.2.2.2.4.3.2.cmml" xref="S3.E10.m1.2.2.2.4.3.2">𝑡</ci><cn id="S3.E10.m1.2.2.2.4.3.3.cmml" type="integer" xref="S3.E10.m1.2.2.2.4.3.3">1</cn></apply></apply><apply id="S3.E10.m1.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2"><times id="S3.E10.m1.2.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2.3"></times><ci id="S3.E10.m1.2.2.2.2.4.cmml" xref="S3.E10.m1.2.2.2.2.4">𝜂</ci><apply id="S3.E10.m1.2.2.2.2.5.cmml" xref="S3.E10.m1.2.2.2.2.5"><ci id="S3.E10.m1.2.2.2.2.5.1.cmml" xref="S3.E10.m1.2.2.2.2.5.1">∇</ci><ci id="S3.E10.m1.2.2.2.2.5.2.cmml" xref="S3.E10.m1.2.2.2.2.5.2">ℒ</ci></apply><interval closure="open" id="S3.E10.m1.2.2.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2"><apply id="S3.E10.m1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.2">𝑊</ci><apply id="S3.E10.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.3"><minus id="S3.E10.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E10.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="S3.E10.m1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E10.m1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E10.m1.2.2.2.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E10.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2">𝑥</ci><ci id="S3.E10.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.2c">W_{t}=W_{t-1}-\eta\nabla\mathcal{L}(W_{t-1},x_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.2d">italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_W start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT - italic_η ∇ caligraphic_L ( italic_W start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p3.9">where <math alttext="\eta" class="ltx_Math" display="inline" id="S3.SS1.p3.5.m1.1"><semantics id="S3.SS1.p3.5.m1.1a"><mi id="S3.SS1.p3.5.m1.1.1" xref="S3.SS1.p3.5.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m1.1b"><ci id="S3.SS1.p3.5.m1.1.1.cmml" xref="S3.SS1.p3.5.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m1.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.5.m1.1d">italic_η</annotation></semantics></math> is the learning rate, and <math alttext="L" class="ltx_Math" display="inline" id="S3.SS1.p3.6.m2.1"><semantics id="S3.SS1.p3.6.m2.1a"><mi id="S3.SS1.p3.6.m2.1.1" xref="S3.SS1.p3.6.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m2.1b"><ci id="S3.SS1.p3.6.m2.1.1.cmml" xref="S3.SS1.p3.6.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.6.m2.1d">italic_L</annotation></semantics></math> is a self-supervised loss function used to optimize the model’s performance based on the current input. After updating the weight <math alttext="W_{t}" class="ltx_Math" display="inline" id="S3.SS1.p3.7.m3.1"><semantics id="S3.SS1.p3.7.m3.1a"><msub id="S3.SS1.p3.7.m3.1.1" xref="S3.SS1.p3.7.m3.1.1.cmml"><mi id="S3.SS1.p3.7.m3.1.1.2" xref="S3.SS1.p3.7.m3.1.1.2.cmml">W</mi><mi id="S3.SS1.p3.7.m3.1.1.3" xref="S3.SS1.p3.7.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m3.1b"><apply id="S3.SS1.p3.7.m3.1.1.cmml" xref="S3.SS1.p3.7.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m3.1.1.1.cmml" xref="S3.SS1.p3.7.m3.1.1">subscript</csymbol><ci id="S3.SS1.p3.7.m3.1.1.2.cmml" xref="S3.SS1.p3.7.m3.1.1.2">𝑊</ci><ci id="S3.SS1.p3.7.m3.1.1.3.cmml" xref="S3.SS1.p3.7.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m3.1c">W_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.7.m3.1d">italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, the output token <math alttext="z_{t}" class="ltx_Math" display="inline" id="S3.SS1.p3.8.m4.1"><semantics id="S3.SS1.p3.8.m4.1a"><msub id="S3.SS1.p3.8.m4.1.1" xref="S3.SS1.p3.8.m4.1.1.cmml"><mi id="S3.SS1.p3.8.m4.1.1.2" xref="S3.SS1.p3.8.m4.1.1.2.cmml">z</mi><mi id="S3.SS1.p3.8.m4.1.1.3" xref="S3.SS1.p3.8.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m4.1b"><apply id="S3.SS1.p3.8.m4.1.1.cmml" xref="S3.SS1.p3.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m4.1.1.1.cmml" xref="S3.SS1.p3.8.m4.1.1">subscript</csymbol><ci id="S3.SS1.p3.8.m4.1.1.2.cmml" xref="S3.SS1.p3.8.m4.1.1.2">𝑧</ci><ci id="S3.SS1.p3.8.m4.1.1.3.cmml" xref="S3.SS1.p3.8.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m4.1c">z_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.8.m4.1d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is generated as: <math alttext="z_{t}=f(x_{t};W_{t})" class="ltx_Math" display="inline" id="S3.SS1.p3.9.m5.2"><semantics id="S3.SS1.p3.9.m5.2a"><mrow id="S3.SS1.p3.9.m5.2.2" xref="S3.SS1.p3.9.m5.2.2.cmml"><msub id="S3.SS1.p3.9.m5.2.2.4" xref="S3.SS1.p3.9.m5.2.2.4.cmml"><mi id="S3.SS1.p3.9.m5.2.2.4.2" xref="S3.SS1.p3.9.m5.2.2.4.2.cmml">z</mi><mi id="S3.SS1.p3.9.m5.2.2.4.3" xref="S3.SS1.p3.9.m5.2.2.4.3.cmml">t</mi></msub><mo id="S3.SS1.p3.9.m5.2.2.3" xref="S3.SS1.p3.9.m5.2.2.3.cmml">=</mo><mrow id="S3.SS1.p3.9.m5.2.2.2" xref="S3.SS1.p3.9.m5.2.2.2.cmml"><mi id="S3.SS1.p3.9.m5.2.2.2.4" xref="S3.SS1.p3.9.m5.2.2.2.4.cmml">f</mi><mo id="S3.SS1.p3.9.m5.2.2.2.3" xref="S3.SS1.p3.9.m5.2.2.2.3.cmml">⁢</mo><mrow id="S3.SS1.p3.9.m5.2.2.2.2.2" xref="S3.SS1.p3.9.m5.2.2.2.2.3.cmml"><mo id="S3.SS1.p3.9.m5.2.2.2.2.2.3" stretchy="false" xref="S3.SS1.p3.9.m5.2.2.2.2.3.cmml">(</mo><msub id="S3.SS1.p3.9.m5.1.1.1.1.1.1" xref="S3.SS1.p3.9.m5.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.9.m5.1.1.1.1.1.1.2" xref="S3.SS1.p3.9.m5.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS1.p3.9.m5.1.1.1.1.1.1.3" xref="S3.SS1.p3.9.m5.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.p3.9.m5.2.2.2.2.2.4" xref="S3.SS1.p3.9.m5.2.2.2.2.3.cmml">;</mo><msub id="S3.SS1.p3.9.m5.2.2.2.2.2.2" xref="S3.SS1.p3.9.m5.2.2.2.2.2.2.cmml"><mi id="S3.SS1.p3.9.m5.2.2.2.2.2.2.2" xref="S3.SS1.p3.9.m5.2.2.2.2.2.2.2.cmml">W</mi><mi id="S3.SS1.p3.9.m5.2.2.2.2.2.2.3" xref="S3.SS1.p3.9.m5.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS1.p3.9.m5.2.2.2.2.2.5" stretchy="false" xref="S3.SS1.p3.9.m5.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.9.m5.2b"><apply id="S3.SS1.p3.9.m5.2.2.cmml" xref="S3.SS1.p3.9.m5.2.2"><eq id="S3.SS1.p3.9.m5.2.2.3.cmml" xref="S3.SS1.p3.9.m5.2.2.3"></eq><apply id="S3.SS1.p3.9.m5.2.2.4.cmml" xref="S3.SS1.p3.9.m5.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p3.9.m5.2.2.4.1.cmml" xref="S3.SS1.p3.9.m5.2.2.4">subscript</csymbol><ci id="S3.SS1.p3.9.m5.2.2.4.2.cmml" xref="S3.SS1.p3.9.m5.2.2.4.2">𝑧</ci><ci id="S3.SS1.p3.9.m5.2.2.4.3.cmml" xref="S3.SS1.p3.9.m5.2.2.4.3">𝑡</ci></apply><apply id="S3.SS1.p3.9.m5.2.2.2.cmml" xref="S3.SS1.p3.9.m5.2.2.2"><times id="S3.SS1.p3.9.m5.2.2.2.3.cmml" xref="S3.SS1.p3.9.m5.2.2.2.3"></times><ci id="S3.SS1.p3.9.m5.2.2.2.4.cmml" xref="S3.SS1.p3.9.m5.2.2.2.4">𝑓</ci><list id="S3.SS1.p3.9.m5.2.2.2.2.3.cmml" xref="S3.SS1.p3.9.m5.2.2.2.2.2"><apply id="S3.SS1.p3.9.m5.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.9.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.9.m5.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.9.m5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.9.m5.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.9.m5.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.p3.9.m5.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.9.m5.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS1.p3.9.m5.2.2.2.2.2.2.cmml" xref="S3.SS1.p3.9.m5.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.9.m5.2.2.2.2.2.2.1.cmml" xref="S3.SS1.p3.9.m5.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p3.9.m5.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p3.9.m5.2.2.2.2.2.2.2">𝑊</ci><ci id="S3.SS1.p3.9.m5.2.2.2.2.2.2.3.cmml" xref="S3.SS1.p3.9.m5.2.2.2.2.2.2.3">𝑡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.9.m5.2c">z_{t}=f(x_{t};W_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.9.m5.2d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_f ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ; italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.1">This dynamic update process allows the model to better capture contextual information and adjust the hidden states over time, significantly enhancing its ability to model long-range dependencies.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.2">In the simplest form of the TTT layer, the self-supervised learning task is achieved by minimizing the error between the original input <math alttext="X_{t}" class="ltx_Math" display="inline" id="S3.SS1.p5.1.m1.1"><semantics id="S3.SS1.p5.1.m1.1a"><msub id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml"><mi id="S3.SS1.p5.1.m1.1.1.2" xref="S3.SS1.p5.1.m1.1.1.2.cmml">X</mi><mi id="S3.SS1.p5.1.m1.1.1.3" xref="S3.SS1.p5.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><apply id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.1.m1.1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p5.1.m1.1.1.2.cmml" xref="S3.SS1.p5.1.m1.1.1.2">𝑋</ci><ci id="S3.SS1.p5.1.m1.1.1.3.cmml" xref="S3.SS1.p5.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">X_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.1.m1.1d">italic_X start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and its reconstructed version <math alttext="f(x_{t};W_{t})" class="ltx_Math" display="inline" id="S3.SS1.p5.2.m2.2"><semantics id="S3.SS1.p5.2.m2.2a"><mrow id="S3.SS1.p5.2.m2.2.2" xref="S3.SS1.p5.2.m2.2.2.cmml"><mi id="S3.SS1.p5.2.m2.2.2.4" xref="S3.SS1.p5.2.m2.2.2.4.cmml">f</mi><mo id="S3.SS1.p5.2.m2.2.2.3" xref="S3.SS1.p5.2.m2.2.2.3.cmml">⁢</mo><mrow id="S3.SS1.p5.2.m2.2.2.2.2" xref="S3.SS1.p5.2.m2.2.2.2.3.cmml"><mo id="S3.SS1.p5.2.m2.2.2.2.2.3" stretchy="false" xref="S3.SS1.p5.2.m2.2.2.2.3.cmml">(</mo><msub id="S3.SS1.p5.2.m2.1.1.1.1.1" xref="S3.SS1.p5.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS1.p5.2.m2.1.1.1.1.1.2" xref="S3.SS1.p5.2.m2.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS1.p5.2.m2.1.1.1.1.1.3" xref="S3.SS1.p5.2.m2.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.p5.2.m2.2.2.2.2.4" xref="S3.SS1.p5.2.m2.2.2.2.3.cmml">;</mo><msub id="S3.SS1.p5.2.m2.2.2.2.2.2" xref="S3.SS1.p5.2.m2.2.2.2.2.2.cmml"><mi id="S3.SS1.p5.2.m2.2.2.2.2.2.2" xref="S3.SS1.p5.2.m2.2.2.2.2.2.2.cmml">W</mi><mi id="S3.SS1.p5.2.m2.2.2.2.2.2.3" xref="S3.SS1.p5.2.m2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS1.p5.2.m2.2.2.2.2.5" stretchy="false" xref="S3.SS1.p5.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.2.m2.2b"><apply id="S3.SS1.p5.2.m2.2.2.cmml" xref="S3.SS1.p5.2.m2.2.2"><times id="S3.SS1.p5.2.m2.2.2.3.cmml" xref="S3.SS1.p5.2.m2.2.2.3"></times><ci id="S3.SS1.p5.2.m2.2.2.4.cmml" xref="S3.SS1.p5.2.m2.2.2.4">𝑓</ci><list id="S3.SS1.p5.2.m2.2.2.2.3.cmml" xref="S3.SS1.p5.2.m2.2.2.2.2"><apply id="S3.SS1.p5.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p5.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p5.2.m2.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.p5.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.p5.2.m2.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS1.p5.2.m2.2.2.2.2.2.cmml" xref="S3.SS1.p5.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p5.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS1.p5.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p5.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS1.p5.2.m2.2.2.2.2.2.2">𝑊</ci><ci id="S3.SS1.p5.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS1.p5.2.m2.2.2.2.2.2.3">𝑡</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.2.m2.2c">f(x_{t};W_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.2.m2.2d">italic_f ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ; italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}(W;x_{t})=\parallel\theta_{k}f(\tilde{x}_{t};W)-\theta_{v}x_{t}%
\parallel^{2}" class="ltx_Math" display="block" id="S3.E11.m1.4"><semantics id="S3.E11.m1.4a"><mrow id="S3.E11.m1.4.4" xref="S3.E11.m1.4.4.cmml"><mrow id="S3.E11.m1.3.3.1" xref="S3.E11.m1.3.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.3.3.1.3" xref="S3.E11.m1.3.3.1.3.cmml">ℒ</mi><mo id="S3.E11.m1.3.3.1.2" xref="S3.E11.m1.3.3.1.2.cmml">⁢</mo><mrow id="S3.E11.m1.3.3.1.1.1" xref="S3.E11.m1.3.3.1.1.2.cmml"><mo id="S3.E11.m1.3.3.1.1.1.2" stretchy="false" xref="S3.E11.m1.3.3.1.1.2.cmml">(</mo><mi id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml">W</mi><mo id="S3.E11.m1.3.3.1.1.1.3" xref="S3.E11.m1.3.3.1.1.2.cmml">;</mo><msub id="S3.E11.m1.3.3.1.1.1.1" xref="S3.E11.m1.3.3.1.1.1.1.cmml"><mi id="S3.E11.m1.3.3.1.1.1.1.2" xref="S3.E11.m1.3.3.1.1.1.1.2.cmml">x</mi><mi id="S3.E11.m1.3.3.1.1.1.1.3" xref="S3.E11.m1.3.3.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E11.m1.3.3.1.1.1.4" stretchy="false" xref="S3.E11.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.4.4.3" xref="S3.E11.m1.4.4.3.cmml">=</mo><msup id="S3.E11.m1.4.4.2" xref="S3.E11.m1.4.4.2.cmml"><mrow id="S3.E11.m1.4.4.2.1.1" xref="S3.E11.m1.4.4.2.1.2.cmml"><mo id="S3.E11.m1.4.4.2.1.1.2" stretchy="false" xref="S3.E11.m1.4.4.2.1.2.1.cmml">‖</mo><mrow id="S3.E11.m1.4.4.2.1.1.1" xref="S3.E11.m1.4.4.2.1.1.1.cmml"><mrow id="S3.E11.m1.4.4.2.1.1.1.1" xref="S3.E11.m1.4.4.2.1.1.1.1.cmml"><msub id="S3.E11.m1.4.4.2.1.1.1.1.3" xref="S3.E11.m1.4.4.2.1.1.1.1.3.cmml"><mi id="S3.E11.m1.4.4.2.1.1.1.1.3.2" xref="S3.E11.m1.4.4.2.1.1.1.1.3.2.cmml">θ</mi><mi id="S3.E11.m1.4.4.2.1.1.1.1.3.3" xref="S3.E11.m1.4.4.2.1.1.1.1.3.3.cmml">k</mi></msub><mo id="S3.E11.m1.4.4.2.1.1.1.1.2" xref="S3.E11.m1.4.4.2.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E11.m1.4.4.2.1.1.1.1.4" xref="S3.E11.m1.4.4.2.1.1.1.1.4.cmml">f</mi><mo id="S3.E11.m1.4.4.2.1.1.1.1.2a" xref="S3.E11.m1.4.4.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E11.m1.4.4.2.1.1.1.1.1.1" xref="S3.E11.m1.4.4.2.1.1.1.1.1.2.cmml"><mo id="S3.E11.m1.4.4.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E11.m1.4.4.2.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E11.m1.4.4.2.1.1.1.1.1.1.1" xref="S3.E11.m1.4.4.2.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E11.m1.4.4.2.1.1.1.1.1.1.1.2" xref="S3.E11.m1.4.4.2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E11.m1.4.4.2.1.1.1.1.1.1.1.2.2" xref="S3.E11.m1.4.4.2.1.1.1.1.1.1.1.2.2.cmml">x</mi><mo id="S3.E11.m1.4.4.2.1.1.1.1.1.1.1.2.1" xref="S3.E11.m1.4.4.2.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S3.E11.m1.4.4.2.1.1.1.1.1.1.1.3" xref="S3.E11.m1.4.4.2.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E11.m1.4.4.2.1.1.1.1.1.1.3" xref="S3.E11.m1.4.4.2.1.1.1.1.1.2.cmml">;</mo><mi id="S3.E11.m1.2.2" xref="S3.E11.m1.2.2.cmml">W</mi><mo id="S3.E11.m1.4.4.2.1.1.1.1.1.1.4" stretchy="false" xref="S3.E11.m1.4.4.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.4.4.2.1.1.1.2" xref="S3.E11.m1.4.4.2.1.1.1.2.cmml">−</mo><mrow id="S3.E11.m1.4.4.2.1.1.1.3" xref="S3.E11.m1.4.4.2.1.1.1.3.cmml"><msub id="S3.E11.m1.4.4.2.1.1.1.3.2" xref="S3.E11.m1.4.4.2.1.1.1.3.2.cmml"><mi id="S3.E11.m1.4.4.2.1.1.1.3.2.2" xref="S3.E11.m1.4.4.2.1.1.1.3.2.2.cmml">θ</mi><mi id="S3.E11.m1.4.4.2.1.1.1.3.2.3" xref="S3.E11.m1.4.4.2.1.1.1.3.2.3.cmml">v</mi></msub><mo id="S3.E11.m1.4.4.2.1.1.1.3.1" xref="S3.E11.m1.4.4.2.1.1.1.3.1.cmml">⁢</mo><msub id="S3.E11.m1.4.4.2.1.1.1.3.3" xref="S3.E11.m1.4.4.2.1.1.1.3.3.cmml"><mi id="S3.E11.m1.4.4.2.1.1.1.3.3.2" xref="S3.E11.m1.4.4.2.1.1.1.3.3.2.cmml">x</mi><mi id="S3.E11.m1.4.4.2.1.1.1.3.3.3" xref="S3.E11.m1.4.4.2.1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.E11.m1.4.4.2.1.1.3" stretchy="false" xref="S3.E11.m1.4.4.2.1.2.1.cmml">‖</mo></mrow><mn id="S3.E11.m1.4.4.2.3" xref="S3.E11.m1.4.4.2.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.4b"><apply id="S3.E11.m1.4.4.cmml" xref="S3.E11.m1.4.4"><eq id="S3.E11.m1.4.4.3.cmml" xref="S3.E11.m1.4.4.3"></eq><apply id="S3.E11.m1.3.3.1.cmml" xref="S3.E11.m1.3.3.1"><times id="S3.E11.m1.3.3.1.2.cmml" xref="S3.E11.m1.3.3.1.2"></times><ci id="S3.E11.m1.3.3.1.3.cmml" xref="S3.E11.m1.3.3.1.3">ℒ</ci><list id="S3.E11.m1.3.3.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.1"><ci id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1">𝑊</ci><apply id="S3.E11.m1.3.3.1.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S3.E11.m1.3.3.1.1.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.2">𝑥</ci><ci id="S3.E11.m1.3.3.1.1.1.1.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3">𝑡</ci></apply></list></apply><apply id="S3.E11.m1.4.4.2.cmml" xref="S3.E11.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.2.2.cmml" xref="S3.E11.m1.4.4.2">superscript</csymbol><apply id="S3.E11.m1.4.4.2.1.2.cmml" xref="S3.E11.m1.4.4.2.1.1"><csymbol cd="latexml" id="S3.E11.m1.4.4.2.1.2.1.cmml" xref="S3.E11.m1.4.4.2.1.1.2">norm</csymbol><apply id="S3.E11.m1.4.4.2.1.1.1.cmml" xref="S3.E11.m1.4.4.2.1.1.1"><minus id="S3.E11.m1.4.4.2.1.1.1.2.cmml" xref="S3.E11.m1.4.4.2.1.1.1.2"></minus><apply id="S3.E11.m1.4.4.2.1.1.1.1.cmml" xref="S3.E11.m1.4.4.2.1.1.1.1"><times id="S3.E11.m1.4.4.2.1.1.1.1.2.cmml" xref="S3.E11.m1.4.4.2.1.1.1.1.2"></times><apply id="S3.E11.m1.4.4.2.1.1.1.1.3.cmml" xref="S3.E11.m1.4.4.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.2.1.1.1.1.3.1.cmml" xref="S3.E11.m1.4.4.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E11.m1.4.4.2.1.1.1.1.3.2.cmml" xref="S3.E11.m1.4.4.2.1.1.1.1.3.2">𝜃</ci><ci id="S3.E11.m1.4.4.2.1.1.1.1.3.3.cmml" xref="S3.E11.m1.4.4.2.1.1.1.1.3.3">𝑘</ci></apply><ci id="S3.E11.m1.4.4.2.1.1.1.1.4.cmml" xref="S3.E11.m1.4.4.2.1.1.1.1.4">𝑓</ci><list id="S3.E11.m1.4.4.2.1.1.1.1.1.2.cmml" xref="S3.E11.m1.4.4.2.1.1.1.1.1.1"><apply id="S3.E11.m1.4.4.2.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.4.4.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E11.m1.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.4.4.2.1.1.1.1.1.1.1.2"><ci id="S3.E11.m1.4.4.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.4.4.2.1.1.1.1.1.1.1.2.1">~</ci><ci id="S3.E11.m1.4.4.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.4.4.2.1.1.1.1.1.1.1.2.2">𝑥</ci></apply><ci id="S3.E11.m1.4.4.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.4.4.2.1.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S3.E11.m1.2.2.cmml" xref="S3.E11.m1.2.2">𝑊</ci></list></apply><apply id="S3.E11.m1.4.4.2.1.1.1.3.cmml" xref="S3.E11.m1.4.4.2.1.1.1.3"><times id="S3.E11.m1.4.4.2.1.1.1.3.1.cmml" xref="S3.E11.m1.4.4.2.1.1.1.3.1"></times><apply id="S3.E11.m1.4.4.2.1.1.1.3.2.cmml" xref="S3.E11.m1.4.4.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.2.1.1.1.3.2.1.cmml" xref="S3.E11.m1.4.4.2.1.1.1.3.2">subscript</csymbol><ci id="S3.E11.m1.4.4.2.1.1.1.3.2.2.cmml" xref="S3.E11.m1.4.4.2.1.1.1.3.2.2">𝜃</ci><ci id="S3.E11.m1.4.4.2.1.1.1.3.2.3.cmml" xref="S3.E11.m1.4.4.2.1.1.1.3.2.3">𝑣</ci></apply><apply id="S3.E11.m1.4.4.2.1.1.1.3.3.cmml" xref="S3.E11.m1.4.4.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.2.1.1.1.3.3.1.cmml" xref="S3.E11.m1.4.4.2.1.1.1.3.3">subscript</csymbol><ci id="S3.E11.m1.4.4.2.1.1.1.3.3.2.cmml" xref="S3.E11.m1.4.4.2.1.1.1.3.3.2">𝑥</ci><ci id="S3.E11.m1.4.4.2.1.1.1.3.3.3.cmml" xref="S3.E11.m1.4.4.2.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply><cn id="S3.E11.m1.4.4.2.3.cmml" type="integer" xref="S3.E11.m1.4.4.2.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.4c">\mathcal{L}(W;x_{t})=\parallel\theta_{k}f(\tilde{x}_{t};W)-\theta_{v}x_{t}%
\parallel^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.4d">caligraphic_L ( italic_W ; italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = ∥ italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_f ( over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ; italic_W ) - italic_θ start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p5.3">Although this simple reconstruction method is effective in some cases, it fails to capture the rich contextual information in complex dependencies, limiting the model’s understanding of the input.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p6">
<p class="ltx_p" id="S3.SS1.p6.4">To address this issue, Vision-TTT introduces a more sophisticated self-supervised loss function by utilizing multiple views of the input data. Instead of directly reconstructing the corrupted input, the Vision-TTT layer projects the input into different views using two transformation matrices <math alttext="\theta_{k}" class="ltx_Math" display="inline" id="S3.SS1.p6.1.m1.1"><semantics id="S3.SS1.p6.1.m1.1a"><msub id="S3.SS1.p6.1.m1.1.1" xref="S3.SS1.p6.1.m1.1.1.cmml"><mi id="S3.SS1.p6.1.m1.1.1.2" xref="S3.SS1.p6.1.m1.1.1.2.cmml">θ</mi><mi id="S3.SS1.p6.1.m1.1.1.3" xref="S3.SS1.p6.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.1.m1.1b"><apply id="S3.SS1.p6.1.m1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.1.m1.1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p6.1.m1.1.1.2.cmml" xref="S3.SS1.p6.1.m1.1.1.2">𝜃</ci><ci id="S3.SS1.p6.1.m1.1.1.3.cmml" xref="S3.SS1.p6.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.1.m1.1c">\theta_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.1.m1.1d">italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\theta_{v}" class="ltx_Math" display="inline" id="S3.SS1.p6.2.m2.1"><semantics id="S3.SS1.p6.2.m2.1a"><msub id="S3.SS1.p6.2.m2.1.1" xref="S3.SS1.p6.2.m2.1.1.cmml"><mi id="S3.SS1.p6.2.m2.1.1.2" xref="S3.SS1.p6.2.m2.1.1.2.cmml">θ</mi><mi id="S3.SS1.p6.2.m2.1.1.3" xref="S3.SS1.p6.2.m2.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.2.m2.1b"><apply id="S3.SS1.p6.2.m2.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.2.m2.1.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p6.2.m2.1.1.2.cmml" xref="S3.SS1.p6.2.m2.1.1.2">𝜃</ci><ci id="S3.SS1.p6.2.m2.1.1.3.cmml" xref="S3.SS1.p6.2.m2.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.2.m2.1c">\theta_{v}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.2.m2.1d">italic_θ start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>. View <math alttext="K=\theta_{k}x_{t}" class="ltx_Math" display="inline" id="S3.SS1.p6.3.m3.1"><semantics id="S3.SS1.p6.3.m3.1a"><mrow id="S3.SS1.p6.3.m3.1.1" xref="S3.SS1.p6.3.m3.1.1.cmml"><mi id="S3.SS1.p6.3.m3.1.1.2" xref="S3.SS1.p6.3.m3.1.1.2.cmml">K</mi><mo id="S3.SS1.p6.3.m3.1.1.1" xref="S3.SS1.p6.3.m3.1.1.1.cmml">=</mo><mrow id="S3.SS1.p6.3.m3.1.1.3" xref="S3.SS1.p6.3.m3.1.1.3.cmml"><msub id="S3.SS1.p6.3.m3.1.1.3.2" xref="S3.SS1.p6.3.m3.1.1.3.2.cmml"><mi id="S3.SS1.p6.3.m3.1.1.3.2.2" xref="S3.SS1.p6.3.m3.1.1.3.2.2.cmml">θ</mi><mi id="S3.SS1.p6.3.m3.1.1.3.2.3" xref="S3.SS1.p6.3.m3.1.1.3.2.3.cmml">k</mi></msub><mo id="S3.SS1.p6.3.m3.1.1.3.1" xref="S3.SS1.p6.3.m3.1.1.3.1.cmml">⁢</mo><msub id="S3.SS1.p6.3.m3.1.1.3.3" xref="S3.SS1.p6.3.m3.1.1.3.3.cmml"><mi id="S3.SS1.p6.3.m3.1.1.3.3.2" xref="S3.SS1.p6.3.m3.1.1.3.3.2.cmml">x</mi><mi id="S3.SS1.p6.3.m3.1.1.3.3.3" xref="S3.SS1.p6.3.m3.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.3.m3.1b"><apply id="S3.SS1.p6.3.m3.1.1.cmml" xref="S3.SS1.p6.3.m3.1.1"><eq id="S3.SS1.p6.3.m3.1.1.1.cmml" xref="S3.SS1.p6.3.m3.1.1.1"></eq><ci id="S3.SS1.p6.3.m3.1.1.2.cmml" xref="S3.SS1.p6.3.m3.1.1.2">𝐾</ci><apply id="S3.SS1.p6.3.m3.1.1.3.cmml" xref="S3.SS1.p6.3.m3.1.1.3"><times id="S3.SS1.p6.3.m3.1.1.3.1.cmml" xref="S3.SS1.p6.3.m3.1.1.3.1"></times><apply id="S3.SS1.p6.3.m3.1.1.3.2.cmml" xref="S3.SS1.p6.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p6.3.m3.1.1.3.2.1.cmml" xref="S3.SS1.p6.3.m3.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p6.3.m3.1.1.3.2.2.cmml" xref="S3.SS1.p6.3.m3.1.1.3.2.2">𝜃</ci><ci id="S3.SS1.p6.3.m3.1.1.3.2.3.cmml" xref="S3.SS1.p6.3.m3.1.1.3.2.3">𝑘</ci></apply><apply id="S3.SS1.p6.3.m3.1.1.3.3.cmml" xref="S3.SS1.p6.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p6.3.m3.1.1.3.3.1.cmml" xref="S3.SS1.p6.3.m3.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p6.3.m3.1.1.3.3.2.cmml" xref="S3.SS1.p6.3.m3.1.1.3.3.2">𝑥</ci><ci id="S3.SS1.p6.3.m3.1.1.3.3.3.cmml" xref="S3.SS1.p6.3.m3.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.3.m3.1c">K=\theta_{k}x_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.3.m3.1d">italic_K = italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> captures the key information needed for learning, while the label view <math alttext="V=\theta_{v}x_{t}" class="ltx_Math" display="inline" id="S3.SS1.p6.4.m4.1"><semantics id="S3.SS1.p6.4.m4.1a"><mrow id="S3.SS1.p6.4.m4.1.1" xref="S3.SS1.p6.4.m4.1.1.cmml"><mi id="S3.SS1.p6.4.m4.1.1.2" xref="S3.SS1.p6.4.m4.1.1.2.cmml">V</mi><mo id="S3.SS1.p6.4.m4.1.1.1" xref="S3.SS1.p6.4.m4.1.1.1.cmml">=</mo><mrow id="S3.SS1.p6.4.m4.1.1.3" xref="S3.SS1.p6.4.m4.1.1.3.cmml"><msub id="S3.SS1.p6.4.m4.1.1.3.2" xref="S3.SS1.p6.4.m4.1.1.3.2.cmml"><mi id="S3.SS1.p6.4.m4.1.1.3.2.2" xref="S3.SS1.p6.4.m4.1.1.3.2.2.cmml">θ</mi><mi id="S3.SS1.p6.4.m4.1.1.3.2.3" xref="S3.SS1.p6.4.m4.1.1.3.2.3.cmml">v</mi></msub><mo id="S3.SS1.p6.4.m4.1.1.3.1" xref="S3.SS1.p6.4.m4.1.1.3.1.cmml">⁢</mo><msub id="S3.SS1.p6.4.m4.1.1.3.3" xref="S3.SS1.p6.4.m4.1.1.3.3.cmml"><mi id="S3.SS1.p6.4.m4.1.1.3.3.2" xref="S3.SS1.p6.4.m4.1.1.3.3.2.cmml">x</mi><mi id="S3.SS1.p6.4.m4.1.1.3.3.3" xref="S3.SS1.p6.4.m4.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.4.m4.1b"><apply id="S3.SS1.p6.4.m4.1.1.cmml" xref="S3.SS1.p6.4.m4.1.1"><eq id="S3.SS1.p6.4.m4.1.1.1.cmml" xref="S3.SS1.p6.4.m4.1.1.1"></eq><ci id="S3.SS1.p6.4.m4.1.1.2.cmml" xref="S3.SS1.p6.4.m4.1.1.2">𝑉</ci><apply id="S3.SS1.p6.4.m4.1.1.3.cmml" xref="S3.SS1.p6.4.m4.1.1.3"><times id="S3.SS1.p6.4.m4.1.1.3.1.cmml" xref="S3.SS1.p6.4.m4.1.1.3.1"></times><apply id="S3.SS1.p6.4.m4.1.1.3.2.cmml" xref="S3.SS1.p6.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p6.4.m4.1.1.3.2.1.cmml" xref="S3.SS1.p6.4.m4.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p6.4.m4.1.1.3.2.2.cmml" xref="S3.SS1.p6.4.m4.1.1.3.2.2">𝜃</ci><ci id="S3.SS1.p6.4.m4.1.1.3.2.3.cmml" xref="S3.SS1.p6.4.m4.1.1.3.2.3">𝑣</ci></apply><apply id="S3.SS1.p6.4.m4.1.1.3.3.cmml" xref="S3.SS1.p6.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p6.4.m4.1.1.3.3.1.cmml" xref="S3.SS1.p6.4.m4.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p6.4.m4.1.1.3.3.2.cmml" xref="S3.SS1.p6.4.m4.1.1.3.3.2">𝑥</ci><ci id="S3.SS1.p6.4.m4.1.1.3.3.3.cmml" xref="S3.SS1.p6.4.m4.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.4.m4.1c">V=\theta_{v}x_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.4.m4.1d">italic_V = italic_θ start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> provides the optimization target for the model. The corresponding loss function becomes</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L(W;x_{t})=\left\|\theta_{k}f(x_{t};W)-\theta_{v}x_{t}\right\|^{2}." class="ltx_Math" display="block" id="S3.E12.m1.3"><semantics id="S3.E12.m1.3a"><mrow id="S3.E12.m1.3.3.1" xref="S3.E12.m1.3.3.1.1.cmml"><mrow id="S3.E12.m1.3.3.1.1" xref="S3.E12.m1.3.3.1.1.cmml"><mrow id="S3.E12.m1.3.3.1.1.1" xref="S3.E12.m1.3.3.1.1.1.cmml"><mi id="S3.E12.m1.3.3.1.1.1.3" xref="S3.E12.m1.3.3.1.1.1.3.cmml">L</mi><mo id="S3.E12.m1.3.3.1.1.1.2" xref="S3.E12.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E12.m1.3.3.1.1.1.1.1" xref="S3.E12.m1.3.3.1.1.1.1.2.cmml"><mo id="S3.E12.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E12.m1.3.3.1.1.1.1.2.cmml">(</mo><mi id="S3.E12.m1.1.1" xref="S3.E12.m1.1.1.cmml">W</mi><mo id="S3.E12.m1.3.3.1.1.1.1.1.3" xref="S3.E12.m1.3.3.1.1.1.1.2.cmml">;</mo><msub id="S3.E12.m1.3.3.1.1.1.1.1.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E12.m1.3.3.1.1.1.1.1.4" stretchy="false" xref="S3.E12.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.3.3.1.1.3" xref="S3.E12.m1.3.3.1.1.3.cmml">=</mo><msup id="S3.E12.m1.3.3.1.1.2" xref="S3.E12.m1.3.3.1.1.2.cmml"><mrow id="S3.E12.m1.3.3.1.1.2.1.1" xref="S3.E12.m1.3.3.1.1.2.1.2.cmml"><mo id="S3.E12.m1.3.3.1.1.2.1.1.2" xref="S3.E12.m1.3.3.1.1.2.1.2.1.cmml">‖</mo><mrow id="S3.E12.m1.3.3.1.1.2.1.1.1" xref="S3.E12.m1.3.3.1.1.2.1.1.1.cmml"><mrow id="S3.E12.m1.3.3.1.1.2.1.1.1.1" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.cmml"><msub id="S3.E12.m1.3.3.1.1.2.1.1.1.1.3" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.3.cmml"><mi id="S3.E12.m1.3.3.1.1.2.1.1.1.1.3.2" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.3.2.cmml">θ</mi><mi id="S3.E12.m1.3.3.1.1.2.1.1.1.1.3.3" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.3.3.cmml">k</mi></msub><mo id="S3.E12.m1.3.3.1.1.2.1.1.1.1.2" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E12.m1.3.3.1.1.2.1.1.1.1.4" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.4.cmml">f</mi><mo id="S3.E12.m1.3.3.1.1.2.1.1.1.1.2a" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.1" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.2.cmml"><mo id="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.2" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.3" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.1.3" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.2.cmml">;</mo><mi id="S3.E12.m1.2.2" xref="S3.E12.m1.2.2.cmml">W</mi><mo id="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.1.4" stretchy="false" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.3.3.1.1.2.1.1.1.2" xref="S3.E12.m1.3.3.1.1.2.1.1.1.2.cmml">−</mo><mrow id="S3.E12.m1.3.3.1.1.2.1.1.1.3" xref="S3.E12.m1.3.3.1.1.2.1.1.1.3.cmml"><msub id="S3.E12.m1.3.3.1.1.2.1.1.1.3.2" xref="S3.E12.m1.3.3.1.1.2.1.1.1.3.2.cmml"><mi id="S3.E12.m1.3.3.1.1.2.1.1.1.3.2.2" xref="S3.E12.m1.3.3.1.1.2.1.1.1.3.2.2.cmml">θ</mi><mi id="S3.E12.m1.3.3.1.1.2.1.1.1.3.2.3" xref="S3.E12.m1.3.3.1.1.2.1.1.1.3.2.3.cmml">v</mi></msub><mo id="S3.E12.m1.3.3.1.1.2.1.1.1.3.1" xref="S3.E12.m1.3.3.1.1.2.1.1.1.3.1.cmml">⁢</mo><msub id="S3.E12.m1.3.3.1.1.2.1.1.1.3.3" xref="S3.E12.m1.3.3.1.1.2.1.1.1.3.3.cmml"><mi id="S3.E12.m1.3.3.1.1.2.1.1.1.3.3.2" xref="S3.E12.m1.3.3.1.1.2.1.1.1.3.3.2.cmml">x</mi><mi id="S3.E12.m1.3.3.1.1.2.1.1.1.3.3.3" xref="S3.E12.m1.3.3.1.1.2.1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.E12.m1.3.3.1.1.2.1.1.3" xref="S3.E12.m1.3.3.1.1.2.1.2.1.cmml">‖</mo></mrow><mn id="S3.E12.m1.3.3.1.1.2.3" xref="S3.E12.m1.3.3.1.1.2.3.cmml">2</mn></msup></mrow><mo id="S3.E12.m1.3.3.1.2" lspace="0em" xref="S3.E12.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.3b"><apply id="S3.E12.m1.3.3.1.1.cmml" xref="S3.E12.m1.3.3.1"><eq id="S3.E12.m1.3.3.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.3"></eq><apply id="S3.E12.m1.3.3.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1"><times id="S3.E12.m1.3.3.1.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.1.2"></times><ci id="S3.E12.m1.3.3.1.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.1.3">𝐿</ci><list id="S3.E12.m1.3.3.1.1.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1"><ci id="S3.E12.m1.1.1.cmml" xref="S3.E12.m1.1.1">𝑊</ci><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3">𝑡</ci></apply></list></apply><apply id="S3.E12.m1.3.3.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.2.2.cmml" xref="S3.E12.m1.3.3.1.1.2">superscript</csymbol><apply id="S3.E12.m1.3.3.1.1.2.1.2.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1"><csymbol cd="latexml" id="S3.E12.m1.3.3.1.1.2.1.2.1.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.2">norm</csymbol><apply id="S3.E12.m1.3.3.1.1.2.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1"><minus id="S3.E12.m1.3.3.1.1.2.1.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.2"></minus><apply id="S3.E12.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1"><times id="S3.E12.m1.3.3.1.1.2.1.1.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.2"></times><apply id="S3.E12.m1.3.3.1.1.2.1.1.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.2.1.1.1.1.3.1.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.2.1.1.1.1.3.2.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.3.2">𝜃</ci><ci id="S3.E12.m1.3.3.1.1.2.1.1.1.1.3.3.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.3.3">𝑘</ci></apply><ci id="S3.E12.m1.3.3.1.1.2.1.1.1.1.4.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.4">𝑓</ci><list id="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.1"><apply id="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S3.E12.m1.2.2.cmml" xref="S3.E12.m1.2.2">𝑊</ci></list></apply><apply id="S3.E12.m1.3.3.1.1.2.1.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.3"><times id="S3.E12.m1.3.3.1.1.2.1.1.1.3.1.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.3.1"></times><apply id="S3.E12.m1.3.3.1.1.2.1.1.1.3.2.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.2.1.1.1.3.2.1.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.3.2">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.2.1.1.1.3.2.2.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.3.2.2">𝜃</ci><ci id="S3.E12.m1.3.3.1.1.2.1.1.1.3.2.3.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.3.2.3">𝑣</ci></apply><apply id="S3.E12.m1.3.3.1.1.2.1.1.1.3.3.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.2.1.1.1.3.3.1.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.3.3">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.2.1.1.1.3.3.2.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.3.3.2">𝑥</ci><ci id="S3.E12.m1.3.3.1.1.2.1.1.1.3.3.3.cmml" xref="S3.E12.m1.3.3.1.1.2.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply><cn id="S3.E12.m1.3.3.1.1.2.3.cmml" type="integer" xref="S3.E12.m1.3.3.1.1.2.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.3c">L(W;x_{t})=\left\|\theta_{k}f(x_{t};W)-\theta_{v}x_{t}\right\|^{2}.</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.3d">italic_L ( italic_W ; italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = ∥ italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_f ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ; italic_W ) - italic_θ start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p6.5">This design enables the model to focus on critical features of the input, thereby enhancing its ability to capture complex relationships and long-range dependencies within the data.</p>
</div>
<div class="ltx_para" id="S3.SS1.p7">
<p class="ltx_p" id="S3.SS1.p7.6">Once the weight <math alttext="W_{t}" class="ltx_Math" display="inline" id="S3.SS1.p7.1.m1.1"><semantics id="S3.SS1.p7.1.m1.1a"><msub id="S3.SS1.p7.1.m1.1.1" xref="S3.SS1.p7.1.m1.1.1.cmml"><mi id="S3.SS1.p7.1.m1.1.1.2" xref="S3.SS1.p7.1.m1.1.1.2.cmml">W</mi><mi id="S3.SS1.p7.1.m1.1.1.3" xref="S3.SS1.p7.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.1.m1.1b"><apply id="S3.SS1.p7.1.m1.1.1.cmml" xref="S3.SS1.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p7.1.m1.1.1.1.cmml" xref="S3.SS1.p7.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p7.1.m1.1.1.2.cmml" xref="S3.SS1.p7.1.m1.1.1.2">𝑊</ci><ci id="S3.SS1.p7.1.m1.1.1.3.cmml" xref="S3.SS1.p7.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.1.m1.1c">W_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p7.1.m1.1d">italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> has been updated, the output token <math alttext="z_{t}" class="ltx_Math" display="inline" id="S3.SS1.p7.2.m2.1"><semantics id="S3.SS1.p7.2.m2.1a"><msub id="S3.SS1.p7.2.m2.1.1" xref="S3.SS1.p7.2.m2.1.1.cmml"><mi id="S3.SS1.p7.2.m2.1.1.2" xref="S3.SS1.p7.2.m2.1.1.2.cmml">z</mi><mi id="S3.SS1.p7.2.m2.1.1.3" xref="S3.SS1.p7.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.2.m2.1b"><apply id="S3.SS1.p7.2.m2.1.1.cmml" xref="S3.SS1.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p7.2.m2.1.1.1.cmml" xref="S3.SS1.p7.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p7.2.m2.1.1.2.cmml" xref="S3.SS1.p7.2.m2.1.1.2">𝑧</ci><ci id="S3.SS1.p7.2.m2.1.1.3.cmml" xref="S3.SS1.p7.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.2.m2.1c">z_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p7.2.m2.1d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is generated using the following formula:<math alttext="z_{t}=f(\theta_{q}x_{t};W_{t})" class="ltx_Math" display="inline" id="S3.SS1.p7.3.m3.2"><semantics id="S3.SS1.p7.3.m3.2a"><mrow id="S3.SS1.p7.3.m3.2.2" xref="S3.SS1.p7.3.m3.2.2.cmml"><msub id="S3.SS1.p7.3.m3.2.2.4" xref="S3.SS1.p7.3.m3.2.2.4.cmml"><mi id="S3.SS1.p7.3.m3.2.2.4.2" xref="S3.SS1.p7.3.m3.2.2.4.2.cmml">z</mi><mi id="S3.SS1.p7.3.m3.2.2.4.3" xref="S3.SS1.p7.3.m3.2.2.4.3.cmml">t</mi></msub><mo id="S3.SS1.p7.3.m3.2.2.3" xref="S3.SS1.p7.3.m3.2.2.3.cmml">=</mo><mrow id="S3.SS1.p7.3.m3.2.2.2" xref="S3.SS1.p7.3.m3.2.2.2.cmml"><mi id="S3.SS1.p7.3.m3.2.2.2.4" xref="S3.SS1.p7.3.m3.2.2.2.4.cmml">f</mi><mo id="S3.SS1.p7.3.m3.2.2.2.3" xref="S3.SS1.p7.3.m3.2.2.2.3.cmml">⁢</mo><mrow id="S3.SS1.p7.3.m3.2.2.2.2.2" xref="S3.SS1.p7.3.m3.2.2.2.2.3.cmml"><mo id="S3.SS1.p7.3.m3.2.2.2.2.2.3" stretchy="false" xref="S3.SS1.p7.3.m3.2.2.2.2.3.cmml">(</mo><mrow id="S3.SS1.p7.3.m3.1.1.1.1.1.1" xref="S3.SS1.p7.3.m3.1.1.1.1.1.1.cmml"><msub id="S3.SS1.p7.3.m3.1.1.1.1.1.1.2" xref="S3.SS1.p7.3.m3.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p7.3.m3.1.1.1.1.1.1.2.2" xref="S3.SS1.p7.3.m3.1.1.1.1.1.1.2.2.cmml">θ</mi><mi id="S3.SS1.p7.3.m3.1.1.1.1.1.1.2.3" xref="S3.SS1.p7.3.m3.1.1.1.1.1.1.2.3.cmml">q</mi></msub><mo id="S3.SS1.p7.3.m3.1.1.1.1.1.1.1" xref="S3.SS1.p7.3.m3.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.SS1.p7.3.m3.1.1.1.1.1.1.3" xref="S3.SS1.p7.3.m3.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p7.3.m3.1.1.1.1.1.1.3.2" xref="S3.SS1.p7.3.m3.1.1.1.1.1.1.3.2.cmml">x</mi><mi id="S3.SS1.p7.3.m3.1.1.1.1.1.1.3.3" xref="S3.SS1.p7.3.m3.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.SS1.p7.3.m3.2.2.2.2.2.4" xref="S3.SS1.p7.3.m3.2.2.2.2.3.cmml">;</mo><msub id="S3.SS1.p7.3.m3.2.2.2.2.2.2" xref="S3.SS1.p7.3.m3.2.2.2.2.2.2.cmml"><mi id="S3.SS1.p7.3.m3.2.2.2.2.2.2.2" xref="S3.SS1.p7.3.m3.2.2.2.2.2.2.2.cmml">W</mi><mi id="S3.SS1.p7.3.m3.2.2.2.2.2.2.3" xref="S3.SS1.p7.3.m3.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS1.p7.3.m3.2.2.2.2.2.5" stretchy="false" xref="S3.SS1.p7.3.m3.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.3.m3.2b"><apply id="S3.SS1.p7.3.m3.2.2.cmml" xref="S3.SS1.p7.3.m3.2.2"><eq id="S3.SS1.p7.3.m3.2.2.3.cmml" xref="S3.SS1.p7.3.m3.2.2.3"></eq><apply id="S3.SS1.p7.3.m3.2.2.4.cmml" xref="S3.SS1.p7.3.m3.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p7.3.m3.2.2.4.1.cmml" xref="S3.SS1.p7.3.m3.2.2.4">subscript</csymbol><ci id="S3.SS1.p7.3.m3.2.2.4.2.cmml" xref="S3.SS1.p7.3.m3.2.2.4.2">𝑧</ci><ci id="S3.SS1.p7.3.m3.2.2.4.3.cmml" xref="S3.SS1.p7.3.m3.2.2.4.3">𝑡</ci></apply><apply id="S3.SS1.p7.3.m3.2.2.2.cmml" xref="S3.SS1.p7.3.m3.2.2.2"><times id="S3.SS1.p7.3.m3.2.2.2.3.cmml" xref="S3.SS1.p7.3.m3.2.2.2.3"></times><ci id="S3.SS1.p7.3.m3.2.2.2.4.cmml" xref="S3.SS1.p7.3.m3.2.2.2.4">𝑓</ci><list id="S3.SS1.p7.3.m3.2.2.2.2.3.cmml" xref="S3.SS1.p7.3.m3.2.2.2.2.2"><apply id="S3.SS1.p7.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.p7.3.m3.1.1.1.1.1.1"><times id="S3.SS1.p7.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p7.3.m3.1.1.1.1.1.1.1"></times><apply id="S3.SS1.p7.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p7.3.m3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p7.3.m3.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p7.3.m3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p7.3.m3.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p7.3.m3.1.1.1.1.1.1.2.2">𝜃</ci><ci id="S3.SS1.p7.3.m3.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p7.3.m3.1.1.1.1.1.1.2.3">𝑞</ci></apply><apply id="S3.SS1.p7.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p7.3.m3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p7.3.m3.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p7.3.m3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p7.3.m3.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p7.3.m3.1.1.1.1.1.1.3.2">𝑥</ci><ci id="S3.SS1.p7.3.m3.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p7.3.m3.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S3.SS1.p7.3.m3.2.2.2.2.2.2.cmml" xref="S3.SS1.p7.3.m3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p7.3.m3.2.2.2.2.2.2.1.cmml" xref="S3.SS1.p7.3.m3.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p7.3.m3.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p7.3.m3.2.2.2.2.2.2.2">𝑊</ci><ci id="S3.SS1.p7.3.m3.2.2.2.2.2.2.3.cmml" xref="S3.SS1.p7.3.m3.2.2.2.2.2.2.3">𝑡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.3.m3.2c">z_{t}=f(\theta_{q}x_{t};W_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p7.3.m3.2d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_f ( italic_θ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ; italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>,where <math alttext="\theta_{q}" class="ltx_Math" display="inline" id="S3.SS1.p7.4.m4.1"><semantics id="S3.SS1.p7.4.m4.1a"><msub id="S3.SS1.p7.4.m4.1.1" xref="S3.SS1.p7.4.m4.1.1.cmml"><mi id="S3.SS1.p7.4.m4.1.1.2" xref="S3.SS1.p7.4.m4.1.1.2.cmml">θ</mi><mi id="S3.SS1.p7.4.m4.1.1.3" xref="S3.SS1.p7.4.m4.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.4.m4.1b"><apply id="S3.SS1.p7.4.m4.1.1.cmml" xref="S3.SS1.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p7.4.m4.1.1.1.cmml" xref="S3.SS1.p7.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p7.4.m4.1.1.2.cmml" xref="S3.SS1.p7.4.m4.1.1.2">𝜃</ci><ci id="S3.SS1.p7.4.m4.1.1.3.cmml" xref="S3.SS1.p7.4.m4.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.4.m4.1c">\theta_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p7.4.m4.1d">italic_θ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> is a transformation matrix used to extract key information from the input, and <math alttext="f" class="ltx_Math" display="inline" id="S3.SS1.p7.5.m5.1"><semantics id="S3.SS1.p7.5.m5.1a"><mi id="S3.SS1.p7.5.m5.1.1" xref="S3.SS1.p7.5.m5.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.5.m5.1b"><ci id="S3.SS1.p7.5.m5.1.1.cmml" xref="S3.SS1.p7.5.m5.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.5.m5.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p7.5.m5.1d">italic_f</annotation></semantics></math> is a parametric function, specifically a multi-layer perceptron (MLP) in this model. The use of <math alttext="\theta_{q}" class="ltx_Math" display="inline" id="S3.SS1.p7.6.m6.1"><semantics id="S3.SS1.p7.6.m6.1a"><msub id="S3.SS1.p7.6.m6.1.1" xref="S3.SS1.p7.6.m6.1.1.cmml"><mi id="S3.SS1.p7.6.m6.1.1.2" xref="S3.SS1.p7.6.m6.1.1.2.cmml">θ</mi><mi id="S3.SS1.p7.6.m6.1.1.3" xref="S3.SS1.p7.6.m6.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.6.m6.1b"><apply id="S3.SS1.p7.6.m6.1.1.cmml" xref="S3.SS1.p7.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p7.6.m6.1.1.1.cmml" xref="S3.SS1.p7.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p7.6.m6.1.1.2.cmml" xref="S3.SS1.p7.6.m6.1.1.2">𝜃</ci><ci id="S3.SS1.p7.6.m6.1.1.3.cmml" xref="S3.SS1.p7.6.m6.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.6.m6.1c">\theta_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p7.6.m6.1d">italic_θ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> introduces additional flexibility during inference, allowing the model to emphasize the most informative features in the context.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="128" id="S3.F2.g1" src="extracted/5898954/ttt.png" width="449"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Schematic diagram of the ttt-layer model</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Multi-Resolution Fusion and Frequency Domain Information Integration</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">We introduce a multi-resolution fusion mechanism in Med-TTT that processes the input image through three separate branches: high-resolution, medium-resolution, and low-resolution. The high-resolution branch extracts fine-grained features while maintaining the original resolution of the input image; the medium-resolution branch captures deeper features through downsampling, reducing the image size; and the low-resolution branch further downscales the image, capturing broader contextual information. During feature fusion, information is combined from low to high resolutions.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">The multi-resolution fusion mechanism enables the model to effectively capture details at different scales, ensuring that no critical information is lost when identifying small lesions or structures in medical images. The low-resolution branch, in particular, provides a more global perspective, allowing the model to better handle complex backgrounds in medical imaging.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">Capturing both fine details and distinguishing between background and foreground is critical for medical image segmentation. Therefore, we introduce frequency domain information through high-pass filtering to enhance the model’s ability to identify important features in the image. First, we apply a 2D Fourier Transform to the input image to convert it into the frequency domain, resulting in real and imaginary parts. By calculating the frequency magnitude, we can identify high-frequency components, which often correspond to edges, textures, and detailed information in the image. Next, a high-pass filter is applied to retain only the high-frequency components, filtering out low-frequency background noise, thus extracting features crucial for the segmentation task.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1">By incorporating high-pass filtered frequency domain information, the details and edge features in the image are enhanced, helping the model to more accurately identify lesion areas during segmentation. Moreover, integrating high-frequency information with features from other branches further enriches the model’s feature representation, enabling it to capture subtle but significant variations in complex medical images.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Loss function</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.2">Med-TTT is proposed as a means of obtaining more stable results and higher accuracy in medical image segmentation tasks. Therefore, we employ the Diceloss and Cross-entropy loss function, which are the most elementary in medical image analysis. We then combine these two elements. By calculating the loss at the batch level, we have devised a loss function that can mitigate the fluctuations in loss observed for individual samples, which may be attributable to random noise or misclassification of minor structures. This enables the model to converge in a more stable manner. Furthermore, it can enhance the overall segmentation performance, particularly in scenarios where data distribution is uneven, and facilitate more accurate weighting of different samples. The specific loss function is presented in (<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#S3.E13" title="In 3.3 Loss function ‣ 3 Method ‣ Med-TTT: Vision Test-Time Training model for Medical Image Segmentation"><span class="ltx_text ltx_ref_tag">13</span></a>).<math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_α</annotation></semantics></math> refer to the weights of loss functions, which is set to <math alttext="0.5" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mn id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><cn id="S3.SS3.p1.2.m2.1.1.cmml" type="float" xref="S3.SS3.p1.2.m2.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">0.5</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">0.5</annotation></semantics></math> by default.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\left\{\begin{aligned} \text{Loss}_{\text{B}}&amp;=(1-\alpha)\times\text{CE}_{%
\text{B}}+\alpha\times\text{Dice Loss}_{\text{B}}\\
\mathrm{CE}_{\mathrm{B}}&amp;=-\frac{1}{B}\sum_{b=1}^{B}\text{Target}_{b}\log(%
\text{Input}_{b})\\
\text{Dice loss}_{\text{B}}&amp;=1-\frac{2\sum_{b=1}^{B}\mathrm{Input}_{b}\times%
\mathrm{Target}_{b}}{\sum_{b=1}^{B}\left(\mathrm{Input}_{b}+\mathrm{Target}_{b%
}\right)+\epsilon}\end{aligned}\right." class="ltx_math_unparsed" display="block" id="S3.E13.m1.4"><semantics id="S3.E13.m1.4a"><mrow id="S3.E13.m1.4b"><mo id="S3.E13.m1.4.5">{</mo><mtable columnspacing="0pt" displaystyle="true" id="S3.E13.m1.4.4" rowspacing="0pt"><mtr id="S3.E13.m1.4.4a"><mtd class="ltx_align_right" columnalign="right" id="S3.E13.m1.4.4b"><msub id="S3.E13.m1.1.1.1.2.1"><mtext id="S3.E13.m1.1.1.1.2.1.2">Loss</mtext><mtext id="S3.E13.m1.1.1.1.2.1.3">B</mtext></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E13.m1.4.4c"><mrow id="S3.E13.m1.1.1.1.1.1"><mi id="S3.E13.m1.1.1.1.1.1.3"></mi><mo id="S3.E13.m1.1.1.1.1.1.2">=</mo><mrow id="S3.E13.m1.1.1.1.1.1.1"><mrow id="S3.E13.m1.1.1.1.1.1.1.1"><mrow id="S3.E13.m1.1.1.1.1.1.1.1.1.1"><mo id="S3.E13.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false">(</mo><mrow id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1"><mn id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.2">1</mn><mo id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1">−</mo><mi id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.3">α</mi></mrow><mo id="S3.E13.m1.1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false">)</mo></mrow><mo id="S3.E13.m1.1.1.1.1.1.1.1.2" rspace="0.222em">×</mo><msub id="S3.E13.m1.1.1.1.1.1.1.1.3"><mtext id="S3.E13.m1.1.1.1.1.1.1.1.3.2">CE</mtext><mtext id="S3.E13.m1.1.1.1.1.1.1.1.3.3">B</mtext></msub></mrow><mo id="S3.E13.m1.1.1.1.1.1.1.2">+</mo><mrow id="S3.E13.m1.1.1.1.1.1.1.3"><mi id="S3.E13.m1.1.1.1.1.1.1.3.2">α</mi><mo id="S3.E13.m1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em">×</mo><msub id="S3.E13.m1.1.1.1.1.1.1.3.3"><mtext id="S3.E13.m1.1.1.1.1.1.1.3.3.2">Dice Loss</mtext><mtext id="S3.E13.m1.1.1.1.1.1.1.3.3.3">B</mtext></msub></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E13.m1.4.4d"><mtd class="ltx_align_right" columnalign="right" id="S3.E13.m1.4.4e"><msub id="S3.E13.m1.3.3.3.3.1"><mi id="S3.E13.m1.3.3.3.3.1.2">CE</mi><mi id="S3.E13.m1.3.3.3.3.1.3" mathvariant="normal">B</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E13.m1.4.4f"><mrow id="S3.E13.m1.3.3.3.2.2"><mi id="S3.E13.m1.3.3.3.2.2.4"></mi><mo id="S3.E13.m1.3.3.3.2.2.3">=</mo><mrow id="S3.E13.m1.3.3.3.2.2.2"><mo id="S3.E13.m1.3.3.3.2.2.2a">−</mo><mrow id="S3.E13.m1.3.3.3.2.2.2.1"><mfrac id="S3.E13.m1.3.3.3.2.2.2.1.3"><mn id="S3.E13.m1.3.3.3.2.2.2.1.3.2">1</mn><mi id="S3.E13.m1.3.3.3.2.2.2.1.3.3">B</mi></mfrac><mo id="S3.E13.m1.3.3.3.2.2.2.1.2">⁢</mo><mrow id="S3.E13.m1.3.3.3.2.2.2.1.1"><munderover id="S3.E13.m1.3.3.3.2.2.2.1.1.2"><mo id="S3.E13.m1.3.3.3.2.2.2.1.1.2.2.2" movablelimits="false">∑</mo><mrow id="S3.E13.m1.3.3.3.2.2.2.1.1.2.2.3"><mi id="S3.E13.m1.3.3.3.2.2.2.1.1.2.2.3.2">b</mi><mo id="S3.E13.m1.3.3.3.2.2.2.1.1.2.2.3.1">=</mo><mn id="S3.E13.m1.3.3.3.2.2.2.1.1.2.2.3.3">1</mn></mrow><mi id="S3.E13.m1.3.3.3.2.2.2.1.1.2.3">B</mi></munderover><mrow id="S3.E13.m1.3.3.3.2.2.2.1.1.1"><msub id="S3.E13.m1.3.3.3.2.2.2.1.1.1.3"><mtext id="S3.E13.m1.3.3.3.2.2.2.1.1.1.3.2">Target</mtext><mi id="S3.E13.m1.3.3.3.2.2.2.1.1.1.3.3">b</mi></msub><mo id="S3.E13.m1.3.3.3.2.2.2.1.1.1.2" lspace="0.167em">⁢</mo><mrow id="S3.E13.m1.3.3.3.2.2.2.1.1.1.1.1"><mi id="S3.E13.m1.2.2.2.1.1.1">log</mi><mo id="S3.E13.m1.3.3.3.2.2.2.1.1.1.1.1a">⁡</mo><mrow id="S3.E13.m1.3.3.3.2.2.2.1.1.1.1.1.1"><mo id="S3.E13.m1.3.3.3.2.2.2.1.1.1.1.1.1.2" stretchy="false">(</mo><msub id="S3.E13.m1.3.3.3.2.2.2.1.1.1.1.1.1.1"><mtext id="S3.E13.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.2">Input</mtext><mi id="S3.E13.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.3">b</mi></msub><mo id="S3.E13.m1.3.3.3.2.2.2.1.1.1.1.1.1.3" stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E13.m1.4.4g"><mtd class="ltx_align_right" columnalign="right" id="S3.E13.m1.4.4h"><msub id="S3.E13.m1.4.4.4.2.1"><mtext id="S3.E13.m1.4.4.4.2.1.2">Dice loss</mtext><mtext id="S3.E13.m1.4.4.4.2.1.3">B</mtext></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E13.m1.4.4i"><mrow id="S3.E13.m1.4.4.4.1.1"><mi id="S3.E13.m1.4.4.4.1.1.3"></mi><mo id="S3.E13.m1.4.4.4.1.1.2">=</mo><mrow id="S3.E13.m1.4.4.4.1.1.4"><mn id="S3.E13.m1.4.4.4.1.1.4.2">1</mn><mo id="S3.E13.m1.4.4.4.1.1.4.1">−</mo><mfrac id="S3.E13.m1.4.4.4.1.1.1"><mrow id="S3.E13.m1.4.4.4.1.1.1.3"><mn id="S3.E13.m1.4.4.4.1.1.1.3.2">2</mn><mo id="S3.E13.m1.4.4.4.1.1.1.3.1">⁢</mo><mrow id="S3.E13.m1.4.4.4.1.1.1.3.3"><msubsup id="S3.E13.m1.4.4.4.1.1.1.3.3.1"><mo id="S3.E13.m1.4.4.4.1.1.1.3.3.1.2.2">∑</mo><mrow id="S3.E13.m1.4.4.4.1.1.1.3.3.1.2.3"><mi id="S3.E13.m1.4.4.4.1.1.1.3.3.1.2.3.2">b</mi><mo id="S3.E13.m1.4.4.4.1.1.1.3.3.1.2.3.1">=</mo><mn id="S3.E13.m1.4.4.4.1.1.1.3.3.1.2.3.3">1</mn></mrow><mi id="S3.E13.m1.4.4.4.1.1.1.3.3.1.3">B</mi></msubsup><mrow id="S3.E13.m1.4.4.4.1.1.1.3.3.2"><msub id="S3.E13.m1.4.4.4.1.1.1.3.3.2.2"><mi id="S3.E13.m1.4.4.4.1.1.1.3.3.2.2.2">Input</mi><mi id="S3.E13.m1.4.4.4.1.1.1.3.3.2.2.3">b</mi></msub><mo id="S3.E13.m1.4.4.4.1.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em">×</mo><msub id="S3.E13.m1.4.4.4.1.1.1.3.3.2.3"><mi id="S3.E13.m1.4.4.4.1.1.1.3.3.2.3.2">Target</mi><mi id="S3.E13.m1.4.4.4.1.1.1.3.3.2.3.3">b</mi></msub></mrow></mrow></mrow><mrow id="S3.E13.m1.4.4.4.1.1.1.1"><mrow id="S3.E13.m1.4.4.4.1.1.1.1.1"><msubsup id="S3.E13.m1.4.4.4.1.1.1.1.1.2"><mo id="S3.E13.m1.4.4.4.1.1.1.1.1.2.2.2">∑</mo><mrow id="S3.E13.m1.4.4.4.1.1.1.1.1.2.2.3"><mi id="S3.E13.m1.4.4.4.1.1.1.1.1.2.2.3.2">b</mi><mo id="S3.E13.m1.4.4.4.1.1.1.1.1.2.2.3.1">=</mo><mn id="S3.E13.m1.4.4.4.1.1.1.1.1.2.2.3.3">1</mn></mrow><mi id="S3.E13.m1.4.4.4.1.1.1.1.1.2.3">B</mi></msubsup><mrow id="S3.E13.m1.4.4.4.1.1.1.1.1.1.1"><mo id="S3.E13.m1.4.4.4.1.1.1.1.1.1.1.2" lspace="0em">(</mo><mrow id="S3.E13.m1.4.4.4.1.1.1.1.1.1.1.1"><msub id="S3.E13.m1.4.4.4.1.1.1.1.1.1.1.1.2"><mi id="S3.E13.m1.4.4.4.1.1.1.1.1.1.1.1.2.2">Input</mi><mi id="S3.E13.m1.4.4.4.1.1.1.1.1.1.1.1.2.3">b</mi></msub><mo id="S3.E13.m1.4.4.4.1.1.1.1.1.1.1.1.1">+</mo><msub id="S3.E13.m1.4.4.4.1.1.1.1.1.1.1.1.3"><mi id="S3.E13.m1.4.4.4.1.1.1.1.1.1.1.1.3.2">Target</mi><mi id="S3.E13.m1.4.4.4.1.1.1.1.1.1.1.1.3.3">b</mi></msub></mrow><mo id="S3.E13.m1.4.4.4.1.1.1.1.1.1.1.3">)</mo></mrow></mrow><mo id="S3.E13.m1.4.4.4.1.1.1.1.2">+</mo><mi id="S3.E13.m1.4.4.4.1.1.1.1.3">ϵ</mi></mrow></mfrac></mrow></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex" id="S3.E13.m1.4c">\left\{\begin{aligned} \text{Loss}_{\text{B}}&amp;=(1-\alpha)\times\text{CE}_{%
\text{B}}+\alpha\times\text{Dice Loss}_{\text{B}}\\
\mathrm{CE}_{\mathrm{B}}&amp;=-\frac{1}{B}\sum_{b=1}^{B}\text{Target}_{b}\log(%
\text{Input}_{b})\\
\text{Dice loss}_{\text{B}}&amp;=1-\frac{2\sum_{b=1}^{B}\mathrm{Input}_{b}\times%
\mathrm{Target}_{b}}{\sum_{b=1}^{B}\left(\mathrm{Input}_{b}+\mathrm{Target}_{b%
}\right)+\epsilon}\end{aligned}\right.</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.4d">{ start_ROW start_CELL Loss start_POSTSUBSCRIPT B end_POSTSUBSCRIPT end_CELL start_CELL = ( 1 - italic_α ) × CE start_POSTSUBSCRIPT B end_POSTSUBSCRIPT + italic_α × Dice Loss start_POSTSUBSCRIPT B end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL roman_CE start_POSTSUBSCRIPT roman_B end_POSTSUBSCRIPT end_CELL start_CELL = - divide start_ARG 1 end_ARG start_ARG italic_B end_ARG ∑ start_POSTSUBSCRIPT italic_b = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_B end_POSTSUPERSCRIPT Target start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT roman_log ( Input start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL Dice loss start_POSTSUBSCRIPT B end_POSTSUBSCRIPT end_CELL start_CELL = 1 - divide start_ARG 2 ∑ start_POSTSUBSCRIPT italic_b = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_B end_POSTSUPERSCRIPT roman_Input start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT × roman_Target start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_b = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_B end_POSTSUPERSCRIPT ( roman_Input start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT + roman_Target start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ) + italic_ϵ end_ARG end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiment</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">We conduct comprehensive experiments on Med-TTT for medical image segmentation tasks. Specifically, we evaluate the performance of Med-TTT on medical image segmentation tasks on the ISIC17 and ISIC18 datasets.</p>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">ISIC2017</span>:The ISIC2017 dataset contains three categories of diseases, melanoma, seborrheic keratosis, and benign nevus, 2,750 images, ground truth, and category labels. There are 2,000 images in the training set, 150 images in the validation set, and 600 images in the test set, and the color depth of the skin disease images is 24 bits, and the image sizes range from 767×576 to 6,621×4,441. The validation and test sets also include unlabeled hyperpixel images. The category labels are stored in tables and the datasets need to be preprocessed before training the model.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1">ISIC2018</span>:The ISIC2018 dataset contains different numbers of disease images for classification and segmentation, for the segmentation task, a total of 2,594 images were used as the training set, and 100 and 1,000 images were used as the validation and test sets, respectively. For the classification task, a total of 12,500 images were included, of which the training set contained a total of 10,015 images of 7 categories of diseases, namely actinic keratoses (327), basal cell carcinoma (514), benign keratoses (1,099), dermatofibromas (115), melanomas (1,113), melanocytic naevi (6,705), and vascular skin lesions (142). The seven classes of images in the classification task dataset are mixed in the same folder, and the labels are stored in tables that require preprocessing.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Comparison with SOTA models</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We compare Med-TTT with some state-of-the-art models and some recent mamba-based model, presenting the experimental results in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#S4.T1" title="Table 1 ‣ 4.2 Comparison with SOTA models ‣ 4 Experiment ‣ Med-TTT: Vision Test-Time Training model for Medical Image Segmentation"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">For the ISIC2017 and ISIC2018 datasets, Med-TTT performs well on mIoU and Dice compared to other models. Specifically, Med-TTT has a 1.01% and 0.78% advantage over HC-Mamba on mIoU and Dice, respectively, while it has a 1.85% and 2.17% advantage over Unet on mIoU and Dice.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Comparative experimental results on the ISIC18 dataset. (<span class="ltx_text ltx_font_bold" id="S4.T1.7.1">Bold</span> indicates the best.)</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.5.5">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.5.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.5.5.5.6" style="padding:1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.5.5.5.6.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.5.5.5.7" style="padding:1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.5.5.5.7.1">Model</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1" style="padding:1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.1">mIoU(%)<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.1.1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.1.1.m1.1a"><mo id="S4.T1.1.1.1.1.1.m1.1.1" stretchy="false" xref="S4.T1.1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.1.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.2.2.2" style="padding:1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.2.2.1">DSC(%)<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.2.2.2.2.1.m1.1"><semantics id="S4.T1.2.2.2.2.1.m1.1a"><mo id="S4.T1.2.2.2.2.1.m1.1.1" stretchy="false" xref="S4.T1.2.2.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.2.1.m1.1b"><ci id="S4.T1.2.2.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.2.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.2.2.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.3.3" style="padding:1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.3.3.3.1">Acc(%)<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.3.3.3.3.1.m1.1"><semantics id="S4.T1.3.3.3.3.1.m1.1a"><mo id="S4.T1.3.3.3.3.1.m1.1.1" stretchy="false" xref="S4.T1.3.3.3.3.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.3.1.m1.1b"><ci id="S4.T1.3.3.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.3.3.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.3.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.3.3.3.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.4.4.4" style="padding:1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.4.4.4.4.1">Spe(%)<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.4.4.4.4.1.m1.1"><semantics id="S4.T1.4.4.4.4.1.m1.1a"><mo id="S4.T1.4.4.4.4.1.m1.1.1" stretchy="false" xref="S4.T1.4.4.4.4.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.4.1.m1.1b"><ci id="S4.T1.4.4.4.4.1.m1.1.1.cmml" xref="S4.T1.4.4.4.4.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.4.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.4.4.4.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.5.5.5" style="padding:1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.5.5.5.5.1">Sen(%)<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.5.5.5.5.1.m1.1"><semantics id="S4.T1.5.5.5.5.1.m1.1a"><mo id="S4.T1.5.5.5.5.1.m1.1.1" stretchy="false" xref="S4.T1.5.5.5.5.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.5.5.1.m1.1b"><ci id="S4.T1.5.5.5.5.1.m1.1.1.cmml" xref="S4.T1.5.5.5.5.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.5.5.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.5.5.5.1.m1.1d">↑</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.5.6.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.5.5.6.1.1" rowspan="5" style="padding:1.25pt 3.0pt;"><span class="ltx_text" id="S4.T1.5.5.6.1.1.1">ISIC17</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.5.5.6.1.2" style="padding:1.25pt 3.0pt;">UNet<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib5" title="">5</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.5.6.1.3" style="padding:1.25pt 3.0pt;">76.98</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.5.6.1.4" style="padding:1.25pt 3.0pt;">85.99</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.5.6.1.5" style="padding:1.25pt 3.0pt;">94.65</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.5.6.1.6" style="padding:1.25pt 3.0pt;">97.43</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.5.6.1.7" style="padding:1.25pt 3.0pt;">86.82</td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.5.7.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.5.5.7.2.1" style="padding:1.25pt 3.0pt;">UTNetV2<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib16" title="">16</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.7.2.2" style="padding:1.25pt 3.0pt;">76.35</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.7.2.3" style="padding:1.25pt 3.0pt;">86.23</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.7.2.4" style="padding:1.25pt 3.0pt;">94.84</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.7.2.5" style="padding:1.25pt 3.0pt;">98.05</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.7.2.6" style="padding:1.25pt 3.0pt;">84.85</td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.5.8.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.5.5.8.3.1" style="padding:1.25pt 3.0pt;">TransFuse<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib9" title="">9</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.8.3.2" style="padding:1.25pt 3.0pt;">77.21</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.8.3.3" style="padding:1.25pt 3.0pt;">86.40</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.8.3.4" style="padding:1.25pt 3.0pt;">95.17</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.8.3.5" style="padding:1.25pt 3.0pt;">97.98</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.8.3.6" style="padding:1.25pt 3.0pt;">86.14</td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.5.9.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.5.5.9.4.1" style="padding:1.25pt 3.0pt;">MALUNet<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib17" title="">17</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.9.4.2" style="padding:1.25pt 3.0pt;">76.78</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.9.4.3" style="padding:1.25pt 3.0pt;">87.13</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.9.4.4" style="padding:1.25pt 3.0pt;">95.18</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.9.4.5" style="padding:1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.5.5.9.4.5.1">98.47</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.9.4.6" style="padding:1.25pt 3.0pt;">84.78</td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.5.10.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.5.5.10.5.1" style="padding:1.25pt 3.0pt;">VM-UNet<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib18" title="">18</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.10.5.2" style="padding:1.25pt 3.0pt;">77.59</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.10.5.3" style="padding:1.25pt 3.0pt;">87.03</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.10.5.4" style="padding:1.25pt 3.0pt;">95.40</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.10.5.5" style="padding:1.25pt 3.0pt;">97.47</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.10.5.6" style="padding:1.25pt 3.0pt;">86.13</td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.5.11.6">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="S4.T1.5.5.11.6.1" style="padding:1.25pt 3.0pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.5.5.11.6.2" style="padding:1.25pt 3.0pt;">HC-Mamba<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib19" title="">19</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.11.6.3" style="padding:1.25pt 3.0pt;">77.88</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.11.6.4" style="padding:1.25pt 3.0pt;">87.38</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.11.6.5" style="padding:1.25pt 3.0pt;">95.17</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.11.6.6" style="padding:1.25pt 3.0pt;">97.47</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.11.6.7" style="padding:1.25pt 3.0pt;">86.99</td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.5.12.7">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="S4.T1.5.5.12.7.1" style="padding:1.25pt 3.0pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.5.5.12.7.2" style="padding:1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.5.5.12.7.2.1">Med-TTT</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.12.7.3" style="padding:1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.5.5.12.7.3.1">78.83</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.12.7.4" style="padding:1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.5.5.12.7.4.1">88.16</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.12.7.5" style="padding:1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.5.5.12.7.5.1">96.07</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.12.7.6" style="padding:1.25pt 3.0pt;">97.86</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.12.7.7" style="padding:1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.5.5.12.7.7.1">87.21</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.5.13.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_tt" id="S4.T1.5.5.13.8.1" rowspan="8" style="padding:1.25pt 3.0pt;"><span class="ltx_text" id="S4.T1.5.5.13.8.1.1">ISIC18</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T1.5.5.13.8.2" style="padding:1.25pt 3.0pt;">UNet<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib5" title="">5</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.5.5.13.8.3" style="padding:1.25pt 3.0pt;">77.86</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.5.5.13.8.4" style="padding:1.25pt 3.0pt;">87.55</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.5.5.13.8.5" style="padding:1.25pt 3.0pt;">94.05</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.5.5.13.8.6" style="padding:1.25pt 3.0pt;">96.69</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.5.5.13.8.7" style="padding:1.25pt 3.0pt;">85.86</td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.5.14.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.5.5.14.9.1" style="padding:1.25pt 3.0pt;">UNet++ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib20" title="">20</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.14.9.2" style="padding:1.25pt 3.0pt;">76.31</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.14.9.3" style="padding:1.25pt 3.0pt;">85.83</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.14.9.4" style="padding:1.25pt 3.0pt;">94.02</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.14.9.5" style="padding:1.25pt 3.0pt;">95.75</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.14.9.6" style="padding:1.25pt 3.0pt;">88.65</td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.5.15.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.5.5.15.10.1" style="padding:1.25pt 3.0pt;">Att-UNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib21" title="">21</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.15.10.2" style="padding:1.25pt 3.0pt;">76.43</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.15.10.3" style="padding:1.25pt 3.0pt;">86.91</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.15.10.4" style="padding:1.25pt 3.0pt;">94.13</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.15.10.5" style="padding:1.25pt 3.0pt;">96.23</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.15.10.6" style="padding:1.25pt 3.0pt;">87.60</td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.5.16.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.5.5.16.11.1" style="padding:1.25pt 3.0pt;">SANet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib22" title="">22</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.16.11.2" style="padding:1.25pt 3.0pt;">77.52</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.16.11.3" style="padding:1.25pt 3.0pt;">86.59</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.16.11.4" style="padding:1.25pt 3.0pt;">93.39</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.16.11.5" style="padding:1.25pt 3.0pt;">95.97</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.16.11.6" style="padding:1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.5.5.16.11.6.1">89.46</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.5.17.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.5.5.17.12.1" style="padding:1.25pt 3.0pt;">VM-UNet<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib18" title="">18</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.17.12.2" style="padding:1.25pt 3.0pt;">77.95</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.17.12.3" style="padding:1.25pt 3.0pt;">87.61</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.17.12.4" style="padding:1.25pt 3.0pt;">94.13</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.17.12.5" style="padding:1.25pt 3.0pt;">96.94</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.17.12.6" style="padding:1.25pt 3.0pt;">85.23</td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.5.18.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.5.5.18.13.1" style="padding:1.25pt 3.0pt;">HC-Mamba<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#bib.bib19" title="">19</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.18.13.2" style="padding:1.25pt 3.0pt;">78.42</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.18.13.3" style="padding:1.25pt 3.0pt;">87.89</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.18.13.4" style="padding:1.25pt 3.0pt;">94.24</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.18.13.5" style="padding:1.25pt 3.0pt;">96.98</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.18.13.6" style="padding:1.25pt 3.0pt;">88.90</td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.5.19.14">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T1.5.5.19.14.1" style="padding:1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.5.5.19.14.1.1">Med-TTT</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.5.5.19.14.2" style="padding:1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.5.5.19.14.2.1">78.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.5.5.19.14.3" style="padding:1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.5.5.19.14.3.1">88.01</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.5.5.19.14.4" style="padding:1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.5.5.19.14.4.1">94.30</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.5.5.19.14.5" style="padding:1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.5.5.19.14.5.1">96.98</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.5.5.19.14.6" style="padding:1.25pt 3.0pt;">85.95</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Ablation experiments</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We conducted ablation experiments on the proposed Med-TTT by systematically evaluating the impact of each individual component on the overall performance of the model, and the results are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02523v1#S4.T2" title="Table 2 ‣ 4.3 Ablation experiments ‣ 4 Experiment ‣ Med-TTT: Vision Test-Time Training model for Medical Image Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a>.In Settings I and III, the results are suboptimal due to the removal of the Multi-resolution block(MR-block), which result in a reduction in the ability to extract features. Furthermore, Setting II is less effective in comparison to Med-TTT due to the failure to incorporate frequency information(FFF), which results in its inability to utilize global information and to recognize the crucial information embedded in the frequency domain.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Comparison of different settings on the proposed Med-TTT</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.8">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.8.9.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T2.8.9.1.1"><span class="ltx_text ltx_font_bold" id="S4.T2.8.9.1.1.1">Settings</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.8.9.1.2"><span class="ltx_text ltx_font_bold" id="S4.T2.8.9.1.2.1">MR-block</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.8.9.1.3"><span class="ltx_text ltx_font_bold" id="S4.T2.8.9.1.3.1">FFF</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.8.9.1.4"><span class="ltx_text ltx_font_bold" id="S4.T2.8.9.1.4.1">TTT</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.8.9.1.5"><span class="ltx_text ltx_font_bold" id="S4.T2.8.9.1.5.1">mIoU(%)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.8.9.1.6"><span class="ltx_text ltx_font_bold" id="S4.T2.8.9.1.6.1">Dice(%)</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.1.1.2">I</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.4">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1"><math alttext="\checkmark" class="ltx_Math" display="inline" id="S4.T2.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.m1.1a"><mi id="S4.T2.1.1.1.m1.1.1" mathvariant="normal" xref="S4.T2.1.1.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.m1.1d">✓</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.5">68.63</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.6">80.62</td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.3.3.3">II</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.2.1"><math alttext="\checkmark" class="ltx_Math" display="inline" id="S4.T2.2.2.1.m1.1"><semantics id="S4.T2.2.2.1.m1.1a"><mi id="S4.T2.2.2.1.m1.1.1" mathvariant="normal" xref="S4.T2.2.2.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.1.m1.1b"><ci id="S4.T2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.1.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.1.m1.1d">✓</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.4">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.2"><math alttext="\checkmark" class="ltx_Math" display="inline" id="S4.T2.3.3.2.m1.1"><semantics id="S4.T2.3.3.2.m1.1a"><mi id="S4.T2.3.3.2.m1.1.1" mathvariant="normal" xref="S4.T2.3.3.2.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.2.m1.1b"><ci id="S4.T2.3.3.2.m1.1.1.cmml" xref="S4.T2.3.3.2.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.2.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.3.2.m1.1d">✓</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.5">77.44</td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.6">85.48</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.5.5.3">III</th>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.4">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.1"><math alttext="\checkmark" class="ltx_Math" display="inline" id="S4.T2.4.4.1.m1.1"><semantics id="S4.T2.4.4.1.m1.1a"><mi id="S4.T2.4.4.1.m1.1.1" mathvariant="normal" xref="S4.T2.4.4.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.1.m1.1b"><ci id="S4.T2.4.4.1.m1.1.1.cmml" xref="S4.T2.4.4.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.1.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.4.1.m1.1d">✓</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.2"><math alttext="\checkmark" class="ltx_Math" display="inline" id="S4.T2.5.5.2.m1.1"><semantics id="S4.T2.5.5.2.m1.1a"><mi id="S4.T2.5.5.2.m1.1.1" mathvariant="normal" xref="S4.T2.5.5.2.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.2.m1.1b"><ci id="S4.T2.5.5.2.m1.1.1.cmml" xref="S4.T2.5.5.2.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.2.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.5.2.m1.1d">✓</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.5">75.54</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.6">84.12</td>
</tr>
<tr class="ltx_tr" id="S4.T2.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T2.8.8.4">Med-TTT</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.6.6.1"><math alttext="\checkmark" class="ltx_Math" display="inline" id="S4.T2.6.6.1.m1.1"><semantics id="S4.T2.6.6.1.m1.1a"><mi id="S4.T2.6.6.1.m1.1.1" mathvariant="normal" xref="S4.T2.6.6.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.1.m1.1b"><ci id="S4.T2.6.6.1.m1.1.1.cmml" xref="S4.T2.6.6.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.1.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="S4.T2.6.6.1.m1.1d">✓</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.7.7.2"><math alttext="\checkmark" class="ltx_Math" display="inline" id="S4.T2.7.7.2.m1.1"><semantics id="S4.T2.7.7.2.m1.1a"><mi id="S4.T2.7.7.2.m1.1.1" mathvariant="normal" xref="S4.T2.7.7.2.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S4.T2.7.7.2.m1.1b"><ci id="S4.T2.7.7.2.m1.1.1.cmml" xref="S4.T2.7.7.2.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.7.2.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="S4.T2.7.7.2.m1.1d">✓</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.8.8.3"><math alttext="\checkmark" class="ltx_Math" display="inline" id="S4.T2.8.8.3.m1.1"><semantics id="S4.T2.8.8.3.m1.1a"><mi id="S4.T2.8.8.3.m1.1.1" mathvariant="normal" xref="S4.T2.8.8.3.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S4.T2.8.8.3.m1.1b"><ci id="S4.T2.8.8.3.m1.1.1.cmml" xref="S4.T2.8.8.3.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.8.3.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="S4.T2.8.8.3.m1.1d">✓</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.8.8.5">78.83</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.8.8.6">88.16</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We propose a new medical image segmentation model Med TTT, which integrates a Test Time Training (TTT) layer, multi-resolution fusion mechanism, and frequency domain information to address the limitations of existing CNN and Transformer based models. The Vision-TTT layer, which allows for dynamic parameter adaptation during testing, effectively models long-range dependencies while maintaining linear computational complexity. Furthermore, the incorporation of multi-resolution fusion and high-pass filtered frequency domain features significantly enhances the model’s ability to capture detailed texture and complex patterns in medical images. Extensive experiments on multiple datasets demonstrate that Med-TTT achieves superior performance in terms of accuracy, mIoU, and DSC, particularly in challenging segmentation scenarios. The results validate the effectiveness and robustness of the proposed model, making it a valuable contribution to the field of medical image analysis. Future work will explore the application of Med-TTT to additional medical imaging modalities and further enhance its generalization capabilities.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Geert Litjens, Thijs Kooi, Babak Ehteshami Bejnordi, Arnaud Arindra Adiyoso Setio, Francesco Ciompi, Mohsen Ghafoorian, Jeroen Awm Van Der Laak, Bram Van Ginneken, and Clara I Sánchez.

</span>
<span class="ltx_bibblock">A survey on deep learning in medical image analysis.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">Medical image analysis</span>, 42:60–88, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Xuxin Chen, Ximin Wang, Ke Zhang, Kar-Ming Fung, Theresa C Thai, Kathleen Moore, Robert S Mannel, Hong Liu, Bin Zheng, and Yuchen Qiu.

</span>
<span class="ltx_bibblock">Recent advances and clinical applications of deep learning in medical image analysis.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib2.1.1">Medical Image Analysis</span>, 79:102444, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Hoo-Chang Shin, Holger R Roth, Mingchen Gao, Le Lu, Ziyue Xu, Isabella Nogues, Jianhua Yao, Daniel Mollura, and Ronald M Summers.

</span>
<span class="ltx_bibblock">Deep convolutional neural networks for computer-aided detection: Cnn architectures, dataset characteristics and transfer learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">IEEE transactions on medical imaging</span>, 35(5):1285–1298, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Jindong Sun, Yanjun Peng, Yanfei Guo, and Dapeng Li.

</span>
<span class="ltx_bibblock">Segmentation of the multimodal brain tumor image used the multi-pathway architecture method based on 3d fcn.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">Neurocomputing</span>, 423:34–45, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Olaf Ronneberger, Philipp Fischer, and Thomas Brox.

</span>
<span class="ltx_bibblock">U-net: Convolutional networks for biomedical image segmentation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">Medical image computing and computer-assisted intervention–MICCAI 2015: 18th international conference, Munich, Germany, October 5-9, 2015, proceedings, part III 18</span>, pages 234–241. Springer, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Abhishek Raj, Jahan Malik, Praneeth Sai Kumar Tondepu, Ashish Kumar, Sumit Bujare, et al.

</span>
<span class="ltx_bibblock">An enhanced approach on brain tumor segmentation by the use of deep learning.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">2022 13th International Conference on Computing Communication and Networking Technologies (ICCCNT)</span>, pages 1–8. IEEE, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Asad Safi, Milan Dordevic, Reem Atassi, and Fuad AlHosban.

</span>
<span class="ltx_bibblock">An accurate brain tumor segmentation using deep learning.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">2023 9th International Conference on Information Technology Trends (ITT)</span>, pages 187–192. IEEE, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Jieneng Chen, Yongyi Lu, Qihang Yu, Xiangde Luo, Ehsan Adeli, Yan Wang, Le Lu, Alan L Yuille, and Yuyin Zhou.

</span>
<span class="ltx_bibblock">Transunet: Transformers make strong encoders for medical image segmentation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2102.04306</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Yundong Zhang, Huiye Liu, and Qiang Hu.

</span>
<span class="ltx_bibblock">Transfuse: Fusing transformers and cnns for medical image segmentation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">Medical Image Computing and Computer Assisted Intervention–MICCAI 2021: 24th International Conference, Strasbourg, France, September 27–October 1, 2021, Proceedings, Part I 24</span>, pages 14–24. Springer, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Hu Cao, Yueyue Wang, Joy Chen, Dongsheng Jiang, Xiaopeng Zhang, Qi Tian, and Manning Wang.

</span>
<span class="ltx_bibblock">Swin-unet: Unet-like pure transformer for medical image segmentation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">European conference on computer vision</span>, pages 205–218. Springer, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Yu Sun, Xinhao Li, Karan Dalal, Jiarui Xu, Arjun Vikram, Genghan Zhang, Yann Dubois, Xinlei Chen, Xiaolong Wang, Sanmi Koyejo, et al.

</span>
<span class="ltx_bibblock">Learning to (learn at test time): Rnns with expressive hidden states.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:2407.04620</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Mohammad Hesam Hesamian, Wenjing Jia, Xiangjian He, and Paul Kennedy.

</span>
<span class="ltx_bibblock">Deep learning techniques for medical image segmentation: achievements and challenges.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">Journal of digital imaging</span>, 32:582–596, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Jun Ma, Yuting He, Feifei Li, Lin Han, Chenyu You, and Bo Wang.

</span>
<span class="ltx_bibblock">Segment anything in medical images.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">Nature Communications</span>, 15(1):654, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Junduan Huang, An Zheng, M Saad Shakeel, Weili Yang, and Wenxiong Kang.

</span>
<span class="ltx_bibblock">Fvfsnet: Frequency-spatial coupling network for finger vein authentication.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">IEEE Transactions on Information Forensics and Security</span>, 18:1322–1334, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Jiang Hai, Ren Yang, Yaqi Yu, and Songchen Han.

</span>
<span class="ltx_bibblock">Combining spatial and frequency information for image deblurring.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">IEEE Signal Processing Letters</span>, 29:1679–1683, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Yunhe Gao, Mu Zhou, Di Liu, and Dimitris Metaxas.

</span>
<span class="ltx_bibblock">A multi-scale transformer for medical image segmentation: Architectures, model efficiency, and benchmarks.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:2203.00131</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Jiacheng Ruan, Suncheng Xiang, Mingye Xie, Ting Liu, and Yuzhuo Fu.

</span>
<span class="ltx_bibblock">Malunet: A multi-attention and light-weight unet for skin lesion segmentation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">2022 IEEE International Conference on Bioinformatics and Biomedicine (BIBM)</span>, pages 1150–1156. IEEE, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Jiacheng Ruan and Suncheng Xiang.

</span>
<span class="ltx_bibblock">Vm-unet: Vision mamba unet for medical image segmentation, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Jiashu Xu.

</span>
<span class="ltx_bibblock">Hc-mamba: Vision mamba with hybrid convolutional techniques for medical image segmentation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:2405.05007</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Zongwei Zhou, Md Mahfuzur Rahman Siddiquee, Nima Tajbakhsh, and Jianming Liang.

</span>
<span class="ltx_bibblock">Unet++: A nested u-net architecture for medical image segmentation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">Deep learning in medical image analysis and multimodal learning for clinical decision support</span>, pages 3–11. Springer, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Ozan Oktay, Jo Schlemper, Loic Le Folgoc, Matthew Lee, Mattias Heinrich, Kazunari Misawa, Kensaku Mori, Steven McDonagh, Nils Y Hammerla, Bernhard Kainz, et al.

</span>
<span class="ltx_bibblock">Attention u-net: Learning where to look for the pancreas.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:1804.03999</span>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Jun Wei, Yiwen Hu, Ruimao Zhang, Zhen Li, S Kevin Zhou, and Shuguang Cui.

</span>
<span class="ltx_bibblock">Shallow attention network for polyp segmentation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">International Conference on Medical Image Computing and Computer-Assisted Intervention</span>, pages 699–708. Springer, 2021.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Oct  3 14:30:23 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
