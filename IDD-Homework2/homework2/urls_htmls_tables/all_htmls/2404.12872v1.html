<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency</title>
<!--Generated on Wed May  1 13:35:19 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2404.12872v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S1" title="In LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S2" title="In LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminary</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S2.SS1" title="In 2. Preliminary ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Query and Rewrite Rules</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S2.SS2" title="In 2. Preliminary ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Rule-based Query Rewrite</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S2.SS3" title="In 2. Preliminary ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S2.SS3.SSS1" title="In 2.3. Related Work ‣ 2. Preliminary ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.1 </span>Query Rewrite</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S2.SS3.SSS2" title="In 2.3. Related Work ‣ 2. Preliminary ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.2 </span>LLM-based SQL Solvers.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S2.SS3.SSS3" title="In 2.3. Related Work ‣ 2. Preliminary ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.3 </span>In-context Learning</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S3" title="In LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>LLM-enhanced Rewrite System</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S3.SS1" title="In 3. LLM-enhanced Rewrite System ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>System Pipeline</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S3.SS2" title="In 3. LLM-enhanced Rewrite System ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Demonstration Manager Overview</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S4" title="In LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Demonstration Preparation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S4.SS1" title="In 4. Demonstration Preparation ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Benefit Estimator</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S4.SS2" title="In 4. Demonstration Preparation ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Pool Generator</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S5" title="In LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Demonstration Selection</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S5.SS1" title="In 5. Demonstration Selection ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Contrastive Representation Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S5.SS2" title="In 5. Demonstration Selection ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Curriculum Learning Pipeline</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6" title="In LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.SS1" title="In 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Experimental Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.SS1.SSS1" title="In 6.1. Experimental Setup ‣ 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1.1 </span>Dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.SS1.SSS2" title="In 6.1. Experimental Setup ‣ 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1.2 </span>Rewrite Rules</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.SS1.SSS3" title="In 6.1. Experimental Setup ‣ 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1.3 </span>LLM Setting</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.SS1.SSS4" title="In 6.1. Experimental Setup ‣ 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1.4 </span>Baseline Methods</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.SS1.SSS5" title="In 6.1. Experimental Setup ‣ 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1.5 </span>Training Setting.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.SS1.SSS6" title="In 6.1. Experimental Setup ‣ 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1.6 </span>Evaluation Metrics</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.SS2" title="In 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Executing Efficiency Evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.SS3" title="In 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3 </span>Computational Efficiency Evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.SS4" title="In 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.4 </span>Robustness Evaluation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.SS4.SSS1" title="In 6.4. Robustness Evaluation ‣ 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.4.1 </span>Transferability across different datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.SS4.SSS2" title="In 6.4. Robustness Evaluation ‣ 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.4.2 </span>Flexibility across different data scales</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.SS5" title="In 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.5 </span>Ablation Studies</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.SS5.SSS1" title="In 6.5. Ablation Studies ‣ 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.5.1 </span>Different selection approaches</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.SS5.SSS2" title="In 6.5. Ablation Studies ‣ 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.5.2 </span>Effectiveness of specific settings in the selection model.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.SS6" title="In 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.6 </span>Qualitative Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S7" title="In LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">LLM-R<sup class="ltx_sup" id="id1.id1">2</sup>: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhaodonghui Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id3.1.id1">Nanyang Technological University, DAMO Academy Alibaba Group, Singapore</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:G220002@e.ntu.edu.sg">G220002@e.ntu.edu.sg</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Haitao Yuan
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.1.id1">Nanyang Technological University, Singapore</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:haitao.yuan@ntu.edu.sg">haitao.yuan@ntu.edu.sg</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Huiming Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id5.1.id1">Singapore University of Technology and Design, Singapore</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:huiming%CB%99wang@mymail.sutd.edu.sg">huiming˙wang@mymail.sutd.edu.sg</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Gao Cong
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id6.1.id1">Nanyang Technological University, Singapore</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:gaocong@ntu.edu.sg">gaocong@ntu.edu.sg</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lidong Bing
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">DAMO Academy, Alibaba Group, Singapore</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:l.bing@alibaba-inc.com">l.bing@alibaba-inc.com</a>
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id8.id1">Query rewrite, which aims to generate more efficient queries by altering a SQL query’s structure without changing the query result, has been an important research problem. In order to maintain equivalence between the rewritten query and the original one during rewriting, traditional query rewrite methods always rewrite the queries following certain rewrite rules. However, some problems still remain. Firstly, existing methods of finding the optimal choice or sequence of rewrite rules are still limited and the process always costs a lot of resources. Methods involving discovering new rewrite rules typically require complicated proofs of structural logic or extensive user interactions. Secondly, current query rewrite methods usually rely highly on DBMS cost estimators which are often not accurate. In this paper, we address these problems by proposing a novel method of query rewrite named LLM-R<sup class="ltx_sup" id="id8.id1.1">2</sup>, adopting a large language model (LLM) to propose possible rewrite rules for a database rewrite system. To further improve the inference ability of LLM in recommending rewrite rules, we train a contrastive model by curriculum to learn query representations and select effective query demonstrations for the LLM. Experimental results have shown that our method can significantly improve the query execution efficiency and outperform the baseline methods. In addition, our method enjoys high robustness across different datasets.</p>
</div>
<div class="ltx_acknowledgements">*: Zhaodonghui Li is under the Joint PhD Program between DAMO Academy and Nanyang Technological University
</div>
<div class="ltx_acknowledgements">**: Work done when interned in DAMO Academy
</div>
<div class="ltx_para ltx_noindent" id="p1">
<p class="ltx_p" id="p1.1"><span class="ltx_text ltx_font_bold" id="p1.1.1" style="font-size:90%;">PVLDB Reference Format:
<br class="ltx_break"/></span><span class="ltx_text" id="p1.1.2" style="font-size:90%;">  PVLDB, 14(1): XXX-XXX, 2020.</span>
<br class="ltx_break"/><a class="ltx_ref ltx_href" href="https://doi.org/XX.XX/XXX.XX" style="font-size:90%;" title="">doi:XX.XX/XXX.XX</a><span class="ltx_text" id="p1.1.3" style="font-size:90%;">
</span><span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup>This work is licensed under the Creative Commons BY-NC-ND 4.0 International License. Visit <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" title="">https://creativecommons.org/licenses/by-nc-nd/4.0/</a> to view a copy of this license. For any use beyond those covered by this license, obtain permission by emailing <a class="ltx_ref ltx_href" href="mailto:info@vldb.org" title="">info@vldb.org</a>. Copyright is held by the owner/author(s). Publication rights licensed to the VLDB Endowment. 
<br class="ltx_break"/>Proceedings of the VLDB Endowment, Vol. 14, No. 1 ISSN 2150-8097. 
<br class="ltx_break"/><a class="ltx_ref ltx_href" href="https://doi.org/XX.XX/XXX.XX" title="">doi:XX.XX/XXX.XX</a>
<br class="ltx_break"/></span></span></span></p>
</div>
<div class="ltx_para ltx_noindent" id="p2">
<p class="ltx_p" id="p2.1"><span class="ltx_text ltx_font_bold" id="p2.1.1" style="font-size:90%;">PVLDB Artifact Availability:
<br class="ltx_break"/></span><span class="ltx_text" id="p2.1.2" style="font-size:90%;">The source code, data, and/or other artifacts have been made available at </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/DAMO-NLP-SG/LLM-R2" style="font-size:90%;" title="">https://github.com/DAMO-NLP-SG/LLM-R2</a><span class="ltx_text" id="p2.1.3" style="font-size:90%;">.
</span><span class="ltx_text" id="p2.1.4"></span></p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">With the rapid growth of data in various fields, it is common to take seconds or minutes, and even longer to execute an SQL query. Therefore, efficient query processing has been a crucial task in modern database systems. One of the key topics in query optimization that has gained significant attention is query rewrite <cite class="ltx_cite ltx_citemacro_citep">(Pirahesh et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib24" title="">1992</a>; Li, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib20" title="">2019</a>)</cite>. The objective of query rewrite is to output a new query equivalent to the original SQL query, while having a shorter execution time. Ideally, query rewrite should fulfill three critical criteria: (1) <span class="ltx_text ltx_font_bold" id="S1.p1.1.1">Executability</span>: the rewritten query should be able to be executed without any errors; (2) <span class="ltx_text ltx_font_bold" id="S1.p1.1.2">Equivalence</span>: it must yield identical results as the original query; (3) <span class="ltx_text ltx_font_bold" id="S1.p1.1.3">Efficiency</span>: this encompasses two aspects—<span class="ltx_text ltx_font_italic" id="S1.p1.1.4">Execution Efficiency</span> and <span class="ltx_text ltx_font_italic" id="S1.p1.1.5">Computational Efficiency</span>. <span class="ltx_text ltx_font_italic" id="S1.p1.1.6">Execution Efficiency</span> refers to the requirement that the rewritten query executes more efficiently than the original, while <span class="ltx_text ltx_font_italic" id="S1.p1.1.7">Computational Efficiency</span> implies that the overhead of the rewriting process should be justifiable by the time savings achieved during query execution.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">To enhance both <span class="ltx_text ltx_font_bold" id="S1.p2.1.1">Executability</span> and <span class="ltx_text ltx_font_bold" id="S1.p2.1.2">Equivalence</span> in rewritten queries, existing studies have predominantly concentrated on rule-based rewriting techniques. In particular, these studies are divided into two orthogonal research directions: the discovery of novel rewriting rules and the effective application of existing rules. For the first direction, although some studies have discovered more rewrite rules <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib28" title="">2022</a>; Bai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib7" title="">2023</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib30" title="">2022</a>)</cite>, there are many challenges related to the complexity of rule validation and the specificity of their applicability, often resulting in high computational demands and professional-level user competence. For example, Wetune <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib28" title="">2022</a>)</cite> only supports discovering rewrite rules on limited types of operators and Querybooster <cite class="ltx_cite ltx_citemacro_citep">(Bai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib7" title="">2023</a>)</cite> necessitates user engagement with specialized rule syntax, respectively. Therefore, this paper shifts focus toward the latter direction, delving into the methodologies for the effective utilization of pre-established rules. For example, Learned Rewrite <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib36" title="">2021</a>)</cite> utilizes existing rewrite rules from the Apache Calcite <cite class="ltx_cite ltx_citemacro_citep">(Begoli et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib8" title="">2018</a>)</cite> platform and learns to select rules to apply. It notably incorporates a Monte Carlo search algorithm in collaboration with a machine-learned query cost estimator to streamline the selection process. However, it’s non-trivial to solve the challenges related to the computational demand of the Monte Carlo algorithm and the precision of the cost estimation model, which can significantly impact the <span class="ltx_text ltx_font_bold" id="S1.p2.1.3">execution efficiency</span>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">On the other hand, with the rise of large language models (LLMs), there also exist some “large language model for database” projects <cite class="ltx_cite ltx_citemacro_citep">(Xue et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib31" title="">2024</a>; db-, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib4" title="">[n.d.]</a>)</cite> that support direct query rewrite. The idea of these methods is to utilize the sequence-to-sequence generation ability of a language model to directly output a new rewritten query given an input query, without considering any rewrite rules or DBMS information. Although it is possible for these methods to discover new rewrites not following any existing rules, they easily suffer from the hallucination problem of language models <cite class="ltx_cite ltx_citemacro_citep">(Ji et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib18" title="">2023</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib33" title="">2023</a>)</cite>, especially for long and complicated queries, where language models give plausible but incorrect outputs. Either a syntax or reference error during generation will lead to vital errors when executing the query. Therefore, relying solely on LLM’s output query may violate the <span class="ltx_text ltx_font_bold" id="S1.p3.1.1">executability</span> and <span class="ltx_text ltx_font_bold" id="S1.p3.1.2">equivalence</span> to the original query, deviating from the basic aim for query rewrite.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To overcome the limits of the current query rewriting techniques and benefit from their advantages, we propose an LLM-enhanced rewrite system to use LLMs to suggest rewrite rule strategies and apply these strategies with an existing database platform to rewrite an input query. Inspired by the LLM-based learning framework for using tools <cite class="ltx_cite ltx_citemacro_citep">(Schick et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib26" title="">2023</a>; Yao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib32" title="">2023</a>)</cite>, we leverage the LLM’s strong generalization and reasoning abilities for query rewriting while avoiding issues like hallucination. We design a novel LLM-enhanced query rewrite system to automate the process of selecting more effective rewrite rules, note that the <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">executability</span> and <span class="ltx_text ltx_font_bold" id="S1.p4.1.2">equivalence</span> of the rewritten query are guaranteed since all the candidate rules are provided by existing DB-based rule rewrite platforms. In addition to meeting the basic requirements of valid query rewrite, we also develop new techniques to boost the <span class="ltx_text ltx_font_bold" id="S1.p4.1.3">executing efficiency</span> of our rewrite system. Firstly, to overcome hallucination, we collect a pool of demonstrations consisting of effective query rewrites using existing methods and our designed baselines. We then learn a contrastive query representation model to select the most useful in-context demonstration for the given query to prompt the system, optimizing the LLM’s rewrite rule selection. In addition, to address the challenge of limited training data, we propose to utilize the learning curriculum technique <cite class="ltx_cite ltx_citemacro_citep">(Bengio et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib9" title="">2009</a>)</cite> to schedule the training data from easy to hard. We apply our LLM-enhanced rewrite method on three different datasets, namely TPC-H, IMDB, and DSB. We observe a significant query execution time decrease using our method, taking only 52.5%, 56.0%, 39.8% of the querying time of the original query and 94.5%, 63.1%, 40.7% of the time of the state-of-the-art baseline method on average on the three datasets.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Our main contributions are:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">To the best of our knowledge, we are the first to propose an LLM-enhanced query rewrite system that can automatically select effective rules from a given set of rewrite rules to rewrite an input SQL query.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">To enable LLMs to select better rewrite rules for a query, we construct a demonstration pool that contains high-quality demonstrations so that we can select good demonstrations to prompt the LLM-enhanced rewrite system for few-shots learning.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We learn a contrastive query representation model to optimize the demonstration selection. To overcome the challenge of limited training data, we further design a learning curriculum to schedule the training data from easy to hard.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">We further analyze the robustness of our method. By applying our method to unseen datasets and different dataset volumes, we demonstrate that our method is much more flexible than the baseline methods and shed light on generalizing to other database problems.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Preliminary</h2>
<figure class="ltx_table" id="S2.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1. </span>Examples of query rewrite rules. Examples of query rewrite rules of the Apache Calcite Rules <cite class="ltx_cite ltx_citemacro_citep">(org, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib2" title="">[n.d.]</a>)</cite>.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S2.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S2.T1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="S2.T1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S2.T1.1.1.1.1.1">Rule Name</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S2.T1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S2.T1.1.1.1.2.1">Rule Description</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S2.T1.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S2.T1.1.2.1.1">AGGREGATE_UNION_AGGREGATE</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S2.T1.1.2.1.2">Rule that matches an Aggregate whose input is a Union one of whose inputs is an Aggregate</td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.3.2">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S2.T1.1.3.2.1">FILTER_INTO_JOIN</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S2.T1.1.3.2.2">Rule that tries to push filter expressions into a join condition and into the inputs of the join</td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.4.3">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S2.T1.1.4.3.1">JOIN_EXTRACT_FILTER</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S2.T1.1.4.3.2">Rule to convert an inner join to a filter on top of a cartesian inner join</td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.5.4">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S2.T1.1.5.4.1">SORT_UNION_TRANSPOSE</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S2.T1.1.5.4.2">Rule that pushes a Sort past a Union</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section, we first introduce some key concepts including query, query tree and query rewrite rules in Section <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S2.SS1" title="2.1. Query and Rewrite Rules ‣ 2. Preliminary ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">2.1</span></a>. Then, we will formalize the problem of query rewrite based on rules in Section <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S2.SS2" title="2.2. Rule-based Query Rewrite ‣ 2. Preliminary ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">2.2</span></a>. Finally in Section <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S2.SS3" title="2.3. Related Work ‣ 2. Preliminary ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">2.3</span></a>, we introduce the related work.</p>
</div>
<figure class="ltx_figure" id="S2.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_missing ltx_missing_image" id="S2.F1.g1" src=""/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>A TPC-H query and its query tree</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S2.F1.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S2.F1.2">plan_tree</p>
</div>
</div>
</figure>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Query and Rewrite Rules</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S2.SS1.p1.1.1">Query &amp; Query tree.</span> Each query in our study is formulated as an executable SQL statement. Furthermore, we model each query as a query tree using various nodes, where each node represents a specific type of query operator (e.g., Sort, Join, and Scan). Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S2.F1" title="Figure 1 ‣ 2. Preliminary ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates an example of a SQL query and its corresponding query tree representation. It is worth noting that any given query can be transformed into a query tree, and conversely, this query tree can be reverted back to its original raw query form.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.6"><span class="ltx_text ltx_font_bold" id="S2.SS1.p2.6.1">Query rewrite rules.</span> Given an input query denoted as <math alttext="Q" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">italic_Q</annotation></semantics></math>, a sequence of transformation methods, represented as <math alttext="r_{1},r_{2},\cdots" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.3"><semantics id="S2.SS1.p2.2.m2.3a"><mrow id="S2.SS1.p2.2.m2.3.3.2" xref="S2.SS1.p2.2.m2.3.3.3.cmml"><msub id="S2.SS1.p2.2.m2.2.2.1.1" xref="S2.SS1.p2.2.m2.2.2.1.1.cmml"><mi id="S2.SS1.p2.2.m2.2.2.1.1.2" xref="S2.SS1.p2.2.m2.2.2.1.1.2.cmml">r</mi><mn id="S2.SS1.p2.2.m2.2.2.1.1.3" xref="S2.SS1.p2.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p2.2.m2.3.3.2.3" xref="S2.SS1.p2.2.m2.3.3.3.cmml">,</mo><msub id="S2.SS1.p2.2.m2.3.3.2.2" xref="S2.SS1.p2.2.m2.3.3.2.2.cmml"><mi id="S2.SS1.p2.2.m2.3.3.2.2.2" xref="S2.SS1.p2.2.m2.3.3.2.2.2.cmml">r</mi><mn id="S2.SS1.p2.2.m2.3.3.2.2.3" xref="S2.SS1.p2.2.m2.3.3.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.p2.2.m2.3.3.2.4" xref="S2.SS1.p2.2.m2.3.3.3.cmml">,</mo><mi id="S2.SS1.p2.2.m2.1.1" mathvariant="normal" xref="S2.SS1.p2.2.m2.1.1.cmml">⋯</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.3b"><list id="S2.SS1.p2.2.m2.3.3.3.cmml" xref="S2.SS1.p2.2.m2.3.3.2"><apply id="S2.SS1.p2.2.m2.2.2.1.1.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.2.2.1.1.1.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1">subscript</csymbol><ci id="S2.SS1.p2.2.m2.2.2.1.1.2.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1.2">𝑟</ci><cn id="S2.SS1.p2.2.m2.2.2.1.1.3.cmml" type="integer" xref="S2.SS1.p2.2.m2.2.2.1.1.3">1</cn></apply><apply id="S2.SS1.p2.2.m2.3.3.2.2.cmml" xref="S2.SS1.p2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.3.3.2.2.1.cmml" xref="S2.SS1.p2.2.m2.3.3.2.2">subscript</csymbol><ci id="S2.SS1.p2.2.m2.3.3.2.2.2.cmml" xref="S2.SS1.p2.2.m2.3.3.2.2.2">𝑟</ci><cn id="S2.SS1.p2.2.m2.3.3.2.2.3.cmml" type="integer" xref="S2.SS1.p2.2.m2.3.3.2.2.3">2</cn></apply><ci id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">⋯</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.3c">r_{1},r_{2},\cdots</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.3d">italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯</annotation></semantics></math>, can be applied to the query’s query tree, yielding an equivalent query, denoted as <math alttext="Q^{*}" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m3.1"><semantics id="S2.SS1.p2.3.m3.1a"><msup id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml"><mi id="S2.SS1.p2.3.m3.1.1.2" xref="S2.SS1.p2.3.m3.1.1.2.cmml">Q</mi><mo id="S2.SS1.p2.3.m3.1.1.3" xref="S2.SS1.p2.3.m3.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><apply id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.1.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">superscript</csymbol><ci id="S2.SS1.p2.3.m3.1.1.2.cmml" xref="S2.SS1.p2.3.m3.1.1.2">𝑄</ci><times id="S2.SS1.p2.3.m3.1.1.3.cmml" xref="S2.SS1.p2.3.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">Q^{*}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.1d">italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>. These transformation methods, referred to as rewrite rules, encompass a diverse range of functionalities. These include the conversion of one operator to another, the alteration of execution sequences between operators, and the elimination of redundant operators. Table <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S2.T1" title="Table 1 ‣ 2. Preliminary ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">1</span></a> delineates a representative set of these query rewrite rules. For the sake of brevity, we succinctly express the query rewrite process as <math alttext="Q^{*}=R(Q)" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m4.1"><semantics id="S2.SS1.p2.4.m4.1a"><mrow id="S2.SS1.p2.4.m4.1.2" xref="S2.SS1.p2.4.m4.1.2.cmml"><msup id="S2.SS1.p2.4.m4.1.2.2" xref="S2.SS1.p2.4.m4.1.2.2.cmml"><mi id="S2.SS1.p2.4.m4.1.2.2.2" xref="S2.SS1.p2.4.m4.1.2.2.2.cmml">Q</mi><mo id="S2.SS1.p2.4.m4.1.2.2.3" xref="S2.SS1.p2.4.m4.1.2.2.3.cmml">∗</mo></msup><mo id="S2.SS1.p2.4.m4.1.2.1" xref="S2.SS1.p2.4.m4.1.2.1.cmml">=</mo><mrow id="S2.SS1.p2.4.m4.1.2.3" xref="S2.SS1.p2.4.m4.1.2.3.cmml"><mi id="S2.SS1.p2.4.m4.1.2.3.2" xref="S2.SS1.p2.4.m4.1.2.3.2.cmml">R</mi><mo id="S2.SS1.p2.4.m4.1.2.3.1" xref="S2.SS1.p2.4.m4.1.2.3.1.cmml">⁢</mo><mrow id="S2.SS1.p2.4.m4.1.2.3.3.2" xref="S2.SS1.p2.4.m4.1.2.3.cmml"><mo id="S2.SS1.p2.4.m4.1.2.3.3.2.1" stretchy="false" xref="S2.SS1.p2.4.m4.1.2.3.cmml">(</mo><mi id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml">Q</mi><mo id="S2.SS1.p2.4.m4.1.2.3.3.2.2" stretchy="false" xref="S2.SS1.p2.4.m4.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><apply id="S2.SS1.p2.4.m4.1.2.cmml" xref="S2.SS1.p2.4.m4.1.2"><eq id="S2.SS1.p2.4.m4.1.2.1.cmml" xref="S2.SS1.p2.4.m4.1.2.1"></eq><apply id="S2.SS1.p2.4.m4.1.2.2.cmml" xref="S2.SS1.p2.4.m4.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.2.2.1.cmml" xref="S2.SS1.p2.4.m4.1.2.2">superscript</csymbol><ci id="S2.SS1.p2.4.m4.1.2.2.2.cmml" xref="S2.SS1.p2.4.m4.1.2.2.2">𝑄</ci><times id="S2.SS1.p2.4.m4.1.2.2.3.cmml" xref="S2.SS1.p2.4.m4.1.2.2.3"></times></apply><apply id="S2.SS1.p2.4.m4.1.2.3.cmml" xref="S2.SS1.p2.4.m4.1.2.3"><times id="S2.SS1.p2.4.m4.1.2.3.1.cmml" xref="S2.SS1.p2.4.m4.1.2.3.1"></times><ci id="S2.SS1.p2.4.m4.1.2.3.2.cmml" xref="S2.SS1.p2.4.m4.1.2.3.2">𝑅</ci><ci id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">Q^{*}=R(Q)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m4.1d">italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = italic_R ( italic_Q )</annotation></semantics></math>, where <math alttext="R=[r_{1},r_{2},\cdots,r_{n}]" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m5.4"><semantics id="S2.SS1.p2.5.m5.4a"><mrow id="S2.SS1.p2.5.m5.4.4" xref="S2.SS1.p2.5.m5.4.4.cmml"><mi id="S2.SS1.p2.5.m5.4.4.5" xref="S2.SS1.p2.5.m5.4.4.5.cmml">R</mi><mo id="S2.SS1.p2.5.m5.4.4.4" xref="S2.SS1.p2.5.m5.4.4.4.cmml">=</mo><mrow id="S2.SS1.p2.5.m5.4.4.3.3" xref="S2.SS1.p2.5.m5.4.4.3.4.cmml"><mo id="S2.SS1.p2.5.m5.4.4.3.3.4" stretchy="false" xref="S2.SS1.p2.5.m5.4.4.3.4.cmml">[</mo><msub id="S2.SS1.p2.5.m5.2.2.1.1.1" xref="S2.SS1.p2.5.m5.2.2.1.1.1.cmml"><mi id="S2.SS1.p2.5.m5.2.2.1.1.1.2" xref="S2.SS1.p2.5.m5.2.2.1.1.1.2.cmml">r</mi><mn id="S2.SS1.p2.5.m5.2.2.1.1.1.3" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p2.5.m5.4.4.3.3.5" xref="S2.SS1.p2.5.m5.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p2.5.m5.3.3.2.2.2" xref="S2.SS1.p2.5.m5.3.3.2.2.2.cmml"><mi id="S2.SS1.p2.5.m5.3.3.2.2.2.2" xref="S2.SS1.p2.5.m5.3.3.2.2.2.2.cmml">r</mi><mn id="S2.SS1.p2.5.m5.3.3.2.2.2.3" xref="S2.SS1.p2.5.m5.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.p2.5.m5.4.4.3.3.6" xref="S2.SS1.p2.5.m5.4.4.3.4.cmml">,</mo><mi id="S2.SS1.p2.5.m5.1.1" mathvariant="normal" xref="S2.SS1.p2.5.m5.1.1.cmml">⋯</mi><mo id="S2.SS1.p2.5.m5.4.4.3.3.7" xref="S2.SS1.p2.5.m5.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p2.5.m5.4.4.3.3.3" xref="S2.SS1.p2.5.m5.4.4.3.3.3.cmml"><mi id="S2.SS1.p2.5.m5.4.4.3.3.3.2" xref="S2.SS1.p2.5.m5.4.4.3.3.3.2.cmml">r</mi><mi id="S2.SS1.p2.5.m5.4.4.3.3.3.3" xref="S2.SS1.p2.5.m5.4.4.3.3.3.3.cmml">n</mi></msub><mo id="S2.SS1.p2.5.m5.4.4.3.3.8" stretchy="false" xref="S2.SS1.p2.5.m5.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.4b"><apply id="S2.SS1.p2.5.m5.4.4.cmml" xref="S2.SS1.p2.5.m5.4.4"><eq id="S2.SS1.p2.5.m5.4.4.4.cmml" xref="S2.SS1.p2.5.m5.4.4.4"></eq><ci id="S2.SS1.p2.5.m5.4.4.5.cmml" xref="S2.SS1.p2.5.m5.4.4.5">𝑅</ci><list id="S2.SS1.p2.5.m5.4.4.3.4.cmml" xref="S2.SS1.p2.5.m5.4.4.3.3"><apply id="S2.SS1.p2.5.m5.2.2.1.1.1.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.2.2.1.1.1.1.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.5.m5.2.2.1.1.1.2.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.2">𝑟</ci><cn id="S2.SS1.p2.5.m5.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS1.p2.5.m5.3.3.2.2.2.cmml" xref="S2.SS1.p2.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.3.3.2.2.2.1.cmml" xref="S2.SS1.p2.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p2.5.m5.3.3.2.2.2.2.cmml" xref="S2.SS1.p2.5.m5.3.3.2.2.2.2">𝑟</ci><cn id="S2.SS1.p2.5.m5.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS1.p2.5.m5.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1">⋯</ci><apply id="S2.SS1.p2.5.m5.4.4.3.3.3.cmml" xref="S2.SS1.p2.5.m5.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.4.4.3.3.3.1.cmml" xref="S2.SS1.p2.5.m5.4.4.3.3.3">subscript</csymbol><ci id="S2.SS1.p2.5.m5.4.4.3.3.3.2.cmml" xref="S2.SS1.p2.5.m5.4.4.3.3.3.2">𝑟</ci><ci id="S2.SS1.p2.5.m5.4.4.3.3.3.3.cmml" xref="S2.SS1.p2.5.m5.4.4.3.3.3.3">𝑛</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.4c">R=[r_{1},r_{2},\cdots,r_{n}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m5.4d">italic_R = [ italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_r start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ]</annotation></semantics></math> symbolizes the sequence of <math alttext="n" class="ltx_Math" display="inline" id="S2.SS1.p2.6.m6.1"><semantics id="S2.SS1.p2.6.m6.1a"><mi id="S2.SS1.p2.6.m6.1.1" xref="S2.SS1.p2.6.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m6.1b"><ci id="S2.SS1.p2.6.m6.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m6.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.6.m6.1d">italic_n</annotation></semantics></math> applied rewrite rules.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Rule-based Query Rewrite</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">With the introduction of the rewrite rules, we now formally define the problem of query rewrite based on rules as follows:</p>
</div>
<div class="ltx_theorem ltx_theorem_definition" id="S2.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_theorem">Definition 2.1.</h6>
<div class="ltx_para" id="S2.Thmtheorem1.p1">
<p class="ltx_p" id="S2.Thmtheorem1.p1.9">(Rule-based query rewrite): Consider an input query <math alttext="Q" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.1.m1.1"><semantics id="S2.Thmtheorem1.p1.1.m1.1a"><mi id="S2.Thmtheorem1.p1.1.m1.1.1" xref="S2.Thmtheorem1.p1.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.1.m1.1b"><ci id="S2.Thmtheorem1.p1.1.m1.1.1.cmml" xref="S2.Thmtheorem1.p1.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.1.m1.1d">italic_Q</annotation></semantics></math> and a set of candidate rewrite rules <math alttext="R" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.2.m2.1"><semantics id="S2.Thmtheorem1.p1.2.m2.1a"><mi id="S2.Thmtheorem1.p1.2.m2.1.1" xref="S2.Thmtheorem1.p1.2.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.2.m2.1b"><ci id="S2.Thmtheorem1.p1.2.m2.1.1.cmml" xref="S2.Thmtheorem1.p1.2.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.2.m2.1c">R</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.2.m2.1d">italic_R</annotation></semantics></math>. The objective is to identify a sequence of rules <math alttext="R^{*}=[r^{*}_{1},r^{*}_{2},\cdots,r^{*}_{n}]" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.3.m3.4"><semantics id="S2.Thmtheorem1.p1.3.m3.4a"><mrow id="S2.Thmtheorem1.p1.3.m3.4.4" xref="S2.Thmtheorem1.p1.3.m3.4.4.cmml"><msup id="S2.Thmtheorem1.p1.3.m3.4.4.5" xref="S2.Thmtheorem1.p1.3.m3.4.4.5.cmml"><mi id="S2.Thmtheorem1.p1.3.m3.4.4.5.2" xref="S2.Thmtheorem1.p1.3.m3.4.4.5.2.cmml">R</mi><mo id="S2.Thmtheorem1.p1.3.m3.4.4.5.3" xref="S2.Thmtheorem1.p1.3.m3.4.4.5.3.cmml">∗</mo></msup><mo id="S2.Thmtheorem1.p1.3.m3.4.4.4" xref="S2.Thmtheorem1.p1.3.m3.4.4.4.cmml">=</mo><mrow id="S2.Thmtheorem1.p1.3.m3.4.4.3.3" xref="S2.Thmtheorem1.p1.3.m3.4.4.3.4.cmml"><mo id="S2.Thmtheorem1.p1.3.m3.4.4.3.3.4" stretchy="false" xref="S2.Thmtheorem1.p1.3.m3.4.4.3.4.cmml">[</mo><msubsup id="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1" xref="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1.cmml"><mi id="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1.2.2" xref="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1.2.2.cmml">r</mi><mn id="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1.3" xref="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1.3.cmml">1</mn><mo id="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1.2.3" xref="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1.2.3.cmml">∗</mo></msubsup><mo id="S2.Thmtheorem1.p1.3.m3.4.4.3.3.5" xref="S2.Thmtheorem1.p1.3.m3.4.4.3.4.cmml">,</mo><msubsup id="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2" xref="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2.cmml"><mi id="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2.2.2" xref="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2.2.2.cmml">r</mi><mn id="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2.3" xref="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2.3.cmml">2</mn><mo id="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2.2.3" xref="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2.2.3.cmml">∗</mo></msubsup><mo id="S2.Thmtheorem1.p1.3.m3.4.4.3.3.6" xref="S2.Thmtheorem1.p1.3.m3.4.4.3.4.cmml">,</mo><mi id="S2.Thmtheorem1.p1.3.m3.1.1" mathvariant="normal" xref="S2.Thmtheorem1.p1.3.m3.1.1.cmml">⋯</mi><mo id="S2.Thmtheorem1.p1.3.m3.4.4.3.3.7" xref="S2.Thmtheorem1.p1.3.m3.4.4.3.4.cmml">,</mo><msubsup id="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3" xref="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3.cmml"><mi id="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3.2.2" xref="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3.2.2.cmml">r</mi><mi id="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3.3" xref="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3.3.cmml">n</mi><mo id="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3.2.3" xref="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3.2.3.cmml">∗</mo></msubsup><mo id="S2.Thmtheorem1.p1.3.m3.4.4.3.3.8" stretchy="false" xref="S2.Thmtheorem1.p1.3.m3.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.3.m3.4b"><apply id="S2.Thmtheorem1.p1.3.m3.4.4.cmml" xref="S2.Thmtheorem1.p1.3.m3.4.4"><eq id="S2.Thmtheorem1.p1.3.m3.4.4.4.cmml" xref="S2.Thmtheorem1.p1.3.m3.4.4.4"></eq><apply id="S2.Thmtheorem1.p1.3.m3.4.4.5.cmml" xref="S2.Thmtheorem1.p1.3.m3.4.4.5"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.3.m3.4.4.5.1.cmml" xref="S2.Thmtheorem1.p1.3.m3.4.4.5">superscript</csymbol><ci id="S2.Thmtheorem1.p1.3.m3.4.4.5.2.cmml" xref="S2.Thmtheorem1.p1.3.m3.4.4.5.2">𝑅</ci><times id="S2.Thmtheorem1.p1.3.m3.4.4.5.3.cmml" xref="S2.Thmtheorem1.p1.3.m3.4.4.5.3"></times></apply><list id="S2.Thmtheorem1.p1.3.m3.4.4.3.4.cmml" xref="S2.Thmtheorem1.p1.3.m3.4.4.3.3"><apply id="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1.cmml" xref="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1.1.cmml" xref="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1">subscript</csymbol><apply id="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1.2.cmml" xref="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1.2.1.cmml" xref="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1">superscript</csymbol><ci id="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1.2.2.cmml" xref="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1.2.2">𝑟</ci><times id="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1.2.3.cmml" xref="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1.2.3"></times></apply><cn id="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S2.Thmtheorem1.p1.3.m3.2.2.1.1.1.3">1</cn></apply><apply id="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2.cmml" xref="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2.1.cmml" xref="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2">subscript</csymbol><apply id="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2.2.cmml" xref="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2.2.1.cmml" xref="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2">superscript</csymbol><ci id="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2.2.2.cmml" xref="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2.2.2">𝑟</ci><times id="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2.2.3.cmml" xref="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2.2.3"></times></apply><cn id="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S2.Thmtheorem1.p1.3.m3.3.3.2.2.2.3">2</cn></apply><ci id="S2.Thmtheorem1.p1.3.m3.1.1.cmml" xref="S2.Thmtheorem1.p1.3.m3.1.1">⋯</ci><apply id="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3.cmml" xref="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3.1.cmml" xref="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3">subscript</csymbol><apply id="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3.2.cmml" xref="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3.2.1.cmml" xref="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3">superscript</csymbol><ci id="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3.2.2.cmml" xref="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3.2.2">𝑟</ci><times id="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3.2.3.cmml" xref="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3.2.3"></times></apply><ci id="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3.3.cmml" xref="S2.Thmtheorem1.p1.3.m3.4.4.3.3.3.3">𝑛</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.3.m3.4c">R^{*}=[r^{*}_{1},r^{*}_{2},\cdots,r^{*}_{n}]</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.3.m3.4d">italic_R start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = [ italic_r start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_r start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_r start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ]</annotation></semantics></math> where <math alttext="r^{*}_{i}\in R" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.4.m4.1"><semantics id="S2.Thmtheorem1.p1.4.m4.1a"><mrow id="S2.Thmtheorem1.p1.4.m4.1.1" xref="S2.Thmtheorem1.p1.4.m4.1.1.cmml"><msubsup id="S2.Thmtheorem1.p1.4.m4.1.1.2" xref="S2.Thmtheorem1.p1.4.m4.1.1.2.cmml"><mi id="S2.Thmtheorem1.p1.4.m4.1.1.2.2.2" xref="S2.Thmtheorem1.p1.4.m4.1.1.2.2.2.cmml">r</mi><mi id="S2.Thmtheorem1.p1.4.m4.1.1.2.3" xref="S2.Thmtheorem1.p1.4.m4.1.1.2.3.cmml">i</mi><mo id="S2.Thmtheorem1.p1.4.m4.1.1.2.2.3" xref="S2.Thmtheorem1.p1.4.m4.1.1.2.2.3.cmml">∗</mo></msubsup><mo id="S2.Thmtheorem1.p1.4.m4.1.1.1" xref="S2.Thmtheorem1.p1.4.m4.1.1.1.cmml">∈</mo><mi id="S2.Thmtheorem1.p1.4.m4.1.1.3" xref="S2.Thmtheorem1.p1.4.m4.1.1.3.cmml">R</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.4.m4.1b"><apply id="S2.Thmtheorem1.p1.4.m4.1.1.cmml" xref="S2.Thmtheorem1.p1.4.m4.1.1"><in id="S2.Thmtheorem1.p1.4.m4.1.1.1.cmml" xref="S2.Thmtheorem1.p1.4.m4.1.1.1"></in><apply id="S2.Thmtheorem1.p1.4.m4.1.1.2.cmml" xref="S2.Thmtheorem1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.4.m4.1.1.2.1.cmml" xref="S2.Thmtheorem1.p1.4.m4.1.1.2">subscript</csymbol><apply id="S2.Thmtheorem1.p1.4.m4.1.1.2.2.cmml" xref="S2.Thmtheorem1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.4.m4.1.1.2.2.1.cmml" xref="S2.Thmtheorem1.p1.4.m4.1.1.2">superscript</csymbol><ci id="S2.Thmtheorem1.p1.4.m4.1.1.2.2.2.cmml" xref="S2.Thmtheorem1.p1.4.m4.1.1.2.2.2">𝑟</ci><times id="S2.Thmtheorem1.p1.4.m4.1.1.2.2.3.cmml" xref="S2.Thmtheorem1.p1.4.m4.1.1.2.2.3"></times></apply><ci id="S2.Thmtheorem1.p1.4.m4.1.1.2.3.cmml" xref="S2.Thmtheorem1.p1.4.m4.1.1.2.3">𝑖</ci></apply><ci id="S2.Thmtheorem1.p1.4.m4.1.1.3.cmml" xref="S2.Thmtheorem1.p1.4.m4.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.4.m4.1c">r^{*}_{i}\in R</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.4.m4.1d">italic_r start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ italic_R</annotation></semantics></math>, that transforms the query <math alttext="Q" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.5.m5.1"><semantics id="S2.Thmtheorem1.p1.5.m5.1a"><mi id="S2.Thmtheorem1.p1.5.m5.1.1" xref="S2.Thmtheorem1.p1.5.m5.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.5.m5.1b"><ci id="S2.Thmtheorem1.p1.5.m5.1.1.cmml" xref="S2.Thmtheorem1.p1.5.m5.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.5.m5.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.5.m5.1d">italic_Q</annotation></semantics></math> into a more efficient version <math alttext="Q^{*}=R^{*}(Q)" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.6.m6.1"><semantics id="S2.Thmtheorem1.p1.6.m6.1a"><mrow id="S2.Thmtheorem1.p1.6.m6.1.2" xref="S2.Thmtheorem1.p1.6.m6.1.2.cmml"><msup id="S2.Thmtheorem1.p1.6.m6.1.2.2" xref="S2.Thmtheorem1.p1.6.m6.1.2.2.cmml"><mi id="S2.Thmtheorem1.p1.6.m6.1.2.2.2" xref="S2.Thmtheorem1.p1.6.m6.1.2.2.2.cmml">Q</mi><mo id="S2.Thmtheorem1.p1.6.m6.1.2.2.3" xref="S2.Thmtheorem1.p1.6.m6.1.2.2.3.cmml">∗</mo></msup><mo id="S2.Thmtheorem1.p1.6.m6.1.2.1" xref="S2.Thmtheorem1.p1.6.m6.1.2.1.cmml">=</mo><mrow id="S2.Thmtheorem1.p1.6.m6.1.2.3" xref="S2.Thmtheorem1.p1.6.m6.1.2.3.cmml"><msup id="S2.Thmtheorem1.p1.6.m6.1.2.3.2" xref="S2.Thmtheorem1.p1.6.m6.1.2.3.2.cmml"><mi id="S2.Thmtheorem1.p1.6.m6.1.2.3.2.2" xref="S2.Thmtheorem1.p1.6.m6.1.2.3.2.2.cmml">R</mi><mo id="S2.Thmtheorem1.p1.6.m6.1.2.3.2.3" xref="S2.Thmtheorem1.p1.6.m6.1.2.3.2.3.cmml">∗</mo></msup><mo id="S2.Thmtheorem1.p1.6.m6.1.2.3.1" xref="S2.Thmtheorem1.p1.6.m6.1.2.3.1.cmml">⁢</mo><mrow id="S2.Thmtheorem1.p1.6.m6.1.2.3.3.2" xref="S2.Thmtheorem1.p1.6.m6.1.2.3.cmml"><mo id="S2.Thmtheorem1.p1.6.m6.1.2.3.3.2.1" stretchy="false" xref="S2.Thmtheorem1.p1.6.m6.1.2.3.cmml">(</mo><mi id="S2.Thmtheorem1.p1.6.m6.1.1" xref="S2.Thmtheorem1.p1.6.m6.1.1.cmml">Q</mi><mo id="S2.Thmtheorem1.p1.6.m6.1.2.3.3.2.2" stretchy="false" xref="S2.Thmtheorem1.p1.6.m6.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.6.m6.1b"><apply id="S2.Thmtheorem1.p1.6.m6.1.2.cmml" xref="S2.Thmtheorem1.p1.6.m6.1.2"><eq id="S2.Thmtheorem1.p1.6.m6.1.2.1.cmml" xref="S2.Thmtheorem1.p1.6.m6.1.2.1"></eq><apply id="S2.Thmtheorem1.p1.6.m6.1.2.2.cmml" xref="S2.Thmtheorem1.p1.6.m6.1.2.2"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.6.m6.1.2.2.1.cmml" xref="S2.Thmtheorem1.p1.6.m6.1.2.2">superscript</csymbol><ci id="S2.Thmtheorem1.p1.6.m6.1.2.2.2.cmml" xref="S2.Thmtheorem1.p1.6.m6.1.2.2.2">𝑄</ci><times id="S2.Thmtheorem1.p1.6.m6.1.2.2.3.cmml" xref="S2.Thmtheorem1.p1.6.m6.1.2.2.3"></times></apply><apply id="S2.Thmtheorem1.p1.6.m6.1.2.3.cmml" xref="S2.Thmtheorem1.p1.6.m6.1.2.3"><times id="S2.Thmtheorem1.p1.6.m6.1.2.3.1.cmml" xref="S2.Thmtheorem1.p1.6.m6.1.2.3.1"></times><apply id="S2.Thmtheorem1.p1.6.m6.1.2.3.2.cmml" xref="S2.Thmtheorem1.p1.6.m6.1.2.3.2"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.6.m6.1.2.3.2.1.cmml" xref="S2.Thmtheorem1.p1.6.m6.1.2.3.2">superscript</csymbol><ci id="S2.Thmtheorem1.p1.6.m6.1.2.3.2.2.cmml" xref="S2.Thmtheorem1.p1.6.m6.1.2.3.2.2">𝑅</ci><times id="S2.Thmtheorem1.p1.6.m6.1.2.3.2.3.cmml" xref="S2.Thmtheorem1.p1.6.m6.1.2.3.2.3"></times></apply><ci id="S2.Thmtheorem1.p1.6.m6.1.1.cmml" xref="S2.Thmtheorem1.p1.6.m6.1.1">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.6.m6.1c">Q^{*}=R^{*}(Q)</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.6.m6.1d">italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = italic_R start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_Q )</annotation></semantics></math>. The efficiency of the rewritten query <math alttext="Q^{*}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.7.m7.1"><semantics id="S2.Thmtheorem1.p1.7.m7.1a"><msup id="S2.Thmtheorem1.p1.7.m7.1.1" xref="S2.Thmtheorem1.p1.7.m7.1.1.cmml"><mi id="S2.Thmtheorem1.p1.7.m7.1.1.2" xref="S2.Thmtheorem1.p1.7.m7.1.1.2.cmml">Q</mi><mo id="S2.Thmtheorem1.p1.7.m7.1.1.3" xref="S2.Thmtheorem1.p1.7.m7.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.7.m7.1b"><apply id="S2.Thmtheorem1.p1.7.m7.1.1.cmml" xref="S2.Thmtheorem1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.7.m7.1.1.1.cmml" xref="S2.Thmtheorem1.p1.7.m7.1.1">superscript</csymbol><ci id="S2.Thmtheorem1.p1.7.m7.1.1.2.cmml" xref="S2.Thmtheorem1.p1.7.m7.1.1.2">𝑄</ci><times id="S2.Thmtheorem1.p1.7.m7.1.1.3.cmml" xref="S2.Thmtheorem1.p1.7.m7.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.7.m7.1c">Q^{*}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.7.m7.1d">italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> is quantified by its execution latency. Such rewrite is characterized by transforming <math alttext="Q" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.8.m8.1"><semantics id="S2.Thmtheorem1.p1.8.m8.1a"><mi id="S2.Thmtheorem1.p1.8.m8.1.1" xref="S2.Thmtheorem1.p1.8.m8.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.8.m8.1b"><ci id="S2.Thmtheorem1.p1.8.m8.1.1.cmml" xref="S2.Thmtheorem1.p1.8.m8.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.8.m8.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.8.m8.1d">italic_Q</annotation></semantics></math> into an equivalent query <math alttext="Q^{*}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.9.m9.1"><semantics id="S2.Thmtheorem1.p1.9.m9.1a"><msup id="S2.Thmtheorem1.p1.9.m9.1.1" xref="S2.Thmtheorem1.p1.9.m9.1.1.cmml"><mi id="S2.Thmtheorem1.p1.9.m9.1.1.2" xref="S2.Thmtheorem1.p1.9.m9.1.1.2.cmml">Q</mi><mo id="S2.Thmtheorem1.p1.9.m9.1.1.3" xref="S2.Thmtheorem1.p1.9.m9.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.9.m9.1b"><apply id="S2.Thmtheorem1.p1.9.m9.1.1.cmml" xref="S2.Thmtheorem1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.9.m9.1.1.1.cmml" xref="S2.Thmtheorem1.p1.9.m9.1.1">superscript</csymbol><ci id="S2.Thmtheorem1.p1.9.m9.1.1.2.cmml" xref="S2.Thmtheorem1.p1.9.m9.1.1.2">𝑄</ci><times id="S2.Thmtheorem1.p1.9.m9.1.1.3.cmml" xref="S2.Thmtheorem1.p1.9.m9.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.9.m9.1c">Q^{*}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.9.m9.1d">italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>, which exhibits a lower execution latency compared to other possible rewritten versions of the query. The problem can be formally represented as:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E1">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E1X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{argmin}_{R^{*}\subseteq R}" class="ltx_Math" display="inline" id="S2.E1X.2.1.1.m1.1"><semantics id="S2.E1X.2.1.1.m1.1a"><msub id="S2.E1X.2.1.1.m1.1.1" xref="S2.E1X.2.1.1.m1.1.1.cmml"><mtext id="S2.E1X.2.1.1.m1.1.1.2" xref="S2.E1X.2.1.1.m1.1.1.2a.cmml">argmin</mtext><mrow id="S2.E1X.2.1.1.m1.1.1.3" xref="S2.E1X.2.1.1.m1.1.1.3.cmml"><msup id="S2.E1X.2.1.1.m1.1.1.3.2" xref="S2.E1X.2.1.1.m1.1.1.3.2.cmml"><mi id="S2.E1X.2.1.1.m1.1.1.3.2.2" xref="S2.E1X.2.1.1.m1.1.1.3.2.2.cmml">R</mi><mo id="S2.E1X.2.1.1.m1.1.1.3.2.3" xref="S2.E1X.2.1.1.m1.1.1.3.2.3.cmml">∗</mo></msup><mo id="S2.E1X.2.1.1.m1.1.1.3.1" xref="S2.E1X.2.1.1.m1.1.1.3.1.cmml">⊆</mo><mi id="S2.E1X.2.1.1.m1.1.1.3.3" xref="S2.E1X.2.1.1.m1.1.1.3.3.cmml">R</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.E1X.2.1.1.m1.1b"><apply id="S2.E1X.2.1.1.m1.1.1.cmml" xref="S2.E1X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E1X.2.1.1.m1.1.1.1.cmml" xref="S2.E1X.2.1.1.m1.1.1">subscript</csymbol><ci id="S2.E1X.2.1.1.m1.1.1.2a.cmml" xref="S2.E1X.2.1.1.m1.1.1.2"><mtext id="S2.E1X.2.1.1.m1.1.1.2.cmml" xref="S2.E1X.2.1.1.m1.1.1.2">argmin</mtext></ci><apply id="S2.E1X.2.1.1.m1.1.1.3.cmml" xref="S2.E1X.2.1.1.m1.1.1.3"><subset id="S2.E1X.2.1.1.m1.1.1.3.1.cmml" xref="S2.E1X.2.1.1.m1.1.1.3.1"></subset><apply id="S2.E1X.2.1.1.m1.1.1.3.2.cmml" xref="S2.E1X.2.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1X.2.1.1.m1.1.1.3.2.1.cmml" xref="S2.E1X.2.1.1.m1.1.1.3.2">superscript</csymbol><ci id="S2.E1X.2.1.1.m1.1.1.3.2.2.cmml" xref="S2.E1X.2.1.1.m1.1.1.3.2.2">𝑅</ci><times id="S2.E1X.2.1.1.m1.1.1.3.2.3.cmml" xref="S2.E1X.2.1.1.m1.1.1.3.2.3"></times></apply><ci id="S2.E1X.2.1.1.m1.1.1.3.3.cmml" xref="S2.E1X.2.1.1.m1.1.1.3.3">𝑅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1X.2.1.1.m1.1c">\displaystyle\text{argmin}_{R^{*}\subseteq R}</annotation><annotation encoding="application/x-llamapun" id="S2.E1X.2.1.1.m1.1d">argmin start_POSTSUBSCRIPT italic_R start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ⊆ italic_R end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{ latency}(Q^{*})" class="ltx_Math" display="inline" id="S2.E1X.3.2.2.m1.1"><semantics id="S2.E1X.3.2.2.m1.1a"><mrow id="S2.E1X.3.2.2.m1.1.1" xref="S2.E1X.3.2.2.m1.1.1.cmml"><mtext id="S2.E1X.3.2.2.m1.1.1.3" xref="S2.E1X.3.2.2.m1.1.1.3a.cmml">latency</mtext><mo id="S2.E1X.3.2.2.m1.1.1.2" xref="S2.E1X.3.2.2.m1.1.1.2.cmml">⁢</mo><mrow id="S2.E1X.3.2.2.m1.1.1.1.1" xref="S2.E1X.3.2.2.m1.1.1.1.1.1.cmml"><mo id="S2.E1X.3.2.2.m1.1.1.1.1.2" stretchy="false" xref="S2.E1X.3.2.2.m1.1.1.1.1.1.cmml">(</mo><msup id="S2.E1X.3.2.2.m1.1.1.1.1.1" xref="S2.E1X.3.2.2.m1.1.1.1.1.1.cmml"><mi id="S2.E1X.3.2.2.m1.1.1.1.1.1.2" xref="S2.E1X.3.2.2.m1.1.1.1.1.1.2.cmml">Q</mi><mo id="S2.E1X.3.2.2.m1.1.1.1.1.1.3" xref="S2.E1X.3.2.2.m1.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="S2.E1X.3.2.2.m1.1.1.1.1.3" stretchy="false" xref="S2.E1X.3.2.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1X.3.2.2.m1.1b"><apply id="S2.E1X.3.2.2.m1.1.1.cmml" xref="S2.E1X.3.2.2.m1.1.1"><times id="S2.E1X.3.2.2.m1.1.1.2.cmml" xref="S2.E1X.3.2.2.m1.1.1.2"></times><ci id="S2.E1X.3.2.2.m1.1.1.3a.cmml" xref="S2.E1X.3.2.2.m1.1.1.3"><mtext id="S2.E1X.3.2.2.m1.1.1.3.cmml" xref="S2.E1X.3.2.2.m1.1.1.3">latency</mtext></ci><apply id="S2.E1X.3.2.2.m1.1.1.1.1.1.cmml" xref="S2.E1X.3.2.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S2.E1X.3.2.2.m1.1.1.1.1">superscript</csymbol><ci id="S2.E1X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S2.E1X.3.2.2.m1.1.1.1.1.1.2">𝑄</ci><times id="S2.E1X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S2.E1X.3.2.2.m1.1.1.1.1.1.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1X.3.2.2.m1.1c">\displaystyle\text{ latency}(Q^{*})</annotation><annotation encoding="application/x-llamapun" id="S2.E1X.3.2.2.m1.1d">latency ( italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E1Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_text ltx_markedasmath ltx_font_italic" id="S2.E1Xa.2.1.1.1">s.t.</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle Q^{*}=R^{*}(Q)" class="ltx_Math" display="inline" id="S2.E1Xa.3.2.2.m1.1"><semantics id="S2.E1Xa.3.2.2.m1.1a"><mrow id="S2.E1Xa.3.2.2.m1.1.2" xref="S2.E1Xa.3.2.2.m1.1.2.cmml"><msup id="S2.E1Xa.3.2.2.m1.1.2.2" xref="S2.E1Xa.3.2.2.m1.1.2.2.cmml"><mi id="S2.E1Xa.3.2.2.m1.1.2.2.2" xref="S2.E1Xa.3.2.2.m1.1.2.2.2.cmml">Q</mi><mo id="S2.E1Xa.3.2.2.m1.1.2.2.3" xref="S2.E1Xa.3.2.2.m1.1.2.2.3.cmml">∗</mo></msup><mo id="S2.E1Xa.3.2.2.m1.1.2.1" xref="S2.E1Xa.3.2.2.m1.1.2.1.cmml">=</mo><mrow id="S2.E1Xa.3.2.2.m1.1.2.3" xref="S2.E1Xa.3.2.2.m1.1.2.3.cmml"><msup id="S2.E1Xa.3.2.2.m1.1.2.3.2" xref="S2.E1Xa.3.2.2.m1.1.2.3.2.cmml"><mi id="S2.E1Xa.3.2.2.m1.1.2.3.2.2" xref="S2.E1Xa.3.2.2.m1.1.2.3.2.2.cmml">R</mi><mo id="S2.E1Xa.3.2.2.m1.1.2.3.2.3" xref="S2.E1Xa.3.2.2.m1.1.2.3.2.3.cmml">∗</mo></msup><mo id="S2.E1Xa.3.2.2.m1.1.2.3.1" xref="S2.E1Xa.3.2.2.m1.1.2.3.1.cmml">⁢</mo><mrow id="S2.E1Xa.3.2.2.m1.1.2.3.3.2" xref="S2.E1Xa.3.2.2.m1.1.2.3.cmml"><mo id="S2.E1Xa.3.2.2.m1.1.2.3.3.2.1" stretchy="false" xref="S2.E1Xa.3.2.2.m1.1.2.3.cmml">(</mo><mi id="S2.E1Xa.3.2.2.m1.1.1" xref="S2.E1Xa.3.2.2.m1.1.1.cmml">Q</mi><mo id="S2.E1Xa.3.2.2.m1.1.2.3.3.2.2" stretchy="false" xref="S2.E1Xa.3.2.2.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1Xa.3.2.2.m1.1b"><apply id="S2.E1Xa.3.2.2.m1.1.2.cmml" xref="S2.E1Xa.3.2.2.m1.1.2"><eq id="S2.E1Xa.3.2.2.m1.1.2.1.cmml" xref="S2.E1Xa.3.2.2.m1.1.2.1"></eq><apply id="S2.E1Xa.3.2.2.m1.1.2.2.cmml" xref="S2.E1Xa.3.2.2.m1.1.2.2"><csymbol cd="ambiguous" id="S2.E1Xa.3.2.2.m1.1.2.2.1.cmml" xref="S2.E1Xa.3.2.2.m1.1.2.2">superscript</csymbol><ci id="S2.E1Xa.3.2.2.m1.1.2.2.2.cmml" xref="S2.E1Xa.3.2.2.m1.1.2.2.2">𝑄</ci><times id="S2.E1Xa.3.2.2.m1.1.2.2.3.cmml" xref="S2.E1Xa.3.2.2.m1.1.2.2.3"></times></apply><apply id="S2.E1Xa.3.2.2.m1.1.2.3.cmml" xref="S2.E1Xa.3.2.2.m1.1.2.3"><times id="S2.E1Xa.3.2.2.m1.1.2.3.1.cmml" xref="S2.E1Xa.3.2.2.m1.1.2.3.1"></times><apply id="S2.E1Xa.3.2.2.m1.1.2.3.2.cmml" xref="S2.E1Xa.3.2.2.m1.1.2.3.2"><csymbol cd="ambiguous" id="S2.E1Xa.3.2.2.m1.1.2.3.2.1.cmml" xref="S2.E1Xa.3.2.2.m1.1.2.3.2">superscript</csymbol><ci id="S2.E1Xa.3.2.2.m1.1.2.3.2.2.cmml" xref="S2.E1Xa.3.2.2.m1.1.2.3.2.2">𝑅</ci><times id="S2.E1Xa.3.2.2.m1.1.2.3.2.3.cmml" xref="S2.E1Xa.3.2.2.m1.1.2.3.2.3"></times></apply><ci id="S2.E1Xa.3.2.2.m1.1.1.cmml" xref="S2.E1Xa.3.2.2.m1.1.1">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1Xa.3.2.2.m1.1c">\displaystyle Q^{*}=R^{*}(Q)</annotation><annotation encoding="application/x-llamapun" id="S2.E1Xa.3.2.2.m1.1d">italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = italic_R start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_Q )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3. </span>Related Work</h3>
<section class="ltx_subsubsection" id="S2.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.3.1. </span>Query Rewrite</h4>
<div class="ltx_para" id="S2.SS3.SSS1.p1">
<p class="ltx_p" id="S2.SS3.SSS1.p1.1">Query rewrite is a significant function in current Database Management Systems (DBMSs), and can be supported in the query optimizers <cite class="ltx_cite ltx_citemacro_citep">(Graefe and McKenna, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib17" title="">1993</a>; Graefe, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib15" title="">1995</a>; Graefe and DeWitt, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib16" title="">1987</a>)</cite>. In particular, DBMSs, such as Calcite <cite class="ltx_cite ltx_citemacro_citep">(Begoli et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib8" title="">2018</a>)</cite> and PostgreSQL <cite class="ltx_cite ltx_citemacro_citep">(Pos, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib5" title="">[n.d.]</a>)</cite>, have developed different rewrite functions to achieve various rewrite rules. Consequently, there are two primary research directions for the query rewriting problem: discovering new rewrite rules and optimally leveraging existing rewrite rules.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.SSS1.p2">
<p class="ltx_p" id="S2.SS3.SSS1.p2.1"><span class="ltx_text ltx_font_bold" id="S2.SS3.SSS1.p2.1.1">Discovering New Rewrite Rules.</span>
Recent advancements, exemplified by Querybooster <cite class="ltx_cite ltx_citemacro_citep">(Bai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib7" title="">2023</a>)</cite> and Wetune <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib28" title="">2022</a>)</cite>, have made significant strides in discovering new rewrite rules through the application of relational algebra proofs <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib30" title="">2022</a>)</cite>. Querybooster enables database users to suggest rules through a specialized rule language, facilitating the back-end generation and application of these rules for more adaptable rewriting. On the other hand, Wetune compiles potential rewrite templates and pinpoints constraints that convert these templates into actionable rules. While these methodologies have proven their worth by efficiently handling small real-world workloads, they have their limitations. Querybooster’s effectiveness hinges on the user’s ability to propose potent rules, whereas Wetune’s efficacy on simple or generalized queries remains uncertain.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.SSS1.p3">
<p class="ltx_p" id="S2.SS3.SSS1.p3.1"><span class="ltx_text ltx_font_bold" id="S2.SS3.SSS1.p3.1.1">Selecting Rewrite Rules.</span> The heuristic rewrite approach executes rewrite rules contingent upon the types of operators involved. Nonetheless, this technique is not without flaws. It might not identify the most optimal sequences for rewriting and often lacks the mechanisms necessary for evaluating the benefits of such rewrites. To address this issue, Learned Rewrite <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib36" title="">2021</a>)</cite> employs a Monte Carlo Tree search to optimize the selection of applicable rules. It conceptualizes each query as a query tree, with applied rules modifying the tree’s structure. This approach utilizes a learned cost model to predict the impact of applying specific rules, enabling the selection of an optimal rewrite sequence through Monte Carlo Tree search. While this method improves adaptability to varying queries and database structures, it faces challenges in cost model accuracy and potential local minima in the search process, highlighting areas for future enhancement in rule-based query rewriting techniques.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.3.2. </span>LLM-based SQL Solvers.</h4>
<div class="ltx_para" id="S2.SS3.SSS2.p1">
<p class="ltx_p" id="S2.SS3.SSS2.p1.1">Large Language Models (LLMs) have recently emerged as a hot topic in machine learning research, captivating the interest of many in the field due to their impressive capabilities. These models have demonstrated a surprisingly strong ability to handle a variety of text-related tasks, excelling in areas such as generation, decision-making, and deduction. One such task that is highly related to DB research is text-to-SQL, in which an LLM directly generates a SQL query given database information and user requirements. Numerous studies <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib21" title="">2023a</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib27" title="">2023</a>; Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib37" title="">2023</a>)</cite> have highlighted the potential of LLMs in the text-to-SQL task, showcasing their proficiency in SQL query-related tasks. While much of this existing research has focused on LLMs’ ability to generate executable queries, there is a growing recognition of the importance of other factors, particularly the efficiency and accuracy of these queries when applied in real-world scenarios. In particular, <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib21" title="">2023a</a>)</cite> discussed their attempts in an efficiency-oriented query rewrite task, where an LLM is directly given an input query and tries to rewrite it into a more efficient one.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS2.p2">
<p class="ltx_p" id="S2.SS3.SSS2.p2.1">However, a significant issue previous LLM-based face is the problem of hallucination, which refers to instances where the model generates output that is not only incorrect but is done so with a misleading level of confidence. This is particularly problematic in the context of database applications, where accuracy is paramount. Therefore, we propose a different direction of utilising the LLMs while overcoming hallucination. Instead of using LLM to directly output an SQL query, we adopted a DB-based SQL rewriter enhanced by an LLM.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.3.3. </span>In-context Learning</h4>
<div class="ltx_para" id="S2.SS3.SSS3.p1">
<p class="ltx_p" id="S2.SS3.SSS3.p1.6">Due to the extensive data and resource requirements of fine-tuning an LLM, many works choose to utilize LLMs by the technique called in-context learning (ICL), where no modifications to the LLMs’ model weights are made. The concept of ICL, first introduced by <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib10" title="">Brown et al<span class="ltx_text">.</span></a></cite> in their seminal work on GPT-3 <cite class="ltx_cite ltx_citemacro_citep">(Brown et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib10" title="">2020</a>)</cite>, shows that language models like GPT-3 can leverage in-context demonstrations at inference time to perform specific tasks, without updating the model weights. ICL typically involves enriching the context with select examples to steer the model’s output. Formally, consider a model denoted as <math alttext="M" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.1.m1.1"><semantics id="S2.SS3.SSS3.p1.1.m1.1a"><mi id="S2.SS3.SSS3.p1.1.m1.1.1" xref="S2.SS3.SSS3.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.1.m1.1b"><ci id="S2.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS3.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.1.m1.1d">italic_M</annotation></semantics></math> and a contextual input represented by <math alttext="P" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.2.m2.1"><semantics id="S2.SS3.SSS3.p1.2.m2.1a"><mi id="S2.SS3.SSS3.p1.2.m2.1.1" xref="S2.SS3.SSS3.p1.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.2.m2.1b"><ci id="S2.SS3.SSS3.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.2.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.2.m2.1d">italic_P</annotation></semantics></math>. The output <math alttext="o" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.3.m3.1"><semantics id="S2.SS3.SSS3.p1.3.m3.1a"><mi id="S2.SS3.SSS3.p1.3.m3.1.1" xref="S2.SS3.SSS3.p1.3.m3.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.3.m3.1b"><ci id="S2.SS3.SSS3.p1.3.m3.1.1.cmml" xref="S2.SS3.SSS3.p1.3.m3.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.3.m3.1c">o</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.3.m3.1d">italic_o</annotation></semantics></math> generated by applying the ICL method to model <math alttext="M" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.4.m4.1"><semantics id="S2.SS3.SSS3.p1.4.m4.1a"><mi id="S2.SS3.SSS3.p1.4.m4.1.1" xref="S2.SS3.SSS3.p1.4.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.4.m4.1b"><ci id="S2.SS3.SSS3.p1.4.m4.1.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.4.m4.1c">M</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.4.m4.1d">italic_M</annotation></semantics></math> with input <math alttext="P" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.5.m5.1"><semantics id="S2.SS3.SSS3.p1.5.m5.1a"><mi id="S2.SS3.SSS3.p1.5.m5.1.1" xref="S2.SS3.SSS3.p1.5.m5.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.5.m5.1b"><ci id="S2.SS3.SSS3.p1.5.m5.1.1.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.5.m5.1c">P</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.5.m5.1d">italic_P</annotation></semantics></math> can be succinctly expressed as <math alttext="o=ICL_{M}(P)" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.6.m6.1"><semantics id="S2.SS3.SSS3.p1.6.m6.1a"><mrow id="S2.SS3.SSS3.p1.6.m6.1.2" xref="S2.SS3.SSS3.p1.6.m6.1.2.cmml"><mi id="S2.SS3.SSS3.p1.6.m6.1.2.2" xref="S2.SS3.SSS3.p1.6.m6.1.2.2.cmml">o</mi><mo id="S2.SS3.SSS3.p1.6.m6.1.2.1" xref="S2.SS3.SSS3.p1.6.m6.1.2.1.cmml">=</mo><mrow id="S2.SS3.SSS3.p1.6.m6.1.2.3" xref="S2.SS3.SSS3.p1.6.m6.1.2.3.cmml"><mi id="S2.SS3.SSS3.p1.6.m6.1.2.3.2" xref="S2.SS3.SSS3.p1.6.m6.1.2.3.2.cmml">I</mi><mo id="S2.SS3.SSS3.p1.6.m6.1.2.3.1" xref="S2.SS3.SSS3.p1.6.m6.1.2.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS3.p1.6.m6.1.2.3.3" xref="S2.SS3.SSS3.p1.6.m6.1.2.3.3.cmml">C</mi><mo id="S2.SS3.SSS3.p1.6.m6.1.2.3.1a" xref="S2.SS3.SSS3.p1.6.m6.1.2.3.1.cmml">⁢</mo><msub id="S2.SS3.SSS3.p1.6.m6.1.2.3.4" xref="S2.SS3.SSS3.p1.6.m6.1.2.3.4.cmml"><mi id="S2.SS3.SSS3.p1.6.m6.1.2.3.4.2" xref="S2.SS3.SSS3.p1.6.m6.1.2.3.4.2.cmml">L</mi><mi id="S2.SS3.SSS3.p1.6.m6.1.2.3.4.3" xref="S2.SS3.SSS3.p1.6.m6.1.2.3.4.3.cmml">M</mi></msub><mo id="S2.SS3.SSS3.p1.6.m6.1.2.3.1b" xref="S2.SS3.SSS3.p1.6.m6.1.2.3.1.cmml">⁢</mo><mrow id="S2.SS3.SSS3.p1.6.m6.1.2.3.5.2" xref="S2.SS3.SSS3.p1.6.m6.1.2.3.cmml"><mo id="S2.SS3.SSS3.p1.6.m6.1.2.3.5.2.1" stretchy="false" xref="S2.SS3.SSS3.p1.6.m6.1.2.3.cmml">(</mo><mi id="S2.SS3.SSS3.p1.6.m6.1.1" xref="S2.SS3.SSS3.p1.6.m6.1.1.cmml">P</mi><mo id="S2.SS3.SSS3.p1.6.m6.1.2.3.5.2.2" stretchy="false" xref="S2.SS3.SSS3.p1.6.m6.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.6.m6.1b"><apply id="S2.SS3.SSS3.p1.6.m6.1.2.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.2"><eq id="S2.SS3.SSS3.p1.6.m6.1.2.1.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.2.1"></eq><ci id="S2.SS3.SSS3.p1.6.m6.1.2.2.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.2.2">𝑜</ci><apply id="S2.SS3.SSS3.p1.6.m6.1.2.3.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.2.3"><times id="S2.SS3.SSS3.p1.6.m6.1.2.3.1.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.2.3.1"></times><ci id="S2.SS3.SSS3.p1.6.m6.1.2.3.2.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.2.3.2">𝐼</ci><ci id="S2.SS3.SSS3.p1.6.m6.1.2.3.3.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.2.3.3">𝐶</ci><apply id="S2.SS3.SSS3.p1.6.m6.1.2.3.4.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.2.3.4"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.6.m6.1.2.3.4.1.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.2.3.4">subscript</csymbol><ci id="S2.SS3.SSS3.p1.6.m6.1.2.3.4.2.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.2.3.4.2">𝐿</ci><ci id="S2.SS3.SSS3.p1.6.m6.1.2.3.4.3.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.2.3.4.3">𝑀</ci></apply><ci id="S2.SS3.SSS3.p1.6.m6.1.1.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.1">𝑃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.6.m6.1c">o=ICL_{M}(P)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.6.m6.1d">italic_o = italic_I italic_C italic_L start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_P )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS3.p2">
<p class="ltx_p" id="S2.SS3.SSS3.p2.1">ICL has rapidly gained popularity for addressing diverse challenges in natural language processing. However, it is a sophisticated technique requiring careful implementation. Extensive research, including studies by <cite class="ltx_cite ltx_citemacro_citep">(Wei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib29" title="">2023</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib22" title="">2023b</a>)</cite>, has explored the intricacies of LLMs’ learning processes in this context. These studies highlight that the success of in-context learning is closely related to the construction of the context and the quality of the examples used.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>LLM-enhanced Rewrite System</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we will introduce our innovative LLM-enhanced rule-based rewrite system (<span class="ltx_text ltx_font_bold" id="S3.p1.1.1">LLM-R<sup class="ltx_sup" id="S3.p1.1.1.1">2</sup></span>). In Section <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S3.SS1" title="3.1. System Pipeline ‣ 3. LLM-enhanced Rewrite System ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">3.1</span></a>, we will first illustrate the pipeline of our rewrite system. Then in Section <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S3.SS2" title="3.2. Demonstration Manager Overview ‣ 3. LLM-enhanced Rewrite System ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">3.2</span></a>, we will state our motivation to optimize the demonstration selection and introduce our novel <span class="ltx_text ltx_font_italic" id="S3.p1.1.2">Demonstration Manager</span> module.</p>
</div>
<figure class="ltx_figure" id="S3.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_missing ltx_missing_image" id="S3.F2.g1" src=""/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>The Framework of LLM-enhanced Rewrite System</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S3.F2.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F2.2">LLM-R</p>
</div>
</div>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>System Pipeline</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">As shown in Figure  <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S3.F2" title="Figure 2 ‣ 3. LLM-enhanced Rewrite System ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">2</span></a>(a), the system integrates an LLM into the query rewrite system utilizing the ICL methodology <cite class="ltx_cite ltx_citemacro_citep">(Brown et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib10" title="">2020</a>)</cite>. We construct the ICL prompt with three main components:</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p2.1.1">Input query:</span> We employ the SQL statement corresponding to the provided input query <math alttext="Q" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_Q</annotation></semantics></math> for the prompt construction.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.2"><span class="ltx_text ltx_font_bold" id="S3.SS1.p3.2.1">Fixed instruction:</span> The fixed instruction consists of a system instruction <math alttext="I" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">I</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_I</annotation></semantics></math> and a rule instruction <math alttext="R" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">italic_R</annotation></semantics></math>. While the system instruction specifies the task requirements, the rule instruction includes a comprehensive list of all candidate rewrite rules available for the language model to select. Each rule is accompanied by a concise explanation, enabling informed decision-making.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.5"><span class="ltx_text ltx_font_bold" id="S3.SS1.p4.5.1">One-shot demonstration:</span> Similar to directly using LLMs to rewrite queries, selecting rewrite rules using LLMs may also easily suffer from the hallucination problem, like outputting non-existing rules. To mitigate this and ensure the LLMs’ outputs are more closely aligned with our task requirements, yielding superior rule suggestions, we use the demonstration as a part of the prompt. Formally, we define our demonstration given to the LLM-R<sup class="ltx_sup" id="S3.SS1.p4.5.2">2</sup> system as a pair of text <math alttext="D=\langle Q^{D},R^{D}\rangle" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.2"><semantics id="S3.SS1.p4.1.m1.2a"><mrow id="S3.SS1.p4.1.m1.2.2" xref="S3.SS1.p4.1.m1.2.2.cmml"><mi id="S3.SS1.p4.1.m1.2.2.4" xref="S3.SS1.p4.1.m1.2.2.4.cmml">D</mi><mo id="S3.SS1.p4.1.m1.2.2.3" xref="S3.SS1.p4.1.m1.2.2.3.cmml">=</mo><mrow id="S3.SS1.p4.1.m1.2.2.2.2" xref="S3.SS1.p4.1.m1.2.2.2.3.cmml"><mo id="S3.SS1.p4.1.m1.2.2.2.2.3" stretchy="false" xref="S3.SS1.p4.1.m1.2.2.2.3.cmml">⟨</mo><msup id="S3.SS1.p4.1.m1.1.1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.1.1.1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.1.1.1.2.cmml">Q</mi><mi id="S3.SS1.p4.1.m1.1.1.1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.1.1.1.3.cmml">D</mi></msup><mo id="S3.SS1.p4.1.m1.2.2.2.2.4" xref="S3.SS1.p4.1.m1.2.2.2.3.cmml">,</mo><msup id="S3.SS1.p4.1.m1.2.2.2.2.2" xref="S3.SS1.p4.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS1.p4.1.m1.2.2.2.2.2.2" xref="S3.SS1.p4.1.m1.2.2.2.2.2.2.cmml">R</mi><mi id="S3.SS1.p4.1.m1.2.2.2.2.2.3" xref="S3.SS1.p4.1.m1.2.2.2.2.2.3.cmml">D</mi></msup><mo id="S3.SS1.p4.1.m1.2.2.2.2.5" stretchy="false" xref="S3.SS1.p4.1.m1.2.2.2.3.cmml">⟩</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.2b"><apply id="S3.SS1.p4.1.m1.2.2.cmml" xref="S3.SS1.p4.1.m1.2.2"><eq id="S3.SS1.p4.1.m1.2.2.3.cmml" xref="S3.SS1.p4.1.m1.2.2.3"></eq><ci id="S3.SS1.p4.1.m1.2.2.4.cmml" xref="S3.SS1.p4.1.m1.2.2.4">𝐷</ci><list id="S3.SS1.p4.1.m1.2.2.2.3.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2"><apply id="S3.SS1.p4.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.2">𝑄</ci><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.3">𝐷</ci></apply><apply id="S3.SS1.p4.1.m1.2.2.2.2.2.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.2">superscript</csymbol><ci id="S3.SS1.p4.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.2.2">𝑅</ci><ci id="S3.SS1.p4.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.2.3">𝐷</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.2c">D=\langle Q^{D},R^{D}\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.2d">italic_D = ⟨ italic_Q start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT , italic_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT ⟩</annotation></semantics></math>, where <math alttext="Q^{D}" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.1"><semantics id="S3.SS1.p4.2.m2.1a"><msup id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><mi id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml">Q</mi><mi id="S3.SS1.p4.2.m2.1.1.3" xref="S3.SS1.p4.2.m2.1.1.3.cmml">D</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">superscript</csymbol><ci id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2">𝑄</ci><ci id="S3.SS1.p4.2.m2.1.1.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">Q^{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.m2.1d">italic_Q start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> is the example query assembling the input query and <math alttext="R^{D}=[r^{D}_{1},\cdots]" class="ltx_Math" display="inline" id="S3.SS1.p4.3.m3.2"><semantics id="S3.SS1.p4.3.m3.2a"><mrow id="S3.SS1.p4.3.m3.2.2" xref="S3.SS1.p4.3.m3.2.2.cmml"><msup id="S3.SS1.p4.3.m3.2.2.3" xref="S3.SS1.p4.3.m3.2.2.3.cmml"><mi id="S3.SS1.p4.3.m3.2.2.3.2" xref="S3.SS1.p4.3.m3.2.2.3.2.cmml">R</mi><mi id="S3.SS1.p4.3.m3.2.2.3.3" xref="S3.SS1.p4.3.m3.2.2.3.3.cmml">D</mi></msup><mo id="S3.SS1.p4.3.m3.2.2.2" xref="S3.SS1.p4.3.m3.2.2.2.cmml">=</mo><mrow id="S3.SS1.p4.3.m3.2.2.1.1" xref="S3.SS1.p4.3.m3.2.2.1.2.cmml"><mo id="S3.SS1.p4.3.m3.2.2.1.1.2" stretchy="false" xref="S3.SS1.p4.3.m3.2.2.1.2.cmml">[</mo><msubsup id="S3.SS1.p4.3.m3.2.2.1.1.1" xref="S3.SS1.p4.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS1.p4.3.m3.2.2.1.1.1.2.2" xref="S3.SS1.p4.3.m3.2.2.1.1.1.2.2.cmml">r</mi><mn id="S3.SS1.p4.3.m3.2.2.1.1.1.3" xref="S3.SS1.p4.3.m3.2.2.1.1.1.3.cmml">1</mn><mi id="S3.SS1.p4.3.m3.2.2.1.1.1.2.3" xref="S3.SS1.p4.3.m3.2.2.1.1.1.2.3.cmml">D</mi></msubsup><mo id="S3.SS1.p4.3.m3.2.2.1.1.3" xref="S3.SS1.p4.3.m3.2.2.1.2.cmml">,</mo><mi id="S3.SS1.p4.3.m3.1.1" mathvariant="normal" xref="S3.SS1.p4.3.m3.1.1.cmml">⋯</mi><mo id="S3.SS1.p4.3.m3.2.2.1.1.4" stretchy="false" xref="S3.SS1.p4.3.m3.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.2b"><apply id="S3.SS1.p4.3.m3.2.2.cmml" xref="S3.SS1.p4.3.m3.2.2"><eq id="S3.SS1.p4.3.m3.2.2.2.cmml" xref="S3.SS1.p4.3.m3.2.2.2"></eq><apply id="S3.SS1.p4.3.m3.2.2.3.cmml" xref="S3.SS1.p4.3.m3.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p4.3.m3.2.2.3.1.cmml" xref="S3.SS1.p4.3.m3.2.2.3">superscript</csymbol><ci id="S3.SS1.p4.3.m3.2.2.3.2.cmml" xref="S3.SS1.p4.3.m3.2.2.3.2">𝑅</ci><ci id="S3.SS1.p4.3.m3.2.2.3.3.cmml" xref="S3.SS1.p4.3.m3.2.2.3.3">𝐷</ci></apply><interval closure="closed" id="S3.SS1.p4.3.m3.2.2.1.2.cmml" xref="S3.SS1.p4.3.m3.2.2.1.1"><apply id="S3.SS1.p4.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p4.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.p4.3.m3.2.2.1.1.1">subscript</csymbol><apply id="S3.SS1.p4.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.p4.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.3.m3.2.2.1.1.1.2.1.cmml" xref="S3.SS1.p4.3.m3.2.2.1.1.1">superscript</csymbol><ci id="S3.SS1.p4.3.m3.2.2.1.1.1.2.2.cmml" xref="S3.SS1.p4.3.m3.2.2.1.1.1.2.2">𝑟</ci><ci id="S3.SS1.p4.3.m3.2.2.1.1.1.2.3.cmml" xref="S3.SS1.p4.3.m3.2.2.1.1.1.2.3">𝐷</ci></apply><cn id="S3.SS1.p4.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p4.3.m3.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">⋯</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.2c">R^{D}=[r^{D}_{1},\cdots]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.3.m3.2d">italic_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT = [ italic_r start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋯ ]</annotation></semantics></math> is the list of rules that have been applied to rewrite the example query. Such demonstrations can successfully instruct the LLM to follow the example and output a list of rewrite rules to apply on the new input query. In particular, this involves selecting a high-quality demonstration <math alttext="D" class="ltx_Math" display="inline" id="S3.SS1.p4.4.m4.1"><semantics id="S3.SS1.p4.4.m4.1a"><mi id="S3.SS1.p4.4.m4.1.1" xref="S3.SS1.p4.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.1b"><ci id="S3.SS1.p4.4.m4.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.4.m4.1d">italic_D</annotation></semantics></math> from many successful rewritten demonstrations (i.e., denoted as a pool <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS1.p4.5.m5.1"><semantics id="S3.SS1.p4.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.5.m5.1.1" xref="S3.SS1.p4.5.m5.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m5.1b"><ci id="S3.SS1.p4.5.m5.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m5.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.5.m5.1d">caligraphic_D</annotation></semantics></math>) for each input query to guide the LLM effectively. To achieve this goal, we design a module named <span class="ltx_text ltx_font_italic" id="S3.SS1.p4.5.3">Demonstration Manager</span>, whose details are elucidated in the subsequent section.</p>
</div>
<figure class="ltx_figure" id="S3.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_missing ltx_missing_image" id="S3.F3.g1" src=""/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>An Example of the In-Context Learning Process in LLM-R<sup class="ltx_sup" id="S3.F3.2.1">2</sup>. All the instructions are concatenated together as one string input to the LLM. In a zero-shot setting, the “Demonstration Instruction” will be removed and an input query will be appended directly after the “Rule Instruction”.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S3.F3.3">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F3.4">icl_example</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.1">As specifically highlighted, Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S3.F3" title="Figure 3 ‣ 3.1. System Pipeline ‣ 3. LLM-enhanced Rewrite System ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">3</span></a> delineates the prompt utilized within the In-Context Learning (ICL) process of our system. Upon constructing the prompt and feeding it into the LLM, we can extract a sequence of rewrite rules from the model’s output. These rules undergo further processing and execution by a database-based rule executor. For instance, the original input query in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S3.F2" title="Figure 2 ‣ 3. LLM-enhanced Rewrite System ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">2</span></a>(a) is modified by the “AGGREGATE_PROJECT_MERGE” rule, as highlighted in bold. This modification transforms the original query into a more optimized output query, demonstrating the practical application and effectiveness of the extracted rules in query optimization processes. Through the synergy of the LLM’s superior generalization capabilities and the rule executor’s precision, our proposed system guarantees extensive applicability, alongside ensuring the executability and equivalence of the rewritten queries. Consequently, this rewrite process can be formalized as follows:</p>
</div>
<div class="ltx_theorem ltx_theorem_definition" id="S3.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_theorem">Definition 3.1.</h6>
<div class="ltx_para" id="S3.Thmtheorem1.p1">
<p class="ltx_p" id="S3.Thmtheorem1.p1.8">(LLM-enhanced Query Rewrite): Given a large language model <math alttext="M" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.1.m1.1"><semantics id="S3.Thmtheorem1.p1.1.m1.1a"><mi id="S3.Thmtheorem1.p1.1.m1.1.1" xref="S3.Thmtheorem1.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.1.m1.1b"><ci id="S3.Thmtheorem1.p1.1.m1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.1.m1.1d">italic_M</annotation></semantics></math>, a textual instruction outlining the rewrite task <math alttext="I" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.2.m2.1"><semantics id="S3.Thmtheorem1.p1.2.m2.1a"><mi id="S3.Thmtheorem1.p1.2.m2.1.1" xref="S3.Thmtheorem1.p1.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.2.m2.1b"><ci id="S3.Thmtheorem1.p1.2.m2.1.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.2.m2.1c">I</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.2.m2.1d">italic_I</annotation></semantics></math>, a set of candidate rules <math alttext="R" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.3.m3.1"><semantics id="S3.Thmtheorem1.p1.3.m3.1a"><mi id="S3.Thmtheorem1.p1.3.m3.1.1" xref="S3.Thmtheorem1.p1.3.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.3.m3.1b"><ci id="S3.Thmtheorem1.p1.3.m3.1.1.cmml" xref="S3.Thmtheorem1.p1.3.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.3.m3.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.3.m3.1d">italic_R</annotation></semantics></math>, one successful rewrite demonstration <math alttext="D" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.4.m4.1"><semantics id="S3.Thmtheorem1.p1.4.m4.1a"><mi id="S3.Thmtheorem1.p1.4.m4.1.1" xref="S3.Thmtheorem1.p1.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.4.m4.1b"><ci id="S3.Thmtheorem1.p1.4.m4.1.1.cmml" xref="S3.Thmtheorem1.p1.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.4.m4.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.4.m4.1d">italic_D</annotation></semantics></math> selected from the demonstration pool <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.5.m5.1"><semantics id="S3.Thmtheorem1.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem1.p1.5.m5.1.1" xref="S3.Thmtheorem1.p1.5.m5.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.5.m5.1b"><ci id="S3.Thmtheorem1.p1.5.m5.1.1.cmml" xref="S3.Thmtheorem1.p1.5.m5.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.5.m5.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.5.m5.1d">caligraphic_D</annotation></semantics></math>, and an input query <math alttext="Q" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.6.m6.1"><semantics id="S3.Thmtheorem1.p1.6.m6.1a"><mi id="S3.Thmtheorem1.p1.6.m6.1.1" xref="S3.Thmtheorem1.p1.6.m6.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.6.m6.1b"><ci id="S3.Thmtheorem1.p1.6.m6.1.1.cmml" xref="S3.Thmtheorem1.p1.6.m6.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.6.m6.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.6.m6.1d">italic_Q</annotation></semantics></math>, a prompt <math alttext="P" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.7.m7.1"><semantics id="S3.Thmtheorem1.p1.7.m7.1a"><mi id="S3.Thmtheorem1.p1.7.m7.1.1" xref="S3.Thmtheorem1.p1.7.m7.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.7.m7.1b"><ci id="S3.Thmtheorem1.p1.7.m7.1.1.cmml" xref="S3.Thmtheorem1.p1.7.m7.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.7.m7.1c">P</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.7.m7.1d">italic_P</annotation></semantics></math> is constructed and provided as input to <math alttext="M" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.8.m8.1"><semantics id="S3.Thmtheorem1.p1.8.m8.1a"><mi id="S3.Thmtheorem1.p1.8.m8.1.1" xref="S3.Thmtheorem1.p1.8.m8.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.8.m8.1b"><ci id="S3.Thmtheorem1.p1.8.m8.1.1.cmml" xref="S3.Thmtheorem1.p1.8.m8.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.8.m8.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.8.m8.1d">italic_M</annotation></semantics></math> as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P=I\oplus R\oplus D\oplus Q" class="ltx_Math" display="block" id="S3.Ex1.m1.1"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.2" xref="S3.Ex1.m1.1.1.2.cmml">P</mi><mo id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.cmml">=</mo><mrow id="S3.Ex1.m1.1.1.3" xref="S3.Ex1.m1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.3.2" xref="S3.Ex1.m1.1.1.3.2.cmml">I</mi><mo id="S3.Ex1.m1.1.1.3.1" xref="S3.Ex1.m1.1.1.3.1.cmml">⊕</mo><mi id="S3.Ex1.m1.1.1.3.3" xref="S3.Ex1.m1.1.1.3.3.cmml">R</mi><mo id="S3.Ex1.m1.1.1.3.1a" xref="S3.Ex1.m1.1.1.3.1.cmml">⊕</mo><mi id="S3.Ex1.m1.1.1.3.4" xref="S3.Ex1.m1.1.1.3.4.cmml">D</mi><mo id="S3.Ex1.m1.1.1.3.1b" xref="S3.Ex1.m1.1.1.3.1.cmml">⊕</mo><mi id="S3.Ex1.m1.1.1.3.5" xref="S3.Ex1.m1.1.1.3.5.cmml">Q</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1"><eq id="S3.Ex1.m1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1"></eq><ci id="S3.Ex1.m1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.2">𝑃</ci><apply id="S3.Ex1.m1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.3"><csymbol cd="latexml" id="S3.Ex1.m1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.3.1">direct-sum</csymbol><ci id="S3.Ex1.m1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.3.2">𝐼</ci><ci id="S3.Ex1.m1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.3.3">𝑅</ci><ci id="S3.Ex1.m1.1.1.3.4.cmml" xref="S3.Ex1.m1.1.1.3.4">𝐷</ci><ci id="S3.Ex1.m1.1.1.3.5.cmml" xref="S3.Ex1.m1.1.1.3.5">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">P=I\oplus R\oplus D\oplus Q</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.1d">italic_P = italic_I ⊕ italic_R ⊕ italic_D ⊕ italic_Q</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.Thmtheorem1.p1.10">From <math alttext="M" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.9.m1.1"><semantics id="S3.Thmtheorem1.p1.9.m1.1a"><mi id="S3.Thmtheorem1.p1.9.m1.1.1" xref="S3.Thmtheorem1.p1.9.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.9.m1.1b"><ci id="S3.Thmtheorem1.p1.9.m1.1.1.cmml" xref="S3.Thmtheorem1.p1.9.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.9.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.9.m1.1d">italic_M</annotation></semantics></math>, a sequence of rewrite rules <math alttext="R^{*}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.10.m2.1"><semantics id="S3.Thmtheorem1.p1.10.m2.1a"><msup id="S3.Thmtheorem1.p1.10.m2.1.1" xref="S3.Thmtheorem1.p1.10.m2.1.1.cmml"><mi id="S3.Thmtheorem1.p1.10.m2.1.1.2" xref="S3.Thmtheorem1.p1.10.m2.1.1.2.cmml">R</mi><mo id="S3.Thmtheorem1.p1.10.m2.1.1.3" xref="S3.Thmtheorem1.p1.10.m2.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.10.m2.1b"><apply id="S3.Thmtheorem1.p1.10.m2.1.1.cmml" xref="S3.Thmtheorem1.p1.10.m2.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.10.m2.1.1.1.cmml" xref="S3.Thmtheorem1.p1.10.m2.1.1">superscript</csymbol><ci id="S3.Thmtheorem1.p1.10.m2.1.1.2.cmml" xref="S3.Thmtheorem1.p1.10.m2.1.1.2">𝑅</ci><times id="S3.Thmtheorem1.p1.10.m2.1.1.3.cmml" xref="S3.Thmtheorem1.p1.10.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.10.m2.1c">R^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.10.m2.1d">italic_R start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> is derived:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R^{*}=ICL_{M}(P)" class="ltx_Math" display="block" id="S3.Ex2.m1.1"><semantics id="S3.Ex2.m1.1a"><mrow id="S3.Ex2.m1.1.2" xref="S3.Ex2.m1.1.2.cmml"><msup id="S3.Ex2.m1.1.2.2" xref="S3.Ex2.m1.1.2.2.cmml"><mi id="S3.Ex2.m1.1.2.2.2" xref="S3.Ex2.m1.1.2.2.2.cmml">R</mi><mo id="S3.Ex2.m1.1.2.2.3" xref="S3.Ex2.m1.1.2.2.3.cmml">∗</mo></msup><mo id="S3.Ex2.m1.1.2.1" xref="S3.Ex2.m1.1.2.1.cmml">=</mo><mrow id="S3.Ex2.m1.1.2.3" xref="S3.Ex2.m1.1.2.3.cmml"><mi id="S3.Ex2.m1.1.2.3.2" xref="S3.Ex2.m1.1.2.3.2.cmml">I</mi><mo id="S3.Ex2.m1.1.2.3.1" xref="S3.Ex2.m1.1.2.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.1.2.3.3" xref="S3.Ex2.m1.1.2.3.3.cmml">C</mi><mo id="S3.Ex2.m1.1.2.3.1a" xref="S3.Ex2.m1.1.2.3.1.cmml">⁢</mo><msub id="S3.Ex2.m1.1.2.3.4" xref="S3.Ex2.m1.1.2.3.4.cmml"><mi id="S3.Ex2.m1.1.2.3.4.2" xref="S3.Ex2.m1.1.2.3.4.2.cmml">L</mi><mi id="S3.Ex2.m1.1.2.3.4.3" xref="S3.Ex2.m1.1.2.3.4.3.cmml">M</mi></msub><mo id="S3.Ex2.m1.1.2.3.1b" xref="S3.Ex2.m1.1.2.3.1.cmml">⁢</mo><mrow id="S3.Ex2.m1.1.2.3.5.2" xref="S3.Ex2.m1.1.2.3.cmml"><mo id="S3.Ex2.m1.1.2.3.5.2.1" stretchy="false" xref="S3.Ex2.m1.1.2.3.cmml">(</mo><mi id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml">P</mi><mo id="S3.Ex2.m1.1.2.3.5.2.2" stretchy="false" xref="S3.Ex2.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.1b"><apply id="S3.Ex2.m1.1.2.cmml" xref="S3.Ex2.m1.1.2"><eq id="S3.Ex2.m1.1.2.1.cmml" xref="S3.Ex2.m1.1.2.1"></eq><apply id="S3.Ex2.m1.1.2.2.cmml" xref="S3.Ex2.m1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.2.2.1.cmml" xref="S3.Ex2.m1.1.2.2">superscript</csymbol><ci id="S3.Ex2.m1.1.2.2.2.cmml" xref="S3.Ex2.m1.1.2.2.2">𝑅</ci><times id="S3.Ex2.m1.1.2.2.3.cmml" xref="S3.Ex2.m1.1.2.2.3"></times></apply><apply id="S3.Ex2.m1.1.2.3.cmml" xref="S3.Ex2.m1.1.2.3"><times id="S3.Ex2.m1.1.2.3.1.cmml" xref="S3.Ex2.m1.1.2.3.1"></times><ci id="S3.Ex2.m1.1.2.3.2.cmml" xref="S3.Ex2.m1.1.2.3.2">𝐼</ci><ci id="S3.Ex2.m1.1.2.3.3.cmml" xref="S3.Ex2.m1.1.2.3.3">𝐶</ci><apply id="S3.Ex2.m1.1.2.3.4.cmml" xref="S3.Ex2.m1.1.2.3.4"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.2.3.4.1.cmml" xref="S3.Ex2.m1.1.2.3.4">subscript</csymbol><ci id="S3.Ex2.m1.1.2.3.4.2.cmml" xref="S3.Ex2.m1.1.2.3.4.2">𝐿</ci><ci id="S3.Ex2.m1.1.2.3.4.3.cmml" xref="S3.Ex2.m1.1.2.3.4.3">𝑀</ci></apply><ci id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1">𝑃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.1c">R^{*}=ICL_{M}(P)</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m1.1d">italic_R start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = italic_I italic_C italic_L start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_P )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.Thmtheorem1.p1.12">By sequentially applying these rewrite rules <math alttext="R^{*}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.11.m1.1"><semantics id="S3.Thmtheorem1.p1.11.m1.1a"><msup id="S3.Thmtheorem1.p1.11.m1.1.1" xref="S3.Thmtheorem1.p1.11.m1.1.1.cmml"><mi id="S3.Thmtheorem1.p1.11.m1.1.1.2" xref="S3.Thmtheorem1.p1.11.m1.1.1.2.cmml">R</mi><mo id="S3.Thmtheorem1.p1.11.m1.1.1.3" xref="S3.Thmtheorem1.p1.11.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.11.m1.1b"><apply id="S3.Thmtheorem1.p1.11.m1.1.1.cmml" xref="S3.Thmtheorem1.p1.11.m1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.11.m1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.11.m1.1.1">superscript</csymbol><ci id="S3.Thmtheorem1.p1.11.m1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.11.m1.1.1.2">𝑅</ci><times id="S3.Thmtheorem1.p1.11.m1.1.1.3.cmml" xref="S3.Thmtheorem1.p1.11.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.11.m1.1c">R^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.11.m1.1d">italic_R start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>, we generate an optimally equivalent query, represented as <math alttext="Q^{*}=R^{*}(Q)" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.12.m2.1"><semantics id="S3.Thmtheorem1.p1.12.m2.1a"><mrow id="S3.Thmtheorem1.p1.12.m2.1.2" xref="S3.Thmtheorem1.p1.12.m2.1.2.cmml"><msup id="S3.Thmtheorem1.p1.12.m2.1.2.2" xref="S3.Thmtheorem1.p1.12.m2.1.2.2.cmml"><mi id="S3.Thmtheorem1.p1.12.m2.1.2.2.2" xref="S3.Thmtheorem1.p1.12.m2.1.2.2.2.cmml">Q</mi><mo id="S3.Thmtheorem1.p1.12.m2.1.2.2.3" xref="S3.Thmtheorem1.p1.12.m2.1.2.2.3.cmml">∗</mo></msup><mo id="S3.Thmtheorem1.p1.12.m2.1.2.1" xref="S3.Thmtheorem1.p1.12.m2.1.2.1.cmml">=</mo><mrow id="S3.Thmtheorem1.p1.12.m2.1.2.3" xref="S3.Thmtheorem1.p1.12.m2.1.2.3.cmml"><msup id="S3.Thmtheorem1.p1.12.m2.1.2.3.2" xref="S3.Thmtheorem1.p1.12.m2.1.2.3.2.cmml"><mi id="S3.Thmtheorem1.p1.12.m2.1.2.3.2.2" xref="S3.Thmtheorem1.p1.12.m2.1.2.3.2.2.cmml">R</mi><mo id="S3.Thmtheorem1.p1.12.m2.1.2.3.2.3" xref="S3.Thmtheorem1.p1.12.m2.1.2.3.2.3.cmml">∗</mo></msup><mo id="S3.Thmtheorem1.p1.12.m2.1.2.3.1" xref="S3.Thmtheorem1.p1.12.m2.1.2.3.1.cmml">⁢</mo><mrow id="S3.Thmtheorem1.p1.12.m2.1.2.3.3.2" xref="S3.Thmtheorem1.p1.12.m2.1.2.3.cmml"><mo id="S3.Thmtheorem1.p1.12.m2.1.2.3.3.2.1" stretchy="false" xref="S3.Thmtheorem1.p1.12.m2.1.2.3.cmml">(</mo><mi id="S3.Thmtheorem1.p1.12.m2.1.1" xref="S3.Thmtheorem1.p1.12.m2.1.1.cmml">Q</mi><mo id="S3.Thmtheorem1.p1.12.m2.1.2.3.3.2.2" stretchy="false" xref="S3.Thmtheorem1.p1.12.m2.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.12.m2.1b"><apply id="S3.Thmtheorem1.p1.12.m2.1.2.cmml" xref="S3.Thmtheorem1.p1.12.m2.1.2"><eq id="S3.Thmtheorem1.p1.12.m2.1.2.1.cmml" xref="S3.Thmtheorem1.p1.12.m2.1.2.1"></eq><apply id="S3.Thmtheorem1.p1.12.m2.1.2.2.cmml" xref="S3.Thmtheorem1.p1.12.m2.1.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.12.m2.1.2.2.1.cmml" xref="S3.Thmtheorem1.p1.12.m2.1.2.2">superscript</csymbol><ci id="S3.Thmtheorem1.p1.12.m2.1.2.2.2.cmml" xref="S3.Thmtheorem1.p1.12.m2.1.2.2.2">𝑄</ci><times id="S3.Thmtheorem1.p1.12.m2.1.2.2.3.cmml" xref="S3.Thmtheorem1.p1.12.m2.1.2.2.3"></times></apply><apply id="S3.Thmtheorem1.p1.12.m2.1.2.3.cmml" xref="S3.Thmtheorem1.p1.12.m2.1.2.3"><times id="S3.Thmtheorem1.p1.12.m2.1.2.3.1.cmml" xref="S3.Thmtheorem1.p1.12.m2.1.2.3.1"></times><apply id="S3.Thmtheorem1.p1.12.m2.1.2.3.2.cmml" xref="S3.Thmtheorem1.p1.12.m2.1.2.3.2"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.12.m2.1.2.3.2.1.cmml" xref="S3.Thmtheorem1.p1.12.m2.1.2.3.2">superscript</csymbol><ci id="S3.Thmtheorem1.p1.12.m2.1.2.3.2.2.cmml" xref="S3.Thmtheorem1.p1.12.m2.1.2.3.2.2">𝑅</ci><times id="S3.Thmtheorem1.p1.12.m2.1.2.3.2.3.cmml" xref="S3.Thmtheorem1.p1.12.m2.1.2.3.2.3"></times></apply><ci id="S3.Thmtheorem1.p1.12.m2.1.1.cmml" xref="S3.Thmtheorem1.p1.12.m2.1.1">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.12.m2.1c">Q^{*}=R^{*}(Q)</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.12.m2.1d">italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = italic_R start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_Q )</annotation></semantics></math>.
</p>
</div>
</div>
<figure class="ltx_figure" id="S3.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_missing ltx_missing_image" id="S3.F4.g1" src=""/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>Example of good and bad demonstration selections</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S3.F4.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F4.2">demonstration_example</p>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Demonstration Manager Overview</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.5"><span class="ltx_text ltx_font_bold" id="S3.SS2.p1.5.1">Motivation.</span> In the above ICL process, optimizing the prompt <math alttext="P=I\oplus R\oplus D\oplus Q" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">P</mi><mo id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">I</mi><mo id="S3.SS2.p1.1.m1.1.1.3.1" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">⊕</mo><mi id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml">R</mi><mo id="S3.SS2.p1.1.m1.1.1.3.1a" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">⊕</mo><mi id="S3.SS2.p1.1.m1.1.1.3.4" xref="S3.SS2.p1.1.m1.1.1.3.4.cmml">D</mi><mo id="S3.SS2.p1.1.m1.1.1.3.1b" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">⊕</mo><mi id="S3.SS2.p1.1.m1.1.1.3.5" xref="S3.SS2.p1.1.m1.1.1.3.5.cmml">Q</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><eq id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"></eq><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑃</ci><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><csymbol cd="latexml" id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.1">direct-sum</csymbol><ci id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">𝐼</ci><ci id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3">𝑅</ci><ci id="S3.SS2.p1.1.m1.1.1.3.4.cmml" xref="S3.SS2.p1.1.m1.1.1.3.4">𝐷</ci><ci id="S3.SS2.p1.1.m1.1.1.3.5.cmml" xref="S3.SS2.p1.1.m1.1.1.3.5">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">P=I\oplus R\oplus D\oplus Q</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_P = italic_I ⊕ italic_R ⊕ italic_D ⊕ italic_Q</annotation></semantics></math> is crucial for improving the output quality of LLMs. Given the fixed settings of system instruction(<math alttext="I" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">I</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_I</annotation></semantics></math>), rule instruction(<math alttext="R" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_R</annotation></semantics></math>), and input query(<math alttext="Q" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_Q</annotation></semantics></math>), our optimization efforts focus primarily on the demonstration(<math alttext="D" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">italic_D</annotation></semantics></math>), which is chosen to enhance model performance. Recent studies on LLMs (e.g.,  <cite class="ltx_cite ltx_citemacro_citep">(Brown et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib10" title="">2020</a>; Wei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib29" title="">2023</a>)</cite>) have underscored the positive impact of high-quality in-context demonstrations on LLM output, reducing the tendency of LLMs to produce hallucinatory content. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S3.F4" title="Figure 4 ‣ 3.1. System Pipeline ‣ 3. LLM-enhanced Rewrite System ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">4</span></a>, our rewrite system exhibits similar effectiveness variability w.r.t. the demonstrations used, further emphasizing the necessity of optimizing demonstration selection for specific input queries. Therefore, it is an important problem to optimize the demonstration selected for a given input query. Particularly, we address this problem by designing the <span class="ltx_text ltx_font_italic" id="S3.SS2.p1.5.2">Demonstration Manager</span> module.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.1.1">Overview.</span> Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S3.F2" title="Figure 2 ‣ 3. LLM-enhanced Rewrite System ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">2</span></a>(b) illustrates the basic structure of our proposed <span class="ltx_text ltx_font_italic" id="S3.SS2.p2.1.2">Demonstration Manager</span> module, comprising two parts: <span class="ltx_text ltx_font_italic" id="S3.SS2.p2.1.3">Demonstration Preparation</span> and <span class="ltx_text ltx_font_italic" id="S3.SS2.p2.1.4">Demonstration Selection</span>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">(1) The primary objective of the Demonstration Preparation is to generate a substantial number of successful rewritten demonstrations for constructing a demonstration pool. Furthermore, this part also serves to supply training data essential for model learning in the second part. Specifically, we design two modules: the <span class="ltx_text ltx_font_italic" id="S3.SS2.p3.1.1">Benefit Estimator</span> and the <span class="ltx_text ltx_font_italic" id="S3.SS2.p3.1.2">Pool Generator</span>, to achieve our objectives. The <span class="ltx_text ltx_font_italic" id="S3.SS2.p3.1.3">Benefit Estimator</span> is capable of assessing the potential benefits of a given query rewrite strategy, thereby generating corresponding rewrite tuple recording the performance of this rewrite strategy on the input query. Subsequently, the <span class="ltx_text ltx_font_italic" id="S3.SS2.p3.1.4">Pool Generator</span> is employed to extract demonstrations for constructing a pool. Moreover, we utilize the rewrite tuples to derive training triplets, which are essential for model learning in subsequent parts.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1">(2) The second part involves the <span class="ltx_text ltx_font_italic" id="S3.SS2.p4.1.1">Demonstration Selection</span> module, tasked with identifying the optimal demonstration from the pool for each input query. This process is enhanced by incorporating a query representation model within the selector, designed to evaluate the similarity between input queries and demonstrations in the pool. This representation model undergoes offline training using the training data. In addition, to obtain an effective model, we enhance the model’s training through the integration of a curriculum learning approach. Afterwards, the trained model is integrated into <span class="ltx_text ltx_font_italic" id="S3.SS2.p4.1.2">Demonstration Selector</span> for online inference. In other words, upon receiving an input query for rewriting, the selector discerns and selects the most appropriate demonstration from the pool based on the trained model. More detailed elaboration on the above two parts will be provided in the following sections.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Demonstration Preparation</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we aim to generate sufficient high-quality data to build the demonstration pool. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S4.F5" title="Figure 5 ‣ 4. Demonstration Preparation ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">5</span></a>, we first design the <span class="ltx_text ltx_font_italic" id="S4.p1.1.1">Benefit Estimator</span> module to generate the ground truth, where each ground truth data point indicates the efficiency gain obtained by rewriting an input query using generated rules in the context of a demonstration. With sufficient ground truth, including both good and bad samples, we further design the <span class="ltx_text ltx_font_italic" id="S4.p1.1.2">Pool Generator</span> module to select all good samples to build the demonstration pool. In addition, we can deduce contrastive training triplets from the ground truth, which can help train our selection model.</p>
</div>
<figure class="ltx_figure" id="S4.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_missing ltx_missing_image" id="S4.F5.g1" src=""/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5. </span>Our demonstration preparation module generates a set of training triplets and a demonstration pool.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S4.F5.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.F5.2">data manager</p>
</div>
</div>
</figure>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Benefit Estimator</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">Since we are only able to start with solely training queries without demonstrations, the triplet generation pipeline is segmented into two distinct phases: the first stage involves initializing high quality candidate demonstrations utilizing baseline method and a zero-shot <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">LLM-R<sup class="ltx_sup" id="S4.SS1.p1.1.1.1">2</sup></span> system where no demonstration is selected, followed by the demonstration adoption stage employing a one-shot <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.2">LLM-R<sup class="ltx_sup" id="S4.SS1.p1.1.2.1">2</sup></span> system. Subsequently, each stage is elucidated in detail.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">Stage-1:</span> We start with a diverse set of input queries collected from our dataset as the training set. To obtain a rich set of effective rewrites as candidate demonstrations, we first apply our zero-shot LLM-enhanced rewrite system (LLM-R<sup class="ltx_sup" id="S4.SS1.p2.1.2">2</sup>) to rewrite the training set queries. After getting the rewrite rules adopted and the resulted rewrite queries, we directly execute the rewritten queries on the corresponding databases. The execution time of the rewritten queries as well as the original queries is evaluated to collect the initial candidate demonstration set consisting of the improvable queries, together with their rules adopted.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.1">Stage-2:</span> With the candidate demonstrations collected from the previous step, we can then estimate the benefits of these demonstrations when they are selected for a given input query. Motivated by <cite class="ltx_cite ltx_citemacro_citep">(Wei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib29" title="">2023</a>)</cite>, such improvable demonstrations are supposed to be more useful for the LLM to output improving rewrite suggestions, compared to using any degraded rewrite queries as demonstrations. In addition, the more “similar” the improving demonstration query is to the input query, the better output the LLM will generate. However, different from natural language inputs’ simple textual similarity, the similarity between SQL queries is indeed more complicated. To identify if the pool we collected truly contains high-quality and “similar” demonstrations for new input queries and refine the demonstration pool, we designed three heuristic demonstration-selection methods based on different levels of similarity as follows.</p>
</div>
<div class="ltx_para" id="S4.SS1.p4">
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">Random Selection:</span> A random demonstration query is selected from the candidate demonstrations for a given input query, where the similarity level lies on the same input category.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1">Tree Selection:</span> Query tree is an important structural feature for the queries, therefore, it is natural to align similarity with the query tree structure. We first compute the query trees of all the candidate demonstration queries, with operators as the tree nodes. Given an input query, we select the demonstration with the minimum tree edit distance from the input query tree within the candidate demonstrations.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.1.1">SentTrans Selection:</span> At the textual level, we observe that queries are always considered as sentences for the language models to process. Based on the observation, we treat input queries as sentences and select the candidate demonstration query whose embedding is the most similar to the input query. Most of the effective LLMs are closed-sourced, which means we are not able to obtain the query embeddings of such LLMs. However, similar to LLMs, some small pre-trained language models share the same sequence-to-sequence mechanism, that the input text is first encoded by an encoder before feeding to the model. Using such encoders, like Sentence Transformers <cite class="ltx_cite ltx_citemacro_citep">(Reimers and Gurevych, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib25" title="">2019</a>)</cite>, we can obtain an embedding of a given sentence.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S4.SS1.p4.12">With the three demonstration selection methods above, we can prompt our <span class="ltx_text ltx_font_bold" id="S4.SS1.p4.12.1">LLM-R<sup class="ltx_sup" id="S4.SS1.p4.12.1.1">2</sup></span> system with the one-shot demonstration to obtain various rewrite results on the same training set. These new rewrite queries from the one-shot <span class="ltx_text ltx_font_bold" id="S4.SS1.p4.12.2">LLM-R<sup class="ltx_sup" id="S4.SS1.p4.12.2.1">2</sup></span> system are then evaluated in the same way as in Stage-1. Specifically, when we adopt one-shot demonstration to rewrite an input query <math alttext="Q^{t}" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.1"><semantics id="S4.SS1.p4.1.m1.1a"><msup id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><mi id="S4.SS1.p4.1.m1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.2.cmml">Q</mi><mi id="S4.SS1.p4.1.m1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1">superscript</csymbol><ci id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2">𝑄</ci><ci id="S4.SS1.p4.1.m1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">Q^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.1.m1.1d">italic_Q start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, we are able to estimate the benefit obtained from the demonstration by constructing the rewrite tuples (T) as (<math alttext="Q^{t},D,R^{t},\alpha" class="ltx_Math" display="inline" id="S4.SS1.p4.2.m2.4"><semantics id="S4.SS1.p4.2.m2.4a"><mrow id="S4.SS1.p4.2.m2.4.4.2" xref="S4.SS1.p4.2.m2.4.4.3.cmml"><msup id="S4.SS1.p4.2.m2.3.3.1.1" xref="S4.SS1.p4.2.m2.3.3.1.1.cmml"><mi id="S4.SS1.p4.2.m2.3.3.1.1.2" xref="S4.SS1.p4.2.m2.3.3.1.1.2.cmml">Q</mi><mi id="S4.SS1.p4.2.m2.3.3.1.1.3" xref="S4.SS1.p4.2.m2.3.3.1.1.3.cmml">t</mi></msup><mo id="S4.SS1.p4.2.m2.4.4.2.3" xref="S4.SS1.p4.2.m2.4.4.3.cmml">,</mo><mi id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml">D</mi><mo id="S4.SS1.p4.2.m2.4.4.2.4" xref="S4.SS1.p4.2.m2.4.4.3.cmml">,</mo><msup id="S4.SS1.p4.2.m2.4.4.2.2" xref="S4.SS1.p4.2.m2.4.4.2.2.cmml"><mi id="S4.SS1.p4.2.m2.4.4.2.2.2" xref="S4.SS1.p4.2.m2.4.4.2.2.2.cmml">R</mi><mi id="S4.SS1.p4.2.m2.4.4.2.2.3" xref="S4.SS1.p4.2.m2.4.4.2.2.3.cmml">t</mi></msup><mo id="S4.SS1.p4.2.m2.4.4.2.5" xref="S4.SS1.p4.2.m2.4.4.3.cmml">,</mo><mi id="S4.SS1.p4.2.m2.2.2" xref="S4.SS1.p4.2.m2.2.2.cmml">α</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.4b"><list id="S4.SS1.p4.2.m2.4.4.3.cmml" xref="S4.SS1.p4.2.m2.4.4.2"><apply id="S4.SS1.p4.2.m2.3.3.1.1.cmml" xref="S4.SS1.p4.2.m2.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m2.3.3.1.1.1.cmml" xref="S4.SS1.p4.2.m2.3.3.1.1">superscript</csymbol><ci id="S4.SS1.p4.2.m2.3.3.1.1.2.cmml" xref="S4.SS1.p4.2.m2.3.3.1.1.2">𝑄</ci><ci id="S4.SS1.p4.2.m2.3.3.1.1.3.cmml" xref="S4.SS1.p4.2.m2.3.3.1.1.3">𝑡</ci></apply><ci id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1">𝐷</ci><apply id="S4.SS1.p4.2.m2.4.4.2.2.cmml" xref="S4.SS1.p4.2.m2.4.4.2.2"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m2.4.4.2.2.1.cmml" xref="S4.SS1.p4.2.m2.4.4.2.2">superscript</csymbol><ci id="S4.SS1.p4.2.m2.4.4.2.2.2.cmml" xref="S4.SS1.p4.2.m2.4.4.2.2.2">𝑅</ci><ci id="S4.SS1.p4.2.m2.4.4.2.2.3.cmml" xref="S4.SS1.p4.2.m2.4.4.2.2.3">𝑡</ci></apply><ci id="S4.SS1.p4.2.m2.2.2.cmml" xref="S4.SS1.p4.2.m2.2.2">𝛼</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.4c">Q^{t},D,R^{t},\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.2.m2.4d">italic_Q start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_D , italic_R start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_α</annotation></semantics></math>), where <math alttext="Q^{t}" class="ltx_Math" display="inline" id="S4.SS1.p4.3.m3.1"><semantics id="S4.SS1.p4.3.m3.1a"><msup id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml"><mi id="S4.SS1.p4.3.m3.1.1.2" xref="S4.SS1.p4.3.m3.1.1.2.cmml">Q</mi><mi id="S4.SS1.p4.3.m3.1.1.3" xref="S4.SS1.p4.3.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><apply id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m3.1.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1">superscript</csymbol><ci id="S4.SS1.p4.3.m3.1.1.2.cmml" xref="S4.SS1.p4.3.m3.1.1.2">𝑄</ci><ci id="S4.SS1.p4.3.m3.1.1.3.cmml" xref="S4.SS1.p4.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">Q^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.3.m3.1d">italic_Q start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> represents a training query, <math alttext="D" class="ltx_Math" display="inline" id="S4.SS1.p4.4.m4.1"><semantics id="S4.SS1.p4.4.m4.1a"><mi id="S4.SS1.p4.4.m4.1.1" xref="S4.SS1.p4.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.1b"><ci id="S4.SS1.p4.4.m4.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.4.m4.1d">italic_D</annotation></semantics></math> is the demonstration <math alttext="\langle Q^{D},R^{D}\rangle" class="ltx_Math" display="inline" id="S4.SS1.p4.5.m5.2"><semantics id="S4.SS1.p4.5.m5.2a"><mrow id="S4.SS1.p4.5.m5.2.2.2" xref="S4.SS1.p4.5.m5.2.2.3.cmml"><mo id="S4.SS1.p4.5.m5.2.2.2.3" stretchy="false" xref="S4.SS1.p4.5.m5.2.2.3.cmml">⟨</mo><msup id="S4.SS1.p4.5.m5.1.1.1.1" xref="S4.SS1.p4.5.m5.1.1.1.1.cmml"><mi id="S4.SS1.p4.5.m5.1.1.1.1.2" xref="S4.SS1.p4.5.m5.1.1.1.1.2.cmml">Q</mi><mi id="S4.SS1.p4.5.m5.1.1.1.1.3" xref="S4.SS1.p4.5.m5.1.1.1.1.3.cmml">D</mi></msup><mo id="S4.SS1.p4.5.m5.2.2.2.4" xref="S4.SS1.p4.5.m5.2.2.3.cmml">,</mo><msup id="S4.SS1.p4.5.m5.2.2.2.2" xref="S4.SS1.p4.5.m5.2.2.2.2.cmml"><mi id="S4.SS1.p4.5.m5.2.2.2.2.2" xref="S4.SS1.p4.5.m5.2.2.2.2.2.cmml">R</mi><mi id="S4.SS1.p4.5.m5.2.2.2.2.3" xref="S4.SS1.p4.5.m5.2.2.2.2.3.cmml">D</mi></msup><mo id="S4.SS1.p4.5.m5.2.2.2.5" stretchy="false" xref="S4.SS1.p4.5.m5.2.2.3.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.5.m5.2b"><list id="S4.SS1.p4.5.m5.2.2.3.cmml" xref="S4.SS1.p4.5.m5.2.2.2"><apply id="S4.SS1.p4.5.m5.1.1.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.5.m5.1.1.1.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1.1.1">superscript</csymbol><ci id="S4.SS1.p4.5.m5.1.1.1.1.2.cmml" xref="S4.SS1.p4.5.m5.1.1.1.1.2">𝑄</ci><ci id="S4.SS1.p4.5.m5.1.1.1.1.3.cmml" xref="S4.SS1.p4.5.m5.1.1.1.1.3">𝐷</ci></apply><apply id="S4.SS1.p4.5.m5.2.2.2.2.cmml" xref="S4.SS1.p4.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p4.5.m5.2.2.2.2.1.cmml" xref="S4.SS1.p4.5.m5.2.2.2.2">superscript</csymbol><ci id="S4.SS1.p4.5.m5.2.2.2.2.2.cmml" xref="S4.SS1.p4.5.m5.2.2.2.2.2">𝑅</ci><ci id="S4.SS1.p4.5.m5.2.2.2.2.3.cmml" xref="S4.SS1.p4.5.m5.2.2.2.2.3">𝐷</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.5.m5.2c">\langle Q^{D},R^{D}\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.5.m5.2d">⟨ italic_Q start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT , italic_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT ⟩</annotation></semantics></math> selected for <math alttext="Q^{t}" class="ltx_Math" display="inline" id="S4.SS1.p4.6.m6.1"><semantics id="S4.SS1.p4.6.m6.1a"><msup id="S4.SS1.p4.6.m6.1.1" xref="S4.SS1.p4.6.m6.1.1.cmml"><mi id="S4.SS1.p4.6.m6.1.1.2" xref="S4.SS1.p4.6.m6.1.1.2.cmml">Q</mi><mi id="S4.SS1.p4.6.m6.1.1.3" xref="S4.SS1.p4.6.m6.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.6.m6.1b"><apply id="S4.SS1.p4.6.m6.1.1.cmml" xref="S4.SS1.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.6.m6.1.1.1.cmml" xref="S4.SS1.p4.6.m6.1.1">superscript</csymbol><ci id="S4.SS1.p4.6.m6.1.1.2.cmml" xref="S4.SS1.p4.6.m6.1.1.2">𝑄</ci><ci id="S4.SS1.p4.6.m6.1.1.3.cmml" xref="S4.SS1.p4.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.6.m6.1c">Q^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.6.m6.1d">italic_Q start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="R^{t}" class="ltx_Math" display="inline" id="S4.SS1.p4.7.m7.1"><semantics id="S4.SS1.p4.7.m7.1a"><msup id="S4.SS1.p4.7.m7.1.1" xref="S4.SS1.p4.7.m7.1.1.cmml"><mi id="S4.SS1.p4.7.m7.1.1.2" xref="S4.SS1.p4.7.m7.1.1.2.cmml">R</mi><mi id="S4.SS1.p4.7.m7.1.1.3" xref="S4.SS1.p4.7.m7.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.7.m7.1b"><apply id="S4.SS1.p4.7.m7.1.1.cmml" xref="S4.SS1.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.7.m7.1.1.1.cmml" xref="S4.SS1.p4.7.m7.1.1">superscript</csymbol><ci id="S4.SS1.p4.7.m7.1.1.2.cmml" xref="S4.SS1.p4.7.m7.1.1.2">𝑅</ci><ci id="S4.SS1.p4.7.m7.1.1.3.cmml" xref="S4.SS1.p4.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.7.m7.1c">R^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.7.m7.1d">italic_R start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the adopted rules for <math alttext="Q^{t}" class="ltx_Math" display="inline" id="S4.SS1.p4.8.m8.1"><semantics id="S4.SS1.p4.8.m8.1a"><msup id="S4.SS1.p4.8.m8.1.1" xref="S4.SS1.p4.8.m8.1.1.cmml"><mi id="S4.SS1.p4.8.m8.1.1.2" xref="S4.SS1.p4.8.m8.1.1.2.cmml">Q</mi><mi id="S4.SS1.p4.8.m8.1.1.3" xref="S4.SS1.p4.8.m8.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.8.m8.1b"><apply id="S4.SS1.p4.8.m8.1.1.cmml" xref="S4.SS1.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.8.m8.1.1.1.cmml" xref="S4.SS1.p4.8.m8.1.1">superscript</csymbol><ci id="S4.SS1.p4.8.m8.1.1.2.cmml" xref="S4.SS1.p4.8.m8.1.1.2">𝑄</ci><ci id="S4.SS1.p4.8.m8.1.1.3.cmml" xref="S4.SS1.p4.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.8.m8.1c">Q^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.8.m8.1d">italic_Q start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS1.p4.9.m9.1"><semantics id="S4.SS1.p4.9.m9.1a"><mi id="S4.SS1.p4.9.m9.1.1" xref="S4.SS1.p4.9.m9.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.9.m9.1b"><ci id="S4.SS1.p4.9.m9.1.1.cmml" xref="S4.SS1.p4.9.m9.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.9.m9.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.9.m9.1d">italic_α</annotation></semantics></math> represents the improved margin obtained by the query rewrite. In particular, given the original query cost <math alttext="C_{0}" class="ltx_Math" display="inline" id="S4.SS1.p4.10.m10.1"><semantics id="S4.SS1.p4.10.m10.1a"><msub id="S4.SS1.p4.10.m10.1.1" xref="S4.SS1.p4.10.m10.1.1.cmml"><mi id="S4.SS1.p4.10.m10.1.1.2" xref="S4.SS1.p4.10.m10.1.1.2.cmml">C</mi><mn id="S4.SS1.p4.10.m10.1.1.3" xref="S4.SS1.p4.10.m10.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.10.m10.1b"><apply id="S4.SS1.p4.10.m10.1.1.cmml" xref="S4.SS1.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.10.m10.1.1.1.cmml" xref="S4.SS1.p4.10.m10.1.1">subscript</csymbol><ci id="S4.SS1.p4.10.m10.1.1.2.cmml" xref="S4.SS1.p4.10.m10.1.1.2">𝐶</ci><cn id="S4.SS1.p4.10.m10.1.1.3.cmml" type="integer" xref="S4.SS1.p4.10.m10.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.10.m10.1c">C_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.10.m10.1d">italic_C start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and the cost of rewritten query <math alttext="C_{r}" class="ltx_Math" display="inline" id="S4.SS1.p4.11.m11.1"><semantics id="S4.SS1.p4.11.m11.1a"><msub id="S4.SS1.p4.11.m11.1.1" xref="S4.SS1.p4.11.m11.1.1.cmml"><mi id="S4.SS1.p4.11.m11.1.1.2" xref="S4.SS1.p4.11.m11.1.1.2.cmml">C</mi><mi id="S4.SS1.p4.11.m11.1.1.3" xref="S4.SS1.p4.11.m11.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.11.m11.1b"><apply id="S4.SS1.p4.11.m11.1.1.cmml" xref="S4.SS1.p4.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.11.m11.1.1.1.cmml" xref="S4.SS1.p4.11.m11.1.1">subscript</csymbol><ci id="S4.SS1.p4.11.m11.1.1.2.cmml" xref="S4.SS1.p4.11.m11.1.1.2">𝐶</ci><ci id="S4.SS1.p4.11.m11.1.1.3.cmml" xref="S4.SS1.p4.11.m11.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.11.m11.1c">C_{r}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.11.m11.1d">italic_C start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>, we define the improved margin as <math alttext="\alpha=C_{0}/C_{r}" class="ltx_Math" display="inline" id="S4.SS1.p4.12.m12.1"><semantics id="S4.SS1.p4.12.m12.1a"><mrow id="S4.SS1.p4.12.m12.1.1" xref="S4.SS1.p4.12.m12.1.1.cmml"><mi id="S4.SS1.p4.12.m12.1.1.2" xref="S4.SS1.p4.12.m12.1.1.2.cmml">α</mi><mo id="S4.SS1.p4.12.m12.1.1.1" xref="S4.SS1.p4.12.m12.1.1.1.cmml">=</mo><mrow id="S4.SS1.p4.12.m12.1.1.3" xref="S4.SS1.p4.12.m12.1.1.3.cmml"><msub id="S4.SS1.p4.12.m12.1.1.3.2" xref="S4.SS1.p4.12.m12.1.1.3.2.cmml"><mi id="S4.SS1.p4.12.m12.1.1.3.2.2" xref="S4.SS1.p4.12.m12.1.1.3.2.2.cmml">C</mi><mn id="S4.SS1.p4.12.m12.1.1.3.2.3" xref="S4.SS1.p4.12.m12.1.1.3.2.3.cmml">0</mn></msub><mo id="S4.SS1.p4.12.m12.1.1.3.1" xref="S4.SS1.p4.12.m12.1.1.3.1.cmml">/</mo><msub id="S4.SS1.p4.12.m12.1.1.3.3" xref="S4.SS1.p4.12.m12.1.1.3.3.cmml"><mi id="S4.SS1.p4.12.m12.1.1.3.3.2" xref="S4.SS1.p4.12.m12.1.1.3.3.2.cmml">C</mi><mi id="S4.SS1.p4.12.m12.1.1.3.3.3" xref="S4.SS1.p4.12.m12.1.1.3.3.3.cmml">r</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.12.m12.1b"><apply id="S4.SS1.p4.12.m12.1.1.cmml" xref="S4.SS1.p4.12.m12.1.1"><eq id="S4.SS1.p4.12.m12.1.1.1.cmml" xref="S4.SS1.p4.12.m12.1.1.1"></eq><ci id="S4.SS1.p4.12.m12.1.1.2.cmml" xref="S4.SS1.p4.12.m12.1.1.2">𝛼</ci><apply id="S4.SS1.p4.12.m12.1.1.3.cmml" xref="S4.SS1.p4.12.m12.1.1.3"><divide id="S4.SS1.p4.12.m12.1.1.3.1.cmml" xref="S4.SS1.p4.12.m12.1.1.3.1"></divide><apply id="S4.SS1.p4.12.m12.1.1.3.2.cmml" xref="S4.SS1.p4.12.m12.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p4.12.m12.1.1.3.2.1.cmml" xref="S4.SS1.p4.12.m12.1.1.3.2">subscript</csymbol><ci id="S4.SS1.p4.12.m12.1.1.3.2.2.cmml" xref="S4.SS1.p4.12.m12.1.1.3.2.2">𝐶</ci><cn id="S4.SS1.p4.12.m12.1.1.3.2.3.cmml" type="integer" xref="S4.SS1.p4.12.m12.1.1.3.2.3">0</cn></apply><apply id="S4.SS1.p4.12.m12.1.1.3.3.cmml" xref="S4.SS1.p4.12.m12.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p4.12.m12.1.1.3.3.1.cmml" xref="S4.SS1.p4.12.m12.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p4.12.m12.1.1.3.3.2.cmml" xref="S4.SS1.p4.12.m12.1.1.3.3.2">𝐶</ci><ci id="S4.SS1.p4.12.m12.1.1.3.3.3.cmml" xref="S4.SS1.p4.12.m12.1.1.3.3.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.12.m12.1c">\alpha=C_{0}/C_{r}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.12.m12.1d">italic_α = italic_C start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT / italic_C start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>, where the larger margin the better rewrite result and larger benefit we have.</p>
</div>
<div class="ltx_para" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.9">In addition, a set of training triplets is generated using the rewrite tuples obtained in preparation for training a contrastive representation model. For a given query <math alttext="Q^{t}" class="ltx_Math" display="inline" id="S4.SS1.p5.1.m1.1"><semantics id="S4.SS1.p5.1.m1.1a"><msup id="S4.SS1.p5.1.m1.1.1" xref="S4.SS1.p5.1.m1.1.1.cmml"><mi id="S4.SS1.p5.1.m1.1.1.2" xref="S4.SS1.p5.1.m1.1.1.2.cmml">Q</mi><mi id="S4.SS1.p5.1.m1.1.1.3" xref="S4.SS1.p5.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.1.m1.1b"><apply id="S4.SS1.p5.1.m1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.1.m1.1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1">superscript</csymbol><ci id="S4.SS1.p5.1.m1.1.1.2.cmml" xref="S4.SS1.p5.1.m1.1.1.2">𝑄</ci><ci id="S4.SS1.p5.1.m1.1.1.3.cmml" xref="S4.SS1.p5.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.1.m1.1c">Q^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.1.m1.1d">italic_Q start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> in the rewrite tuple (<math alttext="Q^{t},D,R^{t},\alpha" class="ltx_Math" display="inline" id="S4.SS1.p5.2.m2.4"><semantics id="S4.SS1.p5.2.m2.4a"><mrow id="S4.SS1.p5.2.m2.4.4.2" xref="S4.SS1.p5.2.m2.4.4.3.cmml"><msup id="S4.SS1.p5.2.m2.3.3.1.1" xref="S4.SS1.p5.2.m2.3.3.1.1.cmml"><mi id="S4.SS1.p5.2.m2.3.3.1.1.2" xref="S4.SS1.p5.2.m2.3.3.1.1.2.cmml">Q</mi><mi id="S4.SS1.p5.2.m2.3.3.1.1.3" xref="S4.SS1.p5.2.m2.3.3.1.1.3.cmml">t</mi></msup><mo id="S4.SS1.p5.2.m2.4.4.2.3" xref="S4.SS1.p5.2.m2.4.4.3.cmml">,</mo><mi id="S4.SS1.p5.2.m2.1.1" xref="S4.SS1.p5.2.m2.1.1.cmml">D</mi><mo id="S4.SS1.p5.2.m2.4.4.2.4" xref="S4.SS1.p5.2.m2.4.4.3.cmml">,</mo><msup id="S4.SS1.p5.2.m2.4.4.2.2" xref="S4.SS1.p5.2.m2.4.4.2.2.cmml"><mi id="S4.SS1.p5.2.m2.4.4.2.2.2" xref="S4.SS1.p5.2.m2.4.4.2.2.2.cmml">R</mi><mi id="S4.SS1.p5.2.m2.4.4.2.2.3" xref="S4.SS1.p5.2.m2.4.4.2.2.3.cmml">t</mi></msup><mo id="S4.SS1.p5.2.m2.4.4.2.5" xref="S4.SS1.p5.2.m2.4.4.3.cmml">,</mo><mi id="S4.SS1.p5.2.m2.2.2" xref="S4.SS1.p5.2.m2.2.2.cmml">α</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.2.m2.4b"><list id="S4.SS1.p5.2.m2.4.4.3.cmml" xref="S4.SS1.p5.2.m2.4.4.2"><apply id="S4.SS1.p5.2.m2.3.3.1.1.cmml" xref="S4.SS1.p5.2.m2.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.2.m2.3.3.1.1.1.cmml" xref="S4.SS1.p5.2.m2.3.3.1.1">superscript</csymbol><ci id="S4.SS1.p5.2.m2.3.3.1.1.2.cmml" xref="S4.SS1.p5.2.m2.3.3.1.1.2">𝑄</ci><ci id="S4.SS1.p5.2.m2.3.3.1.1.3.cmml" xref="S4.SS1.p5.2.m2.3.3.1.1.3">𝑡</ci></apply><ci id="S4.SS1.p5.2.m2.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1">𝐷</ci><apply id="S4.SS1.p5.2.m2.4.4.2.2.cmml" xref="S4.SS1.p5.2.m2.4.4.2.2"><csymbol cd="ambiguous" id="S4.SS1.p5.2.m2.4.4.2.2.1.cmml" xref="S4.SS1.p5.2.m2.4.4.2.2">superscript</csymbol><ci id="S4.SS1.p5.2.m2.4.4.2.2.2.cmml" xref="S4.SS1.p5.2.m2.4.4.2.2.2">𝑅</ci><ci id="S4.SS1.p5.2.m2.4.4.2.2.3.cmml" xref="S4.SS1.p5.2.m2.4.4.2.2.3">𝑡</ci></apply><ci id="S4.SS1.p5.2.m2.2.2.cmml" xref="S4.SS1.p5.2.m2.2.2">𝛼</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.2.m2.4c">Q^{t},D,R^{t},\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.2.m2.4d">italic_Q start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_D , italic_R start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_α</annotation></semantics></math>), we consider the demonstration query <math alttext="Q^{D}" class="ltx_Math" display="inline" id="S4.SS1.p5.3.m3.1"><semantics id="S4.SS1.p5.3.m3.1a"><msup id="S4.SS1.p5.3.m3.1.1" xref="S4.SS1.p5.3.m3.1.1.cmml"><mi id="S4.SS1.p5.3.m3.1.1.2" xref="S4.SS1.p5.3.m3.1.1.2.cmml">Q</mi><mi id="S4.SS1.p5.3.m3.1.1.3" xref="S4.SS1.p5.3.m3.1.1.3.cmml">D</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.3.m3.1b"><apply id="S4.SS1.p5.3.m3.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.3.m3.1.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1">superscript</csymbol><ci id="S4.SS1.p5.3.m3.1.1.2.cmml" xref="S4.SS1.p5.3.m3.1.1.2">𝑄</ci><ci id="S4.SS1.p5.3.m3.1.1.3.cmml" xref="S4.SS1.p5.3.m3.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.3.m3.1c">Q^{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.3.m3.1d">italic_Q start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> adopted as an improve query <math alttext="Q^{D+}" class="ltx_Math" display="inline" id="S4.SS1.p5.4.m4.1"><semantics id="S4.SS1.p5.4.m4.1a"><msup id="S4.SS1.p5.4.m4.1.1" xref="S4.SS1.p5.4.m4.1.1.cmml"><mi id="S4.SS1.p5.4.m4.1.1.2" xref="S4.SS1.p5.4.m4.1.1.2.cmml">Q</mi><mrow id="S4.SS1.p5.4.m4.1.1.3" xref="S4.SS1.p5.4.m4.1.1.3.cmml"><mi id="S4.SS1.p5.4.m4.1.1.3.2" xref="S4.SS1.p5.4.m4.1.1.3.2.cmml">D</mi><mo id="S4.SS1.p5.4.m4.1.1.3.3" xref="S4.SS1.p5.4.m4.1.1.3.3.cmml">+</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.4.m4.1b"><apply id="S4.SS1.p5.4.m4.1.1.cmml" xref="S4.SS1.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.4.m4.1.1.1.cmml" xref="S4.SS1.p5.4.m4.1.1">superscript</csymbol><ci id="S4.SS1.p5.4.m4.1.1.2.cmml" xref="S4.SS1.p5.4.m4.1.1.2">𝑄</ci><apply id="S4.SS1.p5.4.m4.1.1.3.cmml" xref="S4.SS1.p5.4.m4.1.1.3"><csymbol cd="latexml" id="S4.SS1.p5.4.m4.1.1.3.1.cmml" xref="S4.SS1.p5.4.m4.1.1.3">limit-from</csymbol><ci id="S4.SS1.p5.4.m4.1.1.3.2.cmml" xref="S4.SS1.p5.4.m4.1.1.3.2">𝐷</ci><plus id="S4.SS1.p5.4.m4.1.1.3.3.cmml" xref="S4.SS1.p5.4.m4.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.4.m4.1c">Q^{D+}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.4.m4.1d">italic_Q start_POSTSUPERSCRIPT italic_D + end_POSTSUPERSCRIPT</annotation></semantics></math> for <math alttext="Q" class="ltx_Math" display="inline" id="S4.SS1.p5.5.m5.1"><semantics id="S4.SS1.p5.5.m5.1a"><mi id="S4.SS1.p5.5.m5.1.1" xref="S4.SS1.p5.5.m5.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.5.m5.1b"><ci id="S4.SS1.p5.5.m5.1.1.cmml" xref="S4.SS1.p5.5.m5.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.5.m5.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.5.m5.1d">italic_Q</annotation></semantics></math>, if the improved margin <math alttext="\alpha&gt;1" class="ltx_Math" display="inline" id="S4.SS1.p5.6.m6.1"><semantics id="S4.SS1.p5.6.m6.1a"><mrow id="S4.SS1.p5.6.m6.1.1" xref="S4.SS1.p5.6.m6.1.1.cmml"><mi id="S4.SS1.p5.6.m6.1.1.2" xref="S4.SS1.p5.6.m6.1.1.2.cmml">α</mi><mo id="S4.SS1.p5.6.m6.1.1.1" xref="S4.SS1.p5.6.m6.1.1.1.cmml">&gt;</mo><mn id="S4.SS1.p5.6.m6.1.1.3" xref="S4.SS1.p5.6.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.6.m6.1b"><apply id="S4.SS1.p5.6.m6.1.1.cmml" xref="S4.SS1.p5.6.m6.1.1"><gt id="S4.SS1.p5.6.m6.1.1.1.cmml" xref="S4.SS1.p5.6.m6.1.1.1"></gt><ci id="S4.SS1.p5.6.m6.1.1.2.cmml" xref="S4.SS1.p5.6.m6.1.1.2">𝛼</ci><cn id="S4.SS1.p5.6.m6.1.1.3.cmml" type="integer" xref="S4.SS1.p5.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.6.m6.1c">\alpha&gt;1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.6.m6.1d">italic_α &gt; 1</annotation></semantics></math>. In contrast, we denote the demonstration query as a degrade query <math alttext="Q^{D-}" class="ltx_Math" display="inline" id="S4.SS1.p5.7.m7.1"><semantics id="S4.SS1.p5.7.m7.1a"><msup id="S4.SS1.p5.7.m7.1.1" xref="S4.SS1.p5.7.m7.1.1.cmml"><mi id="S4.SS1.p5.7.m7.1.1.2" xref="S4.SS1.p5.7.m7.1.1.2.cmml">Q</mi><mrow id="S4.SS1.p5.7.m7.1.1.3" xref="S4.SS1.p5.7.m7.1.1.3.cmml"><mi id="S4.SS1.p5.7.m7.1.1.3.2" xref="S4.SS1.p5.7.m7.1.1.3.2.cmml">D</mi><mo id="S4.SS1.p5.7.m7.1.1.3.3" xref="S4.SS1.p5.7.m7.1.1.3.3.cmml">−</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.7.m7.1b"><apply id="S4.SS1.p5.7.m7.1.1.cmml" xref="S4.SS1.p5.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.7.m7.1.1.1.cmml" xref="S4.SS1.p5.7.m7.1.1">superscript</csymbol><ci id="S4.SS1.p5.7.m7.1.1.2.cmml" xref="S4.SS1.p5.7.m7.1.1.2">𝑄</ci><apply id="S4.SS1.p5.7.m7.1.1.3.cmml" xref="S4.SS1.p5.7.m7.1.1.3"><csymbol cd="latexml" id="S4.SS1.p5.7.m7.1.1.3.1.cmml" xref="S4.SS1.p5.7.m7.1.1.3">limit-from</csymbol><ci id="S4.SS1.p5.7.m7.1.1.3.2.cmml" xref="S4.SS1.p5.7.m7.1.1.3.2">𝐷</ci><minus id="S4.SS1.p5.7.m7.1.1.3.3.cmml" xref="S4.SS1.p5.7.m7.1.1.3.3"></minus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.7.m7.1c">Q^{D-}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.7.m7.1d">italic_Q start_POSTSUPERSCRIPT italic_D - end_POSTSUPERSCRIPT</annotation></semantics></math> if <math alttext="\alpha&lt;1" class="ltx_Math" display="inline" id="S4.SS1.p5.8.m8.1"><semantics id="S4.SS1.p5.8.m8.1a"><mrow id="S4.SS1.p5.8.m8.1.1" xref="S4.SS1.p5.8.m8.1.1.cmml"><mi id="S4.SS1.p5.8.m8.1.1.2" xref="S4.SS1.p5.8.m8.1.1.2.cmml">α</mi><mo id="S4.SS1.p5.8.m8.1.1.1" xref="S4.SS1.p5.8.m8.1.1.1.cmml">&lt;</mo><mn id="S4.SS1.p5.8.m8.1.1.3" xref="S4.SS1.p5.8.m8.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.8.m8.1b"><apply id="S4.SS1.p5.8.m8.1.1.cmml" xref="S4.SS1.p5.8.m8.1.1"><lt id="S4.SS1.p5.8.m8.1.1.1.cmml" xref="S4.SS1.p5.8.m8.1.1.1"></lt><ci id="S4.SS1.p5.8.m8.1.1.2.cmml" xref="S4.SS1.p5.8.m8.1.1.2">𝛼</ci><cn id="S4.SS1.p5.8.m8.1.1.3.cmml" type="integer" xref="S4.SS1.p5.8.m8.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.8.m8.1c">\alpha&lt;1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.8.m8.1d">italic_α &lt; 1</annotation></semantics></math>. If there are multiple improve(degrade) queries, we only select the one with the largest(smallest) improved margin. Since we have adopted multiple one-shot selection methods, now we are able to construct a training triplet for a given query as <math alttext="\langle Q^{t},Q^{D+},Q^{D-}\rangle" class="ltx_Math" display="inline" id="S4.SS1.p5.9.m9.3"><semantics id="S4.SS1.p5.9.m9.3a"><mrow id="S4.SS1.p5.9.m9.3.3.3" xref="S4.SS1.p5.9.m9.3.3.4.cmml"><mo id="S4.SS1.p5.9.m9.3.3.3.4" stretchy="false" xref="S4.SS1.p5.9.m9.3.3.4.cmml">⟨</mo><msup id="S4.SS1.p5.9.m9.1.1.1.1" xref="S4.SS1.p5.9.m9.1.1.1.1.cmml"><mi id="S4.SS1.p5.9.m9.1.1.1.1.2" xref="S4.SS1.p5.9.m9.1.1.1.1.2.cmml">Q</mi><mi id="S4.SS1.p5.9.m9.1.1.1.1.3" xref="S4.SS1.p5.9.m9.1.1.1.1.3.cmml">t</mi></msup><mo id="S4.SS1.p5.9.m9.3.3.3.5" xref="S4.SS1.p5.9.m9.3.3.4.cmml">,</mo><msup id="S4.SS1.p5.9.m9.2.2.2.2" xref="S4.SS1.p5.9.m9.2.2.2.2.cmml"><mi id="S4.SS1.p5.9.m9.2.2.2.2.2" xref="S4.SS1.p5.9.m9.2.2.2.2.2.cmml">Q</mi><mrow id="S4.SS1.p5.9.m9.2.2.2.2.3" xref="S4.SS1.p5.9.m9.2.2.2.2.3.cmml"><mi id="S4.SS1.p5.9.m9.2.2.2.2.3.2" xref="S4.SS1.p5.9.m9.2.2.2.2.3.2.cmml">D</mi><mo id="S4.SS1.p5.9.m9.2.2.2.2.3.3" xref="S4.SS1.p5.9.m9.2.2.2.2.3.3.cmml">+</mo></mrow></msup><mo id="S4.SS1.p5.9.m9.3.3.3.6" xref="S4.SS1.p5.9.m9.3.3.4.cmml">,</mo><msup id="S4.SS1.p5.9.m9.3.3.3.3" xref="S4.SS1.p5.9.m9.3.3.3.3.cmml"><mi id="S4.SS1.p5.9.m9.3.3.3.3.2" xref="S4.SS1.p5.9.m9.3.3.3.3.2.cmml">Q</mi><mrow id="S4.SS1.p5.9.m9.3.3.3.3.3" xref="S4.SS1.p5.9.m9.3.3.3.3.3.cmml"><mi id="S4.SS1.p5.9.m9.3.3.3.3.3.2" xref="S4.SS1.p5.9.m9.3.3.3.3.3.2.cmml">D</mi><mo id="S4.SS1.p5.9.m9.3.3.3.3.3.3" xref="S4.SS1.p5.9.m9.3.3.3.3.3.3.cmml">−</mo></mrow></msup><mo id="S4.SS1.p5.9.m9.3.3.3.7" stretchy="false" xref="S4.SS1.p5.9.m9.3.3.4.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.9.m9.3b"><list id="S4.SS1.p5.9.m9.3.3.4.cmml" xref="S4.SS1.p5.9.m9.3.3.3"><apply id="S4.SS1.p5.9.m9.1.1.1.1.cmml" xref="S4.SS1.p5.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.9.m9.1.1.1.1.1.cmml" xref="S4.SS1.p5.9.m9.1.1.1.1">superscript</csymbol><ci id="S4.SS1.p5.9.m9.1.1.1.1.2.cmml" xref="S4.SS1.p5.9.m9.1.1.1.1.2">𝑄</ci><ci id="S4.SS1.p5.9.m9.1.1.1.1.3.cmml" xref="S4.SS1.p5.9.m9.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.p5.9.m9.2.2.2.2.cmml" xref="S4.SS1.p5.9.m9.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p5.9.m9.2.2.2.2.1.cmml" xref="S4.SS1.p5.9.m9.2.2.2.2">superscript</csymbol><ci id="S4.SS1.p5.9.m9.2.2.2.2.2.cmml" xref="S4.SS1.p5.9.m9.2.2.2.2.2">𝑄</ci><apply id="S4.SS1.p5.9.m9.2.2.2.2.3.cmml" xref="S4.SS1.p5.9.m9.2.2.2.2.3"><csymbol cd="latexml" id="S4.SS1.p5.9.m9.2.2.2.2.3.1.cmml" xref="S4.SS1.p5.9.m9.2.2.2.2.3">limit-from</csymbol><ci id="S4.SS1.p5.9.m9.2.2.2.2.3.2.cmml" xref="S4.SS1.p5.9.m9.2.2.2.2.3.2">𝐷</ci><plus id="S4.SS1.p5.9.m9.2.2.2.2.3.3.cmml" xref="S4.SS1.p5.9.m9.2.2.2.2.3.3"></plus></apply></apply><apply id="S4.SS1.p5.9.m9.3.3.3.3.cmml" xref="S4.SS1.p5.9.m9.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p5.9.m9.3.3.3.3.1.cmml" xref="S4.SS1.p5.9.m9.3.3.3.3">superscript</csymbol><ci id="S4.SS1.p5.9.m9.3.3.3.3.2.cmml" xref="S4.SS1.p5.9.m9.3.3.3.3.2">𝑄</ci><apply id="S4.SS1.p5.9.m9.3.3.3.3.3.cmml" xref="S4.SS1.p5.9.m9.3.3.3.3.3"><csymbol cd="latexml" id="S4.SS1.p5.9.m9.3.3.3.3.3.1.cmml" xref="S4.SS1.p5.9.m9.3.3.3.3.3">limit-from</csymbol><ci id="S4.SS1.p5.9.m9.3.3.3.3.3.2.cmml" xref="S4.SS1.p5.9.m9.3.3.3.3.3.2">𝐷</ci><minus id="S4.SS1.p5.9.m9.3.3.3.3.3.3.cmml" xref="S4.SS1.p5.9.m9.3.3.3.3.3.3"></minus></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.9.m9.3c">\langle Q^{t},Q^{D+},Q^{D-}\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.9.m9.3d">⟨ italic_Q start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_Q start_POSTSUPERSCRIPT italic_D + end_POSTSUPERSCRIPT , italic_Q start_POSTSUPERSCRIPT italic_D - end_POSTSUPERSCRIPT ⟩</annotation></semantics></math>. A set of training triplets can be further constructed if we enumerate the whole training query set.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Pool Generator</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.2">Apart from the training triplets, we also hope to prepare an effective demonstration pool so that our learned demonstration selection model can select demonstrations from it during online inference. The rewrite tuple generated by the <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.2.1">Benefit Estimator</span> module, recording the effectiveness of a sequence of rewrite rules <math alttext="R^{t}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><msup id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">R</mi><mi id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝑅</ci><ci id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">R^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_R start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> on an input query <math alttext="Q^{t}" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><msup id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">Q</mi><mi id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">superscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">𝑄</ci><ci id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">Q^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">italic_Q start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, naturally fits our need for a high-quality rewrite demonstration.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.8">In particular, given the set of rewrite tuples generated by <math alttext="n" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_n</annotation></semantics></math> input queries, we first separate them into <math alttext="n" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">italic_n</annotation></semantics></math> groups <math alttext="\{T_{i}\}_{1\leq i\leq n}" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><msub id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mrow id="S4.SS2.p2.3.m3.1.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.2.cmml"><mo id="S4.SS2.p2.3.m3.1.1.1.1.2" stretchy="false" xref="S4.SS2.p2.3.m3.1.1.1.2.cmml">{</mo><msub id="S4.SS2.p2.3.m3.1.1.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1.1.1.1.2" xref="S4.SS2.p2.3.m3.1.1.1.1.1.2.cmml">T</mi><mi id="S4.SS2.p2.3.m3.1.1.1.1.1.3" xref="S4.SS2.p2.3.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.p2.3.m3.1.1.1.1.3" stretchy="false" xref="S4.SS2.p2.3.m3.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml"><mn id="S4.SS2.p2.3.m3.1.1.3.2" xref="S4.SS2.p2.3.m3.1.1.3.2.cmml">1</mn><mo id="S4.SS2.p2.3.m3.1.1.3.3" xref="S4.SS2.p2.3.m3.1.1.3.3.cmml">≤</mo><mi id="S4.SS2.p2.3.m3.1.1.3.4" xref="S4.SS2.p2.3.m3.1.1.3.4.cmml">i</mi><mo id="S4.SS2.p2.3.m3.1.1.3.5" xref="S4.SS2.p2.3.m3.1.1.3.5.cmml">≤</mo><mi id="S4.SS2.p2.3.m3.1.1.3.6" xref="S4.SS2.p2.3.m3.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1">subscript</csymbol><set id="S4.SS2.p2.3.m3.1.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1"><apply id="S4.SS2.p2.3.m3.1.1.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.2">𝑇</ci><ci id="S4.SS2.p2.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3"><and id="S4.SS2.p2.3.m3.1.1.3a.cmml" xref="S4.SS2.p2.3.m3.1.1.3"></and><apply id="S4.SS2.p2.3.m3.1.1.3b.cmml" xref="S4.SS2.p2.3.m3.1.1.3"><leq id="S4.SS2.p2.3.m3.1.1.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3.3"></leq><cn id="S4.SS2.p2.3.m3.1.1.3.2.cmml" type="integer" xref="S4.SS2.p2.3.m3.1.1.3.2">1</cn><ci id="S4.SS2.p2.3.m3.1.1.3.4.cmml" xref="S4.SS2.p2.3.m3.1.1.3.4">𝑖</ci></apply><apply id="S4.SS2.p2.3.m3.1.1.3c.cmml" xref="S4.SS2.p2.3.m3.1.1.3"><leq id="S4.SS2.p2.3.m3.1.1.3.5.cmml" xref="S4.SS2.p2.3.m3.1.1.3.5"></leq><share href="https://arxiv.org/html/2404.12872v1#S4.SS2.p2.3.m3.1.1.3.4.cmml" id="S4.SS2.p2.3.m3.1.1.3d.cmml" xref="S4.SS2.p2.3.m3.1.1.3"></share><ci id="S4.SS2.p2.3.m3.1.1.3.6.cmml" xref="S4.SS2.p2.3.m3.1.1.3.6">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">\{T_{i}\}_{1\leq i\leq n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">{ italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT 1 ≤ italic_i ≤ italic_n end_POSTSUBSCRIPT</annotation></semantics></math> based on their corresponding input queries. Therefore, each group <math alttext="T_{i}" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m4.1"><semantics id="S4.SS2.p2.4.m4.1a"><msub id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mi id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">T</mi><mi id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">𝑇</ci><ci id="S4.SS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">T_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m4.1d">italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> can be represented as the tuple set <math alttext="T_{i}=\{(Q_{i}^{t},D^{i}_{1},R_{1}^{i},\alpha_{1}^{i}),(Q_{i}^{t},D_{2}^{i},R_%
{2}^{i},\alpha_{2}^{i}),\cdots\}" class="ltx_Math" display="inline" id="S4.SS2.p2.5.m5.3"><semantics id="S4.SS2.p2.5.m5.3a"><mrow id="S4.SS2.p2.5.m5.3.3" xref="S4.SS2.p2.5.m5.3.3.cmml"><msub id="S4.SS2.p2.5.m5.3.3.4" xref="S4.SS2.p2.5.m5.3.3.4.cmml"><mi id="S4.SS2.p2.5.m5.3.3.4.2" xref="S4.SS2.p2.5.m5.3.3.4.2.cmml">T</mi><mi id="S4.SS2.p2.5.m5.3.3.4.3" xref="S4.SS2.p2.5.m5.3.3.4.3.cmml">i</mi></msub><mo id="S4.SS2.p2.5.m5.3.3.3" xref="S4.SS2.p2.5.m5.3.3.3.cmml">=</mo><mrow id="S4.SS2.p2.5.m5.3.3.2.2" xref="S4.SS2.p2.5.m5.3.3.2.3.cmml"><mo id="S4.SS2.p2.5.m5.3.3.2.2.3" stretchy="false" xref="S4.SS2.p2.5.m5.3.3.2.3.cmml">{</mo><mrow id="S4.SS2.p2.5.m5.2.2.1.1.1.4" xref="S4.SS2.p2.5.m5.2.2.1.1.1.5.cmml"><mo id="S4.SS2.p2.5.m5.2.2.1.1.1.4.5" stretchy="false" xref="S4.SS2.p2.5.m5.2.2.1.1.1.5.cmml">(</mo><msubsup id="S4.SS2.p2.5.m5.2.2.1.1.1.1.1" xref="S4.SS2.p2.5.m5.2.2.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.5.m5.2.2.1.1.1.1.1.2.2" xref="S4.SS2.p2.5.m5.2.2.1.1.1.1.1.2.2.cmml">Q</mi><mi id="S4.SS2.p2.5.m5.2.2.1.1.1.1.1.2.3" xref="S4.SS2.p2.5.m5.2.2.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.SS2.p2.5.m5.2.2.1.1.1.1.1.3" xref="S4.SS2.p2.5.m5.2.2.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S4.SS2.p2.5.m5.2.2.1.1.1.4.6" xref="S4.SS2.p2.5.m5.2.2.1.1.1.5.cmml">,</mo><msubsup id="S4.SS2.p2.5.m5.2.2.1.1.1.2.2" xref="S4.SS2.p2.5.m5.2.2.1.1.1.2.2.cmml"><mi id="S4.SS2.p2.5.m5.2.2.1.1.1.2.2.2.2" xref="S4.SS2.p2.5.m5.2.2.1.1.1.2.2.2.2.cmml">D</mi><mn id="S4.SS2.p2.5.m5.2.2.1.1.1.2.2.3" xref="S4.SS2.p2.5.m5.2.2.1.1.1.2.2.3.cmml">1</mn><mi id="S4.SS2.p2.5.m5.2.2.1.1.1.2.2.2.3" xref="S4.SS2.p2.5.m5.2.2.1.1.1.2.2.2.3.cmml">i</mi></msubsup><mo id="S4.SS2.p2.5.m5.2.2.1.1.1.4.7" xref="S4.SS2.p2.5.m5.2.2.1.1.1.5.cmml">,</mo><msubsup id="S4.SS2.p2.5.m5.2.2.1.1.1.3.3" xref="S4.SS2.p2.5.m5.2.2.1.1.1.3.3.cmml"><mi id="S4.SS2.p2.5.m5.2.2.1.1.1.3.3.2.2" xref="S4.SS2.p2.5.m5.2.2.1.1.1.3.3.2.2.cmml">R</mi><mn id="S4.SS2.p2.5.m5.2.2.1.1.1.3.3.2.3" xref="S4.SS2.p2.5.m5.2.2.1.1.1.3.3.2.3.cmml">1</mn><mi id="S4.SS2.p2.5.m5.2.2.1.1.1.3.3.3" xref="S4.SS2.p2.5.m5.2.2.1.1.1.3.3.3.cmml">i</mi></msubsup><mo id="S4.SS2.p2.5.m5.2.2.1.1.1.4.8" xref="S4.SS2.p2.5.m5.2.2.1.1.1.5.cmml">,</mo><msubsup id="S4.SS2.p2.5.m5.2.2.1.1.1.4.4" xref="S4.SS2.p2.5.m5.2.2.1.1.1.4.4.cmml"><mi id="S4.SS2.p2.5.m5.2.2.1.1.1.4.4.2.2" xref="S4.SS2.p2.5.m5.2.2.1.1.1.4.4.2.2.cmml">α</mi><mn id="S4.SS2.p2.5.m5.2.2.1.1.1.4.4.2.3" xref="S4.SS2.p2.5.m5.2.2.1.1.1.4.4.2.3.cmml">1</mn><mi id="S4.SS2.p2.5.m5.2.2.1.1.1.4.4.3" xref="S4.SS2.p2.5.m5.2.2.1.1.1.4.4.3.cmml">i</mi></msubsup><mo id="S4.SS2.p2.5.m5.2.2.1.1.1.4.9" stretchy="false" xref="S4.SS2.p2.5.m5.2.2.1.1.1.5.cmml">)</mo></mrow><mo id="S4.SS2.p2.5.m5.3.3.2.2.4" xref="S4.SS2.p2.5.m5.3.3.2.3.cmml">,</mo><mrow id="S4.SS2.p2.5.m5.3.3.2.2.2.4" xref="S4.SS2.p2.5.m5.3.3.2.2.2.5.cmml"><mo id="S4.SS2.p2.5.m5.3.3.2.2.2.4.5" stretchy="false" xref="S4.SS2.p2.5.m5.3.3.2.2.2.5.cmml">(</mo><msubsup id="S4.SS2.p2.5.m5.3.3.2.2.2.1.1" xref="S4.SS2.p2.5.m5.3.3.2.2.2.1.1.cmml"><mi id="S4.SS2.p2.5.m5.3.3.2.2.2.1.1.2.2" xref="S4.SS2.p2.5.m5.3.3.2.2.2.1.1.2.2.cmml">Q</mi><mi id="S4.SS2.p2.5.m5.3.3.2.2.2.1.1.2.3" xref="S4.SS2.p2.5.m5.3.3.2.2.2.1.1.2.3.cmml">i</mi><mi id="S4.SS2.p2.5.m5.3.3.2.2.2.1.1.3" xref="S4.SS2.p2.5.m5.3.3.2.2.2.1.1.3.cmml">t</mi></msubsup><mo id="S4.SS2.p2.5.m5.3.3.2.2.2.4.6" xref="S4.SS2.p2.5.m5.3.3.2.2.2.5.cmml">,</mo><msubsup id="S4.SS2.p2.5.m5.3.3.2.2.2.2.2" xref="S4.SS2.p2.5.m5.3.3.2.2.2.2.2.cmml"><mi id="S4.SS2.p2.5.m5.3.3.2.2.2.2.2.2.2" xref="S4.SS2.p2.5.m5.3.3.2.2.2.2.2.2.2.cmml">D</mi><mn id="S4.SS2.p2.5.m5.3.3.2.2.2.2.2.2.3" xref="S4.SS2.p2.5.m5.3.3.2.2.2.2.2.2.3.cmml">2</mn><mi id="S4.SS2.p2.5.m5.3.3.2.2.2.2.2.3" xref="S4.SS2.p2.5.m5.3.3.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S4.SS2.p2.5.m5.3.3.2.2.2.4.7" xref="S4.SS2.p2.5.m5.3.3.2.2.2.5.cmml">,</mo><msubsup id="S4.SS2.p2.5.m5.3.3.2.2.2.3.3" xref="S4.SS2.p2.5.m5.3.3.2.2.2.3.3.cmml"><mi id="S4.SS2.p2.5.m5.3.3.2.2.2.3.3.2.2" xref="S4.SS2.p2.5.m5.3.3.2.2.2.3.3.2.2.cmml">R</mi><mn id="S4.SS2.p2.5.m5.3.3.2.2.2.3.3.2.3" xref="S4.SS2.p2.5.m5.3.3.2.2.2.3.3.2.3.cmml">2</mn><mi id="S4.SS2.p2.5.m5.3.3.2.2.2.3.3.3" xref="S4.SS2.p2.5.m5.3.3.2.2.2.3.3.3.cmml">i</mi></msubsup><mo id="S4.SS2.p2.5.m5.3.3.2.2.2.4.8" xref="S4.SS2.p2.5.m5.3.3.2.2.2.5.cmml">,</mo><msubsup id="S4.SS2.p2.5.m5.3.3.2.2.2.4.4" xref="S4.SS2.p2.5.m5.3.3.2.2.2.4.4.cmml"><mi id="S4.SS2.p2.5.m5.3.3.2.2.2.4.4.2.2" xref="S4.SS2.p2.5.m5.3.3.2.2.2.4.4.2.2.cmml">α</mi><mn id="S4.SS2.p2.5.m5.3.3.2.2.2.4.4.2.3" xref="S4.SS2.p2.5.m5.3.3.2.2.2.4.4.2.3.cmml">2</mn><mi id="S4.SS2.p2.5.m5.3.3.2.2.2.4.4.3" xref="S4.SS2.p2.5.m5.3.3.2.2.2.4.4.3.cmml">i</mi></msubsup><mo id="S4.SS2.p2.5.m5.3.3.2.2.2.4.9" stretchy="false" xref="S4.SS2.p2.5.m5.3.3.2.2.2.5.cmml">)</mo></mrow><mo id="S4.SS2.p2.5.m5.3.3.2.2.5" xref="S4.SS2.p2.5.m5.3.3.2.3.cmml">,</mo><mi id="S4.SS2.p2.5.m5.1.1" mathvariant="normal" xref="S4.SS2.p2.5.m5.1.1.cmml">⋯</mi><mo id="S4.SS2.p2.5.m5.3.3.2.2.6" stretchy="false" xref="S4.SS2.p2.5.m5.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.3b"><apply id="S4.SS2.p2.5.m5.3.3.cmml" xref="S4.SS2.p2.5.m5.3.3"><eq id="S4.SS2.p2.5.m5.3.3.3.cmml" xref="S4.SS2.p2.5.m5.3.3.3"></eq><apply id="S4.SS2.p2.5.m5.3.3.4.cmml" xref="S4.SS2.p2.5.m5.3.3.4"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.3.3.4.1.cmml" xref="S4.SS2.p2.5.m5.3.3.4">subscript</csymbol><ci id="S4.SS2.p2.5.m5.3.3.4.2.cmml" xref="S4.SS2.p2.5.m5.3.3.4.2">𝑇</ci><ci id="S4.SS2.p2.5.m5.3.3.4.3.cmml" xref="S4.SS2.p2.5.m5.3.3.4.3">𝑖</ci></apply><set id="S4.SS2.p2.5.m5.3.3.2.3.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2"><vector id="S4.SS2.p2.5.m5.2.2.1.1.1.5.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.4"><apply id="S4.SS2.p2.5.m5.2.2.1.1.1.1.1.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.2.2.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p2.5.m5.2.2.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.2.2.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m5.2.2.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.1.1.2.2">𝑄</ci><ci id="S4.SS2.p2.5.m5.2.2.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p2.5.m5.2.2.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS2.p2.5.m5.2.2.1.1.1.2.2.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.2.2.1.1.1.2.2.1.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.2.2">subscript</csymbol><apply id="S4.SS2.p2.5.m5.2.2.1.1.1.2.2.2.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.2.2.1.1.1.2.2.2.1.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.2.2">superscript</csymbol><ci id="S4.SS2.p2.5.m5.2.2.1.1.1.2.2.2.2.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.2.2.2.2">𝐷</ci><ci id="S4.SS2.p2.5.m5.2.2.1.1.1.2.2.2.3.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.2.2.2.3">𝑖</ci></apply><cn id="S4.SS2.p2.5.m5.2.2.1.1.1.2.2.3.cmml" type="integer" xref="S4.SS2.p2.5.m5.2.2.1.1.1.2.2.3">1</cn></apply><apply id="S4.SS2.p2.5.m5.2.2.1.1.1.3.3.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.2.2.1.1.1.3.3.1.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.3.3">superscript</csymbol><apply id="S4.SS2.p2.5.m5.2.2.1.1.1.3.3.2.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.2.2.1.1.1.3.3.2.1.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.3.3">subscript</csymbol><ci id="S4.SS2.p2.5.m5.2.2.1.1.1.3.3.2.2.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.3.3.2.2">𝑅</ci><cn id="S4.SS2.p2.5.m5.2.2.1.1.1.3.3.2.3.cmml" type="integer" xref="S4.SS2.p2.5.m5.2.2.1.1.1.3.3.2.3">1</cn></apply><ci id="S4.SS2.p2.5.m5.2.2.1.1.1.3.3.3.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.3.3.3">𝑖</ci></apply><apply id="S4.SS2.p2.5.m5.2.2.1.1.1.4.4.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.4.4"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.2.2.1.1.1.4.4.1.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.4.4">superscript</csymbol><apply id="S4.SS2.p2.5.m5.2.2.1.1.1.4.4.2.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.4.4"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.2.2.1.1.1.4.4.2.1.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.4.4">subscript</csymbol><ci id="S4.SS2.p2.5.m5.2.2.1.1.1.4.4.2.2.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.4.4.2.2">𝛼</ci><cn id="S4.SS2.p2.5.m5.2.2.1.1.1.4.4.2.3.cmml" type="integer" xref="S4.SS2.p2.5.m5.2.2.1.1.1.4.4.2.3">1</cn></apply><ci id="S4.SS2.p2.5.m5.2.2.1.1.1.4.4.3.cmml" xref="S4.SS2.p2.5.m5.2.2.1.1.1.4.4.3">𝑖</ci></apply></vector><vector id="S4.SS2.p2.5.m5.3.3.2.2.2.5.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.4"><apply id="S4.SS2.p2.5.m5.3.3.2.2.2.1.1.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.3.3.2.2.2.1.1.1.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.1.1">superscript</csymbol><apply id="S4.SS2.p2.5.m5.3.3.2.2.2.1.1.2.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.3.3.2.2.2.1.1.2.1.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m5.3.3.2.2.2.1.1.2.2.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.1.1.2.2">𝑄</ci><ci id="S4.SS2.p2.5.m5.3.3.2.2.2.1.1.2.3.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p2.5.m5.3.3.2.2.2.1.1.3.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.1.1.3">𝑡</ci></apply><apply id="S4.SS2.p2.5.m5.3.3.2.2.2.2.2.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.3.3.2.2.2.2.2.1.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.2.2">superscript</csymbol><apply id="S4.SS2.p2.5.m5.3.3.2.2.2.2.2.2.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.3.3.2.2.2.2.2.2.1.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p2.5.m5.3.3.2.2.2.2.2.2.2.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.2.2.2.2">𝐷</ci><cn id="S4.SS2.p2.5.m5.3.3.2.2.2.2.2.2.3.cmml" type="integer" xref="S4.SS2.p2.5.m5.3.3.2.2.2.2.2.2.3">2</cn></apply><ci id="S4.SS2.p2.5.m5.3.3.2.2.2.2.2.3.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.2.2.3">𝑖</ci></apply><apply id="S4.SS2.p2.5.m5.3.3.2.2.2.3.3.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.3.3.2.2.2.3.3.1.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.3.3">superscript</csymbol><apply id="S4.SS2.p2.5.m5.3.3.2.2.2.3.3.2.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.3.3.2.2.2.3.3.2.1.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.3.3">subscript</csymbol><ci id="S4.SS2.p2.5.m5.3.3.2.2.2.3.3.2.2.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.3.3.2.2">𝑅</ci><cn id="S4.SS2.p2.5.m5.3.3.2.2.2.3.3.2.3.cmml" type="integer" xref="S4.SS2.p2.5.m5.3.3.2.2.2.3.3.2.3">2</cn></apply><ci id="S4.SS2.p2.5.m5.3.3.2.2.2.3.3.3.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.3.3.3">𝑖</ci></apply><apply id="S4.SS2.p2.5.m5.3.3.2.2.2.4.4.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.4.4"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.3.3.2.2.2.4.4.1.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.4.4">superscript</csymbol><apply id="S4.SS2.p2.5.m5.3.3.2.2.2.4.4.2.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.4.4"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.3.3.2.2.2.4.4.2.1.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.4.4">subscript</csymbol><ci id="S4.SS2.p2.5.m5.3.3.2.2.2.4.4.2.2.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.4.4.2.2">𝛼</ci><cn id="S4.SS2.p2.5.m5.3.3.2.2.2.4.4.2.3.cmml" type="integer" xref="S4.SS2.p2.5.m5.3.3.2.2.2.4.4.2.3">2</cn></apply><ci id="S4.SS2.p2.5.m5.3.3.2.2.2.4.4.3.cmml" xref="S4.SS2.p2.5.m5.3.3.2.2.2.4.4.3">𝑖</ci></apply></vector><ci id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">⋯</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.3c">T_{i}=\{(Q_{i}^{t},D^{i}_{1},R_{1}^{i},\alpha_{1}^{i}),(Q_{i}^{t},D_{2}^{i},R_%
{2}^{i},\alpha_{2}^{i}),\cdots\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.5.m5.3d">italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { ( italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_D start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_α start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) , ( italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_D start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_α start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) , ⋯ }</annotation></semantics></math>. Since we have adopted various methods, multiple tuples have the same input query, and we only need the optimal rewrite rule sequence to form a demonstration for the query. Therefore, for each training query <math alttext="Q_{i}^{t}" class="ltx_Math" display="inline" id="S4.SS2.p2.6.m6.1"><semantics id="S4.SS2.p2.6.m6.1a"><msubsup id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml"><mi id="S4.SS2.p2.6.m6.1.1.2.2" xref="S4.SS2.p2.6.m6.1.1.2.2.cmml">Q</mi><mi id="S4.SS2.p2.6.m6.1.1.2.3" xref="S4.SS2.p2.6.m6.1.1.2.3.cmml">i</mi><mi id="S4.SS2.p2.6.m6.1.1.3" xref="S4.SS2.p2.6.m6.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><apply id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">superscript</csymbol><apply id="S4.SS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.1.1.2.1.cmml" xref="S4.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p2.6.m6.1.1.2.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2.2">𝑄</ci><ci id="S4.SS2.p2.6.m6.1.1.2.3.cmml" xref="S4.SS2.p2.6.m6.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p2.6.m6.1.1.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">Q_{i}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.6.m6.1d">italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> and its corresponding tuple group <math alttext="T_{i}" class="ltx_Math" display="inline" id="S4.SS2.p2.7.m7.1"><semantics id="S4.SS2.p2.7.m7.1a"><msub id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml"><mi id="S4.SS2.p2.7.m7.1.1.2" xref="S4.SS2.p2.7.m7.1.1.2.cmml">T</mi><mi id="S4.SS2.p2.7.m7.1.1.3" xref="S4.SS2.p2.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><apply id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.7.m7.1.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p2.7.m7.1.1.2.cmml" xref="S4.SS2.p2.7.m7.1.1.2">𝑇</ci><ci id="S4.SS2.p2.7.m7.1.1.3.cmml" xref="S4.SS2.p2.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">T_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.7.m7.1d">italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, we only select the tuple with the largest improved margin, and the order is denoted as <math alttext="*" class="ltx_Math" display="inline" id="S4.SS2.p2.8.m8.1"><semantics id="S4.SS2.p2.8.m8.1a"><mo id="S4.SS2.p2.8.m8.1.1" xref="S4.SS2.p2.8.m8.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m8.1b"><times id="S4.SS2.p2.8.m8.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m8.1c">*</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.8.m8.1d">∗</annotation></semantics></math>, which can be formulated as follows:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E2">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E2X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle*" class="ltx_Math" display="inline" id="S4.E2X.2.1.1.m1.1"><semantics id="S4.E2X.2.1.1.m1.1a"><mo id="S4.E2X.2.1.1.m1.1.1" xref="S4.E2X.2.1.1.m1.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S4.E2X.2.1.1.m1.1b"><times id="S4.E2X.2.1.1.m1.1.1.cmml" xref="S4.E2X.2.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.E2X.2.1.1.m1.1c">\displaystyle*</annotation><annotation encoding="application/x-llamapun" id="S4.E2X.2.1.1.m1.1d">∗</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=argmax_{j\in[1,|T_{i}|]}\alpha_{j}^{i}" class="ltx_Math" display="inline" id="S4.E2X.3.2.2.m1.2"><semantics id="S4.E2X.3.2.2.m1.2a"><mrow id="S4.E2X.3.2.2.m1.2.3" xref="S4.E2X.3.2.2.m1.2.3.cmml"><mi id="S4.E2X.3.2.2.m1.2.3.2" xref="S4.E2X.3.2.2.m1.2.3.2.cmml"></mi><mo id="S4.E2X.3.2.2.m1.2.3.1" xref="S4.E2X.3.2.2.m1.2.3.1.cmml">=</mo><mrow id="S4.E2X.3.2.2.m1.2.3.3" xref="S4.E2X.3.2.2.m1.2.3.3.cmml"><mi id="S4.E2X.3.2.2.m1.2.3.3.2" xref="S4.E2X.3.2.2.m1.2.3.3.2.cmml">a</mi><mo id="S4.E2X.3.2.2.m1.2.3.3.1" xref="S4.E2X.3.2.2.m1.2.3.3.1.cmml">⁢</mo><mi id="S4.E2X.3.2.2.m1.2.3.3.3" xref="S4.E2X.3.2.2.m1.2.3.3.3.cmml">r</mi><mo id="S4.E2X.3.2.2.m1.2.3.3.1a" xref="S4.E2X.3.2.2.m1.2.3.3.1.cmml">⁢</mo><mi id="S4.E2X.3.2.2.m1.2.3.3.4" xref="S4.E2X.3.2.2.m1.2.3.3.4.cmml">g</mi><mo id="S4.E2X.3.2.2.m1.2.3.3.1b" xref="S4.E2X.3.2.2.m1.2.3.3.1.cmml">⁢</mo><mi id="S4.E2X.3.2.2.m1.2.3.3.5" xref="S4.E2X.3.2.2.m1.2.3.3.5.cmml">m</mi><mo id="S4.E2X.3.2.2.m1.2.3.3.1c" xref="S4.E2X.3.2.2.m1.2.3.3.1.cmml">⁢</mo><mi id="S4.E2X.3.2.2.m1.2.3.3.6" xref="S4.E2X.3.2.2.m1.2.3.3.6.cmml">a</mi><mo id="S4.E2X.3.2.2.m1.2.3.3.1d" xref="S4.E2X.3.2.2.m1.2.3.3.1.cmml">⁢</mo><msub id="S4.E2X.3.2.2.m1.2.3.3.7" xref="S4.E2X.3.2.2.m1.2.3.3.7.cmml"><mi id="S4.E2X.3.2.2.m1.2.3.3.7.2" xref="S4.E2X.3.2.2.m1.2.3.3.7.2.cmml">x</mi><mrow id="S4.E2X.3.2.2.m1.2.2.2" xref="S4.E2X.3.2.2.m1.2.2.2.cmml"><mi id="S4.E2X.3.2.2.m1.2.2.2.4" xref="S4.E2X.3.2.2.m1.2.2.2.4.cmml">j</mi><mo id="S4.E2X.3.2.2.m1.2.2.2.3" xref="S4.E2X.3.2.2.m1.2.2.2.3.cmml">∈</mo><mrow id="S4.E2X.3.2.2.m1.2.2.2.2.1" xref="S4.E2X.3.2.2.m1.2.2.2.2.2.cmml"><mo id="S4.E2X.3.2.2.m1.2.2.2.2.1.2" stretchy="false" xref="S4.E2X.3.2.2.m1.2.2.2.2.2.cmml">[</mo><mn id="S4.E2X.3.2.2.m1.1.1.1.1" xref="S4.E2X.3.2.2.m1.1.1.1.1.cmml">1</mn><mo id="S4.E2X.3.2.2.m1.2.2.2.2.1.3" xref="S4.E2X.3.2.2.m1.2.2.2.2.2.cmml">,</mo><mrow id="S4.E2X.3.2.2.m1.2.2.2.2.1.1.1" xref="S4.E2X.3.2.2.m1.2.2.2.2.1.1.2.cmml"><mo id="S4.E2X.3.2.2.m1.2.2.2.2.1.1.1.2" stretchy="false" xref="S4.E2X.3.2.2.m1.2.2.2.2.1.1.2.1.cmml">|</mo><msub id="S4.E2X.3.2.2.m1.2.2.2.2.1.1.1.1" xref="S4.E2X.3.2.2.m1.2.2.2.2.1.1.1.1.cmml"><mi id="S4.E2X.3.2.2.m1.2.2.2.2.1.1.1.1.2" xref="S4.E2X.3.2.2.m1.2.2.2.2.1.1.1.1.2.cmml">T</mi><mi id="S4.E2X.3.2.2.m1.2.2.2.2.1.1.1.1.3" xref="S4.E2X.3.2.2.m1.2.2.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E2X.3.2.2.m1.2.2.2.2.1.1.1.3" stretchy="false" xref="S4.E2X.3.2.2.m1.2.2.2.2.1.1.2.1.cmml">|</mo></mrow><mo id="S4.E2X.3.2.2.m1.2.2.2.2.1.4" stretchy="false" xref="S4.E2X.3.2.2.m1.2.2.2.2.2.cmml">]</mo></mrow></mrow></msub><mo id="S4.E2X.3.2.2.m1.2.3.3.1e" xref="S4.E2X.3.2.2.m1.2.3.3.1.cmml">⁢</mo><msubsup id="S4.E2X.3.2.2.m1.2.3.3.8" xref="S4.E2X.3.2.2.m1.2.3.3.8.cmml"><mi id="S4.E2X.3.2.2.m1.2.3.3.8.2.2" xref="S4.E2X.3.2.2.m1.2.3.3.8.2.2.cmml">α</mi><mi id="S4.E2X.3.2.2.m1.2.3.3.8.2.3" xref="S4.E2X.3.2.2.m1.2.3.3.8.2.3.cmml">j</mi><mi id="S4.E2X.3.2.2.m1.2.3.3.8.3" xref="S4.E2X.3.2.2.m1.2.3.3.8.3.cmml">i</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2X.3.2.2.m1.2b"><apply id="S4.E2X.3.2.2.m1.2.3.cmml" xref="S4.E2X.3.2.2.m1.2.3"><eq id="S4.E2X.3.2.2.m1.2.3.1.cmml" xref="S4.E2X.3.2.2.m1.2.3.1"></eq><csymbol cd="latexml" id="S4.E2X.3.2.2.m1.2.3.2.cmml" xref="S4.E2X.3.2.2.m1.2.3.2">absent</csymbol><apply id="S4.E2X.3.2.2.m1.2.3.3.cmml" xref="S4.E2X.3.2.2.m1.2.3.3"><times id="S4.E2X.3.2.2.m1.2.3.3.1.cmml" xref="S4.E2X.3.2.2.m1.2.3.3.1"></times><ci id="S4.E2X.3.2.2.m1.2.3.3.2.cmml" xref="S4.E2X.3.2.2.m1.2.3.3.2">𝑎</ci><ci id="S4.E2X.3.2.2.m1.2.3.3.3.cmml" xref="S4.E2X.3.2.2.m1.2.3.3.3">𝑟</ci><ci id="S4.E2X.3.2.2.m1.2.3.3.4.cmml" xref="S4.E2X.3.2.2.m1.2.3.3.4">𝑔</ci><ci id="S4.E2X.3.2.2.m1.2.3.3.5.cmml" xref="S4.E2X.3.2.2.m1.2.3.3.5">𝑚</ci><ci id="S4.E2X.3.2.2.m1.2.3.3.6.cmml" xref="S4.E2X.3.2.2.m1.2.3.3.6">𝑎</ci><apply id="S4.E2X.3.2.2.m1.2.3.3.7.cmml" xref="S4.E2X.3.2.2.m1.2.3.3.7"><csymbol cd="ambiguous" id="S4.E2X.3.2.2.m1.2.3.3.7.1.cmml" xref="S4.E2X.3.2.2.m1.2.3.3.7">subscript</csymbol><ci id="S4.E2X.3.2.2.m1.2.3.3.7.2.cmml" xref="S4.E2X.3.2.2.m1.2.3.3.7.2">𝑥</ci><apply id="S4.E2X.3.2.2.m1.2.2.2.cmml" xref="S4.E2X.3.2.2.m1.2.2.2"><in id="S4.E2X.3.2.2.m1.2.2.2.3.cmml" xref="S4.E2X.3.2.2.m1.2.2.2.3"></in><ci id="S4.E2X.3.2.2.m1.2.2.2.4.cmml" xref="S4.E2X.3.2.2.m1.2.2.2.4">𝑗</ci><interval closure="closed" id="S4.E2X.3.2.2.m1.2.2.2.2.2.cmml" xref="S4.E2X.3.2.2.m1.2.2.2.2.1"><cn id="S4.E2X.3.2.2.m1.1.1.1.1.cmml" type="integer" xref="S4.E2X.3.2.2.m1.1.1.1.1">1</cn><apply id="S4.E2X.3.2.2.m1.2.2.2.2.1.1.2.cmml" xref="S4.E2X.3.2.2.m1.2.2.2.2.1.1.1"><abs id="S4.E2X.3.2.2.m1.2.2.2.2.1.1.2.1.cmml" xref="S4.E2X.3.2.2.m1.2.2.2.2.1.1.1.2"></abs><apply id="S4.E2X.3.2.2.m1.2.2.2.2.1.1.1.1.cmml" xref="S4.E2X.3.2.2.m1.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2X.3.2.2.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S4.E2X.3.2.2.m1.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="S4.E2X.3.2.2.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S4.E2X.3.2.2.m1.2.2.2.2.1.1.1.1.2">𝑇</ci><ci id="S4.E2X.3.2.2.m1.2.2.2.2.1.1.1.1.3.cmml" xref="S4.E2X.3.2.2.m1.2.2.2.2.1.1.1.1.3">𝑖</ci></apply></apply></interval></apply></apply><apply id="S4.E2X.3.2.2.m1.2.3.3.8.cmml" xref="S4.E2X.3.2.2.m1.2.3.3.8"><csymbol cd="ambiguous" id="S4.E2X.3.2.2.m1.2.3.3.8.1.cmml" xref="S4.E2X.3.2.2.m1.2.3.3.8">superscript</csymbol><apply id="S4.E2X.3.2.2.m1.2.3.3.8.2.cmml" xref="S4.E2X.3.2.2.m1.2.3.3.8"><csymbol cd="ambiguous" id="S4.E2X.3.2.2.m1.2.3.3.8.2.1.cmml" xref="S4.E2X.3.2.2.m1.2.3.3.8">subscript</csymbol><ci id="S4.E2X.3.2.2.m1.2.3.3.8.2.2.cmml" xref="S4.E2X.3.2.2.m1.2.3.3.8.2.2">𝛼</ci><ci id="S4.E2X.3.2.2.m1.2.3.3.8.2.3.cmml" xref="S4.E2X.3.2.2.m1.2.3.3.8.2.3">𝑗</ci></apply><ci id="S4.E2X.3.2.2.m1.2.3.3.8.3.cmml" xref="S4.E2X.3.2.2.m1.2.3.3.8.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2X.3.2.2.m1.2c">\displaystyle=argmax_{j\in[1,|T_{i}|]}\alpha_{j}^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.E2X.3.2.2.m1.2d">= italic_a italic_r italic_g italic_m italic_a italic_x start_POSTSUBSCRIPT italic_j ∈ [ 1 , | italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | ] end_POSTSUBSCRIPT italic_α start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E2Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle s.t." class="ltx_Math" display="inline" id="S4.E2Xa.2.1.1.m1.3"><semantics id="S4.E2Xa.2.1.1.m1.3a"><mrow id="S4.E2Xa.2.1.1.m1.3.3.1"><mrow id="S4.E2Xa.2.1.1.m1.3.3.1.1.2" xref="S4.E2Xa.2.1.1.m1.3.3.1.1.1.cmml"><mi id="S4.E2Xa.2.1.1.m1.1.1" xref="S4.E2Xa.2.1.1.m1.1.1.cmml">s</mi><mo id="S4.E2Xa.2.1.1.m1.3.3.1.1.2.1" lspace="0em" rspace="0.167em" xref="S4.E2Xa.2.1.1.m1.3.3.1.1.1a.cmml">.</mo><mi id="S4.E2Xa.2.1.1.m1.2.2" xref="S4.E2Xa.2.1.1.m1.2.2.cmml">t</mi></mrow><mo id="S4.E2Xa.2.1.1.m1.3.3.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2Xa.2.1.1.m1.3b"><apply id="S4.E2Xa.2.1.1.m1.3.3.1.1.1.cmml" xref="S4.E2Xa.2.1.1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E2Xa.2.1.1.m1.3.3.1.1.1a.cmml" xref="S4.E2Xa.2.1.1.m1.3.3.1.1.2.1">formulae-sequence</csymbol><ci id="S4.E2Xa.2.1.1.m1.1.1.cmml" xref="S4.E2Xa.2.1.1.m1.1.1">𝑠</ci><ci id="S4.E2Xa.2.1.1.m1.2.2.cmml" xref="S4.E2Xa.2.1.1.m1.2.2">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2Xa.2.1.1.m1.3c">\displaystyle s.t.</annotation><annotation encoding="application/x-llamapun" id="S4.E2Xa.2.1.1.m1.3d">italic_s . italic_t .</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle T_{i}=\{(Q_{i}^{t},D^{i}_{1},R_{1}^{i},\alpha_{1}^{i}),(Q_{i}^{t%
},D_{2}^{i},R_{2}^{i},\alpha_{2}^{i}),\cdots\}" class="ltx_Math" display="inline" id="S4.E2Xa.3.2.2.m1.3"><semantics id="S4.E2Xa.3.2.2.m1.3a"><mrow id="S4.E2Xa.3.2.2.m1.3.3" xref="S4.E2Xa.3.2.2.m1.3.3.cmml"><msub id="S4.E2Xa.3.2.2.m1.3.3.4" xref="S4.E2Xa.3.2.2.m1.3.3.4.cmml"><mi id="S4.E2Xa.3.2.2.m1.3.3.4.2" xref="S4.E2Xa.3.2.2.m1.3.3.4.2.cmml">T</mi><mi id="S4.E2Xa.3.2.2.m1.3.3.4.3" xref="S4.E2Xa.3.2.2.m1.3.3.4.3.cmml">i</mi></msub><mo id="S4.E2Xa.3.2.2.m1.3.3.3" xref="S4.E2Xa.3.2.2.m1.3.3.3.cmml">=</mo><mrow id="S4.E2Xa.3.2.2.m1.3.3.2.2" xref="S4.E2Xa.3.2.2.m1.3.3.2.3.cmml"><mo id="S4.E2Xa.3.2.2.m1.3.3.2.2.3" stretchy="false" xref="S4.E2Xa.3.2.2.m1.3.3.2.3.cmml">{</mo><mrow id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.5.cmml"><mo id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.5" stretchy="false" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.5.cmml">(</mo><msubsup id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.cmml"><mi id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.2.2" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.2.2.cmml">Q</mi><mi id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.2.3" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.3" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.6" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.5.cmml">,</mo><msubsup id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2.cmml"><mi id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2.2.2" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2.2.2.cmml">D</mi><mn id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2.3" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2.3.cmml">1</mn><mi id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2.2.3" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2.2.3.cmml">i</mi></msubsup><mo id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.7" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.5.cmml">,</mo><msubsup id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3.cmml"><mi id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3.2.2" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3.2.2.cmml">R</mi><mn id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3.2.3" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3.2.3.cmml">1</mn><mi id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3.3" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3.3.cmml">i</mi></msubsup><mo id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.8" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.5.cmml">,</mo><msubsup id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4.cmml"><mi id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4.2.2" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4.2.2.cmml">α</mi><mn id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4.2.3" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4.2.3.cmml">1</mn><mi id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4.3" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4.3.cmml">i</mi></msubsup><mo id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.9" stretchy="false" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.5.cmml">)</mo></mrow><mo id="S4.E2Xa.3.2.2.m1.3.3.2.2.4" xref="S4.E2Xa.3.2.2.m1.3.3.2.3.cmml">,</mo><mrow id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.5.cmml"><mo id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.5" stretchy="false" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.5.cmml">(</mo><msubsup id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1.cmml"><mi id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1.2.2" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1.2.2.cmml">Q</mi><mi id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1.2.3" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1.2.3.cmml">i</mi><mi id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1.3" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1.3.cmml">t</mi></msubsup><mo id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.6" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.5.cmml">,</mo><msubsup id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2.cmml"><mi id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2.2.2" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2.2.2.cmml">D</mi><mn id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2.2.3" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2.2.3.cmml">2</mn><mi id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2.3" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.7" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.5.cmml">,</mo><msubsup id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3.cmml"><mi id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3.2.2" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3.2.2.cmml">R</mi><mn id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3.2.3" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3.2.3.cmml">2</mn><mi id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3.3" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3.3.cmml">i</mi></msubsup><mo id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.8" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.5.cmml">,</mo><msubsup id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4.cmml"><mi id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4.2.2" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4.2.2.cmml">α</mi><mn id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4.2.3" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4.2.3.cmml">2</mn><mi id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4.3" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4.3.cmml">i</mi></msubsup><mo id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.9" stretchy="false" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.5.cmml">)</mo></mrow><mo id="S4.E2Xa.3.2.2.m1.3.3.2.2.5" xref="S4.E2Xa.3.2.2.m1.3.3.2.3.cmml">,</mo><mi id="S4.E2Xa.3.2.2.m1.1.1" mathvariant="normal" xref="S4.E2Xa.3.2.2.m1.1.1.cmml">⋯</mi><mo id="S4.E2Xa.3.2.2.m1.3.3.2.2.6" stretchy="false" xref="S4.E2Xa.3.2.2.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2Xa.3.2.2.m1.3b"><apply id="S4.E2Xa.3.2.2.m1.3.3.cmml" xref="S4.E2Xa.3.2.2.m1.3.3"><eq id="S4.E2Xa.3.2.2.m1.3.3.3.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.3"></eq><apply id="S4.E2Xa.3.2.2.m1.3.3.4.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.4"><csymbol cd="ambiguous" id="S4.E2Xa.3.2.2.m1.3.3.4.1.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.4">subscript</csymbol><ci id="S4.E2Xa.3.2.2.m1.3.3.4.2.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.4.2">𝑇</ci><ci id="S4.E2Xa.3.2.2.m1.3.3.4.3.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.4.3">𝑖</ci></apply><set id="S4.E2Xa.3.2.2.m1.3.3.2.3.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2"><vector id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.5.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4"><apply id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1">superscript</csymbol><apply id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.2.2">𝑄</ci><ci id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.3.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2.1.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2">subscript</csymbol><apply id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2.2.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2.2.1.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2">superscript</csymbol><ci id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2.2.2.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2.2.2">𝐷</ci><ci id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2.2.3.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2.2.3">𝑖</ci></apply><cn id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2.3.cmml" type="integer" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.2.2.3">1</cn></apply><apply id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3.1.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3">superscript</csymbol><apply id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3.2.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3.2.1.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3">subscript</csymbol><ci id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3.2.2.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3.2.2">𝑅</ci><cn id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3.2.3.cmml" type="integer" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3.2.3">1</cn></apply><ci id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3.3.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.3.3.3">𝑖</ci></apply><apply id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4"><csymbol cd="ambiguous" id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4.1.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4">superscript</csymbol><apply id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4.2.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4"><csymbol cd="ambiguous" id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4.2.1.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4">subscript</csymbol><ci id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4.2.2.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4.2.2">𝛼</ci><cn id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4.2.3.cmml" type="integer" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4.2.3">1</cn></apply><ci id="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4.3.cmml" xref="S4.E2Xa.3.2.2.m1.2.2.1.1.1.4.4.3">𝑖</ci></apply></vector><vector id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.5.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4"><apply id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1.1.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1">superscript</csymbol><apply id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1.2.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1.2.1.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1">subscript</csymbol><ci id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1.2.2.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1.2.2">𝑄</ci><ci id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1.2.3.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1.2.3">𝑖</ci></apply><ci id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1.3.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.1.1.3">𝑡</ci></apply><apply id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2.1.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2">superscript</csymbol><apply id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2.2.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2.2.1.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2">subscript</csymbol><ci id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2.2.2.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2.2.2">𝐷</ci><cn id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2.2.3.cmml" type="integer" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2.2.3">2</cn></apply><ci id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2.3.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.2.2.3">𝑖</ci></apply><apply id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3"><csymbol cd="ambiguous" id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3.1.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3">superscript</csymbol><apply id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3.2.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3"><csymbol cd="ambiguous" id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3.2.1.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3">subscript</csymbol><ci id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3.2.2.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3.2.2">𝑅</ci><cn id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3.2.3.cmml" type="integer" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3.2.3">2</cn></apply><ci id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3.3.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.3.3.3">𝑖</ci></apply><apply id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4"><csymbol cd="ambiguous" id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4.1.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4">superscript</csymbol><apply id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4.2.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4"><csymbol cd="ambiguous" id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4.2.1.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4">subscript</csymbol><ci id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4.2.2.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4.2.2">𝛼</ci><cn id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4.2.3.cmml" type="integer" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4.2.3">2</cn></apply><ci id="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4.3.cmml" xref="S4.E2Xa.3.2.2.m1.3.3.2.2.2.4.4.3">𝑖</ci></apply></vector><ci id="S4.E2Xa.3.2.2.m1.1.1.cmml" xref="S4.E2Xa.3.2.2.m1.1.1">⋯</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2Xa.3.2.2.m1.3c">\displaystyle T_{i}=\{(Q_{i}^{t},D^{i}_{1},R_{1}^{i},\alpha_{1}^{i}),(Q_{i}^{t%
},D_{2}^{i},R_{2}^{i},\alpha_{2}^{i}),\cdots\}</annotation><annotation encoding="application/x-llamapun" id="S4.E2Xa.3.2.2.m1.3d">italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { ( italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_D start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_α start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) , ( italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_D start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_α start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) , ⋯ }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S4.SS2.p2.17">Next, we construct the demonstration containing the input query and rules as the pair <math alttext="\langle Q^{t}_{i},R_{*}^{i}\rangle" class="ltx_Math" display="inline" id="S4.SS2.p2.9.m1.2"><semantics id="S4.SS2.p2.9.m1.2a"><mrow id="S4.SS2.p2.9.m1.2.2.2" xref="S4.SS2.p2.9.m1.2.2.3.cmml"><mo id="S4.SS2.p2.9.m1.2.2.2.3" stretchy="false" xref="S4.SS2.p2.9.m1.2.2.3.cmml">⟨</mo><msubsup id="S4.SS2.p2.9.m1.1.1.1.1" xref="S4.SS2.p2.9.m1.1.1.1.1.cmml"><mi id="S4.SS2.p2.9.m1.1.1.1.1.2.2" xref="S4.SS2.p2.9.m1.1.1.1.1.2.2.cmml">Q</mi><mi id="S4.SS2.p2.9.m1.1.1.1.1.3" xref="S4.SS2.p2.9.m1.1.1.1.1.3.cmml">i</mi><mi id="S4.SS2.p2.9.m1.1.1.1.1.2.3" xref="S4.SS2.p2.9.m1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="S4.SS2.p2.9.m1.2.2.2.4" xref="S4.SS2.p2.9.m1.2.2.3.cmml">,</mo><msubsup id="S4.SS2.p2.9.m1.2.2.2.2" xref="S4.SS2.p2.9.m1.2.2.2.2.cmml"><mi id="S4.SS2.p2.9.m1.2.2.2.2.2.2" xref="S4.SS2.p2.9.m1.2.2.2.2.2.2.cmml">R</mi><mo id="S4.SS2.p2.9.m1.2.2.2.2.2.3" xref="S4.SS2.p2.9.m1.2.2.2.2.2.3.cmml">∗</mo><mi id="S4.SS2.p2.9.m1.2.2.2.2.3" xref="S4.SS2.p2.9.m1.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S4.SS2.p2.9.m1.2.2.2.5" stretchy="false" xref="S4.SS2.p2.9.m1.2.2.3.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.9.m1.2b"><list id="S4.SS2.p2.9.m1.2.2.3.cmml" xref="S4.SS2.p2.9.m1.2.2.2"><apply id="S4.SS2.p2.9.m1.1.1.1.1.cmml" xref="S4.SS2.p2.9.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m1.1.1.1.1.1.cmml" xref="S4.SS2.p2.9.m1.1.1.1.1">subscript</csymbol><apply id="S4.SS2.p2.9.m1.1.1.1.1.2.cmml" xref="S4.SS2.p2.9.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m1.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.9.m1.1.1.1.1">superscript</csymbol><ci id="S4.SS2.p2.9.m1.1.1.1.1.2.2.cmml" xref="S4.SS2.p2.9.m1.1.1.1.1.2.2">𝑄</ci><ci id="S4.SS2.p2.9.m1.1.1.1.1.2.3.cmml" xref="S4.SS2.p2.9.m1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.p2.9.m1.1.1.1.1.3.cmml" xref="S4.SS2.p2.9.m1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS2.p2.9.m1.2.2.2.2.cmml" xref="S4.SS2.p2.9.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m1.2.2.2.2.1.cmml" xref="S4.SS2.p2.9.m1.2.2.2.2">superscript</csymbol><apply id="S4.SS2.p2.9.m1.2.2.2.2.2.cmml" xref="S4.SS2.p2.9.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m1.2.2.2.2.2.1.cmml" xref="S4.SS2.p2.9.m1.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p2.9.m1.2.2.2.2.2.2.cmml" xref="S4.SS2.p2.9.m1.2.2.2.2.2.2">𝑅</ci><times id="S4.SS2.p2.9.m1.2.2.2.2.2.3.cmml" xref="S4.SS2.p2.9.m1.2.2.2.2.2.3"></times></apply><ci id="S4.SS2.p2.9.m1.2.2.2.2.3.cmml" xref="S4.SS2.p2.9.m1.2.2.2.2.3">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.9.m1.2c">\langle Q^{t}_{i},R_{*}^{i}\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.9.m1.2d">⟨ italic_Q start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_R start_POSTSUBSCRIPT ∗ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ⟩</annotation></semantics></math>, and then add the demonstration to the pool.
As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S4.F5" title="Figure 5 ‣ 4. Demonstration Preparation ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">5</span></a>, when the largest improved margins <math alttext="\alpha_{1}^{1}" class="ltx_Math" display="inline" id="S4.SS2.p2.10.m2.1"><semantics id="S4.SS2.p2.10.m2.1a"><msubsup id="S4.SS2.p2.10.m2.1.1" xref="S4.SS2.p2.10.m2.1.1.cmml"><mi id="S4.SS2.p2.10.m2.1.1.2.2" xref="S4.SS2.p2.10.m2.1.1.2.2.cmml">α</mi><mn id="S4.SS2.p2.10.m2.1.1.2.3" xref="S4.SS2.p2.10.m2.1.1.2.3.cmml">1</mn><mn id="S4.SS2.p2.10.m2.1.1.3" xref="S4.SS2.p2.10.m2.1.1.3.cmml">1</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.10.m2.1b"><apply id="S4.SS2.p2.10.m2.1.1.cmml" xref="S4.SS2.p2.10.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.10.m2.1.1.1.cmml" xref="S4.SS2.p2.10.m2.1.1">superscript</csymbol><apply id="S4.SS2.p2.10.m2.1.1.2.cmml" xref="S4.SS2.p2.10.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.10.m2.1.1.2.1.cmml" xref="S4.SS2.p2.10.m2.1.1">subscript</csymbol><ci id="S4.SS2.p2.10.m2.1.1.2.2.cmml" xref="S4.SS2.p2.10.m2.1.1.2.2">𝛼</ci><cn id="S4.SS2.p2.10.m2.1.1.2.3.cmml" type="integer" xref="S4.SS2.p2.10.m2.1.1.2.3">1</cn></apply><cn id="S4.SS2.p2.10.m2.1.1.3.cmml" type="integer" xref="S4.SS2.p2.10.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.10.m2.1c">\alpha_{1}^{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.10.m2.1d">italic_α start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\alpha_{2}^{i}" class="ltx_Math" display="inline" id="S4.SS2.p2.11.m3.1"><semantics id="S4.SS2.p2.11.m3.1a"><msubsup id="S4.SS2.p2.11.m3.1.1" xref="S4.SS2.p2.11.m3.1.1.cmml"><mi id="S4.SS2.p2.11.m3.1.1.2.2" xref="S4.SS2.p2.11.m3.1.1.2.2.cmml">α</mi><mn id="S4.SS2.p2.11.m3.1.1.2.3" xref="S4.SS2.p2.11.m3.1.1.2.3.cmml">2</mn><mi id="S4.SS2.p2.11.m3.1.1.3" xref="S4.SS2.p2.11.m3.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.11.m3.1b"><apply id="S4.SS2.p2.11.m3.1.1.cmml" xref="S4.SS2.p2.11.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.11.m3.1.1.1.cmml" xref="S4.SS2.p2.11.m3.1.1">superscript</csymbol><apply id="S4.SS2.p2.11.m3.1.1.2.cmml" xref="S4.SS2.p2.11.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.11.m3.1.1.2.1.cmml" xref="S4.SS2.p2.11.m3.1.1">subscript</csymbol><ci id="S4.SS2.p2.11.m3.1.1.2.2.cmml" xref="S4.SS2.p2.11.m3.1.1.2.2">𝛼</ci><cn id="S4.SS2.p2.11.m3.1.1.2.3.cmml" type="integer" xref="S4.SS2.p2.11.m3.1.1.2.3">2</cn></apply><ci id="S4.SS2.p2.11.m3.1.1.3.cmml" xref="S4.SS2.p2.11.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.11.m3.1c">\alpha_{2}^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.11.m3.1d">italic_α start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> are identified for input queries <math alttext="Q_{1}^{t}" class="ltx_Math" display="inline" id="S4.SS2.p2.12.m4.1"><semantics id="S4.SS2.p2.12.m4.1a"><msubsup id="S4.SS2.p2.12.m4.1.1" xref="S4.SS2.p2.12.m4.1.1.cmml"><mi id="S4.SS2.p2.12.m4.1.1.2.2" xref="S4.SS2.p2.12.m4.1.1.2.2.cmml">Q</mi><mn id="S4.SS2.p2.12.m4.1.1.2.3" xref="S4.SS2.p2.12.m4.1.1.2.3.cmml">1</mn><mi id="S4.SS2.p2.12.m4.1.1.3" xref="S4.SS2.p2.12.m4.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.12.m4.1b"><apply id="S4.SS2.p2.12.m4.1.1.cmml" xref="S4.SS2.p2.12.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.12.m4.1.1.1.cmml" xref="S4.SS2.p2.12.m4.1.1">superscript</csymbol><apply id="S4.SS2.p2.12.m4.1.1.2.cmml" xref="S4.SS2.p2.12.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.12.m4.1.1.2.1.cmml" xref="S4.SS2.p2.12.m4.1.1">subscript</csymbol><ci id="S4.SS2.p2.12.m4.1.1.2.2.cmml" xref="S4.SS2.p2.12.m4.1.1.2.2">𝑄</ci><cn id="S4.SS2.p2.12.m4.1.1.2.3.cmml" type="integer" xref="S4.SS2.p2.12.m4.1.1.2.3">1</cn></apply><ci id="S4.SS2.p2.12.m4.1.1.3.cmml" xref="S4.SS2.p2.12.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.12.m4.1c">Q_{1}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.12.m4.1d">italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="Q_{i}^{t}" class="ltx_Math" display="inline" id="S4.SS2.p2.13.m5.1"><semantics id="S4.SS2.p2.13.m5.1a"><msubsup id="S4.SS2.p2.13.m5.1.1" xref="S4.SS2.p2.13.m5.1.1.cmml"><mi id="S4.SS2.p2.13.m5.1.1.2.2" xref="S4.SS2.p2.13.m5.1.1.2.2.cmml">Q</mi><mi id="S4.SS2.p2.13.m5.1.1.2.3" xref="S4.SS2.p2.13.m5.1.1.2.3.cmml">i</mi><mi id="S4.SS2.p2.13.m5.1.1.3" xref="S4.SS2.p2.13.m5.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.13.m5.1b"><apply id="S4.SS2.p2.13.m5.1.1.cmml" xref="S4.SS2.p2.13.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.13.m5.1.1.1.cmml" xref="S4.SS2.p2.13.m5.1.1">superscript</csymbol><apply id="S4.SS2.p2.13.m5.1.1.2.cmml" xref="S4.SS2.p2.13.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.13.m5.1.1.2.1.cmml" xref="S4.SS2.p2.13.m5.1.1">subscript</csymbol><ci id="S4.SS2.p2.13.m5.1.1.2.2.cmml" xref="S4.SS2.p2.13.m5.1.1.2.2">𝑄</ci><ci id="S4.SS2.p2.13.m5.1.1.2.3.cmml" xref="S4.SS2.p2.13.m5.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p2.13.m5.1.1.3.cmml" xref="S4.SS2.p2.13.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.13.m5.1c">Q_{i}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.13.m5.1d">italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, the corresponding demonstrations <math alttext="\langle Q_{1}^{t},R_{1}^{1}\rangle" class="ltx_Math" display="inline" id="S4.SS2.p2.14.m6.2"><semantics id="S4.SS2.p2.14.m6.2a"><mrow id="S4.SS2.p2.14.m6.2.2.2" xref="S4.SS2.p2.14.m6.2.2.3.cmml"><mo id="S4.SS2.p2.14.m6.2.2.2.3" stretchy="false" xref="S4.SS2.p2.14.m6.2.2.3.cmml">⟨</mo><msubsup id="S4.SS2.p2.14.m6.1.1.1.1" xref="S4.SS2.p2.14.m6.1.1.1.1.cmml"><mi id="S4.SS2.p2.14.m6.1.1.1.1.2.2" xref="S4.SS2.p2.14.m6.1.1.1.1.2.2.cmml">Q</mi><mn id="S4.SS2.p2.14.m6.1.1.1.1.2.3" xref="S4.SS2.p2.14.m6.1.1.1.1.2.3.cmml">1</mn><mi id="S4.SS2.p2.14.m6.1.1.1.1.3" xref="S4.SS2.p2.14.m6.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S4.SS2.p2.14.m6.2.2.2.4" xref="S4.SS2.p2.14.m6.2.2.3.cmml">,</mo><msubsup id="S4.SS2.p2.14.m6.2.2.2.2" xref="S4.SS2.p2.14.m6.2.2.2.2.cmml"><mi id="S4.SS2.p2.14.m6.2.2.2.2.2.2" xref="S4.SS2.p2.14.m6.2.2.2.2.2.2.cmml">R</mi><mn id="S4.SS2.p2.14.m6.2.2.2.2.2.3" xref="S4.SS2.p2.14.m6.2.2.2.2.2.3.cmml">1</mn><mn id="S4.SS2.p2.14.m6.2.2.2.2.3" xref="S4.SS2.p2.14.m6.2.2.2.2.3.cmml">1</mn></msubsup><mo id="S4.SS2.p2.14.m6.2.2.2.5" stretchy="false" xref="S4.SS2.p2.14.m6.2.2.3.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.14.m6.2b"><list id="S4.SS2.p2.14.m6.2.2.3.cmml" xref="S4.SS2.p2.14.m6.2.2.2"><apply id="S4.SS2.p2.14.m6.1.1.1.1.cmml" xref="S4.SS2.p2.14.m6.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.14.m6.1.1.1.1.1.cmml" xref="S4.SS2.p2.14.m6.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p2.14.m6.1.1.1.1.2.cmml" xref="S4.SS2.p2.14.m6.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.14.m6.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.14.m6.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.14.m6.1.1.1.1.2.2.cmml" xref="S4.SS2.p2.14.m6.1.1.1.1.2.2">𝑄</ci><cn id="S4.SS2.p2.14.m6.1.1.1.1.2.3.cmml" type="integer" xref="S4.SS2.p2.14.m6.1.1.1.1.2.3">1</cn></apply><ci id="S4.SS2.p2.14.m6.1.1.1.1.3.cmml" xref="S4.SS2.p2.14.m6.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS2.p2.14.m6.2.2.2.2.cmml" xref="S4.SS2.p2.14.m6.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.14.m6.2.2.2.2.1.cmml" xref="S4.SS2.p2.14.m6.2.2.2.2">superscript</csymbol><apply id="S4.SS2.p2.14.m6.2.2.2.2.2.cmml" xref="S4.SS2.p2.14.m6.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.14.m6.2.2.2.2.2.1.cmml" xref="S4.SS2.p2.14.m6.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p2.14.m6.2.2.2.2.2.2.cmml" xref="S4.SS2.p2.14.m6.2.2.2.2.2.2">𝑅</ci><cn id="S4.SS2.p2.14.m6.2.2.2.2.2.3.cmml" type="integer" xref="S4.SS2.p2.14.m6.2.2.2.2.2.3">1</cn></apply><cn id="S4.SS2.p2.14.m6.2.2.2.2.3.cmml" type="integer" xref="S4.SS2.p2.14.m6.2.2.2.2.3">1</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.14.m6.2c">\langle Q_{1}^{t},R_{1}^{1}\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.14.m6.2d">⟨ italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ⟩</annotation></semantics></math> and <math alttext="\langle Q_{i}^{t},R_{2}^{i}\rangle" class="ltx_Math" display="inline" id="S4.SS2.p2.15.m7.2"><semantics id="S4.SS2.p2.15.m7.2a"><mrow id="S4.SS2.p2.15.m7.2.2.2" xref="S4.SS2.p2.15.m7.2.2.3.cmml"><mo id="S4.SS2.p2.15.m7.2.2.2.3" stretchy="false" xref="S4.SS2.p2.15.m7.2.2.3.cmml">⟨</mo><msubsup id="S4.SS2.p2.15.m7.1.1.1.1" xref="S4.SS2.p2.15.m7.1.1.1.1.cmml"><mi id="S4.SS2.p2.15.m7.1.1.1.1.2.2" xref="S4.SS2.p2.15.m7.1.1.1.1.2.2.cmml">Q</mi><mi id="S4.SS2.p2.15.m7.1.1.1.1.2.3" xref="S4.SS2.p2.15.m7.1.1.1.1.2.3.cmml">i</mi><mi id="S4.SS2.p2.15.m7.1.1.1.1.3" xref="S4.SS2.p2.15.m7.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S4.SS2.p2.15.m7.2.2.2.4" xref="S4.SS2.p2.15.m7.2.2.3.cmml">,</mo><msubsup id="S4.SS2.p2.15.m7.2.2.2.2" xref="S4.SS2.p2.15.m7.2.2.2.2.cmml"><mi id="S4.SS2.p2.15.m7.2.2.2.2.2.2" xref="S4.SS2.p2.15.m7.2.2.2.2.2.2.cmml">R</mi><mn id="S4.SS2.p2.15.m7.2.2.2.2.2.3" xref="S4.SS2.p2.15.m7.2.2.2.2.2.3.cmml">2</mn><mi id="S4.SS2.p2.15.m7.2.2.2.2.3" xref="S4.SS2.p2.15.m7.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S4.SS2.p2.15.m7.2.2.2.5" stretchy="false" xref="S4.SS2.p2.15.m7.2.2.3.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.15.m7.2b"><list id="S4.SS2.p2.15.m7.2.2.3.cmml" xref="S4.SS2.p2.15.m7.2.2.2"><apply id="S4.SS2.p2.15.m7.1.1.1.1.cmml" xref="S4.SS2.p2.15.m7.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.15.m7.1.1.1.1.1.cmml" xref="S4.SS2.p2.15.m7.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p2.15.m7.1.1.1.1.2.cmml" xref="S4.SS2.p2.15.m7.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.15.m7.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.15.m7.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.15.m7.1.1.1.1.2.2.cmml" xref="S4.SS2.p2.15.m7.1.1.1.1.2.2">𝑄</ci><ci id="S4.SS2.p2.15.m7.1.1.1.1.2.3.cmml" xref="S4.SS2.p2.15.m7.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p2.15.m7.1.1.1.1.3.cmml" xref="S4.SS2.p2.15.m7.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS2.p2.15.m7.2.2.2.2.cmml" xref="S4.SS2.p2.15.m7.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.15.m7.2.2.2.2.1.cmml" xref="S4.SS2.p2.15.m7.2.2.2.2">superscript</csymbol><apply id="S4.SS2.p2.15.m7.2.2.2.2.2.cmml" xref="S4.SS2.p2.15.m7.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.15.m7.2.2.2.2.2.1.cmml" xref="S4.SS2.p2.15.m7.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p2.15.m7.2.2.2.2.2.2.cmml" xref="S4.SS2.p2.15.m7.2.2.2.2.2.2">𝑅</ci><cn id="S4.SS2.p2.15.m7.2.2.2.2.2.3.cmml" type="integer" xref="S4.SS2.p2.15.m7.2.2.2.2.2.3">2</cn></apply><ci id="S4.SS2.p2.15.m7.2.2.2.2.3.cmml" xref="S4.SS2.p2.15.m7.2.2.2.2.3">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.15.m7.2c">\langle Q_{i}^{t},R_{2}^{i}\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.15.m7.2d">⟨ italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ⟩</annotation></semantics></math> are selected with the rewrite rules <math alttext="R_{1}^{1}" class="ltx_Math" display="inline" id="S4.SS2.p2.16.m8.1"><semantics id="S4.SS2.p2.16.m8.1a"><msubsup id="S4.SS2.p2.16.m8.1.1" xref="S4.SS2.p2.16.m8.1.1.cmml"><mi id="S4.SS2.p2.16.m8.1.1.2.2" xref="S4.SS2.p2.16.m8.1.1.2.2.cmml">R</mi><mn id="S4.SS2.p2.16.m8.1.1.2.3" xref="S4.SS2.p2.16.m8.1.1.2.3.cmml">1</mn><mn id="S4.SS2.p2.16.m8.1.1.3" xref="S4.SS2.p2.16.m8.1.1.3.cmml">1</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.16.m8.1b"><apply id="S4.SS2.p2.16.m8.1.1.cmml" xref="S4.SS2.p2.16.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.16.m8.1.1.1.cmml" xref="S4.SS2.p2.16.m8.1.1">superscript</csymbol><apply id="S4.SS2.p2.16.m8.1.1.2.cmml" xref="S4.SS2.p2.16.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.16.m8.1.1.2.1.cmml" xref="S4.SS2.p2.16.m8.1.1">subscript</csymbol><ci id="S4.SS2.p2.16.m8.1.1.2.2.cmml" xref="S4.SS2.p2.16.m8.1.1.2.2">𝑅</ci><cn id="S4.SS2.p2.16.m8.1.1.2.3.cmml" type="integer" xref="S4.SS2.p2.16.m8.1.1.2.3">1</cn></apply><cn id="S4.SS2.p2.16.m8.1.1.3.cmml" type="integer" xref="S4.SS2.p2.16.m8.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.16.m8.1c">R_{1}^{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.16.m8.1d">italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="R_{2}^{i}" class="ltx_Math" display="inline" id="S4.SS2.p2.17.m9.1"><semantics id="S4.SS2.p2.17.m9.1a"><msubsup id="S4.SS2.p2.17.m9.1.1" xref="S4.SS2.p2.17.m9.1.1.cmml"><mi id="S4.SS2.p2.17.m9.1.1.2.2" xref="S4.SS2.p2.17.m9.1.1.2.2.cmml">R</mi><mn id="S4.SS2.p2.17.m9.1.1.2.3" xref="S4.SS2.p2.17.m9.1.1.2.3.cmml">2</mn><mi id="S4.SS2.p2.17.m9.1.1.3" xref="S4.SS2.p2.17.m9.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.17.m9.1b"><apply id="S4.SS2.p2.17.m9.1.1.cmml" xref="S4.SS2.p2.17.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.17.m9.1.1.1.cmml" xref="S4.SS2.p2.17.m9.1.1">superscript</csymbol><apply id="S4.SS2.p2.17.m9.1.1.2.cmml" xref="S4.SS2.p2.17.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.17.m9.1.1.2.1.cmml" xref="S4.SS2.p2.17.m9.1.1">subscript</csymbol><ci id="S4.SS2.p2.17.m9.1.1.2.2.cmml" xref="S4.SS2.p2.17.m9.1.1.2.2">𝑅</ci><cn id="S4.SS2.p2.17.m9.1.1.2.3.cmml" type="integer" xref="S4.SS2.p2.17.m9.1.1.2.3">2</cn></apply><ci id="S4.SS2.p2.17.m9.1.1.3.cmml" xref="S4.SS2.p2.17.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.17.m9.1c">R_{2}^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.17.m9.1d">italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> adopted.</p>
</div>
<figure class="ltx_figure" id="S4.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_missing ltx_missing_image" id="S4.F6.g1" src=""/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6. </span>Our representation model and its contrastive training structure. Each node of the query tree is encoded into a fixed length vector, while the final representation of the query is obtained by applying a tree-biased attention over the tree nodes. Such model <math alttext="E" class="ltx_Math" display="inline" id="S4.F6.2.m1.1"><semantics id="S4.F6.2.m1.1b"><mi id="S4.F6.2.m1.1.1" xref="S4.F6.2.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.F6.2.m1.1c"><ci id="S4.F6.2.m1.1.1.cmml" xref="S4.F6.2.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.2.m1.1d">E</annotation><annotation encoding="application/x-llamapun" id="S4.F6.2.m1.1e">italic_E</annotation></semantics></math> is then trained with contrastive query tuples generated.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S4.F6.3">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.F6.4">demonstration selector</p>
</div>
</div>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Demonstration Selection</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.p1.1.1">Motivation.</span> Addressing the challenge of enhancing system performance, the selection of an optimal rewrite demonstration to guide the LLM for any given input query is required and remains uncertain. Intuitively, the greater the “similarity” between the input and demonstration queries, the more applicable the rewrite rule, thereby enhancing the LLM’s output efficacy. Therefore, to capture such “similarity”, we design a contrastive model to learn the representations of queries in this <span class="ltx_text ltx_font_italic" id="S5.p1.1.2">Demonstration Selection</span> module, where better demonstration queries are to have more similar representations to the input query. Consequently, the demonstration query that exhibits the highest resemblance to the input query is selected for the LLM, optimizing the generation of more effective outputs.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.1"><span class="ltx_text ltx_font_bold" id="S5.p2.1.1">Overview.</span> In order to learn a contrastive representation model efficiently and effectively, the selection module consists of two main components: our contrastive model and a curriculum learning pipeline to improve the model training. We will first outline the representation model and its contrastive learning structure in Section <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S5.SS1" title="5.1. Contrastive Representation Model ‣ 5. Demonstration Selection ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">5.1</span></a>, followed by a detailed discussion of the whole model learning pipeline in Section <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S5.SS2" title="5.2. Curriculum Learning Pipeline ‣ 5. Demonstration Selection ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">5.2</span></a>.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Contrastive Representation Model</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.2">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S4.F6" title="Figure 6 ‣ 4.2. Pool Generator ‣ 4. Demonstration Preparation ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">6</span></a>, our representation model <math alttext="E" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mi id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><ci id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">italic_E</annotation></semantics></math> is constructed as a query encoder to encode the information describing a query, and a contrastive training structure to further train the encoder given training data. In particular, the information of a query tree is first encoded by nodes into node embeddings. A tree-biased attention layer will then compute the final representation of the query given the node embeddings. Such an encoder <math alttext="E" class="ltx_Math" display="inline" id="S5.SS1.p1.2.m2.1"><semantics id="S5.SS1.p1.2.m2.1a"><mi id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><ci id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">E</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.2.m2.1d">italic_E</annotation></semantics></math> is then trained using the contrastive learning structure drawn below it.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p2.1.1">Query encoder.</span> The representation of a query should focus on various key attributes, like the query tree structure and columns selected. Therefore, we design an encoder following <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib34" title="">2022</a>)</cite> to take the query trees generated by DBMS’ query analyzer as inputs. It is notable that the original encoding in <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib34" title="">2022</a>)</cite> utilizes the physical query plan which contains richer information, so that the objective of estimating query cost can be successfully achieved. Since we aim to capture the similarity between queries, we separately encode the following information for each query tree node instead in our encoder, as shown in the top half of Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S4.F6" title="Figure 6 ‣ 4.2. Pool Generator ‣ 4. Demonstration Preparation ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">6</span></a>:</p>
</div>
<div class="ltx_para" id="S5.SS1.p3">
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.1">Operator type:</span> We use one-hot encoding to encode the operator types into one vector, with value one for the current node operator type and zero for the rest positions.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.1">Operator conditions:</span> Within each node, the details for the operator are explained in parentheses, including sort order for “Sort” operator, selected column for “Scan” operator etc. Different from the physical plans used in <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib34" title="">2022</a>)</cite>, such information has no unified form for encoding. We consider the conditions as text and encode using a pre-trained Sentence Transformers encoder <cite class="ltx_cite ltx_citemacro_citep">(Reimers and Gurevych, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib25" title="">2019</a>)</cite>. Such an encoder can capture the textual differences between conditions effectively and have unified embedding dimensions to simplify further analysis.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.1">Cardinality and cost:</span> From <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib35" title="">2024</a>)</cite> we observe that the estimated cardinality and cost are important in describing a query. We collect the row count and estimated cumulative cost values and normalise them through an MLP layer.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S5.SS1.p3.1">We simply concatenate the three information vectors together to be the encoded embedding for a node in the given query tree. We use the same tree Transformer model in <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib34" title="">2022</a>)</cite> to get the final representation of a query given its tree nodes’ embeddings. The final representation of the whole query will be computed by the tree-biased attention module.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p4">
<p class="ltx_p" id="S5.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.1">Contrastive learning structure.</span></p>
</div>
<div class="ltx_para" id="S5.SS1.p5">
<p class="ltx_p" id="S5.SS1.p5.6">Due to the necessity of executing queries, the volume of training triplets produced by our demonstration preparation module is limited. Unlike the query representation model in <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib34" title="">2022</a>)</cite>, which is trained directly on abundant labeled data, our approach requires a more sophisticated training framework to effectively capture query representation with the generated training data. Inspired by SimCSE <cite class="ltx_cite ltx_citemacro_citep">(Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib14" title="">2022</a>)</cite>, we design a contrastive learning structure to train our query representation model on the limited training data. In a training batch containing <math alttext="N" class="ltx_Math" display="inline" id="S5.SS1.p5.1.m1.1"><semantics id="S5.SS1.p5.1.m1.1a"><mi id="S5.SS1.p5.1.m1.1.1" xref="S5.SS1.p5.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.1.m1.1b"><ci id="S5.SS1.p5.1.m1.1.1.cmml" xref="S5.SS1.p5.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p5.1.m1.1d">italic_N</annotation></semantics></math> tuples, we consider each original query’s improved query as its “positive” query, its degraded query as its “hard negative” query, and the remaining improved and degraded queries within the same batch as “negative” queries. This allows us to pull close distances between original queries and their improved versions while pushing apart those with degraded queries.
Following such setting, the loss <math alttext="l_{i}" class="ltx_Math" display="inline" id="S5.SS1.p5.2.m2.1"><semantics id="S5.SS1.p5.2.m2.1a"><msub id="S5.SS1.p5.2.m2.1.1" xref="S5.SS1.p5.2.m2.1.1.cmml"><mi id="S5.SS1.p5.2.m2.1.1.2" xref="S5.SS1.p5.2.m2.1.1.2.cmml">l</mi><mi id="S5.SS1.p5.2.m2.1.1.3" xref="S5.SS1.p5.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.2.m2.1b"><apply id="S5.SS1.p5.2.m2.1.1.cmml" xref="S5.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.2.m2.1.1.1.cmml" xref="S5.SS1.p5.2.m2.1.1">subscript</csymbol><ci id="S5.SS1.p5.2.m2.1.1.2.cmml" xref="S5.SS1.p5.2.m2.1.1.2">𝑙</ci><ci id="S5.SS1.p5.2.m2.1.1.3.cmml" xref="S5.SS1.p5.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.2.m2.1c">l_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p5.2.m2.1d">italic_l start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for the <math alttext="i_{th}" class="ltx_Math" display="inline" id="S5.SS1.p5.3.m3.1"><semantics id="S5.SS1.p5.3.m3.1a"><msub id="S5.SS1.p5.3.m3.1.1" xref="S5.SS1.p5.3.m3.1.1.cmml"><mi id="S5.SS1.p5.3.m3.1.1.2" xref="S5.SS1.p5.3.m3.1.1.2.cmml">i</mi><mrow id="S5.SS1.p5.3.m3.1.1.3" xref="S5.SS1.p5.3.m3.1.1.3.cmml"><mi id="S5.SS1.p5.3.m3.1.1.3.2" xref="S5.SS1.p5.3.m3.1.1.3.2.cmml">t</mi><mo id="S5.SS1.p5.3.m3.1.1.3.1" xref="S5.SS1.p5.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S5.SS1.p5.3.m3.1.1.3.3" xref="S5.SS1.p5.3.m3.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.3.m3.1b"><apply id="S5.SS1.p5.3.m3.1.1.cmml" xref="S5.SS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.3.m3.1.1.1.cmml" xref="S5.SS1.p5.3.m3.1.1">subscript</csymbol><ci id="S5.SS1.p5.3.m3.1.1.2.cmml" xref="S5.SS1.p5.3.m3.1.1.2">𝑖</ci><apply id="S5.SS1.p5.3.m3.1.1.3.cmml" xref="S5.SS1.p5.3.m3.1.1.3"><times id="S5.SS1.p5.3.m3.1.1.3.1.cmml" xref="S5.SS1.p5.3.m3.1.1.3.1"></times><ci id="S5.SS1.p5.3.m3.1.1.3.2.cmml" xref="S5.SS1.p5.3.m3.1.1.3.2">𝑡</ci><ci id="S5.SS1.p5.3.m3.1.1.3.3.cmml" xref="S5.SS1.p5.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.3.m3.1c">i_{th}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p5.3.m3.1d">italic_i start_POSTSUBSCRIPT italic_t italic_h end_POSTSUBSCRIPT</annotation></semantics></math> tuple (<math alttext="Q_{i}" class="ltx_Math" display="inline" id="S5.SS1.p5.4.m4.1"><semantics id="S5.SS1.p5.4.m4.1a"><msub id="S5.SS1.p5.4.m4.1.1" xref="S5.SS1.p5.4.m4.1.1.cmml"><mi id="S5.SS1.p5.4.m4.1.1.2" xref="S5.SS1.p5.4.m4.1.1.2.cmml">Q</mi><mi id="S5.SS1.p5.4.m4.1.1.3" xref="S5.SS1.p5.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.4.m4.1b"><apply id="S5.SS1.p5.4.m4.1.1.cmml" xref="S5.SS1.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.4.m4.1.1.1.cmml" xref="S5.SS1.p5.4.m4.1.1">subscript</csymbol><ci id="S5.SS1.p5.4.m4.1.1.2.cmml" xref="S5.SS1.p5.4.m4.1.1.2">𝑄</ci><ci id="S5.SS1.p5.4.m4.1.1.3.cmml" xref="S5.SS1.p5.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.4.m4.1c">Q_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p5.4.m4.1d">italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="Q_{i}^{+}" class="ltx_Math" display="inline" id="S5.SS1.p5.5.m5.1"><semantics id="S5.SS1.p5.5.m5.1a"><msubsup id="S5.SS1.p5.5.m5.1.1" xref="S5.SS1.p5.5.m5.1.1.cmml"><mi id="S5.SS1.p5.5.m5.1.1.2.2" xref="S5.SS1.p5.5.m5.1.1.2.2.cmml">Q</mi><mi id="S5.SS1.p5.5.m5.1.1.2.3" xref="S5.SS1.p5.5.m5.1.1.2.3.cmml">i</mi><mo id="S5.SS1.p5.5.m5.1.1.3" xref="S5.SS1.p5.5.m5.1.1.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.5.m5.1b"><apply id="S5.SS1.p5.5.m5.1.1.cmml" xref="S5.SS1.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.5.m5.1.1.1.cmml" xref="S5.SS1.p5.5.m5.1.1">superscript</csymbol><apply id="S5.SS1.p5.5.m5.1.1.2.cmml" xref="S5.SS1.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.5.m5.1.1.2.1.cmml" xref="S5.SS1.p5.5.m5.1.1">subscript</csymbol><ci id="S5.SS1.p5.5.m5.1.1.2.2.cmml" xref="S5.SS1.p5.5.m5.1.1.2.2">𝑄</ci><ci id="S5.SS1.p5.5.m5.1.1.2.3.cmml" xref="S5.SS1.p5.5.m5.1.1.2.3">𝑖</ci></apply><plus id="S5.SS1.p5.5.m5.1.1.3.cmml" xref="S5.SS1.p5.5.m5.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.5.m5.1c">Q_{i}^{+}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p5.5.m5.1d">italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="Q_{i}^{-}" class="ltx_Math" display="inline" id="S5.SS1.p5.6.m6.1"><semantics id="S5.SS1.p5.6.m6.1a"><msubsup id="S5.SS1.p5.6.m6.1.1" xref="S5.SS1.p5.6.m6.1.1.cmml"><mi id="S5.SS1.p5.6.m6.1.1.2.2" xref="S5.SS1.p5.6.m6.1.1.2.2.cmml">Q</mi><mi id="S5.SS1.p5.6.m6.1.1.2.3" xref="S5.SS1.p5.6.m6.1.1.2.3.cmml">i</mi><mo id="S5.SS1.p5.6.m6.1.1.3" xref="S5.SS1.p5.6.m6.1.1.3.cmml">−</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.6.m6.1b"><apply id="S5.SS1.p5.6.m6.1.1.cmml" xref="S5.SS1.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.6.m6.1.1.1.cmml" xref="S5.SS1.p5.6.m6.1.1">superscript</csymbol><apply id="S5.SS1.p5.6.m6.1.1.2.cmml" xref="S5.SS1.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.6.m6.1.1.2.1.cmml" xref="S5.SS1.p5.6.m6.1.1">subscript</csymbol><ci id="S5.SS1.p5.6.m6.1.1.2.2.cmml" xref="S5.SS1.p5.6.m6.1.1.2.2">𝑄</ci><ci id="S5.SS1.p5.6.m6.1.1.2.3.cmml" xref="S5.SS1.p5.6.m6.1.1.2.3">𝑖</ci></apply><minus id="S5.SS1.p5.6.m6.1.1.3.cmml" xref="S5.SS1.p5.6.m6.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.6.m6.1c">Q_{i}^{-}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p5.6.m6.1d">italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math>) can be computed as</p>
<table class="ltx_equation ltx_eqn_table" id="S5.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="l_{i}=-\log\frac{e^{\textnormal{sim}(h_{i},h_{i}^{+})/\tau}}{\Sigma_{j=1}^{N}(%
e^{\textnormal{sim}(h_{i},h_{j}^{+})/\tau}+e^{\textnormal{sim}(h_{i},h_{j}^{-}%
)/\tau})}" class="ltx_Math" display="block" id="S5.E3.m1.7"><semantics id="S5.E3.m1.7a"><mrow id="S5.E3.m1.7.8" xref="S5.E3.m1.7.8.cmml"><msub id="S5.E3.m1.7.8.2" xref="S5.E3.m1.7.8.2.cmml"><mi id="S5.E3.m1.7.8.2.2" xref="S5.E3.m1.7.8.2.2.cmml">l</mi><mi id="S5.E3.m1.7.8.2.3" xref="S5.E3.m1.7.8.2.3.cmml">i</mi></msub><mo id="S5.E3.m1.7.8.1" xref="S5.E3.m1.7.8.1.cmml">=</mo><mrow id="S5.E3.m1.7.8.3" xref="S5.E3.m1.7.8.3.cmml"><mo id="S5.E3.m1.7.8.3a" rspace="0.167em" xref="S5.E3.m1.7.8.3.cmml">−</mo><mrow id="S5.E3.m1.7.8.3.2" xref="S5.E3.m1.7.8.3.2.cmml"><mi id="S5.E3.m1.7.8.3.2.1" xref="S5.E3.m1.7.8.3.2.1.cmml">log</mi><mo id="S5.E3.m1.7.8.3.2a" lspace="0.167em" xref="S5.E3.m1.7.8.3.2.cmml">⁡</mo><mfrac id="S5.E3.m1.7.7" xref="S5.E3.m1.7.7.cmml"><msup id="S5.E3.m1.2.2.2" xref="S5.E3.m1.2.2.2.cmml"><mi id="S5.E3.m1.2.2.2.4" xref="S5.E3.m1.2.2.2.4.cmml">e</mi><mrow id="S5.E3.m1.2.2.2.2.2" xref="S5.E3.m1.2.2.2.2.2.cmml"><mrow id="S5.E3.m1.2.2.2.2.2.2" xref="S5.E3.m1.2.2.2.2.2.2.cmml"><mtext id="S5.E3.m1.2.2.2.2.2.2.4" xref="S5.E3.m1.2.2.2.2.2.2.4a.cmml">sim</mtext><mo id="S5.E3.m1.2.2.2.2.2.2.3" xref="S5.E3.m1.2.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S5.E3.m1.2.2.2.2.2.2.2.2" xref="S5.E3.m1.2.2.2.2.2.2.2.3.cmml"><mo id="S5.E3.m1.2.2.2.2.2.2.2.2.3" stretchy="false" xref="S5.E3.m1.2.2.2.2.2.2.2.3.cmml">(</mo><msub id="S5.E3.m1.1.1.1.1.1.1.1.1.1" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S5.E3.m1.1.1.1.1.1.1.1.1.1.2" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml">h</mi><mi id="S5.E3.m1.1.1.1.1.1.1.1.1.1.3" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S5.E3.m1.2.2.2.2.2.2.2.2.4" xref="S5.E3.m1.2.2.2.2.2.2.2.3.cmml">,</mo><msubsup id="S5.E3.m1.2.2.2.2.2.2.2.2.2" xref="S5.E3.m1.2.2.2.2.2.2.2.2.2.cmml"><mi id="S5.E3.m1.2.2.2.2.2.2.2.2.2.2.2" xref="S5.E3.m1.2.2.2.2.2.2.2.2.2.2.2.cmml">h</mi><mi id="S5.E3.m1.2.2.2.2.2.2.2.2.2.2.3" xref="S5.E3.m1.2.2.2.2.2.2.2.2.2.2.3.cmml">i</mi><mo id="S5.E3.m1.2.2.2.2.2.2.2.2.2.3" xref="S5.E3.m1.2.2.2.2.2.2.2.2.2.3.cmml">+</mo></msubsup><mo id="S5.E3.m1.2.2.2.2.2.2.2.2.5" stretchy="false" xref="S5.E3.m1.2.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S5.E3.m1.2.2.2.2.2.3" xref="S5.E3.m1.2.2.2.2.2.3.cmml">/</mo><mi id="S5.E3.m1.2.2.2.2.2.4" xref="S5.E3.m1.2.2.2.2.2.4.cmml">τ</mi></mrow></msup><mrow id="S5.E3.m1.7.7.7" xref="S5.E3.m1.7.7.7.cmml"><msubsup id="S5.E3.m1.7.7.7.7" xref="S5.E3.m1.7.7.7.7.cmml"><mi id="S5.E3.m1.7.7.7.7.2.2" mathvariant="normal" xref="S5.E3.m1.7.7.7.7.2.2.cmml">Σ</mi><mrow id="S5.E3.m1.7.7.7.7.2.3" xref="S5.E3.m1.7.7.7.7.2.3.cmml"><mi id="S5.E3.m1.7.7.7.7.2.3.2" xref="S5.E3.m1.7.7.7.7.2.3.2.cmml">j</mi><mo id="S5.E3.m1.7.7.7.7.2.3.1" xref="S5.E3.m1.7.7.7.7.2.3.1.cmml">=</mo><mn id="S5.E3.m1.7.7.7.7.2.3.3" xref="S5.E3.m1.7.7.7.7.2.3.3.cmml">1</mn></mrow><mi id="S5.E3.m1.7.7.7.7.3" xref="S5.E3.m1.7.7.7.7.3.cmml">N</mi></msubsup><mo id="S5.E3.m1.7.7.7.6" xref="S5.E3.m1.7.7.7.6.cmml">⁢</mo><mrow id="S5.E3.m1.7.7.7.5.1" xref="S5.E3.m1.7.7.7.5.1.1.cmml"><mo id="S5.E3.m1.7.7.7.5.1.2" stretchy="false" xref="S5.E3.m1.7.7.7.5.1.1.cmml">(</mo><mrow id="S5.E3.m1.7.7.7.5.1.1" xref="S5.E3.m1.7.7.7.5.1.1.cmml"><msup id="S5.E3.m1.7.7.7.5.1.1.2" xref="S5.E3.m1.7.7.7.5.1.1.2.cmml"><mi id="S5.E3.m1.7.7.7.5.1.1.2.2" xref="S5.E3.m1.7.7.7.5.1.1.2.2.cmml">e</mi><mrow id="S5.E3.m1.4.4.4.2.2" xref="S5.E3.m1.4.4.4.2.2.cmml"><mrow id="S5.E3.m1.4.4.4.2.2.2" xref="S5.E3.m1.4.4.4.2.2.2.cmml"><mtext id="S5.E3.m1.4.4.4.2.2.2.4" xref="S5.E3.m1.4.4.4.2.2.2.4a.cmml">sim</mtext><mo id="S5.E3.m1.4.4.4.2.2.2.3" xref="S5.E3.m1.4.4.4.2.2.2.3.cmml">⁢</mo><mrow id="S5.E3.m1.4.4.4.2.2.2.2.2" xref="S5.E3.m1.4.4.4.2.2.2.2.3.cmml"><mo id="S5.E3.m1.4.4.4.2.2.2.2.2.3" stretchy="false" xref="S5.E3.m1.4.4.4.2.2.2.2.3.cmml">(</mo><msub id="S5.E3.m1.3.3.3.1.1.1.1.1.1" xref="S5.E3.m1.3.3.3.1.1.1.1.1.1.cmml"><mi id="S5.E3.m1.3.3.3.1.1.1.1.1.1.2" xref="S5.E3.m1.3.3.3.1.1.1.1.1.1.2.cmml">h</mi><mi id="S5.E3.m1.3.3.3.1.1.1.1.1.1.3" xref="S5.E3.m1.3.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S5.E3.m1.4.4.4.2.2.2.2.2.4" xref="S5.E3.m1.4.4.4.2.2.2.2.3.cmml">,</mo><msubsup id="S5.E3.m1.4.4.4.2.2.2.2.2.2" xref="S5.E3.m1.4.4.4.2.2.2.2.2.2.cmml"><mi id="S5.E3.m1.4.4.4.2.2.2.2.2.2.2.2" xref="S5.E3.m1.4.4.4.2.2.2.2.2.2.2.2.cmml">h</mi><mi id="S5.E3.m1.4.4.4.2.2.2.2.2.2.2.3" xref="S5.E3.m1.4.4.4.2.2.2.2.2.2.2.3.cmml">j</mi><mo id="S5.E3.m1.4.4.4.2.2.2.2.2.2.3" xref="S5.E3.m1.4.4.4.2.2.2.2.2.2.3.cmml">+</mo></msubsup><mo id="S5.E3.m1.4.4.4.2.2.2.2.2.5" stretchy="false" xref="S5.E3.m1.4.4.4.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S5.E3.m1.4.4.4.2.2.3" xref="S5.E3.m1.4.4.4.2.2.3.cmml">/</mo><mi id="S5.E3.m1.4.4.4.2.2.4" xref="S5.E3.m1.4.4.4.2.2.4.cmml">τ</mi></mrow></msup><mo id="S5.E3.m1.7.7.7.5.1.1.1" xref="S5.E3.m1.7.7.7.5.1.1.1.cmml">+</mo><msup id="S5.E3.m1.7.7.7.5.1.1.3" xref="S5.E3.m1.7.7.7.5.1.1.3.cmml"><mi id="S5.E3.m1.7.7.7.5.1.1.3.2" xref="S5.E3.m1.7.7.7.5.1.1.3.2.cmml">e</mi><mrow id="S5.E3.m1.6.6.6.4.2" xref="S5.E3.m1.6.6.6.4.2.cmml"><mrow id="S5.E3.m1.6.6.6.4.2.2" xref="S5.E3.m1.6.6.6.4.2.2.cmml"><mtext id="S5.E3.m1.6.6.6.4.2.2.4" xref="S5.E3.m1.6.6.6.4.2.2.4a.cmml">sim</mtext><mo id="S5.E3.m1.6.6.6.4.2.2.3" xref="S5.E3.m1.6.6.6.4.2.2.3.cmml">⁢</mo><mrow id="S5.E3.m1.6.6.6.4.2.2.2.2" xref="S5.E3.m1.6.6.6.4.2.2.2.3.cmml"><mo id="S5.E3.m1.6.6.6.4.2.2.2.2.3" stretchy="false" xref="S5.E3.m1.6.6.6.4.2.2.2.3.cmml">(</mo><msub id="S5.E3.m1.5.5.5.3.1.1.1.1.1" xref="S5.E3.m1.5.5.5.3.1.1.1.1.1.cmml"><mi id="S5.E3.m1.5.5.5.3.1.1.1.1.1.2" xref="S5.E3.m1.5.5.5.3.1.1.1.1.1.2.cmml">h</mi><mi id="S5.E3.m1.5.5.5.3.1.1.1.1.1.3" xref="S5.E3.m1.5.5.5.3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S5.E3.m1.6.6.6.4.2.2.2.2.4" xref="S5.E3.m1.6.6.6.4.2.2.2.3.cmml">,</mo><msubsup id="S5.E3.m1.6.6.6.4.2.2.2.2.2" xref="S5.E3.m1.6.6.6.4.2.2.2.2.2.cmml"><mi id="S5.E3.m1.6.6.6.4.2.2.2.2.2.2.2" xref="S5.E3.m1.6.6.6.4.2.2.2.2.2.2.2.cmml">h</mi><mi id="S5.E3.m1.6.6.6.4.2.2.2.2.2.2.3" xref="S5.E3.m1.6.6.6.4.2.2.2.2.2.2.3.cmml">j</mi><mo id="S5.E3.m1.6.6.6.4.2.2.2.2.2.3" xref="S5.E3.m1.6.6.6.4.2.2.2.2.2.3.cmml">−</mo></msubsup><mo id="S5.E3.m1.6.6.6.4.2.2.2.2.5" stretchy="false" xref="S5.E3.m1.6.6.6.4.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S5.E3.m1.6.6.6.4.2.3" xref="S5.E3.m1.6.6.6.4.2.3.cmml">/</mo><mi id="S5.E3.m1.6.6.6.4.2.4" xref="S5.E3.m1.6.6.6.4.2.4.cmml">τ</mi></mrow></msup></mrow><mo id="S5.E3.m1.7.7.7.5.1.3" stretchy="false" xref="S5.E3.m1.7.7.7.5.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E3.m1.7b"><apply id="S5.E3.m1.7.8.cmml" xref="S5.E3.m1.7.8"><eq id="S5.E3.m1.7.8.1.cmml" xref="S5.E3.m1.7.8.1"></eq><apply id="S5.E3.m1.7.8.2.cmml" xref="S5.E3.m1.7.8.2"><csymbol cd="ambiguous" id="S5.E3.m1.7.8.2.1.cmml" xref="S5.E3.m1.7.8.2">subscript</csymbol><ci id="S5.E3.m1.7.8.2.2.cmml" xref="S5.E3.m1.7.8.2.2">𝑙</ci><ci id="S5.E3.m1.7.8.2.3.cmml" xref="S5.E3.m1.7.8.2.3">𝑖</ci></apply><apply id="S5.E3.m1.7.8.3.cmml" xref="S5.E3.m1.7.8.3"><minus id="S5.E3.m1.7.8.3.1.cmml" xref="S5.E3.m1.7.8.3"></minus><apply id="S5.E3.m1.7.8.3.2.cmml" xref="S5.E3.m1.7.8.3.2"><log id="S5.E3.m1.7.8.3.2.1.cmml" xref="S5.E3.m1.7.8.3.2.1"></log><apply id="S5.E3.m1.7.7.cmml" xref="S5.E3.m1.7.7"><divide id="S5.E3.m1.7.7.8.cmml" xref="S5.E3.m1.7.7"></divide><apply id="S5.E3.m1.2.2.2.cmml" xref="S5.E3.m1.2.2.2"><csymbol cd="ambiguous" id="S5.E3.m1.2.2.2.3.cmml" xref="S5.E3.m1.2.2.2">superscript</csymbol><ci id="S5.E3.m1.2.2.2.4.cmml" xref="S5.E3.m1.2.2.2.4">𝑒</ci><apply id="S5.E3.m1.2.2.2.2.2.cmml" xref="S5.E3.m1.2.2.2.2.2"><divide id="S5.E3.m1.2.2.2.2.2.3.cmml" xref="S5.E3.m1.2.2.2.2.2.3"></divide><apply id="S5.E3.m1.2.2.2.2.2.2.cmml" xref="S5.E3.m1.2.2.2.2.2.2"><times id="S5.E3.m1.2.2.2.2.2.2.3.cmml" xref="S5.E3.m1.2.2.2.2.2.2.3"></times><ci id="S5.E3.m1.2.2.2.2.2.2.4a.cmml" xref="S5.E3.m1.2.2.2.2.2.2.4"><mtext id="S5.E3.m1.2.2.2.2.2.2.4.cmml" mathsize="70%" xref="S5.E3.m1.2.2.2.2.2.2.4">sim</mtext></ci><interval closure="open" id="S5.E3.m1.2.2.2.2.2.2.2.3.cmml" xref="S5.E3.m1.2.2.2.2.2.2.2.2"><apply id="S5.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S5.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S5.E3.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S5.E3.m1.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.E3.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="S5.E3.m1.2.2.2.2.2.2.2.2.2">superscript</csymbol><apply id="S5.E3.m1.2.2.2.2.2.2.2.2.2.2.cmml" xref="S5.E3.m1.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.E3.m1.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S5.E3.m1.2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S5.E3.m1.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S5.E3.m1.2.2.2.2.2.2.2.2.2.2.2">ℎ</ci><ci id="S5.E3.m1.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="S5.E3.m1.2.2.2.2.2.2.2.2.2.2.3">𝑖</ci></apply><plus id="S5.E3.m1.2.2.2.2.2.2.2.2.2.3.cmml" xref="S5.E3.m1.2.2.2.2.2.2.2.2.2.3"></plus></apply></interval></apply><ci id="S5.E3.m1.2.2.2.2.2.4.cmml" xref="S5.E3.m1.2.2.2.2.2.4">𝜏</ci></apply></apply><apply id="S5.E3.m1.7.7.7.cmml" xref="S5.E3.m1.7.7.7"><times id="S5.E3.m1.7.7.7.6.cmml" xref="S5.E3.m1.7.7.7.6"></times><apply id="S5.E3.m1.7.7.7.7.cmml" xref="S5.E3.m1.7.7.7.7"><csymbol cd="ambiguous" id="S5.E3.m1.7.7.7.7.1.cmml" xref="S5.E3.m1.7.7.7.7">superscript</csymbol><apply id="S5.E3.m1.7.7.7.7.2.cmml" xref="S5.E3.m1.7.7.7.7"><csymbol cd="ambiguous" id="S5.E3.m1.7.7.7.7.2.1.cmml" xref="S5.E3.m1.7.7.7.7">subscript</csymbol><ci id="S5.E3.m1.7.7.7.7.2.2.cmml" xref="S5.E3.m1.7.7.7.7.2.2">Σ</ci><apply id="S5.E3.m1.7.7.7.7.2.3.cmml" xref="S5.E3.m1.7.7.7.7.2.3"><eq id="S5.E3.m1.7.7.7.7.2.3.1.cmml" xref="S5.E3.m1.7.7.7.7.2.3.1"></eq><ci id="S5.E3.m1.7.7.7.7.2.3.2.cmml" xref="S5.E3.m1.7.7.7.7.2.3.2">𝑗</ci><cn id="S5.E3.m1.7.7.7.7.2.3.3.cmml" type="integer" xref="S5.E3.m1.7.7.7.7.2.3.3">1</cn></apply></apply><ci id="S5.E3.m1.7.7.7.7.3.cmml" xref="S5.E3.m1.7.7.7.7.3">𝑁</ci></apply><apply id="S5.E3.m1.7.7.7.5.1.1.cmml" xref="S5.E3.m1.7.7.7.5.1"><plus id="S5.E3.m1.7.7.7.5.1.1.1.cmml" xref="S5.E3.m1.7.7.7.5.1.1.1"></plus><apply id="S5.E3.m1.7.7.7.5.1.1.2.cmml" xref="S5.E3.m1.7.7.7.5.1.1.2"><csymbol cd="ambiguous" id="S5.E3.m1.7.7.7.5.1.1.2.1.cmml" xref="S5.E3.m1.7.7.7.5.1.1.2">superscript</csymbol><ci id="S5.E3.m1.7.7.7.5.1.1.2.2.cmml" xref="S5.E3.m1.7.7.7.5.1.1.2.2">𝑒</ci><apply id="S5.E3.m1.4.4.4.2.2.cmml" xref="S5.E3.m1.4.4.4.2.2"><divide id="S5.E3.m1.4.4.4.2.2.3.cmml" xref="S5.E3.m1.4.4.4.2.2.3"></divide><apply id="S5.E3.m1.4.4.4.2.2.2.cmml" xref="S5.E3.m1.4.4.4.2.2.2"><times id="S5.E3.m1.4.4.4.2.2.2.3.cmml" xref="S5.E3.m1.4.4.4.2.2.2.3"></times><ci id="S5.E3.m1.4.4.4.2.2.2.4a.cmml" xref="S5.E3.m1.4.4.4.2.2.2.4"><mtext id="S5.E3.m1.4.4.4.2.2.2.4.cmml" mathsize="70%" xref="S5.E3.m1.4.4.4.2.2.2.4">sim</mtext></ci><interval closure="open" id="S5.E3.m1.4.4.4.2.2.2.2.3.cmml" xref="S5.E3.m1.4.4.4.2.2.2.2.2"><apply id="S5.E3.m1.3.3.3.1.1.1.1.1.1.cmml" xref="S5.E3.m1.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E3.m1.3.3.3.1.1.1.1.1.1.1.cmml" xref="S5.E3.m1.3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S5.E3.m1.3.3.3.1.1.1.1.1.1.2.cmml" xref="S5.E3.m1.3.3.3.1.1.1.1.1.1.2">ℎ</ci><ci id="S5.E3.m1.3.3.3.1.1.1.1.1.1.3.cmml" xref="S5.E3.m1.3.3.3.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S5.E3.m1.4.4.4.2.2.2.2.2.2.cmml" xref="S5.E3.m1.4.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.E3.m1.4.4.4.2.2.2.2.2.2.1.cmml" xref="S5.E3.m1.4.4.4.2.2.2.2.2.2">superscript</csymbol><apply id="S5.E3.m1.4.4.4.2.2.2.2.2.2.2.cmml" xref="S5.E3.m1.4.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.E3.m1.4.4.4.2.2.2.2.2.2.2.1.cmml" xref="S5.E3.m1.4.4.4.2.2.2.2.2.2">subscript</csymbol><ci id="S5.E3.m1.4.4.4.2.2.2.2.2.2.2.2.cmml" xref="S5.E3.m1.4.4.4.2.2.2.2.2.2.2.2">ℎ</ci><ci id="S5.E3.m1.4.4.4.2.2.2.2.2.2.2.3.cmml" xref="S5.E3.m1.4.4.4.2.2.2.2.2.2.2.3">𝑗</ci></apply><plus id="S5.E3.m1.4.4.4.2.2.2.2.2.2.3.cmml" xref="S5.E3.m1.4.4.4.2.2.2.2.2.2.3"></plus></apply></interval></apply><ci id="S5.E3.m1.4.4.4.2.2.4.cmml" xref="S5.E3.m1.4.4.4.2.2.4">𝜏</ci></apply></apply><apply id="S5.E3.m1.7.7.7.5.1.1.3.cmml" xref="S5.E3.m1.7.7.7.5.1.1.3"><csymbol cd="ambiguous" id="S5.E3.m1.7.7.7.5.1.1.3.1.cmml" xref="S5.E3.m1.7.7.7.5.1.1.3">superscript</csymbol><ci id="S5.E3.m1.7.7.7.5.1.1.3.2.cmml" xref="S5.E3.m1.7.7.7.5.1.1.3.2">𝑒</ci><apply id="S5.E3.m1.6.6.6.4.2.cmml" xref="S5.E3.m1.6.6.6.4.2"><divide id="S5.E3.m1.6.6.6.4.2.3.cmml" xref="S5.E3.m1.6.6.6.4.2.3"></divide><apply id="S5.E3.m1.6.6.6.4.2.2.cmml" xref="S5.E3.m1.6.6.6.4.2.2"><times id="S5.E3.m1.6.6.6.4.2.2.3.cmml" xref="S5.E3.m1.6.6.6.4.2.2.3"></times><ci id="S5.E3.m1.6.6.6.4.2.2.4a.cmml" xref="S5.E3.m1.6.6.6.4.2.2.4"><mtext id="S5.E3.m1.6.6.6.4.2.2.4.cmml" mathsize="70%" xref="S5.E3.m1.6.6.6.4.2.2.4">sim</mtext></ci><interval closure="open" id="S5.E3.m1.6.6.6.4.2.2.2.3.cmml" xref="S5.E3.m1.6.6.6.4.2.2.2.2"><apply id="S5.E3.m1.5.5.5.3.1.1.1.1.1.cmml" xref="S5.E3.m1.5.5.5.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E3.m1.5.5.5.3.1.1.1.1.1.1.cmml" xref="S5.E3.m1.5.5.5.3.1.1.1.1.1">subscript</csymbol><ci id="S5.E3.m1.5.5.5.3.1.1.1.1.1.2.cmml" xref="S5.E3.m1.5.5.5.3.1.1.1.1.1.2">ℎ</ci><ci id="S5.E3.m1.5.5.5.3.1.1.1.1.1.3.cmml" xref="S5.E3.m1.5.5.5.3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S5.E3.m1.6.6.6.4.2.2.2.2.2.cmml" xref="S5.E3.m1.6.6.6.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.E3.m1.6.6.6.4.2.2.2.2.2.1.cmml" xref="S5.E3.m1.6.6.6.4.2.2.2.2.2">superscript</csymbol><apply id="S5.E3.m1.6.6.6.4.2.2.2.2.2.2.cmml" xref="S5.E3.m1.6.6.6.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.E3.m1.6.6.6.4.2.2.2.2.2.2.1.cmml" xref="S5.E3.m1.6.6.6.4.2.2.2.2.2">subscript</csymbol><ci id="S5.E3.m1.6.6.6.4.2.2.2.2.2.2.2.cmml" xref="S5.E3.m1.6.6.6.4.2.2.2.2.2.2.2">ℎ</ci><ci id="S5.E3.m1.6.6.6.4.2.2.2.2.2.2.3.cmml" xref="S5.E3.m1.6.6.6.4.2.2.2.2.2.2.3">𝑗</ci></apply><minus id="S5.E3.m1.6.6.6.4.2.2.2.2.2.3.cmml" xref="S5.E3.m1.6.6.6.4.2.2.2.2.2.3"></minus></apply></interval></apply><ci id="S5.E3.m1.6.6.6.4.2.4.cmml" xref="S5.E3.m1.6.6.6.4.2.4">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E3.m1.7c">l_{i}=-\log\frac{e^{\textnormal{sim}(h_{i},h_{i}^{+})/\tau}}{\Sigma_{j=1}^{N}(%
e^{\textnormal{sim}(h_{i},h_{j}^{+})/\tau}+e^{\textnormal{sim}(h_{i},h_{j}^{-}%
)/\tau})}</annotation><annotation encoding="application/x-llamapun" id="S5.E3.m1.7d">italic_l start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = - roman_log divide start_ARG italic_e start_POSTSUPERSCRIPT sim ( italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) / italic_τ end_POSTSUPERSCRIPT end_ARG start_ARG roman_Σ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ( italic_e start_POSTSUPERSCRIPT sim ( italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) / italic_τ end_POSTSUPERSCRIPT + italic_e start_POSTSUPERSCRIPT sim ( italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ) / italic_τ end_POSTSUPERSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS1.p5.15">where <math alttext="\tau" class="ltx_Math" display="inline" id="S5.SS1.p5.7.m1.1"><semantics id="S5.SS1.p5.7.m1.1a"><mi id="S5.SS1.p5.7.m1.1.1" xref="S5.SS1.p5.7.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.7.m1.1b"><ci id="S5.SS1.p5.7.m1.1.1.cmml" xref="S5.SS1.p5.7.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.7.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p5.7.m1.1d">italic_τ</annotation></semantics></math> is a temperature hyper-parameter, <math alttext="h_{i}" class="ltx_Math" display="inline" id="S5.SS1.p5.8.m2.1"><semantics id="S5.SS1.p5.8.m2.1a"><msub id="S5.SS1.p5.8.m2.1.1" xref="S5.SS1.p5.8.m2.1.1.cmml"><mi id="S5.SS1.p5.8.m2.1.1.2" xref="S5.SS1.p5.8.m2.1.1.2.cmml">h</mi><mi id="S5.SS1.p5.8.m2.1.1.3" xref="S5.SS1.p5.8.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.8.m2.1b"><apply id="S5.SS1.p5.8.m2.1.1.cmml" xref="S5.SS1.p5.8.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.8.m2.1.1.1.cmml" xref="S5.SS1.p5.8.m2.1.1">subscript</csymbol><ci id="S5.SS1.p5.8.m2.1.1.2.cmml" xref="S5.SS1.p5.8.m2.1.1.2">ℎ</ci><ci id="S5.SS1.p5.8.m2.1.1.3.cmml" xref="S5.SS1.p5.8.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.8.m2.1c">h_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p5.8.m2.1d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="h_{i}^{+}" class="ltx_Math" display="inline" id="S5.SS1.p5.9.m3.1"><semantics id="S5.SS1.p5.9.m3.1a"><msubsup id="S5.SS1.p5.9.m3.1.1" xref="S5.SS1.p5.9.m3.1.1.cmml"><mi id="S5.SS1.p5.9.m3.1.1.2.2" xref="S5.SS1.p5.9.m3.1.1.2.2.cmml">h</mi><mi id="S5.SS1.p5.9.m3.1.1.2.3" xref="S5.SS1.p5.9.m3.1.1.2.3.cmml">i</mi><mo id="S5.SS1.p5.9.m3.1.1.3" xref="S5.SS1.p5.9.m3.1.1.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.9.m3.1b"><apply id="S5.SS1.p5.9.m3.1.1.cmml" xref="S5.SS1.p5.9.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.9.m3.1.1.1.cmml" xref="S5.SS1.p5.9.m3.1.1">superscript</csymbol><apply id="S5.SS1.p5.9.m3.1.1.2.cmml" xref="S5.SS1.p5.9.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.9.m3.1.1.2.1.cmml" xref="S5.SS1.p5.9.m3.1.1">subscript</csymbol><ci id="S5.SS1.p5.9.m3.1.1.2.2.cmml" xref="S5.SS1.p5.9.m3.1.1.2.2">ℎ</ci><ci id="S5.SS1.p5.9.m3.1.1.2.3.cmml" xref="S5.SS1.p5.9.m3.1.1.2.3">𝑖</ci></apply><plus id="S5.SS1.p5.9.m3.1.1.3.cmml" xref="S5.SS1.p5.9.m3.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.9.m3.1c">h_{i}^{+}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p5.9.m3.1d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="h_{i}^{-}" class="ltx_Math" display="inline" id="S5.SS1.p5.10.m4.1"><semantics id="S5.SS1.p5.10.m4.1a"><msubsup id="S5.SS1.p5.10.m4.1.1" xref="S5.SS1.p5.10.m4.1.1.cmml"><mi id="S5.SS1.p5.10.m4.1.1.2.2" xref="S5.SS1.p5.10.m4.1.1.2.2.cmml">h</mi><mi id="S5.SS1.p5.10.m4.1.1.2.3" xref="S5.SS1.p5.10.m4.1.1.2.3.cmml">i</mi><mo id="S5.SS1.p5.10.m4.1.1.3" xref="S5.SS1.p5.10.m4.1.1.3.cmml">−</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.10.m4.1b"><apply id="S5.SS1.p5.10.m4.1.1.cmml" xref="S5.SS1.p5.10.m4.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.10.m4.1.1.1.cmml" xref="S5.SS1.p5.10.m4.1.1">superscript</csymbol><apply id="S5.SS1.p5.10.m4.1.1.2.cmml" xref="S5.SS1.p5.10.m4.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.10.m4.1.1.2.1.cmml" xref="S5.SS1.p5.10.m4.1.1">subscript</csymbol><ci id="S5.SS1.p5.10.m4.1.1.2.2.cmml" xref="S5.SS1.p5.10.m4.1.1.2.2">ℎ</ci><ci id="S5.SS1.p5.10.m4.1.1.2.3.cmml" xref="S5.SS1.p5.10.m4.1.1.2.3">𝑖</ci></apply><minus id="S5.SS1.p5.10.m4.1.1.3.cmml" xref="S5.SS1.p5.10.m4.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.10.m4.1c">h_{i}^{-}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p5.10.m4.1d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math> stand for the representation of <math alttext="Q_{i}" class="ltx_Math" display="inline" id="S5.SS1.p5.11.m5.1"><semantics id="S5.SS1.p5.11.m5.1a"><msub id="S5.SS1.p5.11.m5.1.1" xref="S5.SS1.p5.11.m5.1.1.cmml"><mi id="S5.SS1.p5.11.m5.1.1.2" xref="S5.SS1.p5.11.m5.1.1.2.cmml">Q</mi><mi id="S5.SS1.p5.11.m5.1.1.3" xref="S5.SS1.p5.11.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.11.m5.1b"><apply id="S5.SS1.p5.11.m5.1.1.cmml" xref="S5.SS1.p5.11.m5.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.11.m5.1.1.1.cmml" xref="S5.SS1.p5.11.m5.1.1">subscript</csymbol><ci id="S5.SS1.p5.11.m5.1.1.2.cmml" xref="S5.SS1.p5.11.m5.1.1.2">𝑄</ci><ci id="S5.SS1.p5.11.m5.1.1.3.cmml" xref="S5.SS1.p5.11.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.11.m5.1c">Q_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p5.11.m5.1d">italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="Q_{i}^{+}" class="ltx_Math" display="inline" id="S5.SS1.p5.12.m6.1"><semantics id="S5.SS1.p5.12.m6.1a"><msubsup id="S5.SS1.p5.12.m6.1.1" xref="S5.SS1.p5.12.m6.1.1.cmml"><mi id="S5.SS1.p5.12.m6.1.1.2.2" xref="S5.SS1.p5.12.m6.1.1.2.2.cmml">Q</mi><mi id="S5.SS1.p5.12.m6.1.1.2.3" xref="S5.SS1.p5.12.m6.1.1.2.3.cmml">i</mi><mo id="S5.SS1.p5.12.m6.1.1.3" xref="S5.SS1.p5.12.m6.1.1.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.12.m6.1b"><apply id="S5.SS1.p5.12.m6.1.1.cmml" xref="S5.SS1.p5.12.m6.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.12.m6.1.1.1.cmml" xref="S5.SS1.p5.12.m6.1.1">superscript</csymbol><apply id="S5.SS1.p5.12.m6.1.1.2.cmml" xref="S5.SS1.p5.12.m6.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.12.m6.1.1.2.1.cmml" xref="S5.SS1.p5.12.m6.1.1">subscript</csymbol><ci id="S5.SS1.p5.12.m6.1.1.2.2.cmml" xref="S5.SS1.p5.12.m6.1.1.2.2">𝑄</ci><ci id="S5.SS1.p5.12.m6.1.1.2.3.cmml" xref="S5.SS1.p5.12.m6.1.1.2.3">𝑖</ci></apply><plus id="S5.SS1.p5.12.m6.1.1.3.cmml" xref="S5.SS1.p5.12.m6.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.12.m6.1c">Q_{i}^{+}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p5.12.m6.1d">italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="Q_{i}^{-}" class="ltx_Math" display="inline" id="S5.SS1.p5.13.m7.1"><semantics id="S5.SS1.p5.13.m7.1a"><msubsup id="S5.SS1.p5.13.m7.1.1" xref="S5.SS1.p5.13.m7.1.1.cmml"><mi id="S5.SS1.p5.13.m7.1.1.2.2" xref="S5.SS1.p5.13.m7.1.1.2.2.cmml">Q</mi><mi id="S5.SS1.p5.13.m7.1.1.2.3" xref="S5.SS1.p5.13.m7.1.1.2.3.cmml">i</mi><mo id="S5.SS1.p5.13.m7.1.1.3" xref="S5.SS1.p5.13.m7.1.1.3.cmml">−</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.13.m7.1b"><apply id="S5.SS1.p5.13.m7.1.1.cmml" xref="S5.SS1.p5.13.m7.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.13.m7.1.1.1.cmml" xref="S5.SS1.p5.13.m7.1.1">superscript</csymbol><apply id="S5.SS1.p5.13.m7.1.1.2.cmml" xref="S5.SS1.p5.13.m7.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.13.m7.1.1.2.1.cmml" xref="S5.SS1.p5.13.m7.1.1">subscript</csymbol><ci id="S5.SS1.p5.13.m7.1.1.2.2.cmml" xref="S5.SS1.p5.13.m7.1.1.2.2">𝑄</ci><ci id="S5.SS1.p5.13.m7.1.1.2.3.cmml" xref="S5.SS1.p5.13.m7.1.1.2.3">𝑖</ci></apply><minus id="S5.SS1.p5.13.m7.1.1.3.cmml" xref="S5.SS1.p5.13.m7.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.13.m7.1c">Q_{i}^{-}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p5.13.m7.1d">italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math> respectively, and the function
<math alttext="\textnormal{sim}(h_{1},h_{2})" class="ltx_Math" display="inline" id="S5.SS1.p5.14.m8.2"><semantics id="S5.SS1.p5.14.m8.2a"><mrow id="S5.SS1.p5.14.m8.2.2" xref="S5.SS1.p5.14.m8.2.2.cmml"><mtext id="S5.SS1.p5.14.m8.2.2.4" xref="S5.SS1.p5.14.m8.2.2.4a.cmml">sim</mtext><mo id="S5.SS1.p5.14.m8.2.2.3" xref="S5.SS1.p5.14.m8.2.2.3.cmml">⁢</mo><mrow id="S5.SS1.p5.14.m8.2.2.2.2" xref="S5.SS1.p5.14.m8.2.2.2.3.cmml"><mo id="S5.SS1.p5.14.m8.2.2.2.2.3" stretchy="false" xref="S5.SS1.p5.14.m8.2.2.2.3.cmml">(</mo><msub id="S5.SS1.p5.14.m8.1.1.1.1.1" xref="S5.SS1.p5.14.m8.1.1.1.1.1.cmml"><mi id="S5.SS1.p5.14.m8.1.1.1.1.1.2" xref="S5.SS1.p5.14.m8.1.1.1.1.1.2.cmml">h</mi><mn id="S5.SS1.p5.14.m8.1.1.1.1.1.3" xref="S5.SS1.p5.14.m8.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S5.SS1.p5.14.m8.2.2.2.2.4" xref="S5.SS1.p5.14.m8.2.2.2.3.cmml">,</mo><msub id="S5.SS1.p5.14.m8.2.2.2.2.2" xref="S5.SS1.p5.14.m8.2.2.2.2.2.cmml"><mi id="S5.SS1.p5.14.m8.2.2.2.2.2.2" xref="S5.SS1.p5.14.m8.2.2.2.2.2.2.cmml">h</mi><mn id="S5.SS1.p5.14.m8.2.2.2.2.2.3" xref="S5.SS1.p5.14.m8.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S5.SS1.p5.14.m8.2.2.2.2.5" stretchy="false" xref="S5.SS1.p5.14.m8.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.14.m8.2b"><apply id="S5.SS1.p5.14.m8.2.2.cmml" xref="S5.SS1.p5.14.m8.2.2"><times id="S5.SS1.p5.14.m8.2.2.3.cmml" xref="S5.SS1.p5.14.m8.2.2.3"></times><ci id="S5.SS1.p5.14.m8.2.2.4a.cmml" xref="S5.SS1.p5.14.m8.2.2.4"><mtext id="S5.SS1.p5.14.m8.2.2.4.cmml" xref="S5.SS1.p5.14.m8.2.2.4">sim</mtext></ci><interval closure="open" id="S5.SS1.p5.14.m8.2.2.2.3.cmml" xref="S5.SS1.p5.14.m8.2.2.2.2"><apply id="S5.SS1.p5.14.m8.1.1.1.1.1.cmml" xref="S5.SS1.p5.14.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.14.m8.1.1.1.1.1.1.cmml" xref="S5.SS1.p5.14.m8.1.1.1.1.1">subscript</csymbol><ci id="S5.SS1.p5.14.m8.1.1.1.1.1.2.cmml" xref="S5.SS1.p5.14.m8.1.1.1.1.1.2">ℎ</ci><cn id="S5.SS1.p5.14.m8.1.1.1.1.1.3.cmml" type="integer" xref="S5.SS1.p5.14.m8.1.1.1.1.1.3">1</cn></apply><apply id="S5.SS1.p5.14.m8.2.2.2.2.2.cmml" xref="S5.SS1.p5.14.m8.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS1.p5.14.m8.2.2.2.2.2.1.cmml" xref="S5.SS1.p5.14.m8.2.2.2.2.2">subscript</csymbol><ci id="S5.SS1.p5.14.m8.2.2.2.2.2.2.cmml" xref="S5.SS1.p5.14.m8.2.2.2.2.2.2">ℎ</ci><cn id="S5.SS1.p5.14.m8.2.2.2.2.2.3.cmml" type="integer" xref="S5.SS1.p5.14.m8.2.2.2.2.2.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.14.m8.2c">\textnormal{sim}(h_{1},h_{2})</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p5.14.m8.2d">sim ( italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math> is the cosine similarity <math alttext="\frac{h_{1}^{T}h_{2}}{\|h_{1}\|\cdot\|h_{2}\|}" class="ltx_Math" display="inline" id="S5.SS1.p5.15.m9.2"><semantics id="S5.SS1.p5.15.m9.2a"><mfrac id="S5.SS1.p5.15.m9.2.2" xref="S5.SS1.p5.15.m9.2.2.cmml"><mrow id="S5.SS1.p5.15.m9.2.2.4" xref="S5.SS1.p5.15.m9.2.2.4.cmml"><msubsup id="S5.SS1.p5.15.m9.2.2.4.2" xref="S5.SS1.p5.15.m9.2.2.4.2.cmml"><mi id="S5.SS1.p5.15.m9.2.2.4.2.2.2" xref="S5.SS1.p5.15.m9.2.2.4.2.2.2.cmml">h</mi><mn id="S5.SS1.p5.15.m9.2.2.4.2.2.3" xref="S5.SS1.p5.15.m9.2.2.4.2.2.3.cmml">1</mn><mi id="S5.SS1.p5.15.m9.2.2.4.2.3" xref="S5.SS1.p5.15.m9.2.2.4.2.3.cmml">T</mi></msubsup><mo id="S5.SS1.p5.15.m9.2.2.4.1" xref="S5.SS1.p5.15.m9.2.2.4.1.cmml">⁢</mo><msub id="S5.SS1.p5.15.m9.2.2.4.3" xref="S5.SS1.p5.15.m9.2.2.4.3.cmml"><mi id="S5.SS1.p5.15.m9.2.2.4.3.2" xref="S5.SS1.p5.15.m9.2.2.4.3.2.cmml">h</mi><mn id="S5.SS1.p5.15.m9.2.2.4.3.3" xref="S5.SS1.p5.15.m9.2.2.4.3.3.cmml">2</mn></msub></mrow><mrow id="S5.SS1.p5.15.m9.2.2.2" xref="S5.SS1.p5.15.m9.2.2.2.cmml"><mrow id="S5.SS1.p5.15.m9.1.1.1.1.1" xref="S5.SS1.p5.15.m9.1.1.1.1.2.cmml"><mo id="S5.SS1.p5.15.m9.1.1.1.1.1.2" stretchy="false" xref="S5.SS1.p5.15.m9.1.1.1.1.2.1.cmml">‖</mo><msub id="S5.SS1.p5.15.m9.1.1.1.1.1.1" xref="S5.SS1.p5.15.m9.1.1.1.1.1.1.cmml"><mi id="S5.SS1.p5.15.m9.1.1.1.1.1.1.2" xref="S5.SS1.p5.15.m9.1.1.1.1.1.1.2.cmml">h</mi><mn id="S5.SS1.p5.15.m9.1.1.1.1.1.1.3" xref="S5.SS1.p5.15.m9.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S5.SS1.p5.15.m9.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S5.SS1.p5.15.m9.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S5.SS1.p5.15.m9.2.2.2.3" rspace="0.222em" xref="S5.SS1.p5.15.m9.2.2.2.3.cmml">⋅</mo><mrow id="S5.SS1.p5.15.m9.2.2.2.2.1" xref="S5.SS1.p5.15.m9.2.2.2.2.2.cmml"><mo id="S5.SS1.p5.15.m9.2.2.2.2.1.2" stretchy="false" xref="S5.SS1.p5.15.m9.2.2.2.2.2.1.cmml">‖</mo><msub id="S5.SS1.p5.15.m9.2.2.2.2.1.1" xref="S5.SS1.p5.15.m9.2.2.2.2.1.1.cmml"><mi id="S5.SS1.p5.15.m9.2.2.2.2.1.1.2" xref="S5.SS1.p5.15.m9.2.2.2.2.1.1.2.cmml">h</mi><mn id="S5.SS1.p5.15.m9.2.2.2.2.1.1.3" xref="S5.SS1.p5.15.m9.2.2.2.2.1.1.3.cmml">2</mn></msub><mo id="S5.SS1.p5.15.m9.2.2.2.2.1.3" stretchy="false" xref="S5.SS1.p5.15.m9.2.2.2.2.2.1.cmml">‖</mo></mrow></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.15.m9.2b"><apply id="S5.SS1.p5.15.m9.2.2.cmml" xref="S5.SS1.p5.15.m9.2.2"><divide id="S5.SS1.p5.15.m9.2.2.3.cmml" xref="S5.SS1.p5.15.m9.2.2"></divide><apply id="S5.SS1.p5.15.m9.2.2.4.cmml" xref="S5.SS1.p5.15.m9.2.2.4"><times id="S5.SS1.p5.15.m9.2.2.4.1.cmml" xref="S5.SS1.p5.15.m9.2.2.4.1"></times><apply id="S5.SS1.p5.15.m9.2.2.4.2.cmml" xref="S5.SS1.p5.15.m9.2.2.4.2"><csymbol cd="ambiguous" id="S5.SS1.p5.15.m9.2.2.4.2.1.cmml" xref="S5.SS1.p5.15.m9.2.2.4.2">superscript</csymbol><apply id="S5.SS1.p5.15.m9.2.2.4.2.2.cmml" xref="S5.SS1.p5.15.m9.2.2.4.2"><csymbol cd="ambiguous" id="S5.SS1.p5.15.m9.2.2.4.2.2.1.cmml" xref="S5.SS1.p5.15.m9.2.2.4.2">subscript</csymbol><ci id="S5.SS1.p5.15.m9.2.2.4.2.2.2.cmml" xref="S5.SS1.p5.15.m9.2.2.4.2.2.2">ℎ</ci><cn id="S5.SS1.p5.15.m9.2.2.4.2.2.3.cmml" type="integer" xref="S5.SS1.p5.15.m9.2.2.4.2.2.3">1</cn></apply><ci id="S5.SS1.p5.15.m9.2.2.4.2.3.cmml" xref="S5.SS1.p5.15.m9.2.2.4.2.3">𝑇</ci></apply><apply id="S5.SS1.p5.15.m9.2.2.4.3.cmml" xref="S5.SS1.p5.15.m9.2.2.4.3"><csymbol cd="ambiguous" id="S5.SS1.p5.15.m9.2.2.4.3.1.cmml" xref="S5.SS1.p5.15.m9.2.2.4.3">subscript</csymbol><ci id="S5.SS1.p5.15.m9.2.2.4.3.2.cmml" xref="S5.SS1.p5.15.m9.2.2.4.3.2">ℎ</ci><cn id="S5.SS1.p5.15.m9.2.2.4.3.3.cmml" type="integer" xref="S5.SS1.p5.15.m9.2.2.4.3.3">2</cn></apply></apply><apply id="S5.SS1.p5.15.m9.2.2.2.cmml" xref="S5.SS1.p5.15.m9.2.2.2"><ci id="S5.SS1.p5.15.m9.2.2.2.3.cmml" xref="S5.SS1.p5.15.m9.2.2.2.3">⋅</ci><apply id="S5.SS1.p5.15.m9.1.1.1.1.2.cmml" xref="S5.SS1.p5.15.m9.1.1.1.1.1"><csymbol cd="latexml" id="S5.SS1.p5.15.m9.1.1.1.1.2.1.cmml" xref="S5.SS1.p5.15.m9.1.1.1.1.1.2">norm</csymbol><apply id="S5.SS1.p5.15.m9.1.1.1.1.1.1.cmml" xref="S5.SS1.p5.15.m9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.15.m9.1.1.1.1.1.1.1.cmml" xref="S5.SS1.p5.15.m9.1.1.1.1.1.1">subscript</csymbol><ci id="S5.SS1.p5.15.m9.1.1.1.1.1.1.2.cmml" xref="S5.SS1.p5.15.m9.1.1.1.1.1.1.2">ℎ</ci><cn id="S5.SS1.p5.15.m9.1.1.1.1.1.1.3.cmml" type="integer" xref="S5.SS1.p5.15.m9.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S5.SS1.p5.15.m9.2.2.2.2.2.cmml" xref="S5.SS1.p5.15.m9.2.2.2.2.1"><csymbol cd="latexml" id="S5.SS1.p5.15.m9.2.2.2.2.2.1.cmml" xref="S5.SS1.p5.15.m9.2.2.2.2.1.2">norm</csymbol><apply id="S5.SS1.p5.15.m9.2.2.2.2.1.1.cmml" xref="S5.SS1.p5.15.m9.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.15.m9.2.2.2.2.1.1.1.cmml" xref="S5.SS1.p5.15.m9.2.2.2.2.1.1">subscript</csymbol><ci id="S5.SS1.p5.15.m9.2.2.2.2.1.1.2.cmml" xref="S5.SS1.p5.15.m9.2.2.2.2.1.1.2">ℎ</ci><cn id="S5.SS1.p5.15.m9.2.2.2.2.1.1.3.cmml" type="integer" xref="S5.SS1.p5.15.m9.2.2.2.2.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.15.m9.2c">\frac{h_{1}^{T}h_{2}}{\|h_{1}\|\cdot\|h_{2}\|}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p5.15.m9.2d">divide start_ARG italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG ∥ italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∥ ⋅ ∥ italic_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∥ end_ARG</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S5.SS1.p6">
<p class="ltx_p" id="S5.SS1.p6.5">As an example in a training batch of size 2, for the first original query <math alttext="Q_{1}" class="ltx_Math" display="inline" id="S5.SS1.p6.1.m1.1"><semantics id="S5.SS1.p6.1.m1.1a"><msub id="S5.SS1.p6.1.m1.1.1" xref="S5.SS1.p6.1.m1.1.1.cmml"><mi id="S5.SS1.p6.1.m1.1.1.2" xref="S5.SS1.p6.1.m1.1.1.2.cmml">Q</mi><mn id="S5.SS1.p6.1.m1.1.1.3" xref="S5.SS1.p6.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p6.1.m1.1b"><apply id="S5.SS1.p6.1.m1.1.1.cmml" xref="S5.SS1.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p6.1.m1.1.1.1.cmml" xref="S5.SS1.p6.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.p6.1.m1.1.1.2.cmml" xref="S5.SS1.p6.1.m1.1.1.2">𝑄</ci><cn id="S5.SS1.p6.1.m1.1.1.3.cmml" type="integer" xref="S5.SS1.p6.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p6.1.m1.1c">Q_{1}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p6.1.m1.1d">italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> shown in the bottom part of Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S4.F6" title="Figure 6 ‣ 4.2. Pool Generator ‣ 4. Demonstration Preparation ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">6</span></a>, the positive query will be its corresponding improve query <math alttext="Q_{1}^{+}" class="ltx_Math" display="inline" id="S5.SS1.p6.2.m2.1"><semantics id="S5.SS1.p6.2.m2.1a"><msubsup id="S5.SS1.p6.2.m2.1.1" xref="S5.SS1.p6.2.m2.1.1.cmml"><mi id="S5.SS1.p6.2.m2.1.1.2.2" xref="S5.SS1.p6.2.m2.1.1.2.2.cmml">Q</mi><mn id="S5.SS1.p6.2.m2.1.1.2.3" xref="S5.SS1.p6.2.m2.1.1.2.3.cmml">1</mn><mo id="S5.SS1.p6.2.m2.1.1.3" xref="S5.SS1.p6.2.m2.1.1.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p6.2.m2.1b"><apply id="S5.SS1.p6.2.m2.1.1.cmml" xref="S5.SS1.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p6.2.m2.1.1.1.cmml" xref="S5.SS1.p6.2.m2.1.1">superscript</csymbol><apply id="S5.SS1.p6.2.m2.1.1.2.cmml" xref="S5.SS1.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p6.2.m2.1.1.2.1.cmml" xref="S5.SS1.p6.2.m2.1.1">subscript</csymbol><ci id="S5.SS1.p6.2.m2.1.1.2.2.cmml" xref="S5.SS1.p6.2.m2.1.1.2.2">𝑄</ci><cn id="S5.SS1.p6.2.m2.1.1.2.3.cmml" type="integer" xref="S5.SS1.p6.2.m2.1.1.2.3">1</cn></apply><plus id="S5.SS1.p6.2.m2.1.1.3.cmml" xref="S5.SS1.p6.2.m2.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p6.2.m2.1c">Q_{1}^{+}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p6.2.m2.1d">italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math>, and other in-batch improve or degrade queries <math alttext="Q_{1}^{-}" class="ltx_Math" display="inline" id="S5.SS1.p6.3.m3.1"><semantics id="S5.SS1.p6.3.m3.1a"><msubsup id="S5.SS1.p6.3.m3.1.1" xref="S5.SS1.p6.3.m3.1.1.cmml"><mi id="S5.SS1.p6.3.m3.1.1.2.2" xref="S5.SS1.p6.3.m3.1.1.2.2.cmml">Q</mi><mn id="S5.SS1.p6.3.m3.1.1.2.3" xref="S5.SS1.p6.3.m3.1.1.2.3.cmml">1</mn><mo id="S5.SS1.p6.3.m3.1.1.3" xref="S5.SS1.p6.3.m3.1.1.3.cmml">−</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p6.3.m3.1b"><apply id="S5.SS1.p6.3.m3.1.1.cmml" xref="S5.SS1.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p6.3.m3.1.1.1.cmml" xref="S5.SS1.p6.3.m3.1.1">superscript</csymbol><apply id="S5.SS1.p6.3.m3.1.1.2.cmml" xref="S5.SS1.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p6.3.m3.1.1.2.1.cmml" xref="S5.SS1.p6.3.m3.1.1">subscript</csymbol><ci id="S5.SS1.p6.3.m3.1.1.2.2.cmml" xref="S5.SS1.p6.3.m3.1.1.2.2">𝑄</ci><cn id="S5.SS1.p6.3.m3.1.1.2.3.cmml" type="integer" xref="S5.SS1.p6.3.m3.1.1.2.3">1</cn></apply><minus id="S5.SS1.p6.3.m3.1.1.3.cmml" xref="S5.SS1.p6.3.m3.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p6.3.m3.1c">Q_{1}^{-}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p6.3.m3.1d">italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="Q_{2}^{+}" class="ltx_Math" display="inline" id="S5.SS1.p6.4.m4.1"><semantics id="S5.SS1.p6.4.m4.1a"><msubsup id="S5.SS1.p6.4.m4.1.1" xref="S5.SS1.p6.4.m4.1.1.cmml"><mi id="S5.SS1.p6.4.m4.1.1.2.2" xref="S5.SS1.p6.4.m4.1.1.2.2.cmml">Q</mi><mn id="S5.SS1.p6.4.m4.1.1.2.3" xref="S5.SS1.p6.4.m4.1.1.2.3.cmml">2</mn><mo id="S5.SS1.p6.4.m4.1.1.3" xref="S5.SS1.p6.4.m4.1.1.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p6.4.m4.1b"><apply id="S5.SS1.p6.4.m4.1.1.cmml" xref="S5.SS1.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS1.p6.4.m4.1.1.1.cmml" xref="S5.SS1.p6.4.m4.1.1">superscript</csymbol><apply id="S5.SS1.p6.4.m4.1.1.2.cmml" xref="S5.SS1.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS1.p6.4.m4.1.1.2.1.cmml" xref="S5.SS1.p6.4.m4.1.1">subscript</csymbol><ci id="S5.SS1.p6.4.m4.1.1.2.2.cmml" xref="S5.SS1.p6.4.m4.1.1.2.2">𝑄</ci><cn id="S5.SS1.p6.4.m4.1.1.2.3.cmml" type="integer" xref="S5.SS1.p6.4.m4.1.1.2.3">2</cn></apply><plus id="S5.SS1.p6.4.m4.1.1.3.cmml" xref="S5.SS1.p6.4.m4.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p6.4.m4.1c">Q_{2}^{+}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p6.4.m4.1d">italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="Q_{2}^{-}" class="ltx_Math" display="inline" id="S5.SS1.p6.5.m5.1"><semantics id="S5.SS1.p6.5.m5.1a"><msubsup id="S5.SS1.p6.5.m5.1.1" xref="S5.SS1.p6.5.m5.1.1.cmml"><mi id="S5.SS1.p6.5.m5.1.1.2.2" xref="S5.SS1.p6.5.m5.1.1.2.2.cmml">Q</mi><mn id="S5.SS1.p6.5.m5.1.1.2.3" xref="S5.SS1.p6.5.m5.1.1.2.3.cmml">2</mn><mo id="S5.SS1.p6.5.m5.1.1.3" xref="S5.SS1.p6.5.m5.1.1.3.cmml">−</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p6.5.m5.1b"><apply id="S5.SS1.p6.5.m5.1.1.cmml" xref="S5.SS1.p6.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS1.p6.5.m5.1.1.1.cmml" xref="S5.SS1.p6.5.m5.1.1">superscript</csymbol><apply id="S5.SS1.p6.5.m5.1.1.2.cmml" xref="S5.SS1.p6.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS1.p6.5.m5.1.1.2.1.cmml" xref="S5.SS1.p6.5.m5.1.1">subscript</csymbol><ci id="S5.SS1.p6.5.m5.1.1.2.2.cmml" xref="S5.SS1.p6.5.m5.1.1.2.2">𝑄</ci><cn id="S5.SS1.p6.5.m5.1.1.2.3.cmml" type="integer" xref="S5.SS1.p6.5.m5.1.1.2.3">2</cn></apply><minus id="S5.SS1.p6.5.m5.1.1.3.cmml" xref="S5.SS1.p6.5.m5.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p6.5.m5.1c">Q_{2}^{-}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p6.5.m5.1d">italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math> are all regarded as negative queries. The final loss for the batch will be the sum of the losses for the two tuples.</p>
</div>
<figure class="ltx_figure" id="S5.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_missing ltx_missing_image" id="S5.F7.g1" src=""/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7. </span>The overall curriculum learning pipeline to train the contrastive selector using generated training triplets.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S5.F7.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S5.F7.2">the overall pipeline</p>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Curriculum Learning Pipeline</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p1.1.1">Motivation.</span> Although we have developed a representation-based demonstration selector, training the contrastive model presents several challenges. First, unlike the original SimCSE approach used in natural language inference tasks, which benefits from abundant data <cite class="ltx_cite ltx_citemacro_citep">(Cer et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib11" title="">2017</a>)</cite>, our model’s training is constrained by data scarcity. Our contrastive query tuples, derived from a limited variety of training triplets, face scalability issues due to the high computational cost of query execution. Furthermore, the complexity of query representations in our model surpasses the simplicity of word embeddings used in SimCSE. Given these constraints—limited data and a complex training target—we propose adopting a curriculum learning pipeline. This approach is designed to enhance the learning efficiency and effectiveness of our contrastive representation model.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Contrastive Training under Curriculum Scheduler</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span>Total training data <math alttext="S_{0}" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><msub id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">S</mi><mn id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝑆</ci><cn id="alg1.l1.m1.1.1.3.cmml" type="integer" xref="alg1.l1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">S_{0}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_S start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, Number of iterations <math alttext="I" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">I</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_I</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span>Initialized model <math alttext="E_{0}" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><msub id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">E</mi><mn id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝐸</ci><cn id="alg1.l2.m1.1.1.3.cmml" type="integer" xref="alg1.l2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">E_{0}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_E start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.2.1.1" style="font-size:80%;">3:</span></span><math alttext="N_{0}=len(S_{0})" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><msub id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"><mi id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.3.2.cmml">N</mi><mn id="alg1.l3.m1.1.1.3.3" xref="alg1.l3.m1.1.1.3.3.cmml">0</mn></msub><mo id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">=</mo><mrow id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml"><mi id="alg1.l3.m1.1.1.1.3" xref="alg1.l3.m1.1.1.1.3.cmml">l</mi><mo id="alg1.l3.m1.1.1.1.2" xref="alg1.l3.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.1.4" xref="alg1.l3.m1.1.1.1.4.cmml">e</mi><mo id="alg1.l3.m1.1.1.1.2a" xref="alg1.l3.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.1.5" xref="alg1.l3.m1.1.1.1.5.cmml">n</mi><mo id="alg1.l3.m1.1.1.1.2b" xref="alg1.l3.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l3.m1.1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l3.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l3.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l3.m1.1.1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l3.m1.1.1.1.1.1.1.2" xref="alg1.l3.m1.1.1.1.1.1.1.2.cmml">S</mi><mn id="alg1.l3.m1.1.1.1.1.1.1.3" xref="alg1.l3.m1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="alg1.l3.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><eq id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2"></eq><apply id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3">subscript</csymbol><ci id="alg1.l3.m1.1.1.3.2.cmml" xref="alg1.l3.m1.1.1.3.2">𝑁</ci><cn id="alg1.l3.m1.1.1.3.3.cmml" type="integer" xref="alg1.l3.m1.1.1.3.3">0</cn></apply><apply id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"><times id="alg1.l3.m1.1.1.1.2.cmml" xref="alg1.l3.m1.1.1.1.2"></times><ci id="alg1.l3.m1.1.1.1.3.cmml" xref="alg1.l3.m1.1.1.1.3">𝑙</ci><ci id="alg1.l3.m1.1.1.1.4.cmml" xref="alg1.l3.m1.1.1.1.4">𝑒</ci><ci id="alg1.l3.m1.1.1.1.5.cmml" xref="alg1.l3.m1.1.1.1.5">𝑛</ci><apply id="alg1.l3.m1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.2">𝑆</ci><cn id="alg1.l3.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l3.m1.1.1.1.1.1.1.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">N_{0}=len(S_{0})</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_N start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = italic_l italic_e italic_n ( italic_S start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math> <span class="ltx_text" id="alg1.l3.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l3.1.m1.1"><semantics id="alg1.l3.1.m1.1a"><mo id="alg1.l3.1.m1.1.1" xref="alg1.l3.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l3.1.m1.1b"><ci id="alg1.l3.1.m1.1.1.cmml" xref="alg1.l3.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.1.m1.1d">▷</annotation></semantics></math> Total number of training data 
</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.2.1.1" style="font-size:80%;">4:</span></span><math alttext="N=\lceil(N_{0}/I)\rceil" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">N</mi><mo id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">=</mo><mrow id="alg1.l4.m1.1.1.1.1" xref="alg1.l4.m1.1.1.1.2.cmml"><mo id="alg1.l4.m1.1.1.1.1.2" stretchy="false" xref="alg1.l4.m1.1.1.1.2.1.cmml">⌈</mo><mrow id="alg1.l4.m1.1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l4.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l4.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l4.m1.1.1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l4.m1.1.1.1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l4.m1.1.1.1.1.1.1.1.2.2.cmml">N</mi><mn id="alg1.l4.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l4.m1.1.1.1.1.1.1.1.2.3.cmml">0</mn></msub><mo id="alg1.l4.m1.1.1.1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.1.1.1.cmml">/</mo><mi id="alg1.l4.m1.1.1.1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.1.1.1.3.cmml">I</mi></mrow><mo id="alg1.l4.m1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l4.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l4.m1.1.1.1.1.3" stretchy="false" xref="alg1.l4.m1.1.1.1.2.1.cmml">⌉</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><eq id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"></eq><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝑁</ci><apply id="alg1.l4.m1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1"><ceiling id="alg1.l4.m1.1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.1.1.2"></ceiling><apply id="alg1.l4.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1"><divide id="alg1.l4.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1.1"></divide><apply id="alg1.l4.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l4.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1.2.2">𝑁</ci><cn id="alg1.l4.m1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="alg1.l4.m1.1.1.1.1.1.1.1.2.3">0</cn></apply><ci id="alg1.l4.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1.3">𝐼</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">N=\lceil(N_{0}/I)\rceil</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_N = ⌈ ( italic_N start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT / italic_I ) ⌉</annotation></semantics></math> <span class="ltx_text" id="alg1.l4.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l4.1.m1.1"><semantics id="alg1.l4.1.m1.1a"><mo id="alg1.l4.1.m1.1.1" xref="alg1.l4.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l4.1.m1.1b"><ci id="alg1.l4.1.m1.1.1.cmml" xref="alg1.l4.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.1.m1.1d">▷</annotation></semantics></math> Each iteration incremental data size 
</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.2.1.1" style="font-size:80%;">5:</span></span><math alttext="Tr_{0}=\emptyset" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mrow id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2.cmml">T</mi><mo id="alg1.l5.m1.1.1.2.1" xref="alg1.l5.m1.1.1.2.1.cmml">⁢</mo><msub id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml"><mi id="alg1.l5.m1.1.1.2.3.2" xref="alg1.l5.m1.1.1.2.3.2.cmml">r</mi><mn id="alg1.l5.m1.1.1.2.3.3" xref="alg1.l5.m1.1.1.2.3.3.cmml">0</mn></msub></mrow><mo id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">=</mo><mi id="alg1.l5.m1.1.1.3" mathvariant="normal" xref="alg1.l5.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><eq id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"></eq><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><times id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2.1"></times><ci id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">𝑇</ci><apply id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.3.1.cmml" xref="alg1.l5.m1.1.1.2.3">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.3.2.cmml" xref="alg1.l5.m1.1.1.2.3.2">𝑟</ci><cn id="alg1.l5.m1.1.1.2.3.3.cmml" type="integer" xref="alg1.l5.m1.1.1.2.3.3">0</cn></apply></apply><emptyset id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">Tr_{0}=\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_T italic_r start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = ∅</annotation></semantics></math> <span class="ltx_text" id="alg1.l5.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l5.1.m1.1"><semantics id="alg1.l5.1.m1.1a"><mo id="alg1.l5.1.m1.1.1" xref="alg1.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l5.1.m1.1b"><ci id="alg1.l5.1.m1.1.1.cmml" xref="alg1.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.1.m1.1d">▷</annotation></semantics></math> Initial training data 
</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.2.1.1" style="font-size:80%;">6:</span></span><math alttext="i=1" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">i</mi><mo id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">=</mo><mn id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><eq id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"></eq><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑖</ci><cn id="alg1.l6.m1.1.1.3.cmml" type="integer" xref="alg1.l6.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">i=1</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_i = 1</annotation></semantics></math> <span class="ltx_text" id="alg1.l6.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l6.1.m1.1"><semantics id="alg1.l6.1.m1.1a"><mo id="alg1.l6.1.m1.1.1" xref="alg1.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.1.m1.1b"><ci id="alg1.l6.1.m1.1.1.cmml" xref="alg1.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.1.m1.1d">▷</annotation></semantics></math> Initial iteration 
</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l7.2">while</span> <math alttext="i\leq I" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">i</mi><mo id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">≤</mo><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><leq id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"></leq><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝑖</ci><ci id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">i\leq I</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_i ≤ italic_I</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l7.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.2.1.1" style="font-size:80%;">8:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l8.3">if</span> <math alttext="len(N)&gt;len(S_{i-1})" class="ltx_Math" display="inline" id="alg1.l8.m1.2"><semantics id="alg1.l8.m1.2a"><mrow id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml"><mrow id="alg1.l8.m1.2.2.3" xref="alg1.l8.m1.2.2.3.cmml"><mi id="alg1.l8.m1.2.2.3.2" xref="alg1.l8.m1.2.2.3.2.cmml">l</mi><mo id="alg1.l8.m1.2.2.3.1" xref="alg1.l8.m1.2.2.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.2.2.3.3" xref="alg1.l8.m1.2.2.3.3.cmml">e</mi><mo id="alg1.l8.m1.2.2.3.1a" xref="alg1.l8.m1.2.2.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.2.2.3.4" xref="alg1.l8.m1.2.2.3.4.cmml">n</mi><mo id="alg1.l8.m1.2.2.3.1b" xref="alg1.l8.m1.2.2.3.1.cmml">⁢</mo><mrow id="alg1.l8.m1.2.2.3.5.2" xref="alg1.l8.m1.2.2.3.cmml"><mo id="alg1.l8.m1.2.2.3.5.2.1" stretchy="false" xref="alg1.l8.m1.2.2.3.cmml">(</mo><mi id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">N</mi><mo id="alg1.l8.m1.2.2.3.5.2.2" stretchy="false" xref="alg1.l8.m1.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l8.m1.2.2.2" xref="alg1.l8.m1.2.2.2.cmml">&gt;</mo><mrow id="alg1.l8.m1.2.2.1" xref="alg1.l8.m1.2.2.1.cmml"><mi id="alg1.l8.m1.2.2.1.3" xref="alg1.l8.m1.2.2.1.3.cmml">l</mi><mo id="alg1.l8.m1.2.2.1.2" xref="alg1.l8.m1.2.2.1.2.cmml">⁢</mo><mi id="alg1.l8.m1.2.2.1.4" xref="alg1.l8.m1.2.2.1.4.cmml">e</mi><mo id="alg1.l8.m1.2.2.1.2a" xref="alg1.l8.m1.2.2.1.2.cmml">⁢</mo><mi id="alg1.l8.m1.2.2.1.5" xref="alg1.l8.m1.2.2.1.5.cmml">n</mi><mo id="alg1.l8.m1.2.2.1.2b" xref="alg1.l8.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg1.l8.m1.2.2.1.1.1" xref="alg1.l8.m1.2.2.1.1.1.1.cmml"><mo id="alg1.l8.m1.2.2.1.1.1.2" stretchy="false" xref="alg1.l8.m1.2.2.1.1.1.1.cmml">(</mo><msub id="alg1.l8.m1.2.2.1.1.1.1" xref="alg1.l8.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l8.m1.2.2.1.1.1.1.2" xref="alg1.l8.m1.2.2.1.1.1.1.2.cmml">S</mi><mrow id="alg1.l8.m1.2.2.1.1.1.1.3" xref="alg1.l8.m1.2.2.1.1.1.1.3.cmml"><mi id="alg1.l8.m1.2.2.1.1.1.1.3.2" xref="alg1.l8.m1.2.2.1.1.1.1.3.2.cmml">i</mi><mo id="alg1.l8.m1.2.2.1.1.1.1.3.1" xref="alg1.l8.m1.2.2.1.1.1.1.3.1.cmml">−</mo><mn id="alg1.l8.m1.2.2.1.1.1.1.3.3" xref="alg1.l8.m1.2.2.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l8.m1.2.2.1.1.1.3" stretchy="false" xref="alg1.l8.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.2b"><apply id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2"><gt id="alg1.l8.m1.2.2.2.cmml" xref="alg1.l8.m1.2.2.2"></gt><apply id="alg1.l8.m1.2.2.3.cmml" xref="alg1.l8.m1.2.2.3"><times id="alg1.l8.m1.2.2.3.1.cmml" xref="alg1.l8.m1.2.2.3.1"></times><ci id="alg1.l8.m1.2.2.3.2.cmml" xref="alg1.l8.m1.2.2.3.2">𝑙</ci><ci id="alg1.l8.m1.2.2.3.3.cmml" xref="alg1.l8.m1.2.2.3.3">𝑒</ci><ci id="alg1.l8.m1.2.2.3.4.cmml" xref="alg1.l8.m1.2.2.3.4">𝑛</ci><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝑁</ci></apply><apply id="alg1.l8.m1.2.2.1.cmml" xref="alg1.l8.m1.2.2.1"><times id="alg1.l8.m1.2.2.1.2.cmml" xref="alg1.l8.m1.2.2.1.2"></times><ci id="alg1.l8.m1.2.2.1.3.cmml" xref="alg1.l8.m1.2.2.1.3">𝑙</ci><ci id="alg1.l8.m1.2.2.1.4.cmml" xref="alg1.l8.m1.2.2.1.4">𝑒</ci><ci id="alg1.l8.m1.2.2.1.5.cmml" xref="alg1.l8.m1.2.2.1.5">𝑛</ci><apply id="alg1.l8.m1.2.2.1.1.1.1.cmml" xref="alg1.l8.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l8.m1.2.2.1.1.1">subscript</csymbol><ci id="alg1.l8.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l8.m1.2.2.1.1.1.1.2">𝑆</ci><apply id="alg1.l8.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l8.m1.2.2.1.1.1.1.3"><minus id="alg1.l8.m1.2.2.1.1.1.1.3.1.cmml" xref="alg1.l8.m1.2.2.1.1.1.1.3.1"></minus><ci id="alg1.l8.m1.2.2.1.1.1.1.3.2.cmml" xref="alg1.l8.m1.2.2.1.1.1.1.3.2">𝑖</ci><cn id="alg1.l8.m1.2.2.1.1.1.1.3.3.cmml" type="integer" xref="alg1.l8.m1.2.2.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.2c">len(N)&gt;len(S_{i-1})</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.2d">italic_l italic_e italic_n ( italic_N ) &gt; italic_l italic_e italic_n ( italic_S start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT )</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l8.4">then</span> <span class="ltx_text" id="alg1.l8.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l8.1.m1.1"><semantics id="alg1.l8.1.m1.1a"><mo id="alg1.l8.1.m1.1.1" xref="alg1.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l8.1.m1.1b"><ci id="alg1.l8.1.m1.1.1.cmml" xref="alg1.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.1.m1.1d">▷</annotation></semantics></math> If less than N data left
</span>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.2.1.1" style="font-size:80%;">9:</span></span>         <math alttext="Tr_{i}\leftarrow S_{i-1}" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mrow id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">T</mi><mo id="alg1.l9.m1.1.1.2.1" xref="alg1.l9.m1.1.1.2.1.cmml">⁢</mo><msub id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml"><mi id="alg1.l9.m1.1.1.2.3.2" xref="alg1.l9.m1.1.1.2.3.2.cmml">r</mi><mi id="alg1.l9.m1.1.1.2.3.3" xref="alg1.l9.m1.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="alg1.l9.m1.1.1.1" stretchy="false" xref="alg1.l9.m1.1.1.1.cmml">←</mo><msub id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><mi id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml">S</mi><mrow id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml"><mi id="alg1.l9.m1.1.1.3.3.2" xref="alg1.l9.m1.1.1.3.3.2.cmml">i</mi><mo id="alg1.l9.m1.1.1.3.3.1" xref="alg1.l9.m1.1.1.3.3.1.cmml">−</mo><mn id="alg1.l9.m1.1.1.3.3.3" xref="alg1.l9.m1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><ci id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1">←</ci><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><times id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2.1"></times><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝑇</ci><apply id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.3.1.cmml" xref="alg1.l9.m1.1.1.2.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.3.2.cmml" xref="alg1.l9.m1.1.1.2.3.2">𝑟</ci><ci id="alg1.l9.m1.1.1.2.3.3.cmml" xref="alg1.l9.m1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2">𝑆</ci><apply id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3"><minus id="alg1.l9.m1.1.1.3.3.1.cmml" xref="alg1.l9.m1.1.1.3.3.1"></minus><ci id="alg1.l9.m1.1.1.3.3.2.cmml" xref="alg1.l9.m1.1.1.3.3.2">𝑖</ci><cn id="alg1.l9.m1.1.1.3.3.3.cmml" type="integer" xref="alg1.l9.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">Tr_{i}\leftarrow S_{i-1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">italic_T italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ← italic_S start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text" id="alg1.l9.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l9.1.m1.1"><semantics id="alg1.l9.1.m1.1a"><mo id="alg1.l9.1.m1.1.1" xref="alg1.l9.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l9.1.m1.1b"><ci id="alg1.l9.1.m1.1.1.cmml" xref="alg1.l9.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.1.m1.1d">▷</annotation></semantics></math> Select all the data left
</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.2.1.1" style="font-size:80%;">10:</span></span>         <math alttext="Tr_{i}=Tr_{i-1}+Tr_{i}" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mrow id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml"><mi id="alg1.l10.m1.1.1.2.2" xref="alg1.l10.m1.1.1.2.2.cmml">T</mi><mo id="alg1.l10.m1.1.1.2.1" xref="alg1.l10.m1.1.1.2.1.cmml">⁢</mo><msub id="alg1.l10.m1.1.1.2.3" xref="alg1.l10.m1.1.1.2.3.cmml"><mi id="alg1.l10.m1.1.1.2.3.2" xref="alg1.l10.m1.1.1.2.3.2.cmml">r</mi><mi id="alg1.l10.m1.1.1.2.3.3" xref="alg1.l10.m1.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">=</mo><mrow id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mrow id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml"><mi id="alg1.l10.m1.1.1.3.2.2" xref="alg1.l10.m1.1.1.3.2.2.cmml">T</mi><mo id="alg1.l10.m1.1.1.3.2.1" xref="alg1.l10.m1.1.1.3.2.1.cmml">⁢</mo><msub id="alg1.l10.m1.1.1.3.2.3" xref="alg1.l10.m1.1.1.3.2.3.cmml"><mi id="alg1.l10.m1.1.1.3.2.3.2" xref="alg1.l10.m1.1.1.3.2.3.2.cmml">r</mi><mrow id="alg1.l10.m1.1.1.3.2.3.3" xref="alg1.l10.m1.1.1.3.2.3.3.cmml"><mi id="alg1.l10.m1.1.1.3.2.3.3.2" xref="alg1.l10.m1.1.1.3.2.3.3.2.cmml">i</mi><mo id="alg1.l10.m1.1.1.3.2.3.3.1" xref="alg1.l10.m1.1.1.3.2.3.3.1.cmml">−</mo><mn id="alg1.l10.m1.1.1.3.2.3.3.3" xref="alg1.l10.m1.1.1.3.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="alg1.l10.m1.1.1.3.1" xref="alg1.l10.m1.1.1.3.1.cmml">+</mo><mrow id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml"><mi id="alg1.l10.m1.1.1.3.3.2" xref="alg1.l10.m1.1.1.3.3.2.cmml">T</mi><mo id="alg1.l10.m1.1.1.3.3.1" xref="alg1.l10.m1.1.1.3.3.1.cmml">⁢</mo><msub id="alg1.l10.m1.1.1.3.3.3" xref="alg1.l10.m1.1.1.3.3.3.cmml"><mi id="alg1.l10.m1.1.1.3.3.3.2" xref="alg1.l10.m1.1.1.3.3.3.2.cmml">r</mi><mi id="alg1.l10.m1.1.1.3.3.3.3" xref="alg1.l10.m1.1.1.3.3.3.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><eq id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"></eq><apply id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"><times id="alg1.l10.m1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.2.1"></times><ci id="alg1.l10.m1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.2.2">𝑇</ci><apply id="alg1.l10.m1.1.1.2.3.cmml" xref="alg1.l10.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.2.3.1.cmml" xref="alg1.l10.m1.1.1.2.3">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.3.2.cmml" xref="alg1.l10.m1.1.1.2.3.2">𝑟</ci><ci id="alg1.l10.m1.1.1.2.3.3.cmml" xref="alg1.l10.m1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><plus id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3.1"></plus><apply id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2"><times id="alg1.l10.m1.1.1.3.2.1.cmml" xref="alg1.l10.m1.1.1.3.2.1"></times><ci id="alg1.l10.m1.1.1.3.2.2.cmml" xref="alg1.l10.m1.1.1.3.2.2">𝑇</ci><apply id="alg1.l10.m1.1.1.3.2.3.cmml" xref="alg1.l10.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.2.3.1.cmml" xref="alg1.l10.m1.1.1.3.2.3">subscript</csymbol><ci id="alg1.l10.m1.1.1.3.2.3.2.cmml" xref="alg1.l10.m1.1.1.3.2.3.2">𝑟</ci><apply id="alg1.l10.m1.1.1.3.2.3.3.cmml" xref="alg1.l10.m1.1.1.3.2.3.3"><minus id="alg1.l10.m1.1.1.3.2.3.3.1.cmml" xref="alg1.l10.m1.1.1.3.2.3.3.1"></minus><ci id="alg1.l10.m1.1.1.3.2.3.3.2.cmml" xref="alg1.l10.m1.1.1.3.2.3.3.2">𝑖</ci><cn id="alg1.l10.m1.1.1.3.2.3.3.3.cmml" type="integer" xref="alg1.l10.m1.1.1.3.2.3.3.3">1</cn></apply></apply></apply><apply id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3"><times id="alg1.l10.m1.1.1.3.3.1.cmml" xref="alg1.l10.m1.1.1.3.3.1"></times><ci id="alg1.l10.m1.1.1.3.3.2.cmml" xref="alg1.l10.m1.1.1.3.3.2">𝑇</ci><apply id="alg1.l10.m1.1.1.3.3.3.cmml" xref="alg1.l10.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.3.3.1.cmml" xref="alg1.l10.m1.1.1.3.3.3">subscript</csymbol><ci id="alg1.l10.m1.1.1.3.3.3.2.cmml" xref="alg1.l10.m1.1.1.3.3.3.2">𝑟</ci><ci id="alg1.l10.m1.1.1.3.3.3.3.cmml" xref="alg1.l10.m1.1.1.3.3.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">Tr_{i}=Tr_{i-1}+Tr_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_T italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_T italic_r start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT + italic_T italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text" id="alg1.l10.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l10.1.m1.1"><semantics id="alg1.l10.1.m1.1a"><mo id="alg1.l10.1.m1.1.1" xref="alg1.l10.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l10.1.m1.1b"><ci id="alg1.l10.1.m1.1.1.cmml" xref="alg1.l10.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.1.m1.1d">▷</annotation></semantics></math> Append to training data
</span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.2.1.1" style="font-size:80%;">11:</span></span>         Train <math alttext="E_{i-1}" class="ltx_Math" display="inline" id="alg1.l11.m1.1"><semantics id="alg1.l11.m1.1a"><msub id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">E</mi><mrow id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml"><mi id="alg1.l11.m1.1.1.3.2" xref="alg1.l11.m1.1.1.3.2.cmml">i</mi><mo id="alg1.l11.m1.1.1.3.1" xref="alg1.l11.m1.1.1.3.1.cmml">−</mo><mn id="alg1.l11.m1.1.1.3.3" xref="alg1.l11.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝐸</ci><apply id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3"><minus id="alg1.l11.m1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.3.1"></minus><ci id="alg1.l11.m1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.3.2">𝑖</ci><cn id="alg1.l11.m1.1.1.3.3.cmml" type="integer" xref="alg1.l11.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">E_{i-1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.1d">italic_E start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT</annotation></semantics></math> on <math alttext="Tr_{i}" class="ltx_Math" display="inline" id="alg1.l11.m2.1"><semantics id="alg1.l11.m2.1a"><mrow id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml"><mi id="alg1.l11.m2.1.1.2" xref="alg1.l11.m2.1.1.2.cmml">T</mi><mo id="alg1.l11.m2.1.1.1" xref="alg1.l11.m2.1.1.1.cmml">⁢</mo><msub id="alg1.l11.m2.1.1.3" xref="alg1.l11.m2.1.1.3.cmml"><mi id="alg1.l11.m2.1.1.3.2" xref="alg1.l11.m2.1.1.3.2.cmml">r</mi><mi id="alg1.l11.m2.1.1.3.3" xref="alg1.l11.m2.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b"><apply id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1"><times id="alg1.l11.m2.1.1.1.cmml" xref="alg1.l11.m2.1.1.1"></times><ci id="alg1.l11.m2.1.1.2.cmml" xref="alg1.l11.m2.1.1.2">𝑇</ci><apply id="alg1.l11.m2.1.1.3.cmml" xref="alg1.l11.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l11.m2.1.1.3.1.cmml" xref="alg1.l11.m2.1.1.3">subscript</csymbol><ci id="alg1.l11.m2.1.1.3.2.cmml" xref="alg1.l11.m2.1.1.3.2">𝑟</ci><ci id="alg1.l11.m2.1.1.3.3.cmml" xref="alg1.l11.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.1c">Tr_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m2.1d">italic_T italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and get <math alttext="E_{i}" class="ltx_Math" display="inline" id="alg1.l11.m3.1"><semantics id="alg1.l11.m3.1a"><msub id="alg1.l11.m3.1.1" xref="alg1.l11.m3.1.1.cmml"><mi id="alg1.l11.m3.1.1.2" xref="alg1.l11.m3.1.1.2.cmml">E</mi><mi id="alg1.l11.m3.1.1.3" xref="alg1.l11.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m3.1b"><apply id="alg1.l11.m3.1.1.cmml" xref="alg1.l11.m3.1.1"><csymbol cd="ambiguous" id="alg1.l11.m3.1.1.1.cmml" xref="alg1.l11.m3.1.1">subscript</csymbol><ci id="alg1.l11.m3.1.1.2.cmml" xref="alg1.l11.m3.1.1.2">𝐸</ci><ci id="alg1.l11.m3.1.1.3.cmml" xref="alg1.l11.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m3.1c">E_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m3.1d">italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text" id="alg1.l11.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l11.1.m1.1"><semantics id="alg1.l11.1.m1.1a"><mo id="alg1.l11.1.m1.1.1" xref="alg1.l11.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l11.1.m1.1b"><ci id="alg1.l11.1.m1.1.1.cmml" xref="alg1.l11.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.1.m1.1d">▷</annotation></semantics></math> Continue train the model
</span>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">12:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l12.2">else</span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.2.1.1" style="font-size:80%;">13:</span></span>         <math alttext="C_{i}\leftarrow Top_{N}(S_{i-1})" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><msub id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.3.2" xref="alg1.l13.m1.1.1.3.2.cmml">C</mi><mi id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3.cmml">i</mi></msub><mo id="alg1.l13.m1.1.1.2" stretchy="false" xref="alg1.l13.m1.1.1.2.cmml">←</mo><mrow id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml"><mi id="alg1.l13.m1.1.1.1.3" xref="alg1.l13.m1.1.1.1.3.cmml">T</mi><mo id="alg1.l13.m1.1.1.1.2" xref="alg1.l13.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l13.m1.1.1.1.4" xref="alg1.l13.m1.1.1.1.4.cmml">o</mi><mo id="alg1.l13.m1.1.1.1.2a" xref="alg1.l13.m1.1.1.1.2.cmml">⁢</mo><msub id="alg1.l13.m1.1.1.1.5" xref="alg1.l13.m1.1.1.1.5.cmml"><mi id="alg1.l13.m1.1.1.1.5.2" xref="alg1.l13.m1.1.1.1.5.2.cmml">p</mi><mi id="alg1.l13.m1.1.1.1.5.3" xref="alg1.l13.m1.1.1.1.5.3.cmml">N</mi></msub><mo id="alg1.l13.m1.1.1.1.2b" xref="alg1.l13.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l13.m1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l13.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l13.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l13.m1.1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.1.2" xref="alg1.l13.m1.1.1.1.1.1.1.2.cmml">S</mi><mrow id="alg1.l13.m1.1.1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.1.3.2" xref="alg1.l13.m1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="alg1.l13.m1.1.1.1.1.1.1.3.1" xref="alg1.l13.m1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="alg1.l13.m1.1.1.1.1.1.1.3.3" xref="alg1.l13.m1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l13.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l13.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">←</ci><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3">subscript</csymbol><ci id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.2">𝐶</ci><ci id="alg1.l13.m1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3">𝑖</ci></apply><apply id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"><times id="alg1.l13.m1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.2"></times><ci id="alg1.l13.m1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.3">𝑇</ci><ci id="alg1.l13.m1.1.1.1.4.cmml" xref="alg1.l13.m1.1.1.1.4">𝑜</ci><apply id="alg1.l13.m1.1.1.1.5.cmml" xref="alg1.l13.m1.1.1.1.5"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.5.1.cmml" xref="alg1.l13.m1.1.1.1.5">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.5.2.cmml" xref="alg1.l13.m1.1.1.1.5.2">𝑝</ci><ci id="alg1.l13.m1.1.1.1.5.3.cmml" xref="alg1.l13.m1.1.1.1.5.3">𝑁</ci></apply><apply id="alg1.l13.m1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.2">𝑆</ci><apply id="alg1.l13.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.3"><minus id="alg1.l13.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.3.1"></minus><ci id="alg1.l13.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.3.2">𝑖</ci><cn id="alg1.l13.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg1.l13.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">C_{i}\leftarrow Top_{N}(S_{i-1})</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">italic_C start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ← italic_T italic_o italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( italic_S start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT )</annotation></semantics></math> based on <math alttext="conf_{E_{i-1}}(\cdot)" class="ltx_Math" display="inline" id="alg1.l13.m2.1"><semantics id="alg1.l13.m2.1a"><mrow id="alg1.l13.m2.1.2" xref="alg1.l13.m2.1.2.cmml"><mi id="alg1.l13.m2.1.2.2" xref="alg1.l13.m2.1.2.2.cmml">c</mi><mo id="alg1.l13.m2.1.2.1" xref="alg1.l13.m2.1.2.1.cmml">⁢</mo><mi id="alg1.l13.m2.1.2.3" xref="alg1.l13.m2.1.2.3.cmml">o</mi><mo id="alg1.l13.m2.1.2.1a" xref="alg1.l13.m2.1.2.1.cmml">⁢</mo><mi id="alg1.l13.m2.1.2.4" xref="alg1.l13.m2.1.2.4.cmml">n</mi><mo id="alg1.l13.m2.1.2.1b" xref="alg1.l13.m2.1.2.1.cmml">⁢</mo><msub id="alg1.l13.m2.1.2.5" xref="alg1.l13.m2.1.2.5.cmml"><mi id="alg1.l13.m2.1.2.5.2" xref="alg1.l13.m2.1.2.5.2.cmml">f</mi><msub id="alg1.l13.m2.1.2.5.3" xref="alg1.l13.m2.1.2.5.3.cmml"><mi id="alg1.l13.m2.1.2.5.3.2" xref="alg1.l13.m2.1.2.5.3.2.cmml">E</mi><mrow id="alg1.l13.m2.1.2.5.3.3" xref="alg1.l13.m2.1.2.5.3.3.cmml"><mi id="alg1.l13.m2.1.2.5.3.3.2" xref="alg1.l13.m2.1.2.5.3.3.2.cmml">i</mi><mo id="alg1.l13.m2.1.2.5.3.3.1" xref="alg1.l13.m2.1.2.5.3.3.1.cmml">−</mo><mn id="alg1.l13.m2.1.2.5.3.3.3" xref="alg1.l13.m2.1.2.5.3.3.3.cmml">1</mn></mrow></msub></msub><mo id="alg1.l13.m2.1.2.1c" xref="alg1.l13.m2.1.2.1.cmml">⁢</mo><mrow id="alg1.l13.m2.1.2.6.2" xref="alg1.l13.m2.1.2.cmml"><mo id="alg1.l13.m2.1.2.6.2.1" stretchy="false" xref="alg1.l13.m2.1.2.cmml">(</mo><mo id="alg1.l13.m2.1.1" lspace="0em" rspace="0em" xref="alg1.l13.m2.1.1.cmml">⋅</mo><mo id="alg1.l13.m2.1.2.6.2.2" stretchy="false" xref="alg1.l13.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m2.1b"><apply id="alg1.l13.m2.1.2.cmml" xref="alg1.l13.m2.1.2"><times id="alg1.l13.m2.1.2.1.cmml" xref="alg1.l13.m2.1.2.1"></times><ci id="alg1.l13.m2.1.2.2.cmml" xref="alg1.l13.m2.1.2.2">𝑐</ci><ci id="alg1.l13.m2.1.2.3.cmml" xref="alg1.l13.m2.1.2.3">𝑜</ci><ci id="alg1.l13.m2.1.2.4.cmml" xref="alg1.l13.m2.1.2.4">𝑛</ci><apply id="alg1.l13.m2.1.2.5.cmml" xref="alg1.l13.m2.1.2.5"><csymbol cd="ambiguous" id="alg1.l13.m2.1.2.5.1.cmml" xref="alg1.l13.m2.1.2.5">subscript</csymbol><ci id="alg1.l13.m2.1.2.5.2.cmml" xref="alg1.l13.m2.1.2.5.2">𝑓</ci><apply id="alg1.l13.m2.1.2.5.3.cmml" xref="alg1.l13.m2.1.2.5.3"><csymbol cd="ambiguous" id="alg1.l13.m2.1.2.5.3.1.cmml" xref="alg1.l13.m2.1.2.5.3">subscript</csymbol><ci id="alg1.l13.m2.1.2.5.3.2.cmml" xref="alg1.l13.m2.1.2.5.3.2">𝐸</ci><apply id="alg1.l13.m2.1.2.5.3.3.cmml" xref="alg1.l13.m2.1.2.5.3.3"><minus id="alg1.l13.m2.1.2.5.3.3.1.cmml" xref="alg1.l13.m2.1.2.5.3.3.1"></minus><ci id="alg1.l13.m2.1.2.5.3.3.2.cmml" xref="alg1.l13.m2.1.2.5.3.3.2">𝑖</ci><cn id="alg1.l13.m2.1.2.5.3.3.3.cmml" type="integer" xref="alg1.l13.m2.1.2.5.3.3.3">1</cn></apply></apply></apply><ci id="alg1.l13.m2.1.1.cmml" xref="alg1.l13.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m2.1c">conf_{E_{i-1}}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m2.1d">italic_c italic_o italic_n italic_f start_POSTSUBSCRIPT italic_E start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> <span class="ltx_text" id="alg1.l13.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l13.1.m1.1"><semantics id="alg1.l13.1.m1.1a"><mo id="alg1.l13.1.m1.1.1" xref="alg1.l13.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l13.1.m1.1b"><ci id="alg1.l13.1.m1.1.1.cmml" xref="alg1.l13.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.1.m1.1d">▷</annotation></semantics></math> Select N easy data following curriculum from the unvisited dataset
</span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l14.2.1.1" style="font-size:80%;">14:</span></span>         <math alttext="S_{i}=S_{i-1}-C_{i}" class="ltx_Math" display="inline" id="alg1.l14.m1.1"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><msub id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml"><mi id="alg1.l14.m1.1.1.2.2" xref="alg1.l14.m1.1.1.2.2.cmml">S</mi><mi id="alg1.l14.m1.1.1.2.3" xref="alg1.l14.m1.1.1.2.3.cmml">i</mi></msub><mo id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml">=</mo><mrow id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"><msub id="alg1.l14.m1.1.1.3.2" xref="alg1.l14.m1.1.1.3.2.cmml"><mi id="alg1.l14.m1.1.1.3.2.2" xref="alg1.l14.m1.1.1.3.2.2.cmml">S</mi><mrow id="alg1.l14.m1.1.1.3.2.3" xref="alg1.l14.m1.1.1.3.2.3.cmml"><mi id="alg1.l14.m1.1.1.3.2.3.2" xref="alg1.l14.m1.1.1.3.2.3.2.cmml">i</mi><mo id="alg1.l14.m1.1.1.3.2.3.1" xref="alg1.l14.m1.1.1.3.2.3.1.cmml">−</mo><mn id="alg1.l14.m1.1.1.3.2.3.3" xref="alg1.l14.m1.1.1.3.2.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l14.m1.1.1.3.1" xref="alg1.l14.m1.1.1.3.1.cmml">−</mo><msub id="alg1.l14.m1.1.1.3.3" xref="alg1.l14.m1.1.1.3.3.cmml"><mi id="alg1.l14.m1.1.1.3.3.2" xref="alg1.l14.m1.1.1.3.3.2.cmml">C</mi><mi id="alg1.l14.m1.1.1.3.3.3" xref="alg1.l14.m1.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><eq id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1"></eq><apply id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.2">subscript</csymbol><ci id="alg1.l14.m1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.2.2">𝑆</ci><ci id="alg1.l14.m1.1.1.2.3.cmml" xref="alg1.l14.m1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3"><minus id="alg1.l14.m1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.3.1"></minus><apply id="alg1.l14.m1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.2.1.cmml" xref="alg1.l14.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l14.m1.1.1.3.2.2.cmml" xref="alg1.l14.m1.1.1.3.2.2">𝑆</ci><apply id="alg1.l14.m1.1.1.3.2.3.cmml" xref="alg1.l14.m1.1.1.3.2.3"><minus id="alg1.l14.m1.1.1.3.2.3.1.cmml" xref="alg1.l14.m1.1.1.3.2.3.1"></minus><ci id="alg1.l14.m1.1.1.3.2.3.2.cmml" xref="alg1.l14.m1.1.1.3.2.3.2">𝑖</ci><cn id="alg1.l14.m1.1.1.3.2.3.3.cmml" type="integer" xref="alg1.l14.m1.1.1.3.2.3.3">1</cn></apply></apply><apply id="alg1.l14.m1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.3.1.cmml" xref="alg1.l14.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l14.m1.1.1.3.3.2.cmml" xref="alg1.l14.m1.1.1.3.3.2">𝐶</ci><ci id="alg1.l14.m1.1.1.3.3.3.cmml" xref="alg1.l14.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">S_{i}=S_{i-1}-C_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.1d">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_S start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT - italic_C start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text" id="alg1.l14.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l14.1.m1.1"><semantics id="alg1.l14.1.m1.1a"><mo id="alg1.l14.1.m1.1.1" xref="alg1.l14.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l14.1.m1.1b"><ci id="alg1.l14.1.m1.1.1.cmml" xref="alg1.l14.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.1.m1.1d">▷</annotation></semantics></math> Deduct them from unvisited data
</span>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l15.2.1.1" style="font-size:80%;">15:</span></span>         <math alttext="Tr_{i}=Tr_{i-1}+C_{i}" class="ltx_Math" display="inline" id="alg1.l15.m1.1"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mrow id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml"><mi id="alg1.l15.m1.1.1.2.2" xref="alg1.l15.m1.1.1.2.2.cmml">T</mi><mo id="alg1.l15.m1.1.1.2.1" xref="alg1.l15.m1.1.1.2.1.cmml">⁢</mo><msub id="alg1.l15.m1.1.1.2.3" xref="alg1.l15.m1.1.1.2.3.cmml"><mi id="alg1.l15.m1.1.1.2.3.2" xref="alg1.l15.m1.1.1.2.3.2.cmml">r</mi><mi id="alg1.l15.m1.1.1.2.3.3" xref="alg1.l15.m1.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml">=</mo><mrow id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml"><mrow id="alg1.l15.m1.1.1.3.2" xref="alg1.l15.m1.1.1.3.2.cmml"><mi id="alg1.l15.m1.1.1.3.2.2" xref="alg1.l15.m1.1.1.3.2.2.cmml">T</mi><mo id="alg1.l15.m1.1.1.3.2.1" xref="alg1.l15.m1.1.1.3.2.1.cmml">⁢</mo><msub id="alg1.l15.m1.1.1.3.2.3" xref="alg1.l15.m1.1.1.3.2.3.cmml"><mi id="alg1.l15.m1.1.1.3.2.3.2" xref="alg1.l15.m1.1.1.3.2.3.2.cmml">r</mi><mrow id="alg1.l15.m1.1.1.3.2.3.3" xref="alg1.l15.m1.1.1.3.2.3.3.cmml"><mi id="alg1.l15.m1.1.1.3.2.3.3.2" xref="alg1.l15.m1.1.1.3.2.3.3.2.cmml">i</mi><mo id="alg1.l15.m1.1.1.3.2.3.3.1" xref="alg1.l15.m1.1.1.3.2.3.3.1.cmml">−</mo><mn id="alg1.l15.m1.1.1.3.2.3.3.3" xref="alg1.l15.m1.1.1.3.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="alg1.l15.m1.1.1.3.1" xref="alg1.l15.m1.1.1.3.1.cmml">+</mo><msub id="alg1.l15.m1.1.1.3.3" xref="alg1.l15.m1.1.1.3.3.cmml"><mi id="alg1.l15.m1.1.1.3.3.2" xref="alg1.l15.m1.1.1.3.3.2.cmml">C</mi><mi id="alg1.l15.m1.1.1.3.3.3" xref="alg1.l15.m1.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><eq id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1"></eq><apply id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2"><times id="alg1.l15.m1.1.1.2.1.cmml" xref="alg1.l15.m1.1.1.2.1"></times><ci id="alg1.l15.m1.1.1.2.2.cmml" xref="alg1.l15.m1.1.1.2.2">𝑇</ci><apply id="alg1.l15.m1.1.1.2.3.cmml" xref="alg1.l15.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.2.3.1.cmml" xref="alg1.l15.m1.1.1.2.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.2.3.2.cmml" xref="alg1.l15.m1.1.1.2.3.2">𝑟</ci><ci id="alg1.l15.m1.1.1.2.3.3.cmml" xref="alg1.l15.m1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3"><plus id="alg1.l15.m1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.3.1"></plus><apply id="alg1.l15.m1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.3.2"><times id="alg1.l15.m1.1.1.3.2.1.cmml" xref="alg1.l15.m1.1.1.3.2.1"></times><ci id="alg1.l15.m1.1.1.3.2.2.cmml" xref="alg1.l15.m1.1.1.3.2.2">𝑇</ci><apply id="alg1.l15.m1.1.1.3.2.3.cmml" xref="alg1.l15.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.3.2.3.1.cmml" xref="alg1.l15.m1.1.1.3.2.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.3.2.3.2.cmml" xref="alg1.l15.m1.1.1.3.2.3.2">𝑟</ci><apply id="alg1.l15.m1.1.1.3.2.3.3.cmml" xref="alg1.l15.m1.1.1.3.2.3.3"><minus id="alg1.l15.m1.1.1.3.2.3.3.1.cmml" xref="alg1.l15.m1.1.1.3.2.3.3.1"></minus><ci id="alg1.l15.m1.1.1.3.2.3.3.2.cmml" xref="alg1.l15.m1.1.1.3.2.3.3.2">𝑖</ci><cn id="alg1.l15.m1.1.1.3.2.3.3.3.cmml" type="integer" xref="alg1.l15.m1.1.1.3.2.3.3.3">1</cn></apply></apply></apply><apply id="alg1.l15.m1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.3.3.1.cmml" xref="alg1.l15.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.3.3.2.cmml" xref="alg1.l15.m1.1.1.3.3.2">𝐶</ci><ci id="alg1.l15.m1.1.1.3.3.3.cmml" xref="alg1.l15.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">Tr_{i}=Tr_{i-1}+C_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.1d">italic_T italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_T italic_r start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT + italic_C start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text" id="alg1.l15.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l15.1.m1.1"><semantics id="alg1.l15.1.m1.1a"><mo id="alg1.l15.1.m1.1.1" xref="alg1.l15.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l15.1.m1.1b"><ci id="alg1.l15.1.m1.1.1.cmml" xref="alg1.l15.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.1.m1.1d">▷</annotation></semantics></math> Append them to training data
</span>
</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l16.2.1.1" style="font-size:80%;">16:</span></span>         Train <math alttext="E_{i-1}" class="ltx_Math" display="inline" id="alg1.l16.m1.1"><semantics id="alg1.l16.m1.1a"><msub id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><mi id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml">E</mi><mrow id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml"><mi id="alg1.l16.m1.1.1.3.2" xref="alg1.l16.m1.1.1.3.2.cmml">i</mi><mo id="alg1.l16.m1.1.1.3.1" xref="alg1.l16.m1.1.1.3.1.cmml">−</mo><mn id="alg1.l16.m1.1.1.3.3" xref="alg1.l16.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1">subscript</csymbol><ci id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2">𝐸</ci><apply id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3"><minus id="alg1.l16.m1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.3.1"></minus><ci id="alg1.l16.m1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.3.2">𝑖</ci><cn id="alg1.l16.m1.1.1.3.3.cmml" type="integer" xref="alg1.l16.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">E_{i-1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m1.1d">italic_E start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT</annotation></semantics></math> on <math alttext="Tr_{i}" class="ltx_Math" display="inline" id="alg1.l16.m2.1"><semantics id="alg1.l16.m2.1a"><mrow id="alg1.l16.m2.1.1" xref="alg1.l16.m2.1.1.cmml"><mi id="alg1.l16.m2.1.1.2" xref="alg1.l16.m2.1.1.2.cmml">T</mi><mo id="alg1.l16.m2.1.1.1" xref="alg1.l16.m2.1.1.1.cmml">⁢</mo><msub id="alg1.l16.m2.1.1.3" xref="alg1.l16.m2.1.1.3.cmml"><mi id="alg1.l16.m2.1.1.3.2" xref="alg1.l16.m2.1.1.3.2.cmml">r</mi><mi id="alg1.l16.m2.1.1.3.3" xref="alg1.l16.m2.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m2.1b"><apply id="alg1.l16.m2.1.1.cmml" xref="alg1.l16.m2.1.1"><times id="alg1.l16.m2.1.1.1.cmml" xref="alg1.l16.m2.1.1.1"></times><ci id="alg1.l16.m2.1.1.2.cmml" xref="alg1.l16.m2.1.1.2">𝑇</ci><apply id="alg1.l16.m2.1.1.3.cmml" xref="alg1.l16.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l16.m2.1.1.3.1.cmml" xref="alg1.l16.m2.1.1.3">subscript</csymbol><ci id="alg1.l16.m2.1.1.3.2.cmml" xref="alg1.l16.m2.1.1.3.2">𝑟</ci><ci id="alg1.l16.m2.1.1.3.3.cmml" xref="alg1.l16.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m2.1c">Tr_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m2.1d">italic_T italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and get <math alttext="E_{i}" class="ltx_Math" display="inline" id="alg1.l16.m3.1"><semantics id="alg1.l16.m3.1a"><msub id="alg1.l16.m3.1.1" xref="alg1.l16.m3.1.1.cmml"><mi id="alg1.l16.m3.1.1.2" xref="alg1.l16.m3.1.1.2.cmml">E</mi><mi id="alg1.l16.m3.1.1.3" xref="alg1.l16.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l16.m3.1b"><apply id="alg1.l16.m3.1.1.cmml" xref="alg1.l16.m3.1.1"><csymbol cd="ambiguous" id="alg1.l16.m3.1.1.1.cmml" xref="alg1.l16.m3.1.1">subscript</csymbol><ci id="alg1.l16.m3.1.1.2.cmml" xref="alg1.l16.m3.1.1.2">𝐸</ci><ci id="alg1.l16.m3.1.1.3.cmml" xref="alg1.l16.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m3.1c">E_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m3.1d">italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text" id="alg1.l16.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l16.1.m1.1"><semantics id="alg1.l16.1.m1.1a"><mo id="alg1.l16.1.m1.1.1" xref="alg1.l16.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l16.1.m1.1b"><ci id="alg1.l16.1.m1.1.1.cmml" xref="alg1.l16.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.1.m1.1d">▷</annotation></semantics></math> Train the model
</span>
</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l17.2.1.1" style="font-size:80%;">17:</span></span>         <math alttext="i=i+1" class="ltx_Math" display="inline" id="alg1.l17.m1.1"><semantics id="alg1.l17.m1.1a"><mrow id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><mi id="alg1.l17.m1.1.1.2" xref="alg1.l17.m1.1.1.2.cmml">i</mi><mo id="alg1.l17.m1.1.1.1" xref="alg1.l17.m1.1.1.1.cmml">=</mo><mrow id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml"><mi id="alg1.l17.m1.1.1.3.2" xref="alg1.l17.m1.1.1.3.2.cmml">i</mi><mo id="alg1.l17.m1.1.1.3.1" xref="alg1.l17.m1.1.1.3.1.cmml">+</mo><mn id="alg1.l17.m1.1.1.3.3" xref="alg1.l17.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><eq id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1"></eq><ci id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2">𝑖</ci><apply id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3"><plus id="alg1.l17.m1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.3.1"></plus><ci id="alg1.l17.m1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.3.2">𝑖</ci><cn id="alg1.l17.m1.1.1.3.3.cmml" type="integer" xref="alg1.l17.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">i=i+1</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m1.1d">italic_i = italic_i + 1</annotation></semantics></math> <span class="ltx_text" id="alg1.l17.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l17.1.m1.1"><semantics id="alg1.l17.1.m1.1a"><mo id="alg1.l17.1.m1.1.1" xref="alg1.l17.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l17.1.m1.1b"><ci id="alg1.l17.1.m1.1.1.cmml" xref="alg1.l17.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.1.m1.1d">▷</annotation></semantics></math> Move to next iteration
</span>
</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l18.1.1.1" style="font-size:80%;">18:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l18.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l18.3">if</span>
</div>
<div class="ltx_listingline" id="alg1.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l19.1.1.1" style="font-size:80%;">19:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l19.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l19.3">while</span>
</div>
<div class="ltx_listingline" id="alg1.l20">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l20.1.1.1" style="font-size:80%;">20:</span></span>Use the final <math alttext="E_{I}" class="ltx_Math" display="inline" id="alg1.l20.m1.1"><semantics id="alg1.l20.m1.1a"><msub id="alg1.l20.m1.1.1" xref="alg1.l20.m1.1.1.cmml"><mi id="alg1.l20.m1.1.1.2" xref="alg1.l20.m1.1.1.2.cmml">E</mi><mi id="alg1.l20.m1.1.1.3" xref="alg1.l20.m1.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.1b"><apply id="alg1.l20.m1.1.1.cmml" xref="alg1.l20.m1.1.1"><csymbol cd="ambiguous" id="alg1.l20.m1.1.1.1.cmml" xref="alg1.l20.m1.1.1">subscript</csymbol><ci id="alg1.l20.m1.1.1.2.cmml" xref="alg1.l20.m1.1.1.2">𝐸</ci><ci id="alg1.l20.m1.1.1.3.cmml" xref="alg1.l20.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.1c">E_{I}</annotation><annotation encoding="application/x-llamapun" id="alg1.l20.m1.1d">italic_E start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math> for inference

</div>
</div>
</figure>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">As depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S5.F7" title="Figure 7 ‣ 5.1. Contrastive Representation Model ‣ 5. Demonstration Selection ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">7</span></a>, the essence of this pipeline is to strategically implement an effective curriculum. Starting with the provided training triplets, we initially train our contrastive representation model on a smaller, simpler subset, progressively incorporating easier subsets from the remaining dataset and retraining the model until all training data is utilized. The methodology for generating our curriculum is detailed in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#alg1" title="Algorithm 1 ‣ 5.2. Curriculum Learning Pipeline ‣ 5. Demonstration Selection ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">1</span></a>. This algorithm begins with an empty model; each iteration involves selecting a subset of training data on which the current model performs with the highest confidence, followed by model retraining to incorporate this new subset (lines 5-17). This iterative retraining process continues until the entire training dataset has been incorporated.</p>
</div>
<div class="ltx_para" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.6">In particular, we sample the easier subset of remaining training data by the confidence of the model to the data. Suppose we get the embeddings of two queries using our contrastive model to be <math alttext="x" class="ltx_Math" display="inline" id="S5.SS2.p3.1.m1.1"><semantics id="S5.SS2.p3.1.m1.1a"><mi id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.1b"><ci id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.1.m1.1d">italic_x</annotation></semantics></math> and <math alttext="y" class="ltx_Math" display="inline" id="S5.SS2.p3.2.m2.1"><semantics id="S5.SS2.p3.2.m2.1a"><mi id="S5.SS2.p3.2.m2.1.1" xref="S5.SS2.p3.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.2.m2.1b"><ci id="S5.SS2.p3.2.m2.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.2.m2.1d">italic_y</annotation></semantics></math>, we can compute their similarity scores using the cosine similarity to keep consistency with the training objective in Equation <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S5.E3" title="In 5.1. Contrastive Representation Model ‣ 5. Demonstration Selection ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">3</span></a>. For each contrastive query tuple <math alttext="\langle Q,Q^{+},Q^{-}\rangle" class="ltx_Math" display="inline" id="S5.SS2.p3.3.m3.3"><semantics id="S5.SS2.p3.3.m3.3a"><mrow id="S5.SS2.p3.3.m3.3.3.2" xref="S5.SS2.p3.3.m3.3.3.3.cmml"><mo id="S5.SS2.p3.3.m3.3.3.2.3" stretchy="false" xref="S5.SS2.p3.3.m3.3.3.3.cmml">⟨</mo><mi id="S5.SS2.p3.3.m3.1.1" xref="S5.SS2.p3.3.m3.1.1.cmml">Q</mi><mo id="S5.SS2.p3.3.m3.3.3.2.4" xref="S5.SS2.p3.3.m3.3.3.3.cmml">,</mo><msup id="S5.SS2.p3.3.m3.2.2.1.1" xref="S5.SS2.p3.3.m3.2.2.1.1.cmml"><mi id="S5.SS2.p3.3.m3.2.2.1.1.2" xref="S5.SS2.p3.3.m3.2.2.1.1.2.cmml">Q</mi><mo id="S5.SS2.p3.3.m3.2.2.1.1.3" xref="S5.SS2.p3.3.m3.2.2.1.1.3.cmml">+</mo></msup><mo id="S5.SS2.p3.3.m3.3.3.2.5" xref="S5.SS2.p3.3.m3.3.3.3.cmml">,</mo><msup id="S5.SS2.p3.3.m3.3.3.2.2" xref="S5.SS2.p3.3.m3.3.3.2.2.cmml"><mi id="S5.SS2.p3.3.m3.3.3.2.2.2" xref="S5.SS2.p3.3.m3.3.3.2.2.2.cmml">Q</mi><mo id="S5.SS2.p3.3.m3.3.3.2.2.3" xref="S5.SS2.p3.3.m3.3.3.2.2.3.cmml">−</mo></msup><mo id="S5.SS2.p3.3.m3.3.3.2.6" stretchy="false" xref="S5.SS2.p3.3.m3.3.3.3.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.3.m3.3b"><list id="S5.SS2.p3.3.m3.3.3.3.cmml" xref="S5.SS2.p3.3.m3.3.3.2"><ci id="S5.SS2.p3.3.m3.1.1.cmml" xref="S5.SS2.p3.3.m3.1.1">𝑄</ci><apply id="S5.SS2.p3.3.m3.2.2.1.1.cmml" xref="S5.SS2.p3.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.3.m3.2.2.1.1.1.cmml" xref="S5.SS2.p3.3.m3.2.2.1.1">superscript</csymbol><ci id="S5.SS2.p3.3.m3.2.2.1.1.2.cmml" xref="S5.SS2.p3.3.m3.2.2.1.1.2">𝑄</ci><plus id="S5.SS2.p3.3.m3.2.2.1.1.3.cmml" xref="S5.SS2.p3.3.m3.2.2.1.1.3"></plus></apply><apply id="S5.SS2.p3.3.m3.3.3.2.2.cmml" xref="S5.SS2.p3.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S5.SS2.p3.3.m3.3.3.2.2.1.cmml" xref="S5.SS2.p3.3.m3.3.3.2.2">superscript</csymbol><ci id="S5.SS2.p3.3.m3.3.3.2.2.2.cmml" xref="S5.SS2.p3.3.m3.3.3.2.2.2">𝑄</ci><minus id="S5.SS2.p3.3.m3.3.3.2.2.3.cmml" xref="S5.SS2.p3.3.m3.3.3.2.2.3"></minus></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.3.m3.3c">\langle Q,Q^{+},Q^{-}\rangle</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.3.m3.3d">⟨ italic_Q , italic_Q start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT , italic_Q start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ⟩</annotation></semantics></math>, since we expect to have the <math alttext="\textnormal{sim}(E(Q),E(Q^{+}))=1" class="ltx_Math" display="inline" id="S5.SS2.p3.4.m4.3"><semantics id="S5.SS2.p3.4.m4.3a"><mrow id="S5.SS2.p3.4.m4.3.3" xref="S5.SS2.p3.4.m4.3.3.cmml"><mrow id="S5.SS2.p3.4.m4.3.3.2" xref="S5.SS2.p3.4.m4.3.3.2.cmml"><mtext id="S5.SS2.p3.4.m4.3.3.2.4" xref="S5.SS2.p3.4.m4.3.3.2.4a.cmml">sim</mtext><mo id="S5.SS2.p3.4.m4.3.3.2.3" xref="S5.SS2.p3.4.m4.3.3.2.3.cmml">⁢</mo><mrow id="S5.SS2.p3.4.m4.3.3.2.2.2" xref="S5.SS2.p3.4.m4.3.3.2.2.3.cmml"><mo id="S5.SS2.p3.4.m4.3.3.2.2.2.3" stretchy="false" xref="S5.SS2.p3.4.m4.3.3.2.2.3.cmml">(</mo><mrow id="S5.SS2.p3.4.m4.2.2.1.1.1.1" xref="S5.SS2.p3.4.m4.2.2.1.1.1.1.cmml"><mi id="S5.SS2.p3.4.m4.2.2.1.1.1.1.2" xref="S5.SS2.p3.4.m4.2.2.1.1.1.1.2.cmml">E</mi><mo id="S5.SS2.p3.4.m4.2.2.1.1.1.1.1" xref="S5.SS2.p3.4.m4.2.2.1.1.1.1.1.cmml">⁢</mo><mrow id="S5.SS2.p3.4.m4.2.2.1.1.1.1.3.2" xref="S5.SS2.p3.4.m4.2.2.1.1.1.1.cmml"><mo id="S5.SS2.p3.4.m4.2.2.1.1.1.1.3.2.1" stretchy="false" xref="S5.SS2.p3.4.m4.2.2.1.1.1.1.cmml">(</mo><mi id="S5.SS2.p3.4.m4.1.1" xref="S5.SS2.p3.4.m4.1.1.cmml">Q</mi><mo id="S5.SS2.p3.4.m4.2.2.1.1.1.1.3.2.2" stretchy="false" xref="S5.SS2.p3.4.m4.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.SS2.p3.4.m4.3.3.2.2.2.4" xref="S5.SS2.p3.4.m4.3.3.2.2.3.cmml">,</mo><mrow id="S5.SS2.p3.4.m4.3.3.2.2.2.2" xref="S5.SS2.p3.4.m4.3.3.2.2.2.2.cmml"><mi id="S5.SS2.p3.4.m4.3.3.2.2.2.2.3" xref="S5.SS2.p3.4.m4.3.3.2.2.2.2.3.cmml">E</mi><mo id="S5.SS2.p3.4.m4.3.3.2.2.2.2.2" xref="S5.SS2.p3.4.m4.3.3.2.2.2.2.2.cmml">⁢</mo><mrow id="S5.SS2.p3.4.m4.3.3.2.2.2.2.1.1" xref="S5.SS2.p3.4.m4.3.3.2.2.2.2.1.1.1.cmml"><mo id="S5.SS2.p3.4.m4.3.3.2.2.2.2.1.1.2" stretchy="false" xref="S5.SS2.p3.4.m4.3.3.2.2.2.2.1.1.1.cmml">(</mo><msup id="S5.SS2.p3.4.m4.3.3.2.2.2.2.1.1.1" xref="S5.SS2.p3.4.m4.3.3.2.2.2.2.1.1.1.cmml"><mi id="S5.SS2.p3.4.m4.3.3.2.2.2.2.1.1.1.2" xref="S5.SS2.p3.4.m4.3.3.2.2.2.2.1.1.1.2.cmml">Q</mi><mo id="S5.SS2.p3.4.m4.3.3.2.2.2.2.1.1.1.3" xref="S5.SS2.p3.4.m4.3.3.2.2.2.2.1.1.1.3.cmml">+</mo></msup><mo id="S5.SS2.p3.4.m4.3.3.2.2.2.2.1.1.3" stretchy="false" xref="S5.SS2.p3.4.m4.3.3.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.SS2.p3.4.m4.3.3.2.2.2.5" stretchy="false" xref="S5.SS2.p3.4.m4.3.3.2.2.3.cmml">)</mo></mrow></mrow><mo id="S5.SS2.p3.4.m4.3.3.3" xref="S5.SS2.p3.4.m4.3.3.3.cmml">=</mo><mn id="S5.SS2.p3.4.m4.3.3.4" xref="S5.SS2.p3.4.m4.3.3.4.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.4.m4.3b"><apply id="S5.SS2.p3.4.m4.3.3.cmml" xref="S5.SS2.p3.4.m4.3.3"><eq id="S5.SS2.p3.4.m4.3.3.3.cmml" xref="S5.SS2.p3.4.m4.3.3.3"></eq><apply id="S5.SS2.p3.4.m4.3.3.2.cmml" xref="S5.SS2.p3.4.m4.3.3.2"><times id="S5.SS2.p3.4.m4.3.3.2.3.cmml" xref="S5.SS2.p3.4.m4.3.3.2.3"></times><ci id="S5.SS2.p3.4.m4.3.3.2.4a.cmml" xref="S5.SS2.p3.4.m4.3.3.2.4"><mtext id="S5.SS2.p3.4.m4.3.3.2.4.cmml" xref="S5.SS2.p3.4.m4.3.3.2.4">sim</mtext></ci><interval closure="open" id="S5.SS2.p3.4.m4.3.3.2.2.3.cmml" xref="S5.SS2.p3.4.m4.3.3.2.2.2"><apply id="S5.SS2.p3.4.m4.2.2.1.1.1.1.cmml" xref="S5.SS2.p3.4.m4.2.2.1.1.1.1"><times id="S5.SS2.p3.4.m4.2.2.1.1.1.1.1.cmml" xref="S5.SS2.p3.4.m4.2.2.1.1.1.1.1"></times><ci id="S5.SS2.p3.4.m4.2.2.1.1.1.1.2.cmml" xref="S5.SS2.p3.4.m4.2.2.1.1.1.1.2">𝐸</ci><ci id="S5.SS2.p3.4.m4.1.1.cmml" xref="S5.SS2.p3.4.m4.1.1">𝑄</ci></apply><apply id="S5.SS2.p3.4.m4.3.3.2.2.2.2.cmml" xref="S5.SS2.p3.4.m4.3.3.2.2.2.2"><times id="S5.SS2.p3.4.m4.3.3.2.2.2.2.2.cmml" xref="S5.SS2.p3.4.m4.3.3.2.2.2.2.2"></times><ci id="S5.SS2.p3.4.m4.3.3.2.2.2.2.3.cmml" xref="S5.SS2.p3.4.m4.3.3.2.2.2.2.3">𝐸</ci><apply id="S5.SS2.p3.4.m4.3.3.2.2.2.2.1.1.1.cmml" xref="S5.SS2.p3.4.m4.3.3.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.4.m4.3.3.2.2.2.2.1.1.1.1.cmml" xref="S5.SS2.p3.4.m4.3.3.2.2.2.2.1.1">superscript</csymbol><ci id="S5.SS2.p3.4.m4.3.3.2.2.2.2.1.1.1.2.cmml" xref="S5.SS2.p3.4.m4.3.3.2.2.2.2.1.1.1.2">𝑄</ci><plus id="S5.SS2.p3.4.m4.3.3.2.2.2.2.1.1.1.3.cmml" xref="S5.SS2.p3.4.m4.3.3.2.2.2.2.1.1.1.3"></plus></apply></apply></interval></apply><cn id="S5.SS2.p3.4.m4.3.3.4.cmml" type="integer" xref="S5.SS2.p3.4.m4.3.3.4">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.4.m4.3c">\textnormal{sim}(E(Q),E(Q^{+}))=1</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.4.m4.3d">sim ( italic_E ( italic_Q ) , italic_E ( italic_Q start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) ) = 1</annotation></semantics></math> and <math alttext="\textnormal{sim}(E(Q),E(Q^{-}))=0" class="ltx_Math" display="inline" id="S5.SS2.p3.5.m5.3"><semantics id="S5.SS2.p3.5.m5.3a"><mrow id="S5.SS2.p3.5.m5.3.3" xref="S5.SS2.p3.5.m5.3.3.cmml"><mrow id="S5.SS2.p3.5.m5.3.3.2" xref="S5.SS2.p3.5.m5.3.3.2.cmml"><mtext id="S5.SS2.p3.5.m5.3.3.2.4" xref="S5.SS2.p3.5.m5.3.3.2.4a.cmml">sim</mtext><mo id="S5.SS2.p3.5.m5.3.3.2.3" xref="S5.SS2.p3.5.m5.3.3.2.3.cmml">⁢</mo><mrow id="S5.SS2.p3.5.m5.3.3.2.2.2" xref="S5.SS2.p3.5.m5.3.3.2.2.3.cmml"><mo id="S5.SS2.p3.5.m5.3.3.2.2.2.3" stretchy="false" xref="S5.SS2.p3.5.m5.3.3.2.2.3.cmml">(</mo><mrow id="S5.SS2.p3.5.m5.2.2.1.1.1.1" xref="S5.SS2.p3.5.m5.2.2.1.1.1.1.cmml"><mi id="S5.SS2.p3.5.m5.2.2.1.1.1.1.2" xref="S5.SS2.p3.5.m5.2.2.1.1.1.1.2.cmml">E</mi><mo id="S5.SS2.p3.5.m5.2.2.1.1.1.1.1" xref="S5.SS2.p3.5.m5.2.2.1.1.1.1.1.cmml">⁢</mo><mrow id="S5.SS2.p3.5.m5.2.2.1.1.1.1.3.2" xref="S5.SS2.p3.5.m5.2.2.1.1.1.1.cmml"><mo id="S5.SS2.p3.5.m5.2.2.1.1.1.1.3.2.1" stretchy="false" xref="S5.SS2.p3.5.m5.2.2.1.1.1.1.cmml">(</mo><mi id="S5.SS2.p3.5.m5.1.1" xref="S5.SS2.p3.5.m5.1.1.cmml">Q</mi><mo id="S5.SS2.p3.5.m5.2.2.1.1.1.1.3.2.2" stretchy="false" xref="S5.SS2.p3.5.m5.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.SS2.p3.5.m5.3.3.2.2.2.4" xref="S5.SS2.p3.5.m5.3.3.2.2.3.cmml">,</mo><mrow id="S5.SS2.p3.5.m5.3.3.2.2.2.2" xref="S5.SS2.p3.5.m5.3.3.2.2.2.2.cmml"><mi id="S5.SS2.p3.5.m5.3.3.2.2.2.2.3" xref="S5.SS2.p3.5.m5.3.3.2.2.2.2.3.cmml">E</mi><mo id="S5.SS2.p3.5.m5.3.3.2.2.2.2.2" xref="S5.SS2.p3.5.m5.3.3.2.2.2.2.2.cmml">⁢</mo><mrow id="S5.SS2.p3.5.m5.3.3.2.2.2.2.1.1" xref="S5.SS2.p3.5.m5.3.3.2.2.2.2.1.1.1.cmml"><mo id="S5.SS2.p3.5.m5.3.3.2.2.2.2.1.1.2" stretchy="false" xref="S5.SS2.p3.5.m5.3.3.2.2.2.2.1.1.1.cmml">(</mo><msup id="S5.SS2.p3.5.m5.3.3.2.2.2.2.1.1.1" xref="S5.SS2.p3.5.m5.3.3.2.2.2.2.1.1.1.cmml"><mi id="S5.SS2.p3.5.m5.3.3.2.2.2.2.1.1.1.2" xref="S5.SS2.p3.5.m5.3.3.2.2.2.2.1.1.1.2.cmml">Q</mi><mo id="S5.SS2.p3.5.m5.3.3.2.2.2.2.1.1.1.3" xref="S5.SS2.p3.5.m5.3.3.2.2.2.2.1.1.1.3.cmml">−</mo></msup><mo id="S5.SS2.p3.5.m5.3.3.2.2.2.2.1.1.3" stretchy="false" xref="S5.SS2.p3.5.m5.3.3.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.SS2.p3.5.m5.3.3.2.2.2.5" stretchy="false" xref="S5.SS2.p3.5.m5.3.3.2.2.3.cmml">)</mo></mrow></mrow><mo id="S5.SS2.p3.5.m5.3.3.3" xref="S5.SS2.p3.5.m5.3.3.3.cmml">=</mo><mn id="S5.SS2.p3.5.m5.3.3.4" xref="S5.SS2.p3.5.m5.3.3.4.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.5.m5.3b"><apply id="S5.SS2.p3.5.m5.3.3.cmml" xref="S5.SS2.p3.5.m5.3.3"><eq id="S5.SS2.p3.5.m5.3.3.3.cmml" xref="S5.SS2.p3.5.m5.3.3.3"></eq><apply id="S5.SS2.p3.5.m5.3.3.2.cmml" xref="S5.SS2.p3.5.m5.3.3.2"><times id="S5.SS2.p3.5.m5.3.3.2.3.cmml" xref="S5.SS2.p3.5.m5.3.3.2.3"></times><ci id="S5.SS2.p3.5.m5.3.3.2.4a.cmml" xref="S5.SS2.p3.5.m5.3.3.2.4"><mtext id="S5.SS2.p3.5.m5.3.3.2.4.cmml" xref="S5.SS2.p3.5.m5.3.3.2.4">sim</mtext></ci><interval closure="open" id="S5.SS2.p3.5.m5.3.3.2.2.3.cmml" xref="S5.SS2.p3.5.m5.3.3.2.2.2"><apply id="S5.SS2.p3.5.m5.2.2.1.1.1.1.cmml" xref="S5.SS2.p3.5.m5.2.2.1.1.1.1"><times id="S5.SS2.p3.5.m5.2.2.1.1.1.1.1.cmml" xref="S5.SS2.p3.5.m5.2.2.1.1.1.1.1"></times><ci id="S5.SS2.p3.5.m5.2.2.1.1.1.1.2.cmml" xref="S5.SS2.p3.5.m5.2.2.1.1.1.1.2">𝐸</ci><ci id="S5.SS2.p3.5.m5.1.1.cmml" xref="S5.SS2.p3.5.m5.1.1">𝑄</ci></apply><apply id="S5.SS2.p3.5.m5.3.3.2.2.2.2.cmml" xref="S5.SS2.p3.5.m5.3.3.2.2.2.2"><times id="S5.SS2.p3.5.m5.3.3.2.2.2.2.2.cmml" xref="S5.SS2.p3.5.m5.3.3.2.2.2.2.2"></times><ci id="S5.SS2.p3.5.m5.3.3.2.2.2.2.3.cmml" xref="S5.SS2.p3.5.m5.3.3.2.2.2.2.3">𝐸</ci><apply id="S5.SS2.p3.5.m5.3.3.2.2.2.2.1.1.1.cmml" xref="S5.SS2.p3.5.m5.3.3.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.5.m5.3.3.2.2.2.2.1.1.1.1.cmml" xref="S5.SS2.p3.5.m5.3.3.2.2.2.2.1.1">superscript</csymbol><ci id="S5.SS2.p3.5.m5.3.3.2.2.2.2.1.1.1.2.cmml" xref="S5.SS2.p3.5.m5.3.3.2.2.2.2.1.1.1.2">𝑄</ci><minus id="S5.SS2.p3.5.m5.3.3.2.2.2.2.1.1.1.3.cmml" xref="S5.SS2.p3.5.m5.3.3.2.2.2.2.1.1.1.3"></minus></apply></apply></interval></apply><cn id="S5.SS2.p3.5.m5.3.3.4.cmml" type="integer" xref="S5.SS2.p3.5.m5.3.3.4">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.5.m5.3c">\textnormal{sim}(E(Q),E(Q^{-}))=0</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.5.m5.3d">sim ( italic_E ( italic_Q ) , italic_E ( italic_Q start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ) ) = 0</annotation></semantics></math>, we define a confidence score of the contrastive model <math alttext="E" class="ltx_Math" display="inline" id="S5.SS2.p3.6.m6.1"><semantics id="S5.SS2.p3.6.m6.1a"><mi id="S5.SS2.p3.6.m6.1.1" xref="S5.SS2.p3.6.m6.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.6.m6.1b"><ci id="S5.SS2.p3.6.m6.1.1.cmml" xref="S5.SS2.p3.6.m6.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.6.m6.1c">E</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.6.m6.1d">italic_E</annotation></semantics></math> to a given tuple as:</p>
<table class="ltx_equation ltx_eqn_table" id="S5.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="conf_{E}(Q)=\textnormal{sim}(E(Q),E(Q^{+}))-\textnormal{sim}(E(Q),E(Q^{-}))+1" class="ltx_Math" display="block" id="S5.E4.m1.7"><semantics id="S5.E4.m1.7a"><mrow id="S5.E4.m1.7.7" xref="S5.E4.m1.7.7.cmml"><mrow id="S5.E4.m1.7.7.6" xref="S5.E4.m1.7.7.6.cmml"><mi id="S5.E4.m1.7.7.6.2" xref="S5.E4.m1.7.7.6.2.cmml">c</mi><mo id="S5.E4.m1.7.7.6.1" xref="S5.E4.m1.7.7.6.1.cmml">⁢</mo><mi id="S5.E4.m1.7.7.6.3" xref="S5.E4.m1.7.7.6.3.cmml">o</mi><mo id="S5.E4.m1.7.7.6.1a" xref="S5.E4.m1.7.7.6.1.cmml">⁢</mo><mi id="S5.E4.m1.7.7.6.4" xref="S5.E4.m1.7.7.6.4.cmml">n</mi><mo id="S5.E4.m1.7.7.6.1b" xref="S5.E4.m1.7.7.6.1.cmml">⁢</mo><msub id="S5.E4.m1.7.7.6.5" xref="S5.E4.m1.7.7.6.5.cmml"><mi id="S5.E4.m1.7.7.6.5.2" xref="S5.E4.m1.7.7.6.5.2.cmml">f</mi><mi id="S5.E4.m1.7.7.6.5.3" xref="S5.E4.m1.7.7.6.5.3.cmml">E</mi></msub><mo id="S5.E4.m1.7.7.6.1c" xref="S5.E4.m1.7.7.6.1.cmml">⁢</mo><mrow id="S5.E4.m1.7.7.6.6.2" xref="S5.E4.m1.7.7.6.cmml"><mo id="S5.E4.m1.7.7.6.6.2.1" stretchy="false" xref="S5.E4.m1.7.7.6.cmml">(</mo><mi id="S5.E4.m1.1.1" xref="S5.E4.m1.1.1.cmml">Q</mi><mo id="S5.E4.m1.7.7.6.6.2.2" stretchy="false" xref="S5.E4.m1.7.7.6.cmml">)</mo></mrow></mrow><mo id="S5.E4.m1.7.7.5" xref="S5.E4.m1.7.7.5.cmml">=</mo><mrow id="S5.E4.m1.7.7.4" xref="S5.E4.m1.7.7.4.cmml"><mrow id="S5.E4.m1.7.7.4.4" xref="S5.E4.m1.7.7.4.4.cmml"><mrow id="S5.E4.m1.5.5.2.2.2" xref="S5.E4.m1.5.5.2.2.2.cmml"><mtext id="S5.E4.m1.5.5.2.2.2.4" xref="S5.E4.m1.5.5.2.2.2.4a.cmml">sim</mtext><mo id="S5.E4.m1.5.5.2.2.2.3" xref="S5.E4.m1.5.5.2.2.2.3.cmml">⁢</mo><mrow id="S5.E4.m1.5.5.2.2.2.2.2" xref="S5.E4.m1.5.5.2.2.2.2.3.cmml"><mo id="S5.E4.m1.5.5.2.2.2.2.2.3" stretchy="false" xref="S5.E4.m1.5.5.2.2.2.2.3.cmml">(</mo><mrow id="S5.E4.m1.4.4.1.1.1.1.1.1" xref="S5.E4.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S5.E4.m1.4.4.1.1.1.1.1.1.2" xref="S5.E4.m1.4.4.1.1.1.1.1.1.2.cmml">E</mi><mo id="S5.E4.m1.4.4.1.1.1.1.1.1.1" xref="S5.E4.m1.4.4.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S5.E4.m1.4.4.1.1.1.1.1.1.3.2" xref="S5.E4.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S5.E4.m1.4.4.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S5.E4.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mi id="S5.E4.m1.2.2" xref="S5.E4.m1.2.2.cmml">Q</mi><mo id="S5.E4.m1.4.4.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S5.E4.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.E4.m1.5.5.2.2.2.2.2.4" xref="S5.E4.m1.5.5.2.2.2.2.3.cmml">,</mo><mrow id="S5.E4.m1.5.5.2.2.2.2.2.2" xref="S5.E4.m1.5.5.2.2.2.2.2.2.cmml"><mi id="S5.E4.m1.5.5.2.2.2.2.2.2.3" xref="S5.E4.m1.5.5.2.2.2.2.2.2.3.cmml">E</mi><mo id="S5.E4.m1.5.5.2.2.2.2.2.2.2" xref="S5.E4.m1.5.5.2.2.2.2.2.2.2.cmml">⁢</mo><mrow id="S5.E4.m1.5.5.2.2.2.2.2.2.1.1" xref="S5.E4.m1.5.5.2.2.2.2.2.2.1.1.1.cmml"><mo id="S5.E4.m1.5.5.2.2.2.2.2.2.1.1.2" stretchy="false" xref="S5.E4.m1.5.5.2.2.2.2.2.2.1.1.1.cmml">(</mo><msup id="S5.E4.m1.5.5.2.2.2.2.2.2.1.1.1" xref="S5.E4.m1.5.5.2.2.2.2.2.2.1.1.1.cmml"><mi id="S5.E4.m1.5.5.2.2.2.2.2.2.1.1.1.2" xref="S5.E4.m1.5.5.2.2.2.2.2.2.1.1.1.2.cmml">Q</mi><mo id="S5.E4.m1.5.5.2.2.2.2.2.2.1.1.1.3" xref="S5.E4.m1.5.5.2.2.2.2.2.2.1.1.1.3.cmml">+</mo></msup><mo id="S5.E4.m1.5.5.2.2.2.2.2.2.1.1.3" stretchy="false" xref="S5.E4.m1.5.5.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.E4.m1.5.5.2.2.2.2.2.5" stretchy="false" xref="S5.E4.m1.5.5.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S5.E4.m1.7.7.4.4.5" xref="S5.E4.m1.7.7.4.4.5.cmml">−</mo><mrow id="S5.E4.m1.7.7.4.4.4" xref="S5.E4.m1.7.7.4.4.4.cmml"><mtext id="S5.E4.m1.7.7.4.4.4.4" xref="S5.E4.m1.7.7.4.4.4.4a.cmml">sim</mtext><mo id="S5.E4.m1.7.7.4.4.4.3" xref="S5.E4.m1.7.7.4.4.4.3.cmml">⁢</mo><mrow id="S5.E4.m1.7.7.4.4.4.2.2" xref="S5.E4.m1.7.7.4.4.4.2.3.cmml"><mo id="S5.E4.m1.7.7.4.4.4.2.2.3" stretchy="false" xref="S5.E4.m1.7.7.4.4.4.2.3.cmml">(</mo><mrow id="S5.E4.m1.6.6.3.3.3.1.1.1" xref="S5.E4.m1.6.6.3.3.3.1.1.1.cmml"><mi id="S5.E4.m1.6.6.3.3.3.1.1.1.2" xref="S5.E4.m1.6.6.3.3.3.1.1.1.2.cmml">E</mi><mo id="S5.E4.m1.6.6.3.3.3.1.1.1.1" xref="S5.E4.m1.6.6.3.3.3.1.1.1.1.cmml">⁢</mo><mrow id="S5.E4.m1.6.6.3.3.3.1.1.1.3.2" xref="S5.E4.m1.6.6.3.3.3.1.1.1.cmml"><mo id="S5.E4.m1.6.6.3.3.3.1.1.1.3.2.1" stretchy="false" xref="S5.E4.m1.6.6.3.3.3.1.1.1.cmml">(</mo><mi id="S5.E4.m1.3.3" xref="S5.E4.m1.3.3.cmml">Q</mi><mo id="S5.E4.m1.6.6.3.3.3.1.1.1.3.2.2" stretchy="false" xref="S5.E4.m1.6.6.3.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.E4.m1.7.7.4.4.4.2.2.4" xref="S5.E4.m1.7.7.4.4.4.2.3.cmml">,</mo><mrow id="S5.E4.m1.7.7.4.4.4.2.2.2" xref="S5.E4.m1.7.7.4.4.4.2.2.2.cmml"><mi id="S5.E4.m1.7.7.4.4.4.2.2.2.3" xref="S5.E4.m1.7.7.4.4.4.2.2.2.3.cmml">E</mi><mo id="S5.E4.m1.7.7.4.4.4.2.2.2.2" xref="S5.E4.m1.7.7.4.4.4.2.2.2.2.cmml">⁢</mo><mrow id="S5.E4.m1.7.7.4.4.4.2.2.2.1.1" xref="S5.E4.m1.7.7.4.4.4.2.2.2.1.1.1.cmml"><mo id="S5.E4.m1.7.7.4.4.4.2.2.2.1.1.2" stretchy="false" xref="S5.E4.m1.7.7.4.4.4.2.2.2.1.1.1.cmml">(</mo><msup id="S5.E4.m1.7.7.4.4.4.2.2.2.1.1.1" xref="S5.E4.m1.7.7.4.4.4.2.2.2.1.1.1.cmml"><mi id="S5.E4.m1.7.7.4.4.4.2.2.2.1.1.1.2" xref="S5.E4.m1.7.7.4.4.4.2.2.2.1.1.1.2.cmml">Q</mi><mo id="S5.E4.m1.7.7.4.4.4.2.2.2.1.1.1.3" xref="S5.E4.m1.7.7.4.4.4.2.2.2.1.1.1.3.cmml">−</mo></msup><mo id="S5.E4.m1.7.7.4.4.4.2.2.2.1.1.3" stretchy="false" xref="S5.E4.m1.7.7.4.4.4.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.E4.m1.7.7.4.4.4.2.2.5" stretchy="false" xref="S5.E4.m1.7.7.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E4.m1.7.7.4.5" xref="S5.E4.m1.7.7.4.5.cmml">+</mo><mn id="S5.E4.m1.7.7.4.6" xref="S5.E4.m1.7.7.4.6.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E4.m1.7b"><apply id="S5.E4.m1.7.7.cmml" xref="S5.E4.m1.7.7"><eq id="S5.E4.m1.7.7.5.cmml" xref="S5.E4.m1.7.7.5"></eq><apply id="S5.E4.m1.7.7.6.cmml" xref="S5.E4.m1.7.7.6"><times id="S5.E4.m1.7.7.6.1.cmml" xref="S5.E4.m1.7.7.6.1"></times><ci id="S5.E4.m1.7.7.6.2.cmml" xref="S5.E4.m1.7.7.6.2">𝑐</ci><ci id="S5.E4.m1.7.7.6.3.cmml" xref="S5.E4.m1.7.7.6.3">𝑜</ci><ci id="S5.E4.m1.7.7.6.4.cmml" xref="S5.E4.m1.7.7.6.4">𝑛</ci><apply id="S5.E4.m1.7.7.6.5.cmml" xref="S5.E4.m1.7.7.6.5"><csymbol cd="ambiguous" id="S5.E4.m1.7.7.6.5.1.cmml" xref="S5.E4.m1.7.7.6.5">subscript</csymbol><ci id="S5.E4.m1.7.7.6.5.2.cmml" xref="S5.E4.m1.7.7.6.5.2">𝑓</ci><ci id="S5.E4.m1.7.7.6.5.3.cmml" xref="S5.E4.m1.7.7.6.5.3">𝐸</ci></apply><ci id="S5.E4.m1.1.1.cmml" xref="S5.E4.m1.1.1">𝑄</ci></apply><apply id="S5.E4.m1.7.7.4.cmml" xref="S5.E4.m1.7.7.4"><plus id="S5.E4.m1.7.7.4.5.cmml" xref="S5.E4.m1.7.7.4.5"></plus><apply id="S5.E4.m1.7.7.4.4.cmml" xref="S5.E4.m1.7.7.4.4"><minus id="S5.E4.m1.7.7.4.4.5.cmml" xref="S5.E4.m1.7.7.4.4.5"></minus><apply id="S5.E4.m1.5.5.2.2.2.cmml" xref="S5.E4.m1.5.5.2.2.2"><times id="S5.E4.m1.5.5.2.2.2.3.cmml" xref="S5.E4.m1.5.5.2.2.2.3"></times><ci id="S5.E4.m1.5.5.2.2.2.4a.cmml" xref="S5.E4.m1.5.5.2.2.2.4"><mtext id="S5.E4.m1.5.5.2.2.2.4.cmml" xref="S5.E4.m1.5.5.2.2.2.4">sim</mtext></ci><interval closure="open" id="S5.E4.m1.5.5.2.2.2.2.3.cmml" xref="S5.E4.m1.5.5.2.2.2.2.2"><apply id="S5.E4.m1.4.4.1.1.1.1.1.1.cmml" xref="S5.E4.m1.4.4.1.1.1.1.1.1"><times id="S5.E4.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S5.E4.m1.4.4.1.1.1.1.1.1.1"></times><ci id="S5.E4.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S5.E4.m1.4.4.1.1.1.1.1.1.2">𝐸</ci><ci id="S5.E4.m1.2.2.cmml" xref="S5.E4.m1.2.2">𝑄</ci></apply><apply id="S5.E4.m1.5.5.2.2.2.2.2.2.cmml" xref="S5.E4.m1.5.5.2.2.2.2.2.2"><times id="S5.E4.m1.5.5.2.2.2.2.2.2.2.cmml" xref="S5.E4.m1.5.5.2.2.2.2.2.2.2"></times><ci id="S5.E4.m1.5.5.2.2.2.2.2.2.3.cmml" xref="S5.E4.m1.5.5.2.2.2.2.2.2.3">𝐸</ci><apply id="S5.E4.m1.5.5.2.2.2.2.2.2.1.1.1.cmml" xref="S5.E4.m1.5.5.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S5.E4.m1.5.5.2.2.2.2.2.2.1.1.1.1.cmml" xref="S5.E4.m1.5.5.2.2.2.2.2.2.1.1">superscript</csymbol><ci id="S5.E4.m1.5.5.2.2.2.2.2.2.1.1.1.2.cmml" xref="S5.E4.m1.5.5.2.2.2.2.2.2.1.1.1.2">𝑄</ci><plus id="S5.E4.m1.5.5.2.2.2.2.2.2.1.1.1.3.cmml" xref="S5.E4.m1.5.5.2.2.2.2.2.2.1.1.1.3"></plus></apply></apply></interval></apply><apply id="S5.E4.m1.7.7.4.4.4.cmml" xref="S5.E4.m1.7.7.4.4.4"><times id="S5.E4.m1.7.7.4.4.4.3.cmml" xref="S5.E4.m1.7.7.4.4.4.3"></times><ci id="S5.E4.m1.7.7.4.4.4.4a.cmml" xref="S5.E4.m1.7.7.4.4.4.4"><mtext id="S5.E4.m1.7.7.4.4.4.4.cmml" xref="S5.E4.m1.7.7.4.4.4.4">sim</mtext></ci><interval closure="open" id="S5.E4.m1.7.7.4.4.4.2.3.cmml" xref="S5.E4.m1.7.7.4.4.4.2.2"><apply id="S5.E4.m1.6.6.3.3.3.1.1.1.cmml" xref="S5.E4.m1.6.6.3.3.3.1.1.1"><times id="S5.E4.m1.6.6.3.3.3.1.1.1.1.cmml" xref="S5.E4.m1.6.6.3.3.3.1.1.1.1"></times><ci id="S5.E4.m1.6.6.3.3.3.1.1.1.2.cmml" xref="S5.E4.m1.6.6.3.3.3.1.1.1.2">𝐸</ci><ci id="S5.E4.m1.3.3.cmml" xref="S5.E4.m1.3.3">𝑄</ci></apply><apply id="S5.E4.m1.7.7.4.4.4.2.2.2.cmml" xref="S5.E4.m1.7.7.4.4.4.2.2.2"><times id="S5.E4.m1.7.7.4.4.4.2.2.2.2.cmml" xref="S5.E4.m1.7.7.4.4.4.2.2.2.2"></times><ci id="S5.E4.m1.7.7.4.4.4.2.2.2.3.cmml" xref="S5.E4.m1.7.7.4.4.4.2.2.2.3">𝐸</ci><apply id="S5.E4.m1.7.7.4.4.4.2.2.2.1.1.1.cmml" xref="S5.E4.m1.7.7.4.4.4.2.2.2.1.1"><csymbol cd="ambiguous" id="S5.E4.m1.7.7.4.4.4.2.2.2.1.1.1.1.cmml" xref="S5.E4.m1.7.7.4.4.4.2.2.2.1.1">superscript</csymbol><ci id="S5.E4.m1.7.7.4.4.4.2.2.2.1.1.1.2.cmml" xref="S5.E4.m1.7.7.4.4.4.2.2.2.1.1.1.2">𝑄</ci><minus id="S5.E4.m1.7.7.4.4.4.2.2.2.1.1.1.3.cmml" xref="S5.E4.m1.7.7.4.4.4.2.2.2.1.1.1.3"></minus></apply></apply></interval></apply></apply><cn id="S5.E4.m1.7.7.4.6.cmml" type="integer" xref="S5.E4.m1.7.7.4.6">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E4.m1.7c">conf_{E}(Q)=\textnormal{sim}(E(Q),E(Q^{+}))-\textnormal{sim}(E(Q),E(Q^{-}))+1</annotation><annotation encoding="application/x-llamapun" id="S5.E4.m1.7d">italic_c italic_o italic_n italic_f start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT ( italic_Q ) = sim ( italic_E ( italic_Q ) , italic_E ( italic_Q start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) ) - sim ( italic_E ( italic_Q ) , italic_E ( italic_Q start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ) ) + 1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS2.p3.14">Therefore, at each iteration <math alttext="i" class="ltx_Math" display="inline" id="S5.SS2.p3.7.m1.1"><semantics id="S5.SS2.p3.7.m1.1a"><mi id="S5.SS2.p3.7.m1.1.1" xref="S5.SS2.p3.7.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.7.m1.1b"><ci id="S5.SS2.p3.7.m1.1.1.cmml" xref="S5.SS2.p3.7.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.7.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.7.m1.1d">italic_i</annotation></semantics></math>, given our trained model <math alttext="E_{i-1}" class="ltx_Math" display="inline" id="S5.SS2.p3.8.m2.1"><semantics id="S5.SS2.p3.8.m2.1a"><msub id="S5.SS2.p3.8.m2.1.1" xref="S5.SS2.p3.8.m2.1.1.cmml"><mi id="S5.SS2.p3.8.m2.1.1.2" xref="S5.SS2.p3.8.m2.1.1.2.cmml">E</mi><mrow id="S5.SS2.p3.8.m2.1.1.3" xref="S5.SS2.p3.8.m2.1.1.3.cmml"><mi id="S5.SS2.p3.8.m2.1.1.3.2" xref="S5.SS2.p3.8.m2.1.1.3.2.cmml">i</mi><mo id="S5.SS2.p3.8.m2.1.1.3.1" xref="S5.SS2.p3.8.m2.1.1.3.1.cmml">−</mo><mn id="S5.SS2.p3.8.m2.1.1.3.3" xref="S5.SS2.p3.8.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.8.m2.1b"><apply id="S5.SS2.p3.8.m2.1.1.cmml" xref="S5.SS2.p3.8.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.8.m2.1.1.1.cmml" xref="S5.SS2.p3.8.m2.1.1">subscript</csymbol><ci id="S5.SS2.p3.8.m2.1.1.2.cmml" xref="S5.SS2.p3.8.m2.1.1.2">𝐸</ci><apply id="S5.SS2.p3.8.m2.1.1.3.cmml" xref="S5.SS2.p3.8.m2.1.1.3"><minus id="S5.SS2.p3.8.m2.1.1.3.1.cmml" xref="S5.SS2.p3.8.m2.1.1.3.1"></minus><ci id="S5.SS2.p3.8.m2.1.1.3.2.cmml" xref="S5.SS2.p3.8.m2.1.1.3.2">𝑖</ci><cn id="S5.SS2.p3.8.m2.1.1.3.3.cmml" type="integer" xref="S5.SS2.p3.8.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.8.m2.1c">E_{i-1}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.8.m2.1d">italic_E start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT</annotation></semantics></math>, previous training dataset <math alttext="T_{i-1}" class="ltx_Math" display="inline" id="S5.SS2.p3.9.m3.1"><semantics id="S5.SS2.p3.9.m3.1a"><msub id="S5.SS2.p3.9.m3.1.1" xref="S5.SS2.p3.9.m3.1.1.cmml"><mi id="S5.SS2.p3.9.m3.1.1.2" xref="S5.SS2.p3.9.m3.1.1.2.cmml">T</mi><mrow id="S5.SS2.p3.9.m3.1.1.3" xref="S5.SS2.p3.9.m3.1.1.3.cmml"><mi id="S5.SS2.p3.9.m3.1.1.3.2" xref="S5.SS2.p3.9.m3.1.1.3.2.cmml">i</mi><mo id="S5.SS2.p3.9.m3.1.1.3.1" xref="S5.SS2.p3.9.m3.1.1.3.1.cmml">−</mo><mn id="S5.SS2.p3.9.m3.1.1.3.3" xref="S5.SS2.p3.9.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.9.m3.1b"><apply id="S5.SS2.p3.9.m3.1.1.cmml" xref="S5.SS2.p3.9.m3.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.9.m3.1.1.1.cmml" xref="S5.SS2.p3.9.m3.1.1">subscript</csymbol><ci id="S5.SS2.p3.9.m3.1.1.2.cmml" xref="S5.SS2.p3.9.m3.1.1.2">𝑇</ci><apply id="S5.SS2.p3.9.m3.1.1.3.cmml" xref="S5.SS2.p3.9.m3.1.1.3"><minus id="S5.SS2.p3.9.m3.1.1.3.1.cmml" xref="S5.SS2.p3.9.m3.1.1.3.1"></minus><ci id="S5.SS2.p3.9.m3.1.1.3.2.cmml" xref="S5.SS2.p3.9.m3.1.1.3.2">𝑖</ci><cn id="S5.SS2.p3.9.m3.1.1.3.3.cmml" type="integer" xref="S5.SS2.p3.9.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.9.m3.1c">T_{i-1}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.9.m3.1d">italic_T start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT</annotation></semantics></math> and the unvisited dataset <math alttext="D_{i-1}" class="ltx_Math" display="inline" id="S5.SS2.p3.10.m4.1"><semantics id="S5.SS2.p3.10.m4.1a"><msub id="S5.SS2.p3.10.m4.1.1" xref="S5.SS2.p3.10.m4.1.1.cmml"><mi id="S5.SS2.p3.10.m4.1.1.2" xref="S5.SS2.p3.10.m4.1.1.2.cmml">D</mi><mrow id="S5.SS2.p3.10.m4.1.1.3" xref="S5.SS2.p3.10.m4.1.1.3.cmml"><mi id="S5.SS2.p3.10.m4.1.1.3.2" xref="S5.SS2.p3.10.m4.1.1.3.2.cmml">i</mi><mo id="S5.SS2.p3.10.m4.1.1.3.1" xref="S5.SS2.p3.10.m4.1.1.3.1.cmml">−</mo><mn id="S5.SS2.p3.10.m4.1.1.3.3" xref="S5.SS2.p3.10.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.10.m4.1b"><apply id="S5.SS2.p3.10.m4.1.1.cmml" xref="S5.SS2.p3.10.m4.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.10.m4.1.1.1.cmml" xref="S5.SS2.p3.10.m4.1.1">subscript</csymbol><ci id="S5.SS2.p3.10.m4.1.1.2.cmml" xref="S5.SS2.p3.10.m4.1.1.2">𝐷</ci><apply id="S5.SS2.p3.10.m4.1.1.3.cmml" xref="S5.SS2.p3.10.m4.1.1.3"><minus id="S5.SS2.p3.10.m4.1.1.3.1.cmml" xref="S5.SS2.p3.10.m4.1.1.3.1"></minus><ci id="S5.SS2.p3.10.m4.1.1.3.2.cmml" xref="S5.SS2.p3.10.m4.1.1.3.2">𝑖</ci><cn id="S5.SS2.p3.10.m4.1.1.3.3.cmml" type="integer" xref="S5.SS2.p3.10.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.10.m4.1c">D_{i-1}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.10.m4.1d">italic_D start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT</annotation></semantics></math>, we can generate the current tuples (denoted as <math alttext="S_{i}" class="ltx_Math" display="inline" id="S5.SS2.p3.11.m5.1"><semantics id="S5.SS2.p3.11.m5.1a"><msub id="S5.SS2.p3.11.m5.1.1" xref="S5.SS2.p3.11.m5.1.1.cmml"><mi id="S5.SS2.p3.11.m5.1.1.2" xref="S5.SS2.p3.11.m5.1.1.2.cmml">S</mi><mi id="S5.SS2.p3.11.m5.1.1.3" xref="S5.SS2.p3.11.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.11.m5.1b"><apply id="S5.SS2.p3.11.m5.1.1.cmml" xref="S5.SS2.p3.11.m5.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.11.m5.1.1.1.cmml" xref="S5.SS2.p3.11.m5.1.1">subscript</csymbol><ci id="S5.SS2.p3.11.m5.1.1.2.cmml" xref="S5.SS2.p3.11.m5.1.1.2">𝑆</ci><ci id="S5.SS2.p3.11.m5.1.1.3.cmml" xref="S5.SS2.p3.11.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.11.m5.1c">S_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.11.m5.1d">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>) with the highest confidence score in <math alttext="D_{i-1}" class="ltx_Math" display="inline" id="S5.SS2.p3.12.m6.1"><semantics id="S5.SS2.p3.12.m6.1a"><msub id="S5.SS2.p3.12.m6.1.1" xref="S5.SS2.p3.12.m6.1.1.cmml"><mi id="S5.SS2.p3.12.m6.1.1.2" xref="S5.SS2.p3.12.m6.1.1.2.cmml">D</mi><mrow id="S5.SS2.p3.12.m6.1.1.3" xref="S5.SS2.p3.12.m6.1.1.3.cmml"><mi id="S5.SS2.p3.12.m6.1.1.3.2" xref="S5.SS2.p3.12.m6.1.1.3.2.cmml">i</mi><mo id="S5.SS2.p3.12.m6.1.1.3.1" xref="S5.SS2.p3.12.m6.1.1.3.1.cmml">−</mo><mn id="S5.SS2.p3.12.m6.1.1.3.3" xref="S5.SS2.p3.12.m6.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.12.m6.1b"><apply id="S5.SS2.p3.12.m6.1.1.cmml" xref="S5.SS2.p3.12.m6.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.12.m6.1.1.1.cmml" xref="S5.SS2.p3.12.m6.1.1">subscript</csymbol><ci id="S5.SS2.p3.12.m6.1.1.2.cmml" xref="S5.SS2.p3.12.m6.1.1.2">𝐷</ci><apply id="S5.SS2.p3.12.m6.1.1.3.cmml" xref="S5.SS2.p3.12.m6.1.1.3"><minus id="S5.SS2.p3.12.m6.1.1.3.1.cmml" xref="S5.SS2.p3.12.m6.1.1.3.1"></minus><ci id="S5.SS2.p3.12.m6.1.1.3.2.cmml" xref="S5.SS2.p3.12.m6.1.1.3.2">𝑖</ci><cn id="S5.SS2.p3.12.m6.1.1.3.3.cmml" type="integer" xref="S5.SS2.p3.12.m6.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.12.m6.1c">D_{i-1}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.12.m6.1d">italic_D start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT</annotation></semantics></math>. They are then moved into the training set, resulting in the new training set <math alttext="T_{i}=T_{i-1}+S_{i}" class="ltx_Math" display="inline" id="S5.SS2.p3.13.m7.1"><semantics id="S5.SS2.p3.13.m7.1a"><mrow id="S5.SS2.p3.13.m7.1.1" xref="S5.SS2.p3.13.m7.1.1.cmml"><msub id="S5.SS2.p3.13.m7.1.1.2" xref="S5.SS2.p3.13.m7.1.1.2.cmml"><mi id="S5.SS2.p3.13.m7.1.1.2.2" xref="S5.SS2.p3.13.m7.1.1.2.2.cmml">T</mi><mi id="S5.SS2.p3.13.m7.1.1.2.3" xref="S5.SS2.p3.13.m7.1.1.2.3.cmml">i</mi></msub><mo id="S5.SS2.p3.13.m7.1.1.1" xref="S5.SS2.p3.13.m7.1.1.1.cmml">=</mo><mrow id="S5.SS2.p3.13.m7.1.1.3" xref="S5.SS2.p3.13.m7.1.1.3.cmml"><msub id="S5.SS2.p3.13.m7.1.1.3.2" xref="S5.SS2.p3.13.m7.1.1.3.2.cmml"><mi id="S5.SS2.p3.13.m7.1.1.3.2.2" xref="S5.SS2.p3.13.m7.1.1.3.2.2.cmml">T</mi><mrow id="S5.SS2.p3.13.m7.1.1.3.2.3" xref="S5.SS2.p3.13.m7.1.1.3.2.3.cmml"><mi id="S5.SS2.p3.13.m7.1.1.3.2.3.2" xref="S5.SS2.p3.13.m7.1.1.3.2.3.2.cmml">i</mi><mo id="S5.SS2.p3.13.m7.1.1.3.2.3.1" xref="S5.SS2.p3.13.m7.1.1.3.2.3.1.cmml">−</mo><mn id="S5.SS2.p3.13.m7.1.1.3.2.3.3" xref="S5.SS2.p3.13.m7.1.1.3.2.3.3.cmml">1</mn></mrow></msub><mo id="S5.SS2.p3.13.m7.1.1.3.1" xref="S5.SS2.p3.13.m7.1.1.3.1.cmml">+</mo><msub id="S5.SS2.p3.13.m7.1.1.3.3" xref="S5.SS2.p3.13.m7.1.1.3.3.cmml"><mi id="S5.SS2.p3.13.m7.1.1.3.3.2" xref="S5.SS2.p3.13.m7.1.1.3.3.2.cmml">S</mi><mi id="S5.SS2.p3.13.m7.1.1.3.3.3" xref="S5.SS2.p3.13.m7.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.13.m7.1b"><apply id="S5.SS2.p3.13.m7.1.1.cmml" xref="S5.SS2.p3.13.m7.1.1"><eq id="S5.SS2.p3.13.m7.1.1.1.cmml" xref="S5.SS2.p3.13.m7.1.1.1"></eq><apply id="S5.SS2.p3.13.m7.1.1.2.cmml" xref="S5.SS2.p3.13.m7.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.p3.13.m7.1.1.2.1.cmml" xref="S5.SS2.p3.13.m7.1.1.2">subscript</csymbol><ci id="S5.SS2.p3.13.m7.1.1.2.2.cmml" xref="S5.SS2.p3.13.m7.1.1.2.2">𝑇</ci><ci id="S5.SS2.p3.13.m7.1.1.2.3.cmml" xref="S5.SS2.p3.13.m7.1.1.2.3">𝑖</ci></apply><apply id="S5.SS2.p3.13.m7.1.1.3.cmml" xref="S5.SS2.p3.13.m7.1.1.3"><plus id="S5.SS2.p3.13.m7.1.1.3.1.cmml" xref="S5.SS2.p3.13.m7.1.1.3.1"></plus><apply id="S5.SS2.p3.13.m7.1.1.3.2.cmml" xref="S5.SS2.p3.13.m7.1.1.3.2"><csymbol cd="ambiguous" id="S5.SS2.p3.13.m7.1.1.3.2.1.cmml" xref="S5.SS2.p3.13.m7.1.1.3.2">subscript</csymbol><ci id="S5.SS2.p3.13.m7.1.1.3.2.2.cmml" xref="S5.SS2.p3.13.m7.1.1.3.2.2">𝑇</ci><apply id="S5.SS2.p3.13.m7.1.1.3.2.3.cmml" xref="S5.SS2.p3.13.m7.1.1.3.2.3"><minus id="S5.SS2.p3.13.m7.1.1.3.2.3.1.cmml" xref="S5.SS2.p3.13.m7.1.1.3.2.3.1"></minus><ci id="S5.SS2.p3.13.m7.1.1.3.2.3.2.cmml" xref="S5.SS2.p3.13.m7.1.1.3.2.3.2">𝑖</ci><cn id="S5.SS2.p3.13.m7.1.1.3.2.3.3.cmml" type="integer" xref="S5.SS2.p3.13.m7.1.1.3.2.3.3">1</cn></apply></apply><apply id="S5.SS2.p3.13.m7.1.1.3.3.cmml" xref="S5.SS2.p3.13.m7.1.1.3.3"><csymbol cd="ambiguous" id="S5.SS2.p3.13.m7.1.1.3.3.1.cmml" xref="S5.SS2.p3.13.m7.1.1.3.3">subscript</csymbol><ci id="S5.SS2.p3.13.m7.1.1.3.3.2.cmml" xref="S5.SS2.p3.13.m7.1.1.3.3.2">𝑆</ci><ci id="S5.SS2.p3.13.m7.1.1.3.3.3.cmml" xref="S5.SS2.p3.13.m7.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.13.m7.1c">T_{i}=T_{i-1}+S_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.13.m7.1d">italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_T start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT + italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and the new unvisited dataset <math alttext="D_{i}=D_{i-1}-S_{i}" class="ltx_Math" display="inline" id="S5.SS2.p3.14.m8.1"><semantics id="S5.SS2.p3.14.m8.1a"><mrow id="S5.SS2.p3.14.m8.1.1" xref="S5.SS2.p3.14.m8.1.1.cmml"><msub id="S5.SS2.p3.14.m8.1.1.2" xref="S5.SS2.p3.14.m8.1.1.2.cmml"><mi id="S5.SS2.p3.14.m8.1.1.2.2" xref="S5.SS2.p3.14.m8.1.1.2.2.cmml">D</mi><mi id="S5.SS2.p3.14.m8.1.1.2.3" xref="S5.SS2.p3.14.m8.1.1.2.3.cmml">i</mi></msub><mo id="S5.SS2.p3.14.m8.1.1.1" xref="S5.SS2.p3.14.m8.1.1.1.cmml">=</mo><mrow id="S5.SS2.p3.14.m8.1.1.3" xref="S5.SS2.p3.14.m8.1.1.3.cmml"><msub id="S5.SS2.p3.14.m8.1.1.3.2" xref="S5.SS2.p3.14.m8.1.1.3.2.cmml"><mi id="S5.SS2.p3.14.m8.1.1.3.2.2" xref="S5.SS2.p3.14.m8.1.1.3.2.2.cmml">D</mi><mrow id="S5.SS2.p3.14.m8.1.1.3.2.3" xref="S5.SS2.p3.14.m8.1.1.3.2.3.cmml"><mi id="S5.SS2.p3.14.m8.1.1.3.2.3.2" xref="S5.SS2.p3.14.m8.1.1.3.2.3.2.cmml">i</mi><mo id="S5.SS2.p3.14.m8.1.1.3.2.3.1" xref="S5.SS2.p3.14.m8.1.1.3.2.3.1.cmml">−</mo><mn id="S5.SS2.p3.14.m8.1.1.3.2.3.3" xref="S5.SS2.p3.14.m8.1.1.3.2.3.3.cmml">1</mn></mrow></msub><mo id="S5.SS2.p3.14.m8.1.1.3.1" xref="S5.SS2.p3.14.m8.1.1.3.1.cmml">−</mo><msub id="S5.SS2.p3.14.m8.1.1.3.3" xref="S5.SS2.p3.14.m8.1.1.3.3.cmml"><mi id="S5.SS2.p3.14.m8.1.1.3.3.2" xref="S5.SS2.p3.14.m8.1.1.3.3.2.cmml">S</mi><mi id="S5.SS2.p3.14.m8.1.1.3.3.3" xref="S5.SS2.p3.14.m8.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.14.m8.1b"><apply id="S5.SS2.p3.14.m8.1.1.cmml" xref="S5.SS2.p3.14.m8.1.1"><eq id="S5.SS2.p3.14.m8.1.1.1.cmml" xref="S5.SS2.p3.14.m8.1.1.1"></eq><apply id="S5.SS2.p3.14.m8.1.1.2.cmml" xref="S5.SS2.p3.14.m8.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.p3.14.m8.1.1.2.1.cmml" xref="S5.SS2.p3.14.m8.1.1.2">subscript</csymbol><ci id="S5.SS2.p3.14.m8.1.1.2.2.cmml" xref="S5.SS2.p3.14.m8.1.1.2.2">𝐷</ci><ci id="S5.SS2.p3.14.m8.1.1.2.3.cmml" xref="S5.SS2.p3.14.m8.1.1.2.3">𝑖</ci></apply><apply id="S5.SS2.p3.14.m8.1.1.3.cmml" xref="S5.SS2.p3.14.m8.1.1.3"><minus id="S5.SS2.p3.14.m8.1.1.3.1.cmml" xref="S5.SS2.p3.14.m8.1.1.3.1"></minus><apply id="S5.SS2.p3.14.m8.1.1.3.2.cmml" xref="S5.SS2.p3.14.m8.1.1.3.2"><csymbol cd="ambiguous" id="S5.SS2.p3.14.m8.1.1.3.2.1.cmml" xref="S5.SS2.p3.14.m8.1.1.3.2">subscript</csymbol><ci id="S5.SS2.p3.14.m8.1.1.3.2.2.cmml" xref="S5.SS2.p3.14.m8.1.1.3.2.2">𝐷</ci><apply id="S5.SS2.p3.14.m8.1.1.3.2.3.cmml" xref="S5.SS2.p3.14.m8.1.1.3.2.3"><minus id="S5.SS2.p3.14.m8.1.1.3.2.3.1.cmml" xref="S5.SS2.p3.14.m8.1.1.3.2.3.1"></minus><ci id="S5.SS2.p3.14.m8.1.1.3.2.3.2.cmml" xref="S5.SS2.p3.14.m8.1.1.3.2.3.2">𝑖</ci><cn id="S5.SS2.p3.14.m8.1.1.3.2.3.3.cmml" type="integer" xref="S5.SS2.p3.14.m8.1.1.3.2.3.3">1</cn></apply></apply><apply id="S5.SS2.p3.14.m8.1.1.3.3.cmml" xref="S5.SS2.p3.14.m8.1.1.3.3"><csymbol cd="ambiguous" id="S5.SS2.p3.14.m8.1.1.3.3.1.cmml" xref="S5.SS2.p3.14.m8.1.1.3.3">subscript</csymbol><ci id="S5.SS2.p3.14.m8.1.1.3.3.2.cmml" xref="S5.SS2.p3.14.m8.1.1.3.3.2">𝑆</ci><ci id="S5.SS2.p3.14.m8.1.1.3.3.3.cmml" xref="S5.SS2.p3.14.m8.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.14.m8.1c">D_{i}=D_{i-1}-S_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.14.m8.1d">italic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_D start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT - italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T2.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S5.T2.1.1.1.1" style="padding-left:2.5pt;padding-right:2.5pt;">Execution time(sec)</th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="S5.T2.1.1.1.2" style="padding-left:2.5pt;padding-right:2.5pt;">TPC-H</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="S5.T2.1.1.1.3" style="padding-left:2.5pt;padding-right:2.5pt;">IMDB</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="S5.T2.1.1.1.4" style="padding-left:2.5pt;padding-right:2.5pt;">DSB</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T2.1.2.2.1" style="padding-left:2.5pt;padding-right:2.5pt;">Method</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.2.2" style="padding-left:2.5pt;padding-right:2.5pt;">Mean</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.2.3" style="padding-left:2.5pt;padding-right:2.5pt;">Median</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.2.4" style="padding-left:2.5pt;padding-right:2.5pt;">75th</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.2.5" style="padding-left:2.5pt;padding-right:2.5pt;">95th</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.2.6" style="padding-left:2.5pt;padding-right:2.5pt;">Mean</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.2.7" style="padding-left:2.5pt;padding-right:2.5pt;">Median</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.2.8" style="padding-left:2.5pt;padding-right:2.5pt;">75th</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.2.9" style="padding-left:2.5pt;padding-right:2.5pt;">95th</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.2.10" style="padding-left:2.5pt;padding-right:2.5pt;">Mean</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.2.11" style="padding-left:2.5pt;padding-right:2.5pt;">Median</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.2.12" style="padding-left:2.5pt;padding-right:2.5pt;">75th</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.2.13" style="padding-left:2.5pt;padding-right:2.5pt;">95th</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S5.T2.1.3.3.1" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.3.3.1.1">Original</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.3.3.2" style="padding-left:2.5pt;padding-right:2.5pt;">70.90</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.3.3.3" style="padding-left:2.5pt;padding-right:2.5pt;">22.00</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.3.3.4" style="padding-left:2.5pt;padding-right:2.5pt;">37.01</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.3.3.5" style="padding-left:2.5pt;padding-right:2.5pt;">300.00</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.3.3.6" style="padding-left:2.5pt;padding-right:2.5pt;">6.99</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.3.3.7" style="padding-left:2.5pt;padding-right:2.5pt;">1.86</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.3.3.8" style="padding-left:2.5pt;padding-right:2.5pt;">5.12</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.3.3.9" style="padding-left:2.5pt;padding-right:2.5pt;">32.49</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.3.3.10" style="padding-left:2.5pt;padding-right:2.5pt;">60.55</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.3.3.11" style="padding-left:2.5pt;padding-right:2.5pt;">6.64</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.3.3.12" style="padding-left:2.5pt;padding-right:2.5pt;">26.55</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.3.3.13" style="padding-left:2.5pt;padding-right:2.5pt;">300.00</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.1.4.4.1" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.4.4.1.1">LR</span></th>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.4.2" style="padding-left:2.5pt;padding-right:2.5pt;">39.40</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.4.3" style="padding-left:2.5pt;padding-right:2.5pt;">22.00</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.4.4" style="padding-left:2.5pt;padding-right:2.5pt;">32.21</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.4.5" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.4.4.5.1">159.95</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.4.6" style="padding-left:2.5pt;padding-right:2.5pt;">6.20</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.4.7" style="padding-left:2.5pt;padding-right:2.5pt;">1.62</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.4.8" style="padding-left:2.5pt;padding-right:2.5pt;">4.74</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.4.9" style="padding-left:2.5pt;padding-right:2.5pt;">32.45</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.4.10" style="padding-left:2.5pt;padding-right:2.5pt;">59.21</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.4.11" style="padding-left:2.5pt;padding-right:2.5pt;">5.14</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.4.12" style="padding-left:2.5pt;padding-right:2.5pt;">53.78</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.4.13" style="padding-left:2.5pt;padding-right:2.5pt;">300.00</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.1.5.5.1" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.5.5.1.1">LLM only</span></th>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.5.2" style="padding-left:2.5pt;padding-right:2.5pt;">70.67</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.5.3" style="padding-left:2.5pt;padding-right:2.5pt;">22.00</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.5.4" style="padding-left:2.5pt;padding-right:2.5pt;">37.01</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.5.5" style="padding-left:2.5pt;padding-right:2.5pt;">300.00</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.5.6" style="padding-left:2.5pt;padding-right:2.5pt;">6.96</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.5.7" style="padding-left:2.5pt;padding-right:2.5pt;">1.86</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.5.8" style="padding-left:2.5pt;padding-right:2.5pt;">5.10</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.5.9" style="padding-left:2.5pt;padding-right:2.5pt;">32.49</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.5.10" style="padding-left:2.5pt;padding-right:2.5pt;">61.60</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.5.11" style="padding-left:2.5pt;padding-right:2.5pt;">6.53</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.5.12" style="padding-left:2.5pt;padding-right:2.5pt;">26.40</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.5.13" style="padding-left:2.5pt;padding-right:2.5pt;">300.00</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T2.1.6.6.1" style="padding-left:2.5pt;padding-right:2.5pt;">
<span class="ltx_text ltx_font_bold" id="S5.T2.1.6.6.1.1">LLM-R<sup class="ltx_sup" id="S5.T2.1.6.6.1.1.1">2</sup></span> (Ours)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.6.6.2" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.6.6.2.1">37.23</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.6.6.3" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.6.6.3.1">17.40</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.6.6.4" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.6.6.4.1">29.80</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.6.6.5" style="padding-left:2.5pt;padding-right:2.5pt;">164.12</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.6.6.6" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.6.6.6.1">3.91</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.6.6.7" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.6.6.7.1">1.33</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.6.6.8" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.6.6.8.1">3.52</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.6.6.9" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.6.6.9.1">18.16</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.6.6.10" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.6.6.10.1">24.11</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.6.6.11" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.6.6.11.1">2.16</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.6.6.12" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.6.6.12.1">12.61</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.6.6.13" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.6.6.13.1">196.61</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.1.7.7.1" style="padding-left:2.5pt;padding-right:2.5pt;">% of <span class="ltx_text ltx_font_bold" id="S5.T2.1.7.7.1.1">Original</span>
</th>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.7.2" style="padding-left:2.5pt;padding-right:2.5pt;">52.5%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.7.3" style="padding-left:2.5pt;padding-right:2.5pt;">79.1%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.7.4" style="padding-left:2.5pt;padding-right:2.5pt;">80.5%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.7.5" style="padding-left:2.5pt;padding-right:2.5pt;">54.7%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.7.6" style="padding-left:2.5pt;padding-right:2.5pt;">56.0%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.7.7" style="padding-left:2.5pt;padding-right:2.5pt;">71.3%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.7.8" style="padding-left:2.5pt;padding-right:2.5pt;">68.7%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.7.9" style="padding-left:2.5pt;padding-right:2.5pt;">55.9%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.7.10" style="padding-left:2.5pt;padding-right:2.5pt;">39.8%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.7.11" style="padding-left:2.5pt;padding-right:2.5pt;">32.5%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.7.12" style="padding-left:2.5pt;padding-right:2.5pt;">47.5%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.7.13" style="padding-left:2.5pt;padding-right:2.5pt;">65.5%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.1.8.8.1" style="padding-left:2.5pt;padding-right:2.5pt;">% of <span class="ltx_text ltx_font_bold" id="S5.T2.1.8.8.1.1">LR</span>
</th>
<td class="ltx_td ltx_align_center" id="S5.T2.1.8.8.2" style="padding-left:2.5pt;padding-right:2.5pt;">94.5%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.8.8.3" style="padding-left:2.5pt;padding-right:2.5pt;">79.1%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.8.8.4" style="padding-left:2.5pt;padding-right:2.5pt;">92.5%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.8.8.5" style="padding-left:2.5pt;padding-right:2.5pt;">102.6%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.8.8.6" style="padding-left:2.5pt;padding-right:2.5pt;">63.1%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.8.8.7" style="padding-left:2.5pt;padding-right:2.5pt;">82.0%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.8.8.8" style="padding-left:2.5pt;padding-right:2.5pt;">74.3%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.8.8.9" style="padding-left:2.5pt;padding-right:2.5pt;">56.0%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.8.8.10" style="padding-left:2.5pt;padding-right:2.5pt;">40.7%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.8.8.11" style="padding-left:2.5pt;padding-right:2.5pt;">42.0%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.8.8.12" style="padding-left:2.5pt;padding-right:2.5pt;">23.4%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.8.8.13" style="padding-left:2.5pt;padding-right:2.5pt;">65.5%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T2.1.9.9.1" style="padding-left:2.5pt;padding-right:2.5pt;">% of <span class="ltx_text ltx_font_bold" id="S5.T2.1.9.9.1.1">LLM only</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.9.9.2" style="padding-left:2.5pt;padding-right:2.5pt;">52.7%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.9.9.3" style="padding-left:2.5pt;padding-right:2.5pt;">79.1%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.9.9.4" style="padding-left:2.5pt;padding-right:2.5pt;">80.5%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.9.9.5" style="padding-left:2.5pt;padding-right:2.5pt;">54.7%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.9.9.6" style="padding-left:2.5pt;padding-right:2.5pt;">56.2%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.9.9.7" style="padding-left:2.5pt;padding-right:2.5pt;">71.3%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.9.9.8" style="padding-left:2.5pt;padding-right:2.5pt;">69.0%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.9.9.9" style="padding-left:2.5pt;padding-right:2.5pt;">55.9%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.9.9.10" style="padding-left:2.5pt;padding-right:2.5pt;">39.1%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.9.9.11" style="padding-left:2.5pt;padding-right:2.5pt;">33.1%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.9.9.12" style="padding-left:2.5pt;padding-right:2.5pt;">47.8%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.9.9.13" style="padding-left:2.5pt;padding-right:2.5pt;">65.5%</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2. </span>Execution time v.s. different query rewrite methods</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Experiment</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this section, we evaluate our proposed system’s effectiveness, efficiency, and generalization capabilities.</p>
</div>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1. </span>Experimental Setup</h3>
<section class="ltx_subsubsection" id="S6.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.1.1. </span>Dataset</h4>
<div class="ltx_para" id="S6.SS1.SSS1.p1">
<p class="ltx_p" id="S6.SS1.SSS1.p1.1">We use three datasets from different domains for our evaluations:</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS1.SSS1.p2">
<p class="ltx_p" id="S6.SS1.SSS1.p2.1"><span class="ltx_text ltx_font_bold" id="S6.SS1.SSS1.p2.1.1">IMDB (JOB workload) <cite class="ltx_cite ltx_citemacro_citep">(Leis et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib19" title="">2015</a>)</cite>:</span> The IMDB <cite class="ltx_cite ltx_citemacro_citep">(Maas et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib23" title="">2011</a>)</cite> dataset consists of data on movies, TV shows, and actors. It’s utilized in conjunction with the Join Order Benchmark (JOB) to test a database management system’s efficiency in executing complex join queries, and it comprises 5,000 queries.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS1.SSS1.p3">
<p class="ltx_p" id="S6.SS1.SSS1.p3.1"><span class="ltx_text ltx_font_bold" id="S6.SS1.SSS1.p3.1.1">TPC-H <cite class="ltx_cite ltx_citemacro_citep">(TPC, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib6" title="">[n.d.]</a>)</cite>:</span> A benchmark dataset for evaluating database management systems, generated using the official toolkit to include approximately 10 GB of data and 5,000 queries.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS1.SSS1.p4">
<p class="ltx_p" id="S6.SS1.SSS1.p4.1"><span class="ltx_text ltx_font_bold" id="S6.SS1.SSS1.p4.1.1">Decision Support Benchmark (DSB) <cite class="ltx_cite ltx_citemacro_citep">(Ding et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib12" title="">2021</a>)</cite>:</span> This benchmark is developed to evaluate traditional database systems for modern decision support workloads. It is modified from the TPC-DS to include complex data distributions and challenging query templates, and it contains a total of 2,000 queries.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S6.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.1.2. </span>Rewrite Rules</h4>
<div class="ltx_para" id="S6.SS1.SSS2.p1">
<p class="ltx_p" id="S6.SS1.SSS2.p1.1">To enhance the efficiency of the rule proposal and rewriting process for subsequent experiments, we integrate Apache Calcite <cite class="ltx_cite ltx_citemacro_citep">(Begoli et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib8" title="">2018</a>)</cite> as our rewrite platform, alongside its comprehensive set of rewrite rules by following previous work <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib36" title="">2021</a>)</cite>. Examples of utilized rewrite rules and their functions are illustrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S2.T1" title="Table 1 ‣ 2. Preliminary ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">1</span></a>, with a complete enumeration available on the official website <cite class="ltx_cite ltx_citemacro_citep">(org, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib2" title="">[n.d.]</a>)</cite>. Specifically, we introduce a rule termed “EMPTY” to signify instances where the query remains unchanged, thereby standardizing LLM outputs with an indicator for scenarios that do not require query rewrite.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S6.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.1.3. </span>LLM Setting</h4>
<div class="ltx_para" id="S6.SS1.SSS3.p1">
<p class="ltx_p" id="S6.SS1.SSS3.p1.1">We leverage the ChatGPT API <cite class="ltx_cite ltx_citemacro_citep">(cha, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib3" title="">[n.d.]</a>)</cite>, which is built upon the GPT-3.5-turbo architecture <cite class="ltx_cite ltx_citemacro_citep">(Brown et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib10" title="">2020</a>)</cite>. Furthermore, we assess our system’s generalizability across other Large Language Models (e.g., GPT-4), as detailed in Section <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.SS5" title="6.5. Ablation Studies ‣ 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">6.5</span></a>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S6.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.1.4. </span>Baseline Methods</h4>
<div class="ltx_para" id="S6.SS1.SSS4.p1">
<p class="ltx_p" id="S6.SS1.SSS4.p1.1">We compare our system with two baseline methods:</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS1.SSS4.p2">
<p class="ltx_p" id="S6.SS1.SSS4.p2.1"><span class="ltx_text ltx_font_bold" id="S6.SS1.SSS4.p2.1.1">Learned Rewrite (LR) <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib36" title="">2021</a>)</cite></span>: This approach, recognized as the state-of-the-art query rewrite method, incorporates a cost estimation model for predicting the performance of rewritten queries. It further employs a Monte Carlo Tree-based search algorithm to identify the optimal query.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS1.SSS4.p3">
<p class="ltx_p" id="S6.SS1.SSS4.p3.1"><span class="ltx_text ltx_font_bold" id="S6.SS1.SSS4.p3.1.1">LLM only <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib21" title="">2023a</a>)</cite></span>: This method straightforwardly generates a rewritten query from the input, incorporating task instructions, schema, and a fixed demonstration as prompts to the LLM. when the rewritten queries are not executable or equivalent to the original queries, we substitute them with the original queries. This ensures a fair comparison with rule-based methods.</p>
</div>
<figure class="ltx_table" id="S6.T3">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T3.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T3.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S6.T3.1.1.1.1" style="padding-left:2.5pt;padding-right:2.5pt;">Counts</th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S6.T3.1.1.1.2" style="padding-left:2.5pt;padding-right:2.5pt;">TPC-H/IMDB/DSB</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T3.1.2.2.1" style="padding-left:2.5pt;padding-right:2.5pt;">Method</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T3.1.2.2.2" style="padding-left:2.5pt;padding-right:2.5pt;">Rewrite #</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T3.1.2.2.3" style="padding-left:2.5pt;padding-right:2.5pt;">Improve #</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.2.2.4" style="padding-left:2.5pt;padding-right:2.5pt;">Improve %</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S6.T3.1.3.3.1" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.1.3.3.1.1">LR</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S6.T3.1.3.3.2" style="padding-left:2.5pt;padding-right:2.5pt;">258/203/<span class="ltx_text ltx_font_bold" id="S6.T3.1.3.3.2.1">456</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S6.T3.1.3.3.3" style="padding-left:2.5pt;padding-right:2.5pt;">192/197/193</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.1.3.3.4" style="padding-left:2.5pt;padding-right:2.5pt;">74.42/<span class="ltx_text ltx_font_bold" id="S6.T3.1.3.3.4.1">97.04</span>/42.32</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T3.1.4.4.1" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.1.4.4.1.1">LLM only</span></th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.1.4.4.2" style="padding-left:2.5pt;padding-right:2.5pt;">197/102/210</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.1.4.4.3" style="padding-left:2.5pt;padding-right:2.5pt;">68/67/8</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.4.4.4" style="padding-left:2.5pt;padding-right:2.5pt;">34.5/65.68/3.81</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S6.T3.1.5.5.1" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.1.5.5.1.1">LLM-R<sup class="ltx_sup" id="S6.T3.1.5.5.1.1.1">2</sup></span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S6.T3.1.5.5.2" style="padding-left:2.5pt;padding-right:2.5pt;">
<span class="ltx_text ltx_font_bold" id="S6.T3.1.5.5.2.1">323</span>/<span class="ltx_text ltx_font_bold" id="S6.T3.1.5.5.2.2">302</span>/341</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S6.T3.1.5.5.3" style="padding-left:2.5pt;padding-right:2.5pt;">
<span class="ltx_text ltx_font_bold" id="S6.T3.1.5.5.3.1">305</span>/<span class="ltx_text ltx_font_bold" id="S6.T3.1.5.5.3.2">292</span>/<span class="ltx_text ltx_font_bold" id="S6.T3.1.5.5.3.3">222</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T3.1.5.5.4" style="padding-left:2.5pt;padding-right:2.5pt;">
<span class="ltx_text ltx_font_bold" id="S6.T3.1.5.5.4.1">94.43</span>/96.69/<span class="ltx_text ltx_font_bold" id="S6.T3.1.5.5.4.2">65.10</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3. </span>The rewritten queries’ number v.s. different methods</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S6.SS1.SSS5">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.1.5. </span>Training Setting.</h4>
<div class="ltx_para" id="S6.SS1.SSS5.p1">
<p class="ltx_p" id="S6.SS1.SSS5.p1.3">In the demonstration preparation phase, we exclude any training queries already present in the demonstration pool from being selected as demonstrations to mitigate potential bias. For the development of our query representation-based demonstration selector, we adopt a curriculum learning strategy encompassing four iterations (<math alttext="I=4" class="ltx_Math" display="inline" id="S6.SS1.SSS5.p1.1.m1.1"><semantics id="S6.SS1.SSS5.p1.1.m1.1a"><mrow id="S6.SS1.SSS5.p1.1.m1.1.1" xref="S6.SS1.SSS5.p1.1.m1.1.1.cmml"><mi id="S6.SS1.SSS5.p1.1.m1.1.1.2" xref="S6.SS1.SSS5.p1.1.m1.1.1.2.cmml">I</mi><mo id="S6.SS1.SSS5.p1.1.m1.1.1.1" xref="S6.SS1.SSS5.p1.1.m1.1.1.1.cmml">=</mo><mn id="S6.SS1.SSS5.p1.1.m1.1.1.3" xref="S6.SS1.SSS5.p1.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS5.p1.1.m1.1b"><apply id="S6.SS1.SSS5.p1.1.m1.1.1.cmml" xref="S6.SS1.SSS5.p1.1.m1.1.1"><eq id="S6.SS1.SSS5.p1.1.m1.1.1.1.cmml" xref="S6.SS1.SSS5.p1.1.m1.1.1.1"></eq><ci id="S6.SS1.SSS5.p1.1.m1.1.1.2.cmml" xref="S6.SS1.SSS5.p1.1.m1.1.1.2">𝐼</ci><cn id="S6.SS1.SSS5.p1.1.m1.1.1.3.cmml" type="integer" xref="S6.SS1.SSS5.p1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS5.p1.1.m1.1c">I=4</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS5.p1.1.m1.1d">italic_I = 4</annotation></semantics></math>). Each iteration involves further training our contrastive representation model with a learning rate of <math alttext="10^{-5}" class="ltx_Math" display="inline" id="S6.SS1.SSS5.p1.2.m2.1"><semantics id="S6.SS1.SSS5.p1.2.m2.1a"><msup id="S6.SS1.SSS5.p1.2.m2.1.1" xref="S6.SS1.SSS5.p1.2.m2.1.1.cmml"><mn id="S6.SS1.SSS5.p1.2.m2.1.1.2" xref="S6.SS1.SSS5.p1.2.m2.1.1.2.cmml">10</mn><mrow id="S6.SS1.SSS5.p1.2.m2.1.1.3" xref="S6.SS1.SSS5.p1.2.m2.1.1.3.cmml"><mo id="S6.SS1.SSS5.p1.2.m2.1.1.3a" xref="S6.SS1.SSS5.p1.2.m2.1.1.3.cmml">−</mo><mn id="S6.SS1.SSS5.p1.2.m2.1.1.3.2" xref="S6.SS1.SSS5.p1.2.m2.1.1.3.2.cmml">5</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS5.p1.2.m2.1b"><apply id="S6.SS1.SSS5.p1.2.m2.1.1.cmml" xref="S6.SS1.SSS5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS5.p1.2.m2.1.1.1.cmml" xref="S6.SS1.SSS5.p1.2.m2.1.1">superscript</csymbol><cn id="S6.SS1.SSS5.p1.2.m2.1.1.2.cmml" type="integer" xref="S6.SS1.SSS5.p1.2.m2.1.1.2">10</cn><apply id="S6.SS1.SSS5.p1.2.m2.1.1.3.cmml" xref="S6.SS1.SSS5.p1.2.m2.1.1.3"><minus id="S6.SS1.SSS5.p1.2.m2.1.1.3.1.cmml" xref="S6.SS1.SSS5.p1.2.m2.1.1.3"></minus><cn id="S6.SS1.SSS5.p1.2.m2.1.1.3.2.cmml" type="integer" xref="S6.SS1.SSS5.p1.2.m2.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS5.p1.2.m2.1c">10^{-5}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS5.p1.2.m2.1d">10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math>, a batch size of <math alttext="8" class="ltx_Math" display="inline" id="S6.SS1.SSS5.p1.3.m3.1"><semantics id="S6.SS1.SSS5.p1.3.m3.1a"><mn id="S6.SS1.SSS5.p1.3.m3.1.1" xref="S6.SS1.SSS5.p1.3.m3.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS5.p1.3.m3.1b"><cn id="S6.SS1.SSS5.p1.3.m3.1.1.cmml" type="integer" xref="S6.SS1.SSS5.p1.3.m3.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS5.p1.3.m3.1c">8</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS5.p1.3.m3.1d">8</annotation></semantics></math>, over three epochs, utilizing a Tesla-V100-16GB GPU.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S6.SS1.SSS6">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.1.6. </span>Evaluation Metrics</h4>
<div class="ltx_para" id="S6.SS1.SSS6.p1">
<p class="ltx_p" id="S6.SS1.SSS6.p1.2">For the evaluation of rewrite methods, two key metrics are employed: <span class="ltx_text ltx_font_italic" id="S6.SS1.SSS6.p1.2.1">query execution time</span> and <span class="ltx_text ltx_font_italic" id="S6.SS1.SSS6.p1.2.2">rewrite latency</span>, which are respectively employed to evaluate the executing efficiency and the computational efficiency. To mitigate variability, each query is executed five times on a 16GB CPU device, with the average execution time calculated after excluding the highest and lowest values. To address the challenge posed by overly complex queries that exceed practical execution times, a maximum time limit of <math alttext="300" class="ltx_Math" display="inline" id="S6.SS1.SSS6.p1.1.m1.1"><semantics id="S6.SS1.SSS6.p1.1.m1.1a"><mn id="S6.SS1.SSS6.p1.1.m1.1.1" xref="S6.SS1.SSS6.p1.1.m1.1.1.cmml">300</mn><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS6.p1.1.m1.1b"><cn id="S6.SS1.SSS6.p1.1.m1.1.1.cmml" type="integer" xref="S6.SS1.SSS6.p1.1.m1.1.1">300</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS6.p1.1.m1.1c">300</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS6.p1.1.m1.1d">300</annotation></semantics></math> seconds is imposed, with any query exceeding this duration assigned a default execution time of <math alttext="300" class="ltx_Math" display="inline" id="S6.SS1.SSS6.p1.2.m2.1"><semantics id="S6.SS1.SSS6.p1.2.m2.1a"><mn id="S6.SS1.SSS6.p1.2.m2.1.1" xref="S6.SS1.SSS6.p1.2.m2.1.1.cmml">300</mn><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS6.p1.2.m2.1b"><cn id="S6.SS1.SSS6.p1.2.m2.1.1.cmml" type="integer" xref="S6.SS1.SSS6.p1.2.m2.1.1">300</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS6.p1.2.m2.1c">300</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS6.p1.2.m2.1d">300</annotation></semantics></math> seconds. This approach facilitates a broader range of experimental conditions. For assessing rewrite latency—the time required to complete a query rewrite—a custom Python script is utilized to invoke both rewrite methods, capturing the average rewrite latency across all test queries on the same hardware platform.</p>
</div>
<figure class="ltx_table" id="S6.T4">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T4.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T4.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T4.1.1.1.1">Total (Latency)</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.1.1.1.2">TPC-H</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.1.1.1.3">IMDB</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.1.1.4">DSB</td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S6.T4.1.2.2.1"><span class="ltx_text ltx_font_bold" id="S6.T4.1.2.2.1.1">LR</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S6.T4.1.2.2.2">40.98(1.58)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S6.T4.1.2.2.3">7.24(1.04)</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T4.1.2.2.4">60.99(1.78)</td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T4.1.3.3.1"><span class="ltx_text ltx_font_bold" id="S6.T4.1.3.3.1.1">LLM only</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.1.3.3.2">75.37(4.70)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.1.3.3.3">7.58(1.38)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.3.3.4">64.21(6.00)</td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S6.T4.1.4.4.1"><span class="ltx_text ltx_font_bold" id="S6.T4.1.4.4.1.1">LLM-R<sup class="ltx_sup" id="S6.T4.1.4.4.1.1.1">2</sup></span></th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T4.1.4.4.2">
<span class="ltx_text ltx_font_bold" id="S6.T4.1.4.4.2.1">40.63</span>(3.40)</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T4.1.4.4.3">
<span class="ltx_text ltx_font_bold" id="S6.T4.1.4.4.3.1">6.81</span>(2.90)</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S6.T4.1.4.4.4">
<span class="ltx_text ltx_font_bold" id="S6.T4.1.4.4.4.1">27.40</span>(3.29)</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4. </span>The rewrite performance in total average rewrite query execution time including the rewrite latency</figcaption>
</figure>
<figure class="ltx_table" id="S6.T5">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T5.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S6.T5.1.1.1.1">Execution time(sec)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S6.T5.1.1.1.2">Mean</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S6.T5.1.1.1.3">Median</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S6.T5.1.1.1.4">75th</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T5.1.1.1.5">95th</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T5.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S6.T5.1.2.1.1">Original</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S6.T5.1.2.1.2">6.99</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S6.T5.1.2.1.3">1.86</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S6.T5.1.2.1.4">5.12</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T5.1.2.1.5">32.49</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T5.1.3.2.1"><span class="ltx_text ltx_font_bold" id="S6.T5.1.3.2.1.1">LLM-R<sup class="ltx_sup" id="S6.T5.1.3.2.1.1.1">2</sup></span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T5.1.3.2.2"><span class="ltx_text ltx_font_bold" id="S6.T5.1.3.2.2.1">4.41</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T5.1.3.2.3"><span class="ltx_text ltx_font_bold" id="S6.T5.1.3.2.3.1">1.35</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T5.1.3.2.4"><span class="ltx_text ltx_font_bold" id="S6.T5.1.3.2.4.1">3.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.3.2.5"><span class="ltx_text ltx_font_bold" id="S6.T5.1.3.2.5.1">17.84</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T5.1.4.3.1"><span class="ltx_text ltx_font_bold" id="S6.T5.1.4.3.1.1">LR</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T5.1.4.3.2">-</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T5.1.4.3.3">-</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T5.1.4.3.4">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.4.3.5">-</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S6.T5.1.5.4.1"><span class="ltx_text ltx_font_bold" id="S6.T5.1.5.4.1.1">LLM only</span></th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T5.1.5.4.2">6.99</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T5.1.5.4.3">1.86</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T5.1.5.4.4">5.12</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S6.T5.1.5.4.5">32.49</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5. </span>Training on TPC-H and Testing on IMDB</figcaption>
</figure>
<figure class="ltx_table" id="S6.T6">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T6.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T6.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T6.1.1.1.1" style="padding-left:2.5pt;padding-right:2.5pt;">Execution time(sec)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S6.T6.1.1.1.2" style="padding-left:2.5pt;padding-right:2.5pt;">TPC-H 1G</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S6.T6.1.1.1.3" style="padding-left:2.5pt;padding-right:2.5pt;">TPC-H 5G</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S6.T6.1.1.1.4" style="padding-left:2.5pt;padding-right:2.5pt;">TPC-H 10G</th>
</tr>
<tr class="ltx_tr" id="S6.T6.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S6.T6.1.2.2.1" style="padding-left:2.5pt;padding-right:2.5pt;">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.2.2.2" style="padding-left:2.5pt;padding-right:2.5pt;">Mean</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.2.2.3" style="padding-left:2.5pt;padding-right:2.5pt;">Median</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.2.2.4" style="padding-left:2.5pt;padding-right:2.5pt;">75th</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.2.2.5" style="padding-left:2.5pt;padding-right:2.5pt;">95th</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.2.2.6" style="padding-left:2.5pt;padding-right:2.5pt;">Mean</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.2.2.7" style="padding-left:2.5pt;padding-right:2.5pt;">Median</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.2.2.8" style="padding-left:2.5pt;padding-right:2.5pt;">75th</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.2.2.9" style="padding-left:2.5pt;padding-right:2.5pt;">95th</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.2.2.10" style="padding-left:2.5pt;padding-right:2.5pt;">Mean</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.2.2.11" style="padding-left:2.5pt;padding-right:2.5pt;">Median</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.2.2.12" style="padding-left:2.5pt;padding-right:2.5pt;">75th</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.2.2.13" style="padding-left:2.5pt;padding-right:2.5pt;">95th</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T6.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S6.T6.1.3.1.1" style="padding-left:2.5pt;padding-right:2.5pt;">Original</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T6.1.3.1.2" style="padding-left:2.5pt;padding-right:2.5pt;">52.02</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T6.1.3.1.3" style="padding-left:2.5pt;padding-right:2.5pt;">0.57</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T6.1.3.1.4" style="padding-left:2.5pt;padding-right:2.5pt;">1.39</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T6.1.3.1.5" style="padding-left:2.5pt;padding-right:2.5pt;">300.00</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T6.1.3.1.6" style="padding-left:2.5pt;padding-right:2.5pt;">53.90</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T6.1.3.1.7" style="padding-left:2.5pt;padding-right:2.5pt;">3.27</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T6.1.3.1.8" style="padding-left:2.5pt;padding-right:2.5pt;">11.53</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T6.1.3.1.9" style="padding-left:2.5pt;padding-right:2.5pt;">300.00</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T6.1.3.1.10" style="padding-left:2.5pt;padding-right:2.5pt;">70.90</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T6.1.3.1.11" style="padding-left:2.5pt;padding-right:2.5pt;">22.00</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T6.1.3.1.12" style="padding-left:2.5pt;padding-right:2.5pt;">37.01</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T6.1.3.1.13" style="padding-left:2.5pt;padding-right:2.5pt;">300.00</td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T6.1.4.2.1" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.4.2.1.1">LLM-R<sup class="ltx_sup" id="S6.T6.1.4.2.1.1.1">2</sup></span></th>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.2.2" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.4.2.2.1">15.19</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.2.3" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.4.2.3.1">0.56</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.2.4" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.4.2.4.1">1.14</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.2.5" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.4.2.5.1">55.20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.2.6" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.4.2.6.1">19.34</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.2.7" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.4.2.7.1">3.20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.2.8" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.4.2.8.1">7.97</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.2.9" style="padding-left:2.5pt;padding-right:2.5pt;">34.70</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.2.10" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.4.2.10.1">37.23</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.2.11" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.4.2.11.1">17.40</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.2.12" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.4.2.12.1">29.80</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.2.13" style="padding-left:2.5pt;padding-right:2.5pt;">164.12</td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T6.1.5.3.1" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.5.3.1.1">LR</span></th>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.3.2" style="padding-left:2.5pt;padding-right:2.5pt;">25.40</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.3.3" style="padding-left:2.5pt;padding-right:2.5pt;">0.57</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.3.4" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.5.3.4.1">1.14</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.3.5" style="padding-left:2.5pt;padding-right:2.5pt;">213.81</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.3.6" style="padding-left:2.5pt;padding-right:2.5pt;">20.10</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.3.7" style="padding-left:2.5pt;padding-right:2.5pt;">4.02</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.3.8" style="padding-left:2.5pt;padding-right:2.5pt;">9.02</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.3.9" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.5.3.9.1">32.14</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.3.10" style="padding-left:2.5pt;padding-right:2.5pt;">39.40</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.3.11" style="padding-left:2.5pt;padding-right:2.5pt;">22.00</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.3.12" style="padding-left:2.5pt;padding-right:2.5pt;">37.21</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.3.13" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.5.3.13.1">159.95</span></td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S6.T6.1.6.4.1" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.6.4.1.1">LLM only</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.6.4.2" style="padding-left:2.5pt;padding-right:2.5pt;">52.73</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.6.4.3" style="padding-left:2.5pt;padding-right:2.5pt;">2.14</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.6.4.4" style="padding-left:2.5pt;padding-right:2.5pt;">4.49</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.6.4.5" style="padding-left:2.5pt;padding-right:2.5pt;">300.00</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.6.4.6" style="padding-left:2.5pt;padding-right:2.5pt;">54.13</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.6.4.7" style="padding-left:2.5pt;padding-right:2.5pt;">3.62</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.6.4.8" style="padding-left:2.5pt;padding-right:2.5pt;">11.56</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.6.4.9" style="padding-left:2.5pt;padding-right:2.5pt;">300.00</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.6.4.10" style="padding-left:2.5pt;padding-right:2.5pt;">70.67</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.6.4.11" style="padding-left:2.5pt;padding-right:2.5pt;">22.00</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.6.4.12" style="padding-left:2.5pt;padding-right:2.5pt;">37.01</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.6.4.13" style="padding-left:2.5pt;padding-right:2.5pt;">300.00</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6. </span>Execution time v.s. different data scales.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2. </span>Executing Efficiency Evaluation</h3>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.1">As presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S5.T2" title="Table 2 ‣ 5.2. Curriculum Learning Pipeline ‣ 5. Demonstration Selection ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">2</span></a>, our study conducts a comparative analysis between our proposed method <span class="ltx_text ltx_font_bold" id="S6.SS2.p1.1.1">LLM-R<sup class="ltx_sup" id="S6.SS2.p1.1.1.1">2</sup></span> and two baseline methods. We meticulously document the mean, median, 75th percentile, and 95th percentile values of execution times to provide a comprehensive performance evaluation. The mean and median offer insights into the general efficacy of the methods across the datasets, whereas the 75th and 95th percentiles facilitate an understanding of the methods’ behavior for long tail cases. Our analysis yields several key observations:</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS2.p2">
<p class="ltx_p" id="S6.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S6.SS2.p2.1.1">(1)</span> <span class="ltx_text ltx_font_bold" id="S6.SS2.p2.1.2">LLM-R<sup class="ltx_sup" id="S6.SS2.p2.1.2.1">2</sup></span> demonstrates superior reduction of query execution time, outshining all baseline methods across the three datasets. Specifically on the TPC-H, IMDB and DSB datasets, <span class="ltx_text ltx_font_bold" id="S6.SS2.p2.1.3">LLM-R<sup class="ltx_sup" id="S6.SS2.p2.1.3.1">2</sup></span> reduces the execution time of the queries on average to 94.5%, 63.1% and 40.7% of the queries rewritten by baseline method <span class="ltx_text ltx_font_bold" id="S6.SS2.p2.1.4">LR</span>, 52.7%, 56.0% and 33.1% relative to <span class="ltx_text ltx_font_bold" id="S6.SS2.p2.1.5">LLM only</span>, and even further 52.5%, 56.0% and 39.8% compared to the original query. This performance enhancement is attributed to the optimization of demonstration selection for prompting the LLM-enhanced rewrite system, enabling <span class="ltx_text ltx_font_bold" id="S6.SS2.p2.1.6">LLM-R<sup class="ltx_sup" id="S6.SS2.p2.1.6.1">2</sup></span> to suggest superior rewrite rules. Furthermore, leveraging an LLM-enhanced system, <span class="ltx_text ltx_font_bold" id="S6.SS2.p2.1.7">LLM-R<sup class="ltx_sup" id="S6.SS2.p2.1.7.1">2</sup></span> offers more adaptable rule suggestions and better tailors these to the input query than does the <span class="ltx_text ltx_font_bold" id="S6.SS2.p2.1.8">LR</span> baseline.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS2.p3">
<p class="ltx_p" id="S6.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S6.SS2.p3.1.1">(2)</span> The margin of improvement over <span class="ltx_text ltx_font_bold" id="S6.SS2.p3.1.2">LR</span> is notably greater in the IMDB and DSB datasets than in the TPC-H dataset. This discrepancy stems from two factors. First, TPC-H is also the mainly analysed dataset in <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib36" title="">2021</a>)</cite> for <span class="ltx_text ltx_font_bold" id="S6.SS2.p3.1.3">LR</span>. Most of the effective rewrite rules for TPC-H queries can already be applied by <span class="ltx_text ltx_font_bold" id="S6.SS2.p3.1.4">LR</span>, leaving <span class="ltx_text ltx_font_bold" id="S6.SS2.p3.1.5">LLM-R<sup class="ltx_sup" id="S6.SS2.p3.1.5.1">2</sup></span> with limited scope for further enhancements. Second, the TPC-H dataset’s reliance on only 22 query templates results in a lack of query diversity, thus constraining the full demonstration of <span class="ltx_text ltx_font_bold" id="S6.SS2.p3.1.6">LLM-R<sup class="ltx_sup" id="S6.SS2.p3.1.6.1">2</sup></span>’s superiority utilizing LLM generalisation and reasoning abilities.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS2.p4">
<p class="ltx_p" id="S6.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="S6.SS2.p4.1.1">(3)</span> <span class="ltx_text ltx_font_bold" id="S6.SS2.p4.1.2">LR</span>’s under-performance in the DSB dataset can be attributed to its design limitations adopting a greedy search algorithm. The DSB dataset, being entirely new and unmet for <span class="ltx_text ltx_font_bold" id="S6.SS2.p4.1.3">LR</span>, poses unique challenges. Moreover, the Monte Carlo tree search algorithm employed by <span class="ltx_text ltx_font_bold" id="S6.SS2.p4.1.4">LR</span>, with its greedy search strategy that retains only a select few best options at each step, struggles with the dataset’s complex and expensive query trees. This limitation makes it difficult for the algorithm to select the most effective rules, to which explains its poor performance in handling the DSB dataset’s demands.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS2.p5">
<p class="ltx_p" id="S6.SS2.p5.1"><span class="ltx_text ltx_font_bold" id="S6.SS2.p5.1.1">(4)</span> <span class="ltx_text ltx_font_bold" id="S6.SS2.p5.1.2">LLM only</span> has the worst performance. We observe that LLMs struggle to effectively address the query rewrite challenge, and has only marginal reductions in mean cost on the TPC-H dataset and median cost on the DSB dataset. Given that non-executable or non-equivalent rewrite attempts are categorized as ’no rewrite,’ many rewritten queries are the same as the original queries across the datasets.</p>
</div>
<div class="ltx_para" id="S6.SS2.p6">
<p class="ltx_p" id="S6.SS2.p6.1">Furthermore, we evaluate the performance by collecting statistics on the number of successful rewrites performed by each method across three datasets. As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.T3" title="Table 3 ‣ 6.1.4. Baseline Methods ‣ 6.1. Experimental Setup ‣ 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">3</span></a>, we observe that:</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS2.p7">
<p class="ltx_p" id="S6.SS2.p7.1"><span class="ltx_text ltx_font_bold" id="S6.SS2.p7.1.1">(1)</span> <span class="ltx_text ltx_font_bold" id="S6.SS2.p7.1.2">LLM-R<sup class="ltx_sup" id="S6.SS2.p7.1.2.1">2</sup></span> excels by having the most efficiency-enhancing rewrites, achieving the largest improvement percentage upon rewriting. Compared to the baseline, <span class="ltx_text ltx_font_bold" id="S6.SS2.p7.1.3">LLM-R<sup class="ltx_sup" id="S6.SS2.p7.1.3.1">2</sup></span> has both a higher number of rewrites and a significant improvement in query execution efficiency across all the evaluated datasets.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS2.p8">
<p class="ltx_p" id="S6.SS2.p8.1"><span class="ltx_text ltx_font_bold" id="S6.SS2.p8.1.1">(2)</span> <span class="ltx_text ltx_font_bold" id="S6.SS2.p8.1.2">LLM only</span> fails in most of its rewrite attempts. We look into the rewrites which do not return the same results as the original queries in the TPC-H dataset, 119 of the total 129 queries are either not consistent with the original one or have errors to execute. Similarly, 193 of the 202 attempts to rewrite failed in the DSB dataset, since the DSB queries and schema would be too complicated for the LLM. This observation aligns with the results in <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib21" title="">2023a</a>)</cite>, in which the text-to-SQL task only achieved around 40% accuracy with carefully designed prompts. Although the IMDB dataset is simpler compared to TPC-H and DSB datasets, where <span class="ltx_text ltx_font_bold" id="S6.SS2.p8.1.3">LLM only</span> only fails 31 of the total 102 attempts, the LLM makes limited effective rewrites due to lack of database and query structure knowledge. In contrast, our <span class="ltx_text ltx_font_bold" id="S6.SS2.p8.1.4">LLM-R<sup class="ltx_sup" id="S6.SS2.p8.1.4.1">2</sup></span>, which benefits from both the reasoning ability of LLM and the rewrite ability of database platforms, is able to rewrite more queries successfully and have as higher rewrite improvement rate across all the datasets.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3. </span>Computational Efficiency Evaluation</h3>
<div class="ltx_para" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.1">To evaluate the computational efficiency, we rigorously assess the average rewrite latency for input queries across all datasets for the <span class="ltx_text ltx_font_bold" id="S6.SS3.p1.1.1">LLM-R<sup class="ltx_sup" id="S6.SS3.p1.1.1.1">2</sup></span> framework as well as the <span class="ltx_text ltx_font_bold" id="S6.SS3.p1.1.2">LR</span> and <span class="ltx_text ltx_font_bold" id="S6.SS3.p1.1.3">LLM only</span> baselines. Moreover, to ascertain if query time reduction adequately compensates for the rewriting latency, we combine the execution cost and rewrite latency to formulate a comprehensive metric. As delineated in Table <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.T4" title="Table 4 ‣ 6.1.6. Evaluation Metrics ‣ 6.1. Experimental Setup ‣ 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">4</span></a>, our analysis yields significant insights:</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS3.p2">
<p class="ltx_p" id="S6.SS3.p2.1"><span class="ltx_text ltx_font_bold" id="S6.SS3.p2.1.1">(1)</span> <span class="ltx_text ltx_font_bold" id="S6.SS3.p2.1.2">LLM-R<sup class="ltx_sup" id="S6.SS3.p2.1.2.1">2</sup></span> incurs additional latency compared to <span class="ltx_text ltx_font_bold" id="S6.SS3.p2.1.3">LR</span>, specifically requiring an average of 1.82, 1.86, and 1.51 seconds more to rewrite queries from the TPC-H, IMDB, and DSB datasets, respectively. This heightened latency is due to our system’s complexity. Notably, <span class="ltx_text ltx_font_bold" id="S6.SS3.p2.1.4">LLM-R<sup class="ltx_sup" id="S6.SS3.p2.1.4.1">2</sup></span> employs a demonstration selection model and leverages the online LLM API, which together account for the increased rewrite latency.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS3.p3">
<p class="ltx_p" id="S6.SS3.p3.1"><span class="ltx_text ltx_font_bold" id="S6.SS3.p3.1.1">(2)</span> However, the increased rewrite latency in our system <span class="ltx_text ltx_font_bold" id="S6.SS3.p3.1.2">LLM-R<sup class="ltx_sup" id="S6.SS3.p3.1.2.1">2</sup></span> is justifiable given that the sum of rewrite latency and execution time is lower than that of baseline methods, especially for the most complicated DSB queries. This indicates that the complex queries benefit more from our method.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS3.p4">
<p class="ltx_p" id="S6.SS3.p4.1"><span class="ltx_text ltx_font_bold" id="S6.SS3.p4.1.1">(3)</span> The <span class="ltx_text ltx_font_bold" id="S6.SS3.p4.1.2">LLM only</span> approach exhibits considerable latency as the LLM endeavors to directly generate a rewritten query, underscoring the complexity of direct SQL query generation for LLMs. This latency becomes more pronounced with the complexity of the query and database, notably in the TPC-H and DSB datasets. The comparison between our <span class="ltx_text ltx_font_bold" id="S6.SS3.p4.1.3">LLM-R<sup class="ltx_sup" id="S6.SS3.p4.1.3.1">2</sup></span> framework and the <span class="ltx_text ltx_font_bold" id="S6.SS3.p4.1.4">LLM only</span> approach demonstrates that our methodology, which focuses on generating rewrite rules, is more effectively processed by LLMs.</p>
</div>
<figure class="ltx_table" id="S6.T7">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T7.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T7.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T7.1.1.1.1" style="padding-left:2.5pt;padding-right:2.5pt;">Execution time(sec)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S6.T7.1.1.1.2" style="padding-left:2.5pt;padding-right:2.5pt;">TPC-H</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S6.T7.1.1.1.3" style="padding-left:2.5pt;padding-right:2.5pt;">IMDB</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S6.T7.1.1.1.4" style="padding-left:2.5pt;padding-right:2.5pt;">DSB</th>
</tr>
<tr class="ltx_tr" id="S6.T7.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S6.T7.1.2.2.1" style="padding-left:2.5pt;padding-right:2.5pt;">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T7.1.2.2.2" style="padding-left:2.5pt;padding-right:2.5pt;">Mean</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T7.1.2.2.3" style="padding-left:2.5pt;padding-right:2.5pt;">Median</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T7.1.2.2.4" style="padding-left:2.5pt;padding-right:2.5pt;">75th</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T7.1.2.2.5" style="padding-left:2.5pt;padding-right:2.5pt;">95th</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T7.1.2.2.6" style="padding-left:2.5pt;padding-right:2.5pt;">Mean</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T7.1.2.2.7" style="padding-left:2.5pt;padding-right:2.5pt;">Median</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T7.1.2.2.8" style="padding-left:2.5pt;padding-right:2.5pt;">75th</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T7.1.2.2.9" style="padding-left:2.5pt;padding-right:2.5pt;">95th</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T7.1.2.2.10" style="padding-left:2.5pt;padding-right:2.5pt;">Mean</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T7.1.2.2.11" style="padding-left:2.5pt;padding-right:2.5pt;">Median</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T7.1.2.2.12" style="padding-left:2.5pt;padding-right:2.5pt;">75th</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T7.1.2.2.13" style="padding-left:2.5pt;padding-right:2.5pt;">95th</th>
</tr>
<tr class="ltx_tr" id="S6.T7.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T7.1.3.3.1" style="padding-left:2.5pt;padding-right:2.5pt;">Original</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.1.3.3.2" style="padding-left:2.5pt;padding-right:2.5pt;">70.90</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.1.3.3.3" style="padding-left:2.5pt;padding-right:2.5pt;">22.00</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.1.3.3.4" style="padding-left:2.5pt;padding-right:2.5pt;">37.01</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.1.3.3.5" style="padding-left:2.5pt;padding-right:2.5pt;">300.00</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.1.3.3.6" style="padding-left:2.5pt;padding-right:2.5pt;">6.99</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.1.3.3.7" style="padding-left:2.5pt;padding-right:2.5pt;">1.86</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.1.3.3.8" style="padding-left:2.5pt;padding-right:2.5pt;">5.12</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.1.3.3.9" style="padding-left:2.5pt;padding-right:2.5pt;">32.49</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.1.3.3.10" style="padding-left:2.5pt;padding-right:2.5pt;">60.55</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.1.3.3.11" style="padding-left:2.5pt;padding-right:2.5pt;">6.64</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.1.3.3.12" style="padding-left:2.5pt;padding-right:2.5pt;">26.55</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.1.3.3.13" style="padding-left:2.5pt;padding-right:2.5pt;">300.00</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T7.1.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T7.1.4.1.1" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T7.1.4.1.1.1">Zero-shot</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.4.1.2" style="padding-left:2.5pt;padding-right:2.5pt;">46.15</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.4.1.3" style="padding-left:2.5pt;padding-right:2.5pt;">21.95</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.4.1.4" style="padding-left:2.5pt;padding-right:2.5pt;">33.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.4.1.5" style="padding-left:2.5pt;padding-right:2.5pt;">300.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.4.1.6" style="padding-left:2.5pt;padding-right:2.5pt;">6.98</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.4.1.7" style="padding-left:2.5pt;padding-right:2.5pt;">1.85</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.4.1.8" style="padding-left:2.5pt;padding-right:2.5pt;">5.12</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.4.1.9" style="padding-left:2.5pt;padding-right:2.5pt;">32.49</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.4.1.10" style="padding-left:2.5pt;padding-right:2.5pt;">34.53</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.4.1.11" style="padding-left:2.5pt;padding-right:2.5pt;">3.35</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.4.1.12" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T7.1.4.1.12.1">11.52</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.4.1.13" style="padding-left:2.5pt;padding-right:2.5pt;">300.00</td>
</tr>
<tr class="ltx_tr" id="S6.T7.1.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T7.1.5.2.1" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T7.1.5.2.1.1">Random</span></th>
<td class="ltx_td ltx_align_center" id="S6.T7.1.5.2.2" style="padding-left:2.5pt;padding-right:2.5pt;">40.50</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.5.2.3" style="padding-left:2.5pt;padding-right:2.5pt;">21.63</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.5.2.4" style="padding-left:2.5pt;padding-right:2.5pt;">32.22</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.5.2.5" style="padding-left:2.5pt;padding-right:2.5pt;">165.63</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.5.2.6" style="padding-left:2.5pt;padding-right:2.5pt;">5.45</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.5.2.7" style="padding-left:2.5pt;padding-right:2.5pt;">1.70</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.5.2.8" style="padding-left:2.5pt;padding-right:2.5pt;">4.50</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.5.2.9" style="padding-left:2.5pt;padding-right:2.5pt;">25.03</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.5.2.10" style="padding-left:2.5pt;padding-right:2.5pt;">45.88</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.5.2.11" style="padding-left:2.5pt;padding-right:2.5pt;">5.43</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.5.2.12" style="padding-left:2.5pt;padding-right:2.5pt;">17.41</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.5.2.13" style="padding-left:2.5pt;padding-right:2.5pt;">300.00</td>
</tr>
<tr class="ltx_tr" id="S6.T7.1.6.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T7.1.6.3.1" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T7.1.6.3.1.1">Tree</span></th>
<td class="ltx_td ltx_align_center" id="S6.T7.1.6.3.2" style="padding-left:2.5pt;padding-right:2.5pt;">39.21</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.6.3.3" style="padding-left:2.5pt;padding-right:2.5pt;">18.97</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.6.3.4" style="padding-left:2.5pt;padding-right:2.5pt;">30.89</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.6.3.5" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T7.1.6.3.5.1">164.10</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.6.3.6" style="padding-left:2.5pt;padding-right:2.5pt;">4.40</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.6.3.7" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T7.1.6.3.7.1">1.24</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.6.3.8" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T7.1.6.3.8.1">3.40</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.6.3.9" style="padding-left:2.5pt;padding-right:2.5pt;">18.89</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.6.3.10" style="padding-left:2.5pt;padding-right:2.5pt;">26.10</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.6.3.11" style="padding-left:2.5pt;padding-right:2.5pt;">3.86</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.6.3.12" style="padding-left:2.5pt;padding-right:2.5pt;">13.54</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.6.3.13" style="padding-left:2.5pt;padding-right:2.5pt;">240.74</td>
</tr>
<tr class="ltx_tr" id="S6.T7.1.7.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T7.1.7.4.1" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T7.1.7.4.1.1">SentTrans</span></th>
<td class="ltx_td ltx_align_center" id="S6.T7.1.7.4.2" style="padding-left:2.5pt;padding-right:2.5pt;">40.19</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.7.4.3" style="padding-left:2.5pt;padding-right:2.5pt;">19.21</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.7.4.4" style="padding-left:2.5pt;padding-right:2.5pt;">32.21</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.7.4.5" style="padding-left:2.5pt;padding-right:2.5pt;">164.99</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.7.4.6" style="padding-left:2.5pt;padding-right:2.5pt;">6.05</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.7.4.7" style="padding-left:2.5pt;padding-right:2.5pt;">1.70</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.7.4.8" style="padding-left:2.5pt;padding-right:2.5pt;">4.49</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.7.4.9" style="padding-left:2.5pt;padding-right:2.5pt;">30.01</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.7.4.10" style="padding-left:2.5pt;padding-right:2.5pt;">24.68</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.7.4.11" style="padding-left:2.5pt;padding-right:2.5pt;">3.95</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.7.4.12" style="padding-left:2.5pt;padding-right:2.5pt;">13.18</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.7.4.13" style="padding-left:2.5pt;padding-right:2.5pt;">197.23</td>
</tr>
<tr class="ltx_tr" id="S6.T7.1.8.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S6.T7.1.8.5.1" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T7.1.8.5.1.1">LLM-R<sup class="ltx_sup" id="S6.T7.1.8.5.1.1.1">2</sup></span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T7.1.8.5.2" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T7.1.8.5.2.1">37.23</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T7.1.8.5.3" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T7.1.8.5.3.1">17.40</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T7.1.8.5.4" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T7.1.8.5.4.1">29.80</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T7.1.8.5.5" style="padding-left:2.5pt;padding-right:2.5pt;">164.12</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T7.1.8.5.6" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T7.1.8.5.6.1">3.91</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T7.1.8.5.7" style="padding-left:2.5pt;padding-right:2.5pt;">1.33</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T7.1.8.5.8" style="padding-left:2.5pt;padding-right:2.5pt;">3.52</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T7.1.8.5.9" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T7.1.8.5.9.1">18.16</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T7.1.8.5.10" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T7.1.8.5.10.1">24.11</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T7.1.8.5.11" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T7.1.8.5.11.1">2.16</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T7.1.8.5.12" style="padding-left:2.5pt;padding-right:2.5pt;">12.61</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T7.1.8.5.13" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T7.1.8.5.13.1">196.61</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 7. </span>Execution time v.s. different selection approaches.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.4. </span>Robustness Evaluation</h3>
<div class="ltx_para" id="S6.SS4.p1">
<p class="ltx_p" id="S6.SS4.p1.1">We next evaluate the robustness of our <span class="ltx_text ltx_font_bold" id="S6.SS4.p1.1.1">LLM-R<sup class="ltx_sup" id="S6.SS4.p1.1.1.1">2</sup></span> framework, focusing on two critical dimensions: transferability and flexibility. Transferability evaluates the system’s ability to generalize across diverse datasets, while flexibility examines whether <span class="ltx_text ltx_font_bold" id="S6.SS4.p1.1.2">LLM-R<sup class="ltx_sup" id="S6.SS4.p1.1.2.1">2</sup></span> maintains its high performance as the volume of data increases. These aspects are crucial for understanding the adaptability and efficiency of <span class="ltx_text ltx_font_bold" id="S6.SS4.p1.1.3">LLM-R<sup class="ltx_sup" id="S6.SS4.p1.1.3.1">2</sup></span> in varied environments.</p>
</div>
<section class="ltx_subsubsection" id="S6.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.4.1. </span>Transferability across different datasets</h4>
<div class="ltx_para" id="S6.SS4.SSS1.p1">
<p class="ltx_p" id="S6.SS4.SSS1.p1.1">In order to evaluate our method’s transferability, we used the demonstration selection model trained on the TPC-H dataset to rewrite queries in the IMDB dataset. As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.T5" title="Table 5 ‣ 6.1.6. Evaluation Metrics ‣ 6.1. Experimental Setup ‣ 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">5</span></a>, the results reveal our method’s transferred performance is comparable with the in-distribution trained method and highly superior over <span class="ltx_text ltx_font_bold" id="S6.SS4.SSS1.p1.1.1">LLM only</span> when applied to a different dataset. <span class="ltx_text ltx_font_bold" id="S6.SS4.SSS1.p1.1.2">LLM only</span> fails to make effective rewrites given the fixed demonstration from the TPC-H dataset, where most rewrites lead to meaningless changes like removing table alias. Since <span class="ltx_text ltx_font_bold" id="S6.SS4.SSS1.p1.1.3">LR</span>’s cost model lacks cross-dataset transfer capability, its results are not available. These findings suggest the potential to develop a robust model by combining multiple datasets, enhancing its ability to address a wide array of unseen queries and datasets.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S6.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.4.2. </span>Flexibility across different data scales</h4>
<div class="ltx_para" id="S6.SS4.SSS2.p1">
<p class="ltx_p" id="S6.SS4.SSS2.p1.1">To further analyse the flexibility of our method, we regenerate the TPC-H dataset using different scale factors. We additionally generate TPC-H dataset using scale factor 1 (around 1GB data) and 5 (around 5GB data) apart from 10 in the main results to simulate a change of database size. From scale factor 1 to 10, we can see in Table <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.T6" title="Table 6 ‣ 6.1.6. Evaluation Metrics ‣ 6.1. Experimental Setup ‣ 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">6</span></a> the efficiency of queries rewritten by our method increases consistently and surpasses the baseline methods.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S6.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.5. </span>Ablation Studies</h3>
<div class="ltx_para" id="S6.SS5.p1">
<p class="ltx_p" id="S6.SS5.p1.1">We conduct an ablation study to evaluate our method’s performance along two distinct dimensions: <span class="ltx_text ltx_font_italic" id="S6.SS5.p1.1.1">different selection approaches</span> and <span class="ltx_text ltx_font_italic" id="S6.SS5.p1.1.2">specific settings in the selection model</span>. At first, we explore alternative selection approaches by substituting the learned selection model with different approaches to gauge their impact. Subsequently, we delve into the intricacies of the selection model by replacing individual components of the model.</p>
</div>
<section class="ltx_subsubsection" id="S6.SS5.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.5.1. </span>Different selection approaches</h4>
<div class="ltx_para" id="S6.SS5.SSS1.p1">
<p class="ltx_p" id="S6.SS5.SSS1.p1.1">We design the following approaches to replace the contrastive selection model in our system:</p>
</div>
<div class="ltx_para" id="S6.SS5.SSS1.p2">
<p class="ltx_p" id="S6.SS5.SSS1.p2.1">- <span class="ltx_text ltx_font_bold" id="S6.SS5.SSS1.p2.1.1">Zero-shot:</span> This method employs the LLM-R<sup class="ltx_sup" id="S6.SS5.SSS1.p2.1.2">2</sup> to rewrite input queries without any preliminary demonstrations.</p>
</div>
<div class="ltx_para" id="S6.SS5.SSS1.p3">
<p class="ltx_p" id="S6.SS5.SSS1.p3.1">- <span class="ltx_text ltx_font_bold" id="S6.SS5.SSS1.p3.1.1">Few-shots:</span> Building on insights from Section <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S4" title="4. Demonstration Preparation ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">4</span></a>, we refine the demonstration pool with three intuitive methods for one-shot demonstration selection: <span class="ltx_text ltx_font_bold" id="S6.SS5.SSS1.p3.1.2">Random</span>, <span class="ltx_text ltx_font_bold" id="S6.SS5.SSS1.p3.1.3">Tree</span>, and <span class="ltx_text ltx_font_bold" id="S6.SS5.SSS1.p3.1.4">SentTrans</span>.</p>
</div>
<div class="ltx_para" id="S6.SS5.SSS1.p4">
<p class="ltx_p" id="S6.SS5.SSS1.p4.1">Table 7 shows the results and we make the following observations:</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS5.SSS1.p5">
<p class="ltx_p" id="S6.SS5.SSS1.p5.1"><span class="ltx_text ltx_font_bold" id="S6.SS5.SSS1.p5.1.1">(1) Effectiveness of the LLM-enhanced system:</span> The <span class="ltx_text ltx_font_bold" id="S6.SS5.SSS1.p5.1.2">Zero-shot</span> approach outperforms the original queries significantly, which indicates that the LLM-R<sup class="ltx_sup" id="S6.SS5.SSS1.p5.1.3">2</sup> component within our rewrite system is capable of enhancing original queries, showcasing the underlying potential of the LLM to offer viable query rewrite suggestions. This observation suggests that even though the recommendations provided may not always be optimal—owing to constraints such as incomplete information and occasional inaccuracies—the LLM’s contributions are valuable in improving query performance.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS5.SSS1.p6">
<p class="ltx_p" id="S6.SS5.SSS1.p6.1"><span class="ltx_text ltx_font_bold" id="S6.SS5.SSS1.p6.1.1">(2) Effectiveness of introducing demonstrations:</span> We observe that approaches incorporating demonstrations into the rewrite system consistently surpass the Zero-shot setting across all datasets. The sole exception is observed with the <span class="ltx_text ltx_font_bold" id="S6.SS5.SSS1.p6.1.2">Random</span> method, which falls short of the Zero-shot rewrite performance on the DSB dataset. This observation underscores the significance of leveraging demonstrations to enhance the rewrite system, significantly boosting the quality of rewrites. Furthermore, the improvement across diverse datasets highlights the universal applicability and effectiveness of demonstration-based prompting in refining rewrite outcomes.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS5.SSS1.p7">
<p class="ltx_p" id="S6.SS5.SSS1.p7.1"><span class="ltx_text ltx_font_bold" id="S6.SS5.SSS1.p7.1.1">(3) Effectiveness of the contrastive selection model:</span> Our comparative analysis underscores the significance of selecting high-quality demonstrations for query rewriting. The findings reveal that superior demonstrations directly contribute to the generation of more effective rewritten queries.</p>
</div>
<figure class="ltx_table" id="S6.T8">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T8.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T8.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1">Execution time(sec)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S6.T8.1.1.1.2">Mean</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S6.T8.1.1.1.3">Median</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S6.T8.1.1.1.4">75th</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T8.1.1.1.5">95th</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T8.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S6.T8.1.2.1.1">Original</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S6.T8.1.2.1.2">70.90</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S6.T8.1.2.1.3">22.00</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S6.T8.1.2.1.4">37.01</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T8.1.2.1.5">300.00</td>
</tr>
<tr class="ltx_tr" id="S6.T8.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T8.1.3.2.1">
<span class="ltx_text ltx_font_bold" id="S6.T8.1.3.2.1.1">LLM-R<sup class="ltx_sup" id="S6.T8.1.3.2.1.1.1">2</sup></span> (1-shot)</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T8.1.3.2.2"><span class="ltx_text ltx_font_bold" id="S6.T8.1.3.2.2.1">37.23</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T8.1.3.2.3"><span class="ltx_text ltx_font_bold" id="S6.T8.1.3.2.3.1">17.40</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T8.1.3.2.4"><span class="ltx_text ltx_font_bold" id="S6.T8.1.3.2.4.1">29.80</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T8.1.3.2.5"><span class="ltx_text ltx_font_bold" id="S6.T8.1.3.2.5.1">164.12</span></td>
</tr>
<tr class="ltx_tr" id="S6.T8.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T8.1.4.3.1">     <span class="ltx_text ltx_font_bold" id="S6.T8.1.4.3.1.1">w/o Curriculum</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T8.1.4.3.2">38.73</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T8.1.4.3.3">19.70</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T8.1.4.3.4">32.17</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T8.1.4.3.5">164.98</td>
</tr>
<tr class="ltx_tr" id="S6.T8.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T8.1.5.4.1">
<span class="ltx_text ltx_font_bold" id="S6.T8.1.5.4.1.1">LLM-R<sup class="ltx_sup" id="S6.T8.1.5.4.1.1.1">2</sup></span> (3-shots)</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T8.1.5.4.2">54.08</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T8.1.5.4.3">19.67</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T8.1.5.4.4">37.01</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T8.1.5.4.5">300.00</td>
</tr>
<tr class="ltx_tr" id="S6.T8.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S6.T8.1.6.5.1">
<span class="ltx_text ltx_font_bold" id="S6.T8.1.6.5.1.1">LLM-R<sup class="ltx_sup" id="S6.T8.1.6.5.1.1.1">2</sup></span> (GPT-4)</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T8.1.6.5.2">38.58</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T8.1.6.5.3">20.32</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T8.1.6.5.4">32.27</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S6.T8.1.6.5.5">167.26</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 8. </span>Performance comparison of LLM-R<sup class="ltx_sup" id="S6.T8.3.1">2</sup> with and without the curriculum learning pipeline on TPC-H</figcaption>
</figure>
<figure class="ltx_figure" id="S6.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_missing ltx_missing_image" id="S6.F8.g1" src=""/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8. </span>Examples of the rewrite results of baseline Learned Rewrite method and out LLM-R<sup class="ltx_sup" id="S6.F8.2.1">2</sup> method.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S6.F8.3">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S6.F8.4">rewrite_examples</p>
</div>
</div>
</figure>
</section>
<section class="ltx_subsubsection" id="S6.SS5.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.5.2. </span>Effectiveness of specific settings in the selection model.</h4>
<div class="ltx_para" id="S6.SS5.SSS2.p1">
<p class="ltx_p" id="S6.SS5.SSS2.p1.1">In this experiment, we concentrate on assessing three critical aspects within the contrastive selection model:</p>
</div>
<div class="ltx_para" id="S6.SS5.SSS2.p2">
<p class="ltx_p" id="S6.SS5.SSS2.p2.1">- <span class="ltx_text ltx_font_bold" id="S6.SS5.SSS2.p2.1.1">The Curriculum Learning pipeline:</span> We investigate the curriculum learning pipeline’s efficacy by comparing it with a baseline model. Specifically, this baseline involves training a selection model on the TPC-H dataset using all training triplets simultaneously, rather than employing a curriculum learning-based approach.</p>
</div>
<div class="ltx_para" id="S6.SS5.SSS2.p3">
<p class="ltx_p" id="S6.SS5.SSS2.p3.1">- <span class="ltx_text ltx_font_bold" id="S6.SS5.SSS2.p3.1.1">Demonstration Quantity:</span> We evaluate the impact of varying the number of demonstrations by focusing on the most prevalent configurations—namely, 1-shot and 3-shot demonstrations. This experiment aims to elucidate the demonstration quantity’s effect on the model’s performance.</p>
</div>
<div class="ltx_para" id="S6.SS5.SSS2.p4">
<p class="ltx_p" id="S6.SS5.SSS2.p4.1">- <span class="ltx_text ltx_font_bold" id="S6.SS5.SSS2.p4.1.1">Different LLMs:</span> We explore the implications of integrating GPT-4, a more advanced LLM recognized for its superior capabilities in natural language processing, into our rewriting system. Given the financial implications of utilizing the GPT-4 API, our experimental setup restricts the use of GPT-4 to the enhancement of the test dataset rewrite process, with demonstrations and models derived from GPT-3.5-turbo.</p>
</div>
<div class="ltx_para" id="S6.SS5.SSS2.p5">
<p class="ltx_p" id="S6.SS5.SSS2.p5.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.T8" title="Table 8 ‣ 6.5.1. Different selection approaches ‣ 6.5. Ablation Studies ‣ 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">8</span></a> shows the evaluation results and we obtain the following key insights:</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS5.SSS2.p6">
<p class="ltx_p" id="S6.SS5.SSS2.p6.1"><span class="ltx_text ltx_font_bold" id="S6.SS5.SSS2.p6.1.1">(1)</span> Our query representation model demonstrates superior performance in selecting optimal demonstrations compared to baseline approaches, and the incorporation of a curriculum-based training methodology significantly amplifies this advantage. For instance, direct training on the complete dataset results in a notable reduction in execution cost, averaging a decrease of 32.17 seconds and a median of 2.3 seconds, respectively. Utilizing the curriculum learning approach for training the demonstration selector further contributes to cost efficiency, achieving an average reduction of 1.5 seconds and a median decrease of 2.3 seconds. These findings underscore the efficacy of our proposed query representation model and the curriculum learning framework.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS5.SSS2.p7">
<p class="ltx_p" id="S6.SS5.SSS2.p7.1"><span class="ltx_text ltx_font_bold" id="S6.SS5.SSS2.p7.1.1">(2)</span> Employing a 3-shot approach, as opposed to a 1-shot strategy, adversely affects performance. A detailed examination of the rewritten queries reveals that, the 3-shot method generated only 255 rewrite proposals, and 235 of these rewrites yielded improvements in query execution efficiency. Despite a high success rate of 92.16% for these rewrites, the primary limitation lies in the significantly reduced number of rewrite suggestions. This reduction is largely attributed to the inconsistent guidance provided by the three demonstrations. Additionally, the increased cost of rewrites and the challenges posed by longer in-context texts for LLM analysis emerge as critical yet unresolved issues when employing 3-shot prompting. Based on these findings, we deduce that 1-shot prompting presents a more efficient and effective approach under the current experimental conditions.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS5.SSS2.p8">
<p class="ltx_p" id="S6.SS5.SSS2.p8.1"><span class="ltx_text ltx_font_bold" id="S6.SS5.SSS2.p8.1.1">(3)</span> Despite GPT-4’s enhanced capabilities, transitioning to a different model for inference adversely impacts the efficacy of our method. This observation underscores the complexity of optimizing performance within our proposed framework and suggests that consistency in model usage throughout the process may be pivotal for achieving optimal selection.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S6.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.6. </span>Qualitative Analysis</h3>
<div class="ltx_para" id="S6.SS6.p1">
<p class="ltx_p" id="S6.SS6.p1.1">we proceed to present examples to illustrate the rewrite quality between various methods, focusing particularly on comparisons between our approach and baseline methods. Notably, due to the high incidence of erroneous rewrites generated by the <span class="ltx_text ltx_font_bold" id="S6.SS6.p1.1.1">LLM-only</span> method, our analysis primarily compares our method against the <span class="ltx_text ltx_font_bold" id="S6.SS6.p1.1.2">LR</span> baseline. Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.F8" title="Figure 8 ‣ 6.5.1. Different selection approaches ‣ 6.5. Ablation Studies ‣ 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">8</span></a> demonstrates our findings demonstrate the superior robustness and flexibility of our model compared to <span class="ltx_text ltx_font_bold" id="S6.SS6.p1.1.3">LR</span>. For instance, in the first case study, our <span class="ltx_text ltx_font_bold" id="S6.SS6.p1.1.4">LLM-R<sup class="ltx_sup" id="S6.SS6.p1.1.4.1">2</sup></span> method uncovers rewrite rules that remain undetected by <span class="ltx_text ltx_font_bold" id="S6.SS6.p1.1.5">LR</span>. This discrepancy can be attributed to <span class="ltx_text ltx_font_bold" id="S6.SS6.p1.1.6">LR</span>’s potentially ineffective cost model, which might erroneously consider the original query as already optimized. Conversely, our LLM-enhanced system suggests a rewrite that evidences significant potential for cost reduction. In the second case, <span class="ltx_text ltx_font_bold" id="S6.SS6.p1.1.7">LR</span> is observed to occasionally transform an efficient query into a less efficient one. In the third scenario, <span class="ltx_text ltx_font_bold" id="S6.SS6.p1.1.8">LLM-R<sup class="ltx_sup" id="S6.SS6.p1.1.8.1">2</sup></span> outperforms by modifying the rule sequence and incorporating an additional “FILTER_INTO_JOIN” operation, transforming a “WHERE” clause into an “INNER JOIN”, thereby achieving a more efficient query rewrite than that offered by <span class="ltx_text ltx_font_bold" id="S6.SS6.p1.1.9">LR</span>.</p>
</div>
<figure class="ltx_table" id="S6.T9">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T9.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T9.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T9.1.1.1.1" style="padding-left:2.5pt;padding-right:2.5pt;">Counts</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S6.T9.1.1.1.2" style="padding-left:2.5pt;padding-right:2.5pt;">TPC-H</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S6.T9.1.1.1.3" style="padding-left:2.5pt;padding-right:2.5pt;">IMDB</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S6.T9.1.1.1.4" style="padding-left:2.5pt;padding-right:2.5pt;">DSB</th>
</tr>
<tr class="ltx_tr" id="S6.T9.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S6.T9.1.2.2.1" style="padding-left:2.5pt;padding-right:2.5pt;">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T9.1.2.2.2" style="padding-left:2.5pt;padding-right:2.5pt;">Unique</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T9.1.2.2.3" style="padding-left:2.5pt;padding-right:2.5pt;">Total</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T9.1.2.2.4" style="padding-left:2.5pt;padding-right:2.5pt;">Unique</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T9.1.2.2.5" style="padding-left:2.5pt;padding-right:2.5pt;">Total</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T9.1.2.2.6" style="padding-left:2.5pt;padding-right:2.5pt;">Unique</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T9.1.2.2.7" style="padding-left:2.5pt;padding-right:2.5pt;">Total</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T9.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S6.T9.1.3.1.1" style="padding-left:2.5pt;padding-right:2.5pt;">LR</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T9.1.3.1.2" style="padding-left:2.5pt;padding-right:2.5pt;">5</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T9.1.3.1.3" style="padding-left:2.5pt;padding-right:2.5pt;">405</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T9.1.3.1.4" style="padding-left:2.5pt;padding-right:2.5pt;">1</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T9.1.3.1.5" style="padding-left:2.5pt;padding-right:2.5pt;">192</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T9.1.3.1.6" style="padding-left:2.5pt;padding-right:2.5pt;">9</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T9.1.3.1.7" style="padding-left:2.5pt;padding-right:2.5pt;">707</td>
</tr>
<tr class="ltx_tr" id="S6.T9.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S6.T9.1.4.2.1" style="padding-left:2.5pt;padding-right:2.5pt;">LLM-R<sup class="ltx_sup" id="S6.T9.1.4.2.1.1">2</sup>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T9.1.4.2.2" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T9.1.4.2.2.1">56</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T9.1.4.2.3" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T9.1.4.2.3.1">1824</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T9.1.4.2.4" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T9.1.4.2.4.1">6</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T9.1.4.2.5" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T9.1.4.2.5.1">361</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T9.1.4.2.6" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T9.1.4.2.6.1">37</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T9.1.4.2.7" style="padding-left:2.5pt;padding-right:2.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T9.1.4.2.7.1">920</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 9. </span>The variety of rules applied by the methods in terms of unique rules and total applications.</figcaption>
</figure>
<div class="ltx_para" id="S6.SS6.p2">
<p class="ltx_p" id="S6.SS6.p2.1">Furthermore, we delve into the diversity of rewrite rules suggested by the different methods. Here, the term <span class="ltx_text ltx_font_italic" id="S6.SS6.p2.1.1">Unique</span> refers to the distinct categories of rewrite rules recommended by a method, whereas <span class="ltx_text ltx_font_italic" id="S6.SS6.p2.1.2">Total</span> denotes the aggregate count of all rewrite rule instances proposed. As illustrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#S6.T9" title="Table 9 ‣ 6.6. Qualitative Analysis ‣ 6. Experiment ‣ LLM-R2: A Large Language Model Enhanced Rule-based Rewrite System for Boosting Query Efficiency"><span class="ltx_text ltx_ref_tag">9</span></a>, it is evident that <span class="ltx_text ltx_font_bold" id="S6.SS6.p2.1.3">LLM-R<sup class="ltx_sup" id="S6.SS6.p2.1.3.1">2</sup></span> not only recommends a higher quantity of rewrite rules but also exhibits a broader spectrum of rewrite strategies by employing a diverse range of rules. This observation underscores <span class="ltx_text ltx_font_bold" id="S6.SS6.p2.1.4">LLM-R<sup class="ltx_sup" id="S6.SS6.p2.1.4.1">2</sup></span>’s enhanced flexibility and robustness, showcasing its capability to generate more varied and effective rewrite plans.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7. </span>Conclusion</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">Despite the analysis above, we would like to point out the current limitation for further work. The main limitation for our LLM-R<sup class="ltx_sup" id="S7.p1.1.1">2</sup> lies in the higher rewrite latency compared to DB only methods. Compared to traditional DB methods, calling LLM API and selecting demonstrations indeed consume more time. However, as shown in the experiment results, such higher latency can be alleviated by the larger execution time LLM-R<sup class="ltx_sup" id="S7.p1.1.2">2</sup> decreases, and there is no doubt that our LLM-R<sup class="ltx_sup" id="S7.p1.1.3">2</sup> is a successful example of exploring the LLMs’ application in database problems. We believe that the strong generalisation and reasoning ability of the LLMs can also be applied to other important database problems as well. In addition, further work can also be made to improve our current LLM enhanced query rewrite system, for example, utilising efficient demonstration selection algorithms like Faiss <cite class="ltx_cite ltx_citemacro_citep">(Douze et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12872v1#bib.bib13" title="">2024</a>)</cite>, or even specially fine-tune a LLM on query rewrite with more dataset.</p>
</div>
<div class="ltx_para" id="S7.p2">
<p class="ltx_p" id="S7.p2.1">To conclude, we propose a LLM-enhanced query rewrite pipeline to perform efficient query rewrite. By collecting useful demonstrations and learning a contrastive demonstration selector to modify the rewrite system inputs, we are able to successfully improve the input queries’ efficiency across popular datasets. In addition, we further prove the effectiveness of our learning pipeline and the transferability of our method over different scales, model backbones and datasets, showing that LLM-enhanced methods could be an effective solution for efficiency-oriented query rewrite.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">org ([n.d.])</span>
<span class="ltx_bibblock">
[n.d.].

</span>
<span class="ltx_bibblock">Apache Calcite Rewrite Rules.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://calcite.apache.org/javadocAggregate/org/apache/calcite/rel/rules/package-summary.html" title="">https://calcite.apache.org/javadocAggregate/org/apache/calcite/rel/rules/package-summary.html</a>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">cha ([n.d.])</span>
<span class="ltx_bibblock">
[n.d.].

</span>
<span class="ltx_bibblock">Introduction of OpenAI Text Generation APIs.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://platform.openai.com/docs/guides/text-generation" title="">https://platform.openai.com/docs/guides/text-generation</a>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">db- ([n.d.])</span>
<span class="ltx_bibblock">
[n.d.].

</span>
<span class="ltx_bibblock">LLM As Database Administrator.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/TsinghuaDatabaseGroup/DB-GPT" title="">https://github.com/TsinghuaDatabaseGroup/DB-GPT</a>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pos ([n.d.])</span>
<span class="ltx_bibblock">
[n.d.].

</span>
<span class="ltx_bibblock">PostgreSQL.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.postgresql.org" title="">https://www.postgresql.org</a>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">TPC ([n.d.])</span>
<span class="ltx_bibblock">
[n.d.].

</span>
<span class="ltx_bibblock">TPC-H Toolkit.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.tpc.org/tpc_documents_current_versions/current_specifications5.asp" title="">https://www.tpc.org/tpc_documents_current_versions/current_specifications5.asp</a>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Qiushi Bai, Sadeem Alsudais, and Chen Li. 2023.

</span>
<span class="ltx_bibblock">QueryBooster: Improving SQL Performance Using Middleware Services for Human-Centered Query Rewriting.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2305.08272 [cs.DB]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Begoli et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Edmon Begoli, Jesús Camacho-Rodríguez, Julian Hyde, Michael J. Mior, and Daniel Lemire. 2018.

</span>
<span class="ltx_bibblock">Apache Calcite: A Foundational Framework for Optimized Query Processing Over Heterogeneous Data Sources. In <em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">Proceedings of the 2018 International Conference on Management of Data</em> <em class="ltx_emph ltx_font_italic" id="bib.bib8.4.2">(SIGMOD/PODS ’18)</em>. ACM.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3183713.3190662" title="">https://doi.org/10.1145/3183713.3190662</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bengio et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2009)</span>
<span class="ltx_bibblock">
Yoshua Bengio, Jérôme Louradour, Ronan Collobert, and Jason Weston. 2009.

</span>
<span class="ltx_bibblock">Curriculum Learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Proceedings of the 26th Annual International Conference on Machine Learning</em> (Montreal, Quebec, Canada) <em class="ltx_emph ltx_font_italic" id="bib.bib9.4.2">(ICML ’09)</em>. Association for Computing Machinery, New York, NY, USA, 41–48.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/1553374.1553380" title="">https://doi.org/10.1145/1553374.1553380</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Tom B. Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, Tom Henighan, Rewon Child, Aditya Ramesh, Daniel M. Ziegler, Jeffrey Wu, Clemens Winter, Christopher Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott Gray, Benjamin Chess, Jack Clark, Christopher Berner, Sam McCandlish, Alec Radford, Ilya Sutskever,
and Dario Amodei. 2020.

</span>
<span class="ltx_bibblock">Language Models are Few-Shot Learners.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2005.14165 [cs.CL]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cer et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Daniel Cer, Mona Diab, Eneko Agirre, Inigo Lopez-Gazpio, and Lucia Specia. 2017.

</span>
<span class="ltx_bibblock">SemEval-2017 Task 1: Semantic Textual Similarity Multilingual and Crosslingual Focused Evaluation. In <em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">Proceedings of the 11th International Workshop on Semantic Evaluation (SemEval-2017)</em>. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.18653/v1/s17-2001" title="">https://doi.org/10.18653/v1/s17-2001</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Bailu Ding, Surajit Chaudhuri, Johannes Gehrke, and Vivek Narasayya. 2021.

</span>
<span class="ltx_bibblock">DSB: A Decision Support Benchmark for Workload-Driven and Traditional Database Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">VLDB 2022</em>.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.microsoft.com/en-us/research/publication/dsb-a-decision-support-benchmark-for-workload-driven-and-traditional-database-systems/" title="">https://www.microsoft.com/en-us/research/publication/dsb-a-decision-support-benchmark-for-workload-driven-and-traditional-database-systems/</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Douze et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Matthijs Douze, Alexandr Guzhva, Chengqi Deng, Jeff Johnson, Gergely Szilvasy, Pierre-Emmanuel Mazaré, Maria Lomeli, Lucas Hosseini, and Hervé Jégou. 2024.

</span>
<span class="ltx_bibblock">The Faiss library.

</span>
<span class="ltx_bibblock">(2024).

</span>
<span class="ltx_bibblock">arXiv:2401.08281 [cs.LG]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Tianyu Gao, Xingcheng Yao, and Danqi Chen. 2022.

</span>
<span class="ltx_bibblock">SimCSE: Simple Contrastive Learning of Sentence Embeddings.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2104.08821 [cs.CL]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Graefe (1995)</span>
<span class="ltx_bibblock">
Goetz Graefe. 1995.

</span>
<span class="ltx_bibblock">The Cascades Framework for Query Optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">IEEE Data(base) Engineering Bulletin</em> 18 (1995), 19–29.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:260706023" title="">https://api.semanticscholar.org/CorpusID:260706023</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Graefe and DeWitt (1987)</span>
<span class="ltx_bibblock">
Goetz Graefe and David J. DeWitt. 1987.

</span>
<span class="ltx_bibblock">The EXODUS optimizer generator. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the 1987 ACM SIGMOD International Conference on Management of Data</em> (San Francisco, California, USA) <em class="ltx_emph ltx_font_italic" id="bib.bib16.2.2">(SIGMOD ’87)</em>. Association for Computing Machinery, New York, NY, USA, 160–172.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/38713.38734" title="">https://doi.org/10.1145/38713.38734</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Graefe and McKenna (1993)</span>
<span class="ltx_bibblock">
G. Graefe and W.J. McKenna. 1993.

</span>
<span class="ltx_bibblock">The Volcano optimizer generator: extensibility and efficient search. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of IEEE 9th International Conference on Data Engineering</em>. 209–218.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/ICDE.1993.344061" title="">https://doi.org/10.1109/ICDE.1993.344061</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ji et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Ziwei Ji, Nayeon Lee, Rita Frieske, Tiezheng Yu, Dan Su, Yan Xu, Etsuko Ishii, Ye Jin Bang, Andrea Madotto, and Pascale Fung. 2023.

</span>
<span class="ltx_bibblock">Survey of Hallucination in Natural Language Generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">Comput. Surveys</em> 55, 12 (March 2023), 1–38.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3571730" title="">https://doi.org/10.1145/3571730</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Leis et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Viktor Leis, Andrey Gubichev, Atanas Mirchev, Peter A. Boncz, Alfons Kemper, and Thomas Neumann. 2015.

</span>
<span class="ltx_bibblock">How Good Are Query Optimizers, Really?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">Proc. VLDB Endow.</em> 9 (2015), 204–215.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:7953847" title="">https://api.semanticscholar.org/CorpusID:7953847</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li (2019)</span>
<span class="ltx_bibblock">
Feifei Li. 2019.

</span>
<span class="ltx_bibblock">Cloud-Native Database Systems at Alibaba: Opportunities and Challenges.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proc. VLDB Endow.</em> 12, 12 (aug 2019), 2263–2272.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.14778/3352063.3352141" title="">https://doi.org/10.14778/3352063.3352141</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Jinyang Li, Binyuan Hui, Ge Qu, Jiaxi Yang, Binhua Li, Bowen Li, Bailin Wang, Bowen Qin, Rongyu Cao, Ruiying Geng, Nan Huo, Xuanhe Zhou, Chenhao Ma, Guoliang Li, Kevin C. C. Chang, Fei Huang, Reynold Cheng, and Yongbin Li. 2023a.

</span>
<span class="ltx_bibblock">Can LLM Already Serve as A Database Interface? A BIg Bench for Large-Scale Database Grounded Text-to-SQLs.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2305.03111 [cs.CL]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Xiaonan Li, Kai Lv, Hang Yan, Tianyang Lin, Wei Zhu, Yuan Ni, Guotong Xie, Xiaoling Wang, and Xipeng Qiu. 2023b.

</span>
<span class="ltx_bibblock">Unified Demonstration Retriever for In-Context Learning.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2305.04320 [cs.CL]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Maas et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2011)</span>
<span class="ltx_bibblock">
Andrew L. Maas, Raymond E. Daly, Peter T. Pham, Dan Huang, Andrew Y. Ng, and Christopher Potts. 2011.

</span>
<span class="ltx_bibblock">Learning Word Vectors for Sentiment Analysis. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">Proceedings of the 49th Annual Meeting of the Association for Computational Linguistics: Human Language Technologies</em>. Association for Computational Linguistics, Portland, Oregon, USA, 142–150.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="http://www.aclweb.org/anthology/P11-1015" title="">http://www.aclweb.org/anthology/P11-1015</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pirahesh et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (1992)</span>
<span class="ltx_bibblock">
Hamid Pirahesh, Joseph M. Hellerstein, and Waqar Hasan. 1992.

</span>
<span class="ltx_bibblock">Extensible/Rule Based Query Rewrite Optimization in Starburst.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">SIGMOD Rec.</em> 21, 2 (jun 1992), 39–48.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/141484.130294" title="">https://doi.org/10.1145/141484.130294</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reimers and Gurevych (2019)</span>
<span class="ltx_bibblock">
Nils Reimers and Iryna Gurevych. 2019.

</span>
<span class="ltx_bibblock">Sentence-BERT: Sentence Embeddings using Siamese BERT-Networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing</em>. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1908.10084" title="">https://arxiv.org/abs/1908.10084</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schick et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Timo Schick, Jane Dwivedi-Yu, Roberto Dessì, Roberta Raileanu, Maria Lomeli, Luke Zettlemoyer, Nicola Cancedda, and Thomas Scialom. 2023.

</span>
<span class="ltx_bibblock">Toolformer: Language Models Can Teach Themselves to Use Tools.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2302.04761 [cs.CL]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Ruoxi Sun, Sercan O. Arik, Hootan Nakhost, Hanjun Dai, Rajarishi Sinha, Pengcheng Yin, and Tomas Pfister. 2023.

</span>
<span class="ltx_bibblock">SQL-PaLM: Improved Large Language Model Adaptation for Text-to-SQL.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2306.00739 [cs.CL]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Zhaoguo Wang, Zhou Zhou, Yicun Yang, Haoran Ding, Gansen Hu, Ding Ding, Chuzhe Tang, Haibo Chen, and Jinyang Li. 2022.

</span>
<span class="ltx_bibblock">WeTune: Automatic Discovery and Verification of Query Rewrite Rules. In <em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">Proceedings of the 2022 International Conference on Management of Data</em> (Philadelphia, PA, USA) <em class="ltx_emph ltx_font_italic" id="bib.bib28.4.2">(SIGMOD ’22)</em>. Association for Computing Machinery, New York, NY, USA, 94–107.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3514221.3526125" title="">https://doi.org/10.1145/3514221.3526125</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jerry Wei, Jason Wei, Yi Tay, Dustin Tran, Albert Webson, Yifeng Lu, Xinyun Chen, Hanxiao Liu, Da Huang, Denny Zhou, and Tengyu Ma. 2023.

</span>
<span class="ltx_bibblock">Larger language models do in-context learning differently.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2303.03846 [cs.CL]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Wentao Wu, Philip A. Bernstein, Alex Raizman, and Christina Pavlopoulou. 2022.

</span>
<span class="ltx_bibblock">Factor Windows: Cost-based Query Rewriting for Optimizing Correlated Window Aggregates.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2008.12379 [cs.DB]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xue et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Siqiao Xue, Caigao Jiang, Wenhui Shi, Fangyin Cheng, Keting Chen, Hongjun Yang, Zhiping Zhang, Jianshan He, Hongyang Zhang, Ganglin Wei, Wang Zhao, Fan Zhou, Danrui Qi, Hong Yi, Shaodong Liu, and Faqiang Chen. 2024.

</span>
<span class="ltx_bibblock">DB-GPT: Empowering Database Interactions with Private Large Language Models.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2312.17449 [cs.DB]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Shunyu Yao, Jeffrey Zhao, Dian Yu, Nan Du, Izhak Shafran, Karthik Narasimhan, and Yuan Cao. 2023.

</span>
<span class="ltx_bibblock">ReAct: Synergizing Reasoning and Acting in Language Models.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2210.03629 [cs.CL]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yue Zhang, Yafu Li, Leyang Cui, Deng Cai, Lemao Liu, Tingchen Fu, Xinting Huang, Enbo Zhao, Yu Zhang, Yulong Chen, Longyue Wang, Anh Tuan Luu, Wei Bi, Freda Shi, and Shuming Shi. 2023.

</span>
<span class="ltx_bibblock">Siren’s Song in the AI Ocean: A Survey on Hallucination in Large Language Models.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2309.01219 [cs.CL]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yue Zhao, Gao Cong, Jiachen Shi, and Chunyan Miao. 2022.

</span>
<span class="ltx_bibblock">QueryFormer: a tree transformer model for query plan representation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">Proceedings of the VLDB Endowment</em> 15 (04 2022), 1658–1670.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.14778/3529337.3529349" title="">https://doi.org/10.14778/3529337.3529349</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Yue Zhao, Zhaodonghui Li, and Gao Cong. 2024.

</span>
<span class="ltx_bibblock">A Comparative Study and Component Analysis of Query Plan Representation Techniques in ML4DB Studies.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">Proc. VLDB Endow.</em> 17, 4 (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Xuanhe Zhou, Guoliang Li, Chengliang Chai, and Jianhua Feng. 2021.

</span>
<span class="ltx_bibblock">A Learned Query Rewrite System Using Monte Carlo Tree Search.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">Proc. VLDB Endow.</em> 15, 1 (sep 2021), 46–58.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.14778/3485450.3485456" title="">https://doi.org/10.14778/3485450.3485456</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib37.3.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yuhang Zhou, He Yu, Siyu Tian, Dan Chen, Liuzhi Zhou, Xinlin Yu, Chuanjun Ji, Sen Liu, Guangnan Ye, and Hongfeng Chai. 2023.

</span>
<span class="ltx_bibblock"><math alttext="R^{3}" class="ltx_Math" display="inline" id="bib.bib37.1.m1.1"><semantics id="bib.bib37.1.m1.1a"><msup id="bib.bib37.1.m1.1.1" xref="bib.bib37.1.m1.1.1.cmml"><mi id="bib.bib37.1.m1.1.1.2" xref="bib.bib37.1.m1.1.1.2.cmml">R</mi><mn id="bib.bib37.1.m1.1.1.3" xref="bib.bib37.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="bib.bib37.1.m1.1b"><apply id="bib.bib37.1.m1.1.1.cmml" xref="bib.bib37.1.m1.1.1"><csymbol cd="ambiguous" id="bib.bib37.1.m1.1.1.1.cmml" xref="bib.bib37.1.m1.1.1">superscript</csymbol><ci id="bib.bib37.1.m1.1.1.2.cmml" xref="bib.bib37.1.m1.1.1.2">𝑅</ci><cn id="bib.bib37.1.m1.1.1.3.cmml" type="integer" xref="bib.bib37.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib37.1.m1.1c">R^{3}</annotation><annotation encoding="application/x-llamapun" id="bib.bib37.1.m1.1d">italic_R start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>-NL2GQL: A Hybrid Models Approach for for Accuracy Enhancing and Hallucinations Mitigation.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2311.01862 [cs.CL]

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed May  1 13:35:19 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
