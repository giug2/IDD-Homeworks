<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2211.07931] Personalized Federated Learning with Multi-branch Architecture</title><meta property="og:description" content="Federated learning (FL) is a decentralized machine learning
technique that enables multiple clients to collaboratively train
models without requiring clients to reveal their raw data to each other. Although traditional…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Personalized Federated Learning with Multi-branch Architecture">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Personalized Federated Learning with Multi-branch Architecture">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2211.07931">

<!--Generated on Thu Mar 14 07:01:15 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
federated learning,  non-iid,  multi-branch architecture">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Personalized Federated Learning with Multi-branch Architecture
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Junki Mori
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id1.1.id1" class="ltx_text ltx_font_italic">NEC Corporation
<br class="ltx_break"></span>Kanagawa, Japan 
<br class="ltx_break">junki.mori@nec.com
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Tomoyuki Yoshiyama
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
yoshi123.xyz@gmail.com
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ryo Furukawa
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id2.1.id1" class="ltx_text ltx_font_italic">NEC Corporation
<br class="ltx_break"></span>Kanagawa, Japan 
<br class="ltx_break">rfurukawa@nec.com
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Isamu Teranishi
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id3.1.id1" class="ltx_text ltx_font_italic">NEC Corporation
<br class="ltx_break"></span>Kanagawa, Japan 
<br class="ltx_break">teranisi@nec.com
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id4.id1" class="ltx_p"><span id="id4.id1.1" class="ltx_text ltx_font_italic">Federated learning</span> (FL) is a decentralized machine learning
technique that enables multiple clients to collaboratively train
models without requiring clients to reveal their raw data to each other. Although traditional FL trains a single global model with average performance among clients, statistical data heterogeneity across clients has resulted in the development of <span id="id4.id1.2" class="ltx_text ltx_font_italic">personalized FL</span> (PFL), which trains personalized models with good performance on each client’s data. A key challenge with PFL is how to facilitate clients with similar data to collaborate more in a situation where each client has data from complex distribution and cannot determine one another’s distribution. In this paper, we propose a new PFL method (pFedMB) <span id="id4.id1.3" class="ltx_text" style="color:#000000;">using multi-branch architecture</span>, which achieves personalization by splitting each layer of a neural network into multiple branches and assigning client-specific weights to each branch. <span id="id4.id1.4" class="ltx_text" style="color:#000000;">We also design an aggregation method to improve the communication efficiency and the model performance, with which each branch is globally updated with weighted averaging by client-specific weights assigned to the branch.</span> pFedMB is simple but effective in facilitating each client to share knowledge with similar clients by adjusting the weights assigned to each branch. We experimentally show that pFedMB <span id="id4.id1.5" class="ltx_text" style="color:#000000;">performs better</span> than the state-of-the-art PFL methods using the CIFAR10 and CIFAR100 datasets.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
federated learning, non-iid, multi-branch architecture<span id="footnotex1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">0</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">0</sup><span class="ltx_tag ltx_tag_note">0</span>*Equal contribution.</span></span></span>

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The success of machine learning in various domains has led to the demand for large amounts of data. However, a single organization (e.g. hospital) alone may not have sufficient data to construct a powerful machine learning model. It is difficult for such organizations to obtain <span id="S1.p1.1.1" class="ltx_text" style="color:#000000;">additional data</span> from outside sources due to privacy concerns. <span id="S1.p1.1.2" class="ltx_text ltx_font_italic">Federated learning</span> (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, a decentralized machine learning technique, emerged as an efficient solution to this problem. FL enables multiple clients to collaboratively build a machine learning model without directly accessing their private data.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Traditional FL methods that aim to train a single global model perform well when the data across clients are <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">independent and identically distributed</span> (IID). However, in reality, there is statistical data heterogeneity between clients, that is, data are non-IID. For example, each hospital has a different size of patient data and their distribution varies by region (e.g. age). Training a single global model on non-IID data degrades the performance for individual clients <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">Personalized FL</span> (PFL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> addresses this problem by jointly training personalized models fitted to each client’s data distribution.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Various PFL methods have been proposed and are mainly classified into two types on the basis of how the model is personalized to each client, i.e., local customization and similarity-based <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Local-customization methods train a global model and locally customize it to be a personalized model. Local fine-tuning is a typical local-customization method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>. Most of such methods build a global model with equal contributions from all clients even though the data distribution between some clients may be very different, which leads to invalid global model updating. <span id="S1.p3.1.1" class="ltx_text" style="color:#000000;">To address this problem, similarity-based methods have been proposed. Earlier similarity-based methods are clustering-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, which jointly train a model within each cluster consisting of only similar clients. Such methods are only applicable when clients are clearly partitioned and not suitable for more complex data distributions. Newer similarity-based methods, such as FedAMP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> and FedFomo <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, measure the similarity between clients and updates their personalized models by weighted combination of all clients’ models on the basis of the similarities. It has been shown that these methods outperform local-customization methods in simple non-IID settings, e.g., where each client is randomly assigned 2 classes or clients are grouped in advance by data distribution. However, in our experiments, FedAMP and FedFomo as well as clustering-based methods did not work well in a more complex non-IID setting. This is because directly calculating the similarities is difficult due to the complexity of data distribution.</span></p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p"><span id="S1.p4.1.1" class="ltx_text" style="color:#000000;">In this paper, we aim to solve the above problem with similarity-based methods by first extending clustering-based methods. With clustering-based methods, each client uses only a model corresponding to the cluster to which it belongs. However, in a more complex non-IID setting where clients cannot be clustered, it is better to use the weighted combination of all models. By applying this insight to the level of model structure, we propose a PFL method called <span id="S1.p4.1.1.1" class="ltx_text ltx_font_italic">personalized federated learning with multi-branch architecture</span> (pFedMB),</span> which splits each layer of a neural network into multiple branches and assigns client-specific weights to each branch. Each client can obtain a personalized model fitted to its own complex distribution by learning the optimized client-specific weights and using a weighted convex combination of all the branches as a single layer. In pFedMB, an aggregation method is designed, with which each branch is updated with weighted averaging by client-specific weights assigned to the branch. This aggregation method <span id="S1.p4.1.2" class="ltx_text" style="color:#000000;">enables</span> similar clients to <span id="S1.p4.1.3" class="ltx_text" style="color:#000000;">automatically</span> share knowledge more without directly calculating the similarities, <span id="S1.p4.1.4" class="ltx_text" style="color:#000000;">as with FedAMP and FedFomo</span>, because similar clients <span id="S1.p4.1.5" class="ltx_text" style="color:#000000;">will learn</span> similar client-specific weights, which leads to improve the communication efficiency and the model performance. Our experiment showed that pFedMB outperforms various state-of-the-art PFL methods <span id="S1.p4.1.6" class="ltx_text" style="color:#000000;">and is the most balanced method that can be applied to both simple and more complex settings.</span></p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">RELATED WORKS</span>
</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.4.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.5.2" class="ltx_text ltx_font_italic">Federated Learning</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">FL was first introduced by McMahan et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> as FedAvg, which is one of the most standard FL algorithms for updating models locally and constructing a global model by averaging them. It has been pointed out that FL faces several challenges <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. One is statistical heterogeneity, i.e., non-IID data problem across clients, which causes accuracy drop and parameter divergence <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. There are two approaches to address non-IID data in FL setting. One is improving the robustness of a global model to non-IID data. The other is training personalized models for individual clients.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.4.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.5.2" class="ltx_text ltx_font_italic">Improved Federated Learning on Non-IID Data</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Studies in this direction aim to train a single global model robust to non-IID data. For example, FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> adds the proximal term to the learning objective to reduce the potential parameter divergence. SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> introduces control variates to correct the local updates. MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> uses the contrastive learning method at the model level to correct the local training of individual clients.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS3.4.1.1" class="ltx_text">II-C</span> </span><span id="S2.SS3.5.2" class="ltx_text ltx_font_italic">Personalized Federated Learning</span>
</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">Unlike the above direction, PFL trains multiple models personalized to individual clients. In this paper, we focus on this direction. There are two types of PFL methods based on how the model is personalized to each client, local customization and similarity-based methods.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.1" class="ltx_p">Local-customization methods train a single global model by usual aggregation strategy from all clients, as with FedAvg. Personalization is obtained by the local customization of the global model. A typical local-customization method is local fine-tuning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, which locally updates a global model for a few steps to obtain personalized models. Similar techniques are used in meta-learning methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, which update the local models with several gradient steps by using meta-learning such as MAML <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. Model-mixing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> gets personalized models by mixing the global model and the local models trained on local data of each client. Parameter decoupling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> achieves personalization through a customized model design. In parameter decoupling, the local private model parameters are decoupled from the global model parameters. For example, FedPer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> separates neural networks into base layers shared among all clients and private personalization layers. With distillation-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, which utilize knowledge distillation, the soft scores are aggregated instead of local models to obtain personalized models with different model architectures.</p>
</div>
<div id="S2.SS3.p3" class="ltx_para">
<p id="S2.SS3.p3.1" class="ltx_p">With local-customization methods, client relationships are not taken into account when updating global models. Similarity-based methods take into account client relationships and facilitate related clients to learn similar personalized models, which produces efficient collaboration. MOCHA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> extends multi-task learning into an FL setting (each client is treated as a task) and captures relationships among clients. However, MOCHA is only
applicable to convex models. With clustering-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, it is assumed that inherent partitions among clients or data distributions exist, and they cluster these partitions to jointly train a model within each cluster. <span id="S2.SS3.p3.1.1" class="ltx_text" style="color:#000000;">In our experiments, we used IFCA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> as a clustering-based method.</span> FedFomo <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> is another similarity-based method that efficiently calculates optimal weighted model combinations for each client on the basis of how much a client can benefit from another’s model. With FedAMP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, instead of a single global model, a personalized cloud model for each client is maintained in the server. The personalized cloud model of each client is updated by a weighted
convex combination of all the local client models on the basis of the calculated similarities between clients. Each client trains a personalized model to be close to their personalized cloud model.</p>
</div>
<div id="S2.SS3.p4" class="ltx_para">
<p id="S2.SS3.p4.1" class="ltx_p">Our proposed method pFedMB is a type of parameter decoupling methods in terms of the network architecture, but can be considered as a similarity-based method in terms of the manner of updating global models.</p>
</div>
</section>
<section id="S2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS4.4.1.1" class="ltx_text">II-D</span> </span><span id="S2.SS4.5.2" class="ltx_text ltx_font_italic">Multi-branch Neural Networks</span>
</h3>

<div id="S2.SS4.p1" class="ltx_para">
<p id="S2.SS4.p1.1" class="ltx_p">Our research is inspired by multi-branch convolutional networks such as conditionally parameterized convolutions (CondConv) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, which enables us to increase the size and capacity of a network, while maintaining efficient inference. In a CondConv layer, a convolutional kernel for each example is computed as a weighted linear combination of multiple branches by example-dependent weight. <span id="S2.SS4.p1.1.1" class="ltx_text" style="color:#000000;">We extend this architecture to the FL setting, where</span>
the weight associated to each branch depends on data distribution (i.e., client), not examples.</p>
</div>
<div id="S2.SS4.p2" class="ltx_para">
<p id="S2.SS4.p2.1" class="ltx_p"><span id="S2.SS4.p2.1.1" class="ltx_text" style="color:#000000;">Other type of multi-branch neural networks has also been proposed<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. BranchyNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> inserts early exit branches, that is, side branches in the middle of the neural network and achieves fast inference by allowing test samples to exit the network early via these branches when samples can already be inferred with high confidence. Hu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> proposes RDI-Nets, multi-exit neural networks such as BranchyNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, which are robust to adversarial examples.</span></p>
</div>
</section>
<section id="S2.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS5.4.1.1" class="ltx_text">II-E</span> </span><span id="S2.SS5.5.2" class="ltx_text ltx_font_italic" style="color:#000000;">Federated Learning Based on Multi-branch Neural Networks</span>
</h3>

<div id="S2.SS5.p1" class="ltx_para">
<p id="S2.SS5.p1.1" class="ltx_p"><span id="S2.SS5.p1.1.1" class="ltx_text" style="color:#000000;">There are some studies that propose FL methods based on multi-branch neural networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>, <a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>. For example, multi-branch neural networks are utilized in the setting of heterogeneous FL, where the clients participated in FL have different computation capacities <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. FedBranch <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, MFedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>, Semi-HFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, and FL-MBNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> divide a neural network into a series of small sub-branch models by inserting early exit branches and assign a proper sub-branch to each client according to their computation capacity. FedTEM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> considers applications in which the data distribution of clients changes with time and trains a multi-branch network with shared feature extraction
layers followed by one of the specialized prediction branches allocated to clients from different modes, i.e., daytime mode or nighttime mode.</span></p>
</div>
<div id="S2.SS5.p2" class="ltx_para">
<p id="S2.SS5.p2.1" class="ltx_p"><span id="S2.SS5.p2.1.1" class="ltx_text" style="color:#000000;">Our method differs from the above methods in two respects. First, the structure of multi-branch neural networks differs between them and ours. Our pFedMB splits each layer into multiple branches and computes a weighted linear combination of them like CondConv <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. On the other hand, the existing methods above <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> adopt a multi-exit structure like BranchyNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, which does not allow superposition of branches. FedTEM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> is rather more related to FedPer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> than pFedMB, since it only divides the final layer into multiple branches and also does not consider the superposition of branches. Second, unlike the above methods, our method is a PFL method and the first to use multi-branch neural networks in PFL.</span></p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">PROBLEM FORMULATION</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.8" class="ltx_p">In this section, we introduce the PFL setting. Consider <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">N</annotation></semantics></math> clients <math id="S3.p1.2.m2.3" class="ltx_Math" alttext="C_{1},\dots,C_{N}" display="inline"><semantics id="S3.p1.2.m2.3a"><mrow id="S3.p1.2.m2.3.3.2" xref="S3.p1.2.m2.3.3.3.cmml"><msub id="S3.p1.2.m2.2.2.1.1" xref="S3.p1.2.m2.2.2.1.1.cmml"><mi id="S3.p1.2.m2.2.2.1.1.2" xref="S3.p1.2.m2.2.2.1.1.2.cmml">C</mi><mn id="S3.p1.2.m2.2.2.1.1.3" xref="S3.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.p1.2.m2.3.3.2.3" xref="S3.p1.2.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">…</mi><mo id="S3.p1.2.m2.3.3.2.4" xref="S3.p1.2.m2.3.3.3.cmml">,</mo><msub id="S3.p1.2.m2.3.3.2.2" xref="S3.p1.2.m2.3.3.2.2.cmml"><mi id="S3.p1.2.m2.3.3.2.2.2" xref="S3.p1.2.m2.3.3.2.2.2.cmml">C</mi><mi id="S3.p1.2.m2.3.3.2.2.3" xref="S3.p1.2.m2.3.3.2.2.3.cmml">N</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.3b"><list id="S3.p1.2.m2.3.3.3.cmml" xref="S3.p1.2.m2.3.3.2"><apply id="S3.p1.2.m2.2.2.1.1.cmml" xref="S3.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.2.2.1.1.1.cmml" xref="S3.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.p1.2.m2.2.2.1.1.2.cmml" xref="S3.p1.2.m2.2.2.1.1.2">𝐶</ci><cn type="integer" id="S3.p1.2.m2.2.2.1.1.3.cmml" xref="S3.p1.2.m2.2.2.1.1.3">1</cn></apply><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">…</ci><apply id="S3.p1.2.m2.3.3.2.2.cmml" xref="S3.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.p1.2.m2.3.3.2.2.1.cmml" xref="S3.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.p1.2.m2.3.3.2.2.2.cmml" xref="S3.p1.2.m2.3.3.2.2.2">𝐶</ci><ci id="S3.p1.2.m2.3.3.2.2.3.cmml" xref="S3.p1.2.m2.3.3.2.2.3">𝑁</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.3c">C_{1},\dots,C_{N}</annotation></semantics></math>. Each client <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S3.p1.3.m3.1a"><msub id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml"><mi id="S3.p1.3.m3.1.1.2" xref="S3.p1.3.m3.1.1.2.cmml">C</mi><mi id="S3.p1.3.m3.1.1.3" xref="S3.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><apply id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.1.cmml" xref="S3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.p1.3.m3.1.1.2.cmml" xref="S3.p1.3.m3.1.1.2">𝐶</ci><ci id="S3.p1.3.m3.1.1.3.cmml" xref="S3.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">C_{i}</annotation></semantics></math> has private local data <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="S3.p1.4.m4.1a"><msub id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml"><mi id="S3.p1.4.m4.1.1.2" xref="S3.p1.4.m4.1.1.2.cmml">D</mi><mi id="S3.p1.4.m4.1.1.3" xref="S3.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.1.cmml" xref="S3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.p1.4.m4.1.1.2.cmml" xref="S3.p1.4.m4.1.1.2">𝐷</ci><ci id="S3.p1.4.m4.1.1.3.cmml" xref="S3.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">D_{i}</annotation></semantics></math> composed of <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="n_{i}" display="inline"><semantics id="S3.p1.5.m5.1a"><msub id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><mi id="S3.p1.5.m5.1.1.2" xref="S3.p1.5.m5.1.1.2.cmml">n</mi><mi id="S3.p1.5.m5.1.1.3" xref="S3.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2">𝑛</ci><ci id="S3.p1.5.m5.1.1.3.cmml" xref="S3.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">n_{i}</annotation></semantics></math> data points sampled from data distribution <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.p1.6.m6.1a"><msub id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.6.m6.1.1.2" xref="S3.p1.6.m6.1.1.2.cmml">𝒟</mi><mi id="S3.p1.6.m6.1.1.3" xref="S3.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><apply id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.1.cmml" xref="S3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.p1.6.m6.1.1.2.cmml" xref="S3.p1.6.m6.1.1.2">𝒟</ci><ci id="S3.p1.6.m6.1.1.3.cmml" xref="S3.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">\mathcal{D}_{i}</annotation></semantics></math>. Denote the total number of data samples across clients by <math id="S3.p1.7.m7.1" class="ltx_Math" alttext="n=\sum_{i=1}^{N}n_{i}" display="inline"><semantics id="S3.p1.7.m7.1a"><mrow id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml"><mi id="S3.p1.7.m7.1.1.2" xref="S3.p1.7.m7.1.1.2.cmml">n</mi><mo rspace="0.111em" id="S3.p1.7.m7.1.1.1" xref="S3.p1.7.m7.1.1.1.cmml">=</mo><mrow id="S3.p1.7.m7.1.1.3" xref="S3.p1.7.m7.1.1.3.cmml"><msubsup id="S3.p1.7.m7.1.1.3.1" xref="S3.p1.7.m7.1.1.3.1.cmml"><mo id="S3.p1.7.m7.1.1.3.1.2.2" xref="S3.p1.7.m7.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.p1.7.m7.1.1.3.1.2.3" xref="S3.p1.7.m7.1.1.3.1.2.3.cmml"><mi id="S3.p1.7.m7.1.1.3.1.2.3.2" xref="S3.p1.7.m7.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.p1.7.m7.1.1.3.1.2.3.1" xref="S3.p1.7.m7.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.p1.7.m7.1.1.3.1.2.3.3" xref="S3.p1.7.m7.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.p1.7.m7.1.1.3.1.3" xref="S3.p1.7.m7.1.1.3.1.3.cmml">N</mi></msubsup><msub id="S3.p1.7.m7.1.1.3.2" xref="S3.p1.7.m7.1.1.3.2.cmml"><mi id="S3.p1.7.m7.1.1.3.2.2" xref="S3.p1.7.m7.1.1.3.2.2.cmml">n</mi><mi id="S3.p1.7.m7.1.1.3.2.3" xref="S3.p1.7.m7.1.1.3.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1"><eq id="S3.p1.7.m7.1.1.1.cmml" xref="S3.p1.7.m7.1.1.1"></eq><ci id="S3.p1.7.m7.1.1.2.cmml" xref="S3.p1.7.m7.1.1.2">𝑛</ci><apply id="S3.p1.7.m7.1.1.3.cmml" xref="S3.p1.7.m7.1.1.3"><apply id="S3.p1.7.m7.1.1.3.1.cmml" xref="S3.p1.7.m7.1.1.3.1"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.3.1.1.cmml" xref="S3.p1.7.m7.1.1.3.1">superscript</csymbol><apply id="S3.p1.7.m7.1.1.3.1.2.cmml" xref="S3.p1.7.m7.1.1.3.1"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.3.1.2.1.cmml" xref="S3.p1.7.m7.1.1.3.1">subscript</csymbol><sum id="S3.p1.7.m7.1.1.3.1.2.2.cmml" xref="S3.p1.7.m7.1.1.3.1.2.2"></sum><apply id="S3.p1.7.m7.1.1.3.1.2.3.cmml" xref="S3.p1.7.m7.1.1.3.1.2.3"><eq id="S3.p1.7.m7.1.1.3.1.2.3.1.cmml" xref="S3.p1.7.m7.1.1.3.1.2.3.1"></eq><ci id="S3.p1.7.m7.1.1.3.1.2.3.2.cmml" xref="S3.p1.7.m7.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.p1.7.m7.1.1.3.1.2.3.3.cmml" xref="S3.p1.7.m7.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.p1.7.m7.1.1.3.1.3.cmml" xref="S3.p1.7.m7.1.1.3.1.3">𝑁</ci></apply><apply id="S3.p1.7.m7.1.1.3.2.cmml" xref="S3.p1.7.m7.1.1.3.2"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.3.2.1.cmml" xref="S3.p1.7.m7.1.1.3.2">subscript</csymbol><ci id="S3.p1.7.m7.1.1.3.2.2.cmml" xref="S3.p1.7.m7.1.1.3.2.2">𝑛</ci><ci id="S3.p1.7.m7.1.1.3.2.3.cmml" xref="S3.p1.7.m7.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">n=\sum_{i=1}^{N}n_{i}</annotation></semantics></math>. We assume non-IID data across clients, that is, data distributions <math id="S3.p1.8.m8.3" class="ltx_Math" alttext="\mathcal{D}_{1},\dots,\mathcal{D}_{N}" display="inline"><semantics id="S3.p1.8.m8.3a"><mrow id="S3.p1.8.m8.3.3.2" xref="S3.p1.8.m8.3.3.3.cmml"><msub id="S3.p1.8.m8.2.2.1.1" xref="S3.p1.8.m8.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.8.m8.2.2.1.1.2" xref="S3.p1.8.m8.2.2.1.1.2.cmml">𝒟</mi><mn id="S3.p1.8.m8.2.2.1.1.3" xref="S3.p1.8.m8.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.p1.8.m8.3.3.2.3" xref="S3.p1.8.m8.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml">…</mi><mo id="S3.p1.8.m8.3.3.2.4" xref="S3.p1.8.m8.3.3.3.cmml">,</mo><msub id="S3.p1.8.m8.3.3.2.2" xref="S3.p1.8.m8.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.8.m8.3.3.2.2.2" xref="S3.p1.8.m8.3.3.2.2.2.cmml">𝒟</mi><mi id="S3.p1.8.m8.3.3.2.2.3" xref="S3.p1.8.m8.3.3.2.2.3.cmml">N</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.3b"><list id="S3.p1.8.m8.3.3.3.cmml" xref="S3.p1.8.m8.3.3.2"><apply id="S3.p1.8.m8.2.2.1.1.cmml" xref="S3.p1.8.m8.2.2.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.2.2.1.1.1.cmml" xref="S3.p1.8.m8.2.2.1.1">subscript</csymbol><ci id="S3.p1.8.m8.2.2.1.1.2.cmml" xref="S3.p1.8.m8.2.2.1.1.2">𝒟</ci><cn type="integer" id="S3.p1.8.m8.2.2.1.1.3.cmml" xref="S3.p1.8.m8.2.2.1.1.3">1</cn></apply><ci id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1">…</ci><apply id="S3.p1.8.m8.3.3.2.2.cmml" xref="S3.p1.8.m8.3.3.2.2"><csymbol cd="ambiguous" id="S3.p1.8.m8.3.3.2.2.1.cmml" xref="S3.p1.8.m8.3.3.2.2">subscript</csymbol><ci id="S3.p1.8.m8.3.3.2.2.2.cmml" xref="S3.p1.8.m8.3.3.2.2.2">𝒟</ci><ci id="S3.p1.8.m8.3.3.2.2.3.cmml" xref="S3.p1.8.m8.3.3.2.2.3">𝑁</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.3c">\mathcal{D}_{1},\dots,\mathcal{D}_{N}</annotation></semantics></math> are different from each other. Moreover, we suppose that there is no grouping in data distributions and each client does not know each other’s data distribution.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.13" class="ltx_p">In this paper, we use neural networks as machine learning models. Denote the <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.p2.1.m1.1a"><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">d</annotation></semantics></math> dimensional model parameter of a neural network by <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="w\in\mathbb{R}^{d}" display="inline"><semantics id="S3.p2.2.m2.1a"><mrow id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">w</mi><mo id="S3.p2.2.m2.1.1.1" xref="S3.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml"><mi id="S3.p2.2.m2.1.1.3.2" xref="S3.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.p2.2.m2.1.1.3.3" xref="S3.p2.2.m2.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><in id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1.1"></in><ci id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2">𝑤</ci><apply id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.3.1.cmml" xref="S3.p2.2.m2.1.1.3">superscript</csymbol><ci id="S3.p2.2.m2.1.1.3.2.cmml" xref="S3.p2.2.m2.1.1.3.2">ℝ</ci><ci id="S3.p2.2.m2.1.1.3.3.cmml" xref="S3.p2.2.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">w\in\mathbb{R}^{d}</annotation></semantics></math>. The model parameter <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.p2.3.m3.1a"><mi id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><ci id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">w</annotation></semantics></math> is also represented as <math id="S3.p2.4.m4.3" class="ltx_Math" alttext="w=(W_{1},\dots,W_{L})" display="inline"><semantics id="S3.p2.4.m4.3a"><mrow id="S3.p2.4.m4.3.3" xref="S3.p2.4.m4.3.3.cmml"><mi id="S3.p2.4.m4.3.3.4" xref="S3.p2.4.m4.3.3.4.cmml">w</mi><mo id="S3.p2.4.m4.3.3.3" xref="S3.p2.4.m4.3.3.3.cmml">=</mo><mrow id="S3.p2.4.m4.3.3.2.2" xref="S3.p2.4.m4.3.3.2.3.cmml"><mo stretchy="false" id="S3.p2.4.m4.3.3.2.2.3" xref="S3.p2.4.m4.3.3.2.3.cmml">(</mo><msub id="S3.p2.4.m4.2.2.1.1.1" xref="S3.p2.4.m4.2.2.1.1.1.cmml"><mi id="S3.p2.4.m4.2.2.1.1.1.2" xref="S3.p2.4.m4.2.2.1.1.1.2.cmml">W</mi><mn id="S3.p2.4.m4.2.2.1.1.1.3" xref="S3.p2.4.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p2.4.m4.3.3.2.2.4" xref="S3.p2.4.m4.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml">…</mi><mo id="S3.p2.4.m4.3.3.2.2.5" xref="S3.p2.4.m4.3.3.2.3.cmml">,</mo><msub id="S3.p2.4.m4.3.3.2.2.2" xref="S3.p2.4.m4.3.3.2.2.2.cmml"><mi id="S3.p2.4.m4.3.3.2.2.2.2" xref="S3.p2.4.m4.3.3.2.2.2.2.cmml">W</mi><mi id="S3.p2.4.m4.3.3.2.2.2.3" xref="S3.p2.4.m4.3.3.2.2.2.3.cmml">L</mi></msub><mo stretchy="false" id="S3.p2.4.m4.3.3.2.2.6" xref="S3.p2.4.m4.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.3b"><apply id="S3.p2.4.m4.3.3.cmml" xref="S3.p2.4.m4.3.3"><eq id="S3.p2.4.m4.3.3.3.cmml" xref="S3.p2.4.m4.3.3.3"></eq><ci id="S3.p2.4.m4.3.3.4.cmml" xref="S3.p2.4.m4.3.3.4">𝑤</ci><vector id="S3.p2.4.m4.3.3.2.3.cmml" xref="S3.p2.4.m4.3.3.2.2"><apply id="S3.p2.4.m4.2.2.1.1.1.cmml" xref="S3.p2.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.2.2.1.1.1.1.cmml" xref="S3.p2.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.p2.4.m4.2.2.1.1.1.2.cmml" xref="S3.p2.4.m4.2.2.1.1.1.2">𝑊</ci><cn type="integer" id="S3.p2.4.m4.2.2.1.1.1.3.cmml" xref="S3.p2.4.m4.2.2.1.1.1.3">1</cn></apply><ci id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1">…</ci><apply id="S3.p2.4.m4.3.3.2.2.2.cmml" xref="S3.p2.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p2.4.m4.3.3.2.2.2.1.cmml" xref="S3.p2.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S3.p2.4.m4.3.3.2.2.2.2.cmml" xref="S3.p2.4.m4.3.3.2.2.2.2">𝑊</ci><ci id="S3.p2.4.m4.3.3.2.2.2.3.cmml" xref="S3.p2.4.m4.3.3.2.2.2.3">𝐿</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.3c">w=(W_{1},\dots,W_{L})</annotation></semantics></math>, where <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.p2.5.m5.1a"><mi id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><ci id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">L</annotation></semantics></math> is the number of linear layers such as convolutional layers or fully-connected layers, and <math id="S3.p2.6.m6.1" class="ltx_Math" alttext="W_{l}" display="inline"><semantics id="S3.p2.6.m6.1a"><msub id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml"><mi id="S3.p2.6.m6.1.1.2" xref="S3.p2.6.m6.1.1.2.cmml">W</mi><mi id="S3.p2.6.m6.1.1.3" xref="S3.p2.6.m6.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><apply id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.1.cmml" xref="S3.p2.6.m6.1.1">subscript</csymbol><ci id="S3.p2.6.m6.1.1.2.cmml" xref="S3.p2.6.m6.1.1.2">𝑊</ci><ci id="S3.p2.6.m6.1.1.3.cmml" xref="S3.p2.6.m6.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">W_{l}</annotation></semantics></math> is the weight matrix of the <math id="S3.p2.7.m7.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.p2.7.m7.1a"><mi id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><ci id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">l</annotation></semantics></math>-th linear layer. Let <math id="S3.p2.8.m8.1" class="ltx_Math" alttext="f_{i}\colon\mathbb{R}^{d}\rightarrow\mathbb{R}" display="inline"><semantics id="S3.p2.8.m8.1a"><mrow id="S3.p2.8.m8.1.1" xref="S3.p2.8.m8.1.1.cmml"><msub id="S3.p2.8.m8.1.1.2" xref="S3.p2.8.m8.1.1.2.cmml"><mi id="S3.p2.8.m8.1.1.2.2" xref="S3.p2.8.m8.1.1.2.2.cmml">f</mi><mi id="S3.p2.8.m8.1.1.2.3" xref="S3.p2.8.m8.1.1.2.3.cmml">i</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.p2.8.m8.1.1.1" xref="S3.p2.8.m8.1.1.1.cmml">:</mo><mrow id="S3.p2.8.m8.1.1.3" xref="S3.p2.8.m8.1.1.3.cmml"><msup id="S3.p2.8.m8.1.1.3.2" xref="S3.p2.8.m8.1.1.3.2.cmml"><mi id="S3.p2.8.m8.1.1.3.2.2" xref="S3.p2.8.m8.1.1.3.2.2.cmml">ℝ</mi><mi id="S3.p2.8.m8.1.1.3.2.3" xref="S3.p2.8.m8.1.1.3.2.3.cmml">d</mi></msup><mo stretchy="false" id="S3.p2.8.m8.1.1.3.1" xref="S3.p2.8.m8.1.1.3.1.cmml">→</mo><mi id="S3.p2.8.m8.1.1.3.3" xref="S3.p2.8.m8.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.8.m8.1b"><apply id="S3.p2.8.m8.1.1.cmml" xref="S3.p2.8.m8.1.1"><ci id="S3.p2.8.m8.1.1.1.cmml" xref="S3.p2.8.m8.1.1.1">:</ci><apply id="S3.p2.8.m8.1.1.2.cmml" xref="S3.p2.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.p2.8.m8.1.1.2.1.cmml" xref="S3.p2.8.m8.1.1.2">subscript</csymbol><ci id="S3.p2.8.m8.1.1.2.2.cmml" xref="S3.p2.8.m8.1.1.2.2">𝑓</ci><ci id="S3.p2.8.m8.1.1.2.3.cmml" xref="S3.p2.8.m8.1.1.2.3">𝑖</ci></apply><apply id="S3.p2.8.m8.1.1.3.cmml" xref="S3.p2.8.m8.1.1.3"><ci id="S3.p2.8.m8.1.1.3.1.cmml" xref="S3.p2.8.m8.1.1.3.1">→</ci><apply id="S3.p2.8.m8.1.1.3.2.cmml" xref="S3.p2.8.m8.1.1.3.2"><csymbol cd="ambiguous" id="S3.p2.8.m8.1.1.3.2.1.cmml" xref="S3.p2.8.m8.1.1.3.2">superscript</csymbol><ci id="S3.p2.8.m8.1.1.3.2.2.cmml" xref="S3.p2.8.m8.1.1.3.2.2">ℝ</ci><ci id="S3.p2.8.m8.1.1.3.2.3.cmml" xref="S3.p2.8.m8.1.1.3.2.3">𝑑</ci></apply><ci id="S3.p2.8.m8.1.1.3.3.cmml" xref="S3.p2.8.m8.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m8.1c">f_{i}\colon\mathbb{R}^{d}\rightarrow\mathbb{R}</annotation></semantics></math> be the training loss function associated with the training dataset <math id="S3.p2.9.m9.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="S3.p2.9.m9.1a"><msub id="S3.p2.9.m9.1.1" xref="S3.p2.9.m9.1.1.cmml"><mi id="S3.p2.9.m9.1.1.2" xref="S3.p2.9.m9.1.1.2.cmml">D</mi><mi id="S3.p2.9.m9.1.1.3" xref="S3.p2.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.9.m9.1b"><apply id="S3.p2.9.m9.1.1.cmml" xref="S3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p2.9.m9.1.1.1.cmml" xref="S3.p2.9.m9.1.1">subscript</csymbol><ci id="S3.p2.9.m9.1.1.2.cmml" xref="S3.p2.9.m9.1.1.2">𝐷</ci><ci id="S3.p2.9.m9.1.1.3.cmml" xref="S3.p2.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m9.1c">D_{i}</annotation></semantics></math>, which maps the model parameter <math id="S3.p2.10.m10.1" class="ltx_Math" alttext="w\in\mathbb{R}^{d}" display="inline"><semantics id="S3.p2.10.m10.1a"><mrow id="S3.p2.10.m10.1.1" xref="S3.p2.10.m10.1.1.cmml"><mi id="S3.p2.10.m10.1.1.2" xref="S3.p2.10.m10.1.1.2.cmml">w</mi><mo id="S3.p2.10.m10.1.1.1" xref="S3.p2.10.m10.1.1.1.cmml">∈</mo><msup id="S3.p2.10.m10.1.1.3" xref="S3.p2.10.m10.1.1.3.cmml"><mi id="S3.p2.10.m10.1.1.3.2" xref="S3.p2.10.m10.1.1.3.2.cmml">ℝ</mi><mi id="S3.p2.10.m10.1.1.3.3" xref="S3.p2.10.m10.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.10.m10.1b"><apply id="S3.p2.10.m10.1.1.cmml" xref="S3.p2.10.m10.1.1"><in id="S3.p2.10.m10.1.1.1.cmml" xref="S3.p2.10.m10.1.1.1"></in><ci id="S3.p2.10.m10.1.1.2.cmml" xref="S3.p2.10.m10.1.1.2">𝑤</ci><apply id="S3.p2.10.m10.1.1.3.cmml" xref="S3.p2.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.p2.10.m10.1.1.3.1.cmml" xref="S3.p2.10.m10.1.1.3">superscript</csymbol><ci id="S3.p2.10.m10.1.1.3.2.cmml" xref="S3.p2.10.m10.1.1.3.2">ℝ</ci><ci id="S3.p2.10.m10.1.1.3.3.cmml" xref="S3.p2.10.m10.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.10.m10.1c">w\in\mathbb{R}^{d}</annotation></semantics></math> into the real value. Traditional FL aims to find a global model <math id="S3.p2.11.m11.1" class="ltx_Math" alttext="w^{*}" display="inline"><semantics id="S3.p2.11.m11.1a"><msup id="S3.p2.11.m11.1.1" xref="S3.p2.11.m11.1.1.cmml"><mi id="S3.p2.11.m11.1.1.2" xref="S3.p2.11.m11.1.1.2.cmml">w</mi><mo id="S3.p2.11.m11.1.1.3" xref="S3.p2.11.m11.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p2.11.m11.1b"><apply id="S3.p2.11.m11.1.1.cmml" xref="S3.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.p2.11.m11.1.1.1.cmml" xref="S3.p2.11.m11.1.1">superscript</csymbol><ci id="S3.p2.11.m11.1.1.2.cmml" xref="S3.p2.11.m11.1.1.2">𝑤</ci><times id="S3.p2.11.m11.1.1.3.cmml" xref="S3.p2.11.m11.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.11.m11.1c">w^{*}</annotation></semantics></math> by solving the optimization problem <math id="S3.p2.12.m12.1" class="ltx_Math" alttext="w^{*}=\operatorname*{arg\,min}_{w\in\mathbb{R}^{d}}\sum_{i=1}^{N}f_{i}(w)" display="inline"><semantics id="S3.p2.12.m12.1a"><mrow id="S3.p2.12.m12.1.2" xref="S3.p2.12.m12.1.2.cmml"><msup id="S3.p2.12.m12.1.2.2" xref="S3.p2.12.m12.1.2.2.cmml"><mi id="S3.p2.12.m12.1.2.2.2" xref="S3.p2.12.m12.1.2.2.2.cmml">w</mi><mo id="S3.p2.12.m12.1.2.2.3" xref="S3.p2.12.m12.1.2.2.3.cmml">∗</mo></msup><mo id="S3.p2.12.m12.1.2.1" xref="S3.p2.12.m12.1.2.1.cmml">=</mo><mrow id="S3.p2.12.m12.1.2.3" xref="S3.p2.12.m12.1.2.3.cmml"><msub id="S3.p2.12.m12.1.2.3.2" xref="S3.p2.12.m12.1.2.3.2.cmml"><mrow id="S3.p2.12.m12.1.2.3.2.2" xref="S3.p2.12.m12.1.2.3.2.2.cmml"><mi id="S3.p2.12.m12.1.2.3.2.2.2" xref="S3.p2.12.m12.1.2.3.2.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.p2.12.m12.1.2.3.2.2.1" xref="S3.p2.12.m12.1.2.3.2.2.1.cmml">​</mo><mi id="S3.p2.12.m12.1.2.3.2.2.3" xref="S3.p2.12.m12.1.2.3.2.2.3.cmml">min</mi></mrow><mrow id="S3.p2.12.m12.1.2.3.2.3" xref="S3.p2.12.m12.1.2.3.2.3.cmml"><mi id="S3.p2.12.m12.1.2.3.2.3.2" xref="S3.p2.12.m12.1.2.3.2.3.2.cmml">w</mi><mo id="S3.p2.12.m12.1.2.3.2.3.1" xref="S3.p2.12.m12.1.2.3.2.3.1.cmml">∈</mo><msup id="S3.p2.12.m12.1.2.3.2.3.3" xref="S3.p2.12.m12.1.2.3.2.3.3.cmml"><mi id="S3.p2.12.m12.1.2.3.2.3.3.2" xref="S3.p2.12.m12.1.2.3.2.3.3.2.cmml">ℝ</mi><mi id="S3.p2.12.m12.1.2.3.2.3.3.3" xref="S3.p2.12.m12.1.2.3.2.3.3.3.cmml">d</mi></msup></mrow></msub><mo lspace="0em" rspace="0em" id="S3.p2.12.m12.1.2.3.1" xref="S3.p2.12.m12.1.2.3.1.cmml">​</mo><mrow id="S3.p2.12.m12.1.2.3.3" xref="S3.p2.12.m12.1.2.3.3.cmml"><msubsup id="S3.p2.12.m12.1.2.3.3.1" xref="S3.p2.12.m12.1.2.3.3.1.cmml"><mo id="S3.p2.12.m12.1.2.3.3.1.2.2" xref="S3.p2.12.m12.1.2.3.3.1.2.2.cmml">∑</mo><mrow id="S3.p2.12.m12.1.2.3.3.1.2.3" xref="S3.p2.12.m12.1.2.3.3.1.2.3.cmml"><mi id="S3.p2.12.m12.1.2.3.3.1.2.3.2" xref="S3.p2.12.m12.1.2.3.3.1.2.3.2.cmml">i</mi><mo id="S3.p2.12.m12.1.2.3.3.1.2.3.1" xref="S3.p2.12.m12.1.2.3.3.1.2.3.1.cmml">=</mo><mn id="S3.p2.12.m12.1.2.3.3.1.2.3.3" xref="S3.p2.12.m12.1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.p2.12.m12.1.2.3.3.1.3" xref="S3.p2.12.m12.1.2.3.3.1.3.cmml">N</mi></msubsup><mrow id="S3.p2.12.m12.1.2.3.3.2" xref="S3.p2.12.m12.1.2.3.3.2.cmml"><msub id="S3.p2.12.m12.1.2.3.3.2.2" xref="S3.p2.12.m12.1.2.3.3.2.2.cmml"><mi id="S3.p2.12.m12.1.2.3.3.2.2.2" xref="S3.p2.12.m12.1.2.3.3.2.2.2.cmml">f</mi><mi id="S3.p2.12.m12.1.2.3.3.2.2.3" xref="S3.p2.12.m12.1.2.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.p2.12.m12.1.2.3.3.2.1" xref="S3.p2.12.m12.1.2.3.3.2.1.cmml">​</mo><mrow id="S3.p2.12.m12.1.2.3.3.2.3.2" xref="S3.p2.12.m12.1.2.3.3.2.cmml"><mo stretchy="false" id="S3.p2.12.m12.1.2.3.3.2.3.2.1" xref="S3.p2.12.m12.1.2.3.3.2.cmml">(</mo><mi id="S3.p2.12.m12.1.1" xref="S3.p2.12.m12.1.1.cmml">w</mi><mo stretchy="false" id="S3.p2.12.m12.1.2.3.3.2.3.2.2" xref="S3.p2.12.m12.1.2.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.12.m12.1b"><apply id="S3.p2.12.m12.1.2.cmml" xref="S3.p2.12.m12.1.2"><eq id="S3.p2.12.m12.1.2.1.cmml" xref="S3.p2.12.m12.1.2.1"></eq><apply id="S3.p2.12.m12.1.2.2.cmml" xref="S3.p2.12.m12.1.2.2"><csymbol cd="ambiguous" id="S3.p2.12.m12.1.2.2.1.cmml" xref="S3.p2.12.m12.1.2.2">superscript</csymbol><ci id="S3.p2.12.m12.1.2.2.2.cmml" xref="S3.p2.12.m12.1.2.2.2">𝑤</ci><times id="S3.p2.12.m12.1.2.2.3.cmml" xref="S3.p2.12.m12.1.2.2.3"></times></apply><apply id="S3.p2.12.m12.1.2.3.cmml" xref="S3.p2.12.m12.1.2.3"><times id="S3.p2.12.m12.1.2.3.1.cmml" xref="S3.p2.12.m12.1.2.3.1"></times><apply id="S3.p2.12.m12.1.2.3.2.cmml" xref="S3.p2.12.m12.1.2.3.2"><csymbol cd="ambiguous" id="S3.p2.12.m12.1.2.3.2.1.cmml" xref="S3.p2.12.m12.1.2.3.2">subscript</csymbol><apply id="S3.p2.12.m12.1.2.3.2.2.cmml" xref="S3.p2.12.m12.1.2.3.2.2"><times id="S3.p2.12.m12.1.2.3.2.2.1.cmml" xref="S3.p2.12.m12.1.2.3.2.2.1"></times><ci id="S3.p2.12.m12.1.2.3.2.2.2.cmml" xref="S3.p2.12.m12.1.2.3.2.2.2">arg</ci><ci id="S3.p2.12.m12.1.2.3.2.2.3.cmml" xref="S3.p2.12.m12.1.2.3.2.2.3">min</ci></apply><apply id="S3.p2.12.m12.1.2.3.2.3.cmml" xref="S3.p2.12.m12.1.2.3.2.3"><in id="S3.p2.12.m12.1.2.3.2.3.1.cmml" xref="S3.p2.12.m12.1.2.3.2.3.1"></in><ci id="S3.p2.12.m12.1.2.3.2.3.2.cmml" xref="S3.p2.12.m12.1.2.3.2.3.2">𝑤</ci><apply id="S3.p2.12.m12.1.2.3.2.3.3.cmml" xref="S3.p2.12.m12.1.2.3.2.3.3"><csymbol cd="ambiguous" id="S3.p2.12.m12.1.2.3.2.3.3.1.cmml" xref="S3.p2.12.m12.1.2.3.2.3.3">superscript</csymbol><ci id="S3.p2.12.m12.1.2.3.2.3.3.2.cmml" xref="S3.p2.12.m12.1.2.3.2.3.3.2">ℝ</ci><ci id="S3.p2.12.m12.1.2.3.2.3.3.3.cmml" xref="S3.p2.12.m12.1.2.3.2.3.3.3">𝑑</ci></apply></apply></apply><apply id="S3.p2.12.m12.1.2.3.3.cmml" xref="S3.p2.12.m12.1.2.3.3"><apply id="S3.p2.12.m12.1.2.3.3.1.cmml" xref="S3.p2.12.m12.1.2.3.3.1"><csymbol cd="ambiguous" id="S3.p2.12.m12.1.2.3.3.1.1.cmml" xref="S3.p2.12.m12.1.2.3.3.1">superscript</csymbol><apply id="S3.p2.12.m12.1.2.3.3.1.2.cmml" xref="S3.p2.12.m12.1.2.3.3.1"><csymbol cd="ambiguous" id="S3.p2.12.m12.1.2.3.3.1.2.1.cmml" xref="S3.p2.12.m12.1.2.3.3.1">subscript</csymbol><sum id="S3.p2.12.m12.1.2.3.3.1.2.2.cmml" xref="S3.p2.12.m12.1.2.3.3.1.2.2"></sum><apply id="S3.p2.12.m12.1.2.3.3.1.2.3.cmml" xref="S3.p2.12.m12.1.2.3.3.1.2.3"><eq id="S3.p2.12.m12.1.2.3.3.1.2.3.1.cmml" xref="S3.p2.12.m12.1.2.3.3.1.2.3.1"></eq><ci id="S3.p2.12.m12.1.2.3.3.1.2.3.2.cmml" xref="S3.p2.12.m12.1.2.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.p2.12.m12.1.2.3.3.1.2.3.3.cmml" xref="S3.p2.12.m12.1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.p2.12.m12.1.2.3.3.1.3.cmml" xref="S3.p2.12.m12.1.2.3.3.1.3">𝑁</ci></apply><apply id="S3.p2.12.m12.1.2.3.3.2.cmml" xref="S3.p2.12.m12.1.2.3.3.2"><times id="S3.p2.12.m12.1.2.3.3.2.1.cmml" xref="S3.p2.12.m12.1.2.3.3.2.1"></times><apply id="S3.p2.12.m12.1.2.3.3.2.2.cmml" xref="S3.p2.12.m12.1.2.3.3.2.2"><csymbol cd="ambiguous" id="S3.p2.12.m12.1.2.3.3.2.2.1.cmml" xref="S3.p2.12.m12.1.2.3.3.2.2">subscript</csymbol><ci id="S3.p2.12.m12.1.2.3.3.2.2.2.cmml" xref="S3.p2.12.m12.1.2.3.3.2.2.2">𝑓</ci><ci id="S3.p2.12.m12.1.2.3.3.2.2.3.cmml" xref="S3.p2.12.m12.1.2.3.3.2.2.3">𝑖</ci></apply><ci id="S3.p2.12.m12.1.1.cmml" xref="S3.p2.12.m12.1.1">𝑤</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.12.m12.1c">w^{*}=\operatorname*{arg\,min}_{w\in\mathbb{R}^{d}}\sum_{i=1}^{N}f_{i}(w)</annotation></semantics></math>.
In contrast, PFL tries to find the optimal set of personalized model parameters <math id="S3.p2.13.m13.7" class="ltx_Math" alttext="\{w_{1}^{*},\dots,w_{N}^{*}\}=\operatorname*{arg\,min}_{w_{1},\dots,w_{N}\in\mathbb{R}^{d}}\sum_{i=1}^{N}f_{i}(w_{i})" display="inline"><semantics id="S3.p2.13.m13.7a"><mrow id="S3.p2.13.m13.7.7" xref="S3.p2.13.m13.7.7.cmml"><mrow id="S3.p2.13.m13.6.6.2.2" xref="S3.p2.13.m13.6.6.2.3.cmml"><mo stretchy="false" id="S3.p2.13.m13.6.6.2.2.3" xref="S3.p2.13.m13.6.6.2.3.cmml">{</mo><msubsup id="S3.p2.13.m13.5.5.1.1.1" xref="S3.p2.13.m13.5.5.1.1.1.cmml"><mi id="S3.p2.13.m13.5.5.1.1.1.2.2" xref="S3.p2.13.m13.5.5.1.1.1.2.2.cmml">w</mi><mn id="S3.p2.13.m13.5.5.1.1.1.2.3" xref="S3.p2.13.m13.5.5.1.1.1.2.3.cmml">1</mn><mo id="S3.p2.13.m13.5.5.1.1.1.3" xref="S3.p2.13.m13.5.5.1.1.1.3.cmml">∗</mo></msubsup><mo id="S3.p2.13.m13.6.6.2.2.4" xref="S3.p2.13.m13.6.6.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.p2.13.m13.4.4" xref="S3.p2.13.m13.4.4.cmml">…</mi><mo id="S3.p2.13.m13.6.6.2.2.5" xref="S3.p2.13.m13.6.6.2.3.cmml">,</mo><msubsup id="S3.p2.13.m13.6.6.2.2.2" xref="S3.p2.13.m13.6.6.2.2.2.cmml"><mi id="S3.p2.13.m13.6.6.2.2.2.2.2" xref="S3.p2.13.m13.6.6.2.2.2.2.2.cmml">w</mi><mi id="S3.p2.13.m13.6.6.2.2.2.2.3" xref="S3.p2.13.m13.6.6.2.2.2.2.3.cmml">N</mi><mo id="S3.p2.13.m13.6.6.2.2.2.3" xref="S3.p2.13.m13.6.6.2.2.2.3.cmml">∗</mo></msubsup><mo stretchy="false" id="S3.p2.13.m13.6.6.2.2.6" xref="S3.p2.13.m13.6.6.2.3.cmml">}</mo></mrow><mo id="S3.p2.13.m13.7.7.4" xref="S3.p2.13.m13.7.7.4.cmml">=</mo><mrow id="S3.p2.13.m13.7.7.3" xref="S3.p2.13.m13.7.7.3.cmml"><msub id="S3.p2.13.m13.7.7.3.3" xref="S3.p2.13.m13.7.7.3.3.cmml"><mrow id="S3.p2.13.m13.7.7.3.3.2" xref="S3.p2.13.m13.7.7.3.3.2.cmml"><mi id="S3.p2.13.m13.7.7.3.3.2.2" xref="S3.p2.13.m13.7.7.3.3.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.p2.13.m13.7.7.3.3.2.1" xref="S3.p2.13.m13.7.7.3.3.2.1.cmml">​</mo><mi id="S3.p2.13.m13.7.7.3.3.2.3" xref="S3.p2.13.m13.7.7.3.3.2.3.cmml">min</mi></mrow><mrow id="S3.p2.13.m13.3.3.3" xref="S3.p2.13.m13.3.3.3.cmml"><mrow id="S3.p2.13.m13.3.3.3.3.2" xref="S3.p2.13.m13.3.3.3.3.3.cmml"><msub id="S3.p2.13.m13.2.2.2.2.1.1" xref="S3.p2.13.m13.2.2.2.2.1.1.cmml"><mi id="S3.p2.13.m13.2.2.2.2.1.1.2" xref="S3.p2.13.m13.2.2.2.2.1.1.2.cmml">w</mi><mn id="S3.p2.13.m13.2.2.2.2.1.1.3" xref="S3.p2.13.m13.2.2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.p2.13.m13.3.3.3.3.2.3" xref="S3.p2.13.m13.3.3.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.p2.13.m13.1.1.1.1" xref="S3.p2.13.m13.1.1.1.1.cmml">…</mi><mo id="S3.p2.13.m13.3.3.3.3.2.4" xref="S3.p2.13.m13.3.3.3.3.3.cmml">,</mo><msub id="S3.p2.13.m13.3.3.3.3.2.2" xref="S3.p2.13.m13.3.3.3.3.2.2.cmml"><mi id="S3.p2.13.m13.3.3.3.3.2.2.2" xref="S3.p2.13.m13.3.3.3.3.2.2.2.cmml">w</mi><mi id="S3.p2.13.m13.3.3.3.3.2.2.3" xref="S3.p2.13.m13.3.3.3.3.2.2.3.cmml">N</mi></msub></mrow><mo id="S3.p2.13.m13.3.3.3.4" xref="S3.p2.13.m13.3.3.3.4.cmml">∈</mo><msup id="S3.p2.13.m13.3.3.3.5" xref="S3.p2.13.m13.3.3.3.5.cmml"><mi id="S3.p2.13.m13.3.3.3.5.2" xref="S3.p2.13.m13.3.3.3.5.2.cmml">ℝ</mi><mi id="S3.p2.13.m13.3.3.3.5.3" xref="S3.p2.13.m13.3.3.3.5.3.cmml">d</mi></msup></mrow></msub><mo lspace="0em" rspace="0em" id="S3.p2.13.m13.7.7.3.2" xref="S3.p2.13.m13.7.7.3.2.cmml">​</mo><mrow id="S3.p2.13.m13.7.7.3.1" xref="S3.p2.13.m13.7.7.3.1.cmml"><msubsup id="S3.p2.13.m13.7.7.3.1.2" xref="S3.p2.13.m13.7.7.3.1.2.cmml"><mo id="S3.p2.13.m13.7.7.3.1.2.2.2" xref="S3.p2.13.m13.7.7.3.1.2.2.2.cmml">∑</mo><mrow id="S3.p2.13.m13.7.7.3.1.2.2.3" xref="S3.p2.13.m13.7.7.3.1.2.2.3.cmml"><mi id="S3.p2.13.m13.7.7.3.1.2.2.3.2" xref="S3.p2.13.m13.7.7.3.1.2.2.3.2.cmml">i</mi><mo id="S3.p2.13.m13.7.7.3.1.2.2.3.1" xref="S3.p2.13.m13.7.7.3.1.2.2.3.1.cmml">=</mo><mn id="S3.p2.13.m13.7.7.3.1.2.2.3.3" xref="S3.p2.13.m13.7.7.3.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.p2.13.m13.7.7.3.1.2.3" xref="S3.p2.13.m13.7.7.3.1.2.3.cmml">N</mi></msubsup><mrow id="S3.p2.13.m13.7.7.3.1.1" xref="S3.p2.13.m13.7.7.3.1.1.cmml"><msub id="S3.p2.13.m13.7.7.3.1.1.3" xref="S3.p2.13.m13.7.7.3.1.1.3.cmml"><mi id="S3.p2.13.m13.7.7.3.1.1.3.2" xref="S3.p2.13.m13.7.7.3.1.1.3.2.cmml">f</mi><mi id="S3.p2.13.m13.7.7.3.1.1.3.3" xref="S3.p2.13.m13.7.7.3.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.p2.13.m13.7.7.3.1.1.2" xref="S3.p2.13.m13.7.7.3.1.1.2.cmml">​</mo><mrow id="S3.p2.13.m13.7.7.3.1.1.1.1" xref="S3.p2.13.m13.7.7.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p2.13.m13.7.7.3.1.1.1.1.2" xref="S3.p2.13.m13.7.7.3.1.1.1.1.1.cmml">(</mo><msub id="S3.p2.13.m13.7.7.3.1.1.1.1.1" xref="S3.p2.13.m13.7.7.3.1.1.1.1.1.cmml"><mi id="S3.p2.13.m13.7.7.3.1.1.1.1.1.2" xref="S3.p2.13.m13.7.7.3.1.1.1.1.1.2.cmml">w</mi><mi id="S3.p2.13.m13.7.7.3.1.1.1.1.1.3" xref="S3.p2.13.m13.7.7.3.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.p2.13.m13.7.7.3.1.1.1.1.3" xref="S3.p2.13.m13.7.7.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.13.m13.7b"><apply id="S3.p2.13.m13.7.7.cmml" xref="S3.p2.13.m13.7.7"><eq id="S3.p2.13.m13.7.7.4.cmml" xref="S3.p2.13.m13.7.7.4"></eq><set id="S3.p2.13.m13.6.6.2.3.cmml" xref="S3.p2.13.m13.6.6.2.2"><apply id="S3.p2.13.m13.5.5.1.1.1.cmml" xref="S3.p2.13.m13.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.p2.13.m13.5.5.1.1.1.1.cmml" xref="S3.p2.13.m13.5.5.1.1.1">superscript</csymbol><apply id="S3.p2.13.m13.5.5.1.1.1.2.cmml" xref="S3.p2.13.m13.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.p2.13.m13.5.5.1.1.1.2.1.cmml" xref="S3.p2.13.m13.5.5.1.1.1">subscript</csymbol><ci id="S3.p2.13.m13.5.5.1.1.1.2.2.cmml" xref="S3.p2.13.m13.5.5.1.1.1.2.2">𝑤</ci><cn type="integer" id="S3.p2.13.m13.5.5.1.1.1.2.3.cmml" xref="S3.p2.13.m13.5.5.1.1.1.2.3">1</cn></apply><times id="S3.p2.13.m13.5.5.1.1.1.3.cmml" xref="S3.p2.13.m13.5.5.1.1.1.3"></times></apply><ci id="S3.p2.13.m13.4.4.cmml" xref="S3.p2.13.m13.4.4">…</ci><apply id="S3.p2.13.m13.6.6.2.2.2.cmml" xref="S3.p2.13.m13.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.p2.13.m13.6.6.2.2.2.1.cmml" xref="S3.p2.13.m13.6.6.2.2.2">superscript</csymbol><apply id="S3.p2.13.m13.6.6.2.2.2.2.cmml" xref="S3.p2.13.m13.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.p2.13.m13.6.6.2.2.2.2.1.cmml" xref="S3.p2.13.m13.6.6.2.2.2">subscript</csymbol><ci id="S3.p2.13.m13.6.6.2.2.2.2.2.cmml" xref="S3.p2.13.m13.6.6.2.2.2.2.2">𝑤</ci><ci id="S3.p2.13.m13.6.6.2.2.2.2.3.cmml" xref="S3.p2.13.m13.6.6.2.2.2.2.3">𝑁</ci></apply><times id="S3.p2.13.m13.6.6.2.2.2.3.cmml" xref="S3.p2.13.m13.6.6.2.2.2.3"></times></apply></set><apply id="S3.p2.13.m13.7.7.3.cmml" xref="S3.p2.13.m13.7.7.3"><times id="S3.p2.13.m13.7.7.3.2.cmml" xref="S3.p2.13.m13.7.7.3.2"></times><apply id="S3.p2.13.m13.7.7.3.3.cmml" xref="S3.p2.13.m13.7.7.3.3"><csymbol cd="ambiguous" id="S3.p2.13.m13.7.7.3.3.1.cmml" xref="S3.p2.13.m13.7.7.3.3">subscript</csymbol><apply id="S3.p2.13.m13.7.7.3.3.2.cmml" xref="S3.p2.13.m13.7.7.3.3.2"><times id="S3.p2.13.m13.7.7.3.3.2.1.cmml" xref="S3.p2.13.m13.7.7.3.3.2.1"></times><ci id="S3.p2.13.m13.7.7.3.3.2.2.cmml" xref="S3.p2.13.m13.7.7.3.3.2.2">arg</ci><ci id="S3.p2.13.m13.7.7.3.3.2.3.cmml" xref="S3.p2.13.m13.7.7.3.3.2.3">min</ci></apply><apply id="S3.p2.13.m13.3.3.3.cmml" xref="S3.p2.13.m13.3.3.3"><in id="S3.p2.13.m13.3.3.3.4.cmml" xref="S3.p2.13.m13.3.3.3.4"></in><list id="S3.p2.13.m13.3.3.3.3.3.cmml" xref="S3.p2.13.m13.3.3.3.3.2"><apply id="S3.p2.13.m13.2.2.2.2.1.1.cmml" xref="S3.p2.13.m13.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.p2.13.m13.2.2.2.2.1.1.1.cmml" xref="S3.p2.13.m13.2.2.2.2.1.1">subscript</csymbol><ci id="S3.p2.13.m13.2.2.2.2.1.1.2.cmml" xref="S3.p2.13.m13.2.2.2.2.1.1.2">𝑤</ci><cn type="integer" id="S3.p2.13.m13.2.2.2.2.1.1.3.cmml" xref="S3.p2.13.m13.2.2.2.2.1.1.3">1</cn></apply><ci id="S3.p2.13.m13.1.1.1.1.cmml" xref="S3.p2.13.m13.1.1.1.1">…</ci><apply id="S3.p2.13.m13.3.3.3.3.2.2.cmml" xref="S3.p2.13.m13.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.p2.13.m13.3.3.3.3.2.2.1.cmml" xref="S3.p2.13.m13.3.3.3.3.2.2">subscript</csymbol><ci id="S3.p2.13.m13.3.3.3.3.2.2.2.cmml" xref="S3.p2.13.m13.3.3.3.3.2.2.2">𝑤</ci><ci id="S3.p2.13.m13.3.3.3.3.2.2.3.cmml" xref="S3.p2.13.m13.3.3.3.3.2.2.3">𝑁</ci></apply></list><apply id="S3.p2.13.m13.3.3.3.5.cmml" xref="S3.p2.13.m13.3.3.3.5"><csymbol cd="ambiguous" id="S3.p2.13.m13.3.3.3.5.1.cmml" xref="S3.p2.13.m13.3.3.3.5">superscript</csymbol><ci id="S3.p2.13.m13.3.3.3.5.2.cmml" xref="S3.p2.13.m13.3.3.3.5.2">ℝ</ci><ci id="S3.p2.13.m13.3.3.3.5.3.cmml" xref="S3.p2.13.m13.3.3.3.5.3">𝑑</ci></apply></apply></apply><apply id="S3.p2.13.m13.7.7.3.1.cmml" xref="S3.p2.13.m13.7.7.3.1"><apply id="S3.p2.13.m13.7.7.3.1.2.cmml" xref="S3.p2.13.m13.7.7.3.1.2"><csymbol cd="ambiguous" id="S3.p2.13.m13.7.7.3.1.2.1.cmml" xref="S3.p2.13.m13.7.7.3.1.2">superscript</csymbol><apply id="S3.p2.13.m13.7.7.3.1.2.2.cmml" xref="S3.p2.13.m13.7.7.3.1.2"><csymbol cd="ambiguous" id="S3.p2.13.m13.7.7.3.1.2.2.1.cmml" xref="S3.p2.13.m13.7.7.3.1.2">subscript</csymbol><sum id="S3.p2.13.m13.7.7.3.1.2.2.2.cmml" xref="S3.p2.13.m13.7.7.3.1.2.2.2"></sum><apply id="S3.p2.13.m13.7.7.3.1.2.2.3.cmml" xref="S3.p2.13.m13.7.7.3.1.2.2.3"><eq id="S3.p2.13.m13.7.7.3.1.2.2.3.1.cmml" xref="S3.p2.13.m13.7.7.3.1.2.2.3.1"></eq><ci id="S3.p2.13.m13.7.7.3.1.2.2.3.2.cmml" xref="S3.p2.13.m13.7.7.3.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.p2.13.m13.7.7.3.1.2.2.3.3.cmml" xref="S3.p2.13.m13.7.7.3.1.2.2.3.3">1</cn></apply></apply><ci id="S3.p2.13.m13.7.7.3.1.2.3.cmml" xref="S3.p2.13.m13.7.7.3.1.2.3">𝑁</ci></apply><apply id="S3.p2.13.m13.7.7.3.1.1.cmml" xref="S3.p2.13.m13.7.7.3.1.1"><times id="S3.p2.13.m13.7.7.3.1.1.2.cmml" xref="S3.p2.13.m13.7.7.3.1.1.2"></times><apply id="S3.p2.13.m13.7.7.3.1.1.3.cmml" xref="S3.p2.13.m13.7.7.3.1.1.3"><csymbol cd="ambiguous" id="S3.p2.13.m13.7.7.3.1.1.3.1.cmml" xref="S3.p2.13.m13.7.7.3.1.1.3">subscript</csymbol><ci id="S3.p2.13.m13.7.7.3.1.1.3.2.cmml" xref="S3.p2.13.m13.7.7.3.1.1.3.2">𝑓</ci><ci id="S3.p2.13.m13.7.7.3.1.1.3.3.cmml" xref="S3.p2.13.m13.7.7.3.1.1.3.3">𝑖</ci></apply><apply id="S3.p2.13.m13.7.7.3.1.1.1.1.1.cmml" xref="S3.p2.13.m13.7.7.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.13.m13.7.7.3.1.1.1.1.1.1.cmml" xref="S3.p2.13.m13.7.7.3.1.1.1.1">subscript</csymbol><ci id="S3.p2.13.m13.7.7.3.1.1.1.1.1.2.cmml" xref="S3.p2.13.m13.7.7.3.1.1.1.1.1.2">𝑤</ci><ci id="S3.p2.13.m13.7.7.3.1.1.1.1.1.3.cmml" xref="S3.p2.13.m13.7.7.3.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.13.m13.7c">\{w_{1}^{*},\dots,w_{N}^{*}\}=\operatorname*{arg\,min}_{w_{1},\dots,w_{N}\in\mathbb{R}^{d}}\sum_{i=1}^{N}f_{i}(w_{i})</annotation></semantics></math>.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">PROPOSED METHOD</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we provide details of our proposed method, <span id="S4.p1.1.1" class="ltx_text ltx_font_italic">personalized federated learning with multi-branch architecture</span> (pFedMB).</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.4.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.5.2" class="ltx_text ltx_font_italic">Architecture</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.2" class="ltx_p">We first introduce the architecture of pFedMB. Our pFedMB splits each linear layer of a neural network into <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">B</annotation></semantics></math> branches like CondConv <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, i.e., <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="W_{l}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><msub id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">W</mi><mi id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝑊</ci><ci id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">W_{l}</annotation></semantics></math> is represented as</p>
<table id="S4.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E1.m1.9" class="ltx_Math" alttext="W_{l}=\alpha_{1,l}W_{1,l}+\dots+\alpha_{B,l}W_{B,l}," display="block"><semantics id="S4.E1.m1.9a"><mrow id="S4.E1.m1.9.9.1" xref="S4.E1.m1.9.9.1.1.cmml"><mrow id="S4.E1.m1.9.9.1.1" xref="S4.E1.m1.9.9.1.1.cmml"><msub id="S4.E1.m1.9.9.1.1.2" xref="S4.E1.m1.9.9.1.1.2.cmml"><mi id="S4.E1.m1.9.9.1.1.2.2" xref="S4.E1.m1.9.9.1.1.2.2.cmml">W</mi><mi id="S4.E1.m1.9.9.1.1.2.3" xref="S4.E1.m1.9.9.1.1.2.3.cmml">l</mi></msub><mo id="S4.E1.m1.9.9.1.1.1" xref="S4.E1.m1.9.9.1.1.1.cmml">=</mo><mrow id="S4.E1.m1.9.9.1.1.3" xref="S4.E1.m1.9.9.1.1.3.cmml"><mrow id="S4.E1.m1.9.9.1.1.3.2" xref="S4.E1.m1.9.9.1.1.3.2.cmml"><msub id="S4.E1.m1.9.9.1.1.3.2.2" xref="S4.E1.m1.9.9.1.1.3.2.2.cmml"><mi id="S4.E1.m1.9.9.1.1.3.2.2.2" xref="S4.E1.m1.9.9.1.1.3.2.2.2.cmml">α</mi><mrow id="S4.E1.m1.2.2.2.4" xref="S4.E1.m1.2.2.2.3.cmml"><mn id="S4.E1.m1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.cmml">1</mn><mo id="S4.E1.m1.2.2.2.4.1" xref="S4.E1.m1.2.2.2.3.cmml">,</mo><mi id="S4.E1.m1.2.2.2.2" xref="S4.E1.m1.2.2.2.2.cmml">l</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.9.9.1.1.3.2.1" xref="S4.E1.m1.9.9.1.1.3.2.1.cmml">​</mo><msub id="S4.E1.m1.9.9.1.1.3.2.3" xref="S4.E1.m1.9.9.1.1.3.2.3.cmml"><mi id="S4.E1.m1.9.9.1.1.3.2.3.2" xref="S4.E1.m1.9.9.1.1.3.2.3.2.cmml">W</mi><mrow id="S4.E1.m1.4.4.2.4" xref="S4.E1.m1.4.4.2.3.cmml"><mn id="S4.E1.m1.3.3.1.1" xref="S4.E1.m1.3.3.1.1.cmml">1</mn><mo id="S4.E1.m1.4.4.2.4.1" xref="S4.E1.m1.4.4.2.3.cmml">,</mo><mi id="S4.E1.m1.4.4.2.2" xref="S4.E1.m1.4.4.2.2.cmml">l</mi></mrow></msub></mrow><mo id="S4.E1.m1.9.9.1.1.3.1" xref="S4.E1.m1.9.9.1.1.3.1.cmml">+</mo><mi mathvariant="normal" id="S4.E1.m1.9.9.1.1.3.3" xref="S4.E1.m1.9.9.1.1.3.3.cmml">⋯</mi><mo id="S4.E1.m1.9.9.1.1.3.1a" xref="S4.E1.m1.9.9.1.1.3.1.cmml">+</mo><mrow id="S4.E1.m1.9.9.1.1.3.4" xref="S4.E1.m1.9.9.1.1.3.4.cmml"><msub id="S4.E1.m1.9.9.1.1.3.4.2" xref="S4.E1.m1.9.9.1.1.3.4.2.cmml"><mi id="S4.E1.m1.9.9.1.1.3.4.2.2" xref="S4.E1.m1.9.9.1.1.3.4.2.2.cmml">α</mi><mrow id="S4.E1.m1.6.6.2.4" xref="S4.E1.m1.6.6.2.3.cmml"><mi id="S4.E1.m1.5.5.1.1" xref="S4.E1.m1.5.5.1.1.cmml">B</mi><mo id="S4.E1.m1.6.6.2.4.1" xref="S4.E1.m1.6.6.2.3.cmml">,</mo><mi id="S4.E1.m1.6.6.2.2" xref="S4.E1.m1.6.6.2.2.cmml">l</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.9.9.1.1.3.4.1" xref="S4.E1.m1.9.9.1.1.3.4.1.cmml">​</mo><msub id="S4.E1.m1.9.9.1.1.3.4.3" xref="S4.E1.m1.9.9.1.1.3.4.3.cmml"><mi id="S4.E1.m1.9.9.1.1.3.4.3.2" xref="S4.E1.m1.9.9.1.1.3.4.3.2.cmml">W</mi><mrow id="S4.E1.m1.8.8.2.4" xref="S4.E1.m1.8.8.2.3.cmml"><mi id="S4.E1.m1.7.7.1.1" xref="S4.E1.m1.7.7.1.1.cmml">B</mi><mo id="S4.E1.m1.8.8.2.4.1" xref="S4.E1.m1.8.8.2.3.cmml">,</mo><mi id="S4.E1.m1.8.8.2.2" xref="S4.E1.m1.8.8.2.2.cmml">l</mi></mrow></msub></mrow></mrow></mrow><mo id="S4.E1.m1.9.9.1.2" xref="S4.E1.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.9b"><apply id="S4.E1.m1.9.9.1.1.cmml" xref="S4.E1.m1.9.9.1"><eq id="S4.E1.m1.9.9.1.1.1.cmml" xref="S4.E1.m1.9.9.1.1.1"></eq><apply id="S4.E1.m1.9.9.1.1.2.cmml" xref="S4.E1.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.9.9.1.1.2.1.cmml" xref="S4.E1.m1.9.9.1.1.2">subscript</csymbol><ci id="S4.E1.m1.9.9.1.1.2.2.cmml" xref="S4.E1.m1.9.9.1.1.2.2">𝑊</ci><ci id="S4.E1.m1.9.9.1.1.2.3.cmml" xref="S4.E1.m1.9.9.1.1.2.3">𝑙</ci></apply><apply id="S4.E1.m1.9.9.1.1.3.cmml" xref="S4.E1.m1.9.9.1.1.3"><plus id="S4.E1.m1.9.9.1.1.3.1.cmml" xref="S4.E1.m1.9.9.1.1.3.1"></plus><apply id="S4.E1.m1.9.9.1.1.3.2.cmml" xref="S4.E1.m1.9.9.1.1.3.2"><times id="S4.E1.m1.9.9.1.1.3.2.1.cmml" xref="S4.E1.m1.9.9.1.1.3.2.1"></times><apply id="S4.E1.m1.9.9.1.1.3.2.2.cmml" xref="S4.E1.m1.9.9.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.9.9.1.1.3.2.2.1.cmml" xref="S4.E1.m1.9.9.1.1.3.2.2">subscript</csymbol><ci id="S4.E1.m1.9.9.1.1.3.2.2.2.cmml" xref="S4.E1.m1.9.9.1.1.3.2.2.2">𝛼</ci><list id="S4.E1.m1.2.2.2.3.cmml" xref="S4.E1.m1.2.2.2.4"><cn type="integer" id="S4.E1.m1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1">1</cn><ci id="S4.E1.m1.2.2.2.2.cmml" xref="S4.E1.m1.2.2.2.2">𝑙</ci></list></apply><apply id="S4.E1.m1.9.9.1.1.3.2.3.cmml" xref="S4.E1.m1.9.9.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E1.m1.9.9.1.1.3.2.3.1.cmml" xref="S4.E1.m1.9.9.1.1.3.2.3">subscript</csymbol><ci id="S4.E1.m1.9.9.1.1.3.2.3.2.cmml" xref="S4.E1.m1.9.9.1.1.3.2.3.2">𝑊</ci><list id="S4.E1.m1.4.4.2.3.cmml" xref="S4.E1.m1.4.4.2.4"><cn type="integer" id="S4.E1.m1.3.3.1.1.cmml" xref="S4.E1.m1.3.3.1.1">1</cn><ci id="S4.E1.m1.4.4.2.2.cmml" xref="S4.E1.m1.4.4.2.2">𝑙</ci></list></apply></apply><ci id="S4.E1.m1.9.9.1.1.3.3.cmml" xref="S4.E1.m1.9.9.1.1.3.3">⋯</ci><apply id="S4.E1.m1.9.9.1.1.3.4.cmml" xref="S4.E1.m1.9.9.1.1.3.4"><times id="S4.E1.m1.9.9.1.1.3.4.1.cmml" xref="S4.E1.m1.9.9.1.1.3.4.1"></times><apply id="S4.E1.m1.9.9.1.1.3.4.2.cmml" xref="S4.E1.m1.9.9.1.1.3.4.2"><csymbol cd="ambiguous" id="S4.E1.m1.9.9.1.1.3.4.2.1.cmml" xref="S4.E1.m1.9.9.1.1.3.4.2">subscript</csymbol><ci id="S4.E1.m1.9.9.1.1.3.4.2.2.cmml" xref="S4.E1.m1.9.9.1.1.3.4.2.2">𝛼</ci><list id="S4.E1.m1.6.6.2.3.cmml" xref="S4.E1.m1.6.6.2.4"><ci id="S4.E1.m1.5.5.1.1.cmml" xref="S4.E1.m1.5.5.1.1">𝐵</ci><ci id="S4.E1.m1.6.6.2.2.cmml" xref="S4.E1.m1.6.6.2.2">𝑙</ci></list></apply><apply id="S4.E1.m1.9.9.1.1.3.4.3.cmml" xref="S4.E1.m1.9.9.1.1.3.4.3"><csymbol cd="ambiguous" id="S4.E1.m1.9.9.1.1.3.4.3.1.cmml" xref="S4.E1.m1.9.9.1.1.3.4.3">subscript</csymbol><ci id="S4.E1.m1.9.9.1.1.3.4.3.2.cmml" xref="S4.E1.m1.9.9.1.1.3.4.3.2">𝑊</ci><list id="S4.E1.m1.8.8.2.3.cmml" xref="S4.E1.m1.8.8.2.4"><ci id="S4.E1.m1.7.7.1.1.cmml" xref="S4.E1.m1.7.7.1.1">𝐵</ci><ci id="S4.E1.m1.8.8.2.2.cmml" xref="S4.E1.m1.8.8.2.2">𝑙</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.9c">W_{l}=\alpha_{1,l}W_{1,l}+\dots+\alpha_{B,l}W_{B,l},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.13" class="ltx_p">where <math id="S4.SS1.p1.3.m1.2" class="ltx_Math" alttext="W_{b,l}" display="inline"><semantics id="S4.SS1.p1.3.m1.2a"><msub id="S4.SS1.p1.3.m1.2.3" xref="S4.SS1.p1.3.m1.2.3.cmml"><mi id="S4.SS1.p1.3.m1.2.3.2" xref="S4.SS1.p1.3.m1.2.3.2.cmml">W</mi><mrow id="S4.SS1.p1.3.m1.2.2.2.4" xref="S4.SS1.p1.3.m1.2.2.2.3.cmml"><mi id="S4.SS1.p1.3.m1.1.1.1.1" xref="S4.SS1.p1.3.m1.1.1.1.1.cmml">b</mi><mo id="S4.SS1.p1.3.m1.2.2.2.4.1" xref="S4.SS1.p1.3.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p1.3.m1.2.2.2.2" xref="S4.SS1.p1.3.m1.2.2.2.2.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m1.2b"><apply id="S4.SS1.p1.3.m1.2.3.cmml" xref="S4.SS1.p1.3.m1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m1.2.3.1.cmml" xref="S4.SS1.p1.3.m1.2.3">subscript</csymbol><ci id="S4.SS1.p1.3.m1.2.3.2.cmml" xref="S4.SS1.p1.3.m1.2.3.2">𝑊</ci><list id="S4.SS1.p1.3.m1.2.2.2.3.cmml" xref="S4.SS1.p1.3.m1.2.2.2.4"><ci id="S4.SS1.p1.3.m1.1.1.1.1.cmml" xref="S4.SS1.p1.3.m1.1.1.1.1">𝑏</ci><ci id="S4.SS1.p1.3.m1.2.2.2.2.cmml" xref="S4.SS1.p1.3.m1.2.2.2.2">𝑙</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m1.2c">W_{b,l}</annotation></semantics></math> is the weight matrix of the <math id="S4.SS1.p1.4.m2.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.SS1.p1.4.m2.1a"><mi id="S4.SS1.p1.4.m2.1.1" xref="S4.SS1.p1.4.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m2.1b"><ci id="S4.SS1.p1.4.m2.1.1.cmml" xref="S4.SS1.p1.4.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m2.1c">b</annotation></semantics></math>-th branch, and <math id="S4.SS1.p1.5.m3.2" class="ltx_Math" alttext="\alpha_{b,l}" display="inline"><semantics id="S4.SS1.p1.5.m3.2a"><msub id="S4.SS1.p1.5.m3.2.3" xref="S4.SS1.p1.5.m3.2.3.cmml"><mi id="S4.SS1.p1.5.m3.2.3.2" xref="S4.SS1.p1.5.m3.2.3.2.cmml">α</mi><mrow id="S4.SS1.p1.5.m3.2.2.2.4" xref="S4.SS1.p1.5.m3.2.2.2.3.cmml"><mi id="S4.SS1.p1.5.m3.1.1.1.1" xref="S4.SS1.p1.5.m3.1.1.1.1.cmml">b</mi><mo id="S4.SS1.p1.5.m3.2.2.2.4.1" xref="S4.SS1.p1.5.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p1.5.m3.2.2.2.2" xref="S4.SS1.p1.5.m3.2.2.2.2.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m3.2b"><apply id="S4.SS1.p1.5.m3.2.3.cmml" xref="S4.SS1.p1.5.m3.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m3.2.3.1.cmml" xref="S4.SS1.p1.5.m3.2.3">subscript</csymbol><ci id="S4.SS1.p1.5.m3.2.3.2.cmml" xref="S4.SS1.p1.5.m3.2.3.2">𝛼</ci><list id="S4.SS1.p1.5.m3.2.2.2.3.cmml" xref="S4.SS1.p1.5.m3.2.2.2.4"><ci id="S4.SS1.p1.5.m3.1.1.1.1.cmml" xref="S4.SS1.p1.5.m3.1.1.1.1">𝑏</ci><ci id="S4.SS1.p1.5.m3.2.2.2.2.cmml" xref="S4.SS1.p1.5.m3.2.2.2.2">𝑙</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m3.2c">\alpha_{b,l}</annotation></semantics></math> is the weight assigned to the <math id="S4.SS1.p1.6.m4.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.SS1.p1.6.m4.1a"><mi id="S4.SS1.p1.6.m4.1.1" xref="S4.SS1.p1.6.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m4.1b"><ci id="S4.SS1.p1.6.m4.1.1.cmml" xref="S4.SS1.p1.6.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m4.1c">b</annotation></semantics></math>-th branch satisfying <math id="S4.SS1.p1.7.m5.2" class="ltx_Math" alttext="\alpha_{b,l}\geq 0" display="inline"><semantics id="S4.SS1.p1.7.m5.2a"><mrow id="S4.SS1.p1.7.m5.2.3" xref="S4.SS1.p1.7.m5.2.3.cmml"><msub id="S4.SS1.p1.7.m5.2.3.2" xref="S4.SS1.p1.7.m5.2.3.2.cmml"><mi id="S4.SS1.p1.7.m5.2.3.2.2" xref="S4.SS1.p1.7.m5.2.3.2.2.cmml">α</mi><mrow id="S4.SS1.p1.7.m5.2.2.2.4" xref="S4.SS1.p1.7.m5.2.2.2.3.cmml"><mi id="S4.SS1.p1.7.m5.1.1.1.1" xref="S4.SS1.p1.7.m5.1.1.1.1.cmml">b</mi><mo id="S4.SS1.p1.7.m5.2.2.2.4.1" xref="S4.SS1.p1.7.m5.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p1.7.m5.2.2.2.2" xref="S4.SS1.p1.7.m5.2.2.2.2.cmml">l</mi></mrow></msub><mo id="S4.SS1.p1.7.m5.2.3.1" xref="S4.SS1.p1.7.m5.2.3.1.cmml">≥</mo><mn id="S4.SS1.p1.7.m5.2.3.3" xref="S4.SS1.p1.7.m5.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m5.2b"><apply id="S4.SS1.p1.7.m5.2.3.cmml" xref="S4.SS1.p1.7.m5.2.3"><geq id="S4.SS1.p1.7.m5.2.3.1.cmml" xref="S4.SS1.p1.7.m5.2.3.1"></geq><apply id="S4.SS1.p1.7.m5.2.3.2.cmml" xref="S4.SS1.p1.7.m5.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m5.2.3.2.1.cmml" xref="S4.SS1.p1.7.m5.2.3.2">subscript</csymbol><ci id="S4.SS1.p1.7.m5.2.3.2.2.cmml" xref="S4.SS1.p1.7.m5.2.3.2.2">𝛼</ci><list id="S4.SS1.p1.7.m5.2.2.2.3.cmml" xref="S4.SS1.p1.7.m5.2.2.2.4"><ci id="S4.SS1.p1.7.m5.1.1.1.1.cmml" xref="S4.SS1.p1.7.m5.1.1.1.1">𝑏</ci><ci id="S4.SS1.p1.7.m5.2.2.2.2.cmml" xref="S4.SS1.p1.7.m5.2.2.2.2">𝑙</ci></list></apply><cn type="integer" id="S4.SS1.p1.7.m5.2.3.3.cmml" xref="S4.SS1.p1.7.m5.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m5.2c">\alpha_{b,l}\geq 0</annotation></semantics></math> and <math id="S4.SS1.p1.8.m6.2" class="ltx_Math" alttext="\sum_{b=1}^{B}\alpha_{b,l}=1" display="inline"><semantics id="S4.SS1.p1.8.m6.2a"><mrow id="S4.SS1.p1.8.m6.2.3" xref="S4.SS1.p1.8.m6.2.3.cmml"><mrow id="S4.SS1.p1.8.m6.2.3.2" xref="S4.SS1.p1.8.m6.2.3.2.cmml"><msubsup id="S4.SS1.p1.8.m6.2.3.2.1" xref="S4.SS1.p1.8.m6.2.3.2.1.cmml"><mo id="S4.SS1.p1.8.m6.2.3.2.1.2.2" xref="S4.SS1.p1.8.m6.2.3.2.1.2.2.cmml">∑</mo><mrow id="S4.SS1.p1.8.m6.2.3.2.1.2.3" xref="S4.SS1.p1.8.m6.2.3.2.1.2.3.cmml"><mi id="S4.SS1.p1.8.m6.2.3.2.1.2.3.2" xref="S4.SS1.p1.8.m6.2.3.2.1.2.3.2.cmml">b</mi><mo id="S4.SS1.p1.8.m6.2.3.2.1.2.3.1" xref="S4.SS1.p1.8.m6.2.3.2.1.2.3.1.cmml">=</mo><mn id="S4.SS1.p1.8.m6.2.3.2.1.2.3.3" xref="S4.SS1.p1.8.m6.2.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S4.SS1.p1.8.m6.2.3.2.1.3" xref="S4.SS1.p1.8.m6.2.3.2.1.3.cmml">B</mi></msubsup><msub id="S4.SS1.p1.8.m6.2.3.2.2" xref="S4.SS1.p1.8.m6.2.3.2.2.cmml"><mi id="S4.SS1.p1.8.m6.2.3.2.2.2" xref="S4.SS1.p1.8.m6.2.3.2.2.2.cmml">α</mi><mrow id="S4.SS1.p1.8.m6.2.2.2.4" xref="S4.SS1.p1.8.m6.2.2.2.3.cmml"><mi id="S4.SS1.p1.8.m6.1.1.1.1" xref="S4.SS1.p1.8.m6.1.1.1.1.cmml">b</mi><mo id="S4.SS1.p1.8.m6.2.2.2.4.1" xref="S4.SS1.p1.8.m6.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p1.8.m6.2.2.2.2" xref="S4.SS1.p1.8.m6.2.2.2.2.cmml">l</mi></mrow></msub></mrow><mo id="S4.SS1.p1.8.m6.2.3.1" xref="S4.SS1.p1.8.m6.2.3.1.cmml">=</mo><mn id="S4.SS1.p1.8.m6.2.3.3" xref="S4.SS1.p1.8.m6.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m6.2b"><apply id="S4.SS1.p1.8.m6.2.3.cmml" xref="S4.SS1.p1.8.m6.2.3"><eq id="S4.SS1.p1.8.m6.2.3.1.cmml" xref="S4.SS1.p1.8.m6.2.3.1"></eq><apply id="S4.SS1.p1.8.m6.2.3.2.cmml" xref="S4.SS1.p1.8.m6.2.3.2"><apply id="S4.SS1.p1.8.m6.2.3.2.1.cmml" xref="S4.SS1.p1.8.m6.2.3.2.1"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m6.2.3.2.1.1.cmml" xref="S4.SS1.p1.8.m6.2.3.2.1">superscript</csymbol><apply id="S4.SS1.p1.8.m6.2.3.2.1.2.cmml" xref="S4.SS1.p1.8.m6.2.3.2.1"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m6.2.3.2.1.2.1.cmml" xref="S4.SS1.p1.8.m6.2.3.2.1">subscript</csymbol><sum id="S4.SS1.p1.8.m6.2.3.2.1.2.2.cmml" xref="S4.SS1.p1.8.m6.2.3.2.1.2.2"></sum><apply id="S4.SS1.p1.8.m6.2.3.2.1.2.3.cmml" xref="S4.SS1.p1.8.m6.2.3.2.1.2.3"><eq id="S4.SS1.p1.8.m6.2.3.2.1.2.3.1.cmml" xref="S4.SS1.p1.8.m6.2.3.2.1.2.3.1"></eq><ci id="S4.SS1.p1.8.m6.2.3.2.1.2.3.2.cmml" xref="S4.SS1.p1.8.m6.2.3.2.1.2.3.2">𝑏</ci><cn type="integer" id="S4.SS1.p1.8.m6.2.3.2.1.2.3.3.cmml" xref="S4.SS1.p1.8.m6.2.3.2.1.2.3.3">1</cn></apply></apply><ci id="S4.SS1.p1.8.m6.2.3.2.1.3.cmml" xref="S4.SS1.p1.8.m6.2.3.2.1.3">𝐵</ci></apply><apply id="S4.SS1.p1.8.m6.2.3.2.2.cmml" xref="S4.SS1.p1.8.m6.2.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m6.2.3.2.2.1.cmml" xref="S4.SS1.p1.8.m6.2.3.2.2">subscript</csymbol><ci id="S4.SS1.p1.8.m6.2.3.2.2.2.cmml" xref="S4.SS1.p1.8.m6.2.3.2.2.2">𝛼</ci><list id="S4.SS1.p1.8.m6.2.2.2.3.cmml" xref="S4.SS1.p1.8.m6.2.2.2.4"><ci id="S4.SS1.p1.8.m6.1.1.1.1.cmml" xref="S4.SS1.p1.8.m6.1.1.1.1">𝑏</ci><ci id="S4.SS1.p1.8.m6.2.2.2.2.cmml" xref="S4.SS1.p1.8.m6.2.2.2.2">𝑙</ci></list></apply></apply><cn type="integer" id="S4.SS1.p1.8.m6.2.3.3.cmml" xref="S4.SS1.p1.8.m6.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m6.2c">\sum_{b=1}^{B}\alpha_{b,l}=1</annotation></semantics></math>. In the multi-branch layer, each branch receives input <math id="S4.SS1.p1.9.m7.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS1.p1.9.m7.1a"><mi id="S4.SS1.p1.9.m7.1.1" xref="S4.SS1.p1.9.m7.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m7.1b"><ci id="S4.SS1.p1.9.m7.1.1.cmml" xref="S4.SS1.p1.9.m7.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m7.1c">x</annotation></semantics></math> and outputs <math id="S4.SS1.p1.10.m8.2" class="ltx_Math" alttext="W_{b,l}*x" display="inline"><semantics id="S4.SS1.p1.10.m8.2a"><mrow id="S4.SS1.p1.10.m8.2.3" xref="S4.SS1.p1.10.m8.2.3.cmml"><msub id="S4.SS1.p1.10.m8.2.3.2" xref="S4.SS1.p1.10.m8.2.3.2.cmml"><mi id="S4.SS1.p1.10.m8.2.3.2.2" xref="S4.SS1.p1.10.m8.2.3.2.2.cmml">W</mi><mrow id="S4.SS1.p1.10.m8.2.2.2.4" xref="S4.SS1.p1.10.m8.2.2.2.3.cmml"><mi id="S4.SS1.p1.10.m8.1.1.1.1" xref="S4.SS1.p1.10.m8.1.1.1.1.cmml">b</mi><mo id="S4.SS1.p1.10.m8.2.2.2.4.1" xref="S4.SS1.p1.10.m8.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p1.10.m8.2.2.2.2" xref="S4.SS1.p1.10.m8.2.2.2.2.cmml">l</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.10.m8.2.3.1" xref="S4.SS1.p1.10.m8.2.3.1.cmml">∗</mo><mi id="S4.SS1.p1.10.m8.2.3.3" xref="S4.SS1.p1.10.m8.2.3.3.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m8.2b"><apply id="S4.SS1.p1.10.m8.2.3.cmml" xref="S4.SS1.p1.10.m8.2.3"><times id="S4.SS1.p1.10.m8.2.3.1.cmml" xref="S4.SS1.p1.10.m8.2.3.1"></times><apply id="S4.SS1.p1.10.m8.2.3.2.cmml" xref="S4.SS1.p1.10.m8.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m8.2.3.2.1.cmml" xref="S4.SS1.p1.10.m8.2.3.2">subscript</csymbol><ci id="S4.SS1.p1.10.m8.2.3.2.2.cmml" xref="S4.SS1.p1.10.m8.2.3.2.2">𝑊</ci><list id="S4.SS1.p1.10.m8.2.2.2.3.cmml" xref="S4.SS1.p1.10.m8.2.2.2.4"><ci id="S4.SS1.p1.10.m8.1.1.1.1.cmml" xref="S4.SS1.p1.10.m8.1.1.1.1">𝑏</ci><ci id="S4.SS1.p1.10.m8.2.2.2.2.cmml" xref="S4.SS1.p1.10.m8.2.2.2.2">𝑙</ci></list></apply><ci id="S4.SS1.p1.10.m8.2.3.3.cmml" xref="S4.SS1.p1.10.m8.2.3.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m8.2c">W_{b,l}*x</annotation></semantics></math>, and then the outputs of all the branches are linearly combined, weighted by <math id="S4.SS1.p1.11.m9.2" class="ltx_Math" alttext="\alpha_{b,l}" display="inline"><semantics id="S4.SS1.p1.11.m9.2a"><msub id="S4.SS1.p1.11.m9.2.3" xref="S4.SS1.p1.11.m9.2.3.cmml"><mi id="S4.SS1.p1.11.m9.2.3.2" xref="S4.SS1.p1.11.m9.2.3.2.cmml">α</mi><mrow id="S4.SS1.p1.11.m9.2.2.2.4" xref="S4.SS1.p1.11.m9.2.2.2.3.cmml"><mi id="S4.SS1.p1.11.m9.1.1.1.1" xref="S4.SS1.p1.11.m9.1.1.1.1.cmml">b</mi><mo id="S4.SS1.p1.11.m9.2.2.2.4.1" xref="S4.SS1.p1.11.m9.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p1.11.m9.2.2.2.2" xref="S4.SS1.p1.11.m9.2.2.2.2.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m9.2b"><apply id="S4.SS1.p1.11.m9.2.3.cmml" xref="S4.SS1.p1.11.m9.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m9.2.3.1.cmml" xref="S4.SS1.p1.11.m9.2.3">subscript</csymbol><ci id="S4.SS1.p1.11.m9.2.3.2.cmml" xref="S4.SS1.p1.11.m9.2.3.2">𝛼</ci><list id="S4.SS1.p1.11.m9.2.2.2.3.cmml" xref="S4.SS1.p1.11.m9.2.2.2.4"><ci id="S4.SS1.p1.11.m9.1.1.1.1.cmml" xref="S4.SS1.p1.11.m9.1.1.1.1">𝑏</ci><ci id="S4.SS1.p1.11.m9.2.2.2.2.cmml" xref="S4.SS1.p1.11.m9.2.2.2.2">𝑙</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m9.2c">\alpha_{b,l}</annotation></semantics></math>. This is mathematically equivalent to the operation to multiply <math id="S4.SS1.p1.12.m10.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS1.p1.12.m10.1a"><mi id="S4.SS1.p1.12.m10.1.1" xref="S4.SS1.p1.12.m10.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m10.1b"><ci id="S4.SS1.p1.12.m10.1.1.cmml" xref="S4.SS1.p1.12.m10.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m10.1c">x</annotation></semantics></math> by <math id="S4.SS1.p1.13.m11.1" class="ltx_Math" alttext="W_{l}" display="inline"><semantics id="S4.SS1.p1.13.m11.1a"><msub id="S4.SS1.p1.13.m11.1.1" xref="S4.SS1.p1.13.m11.1.1.cmml"><mi id="S4.SS1.p1.13.m11.1.1.2" xref="S4.SS1.p1.13.m11.1.1.2.cmml">W</mi><mi id="S4.SS1.p1.13.m11.1.1.3" xref="S4.SS1.p1.13.m11.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m11.1b"><apply id="S4.SS1.p1.13.m11.1.1.cmml" xref="S4.SS1.p1.13.m11.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m11.1.1.1.cmml" xref="S4.SS1.p1.13.m11.1.1">subscript</csymbol><ci id="S4.SS1.p1.13.m11.1.1.2.cmml" xref="S4.SS1.p1.13.m11.1.1.2">𝑊</ci><ci id="S4.SS1.p1.13.m11.1.1.3.cmml" xref="S4.SS1.p1.13.m11.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m11.1c">W_{l}</annotation></semantics></math>:</p>
<table id="S4.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E2.m1.9" class="ltx_Math" alttext="W_{l}*x=\alpha_{1,l}(W_{1,l}*x)+\dots+\alpha_{B,l}(W_{B,l}*x)." display="block"><semantics id="S4.E2.m1.9a"><mrow id="S4.E2.m1.9.9.1" xref="S4.E2.m1.9.9.1.1.cmml"><mrow id="S4.E2.m1.9.9.1.1" xref="S4.E2.m1.9.9.1.1.cmml"><mrow id="S4.E2.m1.9.9.1.1.4" xref="S4.E2.m1.9.9.1.1.4.cmml"><msub id="S4.E2.m1.9.9.1.1.4.2" xref="S4.E2.m1.9.9.1.1.4.2.cmml"><mi id="S4.E2.m1.9.9.1.1.4.2.2" xref="S4.E2.m1.9.9.1.1.4.2.2.cmml">W</mi><mi id="S4.E2.m1.9.9.1.1.4.2.3" xref="S4.E2.m1.9.9.1.1.4.2.3.cmml">l</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.E2.m1.9.9.1.1.4.1" xref="S4.E2.m1.9.9.1.1.4.1.cmml">∗</mo><mi id="S4.E2.m1.9.9.1.1.4.3" xref="S4.E2.m1.9.9.1.1.4.3.cmml">x</mi></mrow><mo id="S4.E2.m1.9.9.1.1.3" xref="S4.E2.m1.9.9.1.1.3.cmml">=</mo><mrow id="S4.E2.m1.9.9.1.1.2" xref="S4.E2.m1.9.9.1.1.2.cmml"><mrow id="S4.E2.m1.9.9.1.1.1.1" xref="S4.E2.m1.9.9.1.1.1.1.cmml"><msub id="S4.E2.m1.9.9.1.1.1.1.3" xref="S4.E2.m1.9.9.1.1.1.1.3.cmml"><mi id="S4.E2.m1.9.9.1.1.1.1.3.2" xref="S4.E2.m1.9.9.1.1.1.1.3.2.cmml">α</mi><mrow id="S4.E2.m1.2.2.2.4" xref="S4.E2.m1.2.2.2.3.cmml"><mn id="S4.E2.m1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml">1</mn><mo id="S4.E2.m1.2.2.2.4.1" xref="S4.E2.m1.2.2.2.3.cmml">,</mo><mi id="S4.E2.m1.2.2.2.2" xref="S4.E2.m1.2.2.2.2.cmml">l</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.9.9.1.1.1.1.2" xref="S4.E2.m1.9.9.1.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.9.9.1.1.1.1.1.1" xref="S4.E2.m1.9.9.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E2.m1.9.9.1.1.1.1.1.1.2" xref="S4.E2.m1.9.9.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.9.9.1.1.1.1.1.1.1" xref="S4.E2.m1.9.9.1.1.1.1.1.1.1.cmml"><msub id="S4.E2.m1.9.9.1.1.1.1.1.1.1.2" xref="S4.E2.m1.9.9.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E2.m1.9.9.1.1.1.1.1.1.1.2.2" xref="S4.E2.m1.9.9.1.1.1.1.1.1.1.2.2.cmml">W</mi><mrow id="S4.E2.m1.4.4.2.4" xref="S4.E2.m1.4.4.2.3.cmml"><mn id="S4.E2.m1.3.3.1.1" xref="S4.E2.m1.3.3.1.1.cmml">1</mn><mo id="S4.E2.m1.4.4.2.4.1" xref="S4.E2.m1.4.4.2.3.cmml">,</mo><mi id="S4.E2.m1.4.4.2.2" xref="S4.E2.m1.4.4.2.2.cmml">l</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S4.E2.m1.9.9.1.1.1.1.1.1.1.1" xref="S4.E2.m1.9.9.1.1.1.1.1.1.1.1.cmml">∗</mo><mi id="S4.E2.m1.9.9.1.1.1.1.1.1.1.3" xref="S4.E2.m1.9.9.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S4.E2.m1.9.9.1.1.1.1.1.1.3" xref="S4.E2.m1.9.9.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.9.9.1.1.2.3" xref="S4.E2.m1.9.9.1.1.2.3.cmml">+</mo><mi mathvariant="normal" id="S4.E2.m1.9.9.1.1.2.4" xref="S4.E2.m1.9.9.1.1.2.4.cmml">⋯</mi><mo id="S4.E2.m1.9.9.1.1.2.3a" xref="S4.E2.m1.9.9.1.1.2.3.cmml">+</mo><mrow id="S4.E2.m1.9.9.1.1.2.2" xref="S4.E2.m1.9.9.1.1.2.2.cmml"><msub id="S4.E2.m1.9.9.1.1.2.2.3" xref="S4.E2.m1.9.9.1.1.2.2.3.cmml"><mi id="S4.E2.m1.9.9.1.1.2.2.3.2" xref="S4.E2.m1.9.9.1.1.2.2.3.2.cmml">α</mi><mrow id="S4.E2.m1.6.6.2.4" xref="S4.E2.m1.6.6.2.3.cmml"><mi id="S4.E2.m1.5.5.1.1" xref="S4.E2.m1.5.5.1.1.cmml">B</mi><mo id="S4.E2.m1.6.6.2.4.1" xref="S4.E2.m1.6.6.2.3.cmml">,</mo><mi id="S4.E2.m1.6.6.2.2" xref="S4.E2.m1.6.6.2.2.cmml">l</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.9.9.1.1.2.2.2" xref="S4.E2.m1.9.9.1.1.2.2.2.cmml">​</mo><mrow id="S4.E2.m1.9.9.1.1.2.2.1.1" xref="S4.E2.m1.9.9.1.1.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E2.m1.9.9.1.1.2.2.1.1.2" xref="S4.E2.m1.9.9.1.1.2.2.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.9.9.1.1.2.2.1.1.1" xref="S4.E2.m1.9.9.1.1.2.2.1.1.1.cmml"><msub id="S4.E2.m1.9.9.1.1.2.2.1.1.1.2" xref="S4.E2.m1.9.9.1.1.2.2.1.1.1.2.cmml"><mi id="S4.E2.m1.9.9.1.1.2.2.1.1.1.2.2" xref="S4.E2.m1.9.9.1.1.2.2.1.1.1.2.2.cmml">W</mi><mrow id="S4.E2.m1.8.8.2.4" xref="S4.E2.m1.8.8.2.3.cmml"><mi id="S4.E2.m1.7.7.1.1" xref="S4.E2.m1.7.7.1.1.cmml">B</mi><mo id="S4.E2.m1.8.8.2.4.1" xref="S4.E2.m1.8.8.2.3.cmml">,</mo><mi id="S4.E2.m1.8.8.2.2" xref="S4.E2.m1.8.8.2.2.cmml">l</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S4.E2.m1.9.9.1.1.2.2.1.1.1.1" xref="S4.E2.m1.9.9.1.1.2.2.1.1.1.1.cmml">∗</mo><mi id="S4.E2.m1.9.9.1.1.2.2.1.1.1.3" xref="S4.E2.m1.9.9.1.1.2.2.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S4.E2.m1.9.9.1.1.2.2.1.1.3" xref="S4.E2.m1.9.9.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S4.E2.m1.9.9.1.2" xref="S4.E2.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.9b"><apply id="S4.E2.m1.9.9.1.1.cmml" xref="S4.E2.m1.9.9.1"><eq id="S4.E2.m1.9.9.1.1.3.cmml" xref="S4.E2.m1.9.9.1.1.3"></eq><apply id="S4.E2.m1.9.9.1.1.4.cmml" xref="S4.E2.m1.9.9.1.1.4"><times id="S4.E2.m1.9.9.1.1.4.1.cmml" xref="S4.E2.m1.9.9.1.1.4.1"></times><apply id="S4.E2.m1.9.9.1.1.4.2.cmml" xref="S4.E2.m1.9.9.1.1.4.2"><csymbol cd="ambiguous" id="S4.E2.m1.9.9.1.1.4.2.1.cmml" xref="S4.E2.m1.9.9.1.1.4.2">subscript</csymbol><ci id="S4.E2.m1.9.9.1.1.4.2.2.cmml" xref="S4.E2.m1.9.9.1.1.4.2.2">𝑊</ci><ci id="S4.E2.m1.9.9.1.1.4.2.3.cmml" xref="S4.E2.m1.9.9.1.1.4.2.3">𝑙</ci></apply><ci id="S4.E2.m1.9.9.1.1.4.3.cmml" xref="S4.E2.m1.9.9.1.1.4.3">𝑥</ci></apply><apply id="S4.E2.m1.9.9.1.1.2.cmml" xref="S4.E2.m1.9.9.1.1.2"><plus id="S4.E2.m1.9.9.1.1.2.3.cmml" xref="S4.E2.m1.9.9.1.1.2.3"></plus><apply id="S4.E2.m1.9.9.1.1.1.1.cmml" xref="S4.E2.m1.9.9.1.1.1.1"><times id="S4.E2.m1.9.9.1.1.1.1.2.cmml" xref="S4.E2.m1.9.9.1.1.1.1.2"></times><apply id="S4.E2.m1.9.9.1.1.1.1.3.cmml" xref="S4.E2.m1.9.9.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.9.9.1.1.1.1.3.1.cmml" xref="S4.E2.m1.9.9.1.1.1.1.3">subscript</csymbol><ci id="S4.E2.m1.9.9.1.1.1.1.3.2.cmml" xref="S4.E2.m1.9.9.1.1.1.1.3.2">𝛼</ci><list id="S4.E2.m1.2.2.2.3.cmml" xref="S4.E2.m1.2.2.2.4"><cn type="integer" id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1">1</cn><ci id="S4.E2.m1.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.2">𝑙</ci></list></apply><apply id="S4.E2.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.9.9.1.1.1.1.1.1"><times id="S4.E2.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.9.9.1.1.1.1.1.1.1.1"></times><apply id="S4.E2.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.9.9.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.9.9.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.9.9.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E2.m1.9.9.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.9.9.1.1.1.1.1.1.1.2.2">𝑊</ci><list id="S4.E2.m1.4.4.2.3.cmml" xref="S4.E2.m1.4.4.2.4"><cn type="integer" id="S4.E2.m1.3.3.1.1.cmml" xref="S4.E2.m1.3.3.1.1">1</cn><ci id="S4.E2.m1.4.4.2.2.cmml" xref="S4.E2.m1.4.4.2.2">𝑙</ci></list></apply><ci id="S4.E2.m1.9.9.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.9.9.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><ci id="S4.E2.m1.9.9.1.1.2.4.cmml" xref="S4.E2.m1.9.9.1.1.2.4">⋯</ci><apply id="S4.E2.m1.9.9.1.1.2.2.cmml" xref="S4.E2.m1.9.9.1.1.2.2"><times id="S4.E2.m1.9.9.1.1.2.2.2.cmml" xref="S4.E2.m1.9.9.1.1.2.2.2"></times><apply id="S4.E2.m1.9.9.1.1.2.2.3.cmml" xref="S4.E2.m1.9.9.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E2.m1.9.9.1.1.2.2.3.1.cmml" xref="S4.E2.m1.9.9.1.1.2.2.3">subscript</csymbol><ci id="S4.E2.m1.9.9.1.1.2.2.3.2.cmml" xref="S4.E2.m1.9.9.1.1.2.2.3.2">𝛼</ci><list id="S4.E2.m1.6.6.2.3.cmml" xref="S4.E2.m1.6.6.2.4"><ci id="S4.E2.m1.5.5.1.1.cmml" xref="S4.E2.m1.5.5.1.1">𝐵</ci><ci id="S4.E2.m1.6.6.2.2.cmml" xref="S4.E2.m1.6.6.2.2">𝑙</ci></list></apply><apply id="S4.E2.m1.9.9.1.1.2.2.1.1.1.cmml" xref="S4.E2.m1.9.9.1.1.2.2.1.1"><times id="S4.E2.m1.9.9.1.1.2.2.1.1.1.1.cmml" xref="S4.E2.m1.9.9.1.1.2.2.1.1.1.1"></times><apply id="S4.E2.m1.9.9.1.1.2.2.1.1.1.2.cmml" xref="S4.E2.m1.9.9.1.1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.9.9.1.1.2.2.1.1.1.2.1.cmml" xref="S4.E2.m1.9.9.1.1.2.2.1.1.1.2">subscript</csymbol><ci id="S4.E2.m1.9.9.1.1.2.2.1.1.1.2.2.cmml" xref="S4.E2.m1.9.9.1.1.2.2.1.1.1.2.2">𝑊</ci><list id="S4.E2.m1.8.8.2.3.cmml" xref="S4.E2.m1.8.8.2.4"><ci id="S4.E2.m1.7.7.1.1.cmml" xref="S4.E2.m1.7.7.1.1">𝐵</ci><ci id="S4.E2.m1.8.8.2.2.cmml" xref="S4.E2.m1.8.8.2.2">𝑙</ci></list></apply><ci id="S4.E2.m1.9.9.1.1.2.2.1.1.1.3.cmml" xref="S4.E2.m1.9.9.1.1.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.9c">W_{l}*x=\alpha_{1,l}(W_{1,l}*x)+\dots+\alpha_{B,l}(W_{B,l}*x).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.14" class="ltx_p">Therefore, <math id="S4.SS1.p1.14.m1.1" class="ltx_Math" alttext="W_{l}" display="inline"><semantics id="S4.SS1.p1.14.m1.1a"><msub id="S4.SS1.p1.14.m1.1.1" xref="S4.SS1.p1.14.m1.1.1.cmml"><mi id="S4.SS1.p1.14.m1.1.1.2" xref="S4.SS1.p1.14.m1.1.1.2.cmml">W</mi><mi id="S4.SS1.p1.14.m1.1.1.3" xref="S4.SS1.p1.14.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.14.m1.1b"><apply id="S4.SS1.p1.14.m1.1.1.cmml" xref="S4.SS1.p1.14.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m1.1.1.1.cmml" xref="S4.SS1.p1.14.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.14.m1.1.1.2.cmml" xref="S4.SS1.p1.14.m1.1.1.2">𝑊</ci><ci id="S4.SS1.p1.14.m1.1.1.3.cmml" xref="S4.SS1.p1.14.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.14.m1.1c">W_{l}</annotation></semantics></math> is written as Eq. (<a href="#S4.E1" title="In IV-A Architecture ‣ IV PROPOSED METHOD ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), which means that multi-branch layer is as computationally efficient as normal layer in inference phase. Multi-branch architecture is shown in Fig. <a href="#S4.F1" title="Figure 1 ‣ IV-A Architecture ‣ IV PROPOSED METHOD ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.3" class="ltx_p">In pFedMB, each client has a multi-branch neural network with the same architecture. <span id="S4.SS1.p2.2.2" class="ltx_text" style="color:#000000;">CondConv determines the weights assigned to each branch by functions of the input <math id="S4.SS1.p2.1.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS1.p2.1.1.m1.1a"><mi mathcolor="#000000" id="S4.SS1.p2.1.1.m1.1.1" xref="S4.SS1.p2.1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.1.m1.1b"><ci id="S4.SS1.p2.1.1.m1.1.1.cmml" xref="S4.SS1.p2.1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.1.m1.1c">x</annotation></semantics></math>. We extend CondConv to the PFL setting, that is, we let the weights depend on client, i.e., data distribution, not input <math id="S4.SS1.p2.2.2.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS1.p2.2.2.m2.1a"><mi mathcolor="#000000" id="S4.SS1.p2.2.2.m2.1.1" xref="S4.SS1.p2.2.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.2.m2.1b"><ci id="S4.SS1.p2.2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.2.m2.1c">x</annotation></semantics></math>. Specifically, in order to obtain personalized models,</span> the weights <math id="S4.SS1.p2.3.m1.5" class="ltx_Math" alttext="\{\alpha_{b,l}\}_{b,l}" display="inline"><semantics id="S4.SS1.p2.3.m1.5a"><msub id="S4.SS1.p2.3.m1.5.5" xref="S4.SS1.p2.3.m1.5.5.cmml"><mrow id="S4.SS1.p2.3.m1.5.5.1.1" xref="S4.SS1.p2.3.m1.5.5.1.2.cmml"><mo stretchy="false" id="S4.SS1.p2.3.m1.5.5.1.1.2" xref="S4.SS1.p2.3.m1.5.5.1.2.cmml">{</mo><msub id="S4.SS1.p2.3.m1.5.5.1.1.1" xref="S4.SS1.p2.3.m1.5.5.1.1.1.cmml"><mi id="S4.SS1.p2.3.m1.5.5.1.1.1.2" xref="S4.SS1.p2.3.m1.5.5.1.1.1.2.cmml">α</mi><mrow id="S4.SS1.p2.3.m1.2.2.2.4" xref="S4.SS1.p2.3.m1.2.2.2.3.cmml"><mi id="S4.SS1.p2.3.m1.1.1.1.1" xref="S4.SS1.p2.3.m1.1.1.1.1.cmml">b</mi><mo id="S4.SS1.p2.3.m1.2.2.2.4.1" xref="S4.SS1.p2.3.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p2.3.m1.2.2.2.2" xref="S4.SS1.p2.3.m1.2.2.2.2.cmml">l</mi></mrow></msub><mo stretchy="false" id="S4.SS1.p2.3.m1.5.5.1.1.3" xref="S4.SS1.p2.3.m1.5.5.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p2.3.m1.4.4.2.4" xref="S4.SS1.p2.3.m1.4.4.2.3.cmml"><mi id="S4.SS1.p2.3.m1.3.3.1.1" xref="S4.SS1.p2.3.m1.3.3.1.1.cmml">b</mi><mo id="S4.SS1.p2.3.m1.4.4.2.4.1" xref="S4.SS1.p2.3.m1.4.4.2.3.cmml">,</mo><mi id="S4.SS1.p2.3.m1.4.4.2.2" xref="S4.SS1.p2.3.m1.4.4.2.2.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m1.5b"><apply id="S4.SS1.p2.3.m1.5.5.cmml" xref="S4.SS1.p2.3.m1.5.5"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m1.5.5.2.cmml" xref="S4.SS1.p2.3.m1.5.5">subscript</csymbol><set id="S4.SS1.p2.3.m1.5.5.1.2.cmml" xref="S4.SS1.p2.3.m1.5.5.1.1"><apply id="S4.SS1.p2.3.m1.5.5.1.1.1.cmml" xref="S4.SS1.p2.3.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m1.5.5.1.1.1.1.cmml" xref="S4.SS1.p2.3.m1.5.5.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.3.m1.5.5.1.1.1.2.cmml" xref="S4.SS1.p2.3.m1.5.5.1.1.1.2">𝛼</ci><list id="S4.SS1.p2.3.m1.2.2.2.3.cmml" xref="S4.SS1.p2.3.m1.2.2.2.4"><ci id="S4.SS1.p2.3.m1.1.1.1.1.cmml" xref="S4.SS1.p2.3.m1.1.1.1.1">𝑏</ci><ci id="S4.SS1.p2.3.m1.2.2.2.2.cmml" xref="S4.SS1.p2.3.m1.2.2.2.2">𝑙</ci></list></apply></set><list id="S4.SS1.p2.3.m1.4.4.2.3.cmml" xref="S4.SS1.p2.3.m1.4.4.2.4"><ci id="S4.SS1.p2.3.m1.3.3.1.1.cmml" xref="S4.SS1.p2.3.m1.3.3.1.1">𝑏</ci><ci id="S4.SS1.p2.3.m1.4.4.2.2.cmml" xref="S4.SS1.p2.3.m1.4.4.2.2">𝑙</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m1.5c">\{\alpha_{b,l}\}_{b,l}</annotation></semantics></math> are decoupled from the global model parameters shared among all clients like FedPer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, and each client locally optimizes their client-specific weights and get a model personalized to their data distribution. <span id="S4.SS1.p2.3.3" class="ltx_text" style="color:#000000;">Unlike FedPer, which decouples the parameters of the entire layer, pFedMB shares the knowledge with other clients through the parameters of each branch and decouples only the weights assigned to each branch, thus preventing overfitting on each client’s data.</span> This architecture of pFedMB is described in Fig. <a href="#S4.F2" title="Figure 2 ‣ IV-A Architecture ‣ IV PROPOSED METHOD ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure id="S4.F1" class="ltx_figure">
<p id="S4.F1.1" class="ltx_p ltx_align_center"><span id="S4.F1.1.1" class="ltx_text"><img src="/html/2211.07931/assets/multi-branch3.png" id="S4.F1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="568" height="228" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F1.3.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S4.F1.4.2" class="ltx_text" style="font-size:90%;">Architecture of multi-branch layer.</span></figcaption>
</figure>
<figure id="S4.F2" class="ltx_figure">
<p id="S4.F2.1.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S4.F2.1.1.1" class="ltx_text"><img src="/html/2211.07931/assets/pFedMB.png" id="S4.F2.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="147" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.3.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S4.F2.4.2" class="ltx_text" style="font-size:90%;">Architecture of pFedMB.</span></figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.4.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.5.2" class="ltx_text ltx_font_italic">Algorithm</span>
</h3>

<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> pFedMB: personalized federated learning with multi-branch architecture</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l0.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>  <math id="alg1.l0.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.l0.m1.1a"><mi id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><ci id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">N</annotation></semantics></math> clients <math id="alg1.l0.m2.1" class="ltx_Math" alttext="\{C_{i}\}_{i=1}^{N}" display="inline"><semantics id="alg1.l0.m2.1a"><msubsup id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml"><mrow id="alg1.l0.m2.1.1.1.1.1" xref="alg1.l0.m2.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l0.m2.1.1.1.1.1.2" xref="alg1.l0.m2.1.1.1.1.2.cmml">{</mo><msub id="alg1.l0.m2.1.1.1.1.1.1" xref="alg1.l0.m2.1.1.1.1.1.1.cmml"><mi id="alg1.l0.m2.1.1.1.1.1.1.2" xref="alg1.l0.m2.1.1.1.1.1.1.2.cmml">C</mi><mi id="alg1.l0.m2.1.1.1.1.1.1.3" xref="alg1.l0.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l0.m2.1.1.1.1.1.3" xref="alg1.l0.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l0.m2.1.1.1.3" xref="alg1.l0.m2.1.1.1.3.cmml"><mi id="alg1.l0.m2.1.1.1.3.2" xref="alg1.l0.m2.1.1.1.3.2.cmml">i</mi><mo id="alg1.l0.m2.1.1.1.3.1" xref="alg1.l0.m2.1.1.1.3.1.cmml">=</mo><mn id="alg1.l0.m2.1.1.1.3.3" xref="alg1.l0.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l0.m2.1.1.3" xref="alg1.l0.m2.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><apply id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1"><csymbol cd="ambiguous" id="alg1.l0.m2.1.1.2.cmml" xref="alg1.l0.m2.1.1">superscript</csymbol><apply id="alg1.l0.m2.1.1.1.cmml" xref="alg1.l0.m2.1.1"><csymbol cd="ambiguous" id="alg1.l0.m2.1.1.1.2.cmml" xref="alg1.l0.m2.1.1">subscript</csymbol><set id="alg1.l0.m2.1.1.1.1.2.cmml" xref="alg1.l0.m2.1.1.1.1.1"><apply id="alg1.l0.m2.1.1.1.1.1.1.cmml" xref="alg1.l0.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m2.1.1.1.1.1.1.1.cmml" xref="alg1.l0.m2.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l0.m2.1.1.1.1.1.1.2.cmml" xref="alg1.l0.m2.1.1.1.1.1.1.2">𝐶</ci><ci id="alg1.l0.m2.1.1.1.1.1.1.3.cmml" xref="alg1.l0.m2.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="alg1.l0.m2.1.1.1.3.cmml" xref="alg1.l0.m2.1.1.1.3"><eq id="alg1.l0.m2.1.1.1.3.1.cmml" xref="alg1.l0.m2.1.1.1.3.1"></eq><ci id="alg1.l0.m2.1.1.1.3.2.cmml" xref="alg1.l0.m2.1.1.1.3.2">𝑖</ci><cn type="integer" id="alg1.l0.m2.1.1.1.3.3.cmml" xref="alg1.l0.m2.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l0.m2.1.1.3.cmml" xref="alg1.l0.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">\{C_{i}\}_{i=1}^{N}</annotation></semantics></math>, each holds <math id="alg1.l0.m3.1" class="ltx_Math" alttext="n_{i}" display="inline"><semantics id="alg1.l0.m3.1a"><msub id="alg1.l0.m3.1.1" xref="alg1.l0.m3.1.1.cmml"><mi id="alg1.l0.m3.1.1.2" xref="alg1.l0.m3.1.1.2.cmml">n</mi><mi id="alg1.l0.m3.1.1.3" xref="alg1.l0.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1b"><apply id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1"><csymbol cd="ambiguous" id="alg1.l0.m3.1.1.1.cmml" xref="alg1.l0.m3.1.1">subscript</csymbol><ci id="alg1.l0.m3.1.1.2.cmml" xref="alg1.l0.m3.1.1.2">𝑛</ci><ci id="alg1.l0.m3.1.1.3.cmml" xref="alg1.l0.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1c">n_{i}</annotation></semantics></math> data points, initial model parameters <math id="alg1.l0.m4.1" class="ltx_Math" alttext="W^{0}" display="inline"><semantics id="alg1.l0.m4.1a"><msup id="alg1.l0.m4.1.1" xref="alg1.l0.m4.1.1.cmml"><mi id="alg1.l0.m4.1.1.2" xref="alg1.l0.m4.1.1.2.cmml">W</mi><mn id="alg1.l0.m4.1.1.3" xref="alg1.l0.m4.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="alg1.l0.m4.1b"><apply id="alg1.l0.m4.1.1.cmml" xref="alg1.l0.m4.1.1"><csymbol cd="ambiguous" id="alg1.l0.m4.1.1.1.cmml" xref="alg1.l0.m4.1.1">superscript</csymbol><ci id="alg1.l0.m4.1.1.2.cmml" xref="alg1.l0.m4.1.1.2">𝑊</ci><cn type="integer" id="alg1.l0.m4.1.1.3.cmml" xref="alg1.l0.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m4.1c">W^{0}</annotation></semantics></math> and <math id="alg1.l0.m5.3" class="ltx_Math" alttext="\{\alpha^{0,i}\}_{i}" display="inline"><semantics id="alg1.l0.m5.3a"><msub id="alg1.l0.m5.3.3" xref="alg1.l0.m5.3.3.cmml"><mrow id="alg1.l0.m5.3.3.1.1" xref="alg1.l0.m5.3.3.1.2.cmml"><mo stretchy="false" id="alg1.l0.m5.3.3.1.1.2" xref="alg1.l0.m5.3.3.1.2.cmml">{</mo><msup id="alg1.l0.m5.3.3.1.1.1" xref="alg1.l0.m5.3.3.1.1.1.cmml"><mi id="alg1.l0.m5.3.3.1.1.1.2" xref="alg1.l0.m5.3.3.1.1.1.2.cmml">α</mi><mrow id="alg1.l0.m5.2.2.2.4" xref="alg1.l0.m5.2.2.2.3.cmml"><mn id="alg1.l0.m5.1.1.1.1" xref="alg1.l0.m5.1.1.1.1.cmml">0</mn><mo id="alg1.l0.m5.2.2.2.4.1" xref="alg1.l0.m5.2.2.2.3.cmml">,</mo><mi id="alg1.l0.m5.2.2.2.2" xref="alg1.l0.m5.2.2.2.2.cmml">i</mi></mrow></msup><mo stretchy="false" id="alg1.l0.m5.3.3.1.1.3" xref="alg1.l0.m5.3.3.1.2.cmml">}</mo></mrow><mi id="alg1.l0.m5.3.3.3" xref="alg1.l0.m5.3.3.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m5.3b"><apply id="alg1.l0.m5.3.3.cmml" xref="alg1.l0.m5.3.3"><csymbol cd="ambiguous" id="alg1.l0.m5.3.3.2.cmml" xref="alg1.l0.m5.3.3">subscript</csymbol><set id="alg1.l0.m5.3.3.1.2.cmml" xref="alg1.l0.m5.3.3.1.1"><apply id="alg1.l0.m5.3.3.1.1.1.cmml" xref="alg1.l0.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m5.3.3.1.1.1.1.cmml" xref="alg1.l0.m5.3.3.1.1.1">superscript</csymbol><ci id="alg1.l0.m5.3.3.1.1.1.2.cmml" xref="alg1.l0.m5.3.3.1.1.1.2">𝛼</ci><list id="alg1.l0.m5.2.2.2.3.cmml" xref="alg1.l0.m5.2.2.2.4"><cn type="integer" id="alg1.l0.m5.1.1.1.1.cmml" xref="alg1.l0.m5.1.1.1.1">0</cn><ci id="alg1.l0.m5.2.2.2.2.cmml" xref="alg1.l0.m5.2.2.2.2">𝑖</ci></list></apply></set><ci id="alg1.l0.m5.3.3.3.cmml" xref="alg1.l0.m5.3.3.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m5.3c">\{\alpha^{0,i}\}_{i}</annotation></semantics></math>, number of communication rounds <math id="alg1.l0.m6.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l0.m6.1a"><mi id="alg1.l0.m6.1.1" xref="alg1.l0.m6.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m6.1b"><ci id="alg1.l0.m6.1.1.cmml" xref="alg1.l0.m6.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m6.1c">T</annotation></semantics></math>, number of local epochs <math id="alg1.l0.m7.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l0.m7.1a"><mi id="alg1.l0.m7.1.1" xref="alg1.l0.m7.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m7.1b"><ci id="alg1.l0.m7.1.1.cmml" xref="alg1.l0.m7.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m7.1c">E</annotation></semantics></math>, learning rate <math id="alg1.l0.m8.1" class="ltx_Math" alttext="\eta_{\alpha}" display="inline"><semantics id="alg1.l0.m8.1a"><msub id="alg1.l0.m8.1.1" xref="alg1.l0.m8.1.1.cmml"><mi id="alg1.l0.m8.1.1.2" xref="alg1.l0.m8.1.1.2.cmml">η</mi><mi id="alg1.l0.m8.1.1.3" xref="alg1.l0.m8.1.1.3.cmml">α</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m8.1b"><apply id="alg1.l0.m8.1.1.cmml" xref="alg1.l0.m8.1.1"><csymbol cd="ambiguous" id="alg1.l0.m8.1.1.1.cmml" xref="alg1.l0.m8.1.1">subscript</csymbol><ci id="alg1.l0.m8.1.1.2.cmml" xref="alg1.l0.m8.1.1.2">𝜂</ci><ci id="alg1.l0.m8.1.1.3.cmml" xref="alg1.l0.m8.1.1.3">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m8.1c">\eta_{\alpha}</annotation></semantics></math> and <math id="alg1.l0.m9.1" class="ltx_Math" alttext="\eta_{W}" display="inline"><semantics id="alg1.l0.m9.1a"><msub id="alg1.l0.m9.1.1" xref="alg1.l0.m9.1.1.cmml"><mi id="alg1.l0.m9.1.1.2" xref="alg1.l0.m9.1.1.2.cmml">η</mi><mi id="alg1.l0.m9.1.1.3" xref="alg1.l0.m9.1.1.3.cmml">W</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m9.1b"><apply id="alg1.l0.m9.1.1.cmml" xref="alg1.l0.m9.1.1"><csymbol cd="ambiguous" id="alg1.l0.m9.1.1.1.cmml" xref="alg1.l0.m9.1.1">subscript</csymbol><ci id="alg1.l0.m9.1.1.2.cmml" xref="alg1.l0.m9.1.1.2">𝜂</ci><ci id="alg1.l0.m9.1.1.3.cmml" xref="alg1.l0.m9.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m9.1c">\eta_{W}</annotation></semantics></math>, size of sampled clients <math id="alg1.l0.m10.1" class="ltx_Math" alttext="S" display="inline"><semantics id="alg1.l0.m10.1a"><mi id="alg1.l0.m10.1.1" xref="alg1.l0.m10.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m10.1b"><ci id="alg1.l0.m10.1.1.cmml" xref="alg1.l0.m10.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m10.1c">S</annotation></semantics></math>, number of layers <math id="alg1.l0.m11.1" class="ltx_Math" alttext="L" display="inline"><semantics id="alg1.l0.m11.1a"><mi id="alg1.l0.m11.1.1" xref="alg1.l0.m11.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m11.1b"><ci id="alg1.l0.m11.1.1.cmml" xref="alg1.l0.m11.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m11.1c">L</annotation></semantics></math> and number of branches <math id="alg1.l0.m12.1" class="ltx_Math" alttext="B" display="inline"><semantics id="alg1.l0.m12.1a"><mi id="alg1.l0.m12.1.1" xref="alg1.l0.m12.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m12.1b"><ci id="alg1.l0.m12.1.1.cmml" xref="alg1.l0.m12.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m12.1c">B</annotation></semantics></math>

</div>
<div id="alg1.l0a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l0a.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>   <math id="alg1.l0a.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.l0a.m1.1a"><mi id="alg1.l0a.m1.1.1" xref="alg1.l0a.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l0a.m1.1b"><ci id="alg1.l0a.m1.1.1.cmml" xref="alg1.l0a.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m1.1c">N</annotation></semantics></math> personalized models <math id="alg1.l0a.m2.4" class="ltx_Math" alttext="w_{i}^{T}=(W^{T},\alpha^{T,i})" display="inline"><semantics id="alg1.l0a.m2.4a"><mrow id="alg1.l0a.m2.4.4" xref="alg1.l0a.m2.4.4.cmml"><msubsup id="alg1.l0a.m2.4.4.4" xref="alg1.l0a.m2.4.4.4.cmml"><mi id="alg1.l0a.m2.4.4.4.2.2" xref="alg1.l0a.m2.4.4.4.2.2.cmml">w</mi><mi id="alg1.l0a.m2.4.4.4.2.3" xref="alg1.l0a.m2.4.4.4.2.3.cmml">i</mi><mi id="alg1.l0a.m2.4.4.4.3" xref="alg1.l0a.m2.4.4.4.3.cmml">T</mi></msubsup><mo id="alg1.l0a.m2.4.4.3" xref="alg1.l0a.m2.4.4.3.cmml">=</mo><mrow id="alg1.l0a.m2.4.4.2.2" xref="alg1.l0a.m2.4.4.2.3.cmml"><mo stretchy="false" id="alg1.l0a.m2.4.4.2.2.3" xref="alg1.l0a.m2.4.4.2.3.cmml">(</mo><msup id="alg1.l0a.m2.3.3.1.1.1" xref="alg1.l0a.m2.3.3.1.1.1.cmml"><mi id="alg1.l0a.m2.3.3.1.1.1.2" xref="alg1.l0a.m2.3.3.1.1.1.2.cmml">W</mi><mi id="alg1.l0a.m2.3.3.1.1.1.3" xref="alg1.l0a.m2.3.3.1.1.1.3.cmml">T</mi></msup><mo id="alg1.l0a.m2.4.4.2.2.4" xref="alg1.l0a.m2.4.4.2.3.cmml">,</mo><msup id="alg1.l0a.m2.4.4.2.2.2" xref="alg1.l0a.m2.4.4.2.2.2.cmml"><mi id="alg1.l0a.m2.4.4.2.2.2.2" xref="alg1.l0a.m2.4.4.2.2.2.2.cmml">α</mi><mrow id="alg1.l0a.m2.2.2.2.4" xref="alg1.l0a.m2.2.2.2.3.cmml"><mi id="alg1.l0a.m2.1.1.1.1" xref="alg1.l0a.m2.1.1.1.1.cmml">T</mi><mo id="alg1.l0a.m2.2.2.2.4.1" xref="alg1.l0a.m2.2.2.2.3.cmml">,</mo><mi id="alg1.l0a.m2.2.2.2.2" xref="alg1.l0a.m2.2.2.2.2.cmml">i</mi></mrow></msup><mo stretchy="false" id="alg1.l0a.m2.4.4.2.2.5" xref="alg1.l0a.m2.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0a.m2.4b"><apply id="alg1.l0a.m2.4.4.cmml" xref="alg1.l0a.m2.4.4"><eq id="alg1.l0a.m2.4.4.3.cmml" xref="alg1.l0a.m2.4.4.3"></eq><apply id="alg1.l0a.m2.4.4.4.cmml" xref="alg1.l0a.m2.4.4.4"><csymbol cd="ambiguous" id="alg1.l0a.m2.4.4.4.1.cmml" xref="alg1.l0a.m2.4.4.4">superscript</csymbol><apply id="alg1.l0a.m2.4.4.4.2.cmml" xref="alg1.l0a.m2.4.4.4"><csymbol cd="ambiguous" id="alg1.l0a.m2.4.4.4.2.1.cmml" xref="alg1.l0a.m2.4.4.4">subscript</csymbol><ci id="alg1.l0a.m2.4.4.4.2.2.cmml" xref="alg1.l0a.m2.4.4.4.2.2">𝑤</ci><ci id="alg1.l0a.m2.4.4.4.2.3.cmml" xref="alg1.l0a.m2.4.4.4.2.3">𝑖</ci></apply><ci id="alg1.l0a.m2.4.4.4.3.cmml" xref="alg1.l0a.m2.4.4.4.3">𝑇</ci></apply><interval closure="open" id="alg1.l0a.m2.4.4.2.3.cmml" xref="alg1.l0a.m2.4.4.2.2"><apply id="alg1.l0a.m2.3.3.1.1.1.cmml" xref="alg1.l0a.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l0a.m2.3.3.1.1.1.1.cmml" xref="alg1.l0a.m2.3.3.1.1.1">superscript</csymbol><ci id="alg1.l0a.m2.3.3.1.1.1.2.cmml" xref="alg1.l0a.m2.3.3.1.1.1.2">𝑊</ci><ci id="alg1.l0a.m2.3.3.1.1.1.3.cmml" xref="alg1.l0a.m2.3.3.1.1.1.3">𝑇</ci></apply><apply id="alg1.l0a.m2.4.4.2.2.2.cmml" xref="alg1.l0a.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l0a.m2.4.4.2.2.2.1.cmml" xref="alg1.l0a.m2.4.4.2.2.2">superscript</csymbol><ci id="alg1.l0a.m2.4.4.2.2.2.2.cmml" xref="alg1.l0a.m2.4.4.2.2.2.2">𝛼</ci><list id="alg1.l0a.m2.2.2.2.3.cmml" xref="alg1.l0a.m2.2.2.2.4"><ci id="alg1.l0a.m2.1.1.1.1.cmml" xref="alg1.l0a.m2.1.1.1.1">𝑇</ci><ci id="alg1.l0a.m2.2.2.2.2.cmml" xref="alg1.l0a.m2.2.2.2.2">𝑖</ci></list></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m2.4c">w_{i}^{T}=(W^{T},\alpha^{T,i})</annotation></semantics></math>

</div>
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg1.l1.2" class="ltx_text ltx_font_bold">Server do:</span>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <span id="alg1.l2.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l2.m1.3" class="ltx_Math" alttext="t=0,\cdots,T-1" display="inline"><semantics id="alg1.l2.m1.3a"><mrow id="alg1.l2.m1.3.3" xref="alg1.l2.m1.3.3.cmml"><mi id="alg1.l2.m1.3.3.3" xref="alg1.l2.m1.3.3.3.cmml">t</mi><mo id="alg1.l2.m1.3.3.2" xref="alg1.l2.m1.3.3.2.cmml">=</mo><mrow id="alg1.l2.m1.3.3.1.1" xref="alg1.l2.m1.3.3.1.2.cmml"><mn id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">0</mn><mo id="alg1.l2.m1.3.3.1.1.2" xref="alg1.l2.m1.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml">⋯</mi><mo id="alg1.l2.m1.3.3.1.1.3" xref="alg1.l2.m1.3.3.1.2.cmml">,</mo><mrow id="alg1.l2.m1.3.3.1.1.1" xref="alg1.l2.m1.3.3.1.1.1.cmml"><mi id="alg1.l2.m1.3.3.1.1.1.2" xref="alg1.l2.m1.3.3.1.1.1.2.cmml">T</mi><mo id="alg1.l2.m1.3.3.1.1.1.1" xref="alg1.l2.m1.3.3.1.1.1.1.cmml">−</mo><mn id="alg1.l2.m1.3.3.1.1.1.3" xref="alg1.l2.m1.3.3.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.3b"><apply id="alg1.l2.m1.3.3.cmml" xref="alg1.l2.m1.3.3"><eq id="alg1.l2.m1.3.3.2.cmml" xref="alg1.l2.m1.3.3.2"></eq><ci id="alg1.l2.m1.3.3.3.cmml" xref="alg1.l2.m1.3.3.3">𝑡</ci><list id="alg1.l2.m1.3.3.1.2.cmml" xref="alg1.l2.m1.3.3.1.1"><cn type="integer" id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">0</cn><ci id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2">⋯</ci><apply id="alg1.l2.m1.3.3.1.1.1.cmml" xref="alg1.l2.m1.3.3.1.1.1"><minus id="alg1.l2.m1.3.3.1.1.1.1.cmml" xref="alg1.l2.m1.3.3.1.1.1.1"></minus><ci id="alg1.l2.m1.3.3.1.1.1.2.cmml" xref="alg1.l2.m1.3.3.1.1.1.2">𝑇</ci><cn type="integer" id="alg1.l2.m1.3.3.1.1.1.3.cmml" xref="alg1.l2.m1.3.3.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.3c">t=0,\cdots,T-1</annotation></semantics></math> <span id="alg1.l2.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     Send <math id="alg1.l3.m1.1" class="ltx_Math" alttext="W^{t}" display="inline"><semantics id="alg1.l3.m1.1a"><msup id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">W</mi><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">superscript</csymbol><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑊</ci><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">W^{t}</annotation></semantics></math> to all clients

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     Sample a subset of clients <math id="alg1.l4.m1.1" class="ltx_Math" alttext="\mathcal{S}_{t}" display="inline"><semantics id="alg1.l4.m1.1a"><msub id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">𝒮</mi><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝒮</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\mathcal{S}_{t}</annotation></semantics></math> with size <math id="alg1.l4.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="alg1.l4.m2.1a"><mi id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><ci id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">S</annotation></semantics></math>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     <span id="alg1.l5.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l5.m1.1" class="ltx_Math" alttext="C_{i}\in\mathcal{S}_{t}" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><msub id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2.cmml">C</mi><mi id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml">i</mi></msub><mo id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">∈</mo><msub id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m1.1.1.3.2" xref="alg1.l5.m1.1.1.3.2.cmml">𝒮</mi><mi id="alg1.l5.m1.1.1.3.3" xref="alg1.l5.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><in id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"></in><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">𝐶</ci><ci id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3">subscript</csymbol><ci id="alg1.l5.m1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.3.2">𝒮</ci><ci id="alg1.l5.m1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">C_{i}\in\mathcal{S}_{t}</annotation></semantics></math> <span id="alg1.l5.3" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg1.l5.4" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>        Do <span id="alg1.l6.2" class="ltx_text ltx_font_bold">ClientLocalLearning</span>(<math id="alg1.l6.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l6.m1.1a"><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">i</annotation></semantics></math>, <math id="alg1.l6.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg1.l6.m2.1a"><mi id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><ci id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">t</annotation></semantics></math>, <math id="alg1.l6.m3.1" class="ltx_Math" alttext="W^{t}" display="inline"><semantics id="alg1.l6.m3.1a"><msup id="alg1.l6.m3.1.1" xref="alg1.l6.m3.1.1.cmml"><mi id="alg1.l6.m3.1.1.2" xref="alg1.l6.m3.1.1.2.cmml">W</mi><mi id="alg1.l6.m3.1.1.3" xref="alg1.l6.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l6.m3.1b"><apply id="alg1.l6.m3.1.1.cmml" xref="alg1.l6.m3.1.1"><csymbol cd="ambiguous" id="alg1.l6.m3.1.1.1.cmml" xref="alg1.l6.m3.1.1">superscript</csymbol><ci id="alg1.l6.m3.1.1.2.cmml" xref="alg1.l6.m3.1.1.2">𝑊</ci><ci id="alg1.l6.m3.1.1.3.cmml" xref="alg1.l6.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m3.1c">W^{t}</annotation></semantics></math>)

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>     <span id="alg1.l7.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l7.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     <span id="alg1.l8.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l8.m1.3" class="ltx_Math" alttext="l=1,\cdots,L" display="inline"><semantics id="alg1.l8.m1.3a"><mrow id="alg1.l8.m1.3.4" xref="alg1.l8.m1.3.4.cmml"><mi id="alg1.l8.m1.3.4.2" xref="alg1.l8.m1.3.4.2.cmml">l</mi><mo id="alg1.l8.m1.3.4.1" xref="alg1.l8.m1.3.4.1.cmml">=</mo><mrow id="alg1.l8.m1.3.4.3.2" xref="alg1.l8.m1.3.4.3.1.cmml"><mn id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">1</mn><mo id="alg1.l8.m1.3.4.3.2.1" xref="alg1.l8.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml">⋯</mi><mo id="alg1.l8.m1.3.4.3.2.2" xref="alg1.l8.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l8.m1.3.3" xref="alg1.l8.m1.3.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.3b"><apply id="alg1.l8.m1.3.4.cmml" xref="alg1.l8.m1.3.4"><eq id="alg1.l8.m1.3.4.1.cmml" xref="alg1.l8.m1.3.4.1"></eq><ci id="alg1.l8.m1.3.4.2.cmml" xref="alg1.l8.m1.3.4.2">𝑙</ci><list id="alg1.l8.m1.3.4.3.1.cmml" xref="alg1.l8.m1.3.4.3.2"><cn type="integer" id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">1</cn><ci id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2">⋯</ci><ci id="alg1.l8.m1.3.3.cmml" xref="alg1.l8.m1.3.3">𝐿</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.3c">l=1,\cdots,L</annotation></semantics></math> <span id="alg1.l8.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>        <span id="alg1.l9.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l9.m1.3" class="ltx_Math" alttext="b=1,\cdots,B" display="inline"><semantics id="alg1.l9.m1.3a"><mrow id="alg1.l9.m1.3.4" xref="alg1.l9.m1.3.4.cmml"><mi id="alg1.l9.m1.3.4.2" xref="alg1.l9.m1.3.4.2.cmml">b</mi><mo id="alg1.l9.m1.3.4.1" xref="alg1.l9.m1.3.4.1.cmml">=</mo><mrow id="alg1.l9.m1.3.4.3.2" xref="alg1.l9.m1.3.4.3.1.cmml"><mn id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">1</mn><mo id="alg1.l9.m1.3.4.3.2.1" xref="alg1.l9.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l9.m1.2.2" xref="alg1.l9.m1.2.2.cmml">⋯</mi><mo id="alg1.l9.m1.3.4.3.2.2" xref="alg1.l9.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l9.m1.3.3" xref="alg1.l9.m1.3.3.cmml">B</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.3b"><apply id="alg1.l9.m1.3.4.cmml" xref="alg1.l9.m1.3.4"><eq id="alg1.l9.m1.3.4.1.cmml" xref="alg1.l9.m1.3.4.1"></eq><ci id="alg1.l9.m1.3.4.2.cmml" xref="alg1.l9.m1.3.4.2">𝑏</ci><list id="alg1.l9.m1.3.4.3.1.cmml" xref="alg1.l9.m1.3.4.3.2"><cn type="integer" id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">1</cn><ci id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2">⋯</ci><ci id="alg1.l9.m1.3.3.cmml" xref="alg1.l9.m1.3.3">𝐵</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.3c">b=1,\cdots,B</annotation></semantics></math> <span id="alg1.l9.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>           <math id="alg1.l10.m1.14" class="ltx_Math" alttext="W_{l,b}^{t+1}\leftarrow\frac{\sum_{i=1}^{N}n_{i}\alpha_{l,b}^{t+1,i}W_{l,b}^{t+1,i}}{\sum_{j=1}^{N}n_{j}\alpha_{l,b}^{t+1,j}}" display="inline"><semantics id="alg1.l10.m1.14a"><mrow id="alg1.l10.m1.14.15" xref="alg1.l10.m1.14.15.cmml"><msubsup id="alg1.l10.m1.14.15.2" xref="alg1.l10.m1.14.15.2.cmml"><mi id="alg1.l10.m1.14.15.2.2.2" xref="alg1.l10.m1.14.15.2.2.2.cmml">W</mi><mrow id="alg1.l10.m1.2.2.2.4" xref="alg1.l10.m1.2.2.2.3.cmml"><mi id="alg1.l10.m1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.cmml">l</mi><mo id="alg1.l10.m1.2.2.2.4.1" xref="alg1.l10.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l10.m1.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.cmml">b</mi></mrow><mrow id="alg1.l10.m1.14.15.2.3" xref="alg1.l10.m1.14.15.2.3.cmml"><mi id="alg1.l10.m1.14.15.2.3.2" xref="alg1.l10.m1.14.15.2.3.2.cmml">t</mi><mo id="alg1.l10.m1.14.15.2.3.1" xref="alg1.l10.m1.14.15.2.3.1.cmml">+</mo><mn id="alg1.l10.m1.14.15.2.3.3" xref="alg1.l10.m1.14.15.2.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="alg1.l10.m1.14.15.1" xref="alg1.l10.m1.14.15.1.cmml">←</mo><mfrac id="alg1.l10.m1.14.14" xref="alg1.l10.m1.14.14.cmml"><mrow id="alg1.l10.m1.10.10.8" xref="alg1.l10.m1.10.10.8.cmml"><mstyle displaystyle="false" id="alg1.l10.m1.10.10.8.9" xref="alg1.l10.m1.10.10.8.9.cmml"><msubsup id="alg1.l10.m1.10.10.8.9a" xref="alg1.l10.m1.10.10.8.9.cmml"><mo id="alg1.l10.m1.10.10.8.9.2.2" xref="alg1.l10.m1.10.10.8.9.2.2.cmml">∑</mo><mrow id="alg1.l10.m1.10.10.8.9.2.3" xref="alg1.l10.m1.10.10.8.9.2.3.cmml"><mi id="alg1.l10.m1.10.10.8.9.2.3.2" xref="alg1.l10.m1.10.10.8.9.2.3.2.cmml">i</mi><mo id="alg1.l10.m1.10.10.8.9.2.3.1" xref="alg1.l10.m1.10.10.8.9.2.3.1.cmml">=</mo><mn id="alg1.l10.m1.10.10.8.9.2.3.3" xref="alg1.l10.m1.10.10.8.9.2.3.3.cmml">1</mn></mrow><mi id="alg1.l10.m1.10.10.8.9.3" xref="alg1.l10.m1.10.10.8.9.3.cmml">N</mi></msubsup></mstyle><mrow id="alg1.l10.m1.10.10.8.10" xref="alg1.l10.m1.10.10.8.10.cmml"><msub id="alg1.l10.m1.10.10.8.10.2" xref="alg1.l10.m1.10.10.8.10.2.cmml"><mi id="alg1.l10.m1.10.10.8.10.2.2" xref="alg1.l10.m1.10.10.8.10.2.2.cmml">n</mi><mi id="alg1.l10.m1.10.10.8.10.2.3" xref="alg1.l10.m1.10.10.8.10.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l10.m1.10.10.8.10.1" xref="alg1.l10.m1.10.10.8.10.1.cmml">​</mo><msubsup id="alg1.l10.m1.10.10.8.10.3" xref="alg1.l10.m1.10.10.8.10.3.cmml"><mi id="alg1.l10.m1.10.10.8.10.3.2.2" xref="alg1.l10.m1.10.10.8.10.3.2.2.cmml">α</mi><mrow id="alg1.l10.m1.4.4.2.2.2.4" xref="alg1.l10.m1.4.4.2.2.2.3.cmml"><mi id="alg1.l10.m1.3.3.1.1.1.1" xref="alg1.l10.m1.3.3.1.1.1.1.cmml">l</mi><mo id="alg1.l10.m1.4.4.2.2.2.4.1" xref="alg1.l10.m1.4.4.2.2.2.3.cmml">,</mo><mi id="alg1.l10.m1.4.4.2.2.2.2" xref="alg1.l10.m1.4.4.2.2.2.2.cmml">b</mi></mrow><mrow id="alg1.l10.m1.6.6.4.4.2.2" xref="alg1.l10.m1.6.6.4.4.2.3.cmml"><mrow id="alg1.l10.m1.6.6.4.4.2.2.1" xref="alg1.l10.m1.6.6.4.4.2.2.1.cmml"><mi id="alg1.l10.m1.6.6.4.4.2.2.1.2" xref="alg1.l10.m1.6.6.4.4.2.2.1.2.cmml">t</mi><mo id="alg1.l10.m1.6.6.4.4.2.2.1.1" xref="alg1.l10.m1.6.6.4.4.2.2.1.1.cmml">+</mo><mn id="alg1.l10.m1.6.6.4.4.2.2.1.3" xref="alg1.l10.m1.6.6.4.4.2.2.1.3.cmml">1</mn></mrow><mo id="alg1.l10.m1.6.6.4.4.2.2.2" xref="alg1.l10.m1.6.6.4.4.2.3.cmml">,</mo><mi id="alg1.l10.m1.5.5.3.3.1.1" xref="alg1.l10.m1.5.5.3.3.1.1.cmml">i</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l10.m1.10.10.8.10.1a" xref="alg1.l10.m1.10.10.8.10.1.cmml">​</mo><msubsup id="alg1.l10.m1.10.10.8.10.4" xref="alg1.l10.m1.10.10.8.10.4.cmml"><mi id="alg1.l10.m1.10.10.8.10.4.2.2" xref="alg1.l10.m1.10.10.8.10.4.2.2.cmml">W</mi><mrow id="alg1.l10.m1.8.8.6.6.2.4" xref="alg1.l10.m1.8.8.6.6.2.3.cmml"><mi id="alg1.l10.m1.7.7.5.5.1.1" xref="alg1.l10.m1.7.7.5.5.1.1.cmml">l</mi><mo id="alg1.l10.m1.8.8.6.6.2.4.1" xref="alg1.l10.m1.8.8.6.6.2.3.cmml">,</mo><mi id="alg1.l10.m1.8.8.6.6.2.2" xref="alg1.l10.m1.8.8.6.6.2.2.cmml">b</mi></mrow><mrow id="alg1.l10.m1.10.10.8.8.2.2" xref="alg1.l10.m1.10.10.8.8.2.3.cmml"><mrow id="alg1.l10.m1.10.10.8.8.2.2.1" xref="alg1.l10.m1.10.10.8.8.2.2.1.cmml"><mi id="alg1.l10.m1.10.10.8.8.2.2.1.2" xref="alg1.l10.m1.10.10.8.8.2.2.1.2.cmml">t</mi><mo id="alg1.l10.m1.10.10.8.8.2.2.1.1" xref="alg1.l10.m1.10.10.8.8.2.2.1.1.cmml">+</mo><mn id="alg1.l10.m1.10.10.8.8.2.2.1.3" xref="alg1.l10.m1.10.10.8.8.2.2.1.3.cmml">1</mn></mrow><mo id="alg1.l10.m1.10.10.8.8.2.2.2" xref="alg1.l10.m1.10.10.8.8.2.3.cmml">,</mo><mi id="alg1.l10.m1.9.9.7.7.1.1" xref="alg1.l10.m1.9.9.7.7.1.1.cmml">i</mi></mrow></msubsup></mrow></mrow><mrow id="alg1.l10.m1.14.14.12" xref="alg1.l10.m1.14.14.12.cmml"><mstyle displaystyle="false" id="alg1.l10.m1.14.14.12.5" xref="alg1.l10.m1.14.14.12.5.cmml"><msubsup id="alg1.l10.m1.14.14.12.5a" xref="alg1.l10.m1.14.14.12.5.cmml"><mo id="alg1.l10.m1.14.14.12.5.2.2" xref="alg1.l10.m1.14.14.12.5.2.2.cmml">∑</mo><mrow id="alg1.l10.m1.14.14.12.5.2.3" xref="alg1.l10.m1.14.14.12.5.2.3.cmml"><mi id="alg1.l10.m1.14.14.12.5.2.3.2" xref="alg1.l10.m1.14.14.12.5.2.3.2.cmml">j</mi><mo id="alg1.l10.m1.14.14.12.5.2.3.1" xref="alg1.l10.m1.14.14.12.5.2.3.1.cmml">=</mo><mn id="alg1.l10.m1.14.14.12.5.2.3.3" xref="alg1.l10.m1.14.14.12.5.2.3.3.cmml">1</mn></mrow><mi id="alg1.l10.m1.14.14.12.5.3" xref="alg1.l10.m1.14.14.12.5.3.cmml">N</mi></msubsup></mstyle><mrow id="alg1.l10.m1.14.14.12.6" xref="alg1.l10.m1.14.14.12.6.cmml"><msub id="alg1.l10.m1.14.14.12.6.2" xref="alg1.l10.m1.14.14.12.6.2.cmml"><mi id="alg1.l10.m1.14.14.12.6.2.2" xref="alg1.l10.m1.14.14.12.6.2.2.cmml">n</mi><mi id="alg1.l10.m1.14.14.12.6.2.3" xref="alg1.l10.m1.14.14.12.6.2.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l10.m1.14.14.12.6.1" xref="alg1.l10.m1.14.14.12.6.1.cmml">​</mo><msubsup id="alg1.l10.m1.14.14.12.6.3" xref="alg1.l10.m1.14.14.12.6.3.cmml"><mi id="alg1.l10.m1.14.14.12.6.3.2.2" xref="alg1.l10.m1.14.14.12.6.3.2.2.cmml">α</mi><mrow id="alg1.l10.m1.12.12.10.2.2.4" xref="alg1.l10.m1.12.12.10.2.2.3.cmml"><mi id="alg1.l10.m1.11.11.9.1.1.1" xref="alg1.l10.m1.11.11.9.1.1.1.cmml">l</mi><mo id="alg1.l10.m1.12.12.10.2.2.4.1" xref="alg1.l10.m1.12.12.10.2.2.3.cmml">,</mo><mi id="alg1.l10.m1.12.12.10.2.2.2" xref="alg1.l10.m1.12.12.10.2.2.2.cmml">b</mi></mrow><mrow id="alg1.l10.m1.14.14.12.4.2.2" xref="alg1.l10.m1.14.14.12.4.2.3.cmml"><mrow id="alg1.l10.m1.14.14.12.4.2.2.1" xref="alg1.l10.m1.14.14.12.4.2.2.1.cmml"><mi id="alg1.l10.m1.14.14.12.4.2.2.1.2" xref="alg1.l10.m1.14.14.12.4.2.2.1.2.cmml">t</mi><mo id="alg1.l10.m1.14.14.12.4.2.2.1.1" xref="alg1.l10.m1.14.14.12.4.2.2.1.1.cmml">+</mo><mn id="alg1.l10.m1.14.14.12.4.2.2.1.3" xref="alg1.l10.m1.14.14.12.4.2.2.1.3.cmml">1</mn></mrow><mo id="alg1.l10.m1.14.14.12.4.2.2.2" xref="alg1.l10.m1.14.14.12.4.2.3.cmml">,</mo><mi id="alg1.l10.m1.13.13.11.3.1.1" xref="alg1.l10.m1.13.13.11.3.1.1.cmml">j</mi></mrow></msubsup></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.14b"><apply id="alg1.l10.m1.14.15.cmml" xref="alg1.l10.m1.14.15"><ci id="alg1.l10.m1.14.15.1.cmml" xref="alg1.l10.m1.14.15.1">←</ci><apply id="alg1.l10.m1.14.15.2.cmml" xref="alg1.l10.m1.14.15.2"><csymbol cd="ambiguous" id="alg1.l10.m1.14.15.2.1.cmml" xref="alg1.l10.m1.14.15.2">superscript</csymbol><apply id="alg1.l10.m1.14.15.2.2.cmml" xref="alg1.l10.m1.14.15.2"><csymbol cd="ambiguous" id="alg1.l10.m1.14.15.2.2.1.cmml" xref="alg1.l10.m1.14.15.2">subscript</csymbol><ci id="alg1.l10.m1.14.15.2.2.2.cmml" xref="alg1.l10.m1.14.15.2.2.2">𝑊</ci><list id="alg1.l10.m1.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.4"><ci id="alg1.l10.m1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1">𝑙</ci><ci id="alg1.l10.m1.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2">𝑏</ci></list></apply><apply id="alg1.l10.m1.14.15.2.3.cmml" xref="alg1.l10.m1.14.15.2.3"><plus id="alg1.l10.m1.14.15.2.3.1.cmml" xref="alg1.l10.m1.14.15.2.3.1"></plus><ci id="alg1.l10.m1.14.15.2.3.2.cmml" xref="alg1.l10.m1.14.15.2.3.2">𝑡</ci><cn type="integer" id="alg1.l10.m1.14.15.2.3.3.cmml" xref="alg1.l10.m1.14.15.2.3.3">1</cn></apply></apply><apply id="alg1.l10.m1.14.14.cmml" xref="alg1.l10.m1.14.14"><divide id="alg1.l10.m1.14.14.13.cmml" xref="alg1.l10.m1.14.14"></divide><apply id="alg1.l10.m1.10.10.8.cmml" xref="alg1.l10.m1.10.10.8"><apply id="alg1.l10.m1.10.10.8.9.cmml" xref="alg1.l10.m1.10.10.8.9"><csymbol cd="ambiguous" id="alg1.l10.m1.10.10.8.9.1.cmml" xref="alg1.l10.m1.10.10.8.9">superscript</csymbol><apply id="alg1.l10.m1.10.10.8.9.2.cmml" xref="alg1.l10.m1.10.10.8.9"><csymbol cd="ambiguous" id="alg1.l10.m1.10.10.8.9.2.1.cmml" xref="alg1.l10.m1.10.10.8.9">subscript</csymbol><sum id="alg1.l10.m1.10.10.8.9.2.2.cmml" xref="alg1.l10.m1.10.10.8.9.2.2"></sum><apply id="alg1.l10.m1.10.10.8.9.2.3.cmml" xref="alg1.l10.m1.10.10.8.9.2.3"><eq id="alg1.l10.m1.10.10.8.9.2.3.1.cmml" xref="alg1.l10.m1.10.10.8.9.2.3.1"></eq><ci id="alg1.l10.m1.10.10.8.9.2.3.2.cmml" xref="alg1.l10.m1.10.10.8.9.2.3.2">𝑖</ci><cn type="integer" id="alg1.l10.m1.10.10.8.9.2.3.3.cmml" xref="alg1.l10.m1.10.10.8.9.2.3.3">1</cn></apply></apply><ci id="alg1.l10.m1.10.10.8.9.3.cmml" xref="alg1.l10.m1.10.10.8.9.3">𝑁</ci></apply><apply id="alg1.l10.m1.10.10.8.10.cmml" xref="alg1.l10.m1.10.10.8.10"><times id="alg1.l10.m1.10.10.8.10.1.cmml" xref="alg1.l10.m1.10.10.8.10.1"></times><apply id="alg1.l10.m1.10.10.8.10.2.cmml" xref="alg1.l10.m1.10.10.8.10.2"><csymbol cd="ambiguous" id="alg1.l10.m1.10.10.8.10.2.1.cmml" xref="alg1.l10.m1.10.10.8.10.2">subscript</csymbol><ci id="alg1.l10.m1.10.10.8.10.2.2.cmml" xref="alg1.l10.m1.10.10.8.10.2.2">𝑛</ci><ci id="alg1.l10.m1.10.10.8.10.2.3.cmml" xref="alg1.l10.m1.10.10.8.10.2.3">𝑖</ci></apply><apply id="alg1.l10.m1.10.10.8.10.3.cmml" xref="alg1.l10.m1.10.10.8.10.3"><csymbol cd="ambiguous" id="alg1.l10.m1.10.10.8.10.3.1.cmml" xref="alg1.l10.m1.10.10.8.10.3">superscript</csymbol><apply id="alg1.l10.m1.10.10.8.10.3.2.cmml" xref="alg1.l10.m1.10.10.8.10.3"><csymbol cd="ambiguous" id="alg1.l10.m1.10.10.8.10.3.2.1.cmml" xref="alg1.l10.m1.10.10.8.10.3">subscript</csymbol><ci id="alg1.l10.m1.10.10.8.10.3.2.2.cmml" xref="alg1.l10.m1.10.10.8.10.3.2.2">𝛼</ci><list id="alg1.l10.m1.4.4.2.2.2.3.cmml" xref="alg1.l10.m1.4.4.2.2.2.4"><ci id="alg1.l10.m1.3.3.1.1.1.1.cmml" xref="alg1.l10.m1.3.3.1.1.1.1">𝑙</ci><ci id="alg1.l10.m1.4.4.2.2.2.2.cmml" xref="alg1.l10.m1.4.4.2.2.2.2">𝑏</ci></list></apply><list id="alg1.l10.m1.6.6.4.4.2.3.cmml" xref="alg1.l10.m1.6.6.4.4.2.2"><apply id="alg1.l10.m1.6.6.4.4.2.2.1.cmml" xref="alg1.l10.m1.6.6.4.4.2.2.1"><plus id="alg1.l10.m1.6.6.4.4.2.2.1.1.cmml" xref="alg1.l10.m1.6.6.4.4.2.2.1.1"></plus><ci id="alg1.l10.m1.6.6.4.4.2.2.1.2.cmml" xref="alg1.l10.m1.6.6.4.4.2.2.1.2">𝑡</ci><cn type="integer" id="alg1.l10.m1.6.6.4.4.2.2.1.3.cmml" xref="alg1.l10.m1.6.6.4.4.2.2.1.3">1</cn></apply><ci id="alg1.l10.m1.5.5.3.3.1.1.cmml" xref="alg1.l10.m1.5.5.3.3.1.1">𝑖</ci></list></apply><apply id="alg1.l10.m1.10.10.8.10.4.cmml" xref="alg1.l10.m1.10.10.8.10.4"><csymbol cd="ambiguous" id="alg1.l10.m1.10.10.8.10.4.1.cmml" xref="alg1.l10.m1.10.10.8.10.4">superscript</csymbol><apply id="alg1.l10.m1.10.10.8.10.4.2.cmml" xref="alg1.l10.m1.10.10.8.10.4"><csymbol cd="ambiguous" id="alg1.l10.m1.10.10.8.10.4.2.1.cmml" xref="alg1.l10.m1.10.10.8.10.4">subscript</csymbol><ci id="alg1.l10.m1.10.10.8.10.4.2.2.cmml" xref="alg1.l10.m1.10.10.8.10.4.2.2">𝑊</ci><list id="alg1.l10.m1.8.8.6.6.2.3.cmml" xref="alg1.l10.m1.8.8.6.6.2.4"><ci id="alg1.l10.m1.7.7.5.5.1.1.cmml" xref="alg1.l10.m1.7.7.5.5.1.1">𝑙</ci><ci id="alg1.l10.m1.8.8.6.6.2.2.cmml" xref="alg1.l10.m1.8.8.6.6.2.2">𝑏</ci></list></apply><list id="alg1.l10.m1.10.10.8.8.2.3.cmml" xref="alg1.l10.m1.10.10.8.8.2.2"><apply id="alg1.l10.m1.10.10.8.8.2.2.1.cmml" xref="alg1.l10.m1.10.10.8.8.2.2.1"><plus id="alg1.l10.m1.10.10.8.8.2.2.1.1.cmml" xref="alg1.l10.m1.10.10.8.8.2.2.1.1"></plus><ci id="alg1.l10.m1.10.10.8.8.2.2.1.2.cmml" xref="alg1.l10.m1.10.10.8.8.2.2.1.2">𝑡</ci><cn type="integer" id="alg1.l10.m1.10.10.8.8.2.2.1.3.cmml" xref="alg1.l10.m1.10.10.8.8.2.2.1.3">1</cn></apply><ci id="alg1.l10.m1.9.9.7.7.1.1.cmml" xref="alg1.l10.m1.9.9.7.7.1.1">𝑖</ci></list></apply></apply></apply><apply id="alg1.l10.m1.14.14.12.cmml" xref="alg1.l10.m1.14.14.12"><apply id="alg1.l10.m1.14.14.12.5.cmml" xref="alg1.l10.m1.14.14.12.5"><csymbol cd="ambiguous" id="alg1.l10.m1.14.14.12.5.1.cmml" xref="alg1.l10.m1.14.14.12.5">superscript</csymbol><apply id="alg1.l10.m1.14.14.12.5.2.cmml" xref="alg1.l10.m1.14.14.12.5"><csymbol cd="ambiguous" id="alg1.l10.m1.14.14.12.5.2.1.cmml" xref="alg1.l10.m1.14.14.12.5">subscript</csymbol><sum id="alg1.l10.m1.14.14.12.5.2.2.cmml" xref="alg1.l10.m1.14.14.12.5.2.2"></sum><apply id="alg1.l10.m1.14.14.12.5.2.3.cmml" xref="alg1.l10.m1.14.14.12.5.2.3"><eq id="alg1.l10.m1.14.14.12.5.2.3.1.cmml" xref="alg1.l10.m1.14.14.12.5.2.3.1"></eq><ci id="alg1.l10.m1.14.14.12.5.2.3.2.cmml" xref="alg1.l10.m1.14.14.12.5.2.3.2">𝑗</ci><cn type="integer" id="alg1.l10.m1.14.14.12.5.2.3.3.cmml" xref="alg1.l10.m1.14.14.12.5.2.3.3">1</cn></apply></apply><ci id="alg1.l10.m1.14.14.12.5.3.cmml" xref="alg1.l10.m1.14.14.12.5.3">𝑁</ci></apply><apply id="alg1.l10.m1.14.14.12.6.cmml" xref="alg1.l10.m1.14.14.12.6"><times id="alg1.l10.m1.14.14.12.6.1.cmml" xref="alg1.l10.m1.14.14.12.6.1"></times><apply id="alg1.l10.m1.14.14.12.6.2.cmml" xref="alg1.l10.m1.14.14.12.6.2"><csymbol cd="ambiguous" id="alg1.l10.m1.14.14.12.6.2.1.cmml" xref="alg1.l10.m1.14.14.12.6.2">subscript</csymbol><ci id="alg1.l10.m1.14.14.12.6.2.2.cmml" xref="alg1.l10.m1.14.14.12.6.2.2">𝑛</ci><ci id="alg1.l10.m1.14.14.12.6.2.3.cmml" xref="alg1.l10.m1.14.14.12.6.2.3">𝑗</ci></apply><apply id="alg1.l10.m1.14.14.12.6.3.cmml" xref="alg1.l10.m1.14.14.12.6.3"><csymbol cd="ambiguous" id="alg1.l10.m1.14.14.12.6.3.1.cmml" xref="alg1.l10.m1.14.14.12.6.3">superscript</csymbol><apply id="alg1.l10.m1.14.14.12.6.3.2.cmml" xref="alg1.l10.m1.14.14.12.6.3"><csymbol cd="ambiguous" id="alg1.l10.m1.14.14.12.6.3.2.1.cmml" xref="alg1.l10.m1.14.14.12.6.3">subscript</csymbol><ci id="alg1.l10.m1.14.14.12.6.3.2.2.cmml" xref="alg1.l10.m1.14.14.12.6.3.2.2">𝛼</ci><list id="alg1.l10.m1.12.12.10.2.2.3.cmml" xref="alg1.l10.m1.12.12.10.2.2.4"><ci id="alg1.l10.m1.11.11.9.1.1.1.cmml" xref="alg1.l10.m1.11.11.9.1.1.1">𝑙</ci><ci id="alg1.l10.m1.12.12.10.2.2.2.cmml" xref="alg1.l10.m1.12.12.10.2.2.2">𝑏</ci></list></apply><list id="alg1.l10.m1.14.14.12.4.2.3.cmml" xref="alg1.l10.m1.14.14.12.4.2.2"><apply id="alg1.l10.m1.14.14.12.4.2.2.1.cmml" xref="alg1.l10.m1.14.14.12.4.2.2.1"><plus id="alg1.l10.m1.14.14.12.4.2.2.1.1.cmml" xref="alg1.l10.m1.14.14.12.4.2.2.1.1"></plus><ci id="alg1.l10.m1.14.14.12.4.2.2.1.2.cmml" xref="alg1.l10.m1.14.14.12.4.2.2.1.2">𝑡</ci><cn type="integer" id="alg1.l10.m1.14.14.12.4.2.2.1.3.cmml" xref="alg1.l10.m1.14.14.12.4.2.2.1.3">1</cn></apply><ci id="alg1.l10.m1.13.13.11.3.1.1.cmml" xref="alg1.l10.m1.13.13.11.3.1.1">𝑗</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.14c">W_{l,b}^{t+1}\leftarrow\frac{\sum_{i=1}^{N}n_{i}\alpha_{l,b}^{t+1,i}W_{l,b}^{t+1,i}}{\sum_{j=1}^{N}n_{j}\alpha_{l,b}^{t+1,j}}</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>        <span id="alg1.l11.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l11.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>     <span id="alg1.l12.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l12.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>  <span id="alg1.l13.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l13.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>  Return <math id="alg1.l14.m1.1" class="ltx_Math" alttext="W^{T}" display="inline"><semantics id="alg1.l14.m1.1a"><msup id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mi id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">W</mi><mi id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1">superscript</csymbol><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">𝑊</ci><ci id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">W^{T}</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>  
</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>  <span id="alg1.l16.2" class="ltx_text ltx_font_bold">ClientLocalLearning</span>(<math id="alg1.l16.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l16.m1.1a"><mi id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><ci id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">i</annotation></semantics></math>, <math id="alg1.l16.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg1.l16.m2.1a"><mi id="alg1.l16.m2.1.1" xref="alg1.l16.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.l16.m2.1b"><ci id="alg1.l16.m2.1.1.cmml" xref="alg1.l16.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m2.1c">t</annotation></semantics></math>, <math id="alg1.l16.m3.1" class="ltx_Math" alttext="W^{t}" display="inline"><semantics id="alg1.l16.m3.1a"><msup id="alg1.l16.m3.1.1" xref="alg1.l16.m3.1.1.cmml"><mi id="alg1.l16.m3.1.1.2" xref="alg1.l16.m3.1.1.2.cmml">W</mi><mi id="alg1.l16.m3.1.1.3" xref="alg1.l16.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l16.m3.1b"><apply id="alg1.l16.m3.1.1.cmml" xref="alg1.l16.m3.1.1"><csymbol cd="ambiguous" id="alg1.l16.m3.1.1.1.cmml" xref="alg1.l16.m3.1.1">superscript</csymbol><ci id="alg1.l16.m3.1.1.2.cmml" xref="alg1.l16.m3.1.1.2">𝑊</ci><ci id="alg1.l16.m3.1.1.3.cmml" xref="alg1.l16.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m3.1c">W^{t}</annotation></semantics></math>):

</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>  <math id="alg1.l17.m1.2" class="ltx_Math" alttext="W^{t+1,i}\leftarrow W^{t}" display="inline"><semantics id="alg1.l17.m1.2a"><mrow id="alg1.l17.m1.2.3" xref="alg1.l17.m1.2.3.cmml"><msup id="alg1.l17.m1.2.3.2" xref="alg1.l17.m1.2.3.2.cmml"><mi id="alg1.l17.m1.2.3.2.2" xref="alg1.l17.m1.2.3.2.2.cmml">W</mi><mrow id="alg1.l17.m1.2.2.2.2" xref="alg1.l17.m1.2.2.2.3.cmml"><mrow id="alg1.l17.m1.2.2.2.2.1" xref="alg1.l17.m1.2.2.2.2.1.cmml"><mi id="alg1.l17.m1.2.2.2.2.1.2" xref="alg1.l17.m1.2.2.2.2.1.2.cmml">t</mi><mo id="alg1.l17.m1.2.2.2.2.1.1" xref="alg1.l17.m1.2.2.2.2.1.1.cmml">+</mo><mn id="alg1.l17.m1.2.2.2.2.1.3" xref="alg1.l17.m1.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="alg1.l17.m1.2.2.2.2.2" xref="alg1.l17.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l17.m1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.cmml">i</mi></mrow></msup><mo stretchy="false" id="alg1.l17.m1.2.3.1" xref="alg1.l17.m1.2.3.1.cmml">←</mo><msup id="alg1.l17.m1.2.3.3" xref="alg1.l17.m1.2.3.3.cmml"><mi id="alg1.l17.m1.2.3.3.2" xref="alg1.l17.m1.2.3.3.2.cmml">W</mi><mi id="alg1.l17.m1.2.3.3.3" xref="alg1.l17.m1.2.3.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.2b"><apply id="alg1.l17.m1.2.3.cmml" xref="alg1.l17.m1.2.3"><ci id="alg1.l17.m1.2.3.1.cmml" xref="alg1.l17.m1.2.3.1">←</ci><apply id="alg1.l17.m1.2.3.2.cmml" xref="alg1.l17.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l17.m1.2.3.2.1.cmml" xref="alg1.l17.m1.2.3.2">superscript</csymbol><ci id="alg1.l17.m1.2.3.2.2.cmml" xref="alg1.l17.m1.2.3.2.2">𝑊</ci><list id="alg1.l17.m1.2.2.2.3.cmml" xref="alg1.l17.m1.2.2.2.2"><apply id="alg1.l17.m1.2.2.2.2.1.cmml" xref="alg1.l17.m1.2.2.2.2.1"><plus id="alg1.l17.m1.2.2.2.2.1.1.cmml" xref="alg1.l17.m1.2.2.2.2.1.1"></plus><ci id="alg1.l17.m1.2.2.2.2.1.2.cmml" xref="alg1.l17.m1.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="alg1.l17.m1.2.2.2.2.1.3.cmml" xref="alg1.l17.m1.2.2.2.2.1.3">1</cn></apply><ci id="alg1.l17.m1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1">𝑖</ci></list></apply><apply id="alg1.l17.m1.2.3.3.cmml" xref="alg1.l17.m1.2.3.3"><csymbol cd="ambiguous" id="alg1.l17.m1.2.3.3.1.cmml" xref="alg1.l17.m1.2.3.3">superscript</csymbol><ci id="alg1.l17.m1.2.3.3.2.cmml" xref="alg1.l17.m1.2.3.3.2">𝑊</ci><ci id="alg1.l17.m1.2.3.3.3.cmml" xref="alg1.l17.m1.2.3.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.2c">W^{t+1,i}\leftarrow W^{t}</annotation></semantics></math>

</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span>  <math id="alg1.l18.m1.4" class="ltx_Math" alttext="\alpha^{t+1,i}\leftarrow\alpha^{t,i}" display="inline"><semantics id="alg1.l18.m1.4a"><mrow id="alg1.l18.m1.4.5" xref="alg1.l18.m1.4.5.cmml"><msup id="alg1.l18.m1.4.5.2" xref="alg1.l18.m1.4.5.2.cmml"><mi id="alg1.l18.m1.4.5.2.2" xref="alg1.l18.m1.4.5.2.2.cmml">α</mi><mrow id="alg1.l18.m1.2.2.2.2" xref="alg1.l18.m1.2.2.2.3.cmml"><mrow id="alg1.l18.m1.2.2.2.2.1" xref="alg1.l18.m1.2.2.2.2.1.cmml"><mi id="alg1.l18.m1.2.2.2.2.1.2" xref="alg1.l18.m1.2.2.2.2.1.2.cmml">t</mi><mo id="alg1.l18.m1.2.2.2.2.1.1" xref="alg1.l18.m1.2.2.2.2.1.1.cmml">+</mo><mn id="alg1.l18.m1.2.2.2.2.1.3" xref="alg1.l18.m1.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="alg1.l18.m1.2.2.2.2.2" xref="alg1.l18.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l18.m1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.cmml">i</mi></mrow></msup><mo stretchy="false" id="alg1.l18.m1.4.5.1" xref="alg1.l18.m1.4.5.1.cmml">←</mo><msup id="alg1.l18.m1.4.5.3" xref="alg1.l18.m1.4.5.3.cmml"><mi id="alg1.l18.m1.4.5.3.2" xref="alg1.l18.m1.4.5.3.2.cmml">α</mi><mrow id="alg1.l18.m1.4.4.2.4" xref="alg1.l18.m1.4.4.2.3.cmml"><mi id="alg1.l18.m1.3.3.1.1" xref="alg1.l18.m1.3.3.1.1.cmml">t</mi><mo id="alg1.l18.m1.4.4.2.4.1" xref="alg1.l18.m1.4.4.2.3.cmml">,</mo><mi id="alg1.l18.m1.4.4.2.2" xref="alg1.l18.m1.4.4.2.2.cmml">i</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.4b"><apply id="alg1.l18.m1.4.5.cmml" xref="alg1.l18.m1.4.5"><ci id="alg1.l18.m1.4.5.1.cmml" xref="alg1.l18.m1.4.5.1">←</ci><apply id="alg1.l18.m1.4.5.2.cmml" xref="alg1.l18.m1.4.5.2"><csymbol cd="ambiguous" id="alg1.l18.m1.4.5.2.1.cmml" xref="alg1.l18.m1.4.5.2">superscript</csymbol><ci id="alg1.l18.m1.4.5.2.2.cmml" xref="alg1.l18.m1.4.5.2.2">𝛼</ci><list id="alg1.l18.m1.2.2.2.3.cmml" xref="alg1.l18.m1.2.2.2.2"><apply id="alg1.l18.m1.2.2.2.2.1.cmml" xref="alg1.l18.m1.2.2.2.2.1"><plus id="alg1.l18.m1.2.2.2.2.1.1.cmml" xref="alg1.l18.m1.2.2.2.2.1.1"></plus><ci id="alg1.l18.m1.2.2.2.2.1.2.cmml" xref="alg1.l18.m1.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="alg1.l18.m1.2.2.2.2.1.3.cmml" xref="alg1.l18.m1.2.2.2.2.1.3">1</cn></apply><ci id="alg1.l18.m1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1">𝑖</ci></list></apply><apply id="alg1.l18.m1.4.5.3.cmml" xref="alg1.l18.m1.4.5.3"><csymbol cd="ambiguous" id="alg1.l18.m1.4.5.3.1.cmml" xref="alg1.l18.m1.4.5.3">superscript</csymbol><ci id="alg1.l18.m1.4.5.3.2.cmml" xref="alg1.l18.m1.4.5.3.2">𝛼</ci><list id="alg1.l18.m1.4.4.2.3.cmml" xref="alg1.l18.m1.4.4.2.4"><ci id="alg1.l18.m1.3.3.1.1.cmml" xref="alg1.l18.m1.3.3.1.1">𝑡</ci><ci id="alg1.l18.m1.4.4.2.2.cmml" xref="alg1.l18.m1.4.4.2.2">𝑖</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.4c">\alpha^{t+1,i}\leftarrow\alpha^{t,i}</annotation></semantics></math>

</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l19.1.1.1" class="ltx_text" style="font-size:80%;">19:</span></span>  Update <math id="alg1.l19.m1.2" class="ltx_Math" alttext="\alpha^{t+1,i}" display="inline"><semantics id="alg1.l19.m1.2a"><msup id="alg1.l19.m1.2.3" xref="alg1.l19.m1.2.3.cmml"><mi id="alg1.l19.m1.2.3.2" xref="alg1.l19.m1.2.3.2.cmml">α</mi><mrow id="alg1.l19.m1.2.2.2.2" xref="alg1.l19.m1.2.2.2.3.cmml"><mrow id="alg1.l19.m1.2.2.2.2.1" xref="alg1.l19.m1.2.2.2.2.1.cmml"><mi id="alg1.l19.m1.2.2.2.2.1.2" xref="alg1.l19.m1.2.2.2.2.1.2.cmml">t</mi><mo id="alg1.l19.m1.2.2.2.2.1.1" xref="alg1.l19.m1.2.2.2.2.1.1.cmml">+</mo><mn id="alg1.l19.m1.2.2.2.2.1.3" xref="alg1.l19.m1.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="alg1.l19.m1.2.2.2.2.2" xref="alg1.l19.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l19.m1.1.1.1.1" xref="alg1.l19.m1.1.1.1.1.cmml">i</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.2b"><apply id="alg1.l19.m1.2.3.cmml" xref="alg1.l19.m1.2.3"><csymbol cd="ambiguous" id="alg1.l19.m1.2.3.1.cmml" xref="alg1.l19.m1.2.3">superscript</csymbol><ci id="alg1.l19.m1.2.3.2.cmml" xref="alg1.l19.m1.2.3.2">𝛼</ci><list id="alg1.l19.m1.2.2.2.3.cmml" xref="alg1.l19.m1.2.2.2.2"><apply id="alg1.l19.m1.2.2.2.2.1.cmml" xref="alg1.l19.m1.2.2.2.2.1"><plus id="alg1.l19.m1.2.2.2.2.1.1.cmml" xref="alg1.l19.m1.2.2.2.2.1.1"></plus><ci id="alg1.l19.m1.2.2.2.2.1.2.cmml" xref="alg1.l19.m1.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="alg1.l19.m1.2.2.2.2.1.3.cmml" xref="alg1.l19.m1.2.2.2.2.1.3">1</cn></apply><ci id="alg1.l19.m1.1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1.1">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.2c">\alpha^{t+1,i}</annotation></semantics></math> for <math id="alg1.l19.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l19.m2.1a"><mi id="alg1.l19.m2.1.1" xref="alg1.l19.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l19.m2.1b"><ci id="alg1.l19.m2.1.1.cmml" xref="alg1.l19.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m2.1c">E</annotation></semantics></math> epochs via Eq. (<a href="#S4.E3" title="In IV-B Algorithm ‣ IV PROPOSED METHOD ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>)

</div>
<div id="alg1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l20.1.1.1" class="ltx_text" style="font-size:80%;">20:</span></span>  Update <math id="alg1.l20.m1.2" class="ltx_Math" alttext="W^{t+1,i}" display="inline"><semantics id="alg1.l20.m1.2a"><msup id="alg1.l20.m1.2.3" xref="alg1.l20.m1.2.3.cmml"><mi id="alg1.l20.m1.2.3.2" xref="alg1.l20.m1.2.3.2.cmml">W</mi><mrow id="alg1.l20.m1.2.2.2.2" xref="alg1.l20.m1.2.2.2.3.cmml"><mrow id="alg1.l20.m1.2.2.2.2.1" xref="alg1.l20.m1.2.2.2.2.1.cmml"><mi id="alg1.l20.m1.2.2.2.2.1.2" xref="alg1.l20.m1.2.2.2.2.1.2.cmml">t</mi><mo id="alg1.l20.m1.2.2.2.2.1.1" xref="alg1.l20.m1.2.2.2.2.1.1.cmml">+</mo><mn id="alg1.l20.m1.2.2.2.2.1.3" xref="alg1.l20.m1.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="alg1.l20.m1.2.2.2.2.2" xref="alg1.l20.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l20.m1.1.1.1.1" xref="alg1.l20.m1.1.1.1.1.cmml">i</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.2b"><apply id="alg1.l20.m1.2.3.cmml" xref="alg1.l20.m1.2.3"><csymbol cd="ambiguous" id="alg1.l20.m1.2.3.1.cmml" xref="alg1.l20.m1.2.3">superscript</csymbol><ci id="alg1.l20.m1.2.3.2.cmml" xref="alg1.l20.m1.2.3.2">𝑊</ci><list id="alg1.l20.m1.2.2.2.3.cmml" xref="alg1.l20.m1.2.2.2.2"><apply id="alg1.l20.m1.2.2.2.2.1.cmml" xref="alg1.l20.m1.2.2.2.2.1"><plus id="alg1.l20.m1.2.2.2.2.1.1.cmml" xref="alg1.l20.m1.2.2.2.2.1.1"></plus><ci id="alg1.l20.m1.2.2.2.2.1.2.cmml" xref="alg1.l20.m1.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="alg1.l20.m1.2.2.2.2.1.3.cmml" xref="alg1.l20.m1.2.2.2.2.1.3">1</cn></apply><ci id="alg1.l20.m1.1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1.1">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.2c">W^{t+1,i}</annotation></semantics></math> for <math id="alg1.l20.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l20.m2.1a"><mi id="alg1.l20.m2.1.1" xref="alg1.l20.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l20.m2.1b"><ci id="alg1.l20.m2.1.1.cmml" xref="alg1.l20.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m2.1c">E</annotation></semantics></math> epochs via Eq. (<a href="#S4.E4" title="In IV-B Algorithm ‣ IV PROPOSED METHOD ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>)

</div>
<div id="alg1.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l21.1.1.1" class="ltx_text" style="font-size:80%;">21:</span></span>  Return <math id="alg1.l21.m1.2" class="ltx_Math" alttext="W^{t+1,i}" display="inline"><semantics id="alg1.l21.m1.2a"><msup id="alg1.l21.m1.2.3" xref="alg1.l21.m1.2.3.cmml"><mi id="alg1.l21.m1.2.3.2" xref="alg1.l21.m1.2.3.2.cmml">W</mi><mrow id="alg1.l21.m1.2.2.2.2" xref="alg1.l21.m1.2.2.2.3.cmml"><mrow id="alg1.l21.m1.2.2.2.2.1" xref="alg1.l21.m1.2.2.2.2.1.cmml"><mi id="alg1.l21.m1.2.2.2.2.1.2" xref="alg1.l21.m1.2.2.2.2.1.2.cmml">t</mi><mo id="alg1.l21.m1.2.2.2.2.1.1" xref="alg1.l21.m1.2.2.2.2.1.1.cmml">+</mo><mn id="alg1.l21.m1.2.2.2.2.1.3" xref="alg1.l21.m1.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="alg1.l21.m1.2.2.2.2.2" xref="alg1.l21.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l21.m1.1.1.1.1" xref="alg1.l21.m1.1.1.1.1.cmml">i</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.2b"><apply id="alg1.l21.m1.2.3.cmml" xref="alg1.l21.m1.2.3"><csymbol cd="ambiguous" id="alg1.l21.m1.2.3.1.cmml" xref="alg1.l21.m1.2.3">superscript</csymbol><ci id="alg1.l21.m1.2.3.2.cmml" xref="alg1.l21.m1.2.3.2">𝑊</ci><list id="alg1.l21.m1.2.2.2.3.cmml" xref="alg1.l21.m1.2.2.2.2"><apply id="alg1.l21.m1.2.2.2.2.1.cmml" xref="alg1.l21.m1.2.2.2.2.1"><plus id="alg1.l21.m1.2.2.2.2.1.1.cmml" xref="alg1.l21.m1.2.2.2.2.1.1"></plus><ci id="alg1.l21.m1.2.2.2.2.1.2.cmml" xref="alg1.l21.m1.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="alg1.l21.m1.2.2.2.2.1.3.cmml" xref="alg1.l21.m1.2.2.2.2.1.3">1</cn></apply><ci id="alg1.l21.m1.1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1.1">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.2c">W^{t+1,i}</annotation></semantics></math> and <math id="alg1.l21.m2.2" class="ltx_Math" alttext="\alpha^{t+1,i}" display="inline"><semantics id="alg1.l21.m2.2a"><msup id="alg1.l21.m2.2.3" xref="alg1.l21.m2.2.3.cmml"><mi id="alg1.l21.m2.2.3.2" xref="alg1.l21.m2.2.3.2.cmml">α</mi><mrow id="alg1.l21.m2.2.2.2.2" xref="alg1.l21.m2.2.2.2.3.cmml"><mrow id="alg1.l21.m2.2.2.2.2.1" xref="alg1.l21.m2.2.2.2.2.1.cmml"><mi id="alg1.l21.m2.2.2.2.2.1.2" xref="alg1.l21.m2.2.2.2.2.1.2.cmml">t</mi><mo id="alg1.l21.m2.2.2.2.2.1.1" xref="alg1.l21.m2.2.2.2.2.1.1.cmml">+</mo><mn id="alg1.l21.m2.2.2.2.2.1.3" xref="alg1.l21.m2.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="alg1.l21.m2.2.2.2.2.2" xref="alg1.l21.m2.2.2.2.3.cmml">,</mo><mi id="alg1.l21.m2.1.1.1.1" xref="alg1.l21.m2.1.1.1.1.cmml">i</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l21.m2.2b"><apply id="alg1.l21.m2.2.3.cmml" xref="alg1.l21.m2.2.3"><csymbol cd="ambiguous" id="alg1.l21.m2.2.3.1.cmml" xref="alg1.l21.m2.2.3">superscript</csymbol><ci id="alg1.l21.m2.2.3.2.cmml" xref="alg1.l21.m2.2.3.2">𝛼</ci><list id="alg1.l21.m2.2.2.2.3.cmml" xref="alg1.l21.m2.2.2.2.2"><apply id="alg1.l21.m2.2.2.2.2.1.cmml" xref="alg1.l21.m2.2.2.2.2.1"><plus id="alg1.l21.m2.2.2.2.2.1.1.cmml" xref="alg1.l21.m2.2.2.2.2.1.1"></plus><ci id="alg1.l21.m2.2.2.2.2.1.2.cmml" xref="alg1.l21.m2.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="alg1.l21.m2.2.2.2.2.1.3.cmml" xref="alg1.l21.m2.2.2.2.2.1.3">1</cn></apply><ci id="alg1.l21.m2.1.1.1.1.cmml" xref="alg1.l21.m2.1.1.1.1">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m2.2c">\alpha^{t+1,i}</annotation></semantics></math> to server

</div>
</div>
</figure>
<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.2" class="ltx_p">We review the algorithm of pFedMB in detail. Algorithm <a href="#alg1" title="Algorithm 1 ‣ IV-B Algorithm ‣ IV PROPOSED METHOD ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the detailed algorithm of pFedMB. We denote the model parameters of each client <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><msub id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">C</mi><mi id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝐶</ci><ci id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">C_{i}</annotation></semantics></math> by <math id="S4.SS2.p1.2.m2.12" class="ltx_Math" alttext="w_{i}=(W^{i},\alpha^{i})=(\{W_{l,b}^{i}\}_{l,b},\{\alpha_{l,b}^{i}\}_{l,b})" display="inline"><semantics id="S4.SS2.p1.2.m2.12a"><mrow id="S4.SS2.p1.2.m2.12.12" xref="S4.SS2.p1.2.m2.12.12.cmml"><msub id="S4.SS2.p1.2.m2.12.12.6" xref="S4.SS2.p1.2.m2.12.12.6.cmml"><mi id="S4.SS2.p1.2.m2.12.12.6.2" xref="S4.SS2.p1.2.m2.12.12.6.2.cmml">w</mi><mi id="S4.SS2.p1.2.m2.12.12.6.3" xref="S4.SS2.p1.2.m2.12.12.6.3.cmml">i</mi></msub><mo id="S4.SS2.p1.2.m2.12.12.7" xref="S4.SS2.p1.2.m2.12.12.7.cmml">=</mo><mrow id="S4.SS2.p1.2.m2.10.10.2.2" xref="S4.SS2.p1.2.m2.10.10.2.3.cmml"><mo stretchy="false" id="S4.SS2.p1.2.m2.10.10.2.2.3" xref="S4.SS2.p1.2.m2.10.10.2.3.cmml">(</mo><msup id="S4.SS2.p1.2.m2.9.9.1.1.1" xref="S4.SS2.p1.2.m2.9.9.1.1.1.cmml"><mi id="S4.SS2.p1.2.m2.9.9.1.1.1.2" xref="S4.SS2.p1.2.m2.9.9.1.1.1.2.cmml">W</mi><mi id="S4.SS2.p1.2.m2.9.9.1.1.1.3" xref="S4.SS2.p1.2.m2.9.9.1.1.1.3.cmml">i</mi></msup><mo id="S4.SS2.p1.2.m2.10.10.2.2.4" xref="S4.SS2.p1.2.m2.10.10.2.3.cmml">,</mo><msup id="S4.SS2.p1.2.m2.10.10.2.2.2" xref="S4.SS2.p1.2.m2.10.10.2.2.2.cmml"><mi id="S4.SS2.p1.2.m2.10.10.2.2.2.2" xref="S4.SS2.p1.2.m2.10.10.2.2.2.2.cmml">α</mi><mi id="S4.SS2.p1.2.m2.10.10.2.2.2.3" xref="S4.SS2.p1.2.m2.10.10.2.2.2.3.cmml">i</mi></msup><mo stretchy="false" id="S4.SS2.p1.2.m2.10.10.2.2.5" xref="S4.SS2.p1.2.m2.10.10.2.3.cmml">)</mo></mrow><mo id="S4.SS2.p1.2.m2.12.12.8" xref="S4.SS2.p1.2.m2.12.12.8.cmml">=</mo><mrow id="S4.SS2.p1.2.m2.12.12.4.2" xref="S4.SS2.p1.2.m2.12.12.4.3.cmml"><mo stretchy="false" id="S4.SS2.p1.2.m2.12.12.4.2.3" xref="S4.SS2.p1.2.m2.12.12.4.3.cmml">(</mo><msub id="S4.SS2.p1.2.m2.11.11.3.1.1" xref="S4.SS2.p1.2.m2.11.11.3.1.1.cmml"><mrow id="S4.SS2.p1.2.m2.11.11.3.1.1.1.1" xref="S4.SS2.p1.2.m2.11.11.3.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.2.m2.11.11.3.1.1.1.1.2" xref="S4.SS2.p1.2.m2.11.11.3.1.1.1.2.cmml">{</mo><msubsup id="S4.SS2.p1.2.m2.11.11.3.1.1.1.1.1" xref="S4.SS2.p1.2.m2.11.11.3.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.2.m2.11.11.3.1.1.1.1.1.2.2" xref="S4.SS2.p1.2.m2.11.11.3.1.1.1.1.1.2.2.cmml">W</mi><mrow id="S4.SS2.p1.2.m2.2.2.2.4" xref="S4.SS2.p1.2.m2.2.2.2.3.cmml"><mi id="S4.SS2.p1.2.m2.1.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.1.cmml">l</mi><mo id="S4.SS2.p1.2.m2.2.2.2.4.1" xref="S4.SS2.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p1.2.m2.2.2.2.2" xref="S4.SS2.p1.2.m2.2.2.2.2.cmml">b</mi></mrow><mi id="S4.SS2.p1.2.m2.11.11.3.1.1.1.1.1.3" xref="S4.SS2.p1.2.m2.11.11.3.1.1.1.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="S4.SS2.p1.2.m2.11.11.3.1.1.1.1.3" xref="S4.SS2.p1.2.m2.11.11.3.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS2.p1.2.m2.4.4.2.4" xref="S4.SS2.p1.2.m2.4.4.2.3.cmml"><mi id="S4.SS2.p1.2.m2.3.3.1.1" xref="S4.SS2.p1.2.m2.3.3.1.1.cmml">l</mi><mo id="S4.SS2.p1.2.m2.4.4.2.4.1" xref="S4.SS2.p1.2.m2.4.4.2.3.cmml">,</mo><mi id="S4.SS2.p1.2.m2.4.4.2.2" xref="S4.SS2.p1.2.m2.4.4.2.2.cmml">b</mi></mrow></msub><mo id="S4.SS2.p1.2.m2.12.12.4.2.4" xref="S4.SS2.p1.2.m2.12.12.4.3.cmml">,</mo><msub id="S4.SS2.p1.2.m2.12.12.4.2.2" xref="S4.SS2.p1.2.m2.12.12.4.2.2.cmml"><mrow id="S4.SS2.p1.2.m2.12.12.4.2.2.1.1" xref="S4.SS2.p1.2.m2.12.12.4.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.2.m2.12.12.4.2.2.1.1.2" xref="S4.SS2.p1.2.m2.12.12.4.2.2.1.2.cmml">{</mo><msubsup id="S4.SS2.p1.2.m2.12.12.4.2.2.1.1.1" xref="S4.SS2.p1.2.m2.12.12.4.2.2.1.1.1.cmml"><mi id="S4.SS2.p1.2.m2.12.12.4.2.2.1.1.1.2.2" xref="S4.SS2.p1.2.m2.12.12.4.2.2.1.1.1.2.2.cmml">α</mi><mrow id="S4.SS2.p1.2.m2.6.6.2.4" xref="S4.SS2.p1.2.m2.6.6.2.3.cmml"><mi id="S4.SS2.p1.2.m2.5.5.1.1" xref="S4.SS2.p1.2.m2.5.5.1.1.cmml">l</mi><mo id="S4.SS2.p1.2.m2.6.6.2.4.1" xref="S4.SS2.p1.2.m2.6.6.2.3.cmml">,</mo><mi id="S4.SS2.p1.2.m2.6.6.2.2" xref="S4.SS2.p1.2.m2.6.6.2.2.cmml">b</mi></mrow><mi id="S4.SS2.p1.2.m2.12.12.4.2.2.1.1.1.3" xref="S4.SS2.p1.2.m2.12.12.4.2.2.1.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="S4.SS2.p1.2.m2.12.12.4.2.2.1.1.3" xref="S4.SS2.p1.2.m2.12.12.4.2.2.1.2.cmml">}</mo></mrow><mrow id="S4.SS2.p1.2.m2.8.8.2.4" xref="S4.SS2.p1.2.m2.8.8.2.3.cmml"><mi id="S4.SS2.p1.2.m2.7.7.1.1" xref="S4.SS2.p1.2.m2.7.7.1.1.cmml">l</mi><mo id="S4.SS2.p1.2.m2.8.8.2.4.1" xref="S4.SS2.p1.2.m2.8.8.2.3.cmml">,</mo><mi id="S4.SS2.p1.2.m2.8.8.2.2" xref="S4.SS2.p1.2.m2.8.8.2.2.cmml">b</mi></mrow></msub><mo stretchy="false" id="S4.SS2.p1.2.m2.12.12.4.2.5" xref="S4.SS2.p1.2.m2.12.12.4.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.12b"><apply id="S4.SS2.p1.2.m2.12.12.cmml" xref="S4.SS2.p1.2.m2.12.12"><and id="S4.SS2.p1.2.m2.12.12a.cmml" xref="S4.SS2.p1.2.m2.12.12"></and><apply id="S4.SS2.p1.2.m2.12.12b.cmml" xref="S4.SS2.p1.2.m2.12.12"><eq id="S4.SS2.p1.2.m2.12.12.7.cmml" xref="S4.SS2.p1.2.m2.12.12.7"></eq><apply id="S4.SS2.p1.2.m2.12.12.6.cmml" xref="S4.SS2.p1.2.m2.12.12.6"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.12.12.6.1.cmml" xref="S4.SS2.p1.2.m2.12.12.6">subscript</csymbol><ci id="S4.SS2.p1.2.m2.12.12.6.2.cmml" xref="S4.SS2.p1.2.m2.12.12.6.2">𝑤</ci><ci id="S4.SS2.p1.2.m2.12.12.6.3.cmml" xref="S4.SS2.p1.2.m2.12.12.6.3">𝑖</ci></apply><interval closure="open" id="S4.SS2.p1.2.m2.10.10.2.3.cmml" xref="S4.SS2.p1.2.m2.10.10.2.2"><apply id="S4.SS2.p1.2.m2.9.9.1.1.1.cmml" xref="S4.SS2.p1.2.m2.9.9.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.9.9.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.9.9.1.1.1">superscript</csymbol><ci id="S4.SS2.p1.2.m2.9.9.1.1.1.2.cmml" xref="S4.SS2.p1.2.m2.9.9.1.1.1.2">𝑊</ci><ci id="S4.SS2.p1.2.m2.9.9.1.1.1.3.cmml" xref="S4.SS2.p1.2.m2.9.9.1.1.1.3">𝑖</ci></apply><apply id="S4.SS2.p1.2.m2.10.10.2.2.2.cmml" xref="S4.SS2.p1.2.m2.10.10.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.10.10.2.2.2.1.cmml" xref="S4.SS2.p1.2.m2.10.10.2.2.2">superscript</csymbol><ci id="S4.SS2.p1.2.m2.10.10.2.2.2.2.cmml" xref="S4.SS2.p1.2.m2.10.10.2.2.2.2">𝛼</ci><ci id="S4.SS2.p1.2.m2.10.10.2.2.2.3.cmml" xref="S4.SS2.p1.2.m2.10.10.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="S4.SS2.p1.2.m2.12.12c.cmml" xref="S4.SS2.p1.2.m2.12.12"><eq id="S4.SS2.p1.2.m2.12.12.8.cmml" xref="S4.SS2.p1.2.m2.12.12.8"></eq><share href="#S4.SS2.p1.2.m2.10.10.2.cmml" id="S4.SS2.p1.2.m2.12.12d.cmml" xref="S4.SS2.p1.2.m2.12.12"></share><interval closure="open" id="S4.SS2.p1.2.m2.12.12.4.3.cmml" xref="S4.SS2.p1.2.m2.12.12.4.2"><apply id="S4.SS2.p1.2.m2.11.11.3.1.1.cmml" xref="S4.SS2.p1.2.m2.11.11.3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.11.11.3.1.1.2.cmml" xref="S4.SS2.p1.2.m2.11.11.3.1.1">subscript</csymbol><set id="S4.SS2.p1.2.m2.11.11.3.1.1.1.2.cmml" xref="S4.SS2.p1.2.m2.11.11.3.1.1.1.1"><apply id="S4.SS2.p1.2.m2.11.11.3.1.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.11.11.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.11.11.3.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.11.11.3.1.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p1.2.m2.11.11.3.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.2.m2.11.11.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.11.11.3.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.2.m2.11.11.3.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m2.11.11.3.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.2.m2.11.11.3.1.1.1.1.1.2.2">𝑊</ci><list id="S4.SS2.p1.2.m2.2.2.2.3.cmml" xref="S4.SS2.p1.2.m2.2.2.2.4"><ci id="S4.SS2.p1.2.m2.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1">𝑙</ci><ci id="S4.SS2.p1.2.m2.2.2.2.2.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2">𝑏</ci></list></apply><ci id="S4.SS2.p1.2.m2.11.11.3.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.2.m2.11.11.3.1.1.1.1.1.3">𝑖</ci></apply></set><list id="S4.SS2.p1.2.m2.4.4.2.3.cmml" xref="S4.SS2.p1.2.m2.4.4.2.4"><ci id="S4.SS2.p1.2.m2.3.3.1.1.cmml" xref="S4.SS2.p1.2.m2.3.3.1.1">𝑙</ci><ci id="S4.SS2.p1.2.m2.4.4.2.2.cmml" xref="S4.SS2.p1.2.m2.4.4.2.2">𝑏</ci></list></apply><apply id="S4.SS2.p1.2.m2.12.12.4.2.2.cmml" xref="S4.SS2.p1.2.m2.12.12.4.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.12.12.4.2.2.2.cmml" xref="S4.SS2.p1.2.m2.12.12.4.2.2">subscript</csymbol><set id="S4.SS2.p1.2.m2.12.12.4.2.2.1.2.cmml" xref="S4.SS2.p1.2.m2.12.12.4.2.2.1.1"><apply id="S4.SS2.p1.2.m2.12.12.4.2.2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.12.12.4.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.12.12.4.2.2.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.12.12.4.2.2.1.1.1">superscript</csymbol><apply id="S4.SS2.p1.2.m2.12.12.4.2.2.1.1.1.2.cmml" xref="S4.SS2.p1.2.m2.12.12.4.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.12.12.4.2.2.1.1.1.2.1.cmml" xref="S4.SS2.p1.2.m2.12.12.4.2.2.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m2.12.12.4.2.2.1.1.1.2.2.cmml" xref="S4.SS2.p1.2.m2.12.12.4.2.2.1.1.1.2.2">𝛼</ci><list id="S4.SS2.p1.2.m2.6.6.2.3.cmml" xref="S4.SS2.p1.2.m2.6.6.2.4"><ci id="S4.SS2.p1.2.m2.5.5.1.1.cmml" xref="S4.SS2.p1.2.m2.5.5.1.1">𝑙</ci><ci id="S4.SS2.p1.2.m2.6.6.2.2.cmml" xref="S4.SS2.p1.2.m2.6.6.2.2">𝑏</ci></list></apply><ci id="S4.SS2.p1.2.m2.12.12.4.2.2.1.1.1.3.cmml" xref="S4.SS2.p1.2.m2.12.12.4.2.2.1.1.1.3">𝑖</ci></apply></set><list id="S4.SS2.p1.2.m2.8.8.2.3.cmml" xref="S4.SS2.p1.2.m2.8.8.2.4"><ci id="S4.SS2.p1.2.m2.7.7.1.1.cmml" xref="S4.SS2.p1.2.m2.7.7.1.1">𝑙</ci><ci id="S4.SS2.p1.2.m2.8.8.2.2.cmml" xref="S4.SS2.p1.2.m2.8.8.2.2">𝑏</ci></list></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.12c">w_{i}=(W^{i},\alpha^{i})=(\{W_{l,b}^{i}\}_{l,b},\{\alpha_{l,b}^{i}\}_{l,b})</annotation></semantics></math> for simplicity. The algorithm is essentially based on the standard FL algorithms such as FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. That is, the server updates the global model at each communication round, and between rounds, each client trains their own model locally. However, there are some differences in server and client behavior from FedAvg, respectively. Therefore, we describe those points below.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.9" class="ltx_p">First, at each communication round <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">t</annotation></semantics></math>, the server distributes the global model parameters <math id="S4.SS2.p2.2.m2.3" class="ltx_Math" alttext="W^{t}=\{W_{l,b}^{t}\}" display="inline"><semantics id="S4.SS2.p2.2.m2.3a"><mrow id="S4.SS2.p2.2.m2.3.3" xref="S4.SS2.p2.2.m2.3.3.cmml"><msup id="S4.SS2.p2.2.m2.3.3.3" xref="S4.SS2.p2.2.m2.3.3.3.cmml"><mi id="S4.SS2.p2.2.m2.3.3.3.2" xref="S4.SS2.p2.2.m2.3.3.3.2.cmml">W</mi><mi id="S4.SS2.p2.2.m2.3.3.3.3" xref="S4.SS2.p2.2.m2.3.3.3.3.cmml">t</mi></msup><mo id="S4.SS2.p2.2.m2.3.3.2" xref="S4.SS2.p2.2.m2.3.3.2.cmml">=</mo><mrow id="S4.SS2.p2.2.m2.3.3.1.1" xref="S4.SS2.p2.2.m2.3.3.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.2.m2.3.3.1.1.2" xref="S4.SS2.p2.2.m2.3.3.1.2.cmml">{</mo><msubsup id="S4.SS2.p2.2.m2.3.3.1.1.1" xref="S4.SS2.p2.2.m2.3.3.1.1.1.cmml"><mi id="S4.SS2.p2.2.m2.3.3.1.1.1.2.2" xref="S4.SS2.p2.2.m2.3.3.1.1.1.2.2.cmml">W</mi><mrow id="S4.SS2.p2.2.m2.2.2.2.4" xref="S4.SS2.p2.2.m2.2.2.2.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.1.cmml">l</mi><mo id="S4.SS2.p2.2.m2.2.2.2.4.1" xref="S4.SS2.p2.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.2.m2.2.2.2.2" xref="S4.SS2.p2.2.m2.2.2.2.2.cmml">b</mi></mrow><mi id="S4.SS2.p2.2.m2.3.3.1.1.1.3" xref="S4.SS2.p2.2.m2.3.3.1.1.1.3.cmml">t</mi></msubsup><mo stretchy="false" id="S4.SS2.p2.2.m2.3.3.1.1.3" xref="S4.SS2.p2.2.m2.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.3b"><apply id="S4.SS2.p2.2.m2.3.3.cmml" xref="S4.SS2.p2.2.m2.3.3"><eq id="S4.SS2.p2.2.m2.3.3.2.cmml" xref="S4.SS2.p2.2.m2.3.3.2"></eq><apply id="S4.SS2.p2.2.m2.3.3.3.cmml" xref="S4.SS2.p2.2.m2.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.3.3.3.1.cmml" xref="S4.SS2.p2.2.m2.3.3.3">superscript</csymbol><ci id="S4.SS2.p2.2.m2.3.3.3.2.cmml" xref="S4.SS2.p2.2.m2.3.3.3.2">𝑊</ci><ci id="S4.SS2.p2.2.m2.3.3.3.3.cmml" xref="S4.SS2.p2.2.m2.3.3.3.3">𝑡</ci></apply><set id="S4.SS2.p2.2.m2.3.3.1.2.cmml" xref="S4.SS2.p2.2.m2.3.3.1.1"><apply id="S4.SS2.p2.2.m2.3.3.1.1.1.cmml" xref="S4.SS2.p2.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.3.3.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.3.3.1.1.1">superscript</csymbol><apply id="S4.SS2.p2.2.m2.3.3.1.1.1.2.cmml" xref="S4.SS2.p2.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.3.3.1.1.1.2.1.cmml" xref="S4.SS2.p2.2.m2.3.3.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.2.m2.3.3.1.1.1.2.2.cmml" xref="S4.SS2.p2.2.m2.3.3.1.1.1.2.2">𝑊</ci><list id="S4.SS2.p2.2.m2.2.2.2.3.cmml" xref="S4.SS2.p2.2.m2.2.2.2.4"><ci id="S4.SS2.p2.2.m2.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1">𝑙</ci><ci id="S4.SS2.p2.2.m2.2.2.2.2.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2">𝑏</ci></list></apply><ci id="S4.SS2.p2.2.m2.3.3.1.1.1.3.cmml" xref="S4.SS2.p2.2.m2.3.3.1.1.1.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.3c">W^{t}=\{W_{l,b}^{t}\}</annotation></semantics></math> to each client. Local updating phase is separated into two steps, <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mi id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><ci id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">\alpha</annotation></semantics></math> updating and <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mi id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><ci id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">W</annotation></semantics></math> updating. Each client <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><msub id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><mi id="S4.SS2.p2.5.m5.1.1.2" xref="S4.SS2.p2.5.m5.1.1.2.cmml">C</mi><mi id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2">𝐶</ci><ci id="S4.SS2.p2.5.m5.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">C_{i}</annotation></semantics></math> first updates their client-specific weights <math id="S4.SS2.p2.6.m6.2" class="ltx_Math" alttext="\alpha^{t+1,i}" display="inline"><semantics id="S4.SS2.p2.6.m6.2a"><msup id="S4.SS2.p2.6.m6.2.3" xref="S4.SS2.p2.6.m6.2.3.cmml"><mi id="S4.SS2.p2.6.m6.2.3.2" xref="S4.SS2.p2.6.m6.2.3.2.cmml">α</mi><mrow id="S4.SS2.p2.6.m6.2.2.2.2" xref="S4.SS2.p2.6.m6.2.2.2.3.cmml"><mrow id="S4.SS2.p2.6.m6.2.2.2.2.1" xref="S4.SS2.p2.6.m6.2.2.2.2.1.cmml"><mi id="S4.SS2.p2.6.m6.2.2.2.2.1.2" xref="S4.SS2.p2.6.m6.2.2.2.2.1.2.cmml">t</mi><mo id="S4.SS2.p2.6.m6.2.2.2.2.1.1" xref="S4.SS2.p2.6.m6.2.2.2.2.1.1.cmml">+</mo><mn id="S4.SS2.p2.6.m6.2.2.2.2.1.3" xref="S4.SS2.p2.6.m6.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S4.SS2.p2.6.m6.2.2.2.2.2" xref="S4.SS2.p2.6.m6.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.6.m6.1.1.1.1" xref="S4.SS2.p2.6.m6.1.1.1.1.cmml">i</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.2b"><apply id="S4.SS2.p2.6.m6.2.3.cmml" xref="S4.SS2.p2.6.m6.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.2.3.1.cmml" xref="S4.SS2.p2.6.m6.2.3">superscript</csymbol><ci id="S4.SS2.p2.6.m6.2.3.2.cmml" xref="S4.SS2.p2.6.m6.2.3.2">𝛼</ci><list id="S4.SS2.p2.6.m6.2.2.2.3.cmml" xref="S4.SS2.p2.6.m6.2.2.2.2"><apply id="S4.SS2.p2.6.m6.2.2.2.2.1.cmml" xref="S4.SS2.p2.6.m6.2.2.2.2.1"><plus id="S4.SS2.p2.6.m6.2.2.2.2.1.1.cmml" xref="S4.SS2.p2.6.m6.2.2.2.2.1.1"></plus><ci id="S4.SS2.p2.6.m6.2.2.2.2.1.2.cmml" xref="S4.SS2.p2.6.m6.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="S4.SS2.p2.6.m6.2.2.2.2.1.3.cmml" xref="S4.SS2.p2.6.m6.2.2.2.2.1.3">1</cn></apply><ci id="S4.SS2.p2.6.m6.1.1.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1.1.1">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.2c">\alpha^{t+1,i}</annotation></semantics></math> based on <math id="S4.SS2.p2.7.m7.1" class="ltx_Math" alttext="W^{t}" display="inline"><semantics id="S4.SS2.p2.7.m7.1a"><msup id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml"><mi id="S4.SS2.p2.7.m7.1.1.2" xref="S4.SS2.p2.7.m7.1.1.2.cmml">W</mi><mi id="S4.SS2.p2.7.m7.1.1.3" xref="S4.SS2.p2.7.m7.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><apply id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.7.m7.1.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1">superscript</csymbol><ci id="S4.SS2.p2.7.m7.1.1.2.cmml" xref="S4.SS2.p2.7.m7.1.1.2">𝑊</ci><ci id="S4.SS2.p2.7.m7.1.1.3.cmml" xref="S4.SS2.p2.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">W^{t}</annotation></semantics></math> for given <math id="S4.SS2.p2.8.m8.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.SS2.p2.8.m8.1a"><mi id="S4.SS2.p2.8.m8.1.1" xref="S4.SS2.p2.8.m8.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m8.1b"><ci id="S4.SS2.p2.8.m8.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m8.1c">E</annotation></semantics></math> local epochs via SGD while <math id="S4.SS2.p2.9.m9.1" class="ltx_Math" alttext="W^{t}" display="inline"><semantics id="S4.SS2.p2.9.m9.1a"><msup id="S4.SS2.p2.9.m9.1.1" xref="S4.SS2.p2.9.m9.1.1.cmml"><mi id="S4.SS2.p2.9.m9.1.1.2" xref="S4.SS2.p2.9.m9.1.1.2.cmml">W</mi><mi id="S4.SS2.p2.9.m9.1.1.3" xref="S4.SS2.p2.9.m9.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.9.m9.1b"><apply id="S4.SS2.p2.9.m9.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m9.1.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1">superscript</csymbol><ci id="S4.SS2.p2.9.m9.1.1.2.cmml" xref="S4.SS2.p2.9.m9.1.1.2">𝑊</ci><ci id="S4.SS2.p2.9.m9.1.1.3.cmml" xref="S4.SS2.p2.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.9.m9.1c">W^{t}</annotation></semantics></math> is fixed:</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.9" class="ltx_Math" alttext="\alpha^{t+1,i}\leftarrow\alpha^{t+1,i}-\eta_{\alpha}\nabla_{\alpha^{t+1,i}}f_{i}((W^{t},\alpha^{t+1,i}))," display="block"><semantics id="S4.E3.m1.9a"><mrow id="S4.E3.m1.9.9.1" xref="S4.E3.m1.9.9.1.1.cmml"><mrow id="S4.E3.m1.9.9.1.1" xref="S4.E3.m1.9.9.1.1.cmml"><msup id="S4.E3.m1.9.9.1.1.3" xref="S4.E3.m1.9.9.1.1.3.cmml"><mi id="S4.E3.m1.9.9.1.1.3.2" xref="S4.E3.m1.9.9.1.1.3.2.cmml">α</mi><mrow id="S4.E3.m1.2.2.2.2" xref="S4.E3.m1.2.2.2.3.cmml"><mrow id="S4.E3.m1.2.2.2.2.1" xref="S4.E3.m1.2.2.2.2.1.cmml"><mi id="S4.E3.m1.2.2.2.2.1.2" xref="S4.E3.m1.2.2.2.2.1.2.cmml">t</mi><mo id="S4.E3.m1.2.2.2.2.1.1" xref="S4.E3.m1.2.2.2.2.1.1.cmml">+</mo><mn id="S4.E3.m1.2.2.2.2.1.3" xref="S4.E3.m1.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S4.E3.m1.2.2.2.2.2" xref="S4.E3.m1.2.2.2.3.cmml">,</mo><mi id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml">i</mi></mrow></msup><mo stretchy="false" id="S4.E3.m1.9.9.1.1.2" xref="S4.E3.m1.9.9.1.1.2.cmml">←</mo><mrow id="S4.E3.m1.9.9.1.1.1" xref="S4.E3.m1.9.9.1.1.1.cmml"><msup id="S4.E3.m1.9.9.1.1.1.3" xref="S4.E3.m1.9.9.1.1.1.3.cmml"><mi id="S4.E3.m1.9.9.1.1.1.3.2" xref="S4.E3.m1.9.9.1.1.1.3.2.cmml">α</mi><mrow id="S4.E3.m1.4.4.2.2" xref="S4.E3.m1.4.4.2.3.cmml"><mrow id="S4.E3.m1.4.4.2.2.1" xref="S4.E3.m1.4.4.2.2.1.cmml"><mi id="S4.E3.m1.4.4.2.2.1.2" xref="S4.E3.m1.4.4.2.2.1.2.cmml">t</mi><mo id="S4.E3.m1.4.4.2.2.1.1" xref="S4.E3.m1.4.4.2.2.1.1.cmml">+</mo><mn id="S4.E3.m1.4.4.2.2.1.3" xref="S4.E3.m1.4.4.2.2.1.3.cmml">1</mn></mrow><mo id="S4.E3.m1.4.4.2.2.2" xref="S4.E3.m1.4.4.2.3.cmml">,</mo><mi id="S4.E3.m1.3.3.1.1" xref="S4.E3.m1.3.3.1.1.cmml">i</mi></mrow></msup><mo id="S4.E3.m1.9.9.1.1.1.2" xref="S4.E3.m1.9.9.1.1.1.2.cmml">−</mo><mrow id="S4.E3.m1.9.9.1.1.1.1" xref="S4.E3.m1.9.9.1.1.1.1.cmml"><msub id="S4.E3.m1.9.9.1.1.1.1.3" xref="S4.E3.m1.9.9.1.1.1.1.3.cmml"><mi id="S4.E3.m1.9.9.1.1.1.1.3.2" xref="S4.E3.m1.9.9.1.1.1.1.3.2.cmml">η</mi><mi id="S4.E3.m1.9.9.1.1.1.1.3.3" xref="S4.E3.m1.9.9.1.1.1.1.3.3.cmml">α</mi></msub><mo lspace="0.167em" rspace="0em" id="S4.E3.m1.9.9.1.1.1.1.2" xref="S4.E3.m1.9.9.1.1.1.1.2.cmml">​</mo><mrow id="S4.E3.m1.9.9.1.1.1.1.4" xref="S4.E3.m1.9.9.1.1.1.1.4.cmml"><msub id="S4.E3.m1.9.9.1.1.1.1.4.1" xref="S4.E3.m1.9.9.1.1.1.1.4.1.cmml"><mo rspace="0.167em" id="S4.E3.m1.9.9.1.1.1.1.4.1.2" xref="S4.E3.m1.9.9.1.1.1.1.4.1.2.cmml">∇</mo><msup id="S4.E3.m1.6.6.2" xref="S4.E3.m1.6.6.2.cmml"><mi id="S4.E3.m1.6.6.2.4" xref="S4.E3.m1.6.6.2.4.cmml">α</mi><mrow id="S4.E3.m1.6.6.2.2.2.2" xref="S4.E3.m1.6.6.2.2.2.3.cmml"><mrow id="S4.E3.m1.6.6.2.2.2.2.1" xref="S4.E3.m1.6.6.2.2.2.2.1.cmml"><mi id="S4.E3.m1.6.6.2.2.2.2.1.2" xref="S4.E3.m1.6.6.2.2.2.2.1.2.cmml">t</mi><mo id="S4.E3.m1.6.6.2.2.2.2.1.1" xref="S4.E3.m1.6.6.2.2.2.2.1.1.cmml">+</mo><mn id="S4.E3.m1.6.6.2.2.2.2.1.3" xref="S4.E3.m1.6.6.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S4.E3.m1.6.6.2.2.2.2.2" xref="S4.E3.m1.6.6.2.2.2.3.cmml">,</mo><mi id="S4.E3.m1.5.5.1.1.1.1" xref="S4.E3.m1.5.5.1.1.1.1.cmml">i</mi></mrow></msup></msub><msub id="S4.E3.m1.9.9.1.1.1.1.4.2" xref="S4.E3.m1.9.9.1.1.1.1.4.2.cmml"><mi id="S4.E3.m1.9.9.1.1.1.1.4.2.2" xref="S4.E3.m1.9.9.1.1.1.1.4.2.2.cmml">f</mi><mi id="S4.E3.m1.9.9.1.1.1.1.4.2.3" xref="S4.E3.m1.9.9.1.1.1.1.4.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E3.m1.9.9.1.1.1.1.2a" xref="S4.E3.m1.9.9.1.1.1.1.2.cmml">​</mo><mrow id="S4.E3.m1.9.9.1.1.1.1.1.1" xref="S4.E3.m1.9.9.1.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.9.9.1.1.1.1.1.1.2" xref="S4.E3.m1.9.9.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.9.9.1.1.1.1.1.1.1.2" xref="S4.E3.m1.9.9.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.E3.m1.9.9.1.1.1.1.1.1.1.2.3" xref="S4.E3.m1.9.9.1.1.1.1.1.1.1.3.cmml">(</mo><msup id="S4.E3.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.9.9.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.9.9.1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="S4.E3.m1.9.9.1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.9.9.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="S4.E3.m1.9.9.1.1.1.1.1.1.1.2.4" xref="S4.E3.m1.9.9.1.1.1.1.1.1.1.3.cmml">,</mo><msup id="S4.E3.m1.9.9.1.1.1.1.1.1.1.2.2" xref="S4.E3.m1.9.9.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E3.m1.9.9.1.1.1.1.1.1.1.2.2.2" xref="S4.E3.m1.9.9.1.1.1.1.1.1.1.2.2.2.cmml">α</mi><mrow id="S4.E3.m1.8.8.2.2" xref="S4.E3.m1.8.8.2.3.cmml"><mrow id="S4.E3.m1.8.8.2.2.1" xref="S4.E3.m1.8.8.2.2.1.cmml"><mi id="S4.E3.m1.8.8.2.2.1.2" xref="S4.E3.m1.8.8.2.2.1.2.cmml">t</mi><mo id="S4.E3.m1.8.8.2.2.1.1" xref="S4.E3.m1.8.8.2.2.1.1.cmml">+</mo><mn id="S4.E3.m1.8.8.2.2.1.3" xref="S4.E3.m1.8.8.2.2.1.3.cmml">1</mn></mrow><mo id="S4.E3.m1.8.8.2.2.2" xref="S4.E3.m1.8.8.2.3.cmml">,</mo><mi id="S4.E3.m1.7.7.1.1" xref="S4.E3.m1.7.7.1.1.cmml">i</mi></mrow></msup><mo stretchy="false" id="S4.E3.m1.9.9.1.1.1.1.1.1.1.2.5" xref="S4.E3.m1.9.9.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S4.E3.m1.9.9.1.1.1.1.1.1.3" xref="S4.E3.m1.9.9.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E3.m1.9.9.1.2" xref="S4.E3.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.9b"><apply id="S4.E3.m1.9.9.1.1.cmml" xref="S4.E3.m1.9.9.1"><ci id="S4.E3.m1.9.9.1.1.2.cmml" xref="S4.E3.m1.9.9.1.1.2">←</ci><apply id="S4.E3.m1.9.9.1.1.3.cmml" xref="S4.E3.m1.9.9.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.9.9.1.1.3.1.cmml" xref="S4.E3.m1.9.9.1.1.3">superscript</csymbol><ci id="S4.E3.m1.9.9.1.1.3.2.cmml" xref="S4.E3.m1.9.9.1.1.3.2">𝛼</ci><list id="S4.E3.m1.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.2"><apply id="S4.E3.m1.2.2.2.2.1.cmml" xref="S4.E3.m1.2.2.2.2.1"><plus id="S4.E3.m1.2.2.2.2.1.1.cmml" xref="S4.E3.m1.2.2.2.2.1.1"></plus><ci id="S4.E3.m1.2.2.2.2.1.2.cmml" xref="S4.E3.m1.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="S4.E3.m1.2.2.2.2.1.3.cmml" xref="S4.E3.m1.2.2.2.2.1.3">1</cn></apply><ci id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1">𝑖</ci></list></apply><apply id="S4.E3.m1.9.9.1.1.1.cmml" xref="S4.E3.m1.9.9.1.1.1"><minus id="S4.E3.m1.9.9.1.1.1.2.cmml" xref="S4.E3.m1.9.9.1.1.1.2"></minus><apply id="S4.E3.m1.9.9.1.1.1.3.cmml" xref="S4.E3.m1.9.9.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.9.9.1.1.1.3.1.cmml" xref="S4.E3.m1.9.9.1.1.1.3">superscript</csymbol><ci id="S4.E3.m1.9.9.1.1.1.3.2.cmml" xref="S4.E3.m1.9.9.1.1.1.3.2">𝛼</ci><list id="S4.E3.m1.4.4.2.3.cmml" xref="S4.E3.m1.4.4.2.2"><apply id="S4.E3.m1.4.4.2.2.1.cmml" xref="S4.E3.m1.4.4.2.2.1"><plus id="S4.E3.m1.4.4.2.2.1.1.cmml" xref="S4.E3.m1.4.4.2.2.1.1"></plus><ci id="S4.E3.m1.4.4.2.2.1.2.cmml" xref="S4.E3.m1.4.4.2.2.1.2">𝑡</ci><cn type="integer" id="S4.E3.m1.4.4.2.2.1.3.cmml" xref="S4.E3.m1.4.4.2.2.1.3">1</cn></apply><ci id="S4.E3.m1.3.3.1.1.cmml" xref="S4.E3.m1.3.3.1.1">𝑖</ci></list></apply><apply id="S4.E3.m1.9.9.1.1.1.1.cmml" xref="S4.E3.m1.9.9.1.1.1.1"><times id="S4.E3.m1.9.9.1.1.1.1.2.cmml" xref="S4.E3.m1.9.9.1.1.1.1.2"></times><apply id="S4.E3.m1.9.9.1.1.1.1.3.cmml" xref="S4.E3.m1.9.9.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.9.9.1.1.1.1.3.1.cmml" xref="S4.E3.m1.9.9.1.1.1.1.3">subscript</csymbol><ci id="S4.E3.m1.9.9.1.1.1.1.3.2.cmml" xref="S4.E3.m1.9.9.1.1.1.1.3.2">𝜂</ci><ci id="S4.E3.m1.9.9.1.1.1.1.3.3.cmml" xref="S4.E3.m1.9.9.1.1.1.1.3.3">𝛼</ci></apply><apply id="S4.E3.m1.9.9.1.1.1.1.4.cmml" xref="S4.E3.m1.9.9.1.1.1.1.4"><apply id="S4.E3.m1.9.9.1.1.1.1.4.1.cmml" xref="S4.E3.m1.9.9.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S4.E3.m1.9.9.1.1.1.1.4.1.1.cmml" xref="S4.E3.m1.9.9.1.1.1.1.4.1">subscript</csymbol><ci id="S4.E3.m1.9.9.1.1.1.1.4.1.2.cmml" xref="S4.E3.m1.9.9.1.1.1.1.4.1.2">∇</ci><apply id="S4.E3.m1.6.6.2.cmml" xref="S4.E3.m1.6.6.2"><csymbol cd="ambiguous" id="S4.E3.m1.6.6.2.3.cmml" xref="S4.E3.m1.6.6.2">superscript</csymbol><ci id="S4.E3.m1.6.6.2.4.cmml" xref="S4.E3.m1.6.6.2.4">𝛼</ci><list id="S4.E3.m1.6.6.2.2.2.3.cmml" xref="S4.E3.m1.6.6.2.2.2.2"><apply id="S4.E3.m1.6.6.2.2.2.2.1.cmml" xref="S4.E3.m1.6.6.2.2.2.2.1"><plus id="S4.E3.m1.6.6.2.2.2.2.1.1.cmml" xref="S4.E3.m1.6.6.2.2.2.2.1.1"></plus><ci id="S4.E3.m1.6.6.2.2.2.2.1.2.cmml" xref="S4.E3.m1.6.6.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="S4.E3.m1.6.6.2.2.2.2.1.3.cmml" xref="S4.E3.m1.6.6.2.2.2.2.1.3">1</cn></apply><ci id="S4.E3.m1.5.5.1.1.1.1.cmml" xref="S4.E3.m1.5.5.1.1.1.1">𝑖</ci></list></apply></apply><apply id="S4.E3.m1.9.9.1.1.1.1.4.2.cmml" xref="S4.E3.m1.9.9.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S4.E3.m1.9.9.1.1.1.1.4.2.1.cmml" xref="S4.E3.m1.9.9.1.1.1.1.4.2">subscript</csymbol><ci id="S4.E3.m1.9.9.1.1.1.1.4.2.2.cmml" xref="S4.E3.m1.9.9.1.1.1.1.4.2.2">𝑓</ci><ci id="S4.E3.m1.9.9.1.1.1.1.4.2.3.cmml" xref="S4.E3.m1.9.9.1.1.1.1.4.2.3">𝑖</ci></apply></apply><interval closure="open" id="S4.E3.m1.9.9.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.9.9.1.1.1.1.1.1.1.2"><apply id="S4.E3.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.9.9.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.9.9.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E3.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.9.9.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="S4.E3.m1.9.9.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.9.9.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.E3.m1.9.9.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.9.9.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.9.9.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E3.m1.9.9.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S4.E3.m1.9.9.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E3.m1.9.9.1.1.1.1.1.1.1.2.2.2">𝛼</ci><list id="S4.E3.m1.8.8.2.3.cmml" xref="S4.E3.m1.8.8.2.2"><apply id="S4.E3.m1.8.8.2.2.1.cmml" xref="S4.E3.m1.8.8.2.2.1"><plus id="S4.E3.m1.8.8.2.2.1.1.cmml" xref="S4.E3.m1.8.8.2.2.1.1"></plus><ci id="S4.E3.m1.8.8.2.2.1.2.cmml" xref="S4.E3.m1.8.8.2.2.1.2">𝑡</ci><cn type="integer" id="S4.E3.m1.8.8.2.2.1.3.cmml" xref="S4.E3.m1.8.8.2.2.1.3">1</cn></apply><ci id="S4.E3.m1.7.7.1.1.cmml" xref="S4.E3.m1.7.7.1.1">𝑖</ci></list></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.9c">\alpha^{t+1,i}\leftarrow\alpha^{t+1,i}-\eta_{\alpha}\nabla_{\alpha^{t+1,i}}f_{i}((W^{t},\alpha^{t+1,i})),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p2.17" class="ltx_p">where <math id="S4.SS2.p2.10.m1.1" class="ltx_Math" alttext="\eta_{\alpha}" display="inline"><semantics id="S4.SS2.p2.10.m1.1a"><msub id="S4.SS2.p2.10.m1.1.1" xref="S4.SS2.p2.10.m1.1.1.cmml"><mi id="S4.SS2.p2.10.m1.1.1.2" xref="S4.SS2.p2.10.m1.1.1.2.cmml">η</mi><mi id="S4.SS2.p2.10.m1.1.1.3" xref="S4.SS2.p2.10.m1.1.1.3.cmml">α</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.10.m1.1b"><apply id="S4.SS2.p2.10.m1.1.1.cmml" xref="S4.SS2.p2.10.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.10.m1.1.1.1.cmml" xref="S4.SS2.p2.10.m1.1.1">subscript</csymbol><ci id="S4.SS2.p2.10.m1.1.1.2.cmml" xref="S4.SS2.p2.10.m1.1.1.2">𝜂</ci><ci id="S4.SS2.p2.10.m1.1.1.3.cmml" xref="S4.SS2.p2.10.m1.1.1.3">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.10.m1.1c">\eta_{\alpha}</annotation></semantics></math> is the learning rate. Updating <math id="S4.SS2.p2.11.m2.2" class="ltx_Math" alttext="\alpha^{t+1,i}" display="inline"><semantics id="S4.SS2.p2.11.m2.2a"><msup id="S4.SS2.p2.11.m2.2.3" xref="S4.SS2.p2.11.m2.2.3.cmml"><mi id="S4.SS2.p2.11.m2.2.3.2" xref="S4.SS2.p2.11.m2.2.3.2.cmml">α</mi><mrow id="S4.SS2.p2.11.m2.2.2.2.2" xref="S4.SS2.p2.11.m2.2.2.2.3.cmml"><mrow id="S4.SS2.p2.11.m2.2.2.2.2.1" xref="S4.SS2.p2.11.m2.2.2.2.2.1.cmml"><mi id="S4.SS2.p2.11.m2.2.2.2.2.1.2" xref="S4.SS2.p2.11.m2.2.2.2.2.1.2.cmml">t</mi><mo id="S4.SS2.p2.11.m2.2.2.2.2.1.1" xref="S4.SS2.p2.11.m2.2.2.2.2.1.1.cmml">+</mo><mn id="S4.SS2.p2.11.m2.2.2.2.2.1.3" xref="S4.SS2.p2.11.m2.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S4.SS2.p2.11.m2.2.2.2.2.2" xref="S4.SS2.p2.11.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.11.m2.1.1.1.1" xref="S4.SS2.p2.11.m2.1.1.1.1.cmml">i</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.11.m2.2b"><apply id="S4.SS2.p2.11.m2.2.3.cmml" xref="S4.SS2.p2.11.m2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.11.m2.2.3.1.cmml" xref="S4.SS2.p2.11.m2.2.3">superscript</csymbol><ci id="S4.SS2.p2.11.m2.2.3.2.cmml" xref="S4.SS2.p2.11.m2.2.3.2">𝛼</ci><list id="S4.SS2.p2.11.m2.2.2.2.3.cmml" xref="S4.SS2.p2.11.m2.2.2.2.2"><apply id="S4.SS2.p2.11.m2.2.2.2.2.1.cmml" xref="S4.SS2.p2.11.m2.2.2.2.2.1"><plus id="S4.SS2.p2.11.m2.2.2.2.2.1.1.cmml" xref="S4.SS2.p2.11.m2.2.2.2.2.1.1"></plus><ci id="S4.SS2.p2.11.m2.2.2.2.2.1.2.cmml" xref="S4.SS2.p2.11.m2.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="S4.SS2.p2.11.m2.2.2.2.2.1.3.cmml" xref="S4.SS2.p2.11.m2.2.2.2.2.1.3">1</cn></apply><ci id="S4.SS2.p2.11.m2.1.1.1.1.cmml" xref="S4.SS2.p2.11.m2.1.1.1.1">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.11.m2.2c">\alpha^{t+1,i}</annotation></semantics></math> allows each client <math id="S4.SS2.p2.12.m3.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S4.SS2.p2.12.m3.1a"><msub id="S4.SS2.p2.12.m3.1.1" xref="S4.SS2.p2.12.m3.1.1.cmml"><mi id="S4.SS2.p2.12.m3.1.1.2" xref="S4.SS2.p2.12.m3.1.1.2.cmml">C</mi><mi id="S4.SS2.p2.12.m3.1.1.3" xref="S4.SS2.p2.12.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.12.m3.1b"><apply id="S4.SS2.p2.12.m3.1.1.cmml" xref="S4.SS2.p2.12.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.12.m3.1.1.1.cmml" xref="S4.SS2.p2.12.m3.1.1">subscript</csymbol><ci id="S4.SS2.p2.12.m3.1.1.2.cmml" xref="S4.SS2.p2.12.m3.1.1.2">𝐶</ci><ci id="S4.SS2.p2.12.m3.1.1.3.cmml" xref="S4.SS2.p2.12.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.12.m3.1c">C_{i}</annotation></semantics></math> to obtain the optimal ratio for the branches suitable for their own distribution.
Next, client <math id="S4.SS2.p2.13.m4.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S4.SS2.p2.13.m4.1a"><msub id="S4.SS2.p2.13.m4.1.1" xref="S4.SS2.p2.13.m4.1.1.cmml"><mi id="S4.SS2.p2.13.m4.1.1.2" xref="S4.SS2.p2.13.m4.1.1.2.cmml">C</mi><mi id="S4.SS2.p2.13.m4.1.1.3" xref="S4.SS2.p2.13.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.13.m4.1b"><apply id="S4.SS2.p2.13.m4.1.1.cmml" xref="S4.SS2.p2.13.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.13.m4.1.1.1.cmml" xref="S4.SS2.p2.13.m4.1.1">subscript</csymbol><ci id="S4.SS2.p2.13.m4.1.1.2.cmml" xref="S4.SS2.p2.13.m4.1.1.2">𝐶</ci><ci id="S4.SS2.p2.13.m4.1.1.3.cmml" xref="S4.SS2.p2.13.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.13.m4.1c">C_{i}</annotation></semantics></math> fixes <math id="S4.SS2.p2.14.m5.2" class="ltx_Math" alttext="\alpha^{t+1,i}" display="inline"><semantics id="S4.SS2.p2.14.m5.2a"><msup id="S4.SS2.p2.14.m5.2.3" xref="S4.SS2.p2.14.m5.2.3.cmml"><mi id="S4.SS2.p2.14.m5.2.3.2" xref="S4.SS2.p2.14.m5.2.3.2.cmml">α</mi><mrow id="S4.SS2.p2.14.m5.2.2.2.2" xref="S4.SS2.p2.14.m5.2.2.2.3.cmml"><mrow id="S4.SS2.p2.14.m5.2.2.2.2.1" xref="S4.SS2.p2.14.m5.2.2.2.2.1.cmml"><mi id="S4.SS2.p2.14.m5.2.2.2.2.1.2" xref="S4.SS2.p2.14.m5.2.2.2.2.1.2.cmml">t</mi><mo id="S4.SS2.p2.14.m5.2.2.2.2.1.1" xref="S4.SS2.p2.14.m5.2.2.2.2.1.1.cmml">+</mo><mn id="S4.SS2.p2.14.m5.2.2.2.2.1.3" xref="S4.SS2.p2.14.m5.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S4.SS2.p2.14.m5.2.2.2.2.2" xref="S4.SS2.p2.14.m5.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.14.m5.1.1.1.1" xref="S4.SS2.p2.14.m5.1.1.1.1.cmml">i</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.14.m5.2b"><apply id="S4.SS2.p2.14.m5.2.3.cmml" xref="S4.SS2.p2.14.m5.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.14.m5.2.3.1.cmml" xref="S4.SS2.p2.14.m5.2.3">superscript</csymbol><ci id="S4.SS2.p2.14.m5.2.3.2.cmml" xref="S4.SS2.p2.14.m5.2.3.2">𝛼</ci><list id="S4.SS2.p2.14.m5.2.2.2.3.cmml" xref="S4.SS2.p2.14.m5.2.2.2.2"><apply id="S4.SS2.p2.14.m5.2.2.2.2.1.cmml" xref="S4.SS2.p2.14.m5.2.2.2.2.1"><plus id="S4.SS2.p2.14.m5.2.2.2.2.1.1.cmml" xref="S4.SS2.p2.14.m5.2.2.2.2.1.1"></plus><ci id="S4.SS2.p2.14.m5.2.2.2.2.1.2.cmml" xref="S4.SS2.p2.14.m5.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="S4.SS2.p2.14.m5.2.2.2.2.1.3.cmml" xref="S4.SS2.p2.14.m5.2.2.2.2.1.3">1</cn></apply><ci id="S4.SS2.p2.14.m5.1.1.1.1.cmml" xref="S4.SS2.p2.14.m5.1.1.1.1">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.14.m5.2c">\alpha^{t+1,i}</annotation></semantics></math> and updates <math id="S4.SS2.p2.15.m6.1" class="ltx_Math" alttext="W^{t}" display="inline"><semantics id="S4.SS2.p2.15.m6.1a"><msup id="S4.SS2.p2.15.m6.1.1" xref="S4.SS2.p2.15.m6.1.1.cmml"><mi id="S4.SS2.p2.15.m6.1.1.2" xref="S4.SS2.p2.15.m6.1.1.2.cmml">W</mi><mi id="S4.SS2.p2.15.m6.1.1.3" xref="S4.SS2.p2.15.m6.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.15.m6.1b"><apply id="S4.SS2.p2.15.m6.1.1.cmml" xref="S4.SS2.p2.15.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.15.m6.1.1.1.cmml" xref="S4.SS2.p2.15.m6.1.1">superscript</csymbol><ci id="S4.SS2.p2.15.m6.1.1.2.cmml" xref="S4.SS2.p2.15.m6.1.1.2">𝑊</ci><ci id="S4.SS2.p2.15.m6.1.1.3.cmml" xref="S4.SS2.p2.15.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.15.m6.1c">W^{t}</annotation></semantics></math> <span id="S4.SS2.p2.16.1" class="ltx_text" style="color:#000000;">for <math id="S4.SS2.p2.16.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.SS2.p2.16.1.m1.1a"><mi mathcolor="#000000" id="S4.SS2.p2.16.1.m1.1.1" xref="S4.SS2.p2.16.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.16.1.m1.1b"><ci id="S4.SS2.p2.16.1.m1.1.1.cmml" xref="S4.SS2.p2.16.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.16.1.m1.1c">E</annotation></semantics></math> local epochs</span> to get the local version of the global model <math id="S4.SS2.p2.17.m7.2" class="ltx_Math" alttext="W^{t+1,i}" display="inline"><semantics id="S4.SS2.p2.17.m7.2a"><msup id="S4.SS2.p2.17.m7.2.3" xref="S4.SS2.p2.17.m7.2.3.cmml"><mi id="S4.SS2.p2.17.m7.2.3.2" xref="S4.SS2.p2.17.m7.2.3.2.cmml">W</mi><mrow id="S4.SS2.p2.17.m7.2.2.2.2" xref="S4.SS2.p2.17.m7.2.2.2.3.cmml"><mrow id="S4.SS2.p2.17.m7.2.2.2.2.1" xref="S4.SS2.p2.17.m7.2.2.2.2.1.cmml"><mi id="S4.SS2.p2.17.m7.2.2.2.2.1.2" xref="S4.SS2.p2.17.m7.2.2.2.2.1.2.cmml">t</mi><mo id="S4.SS2.p2.17.m7.2.2.2.2.1.1" xref="S4.SS2.p2.17.m7.2.2.2.2.1.1.cmml">+</mo><mn id="S4.SS2.p2.17.m7.2.2.2.2.1.3" xref="S4.SS2.p2.17.m7.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S4.SS2.p2.17.m7.2.2.2.2.2" xref="S4.SS2.p2.17.m7.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.17.m7.1.1.1.1" xref="S4.SS2.p2.17.m7.1.1.1.1.cmml">i</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.17.m7.2b"><apply id="S4.SS2.p2.17.m7.2.3.cmml" xref="S4.SS2.p2.17.m7.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.17.m7.2.3.1.cmml" xref="S4.SS2.p2.17.m7.2.3">superscript</csymbol><ci id="S4.SS2.p2.17.m7.2.3.2.cmml" xref="S4.SS2.p2.17.m7.2.3.2">𝑊</ci><list id="S4.SS2.p2.17.m7.2.2.2.3.cmml" xref="S4.SS2.p2.17.m7.2.2.2.2"><apply id="S4.SS2.p2.17.m7.2.2.2.2.1.cmml" xref="S4.SS2.p2.17.m7.2.2.2.2.1"><plus id="S4.SS2.p2.17.m7.2.2.2.2.1.1.cmml" xref="S4.SS2.p2.17.m7.2.2.2.2.1.1"></plus><ci id="S4.SS2.p2.17.m7.2.2.2.2.1.2.cmml" xref="S4.SS2.p2.17.m7.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="S4.SS2.p2.17.m7.2.2.2.2.1.3.cmml" xref="S4.SS2.p2.17.m7.2.2.2.2.1.3">1</cn></apply><ci id="S4.SS2.p2.17.m7.1.1.1.1.cmml" xref="S4.SS2.p2.17.m7.1.1.1.1">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.17.m7.2c">W^{t+1,i}</annotation></semantics></math>:</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.11" class="ltx_Math" alttext="W^{t+1,i}\leftarrow W^{t+1,i}-\eta_{W}\nabla_{W^{t+1,i}}f_{i}((W^{t+1,i},\alpha^{t+1,i}))." display="block"><semantics id="S4.E4.m1.11a"><mrow id="S4.E4.m1.11.11.1" xref="S4.E4.m1.11.11.1.1.cmml"><mrow id="S4.E4.m1.11.11.1.1" xref="S4.E4.m1.11.11.1.1.cmml"><msup id="S4.E4.m1.11.11.1.1.3" xref="S4.E4.m1.11.11.1.1.3.cmml"><mi id="S4.E4.m1.11.11.1.1.3.2" xref="S4.E4.m1.11.11.1.1.3.2.cmml">W</mi><mrow id="S4.E4.m1.2.2.2.2" xref="S4.E4.m1.2.2.2.3.cmml"><mrow id="S4.E4.m1.2.2.2.2.1" xref="S4.E4.m1.2.2.2.2.1.cmml"><mi id="S4.E4.m1.2.2.2.2.1.2" xref="S4.E4.m1.2.2.2.2.1.2.cmml">t</mi><mo id="S4.E4.m1.2.2.2.2.1.1" xref="S4.E4.m1.2.2.2.2.1.1.cmml">+</mo><mn id="S4.E4.m1.2.2.2.2.1.3" xref="S4.E4.m1.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S4.E4.m1.2.2.2.2.2" xref="S4.E4.m1.2.2.2.3.cmml">,</mo><mi id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml">i</mi></mrow></msup><mo stretchy="false" id="S4.E4.m1.11.11.1.1.2" xref="S4.E4.m1.11.11.1.1.2.cmml">←</mo><mrow id="S4.E4.m1.11.11.1.1.1" xref="S4.E4.m1.11.11.1.1.1.cmml"><msup id="S4.E4.m1.11.11.1.1.1.3" xref="S4.E4.m1.11.11.1.1.1.3.cmml"><mi id="S4.E4.m1.11.11.1.1.1.3.2" xref="S4.E4.m1.11.11.1.1.1.3.2.cmml">W</mi><mrow id="S4.E4.m1.4.4.2.2" xref="S4.E4.m1.4.4.2.3.cmml"><mrow id="S4.E4.m1.4.4.2.2.1" xref="S4.E4.m1.4.4.2.2.1.cmml"><mi id="S4.E4.m1.4.4.2.2.1.2" xref="S4.E4.m1.4.4.2.2.1.2.cmml">t</mi><mo id="S4.E4.m1.4.4.2.2.1.1" xref="S4.E4.m1.4.4.2.2.1.1.cmml">+</mo><mn id="S4.E4.m1.4.4.2.2.1.3" xref="S4.E4.m1.4.4.2.2.1.3.cmml">1</mn></mrow><mo id="S4.E4.m1.4.4.2.2.2" xref="S4.E4.m1.4.4.2.3.cmml">,</mo><mi id="S4.E4.m1.3.3.1.1" xref="S4.E4.m1.3.3.1.1.cmml">i</mi></mrow></msup><mo id="S4.E4.m1.11.11.1.1.1.2" xref="S4.E4.m1.11.11.1.1.1.2.cmml">−</mo><mrow id="S4.E4.m1.11.11.1.1.1.1" xref="S4.E4.m1.11.11.1.1.1.1.cmml"><msub id="S4.E4.m1.11.11.1.1.1.1.3" xref="S4.E4.m1.11.11.1.1.1.1.3.cmml"><mi id="S4.E4.m1.11.11.1.1.1.1.3.2" xref="S4.E4.m1.11.11.1.1.1.1.3.2.cmml">η</mi><mi id="S4.E4.m1.11.11.1.1.1.1.3.3" xref="S4.E4.m1.11.11.1.1.1.1.3.3.cmml">W</mi></msub><mo lspace="0.167em" rspace="0em" id="S4.E4.m1.11.11.1.1.1.1.2" xref="S4.E4.m1.11.11.1.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.11.11.1.1.1.1.4" xref="S4.E4.m1.11.11.1.1.1.1.4.cmml"><msub id="S4.E4.m1.11.11.1.1.1.1.4.1" xref="S4.E4.m1.11.11.1.1.1.1.4.1.cmml"><mo rspace="0.167em" id="S4.E4.m1.11.11.1.1.1.1.4.1.2" xref="S4.E4.m1.11.11.1.1.1.1.4.1.2.cmml">∇</mo><msup id="S4.E4.m1.6.6.2" xref="S4.E4.m1.6.6.2.cmml"><mi id="S4.E4.m1.6.6.2.4" xref="S4.E4.m1.6.6.2.4.cmml">W</mi><mrow id="S4.E4.m1.6.6.2.2.2.2" xref="S4.E4.m1.6.6.2.2.2.3.cmml"><mrow id="S4.E4.m1.6.6.2.2.2.2.1" xref="S4.E4.m1.6.6.2.2.2.2.1.cmml"><mi id="S4.E4.m1.6.6.2.2.2.2.1.2" xref="S4.E4.m1.6.6.2.2.2.2.1.2.cmml">t</mi><mo id="S4.E4.m1.6.6.2.2.2.2.1.1" xref="S4.E4.m1.6.6.2.2.2.2.1.1.cmml">+</mo><mn id="S4.E4.m1.6.6.2.2.2.2.1.3" xref="S4.E4.m1.6.6.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S4.E4.m1.6.6.2.2.2.2.2" xref="S4.E4.m1.6.6.2.2.2.3.cmml">,</mo><mi id="S4.E4.m1.5.5.1.1.1.1" xref="S4.E4.m1.5.5.1.1.1.1.cmml">i</mi></mrow></msup></msub><msub id="S4.E4.m1.11.11.1.1.1.1.4.2" xref="S4.E4.m1.11.11.1.1.1.1.4.2.cmml"><mi id="S4.E4.m1.11.11.1.1.1.1.4.2.2" xref="S4.E4.m1.11.11.1.1.1.1.4.2.2.cmml">f</mi><mi id="S4.E4.m1.11.11.1.1.1.1.4.2.3" xref="S4.E4.m1.11.11.1.1.1.1.4.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E4.m1.11.11.1.1.1.1.2a" xref="S4.E4.m1.11.11.1.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.11.11.1.1.1.1.1.1" xref="S4.E4.m1.11.11.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.11.11.1.1.1.1.1.1.2" xref="S4.E4.m1.11.11.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.11.11.1.1.1.1.1.1.1.2" xref="S4.E4.m1.11.11.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.E4.m1.11.11.1.1.1.1.1.1.1.2.3" xref="S4.E4.m1.11.11.1.1.1.1.1.1.1.3.cmml">(</mo><msup id="S4.E4.m1.11.11.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.11.11.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.11.11.1.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.11.11.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mrow id="S4.E4.m1.8.8.2.2" xref="S4.E4.m1.8.8.2.3.cmml"><mrow id="S4.E4.m1.8.8.2.2.1" xref="S4.E4.m1.8.8.2.2.1.cmml"><mi id="S4.E4.m1.8.8.2.2.1.2" xref="S4.E4.m1.8.8.2.2.1.2.cmml">t</mi><mo id="S4.E4.m1.8.8.2.2.1.1" xref="S4.E4.m1.8.8.2.2.1.1.cmml">+</mo><mn id="S4.E4.m1.8.8.2.2.1.3" xref="S4.E4.m1.8.8.2.2.1.3.cmml">1</mn></mrow><mo id="S4.E4.m1.8.8.2.2.2" xref="S4.E4.m1.8.8.2.3.cmml">,</mo><mi id="S4.E4.m1.7.7.1.1" xref="S4.E4.m1.7.7.1.1.cmml">i</mi></mrow></msup><mo id="S4.E4.m1.11.11.1.1.1.1.1.1.1.2.4" xref="S4.E4.m1.11.11.1.1.1.1.1.1.1.3.cmml">,</mo><msup id="S4.E4.m1.11.11.1.1.1.1.1.1.1.2.2" xref="S4.E4.m1.11.11.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E4.m1.11.11.1.1.1.1.1.1.1.2.2.2" xref="S4.E4.m1.11.11.1.1.1.1.1.1.1.2.2.2.cmml">α</mi><mrow id="S4.E4.m1.10.10.2.2" xref="S4.E4.m1.10.10.2.3.cmml"><mrow id="S4.E4.m1.10.10.2.2.1" xref="S4.E4.m1.10.10.2.2.1.cmml"><mi id="S4.E4.m1.10.10.2.2.1.2" xref="S4.E4.m1.10.10.2.2.1.2.cmml">t</mi><mo id="S4.E4.m1.10.10.2.2.1.1" xref="S4.E4.m1.10.10.2.2.1.1.cmml">+</mo><mn id="S4.E4.m1.10.10.2.2.1.3" xref="S4.E4.m1.10.10.2.2.1.3.cmml">1</mn></mrow><mo id="S4.E4.m1.10.10.2.2.2" xref="S4.E4.m1.10.10.2.3.cmml">,</mo><mi id="S4.E4.m1.9.9.1.1" xref="S4.E4.m1.9.9.1.1.cmml">i</mi></mrow></msup><mo stretchy="false" id="S4.E4.m1.11.11.1.1.1.1.1.1.1.2.5" xref="S4.E4.m1.11.11.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S4.E4.m1.11.11.1.1.1.1.1.1.3" xref="S4.E4.m1.11.11.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S4.E4.m1.11.11.1.2" xref="S4.E4.m1.11.11.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.11b"><apply id="S4.E4.m1.11.11.1.1.cmml" xref="S4.E4.m1.11.11.1"><ci id="S4.E4.m1.11.11.1.1.2.cmml" xref="S4.E4.m1.11.11.1.1.2">←</ci><apply id="S4.E4.m1.11.11.1.1.3.cmml" xref="S4.E4.m1.11.11.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.11.11.1.1.3.1.cmml" xref="S4.E4.m1.11.11.1.1.3">superscript</csymbol><ci id="S4.E4.m1.11.11.1.1.3.2.cmml" xref="S4.E4.m1.11.11.1.1.3.2">𝑊</ci><list id="S4.E4.m1.2.2.2.3.cmml" xref="S4.E4.m1.2.2.2.2"><apply id="S4.E4.m1.2.2.2.2.1.cmml" xref="S4.E4.m1.2.2.2.2.1"><plus id="S4.E4.m1.2.2.2.2.1.1.cmml" xref="S4.E4.m1.2.2.2.2.1.1"></plus><ci id="S4.E4.m1.2.2.2.2.1.2.cmml" xref="S4.E4.m1.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="S4.E4.m1.2.2.2.2.1.3.cmml" xref="S4.E4.m1.2.2.2.2.1.3">1</cn></apply><ci id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1">𝑖</ci></list></apply><apply id="S4.E4.m1.11.11.1.1.1.cmml" xref="S4.E4.m1.11.11.1.1.1"><minus id="S4.E4.m1.11.11.1.1.1.2.cmml" xref="S4.E4.m1.11.11.1.1.1.2"></minus><apply id="S4.E4.m1.11.11.1.1.1.3.cmml" xref="S4.E4.m1.11.11.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.11.11.1.1.1.3.1.cmml" xref="S4.E4.m1.11.11.1.1.1.3">superscript</csymbol><ci id="S4.E4.m1.11.11.1.1.1.3.2.cmml" xref="S4.E4.m1.11.11.1.1.1.3.2">𝑊</ci><list id="S4.E4.m1.4.4.2.3.cmml" xref="S4.E4.m1.4.4.2.2"><apply id="S4.E4.m1.4.4.2.2.1.cmml" xref="S4.E4.m1.4.4.2.2.1"><plus id="S4.E4.m1.4.4.2.2.1.1.cmml" xref="S4.E4.m1.4.4.2.2.1.1"></plus><ci id="S4.E4.m1.4.4.2.2.1.2.cmml" xref="S4.E4.m1.4.4.2.2.1.2">𝑡</ci><cn type="integer" id="S4.E4.m1.4.4.2.2.1.3.cmml" xref="S4.E4.m1.4.4.2.2.1.3">1</cn></apply><ci id="S4.E4.m1.3.3.1.1.cmml" xref="S4.E4.m1.3.3.1.1">𝑖</ci></list></apply><apply id="S4.E4.m1.11.11.1.1.1.1.cmml" xref="S4.E4.m1.11.11.1.1.1.1"><times id="S4.E4.m1.11.11.1.1.1.1.2.cmml" xref="S4.E4.m1.11.11.1.1.1.1.2"></times><apply id="S4.E4.m1.11.11.1.1.1.1.3.cmml" xref="S4.E4.m1.11.11.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.11.11.1.1.1.1.3.1.cmml" xref="S4.E4.m1.11.11.1.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.11.11.1.1.1.1.3.2.cmml" xref="S4.E4.m1.11.11.1.1.1.1.3.2">𝜂</ci><ci id="S4.E4.m1.11.11.1.1.1.1.3.3.cmml" xref="S4.E4.m1.11.11.1.1.1.1.3.3">𝑊</ci></apply><apply id="S4.E4.m1.11.11.1.1.1.1.4.cmml" xref="S4.E4.m1.11.11.1.1.1.1.4"><apply id="S4.E4.m1.11.11.1.1.1.1.4.1.cmml" xref="S4.E4.m1.11.11.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S4.E4.m1.11.11.1.1.1.1.4.1.1.cmml" xref="S4.E4.m1.11.11.1.1.1.1.4.1">subscript</csymbol><ci id="S4.E4.m1.11.11.1.1.1.1.4.1.2.cmml" xref="S4.E4.m1.11.11.1.1.1.1.4.1.2">∇</ci><apply id="S4.E4.m1.6.6.2.cmml" xref="S4.E4.m1.6.6.2"><csymbol cd="ambiguous" id="S4.E4.m1.6.6.2.3.cmml" xref="S4.E4.m1.6.6.2">superscript</csymbol><ci id="S4.E4.m1.6.6.2.4.cmml" xref="S4.E4.m1.6.6.2.4">𝑊</ci><list id="S4.E4.m1.6.6.2.2.2.3.cmml" xref="S4.E4.m1.6.6.2.2.2.2"><apply id="S4.E4.m1.6.6.2.2.2.2.1.cmml" xref="S4.E4.m1.6.6.2.2.2.2.1"><plus id="S4.E4.m1.6.6.2.2.2.2.1.1.cmml" xref="S4.E4.m1.6.6.2.2.2.2.1.1"></plus><ci id="S4.E4.m1.6.6.2.2.2.2.1.2.cmml" xref="S4.E4.m1.6.6.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="S4.E4.m1.6.6.2.2.2.2.1.3.cmml" xref="S4.E4.m1.6.6.2.2.2.2.1.3">1</cn></apply><ci id="S4.E4.m1.5.5.1.1.1.1.cmml" xref="S4.E4.m1.5.5.1.1.1.1">𝑖</ci></list></apply></apply><apply id="S4.E4.m1.11.11.1.1.1.1.4.2.cmml" xref="S4.E4.m1.11.11.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S4.E4.m1.11.11.1.1.1.1.4.2.1.cmml" xref="S4.E4.m1.11.11.1.1.1.1.4.2">subscript</csymbol><ci id="S4.E4.m1.11.11.1.1.1.1.4.2.2.cmml" xref="S4.E4.m1.11.11.1.1.1.1.4.2.2">𝑓</ci><ci id="S4.E4.m1.11.11.1.1.1.1.4.2.3.cmml" xref="S4.E4.m1.11.11.1.1.1.1.4.2.3">𝑖</ci></apply></apply><interval closure="open" id="S4.E4.m1.11.11.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.11.11.1.1.1.1.1.1.1.2"><apply id="S4.E4.m1.11.11.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.11.11.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.11.11.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.11.11.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E4.m1.11.11.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.11.11.1.1.1.1.1.1.1.1.1.2">𝑊</ci><list id="S4.E4.m1.8.8.2.3.cmml" xref="S4.E4.m1.8.8.2.2"><apply id="S4.E4.m1.8.8.2.2.1.cmml" xref="S4.E4.m1.8.8.2.2.1"><plus id="S4.E4.m1.8.8.2.2.1.1.cmml" xref="S4.E4.m1.8.8.2.2.1.1"></plus><ci id="S4.E4.m1.8.8.2.2.1.2.cmml" xref="S4.E4.m1.8.8.2.2.1.2">𝑡</ci><cn type="integer" id="S4.E4.m1.8.8.2.2.1.3.cmml" xref="S4.E4.m1.8.8.2.2.1.3">1</cn></apply><ci id="S4.E4.m1.7.7.1.1.cmml" xref="S4.E4.m1.7.7.1.1">𝑖</ci></list></apply><apply id="S4.E4.m1.11.11.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.11.11.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.11.11.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E4.m1.11.11.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S4.E4.m1.11.11.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E4.m1.11.11.1.1.1.1.1.1.1.2.2.2">𝛼</ci><list id="S4.E4.m1.10.10.2.3.cmml" xref="S4.E4.m1.10.10.2.2"><apply id="S4.E4.m1.10.10.2.2.1.cmml" xref="S4.E4.m1.10.10.2.2.1"><plus id="S4.E4.m1.10.10.2.2.1.1.cmml" xref="S4.E4.m1.10.10.2.2.1.1"></plus><ci id="S4.E4.m1.10.10.2.2.1.2.cmml" xref="S4.E4.m1.10.10.2.2.1.2">𝑡</ci><cn type="integer" id="S4.E4.m1.10.10.2.2.1.3.cmml" xref="S4.E4.m1.10.10.2.2.1.3">1</cn></apply><ci id="S4.E4.m1.9.9.1.1.cmml" xref="S4.E4.m1.9.9.1.1">𝑖</ci></list></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.11c">W^{t+1,i}\leftarrow W^{t+1,i}-\eta_{W}\nabla_{W^{t+1,i}}f_{i}((W^{t+1,i},\alpha^{t+1,i})).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p2.20" class="ltx_p">Finally, each client sends model parameters <math id="S4.SS2.p2.18.m1.6" class="ltx_Math" alttext="(\alpha^{t+1,i},W^{t+1,i})" display="inline"><semantics id="S4.SS2.p2.18.m1.6a"><mrow id="S4.SS2.p2.18.m1.6.6.2" xref="S4.SS2.p2.18.m1.6.6.3.cmml"><mo stretchy="false" id="S4.SS2.p2.18.m1.6.6.2.3" xref="S4.SS2.p2.18.m1.6.6.3.cmml">(</mo><msup id="S4.SS2.p2.18.m1.5.5.1.1" xref="S4.SS2.p2.18.m1.5.5.1.1.cmml"><mi id="S4.SS2.p2.18.m1.5.5.1.1.2" xref="S4.SS2.p2.18.m1.5.5.1.1.2.cmml">α</mi><mrow id="S4.SS2.p2.18.m1.2.2.2.2" xref="S4.SS2.p2.18.m1.2.2.2.3.cmml"><mrow id="S4.SS2.p2.18.m1.2.2.2.2.1" xref="S4.SS2.p2.18.m1.2.2.2.2.1.cmml"><mi id="S4.SS2.p2.18.m1.2.2.2.2.1.2" xref="S4.SS2.p2.18.m1.2.2.2.2.1.2.cmml">t</mi><mo id="S4.SS2.p2.18.m1.2.2.2.2.1.1" xref="S4.SS2.p2.18.m1.2.2.2.2.1.1.cmml">+</mo><mn id="S4.SS2.p2.18.m1.2.2.2.2.1.3" xref="S4.SS2.p2.18.m1.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S4.SS2.p2.18.m1.2.2.2.2.2" xref="S4.SS2.p2.18.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.18.m1.1.1.1.1" xref="S4.SS2.p2.18.m1.1.1.1.1.cmml">i</mi></mrow></msup><mo id="S4.SS2.p2.18.m1.6.6.2.4" xref="S4.SS2.p2.18.m1.6.6.3.cmml">,</mo><msup id="S4.SS2.p2.18.m1.6.6.2.2" xref="S4.SS2.p2.18.m1.6.6.2.2.cmml"><mi id="S4.SS2.p2.18.m1.6.6.2.2.2" xref="S4.SS2.p2.18.m1.6.6.2.2.2.cmml">W</mi><mrow id="S4.SS2.p2.18.m1.4.4.2.2" xref="S4.SS2.p2.18.m1.4.4.2.3.cmml"><mrow id="S4.SS2.p2.18.m1.4.4.2.2.1" xref="S4.SS2.p2.18.m1.4.4.2.2.1.cmml"><mi id="S4.SS2.p2.18.m1.4.4.2.2.1.2" xref="S4.SS2.p2.18.m1.4.4.2.2.1.2.cmml">t</mi><mo id="S4.SS2.p2.18.m1.4.4.2.2.1.1" xref="S4.SS2.p2.18.m1.4.4.2.2.1.1.cmml">+</mo><mn id="S4.SS2.p2.18.m1.4.4.2.2.1.3" xref="S4.SS2.p2.18.m1.4.4.2.2.1.3.cmml">1</mn></mrow><mo id="S4.SS2.p2.18.m1.4.4.2.2.2" xref="S4.SS2.p2.18.m1.4.4.2.3.cmml">,</mo><mi id="S4.SS2.p2.18.m1.3.3.1.1" xref="S4.SS2.p2.18.m1.3.3.1.1.cmml">i</mi></mrow></msup><mo stretchy="false" id="S4.SS2.p2.18.m1.6.6.2.5" xref="S4.SS2.p2.18.m1.6.6.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.18.m1.6b"><interval closure="open" id="S4.SS2.p2.18.m1.6.6.3.cmml" xref="S4.SS2.p2.18.m1.6.6.2"><apply id="S4.SS2.p2.18.m1.5.5.1.1.cmml" xref="S4.SS2.p2.18.m1.5.5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.18.m1.5.5.1.1.1.cmml" xref="S4.SS2.p2.18.m1.5.5.1.1">superscript</csymbol><ci id="S4.SS2.p2.18.m1.5.5.1.1.2.cmml" xref="S4.SS2.p2.18.m1.5.5.1.1.2">𝛼</ci><list id="S4.SS2.p2.18.m1.2.2.2.3.cmml" xref="S4.SS2.p2.18.m1.2.2.2.2"><apply id="S4.SS2.p2.18.m1.2.2.2.2.1.cmml" xref="S4.SS2.p2.18.m1.2.2.2.2.1"><plus id="S4.SS2.p2.18.m1.2.2.2.2.1.1.cmml" xref="S4.SS2.p2.18.m1.2.2.2.2.1.1"></plus><ci id="S4.SS2.p2.18.m1.2.2.2.2.1.2.cmml" xref="S4.SS2.p2.18.m1.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="S4.SS2.p2.18.m1.2.2.2.2.1.3.cmml" xref="S4.SS2.p2.18.m1.2.2.2.2.1.3">1</cn></apply><ci id="S4.SS2.p2.18.m1.1.1.1.1.cmml" xref="S4.SS2.p2.18.m1.1.1.1.1">𝑖</ci></list></apply><apply id="S4.SS2.p2.18.m1.6.6.2.2.cmml" xref="S4.SS2.p2.18.m1.6.6.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.18.m1.6.6.2.2.1.cmml" xref="S4.SS2.p2.18.m1.6.6.2.2">superscript</csymbol><ci id="S4.SS2.p2.18.m1.6.6.2.2.2.cmml" xref="S4.SS2.p2.18.m1.6.6.2.2.2">𝑊</ci><list id="S4.SS2.p2.18.m1.4.4.2.3.cmml" xref="S4.SS2.p2.18.m1.4.4.2.2"><apply id="S4.SS2.p2.18.m1.4.4.2.2.1.cmml" xref="S4.SS2.p2.18.m1.4.4.2.2.1"><plus id="S4.SS2.p2.18.m1.4.4.2.2.1.1.cmml" xref="S4.SS2.p2.18.m1.4.4.2.2.1.1"></plus><ci id="S4.SS2.p2.18.m1.4.4.2.2.1.2.cmml" xref="S4.SS2.p2.18.m1.4.4.2.2.1.2">𝑡</ci><cn type="integer" id="S4.SS2.p2.18.m1.4.4.2.2.1.3.cmml" xref="S4.SS2.p2.18.m1.4.4.2.2.1.3">1</cn></apply><ci id="S4.SS2.p2.18.m1.3.3.1.1.cmml" xref="S4.SS2.p2.18.m1.3.3.1.1">𝑖</ci></list></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.18.m1.6c">(\alpha^{t+1,i},W^{t+1,i})</annotation></semantics></math> to the server and the server aggregates them to obtain a new global model parameters <math id="S4.SS2.p2.19.m2.5" class="ltx_Math" alttext="W^{t+1}=\{W_{l,b}^{t+1}\}_{l,b}" display="inline"><semantics id="S4.SS2.p2.19.m2.5a"><mrow id="S4.SS2.p2.19.m2.5.5" xref="S4.SS2.p2.19.m2.5.5.cmml"><msup id="S4.SS2.p2.19.m2.5.5.3" xref="S4.SS2.p2.19.m2.5.5.3.cmml"><mi id="S4.SS2.p2.19.m2.5.5.3.2" xref="S4.SS2.p2.19.m2.5.5.3.2.cmml">W</mi><mrow id="S4.SS2.p2.19.m2.5.5.3.3" xref="S4.SS2.p2.19.m2.5.5.3.3.cmml"><mi id="S4.SS2.p2.19.m2.5.5.3.3.2" xref="S4.SS2.p2.19.m2.5.5.3.3.2.cmml">t</mi><mo id="S4.SS2.p2.19.m2.5.5.3.3.1" xref="S4.SS2.p2.19.m2.5.5.3.3.1.cmml">+</mo><mn id="S4.SS2.p2.19.m2.5.5.3.3.3" xref="S4.SS2.p2.19.m2.5.5.3.3.3.cmml">1</mn></mrow></msup><mo id="S4.SS2.p2.19.m2.5.5.2" xref="S4.SS2.p2.19.m2.5.5.2.cmml">=</mo><msub id="S4.SS2.p2.19.m2.5.5.1" xref="S4.SS2.p2.19.m2.5.5.1.cmml"><mrow id="S4.SS2.p2.19.m2.5.5.1.1.1" xref="S4.SS2.p2.19.m2.5.5.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.19.m2.5.5.1.1.1.2" xref="S4.SS2.p2.19.m2.5.5.1.1.2.cmml">{</mo><msubsup id="S4.SS2.p2.19.m2.5.5.1.1.1.1" xref="S4.SS2.p2.19.m2.5.5.1.1.1.1.cmml"><mi id="S4.SS2.p2.19.m2.5.5.1.1.1.1.2.2" xref="S4.SS2.p2.19.m2.5.5.1.1.1.1.2.2.cmml">W</mi><mrow id="S4.SS2.p2.19.m2.2.2.2.4" xref="S4.SS2.p2.19.m2.2.2.2.3.cmml"><mi id="S4.SS2.p2.19.m2.1.1.1.1" xref="S4.SS2.p2.19.m2.1.1.1.1.cmml">l</mi><mo id="S4.SS2.p2.19.m2.2.2.2.4.1" xref="S4.SS2.p2.19.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.19.m2.2.2.2.2" xref="S4.SS2.p2.19.m2.2.2.2.2.cmml">b</mi></mrow><mrow id="S4.SS2.p2.19.m2.5.5.1.1.1.1.3" xref="S4.SS2.p2.19.m2.5.5.1.1.1.1.3.cmml"><mi id="S4.SS2.p2.19.m2.5.5.1.1.1.1.3.2" xref="S4.SS2.p2.19.m2.5.5.1.1.1.1.3.2.cmml">t</mi><mo id="S4.SS2.p2.19.m2.5.5.1.1.1.1.3.1" xref="S4.SS2.p2.19.m2.5.5.1.1.1.1.3.1.cmml">+</mo><mn id="S4.SS2.p2.19.m2.5.5.1.1.1.1.3.3" xref="S4.SS2.p2.19.m2.5.5.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="S4.SS2.p2.19.m2.5.5.1.1.1.3" xref="S4.SS2.p2.19.m2.5.5.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS2.p2.19.m2.4.4.2.4" xref="S4.SS2.p2.19.m2.4.4.2.3.cmml"><mi id="S4.SS2.p2.19.m2.3.3.1.1" xref="S4.SS2.p2.19.m2.3.3.1.1.cmml">l</mi><mo id="S4.SS2.p2.19.m2.4.4.2.4.1" xref="S4.SS2.p2.19.m2.4.4.2.3.cmml">,</mo><mi id="S4.SS2.p2.19.m2.4.4.2.2" xref="S4.SS2.p2.19.m2.4.4.2.2.cmml">b</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.19.m2.5b"><apply id="S4.SS2.p2.19.m2.5.5.cmml" xref="S4.SS2.p2.19.m2.5.5"><eq id="S4.SS2.p2.19.m2.5.5.2.cmml" xref="S4.SS2.p2.19.m2.5.5.2"></eq><apply id="S4.SS2.p2.19.m2.5.5.3.cmml" xref="S4.SS2.p2.19.m2.5.5.3"><csymbol cd="ambiguous" id="S4.SS2.p2.19.m2.5.5.3.1.cmml" xref="S4.SS2.p2.19.m2.5.5.3">superscript</csymbol><ci id="S4.SS2.p2.19.m2.5.5.3.2.cmml" xref="S4.SS2.p2.19.m2.5.5.3.2">𝑊</ci><apply id="S4.SS2.p2.19.m2.5.5.3.3.cmml" xref="S4.SS2.p2.19.m2.5.5.3.3"><plus id="S4.SS2.p2.19.m2.5.5.3.3.1.cmml" xref="S4.SS2.p2.19.m2.5.5.3.3.1"></plus><ci id="S4.SS2.p2.19.m2.5.5.3.3.2.cmml" xref="S4.SS2.p2.19.m2.5.5.3.3.2">𝑡</ci><cn type="integer" id="S4.SS2.p2.19.m2.5.5.3.3.3.cmml" xref="S4.SS2.p2.19.m2.5.5.3.3.3">1</cn></apply></apply><apply id="S4.SS2.p2.19.m2.5.5.1.cmml" xref="S4.SS2.p2.19.m2.5.5.1"><csymbol cd="ambiguous" id="S4.SS2.p2.19.m2.5.5.1.2.cmml" xref="S4.SS2.p2.19.m2.5.5.1">subscript</csymbol><set id="S4.SS2.p2.19.m2.5.5.1.1.2.cmml" xref="S4.SS2.p2.19.m2.5.5.1.1.1"><apply id="S4.SS2.p2.19.m2.5.5.1.1.1.1.cmml" xref="S4.SS2.p2.19.m2.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.19.m2.5.5.1.1.1.1.1.cmml" xref="S4.SS2.p2.19.m2.5.5.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p2.19.m2.5.5.1.1.1.1.2.cmml" xref="S4.SS2.p2.19.m2.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.19.m2.5.5.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.19.m2.5.5.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.19.m2.5.5.1.1.1.1.2.2.cmml" xref="S4.SS2.p2.19.m2.5.5.1.1.1.1.2.2">𝑊</ci><list id="S4.SS2.p2.19.m2.2.2.2.3.cmml" xref="S4.SS2.p2.19.m2.2.2.2.4"><ci id="S4.SS2.p2.19.m2.1.1.1.1.cmml" xref="S4.SS2.p2.19.m2.1.1.1.1">𝑙</ci><ci id="S4.SS2.p2.19.m2.2.2.2.2.cmml" xref="S4.SS2.p2.19.m2.2.2.2.2">𝑏</ci></list></apply><apply id="S4.SS2.p2.19.m2.5.5.1.1.1.1.3.cmml" xref="S4.SS2.p2.19.m2.5.5.1.1.1.1.3"><plus id="S4.SS2.p2.19.m2.5.5.1.1.1.1.3.1.cmml" xref="S4.SS2.p2.19.m2.5.5.1.1.1.1.3.1"></plus><ci id="S4.SS2.p2.19.m2.5.5.1.1.1.1.3.2.cmml" xref="S4.SS2.p2.19.m2.5.5.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S4.SS2.p2.19.m2.5.5.1.1.1.1.3.3.cmml" xref="S4.SS2.p2.19.m2.5.5.1.1.1.1.3.3">1</cn></apply></apply></set><list id="S4.SS2.p2.19.m2.4.4.2.3.cmml" xref="S4.SS2.p2.19.m2.4.4.2.4"><ci id="S4.SS2.p2.19.m2.3.3.1.1.cmml" xref="S4.SS2.p2.19.m2.3.3.1.1">𝑙</ci><ci id="S4.SS2.p2.19.m2.4.4.2.2.cmml" xref="S4.SS2.p2.19.m2.4.4.2.2">𝑏</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.19.m2.5c">W^{t+1}=\{W_{l,b}^{t+1}\}_{l,b}</annotation></semantics></math>. In this global model updating phase, we design an <math id="S4.SS2.p2.20.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS2.p2.20.m3.1a"><mi id="S4.SS2.p2.20.m3.1.1" xref="S4.SS2.p2.20.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.20.m3.1b"><ci id="S4.SS2.p2.20.m3.1.1.cmml" xref="S4.SS2.p2.20.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.20.m3.1c">\alpha</annotation></semantics></math>-weighted aggregation method through the equation</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.15" class="ltx_Math" alttext="W_{l,b}^{t+1}=\frac{\sum_{i=1}^{N}n_{i}\alpha_{l,b}^{t+1,i}W_{l,b}^{t+1,i}}{\sum_{j=1}^{N}n_{j}\alpha_{l,b}^{t+1,j}}." display="block"><semantics id="S4.E5.m1.15a"><mrow id="S4.E5.m1.15.15.1" xref="S4.E5.m1.15.15.1.1.cmml"><mrow id="S4.E5.m1.15.15.1.1" xref="S4.E5.m1.15.15.1.1.cmml"><msubsup id="S4.E5.m1.15.15.1.1.2" xref="S4.E5.m1.15.15.1.1.2.cmml"><mi id="S4.E5.m1.15.15.1.1.2.2.2" xref="S4.E5.m1.15.15.1.1.2.2.2.cmml">W</mi><mrow id="S4.E5.m1.2.2.2.4" xref="S4.E5.m1.2.2.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml">l</mi><mo id="S4.E5.m1.2.2.2.4.1" xref="S4.E5.m1.2.2.2.3.cmml">,</mo><mi id="S4.E5.m1.2.2.2.2" xref="S4.E5.m1.2.2.2.2.cmml">b</mi></mrow><mrow id="S4.E5.m1.15.15.1.1.2.3" xref="S4.E5.m1.15.15.1.1.2.3.cmml"><mi id="S4.E5.m1.15.15.1.1.2.3.2" xref="S4.E5.m1.15.15.1.1.2.3.2.cmml">t</mi><mo id="S4.E5.m1.15.15.1.1.2.3.1" xref="S4.E5.m1.15.15.1.1.2.3.1.cmml">+</mo><mn id="S4.E5.m1.15.15.1.1.2.3.3" xref="S4.E5.m1.15.15.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S4.E5.m1.15.15.1.1.1" xref="S4.E5.m1.15.15.1.1.1.cmml">=</mo><mfrac id="S4.E5.m1.14.14" xref="S4.E5.m1.14.14.cmml"><mrow id="S4.E5.m1.10.10.8" xref="S4.E5.m1.10.10.8.cmml"><msubsup id="S4.E5.m1.10.10.8.9" xref="S4.E5.m1.10.10.8.9.cmml"><mo id="S4.E5.m1.10.10.8.9.2.2" xref="S4.E5.m1.10.10.8.9.2.2.cmml">∑</mo><mrow id="S4.E5.m1.10.10.8.9.2.3" xref="S4.E5.m1.10.10.8.9.2.3.cmml"><mi id="S4.E5.m1.10.10.8.9.2.3.2" xref="S4.E5.m1.10.10.8.9.2.3.2.cmml">i</mi><mo id="S4.E5.m1.10.10.8.9.2.3.1" xref="S4.E5.m1.10.10.8.9.2.3.1.cmml">=</mo><mn id="S4.E5.m1.10.10.8.9.2.3.3" xref="S4.E5.m1.10.10.8.9.2.3.3.cmml">1</mn></mrow><mi id="S4.E5.m1.10.10.8.9.3" xref="S4.E5.m1.10.10.8.9.3.cmml">N</mi></msubsup><mrow id="S4.E5.m1.10.10.8.10" xref="S4.E5.m1.10.10.8.10.cmml"><msub id="S4.E5.m1.10.10.8.10.2" xref="S4.E5.m1.10.10.8.10.2.cmml"><mi id="S4.E5.m1.10.10.8.10.2.2" xref="S4.E5.m1.10.10.8.10.2.2.cmml">n</mi><mi id="S4.E5.m1.10.10.8.10.2.3" xref="S4.E5.m1.10.10.8.10.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.10.10.8.10.1" xref="S4.E5.m1.10.10.8.10.1.cmml">​</mo><msubsup id="S4.E5.m1.10.10.8.10.3" xref="S4.E5.m1.10.10.8.10.3.cmml"><mi id="S4.E5.m1.10.10.8.10.3.2.2" xref="S4.E5.m1.10.10.8.10.3.2.2.cmml">α</mi><mrow id="S4.E5.m1.4.4.2.2.2.4" xref="S4.E5.m1.4.4.2.2.2.3.cmml"><mi id="S4.E5.m1.3.3.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.cmml">l</mi><mo id="S4.E5.m1.4.4.2.2.2.4.1" xref="S4.E5.m1.4.4.2.2.2.3.cmml">,</mo><mi id="S4.E5.m1.4.4.2.2.2.2" xref="S4.E5.m1.4.4.2.2.2.2.cmml">b</mi></mrow><mrow id="S4.E5.m1.6.6.4.4.2.2" xref="S4.E5.m1.6.6.4.4.2.3.cmml"><mrow id="S4.E5.m1.6.6.4.4.2.2.1" xref="S4.E5.m1.6.6.4.4.2.2.1.cmml"><mi id="S4.E5.m1.6.6.4.4.2.2.1.2" xref="S4.E5.m1.6.6.4.4.2.2.1.2.cmml">t</mi><mo id="S4.E5.m1.6.6.4.4.2.2.1.1" xref="S4.E5.m1.6.6.4.4.2.2.1.1.cmml">+</mo><mn id="S4.E5.m1.6.6.4.4.2.2.1.3" xref="S4.E5.m1.6.6.4.4.2.2.1.3.cmml">1</mn></mrow><mo id="S4.E5.m1.6.6.4.4.2.2.2" xref="S4.E5.m1.6.6.4.4.2.3.cmml">,</mo><mi id="S4.E5.m1.5.5.3.3.1.1" xref="S4.E5.m1.5.5.3.3.1.1.cmml">i</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.E5.m1.10.10.8.10.1a" xref="S4.E5.m1.10.10.8.10.1.cmml">​</mo><msubsup id="S4.E5.m1.10.10.8.10.4" xref="S4.E5.m1.10.10.8.10.4.cmml"><mi id="S4.E5.m1.10.10.8.10.4.2.2" xref="S4.E5.m1.10.10.8.10.4.2.2.cmml">W</mi><mrow id="S4.E5.m1.8.8.6.6.2.4" xref="S4.E5.m1.8.8.6.6.2.3.cmml"><mi id="S4.E5.m1.7.7.5.5.1.1" xref="S4.E5.m1.7.7.5.5.1.1.cmml">l</mi><mo id="S4.E5.m1.8.8.6.6.2.4.1" xref="S4.E5.m1.8.8.6.6.2.3.cmml">,</mo><mi id="S4.E5.m1.8.8.6.6.2.2" xref="S4.E5.m1.8.8.6.6.2.2.cmml">b</mi></mrow><mrow id="S4.E5.m1.10.10.8.8.2.2" xref="S4.E5.m1.10.10.8.8.2.3.cmml"><mrow id="S4.E5.m1.10.10.8.8.2.2.1" xref="S4.E5.m1.10.10.8.8.2.2.1.cmml"><mi id="S4.E5.m1.10.10.8.8.2.2.1.2" xref="S4.E5.m1.10.10.8.8.2.2.1.2.cmml">t</mi><mo id="S4.E5.m1.10.10.8.8.2.2.1.1" xref="S4.E5.m1.10.10.8.8.2.2.1.1.cmml">+</mo><mn id="S4.E5.m1.10.10.8.8.2.2.1.3" xref="S4.E5.m1.10.10.8.8.2.2.1.3.cmml">1</mn></mrow><mo id="S4.E5.m1.10.10.8.8.2.2.2" xref="S4.E5.m1.10.10.8.8.2.3.cmml">,</mo><mi id="S4.E5.m1.9.9.7.7.1.1" xref="S4.E5.m1.9.9.7.7.1.1.cmml">i</mi></mrow></msubsup></mrow></mrow><mrow id="S4.E5.m1.14.14.12" xref="S4.E5.m1.14.14.12.cmml"><msubsup id="S4.E5.m1.14.14.12.5" xref="S4.E5.m1.14.14.12.5.cmml"><mo id="S4.E5.m1.14.14.12.5.2.2" xref="S4.E5.m1.14.14.12.5.2.2.cmml">∑</mo><mrow id="S4.E5.m1.14.14.12.5.2.3" xref="S4.E5.m1.14.14.12.5.2.3.cmml"><mi id="S4.E5.m1.14.14.12.5.2.3.2" xref="S4.E5.m1.14.14.12.5.2.3.2.cmml">j</mi><mo id="S4.E5.m1.14.14.12.5.2.3.1" xref="S4.E5.m1.14.14.12.5.2.3.1.cmml">=</mo><mn id="S4.E5.m1.14.14.12.5.2.3.3" xref="S4.E5.m1.14.14.12.5.2.3.3.cmml">1</mn></mrow><mi id="S4.E5.m1.14.14.12.5.3" xref="S4.E5.m1.14.14.12.5.3.cmml">N</mi></msubsup><mrow id="S4.E5.m1.14.14.12.6" xref="S4.E5.m1.14.14.12.6.cmml"><msub id="S4.E5.m1.14.14.12.6.2" xref="S4.E5.m1.14.14.12.6.2.cmml"><mi id="S4.E5.m1.14.14.12.6.2.2" xref="S4.E5.m1.14.14.12.6.2.2.cmml">n</mi><mi id="S4.E5.m1.14.14.12.6.2.3" xref="S4.E5.m1.14.14.12.6.2.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.14.14.12.6.1" xref="S4.E5.m1.14.14.12.6.1.cmml">​</mo><msubsup id="S4.E5.m1.14.14.12.6.3" xref="S4.E5.m1.14.14.12.6.3.cmml"><mi id="S4.E5.m1.14.14.12.6.3.2.2" xref="S4.E5.m1.14.14.12.6.3.2.2.cmml">α</mi><mrow id="S4.E5.m1.12.12.10.2.2.4" xref="S4.E5.m1.12.12.10.2.2.3.cmml"><mi id="S4.E5.m1.11.11.9.1.1.1" xref="S4.E5.m1.11.11.9.1.1.1.cmml">l</mi><mo id="S4.E5.m1.12.12.10.2.2.4.1" xref="S4.E5.m1.12.12.10.2.2.3.cmml">,</mo><mi id="S4.E5.m1.12.12.10.2.2.2" xref="S4.E5.m1.12.12.10.2.2.2.cmml">b</mi></mrow><mrow id="S4.E5.m1.14.14.12.4.2.2" xref="S4.E5.m1.14.14.12.4.2.3.cmml"><mrow id="S4.E5.m1.14.14.12.4.2.2.1" xref="S4.E5.m1.14.14.12.4.2.2.1.cmml"><mi id="S4.E5.m1.14.14.12.4.2.2.1.2" xref="S4.E5.m1.14.14.12.4.2.2.1.2.cmml">t</mi><mo id="S4.E5.m1.14.14.12.4.2.2.1.1" xref="S4.E5.m1.14.14.12.4.2.2.1.1.cmml">+</mo><mn id="S4.E5.m1.14.14.12.4.2.2.1.3" xref="S4.E5.m1.14.14.12.4.2.2.1.3.cmml">1</mn></mrow><mo id="S4.E5.m1.14.14.12.4.2.2.2" xref="S4.E5.m1.14.14.12.4.2.3.cmml">,</mo><mi id="S4.E5.m1.13.13.11.3.1.1" xref="S4.E5.m1.13.13.11.3.1.1.cmml">j</mi></mrow></msubsup></mrow></mrow></mfrac></mrow><mo lspace="0em" id="S4.E5.m1.15.15.1.2" xref="S4.E5.m1.15.15.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.15b"><apply id="S4.E5.m1.15.15.1.1.cmml" xref="S4.E5.m1.15.15.1"><eq id="S4.E5.m1.15.15.1.1.1.cmml" xref="S4.E5.m1.15.15.1.1.1"></eq><apply id="S4.E5.m1.15.15.1.1.2.cmml" xref="S4.E5.m1.15.15.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.15.15.1.1.2.1.cmml" xref="S4.E5.m1.15.15.1.1.2">superscript</csymbol><apply id="S4.E5.m1.15.15.1.1.2.2.cmml" xref="S4.E5.m1.15.15.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.15.15.1.1.2.2.1.cmml" xref="S4.E5.m1.15.15.1.1.2">subscript</csymbol><ci id="S4.E5.m1.15.15.1.1.2.2.2.cmml" xref="S4.E5.m1.15.15.1.1.2.2.2">𝑊</ci><list id="S4.E5.m1.2.2.2.3.cmml" xref="S4.E5.m1.2.2.2.4"><ci id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1">𝑙</ci><ci id="S4.E5.m1.2.2.2.2.cmml" xref="S4.E5.m1.2.2.2.2">𝑏</ci></list></apply><apply id="S4.E5.m1.15.15.1.1.2.3.cmml" xref="S4.E5.m1.15.15.1.1.2.3"><plus id="S4.E5.m1.15.15.1.1.2.3.1.cmml" xref="S4.E5.m1.15.15.1.1.2.3.1"></plus><ci id="S4.E5.m1.15.15.1.1.2.3.2.cmml" xref="S4.E5.m1.15.15.1.1.2.3.2">𝑡</ci><cn type="integer" id="S4.E5.m1.15.15.1.1.2.3.3.cmml" xref="S4.E5.m1.15.15.1.1.2.3.3">1</cn></apply></apply><apply id="S4.E5.m1.14.14.cmml" xref="S4.E5.m1.14.14"><divide id="S4.E5.m1.14.14.13.cmml" xref="S4.E5.m1.14.14"></divide><apply id="S4.E5.m1.10.10.8.cmml" xref="S4.E5.m1.10.10.8"><apply id="S4.E5.m1.10.10.8.9.cmml" xref="S4.E5.m1.10.10.8.9"><csymbol cd="ambiguous" id="S4.E5.m1.10.10.8.9.1.cmml" xref="S4.E5.m1.10.10.8.9">superscript</csymbol><apply id="S4.E5.m1.10.10.8.9.2.cmml" xref="S4.E5.m1.10.10.8.9"><csymbol cd="ambiguous" id="S4.E5.m1.10.10.8.9.2.1.cmml" xref="S4.E5.m1.10.10.8.9">subscript</csymbol><sum id="S4.E5.m1.10.10.8.9.2.2.cmml" xref="S4.E5.m1.10.10.8.9.2.2"></sum><apply id="S4.E5.m1.10.10.8.9.2.3.cmml" xref="S4.E5.m1.10.10.8.9.2.3"><eq id="S4.E5.m1.10.10.8.9.2.3.1.cmml" xref="S4.E5.m1.10.10.8.9.2.3.1"></eq><ci id="S4.E5.m1.10.10.8.9.2.3.2.cmml" xref="S4.E5.m1.10.10.8.9.2.3.2">𝑖</ci><cn type="integer" id="S4.E5.m1.10.10.8.9.2.3.3.cmml" xref="S4.E5.m1.10.10.8.9.2.3.3">1</cn></apply></apply><ci id="S4.E5.m1.10.10.8.9.3.cmml" xref="S4.E5.m1.10.10.8.9.3">𝑁</ci></apply><apply id="S4.E5.m1.10.10.8.10.cmml" xref="S4.E5.m1.10.10.8.10"><times id="S4.E5.m1.10.10.8.10.1.cmml" xref="S4.E5.m1.10.10.8.10.1"></times><apply id="S4.E5.m1.10.10.8.10.2.cmml" xref="S4.E5.m1.10.10.8.10.2"><csymbol cd="ambiguous" id="S4.E5.m1.10.10.8.10.2.1.cmml" xref="S4.E5.m1.10.10.8.10.2">subscript</csymbol><ci id="S4.E5.m1.10.10.8.10.2.2.cmml" xref="S4.E5.m1.10.10.8.10.2.2">𝑛</ci><ci id="S4.E5.m1.10.10.8.10.2.3.cmml" xref="S4.E5.m1.10.10.8.10.2.3">𝑖</ci></apply><apply id="S4.E5.m1.10.10.8.10.3.cmml" xref="S4.E5.m1.10.10.8.10.3"><csymbol cd="ambiguous" id="S4.E5.m1.10.10.8.10.3.1.cmml" xref="S4.E5.m1.10.10.8.10.3">superscript</csymbol><apply id="S4.E5.m1.10.10.8.10.3.2.cmml" xref="S4.E5.m1.10.10.8.10.3"><csymbol cd="ambiguous" id="S4.E5.m1.10.10.8.10.3.2.1.cmml" xref="S4.E5.m1.10.10.8.10.3">subscript</csymbol><ci id="S4.E5.m1.10.10.8.10.3.2.2.cmml" xref="S4.E5.m1.10.10.8.10.3.2.2">𝛼</ci><list id="S4.E5.m1.4.4.2.2.2.3.cmml" xref="S4.E5.m1.4.4.2.2.2.4"><ci id="S4.E5.m1.3.3.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1">𝑙</ci><ci id="S4.E5.m1.4.4.2.2.2.2.cmml" xref="S4.E5.m1.4.4.2.2.2.2">𝑏</ci></list></apply><list id="S4.E5.m1.6.6.4.4.2.3.cmml" xref="S4.E5.m1.6.6.4.4.2.2"><apply id="S4.E5.m1.6.6.4.4.2.2.1.cmml" xref="S4.E5.m1.6.6.4.4.2.2.1"><plus id="S4.E5.m1.6.6.4.4.2.2.1.1.cmml" xref="S4.E5.m1.6.6.4.4.2.2.1.1"></plus><ci id="S4.E5.m1.6.6.4.4.2.2.1.2.cmml" xref="S4.E5.m1.6.6.4.4.2.2.1.2">𝑡</ci><cn type="integer" id="S4.E5.m1.6.6.4.4.2.2.1.3.cmml" xref="S4.E5.m1.6.6.4.4.2.2.1.3">1</cn></apply><ci id="S4.E5.m1.5.5.3.3.1.1.cmml" xref="S4.E5.m1.5.5.3.3.1.1">𝑖</ci></list></apply><apply id="S4.E5.m1.10.10.8.10.4.cmml" xref="S4.E5.m1.10.10.8.10.4"><csymbol cd="ambiguous" id="S4.E5.m1.10.10.8.10.4.1.cmml" xref="S4.E5.m1.10.10.8.10.4">superscript</csymbol><apply id="S4.E5.m1.10.10.8.10.4.2.cmml" xref="S4.E5.m1.10.10.8.10.4"><csymbol cd="ambiguous" id="S4.E5.m1.10.10.8.10.4.2.1.cmml" xref="S4.E5.m1.10.10.8.10.4">subscript</csymbol><ci id="S4.E5.m1.10.10.8.10.4.2.2.cmml" xref="S4.E5.m1.10.10.8.10.4.2.2">𝑊</ci><list id="S4.E5.m1.8.8.6.6.2.3.cmml" xref="S4.E5.m1.8.8.6.6.2.4"><ci id="S4.E5.m1.7.7.5.5.1.1.cmml" xref="S4.E5.m1.7.7.5.5.1.1">𝑙</ci><ci id="S4.E5.m1.8.8.6.6.2.2.cmml" xref="S4.E5.m1.8.8.6.6.2.2">𝑏</ci></list></apply><list id="S4.E5.m1.10.10.8.8.2.3.cmml" xref="S4.E5.m1.10.10.8.8.2.2"><apply id="S4.E5.m1.10.10.8.8.2.2.1.cmml" xref="S4.E5.m1.10.10.8.8.2.2.1"><plus id="S4.E5.m1.10.10.8.8.2.2.1.1.cmml" xref="S4.E5.m1.10.10.8.8.2.2.1.1"></plus><ci id="S4.E5.m1.10.10.8.8.2.2.1.2.cmml" xref="S4.E5.m1.10.10.8.8.2.2.1.2">𝑡</ci><cn type="integer" id="S4.E5.m1.10.10.8.8.2.2.1.3.cmml" xref="S4.E5.m1.10.10.8.8.2.2.1.3">1</cn></apply><ci id="S4.E5.m1.9.9.7.7.1.1.cmml" xref="S4.E5.m1.9.9.7.7.1.1">𝑖</ci></list></apply></apply></apply><apply id="S4.E5.m1.14.14.12.cmml" xref="S4.E5.m1.14.14.12"><apply id="S4.E5.m1.14.14.12.5.cmml" xref="S4.E5.m1.14.14.12.5"><csymbol cd="ambiguous" id="S4.E5.m1.14.14.12.5.1.cmml" xref="S4.E5.m1.14.14.12.5">superscript</csymbol><apply id="S4.E5.m1.14.14.12.5.2.cmml" xref="S4.E5.m1.14.14.12.5"><csymbol cd="ambiguous" id="S4.E5.m1.14.14.12.5.2.1.cmml" xref="S4.E5.m1.14.14.12.5">subscript</csymbol><sum id="S4.E5.m1.14.14.12.5.2.2.cmml" xref="S4.E5.m1.14.14.12.5.2.2"></sum><apply id="S4.E5.m1.14.14.12.5.2.3.cmml" xref="S4.E5.m1.14.14.12.5.2.3"><eq id="S4.E5.m1.14.14.12.5.2.3.1.cmml" xref="S4.E5.m1.14.14.12.5.2.3.1"></eq><ci id="S4.E5.m1.14.14.12.5.2.3.2.cmml" xref="S4.E5.m1.14.14.12.5.2.3.2">𝑗</ci><cn type="integer" id="S4.E5.m1.14.14.12.5.2.3.3.cmml" xref="S4.E5.m1.14.14.12.5.2.3.3">1</cn></apply></apply><ci id="S4.E5.m1.14.14.12.5.3.cmml" xref="S4.E5.m1.14.14.12.5.3">𝑁</ci></apply><apply id="S4.E5.m1.14.14.12.6.cmml" xref="S4.E5.m1.14.14.12.6"><times id="S4.E5.m1.14.14.12.6.1.cmml" xref="S4.E5.m1.14.14.12.6.1"></times><apply id="S4.E5.m1.14.14.12.6.2.cmml" xref="S4.E5.m1.14.14.12.6.2"><csymbol cd="ambiguous" id="S4.E5.m1.14.14.12.6.2.1.cmml" xref="S4.E5.m1.14.14.12.6.2">subscript</csymbol><ci id="S4.E5.m1.14.14.12.6.2.2.cmml" xref="S4.E5.m1.14.14.12.6.2.2">𝑛</ci><ci id="S4.E5.m1.14.14.12.6.2.3.cmml" xref="S4.E5.m1.14.14.12.6.2.3">𝑗</ci></apply><apply id="S4.E5.m1.14.14.12.6.3.cmml" xref="S4.E5.m1.14.14.12.6.3"><csymbol cd="ambiguous" id="S4.E5.m1.14.14.12.6.3.1.cmml" xref="S4.E5.m1.14.14.12.6.3">superscript</csymbol><apply id="S4.E5.m1.14.14.12.6.3.2.cmml" xref="S4.E5.m1.14.14.12.6.3"><csymbol cd="ambiguous" id="S4.E5.m1.14.14.12.6.3.2.1.cmml" xref="S4.E5.m1.14.14.12.6.3">subscript</csymbol><ci id="S4.E5.m1.14.14.12.6.3.2.2.cmml" xref="S4.E5.m1.14.14.12.6.3.2.2">𝛼</ci><list id="S4.E5.m1.12.12.10.2.2.3.cmml" xref="S4.E5.m1.12.12.10.2.2.4"><ci id="S4.E5.m1.11.11.9.1.1.1.cmml" xref="S4.E5.m1.11.11.9.1.1.1">𝑙</ci><ci id="S4.E5.m1.12.12.10.2.2.2.cmml" xref="S4.E5.m1.12.12.10.2.2.2">𝑏</ci></list></apply><list id="S4.E5.m1.14.14.12.4.2.3.cmml" xref="S4.E5.m1.14.14.12.4.2.2"><apply id="S4.E5.m1.14.14.12.4.2.2.1.cmml" xref="S4.E5.m1.14.14.12.4.2.2.1"><plus id="S4.E5.m1.14.14.12.4.2.2.1.1.cmml" xref="S4.E5.m1.14.14.12.4.2.2.1.1"></plus><ci id="S4.E5.m1.14.14.12.4.2.2.1.2.cmml" xref="S4.E5.m1.14.14.12.4.2.2.1.2">𝑡</ci><cn type="integer" id="S4.E5.m1.14.14.12.4.2.2.1.3.cmml" xref="S4.E5.m1.14.14.12.4.2.2.1.3">1</cn></apply><ci id="S4.E5.m1.13.13.11.3.1.1.cmml" xref="S4.E5.m1.13.13.11.3.1.1">𝑗</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.15c">W_{l,b}^{t+1}=\frac{\sum_{i=1}^{N}n_{i}\alpha_{l,b}^{t+1,i}W_{l,b}^{t+1,i}}{\sum_{j=1}^{N}n_{j}\alpha_{l,b}^{t+1,j}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p2.28" class="ltx_p">Here, <math id="S4.SS2.p2.21.m1.2" class="ltx_Math" alttext="W_{l,b}^{t+1}" display="inline"><semantics id="S4.SS2.p2.21.m1.2a"><msubsup id="S4.SS2.p2.21.m1.2.3" xref="S4.SS2.p2.21.m1.2.3.cmml"><mi id="S4.SS2.p2.21.m1.2.3.2.2" xref="S4.SS2.p2.21.m1.2.3.2.2.cmml">W</mi><mrow id="S4.SS2.p2.21.m1.2.2.2.4" xref="S4.SS2.p2.21.m1.2.2.2.3.cmml"><mi id="S4.SS2.p2.21.m1.1.1.1.1" xref="S4.SS2.p2.21.m1.1.1.1.1.cmml">l</mi><mo id="S4.SS2.p2.21.m1.2.2.2.4.1" xref="S4.SS2.p2.21.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.21.m1.2.2.2.2" xref="S4.SS2.p2.21.m1.2.2.2.2.cmml">b</mi></mrow><mrow id="S4.SS2.p2.21.m1.2.3.3" xref="S4.SS2.p2.21.m1.2.3.3.cmml"><mi id="S4.SS2.p2.21.m1.2.3.3.2" xref="S4.SS2.p2.21.m1.2.3.3.2.cmml">t</mi><mo id="S4.SS2.p2.21.m1.2.3.3.1" xref="S4.SS2.p2.21.m1.2.3.3.1.cmml">+</mo><mn id="S4.SS2.p2.21.m1.2.3.3.3" xref="S4.SS2.p2.21.m1.2.3.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.21.m1.2b"><apply id="S4.SS2.p2.21.m1.2.3.cmml" xref="S4.SS2.p2.21.m1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.21.m1.2.3.1.cmml" xref="S4.SS2.p2.21.m1.2.3">superscript</csymbol><apply id="S4.SS2.p2.21.m1.2.3.2.cmml" xref="S4.SS2.p2.21.m1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.21.m1.2.3.2.1.cmml" xref="S4.SS2.p2.21.m1.2.3">subscript</csymbol><ci id="S4.SS2.p2.21.m1.2.3.2.2.cmml" xref="S4.SS2.p2.21.m1.2.3.2.2">𝑊</ci><list id="S4.SS2.p2.21.m1.2.2.2.3.cmml" xref="S4.SS2.p2.21.m1.2.2.2.4"><ci id="S4.SS2.p2.21.m1.1.1.1.1.cmml" xref="S4.SS2.p2.21.m1.1.1.1.1">𝑙</ci><ci id="S4.SS2.p2.21.m1.2.2.2.2.cmml" xref="S4.SS2.p2.21.m1.2.2.2.2">𝑏</ci></list></apply><apply id="S4.SS2.p2.21.m1.2.3.3.cmml" xref="S4.SS2.p2.21.m1.2.3.3"><plus id="S4.SS2.p2.21.m1.2.3.3.1.cmml" xref="S4.SS2.p2.21.m1.2.3.3.1"></plus><ci id="S4.SS2.p2.21.m1.2.3.3.2.cmml" xref="S4.SS2.p2.21.m1.2.3.3.2">𝑡</ci><cn type="integer" id="S4.SS2.p2.21.m1.2.3.3.3.cmml" xref="S4.SS2.p2.21.m1.2.3.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.21.m1.2c">W_{l,b}^{t+1}</annotation></semantics></math> is calculated through weighted averaging by not only the number of data points <math id="S4.SS2.p2.22.m2.1" class="ltx_Math" alttext="n_{i}" display="inline"><semantics id="S4.SS2.p2.22.m2.1a"><msub id="S4.SS2.p2.22.m2.1.1" xref="S4.SS2.p2.22.m2.1.1.cmml"><mi id="S4.SS2.p2.22.m2.1.1.2" xref="S4.SS2.p2.22.m2.1.1.2.cmml">n</mi><mi id="S4.SS2.p2.22.m2.1.1.3" xref="S4.SS2.p2.22.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.22.m2.1b"><apply id="S4.SS2.p2.22.m2.1.1.cmml" xref="S4.SS2.p2.22.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.22.m2.1.1.1.cmml" xref="S4.SS2.p2.22.m2.1.1">subscript</csymbol><ci id="S4.SS2.p2.22.m2.1.1.2.cmml" xref="S4.SS2.p2.22.m2.1.1.2">𝑛</ci><ci id="S4.SS2.p2.22.m2.1.1.3.cmml" xref="S4.SS2.p2.22.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.22.m2.1c">n_{i}</annotation></semantics></math>, but also the client-specific weight <math id="S4.SS2.p2.23.m3.4" class="ltx_Math" alttext="\alpha_{l,b}^{t+1,i}" display="inline"><semantics id="S4.SS2.p2.23.m3.4a"><msubsup id="S4.SS2.p2.23.m3.4.5" xref="S4.SS2.p2.23.m3.4.5.cmml"><mi id="S4.SS2.p2.23.m3.4.5.2.2" xref="S4.SS2.p2.23.m3.4.5.2.2.cmml">α</mi><mrow id="S4.SS2.p2.23.m3.2.2.2.4" xref="S4.SS2.p2.23.m3.2.2.2.3.cmml"><mi id="S4.SS2.p2.23.m3.1.1.1.1" xref="S4.SS2.p2.23.m3.1.1.1.1.cmml">l</mi><mo id="S4.SS2.p2.23.m3.2.2.2.4.1" xref="S4.SS2.p2.23.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.23.m3.2.2.2.2" xref="S4.SS2.p2.23.m3.2.2.2.2.cmml">b</mi></mrow><mrow id="S4.SS2.p2.23.m3.4.4.2.2" xref="S4.SS2.p2.23.m3.4.4.2.3.cmml"><mrow id="S4.SS2.p2.23.m3.4.4.2.2.1" xref="S4.SS2.p2.23.m3.4.4.2.2.1.cmml"><mi id="S4.SS2.p2.23.m3.4.4.2.2.1.2" xref="S4.SS2.p2.23.m3.4.4.2.2.1.2.cmml">t</mi><mo id="S4.SS2.p2.23.m3.4.4.2.2.1.1" xref="S4.SS2.p2.23.m3.4.4.2.2.1.1.cmml">+</mo><mn id="S4.SS2.p2.23.m3.4.4.2.2.1.3" xref="S4.SS2.p2.23.m3.4.4.2.2.1.3.cmml">1</mn></mrow><mo id="S4.SS2.p2.23.m3.4.4.2.2.2" xref="S4.SS2.p2.23.m3.4.4.2.3.cmml">,</mo><mi id="S4.SS2.p2.23.m3.3.3.1.1" xref="S4.SS2.p2.23.m3.3.3.1.1.cmml">i</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.23.m3.4b"><apply id="S4.SS2.p2.23.m3.4.5.cmml" xref="S4.SS2.p2.23.m3.4.5"><csymbol cd="ambiguous" id="S4.SS2.p2.23.m3.4.5.1.cmml" xref="S4.SS2.p2.23.m3.4.5">superscript</csymbol><apply id="S4.SS2.p2.23.m3.4.5.2.cmml" xref="S4.SS2.p2.23.m3.4.5"><csymbol cd="ambiguous" id="S4.SS2.p2.23.m3.4.5.2.1.cmml" xref="S4.SS2.p2.23.m3.4.5">subscript</csymbol><ci id="S4.SS2.p2.23.m3.4.5.2.2.cmml" xref="S4.SS2.p2.23.m3.4.5.2.2">𝛼</ci><list id="S4.SS2.p2.23.m3.2.2.2.3.cmml" xref="S4.SS2.p2.23.m3.2.2.2.4"><ci id="S4.SS2.p2.23.m3.1.1.1.1.cmml" xref="S4.SS2.p2.23.m3.1.1.1.1">𝑙</ci><ci id="S4.SS2.p2.23.m3.2.2.2.2.cmml" xref="S4.SS2.p2.23.m3.2.2.2.2">𝑏</ci></list></apply><list id="S4.SS2.p2.23.m3.4.4.2.3.cmml" xref="S4.SS2.p2.23.m3.4.4.2.2"><apply id="S4.SS2.p2.23.m3.4.4.2.2.1.cmml" xref="S4.SS2.p2.23.m3.4.4.2.2.1"><plus id="S4.SS2.p2.23.m3.4.4.2.2.1.1.cmml" xref="S4.SS2.p2.23.m3.4.4.2.2.1.1"></plus><ci id="S4.SS2.p2.23.m3.4.4.2.2.1.2.cmml" xref="S4.SS2.p2.23.m3.4.4.2.2.1.2">𝑡</ci><cn type="integer" id="S4.SS2.p2.23.m3.4.4.2.2.1.3.cmml" xref="S4.SS2.p2.23.m3.4.4.2.2.1.3">1</cn></apply><ci id="S4.SS2.p2.23.m3.3.3.1.1.cmml" xref="S4.SS2.p2.23.m3.3.3.1.1">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.23.m3.4c">\alpha_{l,b}^{t+1,i}</annotation></semantics></math> corresponding to <math id="S4.SS2.p2.24.m4.4" class="ltx_Math" alttext="W_{l,b}^{t+1,i}" display="inline"><semantics id="S4.SS2.p2.24.m4.4a"><msubsup id="S4.SS2.p2.24.m4.4.5" xref="S4.SS2.p2.24.m4.4.5.cmml"><mi id="S4.SS2.p2.24.m4.4.5.2.2" xref="S4.SS2.p2.24.m4.4.5.2.2.cmml">W</mi><mrow id="S4.SS2.p2.24.m4.2.2.2.4" xref="S4.SS2.p2.24.m4.2.2.2.3.cmml"><mi id="S4.SS2.p2.24.m4.1.1.1.1" xref="S4.SS2.p2.24.m4.1.1.1.1.cmml">l</mi><mo id="S4.SS2.p2.24.m4.2.2.2.4.1" xref="S4.SS2.p2.24.m4.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.24.m4.2.2.2.2" xref="S4.SS2.p2.24.m4.2.2.2.2.cmml">b</mi></mrow><mrow id="S4.SS2.p2.24.m4.4.4.2.2" xref="S4.SS2.p2.24.m4.4.4.2.3.cmml"><mrow id="S4.SS2.p2.24.m4.4.4.2.2.1" xref="S4.SS2.p2.24.m4.4.4.2.2.1.cmml"><mi id="S4.SS2.p2.24.m4.4.4.2.2.1.2" xref="S4.SS2.p2.24.m4.4.4.2.2.1.2.cmml">t</mi><mo id="S4.SS2.p2.24.m4.4.4.2.2.1.1" xref="S4.SS2.p2.24.m4.4.4.2.2.1.1.cmml">+</mo><mn id="S4.SS2.p2.24.m4.4.4.2.2.1.3" xref="S4.SS2.p2.24.m4.4.4.2.2.1.3.cmml">1</mn></mrow><mo id="S4.SS2.p2.24.m4.4.4.2.2.2" xref="S4.SS2.p2.24.m4.4.4.2.3.cmml">,</mo><mi id="S4.SS2.p2.24.m4.3.3.1.1" xref="S4.SS2.p2.24.m4.3.3.1.1.cmml">i</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.24.m4.4b"><apply id="S4.SS2.p2.24.m4.4.5.cmml" xref="S4.SS2.p2.24.m4.4.5"><csymbol cd="ambiguous" id="S4.SS2.p2.24.m4.4.5.1.cmml" xref="S4.SS2.p2.24.m4.4.5">superscript</csymbol><apply id="S4.SS2.p2.24.m4.4.5.2.cmml" xref="S4.SS2.p2.24.m4.4.5"><csymbol cd="ambiguous" id="S4.SS2.p2.24.m4.4.5.2.1.cmml" xref="S4.SS2.p2.24.m4.4.5">subscript</csymbol><ci id="S4.SS2.p2.24.m4.4.5.2.2.cmml" xref="S4.SS2.p2.24.m4.4.5.2.2">𝑊</ci><list id="S4.SS2.p2.24.m4.2.2.2.3.cmml" xref="S4.SS2.p2.24.m4.2.2.2.4"><ci id="S4.SS2.p2.24.m4.1.1.1.1.cmml" xref="S4.SS2.p2.24.m4.1.1.1.1">𝑙</ci><ci id="S4.SS2.p2.24.m4.2.2.2.2.cmml" xref="S4.SS2.p2.24.m4.2.2.2.2">𝑏</ci></list></apply><list id="S4.SS2.p2.24.m4.4.4.2.3.cmml" xref="S4.SS2.p2.24.m4.4.4.2.2"><apply id="S4.SS2.p2.24.m4.4.4.2.2.1.cmml" xref="S4.SS2.p2.24.m4.4.4.2.2.1"><plus id="S4.SS2.p2.24.m4.4.4.2.2.1.1.cmml" xref="S4.SS2.p2.24.m4.4.4.2.2.1.1"></plus><ci id="S4.SS2.p2.24.m4.4.4.2.2.1.2.cmml" xref="S4.SS2.p2.24.m4.4.4.2.2.1.2">𝑡</ci><cn type="integer" id="S4.SS2.p2.24.m4.4.4.2.2.1.3.cmml" xref="S4.SS2.p2.24.m4.4.4.2.2.1.3">1</cn></apply><ci id="S4.SS2.p2.24.m4.3.3.1.1.cmml" xref="S4.SS2.p2.24.m4.3.3.1.1">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.24.m4.4c">W_{l,b}^{t+1,i}</annotation></semantics></math>, which means that the clients who give more attention to the <math id="S4.SS2.p2.25.m5.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.SS2.p2.25.m5.1a"><mi id="S4.SS2.p2.25.m5.1.1" xref="S4.SS2.p2.25.m5.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.25.m5.1b"><ci id="S4.SS2.p2.25.m5.1.1.cmml" xref="S4.SS2.p2.25.m5.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.25.m5.1c">b</annotation></semantics></math>-th branch of the <math id="S4.SS2.p2.26.m6.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S4.SS2.p2.26.m6.1a"><mi id="S4.SS2.p2.26.m6.1.1" xref="S4.SS2.p2.26.m6.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.26.m6.1b"><ci id="S4.SS2.p2.26.m6.1.1.cmml" xref="S4.SS2.p2.26.m6.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.26.m6.1c">l</annotation></semantics></math>-th layer contribute to the calculation of <math id="S4.SS2.p2.27.m7.2" class="ltx_Math" alttext="W_{l,b}^{t+1}" display="inline"><semantics id="S4.SS2.p2.27.m7.2a"><msubsup id="S4.SS2.p2.27.m7.2.3" xref="S4.SS2.p2.27.m7.2.3.cmml"><mi id="S4.SS2.p2.27.m7.2.3.2.2" xref="S4.SS2.p2.27.m7.2.3.2.2.cmml">W</mi><mrow id="S4.SS2.p2.27.m7.2.2.2.4" xref="S4.SS2.p2.27.m7.2.2.2.3.cmml"><mi id="S4.SS2.p2.27.m7.1.1.1.1" xref="S4.SS2.p2.27.m7.1.1.1.1.cmml">l</mi><mo id="S4.SS2.p2.27.m7.2.2.2.4.1" xref="S4.SS2.p2.27.m7.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.27.m7.2.2.2.2" xref="S4.SS2.p2.27.m7.2.2.2.2.cmml">b</mi></mrow><mrow id="S4.SS2.p2.27.m7.2.3.3" xref="S4.SS2.p2.27.m7.2.3.3.cmml"><mi id="S4.SS2.p2.27.m7.2.3.3.2" xref="S4.SS2.p2.27.m7.2.3.3.2.cmml">t</mi><mo id="S4.SS2.p2.27.m7.2.3.3.1" xref="S4.SS2.p2.27.m7.2.3.3.1.cmml">+</mo><mn id="S4.SS2.p2.27.m7.2.3.3.3" xref="S4.SS2.p2.27.m7.2.3.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.27.m7.2b"><apply id="S4.SS2.p2.27.m7.2.3.cmml" xref="S4.SS2.p2.27.m7.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.27.m7.2.3.1.cmml" xref="S4.SS2.p2.27.m7.2.3">superscript</csymbol><apply id="S4.SS2.p2.27.m7.2.3.2.cmml" xref="S4.SS2.p2.27.m7.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.27.m7.2.3.2.1.cmml" xref="S4.SS2.p2.27.m7.2.3">subscript</csymbol><ci id="S4.SS2.p2.27.m7.2.3.2.2.cmml" xref="S4.SS2.p2.27.m7.2.3.2.2">𝑊</ci><list id="S4.SS2.p2.27.m7.2.2.2.3.cmml" xref="S4.SS2.p2.27.m7.2.2.2.4"><ci id="S4.SS2.p2.27.m7.1.1.1.1.cmml" xref="S4.SS2.p2.27.m7.1.1.1.1">𝑙</ci><ci id="S4.SS2.p2.27.m7.2.2.2.2.cmml" xref="S4.SS2.p2.27.m7.2.2.2.2">𝑏</ci></list></apply><apply id="S4.SS2.p2.27.m7.2.3.3.cmml" xref="S4.SS2.p2.27.m7.2.3.3"><plus id="S4.SS2.p2.27.m7.2.3.3.1.cmml" xref="S4.SS2.p2.27.m7.2.3.3.1"></plus><ci id="S4.SS2.p2.27.m7.2.3.3.2.cmml" xref="S4.SS2.p2.27.m7.2.3.3.2">𝑡</ci><cn type="integer" id="S4.SS2.p2.27.m7.2.3.3.3.cmml" xref="S4.SS2.p2.27.m7.2.3.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.27.m7.2c">W_{l,b}^{t+1}</annotation></semantics></math> more.
Therefore, this facilitates similar clients (i.e., clients who have similar <math id="S4.SS2.p2.28.m8.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS2.p2.28.m8.1a"><mi id="S4.SS2.p2.28.m8.1.1" xref="S4.SS2.p2.28.m8.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.28.m8.1b"><ci id="S4.SS2.p2.28.m8.1.1.cmml" xref="S4.SS2.p2.28.m8.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.28.m8.1c">\alpha</annotation></semantics></math>) to collaborate more as in FedFomo <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> and FedAmp <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. <span id="S4.SS2.p2.28.1" class="ltx_text" style="color:#000000;">However, unlike FedFomo and FedAMP, each client only optimizes their weights assigned to each branch in pFedMB, and therefore collaboration among similar clients occurs automatically without directly calculating the similarities.</span></p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">We note that</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">EXPERIMENTS</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this section, we evaluate the performance of pFedMB in non-IID data settings. First, we observe how pFedMB achieves personalization in a simple setting. Next, we compare the performance of pFedMB with the state-of-the-art PFL methods in more complex settings.</p>
</div>
<figure id="S5.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F3.3" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" style="width:433.6pt;"><img src="/html/2211.07931/assets/transition.png" id="S5.F3.1.g1" class="ltx_graphics ltx_img_landscape" width="419" height="176" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.3.3.2.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S5.F3.3.2.1" class="ltx_text" style="font-size:90%;color:#000000;">pFedMB with <math id="S5.F3.3.2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.F3.3.2.1.m1.1b"><mi mathcolor="#000000" id="S5.F3.3.2.1.m1.1.1" xref="S5.F3.3.2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.F3.3.2.1.m1.1c"><ci id="S5.F3.3.2.1.m1.1.1.cmml" xref="S5.F3.3.2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.3.2.1.m1.1d">\alpha</annotation></semantics></math>-weighted averaging.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F3.6" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" style="width:433.6pt;"><img src="/html/2211.07931/assets/transition_avg.png" id="S5.F3.4.g1" class="ltx_graphics ltx_img_landscape" width="419" height="176" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.6.3.2.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S5.F3.6.2.1" class="ltx_text" style="font-size:90%;color:#000000;">pFedMB without <math id="S5.F3.6.2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.F3.6.2.1.m1.1b"><mi mathcolor="#000000" id="S5.F3.6.2.1.m1.1.1" xref="S5.F3.6.2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.F3.6.2.1.m1.1c"><ci id="S5.F3.6.2.1.m1.1.1.cmml" xref="S5.F3.6.2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.6.2.1.m1.1d">\alpha</annotation></semantics></math>-weighted averaging.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.14.4.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S5.F3.12.3" class="ltx_text" style="font-size:90%;color:#000000;">Visualization of <math id="S5.F3.10.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.F3.10.1.m1.1b"><mi mathcolor="#000000" id="S5.F3.10.1.m1.1.1" xref="S5.F3.10.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.F3.10.1.m1.1c"><ci id="S5.F3.10.1.m1.1.1.cmml" xref="S5.F3.10.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.10.1.m1.1d">\alpha</annotation></semantics></math> at communication round <math id="S5.F3.11.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S5.F3.11.2.m2.1b"><mi mathcolor="#000000" id="S5.F3.11.2.m2.1.1" xref="S5.F3.11.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.F3.11.2.m2.1c"><ci id="S5.F3.11.2.m2.1.1.cmml" xref="S5.F3.11.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.11.2.m2.1d">t</annotation></semantics></math> with/without <math id="S5.F3.12.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.F3.12.3.m3.1b"><mi mathcolor="#000000" id="S5.F3.12.3.m3.1.1" xref="S5.F3.12.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.F3.12.3.m3.1c"><ci id="S5.F3.12.3.m3.1.1.cmml" xref="S5.F3.12.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.12.3.m3.1d">\alpha</annotation></semantics></math>-weighted averaging usine CIFAR10.</span></figcaption>
</figure>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS1.4.1.1" class="ltx_text">V-A</span> </span><span id="S5.SS1.5.2" class="ltx_text ltx_font_italic">Experimental setup</span>
</h3>

<section id="S5.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Data settings</h4>

<div id="S5.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS1.SSS0.Px1.p1.10" class="ltx_p">In this paper, we numerically evaluate the performance of pFedMB using CIFAR10 <span id="S5.SS1.SSS0.Px1.p1.10.10" class="ltx_text" style="color:#000000;">and CIFAR100</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>. <span id="S5.SS1.SSS0.Px1.p1.10.11" class="ltx_text" style="color:#000000;">CIFAR10/CIFAR100 dataset has 50,000 training images and 10,000 test images with 10/100 classes.</span> We split the training images into 40,000 training images and 10,000 validation images used to tune the hyperparameters for each method (e.g. learning rate <math id="S5.SS1.SSS0.Px1.p1.1.m1.2" class="ltx_Math" alttext="\eta_{\alpha},\eta_{W}" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.1.m1.2a"><mrow id="S5.SS1.SSS0.Px1.p1.1.m1.2.2.2" xref="S5.SS1.SSS0.Px1.p1.1.m1.2.2.3.cmml"><msub id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1.1" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.cmml"><mi id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.2" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.2.cmml">η</mi><mi id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.3" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.3.cmml">α</mi></msub><mo id="S5.SS1.SSS0.Px1.p1.1.m1.2.2.2.3" xref="S5.SS1.SSS0.Px1.p1.1.m1.2.2.3.cmml">,</mo><msub id="S5.SS1.SSS0.Px1.p1.1.m1.2.2.2.2" xref="S5.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.cmml"><mi id="S5.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2" xref="S5.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2.cmml">η</mi><mi id="S5.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.3" xref="S5.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.3.cmml">W</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.1.m1.2b"><list id="S5.SS1.SSS0.Px1.p1.1.m1.2.2.3.cmml" xref="S5.SS1.SSS0.Px1.p1.1.m1.2.2.2"><apply id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.2.cmml" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.2">𝜂</ci><ci id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.3.cmml" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.3">𝛼</ci></apply><apply id="S5.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.cmml" xref="S5.SS1.SSS0.Px1.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.1.cmml" xref="S5.SS1.SSS0.Px1.p1.1.m1.2.2.2.2">subscript</csymbol><ci id="S5.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2.cmml" xref="S5.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2">𝜂</ci><ci id="S5.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.3.cmml" xref="S5.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.3">𝑊</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.1.m1.2c">\eta_{\alpha},\eta_{W}</annotation></semantics></math> and number of branches for pFedMB). Each type of data (i.e., training, validation, and test) is distributed across clients in the same way. For CIFAR10, we consider two different scenarios for simulating non-IID data across clients. The first is a commonly used scenario where each client is randomly assigned 2 classes <span id="S5.SS1.SSS0.Px1.p1.10.12" class="ltx_text" style="color:#000000;">with the same data size</span>. However, this setting is not realistic and in practice each client’s data is sampled from a more complex distribution. In order to simulate this, we consider another scenario where the non-IID data partition is generated by Dirichlet distribution (with concentration parameter 0.4) as in the previous studies such as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>.
<span id="S5.SS1.SSS0.Px1.p1.10.9" class="ltx_text" style="color:#000000;">
In contrast, applying the Dirichlet distribution to CIFAR100 would result in an extremely small number of data for each class held by each client. Therefore, for CIFAR100, we adopt the non-IID data setting used in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, where data is heterogeneous in terms of not only classes but also data size. First, we randomly assign 20 classes for each client. Next, for each client <math id="S5.SS1.SSS0.Px1.p1.2.1.m1.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.2.1.m1.1a"><msub id="S5.SS1.SSS0.Px1.p1.2.1.m1.1.1" xref="S5.SS1.SSS0.Px1.p1.2.1.m1.1.1.cmml"><mi mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.2.1.m1.1.1.2" xref="S5.SS1.SSS0.Px1.p1.2.1.m1.1.1.2.cmml">C</mi><mi mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.2.1.m1.1.1.3" xref="S5.SS1.SSS0.Px1.p1.2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.2.1.m1.1b"><apply id="S5.SS1.SSS0.Px1.p1.2.1.m1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px1.p1.2.1.m1.1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.2.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.SSS0.Px1.p1.2.1.m1.1.1.2.cmml" xref="S5.SS1.SSS0.Px1.p1.2.1.m1.1.1.2">𝐶</ci><ci id="S5.SS1.SSS0.Px1.p1.2.1.m1.1.1.3.cmml" xref="S5.SS1.SSS0.Px1.p1.2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.2.1.m1.1c">C_{i}</annotation></semantics></math> and chosen class <math id="S5.SS1.SSS0.Px1.p1.3.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.3.2.m2.1a"><mi mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.3.2.m2.1.1" xref="S5.SS1.SSS0.Px1.p1.3.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.3.2.m2.1b"><ci id="S5.SS1.SSS0.Px1.p1.3.2.m2.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.3.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.3.2.m2.1c">c</annotation></semantics></math> by <math id="S5.SS1.SSS0.Px1.p1.4.3.m3.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.4.3.m3.1a"><msub id="S5.SS1.SSS0.Px1.p1.4.3.m3.1.1" xref="S5.SS1.SSS0.Px1.p1.4.3.m3.1.1.cmml"><mi mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.4.3.m3.1.1.2" xref="S5.SS1.SSS0.Px1.p1.4.3.m3.1.1.2.cmml">C</mi><mi mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.4.3.m3.1.1.3" xref="S5.SS1.SSS0.Px1.p1.4.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.4.3.m3.1b"><apply id="S5.SS1.SSS0.Px1.p1.4.3.m3.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.4.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px1.p1.4.3.m3.1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.4.3.m3.1.1">subscript</csymbol><ci id="S5.SS1.SSS0.Px1.p1.4.3.m3.1.1.2.cmml" xref="S5.SS1.SSS0.Px1.p1.4.3.m3.1.1.2">𝐶</ci><ci id="S5.SS1.SSS0.Px1.p1.4.3.m3.1.1.3.cmml" xref="S5.SS1.SSS0.Px1.p1.4.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.4.3.m3.1c">C_{i}</annotation></semantics></math>, we sample <math id="S5.SS1.SSS0.Px1.p1.5.4.m4.4" class="ltx_Math" alttext="u_{i,c}\in U(0.3,0.7)" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.5.4.m4.4a"><mrow id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.cmml"><msub id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.2" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.2.cmml"><mi mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.2.2" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.2.2.cmml">u</mi><mrow id="S5.SS1.SSS0.Px1.p1.5.4.m4.2.2.2.4" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.2.2.2.3.cmml"><mi mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.5.4.m4.1.1.1.1" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.1.1.1.1.cmml">i</mi><mo mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.5.4.m4.2.2.2.4.1" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.2.2.2.3.cmml">,</mo><mi mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.5.4.m4.2.2.2.2" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.2.2.2.2.cmml">c</mi></mrow></msub><mo mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.1" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.1.cmml">∈</mo><mrow id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3.cmml"><mi mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3.2" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3.2.cmml">U</mi><mo lspace="0em" rspace="0em" id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3.1" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3.1.cmml">​</mo><mrow id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3.3.2" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3.3.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3.3.2.1" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3.3.1.cmml">(</mo><mn mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.5.4.m4.3.3" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.3.3.cmml">0.3</mn><mo mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3.3.2.2" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3.3.1.cmml">,</mo><mn mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.4" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.4.cmml">0.7</mn><mo mathcolor="#000000" stretchy="false" id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3.3.2.3" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.5.4.m4.4b"><apply id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.cmml" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5"><in id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.1.cmml" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.1"></in><apply id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.2.cmml" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.2"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.2.1.cmml" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.2">subscript</csymbol><ci id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.2.2.cmml" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.2.2">𝑢</ci><list id="S5.SS1.SSS0.Px1.p1.5.4.m4.2.2.2.3.cmml" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.2.2.2.4"><ci id="S5.SS1.SSS0.Px1.p1.5.4.m4.1.1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.1.1.1.1">𝑖</ci><ci id="S5.SS1.SSS0.Px1.p1.5.4.m4.2.2.2.2.cmml" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.2.2.2.2">𝑐</ci></list></apply><apply id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3.cmml" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3"><times id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3.1.cmml" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3.1"></times><ci id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3.2.cmml" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3.2">𝑈</ci><interval closure="open" id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3.3.1.cmml" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.5.3.3.2"><cn type="float" id="S5.SS1.SSS0.Px1.p1.5.4.m4.3.3.cmml" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.3.3">0.3</cn><cn type="float" id="S5.SS1.SSS0.Px1.p1.5.4.m4.4.4.cmml" xref="S5.SS1.SSS0.Px1.p1.5.4.m4.4.4">0.7</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.5.4.m4.4c">u_{i,c}\in U(0.3,0.7)</annotation></semantics></math> (uniform distribution between <math id="S5.SS1.SSS0.Px1.p1.6.5.m5.1" class="ltx_Math" alttext="0.3" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.6.5.m5.1a"><mn mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.6.5.m5.1.1" xref="S5.SS1.SSS0.Px1.p1.6.5.m5.1.1.cmml">0.3</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.6.5.m5.1b"><cn type="float" id="S5.SS1.SSS0.Px1.p1.6.5.m5.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.6.5.m5.1.1">0.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.6.5.m5.1c">0.3</annotation></semantics></math> and <math id="S5.SS1.SSS0.Px1.p1.7.6.m6.1" class="ltx_Math" alttext="0.7" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.7.6.m6.1a"><mn mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.7.6.m6.1.1" xref="S5.SS1.SSS0.Px1.p1.7.6.m6.1.1.cmml">0.7</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.7.6.m6.1b"><cn type="float" id="S5.SS1.SSS0.Px1.p1.7.6.m6.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.7.6.m6.1.1">0.7</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.7.6.m6.1c">0.7</annotation></semantics></math>) and allocate <math id="S5.SS1.SSS0.Px1.p1.8.7.m7.4" class="ltx_Math" alttext="\frac{u_{i,c}}{\sum_{j}u_{j,c}}" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.8.7.m7.4a"><mfrac mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.cmml"><msub id="S5.SS1.SSS0.Px1.p1.8.7.m7.2.2.2" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.2.2.2.cmml"><mi mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.8.7.m7.2.2.2.4" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.2.2.2.4.cmml">u</mi><mrow id="S5.SS1.SSS0.Px1.p1.8.7.m7.2.2.2.2.2.4" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.2.2.2.2.2.3.cmml"><mi mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.8.7.m7.1.1.1.1.1.1" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.1.1.1.1.1.1.cmml">i</mi><mo mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.8.7.m7.2.2.2.2.2.4.1" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.2.2.2.2.2.3.cmml">,</mo><mi mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.8.7.m7.2.2.2.2.2.2" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.2.2.2.2.2.2.cmml">c</mi></mrow></msub><mrow id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.cmml"><mstyle displaystyle="false" id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.3" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.3.cmml"><msub id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.3a" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.3.cmml"><mo mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.3.2" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.3.2.cmml">∑</mo><mi mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.3.3" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.3.3.cmml">j</mi></msub></mstyle><msub id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.4" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.4.cmml"><mi mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.4.2" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.4.2.cmml">u</mi><mrow id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.2.2.4" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.2.2.3.cmml"><mi mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.8.7.m7.3.3.3.1.1.1" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.3.3.3.1.1.1.cmml">j</mi><mo mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.2.2.4.1" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.2.2.3.cmml">,</mo><mi mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.2.2.2" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.2.2.2.cmml">c</mi></mrow></msub></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.8.7.m7.4b"><apply id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.cmml" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4"><divide id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.5.cmml" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4"></divide><apply id="S5.SS1.SSS0.Px1.p1.8.7.m7.2.2.2.cmml" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.2.2.2"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px1.p1.8.7.m7.2.2.2.3.cmml" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.2.2.2">subscript</csymbol><ci id="S5.SS1.SSS0.Px1.p1.8.7.m7.2.2.2.4.cmml" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.2.2.2.4">𝑢</ci><list id="S5.SS1.SSS0.Px1.p1.8.7.m7.2.2.2.2.2.3.cmml" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.2.2.2.2.2.4"><ci id="S5.SS1.SSS0.Px1.p1.8.7.m7.1.1.1.1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.1.1.1.1.1.1">𝑖</ci><ci id="S5.SS1.SSS0.Px1.p1.8.7.m7.2.2.2.2.2.2.cmml" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.2.2.2.2.2.2">𝑐</ci></list></apply><apply id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.cmml" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4"><apply id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.3.cmml" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.3"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.3.1.cmml" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.3">subscript</csymbol><sum id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.3.2.cmml" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.3.2"></sum><ci id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.3.3.cmml" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.3.3">𝑗</ci></apply><apply id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.4.cmml" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.4"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.4.1.cmml" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.4">subscript</csymbol><ci id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.4.2.cmml" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.4.2">𝑢</ci><list id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.2.2.3.cmml" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.2.2.4"><ci id="S5.SS1.SSS0.Px1.p1.8.7.m7.3.3.3.1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.3.3.3.1.1.1">𝑗</ci><ci id="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.2.2.2.cmml" xref="S5.SS1.SSS0.Px1.p1.8.7.m7.4.4.4.2.2.2">𝑐</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.8.7.m7.4c">\frac{u_{i,c}}{\sum_{j}u_{j,c}}</annotation></semantics></math> of the samples for class <math id="S5.SS1.SSS0.Px1.p1.9.8.m8.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.9.8.m8.1a"><mi mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.9.8.m8.1.1" xref="S5.SS1.SSS0.Px1.p1.9.8.m8.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.9.8.m8.1b"><ci id="S5.SS1.SSS0.Px1.p1.9.8.m8.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.9.8.m8.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.9.8.m8.1c">c</annotation></semantics></math> to <math id="S5.SS1.SSS0.Px1.p1.10.9.m9.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.10.9.m9.1a"><msub id="S5.SS1.SSS0.Px1.p1.10.9.m9.1.1" xref="S5.SS1.SSS0.Px1.p1.10.9.m9.1.1.cmml"><mi mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.10.9.m9.1.1.2" xref="S5.SS1.SSS0.Px1.p1.10.9.m9.1.1.2.cmml">C</mi><mi mathcolor="#000000" id="S5.SS1.SSS0.Px1.p1.10.9.m9.1.1.3" xref="S5.SS1.SSS0.Px1.p1.10.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.10.9.m9.1b"><apply id="S5.SS1.SSS0.Px1.p1.10.9.m9.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.10.9.m9.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px1.p1.10.9.m9.1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.10.9.m9.1.1">subscript</csymbol><ci id="S5.SS1.SSS0.Px1.p1.10.9.m9.1.1.2.cmml" xref="S5.SS1.SSS0.Px1.p1.10.9.m9.1.1.2">𝐶</ci><ci id="S5.SS1.SSS0.Px1.p1.10.9.m9.1.1.3.cmml" xref="S5.SS1.SSS0.Px1.p1.10.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.10.9.m9.1c">C_{i}</annotation></semantics></math>.
</span></p>
</div>
</section>
<section id="S5.SS1.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Implementation details</h4>

<div id="S5.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="S5.SS1.SSS0.Px2.p1.1" class="ltx_p">The performance of all the methods is evaluated by mean test accuracy among clients. Moreover, the experiments were conducted three times and the average of the test accuracies from the three experiments are reported. In each method, we train the models until the convergence. The number of clients is set to 15 and 50 in the main results and the client participation rate at each communication round is 100% and 20%, respectively. In all the experiments, we use a CNN network, which has two 5x5 convolution layers followed by 2x2 max pooling (the first with 6 channels and the second with 16 channels) and two fully connected layers with ReLU activation (the first with 120 units and the second with 84 units). pFedMB extends each linear layer to a multi-branch layer. The initial weights <math id="S5.SS1.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS1.SSS0.Px2.p1.1.m1.1a"><mi id="S5.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p1.1.m1.1b"><ci id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p1.1.m1.1c">\alpha</annotation></semantics></math> for each client are set to the same value for all branches. Throughout the experiments, the number of local
epochs and batch size are set to 5 and 64, respectively.
All methods are implemented in PyTorch.</p>
</div>
</section>
<section id="S5.SS1.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Compared methods</h4>

<div id="S5.SS1.SSS0.Px3.p1" class="ltx_para">
<p id="S5.SS1.SSS0.Px3.p1.1" class="ltx_p">We compare pFedMB with other various methods classified into two categories. The first category is the improved FL approach to train a single global model that performs well on non-IID data. In this category, we use FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. The second category is PFL to train multiple models personalized to each client’s data distribution. We compare our method with non-federated local learning, FedPer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, pFedMe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, IFCA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, FedFomo <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, and FedAMP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. In all the methods, we perform local fine-tuning for local epochs. Therefore, in our experiments, FedAvg and FedProx also <span id="S5.SS1.SSS0.Px3.p1.1.1" class="ltx_text" style="color:#000000;">eventually produce</span> multiple models.</p>
</div>
</section>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS2.4.1.1" class="ltx_text">V-B</span> </span><span id="S5.SS2.5.2" class="ltx_text ltx_font_italic">Process of personalization</span>
</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.2" class="ltx_p">Before moving on to the main result, we will see how our method works in a simple setting. We use CIFAR10 and consider 10 clients grouped into 5 pairs, each with the same two classes for simplicity (e.g. clients 1, 2 have class 0 and 1). Furthermore, we suppose client-specific weights <math id="S5.SS2.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.p1.1.m1.1a"><mi id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><ci id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">\alpha</annotation></semantics></math> are common for all the layers. In this experiment, the number of branches is set to 5. We compare pFedMB with local learning and FedAvg as baselines. Moreover, in order to see the effect of an aggregation method using weighted averaging by <math id="S5.SS2.p1.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.p1.2.m2.1a"><mi id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><ci id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">\alpha</annotation></semantics></math> (<a href="#S4.E5" title="In IV-B Algorithm ‣ IV PROPOSED METHOD ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) in global model updating phase, we implement pFedMB that updates global models by normal averaging as in FedAvg:</p>
<table id="S5.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.E6.m1.7" class="ltx_Math" alttext="W_{l,b}^{t+1}=\frac{\sum_{i=1}^{N}n_{i}W_{l,b}^{t+1,i}}{\sum_{j=1}^{N}n_{j}}." display="block"><semantics id="S5.E6.m1.7a"><mrow id="S5.E6.m1.7.7.1" xref="S5.E6.m1.7.7.1.1.cmml"><mrow id="S5.E6.m1.7.7.1.1" xref="S5.E6.m1.7.7.1.1.cmml"><msubsup id="S5.E6.m1.7.7.1.1.2" xref="S5.E6.m1.7.7.1.1.2.cmml"><mi id="S5.E6.m1.7.7.1.1.2.2.2" xref="S5.E6.m1.7.7.1.1.2.2.2.cmml">W</mi><mrow id="S5.E6.m1.2.2.2.4" xref="S5.E6.m1.2.2.2.3.cmml"><mi id="S5.E6.m1.1.1.1.1" xref="S5.E6.m1.1.1.1.1.cmml">l</mi><mo id="S5.E6.m1.2.2.2.4.1" xref="S5.E6.m1.2.2.2.3.cmml">,</mo><mi id="S5.E6.m1.2.2.2.2" xref="S5.E6.m1.2.2.2.2.cmml">b</mi></mrow><mrow id="S5.E6.m1.7.7.1.1.2.3" xref="S5.E6.m1.7.7.1.1.2.3.cmml"><mi id="S5.E6.m1.7.7.1.1.2.3.2" xref="S5.E6.m1.7.7.1.1.2.3.2.cmml">t</mi><mo id="S5.E6.m1.7.7.1.1.2.3.1" xref="S5.E6.m1.7.7.1.1.2.3.1.cmml">+</mo><mn id="S5.E6.m1.7.7.1.1.2.3.3" xref="S5.E6.m1.7.7.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S5.E6.m1.7.7.1.1.1" xref="S5.E6.m1.7.7.1.1.1.cmml">=</mo><mfrac id="S5.E6.m1.6.6" xref="S5.E6.m1.6.6.cmml"><mrow id="S5.E6.m1.6.6.4" xref="S5.E6.m1.6.6.4.cmml"><msubsup id="S5.E6.m1.6.6.4.5" xref="S5.E6.m1.6.6.4.5.cmml"><mo id="S5.E6.m1.6.6.4.5.2.2" xref="S5.E6.m1.6.6.4.5.2.2.cmml">∑</mo><mrow id="S5.E6.m1.6.6.4.5.2.3" xref="S5.E6.m1.6.6.4.5.2.3.cmml"><mi id="S5.E6.m1.6.6.4.5.2.3.2" xref="S5.E6.m1.6.6.4.5.2.3.2.cmml">i</mi><mo id="S5.E6.m1.6.6.4.5.2.3.1" xref="S5.E6.m1.6.6.4.5.2.3.1.cmml">=</mo><mn id="S5.E6.m1.6.6.4.5.2.3.3" xref="S5.E6.m1.6.6.4.5.2.3.3.cmml">1</mn></mrow><mi id="S5.E6.m1.6.6.4.5.3" xref="S5.E6.m1.6.6.4.5.3.cmml">N</mi></msubsup><mrow id="S5.E6.m1.6.6.4.6" xref="S5.E6.m1.6.6.4.6.cmml"><msub id="S5.E6.m1.6.6.4.6.2" xref="S5.E6.m1.6.6.4.6.2.cmml"><mi id="S5.E6.m1.6.6.4.6.2.2" xref="S5.E6.m1.6.6.4.6.2.2.cmml">n</mi><mi id="S5.E6.m1.6.6.4.6.2.3" xref="S5.E6.m1.6.6.4.6.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S5.E6.m1.6.6.4.6.1" xref="S5.E6.m1.6.6.4.6.1.cmml">​</mo><msubsup id="S5.E6.m1.6.6.4.6.3" xref="S5.E6.m1.6.6.4.6.3.cmml"><mi id="S5.E6.m1.6.6.4.6.3.2.2" xref="S5.E6.m1.6.6.4.6.3.2.2.cmml">W</mi><mrow id="S5.E6.m1.4.4.2.2.2.4" xref="S5.E6.m1.4.4.2.2.2.3.cmml"><mi id="S5.E6.m1.3.3.1.1.1.1" xref="S5.E6.m1.3.3.1.1.1.1.cmml">l</mi><mo id="S5.E6.m1.4.4.2.2.2.4.1" xref="S5.E6.m1.4.4.2.2.2.3.cmml">,</mo><mi id="S5.E6.m1.4.4.2.2.2.2" xref="S5.E6.m1.4.4.2.2.2.2.cmml">b</mi></mrow><mrow id="S5.E6.m1.6.6.4.4.2.2" xref="S5.E6.m1.6.6.4.4.2.3.cmml"><mrow id="S5.E6.m1.6.6.4.4.2.2.1" xref="S5.E6.m1.6.6.4.4.2.2.1.cmml"><mi id="S5.E6.m1.6.6.4.4.2.2.1.2" xref="S5.E6.m1.6.6.4.4.2.2.1.2.cmml">t</mi><mo id="S5.E6.m1.6.6.4.4.2.2.1.1" xref="S5.E6.m1.6.6.4.4.2.2.1.1.cmml">+</mo><mn id="S5.E6.m1.6.6.4.4.2.2.1.3" xref="S5.E6.m1.6.6.4.4.2.2.1.3.cmml">1</mn></mrow><mo id="S5.E6.m1.6.6.4.4.2.2.2" xref="S5.E6.m1.6.6.4.4.2.3.cmml">,</mo><mi id="S5.E6.m1.5.5.3.3.1.1" xref="S5.E6.m1.5.5.3.3.1.1.cmml">i</mi></mrow></msubsup></mrow></mrow><mrow id="S5.E6.m1.6.6.6" xref="S5.E6.m1.6.6.6.cmml"><msubsup id="S5.E6.m1.6.6.6.1" xref="S5.E6.m1.6.6.6.1.cmml"><mo id="S5.E6.m1.6.6.6.1.2.2" xref="S5.E6.m1.6.6.6.1.2.2.cmml">∑</mo><mrow id="S5.E6.m1.6.6.6.1.2.3" xref="S5.E6.m1.6.6.6.1.2.3.cmml"><mi id="S5.E6.m1.6.6.6.1.2.3.2" xref="S5.E6.m1.6.6.6.1.2.3.2.cmml">j</mi><mo id="S5.E6.m1.6.6.6.1.2.3.1" xref="S5.E6.m1.6.6.6.1.2.3.1.cmml">=</mo><mn id="S5.E6.m1.6.6.6.1.2.3.3" xref="S5.E6.m1.6.6.6.1.2.3.3.cmml">1</mn></mrow><mi id="S5.E6.m1.6.6.6.1.3" xref="S5.E6.m1.6.6.6.1.3.cmml">N</mi></msubsup><msub id="S5.E6.m1.6.6.6.2" xref="S5.E6.m1.6.6.6.2.cmml"><mi id="S5.E6.m1.6.6.6.2.2" xref="S5.E6.m1.6.6.6.2.2.cmml">n</mi><mi id="S5.E6.m1.6.6.6.2.3" xref="S5.E6.m1.6.6.6.2.3.cmml">j</mi></msub></mrow></mfrac></mrow><mo lspace="0em" id="S5.E6.m1.7.7.1.2" xref="S5.E6.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E6.m1.7b"><apply id="S5.E6.m1.7.7.1.1.cmml" xref="S5.E6.m1.7.7.1"><eq id="S5.E6.m1.7.7.1.1.1.cmml" xref="S5.E6.m1.7.7.1.1.1"></eq><apply id="S5.E6.m1.7.7.1.1.2.cmml" xref="S5.E6.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S5.E6.m1.7.7.1.1.2.1.cmml" xref="S5.E6.m1.7.7.1.1.2">superscript</csymbol><apply id="S5.E6.m1.7.7.1.1.2.2.cmml" xref="S5.E6.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S5.E6.m1.7.7.1.1.2.2.1.cmml" xref="S5.E6.m1.7.7.1.1.2">subscript</csymbol><ci id="S5.E6.m1.7.7.1.1.2.2.2.cmml" xref="S5.E6.m1.7.7.1.1.2.2.2">𝑊</ci><list id="S5.E6.m1.2.2.2.3.cmml" xref="S5.E6.m1.2.2.2.4"><ci id="S5.E6.m1.1.1.1.1.cmml" xref="S5.E6.m1.1.1.1.1">𝑙</ci><ci id="S5.E6.m1.2.2.2.2.cmml" xref="S5.E6.m1.2.2.2.2">𝑏</ci></list></apply><apply id="S5.E6.m1.7.7.1.1.2.3.cmml" xref="S5.E6.m1.7.7.1.1.2.3"><plus id="S5.E6.m1.7.7.1.1.2.3.1.cmml" xref="S5.E6.m1.7.7.1.1.2.3.1"></plus><ci id="S5.E6.m1.7.7.1.1.2.3.2.cmml" xref="S5.E6.m1.7.7.1.1.2.3.2">𝑡</ci><cn type="integer" id="S5.E6.m1.7.7.1.1.2.3.3.cmml" xref="S5.E6.m1.7.7.1.1.2.3.3">1</cn></apply></apply><apply id="S5.E6.m1.6.6.cmml" xref="S5.E6.m1.6.6"><divide id="S5.E6.m1.6.6.5.cmml" xref="S5.E6.m1.6.6"></divide><apply id="S5.E6.m1.6.6.4.cmml" xref="S5.E6.m1.6.6.4"><apply id="S5.E6.m1.6.6.4.5.cmml" xref="S5.E6.m1.6.6.4.5"><csymbol cd="ambiguous" id="S5.E6.m1.6.6.4.5.1.cmml" xref="S5.E6.m1.6.6.4.5">superscript</csymbol><apply id="S5.E6.m1.6.6.4.5.2.cmml" xref="S5.E6.m1.6.6.4.5"><csymbol cd="ambiguous" id="S5.E6.m1.6.6.4.5.2.1.cmml" xref="S5.E6.m1.6.6.4.5">subscript</csymbol><sum id="S5.E6.m1.6.6.4.5.2.2.cmml" xref="S5.E6.m1.6.6.4.5.2.2"></sum><apply id="S5.E6.m1.6.6.4.5.2.3.cmml" xref="S5.E6.m1.6.6.4.5.2.3"><eq id="S5.E6.m1.6.6.4.5.2.3.1.cmml" xref="S5.E6.m1.6.6.4.5.2.3.1"></eq><ci id="S5.E6.m1.6.6.4.5.2.3.2.cmml" xref="S5.E6.m1.6.6.4.5.2.3.2">𝑖</ci><cn type="integer" id="S5.E6.m1.6.6.4.5.2.3.3.cmml" xref="S5.E6.m1.6.6.4.5.2.3.3">1</cn></apply></apply><ci id="S5.E6.m1.6.6.4.5.3.cmml" xref="S5.E6.m1.6.6.4.5.3">𝑁</ci></apply><apply id="S5.E6.m1.6.6.4.6.cmml" xref="S5.E6.m1.6.6.4.6"><times id="S5.E6.m1.6.6.4.6.1.cmml" xref="S5.E6.m1.6.6.4.6.1"></times><apply id="S5.E6.m1.6.6.4.6.2.cmml" xref="S5.E6.m1.6.6.4.6.2"><csymbol cd="ambiguous" id="S5.E6.m1.6.6.4.6.2.1.cmml" xref="S5.E6.m1.6.6.4.6.2">subscript</csymbol><ci id="S5.E6.m1.6.6.4.6.2.2.cmml" xref="S5.E6.m1.6.6.4.6.2.2">𝑛</ci><ci id="S5.E6.m1.6.6.4.6.2.3.cmml" xref="S5.E6.m1.6.6.4.6.2.3">𝑖</ci></apply><apply id="S5.E6.m1.6.6.4.6.3.cmml" xref="S5.E6.m1.6.6.4.6.3"><csymbol cd="ambiguous" id="S5.E6.m1.6.6.4.6.3.1.cmml" xref="S5.E6.m1.6.6.4.6.3">superscript</csymbol><apply id="S5.E6.m1.6.6.4.6.3.2.cmml" xref="S5.E6.m1.6.6.4.6.3"><csymbol cd="ambiguous" id="S5.E6.m1.6.6.4.6.3.2.1.cmml" xref="S5.E6.m1.6.6.4.6.3">subscript</csymbol><ci id="S5.E6.m1.6.6.4.6.3.2.2.cmml" xref="S5.E6.m1.6.6.4.6.3.2.2">𝑊</ci><list id="S5.E6.m1.4.4.2.2.2.3.cmml" xref="S5.E6.m1.4.4.2.2.2.4"><ci id="S5.E6.m1.3.3.1.1.1.1.cmml" xref="S5.E6.m1.3.3.1.1.1.1">𝑙</ci><ci id="S5.E6.m1.4.4.2.2.2.2.cmml" xref="S5.E6.m1.4.4.2.2.2.2">𝑏</ci></list></apply><list id="S5.E6.m1.6.6.4.4.2.3.cmml" xref="S5.E6.m1.6.6.4.4.2.2"><apply id="S5.E6.m1.6.6.4.4.2.2.1.cmml" xref="S5.E6.m1.6.6.4.4.2.2.1"><plus id="S5.E6.m1.6.6.4.4.2.2.1.1.cmml" xref="S5.E6.m1.6.6.4.4.2.2.1.1"></plus><ci id="S5.E6.m1.6.6.4.4.2.2.1.2.cmml" xref="S5.E6.m1.6.6.4.4.2.2.1.2">𝑡</ci><cn type="integer" id="S5.E6.m1.6.6.4.4.2.2.1.3.cmml" xref="S5.E6.m1.6.6.4.4.2.2.1.3">1</cn></apply><ci id="S5.E6.m1.5.5.3.3.1.1.cmml" xref="S5.E6.m1.5.5.3.3.1.1">𝑖</ci></list></apply></apply></apply><apply id="S5.E6.m1.6.6.6.cmml" xref="S5.E6.m1.6.6.6"><apply id="S5.E6.m1.6.6.6.1.cmml" xref="S5.E6.m1.6.6.6.1"><csymbol cd="ambiguous" id="S5.E6.m1.6.6.6.1.1.cmml" xref="S5.E6.m1.6.6.6.1">superscript</csymbol><apply id="S5.E6.m1.6.6.6.1.2.cmml" xref="S5.E6.m1.6.6.6.1"><csymbol cd="ambiguous" id="S5.E6.m1.6.6.6.1.2.1.cmml" xref="S5.E6.m1.6.6.6.1">subscript</csymbol><sum id="S5.E6.m1.6.6.6.1.2.2.cmml" xref="S5.E6.m1.6.6.6.1.2.2"></sum><apply id="S5.E6.m1.6.6.6.1.2.3.cmml" xref="S5.E6.m1.6.6.6.1.2.3"><eq id="S5.E6.m1.6.6.6.1.2.3.1.cmml" xref="S5.E6.m1.6.6.6.1.2.3.1"></eq><ci id="S5.E6.m1.6.6.6.1.2.3.2.cmml" xref="S5.E6.m1.6.6.6.1.2.3.2">𝑗</ci><cn type="integer" id="S5.E6.m1.6.6.6.1.2.3.3.cmml" xref="S5.E6.m1.6.6.6.1.2.3.3">1</cn></apply></apply><ci id="S5.E6.m1.6.6.6.1.3.cmml" xref="S5.E6.m1.6.6.6.1.3">𝑁</ci></apply><apply id="S5.E6.m1.6.6.6.2.cmml" xref="S5.E6.m1.6.6.6.2"><csymbol cd="ambiguous" id="S5.E6.m1.6.6.6.2.1.cmml" xref="S5.E6.m1.6.6.6.2">subscript</csymbol><ci id="S5.E6.m1.6.6.6.2.2.cmml" xref="S5.E6.m1.6.6.6.2.2">𝑛</ci><ci id="S5.E6.m1.6.6.6.2.3.cmml" xref="S5.E6.m1.6.6.6.2.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E6.m1.7c">W_{l,b}^{t+1}=\frac{\sum_{i=1}^{N}n_{i}W_{l,b}^{t+1,i}}{\sum_{j=1}^{N}n_{j}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S5.T1.5.2.1" class="ltx_text" style="font-size:90%;">TABLE I</span>: </span><span id="S5.T1.2.1" class="ltx_text" style="font-size:90%;">The mean test accuracy (%) among 10 clients grouped into 5 pairs using CIFAR10. Each method includes local fine-tuning for local epochs <math id="S5.T1.2.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.T1.2.1.m1.1b"><mi id="S5.T1.2.1.m1.1.1" xref="S5.T1.2.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.T1.2.1.m1.1c"><ci id="S5.T1.2.1.m1.1.1.cmml" xref="S5.T1.2.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.1.m1.1d">E</annotation></semantics></math>.</span></figcaption>
<table id="S5.T1.3.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T1.3.1.2.1" class="ltx_tr">
<td id="S5.T1.3.1.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" rowspan="2"><span id="S5.T1.3.1.2.1.1.1" class="ltx_text">Local</span></td>
<td id="S5.T1.3.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="2"><span id="S5.T1.3.1.2.1.2.1" class="ltx_text">FedAvg</span></td>
<td id="S5.T1.3.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">pFedMB</td>
<td id="S5.T1.3.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="2"><span id="S5.T1.3.1.2.1.4.1" class="ltx_text">pFedMB</span></td>
</tr>
<tr id="S5.T1.3.1.1" class="ltx_tr">
<td id="S5.T1.3.1.1.1" class="ltx_td ltx_align_center ltx_border_r">(w/o <math id="S5.T1.3.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.T1.3.1.1.1.m1.1a"><mi id="S5.T1.3.1.1.1.m1.1.1" xref="S5.T1.3.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.T1.3.1.1.1.m1.1b"><ci id="S5.T1.3.1.1.1.m1.1.1.cmml" xref="S5.T1.3.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.3.1.1.1.m1.1c">\alpha</annotation></semantics></math>-weighted avg.)</td>
</tr>
<tr id="S5.T1.3.1.3.2" class="ltx_tr">
<td id="S5.T1.3.1.3.2.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_tt">87.26</td>
<td id="S5.T1.3.1.3.2.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_tt">87.99</td>
<td id="S5.T1.3.1.3.2.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_tt">89.08</td>
<td id="S5.T1.3.1.3.2.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_tt"><span id="S5.T1.3.1.3.2.4.1" class="ltx_text ltx_font_bold">89.49</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.F4" class="ltx_figure">
<p id="S5.F4.1" class="ltx_p ltx_align_center"><span id="S5.F4.1.1" class="ltx_text"><img src="/html/2211.07931/assets/communication_rounds3.png" id="S5.F4.1.1.g1" class="ltx_graphics ltx_img_landscape" width="538" height="364" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.4.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S5.F4.5.2" class="ltx_text" style="font-size:90%;color:#000000;">The mean test accuracy among 10 clients grouped into 5 pairs at each communication round using CIFAR10. Each method will be followed by local fine-tuning.</span></figcaption>
</figure>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S5.T2.4.2.1" class="ltx_text" style="font-size:90%;">TABLE II</span>: </span><span id="S5.T2.2.1" class="ltx_text" style="font-size:90%;">The mean test accuracy (%) among 15 clients and 50 clients in random 2 classes and Dirichlet distribution settings using CIFAR10. Client participation rate at each communication round is 100% and 20%, respectively. Each method includes local fine-tuning for local epochs <math id="S5.T2.2.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.T2.2.1.m1.1b"><mi id="S5.T2.2.1.m1.1.1" xref="S5.T2.2.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.T2.2.1.m1.1c"><ci id="S5.T2.2.1.m1.1.1.cmml" xref="S5.T2.2.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.1.m1.1d">E</annotation></semantics></math>. “Local” is a non-federated local learning.</span></figcaption>
<table id="S5.T2.5" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T2.5.1.1" class="ltx_tr">
<th id="S5.T2.5.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" rowspan="4"><span id="S5.T2.5.1.1.1.1" class="ltx_text ltx_font_bold">Methods</span></th>
<td id="S5.T2.5.1.1.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="4"><span id="S5.T2.5.1.1.2.1" class="ltx_text ltx_font_bold">CIFAR10</span></td>
<td id="S5.T2.5.1.1.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="2"><span id="S5.T2.5.1.1.3.1" class="ltx_text ltx_font_bold">CIFAR100</span></td>
</tr>
<tr id="S5.T2.5.2.2" class="ltx_tr">
<td id="S5.T2.5.2.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="2" rowspan="2"><span id="S5.T2.5.2.2.1.1" class="ltx_text ltx_font_bold">Random 2 classes</span></td>
<td id="S5.T2.5.2.2.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="2" rowspan="2"><span id="S5.T2.5.2.2.2.1" class="ltx_text ltx_font_bold">Dirichlet</span></td>
<td id="S5.T2.5.2.2.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="2"><span id="S5.T2.5.2.2.3.1" class="ltx_text ltx_font_bold">Random 20 classes</span></td>
</tr>
<tr id="S5.T2.5.3.3" class="ltx_tr">
<td id="S5.T2.5.3.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r" colspan="2"><span id="S5.T2.5.3.3.1.1" class="ltx_text ltx_font_bold">with different size</span></td>
</tr>
<tr id="S5.T2.5.4.4" class="ltx_tr">
<td id="S5.T2.5.4.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">  15 clients</td>
<td id="S5.T2.5.4.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"> 50 clients</td>
<td id="S5.T2.5.4.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"> 15 clients</td>
<td id="S5.T2.5.4.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"> 50 clients</td>
<td id="S5.T2.5.4.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"> 15 clients</td>
<td id="S5.T2.5.4.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"> 50 clients</td>
</tr>
<tr id="S5.T2.5.5.5" class="ltx_tr">
<th id="S5.T2.5.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_tt">Local</th>
<td id="S5.T2.5.5.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"> 90.01</td>
<td id="S5.T2.5.5.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"> 83.79</td>
<td id="S5.T2.5.5.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"> 67.54</td>
<td id="S5.T2.5.5.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"> 61.27</td>
<td id="S5.T2.5.5.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"> 39.10</td>
<td id="S5.T2.5.5.5.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"> 29.42</td>
</tr>
<tr id="S5.T2.5.6.6" class="ltx_tr">
<th id="S5.T2.5.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
</th>
<td id="S5.T2.5.6.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">89.69</td>
<td id="S5.T2.5.6.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">85.68</td>
<td id="S5.T2.5.6.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">73.52</td>
<td id="S5.T2.5.6.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">70.32</td>
<td id="S5.T2.5.6.6.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">43.49</td>
<td id="S5.T2.5.6.6.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">38.53</td>
</tr>
<tr id="S5.T2.5.7.7" class="ltx_tr">
<th id="S5.T2.5.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>
</th>
<td id="S5.T2.5.7.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">90.51</td>
<td id="S5.T2.5.7.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">86.07</td>
<td id="S5.T2.5.7.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">73.38</td>
<td id="S5.T2.5.7.7.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">70.98</td>
<td id="S5.T2.5.7.7.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">44.81</td>
<td id="S5.T2.5.7.7.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">36.07</td>
</tr>
<tr id="S5.T2.5.8.8" class="ltx_tr">
<th id="S5.T2.5.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">FedPer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>
</th>
<td id="S5.T2.5.8.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">89.73</td>
<td id="S5.T2.5.8.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">84.56</td>
<td id="S5.T2.5.8.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">71.97</td>
<td id="S5.T2.5.8.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">67.57</td>
<td id="S5.T2.5.8.8.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">41.52</td>
<td id="S5.T2.5.8.8.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">29.67</td>
</tr>
<tr id="S5.T2.5.9.9" class="ltx_tr">
<th id="S5.T2.5.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">pFedMe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>
</th>
<td id="S5.T2.5.9.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">90.04</td>
<td id="S5.T2.5.9.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">83.09</td>
<td id="S5.T2.5.9.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">72.92</td>
<td id="S5.T2.5.9.9.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">71.00</td>
<td id="S5.T2.5.9.9.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T2.5.9.9.6.1" class="ltx_text ltx_font_bold">45.57</span></td>
<td id="S5.T2.5.9.9.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">39.04</td>
</tr>
<tr id="S5.T2.5.10.10" class="ltx_tr">
<th id="S5.T2.5.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">IFCA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>
</th>
<td id="S5.T2.5.10.10.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">90.17</td>
<td id="S5.T2.5.10.10.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">85.68</td>
<td id="S5.T2.5.10.10.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">72.42</td>
<td id="S5.T2.5.10.10.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">69.84</td>
<td id="S5.T2.5.10.10.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">41.46</td>
<td id="S5.T2.5.10.10.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">35.01</td>
</tr>
<tr id="S5.T2.5.11.11" class="ltx_tr">
<th id="S5.T2.5.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">FedFomo <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>
</th>
<td id="S5.T2.5.11.11.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">90.12</td>
<td id="S5.T2.5.11.11.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">85.01</td>
<td id="S5.T2.5.11.11.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">67.55</td>
<td id="S5.T2.5.11.11.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">62.62</td>
<td id="S5.T2.5.11.11.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">38.19</td>
<td id="S5.T2.5.11.11.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">28.18</td>
</tr>
<tr id="S5.T2.5.12.12" class="ltx_tr">
<th id="S5.T2.5.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">FedAmp <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>
</th>
<td id="S5.T2.5.12.12.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T2.5.12.12.2.1" class="ltx_text ltx_font_bold">90.73</span></td>
<td id="S5.T2.5.12.12.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">85.90</td>
<td id="S5.T2.5.12.12.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">72.91</td>
<td id="S5.T2.5.12.12.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">65.98</td>
<td id="S5.T2.5.12.12.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">41.27</td>
<td id="S5.T2.5.12.12.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">29.53</td>
</tr>
<tr id="S5.T2.5.13.13" class="ltx_tr">
<th id="S5.T2.5.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t">pFedMB (ours)</th>
<td id="S5.T2.5.13.13.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">90.69</td>
<td id="S5.T2.5.13.13.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S5.T2.5.13.13.3.1" class="ltx_text ltx_font_bold">86.73</span></td>
<td id="S5.T2.5.13.13.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S5.T2.5.13.13.4.1" class="ltx_text ltx_font_bold">73.53</span></td>
<td id="S5.T2.5.13.13.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S5.T2.5.13.13.5.1" class="ltx_text ltx_font_bold">72.14</span></td>
<td id="S5.T2.5.13.13.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">44.73</td>
<td id="S5.T2.5.13.13.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S5.T2.5.13.13.7.1" class="ltx_text ltx_font_bold">39.78</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p">Table <a href="#S5.T1" title="TABLE I ‣ V-B Process of personalization ‣ V EXPERIMENTS ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> shows the mean test accuracy for each method. First, from Table <a href="#S5.T1" title="TABLE I ‣ V-B Process of personalization ‣ V EXPERIMENTS ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>, we can see that pFedMB improves FedAvg and <math id="S5.SS2.p2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.p2.1.m1.1a"><mi id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><ci id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">\alpha</annotation></semantics></math>-weighted averaging is effective in the perspective of accuracy.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.9" class="ltx_p">Next, the process of getting the optimal <math id="S5.SS2.p3.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.p3.1.m1.1a"><mi id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.1b"><ci id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.1c">\alpha</annotation></semantics></math> for each client is visualized in Fig. <a href="#S5.F3" title="Figure 3 ‣ V EXPERIMENTS ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, <a href="#S5.F3" title="Figure 3 ‣ V EXPERIMENTS ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, each of which is the result of pFedMB with/without <math id="S5.SS2.p3.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.p3.2.m2.1a"><mi id="S5.SS2.p3.2.m2.1.1" xref="S5.SS2.p3.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.2.m2.1b"><ci id="S5.SS2.p3.2.m2.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.2.m2.1c">\alpha</annotation></semantics></math>-weighted averaging, respectively. Fig. <a href="#S5.F3" title="Figure 3 ‣ V EXPERIMENTS ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows that every pair of clients who have the same classes gets almost the same <math id="S5.SS2.p3.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.p3.3.m3.1a"><mi id="S5.SS2.p3.3.m3.1.1" xref="S5.SS2.p3.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.3.m3.1b"><ci id="S5.SS2.p3.3.m3.1.1.cmml" xref="S5.SS2.p3.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.3.m3.1c">\alpha</annotation></semantics></math> and different pairs of clients focus on different branches. From this result, we can see that pFedMB with <math id="S5.SS2.p3.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.p3.4.m4.1a"><mi id="S5.SS2.p3.4.m4.1.1" xref="S5.SS2.p3.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.4.m4.1b"><ci id="S5.SS2.p3.4.m4.1.1.cmml" xref="S5.SS2.p3.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.4.m4.1c">\alpha</annotation></semantics></math>-weighted averaging achieves personalization by facilitating similar clients to collaborate more. In contrast, in pFedMB without <math id="S5.SS2.p3.5.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.p3.5.m5.1a"><mi id="S5.SS2.p3.5.m5.1.1" xref="S5.SS2.p3.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.5.m5.1b"><ci id="S5.SS2.p3.5.m5.1.1.cmml" xref="S5.SS2.p3.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.5.m5.1c">\alpha</annotation></semantics></math>-weighted averaging, the clients are clustered slowly, which results in different pairs of clients concentrating on the same branch. This leads to inefficient collaborating. <span id="S5.SS2.p3.8.3" class="ltx_text" style="color:#000000;">Fig. <a href="#S5.F4" title="Figure 4 ‣ V-B Process of personalization ‣ V EXPERIMENTS ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows that <math id="S5.SS2.p3.6.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.p3.6.1.m1.1a"><mi mathcolor="#000000" id="S5.SS2.p3.6.1.m1.1.1" xref="S5.SS2.p3.6.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.6.1.m1.1b"><ci id="S5.SS2.p3.6.1.m1.1.1.cmml" xref="S5.SS2.p3.6.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.6.1.m1.1c">\alpha</annotation></semantics></math>-weighted averaging is also effective in terms of communication efficiency. Fig. <a href="#S5.F4" title="Figure 4 ‣ V-B Process of personalization ‣ V EXPERIMENTS ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> presents the test accuracy at each communication round. pFedMB with <math id="S5.SS2.p3.7.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.p3.7.2.m2.1a"><mi mathcolor="#000000" id="S5.SS2.p3.7.2.m2.1.1" xref="S5.SS2.p3.7.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.7.2.m2.1b"><ci id="S5.SS2.p3.7.2.m2.1.1.cmml" xref="S5.SS2.p3.7.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.7.2.m2.1c">\alpha</annotation></semantics></math>-weighted averaging is clearly faster to convergence than pFedMB without <math id="S5.SS2.p3.8.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.p3.8.3.m3.1a"><mi mathcolor="#000000" id="S5.SS2.p3.8.3.m3.1.1" xref="S5.SS2.p3.8.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.8.3.m3.1b"><ci id="S5.SS2.p3.8.3.m3.1.1.cmml" xref="S5.SS2.p3.8.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.8.3.m3.1c">\alpha</annotation></semantics></math>-weighted averaging as well as FedAvg, that is, reduces communication cost.</span> Therefore, it is revealed that <math id="S5.SS2.p3.9.m6.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.p3.9.m6.1a"><mi id="S5.SS2.p3.9.m6.1.1" xref="S5.SS2.p3.9.m6.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.9.m6.1b"><ci id="S5.SS2.p3.9.m6.1.1.cmml" xref="S5.SS2.p3.9.m6.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.9.m6.1c">\alpha</annotation></semantics></math>-weighted averaging (<a href="#S4.E5" title="In IV-B Algorithm ‣ IV PROPOSED METHOD ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) is effective to promote collaboration among similar clients, which leads to good performance for each client<span id="S5.SS2.p3.9.4" class="ltx_text" style="color:#000000;"> and fast convergence</span>.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS3.4.1.1" class="ltx_text">V-C</span> </span><span id="S5.SS3.5.2" class="ltx_text ltx_font_italic">Performance comparison</span>
</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">Table <a href="#S5.T2" title="TABLE II ‣ V-B Process of personalization ‣ V EXPERIMENTS ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> shows the performance comparison of pFedMB and the other PFL methods in six settings. We can see that pFedMB is the best in almost all the settings. Even in 15 clients with random 2 classes setting using CIFAR10 <span id="S5.SS3.p1.1.1" class="ltx_text" style="color:#000000;">and 15 clients setting using CIFAR100</span>, pFedMB is comparable to the best methods FedAMP <span id="S5.SS3.p1.1.2" class="ltx_text" style="color:#000000;">and pFedMe, respectively</span>. We note that FedAvg and FedProx, originally not personalized FL methods also perform well especially in random 2 classes distribution setting using CIFAR10. It is because in our experiments, all the methods include local fine-tuning. That is, local fine-tuning has enough personalization power especially in a simple setting where each client has only 2 classes, which is a fact not often pointed out in the previous studies. It is also worth noting that the state-of-the-art methods such as FedAMP and FedFomo do not perform well <span id="S5.SS3.p1.1.3" class="ltx_text" style="color:#000000;">except in random 2 classes distribution setting using CIFAR10</span>. As mentioned in the introduction, this is probably because the similarity calculation between clients does not work well when each client’s data is sampled from a complex distribution such as Dirichlet distribution <span id="S5.SS3.p1.1.4" class="ltx_text" style="color:#000000;">and random 20 classes with different size</span>. In contrast, pFedMB, which does not directly calculate the similarity, shows good performance in both distribution settings. In other words, pFedMB is the most balanced method that is effective in every setting.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS4.4.1.1" class="ltx_text">V-D</span> </span><span id="S5.SS4.5.2" class="ltx_text ltx_font_italic" style="color:#000000;">Effects of number of branches</span>
</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.1" class="ltx_p"><span id="S5.SS4.p1.1.1" class="ltx_text" style="color:#000000;">We next investigate the effects of number of branches on the performance of pFedMB. Table <a href="#S5.T3" title="TABLE III ‣ V-D Effects of number of branches ‣ V EXPERIMENTS ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a> shows tuned number of branches of pFedMB in each experimental setting. From Table <a href="#S5.T3" title="TABLE III ‣ V-D Effects of number of branches ‣ V EXPERIMENTS ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>, we can see that the required number of branches is at most 10. Unlike CIFAR10, CIFAR100 has a larger number of classes, and therefore the number of classes shared among clients when using CIFAR100 is larger, which results in fewer branches. Therefore, in the random 2 classes and 50 clients setting using CIFAR10, where the required branches is large, we see the effect of number of branches. In Fig. <a href="#S5.F5" title="Figure 5 ‣ V-D Effects of number of branches ‣ V EXPERIMENTS ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, the number of branches of pFedMB is changed from 2 to 20. The test accuracy increases with the number of branches, reaching a peak at 10 and then decreasing with the number of branches. Therefore, when using pFedMB, it is necessary to find the peak number of branches by fine-tuning.
</span></p>
</div>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S5.T3.3.1.1" class="ltx_text" style="font-size:90%;">TABLE III</span>: </span><span id="S5.T3.4.2" class="ltx_text" style="font-size:90%;color:#000000;">Tuned number of branches of pFedMB in each experimental setting.</span></figcaption>
<table id="S5.T3.5" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.5.1.1" class="ltx_tr">
<th id="S5.T3.5.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="3"><span id="S5.T3.5.1.1.1.1" class="ltx_text ltx_font_bold">Settings</span></th>
<th id="S5.T3.5.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T3.5.1.1.2.1" class="ltx_text ltx_font_bold"># of branches</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.5.2.1" class="ltx_tr">
<td id="S5.T3.5.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt" rowspan="4"><span id="S5.T3.5.2.1.1.1" class="ltx_text">CIFAR10</span></td>
<td id="S5.T3.5.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" rowspan="2"><span id="S5.T3.5.2.1.2.1" class="ltx_text">Random 2 classes</span></td>
<td id="S5.T3.5.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">15 clients</td>
<td id="S5.T3.5.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">6</td>
</tr>
<tr id="S5.T3.5.3.2" class="ltx_tr">
<td id="S5.T3.5.3.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">50 clients</td>
<td id="S5.T3.5.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">10</td>
</tr>
<tr id="S5.T3.5.4.3" class="ltx_tr">
<td id="S5.T3.5.4.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="2"><span id="S5.T3.5.4.3.1.1" class="ltx_text">Dirichlet</span></td>
<td id="S5.T3.5.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">15 clients</td>
<td id="S5.T3.5.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">7</td>
</tr>
<tr id="S5.T3.5.5.4" class="ltx_tr">
<td id="S5.T3.5.5.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">50 clients</td>
<td id="S5.T3.5.5.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">6</td>
</tr>
<tr id="S5.T3.5.6.5" class="ltx_tr">
<td id="S5.T3.5.6.5.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" rowspan="2"><span id="S5.T3.5.6.5.1.1" class="ltx_text">CIFAR100</span></td>
<td id="S5.T3.5.6.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Random 20 classes</td>
<td id="S5.T3.5.6.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">15 clients</td>
<td id="S5.T3.5.6.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3</td>
</tr>
<tr id="S5.T3.5.7.6" class="ltx_tr">
<td id="S5.T3.5.7.6.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">with different size</td>
<td id="S5.T3.5.7.6.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">50 clients</td>
<td id="S5.T3.5.7.6.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">3</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.F5" class="ltx_figure">
<p id="S5.F5.1" class="ltx_p ltx_align_center"><span id="S5.F5.1.1" class="ltx_text"><img src="/html/2211.07931/assets/branches2.png" id="S5.F5.1.1.g1" class="ltx_graphics ltx_img_landscape" width="538" height="263" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F5.4.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S5.F5.5.2" class="ltx_text" style="font-size:90%;color:#000000;">Variation of the mean test accuracy among 50 clients in the random 2 classes distribution setting using CIFAR10 with respect to the number of branches.</span></figcaption>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">DISCUSSIONS</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.5" class="ltx_p">We first discuss the communication and computation costs of pFedMB. The communication and computation overheads are determined by the number of branches <math id="S6.p1.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S6.p1.1.m1.1a"><mi id="S6.p1.1.m1.1.1" xref="S6.p1.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S6.p1.1.m1.1b"><ci id="S6.p1.1.m1.1.1.cmml" xref="S6.p1.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.1.m1.1c">B</annotation></semantics></math>. Let <math id="S6.p1.2.m2.1" class="ltx_Math" alttext="P" display="inline"><semantics id="S6.p1.2.m2.1a"><mi id="S6.p1.2.m2.1.1" xref="S6.p1.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S6.p1.2.m2.1b"><ci id="S6.p1.2.m2.1.1.cmml" xref="S6.p1.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.2.m2.1c">P</annotation></semantics></math> be the number of model parameters used in the traditional FL methods, e.g., FedAvg. If pFedMB splits every layer into <math id="S6.p1.3.m3.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S6.p1.3.m3.1a"><mi id="S6.p1.3.m3.1.1" xref="S6.p1.3.m3.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S6.p1.3.m3.1b"><ci id="S6.p1.3.m3.1.1.cmml" xref="S6.p1.3.m3.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.3.m3.1c">B</annotation></semantics></math> branches, the number of model parameters increases to <math id="S6.p1.4.m4.1" class="ltx_Math" alttext="B\times P" display="inline"><semantics id="S6.p1.4.m4.1a"><mrow id="S6.p1.4.m4.1.1" xref="S6.p1.4.m4.1.1.cmml"><mi id="S6.p1.4.m4.1.1.2" xref="S6.p1.4.m4.1.1.2.cmml">B</mi><mo lspace="0.222em" rspace="0.222em" id="S6.p1.4.m4.1.1.1" xref="S6.p1.4.m4.1.1.1.cmml">×</mo><mi id="S6.p1.4.m4.1.1.3" xref="S6.p1.4.m4.1.1.3.cmml">P</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.p1.4.m4.1b"><apply id="S6.p1.4.m4.1.1.cmml" xref="S6.p1.4.m4.1.1"><times id="S6.p1.4.m4.1.1.1.cmml" xref="S6.p1.4.m4.1.1.1"></times><ci id="S6.p1.4.m4.1.1.2.cmml" xref="S6.p1.4.m4.1.1.2">𝐵</ci><ci id="S6.p1.4.m4.1.1.3.cmml" xref="S6.p1.4.m4.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.4.m4.1c">B\times P</annotation></semantics></math>. Therefore, the communication and computation costs of pFedMB are <math id="S6.p1.5.m5.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S6.p1.5.m5.1a"><mi id="S6.p1.5.m5.1.1" xref="S6.p1.5.m5.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S6.p1.5.m5.1b"><ci id="S6.p1.5.m5.1.1.cmml" xref="S6.p1.5.m5.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.5.m5.1c">B</annotation></semantics></math> times those of FedAvg. Those costs can be reduced by limiting the number of layers to be branched or by stopping both training and communicating the branches that are assigned small client-specific weights per clients (because these branches are not important to the corresponding client). As mentioned in Section <a href="#S4.SS1" title="IV-A Architecture ‣ IV PROPOSED METHOD ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-A</span></span></a>, the computation cost of pFedMB during inference is the same as FedAvg.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.3" class="ltx_p">Given the communication and computation bottlenecks of pFedMB, the question arises how many branches are needed. The obvious upper limit is the number of clients. This is because if the number of branches is greater than the number of clients, there is no point in collaboration among clients, and local learning is sufficient. If the clients are clustered into some groups, as in the experiment of Section <a href="#S5.SS2" title="V-B Process of personalization ‣ V EXPERIMENTS ‣ Personalized Federated Learning with Multi-branch Architecture" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">V-B</span></span></a>, then <math id="S6.p2.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S6.p2.1.m1.1a"><mi id="S6.p2.1.m1.1.1" xref="S6.p2.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S6.p2.1.m1.1b"><ci id="S6.p2.1.m1.1.1.cmml" xref="S6.p2.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.1.m1.1c">B</annotation></semantics></math> should be set to the number of groups. Also, if the data distribution of each client is a mixture of several distributions, <math id="S6.p2.2.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S6.p2.2.m2.1a"><mi id="S6.p2.2.m2.1.1" xref="S6.p2.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S6.p2.2.m2.1b"><ci id="S6.p2.2.m2.1.1.cmml" xref="S6.p2.2.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.2.m2.1c">B</annotation></semantics></math> should be set to the number of underlying distributions. If the exact number cannot be specified in advance, <math id="S6.p2.3.m3.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S6.p2.3.m3.1a"><mi id="S6.p2.3.m3.1.1" xref="S6.p2.3.m3.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S6.p2.3.m3.1b"><ci id="S6.p2.3.m3.1.1.cmml" xref="S6.p2.3.m3.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.3.m3.1c">B</annotation></semantics></math> must be treated as a hyperparameter. In our experiments, the number of branches did not exceed 10 as a result of tuning in any setting.</p>
</div>
<div id="S6.p3" class="ltx_para">
<p id="S6.p3.5" class="ltx_p">We finally discuss the privacy issues for each client. Unlike FedFomo and FedAMP, pFedMB shares the clients’ local models only with the central server, not with other clients or cloud server introduced in FedAMP. This is the benefit of pFedMB. However, as in clustering-based methods, there might be somewhat privacy concern for pfedMB when sending client-spcific weights <math id="S6.p3.1.m1.1" class="ltx_Math" alttext="\alpha^{i}" display="inline"><semantics id="S6.p3.1.m1.1a"><msup id="S6.p3.1.m1.1.1" xref="S6.p3.1.m1.1.1.cmml"><mi id="S6.p3.1.m1.1.1.2" xref="S6.p3.1.m1.1.1.2.cmml">α</mi><mi id="S6.p3.1.m1.1.1.3" xref="S6.p3.1.m1.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S6.p3.1.m1.1b"><apply id="S6.p3.1.m1.1.1.cmml" xref="S6.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S6.p3.1.m1.1.1.1.cmml" xref="S6.p3.1.m1.1.1">superscript</csymbol><ci id="S6.p3.1.m1.1.1.2.cmml" xref="S6.p3.1.m1.1.1.2">𝛼</ci><ci id="S6.p3.1.m1.1.1.3.cmml" xref="S6.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.1.m1.1c">\alpha^{i}</annotation></semantics></math> to the server because <math id="S6.p3.2.m2.1" class="ltx_Math" alttext="\alpha^{i}" display="inline"><semantics id="S6.p3.2.m2.1a"><msup id="S6.p3.2.m2.1.1" xref="S6.p3.2.m2.1.1.cmml"><mi id="S6.p3.2.m2.1.1.2" xref="S6.p3.2.m2.1.1.2.cmml">α</mi><mi id="S6.p3.2.m2.1.1.3" xref="S6.p3.2.m2.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S6.p3.2.m2.1b"><apply id="S6.p3.2.m2.1.1.cmml" xref="S6.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S6.p3.2.m2.1.1.1.cmml" xref="S6.p3.2.m2.1.1">superscript</csymbol><ci id="S6.p3.2.m2.1.1.2.cmml" xref="S6.p3.2.m2.1.1.2">𝛼</ci><ci id="S6.p3.2.m2.1.1.3.cmml" xref="S6.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.2.m2.1c">\alpha^{i}</annotation></semantics></math> contains the information about data distribution for client <math id="S6.p3.3.m3.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S6.p3.3.m3.1a"><msub id="S6.p3.3.m3.1.1" xref="S6.p3.3.m3.1.1.cmml"><mi id="S6.p3.3.m3.1.1.2" xref="S6.p3.3.m3.1.1.2.cmml">C</mi><mi id="S6.p3.3.m3.1.1.3" xref="S6.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S6.p3.3.m3.1b"><apply id="S6.p3.3.m3.1.1.cmml" xref="S6.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S6.p3.3.m3.1.1.1.cmml" xref="S6.p3.3.m3.1.1">subscript</csymbol><ci id="S6.p3.3.m3.1.1.2.cmml" xref="S6.p3.3.m3.1.1.2">𝐶</ci><ci id="S6.p3.3.m3.1.1.3.cmml" xref="S6.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.3.m3.1c">C_{i}</annotation></semantics></math>. Note that <math id="S6.p3.4.m4.1" class="ltx_Math" alttext="\alpha^{i}" display="inline"><semantics id="S6.p3.4.m4.1a"><msup id="S6.p3.4.m4.1.1" xref="S6.p3.4.m4.1.1.cmml"><mi id="S6.p3.4.m4.1.1.2" xref="S6.p3.4.m4.1.1.2.cmml">α</mi><mi id="S6.p3.4.m4.1.1.3" xref="S6.p3.4.m4.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S6.p3.4.m4.1b"><apply id="S6.p3.4.m4.1.1.cmml" xref="S6.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S6.p3.4.m4.1.1.1.cmml" xref="S6.p3.4.m4.1.1">superscript</csymbol><ci id="S6.p3.4.m4.1.1.2.cmml" xref="S6.p3.4.m4.1.1.2">𝛼</ci><ci id="S6.p3.4.m4.1.1.3.cmml" xref="S6.p3.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.4.m4.1c">\alpha^{i}</annotation></semantics></math> does not contain the information about raw data. In real-world systems, we suggest using tools such as secure multiparty computation when conducting <math id="S6.p3.5.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S6.p3.5.m5.1a"><mi id="S6.p3.5.m5.1.1" xref="S6.p3.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S6.p3.5.m5.1b"><ci id="S6.p3.5.m5.1.1.cmml" xref="S6.p3.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.5.m5.1c">\alpha</annotation></semantics></math>-weighted aggregation if needed.</p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VII </span><span id="S7.1.1" class="ltx_text ltx_font_smallcaps">CONCLUSIONS</span>
</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">We proposed a PFL method called <span id="S7.p1.1.1" class="ltx_text ltx_font_italic">personalized federated learning with multi-branch architecture</span> (pFedMB), which achieves personalization by splitting each layer of a neural network into multiple branches and assigning client-specific weights to each branch. We also presented an efficient aggregation method to enable fast convergence and improve the model performance. We numerically showed that pFedMB performs better in both simple and complex data distribution settings than the other state-of-the-art PFL methods, i.e., it is the most balanced PFL method.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y. Arcas,
“Communication-Efficient Learning of Deep Networks from Decentralized
Data,” in <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 20th International Conference on
Artificial Intelligence and Statistics</em>, ser. Proceedings of Machine Learning
Research, vol. 54.   PMLR, 2017, pp.
1273–1282.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Y. Zhao, M. Li, L. Lai, N. Suda, D. Civin, and V. Chandra, “Federated learning
with non-iid data,” <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>, 2018.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
T. Li, A. K. Sahu, A. Talwalkar, and V. Smith, “Federated learning:
Challenges, methods, and future directions,” <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing
Magazine</em>, vol. 37, no. 3, pp. 50–60, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
A. Z. Tan, H. Yu, L. Cui, and Q. Yang, “Towards personalized federated
learning,” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</em>,
pp. 1–17, 2022.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Y. Huang, L. Chu, Z. Zhou, L. Wang, J. Liu, J. Pei, and Y. Zhang,
“Personalized cross-silo federated learning on non-iid data,”
<em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em>,
vol. 35, no. 9, pp. 7865–7873, 2021.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
K. Wang, R. Mathews, C. Kiddon, H. Eichner, F. Beaufays, and D. Ramage,
“Federated evaluation of on-device personalization,” <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:1910.10252</em>, 2019.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Y. Mansour, M. Mohri, J. Ro, and A. T. Suresh, “Three approaches for
personalization with applications to federated learning,” <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:2002.10619</em>, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
F. Sattler, K.-R. Muller, and W. Samek, “Clustered federated learning:
Model-agnostic distributed multitask optimization under privacy
constraints,” <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on neural networks and learning
systems</em>, vol. 32, no. 8, p. 3710—3722, 2021.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
A. Ghosh, J. Chung, D. Yin, and K. Ramchandran, “An efficient framework for
clustered federated learning,” in <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information
Processing Systems</em>, vol. 33.   Curran
Associates, Inc., 2020, pp. 19 586–19 597.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
C. Briggs, Z. Fan, and P. Andras, “Federated learning with hierarchical
clustering of local updates to improve training on non-iid data,” in
<em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">2020 International Joint Conference on Neural Networks (IJCNN)</em>, 2020,
pp. 1–9.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
M. Zhang, K. Sapra, S. Fidler, S. Yeung, and J. M. Alvarez, “Personalized
federated learning with first order model optimization,” in
<em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2021.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
P. Kairouz, H. B. McMahan, B. Avent, A. Bellet, M. Bennis, A. N. Bhagoji,
K. Bonawitz, Z. Charles, G. Cormode, R. Cummings, R. G. L. D’Oliveira,
H. Eichner, S. E. Rouayheb, D. Evans, J. Gardner, Z. Garrett, A. Gascón,
B. Ghazi, P. B. Gibbons, M. Gruteser, Z. Harchaoui, C. He, L. He, Z. Huo,
B. Hutchinson, J. Hsu, M. Jaggi, T. Javidi, G. Joshi, M. Khodak, J. Konecný,
A. Korolova, F. Koushanfar, S. Koyejo, T. Lepoint, Y. Liu, P. Mittal,
M. Mohri, R. Nock, A. Özgür, R. Pagh, H. Qi, D. Ramage, R. Raskar,
M. Raykova, D. Song, W. Song, S. U. Stich, Z. Sun, A. T. Suresh, F. Tramèr,
P. Vepakomma, J. Wang, L. Xiong, Z. Xu, Q. Yang, F. X. Yu, H. Yu, and
S. Zhao, “Advances and open problems in federated learning,”
<em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Foundations and Trends® in Machine Learning</em>, vol. 14, no. 1–2, pp.
1–210, 2021.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
T. Li, A. K. Sahu, M. Zaheer, M. Sanjabi, A. Talwalkar, and V. Smith,
“Federated optimization in heterogeneous networks,” in <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proceedings of
Machine Learning and Systems</em>, vol. 2, 2020, pp. 429–450.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
S. P. Karimireddy, S. Kale, M. Mohri, S. Reddi, S. Stich, and A. T. Suresh,
“SCAFFOLD: Stochastic controlled averaging for federated learning,” in
<em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 37th International Conference on Machine Learning</em>,
ser. Proceedings of Machine Learning Research, vol. 119.   PMLR, 2020, pp. 5132–5143.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Q. Li, B. He, and D. Song, “Model-contrastive federated learning,” in
<em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern
Recognition (CVPR)</em>, 2021, pp. 10 713–10 722.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
T. Yu, E. Bagdasaryan, and V. Shmatikov, “Salvaging federated learning by
local adaptation,” <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.04758</em>, 2020.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Y. Jiang, J. Konečný, K. Rush, and S. Kannan, “Improving federated learning
personalization via model agnostic meta learning,” <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:1909.12488</em>, 2019.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
M. Khodak, M.-F. F. Balcan, and A. S. Talwalkar, “Adaptive gradient-based
meta-learning methods,” in <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing
Systems</em>, vol. 32.   Curran Associates,
Inc., 2019.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
A. Fallah, A. Mokhtari, and A. Ozdaglar, “Personalized federated learning with
theoretical guarantees: A model-agnostic meta-learning approach,” in
<em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, vol. 33.   Curran Associates, Inc., 2020, pp. 3557–3568.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
C. T. Dinh, N. Tran, and J. Nguyen, “Personalized federated learning with
moreau envelopes,” in <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing
Systems</em>, vol. 33.   Curran Associates,
Inc., 2020, pp. 21 394–21 405.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
C. Finn, P. Abbeel, and S. Levine, “Model-agnostic meta-learning for fast
adaptation of deep networks,” in <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 34th International
Conference on Machine Learning</em>, ser. Proceedings of Machine Learning
Research, vol. 70.   PMLR, 2017, pp.
1126–1135.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
F. Hanzely and P. Richtárik, “Federated learning of a mixture of global and
local models,” <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.05516</em>, 2020.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Y. Deng, M. M. Kamani, and M. Mahdavi, “Adaptive personalized federated
learning,” <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2003.13461</em>, 2020.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
M. G. Arivazhagan, V. Aggarwal, A. K. Singh, and S. Choudhary, “Federated
learning with personalization layers,” <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:1912.00818</em>, 2019.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
P. P. Liang, T. Liu, L. Ziyin, N. B. Allen, R. P. Auerbach, D. Brent,
R. Salakhutdinov, and L.-P. Morency, “Think locally, act globally: Federated
learning with local and global representations,” <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:2001.01523</em>, 2020.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
D. Li and J. Wang, “Fedmd: Heterogenous federated learning via model
distillation,” <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.03581</em>, 2019.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
T. Lin, L. Kong, S. U. Stich, and M. Jaggi, “Ensemble distillation for robust
model fusion in federated learning,” in <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information
Processing Systems</em>, vol. 33.   Curran
Associates, Inc., 2020, pp. 2351–2363.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
V. Smith, C.-K. Chiang, M. Sanjabi, and A. S. Talwalkar, “Federated multi-task
learning,” in <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
vol. 30.   Curran Associates, Inc.,
2017.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
B. Yang, G. Bender, Q. V. Le, and J. Ngiam, “Condconv: Conditionally
parameterized convolutions for efficient inference,” in <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Advances in
Neural Information Processing Systems</em>, vol. 32.   Curran Associates, Inc., 2019.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
S. Teerapittayanon, B. McDanel, and H. Kung, “Branchynet: Fast inference via
early exiting from deep neural networks,” in <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">2016 23rd International
Conference on Pattern Recognition (ICPR)</em>, 2016, pp. 2464–2469.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
T. Hu, T. Chen, H. Wang, and Z. Wang, “Triple wins: Boosting accuracy,
robustness and efficiency together by enabling input-adaptive inference,” in
<em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2020.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
J. Cui, Q. Wu, Z. Zhou, and X. Chen, “Fedbranch: Heterogeneous federated
learning via multi-branch neural network,” in <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">2022 IEEE/CIC
International Conference on Communications in China (ICCC)</em>, 2022, pp.
1101–1106.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
C.-H. Wang, K.-Y. Huang, J.-C. Chen, H.-H. Shuai, and W.-H. Cheng,
“Heterogeneous federated learning through multi-branch network,” in
<em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">2021 IEEE International Conference on Multimedia and Expo (ICME)</em>,
2021, pp. 1–6.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Z. Zhong, J. Wang, W. Bao, J. Zhou, X. Zhu, and Z. Xiongtao, “Semi-hfl:
semi-supervised federated learning for heterogeneous devices,” <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Complex
&amp; Intelligent Systems</em>, pp. 1–23, 11 2022.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Q. Wang, Q. Li, K. Wang, H. Wang, and P. Zeng, “Efficient federated learning
for fault diagnosis in industrial cloud-edge computing,” <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Computing</em>,
vol. 103, no. 10, p. 2319–2337, oct 2021.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
C. Zhu, Z. Xu, M. Chen, J. Konečný, A. Hard, and T. Goldstein,
“Diurnal or nocturnal? federated learning of multi-branch networks from
periodically shifting distributions,” in <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">International Conference on
Learning Representations</em>, 2022.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
A. Krizhevsky and G. Hinton, “Learning multiple layers of features from tiny
images,” University of Toronto, Toronto, Ontario, Tech. Rep. 0, 2009.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
H. Wang, M. Yurochkin, Y. Sun, D. Papailiopoulos, and Y. Khazaeni, “Federated
learning with matched averaging,” <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning
Representations</em>, 2020.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
M. Yurochkin, M. Agarwal, S. Ghosh, K. Greenewald, N. Hoang, and Y. Khazaeni,
“Bayesian nonparametric federated learning of neural networks,” in
<em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 36th International Conference on Machine Learning</em>,
ser. Proceedings of Machine Learning Research, vol. 97.   PMLR, 2019, pp. 7252–7261.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
A. Shamsian, A. Navon, E. Fetaya, and G. Chechik, “Personalized federated
learning using hypernetworks,” in <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 38th
International Conference on Machine Learning</em>, ser. Proceedings of Machine
Learning Research, vol. 139.   PMLR,
18–24 Jul 2021, pp. 9489–9502.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2211.07930" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2211.07931" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2211.07931">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2211.07931" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2211.07932" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar 14 07:01:15 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
