<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2407.04949] Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients</title><meta property="og:description" content="Federated Learning is widely employed to tackle distributed sensitive data. Existing methods primarily focus on addressing in-federation data heterogeneity. However, we observed that they suffer from significant perfor…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2407.04949">

<!--Generated on Mon Aug  5 18:01:41 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Federated Learning,  Out-of-federation Generalization">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_pruned_first">
<h1 class="ltx_title ltx_title_document">Beyond the Federation: Topology-aware Federated Learning for
<br class="ltx_break">Generalization to Unseen Clients</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mengmeng Ma
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Tang Li
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xi Peng
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Federated Learning is widely employed to tackle distributed sensitive data. Existing methods primarily focus on addressing in-federation data heterogeneity. However, we observed that they suffer from significant performance degradation when applied to unseen clients for out-of-federation (OOF) generalization. The recent attempts to address generalization to unseen clients generally struggle to scale up to large-scale distributed settings due to high communication or computation costs. Moreover, methods that scale well often demonstrate poor generalization capability. To achieve OOF-resiliency in a scalable manner, we propose Topology-aware Federated Learning (TFL) that leverages client topology - a graph representing client relationships - to effectively train robust models against OOF data. We formulate a novel optimization problem for TFL, consisting of two key modules: Client Topology Learning, which infers the client relationships in a privacy-preserving manner, and Learning on Client Topology, which leverages the learned topology to identify influential clients and harness this information into the FL optimization process to efficiently build robust models. Empirical evaluation on a variety of real-world datasets verifies TFL’s superior OOF robustness and scalability.</p>
</div>
<div class="ltx_keywords">Federated Learning, Out-of-federation Generalization
</div>
<div id="p2" class="ltx_para">
<br class="ltx_break">
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<figure id="S1.F1" class="ltx_figure"><img src="/html/2407.04949/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="140" height="89" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Our empirical evaluation of patient mortality prediction using Federated Learning on distributed Healthcare dataset (eICU <cite class="ltx_cite ltx_citemacro_citep">(Pollard et al., <a href="#bib.bib43" title="" class="ltx_ref">2018</a>)</cite>). We observed that <span id="S1.F1.2.1" class="ltx_text ltx_font_italic">a model exhibiting high accuracy with in-federation (IF) data can fail catastrophically when presented with out-of-federation (OOF) data.</span></figcaption>
</figure>
<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated Learning (FL) has emerged as a promising solution for handling distributed sensitive data, enabling multi-institutional collaboration by distributing model training to data owners and aggregating results on a centralized server <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib32" title="" class="ltx_ref">2017</a>)</cite>.
This data-decentralized approach harnesses the collective intelligence of all participating nodes to build a model that is potentially more robust and generalizable <cite class="ltx_cite ltx_citemacro_citep">(Sheller et al., <a href="#bib.bib54" title="" class="ltx_ref">2020</a>)</cite>. Existing robust FL methods <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib23" title="" class="ltx_ref">2020b</a>; Deng et al., <a href="#bib.bib8" title="" class="ltx_ref">2020</a>)</cite> primarily focus on learning a global model with good average or worst-case performance, addressing <span id="S1.p1.1.1" class="ltx_text ltx_font_italic">in-federation (IF)</span> data heterogeneity.
However, these methods can fail catastrophically on <span id="S1.p1.1.2" class="ltx_text ltx_font_italic">out-of-federation (OOF)</span> clients, <span id="S1.p1.1.3" class="ltx_text ltx_font_italic">i.e.,</span> clients outside the collaborative federation. The OOF clients pose significant generalization challenges, as FL models may encounter <span id="S1.p1.1.4" class="ltx_text ltx_font_italic">unseen</span> distributions outside their training space <cite class="ltx_cite ltx_citemacro_citep">(Pati et al., <a href="#bib.bib41" title="" class="ltx_ref">2022a</a>)</cite>. Our empirical study shows that existing methods suffer from significant performance degradation when applied to unseen clients for OOF generalization (see Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">There have been recent attempts to address the challenge of unseen clients through client augmentation and client alignment. However, these approaches encounter difficulties in large-scale distributed environments. Client augmentation methods <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib26" title="" class="ltx_ref">2021</a>)</cite> often necessitate intensive client-server communication, leading to a notable <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">communication bottleneck</span> that hinders scalability <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib77" title="" class="ltx_ref">2023</a>)</cite>. Client alignment methods <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib75" title="" class="ltx_ref">2021</a>)</cite>, which operate by aligning client distributions through adversarial training, are less communication costly but introduce substantial <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">computation burdens</span> due to complex local training process <cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a href="#bib.bib1" title="" class="ltx_ref">2023</a>)</cite>. While using a fixed reference distribution for alignment <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et al., <a href="#bib.bib39" title="" class="ltx_ref">2022</a>)</cite> offers computational efficiency, it has shown <span id="S1.p2.1.3" class="ltx_text ltx_font_italic">limited generalization capabilities to unseen clients</span> <cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a href="#bib.bib1" title="" class="ltx_ref">2023</a>)</cite>. Our empirical evaluation (Figure <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) reveals the tradeoff between OOF resiliency and scalability in current methods. A question naturally arises: Can we build OOF robust models in a scalable manner?</p>
</div>
<figure id="S1.F2" class="ltx_figure"><img src="/html/2407.04949/assets/x2.png" id="S1.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="149" height="88" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Accuracy vs. wall-clock time on PACS dataset <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib20" title="" class="ltx_ref">2017</a>)</cite>. Wall-clock time is used as a holistic evaluation of scalability (communication and computation costs). <span id="S1.F2.2.1" class="ltx_text ltx_font_italic">We see a tradeoff between OOF robustness and scalability in existing methods.</span></figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">We propose to trigger OOF-resiliency while being scalable by leveraging <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">client topology</span>. Client topology, a graph representing client relationships, allows for using graph mining techniques <cite class="ltx_cite ltx_citemacro_citep">(Saxena &amp; Iyengar, <a href="#bib.bib51" title="" class="ltx_ref">2020</a>; Lü &amp; Zhou, <a href="#bib.bib28" title="" class="ltx_ref">2011</a>)</cite> to derive insights into client data distributions. It can be used to identify “influential” clients that are representative of the training clients, containing distributions more likely to be encountered in OOF clients.
For instance, an influential client could be a regional hospital that aggregates a diverse range of patient data. This hospital’s data encapsulates a rich repository of information, mirroring the variety and complexity of data that could be seen in OOF scenarios. Leveraging these influential clients as priority contributors in the training rounds can facilitate the model in learning from the most representative data, thereby potentially enhancing its OOF robustness. On the other hand, by reducing unnecessary communication with non-influential clients, communication costs can be significantly reduced.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Grounded on the concept of client topology, we formulate the problem of generalization to unseen clients as the optimization of a joint objective over the models and the client topology. To solve this optimization problem, we propose Topology-aware Federated Learning, which consists of two steps: 1) Client Topology Learning: Inferring the client topology while respecting data privacy. 2) Learning on Client Topology: Leveraging the learned topology to build a robust model. The first step learn a client topology that reflects client relationships by analyzing pairwise model similarity. In the second step, a robust model is efficiently optimized by harnessing the client’s influential information to regularize a distributed robust optimization process.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Our contributions are as follows: Firstly, we introduce the <span id="S1.p5.1.1" class="ltx_text ltx_font_italic">Topology-aware Federated Learning</span> (TFL), a scalable framework designed to enhance FL’s out-of-federation (OOF) robustness. TFL utilizes client relationships to develop robust models against OOF data.
Secondly, we design an iterative client topology learning and learning on client topology approach to solve TFL. Finally, we have <span id="S1.p5.1.2" class="ltx_text ltx_font_italic">curated two OOF benchmarks</span> using real-world healthcare data, offering valuable testbeds for subsequent research. Through extensive experiments on curated and standard benchmarks, we verify TFL’s superior OOF-resiliency and scalability.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminaries</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">We start by presenting the average-case formulation of FL and subsequently introduce a fundamental robust optimization framework for FL (worst-case formulation).</p>
</div>
<figure id="S2.F3" class="ltx_figure"><img src="/html/2407.04949/assets/x3.png" id="S2.F3.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="428" height="126" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Overview of Topology-aware Federated Learning (TFL). TFL contains two alternating steps: <span id="S2.F3.8.1" class="ltx_text ltx_font_italic">client topology learning</span> (CTL) and <span id="S2.F3.9.2" class="ltx_text ltx_font_italic">learning on client topology</span> (LCT). <span id="S2.F3.10.3" class="ltx_text ltx_font_bold">CTL</span> learn the client topology that describes the relationships between local clients.
We use model weights as node embedding and construct a <math id="S2.F3.3.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S2.F3.3.m1.1b"><mi id="S2.F3.3.m1.1.1" xref="S2.F3.3.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S2.F3.3.m1.1c"><ci id="S2.F3.3.m1.1.1.cmml" xref="S2.F3.3.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.3.m1.1d">\epsilon</annotation></semantics></math>-graph by measuring the similarity of node pairs.
<span id="S2.F3.11.4" class="ltx_text ltx_font_bold">LCT</span> leverage the learned client topology to achieve better OOF robustness. We identify the influential client and then use the influential client as prior knowledge to regularize a distributionally robust optimization framework.
In this way, the optimization process can balance the “worst-case” client and the “influential” client to avoid overly pessimistic models with compromised OOF-resiliency.</figcaption>
</figure>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.10" class="ltx_p"><span id="S2.p2.10.1" class="ltx_text ltx_font_bold">Federated learning (Average-case formulation).</span> The standard FL involves collaboratively training a global model leveraging data distributed at <math id="S2.p2.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.p2.1.m1.1a"><mi id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">K</annotation></semantics></math> clients.
Each client <math id="S2.p2.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.p2.2.m2.1a"><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">k</annotation></semantics></math> (<math id="S2.p2.3.m3.1" class="ltx_Math" alttext="1\leq k\leq K" display="inline"><semantics id="S2.p2.3.m3.1a"><mrow id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml"><mn id="S2.p2.3.m3.1.1.2" xref="S2.p2.3.m3.1.1.2.cmml">1</mn><mo id="S2.p2.3.m3.1.1.3" xref="S2.p2.3.m3.1.1.3.cmml">≤</mo><mi id="S2.p2.3.m3.1.1.4" xref="S2.p2.3.m3.1.1.4.cmml">k</mi><mo id="S2.p2.3.m3.1.1.5" xref="S2.p2.3.m3.1.1.5.cmml">≤</mo><mi id="S2.p2.3.m3.1.1.6" xref="S2.p2.3.m3.1.1.6.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><apply id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1"><and id="S2.p2.3.m3.1.1a.cmml" xref="S2.p2.3.m3.1.1"></and><apply id="S2.p2.3.m3.1.1b.cmml" xref="S2.p2.3.m3.1.1"><leq id="S2.p2.3.m3.1.1.3.cmml" xref="S2.p2.3.m3.1.1.3"></leq><cn type="integer" id="S2.p2.3.m3.1.1.2.cmml" xref="S2.p2.3.m3.1.1.2">1</cn><ci id="S2.p2.3.m3.1.1.4.cmml" xref="S2.p2.3.m3.1.1.4">𝑘</ci></apply><apply id="S2.p2.3.m3.1.1c.cmml" xref="S2.p2.3.m3.1.1"><leq id="S2.p2.3.m3.1.1.5.cmml" xref="S2.p2.3.m3.1.1.5"></leq><share href="#S2.p2.3.m3.1.1.4.cmml" id="S2.p2.3.m3.1.1d.cmml" xref="S2.p2.3.m3.1.1"></share><ci id="S2.p2.3.m3.1.1.6.cmml" xref="S2.p2.3.m3.1.1.6">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">1\leq k\leq K</annotation></semantics></math>) has its own data distribution <math id="S2.p2.4.m4.2" class="ltx_Math" alttext="D_{k}(x,y)" display="inline"><semantics id="S2.p2.4.m4.2a"><mrow id="S2.p2.4.m4.2.3" xref="S2.p2.4.m4.2.3.cmml"><msub id="S2.p2.4.m4.2.3.2" xref="S2.p2.4.m4.2.3.2.cmml"><mi id="S2.p2.4.m4.2.3.2.2" xref="S2.p2.4.m4.2.3.2.2.cmml">D</mi><mi id="S2.p2.4.m4.2.3.2.3" xref="S2.p2.4.m4.2.3.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.p2.4.m4.2.3.1" xref="S2.p2.4.m4.2.3.1.cmml">​</mo><mrow id="S2.p2.4.m4.2.3.3.2" xref="S2.p2.4.m4.2.3.3.1.cmml"><mo stretchy="false" id="S2.p2.4.m4.2.3.3.2.1" xref="S2.p2.4.m4.2.3.3.1.cmml">(</mo><mi id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml">x</mi><mo id="S2.p2.4.m4.2.3.3.2.2" xref="S2.p2.4.m4.2.3.3.1.cmml">,</mo><mi id="S2.p2.4.m4.2.2" xref="S2.p2.4.m4.2.2.cmml">y</mi><mo stretchy="false" id="S2.p2.4.m4.2.3.3.2.3" xref="S2.p2.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.2b"><apply id="S2.p2.4.m4.2.3.cmml" xref="S2.p2.4.m4.2.3"><times id="S2.p2.4.m4.2.3.1.cmml" xref="S2.p2.4.m4.2.3.1"></times><apply id="S2.p2.4.m4.2.3.2.cmml" xref="S2.p2.4.m4.2.3.2"><csymbol cd="ambiguous" id="S2.p2.4.m4.2.3.2.1.cmml" xref="S2.p2.4.m4.2.3.2">subscript</csymbol><ci id="S2.p2.4.m4.2.3.2.2.cmml" xref="S2.p2.4.m4.2.3.2.2">𝐷</ci><ci id="S2.p2.4.m4.2.3.2.3.cmml" xref="S2.p2.4.m4.2.3.2.3">𝑘</ci></apply><interval closure="open" id="S2.p2.4.m4.2.3.3.1.cmml" xref="S2.p2.4.m4.2.3.3.2"><ci id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1">𝑥</ci><ci id="S2.p2.4.m4.2.2.cmml" xref="S2.p2.4.m4.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.2c">D_{k}(x,y)</annotation></semantics></math>, where <math id="S2.p2.5.m5.1" class="ltx_Math" alttext="x\in\mathcal{X}" display="inline"><semantics id="S2.p2.5.m5.1a"><mrow id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml"><mi id="S2.p2.5.m5.1.1.2" xref="S2.p2.5.m5.1.1.2.cmml">x</mi><mo id="S2.p2.5.m5.1.1.1" xref="S2.p2.5.m5.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p2.5.m5.1.1.3" xref="S2.p2.5.m5.1.1.3.cmml">𝒳</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.1b"><apply id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1"><in id="S2.p2.5.m5.1.1.1.cmml" xref="S2.p2.5.m5.1.1.1"></in><ci id="S2.p2.5.m5.1.1.2.cmml" xref="S2.p2.5.m5.1.1.2">𝑥</ci><ci id="S2.p2.5.m5.1.1.3.cmml" xref="S2.p2.5.m5.1.1.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.1c">x\in\mathcal{X}</annotation></semantics></math> is the input and <math id="S2.p2.6.m6.1" class="ltx_Math" alttext="y\in\mathcal{Y}" display="inline"><semantics id="S2.p2.6.m6.1a"><mrow id="S2.p2.6.m6.1.1" xref="S2.p2.6.m6.1.1.cmml"><mi id="S2.p2.6.m6.1.1.2" xref="S2.p2.6.m6.1.1.2.cmml">y</mi><mo id="S2.p2.6.m6.1.1.1" xref="S2.p2.6.m6.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p2.6.m6.1.1.3" xref="S2.p2.6.m6.1.1.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.6.m6.1b"><apply id="S2.p2.6.m6.1.1.cmml" xref="S2.p2.6.m6.1.1"><in id="S2.p2.6.m6.1.1.1.cmml" xref="S2.p2.6.m6.1.1.1"></in><ci id="S2.p2.6.m6.1.1.2.cmml" xref="S2.p2.6.m6.1.1.2">𝑦</ci><ci id="S2.p2.6.m6.1.1.3.cmml" xref="S2.p2.6.m6.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m6.1c">y\in\mathcal{Y}</annotation></semantics></math> is the label, and a dataset with <math id="S2.p2.7.m7.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="S2.p2.7.m7.1a"><msub id="S2.p2.7.m7.1.1" xref="S2.p2.7.m7.1.1.cmml"><mi id="S2.p2.7.m7.1.1.2" xref="S2.p2.7.m7.1.1.2.cmml">n</mi><mi id="S2.p2.7.m7.1.1.3" xref="S2.p2.7.m7.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.7.m7.1b"><apply id="S2.p2.7.m7.1.1.cmml" xref="S2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.p2.7.m7.1.1.1.cmml" xref="S2.p2.7.m7.1.1">subscript</csymbol><ci id="S2.p2.7.m7.1.1.2.cmml" xref="S2.p2.7.m7.1.1.2">𝑛</ci><ci id="S2.p2.7.m7.1.1.3.cmml" xref="S2.p2.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m7.1c">n_{k}</annotation></semantics></math> data points: <math id="S2.p2.8.m8.1" class="ltx_Math" alttext="\widehat{D}_{k}=\left\{(x_{k}^{n},y_{k}^{n})\right\}_{n=1}^{n_{k}}" display="inline"><semantics id="S2.p2.8.m8.1a"><mrow id="S2.p2.8.m8.1.1" xref="S2.p2.8.m8.1.1.cmml"><msub id="S2.p2.8.m8.1.1.3" xref="S2.p2.8.m8.1.1.3.cmml"><mover accent="true" id="S2.p2.8.m8.1.1.3.2" xref="S2.p2.8.m8.1.1.3.2.cmml"><mi id="S2.p2.8.m8.1.1.3.2.2" xref="S2.p2.8.m8.1.1.3.2.2.cmml">D</mi><mo id="S2.p2.8.m8.1.1.3.2.1" xref="S2.p2.8.m8.1.1.3.2.1.cmml">^</mo></mover><mi id="S2.p2.8.m8.1.1.3.3" xref="S2.p2.8.m8.1.1.3.3.cmml">k</mi></msub><mo id="S2.p2.8.m8.1.1.2" xref="S2.p2.8.m8.1.1.2.cmml">=</mo><msubsup id="S2.p2.8.m8.1.1.1" xref="S2.p2.8.m8.1.1.1.cmml"><mrow id="S2.p2.8.m8.1.1.1.1.1.1" xref="S2.p2.8.m8.1.1.1.1.1.2.cmml"><mo id="S2.p2.8.m8.1.1.1.1.1.1.2" xref="S2.p2.8.m8.1.1.1.1.1.2.cmml">{</mo><mrow id="S2.p2.8.m8.1.1.1.1.1.1.1.2" xref="S2.p2.8.m8.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.p2.8.m8.1.1.1.1.1.1.1.2.3" xref="S2.p2.8.m8.1.1.1.1.1.1.1.3.cmml">(</mo><msubsup id="S2.p2.8.m8.1.1.1.1.1.1.1.1.1" xref="S2.p2.8.m8.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.p2.8.m8.1.1.1.1.1.1.1.1.1.2.2" xref="S2.p2.8.m8.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.p2.8.m8.1.1.1.1.1.1.1.1.1.2.3" xref="S2.p2.8.m8.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi><mi id="S2.p2.8.m8.1.1.1.1.1.1.1.1.1.3" xref="S2.p2.8.m8.1.1.1.1.1.1.1.1.1.3.cmml">n</mi></msubsup><mo id="S2.p2.8.m8.1.1.1.1.1.1.1.2.4" xref="S2.p2.8.m8.1.1.1.1.1.1.1.3.cmml">,</mo><msubsup id="S2.p2.8.m8.1.1.1.1.1.1.1.2.2" xref="S2.p2.8.m8.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.p2.8.m8.1.1.1.1.1.1.1.2.2.2.2" xref="S2.p2.8.m8.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="S2.p2.8.m8.1.1.1.1.1.1.1.2.2.2.3" xref="S2.p2.8.m8.1.1.1.1.1.1.1.2.2.2.3.cmml">k</mi><mi id="S2.p2.8.m8.1.1.1.1.1.1.1.2.2.3" xref="S2.p2.8.m8.1.1.1.1.1.1.1.2.2.3.cmml">n</mi></msubsup><mo stretchy="false" id="S2.p2.8.m8.1.1.1.1.1.1.1.2.5" xref="S2.p2.8.m8.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S2.p2.8.m8.1.1.1.1.1.1.3" xref="S2.p2.8.m8.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.p2.8.m8.1.1.1.1.3" xref="S2.p2.8.m8.1.1.1.1.3.cmml"><mi id="S2.p2.8.m8.1.1.1.1.3.2" xref="S2.p2.8.m8.1.1.1.1.3.2.cmml">n</mi><mo id="S2.p2.8.m8.1.1.1.1.3.1" xref="S2.p2.8.m8.1.1.1.1.3.1.cmml">=</mo><mn id="S2.p2.8.m8.1.1.1.1.3.3" xref="S2.p2.8.m8.1.1.1.1.3.3.cmml">1</mn></mrow><msub id="S2.p2.8.m8.1.1.1.3" xref="S2.p2.8.m8.1.1.1.3.cmml"><mi id="S2.p2.8.m8.1.1.1.3.2" xref="S2.p2.8.m8.1.1.1.3.2.cmml">n</mi><mi id="S2.p2.8.m8.1.1.1.3.3" xref="S2.p2.8.m8.1.1.1.3.3.cmml">k</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.8.m8.1b"><apply id="S2.p2.8.m8.1.1.cmml" xref="S2.p2.8.m8.1.1"><eq id="S2.p2.8.m8.1.1.2.cmml" xref="S2.p2.8.m8.1.1.2"></eq><apply id="S2.p2.8.m8.1.1.3.cmml" xref="S2.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S2.p2.8.m8.1.1.3.1.cmml" xref="S2.p2.8.m8.1.1.3">subscript</csymbol><apply id="S2.p2.8.m8.1.1.3.2.cmml" xref="S2.p2.8.m8.1.1.3.2"><ci id="S2.p2.8.m8.1.1.3.2.1.cmml" xref="S2.p2.8.m8.1.1.3.2.1">^</ci><ci id="S2.p2.8.m8.1.1.3.2.2.cmml" xref="S2.p2.8.m8.1.1.3.2.2">𝐷</ci></apply><ci id="S2.p2.8.m8.1.1.3.3.cmml" xref="S2.p2.8.m8.1.1.3.3">𝑘</ci></apply><apply id="S2.p2.8.m8.1.1.1.cmml" xref="S2.p2.8.m8.1.1.1"><csymbol cd="ambiguous" id="S2.p2.8.m8.1.1.1.2.cmml" xref="S2.p2.8.m8.1.1.1">superscript</csymbol><apply id="S2.p2.8.m8.1.1.1.1.cmml" xref="S2.p2.8.m8.1.1.1"><csymbol cd="ambiguous" id="S2.p2.8.m8.1.1.1.1.2.cmml" xref="S2.p2.8.m8.1.1.1">subscript</csymbol><set id="S2.p2.8.m8.1.1.1.1.1.2.cmml" xref="S2.p2.8.m8.1.1.1.1.1.1"><interval closure="open" id="S2.p2.8.m8.1.1.1.1.1.1.1.3.cmml" xref="S2.p2.8.m8.1.1.1.1.1.1.1.2"><apply id="S2.p2.8.m8.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p2.8.m8.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.8.m8.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p2.8.m8.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.p2.8.m8.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.p2.8.m8.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.8.m8.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.p2.8.m8.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p2.8.m8.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.p2.8.m8.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.p2.8.m8.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.p2.8.m8.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S2.p2.8.m8.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.p2.8.m8.1.1.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="S2.p2.8.m8.1.1.1.1.1.1.1.2.2.cmml" xref="S2.p2.8.m8.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.p2.8.m8.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.p2.8.m8.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S2.p2.8.m8.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.p2.8.m8.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.p2.8.m8.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.p2.8.m8.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.p2.8.m8.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.p2.8.m8.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="S2.p2.8.m8.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.p2.8.m8.1.1.1.1.1.1.1.2.2.2.3">𝑘</ci></apply><ci id="S2.p2.8.m8.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.p2.8.m8.1.1.1.1.1.1.1.2.2.3">𝑛</ci></apply></interval></set><apply id="S2.p2.8.m8.1.1.1.1.3.cmml" xref="S2.p2.8.m8.1.1.1.1.3"><eq id="S2.p2.8.m8.1.1.1.1.3.1.cmml" xref="S2.p2.8.m8.1.1.1.1.3.1"></eq><ci id="S2.p2.8.m8.1.1.1.1.3.2.cmml" xref="S2.p2.8.m8.1.1.1.1.3.2">𝑛</ci><cn type="integer" id="S2.p2.8.m8.1.1.1.1.3.3.cmml" xref="S2.p2.8.m8.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.p2.8.m8.1.1.1.3.cmml" xref="S2.p2.8.m8.1.1.1.3"><csymbol cd="ambiguous" id="S2.p2.8.m8.1.1.1.3.1.cmml" xref="S2.p2.8.m8.1.1.1.3">subscript</csymbol><ci id="S2.p2.8.m8.1.1.1.3.2.cmml" xref="S2.p2.8.m8.1.1.1.3.2">𝑛</ci><ci id="S2.p2.8.m8.1.1.1.3.3.cmml" xref="S2.p2.8.m8.1.1.1.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m8.1c">\widehat{D}_{k}=\left\{(x_{k}^{n},y_{k}^{n})\right\}_{n=1}^{n_{k}}</annotation></semantics></math>. Local data distributions <math id="S2.p2.9.m9.1" class="ltx_Math" alttext="\left\{D_{k}\right\}_{k=1}^{K}" display="inline"><semantics id="S2.p2.9.m9.1a"><msubsup id="S2.p2.9.m9.1.1" xref="S2.p2.9.m9.1.1.cmml"><mrow id="S2.p2.9.m9.1.1.1.1.1" xref="S2.p2.9.m9.1.1.1.1.2.cmml"><mo id="S2.p2.9.m9.1.1.1.1.1.2" xref="S2.p2.9.m9.1.1.1.1.2.cmml">{</mo><msub id="S2.p2.9.m9.1.1.1.1.1.1" xref="S2.p2.9.m9.1.1.1.1.1.1.cmml"><mi id="S2.p2.9.m9.1.1.1.1.1.1.2" xref="S2.p2.9.m9.1.1.1.1.1.1.2.cmml">D</mi><mi id="S2.p2.9.m9.1.1.1.1.1.1.3" xref="S2.p2.9.m9.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S2.p2.9.m9.1.1.1.1.1.3" xref="S2.p2.9.m9.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.p2.9.m9.1.1.1.3" xref="S2.p2.9.m9.1.1.1.3.cmml"><mi id="S2.p2.9.m9.1.1.1.3.2" xref="S2.p2.9.m9.1.1.1.3.2.cmml">k</mi><mo id="S2.p2.9.m9.1.1.1.3.1" xref="S2.p2.9.m9.1.1.1.3.1.cmml">=</mo><mn id="S2.p2.9.m9.1.1.1.3.3" xref="S2.p2.9.m9.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.p2.9.m9.1.1.3" xref="S2.p2.9.m9.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p2.9.m9.1b"><apply id="S2.p2.9.m9.1.1.cmml" xref="S2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S2.p2.9.m9.1.1.2.cmml" xref="S2.p2.9.m9.1.1">superscript</csymbol><apply id="S2.p2.9.m9.1.1.1.cmml" xref="S2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S2.p2.9.m9.1.1.1.2.cmml" xref="S2.p2.9.m9.1.1">subscript</csymbol><set id="S2.p2.9.m9.1.1.1.1.2.cmml" xref="S2.p2.9.m9.1.1.1.1.1"><apply id="S2.p2.9.m9.1.1.1.1.1.1.cmml" xref="S2.p2.9.m9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.9.m9.1.1.1.1.1.1.1.cmml" xref="S2.p2.9.m9.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p2.9.m9.1.1.1.1.1.1.2.cmml" xref="S2.p2.9.m9.1.1.1.1.1.1.2">𝐷</ci><ci id="S2.p2.9.m9.1.1.1.1.1.1.3.cmml" xref="S2.p2.9.m9.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S2.p2.9.m9.1.1.1.3.cmml" xref="S2.p2.9.m9.1.1.1.3"><eq id="S2.p2.9.m9.1.1.1.3.1.cmml" xref="S2.p2.9.m9.1.1.1.3.1"></eq><ci id="S2.p2.9.m9.1.1.1.3.2.cmml" xref="S2.p2.9.m9.1.1.1.3.2">𝑘</ci><cn type="integer" id="S2.p2.9.m9.1.1.1.3.3.cmml" xref="S2.p2.9.m9.1.1.1.3.3">1</cn></apply></apply><ci id="S2.p2.9.m9.1.1.3.cmml" xref="S2.p2.9.m9.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.9.m9.1c">\left\{D_{k}\right\}_{k=1}^{K}</annotation></semantics></math> could be the same or different across the clients. FL aims to learn a global model <math id="S2.p2.10.m10.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.p2.10.m10.1a"><mi id="S2.p2.10.m10.1.1" xref="S2.p2.10.m10.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.p2.10.m10.1b"><ci id="S2.p2.10.m10.1.1.cmml" xref="S2.p2.10.m10.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.10.m10.1c">\theta</annotation></semantics></math> by minimizing the following objective function:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.4" class="ltx_Math" alttext="\min_{\theta\in\Theta}\ F(\theta),\;\text{where}\;F(\theta):=\sum_{k=1}^{K}p_{k}f_{k}(\theta)," display="block"><semantics id="S2.E1.m1.4a"><mrow id="S2.E1.m1.4.4.1" xref="S2.E1.m1.4.4.1.1.cmml"><mrow id="S2.E1.m1.4.4.1.1" xref="S2.E1.m1.4.4.1.1.cmml"><mrow id="S2.E1.m1.4.4.1.1.2.2" xref="S2.E1.m1.4.4.1.1.2.3.cmml"><mrow id="S2.E1.m1.4.4.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.cmml"><mrow id="S2.E1.m1.4.4.1.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.1.2.cmml"><munder id="S2.E1.m1.4.4.1.1.1.1.1.2.1" xref="S2.E1.m1.4.4.1.1.1.1.1.2.1.cmml"><mi id="S2.E1.m1.4.4.1.1.1.1.1.2.1.2" xref="S2.E1.m1.4.4.1.1.1.1.1.2.1.2.cmml">min</mi><mrow id="S2.E1.m1.4.4.1.1.1.1.1.2.1.3" xref="S2.E1.m1.4.4.1.1.1.1.1.2.1.3.cmml"><mi id="S2.E1.m1.4.4.1.1.1.1.1.2.1.3.2" xref="S2.E1.m1.4.4.1.1.1.1.1.2.1.3.2.cmml">θ</mi><mo id="S2.E1.m1.4.4.1.1.1.1.1.2.1.3.1" xref="S2.E1.m1.4.4.1.1.1.1.1.2.1.3.1.cmml">∈</mo><mi mathvariant="normal" id="S2.E1.m1.4.4.1.1.1.1.1.2.1.3.3" xref="S2.E1.m1.4.4.1.1.1.1.1.2.1.3.3.cmml">Θ</mi></mrow></munder><mo lspace="0.667em" id="S2.E1.m1.4.4.1.1.1.1.1.2a" xref="S2.E1.m1.4.4.1.1.1.1.1.2.cmml">⁡</mo><mi id="S2.E1.m1.4.4.1.1.1.1.1.2.2" xref="S2.E1.m1.4.4.1.1.1.1.1.2.2.cmml">F</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.4.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.cmml">​</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1.3.2" xref="S2.E1.m1.4.4.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.4.4.1.1.1.1.1.3.2.1" xref="S2.E1.m1.4.4.1.1.1.1.1.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S2.E1.m1.4.4.1.1.1.1.1.3.2.2" xref="S2.E1.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.447em" id="S2.E1.m1.4.4.1.1.2.2.3" xref="S2.E1.m1.4.4.1.1.2.3.cmml">,</mo><mrow id="S2.E1.m1.4.4.1.1.2.2.2" xref="S2.E1.m1.4.4.1.1.2.2.2.cmml"><mtext id="S2.E1.m1.4.4.1.1.2.2.2.2" xref="S2.E1.m1.4.4.1.1.2.2.2.2a.cmml">where</mtext><mo lspace="0.280em" rspace="0em" id="S2.E1.m1.4.4.1.1.2.2.2.1" xref="S2.E1.m1.4.4.1.1.2.2.2.1.cmml">​</mo><mi id="S2.E1.m1.4.4.1.1.2.2.2.3" xref="S2.E1.m1.4.4.1.1.2.2.2.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.4.1.1.2.2.2.1a" xref="S2.E1.m1.4.4.1.1.2.2.2.1.cmml">​</mo><mrow id="S2.E1.m1.4.4.1.1.2.2.2.4.2" xref="S2.E1.m1.4.4.1.1.2.2.2.cmml"><mo stretchy="false" id="S2.E1.m1.4.4.1.1.2.2.2.4.2.1" xref="S2.E1.m1.4.4.1.1.2.2.2.cmml">(</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">θ</mi><mo rspace="0.278em" stretchy="false" id="S2.E1.m1.4.4.1.1.2.2.2.4.2.2" xref="S2.E1.m1.4.4.1.1.2.2.2.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.111em" id="S2.E1.m1.4.4.1.1.3" xref="S2.E1.m1.4.4.1.1.3.cmml">:=</mo><mrow id="S2.E1.m1.4.4.1.1.4" xref="S2.E1.m1.4.4.1.1.4.cmml"><munderover id="S2.E1.m1.4.4.1.1.4.1" xref="S2.E1.m1.4.4.1.1.4.1.cmml"><mo movablelimits="false" id="S2.E1.m1.4.4.1.1.4.1.2.2" xref="S2.E1.m1.4.4.1.1.4.1.2.2.cmml">∑</mo><mrow id="S2.E1.m1.4.4.1.1.4.1.2.3" xref="S2.E1.m1.4.4.1.1.4.1.2.3.cmml"><mi id="S2.E1.m1.4.4.1.1.4.1.2.3.2" xref="S2.E1.m1.4.4.1.1.4.1.2.3.2.cmml">k</mi><mo id="S2.E1.m1.4.4.1.1.4.1.2.3.1" xref="S2.E1.m1.4.4.1.1.4.1.2.3.1.cmml">=</mo><mn id="S2.E1.m1.4.4.1.1.4.1.2.3.3" xref="S2.E1.m1.4.4.1.1.4.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.4.4.1.1.4.1.3" xref="S2.E1.m1.4.4.1.1.4.1.3.cmml">K</mi></munderover><mrow id="S2.E1.m1.4.4.1.1.4.2" xref="S2.E1.m1.4.4.1.1.4.2.cmml"><msub id="S2.E1.m1.4.4.1.1.4.2.2" xref="S2.E1.m1.4.4.1.1.4.2.2.cmml"><mi id="S2.E1.m1.4.4.1.1.4.2.2.2" xref="S2.E1.m1.4.4.1.1.4.2.2.2.cmml">p</mi><mi id="S2.E1.m1.4.4.1.1.4.2.2.3" xref="S2.E1.m1.4.4.1.1.4.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.4.1.1.4.2.1" xref="S2.E1.m1.4.4.1.1.4.2.1.cmml">​</mo><msub id="S2.E1.m1.4.4.1.1.4.2.3" xref="S2.E1.m1.4.4.1.1.4.2.3.cmml"><mi id="S2.E1.m1.4.4.1.1.4.2.3.2" xref="S2.E1.m1.4.4.1.1.4.2.3.2.cmml">f</mi><mi id="S2.E1.m1.4.4.1.1.4.2.3.3" xref="S2.E1.m1.4.4.1.1.4.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.4.1.1.4.2.1a" xref="S2.E1.m1.4.4.1.1.4.2.1.cmml">​</mo><mrow id="S2.E1.m1.4.4.1.1.4.2.4.2" xref="S2.E1.m1.4.4.1.1.4.2.cmml"><mo stretchy="false" id="S2.E1.m1.4.4.1.1.4.2.4.2.1" xref="S2.E1.m1.4.4.1.1.4.2.cmml">(</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">θ</mi><mo stretchy="false" id="S2.E1.m1.4.4.1.1.4.2.4.2.2" xref="S2.E1.m1.4.4.1.1.4.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.4.4.1.2" xref="S2.E1.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.4b"><apply id="S2.E1.m1.4.4.1.1.cmml" xref="S2.E1.m1.4.4.1"><csymbol cd="latexml" id="S2.E1.m1.4.4.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.3">assign</csymbol><list id="S2.E1.m1.4.4.1.1.2.3.cmml" xref="S2.E1.m1.4.4.1.1.2.2"><apply id="S2.E1.m1.4.4.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1"><times id="S2.E1.m1.4.4.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1"></times><apply id="S2.E1.m1.4.4.1.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.2"><apply id="S2.E1.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.1.2.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.2.1">subscript</csymbol><min id="S2.E1.m1.4.4.1.1.1.1.1.2.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.2.1.2"></min><apply id="S2.E1.m1.4.4.1.1.1.1.1.2.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.2.1.3"><in id="S2.E1.m1.4.4.1.1.1.1.1.2.1.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.2.1.3.1"></in><ci id="S2.E1.m1.4.4.1.1.1.1.1.2.1.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.2.1.3.2">𝜃</ci><ci id="S2.E1.m1.4.4.1.1.1.1.1.2.1.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.2.1.3.3">Θ</ci></apply></apply><ci id="S2.E1.m1.4.4.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.2.2">𝐹</ci></apply><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝜃</ci></apply><apply id="S2.E1.m1.4.4.1.1.2.2.2.cmml" xref="S2.E1.m1.4.4.1.1.2.2.2"><times id="S2.E1.m1.4.4.1.1.2.2.2.1.cmml" xref="S2.E1.m1.4.4.1.1.2.2.2.1"></times><ci id="S2.E1.m1.4.4.1.1.2.2.2.2a.cmml" xref="S2.E1.m1.4.4.1.1.2.2.2.2"><mtext id="S2.E1.m1.4.4.1.1.2.2.2.2.cmml" xref="S2.E1.m1.4.4.1.1.2.2.2.2">where</mtext></ci><ci id="S2.E1.m1.4.4.1.1.2.2.2.3.cmml" xref="S2.E1.m1.4.4.1.1.2.2.2.3">𝐹</ci><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝜃</ci></apply></list><apply id="S2.E1.m1.4.4.1.1.4.cmml" xref="S2.E1.m1.4.4.1.1.4"><apply id="S2.E1.m1.4.4.1.1.4.1.cmml" xref="S2.E1.m1.4.4.1.1.4.1"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.4.1.1.cmml" xref="S2.E1.m1.4.4.1.1.4.1">superscript</csymbol><apply id="S2.E1.m1.4.4.1.1.4.1.2.cmml" xref="S2.E1.m1.4.4.1.1.4.1"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.4.1.2.1.cmml" xref="S2.E1.m1.4.4.1.1.4.1">subscript</csymbol><sum id="S2.E1.m1.4.4.1.1.4.1.2.2.cmml" xref="S2.E1.m1.4.4.1.1.4.1.2.2"></sum><apply id="S2.E1.m1.4.4.1.1.4.1.2.3.cmml" xref="S2.E1.m1.4.4.1.1.4.1.2.3"><eq id="S2.E1.m1.4.4.1.1.4.1.2.3.1.cmml" xref="S2.E1.m1.4.4.1.1.4.1.2.3.1"></eq><ci id="S2.E1.m1.4.4.1.1.4.1.2.3.2.cmml" xref="S2.E1.m1.4.4.1.1.4.1.2.3.2">𝑘</ci><cn type="integer" id="S2.E1.m1.4.4.1.1.4.1.2.3.3.cmml" xref="S2.E1.m1.4.4.1.1.4.1.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.4.4.1.1.4.1.3.cmml" xref="S2.E1.m1.4.4.1.1.4.1.3">𝐾</ci></apply><apply id="S2.E1.m1.4.4.1.1.4.2.cmml" xref="S2.E1.m1.4.4.1.1.4.2"><times id="S2.E1.m1.4.4.1.1.4.2.1.cmml" xref="S2.E1.m1.4.4.1.1.4.2.1"></times><apply id="S2.E1.m1.4.4.1.1.4.2.2.cmml" xref="S2.E1.m1.4.4.1.1.4.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.4.2.2.1.cmml" xref="S2.E1.m1.4.4.1.1.4.2.2">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.4.2.2.2.cmml" xref="S2.E1.m1.4.4.1.1.4.2.2.2">𝑝</ci><ci id="S2.E1.m1.4.4.1.1.4.2.2.3.cmml" xref="S2.E1.m1.4.4.1.1.4.2.2.3">𝑘</ci></apply><apply id="S2.E1.m1.4.4.1.1.4.2.3.cmml" xref="S2.E1.m1.4.4.1.1.4.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.4.2.3.1.cmml" xref="S2.E1.m1.4.4.1.1.4.2.3">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.4.2.3.2.cmml" xref="S2.E1.m1.4.4.1.1.4.2.3.2">𝑓</ci><ci id="S2.E1.m1.4.4.1.1.4.2.3.3.cmml" xref="S2.E1.m1.4.4.1.1.4.2.3.3">𝑘</ci></apply><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.4c">\min_{\theta\in\Theta}\ F(\theta),\;\text{where}\;F(\theta):=\sum_{k=1}^{K}p_{k}f_{k}(\theta),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.p2.19" class="ltx_p">where <math id="S2.p2.11.m1.1" class="ltx_Math" alttext="f_{k}(\theta)" display="inline"><semantics id="S2.p2.11.m1.1a"><mrow id="S2.p2.11.m1.1.2" xref="S2.p2.11.m1.1.2.cmml"><msub id="S2.p2.11.m1.1.2.2" xref="S2.p2.11.m1.1.2.2.cmml"><mi id="S2.p2.11.m1.1.2.2.2" xref="S2.p2.11.m1.1.2.2.2.cmml">f</mi><mi id="S2.p2.11.m1.1.2.2.3" xref="S2.p2.11.m1.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.p2.11.m1.1.2.1" xref="S2.p2.11.m1.1.2.1.cmml">​</mo><mrow id="S2.p2.11.m1.1.2.3.2" xref="S2.p2.11.m1.1.2.cmml"><mo stretchy="false" id="S2.p2.11.m1.1.2.3.2.1" xref="S2.p2.11.m1.1.2.cmml">(</mo><mi id="S2.p2.11.m1.1.1" xref="S2.p2.11.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S2.p2.11.m1.1.2.3.2.2" xref="S2.p2.11.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.11.m1.1b"><apply id="S2.p2.11.m1.1.2.cmml" xref="S2.p2.11.m1.1.2"><times id="S2.p2.11.m1.1.2.1.cmml" xref="S2.p2.11.m1.1.2.1"></times><apply id="S2.p2.11.m1.1.2.2.cmml" xref="S2.p2.11.m1.1.2.2"><csymbol cd="ambiguous" id="S2.p2.11.m1.1.2.2.1.cmml" xref="S2.p2.11.m1.1.2.2">subscript</csymbol><ci id="S2.p2.11.m1.1.2.2.2.cmml" xref="S2.p2.11.m1.1.2.2.2">𝑓</ci><ci id="S2.p2.11.m1.1.2.2.3.cmml" xref="S2.p2.11.m1.1.2.2.3">𝑘</ci></apply><ci id="S2.p2.11.m1.1.1.cmml" xref="S2.p2.11.m1.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.11.m1.1c">f_{k}(\theta)</annotation></semantics></math> is the local objective function of client <math id="S2.p2.12.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.p2.12.m2.1a"><mi id="S2.p2.12.m2.1.1" xref="S2.p2.12.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.p2.12.m2.1b"><ci id="S2.p2.12.m2.1.1.cmml" xref="S2.p2.12.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.12.m2.1c">k</annotation></semantics></math>. The local objective function is often defined as the empirical risk over local data, <span id="S2.p2.19.1" class="ltx_text ltx_font_italic">i.e.,</span> <math id="S2.p2.13.m3.10" class="ltx_Math" alttext="f_{k}(\theta)=\mathbb{E}_{(x,y)\sim\widehat{D}_{k}}[{\ell(\theta;x,y)}]=\frac{1}{n_{k}}\sum_{n=1}^{n_{k}}\ell(\theta;x_{k}^{n},y_{k}^{n})" display="inline"><semantics id="S2.p2.13.m3.10a"><mrow id="S2.p2.13.m3.10.10" xref="S2.p2.13.m3.10.10.cmml"><mrow id="S2.p2.13.m3.10.10.5" xref="S2.p2.13.m3.10.10.5.cmml"><msub id="S2.p2.13.m3.10.10.5.2" xref="S2.p2.13.m3.10.10.5.2.cmml"><mi id="S2.p2.13.m3.10.10.5.2.2" xref="S2.p2.13.m3.10.10.5.2.2.cmml">f</mi><mi id="S2.p2.13.m3.10.10.5.2.3" xref="S2.p2.13.m3.10.10.5.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.p2.13.m3.10.10.5.1" xref="S2.p2.13.m3.10.10.5.1.cmml">​</mo><mrow id="S2.p2.13.m3.10.10.5.3.2" xref="S2.p2.13.m3.10.10.5.cmml"><mo stretchy="false" id="S2.p2.13.m3.10.10.5.3.2.1" xref="S2.p2.13.m3.10.10.5.cmml">(</mo><mi id="S2.p2.13.m3.3.3" xref="S2.p2.13.m3.3.3.cmml">θ</mi><mo stretchy="false" id="S2.p2.13.m3.10.10.5.3.2.2" xref="S2.p2.13.m3.10.10.5.cmml">)</mo></mrow></mrow><mo id="S2.p2.13.m3.10.10.6" xref="S2.p2.13.m3.10.10.6.cmml">=</mo><mrow id="S2.p2.13.m3.8.8.1" xref="S2.p2.13.m3.8.8.1.cmml"><msub id="S2.p2.13.m3.8.8.1.3" xref="S2.p2.13.m3.8.8.1.3.cmml"><mi id="S2.p2.13.m3.8.8.1.3.2" xref="S2.p2.13.m3.8.8.1.3.2.cmml">𝔼</mi><mrow id="S2.p2.13.m3.2.2.2" xref="S2.p2.13.m3.2.2.2.cmml"><mrow id="S2.p2.13.m3.2.2.2.4.2" xref="S2.p2.13.m3.2.2.2.4.1.cmml"><mo stretchy="false" id="S2.p2.13.m3.2.2.2.4.2.1" xref="S2.p2.13.m3.2.2.2.4.1.cmml">(</mo><mi id="S2.p2.13.m3.1.1.1.1" xref="S2.p2.13.m3.1.1.1.1.cmml">x</mi><mo id="S2.p2.13.m3.2.2.2.4.2.2" xref="S2.p2.13.m3.2.2.2.4.1.cmml">,</mo><mi id="S2.p2.13.m3.2.2.2.2" xref="S2.p2.13.m3.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S2.p2.13.m3.2.2.2.4.2.3" xref="S2.p2.13.m3.2.2.2.4.1.cmml">)</mo></mrow><mo id="S2.p2.13.m3.2.2.2.3" xref="S2.p2.13.m3.2.2.2.3.cmml">∼</mo><msub id="S2.p2.13.m3.2.2.2.5" xref="S2.p2.13.m3.2.2.2.5.cmml"><mover accent="true" id="S2.p2.13.m3.2.2.2.5.2" xref="S2.p2.13.m3.2.2.2.5.2.cmml"><mi id="S2.p2.13.m3.2.2.2.5.2.2" xref="S2.p2.13.m3.2.2.2.5.2.2.cmml">D</mi><mo id="S2.p2.13.m3.2.2.2.5.2.1" xref="S2.p2.13.m3.2.2.2.5.2.1.cmml">^</mo></mover><mi id="S2.p2.13.m3.2.2.2.5.3" xref="S2.p2.13.m3.2.2.2.5.3.cmml">k</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S2.p2.13.m3.8.8.1.2" xref="S2.p2.13.m3.8.8.1.2.cmml">​</mo><mrow id="S2.p2.13.m3.8.8.1.1.1" xref="S2.p2.13.m3.8.8.1.1.2.cmml"><mo stretchy="false" id="S2.p2.13.m3.8.8.1.1.1.2" xref="S2.p2.13.m3.8.8.1.1.2.1.cmml">[</mo><mrow id="S2.p2.13.m3.8.8.1.1.1.1" xref="S2.p2.13.m3.8.8.1.1.1.1.cmml"><mi mathvariant="normal" id="S2.p2.13.m3.8.8.1.1.1.1.2" xref="S2.p2.13.m3.8.8.1.1.1.1.2.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S2.p2.13.m3.8.8.1.1.1.1.1" xref="S2.p2.13.m3.8.8.1.1.1.1.1.cmml">​</mo><mrow id="S2.p2.13.m3.8.8.1.1.1.1.3.2" xref="S2.p2.13.m3.8.8.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S2.p2.13.m3.8.8.1.1.1.1.3.2.1" xref="S2.p2.13.m3.8.8.1.1.1.1.3.1.cmml">(</mo><mi id="S2.p2.13.m3.4.4" xref="S2.p2.13.m3.4.4.cmml">θ</mi><mo id="S2.p2.13.m3.8.8.1.1.1.1.3.2.2" xref="S2.p2.13.m3.8.8.1.1.1.1.3.1.cmml">;</mo><mi id="S2.p2.13.m3.5.5" xref="S2.p2.13.m3.5.5.cmml">x</mi><mo id="S2.p2.13.m3.8.8.1.1.1.1.3.2.3" xref="S2.p2.13.m3.8.8.1.1.1.1.3.1.cmml">,</mo><mi id="S2.p2.13.m3.6.6" xref="S2.p2.13.m3.6.6.cmml">y</mi><mo stretchy="false" id="S2.p2.13.m3.8.8.1.1.1.1.3.2.4" xref="S2.p2.13.m3.8.8.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.p2.13.m3.8.8.1.1.1.3" xref="S2.p2.13.m3.8.8.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.p2.13.m3.10.10.7" xref="S2.p2.13.m3.10.10.7.cmml">=</mo><mrow id="S2.p2.13.m3.10.10.3" xref="S2.p2.13.m3.10.10.3.cmml"><mfrac id="S2.p2.13.m3.10.10.3.4" xref="S2.p2.13.m3.10.10.3.4.cmml"><mn id="S2.p2.13.m3.10.10.3.4.2" xref="S2.p2.13.m3.10.10.3.4.2.cmml">1</mn><msub id="S2.p2.13.m3.10.10.3.4.3" xref="S2.p2.13.m3.10.10.3.4.3.cmml"><mi id="S2.p2.13.m3.10.10.3.4.3.2" xref="S2.p2.13.m3.10.10.3.4.3.2.cmml">n</mi><mi id="S2.p2.13.m3.10.10.3.4.3.3" xref="S2.p2.13.m3.10.10.3.4.3.3.cmml">k</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S2.p2.13.m3.10.10.3.3" xref="S2.p2.13.m3.10.10.3.3.cmml">​</mo><mrow id="S2.p2.13.m3.10.10.3.2" xref="S2.p2.13.m3.10.10.3.2.cmml"><msubsup id="S2.p2.13.m3.10.10.3.2.3" xref="S2.p2.13.m3.10.10.3.2.3.cmml"><mo id="S2.p2.13.m3.10.10.3.2.3.2.2" xref="S2.p2.13.m3.10.10.3.2.3.2.2.cmml">∑</mo><mrow id="S2.p2.13.m3.10.10.3.2.3.2.3" xref="S2.p2.13.m3.10.10.3.2.3.2.3.cmml"><mi id="S2.p2.13.m3.10.10.3.2.3.2.3.2" xref="S2.p2.13.m3.10.10.3.2.3.2.3.2.cmml">n</mi><mo id="S2.p2.13.m3.10.10.3.2.3.2.3.1" xref="S2.p2.13.m3.10.10.3.2.3.2.3.1.cmml">=</mo><mn id="S2.p2.13.m3.10.10.3.2.3.2.3.3" xref="S2.p2.13.m3.10.10.3.2.3.2.3.3.cmml">1</mn></mrow><msub id="S2.p2.13.m3.10.10.3.2.3.3" xref="S2.p2.13.m3.10.10.3.2.3.3.cmml"><mi id="S2.p2.13.m3.10.10.3.2.3.3.2" xref="S2.p2.13.m3.10.10.3.2.3.3.2.cmml">n</mi><mi id="S2.p2.13.m3.10.10.3.2.3.3.3" xref="S2.p2.13.m3.10.10.3.2.3.3.3.cmml">k</mi></msub></msubsup><mrow id="S2.p2.13.m3.10.10.3.2.2" xref="S2.p2.13.m3.10.10.3.2.2.cmml"><mi mathvariant="normal" id="S2.p2.13.m3.10.10.3.2.2.4" xref="S2.p2.13.m3.10.10.3.2.2.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S2.p2.13.m3.10.10.3.2.2.3" xref="S2.p2.13.m3.10.10.3.2.2.3.cmml">​</mo><mrow id="S2.p2.13.m3.10.10.3.2.2.2.2" xref="S2.p2.13.m3.10.10.3.2.2.2.3.cmml"><mo stretchy="false" id="S2.p2.13.m3.10.10.3.2.2.2.2.3" xref="S2.p2.13.m3.10.10.3.2.2.2.3.cmml">(</mo><mi id="S2.p2.13.m3.7.7" xref="S2.p2.13.m3.7.7.cmml">θ</mi><mo id="S2.p2.13.m3.10.10.3.2.2.2.2.4" xref="S2.p2.13.m3.10.10.3.2.2.2.3.cmml">;</mo><msubsup id="S2.p2.13.m3.9.9.2.1.1.1.1.1" xref="S2.p2.13.m3.9.9.2.1.1.1.1.1.cmml"><mi id="S2.p2.13.m3.9.9.2.1.1.1.1.1.2.2" xref="S2.p2.13.m3.9.9.2.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.p2.13.m3.9.9.2.1.1.1.1.1.2.3" xref="S2.p2.13.m3.9.9.2.1.1.1.1.1.2.3.cmml">k</mi><mi id="S2.p2.13.m3.9.9.2.1.1.1.1.1.3" xref="S2.p2.13.m3.9.9.2.1.1.1.1.1.3.cmml">n</mi></msubsup><mo id="S2.p2.13.m3.10.10.3.2.2.2.2.5" xref="S2.p2.13.m3.10.10.3.2.2.2.3.cmml">,</mo><msubsup id="S2.p2.13.m3.10.10.3.2.2.2.2.2" xref="S2.p2.13.m3.10.10.3.2.2.2.2.2.cmml"><mi id="S2.p2.13.m3.10.10.3.2.2.2.2.2.2.2" xref="S2.p2.13.m3.10.10.3.2.2.2.2.2.2.2.cmml">y</mi><mi id="S2.p2.13.m3.10.10.3.2.2.2.2.2.2.3" xref="S2.p2.13.m3.10.10.3.2.2.2.2.2.2.3.cmml">k</mi><mi id="S2.p2.13.m3.10.10.3.2.2.2.2.2.3" xref="S2.p2.13.m3.10.10.3.2.2.2.2.2.3.cmml">n</mi></msubsup><mo stretchy="false" id="S2.p2.13.m3.10.10.3.2.2.2.2.6" xref="S2.p2.13.m3.10.10.3.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.13.m3.10b"><apply id="S2.p2.13.m3.10.10.cmml" xref="S2.p2.13.m3.10.10"><and id="S2.p2.13.m3.10.10a.cmml" xref="S2.p2.13.m3.10.10"></and><apply id="S2.p2.13.m3.10.10b.cmml" xref="S2.p2.13.m3.10.10"><eq id="S2.p2.13.m3.10.10.6.cmml" xref="S2.p2.13.m3.10.10.6"></eq><apply id="S2.p2.13.m3.10.10.5.cmml" xref="S2.p2.13.m3.10.10.5"><times id="S2.p2.13.m3.10.10.5.1.cmml" xref="S2.p2.13.m3.10.10.5.1"></times><apply id="S2.p2.13.m3.10.10.5.2.cmml" xref="S2.p2.13.m3.10.10.5.2"><csymbol cd="ambiguous" id="S2.p2.13.m3.10.10.5.2.1.cmml" xref="S2.p2.13.m3.10.10.5.2">subscript</csymbol><ci id="S2.p2.13.m3.10.10.5.2.2.cmml" xref="S2.p2.13.m3.10.10.5.2.2">𝑓</ci><ci id="S2.p2.13.m3.10.10.5.2.3.cmml" xref="S2.p2.13.m3.10.10.5.2.3">𝑘</ci></apply><ci id="S2.p2.13.m3.3.3.cmml" xref="S2.p2.13.m3.3.3">𝜃</ci></apply><apply id="S2.p2.13.m3.8.8.1.cmml" xref="S2.p2.13.m3.8.8.1"><times id="S2.p2.13.m3.8.8.1.2.cmml" xref="S2.p2.13.m3.8.8.1.2"></times><apply id="S2.p2.13.m3.8.8.1.3.cmml" xref="S2.p2.13.m3.8.8.1.3"><csymbol cd="ambiguous" id="S2.p2.13.m3.8.8.1.3.1.cmml" xref="S2.p2.13.m3.8.8.1.3">subscript</csymbol><ci id="S2.p2.13.m3.8.8.1.3.2.cmml" xref="S2.p2.13.m3.8.8.1.3.2">𝔼</ci><apply id="S2.p2.13.m3.2.2.2.cmml" xref="S2.p2.13.m3.2.2.2"><csymbol cd="latexml" id="S2.p2.13.m3.2.2.2.3.cmml" xref="S2.p2.13.m3.2.2.2.3">similar-to</csymbol><interval closure="open" id="S2.p2.13.m3.2.2.2.4.1.cmml" xref="S2.p2.13.m3.2.2.2.4.2"><ci id="S2.p2.13.m3.1.1.1.1.cmml" xref="S2.p2.13.m3.1.1.1.1">𝑥</ci><ci id="S2.p2.13.m3.2.2.2.2.cmml" xref="S2.p2.13.m3.2.2.2.2">𝑦</ci></interval><apply id="S2.p2.13.m3.2.2.2.5.cmml" xref="S2.p2.13.m3.2.2.2.5"><csymbol cd="ambiguous" id="S2.p2.13.m3.2.2.2.5.1.cmml" xref="S2.p2.13.m3.2.2.2.5">subscript</csymbol><apply id="S2.p2.13.m3.2.2.2.5.2.cmml" xref="S2.p2.13.m3.2.2.2.5.2"><ci id="S2.p2.13.m3.2.2.2.5.2.1.cmml" xref="S2.p2.13.m3.2.2.2.5.2.1">^</ci><ci id="S2.p2.13.m3.2.2.2.5.2.2.cmml" xref="S2.p2.13.m3.2.2.2.5.2.2">𝐷</ci></apply><ci id="S2.p2.13.m3.2.2.2.5.3.cmml" xref="S2.p2.13.m3.2.2.2.5.3">𝑘</ci></apply></apply></apply><apply id="S2.p2.13.m3.8.8.1.1.2.cmml" xref="S2.p2.13.m3.8.8.1.1.1"><csymbol cd="latexml" id="S2.p2.13.m3.8.8.1.1.2.1.cmml" xref="S2.p2.13.m3.8.8.1.1.1.2">delimited-[]</csymbol><apply id="S2.p2.13.m3.8.8.1.1.1.1.cmml" xref="S2.p2.13.m3.8.8.1.1.1.1"><times id="S2.p2.13.m3.8.8.1.1.1.1.1.cmml" xref="S2.p2.13.m3.8.8.1.1.1.1.1"></times><ci id="S2.p2.13.m3.8.8.1.1.1.1.2.cmml" xref="S2.p2.13.m3.8.8.1.1.1.1.2">ℓ</ci><list id="S2.p2.13.m3.8.8.1.1.1.1.3.1.cmml" xref="S2.p2.13.m3.8.8.1.1.1.1.3.2"><ci id="S2.p2.13.m3.4.4.cmml" xref="S2.p2.13.m3.4.4">𝜃</ci><ci id="S2.p2.13.m3.5.5.cmml" xref="S2.p2.13.m3.5.5">𝑥</ci><ci id="S2.p2.13.m3.6.6.cmml" xref="S2.p2.13.m3.6.6">𝑦</ci></list></apply></apply></apply></apply><apply id="S2.p2.13.m3.10.10c.cmml" xref="S2.p2.13.m3.10.10"><eq id="S2.p2.13.m3.10.10.7.cmml" xref="S2.p2.13.m3.10.10.7"></eq><share href="#S2.p2.13.m3.8.8.1.cmml" id="S2.p2.13.m3.10.10d.cmml" xref="S2.p2.13.m3.10.10"></share><apply id="S2.p2.13.m3.10.10.3.cmml" xref="S2.p2.13.m3.10.10.3"><times id="S2.p2.13.m3.10.10.3.3.cmml" xref="S2.p2.13.m3.10.10.3.3"></times><apply id="S2.p2.13.m3.10.10.3.4.cmml" xref="S2.p2.13.m3.10.10.3.4"><divide id="S2.p2.13.m3.10.10.3.4.1.cmml" xref="S2.p2.13.m3.10.10.3.4"></divide><cn type="integer" id="S2.p2.13.m3.10.10.3.4.2.cmml" xref="S2.p2.13.m3.10.10.3.4.2">1</cn><apply id="S2.p2.13.m3.10.10.3.4.3.cmml" xref="S2.p2.13.m3.10.10.3.4.3"><csymbol cd="ambiguous" id="S2.p2.13.m3.10.10.3.4.3.1.cmml" xref="S2.p2.13.m3.10.10.3.4.3">subscript</csymbol><ci id="S2.p2.13.m3.10.10.3.4.3.2.cmml" xref="S2.p2.13.m3.10.10.3.4.3.2">𝑛</ci><ci id="S2.p2.13.m3.10.10.3.4.3.3.cmml" xref="S2.p2.13.m3.10.10.3.4.3.3">𝑘</ci></apply></apply><apply id="S2.p2.13.m3.10.10.3.2.cmml" xref="S2.p2.13.m3.10.10.3.2"><apply id="S2.p2.13.m3.10.10.3.2.3.cmml" xref="S2.p2.13.m3.10.10.3.2.3"><csymbol cd="ambiguous" id="S2.p2.13.m3.10.10.3.2.3.1.cmml" xref="S2.p2.13.m3.10.10.3.2.3">superscript</csymbol><apply id="S2.p2.13.m3.10.10.3.2.3.2.cmml" xref="S2.p2.13.m3.10.10.3.2.3"><csymbol cd="ambiguous" id="S2.p2.13.m3.10.10.3.2.3.2.1.cmml" xref="S2.p2.13.m3.10.10.3.2.3">subscript</csymbol><sum id="S2.p2.13.m3.10.10.3.2.3.2.2.cmml" xref="S2.p2.13.m3.10.10.3.2.3.2.2"></sum><apply id="S2.p2.13.m3.10.10.3.2.3.2.3.cmml" xref="S2.p2.13.m3.10.10.3.2.3.2.3"><eq id="S2.p2.13.m3.10.10.3.2.3.2.3.1.cmml" xref="S2.p2.13.m3.10.10.3.2.3.2.3.1"></eq><ci id="S2.p2.13.m3.10.10.3.2.3.2.3.2.cmml" xref="S2.p2.13.m3.10.10.3.2.3.2.3.2">𝑛</ci><cn type="integer" id="S2.p2.13.m3.10.10.3.2.3.2.3.3.cmml" xref="S2.p2.13.m3.10.10.3.2.3.2.3.3">1</cn></apply></apply><apply id="S2.p2.13.m3.10.10.3.2.3.3.cmml" xref="S2.p2.13.m3.10.10.3.2.3.3"><csymbol cd="ambiguous" id="S2.p2.13.m3.10.10.3.2.3.3.1.cmml" xref="S2.p2.13.m3.10.10.3.2.3.3">subscript</csymbol><ci id="S2.p2.13.m3.10.10.3.2.3.3.2.cmml" xref="S2.p2.13.m3.10.10.3.2.3.3.2">𝑛</ci><ci id="S2.p2.13.m3.10.10.3.2.3.3.3.cmml" xref="S2.p2.13.m3.10.10.3.2.3.3.3">𝑘</ci></apply></apply><apply id="S2.p2.13.m3.10.10.3.2.2.cmml" xref="S2.p2.13.m3.10.10.3.2.2"><times id="S2.p2.13.m3.10.10.3.2.2.3.cmml" xref="S2.p2.13.m3.10.10.3.2.2.3"></times><ci id="S2.p2.13.m3.10.10.3.2.2.4.cmml" xref="S2.p2.13.m3.10.10.3.2.2.4">ℓ</ci><list id="S2.p2.13.m3.10.10.3.2.2.2.3.cmml" xref="S2.p2.13.m3.10.10.3.2.2.2.2"><ci id="S2.p2.13.m3.7.7.cmml" xref="S2.p2.13.m3.7.7">𝜃</ci><apply id="S2.p2.13.m3.9.9.2.1.1.1.1.1.cmml" xref="S2.p2.13.m3.9.9.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.13.m3.9.9.2.1.1.1.1.1.1.cmml" xref="S2.p2.13.m3.9.9.2.1.1.1.1.1">superscript</csymbol><apply id="S2.p2.13.m3.9.9.2.1.1.1.1.1.2.cmml" xref="S2.p2.13.m3.9.9.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.13.m3.9.9.2.1.1.1.1.1.2.1.cmml" xref="S2.p2.13.m3.9.9.2.1.1.1.1.1">subscript</csymbol><ci id="S2.p2.13.m3.9.9.2.1.1.1.1.1.2.2.cmml" xref="S2.p2.13.m3.9.9.2.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.p2.13.m3.9.9.2.1.1.1.1.1.2.3.cmml" xref="S2.p2.13.m3.9.9.2.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S2.p2.13.m3.9.9.2.1.1.1.1.1.3.cmml" xref="S2.p2.13.m3.9.9.2.1.1.1.1.1.3">𝑛</ci></apply><apply id="S2.p2.13.m3.10.10.3.2.2.2.2.2.cmml" xref="S2.p2.13.m3.10.10.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p2.13.m3.10.10.3.2.2.2.2.2.1.cmml" xref="S2.p2.13.m3.10.10.3.2.2.2.2.2">superscript</csymbol><apply id="S2.p2.13.m3.10.10.3.2.2.2.2.2.2.cmml" xref="S2.p2.13.m3.10.10.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p2.13.m3.10.10.3.2.2.2.2.2.2.1.cmml" xref="S2.p2.13.m3.10.10.3.2.2.2.2.2">subscript</csymbol><ci id="S2.p2.13.m3.10.10.3.2.2.2.2.2.2.2.cmml" xref="S2.p2.13.m3.10.10.3.2.2.2.2.2.2.2">𝑦</ci><ci id="S2.p2.13.m3.10.10.3.2.2.2.2.2.2.3.cmml" xref="S2.p2.13.m3.10.10.3.2.2.2.2.2.2.3">𝑘</ci></apply><ci id="S2.p2.13.m3.10.10.3.2.2.2.2.2.3.cmml" xref="S2.p2.13.m3.10.10.3.2.2.2.2.2.3">𝑛</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.13.m3.10c">f_{k}(\theta)=\mathbb{E}_{(x,y)\sim\widehat{D}_{k}}[{\ell(\theta;x,y)}]=\frac{1}{n_{k}}\sum_{n=1}^{n_{k}}\ell(\theta;x_{k}^{n},y_{k}^{n})</annotation></semantics></math>. The term <math id="S2.p2.14.m4.1" class="ltx_Math" alttext="p_{k}" display="inline"><semantics id="S2.p2.14.m4.1a"><msub id="S2.p2.14.m4.1.1" xref="S2.p2.14.m4.1.1.cmml"><mi id="S2.p2.14.m4.1.1.2" xref="S2.p2.14.m4.1.1.2.cmml">p</mi><mi id="S2.p2.14.m4.1.1.3" xref="S2.p2.14.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.14.m4.1b"><apply id="S2.p2.14.m4.1.1.cmml" xref="S2.p2.14.m4.1.1"><csymbol cd="ambiguous" id="S2.p2.14.m4.1.1.1.cmml" xref="S2.p2.14.m4.1.1">subscript</csymbol><ci id="S2.p2.14.m4.1.1.2.cmml" xref="S2.p2.14.m4.1.1.2">𝑝</ci><ci id="S2.p2.14.m4.1.1.3.cmml" xref="S2.p2.14.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.14.m4.1c">p_{k}</annotation></semantics></math> (<math id="S2.p2.15.m5.1" class="ltx_Math" alttext="p_{k}\geq 0" display="inline"><semantics id="S2.p2.15.m5.1a"><mrow id="S2.p2.15.m5.1.1" xref="S2.p2.15.m5.1.1.cmml"><msub id="S2.p2.15.m5.1.1.2" xref="S2.p2.15.m5.1.1.2.cmml"><mi id="S2.p2.15.m5.1.1.2.2" xref="S2.p2.15.m5.1.1.2.2.cmml">p</mi><mi id="S2.p2.15.m5.1.1.2.3" xref="S2.p2.15.m5.1.1.2.3.cmml">k</mi></msub><mo id="S2.p2.15.m5.1.1.1" xref="S2.p2.15.m5.1.1.1.cmml">≥</mo><mn id="S2.p2.15.m5.1.1.3" xref="S2.p2.15.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.15.m5.1b"><apply id="S2.p2.15.m5.1.1.cmml" xref="S2.p2.15.m5.1.1"><geq id="S2.p2.15.m5.1.1.1.cmml" xref="S2.p2.15.m5.1.1.1"></geq><apply id="S2.p2.15.m5.1.1.2.cmml" xref="S2.p2.15.m5.1.1.2"><csymbol cd="ambiguous" id="S2.p2.15.m5.1.1.2.1.cmml" xref="S2.p2.15.m5.1.1.2">subscript</csymbol><ci id="S2.p2.15.m5.1.1.2.2.cmml" xref="S2.p2.15.m5.1.1.2.2">𝑝</ci><ci id="S2.p2.15.m5.1.1.2.3.cmml" xref="S2.p2.15.m5.1.1.2.3">𝑘</ci></apply><cn type="integer" id="S2.p2.15.m5.1.1.3.cmml" xref="S2.p2.15.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.15.m5.1c">p_{k}\geq 0</annotation></semantics></math> and <math id="S2.p2.16.m6.1" class="ltx_Math" alttext="\sum_{k}p_{k}=1" display="inline"><semantics id="S2.p2.16.m6.1a"><mrow id="S2.p2.16.m6.1.1" xref="S2.p2.16.m6.1.1.cmml"><mrow id="S2.p2.16.m6.1.1.2" xref="S2.p2.16.m6.1.1.2.cmml"><msub id="S2.p2.16.m6.1.1.2.1" xref="S2.p2.16.m6.1.1.2.1.cmml"><mo id="S2.p2.16.m6.1.1.2.1.2" xref="S2.p2.16.m6.1.1.2.1.2.cmml">∑</mo><mi id="S2.p2.16.m6.1.1.2.1.3" xref="S2.p2.16.m6.1.1.2.1.3.cmml">k</mi></msub><msub id="S2.p2.16.m6.1.1.2.2" xref="S2.p2.16.m6.1.1.2.2.cmml"><mi id="S2.p2.16.m6.1.1.2.2.2" xref="S2.p2.16.m6.1.1.2.2.2.cmml">p</mi><mi id="S2.p2.16.m6.1.1.2.2.3" xref="S2.p2.16.m6.1.1.2.2.3.cmml">k</mi></msub></mrow><mo id="S2.p2.16.m6.1.1.1" xref="S2.p2.16.m6.1.1.1.cmml">=</mo><mn id="S2.p2.16.m6.1.1.3" xref="S2.p2.16.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.16.m6.1b"><apply id="S2.p2.16.m6.1.1.cmml" xref="S2.p2.16.m6.1.1"><eq id="S2.p2.16.m6.1.1.1.cmml" xref="S2.p2.16.m6.1.1.1"></eq><apply id="S2.p2.16.m6.1.1.2.cmml" xref="S2.p2.16.m6.1.1.2"><apply id="S2.p2.16.m6.1.1.2.1.cmml" xref="S2.p2.16.m6.1.1.2.1"><csymbol cd="ambiguous" id="S2.p2.16.m6.1.1.2.1.1.cmml" xref="S2.p2.16.m6.1.1.2.1">subscript</csymbol><sum id="S2.p2.16.m6.1.1.2.1.2.cmml" xref="S2.p2.16.m6.1.1.2.1.2"></sum><ci id="S2.p2.16.m6.1.1.2.1.3.cmml" xref="S2.p2.16.m6.1.1.2.1.3">𝑘</ci></apply><apply id="S2.p2.16.m6.1.1.2.2.cmml" xref="S2.p2.16.m6.1.1.2.2"><csymbol cd="ambiguous" id="S2.p2.16.m6.1.1.2.2.1.cmml" xref="S2.p2.16.m6.1.1.2.2">subscript</csymbol><ci id="S2.p2.16.m6.1.1.2.2.2.cmml" xref="S2.p2.16.m6.1.1.2.2.2">𝑝</ci><ci id="S2.p2.16.m6.1.1.2.2.3.cmml" xref="S2.p2.16.m6.1.1.2.2.3">𝑘</ci></apply></apply><cn type="integer" id="S2.p2.16.m6.1.1.3.cmml" xref="S2.p2.16.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.16.m6.1c">\sum_{k}p_{k}=1</annotation></semantics></math>) specifies the relative importance of each client, with two settings being <math id="S2.p2.17.m7.1" class="ltx_Math" alttext="p_{k}=\frac{1}{N}" display="inline"><semantics id="S2.p2.17.m7.1a"><mrow id="S2.p2.17.m7.1.1" xref="S2.p2.17.m7.1.1.cmml"><msub id="S2.p2.17.m7.1.1.2" xref="S2.p2.17.m7.1.1.2.cmml"><mi id="S2.p2.17.m7.1.1.2.2" xref="S2.p2.17.m7.1.1.2.2.cmml">p</mi><mi id="S2.p2.17.m7.1.1.2.3" xref="S2.p2.17.m7.1.1.2.3.cmml">k</mi></msub><mo id="S2.p2.17.m7.1.1.1" xref="S2.p2.17.m7.1.1.1.cmml">=</mo><mfrac id="S2.p2.17.m7.1.1.3" xref="S2.p2.17.m7.1.1.3.cmml"><mn id="S2.p2.17.m7.1.1.3.2" xref="S2.p2.17.m7.1.1.3.2.cmml">1</mn><mi id="S2.p2.17.m7.1.1.3.3" xref="S2.p2.17.m7.1.1.3.3.cmml">N</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.17.m7.1b"><apply id="S2.p2.17.m7.1.1.cmml" xref="S2.p2.17.m7.1.1"><eq id="S2.p2.17.m7.1.1.1.cmml" xref="S2.p2.17.m7.1.1.1"></eq><apply id="S2.p2.17.m7.1.1.2.cmml" xref="S2.p2.17.m7.1.1.2"><csymbol cd="ambiguous" id="S2.p2.17.m7.1.1.2.1.cmml" xref="S2.p2.17.m7.1.1.2">subscript</csymbol><ci id="S2.p2.17.m7.1.1.2.2.cmml" xref="S2.p2.17.m7.1.1.2.2">𝑝</ci><ci id="S2.p2.17.m7.1.1.2.3.cmml" xref="S2.p2.17.m7.1.1.2.3">𝑘</ci></apply><apply id="S2.p2.17.m7.1.1.3.cmml" xref="S2.p2.17.m7.1.1.3"><divide id="S2.p2.17.m7.1.1.3.1.cmml" xref="S2.p2.17.m7.1.1.3"></divide><cn type="integer" id="S2.p2.17.m7.1.1.3.2.cmml" xref="S2.p2.17.m7.1.1.3.2">1</cn><ci id="S2.p2.17.m7.1.1.3.3.cmml" xref="S2.p2.17.m7.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.17.m7.1c">p_{k}=\frac{1}{N}</annotation></semantics></math> or <math id="S2.p2.18.m8.1" class="ltx_Math" alttext="p_{k}=\frac{n_{k}}{N}" display="inline"><semantics id="S2.p2.18.m8.1a"><mrow id="S2.p2.18.m8.1.1" xref="S2.p2.18.m8.1.1.cmml"><msub id="S2.p2.18.m8.1.1.2" xref="S2.p2.18.m8.1.1.2.cmml"><mi id="S2.p2.18.m8.1.1.2.2" xref="S2.p2.18.m8.1.1.2.2.cmml">p</mi><mi id="S2.p2.18.m8.1.1.2.3" xref="S2.p2.18.m8.1.1.2.3.cmml">k</mi></msub><mo id="S2.p2.18.m8.1.1.1" xref="S2.p2.18.m8.1.1.1.cmml">=</mo><mfrac id="S2.p2.18.m8.1.1.3" xref="S2.p2.18.m8.1.1.3.cmml"><msub id="S2.p2.18.m8.1.1.3.2" xref="S2.p2.18.m8.1.1.3.2.cmml"><mi id="S2.p2.18.m8.1.1.3.2.2" xref="S2.p2.18.m8.1.1.3.2.2.cmml">n</mi><mi id="S2.p2.18.m8.1.1.3.2.3" xref="S2.p2.18.m8.1.1.3.2.3.cmml">k</mi></msub><mi id="S2.p2.18.m8.1.1.3.3" xref="S2.p2.18.m8.1.1.3.3.cmml">N</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.18.m8.1b"><apply id="S2.p2.18.m8.1.1.cmml" xref="S2.p2.18.m8.1.1"><eq id="S2.p2.18.m8.1.1.1.cmml" xref="S2.p2.18.m8.1.1.1"></eq><apply id="S2.p2.18.m8.1.1.2.cmml" xref="S2.p2.18.m8.1.1.2"><csymbol cd="ambiguous" id="S2.p2.18.m8.1.1.2.1.cmml" xref="S2.p2.18.m8.1.1.2">subscript</csymbol><ci id="S2.p2.18.m8.1.1.2.2.cmml" xref="S2.p2.18.m8.1.1.2.2">𝑝</ci><ci id="S2.p2.18.m8.1.1.2.3.cmml" xref="S2.p2.18.m8.1.1.2.3">𝑘</ci></apply><apply id="S2.p2.18.m8.1.1.3.cmml" xref="S2.p2.18.m8.1.1.3"><divide id="S2.p2.18.m8.1.1.3.1.cmml" xref="S2.p2.18.m8.1.1.3"></divide><apply id="S2.p2.18.m8.1.1.3.2.cmml" xref="S2.p2.18.m8.1.1.3.2"><csymbol cd="ambiguous" id="S2.p2.18.m8.1.1.3.2.1.cmml" xref="S2.p2.18.m8.1.1.3.2">subscript</csymbol><ci id="S2.p2.18.m8.1.1.3.2.2.cmml" xref="S2.p2.18.m8.1.1.3.2.2">𝑛</ci><ci id="S2.p2.18.m8.1.1.3.2.3.cmml" xref="S2.p2.18.m8.1.1.3.2.3">𝑘</ci></apply><ci id="S2.p2.18.m8.1.1.3.3.cmml" xref="S2.p2.18.m8.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.18.m8.1c">p_{k}=\frac{n_{k}}{N}</annotation></semantics></math>, where <math id="S2.p2.19.m9.1" class="ltx_Math" alttext="N=\sum_{k}n_{k}" display="inline"><semantics id="S2.p2.19.m9.1a"><mrow id="S2.p2.19.m9.1.1" xref="S2.p2.19.m9.1.1.cmml"><mi id="S2.p2.19.m9.1.1.2" xref="S2.p2.19.m9.1.1.2.cmml">N</mi><mo rspace="0.111em" id="S2.p2.19.m9.1.1.1" xref="S2.p2.19.m9.1.1.1.cmml">=</mo><mrow id="S2.p2.19.m9.1.1.3" xref="S2.p2.19.m9.1.1.3.cmml"><msub id="S2.p2.19.m9.1.1.3.1" xref="S2.p2.19.m9.1.1.3.1.cmml"><mo id="S2.p2.19.m9.1.1.3.1.2" xref="S2.p2.19.m9.1.1.3.1.2.cmml">∑</mo><mi id="S2.p2.19.m9.1.1.3.1.3" xref="S2.p2.19.m9.1.1.3.1.3.cmml">k</mi></msub><msub id="S2.p2.19.m9.1.1.3.2" xref="S2.p2.19.m9.1.1.3.2.cmml"><mi id="S2.p2.19.m9.1.1.3.2.2" xref="S2.p2.19.m9.1.1.3.2.2.cmml">n</mi><mi id="S2.p2.19.m9.1.1.3.2.3" xref="S2.p2.19.m9.1.1.3.2.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.19.m9.1b"><apply id="S2.p2.19.m9.1.1.cmml" xref="S2.p2.19.m9.1.1"><eq id="S2.p2.19.m9.1.1.1.cmml" xref="S2.p2.19.m9.1.1.1"></eq><ci id="S2.p2.19.m9.1.1.2.cmml" xref="S2.p2.19.m9.1.1.2">𝑁</ci><apply id="S2.p2.19.m9.1.1.3.cmml" xref="S2.p2.19.m9.1.1.3"><apply id="S2.p2.19.m9.1.1.3.1.cmml" xref="S2.p2.19.m9.1.1.3.1"><csymbol cd="ambiguous" id="S2.p2.19.m9.1.1.3.1.1.cmml" xref="S2.p2.19.m9.1.1.3.1">subscript</csymbol><sum id="S2.p2.19.m9.1.1.3.1.2.cmml" xref="S2.p2.19.m9.1.1.3.1.2"></sum><ci id="S2.p2.19.m9.1.1.3.1.3.cmml" xref="S2.p2.19.m9.1.1.3.1.3">𝑘</ci></apply><apply id="S2.p2.19.m9.1.1.3.2.cmml" xref="S2.p2.19.m9.1.1.3.2"><csymbol cd="ambiguous" id="S2.p2.19.m9.1.1.3.2.1.cmml" xref="S2.p2.19.m9.1.1.3.2">subscript</csymbol><ci id="S2.p2.19.m9.1.1.3.2.2.cmml" xref="S2.p2.19.m9.1.1.3.2.2">𝑛</ci><ci id="S2.p2.19.m9.1.1.3.2.3.cmml" xref="S2.p2.19.m9.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.19.m9.1c">N=\sum_{k}n_{k}</annotation></semantics></math> is the total number of samples.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.4" class="ltx_p"><span id="S2.p3.4.1" class="ltx_text ltx_font_bold">Distributionally robust federated learning (Worst-case formulation).</span> While Equation <a href="#S2.E1" title="Equation 1 ‣ 2 Preliminaries ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> can build a global model with good <span id="S2.p3.4.2" class="ltx_text ltx_font_italic">average performance</span> on in-federation clients, it may not necessarily guarantee good performance in the presence of heterogeneous data. In the real world, data could be statistically heterogeneous due to different data acquisition protocols or various local demographics <cite class="ltx_cite ltx_citemacro_citep">(Rieke et al., <a href="#bib.bib46" title="" class="ltx_ref">2020</a>)</cite>. Thus, the local data distributions may deviate significantly from the average distribution, implying that an “average” global model can fail catastrophically under distributional drift.
To tackle this issue, distributionally robust optimization <cite class="ltx_cite ltx_citemacro_citep">(Staib &amp; Jegelka, <a href="#bib.bib56" title="" class="ltx_ref">2019</a>)</cite> has been adapted to FL, resulting in distributionally robust federated learning <cite class="ltx_cite ltx_citemacro_citep">(Deng et al., <a href="#bib.bib8" title="" class="ltx_ref">2020</a>; Reisizadeh et al., <a href="#bib.bib45" title="" class="ltx_ref">2020</a>)</cite>. The formulation of this new problem is as follows:</p>
<table id="S2.E2" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S2.E2X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\min_{\theta\in\Theta}\,\max_{\bm{\lambda}\in\Delta_{K}}" display="inline"><semantics id="S2.E2X.2.1.1.m1.1a"><mrow id="S2.E2X.2.1.1.m1.1.1" xref="S2.E2X.2.1.1.m1.1.1.cmml"><munder id="S2.E2X.2.1.1.m1.1.1.1" xref="S2.E2X.2.1.1.m1.1.1.1.cmml"><mi id="S2.E2X.2.1.1.m1.1.1.1.2" xref="S2.E2X.2.1.1.m1.1.1.1.2.cmml">min</mi><mrow id="S2.E2X.2.1.1.m1.1.1.1.3" xref="S2.E2X.2.1.1.m1.1.1.1.3.cmml"><mi id="S2.E2X.2.1.1.m1.1.1.1.3.2" xref="S2.E2X.2.1.1.m1.1.1.1.3.2.cmml">θ</mi><mo id="S2.E2X.2.1.1.m1.1.1.1.3.1" xref="S2.E2X.2.1.1.m1.1.1.1.3.1.cmml">∈</mo><mi mathvariant="normal" id="S2.E2X.2.1.1.m1.1.1.1.3.3" xref="S2.E2X.2.1.1.m1.1.1.1.3.3.cmml">Θ</mi></mrow></munder><mo lspace="0.337em" id="S2.E2X.2.1.1.m1.1.1a" xref="S2.E2X.2.1.1.m1.1.1.cmml">⁡</mo><munder id="S2.E2X.2.1.1.m1.1.1.2" xref="S2.E2X.2.1.1.m1.1.1.2.cmml"><mi id="S2.E2X.2.1.1.m1.1.1.2.2" xref="S2.E2X.2.1.1.m1.1.1.2.2.cmml">max</mi><mrow id="S2.E2X.2.1.1.m1.1.1.2.3" xref="S2.E2X.2.1.1.m1.1.1.2.3.cmml"><mi id="S2.E2X.2.1.1.m1.1.1.2.3.2" xref="S2.E2X.2.1.1.m1.1.1.2.3.2.cmml">𝝀</mi><mo id="S2.E2X.2.1.1.m1.1.1.2.3.1" xref="S2.E2X.2.1.1.m1.1.1.2.3.1.cmml">∈</mo><msub id="S2.E2X.2.1.1.m1.1.1.2.3.3" xref="S2.E2X.2.1.1.m1.1.1.2.3.3.cmml"><mi mathvariant="normal" id="S2.E2X.2.1.1.m1.1.1.2.3.3.2" xref="S2.E2X.2.1.1.m1.1.1.2.3.3.2.cmml">Δ</mi><mi id="S2.E2X.2.1.1.m1.1.1.2.3.3.3" xref="S2.E2X.2.1.1.m1.1.1.2.3.3.3.cmml">K</mi></msub></mrow></munder></mrow><annotation-xml encoding="MathML-Content" id="S2.E2X.2.1.1.m1.1b"><apply id="S2.E2X.2.1.1.m1.1.1.cmml" xref="S2.E2X.2.1.1.m1.1.1"><apply id="S2.E2X.2.1.1.m1.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.1.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.1.1.1">subscript</csymbol><min id="S2.E2X.2.1.1.m1.1.1.1.2.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.2"></min><apply id="S2.E2X.2.1.1.m1.1.1.1.3.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.3"><in id="S2.E2X.2.1.1.m1.1.1.1.3.1.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.3.1"></in><ci id="S2.E2X.2.1.1.m1.1.1.1.3.2.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.3.2">𝜃</ci><ci id="S2.E2X.2.1.1.m1.1.1.1.3.3.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.3.3">Θ</ci></apply></apply><apply id="S2.E2X.2.1.1.m1.1.1.2.cmml" xref="S2.E2X.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.1.1.2.1.cmml" xref="S2.E2X.2.1.1.m1.1.1.2">subscript</csymbol><max id="S2.E2X.2.1.1.m1.1.1.2.2.cmml" xref="S2.E2X.2.1.1.m1.1.1.2.2"></max><apply id="S2.E2X.2.1.1.m1.1.1.2.3.cmml" xref="S2.E2X.2.1.1.m1.1.1.2.3"><in id="S2.E2X.2.1.1.m1.1.1.2.3.1.cmml" xref="S2.E2X.2.1.1.m1.1.1.2.3.1"></in><ci id="S2.E2X.2.1.1.m1.1.1.2.3.2.cmml" xref="S2.E2X.2.1.1.m1.1.1.2.3.2">𝝀</ci><apply id="S2.E2X.2.1.1.m1.1.1.2.3.3.cmml" xref="S2.E2X.2.1.1.m1.1.1.2.3.3"><csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.1.1.2.3.3.1.cmml" xref="S2.E2X.2.1.1.m1.1.1.2.3.3">subscript</csymbol><ci id="S2.E2X.2.1.1.m1.1.1.2.3.3.2.cmml" xref="S2.E2X.2.1.1.m1.1.1.2.3.3.2">Δ</ci><ci id="S2.E2X.2.1.1.m1.1.1.2.3.3.3.cmml" xref="S2.E2X.2.1.1.m1.1.1.2.3.3.3">𝐾</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2X.2.1.1.m1.1c">\displaystyle\min_{\theta\in\Theta}\,\max_{\bm{\lambda}\in\Delta_{K}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E2X.3.2.2.m1.4" class="ltx_Math" alttext="\displaystyle F(\theta,\bm{\lambda}):=\sum_{k=1}^{K}\lambda_{k}f_{k}(\theta)," display="inline"><semantics id="S2.E2X.3.2.2.m1.4a"><mrow id="S2.E2X.3.2.2.m1.4.4.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.cmml"><mrow id="S2.E2X.3.2.2.m1.4.4.1.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.cmml"><mrow id="S2.E2X.3.2.2.m1.4.4.1.1.2" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.cmml"><mi id="S2.E2X.3.2.2.m1.4.4.1.1.2.2" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.E2X.3.2.2.m1.4.4.1.1.2.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.1.cmml">​</mo><mrow id="S2.E2X.3.2.2.m1.4.4.1.1.2.3.2" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.3.1.cmml"><mo stretchy="false" id="S2.E2X.3.2.2.m1.4.4.1.1.2.3.2.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.3.1.cmml">(</mo><mi id="S2.E2X.3.2.2.m1.1.1" xref="S2.E2X.3.2.2.m1.1.1.cmml">θ</mi><mo id="S2.E2X.3.2.2.m1.4.4.1.1.2.3.2.2" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.3.1.cmml">,</mo><mi id="S2.E2X.3.2.2.m1.2.2" xref="S2.E2X.3.2.2.m1.2.2.cmml">𝝀</mi><mo rspace="0.278em" stretchy="false" id="S2.E2X.3.2.2.m1.4.4.1.1.2.3.2.3" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S2.E2X.3.2.2.m1.4.4.1.1.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.cmml">:=</mo><mrow id="S2.E2X.3.2.2.m1.4.4.1.1.3" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.cmml"><mstyle displaystyle="true" id="S2.E2X.3.2.2.m1.4.4.1.1.3.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.1.cmml"><munderover id="S2.E2X.3.2.2.m1.4.4.1.1.3.1a" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.1.cmml"><mo movablelimits="false" id="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.2" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.3" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.3.cmml"><mi id="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.3.2" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.3.2.cmml">k</mi><mo id="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.3.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.3.3" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E2X.3.2.2.m1.4.4.1.1.3.1.3" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.1.3.cmml">K</mi></munderover></mstyle><mrow id="S2.E2X.3.2.2.m1.4.4.1.1.3.2" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.cmml"><msub id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.2" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.2.cmml"><mi id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.2.2" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.2.2.cmml">λ</mi><mi id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.2.3" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.1.cmml">​</mo><msub id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.3" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.3.cmml"><mi id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.3.2" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.3.2.cmml">f</mi><mi id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.3.3" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.1a" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.1.cmml">​</mo><mrow id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.4.2" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.cmml"><mo stretchy="false" id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.4.2.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.cmml">(</mo><mi id="S2.E2X.3.2.2.m1.3.3" xref="S2.E2X.3.2.2.m1.3.3.cmml">θ</mi><mo stretchy="false" id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.4.2.2" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E2X.3.2.2.m1.4.4.1.2" xref="S2.E2X.3.2.2.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2X.3.2.2.m1.4b"><apply id="S2.E2X.3.2.2.m1.4.4.1.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1"><csymbol cd="latexml" id="S2.E2X.3.2.2.m1.4.4.1.1.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.1">assign</csymbol><apply id="S2.E2X.3.2.2.m1.4.4.1.1.2.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2"><times id="S2.E2X.3.2.2.m1.4.4.1.1.2.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.1"></times><ci id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2">𝐹</ci><interval closure="open" id="S2.E2X.3.2.2.m1.4.4.1.1.2.3.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.3.2"><ci id="S2.E2X.3.2.2.m1.1.1.cmml" xref="S2.E2X.3.2.2.m1.1.1">𝜃</ci><ci id="S2.E2X.3.2.2.m1.2.2.cmml" xref="S2.E2X.3.2.2.m1.2.2">𝝀</ci></interval></apply><apply id="S2.E2X.3.2.2.m1.4.4.1.1.3.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3"><apply id="S2.E2X.3.2.2.m1.4.4.1.1.3.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.1"><csymbol cd="ambiguous" id="S2.E2X.3.2.2.m1.4.4.1.1.3.1.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.1">superscript</csymbol><apply id="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.1"><csymbol cd="ambiguous" id="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.1">subscript</csymbol><sum id="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.2.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.2"></sum><apply id="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.3.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.3"><eq id="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.3.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.3.1"></eq><ci id="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.3.2.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.3.3.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E2X.3.2.2.m1.4.4.1.1.3.1.3.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.1.3">𝐾</ci></apply><apply id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2"><times id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.1"></times><apply id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.2.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.2.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.2">subscript</csymbol><ci id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.2.2.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.2.2">𝜆</ci><ci id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.2.3.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.2.3">𝑘</ci></apply><apply id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.3.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.3.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.3">subscript</csymbol><ci id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.3.2.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.3.2">𝑓</ci><ci id="S2.E2X.3.2.2.m1.4.4.1.1.3.2.3.3.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.2.3.3">𝑘</ci></apply><ci id="S2.E2X.3.2.2.m1.3.3.cmml" xref="S2.E2X.3.2.2.m1.3.3">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2X.3.2.2.m1.4c">\displaystyle F(\theta,\bm{\lambda}):=\sum_{k=1}^{K}\lambda_{k}f_{k}(\theta),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
</tbody>
</table>
<p id="S2.p3.3" class="ltx_p">where <math id="S2.p3.1.m1.1" class="ltx_Math" alttext="\bm{\lambda}" display="inline"><semantics id="S2.p3.1.m1.1a"><mi id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml">𝝀</mi><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><ci id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1">𝝀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">\bm{\lambda}</annotation></semantics></math> is the global weight for each local loss function and <math id="S2.p3.2.m2.1" class="ltx_Math" alttext="\Delta_{K}" display="inline"><semantics id="S2.p3.2.m2.1a"><msub id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml"><mi mathvariant="normal" id="S2.p3.2.m2.1.1.2" xref="S2.p3.2.m2.1.1.2.cmml">Δ</mi><mi id="S2.p3.2.m2.1.1.3" xref="S2.p3.2.m2.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><apply id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p3.2.m2.1.1.1.cmml" xref="S2.p3.2.m2.1.1">subscript</csymbol><ci id="S2.p3.2.m2.1.1.2.cmml" xref="S2.p3.2.m2.1.1.2">Δ</ci><ci id="S2.p3.2.m2.1.1.3.cmml" xref="S2.p3.2.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">\Delta_{K}</annotation></semantics></math> denotes the <math id="S2.p3.3.m3.1" class="ltx_Math" alttext="K-1" display="inline"><semantics id="S2.p3.3.m3.1a"><mrow id="S2.p3.3.m3.1.1" xref="S2.p3.3.m3.1.1.cmml"><mi id="S2.p3.3.m3.1.1.2" xref="S2.p3.3.m3.1.1.2.cmml">K</mi><mo id="S2.p3.3.m3.1.1.1" xref="S2.p3.3.m3.1.1.1.cmml">−</mo><mn id="S2.p3.3.m3.1.1.3" xref="S2.p3.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.3.m3.1b"><apply id="S2.p3.3.m3.1.1.cmml" xref="S2.p3.3.m3.1.1"><minus id="S2.p3.3.m3.1.1.1.cmml" xref="S2.p3.3.m3.1.1.1"></minus><ci id="S2.p3.3.m3.1.1.2.cmml" xref="S2.p3.3.m3.1.1.2">𝐾</ci><cn type="integer" id="S2.p3.3.m3.1.1.3.cmml" xref="S2.p3.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m3.1c">K-1</annotation></semantics></math> probability simplex. Intuitively, Equation <a href="#S2.E2" title="Equation 2 ‣ 2 Preliminaries ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> minimizes the maximal risk over the combination of empirical local distributions, and therefore the worst-case clients would be prioritized during training.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">While this framework has the potential to address distribution shifts <cite class="ltx_cite ltx_citemacro_citep">(Mohri et al., <a href="#bib.bib35" title="" class="ltx_ref">2019</a>; Qiao &amp; Peng, <a href="#bib.bib44" title="" class="ltx_ref">2023</a>; Deng et al., <a href="#bib.bib8" title="" class="ltx_ref">2020</a>)</cite>, directly implementing it for OOF resiliency may yield suboptimal models. This approach heavily relies on <span id="S2.p4.1.1" class="ltx_text ltx_font_italic">worst-case clients</span>, those with large empirical risks, to develop robust models. However, these clients may not necessarily be the <span id="S2.p4.1.2" class="ltx_text ltx_font_italic">influential ones</span> that are representative of clients. In some cases, it is possible that this approach overly focuses on “outlier” clients, clients that are significantly different from most of the training clients, leading to models with limited OOF robustness. Therefore, we argue that, to build optimal OOF-resilient models, the optimization process should focus on not only the worst-case but also the influential clients.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.9" class="ltx_p">In this section, we introduce the proposed <span id="S3.p1.9.1" class="ltx_text ltx_font_italic">Topology-aware Federated Learning</span> (TFL) framework. TFL aims to leverage client topology to improve the model’s OOF robustness.
We use graphs as tools to describe the client topology because they provide a flexible way to represent the relationship between distributed clients <cite class="ltx_cite ltx_citemacro_citep">(Dong et al., <a href="#bib.bib9" title="" class="ltx_ref">2019</a>; Mateos et al., <a href="#bib.bib31" title="" class="ltx_ref">2019</a>)</cite>. Specifically, we model client topology using an undirected graph <cite class="ltx_cite ltx_citemacro_citep">(Vanhaesebrouck et al., <a href="#bib.bib61" title="" class="ltx_ref">2017</a>; Ye et al., <a href="#bib.bib72" title="" class="ltx_ref">2023</a>)</cite>. In the graph, nodes correspond to clients, and edges reflect client connectivity. Let <math id="S3.p1.1.m1.3" class="ltx_Math" alttext="\mathcal{G}=(V,E,W)" display="inline"><semantics id="S3.p1.1.m1.3a"><mrow id="S3.p1.1.m1.3.4" xref="S3.p1.1.m1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.1.m1.3.4.2" xref="S3.p1.1.m1.3.4.2.cmml">𝒢</mi><mo id="S3.p1.1.m1.3.4.1" xref="S3.p1.1.m1.3.4.1.cmml">=</mo><mrow id="S3.p1.1.m1.3.4.3.2" xref="S3.p1.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="S3.p1.1.m1.3.4.3.2.1" xref="S3.p1.1.m1.3.4.3.1.cmml">(</mo><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">V</mi><mo id="S3.p1.1.m1.3.4.3.2.2" xref="S3.p1.1.m1.3.4.3.1.cmml">,</mo><mi id="S3.p1.1.m1.2.2" xref="S3.p1.1.m1.2.2.cmml">E</mi><mo id="S3.p1.1.m1.3.4.3.2.3" xref="S3.p1.1.m1.3.4.3.1.cmml">,</mo><mi id="S3.p1.1.m1.3.3" xref="S3.p1.1.m1.3.3.cmml">W</mi><mo stretchy="false" id="S3.p1.1.m1.3.4.3.2.4" xref="S3.p1.1.m1.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.3b"><apply id="S3.p1.1.m1.3.4.cmml" xref="S3.p1.1.m1.3.4"><eq id="S3.p1.1.m1.3.4.1.cmml" xref="S3.p1.1.m1.3.4.1"></eq><ci id="S3.p1.1.m1.3.4.2.cmml" xref="S3.p1.1.m1.3.4.2">𝒢</ci><vector id="S3.p1.1.m1.3.4.3.1.cmml" xref="S3.p1.1.m1.3.4.3.2"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑉</ci><ci id="S3.p1.1.m1.2.2.cmml" xref="S3.p1.1.m1.2.2">𝐸</ci><ci id="S3.p1.1.m1.3.3.cmml" xref="S3.p1.1.m1.3.3">𝑊</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.3c">\mathcal{G}=(V,E,W)</annotation></semantics></math> denote the client topology, where <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">V</annotation></semantics></math> is the node set with <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="\left|V\right|=K" display="inline"><semantics id="S3.p1.3.m3.1a"><mrow id="S3.p1.3.m3.1.2" xref="S3.p1.3.m3.1.2.cmml"><mrow id="S3.p1.3.m3.1.2.2.2" xref="S3.p1.3.m3.1.2.2.1.cmml"><mo id="S3.p1.3.m3.1.2.2.2.1" xref="S3.p1.3.m3.1.2.2.1.1.cmml">|</mo><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">V</mi><mo id="S3.p1.3.m3.1.2.2.2.2" xref="S3.p1.3.m3.1.2.2.1.1.cmml">|</mo></mrow><mo id="S3.p1.3.m3.1.2.1" xref="S3.p1.3.m3.1.2.1.cmml">=</mo><mi id="S3.p1.3.m3.1.2.3" xref="S3.p1.3.m3.1.2.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><apply id="S3.p1.3.m3.1.2.cmml" xref="S3.p1.3.m3.1.2"><eq id="S3.p1.3.m3.1.2.1.cmml" xref="S3.p1.3.m3.1.2.1"></eq><apply id="S3.p1.3.m3.1.2.2.1.cmml" xref="S3.p1.3.m3.1.2.2.2"><abs id="S3.p1.3.m3.1.2.2.1.1.cmml" xref="S3.p1.3.m3.1.2.2.2.1"></abs><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑉</ci></apply><ci id="S3.p1.3.m3.1.2.3.cmml" xref="S3.p1.3.m3.1.2.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">\left|V\right|=K</annotation></semantics></math>, <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="E\subseteq V\times V" display="inline"><semantics id="S3.p1.4.m4.1a"><mrow id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml"><mi id="S3.p1.4.m4.1.1.2" xref="S3.p1.4.m4.1.1.2.cmml">E</mi><mo id="S3.p1.4.m4.1.1.1" xref="S3.p1.4.m4.1.1.1.cmml">⊆</mo><mrow id="S3.p1.4.m4.1.1.3" xref="S3.p1.4.m4.1.1.3.cmml"><mi id="S3.p1.4.m4.1.1.3.2" xref="S3.p1.4.m4.1.1.3.2.cmml">V</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p1.4.m4.1.1.3.1" xref="S3.p1.4.m4.1.1.3.1.cmml">×</mo><mi id="S3.p1.4.m4.1.1.3.3" xref="S3.p1.4.m4.1.1.3.3.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1"><subset id="S3.p1.4.m4.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1"></subset><ci id="S3.p1.4.m4.1.1.2.cmml" xref="S3.p1.4.m4.1.1.2">𝐸</ci><apply id="S3.p1.4.m4.1.1.3.cmml" xref="S3.p1.4.m4.1.1.3"><times id="S3.p1.4.m4.1.1.3.1.cmml" xref="S3.p1.4.m4.1.1.3.1"></times><ci id="S3.p1.4.m4.1.1.3.2.cmml" xref="S3.p1.4.m4.1.1.3.2">𝑉</ci><ci id="S3.p1.4.m4.1.1.3.3.cmml" xref="S3.p1.4.m4.1.1.3.3">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">E\subseteq V\times V</annotation></semantics></math> is the edge set and <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="W\in\mathbb{R}^{K\times K}" display="inline"><semantics id="S3.p1.5.m5.1a"><mrow id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><mi id="S3.p1.5.m5.1.1.2" xref="S3.p1.5.m5.1.1.2.cmml">W</mi><mo id="S3.p1.5.m5.1.1.1" xref="S3.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S3.p1.5.m5.1.1.3" xref="S3.p1.5.m5.1.1.3.cmml"><mi id="S3.p1.5.m5.1.1.3.2" xref="S3.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p1.5.m5.1.1.3.3" xref="S3.p1.5.m5.1.1.3.3.cmml"><mi id="S3.p1.5.m5.1.1.3.3.2" xref="S3.p1.5.m5.1.1.3.3.2.cmml">K</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p1.5.m5.1.1.3.3.1" xref="S3.p1.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S3.p1.5.m5.1.1.3.3.3" xref="S3.p1.5.m5.1.1.3.3.3.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><in id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1"></in><ci id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2">𝑊</ci><apply id="S3.p1.5.m5.1.1.3.cmml" xref="S3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.3.1.cmml" xref="S3.p1.5.m5.1.1.3">superscript</csymbol><ci id="S3.p1.5.m5.1.1.3.2.cmml" xref="S3.p1.5.m5.1.1.3.2">ℝ</ci><apply id="S3.p1.5.m5.1.1.3.3.cmml" xref="S3.p1.5.m5.1.1.3.3"><times id="S3.p1.5.m5.1.1.3.3.1.cmml" xref="S3.p1.5.m5.1.1.3.3.1"></times><ci id="S3.p1.5.m5.1.1.3.3.2.cmml" xref="S3.p1.5.m5.1.1.3.3.2">𝐾</ci><ci id="S3.p1.5.m5.1.1.3.3.3.cmml" xref="S3.p1.5.m5.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">W\in\mathbb{R}^{K\times K}</annotation></semantics></math> is the adjacency matrix. An edge between two clients <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="v_{k}" display="inline"><semantics id="S3.p1.6.m6.1a"><msub id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml"><mi id="S3.p1.6.m6.1.1.2" xref="S3.p1.6.m6.1.1.2.cmml">v</mi><mi id="S3.p1.6.m6.1.1.3" xref="S3.p1.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><apply id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.1.cmml" xref="S3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.p1.6.m6.1.1.2.cmml" xref="S3.p1.6.m6.1.1.2">𝑣</ci><ci id="S3.p1.6.m6.1.1.3.cmml" xref="S3.p1.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">v_{k}</annotation></semantics></math> and <math id="S3.p1.7.m7.1" class="ltx_Math" alttext="v_{l}" display="inline"><semantics id="S3.p1.7.m7.1a"><msub id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml"><mi id="S3.p1.7.m7.1.1.2" xref="S3.p1.7.m7.1.1.2.cmml">v</mi><mi id="S3.p1.7.m7.1.1.3" xref="S3.p1.7.m7.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.1.cmml" xref="S3.p1.7.m7.1.1">subscript</csymbol><ci id="S3.p1.7.m7.1.1.2.cmml" xref="S3.p1.7.m7.1.1.2">𝑣</ci><ci id="S3.p1.7.m7.1.1.3.cmml" xref="S3.p1.7.m7.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">v_{l}</annotation></semantics></math> is represented by <math id="S3.p1.8.m8.2" class="ltx_Math" alttext="e_{k,l}" display="inline"><semantics id="S3.p1.8.m8.2a"><msub id="S3.p1.8.m8.2.3" xref="S3.p1.8.m8.2.3.cmml"><mi id="S3.p1.8.m8.2.3.2" xref="S3.p1.8.m8.2.3.2.cmml">e</mi><mrow id="S3.p1.8.m8.2.2.2.4" xref="S3.p1.8.m8.2.2.2.3.cmml"><mi id="S3.p1.8.m8.1.1.1.1" xref="S3.p1.8.m8.1.1.1.1.cmml">k</mi><mo id="S3.p1.8.m8.2.2.2.4.1" xref="S3.p1.8.m8.2.2.2.3.cmml">,</mo><mi id="S3.p1.8.m8.2.2.2.2" xref="S3.p1.8.m8.2.2.2.2.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.2b"><apply id="S3.p1.8.m8.2.3.cmml" xref="S3.p1.8.m8.2.3"><csymbol cd="ambiguous" id="S3.p1.8.m8.2.3.1.cmml" xref="S3.p1.8.m8.2.3">subscript</csymbol><ci id="S3.p1.8.m8.2.3.2.cmml" xref="S3.p1.8.m8.2.3.2">𝑒</ci><list id="S3.p1.8.m8.2.2.2.3.cmml" xref="S3.p1.8.m8.2.2.2.4"><ci id="S3.p1.8.m8.1.1.1.1.cmml" xref="S3.p1.8.m8.1.1.1.1">𝑘</ci><ci id="S3.p1.8.m8.2.2.2.2.cmml" xref="S3.p1.8.m8.2.2.2.2">𝑙</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.2c">e_{k,l}</annotation></semantics></math> and is associated with a weight <math id="S3.p1.9.m9.2" class="ltx_Math" alttext="w_{k,l}" display="inline"><semantics id="S3.p1.9.m9.2a"><msub id="S3.p1.9.m9.2.3" xref="S3.p1.9.m9.2.3.cmml"><mi id="S3.p1.9.m9.2.3.2" xref="S3.p1.9.m9.2.3.2.cmml">w</mi><mrow id="S3.p1.9.m9.2.2.2.4" xref="S3.p1.9.m9.2.2.2.3.cmml"><mi id="S3.p1.9.m9.1.1.1.1" xref="S3.p1.9.m9.1.1.1.1.cmml">k</mi><mo id="S3.p1.9.m9.2.2.2.4.1" xref="S3.p1.9.m9.2.2.2.3.cmml">,</mo><mi id="S3.p1.9.m9.2.2.2.2" xref="S3.p1.9.m9.2.2.2.2.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.2b"><apply id="S3.p1.9.m9.2.3.cmml" xref="S3.p1.9.m9.2.3"><csymbol cd="ambiguous" id="S3.p1.9.m9.2.3.1.cmml" xref="S3.p1.9.m9.2.3">subscript</csymbol><ci id="S3.p1.9.m9.2.3.2.cmml" xref="S3.p1.9.m9.2.3.2">𝑤</ci><list id="S3.p1.9.m9.2.2.2.3.cmml" xref="S3.p1.9.m9.2.2.2.4"><ci id="S3.p1.9.m9.1.1.1.1.cmml" xref="S3.p1.9.m9.1.1.1.1">𝑘</ci><ci id="S3.p1.9.m9.2.2.2.2.cmml" xref="S3.p1.9.m9.2.2.2.2">𝑙</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.2c">w_{k,l}</annotation></semantics></math>.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.5" class="ltx_p"><span id="S3.p2.5.1" class="ltx_text ltx_font_bold">Optimization problem.</span>
Let <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S3.p2.1.m1.1a"><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\phi</annotation></semantics></math> denotes graph measures, <span id="S3.p2.5.2" class="ltx_text ltx_font_italic">e.g,</span> centrality measure <cite class="ltx_cite ltx_citemacro_citep">(Saxena &amp; Iyengar, <a href="#bib.bib51" title="" class="ltx_ref">2020</a>)</cite>. The function “sim” indicates any similarity function, including but not limited to cosine similarity, <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S3.p2.2.m2.1a"><msub id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi mathvariant="normal" id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">ℓ</mi><mn id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2">ℓ</ci><cn type="integer" id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">\ell_{2}</annotation></semantics></math>, or <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="\ell_{1}" display="inline"><semantics id="S3.p2.3.m3.1a"><msub id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mi mathvariant="normal" id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">ℓ</mi><mn id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2">ℓ</ci><cn type="integer" id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">\ell_{1}</annotation></semantics></math>. <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.p2.4.m4.1a"><mi id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><ci id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">\gamma</annotation></semantics></math> represents a trade-off hyperparameter. <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S3.p2.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><ci id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">\mathcal{D}</annotation></semantics></math> symbolizes arbitrary distributional distance measure. As the client topology is often not readily available, we propose to jointly optimize the client topology and the robust model by solving the following problem:</p>
<table id="S3.E3" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E3X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\min_{\begin{subarray}{c}\theta\in\Theta\\
w\in W\end{subarray}}\,\max_{\bm{\lambda}\in\Delta_{K}}" display="inline"><semantics id="S3.E3X.2.1.1.m1.1a"><mrow id="S3.E3X.2.1.1.m1.1.1" xref="S3.E3X.2.1.1.m1.1.1.cmml"><munder id="S3.E3X.2.1.1.m1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.cmml"><mi id="S3.E3X.2.1.1.m1.1.1.1.2" xref="S3.E3X.2.1.1.m1.1.1.1.2.cmml">min</mi><mtable rowspacing="0pt" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf" xref="S3.E3.m1.1.1.1.1.1.1.1a.2.cmml"><mtr id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mfa" xref="S3.E3.m1.1.1.1.1.1.1.1a.2.cmml"><mtd id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mfb" xref="S3.E3.m1.1.1.1.1.1.1.1a.2.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.2.cmml">θ</mi><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.cmml">∈</mo><mi mathvariant="normal" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.3.cmml">Θ</mi></mrow></mtd></mtr><mtr id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mfc" xref="S3.E3.m1.1.1.1.1.1.1.1a.2.cmml"><mtd id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mfd" xref="S3.E3.m1.1.1.1.1.1.1.1a.2.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.2.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.2.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.2.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.2.1.1.2.cmml">w</mi><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.2.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.2.1.1.1.cmml">∈</mo><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.2.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.2.1.1.3.cmml">W</mi></mrow></mtd></mtr></mtable></munder><mo lspace="0.337em" id="S3.E3X.2.1.1.m1.1.1a" xref="S3.E3X.2.1.1.m1.1.1.cmml">⁡</mo><munder id="S3.E3X.2.1.1.m1.1.1.2" xref="S3.E3X.2.1.1.m1.1.1.2.cmml"><mi id="S3.E3X.2.1.1.m1.1.1.2.2" xref="S3.E3X.2.1.1.m1.1.1.2.2.cmml">max</mi><mrow id="S3.E3X.2.1.1.m1.1.1.2.3" xref="S3.E3X.2.1.1.m1.1.1.2.3.cmml"><mi id="S3.E3X.2.1.1.m1.1.1.2.3.2" xref="S3.E3X.2.1.1.m1.1.1.2.3.2.cmml">𝝀</mi><mo id="S3.E3X.2.1.1.m1.1.1.2.3.1" xref="S3.E3X.2.1.1.m1.1.1.2.3.1.cmml">∈</mo><msub id="S3.E3X.2.1.1.m1.1.1.2.3.3" xref="S3.E3X.2.1.1.m1.1.1.2.3.3.cmml"><mi mathvariant="normal" id="S3.E3X.2.1.1.m1.1.1.2.3.3.2" xref="S3.E3X.2.1.1.m1.1.1.2.3.3.2.cmml">Δ</mi><mi id="S3.E3X.2.1.1.m1.1.1.2.3.3.3" xref="S3.E3X.2.1.1.m1.1.1.2.3.3.3.cmml">K</mi></msub></mrow></munder></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.2.1.1.m1.1b"><apply id="S3.E3X.2.1.1.m1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1"><apply id="S3.E3X.2.1.1.m1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1">subscript</csymbol><min id="S3.E3X.2.1.1.m1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.2"></min><list id="S3.E3.m1.1.1.1.1.1.1.1a.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf"><matrix id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf"><matrixrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mfa.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf"><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1"><in id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1"></in><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.2">𝜃</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.3">Θ</ci></apply></matrixrow><matrixrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mfb.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf"><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.2.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.2.1.1"><in id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.2.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.2.1.1.1"></in><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.2.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.2.1.1.2">𝑤</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.2.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.2.1.1.3">𝑊</ci></apply></matrixrow></matrix></list></apply><apply id="S3.E3X.2.1.1.m1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.2">subscript</csymbol><max id="S3.E3X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.2.2"></max><apply id="S3.E3X.2.1.1.m1.1.1.2.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.2.3"><in id="S3.E3X.2.1.1.m1.1.1.2.3.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.2.3.1"></in><ci id="S3.E3X.2.1.1.m1.1.1.2.3.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.2.3.2">𝝀</ci><apply id="S3.E3X.2.1.1.m1.1.1.2.3.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.1.1.2.3.3.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.2.3.3">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.1.1.2.3.3.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.2.3.3.2">Δ</ci><ci id="S3.E3X.2.1.1.m1.1.1.2.3.3.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.2.3.3.3">𝐾</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.2.1.1.m1.1c">\displaystyle\min_{\begin{subarray}{c}\theta\in\Theta\\
w\in W\end{subarray}}\,\max_{\bm{\lambda}\in\Delta_{K}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3X.3.2.2.m1.4" class="ltx_Math" alttext="\displaystyle F(\theta,\bm{\lambda},W):=\sum_{k=1}^{K}\lambda_{k}f_{k}(\theta)" display="inline"><semantics id="S3.E3X.3.2.2.m1.4a"><mrow id="S3.E3X.3.2.2.m1.4.5" xref="S3.E3X.3.2.2.m1.4.5.cmml"><mrow id="S3.E3X.3.2.2.m1.4.5.2" xref="S3.E3X.3.2.2.m1.4.5.2.cmml"><mi id="S3.E3X.3.2.2.m1.4.5.2.2" xref="S3.E3X.3.2.2.m1.4.5.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.4.5.2.1" xref="S3.E3X.3.2.2.m1.4.5.2.1.cmml">​</mo><mrow id="S3.E3X.3.2.2.m1.4.5.2.3.2" xref="S3.E3X.3.2.2.m1.4.5.2.3.1.cmml"><mo stretchy="false" id="S3.E3X.3.2.2.m1.4.5.2.3.2.1" xref="S3.E3X.3.2.2.m1.4.5.2.3.1.cmml">(</mo><mi id="S3.E3X.3.2.2.m1.1.1" xref="S3.E3X.3.2.2.m1.1.1.cmml">θ</mi><mo id="S3.E3X.3.2.2.m1.4.5.2.3.2.2" xref="S3.E3X.3.2.2.m1.4.5.2.3.1.cmml">,</mo><mi id="S3.E3X.3.2.2.m1.2.2" xref="S3.E3X.3.2.2.m1.2.2.cmml">𝝀</mi><mo id="S3.E3X.3.2.2.m1.4.5.2.3.2.3" xref="S3.E3X.3.2.2.m1.4.5.2.3.1.cmml">,</mo><mi id="S3.E3X.3.2.2.m1.3.3" xref="S3.E3X.3.2.2.m1.3.3.cmml">W</mi><mo rspace="0.278em" stretchy="false" id="S3.E3X.3.2.2.m1.4.5.2.3.2.4" xref="S3.E3X.3.2.2.m1.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S3.E3X.3.2.2.m1.4.5.1" xref="S3.E3X.3.2.2.m1.4.5.1.cmml">:=</mo><mrow id="S3.E3X.3.2.2.m1.4.5.3" xref="S3.E3X.3.2.2.m1.4.5.3.cmml"><mstyle displaystyle="true" id="S3.E3X.3.2.2.m1.4.5.3.1" xref="S3.E3X.3.2.2.m1.4.5.3.1.cmml"><munderover id="S3.E3X.3.2.2.m1.4.5.3.1a" xref="S3.E3X.3.2.2.m1.4.5.3.1.cmml"><mo movablelimits="false" id="S3.E3X.3.2.2.m1.4.5.3.1.2.2" xref="S3.E3X.3.2.2.m1.4.5.3.1.2.2.cmml">∑</mo><mrow id="S3.E3X.3.2.2.m1.4.5.3.1.2.3" xref="S3.E3X.3.2.2.m1.4.5.3.1.2.3.cmml"><mi id="S3.E3X.3.2.2.m1.4.5.3.1.2.3.2" xref="S3.E3X.3.2.2.m1.4.5.3.1.2.3.2.cmml">k</mi><mo id="S3.E3X.3.2.2.m1.4.5.3.1.2.3.1" xref="S3.E3X.3.2.2.m1.4.5.3.1.2.3.1.cmml">=</mo><mn id="S3.E3X.3.2.2.m1.4.5.3.1.2.3.3" xref="S3.E3X.3.2.2.m1.4.5.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3X.3.2.2.m1.4.5.3.1.3" xref="S3.E3X.3.2.2.m1.4.5.3.1.3.cmml">K</mi></munderover></mstyle><mrow id="S3.E3X.3.2.2.m1.4.5.3.2" xref="S3.E3X.3.2.2.m1.4.5.3.2.cmml"><msub id="S3.E3X.3.2.2.m1.4.5.3.2.2" xref="S3.E3X.3.2.2.m1.4.5.3.2.2.cmml"><mi id="S3.E3X.3.2.2.m1.4.5.3.2.2.2" xref="S3.E3X.3.2.2.m1.4.5.3.2.2.2.cmml">λ</mi><mi id="S3.E3X.3.2.2.m1.4.5.3.2.2.3" xref="S3.E3X.3.2.2.m1.4.5.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.4.5.3.2.1" xref="S3.E3X.3.2.2.m1.4.5.3.2.1.cmml">​</mo><msub id="S3.E3X.3.2.2.m1.4.5.3.2.3" xref="S3.E3X.3.2.2.m1.4.5.3.2.3.cmml"><mi id="S3.E3X.3.2.2.m1.4.5.3.2.3.2" xref="S3.E3X.3.2.2.m1.4.5.3.2.3.2.cmml">f</mi><mi id="S3.E3X.3.2.2.m1.4.5.3.2.3.3" xref="S3.E3X.3.2.2.m1.4.5.3.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.4.5.3.2.1a" xref="S3.E3X.3.2.2.m1.4.5.3.2.1.cmml">​</mo><mrow id="S3.E3X.3.2.2.m1.4.5.3.2.4.2" xref="S3.E3X.3.2.2.m1.4.5.3.2.cmml"><mo stretchy="false" id="S3.E3X.3.2.2.m1.4.5.3.2.4.2.1" xref="S3.E3X.3.2.2.m1.4.5.3.2.cmml">(</mo><mi id="S3.E3X.3.2.2.m1.4.4" xref="S3.E3X.3.2.2.m1.4.4.cmml">θ</mi><mo stretchy="false" id="S3.E3X.3.2.2.m1.4.5.3.2.4.2.2" xref="S3.E3X.3.2.2.m1.4.5.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.3.2.2.m1.4b"><apply id="S3.E3X.3.2.2.m1.4.5.cmml" xref="S3.E3X.3.2.2.m1.4.5"><csymbol cd="latexml" id="S3.E3X.3.2.2.m1.4.5.1.cmml" xref="S3.E3X.3.2.2.m1.4.5.1">assign</csymbol><apply id="S3.E3X.3.2.2.m1.4.5.2.cmml" xref="S3.E3X.3.2.2.m1.4.5.2"><times id="S3.E3X.3.2.2.m1.4.5.2.1.cmml" xref="S3.E3X.3.2.2.m1.4.5.2.1"></times><ci id="S3.E3X.3.2.2.m1.4.5.2.2.cmml" xref="S3.E3X.3.2.2.m1.4.5.2.2">𝐹</ci><vector id="S3.E3X.3.2.2.m1.4.5.2.3.1.cmml" xref="S3.E3X.3.2.2.m1.4.5.2.3.2"><ci id="S3.E3X.3.2.2.m1.1.1.cmml" xref="S3.E3X.3.2.2.m1.1.1">𝜃</ci><ci id="S3.E3X.3.2.2.m1.2.2.cmml" xref="S3.E3X.3.2.2.m1.2.2">𝝀</ci><ci id="S3.E3X.3.2.2.m1.3.3.cmml" xref="S3.E3X.3.2.2.m1.3.3">𝑊</ci></vector></apply><apply id="S3.E3X.3.2.2.m1.4.5.3.cmml" xref="S3.E3X.3.2.2.m1.4.5.3"><apply id="S3.E3X.3.2.2.m1.4.5.3.1.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.1"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.4.5.3.1.1.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.1">superscript</csymbol><apply id="S3.E3X.3.2.2.m1.4.5.3.1.2.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.1"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.4.5.3.1.2.1.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.1">subscript</csymbol><sum id="S3.E3X.3.2.2.m1.4.5.3.1.2.2.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.1.2.2"></sum><apply id="S3.E3X.3.2.2.m1.4.5.3.1.2.3.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.1.2.3"><eq id="S3.E3X.3.2.2.m1.4.5.3.1.2.3.1.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.1.2.3.1"></eq><ci id="S3.E3X.3.2.2.m1.4.5.3.1.2.3.2.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E3X.3.2.2.m1.4.5.3.1.2.3.3.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E3X.3.2.2.m1.4.5.3.1.3.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.1.3">𝐾</ci></apply><apply id="S3.E3X.3.2.2.m1.4.5.3.2.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.2"><times id="S3.E3X.3.2.2.m1.4.5.3.2.1.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.2.1"></times><apply id="S3.E3X.3.2.2.m1.4.5.3.2.2.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.2.2"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.4.5.3.2.2.1.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.2.2">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.4.5.3.2.2.2.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.2.2.2">𝜆</ci><ci id="S3.E3X.3.2.2.m1.4.5.3.2.2.3.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.2.2.3">𝑘</ci></apply><apply id="S3.E3X.3.2.2.m1.4.5.3.2.3.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.2.3"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.4.5.3.2.3.1.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.2.3">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.4.5.3.2.3.2.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.2.3.2">𝑓</ci><ci id="S3.E3X.3.2.2.m1.4.5.3.2.3.3.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.2.3.3">𝑘</ci></apply><ci id="S3.E3X.3.2.2.m1.4.4.cmml" xref="S3.E3X.3.2.2.m1.4.4">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.3.2.2.m1.4c">\displaystyle F(\theta,\bm{\lambda},W):=\sum_{k=1}^{K}\lambda_{k}f_{k}(\theta)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="3" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
<tr id="S3.E3Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3Xa.2.1.1.m1.3" class="ltx_Math" alttext="\displaystyle\quad\quad-\frac{\gamma}{2}\sum_{k\neq l}w_{k,l}\;\text{sim}(v_{k},v_{l})," display="inline"><semantics id="S3.E3Xa.2.1.1.m1.3a"><mrow id="S3.E3Xa.2.1.1.m1.3.3.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.cmml"><mrow id="S3.E3Xa.2.1.1.m1.3.3.1.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.cmml"><mo id="S3.E3Xa.2.1.1.m1.3.3.1.1a" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.cmml">−</mo><mrow id="S3.E3Xa.2.1.1.m1.3.3.1.1.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.4" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.4.cmml"><mfrac id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.4a" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.4.cmml"><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.4.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.4.2.cmml">γ</mi><mn id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.4.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.4.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.3.cmml">​</mo><mrow id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.cmml"><mstyle displaystyle="true" id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.cmml"><munder id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3a" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.cmml"><mo movablelimits="false" id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.2.cmml">∑</mo><mrow id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.3.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.3.2.cmml">k</mi><mo id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.3.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.3.1.cmml">≠</mo><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.3.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.3.3.cmml">l</mi></mrow></munder></mstyle><mrow id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.cmml"><msub id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.4" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.4.cmml"><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.4.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.4.2.cmml">w</mi><mrow id="S3.E3Xa.2.1.1.m1.2.2.2.4" xref="S3.E3Xa.2.1.1.m1.2.2.2.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.cmml">k</mi><mo id="S3.E3Xa.2.1.1.m1.2.2.2.4.1" xref="S3.E3Xa.2.1.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.E3Xa.2.1.1.m1.2.2.2.2" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.cmml">l</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.3.cmml">​</mo><mtext id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.5" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.5a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.3a" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.3.cmml">​</mo><mrow id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.2.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.3.cmml">(</mo><msub id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.2.4" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.3.cmml">,</mo><msub id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.2.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.2.2.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.2.2.2.cmml">v</mi><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.2.2.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.2.2.3.cmml">l</mi></msub><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.2.5" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E3Xa.2.1.1.m1.3.3.1.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xa.2.1.1.m1.3b"><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1"><minus id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1"></minus><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2"><times id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.3"></times><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.4.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.4"><divide id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.4.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.4"></divide><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.4.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.4.2">𝛾</ci><cn type="integer" id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.4.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.4.3">2</cn></apply><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2"><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3">subscript</csymbol><sum id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.2"></sum><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.3"><neq id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.3.1"></neq><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.3.2">𝑘</ci><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.3.3.3">𝑙</ci></apply></apply><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2"><times id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.3"></times><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.4.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.4.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.4">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.4.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.4.2">𝑤</ci><list id="S3.E3Xa.2.1.1.m1.2.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.4"><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1">𝑘</ci><ci id="S3.E3Xa.2.1.1.m1.2.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.2">𝑙</ci></list></apply><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.5a.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.5"><mtext id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.5.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.5">sim</mtext></ci><interval closure="open" id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.2"><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.2.2.2">𝑣</ci><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.2.2.2.2.3">𝑙</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xa.2.1.1.m1.3c">\displaystyle\quad\quad-\frac{\gamma}{2}\sum_{k\neq l}w_{k,l}\;\text{sim}(v_{k},v_{l}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E3Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S3.E3Xb.2.1.1.1" class="ltx_text ltx_markedasmath ltx_font_italic">s.t.</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3Xb.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle\mathcal{D}(\bm{\lambda}\parallel\bm{p})\leq\tau,\,\text{where}\;\bm{p}=\phi(W)." display="inline"><semantics id="S3.E3Xb.3.2.2.m1.2a"><mrow id="S3.E3Xb.3.2.2.m1.2.2.1"><mrow id="S3.E3Xb.3.2.2.m1.2.2.1.1.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.3.cmml"><mrow id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.cmml"><mrow id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.3" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.3.cmml">𝒟</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">𝝀</mi><mo id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">∥</mo><mi id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">𝒑</mi></mrow><mo stretchy="false" id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.2.cmml">≤</mo><mi id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.3" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.3.cmml">τ</mi></mrow><mo rspace="0.337em" id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.3a.cmml">,</mo><mrow id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.cmml"><mrow id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.cmml"><mtext id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2a.cmml">where</mtext><mo lspace="0.280em" rspace="0em" id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.1" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.1.cmml">​</mo><mi id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.3" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.3.cmml">𝒑</mi></mrow><mo id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.1" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.1.cmml">=</mo><mrow id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3.cmml"><mi id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3.2.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3.1" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3.1.cmml">​</mo><mrow id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3.3.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3.3.2.1" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3.cmml">(</mo><mi id="S3.E3Xb.3.2.2.m1.1.1" xref="S3.E3Xb.3.2.2.m1.1.1.cmml">W</mi><mo stretchy="false" id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3.3.2.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E3Xb.3.2.2.m1.2.2.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xb.3.2.2.m1.2b"><apply id="S3.E3Xb.3.2.2.m1.2.2.1.1.3.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E3Xb.3.2.2.m1.2.2.1.1.3a.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1"><leq id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.2"></leq><apply id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1"><times id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.2"></times><ci id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.3">𝒟</ci><apply id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2">𝝀</ci><ci id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3">𝒑</ci></apply></apply><ci id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.3.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.3">𝜏</ci></apply><apply id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2"><eq id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.1.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.1"></eq><apply id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2"><times id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.1"></times><ci id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2a.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2"><mtext id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2">where</mtext></ci><ci id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.3">𝒑</ci></apply><apply id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3"><times id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3.1.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3.1"></times><ci id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3.2.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3.2">italic-ϕ</ci><ci id="S3.E3Xb.3.2.2.m1.1.1.cmml" xref="S3.E3Xb.3.2.2.m1.1.1">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xb.3.2.2.m1.2c">\displaystyle\mathcal{D}(\bm{\lambda}\parallel\bm{p})\leq\tau,\,\text{where}\;\bm{p}=\phi(W).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.p2.6" class="ltx_p">In the proposed objective function, the first term follows the same spirit of Equation <a href="#S2.E2" title="Equation 2 ‣ 2 Preliminaries ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> to adopt a minimax robust optimization framework. The difference is that it minimizes the risk over not only the worst-case but also the influential clients. The second term is dedicated to learning the client topology by measuring the pair-wise client similarity.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.1" class="ltx_p">Our formulation stands apart from existing work in two respects. First, it employs client topology to explicitly model the client relationships. Analyzing this topology facilitates the identification of influential clients that are crucial for developing OOF generalization. Second, our formulation enables seamless integration of client topology into the optimization process, ensuring that the model assimilates insights from the most significant clients.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.5" class="ltx_p">In Equation <a href="#S3.E3" title="Equation 3 ‣ 3 Methodology ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, it is infeasible to simultaneously update both the client topology <math id="S3.p4.1.m1.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.p4.1.m1.1a"><mi id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><ci id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">W</annotation></semantics></math> and model parameters <math id="S3.p4.2.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.p4.2.m2.1a"><mi id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><ci id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">\theta</annotation></semantics></math> as local clients do not have access to other clients’ data.
To this end, we propose to solve this problem using an alternating two-step approach: learning the client topology (updating <math id="S3.p4.3.m3.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.p4.3.m3.1a"><mi id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><ci id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">W</annotation></semantics></math>) and building an OOF-resilient model with client topology (updating <math id="S3.p4.4.m4.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.p4.4.m4.1a"><mi id="S3.p4.4.m4.1.1" xref="S3.p4.4.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.p4.4.m4.1b"><ci id="S3.p4.4.m4.1.1.cmml" xref="S3.p4.4.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.4.m4.1c">\lambda</annotation></semantics></math> and <math id="S3.p4.5.m5.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.p4.5.m5.1a"><mi id="S3.p4.5.m5.1.1" xref="S3.p4.5.m5.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.p4.5.m5.1b"><ci id="S3.p4.5.m5.1.1.cmml" xref="S3.p4.5.m5.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.5.m5.1c">\theta</annotation></semantics></math>). As shown in Figure <a href="#S2.F3" title="Figure 3 ‣ 2 Preliminaries ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we term these steps as <span id="S3.p4.5.1" class="ltx_text ltx_font_bold">Client Topology Learning</span> (CTL) and <span id="S3.p4.5.2" class="ltx_text ltx_font_bold">Learning on Client Topology</span> (LCT), respectively. The following sections will provide further details on these two steps.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Client Topology Learning</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Our goal is to learn the client topology that accurately describes the characteristics of local data, capturing the underlying relationships among clients. Conventional approaches typically adopt similarity-based <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib6" title="" class="ltx_ref">2020a</a>; Franceschi et al., <a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite> or diffusion-based <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a href="#bib.bib78" title="" class="ltx_ref">2021</a>; Mateos et al., <a href="#bib.bib31" title="" class="ltx_ref">2019</a>)</cite> methods to estimate the graph structure from data. However, most methods require centralizing training data on a single machine, thereby raising privacy concerns. Therefore, the primary challenge lies in learning the client topology while respecting data privacy.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.3" class="ltx_p">We propose to utilize model weights to learn client topology.
Intuitively, when two clients have similar data distributions, their corresponding models should be more similar. It is possible to obtain data distribution relationships with model similarity. While the feasibility of this idea is supported by literature <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a href="#bib.bib73" title="" class="ltx_ref">2022</a>)</cite>, we intend to empirically verify whether it holds in our setting. We use four types of similarity measures, including <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\ell_{1}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><msub id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">ℓ</mi><mn id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">ℓ</ci><cn type="integer" id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\ell_{1}</annotation></semantics></math>-based, <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">ℓ</mi><mn id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">ℓ</ci><cn type="integer" id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\ell_{2}</annotation></semantics></math>-based, dot product-based, and cosine similarity-based metrics. We conduct experiments on PACS where clients 6 to 10 share similar data distributions. Then, we measure the similarity between client 10 and all other clients. For a clear comparison, we normalized all scores into <math id="S3.SS1.p2.3.m3.2" class="ltx_Math" alttext="[0,1]" display="inline"><semantics id="S3.SS1.p2.3.m3.2a"><mrow id="S3.SS1.p2.3.m3.2.3.2" xref="S3.SS1.p2.3.m3.2.3.1.cmml"><mo stretchy="false" id="S3.SS1.p2.3.m3.2.3.2.1" xref="S3.SS1.p2.3.m3.2.3.1.cmml">[</mo><mn id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">0</mn><mo id="S3.SS1.p2.3.m3.2.3.2.2" xref="S3.SS1.p2.3.m3.2.3.1.cmml">,</mo><mn id="S3.SS1.p2.3.m3.2.2" xref="S3.SS1.p2.3.m3.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS1.p2.3.m3.2.3.2.3" xref="S3.SS1.p2.3.m3.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.2b"><interval closure="closed" id="S3.SS1.p2.3.m3.2.3.1.cmml" xref="S3.SS1.p2.3.m3.2.3.2"><cn type="integer" id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">0</cn><cn type="integer" id="S3.SS1.p2.3.m3.2.2.cmml" xref="S3.SS1.p2.3.m3.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.2c">[0,1]</annotation></semantics></math>. The results are shown in Figure <a href="#S3.F4" title="Figure 4 ‣ 3.1 Client Topology Learning ‣ 3 Methodology ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. We observe that clients sharing similar data distributions exhibit significantly higher similarity scores compared to others. Furthermore, these distinct similarity scores remain consistent across various metrics.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.8" class="ltx_p">In summary, utilizing model weights to learn client topology offers two merits. First, models can be freely shared among clients, addressing privacy issues of client topology learning. Second, since models are trained on local data, their similarity measures the similarity between local data distributions. We formulate client topology learning as follows:</p>
<table id="S3.E4" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E4X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4X.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle\min_{w\in W}\,-\sum_{k\neq l}w_{k,l}\;\text{sim}(\theta_{k},\theta_{l})+\left\|W\right\|_{0}," display="inline"><semantics id="S3.E4X.2.1.1.m1.4a"><mrow id="S3.E4X.2.1.1.m1.4.4.1" xref="S3.E4X.2.1.1.m1.4.4.1.1.cmml"><mrow id="S3.E4X.2.1.1.m1.4.4.1.1" xref="S3.E4X.2.1.1.m1.4.4.1.1.cmml"><mrow id="S3.E4X.2.1.1.m1.4.4.1.1.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.cmml"><munder id="S3.E4X.2.1.1.m1.4.4.1.1.2.4" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.4.cmml"><mi id="S3.E4X.2.1.1.m1.4.4.1.1.2.4.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.4.2.cmml">min</mi><mrow id="S3.E4X.2.1.1.m1.4.4.1.1.2.4.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.4.3.cmml"><mi id="S3.E4X.2.1.1.m1.4.4.1.1.2.4.3.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.4.3.2.cmml">w</mi><mo id="S3.E4X.2.1.1.m1.4.4.1.1.2.4.3.1" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.4.3.1.cmml">∈</mo><mi id="S3.E4X.2.1.1.m1.4.4.1.1.2.4.3.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.4.3.3.cmml">W</mi></mrow></munder><mo lspace="0.170em" id="S3.E4X.2.1.1.m1.4.4.1.1.2.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.3.cmml">−</mo><mrow id="S3.E4X.2.1.1.m1.4.4.1.1.2.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.cmml"><mstyle displaystyle="true" id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.cmml"><munder id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3a" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.cmml"><mo movablelimits="false" id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.2.cmml">∑</mo><mrow id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.3.cmml"><mi id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.3.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.3.2.cmml">k</mi><mo id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.3.1" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.3.1.cmml">≠</mo><mi id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.3.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.3.3.cmml">l</mi></mrow></munder></mstyle><mrow id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.cmml"><msub id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.4" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.4.cmml"><mi id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.4.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.4.2.cmml">w</mi><mrow id="S3.E4X.2.1.1.m1.2.2.2.4" xref="S3.E4X.2.1.1.m1.2.2.2.3.cmml"><mi id="S3.E4X.2.1.1.m1.1.1.1.1" xref="S3.E4X.2.1.1.m1.1.1.1.1.cmml">k</mi><mo id="S3.E4X.2.1.1.m1.2.2.2.4.1" xref="S3.E4X.2.1.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.E4X.2.1.1.m1.2.2.2.2" xref="S3.E4X.2.1.1.m1.2.2.2.2.cmml">l</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.3.cmml">​</mo><mtext id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.5" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.5a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.3a" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.3.cmml">​</mo><mrow id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.3.cmml">(</mo><msub id="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.4" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.3.cmml">,</mo><msub id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.2.cmml">θ</mi><mi id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.3.cmml">l</mi></msub><mo stretchy="false" id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.5" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E4X.2.1.1.m1.4.4.1.1.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.3.cmml">+</mo><msub id="S3.E4X.2.1.1.m1.4.4.1.1.4" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.cmml"><mrow id="S3.E4X.2.1.1.m1.4.4.1.1.4.2.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.2.1.cmml"><mo id="S3.E4X.2.1.1.m1.4.4.1.1.4.2.2.1" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.2.1.1.cmml">‖</mo><mi id="S3.E4X.2.1.1.m1.3.3" xref="S3.E4X.2.1.1.m1.3.3.cmml">W</mi><mo id="S3.E4X.2.1.1.m1.4.4.1.1.4.2.2.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.2.1.1.cmml">‖</mo></mrow><mn id="S3.E4X.2.1.1.m1.4.4.1.1.4.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.3.cmml">0</mn></msub></mrow><mo id="S3.E4X.2.1.1.m1.4.4.1.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4X.2.1.1.m1.4b"><apply id="S3.E4X.2.1.1.m1.4.4.1.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1"><plus id="S3.E4X.2.1.1.m1.4.4.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.3"></plus><apply id="S3.E4X.2.1.1.m1.4.4.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2"><minus id="S3.E4X.2.1.1.m1.4.4.1.1.2.3.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.3"></minus><apply id="S3.E4X.2.1.1.m1.4.4.1.1.2.4.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.4"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.4.4.1.1.2.4.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.4">subscript</csymbol><min id="S3.E4X.2.1.1.m1.4.4.1.1.2.4.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.4.2"></min><apply id="S3.E4X.2.1.1.m1.4.4.1.1.2.4.3.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.4.3"><in id="S3.E4X.2.1.1.m1.4.4.1.1.2.4.3.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.4.3.1"></in><ci id="S3.E4X.2.1.1.m1.4.4.1.1.2.4.3.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.4.3.2">𝑤</ci><ci id="S3.E4X.2.1.1.m1.4.4.1.1.2.4.3.3.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.4.3.3">𝑊</ci></apply></apply><apply id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2"><apply id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3">subscript</csymbol><sum id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.2"></sum><apply id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.3.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.3"><neq id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.3.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.3.1"></neq><ci id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.3.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.3.2">𝑘</ci><ci id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.3.3.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.3.3">𝑙</ci></apply></apply><apply id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2"><times id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.3.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.3"></times><apply id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.4.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.4.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.4">subscript</csymbol><ci id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.4.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.4.2">𝑤</ci><list id="S3.E4X.2.1.1.m1.2.2.2.3.cmml" xref="S3.E4X.2.1.1.m1.2.2.2.4"><ci id="S3.E4X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1">𝑘</ci><ci id="S3.E4X.2.1.1.m1.2.2.2.2.cmml" xref="S3.E4X.2.1.1.m1.2.2.2.2">𝑙</ci></list></apply><ci id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.5a.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.5"><mtext id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.5.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.5">sim</mtext></ci><interval closure="open" id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.3.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2"><apply id="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.2">𝜃</ci><ci id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.3">𝑙</ci></apply></interval></apply></apply></apply><apply id="S3.E4X.2.1.1.m1.4.4.1.1.4.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.4"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.4.4.1.1.4.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.4">subscript</csymbol><apply id="S3.E4X.2.1.1.m1.4.4.1.1.4.2.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.2.2"><csymbol cd="latexml" id="S3.E4X.2.1.1.m1.4.4.1.1.4.2.1.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.2.2.1">norm</csymbol><ci id="S3.E4X.2.1.1.m1.3.3.cmml" xref="S3.E4X.2.1.1.m1.3.3">𝑊</ci></apply><cn type="integer" id="S3.E4X.2.1.1.m1.4.4.1.1.4.3.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4X.2.1.1.m1.4c">\displaystyle\min_{w\in W}\,-\sum_{k\neq l}w_{k,l}\;\text{sim}(\theta_{k},\theta_{l})+\left\|W\right\|_{0},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
</tbody>
</table>
<p id="S3.SS1.p3.7" class="ltx_p">where <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\theta</annotation></semantics></math> denotes the model of local clients. This objective ensures that similar clients have large edge weights. Our formulation is aligned with the common network homophily assumption that <span id="S3.SS1.p3.7.1" class="ltx_text ltx_font_italic">edges tend to connect similar nodes</span> <cite class="ltx_cite ltx_citemacro_citep">(Newman, <a href="#bib.bib36" title="" class="ltx_ref">2018</a>)</cite>.
To avoid learning a fully connected graph with trivial edges, we enforced graph sparsity by penalizing the <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="l_{0}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><msub id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">l</mi><mn id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝑙</ci><cn type="integer" id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">l_{0}</annotation></semantics></math>-norm of the adjacency matrix <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="\left\|W\right\|_{0}" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><msub id="S3.SS1.p3.3.m3.1.2" xref="S3.SS1.p3.3.m3.1.2.cmml"><mrow id="S3.SS1.p3.3.m3.1.2.2.2" xref="S3.SS1.p3.3.m3.1.2.2.1.cmml"><mo id="S3.SS1.p3.3.m3.1.2.2.2.1" xref="S3.SS1.p3.3.m3.1.2.2.1.1.cmml">‖</mo><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">W</mi><mo id="S3.SS1.p3.3.m3.1.2.2.2.2" xref="S3.SS1.p3.3.m3.1.2.2.1.1.cmml">‖</mo></mrow><mn id="S3.SS1.p3.3.m3.1.2.3" xref="S3.SS1.p3.3.m3.1.2.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.2.cmml" xref="S3.SS1.p3.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.2.1.cmml" xref="S3.SS1.p3.3.m3.1.2">subscript</csymbol><apply id="S3.SS1.p3.3.m3.1.2.2.1.cmml" xref="S3.SS1.p3.3.m3.1.2.2.2"><csymbol cd="latexml" id="S3.SS1.p3.3.m3.1.2.2.1.1.cmml" xref="S3.SS1.p3.3.m3.1.2.2.2.1">norm</csymbol><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝑊</ci></apply><cn type="integer" id="S3.SS1.p3.3.m3.1.2.3.cmml" xref="S3.SS1.p3.3.m3.1.2.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">\left\|W\right\|_{0}</annotation></semantics></math>. We implement the sparsity term using an implicit method, <span id="S3.SS1.p3.7.2" class="ltx_text ltx_font_italic">i.e.,</span> hard thresholding on <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><mi id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">W</annotation></semantics></math> to construct <math id="S3.SS1.p3.5.m5.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S3.SS1.p3.5.m5.1a"><mi id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><ci id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">\epsilon</annotation></semantics></math>-graph <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a href="#bib.bib78" title="" class="ltx_ref">2021</a>)</cite>. Specifically, we mask out (<span id="S3.SS1.p3.7.3" class="ltx_text ltx_font_italic">i.e.,</span> set to zero) those elements in <math id="S3.SS1.p3.6.m6.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS1.p3.6.m6.1a"><mi id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><ci id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">W</annotation></semantics></math> smaller than a non-negative threshold <math id="S3.SS1.p3.7.m7.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S3.SS1.p3.7.m7.1a"><mi id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><ci id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">\epsilon</annotation></semantics></math>.</p>
</div>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2407.04949/assets/x4.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="149" height="87" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Model similarity under different metrics. Client models are trained using the same algorithm and hyperparameters. Clients 6 to 10 share similar data distributions. We observe that <span id="S3.F4.2.1" class="ltx_text ltx_font_italic">clients with similar data distribution tend to have more similar models</span>.</figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Learning on Client Topology</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.2" class="ltx_p">The learned client topology captures the relation among local clients. We aim to leverage such relations to develop TFL for better OOF-resiliency. Recall that, to tackle distribution shift, distributionally robust federated learning (DRFL) assumes that the target distribution lies within an arbitrary mixture of training distributions: <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\sum_{k=1}^{K}\lambda_{k}{D}_{k}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><msubsup id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml"><mo id="S3.SS2.p1.1.m1.1.1.1.2.2" xref="S3.SS2.p1.1.m1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.SS2.p1.1.m1.1.1.1.2.3" xref="S3.SS2.p1.1.m1.1.1.1.2.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.1.2.3.2" xref="S3.SS2.p1.1.m1.1.1.1.2.3.2.cmml">k</mi><mo id="S3.SS2.p1.1.m1.1.1.1.2.3.1" xref="S3.SS2.p1.1.m1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p1.1.m1.1.1.1.2.3.3" xref="S3.SS2.p1.1.m1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p1.1.m1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.1.3.cmml">K</mi></msubsup><mrow id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml"><msub id="S3.SS2.p1.1.m1.1.1.2.2" xref="S3.SS2.p1.1.m1.1.1.2.2.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2.2.2" xref="S3.SS2.p1.1.m1.1.1.2.2.2.cmml">λ</mi><mi id="S3.SS2.p1.1.m1.1.1.2.2.3" xref="S3.SS2.p1.1.m1.1.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.1.1.2.1" xref="S3.SS2.p1.1.m1.1.1.2.1.cmml">​</mo><msub id="S3.SS2.p1.1.m1.1.1.2.3" xref="S3.SS2.p1.1.m1.1.1.2.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2.3.2" xref="S3.SS2.p1.1.m1.1.1.2.3.2.cmml">D</mi><mi id="S3.SS2.p1.1.m1.1.1.2.3.3" xref="S3.SS2.p1.1.m1.1.1.2.3.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><apply id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1">superscript</csymbol><apply id="S3.SS2.p1.1.m1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1">subscript</csymbol><sum id="S3.SS2.p1.1.m1.1.1.1.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.2.2"></sum><apply id="S3.SS2.p1.1.m1.1.1.1.2.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.2.3"><eq id="S3.SS2.p1.1.m1.1.1.1.2.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.2.3.1"></eq><ci id="S3.SS2.p1.1.m1.1.1.1.2.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS2.p1.1.m1.1.1.1.2.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p1.1.m1.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.3">𝐾</ci></apply><apply id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2"><times id="S3.SS2.p1.1.m1.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.2.1"></times><apply id="S3.SS2.p1.1.m1.1.1.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.2.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2.2.2">𝜆</ci><ci id="S3.SS2.p1.1.m1.1.1.2.2.3.cmml" xref="S3.SS2.p1.1.m1.1.1.2.2.3">𝑘</ci></apply><apply id="S3.SS2.p1.1.m1.1.1.2.3.cmml" xref="S3.SS2.p1.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.2.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.2.3">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2.3.2">𝐷</ci><ci id="S3.SS2.p1.1.m1.1.1.2.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.2.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\sum_{k=1}^{K}\lambda_{k}{D}_{k}</annotation></semantics></math>. DRFL builds OOF-resilient models by minimizing the <span id="S3.SS2.p1.2.1" class="ltx_text ltx_font_italic">worst-case</span> risk over an uncertainty set of possible target distribution <math id="S3.SS2.p1.2.m2.2" class="ltx_Math" alttext="Q:=\{\sum_{k=1}^{K}\lambda_{k}{D}_{k}\mid\bm{\lambda}\in\Delta_{K}\}" display="inline"><semantics id="S3.SS2.p1.2.m2.2a"><mrow id="S3.SS2.p1.2.m2.2.2" xref="S3.SS2.p1.2.m2.2.2.cmml"><mi id="S3.SS2.p1.2.m2.2.2.4" xref="S3.SS2.p1.2.m2.2.2.4.cmml">Q</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.p1.2.m2.2.2.3" xref="S3.SS2.p1.2.m2.2.2.3.cmml">:=</mo><mrow id="S3.SS2.p1.2.m2.2.2.2.2" xref="S3.SS2.p1.2.m2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.2.m2.2.2.2.2.3" xref="S3.SS2.p1.2.m2.2.2.2.3.1.cmml">{</mo><mrow id="S3.SS2.p1.2.m2.1.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml"><msubsup id="S3.SS2.p1.2.m2.1.1.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.cmml"><mo lspace="0em" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.3.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.3.2.cmml">k</mi><mo id="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.3.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.3.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.3.cmml">K</mi></msubsup><mrow id="S3.SS2.p1.2.m2.1.1.1.1.1.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml"><msub id="S3.SS2.p1.2.m2.1.1.1.1.1.2.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.2.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.2.2.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.2.2.cmml">λ</mi><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.2.2.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.2.m2.1.1.1.1.1.2.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.SS2.p1.2.m2.1.1.1.1.1.2.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.2.cmml">D</mi><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.3.cmml">k</mi></msub></mrow></mrow><mo fence="true" lspace="0em" rspace="0em" id="S3.SS2.p1.2.m2.2.2.2.2.4" xref="S3.SS2.p1.2.m2.2.2.2.3.1.cmml">∣</mo><mrow id="S3.SS2.p1.2.m2.2.2.2.2.2" xref="S3.SS2.p1.2.m2.2.2.2.2.2.cmml"><mi id="S3.SS2.p1.2.m2.2.2.2.2.2.2" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2.cmml">𝝀</mi><mo id="S3.SS2.p1.2.m2.2.2.2.2.2.1" xref="S3.SS2.p1.2.m2.2.2.2.2.2.1.cmml">∈</mo><msub id="S3.SS2.p1.2.m2.2.2.2.2.2.3" xref="S3.SS2.p1.2.m2.2.2.2.2.2.3.cmml"><mi mathvariant="normal" id="S3.SS2.p1.2.m2.2.2.2.2.2.3.2" xref="S3.SS2.p1.2.m2.2.2.2.2.2.3.2.cmml">Δ</mi><mi id="S3.SS2.p1.2.m2.2.2.2.2.2.3.3" xref="S3.SS2.p1.2.m2.2.2.2.2.2.3.3.cmml">K</mi></msub></mrow><mo stretchy="false" id="S3.SS2.p1.2.m2.2.2.2.2.5" xref="S3.SS2.p1.2.m2.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.2b"><apply id="S3.SS2.p1.2.m2.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2"><csymbol cd="latexml" id="S3.SS2.p1.2.m2.2.2.3.cmml" xref="S3.SS2.p1.2.m2.2.2.3">assign</csymbol><ci id="S3.SS2.p1.2.m2.2.2.4.cmml" xref="S3.SS2.p1.2.m2.2.2.4">𝑄</ci><apply id="S3.SS2.p1.2.m2.2.2.2.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2"><csymbol cd="latexml" id="S3.SS2.p1.2.m2.2.2.2.3.1.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.3">conditional-set</csymbol><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1"><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1">subscript</csymbol><sum id="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.2"></sum><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.3"><eq id="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.3">𝐾</ci></apply><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2"><times id="S3.SS2.p1.2.m2.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.1"></times><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.1.1.2.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.2.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.2.2">𝜆</ci><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.2.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.2.3">𝑘</ci></apply><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.2">𝐷</ci><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.3">𝑘</ci></apply></apply></apply><apply id="S3.SS2.p1.2.m2.2.2.2.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.2"><in id="S3.SS2.p1.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.2.1"></in><ci id="S3.SS2.p1.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.2.2">𝝀</ci><apply id="S3.SS2.p1.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.2.2.2.2.3.1.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.2.3">subscript</csymbol><ci id="S3.SS2.p1.2.m2.2.2.2.2.2.3.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.2.3.2">Δ</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.2.3.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2.2.3.3">𝐾</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.2c">Q:=\{\sum_{k=1}^{K}\lambda_{k}{D}_{k}\mid\bm{\lambda}\in\Delta_{K}\}</annotation></semantics></math>.
However, DRFL primarily emphasizes the worst-case distribution, potentially ignoring the <span id="S3.SS2.p1.2.2" class="ltx_text ltx_font_italic">influential</span> ones that are more representative of the training clients. This can lead to overly pessimistic models with compromised OOF resiliency <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a href="#bib.bib15" title="" class="ltx_ref">2018</a>)</cite>.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.4" class="ltx_p">We leverage client topology to construct an uncertainty set that can better approximate the unseen distribution. Our insight is to optimize the model for both the worst-case and influential distributions. The key challenge is how to identify the influential distribution. Our idea is to use graph centrality as the criterion to choose influential distributions. <span id="S3.SS2.p2.4.1" class="ltx_text ltx_font_italic">Graph centrality</span> is widely used in social network analysis <cite class="ltx_cite ltx_citemacro_citep">(Newman, <a href="#bib.bib37" title="" class="ltx_ref">2005</a>)</cite> to identify the key person by measuring how much information propagates through each entity. We introduce <span id="S3.SS2.p2.4.2" class="ltx_text ltx_font_italic">client centrality</span> to identify influential ones, which can be calculated by graph measurements such as degree, closeness, and betweenness. Specifically, we first calculate the centrality of each client in <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{G}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\mathcal{G}</annotation></semantics></math> as the <span id="S3.SS2.p2.4.3" class="ltx_text ltx_font_italic">topological prior</span> <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\bm{p}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">𝒑</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝒑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\bm{p}</annotation></semantics></math>. Then we use <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="\bm{p}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">𝒑</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝒑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\bm{p}</annotation></semantics></math> to constraint the uncertainty set <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">Q</annotation></semantics></math> by solving the following minimax optimization problem:</p>
<table id="S3.E5" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E5X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\min_{\theta\in\Theta}\,\max_{\bm{\lambda}\in\Delta_{K}}" display="inline"><semantics id="S3.E5X.2.1.1.m1.1a"><mrow id="S3.E5X.2.1.1.m1.1.1" xref="S3.E5X.2.1.1.m1.1.1.cmml"><munder id="S3.E5X.2.1.1.m1.1.1.1" xref="S3.E5X.2.1.1.m1.1.1.1.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.1.2" xref="S3.E5X.2.1.1.m1.1.1.1.2.cmml">min</mi><mrow id="S3.E5X.2.1.1.m1.1.1.1.3" xref="S3.E5X.2.1.1.m1.1.1.1.3.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.1.3.2" xref="S3.E5X.2.1.1.m1.1.1.1.3.2.cmml">θ</mi><mo id="S3.E5X.2.1.1.m1.1.1.1.3.1" xref="S3.E5X.2.1.1.m1.1.1.1.3.1.cmml">∈</mo><mi mathvariant="normal" id="S3.E5X.2.1.1.m1.1.1.1.3.3" xref="S3.E5X.2.1.1.m1.1.1.1.3.3.cmml">Θ</mi></mrow></munder><mo lspace="0.337em" id="S3.E5X.2.1.1.m1.1.1a" xref="S3.E5X.2.1.1.m1.1.1.cmml">⁡</mo><munder id="S3.E5X.2.1.1.m1.1.1.2" xref="S3.E5X.2.1.1.m1.1.1.2.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.2.2" xref="S3.E5X.2.1.1.m1.1.1.2.2.cmml">max</mi><mrow id="S3.E5X.2.1.1.m1.1.1.2.3" xref="S3.E5X.2.1.1.m1.1.1.2.3.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.2.3.2" xref="S3.E5X.2.1.1.m1.1.1.2.3.2.cmml">𝝀</mi><mo id="S3.E5X.2.1.1.m1.1.1.2.3.1" xref="S3.E5X.2.1.1.m1.1.1.2.3.1.cmml">∈</mo><msub id="S3.E5X.2.1.1.m1.1.1.2.3.3" xref="S3.E5X.2.1.1.m1.1.1.2.3.3.cmml"><mi mathvariant="normal" id="S3.E5X.2.1.1.m1.1.1.2.3.3.2" xref="S3.E5X.2.1.1.m1.1.1.2.3.3.2.cmml">Δ</mi><mi id="S3.E5X.2.1.1.m1.1.1.2.3.3.3" xref="S3.E5X.2.1.1.m1.1.1.2.3.3.3.cmml">K</mi></msub></mrow></munder></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.2.1.1.m1.1b"><apply id="S3.E5X.2.1.1.m1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1"><apply id="S3.E5X.2.1.1.m1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1">subscript</csymbol><min id="S3.E5X.2.1.1.m1.1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.2"></min><apply id="S3.E5X.2.1.1.m1.1.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.3"><in id="S3.E5X.2.1.1.m1.1.1.1.3.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.3.1"></in><ci id="S3.E5X.2.1.1.m1.1.1.1.3.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.3.2">𝜃</ci><ci id="S3.E5X.2.1.1.m1.1.1.1.3.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.3.3">Θ</ci></apply></apply><apply id="S3.E5X.2.1.1.m1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.2">subscript</csymbol><max id="S3.E5X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.2"></max><apply id="S3.E5X.2.1.1.m1.1.1.2.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.3"><in id="S3.E5X.2.1.1.m1.1.1.2.3.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.3.1"></in><ci id="S3.E5X.2.1.1.m1.1.1.2.3.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.3.2">𝝀</ci><apply id="S3.E5X.2.1.1.m1.1.1.2.3.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.2.3.3.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.3.3">subscript</csymbol><ci id="S3.E5X.2.1.1.m1.1.1.2.3.3.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.3.3.2">Δ</ci><ci id="S3.E5X.2.1.1.m1.1.1.2.3.3.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.3.3.3">𝐾</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.2.1.1.m1.1c">\displaystyle\min_{\theta\in\Theta}\,\max_{\bm{\lambda}\in\Delta_{K}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5X.3.2.2.m1.4" class="ltx_Math" alttext="\displaystyle F(\theta,\bm{\lambda}):=\sum_{k=1}^{K}\lambda_{k}f_{k}(\theta),\;\;" display="inline"><semantics id="S3.E5X.3.2.2.m1.4a"><mrow id="S3.E5X.3.2.2.m1.4.4.1" xref="S3.E5X.3.2.2.m1.4.4.1.1.cmml"><mrow id="S3.E5X.3.2.2.m1.4.4.1.1" xref="S3.E5X.3.2.2.m1.4.4.1.1.cmml"><mrow id="S3.E5X.3.2.2.m1.4.4.1.1.2" xref="S3.E5X.3.2.2.m1.4.4.1.1.2.cmml"><mi id="S3.E5X.3.2.2.m1.4.4.1.1.2.2" xref="S3.E5X.3.2.2.m1.4.4.1.1.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.4.4.1.1.2.1" xref="S3.E5X.3.2.2.m1.4.4.1.1.2.1.cmml">​</mo><mrow id="S3.E5X.3.2.2.m1.4.4.1.1.2.3.2" xref="S3.E5X.3.2.2.m1.4.4.1.1.2.3.1.cmml"><mo stretchy="false" id="S3.E5X.3.2.2.m1.4.4.1.1.2.3.2.1" xref="S3.E5X.3.2.2.m1.4.4.1.1.2.3.1.cmml">(</mo><mi id="S3.E5X.3.2.2.m1.1.1" xref="S3.E5X.3.2.2.m1.1.1.cmml">θ</mi><mo id="S3.E5X.3.2.2.m1.4.4.1.1.2.3.2.2" xref="S3.E5X.3.2.2.m1.4.4.1.1.2.3.1.cmml">,</mo><mi id="S3.E5X.3.2.2.m1.2.2" xref="S3.E5X.3.2.2.m1.2.2.cmml">𝝀</mi><mo rspace="0.278em" stretchy="false" id="S3.E5X.3.2.2.m1.4.4.1.1.2.3.2.3" xref="S3.E5X.3.2.2.m1.4.4.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S3.E5X.3.2.2.m1.4.4.1.1.1" xref="S3.E5X.3.2.2.m1.4.4.1.1.1.cmml">:=</mo><mrow id="S3.E5X.3.2.2.m1.4.4.1.1.3" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E5X.3.2.2.m1.4.4.1.1.3.1" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.1.cmml"><munderover id="S3.E5X.3.2.2.m1.4.4.1.1.3.1a" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.2" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.3" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.3.cmml"><mi id="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.3.2" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.3.2.cmml">k</mi><mo id="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.3.1" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.3.3" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E5X.3.2.2.m1.4.4.1.1.3.1.3" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.1.3.cmml">K</mi></munderover></mstyle><mrow id="S3.E5X.3.2.2.m1.4.4.1.1.3.2" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.cmml"><msub id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.2" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.2.cmml"><mi id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.2.2" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.2.2.cmml">λ</mi><mi id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.2.3" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.1" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.1.cmml">​</mo><msub id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.3" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.3.cmml"><mi id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.3.2" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.3.2.cmml">f</mi><mi id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.3.3" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.1a" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.1.cmml">​</mo><mrow id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.4.2" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.cmml"><mo stretchy="false" id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.4.2.1" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.cmml">(</mo><mi id="S3.E5X.3.2.2.m1.3.3" xref="S3.E5X.3.2.2.m1.3.3.cmml">θ</mi><mo stretchy="false" id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.4.2.2" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E5X.3.2.2.m1.4.4.1.2" xref="S3.E5X.3.2.2.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.3.2.2.m1.4b"><apply id="S3.E5X.3.2.2.m1.4.4.1.1.cmml" xref="S3.E5X.3.2.2.m1.4.4.1"><csymbol cd="latexml" id="S3.E5X.3.2.2.m1.4.4.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.1">assign</csymbol><apply id="S3.E5X.3.2.2.m1.4.4.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.2"><times id="S3.E5X.3.2.2.m1.4.4.1.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.2.1"></times><ci id="S3.E5X.3.2.2.m1.4.4.1.1.2.2.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.2.2">𝐹</ci><interval closure="open" id="S3.E5X.3.2.2.m1.4.4.1.1.2.3.1.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.2.3.2"><ci id="S3.E5X.3.2.2.m1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1">𝜃</ci><ci id="S3.E5X.3.2.2.m1.2.2.cmml" xref="S3.E5X.3.2.2.m1.2.2">𝝀</ci></interval></apply><apply id="S3.E5X.3.2.2.m1.4.4.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3"><apply id="S3.E5X.3.2.2.m1.4.4.1.1.3.1.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.4.4.1.1.3.1.1.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.1">superscript</csymbol><apply id="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.1">subscript</csymbol><sum id="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.2.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.2"></sum><apply id="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.3.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.3"><eq id="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.3.1.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.3.1"></eq><ci id="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.3.2.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.3.3.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E5X.3.2.2.m1.4.4.1.1.3.1.3.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.1.3">𝐾</ci></apply><apply id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2"><times id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.1.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.1"></times><apply id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.2.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.2.1.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.2">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.2.2">𝜆</ci><ci id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.2.3.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.2.3">𝑘</ci></apply><apply id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.3.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.3.1.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.3">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.3.2.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.3.2">𝑓</ci><ci id="S3.E5X.3.2.2.m1.4.4.1.1.3.2.3.3.cmml" xref="S3.E5X.3.2.2.m1.4.4.1.1.3.2.3.3">𝑘</ci></apply><ci id="S3.E5X.3.2.2.m1.3.3.cmml" xref="S3.E5X.3.2.2.m1.3.3">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.3.2.2.m1.4c">\displaystyle F(\theta,\bm{\lambda}):=\sum_{k=1}^{K}\lambda_{k}f_{k}(\theta),\;\;</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr id="S3.E5Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S3.E5Xa.2.1.1.1" class="ltx_text ltx_markedasmath ltx_font_italic">s.t.</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5Xa.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{D}(\bm{\lambda}\parallel\bm{p})\leq\tau." display="inline"><semantics id="S3.E5Xa.3.2.2.m1.1a"><mrow id="S3.E5Xa.3.2.2.m1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.3.cmml">𝒟</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml">𝝀</mi><mo id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">∥</mo><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml">𝒑</mi></mrow><mo stretchy="false" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5Xa.3.2.2.m1.1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.cmml">≤</mo><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.cmml">τ</mi></mrow><mo lspace="0em" id="S3.E5Xa.3.2.2.m1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xa.3.2.2.m1.1b"><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1"><leq id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2"></leq><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1"><times id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.2"></times><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.3">𝒟</ci><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2">𝝀</ci><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3">𝒑</ci></apply></apply><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.3.2.2.m1.1c">\displaystyle\mathcal{D}(\bm{\lambda}\parallel\bm{p})\leq\tau.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.3" class="ltx_p">The topological constraint directs the optimization to focus on worst-case and influential clients.
Notably, both FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib32" title="" class="ltx_ref">2017</a>)</cite> (Equation <a href="#S2.E1" title="Equation 1 ‣ 2 Preliminaries ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) and DRFL (Equation <a href="#S2.E2" title="Equation 2 ‣ 2 Preliminaries ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) can be viewed as special cases of TFL: When <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="\tau=0" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mrow id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">τ</mi><mo id="S3.SS2.p3.1.m1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><eq id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1"></eq><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝜏</ci><cn type="integer" id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\tau=0</annotation></semantics></math> and the prior <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="\bm{p}" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><mi id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">𝒑</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">𝒑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">\bm{p}</annotation></semantics></math> is a uniform distribution, Equation <a href="#S3.E5" title="Equation 5 ‣ 3.2 Learning on Client Topology ‣ 3 Methodology ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> minimizes the average risks over local clients, which is identical to FedAvg; When <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="\tau\rightarrow\infty" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><mrow id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml">τ</mi><mo stretchy="false" id="S3.SS2.p3.3.m3.1.1.1" xref="S3.SS2.p3.3.m3.1.1.1.cmml">→</mo><mi mathvariant="normal" id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><ci id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1.1">→</ci><ci id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2">𝜏</ci><infinity id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\tau\rightarrow\infty</annotation></semantics></math>, Equation <a href="#S3.E5" title="Equation 5 ‣ 3.2 Learning on Client Topology ‣ 3 Methodology ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> only prioritizes the worst-case clients, resembling the DRFL approach.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.6" class="ltx_p">The above optimization problem is typically nonconvex, and methods such as SGD cannot guarantee constraint satisfaction <cite class="ltx_cite ltx_citemacro_citep">(Robey et al., <a href="#bib.bib47" title="" class="ltx_ref">2021</a>)</cite>. To tackle this issue, we leverage the Lagrange multiplier and KKT conditions <cite class="ltx_cite ltx_citemacro_citep">(Boyd et al., <a href="#bib.bib4" title="" class="ltx_ref">2004</a>)</cite> to convert it into unconstrained optimization:</p>
<table id="S3.E6" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E6X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\min_{\theta\in\Theta}\,\max_{\bm{\lambda}\in\Delta_{K}}" display="inline"><semantics id="S3.E6X.2.1.1.m1.1a"><mrow id="S3.E6X.2.1.1.m1.1.1" xref="S3.E6X.2.1.1.m1.1.1.cmml"><munder id="S3.E6X.2.1.1.m1.1.1.1" xref="S3.E6X.2.1.1.m1.1.1.1.cmml"><mi id="S3.E6X.2.1.1.m1.1.1.1.2" xref="S3.E6X.2.1.1.m1.1.1.1.2.cmml">min</mi><mrow id="S3.E6X.2.1.1.m1.1.1.1.3" xref="S3.E6X.2.1.1.m1.1.1.1.3.cmml"><mi id="S3.E6X.2.1.1.m1.1.1.1.3.2" xref="S3.E6X.2.1.1.m1.1.1.1.3.2.cmml">θ</mi><mo id="S3.E6X.2.1.1.m1.1.1.1.3.1" xref="S3.E6X.2.1.1.m1.1.1.1.3.1.cmml">∈</mo><mi mathvariant="normal" id="S3.E6X.2.1.1.m1.1.1.1.3.3" xref="S3.E6X.2.1.1.m1.1.1.1.3.3.cmml">Θ</mi></mrow></munder><mo lspace="0.337em" id="S3.E6X.2.1.1.m1.1.1a" xref="S3.E6X.2.1.1.m1.1.1.cmml">⁡</mo><munder id="S3.E6X.2.1.1.m1.1.1.2" xref="S3.E6X.2.1.1.m1.1.1.2.cmml"><mi id="S3.E6X.2.1.1.m1.1.1.2.2" xref="S3.E6X.2.1.1.m1.1.1.2.2.cmml">max</mi><mrow id="S3.E6X.2.1.1.m1.1.1.2.3" xref="S3.E6X.2.1.1.m1.1.1.2.3.cmml"><mi id="S3.E6X.2.1.1.m1.1.1.2.3.2" xref="S3.E6X.2.1.1.m1.1.1.2.3.2.cmml">𝝀</mi><mo id="S3.E6X.2.1.1.m1.1.1.2.3.1" xref="S3.E6X.2.1.1.m1.1.1.2.3.1.cmml">∈</mo><msub id="S3.E6X.2.1.1.m1.1.1.2.3.3" xref="S3.E6X.2.1.1.m1.1.1.2.3.3.cmml"><mi mathvariant="normal" id="S3.E6X.2.1.1.m1.1.1.2.3.3.2" xref="S3.E6X.2.1.1.m1.1.1.2.3.3.2.cmml">Δ</mi><mi id="S3.E6X.2.1.1.m1.1.1.2.3.3.3" xref="S3.E6X.2.1.1.m1.1.1.2.3.3.3.cmml">K</mi></msub></mrow></munder></mrow><annotation-xml encoding="MathML-Content" id="S3.E6X.2.1.1.m1.1b"><apply id="S3.E6X.2.1.1.m1.1.1.cmml" xref="S3.E6X.2.1.1.m1.1.1"><apply id="S3.E6X.2.1.1.m1.1.1.1.cmml" xref="S3.E6X.2.1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E6X.2.1.1.m1.1.1.1">subscript</csymbol><min id="S3.E6X.2.1.1.m1.1.1.1.2.cmml" xref="S3.E6X.2.1.1.m1.1.1.1.2"></min><apply id="S3.E6X.2.1.1.m1.1.1.1.3.cmml" xref="S3.E6X.2.1.1.m1.1.1.1.3"><in id="S3.E6X.2.1.1.m1.1.1.1.3.1.cmml" xref="S3.E6X.2.1.1.m1.1.1.1.3.1"></in><ci id="S3.E6X.2.1.1.m1.1.1.1.3.2.cmml" xref="S3.E6X.2.1.1.m1.1.1.1.3.2">𝜃</ci><ci id="S3.E6X.2.1.1.m1.1.1.1.3.3.cmml" xref="S3.E6X.2.1.1.m1.1.1.1.3.3">Θ</ci></apply></apply><apply id="S3.E6X.2.1.1.m1.1.1.2.cmml" xref="S3.E6X.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E6X.2.1.1.m1.1.1.2">subscript</csymbol><max id="S3.E6X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.2"></max><apply id="S3.E6X.2.1.1.m1.1.1.2.3.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.3"><in id="S3.E6X.2.1.1.m1.1.1.2.3.1.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.3.1"></in><ci id="S3.E6X.2.1.1.m1.1.1.2.3.2.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.3.2">𝝀</ci><apply id="S3.E6X.2.1.1.m1.1.1.2.3.3.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.1.1.2.3.3.1.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.3.3">subscript</csymbol><ci id="S3.E6X.2.1.1.m1.1.1.2.3.3.2.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.3.3.2">Δ</ci><ci id="S3.E6X.2.1.1.m1.1.1.2.3.3.3.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.3.3.3">𝐾</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6X.2.1.1.m1.1c">\displaystyle\min_{\theta\in\Theta}\,\max_{\bm{\lambda}\in\Delta_{K}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E6X.3.2.2.m1.5" class="ltx_Math" alttext="\displaystyle F(\theta,\bm{\lambda},\bm{p}):=\sum_{k=1}^{K}\lambda_{k}f_{k}(\theta)-q\mathcal{D}(\bm{\lambda}\parallel\bm{p})," display="inline"><semantics id="S3.E6X.3.2.2.m1.5a"><mrow id="S3.E6X.3.2.2.m1.5.5.1" xref="S3.E6X.3.2.2.m1.5.5.1.1.cmml"><mrow id="S3.E6X.3.2.2.m1.5.5.1.1" xref="S3.E6X.3.2.2.m1.5.5.1.1.cmml"><mrow id="S3.E6X.3.2.2.m1.5.5.1.1.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.3.cmml"><mi id="S3.E6X.3.2.2.m1.5.5.1.1.3.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E6X.3.2.2.m1.5.5.1.1.3.1" xref="S3.E6X.3.2.2.m1.5.5.1.1.3.1.cmml">​</mo><mrow id="S3.E6X.3.2.2.m1.5.5.1.1.3.3.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.3.3.1.cmml"><mo stretchy="false" id="S3.E6X.3.2.2.m1.5.5.1.1.3.3.2.1" xref="S3.E6X.3.2.2.m1.5.5.1.1.3.3.1.cmml">(</mo><mi id="S3.E6X.3.2.2.m1.1.1" xref="S3.E6X.3.2.2.m1.1.1.cmml">θ</mi><mo id="S3.E6X.3.2.2.m1.5.5.1.1.3.3.2.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.3.3.1.cmml">,</mo><mi id="S3.E6X.3.2.2.m1.2.2" xref="S3.E6X.3.2.2.m1.2.2.cmml">𝝀</mi><mo id="S3.E6X.3.2.2.m1.5.5.1.1.3.3.2.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.3.3.1.cmml">,</mo><mi id="S3.E6X.3.2.2.m1.3.3" xref="S3.E6X.3.2.2.m1.3.3.cmml">𝒑</mi><mo rspace="0.278em" stretchy="false" id="S3.E6X.3.2.2.m1.5.5.1.1.3.3.2.4" xref="S3.E6X.3.2.2.m1.5.5.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S3.E6X.3.2.2.m1.5.5.1.1.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.2.cmml">:=</mo><mrow id="S3.E6X.3.2.2.m1.5.5.1.1.1" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.cmml"><mrow id="S3.E6X.3.2.2.m1.5.5.1.1.1.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.cmml"><munderover id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1a" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.3.cmml"><mi id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.3.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.3.2.cmml">k</mi><mo id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.3.1" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.3.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.3.cmml">K</mi></munderover></mstyle><mrow id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.cmml"><msub id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.2.cmml"><mi id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.2.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.2.2.cmml">λ</mi><mi id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.2.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.1" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.1.cmml">​</mo><msub id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.3.cmml"><mi id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.3.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.3.2.cmml">f</mi><mi id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.3.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.1a" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.1.cmml">​</mo><mrow id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.4.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.cmml"><mo stretchy="false" id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.4.2.1" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.cmml">(</mo><mi id="S3.E6X.3.2.2.m1.4.4" xref="S3.E6X.3.2.2.m1.4.4.cmml">θ</mi><mo stretchy="false" id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.4.2.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6X.3.2.2.m1.5.5.1.1.1.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.2.cmml">−</mo><mrow id="S3.E6X.3.2.2.m1.5.5.1.1.1.1" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.cmml"><mi id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.2.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.4" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.4.cmml">𝒟</mi><mo lspace="0em" rspace="0em" id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.2a" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.2.cmml">𝝀</mi><mo id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.cmml">∥</mo><mi id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.cmml">𝒑</mi></mrow><mo stretchy="false" id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E6X.3.2.2.m1.5.5.1.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6X.3.2.2.m1.5b"><apply id="S3.E6X.3.2.2.m1.5.5.1.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1"><csymbol cd="latexml" id="S3.E6X.3.2.2.m1.5.5.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.2">assign</csymbol><apply id="S3.E6X.3.2.2.m1.5.5.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.3"><times id="S3.E6X.3.2.2.m1.5.5.1.1.3.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.3.1"></times><ci id="S3.E6X.3.2.2.m1.5.5.1.1.3.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.3.2">𝐹</ci><vector id="S3.E6X.3.2.2.m1.5.5.1.1.3.3.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.3.3.2"><ci id="S3.E6X.3.2.2.m1.1.1.cmml" xref="S3.E6X.3.2.2.m1.1.1">𝜃</ci><ci id="S3.E6X.3.2.2.m1.2.2.cmml" xref="S3.E6X.3.2.2.m1.2.2">𝝀</ci><ci id="S3.E6X.3.2.2.m1.3.3.cmml" xref="S3.E6X.3.2.2.m1.3.3">𝒑</ci></vector></apply><apply id="S3.E6X.3.2.2.m1.5.5.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1"><minus id="S3.E6X.3.2.2.m1.5.5.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.2"></minus><apply id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3"><apply id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1">superscript</csymbol><apply id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1">subscript</csymbol><sum id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.2"></sum><apply id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.3.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.3"><eq id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.3.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.3.1"></eq><ci id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.3.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.3.3.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.3.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.3">𝐾</ci></apply><apply id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2"><times id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.1"></times><apply id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.2.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.2.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.2.2">𝜆</ci><ci id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.2.3.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.2.3">𝑘</ci></apply><apply id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.3.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.3.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.3.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.3.2">𝑓</ci><ci id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.3.3.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.3.3">𝑘</ci></apply><ci id="S3.E6X.3.2.2.m1.4.4.cmml" xref="S3.E6X.3.2.2.m1.4.4">𝜃</ci></apply></apply><apply id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1"><times id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.2"></times><ci id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.3">𝑞</ci><ci id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.4.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.4">𝒟</ci><apply id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.2">𝝀</ci><ci id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3">𝒑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6X.3.2.2.m1.5c">\displaystyle F(\theta,\bm{\lambda},\bm{p}):=\sum_{k=1}^{K}\lambda_{k}f_{k}(\theta)-q\mathcal{D}(\bm{\lambda}\parallel\bm{p}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(6)</span></td>
</tr>
</tbody>
</table>
<p id="S3.SS2.p4.1" class="ltx_p">where <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">q</annotation></semantics></math> is the dual variable. We solve the primal-dual problem by alternating between gradient descent and ascent:</p>
<table id="S3.E7" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E7X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\theta^{t+1}" display="inline"><semantics id="S3.E7X.2.1.1.m1.1a"><msup id="S3.E7X.2.1.1.m1.1.1" xref="S3.E7X.2.1.1.m1.1.1.cmml"><mi id="S3.E7X.2.1.1.m1.1.1.2" xref="S3.E7X.2.1.1.m1.1.1.2.cmml">θ</mi><mrow id="S3.E7X.2.1.1.m1.1.1.3" xref="S3.E7X.2.1.1.m1.1.1.3.cmml"><mi id="S3.E7X.2.1.1.m1.1.1.3.2" xref="S3.E7X.2.1.1.m1.1.1.3.2.cmml">t</mi><mo id="S3.E7X.2.1.1.m1.1.1.3.1" xref="S3.E7X.2.1.1.m1.1.1.3.1.cmml">+</mo><mn id="S3.E7X.2.1.1.m1.1.1.3.3" xref="S3.E7X.2.1.1.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.E7X.2.1.1.m1.1b"><apply id="S3.E7X.2.1.1.m1.1.1.cmml" xref="S3.E7X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.1.1">superscript</csymbol><ci id="S3.E7X.2.1.1.m1.1.1.2.cmml" xref="S3.E7X.2.1.1.m1.1.1.2">𝜃</ci><apply id="S3.E7X.2.1.1.m1.1.1.3.cmml" xref="S3.E7X.2.1.1.m1.1.1.3"><plus id="S3.E7X.2.1.1.m1.1.1.3.1.cmml" xref="S3.E7X.2.1.1.m1.1.1.3.1"></plus><ci id="S3.E7X.2.1.1.m1.1.1.3.2.cmml" xref="S3.E7X.2.1.1.m1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.E7X.2.1.1.m1.1.1.3.3.cmml" xref="S3.E7X.2.1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7X.2.1.1.m1.1c">\displaystyle\theta^{t+1}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7X.3.2.2.m1.3" class="ltx_Math" alttext="\displaystyle=\theta^{t}-\eta_{\theta}^{t}\nabla_{\theta}F(\theta,\bm{\lambda}),\;\;" display="inline"><semantics id="S3.E7X.3.2.2.m1.3a"><mrow id="S3.E7X.3.2.2.m1.3.3.1" xref="S3.E7X.3.2.2.m1.3.3.1.1.cmml"><mrow id="S3.E7X.3.2.2.m1.3.3.1.1" xref="S3.E7X.3.2.2.m1.3.3.1.1.cmml"><mi id="S3.E7X.3.2.2.m1.3.3.1.1.2" xref="S3.E7X.3.2.2.m1.3.3.1.1.2.cmml"></mi><mo id="S3.E7X.3.2.2.m1.3.3.1.1.1" xref="S3.E7X.3.2.2.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E7X.3.2.2.m1.3.3.1.1.3" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.cmml"><msup id="S3.E7X.3.2.2.m1.3.3.1.1.3.2" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.2.cmml"><mi id="S3.E7X.3.2.2.m1.3.3.1.1.3.2.2" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.2.2.cmml">θ</mi><mi id="S3.E7X.3.2.2.m1.3.3.1.1.3.2.3" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.2.3.cmml">t</mi></msup><mo id="S3.E7X.3.2.2.m1.3.3.1.1.3.1" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.1.cmml">−</mo><mrow id="S3.E7X.3.2.2.m1.3.3.1.1.3.3" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.cmml"><msubsup id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2.cmml"><mi id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2.2.2" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2.2.2.cmml">η</mi><mi id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2.2.3" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2.2.3.cmml">θ</mi><mi id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2.3" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2.3.cmml">t</mi></msubsup><mo lspace="0.167em" rspace="0em" id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.1" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.1.cmml">​</mo><mrow id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3.cmml"><msub id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3.1" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3.1.cmml"><mo rspace="0.167em" id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3.1.2" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3.1.2.cmml">∇</mo><mi id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3.1.3" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3.1.3.cmml">θ</mi></msub><mi id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3.2" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3.2.cmml">F</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.1a" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.1.cmml">​</mo><mrow id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.4.2" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.4.1.cmml"><mo stretchy="false" id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.4.2.1" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.4.1.cmml">(</mo><mi id="S3.E7X.3.2.2.m1.1.1" xref="S3.E7X.3.2.2.m1.1.1.cmml">θ</mi><mo id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.4.2.2" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.4.1.cmml">,</mo><mi id="S3.E7X.3.2.2.m1.2.2" xref="S3.E7X.3.2.2.m1.2.2.cmml">𝝀</mi><mo stretchy="false" id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.4.2.3" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E7X.3.2.2.m1.3.3.1.2" xref="S3.E7X.3.2.2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7X.3.2.2.m1.3b"><apply id="S3.E7X.3.2.2.m1.3.3.1.1.cmml" xref="S3.E7X.3.2.2.m1.3.3.1"><eq id="S3.E7X.3.2.2.m1.3.3.1.1.1.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.1"></eq><csymbol cd="latexml" id="S3.E7X.3.2.2.m1.3.3.1.1.2.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.2">absent</csymbol><apply id="S3.E7X.3.2.2.m1.3.3.1.1.3.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3"><minus id="S3.E7X.3.2.2.m1.3.3.1.1.3.1.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.1"></minus><apply id="S3.E7X.3.2.2.m1.3.3.1.1.3.2.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.3.3.1.1.3.2.1.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.2">superscript</csymbol><ci id="S3.E7X.3.2.2.m1.3.3.1.1.3.2.2.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.2.2">𝜃</ci><ci id="S3.E7X.3.2.2.m1.3.3.1.1.3.2.3.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.2.3">𝑡</ci></apply><apply id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3"><times id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.1.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.1"></times><apply id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2.1.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2">superscript</csymbol><apply id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2.2.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2.2.1.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2">subscript</csymbol><ci id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2.2.2.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2.2.2">𝜂</ci><ci id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2.2.3.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2.2.3">𝜃</ci></apply><ci id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2.3.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.2.3">𝑡</ci></apply><apply id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3"><apply id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3.1.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3.1.1.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3.1">subscript</csymbol><ci id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3.1.2.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3.1.2">∇</ci><ci id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3.1.3.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3.1.3">𝜃</ci></apply><ci id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3.2.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.3.2">𝐹</ci></apply><interval closure="open" id="S3.E7X.3.2.2.m1.3.3.1.1.3.3.4.1.cmml" xref="S3.E7X.3.2.2.m1.3.3.1.1.3.3.4.2"><ci id="S3.E7X.3.2.2.m1.1.1.cmml" xref="S3.E7X.3.2.2.m1.1.1">𝜃</ci><ci id="S3.E7X.3.2.2.m1.2.2.cmml" xref="S3.E7X.3.2.2.m1.2.2">𝝀</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7X.3.2.2.m1.3c">\displaystyle=\theta^{t}-\eta_{\theta}^{t}\nabla_{\theta}F(\theta,\bm{\lambda}),\;\;</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(7)</span></td>
</tr>
<tr id="S3.E7Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\bm{\lambda}^{t+1}" display="inline"><semantics id="S3.E7Xa.2.1.1.m1.1a"><msup id="S3.E7Xa.2.1.1.m1.1.1" xref="S3.E7Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E7Xa.2.1.1.m1.1.1.2" xref="S3.E7Xa.2.1.1.m1.1.1.2.cmml">𝝀</mi><mrow id="S3.E7Xa.2.1.1.m1.1.1.3" xref="S3.E7Xa.2.1.1.m1.1.1.3.cmml"><mi id="S3.E7Xa.2.1.1.m1.1.1.3.2" xref="S3.E7Xa.2.1.1.m1.1.1.3.2.cmml">t</mi><mo id="S3.E7Xa.2.1.1.m1.1.1.3.1" xref="S3.E7Xa.2.1.1.m1.1.1.3.1.cmml">+</mo><mn id="S3.E7Xa.2.1.1.m1.1.1.3.3" xref="S3.E7Xa.2.1.1.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.E7Xa.2.1.1.m1.1b"><apply id="S3.E7Xa.2.1.1.m1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1">superscript</csymbol><ci id="S3.E7Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.2">𝝀</ci><apply id="S3.E7Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.3"><plus id="S3.E7Xa.2.1.1.m1.1.1.3.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.3.1"></plus><ci id="S3.E7Xa.2.1.1.m1.1.1.3.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.E7Xa.2.1.1.m1.1.1.3.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7Xa.2.1.1.m1.1c">\displaystyle\bm{\lambda}^{t+1}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7Xa.3.2.2.m1.3" class="ltx_Math" alttext="\displaystyle=\mathcal{P}_{\Delta_{K}}(\bm{\lambda}^{t}+\eta_{\lambda}^{t}\nabla_{\lambda}F(\theta,\bm{\lambda}))," display="inline"><semantics id="S3.E7Xa.3.2.2.m1.3a"><mrow id="S3.E7Xa.3.2.2.m1.3.3.1" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.cmml"><mrow id="S3.E7Xa.3.2.2.m1.3.3.1.1" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.cmml"><mi id="S3.E7Xa.3.2.2.m1.3.3.1.1.3" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.3.cmml"></mi><mo id="S3.E7Xa.3.2.2.m1.3.3.1.1.2" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E7Xa.3.2.2.m1.3.3.1.1.1" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.cmml"><msub id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.2" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.2.cmml">𝒫</mi><msub id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.3" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.3.cmml"><mi mathvariant="normal" id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.3.2" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.3.2.cmml">Δ</mi><mi id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.3.3" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.3.3.cmml">K</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.2" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.2" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.cmml"><msup id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2.2.cmml">𝝀</mi><mi id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2.3.cmml">t</mi></msup><mo id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml"><msubsup id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.2.2" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.2.2.cmml">η</mi><mi id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.2.3" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.2.3.cmml">λ</mi><mi id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.3" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.3.cmml">t</mi></msubsup><mo lspace="0.167em" rspace="0em" id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.1" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.cmml"><msub id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.1" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.1.cmml"><mo rspace="0.167em" id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.1.2" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.1.2.cmml">∇</mo><mi id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.1.3" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.1.3.cmml">λ</mi></msub><mi id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.2" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.2.cmml">F</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.1a" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.4.2" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.4.1.cmml"><mo stretchy="false" id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.4.2.1" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.4.1.cmml">(</mo><mi id="S3.E7Xa.3.2.2.m1.1.1" xref="S3.E7Xa.3.2.2.m1.1.1.cmml">θ</mi><mo id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.4.2.2" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.4.1.cmml">,</mo><mi id="S3.E7Xa.3.2.2.m1.2.2" xref="S3.E7Xa.3.2.2.m1.2.2.cmml">𝝀</mi><mo stretchy="false" id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.4.2.3" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.4.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.3" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7Xa.3.2.2.m1.3.3.1.2" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7Xa.3.2.2.m1.3b"><apply id="S3.E7Xa.3.2.2.m1.3.3.1.1.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1"><eq id="S3.E7Xa.3.2.2.m1.3.3.1.1.2.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.2"></eq><csymbol cd="latexml" id="S3.E7Xa.3.2.2.m1.3.3.1.1.3.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.3">absent</csymbol><apply id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1"><times id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.2.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.2"></times><apply id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.1.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.2.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.2">𝒫</ci><apply id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.3.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.3.1.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.3">subscript</csymbol><ci id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.3.2.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.3.2">Δ</ci><ci id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.3.3.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.3.3.3">𝐾</ci></apply></apply><apply id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1"><plus id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1"></plus><apply id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2.2">𝝀</ci><ci id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3"><times id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.1"></times><apply id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2">superscript</csymbol><apply id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.2.2">𝜂</ci><ci id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.2.3">𝜆</ci></apply><ci id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.3">𝑡</ci></apply><apply id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3"><apply id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.1.1.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.1">subscript</csymbol><ci id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.1.2.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.1.2">∇</ci><ci id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.1.3.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.1.3">𝜆</ci></apply><ci id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.2">𝐹</ci></apply><interval closure="open" id="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.4.1.cmml" xref="S3.E7Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.4.2"><ci id="S3.E7Xa.3.2.2.m1.1.1.cmml" xref="S3.E7Xa.3.2.2.m1.1.1">𝜃</ci><ci id="S3.E7Xa.3.2.2.m1.2.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2">𝝀</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7Xa.3.2.2.m1.3c">\displaystyle=\mathcal{P}_{\Delta_{K}}(\bm{\lambda}^{t}+\eta_{\lambda}^{t}\nabla_{\lambda}F(\theta,\bm{\lambda})),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS2.p4.5" class="ltx_p">where <math id="S3.SS2.p4.2.m1.1" class="ltx_Math" alttext="\eta^{t}" display="inline"><semantics id="S3.SS2.p4.2.m1.1a"><msup id="S3.SS2.p4.2.m1.1.1" xref="S3.SS2.p4.2.m1.1.1.cmml"><mi id="S3.SS2.p4.2.m1.1.1.2" xref="S3.SS2.p4.2.m1.1.1.2.cmml">η</mi><mi id="S3.SS2.p4.2.m1.1.1.3" xref="S3.SS2.p4.2.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m1.1b"><apply id="S3.SS2.p4.2.m1.1.1.cmml" xref="S3.SS2.p4.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m1.1.1.1.cmml" xref="S3.SS2.p4.2.m1.1.1">superscript</csymbol><ci id="S3.SS2.p4.2.m1.1.1.2.cmml" xref="S3.SS2.p4.2.m1.1.1.2">𝜂</ci><ci id="S3.SS2.p4.2.m1.1.1.3.cmml" xref="S3.SS2.p4.2.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m1.1c">\eta^{t}</annotation></semantics></math> is the step size. <math id="S3.SS2.p4.3.m2.1" class="ltx_Math" alttext="\mathcal{P}_{\Delta_{K}}(\bm{\lambda})" display="inline"><semantics id="S3.SS2.p4.3.m2.1a"><mrow id="S3.SS2.p4.3.m2.1.2" xref="S3.SS2.p4.3.m2.1.2.cmml"><msub id="S3.SS2.p4.3.m2.1.2.2" xref="S3.SS2.p4.3.m2.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.3.m2.1.2.2.2" xref="S3.SS2.p4.3.m2.1.2.2.2.cmml">𝒫</mi><msub id="S3.SS2.p4.3.m2.1.2.2.3" xref="S3.SS2.p4.3.m2.1.2.2.3.cmml"><mi mathvariant="normal" id="S3.SS2.p4.3.m2.1.2.2.3.2" xref="S3.SS2.p4.3.m2.1.2.2.3.2.cmml">Δ</mi><mi id="S3.SS2.p4.3.m2.1.2.2.3.3" xref="S3.SS2.p4.3.m2.1.2.2.3.3.cmml">K</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p4.3.m2.1.2.1" xref="S3.SS2.p4.3.m2.1.2.1.cmml">​</mo><mrow id="S3.SS2.p4.3.m2.1.2.3.2" xref="S3.SS2.p4.3.m2.1.2.cmml"><mo stretchy="false" id="S3.SS2.p4.3.m2.1.2.3.2.1" xref="S3.SS2.p4.3.m2.1.2.cmml">(</mo><mi id="S3.SS2.p4.3.m2.1.1" xref="S3.SS2.p4.3.m2.1.1.cmml">𝝀</mi><mo stretchy="false" id="S3.SS2.p4.3.m2.1.2.3.2.2" xref="S3.SS2.p4.3.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m2.1b"><apply id="S3.SS2.p4.3.m2.1.2.cmml" xref="S3.SS2.p4.3.m2.1.2"><times id="S3.SS2.p4.3.m2.1.2.1.cmml" xref="S3.SS2.p4.3.m2.1.2.1"></times><apply id="S3.SS2.p4.3.m2.1.2.2.cmml" xref="S3.SS2.p4.3.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m2.1.2.2.1.cmml" xref="S3.SS2.p4.3.m2.1.2.2">subscript</csymbol><ci id="S3.SS2.p4.3.m2.1.2.2.2.cmml" xref="S3.SS2.p4.3.m2.1.2.2.2">𝒫</ci><apply id="S3.SS2.p4.3.m2.1.2.2.3.cmml" xref="S3.SS2.p4.3.m2.1.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m2.1.2.2.3.1.cmml" xref="S3.SS2.p4.3.m2.1.2.2.3">subscript</csymbol><ci id="S3.SS2.p4.3.m2.1.2.2.3.2.cmml" xref="S3.SS2.p4.3.m2.1.2.2.3.2">Δ</ci><ci id="S3.SS2.p4.3.m2.1.2.2.3.3.cmml" xref="S3.SS2.p4.3.m2.1.2.2.3.3">𝐾</ci></apply></apply><ci id="S3.SS2.p4.3.m2.1.1.cmml" xref="S3.SS2.p4.3.m2.1.1">𝝀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m2.1c">\mathcal{P}_{\Delta_{K}}(\bm{\lambda})</annotation></semantics></math> projects <math id="S3.SS2.p4.4.m3.1" class="ltx_Math" alttext="\bm{\lambda}" display="inline"><semantics id="S3.SS2.p4.4.m3.1a"><mi id="S3.SS2.p4.4.m3.1.1" xref="S3.SS2.p4.4.m3.1.1.cmml">𝝀</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m3.1b"><ci id="S3.SS2.p4.4.m3.1.1.cmml" xref="S3.SS2.p4.4.m3.1.1">𝝀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m3.1c">\bm{\lambda}</annotation></semantics></math> onto the simplex <math id="S3.SS2.p4.5.m4.1" class="ltx_Math" alttext="\Delta_{K}" display="inline"><semantics id="S3.SS2.p4.5.m4.1a"><msub id="S3.SS2.p4.5.m4.1.1" xref="S3.SS2.p4.5.m4.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p4.5.m4.1.1.2" xref="S3.SS2.p4.5.m4.1.1.2.cmml">Δ</mi><mi id="S3.SS2.p4.5.m4.1.1.3" xref="S3.SS2.p4.5.m4.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m4.1b"><apply id="S3.SS2.p4.5.m4.1.1.cmml" xref="S3.SS2.p4.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m4.1.1.1.cmml" xref="S3.SS2.p4.5.m4.1.1">subscript</csymbol><ci id="S3.SS2.p4.5.m4.1.1.2.cmml" xref="S3.SS2.p4.5.m4.1.1.2">Δ</ci><ci id="S3.SS2.p4.5.m4.1.1.3.cmml" xref="S3.SS2.p4.5.m4.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m4.1c">\Delta_{K}</annotation></semantics></math> for regularization.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.12" class="ltx_p"><span id="S3.SS2.p5.12.1" class="ltx_text ltx_font_bold">Influential client.</span> We identify the influential clients by calculating betweenness centrality. Betweenness centrality measures how often a node is on the shortest path between two other nodes in the graph <math id="S3.SS2.p5.1.m1.1" class="ltx_Math" alttext="\mathcal{G}" display="inline"><semantics id="S3.SS2.p5.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><ci id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">\mathcal{G}</annotation></semantics></math>. It has been revealed that the high betweenness centrality nodes have more control over the graph as more information will pass through them <cite class="ltx_cite ltx_citemacro_citep">(White &amp; Borgatti, <a href="#bib.bib66" title="" class="ltx_ref">1994</a>)</cite>. The betweenness centrality of client <math id="S3.SS2.p5.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p5.2.m2.1a"><mi id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><ci id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">k</annotation></semantics></math> is given by the expression of <math id="S3.SS2.p5.3.m3.2" class="ltx_Math" alttext="c_{k}=\sum_{s\neq k\neq t\in[K]}\frac{\sigma_{st}(k)}{\sigma_{st}}" display="inline"><semantics id="S3.SS2.p5.3.m3.2a"><mrow id="S3.SS2.p5.3.m3.2.3" xref="S3.SS2.p5.3.m3.2.3.cmml"><msub id="S3.SS2.p5.3.m3.2.3.2" xref="S3.SS2.p5.3.m3.2.3.2.cmml"><mi id="S3.SS2.p5.3.m3.2.3.2.2" xref="S3.SS2.p5.3.m3.2.3.2.2.cmml">c</mi><mi id="S3.SS2.p5.3.m3.2.3.2.3" xref="S3.SS2.p5.3.m3.2.3.2.3.cmml">k</mi></msub><mo rspace="0.111em" id="S3.SS2.p5.3.m3.2.3.1" xref="S3.SS2.p5.3.m3.2.3.1.cmml">=</mo><mrow id="S3.SS2.p5.3.m3.2.3.3" xref="S3.SS2.p5.3.m3.2.3.3.cmml"><msub id="S3.SS2.p5.3.m3.2.3.3.1" xref="S3.SS2.p5.3.m3.2.3.3.1.cmml"><mo id="S3.SS2.p5.3.m3.2.3.3.1.2" xref="S3.SS2.p5.3.m3.2.3.3.1.2.cmml">∑</mo><mrow id="S3.SS2.p5.3.m3.1.1.1" xref="S3.SS2.p5.3.m3.1.1.1.cmml"><mi id="S3.SS2.p5.3.m3.1.1.1.3" xref="S3.SS2.p5.3.m3.1.1.1.3.cmml">s</mi><mo id="S3.SS2.p5.3.m3.1.1.1.4" xref="S3.SS2.p5.3.m3.1.1.1.4.cmml">≠</mo><mi id="S3.SS2.p5.3.m3.1.1.1.5" xref="S3.SS2.p5.3.m3.1.1.1.5.cmml">k</mi><mo id="S3.SS2.p5.3.m3.1.1.1.6" xref="S3.SS2.p5.3.m3.1.1.1.6.cmml">≠</mo><mi id="S3.SS2.p5.3.m3.1.1.1.7" xref="S3.SS2.p5.3.m3.1.1.1.7.cmml">t</mi><mo id="S3.SS2.p5.3.m3.1.1.1.8" xref="S3.SS2.p5.3.m3.1.1.1.8.cmml">∈</mo><mrow id="S3.SS2.p5.3.m3.1.1.1.9.2" xref="S3.SS2.p5.3.m3.1.1.1.9.1.cmml"><mo stretchy="false" id="S3.SS2.p5.3.m3.1.1.1.9.2.1" xref="S3.SS2.p5.3.m3.1.1.1.9.1.1.cmml">[</mo><mi id="S3.SS2.p5.3.m3.1.1.1.1" xref="S3.SS2.p5.3.m3.1.1.1.1.cmml">K</mi><mo stretchy="false" id="S3.SS2.p5.3.m3.1.1.1.9.2.2" xref="S3.SS2.p5.3.m3.1.1.1.9.1.1.cmml">]</mo></mrow></mrow></msub><mfrac id="S3.SS2.p5.3.m3.2.2" xref="S3.SS2.p5.3.m3.2.2.cmml"><mrow id="S3.SS2.p5.3.m3.2.2.1" xref="S3.SS2.p5.3.m3.2.2.1.cmml"><msub id="S3.SS2.p5.3.m3.2.2.1.3" xref="S3.SS2.p5.3.m3.2.2.1.3.cmml"><mi id="S3.SS2.p5.3.m3.2.2.1.3.2" xref="S3.SS2.p5.3.m3.2.2.1.3.2.cmml">σ</mi><mrow id="S3.SS2.p5.3.m3.2.2.1.3.3" xref="S3.SS2.p5.3.m3.2.2.1.3.3.cmml"><mi id="S3.SS2.p5.3.m3.2.2.1.3.3.2" xref="S3.SS2.p5.3.m3.2.2.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.3.m3.2.2.1.3.3.1" xref="S3.SS2.p5.3.m3.2.2.1.3.3.1.cmml">​</mo><mi id="S3.SS2.p5.3.m3.2.2.1.3.3.3" xref="S3.SS2.p5.3.m3.2.2.1.3.3.3.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p5.3.m3.2.2.1.2" xref="S3.SS2.p5.3.m3.2.2.1.2.cmml">​</mo><mrow id="S3.SS2.p5.3.m3.2.2.1.4.2" xref="S3.SS2.p5.3.m3.2.2.1.cmml"><mo stretchy="false" id="S3.SS2.p5.3.m3.2.2.1.4.2.1" xref="S3.SS2.p5.3.m3.2.2.1.cmml">(</mo><mi id="S3.SS2.p5.3.m3.2.2.1.1" xref="S3.SS2.p5.3.m3.2.2.1.1.cmml">k</mi><mo stretchy="false" id="S3.SS2.p5.3.m3.2.2.1.4.2.2" xref="S3.SS2.p5.3.m3.2.2.1.cmml">)</mo></mrow></mrow><msub id="S3.SS2.p5.3.m3.2.2.3" xref="S3.SS2.p5.3.m3.2.2.3.cmml"><mi id="S3.SS2.p5.3.m3.2.2.3.2" xref="S3.SS2.p5.3.m3.2.2.3.2.cmml">σ</mi><mrow id="S3.SS2.p5.3.m3.2.2.3.3" xref="S3.SS2.p5.3.m3.2.2.3.3.cmml"><mi id="S3.SS2.p5.3.m3.2.2.3.3.2" xref="S3.SS2.p5.3.m3.2.2.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.3.m3.2.2.3.3.1" xref="S3.SS2.p5.3.m3.2.2.3.3.1.cmml">​</mo><mi id="S3.SS2.p5.3.m3.2.2.3.3.3" xref="S3.SS2.p5.3.m3.2.2.3.3.3.cmml">t</mi></mrow></msub></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.2b"><apply id="S3.SS2.p5.3.m3.2.3.cmml" xref="S3.SS2.p5.3.m3.2.3"><eq id="S3.SS2.p5.3.m3.2.3.1.cmml" xref="S3.SS2.p5.3.m3.2.3.1"></eq><apply id="S3.SS2.p5.3.m3.2.3.2.cmml" xref="S3.SS2.p5.3.m3.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.2.3.2.1.cmml" xref="S3.SS2.p5.3.m3.2.3.2">subscript</csymbol><ci id="S3.SS2.p5.3.m3.2.3.2.2.cmml" xref="S3.SS2.p5.3.m3.2.3.2.2">𝑐</ci><ci id="S3.SS2.p5.3.m3.2.3.2.3.cmml" xref="S3.SS2.p5.3.m3.2.3.2.3">𝑘</ci></apply><apply id="S3.SS2.p5.3.m3.2.3.3.cmml" xref="S3.SS2.p5.3.m3.2.3.3"><apply id="S3.SS2.p5.3.m3.2.3.3.1.cmml" xref="S3.SS2.p5.3.m3.2.3.3.1"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.2.3.3.1.1.cmml" xref="S3.SS2.p5.3.m3.2.3.3.1">subscript</csymbol><sum id="S3.SS2.p5.3.m3.2.3.3.1.2.cmml" xref="S3.SS2.p5.3.m3.2.3.3.1.2"></sum><apply id="S3.SS2.p5.3.m3.1.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1.1"><and id="S3.SS2.p5.3.m3.1.1.1a.cmml" xref="S3.SS2.p5.3.m3.1.1.1"></and><apply id="S3.SS2.p5.3.m3.1.1.1b.cmml" xref="S3.SS2.p5.3.m3.1.1.1"><neq id="S3.SS2.p5.3.m3.1.1.1.4.cmml" xref="S3.SS2.p5.3.m3.1.1.1.4"></neq><ci id="S3.SS2.p5.3.m3.1.1.1.3.cmml" xref="S3.SS2.p5.3.m3.1.1.1.3">𝑠</ci><ci id="S3.SS2.p5.3.m3.1.1.1.5.cmml" xref="S3.SS2.p5.3.m3.1.1.1.5">𝑘</ci></apply><apply id="S3.SS2.p5.3.m3.1.1.1c.cmml" xref="S3.SS2.p5.3.m3.1.1.1"><neq id="S3.SS2.p5.3.m3.1.1.1.6.cmml" xref="S3.SS2.p5.3.m3.1.1.1.6"></neq><share href="#S3.SS2.p5.3.m3.1.1.1.5.cmml" id="S3.SS2.p5.3.m3.1.1.1d.cmml" xref="S3.SS2.p5.3.m3.1.1.1"></share><ci id="S3.SS2.p5.3.m3.1.1.1.7.cmml" xref="S3.SS2.p5.3.m3.1.1.1.7">𝑡</ci></apply><apply id="S3.SS2.p5.3.m3.1.1.1e.cmml" xref="S3.SS2.p5.3.m3.1.1.1"><in id="S3.SS2.p5.3.m3.1.1.1.8.cmml" xref="S3.SS2.p5.3.m3.1.1.1.8"></in><share href="#S3.SS2.p5.3.m3.1.1.1.7.cmml" id="S3.SS2.p5.3.m3.1.1.1f.cmml" xref="S3.SS2.p5.3.m3.1.1.1"></share><apply id="S3.SS2.p5.3.m3.1.1.1.9.1.cmml" xref="S3.SS2.p5.3.m3.1.1.1.9.2"><csymbol cd="latexml" id="S3.SS2.p5.3.m3.1.1.1.9.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1.1.9.2.1">delimited-[]</csymbol><ci id="S3.SS2.p5.3.m3.1.1.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1.1.1">𝐾</ci></apply></apply></apply></apply><apply id="S3.SS2.p5.3.m3.2.2.cmml" xref="S3.SS2.p5.3.m3.2.2"><divide id="S3.SS2.p5.3.m3.2.2.2.cmml" xref="S3.SS2.p5.3.m3.2.2"></divide><apply id="S3.SS2.p5.3.m3.2.2.1.cmml" xref="S3.SS2.p5.3.m3.2.2.1"><times id="S3.SS2.p5.3.m3.2.2.1.2.cmml" xref="S3.SS2.p5.3.m3.2.2.1.2"></times><apply id="S3.SS2.p5.3.m3.2.2.1.3.cmml" xref="S3.SS2.p5.3.m3.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.2.2.1.3.1.cmml" xref="S3.SS2.p5.3.m3.2.2.1.3">subscript</csymbol><ci id="S3.SS2.p5.3.m3.2.2.1.3.2.cmml" xref="S3.SS2.p5.3.m3.2.2.1.3.2">𝜎</ci><apply id="S3.SS2.p5.3.m3.2.2.1.3.3.cmml" xref="S3.SS2.p5.3.m3.2.2.1.3.3"><times id="S3.SS2.p5.3.m3.2.2.1.3.3.1.cmml" xref="S3.SS2.p5.3.m3.2.2.1.3.3.1"></times><ci id="S3.SS2.p5.3.m3.2.2.1.3.3.2.cmml" xref="S3.SS2.p5.3.m3.2.2.1.3.3.2">𝑠</ci><ci id="S3.SS2.p5.3.m3.2.2.1.3.3.3.cmml" xref="S3.SS2.p5.3.m3.2.2.1.3.3.3">𝑡</ci></apply></apply><ci id="S3.SS2.p5.3.m3.2.2.1.1.cmml" xref="S3.SS2.p5.3.m3.2.2.1.1">𝑘</ci></apply><apply id="S3.SS2.p5.3.m3.2.2.3.cmml" xref="S3.SS2.p5.3.m3.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.2.2.3.1.cmml" xref="S3.SS2.p5.3.m3.2.2.3">subscript</csymbol><ci id="S3.SS2.p5.3.m3.2.2.3.2.cmml" xref="S3.SS2.p5.3.m3.2.2.3.2">𝜎</ci><apply id="S3.SS2.p5.3.m3.2.2.3.3.cmml" xref="S3.SS2.p5.3.m3.2.2.3.3"><times id="S3.SS2.p5.3.m3.2.2.3.3.1.cmml" xref="S3.SS2.p5.3.m3.2.2.3.3.1"></times><ci id="S3.SS2.p5.3.m3.2.2.3.3.2.cmml" xref="S3.SS2.p5.3.m3.2.2.3.3.2">𝑠</ci><ci id="S3.SS2.p5.3.m3.2.2.3.3.3.cmml" xref="S3.SS2.p5.3.m3.2.2.3.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.2c">c_{k}=\sum_{s\neq k\neq t\in[K]}\frac{\sigma_{st}(k)}{\sigma_{st}}</annotation></semantics></math>, where <math id="S3.SS2.p5.4.m4.1" class="ltx_Math" alttext="\sigma_{st}" display="inline"><semantics id="S3.SS2.p5.4.m4.1a"><msub id="S3.SS2.p5.4.m4.1.1" xref="S3.SS2.p5.4.m4.1.1.cmml"><mi id="S3.SS2.p5.4.m4.1.1.2" xref="S3.SS2.p5.4.m4.1.1.2.cmml">σ</mi><mrow id="S3.SS2.p5.4.m4.1.1.3" xref="S3.SS2.p5.4.m4.1.1.3.cmml"><mi id="S3.SS2.p5.4.m4.1.1.3.2" xref="S3.SS2.p5.4.m4.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.4.m4.1.1.3.1" xref="S3.SS2.p5.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p5.4.m4.1.1.3.3" xref="S3.SS2.p5.4.m4.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m4.1b"><apply id="S3.SS2.p5.4.m4.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.4.m4.1.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p5.4.m4.1.1.2.cmml" xref="S3.SS2.p5.4.m4.1.1.2">𝜎</ci><apply id="S3.SS2.p5.4.m4.1.1.3.cmml" xref="S3.SS2.p5.4.m4.1.1.3"><times id="S3.SS2.p5.4.m4.1.1.3.1.cmml" xref="S3.SS2.p5.4.m4.1.1.3.1"></times><ci id="S3.SS2.p5.4.m4.1.1.3.2.cmml" xref="S3.SS2.p5.4.m4.1.1.3.2">𝑠</ci><ci id="S3.SS2.p5.4.m4.1.1.3.3.cmml" xref="S3.SS2.p5.4.m4.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.1c">\sigma_{st}</annotation></semantics></math> is the total number of shortest path from node <math id="S3.SS2.p5.5.m5.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.SS2.p5.5.m5.1a"><mi id="S3.SS2.p5.5.m5.1.1" xref="S3.SS2.p5.5.m5.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.5.m5.1b"><ci id="S3.SS2.p5.5.m5.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.5.m5.1c">s</annotation></semantics></math> to node <math id="S3.SS2.p5.6.m6.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p5.6.m6.1a"><mi id="S3.SS2.p5.6.m6.1.1" xref="S3.SS2.p5.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.6.m6.1b"><ci id="S3.SS2.p5.6.m6.1.1.cmml" xref="S3.SS2.p5.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.6.m6.1c">t</annotation></semantics></math> (<math id="S3.SS2.p5.7.m7.2" class="ltx_Math" alttext="(s,t)" display="inline"><semantics id="S3.SS2.p5.7.m7.2a"><mrow id="S3.SS2.p5.7.m7.2.3.2" xref="S3.SS2.p5.7.m7.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.p5.7.m7.2.3.2.1" xref="S3.SS2.p5.7.m7.2.3.1.cmml">(</mo><mi id="S3.SS2.p5.7.m7.1.1" xref="S3.SS2.p5.7.m7.1.1.cmml">s</mi><mo id="S3.SS2.p5.7.m7.2.3.2.2" xref="S3.SS2.p5.7.m7.2.3.1.cmml">,</mo><mi id="S3.SS2.p5.7.m7.2.2" xref="S3.SS2.p5.7.m7.2.2.cmml">t</mi><mo stretchy="false" id="S3.SS2.p5.7.m7.2.3.2.3" xref="S3.SS2.p5.7.m7.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.7.m7.2b"><interval closure="open" id="S3.SS2.p5.7.m7.2.3.1.cmml" xref="S3.SS2.p5.7.m7.2.3.2"><ci id="S3.SS2.p5.7.m7.1.1.cmml" xref="S3.SS2.p5.7.m7.1.1">𝑠</ci><ci id="S3.SS2.p5.7.m7.2.2.cmml" xref="S3.SS2.p5.7.m7.2.2">𝑡</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.7.m7.2c">(s,t)</annotation></semantics></math>-paths) and <math id="S3.SS2.p5.8.m8.1" class="ltx_Math" alttext="\sigma_{st}(k)" display="inline"><semantics id="S3.SS2.p5.8.m8.1a"><mrow id="S3.SS2.p5.8.m8.1.2" xref="S3.SS2.p5.8.m8.1.2.cmml"><msub id="S3.SS2.p5.8.m8.1.2.2" xref="S3.SS2.p5.8.m8.1.2.2.cmml"><mi id="S3.SS2.p5.8.m8.1.2.2.2" xref="S3.SS2.p5.8.m8.1.2.2.2.cmml">σ</mi><mrow id="S3.SS2.p5.8.m8.1.2.2.3" xref="S3.SS2.p5.8.m8.1.2.2.3.cmml"><mi id="S3.SS2.p5.8.m8.1.2.2.3.2" xref="S3.SS2.p5.8.m8.1.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.8.m8.1.2.2.3.1" xref="S3.SS2.p5.8.m8.1.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p5.8.m8.1.2.2.3.3" xref="S3.SS2.p5.8.m8.1.2.2.3.3.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p5.8.m8.1.2.1" xref="S3.SS2.p5.8.m8.1.2.1.cmml">​</mo><mrow id="S3.SS2.p5.8.m8.1.2.3.2" xref="S3.SS2.p5.8.m8.1.2.cmml"><mo stretchy="false" id="S3.SS2.p5.8.m8.1.2.3.2.1" xref="S3.SS2.p5.8.m8.1.2.cmml">(</mo><mi id="S3.SS2.p5.8.m8.1.1" xref="S3.SS2.p5.8.m8.1.1.cmml">k</mi><mo stretchy="false" id="S3.SS2.p5.8.m8.1.2.3.2.2" xref="S3.SS2.p5.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.8.m8.1b"><apply id="S3.SS2.p5.8.m8.1.2.cmml" xref="S3.SS2.p5.8.m8.1.2"><times id="S3.SS2.p5.8.m8.1.2.1.cmml" xref="S3.SS2.p5.8.m8.1.2.1"></times><apply id="S3.SS2.p5.8.m8.1.2.2.cmml" xref="S3.SS2.p5.8.m8.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p5.8.m8.1.2.2.1.cmml" xref="S3.SS2.p5.8.m8.1.2.2">subscript</csymbol><ci id="S3.SS2.p5.8.m8.1.2.2.2.cmml" xref="S3.SS2.p5.8.m8.1.2.2.2">𝜎</ci><apply id="S3.SS2.p5.8.m8.1.2.2.3.cmml" xref="S3.SS2.p5.8.m8.1.2.2.3"><times id="S3.SS2.p5.8.m8.1.2.2.3.1.cmml" xref="S3.SS2.p5.8.m8.1.2.2.3.1"></times><ci id="S3.SS2.p5.8.m8.1.2.2.3.2.cmml" xref="S3.SS2.p5.8.m8.1.2.2.3.2">𝑠</ci><ci id="S3.SS2.p5.8.m8.1.2.2.3.3.cmml" xref="S3.SS2.p5.8.m8.1.2.2.3.3">𝑡</ci></apply></apply><ci id="S3.SS2.p5.8.m8.1.1.cmml" xref="S3.SS2.p5.8.m8.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.8.m8.1c">\sigma_{st}(k)</annotation></semantics></math> is the number of <math id="S3.SS2.p5.9.m9.2" class="ltx_Math" alttext="(s,t)" display="inline"><semantics id="S3.SS2.p5.9.m9.2a"><mrow id="S3.SS2.p5.9.m9.2.3.2" xref="S3.SS2.p5.9.m9.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.p5.9.m9.2.3.2.1" xref="S3.SS2.p5.9.m9.2.3.1.cmml">(</mo><mi id="S3.SS2.p5.9.m9.1.1" xref="S3.SS2.p5.9.m9.1.1.cmml">s</mi><mo id="S3.SS2.p5.9.m9.2.3.2.2" xref="S3.SS2.p5.9.m9.2.3.1.cmml">,</mo><mi id="S3.SS2.p5.9.m9.2.2" xref="S3.SS2.p5.9.m9.2.2.cmml">t</mi><mo stretchy="false" id="S3.SS2.p5.9.m9.2.3.2.3" xref="S3.SS2.p5.9.m9.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.9.m9.2b"><interval closure="open" id="S3.SS2.p5.9.m9.2.3.1.cmml" xref="S3.SS2.p5.9.m9.2.3.2"><ci id="S3.SS2.p5.9.m9.1.1.cmml" xref="S3.SS2.p5.9.m9.1.1">𝑠</ci><ci id="S3.SS2.p5.9.m9.2.2.cmml" xref="S3.SS2.p5.9.m9.2.2">𝑡</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.9.m9.2c">(s,t)</annotation></semantics></math>-paths that pass through node <math id="S3.SS2.p5.10.m10.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p5.10.m10.1a"><mi id="S3.SS2.p5.10.m10.1.1" xref="S3.SS2.p5.10.m10.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.10.m10.1b"><ci id="S3.SS2.p5.10.m10.1.1.cmml" xref="S3.SS2.p5.10.m10.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.10.m10.1c">k</annotation></semantics></math>. Then we apply softmax to normalize client centrality <math id="S3.SS2.p5.11.m11.1" class="ltx_Math" alttext="c_{k}" display="inline"><semantics id="S3.SS2.p5.11.m11.1a"><msub id="S3.SS2.p5.11.m11.1.1" xref="S3.SS2.p5.11.m11.1.1.cmml"><mi id="S3.SS2.p5.11.m11.1.1.2" xref="S3.SS2.p5.11.m11.1.1.2.cmml">c</mi><mi id="S3.SS2.p5.11.m11.1.1.3" xref="S3.SS2.p5.11.m11.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.11.m11.1b"><apply id="S3.SS2.p5.11.m11.1.1.cmml" xref="S3.SS2.p5.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.11.m11.1.1.1.cmml" xref="S3.SS2.p5.11.m11.1.1">subscript</csymbol><ci id="S3.SS2.p5.11.m11.1.1.2.cmml" xref="S3.SS2.p5.11.m11.1.1.2">𝑐</ci><ci id="S3.SS2.p5.11.m11.1.1.3.cmml" xref="S3.SS2.p5.11.m11.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.11.m11.1c">c_{k}</annotation></semantics></math> to obtain client topological prior <math id="S3.SS2.p5.12.m12.2" class="ltx_Math" alttext="p_{k}=\text{exp}(c_{k})/\sum_{k=1}^{K}\text{exp}(c_{k})" display="inline"><semantics id="S3.SS2.p5.12.m12.2a"><mrow id="S3.SS2.p5.12.m12.2.2" xref="S3.SS2.p5.12.m12.2.2.cmml"><msub id="S3.SS2.p5.12.m12.2.2.4" xref="S3.SS2.p5.12.m12.2.2.4.cmml"><mi id="S3.SS2.p5.12.m12.2.2.4.2" xref="S3.SS2.p5.12.m12.2.2.4.2.cmml">p</mi><mi id="S3.SS2.p5.12.m12.2.2.4.3" xref="S3.SS2.p5.12.m12.2.2.4.3.cmml">k</mi></msub><mo id="S3.SS2.p5.12.m12.2.2.3" xref="S3.SS2.p5.12.m12.2.2.3.cmml">=</mo><mrow id="S3.SS2.p5.12.m12.2.2.2" xref="S3.SS2.p5.12.m12.2.2.2.cmml"><mrow id="S3.SS2.p5.12.m12.1.1.1.1" xref="S3.SS2.p5.12.m12.1.1.1.1.cmml"><mtext id="S3.SS2.p5.12.m12.1.1.1.1.3" xref="S3.SS2.p5.12.m12.1.1.1.1.3a.cmml">exp</mtext><mo lspace="0em" rspace="0em" id="S3.SS2.p5.12.m12.1.1.1.1.2" xref="S3.SS2.p5.12.m12.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p5.12.m12.1.1.1.1.1.1" xref="S3.SS2.p5.12.m12.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p5.12.m12.1.1.1.1.1.1.2" xref="S3.SS2.p5.12.m12.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p5.12.m12.1.1.1.1.1.1.1" xref="S3.SS2.p5.12.m12.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p5.12.m12.1.1.1.1.1.1.1.2" xref="S3.SS2.p5.12.m12.1.1.1.1.1.1.1.2.cmml">c</mi><mi id="S3.SS2.p5.12.m12.1.1.1.1.1.1.1.3" xref="S3.SS2.p5.12.m12.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS2.p5.12.m12.1.1.1.1.1.1.3" xref="S3.SS2.p5.12.m12.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.055em" id="S3.SS2.p5.12.m12.2.2.2.3" xref="S3.SS2.p5.12.m12.2.2.2.3.cmml">/</mo><mrow id="S3.SS2.p5.12.m12.2.2.2.2" xref="S3.SS2.p5.12.m12.2.2.2.2.cmml"><msubsup id="S3.SS2.p5.12.m12.2.2.2.2.2" xref="S3.SS2.p5.12.m12.2.2.2.2.2.cmml"><mo id="S3.SS2.p5.12.m12.2.2.2.2.2.2.2" xref="S3.SS2.p5.12.m12.2.2.2.2.2.2.2.cmml">∑</mo><mrow id="S3.SS2.p5.12.m12.2.2.2.2.2.2.3" xref="S3.SS2.p5.12.m12.2.2.2.2.2.2.3.cmml"><mi id="S3.SS2.p5.12.m12.2.2.2.2.2.2.3.2" xref="S3.SS2.p5.12.m12.2.2.2.2.2.2.3.2.cmml">k</mi><mo id="S3.SS2.p5.12.m12.2.2.2.2.2.2.3.1" xref="S3.SS2.p5.12.m12.2.2.2.2.2.2.3.1.cmml">=</mo><mn id="S3.SS2.p5.12.m12.2.2.2.2.2.2.3.3" xref="S3.SS2.p5.12.m12.2.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p5.12.m12.2.2.2.2.2.3" xref="S3.SS2.p5.12.m12.2.2.2.2.2.3.cmml">K</mi></msubsup><mrow id="S3.SS2.p5.12.m12.2.2.2.2.1" xref="S3.SS2.p5.12.m12.2.2.2.2.1.cmml"><mtext id="S3.SS2.p5.12.m12.2.2.2.2.1.3" xref="S3.SS2.p5.12.m12.2.2.2.2.1.3a.cmml">exp</mtext><mo lspace="0em" rspace="0em" id="S3.SS2.p5.12.m12.2.2.2.2.1.2" xref="S3.SS2.p5.12.m12.2.2.2.2.1.2.cmml">​</mo><mrow id="S3.SS2.p5.12.m12.2.2.2.2.1.1.1" xref="S3.SS2.p5.12.m12.2.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p5.12.m12.2.2.2.2.1.1.1.2" xref="S3.SS2.p5.12.m12.2.2.2.2.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p5.12.m12.2.2.2.2.1.1.1.1" xref="S3.SS2.p5.12.m12.2.2.2.2.1.1.1.1.cmml"><mi id="S3.SS2.p5.12.m12.2.2.2.2.1.1.1.1.2" xref="S3.SS2.p5.12.m12.2.2.2.2.1.1.1.1.2.cmml">c</mi><mi id="S3.SS2.p5.12.m12.2.2.2.2.1.1.1.1.3" xref="S3.SS2.p5.12.m12.2.2.2.2.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS2.p5.12.m12.2.2.2.2.1.1.1.3" xref="S3.SS2.p5.12.m12.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.12.m12.2b"><apply id="S3.SS2.p5.12.m12.2.2.cmml" xref="S3.SS2.p5.12.m12.2.2"><eq id="S3.SS2.p5.12.m12.2.2.3.cmml" xref="S3.SS2.p5.12.m12.2.2.3"></eq><apply id="S3.SS2.p5.12.m12.2.2.4.cmml" xref="S3.SS2.p5.12.m12.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p5.12.m12.2.2.4.1.cmml" xref="S3.SS2.p5.12.m12.2.2.4">subscript</csymbol><ci id="S3.SS2.p5.12.m12.2.2.4.2.cmml" xref="S3.SS2.p5.12.m12.2.2.4.2">𝑝</ci><ci id="S3.SS2.p5.12.m12.2.2.4.3.cmml" xref="S3.SS2.p5.12.m12.2.2.4.3">𝑘</ci></apply><apply id="S3.SS2.p5.12.m12.2.2.2.cmml" xref="S3.SS2.p5.12.m12.2.2.2"><divide id="S3.SS2.p5.12.m12.2.2.2.3.cmml" xref="S3.SS2.p5.12.m12.2.2.2.3"></divide><apply id="S3.SS2.p5.12.m12.1.1.1.1.cmml" xref="S3.SS2.p5.12.m12.1.1.1.1"><times id="S3.SS2.p5.12.m12.1.1.1.1.2.cmml" xref="S3.SS2.p5.12.m12.1.1.1.1.2"></times><ci id="S3.SS2.p5.12.m12.1.1.1.1.3a.cmml" xref="S3.SS2.p5.12.m12.1.1.1.1.3"><mtext id="S3.SS2.p5.12.m12.1.1.1.1.3.cmml" xref="S3.SS2.p5.12.m12.1.1.1.1.3">exp</mtext></ci><apply id="S3.SS2.p5.12.m12.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p5.12.m12.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.12.m12.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p5.12.m12.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p5.12.m12.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p5.12.m12.1.1.1.1.1.1.1.2">𝑐</ci><ci id="S3.SS2.p5.12.m12.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p5.12.m12.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.SS2.p5.12.m12.2.2.2.2.cmml" xref="S3.SS2.p5.12.m12.2.2.2.2"><apply id="S3.SS2.p5.12.m12.2.2.2.2.2.cmml" xref="S3.SS2.p5.12.m12.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p5.12.m12.2.2.2.2.2.1.cmml" xref="S3.SS2.p5.12.m12.2.2.2.2.2">superscript</csymbol><apply id="S3.SS2.p5.12.m12.2.2.2.2.2.2.cmml" xref="S3.SS2.p5.12.m12.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p5.12.m12.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p5.12.m12.2.2.2.2.2">subscript</csymbol><sum id="S3.SS2.p5.12.m12.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p5.12.m12.2.2.2.2.2.2.2"></sum><apply id="S3.SS2.p5.12.m12.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p5.12.m12.2.2.2.2.2.2.3"><eq id="S3.SS2.p5.12.m12.2.2.2.2.2.2.3.1.cmml" xref="S3.SS2.p5.12.m12.2.2.2.2.2.2.3.1"></eq><ci id="S3.SS2.p5.12.m12.2.2.2.2.2.2.3.2.cmml" xref="S3.SS2.p5.12.m12.2.2.2.2.2.2.3.2">𝑘</ci><cn type="integer" id="S3.SS2.p5.12.m12.2.2.2.2.2.2.3.3.cmml" xref="S3.SS2.p5.12.m12.2.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p5.12.m12.2.2.2.2.2.3.cmml" xref="S3.SS2.p5.12.m12.2.2.2.2.2.3">𝐾</ci></apply><apply id="S3.SS2.p5.12.m12.2.2.2.2.1.cmml" xref="S3.SS2.p5.12.m12.2.2.2.2.1"><times id="S3.SS2.p5.12.m12.2.2.2.2.1.2.cmml" xref="S3.SS2.p5.12.m12.2.2.2.2.1.2"></times><ci id="S3.SS2.p5.12.m12.2.2.2.2.1.3a.cmml" xref="S3.SS2.p5.12.m12.2.2.2.2.1.3"><mtext id="S3.SS2.p5.12.m12.2.2.2.2.1.3.cmml" xref="S3.SS2.p5.12.m12.2.2.2.2.1.3">exp</mtext></ci><apply id="S3.SS2.p5.12.m12.2.2.2.2.1.1.1.1.cmml" xref="S3.SS2.p5.12.m12.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.12.m12.2.2.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p5.12.m12.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p5.12.m12.2.2.2.2.1.1.1.1.2.cmml" xref="S3.SS2.p5.12.m12.2.2.2.2.1.1.1.1.2">𝑐</ci><ci id="S3.SS2.p5.12.m12.2.2.2.2.1.1.1.1.3.cmml" xref="S3.SS2.p5.12.m12.2.2.2.2.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.12.m12.2c">p_{k}=\text{exp}(c_{k})/\sum_{k=1}^{K}\text{exp}(c_{k})</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<p id="S3.SS2.p6.2" class="ltx_p"><span id="S3.SS2.p6.2.1" class="ltx_text ltx_font_bold">Discussion.</span> <span id="S3.SS2.p6.2.2" class="ltx_text ltx_font_bold">Handling high-dimensional models.</span> Large models are getting more attention in FL <cite class="ltx_cite ltx_citemacro_citep">(Zhuang et al., <a href="#bib.bib79" title="" class="ltx_ref">2023</a>)</cite>. Its high dimensionality might raise computational concerns when calculating model similarity. For better computation efficiency, we can leverage only partial model parameters, <span id="S3.SS2.p6.2.3" class="ltx_text ltx_font_italic">e.g.,</span> the last few layers. We empirically show that using partial parameters does not significantly affect the OOF performance (see results in Table <a href="#S5.T7" title="Table 7 ‣ 5 Related Work ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>). <span id="S3.SS2.p6.2.4" class="ltx_text ltx_font_bold">Client topology learning in cross-device settings</span>.
Client topology learning incurs <math id="S3.SS2.p6.1.m1.1" class="ltx_Math" alttext="\mathcal{O}(N^{2})" display="inline"><semantics id="S3.SS2.p6.1.m1.1a"><mrow id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p6.1.m1.1.1.3" xref="S3.SS2.p6.1.m1.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p6.1.m1.1.1.2" xref="S3.SS2.p6.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p6.1.m1.1.1.1.1" xref="S3.SS2.p6.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p6.1.m1.1.1.1.1.2" xref="S3.SS2.p6.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S3.SS2.p6.1.m1.1.1.1.1.1" xref="S3.SS2.p6.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.p6.1.m1.1.1.1.1.1.2" xref="S3.SS2.p6.1.m1.1.1.1.1.1.2.cmml">N</mi><mn id="S3.SS2.p6.1.m1.1.1.1.1.1.3" xref="S3.SS2.p6.1.m1.1.1.1.1.1.3.cmml">2</mn></msup><mo stretchy="false" id="S3.SS2.p6.1.m1.1.1.1.1.3" xref="S3.SS2.p6.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.1b"><apply id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1"><times id="S3.SS2.p6.1.m1.1.1.2.cmml" xref="S3.SS2.p6.1.m1.1.1.2"></times><ci id="S3.SS2.p6.1.m1.1.1.3.cmml" xref="S3.SS2.p6.1.m1.1.1.3">𝒪</ci><apply id="S3.SS2.p6.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p6.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p6.1.m1.1.1.1.1.1.2">𝑁</ci><cn type="integer" id="S3.SS2.p6.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p6.1.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.1c">\mathcal{O}(N^{2})</annotation></semantics></math> computation complexity for <math id="S3.SS2.p6.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.p6.2.m2.1a"><mi id="S3.SS2.p6.2.m2.1.1" xref="S3.SS2.p6.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.2.m2.1b"><ci id="S3.SS2.p6.2.m2.1.1.cmml" xref="S3.SS2.p6.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.2.m2.1c">N</annotation></semantics></math> clients. This quadratic complexity could be prohibitively expensive in cross-device FL that involves thousands or millions of clients. We argue that computation costs can be significantly reduced via client clustering <cite class="ltx_cite ltx_citemacro_citep">(Sattler et al., <a href="#bib.bib50" title="" class="ltx_ref">2020</a>)</cite>. Our empirical evaluation (see results in Table <a href="#S4.T6" title="Table 6 ‣ 4.5 Evaluation on Effectiveness of Client Clustering ‣ 4 Experiments ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>) shows that client clustering significantly reduces computation costs.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets and Baselines</h3>

<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Accuracy on the PACS. We conduct experiments using <span id="S4.T1.7.1" class="ltx_text ltx_font_italic">leave-one-domain-out</span>, meaning each domain serves as the evaluation domain in turn. Existing methods typically consider each domain as an individual client <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib26" title="" class="ltx_ref">2021</a>; Nguyen et al., <a href="#bib.bib39" title="" class="ltx_ref">2022</a>)</cite>. To simulate a large-scale setting, we further divide each domain into <math id="S4.T1.3.m1.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S4.T1.3.m1.1b"><mn id="S4.T1.3.m1.1.1" xref="S4.T1.3.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S4.T1.3.m1.1c"><cn type="integer" id="S4.T1.3.m1.1.1.cmml" xref="S4.T1.3.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.m1.1d">5</annotation></semantics></math> subsets and treat each subset as a separate client. The total number of clients is <math id="S4.T1.4.m2.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S4.T1.4.m2.1b"><mn id="S4.T1.4.m2.1.1" xref="S4.T1.4.m2.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S4.T1.4.m2.1c"><cn type="integer" id="S4.T1.4.m2.1.1.cmml" xref="S4.T1.4.m2.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.m2.1d">20</annotation></semantics></math>. The reported numbers are from three independent runs. <span id="S4.T1.8.2" class="ltx_text ltx_font_italic">Our method outperformed others across all tested settings</span>.</figcaption>
<div id="S4.T1.9" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:390.3pt;height:91.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-149.4pt,35.1pt) scale(0.566421440366021,0.566421440366021) ;">
<table id="S4.T1.9.1" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.9.1.1.1" class="ltx_tr">
<td id="S4.T1.9.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" colspan="2" rowspan="2"><span id="S4.T1.9.1.1.1.1.1" class="ltx_text">Models</span></td>
<td id="S4.T1.9.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S4.T1.9.1.1.1.2.1" class="ltx_text">Backbone</span></td>
<td id="S4.T1.9.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="5">PACS</td>
</tr>
<tr id="S4.T1.9.1.2.2" class="ltx_tr">
<td id="S4.T1.9.1.2.2.1" class="ltx_td ltx_align_center ltx_border_t">A</td>
<td id="S4.T1.9.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">C</td>
<td id="S4.T1.9.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">P</td>
<td id="S4.T1.9.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">S</td>
<td id="S4.T1.9.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t">Average</td>
</tr>
<tr id="S4.T1.9.1.3.3" class="ltx_tr">
<td id="S4.T1.9.1.3.3.1" class="ltx_td ltx_align_center ltx_border_t" rowspan="2"><span id="S4.T1.9.1.3.3.1.1" class="ltx_text">
<span id="S4.T1.9.1.3.3.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T1.9.1.3.3.1.1.1.1" class="ltx_tr">
<span id="S4.T1.9.1.3.3.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Centralized</span></span>
<span id="S4.T1.9.1.3.3.1.1.1.2" class="ltx_tr">
<span id="S4.T1.9.1.3.3.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Methods</span></span>
</span></span></td>
<td id="S4.T1.9.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">DGER <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib76" title="" class="ltx_ref">2020</a>)</cite>
</td>
<td id="S4.T1.9.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t">ResNet18</td>
<td id="S4.T1.9.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">80.70</td>
<td id="S4.T1.9.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t">76.40</td>
<td id="S4.T1.9.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t">96.65</td>
<td id="S4.T1.9.1.3.3.7" class="ltx_td ltx_align_center ltx_border_t">71.77</td>
<td id="S4.T1.9.1.3.3.8" class="ltx_td ltx_align_center ltx_border_t">81.38</td>
</tr>
<tr id="S4.T1.9.1.4.4" class="ltx_tr">
<td id="S4.T1.9.1.4.4.1" class="ltx_td ltx_align_center">DIRT-GAN <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et al., <a href="#bib.bib38" title="" class="ltx_ref">2021</a>)</cite>
</td>
<td id="S4.T1.9.1.4.4.2" class="ltx_td ltx_align_center">ResNet18</td>
<td id="S4.T1.9.1.4.4.3" class="ltx_td ltx_align_center">82.56</td>
<td id="S4.T1.9.1.4.4.4" class="ltx_td ltx_align_center">76.37</td>
<td id="S4.T1.9.1.4.4.5" class="ltx_td ltx_align_center">95.65</td>
<td id="S4.T1.9.1.4.4.6" class="ltx_td ltx_align_center">79.89</td>
<td id="S4.T1.9.1.4.4.7" class="ltx_td ltx_align_center">83.62</td>
</tr>
<tr id="S4.T1.9.1.5.5" class="ltx_tr">
<td id="S4.T1.9.1.5.5.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" rowspan="5"><span id="S4.T1.9.1.5.5.1.1" class="ltx_text">
<span id="S4.T1.9.1.5.5.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T1.9.1.5.5.1.1.1.1" class="ltx_tr">
<span id="S4.T1.9.1.5.5.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Federated</span></span>
<span id="S4.T1.9.1.5.5.1.1.1.2" class="ltx_tr">
<span id="S4.T1.9.1.5.5.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Learning</span></span>
<span id="S4.T1.9.1.5.5.1.1.1.3" class="ltx_tr">
<span id="S4.T1.9.1.5.5.1.1.1.3.1" class="ltx_td ltx_nopad_r ltx_align_center">Methods</span></span>
</span></span></td>
<td id="S4.T1.9.1.5.5.2" class="ltx_td ltx_align_center ltx_border_t">FedAvg</td>
<td id="S4.T1.9.1.5.5.3" class="ltx_td ltx_align_center ltx_border_t">ResNet18</td>
<td id="S4.T1.9.1.5.5.4" class="ltx_td ltx_align_center ltx_border_t">55.83±0.31</td>
<td id="S4.T1.9.1.5.5.5" class="ltx_td ltx_align_center ltx_border_t">61.37±0.66</td>
<td id="S4.T1.9.1.5.5.6" class="ltx_td ltx_align_center ltx_border_t">77.87±0.61</td>
<td id="S4.T1.9.1.5.5.7" class="ltx_td ltx_align_center ltx_border_t">74.53±0.18</td>
<td id="S4.T1.9.1.5.5.8" class="ltx_td ltx_align_center ltx_border_t">67.40</td>
</tr>
<tr id="S4.T1.9.1.6.6" class="ltx_tr">
<td id="S4.T1.9.1.6.6.1" class="ltx_td ltx_align_center">FedProx</td>
<td id="S4.T1.9.1.6.6.2" class="ltx_td ltx_align_center">ResNet18</td>
<td id="S4.T1.9.1.6.6.3" class="ltx_td ltx_align_center">56.84±0.88</td>
<td id="S4.T1.9.1.6.6.4" class="ltx_td ltx_align_center">62.56±0.87</td>
<td id="S4.T1.9.1.6.6.5" class="ltx_td ltx_align_center">78.33±0.46</td>
<td id="S4.T1.9.1.6.6.6" class="ltx_td ltx_align_center">75.17±0.61</td>
<td id="S4.T1.9.1.6.6.7" class="ltx_td ltx_align_center">68.23</td>
</tr>
<tr id="S4.T1.9.1.7.7" class="ltx_tr">
<td id="S4.T1.9.1.7.7.1" class="ltx_td ltx_align_center">DRFA</td>
<td id="S4.T1.9.1.7.7.2" class="ltx_td ltx_align_center">ResNet18</td>
<td id="S4.T1.9.1.7.7.3" class="ltx_td ltx_align_center">56.59±0.34</td>
<td id="S4.T1.9.1.7.7.4" class="ltx_td ltx_align_center">62.87±0.22</td>
<td id="S4.T1.9.1.7.7.5" class="ltx_td ltx_align_center">78.63±0.77</td>
<td id="S4.T1.9.1.7.7.6" class="ltx_td ltx_align_center">75.55±0.42</td>
<td id="S4.T1.9.1.7.7.7" class="ltx_td ltx_align_center">68.41</td>
</tr>
<tr id="S4.T1.9.1.8.8" class="ltx_tr">
<td id="S4.T1.9.1.8.8.1" class="ltx_td ltx_align_center">FedSR</td>
<td id="S4.T1.9.1.8.8.2" class="ltx_td ltx_align_center">ResNet18</td>
<td id="S4.T1.9.1.8.8.3" class="ltx_td ltx_align_center">57.56±0.95</td>
<td id="S4.T1.9.1.8.8.4" class="ltx_td ltx_align_center">61.91±0.35</td>
<td id="S4.T1.9.1.8.8.5" class="ltx_td ltx_align_center">78.42±0.19</td>
<td id="S4.T1.9.1.8.8.6" class="ltx_td ltx_align_center">74.73±0.27</td>
<td id="S4.T1.9.1.8.8.7" class="ltx_td ltx_align_center">68.16</td>
</tr>
<tr id="S4.T1.9.1.9.9" class="ltx_tr">
<td id="S4.T1.9.1.9.9.1" class="ltx_td ltx_align_center ltx_border_bb">TFL (Ours)</td>
<td id="S4.T1.9.1.9.9.2" class="ltx_td ltx_align_center ltx_border_bb">ResNet18</td>
<td id="S4.T1.9.1.9.9.3" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S4.T1.9.1.9.9.3.1" class="ltx_text ltx_font_bold">59.05</span>±0.69</td>
<td id="S4.T1.9.1.9.9.4" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S4.T1.9.1.9.9.4.1" class="ltx_text ltx_font_bold">64.46</span>±0.21</td>
<td id="S4.T1.9.1.9.9.5" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S4.T1.9.1.9.9.5.1" class="ltx_text ltx_font_bold">79.35</span>±0.61</td>
<td id="S4.T1.9.1.9.9.6" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S4.T1.9.1.9.9.6.1" class="ltx_text ltx_font_bold">76.93</span>±0.39</td>
<td id="S4.T1.9.1.9.9.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.9.1.9.9.7.1" class="ltx_text ltx_font_bold">69.95</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Best ROC-AUCs, corresponding communication round, and the total number of communicated parameters (donate as c-params. (M) in the table) on eICU. This dataset comprises EHRs collected from a diverse range of <math id="S4.T2.4.m1.1" class="ltx_Math" alttext="72" display="inline"><semantics id="S4.T2.4.m1.1b"><mn id="S4.T2.4.m1.1.1" xref="S4.T2.4.m1.1.1.cmml">72</mn><annotation-xml encoding="MathML-Content" id="S4.T2.4.m1.1c"><cn type="integer" id="S4.T2.4.m1.1.1.cmml" xref="S4.T2.4.m1.1.1">72</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.m1.1d">72</annotation></semantics></math> hospitals across the United States. We trained our model using data from <math id="S4.T2.5.m2.1" class="ltx_Math" alttext="58" display="inline"><semantics id="S4.T2.5.m2.1b"><mn id="S4.T2.5.m2.1.1" xref="S4.T2.5.m2.1.1.cmml">58</mn><annotation-xml encoding="MathML-Content" id="S4.T2.5.m2.1c"><cn type="integer" id="S4.T2.5.m2.1.1.cmml" xref="S4.T2.5.m2.1.1">58</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.m2.1d">58</annotation></semantics></math> hospitals located in the MIDWEST, NORTHEAST, and SOUTH regions. We evaluated the performance of the global model on an independent set of <math id="S4.T2.6.m3.1" class="ltx_Math" alttext="14" display="inline"><semantics id="S4.T2.6.m3.1b"><mn id="S4.T2.6.m3.1.1" xref="S4.T2.6.m3.1.1.cmml">14</mn><annotation-xml encoding="MathML-Content" id="S4.T2.6.m3.1c"><cn type="integer" id="S4.T2.6.m3.1.1.cmml" xref="S4.T2.6.m3.1.1">14</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.m3.1d">14</annotation></semantics></math> hospitals from the WEST. The reported numbers are from three independent runs. <span id="S4.T2.8.1" class="ltx_text ltx_font_italic"> Our approach achieves the best OOF performance with minimal communication rounds and the number of communicated parameters.</span></figcaption>
<div id="S4.T2.9" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:36pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-216.6pt,18.0pt) scale(0.500281717117988,0.500281717117988) ;">
<table id="S4.T2.9.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.9.1.1.1" class="ltx_tr">
<th id="S4.T2.9.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">Centralized Method</th>
<td id="S4.T2.9.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="15">Federated Learning Methods</td>
</tr>
<tr id="S4.T2.9.1.2.2" class="ltx_tr">
<th id="S4.T2.9.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T2.9.1.2.2.1.1" class="ltx_text">ERM</span></th>
<td id="S4.T2.9.1.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3">FedAvg</td>
<td id="S4.T2.9.1.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3">FedProx</td>
<td id="S4.T2.9.1.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3">DRFA</td>
<td id="S4.T2.9.1.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3">FedSR</td>
<td id="S4.T2.9.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t" colspan="3">TFL (Ours)</td>
</tr>
<tr id="S4.T2.9.1.3.3" class="ltx_tr">
<td id="S4.T2.9.1.3.3.1" class="ltx_td ltx_align_center ltx_border_t">ROC-AUC</td>
<td id="S4.T2.9.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">round</td>
<td id="S4.T2.9.1.3.3.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">c-params.</td>
<td id="S4.T2.9.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">ROC-AUC</td>
<td id="S4.T2.9.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t">round</td>
<td id="S4.T2.9.1.3.3.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">c-params.</td>
<td id="S4.T2.9.1.3.3.7" class="ltx_td ltx_align_center ltx_border_t">ROC-AUC</td>
<td id="S4.T2.9.1.3.3.8" class="ltx_td ltx_align_center ltx_border_t">round</td>
<td id="S4.T2.9.1.3.3.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">c-params.</td>
<td id="S4.T2.9.1.3.3.10" class="ltx_td ltx_align_center ltx_border_t">ROC-AUC</td>
<td id="S4.T2.9.1.3.3.11" class="ltx_td ltx_align_center ltx_border_t">round</td>
<td id="S4.T2.9.1.3.3.12" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">c-params.</td>
<td id="S4.T2.9.1.3.3.13" class="ltx_td ltx_align_center ltx_border_t">ROC-AUC</td>
<td id="S4.T2.9.1.3.3.14" class="ltx_td ltx_align_center ltx_border_t">round</td>
<td id="S4.T2.9.1.3.3.15" class="ltx_td ltx_align_left ltx_border_t">c-params.</td>
</tr>
<tr id="S4.T2.9.1.4.4" class="ltx_tr">
<th id="S4.T2.9.1.4.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t">67.04±1.88</th>
<td id="S4.T2.9.1.4.4.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">57.18±0.03</td>
<td id="S4.T2.9.1.4.4.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">6</td>
<td id="S4.T2.9.1.4.4.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">15.66M</td>
<td id="S4.T2.9.1.4.4.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">57.21±0.01</td>
<td id="S4.T2.9.1.4.4.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">6</td>
<td id="S4.T2.9.1.4.4.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">15.66M</td>
<td id="S4.T2.9.1.4.4.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">57.20±0.09</td>
<td id="S4.T2.9.1.4.4.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">2</td>
<td id="S4.T2.9.1.4.4.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">10.44M</td>
<td id="S4.T2.9.1.4.4.11" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">57.25±0.03</td>
<td id="S4.T2.9.1.4.4.12" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">8</td>
<td id="S4.T2.9.1.4.4.13" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">20.88M</td>
<td id="S4.T2.9.1.4.4.14" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">
<span id="S4.T2.9.1.4.4.14.1" class="ltx_text ltx_font_bold">58.41</span>±0.06</td>
<td id="S4.T2.9.1.4.4.15" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">2</td>
<td id="S4.T2.9.1.4.4.16" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">10.44M</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">Datasets.</span> TFL is evaluated on our curated real-world datasets (①eICU, ②FeTS, ③TPT-48) and standard benchmarks (④CIFAR-10/-100, ⑤PACS), spanning a wide range of tasks including classification, regression, and segmentation. Evaluations covers both out-of-federation (datasets ①-③, ⑤) and in-federation (datasets ③-④) scenarios. Below are the descriptions of the real-world datasets. For detailed descriptions of all datasets, including ④CIFAR-10/-100 and ⑤PACS, please refer to Supplementary A.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<ol id="S4.I1" class="ltx_enumerate">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">①</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.4" class="ltx_p"><span id="S4.I1.i1.p1.4.1" class="ltx_text ltx_font_bold">eICU</span> <cite class="ltx_cite ltx_citemacro_citep">(Pollard et al., <a href="#bib.bib43" title="" class="ltx_ref">2018</a>)</cite> is a large-scale multi-center critical care database. It contains high granularity critical care data for over <math id="S4.I1.i1.p1.1.m1.2" class="ltx_Math" alttext="200,000" display="inline"><semantics id="S4.I1.i1.p1.1.m1.2a"><mrow id="S4.I1.i1.p1.1.m1.2.3.2" xref="S4.I1.i1.p1.1.m1.2.3.1.cmml"><mn id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml">200</mn><mo id="S4.I1.i1.p1.1.m1.2.3.2.1" xref="S4.I1.i1.p1.1.m1.2.3.1.cmml">,</mo><mn id="S4.I1.i1.p1.1.m1.2.2" xref="S4.I1.i1.p1.1.m1.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.2b"><list id="S4.I1.i1.p1.1.m1.2.3.1.cmml" xref="S4.I1.i1.p1.1.m1.2.3.2"><cn type="integer" id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">200</cn><cn type="integer" id="S4.I1.i1.p1.1.m1.2.2.cmml" xref="S4.I1.i1.p1.1.m1.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.2c">200,000</annotation></semantics></math> patients admitted to <math id="S4.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="208" display="inline"><semantics id="S4.I1.i1.p1.2.m2.1a"><mn id="S4.I1.i1.p1.2.m2.1.1" xref="S4.I1.i1.p1.2.m2.1.1.cmml">208</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.2.m2.1b"><cn type="integer" id="S4.I1.i1.p1.2.m2.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1">208</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.2.m2.1c">208</annotation></semantics></math> hospitals across the United States. We follow <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib16" title="" class="ltx_ref">2019</a>)</cite> to pre-process the raw data. The resultant dataset comprises <math id="S4.I1.i1.p1.3.m3.2" class="ltx_Math" alttext="19,000" display="inline"><semantics id="S4.I1.i1.p1.3.m3.2a"><mrow id="S4.I1.i1.p1.3.m3.2.3.2" xref="S4.I1.i1.p1.3.m3.2.3.1.cmml"><mn id="S4.I1.i1.p1.3.m3.1.1" xref="S4.I1.i1.p1.3.m3.1.1.cmml">19</mn><mo id="S4.I1.i1.p1.3.m3.2.3.2.1" xref="S4.I1.i1.p1.3.m3.2.3.1.cmml">,</mo><mn id="S4.I1.i1.p1.3.m3.2.2" xref="S4.I1.i1.p1.3.m3.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.3.m3.2b"><list id="S4.I1.i1.p1.3.m3.2.3.1.cmml" xref="S4.I1.i1.p1.3.m3.2.3.2"><cn type="integer" id="S4.I1.i1.p1.3.m3.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1">19</cn><cn type="integer" id="S4.I1.i1.p1.3.m3.2.2.cmml" xref="S4.I1.i1.p1.3.m3.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.3.m3.2c">19,000</annotation></semantics></math> patients over <math id="S4.I1.i1.p1.4.m4.1" class="ltx_Math" alttext="72" display="inline"><semantics id="S4.I1.i1.p1.4.m4.1a"><mn id="S4.I1.i1.p1.4.m4.1.1" xref="S4.I1.i1.p1.4.m4.1.1.cmml">72</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.4.m4.1b"><cn type="integer" id="S4.I1.i1.p1.4.m4.1.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1">72</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.4.m4.1c">72</annotation></semantics></math> hospitals. We further split the patients into four groups based on census regions and provided the protocol for OOF evaluation.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;padding-top:2.5pt;">
<span class="ltx_tag ltx_tag_item">②</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.3" class="ltx_p"><span id="S4.I1.i2.p1.3.1" class="ltx_text ltx_font_bold">FeTS</span> <cite class="ltx_cite ltx_citemacro_citep">(Pati et al., <a href="#bib.bib42" title="" class="ltx_ref">2022b</a>)</cite> is a multi-institutional medical imaging dataset. It comprises clinically acquired MRI scans of glioma. We use a subset of the original data, comprising <math id="S4.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="358" display="inline"><semantics id="S4.I1.i2.p1.1.m1.1a"><mn id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml">358</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><cn type="integer" id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1">358</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">358</annotation></semantics></math> subjects from <math id="S4.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="21" display="inline"><semantics id="S4.I1.i2.p1.2.m2.1a"><mn id="S4.I1.i2.p1.2.m2.1.1" xref="S4.I1.i2.p1.2.m2.1.1.cmml">21</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.m2.1b"><cn type="integer" id="S4.I1.i2.p1.2.m2.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1">21</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.m2.1c">21</annotation></semantics></math> distinct global institutions, and provide a protocol for OOF evaluation. The task is brain tumor segmentation and the evaluation metric is Dice Similarity Coefficient (DSC <math id="S4.I1.i2.p1.3.m3.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.I1.i2.p1.3.m3.1a"><mo stretchy="false" id="S4.I1.i2.p1.3.m3.1.1" xref="S4.I1.i2.p1.3.m3.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.3.m3.1b"><ci id="S4.I1.i2.p1.3.m3.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.3.m3.1c">\uparrow</annotation></semantics></math>).</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;padding-top:2.5pt;">
<span class="ltx_tag ltx_tag_item">③</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.3" class="ltx_p"><span id="S4.I1.i3.p1.3.1" class="ltx_text ltx_font_bold">TPT-48</span> <cite class="ltx_cite ltx_citemacro_citep">(Vose et al., <a href="#bib.bib64" title="" class="ltx_ref">2014</a>)</cite> contains the monthly average temperature for the 48 contiguous states in the US from 2008 to 2019. The task is to predict the next six months’ temperature given the first six months’ data. We consider two tasks: (1) E(24) <math id="S4.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S4.I1.i3.p1.1.m1.1a"><mo stretchy="false" id="S4.I1.i3.p1.1.m1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.1.m1.1b"><ci id="S4.I1.i3.p1.1.m1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.1.m1.1c">\rightarrow</annotation></semantics></math> W(24): Using the 24 eastern states as IF clients and the 24 western states as OOF clients; (2) N(24) <math id="S4.I1.i3.p1.2.m2.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S4.I1.i3.p1.2.m2.1a"><mo stretchy="false" id="S4.I1.i3.p1.2.m2.1.1" xref="S4.I1.i3.p1.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.2.m2.1b"><ci id="S4.I1.i3.p1.2.m2.1.1.cmml" xref="S4.I1.i3.p1.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.2.m2.1c">\rightarrow</annotation></semantics></math> S(24): Using the 24 northern states as IF clients and the 24 southern states as OOF clients. The evaluation metric is Mean Squared Error (MSE <math id="S4.I1.i3.p1.3.m3.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.I1.i3.p1.3.m3.1a"><mo stretchy="false" id="S4.I1.i3.p1.3.m3.1.1" xref="S4.I1.i3.p1.3.m3.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.3.m3.1b"><ci id="S4.I1.i3.p1.3.m3.1.1.cmml" xref="S4.I1.i3.p1.3.m3.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.3.m3.1c">\downarrow</annotation></semantics></math>).</p>
</div>
</li>
</ol>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p"><span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_bold">Baselines</span>. We compare with FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib32" title="" class="ltx_ref">2017</a>)</cite> and FedProx <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib23" title="" class="ltx_ref">2020b</a>)</cite>, the most referenced baselines in the literature. DRFA <cite class="ltx_cite ltx_citemacro_citep">(Deng et al., <a href="#bib.bib8" title="" class="ltx_ref">2020</a>)</cite> is the latest work that adopts the federated distributionally robust optimization framework. FedSR <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et al., <a href="#bib.bib39" title="" class="ltx_ref">2022</a>)</cite> is the most recent work that tackles FL’s generalization to unseen clients. We did not compare with FedDG <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib26" title="" class="ltx_ref">2021</a>)</cite> as it requires the sharing of data in the frequency space with each other. This can be viewed as a form of data leakage <cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a href="#bib.bib1" title="" class="ltx_ref">2023</a>; Nguyen et al., <a href="#bib.bib39" title="" class="ltx_ref">2022</a>)</cite>. We provide implementation details on model architecture and hyperparameters in Supplementary D.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Evaluation on OOF-resiliency</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.6" class="ltx_p"><span id="S4.SS2.p1.6.1" class="ltx_text ltx_font_bold">Takeaway 1: Learning on client topology improves OOF robustness</span>.
We evaluate our method on different datasets and summarize the results in Tables <a href="#S4.T1" title="Table 1 ‣ 4.1 Datasets and Baselines ‣ 4 Experiments ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, <a href="#S4.T2" title="Table 2 ‣ 4.1 Datasets and Baselines ‣ 4 Experiments ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, and <a href="#S4.T3" title="Table 3 ‣ 4.2 Evaluation on OOF-resiliency ‣ 4 Experiments ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. We make the following observation: our method improves the model’s OOF-resiliency on both standard and real-world datasets. From Table <a href="#S4.T1" title="Table 1 ‣ 4.1 Datasets and Baselines ‣ 4 Experiments ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, our method performs <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="2.25\%" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mn id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">2.25</mn><mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">2.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">2.25\%</annotation></semantics></math> better than the federated robust optimization method (DRFA) and <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="2.63\%" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mn id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">2.63</mn><mo id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">2.63</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">2.63\%</annotation></semantics></math> better than the federated domain generalization method (FedSR).
From Table <a href="#S4.T2" title="Table 2 ‣ 4.1 Datasets and Baselines ‣ 4 Experiments ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, our method performs <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="2.11\%" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mn id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">2.11</mn><mo id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><csymbol cd="latexml" id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">2.11</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">2.11\%</annotation></semantics></math> better than DRFA and <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="2.03\%" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mn id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">2.03</mn><mo id="S4.SS2.p1.4.m4.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><csymbol cd="latexml" id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">2.03</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">2.03\%</annotation></semantics></math> better than FedSR.
Lastly, from Table <a href="#S4.T3" title="Table 3 ‣ 4.2 Evaluation on OOF-resiliency ‣ 4 Experiments ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, our method performs <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="1.98\%" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mrow id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><mn id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml">1.98</mn><mo id="S4.SS2.p1.5.m5.1.1.1" xref="S4.SS2.p1.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><csymbol cd="latexml" id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2">1.98</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">1.98\%</annotation></semantics></math> better than DRFA and <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="3.00\%" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><mrow id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml"><mn id="S4.SS2.p1.6.m6.1.1.2" xref="S4.SS2.p1.6.m6.1.1.2.cmml">3.00</mn><mo id="S4.SS2.p1.6.m6.1.1.1" xref="S4.SS2.p1.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><apply id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1"><csymbol cd="latexml" id="S4.SS2.p1.6.m6.1.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.p1.6.m6.1.1.2.cmml" xref="S4.SS2.p1.6.m6.1.1.2">3.00</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">3.00\%</annotation></semantics></math> better than FedSR. Overall, our method shows consistently superior OOF robustness than state-of-the-art across all the evaluated datasets. We also visualize the segmentation results of FeTS in Figure <a href="#S4.F5" title="Figure 5 ‣ 4.2 Evaluation on OOF-resiliency ‣ 4 Experiments ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
Our method delivers high-quality segmentation results, suggesting increased reliability for real-world healthcare applications that have to contend with diverse local demographics.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p"><span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_bold">Visualization of client topology</span>. We also visualize the learned client topology of the eICU dataset in Figure <a href="#S4.F6" title="Figure 6 ‣ 4.2 Evaluation on OOF-resiliency ‣ 4 Experiments ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. We observe that the learned client topology helps to identify the “influential” clients. The figure indicates that the majority of important clients are from the MIDWEST and SOUTH, with no influential clients from the NORTHEAST.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>DSC (<math id="S4.T3.2.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T3.2.m1.1b"><mo stretchy="false" id="S4.T3.2.m1.1.1" xref="S4.T3.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.2.m1.1c"><ci id="S4.T3.2.m1.1.1.cmml" xref="S4.T3.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.m1.1d">\uparrow</annotation></semantics></math>) score on FeTS. This dataset contains tumor images from 21 institutions worldwide. We conduct training on 15 institutions and evaluate the model on the remaining 5. The reported numbers are from three independent runs. <span id="S4.T3.4.1" class="ltx_text ltx_font_italic">Our method delivers the best OOF robustness.</span></figcaption>
<div id="S4.T3.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:57.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(14.5pt,-1.9pt) scale(1.071693445439,1.071693445439) ;">
<table id="S4.T3.5.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.5.1.1.1" class="ltx_tr">
<th id="S4.T3.5.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Centralized Method</th>
<th id="S4.T3.5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="5">Federated Learning Methods</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.5.1.2.1" class="ltx_tr">
<td id="S4.T3.5.1.2.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ERM</td>
<td id="S4.T3.5.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">FedAvg</td>
<td id="S4.T3.5.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">FedProx</td>
<td id="S4.T3.5.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">DRFA</td>
<td id="S4.T3.5.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">FedSR</td>
<td id="S4.T3.5.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t">TFL (Ours)</td>
</tr>
<tr id="S4.T3.5.1.3.2" class="ltx_tr">
<td id="S4.T3.5.1.3.2.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">83.14±0.98</td>
<td id="S4.T3.5.1.3.2.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">71.45±0.05</td>
<td id="S4.T3.5.1.3.2.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">71.15±0.04</td>
<td id="S4.T3.5.1.3.2.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">72.12±1.03</td>
<td id="S4.T3.5.1.3.2.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">72.85±0.05</td>
<td id="S4.T3.5.1.3.2.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">
<span id="S4.T3.5.1.3.2.6.1" class="ltx_text ltx_font_bold">74.29</span>±0.15</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2407.04949/assets/x5.png" id="S4.F5.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="452" height="176" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Qualitative results on unseen patients from FeTS dataset. We also show the DSC (<math id="S4.F5.3.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.F5.3.m1.1b"><mo stretchy="false" id="S4.F5.3.m1.1.1" xref="S4.F5.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.F5.3.m1.1c"><ci id="S4.F5.3.m1.1.1.cmml" xref="S4.F5.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.3.m1.1d">\uparrow</annotation></semantics></math>) score. <span id="S4.F5.5.1" class="ltx_text ltx_font_italic">Our method consistently demonstrates superior OOF robustness under diverse local demographics</span>. Additional visualizations can be found in Supplementary A.</figcaption>
</figure>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2407.04949/assets/x6.png" id="S4.F6.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="452" height="122" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Visualization of client topology on the eICU dataset. Hospitals from MIDWEST, SOUTH, and NORTHEAST collaboratively train a global model, which is then applied to hospitals in the WEST region for OOF generalization. We observe that the learned client topology becomes denser, revealing underlying relationships that were previously unknown. Furthermore, the identified “influential” hospitals are more from the MIDWEST and SOUTH rather than NORTHEAST. This observation is rational, given the geographical proximity of these two regions to the target evaluation region, the WEST.</figcaption>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Evaluation on Scalability</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p"><span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_bold">Takeaway 2: TFL is scalable for OOF generalization.</span>
We investigate whether TFL will significantly increase the communication or computation overhead, potentially affecting scalability in large-scale settings. We present ROC AUC, communication rounds, and transmitted parameters for the eICU dataset in Table <a href="#S4.T2" title="Table 2 ‣ 4.1 Datasets and Baselines ‣ 4 Experiments ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and Figure <a href="#S4.F7" title="Figure 7 ‣ 4.3 Evaluation on Scalability ‣ 4 Experiments ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. Our method achieves the highest ROC AUC score while requiring the fewest communication rounds and the total number of communicated parameters, thereby indicating its superior communication efficiency. Notably, DRFA also achieves its peak performance within the same number of communication rounds as our method. This is primarily attributable to the fact that both DRFA and our approach utilize a distributionally robust optimization framework. By minimizing the worst-case combination of local client risks, the model converges faster toward the optimum. Additionally, we also show the wall clock time versus OFF accuracy on PACS in Figure <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Our method approximates the scalability of FedAvg and FedSR while achieving superior OOF accuracy.</p>
</div>
<figure id="S4.F7" class="ltx_figure"><img src="/html/2407.04949/assets/x7.png" id="S4.F7.g1" class="ltx_graphics ltx_img_landscape" width="149" height="89" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Visualization of ROC AUC vs. comm. round. <span id="S4.F7.2.1" class="ltx_text ltx_font_italic">Our method yields the best result with fewer communication rounds</span>.</figcaption>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Evaluation on In-federation Performance</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.2" class="ltx_p"><span id="S4.SS4.p1.2.1" class="ltx_text ltx_font_bold">Takeaway 3: Prioritizing influential clients also benefit in-federation (IF) performance.</span>
We have shown that TFL can significantly boost the model’s OOF robustness. This naturally leads us to examine its IF performance. We are interested in understanding if TFL can also improve the IF performance. To this end, we conducted empirical evaluations using the TPT-48 and CIFAR-10/-100. The TPT-48 dataset, offering additional hold-out data from IF clients, is particularly well-suited for evaluating IF performance. CIFAR-10 and -100 are widely recognized benchmarks for IF evaluation. The results, shown in Tables <a href="#S4.T4" title="Table 4 ‣ 4.4 Evaluation on In-federation Performance ‣ 4 Experiments ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and <a href="#S4.T5" title="Table 5 ‣ 4.4 Evaluation on In-federation Performance ‣ 4 Experiments ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, reveal that our method indeed enhances the IF performance. For example, TFL outperforms DRFA by <math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="2.2\%" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><mrow id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml"><mn id="S4.SS4.p1.1.m1.1.1.2" xref="S4.SS4.p1.1.m1.1.1.2.cmml">2.2</mn><mo id="S4.SS4.p1.1.m1.1.1.1" xref="S4.SS4.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><apply id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS4.p1.1.m1.1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.SS4.p1.1.m1.1.1.2.cmml" xref="S4.SS4.p1.1.m1.1.1.2">2.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">2.2\%</annotation></semantics></math> on TPT-48 and <math id="S4.SS4.p1.2.m2.1" class="ltx_Math" alttext="2.5\%" display="inline"><semantics id="S4.SS4.p1.2.m2.1a"><mrow id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml"><mn id="S4.SS4.p1.2.m2.1.1.2" xref="S4.SS4.p1.2.m2.1.1.2.cmml">2.5</mn><mo id="S4.SS4.p1.2.m2.1.1.1" xref="S4.SS4.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><apply id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS4.p1.2.m2.1.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1.1">percent</csymbol><cn type="float" id="S4.SS4.p1.2.m2.1.1.2.cmml" xref="S4.SS4.p1.2.m2.1.1.2">2.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">2.5\%</annotation></semantics></math> on CIFAR-10. These findings underscore the value of focusing on influential clients when building robust models with good IF and OOF performance.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Results on TPT-48. We report results for both IF and OOF evaluations. The numbers are the mean of three independent runs. <span id="S4.T4.8.1" class="ltx_text ltx_font_italic">Our method improves both the OOF and IF performance.</span></figcaption>
<div id="S4.T4.6" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:157.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(43.7pt,-15.9pt) scale(1.2526316411223,1.2526316411223) ;">
<table id="S4.T4.6.6" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T4.6.6.7.1" class="ltx_tr">
<th id="S4.T4.6.6.7.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">Method</th>
<th id="S4.T4.6.6.7.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">Centralized</th>
<td id="S4.T4.6.6.7.1.3" class="ltx_td ltx_align_center ltx_border_tt">FedAvg</td>
<td id="S4.T4.6.6.7.1.4" class="ltx_td ltx_align_center ltx_border_tt">FedProx</td>
<td id="S4.T4.6.6.7.1.5" class="ltx_td ltx_align_center ltx_border_tt">DRFA</td>
<td id="S4.T4.6.6.7.1.6" class="ltx_td ltx_align_center ltx_border_tt">TFL (Ours)</td>
</tr>
<tr id="S4.T4.1.1.1" class="ltx_tr">
<th id="S4.T4.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="6">
<span id="S4.T4.1.1.1.1.1" class="ltx_text ltx_font_italic">Out-of-federation</span> Evaluation (MSE <math id="S4.T4.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T4.1.1.1.1.m1.1a"><mo stretchy="false" id="S4.T4.1.1.1.1.m1.1.1" xref="S4.T4.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.1.m1.1b"><ci id="S4.T4.1.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math>)</th>
</tr>
<tr id="S4.T4.2.2.2" class="ltx_tr">
<th id="S4.T4.2.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">E(24) <math id="S4.T4.2.2.2.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S4.T4.2.2.2.1.m1.1a"><mo stretchy="false" id="S4.T4.2.2.2.1.m1.1.1" xref="S4.T4.2.2.2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.2.1.m1.1b"><ci id="S4.T4.2.2.2.1.m1.1.1.cmml" xref="S4.T4.2.2.2.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.2.1.m1.1c">\rightarrow</annotation></semantics></math> W(24)</th>
<th id="S4.T4.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">0.3998</th>
<td id="S4.T4.2.2.2.3" class="ltx_td ltx_align_center ltx_border_t">0.6264</td>
<td id="S4.T4.2.2.2.4" class="ltx_td ltx_align_center ltx_border_t">0.6312</td>
<td id="S4.T4.2.2.2.5" class="ltx_td ltx_align_center ltx_border_t">0.5451</td>
<td id="S4.T4.2.2.2.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.2.2.2.6.1" class="ltx_text ltx_font_bold">0.4978</span></td>
</tr>
<tr id="S4.T4.3.3.3" class="ltx_tr">
<th id="S4.T4.3.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">N(24) <math id="S4.T4.3.3.3.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S4.T4.3.3.3.1.m1.1a"><mo stretchy="false" id="S4.T4.3.3.3.1.m1.1.1" xref="S4.T4.3.3.3.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T4.3.3.3.1.m1.1b"><ci id="S4.T4.3.3.3.1.m1.1.1.cmml" xref="S4.T4.3.3.3.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.3.3.1.m1.1c">\rightarrow</annotation></semantics></math> S(24)</th>
<th id="S4.T4.3.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">1.4489</th>
<td id="S4.T4.3.3.3.3" class="ltx_td ltx_align_center">2.0172</td>
<td id="S4.T4.3.3.3.4" class="ltx_td ltx_align_center">1.9729</td>
<td id="S4.T4.3.3.3.5" class="ltx_td ltx_align_center">1.8972</td>
<td id="S4.T4.3.3.3.6" class="ltx_td ltx_align_center"><span id="S4.T4.3.3.3.6.1" class="ltx_text ltx_font_bold">1.7432</span></td>
</tr>
<tr id="S4.T4.4.4.4" class="ltx_tr">
<th id="S4.T4.4.4.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="6">
<span id="S4.T4.4.4.4.1.1" class="ltx_text ltx_font_italic">In-federation</span> Evaluation (MSE <math id="S4.T4.4.4.4.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T4.4.4.4.1.m1.1a"><mo stretchy="false" id="S4.T4.4.4.4.1.m1.1.1" xref="S4.T4.4.4.4.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T4.4.4.4.1.m1.1b"><ci id="S4.T4.4.4.4.1.m1.1.1.cmml" xref="S4.T4.4.4.4.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.4.4.1.m1.1c">\downarrow</annotation></semantics></math>)</th>
</tr>
<tr id="S4.T4.5.5.5" class="ltx_tr">
<th id="S4.T4.5.5.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">E(24) <math id="S4.T4.5.5.5.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S4.T4.5.5.5.1.m1.1a"><mo stretchy="false" id="S4.T4.5.5.5.1.m1.1.1" xref="S4.T4.5.5.5.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T4.5.5.5.1.m1.1b"><ci id="S4.T4.5.5.5.1.m1.1.1.cmml" xref="S4.T4.5.5.5.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.5.5.5.1.m1.1c">\rightarrow</annotation></semantics></math> E(24)</th>
<th id="S4.T4.5.5.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">0.1034</th>
<td id="S4.T4.5.5.5.3" class="ltx_td ltx_align_center ltx_border_t">0.2278</td>
<td id="S4.T4.5.5.5.4" class="ltx_td ltx_align_center ltx_border_t">0.2163</td>
<td id="S4.T4.5.5.5.5" class="ltx_td ltx_align_center ltx_border_t">0.1554</td>
<td id="S4.T4.5.5.5.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.5.5.5.6.1" class="ltx_text ltx_font_bold">0.1523</span></td>
</tr>
<tr id="S4.T4.6.6.6" class="ltx_tr">
<th id="S4.T4.6.6.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r">N(24) <math id="S4.T4.6.6.6.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S4.T4.6.6.6.1.m1.1a"><mo stretchy="false" id="S4.T4.6.6.6.1.m1.1.1" xref="S4.T4.6.6.6.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T4.6.6.6.1.m1.1b"><ci id="S4.T4.6.6.6.1.m1.1.1.cmml" xref="S4.T4.6.6.6.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.6.6.6.1.m1.1c">\rightarrow</annotation></semantics></math> N(24)</th>
<th id="S4.T4.6.6.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r">0.1329</th>
<td id="S4.T4.6.6.6.3" class="ltx_td ltx_align_center ltx_border_bb">0.1550</td>
<td id="S4.T4.6.6.6.4" class="ltx_td ltx_align_center ltx_border_bb">0.1523</td>
<td id="S4.T4.6.6.6.5" class="ltx_td ltx_align_center ltx_border_bb">0.1437</td>
<td id="S4.T4.6.6.6.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.6.6.6.6.1" class="ltx_text ltx_font_bold">0.1405</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>In-federation accuracy on CIFAR-10/-100, where a Dirichlet distribution <cite class="ltx_cite ltx_citemacro_citep">(Hsu et al., <a href="#bib.bib14" title="" class="ltx_ref">2019</a>)</cite> with parameter Dir(0.1) is used to partition the datasets into heterogeneous clients at different scales. The reported numbers are the mean of three independent runs. <span id="S4.T5.3.1" class="ltx_text ltx_font_italic">Our method yields the best accuracy at various scales.</span></figcaption>
<div id="S4.T5.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:121.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(55.7pt,-15.6pt) scale(1.34594722525779,1.34594722525779) ;">
<table id="S4.T5.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T5.1.1.1" class="ltx_tr">
<th id="S4.T5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">Dataset</th>
<th id="S4.T5.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">
<math id="S4.T5.1.1.1.1.m1.1" class="ltx_Math" alttext="\#" display="inline"><semantics id="S4.T5.1.1.1.1.m1.1a"><mi mathvariant="normal" id="S4.T5.1.1.1.1.m1.1.1" xref="S4.T5.1.1.1.1.m1.1.1.cmml">#</mi><annotation-xml encoding="MathML-Content" id="S4.T5.1.1.1.1.m1.1b"><ci id="S4.T5.1.1.1.1.m1.1.1.cmml" xref="S4.T5.1.1.1.1.m1.1.1">#</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.1.1.1.1.m1.1c">\#</annotation></semantics></math> of clients</th>
<td id="S4.T5.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">FedAvg</td>
<td id="S4.T5.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">FedProx</td>
<td id="S4.T5.1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">DRFA</td>
<td id="S4.T5.1.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">TFL (Ours)</td>
</tr>
<tr id="S4.T5.1.1.2.1" class="ltx_tr">
<th id="S4.T5.1.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T5.1.1.2.1.1.1" class="ltx_text">CIFAR-10</span></th>
<th id="S4.T5.1.1.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">25</th>
<td id="S4.T5.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">68.07</td>
<td id="S4.T5.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">68.15</td>
<td id="S4.T5.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">70.51</td>
<td id="S4.T5.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.1.1.2.1.6.1" class="ltx_text ltx_font_bold">72.24</span></td>
</tr>
<tr id="S4.T5.1.1.3.2" class="ltx_tr">
<th id="S4.T5.1.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">50</th>
<td id="S4.T5.1.1.3.2.2" class="ltx_td ltx_align_center">64.48</td>
<td id="S4.T5.1.1.3.2.3" class="ltx_td ltx_align_center">64.33</td>
<td id="S4.T5.1.1.3.2.4" class="ltx_td ltx_align_center">63.19</td>
<td id="S4.T5.1.1.3.2.5" class="ltx_td ltx_align_center"><span id="S4.T5.1.1.3.2.5.1" class="ltx_text ltx_font_bold">65.59</span></td>
</tr>
<tr id="S4.T5.1.1.4.3" class="ltx_tr">
<th id="S4.T5.1.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_tt" rowspan="2"><span id="S4.T5.1.1.4.3.1.1" class="ltx_text">CIFAR-100</span></th>
<th id="S4.T5.1.1.4.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">25</th>
<td id="S4.T5.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_tt">37.90</td>
<td id="S4.T5.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_tt">37.76</td>
<td id="S4.T5.1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_tt">38.04</td>
<td id="S4.T5.1.1.4.3.6" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T5.1.1.4.3.6.1" class="ltx_text ltx_font_bold">38.85</span></td>
</tr>
<tr id="S4.T5.1.1.5.4" class="ltx_tr">
<th id="S4.T5.1.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r">50</th>
<td id="S4.T5.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_bb">37.33</td>
<td id="S4.T5.1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_bb">37.28</td>
<td id="S4.T5.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_bb">37.54</td>
<td id="S4.T5.1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.1.1.5.4.5.1" class="ltx_text ltx_font_bold">38.08</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Evaluation on Effectiveness of Client Clustering</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p"><span id="S4.SS5.p1.1.1" class="ltx_text ltx_font_bold">Takeaway 4: Client clustering reduces the computation costs of client topology learning.</span>
We conducted experiments on eICU to validate whether client clustering effectively reduces computation costs. The eICU dataset was chosen due to its larger scale (including 72 clients) compared to all other evaluated datasets. Specifically, during client topology learning, we employed KMeans <cite class="ltx_cite ltx_citemacro_citep">(Lloyd, <a href="#bib.bib27" title="" class="ltx_ref">1982</a>)</cite> to group training clients into several clusters (<span id="S4.SS5.p1.1.2" class="ltx_text ltx_font_italic">e.g.,</span> 10 clusters) based on their model weights. The client topology is then learned at the cluster level. As shown in Table <a href="#S4.T6" title="Table 6 ‣ 4.5 Evaluation on Effectiveness of Client Clustering ‣ 4 Experiments ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, our clustering approach significantly reduces computation costs while slightly decreasing the OOF accuracy.</p>
</div>
<figure id="S4.T6" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Comparison of wall-clock time on eICU. <span id="S4.T6.4.2" class="ltx_text ltx_font_italic">Our client clustering approach (with 10 clusters) significantly decreases computation costs by <math id="S4.T6.3.1.m1.1" class="ltx_Math" alttext="69\%" display="inline"><semantics id="S4.T6.3.1.m1.1b"><mrow id="S4.T6.3.1.m1.1.1" xref="S4.T6.3.1.m1.1.1.cmml"><mn id="S4.T6.3.1.m1.1.1.2" xref="S4.T6.3.1.m1.1.1.2.cmml">69</mn><mo id="S4.T6.3.1.m1.1.1.1" xref="S4.T6.3.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.3.1.m1.1c"><apply id="S4.T6.3.1.m1.1.1.cmml" xref="S4.T6.3.1.m1.1.1"><csymbol cd="latexml" id="S4.T6.3.1.m1.1.1.1.cmml" xref="S4.T6.3.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.T6.3.1.m1.1.1.2.cmml" xref="S4.T6.3.1.m1.1.1.2">69</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.3.1.m1.1d">69\%</annotation></semantics></math>, while only marginally impacting OOF performance, evidenced by a slight reduction of <math id="S4.T6.4.2.m2.1" class="ltx_Math" alttext="0.77\%" display="inline"><semantics id="S4.T6.4.2.m2.1b"><mrow id="S4.T6.4.2.m2.1.1" xref="S4.T6.4.2.m2.1.1.cmml"><mn id="S4.T6.4.2.m2.1.1.2" xref="S4.T6.4.2.m2.1.1.2.cmml">0.77</mn><mo id="S4.T6.4.2.m2.1.1.1" xref="S4.T6.4.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.4.2.m2.1c"><apply id="S4.T6.4.2.m2.1.1.cmml" xref="S4.T6.4.2.m2.1.1"><csymbol cd="latexml" id="S4.T6.4.2.m2.1.1.1.cmml" xref="S4.T6.4.2.m2.1.1.1">percent</csymbol><cn type="float" id="S4.T6.4.2.m2.1.1.2.cmml" xref="S4.T6.4.2.m2.1.1.2">0.77</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.4.2.m2.1d">0.77\%</annotation></semantics></math></span>.</figcaption>
<div id="S4.T6.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:390.3pt;height:110.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(67.8pt,-19.1pt) scale(1.53191240852828,1.53191240852828) ;">
<table id="S4.T6.5.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T6.5.1.1.1" class="ltx_tr">
<th id="S4.T6.5.1.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt"></th>
<th id="S4.T6.5.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt">ROC-AUC</th>
<th id="S4.T6.5.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Wall-clock time (s)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T6.5.1.2.1" class="ltx_tr">
<th id="S4.T6.5.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">FedAvg</th>
<td id="S4.T6.5.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">57.18±0.03</td>
<td id="S4.T6.5.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">120.15</td>
</tr>
<tr id="S4.T6.5.1.3.2" class="ltx_tr">
<th id="S4.T6.5.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">TFL</th>
<td id="S4.T6.5.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r">58.41±0.06</td>
<td id="S4.T6.5.1.3.2.3" class="ltx_td ltx_align_center">437.61</td>
</tr>
<tr id="S4.T6.5.1.4.3" class="ltx_tr">
<th id="S4.T6.5.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r">TFL w/ Clustering</th>
<td id="S4.T6.5.1.4.3.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">57.96±0.18</td>
<td id="S4.T6.5.1.4.3.3" class="ltx_td ltx_align_center ltx_border_bb">133.08</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Ablation Study</h3>

<div id="S4.SS6.p1" class="ltx_para">
<p id="S4.SS6.p1.1" class="ltx_p"><span id="S4.SS6.p1.1.1" class="ltx_text ltx_font_bold">Effects of partial model approximation.</span> To handle high-dimensional models, we can leverage partial model parameters to compute the similarity scores for better computation efficiency. Here, we report the OOF performance when using full and partial model parameters. Experiments are conducted on PACS and results are shown in Table <a href="#S5.T7" title="Table 7 ‣ 5 Related Work ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
<div id="S4.SS6.p2" class="ltx_para">
<p id="S4.SS6.p2.3" class="ltx_p"><span id="S4.SS6.p2.3.1" class="ltx_text ltx_font_bold">Effects of graph sparsity.</span> To avoid learning a fully connected graph with trivial edges, we add a sparsity contain to client topology learning. In implementation, we adopt <math id="S4.SS6.p2.1.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S4.SS6.p2.1.m1.1a"><mi id="S4.SS6.p2.1.m1.1.1" xref="S4.SS6.p2.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.1.m1.1b"><ci id="S4.SS6.p2.1.m1.1.1.cmml" xref="S4.SS6.p2.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.1.m1.1c">\epsilon</annotation></semantics></math>-graph to ensure Equation <a href="#S3.E4" title="Equation 4 ‣ 3.1 Client Topology Learning ‣ 3 Methodology ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> is solvable. The threshold value <math id="S4.SS6.p2.2.m2.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S4.SS6.p2.2.m2.1a"><mi id="S4.SS6.p2.2.m2.1.1" xref="S4.SS6.p2.2.m2.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.2.m2.1b"><ci id="S4.SS6.p2.2.m2.1.1.cmml" xref="S4.SS6.p2.2.m2.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.2.m2.1c">\epsilon</annotation></semantics></math> controls the graph sparsity. Here, we investigate how it will affect the TFL. We report the results on PACS in Table <a href="#S5.T8" title="Table 8 ‣ 5 Related Work ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>. We observe that <math id="S4.SS6.p2.3.m3.1" class="ltx_Math" alttext="\epsilon=0.4" display="inline"><semantics id="S4.SS6.p2.3.m3.1a"><mrow id="S4.SS6.p2.3.m3.1.1" xref="S4.SS6.p2.3.m3.1.1.cmml"><mi id="S4.SS6.p2.3.m3.1.1.2" xref="S4.SS6.p2.3.m3.1.1.2.cmml">ϵ</mi><mo id="S4.SS6.p2.3.m3.1.1.1" xref="S4.SS6.p2.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS6.p2.3.m3.1.1.3" xref="S4.SS6.p2.3.m3.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.3.m3.1b"><apply id="S4.SS6.p2.3.m3.1.1.cmml" xref="S4.SS6.p2.3.m3.1.1"><eq id="S4.SS6.p2.3.m3.1.1.1.cmml" xref="S4.SS6.p2.3.m3.1.1.1"></eq><ci id="S4.SS6.p2.3.m3.1.1.2.cmml" xref="S4.SS6.p2.3.m3.1.1.2">italic-ϵ</ci><cn type="float" id="S4.SS6.p2.3.m3.1.1.3.cmml" xref="S4.SS6.p2.3.m3.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.3.m3.1c">\epsilon=0.4</annotation></semantics></math> yields the best performance.</p>
</div>
<div id="S4.SS6.p3" class="ltx_para">
<p id="S4.SS6.p3.1" class="ltx_p"><span id="S4.SS6.p3.1.1" class="ltx_text ltx_font_bold">Effects of topology update frequency.</span> The frequency of updating client topology during training affects the total training time (<math id="S4.SS6.p3.1.m1.1" class="ltx_Math" alttext="f=5" display="inline"><semantics id="S4.SS6.p3.1.m1.1a"><mrow id="S4.SS6.p3.1.m1.1.1" xref="S4.SS6.p3.1.m1.1.1.cmml"><mi id="S4.SS6.p3.1.m1.1.1.2" xref="S4.SS6.p3.1.m1.1.1.2.cmml">f</mi><mo id="S4.SS6.p3.1.m1.1.1.1" xref="S4.SS6.p3.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS6.p3.1.m1.1.1.3" xref="S4.SS6.p3.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p3.1.m1.1b"><apply id="S4.SS6.p3.1.m1.1.1.cmml" xref="S4.SS6.p3.1.m1.1.1"><eq id="S4.SS6.p3.1.m1.1.1.1.cmml" xref="S4.SS6.p3.1.m1.1.1.1"></eq><ci id="S4.SS6.p3.1.m1.1.1.2.cmml" xref="S4.SS6.p3.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.SS6.p3.1.m1.1.1.3.cmml" xref="S4.SS6.p3.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p3.1.m1.1c">f=5</annotation></semantics></math> denotes updating the topology every 5 rounds). More frequent updates result in extended training times. We investigated the impact of client topology updating frequency on the performance of the model on PACS. Our results in Table <a href="#S5.T8" title="Table 8 ‣ 5 Related Work ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> indicate that model performance remains relatively stable across various updating frequencies. <span id="S4.SS6.p3.1.2" class="ltx_text ltx_font_bold">We provide more ablation studies in Supplementary C</span>.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Related Work</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p"><span id="S5.p1.1.1" class="ltx_text ltx_font_bold">FL generalization to unseen clients.</span> There are recent attempts to address generalization to unseen clients in FL. FedDG <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib26" title="" class="ltx_ref">2021</a>)</cite> is proposed to share the amplitude spectrum of images among local clients to augment the local data distributions. FedADG <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib75" title="" class="ltx_ref">2021</a>)</cite> adopts the federated adversarial training to measure and align the local client distributions to a reference distribution. FedSR <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et al., <a href="#bib.bib39" title="" class="ltx_ref">2022</a>)</cite> proposes regularizing latent representation’s <math id="S5.p1.1.m1.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S5.p1.1.m1.1a"><msub id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S5.p1.1.m1.1.1.2" xref="S5.p1.1.m1.1.1.2.cmml">ℓ</mi><mn id="S5.p1.1.m1.1.1.3" xref="S5.p1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><apply id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p1.1.m1.1.1.1.cmml" xref="S5.p1.1.m1.1.1">subscript</csymbol><ci id="S5.p1.1.m1.1.1.2.cmml" xref="S5.p1.1.m1.1.1.2">ℓ</ci><cn type="integer" id="S5.p1.1.m1.1.1.3.cmml" xref="S5.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">\ell_{2}</annotation></semantics></math> norm and class conditional information to enhance the OOF performance. However, existing methods often ignore scalability issues, yielding inferior performance in large-scale distributed setting <cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a href="#bib.bib1" title="" class="ltx_ref">2023</a>)</cite>. We introduce an approach that employs client topology to achieve good OOF-resilency in a scalable manner.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p"><span id="S5.p2.1.1" class="ltx_text ltx_font_bold">FL with Graphs.</span> One line of research is to combine FL with GNNs, leading to federated GNNs <cite class="ltx_cite ltx_citemacro_citep">(Xie et al., <a href="#bib.bib69" title="" class="ltx_ref">2021</a>; Wu et al., <a href="#bib.bib67" title="" class="ltx_ref">2021</a>)</cite>. These federated GNNs primarily engage in learning from distributed graph data that already has inherent structural information. In contrast, our primary objective is to obtain a distribution graph that captures the relationships between distributed clients. Another research line explores the use of graphs to enhance personalization in FL <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a href="#bib.bib72" title="" class="ltx_ref">2023</a>; Zantedeschi et al., <a href="#bib.bib74" title="" class="ltx_ref">2019</a>)</cite>. For example, pFedGraph <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a href="#bib.bib72" title="" class="ltx_ref">2023</a>)</cite> utilizes a collaboration graph to tailor the global model more effectively to individual clients. These types of research primarily deal with in-federation clients. Different from these methods, our approach aims to utilize a client topology to improve the FL model’s generalizability to clients outside of the federation.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p"><span id="S5.p3.1.1" class="ltx_text ltx_font_bold">Graph topology learning.</span> The problem of graph topology learning has been studied in graph signal processing <cite class="ltx_cite ltx_citemacro_citep">(Stanković et al., <a href="#bib.bib57" title="" class="ltx_ref">2020</a>)</cite> and graph neural networks <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib6" title="" class="ltx_ref">2020a</a>, <a href="#bib.bib7" title="" class="ltx_ref">b</a>)</cite>. Traditional topology learning methods often require centralizing the data, raising privacy concerns. Yet, how to estimate the graph topology with privacy regulations has been less investigated. We explore simple methods to infer the graph topology using model weights. <span id="S5.p3.1.2" class="ltx_text ltx_font_bold">An extended related work section is provided in Supplementary B.</span></p>
</div>
<figure id="S5.T7" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>TFL’s OOF accuracy on PACS using full and partial model parameters. The results show that <span id="S5.T7.2.1" class="ltx_text ltx_font_italic">using partial model parameters achieves performance on par with full parameters</span>.</figcaption>
<div id="S5.T7.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:411.9pt;height:75pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(57.6pt,-10.5pt) scale(1.38855155593091,1.38855155593091) ;">
<table id="S5.T7.3.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T7.3.1.1.1" class="ltx_tr">
<td id="S5.T7.3.1.1.1.1" class="ltx_td ltx_border_tt"></td>
<th id="S5.T7.3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">A</th>
<th id="S5.T7.3.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">C</th>
<th id="S5.T7.3.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">P</th>
<th id="S5.T7.3.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">S</th>
<th id="S5.T7.3.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Avg.</th>
</tr>
<tr id="S5.T7.3.1.2.2" class="ltx_tr">
<td id="S5.T7.3.1.2.2.1" class="ltx_td ltx_align_center ltx_border_t">Full</td>
<td id="S5.T7.3.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">59.05±<span id="S5.T7.3.1.2.2.2.1" class="ltx_text" style="font-size:70%;">0.69</span>
</td>
<td id="S5.T7.3.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">64.46±<span id="S5.T7.3.1.2.2.3.1" class="ltx_text" style="font-size:70%;">0.21</span>
</td>
<td id="S5.T7.3.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">79.35±<span id="S5.T7.3.1.2.2.4.1" class="ltx_text" style="font-size:70%;">0.61</span>
</td>
<td id="S5.T7.3.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t">76.93±<span id="S5.T7.3.1.2.2.5.1" class="ltx_text" style="font-size:70%;">0.39</span>
</td>
<td id="S5.T7.3.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t">69.95</td>
</tr>
<tr id="S5.T7.3.1.3.3" class="ltx_tr">
<td id="S5.T7.3.1.3.3.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">Partial</td>
<td id="S5.T7.3.1.3.3.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">58.96±<span id="S5.T7.3.1.3.3.2.1" class="ltx_text" style="font-size:70%;">0.85</span>
</td>
<td id="S5.T7.3.1.3.3.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">64.57±<span id="S5.T7.3.1.3.3.3.1" class="ltx_text" style="font-size:70%;">0.98</span>
</td>
<td id="S5.T7.3.1.3.3.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">78.94±<span id="S5.T7.3.1.3.3.4.1" class="ltx_text" style="font-size:70%;">0.65</span>
</td>
<td id="S5.T7.3.1.3.3.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">76.61±<span id="S5.T7.3.1.3.3.5.1" class="ltx_text" style="font-size:70%;">0.13</span>
</td>
<td id="S5.T7.3.1.3.3.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">69.77</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S5.T8" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>Ablation study on effects of graph sparsity and client topology update frequency on PACS.</figcaption>
<div id="S5.T8.14" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:325.2pt;height:151.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(46.9pt,-21.9pt) scale(1.40538340306524,1.40538340306524) ;">
<table id="S5.T8.14.14" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T8.2.2.2" class="ltx_tr">
<th id="S5.T8.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="5">Graph Sparsity (<math id="S5.T8.1.1.1.1.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.T8.1.1.1.1.m1.1a"><mi id="S5.T8.1.1.1.1.m1.1.1" xref="S5.T8.1.1.1.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.T8.1.1.1.1.m1.1b"><ci id="S5.T8.1.1.1.1.m1.1.1.cmml" xref="S5.T8.1.1.1.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.1.1.1.1.m1.1c">\epsilon</annotation></semantics></math>), Accuracy <math id="S5.T8.2.2.2.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T8.2.2.2.2.m2.1a"><mo stretchy="false" id="S5.T8.2.2.2.2.m2.1.1" xref="S5.T8.2.2.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T8.2.2.2.2.m2.1b"><ci id="S5.T8.2.2.2.2.m2.1.1.cmml" xref="S5.T8.2.2.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.2.2.2.2.m2.1c">\uparrow</annotation></semantics></math>
</th>
</tr>
<tr id="S5.T8.7.7.7" class="ltx_tr">
<th id="S5.T8.3.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">
<math id="S5.T8.3.3.3.1.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.T8.3.3.3.1.m1.1a"><mi id="S5.T8.3.3.3.1.m1.1.1" xref="S5.T8.3.3.3.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.T8.3.3.3.1.m1.1b"><ci id="S5.T8.3.3.3.1.m1.1.1.cmml" xref="S5.T8.3.3.3.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.3.3.3.1.m1.1c">\epsilon</annotation></semantics></math> = 0.45</th>
<th id="S5.T8.4.4.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">
<math id="S5.T8.4.4.4.2.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.T8.4.4.4.2.m1.1a"><mi id="S5.T8.4.4.4.2.m1.1.1" xref="S5.T8.4.4.4.2.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.T8.4.4.4.2.m1.1b"><ci id="S5.T8.4.4.4.2.m1.1.1.cmml" xref="S5.T8.4.4.4.2.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.4.4.4.2.m1.1c">\epsilon</annotation></semantics></math> = 0.4</th>
<th id="S5.T8.5.5.5.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">
<math id="S5.T8.5.5.5.3.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.T8.5.5.5.3.m1.1a"><mi id="S5.T8.5.5.5.3.m1.1.1" xref="S5.T8.5.5.5.3.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.T8.5.5.5.3.m1.1b"><ci id="S5.T8.5.5.5.3.m1.1.1.cmml" xref="S5.T8.5.5.5.3.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.5.5.5.3.m1.1c">\epsilon</annotation></semantics></math> = 0.38</th>
<th id="S5.T8.6.6.6.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">
<math id="S5.T8.6.6.6.4.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.T8.6.6.6.4.m1.1a"><mi id="S5.T8.6.6.6.4.m1.1.1" xref="S5.T8.6.6.6.4.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.T8.6.6.6.4.m1.1b"><ci id="S5.T8.6.6.6.4.m1.1.1.cmml" xref="S5.T8.6.6.6.4.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.6.6.6.4.m1.1c">\epsilon</annotation></semantics></math> = 0.35</th>
<th id="S5.T8.7.7.7.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">
<math id="S5.T8.7.7.7.5.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.T8.7.7.7.5.m1.1a"><mi id="S5.T8.7.7.7.5.m1.1.1" xref="S5.T8.7.7.7.5.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.T8.7.7.7.5.m1.1b"><ci id="S5.T8.7.7.7.5.m1.1.1.cmml" xref="S5.T8.7.7.7.5.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.7.7.7.5.m1.1c">\epsilon</annotation></semantics></math> = 0.3</th>
</tr>
<tr id="S5.T8.14.14.15.1" class="ltx_tr">
<th id="S5.T8.14.14.15.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">58.61</th>
<th id="S5.T8.14.14.15.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T8.14.14.15.1.2.1" class="ltx_text ltx_font_bold">59.05</span></th>
<th id="S5.T8.14.14.15.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">58.83</th>
<th id="S5.T8.14.14.15.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">58.11</th>
<th id="S5.T8.14.14.15.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">57.73</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T8.9.9.9" class="ltx_tr">
<td id="S5.T8.9.9.9.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="5">Topology update frequency (<math id="S5.T8.8.8.8.1.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S5.T8.8.8.8.1.m1.1a"><mi id="S5.T8.8.8.8.1.m1.1.1" xref="S5.T8.8.8.8.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S5.T8.8.8.8.1.m1.1b"><ci id="S5.T8.8.8.8.1.m1.1.1.cmml" xref="S5.T8.8.8.8.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.8.8.8.1.m1.1c">f</annotation></semantics></math>), Accuracy <math id="S5.T8.9.9.9.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T8.9.9.9.2.m2.1a"><mo stretchy="false" id="S5.T8.9.9.9.2.m2.1.1" xref="S5.T8.9.9.9.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T8.9.9.9.2.m2.1b"><ci id="S5.T8.9.9.9.2.m2.1.1.cmml" xref="S5.T8.9.9.9.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.9.9.9.2.m2.1c">\uparrow</annotation></semantics></math>
</td>
</tr>
<tr id="S5.T8.14.14.14" class="ltx_tr">
<td id="S5.T8.10.10.10.1" class="ltx_td ltx_align_center ltx_border_t">
<math id="S5.T8.10.10.10.1.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S5.T8.10.10.10.1.m1.1a"><mi id="S5.T8.10.10.10.1.m1.1.1" xref="S5.T8.10.10.10.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S5.T8.10.10.10.1.m1.1b"><ci id="S5.T8.10.10.10.1.m1.1.1.cmml" xref="S5.T8.10.10.10.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.10.10.10.1.m1.1c">f</annotation></semantics></math> = 50</td>
<td id="S5.T8.11.11.11.2" class="ltx_td ltx_align_center ltx_border_t">
<math id="S5.T8.11.11.11.2.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S5.T8.11.11.11.2.m1.1a"><mi id="S5.T8.11.11.11.2.m1.1.1" xref="S5.T8.11.11.11.2.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S5.T8.11.11.11.2.m1.1b"><ci id="S5.T8.11.11.11.2.m1.1.1.cmml" xref="S5.T8.11.11.11.2.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.11.11.11.2.m1.1c">f</annotation></semantics></math> = 30</td>
<td id="S5.T8.12.12.12.3" class="ltx_td ltx_align_center ltx_border_t">
<math id="S5.T8.12.12.12.3.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S5.T8.12.12.12.3.m1.1a"><mi id="S5.T8.12.12.12.3.m1.1.1" xref="S5.T8.12.12.12.3.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S5.T8.12.12.12.3.m1.1b"><ci id="S5.T8.12.12.12.3.m1.1.1.cmml" xref="S5.T8.12.12.12.3.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.12.12.12.3.m1.1c">f</annotation></semantics></math> = 20</td>
<td id="S5.T8.13.13.13.4" class="ltx_td ltx_align_center ltx_border_t">
<math id="S5.T8.13.13.13.4.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S5.T8.13.13.13.4.m1.1a"><mi id="S5.T8.13.13.13.4.m1.1.1" xref="S5.T8.13.13.13.4.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S5.T8.13.13.13.4.m1.1b"><ci id="S5.T8.13.13.13.4.m1.1.1.cmml" xref="S5.T8.13.13.13.4.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.13.13.13.4.m1.1c">f</annotation></semantics></math> = 10</td>
<td id="S5.T8.14.14.14.5" class="ltx_td ltx_align_center ltx_border_t">
<math id="S5.T8.14.14.14.5.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S5.T8.14.14.14.5.m1.1a"><mi id="S5.T8.14.14.14.5.m1.1.1" xref="S5.T8.14.14.14.5.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S5.T8.14.14.14.5.m1.1b"><ci id="S5.T8.14.14.14.5.m1.1.1.cmml" xref="S5.T8.14.14.14.5.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.14.14.14.5.m1.1c">f</annotation></semantics></math> = 5</td>
</tr>
<tr id="S5.T8.14.14.16.1" class="ltx_tr">
<td id="S5.T8.14.14.16.1.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S5.T8.14.14.16.1.1.1" class="ltx_text ltx_font_bold">59.19</span></td>
<td id="S5.T8.14.14.16.1.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">58.91</td>
<td id="S5.T8.14.14.16.1.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">58.27</td>
<td id="S5.T8.14.14.16.1.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">58.80</td>
<td id="S5.T8.14.14.16.1.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">58.28</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">Federated Learning faces significant out-of-federation (OOF) generalization challenges that can severely impair model performance. We propose to improve OOF robustness by leveraging client relationships, leading to <span id="S6.p1.1.1" class="ltx_text ltx_font_italic">Topology-aware Federated Learning</span> (TFL). TFL contains two key modules: i) Inferring a topology that describes client relationships with model similarity and ii) Leveraging the learned topology to build a robust model. Extensive experiments on real-world and benchmark datasets show that TFL demonstrates superior OOF-resiliency with scalability.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgment</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This work is supported by the National Science Foundation through the Faculty Early Career Development Program (NSF CAREER) Award, the Department of Defense under the Defense Established Program to Stimulate Competitive Research (DoD DEPSCoR) Award, and the University of Delaware Artificial Intelligence Center of Excellence (AICoE) Seed Grant.</p>
</div>
</section>
<section id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Impact Statement</h2>

<div id="Sx2.p1" class="ltx_para">
<p id="Sx2.p1.1" class="ltx_p"><span id="Sx2.p1.1.1" class="ltx_text ltx_font_bold">Societal impact.</span> Our research has the potential to impact various sectors, notably automated vehicles (AVs), healthcare, and finance, through the enhancement of Federated Learning (FL) models. By improving the robustness of FL models for unseen clients, we anticipate a range of societal benefits. In healthcare, this could manifest as more accurate medical diagnostics, leading to better patient outcomes. In the realm of AVs, enhanced FL models could result in safer navigation and operation, particularly under challenging weather or road conditions. In finance, these advancements could foster better inter-company collaboration, leading to more efficient and secure financial services.</p>
</div>
<div id="Sx2.p2" class="ltx_para">
<p id="Sx2.p2.1" class="ltx_p"><span id="Sx2.p2.1.1" class="ltx_text ltx_font_bold">Ethical considerations.</span> While we initially did not identify the potential for our research to lead to unintended biases or discrimination, we recognize the complexity and evolving nature of ethical challenges in Machine Learning. It is important to continuously evaluate our models and methodologies for any inadvertent biases, especially as they are applied in diverse, real-world scenarios. We commit to rigorously testing our models to identify and mitigate any such biases, ensuring that our research contributes positively and equitably across all sections of society.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2023)</span>
<span class="ltx_bibblock">
Bai, R., Bagchi, S., and Inouye, D. I.

</span>
<span class="ltx_bibblock">Benchmarking algorithms for domain generalization in federated learning, 2023.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=IsCg7qoy8i9" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=IsCg7qoy8i9</a>.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bavelas (1950)</span>
<span class="ltx_bibblock">
Bavelas, A.

</span>
<span class="ltx_bibblock">Communication patterns in task-oriented groups.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">The journal of the acoustical society of America</em>, 22(6):725–730, 1950.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhowmick et al. (2018)</span>
<span class="ltx_bibblock">
Bhowmick, A., Duchi, J., Freudiger, J., Kapoor, G., and Rogers, R.

</span>
<span class="ltx_bibblock">Protection against reconstruction and its applications in private federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1812.00984</em>, 2018.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/1812.00984" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/1812.00984</a>.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Boyd et al. (2004)</span>
<span class="ltx_bibblock">
Boyd, S., Boyd, S. P., and Vandenberghe, L.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Convex optimization</em>.

</span>
<span class="ltx_bibblock">Cambridge university press, 2004.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2019)</span>
<span class="ltx_bibblock">
Chen, Y., Wu, L., and Zaki, M. J.

</span>
<span class="ltx_bibblock">Graphflow: Exploiting conversation flow with graph neural networks for conversational machine comprehension.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1908.00059</em>, 2019.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2020a)</span>
<span class="ltx_bibblock">
Chen, Y., Wu, L., and Zaki, M.

</span>
<span class="ltx_bibblock">Iterative deep graph learning for graph neural networks: Better and robust node embeddings.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 33:19314–19326, 2020a.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2020b)</span>
<span class="ltx_bibblock">
Chen, Y., Wu, L., and Zaki, M. J.

</span>
<span class="ltx_bibblock">Reinforcement learning based graph-to-sequence model for natural question generation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2020b.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=HygnDhEtvr" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=HygnDhEtvr</a>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. (2020)</span>
<span class="ltx_bibblock">
Deng, Y., Kamani, M. M., and Mahdavi, M.

</span>
<span class="ltx_bibblock">Distributionally robust federated averaging.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, volume 33, pp.  15111–15122, 2020.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/2102.12660" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2102.12660</a>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong et al. (2019)</span>
<span class="ltx_bibblock">
Dong, X., Thanou, D., Rabbat, M., and Frossard, P.

</span>
<span class="ltx_bibblock">Learning graphs from data: A signal representation perspective.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing Magazine</em>, 36(3):44–63, 2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://ieeexplore.ieee.org/document/8700665" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://ieeexplore.ieee.org/document/8700665</a>.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy et al. (2021)</span>
<span class="ltx_bibblock">
Dosovitskiy, A., Beyer, L., Kolesnikov, A., Weissenborn, D., Zhai, X., Unterthiner, T., Dehghani, M., Minderer, M., Heigold, G., Gelly, S., Uszkoreit, J., and Houlsby, N.

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at scale.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=YicbFdNTTy" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=YicbFdNTTy</a>.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Franceschi et al. (2019)</span>
<span class="ltx_bibblock">
Franceschi, L., Niepert, M., Pontil, M., and He, X.

</span>
<span class="ltx_bibblock">Learning discrete structures for graph neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, pp.  1972–1982. PMLR, 2019.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Freeman et al. (2002)</span>
<span class="ltx_bibblock">
Freeman, L. C. et al.

</span>
<span class="ltx_bibblock">Centrality in social networks: Conceptual clarification.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Social network: critical concepts in sociology. Londres: Routledge</em>, 1:238–263, 2002.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2016)</span>
<span class="ltx_bibblock">
He, K., Zhang, X., Ren, S., and Sun, J.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pp.  770–778, 2016.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu et al. (2019)</span>
<span class="ltx_bibblock">
Hsu, T.-M. H., Qi, H., and Brown, M.

</span>
<span class="ltx_bibblock">Measuring the effects of non-identical data distribution for federated visual classification.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1909.06335</em>, 2019.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2018)</span>
<span class="ltx_bibblock">
Hu, W., Niu, G., Sato, I., and Sugiyama, M.

</span>
<span class="ltx_bibblock">Does distributionally robust supervised learning give robust classifiers?

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.  2029–2037. PMLR, 2018.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2019)</span>
<span class="ltx_bibblock">
Huang, L., Shea, A. L., Qian, H., Masurkar, A., Deng, H., and Liu, D.

</span>
<span class="ltx_bibblock">Patient clustering improves efficiency of federated machine learning to predict mortality and hospital stay time using distributed electronic medical records.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Journal of biomedical informatics</em>, 99:103291, 2019.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2021)</span>
<span class="ltx_bibblock">
Kairouz, P., McMahan, H. B., Avent, B., Bellet, A., Bennis, M., Bhagoji, A. N., Bonawitz, K., Charles, Z., Cormode, G., Cummings, R., et al.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Foundations and Trends® in Machine Learning</em>, 14(1–2):1–210, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://www.nowpublishers.com/article/Details/MAL-083" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.nowpublishers.com/article/Details/MAL-083</a>.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. (2020)</span>
<span class="ltx_bibblock">
Karimireddy, S. P., Kale, S., Mohri, M., Reddi, S., Stich, S., and Suresh, A. T.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.  5132–5143. PMLR, 2020.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky &amp; Hinton (2009)</span>
<span class="ltx_bibblock">
Krizhevsky, A. and Hinton, G.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock">Technical Report 0, University of Toronto, Toronto, Ontario, 2009.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2017)</span>
<span class="ltx_bibblock">
Li, D., Yang, Y., Song, Y.-Z., and Hospedales, T. M.

</span>
<span class="ltx_bibblock">Deeper, broader and artier domain generalization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE international conference on computer vision</em>, pp.  5542–5550, 2017.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2018)</span>
<span class="ltx_bibblock">
Li, R., Wang, S., Zhu, F., and Huang, J.

</span>
<span class="ltx_bibblock">Adaptive graph convolutional neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI conference on artificial intelligence</em>, volume 32, 2018.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://ojs.aaai.org/index.php/AAAI/article/view/11691" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://ojs.aaai.org/index.php/AAAI/article/view/11691</a>.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020a)</span>
<span class="ltx_bibblock">
Li, T., Sahu, A. K., Talwalkar, A., and Smith, V.

</span>
<span class="ltx_bibblock">Federated learning: Challenges, methods, and future directions.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing Magazine</em>, 37(3):50–60, 2020a.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://ieeexplore.ieee.org/abstract/document/9084352" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://ieeexplore.ieee.org/abstract/document/9084352</a>.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020b)</span>
<span class="ltx_bibblock">
Li, T., Sahu, A. K., Zaheer, M., Sanjabi, M., Talwalkar, A., and Smith, V.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems</em>, volume 2, pp.  429–450, 2020b.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/1812.06127" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/1812.06127</a>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023)</span>
<span class="ltx_bibblock">
Li, T., Qiao, F., Ma, M., and Peng, X.

</span>
<span class="ltx_bibblock">Are data-driven explanations robust against out-of-distribution data?

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  3821–3831, 2023.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020c)</span>
<span class="ltx_bibblock">
Li, X., Huang, K., Yang, W., Wang, S., and Zhang, Z.

</span>
<span class="ltx_bibblock">On the convergence of fedavg on non-iid data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2020c.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=HJxNAnVtDS" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=HJxNAnVtDS</a>.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2021)</span>
<span class="ltx_bibblock">
Liu, Q., Chen, C., Qin, J., Dou, Q., and Heng, P.-A.

</span>
<span class="ltx_bibblock">Feddg: Federated domain generalization on medical image segmentation via episodic learning in continuous frequency space.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  1013–1023, 2021.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lloyd (1982)</span>
<span class="ltx_bibblock">
Lloyd, S.

</span>
<span class="ltx_bibblock">Least squares quantization in pcm.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on information theory</em>, 28(2):129–137, 1982.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lü &amp; Zhou (2011)</span>
<span class="ltx_bibblock">
Lü, L. and Zhou, T.

</span>
<span class="ltx_bibblock">Link prediction in complex networks: A survey.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Physica A: statistical mechanics and its applications</em>, 390(6):1150–1170, 2011.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. (2021)</span>
<span class="ltx_bibblock">
Ma, M., Ren, J., Zhao, L., Tulyakov, S., Wu, C., and Peng, X.

</span>
<span class="ltx_bibblock">SMIL: Multimodal Learning with Severely Missing Modality.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em>, volume 35, pp.  2302–2310, 2021.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. (2022)</span>
<span class="ltx_bibblock">
Ma, M., Ren, J., Zhao, L., Testuggine, D., and Peng, X.

</span>
<span class="ltx_bibblock">Are Multimodal Transformers Robust to Missing Modality?

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  18177–18186, 2022.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mateos et al. (2019)</span>
<span class="ltx_bibblock">
Mateos, G., Segarra, S., Marques, A. G., and Ribeiro, A.

</span>
<span class="ltx_bibblock">Connecting the dots: Identifying network structure via graph signal processing.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing Magazine</em>, 36(3):16–43, 2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://ieeexplore.ieee.org/document/8700659?arnumber=8700659" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://ieeexplore.ieee.org/document/8700659?arnumber=8700659</a>.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., and y Arcas, B. A.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>, pp.  1273–1282. PMLR, 2017.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v54/mcmahan17a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v54/mcmahan17a.html</a>.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Melis et al. (2019)</span>
<span class="ltx_bibblock">
Melis, L., Song, C., De Cristofaro, E., and Shmatikov, V.

</span>
<span class="ltx_bibblock">Exploiting unintended feature leakage in collaborative learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">2019 IEEE symposium on security and privacy (SP)</em>, pp.  691–706. IEEE, 2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://ieeexplore.ieee.org/document/8835269" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://ieeexplore.ieee.org/document/8835269</a>.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mendieta et al. (2022)</span>
<span class="ltx_bibblock">
Mendieta, M., Yang, T., Wang, P., Lee, M., Ding, Z., and Chen, C.

</span>
<span class="ltx_bibblock">Local learning matters: Rethinking data heterogeneity in federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  8397–8406, 2022.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mohri et al. (2019)</span>
<span class="ltx_bibblock">
Mohri, M., Sivek, G., and Suresh, A. T.

</span>
<span class="ltx_bibblock">Agnostic federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.  4615–4625. PMLR, 2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v97/mohri19a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v97/mohri19a.html</a>.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Newman (2018)</span>
<span class="ltx_bibblock">
Newman, M.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Networks</em>.

</span>
<span class="ltx_bibblock">Oxford university press, 2018.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Newman (2005)</span>
<span class="ltx_bibblock">
Newman, M. E.

</span>
<span class="ltx_bibblock">A measure of betweenness centrality based on random walks.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Social networks</em>, 27(1):39–54, 2005.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nguyen et al. (2021)</span>
<span class="ltx_bibblock">
Nguyen, A. T., Tran, T., Gal, Y., and Baydin, A. G.

</span>
<span class="ltx_bibblock">Domain invariant representation learning with domain density transformations.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 34:5264–5275, 2021.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nguyen et al. (2022)</span>
<span class="ltx_bibblock">
Nguyen, A. T., Torr, P., and Lim, S.-N.

</span>
<span class="ltx_bibblock">Fedsr: A simple and effective domain generalization method for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/pdf?id=mrt90D00aQX" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/pdf?id=mrt90D00aQX</a>.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Norcliffe-Brown et al. (2018)</span>
<span class="ltx_bibblock">
Norcliffe-Brown, W., Vafeias, S., and Parisot, S.

</span>
<span class="ltx_bibblock">Learning conditioned graph structures for interpretable visual question answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 31, 2018.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pati et al. (2022a)</span>
<span class="ltx_bibblock">
Pati, S., Baid, U., Edwards, B., Sheller, M., Wang, S.-H., Reina, G. A., Foley, P., Gruzdev, A., Karkada, D., Davatzikos, C., et al.

</span>
<span class="ltx_bibblock">Federated learning enables big data for rare cancer boundary detection.

</span>
<span class="ltx_bibblock"><em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">Nature communications</em>, 13(1):7346, 2022a.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pati et al. (2022b)</span>
<span class="ltx_bibblock">
Pati, S., Baid, U., Edwards, B., Sheller, M. J., Foley, P., Reina, G. A., Thakur, S., Sako, C., Bilello, M., Davatzikos, C., et al.

</span>
<span class="ltx_bibblock">The federated tumor segmentation (fets) tool: an open-source solution to further solid tumor research.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">Physics in Medicine &amp; Biology</em>, 67(20):204002, 2022b.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pollard et al. (2018)</span>
<span class="ltx_bibblock">
Pollard, T. J., Johnson, A. E., Raffa, J. D., Celi, L. A., Mark, R. G., and Badawi, O.

</span>
<span class="ltx_bibblock">The eicu collaborative research database, a freely available multi-center database for critical care research.

</span>
<span class="ltx_bibblock"><em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Scientific data</em>, 5(1):1–13, 2018.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qiao &amp; Peng (2023)</span>
<span class="ltx_bibblock">
Qiao, F. and Peng, X.

</span>
<span class="ltx_bibblock">Topology-aware robust optimization for out-of-distribution generalization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">Proceedings of the International Conference on Learning Representations (ICLR)</em>, 2023.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reisizadeh et al. (2020)</span>
<span class="ltx_bibblock">
Reisizadeh, A., Farnia, F., Pedarsani, R., and Jadbabaie, A.

</span>
<span class="ltx_bibblock">Robust federated learning: The case of affine distribution shifts.

</span>
<span class="ltx_bibblock">In <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, volume 33, pp.  21554–21565, 2020.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/2006.08907" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2006.08907</a>.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rieke et al. (2020)</span>
<span class="ltx_bibblock">
Rieke, N., Hancox, J., Li, W., Milletari, F., Roth, H. R., Albarqouni, S., Bakas, S., Galtier, M. N., Landman, B. A., Maier-Hein, K., et al.

</span>
<span class="ltx_bibblock">The future of digital health with federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">NPJ digital medicine</em>, 3(1):1–7, 2020.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://www.nature.com/articles/s41746-020-00323-1" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.nature.com/articles/s41746-020-00323-1</a>.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Robey et al. (2021)</span>
<span class="ltx_bibblock">
Robey, A., Pappas, G. J., and Hassani, H.

</span>
<span class="ltx_bibblock">Model-based domain generalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 34:20210–20229, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=JOxB9h40A-1" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=JOxB9h40A-1</a>.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ronneberger et al. (2015)</span>
<span class="ltx_bibblock">
Ronneberger, O., Fischer, P., and Brox, T.

</span>
<span class="ltx_bibblock">U-net: Convolutional networks for biomedical image segmentation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">Medical Image Computing and Computer-Assisted Intervention–MICCAI 2015: 18th International Conference, Munich, Germany, October 5-9, 2015, Proceedings, Part III 18</em>, pp.  234–241. Springer, 2015.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sattler et al. (2019)</span>
<span class="ltx_bibblock">
Sattler, F., Wiedemann, S., Müller, K.-R., and Samek, W.

</span>
<span class="ltx_bibblock">Robust and communication-efficient federated learning from non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on neural networks and learning systems</em>, 31(9):3400–3413, 2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://ieeexplore.ieee.org/document/8889996" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://ieeexplore.ieee.org/document/8889996</a>.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sattler et al. (2020)</span>
<span class="ltx_bibblock">
Sattler, F., Müller, K.-R., and Samek, W.

</span>
<span class="ltx_bibblock">Clustered federated learning: Model-agnostic distributed multitask optimization under privacy constraints.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on neural networks and learning systems</em>, 32(8):3710–3722, 2020.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://ieeexplore.ieee.org/document/9174890" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://ieeexplore.ieee.org/document/9174890</a>.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Saxena &amp; Iyengar (2020)</span>
<span class="ltx_bibblock">
Saxena, A. and Iyengar, S.

</span>
<span class="ltx_bibblock">Centrality measures in complex networks: A survey.

</span>
<span class="ltx_bibblock"><em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2011.07190</em>, 2020.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shamsian et al. (2021)</span>
<span class="ltx_bibblock">
Shamsian, A., Navon, A., Fetaya, E., and Chechik, G.

</span>
<span class="ltx_bibblock">Personalized federated learning using hypernetworks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.  9489–9502. PMLR, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://proceedings.mlr.press/v139/shamsian21a/shamsian21a.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://proceedings.mlr.press/v139/shamsian21a/shamsian21a.pdf</a>.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sheikhalishahi et al. (2020)</span>
<span class="ltx_bibblock">
Sheikhalishahi, S., Balaraman, V., and Osmani, V.

</span>
<span class="ltx_bibblock">Benchmarking machine learning models on multi-centre eicu critical care dataset.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">Plos one</em>, 15(7):e0235424, 2020.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sheller et al. (2020)</span>
<span class="ltx_bibblock">
Sheller, M. J., Edwards, B., Reina, G. A., Martin, J., Pati, S., Kotrotsou, A., Milchenko, M., Xu, W., Marcus, D., Colen, R. R., et al.

</span>
<span class="ltx_bibblock">Federated learning in medicine: facilitating multi-institutional collaborations without sharing patient data.

</span>
<span class="ltx_bibblock"><em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">Scientific reports</em>, 10(1):1–12, 2020.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smith et al. (2017)</span>
<span class="ltx_bibblock">
Smith, V., Chiang, C.-K., Sanjabi, M., and Talwalkar, A. S.

</span>
<span class="ltx_bibblock">Federated multi-task learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Staib &amp; Jegelka (2019)</span>
<span class="ltx_bibblock">
Staib, M. and Jegelka, S.

</span>
<span class="ltx_bibblock">Distributionally robust optimization and generalization in kernel methods.

</span>
<span class="ltx_bibblock"><em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 32, 2019.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stanković et al. (2020)</span>
<span class="ltx_bibblock">
Stanković, L., Mandic, D., Daković, M., Brajović, M., Scalzo, B., Li, S., Constantinides, A. G., et al.

</span>
<span class="ltx_bibblock">Data analytics on graphs part iii: machine learning on graphs, from graph topology to applications.

</span>
<span class="ltx_bibblock"><em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">Foundations and Trends® in Machine Learning</em>, 13(4):332–530, 2020.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun &amp; Saenko (2016)</span>
<span class="ltx_bibblock">
Sun, B. and Saenko, K.

</span>
<span class="ltx_bibblock">Deep coral: Correlation alignment for deep domain adaptation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">Computer Vision–ECCV 2016 Workshops: Amsterdam, The Netherlands, October 8-10 and 15-16, 2016, Proceedings, Part III 14</em>, pp.  443–450. Springer, 2016.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al. (2022)</span>
<span class="ltx_bibblock">
Tan, Y., Long, G., Liu, L., Zhou, T., Lu, Q., Jiang, J., and Zhang, C.

</span>
<span class="ltx_bibblock">FedProto: Federated Prototype Learning Across Heterogeneous Clients.

</span>
<span class="ltx_bibblock">In <em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em>, pp.  8432–8440, 2022.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tenison et al. (2022)</span>
<span class="ltx_bibblock">
Tenison, I., Sreeramadas, S. A., Mugunthan, V., Oyallon, E., Belilovsky, E., and Rish, I.

</span>
<span class="ltx_bibblock">Gradient masked averaging for federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2201.11986</em>, 2022.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vanhaesebrouck et al. (2017)</span>
<span class="ltx_bibblock">
Vanhaesebrouck, P., Bellet, A., and Tommasi, M.

</span>
<span class="ltx_bibblock">Decentralized collaborative learning of personalized models over networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">Artificial Intelligence and Statistics</em>, pp.  509–517. PMLR, 2017.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A. N., Kaiser, Ł., and Polosukhin, I.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 30, 2017.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/1706.03762" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/1706.03762</a>.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Venkateswara et al. (2017)</span>
<span class="ltx_bibblock">
Venkateswara, H., Eusebio, J., Chakraborty, S., and Panchanathan, S.

</span>
<span class="ltx_bibblock">Deep hashing network for unsupervised domain adaptation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib63.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pp.  5018–5027, 2017.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vose et al. (2014)</span>
<span class="ltx_bibblock">
Vose, R., Applequist, S., Squires, M., Durre, I., Menne, M., Williams Jr, C., Fenimore, C., Gleason, K., and Arndt, D.

</span>
<span class="ltx_bibblock">Gridded 5km GHCN-Daily Temperature and Precipitation Dataset (nCLIMGRID) Version 1.

</span>
<span class="ltx_bibblock"><em id="bib.bib64.1.1" class="ltx_emph ltx_font_italic">Maximum Temperature, Minimum Temperature, Average Temperature, and Precipitation</em>, 2014.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Welling &amp; Kipf (2016)</span>
<span class="ltx_bibblock">
Welling, M. and Kipf, T. N.

</span>
<span class="ltx_bibblock">Semi-supervised classification with graph convolutional networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib65.1.1" class="ltx_emph ltx_font_italic">J. International Conference on Learning Representations (ICLR 2017)</em>, 2016.

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">White &amp; Borgatti (1994)</span>
<span class="ltx_bibblock">
White, D. R. and Borgatti, S. P.

</span>
<span class="ltx_bibblock">Betweenness centrality measures for directed graphs.

</span>
<span class="ltx_bibblock"><em id="bib.bib66.1.1" class="ltx_emph ltx_font_italic">Social networks</em>, 16(4):335–346, 1994.

</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2021)</span>
<span class="ltx_bibblock">
Wu, C., Wu, F., Cao, Y., Huang, Y., and Xie, X.

</span>
<span class="ltx_bibblock">Fedgnn: Federated graph neural network for privacy-preserving recommendation.

</span>
<span class="ltx_bibblock"><em id="bib.bib67.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2102.04925</em>, 2021.

</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2020)</span>
<span class="ltx_bibblock">
Wu, Z., Pan, S., Chen, F., Long, G., Zhang, C., and Philip, S. Y.

</span>
<span class="ltx_bibblock">A comprehensive survey on graph neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib68.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on neural networks and learning systems</em>, 32(1):4–24, 2020.

</span>
</li>
<li id="bib.bib69" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al. (2021)</span>
<span class="ltx_bibblock">
Xie, H., Ma, J., Xiong, L., and Yang, C.

</span>
<span class="ltx_bibblock">Federated graph classification over non-iid graphs.

</span>
<span class="ltx_bibblock"><em id="bib.bib69.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 34:18839–18852, 2021.

</span>
</li>
<li id="bib.bib70" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2020)</span>
<span class="ltx_bibblock">
Xu, M., Zhang, J., Ni, B., Li, T., Wang, C., Tian, Q., and Zhang, W.

</span>
<span class="ltx_bibblock">Adversarial domain adaptation with domain mixup.

</span>
<span class="ltx_bibblock">In <em id="bib.bib70.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI conference on artificial intelligence</em>, volume 34, pp.  6502–6509, 2020.

</span>
</li>
<li id="bib.bib71" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2022)</span>
<span class="ltx_bibblock">
Xu, Z., He, H., Lee, G.-H., Wang, B., and Wang, H.

</span>
<span class="ltx_bibblock">Graph-relational domain adaptation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib71.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=kcwyXtt7yDJ" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=kcwyXtt7yDJ</a>.

</span>
</li>
<li id="bib.bib72" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye et al. (2023)</span>
<span class="ltx_bibblock">
Ye, R., Ni, Z., Wu, F., Chen, S., and Wang, Y.

</span>
<span class="ltx_bibblock">Personalized federated learning with inferred collaboration graphs.

</span>
<span class="ltx_bibblock">In <em id="bib.bib72.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.  39801–39817. PMLR, 2023.

</span>
</li>
<li id="bib.bib73" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2022)</span>
<span class="ltx_bibblock">
Yu, Y., Yang, Z., Wei, A., Ma, Y., and Steinhardt, J.

</span>
<span class="ltx_bibblock">Predicting out-of-distribution error with the projection norm.

</span>
<span class="ltx_bibblock">In <em id="bib.bib73.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.  25721–25746. PMLR, 2022.

</span>
</li>
<li id="bib.bib74" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zantedeschi et al. (2019)</span>
<span class="ltx_bibblock">
Zantedeschi, V., Bellet, A., and Tommasi, M.

</span>
<span class="ltx_bibblock">Fully decentralized joint learning of personalized models and collaboration graphs.

</span>
<span class="ltx_bibblock"><em id="bib.bib74.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1901.08460</em>, 2019.

</span>
</li>
<li id="bib.bib75" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2021)</span>
<span class="ltx_bibblock">
Zhang, L., Lei, X., Shi, Y., Huang, H., and Chen, C.

</span>
<span class="ltx_bibblock">Federated learning with domain generalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib75.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2111.10487</em>, 2021.

</span>
</li>
<li id="bib.bib76" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2020)</span>
<span class="ltx_bibblock">
Zhao, S., Gong, M., Liu, T., Fu, H., and Tao, D.

</span>
<span class="ltx_bibblock">Domain generalization via entropy regularization.

</span>
<span class="ltx_bibblock"><em id="bib.bib76.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33:16096–16107, 2020.

</span>
</li>
<li id="bib.bib77" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2023)</span>
<span class="ltx_bibblock">
Zhou, Z., Azam, S. S., Brinton, C., and Inouye, D. I.

</span>
<span class="ltx_bibblock">Efficient federated domain translation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib77.1.1" class="ltx_emph ltx_font_italic">The Eleventh International Conference on Learning Representations</em>, 2023.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=uhLAcrAZ9cJ" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=uhLAcrAZ9cJ</a>.

</span>
</li>
<li id="bib.bib78" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2021)</span>
<span class="ltx_bibblock">
Zhu, Y., Xu, W., Zhang, J., Du, Y., Zhang, J., Liu, Q., Yang, C., and Wu, S.

</span>
<span class="ltx_bibblock">A survey on graph structure learning: Progress and opportunities.

</span>
<span class="ltx_bibblock"><em id="bib.bib78.1.1" class="ltx_emph ltx_font_italic">arXiv e-prints</em>, pp.  arXiv–2103, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/pdf/2103.03036.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/pdf/2103.03036.pdf</a>.

</span>
</li>
<li id="bib.bib79" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhuang et al. (2023)</span>
<span class="ltx_bibblock">
Zhuang, W., Chen, C., and Lyu, L.

</span>
<span class="ltx_bibblock">When foundation model meets federated learning: Motivations, challenges, and future directions.

</span>
<span class="ltx_bibblock"><em id="bib.bib79.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.15546</em>, 2023.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Additional Experimental Results &amp; Detailed Dataset Description</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Evaluating OOF-resiliency on OfficeHome</h3>

<div id="A1.SS1.p1" class="ltx_para">
<p id="A1.SS1.p1.13" class="ltx_p">We conduct additional experiments on <span id="A1.SS1.p1.13.1" class="ltx_text ltx_font_bold">OfficeHome</span> <cite class="ltx_cite ltx_citemacro_citep">(Venkateswara et al., <a href="#bib.bib63" title="" class="ltx_ref">2017</a>)</cite> dataset. It contains <math id="A1.SS1.p1.1.m1.2" class="ltx_Math" alttext="15,588" display="inline"><semantics id="A1.SS1.p1.1.m1.2a"><mrow id="A1.SS1.p1.1.m1.2.3.2" xref="A1.SS1.p1.1.m1.2.3.1.cmml"><mn id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml">15</mn><mo id="A1.SS1.p1.1.m1.2.3.2.1" xref="A1.SS1.p1.1.m1.2.3.1.cmml">,</mo><mn id="A1.SS1.p1.1.m1.2.2" xref="A1.SS1.p1.1.m1.2.2.cmml">588</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.2b"><list id="A1.SS1.p1.1.m1.2.3.1.cmml" xref="A1.SS1.p1.1.m1.2.3.2"><cn type="integer" id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1">15</cn><cn type="integer" id="A1.SS1.p1.1.m1.2.2.cmml" xref="A1.SS1.p1.1.m1.2.2">588</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.2c">15,588</annotation></semantics></math> images from four domains: art, clipart, product, and real world. The task is a <math id="A1.SS1.p1.2.m2.1" class="ltx_Math" alttext="65" display="inline"><semantics id="A1.SS1.p1.2.m2.1a"><mn id="A1.SS1.p1.2.m2.1.1" xref="A1.SS1.p1.2.m2.1.1.cmml">65</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.m2.1b"><cn type="integer" id="A1.SS1.p1.2.m2.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1">65</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">65</annotation></semantics></math>-class classification problem. Like PACS’s experimental setup, we evenly split each domain into <math id="A1.SS1.p1.3.m3.1" class="ltx_Math" alttext="5" display="inline"><semantics id="A1.SS1.p1.3.m3.1a"><mn id="A1.SS1.p1.3.m3.1.1" xref="A1.SS1.p1.3.m3.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.m3.1b"><cn type="integer" id="A1.SS1.p1.3.m3.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.m3.1c">5</annotation></semantics></math> subsets, yielding <math id="A1.SS1.p1.4.m4.1" class="ltx_Math" alttext="20" display="inline"><semantics id="A1.SS1.p1.4.m4.1a"><mn id="A1.SS1.p1.4.m4.1.1" xref="A1.SS1.p1.4.m4.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.4.m4.1b"><cn type="integer" id="A1.SS1.p1.4.m4.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.4.m4.1c">20</annotation></semantics></math> subsets, and treat each subset as a client. We followed the common <span id="A1.SS1.p1.13.2" class="ltx_text ltx_font_italic">leave-one-domain-out</span> experiment, where <math id="A1.SS1.p1.5.m5.1" class="ltx_Math" alttext="3" display="inline"><semantics id="A1.SS1.p1.5.m5.1a"><mn id="A1.SS1.p1.5.m5.1.1" xref="A1.SS1.p1.5.m5.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.5.m5.1b"><cn type="integer" id="A1.SS1.p1.5.m5.1.1.cmml" xref="A1.SS1.p1.5.m5.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.5.m5.1c">3</annotation></semantics></math> domains are used (<math id="A1.SS1.p1.6.m6.1" class="ltx_Math" alttext="15" display="inline"><semantics id="A1.SS1.p1.6.m6.1a"><mn id="A1.SS1.p1.6.m6.1.1" xref="A1.SS1.p1.6.m6.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.6.m6.1b"><cn type="integer" id="A1.SS1.p1.6.m6.1.1.cmml" xref="A1.SS1.p1.6.m6.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.6.m6.1c">15</annotation></semantics></math> clients) for training and <math id="A1.SS1.p1.7.m7.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A1.SS1.p1.7.m7.1a"><mn id="A1.SS1.p1.7.m7.1.1" xref="A1.SS1.p1.7.m7.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.7.m7.1b"><cn type="integer" id="A1.SS1.p1.7.m7.1.1.cmml" xref="A1.SS1.p1.7.m7.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.7.m7.1c">1</annotation></semantics></math> domain (<math id="A1.SS1.p1.8.m8.1" class="ltx_Math" alttext="5" display="inline"><semantics id="A1.SS1.p1.8.m8.1a"><mn id="A1.SS1.p1.8.m8.1.1" xref="A1.SS1.p1.8.m8.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.8.m8.1b"><cn type="integer" id="A1.SS1.p1.8.m8.1.1.cmml" xref="A1.SS1.p1.8.m8.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.8.m8.1c">5</annotation></semantics></math> clients) for testing. We use ResNet50 <cite class="ltx_cite ltx_citemacro_citep">(He et al., <a href="#bib.bib13" title="" class="ltx_ref">2016</a>)</cite> as our model and train the model for <math id="A1.SS1.p1.9.m9.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A1.SS1.p1.9.m9.1a"><mn id="A1.SS1.p1.9.m9.1.1" xref="A1.SS1.p1.9.m9.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.9.m9.1b"><cn type="integer" id="A1.SS1.p1.9.m9.1.1.cmml" xref="A1.SS1.p1.9.m9.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.9.m9.1c">100</annotation></semantics></math> communication rounds. Each local client optimized the model using stochastic gradient descent (SGD) with a learning rate of <math id="A1.SS1.p1.10.m10.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="A1.SS1.p1.10.m10.1a"><mn id="A1.SS1.p1.10.m10.1.1" xref="A1.SS1.p1.10.m10.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.10.m10.1b"><cn type="float" id="A1.SS1.p1.10.m10.1.1.cmml" xref="A1.SS1.p1.10.m10.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.10.m10.1c">0.01</annotation></semantics></math>, a momentum of <math id="A1.SS1.p1.11.m11.1" class="ltx_Math" alttext="0.9" display="inline"><semantics id="A1.SS1.p1.11.m11.1a"><mn id="A1.SS1.p1.11.m11.1.1" xref="A1.SS1.p1.11.m11.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.11.m11.1b"><cn type="float" id="A1.SS1.p1.11.m11.1.1.cmml" xref="A1.SS1.p1.11.m11.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.11.m11.1c">0.9</annotation></semantics></math>, weight decay of <math id="A1.SS1.p1.12.m12.1" class="ltx_Math" alttext="5e^{-4}" display="inline"><semantics id="A1.SS1.p1.12.m12.1a"><mrow id="A1.SS1.p1.12.m12.1.1" xref="A1.SS1.p1.12.m12.1.1.cmml"><mn id="A1.SS1.p1.12.m12.1.1.2" xref="A1.SS1.p1.12.m12.1.1.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="A1.SS1.p1.12.m12.1.1.1" xref="A1.SS1.p1.12.m12.1.1.1.cmml">​</mo><msup id="A1.SS1.p1.12.m12.1.1.3" xref="A1.SS1.p1.12.m12.1.1.3.cmml"><mi id="A1.SS1.p1.12.m12.1.1.3.2" xref="A1.SS1.p1.12.m12.1.1.3.2.cmml">e</mi><mrow id="A1.SS1.p1.12.m12.1.1.3.3" xref="A1.SS1.p1.12.m12.1.1.3.3.cmml"><mo id="A1.SS1.p1.12.m12.1.1.3.3a" xref="A1.SS1.p1.12.m12.1.1.3.3.cmml">−</mo><mn id="A1.SS1.p1.12.m12.1.1.3.3.2" xref="A1.SS1.p1.12.m12.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.12.m12.1b"><apply id="A1.SS1.p1.12.m12.1.1.cmml" xref="A1.SS1.p1.12.m12.1.1"><times id="A1.SS1.p1.12.m12.1.1.1.cmml" xref="A1.SS1.p1.12.m12.1.1.1"></times><cn type="integer" id="A1.SS1.p1.12.m12.1.1.2.cmml" xref="A1.SS1.p1.12.m12.1.1.2">5</cn><apply id="A1.SS1.p1.12.m12.1.1.3.cmml" xref="A1.SS1.p1.12.m12.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p1.12.m12.1.1.3.1.cmml" xref="A1.SS1.p1.12.m12.1.1.3">superscript</csymbol><ci id="A1.SS1.p1.12.m12.1.1.3.2.cmml" xref="A1.SS1.p1.12.m12.1.1.3.2">𝑒</ci><apply id="A1.SS1.p1.12.m12.1.1.3.3.cmml" xref="A1.SS1.p1.12.m12.1.1.3.3"><minus id="A1.SS1.p1.12.m12.1.1.3.3.1.cmml" xref="A1.SS1.p1.12.m12.1.1.3.3"></minus><cn type="integer" id="A1.SS1.p1.12.m12.1.1.3.3.2.cmml" xref="A1.SS1.p1.12.m12.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.12.m12.1c">5e^{-4}</annotation></semantics></math>, and a batch size of <math id="A1.SS1.p1.13.m13.1" class="ltx_Math" alttext="64" display="inline"><semantics id="A1.SS1.p1.13.m13.1a"><mn id="A1.SS1.p1.13.m13.1.1" xref="A1.SS1.p1.13.m13.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.13.m13.1b"><cn type="integer" id="A1.SS1.p1.13.m13.1.1.cmml" xref="A1.SS1.p1.13.m13.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.13.m13.1c">64</annotation></semantics></math>. The model is evaluated using classification accuracy.</p>
</div>
<figure id="A1.T9" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span>Accuracy on the <span id="A1.T9.8.1" class="ltx_text ltx_font_bold">OfficeHome</span> dataset. We conduct experiments using a <span id="A1.T9.9.2" class="ltx_text ltx_font_italic">leave-one-domain-out</span> approach, meaning each domain serves as the evaluation domain in turn. Existing methods typically consider each domain as an individual client <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib26" title="" class="ltx_ref">2021</a>; Nguyen et al., <a href="#bib.bib39" title="" class="ltx_ref">2022</a>)</cite>. However, in order to simulate a large-scale distributed setting, we took a different approach by further dividing each domain into <math id="A1.T9.3.m1.1" class="ltx_Math" alttext="5" display="inline"><semantics id="A1.T9.3.m1.1b"><mn id="A1.T9.3.m1.1.1" xref="A1.T9.3.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A1.T9.3.m1.1c"><cn type="integer" id="A1.T9.3.m1.1.1.cmml" xref="A1.T9.3.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T9.3.m1.1d">5</annotation></semantics></math> subsets and treating each subset as a separate client. This increased the total number of clients to <math id="A1.T9.4.m2.1" class="ltx_Math" alttext="20" display="inline"><semantics id="A1.T9.4.m2.1b"><mn id="A1.T9.4.m2.1.1" xref="A1.T9.4.m2.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="A1.T9.4.m2.1c"><cn type="integer" id="A1.T9.4.m2.1.1.cmml" xref="A1.T9.4.m2.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T9.4.m2.1d">20</annotation></semantics></math>. <span id="A1.T9.10.3" class="ltx_text ltx_font_italic">Our method outperformed others across all experimental settings</span>, demonstrating superior results. </figcaption>
<div id="A1.T9.11" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:368.6pt;height:106.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-95.1pt,27.6pt) scale(0.659653146798911,0.659653146798911) ;">
<table id="A1.T9.11.1" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A1.T9.11.1.1.1" class="ltx_tr">
<td id="A1.T9.11.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" colspan="2" rowspan="2"><span id="A1.T9.11.1.1.1.1.1" class="ltx_text">Models</span></td>
<td id="A1.T9.11.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="A1.T9.11.1.1.1.2.1" class="ltx_text">Backbone</span></td>
<td id="A1.T9.11.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="5">OfficeHome</td>
</tr>
<tr id="A1.T9.11.1.2.2" class="ltx_tr">
<td id="A1.T9.11.1.2.2.1" class="ltx_td ltx_align_center ltx_border_t">A</td>
<td id="A1.T9.11.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">C</td>
<td id="A1.T9.11.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">P</td>
<td id="A1.T9.11.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">R</td>
<td id="A1.T9.11.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t">Average</td>
</tr>
<tr id="A1.T9.11.1.3.3" class="ltx_tr">
<td id="A1.T9.11.1.3.3.1" class="ltx_td ltx_align_center ltx_border_t" rowspan="2"><span id="A1.T9.11.1.3.3.1.1" class="ltx_text">
<span id="A1.T9.11.1.3.3.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T9.11.1.3.3.1.1.1.1" class="ltx_tr">
<span id="A1.T9.11.1.3.3.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Centralized</span></span>
<span id="A1.T9.11.1.3.3.1.1.1.2" class="ltx_tr">
<span id="A1.T9.11.1.3.3.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Methods</span></span>
</span></span></td>
<td id="A1.T9.11.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">Mixup <cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a href="#bib.bib70" title="" class="ltx_ref">2020</a>)</cite>
</td>
<td id="A1.T9.11.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t">ResNet50</td>
<td id="A1.T9.11.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">64.7</td>
<td id="A1.T9.11.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t">54.7</td>
<td id="A1.T9.11.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t">77.3</td>
<td id="A1.T9.11.1.3.3.7" class="ltx_td ltx_align_center ltx_border_t">79.2</td>
<td id="A1.T9.11.1.3.3.8" class="ltx_td ltx_align_center ltx_border_t">69.0</td>
</tr>
<tr id="A1.T9.11.1.4.4" class="ltx_tr">
<td id="A1.T9.11.1.4.4.1" class="ltx_td ltx_align_center">CORAL <cite class="ltx_cite ltx_citemacro_citep">(Sun &amp; Saenko, <a href="#bib.bib58" title="" class="ltx_ref">2016</a>)</cite>
</td>
<td id="A1.T9.11.1.4.4.2" class="ltx_td ltx_align_center">ResNet50</td>
<td id="A1.T9.11.1.4.4.3" class="ltx_td ltx_align_center">64.4</td>
<td id="A1.T9.11.1.4.4.4" class="ltx_td ltx_align_center">55.3</td>
<td id="A1.T9.11.1.4.4.5" class="ltx_td ltx_align_center">76.7</td>
<td id="A1.T9.11.1.4.4.6" class="ltx_td ltx_align_center">77.9</td>
<td id="A1.T9.11.1.4.4.7" class="ltx_td ltx_align_center">68.6</td>
</tr>
<tr id="A1.T9.11.1.5.5" class="ltx_tr">
<td id="A1.T9.11.1.5.5.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" rowspan="5"><span id="A1.T9.11.1.5.5.1.1" class="ltx_text">
<span id="A1.T9.11.1.5.5.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T9.11.1.5.5.1.1.1.1" class="ltx_tr">
<span id="A1.T9.11.1.5.5.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Federated</span></span>
<span id="A1.T9.11.1.5.5.1.1.1.2" class="ltx_tr">
<span id="A1.T9.11.1.5.5.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Learning</span></span>
<span id="A1.T9.11.1.5.5.1.1.1.3" class="ltx_tr">
<span id="A1.T9.11.1.5.5.1.1.1.3.1" class="ltx_td ltx_nopad_r ltx_align_center">Methods</span></span>
</span></span></td>
<td id="A1.T9.11.1.5.5.2" class="ltx_td ltx_align_center ltx_border_t">FedAvg</td>
<td id="A1.T9.11.1.5.5.3" class="ltx_td ltx_align_center ltx_border_t">ResNet50</td>
<td id="A1.T9.11.1.5.5.4" class="ltx_td ltx_align_center ltx_border_t">24.10</td>
<td id="A1.T9.11.1.5.5.5" class="ltx_td ltx_align_center ltx_border_t">23.16</td>
<td id="A1.T9.11.1.5.5.6" class="ltx_td ltx_align_center ltx_border_t">40.19</td>
<td id="A1.T9.11.1.5.5.7" class="ltx_td ltx_align_center ltx_border_t">43.47</td>
<td id="A1.T9.11.1.5.5.8" class="ltx_td ltx_align_center ltx_border_t">32.73</td>
</tr>
<tr id="A1.T9.11.1.6.6" class="ltx_tr">
<td id="A1.T9.11.1.6.6.1" class="ltx_td ltx_align_center">FedProx</td>
<td id="A1.T9.11.1.6.6.2" class="ltx_td ltx_align_center">ResNet50</td>
<td id="A1.T9.11.1.6.6.3" class="ltx_td ltx_align_center">23.16</td>
<td id="A1.T9.11.1.6.6.4" class="ltx_td ltx_align_center">23.47</td>
<td id="A1.T9.11.1.6.6.5" class="ltx_td ltx_align_center">41.08</td>
<td id="A1.T9.11.1.6.6.6" class="ltx_td ltx_align_center">42.66</td>
<td id="A1.T9.11.1.6.6.7" class="ltx_td ltx_align_center">32.59</td>
</tr>
<tr id="A1.T9.11.1.7.7" class="ltx_tr">
<td id="A1.T9.11.1.7.7.1" class="ltx_td ltx_align_center">DRFA</td>
<td id="A1.T9.11.1.7.7.2" class="ltx_td ltx_align_center">ResNet50</td>
<td id="A1.T9.11.1.7.7.3" class="ltx_td ltx_align_center">25.29</td>
<td id="A1.T9.11.1.7.7.4" class="ltx_td ltx_align_center">23.98</td>
<td id="A1.T9.11.1.7.7.5" class="ltx_td ltx_align_center">41.23</td>
<td id="A1.T9.11.1.7.7.6" class="ltx_td ltx_align_center">42.35</td>
<td id="A1.T9.11.1.7.7.7" class="ltx_td ltx_align_center">33.21</td>
</tr>
<tr id="A1.T9.11.1.8.8" class="ltx_tr">
<td id="A1.T9.11.1.8.8.1" class="ltx_td ltx_align_center">FedSR</td>
<td id="A1.T9.11.1.8.8.2" class="ltx_td ltx_align_center">ResNet50</td>
<td id="A1.T9.11.1.8.8.3" class="ltx_td ltx_align_center">23.51</td>
<td id="A1.T9.11.1.8.8.4" class="ltx_td ltx_align_center">22.93</td>
<td id="A1.T9.11.1.8.8.5" class="ltx_td ltx_align_center">39.30</td>
<td id="A1.T9.11.1.8.8.6" class="ltx_td ltx_align_center">41.48</td>
<td id="A1.T9.11.1.8.8.7" class="ltx_td ltx_align_center">31.81</td>
</tr>
<tr id="A1.T9.11.1.9.9" class="ltx_tr">
<td id="A1.T9.11.1.9.9.1" class="ltx_td ltx_align_center ltx_border_bb">TFL (Ours)</td>
<td id="A1.T9.11.1.9.9.2" class="ltx_td ltx_align_center ltx_border_bb">ResNet50</td>
<td id="A1.T9.11.1.9.9.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T9.11.1.9.9.3.1" class="ltx_text ltx_font_bold">26.37</span></td>
<td id="A1.T9.11.1.9.9.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T9.11.1.9.9.4.1" class="ltx_text ltx_font_bold">24.47</span></td>
<td id="A1.T9.11.1.9.9.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T9.11.1.9.9.5.1" class="ltx_text ltx_font_bold">43.96</span></td>
<td id="A1.T9.11.1.9.9.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T9.11.1.9.9.6.1" class="ltx_text ltx_font_bold">44.74</span></td>
<td id="A1.T9.11.1.9.9.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T9.11.1.9.9.7.1" class="ltx_text ltx_font_bold">34.89</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Data Pre-processing on eICU</h3>

<div id="A1.SS2.p1" class="ltx_para">
<p id="A1.SS2.p1.1" class="ltx_p">We follow <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib16" title="" class="ltx_ref">2019</a>)</cite> to predict patient mortality using drug features. These features pertain to the medications administered to patients during the initial 48 hours of their ICU stay. We’ve extracted pertinent patient and corresponding drug feature data from two primary sources: the ’medication.csv’ and ’patient.csv’ files. Our final dataset is a table with the dimension of <math id="A1.SS2.p1.1.m1.1" class="ltx_Math" alttext="19000\times 1411" display="inline"><semantics id="A1.SS2.p1.1.m1.1a"><mrow id="A1.SS2.p1.1.m1.1.1" xref="A1.SS2.p1.1.m1.1.1.cmml"><mn id="A1.SS2.p1.1.m1.1.1.2" xref="A1.SS2.p1.1.m1.1.1.2.cmml">19000</mn><mo lspace="0.222em" rspace="0.222em" id="A1.SS2.p1.1.m1.1.1.1" xref="A1.SS2.p1.1.m1.1.1.1.cmml">×</mo><mn id="A1.SS2.p1.1.m1.1.1.3" xref="A1.SS2.p1.1.m1.1.1.3.cmml">1411</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><apply id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1"><times id="A1.SS2.p1.1.m1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1"></times><cn type="integer" id="A1.SS2.p1.1.m1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.1.2">19000</cn><cn type="integer" id="A1.SS2.p1.1.m1.1.1.3.cmml" xref="A1.SS2.p1.1.m1.1.1.3">1411</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">19000\times 1411</annotation></semantics></math>. Each row in this matrix symbolizes a unique patient, while each column corresponds to a distinct medication.</p>
</div>
</section>
<section id="A1.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>More Results on eICU</h3>

<div id="A1.SS3.p1" class="ltx_para">
<p id="A1.SS3.p1.1" class="ltx_p">We conduct more experiments on the eICU dataset to evaluate the gap between in-federation (IF) and out-of-federation (OOF) and visualize the results in Figure <a href="#A1.F8" title="Figure 8 ‣ A.4 Detailed Dataset Description ‣ Appendix A Additional Experimental Results &amp; Detailed Dataset Description ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>. <span id="A1.SS3.p1.1.1" class="ltx_text ltx_font_italic">We observe that existing FL methods are not robust against OOF data.</span></p>
</div>
</section>
<section id="A1.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Detailed Dataset Description</h3>

<div id="A1.SS4.p1" class="ltx_para">
<ol id="A1.I1" class="ltx_enumerate">
<li id="A1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">①</span> 
<div id="A1.I1.i1.p1" class="ltx_para">
<p id="A1.I1.i1.p1.4" class="ltx_p"><span id="A1.I1.i1.p1.4.1" class="ltx_text ltx_font_bold">eICU</span> (eICU Collaborative Research Database) <cite class="ltx_cite ltx_citemacro_citep">(Pollard et al., <a href="#bib.bib43" title="" class="ltx_ref">2018</a>)</cite> is a large-scale multi-center critical care database. It contains high granularity critical care data for over <math id="A1.I1.i1.p1.1.m1.2" class="ltx_Math" alttext="200,000" display="inline"><semantics id="A1.I1.i1.p1.1.m1.2a"><mrow id="A1.I1.i1.p1.1.m1.2.3.2" xref="A1.I1.i1.p1.1.m1.2.3.1.cmml"><mn id="A1.I1.i1.p1.1.m1.1.1" xref="A1.I1.i1.p1.1.m1.1.1.cmml">200</mn><mo id="A1.I1.i1.p1.1.m1.2.3.2.1" xref="A1.I1.i1.p1.1.m1.2.3.1.cmml">,</mo><mn id="A1.I1.i1.p1.1.m1.2.2" xref="A1.I1.i1.p1.1.m1.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.1.m1.2b"><list id="A1.I1.i1.p1.1.m1.2.3.1.cmml" xref="A1.I1.i1.p1.1.m1.2.3.2"><cn type="integer" id="A1.I1.i1.p1.1.m1.1.1.cmml" xref="A1.I1.i1.p1.1.m1.1.1">200</cn><cn type="integer" id="A1.I1.i1.p1.1.m1.2.2.cmml" xref="A1.I1.i1.p1.1.m1.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.1.m1.2c">200,000</annotation></semantics></math> patients admitted to <math id="A1.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="208" display="inline"><semantics id="A1.I1.i1.p1.2.m2.1a"><mn id="A1.I1.i1.p1.2.m2.1.1" xref="A1.I1.i1.p1.2.m2.1.1.cmml">208</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.2.m2.1b"><cn type="integer" id="A1.I1.i1.p1.2.m2.1.1.cmml" xref="A1.I1.i1.p1.2.m2.1.1">208</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.2.m2.1c">208</annotation></semantics></math> hospitals across the United States. Each hospital is considered an individual client. We follow <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib16" title="" class="ltx_ref">2019</a>)</cite> to prepare the data. The final dataset includes data from approximately <math id="A1.I1.i1.p1.3.m3.1" class="ltx_Math" alttext="19000" display="inline"><semantics id="A1.I1.i1.p1.3.m3.1a"><mn id="A1.I1.i1.p1.3.m3.1.1" xref="A1.I1.i1.p1.3.m3.1.1.cmml">19000</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.3.m3.1b"><cn type="integer" id="A1.I1.i1.p1.3.m3.1.1.cmml" xref="A1.I1.i1.p1.3.m3.1.1">19000</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.3.m3.1c">19000</annotation></semantics></math> patients over <math id="A1.I1.i1.p1.4.m4.1" class="ltx_Math" alttext="72" display="inline"><semantics id="A1.I1.i1.p1.4.m4.1a"><mn id="A1.I1.i1.p1.4.m4.1.1" xref="A1.I1.i1.p1.4.m4.1.1.cmml">72</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.4.m4.1b"><cn type="integer" id="A1.I1.i1.p1.4.m4.1.1.cmml" xref="A1.I1.i1.p1.4.m4.1.1">72</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.4.m4.1c">72</annotation></semantics></math> hospitals.
The generalization task could be deploying models trained on hospitals from the SOUTH region to those in the WEST. The evaluation metric for patient mortality prediction is ROC-AUC.</p>
</div>
</li>
<li id="A1.I1.i2" class="ltx_item" style="list-style-type:none;padding-top:2.5pt;">
<span class="ltx_tag ltx_tag_item">②</span> 
<div id="A1.I1.i2.p1" class="ltx_para">
<p id="A1.I1.i2.p1.3" class="ltx_p"><span id="A1.I1.i2.p1.3.1" class="ltx_text ltx_font_bold">FeTS</span> (Federated Tumor Segmentation Dataset) <cite class="ltx_cite ltx_citemacro_citep">(Pati et al., <a href="#bib.bib42" title="" class="ltx_ref">2022b</a>)</cite> is a multi-institutional medical imaging dataset. It comprises clinically acquired multi-institutional MRI scans of glioma. A subset of the original data was used, comprising <math id="A1.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="358" display="inline"><semantics id="A1.I1.i2.p1.1.m1.1a"><mn id="A1.I1.i2.p1.1.m1.1.1" xref="A1.I1.i2.p1.1.m1.1.1.cmml">358</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.1.m1.1b"><cn type="integer" id="A1.I1.i2.p1.1.m1.1.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1">358</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.1.m1.1c">358</annotation></semantics></math> subjects from <math id="A1.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="21" display="inline"><semantics id="A1.I1.i2.p1.2.m2.1a"><mn id="A1.I1.i2.p1.2.m2.1.1" xref="A1.I1.i2.p1.2.m2.1.1.cmml">21</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.2.m2.1b"><cn type="integer" id="A1.I1.i2.p1.2.m2.1.1.cmml" xref="A1.I1.i2.p1.2.m2.1.1">21</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.2.m2.1c">21</annotation></semantics></math> distinct global institutions. The associated task is to identify and delineate brain tumor boundaries. Each institution is a client. Evaluation metric is Dice Similarity Coefficient (DSC <math id="A1.I1.i2.p1.3.m3.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A1.I1.i2.p1.3.m3.1a"><mo stretchy="false" id="A1.I1.i2.p1.3.m3.1.1" xref="A1.I1.i2.p1.3.m3.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.3.m3.1b"><ci id="A1.I1.i2.p1.3.m3.1.1.cmml" xref="A1.I1.i2.p1.3.m3.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.3.m3.1c">\uparrow</annotation></semantics></math>). See more visualizations in Figure <a href="#A1.F9" title="Figure 9 ‣ A.4 Detailed Dataset Description ‣ Appendix A Additional Experimental Results &amp; Detailed Dataset Description ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
</li>
<li id="A1.I1.i3" class="ltx_item" style="list-style-type:none;padding-top:2.5pt;">
<span class="ltx_tag ltx_tag_item">③</span> 
<div id="A1.I1.i3.p1" class="ltx_para">
<p id="A1.I1.i3.p1.3" class="ltx_p"><span id="A1.I1.i3.p1.3.1" class="ltx_text ltx_font_bold">TPT-48</span> <cite class="ltx_cite ltx_citemacro_citep">(Vose et al., <a href="#bib.bib64" title="" class="ltx_ref">2014</a>)</cite> contains the monthly average temperature for the 48 contiguous states in the US from 2008 to 2019. The task is to predict the next six months’ temperature given the first six months’ temperature. For TPT-48, we consider two generalization tasks: (1) E(24) <math id="A1.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A1.I1.i3.p1.1.m1.1a"><mo stretchy="false" id="A1.I1.i3.p1.1.m1.1.1" xref="A1.I1.i3.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.1.m1.1b"><ci id="A1.I1.i3.p1.1.m1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i3.p1.1.m1.1c">\rightarrow</annotation></semantics></math> W(24): Using the 24 eastern states as IF clients and the 24 western states as OOF clients; (2) N(24) <math id="A1.I1.i3.p1.2.m2.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A1.I1.i3.p1.2.m2.1a"><mo stretchy="false" id="A1.I1.i3.p1.2.m2.1.1" xref="A1.I1.i3.p1.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.2.m2.1b"><ci id="A1.I1.i3.p1.2.m2.1.1.cmml" xref="A1.I1.i3.p1.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i3.p1.2.m2.1c">\rightarrow</annotation></semantics></math> S(24): Using the 24 northern states as IF clients and the 24 southern states as OOF clients. The evaluation metric is Mean Squared Error (MSE <math id="A1.I1.i3.p1.3.m3.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A1.I1.i3.p1.3.m3.1a"><mo stretchy="false" id="A1.I1.i3.p1.3.m3.1.1" xref="A1.I1.i3.p1.3.m3.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.3.m3.1b"><ci id="A1.I1.i3.p1.3.m3.1.1.cmml" xref="A1.I1.i3.p1.3.m3.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i3.p1.3.m3.1c">\downarrow</annotation></semantics></math>).</p>
</div>
</li>
<li id="A1.I1.i4" class="ltx_item" style="list-style-type:none;padding-top:2.5pt;">
<span class="ltx_tag ltx_tag_item">④</span> 
<div id="A1.I1.i4.p1" class="ltx_para">
<p id="A1.I1.i4.p1.2" class="ltx_p"><span id="A1.I1.i4.p1.2.1" class="ltx_text ltx_font_bold">CIFAR-10/-100</span> <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky &amp; Hinton, <a href="#bib.bib19" title="" class="ltx_ref">2009</a>)</cite> are the most commonly used benchmarks in FL literature. In these datasets, we use Dirichlet distribution <cite class="ltx_cite ltx_citemacro_citep">(Hsu et al., <a href="#bib.bib14" title="" class="ltx_ref">2019</a>)</cite> to partition the dataset into the heterogeneous setting with <math id="A1.I1.i4.p1.1.m1.1" class="ltx_Math" alttext="25" display="inline"><semantics id="A1.I1.i4.p1.1.m1.1a"><mn id="A1.I1.i4.p1.1.m1.1.1" xref="A1.I1.i4.p1.1.m1.1.1.cmml">25</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i4.p1.1.m1.1b"><cn type="integer" id="A1.I1.i4.p1.1.m1.1.1.cmml" xref="A1.I1.i4.p1.1.m1.1.1">25</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i4.p1.1.m1.1c">25</annotation></semantics></math> and <math id="A1.I1.i4.p1.2.m2.1" class="ltx_Math" alttext="50" display="inline"><semantics id="A1.I1.i4.p1.2.m2.1a"><mn id="A1.I1.i4.p1.2.m2.1.1" xref="A1.I1.i4.p1.2.m2.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i4.p1.2.m2.1b"><cn type="integer" id="A1.I1.i4.p1.2.m2.1.1.cmml" xref="A1.I1.i4.p1.2.m2.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i4.p1.2.m2.1c">50</annotation></semantics></math> clients.</p>
</div>
</li>
<li id="A1.I1.i5" class="ltx_item" style="list-style-type:none;padding-top:2.5pt;">
<span class="ltx_tag ltx_tag_item">⑤</span> 
<div id="A1.I1.i5.p1" class="ltx_para">
<p id="A1.I1.i5.p1.7" class="ltx_p"><span id="A1.I1.i5.p1.7.1" class="ltx_text ltx_font_bold">PACS</span> <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib20" title="" class="ltx_ref">2017</a>)</cite> contains <math id="A1.I1.i5.p1.1.m1.2" class="ltx_Math" alttext="9,991" display="inline"><semantics id="A1.I1.i5.p1.1.m1.2a"><mrow id="A1.I1.i5.p1.1.m1.2.3.2" xref="A1.I1.i5.p1.1.m1.2.3.1.cmml"><mn id="A1.I1.i5.p1.1.m1.1.1" xref="A1.I1.i5.p1.1.m1.1.1.cmml">9</mn><mo id="A1.I1.i5.p1.1.m1.2.3.2.1" xref="A1.I1.i5.p1.1.m1.2.3.1.cmml">,</mo><mn id="A1.I1.i5.p1.1.m1.2.2" xref="A1.I1.i5.p1.1.m1.2.2.cmml">991</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i5.p1.1.m1.2b"><list id="A1.I1.i5.p1.1.m1.2.3.1.cmml" xref="A1.I1.i5.p1.1.m1.2.3.2"><cn type="integer" id="A1.I1.i5.p1.1.m1.1.1.cmml" xref="A1.I1.i5.p1.1.m1.1.1">9</cn><cn type="integer" id="A1.I1.i5.p1.1.m1.2.2.cmml" xref="A1.I1.i5.p1.1.m1.2.2">991</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i5.p1.1.m1.2c">9,991</annotation></semantics></math> images from four domains: art painting, cartoon, photo, and sketch. The task is seven-class classification. For PACS, we evenly split each domain into <math id="A1.I1.i5.p1.2.m2.1" class="ltx_Math" alttext="5" display="inline"><semantics id="A1.I1.i5.p1.2.m2.1a"><mn id="A1.I1.i5.p1.2.m2.1.1" xref="A1.I1.i5.p1.2.m2.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i5.p1.2.m2.1b"><cn type="integer" id="A1.I1.i5.p1.2.m2.1.1.cmml" xref="A1.I1.i5.p1.2.m2.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i5.p1.2.m2.1c">5</annotation></semantics></math> subsets, yielding <math id="A1.I1.i5.p1.3.m3.1" class="ltx_Math" alttext="20" display="inline"><semantics id="A1.I1.i5.p1.3.m3.1a"><mn id="A1.I1.i5.p1.3.m3.1.1" xref="A1.I1.i5.p1.3.m3.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i5.p1.3.m3.1b"><cn type="integer" id="A1.I1.i5.p1.3.m3.1.1.cmml" xref="A1.I1.i5.p1.3.m3.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i5.p1.3.m3.1c">20</annotation></semantics></math> subsets, and we treat each subset as a client. We followed the common “leave-one-domain-out” experiment, where <math id="A1.I1.i5.p1.4.m4.1" class="ltx_Math" alttext="3" display="inline"><semantics id="A1.I1.i5.p1.4.m4.1a"><mn id="A1.I1.i5.p1.4.m4.1.1" xref="A1.I1.i5.p1.4.m4.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i5.p1.4.m4.1b"><cn type="integer" id="A1.I1.i5.p1.4.m4.1.1.cmml" xref="A1.I1.i5.p1.4.m4.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i5.p1.4.m4.1c">3</annotation></semantics></math> domains are used (<math id="A1.I1.i5.p1.5.m5.1" class="ltx_Math" alttext="15" display="inline"><semantics id="A1.I1.i5.p1.5.m5.1a"><mn id="A1.I1.i5.p1.5.m5.1.1" xref="A1.I1.i5.p1.5.m5.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i5.p1.5.m5.1b"><cn type="integer" id="A1.I1.i5.p1.5.m5.1.1.cmml" xref="A1.I1.i5.p1.5.m5.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i5.p1.5.m5.1c">15</annotation></semantics></math> clients) for training and <math id="A1.I1.i5.p1.6.m6.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A1.I1.i5.p1.6.m6.1a"><mn id="A1.I1.i5.p1.6.m6.1.1" xref="A1.I1.i5.p1.6.m6.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i5.p1.6.m6.1b"><cn type="integer" id="A1.I1.i5.p1.6.m6.1.1.cmml" xref="A1.I1.i5.p1.6.m6.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i5.p1.6.m6.1c">1</annotation></semantics></math> domain (<math id="A1.I1.i5.p1.7.m7.1" class="ltx_Math" alttext="5" display="inline"><semantics id="A1.I1.i5.p1.7.m7.1a"><mn id="A1.I1.i5.p1.7.m7.1.1" xref="A1.I1.i5.p1.7.m7.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i5.p1.7.m7.1b"><cn type="integer" id="A1.I1.i5.p1.7.m7.1.1.cmml" xref="A1.I1.i5.p1.7.m7.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i5.p1.7.m7.1c">5</annotation></semantics></math> clients) for testing. Model performance is evaluated by classification accuracy.</p>
</div>
</li>
</ol>
</div>
<figure id="A1.F8" class="ltx_figure"><img src="/html/2407.04949/assets/x8.png" id="A1.F8.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="308" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Additional results on eICU (IF <span id="A1.F8.13.1" class="ltx_text ltx_font_italic">vs.</span> OOF performance). eICU’s 72 hospitals are distributed across the United States. Specifically, there are <math id="A1.F8.6.m1.1" class="ltx_Math" alttext="14" display="inline"><semantics id="A1.F8.6.m1.1b"><mn id="A1.F8.6.m1.1.1" xref="A1.F8.6.m1.1.1.cmml">14</mn><annotation-xml encoding="MathML-Content" id="A1.F8.6.m1.1c"><cn type="integer" id="A1.F8.6.m1.1.1.cmml" xref="A1.F8.6.m1.1.1">14</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.F8.6.m1.1d">14</annotation></semantics></math> hospitals in the WEST, <math id="A1.F8.7.m2.1" class="ltx_Math" alttext="28" display="inline"><semantics id="A1.F8.7.m2.1b"><mn id="A1.F8.7.m2.1.1" xref="A1.F8.7.m2.1.1.cmml">28</mn><annotation-xml encoding="MathML-Content" id="A1.F8.7.m2.1c"><cn type="integer" id="A1.F8.7.m2.1.1.cmml" xref="A1.F8.7.m2.1.1">28</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.F8.7.m2.1d">28</annotation></semantics></math> hospitals in the MIDWEST, <math id="A1.F8.8.m3.1" class="ltx_Math" alttext="26" display="inline"><semantics id="A1.F8.8.m3.1b"><mn id="A1.F8.8.m3.1.1" xref="A1.F8.8.m3.1.1.cmml">26</mn><annotation-xml encoding="MathML-Content" id="A1.F8.8.m3.1c"><cn type="integer" id="A1.F8.8.m3.1.1.cmml" xref="A1.F8.8.m3.1.1">26</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.F8.8.m3.1d">26</annotation></semantics></math> hospitals in the SOUTH, and <math id="A1.F8.9.m4.1" class="ltx_Math" alttext="4" display="inline"><semantics id="A1.F8.9.m4.1b"><mn id="A1.F8.9.m4.1.1" xref="A1.F8.9.m4.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A1.F8.9.m4.1c"><cn type="integer" id="A1.F8.9.m4.1.1.cmml" xref="A1.F8.9.m4.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.F8.9.m4.1d">4</annotation></semantics></math> hospitals in the NORTHEAST. We employ a <span id="A1.F8.14.2" class="ltx_text ltx_font_italic">leave-one-region-out</span> approach, designating one geographic region as the OOF region while the remaining as IF regions. We observe a considerable gap between IF and OOF performance, indicating that <span id="A1.F8.15.3" class="ltx_text ltx_font_italic">current FL methods are not robust against OOF data</span>.
</figcaption>
</figure>
<figure id="A1.F9" class="ltx_figure"><img src="/html/2407.04949/assets/x9.png" id="A1.F9.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="221" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Additional qualitative results comparison on unseen patients of the FeTS dataset. We show both the tumor segmentation and DSC (<math id="A1.F9.3.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A1.F9.3.m1.1b"><mo stretchy="false" id="A1.F9.3.m1.1.1" xref="A1.F9.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.F9.3.m1.1c"><ci id="A1.F9.3.m1.1.1.cmml" xref="A1.F9.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.3.m1.1d">\uparrow</annotation></semantics></math>) score.
<span id="A1.F9.5.1" class="ltx_text ltx_font_italic">Our method demonstrates consistent superior OOF-resiliency across a range of local demographics.</span>
</figcaption>
</figure>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Extended Related Work</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p"><span id="A2.p1.1.1" class="ltx_text ltx_font_bold">Federated learning.</span> Federated learning <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib22" title="" class="ltx_ref">2020a</a>; Kairouz et al., <a href="#bib.bib17" title="" class="ltx_ref">2021</a>; McMahan et al., <a href="#bib.bib32" title="" class="ltx_ref">2017</a>)</cite> has emerged as a powerful tool to protect data privacy in the distributed setting. It allows multiple clients/devices to collaborate in training a predictive model without sharing their local data.
Despite the success, current FL methods are vulnerable to heterogeneous data (non-IID data) <cite class="ltx_cite ltx_citemacro_citep">(Smith et al., <a href="#bib.bib55" title="" class="ltx_ref">2017</a>; Sattler et al., <a href="#bib.bib49" title="" class="ltx_ref">2019</a>; Li et al., <a href="#bib.bib24" title="" class="ltx_ref">2023</a>; Tan et al., <a href="#bib.bib59" title="" class="ltx_ref">2022</a>)</cite>, a common issue in real-world FL. Data heterogeneity posits significant challenges to FL, such as the severe convergence issue <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib25" title="" class="ltx_ref">2020c</a>)</cite> and poor generalization ability to new clients <cite class="ltx_cite ltx_citemacro_citep">(Sattler et al., <a href="#bib.bib49" title="" class="ltx_ref">2019</a>)</cite>. To improve the model’s robustness against data heterogeneity, <span id="A2.p1.1.2" class="ltx_text ltx_font_typewriter">FedProx</span> <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib23" title="" class="ltx_ref">2020b</a>)</cite> add a proximal term to restrict the local model updating, avoiding biased models toward local data distribution. <span id="A2.p1.1.3" class="ltx_text ltx_font_typewriter">SCAFFOLD</span> <cite class="ltx_cite ltx_citemacro_citep">(Karimireddy et al., <a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite> introduces a control variate to rectify the local update. <span id="A2.p1.1.4" class="ltx_text ltx_font_typewriter">FedAlign</span> <cite class="ltx_cite ltx_citemacro_citep">(Mendieta et al., <a href="#bib.bib34" title="" class="ltx_ref">2022</a>)</cite> improve the heterogeneous robustness by training local models with better generalization ability. However, most FL methods focus on the model’s in-federation performance. Orthogonal to existing work, we propose leveraging client topology to improve the model’s OOF generalization capability.</p>
</div>
<div id="A2.p2" class="ltx_para">
<p id="A2.p2.1" class="ltx_p"><span id="A2.p2.1.1" class="ltx_text ltx_font_bold">FL generalization to unseen clients.</span> There are recent attempts to address generalization to unseen clients in FL. FedDG <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib26" title="" class="ltx_ref">2021</a>)</cite> is proposed to solve domain generalization in medical image classification. The key idea is to share the amplitude spectrum of images among local clients to augment the local data distributions. FedADG <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib75" title="" class="ltx_ref">2021</a>)</cite> adopts the federated adversarial training to measure and align the local client distributions to a reference distribution. FedGMA <cite class="ltx_cite ltx_citemacro_citep">(Tenison et al., <a href="#bib.bib60" title="" class="ltx_ref">2022</a>)</cite> proposes gradient masking averaging to prioritize gradients aligned with the overall domain direction across clients. FedSR <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et al., <a href="#bib.bib39" title="" class="ltx_ref">2022</a>)</cite> proposes regularizing latent representation’s <math id="A2.p2.1.m1.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="A2.p2.1.m1.1a"><msub id="A2.p2.1.m1.1.1" xref="A2.p2.1.m1.1.1.cmml"><mi mathvariant="normal" id="A2.p2.1.m1.1.1.2" xref="A2.p2.1.m1.1.1.2.cmml">ℓ</mi><mn id="A2.p2.1.m1.1.1.3" xref="A2.p2.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A2.p2.1.m1.1b"><apply id="A2.p2.1.m1.1.1.cmml" xref="A2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A2.p2.1.m1.1.1.1.cmml" xref="A2.p2.1.m1.1.1">subscript</csymbol><ci id="A2.p2.1.m1.1.1.2.cmml" xref="A2.p2.1.m1.1.1.2">ℓ</ci><cn type="integer" id="A2.p2.1.m1.1.1.3.cmml" xref="A2.p2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.1.m1.1c">\ell_{2}</annotation></semantics></math> norm and class conditional information to enhance the OOF performance. However, existing methods often ignore scalability issues, yielding inferior performance in large-scale distributed setting <cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a href="#bib.bib1" title="" class="ltx_ref">2023</a>)</cite>. We introduce an approach that employs client topology to achieve good OOF-resiliency in a scalable manner.</p>
</div>
<div id="A2.p3" class="ltx_para">
<p id="A2.p3.1" class="ltx_p"><span id="A2.p3.1.1" class="ltx_text ltx_font_bold">Graph topology learning.</span> The problem of graph topology learning has been studied in different fields. In graph signal processing <cite class="ltx_cite ltx_citemacro_citep">(Mateos et al., <a href="#bib.bib31" title="" class="ltx_ref">2019</a>; Dong et al., <a href="#bib.bib9" title="" class="ltx_ref">2019</a>; Stanković et al., <a href="#bib.bib57" title="" class="ltx_ref">2020</a>)</cite>, existing work explores various ways to learn the graph structure from data with structural regularization ( <span id="A2.p3.1.2" class="ltx_text ltx_font_italic">e.g.,</span> sparsity, smoothness, and community preservation <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a href="#bib.bib78" title="" class="ltx_ref">2021</a>)</cite>). In Graph Neural Networks (GNNs) <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a href="#bib.bib68" title="" class="ltx_ref">2020</a>; Welling &amp; Kipf, <a href="#bib.bib65" title="" class="ltx_ref">2016</a>)</cite>, researchers have explored scenarios where the initial graph structure is unavailable, wherein a graph has to be estimated from objectives <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib21" title="" class="ltx_ref">2018</a>; Norcliffe-Brown et al., <a href="#bib.bib40" title="" class="ltx_ref">2018</a>)</cite> or words <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib5" title="" class="ltx_ref">2019</a>, <a href="#bib.bib7" title="" class="ltx_ref">2020b</a>)</cite>. The existing graph topology learning methods often require centralizing the data, making it inapplicable in federated learning.
However, how to estimate the graph topology with privacy regulations has been less investigated. We explore simple methods to infer the graph topology using model weights.</p>
</div>
<div id="A2.p4" class="ltx_para">
<p id="A2.p4.1" class="ltx_p"><span id="A2.p4.1.1" class="ltx_text ltx_font_bold">FL with graphs.</span> One line of research is to combine FL with GNNs, leading to federated GNNs <cite class="ltx_cite ltx_citemacro_citep">(Xie et al., <a href="#bib.bib69" title="" class="ltx_ref">2021</a>; Wu et al., <a href="#bib.bib67" title="" class="ltx_ref">2021</a>)</cite>. These federated GNNs primarily engage in learning from distributed graph data that already has inherent structural information. In contrast, our primary objective is to obtain a distribution graph that captures the relationships between distributed clients. Another research line explores the use of graphs to enhance personalization in FL <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a href="#bib.bib72" title="" class="ltx_ref">2023</a>; Zantedeschi et al., <a href="#bib.bib74" title="" class="ltx_ref">2019</a>)</cite>. For example, pFedGraph <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a href="#bib.bib72" title="" class="ltx_ref">2023</a>)</cite> utilizes a collaboration graph to tailor the global model more effectively to individual clients. These types of research primarily deal with in-federation clients. Our approach, however, aims to utilize client topology to significantly improve generalization to clients outside of the federation.</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Additional Ablation Study</h2>

<figure id="A3.T10" class="ltx_table ltx_align_floatright">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 10: </span>Ablation study evaluating the efficacy of hyperparameter tuning, centrality, and similarity metric.</figcaption>
<div id="A3.T10.15.15" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:390.3pt;height:205.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(41.5pt,-21.9pt) scale(1.2703551298815,1.2703551298815) ;">
<table id="A3.T10.15.15.15" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A3.T10.2.2.2.2" class="ltx_tr">
<td id="A3.T10.2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="5">Effectiveness of <math id="A3.T10.1.1.1.1.1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="A3.T10.1.1.1.1.1.m1.1a"><mi id="A3.T10.1.1.1.1.1.m1.1.1" xref="A3.T10.1.1.1.1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A3.T10.1.1.1.1.1.m1.1b"><ci id="A3.T10.1.1.1.1.1.m1.1.1.cmml" xref="A3.T10.1.1.1.1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.1.1.1.1.1.m1.1c">q</annotation></semantics></math>, ROC AUC <math id="A3.T10.2.2.2.2.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A3.T10.2.2.2.2.2.m2.1a"><mo stretchy="false" id="A3.T10.2.2.2.2.2.m2.1.1" xref="A3.T10.2.2.2.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A3.T10.2.2.2.2.2.m2.1b"><ci id="A3.T10.2.2.2.2.2.m2.1.1.cmml" xref="A3.T10.2.2.2.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.2.2.2.2.2.m2.1c">\uparrow</annotation></semantics></math>
</td>
</tr>
<tr id="A3.T10.11.11.11.11" class="ltx_tr">
<td id="A3.T10.3.3.3.3.1" class="ltx_td ltx_align_center ltx_border_t">
<math id="A3.T10.3.3.3.3.1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="A3.T10.3.3.3.3.1.m1.1a"><mi id="A3.T10.3.3.3.3.1.m1.1.1" xref="A3.T10.3.3.3.3.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A3.T10.3.3.3.3.1.m1.1b"><ci id="A3.T10.3.3.3.3.1.m1.1.1.cmml" xref="A3.T10.3.3.3.3.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.3.3.3.3.1.m1.1c">q</annotation></semantics></math> =1.0</td>
<td id="A3.T10.5.5.5.5.3" class="ltx_td ltx_align_center ltx_border_t">
<math id="A3.T10.4.4.4.4.2.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="A3.T10.4.4.4.4.2.m1.1a"><mi id="A3.T10.4.4.4.4.2.m1.1.1" xref="A3.T10.4.4.4.4.2.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A3.T10.4.4.4.4.2.m1.1b"><ci id="A3.T10.4.4.4.4.2.m1.1.1.cmml" xref="A3.T10.4.4.4.4.2.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.4.4.4.4.2.m1.1c">q</annotation></semantics></math> = <math id="A3.T10.5.5.5.5.3.m2.1" class="ltx_Math" alttext="1e^{-1}" display="inline"><semantics id="A3.T10.5.5.5.5.3.m2.1a"><mrow id="A3.T10.5.5.5.5.3.m2.1.1" xref="A3.T10.5.5.5.5.3.m2.1.1.cmml"><mn id="A3.T10.5.5.5.5.3.m2.1.1.2" xref="A3.T10.5.5.5.5.3.m2.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A3.T10.5.5.5.5.3.m2.1.1.1" xref="A3.T10.5.5.5.5.3.m2.1.1.1.cmml">​</mo><msup id="A3.T10.5.5.5.5.3.m2.1.1.3" xref="A3.T10.5.5.5.5.3.m2.1.1.3.cmml"><mi id="A3.T10.5.5.5.5.3.m2.1.1.3.2" xref="A3.T10.5.5.5.5.3.m2.1.1.3.2.cmml">e</mi><mrow id="A3.T10.5.5.5.5.3.m2.1.1.3.3" xref="A3.T10.5.5.5.5.3.m2.1.1.3.3.cmml"><mo id="A3.T10.5.5.5.5.3.m2.1.1.3.3a" xref="A3.T10.5.5.5.5.3.m2.1.1.3.3.cmml">−</mo><mn id="A3.T10.5.5.5.5.3.m2.1.1.3.3.2" xref="A3.T10.5.5.5.5.3.m2.1.1.3.3.2.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T10.5.5.5.5.3.m2.1b"><apply id="A3.T10.5.5.5.5.3.m2.1.1.cmml" xref="A3.T10.5.5.5.5.3.m2.1.1"><times id="A3.T10.5.5.5.5.3.m2.1.1.1.cmml" xref="A3.T10.5.5.5.5.3.m2.1.1.1"></times><cn type="integer" id="A3.T10.5.5.5.5.3.m2.1.1.2.cmml" xref="A3.T10.5.5.5.5.3.m2.1.1.2">1</cn><apply id="A3.T10.5.5.5.5.3.m2.1.1.3.cmml" xref="A3.T10.5.5.5.5.3.m2.1.1.3"><csymbol cd="ambiguous" id="A3.T10.5.5.5.5.3.m2.1.1.3.1.cmml" xref="A3.T10.5.5.5.5.3.m2.1.1.3">superscript</csymbol><ci id="A3.T10.5.5.5.5.3.m2.1.1.3.2.cmml" xref="A3.T10.5.5.5.5.3.m2.1.1.3.2">𝑒</ci><apply id="A3.T10.5.5.5.5.3.m2.1.1.3.3.cmml" xref="A3.T10.5.5.5.5.3.m2.1.1.3.3"><minus id="A3.T10.5.5.5.5.3.m2.1.1.3.3.1.cmml" xref="A3.T10.5.5.5.5.3.m2.1.1.3.3"></minus><cn type="integer" id="A3.T10.5.5.5.5.3.m2.1.1.3.3.2.cmml" xref="A3.T10.5.5.5.5.3.m2.1.1.3.3.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.5.5.5.5.3.m2.1c">1e^{-1}</annotation></semantics></math>
</td>
<td id="A3.T10.7.7.7.7.5" class="ltx_td ltx_align_center ltx_border_t">
<math id="A3.T10.6.6.6.6.4.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="A3.T10.6.6.6.6.4.m1.1a"><mi id="A3.T10.6.6.6.6.4.m1.1.1" xref="A3.T10.6.6.6.6.4.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A3.T10.6.6.6.6.4.m1.1b"><ci id="A3.T10.6.6.6.6.4.m1.1.1.cmml" xref="A3.T10.6.6.6.6.4.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.6.6.6.6.4.m1.1c">q</annotation></semantics></math> = <math id="A3.T10.7.7.7.7.5.m2.1" class="ltx_Math" alttext="1e^{-2}" display="inline"><semantics id="A3.T10.7.7.7.7.5.m2.1a"><mrow id="A3.T10.7.7.7.7.5.m2.1.1" xref="A3.T10.7.7.7.7.5.m2.1.1.cmml"><mn id="A3.T10.7.7.7.7.5.m2.1.1.2" xref="A3.T10.7.7.7.7.5.m2.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A3.T10.7.7.7.7.5.m2.1.1.1" xref="A3.T10.7.7.7.7.5.m2.1.1.1.cmml">​</mo><msup id="A3.T10.7.7.7.7.5.m2.1.1.3" xref="A3.T10.7.7.7.7.5.m2.1.1.3.cmml"><mi id="A3.T10.7.7.7.7.5.m2.1.1.3.2" xref="A3.T10.7.7.7.7.5.m2.1.1.3.2.cmml">e</mi><mrow id="A3.T10.7.7.7.7.5.m2.1.1.3.3" xref="A3.T10.7.7.7.7.5.m2.1.1.3.3.cmml"><mo id="A3.T10.7.7.7.7.5.m2.1.1.3.3a" xref="A3.T10.7.7.7.7.5.m2.1.1.3.3.cmml">−</mo><mn id="A3.T10.7.7.7.7.5.m2.1.1.3.3.2" xref="A3.T10.7.7.7.7.5.m2.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T10.7.7.7.7.5.m2.1b"><apply id="A3.T10.7.7.7.7.5.m2.1.1.cmml" xref="A3.T10.7.7.7.7.5.m2.1.1"><times id="A3.T10.7.7.7.7.5.m2.1.1.1.cmml" xref="A3.T10.7.7.7.7.5.m2.1.1.1"></times><cn type="integer" id="A3.T10.7.7.7.7.5.m2.1.1.2.cmml" xref="A3.T10.7.7.7.7.5.m2.1.1.2">1</cn><apply id="A3.T10.7.7.7.7.5.m2.1.1.3.cmml" xref="A3.T10.7.7.7.7.5.m2.1.1.3"><csymbol cd="ambiguous" id="A3.T10.7.7.7.7.5.m2.1.1.3.1.cmml" xref="A3.T10.7.7.7.7.5.m2.1.1.3">superscript</csymbol><ci id="A3.T10.7.7.7.7.5.m2.1.1.3.2.cmml" xref="A3.T10.7.7.7.7.5.m2.1.1.3.2">𝑒</ci><apply id="A3.T10.7.7.7.7.5.m2.1.1.3.3.cmml" xref="A3.T10.7.7.7.7.5.m2.1.1.3.3"><minus id="A3.T10.7.7.7.7.5.m2.1.1.3.3.1.cmml" xref="A3.T10.7.7.7.7.5.m2.1.1.3.3"></minus><cn type="integer" id="A3.T10.7.7.7.7.5.m2.1.1.3.3.2.cmml" xref="A3.T10.7.7.7.7.5.m2.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.7.7.7.7.5.m2.1c">1e^{-2}</annotation></semantics></math>
</td>
<td id="A3.T10.9.9.9.9.7" class="ltx_td ltx_align_center ltx_border_t">
<math id="A3.T10.8.8.8.8.6.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="A3.T10.8.8.8.8.6.m1.1a"><mi id="A3.T10.8.8.8.8.6.m1.1.1" xref="A3.T10.8.8.8.8.6.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A3.T10.8.8.8.8.6.m1.1b"><ci id="A3.T10.8.8.8.8.6.m1.1.1.cmml" xref="A3.T10.8.8.8.8.6.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.8.8.8.8.6.m1.1c">q</annotation></semantics></math> = <math id="A3.T10.9.9.9.9.7.m2.1" class="ltx_Math" alttext="1e^{-3}" display="inline"><semantics id="A3.T10.9.9.9.9.7.m2.1a"><mrow id="A3.T10.9.9.9.9.7.m2.1.1" xref="A3.T10.9.9.9.9.7.m2.1.1.cmml"><mn id="A3.T10.9.9.9.9.7.m2.1.1.2" xref="A3.T10.9.9.9.9.7.m2.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A3.T10.9.9.9.9.7.m2.1.1.1" xref="A3.T10.9.9.9.9.7.m2.1.1.1.cmml">​</mo><msup id="A3.T10.9.9.9.9.7.m2.1.1.3" xref="A3.T10.9.9.9.9.7.m2.1.1.3.cmml"><mi id="A3.T10.9.9.9.9.7.m2.1.1.3.2" xref="A3.T10.9.9.9.9.7.m2.1.1.3.2.cmml">e</mi><mrow id="A3.T10.9.9.9.9.7.m2.1.1.3.3" xref="A3.T10.9.9.9.9.7.m2.1.1.3.3.cmml"><mo id="A3.T10.9.9.9.9.7.m2.1.1.3.3a" xref="A3.T10.9.9.9.9.7.m2.1.1.3.3.cmml">−</mo><mn id="A3.T10.9.9.9.9.7.m2.1.1.3.3.2" xref="A3.T10.9.9.9.9.7.m2.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T10.9.9.9.9.7.m2.1b"><apply id="A3.T10.9.9.9.9.7.m2.1.1.cmml" xref="A3.T10.9.9.9.9.7.m2.1.1"><times id="A3.T10.9.9.9.9.7.m2.1.1.1.cmml" xref="A3.T10.9.9.9.9.7.m2.1.1.1"></times><cn type="integer" id="A3.T10.9.9.9.9.7.m2.1.1.2.cmml" xref="A3.T10.9.9.9.9.7.m2.1.1.2">1</cn><apply id="A3.T10.9.9.9.9.7.m2.1.1.3.cmml" xref="A3.T10.9.9.9.9.7.m2.1.1.3"><csymbol cd="ambiguous" id="A3.T10.9.9.9.9.7.m2.1.1.3.1.cmml" xref="A3.T10.9.9.9.9.7.m2.1.1.3">superscript</csymbol><ci id="A3.T10.9.9.9.9.7.m2.1.1.3.2.cmml" xref="A3.T10.9.9.9.9.7.m2.1.1.3.2">𝑒</ci><apply id="A3.T10.9.9.9.9.7.m2.1.1.3.3.cmml" xref="A3.T10.9.9.9.9.7.m2.1.1.3.3"><minus id="A3.T10.9.9.9.9.7.m2.1.1.3.3.1.cmml" xref="A3.T10.9.9.9.9.7.m2.1.1.3.3"></minus><cn type="integer" id="A3.T10.9.9.9.9.7.m2.1.1.3.3.2.cmml" xref="A3.T10.9.9.9.9.7.m2.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.9.9.9.9.7.m2.1c">1e^{-3}</annotation></semantics></math>
</td>
<td id="A3.T10.11.11.11.11.9" class="ltx_td ltx_align_center ltx_border_t">
<math id="A3.T10.10.10.10.10.8.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="A3.T10.10.10.10.10.8.m1.1a"><mi id="A3.T10.10.10.10.10.8.m1.1.1" xref="A3.T10.10.10.10.10.8.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A3.T10.10.10.10.10.8.m1.1b"><ci id="A3.T10.10.10.10.10.8.m1.1.1.cmml" xref="A3.T10.10.10.10.10.8.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.10.10.10.10.8.m1.1c">q</annotation></semantics></math> = <math id="A3.T10.11.11.11.11.9.m2.1" class="ltx_Math" alttext="1e^{-4}" display="inline"><semantics id="A3.T10.11.11.11.11.9.m2.1a"><mrow id="A3.T10.11.11.11.11.9.m2.1.1" xref="A3.T10.11.11.11.11.9.m2.1.1.cmml"><mn id="A3.T10.11.11.11.11.9.m2.1.1.2" xref="A3.T10.11.11.11.11.9.m2.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A3.T10.11.11.11.11.9.m2.1.1.1" xref="A3.T10.11.11.11.11.9.m2.1.1.1.cmml">​</mo><msup id="A3.T10.11.11.11.11.9.m2.1.1.3" xref="A3.T10.11.11.11.11.9.m2.1.1.3.cmml"><mi id="A3.T10.11.11.11.11.9.m2.1.1.3.2" xref="A3.T10.11.11.11.11.9.m2.1.1.3.2.cmml">e</mi><mrow id="A3.T10.11.11.11.11.9.m2.1.1.3.3" xref="A3.T10.11.11.11.11.9.m2.1.1.3.3.cmml"><mo id="A3.T10.11.11.11.11.9.m2.1.1.3.3a" xref="A3.T10.11.11.11.11.9.m2.1.1.3.3.cmml">−</mo><mn id="A3.T10.11.11.11.11.9.m2.1.1.3.3.2" xref="A3.T10.11.11.11.11.9.m2.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T10.11.11.11.11.9.m2.1b"><apply id="A3.T10.11.11.11.11.9.m2.1.1.cmml" xref="A3.T10.11.11.11.11.9.m2.1.1"><times id="A3.T10.11.11.11.11.9.m2.1.1.1.cmml" xref="A3.T10.11.11.11.11.9.m2.1.1.1"></times><cn type="integer" id="A3.T10.11.11.11.11.9.m2.1.1.2.cmml" xref="A3.T10.11.11.11.11.9.m2.1.1.2">1</cn><apply id="A3.T10.11.11.11.11.9.m2.1.1.3.cmml" xref="A3.T10.11.11.11.11.9.m2.1.1.3"><csymbol cd="ambiguous" id="A3.T10.11.11.11.11.9.m2.1.1.3.1.cmml" xref="A3.T10.11.11.11.11.9.m2.1.1.3">superscript</csymbol><ci id="A3.T10.11.11.11.11.9.m2.1.1.3.2.cmml" xref="A3.T10.11.11.11.11.9.m2.1.1.3.2">𝑒</ci><apply id="A3.T10.11.11.11.11.9.m2.1.1.3.3.cmml" xref="A3.T10.11.11.11.11.9.m2.1.1.3.3"><minus id="A3.T10.11.11.11.11.9.m2.1.1.3.3.1.cmml" xref="A3.T10.11.11.11.11.9.m2.1.1.3.3"></minus><cn type="integer" id="A3.T10.11.11.11.11.9.m2.1.1.3.3.2.cmml" xref="A3.T10.11.11.11.11.9.m2.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.11.11.11.11.9.m2.1c">1e^{-4}</annotation></semantics></math>
</td>
</tr>
<tr id="A3.T10.15.15.15.16.1" class="ltx_tr">
<td id="A3.T10.15.15.15.16.1.1" class="ltx_td ltx_align_center ltx_border_t">57.91</td>
<td id="A3.T10.15.15.15.16.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="A3.T10.15.15.15.16.1.2.1" class="ltx_text ltx_font_bold">58.31</span></td>
<td id="A3.T10.15.15.15.16.1.3" class="ltx_td ltx_align_center ltx_border_t">57.43</td>
<td id="A3.T10.15.15.15.16.1.4" class="ltx_td ltx_align_center ltx_border_t">57.36</td>
<td id="A3.T10.15.15.15.16.1.5" class="ltx_td ltx_align_center ltx_border_t">57.29</td>
</tr>
<tr id="A3.T10.12.12.12.12" class="ltx_tr">
<td id="A3.T10.12.12.12.12.1" class="ltx_td ltx_align_center ltx_border_tt" colspan="5">Effectiveness of centrality, ROC AUC <math id="A3.T10.12.12.12.12.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A3.T10.12.12.12.12.1.m1.1a"><mo stretchy="false" id="A3.T10.12.12.12.12.1.m1.1.1" xref="A3.T10.12.12.12.12.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A3.T10.12.12.12.12.1.m1.1b"><ci id="A3.T10.12.12.12.12.1.m1.1.1.cmml" xref="A3.T10.12.12.12.12.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.12.12.12.12.1.m1.1c">\uparrow</annotation></semantics></math>
</td>
</tr>
<tr id="A3.T10.15.15.15.17.2" class="ltx_tr">
<td id="A3.T10.15.15.15.17.2.1" class="ltx_td ltx_align_center ltx_border_t">Betweenness</td>
<td id="A3.T10.15.15.15.17.2.2" class="ltx_td ltx_align_center ltx_border_t">Degree</td>
<td id="A3.T10.15.15.15.17.2.3" class="ltx_td ltx_align_center ltx_border_t">Closeness</td>
<td id="A3.T10.15.15.15.17.2.4" class="ltx_td ltx_align_center ltx_border_t">Eigenvector</td>
<td id="A3.T10.15.15.15.17.2.5" class="ltx_td ltx_align_center ltx_border_t">Current flow</td>
</tr>
<tr id="A3.T10.15.15.15.18.3" class="ltx_tr">
<td id="A3.T10.15.15.15.18.3.1" class="ltx_td ltx_align_center ltx_border_t"><span id="A3.T10.15.15.15.18.3.1.1" class="ltx_text ltx_font_bold">58.28</span></td>
<td id="A3.T10.15.15.15.18.3.2" class="ltx_td ltx_align_center ltx_border_t">57.69</td>
<td id="A3.T10.15.15.15.18.3.3" class="ltx_td ltx_align_center ltx_border_t">57.86</td>
<td id="A3.T10.15.15.15.18.3.4" class="ltx_td ltx_align_center ltx_border_t">57.57</td>
<td id="A3.T10.15.15.15.18.3.5" class="ltx_td ltx_align_center ltx_border_t">57.83</td>
</tr>
<tr id="A3.T10.13.13.13.13" class="ltx_tr">
<td id="A3.T10.13.13.13.13.1" class="ltx_td ltx_align_center ltx_border_t" colspan="5">Effectiveness of similarity measure, Accuracy <math id="A3.T10.13.13.13.13.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A3.T10.13.13.13.13.1.m1.1a"><mo stretchy="false" id="A3.T10.13.13.13.13.1.m1.1.1" xref="A3.T10.13.13.13.13.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A3.T10.13.13.13.13.1.m1.1b"><ci id="A3.T10.13.13.13.13.1.m1.1.1.cmml" xref="A3.T10.13.13.13.13.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.13.13.13.13.1.m1.1c">\uparrow</annotation></semantics></math>
</td>
</tr>
<tr id="A3.T10.15.15.15.15" class="ltx_tr">
<td id="A3.T10.15.15.15.15.3" class="ltx_td ltx_border_tt"></td>
<td id="A3.T10.14.14.14.14.1" class="ltx_td ltx_align_center ltx_border_tt"><math id="A3.T10.14.14.14.14.1.m1.1" class="ltx_Math" alttext="\ell_{1}" display="inline"><semantics id="A3.T10.14.14.14.14.1.m1.1a"><msub id="A3.T10.14.14.14.14.1.m1.1.1" xref="A3.T10.14.14.14.14.1.m1.1.1.cmml"><mi mathvariant="normal" id="A3.T10.14.14.14.14.1.m1.1.1.2" xref="A3.T10.14.14.14.14.1.m1.1.1.2.cmml">ℓ</mi><mn id="A3.T10.14.14.14.14.1.m1.1.1.3" xref="A3.T10.14.14.14.14.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A3.T10.14.14.14.14.1.m1.1b"><apply id="A3.T10.14.14.14.14.1.m1.1.1.cmml" xref="A3.T10.14.14.14.14.1.m1.1.1"><csymbol cd="ambiguous" id="A3.T10.14.14.14.14.1.m1.1.1.1.cmml" xref="A3.T10.14.14.14.14.1.m1.1.1">subscript</csymbol><ci id="A3.T10.14.14.14.14.1.m1.1.1.2.cmml" xref="A3.T10.14.14.14.14.1.m1.1.1.2">ℓ</ci><cn type="integer" id="A3.T10.14.14.14.14.1.m1.1.1.3.cmml" xref="A3.T10.14.14.14.14.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.14.14.14.14.1.m1.1c">\ell_{1}</annotation></semantics></math></td>
<td id="A3.T10.15.15.15.15.2" class="ltx_td ltx_align_center ltx_border_tt"><math id="A3.T10.15.15.15.15.2.m1.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="A3.T10.15.15.15.15.2.m1.1a"><msub id="A3.T10.15.15.15.15.2.m1.1.1" xref="A3.T10.15.15.15.15.2.m1.1.1.cmml"><mi mathvariant="normal" id="A3.T10.15.15.15.15.2.m1.1.1.2" xref="A3.T10.15.15.15.15.2.m1.1.1.2.cmml">ℓ</mi><mn id="A3.T10.15.15.15.15.2.m1.1.1.3" xref="A3.T10.15.15.15.15.2.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A3.T10.15.15.15.15.2.m1.1b"><apply id="A3.T10.15.15.15.15.2.m1.1.1.cmml" xref="A3.T10.15.15.15.15.2.m1.1.1"><csymbol cd="ambiguous" id="A3.T10.15.15.15.15.2.m1.1.1.1.cmml" xref="A3.T10.15.15.15.15.2.m1.1.1">subscript</csymbol><ci id="A3.T10.15.15.15.15.2.m1.1.1.2.cmml" xref="A3.T10.15.15.15.15.2.m1.1.1.2">ℓ</ci><cn type="integer" id="A3.T10.15.15.15.15.2.m1.1.1.3.cmml" xref="A3.T10.15.15.15.15.2.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.15.15.15.15.2.m1.1c">\ell_{2}</annotation></semantics></math></td>
<td id="A3.T10.15.15.15.15.4" class="ltx_td ltx_align_center ltx_border_tt">dot produt</td>
<td id="A3.T10.15.15.15.15.5" class="ltx_td ltx_align_center ltx_border_tt">cosin</td>
</tr>
<tr id="A3.T10.15.15.15.19.4" class="ltx_tr">
<td id="A3.T10.15.15.15.19.4.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">OOF Accuracy</td>
<td id="A3.T10.15.15.15.19.4.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">58.11</td>
<td id="A3.T10.15.15.15.19.4.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">58.26</td>
<td id="A3.T10.15.15.15.19.4.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">59.14</td>
<td id="A3.T10.15.15.15.19.4.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">58.52</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="A3.p1" class="ltx_para">
<p id="A3.p1.3" class="ltx_p"><span id="A3.p1.1.1" class="ltx_text ltx_font_bold">Hyperparameter <math id="A3.p1.1.1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="A3.p1.1.1.m1.1a"><mi id="A3.p1.1.1.m1.1.1" xref="A3.p1.1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A3.p1.1.1.m1.1b"><ci id="A3.p1.1.1.m1.1.1.cmml" xref="A3.p1.1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.1.m1.1c">q</annotation></semantics></math>.</span> We investigate the impact of hyperparameter <math id="A3.p1.2.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="A3.p1.2.m1.1a"><mi id="A3.p1.2.m1.1.1" xref="A3.p1.2.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="A3.p1.2.m1.1b"><ci id="A3.p1.2.m1.1.1.cmml" xref="A3.p1.2.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.2.m1.1c">\eta</annotation></semantics></math> on eICU. Our findings demonstrate that setting <math id="A3.p1.3.m2.1" class="ltx_Math" alttext="q=0.1" display="inline"><semantics id="A3.p1.3.m2.1a"><mrow id="A3.p1.3.m2.1.1" xref="A3.p1.3.m2.1.1.cmml"><mi id="A3.p1.3.m2.1.1.2" xref="A3.p1.3.m2.1.1.2.cmml">q</mi><mo id="A3.p1.3.m2.1.1.1" xref="A3.p1.3.m2.1.1.1.cmml">=</mo><mn id="A3.p1.3.m2.1.1.3" xref="A3.p1.3.m2.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.3.m2.1b"><apply id="A3.p1.3.m2.1.1.cmml" xref="A3.p1.3.m2.1.1"><eq id="A3.p1.3.m2.1.1.1.cmml" xref="A3.p1.3.m2.1.1.1"></eq><ci id="A3.p1.3.m2.1.1.2.cmml" xref="A3.p1.3.m2.1.1.2">𝑞</ci><cn type="float" id="A3.p1.3.m2.1.1.3.cmml" xref="A3.p1.3.m2.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.3.m2.1c">q=0.1</annotation></semantics></math> yields the best results.
<span id="A3.p1.3.2" class="ltx_text ltx_font_bold">Centrality.</span> We employed betweenness centrality to derive the topological prior. However, it is worth noting that other types of centrality, such as degree <cite class="ltx_cite ltx_citemacro_citep">(Freeman et al., <a href="#bib.bib12" title="" class="ltx_ref">2002</a>)</cite> and closeness <cite class="ltx_cite ltx_citemacro_citep">(Bavelas, <a href="#bib.bib2" title="" class="ltx_ref">1950</a>)</cite>, could also be utilized. We conducted experiments on eICU to verify the impact of different centrality measures on TFL. Our findings indicate that betweenness centrality produces the best result. <span id="A3.p1.3.3" class="ltx_text ltx_font_bold">Similarity metrics.</span> We investigate how the model performs under different similarity metrics on PACS. We found that the dot product-based metric produces the best results.</p>
</div>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Implementation Details</h2>

<div id="A4.p1" class="ltx_para">
<p id="A4.p1.34" class="ltx_p"><span id="A4.p1.34.1" class="ltx_text ltx_font_bold">Experiment settings and evaluation metrics.</span> For the <span id="A4.p1.34.2" class="ltx_text ltx_font_bold">PACS dataset</span>, we evenly split each domain into <math id="A4.p1.1.m1.1" class="ltx_Math" alttext="5" display="inline"><semantics id="A4.p1.1.m1.1a"><mn id="A4.p1.1.m1.1.1" xref="A4.p1.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A4.p1.1.m1.1b"><cn type="integer" id="A4.p1.1.m1.1.1.cmml" xref="A4.p1.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.1.m1.1c">5</annotation></semantics></math> subsets, yielding <math id="A4.p1.2.m2.1" class="ltx_Math" alttext="20" display="inline"><semantics id="A4.p1.2.m2.1a"><mn id="A4.p1.2.m2.1.1" xref="A4.p1.2.m2.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="A4.p1.2.m2.1b"><cn type="integer" id="A4.p1.2.m2.1.1.cmml" xref="A4.p1.2.m2.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.2.m2.1c">20</annotation></semantics></math> subsets, and we treat each subset as a client. We followed the common “leave-one-domain-out” experiment, where <math id="A4.p1.3.m3.1" class="ltx_Math" alttext="3" display="inline"><semantics id="A4.p1.3.m3.1a"><mn id="A4.p1.3.m3.1.1" xref="A4.p1.3.m3.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="A4.p1.3.m3.1b"><cn type="integer" id="A4.p1.3.m3.1.1.cmml" xref="A4.p1.3.m3.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.3.m3.1c">3</annotation></semantics></math> domains are used (<math id="A4.p1.4.m4.1" class="ltx_Math" alttext="15" display="inline"><semantics id="A4.p1.4.m4.1a"><mn id="A4.p1.4.m4.1.1" xref="A4.p1.4.m4.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="A4.p1.4.m4.1b"><cn type="integer" id="A4.p1.4.m4.1.1.cmml" xref="A4.p1.4.m4.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.4.m4.1c">15</annotation></semantics></math> clients) for training and <math id="A4.p1.5.m5.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A4.p1.5.m5.1a"><mn id="A4.p1.5.m5.1.1" xref="A4.p1.5.m5.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A4.p1.5.m5.1b"><cn type="integer" id="A4.p1.5.m5.1.1.cmml" xref="A4.p1.5.m5.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.5.m5.1c">1</annotation></semantics></math> domain (<math id="A4.p1.6.m6.1" class="ltx_Math" alttext="5" display="inline"><semantics id="A4.p1.6.m6.1a"><mn id="A4.p1.6.m6.1.1" xref="A4.p1.6.m6.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A4.p1.6.m6.1b"><cn type="integer" id="A4.p1.6.m6.1.1.cmml" xref="A4.p1.6.m6.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.6.m6.1c">5</annotation></semantics></math> clients) for testing. We evaluated the model’s performance using classification accuracy.
We use ResNet18 <cite class="ltx_cite ltx_citemacro_citep">(He et al., <a href="#bib.bib13" title="" class="ltx_ref">2016</a>)</cite> as our model and train the model for <math id="A4.p1.7.m7.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A4.p1.7.m7.1a"><mn id="A4.p1.7.m7.1.1" xref="A4.p1.7.m7.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A4.p1.7.m7.1b"><cn type="integer" id="A4.p1.7.m7.1.1.cmml" xref="A4.p1.7.m7.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.7.m7.1c">100</annotation></semantics></math> communication rounds. Each local client optimized the model using stochastic gradient descent (SGD) with a learning rate of <math id="A4.p1.8.m8.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="A4.p1.8.m8.1a"><mn id="A4.p1.8.m8.1.1" xref="A4.p1.8.m8.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="A4.p1.8.m8.1b"><cn type="float" id="A4.p1.8.m8.1.1.cmml" xref="A4.p1.8.m8.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.8.m8.1c">0.01</annotation></semantics></math>, momentum of <math id="A4.p1.9.m9.1" class="ltx_Math" alttext="0.9" display="inline"><semantics id="A4.p1.9.m9.1a"><mn id="A4.p1.9.m9.1.1" xref="A4.p1.9.m9.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="A4.p1.9.m9.1b"><cn type="float" id="A4.p1.9.m9.1.1.cmml" xref="A4.p1.9.m9.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.9.m9.1c">0.9</annotation></semantics></math>, weight decay of <math id="A4.p1.10.m10.1" class="ltx_Math" alttext="5e^{-4}" display="inline"><semantics id="A4.p1.10.m10.1a"><mrow id="A4.p1.10.m10.1.1" xref="A4.p1.10.m10.1.1.cmml"><mn id="A4.p1.10.m10.1.1.2" xref="A4.p1.10.m10.1.1.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="A4.p1.10.m10.1.1.1" xref="A4.p1.10.m10.1.1.1.cmml">​</mo><msup id="A4.p1.10.m10.1.1.3" xref="A4.p1.10.m10.1.1.3.cmml"><mi id="A4.p1.10.m10.1.1.3.2" xref="A4.p1.10.m10.1.1.3.2.cmml">e</mi><mrow id="A4.p1.10.m10.1.1.3.3" xref="A4.p1.10.m10.1.1.3.3.cmml"><mo id="A4.p1.10.m10.1.1.3.3a" xref="A4.p1.10.m10.1.1.3.3.cmml">−</mo><mn id="A4.p1.10.m10.1.1.3.3.2" xref="A4.p1.10.m10.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.10.m10.1b"><apply id="A4.p1.10.m10.1.1.cmml" xref="A4.p1.10.m10.1.1"><times id="A4.p1.10.m10.1.1.1.cmml" xref="A4.p1.10.m10.1.1.1"></times><cn type="integer" id="A4.p1.10.m10.1.1.2.cmml" xref="A4.p1.10.m10.1.1.2">5</cn><apply id="A4.p1.10.m10.1.1.3.cmml" xref="A4.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="A4.p1.10.m10.1.1.3.1.cmml" xref="A4.p1.10.m10.1.1.3">superscript</csymbol><ci id="A4.p1.10.m10.1.1.3.2.cmml" xref="A4.p1.10.m10.1.1.3.2">𝑒</ci><apply id="A4.p1.10.m10.1.1.3.3.cmml" xref="A4.p1.10.m10.1.1.3.3"><minus id="A4.p1.10.m10.1.1.3.3.1.cmml" xref="A4.p1.10.m10.1.1.3.3"></minus><cn type="integer" id="A4.p1.10.m10.1.1.3.3.2.cmml" xref="A4.p1.10.m10.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.10.m10.1c">5e^{-4}</annotation></semantics></math>, and a batch size of <math id="A4.p1.11.m11.1" class="ltx_Math" alttext="8" display="inline"><semantics id="A4.p1.11.m11.1a"><mn id="A4.p1.11.m11.1.1" xref="A4.p1.11.m11.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A4.p1.11.m11.1b"><cn type="integer" id="A4.p1.11.m11.1.1.cmml" xref="A4.p1.11.m11.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.11.m11.1c">8</annotation></semantics></math>.
For <span id="A4.p1.34.3" class="ltx_text ltx_font_bold">CIFAR-10/100</span>,
we adopt the same model architecture as FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib32" title="" class="ltx_ref">2017</a>)</cite>. The model has 2 convolution layers with <math id="A4.p1.12.m12.1" class="ltx_Math" alttext="32" display="inline"><semantics id="A4.p1.12.m12.1a"><mn id="A4.p1.12.m12.1.1" xref="A4.p1.12.m12.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A4.p1.12.m12.1b"><cn type="integer" id="A4.p1.12.m12.1.1.cmml" xref="A4.p1.12.m12.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.12.m12.1c">32</annotation></semantics></math>, <math id="A4.p1.13.m13.1" class="ltx_Math" alttext="64" display="inline"><semantics id="A4.p1.13.m13.1a"><mn id="A4.p1.13.m13.1.1" xref="A4.p1.13.m13.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="A4.p1.13.m13.1b"><cn type="integer" id="A4.p1.13.m13.1.1.cmml" xref="A4.p1.13.m13.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.13.m13.1c">64</annotation></semantics></math> <math id="A4.p1.14.m14.1" class="ltx_Math" alttext="5\times 5" display="inline"><semantics id="A4.p1.14.m14.1a"><mrow id="A4.p1.14.m14.1.1" xref="A4.p1.14.m14.1.1.cmml"><mn id="A4.p1.14.m14.1.1.2" xref="A4.p1.14.m14.1.1.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="A4.p1.14.m14.1.1.1" xref="A4.p1.14.m14.1.1.1.cmml">×</mo><mn id="A4.p1.14.m14.1.1.3" xref="A4.p1.14.m14.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.14.m14.1b"><apply id="A4.p1.14.m14.1.1.cmml" xref="A4.p1.14.m14.1.1"><times id="A4.p1.14.m14.1.1.1.cmml" xref="A4.p1.14.m14.1.1.1"></times><cn type="integer" id="A4.p1.14.m14.1.1.2.cmml" xref="A4.p1.14.m14.1.1.2">5</cn><cn type="integer" id="A4.p1.14.m14.1.1.3.cmml" xref="A4.p1.14.m14.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.14.m14.1c">5\times 5</annotation></semantics></math> kernels, and <math id="A4.p1.15.m15.1" class="ltx_Math" alttext="2" display="inline"><semantics id="A4.p1.15.m15.1a"><mn id="A4.p1.15.m15.1.1" xref="A4.p1.15.m15.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="A4.p1.15.m15.1b"><cn type="integer" id="A4.p1.15.m15.1.1.cmml" xref="A4.p1.15.m15.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.15.m15.1c">2</annotation></semantics></math> fully connected layers with <math id="A4.p1.16.m16.1" class="ltx_Math" alttext="512" display="inline"><semantics id="A4.p1.16.m16.1a"><mn id="A4.p1.16.m16.1.1" xref="A4.p1.16.m16.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="A4.p1.16.m16.1b"><cn type="integer" id="A4.p1.16.m16.1.1.cmml" xref="A4.p1.16.m16.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.16.m16.1c">512</annotation></semantics></math> hidden units.
we use Dirichlet distribution <cite class="ltx_cite ltx_citemacro_citep">(Hsu et al., <a href="#bib.bib14" title="" class="ltx_ref">2019</a>)</cite> to partition the dataset into the heterogeneous setting with <math id="A4.p1.17.m17.1" class="ltx_Math" alttext="25" display="inline"><semantics id="A4.p1.17.m17.1a"><mn id="A4.p1.17.m17.1.1" xref="A4.p1.17.m17.1.1.cmml">25</mn><annotation-xml encoding="MathML-Content" id="A4.p1.17.m17.1b"><cn type="integer" id="A4.p1.17.m17.1.1.cmml" xref="A4.p1.17.m17.1.1">25</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.17.m17.1c">25</annotation></semantics></math> and <math id="A4.p1.18.m18.1" class="ltx_Math" alttext="50" display="inline"><semantics id="A4.p1.18.m18.1a"><mn id="A4.p1.18.m18.1.1" xref="A4.p1.18.m18.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="A4.p1.18.m18.1b"><cn type="integer" id="A4.p1.18.m18.1.1.cmml" xref="A4.p1.18.m18.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.18.m18.1c">50</annotation></semantics></math> clients.
For <span id="A4.p1.34.4" class="ltx_text ltx_font_bold">eICU</span>, we treat each hospital as a client. We use a network of three fully connected layers. This architecture is similar to <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib16" title="" class="ltx_ref">2019</a>; Ma et al., <a href="#bib.bib29" title="" class="ltx_ref">2021</a>; Sheikhalishahi et al., <a href="#bib.bib53" title="" class="ltx_ref">2020</a>)</cite>.
We train our model for <math id="A4.p1.19.m19.1" class="ltx_Math" alttext="30" display="inline"><semantics id="A4.p1.19.m19.1a"><mn id="A4.p1.19.m19.1.1" xref="A4.p1.19.m19.1.1.cmml">30</mn><annotation-xml encoding="MathML-Content" id="A4.p1.19.m19.1b"><cn type="integer" id="A4.p1.19.m19.1.1.cmml" xref="A4.p1.19.m19.1.1">30</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.19.m19.1c">30</annotation></semantics></math> communication rounds, using a batch size of <math id="A4.p1.20.m20.1" class="ltx_Math" alttext="64" display="inline"><semantics id="A4.p1.20.m20.1a"><mn id="A4.p1.20.m20.1.1" xref="A4.p1.20.m20.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="A4.p1.20.m20.1b"><cn type="integer" id="A4.p1.20.m20.1.1.cmml" xref="A4.p1.20.m20.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.20.m20.1c">64</annotation></semantics></math> and a learning rate of <math id="A4.p1.21.m21.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="A4.p1.21.m21.1a"><mn id="A4.p1.21.m21.1.1" xref="A4.p1.21.m21.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="A4.p1.21.m21.1b"><cn type="float" id="A4.p1.21.m21.1.1.cmml" xref="A4.p1.21.m21.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.21.m21.1c">0.01</annotation></semantics></math>, and report the performance on unseen hospitals. Within each communication round, clients perform <math id="A4.p1.22.m22.1" class="ltx_Math" alttext="5" display="inline"><semantics id="A4.p1.22.m22.1a"><mn id="A4.p1.22.m22.1.1" xref="A4.p1.22.m22.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A4.p1.22.m22.1b"><cn type="integer" id="A4.p1.22.m22.1.1.cmml" xref="A4.p1.22.m22.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.22.m22.1c">5</annotation></semantics></math> epochs (E = <math id="A4.p1.23.m23.1" class="ltx_Math" alttext="5" display="inline"><semantics id="A4.p1.23.m23.1a"><mn id="A4.p1.23.m23.1.1" xref="A4.p1.23.m23.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A4.p1.23.m23.1b"><cn type="integer" id="A4.p1.23.m23.1.1.cmml" xref="A4.p1.23.m23.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.23.m23.1c">5</annotation></semantics></math>) of local optimization using SGD.
The evaluation metric employed was the ROC-AUC, a common practice in eICU <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib16" title="" class="ltx_ref">2019</a>)</cite>. For <span id="A4.p1.34.5" class="ltx_text ltx_font_bold">FeTS</span>, we treat each institution as a client.
We adopt the widely used U-Net <cite class="ltx_cite ltx_citemacro_citep">(Ronneberger et al., <a href="#bib.bib48" title="" class="ltx_ref">2015</a>)</cite> model. We train our model for <math id="A4.p1.24.m24.1" class="ltx_Math" alttext="20" display="inline"><semantics id="A4.p1.24.m24.1a"><mn id="A4.p1.24.m24.1.1" xref="A4.p1.24.m24.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="A4.p1.24.m24.1b"><cn type="integer" id="A4.p1.24.m24.1.1.cmml" xref="A4.p1.24.m24.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.24.m24.1c">20</annotation></semantics></math> communication rounds, using a learning rate of <math id="A4.p1.25.m25.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="A4.p1.25.m25.1a"><mn id="A4.p1.25.m25.1.1" xref="A4.p1.25.m25.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="A4.p1.25.m25.1b"><cn type="float" id="A4.p1.25.m25.1.1.cmml" xref="A4.p1.25.m25.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.25.m25.1c">0.01</annotation></semantics></math> and a batch size of 64. We conduct training with 16 intuitions and report results on 5 unseen institutions. Each institution performs <math id="A4.p1.26.m26.1" class="ltx_Math" alttext="2" display="inline"><semantics id="A4.p1.26.m26.1a"><mn id="A4.p1.26.m26.1.1" xref="A4.p1.26.m26.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="A4.p1.26.m26.1b"><cn type="integer" id="A4.p1.26.m26.1.1.cmml" xref="A4.p1.26.m26.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.26.m26.1c">2</annotation></semantics></math> epochs of local optimization (E = <math id="A4.p1.27.m27.1" class="ltx_Math" alttext="2" display="inline"><semantics id="A4.p1.27.m27.1a"><mn id="A4.p1.27.m27.1.1" xref="A4.p1.27.m27.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="A4.p1.27.m27.1b"><cn type="integer" id="A4.p1.27.m27.1.1.cmml" xref="A4.p1.27.m27.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.27.m27.1c">2</annotation></semantics></math>) using SGD.
The evaluation metric is Dice Similarity Coefficient (DSC <math id="A4.p1.28.m28.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A4.p1.28.m28.1a"><mo stretchy="false" id="A4.p1.28.m28.1.1" xref="A4.p1.28.m28.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A4.p1.28.m28.1b"><ci id="A4.p1.28.m28.1.1.cmml" xref="A4.p1.28.m28.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.28.m28.1c">\uparrow</annotation></semantics></math>).
For <span id="A4.p1.34.6" class="ltx_text ltx_font_bold">TPT-48</span>, we consider two generalization tasks: (1) E(24) <math id="A4.p1.29.m29.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A4.p1.29.m29.1a"><mo stretchy="false" id="A4.p1.29.m29.1.1" xref="A4.p1.29.m29.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A4.p1.29.m29.1b"><ci id="A4.p1.29.m29.1.1.cmml" xref="A4.p1.29.m29.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.29.m29.1c">\rightarrow</annotation></semantics></math> W(24): Using the 24 eastern states as IF clients and the 24 western states as OOF clients; (2) N(24) <math id="A4.p1.30.m30.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A4.p1.30.m30.1a"><mo stretchy="false" id="A4.p1.30.m30.1.1" xref="A4.p1.30.m30.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A4.p1.30.m30.1b"><ci id="A4.p1.30.m30.1.1.cmml" xref="A4.p1.30.m30.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.30.m30.1c">\rightarrow</annotation></semantics></math> S(24): Using the 24 northern states as IF clients and the 24 southern states as OOF clients.
We use a model similar to  <cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a href="#bib.bib71" title="" class="ltx_ref">2022</a>)</cite>, which has <math id="A4.p1.31.m31.1" class="ltx_Math" alttext="8" display="inline"><semantics id="A4.p1.31.m31.1a"><mn id="A4.p1.31.m31.1.1" xref="A4.p1.31.m31.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A4.p1.31.m31.1b"><cn type="integer" id="A4.p1.31.m31.1.1.cmml" xref="A4.p1.31.m31.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.31.m31.1c">8</annotation></semantics></math> fully connected layers with <math id="A4.p1.32.m32.1" class="ltx_Math" alttext="512" display="inline"><semantics id="A4.p1.32.m32.1a"><mn id="A4.p1.32.m32.1.1" xref="A4.p1.32.m32.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="A4.p1.32.m32.1b"><cn type="integer" id="A4.p1.32.m32.1.1.cmml" xref="A4.p1.32.m32.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.32.m32.1c">512</annotation></semantics></math> hidden units. We use SGD optimizer with a fixed momentum of 0.9.
The evaluation metric is Mean Squared Error (MSE <math id="A4.p1.33.m33.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A4.p1.33.m33.1a"><mo stretchy="false" id="A4.p1.33.m33.1.1" xref="A4.p1.33.m33.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A4.p1.33.m33.1b"><ci id="A4.p1.33.m33.1.1.cmml" xref="A4.p1.33.m33.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.33.m33.1c">\downarrow</annotation></semantics></math>). Algorithm <a href="#alg1" title="Algorithm 1 ‣ Appendix D Implementation Details ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the overall algorithm of TFL. In implementation, we used dot product as the metric to measure client similarity. All experiments are conducted using a server with 8<math id="A4.p1.34.m34.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A4.p1.34.m34.1a"><mo id="A4.p1.34.m34.1.1" xref="A4.p1.34.m34.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A4.p1.34.m34.1b"><times id="A4.p1.34.m34.1.1.cmml" xref="A4.p1.34.m34.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.34.m34.1c">\times</annotation></semantics></math>NVIDIA A6000 GPUs.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Topology-aware Federated Learning</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">  <span id="alg1.l1.1" class="ltx_text ltx_font_bold">Input:</span> <math id="alg1.l1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">K</annotation></semantics></math> clients; learning rate <math id="alg1.l1.m2.1" class="ltx_Math" alttext="\eta_{\theta}" display="inline"><semantics id="alg1.l1.m2.1a"><msub id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">η</mi><mi id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">subscript</csymbol><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝜂</ci><ci id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">\eta_{\theta}</annotation></semantics></math> and <math id="alg1.l1.m3.1" class="ltx_Math" alttext="\eta_{\lambda}" display="inline"><semantics id="alg1.l1.m3.1a"><msub id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">η</mi><mi id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml">λ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1">subscript</csymbol><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">𝜂</ci><ci id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3">𝜆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">\eta_{\lambda}</annotation></semantics></math>; Communication round <math id="alg1.l1.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l1.m4.1a"><mi id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">T</annotation></semantics></math>; initial model <math id="alg1.l1.m5.1" class="ltx_Math" alttext="\theta^{(0)}" display="inline"><semantics id="alg1.l1.m5.1a"><msup id="alg1.l1.m5.1.2" xref="alg1.l1.m5.1.2.cmml"><mi id="alg1.l1.m5.1.2.2" xref="alg1.l1.m5.1.2.2.cmml">θ</mi><mrow id="alg1.l1.m5.1.1.1.3" xref="alg1.l1.m5.1.2.cmml"><mo stretchy="false" id="alg1.l1.m5.1.1.1.3.1" xref="alg1.l1.m5.1.2.cmml">(</mo><mn id="alg1.l1.m5.1.1.1.1" xref="alg1.l1.m5.1.1.1.1.cmml">0</mn><mo stretchy="false" id="alg1.l1.m5.1.1.1.3.2" xref="alg1.l1.m5.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><apply id="alg1.l1.m5.1.2.cmml" xref="alg1.l1.m5.1.2"><csymbol cd="ambiguous" id="alg1.l1.m5.1.2.1.cmml" xref="alg1.l1.m5.1.2">superscript</csymbol><ci id="alg1.l1.m5.1.2.2.cmml" xref="alg1.l1.m5.1.2.2">𝜃</ci><cn type="integer" id="alg1.l1.m5.1.1.1.1.cmml" xref="alg1.l1.m5.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">\theta^{(0)}</annotation></semantics></math>; initial <math id="alg1.l1.m6.1" class="ltx_Math" alttext="\lambda^{(0)}" display="inline"><semantics id="alg1.l1.m6.1a"><msup id="alg1.l1.m6.1.2" xref="alg1.l1.m6.1.2.cmml"><mi id="alg1.l1.m6.1.2.2" xref="alg1.l1.m6.1.2.2.cmml">λ</mi><mrow id="alg1.l1.m6.1.1.1.3" xref="alg1.l1.m6.1.2.cmml"><mo stretchy="false" id="alg1.l1.m6.1.1.1.3.1" xref="alg1.l1.m6.1.2.cmml">(</mo><mn id="alg1.l1.m6.1.1.1.1" xref="alg1.l1.m6.1.1.1.1.cmml">0</mn><mo stretchy="false" id="alg1.l1.m6.1.1.1.3.2" xref="alg1.l1.m6.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l1.m6.1b"><apply id="alg1.l1.m6.1.2.cmml" xref="alg1.l1.m6.1.2"><csymbol cd="ambiguous" id="alg1.l1.m6.1.2.1.cmml" xref="alg1.l1.m6.1.2">superscript</csymbol><ci id="alg1.l1.m6.1.2.2.cmml" xref="alg1.l1.m6.1.2.2">𝜆</ci><cn type="integer" id="alg1.l1.m6.1.1.1.1.cmml" xref="alg1.l1.m6.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m6.1c">\lambda^{(0)}</annotation></semantics></math>.

</div>
<div id="alg1.l2" class="ltx_listingline">  <span id="alg1.l2.1" class="ltx_text ltx_font_bold">repeat</span>


</div>
<div id="alg1.l3" class="ltx_listingline">     <span id="alg1.l3.1" class="ltx_text ltx_font_bold">for</span> each communication round <math id="alg1.l3.m1.2" class="ltx_Math" alttext="t=1,\cdots T" display="inline"><semantics id="alg1.l3.m1.2a"><mrow id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml"><mi id="alg1.l3.m1.2.2.3" xref="alg1.l3.m1.2.2.3.cmml">t</mi><mo id="alg1.l3.m1.2.2.2" xref="alg1.l3.m1.2.2.2.cmml">=</mo><mrow id="alg1.l3.m1.2.2.1.1" xref="alg1.l3.m1.2.2.1.2.cmml"><mn id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">1</mn><mo id="alg1.l3.m1.2.2.1.1.2" xref="alg1.l3.m1.2.2.1.2.cmml">,</mo><mrow id="alg1.l3.m1.2.2.1.1.1" xref="alg1.l3.m1.2.2.1.1.1.cmml"><mi mathvariant="normal" id="alg1.l3.m1.2.2.1.1.1.2" xref="alg1.l3.m1.2.2.1.1.1.2.cmml">⋯</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.2.2.1.1.1.1" xref="alg1.l3.m1.2.2.1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.2.2.1.1.1.3" xref="alg1.l3.m1.2.2.1.1.1.3.cmml">T</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.2b"><apply id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2"><eq id="alg1.l3.m1.2.2.2.cmml" xref="alg1.l3.m1.2.2.2"></eq><ci id="alg1.l3.m1.2.2.3.cmml" xref="alg1.l3.m1.2.2.3">𝑡</ci><list id="alg1.l3.m1.2.2.1.2.cmml" xref="alg1.l3.m1.2.2.1.1"><cn type="integer" id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">1</cn><apply id="alg1.l3.m1.2.2.1.1.1.cmml" xref="alg1.l3.m1.2.2.1.1.1"><times id="alg1.l3.m1.2.2.1.1.1.1.cmml" xref="alg1.l3.m1.2.2.1.1.1.1"></times><ci id="alg1.l3.m1.2.2.1.1.1.2.cmml" xref="alg1.l3.m1.2.2.1.1.1.2">⋯</ci><ci id="alg1.l3.m1.2.2.1.1.1.3.cmml" xref="alg1.l3.m1.2.2.1.1.1.3">𝑇</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.2c">t=1,\cdots T</annotation></semantics></math> <span id="alg1.l3.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">        server <span id="alg1.l4.1" class="ltx_text ltx_font_bold">samples</span> <math id="alg1.l4.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg1.l4.m1.1a"><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">m</annotation></semantics></math> clients according to <math id="alg1.l4.m2.1" class="ltx_Math" alttext="\bm{\lambda^{(t)}}" display="inline"><semantics id="alg1.l4.m2.1a"><msup id="alg1.l4.m2.1.2" xref="alg1.l4.m2.1.2.cmml"><mi id="alg1.l4.m2.1.2.2" xref="alg1.l4.m2.1.2.2.cmml">𝝀</mi><mrow id="alg1.l4.m2.1.1.1.3" xref="alg1.l4.m2.1.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="alg1.l4.m2.1.1.1.3.1" xref="alg1.l4.m2.1.2.cmml">(</mo><mi id="alg1.l4.m2.1.1.1.1" xref="alg1.l4.m2.1.1.1.1.cmml">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="alg1.l4.m2.1.1.1.3.2" xref="alg1.l4.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.2.cmml" xref="alg1.l4.m2.1.2"><csymbol cd="ambiguous" id="alg1.l4.m2.1.2.1.cmml" xref="alg1.l4.m2.1.2">superscript</csymbol><ci id="alg1.l4.m2.1.2.2.cmml" xref="alg1.l4.m2.1.2.2">𝝀</ci><ci id="alg1.l4.m2.1.1.1.1.cmml" xref="alg1.l4.m2.1.1.1.1">𝒕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">\bm{\lambda^{(t)}}</annotation></semantics></math>

</div>
<div id="alg1.l5" class="ltx_listingline">        <span id="alg1.l5.1" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l5.m1.2" class="ltx_Math" alttext="i=1,\cdots m" display="inline"><semantics id="alg1.l5.m1.2a"><mrow id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2.cmml"><mi id="alg1.l5.m1.2.2.3" xref="alg1.l5.m1.2.2.3.cmml">i</mi><mo id="alg1.l5.m1.2.2.2" xref="alg1.l5.m1.2.2.2.cmml">=</mo><mrow id="alg1.l5.m1.2.2.1.1" xref="alg1.l5.m1.2.2.1.2.cmml"><mn id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">1</mn><mo id="alg1.l5.m1.2.2.1.1.2" xref="alg1.l5.m1.2.2.1.2.cmml">,</mo><mrow id="alg1.l5.m1.2.2.1.1.1" xref="alg1.l5.m1.2.2.1.1.1.cmml"><mi mathvariant="normal" id="alg1.l5.m1.2.2.1.1.1.2" xref="alg1.l5.m1.2.2.1.1.1.2.cmml">⋯</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.2.2.1.1.1.1" xref="alg1.l5.m1.2.2.1.1.1.1.cmml">​</mo><mi id="alg1.l5.m1.2.2.1.1.1.3" xref="alg1.l5.m1.2.2.1.1.1.3.cmml">m</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.2b"><apply id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2"><eq id="alg1.l5.m1.2.2.2.cmml" xref="alg1.l5.m1.2.2.2"></eq><ci id="alg1.l5.m1.2.2.3.cmml" xref="alg1.l5.m1.2.2.3">𝑖</ci><list id="alg1.l5.m1.2.2.1.2.cmml" xref="alg1.l5.m1.2.2.1.1"><cn type="integer" id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">1</cn><apply id="alg1.l5.m1.2.2.1.1.1.cmml" xref="alg1.l5.m1.2.2.1.1.1"><times id="alg1.l5.m1.2.2.1.1.1.1.cmml" xref="alg1.l5.m1.2.2.1.1.1.1"></times><ci id="alg1.l5.m1.2.2.1.1.1.2.cmml" xref="alg1.l5.m1.2.2.1.1.1.2">⋯</ci><ci id="alg1.l5.m1.2.2.1.1.1.3.cmml" xref="alg1.l5.m1.2.2.1.1.1.3">𝑚</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.2c">i=1,\cdots m</annotation></semantics></math> in parallel <span id="alg1.l5.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l6" class="ltx_listingline">           <math id="alg1.l6.m1.1" class="ltx_Math" alttext="\theta^{t+1}_{i}=\theta^{t}_{i}-\eta_{{\theta}^{t}_{i}}\nabla_{{\theta}^{t}_{i}}F({{\theta}^{t}_{i}})" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><msubsup id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.3.2.2" xref="alg1.l6.m1.1.1.3.2.2.cmml">θ</mi><mi id="alg1.l6.m1.1.1.3.3" xref="alg1.l6.m1.1.1.3.3.cmml">i</mi><mrow id="alg1.l6.m1.1.1.3.2.3" xref="alg1.l6.m1.1.1.3.2.3.cmml"><mi id="alg1.l6.m1.1.1.3.2.3.2" xref="alg1.l6.m1.1.1.3.2.3.2.cmml">t</mi><mo id="alg1.l6.m1.1.1.3.2.3.1" xref="alg1.l6.m1.1.1.3.2.3.1.cmml">+</mo><mn id="alg1.l6.m1.1.1.3.2.3.3" xref="alg1.l6.m1.1.1.3.2.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">=</mo><mrow id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml"><msubsup id="alg1.l6.m1.1.1.1.3" xref="alg1.l6.m1.1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.1.3.2.2" xref="alg1.l6.m1.1.1.1.3.2.2.cmml">θ</mi><mi id="alg1.l6.m1.1.1.1.3.3" xref="alg1.l6.m1.1.1.1.3.3.cmml">i</mi><mi id="alg1.l6.m1.1.1.1.3.2.3" xref="alg1.l6.m1.1.1.1.3.2.3.cmml">t</mi></msubsup><mo id="alg1.l6.m1.1.1.1.2" xref="alg1.l6.m1.1.1.1.2.cmml">−</mo><mrow id="alg1.l6.m1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.cmml"><msub id="alg1.l6.m1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.1.1.3.2" xref="alg1.l6.m1.1.1.1.1.3.2.cmml">η</mi><msubsup id="alg1.l6.m1.1.1.1.1.3.3" xref="alg1.l6.m1.1.1.1.1.3.3.cmml"><mi id="alg1.l6.m1.1.1.1.1.3.3.2.2" xref="alg1.l6.m1.1.1.1.1.3.3.2.2.cmml">θ</mi><mi id="alg1.l6.m1.1.1.1.1.3.3.3" xref="alg1.l6.m1.1.1.1.1.3.3.3.cmml">i</mi><mi id="alg1.l6.m1.1.1.1.1.3.3.2.3" xref="alg1.l6.m1.1.1.1.1.3.3.2.3.cmml">t</mi></msubsup></msub><mo lspace="0.167em" rspace="0em" id="alg1.l6.m1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l6.m1.1.1.1.1.4" xref="alg1.l6.m1.1.1.1.1.4.cmml"><msub id="alg1.l6.m1.1.1.1.1.4.1" xref="alg1.l6.m1.1.1.1.1.4.1.cmml"><mo rspace="0.167em" id="alg1.l6.m1.1.1.1.1.4.1.2" xref="alg1.l6.m1.1.1.1.1.4.1.2.cmml">∇</mo><msubsup id="alg1.l6.m1.1.1.1.1.4.1.3" xref="alg1.l6.m1.1.1.1.1.4.1.3.cmml"><mi id="alg1.l6.m1.1.1.1.1.4.1.3.2.2" xref="alg1.l6.m1.1.1.1.1.4.1.3.2.2.cmml">θ</mi><mi id="alg1.l6.m1.1.1.1.1.4.1.3.3" xref="alg1.l6.m1.1.1.1.1.4.1.3.3.cmml">i</mi><mi id="alg1.l6.m1.1.1.1.1.4.1.3.2.3" xref="alg1.l6.m1.1.1.1.1.4.1.3.2.3.cmml">t</mi></msubsup></msub><mi id="alg1.l6.m1.1.1.1.1.4.2" xref="alg1.l6.m1.1.1.1.1.4.2.cmml">F</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.1.2a" xref="alg1.l6.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l6.m1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l6.m1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l6.m1.1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mi id="alg1.l6.m1.1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.3.cmml">i</mi><mi id="alg1.l6.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l6.m1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><eq id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2"></eq><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3">subscript</csymbol><apply id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.2.1.cmml" xref="alg1.l6.m1.1.1.3">superscript</csymbol><ci id="alg1.l6.m1.1.1.3.2.2.cmml" xref="alg1.l6.m1.1.1.3.2.2">𝜃</ci><apply id="alg1.l6.m1.1.1.3.2.3.cmml" xref="alg1.l6.m1.1.1.3.2.3"><plus id="alg1.l6.m1.1.1.3.2.3.1.cmml" xref="alg1.l6.m1.1.1.3.2.3.1"></plus><ci id="alg1.l6.m1.1.1.3.2.3.2.cmml" xref="alg1.l6.m1.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="alg1.l6.m1.1.1.3.2.3.3.cmml" xref="alg1.l6.m1.1.1.3.2.3.3">1</cn></apply></apply><ci id="alg1.l6.m1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.3.3">𝑖</ci></apply><apply id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"><minus id="alg1.l6.m1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.2"></minus><apply id="alg1.l6.m1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.3">subscript</csymbol><apply id="alg1.l6.m1.1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.3.2.1.cmml" xref="alg1.l6.m1.1.1.1.3">superscript</csymbol><ci id="alg1.l6.m1.1.1.1.3.2.2.cmml" xref="alg1.l6.m1.1.1.1.3.2.2">𝜃</ci><ci id="alg1.l6.m1.1.1.1.3.2.3.cmml" xref="alg1.l6.m1.1.1.1.3.2.3">𝑡</ci></apply><ci id="alg1.l6.m1.1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.1.3.3">𝑖</ci></apply><apply id="alg1.l6.m1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1"><times id="alg1.l6.m1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.2"></times><apply id="alg1.l6.m1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.1.3.2">𝜂</ci><apply id="alg1.l6.m1.1.1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.3.3.1.cmml" xref="alg1.l6.m1.1.1.1.1.3.3">subscript</csymbol><apply id="alg1.l6.m1.1.1.1.1.3.3.2.cmml" xref="alg1.l6.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.3.3.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.3.3">superscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.3.3.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.3.3.2.2">𝜃</ci><ci id="alg1.l6.m1.1.1.1.1.3.3.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.3.3.2.3">𝑡</ci></apply><ci id="alg1.l6.m1.1.1.1.1.3.3.3.cmml" xref="alg1.l6.m1.1.1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="alg1.l6.m1.1.1.1.1.4.cmml" xref="alg1.l6.m1.1.1.1.1.4"><apply id="alg1.l6.m1.1.1.1.1.4.1.cmml" xref="alg1.l6.m1.1.1.1.1.4.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.4.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.4.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.4.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.4.1.2">∇</ci><apply id="alg1.l6.m1.1.1.1.1.4.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.4.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.4.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.1.4.1.3">subscript</csymbol><apply id="alg1.l6.m1.1.1.1.1.4.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.1.4.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.4.1.3.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.4.1.3">superscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.4.1.3.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.4.1.3.2.2">𝜃</ci><ci id="alg1.l6.m1.1.1.1.1.4.1.3.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.4.1.3.2.3">𝑡</ci></apply><ci id="alg1.l6.m1.1.1.1.1.4.1.3.3.cmml" xref="alg1.l6.m1.1.1.1.1.4.1.3.3">𝑖</ci></apply></apply><ci id="alg1.l6.m1.1.1.1.1.4.2.cmml" xref="alg1.l6.m1.1.1.1.1.4.2">𝐹</ci></apply><apply id="alg1.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l6.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.2">𝜃</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l6.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\theta^{t+1}_{i}=\theta^{t}_{i}-\eta_{{\theta}^{t}_{i}}\nabla_{{\theta}^{t}_{i}}F({{\theta}^{t}_{i}})</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">           client <math id="alg1.l7.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l7.m1.1a"><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">i</annotation></semantics></math> send <math id="alg1.l7.m2.1" class="ltx_Math" alttext="\theta^{t+1}_{i}" display="inline"><semantics id="alg1.l7.m2.1a"><msubsup id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml"><mi id="alg1.l7.m2.1.1.2.2" xref="alg1.l7.m2.1.1.2.2.cmml">θ</mi><mi id="alg1.l7.m2.1.1.3" xref="alg1.l7.m2.1.1.3.cmml">i</mi><mrow id="alg1.l7.m2.1.1.2.3" xref="alg1.l7.m2.1.1.2.3.cmml"><mi id="alg1.l7.m2.1.1.2.3.2" xref="alg1.l7.m2.1.1.2.3.2.cmml">t</mi><mo id="alg1.l7.m2.1.1.2.3.1" xref="alg1.l7.m2.1.1.2.3.1.cmml">+</mo><mn id="alg1.l7.m2.1.1.2.3.3" xref="alg1.l7.m2.1.1.2.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><apply id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1"><csymbol cd="ambiguous" id="alg1.l7.m2.1.1.1.cmml" xref="alg1.l7.m2.1.1">subscript</csymbol><apply id="alg1.l7.m2.1.1.2.cmml" xref="alg1.l7.m2.1.1"><csymbol cd="ambiguous" id="alg1.l7.m2.1.1.2.1.cmml" xref="alg1.l7.m2.1.1">superscript</csymbol><ci id="alg1.l7.m2.1.1.2.2.cmml" xref="alg1.l7.m2.1.1.2.2">𝜃</ci><apply id="alg1.l7.m2.1.1.2.3.cmml" xref="alg1.l7.m2.1.1.2.3"><plus id="alg1.l7.m2.1.1.2.3.1.cmml" xref="alg1.l7.m2.1.1.2.3.1"></plus><ci id="alg1.l7.m2.1.1.2.3.2.cmml" xref="alg1.l7.m2.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg1.l7.m2.1.1.2.3.3.cmml" xref="alg1.l7.m2.1.1.2.3.3">1</cn></apply></apply><ci id="alg1.l7.m2.1.1.3.cmml" xref="alg1.l7.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">\theta^{t+1}_{i}</annotation></semantics></math> back to the server

</div>
<div id="alg1.l8" class="ltx_listingline">        <span id="alg1.l8.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l8.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l9" class="ltx_listingline">        server <span id="alg1.l9.1" class="ltx_text ltx_font_bold">computes</span> <math id="alg1.l9.m1.1" class="ltx_Math" alttext="\bm{\theta}^{t+1}=\sum^{m}_{i=1}\theta^{t+1}_{i}" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><msup id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">𝜽</mi><mrow id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml"><mi id="alg1.l9.m1.1.1.2.3.2" xref="alg1.l9.m1.1.1.2.3.2.cmml">t</mi><mo id="alg1.l9.m1.1.1.2.3.1" xref="alg1.l9.m1.1.1.2.3.1.cmml">+</mo><mn id="alg1.l9.m1.1.1.2.3.3" xref="alg1.l9.m1.1.1.2.3.3.cmml">1</mn></mrow></msup><mo rspace="0.111em" id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">=</mo><mrow id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><msubsup id="alg1.l9.m1.1.1.3.1" xref="alg1.l9.m1.1.1.3.1.cmml"><mo id="alg1.l9.m1.1.1.3.1.2.2" xref="alg1.l9.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="alg1.l9.m1.1.1.3.1.3" xref="alg1.l9.m1.1.1.3.1.3.cmml"><mi id="alg1.l9.m1.1.1.3.1.3.2" xref="alg1.l9.m1.1.1.3.1.3.2.cmml">i</mi><mo id="alg1.l9.m1.1.1.3.1.3.1" xref="alg1.l9.m1.1.1.3.1.3.1.cmml">=</mo><mn id="alg1.l9.m1.1.1.3.1.3.3" xref="alg1.l9.m1.1.1.3.1.3.3.cmml">1</mn></mrow><mi id="alg1.l9.m1.1.1.3.1.2.3" xref="alg1.l9.m1.1.1.3.1.2.3.cmml">m</mi></msubsup><msubsup id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml"><mi id="alg1.l9.m1.1.1.3.2.2.2" xref="alg1.l9.m1.1.1.3.2.2.2.cmml">θ</mi><mi id="alg1.l9.m1.1.1.3.2.3" xref="alg1.l9.m1.1.1.3.2.3.cmml">i</mi><mrow id="alg1.l9.m1.1.1.3.2.2.3" xref="alg1.l9.m1.1.1.3.2.2.3.cmml"><mi id="alg1.l9.m1.1.1.3.2.2.3.2" xref="alg1.l9.m1.1.1.3.2.2.3.2.cmml">t</mi><mo id="alg1.l9.m1.1.1.3.2.2.3.1" xref="alg1.l9.m1.1.1.3.2.2.3.1.cmml">+</mo><mn id="alg1.l9.m1.1.1.3.2.2.3.3" xref="alg1.l9.m1.1.1.3.2.2.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><eq id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"></eq><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2">superscript</csymbol><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝜽</ci><apply id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3"><plus id="alg1.l9.m1.1.1.2.3.1.cmml" xref="alg1.l9.m1.1.1.2.3.1"></plus><ci id="alg1.l9.m1.1.1.2.3.2.cmml" xref="alg1.l9.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg1.l9.m1.1.1.2.3.3.cmml" xref="alg1.l9.m1.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><apply id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.1.1.cmml" xref="alg1.l9.m1.1.1.3.1">subscript</csymbol><apply id="alg1.l9.m1.1.1.3.1.2.cmml" xref="alg1.l9.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.1.2.1.cmml" xref="alg1.l9.m1.1.1.3.1">superscript</csymbol><sum id="alg1.l9.m1.1.1.3.1.2.2.cmml" xref="alg1.l9.m1.1.1.3.1.2.2"></sum><ci id="alg1.l9.m1.1.1.3.1.2.3.cmml" xref="alg1.l9.m1.1.1.3.1.2.3">𝑚</ci></apply><apply id="alg1.l9.m1.1.1.3.1.3.cmml" xref="alg1.l9.m1.1.1.3.1.3"><eq id="alg1.l9.m1.1.1.3.1.3.1.cmml" xref="alg1.l9.m1.1.1.3.1.3.1"></eq><ci id="alg1.l9.m1.1.1.3.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.1.3.2">𝑖</ci><cn type="integer" id="alg1.l9.m1.1.1.3.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.1.3.3">1</cn></apply></apply><apply id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.2.1.cmml" xref="alg1.l9.m1.1.1.3.2">subscript</csymbol><apply id="alg1.l9.m1.1.1.3.2.2.cmml" xref="alg1.l9.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.2.2.1.cmml" xref="alg1.l9.m1.1.1.3.2">superscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.2.2.cmml" xref="alg1.l9.m1.1.1.3.2.2.2">𝜃</ci><apply id="alg1.l9.m1.1.1.3.2.2.3.cmml" xref="alg1.l9.m1.1.1.3.2.2.3"><plus id="alg1.l9.m1.1.1.3.2.2.3.1.cmml" xref="alg1.l9.m1.1.1.3.2.2.3.1"></plus><ci id="alg1.l9.m1.1.1.3.2.2.3.2.cmml" xref="alg1.l9.m1.1.1.3.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l9.m1.1.1.3.2.2.3.3.cmml" xref="alg1.l9.m1.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="alg1.l9.m1.1.1.3.2.3.cmml" xref="alg1.l9.m1.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\bm{\theta}^{t+1}=\sum^{m}_{i=1}\theta^{t+1}_{i}</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">        <span id="alg1.l10.1" class="ltx_text ltx_font_bold">if</span>  <math id="alg1.l10.m1.1" class="ltx_math_unparsed" alttext="t\%f==0" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1b"><mi id="alg1.l10.m1.1.1">t</mi><mo id="alg1.l10.m1.1.2">%</mo><mi id="alg1.l10.m1.1.3">f</mi><mo rspace="0em" id="alg1.l10.m1.1.4">=</mo><mo lspace="0em" id="alg1.l10.m1.1.5">=</mo><mn id="alg1.l10.m1.1.6">0</mn></mrow><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">t\%f==0</annotation></semantics></math> <span id="alg1.l10.2" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l11" class="ltx_listingline">           server updating graph <math id="alg1.l11.m1.1" class="ltx_Math" alttext="\mathcal{G}" display="inline"><semantics id="alg1.l11.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\mathcal{G}</annotation></semantics></math> via Equation 4

</div>
<div id="alg1.l12" class="ltx_listingline">        <span id="alg1.l12.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l12.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l13" class="ltx_listingline">        server calculating topological prior <math id="alg1.l13.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="alg1.l13.m1.1a"><mi id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><ci id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">p</annotation></semantics></math> from <math id="alg1.l13.m2.1" class="ltx_Math" alttext="\mathcal{G}" display="inline"><semantics id="alg1.l13.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m2.1.1" xref="alg1.l13.m2.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="alg1.l13.m2.1b"><ci id="alg1.l13.m2.1.1.cmml" xref="alg1.l13.m2.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m2.1c">\mathcal{G}</annotation></semantics></math>

</div>
<div id="alg1.l14" class="ltx_listingline">        server calculating <math id="alg1.l14.m1.5" class="ltx_Math" alttext="\nabla_{\lambda^{(t)}}F(\bm{\theta}^{(t+1)},\bm{\lambda^{(t)}})" display="inline"><semantics id="alg1.l14.m1.5a"><mrow id="alg1.l14.m1.5.5" xref="alg1.l14.m1.5.5.cmml"><mrow id="alg1.l14.m1.5.5.4" xref="alg1.l14.m1.5.5.4.cmml"><msub id="alg1.l14.m1.5.5.4.1" xref="alg1.l14.m1.5.5.4.1.cmml"><mo id="alg1.l14.m1.5.5.4.1.2" xref="alg1.l14.m1.5.5.4.1.2.cmml">∇</mo><msup id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml"><mi id="alg1.l14.m1.1.1.1.3" xref="alg1.l14.m1.1.1.1.3.cmml">λ</mi><mrow id="alg1.l14.m1.1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.cmml"><mo stretchy="false" id="alg1.l14.m1.1.1.1.1.1.3.1" xref="alg1.l14.m1.1.1.1.cmml">(</mo><mi id="alg1.l14.m1.1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l14.m1.1.1.1.1.1.3.2" xref="alg1.l14.m1.1.1.1.cmml">)</mo></mrow></msup></msub><mi id="alg1.l14.m1.5.5.4.2" xref="alg1.l14.m1.5.5.4.2.cmml">F</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l14.m1.5.5.3" xref="alg1.l14.m1.5.5.3.cmml">​</mo><mrow id="alg1.l14.m1.5.5.2.2" xref="alg1.l14.m1.5.5.2.3.cmml"><mo stretchy="false" id="alg1.l14.m1.5.5.2.2.3" xref="alg1.l14.m1.5.5.2.3.cmml">(</mo><msup id="alg1.l14.m1.4.4.1.1.1" xref="alg1.l14.m1.4.4.1.1.1.cmml"><mi id="alg1.l14.m1.4.4.1.1.1.2" xref="alg1.l14.m1.4.4.1.1.1.2.cmml">𝜽</mi><mrow id="alg1.l14.m1.2.2.1.1" xref="alg1.l14.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="alg1.l14.m1.2.2.1.1.2" xref="alg1.l14.m1.2.2.1.1.1.cmml">(</mo><mrow id="alg1.l14.m1.2.2.1.1.1" xref="alg1.l14.m1.2.2.1.1.1.cmml"><mi id="alg1.l14.m1.2.2.1.1.1.2" xref="alg1.l14.m1.2.2.1.1.1.2.cmml">t</mi><mo id="alg1.l14.m1.2.2.1.1.1.1" xref="alg1.l14.m1.2.2.1.1.1.1.cmml">+</mo><mn id="alg1.l14.m1.2.2.1.1.1.3" xref="alg1.l14.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l14.m1.2.2.1.1.3" xref="alg1.l14.m1.2.2.1.1.1.cmml">)</mo></mrow></msup><mo id="alg1.l14.m1.5.5.2.2.4" xref="alg1.l14.m1.5.5.2.3.cmml">,</mo><msup id="alg1.l14.m1.5.5.2.2.2" xref="alg1.l14.m1.5.5.2.2.2.cmml"><mi id="alg1.l14.m1.5.5.2.2.2.2" xref="alg1.l14.m1.5.5.2.2.2.2.cmml">𝝀</mi><mrow id="alg1.l14.m1.3.3.1.3" xref="alg1.l14.m1.5.5.2.2.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="alg1.l14.m1.3.3.1.3.1" xref="alg1.l14.m1.5.5.2.2.2.cmml">(</mo><mi id="alg1.l14.m1.3.3.1.1" xref="alg1.l14.m1.3.3.1.1.cmml">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="alg1.l14.m1.3.3.1.3.2" xref="alg1.l14.m1.5.5.2.2.2.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg1.l14.m1.5.5.2.2.5" xref="alg1.l14.m1.5.5.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.5b"><apply id="alg1.l14.m1.5.5.cmml" xref="alg1.l14.m1.5.5"><times id="alg1.l14.m1.5.5.3.cmml" xref="alg1.l14.m1.5.5.3"></times><apply id="alg1.l14.m1.5.5.4.cmml" xref="alg1.l14.m1.5.5.4"><apply id="alg1.l14.m1.5.5.4.1.cmml" xref="alg1.l14.m1.5.5.4.1"><csymbol cd="ambiguous" id="alg1.l14.m1.5.5.4.1.1.cmml" xref="alg1.l14.m1.5.5.4.1">subscript</csymbol><ci id="alg1.l14.m1.5.5.4.1.2.cmml" xref="alg1.l14.m1.5.5.4.1.2">∇</ci><apply id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1">superscript</csymbol><ci id="alg1.l14.m1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.3">𝜆</ci><ci id="alg1.l14.m1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1">𝑡</ci></apply></apply><ci id="alg1.l14.m1.5.5.4.2.cmml" xref="alg1.l14.m1.5.5.4.2">𝐹</ci></apply><interval closure="open" id="alg1.l14.m1.5.5.2.3.cmml" xref="alg1.l14.m1.5.5.2.2"><apply id="alg1.l14.m1.4.4.1.1.1.cmml" xref="alg1.l14.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.4.4.1.1.1.1.cmml" xref="alg1.l14.m1.4.4.1.1.1">superscript</csymbol><ci id="alg1.l14.m1.4.4.1.1.1.2.cmml" xref="alg1.l14.m1.4.4.1.1.1.2">𝜽</ci><apply id="alg1.l14.m1.2.2.1.1.1.cmml" xref="alg1.l14.m1.2.2.1.1"><plus id="alg1.l14.m1.2.2.1.1.1.1.cmml" xref="alg1.l14.m1.2.2.1.1.1.1"></plus><ci id="alg1.l14.m1.2.2.1.1.1.2.cmml" xref="alg1.l14.m1.2.2.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l14.m1.2.2.1.1.1.3.cmml" xref="alg1.l14.m1.2.2.1.1.1.3">1</cn></apply></apply><apply id="alg1.l14.m1.5.5.2.2.2.cmml" xref="alg1.l14.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.5.5.2.2.2.1.cmml" xref="alg1.l14.m1.5.5.2.2.2">superscript</csymbol><ci id="alg1.l14.m1.5.5.2.2.2.2.cmml" xref="alg1.l14.m1.5.5.2.2.2.2">𝝀</ci><ci id="alg1.l14.m1.3.3.1.1.cmml" xref="alg1.l14.m1.3.3.1.1">𝒕</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.5c">\nabla_{\lambda^{(t)}}F(\bm{\theta}^{(t+1)},\bm{\lambda^{(t)}})</annotation></semantics></math> via Equation <a href="#S3.E6" title="Equation 6 ‣ 3.2 Learning on Client Topology ‣ 3 Methodology ‣ Beyond the Federation: Topology-aware Federated Learning for Generalization to Unseen Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>

</div>
<div id="alg1.l15" class="ltx_listingline">        server updates <math id="alg1.l15.m1.4" class="ltx_Math" alttext="\bm{\lambda}^{t+1}=\mathcal{P}_{\Delta_{K}}(\bm{\lambda}^{t}+\eta_{\lambda}^{t}\nabla_{\lambda^{(t)}}F(\bm{\theta}^{(t+1)},\bm{\lambda^{(t)}}))" display="inline"><semantics id="alg1.l15.m1.4a"><mrow id="alg1.l15.m1.4.4" xref="alg1.l15.m1.4.4.cmml"><msup id="alg1.l15.m1.4.4.3" xref="alg1.l15.m1.4.4.3.cmml"><mi id="alg1.l15.m1.4.4.3.2" xref="alg1.l15.m1.4.4.3.2.cmml">𝝀</mi><mrow id="alg1.l15.m1.4.4.3.3" xref="alg1.l15.m1.4.4.3.3.cmml"><mi id="alg1.l15.m1.4.4.3.3.2" xref="alg1.l15.m1.4.4.3.3.2.cmml">t</mi><mo id="alg1.l15.m1.4.4.3.3.1" xref="alg1.l15.m1.4.4.3.3.1.cmml">+</mo><mn id="alg1.l15.m1.4.4.3.3.3" xref="alg1.l15.m1.4.4.3.3.3.cmml">1</mn></mrow></msup><mo id="alg1.l15.m1.4.4.2" xref="alg1.l15.m1.4.4.2.cmml">=</mo><mrow id="alg1.l15.m1.4.4.1" xref="alg1.l15.m1.4.4.1.cmml"><msub id="alg1.l15.m1.4.4.1.3" xref="alg1.l15.m1.4.4.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m1.4.4.1.3.2" xref="alg1.l15.m1.4.4.1.3.2.cmml">𝒫</mi><msub id="alg1.l15.m1.4.4.1.3.3" xref="alg1.l15.m1.4.4.1.3.3.cmml"><mi mathvariant="normal" id="alg1.l15.m1.4.4.1.3.3.2" xref="alg1.l15.m1.4.4.1.3.3.2.cmml">Δ</mi><mi id="alg1.l15.m1.4.4.1.3.3.3" xref="alg1.l15.m1.4.4.1.3.3.3.cmml">K</mi></msub></msub><mo lspace="0em" rspace="0em" id="alg1.l15.m1.4.4.1.2" xref="alg1.l15.m1.4.4.1.2.cmml">​</mo><mrow id="alg1.l15.m1.4.4.1.1.1" xref="alg1.l15.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l15.m1.4.4.1.1.1.2" xref="alg1.l15.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="alg1.l15.m1.4.4.1.1.1.1" xref="alg1.l15.m1.4.4.1.1.1.1.cmml"><msup id="alg1.l15.m1.4.4.1.1.1.1.4" xref="alg1.l15.m1.4.4.1.1.1.1.4.cmml"><mi id="alg1.l15.m1.4.4.1.1.1.1.4.2" xref="alg1.l15.m1.4.4.1.1.1.1.4.2.cmml">𝝀</mi><mi id="alg1.l15.m1.4.4.1.1.1.1.4.3" xref="alg1.l15.m1.4.4.1.1.1.1.4.3.cmml">t</mi></msup><mo id="alg1.l15.m1.4.4.1.1.1.1.3" xref="alg1.l15.m1.4.4.1.1.1.1.3.cmml">+</mo><mrow id="alg1.l15.m1.4.4.1.1.1.1.2" xref="alg1.l15.m1.4.4.1.1.1.1.2.cmml"><msubsup id="alg1.l15.m1.4.4.1.1.1.1.2.4" xref="alg1.l15.m1.4.4.1.1.1.1.2.4.cmml"><mi id="alg1.l15.m1.4.4.1.1.1.1.2.4.2.2" xref="alg1.l15.m1.4.4.1.1.1.1.2.4.2.2.cmml">η</mi><mi id="alg1.l15.m1.4.4.1.1.1.1.2.4.2.3" xref="alg1.l15.m1.4.4.1.1.1.1.2.4.2.3.cmml">λ</mi><mi id="alg1.l15.m1.4.4.1.1.1.1.2.4.3" xref="alg1.l15.m1.4.4.1.1.1.1.2.4.3.cmml">t</mi></msubsup><mo lspace="0.167em" rspace="0em" id="alg1.l15.m1.4.4.1.1.1.1.2.3" xref="alg1.l15.m1.4.4.1.1.1.1.2.3.cmml">​</mo><mrow id="alg1.l15.m1.4.4.1.1.1.1.2.5" xref="alg1.l15.m1.4.4.1.1.1.1.2.5.cmml"><msub id="alg1.l15.m1.4.4.1.1.1.1.2.5.1" xref="alg1.l15.m1.4.4.1.1.1.1.2.5.1.cmml"><mo rspace="0.167em" id="alg1.l15.m1.4.4.1.1.1.1.2.5.1.2" xref="alg1.l15.m1.4.4.1.1.1.1.2.5.1.2.cmml">∇</mo><msup id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml"><mi id="alg1.l15.m1.1.1.1.3" xref="alg1.l15.m1.1.1.1.3.cmml">λ</mi><mrow id="alg1.l15.m1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.cmml"><mo stretchy="false" id="alg1.l15.m1.1.1.1.1.1.3.1" xref="alg1.l15.m1.1.1.1.cmml">(</mo><mi id="alg1.l15.m1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l15.m1.1.1.1.1.1.3.2" xref="alg1.l15.m1.1.1.1.cmml">)</mo></mrow></msup></msub><mi id="alg1.l15.m1.4.4.1.1.1.1.2.5.2" xref="alg1.l15.m1.4.4.1.1.1.1.2.5.2.cmml">F</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l15.m1.4.4.1.1.1.1.2.3a" xref="alg1.l15.m1.4.4.1.1.1.1.2.3.cmml">​</mo><mrow id="alg1.l15.m1.4.4.1.1.1.1.2.2.2" xref="alg1.l15.m1.4.4.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="alg1.l15.m1.4.4.1.1.1.1.2.2.2.3" xref="alg1.l15.m1.4.4.1.1.1.1.2.2.3.cmml">(</mo><msup id="alg1.l15.m1.4.4.1.1.1.1.1.1.1.1" xref="alg1.l15.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l15.m1.4.4.1.1.1.1.1.1.1.1.2" xref="alg1.l15.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">𝜽</mi><mrow id="alg1.l15.m1.2.2.1.1" xref="alg1.l15.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="alg1.l15.m1.2.2.1.1.2" xref="alg1.l15.m1.2.2.1.1.1.cmml">(</mo><mrow id="alg1.l15.m1.2.2.1.1.1" xref="alg1.l15.m1.2.2.1.1.1.cmml"><mi id="alg1.l15.m1.2.2.1.1.1.2" xref="alg1.l15.m1.2.2.1.1.1.2.cmml">t</mi><mo id="alg1.l15.m1.2.2.1.1.1.1" xref="alg1.l15.m1.2.2.1.1.1.1.cmml">+</mo><mn id="alg1.l15.m1.2.2.1.1.1.3" xref="alg1.l15.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l15.m1.2.2.1.1.3" xref="alg1.l15.m1.2.2.1.1.1.cmml">)</mo></mrow></msup><mo id="alg1.l15.m1.4.4.1.1.1.1.2.2.2.4" xref="alg1.l15.m1.4.4.1.1.1.1.2.2.3.cmml">,</mo><msup id="alg1.l15.m1.4.4.1.1.1.1.2.2.2.2" xref="alg1.l15.m1.4.4.1.1.1.1.2.2.2.2.cmml"><mi id="alg1.l15.m1.4.4.1.1.1.1.2.2.2.2.2" xref="alg1.l15.m1.4.4.1.1.1.1.2.2.2.2.2.cmml">𝝀</mi><mrow id="alg1.l15.m1.3.3.1.3" xref="alg1.l15.m1.4.4.1.1.1.1.2.2.2.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="alg1.l15.m1.3.3.1.3.1" xref="alg1.l15.m1.4.4.1.1.1.1.2.2.2.2.cmml">(</mo><mi id="alg1.l15.m1.3.3.1.1" xref="alg1.l15.m1.3.3.1.1.cmml">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="alg1.l15.m1.3.3.1.3.2" xref="alg1.l15.m1.4.4.1.1.1.1.2.2.2.2.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg1.l15.m1.4.4.1.1.1.1.2.2.2.5" xref="alg1.l15.m1.4.4.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="alg1.l15.m1.4.4.1.1.1.3" xref="alg1.l15.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.4b"><apply id="alg1.l15.m1.4.4.cmml" xref="alg1.l15.m1.4.4"><eq id="alg1.l15.m1.4.4.2.cmml" xref="alg1.l15.m1.4.4.2"></eq><apply id="alg1.l15.m1.4.4.3.cmml" xref="alg1.l15.m1.4.4.3"><csymbol cd="ambiguous" id="alg1.l15.m1.4.4.3.1.cmml" xref="alg1.l15.m1.4.4.3">superscript</csymbol><ci id="alg1.l15.m1.4.4.3.2.cmml" xref="alg1.l15.m1.4.4.3.2">𝝀</ci><apply id="alg1.l15.m1.4.4.3.3.cmml" xref="alg1.l15.m1.4.4.3.3"><plus id="alg1.l15.m1.4.4.3.3.1.cmml" xref="alg1.l15.m1.4.4.3.3.1"></plus><ci id="alg1.l15.m1.4.4.3.3.2.cmml" xref="alg1.l15.m1.4.4.3.3.2">𝑡</ci><cn type="integer" id="alg1.l15.m1.4.4.3.3.3.cmml" xref="alg1.l15.m1.4.4.3.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.4.4.1.cmml" xref="alg1.l15.m1.4.4.1"><times id="alg1.l15.m1.4.4.1.2.cmml" xref="alg1.l15.m1.4.4.1.2"></times><apply id="alg1.l15.m1.4.4.1.3.cmml" xref="alg1.l15.m1.4.4.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.4.4.1.3.1.cmml" xref="alg1.l15.m1.4.4.1.3">subscript</csymbol><ci id="alg1.l15.m1.4.4.1.3.2.cmml" xref="alg1.l15.m1.4.4.1.3.2">𝒫</ci><apply id="alg1.l15.m1.4.4.1.3.3.cmml" xref="alg1.l15.m1.4.4.1.3.3"><csymbol cd="ambiguous" id="alg1.l15.m1.4.4.1.3.3.1.cmml" xref="alg1.l15.m1.4.4.1.3.3">subscript</csymbol><ci id="alg1.l15.m1.4.4.1.3.3.2.cmml" xref="alg1.l15.m1.4.4.1.3.3.2">Δ</ci><ci id="alg1.l15.m1.4.4.1.3.3.3.cmml" xref="alg1.l15.m1.4.4.1.3.3.3">𝐾</ci></apply></apply><apply id="alg1.l15.m1.4.4.1.1.1.1.cmml" xref="alg1.l15.m1.4.4.1.1.1"><plus id="alg1.l15.m1.4.4.1.1.1.1.3.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.3"></plus><apply id="alg1.l15.m1.4.4.1.1.1.1.4.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l15.m1.4.4.1.1.1.1.4.1.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.4">superscript</csymbol><ci id="alg1.l15.m1.4.4.1.1.1.1.4.2.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.4.2">𝝀</ci><ci id="alg1.l15.m1.4.4.1.1.1.1.4.3.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.4.3">𝑡</ci></apply><apply id="alg1.l15.m1.4.4.1.1.1.1.2.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.2"><times id="alg1.l15.m1.4.4.1.1.1.1.2.3.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.2.3"></times><apply id="alg1.l15.m1.4.4.1.1.1.1.2.4.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.2.4"><csymbol cd="ambiguous" id="alg1.l15.m1.4.4.1.1.1.1.2.4.1.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.2.4">superscript</csymbol><apply id="alg1.l15.m1.4.4.1.1.1.1.2.4.2.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.2.4"><csymbol cd="ambiguous" id="alg1.l15.m1.4.4.1.1.1.1.2.4.2.1.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.2.4">subscript</csymbol><ci id="alg1.l15.m1.4.4.1.1.1.1.2.4.2.2.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.2.4.2.2">𝜂</ci><ci id="alg1.l15.m1.4.4.1.1.1.1.2.4.2.3.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.2.4.2.3">𝜆</ci></apply><ci id="alg1.l15.m1.4.4.1.1.1.1.2.4.3.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.2.4.3">𝑡</ci></apply><apply id="alg1.l15.m1.4.4.1.1.1.1.2.5.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.2.5"><apply id="alg1.l15.m1.4.4.1.1.1.1.2.5.1.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.2.5.1"><csymbol cd="ambiguous" id="alg1.l15.m1.4.4.1.1.1.1.2.5.1.1.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.2.5.1">subscript</csymbol><ci id="alg1.l15.m1.4.4.1.1.1.1.2.5.1.2.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.2.5.1.2">∇</ci><apply id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1">superscript</csymbol><ci id="alg1.l15.m1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.3">𝜆</ci><ci id="alg1.l15.m1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1">𝑡</ci></apply></apply><ci id="alg1.l15.m1.4.4.1.1.1.1.2.5.2.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.2.5.2">𝐹</ci></apply><interval closure="open" id="alg1.l15.m1.4.4.1.1.1.1.2.2.3.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.2.2.2"><apply id="alg1.l15.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l15.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.1.1.1.1.2">𝜽</ci><apply id="alg1.l15.m1.2.2.1.1.1.cmml" xref="alg1.l15.m1.2.2.1.1"><plus id="alg1.l15.m1.2.2.1.1.1.1.cmml" xref="alg1.l15.m1.2.2.1.1.1.1"></plus><ci id="alg1.l15.m1.2.2.1.1.1.2.cmml" xref="alg1.l15.m1.2.2.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l15.m1.2.2.1.1.1.3.cmml" xref="alg1.l15.m1.2.2.1.1.1.3">1</cn></apply></apply><apply id="alg1.l15.m1.4.4.1.1.1.1.2.2.2.2.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.4.4.1.1.1.1.2.2.2.2.1.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="alg1.l15.m1.4.4.1.1.1.1.2.2.2.2.2.cmml" xref="alg1.l15.m1.4.4.1.1.1.1.2.2.2.2.2">𝝀</ci><ci id="alg1.l15.m1.3.3.1.1.cmml" xref="alg1.l15.m1.3.3.1.1">𝒕</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.4c">\bm{\lambda}^{t+1}=\mathcal{P}_{\Delta_{K}}(\bm{\lambda}^{t}+\eta_{\lambda}^{t}\nabla_{\lambda^{(t)}}F(\bm{\theta}^{(t+1)},\bm{\lambda^{(t)}}))</annotation></semantics></math>

</div>
<div id="alg1.l16" class="ltx_listingline">     <span id="alg1.l16.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l16.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l17" class="ltx_listingline">  <span id="alg1.l17.1" class="ltx_text ltx_font_bold">until</span> convergence

</div>
</div>
</figure>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Discussion of Limitations</h2>

<div id="A5.p1" class="ltx_para">
<p id="A5.p1.1" class="ltx_p">In this section, we discuss the limitations of TFL and the potential solutions.</p>
</div>
<div id="A5.p2" class="ltx_para">
<p id="A5.p2.1" class="ltx_p"><span id="A5.p2.1.1" class="ltx_text ltx_font_bold">Concerns on privacy leakage.</span> Client topology learning may raise concerns about (unintentional) privacy leakage. However, we argue that any such leakage would be a general issue for FL methods rather than a unique concern for our approach. In comparison to standard FL, our method does not require additional information to construct the client topology, thus providing no worse privacy guarantees than well-established methods like FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib32" title="" class="ltx_ref">2017</a>)</cite> and FedProx <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib23" title="" class="ltx_ref">2020b</a>)</cite>. Nonetheless, FL may still be vulnerable to attacks that aim to extract sensitive information <cite class="ltx_cite ltx_citemacro_citep">(Bhowmick et al., <a href="#bib.bib3" title="" class="ltx_ref">2018</a>; Melis et al., <a href="#bib.bib33" title="" class="ltx_ref">2019</a>)</cite>. In future work, we plan to explore methods for mitigating (unintentional) privacy leakage.</p>
</div>
<div id="A5.p3" class="ltx_para">
<p id="A5.p3.1" class="ltx_p"><span id="A5.p3.1.1" class="ltx_text ltx_font_bold">Concerns on high-dimensional node embedding.</span> As outlined in Section 3.1, we harness model weights as node embeddings. Nevertheless, incorporating large-scale models, such as Transformers <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib62" title="" class="ltx_ref">2017</a>; Ma et al., <a href="#bib.bib30" title="" class="ltx_ref">2022</a>; Dosovitskiy et al., <a href="#bib.bib10" title="" class="ltx_ref">2021</a>)</cite>, may present a formidable obstacle, producing an overwhelmingly high-dimensional node vector. This will significantly increase computational demands for assessing node similarity.
We argue that this can be addressed by dimension reduction. There are two possible ways: (1) Utilizing model weights of certain layers as node embedding instead of the whole model. (2) Directly learning the low-dimensional node embedding. One simple idea is to leverage Hypernetworks <cite class="ltx_cite ltx_citemacro_citep">(Shamsian et al., <a href="#bib.bib52" title="" class="ltx_ref">2021</a>)</cite> to learn the node embedding with controllable dimensions.</p>
</div>
</section>
<section id="A6" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Future Direction</h2>

<div id="A6.p1" class="ltx_para">
<p id="A6.p1.1" class="ltx_p"><span id="A6.p1.1.1" class="ltx_text ltx_font_bold">Handling adversarial clients</span>. We see the potential of using client topology to tackle adversarial clients. In scenarios where clients, due to system or network failures, disobey the protocols and send arbitrary messages (such as shuffled, sign-flipped, or noised parameters), our client topology learning approach becomes particularly useful. These adversarial behaviors typically result in models that show lower similarity to normal models. By leveraging client topology learning, we can identify these adversarial clients as isolated nodes within the topology.
Once identified, applying centrality measures to these nodes can effectively lower their importance scores. This approach minimizes their impact on the overall model aggregation process. Therefore, we envision that our method holds the potential to tackle adversarial clients. Improving FL’s adversarial robustness is an important and interesting problem, we will leave the exploration of TFL in this direction to future work.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2407.04948" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2407.04949" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2407.04949">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2407.04949" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2407.04950" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Aug  5 18:01:41 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
