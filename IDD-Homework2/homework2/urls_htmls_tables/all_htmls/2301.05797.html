<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2301.05797] FedSSC: Shared Supervised-Contrastive Federated Learning</title><meta property="og:description" content="Federated learning is widely used to perform decentralized training of a global model on multiple devices while preserving the data privacy of each device. However, it suffers from heterogeneous local data on each traiâ€¦">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FedSSC: Shared Supervised-Contrastive Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FedSSC: Shared Supervised-Contrastive Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2301.05797">

<!--Generated on Fri Mar  1 06:49:15 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
federated learning,  contrastive learning,  representation sharing,  non-IID
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">FedSSC: Shared Supervised-Contrastive Federated Learning
<br class="ltx_break">
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Sirui Hu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id1.1.id1" class="ltx_text ltx_font_italic">SEAS</span>
<br class="ltx_break"><span id="id2.2.id2" class="ltx_text ltx_font_italic">Harvard University
<br class="ltx_break"></span>siruihu
<br class="ltx_break">@g.harvard.edu
</span></span></span>
<span class="ltx_author_before">â€ƒâ€ƒ</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ling Feng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id3.1.id1" class="ltx_text ltx_font_italic">HSPH</span>
<br class="ltx_break"><span id="id4.2.id2" class="ltx_text ltx_font_italic">Harvard University
<br class="ltx_break"></span>lingfeng
<br class="ltx_break">@hsph.harvard.edu
</span></span></span>
<span class="ltx_author_before">â€ƒâ€ƒ</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiaohan Yang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id5.1.id1" class="ltx_text ltx_font_italic">SEAS</span>
<br class="ltx_break"><span id="id6.2.id2" class="ltx_text ltx_font_italic">Harvard University
<br class="ltx_break"></span>xiaohan_yang
<br class="ltx_break">@g.harvard.edu
</span></span></span>
<span class="ltx_author_before">â€ƒâ€ƒ</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yongchao Chen
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id7.1.id1" class="ltx_text ltx_font_italic">SEAS</span>
<br class="ltx_break"><span id="id8.2.id2" class="ltx_text ltx_font_italic">Harvard University
<br class="ltx_break"></span>yongchaochen
<br class="ltx_break">@fas.harvard.edu
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id9.id1" class="ltx_p">Federated learning is widely used to perform decentralized training of a global model on multiple devices while preserving the data privacy of each device. However, it suffers from heterogeneous local data on each training device which increases the difficulty to reach the same level of accuracy as the centralized training. Supervised Contrastive Learning which outperform cross-entropy tries to minimizes the difference between feature space of points belongs to the same class and pushes away points from different classes. We propose Supervised Contrastive Federated Learning in which devices can share the learned class-wise feature spaces with each other and add the supervised-contrastive learning loss as a regularization term to foster the feature space learning. The loss tries to minimize the cosine similarity distance between the feature map and the averaged feature map from another device in the same class and maximizes the distance between the feature map and that in a different class. This new regularization term when added on top of the moon regularization term is found to outperform the other state-of-the-art regularization terms in solving the heterogeneous data distribution problem.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
federated learning, contrastive learning, representation sharing, non-IID

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federate Learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> has become a hot research topic in recent years due to applications in many fields where participants donâ€™t want to share private training data but want to have a co-trained model with high quality. However, the usually non-iid distribution of training data of participating clients harms the model convergence and model accuracy to a large extent. Supervised Contrastive Learning which tries to minimize the difference between feature space of points belonging to the same class and pushes away points from different classes was found to outperform cross-entropy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> is one of the state-of-the-art regularization terms that is found to be very effective in solving heterogeneity problem in federated learning by utilizing the similarity between model representations to correct the local training of individual parties. Inspired by these two ideas, we propose Shared Supervised-Contrastive Federated Learning(FedSSC) to tackle the heterogeneity problem. In FedSSC, devices can share with each other the learned class-wise feature embeddings and add the supervised-contrastive learning loss as a regularization term to foster the feature space learning. The loss tries to minimize the cosine similarity distance between the current sampleâ€™s feature embedding and the averaged feature embedding from another device if they are in the same class, and on the contrary maximizes the distance if they are in different classes. This new regularization term when added on top of the MOON regularization term is found to outperform the other state-of-the-art regularization terms by getting higher accuracy and converging in fewer rounds.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Problem to Solve</span>
</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.4.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.5.2" class="ltx_text ltx_font_italic">Problem Statement</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.4" class="ltx_p">We are particularly interested in the non-IID setting of federated learning. Specifically, we assume that there are <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">N</annotation></semantics></math> devices, and each of them has the training data <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><msub id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml">D</mi><mi id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2">ğ·</ci><ci id="S2.SS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">D_{i}</annotation></semantics></math> where <math id="S2.SS1.p1.3.m3.4" class="ltx_Math" alttext="i\in\{1,2,...,N\}" display="inline"><semantics id="S2.SS1.p1.3.m3.4a"><mrow id="S2.SS1.p1.3.m3.4.5" xref="S2.SS1.p1.3.m3.4.5.cmml"><mi id="S2.SS1.p1.3.m3.4.5.2" xref="S2.SS1.p1.3.m3.4.5.2.cmml">i</mi><mo id="S2.SS1.p1.3.m3.4.5.1" xref="S2.SS1.p1.3.m3.4.5.1.cmml">âˆˆ</mo><mrow id="S2.SS1.p1.3.m3.4.5.3.2" xref="S2.SS1.p1.3.m3.4.5.3.1.cmml"><mo stretchy="false" id="S2.SS1.p1.3.m3.4.5.3.2.1" xref="S2.SS1.p1.3.m3.4.5.3.1.cmml">{</mo><mn id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">1</mn><mo id="S2.SS1.p1.3.m3.4.5.3.2.2" xref="S2.SS1.p1.3.m3.4.5.3.1.cmml">,</mo><mn id="S2.SS1.p1.3.m3.2.2" xref="S2.SS1.p1.3.m3.2.2.cmml">2</mn><mo id="S2.SS1.p1.3.m3.4.5.3.2.3" xref="S2.SS1.p1.3.m3.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p1.3.m3.3.3" xref="S2.SS1.p1.3.m3.3.3.cmml">â€¦</mi><mo id="S2.SS1.p1.3.m3.4.5.3.2.4" xref="S2.SS1.p1.3.m3.4.5.3.1.cmml">,</mo><mi id="S2.SS1.p1.3.m3.4.4" xref="S2.SS1.p1.3.m3.4.4.cmml">N</mi><mo stretchy="false" id="S2.SS1.p1.3.m3.4.5.3.2.5" xref="S2.SS1.p1.3.m3.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.4b"><apply id="S2.SS1.p1.3.m3.4.5.cmml" xref="S2.SS1.p1.3.m3.4.5"><in id="S2.SS1.p1.3.m3.4.5.1.cmml" xref="S2.SS1.p1.3.m3.4.5.1"></in><ci id="S2.SS1.p1.3.m3.4.5.2.cmml" xref="S2.SS1.p1.3.m3.4.5.2">ğ‘–</ci><set id="S2.SS1.p1.3.m3.4.5.3.1.cmml" xref="S2.SS1.p1.3.m3.4.5.3.2"><cn type="integer" id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">1</cn><cn type="integer" id="S2.SS1.p1.3.m3.2.2.cmml" xref="S2.SS1.p1.3.m3.2.2">2</cn><ci id="S2.SS1.p1.3.m3.3.3.cmml" xref="S2.SS1.p1.3.m3.3.3">â€¦</ci><ci id="S2.SS1.p1.3.m3.4.4.cmml" xref="S2.SS1.p1.3.m3.4.4">ğ‘</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.4c">i\in\{1,2,...,N\}</annotation></semantics></math>. Each <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><msub id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">D</mi><mi id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">ğ·</ci><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">D_{i}</annotation></semantics></math> consists of a different distribution of class labels. Our goal is to learn a machine learning model without local devices directly sharing training data to solve</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.4" class="ltx_Math" alttext="argmin_{w}L(w)=\sum_{i}^{N}\frac{|D_{i}|}{|D|}L_{i}(w)" display="block"><semantics id="S2.E1.m1.4a"><mrow id="S2.E1.m1.4.5" xref="S2.E1.m1.4.5.cmml"><mrow id="S2.E1.m1.4.5.2" xref="S2.E1.m1.4.5.2.cmml"><mi id="S2.E1.m1.4.5.2.2" xref="S2.E1.m1.4.5.2.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.5.2.1" xref="S2.E1.m1.4.5.2.1.cmml">â€‹</mo><mi id="S2.E1.m1.4.5.2.3" xref="S2.E1.m1.4.5.2.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.5.2.1a" xref="S2.E1.m1.4.5.2.1.cmml">â€‹</mo><mi id="S2.E1.m1.4.5.2.4" xref="S2.E1.m1.4.5.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.5.2.1b" xref="S2.E1.m1.4.5.2.1.cmml">â€‹</mo><mi id="S2.E1.m1.4.5.2.5" xref="S2.E1.m1.4.5.2.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.5.2.1c" xref="S2.E1.m1.4.5.2.1.cmml">â€‹</mo><mi id="S2.E1.m1.4.5.2.6" xref="S2.E1.m1.4.5.2.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.5.2.1d" xref="S2.E1.m1.4.5.2.1.cmml">â€‹</mo><msub id="S2.E1.m1.4.5.2.7" xref="S2.E1.m1.4.5.2.7.cmml"><mi id="S2.E1.m1.4.5.2.7.2" xref="S2.E1.m1.4.5.2.7.2.cmml">n</mi><mi id="S2.E1.m1.4.5.2.7.3" xref="S2.E1.m1.4.5.2.7.3.cmml">w</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.5.2.1e" xref="S2.E1.m1.4.5.2.1.cmml">â€‹</mo><mi id="S2.E1.m1.4.5.2.8" xref="S2.E1.m1.4.5.2.8.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.5.2.1f" xref="S2.E1.m1.4.5.2.1.cmml">â€‹</mo><mrow id="S2.E1.m1.4.5.2.9.2" xref="S2.E1.m1.4.5.2.cmml"><mo stretchy="false" id="S2.E1.m1.4.5.2.9.2.1" xref="S2.E1.m1.4.5.2.cmml">(</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">w</mi><mo stretchy="false" id="S2.E1.m1.4.5.2.9.2.2" xref="S2.E1.m1.4.5.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S2.E1.m1.4.5.1" xref="S2.E1.m1.4.5.1.cmml">=</mo><mrow id="S2.E1.m1.4.5.3" xref="S2.E1.m1.4.5.3.cmml"><munderover id="S2.E1.m1.4.5.3.1" xref="S2.E1.m1.4.5.3.1.cmml"><mo movablelimits="false" id="S2.E1.m1.4.5.3.1.2.2" xref="S2.E1.m1.4.5.3.1.2.2.cmml">âˆ‘</mo><mi id="S2.E1.m1.4.5.3.1.2.3" xref="S2.E1.m1.4.5.3.1.2.3.cmml">i</mi><mi id="S2.E1.m1.4.5.3.1.3" xref="S2.E1.m1.4.5.3.1.3.cmml">N</mi></munderover><mrow id="S2.E1.m1.4.5.3.2" xref="S2.E1.m1.4.5.3.2.cmml"><mfrac id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml"><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.2.1.cmml">|</mo><msub id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.2.cmml">D</mi><mi id="S2.E1.m1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.E1.m1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S2.E1.m1.2.2.2.3" xref="S2.E1.m1.2.2.2.2.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.2.3.1" xref="S2.E1.m1.2.2.2.2.1.cmml">|</mo><mi id="S2.E1.m1.2.2.2.1" xref="S2.E1.m1.2.2.2.1.cmml">D</mi><mo stretchy="false" id="S2.E1.m1.2.2.2.3.2" xref="S2.E1.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.5.3.2.1" xref="S2.E1.m1.4.5.3.2.1.cmml">â€‹</mo><msub id="S2.E1.m1.4.5.3.2.2" xref="S2.E1.m1.4.5.3.2.2.cmml"><mi id="S2.E1.m1.4.5.3.2.2.2" xref="S2.E1.m1.4.5.3.2.2.2.cmml">L</mi><mi id="S2.E1.m1.4.5.3.2.2.3" xref="S2.E1.m1.4.5.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.5.3.2.1a" xref="S2.E1.m1.4.5.3.2.1.cmml">â€‹</mo><mrow id="S2.E1.m1.4.5.3.2.3.2" xref="S2.E1.m1.4.5.3.2.cmml"><mo stretchy="false" id="S2.E1.m1.4.5.3.2.3.2.1" xref="S2.E1.m1.4.5.3.2.cmml">(</mo><mi id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">w</mi><mo stretchy="false" id="S2.E1.m1.4.5.3.2.3.2.2" xref="S2.E1.m1.4.5.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.4b"><apply id="S2.E1.m1.4.5.cmml" xref="S2.E1.m1.4.5"><eq id="S2.E1.m1.4.5.1.cmml" xref="S2.E1.m1.4.5.1"></eq><apply id="S2.E1.m1.4.5.2.cmml" xref="S2.E1.m1.4.5.2"><times id="S2.E1.m1.4.5.2.1.cmml" xref="S2.E1.m1.4.5.2.1"></times><ci id="S2.E1.m1.4.5.2.2.cmml" xref="S2.E1.m1.4.5.2.2">ğ‘</ci><ci id="S2.E1.m1.4.5.2.3.cmml" xref="S2.E1.m1.4.5.2.3">ğ‘Ÿ</ci><ci id="S2.E1.m1.4.5.2.4.cmml" xref="S2.E1.m1.4.5.2.4">ğ‘”</ci><ci id="S2.E1.m1.4.5.2.5.cmml" xref="S2.E1.m1.4.5.2.5">ğ‘š</ci><ci id="S2.E1.m1.4.5.2.6.cmml" xref="S2.E1.m1.4.5.2.6">ğ‘–</ci><apply id="S2.E1.m1.4.5.2.7.cmml" xref="S2.E1.m1.4.5.2.7"><csymbol cd="ambiguous" id="S2.E1.m1.4.5.2.7.1.cmml" xref="S2.E1.m1.4.5.2.7">subscript</csymbol><ci id="S2.E1.m1.4.5.2.7.2.cmml" xref="S2.E1.m1.4.5.2.7.2">ğ‘›</ci><ci id="S2.E1.m1.4.5.2.7.3.cmml" xref="S2.E1.m1.4.5.2.7.3">ğ‘¤</ci></apply><ci id="S2.E1.m1.4.5.2.8.cmml" xref="S2.E1.m1.4.5.2.8">ğ¿</ci><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">ğ‘¤</ci></apply><apply id="S2.E1.m1.4.5.3.cmml" xref="S2.E1.m1.4.5.3"><apply id="S2.E1.m1.4.5.3.1.cmml" xref="S2.E1.m1.4.5.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.4.5.3.1.1.cmml" xref="S2.E1.m1.4.5.3.1">superscript</csymbol><apply id="S2.E1.m1.4.5.3.1.2.cmml" xref="S2.E1.m1.4.5.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.4.5.3.1.2.1.cmml" xref="S2.E1.m1.4.5.3.1">subscript</csymbol><sum id="S2.E1.m1.4.5.3.1.2.2.cmml" xref="S2.E1.m1.4.5.3.1.2.2"></sum><ci id="S2.E1.m1.4.5.3.1.2.3.cmml" xref="S2.E1.m1.4.5.3.1.2.3">ğ‘–</ci></apply><ci id="S2.E1.m1.4.5.3.1.3.cmml" xref="S2.E1.m1.4.5.3.1.3">ğ‘</ci></apply><apply id="S2.E1.m1.4.5.3.2.cmml" xref="S2.E1.m1.4.5.3.2"><times id="S2.E1.m1.4.5.3.2.1.cmml" xref="S2.E1.m1.4.5.3.2.1"></times><apply id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2"><divide id="S2.E1.m1.2.2.3.cmml" xref="S2.E1.m1.2.2"></divide><apply id="S2.E1.m1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1"><abs id="S2.E1.m1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.2"></abs><apply id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2">ğ·</ci><ci id="S2.E1.m1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.3">ğ‘–</ci></apply></apply><apply id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.3"><abs id="S2.E1.m1.2.2.2.2.1.cmml" xref="S2.E1.m1.2.2.2.3.1"></abs><ci id="S2.E1.m1.2.2.2.1.cmml" xref="S2.E1.m1.2.2.2.1">ğ·</ci></apply></apply><apply id="S2.E1.m1.4.5.3.2.2.cmml" xref="S2.E1.m1.4.5.3.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.4.5.3.2.2.1.cmml" xref="S2.E1.m1.4.5.3.2.2">subscript</csymbol><ci id="S2.E1.m1.4.5.3.2.2.2.cmml" xref="S2.E1.m1.4.5.3.2.2.2">ğ¿</ci><ci id="S2.E1.m1.4.5.3.2.2.3.cmml" xref="S2.E1.m1.4.5.3.2.2.3">ğ‘–</ci></apply><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">ğ‘¤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.4c">argmin_{w}L(w)=\sum_{i}^{N}\frac{|D_{i}|}{|D|}L_{i}(w)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p2.1" class="ltx_p">where <math id="S2.SS1.p2.1.m1.1" class="ltx_Math" alttext="L_{i}(w)" display="inline"><semantics id="S2.SS1.p2.1.m1.1a"><mrow id="S2.SS1.p2.1.m1.1.2" xref="S2.SS1.p2.1.m1.1.2.cmml"><msub id="S2.SS1.p2.1.m1.1.2.2" xref="S2.SS1.p2.1.m1.1.2.2.cmml"><mi id="S2.SS1.p2.1.m1.1.2.2.2" xref="S2.SS1.p2.1.m1.1.2.2.2.cmml">L</mi><mi id="S2.SS1.p2.1.m1.1.2.2.3" xref="S2.SS1.p2.1.m1.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p2.1.m1.1.2.1" xref="S2.SS1.p2.1.m1.1.2.1.cmml">â€‹</mo><mrow id="S2.SS1.p2.1.m1.1.2.3.2" xref="S2.SS1.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p2.1.m1.1.2.3.2.1" xref="S2.SS1.p2.1.m1.1.2.cmml">(</mo><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">w</mi><mo stretchy="false" id="S2.SS1.p2.1.m1.1.2.3.2.2" xref="S2.SS1.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.2"><times id="S2.SS1.p2.1.m1.1.2.1.cmml" xref="S2.SS1.p2.1.m1.1.2.1"></times><apply id="S2.SS1.p2.1.m1.1.2.2.cmml" xref="S2.SS1.p2.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.2.2.1.cmml" xref="S2.SS1.p2.1.m1.1.2.2">subscript</csymbol><ci id="S2.SS1.p2.1.m1.1.2.2.2.cmml" xref="S2.SS1.p2.1.m1.1.2.2.2">ğ¿</ci><ci id="S2.SS1.p2.1.m1.1.2.2.3.cmml" xref="S2.SS1.p2.1.m1.1.2.2.3">ğ‘–</ci></apply><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">ğ‘¤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">L_{i}(w)</annotation></semantics></math> is the empirical loss of the local device.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.4.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.5.2" class="ltx_text ltx_font_italic">Background</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Federated learning is widely used to perform decentralized training of a global model on multiple devices while preserving the data privacy of each device. One of the most basic yet popular models is FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> algorithm, in which a central server aggregates the local model weights on each device to build a global model without directly accessing the local training data. However, it suffers from heterogeneous local data on each training device which increases the difficulty of reaching the same level of accuracy as the centralized training. To tackle the heterogeneity, MOON proposes to add a regularization term to
prevent local feature representation of the image from being too far from the global feature representation of the same image <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. MOON outperformed other regularization terms like FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS3.4.1.1" class="ltx_text">II-C</span> </span><span id="S2.SS3.5.2" class="ltx_text ltx_font_italic">Research Goal</span>
</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">The goal of our research is to improve the federated learning algorithm in non-IID scenarios without sharing raw data across devices. Specifically, we would like to introduce an extra regularization for class-wise feature space through supervised contrastive loss on top of the MOON regularization term.</p>
</div>
</section>
<section id="S2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS4.4.1.1" class="ltx_text">II-D</span> </span><span id="S2.SS4.5.2" class="ltx_text ltx_font_italic">Evaluation Metrics</span>
</h3>

<div id="S2.SS4.p1" class="ltx_para">
<p id="S2.SS4.p1.1" class="ltx_p">To compare our method with other existing approaches, we evaluate the model performance by the top-1 accuracy of global model on an isolated test set. Moreover, we use the number of communication rounds to achieve the same level of accuracy as our metric for convergence speed.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Approach</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.8" class="ltx_p">Inspired by the idea of Supervised Contrastive Learning, in addition to the MOON loss FedSSC utilizes class-wise average feature maps shared by other devices to correct local training and to tackle the heterogeneity problem. The objective function for the local device is composed of three parts: 1) typical supervised learning loss term calculated with cross-entropy (<math id="S3.p1.1.m1.1" class="ltx_Math" alttext="l_{class}" display="inline"><semantics id="S3.p1.1.m1.1a"><msub id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml">l</mi><mrow id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml"><mi id="S3.p1.1.m1.1.1.3.2" xref="S3.p1.1.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.p1.1.m1.1.1.3.1" xref="S3.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.p1.1.m1.1.1.3.3" xref="S3.p1.1.m1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.p1.1.m1.1.1.3.1a" xref="S3.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.p1.1.m1.1.1.3.4" xref="S3.p1.1.m1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.p1.1.m1.1.1.3.1b" xref="S3.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.p1.1.m1.1.1.3.5" xref="S3.p1.1.m1.1.1.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p1.1.m1.1.1.3.1c" xref="S3.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.p1.1.m1.1.1.3.6" xref="S3.p1.1.m1.1.1.3.6.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2">ğ‘™</ci><apply id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3"><times id="S3.p1.1.m1.1.1.3.1.cmml" xref="S3.p1.1.m1.1.1.3.1"></times><ci id="S3.p1.1.m1.1.1.3.2.cmml" xref="S3.p1.1.m1.1.1.3.2">ğ‘</ci><ci id="S3.p1.1.m1.1.1.3.3.cmml" xref="S3.p1.1.m1.1.1.3.3">ğ‘™</ci><ci id="S3.p1.1.m1.1.1.3.4.cmml" xref="S3.p1.1.m1.1.1.3.4">ğ‘</ci><ci id="S3.p1.1.m1.1.1.3.5.cmml" xref="S3.p1.1.m1.1.1.3.5">ğ‘ </ci><ci id="S3.p1.1.m1.1.1.3.6.cmml" xref="S3.p1.1.m1.1.1.3.6">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">l_{class}</annotation></semantics></math>), 2) MOON loss (<math id="S3.p1.2.m2.1" class="ltx_Math" alttext="l_{moon}" display="inline"><semantics id="S3.p1.2.m2.1a"><msub id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">l</mi><mrow id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml"><mi id="S3.p1.2.m2.1.1.3.2" xref="S3.p1.2.m2.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.p1.2.m2.1.1.3.1" xref="S3.p1.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S3.p1.2.m2.1.1.3.3" xref="S3.p1.2.m2.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p1.2.m2.1.1.3.1a" xref="S3.p1.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S3.p1.2.m2.1.1.3.4" xref="S3.p1.2.m2.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p1.2.m2.1.1.3.1b" xref="S3.p1.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S3.p1.2.m2.1.1.3.5" xref="S3.p1.2.m2.1.1.3.5.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">ğ‘™</ci><apply id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3"><times id="S3.p1.2.m2.1.1.3.1.cmml" xref="S3.p1.2.m2.1.1.3.1"></times><ci id="S3.p1.2.m2.1.1.3.2.cmml" xref="S3.p1.2.m2.1.1.3.2">ğ‘š</ci><ci id="S3.p1.2.m2.1.1.3.3.cmml" xref="S3.p1.2.m2.1.1.3.3">ğ‘œ</ci><ci id="S3.p1.2.m2.1.1.3.4.cmml" xref="S3.p1.2.m2.1.1.3.4">ğ‘œ</ci><ci id="S3.p1.2.m2.1.1.3.5.cmml" xref="S3.p1.2.m2.1.1.3.5">ğ‘›</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">l_{moon}</annotation></semantics></math>), and 3) global class-wise contrastive loss (<math id="S3.p1.3.m3.1" class="ltx_Math" alttext="l_{glob}" display="inline"><semantics id="S3.p1.3.m3.1a"><msub id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml"><mi id="S3.p1.3.m3.1.1.2" xref="S3.p1.3.m3.1.1.2.cmml">l</mi><mrow id="S3.p1.3.m3.1.1.3" xref="S3.p1.3.m3.1.1.3.cmml"><mi id="S3.p1.3.m3.1.1.3.2" xref="S3.p1.3.m3.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.p1.3.m3.1.1.3.1" xref="S3.p1.3.m3.1.1.3.1.cmml">â€‹</mo><mi id="S3.p1.3.m3.1.1.3.3" xref="S3.p1.3.m3.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.p1.3.m3.1.1.3.1a" xref="S3.p1.3.m3.1.1.3.1.cmml">â€‹</mo><mi id="S3.p1.3.m3.1.1.3.4" xref="S3.p1.3.m3.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p1.3.m3.1.1.3.1b" xref="S3.p1.3.m3.1.1.3.1.cmml">â€‹</mo><mi id="S3.p1.3.m3.1.1.3.5" xref="S3.p1.3.m3.1.1.3.5.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><apply id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.1.cmml" xref="S3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.p1.3.m3.1.1.2.cmml" xref="S3.p1.3.m3.1.1.2">ğ‘™</ci><apply id="S3.p1.3.m3.1.1.3.cmml" xref="S3.p1.3.m3.1.1.3"><times id="S3.p1.3.m3.1.1.3.1.cmml" xref="S3.p1.3.m3.1.1.3.1"></times><ci id="S3.p1.3.m3.1.1.3.2.cmml" xref="S3.p1.3.m3.1.1.3.2">ğ‘”</ci><ci id="S3.p1.3.m3.1.1.3.3.cmml" xref="S3.p1.3.m3.1.1.3.3">ğ‘™</ci><ci id="S3.p1.3.m3.1.1.3.4.cmml" xref="S3.p1.3.m3.1.1.3.4">ğ‘œ</ci><ci id="S3.p1.3.m3.1.1.3.5.cmml" xref="S3.p1.3.m3.1.1.3.5">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">l_{glob}</annotation></semantics></math>). With <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.p1.4.m4.1a"><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">Ï„</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">ğœ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">\tau</annotation></semantics></math> being the temperature, <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="l_{moon}" display="inline"><semantics id="S3.p1.5.m5.1a"><msub id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><mi id="S3.p1.5.m5.1.1.2" xref="S3.p1.5.m5.1.1.2.cmml">l</mi><mrow id="S3.p1.5.m5.1.1.3" xref="S3.p1.5.m5.1.1.3.cmml"><mi id="S3.p1.5.m5.1.1.3.2" xref="S3.p1.5.m5.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.p1.5.m5.1.1.3.1" xref="S3.p1.5.m5.1.1.3.1.cmml">â€‹</mo><mi id="S3.p1.5.m5.1.1.3.3" xref="S3.p1.5.m5.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p1.5.m5.1.1.3.1a" xref="S3.p1.5.m5.1.1.3.1.cmml">â€‹</mo><mi id="S3.p1.5.m5.1.1.3.4" xref="S3.p1.5.m5.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p1.5.m5.1.1.3.1b" xref="S3.p1.5.m5.1.1.3.1.cmml">â€‹</mo><mi id="S3.p1.5.m5.1.1.3.5" xref="S3.p1.5.m5.1.1.3.5.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2">ğ‘™</ci><apply id="S3.p1.5.m5.1.1.3.cmml" xref="S3.p1.5.m5.1.1.3"><times id="S3.p1.5.m5.1.1.3.1.cmml" xref="S3.p1.5.m5.1.1.3.1"></times><ci id="S3.p1.5.m5.1.1.3.2.cmml" xref="S3.p1.5.m5.1.1.3.2">ğ‘š</ci><ci id="S3.p1.5.m5.1.1.3.3.cmml" xref="S3.p1.5.m5.1.1.3.3">ğ‘œ</ci><ci id="S3.p1.5.m5.1.1.3.4.cmml" xref="S3.p1.5.m5.1.1.3.4">ğ‘œ</ci><ci id="S3.p1.5.m5.1.1.3.5.cmml" xref="S3.p1.5.m5.1.1.3.5">ğ‘›</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">l_{moon}</annotation></semantics></math> takes the projected feature representations <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.p1.6.m6.1a"><mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">ğ‘§</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">z</annotation></semantics></math>, <math id="S3.p1.7.m7.1" class="ltx_Math" alttext="z_{glob}" display="inline"><semantics id="S3.p1.7.m7.1a"><msub id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml"><mi id="S3.p1.7.m7.1.1.2" xref="S3.p1.7.m7.1.1.2.cmml">z</mi><mrow id="S3.p1.7.m7.1.1.3" xref="S3.p1.7.m7.1.1.3.cmml"><mi id="S3.p1.7.m7.1.1.3.2" xref="S3.p1.7.m7.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.p1.7.m7.1.1.3.1" xref="S3.p1.7.m7.1.1.3.1.cmml">â€‹</mo><mi id="S3.p1.7.m7.1.1.3.3" xref="S3.p1.7.m7.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.p1.7.m7.1.1.3.1a" xref="S3.p1.7.m7.1.1.3.1.cmml">â€‹</mo><mi id="S3.p1.7.m7.1.1.3.4" xref="S3.p1.7.m7.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p1.7.m7.1.1.3.1b" xref="S3.p1.7.m7.1.1.3.1.cmml">â€‹</mo><mi id="S3.p1.7.m7.1.1.3.5" xref="S3.p1.7.m7.1.1.3.5.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.1.cmml" xref="S3.p1.7.m7.1.1">subscript</csymbol><ci id="S3.p1.7.m7.1.1.2.cmml" xref="S3.p1.7.m7.1.1.2">ğ‘§</ci><apply id="S3.p1.7.m7.1.1.3.cmml" xref="S3.p1.7.m7.1.1.3"><times id="S3.p1.7.m7.1.1.3.1.cmml" xref="S3.p1.7.m7.1.1.3.1"></times><ci id="S3.p1.7.m7.1.1.3.2.cmml" xref="S3.p1.7.m7.1.1.3.2">ğ‘”</ci><ci id="S3.p1.7.m7.1.1.3.3.cmml" xref="S3.p1.7.m7.1.1.3.3">ğ‘™</ci><ci id="S3.p1.7.m7.1.1.3.4.cmml" xref="S3.p1.7.m7.1.1.3.4">ğ‘œ</ci><ci id="S3.p1.7.m7.1.1.3.5.cmml" xref="S3.p1.7.m7.1.1.3.5">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">z_{glob}</annotation></semantics></math>, and <math id="S3.p1.8.m8.1" class="ltx_Math" alttext="z_{prev}" display="inline"><semantics id="S3.p1.8.m8.1a"><msub id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml"><mi id="S3.p1.8.m8.1.1.2" xref="S3.p1.8.m8.1.1.2.cmml">z</mi><mrow id="S3.p1.8.m8.1.1.3" xref="S3.p1.8.m8.1.1.3.cmml"><mi id="S3.p1.8.m8.1.1.3.2" xref="S3.p1.8.m8.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.p1.8.m8.1.1.3.1" xref="S3.p1.8.m8.1.1.3.1.cmml">â€‹</mo><mi id="S3.p1.8.m8.1.1.3.3" xref="S3.p1.8.m8.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.p1.8.m8.1.1.3.1a" xref="S3.p1.8.m8.1.1.3.1.cmml">â€‹</mo><mi id="S3.p1.8.m8.1.1.3.4" xref="S3.p1.8.m8.1.1.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.p1.8.m8.1.1.3.1b" xref="S3.p1.8.m8.1.1.3.1.cmml">â€‹</mo><mi id="S3.p1.8.m8.1.1.3.5" xref="S3.p1.8.m8.1.1.3.5.cmml">v</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><apply id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.1.cmml" xref="S3.p1.8.m8.1.1">subscript</csymbol><ci id="S3.p1.8.m8.1.1.2.cmml" xref="S3.p1.8.m8.1.1.2">ğ‘§</ci><apply id="S3.p1.8.m8.1.1.3.cmml" xref="S3.p1.8.m8.1.1.3"><times id="S3.p1.8.m8.1.1.3.1.cmml" xref="S3.p1.8.m8.1.1.3.1"></times><ci id="S3.p1.8.m8.1.1.3.2.cmml" xref="S3.p1.8.m8.1.1.3.2">ğ‘</ci><ci id="S3.p1.8.m8.1.1.3.3.cmml" xref="S3.p1.8.m8.1.1.3.3">ğ‘Ÿ</ci><ci id="S3.p1.8.m8.1.1.3.4.cmml" xref="S3.p1.8.m8.1.1.3.4">ğ‘’</ci><ci id="S3.p1.8.m8.1.1.3.5.cmml" xref="S3.p1.8.m8.1.1.3.5">ğ‘£</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">z_{prev}</annotation></semantics></math> by passing the same image into the current model, the current roundâ€™s global model, and the previous epochâ€™s model<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.6" class="ltx_Math" alttext="l_{moon}=-log\frac{exp(sim(z,z_{glob})/\tau)}{exp(sim(z,z_{glob})/\tau)+exp(sim(z,z_{prev})/\tau)}\\
" display="block"><semantics id="S3.E2.m1.6a"><mrow id="S3.E2.m1.6.7" xref="S3.E2.m1.6.7.cmml"><msub id="S3.E2.m1.6.7.2" xref="S3.E2.m1.6.7.2.cmml"><mi id="S3.E2.m1.6.7.2.2" xref="S3.E2.m1.6.7.2.2.cmml">l</mi><mrow id="S3.E2.m1.6.7.2.3" xref="S3.E2.m1.6.7.2.3.cmml"><mi id="S3.E2.m1.6.7.2.3.2" xref="S3.E2.m1.6.7.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.7.2.3.1" xref="S3.E2.m1.6.7.2.3.1.cmml">â€‹</mo><mi id="S3.E2.m1.6.7.2.3.3" xref="S3.E2.m1.6.7.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.7.2.3.1a" xref="S3.E2.m1.6.7.2.3.1.cmml">â€‹</mo><mi id="S3.E2.m1.6.7.2.3.4" xref="S3.E2.m1.6.7.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.7.2.3.1b" xref="S3.E2.m1.6.7.2.3.1.cmml">â€‹</mo><mi id="S3.E2.m1.6.7.2.3.5" xref="S3.E2.m1.6.7.2.3.5.cmml">n</mi></mrow></msub><mo id="S3.E2.m1.6.7.1" xref="S3.E2.m1.6.7.1.cmml">=</mo><mrow id="S3.E2.m1.6.7.3" xref="S3.E2.m1.6.7.3.cmml"><mo id="S3.E2.m1.6.7.3a" xref="S3.E2.m1.6.7.3.cmml">âˆ’</mo><mrow id="S3.E2.m1.6.7.3.2" xref="S3.E2.m1.6.7.3.2.cmml"><mi id="S3.E2.m1.6.7.3.2.2" xref="S3.E2.m1.6.7.3.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.7.3.2.1" xref="S3.E2.m1.6.7.3.2.1.cmml">â€‹</mo><mi id="S3.E2.m1.6.7.3.2.3" xref="S3.E2.m1.6.7.3.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.7.3.2.1a" xref="S3.E2.m1.6.7.3.2.1.cmml">â€‹</mo><mi id="S3.E2.m1.6.7.3.2.4" xref="S3.E2.m1.6.7.3.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.7.3.2.1b" xref="S3.E2.m1.6.7.3.2.1.cmml">â€‹</mo><mfrac id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml"><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml"><mi id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.2.3.cmml">â€‹</mo><mi id="S3.E2.m1.2.2.2.5" xref="S3.E2.m1.2.2.2.5.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.3a" xref="S3.E2.m1.2.2.2.3.cmml">â€‹</mo><mi id="S3.E2.m1.2.2.2.6" xref="S3.E2.m1.2.2.2.6.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.3b" xref="S3.E2.m1.2.2.2.3.cmml">â€‹</mo><mrow id="S3.E2.m1.2.2.2.2.1" xref="S3.E2.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.2.1.2" xref="S3.E2.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.E2.m1.2.2.2.2.1.1" xref="S3.E2.m1.2.2.2.2.1.1.cmml"><mrow id="S3.E2.m1.2.2.2.2.1.1.1" xref="S3.E2.m1.2.2.2.2.1.1.1.cmml"><mi id="S3.E2.m1.2.2.2.2.1.1.1.3" xref="S3.E2.m1.2.2.2.2.1.1.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1.1.2" xref="S3.E2.m1.2.2.2.2.1.1.1.2.cmml">â€‹</mo><mi id="S3.E2.m1.2.2.2.2.1.1.1.4" xref="S3.E2.m1.2.2.2.2.1.1.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1.1.2a" xref="S3.E2.m1.2.2.2.2.1.1.1.2.cmml">â€‹</mo><mi id="S3.E2.m1.2.2.2.2.1.1.1.5" xref="S3.E2.m1.2.2.2.2.1.1.1.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1.1.2b" xref="S3.E2.m1.2.2.2.2.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.1" xref="S3.E2.m1.2.2.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2" xref="S3.E2.m1.2.2.2.2.1.1.1.1.2.cmml">(</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">z</mi><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.1.3" xref="S3.E2.m1.2.2.2.2.1.1.1.1.2.cmml">,</mo><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.2" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.1" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.1.cmml">â€‹</mo><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.3" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.1a" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.1.cmml">â€‹</mo><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.4" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.1b" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.1.cmml">â€‹</mo><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.5" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.5.cmml">b</mi></mrow></msub><mo stretchy="false" id="S3.E2.m1.2.2.2.2.1.1.1.1.1.4" xref="S3.E2.m1.2.2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.2.2.2.2.1.1.2" xref="S3.E2.m1.2.2.2.2.1.1.2.cmml">/</mo><mi id="S3.E2.m1.2.2.2.2.1.1.3" xref="S3.E2.m1.2.2.2.2.1.1.3.cmml">Ï„</mi></mrow><mo stretchy="false" id="S3.E2.m1.2.2.2.2.1.3" xref="S3.E2.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E2.m1.6.6.6" xref="S3.E2.m1.6.6.6.cmml"><mrow id="S3.E2.m1.5.5.5.3" xref="S3.E2.m1.5.5.5.3.cmml"><mi id="S3.E2.m1.5.5.5.3.3" xref="S3.E2.m1.5.5.5.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.5.3.2" xref="S3.E2.m1.5.5.5.3.2.cmml">â€‹</mo><mi id="S3.E2.m1.5.5.5.3.4" xref="S3.E2.m1.5.5.5.3.4.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.5.3.2a" xref="S3.E2.m1.5.5.5.3.2.cmml">â€‹</mo><mi id="S3.E2.m1.5.5.5.3.5" xref="S3.E2.m1.5.5.5.3.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.5.3.2b" xref="S3.E2.m1.5.5.5.3.2.cmml">â€‹</mo><mrow id="S3.E2.m1.5.5.5.3.1.1" xref="S3.E2.m1.5.5.5.3.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.5.5.5.3.1.1.2" xref="S3.E2.m1.5.5.5.3.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.5.5.5.3.1.1.1" xref="S3.E2.m1.5.5.5.3.1.1.1.cmml"><mrow id="S3.E2.m1.5.5.5.3.1.1.1.1" xref="S3.E2.m1.5.5.5.3.1.1.1.1.cmml"><mi id="S3.E2.m1.5.5.5.3.1.1.1.1.3" xref="S3.E2.m1.5.5.5.3.1.1.1.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.5.3.1.1.1.1.2" xref="S3.E2.m1.5.5.5.3.1.1.1.1.2.cmml">â€‹</mo><mi id="S3.E2.m1.5.5.5.3.1.1.1.1.4" xref="S3.E2.m1.5.5.5.3.1.1.1.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.5.3.1.1.1.1.2a" xref="S3.E2.m1.5.5.5.3.1.1.1.1.2.cmml">â€‹</mo><mi id="S3.E2.m1.5.5.5.3.1.1.1.1.5" xref="S3.E2.m1.5.5.5.3.1.1.1.1.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.5.3.1.1.1.1.2b" xref="S3.E2.m1.5.5.5.3.1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E2.m1.3.3.3.1" xref="S3.E2.m1.3.3.3.1.cmml">z</mi><mo id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.3" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.2" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.1.cmml">â€‹</mo><mi id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.1a" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.1.cmml">â€‹</mo><mi id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.4" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.1b" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.1.cmml">â€‹</mo><mi id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.5" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.5.cmml">b</mi></mrow></msub><mo stretchy="false" id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.4" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.5.5.5.3.1.1.1.2" xref="S3.E2.m1.5.5.5.3.1.1.1.2.cmml">/</mo><mi id="S3.E2.m1.5.5.5.3.1.1.1.3" xref="S3.E2.m1.5.5.5.3.1.1.1.3.cmml">Ï„</mi></mrow><mo stretchy="false" id="S3.E2.m1.5.5.5.3.1.1.3" xref="S3.E2.m1.5.5.5.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.6.6.6.5" xref="S3.E2.m1.6.6.6.5.cmml">+</mo><mrow id="S3.E2.m1.6.6.6.4" xref="S3.E2.m1.6.6.6.4.cmml"><mi id="S3.E2.m1.6.6.6.4.3" xref="S3.E2.m1.6.6.6.4.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.6.4.2" xref="S3.E2.m1.6.6.6.4.2.cmml">â€‹</mo><mi id="S3.E2.m1.6.6.6.4.4" xref="S3.E2.m1.6.6.6.4.4.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.6.4.2a" xref="S3.E2.m1.6.6.6.4.2.cmml">â€‹</mo><mi id="S3.E2.m1.6.6.6.4.5" xref="S3.E2.m1.6.6.6.4.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.6.4.2b" xref="S3.E2.m1.6.6.6.4.2.cmml">â€‹</mo><mrow id="S3.E2.m1.6.6.6.4.1.1" xref="S3.E2.m1.6.6.6.4.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.6.6.6.4.1.1.2" xref="S3.E2.m1.6.6.6.4.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.6.6.6.4.1.1.1" xref="S3.E2.m1.6.6.6.4.1.1.1.cmml"><mrow id="S3.E2.m1.6.6.6.4.1.1.1.1" xref="S3.E2.m1.6.6.6.4.1.1.1.1.cmml"><mi id="S3.E2.m1.6.6.6.4.1.1.1.1.3" xref="S3.E2.m1.6.6.6.4.1.1.1.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.6.4.1.1.1.1.2" xref="S3.E2.m1.6.6.6.4.1.1.1.1.2.cmml">â€‹</mo><mi id="S3.E2.m1.6.6.6.4.1.1.1.1.4" xref="S3.E2.m1.6.6.6.4.1.1.1.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.6.4.1.1.1.1.2a" xref="S3.E2.m1.6.6.6.4.1.1.1.1.2.cmml">â€‹</mo><mi id="S3.E2.m1.6.6.6.4.1.1.1.1.5" xref="S3.E2.m1.6.6.6.4.1.1.1.1.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.6.4.1.1.1.1.2b" xref="S3.E2.m1.6.6.6.4.1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E2.m1.4.4.4.2" xref="S3.E2.m1.4.4.4.2.cmml">z</mi><mo id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.1.cmml">â€‹</mo><mi id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.1a" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.1.cmml">â€‹</mo><mi id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.4" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.1b" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.1.cmml">â€‹</mo><mi id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.5" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.5.cmml">v</mi></mrow></msub><mo stretchy="false" id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.4" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.6.6.6.4.1.1.1.2" xref="S3.E2.m1.6.6.6.4.1.1.1.2.cmml">/</mo><mi id="S3.E2.m1.6.6.6.4.1.1.1.3" xref="S3.E2.m1.6.6.6.4.1.1.1.3.cmml">Ï„</mi></mrow><mo stretchy="false" id="S3.E2.m1.6.6.6.4.1.1.3" xref="S3.E2.m1.6.6.6.4.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.6b"><apply id="S3.E2.m1.6.7.cmml" xref="S3.E2.m1.6.7"><eq id="S3.E2.m1.6.7.1.cmml" xref="S3.E2.m1.6.7.1"></eq><apply id="S3.E2.m1.6.7.2.cmml" xref="S3.E2.m1.6.7.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.7.2.1.cmml" xref="S3.E2.m1.6.7.2">subscript</csymbol><ci id="S3.E2.m1.6.7.2.2.cmml" xref="S3.E2.m1.6.7.2.2">ğ‘™</ci><apply id="S3.E2.m1.6.7.2.3.cmml" xref="S3.E2.m1.6.7.2.3"><times id="S3.E2.m1.6.7.2.3.1.cmml" xref="S3.E2.m1.6.7.2.3.1"></times><ci id="S3.E2.m1.6.7.2.3.2.cmml" xref="S3.E2.m1.6.7.2.3.2">ğ‘š</ci><ci id="S3.E2.m1.6.7.2.3.3.cmml" xref="S3.E2.m1.6.7.2.3.3">ğ‘œ</ci><ci id="S3.E2.m1.6.7.2.3.4.cmml" xref="S3.E2.m1.6.7.2.3.4">ğ‘œ</ci><ci id="S3.E2.m1.6.7.2.3.5.cmml" xref="S3.E2.m1.6.7.2.3.5">ğ‘›</ci></apply></apply><apply id="S3.E2.m1.6.7.3.cmml" xref="S3.E2.m1.6.7.3"><minus id="S3.E2.m1.6.7.3.1.cmml" xref="S3.E2.m1.6.7.3"></minus><apply id="S3.E2.m1.6.7.3.2.cmml" xref="S3.E2.m1.6.7.3.2"><times id="S3.E2.m1.6.7.3.2.1.cmml" xref="S3.E2.m1.6.7.3.2.1"></times><ci id="S3.E2.m1.6.7.3.2.2.cmml" xref="S3.E2.m1.6.7.3.2.2">ğ‘™</ci><ci id="S3.E2.m1.6.7.3.2.3.cmml" xref="S3.E2.m1.6.7.3.2.3">ğ‘œ</ci><ci id="S3.E2.m1.6.7.3.2.4.cmml" xref="S3.E2.m1.6.7.3.2.4">ğ‘”</ci><apply id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6"><divide id="S3.E2.m1.6.6.7.cmml" xref="S3.E2.m1.6.6"></divide><apply id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"><times id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.3"></times><ci id="S3.E2.m1.2.2.2.4.cmml" xref="S3.E2.m1.2.2.2.4">ğ‘’</ci><ci id="S3.E2.m1.2.2.2.5.cmml" xref="S3.E2.m1.2.2.2.5">ğ‘¥</ci><ci id="S3.E2.m1.2.2.2.6.cmml" xref="S3.E2.m1.2.2.2.6">ğ‘</ci><apply id="S3.E2.m1.2.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1"><divide id="S3.E2.m1.2.2.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.2"></divide><apply id="S3.E2.m1.2.2.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1"><times id="S3.E2.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.2"></times><ci id="S3.E2.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.3">ğ‘ </ci><ci id="S3.E2.m1.2.2.2.2.1.1.1.4.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.4">ğ‘–</ci><ci id="S3.E2.m1.2.2.2.2.1.1.1.5.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.5">ğ‘š</ci><interval closure="open" id="S3.E2.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">ğ‘§</ci><apply id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.2">ğ‘§</ci><apply id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3"><times id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.1"></times><ci id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.2">ğ‘”</ci><ci id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.3">ğ‘™</ci><ci id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.4.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.4">ğ‘œ</ci><ci id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.5.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.5">ğ‘</ci></apply></apply></interval></apply><ci id="S3.E2.m1.2.2.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.3">ğœ</ci></apply></apply><apply id="S3.E2.m1.6.6.6.cmml" xref="S3.E2.m1.6.6.6"><plus id="S3.E2.m1.6.6.6.5.cmml" xref="S3.E2.m1.6.6.6.5"></plus><apply id="S3.E2.m1.5.5.5.3.cmml" xref="S3.E2.m1.5.5.5.3"><times id="S3.E2.m1.5.5.5.3.2.cmml" xref="S3.E2.m1.5.5.5.3.2"></times><ci id="S3.E2.m1.5.5.5.3.3.cmml" xref="S3.E2.m1.5.5.5.3.3">ğ‘’</ci><ci id="S3.E2.m1.5.5.5.3.4.cmml" xref="S3.E2.m1.5.5.5.3.4">ğ‘¥</ci><ci id="S3.E2.m1.5.5.5.3.5.cmml" xref="S3.E2.m1.5.5.5.3.5">ğ‘</ci><apply id="S3.E2.m1.5.5.5.3.1.1.1.cmml" xref="S3.E2.m1.5.5.5.3.1.1"><divide id="S3.E2.m1.5.5.5.3.1.1.1.2.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.2"></divide><apply id="S3.E2.m1.5.5.5.3.1.1.1.1.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1"><times id="S3.E2.m1.5.5.5.3.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.2"></times><ci id="S3.E2.m1.5.5.5.3.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.3">ğ‘ </ci><ci id="S3.E2.m1.5.5.5.3.1.1.1.1.4.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.4">ğ‘–</ci><ci id="S3.E2.m1.5.5.5.3.1.1.1.1.5.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.5">ğ‘š</ci><interval closure="open" id="S3.E2.m1.5.5.5.3.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1"><ci id="S3.E2.m1.3.3.3.1.cmml" xref="S3.E2.m1.3.3.3.1">ğ‘§</ci><apply id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.2">ğ‘§</ci><apply id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3"><times id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.2">ğ‘”</ci><ci id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.3">ğ‘™</ci><ci id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.4">ğ‘œ</ci><ci id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.5.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.5">ğ‘</ci></apply></apply></interval></apply><ci id="S3.E2.m1.5.5.5.3.1.1.1.3.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.3">ğœ</ci></apply></apply><apply id="S3.E2.m1.6.6.6.4.cmml" xref="S3.E2.m1.6.6.6.4"><times id="S3.E2.m1.6.6.6.4.2.cmml" xref="S3.E2.m1.6.6.6.4.2"></times><ci id="S3.E2.m1.6.6.6.4.3.cmml" xref="S3.E2.m1.6.6.6.4.3">ğ‘’</ci><ci id="S3.E2.m1.6.6.6.4.4.cmml" xref="S3.E2.m1.6.6.6.4.4">ğ‘¥</ci><ci id="S3.E2.m1.6.6.6.4.5.cmml" xref="S3.E2.m1.6.6.6.4.5">ğ‘</ci><apply id="S3.E2.m1.6.6.6.4.1.1.1.cmml" xref="S3.E2.m1.6.6.6.4.1.1"><divide id="S3.E2.m1.6.6.6.4.1.1.1.2.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.2"></divide><apply id="S3.E2.m1.6.6.6.4.1.1.1.1.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1"><times id="S3.E2.m1.6.6.6.4.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.2"></times><ci id="S3.E2.m1.6.6.6.4.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.3">ğ‘ </ci><ci id="S3.E2.m1.6.6.6.4.1.1.1.1.4.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.4">ğ‘–</ci><ci id="S3.E2.m1.6.6.6.4.1.1.1.1.5.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.5">ğ‘š</ci><interval closure="open" id="S3.E2.m1.6.6.6.4.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1"><ci id="S3.E2.m1.4.4.4.2.cmml" xref="S3.E2.m1.4.4.4.2">ğ‘§</ci><apply id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.2">ğ‘§</ci><apply id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3"><times id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.2">ğ‘</ci><ci id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.3">ğ‘Ÿ</ci><ci id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.4">ğ‘’</ci><ci id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.5.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.5">ğ‘£</ci></apply></apply></interval></apply><ci id="S3.E2.m1.6.6.6.4.1.1.1.3.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.3">ğœ</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.6c">l_{moon}=-log\frac{exp(sim(z,z_{glob})/\tau)}{exp(sim(z,z_{glob})/\tau)+exp(sim(z,z_{prev})/\tau)}\\
</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.6" class="ltx_p">Similarly <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="l_{glob}" display="inline"><semantics id="S3.p2.1.m1.1a"><msub id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">l</mi><mrow id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml"><mi id="S3.p2.1.m1.1.1.3.2" xref="S3.p2.1.m1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.1.1.3.1" xref="S3.p2.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.p2.1.m1.1.1.3.3" xref="S3.p2.1.m1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.1.1.3.1a" xref="S3.p2.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.p2.1.m1.1.1.3.4" xref="S3.p2.1.m1.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.1.1.3.1b" xref="S3.p2.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.p2.1.m1.1.1.3.5" xref="S3.p2.1.m1.1.1.3.5.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.cmml" xref="S3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2">ğ‘™</ci><apply id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3"><times id="S3.p2.1.m1.1.1.3.1.cmml" xref="S3.p2.1.m1.1.1.3.1"></times><ci id="S3.p2.1.m1.1.1.3.2.cmml" xref="S3.p2.1.m1.1.1.3.2">ğ‘”</ci><ci id="S3.p2.1.m1.1.1.3.3.cmml" xref="S3.p2.1.m1.1.1.3.3">ğ‘™</ci><ci id="S3.p2.1.m1.1.1.3.4.cmml" xref="S3.p2.1.m1.1.1.3.4">ğ‘œ</ci><ci id="S3.p2.1.m1.1.1.3.5.cmml" xref="S3.p2.1.m1.1.1.3.5">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">l_{glob}</annotation></semantics></math> takes the temperature <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.p2.2.m2.1a"><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">Ï„</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">ğœ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">\tau</annotation></semantics></math>, the current projected feature representations <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="z^{i}" display="inline"><semantics id="S3.p2.3.m3.1a"><msup id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mi id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">z</mi><mi id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1">superscript</csymbol><ci id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2">ğ‘§</ci><ci id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">z^{i}</annotation></semantics></math> in class <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p2.4.m4.1a"><mi id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><ci id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">i</annotation></semantics></math> and the shared global class-wise projected feature representations <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="zs_{glob}" display="inline"><semantics id="S3.p2.5.m5.1a"><mrow id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml"><mi id="S3.p2.5.m5.1.1.2" xref="S3.p2.5.m5.1.1.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="S3.p2.5.m5.1.1.1" xref="S3.p2.5.m5.1.1.1.cmml">â€‹</mo><msub id="S3.p2.5.m5.1.1.3" xref="S3.p2.5.m5.1.1.3.cmml"><mi id="S3.p2.5.m5.1.1.3.2" xref="S3.p2.5.m5.1.1.3.2.cmml">s</mi><mrow id="S3.p2.5.m5.1.1.3.3" xref="S3.p2.5.m5.1.1.3.3.cmml"><mi id="S3.p2.5.m5.1.1.3.3.2" xref="S3.p2.5.m5.1.1.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.p2.5.m5.1.1.3.3.1" xref="S3.p2.5.m5.1.1.3.3.1.cmml">â€‹</mo><mi id="S3.p2.5.m5.1.1.3.3.3" xref="S3.p2.5.m5.1.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.p2.5.m5.1.1.3.3.1a" xref="S3.p2.5.m5.1.1.3.3.1.cmml">â€‹</mo><mi id="S3.p2.5.m5.1.1.3.3.4" xref="S3.p2.5.m5.1.1.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p2.5.m5.1.1.3.3.1b" xref="S3.p2.5.m5.1.1.3.3.1.cmml">â€‹</mo><mi id="S3.p2.5.m5.1.1.3.3.5" xref="S3.p2.5.m5.1.1.3.3.5.cmml">b</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><apply id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1"><times id="S3.p2.5.m5.1.1.1.cmml" xref="S3.p2.5.m5.1.1.1"></times><ci id="S3.p2.5.m5.1.1.2.cmml" xref="S3.p2.5.m5.1.1.2">ğ‘§</ci><apply id="S3.p2.5.m5.1.1.3.cmml" xref="S3.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.3.1.cmml" xref="S3.p2.5.m5.1.1.3">subscript</csymbol><ci id="S3.p2.5.m5.1.1.3.2.cmml" xref="S3.p2.5.m5.1.1.3.2">ğ‘ </ci><apply id="S3.p2.5.m5.1.1.3.3.cmml" xref="S3.p2.5.m5.1.1.3.3"><times id="S3.p2.5.m5.1.1.3.3.1.cmml" xref="S3.p2.5.m5.1.1.3.3.1"></times><ci id="S3.p2.5.m5.1.1.3.3.2.cmml" xref="S3.p2.5.m5.1.1.3.3.2">ğ‘”</ci><ci id="S3.p2.5.m5.1.1.3.3.3.cmml" xref="S3.p2.5.m5.1.1.3.3.3">ğ‘™</ci><ci id="S3.p2.5.m5.1.1.3.3.4.cmml" xref="S3.p2.5.m5.1.1.3.3.4">ğ‘œ</ci><ci id="S3.p2.5.m5.1.1.3.3.5.cmml" xref="S3.p2.5.m5.1.1.3.3.5">ğ‘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">zs_{glob}</annotation></semantics></math> with a total of <math id="S3.p2.6.m6.1" class="ltx_Math" alttext="|K|" display="inline"><semantics id="S3.p2.6.m6.1a"><mrow id="S3.p2.6.m6.1.2.2" xref="S3.p2.6.m6.1.2.1.cmml"><mo stretchy="false" id="S3.p2.6.m6.1.2.2.1" xref="S3.p2.6.m6.1.2.1.1.cmml">|</mo><mi id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml">K</mi><mo stretchy="false" id="S3.p2.6.m6.1.2.2.2" xref="S3.p2.6.m6.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><apply id="S3.p2.6.m6.1.2.1.cmml" xref="S3.p2.6.m6.1.2.2"><abs id="S3.p2.6.m6.1.2.1.1.cmml" xref="S3.p2.6.m6.1.2.2.1"></abs><ci id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1">ğ¾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">|K|</annotation></semantics></math> classes. For the shared global representation in the same class as the image, we treat them as a positive pair, whereas any other shared global representations in a different class as negative pairs.</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.2" class="ltx_Math" alttext="l_{glob}=-log\frac{exp(sim(z^{i},zs^{i}_{glob})/\tau)}{\sum_{k\in K}exp(sim(z^{i},zs^{k}_{glob})/\tau)}\\
" display="block"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.3" xref="S3.E3.m1.2.3.cmml"><msub id="S3.E3.m1.2.3.2" xref="S3.E3.m1.2.3.2.cmml"><mi id="S3.E3.m1.2.3.2.2" xref="S3.E3.m1.2.3.2.2.cmml">l</mi><mrow id="S3.E3.m1.2.3.2.3" xref="S3.E3.m1.2.3.2.3.cmml"><mi id="S3.E3.m1.2.3.2.3.2" xref="S3.E3.m1.2.3.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.3.2.3.1" xref="S3.E3.m1.2.3.2.3.1.cmml">â€‹</mo><mi id="S3.E3.m1.2.3.2.3.3" xref="S3.E3.m1.2.3.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.3.2.3.1a" xref="S3.E3.m1.2.3.2.3.1.cmml">â€‹</mo><mi id="S3.E3.m1.2.3.2.3.4" xref="S3.E3.m1.2.3.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.3.2.3.1b" xref="S3.E3.m1.2.3.2.3.1.cmml">â€‹</mo><mi id="S3.E3.m1.2.3.2.3.5" xref="S3.E3.m1.2.3.2.3.5.cmml">b</mi></mrow></msub><mo id="S3.E3.m1.2.3.1" xref="S3.E3.m1.2.3.1.cmml">=</mo><mrow id="S3.E3.m1.2.3.3" xref="S3.E3.m1.2.3.3.cmml"><mo id="S3.E3.m1.2.3.3a" xref="S3.E3.m1.2.3.3.cmml">âˆ’</mo><mrow id="S3.E3.m1.2.3.3.2" xref="S3.E3.m1.2.3.3.2.cmml"><mi id="S3.E3.m1.2.3.3.2.2" xref="S3.E3.m1.2.3.3.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.3.3.2.1" xref="S3.E3.m1.2.3.3.2.1.cmml">â€‹</mo><mi id="S3.E3.m1.2.3.3.2.3" xref="S3.E3.m1.2.3.3.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.3.3.2.1a" xref="S3.E3.m1.2.3.3.2.1.cmml">â€‹</mo><mi id="S3.E3.m1.2.3.3.2.4" xref="S3.E3.m1.2.3.3.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.3.3.2.1b" xref="S3.E3.m1.2.3.3.2.1.cmml">â€‹</mo><mfrac id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml"><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.1.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.2.cmml">â€‹</mo><mi id="S3.E3.m1.1.1.1.4" xref="S3.E3.m1.1.1.1.4.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.2a" xref="S3.E3.m1.1.1.1.2.cmml">â€‹</mo><mi id="S3.E3.m1.1.1.1.5" xref="S3.E3.m1.1.1.1.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.2b" xref="S3.E3.m1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2.4" xref="S3.E3.m1.1.1.1.1.1.1.2.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.2.3.cmml">â€‹</mo><mi id="S3.E3.m1.1.1.1.1.1.1.2.5" xref="S3.E3.m1.1.1.1.1.1.1.2.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.2.3a" xref="S3.E3.m1.1.1.1.1.1.1.2.3.cmml">â€‹</mo><mi id="S3.E3.m1.1.1.1.1.1.1.2.6" xref="S3.E3.m1.1.1.1.1.1.1.2.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.2.3b" xref="S3.E3.m1.1.1.1.1.1.1.2.3.cmml">â€‹</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.1.2.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msup id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="S3.E3.m1.1.1.1.1.1.1.2.2.2.4" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.cmml">,</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.1" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.1.cmml">â€‹</mo><msubsup id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.2.2" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.2.2.cmml">s</mi><mrow id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.2" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.1" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.1.cmml">â€‹</mo><mi id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.3" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.1a" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.1.cmml">â€‹</mo><mi id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.4" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.1b" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.1.cmml">â€‹</mo><mi id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.5" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.5.cmml">b</mi></mrow><mi id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.2.3" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.2.3.cmml">i</mi></msubsup></mrow><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.1.2.2.2.5" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.cmml">/</mo><mi id="S3.E3.m1.1.1.1.1.1.1.4" xref="S3.E3.m1.1.1.1.1.1.1.4.cmml">Ï„</mi></mrow><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.2.2.cmml"><msub id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml"><mo id="S3.E3.m1.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.cmml">âˆ‘</mo><mrow id="S3.E3.m1.2.2.2.2.3" xref="S3.E3.m1.2.2.2.2.3.cmml"><mi id="S3.E3.m1.2.2.2.2.3.2" xref="S3.E3.m1.2.2.2.2.3.2.cmml">k</mi><mo id="S3.E3.m1.2.2.2.2.3.1" xref="S3.E3.m1.2.2.2.2.3.1.cmml">âˆˆ</mo><mi id="S3.E3.m1.2.2.2.2.3.3" xref="S3.E3.m1.2.2.2.2.3.3.cmml">K</mi></mrow></msub><mrow id="S3.E3.m1.2.2.2.1" xref="S3.E3.m1.2.2.2.1.cmml"><mi id="S3.E3.m1.2.2.2.1.3" xref="S3.E3.m1.2.2.2.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.1.2" xref="S3.E3.m1.2.2.2.1.2.cmml">â€‹</mo><mi id="S3.E3.m1.2.2.2.1.4" xref="S3.E3.m1.2.2.2.1.4.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.1.2a" xref="S3.E3.m1.2.2.2.1.2.cmml">â€‹</mo><mi id="S3.E3.m1.2.2.2.1.5" xref="S3.E3.m1.2.2.2.1.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.1.2b" xref="S3.E3.m1.2.2.2.1.2.cmml">â€‹</mo><mrow id="S3.E3.m1.2.2.2.1.1.1" xref="S3.E3.m1.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.2.1.1.1.2" xref="S3.E3.m1.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.2.2.2.1.1.1.1" xref="S3.E3.m1.2.2.2.1.1.1.1.cmml"><mrow id="S3.E3.m1.2.2.2.1.1.1.1.2" xref="S3.E3.m1.2.2.2.1.1.1.1.2.cmml"><mi id="S3.E3.m1.2.2.2.1.1.1.1.2.4" xref="S3.E3.m1.2.2.2.1.1.1.1.2.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.1.1.1.1.2.3" xref="S3.E3.m1.2.2.2.1.1.1.1.2.3.cmml">â€‹</mo><mi id="S3.E3.m1.2.2.2.1.1.1.1.2.5" xref="S3.E3.m1.2.2.2.1.1.1.1.2.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.1.1.1.1.2.3a" xref="S3.E3.m1.2.2.2.1.1.1.1.2.3.cmml">â€‹</mo><mi id="S3.E3.m1.2.2.2.1.1.1.1.2.6" xref="S3.E3.m1.2.2.2.1.1.1.1.2.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.1.1.1.1.2.3b" xref="S3.E3.m1.2.2.2.1.1.1.1.2.3.cmml">â€‹</mo><mrow id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.3" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.3.cmml">(</mo><msup id="S3.E3.m1.2.2.2.1.1.1.1.1.1.1.1" xref="S3.E3.m1.2.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.2.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.2.2.2.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E3.m1.2.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.4" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.3.cmml">,</mo><mrow id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.2" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.1" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.1.cmml">â€‹</mo><msubsup id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.2.2" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.2.2.cmml">s</mi><mrow id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.cmml"><mi id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.2" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.1" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.1.cmml">â€‹</mo><mi id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.3" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.1a" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.1.cmml">â€‹</mo><mi id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.4" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.1b" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.1.cmml">â€‹</mo><mi id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.5" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.5.cmml">b</mi></mrow><mi id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.2.3" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.2.3.cmml">k</mi></msubsup></mrow><mo stretchy="false" id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.5" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.2.2.2.1.1.1.1.3" xref="S3.E3.m1.2.2.2.1.1.1.1.3.cmml">/</mo><mi id="S3.E3.m1.2.2.2.1.1.1.1.4" xref="S3.E3.m1.2.2.2.1.1.1.1.4.cmml">Ï„</mi></mrow><mo stretchy="false" id="S3.E3.m1.2.2.2.1.1.1.3" xref="S3.E3.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.3.cmml" xref="S3.E3.m1.2.3"><eq id="S3.E3.m1.2.3.1.cmml" xref="S3.E3.m1.2.3.1"></eq><apply id="S3.E3.m1.2.3.2.cmml" xref="S3.E3.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.2.1.cmml" xref="S3.E3.m1.2.3.2">subscript</csymbol><ci id="S3.E3.m1.2.3.2.2.cmml" xref="S3.E3.m1.2.3.2.2">ğ‘™</ci><apply id="S3.E3.m1.2.3.2.3.cmml" xref="S3.E3.m1.2.3.2.3"><times id="S3.E3.m1.2.3.2.3.1.cmml" xref="S3.E3.m1.2.3.2.3.1"></times><ci id="S3.E3.m1.2.3.2.3.2.cmml" xref="S3.E3.m1.2.3.2.3.2">ğ‘”</ci><ci id="S3.E3.m1.2.3.2.3.3.cmml" xref="S3.E3.m1.2.3.2.3.3">ğ‘™</ci><ci id="S3.E3.m1.2.3.2.3.4.cmml" xref="S3.E3.m1.2.3.2.3.4">ğ‘œ</ci><ci id="S3.E3.m1.2.3.2.3.5.cmml" xref="S3.E3.m1.2.3.2.3.5">ğ‘</ci></apply></apply><apply id="S3.E3.m1.2.3.3.cmml" xref="S3.E3.m1.2.3.3"><minus id="S3.E3.m1.2.3.3.1.cmml" xref="S3.E3.m1.2.3.3"></minus><apply id="S3.E3.m1.2.3.3.2.cmml" xref="S3.E3.m1.2.3.3.2"><times id="S3.E3.m1.2.3.3.2.1.cmml" xref="S3.E3.m1.2.3.3.2.1"></times><ci id="S3.E3.m1.2.3.3.2.2.cmml" xref="S3.E3.m1.2.3.3.2.2">ğ‘™</ci><ci id="S3.E3.m1.2.3.3.2.3.cmml" xref="S3.E3.m1.2.3.3.2.3">ğ‘œ</ci><ci id="S3.E3.m1.2.3.3.2.4.cmml" xref="S3.E3.m1.2.3.3.2.4">ğ‘”</ci><apply id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"><divide id="S3.E3.m1.2.2.3.cmml" xref="S3.E3.m1.2.2"></divide><apply id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><times id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.2"></times><ci id="S3.E3.m1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.3">ğ‘’</ci><ci id="S3.E3.m1.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.4">ğ‘¥</ci><ci id="S3.E3.m1.1.1.1.5.cmml" xref="S3.E3.m1.1.1.1.5">ğ‘</ci><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><divide id="S3.E3.m1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3"></divide><apply id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2"><times id="S3.E3.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3"></times><ci id="S3.E3.m1.1.1.1.1.1.1.2.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.4">ğ‘ </ci><ci id="S3.E3.m1.1.1.1.1.1.1.2.5.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.5">ğ‘–</ci><ci id="S3.E3.m1.1.1.1.1.1.1.2.6.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.6">ğ‘š</ci><interval closure="open" id="S3.E3.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2"><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.2">ğ‘§</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2"><times id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.1"></times><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.2">ğ‘§</ci><apply id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3">subscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.2.2">ğ‘ </ci><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.2.3">ğ‘–</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3"><times id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.1"></times><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.2">ğ‘”</ci><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.3">ğ‘™</ci><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.4">ğ‘œ</ci><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.5.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.3.3.5">ğ‘</ci></apply></apply></apply></interval></apply><ci id="S3.E3.m1.1.1.1.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4">ğœ</ci></apply></apply><apply id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2.2"><apply id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2">subscript</csymbol><sum id="S3.E3.m1.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2"></sum><apply id="S3.E3.m1.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.3"><in id="S3.E3.m1.2.2.2.2.3.1.cmml" xref="S3.E3.m1.2.2.2.2.3.1"></in><ci id="S3.E3.m1.2.2.2.2.3.2.cmml" xref="S3.E3.m1.2.2.2.2.3.2">ğ‘˜</ci><ci id="S3.E3.m1.2.2.2.2.3.3.cmml" xref="S3.E3.m1.2.2.2.2.3.3">ğ¾</ci></apply></apply><apply id="S3.E3.m1.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.1"><times id="S3.E3.m1.2.2.2.1.2.cmml" xref="S3.E3.m1.2.2.2.1.2"></times><ci id="S3.E3.m1.2.2.2.1.3.cmml" xref="S3.E3.m1.2.2.2.1.3">ğ‘’</ci><ci id="S3.E3.m1.2.2.2.1.4.cmml" xref="S3.E3.m1.2.2.2.1.4">ğ‘¥</ci><ci id="S3.E3.m1.2.2.2.1.5.cmml" xref="S3.E3.m1.2.2.2.1.5">ğ‘</ci><apply id="S3.E3.m1.2.2.2.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.1.1.1"><divide id="S3.E3.m1.2.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.3"></divide><apply id="S3.E3.m1.2.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2"><times id="S3.E3.m1.2.2.2.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2.3"></times><ci id="S3.E3.m1.2.2.2.1.1.1.1.2.4.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2.4">ğ‘ </ci><ci id="S3.E3.m1.2.2.2.1.1.1.1.2.5.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2.5">ğ‘–</ci><ci id="S3.E3.m1.2.2.2.1.1.1.1.2.6.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2.6">ğ‘š</ci><interval closure="open" id="S3.E3.m1.2.2.2.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2"><apply id="S3.E3.m1.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.1.1.1.1.2">ğ‘§</ci><ci id="S3.E3.m1.2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2"><times id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.1"></times><ci id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.2">ğ‘§</ci><apply id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3">subscript</csymbol><apply id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.2.1.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3">superscript</csymbol><ci id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.2.2.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.2.2">ğ‘ </ci><ci id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.2.3.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.2.3">ğ‘˜</ci></apply><apply id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3"><times id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.1.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.1"></times><ci id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.2.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.2">ğ‘”</ci><ci id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.3.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.3">ğ‘™</ci><ci id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.4.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.4">ğ‘œ</ci><ci id="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.5.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.2.2.2.2.3.3.5">ğ‘</ci></apply></apply></apply></interval></apply><ci id="S3.E3.m1.2.2.2.1.1.1.1.4.cmml" xref="S3.E3.m1.2.2.2.1.1.1.1.4">ğœ</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">l_{glob}=-log\frac{exp(sim(z^{i},zs^{i}_{glob})/\tau)}{\sum_{k\in K}exp(sim(z^{i},zs^{k}_{glob})/\tau)}\\
</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.4" class="ltx_p">To construct the <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="zs_{glob}" display="inline"><semantics id="S3.p3.1.m1.1a"><mrow id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="S3.p3.1.m1.1.1.1" xref="S3.p3.1.m1.1.1.1.cmml">â€‹</mo><msub id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml"><mi id="S3.p3.1.m1.1.1.3.2" xref="S3.p3.1.m1.1.1.3.2.cmml">s</mi><mrow id="S3.p3.1.m1.1.1.3.3" xref="S3.p3.1.m1.1.1.3.3.cmml"><mi id="S3.p3.1.m1.1.1.3.3.2" xref="S3.p3.1.m1.1.1.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.p3.1.m1.1.1.3.3.1" xref="S3.p3.1.m1.1.1.3.3.1.cmml">â€‹</mo><mi id="S3.p3.1.m1.1.1.3.3.3" xref="S3.p3.1.m1.1.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.p3.1.m1.1.1.3.3.1a" xref="S3.p3.1.m1.1.1.3.3.1.cmml">â€‹</mo><mi id="S3.p3.1.m1.1.1.3.3.4" xref="S3.p3.1.m1.1.1.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p3.1.m1.1.1.3.3.1b" xref="S3.p3.1.m1.1.1.3.3.1.cmml">â€‹</mo><mi id="S3.p3.1.m1.1.1.3.3.5" xref="S3.p3.1.m1.1.1.3.3.5.cmml">b</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><times id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1.1"></times><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">ğ‘§</ci><apply id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.3.1.cmml" xref="S3.p3.1.m1.1.1.3">subscript</csymbol><ci id="S3.p3.1.m1.1.1.3.2.cmml" xref="S3.p3.1.m1.1.1.3.2">ğ‘ </ci><apply id="S3.p3.1.m1.1.1.3.3.cmml" xref="S3.p3.1.m1.1.1.3.3"><times id="S3.p3.1.m1.1.1.3.3.1.cmml" xref="S3.p3.1.m1.1.1.3.3.1"></times><ci id="S3.p3.1.m1.1.1.3.3.2.cmml" xref="S3.p3.1.m1.1.1.3.3.2">ğ‘”</ci><ci id="S3.p3.1.m1.1.1.3.3.3.cmml" xref="S3.p3.1.m1.1.1.3.3.3">ğ‘™</ci><ci id="S3.p3.1.m1.1.1.3.3.4.cmml" xref="S3.p3.1.m1.1.1.3.3.4">ğ‘œ</ci><ci id="S3.p3.1.m1.1.1.3.3.5.cmml" xref="S3.p3.1.m1.1.1.3.3.5">ğ‘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">zs_{glob}</annotation></semantics></math>, we first have each local device report to global server the class-wise projected feature representations at the last round of epoch using Equation <a href="#S3.E4" title="In III Approach â€£ FedSSC: Shared Supervised-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> assuming that each device has <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.p3.2.m2.1a"><mi id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><ci id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">N</annotation></semantics></math> training data with <math id="S3.p3.3.m3.1" class="ltx_Math" alttext="N^{k}" display="inline"><semantics id="S3.p3.3.m3.1a"><msup id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><mi id="S3.p3.3.m3.1.1.2" xref="S3.p3.3.m3.1.1.2.cmml">N</mi><mi id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.cmml" xref="S3.p3.3.m3.1.1">superscript</csymbol><ci id="S3.p3.3.m3.1.1.2.cmml" xref="S3.p3.3.m3.1.1.2">ğ‘</ci><ci id="S3.p3.3.m3.1.1.3.cmml" xref="S3.p3.3.m3.1.1.3">ğ‘˜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">N^{k}</annotation></semantics></math> of them in class <math id="S3.p3.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.p3.4.m4.1a"><mi id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><ci id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">k</annotation></semantics></math>. In each communication round, for each class the global server randomly selects a device who has at least 10 images of that class locally as a source of that classâ€™s class-wise feature representation.</p>
</div>
<div id="S3.p4" class="ltx_para">
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.1" class="ltx_Math" alttext="zs^{k}_{glob}=\frac{\sum_{j}^{N}z^{i}_{j}*1_{i=k}}{N^{k}}" display="block"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><mrow id="S3.E4.m1.1.1.2" xref="S3.E4.m1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.2.2" xref="S3.E4.m1.1.1.2.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.2.1" xref="S3.E4.m1.1.1.2.1.cmml">â€‹</mo><msubsup id="S3.E4.m1.1.1.2.3" xref="S3.E4.m1.1.1.2.3.cmml"><mi id="S3.E4.m1.1.1.2.3.2.2" xref="S3.E4.m1.1.1.2.3.2.2.cmml">s</mi><mrow id="S3.E4.m1.1.1.2.3.3" xref="S3.E4.m1.1.1.2.3.3.cmml"><mi id="S3.E4.m1.1.1.2.3.3.2" xref="S3.E4.m1.1.1.2.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.2.3.3.1" xref="S3.E4.m1.1.1.2.3.3.1.cmml">â€‹</mo><mi id="S3.E4.m1.1.1.2.3.3.3" xref="S3.E4.m1.1.1.2.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.2.3.3.1a" xref="S3.E4.m1.1.1.2.3.3.1.cmml">â€‹</mo><mi id="S3.E4.m1.1.1.2.3.3.4" xref="S3.E4.m1.1.1.2.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.2.3.3.1b" xref="S3.E4.m1.1.1.2.3.3.1.cmml">â€‹</mo><mi id="S3.E4.m1.1.1.2.3.3.5" xref="S3.E4.m1.1.1.2.3.3.5.cmml">b</mi></mrow><mi id="S3.E4.m1.1.1.2.3.2.3" xref="S3.E4.m1.1.1.2.3.2.3.cmml">k</mi></msubsup></mrow><mo id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml">=</mo><mfrac id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml"><mrow id="S3.E4.m1.1.1.3.2" xref="S3.E4.m1.1.1.3.2.cmml"><msubsup id="S3.E4.m1.1.1.3.2.1" xref="S3.E4.m1.1.1.3.2.1.cmml"><mo id="S3.E4.m1.1.1.3.2.1.2.2" xref="S3.E4.m1.1.1.3.2.1.2.2.cmml">âˆ‘</mo><mi id="S3.E4.m1.1.1.3.2.1.2.3" xref="S3.E4.m1.1.1.3.2.1.2.3.cmml">j</mi><mi id="S3.E4.m1.1.1.3.2.1.3" xref="S3.E4.m1.1.1.3.2.1.3.cmml">N</mi></msubsup><mrow id="S3.E4.m1.1.1.3.2.2" xref="S3.E4.m1.1.1.3.2.2.cmml"><msubsup id="S3.E4.m1.1.1.3.2.2.2" xref="S3.E4.m1.1.1.3.2.2.2.cmml"><mi id="S3.E4.m1.1.1.3.2.2.2.2.2" xref="S3.E4.m1.1.1.3.2.2.2.2.2.cmml">z</mi><mi id="S3.E4.m1.1.1.3.2.2.2.3" xref="S3.E4.m1.1.1.3.2.2.2.3.cmml">j</mi><mi id="S3.E4.m1.1.1.3.2.2.2.2.3" xref="S3.E4.m1.1.1.3.2.2.2.2.3.cmml">i</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.1.1.3.2.2.1" xref="S3.E4.m1.1.1.3.2.2.1.cmml">âˆ—</mo><msub id="S3.E4.m1.1.1.3.2.2.3" xref="S3.E4.m1.1.1.3.2.2.3.cmml"><mn id="S3.E4.m1.1.1.3.2.2.3.2" xref="S3.E4.m1.1.1.3.2.2.3.2.cmml">1</mn><mrow id="S3.E4.m1.1.1.3.2.2.3.3" xref="S3.E4.m1.1.1.3.2.2.3.3.cmml"><mi id="S3.E4.m1.1.1.3.2.2.3.3.2" xref="S3.E4.m1.1.1.3.2.2.3.3.2.cmml">i</mi><mo id="S3.E4.m1.1.1.3.2.2.3.3.1" xref="S3.E4.m1.1.1.3.2.2.3.3.1.cmml">=</mo><mi id="S3.E4.m1.1.1.3.2.2.3.3.3" xref="S3.E4.m1.1.1.3.2.2.3.3.3.cmml">k</mi></mrow></msub></mrow></mrow><msup id="S3.E4.m1.1.1.3.3" xref="S3.E4.m1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.3.3.2" xref="S3.E4.m1.1.1.3.3.2.cmml">N</mi><mi id="S3.E4.m1.1.1.3.3.3" xref="S3.E4.m1.1.1.3.3.3.cmml">k</mi></msup></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><eq id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"></eq><apply id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1.2"><times id="S3.E4.m1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.2.1"></times><ci id="S3.E4.m1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.2.2">ğ‘§</ci><apply id="S3.E4.m1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.2.3.1.cmml" xref="S3.E4.m1.1.1.2.3">subscript</csymbol><apply id="S3.E4.m1.1.1.2.3.2.cmml" xref="S3.E4.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.2.3.2.1.cmml" xref="S3.E4.m1.1.1.2.3">superscript</csymbol><ci id="S3.E4.m1.1.1.2.3.2.2.cmml" xref="S3.E4.m1.1.1.2.3.2.2">ğ‘ </ci><ci id="S3.E4.m1.1.1.2.3.2.3.cmml" xref="S3.E4.m1.1.1.2.3.2.3">ğ‘˜</ci></apply><apply id="S3.E4.m1.1.1.2.3.3.cmml" xref="S3.E4.m1.1.1.2.3.3"><times id="S3.E4.m1.1.1.2.3.3.1.cmml" xref="S3.E4.m1.1.1.2.3.3.1"></times><ci id="S3.E4.m1.1.1.2.3.3.2.cmml" xref="S3.E4.m1.1.1.2.3.3.2">ğ‘”</ci><ci id="S3.E4.m1.1.1.2.3.3.3.cmml" xref="S3.E4.m1.1.1.2.3.3.3">ğ‘™</ci><ci id="S3.E4.m1.1.1.2.3.3.4.cmml" xref="S3.E4.m1.1.1.2.3.3.4">ğ‘œ</ci><ci id="S3.E4.m1.1.1.2.3.3.5.cmml" xref="S3.E4.m1.1.1.2.3.3.5">ğ‘</ci></apply></apply></apply><apply id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3"><divide id="S3.E4.m1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.3"></divide><apply id="S3.E4.m1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.3.2"><apply id="S3.E4.m1.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.2.1.1.cmml" xref="S3.E4.m1.1.1.3.2.1">superscript</csymbol><apply id="S3.E4.m1.1.1.3.2.1.2.cmml" xref="S3.E4.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.2.1.2.1.cmml" xref="S3.E4.m1.1.1.3.2.1">subscript</csymbol><sum id="S3.E4.m1.1.1.3.2.1.2.2.cmml" xref="S3.E4.m1.1.1.3.2.1.2.2"></sum><ci id="S3.E4.m1.1.1.3.2.1.2.3.cmml" xref="S3.E4.m1.1.1.3.2.1.2.3">ğ‘—</ci></apply><ci id="S3.E4.m1.1.1.3.2.1.3.cmml" xref="S3.E4.m1.1.1.3.2.1.3">ğ‘</ci></apply><apply id="S3.E4.m1.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.3.2.2"><times id="S3.E4.m1.1.1.3.2.2.1.cmml" xref="S3.E4.m1.1.1.3.2.2.1"></times><apply id="S3.E4.m1.1.1.3.2.2.2.cmml" xref="S3.E4.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.2.2.2.1.cmml" xref="S3.E4.m1.1.1.3.2.2.2">subscript</csymbol><apply id="S3.E4.m1.1.1.3.2.2.2.2.cmml" xref="S3.E4.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.2.2.2.2.1.cmml" xref="S3.E4.m1.1.1.3.2.2.2">superscript</csymbol><ci id="S3.E4.m1.1.1.3.2.2.2.2.2.cmml" xref="S3.E4.m1.1.1.3.2.2.2.2.2">ğ‘§</ci><ci id="S3.E4.m1.1.1.3.2.2.2.2.3.cmml" xref="S3.E4.m1.1.1.3.2.2.2.2.3">ğ‘–</ci></apply><ci id="S3.E4.m1.1.1.3.2.2.2.3.cmml" xref="S3.E4.m1.1.1.3.2.2.2.3">ğ‘—</ci></apply><apply id="S3.E4.m1.1.1.3.2.2.3.cmml" xref="S3.E4.m1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.2.2.3.1.cmml" xref="S3.E4.m1.1.1.3.2.2.3">subscript</csymbol><cn type="integer" id="S3.E4.m1.1.1.3.2.2.3.2.cmml" xref="S3.E4.m1.1.1.3.2.2.3.2">1</cn><apply id="S3.E4.m1.1.1.3.2.2.3.3.cmml" xref="S3.E4.m1.1.1.3.2.2.3.3"><eq id="S3.E4.m1.1.1.3.2.2.3.3.1.cmml" xref="S3.E4.m1.1.1.3.2.2.3.3.1"></eq><ci id="S3.E4.m1.1.1.3.2.2.3.3.2.cmml" xref="S3.E4.m1.1.1.3.2.2.3.3.2">ğ‘–</ci><ci id="S3.E4.m1.1.1.3.2.2.3.3.3.cmml" xref="S3.E4.m1.1.1.3.2.2.3.3.3">ğ‘˜</ci></apply></apply></apply></apply><apply id="S3.E4.m1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.3.3">superscript</csymbol><ci id="S3.E4.m1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.3.3.2">ğ‘</ci><ci id="S3.E4.m1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.3.3.3">ğ‘˜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">zs^{k}_{glob}=\frac{\sum_{j}^{N}z^{i}_{j}*1_{i=k}}{N^{k}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.p5" class="ltx_para">
<p id="S3.p5.3" class="ltx_p">As shown in Equation <a href="#S3.E5" title="In III Approach â€£ FedSSC: Shared Supervised-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, we can tune the two parameters <math id="S3.p5.1.m1.1" class="ltx_Math" alttext="\mu_{moon}" display="inline"><semantics id="S3.p5.1.m1.1a"><msub id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml"><mi id="S3.p5.1.m1.1.1.2" xref="S3.p5.1.m1.1.1.2.cmml">Î¼</mi><mrow id="S3.p5.1.m1.1.1.3" xref="S3.p5.1.m1.1.1.3.cmml"><mi id="S3.p5.1.m1.1.1.3.2" xref="S3.p5.1.m1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.p5.1.m1.1.1.3.1" xref="S3.p5.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.p5.1.m1.1.1.3.3" xref="S3.p5.1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p5.1.m1.1.1.3.1a" xref="S3.p5.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.p5.1.m1.1.1.3.4" xref="S3.p5.1.m1.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p5.1.m1.1.1.3.1b" xref="S3.p5.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.p5.1.m1.1.1.3.5" xref="S3.p5.1.m1.1.1.3.5.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b"><apply id="S3.p5.1.m1.1.1.cmml" xref="S3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p5.1.m1.1.1.1.cmml" xref="S3.p5.1.m1.1.1">subscript</csymbol><ci id="S3.p5.1.m1.1.1.2.cmml" xref="S3.p5.1.m1.1.1.2">ğœ‡</ci><apply id="S3.p5.1.m1.1.1.3.cmml" xref="S3.p5.1.m1.1.1.3"><times id="S3.p5.1.m1.1.1.3.1.cmml" xref="S3.p5.1.m1.1.1.3.1"></times><ci id="S3.p5.1.m1.1.1.3.2.cmml" xref="S3.p5.1.m1.1.1.3.2">ğ‘š</ci><ci id="S3.p5.1.m1.1.1.3.3.cmml" xref="S3.p5.1.m1.1.1.3.3">ğ‘œ</ci><ci id="S3.p5.1.m1.1.1.3.4.cmml" xref="S3.p5.1.m1.1.1.3.4">ğ‘œ</ci><ci id="S3.p5.1.m1.1.1.3.5.cmml" xref="S3.p5.1.m1.1.1.3.5">ğ‘›</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.m1.1c">\mu_{moon}</annotation></semantics></math> and <math id="S3.p5.2.m2.1" class="ltx_Math" alttext="\mu_{glob}" display="inline"><semantics id="S3.p5.2.m2.1a"><msub id="S3.p5.2.m2.1.1" xref="S3.p5.2.m2.1.1.cmml"><mi id="S3.p5.2.m2.1.1.2" xref="S3.p5.2.m2.1.1.2.cmml">Î¼</mi><mrow id="S3.p5.2.m2.1.1.3" xref="S3.p5.2.m2.1.1.3.cmml"><mi id="S3.p5.2.m2.1.1.3.2" xref="S3.p5.2.m2.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.p5.2.m2.1.1.3.1" xref="S3.p5.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S3.p5.2.m2.1.1.3.3" xref="S3.p5.2.m2.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.p5.2.m2.1.1.3.1a" xref="S3.p5.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S3.p5.2.m2.1.1.3.4" xref="S3.p5.2.m2.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p5.2.m2.1.1.3.1b" xref="S3.p5.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S3.p5.2.m2.1.1.3.5" xref="S3.p5.2.m2.1.1.3.5.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p5.2.m2.1b"><apply id="S3.p5.2.m2.1.1.cmml" xref="S3.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p5.2.m2.1.1.1.cmml" xref="S3.p5.2.m2.1.1">subscript</csymbol><ci id="S3.p5.2.m2.1.1.2.cmml" xref="S3.p5.2.m2.1.1.2">ğœ‡</ci><apply id="S3.p5.2.m2.1.1.3.cmml" xref="S3.p5.2.m2.1.1.3"><times id="S3.p5.2.m2.1.1.3.1.cmml" xref="S3.p5.2.m2.1.1.3.1"></times><ci id="S3.p5.2.m2.1.1.3.2.cmml" xref="S3.p5.2.m2.1.1.3.2">ğ‘”</ci><ci id="S3.p5.2.m2.1.1.3.3.cmml" xref="S3.p5.2.m2.1.1.3.3">ğ‘™</ci><ci id="S3.p5.2.m2.1.1.3.4.cmml" xref="S3.p5.2.m2.1.1.3.4">ğ‘œ</ci><ci id="S3.p5.2.m2.1.1.3.5.cmml" xref="S3.p5.2.m2.1.1.3.5">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.2.m2.1c">\mu_{glob}</annotation></semantics></math> to weight the MOON loss and global class-wise contrastive loss differently. The local objective is to minimize the <math id="S3.p5.3.m3.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.p5.3.m3.1a"><mi id="S3.p5.3.m3.1.1" xref="S3.p5.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.p5.3.m3.1b"><ci id="S3.p5.3.m3.1.1.cmml" xref="S3.p5.3.m3.1.1">ğ‘™</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.3.m3.1c">l</annotation></semantics></math>.</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.1" class="ltx_Math" alttext="l=l_{class}+\mu_{moon}*l_{moon}+\mu_{glob}*l_{glob}\\
" display="block"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><mi id="S3.E5.m1.1.1.2" xref="S3.E5.m1.1.1.2.cmml">l</mi><mo id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml"><msub id="S3.E5.m1.1.1.3.2" xref="S3.E5.m1.1.1.3.2.cmml"><mi id="S3.E5.m1.1.1.3.2.2" xref="S3.E5.m1.1.1.3.2.2.cmml">l</mi><mrow id="S3.E5.m1.1.1.3.2.3" xref="S3.E5.m1.1.1.3.2.3.cmml"><mi id="S3.E5.m1.1.1.3.2.3.2" xref="S3.E5.m1.1.1.3.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.2.3.1" xref="S3.E5.m1.1.1.3.2.3.1.cmml">â€‹</mo><mi id="S3.E5.m1.1.1.3.2.3.3" xref="S3.E5.m1.1.1.3.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.2.3.1a" xref="S3.E5.m1.1.1.3.2.3.1.cmml">â€‹</mo><mi id="S3.E5.m1.1.1.3.2.3.4" xref="S3.E5.m1.1.1.3.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.2.3.1b" xref="S3.E5.m1.1.1.3.2.3.1.cmml">â€‹</mo><mi id="S3.E5.m1.1.1.3.2.3.5" xref="S3.E5.m1.1.1.3.2.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.2.3.1c" xref="S3.E5.m1.1.1.3.2.3.1.cmml">â€‹</mo><mi id="S3.E5.m1.1.1.3.2.3.6" xref="S3.E5.m1.1.1.3.2.3.6.cmml">s</mi></mrow></msub><mo id="S3.E5.m1.1.1.3.1" xref="S3.E5.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E5.m1.1.1.3.3" xref="S3.E5.m1.1.1.3.3.cmml"><msub id="S3.E5.m1.1.1.3.3.2" xref="S3.E5.m1.1.1.3.3.2.cmml"><mi id="S3.E5.m1.1.1.3.3.2.2" xref="S3.E5.m1.1.1.3.3.2.2.cmml">Î¼</mi><mrow id="S3.E5.m1.1.1.3.3.2.3" xref="S3.E5.m1.1.1.3.3.2.3.cmml"><mi id="S3.E5.m1.1.1.3.3.2.3.2" xref="S3.E5.m1.1.1.3.3.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.3.2.3.1" xref="S3.E5.m1.1.1.3.3.2.3.1.cmml">â€‹</mo><mi id="S3.E5.m1.1.1.3.3.2.3.3" xref="S3.E5.m1.1.1.3.3.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.3.2.3.1a" xref="S3.E5.m1.1.1.3.3.2.3.1.cmml">â€‹</mo><mi id="S3.E5.m1.1.1.3.3.2.3.4" xref="S3.E5.m1.1.1.3.3.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.3.2.3.1b" xref="S3.E5.m1.1.1.3.3.2.3.1.cmml">â€‹</mo><mi id="S3.E5.m1.1.1.3.3.2.3.5" xref="S3.E5.m1.1.1.3.3.2.3.5.cmml">n</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E5.m1.1.1.3.3.1" xref="S3.E5.m1.1.1.3.3.1.cmml">âˆ—</mo><msub id="S3.E5.m1.1.1.3.3.3" xref="S3.E5.m1.1.1.3.3.3.cmml"><mi id="S3.E5.m1.1.1.3.3.3.2" xref="S3.E5.m1.1.1.3.3.3.2.cmml">l</mi><mrow id="S3.E5.m1.1.1.3.3.3.3" xref="S3.E5.m1.1.1.3.3.3.3.cmml"><mi id="S3.E5.m1.1.1.3.3.3.3.2" xref="S3.E5.m1.1.1.3.3.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.3.3.3.1" xref="S3.E5.m1.1.1.3.3.3.3.1.cmml">â€‹</mo><mi id="S3.E5.m1.1.1.3.3.3.3.3" xref="S3.E5.m1.1.1.3.3.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.3.3.3.1a" xref="S3.E5.m1.1.1.3.3.3.3.1.cmml">â€‹</mo><mi id="S3.E5.m1.1.1.3.3.3.3.4" xref="S3.E5.m1.1.1.3.3.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.3.3.3.1b" xref="S3.E5.m1.1.1.3.3.3.3.1.cmml">â€‹</mo><mi id="S3.E5.m1.1.1.3.3.3.3.5" xref="S3.E5.m1.1.1.3.3.3.3.5.cmml">n</mi></mrow></msub></mrow><mo id="S3.E5.m1.1.1.3.1a" xref="S3.E5.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E5.m1.1.1.3.4" xref="S3.E5.m1.1.1.3.4.cmml"><msub id="S3.E5.m1.1.1.3.4.2" xref="S3.E5.m1.1.1.3.4.2.cmml"><mi id="S3.E5.m1.1.1.3.4.2.2" xref="S3.E5.m1.1.1.3.4.2.2.cmml">Î¼</mi><mrow id="S3.E5.m1.1.1.3.4.2.3" xref="S3.E5.m1.1.1.3.4.2.3.cmml"><mi id="S3.E5.m1.1.1.3.4.2.3.2" xref="S3.E5.m1.1.1.3.4.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.4.2.3.1" xref="S3.E5.m1.1.1.3.4.2.3.1.cmml">â€‹</mo><mi id="S3.E5.m1.1.1.3.4.2.3.3" xref="S3.E5.m1.1.1.3.4.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.4.2.3.1a" xref="S3.E5.m1.1.1.3.4.2.3.1.cmml">â€‹</mo><mi id="S3.E5.m1.1.1.3.4.2.3.4" xref="S3.E5.m1.1.1.3.4.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.4.2.3.1b" xref="S3.E5.m1.1.1.3.4.2.3.1.cmml">â€‹</mo><mi id="S3.E5.m1.1.1.3.4.2.3.5" xref="S3.E5.m1.1.1.3.4.2.3.5.cmml">b</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E5.m1.1.1.3.4.1" xref="S3.E5.m1.1.1.3.4.1.cmml">âˆ—</mo><msub id="S3.E5.m1.1.1.3.4.3" xref="S3.E5.m1.1.1.3.4.3.cmml"><mi id="S3.E5.m1.1.1.3.4.3.2" xref="S3.E5.m1.1.1.3.4.3.2.cmml">l</mi><mrow id="S3.E5.m1.1.1.3.4.3.3" xref="S3.E5.m1.1.1.3.4.3.3.cmml"><mi id="S3.E5.m1.1.1.3.4.3.3.2" xref="S3.E5.m1.1.1.3.4.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.4.3.3.1" xref="S3.E5.m1.1.1.3.4.3.3.1.cmml">â€‹</mo><mi id="S3.E5.m1.1.1.3.4.3.3.3" xref="S3.E5.m1.1.1.3.4.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.4.3.3.1a" xref="S3.E5.m1.1.1.3.4.3.3.1.cmml">â€‹</mo><mi id="S3.E5.m1.1.1.3.4.3.3.4" xref="S3.E5.m1.1.1.3.4.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.4.3.3.1b" xref="S3.E5.m1.1.1.3.4.3.3.1.cmml">â€‹</mo><mi id="S3.E5.m1.1.1.3.4.3.3.5" xref="S3.E5.m1.1.1.3.4.3.3.5.cmml">b</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><eq id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"></eq><ci id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1.2">ğ‘™</ci><apply id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3"><plus id="S3.E5.m1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.3.1"></plus><apply id="S3.E5.m1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.3.2.2">ğ‘™</ci><apply id="S3.E5.m1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.3.2.3"><times id="S3.E5.m1.1.1.3.2.3.1.cmml" xref="S3.E5.m1.1.1.3.2.3.1"></times><ci id="S3.E5.m1.1.1.3.2.3.2.cmml" xref="S3.E5.m1.1.1.3.2.3.2">ğ‘</ci><ci id="S3.E5.m1.1.1.3.2.3.3.cmml" xref="S3.E5.m1.1.1.3.2.3.3">ğ‘™</ci><ci id="S3.E5.m1.1.1.3.2.3.4.cmml" xref="S3.E5.m1.1.1.3.2.3.4">ğ‘</ci><ci id="S3.E5.m1.1.1.3.2.3.5.cmml" xref="S3.E5.m1.1.1.3.2.3.5">ğ‘ </ci><ci id="S3.E5.m1.1.1.3.2.3.6.cmml" xref="S3.E5.m1.1.1.3.2.3.6">ğ‘ </ci></apply></apply><apply id="S3.E5.m1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.3.3"><times id="S3.E5.m1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.3.3.1"></times><apply id="S3.E5.m1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.3.2.1.cmml" xref="S3.E5.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.E5.m1.1.1.3.3.2.2.cmml" xref="S3.E5.m1.1.1.3.3.2.2">ğœ‡</ci><apply id="S3.E5.m1.1.1.3.3.2.3.cmml" xref="S3.E5.m1.1.1.3.3.2.3"><times id="S3.E5.m1.1.1.3.3.2.3.1.cmml" xref="S3.E5.m1.1.1.3.3.2.3.1"></times><ci id="S3.E5.m1.1.1.3.3.2.3.2.cmml" xref="S3.E5.m1.1.1.3.3.2.3.2">ğ‘š</ci><ci id="S3.E5.m1.1.1.3.3.2.3.3.cmml" xref="S3.E5.m1.1.1.3.3.2.3.3">ğ‘œ</ci><ci id="S3.E5.m1.1.1.3.3.2.3.4.cmml" xref="S3.E5.m1.1.1.3.3.2.3.4">ğ‘œ</ci><ci id="S3.E5.m1.1.1.3.3.2.3.5.cmml" xref="S3.E5.m1.1.1.3.3.2.3.5">ğ‘›</ci></apply></apply><apply id="S3.E5.m1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.E5.m1.1.1.3.3.3.2.cmml" xref="S3.E5.m1.1.1.3.3.3.2">ğ‘™</ci><apply id="S3.E5.m1.1.1.3.3.3.3.cmml" xref="S3.E5.m1.1.1.3.3.3.3"><times id="S3.E5.m1.1.1.3.3.3.3.1.cmml" xref="S3.E5.m1.1.1.3.3.3.3.1"></times><ci id="S3.E5.m1.1.1.3.3.3.3.2.cmml" xref="S3.E5.m1.1.1.3.3.3.3.2">ğ‘š</ci><ci id="S3.E5.m1.1.1.3.3.3.3.3.cmml" xref="S3.E5.m1.1.1.3.3.3.3.3">ğ‘œ</ci><ci id="S3.E5.m1.1.1.3.3.3.3.4.cmml" xref="S3.E5.m1.1.1.3.3.3.3.4">ğ‘œ</ci><ci id="S3.E5.m1.1.1.3.3.3.3.5.cmml" xref="S3.E5.m1.1.1.3.3.3.3.5">ğ‘›</ci></apply></apply></apply><apply id="S3.E5.m1.1.1.3.4.cmml" xref="S3.E5.m1.1.1.3.4"><times id="S3.E5.m1.1.1.3.4.1.cmml" xref="S3.E5.m1.1.1.3.4.1"></times><apply id="S3.E5.m1.1.1.3.4.2.cmml" xref="S3.E5.m1.1.1.3.4.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.4.2.1.cmml" xref="S3.E5.m1.1.1.3.4.2">subscript</csymbol><ci id="S3.E5.m1.1.1.3.4.2.2.cmml" xref="S3.E5.m1.1.1.3.4.2.2">ğœ‡</ci><apply id="S3.E5.m1.1.1.3.4.2.3.cmml" xref="S3.E5.m1.1.1.3.4.2.3"><times id="S3.E5.m1.1.1.3.4.2.3.1.cmml" xref="S3.E5.m1.1.1.3.4.2.3.1"></times><ci id="S3.E5.m1.1.1.3.4.2.3.2.cmml" xref="S3.E5.m1.1.1.3.4.2.3.2">ğ‘”</ci><ci id="S3.E5.m1.1.1.3.4.2.3.3.cmml" xref="S3.E5.m1.1.1.3.4.2.3.3">ğ‘™</ci><ci id="S3.E5.m1.1.1.3.4.2.3.4.cmml" xref="S3.E5.m1.1.1.3.4.2.3.4">ğ‘œ</ci><ci id="S3.E5.m1.1.1.3.4.2.3.5.cmml" xref="S3.E5.m1.1.1.3.4.2.3.5">ğ‘</ci></apply></apply><apply id="S3.E5.m1.1.1.3.4.3.cmml" xref="S3.E5.m1.1.1.3.4.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.4.3.1.cmml" xref="S3.E5.m1.1.1.3.4.3">subscript</csymbol><ci id="S3.E5.m1.1.1.3.4.3.2.cmml" xref="S3.E5.m1.1.1.3.4.3.2">ğ‘™</ci><apply id="S3.E5.m1.1.1.3.4.3.3.cmml" xref="S3.E5.m1.1.1.3.4.3.3"><times id="S3.E5.m1.1.1.3.4.3.3.1.cmml" xref="S3.E5.m1.1.1.3.4.3.3.1"></times><ci id="S3.E5.m1.1.1.3.4.3.3.2.cmml" xref="S3.E5.m1.1.1.3.4.3.3.2">ğ‘”</ci><ci id="S3.E5.m1.1.1.3.4.3.3.3.cmml" xref="S3.E5.m1.1.1.3.4.3.3.3">ğ‘™</ci><ci id="S3.E5.m1.1.1.3.4.3.3.4.cmml" xref="S3.E5.m1.1.1.3.4.3.3.4">ğ‘œ</ci><ci id="S3.E5.m1.1.1.3.4.3.3.5.cmml" xref="S3.E5.m1.1.1.3.4.3.3.5">ğ‘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">l=l_{class}+\mu_{moon}*l_{moon}+\mu_{glob}*l_{glob}\\
</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> FedSSC Framework</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">number of communication rounds <math id="alg1.l1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">ğ‘‡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">T</annotation></semantics></math>,
number of devices <math id="alg1.l1.m2.1" class="ltx_Math" alttext="P" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">ğ‘ƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">P</annotation></semantics></math>, number of local
epochs <math id="alg1.l1.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l1.m3.1a"><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">ğ¸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">E</annotation></semantics></math>, temperature <math id="alg1.l1.m4.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="alg1.l1.m4.1a"><mi id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">Ï„</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">ğœ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">\tau</annotation></semantics></math> , learning rate <math id="alg1.l1.m5.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.l1.m5.1a"><mi id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml">Î·</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><ci id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1">ğœ‚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">\eta</annotation></semantics></math>,
hyper-parameter <math id="alg1.l1.m6.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="alg1.l1.m6.1a"><mi id="alg1.l1.m6.1.1" xref="alg1.l1.m6.1.1.cmml">Î¼</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m6.1b"><ci id="alg1.l1.m6.1.1.cmml" xref="alg1.l1.m6.1.1">ğœ‡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m6.1c">\mu</annotation></semantics></math>, total number of data <math id="alg1.l1.m7.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.l1.m7.1a"><mi id="alg1.l1.m7.1.1" xref="alg1.l1.m7.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m7.1b"><ci id="alg1.l1.m7.1.1.cmml" xref="alg1.l1.m7.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m7.1c">N</annotation></semantics></math>, number of data in device<sub id="alg1.l1.1" class="ltx_sub"><span id="alg1.l1.1.1" class="ltx_text ltx_font_italic">i</span></sub> is <math id="alg1.l1.m9.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="alg1.l1.m9.1a"><msub id="alg1.l1.m9.1.1" xref="alg1.l1.m9.1.1.cmml"><mi id="alg1.l1.m9.1.1.2" xref="alg1.l1.m9.1.1.2.cmml">N</mi><mi id="alg1.l1.m9.1.1.3" xref="alg1.l1.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m9.1b"><apply id="alg1.l1.m9.1.1.cmml" xref="alg1.l1.m9.1.1"><csymbol cd="ambiguous" id="alg1.l1.m9.1.1.1.cmml" xref="alg1.l1.m9.1.1">subscript</csymbol><ci id="alg1.l1.m9.1.1.2.cmml" xref="alg1.l1.m9.1.1.2">ğ‘</ci><ci id="alg1.l1.m9.1.1.3.cmml" xref="alg1.l1.m9.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m9.1c">N_{i}</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">Final global model <math id="alg1.l2.m1.1" class="ltx_Math" alttext="w^{T}" display="inline"><semantics id="alg1.l2.m1.1a"><msup id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">w</mi><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">superscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">ğ‘¤</ci><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">ğ‘‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">w^{T}</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span id="alg1.l3.1" class="ltx_text ltx_font_bold ltx_font_italic">Global Server</span> :

</div>
<div id="alg1.l4" class="ltx_listingline">
<span id="alg1.l4.1" class="ltx_text">Initialize global model <math id="alg1.l4.1.m1.1" class="ltx_Math" alttext="w^{0}" display="inline"><semantics id="alg1.l4.1.m1.1a"><msup id="alg1.l4.1.m1.1.1" xref="alg1.l4.1.m1.1.1.cmml"><mi id="alg1.l4.1.m1.1.1.2" xref="alg1.l4.1.m1.1.1.2.cmml">w</mi><mn id="alg1.l4.1.m1.1.1.3" xref="alg1.l4.1.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="alg1.l4.1.m1.1b"><apply id="alg1.l4.1.m1.1.1.cmml" xref="alg1.l4.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l4.1.m1.1.1.1.cmml" xref="alg1.l4.1.m1.1.1">superscript</csymbol><ci id="alg1.l4.1.m1.1.1.2.cmml" xref="alg1.l4.1.m1.1.1.2">ğ‘¤</ci><cn type="integer" id="alg1.l4.1.m1.1.1.3.cmml" xref="alg1.l4.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.1.m1.1c">w^{0}</annotation></semantics></math></span>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span id="alg1.l5.1" class="ltx_text">and classwise feature representation <math id="alg1.l5.1.m1.1" class="ltx_Math" alttext="zs^{0}" display="inline"><semantics id="alg1.l5.1.m1.1a"><mrow id="alg1.l5.1.m1.1.1" xref="alg1.l5.1.m1.1.1.cmml"><mi id="alg1.l5.1.m1.1.1.2" xref="alg1.l5.1.m1.1.1.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="alg1.l5.1.m1.1.1.1" xref="alg1.l5.1.m1.1.1.1.cmml">â€‹</mo><msup id="alg1.l5.1.m1.1.1.3" xref="alg1.l5.1.m1.1.1.3.cmml"><mi id="alg1.l5.1.m1.1.1.3.2" xref="alg1.l5.1.m1.1.1.3.2.cmml">s</mi><mn id="alg1.l5.1.m1.1.1.3.3" xref="alg1.l5.1.m1.1.1.3.3.cmml">0</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.1.m1.1b"><apply id="alg1.l5.1.m1.1.1.cmml" xref="alg1.l5.1.m1.1.1"><times id="alg1.l5.1.m1.1.1.1.cmml" xref="alg1.l5.1.m1.1.1.1"></times><ci id="alg1.l5.1.m1.1.1.2.cmml" xref="alg1.l5.1.m1.1.1.2">ğ‘§</ci><apply id="alg1.l5.1.m1.1.1.3.cmml" xref="alg1.l5.1.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.1.m1.1.1.3.1.cmml" xref="alg1.l5.1.m1.1.1.3">superscript</csymbol><ci id="alg1.l5.1.m1.1.1.3.2.cmml" xref="alg1.l5.1.m1.1.1.3.2">ğ‘ </ci><cn type="integer" id="alg1.l5.1.m1.1.1.3.3.cmml" xref="alg1.l5.1.m1.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.1.m1.1c">zs^{0}</annotation></semantics></math></span>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span id="alg1.l6.1" class="ltx_text ltx_font_bold">for</span>Â <math id="alg1.l6.m1.4" class="ltx_Math" alttext="t=0,1,...,T-1" display="inline"><semantics id="alg1.l6.m1.4a"><mrow id="alg1.l6.m1.4.4" xref="alg1.l6.m1.4.4.cmml"><mi id="alg1.l6.m1.4.4.3" xref="alg1.l6.m1.4.4.3.cmml">t</mi><mo id="alg1.l6.m1.4.4.2" xref="alg1.l6.m1.4.4.2.cmml">=</mo><mrow id="alg1.l6.m1.4.4.1.1" xref="alg1.l6.m1.4.4.1.2.cmml"><mn id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">0</mn><mo id="alg1.l6.m1.4.4.1.1.2" xref="alg1.l6.m1.4.4.1.2.cmml">,</mo><mn id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml">1</mn><mo id="alg1.l6.m1.4.4.1.1.3" xref="alg1.l6.m1.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l6.m1.3.3" xref="alg1.l6.m1.3.3.cmml">â€¦</mi><mo id="alg1.l6.m1.4.4.1.1.4" xref="alg1.l6.m1.4.4.1.2.cmml">,</mo><mrow id="alg1.l6.m1.4.4.1.1.1" xref="alg1.l6.m1.4.4.1.1.1.cmml"><mi id="alg1.l6.m1.4.4.1.1.1.2" xref="alg1.l6.m1.4.4.1.1.1.2.cmml">T</mi><mo id="alg1.l6.m1.4.4.1.1.1.1" xref="alg1.l6.m1.4.4.1.1.1.1.cmml">âˆ’</mo><mn id="alg1.l6.m1.4.4.1.1.1.3" xref="alg1.l6.m1.4.4.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.4b"><apply id="alg1.l6.m1.4.4.cmml" xref="alg1.l6.m1.4.4"><eq id="alg1.l6.m1.4.4.2.cmml" xref="alg1.l6.m1.4.4.2"></eq><ci id="alg1.l6.m1.4.4.3.cmml" xref="alg1.l6.m1.4.4.3">ğ‘¡</ci><list id="alg1.l6.m1.4.4.1.2.cmml" xref="alg1.l6.m1.4.4.1.1"><cn type="integer" id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">0</cn><cn type="integer" id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2">1</cn><ci id="alg1.l6.m1.3.3.cmml" xref="alg1.l6.m1.3.3">â€¦</ci><apply id="alg1.l6.m1.4.4.1.1.1.cmml" xref="alg1.l6.m1.4.4.1.1.1"><minus id="alg1.l6.m1.4.4.1.1.1.1.cmml" xref="alg1.l6.m1.4.4.1.1.1.1"></minus><ci id="alg1.l6.m1.4.4.1.1.1.2.cmml" xref="alg1.l6.m1.4.4.1.1.1.2">ğ‘‡</ci><cn type="integer" id="alg1.l6.m1.4.4.1.1.1.3.cmml" xref="alg1.l6.m1.4.4.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.4c">t=0,1,...,T-1</annotation></semantics></math>Â <span id="alg1.l6.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l7" class="ltx_listingline">Â Â Â Â Â <span id="alg1.l7.1" class="ltx_text ltx_font_bold">for</span>Â <math id="alg1.l7.m1.3" class="ltx_Math" alttext="i=1,...,P" display="inline"><semantics id="alg1.l7.m1.3a"><mrow id="alg1.l7.m1.3.4" xref="alg1.l7.m1.3.4.cmml"><mi id="alg1.l7.m1.3.4.2" xref="alg1.l7.m1.3.4.2.cmml">i</mi><mo id="alg1.l7.m1.3.4.1" xref="alg1.l7.m1.3.4.1.cmml">=</mo><mrow id="alg1.l7.m1.3.4.3.2" xref="alg1.l7.m1.3.4.3.1.cmml"><mn id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">1</mn><mo id="alg1.l7.m1.3.4.3.2.1" xref="alg1.l7.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml">â€¦</mi><mo id="alg1.l7.m1.3.4.3.2.2" xref="alg1.l7.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l7.m1.3.3" xref="alg1.l7.m1.3.3.cmml">P</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.3b"><apply id="alg1.l7.m1.3.4.cmml" xref="alg1.l7.m1.3.4"><eq id="alg1.l7.m1.3.4.1.cmml" xref="alg1.l7.m1.3.4.1"></eq><ci id="alg1.l7.m1.3.4.2.cmml" xref="alg1.l7.m1.3.4.2">ğ‘–</ci><list id="alg1.l7.m1.3.4.3.1.cmml" xref="alg1.l7.m1.3.4.3.2"><cn type="integer" id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">1</cn><ci id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2">â€¦</ci><ci id="alg1.l7.m1.3.3.cmml" xref="alg1.l7.m1.3.3">ğ‘ƒ</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.3c">i=1,...,P</annotation></semantics></math>Â <span id="alg1.l7.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l8" class="ltx_listingline">Â Â Â Â Â Â Â Â Â send the <math id="alg1.l8.m1.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="alg1.l8.m1.1a"><msup id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">w</mi><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1">superscript</csymbol><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">ğ‘¤</ci><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">w^{t}</annotation></semantics></math> and the <math id="alg1.l8.m2.1" class="ltx_Math" alttext="zs^{t}" display="inline"><semantics id="alg1.l8.m2.1a"><mrow id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml"><mi id="alg1.l8.m2.1.1.2" xref="alg1.l8.m2.1.1.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m2.1.1.1" xref="alg1.l8.m2.1.1.1.cmml">â€‹</mo><msup id="alg1.l8.m2.1.1.3" xref="alg1.l8.m2.1.1.3.cmml"><mi id="alg1.l8.m2.1.1.3.2" xref="alg1.l8.m2.1.1.3.2.cmml">s</mi><mi id="alg1.l8.m2.1.1.3.3" xref="alg1.l8.m2.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><apply id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1"><times id="alg1.l8.m2.1.1.1.cmml" xref="alg1.l8.m2.1.1.1"></times><ci id="alg1.l8.m2.1.1.2.cmml" xref="alg1.l8.m2.1.1.2">ğ‘§</ci><apply id="alg1.l8.m2.1.1.3.cmml" xref="alg1.l8.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m2.1.1.3.1.cmml" xref="alg1.l8.m2.1.1.3">superscript</csymbol><ci id="alg1.l8.m2.1.1.3.2.cmml" xref="alg1.l8.m2.1.1.3.2">ğ‘ </ci><ci id="alg1.l8.m2.1.1.3.3.cmml" xref="alg1.l8.m2.1.1.3.3">ğ‘¡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">zs^{t}</annotation></semantics></math> to device <math id="alg1.l8.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l8.m3.1a"><mi id="alg1.l8.m3.1.1" xref="alg1.l8.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m3.1b"><ci id="alg1.l8.m3.1.1.cmml" xref="alg1.l8.m3.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m3.1c">i</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">Â Â Â Â Â Â Â Â Â <math id="alg1.l9.m1.2" class="ltx_Math" alttext="w_{i}^{t+1},zs_{i}^{t+1}\leftarrow" display="inline"><semantics id="alg1.l9.m1.2a"><mrow id="alg1.l9.m1.2.2" xref="alg1.l9.m1.2.2.cmml"><mrow id="alg1.l9.m1.2.2.2.2" xref="alg1.l9.m1.2.2.2.3.cmml"><msubsup id="alg1.l9.m1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.2.2" xref="alg1.l9.m1.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l9.m1.1.1.1.1.1.2.3" xref="alg1.l9.m1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="alg1.l9.m1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.3.2" xref="alg1.l9.m1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l9.m1.1.1.1.1.1.3.1" xref="alg1.l9.m1.1.1.1.1.1.3.1.cmml">+</mo><mn id="alg1.l9.m1.1.1.1.1.1.3.3" xref="alg1.l9.m1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.l9.m1.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.3.cmml">,</mo><mrow id="alg1.l9.m1.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.cmml"><mi id="alg1.l9.m1.2.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.2.2.2.2.2.1" xref="alg1.l9.m1.2.2.2.2.2.1.cmml">â€‹</mo><msubsup id="alg1.l9.m1.2.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l9.m1.2.2.2.2.2.3.2.2" xref="alg1.l9.m1.2.2.2.2.2.3.2.2.cmml">s</mi><mi id="alg1.l9.m1.2.2.2.2.2.3.2.3" xref="alg1.l9.m1.2.2.2.2.2.3.2.3.cmml">i</mi><mrow id="alg1.l9.m1.2.2.2.2.2.3.3" xref="alg1.l9.m1.2.2.2.2.2.3.3.cmml"><mi id="alg1.l9.m1.2.2.2.2.2.3.3.2" xref="alg1.l9.m1.2.2.2.2.2.3.3.2.cmml">t</mi><mo id="alg1.l9.m1.2.2.2.2.2.3.3.1" xref="alg1.l9.m1.2.2.2.2.2.3.3.1.cmml">+</mo><mn id="alg1.l9.m1.2.2.2.2.2.3.3.3" xref="alg1.l9.m1.2.2.2.2.2.3.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow><mo stretchy="false" id="alg1.l9.m1.2.2.3" xref="alg1.l9.m1.2.2.3.cmml">â†</mo><mi id="alg1.l9.m1.2.2.4" xref="alg1.l9.m1.2.2.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.2b"><apply id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2"><ci id="alg1.l9.m1.2.2.3.cmml" xref="alg1.l9.m1.2.2.3">â†</ci><list id="alg1.l9.m1.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2"><apply id="alg1.l9.m1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l9.m1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.2.2">ğ‘¤</ci><ci id="alg1.l9.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.2.3">ğ‘–</ci></apply><apply id="alg1.l9.m1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.3"><plus id="alg1.l9.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.3.1"></plus><ci id="alg1.l9.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.3.2">ğ‘¡</ci><cn type="integer" id="alg1.l9.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l9.m1.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2"><times id="alg1.l9.m1.2.2.2.2.2.1.cmml" xref="alg1.l9.m1.2.2.2.2.2.1"></times><ci id="alg1.l9.m1.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.2">ğ‘§</ci><apply id="alg1.l9.m1.2.2.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l9.m1.2.2.2.2.2.3">superscript</csymbol><apply id="alg1.l9.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.2.2.3.2.1.cmml" xref="alg1.l9.m1.2.2.2.2.2.3">subscript</csymbol><ci id="alg1.l9.m1.2.2.2.2.2.3.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.3.2.2">ğ‘ </ci><ci id="alg1.l9.m1.2.2.2.2.2.3.2.3.cmml" xref="alg1.l9.m1.2.2.2.2.2.3.2.3">ğ‘–</ci></apply><apply id="alg1.l9.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l9.m1.2.2.2.2.2.3.3"><plus id="alg1.l9.m1.2.2.2.2.2.3.3.1.cmml" xref="alg1.l9.m1.2.2.2.2.2.3.3.1"></plus><ci id="alg1.l9.m1.2.2.2.2.2.3.3.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.3.3.2">ğ‘¡</ci><cn type="integer" id="alg1.l9.m1.2.2.2.2.2.3.3.3.cmml" xref="alg1.l9.m1.2.2.2.2.2.3.3.3">1</cn></apply></apply></apply></list><csymbol cd="latexml" id="alg1.l9.m1.2.2.4.cmml" xref="alg1.l9.m1.2.2.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.2c">w_{i}^{t+1},zs_{i}^{t+1}\leftarrow</annotation></semantics></math> <span id="alg1.l9.1" class="ltx_text ltx_font_bold">LocalTraining</span>(<math id="alg1.l9.m2.3" class="ltx_Math" alttext="i,w^{t},zs^{t}" display="inline"><semantics id="alg1.l9.m2.3a"><mrow id="alg1.l9.m2.3.3.2" xref="alg1.l9.m2.3.3.3.cmml"><mi id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml">i</mi><mo id="alg1.l9.m2.3.3.2.3" xref="alg1.l9.m2.3.3.3.cmml">,</mo><msup id="alg1.l9.m2.2.2.1.1" xref="alg1.l9.m2.2.2.1.1.cmml"><mi id="alg1.l9.m2.2.2.1.1.2" xref="alg1.l9.m2.2.2.1.1.2.cmml">w</mi><mi id="alg1.l9.m2.2.2.1.1.3" xref="alg1.l9.m2.2.2.1.1.3.cmml">t</mi></msup><mo id="alg1.l9.m2.3.3.2.4" xref="alg1.l9.m2.3.3.3.cmml">,</mo><mrow id="alg1.l9.m2.3.3.2.2" xref="alg1.l9.m2.3.3.2.2.cmml"><mi id="alg1.l9.m2.3.3.2.2.2" xref="alg1.l9.m2.3.3.2.2.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m2.3.3.2.2.1" xref="alg1.l9.m2.3.3.2.2.1.cmml">â€‹</mo><msup id="alg1.l9.m2.3.3.2.2.3" xref="alg1.l9.m2.3.3.2.2.3.cmml"><mi id="alg1.l9.m2.3.3.2.2.3.2" xref="alg1.l9.m2.3.3.2.2.3.2.cmml">s</mi><mi id="alg1.l9.m2.3.3.2.2.3.3" xref="alg1.l9.m2.3.3.2.2.3.3.cmml">t</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.3b"><list id="alg1.l9.m2.3.3.3.cmml" xref="alg1.l9.m2.3.3.2"><ci id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1">ğ‘–</ci><apply id="alg1.l9.m2.2.2.1.1.cmml" xref="alg1.l9.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.2.2.1.1.1.cmml" xref="alg1.l9.m2.2.2.1.1">superscript</csymbol><ci id="alg1.l9.m2.2.2.1.1.2.cmml" xref="alg1.l9.m2.2.2.1.1.2">ğ‘¤</ci><ci id="alg1.l9.m2.2.2.1.1.3.cmml" xref="alg1.l9.m2.2.2.1.1.3">ğ‘¡</ci></apply><apply id="alg1.l9.m2.3.3.2.2.cmml" xref="alg1.l9.m2.3.3.2.2"><times id="alg1.l9.m2.3.3.2.2.1.cmml" xref="alg1.l9.m2.3.3.2.2.1"></times><ci id="alg1.l9.m2.3.3.2.2.2.cmml" xref="alg1.l9.m2.3.3.2.2.2">ğ‘§</ci><apply id="alg1.l9.m2.3.3.2.2.3.cmml" xref="alg1.l9.m2.3.3.2.2.3"><csymbol cd="ambiguous" id="alg1.l9.m2.3.3.2.2.3.1.cmml" xref="alg1.l9.m2.3.3.2.2.3">superscript</csymbol><ci id="alg1.l9.m2.3.3.2.2.3.2.cmml" xref="alg1.l9.m2.3.3.2.2.3.2">ğ‘ </ci><ci id="alg1.l9.m2.3.3.2.2.3.3.cmml" xref="alg1.l9.m2.3.3.2.2.3.3">ğ‘¡</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.3c">i,w^{t},zs^{t}</annotation></semantics></math>)

</div>
<div id="alg1.l10" class="ltx_listingline">Â Â Â Â Â <span id="alg1.l10.1" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l10.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l11" class="ltx_listingline">Â Â Â Â Â <math id="alg1.l11.m1.2" class="ltx_Math" alttext="w^{t+1}\leftarrow\sum_{i}^{P}\frac{|N_{i}|}{|N|}w_{i}^{t}" display="inline"><semantics id="alg1.l11.m1.2a"><mrow id="alg1.l11.m1.2.3" xref="alg1.l11.m1.2.3.cmml"><msup id="alg1.l11.m1.2.3.2" xref="alg1.l11.m1.2.3.2.cmml"><mi id="alg1.l11.m1.2.3.2.2" xref="alg1.l11.m1.2.3.2.2.cmml">w</mi><mrow id="alg1.l11.m1.2.3.2.3" xref="alg1.l11.m1.2.3.2.3.cmml"><mi id="alg1.l11.m1.2.3.2.3.2" xref="alg1.l11.m1.2.3.2.3.2.cmml">t</mi><mo id="alg1.l11.m1.2.3.2.3.1" xref="alg1.l11.m1.2.3.2.3.1.cmml">+</mo><mn id="alg1.l11.m1.2.3.2.3.3" xref="alg1.l11.m1.2.3.2.3.3.cmml">1</mn></mrow></msup><mo rspace="0.111em" stretchy="false" id="alg1.l11.m1.2.3.1" xref="alg1.l11.m1.2.3.1.cmml">â†</mo><mrow id="alg1.l11.m1.2.3.3" xref="alg1.l11.m1.2.3.3.cmml"><msubsup id="alg1.l11.m1.2.3.3.1" xref="alg1.l11.m1.2.3.3.1.cmml"><mo id="alg1.l11.m1.2.3.3.1.2.2" xref="alg1.l11.m1.2.3.3.1.2.2.cmml">âˆ‘</mo><mi id="alg1.l11.m1.2.3.3.1.2.3" xref="alg1.l11.m1.2.3.3.1.2.3.cmml">i</mi><mi id="alg1.l11.m1.2.3.3.1.3" xref="alg1.l11.m1.2.3.3.1.3.cmml">P</mi></msubsup><mrow id="alg1.l11.m1.2.3.3.2" xref="alg1.l11.m1.2.3.3.2.cmml"><mfrac id="alg1.l11.m1.2.2" xref="alg1.l11.m1.2.2.cmml"><mrow id="alg1.l11.m1.1.1.1.1" xref="alg1.l11.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l11.m1.1.1.1.1.2" xref="alg1.l11.m1.1.1.1.2.1.cmml">|</mo><msub id="alg1.l11.m1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.cmml"><mi id="alg1.l11.m1.1.1.1.1.1.2" xref="alg1.l11.m1.1.1.1.1.1.2.cmml">N</mi><mi id="alg1.l11.m1.1.1.1.1.1.3" xref="alg1.l11.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l11.m1.1.1.1.1.3" xref="alg1.l11.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="alg1.l11.m1.2.2.2.3" xref="alg1.l11.m1.2.2.2.2.cmml"><mo stretchy="false" id="alg1.l11.m1.2.2.2.3.1" xref="alg1.l11.m1.2.2.2.2.1.cmml">|</mo><mi id="alg1.l11.m1.2.2.2.1" xref="alg1.l11.m1.2.2.2.1.cmml">N</mi><mo stretchy="false" id="alg1.l11.m1.2.2.2.3.2" xref="alg1.l11.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l11.m1.2.3.3.2.1" xref="alg1.l11.m1.2.3.3.2.1.cmml">â€‹</mo><msubsup id="alg1.l11.m1.2.3.3.2.2" xref="alg1.l11.m1.2.3.3.2.2.cmml"><mi id="alg1.l11.m1.2.3.3.2.2.2.2" xref="alg1.l11.m1.2.3.3.2.2.2.2.cmml">w</mi><mi id="alg1.l11.m1.2.3.3.2.2.2.3" xref="alg1.l11.m1.2.3.3.2.2.2.3.cmml">i</mi><mi id="alg1.l11.m1.2.3.3.2.2.3" xref="alg1.l11.m1.2.3.3.2.2.3.cmml">t</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.2b"><apply id="alg1.l11.m1.2.3.cmml" xref="alg1.l11.m1.2.3"><ci id="alg1.l11.m1.2.3.1.cmml" xref="alg1.l11.m1.2.3.1">â†</ci><apply id="alg1.l11.m1.2.3.2.cmml" xref="alg1.l11.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l11.m1.2.3.2.1.cmml" xref="alg1.l11.m1.2.3.2">superscript</csymbol><ci id="alg1.l11.m1.2.3.2.2.cmml" xref="alg1.l11.m1.2.3.2.2">ğ‘¤</ci><apply id="alg1.l11.m1.2.3.2.3.cmml" xref="alg1.l11.m1.2.3.2.3"><plus id="alg1.l11.m1.2.3.2.3.1.cmml" xref="alg1.l11.m1.2.3.2.3.1"></plus><ci id="alg1.l11.m1.2.3.2.3.2.cmml" xref="alg1.l11.m1.2.3.2.3.2">ğ‘¡</ci><cn type="integer" id="alg1.l11.m1.2.3.2.3.3.cmml" xref="alg1.l11.m1.2.3.2.3.3">1</cn></apply></apply><apply id="alg1.l11.m1.2.3.3.cmml" xref="alg1.l11.m1.2.3.3"><apply id="alg1.l11.m1.2.3.3.1.cmml" xref="alg1.l11.m1.2.3.3.1"><csymbol cd="ambiguous" id="alg1.l11.m1.2.3.3.1.1.cmml" xref="alg1.l11.m1.2.3.3.1">superscript</csymbol><apply id="alg1.l11.m1.2.3.3.1.2.cmml" xref="alg1.l11.m1.2.3.3.1"><csymbol cd="ambiguous" id="alg1.l11.m1.2.3.3.1.2.1.cmml" xref="alg1.l11.m1.2.3.3.1">subscript</csymbol><sum id="alg1.l11.m1.2.3.3.1.2.2.cmml" xref="alg1.l11.m1.2.3.3.1.2.2"></sum><ci id="alg1.l11.m1.2.3.3.1.2.3.cmml" xref="alg1.l11.m1.2.3.3.1.2.3">ğ‘–</ci></apply><ci id="alg1.l11.m1.2.3.3.1.3.cmml" xref="alg1.l11.m1.2.3.3.1.3">ğ‘ƒ</ci></apply><apply id="alg1.l11.m1.2.3.3.2.cmml" xref="alg1.l11.m1.2.3.3.2"><times id="alg1.l11.m1.2.3.3.2.1.cmml" xref="alg1.l11.m1.2.3.3.2.1"></times><apply id="alg1.l11.m1.2.2.cmml" xref="alg1.l11.m1.2.2"><divide id="alg1.l11.m1.2.2.3.cmml" xref="alg1.l11.m1.2.2"></divide><apply id="alg1.l11.m1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1"><abs id="alg1.l11.m1.1.1.1.2.1.cmml" xref="alg1.l11.m1.1.1.1.1.2"></abs><apply id="alg1.l11.m1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.2">ğ‘</ci><ci id="alg1.l11.m1.1.1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.3">ğ‘–</ci></apply></apply><apply id="alg1.l11.m1.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.3"><abs id="alg1.l11.m1.2.2.2.2.1.cmml" xref="alg1.l11.m1.2.2.2.3.1"></abs><ci id="alg1.l11.m1.2.2.2.1.cmml" xref="alg1.l11.m1.2.2.2.1">ğ‘</ci></apply></apply><apply id="alg1.l11.m1.2.3.3.2.2.cmml" xref="alg1.l11.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.2.3.3.2.2.1.cmml" xref="alg1.l11.m1.2.3.3.2.2">superscript</csymbol><apply id="alg1.l11.m1.2.3.3.2.2.2.cmml" xref="alg1.l11.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.2.3.3.2.2.2.1.cmml" xref="alg1.l11.m1.2.3.3.2.2">subscript</csymbol><ci id="alg1.l11.m1.2.3.3.2.2.2.2.cmml" xref="alg1.l11.m1.2.3.3.2.2.2.2">ğ‘¤</ci><ci id="alg1.l11.m1.2.3.3.2.2.2.3.cmml" xref="alg1.l11.m1.2.3.3.2.2.2.3">ğ‘–</ci></apply><ci id="alg1.l11.m1.2.3.3.2.2.3.cmml" xref="alg1.l11.m1.2.3.3.2.2.3">ğ‘¡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.2c">w^{t+1}\leftarrow\sum_{i}^{P}\frac{|N_{i}|}{|N|}w_{i}^{t}</annotation></semantics></math>

</div>
<div id="alg1.l12" class="ltx_listingline">Â Â Â Â Â <math id="alg1.l12.m1.1" class="ltx_Math" alttext="zs^{t+1}\leftarrow\sum_{i}^{P}\frac{zs_{i}^{t+1}}{P}" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mrow id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml"><mi id="alg1.l12.m1.1.1.2.2" xref="alg1.l12.m1.1.1.2.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.2.1" xref="alg1.l12.m1.1.1.2.1.cmml">â€‹</mo><msup id="alg1.l12.m1.1.1.2.3" xref="alg1.l12.m1.1.1.2.3.cmml"><mi id="alg1.l12.m1.1.1.2.3.2" xref="alg1.l12.m1.1.1.2.3.2.cmml">s</mi><mrow id="alg1.l12.m1.1.1.2.3.3" xref="alg1.l12.m1.1.1.2.3.3.cmml"><mi id="alg1.l12.m1.1.1.2.3.3.2" xref="alg1.l12.m1.1.1.2.3.3.2.cmml">t</mi><mo id="alg1.l12.m1.1.1.2.3.3.1" xref="alg1.l12.m1.1.1.2.3.3.1.cmml">+</mo><mn id="alg1.l12.m1.1.1.2.3.3.3" xref="alg1.l12.m1.1.1.2.3.3.3.cmml">1</mn></mrow></msup></mrow><mo rspace="0.111em" stretchy="false" id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">â†</mo><mrow id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"><msubsup id="alg1.l12.m1.1.1.3.1" xref="alg1.l12.m1.1.1.3.1.cmml"><mo id="alg1.l12.m1.1.1.3.1.2.2" xref="alg1.l12.m1.1.1.3.1.2.2.cmml">âˆ‘</mo><mi id="alg1.l12.m1.1.1.3.1.2.3" xref="alg1.l12.m1.1.1.3.1.2.3.cmml">i</mi><mi id="alg1.l12.m1.1.1.3.1.3" xref="alg1.l12.m1.1.1.3.1.3.cmml">P</mi></msubsup><mfrac id="alg1.l12.m1.1.1.3.2" xref="alg1.l12.m1.1.1.3.2.cmml"><mrow id="alg1.l12.m1.1.1.3.2.2" xref="alg1.l12.m1.1.1.3.2.2.cmml"><mi id="alg1.l12.m1.1.1.3.2.2.2" xref="alg1.l12.m1.1.1.3.2.2.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.3.2.2.1" xref="alg1.l12.m1.1.1.3.2.2.1.cmml">â€‹</mo><msubsup id="alg1.l12.m1.1.1.3.2.2.3" xref="alg1.l12.m1.1.1.3.2.2.3.cmml"><mi id="alg1.l12.m1.1.1.3.2.2.3.2.2" xref="alg1.l12.m1.1.1.3.2.2.3.2.2.cmml">s</mi><mi id="alg1.l12.m1.1.1.3.2.2.3.2.3" xref="alg1.l12.m1.1.1.3.2.2.3.2.3.cmml">i</mi><mrow id="alg1.l12.m1.1.1.3.2.2.3.3" xref="alg1.l12.m1.1.1.3.2.2.3.3.cmml"><mi id="alg1.l12.m1.1.1.3.2.2.3.3.2" xref="alg1.l12.m1.1.1.3.2.2.3.3.2.cmml">t</mi><mo id="alg1.l12.m1.1.1.3.2.2.3.3.1" xref="alg1.l12.m1.1.1.3.2.2.3.3.1.cmml">+</mo><mn id="alg1.l12.m1.1.1.3.2.2.3.3.3" xref="alg1.l12.m1.1.1.3.2.2.3.3.3.cmml">1</mn></mrow></msubsup></mrow><mi id="alg1.l12.m1.1.1.3.2.3" xref="alg1.l12.m1.1.1.3.2.3.cmml">P</mi></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><ci id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1">â†</ci><apply id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2"><times id="alg1.l12.m1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1.2.1"></times><ci id="alg1.l12.m1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.2.2">ğ‘§</ci><apply id="alg1.l12.m1.1.1.2.3.cmml" xref="alg1.l12.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.3.1.cmml" xref="alg1.l12.m1.1.1.2.3">superscript</csymbol><ci id="alg1.l12.m1.1.1.2.3.2.cmml" xref="alg1.l12.m1.1.1.2.3.2">ğ‘ </ci><apply id="alg1.l12.m1.1.1.2.3.3.cmml" xref="alg1.l12.m1.1.1.2.3.3"><plus id="alg1.l12.m1.1.1.2.3.3.1.cmml" xref="alg1.l12.m1.1.1.2.3.3.1"></plus><ci id="alg1.l12.m1.1.1.2.3.3.2.cmml" xref="alg1.l12.m1.1.1.2.3.3.2">ğ‘¡</ci><cn type="integer" id="alg1.l12.m1.1.1.2.3.3.3.cmml" xref="alg1.l12.m1.1.1.2.3.3.3">1</cn></apply></apply></apply><apply id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3"><apply id="alg1.l12.m1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.1.1.cmml" xref="alg1.l12.m1.1.1.3.1">superscript</csymbol><apply id="alg1.l12.m1.1.1.3.1.2.cmml" xref="alg1.l12.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.1.2.1.cmml" xref="alg1.l12.m1.1.1.3.1">subscript</csymbol><sum id="alg1.l12.m1.1.1.3.1.2.2.cmml" xref="alg1.l12.m1.1.1.3.1.2.2"></sum><ci id="alg1.l12.m1.1.1.3.1.2.3.cmml" xref="alg1.l12.m1.1.1.3.1.2.3">ğ‘–</ci></apply><ci id="alg1.l12.m1.1.1.3.1.3.cmml" xref="alg1.l12.m1.1.1.3.1.3">ğ‘ƒ</ci></apply><apply id="alg1.l12.m1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.3.2"><divide id="alg1.l12.m1.1.1.3.2.1.cmml" xref="alg1.l12.m1.1.1.3.2"></divide><apply id="alg1.l12.m1.1.1.3.2.2.cmml" xref="alg1.l12.m1.1.1.3.2.2"><times id="alg1.l12.m1.1.1.3.2.2.1.cmml" xref="alg1.l12.m1.1.1.3.2.2.1"></times><ci id="alg1.l12.m1.1.1.3.2.2.2.cmml" xref="alg1.l12.m1.1.1.3.2.2.2">ğ‘§</ci><apply id="alg1.l12.m1.1.1.3.2.2.3.cmml" xref="alg1.l12.m1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.2.2.3.1.cmml" xref="alg1.l12.m1.1.1.3.2.2.3">superscript</csymbol><apply id="alg1.l12.m1.1.1.3.2.2.3.2.cmml" xref="alg1.l12.m1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.2.2.3.2.1.cmml" xref="alg1.l12.m1.1.1.3.2.2.3">subscript</csymbol><ci id="alg1.l12.m1.1.1.3.2.2.3.2.2.cmml" xref="alg1.l12.m1.1.1.3.2.2.3.2.2">ğ‘ </ci><ci id="alg1.l12.m1.1.1.3.2.2.3.2.3.cmml" xref="alg1.l12.m1.1.1.3.2.2.3.2.3">ğ‘–</ci></apply><apply id="alg1.l12.m1.1.1.3.2.2.3.3.cmml" xref="alg1.l12.m1.1.1.3.2.2.3.3"><plus id="alg1.l12.m1.1.1.3.2.2.3.3.1.cmml" xref="alg1.l12.m1.1.1.3.2.2.3.3.1"></plus><ci id="alg1.l12.m1.1.1.3.2.2.3.3.2.cmml" xref="alg1.l12.m1.1.1.3.2.2.3.3.2">ğ‘¡</ci><cn type="integer" id="alg1.l12.m1.1.1.3.2.2.3.3.3.cmml" xref="alg1.l12.m1.1.1.3.2.2.3.3.3">1</cn></apply></apply></apply><ci id="alg1.l12.m1.1.1.3.2.3.cmml" xref="alg1.l12.m1.1.1.3.2.3">ğ‘ƒ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">zs^{t+1}\leftarrow\sum_{i}^{P}\frac{zs_{i}^{t+1}}{P}</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span id="alg1.l13.1" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l13.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l14" class="ltx_listingline">return <math id="alg1.l14.m1.1" class="ltx_Math" alttext="w^{T}" display="inline"><semantics id="alg1.l14.m1.1a"><msup id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mi id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">w</mi><mi id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1">superscript</csymbol><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">ğ‘¤</ci><ci id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3">ğ‘‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">w^{T}</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">
</div>
<div id="alg1.l16" class="ltx_listingline">
<span id="alg1.l16.1" class="ltx_text ltx_font_bold ltx_font_italic">LocalTraining</span> :

</div>
<div id="alg1.l17" class="ltx_listingline">
<math id="alg1.l17.m1.1" class="ltx_Math" alttext="w_{0}^{t}=w^{t}" display="inline"><semantics id="alg1.l17.m1.1a"><mrow id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><msubsup id="alg1.l17.m1.1.1.2" xref="alg1.l17.m1.1.1.2.cmml"><mi id="alg1.l17.m1.1.1.2.2.2" xref="alg1.l17.m1.1.1.2.2.2.cmml">w</mi><mn id="alg1.l17.m1.1.1.2.2.3" xref="alg1.l17.m1.1.1.2.2.3.cmml">0</mn><mi id="alg1.l17.m1.1.1.2.3" xref="alg1.l17.m1.1.1.2.3.cmml">t</mi></msubsup><mo id="alg1.l17.m1.1.1.1" xref="alg1.l17.m1.1.1.1.cmml">=</mo><msup id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml"><mi id="alg1.l17.m1.1.1.3.2" xref="alg1.l17.m1.1.1.3.2.cmml">w</mi><mi id="alg1.l17.m1.1.1.3.3" xref="alg1.l17.m1.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><eq id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1"></eq><apply id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.2.1.cmml" xref="alg1.l17.m1.1.1.2">superscript</csymbol><apply id="alg1.l17.m1.1.1.2.2.cmml" xref="alg1.l17.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.2.2.1.cmml" xref="alg1.l17.m1.1.1.2">subscript</csymbol><ci id="alg1.l17.m1.1.1.2.2.2.cmml" xref="alg1.l17.m1.1.1.2.2.2">ğ‘¤</ci><cn type="integer" id="alg1.l17.m1.1.1.2.2.3.cmml" xref="alg1.l17.m1.1.1.2.2.3">0</cn></apply><ci id="alg1.l17.m1.1.1.2.3.cmml" xref="alg1.l17.m1.1.1.2.3">ğ‘¡</ci></apply><apply id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.3">superscript</csymbol><ci id="alg1.l17.m1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.3.2">ğ‘¤</ci><ci id="alg1.l17.m1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.3.3">ğ‘¡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">w_{0}^{t}=w^{t}</annotation></semantics></math>

</div>
<div id="alg1.l18" class="ltx_listingline">
<span id="alg1.l18.1" class="ltx_text ltx_font_bold">for</span>Â <math id="alg1.l18.m1.3" class="ltx_Math" alttext="i=0,...,E-1" display="inline"><semantics id="alg1.l18.m1.3a"><mrow id="alg1.l18.m1.3.3" xref="alg1.l18.m1.3.3.cmml"><mi id="alg1.l18.m1.3.3.3" xref="alg1.l18.m1.3.3.3.cmml">i</mi><mo id="alg1.l18.m1.3.3.2" xref="alg1.l18.m1.3.3.2.cmml">=</mo><mrow id="alg1.l18.m1.3.3.1.1" xref="alg1.l18.m1.3.3.1.2.cmml"><mn id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml">0</mn><mo id="alg1.l18.m1.3.3.1.1.2" xref="alg1.l18.m1.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l18.m1.2.2" xref="alg1.l18.m1.2.2.cmml">â€¦</mi><mo id="alg1.l18.m1.3.3.1.1.3" xref="alg1.l18.m1.3.3.1.2.cmml">,</mo><mrow id="alg1.l18.m1.3.3.1.1.1" xref="alg1.l18.m1.3.3.1.1.1.cmml"><mi id="alg1.l18.m1.3.3.1.1.1.2" xref="alg1.l18.m1.3.3.1.1.1.2.cmml">E</mi><mo id="alg1.l18.m1.3.3.1.1.1.1" xref="alg1.l18.m1.3.3.1.1.1.1.cmml">âˆ’</mo><mn id="alg1.l18.m1.3.3.1.1.1.3" xref="alg1.l18.m1.3.3.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.3b"><apply id="alg1.l18.m1.3.3.cmml" xref="alg1.l18.m1.3.3"><eq id="alg1.l18.m1.3.3.2.cmml" xref="alg1.l18.m1.3.3.2"></eq><ci id="alg1.l18.m1.3.3.3.cmml" xref="alg1.l18.m1.3.3.3">ğ‘–</ci><list id="alg1.l18.m1.3.3.1.2.cmml" xref="alg1.l18.m1.3.3.1.1"><cn type="integer" id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1">0</cn><ci id="alg1.l18.m1.2.2.cmml" xref="alg1.l18.m1.2.2">â€¦</ci><apply id="alg1.l18.m1.3.3.1.1.1.cmml" xref="alg1.l18.m1.3.3.1.1.1"><minus id="alg1.l18.m1.3.3.1.1.1.1.cmml" xref="alg1.l18.m1.3.3.1.1.1.1"></minus><ci id="alg1.l18.m1.3.3.1.1.1.2.cmml" xref="alg1.l18.m1.3.3.1.1.1.2">ğ¸</ci><cn type="integer" id="alg1.l18.m1.3.3.1.1.1.3.cmml" xref="alg1.l18.m1.3.3.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.3c">i=0,...,E-1</annotation></semantics></math>Â <span id="alg1.l18.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l19" class="ltx_listingline">Â Â Â Â Â <span id="alg1.l19.1" class="ltx_text ltx_font_bold">for</span>Â each batch b = (<math id="alg1.l19.m1.2" class="ltx_Math" alttext="x,y" display="inline"><semantics id="alg1.l19.m1.2a"><mrow id="alg1.l19.m1.2.3.2" xref="alg1.l19.m1.2.3.1.cmml"><mi id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml">x</mi><mo id="alg1.l19.m1.2.3.2.1" xref="alg1.l19.m1.2.3.1.cmml">,</mo><mi id="alg1.l19.m1.2.2" xref="alg1.l19.m1.2.2.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.2b"><list id="alg1.l19.m1.2.3.1.cmml" xref="alg1.l19.m1.2.3.2"><ci id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1">ğ‘¥</ci><ci id="alg1.l19.m1.2.2.cmml" xref="alg1.l19.m1.2.2">ğ‘¦</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.2c">x,y</annotation></semantics></math>) of <math id="alg1.l19.m2.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="alg1.l19.m2.1a"><msub id="alg1.l19.m2.1.1" xref="alg1.l19.m2.1.1.cmml"><mi id="alg1.l19.m2.1.1.2" xref="alg1.l19.m2.1.1.2.cmml">N</mi><mi id="alg1.l19.m2.1.1.3" xref="alg1.l19.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l19.m2.1b"><apply id="alg1.l19.m2.1.1.cmml" xref="alg1.l19.m2.1.1"><csymbol cd="ambiguous" id="alg1.l19.m2.1.1.1.cmml" xref="alg1.l19.m2.1.1">subscript</csymbol><ci id="alg1.l19.m2.1.1.2.cmml" xref="alg1.l19.m2.1.1.2">ğ‘</ci><ci id="alg1.l19.m2.1.1.3.cmml" xref="alg1.l19.m2.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m2.1c">N_{i}</annotation></semantics></math>Â <span id="alg1.l19.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l20" class="ltx_listingline">Â Â Â Â Â Â Â Â Â <math id="alg1.l20.m1.3" class="ltx_Math" alttext="l_{class}\leftarrow CrossEntropyLoss(F_{w_{i}^{t}}(x),y)" display="inline"><semantics id="alg1.l20.m1.3a"><mrow id="alg1.l20.m1.3.3" xref="alg1.l20.m1.3.3.cmml"><msub id="alg1.l20.m1.3.3.3" xref="alg1.l20.m1.3.3.3.cmml"><mi id="alg1.l20.m1.3.3.3.2" xref="alg1.l20.m1.3.3.3.2.cmml">l</mi><mrow id="alg1.l20.m1.3.3.3.3" xref="alg1.l20.m1.3.3.3.3.cmml"><mi id="alg1.l20.m1.3.3.3.3.2" xref="alg1.l20.m1.3.3.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.3.3.1" xref="alg1.l20.m1.3.3.3.3.1.cmml">â€‹</mo><mi id="alg1.l20.m1.3.3.3.3.3" xref="alg1.l20.m1.3.3.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.3.3.1a" xref="alg1.l20.m1.3.3.3.3.1.cmml">â€‹</mo><mi id="alg1.l20.m1.3.3.3.3.4" xref="alg1.l20.m1.3.3.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.3.3.1b" xref="alg1.l20.m1.3.3.3.3.1.cmml">â€‹</mo><mi id="alg1.l20.m1.3.3.3.3.5" xref="alg1.l20.m1.3.3.3.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.3.3.1c" xref="alg1.l20.m1.3.3.3.3.1.cmml">â€‹</mo><mi id="alg1.l20.m1.3.3.3.3.6" xref="alg1.l20.m1.3.3.3.3.6.cmml">s</mi></mrow></msub><mo stretchy="false" id="alg1.l20.m1.3.3.2" xref="alg1.l20.m1.3.3.2.cmml">â†</mo><mrow id="alg1.l20.m1.3.3.1" xref="alg1.l20.m1.3.3.1.cmml"><mi id="alg1.l20.m1.3.3.1.3" xref="alg1.l20.m1.3.3.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.1.2" xref="alg1.l20.m1.3.3.1.2.cmml">â€‹</mo><mi id="alg1.l20.m1.3.3.1.4" xref="alg1.l20.m1.3.3.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.1.2a" xref="alg1.l20.m1.3.3.1.2.cmml">â€‹</mo><mi id="alg1.l20.m1.3.3.1.5" xref="alg1.l20.m1.3.3.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.1.2b" xref="alg1.l20.m1.3.3.1.2.cmml">â€‹</mo><mi id="alg1.l20.m1.3.3.1.6" xref="alg1.l20.m1.3.3.1.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.1.2c" xref="alg1.l20.m1.3.3.1.2.cmml">â€‹</mo><mi id="alg1.l20.m1.3.3.1.7" xref="alg1.l20.m1.3.3.1.7.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.1.2d" xref="alg1.l20.m1.3.3.1.2.cmml">â€‹</mo><mi id="alg1.l20.m1.3.3.1.8" xref="alg1.l20.m1.3.3.1.8.cmml">E</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.1.2e" xref="alg1.l20.m1.3.3.1.2.cmml">â€‹</mo><mi id="alg1.l20.m1.3.3.1.9" xref="alg1.l20.m1.3.3.1.9.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.1.2f" xref="alg1.l20.m1.3.3.1.2.cmml">â€‹</mo><mi id="alg1.l20.m1.3.3.1.10" xref="alg1.l20.m1.3.3.1.10.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.1.2g" xref="alg1.l20.m1.3.3.1.2.cmml">â€‹</mo><mi id="alg1.l20.m1.3.3.1.11" xref="alg1.l20.m1.3.3.1.11.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.1.2h" xref="alg1.l20.m1.3.3.1.2.cmml">â€‹</mo><mi id="alg1.l20.m1.3.3.1.12" xref="alg1.l20.m1.3.3.1.12.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.1.2i" xref="alg1.l20.m1.3.3.1.2.cmml">â€‹</mo><mi id="alg1.l20.m1.3.3.1.13" xref="alg1.l20.m1.3.3.1.13.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.1.2j" xref="alg1.l20.m1.3.3.1.2.cmml">â€‹</mo><mi id="alg1.l20.m1.3.3.1.14" xref="alg1.l20.m1.3.3.1.14.cmml">y</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.1.2k" xref="alg1.l20.m1.3.3.1.2.cmml">â€‹</mo><mi id="alg1.l20.m1.3.3.1.15" xref="alg1.l20.m1.3.3.1.15.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.1.2l" xref="alg1.l20.m1.3.3.1.2.cmml">â€‹</mo><mi id="alg1.l20.m1.3.3.1.16" xref="alg1.l20.m1.3.3.1.16.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.1.2m" xref="alg1.l20.m1.3.3.1.2.cmml">â€‹</mo><mi id="alg1.l20.m1.3.3.1.17" xref="alg1.l20.m1.3.3.1.17.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.1.2n" xref="alg1.l20.m1.3.3.1.2.cmml">â€‹</mo><mi id="alg1.l20.m1.3.3.1.18" xref="alg1.l20.m1.3.3.1.18.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.1.2o" xref="alg1.l20.m1.3.3.1.2.cmml">â€‹</mo><mrow id="alg1.l20.m1.3.3.1.1.1" xref="alg1.l20.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="alg1.l20.m1.3.3.1.1.1.2" xref="alg1.l20.m1.3.3.1.1.2.cmml">(</mo><mrow id="alg1.l20.m1.3.3.1.1.1.1" xref="alg1.l20.m1.3.3.1.1.1.1.cmml"><msub id="alg1.l20.m1.3.3.1.1.1.1.2" xref="alg1.l20.m1.3.3.1.1.1.1.2.cmml"><mi id="alg1.l20.m1.3.3.1.1.1.1.2.2" xref="alg1.l20.m1.3.3.1.1.1.1.2.2.cmml">F</mi><msubsup id="alg1.l20.m1.3.3.1.1.1.1.2.3" xref="alg1.l20.m1.3.3.1.1.1.1.2.3.cmml"><mi id="alg1.l20.m1.3.3.1.1.1.1.2.3.2.2" xref="alg1.l20.m1.3.3.1.1.1.1.2.3.2.2.cmml">w</mi><mi id="alg1.l20.m1.3.3.1.1.1.1.2.3.2.3" xref="alg1.l20.m1.3.3.1.1.1.1.2.3.2.3.cmml">i</mi><mi id="alg1.l20.m1.3.3.1.1.1.1.2.3.3" xref="alg1.l20.m1.3.3.1.1.1.1.2.3.3.cmml">t</mi></msubsup></msub><mo lspace="0em" rspace="0em" id="alg1.l20.m1.3.3.1.1.1.1.1" xref="alg1.l20.m1.3.3.1.1.1.1.1.cmml">â€‹</mo><mrow id="alg1.l20.m1.3.3.1.1.1.1.3.2" xref="alg1.l20.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l20.m1.3.3.1.1.1.1.3.2.1" xref="alg1.l20.m1.3.3.1.1.1.1.cmml">(</mo><mi id="alg1.l20.m1.1.1" xref="alg1.l20.m1.1.1.cmml">x</mi><mo stretchy="false" id="alg1.l20.m1.3.3.1.1.1.1.3.2.2" xref="alg1.l20.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l20.m1.3.3.1.1.1.3" xref="alg1.l20.m1.3.3.1.1.2.cmml">,</mo><mi id="alg1.l20.m1.2.2" xref="alg1.l20.m1.2.2.cmml">y</mi><mo stretchy="false" id="alg1.l20.m1.3.3.1.1.1.4" xref="alg1.l20.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.3b"><apply id="alg1.l20.m1.3.3.cmml" xref="alg1.l20.m1.3.3"><ci id="alg1.l20.m1.3.3.2.cmml" xref="alg1.l20.m1.3.3.2">â†</ci><apply id="alg1.l20.m1.3.3.3.cmml" xref="alg1.l20.m1.3.3.3"><csymbol cd="ambiguous" id="alg1.l20.m1.3.3.3.1.cmml" xref="alg1.l20.m1.3.3.3">subscript</csymbol><ci id="alg1.l20.m1.3.3.3.2.cmml" xref="alg1.l20.m1.3.3.3.2">ğ‘™</ci><apply id="alg1.l20.m1.3.3.3.3.cmml" xref="alg1.l20.m1.3.3.3.3"><times id="alg1.l20.m1.3.3.3.3.1.cmml" xref="alg1.l20.m1.3.3.3.3.1"></times><ci id="alg1.l20.m1.3.3.3.3.2.cmml" xref="alg1.l20.m1.3.3.3.3.2">ğ‘</ci><ci id="alg1.l20.m1.3.3.3.3.3.cmml" xref="alg1.l20.m1.3.3.3.3.3">ğ‘™</ci><ci id="alg1.l20.m1.3.3.3.3.4.cmml" xref="alg1.l20.m1.3.3.3.3.4">ğ‘</ci><ci id="alg1.l20.m1.3.3.3.3.5.cmml" xref="alg1.l20.m1.3.3.3.3.5">ğ‘ </ci><ci id="alg1.l20.m1.3.3.3.3.6.cmml" xref="alg1.l20.m1.3.3.3.3.6">ğ‘ </ci></apply></apply><apply id="alg1.l20.m1.3.3.1.cmml" xref="alg1.l20.m1.3.3.1"><times id="alg1.l20.m1.3.3.1.2.cmml" xref="alg1.l20.m1.3.3.1.2"></times><ci id="alg1.l20.m1.3.3.1.3.cmml" xref="alg1.l20.m1.3.3.1.3">ğ¶</ci><ci id="alg1.l20.m1.3.3.1.4.cmml" xref="alg1.l20.m1.3.3.1.4">ğ‘Ÿ</ci><ci id="alg1.l20.m1.3.3.1.5.cmml" xref="alg1.l20.m1.3.3.1.5">ğ‘œ</ci><ci id="alg1.l20.m1.3.3.1.6.cmml" xref="alg1.l20.m1.3.3.1.6">ğ‘ </ci><ci id="alg1.l20.m1.3.3.1.7.cmml" xref="alg1.l20.m1.3.3.1.7">ğ‘ </ci><ci id="alg1.l20.m1.3.3.1.8.cmml" xref="alg1.l20.m1.3.3.1.8">ğ¸</ci><ci id="alg1.l20.m1.3.3.1.9.cmml" xref="alg1.l20.m1.3.3.1.9">ğ‘›</ci><ci id="alg1.l20.m1.3.3.1.10.cmml" xref="alg1.l20.m1.3.3.1.10">ğ‘¡</ci><ci id="alg1.l20.m1.3.3.1.11.cmml" xref="alg1.l20.m1.3.3.1.11">ğ‘Ÿ</ci><ci id="alg1.l20.m1.3.3.1.12.cmml" xref="alg1.l20.m1.3.3.1.12">ğ‘œ</ci><ci id="alg1.l20.m1.3.3.1.13.cmml" xref="alg1.l20.m1.3.3.1.13">ğ‘</ci><ci id="alg1.l20.m1.3.3.1.14.cmml" xref="alg1.l20.m1.3.3.1.14">ğ‘¦</ci><ci id="alg1.l20.m1.3.3.1.15.cmml" xref="alg1.l20.m1.3.3.1.15">ğ¿</ci><ci id="alg1.l20.m1.3.3.1.16.cmml" xref="alg1.l20.m1.3.3.1.16">ğ‘œ</ci><ci id="alg1.l20.m1.3.3.1.17.cmml" xref="alg1.l20.m1.3.3.1.17">ğ‘ </ci><ci id="alg1.l20.m1.3.3.1.18.cmml" xref="alg1.l20.m1.3.3.1.18">ğ‘ </ci><interval closure="open" id="alg1.l20.m1.3.3.1.1.2.cmml" xref="alg1.l20.m1.3.3.1.1.1"><apply id="alg1.l20.m1.3.3.1.1.1.1.cmml" xref="alg1.l20.m1.3.3.1.1.1.1"><times id="alg1.l20.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.1"></times><apply id="alg1.l20.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l20.m1.3.3.1.1.1.1.2.1.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="alg1.l20.m1.3.3.1.1.1.1.2.2.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.2.2">ğ¹</ci><apply id="alg1.l20.m1.3.3.1.1.1.1.2.3.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l20.m1.3.3.1.1.1.1.2.3.1.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.2.3">superscript</csymbol><apply id="alg1.l20.m1.3.3.1.1.1.1.2.3.2.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l20.m1.3.3.1.1.1.1.2.3.2.1.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.2.3">subscript</csymbol><ci id="alg1.l20.m1.3.3.1.1.1.1.2.3.2.2.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.2.3.2.2">ğ‘¤</ci><ci id="alg1.l20.m1.3.3.1.1.1.1.2.3.2.3.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.2.3.2.3">ğ‘–</ci></apply><ci id="alg1.l20.m1.3.3.1.1.1.1.2.3.3.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.2.3.3">ğ‘¡</ci></apply></apply><ci id="alg1.l20.m1.1.1.cmml" xref="alg1.l20.m1.1.1">ğ‘¥</ci></apply><ci id="alg1.l20.m1.2.2.cmml" xref="alg1.l20.m1.2.2">ğ‘¦</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.3c">l_{class}\leftarrow CrossEntropyLoss(F_{w_{i}^{t}}(x),y)</annotation></semantics></math>

</div>
<div id="alg1.l21" class="ltx_listingline">Â Â Â Â Â Â Â Â Â <math id="alg1.l21.m1.2" class="ltx_Math" alttext="z\leftarrow Proj(Enc(w_{i}^{t};x))" display="inline"><semantics id="alg1.l21.m1.2a"><mrow id="alg1.l21.m1.2.2" xref="alg1.l21.m1.2.2.cmml"><mi id="alg1.l21.m1.2.2.3" xref="alg1.l21.m1.2.2.3.cmml">z</mi><mo stretchy="false" id="alg1.l21.m1.2.2.2" xref="alg1.l21.m1.2.2.2.cmml">â†</mo><mrow id="alg1.l21.m1.2.2.1" xref="alg1.l21.m1.2.2.1.cmml"><mi id="alg1.l21.m1.2.2.1.3" xref="alg1.l21.m1.2.2.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l21.m1.2.2.1.2" xref="alg1.l21.m1.2.2.1.2.cmml">â€‹</mo><mi id="alg1.l21.m1.2.2.1.4" xref="alg1.l21.m1.2.2.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l21.m1.2.2.1.2a" xref="alg1.l21.m1.2.2.1.2.cmml">â€‹</mo><mi id="alg1.l21.m1.2.2.1.5" xref="alg1.l21.m1.2.2.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l21.m1.2.2.1.2b" xref="alg1.l21.m1.2.2.1.2.cmml">â€‹</mo><mi id="alg1.l21.m1.2.2.1.6" xref="alg1.l21.m1.2.2.1.6.cmml">j</mi><mo lspace="0em" rspace="0em" id="alg1.l21.m1.2.2.1.2c" xref="alg1.l21.m1.2.2.1.2.cmml">â€‹</mo><mrow id="alg1.l21.m1.2.2.1.1.1" xref="alg1.l21.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l21.m1.2.2.1.1.1.2" xref="alg1.l21.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="alg1.l21.m1.2.2.1.1.1.1" xref="alg1.l21.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l21.m1.2.2.1.1.1.1.3" xref="alg1.l21.m1.2.2.1.1.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="alg1.l21.m1.2.2.1.1.1.1.2" xref="alg1.l21.m1.2.2.1.1.1.1.2.cmml">â€‹</mo><mi id="alg1.l21.m1.2.2.1.1.1.1.4" xref="alg1.l21.m1.2.2.1.1.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l21.m1.2.2.1.1.1.1.2a" xref="alg1.l21.m1.2.2.1.1.1.1.2.cmml">â€‹</mo><mi id="alg1.l21.m1.2.2.1.1.1.1.5" xref="alg1.l21.m1.2.2.1.1.1.1.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l21.m1.2.2.1.1.1.1.2b" xref="alg1.l21.m1.2.2.1.1.1.1.2.cmml">â€‹</mo><mrow id="alg1.l21.m1.2.2.1.1.1.1.1.1" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l21.m1.2.2.1.1.1.1.1.1.2" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.cmml">(</mo><msubsup id="alg1.l21.m1.2.2.1.1.1.1.1.1.1" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.2.2" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.2.3" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.3" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="alg1.l21.m1.2.2.1.1.1.1.1.1.3" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.cmml">;</mo><mi id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml">x</mi><mo stretchy="false" id="alg1.l21.m1.2.2.1.1.1.1.1.1.4" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l21.m1.2.2.1.1.1.3" xref="alg1.l21.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.2b"><apply id="alg1.l21.m1.2.2.cmml" xref="alg1.l21.m1.2.2"><ci id="alg1.l21.m1.2.2.2.cmml" xref="alg1.l21.m1.2.2.2">â†</ci><ci id="alg1.l21.m1.2.2.3.cmml" xref="alg1.l21.m1.2.2.3">ğ‘§</ci><apply id="alg1.l21.m1.2.2.1.cmml" xref="alg1.l21.m1.2.2.1"><times id="alg1.l21.m1.2.2.1.2.cmml" xref="alg1.l21.m1.2.2.1.2"></times><ci id="alg1.l21.m1.2.2.1.3.cmml" xref="alg1.l21.m1.2.2.1.3">ğ‘ƒ</ci><ci id="alg1.l21.m1.2.2.1.4.cmml" xref="alg1.l21.m1.2.2.1.4">ğ‘Ÿ</ci><ci id="alg1.l21.m1.2.2.1.5.cmml" xref="alg1.l21.m1.2.2.1.5">ğ‘œ</ci><ci id="alg1.l21.m1.2.2.1.6.cmml" xref="alg1.l21.m1.2.2.1.6">ğ‘—</ci><apply id="alg1.l21.m1.2.2.1.1.1.1.cmml" xref="alg1.l21.m1.2.2.1.1.1"><times id="alg1.l21.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.2"></times><ci id="alg1.l21.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.3">ğ¸</ci><ci id="alg1.l21.m1.2.2.1.1.1.1.4.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.4">ğ‘›</ci><ci id="alg1.l21.m1.2.2.1.1.1.1.5.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.5">ğ‘</ci><list id="alg1.l21.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.1"><apply id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1.2.2">ğ‘¤</ci><ci id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1.2.3">ğ‘–</ci></apply><ci id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1.3">ğ‘¡</ci></apply><ci id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1">ğ‘¥</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.2c">z\leftarrow Proj(Enc(w_{i}^{t};x))</annotation></semantics></math>

</div>
<div id="alg1.l22" class="ltx_listingline">Â Â Â Â Â Â Â Â Â <math id="alg1.l22.m1.2" class="ltx_Math" alttext="z_{glob}\leftarrow Proj(Enc(w^{t};x))" display="inline"><semantics id="alg1.l22.m1.2a"><mrow id="alg1.l22.m1.2.2" xref="alg1.l22.m1.2.2.cmml"><msub id="alg1.l22.m1.2.2.3" xref="alg1.l22.m1.2.2.3.cmml"><mi id="alg1.l22.m1.2.2.3.2" xref="alg1.l22.m1.2.2.3.2.cmml">z</mi><mrow id="alg1.l22.m1.2.2.3.3" xref="alg1.l22.m1.2.2.3.3.cmml"><mi id="alg1.l22.m1.2.2.3.3.2" xref="alg1.l22.m1.2.2.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m1.2.2.3.3.1" xref="alg1.l22.m1.2.2.3.3.1.cmml">â€‹</mo><mi id="alg1.l22.m1.2.2.3.3.3" xref="alg1.l22.m1.2.2.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m1.2.2.3.3.1a" xref="alg1.l22.m1.2.2.3.3.1.cmml">â€‹</mo><mi id="alg1.l22.m1.2.2.3.3.4" xref="alg1.l22.m1.2.2.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m1.2.2.3.3.1b" xref="alg1.l22.m1.2.2.3.3.1.cmml">â€‹</mo><mi id="alg1.l22.m1.2.2.3.3.5" xref="alg1.l22.m1.2.2.3.3.5.cmml">b</mi></mrow></msub><mo stretchy="false" id="alg1.l22.m1.2.2.2" xref="alg1.l22.m1.2.2.2.cmml">â†</mo><mrow id="alg1.l22.m1.2.2.1" xref="alg1.l22.m1.2.2.1.cmml"><mi id="alg1.l22.m1.2.2.1.3" xref="alg1.l22.m1.2.2.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m1.2.2.1.2" xref="alg1.l22.m1.2.2.1.2.cmml">â€‹</mo><mi id="alg1.l22.m1.2.2.1.4" xref="alg1.l22.m1.2.2.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m1.2.2.1.2a" xref="alg1.l22.m1.2.2.1.2.cmml">â€‹</mo><mi id="alg1.l22.m1.2.2.1.5" xref="alg1.l22.m1.2.2.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m1.2.2.1.2b" xref="alg1.l22.m1.2.2.1.2.cmml">â€‹</mo><mi id="alg1.l22.m1.2.2.1.6" xref="alg1.l22.m1.2.2.1.6.cmml">j</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m1.2.2.1.2c" xref="alg1.l22.m1.2.2.1.2.cmml">â€‹</mo><mrow id="alg1.l22.m1.2.2.1.1.1" xref="alg1.l22.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l22.m1.2.2.1.1.1.2" xref="alg1.l22.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="alg1.l22.m1.2.2.1.1.1.1" xref="alg1.l22.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l22.m1.2.2.1.1.1.1.3" xref="alg1.l22.m1.2.2.1.1.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m1.2.2.1.1.1.1.2" xref="alg1.l22.m1.2.2.1.1.1.1.2.cmml">â€‹</mo><mi id="alg1.l22.m1.2.2.1.1.1.1.4" xref="alg1.l22.m1.2.2.1.1.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m1.2.2.1.1.1.1.2a" xref="alg1.l22.m1.2.2.1.1.1.1.2.cmml">â€‹</mo><mi id="alg1.l22.m1.2.2.1.1.1.1.5" xref="alg1.l22.m1.2.2.1.1.1.1.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m1.2.2.1.1.1.1.2b" xref="alg1.l22.m1.2.2.1.1.1.1.2.cmml">â€‹</mo><mrow id="alg1.l22.m1.2.2.1.1.1.1.1.1" xref="alg1.l22.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l22.m1.2.2.1.1.1.1.1.1.2" xref="alg1.l22.m1.2.2.1.1.1.1.1.2.cmml">(</mo><msup id="alg1.l22.m1.2.2.1.1.1.1.1.1.1" xref="alg1.l22.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="alg1.l22.m1.2.2.1.1.1.1.1.1.1.2" xref="alg1.l22.m1.2.2.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="alg1.l22.m1.2.2.1.1.1.1.1.1.1.3" xref="alg1.l22.m1.2.2.1.1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="alg1.l22.m1.2.2.1.1.1.1.1.1.3" xref="alg1.l22.m1.2.2.1.1.1.1.1.2.cmml">;</mo><mi id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1.cmml">x</mi><mo stretchy="false" id="alg1.l22.m1.2.2.1.1.1.1.1.1.4" xref="alg1.l22.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l22.m1.2.2.1.1.1.3" xref="alg1.l22.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.2b"><apply id="alg1.l22.m1.2.2.cmml" xref="alg1.l22.m1.2.2"><ci id="alg1.l22.m1.2.2.2.cmml" xref="alg1.l22.m1.2.2.2">â†</ci><apply id="alg1.l22.m1.2.2.3.cmml" xref="alg1.l22.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l22.m1.2.2.3.1.cmml" xref="alg1.l22.m1.2.2.3">subscript</csymbol><ci id="alg1.l22.m1.2.2.3.2.cmml" xref="alg1.l22.m1.2.2.3.2">ğ‘§</ci><apply id="alg1.l22.m1.2.2.3.3.cmml" xref="alg1.l22.m1.2.2.3.3"><times id="alg1.l22.m1.2.2.3.3.1.cmml" xref="alg1.l22.m1.2.2.3.3.1"></times><ci id="alg1.l22.m1.2.2.3.3.2.cmml" xref="alg1.l22.m1.2.2.3.3.2">ğ‘”</ci><ci id="alg1.l22.m1.2.2.3.3.3.cmml" xref="alg1.l22.m1.2.2.3.3.3">ğ‘™</ci><ci id="alg1.l22.m1.2.2.3.3.4.cmml" xref="alg1.l22.m1.2.2.3.3.4">ğ‘œ</ci><ci id="alg1.l22.m1.2.2.3.3.5.cmml" xref="alg1.l22.m1.2.2.3.3.5">ğ‘</ci></apply></apply><apply id="alg1.l22.m1.2.2.1.cmml" xref="alg1.l22.m1.2.2.1"><times id="alg1.l22.m1.2.2.1.2.cmml" xref="alg1.l22.m1.2.2.1.2"></times><ci id="alg1.l22.m1.2.2.1.3.cmml" xref="alg1.l22.m1.2.2.1.3">ğ‘ƒ</ci><ci id="alg1.l22.m1.2.2.1.4.cmml" xref="alg1.l22.m1.2.2.1.4">ğ‘Ÿ</ci><ci id="alg1.l22.m1.2.2.1.5.cmml" xref="alg1.l22.m1.2.2.1.5">ğ‘œ</ci><ci id="alg1.l22.m1.2.2.1.6.cmml" xref="alg1.l22.m1.2.2.1.6">ğ‘—</ci><apply id="alg1.l22.m1.2.2.1.1.1.1.cmml" xref="alg1.l22.m1.2.2.1.1.1"><times id="alg1.l22.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l22.m1.2.2.1.1.1.1.2"></times><ci id="alg1.l22.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l22.m1.2.2.1.1.1.1.3">ğ¸</ci><ci id="alg1.l22.m1.2.2.1.1.1.1.4.cmml" xref="alg1.l22.m1.2.2.1.1.1.1.4">ğ‘›</ci><ci id="alg1.l22.m1.2.2.1.1.1.1.5.cmml" xref="alg1.l22.m1.2.2.1.1.1.1.5">ğ‘</ci><list id="alg1.l22.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.l22.m1.2.2.1.1.1.1.1.1"><apply id="alg1.l22.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l22.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l22.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l22.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l22.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg1.l22.m1.2.2.1.1.1.1.1.1.1.2">ğ‘¤</ci><ci id="alg1.l22.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg1.l22.m1.2.2.1.1.1.1.1.1.1.3">ğ‘¡</ci></apply><ci id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1">ğ‘¥</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.2c">z_{glob}\leftarrow Proj(Enc(w^{t};x))</annotation></semantics></math>

</div>
<div id="alg1.l23" class="ltx_listingline">Â Â Â Â Â Â Â Â Â <math id="alg1.l23.m1.2" class="ltx_Math" alttext="z_{prev}\leftarrow Proj(Enc(w_{i}^{t-1};x))" display="inline"><semantics id="alg1.l23.m1.2a"><mrow id="alg1.l23.m1.2.2" xref="alg1.l23.m1.2.2.cmml"><msub id="alg1.l23.m1.2.2.3" xref="alg1.l23.m1.2.2.3.cmml"><mi id="alg1.l23.m1.2.2.3.2" xref="alg1.l23.m1.2.2.3.2.cmml">z</mi><mrow id="alg1.l23.m1.2.2.3.3" xref="alg1.l23.m1.2.2.3.3.cmml"><mi id="alg1.l23.m1.2.2.3.3.2" xref="alg1.l23.m1.2.2.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.2.2.3.3.1" xref="alg1.l23.m1.2.2.3.3.1.cmml">â€‹</mo><mi id="alg1.l23.m1.2.2.3.3.3" xref="alg1.l23.m1.2.2.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.2.2.3.3.1a" xref="alg1.l23.m1.2.2.3.3.1.cmml">â€‹</mo><mi id="alg1.l23.m1.2.2.3.3.4" xref="alg1.l23.m1.2.2.3.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.2.2.3.3.1b" xref="alg1.l23.m1.2.2.3.3.1.cmml">â€‹</mo><mi id="alg1.l23.m1.2.2.3.3.5" xref="alg1.l23.m1.2.2.3.3.5.cmml">v</mi></mrow></msub><mo stretchy="false" id="alg1.l23.m1.2.2.2" xref="alg1.l23.m1.2.2.2.cmml">â†</mo><mrow id="alg1.l23.m1.2.2.1" xref="alg1.l23.m1.2.2.1.cmml"><mi id="alg1.l23.m1.2.2.1.3" xref="alg1.l23.m1.2.2.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.2.2.1.2" xref="alg1.l23.m1.2.2.1.2.cmml">â€‹</mo><mi id="alg1.l23.m1.2.2.1.4" xref="alg1.l23.m1.2.2.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.2.2.1.2a" xref="alg1.l23.m1.2.2.1.2.cmml">â€‹</mo><mi id="alg1.l23.m1.2.2.1.5" xref="alg1.l23.m1.2.2.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.2.2.1.2b" xref="alg1.l23.m1.2.2.1.2.cmml">â€‹</mo><mi id="alg1.l23.m1.2.2.1.6" xref="alg1.l23.m1.2.2.1.6.cmml">j</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.2.2.1.2c" xref="alg1.l23.m1.2.2.1.2.cmml">â€‹</mo><mrow id="alg1.l23.m1.2.2.1.1.1" xref="alg1.l23.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l23.m1.2.2.1.1.1.2" xref="alg1.l23.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="alg1.l23.m1.2.2.1.1.1.1" xref="alg1.l23.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l23.m1.2.2.1.1.1.1.3" xref="alg1.l23.m1.2.2.1.1.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.2.2.1.1.1.1.2" xref="alg1.l23.m1.2.2.1.1.1.1.2.cmml">â€‹</mo><mi id="alg1.l23.m1.2.2.1.1.1.1.4" xref="alg1.l23.m1.2.2.1.1.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.2.2.1.1.1.1.2a" xref="alg1.l23.m1.2.2.1.1.1.1.2.cmml">â€‹</mo><mi id="alg1.l23.m1.2.2.1.1.1.1.5" xref="alg1.l23.m1.2.2.1.1.1.1.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.2.2.1.1.1.1.2b" xref="alg1.l23.m1.2.2.1.1.1.1.2.cmml">â€‹</mo><mrow id="alg1.l23.m1.2.2.1.1.1.1.1.1" xref="alg1.l23.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l23.m1.2.2.1.1.1.1.1.1.2" xref="alg1.l23.m1.2.2.1.1.1.1.1.2.cmml">(</mo><msubsup id="alg1.l23.m1.2.2.1.1.1.1.1.1.1" xref="alg1.l23.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="alg1.l23.m1.2.2.1.1.1.1.1.1.1.2.2" xref="alg1.l23.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l23.m1.2.2.1.1.1.1.1.1.1.2.3" xref="alg1.l23.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="alg1.l23.m1.2.2.1.1.1.1.1.1.1.3" xref="alg1.l23.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l23.m1.2.2.1.1.1.1.1.1.1.3.2" xref="alg1.l23.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l23.m1.2.2.1.1.1.1.1.1.1.3.1" xref="alg1.l23.m1.2.2.1.1.1.1.1.1.1.3.1.cmml">âˆ’</mo><mn id="alg1.l23.m1.2.2.1.1.1.1.1.1.1.3.3" xref="alg1.l23.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.l23.m1.2.2.1.1.1.1.1.1.3" xref="alg1.l23.m1.2.2.1.1.1.1.1.2.cmml">;</mo><mi id="alg1.l23.m1.1.1" xref="alg1.l23.m1.1.1.cmml">x</mi><mo stretchy="false" id="alg1.l23.m1.2.2.1.1.1.1.1.1.4" xref="alg1.l23.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l23.m1.2.2.1.1.1.3" xref="alg1.l23.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.2b"><apply id="alg1.l23.m1.2.2.cmml" xref="alg1.l23.m1.2.2"><ci id="alg1.l23.m1.2.2.2.cmml" xref="alg1.l23.m1.2.2.2">â†</ci><apply id="alg1.l23.m1.2.2.3.cmml" xref="alg1.l23.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l23.m1.2.2.3.1.cmml" xref="alg1.l23.m1.2.2.3">subscript</csymbol><ci id="alg1.l23.m1.2.2.3.2.cmml" xref="alg1.l23.m1.2.2.3.2">ğ‘§</ci><apply id="alg1.l23.m1.2.2.3.3.cmml" xref="alg1.l23.m1.2.2.3.3"><times id="alg1.l23.m1.2.2.3.3.1.cmml" xref="alg1.l23.m1.2.2.3.3.1"></times><ci id="alg1.l23.m1.2.2.3.3.2.cmml" xref="alg1.l23.m1.2.2.3.3.2">ğ‘</ci><ci id="alg1.l23.m1.2.2.3.3.3.cmml" xref="alg1.l23.m1.2.2.3.3.3">ğ‘Ÿ</ci><ci id="alg1.l23.m1.2.2.3.3.4.cmml" xref="alg1.l23.m1.2.2.3.3.4">ğ‘’</ci><ci id="alg1.l23.m1.2.2.3.3.5.cmml" xref="alg1.l23.m1.2.2.3.3.5">ğ‘£</ci></apply></apply><apply id="alg1.l23.m1.2.2.1.cmml" xref="alg1.l23.m1.2.2.1"><times id="alg1.l23.m1.2.2.1.2.cmml" xref="alg1.l23.m1.2.2.1.2"></times><ci id="alg1.l23.m1.2.2.1.3.cmml" xref="alg1.l23.m1.2.2.1.3">ğ‘ƒ</ci><ci id="alg1.l23.m1.2.2.1.4.cmml" xref="alg1.l23.m1.2.2.1.4">ğ‘Ÿ</ci><ci id="alg1.l23.m1.2.2.1.5.cmml" xref="alg1.l23.m1.2.2.1.5">ğ‘œ</ci><ci id="alg1.l23.m1.2.2.1.6.cmml" xref="alg1.l23.m1.2.2.1.6">ğ‘—</ci><apply id="alg1.l23.m1.2.2.1.1.1.1.cmml" xref="alg1.l23.m1.2.2.1.1.1"><times id="alg1.l23.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l23.m1.2.2.1.1.1.1.2"></times><ci id="alg1.l23.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l23.m1.2.2.1.1.1.1.3">ğ¸</ci><ci id="alg1.l23.m1.2.2.1.1.1.1.4.cmml" xref="alg1.l23.m1.2.2.1.1.1.1.4">ğ‘›</ci><ci id="alg1.l23.m1.2.2.1.1.1.1.5.cmml" xref="alg1.l23.m1.2.2.1.1.1.1.5">ğ‘</ci><list id="alg1.l23.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.l23.m1.2.2.1.1.1.1.1.1"><apply id="alg1.l23.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l23.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l23.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l23.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l23.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg1.l23.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l23.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l23.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l23.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l23.m1.2.2.1.1.1.1.1.1.1.2.2">ğ‘¤</ci><ci id="alg1.l23.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l23.m1.2.2.1.1.1.1.1.1.1.2.3">ğ‘–</ci></apply><apply id="alg1.l23.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg1.l23.m1.2.2.1.1.1.1.1.1.1.3"><minus id="alg1.l23.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l23.m1.2.2.1.1.1.1.1.1.1.3.1"></minus><ci id="alg1.l23.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l23.m1.2.2.1.1.1.1.1.1.1.3.2">ğ‘¡</ci><cn type="integer" id="alg1.l23.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l23.m1.2.2.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l23.m1.1.1.cmml" xref="alg1.l23.m1.1.1">ğ‘¥</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.2c">z_{prev}\leftarrow Proj(Enc(w_{i}^{t-1};x))</annotation></semantics></math>

</div>
<div id="alg1.l24" class="ltx_listingline">Â Â Â Â Â Â Â Â Â <math id="alg1.l24.m1.5" class="ltx_Math" alttext="l\leftarrow l_{class}+\mu_{moon}*l_{moon}(z,z_{glob},z_{prev})+\mu_{glob}*l_{glob}(z,zs^{t})" display="inline"><semantics id="alg1.l24.m1.5a"><mrow id="alg1.l24.m1.5.5" xref="alg1.l24.m1.5.5.cmml"><mi id="alg1.l24.m1.5.5.5" xref="alg1.l24.m1.5.5.5.cmml">l</mi><mo stretchy="false" id="alg1.l24.m1.5.5.4" xref="alg1.l24.m1.5.5.4.cmml">â†</mo><mrow id="alg1.l24.m1.5.5.3" xref="alg1.l24.m1.5.5.3.cmml"><msub id="alg1.l24.m1.5.5.3.5" xref="alg1.l24.m1.5.5.3.5.cmml"><mi id="alg1.l24.m1.5.5.3.5.2" xref="alg1.l24.m1.5.5.3.5.2.cmml">l</mi><mrow id="alg1.l24.m1.5.5.3.5.3" xref="alg1.l24.m1.5.5.3.5.3.cmml"><mi id="alg1.l24.m1.5.5.3.5.3.2" xref="alg1.l24.m1.5.5.3.5.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.5.5.3.5.3.1" xref="alg1.l24.m1.5.5.3.5.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.5.5.3.5.3.3" xref="alg1.l24.m1.5.5.3.5.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.5.5.3.5.3.1a" xref="alg1.l24.m1.5.5.3.5.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.5.5.3.5.3.4" xref="alg1.l24.m1.5.5.3.5.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.5.5.3.5.3.1b" xref="alg1.l24.m1.5.5.3.5.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.5.5.3.5.3.5" xref="alg1.l24.m1.5.5.3.5.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.5.5.3.5.3.1c" xref="alg1.l24.m1.5.5.3.5.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.5.5.3.5.3.6" xref="alg1.l24.m1.5.5.3.5.3.6.cmml">s</mi></mrow></msub><mo id="alg1.l24.m1.5.5.3.4" xref="alg1.l24.m1.5.5.3.4.cmml">+</mo><mrow id="alg1.l24.m1.4.4.2.2" xref="alg1.l24.m1.4.4.2.2.cmml"><mrow id="alg1.l24.m1.4.4.2.2.4" xref="alg1.l24.m1.4.4.2.2.4.cmml"><msub id="alg1.l24.m1.4.4.2.2.4.2" xref="alg1.l24.m1.4.4.2.2.4.2.cmml"><mi id="alg1.l24.m1.4.4.2.2.4.2.2" xref="alg1.l24.m1.4.4.2.2.4.2.2.cmml">Î¼</mi><mrow id="alg1.l24.m1.4.4.2.2.4.2.3" xref="alg1.l24.m1.4.4.2.2.4.2.3.cmml"><mi id="alg1.l24.m1.4.4.2.2.4.2.3.2" xref="alg1.l24.m1.4.4.2.2.4.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.4.4.2.2.4.2.3.1" xref="alg1.l24.m1.4.4.2.2.4.2.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.4.4.2.2.4.2.3.3" xref="alg1.l24.m1.4.4.2.2.4.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.4.4.2.2.4.2.3.1a" xref="alg1.l24.m1.4.4.2.2.4.2.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.4.4.2.2.4.2.3.4" xref="alg1.l24.m1.4.4.2.2.4.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.4.4.2.2.4.2.3.1b" xref="alg1.l24.m1.4.4.2.2.4.2.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.4.4.2.2.4.2.3.5" xref="alg1.l24.m1.4.4.2.2.4.2.3.5.cmml">n</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="alg1.l24.m1.4.4.2.2.4.1" xref="alg1.l24.m1.4.4.2.2.4.1.cmml">âˆ—</mo><msub id="alg1.l24.m1.4.4.2.2.4.3" xref="alg1.l24.m1.4.4.2.2.4.3.cmml"><mi id="alg1.l24.m1.4.4.2.2.4.3.2" xref="alg1.l24.m1.4.4.2.2.4.3.2.cmml">l</mi><mrow id="alg1.l24.m1.4.4.2.2.4.3.3" xref="alg1.l24.m1.4.4.2.2.4.3.3.cmml"><mi id="alg1.l24.m1.4.4.2.2.4.3.3.2" xref="alg1.l24.m1.4.4.2.2.4.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.4.4.2.2.4.3.3.1" xref="alg1.l24.m1.4.4.2.2.4.3.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.4.4.2.2.4.3.3.3" xref="alg1.l24.m1.4.4.2.2.4.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.4.4.2.2.4.3.3.1a" xref="alg1.l24.m1.4.4.2.2.4.3.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.4.4.2.2.4.3.3.4" xref="alg1.l24.m1.4.4.2.2.4.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.4.4.2.2.4.3.3.1b" xref="alg1.l24.m1.4.4.2.2.4.3.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.4.4.2.2.4.3.3.5" xref="alg1.l24.m1.4.4.2.2.4.3.3.5.cmml">n</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l24.m1.4.4.2.2.3" xref="alg1.l24.m1.4.4.2.2.3.cmml">â€‹</mo><mrow id="alg1.l24.m1.4.4.2.2.2.2" xref="alg1.l24.m1.4.4.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l24.m1.4.4.2.2.2.2.3" xref="alg1.l24.m1.4.4.2.2.2.3.cmml">(</mo><mi id="alg1.l24.m1.1.1" xref="alg1.l24.m1.1.1.cmml">z</mi><mo id="alg1.l24.m1.4.4.2.2.2.2.4" xref="alg1.l24.m1.4.4.2.2.2.3.cmml">,</mo><msub id="alg1.l24.m1.3.3.1.1.1.1.1" xref="alg1.l24.m1.3.3.1.1.1.1.1.cmml"><mi id="alg1.l24.m1.3.3.1.1.1.1.1.2" xref="alg1.l24.m1.3.3.1.1.1.1.1.2.cmml">z</mi><mrow id="alg1.l24.m1.3.3.1.1.1.1.1.3" xref="alg1.l24.m1.3.3.1.1.1.1.1.3.cmml"><mi id="alg1.l24.m1.3.3.1.1.1.1.1.3.2" xref="alg1.l24.m1.3.3.1.1.1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.3.3.1.1.1.1.1.3.1" xref="alg1.l24.m1.3.3.1.1.1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.3.3.1.1.1.1.1.3.3" xref="alg1.l24.m1.3.3.1.1.1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.3.3.1.1.1.1.1.3.1a" xref="alg1.l24.m1.3.3.1.1.1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.3.3.1.1.1.1.1.3.4" xref="alg1.l24.m1.3.3.1.1.1.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.3.3.1.1.1.1.1.3.1b" xref="alg1.l24.m1.3.3.1.1.1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.3.3.1.1.1.1.1.3.5" xref="alg1.l24.m1.3.3.1.1.1.1.1.3.5.cmml">b</mi></mrow></msub><mo id="alg1.l24.m1.4.4.2.2.2.2.5" xref="alg1.l24.m1.4.4.2.2.2.3.cmml">,</mo><msub id="alg1.l24.m1.4.4.2.2.2.2.2" xref="alg1.l24.m1.4.4.2.2.2.2.2.cmml"><mi id="alg1.l24.m1.4.4.2.2.2.2.2.2" xref="alg1.l24.m1.4.4.2.2.2.2.2.2.cmml">z</mi><mrow id="alg1.l24.m1.4.4.2.2.2.2.2.3" xref="alg1.l24.m1.4.4.2.2.2.2.2.3.cmml"><mi id="alg1.l24.m1.4.4.2.2.2.2.2.3.2" xref="alg1.l24.m1.4.4.2.2.2.2.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.4.4.2.2.2.2.2.3.1" xref="alg1.l24.m1.4.4.2.2.2.2.2.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.4.4.2.2.2.2.2.3.3" xref="alg1.l24.m1.4.4.2.2.2.2.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.4.4.2.2.2.2.2.3.1a" xref="alg1.l24.m1.4.4.2.2.2.2.2.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.4.4.2.2.2.2.2.3.4" xref="alg1.l24.m1.4.4.2.2.2.2.2.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.4.4.2.2.2.2.2.3.1b" xref="alg1.l24.m1.4.4.2.2.2.2.2.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.4.4.2.2.2.2.2.3.5" xref="alg1.l24.m1.4.4.2.2.2.2.2.3.5.cmml">v</mi></mrow></msub><mo stretchy="false" id="alg1.l24.m1.4.4.2.2.2.2.6" xref="alg1.l24.m1.4.4.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l24.m1.5.5.3.4a" xref="alg1.l24.m1.5.5.3.4.cmml">+</mo><mrow id="alg1.l24.m1.5.5.3.3" xref="alg1.l24.m1.5.5.3.3.cmml"><mrow id="alg1.l24.m1.5.5.3.3.3" xref="alg1.l24.m1.5.5.3.3.3.cmml"><msub id="alg1.l24.m1.5.5.3.3.3.2" xref="alg1.l24.m1.5.5.3.3.3.2.cmml"><mi id="alg1.l24.m1.5.5.3.3.3.2.2" xref="alg1.l24.m1.5.5.3.3.3.2.2.cmml">Î¼</mi><mrow id="alg1.l24.m1.5.5.3.3.3.2.3" xref="alg1.l24.m1.5.5.3.3.3.2.3.cmml"><mi id="alg1.l24.m1.5.5.3.3.3.2.3.2" xref="alg1.l24.m1.5.5.3.3.3.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.5.5.3.3.3.2.3.1" xref="alg1.l24.m1.5.5.3.3.3.2.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.5.5.3.3.3.2.3.3" xref="alg1.l24.m1.5.5.3.3.3.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.5.5.3.3.3.2.3.1a" xref="alg1.l24.m1.5.5.3.3.3.2.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.5.5.3.3.3.2.3.4" xref="alg1.l24.m1.5.5.3.3.3.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.5.5.3.3.3.2.3.1b" xref="alg1.l24.m1.5.5.3.3.3.2.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.5.5.3.3.3.2.3.5" xref="alg1.l24.m1.5.5.3.3.3.2.3.5.cmml">b</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="alg1.l24.m1.5.5.3.3.3.1" xref="alg1.l24.m1.5.5.3.3.3.1.cmml">âˆ—</mo><msub id="alg1.l24.m1.5.5.3.3.3.3" xref="alg1.l24.m1.5.5.3.3.3.3.cmml"><mi id="alg1.l24.m1.5.5.3.3.3.3.2" xref="alg1.l24.m1.5.5.3.3.3.3.2.cmml">l</mi><mrow id="alg1.l24.m1.5.5.3.3.3.3.3" xref="alg1.l24.m1.5.5.3.3.3.3.3.cmml"><mi id="alg1.l24.m1.5.5.3.3.3.3.3.2" xref="alg1.l24.m1.5.5.3.3.3.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.5.5.3.3.3.3.3.1" xref="alg1.l24.m1.5.5.3.3.3.3.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.5.5.3.3.3.3.3.3" xref="alg1.l24.m1.5.5.3.3.3.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.5.5.3.3.3.3.3.1a" xref="alg1.l24.m1.5.5.3.3.3.3.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.5.5.3.3.3.3.3.4" xref="alg1.l24.m1.5.5.3.3.3.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.5.5.3.3.3.3.3.1b" xref="alg1.l24.m1.5.5.3.3.3.3.3.1.cmml">â€‹</mo><mi id="alg1.l24.m1.5.5.3.3.3.3.3.5" xref="alg1.l24.m1.5.5.3.3.3.3.3.5.cmml">b</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l24.m1.5.5.3.3.2" xref="alg1.l24.m1.5.5.3.3.2.cmml">â€‹</mo><mrow id="alg1.l24.m1.5.5.3.3.1.1" xref="alg1.l24.m1.5.5.3.3.1.2.cmml"><mo stretchy="false" id="alg1.l24.m1.5.5.3.3.1.1.2" xref="alg1.l24.m1.5.5.3.3.1.2.cmml">(</mo><mi id="alg1.l24.m1.2.2" xref="alg1.l24.m1.2.2.cmml">z</mi><mo id="alg1.l24.m1.5.5.3.3.1.1.3" xref="alg1.l24.m1.5.5.3.3.1.2.cmml">,</mo><mrow id="alg1.l24.m1.5.5.3.3.1.1.1" xref="alg1.l24.m1.5.5.3.3.1.1.1.cmml"><mi id="alg1.l24.m1.5.5.3.3.1.1.1.2" xref="alg1.l24.m1.5.5.3.3.1.1.1.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.5.5.3.3.1.1.1.1" xref="alg1.l24.m1.5.5.3.3.1.1.1.1.cmml">â€‹</mo><msup id="alg1.l24.m1.5.5.3.3.1.1.1.3" xref="alg1.l24.m1.5.5.3.3.1.1.1.3.cmml"><mi id="alg1.l24.m1.5.5.3.3.1.1.1.3.2" xref="alg1.l24.m1.5.5.3.3.1.1.1.3.2.cmml">s</mi><mi id="alg1.l24.m1.5.5.3.3.1.1.1.3.3" xref="alg1.l24.m1.5.5.3.3.1.1.1.3.3.cmml">t</mi></msup></mrow><mo stretchy="false" id="alg1.l24.m1.5.5.3.3.1.1.4" xref="alg1.l24.m1.5.5.3.3.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l24.m1.5b"><apply id="alg1.l24.m1.5.5.cmml" xref="alg1.l24.m1.5.5"><ci id="alg1.l24.m1.5.5.4.cmml" xref="alg1.l24.m1.5.5.4">â†</ci><ci id="alg1.l24.m1.5.5.5.cmml" xref="alg1.l24.m1.5.5.5">ğ‘™</ci><apply id="alg1.l24.m1.5.5.3.cmml" xref="alg1.l24.m1.5.5.3"><plus id="alg1.l24.m1.5.5.3.4.cmml" xref="alg1.l24.m1.5.5.3.4"></plus><apply id="alg1.l24.m1.5.5.3.5.cmml" xref="alg1.l24.m1.5.5.3.5"><csymbol cd="ambiguous" id="alg1.l24.m1.5.5.3.5.1.cmml" xref="alg1.l24.m1.5.5.3.5">subscript</csymbol><ci id="alg1.l24.m1.5.5.3.5.2.cmml" xref="alg1.l24.m1.5.5.3.5.2">ğ‘™</ci><apply id="alg1.l24.m1.5.5.3.5.3.cmml" xref="alg1.l24.m1.5.5.3.5.3"><times id="alg1.l24.m1.5.5.3.5.3.1.cmml" xref="alg1.l24.m1.5.5.3.5.3.1"></times><ci id="alg1.l24.m1.5.5.3.5.3.2.cmml" xref="alg1.l24.m1.5.5.3.5.3.2">ğ‘</ci><ci id="alg1.l24.m1.5.5.3.5.3.3.cmml" xref="alg1.l24.m1.5.5.3.5.3.3">ğ‘™</ci><ci id="alg1.l24.m1.5.5.3.5.3.4.cmml" xref="alg1.l24.m1.5.5.3.5.3.4">ğ‘</ci><ci id="alg1.l24.m1.5.5.3.5.3.5.cmml" xref="alg1.l24.m1.5.5.3.5.3.5">ğ‘ </ci><ci id="alg1.l24.m1.5.5.3.5.3.6.cmml" xref="alg1.l24.m1.5.5.3.5.3.6">ğ‘ </ci></apply></apply><apply id="alg1.l24.m1.4.4.2.2.cmml" xref="alg1.l24.m1.4.4.2.2"><times id="alg1.l24.m1.4.4.2.2.3.cmml" xref="alg1.l24.m1.4.4.2.2.3"></times><apply id="alg1.l24.m1.4.4.2.2.4.cmml" xref="alg1.l24.m1.4.4.2.2.4"><times id="alg1.l24.m1.4.4.2.2.4.1.cmml" xref="alg1.l24.m1.4.4.2.2.4.1"></times><apply id="alg1.l24.m1.4.4.2.2.4.2.cmml" xref="alg1.l24.m1.4.4.2.2.4.2"><csymbol cd="ambiguous" id="alg1.l24.m1.4.4.2.2.4.2.1.cmml" xref="alg1.l24.m1.4.4.2.2.4.2">subscript</csymbol><ci id="alg1.l24.m1.4.4.2.2.4.2.2.cmml" xref="alg1.l24.m1.4.4.2.2.4.2.2">ğœ‡</ci><apply id="alg1.l24.m1.4.4.2.2.4.2.3.cmml" xref="alg1.l24.m1.4.4.2.2.4.2.3"><times id="alg1.l24.m1.4.4.2.2.4.2.3.1.cmml" xref="alg1.l24.m1.4.4.2.2.4.2.3.1"></times><ci id="alg1.l24.m1.4.4.2.2.4.2.3.2.cmml" xref="alg1.l24.m1.4.4.2.2.4.2.3.2">ğ‘š</ci><ci id="alg1.l24.m1.4.4.2.2.4.2.3.3.cmml" xref="alg1.l24.m1.4.4.2.2.4.2.3.3">ğ‘œ</ci><ci id="alg1.l24.m1.4.4.2.2.4.2.3.4.cmml" xref="alg1.l24.m1.4.4.2.2.4.2.3.4">ğ‘œ</ci><ci id="alg1.l24.m1.4.4.2.2.4.2.3.5.cmml" xref="alg1.l24.m1.4.4.2.2.4.2.3.5">ğ‘›</ci></apply></apply><apply id="alg1.l24.m1.4.4.2.2.4.3.cmml" xref="alg1.l24.m1.4.4.2.2.4.3"><csymbol cd="ambiguous" id="alg1.l24.m1.4.4.2.2.4.3.1.cmml" xref="alg1.l24.m1.4.4.2.2.4.3">subscript</csymbol><ci id="alg1.l24.m1.4.4.2.2.4.3.2.cmml" xref="alg1.l24.m1.4.4.2.2.4.3.2">ğ‘™</ci><apply id="alg1.l24.m1.4.4.2.2.4.3.3.cmml" xref="alg1.l24.m1.4.4.2.2.4.3.3"><times id="alg1.l24.m1.4.4.2.2.4.3.3.1.cmml" xref="alg1.l24.m1.4.4.2.2.4.3.3.1"></times><ci id="alg1.l24.m1.4.4.2.2.4.3.3.2.cmml" xref="alg1.l24.m1.4.4.2.2.4.3.3.2">ğ‘š</ci><ci id="alg1.l24.m1.4.4.2.2.4.3.3.3.cmml" xref="alg1.l24.m1.4.4.2.2.4.3.3.3">ğ‘œ</ci><ci id="alg1.l24.m1.4.4.2.2.4.3.3.4.cmml" xref="alg1.l24.m1.4.4.2.2.4.3.3.4">ğ‘œ</ci><ci id="alg1.l24.m1.4.4.2.2.4.3.3.5.cmml" xref="alg1.l24.m1.4.4.2.2.4.3.3.5">ğ‘›</ci></apply></apply></apply><vector id="alg1.l24.m1.4.4.2.2.2.3.cmml" xref="alg1.l24.m1.4.4.2.2.2.2"><ci id="alg1.l24.m1.1.1.cmml" xref="alg1.l24.m1.1.1">ğ‘§</ci><apply id="alg1.l24.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l24.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l24.m1.3.3.1.1.1.1.1.1.cmml" xref="alg1.l24.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="alg1.l24.m1.3.3.1.1.1.1.1.2.cmml" xref="alg1.l24.m1.3.3.1.1.1.1.1.2">ğ‘§</ci><apply id="alg1.l24.m1.3.3.1.1.1.1.1.3.cmml" xref="alg1.l24.m1.3.3.1.1.1.1.1.3"><times id="alg1.l24.m1.3.3.1.1.1.1.1.3.1.cmml" xref="alg1.l24.m1.3.3.1.1.1.1.1.3.1"></times><ci id="alg1.l24.m1.3.3.1.1.1.1.1.3.2.cmml" xref="alg1.l24.m1.3.3.1.1.1.1.1.3.2">ğ‘”</ci><ci id="alg1.l24.m1.3.3.1.1.1.1.1.3.3.cmml" xref="alg1.l24.m1.3.3.1.1.1.1.1.3.3">ğ‘™</ci><ci id="alg1.l24.m1.3.3.1.1.1.1.1.3.4.cmml" xref="alg1.l24.m1.3.3.1.1.1.1.1.3.4">ğ‘œ</ci><ci id="alg1.l24.m1.3.3.1.1.1.1.1.3.5.cmml" xref="alg1.l24.m1.3.3.1.1.1.1.1.3.5">ğ‘</ci></apply></apply><apply id="alg1.l24.m1.4.4.2.2.2.2.2.cmml" xref="alg1.l24.m1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l24.m1.4.4.2.2.2.2.2.1.cmml" xref="alg1.l24.m1.4.4.2.2.2.2.2">subscript</csymbol><ci id="alg1.l24.m1.4.4.2.2.2.2.2.2.cmml" xref="alg1.l24.m1.4.4.2.2.2.2.2.2">ğ‘§</ci><apply id="alg1.l24.m1.4.4.2.2.2.2.2.3.cmml" xref="alg1.l24.m1.4.4.2.2.2.2.2.3"><times id="alg1.l24.m1.4.4.2.2.2.2.2.3.1.cmml" xref="alg1.l24.m1.4.4.2.2.2.2.2.3.1"></times><ci id="alg1.l24.m1.4.4.2.2.2.2.2.3.2.cmml" xref="alg1.l24.m1.4.4.2.2.2.2.2.3.2">ğ‘</ci><ci id="alg1.l24.m1.4.4.2.2.2.2.2.3.3.cmml" xref="alg1.l24.m1.4.4.2.2.2.2.2.3.3">ğ‘Ÿ</ci><ci id="alg1.l24.m1.4.4.2.2.2.2.2.3.4.cmml" xref="alg1.l24.m1.4.4.2.2.2.2.2.3.4">ğ‘’</ci><ci id="alg1.l24.m1.4.4.2.2.2.2.2.3.5.cmml" xref="alg1.l24.m1.4.4.2.2.2.2.2.3.5">ğ‘£</ci></apply></apply></vector></apply><apply id="alg1.l24.m1.5.5.3.3.cmml" xref="alg1.l24.m1.5.5.3.3"><times id="alg1.l24.m1.5.5.3.3.2.cmml" xref="alg1.l24.m1.5.5.3.3.2"></times><apply id="alg1.l24.m1.5.5.3.3.3.cmml" xref="alg1.l24.m1.5.5.3.3.3"><times id="alg1.l24.m1.5.5.3.3.3.1.cmml" xref="alg1.l24.m1.5.5.3.3.3.1"></times><apply id="alg1.l24.m1.5.5.3.3.3.2.cmml" xref="alg1.l24.m1.5.5.3.3.3.2"><csymbol cd="ambiguous" id="alg1.l24.m1.5.5.3.3.3.2.1.cmml" xref="alg1.l24.m1.5.5.3.3.3.2">subscript</csymbol><ci id="alg1.l24.m1.5.5.3.3.3.2.2.cmml" xref="alg1.l24.m1.5.5.3.3.3.2.2">ğœ‡</ci><apply id="alg1.l24.m1.5.5.3.3.3.2.3.cmml" xref="alg1.l24.m1.5.5.3.3.3.2.3"><times id="alg1.l24.m1.5.5.3.3.3.2.3.1.cmml" xref="alg1.l24.m1.5.5.3.3.3.2.3.1"></times><ci id="alg1.l24.m1.5.5.3.3.3.2.3.2.cmml" xref="alg1.l24.m1.5.5.3.3.3.2.3.2">ğ‘”</ci><ci id="alg1.l24.m1.5.5.3.3.3.2.3.3.cmml" xref="alg1.l24.m1.5.5.3.3.3.2.3.3">ğ‘™</ci><ci id="alg1.l24.m1.5.5.3.3.3.2.3.4.cmml" xref="alg1.l24.m1.5.5.3.3.3.2.3.4">ğ‘œ</ci><ci id="alg1.l24.m1.5.5.3.3.3.2.3.5.cmml" xref="alg1.l24.m1.5.5.3.3.3.2.3.5">ğ‘</ci></apply></apply><apply id="alg1.l24.m1.5.5.3.3.3.3.cmml" xref="alg1.l24.m1.5.5.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l24.m1.5.5.3.3.3.3.1.cmml" xref="alg1.l24.m1.5.5.3.3.3.3">subscript</csymbol><ci id="alg1.l24.m1.5.5.3.3.3.3.2.cmml" xref="alg1.l24.m1.5.5.3.3.3.3.2">ğ‘™</ci><apply id="alg1.l24.m1.5.5.3.3.3.3.3.cmml" xref="alg1.l24.m1.5.5.3.3.3.3.3"><times id="alg1.l24.m1.5.5.3.3.3.3.3.1.cmml" xref="alg1.l24.m1.5.5.3.3.3.3.3.1"></times><ci id="alg1.l24.m1.5.5.3.3.3.3.3.2.cmml" xref="alg1.l24.m1.5.5.3.3.3.3.3.2">ğ‘”</ci><ci id="alg1.l24.m1.5.5.3.3.3.3.3.3.cmml" xref="alg1.l24.m1.5.5.3.3.3.3.3.3">ğ‘™</ci><ci id="alg1.l24.m1.5.5.3.3.3.3.3.4.cmml" xref="alg1.l24.m1.5.5.3.3.3.3.3.4">ğ‘œ</ci><ci id="alg1.l24.m1.5.5.3.3.3.3.3.5.cmml" xref="alg1.l24.m1.5.5.3.3.3.3.3.5">ğ‘</ci></apply></apply></apply><interval closure="open" id="alg1.l24.m1.5.5.3.3.1.2.cmml" xref="alg1.l24.m1.5.5.3.3.1.1"><ci id="alg1.l24.m1.2.2.cmml" xref="alg1.l24.m1.2.2">ğ‘§</ci><apply id="alg1.l24.m1.5.5.3.3.1.1.1.cmml" xref="alg1.l24.m1.5.5.3.3.1.1.1"><times id="alg1.l24.m1.5.5.3.3.1.1.1.1.cmml" xref="alg1.l24.m1.5.5.3.3.1.1.1.1"></times><ci id="alg1.l24.m1.5.5.3.3.1.1.1.2.cmml" xref="alg1.l24.m1.5.5.3.3.1.1.1.2">ğ‘§</ci><apply id="alg1.l24.m1.5.5.3.3.1.1.1.3.cmml" xref="alg1.l24.m1.5.5.3.3.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l24.m1.5.5.3.3.1.1.1.3.1.cmml" xref="alg1.l24.m1.5.5.3.3.1.1.1.3">superscript</csymbol><ci id="alg1.l24.m1.5.5.3.3.1.1.1.3.2.cmml" xref="alg1.l24.m1.5.5.3.3.1.1.1.3.2">ğ‘ </ci><ci id="alg1.l24.m1.5.5.3.3.1.1.1.3.3.cmml" xref="alg1.l24.m1.5.5.3.3.1.1.1.3.3">ğ‘¡</ci></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m1.5c">l\leftarrow l_{class}+\mu_{moon}*l_{moon}(z,z_{glob},z_{prev})+\mu_{glob}*l_{glob}(z,zs^{t})</annotation></semantics></math>

</div>
<div id="alg1.l25" class="ltx_listingline">Â Â Â Â Â Â Â Â Â <math id="alg1.l25.m1.1" class="ltx_Math" alttext="w_{i+1}^{t}\leftarrow w_{i}^{t}-\eta\Delta l" display="inline"><semantics id="alg1.l25.m1.1a"><mrow id="alg1.l25.m1.1.1" xref="alg1.l25.m1.1.1.cmml"><msubsup id="alg1.l25.m1.1.1.2" xref="alg1.l25.m1.1.1.2.cmml"><mi id="alg1.l25.m1.1.1.2.2.2" xref="alg1.l25.m1.1.1.2.2.2.cmml">w</mi><mrow id="alg1.l25.m1.1.1.2.2.3" xref="alg1.l25.m1.1.1.2.2.3.cmml"><mi id="alg1.l25.m1.1.1.2.2.3.2" xref="alg1.l25.m1.1.1.2.2.3.2.cmml">i</mi><mo id="alg1.l25.m1.1.1.2.2.3.1" xref="alg1.l25.m1.1.1.2.2.3.1.cmml">+</mo><mn id="alg1.l25.m1.1.1.2.2.3.3" xref="alg1.l25.m1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="alg1.l25.m1.1.1.2.3" xref="alg1.l25.m1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l25.m1.1.1.1" xref="alg1.l25.m1.1.1.1.cmml">â†</mo><mrow id="alg1.l25.m1.1.1.3" xref="alg1.l25.m1.1.1.3.cmml"><msubsup id="alg1.l25.m1.1.1.3.2" xref="alg1.l25.m1.1.1.3.2.cmml"><mi id="alg1.l25.m1.1.1.3.2.2.2" xref="alg1.l25.m1.1.1.3.2.2.2.cmml">w</mi><mi id="alg1.l25.m1.1.1.3.2.2.3" xref="alg1.l25.m1.1.1.3.2.2.3.cmml">i</mi><mi id="alg1.l25.m1.1.1.3.2.3" xref="alg1.l25.m1.1.1.3.2.3.cmml">t</mi></msubsup><mo id="alg1.l25.m1.1.1.3.1" xref="alg1.l25.m1.1.1.3.1.cmml">âˆ’</mo><mrow id="alg1.l25.m1.1.1.3.3" xref="alg1.l25.m1.1.1.3.3.cmml"><mi id="alg1.l25.m1.1.1.3.3.2" xref="alg1.l25.m1.1.1.3.3.2.cmml">Î·</mi><mo lspace="0em" rspace="0em" id="alg1.l25.m1.1.1.3.3.1" xref="alg1.l25.m1.1.1.3.3.1.cmml">â€‹</mo><mi mathvariant="normal" id="alg1.l25.m1.1.1.3.3.3" xref="alg1.l25.m1.1.1.3.3.3.cmml">Î”</mi><mo lspace="0em" rspace="0em" id="alg1.l25.m1.1.1.3.3.1a" xref="alg1.l25.m1.1.1.3.3.1.cmml">â€‹</mo><mi id="alg1.l25.m1.1.1.3.3.4" xref="alg1.l25.m1.1.1.3.3.4.cmml">l</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l25.m1.1b"><apply id="alg1.l25.m1.1.1.cmml" xref="alg1.l25.m1.1.1"><ci id="alg1.l25.m1.1.1.1.cmml" xref="alg1.l25.m1.1.1.1">â†</ci><apply id="alg1.l25.m1.1.1.2.cmml" xref="alg1.l25.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.2.1.cmml" xref="alg1.l25.m1.1.1.2">superscript</csymbol><apply id="alg1.l25.m1.1.1.2.2.cmml" xref="alg1.l25.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.2.2.1.cmml" xref="alg1.l25.m1.1.1.2">subscript</csymbol><ci id="alg1.l25.m1.1.1.2.2.2.cmml" xref="alg1.l25.m1.1.1.2.2.2">ğ‘¤</ci><apply id="alg1.l25.m1.1.1.2.2.3.cmml" xref="alg1.l25.m1.1.1.2.2.3"><plus id="alg1.l25.m1.1.1.2.2.3.1.cmml" xref="alg1.l25.m1.1.1.2.2.3.1"></plus><ci id="alg1.l25.m1.1.1.2.2.3.2.cmml" xref="alg1.l25.m1.1.1.2.2.3.2">ğ‘–</ci><cn type="integer" id="alg1.l25.m1.1.1.2.2.3.3.cmml" xref="alg1.l25.m1.1.1.2.2.3.3">1</cn></apply></apply><ci id="alg1.l25.m1.1.1.2.3.cmml" xref="alg1.l25.m1.1.1.2.3">ğ‘¡</ci></apply><apply id="alg1.l25.m1.1.1.3.cmml" xref="alg1.l25.m1.1.1.3"><minus id="alg1.l25.m1.1.1.3.1.cmml" xref="alg1.l25.m1.1.1.3.1"></minus><apply id="alg1.l25.m1.1.1.3.2.cmml" xref="alg1.l25.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.3.2.1.cmml" xref="alg1.l25.m1.1.1.3.2">superscript</csymbol><apply id="alg1.l25.m1.1.1.3.2.2.cmml" xref="alg1.l25.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.3.2.2.1.cmml" xref="alg1.l25.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l25.m1.1.1.3.2.2.2.cmml" xref="alg1.l25.m1.1.1.3.2.2.2">ğ‘¤</ci><ci id="alg1.l25.m1.1.1.3.2.2.3.cmml" xref="alg1.l25.m1.1.1.3.2.2.3">ğ‘–</ci></apply><ci id="alg1.l25.m1.1.1.3.2.3.cmml" xref="alg1.l25.m1.1.1.3.2.3">ğ‘¡</ci></apply><apply id="alg1.l25.m1.1.1.3.3.cmml" xref="alg1.l25.m1.1.1.3.3"><times id="alg1.l25.m1.1.1.3.3.1.cmml" xref="alg1.l25.m1.1.1.3.3.1"></times><ci id="alg1.l25.m1.1.1.3.3.2.cmml" xref="alg1.l25.m1.1.1.3.3.2">ğœ‚</ci><ci id="alg1.l25.m1.1.1.3.3.3.cmml" xref="alg1.l25.m1.1.1.3.3.3">Î”</ci><ci id="alg1.l25.m1.1.1.3.3.4.cmml" xref="alg1.l25.m1.1.1.3.3.4">ğ‘™</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m1.1c">w_{i+1}^{t}\leftarrow w_{i}^{t}-\eta\Delta l</annotation></semantics></math>

</div>
<div id="alg1.l26" class="ltx_listingline">Â Â Â Â Â <span id="alg1.l26.1" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l26.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l27" class="ltx_listingline">
<span id="alg1.l27.1" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l27.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l28" class="ltx_listingline">
<span id="alg1.l28.1" class="ltx_text ltx_font_bold">for</span>Â each class c <math id="alg1.l28.m1.1" class="ltx_Math" alttext="\in" display="inline"><semantics id="alg1.l28.m1.1a"><mo id="alg1.l28.m1.1.1" xref="alg1.l28.m1.1.1.cmml">âˆˆ</mo><annotation-xml encoding="MathML-Content" id="alg1.l28.m1.1b"><in id="alg1.l28.m1.1.1.cmml" xref="alg1.l28.m1.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="alg1.l28.m1.1c">\in</annotation></semantics></math> CÂ <span id="alg1.l28.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l29" class="ltx_listingline">Â Â Â Â Â <math id="alg1.l29.m1.1" class="ltx_Math" alttext="zs^{c}=\frac{1}{N^{c}}\sum_{x}^{N}Proj(Enc(w_{E}^{t};x^{j}))*1_{j=c}" display="inline"><semantics id="alg1.l29.m1.1a"><mrow id="alg1.l29.m1.1.1" xref="alg1.l29.m1.1.1.cmml"><mrow id="alg1.l29.m1.1.1.3" xref="alg1.l29.m1.1.1.3.cmml"><mi id="alg1.l29.m1.1.1.3.2" xref="alg1.l29.m1.1.1.3.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="alg1.l29.m1.1.1.3.1" xref="alg1.l29.m1.1.1.3.1.cmml">â€‹</mo><msup id="alg1.l29.m1.1.1.3.3" xref="alg1.l29.m1.1.1.3.3.cmml"><mi id="alg1.l29.m1.1.1.3.3.2" xref="alg1.l29.m1.1.1.3.3.2.cmml">s</mi><mi id="alg1.l29.m1.1.1.3.3.3" xref="alg1.l29.m1.1.1.3.3.3.cmml">c</mi></msup></mrow><mo id="alg1.l29.m1.1.1.2" xref="alg1.l29.m1.1.1.2.cmml">=</mo><mrow id="alg1.l29.m1.1.1.1" xref="alg1.l29.m1.1.1.1.cmml"><mfrac id="alg1.l29.m1.1.1.1.3" xref="alg1.l29.m1.1.1.1.3.cmml"><mn id="alg1.l29.m1.1.1.1.3.2" xref="alg1.l29.m1.1.1.1.3.2.cmml">1</mn><msup id="alg1.l29.m1.1.1.1.3.3" xref="alg1.l29.m1.1.1.1.3.3.cmml"><mi id="alg1.l29.m1.1.1.1.3.3.2" xref="alg1.l29.m1.1.1.1.3.3.2.cmml">N</mi><mi id="alg1.l29.m1.1.1.1.3.3.3" xref="alg1.l29.m1.1.1.1.3.3.3.cmml">c</mi></msup></mfrac><mo lspace="0em" rspace="0em" id="alg1.l29.m1.1.1.1.2" xref="alg1.l29.m1.1.1.1.2.cmml">â€‹</mo><mrow id="alg1.l29.m1.1.1.1.1" xref="alg1.l29.m1.1.1.1.1.cmml"><msubsup id="alg1.l29.m1.1.1.1.1.2" xref="alg1.l29.m1.1.1.1.1.2.cmml"><mo id="alg1.l29.m1.1.1.1.1.2.2.2" xref="alg1.l29.m1.1.1.1.1.2.2.2.cmml">âˆ‘</mo><mi id="alg1.l29.m1.1.1.1.1.2.2.3" xref="alg1.l29.m1.1.1.1.1.2.2.3.cmml">x</mi><mi id="alg1.l29.m1.1.1.1.1.2.3" xref="alg1.l29.m1.1.1.1.1.2.3.cmml">N</mi></msubsup><mrow id="alg1.l29.m1.1.1.1.1.1" xref="alg1.l29.m1.1.1.1.1.1.cmml"><mrow id="alg1.l29.m1.1.1.1.1.1.1" xref="alg1.l29.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l29.m1.1.1.1.1.1.1.3" xref="alg1.l29.m1.1.1.1.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l29.m1.1.1.1.1.1.1.2" xref="alg1.l29.m1.1.1.1.1.1.1.2.cmml">â€‹</mo><mi id="alg1.l29.m1.1.1.1.1.1.1.4" xref="alg1.l29.m1.1.1.1.1.1.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l29.m1.1.1.1.1.1.1.2a" xref="alg1.l29.m1.1.1.1.1.1.1.2.cmml">â€‹</mo><mi id="alg1.l29.m1.1.1.1.1.1.1.5" xref="alg1.l29.m1.1.1.1.1.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l29.m1.1.1.1.1.1.1.2b" xref="alg1.l29.m1.1.1.1.1.1.1.2.cmml">â€‹</mo><mi id="alg1.l29.m1.1.1.1.1.1.1.6" xref="alg1.l29.m1.1.1.1.1.1.1.6.cmml">j</mi><mo lspace="0em" rspace="0em" id="alg1.l29.m1.1.1.1.1.1.1.2c" xref="alg1.l29.m1.1.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="alg1.l29.m1.1.1.1.1.1.1.1.1" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l29.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l29.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.4" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.4.cmml">E</mi><mo lspace="0em" rspace="0em" id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.3.cmml">â€‹</mo><mi id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.5" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.3a" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.3.cmml">â€‹</mo><mi id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.6" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.3b" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.3.cmml">â€‹</mo><mrow id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msubsup id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">E</mi><mi id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2.4" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">;</mo><msup id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">x</mi><mi id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">j</mi></msup><mo stretchy="false" id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2.5" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo rspace="0.055em" stretchy="false" id="alg1.l29.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="alg1.l29.m1.1.1.1.1.1.2" xref="alg1.l29.m1.1.1.1.1.1.2.cmml">âˆ—</mo><msub id="alg1.l29.m1.1.1.1.1.1.3" xref="alg1.l29.m1.1.1.1.1.1.3.cmml"><mn id="alg1.l29.m1.1.1.1.1.1.3.2" xref="alg1.l29.m1.1.1.1.1.1.3.2.cmml">1</mn><mrow id="alg1.l29.m1.1.1.1.1.1.3.3" xref="alg1.l29.m1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l29.m1.1.1.1.1.1.3.3.2" xref="alg1.l29.m1.1.1.1.1.1.3.3.2.cmml">j</mi><mo id="alg1.l29.m1.1.1.1.1.1.3.3.1" xref="alg1.l29.m1.1.1.1.1.1.3.3.1.cmml">=</mo><mi id="alg1.l29.m1.1.1.1.1.1.3.3.3" xref="alg1.l29.m1.1.1.1.1.1.3.3.3.cmml">c</mi></mrow></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l29.m1.1b"><apply id="alg1.l29.m1.1.1.cmml" xref="alg1.l29.m1.1.1"><eq id="alg1.l29.m1.1.1.2.cmml" xref="alg1.l29.m1.1.1.2"></eq><apply id="alg1.l29.m1.1.1.3.cmml" xref="alg1.l29.m1.1.1.3"><times id="alg1.l29.m1.1.1.3.1.cmml" xref="alg1.l29.m1.1.1.3.1"></times><ci id="alg1.l29.m1.1.1.3.2.cmml" xref="alg1.l29.m1.1.1.3.2">ğ‘§</ci><apply id="alg1.l29.m1.1.1.3.3.cmml" xref="alg1.l29.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.3.3.1.cmml" xref="alg1.l29.m1.1.1.3.3">superscript</csymbol><ci id="alg1.l29.m1.1.1.3.3.2.cmml" xref="alg1.l29.m1.1.1.3.3.2">ğ‘ </ci><ci id="alg1.l29.m1.1.1.3.3.3.cmml" xref="alg1.l29.m1.1.1.3.3.3">ğ‘</ci></apply></apply><apply id="alg1.l29.m1.1.1.1.cmml" xref="alg1.l29.m1.1.1.1"><times id="alg1.l29.m1.1.1.1.2.cmml" xref="alg1.l29.m1.1.1.1.2"></times><apply id="alg1.l29.m1.1.1.1.3.cmml" xref="alg1.l29.m1.1.1.1.3"><divide id="alg1.l29.m1.1.1.1.3.1.cmml" xref="alg1.l29.m1.1.1.1.3"></divide><cn type="integer" id="alg1.l29.m1.1.1.1.3.2.cmml" xref="alg1.l29.m1.1.1.1.3.2">1</cn><apply id="alg1.l29.m1.1.1.1.3.3.cmml" xref="alg1.l29.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.3.3.1.cmml" xref="alg1.l29.m1.1.1.1.3.3">superscript</csymbol><ci id="alg1.l29.m1.1.1.1.3.3.2.cmml" xref="alg1.l29.m1.1.1.1.3.3.2">ğ‘</ci><ci id="alg1.l29.m1.1.1.1.3.3.3.cmml" xref="alg1.l29.m1.1.1.1.3.3.3">ğ‘</ci></apply></apply><apply id="alg1.l29.m1.1.1.1.1.cmml" xref="alg1.l29.m1.1.1.1.1"><apply id="alg1.l29.m1.1.1.1.1.2.cmml" xref="alg1.l29.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.1.2.1.cmml" xref="alg1.l29.m1.1.1.1.1.2">superscript</csymbol><apply id="alg1.l29.m1.1.1.1.1.2.2.cmml" xref="alg1.l29.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.1.2.2.1.cmml" xref="alg1.l29.m1.1.1.1.1.2">subscript</csymbol><sum id="alg1.l29.m1.1.1.1.1.2.2.2.cmml" xref="alg1.l29.m1.1.1.1.1.2.2.2"></sum><ci id="alg1.l29.m1.1.1.1.1.2.2.3.cmml" xref="alg1.l29.m1.1.1.1.1.2.2.3">ğ‘¥</ci></apply><ci id="alg1.l29.m1.1.1.1.1.2.3.cmml" xref="alg1.l29.m1.1.1.1.1.2.3">ğ‘</ci></apply><apply id="alg1.l29.m1.1.1.1.1.1.cmml" xref="alg1.l29.m1.1.1.1.1.1"><times id="alg1.l29.m1.1.1.1.1.1.2.cmml" xref="alg1.l29.m1.1.1.1.1.1.2"></times><apply id="alg1.l29.m1.1.1.1.1.1.1.cmml" xref="alg1.l29.m1.1.1.1.1.1.1"><times id="alg1.l29.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.2"></times><ci id="alg1.l29.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.3">ğ‘ƒ</ci><ci id="alg1.l29.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.4">ğ‘Ÿ</ci><ci id="alg1.l29.m1.1.1.1.1.1.1.5.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.5">ğ‘œ</ci><ci id="alg1.l29.m1.1.1.1.1.1.1.6.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.6">ğ‘—</ci><apply id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1"><times id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.3"></times><ci id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.4">ğ¸</ci><ci id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.5.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.5">ğ‘›</ci><ci id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.6.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.6">ğ‘</ci><list id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2"><apply id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">ğ‘¤</ci><ci id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">ğ¸</ci></apply><ci id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">ğ‘¡</ci></apply><apply id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2.2.2">ğ‘¥</ci><ci id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2.2.3">ğ‘—</ci></apply></list></apply></apply><apply id="alg1.l29.m1.1.1.1.1.1.3.cmml" xref="alg1.l29.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l29.m1.1.1.1.1.1.3">subscript</csymbol><cn type="integer" id="alg1.l29.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l29.m1.1.1.1.1.1.3.2">1</cn><apply id="alg1.l29.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l29.m1.1.1.1.1.1.3.3"><eq id="alg1.l29.m1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l29.m1.1.1.1.1.1.3.3.1"></eq><ci id="alg1.l29.m1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l29.m1.1.1.1.1.1.3.3.2">ğ‘—</ci><ci id="alg1.l29.m1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l29.m1.1.1.1.1.1.3.3.3">ğ‘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l29.m1.1c">zs^{c}=\frac{1}{N^{c}}\sum_{x}^{N}Proj(Enc(w_{E}^{t};x^{j}))*1_{j=c}</annotation></semantics></math>

</div>
<div id="alg1.l30" class="ltx_listingline">
<span id="alg1.l30.1" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l30.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l31" class="ltx_listingline">return <math id="alg1.l31.m1.1" class="ltx_Math" alttext="w_{E}^{t+1}" display="inline"><semantics id="alg1.l31.m1.1a"><msubsup id="alg1.l31.m1.1.1" xref="alg1.l31.m1.1.1.cmml"><mi id="alg1.l31.m1.1.1.2.2" xref="alg1.l31.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l31.m1.1.1.2.3" xref="alg1.l31.m1.1.1.2.3.cmml">E</mi><mrow id="alg1.l31.m1.1.1.3" xref="alg1.l31.m1.1.1.3.cmml"><mi id="alg1.l31.m1.1.1.3.2" xref="alg1.l31.m1.1.1.3.2.cmml">t</mi><mo id="alg1.l31.m1.1.1.3.1" xref="alg1.l31.m1.1.1.3.1.cmml">+</mo><mn id="alg1.l31.m1.1.1.3.3" xref="alg1.l31.m1.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l31.m1.1b"><apply id="alg1.l31.m1.1.1.cmml" xref="alg1.l31.m1.1.1"><csymbol cd="ambiguous" id="alg1.l31.m1.1.1.1.cmml" xref="alg1.l31.m1.1.1">superscript</csymbol><apply id="alg1.l31.m1.1.1.2.cmml" xref="alg1.l31.m1.1.1"><csymbol cd="ambiguous" id="alg1.l31.m1.1.1.2.1.cmml" xref="alg1.l31.m1.1.1">subscript</csymbol><ci id="alg1.l31.m1.1.1.2.2.cmml" xref="alg1.l31.m1.1.1.2.2">ğ‘¤</ci><ci id="alg1.l31.m1.1.1.2.3.cmml" xref="alg1.l31.m1.1.1.2.3">ğ¸</ci></apply><apply id="alg1.l31.m1.1.1.3.cmml" xref="alg1.l31.m1.1.1.3"><plus id="alg1.l31.m1.1.1.3.1.cmml" xref="alg1.l31.m1.1.1.3.1"></plus><ci id="alg1.l31.m1.1.1.3.2.cmml" xref="alg1.l31.m1.1.1.3.2">ğ‘¡</ci><cn type="integer" id="alg1.l31.m1.1.1.3.3.cmml" xref="alg1.l31.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l31.m1.1c">w_{E}^{t+1}</annotation></semantics></math>, <math id="alg1.l31.m2.1" class="ltx_Math" alttext="zs" display="inline"><semantics id="alg1.l31.m2.1a"><mrow id="alg1.l31.m2.1.1" xref="alg1.l31.m2.1.1.cmml"><mi id="alg1.l31.m2.1.1.2" xref="alg1.l31.m2.1.1.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="alg1.l31.m2.1.1.1" xref="alg1.l31.m2.1.1.1.cmml">â€‹</mo><mi id="alg1.l31.m2.1.1.3" xref="alg1.l31.m2.1.1.3.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l31.m2.1b"><apply id="alg1.l31.m2.1.1.cmml" xref="alg1.l31.m2.1.1"><times id="alg1.l31.m2.1.1.1.cmml" xref="alg1.l31.m2.1.1.1"></times><ci id="alg1.l31.m2.1.1.2.cmml" xref="alg1.l31.m2.1.1.2">ğ‘§</ci><ci id="alg1.l31.m2.1.1.3.cmml" xref="alg1.l31.m2.1.1.3">ğ‘ </ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l31.m2.1c">zs</annotation></semantics></math>
</div>
<div id="alg1.l32" class="ltx_listingline">
</div>
</div>
</figure>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Intellectual Points</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">Our contributions are two-fold. First, most prior works focused on regularizing local devicesâ€™ weights or only regularizing feature representations of local images<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>,<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. However, our approach directly takes advantage of feature representations from other devices without sharing the raw data by regularizing each sampleâ€™s local representation with its corresponding global class-wise feature representation. The global class-wise feature map is from a randomly selected device for each round</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">Furthermore, our experiments show that the global representation contrastive loss and the MOON loss are complementary to each other. We have considered losses other than the MOON loss by modifying its negative pair, but the model could easily collapse or the performance would be worse than the FedAvg. Moreover, even without the MOON loss, simply adding our regularization term on top of the supervised learning loss can achieve the same level of accuracy with MOON. However, using one of them doesnâ€™t outperform the other. Combining them together is the key to our success.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Work Performed</span>
</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS1.4.1.1" class="ltx_text">V-A</span> </span><span id="S5.SS1.5.2" class="ltx_text ltx_font_italic">Dataset</span>
</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.7" class="ltx_p">We used CIFAR-10 as our experiment dataset because it is relatively small and widely used in previous papers. To simulate the non-IID scenario, we follow MOONâ€™s setup by using the Dirichlet distribution to generate dataset <math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><msub id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mi id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml">D</mi><mi id="S5.SS1.p1.1.m1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2">ğ·</ci><ci id="S5.SS1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">D_{i}</annotation></semantics></math> for each device. Specifically, we sample <math id="S5.SS1.p1.2.m2.1" class="ltx_Math" alttext="{p_{k}}\sim Dir_{N}(\beta)" display="inline"><semantics id="S5.SS1.p1.2.m2.1a"><mrow id="S5.SS1.p1.2.m2.1.2" xref="S5.SS1.p1.2.m2.1.2.cmml"><msub id="S5.SS1.p1.2.m2.1.2.2" xref="S5.SS1.p1.2.m2.1.2.2.cmml"><mi id="S5.SS1.p1.2.m2.1.2.2.2" xref="S5.SS1.p1.2.m2.1.2.2.2.cmml">p</mi><mi id="S5.SS1.p1.2.m2.1.2.2.3" xref="S5.SS1.p1.2.m2.1.2.2.3.cmml">k</mi></msub><mo id="S5.SS1.p1.2.m2.1.2.1" xref="S5.SS1.p1.2.m2.1.2.1.cmml">âˆ¼</mo><mrow id="S5.SS1.p1.2.m2.1.2.3" xref="S5.SS1.p1.2.m2.1.2.3.cmml"><mi id="S5.SS1.p1.2.m2.1.2.3.2" xref="S5.SS1.p1.2.m2.1.2.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p1.2.m2.1.2.3.1" xref="S5.SS1.p1.2.m2.1.2.3.1.cmml">â€‹</mo><mi id="S5.SS1.p1.2.m2.1.2.3.3" xref="S5.SS1.p1.2.m2.1.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p1.2.m2.1.2.3.1a" xref="S5.SS1.p1.2.m2.1.2.3.1.cmml">â€‹</mo><msub id="S5.SS1.p1.2.m2.1.2.3.4" xref="S5.SS1.p1.2.m2.1.2.3.4.cmml"><mi id="S5.SS1.p1.2.m2.1.2.3.4.2" xref="S5.SS1.p1.2.m2.1.2.3.4.2.cmml">r</mi><mi id="S5.SS1.p1.2.m2.1.2.3.4.3" xref="S5.SS1.p1.2.m2.1.2.3.4.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S5.SS1.p1.2.m2.1.2.3.1b" xref="S5.SS1.p1.2.m2.1.2.3.1.cmml">â€‹</mo><mrow id="S5.SS1.p1.2.m2.1.2.3.5.2" xref="S5.SS1.p1.2.m2.1.2.3.cmml"><mo stretchy="false" id="S5.SS1.p1.2.m2.1.2.3.5.2.1" xref="S5.SS1.p1.2.m2.1.2.3.cmml">(</mo><mi id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml">Î²</mi><mo stretchy="false" id="S5.SS1.p1.2.m2.1.2.3.5.2.2" xref="S5.SS1.p1.2.m2.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.2.cmml" xref="S5.SS1.p1.2.m2.1.2"><csymbol cd="latexml" id="S5.SS1.p1.2.m2.1.2.1.cmml" xref="S5.SS1.p1.2.m2.1.2.1">similar-to</csymbol><apply id="S5.SS1.p1.2.m2.1.2.2.cmml" xref="S5.SS1.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S5.SS1.p1.2.m2.1.2.2.1.cmml" xref="S5.SS1.p1.2.m2.1.2.2">subscript</csymbol><ci id="S5.SS1.p1.2.m2.1.2.2.2.cmml" xref="S5.SS1.p1.2.m2.1.2.2.2">ğ‘</ci><ci id="S5.SS1.p1.2.m2.1.2.2.3.cmml" xref="S5.SS1.p1.2.m2.1.2.2.3">ğ‘˜</ci></apply><apply id="S5.SS1.p1.2.m2.1.2.3.cmml" xref="S5.SS1.p1.2.m2.1.2.3"><times id="S5.SS1.p1.2.m2.1.2.3.1.cmml" xref="S5.SS1.p1.2.m2.1.2.3.1"></times><ci id="S5.SS1.p1.2.m2.1.2.3.2.cmml" xref="S5.SS1.p1.2.m2.1.2.3.2">ğ·</ci><ci id="S5.SS1.p1.2.m2.1.2.3.3.cmml" xref="S5.SS1.p1.2.m2.1.2.3.3">ğ‘–</ci><apply id="S5.SS1.p1.2.m2.1.2.3.4.cmml" xref="S5.SS1.p1.2.m2.1.2.3.4"><csymbol cd="ambiguous" id="S5.SS1.p1.2.m2.1.2.3.4.1.cmml" xref="S5.SS1.p1.2.m2.1.2.3.4">subscript</csymbol><ci id="S5.SS1.p1.2.m2.1.2.3.4.2.cmml" xref="S5.SS1.p1.2.m2.1.2.3.4.2">ğ‘Ÿ</ci><ci id="S5.SS1.p1.2.m2.1.2.3.4.3.cmml" xref="S5.SS1.p1.2.m2.1.2.3.4.3">ğ‘</ci></apply><ci id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1">ğ›½</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">{p_{k}}\sim Dir_{N}(\beta)</annotation></semantics></math> for each class and allocate <math id="S5.SS1.p1.3.m3.1" class="ltx_Math" alttext="p_{kj}" display="inline"><semantics id="S5.SS1.p1.3.m3.1a"><msub id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml"><mi id="S5.SS1.p1.3.m3.1.1.2" xref="S5.SS1.p1.3.m3.1.1.2.cmml">p</mi><mrow id="S5.SS1.p1.3.m3.1.1.3" xref="S5.SS1.p1.3.m3.1.1.3.cmml"><mi id="S5.SS1.p1.3.m3.1.1.3.2" xref="S5.SS1.p1.3.m3.1.1.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p1.3.m3.1.1.3.1" xref="S5.SS1.p1.3.m3.1.1.3.1.cmml">â€‹</mo><mi id="S5.SS1.p1.3.m3.1.1.3.3" xref="S5.SS1.p1.3.m3.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><apply id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.3.m3.1.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS1.p1.3.m3.1.1.2.cmml" xref="S5.SS1.p1.3.m3.1.1.2">ğ‘</ci><apply id="S5.SS1.p1.3.m3.1.1.3.cmml" xref="S5.SS1.p1.3.m3.1.1.3"><times id="S5.SS1.p1.3.m3.1.1.3.1.cmml" xref="S5.SS1.p1.3.m3.1.1.3.1"></times><ci id="S5.SS1.p1.3.m3.1.1.3.2.cmml" xref="S5.SS1.p1.3.m3.1.1.3.2">ğ‘˜</ci><ci id="S5.SS1.p1.3.m3.1.1.3.3.cmml" xref="S5.SS1.p1.3.m3.1.1.3.3">ğ‘—</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">p_{kj}</annotation></semantics></math> samples of class <math id="S5.SS1.p1.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS1.p1.4.m4.1a"><mi id="S5.SS1.p1.4.m4.1.1" xref="S5.SS1.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.4.m4.1b"><ci id="S5.SS1.p1.4.m4.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.4.m4.1c">k</annotation></semantics></math> to device <math id="S5.SS1.p1.5.m5.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S5.SS1.p1.5.m5.1a"><mi id="S5.SS1.p1.5.m5.1.1" xref="S5.SS1.p1.5.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.5.m5.1b"><ci id="S5.SS1.p1.5.m5.1.1.cmml" xref="S5.SS1.p1.5.m5.1.1">ğ‘—</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.5.m5.1c">j</annotation></semantics></math>. Our default is <math id="S5.SS1.p1.6.m6.1" class="ltx_Math" alttext="\beta=0.5" display="inline"><semantics id="S5.SS1.p1.6.m6.1a"><mrow id="S5.SS1.p1.6.m6.1.1" xref="S5.SS1.p1.6.m6.1.1.cmml"><mi id="S5.SS1.p1.6.m6.1.1.2" xref="S5.SS1.p1.6.m6.1.1.2.cmml">Î²</mi><mo id="S5.SS1.p1.6.m6.1.1.1" xref="S5.SS1.p1.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS1.p1.6.m6.1.1.3" xref="S5.SS1.p1.6.m6.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.6.m6.1b"><apply id="S5.SS1.p1.6.m6.1.1.cmml" xref="S5.SS1.p1.6.m6.1.1"><eq id="S5.SS1.p1.6.m6.1.1.1.cmml" xref="S5.SS1.p1.6.m6.1.1.1"></eq><ci id="S5.SS1.p1.6.m6.1.1.2.cmml" xref="S5.SS1.p1.6.m6.1.1.2">ğ›½</ci><cn type="float" id="S5.SS1.p1.6.m6.1.1.3.cmml" xref="S5.SS1.p1.6.m6.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.6.m6.1c">\beta=0.5</annotation></semantics></math>, which simulates a severe non-IID situation. The larger the <math id="S5.SS1.p1.7.m7.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.SS1.p1.7.m7.1a"><mi id="S5.SS1.p1.7.m7.1.1" xref="S5.SS1.p1.7.m7.1.1.cmml">Î²</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.7.m7.1b"><ci id="S5.SS1.p1.7.m7.1.1.cmml" xref="S5.SS1.p1.7.m7.1.1">ğ›½</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.7.m7.1c">\beta</annotation></semantics></math> gets to, the more IID each device will be. Using Dirichlet, we can have each local device have the same total number of samples as each other, but different class distribution from each other.</p>
</div>
<figure id="S5.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S5.F1.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2301.05797/assets/figs/Beta=0.2.png" id="S5.F1.sf1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="582" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F1.sf1.4.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><math id="S5.F1.sf1.2.m1.1" class="ltx_Math" alttext="\beta=0.2" display="inline"><semantics id="S5.F1.sf1.2.m1.1b"><mrow id="S5.F1.sf1.2.m1.1.1" xref="S5.F1.sf1.2.m1.1.1.cmml"><mi mathsize="90%" id="S5.F1.sf1.2.m1.1.1.2" xref="S5.F1.sf1.2.m1.1.1.2.cmml">Î²</mi><mo mathsize="90%" id="S5.F1.sf1.2.m1.1.1.1" xref="S5.F1.sf1.2.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="S5.F1.sf1.2.m1.1.1.3" xref="S5.F1.sf1.2.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F1.sf1.2.m1.1c"><apply id="S5.F1.sf1.2.m1.1.1.cmml" xref="S5.F1.sf1.2.m1.1.1"><eq id="S5.F1.sf1.2.m1.1.1.1.cmml" xref="S5.F1.sf1.2.m1.1.1.1"></eq><ci id="S5.F1.sf1.2.m1.1.1.2.cmml" xref="S5.F1.sf1.2.m1.1.1.2">ğ›½</ci><cn type="float" id="S5.F1.sf1.2.m1.1.1.3.cmml" xref="S5.F1.sf1.2.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F1.sf1.2.m1.1d">\beta=0.2</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S5.F1.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2301.05797/assets/figs/Beta=0.5.png" id="S5.F1.sf2.g1" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="582" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F1.sf2.4.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><math id="S5.F1.sf2.2.m1.1" class="ltx_Math" alttext="\beta=0.5" display="inline"><semantics id="S5.F1.sf2.2.m1.1b"><mrow id="S5.F1.sf2.2.m1.1.1" xref="S5.F1.sf2.2.m1.1.1.cmml"><mi mathsize="90%" id="S5.F1.sf2.2.m1.1.1.2" xref="S5.F1.sf2.2.m1.1.1.2.cmml">Î²</mi><mo mathsize="90%" id="S5.F1.sf2.2.m1.1.1.1" xref="S5.F1.sf2.2.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="S5.F1.sf2.2.m1.1.1.3" xref="S5.F1.sf2.2.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F1.sf2.2.m1.1c"><apply id="S5.F1.sf2.2.m1.1.1.cmml" xref="S5.F1.sf2.2.m1.1.1"><eq id="S5.F1.sf2.2.m1.1.1.1.cmml" xref="S5.F1.sf2.2.m1.1.1.1"></eq><ci id="S5.F1.sf2.2.m1.1.1.2.cmml" xref="S5.F1.sf2.2.m1.1.1.2">ğ›½</ci><cn type="float" id="S5.F1.sf2.2.m1.1.1.3.cmml" xref="S5.F1.sf2.2.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F1.sf2.2.m1.1d">\beta=0.5</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S5.F1.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2301.05797/assets/figs/Beta=1.png" id="S5.F1.sf3.g1" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="582" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F1.sf3.4.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><math id="S5.F1.sf3.2.m1.1" class="ltx_Math" alttext="\beta=1" display="inline"><semantics id="S5.F1.sf3.2.m1.1b"><mrow id="S5.F1.sf3.2.m1.1.1" xref="S5.F1.sf3.2.m1.1.1.cmml"><mi mathsize="90%" id="S5.F1.sf3.2.m1.1.1.2" xref="S5.F1.sf3.2.m1.1.1.2.cmml">Î²</mi><mo mathsize="90%" id="S5.F1.sf3.2.m1.1.1.1" xref="S5.F1.sf3.2.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="S5.F1.sf3.2.m1.1.1.3" xref="S5.F1.sf3.2.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F1.sf3.2.m1.1c"><apply id="S5.F1.sf3.2.m1.1.1.cmml" xref="S5.F1.sf3.2.m1.1.1"><eq id="S5.F1.sf3.2.m1.1.1.1.cmml" xref="S5.F1.sf3.2.m1.1.1.1"></eq><ci id="S5.F1.sf3.2.m1.1.1.2.cmml" xref="S5.F1.sf3.2.m1.1.1.2">ğ›½</ci><cn type="integer" id="S5.F1.sf3.2.m1.1.1.3.cmml" xref="S5.F1.sf3.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F1.sf3.2.m1.1d">\beta=1</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S5.F1.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2301.05797/assets/figs/Beta=5.png" id="S5.F1.sf4.g1" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="582" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F1.sf4.4.1.1" class="ltx_text" style="font-size:90%;">(d)</span> </span><math id="S5.F1.sf4.2.m1.1" class="ltx_Math" alttext="\beta=5" display="inline"><semantics id="S5.F1.sf4.2.m1.1b"><mrow id="S5.F1.sf4.2.m1.1.1" xref="S5.F1.sf4.2.m1.1.1.cmml"><mi mathsize="90%" id="S5.F1.sf4.2.m1.1.1.2" xref="S5.F1.sf4.2.m1.1.1.2.cmml">Î²</mi><mo mathsize="90%" id="S5.F1.sf4.2.m1.1.1.1" xref="S5.F1.sf4.2.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="S5.F1.sf4.2.m1.1.1.3" xref="S5.F1.sf4.2.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F1.sf4.2.m1.1c"><apply id="S5.F1.sf4.2.m1.1.1.cmml" xref="S5.F1.sf4.2.m1.1.1"><eq id="S5.F1.sf4.2.m1.1.1.1.cmml" xref="S5.F1.sf4.2.m1.1.1.1"></eq><ci id="S5.F1.sf4.2.m1.1.1.2.cmml" xref="S5.F1.sf4.2.m1.1.1.2">ğ›½</ci><cn type="integer" id="S5.F1.sf4.2.m1.1.1.3.cmml" xref="S5.F1.sf4.2.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F1.sf4.2.m1.1d">\beta=5</annotation></semantics></math></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F1.4.2.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S5.F1.2.1" class="ltx_text" style="font-size:90%;">Performance comparison under different <math id="S5.F1.2.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.F1.2.1.m1.1b"><mi id="S5.F1.2.1.m1.1.1" xref="S5.F1.2.1.m1.1.1.cmml">Î²</mi><annotation-xml encoding="MathML-Content" id="S5.F1.2.1.m1.1c"><ci id="S5.F1.2.1.m1.1.1.cmml" xref="S5.F1.2.1.m1.1.1">ğ›½</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F1.2.1.m1.1d">\beta</annotation></semantics></math> of non-IID scenarios.
</span></figcaption>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS2.4.1.1" class="ltx_text">V-B</span> </span><span id="S5.SS2.5.2" class="ltx_text ltx_font_italic">Implementation Details</span>
</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.2" class="ltx_p"><span id="S5.SS2.p1.2.1" class="ltx_text ltx_font_bold">Main Differences Compared with MOON</span> Our approach is implemented as an extension to MOON with two main differences. In particular, we modify the loss function to include supervised contrastive loss for shared representations. Furthermore, we change the device-to-server communication to sharing class-wise average representations of the local model, in addition to the local modelâ€™s weights. To avoid bias from limited data points, we only share the representation if the device has abundant samples for the corresponding class (i.e., more than 10 samples). Moreover, when distributing representations from the server to a device, we randomly sample <math id="S5.SS2.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS2.p1.1.m1.1a"><mi id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><ci id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">k</annotation></semantics></math> representations for each class and take the average of them to represent the specific class. If the server has fewer than <math id="S5.SS2.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS2.p1.2.m2.1a"><mi id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><ci id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">k</annotation></semantics></math> representations for a class, we will average everything we have to represent that class.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p"><span id="S5.SS2.p2.1.1" class="ltx_text ltx_font_bold">Model Architecture</span> Considering the time limit of this study, we used a simple CNN with two convolution layers, two max-pooling layers, and two fully connected layers as the encoder. After each convolution layer and fully connected layers, we have ReLU for the activation.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS3.4.1.1" class="ltx_text">V-C</span> </span><span id="S5.SS3.5.2" class="ltx_text ltx_font_italic">Experiment Setups</span>
</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.5" class="ltx_p">To evaluate the performance of our method, we compared it with FedAvg and MOON, where MOON is expected to perform better than FedAvg in non-IID setting. In default, we set <math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="\mu_{MOON}=5" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><mrow id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><msub id="S5.SS3.p1.1.m1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.2.cmml"><mi id="S5.SS3.p1.1.m1.1.1.2.2" xref="S5.SS3.p1.1.m1.1.1.2.2.cmml">Î¼</mi><mrow id="S5.SS3.p1.1.m1.1.1.2.3" xref="S5.SS3.p1.1.m1.1.1.2.3.cmml"><mi id="S5.SS3.p1.1.m1.1.1.2.3.2" xref="S5.SS3.p1.1.m1.1.1.2.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p1.1.m1.1.1.2.3.1" xref="S5.SS3.p1.1.m1.1.1.2.3.1.cmml">â€‹</mo><mi id="S5.SS3.p1.1.m1.1.1.2.3.3" xref="S5.SS3.p1.1.m1.1.1.2.3.3.cmml">O</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p1.1.m1.1.1.2.3.1a" xref="S5.SS3.p1.1.m1.1.1.2.3.1.cmml">â€‹</mo><mi id="S5.SS3.p1.1.m1.1.1.2.3.4" xref="S5.SS3.p1.1.m1.1.1.2.3.4.cmml">O</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p1.1.m1.1.1.2.3.1b" xref="S5.SS3.p1.1.m1.1.1.2.3.1.cmml">â€‹</mo><mi id="S5.SS3.p1.1.m1.1.1.2.3.5" xref="S5.SS3.p1.1.m1.1.1.2.3.5.cmml">N</mi></mrow></msub><mo id="S5.SS3.p1.1.m1.1.1.1" xref="S5.SS3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.1.m1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><eq id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1.1"></eq><apply id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.1.1.2.1.cmml" xref="S5.SS3.p1.1.m1.1.1.2">subscript</csymbol><ci id="S5.SS3.p1.1.m1.1.1.2.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2.2">ğœ‡</ci><apply id="S5.SS3.p1.1.m1.1.1.2.3.cmml" xref="S5.SS3.p1.1.m1.1.1.2.3"><times id="S5.SS3.p1.1.m1.1.1.2.3.1.cmml" xref="S5.SS3.p1.1.m1.1.1.2.3.1"></times><ci id="S5.SS3.p1.1.m1.1.1.2.3.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2.3.2">ğ‘€</ci><ci id="S5.SS3.p1.1.m1.1.1.2.3.3.cmml" xref="S5.SS3.p1.1.m1.1.1.2.3.3">ğ‘‚</ci><ci id="S5.SS3.p1.1.m1.1.1.2.3.4.cmml" xref="S5.SS3.p1.1.m1.1.1.2.3.4">ğ‘‚</ci><ci id="S5.SS3.p1.1.m1.1.1.2.3.5.cmml" xref="S5.SS3.p1.1.m1.1.1.2.3.5">ğ‘</ci></apply></apply><cn type="integer" id="S5.SS3.p1.1.m1.1.1.3.cmml" xref="S5.SS3.p1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">\mu_{MOON}=5</annotation></semantics></math> as it is the best parameter reported by the original paper <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. Besides, we set the batch size to <math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="64" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><mn id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><cn type="integer" id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">64</annotation></semantics></math>, and use the SGD optimizer with a learning rate of <math id="S5.SS3.p1.3.m3.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="S5.SS3.p1.3.m3.1a"><mn id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.1b"><cn type="float" id="S5.SS3.p1.3.m3.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">0.01</annotation></semantics></math>, a weight decay of <math id="S5.SS3.p1.4.m4.1" class="ltx_Math" alttext="0.00001" display="inline"><semantics id="S5.SS3.p1.4.m4.1a"><mn id="S5.SS3.p1.4.m4.1.1" xref="S5.SS3.p1.4.m4.1.1.cmml">0.00001</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.4.m4.1b"><cn type="float" id="S5.SS3.p1.4.m4.1.1.cmml" xref="S5.SS3.p1.4.m4.1.1">0.00001</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.4.m4.1c">0.00001</annotation></semantics></math>, and a momentum of <math id="S5.SS3.p1.5.m5.1" class="ltx_Math" alttext="0.9" display="inline"><semantics id="S5.SS3.p1.5.m5.1a"><mn id="S5.SS3.p1.5.m5.1.1" xref="S5.SS3.p1.5.m5.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.5.m5.1b"><cn type="float" id="S5.SS3.p1.5.m5.1.1.cmml" xref="S5.SS3.p1.5.m5.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.5.m5.1c">0.9</annotation></semantics></math>.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.7" class="ltx_p">Furthermore, to mimic traditional two-stage contrastive learning, we decrease the weight of the global representation contrastive loss throughout the communication rounds. Specifically, we use the following formula to control its weight, where <math id="S5.SS3.p2.1.m1.2" class="ltx_Math" alttext="\mu_{glob,s}" display="inline"><semantics id="S5.SS3.p2.1.m1.2a"><msub id="S5.SS3.p2.1.m1.2.3" xref="S5.SS3.p2.1.m1.2.3.cmml"><mi id="S5.SS3.p2.1.m1.2.3.2" xref="S5.SS3.p2.1.m1.2.3.2.cmml">Î¼</mi><mrow id="S5.SS3.p2.1.m1.2.2.2.2" xref="S5.SS3.p2.1.m1.2.2.2.3.cmml"><mrow id="S5.SS3.p2.1.m1.2.2.2.2.1" xref="S5.SS3.p2.1.m1.2.2.2.2.1.cmml"><mi id="S5.SS3.p2.1.m1.2.2.2.2.1.2" xref="S5.SS3.p2.1.m1.2.2.2.2.1.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p2.1.m1.2.2.2.2.1.1" xref="S5.SS3.p2.1.m1.2.2.2.2.1.1.cmml">â€‹</mo><mi id="S5.SS3.p2.1.m1.2.2.2.2.1.3" xref="S5.SS3.p2.1.m1.2.2.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p2.1.m1.2.2.2.2.1.1a" xref="S5.SS3.p2.1.m1.2.2.2.2.1.1.cmml">â€‹</mo><mi id="S5.SS3.p2.1.m1.2.2.2.2.1.4" xref="S5.SS3.p2.1.m1.2.2.2.2.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p2.1.m1.2.2.2.2.1.1b" xref="S5.SS3.p2.1.m1.2.2.2.2.1.1.cmml">â€‹</mo><mi id="S5.SS3.p2.1.m1.2.2.2.2.1.5" xref="S5.SS3.p2.1.m1.2.2.2.2.1.5.cmml">b</mi></mrow><mo id="S5.SS3.p2.1.m1.2.2.2.2.2" xref="S5.SS3.p2.1.m1.2.2.2.3.cmml">,</mo><mi id="S5.SS3.p2.1.m1.1.1.1.1" xref="S5.SS3.p2.1.m1.1.1.1.1.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.2b"><apply id="S5.SS3.p2.1.m1.2.3.cmml" xref="S5.SS3.p2.1.m1.2.3"><csymbol cd="ambiguous" id="S5.SS3.p2.1.m1.2.3.1.cmml" xref="S5.SS3.p2.1.m1.2.3">subscript</csymbol><ci id="S5.SS3.p2.1.m1.2.3.2.cmml" xref="S5.SS3.p2.1.m1.2.3.2">ğœ‡</ci><list id="S5.SS3.p2.1.m1.2.2.2.3.cmml" xref="S5.SS3.p2.1.m1.2.2.2.2"><apply id="S5.SS3.p2.1.m1.2.2.2.2.1.cmml" xref="S5.SS3.p2.1.m1.2.2.2.2.1"><times id="S5.SS3.p2.1.m1.2.2.2.2.1.1.cmml" xref="S5.SS3.p2.1.m1.2.2.2.2.1.1"></times><ci id="S5.SS3.p2.1.m1.2.2.2.2.1.2.cmml" xref="S5.SS3.p2.1.m1.2.2.2.2.1.2">ğ‘”</ci><ci id="S5.SS3.p2.1.m1.2.2.2.2.1.3.cmml" xref="S5.SS3.p2.1.m1.2.2.2.2.1.3">ğ‘™</ci><ci id="S5.SS3.p2.1.m1.2.2.2.2.1.4.cmml" xref="S5.SS3.p2.1.m1.2.2.2.2.1.4">ğ‘œ</ci><ci id="S5.SS3.p2.1.m1.2.2.2.2.1.5.cmml" xref="S5.SS3.p2.1.m1.2.2.2.2.1.5">ğ‘</ci></apply><ci id="S5.SS3.p2.1.m1.1.1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1.1.1">ğ‘ </ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.2c">\mu_{glob,s}</annotation></semantics></math> is the initial weight, the <math id="S5.SS3.p2.2.m2.2" class="ltx_Math" alttext="\mu_{glob,e}" display="inline"><semantics id="S5.SS3.p2.2.m2.2a"><msub id="S5.SS3.p2.2.m2.2.3" xref="S5.SS3.p2.2.m2.2.3.cmml"><mi id="S5.SS3.p2.2.m2.2.3.2" xref="S5.SS3.p2.2.m2.2.3.2.cmml">Î¼</mi><mrow id="S5.SS3.p2.2.m2.2.2.2.2" xref="S5.SS3.p2.2.m2.2.2.2.3.cmml"><mrow id="S5.SS3.p2.2.m2.2.2.2.2.1" xref="S5.SS3.p2.2.m2.2.2.2.2.1.cmml"><mi id="S5.SS3.p2.2.m2.2.2.2.2.1.2" xref="S5.SS3.p2.2.m2.2.2.2.2.1.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p2.2.m2.2.2.2.2.1.1" xref="S5.SS3.p2.2.m2.2.2.2.2.1.1.cmml">â€‹</mo><mi id="S5.SS3.p2.2.m2.2.2.2.2.1.3" xref="S5.SS3.p2.2.m2.2.2.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p2.2.m2.2.2.2.2.1.1a" xref="S5.SS3.p2.2.m2.2.2.2.2.1.1.cmml">â€‹</mo><mi id="S5.SS3.p2.2.m2.2.2.2.2.1.4" xref="S5.SS3.p2.2.m2.2.2.2.2.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p2.2.m2.2.2.2.2.1.1b" xref="S5.SS3.p2.2.m2.2.2.2.2.1.1.cmml">â€‹</mo><mi id="S5.SS3.p2.2.m2.2.2.2.2.1.5" xref="S5.SS3.p2.2.m2.2.2.2.2.1.5.cmml">b</mi></mrow><mo id="S5.SS3.p2.2.m2.2.2.2.2.2" xref="S5.SS3.p2.2.m2.2.2.2.3.cmml">,</mo><mi id="S5.SS3.p2.2.m2.1.1.1.1" xref="S5.SS3.p2.2.m2.1.1.1.1.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.2b"><apply id="S5.SS3.p2.2.m2.2.3.cmml" xref="S5.SS3.p2.2.m2.2.3"><csymbol cd="ambiguous" id="S5.SS3.p2.2.m2.2.3.1.cmml" xref="S5.SS3.p2.2.m2.2.3">subscript</csymbol><ci id="S5.SS3.p2.2.m2.2.3.2.cmml" xref="S5.SS3.p2.2.m2.2.3.2">ğœ‡</ci><list id="S5.SS3.p2.2.m2.2.2.2.3.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2"><apply id="S5.SS3.p2.2.m2.2.2.2.2.1.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.1"><times id="S5.SS3.p2.2.m2.2.2.2.2.1.1.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.1.1"></times><ci id="S5.SS3.p2.2.m2.2.2.2.2.1.2.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.1.2">ğ‘”</ci><ci id="S5.SS3.p2.2.m2.2.2.2.2.1.3.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.1.3">ğ‘™</ci><ci id="S5.SS3.p2.2.m2.2.2.2.2.1.4.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.1.4">ğ‘œ</ci><ci id="S5.SS3.p2.2.m2.2.2.2.2.1.5.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.1.5">ğ‘</ci></apply><ci id="S5.SS3.p2.2.m2.1.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1.1.1">ğ‘’</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.2c">\mu_{glob,e}</annotation></semantics></math> is the end weight, and the <math id="S5.SS3.p2.3.m3.1" class="ltx_Math" alttext="T_{0}" display="inline"><semantics id="S5.SS3.p2.3.m3.1a"><msub id="S5.SS3.p2.3.m3.1.1" xref="S5.SS3.p2.3.m3.1.1.cmml"><mi id="S5.SS3.p2.3.m3.1.1.2" xref="S5.SS3.p2.3.m3.1.1.2.cmml">T</mi><mn id="S5.SS3.p2.3.m3.1.1.3" xref="S5.SS3.p2.3.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.3.m3.1b"><apply id="S5.SS3.p2.3.m3.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.3.m3.1.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S5.SS3.p2.3.m3.1.1.2.cmml" xref="S5.SS3.p2.3.m3.1.1.2">ğ‘‡</ci><cn type="integer" id="S5.SS3.p2.3.m3.1.1.3.cmml" xref="S5.SS3.p2.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.3.m3.1c">T_{0}</annotation></semantics></math> is the number of warmup rounds. In our experiment, we set <math id="S5.SS3.p2.4.m4.2" class="ltx_Math" alttext="\mu_{glob,s}=1" display="inline"><semantics id="S5.SS3.p2.4.m4.2a"><mrow id="S5.SS3.p2.4.m4.2.3" xref="S5.SS3.p2.4.m4.2.3.cmml"><msub id="S5.SS3.p2.4.m4.2.3.2" xref="S5.SS3.p2.4.m4.2.3.2.cmml"><mi id="S5.SS3.p2.4.m4.2.3.2.2" xref="S5.SS3.p2.4.m4.2.3.2.2.cmml">Î¼</mi><mrow id="S5.SS3.p2.4.m4.2.2.2.2" xref="S5.SS3.p2.4.m4.2.2.2.3.cmml"><mrow id="S5.SS3.p2.4.m4.2.2.2.2.1" xref="S5.SS3.p2.4.m4.2.2.2.2.1.cmml"><mi id="S5.SS3.p2.4.m4.2.2.2.2.1.2" xref="S5.SS3.p2.4.m4.2.2.2.2.1.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p2.4.m4.2.2.2.2.1.1" xref="S5.SS3.p2.4.m4.2.2.2.2.1.1.cmml">â€‹</mo><mi id="S5.SS3.p2.4.m4.2.2.2.2.1.3" xref="S5.SS3.p2.4.m4.2.2.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p2.4.m4.2.2.2.2.1.1a" xref="S5.SS3.p2.4.m4.2.2.2.2.1.1.cmml">â€‹</mo><mi id="S5.SS3.p2.4.m4.2.2.2.2.1.4" xref="S5.SS3.p2.4.m4.2.2.2.2.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p2.4.m4.2.2.2.2.1.1b" xref="S5.SS3.p2.4.m4.2.2.2.2.1.1.cmml">â€‹</mo><mi id="S5.SS3.p2.4.m4.2.2.2.2.1.5" xref="S5.SS3.p2.4.m4.2.2.2.2.1.5.cmml">b</mi></mrow><mo id="S5.SS3.p2.4.m4.2.2.2.2.2" xref="S5.SS3.p2.4.m4.2.2.2.3.cmml">,</mo><mi id="S5.SS3.p2.4.m4.1.1.1.1" xref="S5.SS3.p2.4.m4.1.1.1.1.cmml">s</mi></mrow></msub><mo id="S5.SS3.p2.4.m4.2.3.1" xref="S5.SS3.p2.4.m4.2.3.1.cmml">=</mo><mn id="S5.SS3.p2.4.m4.2.3.3" xref="S5.SS3.p2.4.m4.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.4.m4.2b"><apply id="S5.SS3.p2.4.m4.2.3.cmml" xref="S5.SS3.p2.4.m4.2.3"><eq id="S5.SS3.p2.4.m4.2.3.1.cmml" xref="S5.SS3.p2.4.m4.2.3.1"></eq><apply id="S5.SS3.p2.4.m4.2.3.2.cmml" xref="S5.SS3.p2.4.m4.2.3.2"><csymbol cd="ambiguous" id="S5.SS3.p2.4.m4.2.3.2.1.cmml" xref="S5.SS3.p2.4.m4.2.3.2">subscript</csymbol><ci id="S5.SS3.p2.4.m4.2.3.2.2.cmml" xref="S5.SS3.p2.4.m4.2.3.2.2">ğœ‡</ci><list id="S5.SS3.p2.4.m4.2.2.2.3.cmml" xref="S5.SS3.p2.4.m4.2.2.2.2"><apply id="S5.SS3.p2.4.m4.2.2.2.2.1.cmml" xref="S5.SS3.p2.4.m4.2.2.2.2.1"><times id="S5.SS3.p2.4.m4.2.2.2.2.1.1.cmml" xref="S5.SS3.p2.4.m4.2.2.2.2.1.1"></times><ci id="S5.SS3.p2.4.m4.2.2.2.2.1.2.cmml" xref="S5.SS3.p2.4.m4.2.2.2.2.1.2">ğ‘”</ci><ci id="S5.SS3.p2.4.m4.2.2.2.2.1.3.cmml" xref="S5.SS3.p2.4.m4.2.2.2.2.1.3">ğ‘™</ci><ci id="S5.SS3.p2.4.m4.2.2.2.2.1.4.cmml" xref="S5.SS3.p2.4.m4.2.2.2.2.1.4">ğ‘œ</ci><ci id="S5.SS3.p2.4.m4.2.2.2.2.1.5.cmml" xref="S5.SS3.p2.4.m4.2.2.2.2.1.5">ğ‘</ci></apply><ci id="S5.SS3.p2.4.m4.1.1.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1.1.1">ğ‘ </ci></list></apply><cn type="integer" id="S5.SS3.p2.4.m4.2.3.3.cmml" xref="S5.SS3.p2.4.m4.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.4.m4.2c">\mu_{glob,s}=1</annotation></semantics></math>, <math id="S5.SS3.p2.5.m5.2" class="ltx_Math" alttext="\mu_{glob,e}=0.0001" display="inline"><semantics id="S5.SS3.p2.5.m5.2a"><mrow id="S5.SS3.p2.5.m5.2.3" xref="S5.SS3.p2.5.m5.2.3.cmml"><msub id="S5.SS3.p2.5.m5.2.3.2" xref="S5.SS3.p2.5.m5.2.3.2.cmml"><mi id="S5.SS3.p2.5.m5.2.3.2.2" xref="S5.SS3.p2.5.m5.2.3.2.2.cmml">Î¼</mi><mrow id="S5.SS3.p2.5.m5.2.2.2.2" xref="S5.SS3.p2.5.m5.2.2.2.3.cmml"><mrow id="S5.SS3.p2.5.m5.2.2.2.2.1" xref="S5.SS3.p2.5.m5.2.2.2.2.1.cmml"><mi id="S5.SS3.p2.5.m5.2.2.2.2.1.2" xref="S5.SS3.p2.5.m5.2.2.2.2.1.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p2.5.m5.2.2.2.2.1.1" xref="S5.SS3.p2.5.m5.2.2.2.2.1.1.cmml">â€‹</mo><mi id="S5.SS3.p2.5.m5.2.2.2.2.1.3" xref="S5.SS3.p2.5.m5.2.2.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p2.5.m5.2.2.2.2.1.1a" xref="S5.SS3.p2.5.m5.2.2.2.2.1.1.cmml">â€‹</mo><mi id="S5.SS3.p2.5.m5.2.2.2.2.1.4" xref="S5.SS3.p2.5.m5.2.2.2.2.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p2.5.m5.2.2.2.2.1.1b" xref="S5.SS3.p2.5.m5.2.2.2.2.1.1.cmml">â€‹</mo><mi id="S5.SS3.p2.5.m5.2.2.2.2.1.5" xref="S5.SS3.p2.5.m5.2.2.2.2.1.5.cmml">b</mi></mrow><mo id="S5.SS3.p2.5.m5.2.2.2.2.2" xref="S5.SS3.p2.5.m5.2.2.2.3.cmml">,</mo><mi id="S5.SS3.p2.5.m5.1.1.1.1" xref="S5.SS3.p2.5.m5.1.1.1.1.cmml">e</mi></mrow></msub><mo id="S5.SS3.p2.5.m5.2.3.1" xref="S5.SS3.p2.5.m5.2.3.1.cmml">=</mo><mn id="S5.SS3.p2.5.m5.2.3.3" xref="S5.SS3.p2.5.m5.2.3.3.cmml">0.0001</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.5.m5.2b"><apply id="S5.SS3.p2.5.m5.2.3.cmml" xref="S5.SS3.p2.5.m5.2.3"><eq id="S5.SS3.p2.5.m5.2.3.1.cmml" xref="S5.SS3.p2.5.m5.2.3.1"></eq><apply id="S5.SS3.p2.5.m5.2.3.2.cmml" xref="S5.SS3.p2.5.m5.2.3.2"><csymbol cd="ambiguous" id="S5.SS3.p2.5.m5.2.3.2.1.cmml" xref="S5.SS3.p2.5.m5.2.3.2">subscript</csymbol><ci id="S5.SS3.p2.5.m5.2.3.2.2.cmml" xref="S5.SS3.p2.5.m5.2.3.2.2">ğœ‡</ci><list id="S5.SS3.p2.5.m5.2.2.2.3.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2"><apply id="S5.SS3.p2.5.m5.2.2.2.2.1.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.1"><times id="S5.SS3.p2.5.m5.2.2.2.2.1.1.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.1.1"></times><ci id="S5.SS3.p2.5.m5.2.2.2.2.1.2.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.1.2">ğ‘”</ci><ci id="S5.SS3.p2.5.m5.2.2.2.2.1.3.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.1.3">ğ‘™</ci><ci id="S5.SS3.p2.5.m5.2.2.2.2.1.4.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.1.4">ğ‘œ</ci><ci id="S5.SS3.p2.5.m5.2.2.2.2.1.5.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.1.5">ğ‘</ci></apply><ci id="S5.SS3.p2.5.m5.1.1.1.1.cmml" xref="S5.SS3.p2.5.m5.1.1.1.1">ğ‘’</ci></list></apply><cn type="float" id="S5.SS3.p2.5.m5.2.3.3.cmml" xref="S5.SS3.p2.5.m5.2.3.3">0.0001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.5.m5.2c">\mu_{glob,e}=0.0001</annotation></semantics></math>, <math id="S5.SS3.p2.6.m6.1" class="ltx_Math" alttext="T=100" display="inline"><semantics id="S5.SS3.p2.6.m6.1a"><mrow id="S5.SS3.p2.6.m6.1.1" xref="S5.SS3.p2.6.m6.1.1.cmml"><mi id="S5.SS3.p2.6.m6.1.1.2" xref="S5.SS3.p2.6.m6.1.1.2.cmml">T</mi><mo id="S5.SS3.p2.6.m6.1.1.1" xref="S5.SS3.p2.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS3.p2.6.m6.1.1.3" xref="S5.SS3.p2.6.m6.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.6.m6.1b"><apply id="S5.SS3.p2.6.m6.1.1.cmml" xref="S5.SS3.p2.6.m6.1.1"><eq id="S5.SS3.p2.6.m6.1.1.1.cmml" xref="S5.SS3.p2.6.m6.1.1.1"></eq><ci id="S5.SS3.p2.6.m6.1.1.2.cmml" xref="S5.SS3.p2.6.m6.1.1.2">ğ‘‡</ci><cn type="integer" id="S5.SS3.p2.6.m6.1.1.3.cmml" xref="S5.SS3.p2.6.m6.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.6.m6.1c">T=100</annotation></semantics></math>, and <math id="S5.SS3.p2.7.m7.1" class="ltx_Math" alttext="T_{0}=5" display="inline"><semantics id="S5.SS3.p2.7.m7.1a"><mrow id="S5.SS3.p2.7.m7.1.1" xref="S5.SS3.p2.7.m7.1.1.cmml"><msub id="S5.SS3.p2.7.m7.1.1.2" xref="S5.SS3.p2.7.m7.1.1.2.cmml"><mi id="S5.SS3.p2.7.m7.1.1.2.2" xref="S5.SS3.p2.7.m7.1.1.2.2.cmml">T</mi><mn id="S5.SS3.p2.7.m7.1.1.2.3" xref="S5.SS3.p2.7.m7.1.1.2.3.cmml">0</mn></msub><mo id="S5.SS3.p2.7.m7.1.1.1" xref="S5.SS3.p2.7.m7.1.1.1.cmml">=</mo><mn id="S5.SS3.p2.7.m7.1.1.3" xref="S5.SS3.p2.7.m7.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.7.m7.1b"><apply id="S5.SS3.p2.7.m7.1.1.cmml" xref="S5.SS3.p2.7.m7.1.1"><eq id="S5.SS3.p2.7.m7.1.1.1.cmml" xref="S5.SS3.p2.7.m7.1.1.1"></eq><apply id="S5.SS3.p2.7.m7.1.1.2.cmml" xref="S5.SS3.p2.7.m7.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p2.7.m7.1.1.2.1.cmml" xref="S5.SS3.p2.7.m7.1.1.2">subscript</csymbol><ci id="S5.SS3.p2.7.m7.1.1.2.2.cmml" xref="S5.SS3.p2.7.m7.1.1.2.2">ğ‘‡</ci><cn type="integer" id="S5.SS3.p2.7.m7.1.1.2.3.cmml" xref="S5.SS3.p2.7.m7.1.1.2.3">0</cn></apply><cn type="integer" id="S5.SS3.p2.7.m7.1.1.3.cmml" xref="S5.SS3.p2.7.m7.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.7.m7.1c">T_{0}=5</annotation></semantics></math>.</p>
</div>
<div id="S5.SS3.p3" class="ltx_para">
<table id="S5.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.Ex1.m1.9" class="ltx_Math" alttext="\mu_{glob,i}=\mu_{glob,s}-\frac{1}{T-T_{0}}(\mu_{glob,s}-\mu_{glob,e})" display="block"><semantics id="S5.Ex1.m1.9a"><mrow id="S5.Ex1.m1.9.9" xref="S5.Ex1.m1.9.9.cmml"><msub id="S5.Ex1.m1.9.9.3" xref="S5.Ex1.m1.9.9.3.cmml"><mi id="S5.Ex1.m1.9.9.3.2" xref="S5.Ex1.m1.9.9.3.2.cmml">Î¼</mi><mrow id="S5.Ex1.m1.2.2.2.2" xref="S5.Ex1.m1.2.2.2.3.cmml"><mrow id="S5.Ex1.m1.2.2.2.2.1" xref="S5.Ex1.m1.2.2.2.2.1.cmml"><mi id="S5.Ex1.m1.2.2.2.2.1.2" xref="S5.Ex1.m1.2.2.2.2.1.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S5.Ex1.m1.2.2.2.2.1.1" xref="S5.Ex1.m1.2.2.2.2.1.1.cmml">â€‹</mo><mi id="S5.Ex1.m1.2.2.2.2.1.3" xref="S5.Ex1.m1.2.2.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.Ex1.m1.2.2.2.2.1.1a" xref="S5.Ex1.m1.2.2.2.2.1.1.cmml">â€‹</mo><mi id="S5.Ex1.m1.2.2.2.2.1.4" xref="S5.Ex1.m1.2.2.2.2.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.Ex1.m1.2.2.2.2.1.1b" xref="S5.Ex1.m1.2.2.2.2.1.1.cmml">â€‹</mo><mi id="S5.Ex1.m1.2.2.2.2.1.5" xref="S5.Ex1.m1.2.2.2.2.1.5.cmml">b</mi></mrow><mo id="S5.Ex1.m1.2.2.2.2.2" xref="S5.Ex1.m1.2.2.2.3.cmml">,</mo><mi id="S5.Ex1.m1.1.1.1.1" xref="S5.Ex1.m1.1.1.1.1.cmml">i</mi></mrow></msub><mo id="S5.Ex1.m1.9.9.2" xref="S5.Ex1.m1.9.9.2.cmml">=</mo><mrow id="S5.Ex1.m1.9.9.1" xref="S5.Ex1.m1.9.9.1.cmml"><msub id="S5.Ex1.m1.9.9.1.3" xref="S5.Ex1.m1.9.9.1.3.cmml"><mi id="S5.Ex1.m1.9.9.1.3.2" xref="S5.Ex1.m1.9.9.1.3.2.cmml">Î¼</mi><mrow id="S5.Ex1.m1.4.4.2.2" xref="S5.Ex1.m1.4.4.2.3.cmml"><mrow id="S5.Ex1.m1.4.4.2.2.1" xref="S5.Ex1.m1.4.4.2.2.1.cmml"><mi id="S5.Ex1.m1.4.4.2.2.1.2" xref="S5.Ex1.m1.4.4.2.2.1.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S5.Ex1.m1.4.4.2.2.1.1" xref="S5.Ex1.m1.4.4.2.2.1.1.cmml">â€‹</mo><mi id="S5.Ex1.m1.4.4.2.2.1.3" xref="S5.Ex1.m1.4.4.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.Ex1.m1.4.4.2.2.1.1a" xref="S5.Ex1.m1.4.4.2.2.1.1.cmml">â€‹</mo><mi id="S5.Ex1.m1.4.4.2.2.1.4" xref="S5.Ex1.m1.4.4.2.2.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.Ex1.m1.4.4.2.2.1.1b" xref="S5.Ex1.m1.4.4.2.2.1.1.cmml">â€‹</mo><mi id="S5.Ex1.m1.4.4.2.2.1.5" xref="S5.Ex1.m1.4.4.2.2.1.5.cmml">b</mi></mrow><mo id="S5.Ex1.m1.4.4.2.2.2" xref="S5.Ex1.m1.4.4.2.3.cmml">,</mo><mi id="S5.Ex1.m1.3.3.1.1" xref="S5.Ex1.m1.3.3.1.1.cmml">s</mi></mrow></msub><mo id="S5.Ex1.m1.9.9.1.2" xref="S5.Ex1.m1.9.9.1.2.cmml">âˆ’</mo><mrow id="S5.Ex1.m1.9.9.1.1" xref="S5.Ex1.m1.9.9.1.1.cmml"><mfrac id="S5.Ex1.m1.9.9.1.1.3" xref="S5.Ex1.m1.9.9.1.1.3.cmml"><mn id="S5.Ex1.m1.9.9.1.1.3.2" xref="S5.Ex1.m1.9.9.1.1.3.2.cmml">1</mn><mrow id="S5.Ex1.m1.9.9.1.1.3.3" xref="S5.Ex1.m1.9.9.1.1.3.3.cmml"><mi id="S5.Ex1.m1.9.9.1.1.3.3.2" xref="S5.Ex1.m1.9.9.1.1.3.3.2.cmml">T</mi><mo id="S5.Ex1.m1.9.9.1.1.3.3.1" xref="S5.Ex1.m1.9.9.1.1.3.3.1.cmml">âˆ’</mo><msub id="S5.Ex1.m1.9.9.1.1.3.3.3" xref="S5.Ex1.m1.9.9.1.1.3.3.3.cmml"><mi id="S5.Ex1.m1.9.9.1.1.3.3.3.2" xref="S5.Ex1.m1.9.9.1.1.3.3.3.2.cmml">T</mi><mn id="S5.Ex1.m1.9.9.1.1.3.3.3.3" xref="S5.Ex1.m1.9.9.1.1.3.3.3.3.cmml">0</mn></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S5.Ex1.m1.9.9.1.1.2" xref="S5.Ex1.m1.9.9.1.1.2.cmml">â€‹</mo><mrow id="S5.Ex1.m1.9.9.1.1.1.1" xref="S5.Ex1.m1.9.9.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.Ex1.m1.9.9.1.1.1.1.2" xref="S5.Ex1.m1.9.9.1.1.1.1.1.cmml">(</mo><mrow id="S5.Ex1.m1.9.9.1.1.1.1.1" xref="S5.Ex1.m1.9.9.1.1.1.1.1.cmml"><msub id="S5.Ex1.m1.9.9.1.1.1.1.1.2" xref="S5.Ex1.m1.9.9.1.1.1.1.1.2.cmml"><mi id="S5.Ex1.m1.9.9.1.1.1.1.1.2.2" xref="S5.Ex1.m1.9.9.1.1.1.1.1.2.2.cmml">Î¼</mi><mrow id="S5.Ex1.m1.6.6.2.2" xref="S5.Ex1.m1.6.6.2.3.cmml"><mrow id="S5.Ex1.m1.6.6.2.2.1" xref="S5.Ex1.m1.6.6.2.2.1.cmml"><mi id="S5.Ex1.m1.6.6.2.2.1.2" xref="S5.Ex1.m1.6.6.2.2.1.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S5.Ex1.m1.6.6.2.2.1.1" xref="S5.Ex1.m1.6.6.2.2.1.1.cmml">â€‹</mo><mi id="S5.Ex1.m1.6.6.2.2.1.3" xref="S5.Ex1.m1.6.6.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.Ex1.m1.6.6.2.2.1.1a" xref="S5.Ex1.m1.6.6.2.2.1.1.cmml">â€‹</mo><mi id="S5.Ex1.m1.6.6.2.2.1.4" xref="S5.Ex1.m1.6.6.2.2.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.Ex1.m1.6.6.2.2.1.1b" xref="S5.Ex1.m1.6.6.2.2.1.1.cmml">â€‹</mo><mi id="S5.Ex1.m1.6.6.2.2.1.5" xref="S5.Ex1.m1.6.6.2.2.1.5.cmml">b</mi></mrow><mo id="S5.Ex1.m1.6.6.2.2.2" xref="S5.Ex1.m1.6.6.2.3.cmml">,</mo><mi id="S5.Ex1.m1.5.5.1.1" xref="S5.Ex1.m1.5.5.1.1.cmml">s</mi></mrow></msub><mo id="S5.Ex1.m1.9.9.1.1.1.1.1.1" xref="S5.Ex1.m1.9.9.1.1.1.1.1.1.cmml">âˆ’</mo><msub id="S5.Ex1.m1.9.9.1.1.1.1.1.3" xref="S5.Ex1.m1.9.9.1.1.1.1.1.3.cmml"><mi id="S5.Ex1.m1.9.9.1.1.1.1.1.3.2" xref="S5.Ex1.m1.9.9.1.1.1.1.1.3.2.cmml">Î¼</mi><mrow id="S5.Ex1.m1.8.8.2.2" xref="S5.Ex1.m1.8.8.2.3.cmml"><mrow id="S5.Ex1.m1.8.8.2.2.1" xref="S5.Ex1.m1.8.8.2.2.1.cmml"><mi id="S5.Ex1.m1.8.8.2.2.1.2" xref="S5.Ex1.m1.8.8.2.2.1.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S5.Ex1.m1.8.8.2.2.1.1" xref="S5.Ex1.m1.8.8.2.2.1.1.cmml">â€‹</mo><mi id="S5.Ex1.m1.8.8.2.2.1.3" xref="S5.Ex1.m1.8.8.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.Ex1.m1.8.8.2.2.1.1a" xref="S5.Ex1.m1.8.8.2.2.1.1.cmml">â€‹</mo><mi id="S5.Ex1.m1.8.8.2.2.1.4" xref="S5.Ex1.m1.8.8.2.2.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.Ex1.m1.8.8.2.2.1.1b" xref="S5.Ex1.m1.8.8.2.2.1.1.cmml">â€‹</mo><mi id="S5.Ex1.m1.8.8.2.2.1.5" xref="S5.Ex1.m1.8.8.2.2.1.5.cmml">b</mi></mrow><mo id="S5.Ex1.m1.8.8.2.2.2" xref="S5.Ex1.m1.8.8.2.3.cmml">,</mo><mi id="S5.Ex1.m1.7.7.1.1" xref="S5.Ex1.m1.7.7.1.1.cmml">e</mi></mrow></msub></mrow><mo stretchy="false" id="S5.Ex1.m1.9.9.1.1.1.1.3" xref="S5.Ex1.m1.9.9.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex1.m1.9b"><apply id="S5.Ex1.m1.9.9.cmml" xref="S5.Ex1.m1.9.9"><eq id="S5.Ex1.m1.9.9.2.cmml" xref="S5.Ex1.m1.9.9.2"></eq><apply id="S5.Ex1.m1.9.9.3.cmml" xref="S5.Ex1.m1.9.9.3"><csymbol cd="ambiguous" id="S5.Ex1.m1.9.9.3.1.cmml" xref="S5.Ex1.m1.9.9.3">subscript</csymbol><ci id="S5.Ex1.m1.9.9.3.2.cmml" xref="S5.Ex1.m1.9.9.3.2">ğœ‡</ci><list id="S5.Ex1.m1.2.2.2.3.cmml" xref="S5.Ex1.m1.2.2.2.2"><apply id="S5.Ex1.m1.2.2.2.2.1.cmml" xref="S5.Ex1.m1.2.2.2.2.1"><times id="S5.Ex1.m1.2.2.2.2.1.1.cmml" xref="S5.Ex1.m1.2.2.2.2.1.1"></times><ci id="S5.Ex1.m1.2.2.2.2.1.2.cmml" xref="S5.Ex1.m1.2.2.2.2.1.2">ğ‘”</ci><ci id="S5.Ex1.m1.2.2.2.2.1.3.cmml" xref="S5.Ex1.m1.2.2.2.2.1.3">ğ‘™</ci><ci id="S5.Ex1.m1.2.2.2.2.1.4.cmml" xref="S5.Ex1.m1.2.2.2.2.1.4">ğ‘œ</ci><ci id="S5.Ex1.m1.2.2.2.2.1.5.cmml" xref="S5.Ex1.m1.2.2.2.2.1.5">ğ‘</ci></apply><ci id="S5.Ex1.m1.1.1.1.1.cmml" xref="S5.Ex1.m1.1.1.1.1">ğ‘–</ci></list></apply><apply id="S5.Ex1.m1.9.9.1.cmml" xref="S5.Ex1.m1.9.9.1"><minus id="S5.Ex1.m1.9.9.1.2.cmml" xref="S5.Ex1.m1.9.9.1.2"></minus><apply id="S5.Ex1.m1.9.9.1.3.cmml" xref="S5.Ex1.m1.9.9.1.3"><csymbol cd="ambiguous" id="S5.Ex1.m1.9.9.1.3.1.cmml" xref="S5.Ex1.m1.9.9.1.3">subscript</csymbol><ci id="S5.Ex1.m1.9.9.1.3.2.cmml" xref="S5.Ex1.m1.9.9.1.3.2">ğœ‡</ci><list id="S5.Ex1.m1.4.4.2.3.cmml" xref="S5.Ex1.m1.4.4.2.2"><apply id="S5.Ex1.m1.4.4.2.2.1.cmml" xref="S5.Ex1.m1.4.4.2.2.1"><times id="S5.Ex1.m1.4.4.2.2.1.1.cmml" xref="S5.Ex1.m1.4.4.2.2.1.1"></times><ci id="S5.Ex1.m1.4.4.2.2.1.2.cmml" xref="S5.Ex1.m1.4.4.2.2.1.2">ğ‘”</ci><ci id="S5.Ex1.m1.4.4.2.2.1.3.cmml" xref="S5.Ex1.m1.4.4.2.2.1.3">ğ‘™</ci><ci id="S5.Ex1.m1.4.4.2.2.1.4.cmml" xref="S5.Ex1.m1.4.4.2.2.1.4">ğ‘œ</ci><ci id="S5.Ex1.m1.4.4.2.2.1.5.cmml" xref="S5.Ex1.m1.4.4.2.2.1.5">ğ‘</ci></apply><ci id="S5.Ex1.m1.3.3.1.1.cmml" xref="S5.Ex1.m1.3.3.1.1">ğ‘ </ci></list></apply><apply id="S5.Ex1.m1.9.9.1.1.cmml" xref="S5.Ex1.m1.9.9.1.1"><times id="S5.Ex1.m1.9.9.1.1.2.cmml" xref="S5.Ex1.m1.9.9.1.1.2"></times><apply id="S5.Ex1.m1.9.9.1.1.3.cmml" xref="S5.Ex1.m1.9.9.1.1.3"><divide id="S5.Ex1.m1.9.9.1.1.3.1.cmml" xref="S5.Ex1.m1.9.9.1.1.3"></divide><cn type="integer" id="S5.Ex1.m1.9.9.1.1.3.2.cmml" xref="S5.Ex1.m1.9.9.1.1.3.2">1</cn><apply id="S5.Ex1.m1.9.9.1.1.3.3.cmml" xref="S5.Ex1.m1.9.9.1.1.3.3"><minus id="S5.Ex1.m1.9.9.1.1.3.3.1.cmml" xref="S5.Ex1.m1.9.9.1.1.3.3.1"></minus><ci id="S5.Ex1.m1.9.9.1.1.3.3.2.cmml" xref="S5.Ex1.m1.9.9.1.1.3.3.2">ğ‘‡</ci><apply id="S5.Ex1.m1.9.9.1.1.3.3.3.cmml" xref="S5.Ex1.m1.9.9.1.1.3.3.3"><csymbol cd="ambiguous" id="S5.Ex1.m1.9.9.1.1.3.3.3.1.cmml" xref="S5.Ex1.m1.9.9.1.1.3.3.3">subscript</csymbol><ci id="S5.Ex1.m1.9.9.1.1.3.3.3.2.cmml" xref="S5.Ex1.m1.9.9.1.1.3.3.3.2">ğ‘‡</ci><cn type="integer" id="S5.Ex1.m1.9.9.1.1.3.3.3.3.cmml" xref="S5.Ex1.m1.9.9.1.1.3.3.3.3">0</cn></apply></apply></apply><apply id="S5.Ex1.m1.9.9.1.1.1.1.1.cmml" xref="S5.Ex1.m1.9.9.1.1.1.1"><minus id="S5.Ex1.m1.9.9.1.1.1.1.1.1.cmml" xref="S5.Ex1.m1.9.9.1.1.1.1.1.1"></minus><apply id="S5.Ex1.m1.9.9.1.1.1.1.1.2.cmml" xref="S5.Ex1.m1.9.9.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.Ex1.m1.9.9.1.1.1.1.1.2.1.cmml" xref="S5.Ex1.m1.9.9.1.1.1.1.1.2">subscript</csymbol><ci id="S5.Ex1.m1.9.9.1.1.1.1.1.2.2.cmml" xref="S5.Ex1.m1.9.9.1.1.1.1.1.2.2">ğœ‡</ci><list id="S5.Ex1.m1.6.6.2.3.cmml" xref="S5.Ex1.m1.6.6.2.2"><apply id="S5.Ex1.m1.6.6.2.2.1.cmml" xref="S5.Ex1.m1.6.6.2.2.1"><times id="S5.Ex1.m1.6.6.2.2.1.1.cmml" xref="S5.Ex1.m1.6.6.2.2.1.1"></times><ci id="S5.Ex1.m1.6.6.2.2.1.2.cmml" xref="S5.Ex1.m1.6.6.2.2.1.2">ğ‘”</ci><ci id="S5.Ex1.m1.6.6.2.2.1.3.cmml" xref="S5.Ex1.m1.6.6.2.2.1.3">ğ‘™</ci><ci id="S5.Ex1.m1.6.6.2.2.1.4.cmml" xref="S5.Ex1.m1.6.6.2.2.1.4">ğ‘œ</ci><ci id="S5.Ex1.m1.6.6.2.2.1.5.cmml" xref="S5.Ex1.m1.6.6.2.2.1.5">ğ‘</ci></apply><ci id="S5.Ex1.m1.5.5.1.1.cmml" xref="S5.Ex1.m1.5.5.1.1">ğ‘ </ci></list></apply><apply id="S5.Ex1.m1.9.9.1.1.1.1.1.3.cmml" xref="S5.Ex1.m1.9.9.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.Ex1.m1.9.9.1.1.1.1.1.3.1.cmml" xref="S5.Ex1.m1.9.9.1.1.1.1.1.3">subscript</csymbol><ci id="S5.Ex1.m1.9.9.1.1.1.1.1.3.2.cmml" xref="S5.Ex1.m1.9.9.1.1.1.1.1.3.2">ğœ‡</ci><list id="S5.Ex1.m1.8.8.2.3.cmml" xref="S5.Ex1.m1.8.8.2.2"><apply id="S5.Ex1.m1.8.8.2.2.1.cmml" xref="S5.Ex1.m1.8.8.2.2.1"><times id="S5.Ex1.m1.8.8.2.2.1.1.cmml" xref="S5.Ex1.m1.8.8.2.2.1.1"></times><ci id="S5.Ex1.m1.8.8.2.2.1.2.cmml" xref="S5.Ex1.m1.8.8.2.2.1.2">ğ‘”</ci><ci id="S5.Ex1.m1.8.8.2.2.1.3.cmml" xref="S5.Ex1.m1.8.8.2.2.1.3">ğ‘™</ci><ci id="S5.Ex1.m1.8.8.2.2.1.4.cmml" xref="S5.Ex1.m1.8.8.2.2.1.4">ğ‘œ</ci><ci id="S5.Ex1.m1.8.8.2.2.1.5.cmml" xref="S5.Ex1.m1.8.8.2.2.1.5">ğ‘</ci></apply><ci id="S5.Ex1.m1.7.7.1.1.cmml" xref="S5.Ex1.m1.7.7.1.1">ğ‘’</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex1.m1.9c">\mu_{glob,i}=\mu_{glob,s}-\frac{1}{T-T_{0}}(\mu_{glob,s}-\mu_{glob,e})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S5.SS3.p4" class="ltx_para">
<p id="S5.SS3.p4.2" class="ltx_p">To simplify our experiments, we assume that no device will reject the serverâ€™s request, and we will not encounter communication failures. In other words, all devices will participate in each communication round. In our default setting, we set the number of devices to 10. We utilized <math id="S5.SS3.p4.1.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S5.SS3.p4.1.m1.1a"><mn id="S5.SS3.p4.1.m1.1.1" xref="S5.SS3.p4.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.1.m1.1b"><cn type="integer" id="S5.SS3.p4.1.m1.1.1.cmml" xref="S5.SS3.p4.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.1.m1.1c">1</annotation></semantics></math> GPU and <math id="S5.SS3.p4.2.m2.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S5.SS3.p4.2.m2.1a"><mn id="S5.SS3.p4.2.m2.1.1" xref="S5.SS3.p4.2.m2.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.2.m2.1b"><cn type="integer" id="S5.SS3.p4.2.m2.1.1.cmml" xref="S5.SS3.p4.2.m2.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.2.m2.1c">10</annotation></semantics></math> CPUs for each experimental setting. The training took less than 1 day to finish for all the experiments.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Results</span>
</h2>

<figure id="S6.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S6.T1.2.1.1" class="ltx_text" style="font-size:90%;">TABLE I</span>: </span><span id="S6.T1.3.2" class="ltx_text" style="font-size:90%;">Overall performance and efficiency for different methods.</span></figcaption>
<table id="S6.T1.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S6.T1.4.1.1" class="ltx_tr">
<th id="S6.T1.4.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S6.T1.4.1.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Method</span></th>
<th id="S6.T1.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S6.T1.4.1.1.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Top-1 Accuracy</span></th>
<th id="S6.T1.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S6.T1.4.1.1.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Num of Comms (0.68 Acc)</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S6.T1.4.2.1" class="ltx_tr">
<th id="S6.T1.4.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S6.T1.4.2.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">FedAvg</span></th>
<td id="S6.T1.4.2.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S6.T1.4.2.1.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.658</span></td>
<td id="S6.T1.4.2.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S6.T1.4.2.1.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">more than 100</span></td>
</tr>
<tr id="S6.T1.4.3.2" class="ltx_tr">
<th id="S6.T1.4.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S6.T1.4.3.2.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">MOON</span></th>
<td id="S6.T1.4.3.2.2" class="ltx_td ltx_align_center"><span id="S6.T1.4.3.2.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.686</span></td>
<td id="S6.T1.4.3.2.3" class="ltx_td ltx_align_center"><span id="S6.T1.4.3.2.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">61</span></td>
</tr>
<tr id="S6.T1.4.4.3" class="ltx_tr">
<th id="S6.T1.4.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b"><span id="S6.T1.4.4.3.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">FedSSC</span></th>
<td id="S6.T1.4.4.3.2" class="ltx_td ltx_align_center ltx_border_b"><span id="S6.T1.4.4.3.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.693</span></td>
<td id="S6.T1.4.4.3.3" class="ltx_td ltx_align_center ltx_border_b"><span id="S6.T1.4.4.3.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">41</span></td>
</tr>
</tbody>
</table>
</figure>
<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S6.SS1.4.1.1" class="ltx_text">VI-A</span> </span><span id="S6.SS1.5.2" class="ltx_text ltx_font_italic">Overall Performance</span>
</h3>

<div id="S6.SS1.p1" class="ltx_para">
<p id="S6.SS1.p1.6" class="ltx_p">In the default setting, our method <span id="S6.SS1.p1.6.1" class="ltx_text ltx_font_smallcaps">FedSSC</span> outperforms <span id="S6.SS1.p1.6.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> by <math id="S6.SS1.p1.1.m1.1" class="ltx_Math" alttext="3.4\%" display="inline"><semantics id="S6.SS1.p1.1.m1.1a"><mrow id="S6.SS1.p1.1.m1.1.1" xref="S6.SS1.p1.1.m1.1.1.cmml"><mn id="S6.SS1.p1.1.m1.1.1.2" xref="S6.SS1.p1.1.m1.1.1.2.cmml">3.4</mn><mo id="S6.SS1.p1.1.m1.1.1.1" xref="S6.SS1.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.1.m1.1b"><apply id="S6.SS1.p1.1.m1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1"><csymbol cd="latexml" id="S6.SS1.p1.1.m1.1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1.1">percent</csymbol><cn type="float" id="S6.SS1.p1.1.m1.1.1.2.cmml" xref="S6.SS1.p1.1.m1.1.1.2">3.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.1.m1.1c">3.4\%</annotation></semantics></math> and <span id="S6.SS1.p1.6.3" class="ltx_text ltx_font_smallcaps">MOON</span> by <math id="S6.SS1.p1.2.m2.1" class="ltx_Math" alttext="0.7\%" display="inline"><semantics id="S6.SS1.p1.2.m2.1a"><mrow id="S6.SS1.p1.2.m2.1.1" xref="S6.SS1.p1.2.m2.1.1.cmml"><mn id="S6.SS1.p1.2.m2.1.1.2" xref="S6.SS1.p1.2.m2.1.1.2.cmml">0.7</mn><mo id="S6.SS1.p1.2.m2.1.1.1" xref="S6.SS1.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.2.m2.1b"><apply id="S6.SS1.p1.2.m2.1.1.cmml" xref="S6.SS1.p1.2.m2.1.1"><csymbol cd="latexml" id="S6.SS1.p1.2.m2.1.1.1.cmml" xref="S6.SS1.p1.2.m2.1.1.1">percent</csymbol><cn type="float" id="S6.SS1.p1.2.m2.1.1.2.cmml" xref="S6.SS1.p1.2.m2.1.1.2">0.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.2.m2.1c">0.7\%</annotation></semantics></math>. The improvement compared to <span id="S6.SS1.p1.6.4" class="ltx_text ltx_font_smallcaps">FedAvg</span> is significant, while the increase from <span id="S6.SS1.p1.6.5" class="ltx_text ltx_font_smallcaps">MOON</span> is smaller. However, <span id="S6.SS1.p1.6.6" class="ltx_text ltx_font_smallcaps">FedSSC</span> reaches the <math id="S6.SS1.p1.3.m3.1" class="ltx_Math" alttext="68\%" display="inline"><semantics id="S6.SS1.p1.3.m3.1a"><mrow id="S6.SS1.p1.3.m3.1.1" xref="S6.SS1.p1.3.m3.1.1.cmml"><mn id="S6.SS1.p1.3.m3.1.1.2" xref="S6.SS1.p1.3.m3.1.1.2.cmml">68</mn><mo id="S6.SS1.p1.3.m3.1.1.1" xref="S6.SS1.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.3.m3.1b"><apply id="S6.SS1.p1.3.m3.1.1.cmml" xref="S6.SS1.p1.3.m3.1.1"><csymbol cd="latexml" id="S6.SS1.p1.3.m3.1.1.1.cmml" xref="S6.SS1.p1.3.m3.1.1.1">percent</csymbol><cn type="integer" id="S6.SS1.p1.3.m3.1.1.2.cmml" xref="S6.SS1.p1.3.m3.1.1.2">68</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.3.m3.1c">68\%</annotation></semantics></math> level of accuracy at just <math id="S6.SS1.p1.4.m4.1" class="ltx_Math" alttext="41" display="inline"><semantics id="S6.SS1.p1.4.m4.1a"><mn id="S6.SS1.p1.4.m4.1.1" xref="S6.SS1.p1.4.m4.1.1.cmml">41</mn><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.4.m4.1b"><cn type="integer" id="S6.SS1.p1.4.m4.1.1.cmml" xref="S6.SS1.p1.4.m4.1.1">41</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.4.m4.1c">41</annotation></semantics></math> communication rounds, while <span id="S6.SS1.p1.6.7" class="ltx_text ltx_font_smallcaps">MOON</span> needs <math id="S6.SS1.p1.5.m5.1" class="ltx_Math" alttext="61" display="inline"><semantics id="S6.SS1.p1.5.m5.1a"><mn id="S6.SS1.p1.5.m5.1.1" xref="S6.SS1.p1.5.m5.1.1.cmml">61</mn><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.5.m5.1b"><cn type="integer" id="S6.SS1.p1.5.m5.1.1.cmml" xref="S6.SS1.p1.5.m5.1.1">61</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.5.m5.1c">61</annotation></semantics></math> rounds, and <span id="S6.SS1.p1.6.8" class="ltx_text ltx_font_smallcaps">FedAvg</span> cannot reach it within <math id="S6.SS1.p1.6.m6.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S6.SS1.p1.6.m6.1a"><mn id="S6.SS1.p1.6.m6.1.1" xref="S6.SS1.p1.6.m6.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.6.m6.1b"><cn type="integer" id="S6.SS1.p1.6.m6.1.1.cmml" xref="S6.SS1.p1.6.m6.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.6.m6.1c">100</annotation></semantics></math> rounds. In summary, our approach performs better and is more efficient than previous methods.</p>
</div>
<figure id="S6.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2301.05797/assets/figs/Different_Loss_Functions.png" id="S6.F2.sf1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="538" height="524" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F2.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S6.F2.sf1.3.2" class="ltx_text" style="font-size:90%;">Losses w/o model contrastive learning</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2301.05797/assets/figs/FedSCC_vsFedSCC_vsFedProc.png" id="S6.F2.sf2.g1" class="ltx_graphics ltx_centering ltx_img_square" width="538" height="524" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F2.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S6.F2.sf2.3.2" class="ltx_text" style="font-size:90%;">Losses w/ local contrastive learning</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F2.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2301.05797/assets/figs/Experiments_varied_global_representations.png" id="S6.F2.sf3.g1" class="ltx_graphics ltx_centering ltx_img_square" width="577" height="520" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F2.sf3.4.2.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S6.F2.sf3.2.1" class="ltx_text" style="font-size:90%;">Different <math id="S6.F2.sf3.2.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S6.F2.sf3.2.1.m1.1b"><mi id="S6.F2.sf3.2.1.m1.1.1" xref="S6.F2.sf3.2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S6.F2.sf3.2.1.m1.1c"><ci id="S6.F2.sf3.2.1.m1.1.1.cmml" xref="S6.F2.sf3.2.1.m1.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.F2.sf3.2.1.m1.1d">k</annotation></semantics></math> of presentations shared</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S6.F2.3.2" class="ltx_text" style="font-size:90%;">Performance comparison for alternative loss components, where the blue line is our proposed approach. </span></figcaption>
</figure>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S6.SS2.4.1.1" class="ltx_text">VI-B</span> </span><span id="S6.SS2.5.2" class="ltx_text ltx_font_italic">Different Non-IID Scenarios</span>
</h3>

<div id="S6.SS2.p1" class="ltx_para">
<p id="S6.SS2.p1.4" class="ltx_p">To better evaluate <span id="S6.SS2.p1.4.1" class="ltx_text ltx_font_smallcaps">FedSSC</span>, we compared its performance with other approaches under various non-IID scenarios, including <math id="S6.SS2.p1.1.m1.4" class="ltx_Math" alttext="\beta\in\{0.2,0.5,1,5\}" display="inline"><semantics id="S6.SS2.p1.1.m1.4a"><mrow id="S6.SS2.p1.1.m1.4.5" xref="S6.SS2.p1.1.m1.4.5.cmml"><mi id="S6.SS2.p1.1.m1.4.5.2" xref="S6.SS2.p1.1.m1.4.5.2.cmml">Î²</mi><mo id="S6.SS2.p1.1.m1.4.5.1" xref="S6.SS2.p1.1.m1.4.5.1.cmml">âˆˆ</mo><mrow id="S6.SS2.p1.1.m1.4.5.3.2" xref="S6.SS2.p1.1.m1.4.5.3.1.cmml"><mo stretchy="false" id="S6.SS2.p1.1.m1.4.5.3.2.1" xref="S6.SS2.p1.1.m1.4.5.3.1.cmml">{</mo><mn id="S6.SS2.p1.1.m1.1.1" xref="S6.SS2.p1.1.m1.1.1.cmml">0.2</mn><mo id="S6.SS2.p1.1.m1.4.5.3.2.2" xref="S6.SS2.p1.1.m1.4.5.3.1.cmml">,</mo><mn id="S6.SS2.p1.1.m1.2.2" xref="S6.SS2.p1.1.m1.2.2.cmml">0.5</mn><mo id="S6.SS2.p1.1.m1.4.5.3.2.3" xref="S6.SS2.p1.1.m1.4.5.3.1.cmml">,</mo><mn id="S6.SS2.p1.1.m1.3.3" xref="S6.SS2.p1.1.m1.3.3.cmml">1</mn><mo id="S6.SS2.p1.1.m1.4.5.3.2.4" xref="S6.SS2.p1.1.m1.4.5.3.1.cmml">,</mo><mn id="S6.SS2.p1.1.m1.4.4" xref="S6.SS2.p1.1.m1.4.4.cmml">5</mn><mo stretchy="false" id="S6.SS2.p1.1.m1.4.5.3.2.5" xref="S6.SS2.p1.1.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.1.m1.4b"><apply id="S6.SS2.p1.1.m1.4.5.cmml" xref="S6.SS2.p1.1.m1.4.5"><in id="S6.SS2.p1.1.m1.4.5.1.cmml" xref="S6.SS2.p1.1.m1.4.5.1"></in><ci id="S6.SS2.p1.1.m1.4.5.2.cmml" xref="S6.SS2.p1.1.m1.4.5.2">ğ›½</ci><set id="S6.SS2.p1.1.m1.4.5.3.1.cmml" xref="S6.SS2.p1.1.m1.4.5.3.2"><cn type="float" id="S6.SS2.p1.1.m1.1.1.cmml" xref="S6.SS2.p1.1.m1.1.1">0.2</cn><cn type="float" id="S6.SS2.p1.1.m1.2.2.cmml" xref="S6.SS2.p1.1.m1.2.2">0.5</cn><cn type="integer" id="S6.SS2.p1.1.m1.3.3.cmml" xref="S6.SS2.p1.1.m1.3.3">1</cn><cn type="integer" id="S6.SS2.p1.1.m1.4.4.cmml" xref="S6.SS2.p1.1.m1.4.4">5</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.1.m1.4c">\beta\in\{0.2,0.5,1,5\}</annotation></semantics></math>. From Figure <a href="#S5.F1" title="Figure 1 â€£ V-A Dataset â€£ V Work Performed â€£ FedSSC: Shared Supervised-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, we can see that as we increase <math id="S6.SS2.p1.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S6.SS2.p1.2.m2.1a"><mi id="S6.SS2.p1.2.m2.1.1" xref="S6.SS2.p1.2.m2.1.1.cmml">Î²</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.2.m2.1b"><ci id="S6.SS2.p1.2.m2.1.1.cmml" xref="S6.SS2.p1.2.m2.1.1">ğ›½</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.2.m2.1c">\beta</annotation></semantics></math>, the differences between the methods decrease since the heterogeneity is less severe. For both <math id="S6.SS2.p1.3.m3.1" class="ltx_Math" alttext="\beta=0.2" display="inline"><semantics id="S6.SS2.p1.3.m3.1a"><mrow id="S6.SS2.p1.3.m3.1.1" xref="S6.SS2.p1.3.m3.1.1.cmml"><mi id="S6.SS2.p1.3.m3.1.1.2" xref="S6.SS2.p1.3.m3.1.1.2.cmml">Î²</mi><mo id="S6.SS2.p1.3.m3.1.1.1" xref="S6.SS2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S6.SS2.p1.3.m3.1.1.3" xref="S6.SS2.p1.3.m3.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.3.m3.1b"><apply id="S6.SS2.p1.3.m3.1.1.cmml" xref="S6.SS2.p1.3.m3.1.1"><eq id="S6.SS2.p1.3.m3.1.1.1.cmml" xref="S6.SS2.p1.3.m3.1.1.1"></eq><ci id="S6.SS2.p1.3.m3.1.1.2.cmml" xref="S6.SS2.p1.3.m3.1.1.2">ğ›½</ci><cn type="float" id="S6.SS2.p1.3.m3.1.1.3.cmml" xref="S6.SS2.p1.3.m3.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.3.m3.1c">\beta=0.2</annotation></semantics></math> and <math id="S6.SS2.p1.4.m4.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S6.SS2.p1.4.m4.1a"><mn id="S6.SS2.p1.4.m4.1.1" xref="S6.SS2.p1.4.m4.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.4.m4.1b"><cn type="float" id="S6.SS2.p1.4.m4.1.1.cmml" xref="S6.SS2.p1.4.m4.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.4.m4.1c">0.5</annotation></semantics></math>, <span id="S6.SS2.p1.4.2" class="ltx_text ltx_font_smallcaps">FedSSC</span> slightly outperforms <span id="S6.SS2.p1.4.3" class="ltx_text ltx_font_smallcaps">MOON</span> and is significantly better than <span id="S6.SS2.p1.4.4" class="ltx_text ltx_font_smallcaps">FedAvg</span>. Also, it converges faster than the others.</p>
</div>
</section>
<section id="S6.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S6.SS3.4.1.1" class="ltx_text">VI-C</span> </span><span id="S6.SS3.5.2" class="ltx_text ltx_font_italic">Alternative Loss</span>
</h3>

<div id="S6.SS3.p1" class="ltx_para">
<p id="S6.SS3.p1.1" class="ltx_p">Beyond our proposed loss, we did extensive experiments with other variants that could potentially help us learn a better representation. In particular, we tried to use two-stage contrastive learning, where we first train the encoder for certain rounds while freezing the classifier in the first 90 rounds and then train the classifier while freezing the encoder in the last 10 rounds. Furthermore, we experimented with another alternative by adding negative pairs and positive pairs from the same local batch. Figure <a href="#S6.F2.sf1" title="In Figure 2 â€£ VI-A Overall Performance â€£ VI Results â€£ FedSSC: Shared Supervised-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(a)</span></a> shows that our proposed approach outperforms the alternatives a lot, especially in the earlier rounds. This is understandable because learning encoder with only supervised contrastive learning would take longer rounds to converge than using supervised classification loss. However, it could potentially outperform our current approach if we train it for more rounds.</p>
</div>
<div id="S6.SS3.p2" class="ltx_para">
<p id="S6.SS3.p2.8" class="ltx_p">Furthermore, we attempted to remove the <math id="S6.SS3.p2.1.m1.1" class="ltx_Math" alttext="l_{MOON}" display="inline"><semantics id="S6.SS3.p2.1.m1.1a"><msub id="S6.SS3.p2.1.m1.1.1" xref="S6.SS3.p2.1.m1.1.1.cmml"><mi id="S6.SS3.p2.1.m1.1.1.2" xref="S6.SS3.p2.1.m1.1.1.2.cmml">l</mi><mrow id="S6.SS3.p2.1.m1.1.1.3" xref="S6.SS3.p2.1.m1.1.1.3.cmml"><mi id="S6.SS3.p2.1.m1.1.1.3.2" xref="S6.SS3.p2.1.m1.1.1.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p2.1.m1.1.1.3.1" xref="S6.SS3.p2.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S6.SS3.p2.1.m1.1.1.3.3" xref="S6.SS3.p2.1.m1.1.1.3.3.cmml">O</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p2.1.m1.1.1.3.1a" xref="S6.SS3.p2.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S6.SS3.p2.1.m1.1.1.3.4" xref="S6.SS3.p2.1.m1.1.1.3.4.cmml">O</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p2.1.m1.1.1.3.1b" xref="S6.SS3.p2.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S6.SS3.p2.1.m1.1.1.3.5" xref="S6.SS3.p2.1.m1.1.1.3.5.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.1.m1.1b"><apply id="S6.SS3.p2.1.m1.1.1.cmml" xref="S6.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS3.p2.1.m1.1.1.1.cmml" xref="S6.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S6.SS3.p2.1.m1.1.1.2.cmml" xref="S6.SS3.p2.1.m1.1.1.2">ğ‘™</ci><apply id="S6.SS3.p2.1.m1.1.1.3.cmml" xref="S6.SS3.p2.1.m1.1.1.3"><times id="S6.SS3.p2.1.m1.1.1.3.1.cmml" xref="S6.SS3.p2.1.m1.1.1.3.1"></times><ci id="S6.SS3.p2.1.m1.1.1.3.2.cmml" xref="S6.SS3.p2.1.m1.1.1.3.2">ğ‘€</ci><ci id="S6.SS3.p2.1.m1.1.1.3.3.cmml" xref="S6.SS3.p2.1.m1.1.1.3.3">ğ‘‚</ci><ci id="S6.SS3.p2.1.m1.1.1.3.4.cmml" xref="S6.SS3.p2.1.m1.1.1.3.4">ğ‘‚</ci><ci id="S6.SS3.p2.1.m1.1.1.3.5.cmml" xref="S6.SS3.p2.1.m1.1.1.3.5">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.1.m1.1c">l_{MOON}</annotation></semantics></math> completely by setting <math id="S6.SS3.p2.2.m2.1" class="ltx_Math" alttext="\mu_{MOON}=0" display="inline"><semantics id="S6.SS3.p2.2.m2.1a"><mrow id="S6.SS3.p2.2.m2.1.1" xref="S6.SS3.p2.2.m2.1.1.cmml"><msub id="S6.SS3.p2.2.m2.1.1.2" xref="S6.SS3.p2.2.m2.1.1.2.cmml"><mi id="S6.SS3.p2.2.m2.1.1.2.2" xref="S6.SS3.p2.2.m2.1.1.2.2.cmml">Î¼</mi><mrow id="S6.SS3.p2.2.m2.1.1.2.3" xref="S6.SS3.p2.2.m2.1.1.2.3.cmml"><mi id="S6.SS3.p2.2.m2.1.1.2.3.2" xref="S6.SS3.p2.2.m2.1.1.2.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p2.2.m2.1.1.2.3.1" xref="S6.SS3.p2.2.m2.1.1.2.3.1.cmml">â€‹</mo><mi id="S6.SS3.p2.2.m2.1.1.2.3.3" xref="S6.SS3.p2.2.m2.1.1.2.3.3.cmml">O</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p2.2.m2.1.1.2.3.1a" xref="S6.SS3.p2.2.m2.1.1.2.3.1.cmml">â€‹</mo><mi id="S6.SS3.p2.2.m2.1.1.2.3.4" xref="S6.SS3.p2.2.m2.1.1.2.3.4.cmml">O</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p2.2.m2.1.1.2.3.1b" xref="S6.SS3.p2.2.m2.1.1.2.3.1.cmml">â€‹</mo><mi id="S6.SS3.p2.2.m2.1.1.2.3.5" xref="S6.SS3.p2.2.m2.1.1.2.3.5.cmml">N</mi></mrow></msub><mo id="S6.SS3.p2.2.m2.1.1.1" xref="S6.SS3.p2.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS3.p2.2.m2.1.1.3" xref="S6.SS3.p2.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.2.m2.1b"><apply id="S6.SS3.p2.2.m2.1.1.cmml" xref="S6.SS3.p2.2.m2.1.1"><eq id="S6.SS3.p2.2.m2.1.1.1.cmml" xref="S6.SS3.p2.2.m2.1.1.1"></eq><apply id="S6.SS3.p2.2.m2.1.1.2.cmml" xref="S6.SS3.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S6.SS3.p2.2.m2.1.1.2.1.cmml" xref="S6.SS3.p2.2.m2.1.1.2">subscript</csymbol><ci id="S6.SS3.p2.2.m2.1.1.2.2.cmml" xref="S6.SS3.p2.2.m2.1.1.2.2">ğœ‡</ci><apply id="S6.SS3.p2.2.m2.1.1.2.3.cmml" xref="S6.SS3.p2.2.m2.1.1.2.3"><times id="S6.SS3.p2.2.m2.1.1.2.3.1.cmml" xref="S6.SS3.p2.2.m2.1.1.2.3.1"></times><ci id="S6.SS3.p2.2.m2.1.1.2.3.2.cmml" xref="S6.SS3.p2.2.m2.1.1.2.3.2">ğ‘€</ci><ci id="S6.SS3.p2.2.m2.1.1.2.3.3.cmml" xref="S6.SS3.p2.2.m2.1.1.2.3.3">ğ‘‚</ci><ci id="S6.SS3.p2.2.m2.1.1.2.3.4.cmml" xref="S6.SS3.p2.2.m2.1.1.2.3.4">ğ‘‚</ci><ci id="S6.SS3.p2.2.m2.1.1.2.3.5.cmml" xref="S6.SS3.p2.2.m2.1.1.2.3.5">ğ‘</ci></apply></apply><cn type="integer" id="S6.SS3.p2.2.m2.1.1.3.cmml" xref="S6.SS3.p2.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.2.m2.1c">\mu_{MOON}=0</annotation></semantics></math> and it achieves the same level of accuracy. From Figure <a href="#S6.F2.sf2" title="In Figure 2 â€£ VI-A Overall Performance â€£ VI Results â€£ FedSSC: Shared Supervised-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(b)</span></a>, we can see that <math id="S6.SS3.p2.3.m3.1" class="ltx_Math" alttext="l_{MOON}" display="inline"><semantics id="S6.SS3.p2.3.m3.1a"><msub id="S6.SS3.p2.3.m3.1.1" xref="S6.SS3.p2.3.m3.1.1.cmml"><mi id="S6.SS3.p2.3.m3.1.1.2" xref="S6.SS3.p2.3.m3.1.1.2.cmml">l</mi><mrow id="S6.SS3.p2.3.m3.1.1.3" xref="S6.SS3.p2.3.m3.1.1.3.cmml"><mi id="S6.SS3.p2.3.m3.1.1.3.2" xref="S6.SS3.p2.3.m3.1.1.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p2.3.m3.1.1.3.1" xref="S6.SS3.p2.3.m3.1.1.3.1.cmml">â€‹</mo><mi id="S6.SS3.p2.3.m3.1.1.3.3" xref="S6.SS3.p2.3.m3.1.1.3.3.cmml">O</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p2.3.m3.1.1.3.1a" xref="S6.SS3.p2.3.m3.1.1.3.1.cmml">â€‹</mo><mi id="S6.SS3.p2.3.m3.1.1.3.4" xref="S6.SS3.p2.3.m3.1.1.3.4.cmml">O</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p2.3.m3.1.1.3.1b" xref="S6.SS3.p2.3.m3.1.1.3.1.cmml">â€‹</mo><mi id="S6.SS3.p2.3.m3.1.1.3.5" xref="S6.SS3.p2.3.m3.1.1.3.5.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.3.m3.1b"><apply id="S6.SS3.p2.3.m3.1.1.cmml" xref="S6.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S6.SS3.p2.3.m3.1.1.1.cmml" xref="S6.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S6.SS3.p2.3.m3.1.1.2.cmml" xref="S6.SS3.p2.3.m3.1.1.2">ğ‘™</ci><apply id="S6.SS3.p2.3.m3.1.1.3.cmml" xref="S6.SS3.p2.3.m3.1.1.3"><times id="S6.SS3.p2.3.m3.1.1.3.1.cmml" xref="S6.SS3.p2.3.m3.1.1.3.1"></times><ci id="S6.SS3.p2.3.m3.1.1.3.2.cmml" xref="S6.SS3.p2.3.m3.1.1.3.2">ğ‘€</ci><ci id="S6.SS3.p2.3.m3.1.1.3.3.cmml" xref="S6.SS3.p2.3.m3.1.1.3.3">ğ‘‚</ci><ci id="S6.SS3.p2.3.m3.1.1.3.4.cmml" xref="S6.SS3.p2.3.m3.1.1.3.4">ğ‘‚</ci><ci id="S6.SS3.p2.3.m3.1.1.3.5.cmml" xref="S6.SS3.p2.3.m3.1.1.3.5">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.3.m3.1c">l_{MOON}</annotation></semantics></math> takes an important role. If we remove it, the performance will drop even if we share representations from all devices (i.e., <span id="S6.SS3.p2.8.1" class="ltx_text ltx_font_smallcaps">FedProc</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>). Moreover, we experimented with different numbers of shared representations <math id="S6.SS3.p2.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S6.SS3.p2.4.m4.1a"><mi id="S6.SS3.p2.4.m4.1.1" xref="S6.SS3.p2.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.4.m4.1b"><ci id="S6.SS3.p2.4.m4.1.1.cmml" xref="S6.SS3.p2.4.m4.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.4.m4.1c">k</annotation></semantics></math> with the default <math id="S6.SS3.p2.5.m5.1" class="ltx_Math" alttext="\mu_{MOON}=0" display="inline"><semantics id="S6.SS3.p2.5.m5.1a"><mrow id="S6.SS3.p2.5.m5.1.1" xref="S6.SS3.p2.5.m5.1.1.cmml"><msub id="S6.SS3.p2.5.m5.1.1.2" xref="S6.SS3.p2.5.m5.1.1.2.cmml"><mi id="S6.SS3.p2.5.m5.1.1.2.2" xref="S6.SS3.p2.5.m5.1.1.2.2.cmml">Î¼</mi><mrow id="S6.SS3.p2.5.m5.1.1.2.3" xref="S6.SS3.p2.5.m5.1.1.2.3.cmml"><mi id="S6.SS3.p2.5.m5.1.1.2.3.2" xref="S6.SS3.p2.5.m5.1.1.2.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p2.5.m5.1.1.2.3.1" xref="S6.SS3.p2.5.m5.1.1.2.3.1.cmml">â€‹</mo><mi id="S6.SS3.p2.5.m5.1.1.2.3.3" xref="S6.SS3.p2.5.m5.1.1.2.3.3.cmml">O</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p2.5.m5.1.1.2.3.1a" xref="S6.SS3.p2.5.m5.1.1.2.3.1.cmml">â€‹</mo><mi id="S6.SS3.p2.5.m5.1.1.2.3.4" xref="S6.SS3.p2.5.m5.1.1.2.3.4.cmml">O</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p2.5.m5.1.1.2.3.1b" xref="S6.SS3.p2.5.m5.1.1.2.3.1.cmml">â€‹</mo><mi id="S6.SS3.p2.5.m5.1.1.2.3.5" xref="S6.SS3.p2.5.m5.1.1.2.3.5.cmml">N</mi></mrow></msub><mo id="S6.SS3.p2.5.m5.1.1.1" xref="S6.SS3.p2.5.m5.1.1.1.cmml">=</mo><mn id="S6.SS3.p2.5.m5.1.1.3" xref="S6.SS3.p2.5.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.5.m5.1b"><apply id="S6.SS3.p2.5.m5.1.1.cmml" xref="S6.SS3.p2.5.m5.1.1"><eq id="S6.SS3.p2.5.m5.1.1.1.cmml" xref="S6.SS3.p2.5.m5.1.1.1"></eq><apply id="S6.SS3.p2.5.m5.1.1.2.cmml" xref="S6.SS3.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S6.SS3.p2.5.m5.1.1.2.1.cmml" xref="S6.SS3.p2.5.m5.1.1.2">subscript</csymbol><ci id="S6.SS3.p2.5.m5.1.1.2.2.cmml" xref="S6.SS3.p2.5.m5.1.1.2.2">ğœ‡</ci><apply id="S6.SS3.p2.5.m5.1.1.2.3.cmml" xref="S6.SS3.p2.5.m5.1.1.2.3"><times id="S6.SS3.p2.5.m5.1.1.2.3.1.cmml" xref="S6.SS3.p2.5.m5.1.1.2.3.1"></times><ci id="S6.SS3.p2.5.m5.1.1.2.3.2.cmml" xref="S6.SS3.p2.5.m5.1.1.2.3.2">ğ‘€</ci><ci id="S6.SS3.p2.5.m5.1.1.2.3.3.cmml" xref="S6.SS3.p2.5.m5.1.1.2.3.3">ğ‘‚</ci><ci id="S6.SS3.p2.5.m5.1.1.2.3.4.cmml" xref="S6.SS3.p2.5.m5.1.1.2.3.4">ğ‘‚</ci><ci id="S6.SS3.p2.5.m5.1.1.2.3.5.cmml" xref="S6.SS3.p2.5.m5.1.1.2.3.5">ğ‘</ci></apply></apply><cn type="integer" id="S6.SS3.p2.5.m5.1.1.3.cmml" xref="S6.SS3.p2.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.5.m5.1c">\mu_{MOON}=0</annotation></semantics></math>. Figure <a href="#S6.F2.sf3" title="In Figure 2 â€£ VI-A Overall Performance â€£ VI Results â€£ FedSSC: Shared Supervised-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(c)</span></a> shows that sharing representations does boost the performance, although increasing <math id="S6.SS3.p2.6.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S6.SS3.p2.6.m6.1a"><mi id="S6.SS3.p2.6.m6.1.1" xref="S6.SS3.p2.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.6.m6.1b"><ci id="S6.SS3.p2.6.m6.1.1.cmml" xref="S6.SS3.p2.6.m6.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.6.m6.1c">k</annotation></semantics></math> doesnâ€™t make a big difference. Therefore, the experimental results demonstrate that <math id="S6.SS3.p2.7.m7.1" class="ltx_Math" alttext="l_{MOON}" display="inline"><semantics id="S6.SS3.p2.7.m7.1a"><msub id="S6.SS3.p2.7.m7.1.1" xref="S6.SS3.p2.7.m7.1.1.cmml"><mi id="S6.SS3.p2.7.m7.1.1.2" xref="S6.SS3.p2.7.m7.1.1.2.cmml">l</mi><mrow id="S6.SS3.p2.7.m7.1.1.3" xref="S6.SS3.p2.7.m7.1.1.3.cmml"><mi id="S6.SS3.p2.7.m7.1.1.3.2" xref="S6.SS3.p2.7.m7.1.1.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p2.7.m7.1.1.3.1" xref="S6.SS3.p2.7.m7.1.1.3.1.cmml">â€‹</mo><mi id="S6.SS3.p2.7.m7.1.1.3.3" xref="S6.SS3.p2.7.m7.1.1.3.3.cmml">O</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p2.7.m7.1.1.3.1a" xref="S6.SS3.p2.7.m7.1.1.3.1.cmml">â€‹</mo><mi id="S6.SS3.p2.7.m7.1.1.3.4" xref="S6.SS3.p2.7.m7.1.1.3.4.cmml">O</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p2.7.m7.1.1.3.1b" xref="S6.SS3.p2.7.m7.1.1.3.1.cmml">â€‹</mo><mi id="S6.SS3.p2.7.m7.1.1.3.5" xref="S6.SS3.p2.7.m7.1.1.3.5.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.7.m7.1b"><apply id="S6.SS3.p2.7.m7.1.1.cmml" xref="S6.SS3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S6.SS3.p2.7.m7.1.1.1.cmml" xref="S6.SS3.p2.7.m7.1.1">subscript</csymbol><ci id="S6.SS3.p2.7.m7.1.1.2.cmml" xref="S6.SS3.p2.7.m7.1.1.2">ğ‘™</ci><apply id="S6.SS3.p2.7.m7.1.1.3.cmml" xref="S6.SS3.p2.7.m7.1.1.3"><times id="S6.SS3.p2.7.m7.1.1.3.1.cmml" xref="S6.SS3.p2.7.m7.1.1.3.1"></times><ci id="S6.SS3.p2.7.m7.1.1.3.2.cmml" xref="S6.SS3.p2.7.m7.1.1.3.2">ğ‘€</ci><ci id="S6.SS3.p2.7.m7.1.1.3.3.cmml" xref="S6.SS3.p2.7.m7.1.1.3.3">ğ‘‚</ci><ci id="S6.SS3.p2.7.m7.1.1.3.4.cmml" xref="S6.SS3.p2.7.m7.1.1.3.4">ğ‘‚</ci><ci id="S6.SS3.p2.7.m7.1.1.3.5.cmml" xref="S6.SS3.p2.7.m7.1.1.3.5">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.7.m7.1c">l_{MOON}</annotation></semantics></math> and <math id="S6.SS3.p2.8.m8.1" class="ltx_Math" alttext="l_{glob}" display="inline"><semantics id="S6.SS3.p2.8.m8.1a"><msub id="S6.SS3.p2.8.m8.1.1" xref="S6.SS3.p2.8.m8.1.1.cmml"><mi id="S6.SS3.p2.8.m8.1.1.2" xref="S6.SS3.p2.8.m8.1.1.2.cmml">l</mi><mrow id="S6.SS3.p2.8.m8.1.1.3" xref="S6.SS3.p2.8.m8.1.1.3.cmml"><mi id="S6.SS3.p2.8.m8.1.1.3.2" xref="S6.SS3.p2.8.m8.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p2.8.m8.1.1.3.1" xref="S6.SS3.p2.8.m8.1.1.3.1.cmml">â€‹</mo><mi id="S6.SS3.p2.8.m8.1.1.3.3" xref="S6.SS3.p2.8.m8.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p2.8.m8.1.1.3.1a" xref="S6.SS3.p2.8.m8.1.1.3.1.cmml">â€‹</mo><mi id="S6.SS3.p2.8.m8.1.1.3.4" xref="S6.SS3.p2.8.m8.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p2.8.m8.1.1.3.1b" xref="S6.SS3.p2.8.m8.1.1.3.1.cmml">â€‹</mo><mi id="S6.SS3.p2.8.m8.1.1.3.5" xref="S6.SS3.p2.8.m8.1.1.3.5.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.8.m8.1b"><apply id="S6.SS3.p2.8.m8.1.1.cmml" xref="S6.SS3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S6.SS3.p2.8.m8.1.1.1.cmml" xref="S6.SS3.p2.8.m8.1.1">subscript</csymbol><ci id="S6.SS3.p2.8.m8.1.1.2.cmml" xref="S6.SS3.p2.8.m8.1.1.2">ğ‘™</ci><apply id="S6.SS3.p2.8.m8.1.1.3.cmml" xref="S6.SS3.p2.8.m8.1.1.3"><times id="S6.SS3.p2.8.m8.1.1.3.1.cmml" xref="S6.SS3.p2.8.m8.1.1.3.1"></times><ci id="S6.SS3.p2.8.m8.1.1.3.2.cmml" xref="S6.SS3.p2.8.m8.1.1.3.2">ğ‘”</ci><ci id="S6.SS3.p2.8.m8.1.1.3.3.cmml" xref="S6.SS3.p2.8.m8.1.1.3.3">ğ‘™</ci><ci id="S6.SS3.p2.8.m8.1.1.3.4.cmml" xref="S6.SS3.p2.8.m8.1.1.3.4">ğ‘œ</ci><ci id="S6.SS3.p2.8.m8.1.1.3.5.cmml" xref="S6.SS3.p2.8.m8.1.1.3.5">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.8.m8.1c">l_{glob}</annotation></semantics></math> are complementary to each other.</p>
</div>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VII </span><span id="S7.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">Recently many methods have been proposed to improve model accuracy and data usage at a heterogeneous distribution environment, as it has long been a key problem for Federated Learning in many fields such as finance, medicine, and social media where participants donâ€™t want to share private data.</p>
</div>
<div id="S7.p2" class="ltx_para">
<p id="S7.p2.1" class="ltx_p"><span id="S7.p2.1.1" class="ltx_text ltx_font_bold">Federated Learning</span>
Based on the work of FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, many methods have been proposed to alleviate the heterogeneous distribution problem. FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> adds an extra regularization term to push together local model weights and global model weights. SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> method uses variance reduction to correct the heterogeneity during local training. SphereFed <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> makes use of a freezed classification head to increase the similarity between global and local feature space. Generally, most of the previous methods focus on bring together local and global models.</p>
</div>
<div id="S7.p3" class="ltx_para">
<p id="S7.p3.1" class="ltx_p"><span id="S7.p3.1.1" class="ltx_text ltx_font_bold">Contrastive learning.</span> Methods such as SimCLR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> and MOCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> have become promising self-supervised approaches in Computer Vision in recent years. BYOL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> and Simsiam<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> have extended the idea of contrastive learning to have zero negative samples, while SupCon <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> proposed a supervised contrastive learning approach.
some researchers have combined contrastive learning with federated learning to mitigate the heterogeneous distribution problem<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. Our approach is improved upon the idea of MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, where positive pair is the local representation and global representation of the same image, and the negative pair is set to be the current local representation and the local representation at the previous communication round.</p>
</div>
<div id="S7.p4" class="ltx_para">
<p id="S7.p4.1" class="ltx_p"><span id="S7.p4.1.1" class="ltx_text ltx_font_bold">Representation sharing</span>. Recently, representation sharing becomes another direction to solve the problem of heterogeneous data distribution. There are quite some research works dedicated in this direction, by sharing clientsâ€™ image-level or class-level representation with others. FedProc <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> proposed sharing both the local features and local model weights. The local features are averaged in a class-wise manner, which has achieved better performance than MOON or FedProx on CIFAR-10 or CIFAR-100. Another recent work, FedPCL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> applies individual-level feature sharing on MINIST dataset.</p>
</div>
</section>
<section id="S8" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VIII </span><span id="S8.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S8.p1" class="ltx_para">
<p id="S8.p1.1" class="ltx_p">In summary, our work proposes to utilize contrastive learning and representation sharing to mitigate the non-IID problem. The experiments show that our method is orthogonal to other federated learning methods, and can outperform state-of-the-art models in typical settings. Both the accuracy and convergence speed can be apparently raised. Admittedly, more experiments are needed to test the availability and performance of our method with different settings of neural network structures and datasets.</p>
</div>
</section>
<section id="S9" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IX </span><span id="S9.1.1" class="ltx_text ltx_font_smallcaps">Contribution Statement</span>
</h2>

<div id="S9.p1" class="ltx_para">
<p id="S9.p1.1" class="ltx_p">All four authors contributed equally to this work. All members participated fully in reviewing literatures, coming up with model ideas, coding different models, tuning hyperparameters and writing up the final report.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
L.Â Zhang, L.Â Shen, L.Â Ding, D.Â Tao, and L.-Y. Duan, â€œFine-tuning global model
via data-free knowledge distillation for non-iid federated learning,â€ in
<em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern
Recognition</em>, 2022, pp. 10â€‰174â€“10â€‰183.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Z.Â Zhu, J.Â Hong, and J.Â Zhou, â€œData-free knowledge distillation for
heterogeneous federated learning,â€ in <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">International Conference on
Machine Learning</em>.Â Â Â PMLR, 2021, pp.
12â€‰878â€“12â€‰889.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
T.Â Li, A.Â K. Sahu, A.Â Talwalkar, and V.Â Smith, â€œFederated learning:
Challenges, methods, and future directions,â€ <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing
Magazine</em>, vol.Â 37, no.Â 3, pp. 50â€“60, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Y.Â Chen, Z.Â Guan, J.Â Liu, W.Â Yang, and H.Â Wang, â€œAnomalous layer-dependent
lubrication on graphene-covered-substrate: Competition between adhesion and
plasticity,â€ <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Applied Surface Science</em>, p. 153762, 2022.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
W.Â Huang, M.Â Ye, and B.Â Du, â€œLearn from others and be yourself in
heterogeneous federated learning,â€ in <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF
Conference on Computer Vision and Pattern Recognition</em>, 2022, pp.
10â€‰143â€“10â€‰153.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
T.Â Chen, S.Â Kornblith, M.Â Norouzi, and G.Â E. Hinton, â€œA simple framework for
contrastive learning of visual representations,â€ <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol.
abs/2002.05709, 2020. [Online]. Available:
https://arxiv.org/abs/2002.05709

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
X.Â Chen and K.Â He, â€œExploring simple siamese representation learning,â€
<em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, vol. abs/2011.10566, 2021. [Online]. Available:
https://arxiv.org/pdf/2011.10566.pdf

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Q.Â Li, B.Â He, and D.Â Song, â€œModel-contrastive federated learning,â€
<em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/2103.16257, 2021. [Online]. Available:
https://arxiv.org/abs/2103.16257

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
H.Â B. McMahan, E.Â Moore, D.Â Ramage, and B.Â A. yÂ Arcas, â€œFederated learning of
deep networks using model averaging,â€ <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1602.05629,
2016. [Online]. Available: http://arxiv.org/abs/1602.05629

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
A.Â K. Sahu, T.Â Li, M.Â Sanjabi, M.Â Zaheer, A.Â Talwalkar, and V.Â Smith, â€œOn the
convergence of federated optimization in heterogeneous networks,â€
<em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1812.06127, 2018. [Online]. Available:
http://arxiv.org/abs/1812.06127

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
X.Â Mu, Y.Â Shen, K.Â Cheng, X.Â Geng, J.Â Fu, T.Â Zhang, and Z.Â Zhang, â€œFedproc:
Prototypical contrastive federated learning on non-iid data,â€ vol.
abs/2109.12273, 2021. [Online]. Available:
https://arxiv.org/abs/2109.12273

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
S.Â P. Karimireddy, S.Â Kale, M.Â Mohri, S.Â J. Reddi, S.Â U. Stich, and A.Â T.
Suresh, â€œScaffold: Stochastic controlled averaging for federated learning,â€
<em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">PMLR</em>, vol. abs/1910.06378, 2019. [Online]. Available:
https://arxiv.org/abs/21910.06378

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
X.Â Dong, S.Â Q. Zhang, A.Â Li, and H.Â Kung, â€œSpherefed: Hyperspherical federated
learning,â€ vol. abs/2207.09413, 2022. [Online]. Available:
https://arxiv.org/abs/2207.09413

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
K.Â He, H.Â Fan, Y.Â Wu, S.Â Xie, and R.Â Girshick, â€œMomentum contrast for
unsupervised visual representation learning,â€ <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, vol.
abs/1911.05722, 2020. [Online]. Available:
https://arxiv.org/abs/1911.05722

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
J.-B. Grill, F.Â Strub, F.Â AltchÃ©, C.Â Tallec, P.Â H. Richemond, E.Â Buchatskaya,
C.Â Doersch, B.Â A. Pires, Z.Â D. Guo, M.Â G. Azar, B.Â Piot, K.Â Kavukcuoglu,
R.Â Munos, and M.Â Valko, â€œBootstrap your own latent a new approach to
self-supervised learning,â€ vol. abs/2006.07733, 2020. [Online]. Available:
https://arxiv.org/abs/2006.07733

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
P.Â Khosla, P.Â Teterwak, C.Â Wang, A.Â Sarna, Y.Â Tian, P.Â Isola, A.Â Maschinot,
C.Â Liu, and D.Â Krishnan, â€œSupervised contrastive learning,â€ <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">NeurIPS
2020</em>, vol. abs/2004.11362, 2020. [Online]. Available:
https://arxiv.org/abs/2004.11362

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Y.Â Tan, G.Â Long, J.Â Ma, L.Â Liu, T.Â Zhou, and J.Â Jiang, â€œFederated learning
from pre-trained models: A contrastive learning approach,â€ vol.
abs/2209.10083, 2022. [Online]. Available:
https://arxiv.org/abs/2209.10083

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2301.05796" class="ar5iv-nav-button ar5iv-nav-button-prev">â—„</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2301.05797" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2301.05797">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2301.05797" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2301.05798" class="ar5iv-nav-button ar5iv-nav-button-next">â–º</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 06:49:15 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "Ã—";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
