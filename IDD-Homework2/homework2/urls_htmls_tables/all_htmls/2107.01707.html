<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2107.01707] Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning</title><meta property="og:description" content="Given the abundance and ease of access of personal data today, individual privacy has become of paramount importance, particularly in the healthcare domain. In this work, we aim to utilise patient data extracted from m…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2107.01707">

<!--Generated on Tue Mar 19 12:31:57 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Machine Learning,  ICML">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_pruned_first">
<h1 class="ltx_title ltx_title_document">Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Rasheed el-Bouri
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Tingting Zhu*
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">David A. Clifton
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Given the abundance and ease of access of personal data today, individual privacy has become of paramount importance, particularly in the healthcare domain. In this work, we aim to utilise patient data extracted from multiple hospital data centres to train a machine learning model without sacrificing patient privacy. We develop a scheduling algorithm in conjunction with a student-teacher algorithm that is deployed in a federated manner. This allows a central model to learn from batches of data at each federal node. The teacher acts between data centres to update the main task (student) algorithm using the data that is stored in the various data centres. We show that the scheduler, trained using meta-gradients, can effectively organise training and as a result train a machine learning model on a diverse dataset without needing explicit access to the patient data. We achieve state-of-the-art performance and show how our method overcomes some of the problems faced in the federated learning such as node poisoning. We further show how the scheduler can be used as a mechanism for transfer learning, allowing different teachers to work together in training a student for state-of-the-art performance.</p>
</div>
<div class="ltx_keywords">Machine Learning, ICML
</div>
<div id="p2" class="ltx_para">
<br class="ltx_break">
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated learning is a field that has emerged recently due to the abundance of data available today and the risks that this poses to individuals. Privacy (particularly of personal information) is of great importance and should be protected by researchers working in machine learning. In parallel, the emergence of electronic health records (EHRs) has allowed the digitisation of much personal information pertaining to the health conditions of individuals. EHRs are often used in many machine learning research projects <cite class="ltx_cite ltx_citemacro_citep">(Shailaja et al., <a href="#bib.bib23" title="" class="ltx_ref">2018</a>)</cite>. This often involves the transfer and storage of very sensitive information which increases the risk of data leakage. As a result, federated learning can minimise this risk by utilising the data at it’s source rather than transferring it to the researchers servers to be processed.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Machine learning researchers working with EHR data will be all too familiar with the difficulty of gaining access to this information in the first place. It can be a very lengthy and exhausting process (for good reason) to gain access and utilise the EHRs of one healthcare institution let alone accessing the datasets of many. Federated learning offers an alternative in that it allows the data of the patients to be utilised while reducing the risk of their privacy being compromised.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Federated learning is not without its own limitations however. The different datasets that are stored in the different nodes may have different underlying distributions due to their data collection processes which can make machine learning across multiple domains difficult. There is also the possibility of data at each node being corrupted either maliciously or accidentally, leading to data that is undesirable to use for training. These issues can all lead to difficulties in training and convergence of the overall model being trained.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">To overcome these limitations, in this work we propose the following setup. Firstly, We use federated learning to i) protect the privacy of patients by minimising the movement of their data and ii) improve the quality of our machine learning model by utilising a diverse dataset sourced from different hospitals. As we are ‘blind’ to the data at the nodes, we propose the use of a student-teacher network setup. The teacher (a reinforcement learning agent) will have access to the local servers and be able to select the appropriate data for the ‘student’ (our model) to be trained on at that time. The ‘scheduler’ will be responsible for directing the teacher to a given data centre to select data for training on.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To summarise: (<span id="S1.p5.1.1" class="ltx_text ltx_font_italic">The Student</span>:) - the machine learning model we are training. (<span id="S1.p5.1.2" class="ltx_text ltx_font_italic">The Teacher</span>:) - a reinforcement learning agent that selects data from a data centre based on the state of the student. This essentially defines a curriculum at each training step for the student. (<span id="S1.p5.1.3" class="ltx_text ltx_font_italic">The Scheduler</span>:) - directs the teacher to the appropriate data centre for training. This is also based on the state of the student at each training iteration.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Section <a href="#S2" title="2 Related Work ‣ Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> discusses the related work that has been carried out and Section <a href="#S3" title="3 Methodology ‣ Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> provides a detailed description of how our algorithm works. Section <a href="#S4" title="4 Datasets ‣ Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> details the datasets we benchmark our method against. We then present the results in Section <a href="#S5" title="5 Results ‣ Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> and discuss their significance and interesting behaviours of our model in Section <a href="#S6" title="6 Implicit Defensive Setup ‣ Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Federated learning has been used by researchers to exploit larger pools of data for training <cite class="ltx_cite ltx_citemacro_citep">(Bonawitz et al., <a href="#bib.bib4" title="" class="ltx_ref">2019</a>)</cite>, preserve data privacy <cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a href="#bib.bib31" title="" class="ltx_ref">2019</a>)</cite> and distributing computational resource requirements <cite class="ltx_cite ltx_citemacro_citep">(Yuan &amp; Ma, <a href="#bib.bib32" title="" class="ltx_ref">2020</a>)</cite>. Federated learning has also been used for healthcare applications to simultaneously utilise multiple datasets to train a model on patient data.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">In this work we create a model that learns in a federal fashion through the interaction of a scheduler that is trained using meta-gradients and a student-teacher algorithm that is trained using reinforcement learning.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Meta-learning has been used effectively in <cite class="ltx_cite ltx_citemacro_citep">(Such et al., <a href="#bib.bib25" title="" class="ltx_ref">2019</a>)</cite> where the loss of a student model on a validation set was used as a signal to update the weights of a generative model. This work demonstrated the rapid and effective training of methods that exploit meta-gradients. Meta-learning was also used in <cite class="ltx_cite ltx_citemacro_citep">(Zahavy et al., <a href="#bib.bib33" title="" class="ltx_ref">2020</a>)</cite>, where the meta-gradients are used to tune the parameters of an actor-critic algorithm. As a result of the efficacy of this method in these domains we choose to use meta-gradients in order to schedule which data centre the gradients to update are student model will come from.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">The meta-learned scheduler chooses a node representing a data centre where a student-teacher algorithm is used to sample data. Student-teacher algorithms have been used in multiple works, with the general premise that one algorithm (teacher) is trained to train another (student) <cite class="ltx_cite ltx_citemacro_citep">(Fan et al., <a href="#bib.bib6" title="" class="ltx_ref">2018</a>; Liu et al., <a href="#bib.bib18" title="" class="ltx_ref">2017a</a>)</cite>. These methods have also been used with a curriculum <cite class="ltx_cite ltx_citemacro_citep">(Bengio et al., <a href="#bib.bib2" title="" class="ltx_ref">2009</a>)</cite>, where the curriculum is either pre-defined and exploited by the teacher <cite class="ltx_cite ltx_citemacro_citep">(El-Bouri et al., <a href="#bib.bib5" title="" class="ltx_ref">2020</a>)</cite> or implicitly learned by the teacher during training <cite class="ltx_cite ltx_citemacro_citep">(Graves et al., <a href="#bib.bib9" title="" class="ltx_ref">2017</a>)</cite>.</p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.5" class="ltx_p">Federated learning is a method of training a model (in our case a deep neural network) by using data from multiple centres, without having central access to each of them <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib20" title="" class="ltx_ref">2017</a>)</cite>. Local models at each of the data centres are iteratively updated and aggregated to form a global model. At each round of iteration, a central coordinator samples a subset, <math id="S2.p5.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.p5.1.m1.1a"><mi id="S2.p5.1.m1.1.1" xref="S2.p5.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.p5.1.m1.1b"><ci id="S2.p5.1.m1.1.1.cmml" xref="S2.p5.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.1.m1.1c">m</annotation></semantics></math>, of local models, <math id="S2.p5.2.m2.1" class="ltx_Math" alttext="S_{m}" display="inline"><semantics id="S2.p5.2.m2.1a"><msub id="S2.p5.2.m2.1.1" xref="S2.p5.2.m2.1.1.cmml"><mi id="S2.p5.2.m2.1.1.2" xref="S2.p5.2.m2.1.1.2.cmml">S</mi><mi id="S2.p5.2.m2.1.1.3" xref="S2.p5.2.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p5.2.m2.1b"><apply id="S2.p5.2.m2.1.1.cmml" xref="S2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p5.2.m2.1.1.1.cmml" xref="S2.p5.2.m2.1.1">subscript</csymbol><ci id="S2.p5.2.m2.1.1.2.cmml" xref="S2.p5.2.m2.1.1.2">𝑆</ci><ci id="S2.p5.2.m2.1.1.3.cmml" xref="S2.p5.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.2.m2.1c">S_{m}</annotation></semantics></math>, and sends them the current global model <math id="S2.p5.3.m3.1" class="ltx_Math" alttext="G^{t}" display="inline"><semantics id="S2.p5.3.m3.1a"><msup id="S2.p5.3.m3.1.1" xref="S2.p5.3.m3.1.1.cmml"><mi id="S2.p5.3.m3.1.1.2" xref="S2.p5.3.m3.1.1.2.cmml">G</mi><mi id="S2.p5.3.m3.1.1.3" xref="S2.p5.3.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S2.p5.3.m3.1b"><apply id="S2.p5.3.m3.1.1.cmml" xref="S2.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p5.3.m3.1.1.1.cmml" xref="S2.p5.3.m3.1.1">superscript</csymbol><ci id="S2.p5.3.m3.1.1.2.cmml" xref="S2.p5.3.m3.1.1.2">𝐺</ci><ci id="S2.p5.3.m3.1.1.3.cmml" xref="S2.p5.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.3.m3.1c">G^{t}</annotation></semantics></math>. Each member of <math id="S2.p5.4.m4.1" class="ltx_Math" alttext="S_{m}" display="inline"><semantics id="S2.p5.4.m4.1a"><msub id="S2.p5.4.m4.1.1" xref="S2.p5.4.m4.1.1.cmml"><mi id="S2.p5.4.m4.1.1.2" xref="S2.p5.4.m4.1.1.2.cmml">S</mi><mi id="S2.p5.4.m4.1.1.3" xref="S2.p5.4.m4.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p5.4.m4.1b"><apply id="S2.p5.4.m4.1.1.cmml" xref="S2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p5.4.m4.1.1.1.cmml" xref="S2.p5.4.m4.1.1">subscript</csymbol><ci id="S2.p5.4.m4.1.1.2.cmml" xref="S2.p5.4.m4.1.1.2">𝑆</ci><ci id="S2.p5.4.m4.1.1.3.cmml" xref="S2.p5.4.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.4.m4.1c">S_{m}</annotation></semantics></math> then updates this global model using their local data to create an updated model <math id="S2.p5.5.m5.1" class="ltx_Math" alttext="L^{t+1}" display="inline"><semantics id="S2.p5.5.m5.1a"><msup id="S2.p5.5.m5.1.1" xref="S2.p5.5.m5.1.1.cmml"><mi id="S2.p5.5.m5.1.1.2" xref="S2.p5.5.m5.1.1.2.cmml">L</mi><mrow id="S2.p5.5.m5.1.1.3" xref="S2.p5.5.m5.1.1.3.cmml"><mi id="S2.p5.5.m5.1.1.3.2" xref="S2.p5.5.m5.1.1.3.2.cmml">t</mi><mo id="S2.p5.5.m5.1.1.3.1" xref="S2.p5.5.m5.1.1.3.1.cmml">+</mo><mn id="S2.p5.5.m5.1.1.3.3" xref="S2.p5.5.m5.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.p5.5.m5.1b"><apply id="S2.p5.5.m5.1.1.cmml" xref="S2.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p5.5.m5.1.1.1.cmml" xref="S2.p5.5.m5.1.1">superscript</csymbol><ci id="S2.p5.5.m5.1.1.2.cmml" xref="S2.p5.5.m5.1.1.2">𝐿</ci><apply id="S2.p5.5.m5.1.1.3.cmml" xref="S2.p5.5.m5.1.1.3"><plus id="S2.p5.5.m5.1.1.3.1.cmml" xref="S2.p5.5.m5.1.1.3.1"></plus><ci id="S2.p5.5.m5.1.1.3.2.cmml" xref="S2.p5.5.m5.1.1.3.2">𝑡</ci><cn type="integer" id="S2.p5.5.m5.1.1.3.3.cmml" xref="S2.p5.5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.5.m5.1c">L^{t+1}</annotation></semantics></math>. These models are then aggregated and are sent back to update the global model as:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.1" class="ltx_Math" alttext="G^{t+1}=G^{t}+\frac{\eta}{n}\sum^{m}_{i=1}\left(L^{t+1}_{i}-G^{t}\right)" display="block"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml"><msup id="S2.E1.m1.1.1.3" xref="S2.E1.m1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.3.2" xref="S2.E1.m1.1.1.3.2.cmml">G</mi><mrow id="S2.E1.m1.1.1.3.3" xref="S2.E1.m1.1.1.3.3.cmml"><mi id="S2.E1.m1.1.1.3.3.2" xref="S2.E1.m1.1.1.3.3.2.cmml">t</mi><mo id="S2.E1.m1.1.1.3.3.1" xref="S2.E1.m1.1.1.3.3.1.cmml">+</mo><mn id="S2.E1.m1.1.1.3.3.3" xref="S2.E1.m1.1.1.3.3.3.cmml">1</mn></mrow></msup><mo id="S2.E1.m1.1.1.2" xref="S2.E1.m1.1.1.2.cmml">=</mo><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.cmml"><msup id="S2.E1.m1.1.1.1.3" xref="S2.E1.m1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.3.2.cmml">G</mi><mi id="S2.E1.m1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.3.3.cmml">t</mi></msup><mo id="S2.E1.m1.1.1.1.2" xref="S2.E1.m1.1.1.1.2.cmml">+</mo><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><mfrac id="S2.E1.m1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.3.2.cmml">η</mi><mi id="S2.E1.m1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.3.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><munderover id="S2.E1.m1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S2.E1.m1.1.1.1.1.1.2.2.2" xref="S2.E1.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E1.m1.1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.1.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.2.3.2" xref="S2.E1.m1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S2.E1.m1.1.1.1.1.1.2.3.1" xref="S2.E1.m1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S2.E1.m1.1.1.1.1.1.2.3.3" xref="S2.E1.m1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.1.1.1.1.1.2.2.3" xref="S2.E1.m1.1.1.1.1.1.2.2.3.cmml">m</mi></munderover><mrow id="S2.E1.m1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S2.E1.m1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">L</mi><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">+</mo><mn id="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msup id="S2.E1.m1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml">G</mi><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msup></mrow><mo id="S2.E1.m1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1"><eq id="S2.E1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1.2"></eq><apply id="S2.E1.m1.1.1.3.cmml" xref="S2.E1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.3">superscript</csymbol><ci id="S2.E1.m1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.3.2">𝐺</ci><apply id="S2.E1.m1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.3.3"><plus id="S2.E1.m1.1.1.3.3.1.cmml" xref="S2.E1.m1.1.1.3.3.1"></plus><ci id="S2.E1.m1.1.1.3.3.2.cmml" xref="S2.E1.m1.1.1.3.3.2">𝑡</ci><cn type="integer" id="S2.E1.m1.1.1.3.3.3.cmml" xref="S2.E1.m1.1.1.3.3.3">1</cn></apply></apply><apply id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><plus id="S2.E1.m1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.2"></plus><apply id="S2.E1.m1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.3">superscript</csymbol><ci id="S2.E1.m1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.3.2">𝐺</ci><ci id="S2.E1.m1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.3.3">𝑡</ci></apply><apply id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1"><times id="S2.E1.m1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.2"></times><apply id="S2.E1.m1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.3"><divide id="S2.E1.m1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3"></divide><ci id="S2.E1.m1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2">𝜂</ci><ci id="S2.E1.m1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.3.3">𝑛</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"><apply id="S2.E1.m1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.2">subscript</csymbol><apply id="S2.E1.m1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.2">superscript</csymbol><sum id="S2.E1.m1.1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2.2.2"></sum><ci id="S2.E1.m1.1.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.2.2.3">𝑚</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.2.3"><eq id="S2.E1.m1.1.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.2.3.1"></eq><ci id="S2.E1.m1.1.1.1.1.1.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S2.E1.m1.1.1.1.1.1.2.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1"><minus id="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.2">𝐿</ci><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.3"><plus id="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.1"></plus><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.2">𝐺</ci><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">G^{t+1}=G^{t}+\frac{\eta}{n}\sum^{m}_{i=1}\left(L^{t+1}_{i}-G^{t}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.p5.7" class="ltx_p">where <math id="S2.p5.6.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.p5.6.m1.1a"><mi id="S2.p5.6.m1.1.1" xref="S2.p5.6.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.p5.6.m1.1b"><ci id="S2.p5.6.m1.1.1.cmml" xref="S2.p5.6.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.6.m1.1c">n</annotation></semantics></math> is the number of <span id="S2.p5.7.1" class="ltx_text ltx_font_italic">nodes</span> (i.e., data centres) and <math id="S2.p5.7.m2.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S2.p5.7.m2.1a"><mi id="S2.p5.7.m2.1.1" xref="S2.p5.7.m2.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S2.p5.7.m2.1b"><ci id="S2.p5.7.m2.1.1.cmml" xref="S2.p5.7.m2.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.7.m2.1c">\eta</annotation></semantics></math> acts as a learning rate for replacing the global model with the aggregate of the local models. While this has been shown to work in many cases, <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib28" title="" class="ltx_ref">2020a</a>)</cite> make the argument that there is inherent difficulty in updating neural networks in this manner. They argue that the permutation invariance of the summation operand renders averaging in the parameter space a naive approach. For meaningful averaging to be done, the permutation must first be undone.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Compromising Federated Learning</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">One of the vulnerabilities of federated learning is that nodes being compromised can significantly affect the training of the global model <cite class="ltx_cite ltx_citemacro_citep">(Bhagoji et al., <a href="#bib.bib3" title="" class="ltx_ref">2018</a>)</cite>. Attacks of these sort can either ‘poison’ the data found at one of the nodes (known as an <span id="S2.SS1.p1.1.1" class="ltx_text ltx_font_italic">adversarial</span> attack) or bias the model that is trained at one of the nodes significantly, leading it to highly skew the aggregation step <cite class="ltx_cite ltx_citemacro_citep">(Tolpegin et al., <a href="#bib.bib26" title="" class="ltx_ref">2020</a>)</cite>. There is also the possibility of the attack being a <span id="S2.SS1.p1.1.2" class="ltx_text ltx_font_italic">single-shot attack</span> or a <span id="S2.SS1.p1.1.3" class="ltx_text ltx_font_italic">repeated attack</span> <cite class="ltx_cite ltx_citemacro_citep">(Fang et al., <a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite>. In the single shot case, only one of the nodes is compromised whereas in the repeated case, multiple nodes can be compromised at any given time. Many works have been produced in discussing how federated learning can be compromised by introducing a backdoor into the training process <cite class="ltx_cite ltx_citemacro_citep">(Gu et al., <a href="#bib.bib10" title="" class="ltx_ref">2017</a>; Bagdasaryan et al., <a href="#bib.bib1" title="" class="ltx_ref">2020</a>)</cite>. A backdoor is an attack that causes a classifier to produce unexpected behaviour if a specific trigger is added to the input space. An example is a sticker being added to an image and associating this with the incorrect label <cite class="ltx_cite ltx_citemacro_citep">(Gu et al., <a href="#bib.bib10" title="" class="ltx_ref">2017</a>)</cite>.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">Defences against these attacks have been developed with some authors using pruning of redundant neurons for the core classification task <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib17" title="" class="ltx_ref">2018</a>)</cite>, using outlier detection to detect potential triggers <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib27" title="" class="ltx_ref">2019</a>)</cite>, and re-training and preprocessing inputs <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib19" title="" class="ltx_ref">2017b</a>)</cite>.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p">In this work we aim to overcome these limitations and build defence into the training procedure through the use of a student-teacher network that actively selects which data to train on.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Our method is comprised of three agents in the training setup, the student, the teacher and the scheduler.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>The Overall Setup</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">The overall setup of our federated learning training routine is as follows. We have a scheduler that controls which node we will be learning from (this can be one-hot or we can select multiple nodes). The teacher at the node can then select a batch of data according to the state of the student. The student at the node is a copy of the global student. We use the student to forward pass the batch of data selected by the teacher and return the loss. In the one-hot scheduler scenario, we send back the loss to the global student model to update the weights via backpropagation. In the multi-node learning scenario, we aggregate the losses from all nodes selected and feed these back to the global model for updating.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Data Preprocessing</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">The first step we must take in order to exploit our teacher setup is to rank our data according to some metric. Using <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib30" title="" class="ltx_ref">2020b</a>)</cite> as a guide, we choose to use the Mahalanobis distance expressed as:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.2" class="ltx_Math" alttext="d\left({\mathbf{x}_{n}}\right)=\left(\left(\mathbf{x_{n}}-\boldsymbol{\mu}\right)^{T}\mathbf{S^{-1}}\left({\mathbf{x_{n}}-\boldsymbol{\mu}}\right)\right)^{\frac{1}{2}}" display="block"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.2.2.3" xref="S3.E2.m1.2.2.3.cmml">=</mo><msup id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml"><mrow id="S3.E2.m1.2.2.2.1.1" xref="S3.E2.m1.2.2.2.1.1.1.cmml"><mo id="S3.E2.m1.2.2.2.1.1.2" xref="S3.E2.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.2.2.2.1.1.1" xref="S3.E2.m1.2.2.2.1.1.1.cmml"><msup id="S3.E2.m1.2.2.2.1.1.1.1" xref="S3.E2.m1.2.2.2.1.1.1.1.cmml"><mrow id="S3.E2.m1.2.2.2.1.1.1.1.1.1" xref="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.2.2.2.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.2.2.2.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.2.3.cmml">𝐧</mi></msub><mo id="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.3.cmml">𝝁</mi></mrow><mo id="S3.E2.m1.2.2.2.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E2.m1.2.2.2.1.1.1.1.3" xref="S3.E2.m1.2.2.2.1.1.1.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.1.1.1.3" xref="S3.E2.m1.2.2.2.1.1.1.3.cmml">​</mo><msup id="S3.E2.m1.2.2.2.1.1.1.4" xref="S3.E2.m1.2.2.2.1.1.1.4.cmml"><mi id="S3.E2.m1.2.2.2.1.1.1.4.2" xref="S3.E2.m1.2.2.2.1.1.1.4.2.cmml">𝐒</mi><mrow id="S3.E2.m1.2.2.2.1.1.1.4.3" xref="S3.E2.m1.2.2.2.1.1.1.4.3.cmml"><mo id="S3.E2.m1.2.2.2.1.1.1.4.3a" xref="S3.E2.m1.2.2.2.1.1.1.4.3.cmml">−</mo><mn id="S3.E2.m1.2.2.2.1.1.1.4.3.2" xref="S3.E2.m1.2.2.2.1.1.1.4.3.2.cmml">𝟏</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.1.1.1.3a" xref="S3.E2.m1.2.2.2.1.1.1.3.cmml">​</mo><mrow id="S3.E2.m1.2.2.2.1.1.1.2.1" xref="S3.E2.m1.2.2.2.1.1.1.2.1.1.cmml"><mo id="S3.E2.m1.2.2.2.1.1.1.2.1.2" xref="S3.E2.m1.2.2.2.1.1.1.2.1.1.cmml">(</mo><mrow id="S3.E2.m1.2.2.2.1.1.1.2.1.1" xref="S3.E2.m1.2.2.2.1.1.1.2.1.1.cmml"><msub id="S3.E2.m1.2.2.2.1.1.1.2.1.1.2" xref="S3.E2.m1.2.2.2.1.1.1.2.1.1.2.cmml"><mi id="S3.E2.m1.2.2.2.1.1.1.2.1.1.2.2" xref="S3.E2.m1.2.2.2.1.1.1.2.1.1.2.2.cmml">𝐱</mi><mi id="S3.E2.m1.2.2.2.1.1.1.2.1.1.2.3" xref="S3.E2.m1.2.2.2.1.1.1.2.1.1.2.3.cmml">𝐧</mi></msub><mo id="S3.E2.m1.2.2.2.1.1.1.2.1.1.1" xref="S3.E2.m1.2.2.2.1.1.1.2.1.1.1.cmml">−</mo><mi id="S3.E2.m1.2.2.2.1.1.1.2.1.1.3" xref="S3.E2.m1.2.2.2.1.1.1.2.1.1.3.cmml">𝝁</mi></mrow><mo id="S3.E2.m1.2.2.2.1.1.1.2.1.3" xref="S3.E2.m1.2.2.2.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.2.2.2.1.1.3" xref="S3.E2.m1.2.2.2.1.1.1.cmml">)</mo></mrow><mfrac id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.2.3.cmml"><mn id="S3.E2.m1.2.2.2.3.2" xref="S3.E2.m1.2.2.2.3.2.cmml">1</mn><mn id="S3.E2.m1.2.2.2.3.3" xref="S3.E2.m1.2.2.2.3.3.cmml">2</mn></mfrac></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><eq id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2.3"></eq><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><times id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.2"></times><ci id="S3.E2.m1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.3">𝑑</ci><apply id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3">𝑛</ci></apply></apply><apply id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2">superscript</csymbol><apply id="S3.E2.m1.2.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1"><times id="S3.E2.m1.2.2.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.2.1.1.1.3"></times><apply id="S3.E2.m1.2.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.1.1"><minus id="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.1"></minus><apply id="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.2.3">𝐧</ci></apply><ci id="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.1.1.1.3">𝝁</ci></apply><ci id="S3.E2.m1.2.2.2.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.3">𝑇</ci></apply><apply id="S3.E2.m1.2.2.2.1.1.1.4.cmml" xref="S3.E2.m1.2.2.2.1.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.1.1.4.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1.4">superscript</csymbol><ci id="S3.E2.m1.2.2.2.1.1.1.4.2.cmml" xref="S3.E2.m1.2.2.2.1.1.1.4.2">𝐒</ci><apply id="S3.E2.m1.2.2.2.1.1.1.4.3.cmml" xref="S3.E2.m1.2.2.2.1.1.1.4.3"><minus id="S3.E2.m1.2.2.2.1.1.1.4.3.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1.4.3"></minus><cn type="integer" id="S3.E2.m1.2.2.2.1.1.1.4.3.2.cmml" xref="S3.E2.m1.2.2.2.1.1.1.4.3.2">1</cn></apply></apply><apply id="S3.E2.m1.2.2.2.1.1.1.2.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1.2.1"><minus id="S3.E2.m1.2.2.2.1.1.1.2.1.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1.2.1.1.1"></minus><apply id="S3.E2.m1.2.2.2.1.1.1.2.1.1.2.cmml" xref="S3.E2.m1.2.2.2.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.1.1.2.1.1.2.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1.2.1.1.2">subscript</csymbol><ci id="S3.E2.m1.2.2.2.1.1.1.2.1.1.2.2.cmml" xref="S3.E2.m1.2.2.2.1.1.1.2.1.1.2.2">𝐱</ci><ci id="S3.E2.m1.2.2.2.1.1.1.2.1.1.2.3.cmml" xref="S3.E2.m1.2.2.2.1.1.1.2.1.1.2.3">𝐧</ci></apply><ci id="S3.E2.m1.2.2.2.1.1.1.2.1.1.3.cmml" xref="S3.E2.m1.2.2.2.1.1.1.2.1.1.3">𝝁</ci></apply></apply><apply id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.3"><divide id="S3.E2.m1.2.2.2.3.1.cmml" xref="S3.E2.m1.2.2.2.3"></divide><cn type="integer" id="S3.E2.m1.2.2.2.3.2.cmml" xref="S3.E2.m1.2.2.2.3.2">1</cn><cn type="integer" id="S3.E2.m1.2.2.2.3.3.cmml" xref="S3.E2.m1.2.2.2.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">d\left({\mathbf{x}_{n}}\right)=\left(\left(\mathbf{x_{n}}-\boldsymbol{\mu}\right)^{T}\mathbf{S^{-1}}\left({\mathbf{x_{n}}-\boldsymbol{\mu}}\right)\right)^{\frac{1}{2}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.2" class="ltx_p">for medical datasets, and the cosine similarity as our similarity metric for image datasets.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">As the tabular data found in electronic health record systems consist of multiple data types, we encode these using a denoising autoencoder. This trained encoder is distributed to all the nodes so that the data in each node is processed in the same way for consistency.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>The Teacher</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">For the student-teacher interaction we follow the setup in <cite class="ltx_cite ltx_citemacro_citep">(El-Bouri et al., <a href="#bib.bib5" title="" class="ltx_ref">2020</a>)</cite>. The task of the teacher is to select a batch of data from the curriculum by selecting the index along the curriculum and the ‘width’ around that index to include in the selection. The following sequential steps are implemented:</p>
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.2" class="ltx_p">The data at each node is organised into <math id="S3.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.I1.i1.p1.1.m1.1a"><mi id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.1b"><ci id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.1c">N</annotation></semantics></math> curriculum batches according to some metric <math id="S3.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S3.I1.i1.p1.2.m2.1a"><mi id="S3.I1.i1.p1.2.m2.1.1" xref="S3.I1.i1.p1.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.2.m2.1b"><ci id="S3.I1.i1.p1.2.m2.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.2.m2.1c">H</annotation></semantics></math>.</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.1" class="ltx_p">The teacher selects one or more batches for feeding into the student.</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p id="S3.I1.i3.p1.1" class="ltx_p">A pre-trained autoencoder is used to create a latent representation of the batch.</p>
</div>
</li>
<li id="S3.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i4.p1" class="ltx_para">
<p id="S3.I1.i4.p1.1" class="ltx_p">The student is trained on this batch and it’s performance on a separate validation set is recorded.</p>
</div>
</li>
</ul>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.1" class="ltx_p">In this work we use the Mahalanobis distance for <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">H</annotation></semantics></math> for medical data, and cosine similarity for image data as summarised in <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib30" title="" class="ltx_ref">2020b</a>)</cite>.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.8" class="ltx_p">The teacher is a reinforcement learning agent and therefore is tasked with minimising the Bellman loss function given by:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.4" class="ltx_Math" alttext="\mathcal{L}(\theta_{i})=\left(r+\gamma\max_{a^{\prime}}Q(s^{\prime},a^{\prime};\theta^{-}_{i})-Q(s,a;\theta_{i})\right)^{2}" display="block"><semantics id="S3.E3.m1.4a"><mrow id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml"><mrow id="S3.E3.m1.3.3.1" xref="S3.E3.m1.3.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.3.3.1.3" xref="S3.E3.m1.3.3.1.3.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.2" xref="S3.E3.m1.3.3.1.2.cmml">​</mo><mrow id="S3.E3.m1.3.3.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.cmml">(</mo><msub id="S3.E3.m1.3.3.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.2.cmml">θ</mi><mi id="S3.E3.m1.3.3.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.4.4.3" xref="S3.E3.m1.4.4.3.cmml">=</mo><msup id="S3.E3.m1.4.4.2" xref="S3.E3.m1.4.4.2.cmml"><mrow id="S3.E3.m1.4.4.2.1.1" xref="S3.E3.m1.4.4.2.1.1.1.cmml"><mo id="S3.E3.m1.4.4.2.1.1.2" xref="S3.E3.m1.4.4.2.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.4.4.2.1.1.1" xref="S3.E3.m1.4.4.2.1.1.1.cmml"><mrow id="S3.E3.m1.4.4.2.1.1.1.3" xref="S3.E3.m1.4.4.2.1.1.1.3.cmml"><mi id="S3.E3.m1.4.4.2.1.1.1.3.5" xref="S3.E3.m1.4.4.2.1.1.1.3.5.cmml">r</mi><mo id="S3.E3.m1.4.4.2.1.1.1.3.4" xref="S3.E3.m1.4.4.2.1.1.1.3.4.cmml">+</mo><mrow id="S3.E3.m1.4.4.2.1.1.1.3.3" xref="S3.E3.m1.4.4.2.1.1.1.3.3.cmml"><mi id="S3.E3.m1.4.4.2.1.1.1.3.3.5" xref="S3.E3.m1.4.4.2.1.1.1.3.3.5.cmml">γ</mi><mo lspace="0.167em" rspace="0em" id="S3.E3.m1.4.4.2.1.1.1.3.3.4" xref="S3.E3.m1.4.4.2.1.1.1.3.3.4.cmml">​</mo><mrow id="S3.E3.m1.4.4.2.1.1.1.3.3.6" xref="S3.E3.m1.4.4.2.1.1.1.3.3.6.cmml"><munder id="S3.E3.m1.4.4.2.1.1.1.3.3.6.1" xref="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.cmml"><mi id="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.2" xref="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.2.cmml">max</mi><msup id="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.3" xref="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.3.cmml"><mi id="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.3.2" xref="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.3.2.cmml">a</mi><mo id="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.3.3" xref="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.3.3.cmml">′</mo></msup></munder><mo lspace="0.167em" id="S3.E3.m1.4.4.2.1.1.1.3.3.6a" xref="S3.E3.m1.4.4.2.1.1.1.3.3.6.cmml">⁡</mo><mi id="S3.E3.m1.4.4.2.1.1.1.3.3.6.2" xref="S3.E3.m1.4.4.2.1.1.1.3.3.6.2.cmml">Q</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.4.4.2.1.1.1.3.3.4a" xref="S3.E3.m1.4.4.2.1.1.1.3.3.4.cmml">​</mo><mrow id="S3.E3.m1.4.4.2.1.1.1.3.3.3.3" xref="S3.E3.m1.4.4.2.1.1.1.3.3.3.4.cmml"><mo stretchy="false" id="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.4" xref="S3.E3.m1.4.4.2.1.1.1.3.3.3.4.cmml">(</mo><msup id="S3.E3.m1.4.4.2.1.1.1.1.1.1.1.1" xref="S3.E3.m1.4.4.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.4.4.2.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.4.4.2.1.1.1.1.1.1.1.1.2.cmml">s</mi><mo id="S3.E3.m1.4.4.2.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.4.4.2.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.5" xref="S3.E3.m1.4.4.2.1.1.1.3.3.3.4.cmml">,</mo><msup id="S3.E3.m1.4.4.2.1.1.1.2.2.2.2.2" xref="S3.E3.m1.4.4.2.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E3.m1.4.4.2.1.1.1.2.2.2.2.2.2" xref="S3.E3.m1.4.4.2.1.1.1.2.2.2.2.2.2.cmml">a</mi><mo id="S3.E3.m1.4.4.2.1.1.1.2.2.2.2.2.3" xref="S3.E3.m1.4.4.2.1.1.1.2.2.2.2.2.3.cmml">′</mo></msup><mo id="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.6" xref="S3.E3.m1.4.4.2.1.1.1.3.3.3.4.cmml">;</mo><msubsup id="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3" xref="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3.cmml"><mi id="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3.2.2" xref="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3.2.2.cmml">θ</mi><mi id="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3.3" xref="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3.3.cmml">i</mi><mo id="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3.2.3" xref="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3.2.3.cmml">−</mo></msubsup><mo stretchy="false" id="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.7" xref="S3.E3.m1.4.4.2.1.1.1.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.4.4.2.1.1.1.5" xref="S3.E3.m1.4.4.2.1.1.1.5.cmml">−</mo><mrow id="S3.E3.m1.4.4.2.1.1.1.4" xref="S3.E3.m1.4.4.2.1.1.1.4.cmml"><mi id="S3.E3.m1.4.4.2.1.1.1.4.3" xref="S3.E3.m1.4.4.2.1.1.1.4.3.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.4.4.2.1.1.1.4.2" xref="S3.E3.m1.4.4.2.1.1.1.4.2.cmml">​</mo><mrow id="S3.E3.m1.4.4.2.1.1.1.4.1.1" xref="S3.E3.m1.4.4.2.1.1.1.4.1.2.cmml"><mo stretchy="false" id="S3.E3.m1.4.4.2.1.1.1.4.1.1.2" xref="S3.E3.m1.4.4.2.1.1.1.4.1.2.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">s</mi><mo id="S3.E3.m1.4.4.2.1.1.1.4.1.1.3" xref="S3.E3.m1.4.4.2.1.1.1.4.1.2.cmml">,</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">a</mi><mo id="S3.E3.m1.4.4.2.1.1.1.4.1.1.4" xref="S3.E3.m1.4.4.2.1.1.1.4.1.2.cmml">;</mo><msub id="S3.E3.m1.4.4.2.1.1.1.4.1.1.1" xref="S3.E3.m1.4.4.2.1.1.1.4.1.1.1.cmml"><mi id="S3.E3.m1.4.4.2.1.1.1.4.1.1.1.2" xref="S3.E3.m1.4.4.2.1.1.1.4.1.1.1.2.cmml">θ</mi><mi id="S3.E3.m1.4.4.2.1.1.1.4.1.1.1.3" xref="S3.E3.m1.4.4.2.1.1.1.4.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E3.m1.4.4.2.1.1.1.4.1.1.5" xref="S3.E3.m1.4.4.2.1.1.1.4.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.4.4.2.1.1.3" xref="S3.E3.m1.4.4.2.1.1.1.cmml">)</mo></mrow><mn id="S3.E3.m1.4.4.2.3" xref="S3.E3.m1.4.4.2.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.4b"><apply id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4"><eq id="S3.E3.m1.4.4.3.cmml" xref="S3.E3.m1.4.4.3"></eq><apply id="S3.E3.m1.3.3.1.cmml" xref="S3.E3.m1.3.3.1"><times id="S3.E3.m1.3.3.1.2.cmml" xref="S3.E3.m1.3.3.1.2"></times><ci id="S3.E3.m1.3.3.1.3.cmml" xref="S3.E3.m1.3.3.1.3">ℒ</ci><apply id="S3.E3.m1.3.3.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.2">𝜃</ci><ci id="S3.E3.m1.3.3.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E3.m1.4.4.2.cmml" xref="S3.E3.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.2.cmml" xref="S3.E3.m1.4.4.2">superscript</csymbol><apply id="S3.E3.m1.4.4.2.1.1.1.cmml" xref="S3.E3.m1.4.4.2.1.1"><minus id="S3.E3.m1.4.4.2.1.1.1.5.cmml" xref="S3.E3.m1.4.4.2.1.1.1.5"></minus><apply id="S3.E3.m1.4.4.2.1.1.1.3.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3"><plus id="S3.E3.m1.4.4.2.1.1.1.3.4.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.4"></plus><ci id="S3.E3.m1.4.4.2.1.1.1.3.5.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.5">𝑟</ci><apply id="S3.E3.m1.4.4.2.1.1.1.3.3.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.3"><times id="S3.E3.m1.4.4.2.1.1.1.3.3.4.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.3.4"></times><ci id="S3.E3.m1.4.4.2.1.1.1.3.3.5.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.3.5">𝛾</ci><apply id="S3.E3.m1.4.4.2.1.1.1.3.3.6.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.3.6"><apply id="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.3.6.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.1.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.3.6.1">subscript</csymbol><max id="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.2.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.2"></max><apply id="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.3.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.3.1.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.3">superscript</csymbol><ci id="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.3.2.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.3.2">𝑎</ci><ci id="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.3.3.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.3.6.1.3.3">′</ci></apply></apply><ci id="S3.E3.m1.4.4.2.1.1.1.3.3.6.2.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.3.6.2">𝑄</ci></apply><vector id="S3.E3.m1.4.4.2.1.1.1.3.3.3.4.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.3.3.3"><apply id="S3.E3.m1.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.2.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.4.4.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.2.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E3.m1.4.4.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.4.4.2.1.1.1.1.1.1.1.1.3">′</ci></apply><apply id="S3.E3.m1.4.4.2.1.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.4.4.2.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E3.m1.4.4.2.1.1.1.2.2.2.2.2">superscript</csymbol><ci id="S3.E3.m1.4.4.2.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.4.4.2.1.1.1.2.2.2.2.2.2">𝑎</ci><ci id="S3.E3.m1.4.4.2.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E3.m1.4.4.2.1.1.1.2.2.2.2.2.3">′</ci></apply><apply id="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3.1.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3">subscript</csymbol><apply id="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3.2.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3.2.1.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3">superscript</csymbol><ci id="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3.2.2.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3.2.2">𝜃</ci><minus id="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3.2.3.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3.2.3"></minus></apply><ci id="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3.3.cmml" xref="S3.E3.m1.4.4.2.1.1.1.3.3.3.3.3.3">𝑖</ci></apply></vector></apply></apply><apply id="S3.E3.m1.4.4.2.1.1.1.4.cmml" xref="S3.E3.m1.4.4.2.1.1.1.4"><times id="S3.E3.m1.4.4.2.1.1.1.4.2.cmml" xref="S3.E3.m1.4.4.2.1.1.1.4.2"></times><ci id="S3.E3.m1.4.4.2.1.1.1.4.3.cmml" xref="S3.E3.m1.4.4.2.1.1.1.4.3">𝑄</ci><vector id="S3.E3.m1.4.4.2.1.1.1.4.1.2.cmml" xref="S3.E3.m1.4.4.2.1.1.1.4.1.1"><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝑠</ci><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">𝑎</ci><apply id="S3.E3.m1.4.4.2.1.1.1.4.1.1.1.cmml" xref="S3.E3.m1.4.4.2.1.1.1.4.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.1.1.1.4.1.1.1.1.cmml" xref="S3.E3.m1.4.4.2.1.1.1.4.1.1.1">subscript</csymbol><ci id="S3.E3.m1.4.4.2.1.1.1.4.1.1.1.2.cmml" xref="S3.E3.m1.4.4.2.1.1.1.4.1.1.1.2">𝜃</ci><ci id="S3.E3.m1.4.4.2.1.1.1.4.1.1.1.3.cmml" xref="S3.E3.m1.4.4.2.1.1.1.4.1.1.1.3">𝑖</ci></apply></vector></apply></apply><cn type="integer" id="S3.E3.m1.4.4.2.3.cmml" xref="S3.E3.m1.4.4.2.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.4c">\mathcal{L}(\theta_{i})=\left(r+\gamma\max_{a^{\prime}}Q(s^{\prime},a^{\prime};\theta^{-}_{i})-Q(s,a;\theta_{i})\right)^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.7" class="ltx_p">where <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">r</annotation></semantics></math> is the reward of a state-action <math id="S3.SS3.p3.2.m2.2" class="ltx_Math" alttext="(s,a)" display="inline"><semantics id="S3.SS3.p3.2.m2.2a"><mrow id="S3.SS3.p3.2.m2.2.3.2" xref="S3.SS3.p3.2.m2.2.3.1.cmml"><mo stretchy="false" id="S3.SS3.p3.2.m2.2.3.2.1" xref="S3.SS3.p3.2.m2.2.3.1.cmml">(</mo><mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">s</mi><mo id="S3.SS3.p3.2.m2.2.3.2.2" xref="S3.SS3.p3.2.m2.2.3.1.cmml">,</mo><mi id="S3.SS3.p3.2.m2.2.2" xref="S3.SS3.p3.2.m2.2.2.cmml">a</mi><mo stretchy="false" id="S3.SS3.p3.2.m2.2.3.2.3" xref="S3.SS3.p3.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.2b"><interval closure="open" id="S3.SS3.p3.2.m2.2.3.1.cmml" xref="S3.SS3.p3.2.m2.2.3.2"><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">𝑠</ci><ci id="S3.SS3.p3.2.m2.2.2.cmml" xref="S3.SS3.p3.2.m2.2.2">𝑎</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.2c">(s,a)</annotation></semantics></math> tuple, <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><mi id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><ci id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">\gamma</annotation></semantics></math> the discount factor, <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><mi id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><ci id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">Q</annotation></semantics></math> is the q-value defining the value of taking an action given a state and <math id="S3.SS3.p3.5.m5.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS3.p3.5.m5.1a"><mi id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><ci id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">\theta</annotation></semantics></math> and <math id="S3.SS3.p3.6.m6.1" class="ltx_Math" alttext="\theta^{-}" display="inline"><semantics id="S3.SS3.p3.6.m6.1a"><msup id="S3.SS3.p3.6.m6.1.1" xref="S3.SS3.p3.6.m6.1.1.cmml"><mi id="S3.SS3.p3.6.m6.1.1.2" xref="S3.SS3.p3.6.m6.1.1.2.cmml">θ</mi><mo id="S3.SS3.p3.6.m6.1.1.3" xref="S3.SS3.p3.6.m6.1.1.3.cmml">−</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.1b"><apply id="S3.SS3.p3.6.m6.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1">superscript</csymbol><ci id="S3.SS3.p3.6.m6.1.1.2.cmml" xref="S3.SS3.p3.6.m6.1.1.2">𝜃</ci><minus id="S3.SS3.p3.6.m6.1.1.3.cmml" xref="S3.SS3.p3.6.m6.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.1c">\theta^{-}</annotation></semantics></math> are the parameters of the prediction and target (the version of the teacher that is held constant for <math id="S3.SS3.p3.7.m7.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.p3.7.m7.1a"><mi id="S3.SS3.p3.7.m7.1.1" xref="S3.SS3.p3.7.m7.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m7.1b"><ci id="S3.SS3.p3.7.m7.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m7.1c">K</annotation></semantics></math> steps to stabilise training as described in <cite class="ltx_cite ltx_citemacro_citep">(Mnih et al., <a href="#bib.bib21" title="" class="ltx_ref">2015</a>)</cite>) networks respectively.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.3" class="ltx_p">As we also choose to use an actor-critic setup for the teacher, the action space and Q-function are separately parameterised. This allows a continuous action space and the actor that selects actions is updated using the following loss:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.5" class="ltx_Math" alttext="\nabla\theta^{\mu}J\approx\frac{1}{N}\sum_{i}\nabla_{a}Q\left(s,a\&gt;|\&gt;\theta^{Q}\right)\&gt;|\&gt;_{s=s_{i},a=\mu\left(s_{i}\right)}\nabla_{\theta^{\mu}}\mu\left(s\&gt;|\&gt;\theta^{\mu}\right)" display="block"><semantics id="S3.E4.m1.5a"><mrow id="S3.E4.m1.5.5" xref="S3.E4.m1.5.5.cmml"><mrow id="S3.E4.m1.5.5.4" xref="S3.E4.m1.5.5.4.cmml"><mo rspace="0.167em" id="S3.E4.m1.5.5.4.1" xref="S3.E4.m1.5.5.4.1.cmml">∇</mo><mrow id="S3.E4.m1.5.5.4.2" xref="S3.E4.m1.5.5.4.2.cmml"><msup id="S3.E4.m1.5.5.4.2.2" xref="S3.E4.m1.5.5.4.2.2.cmml"><mi id="S3.E4.m1.5.5.4.2.2.2" xref="S3.E4.m1.5.5.4.2.2.2.cmml">θ</mi><mi id="S3.E4.m1.5.5.4.2.2.3" xref="S3.E4.m1.5.5.4.2.2.3.cmml">μ</mi></msup><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.4.2.1" xref="S3.E4.m1.5.5.4.2.1.cmml">​</mo><mi id="S3.E4.m1.5.5.4.2.3" xref="S3.E4.m1.5.5.4.2.3.cmml">J</mi></mrow></mrow><mo id="S3.E4.m1.5.5.3" xref="S3.E4.m1.5.5.3.cmml">≈</mo><mrow id="S3.E4.m1.5.5.2" xref="S3.E4.m1.5.5.2.cmml"><msub id="S3.E4.m1.4.4.1.1.1" xref="S3.E4.m1.4.4.1.1.2.cmml"><mrow id="S3.E4.m1.4.4.1.1.1.1" xref="S3.E4.m1.4.4.1.1.2.cmml"><mrow id="S3.E4.m1.4.4.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.cmml"><mfrac id="S3.E4.m1.4.4.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.3.cmml"><mn id="S3.E4.m1.4.4.1.1.1.1.1.3.2" xref="S3.E4.m1.4.4.1.1.1.1.1.3.2.cmml">1</mn><mi id="S3.E4.m1.4.4.1.1.1.1.1.3.3" xref="S3.E4.m1.4.4.1.1.1.1.1.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.cmml"><munder id="S3.E4.m1.4.4.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.cmml">∑</mo><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.2.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.3.cmml">i</mi></munder><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.cmml"><msub id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.1.cmml"><mo rspace="0.167em" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.1.2.cmml">∇</mo><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.1.3.cmml">a</mi></msub><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.2.cmml">Q</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">s</mi><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">,</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" lspace="0.498em" rspace="0.498em" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msup id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.cmml">θ</mi><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.cmml">Q</mi></msup></mrow><mo rspace="0.220em" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.4" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo stretchy="false" id="S3.E4.m1.4.4.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.3.cmml"><mrow id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.2.cmml">s</mi><mo id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">=</mo><msub id="S3.E4.m1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.3.2.cmml">s</mi><mi id="S3.E4.m1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E4.m1.2.2.2.2.3" xref="S3.E4.m1.2.2.2.3a.cmml">,</mo><mrow id="S3.E4.m1.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.cmml"><mi id="S3.E4.m1.2.2.2.2.2.3" xref="S3.E4.m1.2.2.2.2.2.3.cmml">a</mi><mo id="S3.E4.m1.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.2.cmml">=</mo><mrow id="S3.E4.m1.2.2.2.2.2.1" xref="S3.E4.m1.2.2.2.2.2.1.cmml"><mi id="S3.E4.m1.2.2.2.2.2.1.3" xref="S3.E4.m1.2.2.2.2.2.1.3.cmml">μ</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.2.2.1.2" xref="S3.E4.m1.2.2.2.2.2.1.2.cmml">​</mo><mrow id="S3.E4.m1.2.2.2.2.2.1.1.1" xref="S3.E4.m1.2.2.2.2.2.1.1.1.1.cmml"><mo id="S3.E4.m1.2.2.2.2.2.1.1.1.2" xref="S3.E4.m1.2.2.2.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E4.m1.2.2.2.2.2.1.1.1.1" xref="S3.E4.m1.2.2.2.2.2.1.1.1.1.cmml"><mi id="S3.E4.m1.2.2.2.2.2.1.1.1.1.2" xref="S3.E4.m1.2.2.2.2.2.1.1.1.1.2.cmml">s</mi><mi id="S3.E4.m1.2.2.2.2.2.1.1.1.1.3" xref="S3.E4.m1.2.2.2.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E4.m1.2.2.2.2.2.1.1.1.3" xref="S3.E4.m1.2.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></msub><mo lspace="0.387em" rspace="0em" id="S3.E4.m1.5.5.2.3" xref="S3.E4.m1.5.5.2.3.cmml">​</mo><mrow id="S3.E4.m1.5.5.2.4" xref="S3.E4.m1.5.5.2.4.cmml"><msub id="S3.E4.m1.5.5.2.4.1" xref="S3.E4.m1.5.5.2.4.1.cmml"><mo rspace="0.167em" id="S3.E4.m1.5.5.2.4.1.2" xref="S3.E4.m1.5.5.2.4.1.2.cmml">∇</mo><msup id="S3.E4.m1.5.5.2.4.1.3" xref="S3.E4.m1.5.5.2.4.1.3.cmml"><mi id="S3.E4.m1.5.5.2.4.1.3.2" xref="S3.E4.m1.5.5.2.4.1.3.2.cmml">θ</mi><mi id="S3.E4.m1.5.5.2.4.1.3.3" xref="S3.E4.m1.5.5.2.4.1.3.3.cmml">μ</mi></msup></msub><mi id="S3.E4.m1.5.5.2.4.2" xref="S3.E4.m1.5.5.2.4.2.cmml">μ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.2.3a" xref="S3.E4.m1.5.5.2.3.cmml">​</mo><mrow id="S3.E4.m1.5.5.2.2.1" xref="S3.E4.m1.5.5.2.2.1.1.cmml"><mo id="S3.E4.m1.5.5.2.2.1.2" xref="S3.E4.m1.5.5.2.2.1.1.cmml">(</mo><mrow id="S3.E4.m1.5.5.2.2.1.1" xref="S3.E4.m1.5.5.2.2.1.1.cmml"><mi id="S3.E4.m1.5.5.2.2.1.1.2" xref="S3.E4.m1.5.5.2.2.1.1.2.cmml">s</mi><mo fence="false" lspace="0.498em" rspace="0.498em" id="S3.E4.m1.5.5.2.2.1.1.1" xref="S3.E4.m1.5.5.2.2.1.1.1.cmml">|</mo><msup id="S3.E4.m1.5.5.2.2.1.1.3" xref="S3.E4.m1.5.5.2.2.1.1.3.cmml"><mi id="S3.E4.m1.5.5.2.2.1.1.3.2" xref="S3.E4.m1.5.5.2.2.1.1.3.2.cmml">θ</mi><mi id="S3.E4.m1.5.5.2.2.1.1.3.3" xref="S3.E4.m1.5.5.2.2.1.1.3.3.cmml">μ</mi></msup></mrow><mo id="S3.E4.m1.5.5.2.2.1.3" xref="S3.E4.m1.5.5.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.5b"><apply id="S3.E4.m1.5.5.cmml" xref="S3.E4.m1.5.5"><approx id="S3.E4.m1.5.5.3.cmml" xref="S3.E4.m1.5.5.3"></approx><apply id="S3.E4.m1.5.5.4.cmml" xref="S3.E4.m1.5.5.4"><ci id="S3.E4.m1.5.5.4.1.cmml" xref="S3.E4.m1.5.5.4.1">∇</ci><apply id="S3.E4.m1.5.5.4.2.cmml" xref="S3.E4.m1.5.5.4.2"><times id="S3.E4.m1.5.5.4.2.1.cmml" xref="S3.E4.m1.5.5.4.2.1"></times><apply id="S3.E4.m1.5.5.4.2.2.cmml" xref="S3.E4.m1.5.5.4.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.4.2.2.1.cmml" xref="S3.E4.m1.5.5.4.2.2">superscript</csymbol><ci id="S3.E4.m1.5.5.4.2.2.2.cmml" xref="S3.E4.m1.5.5.4.2.2.2">𝜃</ci><ci id="S3.E4.m1.5.5.4.2.2.3.cmml" xref="S3.E4.m1.5.5.4.2.2.3">𝜇</ci></apply><ci id="S3.E4.m1.5.5.4.2.3.cmml" xref="S3.E4.m1.5.5.4.2.3">𝐽</ci></apply></apply><apply id="S3.E4.m1.5.5.2.cmml" xref="S3.E4.m1.5.5.2"><times id="S3.E4.m1.5.5.2.3.cmml" xref="S3.E4.m1.5.5.2.3"></times><apply id="S3.E4.m1.4.4.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.4.4.1.1.2.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2">evaluated-at</csymbol><apply id="S3.E4.m1.4.4.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1"><times id="S3.E4.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.2"></times><apply id="S3.E4.m1.4.4.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.3"><divide id="S3.E4.m1.4.4.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.3"></divide><cn type="integer" id="S3.E4.m1.4.4.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.3.2">1</cn><ci id="S3.E4.m1.4.4.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.3.3">𝑁</ci></apply><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1"><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2"></sum><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1"><times id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2"></times><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3"><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.1">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.1.2">∇</ci><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.1.3">𝑎</ci></apply><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.2">𝑄</ci></apply><interval closure="open" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1"><ci id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3">𝑠</ci><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">𝑎</ci><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2">𝜃</ci><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3">𝑄</ci></apply></apply></interval></apply></apply></apply><apply id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.3a.cmml" xref="S3.E4.m1.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"></eq><ci id="S3.E4.m1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.2">𝑠</ci><apply id="S3.E4.m1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.3.2">𝑠</ci><ci id="S3.E4.m1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2"><eq id="S3.E4.m1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2"></eq><ci id="S3.E4.m1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.3">𝑎</ci><apply id="S3.E4.m1.2.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.1"><times id="S3.E4.m1.2.2.2.2.2.1.2.cmml" xref="S3.E4.m1.2.2.2.2.2.1.2"></times><ci id="S3.E4.m1.2.2.2.2.2.1.3.cmml" xref="S3.E4.m1.2.2.2.2.2.1.3">𝜇</ci><apply id="S3.E4.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.1.2">𝑠</ci><ci id="S3.E4.m1.2.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S3.E4.m1.5.5.2.4.cmml" xref="S3.E4.m1.5.5.2.4"><apply id="S3.E4.m1.5.5.2.4.1.cmml" xref="S3.E4.m1.5.5.2.4.1"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.2.4.1.1.cmml" xref="S3.E4.m1.5.5.2.4.1">subscript</csymbol><ci id="S3.E4.m1.5.5.2.4.1.2.cmml" xref="S3.E4.m1.5.5.2.4.1.2">∇</ci><apply id="S3.E4.m1.5.5.2.4.1.3.cmml" xref="S3.E4.m1.5.5.2.4.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.2.4.1.3.1.cmml" xref="S3.E4.m1.5.5.2.4.1.3">superscript</csymbol><ci id="S3.E4.m1.5.5.2.4.1.3.2.cmml" xref="S3.E4.m1.5.5.2.4.1.3.2">𝜃</ci><ci id="S3.E4.m1.5.5.2.4.1.3.3.cmml" xref="S3.E4.m1.5.5.2.4.1.3.3">𝜇</ci></apply></apply><ci id="S3.E4.m1.5.5.2.4.2.cmml" xref="S3.E4.m1.5.5.2.4.2">𝜇</ci></apply><apply id="S3.E4.m1.5.5.2.2.1.1.cmml" xref="S3.E4.m1.5.5.2.2.1"><csymbol cd="latexml" id="S3.E4.m1.5.5.2.2.1.1.1.cmml" xref="S3.E4.m1.5.5.2.2.1.1.1">conditional</csymbol><ci id="S3.E4.m1.5.5.2.2.1.1.2.cmml" xref="S3.E4.m1.5.5.2.2.1.1.2">𝑠</ci><apply id="S3.E4.m1.5.5.2.2.1.1.3.cmml" xref="S3.E4.m1.5.5.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.2.2.1.1.3.1.cmml" xref="S3.E4.m1.5.5.2.2.1.1.3">superscript</csymbol><ci id="S3.E4.m1.5.5.2.2.1.1.3.2.cmml" xref="S3.E4.m1.5.5.2.2.1.1.3.2">𝜃</ci><ci id="S3.E4.m1.5.5.2.2.1.1.3.3.cmml" xref="S3.E4.m1.5.5.2.2.1.1.3.3">𝜇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.5c">\nabla\theta^{\mu}J\approx\frac{1}{N}\sum_{i}\nabla_{a}Q\left(s,a\&gt;|\&gt;\theta^{Q}\right)\&gt;|\&gt;_{s=s_{i},a=\mu\left(s_{i}\right)}\nabla_{\theta^{\mu}}\mu\left(s\&gt;|\&gt;\theta^{\mu}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p4.2" class="ltx_p">where <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">Q</annotation></semantics></math> is the Q-function and <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><mi id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><ci id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">\mu</annotation></semantics></math> is the policy.</p>
</div>
<div id="S3.SS3.p5" class="ltx_para">
<p id="S3.SS3.p5.1" class="ltx_p">The teacher can either be pre-trained, or jointly trained with the scheduler. The teacher can also either be trained on the dataset of one node and distributed to the rest or independently trained at each node. The latter is preferable due to the ability of the teacher to adapt to the dataset at hand. However, the former is useful when not all nodes in the federated system have access to computational power. The intuition is that the curriculum strategy learned by the teacher should be general for the task at hand and thereby provide strong performance.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>The Student</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.12" class="ltx_p">The input to the teacher is the current state of the student. The student in this work is a feedforward neural network that is tasked with classification. The state of the student is defined as a representation of the weights of the student. Given a matrix of weights, <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="W^{ij}" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><msup id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">W</mi><mrow id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml"><mi id="S3.SS4.p1.1.m1.1.1.3.2" xref="S3.SS4.p1.1.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.1.m1.1.1.3.1" xref="S3.SS4.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.1.m1.1.1.3.3" xref="S3.SS4.p1.1.m1.1.1.3.3.cmml">j</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">𝑊</ci><apply id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3"><times id="S3.SS4.p1.1.m1.1.1.3.1.cmml" xref="S3.SS4.p1.1.m1.1.1.3.1"></times><ci id="S3.SS4.p1.1.m1.1.1.3.2.cmml" xref="S3.SS4.p1.1.m1.1.1.3.2">𝑖</ci><ci id="S3.SS4.p1.1.m1.1.1.3.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">W^{ij}</annotation></semantics></math>, between layers <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><mi id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><ci id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">i</annotation></semantics></math> and <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><mi id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><ci id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">j</annotation></semantics></math> of the network, for each row, <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="W^{ij}_{n:}" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><msubsup id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml"><mi id="S3.SS4.p1.4.m4.1.1.2.2" xref="S3.SS4.p1.4.m4.1.1.2.2.cmml">W</mi><mrow id="S3.SS4.p1.4.m4.1.1.3" xref="S3.SS4.p1.4.m4.1.1.3.cmml"><mi id="S3.SS4.p1.4.m4.1.1.3.2" xref="S3.SS4.p1.4.m4.1.1.3.2.cmml">n</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS4.p1.4.m4.1.1.3.1" xref="S3.SS4.p1.4.m4.1.1.3.1.cmml">:</mo><mi id="S3.SS4.p1.4.m4.1.1.3.3" xref="S3.SS4.p1.4.m4.1.1.3.3.cmml"></mi></mrow><mrow id="S3.SS4.p1.4.m4.1.1.2.3" xref="S3.SS4.p1.4.m4.1.1.2.3.cmml"><mi id="S3.SS4.p1.4.m4.1.1.2.3.2" xref="S3.SS4.p1.4.m4.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.4.m4.1.1.2.3.1" xref="S3.SS4.p1.4.m4.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.4.m4.1.1.2.3.3" xref="S3.SS4.p1.4.m4.1.1.2.3.3.cmml">j</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><apply id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">subscript</csymbol><apply id="S3.SS4.p1.4.m4.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.2.1.cmml" xref="S3.SS4.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS4.p1.4.m4.1.1.2.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2.2">𝑊</ci><apply id="S3.SS4.p1.4.m4.1.1.2.3.cmml" xref="S3.SS4.p1.4.m4.1.1.2.3"><times id="S3.SS4.p1.4.m4.1.1.2.3.1.cmml" xref="S3.SS4.p1.4.m4.1.1.2.3.1"></times><ci id="S3.SS4.p1.4.m4.1.1.2.3.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2.3.2">𝑖</ci><ci id="S3.SS4.p1.4.m4.1.1.2.3.3.cmml" xref="S3.SS4.p1.4.m4.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.SS4.p1.4.m4.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3"><ci id="S3.SS4.p1.4.m4.1.1.3.1.cmml" xref="S3.SS4.p1.4.m4.1.1.3.1">:</ci><ci id="S3.SS4.p1.4.m4.1.1.3.2.cmml" xref="S3.SS4.p1.4.m4.1.1.3.2">𝑛</ci><csymbol cd="latexml" id="S3.SS4.p1.4.m4.1.1.3.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3.3">absent</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">W^{ij}_{n:}</annotation></semantics></math>, we take the inner product of the row with a fixed reference vector <math id="S3.SS4.p1.5.m5.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S3.SS4.p1.5.m5.1a"><mi id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><ci id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">a</annotation></semantics></math>. From this inner product we extract <math id="S3.SS4.p1.6.m6.2" class="ltx_Math" alttext="\lvert\langle W_{n:}^{ij},a\rangle\rvert" display="inline"><semantics id="S3.SS4.p1.6.m6.2a"><mrow id="S3.SS4.p1.6.m6.2.2.1" xref="S3.SS4.p1.6.m6.2.2.2.cmml"><mo stretchy="false" id="S3.SS4.p1.6.m6.2.2.1.2" xref="S3.SS4.p1.6.m6.2.2.2.1.cmml">|</mo><mrow id="S3.SS4.p1.6.m6.2.2.1.1.1" xref="S3.SS4.p1.6.m6.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS4.p1.6.m6.2.2.1.1.1.2" xref="S3.SS4.p1.6.m6.2.2.1.1.2.cmml">⟨</mo><msubsup id="S3.SS4.p1.6.m6.2.2.1.1.1.1" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.cmml"><mi id="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.2" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.2.cmml">W</mi><mrow id="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.3" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.3.cmml"><mi id="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.3.2" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.3.2.cmml">n</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.3.1" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.3.1.cmml">:</mo><mi id="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.3.3" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.3.3.cmml"></mi></mrow><mrow id="S3.SS4.p1.6.m6.2.2.1.1.1.1.3" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.3.cmml"><mi id="S3.SS4.p1.6.m6.2.2.1.1.1.1.3.2" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.6.m6.2.2.1.1.1.1.3.1" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.6.m6.2.2.1.1.1.1.3.3" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.3.3.cmml">j</mi></mrow></msubsup><mo id="S3.SS4.p1.6.m6.2.2.1.1.1.3" xref="S3.SS4.p1.6.m6.2.2.1.1.2.cmml">,</mo><mi id="S3.SS4.p1.6.m6.1.1" xref="S3.SS4.p1.6.m6.1.1.cmml">a</mi><mo stretchy="false" id="S3.SS4.p1.6.m6.2.2.1.1.1.4" xref="S3.SS4.p1.6.m6.2.2.1.1.2.cmml">⟩</mo></mrow><mo stretchy="false" id="S3.SS4.p1.6.m6.2.2.1.3" xref="S3.SS4.p1.6.m6.2.2.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m6.2b"><apply id="S3.SS4.p1.6.m6.2.2.2.cmml" xref="S3.SS4.p1.6.m6.2.2.1"><abs id="S3.SS4.p1.6.m6.2.2.2.1.cmml" xref="S3.SS4.p1.6.m6.2.2.1.2"></abs><list id="S3.SS4.p1.6.m6.2.2.1.1.2.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1"><apply id="S3.SS4.p1.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1">superscript</csymbol><apply id="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.1.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.2.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.2">𝑊</ci><apply id="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.3.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.3"><ci id="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.3.1.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.3.1">:</ci><ci id="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.3.2.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.3.2">𝑛</ci><csymbol cd="latexml" id="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.3.3.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.3.3">absent</csymbol></apply></apply><apply id="S3.SS4.p1.6.m6.2.2.1.1.1.1.3.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.3"><times id="S3.SS4.p1.6.m6.2.2.1.1.1.1.3.1.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.3.1"></times><ci id="S3.SS4.p1.6.m6.2.2.1.1.1.1.3.2.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS4.p1.6.m6.2.2.1.1.1.1.3.3.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.3.3">𝑗</ci></apply></apply><ci id="S3.SS4.p1.6.m6.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1">𝑎</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.2c">\lvert\langle W_{n:}^{ij},a\rangle\rvert</annotation></semantics></math> and <math id="S3.SS4.p1.7.m7.2" class="ltx_Math" alttext="\angle\left(W_{n:}^{ij},a\right)" display="inline"><semantics id="S3.SS4.p1.7.m7.2a"><mrow id="S3.SS4.p1.7.m7.2.2" xref="S3.SS4.p1.7.m7.2.2.cmml"><mi mathvariant="normal" id="S3.SS4.p1.7.m7.2.2.3" xref="S3.SS4.p1.7.m7.2.2.3.cmml">∠</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.7.m7.2.2.2" xref="S3.SS4.p1.7.m7.2.2.2.cmml">​</mo><mrow id="S3.SS4.p1.7.m7.2.2.1.1" xref="S3.SS4.p1.7.m7.2.2.1.2.cmml"><mo id="S3.SS4.p1.7.m7.2.2.1.1.2" xref="S3.SS4.p1.7.m7.2.2.1.2.cmml">(</mo><msubsup id="S3.SS4.p1.7.m7.2.2.1.1.1" xref="S3.SS4.p1.7.m7.2.2.1.1.1.cmml"><mi id="S3.SS4.p1.7.m7.2.2.1.1.1.2.2" xref="S3.SS4.p1.7.m7.2.2.1.1.1.2.2.cmml">W</mi><mrow id="S3.SS4.p1.7.m7.2.2.1.1.1.2.3" xref="S3.SS4.p1.7.m7.2.2.1.1.1.2.3.cmml"><mi id="S3.SS4.p1.7.m7.2.2.1.1.1.2.3.2" xref="S3.SS4.p1.7.m7.2.2.1.1.1.2.3.2.cmml">n</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS4.p1.7.m7.2.2.1.1.1.2.3.1" xref="S3.SS4.p1.7.m7.2.2.1.1.1.2.3.1.cmml">:</mo><mi id="S3.SS4.p1.7.m7.2.2.1.1.1.2.3.3" xref="S3.SS4.p1.7.m7.2.2.1.1.1.2.3.3.cmml"></mi></mrow><mrow id="S3.SS4.p1.7.m7.2.2.1.1.1.3" xref="S3.SS4.p1.7.m7.2.2.1.1.1.3.cmml"><mi id="S3.SS4.p1.7.m7.2.2.1.1.1.3.2" xref="S3.SS4.p1.7.m7.2.2.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.7.m7.2.2.1.1.1.3.1" xref="S3.SS4.p1.7.m7.2.2.1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.7.m7.2.2.1.1.1.3.3" xref="S3.SS4.p1.7.m7.2.2.1.1.1.3.3.cmml">j</mi></mrow></msubsup><mo id="S3.SS4.p1.7.m7.2.2.1.1.3" xref="S3.SS4.p1.7.m7.2.2.1.2.cmml">,</mo><mi id="S3.SS4.p1.7.m7.1.1" xref="S3.SS4.p1.7.m7.1.1.cmml">a</mi><mo id="S3.SS4.p1.7.m7.2.2.1.1.4" xref="S3.SS4.p1.7.m7.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m7.2b"><apply id="S3.SS4.p1.7.m7.2.2.cmml" xref="S3.SS4.p1.7.m7.2.2"><times id="S3.SS4.p1.7.m7.2.2.2.cmml" xref="S3.SS4.p1.7.m7.2.2.2"></times><ci id="S3.SS4.p1.7.m7.2.2.3.cmml" xref="S3.SS4.p1.7.m7.2.2.3">∠</ci><interval closure="open" id="S3.SS4.p1.7.m7.2.2.1.2.cmml" xref="S3.SS4.p1.7.m7.2.2.1.1"><apply id="S3.SS4.p1.7.m7.2.2.1.1.1.cmml" xref="S3.SS4.p1.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m7.2.2.1.1.1.1.cmml" xref="S3.SS4.p1.7.m7.2.2.1.1.1">superscript</csymbol><apply id="S3.SS4.p1.7.m7.2.2.1.1.1.2.cmml" xref="S3.SS4.p1.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m7.2.2.1.1.1.2.1.cmml" xref="S3.SS4.p1.7.m7.2.2.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.7.m7.2.2.1.1.1.2.2.cmml" xref="S3.SS4.p1.7.m7.2.2.1.1.1.2.2">𝑊</ci><apply id="S3.SS4.p1.7.m7.2.2.1.1.1.2.3.cmml" xref="S3.SS4.p1.7.m7.2.2.1.1.1.2.3"><ci id="S3.SS4.p1.7.m7.2.2.1.1.1.2.3.1.cmml" xref="S3.SS4.p1.7.m7.2.2.1.1.1.2.3.1">:</ci><ci id="S3.SS4.p1.7.m7.2.2.1.1.1.2.3.2.cmml" xref="S3.SS4.p1.7.m7.2.2.1.1.1.2.3.2">𝑛</ci><csymbol cd="latexml" id="S3.SS4.p1.7.m7.2.2.1.1.1.2.3.3.cmml" xref="S3.SS4.p1.7.m7.2.2.1.1.1.2.3.3">absent</csymbol></apply></apply><apply id="S3.SS4.p1.7.m7.2.2.1.1.1.3.cmml" xref="S3.SS4.p1.7.m7.2.2.1.1.1.3"><times id="S3.SS4.p1.7.m7.2.2.1.1.1.3.1.cmml" xref="S3.SS4.p1.7.m7.2.2.1.1.1.3.1"></times><ci id="S3.SS4.p1.7.m7.2.2.1.1.1.3.2.cmml" xref="S3.SS4.p1.7.m7.2.2.1.1.1.3.2">𝑖</ci><ci id="S3.SS4.p1.7.m7.2.2.1.1.1.3.3.cmml" xref="S3.SS4.p1.7.m7.2.2.1.1.1.3.3">𝑗</ci></apply></apply><ci id="S3.SS4.p1.7.m7.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m7.2c">\angle\left(W_{n:}^{ij},a\right)</annotation></semantics></math> for <math id="S3.SS4.p1.8.m8.4" class="ltx_Math" alttext="n=1,2,\dots,M_{i}" display="inline"><semantics id="S3.SS4.p1.8.m8.4a"><mrow id="S3.SS4.p1.8.m8.4.4" xref="S3.SS4.p1.8.m8.4.4.cmml"><mi id="S3.SS4.p1.8.m8.4.4.3" xref="S3.SS4.p1.8.m8.4.4.3.cmml">n</mi><mo id="S3.SS4.p1.8.m8.4.4.2" xref="S3.SS4.p1.8.m8.4.4.2.cmml">=</mo><mrow id="S3.SS4.p1.8.m8.4.4.1.1" xref="S3.SS4.p1.8.m8.4.4.1.2.cmml"><mn id="S3.SS4.p1.8.m8.1.1" xref="S3.SS4.p1.8.m8.1.1.cmml">1</mn><mo id="S3.SS4.p1.8.m8.4.4.1.1.2" xref="S3.SS4.p1.8.m8.4.4.1.2.cmml">,</mo><mn id="S3.SS4.p1.8.m8.2.2" xref="S3.SS4.p1.8.m8.2.2.cmml">2</mn><mo id="S3.SS4.p1.8.m8.4.4.1.1.3" xref="S3.SS4.p1.8.m8.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="S3.SS4.p1.8.m8.3.3" xref="S3.SS4.p1.8.m8.3.3.cmml">…</mi><mo id="S3.SS4.p1.8.m8.4.4.1.1.4" xref="S3.SS4.p1.8.m8.4.4.1.2.cmml">,</mo><msub id="S3.SS4.p1.8.m8.4.4.1.1.1" xref="S3.SS4.p1.8.m8.4.4.1.1.1.cmml"><mi id="S3.SS4.p1.8.m8.4.4.1.1.1.2" xref="S3.SS4.p1.8.m8.4.4.1.1.1.2.cmml">M</mi><mi id="S3.SS4.p1.8.m8.4.4.1.1.1.3" xref="S3.SS4.p1.8.m8.4.4.1.1.1.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m8.4b"><apply id="S3.SS4.p1.8.m8.4.4.cmml" xref="S3.SS4.p1.8.m8.4.4"><eq id="S3.SS4.p1.8.m8.4.4.2.cmml" xref="S3.SS4.p1.8.m8.4.4.2"></eq><ci id="S3.SS4.p1.8.m8.4.4.3.cmml" xref="S3.SS4.p1.8.m8.4.4.3">𝑛</ci><list id="S3.SS4.p1.8.m8.4.4.1.2.cmml" xref="S3.SS4.p1.8.m8.4.4.1.1"><cn type="integer" id="S3.SS4.p1.8.m8.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1">1</cn><cn type="integer" id="S3.SS4.p1.8.m8.2.2.cmml" xref="S3.SS4.p1.8.m8.2.2">2</cn><ci id="S3.SS4.p1.8.m8.3.3.cmml" xref="S3.SS4.p1.8.m8.3.3">…</ci><apply id="S3.SS4.p1.8.m8.4.4.1.1.1.cmml" xref="S3.SS4.p1.8.m8.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m8.4.4.1.1.1.1.cmml" xref="S3.SS4.p1.8.m8.4.4.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.8.m8.4.4.1.1.1.2.cmml" xref="S3.SS4.p1.8.m8.4.4.1.1.1.2">𝑀</ci><ci id="S3.SS4.p1.8.m8.4.4.1.1.1.3.cmml" xref="S3.SS4.p1.8.m8.4.4.1.1.1.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m8.4c">n=1,2,\dots,M_{i}</annotation></semantics></math> where <math id="S3.SS4.p1.9.m9.1" class="ltx_Math" alttext="M_{i}" display="inline"><semantics id="S3.SS4.p1.9.m9.1a"><msub id="S3.SS4.p1.9.m9.1.1" xref="S3.SS4.p1.9.m9.1.1.cmml"><mi id="S3.SS4.p1.9.m9.1.1.2" xref="S3.SS4.p1.9.m9.1.1.2.cmml">M</mi><mi id="S3.SS4.p1.9.m9.1.1.3" xref="S3.SS4.p1.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.9.m9.1b"><apply id="S3.SS4.p1.9.m9.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m9.1.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS4.p1.9.m9.1.1.2.cmml" xref="S3.SS4.p1.9.m9.1.1.2">𝑀</ci><ci id="S3.SS4.p1.9.m9.1.1.3.cmml" xref="S3.SS4.p1.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.9.m9.1c">M_{i}</annotation></semantics></math> is the number of hidden nodes in layer <math id="S3.SS4.p1.10.m10.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS4.p1.10.m10.1a"><mi id="S3.SS4.p1.10.m10.1.1" xref="S3.SS4.p1.10.m10.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.10.m10.1b"><ci id="S3.SS4.p1.10.m10.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.10.m10.1c">i</annotation></semantics></math>. These values are concatenated to represent the row and this process is repeated for all rows to build the vector. For more hidden layers the process is repeated until we have one vector representing the network. This provides us with a representative vector, <math id="S3.SS4.p1.11.m11.1" class="ltx_Math" alttext="\mathbf{v}\in\mathbb{R}^{2\left(\sum_{l}^{h}M_{l}\right)}" display="inline"><semantics id="S3.SS4.p1.11.m11.1a"><mrow id="S3.SS4.p1.11.m11.1.2" xref="S3.SS4.p1.11.m11.1.2.cmml"><mi id="S3.SS4.p1.11.m11.1.2.2" xref="S3.SS4.p1.11.m11.1.2.2.cmml">𝐯</mi><mo id="S3.SS4.p1.11.m11.1.2.1" xref="S3.SS4.p1.11.m11.1.2.1.cmml">∈</mo><msup id="S3.SS4.p1.11.m11.1.2.3" xref="S3.SS4.p1.11.m11.1.2.3.cmml"><mi id="S3.SS4.p1.11.m11.1.2.3.2" xref="S3.SS4.p1.11.m11.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.11.m11.1.1.1" xref="S3.SS4.p1.11.m11.1.1.1.cmml"><mn id="S3.SS4.p1.11.m11.1.1.1.3" xref="S3.SS4.p1.11.m11.1.1.1.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS4.p1.11.m11.1.1.1.2" xref="S3.SS4.p1.11.m11.1.1.1.2.cmml">​</mo><mrow id="S3.SS4.p1.11.m11.1.1.1.1.1" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p1.11.m11.1.1.1.1.1.2" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p1.11.m11.1.1.1.1.1.1" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.cmml"><mstyle displaystyle="false" id="S3.SS4.p1.11.m11.1.1.1.1.1.1.1" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.1.cmml"><msubsup id="S3.SS4.p1.11.m11.1.1.1.1.1.1.1a" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p1.11.m11.1.1.1.1.1.1.1.2.2" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mi id="S3.SS4.p1.11.m11.1.1.1.1.1.1.1.2.3" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.1.2.3.cmml">l</mi><mi id="S3.SS4.p1.11.m11.1.1.1.1.1.1.1.3" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.1.3.cmml">h</mi></msubsup></mstyle><msub id="S3.SS4.p1.11.m11.1.1.1.1.1.1.2" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.cmml"><mi id="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.2" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.2.cmml">M</mi><mi id="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.3" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.3.cmml">l</mi></msub></mrow><mo id="S3.SS4.p1.11.m11.1.1.1.1.1.3" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.11.m11.1b"><apply id="S3.SS4.p1.11.m11.1.2.cmml" xref="S3.SS4.p1.11.m11.1.2"><in id="S3.SS4.p1.11.m11.1.2.1.cmml" xref="S3.SS4.p1.11.m11.1.2.1"></in><ci id="S3.SS4.p1.11.m11.1.2.2.cmml" xref="S3.SS4.p1.11.m11.1.2.2">𝐯</ci><apply id="S3.SS4.p1.11.m11.1.2.3.cmml" xref="S3.SS4.p1.11.m11.1.2.3"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m11.1.2.3.1.cmml" xref="S3.SS4.p1.11.m11.1.2.3">superscript</csymbol><ci id="S3.SS4.p1.11.m11.1.2.3.2.cmml" xref="S3.SS4.p1.11.m11.1.2.3.2">ℝ</ci><apply id="S3.SS4.p1.11.m11.1.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1.1"><times id="S3.SS4.p1.11.m11.1.1.1.2.cmml" xref="S3.SS4.p1.11.m11.1.1.1.2"></times><cn type="integer" id="S3.SS4.p1.11.m11.1.1.1.3.cmml" xref="S3.SS4.p1.11.m11.1.1.1.3">2</cn><apply id="S3.SS4.p1.11.m11.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.1"><apply id="S3.SS4.p1.11.m11.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m11.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS4.p1.11.m11.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m11.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.SS4.p1.11.m11.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.1.2.2"></sum><ci id="S3.SS4.p1.11.m11.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.SS4.p1.11.m11.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.1.3">ℎ</ci></apply><apply id="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.2">𝑀</ci><ci id="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.11.m11.1c">\mathbf{v}\in\mathbb{R}^{2\left(\sum_{l}^{h}M_{l}\right)}</annotation></semantics></math>, where <math id="S3.SS4.p1.12.m12.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS4.p1.12.m12.1a"><mi id="S3.SS4.p1.12.m12.1.1" xref="S3.SS4.p1.12.m12.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.12.m12.1b"><ci id="S3.SS4.p1.12.m12.1.1.cmml" xref="S3.SS4.p1.12.m12.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.12.m12.1c">h</annotation></semantics></math> is the number of hidden layers. This vector is what is fed to the teacher to understand the state of the student.</p>
</div>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>The Scheduler</h3>

<div id="S3.SS5.p1" class="ltx_para">
<p id="S3.SS5.p1.1" class="ltx_p">The scheduler is the last of our agents in the training setup. This is also a neural network that takes the student state as input and selects which of the nodes the training data should come from at the current iteration of training. This agent is trained using the meta-gradients generated from validation losses similarly to how they are employed in <cite class="ltx_cite ltx_citemacro_citep">(Such et al., <a href="#bib.bib25" title="" class="ltx_ref">2019</a>)</cite>. We have an ‘inner’ loop of training whereby the student-teacher interaction takes place. In the ‘outer’ loop, we aggregate the losses on validation sets at each node and use this aggregated loss as the signal to update the weights of our scheduler.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2107.01707/assets/meta_gradient_training_diagram_reshifted.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="333" height="188" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>A diagram displaying what happens in the training routine every iteration. The black arrows indicate selection, the blue indicate the extraction of state, the dashed indicate the transfer of a model and the orange indicate the movement of losses.</figcaption>
</figure>
<div id="S3.SS5.p2" class="ltx_para">
<p id="S3.SS5.p2.15" class="ltx_p">Figure <a href="#S3.F1" title="Figure 1 ‣ 3.5 The Scheduler ‣ 3 Methodology ‣ Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows diagrammatically the training procedure at every iteration of training. In the outer loop the scheduler selects the node(s) to use for data selection. The global student model is sent to the node and the teacher at the node then selects the data in the inner loop and trains the student network on this. The student is then sent back to the central node and distributed to all nodes. This student is tested on separate validation sets at each node and their losses are aggregated by summing them. They are then used as the loss to update the scheduler. The inner loop loss function is dependent upon the target task with crossentropy used for classification and mean squared error used for regression. The scheduler is updated as:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.2" class="ltx_Math" alttext="\theta_{sc}^{t+1}=\theta_{sc}^{t}+\omega\sum_{0\leq t^{\prime}\leq t}\alpha^{t-t^{\prime}}\nabla\left(\mathcal{L}_{inner}\right)" display="block"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml"><msubsup id="S3.E5.m1.2.2.3" xref="S3.E5.m1.2.2.3.cmml"><mi id="S3.E5.m1.2.2.3.2.2" xref="S3.E5.m1.2.2.3.2.2.cmml">θ</mi><mrow id="S3.E5.m1.2.2.3.2.3" xref="S3.E5.m1.2.2.3.2.3.cmml"><mi id="S3.E5.m1.2.2.3.2.3.2" xref="S3.E5.m1.2.2.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.3.2.3.1" xref="S3.E5.m1.2.2.3.2.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.3.2.3.3" xref="S3.E5.m1.2.2.3.2.3.3.cmml">c</mi></mrow><mrow id="S3.E5.m1.2.2.3.3" xref="S3.E5.m1.2.2.3.3.cmml"><mi id="S3.E5.m1.2.2.3.3.2" xref="S3.E5.m1.2.2.3.3.2.cmml">t</mi><mo id="S3.E5.m1.2.2.3.3.1" xref="S3.E5.m1.2.2.3.3.1.cmml">+</mo><mn id="S3.E5.m1.2.2.3.3.3" xref="S3.E5.m1.2.2.3.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.2.cmml">=</mo><mrow id="S3.E5.m1.2.2.1" xref="S3.E5.m1.2.2.1.cmml"><msubsup id="S3.E5.m1.2.2.1.3" xref="S3.E5.m1.2.2.1.3.cmml"><mi id="S3.E5.m1.2.2.1.3.2.2" xref="S3.E5.m1.2.2.1.3.2.2.cmml">θ</mi><mrow id="S3.E5.m1.2.2.1.3.2.3" xref="S3.E5.m1.2.2.1.3.2.3.cmml"><mi id="S3.E5.m1.2.2.1.3.2.3.2" xref="S3.E5.m1.2.2.1.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.3.2.3.1" xref="S3.E5.m1.2.2.1.3.2.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.1.3.2.3.3" xref="S3.E5.m1.2.2.1.3.2.3.3.cmml">c</mi></mrow><mi id="S3.E5.m1.2.2.1.3.3" xref="S3.E5.m1.2.2.1.3.3.cmml">t</mi></msubsup><mo id="S3.E5.m1.2.2.1.2" xref="S3.E5.m1.2.2.1.2.cmml">+</mo><mrow id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.3" xref="S3.E5.m1.2.2.1.1.3.cmml">ω</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.2" xref="S3.E5.m1.2.2.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.2.2.1.1.1" xref="S3.E5.m1.2.2.1.1.1.cmml"><munder id="S3.E5.m1.2.2.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E5.m1.2.2.1.1.1.2.2" xref="S3.E5.m1.2.2.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E5.m1.2.2.1.1.1.2.3" xref="S3.E5.m1.2.2.1.1.1.2.3.cmml"><mn id="S3.E5.m1.2.2.1.1.1.2.3.2" xref="S3.E5.m1.2.2.1.1.1.2.3.2.cmml">0</mn><mo id="S3.E5.m1.2.2.1.1.1.2.3.3" xref="S3.E5.m1.2.2.1.1.1.2.3.3.cmml">≤</mo><msup id="S3.E5.m1.2.2.1.1.1.2.3.4" xref="S3.E5.m1.2.2.1.1.1.2.3.4.cmml"><mi id="S3.E5.m1.2.2.1.1.1.2.3.4.2" xref="S3.E5.m1.2.2.1.1.1.2.3.4.2.cmml">t</mi><mo id="S3.E5.m1.2.2.1.1.1.2.3.4.3" xref="S3.E5.m1.2.2.1.1.1.2.3.4.3.cmml">′</mo></msup><mo id="S3.E5.m1.2.2.1.1.1.2.3.5" xref="S3.E5.m1.2.2.1.1.1.2.3.5.cmml">≤</mo><mi id="S3.E5.m1.2.2.1.1.1.2.3.6" xref="S3.E5.m1.2.2.1.1.1.2.3.6.cmml">t</mi></mrow></munder><mrow id="S3.E5.m1.2.2.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.cmml"><msup id="S3.E5.m1.2.2.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.3.2" xref="S3.E5.m1.2.2.1.1.1.1.3.2.cmml">α</mi><mrow id="S3.E5.m1.2.2.1.1.1.1.3.3" xref="S3.E5.m1.2.2.1.1.1.1.3.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.3.3.2" xref="S3.E5.m1.2.2.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.E5.m1.2.2.1.1.1.1.3.3.1" xref="S3.E5.m1.2.2.1.1.1.1.3.3.1.cmml">−</mo><msup id="S3.E5.m1.2.2.1.1.1.1.3.3.3" xref="S3.E5.m1.2.2.1.1.1.1.3.3.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.3.3.3.2" xref="S3.E5.m1.2.2.1.1.1.1.3.3.3.2.cmml">t</mi><mo id="S3.E5.m1.2.2.1.1.1.1.3.3.3.3" xref="S3.E5.m1.2.2.1.1.1.1.3.3.3.3.cmml">′</mo></msup></mrow></msup><mo lspace="0.167em" rspace="0em" id="S3.E5.m1.2.2.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">∇</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">ℒ</mi><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.1a" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.4" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.1b" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.5" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.1c" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.6" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.6.cmml">r</mi></mrow></msub><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2"><eq id="S3.E5.m1.2.2.2.cmml" xref="S3.E5.m1.2.2.2"></eq><apply id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.3.1.cmml" xref="S3.E5.m1.2.2.3">superscript</csymbol><apply id="S3.E5.m1.2.2.3.2.cmml" xref="S3.E5.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.3.2.1.cmml" xref="S3.E5.m1.2.2.3">subscript</csymbol><ci id="S3.E5.m1.2.2.3.2.2.cmml" xref="S3.E5.m1.2.2.3.2.2">𝜃</ci><apply id="S3.E5.m1.2.2.3.2.3.cmml" xref="S3.E5.m1.2.2.3.2.3"><times id="S3.E5.m1.2.2.3.2.3.1.cmml" xref="S3.E5.m1.2.2.3.2.3.1"></times><ci id="S3.E5.m1.2.2.3.2.3.2.cmml" xref="S3.E5.m1.2.2.3.2.3.2">𝑠</ci><ci id="S3.E5.m1.2.2.3.2.3.3.cmml" xref="S3.E5.m1.2.2.3.2.3.3">𝑐</ci></apply></apply><apply id="S3.E5.m1.2.2.3.3.cmml" xref="S3.E5.m1.2.2.3.3"><plus id="S3.E5.m1.2.2.3.3.1.cmml" xref="S3.E5.m1.2.2.3.3.1"></plus><ci id="S3.E5.m1.2.2.3.3.2.cmml" xref="S3.E5.m1.2.2.3.3.2">𝑡</ci><cn type="integer" id="S3.E5.m1.2.2.3.3.3.cmml" xref="S3.E5.m1.2.2.3.3.3">1</cn></apply></apply><apply id="S3.E5.m1.2.2.1.cmml" xref="S3.E5.m1.2.2.1"><plus id="S3.E5.m1.2.2.1.2.cmml" xref="S3.E5.m1.2.2.1.2"></plus><apply id="S3.E5.m1.2.2.1.3.cmml" xref="S3.E5.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.3.1.cmml" xref="S3.E5.m1.2.2.1.3">superscript</csymbol><apply id="S3.E5.m1.2.2.1.3.2.cmml" xref="S3.E5.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.3.2.1.cmml" xref="S3.E5.m1.2.2.1.3">subscript</csymbol><ci id="S3.E5.m1.2.2.1.3.2.2.cmml" xref="S3.E5.m1.2.2.1.3.2.2">𝜃</ci><apply id="S3.E5.m1.2.2.1.3.2.3.cmml" xref="S3.E5.m1.2.2.1.3.2.3"><times id="S3.E5.m1.2.2.1.3.2.3.1.cmml" xref="S3.E5.m1.2.2.1.3.2.3.1"></times><ci id="S3.E5.m1.2.2.1.3.2.3.2.cmml" xref="S3.E5.m1.2.2.1.3.2.3.2">𝑠</ci><ci id="S3.E5.m1.2.2.1.3.2.3.3.cmml" xref="S3.E5.m1.2.2.1.3.2.3.3">𝑐</ci></apply></apply><ci id="S3.E5.m1.2.2.1.3.3.cmml" xref="S3.E5.m1.2.2.1.3.3">𝑡</ci></apply><apply id="S3.E5.m1.2.2.1.1.cmml" xref="S3.E5.m1.2.2.1.1"><times id="S3.E5.m1.2.2.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.2"></times><ci id="S3.E5.m1.2.2.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.3">𝜔</ci><apply id="S3.E5.m1.2.2.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1"><apply id="S3.E5.m1.2.2.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.2">subscript</csymbol><sum id="S3.E5.m1.2.2.1.1.1.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.2.2"></sum><apply id="S3.E5.m1.2.2.1.1.1.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.2.3"><and id="S3.E5.m1.2.2.1.1.1.2.3a.cmml" xref="S3.E5.m1.2.2.1.1.1.2.3"></and><apply id="S3.E5.m1.2.2.1.1.1.2.3b.cmml" xref="S3.E5.m1.2.2.1.1.1.2.3"><leq id="S3.E5.m1.2.2.1.1.1.2.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.2.3.3"></leq><cn type="integer" id="S3.E5.m1.2.2.1.1.1.2.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.2.3.2">0</cn><apply id="S3.E5.m1.2.2.1.1.1.2.3.4.cmml" xref="S3.E5.m1.2.2.1.1.1.2.3.4"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.2.3.4.1.cmml" xref="S3.E5.m1.2.2.1.1.1.2.3.4">superscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.2.3.4.2.cmml" xref="S3.E5.m1.2.2.1.1.1.2.3.4.2">𝑡</ci><ci id="S3.E5.m1.2.2.1.1.1.2.3.4.3.cmml" xref="S3.E5.m1.2.2.1.1.1.2.3.4.3">′</ci></apply></apply><apply id="S3.E5.m1.2.2.1.1.1.2.3c.cmml" xref="S3.E5.m1.2.2.1.1.1.2.3"><leq id="S3.E5.m1.2.2.1.1.1.2.3.5.cmml" xref="S3.E5.m1.2.2.1.1.1.2.3.5"></leq><share href="#S3.E5.m1.2.2.1.1.1.2.3.4.cmml" id="S3.E5.m1.2.2.1.1.1.2.3d.cmml" xref="S3.E5.m1.2.2.1.1.1.2.3"></share><ci id="S3.E5.m1.2.2.1.1.1.2.3.6.cmml" xref="S3.E5.m1.2.2.1.1.1.2.3.6">𝑡</ci></apply></apply></apply><apply id="S3.E5.m1.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1"><times id="S3.E5.m1.2.2.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.2"></times><apply id="S3.E5.m1.2.2.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3">superscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.2">𝛼</ci><apply id="S3.E5.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.3"><minus id="S3.E5.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.3.1"></minus><ci id="S3.E5.m1.2.2.1.1.1.1.3.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.3.2">𝑡</ci><apply id="S3.E5.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.3.3">superscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.3.3.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.3.3.2">𝑡</ci><ci id="S3.E5.m1.2.2.1.1.1.1.3.3.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.3.3.3">′</ci></apply></apply></apply><apply id="S3.E5.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1"><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">∇</ci><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2">ℒ</ci><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3"><times id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.3">𝑛</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.4">𝑛</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.5.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.5">𝑒</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.6.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.6">𝑟</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\theta_{sc}^{t+1}=\theta_{sc}^{t}+\omega\sum_{0\leq t^{\prime}\leq t}\alpha^{t-t^{\prime}}\nabla\left(\mathcal{L}_{inner}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS5.p2.1" class="ltx_p">where <math id="S3.SS5.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{inner}" display="inline"><semantics id="S3.SS5.p2.1.m1.1a"><msub id="S3.SS5.p2.1.m1.1.1" xref="S3.SS5.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p2.1.m1.1.1.2" xref="S3.SS5.p2.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.SS5.p2.1.m1.1.1.3" xref="S3.SS5.p2.1.m1.1.1.3.cmml"><mi id="S3.SS5.p2.1.m1.1.1.3.2" xref="S3.SS5.p2.1.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p2.1.m1.1.1.3.1" xref="S3.SS5.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p2.1.m1.1.1.3.3" xref="S3.SS5.p2.1.m1.1.1.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p2.1.m1.1.1.3.1a" xref="S3.SS5.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p2.1.m1.1.1.3.4" xref="S3.SS5.p2.1.m1.1.1.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p2.1.m1.1.1.3.1b" xref="S3.SS5.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p2.1.m1.1.1.3.5" xref="S3.SS5.p2.1.m1.1.1.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p2.1.m1.1.1.3.1c" xref="S3.SS5.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p2.1.m1.1.1.3.6" xref="S3.SS5.p2.1.m1.1.1.3.6.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.1.m1.1b"><apply id="S3.SS5.p2.1.m1.1.1.cmml" xref="S3.SS5.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.1.m1.1.1.1.cmml" xref="S3.SS5.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS5.p2.1.m1.1.1.2.cmml" xref="S3.SS5.p2.1.m1.1.1.2">ℒ</ci><apply id="S3.SS5.p2.1.m1.1.1.3.cmml" xref="S3.SS5.p2.1.m1.1.1.3"><times id="S3.SS5.p2.1.m1.1.1.3.1.cmml" xref="S3.SS5.p2.1.m1.1.1.3.1"></times><ci id="S3.SS5.p2.1.m1.1.1.3.2.cmml" xref="S3.SS5.p2.1.m1.1.1.3.2">𝑖</ci><ci id="S3.SS5.p2.1.m1.1.1.3.3.cmml" xref="S3.SS5.p2.1.m1.1.1.3.3">𝑛</ci><ci id="S3.SS5.p2.1.m1.1.1.3.4.cmml" xref="S3.SS5.p2.1.m1.1.1.3.4">𝑛</ci><ci id="S3.SS5.p2.1.m1.1.1.3.5.cmml" xref="S3.SS5.p2.1.m1.1.1.3.5">𝑒</ci><ci id="S3.SS5.p2.1.m1.1.1.3.6.cmml" xref="S3.SS5.p2.1.m1.1.1.3.6">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.1.m1.1c">\mathcal{L}_{inner}</annotation></semantics></math> is given by:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.6" class="ltx_Math" alttext="\ell_{inner}\left(T\left(\mathbf{s}_{t};\theta_{te}\right),\mathbf{y}^{*}_{t};\theta_{st}\right)\\
+\sum_{n=1}^{N-1}\ell_{inner}\left(\mathbf{x}^{n}_{v},\mathbf{y}^{n}_{v};\theta_{st}\right)" display="block"><semantics id="S3.E6.m1.6a"><mrow id="S3.E6.m1.6.6" xref="S3.E6.m1.6.6.cmml"><mrow id="S3.E6.m1.3.3.3" xref="S3.E6.m1.3.3.3.cmml"><msub id="S3.E6.m1.3.3.3.5" xref="S3.E6.m1.3.3.3.5.cmml"><mi mathvariant="normal" id="S3.E6.m1.3.3.3.5.2" xref="S3.E6.m1.3.3.3.5.2.cmml">ℓ</mi><mrow id="S3.E6.m1.3.3.3.5.3" xref="S3.E6.m1.3.3.3.5.3.cmml"><mi id="S3.E6.m1.3.3.3.5.3.2" xref="S3.E6.m1.3.3.3.5.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.3.5.3.1" xref="S3.E6.m1.3.3.3.5.3.1.cmml">​</mo><mi id="S3.E6.m1.3.3.3.5.3.3" xref="S3.E6.m1.3.3.3.5.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.3.5.3.1a" xref="S3.E6.m1.3.3.3.5.3.1.cmml">​</mo><mi id="S3.E6.m1.3.3.3.5.3.4" xref="S3.E6.m1.3.3.3.5.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.3.5.3.1b" xref="S3.E6.m1.3.3.3.5.3.1.cmml">​</mo><mi id="S3.E6.m1.3.3.3.5.3.5" xref="S3.E6.m1.3.3.3.5.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.3.5.3.1c" xref="S3.E6.m1.3.3.3.5.3.1.cmml">​</mo><mi id="S3.E6.m1.3.3.3.5.3.6" xref="S3.E6.m1.3.3.3.5.3.6.cmml">r</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.3.4" xref="S3.E6.m1.3.3.3.4.cmml">​</mo><mrow id="S3.E6.m1.3.3.3.3.3" xref="S3.E6.m1.3.3.3.3.4.cmml"><mo id="S3.E6.m1.3.3.3.3.3.4" xref="S3.E6.m1.3.3.3.3.4.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.4" xref="S3.E6.m1.1.1.1.1.1.1.4.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E6.m1.1.1.1.1.1.1.2.2.3" xref="S3.E6.m1.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S3.E6.m1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝐬</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E6.m1.1.1.1.1.1.1.2.2.4" xref="S3.E6.m1.1.1.1.1.1.1.2.3.cmml">;</mo><msub id="S3.E6.m1.1.1.1.1.1.1.2.2.2" xref="S3.E6.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.2.2.2.2" xref="S3.E6.m1.1.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mrow id="S3.E6.m1.1.1.1.1.1.1.2.2.2.3" xref="S3.E6.m1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.2.2.2.3.2" xref="S3.E6.m1.1.1.1.1.1.1.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.1.2.2.2.3.1" xref="S3.E6.m1.1.1.1.1.1.1.2.2.2.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.1.2.2.2.3.3" xref="S3.E6.m1.1.1.1.1.1.1.2.2.2.3.3.cmml">e</mi></mrow></msub><mo id="S3.E6.m1.1.1.1.1.1.1.2.2.5" xref="S3.E6.m1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.3.3.3.3.3.5" xref="S3.E6.m1.3.3.3.3.4.cmml">,</mo><msubsup id="S3.E6.m1.2.2.2.2.2.2" xref="S3.E6.m1.2.2.2.2.2.2.cmml"><mi id="S3.E6.m1.2.2.2.2.2.2.2.2" xref="S3.E6.m1.2.2.2.2.2.2.2.2.cmml">𝐲</mi><mi id="S3.E6.m1.2.2.2.2.2.2.3" xref="S3.E6.m1.2.2.2.2.2.2.3.cmml">t</mi><mo id="S3.E6.m1.2.2.2.2.2.2.2.3" xref="S3.E6.m1.2.2.2.2.2.2.2.3.cmml">∗</mo></msubsup><mo id="S3.E6.m1.3.3.3.3.3.6" xref="S3.E6.m1.3.3.3.3.4.cmml">;</mo><msub id="S3.E6.m1.3.3.3.3.3.3" xref="S3.E6.m1.3.3.3.3.3.3.cmml"><mi id="S3.E6.m1.3.3.3.3.3.3.2" xref="S3.E6.m1.3.3.3.3.3.3.2.cmml">θ</mi><mrow id="S3.E6.m1.3.3.3.3.3.3.3" xref="S3.E6.m1.3.3.3.3.3.3.3.cmml"><mi id="S3.E6.m1.3.3.3.3.3.3.3.2" xref="S3.E6.m1.3.3.3.3.3.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.3.3.3.3.3.1" xref="S3.E6.m1.3.3.3.3.3.3.3.1.cmml">​</mo><mi id="S3.E6.m1.3.3.3.3.3.3.3.3" xref="S3.E6.m1.3.3.3.3.3.3.3.3.cmml">t</mi></mrow></msub><mo id="S3.E6.m1.3.3.3.3.3.7" xref="S3.E6.m1.3.3.3.3.4.cmml">)</mo></mrow></mrow><mo rspace="0.055em" id="S3.E6.m1.6.6.7" xref="S3.E6.m1.6.6.7.cmml">+</mo><mrow id="S3.E6.m1.6.6.6" xref="S3.E6.m1.6.6.6.cmml"><munderover id="S3.E6.m1.6.6.6.4" xref="S3.E6.m1.6.6.6.4.cmml"><mo movablelimits="false" id="S3.E6.m1.6.6.6.4.2.2" xref="S3.E6.m1.6.6.6.4.2.2.cmml">∑</mo><mrow id="S3.E6.m1.6.6.6.4.2.3" xref="S3.E6.m1.6.6.6.4.2.3.cmml"><mi id="S3.E6.m1.6.6.6.4.2.3.2" xref="S3.E6.m1.6.6.6.4.2.3.2.cmml">n</mi><mo id="S3.E6.m1.6.6.6.4.2.3.1" xref="S3.E6.m1.6.6.6.4.2.3.1.cmml">=</mo><mn id="S3.E6.m1.6.6.6.4.2.3.3" xref="S3.E6.m1.6.6.6.4.2.3.3.cmml">1</mn></mrow><mrow id="S3.E6.m1.6.6.6.4.3" xref="S3.E6.m1.6.6.6.4.3.cmml"><mi id="S3.E6.m1.6.6.6.4.3.2" xref="S3.E6.m1.6.6.6.4.3.2.cmml">N</mi><mo id="S3.E6.m1.6.6.6.4.3.1" xref="S3.E6.m1.6.6.6.4.3.1.cmml">−</mo><mn id="S3.E6.m1.6.6.6.4.3.3" xref="S3.E6.m1.6.6.6.4.3.3.cmml">1</mn></mrow></munderover><mrow id="S3.E6.m1.6.6.6.3" xref="S3.E6.m1.6.6.6.3.cmml"><msub id="S3.E6.m1.6.6.6.3.5" xref="S3.E6.m1.6.6.6.3.5.cmml"><mi mathvariant="normal" id="S3.E6.m1.6.6.6.3.5.2" xref="S3.E6.m1.6.6.6.3.5.2.cmml">ℓ</mi><mrow id="S3.E6.m1.6.6.6.3.5.3" xref="S3.E6.m1.6.6.6.3.5.3.cmml"><mi id="S3.E6.m1.6.6.6.3.5.3.2" xref="S3.E6.m1.6.6.6.3.5.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.6.6.6.3.5.3.1" xref="S3.E6.m1.6.6.6.3.5.3.1.cmml">​</mo><mi id="S3.E6.m1.6.6.6.3.5.3.3" xref="S3.E6.m1.6.6.6.3.5.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.6.6.6.3.5.3.1a" xref="S3.E6.m1.6.6.6.3.5.3.1.cmml">​</mo><mi id="S3.E6.m1.6.6.6.3.5.3.4" xref="S3.E6.m1.6.6.6.3.5.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.6.6.6.3.5.3.1b" xref="S3.E6.m1.6.6.6.3.5.3.1.cmml">​</mo><mi id="S3.E6.m1.6.6.6.3.5.3.5" xref="S3.E6.m1.6.6.6.3.5.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.6.6.6.3.5.3.1c" xref="S3.E6.m1.6.6.6.3.5.3.1.cmml">​</mo><mi id="S3.E6.m1.6.6.6.3.5.3.6" xref="S3.E6.m1.6.6.6.3.5.3.6.cmml">r</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.6.6.6.3.4" xref="S3.E6.m1.6.6.6.3.4.cmml">​</mo><mrow id="S3.E6.m1.6.6.6.3.3.3" xref="S3.E6.m1.6.6.6.3.3.4.cmml"><mo id="S3.E6.m1.6.6.6.3.3.3.4" xref="S3.E6.m1.6.6.6.3.3.4.cmml">(</mo><msubsup id="S3.E6.m1.4.4.4.1.1.1.1" xref="S3.E6.m1.4.4.4.1.1.1.1.cmml"><mi id="S3.E6.m1.4.4.4.1.1.1.1.2.2" xref="S3.E6.m1.4.4.4.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.E6.m1.4.4.4.1.1.1.1.3" xref="S3.E6.m1.4.4.4.1.1.1.1.3.cmml">v</mi><mi id="S3.E6.m1.4.4.4.1.1.1.1.2.3" xref="S3.E6.m1.4.4.4.1.1.1.1.2.3.cmml">n</mi></msubsup><mo id="S3.E6.m1.6.6.6.3.3.3.5" xref="S3.E6.m1.6.6.6.3.3.4.cmml">,</mo><msubsup id="S3.E6.m1.5.5.5.2.2.2.2" xref="S3.E6.m1.5.5.5.2.2.2.2.cmml"><mi id="S3.E6.m1.5.5.5.2.2.2.2.2.2" xref="S3.E6.m1.5.5.5.2.2.2.2.2.2.cmml">𝐲</mi><mi id="S3.E6.m1.5.5.5.2.2.2.2.3" xref="S3.E6.m1.5.5.5.2.2.2.2.3.cmml">v</mi><mi id="S3.E6.m1.5.5.5.2.2.2.2.2.3" xref="S3.E6.m1.5.5.5.2.2.2.2.2.3.cmml">n</mi></msubsup><mo id="S3.E6.m1.6.6.6.3.3.3.6" xref="S3.E6.m1.6.6.6.3.3.4.cmml">;</mo><msub id="S3.E6.m1.6.6.6.3.3.3.3" xref="S3.E6.m1.6.6.6.3.3.3.3.cmml"><mi id="S3.E6.m1.6.6.6.3.3.3.3.2" xref="S3.E6.m1.6.6.6.3.3.3.3.2.cmml">θ</mi><mrow id="S3.E6.m1.6.6.6.3.3.3.3.3" xref="S3.E6.m1.6.6.6.3.3.3.3.3.cmml"><mi id="S3.E6.m1.6.6.6.3.3.3.3.3.2" xref="S3.E6.m1.6.6.6.3.3.3.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.6.6.6.3.3.3.3.3.1" xref="S3.E6.m1.6.6.6.3.3.3.3.3.1.cmml">​</mo><mi id="S3.E6.m1.6.6.6.3.3.3.3.3.3" xref="S3.E6.m1.6.6.6.3.3.3.3.3.3.cmml">t</mi></mrow></msub><mo id="S3.E6.m1.6.6.6.3.3.3.7" xref="S3.E6.m1.6.6.6.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.6b"><apply id="S3.E6.m1.6.6.cmml" xref="S3.E6.m1.6.6"><plus id="S3.E6.m1.6.6.7.cmml" xref="S3.E6.m1.6.6.7"></plus><apply id="S3.E6.m1.3.3.3.cmml" xref="S3.E6.m1.3.3.3"><times id="S3.E6.m1.3.3.3.4.cmml" xref="S3.E6.m1.3.3.3.4"></times><apply id="S3.E6.m1.3.3.3.5.cmml" xref="S3.E6.m1.3.3.3.5"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.5.1.cmml" xref="S3.E6.m1.3.3.3.5">subscript</csymbol><ci id="S3.E6.m1.3.3.3.5.2.cmml" xref="S3.E6.m1.3.3.3.5.2">ℓ</ci><apply id="S3.E6.m1.3.3.3.5.3.cmml" xref="S3.E6.m1.3.3.3.5.3"><times id="S3.E6.m1.3.3.3.5.3.1.cmml" xref="S3.E6.m1.3.3.3.5.3.1"></times><ci id="S3.E6.m1.3.3.3.5.3.2.cmml" xref="S3.E6.m1.3.3.3.5.3.2">𝑖</ci><ci id="S3.E6.m1.3.3.3.5.3.3.cmml" xref="S3.E6.m1.3.3.3.5.3.3">𝑛</ci><ci id="S3.E6.m1.3.3.3.5.3.4.cmml" xref="S3.E6.m1.3.3.3.5.3.4">𝑛</ci><ci id="S3.E6.m1.3.3.3.5.3.5.cmml" xref="S3.E6.m1.3.3.3.5.3.5">𝑒</ci><ci id="S3.E6.m1.3.3.3.5.3.6.cmml" xref="S3.E6.m1.3.3.3.5.3.6">𝑟</ci></apply></apply><vector id="S3.E6.m1.3.3.3.3.4.cmml" xref="S3.E6.m1.3.3.3.3.3"><apply id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3"></times><ci id="S3.E6.m1.1.1.1.1.1.1.4.cmml" xref="S3.E6.m1.1.1.1.1.1.1.4">𝑇</ci><list id="S3.E6.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2"><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2">𝐬</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2.2.2">𝜃</ci><apply id="S3.E6.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2.2.3"><times id="S3.E6.m1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2.2.3.1"></times><ci id="S3.E6.m1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2.2.3.2">𝑡</ci><ci id="S3.E6.m1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2.2.3.3">𝑒</ci></apply></apply></list></apply><apply id="S3.E6.m1.2.2.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.2.2.2.1.cmml" xref="S3.E6.m1.2.2.2.2.2.2">subscript</csymbol><apply id="S3.E6.m1.2.2.2.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E6.m1.2.2.2.2.2.2">superscript</csymbol><ci id="S3.E6.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2.2.2.2.2">𝐲</ci><times id="S3.E6.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.2.2.2.2.3"></times></apply><ci id="S3.E6.m1.2.2.2.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.2.2.2.3">𝑡</ci></apply><apply id="S3.E6.m1.3.3.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.3.3.3.1.cmml" xref="S3.E6.m1.3.3.3.3.3.3">subscript</csymbol><ci id="S3.E6.m1.3.3.3.3.3.3.2.cmml" xref="S3.E6.m1.3.3.3.3.3.3.2">𝜃</ci><apply id="S3.E6.m1.3.3.3.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3.3.3.3"><times id="S3.E6.m1.3.3.3.3.3.3.3.1.cmml" xref="S3.E6.m1.3.3.3.3.3.3.3.1"></times><ci id="S3.E6.m1.3.3.3.3.3.3.3.2.cmml" xref="S3.E6.m1.3.3.3.3.3.3.3.2">𝑠</ci><ci id="S3.E6.m1.3.3.3.3.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3.3.3.3.3">𝑡</ci></apply></apply></vector></apply><apply id="S3.E6.m1.6.6.6.cmml" xref="S3.E6.m1.6.6.6"><apply id="S3.E6.m1.6.6.6.4.cmml" xref="S3.E6.m1.6.6.6.4"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.6.4.1.cmml" xref="S3.E6.m1.6.6.6.4">superscript</csymbol><apply id="S3.E6.m1.6.6.6.4.2.cmml" xref="S3.E6.m1.6.6.6.4"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.6.4.2.1.cmml" xref="S3.E6.m1.6.6.6.4">subscript</csymbol><sum id="S3.E6.m1.6.6.6.4.2.2.cmml" xref="S3.E6.m1.6.6.6.4.2.2"></sum><apply id="S3.E6.m1.6.6.6.4.2.3.cmml" xref="S3.E6.m1.6.6.6.4.2.3"><eq id="S3.E6.m1.6.6.6.4.2.3.1.cmml" xref="S3.E6.m1.6.6.6.4.2.3.1"></eq><ci id="S3.E6.m1.6.6.6.4.2.3.2.cmml" xref="S3.E6.m1.6.6.6.4.2.3.2">𝑛</ci><cn type="integer" id="S3.E6.m1.6.6.6.4.2.3.3.cmml" xref="S3.E6.m1.6.6.6.4.2.3.3">1</cn></apply></apply><apply id="S3.E6.m1.6.6.6.4.3.cmml" xref="S3.E6.m1.6.6.6.4.3"><minus id="S3.E6.m1.6.6.6.4.3.1.cmml" xref="S3.E6.m1.6.6.6.4.3.1"></minus><ci id="S3.E6.m1.6.6.6.4.3.2.cmml" xref="S3.E6.m1.6.6.6.4.3.2">𝑁</ci><cn type="integer" id="S3.E6.m1.6.6.6.4.3.3.cmml" xref="S3.E6.m1.6.6.6.4.3.3">1</cn></apply></apply><apply id="S3.E6.m1.6.6.6.3.cmml" xref="S3.E6.m1.6.6.6.3"><times id="S3.E6.m1.6.6.6.3.4.cmml" xref="S3.E6.m1.6.6.6.3.4"></times><apply id="S3.E6.m1.6.6.6.3.5.cmml" xref="S3.E6.m1.6.6.6.3.5"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.6.3.5.1.cmml" xref="S3.E6.m1.6.6.6.3.5">subscript</csymbol><ci id="S3.E6.m1.6.6.6.3.5.2.cmml" xref="S3.E6.m1.6.6.6.3.5.2">ℓ</ci><apply id="S3.E6.m1.6.6.6.3.5.3.cmml" xref="S3.E6.m1.6.6.6.3.5.3"><times id="S3.E6.m1.6.6.6.3.5.3.1.cmml" xref="S3.E6.m1.6.6.6.3.5.3.1"></times><ci id="S3.E6.m1.6.6.6.3.5.3.2.cmml" xref="S3.E6.m1.6.6.6.3.5.3.2">𝑖</ci><ci id="S3.E6.m1.6.6.6.3.5.3.3.cmml" xref="S3.E6.m1.6.6.6.3.5.3.3">𝑛</ci><ci id="S3.E6.m1.6.6.6.3.5.3.4.cmml" xref="S3.E6.m1.6.6.6.3.5.3.4">𝑛</ci><ci id="S3.E6.m1.6.6.6.3.5.3.5.cmml" xref="S3.E6.m1.6.6.6.3.5.3.5">𝑒</ci><ci id="S3.E6.m1.6.6.6.3.5.3.6.cmml" xref="S3.E6.m1.6.6.6.3.5.3.6">𝑟</ci></apply></apply><vector id="S3.E6.m1.6.6.6.3.3.4.cmml" xref="S3.E6.m1.6.6.6.3.3.3"><apply id="S3.E6.m1.4.4.4.1.1.1.1.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.4.1.1.1.1.1.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1">subscript</csymbol><apply id="S3.E6.m1.4.4.4.1.1.1.1.2.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.4.1.1.1.1.2.1.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1">superscript</csymbol><ci id="S3.E6.m1.4.4.4.1.1.1.1.2.2.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1.2.2">𝐱</ci><ci id="S3.E6.m1.4.4.4.1.1.1.1.2.3.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1.2.3">𝑛</ci></apply><ci id="S3.E6.m1.4.4.4.1.1.1.1.3.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1.3">𝑣</ci></apply><apply id="S3.E6.m1.5.5.5.2.2.2.2.cmml" xref="S3.E6.m1.5.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.5.2.2.2.2.1.cmml" xref="S3.E6.m1.5.5.5.2.2.2.2">subscript</csymbol><apply id="S3.E6.m1.5.5.5.2.2.2.2.2.cmml" xref="S3.E6.m1.5.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.5.2.2.2.2.2.1.cmml" xref="S3.E6.m1.5.5.5.2.2.2.2">superscript</csymbol><ci id="S3.E6.m1.5.5.5.2.2.2.2.2.2.cmml" xref="S3.E6.m1.5.5.5.2.2.2.2.2.2">𝐲</ci><ci id="S3.E6.m1.5.5.5.2.2.2.2.2.3.cmml" xref="S3.E6.m1.5.5.5.2.2.2.2.2.3">𝑛</ci></apply><ci id="S3.E6.m1.5.5.5.2.2.2.2.3.cmml" xref="S3.E6.m1.5.5.5.2.2.2.2.3">𝑣</ci></apply><apply id="S3.E6.m1.6.6.6.3.3.3.3.cmml" xref="S3.E6.m1.6.6.6.3.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.6.3.3.3.3.1.cmml" xref="S3.E6.m1.6.6.6.3.3.3.3">subscript</csymbol><ci id="S3.E6.m1.6.6.6.3.3.3.3.2.cmml" xref="S3.E6.m1.6.6.6.3.3.3.3.2">𝜃</ci><apply id="S3.E6.m1.6.6.6.3.3.3.3.3.cmml" xref="S3.E6.m1.6.6.6.3.3.3.3.3"><times id="S3.E6.m1.6.6.6.3.3.3.3.3.1.cmml" xref="S3.E6.m1.6.6.6.3.3.3.3.3.1"></times><ci id="S3.E6.m1.6.6.6.3.3.3.3.3.2.cmml" xref="S3.E6.m1.6.6.6.3.3.3.3.3.2">𝑠</ci><ci id="S3.E6.m1.6.6.6.3.3.3.3.3.3.cmml" xref="S3.E6.m1.6.6.6.3.3.3.3.3.3">𝑡</ci></apply></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.6c">\ell_{inner}\left(T\left(\mathbf{s}_{t};\theta_{te}\right),\mathbf{y}^{*}_{t};\theta_{st}\right)\\
+\sum_{n=1}^{N-1}\ell_{inner}\left(\mathbf{x}^{n}_{v},\mathbf{y}^{n}_{v};\theta_{st}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS5.p2.14" class="ltx_p">where <math id="S3.SS5.p2.2.m1.1" class="ltx_Math" alttext="\theta_{sc}" display="inline"><semantics id="S3.SS5.p2.2.m1.1a"><msub id="S3.SS5.p2.2.m1.1.1" xref="S3.SS5.p2.2.m1.1.1.cmml"><mi id="S3.SS5.p2.2.m1.1.1.2" xref="S3.SS5.p2.2.m1.1.1.2.cmml">θ</mi><mrow id="S3.SS5.p2.2.m1.1.1.3" xref="S3.SS5.p2.2.m1.1.1.3.cmml"><mi id="S3.SS5.p2.2.m1.1.1.3.2" xref="S3.SS5.p2.2.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p2.2.m1.1.1.3.1" xref="S3.SS5.p2.2.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p2.2.m1.1.1.3.3" xref="S3.SS5.p2.2.m1.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.2.m1.1b"><apply id="S3.SS5.p2.2.m1.1.1.cmml" xref="S3.SS5.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.2.m1.1.1.1.cmml" xref="S3.SS5.p2.2.m1.1.1">subscript</csymbol><ci id="S3.SS5.p2.2.m1.1.1.2.cmml" xref="S3.SS5.p2.2.m1.1.1.2">𝜃</ci><apply id="S3.SS5.p2.2.m1.1.1.3.cmml" xref="S3.SS5.p2.2.m1.1.1.3"><times id="S3.SS5.p2.2.m1.1.1.3.1.cmml" xref="S3.SS5.p2.2.m1.1.1.3.1"></times><ci id="S3.SS5.p2.2.m1.1.1.3.2.cmml" xref="S3.SS5.p2.2.m1.1.1.3.2">𝑠</ci><ci id="S3.SS5.p2.2.m1.1.1.3.3.cmml" xref="S3.SS5.p2.2.m1.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.2.m1.1c">\theta_{sc}</annotation></semantics></math> are scheduler weights, <math id="S3.SS5.p2.3.m2.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S3.SS5.p2.3.m2.1a"><mi id="S3.SS5.p2.3.m2.1.1" xref="S3.SS5.p2.3.m2.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.3.m2.1b"><ci id="S3.SS5.p2.3.m2.1.1.cmml" xref="S3.SS5.p2.3.m2.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.3.m2.1c">\omega</annotation></semantics></math> is a learning rate for stochastic gradient descent, <math id="S3.SS5.p2.4.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS5.p2.4.m3.1a"><mi id="S3.SS5.p2.4.m3.1.1" xref="S3.SS5.p2.4.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.4.m3.1b"><ci id="S3.SS5.p2.4.m3.1.1.cmml" xref="S3.SS5.p2.4.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.4.m3.1c">\alpha</annotation></semantics></math> is a momentum hyperparameter, <math id="S3.SS5.p2.5.m4.1" class="ltx_Math" alttext="\ell_{inner}" display="inline"><semantics id="S3.SS5.p2.5.m4.1a"><msub id="S3.SS5.p2.5.m4.1.1" xref="S3.SS5.p2.5.m4.1.1.cmml"><mi mathvariant="normal" id="S3.SS5.p2.5.m4.1.1.2" xref="S3.SS5.p2.5.m4.1.1.2.cmml">ℓ</mi><mrow id="S3.SS5.p2.5.m4.1.1.3" xref="S3.SS5.p2.5.m4.1.1.3.cmml"><mi id="S3.SS5.p2.5.m4.1.1.3.2" xref="S3.SS5.p2.5.m4.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p2.5.m4.1.1.3.1" xref="S3.SS5.p2.5.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p2.5.m4.1.1.3.3" xref="S3.SS5.p2.5.m4.1.1.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p2.5.m4.1.1.3.1a" xref="S3.SS5.p2.5.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p2.5.m4.1.1.3.4" xref="S3.SS5.p2.5.m4.1.1.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p2.5.m4.1.1.3.1b" xref="S3.SS5.p2.5.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p2.5.m4.1.1.3.5" xref="S3.SS5.p2.5.m4.1.1.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p2.5.m4.1.1.3.1c" xref="S3.SS5.p2.5.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p2.5.m4.1.1.3.6" xref="S3.SS5.p2.5.m4.1.1.3.6.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.5.m4.1b"><apply id="S3.SS5.p2.5.m4.1.1.cmml" xref="S3.SS5.p2.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.5.m4.1.1.1.cmml" xref="S3.SS5.p2.5.m4.1.1">subscript</csymbol><ci id="S3.SS5.p2.5.m4.1.1.2.cmml" xref="S3.SS5.p2.5.m4.1.1.2">ℓ</ci><apply id="S3.SS5.p2.5.m4.1.1.3.cmml" xref="S3.SS5.p2.5.m4.1.1.3"><times id="S3.SS5.p2.5.m4.1.1.3.1.cmml" xref="S3.SS5.p2.5.m4.1.1.3.1"></times><ci id="S3.SS5.p2.5.m4.1.1.3.2.cmml" xref="S3.SS5.p2.5.m4.1.1.3.2">𝑖</ci><ci id="S3.SS5.p2.5.m4.1.1.3.3.cmml" xref="S3.SS5.p2.5.m4.1.1.3.3">𝑛</ci><ci id="S3.SS5.p2.5.m4.1.1.3.4.cmml" xref="S3.SS5.p2.5.m4.1.1.3.4">𝑛</ci><ci id="S3.SS5.p2.5.m4.1.1.3.5.cmml" xref="S3.SS5.p2.5.m4.1.1.3.5">𝑒</ci><ci id="S3.SS5.p2.5.m4.1.1.3.6.cmml" xref="S3.SS5.p2.5.m4.1.1.3.6">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.5.m4.1c">\ell_{inner}</annotation></semantics></math> is our local task loss function, <math id="S3.SS5.p2.6.m5.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS5.p2.6.m5.1a"><mi id="S3.SS5.p2.6.m5.1.1" xref="S3.SS5.p2.6.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.6.m5.1b"><ci id="S3.SS5.p2.6.m5.1.1.cmml" xref="S3.SS5.p2.6.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.6.m5.1c">T</annotation></semantics></math> is the teacher network taking as input the student state at iteration <math id="S3.SS5.p2.7.m6.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS5.p2.7.m6.1a"><mi id="S3.SS5.p2.7.m6.1.1" xref="S3.SS5.p2.7.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.7.m6.1b"><ci id="S3.SS5.p2.7.m6.1.1.cmml" xref="S3.SS5.p2.7.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.7.m6.1c">t</annotation></semantics></math>, <math id="S3.SS5.p2.8.m7.1" class="ltx_Math" alttext="\mathbf{s}_{t}" display="inline"><semantics id="S3.SS5.p2.8.m7.1a"><msub id="S3.SS5.p2.8.m7.1.1" xref="S3.SS5.p2.8.m7.1.1.cmml"><mi id="S3.SS5.p2.8.m7.1.1.2" xref="S3.SS5.p2.8.m7.1.1.2.cmml">𝐬</mi><mi id="S3.SS5.p2.8.m7.1.1.3" xref="S3.SS5.p2.8.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.8.m7.1b"><apply id="S3.SS5.p2.8.m7.1.1.cmml" xref="S3.SS5.p2.8.m7.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.8.m7.1.1.1.cmml" xref="S3.SS5.p2.8.m7.1.1">subscript</csymbol><ci id="S3.SS5.p2.8.m7.1.1.2.cmml" xref="S3.SS5.p2.8.m7.1.1.2">𝐬</ci><ci id="S3.SS5.p2.8.m7.1.1.3.cmml" xref="S3.SS5.p2.8.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.8.m7.1c">\mathbf{s}_{t}</annotation></semantics></math>, <math id="S3.SS5.p2.9.m8.1" class="ltx_Math" alttext="\mathbf{y^{*}_{t}}" display="inline"><semantics id="S3.SS5.p2.9.m8.1a"><msubsup id="S3.SS5.p2.9.m8.1.1" xref="S3.SS5.p2.9.m8.1.1.cmml"><mi id="S3.SS5.p2.9.m8.1.1.2.2" xref="S3.SS5.p2.9.m8.1.1.2.2.cmml">𝐲</mi><mi id="S3.SS5.p2.9.m8.1.1.3" xref="S3.SS5.p2.9.m8.1.1.3.cmml">𝐭</mi><mo id="S3.SS5.p2.9.m8.1.1.2.3" xref="S3.SS5.p2.9.m8.1.1.2.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.9.m8.1b"><apply id="S3.SS5.p2.9.m8.1.1.cmml" xref="S3.SS5.p2.9.m8.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.9.m8.1.1.1.cmml" xref="S3.SS5.p2.9.m8.1.1">subscript</csymbol><apply id="S3.SS5.p2.9.m8.1.1.2.cmml" xref="S3.SS5.p2.9.m8.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.9.m8.1.1.2.1.cmml" xref="S3.SS5.p2.9.m8.1.1">superscript</csymbol><ci id="S3.SS5.p2.9.m8.1.1.2.2.cmml" xref="S3.SS5.p2.9.m8.1.1.2.2">𝐲</ci><times id="S3.SS5.p2.9.m8.1.1.2.3.cmml" xref="S3.SS5.p2.9.m8.1.1.2.3"></times></apply><ci id="S3.SS5.p2.9.m8.1.1.3.cmml" xref="S3.SS5.p2.9.m8.1.1.3">𝐭</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.9.m8.1c">\mathbf{y^{*}_{t}}</annotation></semantics></math> is the ground truth associated with the teacher selection and <math id="S3.SS5.p2.10.m9.1" class="ltx_Math" alttext="\theta_{te}" display="inline"><semantics id="S3.SS5.p2.10.m9.1a"><msub id="S3.SS5.p2.10.m9.1.1" xref="S3.SS5.p2.10.m9.1.1.cmml"><mi id="S3.SS5.p2.10.m9.1.1.2" xref="S3.SS5.p2.10.m9.1.1.2.cmml">θ</mi><mrow id="S3.SS5.p2.10.m9.1.1.3" xref="S3.SS5.p2.10.m9.1.1.3.cmml"><mi id="S3.SS5.p2.10.m9.1.1.3.2" xref="S3.SS5.p2.10.m9.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p2.10.m9.1.1.3.1" xref="S3.SS5.p2.10.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p2.10.m9.1.1.3.3" xref="S3.SS5.p2.10.m9.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.10.m9.1b"><apply id="S3.SS5.p2.10.m9.1.1.cmml" xref="S3.SS5.p2.10.m9.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.10.m9.1.1.1.cmml" xref="S3.SS5.p2.10.m9.1.1">subscript</csymbol><ci id="S3.SS5.p2.10.m9.1.1.2.cmml" xref="S3.SS5.p2.10.m9.1.1.2">𝜃</ci><apply id="S3.SS5.p2.10.m9.1.1.3.cmml" xref="S3.SS5.p2.10.m9.1.1.3"><times id="S3.SS5.p2.10.m9.1.1.3.1.cmml" xref="S3.SS5.p2.10.m9.1.1.3.1"></times><ci id="S3.SS5.p2.10.m9.1.1.3.2.cmml" xref="S3.SS5.p2.10.m9.1.1.3.2">𝑡</ci><ci id="S3.SS5.p2.10.m9.1.1.3.3.cmml" xref="S3.SS5.p2.10.m9.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.10.m9.1c">\theta_{te}</annotation></semantics></math> and <math id="S3.SS5.p2.11.m10.1" class="ltx_Math" alttext="\theta_{st}" display="inline"><semantics id="S3.SS5.p2.11.m10.1a"><msub id="S3.SS5.p2.11.m10.1.1" xref="S3.SS5.p2.11.m10.1.1.cmml"><mi id="S3.SS5.p2.11.m10.1.1.2" xref="S3.SS5.p2.11.m10.1.1.2.cmml">θ</mi><mrow id="S3.SS5.p2.11.m10.1.1.3" xref="S3.SS5.p2.11.m10.1.1.3.cmml"><mi id="S3.SS5.p2.11.m10.1.1.3.2" xref="S3.SS5.p2.11.m10.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p2.11.m10.1.1.3.1" xref="S3.SS5.p2.11.m10.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p2.11.m10.1.1.3.3" xref="S3.SS5.p2.11.m10.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.11.m10.1b"><apply id="S3.SS5.p2.11.m10.1.1.cmml" xref="S3.SS5.p2.11.m10.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.11.m10.1.1.1.cmml" xref="S3.SS5.p2.11.m10.1.1">subscript</csymbol><ci id="S3.SS5.p2.11.m10.1.1.2.cmml" xref="S3.SS5.p2.11.m10.1.1.2">𝜃</ci><apply id="S3.SS5.p2.11.m10.1.1.3.cmml" xref="S3.SS5.p2.11.m10.1.1.3"><times id="S3.SS5.p2.11.m10.1.1.3.1.cmml" xref="S3.SS5.p2.11.m10.1.1.3.1"></times><ci id="S3.SS5.p2.11.m10.1.1.3.2.cmml" xref="S3.SS5.p2.11.m10.1.1.3.2">𝑠</ci><ci id="S3.SS5.p2.11.m10.1.1.3.3.cmml" xref="S3.SS5.p2.11.m10.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.11.m10.1c">\theta_{st}</annotation></semantics></math> the teacher and student parameterisations respectively. <math id="S3.SS5.p2.12.m11.1" class="ltx_Math" alttext="\mathbf{x}^{n}_{v}" display="inline"><semantics id="S3.SS5.p2.12.m11.1a"><msubsup id="S3.SS5.p2.12.m11.1.1" xref="S3.SS5.p2.12.m11.1.1.cmml"><mi id="S3.SS5.p2.12.m11.1.1.2.2" xref="S3.SS5.p2.12.m11.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS5.p2.12.m11.1.1.3" xref="S3.SS5.p2.12.m11.1.1.3.cmml">v</mi><mi id="S3.SS5.p2.12.m11.1.1.2.3" xref="S3.SS5.p2.12.m11.1.1.2.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.12.m11.1b"><apply id="S3.SS5.p2.12.m11.1.1.cmml" xref="S3.SS5.p2.12.m11.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.12.m11.1.1.1.cmml" xref="S3.SS5.p2.12.m11.1.1">subscript</csymbol><apply id="S3.SS5.p2.12.m11.1.1.2.cmml" xref="S3.SS5.p2.12.m11.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.12.m11.1.1.2.1.cmml" xref="S3.SS5.p2.12.m11.1.1">superscript</csymbol><ci id="S3.SS5.p2.12.m11.1.1.2.2.cmml" xref="S3.SS5.p2.12.m11.1.1.2.2">𝐱</ci><ci id="S3.SS5.p2.12.m11.1.1.2.3.cmml" xref="S3.SS5.p2.12.m11.1.1.2.3">𝑛</ci></apply><ci id="S3.SS5.p2.12.m11.1.1.3.cmml" xref="S3.SS5.p2.12.m11.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.12.m11.1c">\mathbf{x}^{n}_{v}</annotation></semantics></math> and <math id="S3.SS5.p2.13.m12.1" class="ltx_Math" alttext="\mathbf{y}^{n}_{v}" display="inline"><semantics id="S3.SS5.p2.13.m12.1a"><msubsup id="S3.SS5.p2.13.m12.1.1" xref="S3.SS5.p2.13.m12.1.1.cmml"><mi id="S3.SS5.p2.13.m12.1.1.2.2" xref="S3.SS5.p2.13.m12.1.1.2.2.cmml">𝐲</mi><mi id="S3.SS5.p2.13.m12.1.1.3" xref="S3.SS5.p2.13.m12.1.1.3.cmml">v</mi><mi id="S3.SS5.p2.13.m12.1.1.2.3" xref="S3.SS5.p2.13.m12.1.1.2.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.13.m12.1b"><apply id="S3.SS5.p2.13.m12.1.1.cmml" xref="S3.SS5.p2.13.m12.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.13.m12.1.1.1.cmml" xref="S3.SS5.p2.13.m12.1.1">subscript</csymbol><apply id="S3.SS5.p2.13.m12.1.1.2.cmml" xref="S3.SS5.p2.13.m12.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.13.m12.1.1.2.1.cmml" xref="S3.SS5.p2.13.m12.1.1">superscript</csymbol><ci id="S3.SS5.p2.13.m12.1.1.2.2.cmml" xref="S3.SS5.p2.13.m12.1.1.2.2">𝐲</ci><ci id="S3.SS5.p2.13.m12.1.1.2.3.cmml" xref="S3.SS5.p2.13.m12.1.1.2.3">𝑛</ci></apply><ci id="S3.SS5.p2.13.m12.1.1.3.cmml" xref="S3.SS5.p2.13.m12.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.13.m12.1c">\mathbf{y}^{n}_{v}</annotation></semantics></math> are the features and labels of the validation set of node <math id="S3.SS5.p2.14.m13.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS5.p2.14.m13.1a"><mi id="S3.SS5.p2.14.m13.1.1" xref="S3.SS5.p2.14.m13.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.14.m13.1b"><ci id="S3.SS5.p2.14.m13.1.1.cmml" xref="S3.SS5.p2.14.m13.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.14.m13.1c">n</annotation></semantics></math> respectively.</p>
</div>
<section id="S3.SS5.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Entropy Loss</h4>

<div id="S3.SS5.SSSx1.p1" class="ltx_para">
<p id="S3.SS5.SSSx1.p1.6" class="ltx_p">As the scheduler is trained using meta-gradients, the model may converge after a set number of iterations. While we would like convergence of the student (i.e., the task solving model), we do not necessarily need the scheduler to converge. In fact using the loss on the validation set as the signal to update the scheduler automatically prevents the scheduler from converging for very long. This is because, should the scheduler converge on selecting a particular data centre, the validation scores on the other data centres will deteriorate thereby increasing the aggregated loss on the validations and providing an update signal to the scheduler. This however was found in practice to require many iterations of training and so in order to encourage the exploration further we add an <span id="S3.SS5.SSSx1.p1.6.1" class="ltx_text ltx_font_italic">entropic loss</span> term to the scheduler. This takes the form:</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.1" class="ltx_Math" alttext="\ell_{ent}=\frac{1}{H\left[S\left(s_{t};\theta^{t}_{sc}\right)\right]+\epsilon}" display="block"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.2" xref="S3.E7.m1.1.2.cmml"><msub id="S3.E7.m1.1.2.2" xref="S3.E7.m1.1.2.2.cmml"><mi mathvariant="normal" id="S3.E7.m1.1.2.2.2" xref="S3.E7.m1.1.2.2.2.cmml">ℓ</mi><mrow id="S3.E7.m1.1.2.2.3" xref="S3.E7.m1.1.2.2.3.cmml"><mi id="S3.E7.m1.1.2.2.3.2" xref="S3.E7.m1.1.2.2.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.2.2.3.1" xref="S3.E7.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.E7.m1.1.2.2.3.3" xref="S3.E7.m1.1.2.2.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.2.2.3.1a" xref="S3.E7.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.E7.m1.1.2.2.3.4" xref="S3.E7.m1.1.2.2.3.4.cmml">t</mi></mrow></msub><mo id="S3.E7.m1.1.2.1" xref="S3.E7.m1.1.2.1.cmml">=</mo><mfrac id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><mn id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml">1</mn><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.2.cmml"><mo id="S3.E7.m1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.4" xref="S3.E7.m1.1.1.1.1.1.1.1.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E7.m1.1.1.1.1.1.1.1.2.2.4" xref="S3.E7.m1.1.1.1.1.1.1.1.2.3.cmml">;</mo><msubsup id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">θ</mi><mrow id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3.1" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3.1.cmml">​</mo><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3.3.cmml">c</mi></mrow><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">t</mi></msubsup><mo id="S3.E7.m1.1.1.1.1.1.1.1.2.2.5" xref="S3.E7.m1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.2.cmml">+</mo><mi id="S3.E7.m1.1.1.1.3" xref="S3.E7.m1.1.1.1.3.cmml">ϵ</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.2.cmml" xref="S3.E7.m1.1.2"><eq id="S3.E7.m1.1.2.1.cmml" xref="S3.E7.m1.1.2.1"></eq><apply id="S3.E7.m1.1.2.2.cmml" xref="S3.E7.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.2.2.1.cmml" xref="S3.E7.m1.1.2.2">subscript</csymbol><ci id="S3.E7.m1.1.2.2.2.cmml" xref="S3.E7.m1.1.2.2.2">ℓ</ci><apply id="S3.E7.m1.1.2.2.3.cmml" xref="S3.E7.m1.1.2.2.3"><times id="S3.E7.m1.1.2.2.3.1.cmml" xref="S3.E7.m1.1.2.2.3.1"></times><ci id="S3.E7.m1.1.2.2.3.2.cmml" xref="S3.E7.m1.1.2.2.3.2">𝑒</ci><ci id="S3.E7.m1.1.2.2.3.3.cmml" xref="S3.E7.m1.1.2.2.3.3">𝑛</ci><ci id="S3.E7.m1.1.2.2.3.4.cmml" xref="S3.E7.m1.1.2.2.3.4">𝑡</ci></apply></apply><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><divide id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1"></divide><cn type="integer" id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3">1</cn><apply id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><plus id="S3.E7.m1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.2"></plus><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2"></times><ci id="S3.E7.m1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3">𝐻</ci><apply id="S3.E7.m1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3"></times><ci id="S3.E7.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.4">𝑆</ci><list id="S3.E7.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2"><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.2">𝜃</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.3">𝑡</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3"><times id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3.1"></times><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3.2">𝑠</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3.3">𝑐</ci></apply></apply></list></apply></apply></apply><ci id="S3.E7.m1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.3">italic-ϵ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\ell_{ent}=\frac{1}{H\left[S\left(s_{t};\theta^{t}_{sc}\right)\right]+\epsilon}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS5.SSSx1.p1.5" class="ltx_p">where <math id="S3.SS5.SSSx1.p1.1.m1.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S3.SS5.SSSx1.p1.1.m1.1a"><mi id="S3.SS5.SSSx1.p1.1.m1.1.1" xref="S3.SS5.SSSx1.p1.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.SSSx1.p1.1.m1.1b"><ci id="S3.SS5.SSSx1.p1.1.m1.1.1.cmml" xref="S3.SS5.SSSx1.p1.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSSx1.p1.1.m1.1c">H</annotation></semantics></math> is entropy, <math id="S3.SS5.SSSx1.p1.2.m2.2" class="ltx_Math" alttext="S\left(s_{t};\theta^{t}_{sc}\right)" display="inline"><semantics id="S3.SS5.SSSx1.p1.2.m2.2a"><mrow id="S3.SS5.SSSx1.p1.2.m2.2.2" xref="S3.SS5.SSSx1.p1.2.m2.2.2.cmml"><mi id="S3.SS5.SSSx1.p1.2.m2.2.2.4" xref="S3.SS5.SSSx1.p1.2.m2.2.2.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.SS5.SSSx1.p1.2.m2.2.2.3" xref="S3.SS5.SSSx1.p1.2.m2.2.2.3.cmml">​</mo><mrow id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.3.cmml"><mo id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.3" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.3.cmml">(</mo><msub id="S3.SS5.SSSx1.p1.2.m2.1.1.1.1.1" xref="S3.SS5.SSSx1.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS5.SSSx1.p1.2.m2.1.1.1.1.1.2" xref="S3.SS5.SSSx1.p1.2.m2.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS5.SSSx1.p1.2.m2.1.1.1.1.1.3" xref="S3.SS5.SSSx1.p1.2.m2.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.4" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.3.cmml">;</mo><msubsup id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.cmml"><mi id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.2.2" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.2.2.cmml">θ</mi><mrow id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.3" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.3.cmml"><mi id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.3.2" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.3.1" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.3.3" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.3.3.cmml">c</mi></mrow><mi id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.2.3" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.2.3.cmml">t</mi></msubsup><mo id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.5" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.SSSx1.p1.2.m2.2b"><apply id="S3.SS5.SSSx1.p1.2.m2.2.2.cmml" xref="S3.SS5.SSSx1.p1.2.m2.2.2"><times id="S3.SS5.SSSx1.p1.2.m2.2.2.3.cmml" xref="S3.SS5.SSSx1.p1.2.m2.2.2.3"></times><ci id="S3.SS5.SSSx1.p1.2.m2.2.2.4.cmml" xref="S3.SS5.SSSx1.p1.2.m2.2.2.4">𝑆</ci><list id="S3.SS5.SSSx1.p1.2.m2.2.2.2.3.cmml" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.2"><apply id="S3.SS5.SSSx1.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS5.SSSx1.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.SSSx1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS5.SSSx1.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS5.SSSx1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS5.SSSx1.p1.2.m2.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS5.SSSx1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS5.SSSx1.p1.2.m2.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.cmml" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2">subscript</csymbol><apply id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.2.1.cmml" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2">superscript</csymbol><ci id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.2.2.cmml" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.2.2">𝜃</ci><ci id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.2.3.cmml" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.2.3">𝑡</ci></apply><apply id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.3"><times id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.3.1.cmml" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.3.1"></times><ci id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.3.2.cmml" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.3.2">𝑠</ci><ci id="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.3.3.cmml" xref="S3.SS5.SSSx1.p1.2.m2.2.2.2.2.2.3.3">𝑐</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSSx1.p1.2.m2.2c">S\left(s_{t};\theta^{t}_{sc}\right)</annotation></semantics></math> is the softmax output of the scheduler and <math id="S3.SS5.SSSx1.p1.3.m3.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S3.SS5.SSSx1.p1.3.m3.1a"><mi id="S3.SS5.SSSx1.p1.3.m3.1.1" xref="S3.SS5.SSSx1.p1.3.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.SSSx1.p1.3.m3.1b"><ci id="S3.SS5.SSSx1.p1.3.m3.1.1.cmml" xref="S3.SS5.SSSx1.p1.3.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSSx1.p1.3.m3.1c">\epsilon</annotation></semantics></math> is a small positive value (we use <math id="S3.SS5.SSSx1.p1.4.m4.1" class="ltx_Math" alttext="10^{-5}" display="inline"><semantics id="S3.SS5.SSSx1.p1.4.m4.1a"><msup id="S3.SS5.SSSx1.p1.4.m4.1.1" xref="S3.SS5.SSSx1.p1.4.m4.1.1.cmml"><mn id="S3.SS5.SSSx1.p1.4.m4.1.1.2" xref="S3.SS5.SSSx1.p1.4.m4.1.1.2.cmml">10</mn><mrow id="S3.SS5.SSSx1.p1.4.m4.1.1.3" xref="S3.SS5.SSSx1.p1.4.m4.1.1.3.cmml"><mo id="S3.SS5.SSSx1.p1.4.m4.1.1.3a" xref="S3.SS5.SSSx1.p1.4.m4.1.1.3.cmml">−</mo><mn id="S3.SS5.SSSx1.p1.4.m4.1.1.3.2" xref="S3.SS5.SSSx1.p1.4.m4.1.1.3.2.cmml">5</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS5.SSSx1.p1.4.m4.1b"><apply id="S3.SS5.SSSx1.p1.4.m4.1.1.cmml" xref="S3.SS5.SSSx1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS5.SSSx1.p1.4.m4.1.1.1.cmml" xref="S3.SS5.SSSx1.p1.4.m4.1.1">superscript</csymbol><cn type="integer" id="S3.SS5.SSSx1.p1.4.m4.1.1.2.cmml" xref="S3.SS5.SSSx1.p1.4.m4.1.1.2">10</cn><apply id="S3.SS5.SSSx1.p1.4.m4.1.1.3.cmml" xref="S3.SS5.SSSx1.p1.4.m4.1.1.3"><minus id="S3.SS5.SSSx1.p1.4.m4.1.1.3.1.cmml" xref="S3.SS5.SSSx1.p1.4.m4.1.1.3"></minus><cn type="integer" id="S3.SS5.SSSx1.p1.4.m4.1.1.3.2.cmml" xref="S3.SS5.SSSx1.p1.4.m4.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSSx1.p1.4.m4.1c">10^{-5}</annotation></semantics></math>) to prevent potential division by zero. <math id="S3.SS5.SSSx1.p1.5.m5.1" class="ltx_Math" alttext="\ell_{ent}" display="inline"><semantics id="S3.SS5.SSSx1.p1.5.m5.1a"><msub id="S3.SS5.SSSx1.p1.5.m5.1.1" xref="S3.SS5.SSSx1.p1.5.m5.1.1.cmml"><mi mathvariant="normal" id="S3.SS5.SSSx1.p1.5.m5.1.1.2" xref="S3.SS5.SSSx1.p1.5.m5.1.1.2.cmml">ℓ</mi><mrow id="S3.SS5.SSSx1.p1.5.m5.1.1.3" xref="S3.SS5.SSSx1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS5.SSSx1.p1.5.m5.1.1.3.2" xref="S3.SS5.SSSx1.p1.5.m5.1.1.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS5.SSSx1.p1.5.m5.1.1.3.1" xref="S3.SS5.SSSx1.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS5.SSSx1.p1.5.m5.1.1.3.3" xref="S3.SS5.SSSx1.p1.5.m5.1.1.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS5.SSSx1.p1.5.m5.1.1.3.1a" xref="S3.SS5.SSSx1.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS5.SSSx1.p1.5.m5.1.1.3.4" xref="S3.SS5.SSSx1.p1.5.m5.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.SSSx1.p1.5.m5.1b"><apply id="S3.SS5.SSSx1.p1.5.m5.1.1.cmml" xref="S3.SS5.SSSx1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS5.SSSx1.p1.5.m5.1.1.1.cmml" xref="S3.SS5.SSSx1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS5.SSSx1.p1.5.m5.1.1.2.cmml" xref="S3.SS5.SSSx1.p1.5.m5.1.1.2">ℓ</ci><apply id="S3.SS5.SSSx1.p1.5.m5.1.1.3.cmml" xref="S3.SS5.SSSx1.p1.5.m5.1.1.3"><times id="S3.SS5.SSSx1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS5.SSSx1.p1.5.m5.1.1.3.1"></times><ci id="S3.SS5.SSSx1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS5.SSSx1.p1.5.m5.1.1.3.2">𝑒</ci><ci id="S3.SS5.SSSx1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS5.SSSx1.p1.5.m5.1.1.3.3">𝑛</ci><ci id="S3.SS5.SSSx1.p1.5.m5.1.1.3.4.cmml" xref="S3.SS5.SSSx1.p1.5.m5.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSSx1.p1.5.m5.1c">\ell_{ent}</annotation></semantics></math> is then added on to the end of the expression shown in Equation <a href="#S3.E6" title="In 3.5 The Scheduler ‣ 3 Methodology ‣ Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> to discourage fast convergence of the scheduler.</p>
</div>
<div id="S3.SS5.SSSx1.p2" class="ltx_para">
<p id="S3.SS5.SSSx1.p2.1" class="ltx_p">For tabular classifications, we define the student to be a feedforward neural network consisting of 2 hidden layers and 50 nodes in each layer. These are all activated with ReLU activations. For the image recognition tasks we initialise a student that has 4 convolutional layers with 32 filters of size 3x3 in the first two layers and 64 of these in the second two. These are all activated by ReLU and maxpooled and are followed by 3 feedforward layers of size 50 nodes each.</p>
</div>
<div id="S3.SS5.SSSx1.p3" class="ltx_para">
<p id="S3.SS5.SSSx1.p3.1" class="ltx_p">For the results reported in Section <a href="#S5" title="5 Results ‣ Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, we use a pre-trained teacher (i.e., the teacher has been trained using reinforcement learning on different students for the same classification problem). The teacher has 2 hidden layers and 150 nodes each activated by ReLU apart from the final layer (of size 2) which is activated by a tanh function. For the scheduler we use a feedforward neural network with 2 hidden layers and 100 nodes in each layer activated by ReLU. The output is activated by a softmax of size the number of nodes in the federated system.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Datasets</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this study we considered the patient data collected in the electronic health records (EHR) of the Other Unknown Hospital (OUH), which the authors are associated with. The data is split randomly in <math id="S4.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.p1.1.m1.1a"><mi id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">N</annotation></semantics></math> datasets so that each can act as a separate machine in a federated system. The features include demographic, physiological and medical information (such as age, heart rate upon entry and any medical tests requested by clinical staff who greet the patient). We aim to predict which department in the hospital the patient will consume resource from (i.e., which department in the hospital will ultimately be responsible for treating the patient) rendering this a seven-class classification. In carrying out this classification, this allows hospitals to predict their resource requirements ahead of time and update scheduling and planning accordingly. Only patients who were admitted in an emergency were considered providing a dataset of 14,324 patients. A training set of 60% of the dataset was used and was balanced, leaving 8,589 patients for training on. The validation set was 20% of the dataset and testing was also 20%. These sets are then evenly divided according to the number of nodes in the federated system. The full feature set is included in the supplementary material.</p>
</div>
<section id="S4.SS0.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">eICU</h4>

<div id="S4.SS0.SSSx1.p1" class="ltx_para">
<p id="S4.SS0.SSSx1.p1.1" class="ltx_p">In order to validate our results on real-world data collected from different hospitals, we introduce the eICU dataset <cite class="ltx_cite ltx_citemacro_citep">(Pollard et al., <a href="#bib.bib22" title="" class="ltx_ref">2018</a>)</cite> also hosted on Physionet <cite class="ltx_cite ltx_citemacro_citep">(Goldberger et al., <a href="#bib.bib8" title="" class="ltx_ref">2000</a>)</cite>. The task here is mortality prediction (binary classification) based on features extracted from admission to the ICU as is done in <cite class="ltx_cite ltx_citemacro_citep">(Sheikhalishahi et al., <a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite>. As this dataset contains identifiers for individual hospitals, we are able to create nodes corresponding to each hospital. The features selected are as outlined in the appendix. We choose to learn from the eight hospitals with the largest populations in the dataset leaving us with 8,594 instances. We sample 60% from each node to keep as the training set, and keep 20% for the validation set and the final 20% as the test set. As per usual, the validation set is kept on the local node for performance aggregation during the scheduler training.</p>
</div>
</section>
<section id="S4.SS0.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">CIFAR-10</h4>

<div id="S4.SS0.SSSx2.p1" class="ltx_para">
<p id="S4.SS0.SSSx2.p1.1" class="ltx_p">To test our methodology on the image space we also report results on the CIFAR-10 image recognition dataset <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib15" title="" class="ltx_ref">2009</a>)</cite>. We use 40,000 training examples for the training set and 10,000 each for validation and test set examples. We once again randomly divide the dataset into <math id="S4.SS0.SSSx2.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS0.SSSx2.p1.1.m1.1a"><mi id="S4.SS0.SSSx2.p1.1.m1.1.1" xref="S4.SS0.SSSx2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx2.p1.1.m1.1b"><ci id="S4.SS0.SSSx2.p1.1.m1.1.1.cmml" xref="S4.SS0.SSSx2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx2.p1.1.m1.1c">N</annotation></semantics></math> datasets to mimic a federated learning system. It should be noted that in Table <a href="#S5.T1" title="Table 1 ‣ 5 Results ‣ Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> the CIFAR-10 dataset has been split into three samples of size 15000, 15000 and 10000 due to the possibility of the teacher selecting a full training set batchsize and memory constraints.</p>
</div>
</section>
<section id="S4.SS0.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">MNIST</h4>

<div id="S4.SS0.SSSx3.p1" class="ltx_para">
<p id="S4.SS0.SSSx3.p1.1" class="ltx_p">As before, we utilise the MNIST dataset <cite class="ltx_cite ltx_citemacro_citep">(LeCun et al., <a href="#bib.bib16" title="" class="ltx_ref">1998</a>)</cite> as another publicly available dataset to assess our results against. We use 30,000 examples for training, 10,000 for validation and 10,000 for the test set. Once again the dataset is partitioned into <math id="S4.SS0.SSSx3.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS0.SSSx3.p1.1.m1.1a"><mi id="S4.SS0.SSSx3.p1.1.m1.1.1" xref="S4.SS0.SSSx3.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx3.p1.1.m1.1b"><ci id="S4.SS0.SSSx3.p1.1.m1.1.1.cmml" xref="S4.SS0.SSSx3.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx3.p1.1.m1.1c">N</annotation></semantics></math> datasets to emulate the federated learning approach.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Results</h2>

<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Average classification accuracies and standard deviations for various baseline and state-of-the-art methods on the Ward Admission (tabular), MNIST (image) and CIFAR-10 (image) datasets. All models are averaged over the same five seeds apart from those highlighted with * which indicates that the accuracy reported from the cited text is quoted.</figcaption>
<br class="ltx_break">
<table id="S5.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T1.1.1.1" class="ltx_tr">
<th id="S5.T1.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<td id="S5.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T1.1.1.1.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Ward Admission</span></td>
<td id="S5.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T1.1.1.1.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">MNIST</span></td>
<td id="S5.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T1.1.1.1.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">CIFAR-10</span></td>
<td id="S5.T1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T1.1.1.1.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">CIFAR-10</span></td>
<td id="S5.T1.1.1.1.6" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T1.1.1.1.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">CIFAR-10</span></td>
<td id="S5.T1.1.1.1.7" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T1.1.1.1.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">eICU</span></td>
</tr>
<tr id="S5.T1.1.2.2" class="ltx_tr">
<th id="S5.T1.1.2.2.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S5.T1.1.2.2.2" class="ltx_td"></td>
<td id="S5.T1.1.2.2.3" class="ltx_td"></td>
<td id="S5.T1.1.2.2.4" class="ltx_td ltx_align_center"><span id="S5.T1.1.2.2.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Sample 1</span></td>
<td id="S5.T1.1.2.2.5" class="ltx_td ltx_align_center"><span id="S5.T1.1.2.2.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Sample 2</span></td>
<td id="S5.T1.1.2.2.6" class="ltx_td ltx_align_center"><span id="S5.T1.1.2.2.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Sample 3</span></td>
<td id="S5.T1.1.2.2.7" class="ltx_td"></td>
</tr>
<tr id="S5.T1.1.3.3" class="ltx_tr">
<th id="S5.T1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T1.1.3.3.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Method</span></th>
<td id="S5.T1.1.3.3.2" class="ltx_td ltx_align_center"><span id="S5.T1.1.3.3.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Acc (SD)</span></td>
<td id="S5.T1.1.3.3.3" class="ltx_td ltx_align_center"><span id="S5.T1.1.3.3.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Acc (SD)</span></td>
<td id="S5.T1.1.3.3.4" class="ltx_td ltx_align_center"><span id="S5.T1.1.3.3.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Acc (SD)</span></td>
<td id="S5.T1.1.3.3.5" class="ltx_td ltx_align_center"><span id="S5.T1.1.3.3.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Acc (SD)</span></td>
<td id="S5.T1.1.3.3.6" class="ltx_td ltx_align_center"><span id="S5.T1.1.3.3.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Acc (SD)</span></td>
<td id="S5.T1.1.3.3.7" class="ltx_td ltx_align_center"><span id="S5.T1.1.3.3.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">AUC (SD)</span></td>
</tr>
<tr id="S5.T1.1.4.4" class="ltx_tr">
<th id="S5.T1.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S5.T1.1.4.4.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">SMBT</span></th>
<td id="S5.T1.1.4.4.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.1.4.4.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.45 (0.01)</span></td>
<td id="S5.T1.1.4.4.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.1.4.4.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.91 (0.01)</span></td>
<td id="S5.T1.1.4.4.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.1.4.4.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.65 (0.02)</span></td>
<td id="S5.T1.1.4.4.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.1.4.4.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.65 (0.02)</span></td>
<td id="S5.T1.1.4.4.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.1.4.4.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.65 (0.02)</span></td>
<td id="S5.T1.1.4.4.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.1.4.4.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.80 (0.02)</span></td>
</tr>
<tr id="S5.T1.1.5.5" class="ltx_tr">
<th id="S5.T1.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T1.1.5.5.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">CURRIC</span></th>
<td id="S5.T1.1.5.5.2" class="ltx_td ltx_align_center"><span id="S5.T1.1.5.5.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.48 (0.02)</span></td>
<td id="S5.T1.1.5.5.3" class="ltx_td ltx_align_center"><span id="S5.T1.1.5.5.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.93 (0.02)</span></td>
<td id="S5.T1.1.5.5.4" class="ltx_td ltx_align_center"><span id="S5.T1.1.5.5.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.68 (0.01)</span></td>
<td id="S5.T1.1.5.5.5" class="ltx_td ltx_align_center"><span id="S5.T1.1.5.5.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.68 (0.01)</span></td>
<td id="S5.T1.1.5.5.6" class="ltx_td ltx_align_center"><span id="S5.T1.1.5.5.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.68 (0.01)</span></td>
<td id="S5.T1.1.5.5.7" class="ltx_td ltx_align_center"><span id="S5.T1.1.5.5.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.81 (0.01)</span></td>
</tr>
<tr id="S5.T1.1.6.6" class="ltx_tr">
<th id="S5.T1.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T1.1.6.6.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">DeepFM</span></th>
<td id="S5.T1.1.6.6.2" class="ltx_td ltx_align_center"><span id="S5.T1.1.6.6.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.59 (0.01)</span></td>
<td id="S5.T1.1.6.6.3" class="ltx_td ltx_align_center"><span id="S5.T1.1.6.6.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">N/A</span></td>
<td id="S5.T1.1.6.6.4" class="ltx_td ltx_align_center"><span id="S5.T1.1.6.6.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">N/A</span></td>
<td id="S5.T1.1.6.6.5" class="ltx_td ltx_align_center"><span id="S5.T1.1.6.6.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">N/A</span></td>
<td id="S5.T1.1.6.6.6" class="ltx_td ltx_align_center"><span id="S5.T1.1.6.6.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">N/A</span></td>
<td id="S5.T1.1.6.6.7" class="ltx_td ltx_align_center"><span id="S5.T1.1.6.6.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.81 (0.01)</span></td>
</tr>
<tr id="S5.T1.1.7.7" class="ltx_tr">
<th id="S5.T1.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T1.1.7.7.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Deep+CrossNet</span></th>
<td id="S5.T1.1.7.7.2" class="ltx_td ltx_align_center"><span id="S5.T1.1.7.7.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.58 (0.02)</span></td>
<td id="S5.T1.1.7.7.3" class="ltx_td ltx_align_center"><span id="S5.T1.1.7.7.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">N/A</span></td>
<td id="S5.T1.1.7.7.4" class="ltx_td ltx_align_center"><span id="S5.T1.1.7.7.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">N/A</span></td>
<td id="S5.T1.1.7.7.5" class="ltx_td ltx_align_center"><span id="S5.T1.1.7.7.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">N/A</span></td>
<td id="S5.T1.1.7.7.6" class="ltx_td ltx_align_center"><span id="S5.T1.1.7.7.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">N/A</span></td>
<td id="S5.T1.1.7.7.7" class="ltx_td ltx_align_center"><span id="S5.T1.1.7.7.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.82 (0.02)</span></td>
</tr>
<tr id="S5.T1.1.8.8" class="ltx_tr">
<th id="S5.T1.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T1.1.8.8.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">DenseNet*</span></th>
<td id="S5.T1.1.8.8.2" class="ltx_td ltx_align_center"><span id="S5.T1.1.8.8.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">N/A</span></td>
<td id="S5.T1.1.8.8.3" class="ltx_td ltx_align_center">
<span id="S5.T1.1.8.8.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.99</span><span id="S5.T1.1.8.8.3.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.01)</span>
</td>
<td id="S5.T1.1.8.8.4" class="ltx_td ltx_align_center"><span id="S5.T1.1.8.8.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.96 (0.01)</span></td>
<td id="S5.T1.1.8.8.5" class="ltx_td ltx_align_center"><span id="S5.T1.1.8.8.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.96 (0.01)</span></td>
<td id="S5.T1.1.8.8.6" class="ltx_td ltx_align_center"><span id="S5.T1.1.8.8.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.96 (0.01)</span></td>
<td id="S5.T1.1.8.8.7" class="ltx_td ltx_align_center"><span id="S5.T1.1.8.8.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">N/A</span></td>
</tr>
<tr id="S5.T1.1.9.9" class="ltx_tr">
<th id="S5.T1.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T1.1.9.9.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">GPipe*</span></th>
<td id="S5.T1.1.9.9.2" class="ltx_td ltx_align_center"><span id="S5.T1.1.9.9.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">N/A</span></td>
<td id="S5.T1.1.9.9.3" class="ltx_td ltx_align_center">
<span id="S5.T1.1.9.9.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.99</span><span id="S5.T1.1.9.9.3.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.01)</span>
</td>
<td id="S5.T1.1.9.9.4" class="ltx_td ltx_align_center">
<span id="S5.T1.1.9.9.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.99</span><span id="S5.T1.1.9.9.4.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.01)</span>
</td>
<td id="S5.T1.1.9.9.5" class="ltx_td ltx_align_center">
<span id="S5.T1.1.9.9.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.99</span><span id="S5.T1.1.9.9.5.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.01)</span>
</td>
<td id="S5.T1.1.9.9.6" class="ltx_td ltx_align_center">
<span id="S5.T1.1.9.9.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.99</span><span id="S5.T1.1.9.9.6.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.01)</span>
</td>
<td id="S5.T1.1.9.9.7" class="ltx_td ltx_align_center"><span id="S5.T1.1.9.9.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">N/A</span></td>
</tr>
<tr id="S5.T1.1.10.10" class="ltx_tr">
<th id="S5.T1.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T1.1.10.10.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">RLST</span></th>
<td id="S5.T1.1.10.10.2" class="ltx_td ltx_align_center">
<span id="S5.T1.1.10.10.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.62</span><span id="S5.T1.1.10.10.2.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.02)</span>
</td>
<td id="S5.T1.1.10.10.3" class="ltx_td ltx_align_center"><span id="S5.T1.1.10.10.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.95 (0.02)</span></td>
<td id="S5.T1.1.10.10.4" class="ltx_td ltx_align_center"><span id="S5.T1.1.10.10.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.90 (0.01)</span></td>
<td id="S5.T1.1.10.10.5" class="ltx_td ltx_align_center"><span id="S5.T1.1.10.10.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.90 (0.01)</span></td>
<td id="S5.T1.1.10.10.6" class="ltx_td ltx_align_center"><span id="S5.T1.1.10.10.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.89 (0.01)</span></td>
<td id="S5.T1.1.10.10.7" class="ltx_td ltx_align_center"><span id="S5.T1.1.10.10.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.85 (0.02)</span></td>
</tr>
<tr id="S5.T1.1.11.11" class="ltx_tr">
<th id="S5.T1.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S5.T1.1.11.11.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">FLST</span></th>
<td id="S5.T1.1.11.11.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T1.1.11.11.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.60 (0.02)</span></td>
<td id="S5.T1.1.11.11.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T1.1.11.11.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.94 (0.01)</span></td>
<td id="S5.T1.1.11.11.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T1.1.11.11.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.91 (0.01)</span></td>
<td id="S5.T1.1.11.11.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T1.1.11.11.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.90 (0.01)</span></td>
<td id="S5.T1.1.11.11.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T1.1.11.11.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.91 (0.02)</span></td>
<td id="S5.T1.1.11.11.7" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T1.1.11.11.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.86</span><span id="S5.T1.1.11.11.7.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.01)</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Average classification accuracies and standard deviations for various baseline and state-of-the-art methods on the hospital ward admission (tabular), eICU (tabular), CIFAR-10 (image) and MNIST (image) datasets. All models are averaged over the same five seeds. We also show how the models perform when subjected to a data poisoning attack and a local model poisoning attack.</figcaption>
<br class="ltx_break">
<table id="S5.T2.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T2.1.1.1" class="ltx_tr">
<td id="S5.T2.1.1.1.1" class="ltx_td ltx_border_tt"></td>
<td id="S5.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T2.1.1.1.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Accuracy</span></td>
<td id="S5.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T2.1.1.1.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Model Poisoning</span></td>
<td id="S5.T2.1.1.1.4" class="ltx_td ltx_align_right ltx_border_tt"><span id="S5.T2.1.1.1.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Data Poisoning</span></td>
</tr>
<tr id="S5.T2.1.2.2" class="ltx_tr">
<td id="S5.T2.1.2.2.1" class="ltx_td ltx_align_left"><span id="S5.T2.1.2.2.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Method</span></td>
<td id="S5.T2.1.2.2.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.2.2.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Acc (SD)</span></td>
<td id="S5.T2.1.2.2.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.2.2.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Acc (SD)</span></td>
<td id="S5.T2.1.2.2.4" class="ltx_td ltx_align_right"><span id="S5.T2.1.2.2.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Acc (SD)</span></td>
</tr>
<tr id="S5.T2.1.3.3" class="ltx_tr">
<td id="S5.T2.1.3.3.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T2.1.3.3.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">FedAvg (hospital)</span></td>
<td id="S5.T2.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.3.3.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.55 (0.01)</span></td>
<td id="S5.T2.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.3.3.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.33 (0.01)</span></td>
<td id="S5.T2.1.3.3.4" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T2.1.3.3.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.47 (0.02)</span></td>
</tr>
<tr id="S5.T2.1.4.4" class="ltx_tr">
<td id="S5.T2.1.4.4.1" class="ltx_td ltx_align_left"><span id="S5.T2.1.4.4.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">FedMA (hospital)</span></td>
<td id="S5.T2.1.4.4.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.4.4.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.56 (0.02)</span></td>
<td id="S5.T2.1.4.4.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.4.4.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.45 (0.02)</span></td>
<td id="S5.T2.1.4.4.4" class="ltx_td ltx_align_right"><span id="S5.T2.1.4.4.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.52 (0.01)</span></td>
</tr>
<tr id="S5.T2.1.5.5" class="ltx_tr">
<td id="S5.T2.1.5.5.1" class="ltx_td ltx_align_left"><span id="S5.T2.1.5.5.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">FLST (hospital)</span></td>
<td id="S5.T2.1.5.5.2" class="ltx_td ltx_align_center">
<span id="S5.T2.1.5.5.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.60</span><span id="S5.T2.1.5.5.2.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.02)</span>
</td>
<td id="S5.T2.1.5.5.3" class="ltx_td ltx_align_center">
<span id="S5.T2.1.5.5.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.59</span><span id="S5.T2.1.5.5.3.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.01)</span>
</td>
<td id="S5.T2.1.5.5.4" class="ltx_td ltx_align_right">
<span id="S5.T2.1.5.5.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.59</span><span id="S5.T2.1.5.5.4.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.02)</span>
</td>
</tr>
<tr id="S5.T2.1.6.6" class="ltx_tr">
<td id="S5.T2.1.6.6.1" class="ltx_td ltx_align_left"><span id="S5.T2.1.6.6.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">FedAvg (CIFAR-10)</span></td>
<td id="S5.T2.1.6.6.2" class="ltx_td ltx_align_center">
<span id="S5.T2.1.6.6.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.93</span><span id="S5.T2.1.6.6.2.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.01)</span>
</td>
<td id="S5.T2.1.6.6.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.6.6.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.62 (0.01)</span></td>
<td id="S5.T2.1.6.6.4" class="ltx_td ltx_align_right"><span id="S5.T2.1.6.6.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.65 (0.02)</span></td>
</tr>
<tr id="S5.T2.1.7.7" class="ltx_tr">
<td id="S5.T2.1.7.7.1" class="ltx_td ltx_align_left"><span id="S5.T2.1.7.7.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">FedMA (CIFAR-10)</span></td>
<td id="S5.T2.1.7.7.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.7.7.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.93 (0.02)</span></td>
<td id="S5.T2.1.7.7.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.7.7.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.77 (0.02)</span></td>
<td id="S5.T2.1.7.7.4" class="ltx_td ltx_align_right"><span id="S5.T2.1.7.7.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.68 (0.01)</span></td>
</tr>
<tr id="S5.T2.1.8.8" class="ltx_tr">
<td id="S5.T2.1.8.8.1" class="ltx_td ltx_align_left"><span id="S5.T2.1.8.8.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">FLST (CIFAR-10)</span></td>
<td id="S5.T2.1.8.8.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.8.8.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.90 (0.01)</span></td>
<td id="S5.T2.1.8.8.3" class="ltx_td ltx_align_center">
<span id="S5.T2.1.8.8.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.85</span><span id="S5.T2.1.8.8.3.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.01)</span>
</td>
<td id="S5.T2.1.8.8.4" class="ltx_td ltx_align_right">
<span id="S5.T2.1.8.8.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.87</span><span id="S5.T2.1.8.8.4.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.02)</span>
</td>
</tr>
<tr id="S5.T2.1.9.9" class="ltx_tr">
<td id="S5.T2.1.9.9.1" class="ltx_td ltx_align_left"><span id="S5.T2.1.9.9.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">FedAvg (MNIST)</span></td>
<td id="S5.T2.1.9.9.2" class="ltx_td ltx_align_center">
<span id="S5.T2.1.9.9.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.95</span><span id="S5.T2.1.9.9.2.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.01)</span>
</td>
<td id="S5.T2.1.9.9.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.9.9.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.77 (0.01)</span></td>
<td id="S5.T2.1.9.9.4" class="ltx_td ltx_align_right"><span id="S5.T2.1.9.9.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.73 (0.02)</span></td>
</tr>
<tr id="S5.T2.1.10.10" class="ltx_tr">
<td id="S5.T2.1.10.10.1" class="ltx_td ltx_align_left"><span id="S5.T2.1.10.10.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">FedMA (MNIST)</span></td>
<td id="S5.T2.1.10.10.2" class="ltx_td ltx_align_center">
<span id="S5.T2.1.10.10.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.95</span><span id="S5.T2.1.10.10.2.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.01)</span>
</td>
<td id="S5.T2.1.10.10.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.10.10.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.83 (0.01)</span></td>
<td id="S5.T2.1.10.10.4" class="ltx_td ltx_align_right"><span id="S5.T2.1.10.10.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.81 (0.02)</span></td>
</tr>
<tr id="S5.T2.1.11.11" class="ltx_tr">
<td id="S5.T2.1.11.11.1" class="ltx_td ltx_align_left"><span id="S5.T2.1.11.11.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">FLST (MNIST)</span></td>
<td id="S5.T2.1.11.11.2" class="ltx_td ltx_align_center">
<span id="S5.T2.1.11.11.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.95</span><span id="S5.T2.1.11.11.2.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.02)</span>
</td>
<td id="S5.T2.1.11.11.3" class="ltx_td ltx_align_center">
<span id="S5.T2.1.11.11.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.86</span><span id="S5.T2.1.11.11.3.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.02)</span>
</td>
<td id="S5.T2.1.11.11.4" class="ltx_td ltx_align_right">
<span id="S5.T2.1.11.11.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.88</span><span id="S5.T2.1.11.11.4.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.01)</span>
</td>
</tr>
<tr id="S5.T2.1.12.12" class="ltx_tr">
<td id="S5.T2.1.12.12.1" class="ltx_td ltx_align_left"><span id="S5.T2.1.12.12.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">FedAvg - AUC (eICU)</span></td>
<td id="S5.T2.1.12.12.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.12.12.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.80 (0.01)</span></td>
<td id="S5.T2.1.12.12.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.12.12.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.65 (0.07)</span></td>
<td id="S5.T2.1.12.12.4" class="ltx_td ltx_align_right"><span id="S5.T2.1.12.12.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.69 (0.12)</span></td>
</tr>
<tr id="S5.T2.1.13.13" class="ltx_tr">
<td id="S5.T2.1.13.13.1" class="ltx_td ltx_align_left"><span id="S5.T2.1.13.13.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">FedMA - AUC (eICU)</span></td>
<td id="S5.T2.1.13.13.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.13.13.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.82 (0.01)</span></td>
<td id="S5.T2.1.13.13.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.13.13.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.71 (0.09)</span></td>
<td id="S5.T2.1.13.13.4" class="ltx_td ltx_align_right"><span id="S5.T2.1.13.13.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">0.72 (0.04)</span></td>
</tr>
<tr id="S5.T2.1.14.14" class="ltx_tr">
<td id="S5.T2.1.14.14.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T2.1.14.14.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">FLST - AUC (eICU)</span></td>
<td id="S5.T2.1.14.14.2" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T2.1.14.14.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.86</span><span id="S5.T2.1.14.14.2.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.02)</span>
</td>
<td id="S5.T2.1.14.14.3" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T2.1.14.14.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.80</span><span id="S5.T2.1.14.14.3.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.04)</span>
</td>
<td id="S5.T2.1.14.14.4" class="ltx_td ltx_align_right ltx_border_bb">
<span id="S5.T2.1.14.14.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.81</span><span id="S5.T2.1.14.14.4.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"> (0.03)</span>
</td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">As our work lies in the intersection of two research areas within the field of machine learning (namely federated learning and student-teacher learning), we choose to use baselines from both of these fields as comparators. From the student-teacher learning side, we will assess how our method compares in terms of final model performance only. For the federated learning comparison we will compare not only the final model performance but also the robustness of the method to attack.</p>
</div>
<section id="S5.SS0.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Final Model Performance</h4>

<div id="S5.SS0.SSSx1.p1" class="ltx_para">
<p id="S5.SS0.SSSx1.p1.1" class="ltx_p">Table <a href="#S5.T1" title="Table 1 ‣ 5 Results ‣ Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows how the performance of our federated learning method (FLST) compares to other state-of-the-art classification methods. The baselines we use are the reinforcement learning trained student-teacher setup without scheduling <cite class="ltx_cite ltx_citemacro_citep">(El-Bouri et al., <a href="#bib.bib5" title="" class="ltx_ref">2020</a>)</cite> (RLST), two state-of-the-art methods used for classifying tabular data (DeepFM <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib11" title="" class="ltx_ref">2017</a>)</cite> and Deep+CrossNet <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib29" title="" class="ltx_ref">2017</a>)</cite>) and two state-of-the-art classifiers for image recognition (GPipe <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib13" title="" class="ltx_ref">2019</a>)</cite> and DenseNet <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib12" title="" class="ltx_ref">2018</a>)</cite>). As baselines we train a standard feedforward neural network (a convolutional neural network for the image datasets) using stochastic mini-batch training (SMBT) and a curriculum (CURRIC) for comparison.</p>
</div>
<div id="S5.SS0.SSSx1.p2" class="ltx_para">
<p id="S5.SS0.SSSx1.p2.1" class="ltx_p">We see that our federated system is capable of producing a performance that is competing with state-of-the-art models that are trained in a centralised manner. Figure <a href="#S5.F3" title="Figure 3 ‣ Robustness of Federated Training Routine ‣ 5 Results ‣ Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the scheduler outputs during training for the hospital admission problem and Figure <a href="#S5.F4" title="Figure 4 ‣ Robustness of Federated Training Routine ‣ 5 Results ‣ Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the performance of the student and the actions of the teacher during training.</p>
</div>
</section>
<section id="S5.SS0.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Learning from Multiple Hospitals</h4>

<div id="S5.SS0.SSSx2.p1" class="ltx_para">
<p id="S5.SS0.SSSx2.p1.1" class="ltx_p">When training on the eICU dataset, we utilised data from individual hospitals as the separate nodes in the federated system. A natural question that arises is how the increasing the number of nodes in the system affects the final performance of the student.</p>
</div>
<figure id="S5.F2" class="ltx_figure"><img src="/html/2107.01707/assets/eICU_nodes_accuracy.png" id="S5.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="216" height="144" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The number of nodes in the federated system (i.e., number of hospitals) versus the student performance at test time. Note that in this figure the seed of the scheduler is held constant and the error bars correspond to the scores generated from using different hospitals for training. So for N=k nodes, the error bars correspond to training only using data from ten different combinations of k hospitals.</figcaption>
</figure>
<div id="S5.SS0.SSSx2.p2" class="ltx_para">
<p id="S5.SS0.SSSx2.p2.1" class="ltx_p">In Figure <a href="#S5.F2" title="Figure 2 ‣ Learning from Multiple Hospitals ‣ 5 Results ‣ Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> we carry out an ablation on the number of nodes in the system and how it affects performance. In this plot, the scheduler is held at constant seed and the error bars are generated due to selecting different hospitals to train on. There are a total of 208 hospitals in the eICU dataset, but we only select from the top 20 in terms of volume of data recorded. As a result, Figure <a href="#S5.F2" title="Figure 2 ‣ Learning from Multiple Hospitals ‣ 5 Results ‣ Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows error bars for the difference in performance when ten different combinations of hospital data are used. We can see that with more data being used in the system, the final performance generally increases. We also see that the variance in the performance starts to decrease with the increase in the number of nodes. Given the increase in the volume of data being trained with as nodes are added, this aligns with expectations. The performance seems to plateau indicating that adding more nodes to the system may not necessarily be beneficial for performance. This could be useful for real-world application as it will allow practitioners to prioritise data centres with the highest quality data for their federated systems.</p>
</div>
</section>
<section id="S5.SS0.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Robustness of Federated Training Routine</h4>

<div id="S5.SS0.SSSx3.p1" class="ltx_para">
<p id="S5.SS0.SSSx3.p1.1" class="ltx_p">Table <a href="#S5.T2" title="Table 2 ‣ 5 Results ‣ Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows how our method performs when compared to other federated learning algorithms. For our baselines we use FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib20" title="" class="ltx_ref">2017</a>)</cite> where the local models at each node are aggregated before being averaged, as well as FedMA <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib28" title="" class="ltx_ref">2020a</a>)</cite>, which constructs a shared global model in a layer-wise manner by matching and averaging hidden elements (such as neurons and hidden states). We investigate how performance deteriorates when exposed to different backdoor attacks. We see that our model performs equivalently to state-of-the art federated training setups in terms of test-time performance but outperforms these models when exposed to attack. Through the use of the scheduler, our approach provides an added layer of redundancy in the system thereby allowing attacks to be avoided after their implicit detection through degraded performance on the validation sets stored at all nodes.</p>
</div>
<figure id="S5.F3" class="ltx_figure"><img src="/html/2107.01707/assets/contribs0.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="216" height="144" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>A four-node federated system being scheduled for training a student on the hospital admission location prediction problem. The different colours represent the different nodes.</figcaption>
</figure>
<figure id="S5.F4" class="ltx_figure"><img src="/html/2107.01707/assets/plots3.png" id="S5.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="216" height="144" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The performance of the student and actions taken by the teachers (scheduled according to Figure <a href="#S5.F3" title="Figure 3 ‣ Robustness of Federated Training Routine ‣ 5 Results ‣ Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) at each node to train the student. The orange ‘x’ and blue bar indicate the first and second outputs of the teacher respectively (index of data along the curriculum that is selected and how much data around this to include in that batch). The red line shows the performance of the student on the held-out test set on the hospital admission problem.</figcaption>
</figure>
</section>
<section id="S5.SS0.SSSx4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Iterative Learning</h4>

<div id="S5.SS0.SSSx4.p1" class="ltx_para">
<p id="S5.SS0.SSSx4.p1.1" class="ltx_p">In our approach we choose to exploit local models to select data and therefore extract gradients that we use to update a global model. The advantage of this approach is that it provides flexibility for a poisoned node within the federated system to be discounted or unused. This can also be done on the fly without the need to inspect the local models after each training run or the data stored at each node. In the following section we look at the ways that a node can be compromised and see how our setup may be able to avoid the global model being poisoned by these scenarios.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Implicit Defensive Setup</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">There are various ways in which a federated system can be attacked. In this section, we first show that the scheduler chooses appropriate nodes for training. We then aim to show how using a teaching setup, we can avoid some of the issues that could be faced by a federated learning system under attack.</p>
</div>
<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Selecting the Right Teacher</h3>

<div id="S6.SS1.p1" class="ltx_para">
<p id="S6.SS1.p1.1" class="ltx_p">In our first set of experiments we aimed to see if the scheduler would be able to select the appropriate teacher for the learning task at hand. Our scheduler’s task is to select a teacher from three different nodes to train the student. We pre-trained three teachers for separate tasks (hospital admission, CIFAR-10 and MIMIC-III mortality prediction <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a href="#bib.bib14" title="" class="ltx_ref">2016</a>)</cite>) and allowed our scheduler to choose from these in order to source the data for training. Figure <a href="#S6.F5" title="Figure 5 ‣ 6.1 Selecting the Right Teacher ‣ 6 Implicit Defensive Setup ‣ Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows how with training, the scheduler learns to assign the teaching job to the node that contains the teacher trained to teach CIFAR-10 learning. As training progresses, the response from the scheduler becomes entirely dominated by the node in the federated system that corresponds to the appropriate teacher for the task. From this we see that our approach allows for robust teacher selection (further examples of this are included in the supplementary material).</p>
</div>
<figure id="S6.F5" class="ltx_figure"><img src="/html/2107.01707/assets/stepbystep_teacher_selected.png" id="S6.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="216" height="144" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Scheduler selection as the student is trained. The student is being trained on CIFAR-10 and the scheduler learns to use the CIFAR-10 teacher to teach the student.</figcaption>
</figure>
<section id="S6.SS1.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Compromised Data at Nodes</h4>

<div id="S6.SS1.SSSx1.p1" class="ltx_para">
<p id="S6.SS1.SSSx1.p1.1" class="ltx_p">Our next set of experiments investigated the robustness of our method to attack through poisoning of data at local nodes in the federated system. By scheduling training through the use of meta-gradients, we hypothesised that there would be an extra layer of redundancy which would prevent immediate poisoning of the model. In this experimental setup we split our dataset randomly (the size of the splits is also random). We only keep one node clean, with the rest of the datasets on the other nodes being replaced with random values. Figure <a href="#S6.F6" title="Figure 6 ‣ Compromised Data at Nodes ‣ 6.1 Selecting the Right Teacher ‣ 6 Implicit Defensive Setup ‣ Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows learned scheduling for a student being trained on the MNIST dataset. We see how the scheduler begins with selecting a corrupted dataset before quickly transitioning to selecting another corrupted dataset. The scheduler then selects a dataset with clean data and this selection dominates for the rest of training. In Figure <a href="#S6.F7" title="Figure 7 ‣ Compromised Data at Nodes ‣ 6.1 Selecting the Right Teacher ‣ 6 Implicit Defensive Setup ‣ Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> we see that due to the initial training on corrupted data, the test-set performance degrades. However, as soon as the scheduler learns to use the clean data, the performance improves rapidly. It can also be noticed that the performance achieved is below state-of-the-art. This is likely due to there being a much smaller diversity in trainin data due to node corruption.</p>
</div>
<figure id="S6.F6" class="ltx_figure"><img src="/html/2107.01707/assets/principal_contribs1MNIST.png" id="S6.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="256" height="192" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>The scheduler selection for the different nodes in the federated system. We see that the scheduler learns to select the only clean dataset for training. The magnitudes of the different colours indicate the softmax output of the scheduler.</figcaption>
</figure>
<figure id="S6.F7" class="ltx_figure"><img src="/html/2107.01707/assets/student_performance1MNIST.png" id="S6.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="256" height="192" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>The teacher data selection as well as the performance of the student on the held-out test set for the MNIST digit recognition problem. The orange ‘x’ and blue bars represent the first and second outputs of the teacher respectively. The dashed line shows the maximum accuracy achieved. The red line is the performance of the student on the held-out test set.</figcaption>
</figure>
</section>
<section id="S6.SS1.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Compromised Local Models at Nodes</h4>

<div id="S6.SS1.SSSx2.p1" class="ltx_para">
<p id="S6.SS1.SSSx2.p1.1" class="ltx_p">The next experiment we investigate is how our system trains when there are compromised local models (whether it is the student or the teacher). We do this by replacing one of the weights of the teacher on one of the local nodes with random values. Due to the setup, the effect of having a compromised student or teacher is the same: a high loss which encourages the scheduler to change its selection. Figure <a href="#S6.F8" title="Figure 8 ‣ Compromised Local Models at Nodes ‣ 6.1 Selecting the Right Teacher ‣ 6 Implicit Defensive Setup ‣ Towards Scheduling Federated Deep Learning using Meta-Gradients for Inter-Hospital Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> shows how the scheduler selects nodes to train from. We see initially nodes 1 and 0 are used to train before the scheduler attempts to use the poisoned teacher. After repeated reductions in the federated validation sets, the scheduler rapidly changes its selection favouring nodes 4 and increasingly 3. With further training, we see this rapid removal of training using node 1 continue whenever it is encountered.</p>
</div>
<figure id="S6.F8" class="ltx_figure"><img src="/html/2107.01707/assets/principal_contributions1.png" id="S6.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="288" height="216" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Scheduler selection for a four-node federated system. The hosp1 node (orange) corresponds to the poisoned teacher (randomised weights). We see that after brief selection, the scheduler reduces the contribution of this node. The student is being trained on the MNIST task.</figcaption>
</figure>
</section>
<section id="S6.SS1.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Transfer Learning</h4>

<div id="S6.SS1.SSSx3.p1" class="ltx_para">
<p id="S6.SS1.SSSx3.p1.1" class="ltx_p">Due to the use of a scheduler, there is potential for exploiting transfer learning in order to train students on tasks that there are no trained teachers for. We hypothesise that through exploiting the various teacher’s skills in succession, we can provide the gradients that the student needs in order to master the unseen task. Experiments to test this hypothesis are included in the supplementary material.</p>
</div>
</section>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Discussion and Conclusion</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">In this work we have shown that using a federated system, with teachers at the nodes that select the data to provide gradient updates to a central model, can achieve state-of-the-art performance as well as protect the privacy of patients. We have further shown that the setup provides some protection against attacks on data stored at each node or the local models being used at each node.</p>
</div>
<div id="S7.p2" class="ltx_para">
<p id="S7.p2.1" class="ltx_p">However, there remain some challenges associated with this approach that need to be addressed in order for it to become practicable. The first is that the training of the centralised model (student) is inherently unstable due to the continual training that this setup expects. It is expected that the student performance will converge with training, however should data poisoning occur, the scheduler will need to continue a few iterations of training in order to recover a well-performing model. However, posing the problem in this way also provides flexibility for growing datasets at each node. All that would need to happen would be the re-sorting of the curriculum at each node and the scheduler and teachers could be used as before.</p>
</div>
<div id="S7.p3" class="ltx_para">
<p id="S7.p3.1" class="ltx_p">Another limitation is the need for centralised control. It is important in this setup that all the hospitals communicate their responses to the central node for actions to be taken by the scheduler. In the case of large institutions such as hospitals, this may be acceptable, but is unlikely to be for faster-paced learning environments such as learning from mobile phones, where interruptions to communication can be frequent. However, upon re-connection to the federated system, any reductions in performance to the whole system will be used as signals to improve the scheduler selection and with training the performance should recover.</p>
</div>
<div id="S7.p4" class="ltx_para">
<p id="S7.p4.1" class="ltx_p">Furthermore, in order to ensure diversity in selections by the scheduler we introduced the entropy loss that discouraged convergence on one selection. This may be a naive way of encouraging diversity in selection and we believe that there may be better additive losses and regularisation terms that can be used to design a loss function that will serve the purposes of the scheduler better.</p>
</div>
<div id="S7.p5" class="ltx_para">
<p id="S7.p5.1" class="ltx_p">For further protection against attack, sentry agents (much like the teachers) could also be trained to detect any anomalies or designed attacks within the batches selected by the teachers before the losses are passed onto the central node. This would reduce the burden of scanning the entire dataset at the node before training.</p>
</div>
<div id="S7.p6" class="ltx_para">
<p id="S7.p6.1" class="ltx_p">To conclude, we believe we have presented a promising direction for federated learning between large institutions such as hospitals. With further work, we believe that we can develop this into a robust system that can continually learn from growing datasets while maintaining a state-of-the-art performance for the task at hand.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bagdasaryan et al. (2020)</span>
<span class="ltx_bibblock">
Bagdasaryan, E., Veit, A., Hua, Y., Estrin, D., and Shmatikov, V.

</span>
<span class="ltx_bibblock">How to backdoor federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">International Conference on Artificial Intelligence and
Statistics</em>, pp.  2938–2948. PMLR, 2020.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bengio et al. (2009)</span>
<span class="ltx_bibblock">
Bengio, Y., Louradour, J., Collobert, R., and Weston, J.

</span>
<span class="ltx_bibblock">Curriculum learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 26th annual international conference on
machine learning</em>, pp.  41–48, 2009.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhagoji et al. (2018)</span>
<span class="ltx_bibblock">
Bhagoji, A. N., Chakraborty, S., Mittal, P., and Calo, S.

</span>
<span class="ltx_bibblock">Model poisoning attacks in federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proc. Workshop Secur. Mach. Learn.(SecML) 32nd Conf. Neural
Inf. Process. Syst.(NeurIPS)</em>, 2018.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bonawitz et al. (2019)</span>
<span class="ltx_bibblock">
Bonawitz, K., Eichner, H., Grieskamp, W., Huba, D., Ingerman, A., Ivanov, V.,
Kiddon, C., Konečnỳ, J., Mazzocchi, S., McMahan, H. B., et al.

</span>
<span class="ltx_bibblock">Towards federated learning at scale: System design.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1902.01046</em>, 2019.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">El-Bouri et al. (2020)</span>
<span class="ltx_bibblock">
El-Bouri, R., Eyre, D., Watkinson, P., Zhu, T., and Clifton, D.

</span>
<span class="ltx_bibblock">Student-teacher curriculum learning via reinforcement learning:
predicting hospital inpatient admission location.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2007.01135</em>, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan et al. (2018)</span>
<span class="ltx_bibblock">
Fan, Y., Tian, F., Qin, T., Li, X.-Y., and Liu, T.-Y.

</span>
<span class="ltx_bibblock">Learning to teach.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1805.03643</em>, 2018.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fang et al. (2020)</span>
<span class="ltx_bibblock">
Fang, M., Cao, X., Jia, J., and Gong, N.

</span>
<span class="ltx_bibblock">Local model poisoning attacks to byzantine-robust federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.4.4" class="ltx_emph ltx_font_italic">29th <math id="bib.bib7.1.1.m1.1" class="ltx_Math" alttext="\{" display="inline"><semantics id="bib.bib7.1.1.m1.1a"><mo stretchy="false" id="bib.bib7.1.1.m1.1.1" xref="bib.bib7.1.1.m1.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="bib.bib7.1.1.m1.1b"><ci id="bib.bib7.1.1.m1.1.1.cmml" xref="bib.bib7.1.1.m1.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib7.1.1.m1.1c">\{</annotation></semantics></math>USENIX<math id="bib.bib7.2.2.m2.1" class="ltx_Math" alttext="\}" display="inline"><semantics id="bib.bib7.2.2.m2.1a"><mo stretchy="false" id="bib.bib7.2.2.m2.1.1" xref="bib.bib7.2.2.m2.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="bib.bib7.2.2.m2.1b"><ci id="bib.bib7.2.2.m2.1.1.cmml" xref="bib.bib7.2.2.m2.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib7.2.2.m2.1c">\}</annotation></semantics></math> Security Symposium (<math id="bib.bib7.3.3.m3.1" class="ltx_Math" alttext="\{" display="inline"><semantics id="bib.bib7.3.3.m3.1a"><mo stretchy="false" id="bib.bib7.3.3.m3.1.1" xref="bib.bib7.3.3.m3.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="bib.bib7.3.3.m3.1b"><ci id="bib.bib7.3.3.m3.1.1.cmml" xref="bib.bib7.3.3.m3.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib7.3.3.m3.1c">\{</annotation></semantics></math>USENIX<math id="bib.bib7.4.4.m4.1" class="ltx_Math" alttext="\}" display="inline"><semantics id="bib.bib7.4.4.m4.1a"><mo stretchy="false" id="bib.bib7.4.4.m4.1.1" xref="bib.bib7.4.4.m4.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="bib.bib7.4.4.m4.1b"><ci id="bib.bib7.4.4.m4.1.1.cmml" xref="bib.bib7.4.4.m4.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib7.4.4.m4.1c">\}</annotation></semantics></math>
Security 20)</em>, pp.  1605–1622, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goldberger et al. (2000)</span>
<span class="ltx_bibblock">
Goldberger, A. L., Amaral, L. A., Glass, L., Hausdorff, J. M., Ivanov, P. C.,
Mark, R. G., Mietus, J. E., Moody, G. B., Peng, C.-K., and Stanley, H. E.

</span>
<span class="ltx_bibblock">Physiobank, physiotoolkit, and physionet: components of a new
research resource for complex physiologic signals.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">circulation</em>, 101(23):e215–e220, 2000.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Graves et al. (2017)</span>
<span class="ltx_bibblock">
Graves, A., Bellemare, M. G., Menick, J., Munos, R., and Kavukcuoglu, K.

</span>
<span class="ltx_bibblock">Automated curriculum learning for neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1704.03003</em>, 2017.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. (2017)</span>
<span class="ltx_bibblock">
Gu, T., Dolan-Gavitt, B., and Garg, S.

</span>
<span class="ltx_bibblock">Badnets: Identifying vulnerabilities in the machine learning model
supply chain.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1708.06733</em>, 2017.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2017)</span>
<span class="ltx_bibblock">
Guo, H., Tang, R., Ye, Y., Li, Z., and He, X.

</span>
<span class="ltx_bibblock">Deepfm: a factorization-machine based neural network for ctr
prediction.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1703.04247</em>, 2017.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2018)</span>
<span class="ltx_bibblock">
Huang, G., Liu, S., Van der Maaten, L., and Weinberger, K. Q.

</span>
<span class="ltx_bibblock">Condensenet: An efficient densenet using learned group convolutions.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, pp.  2752–2761, 2018.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2019)</span>
<span class="ltx_bibblock">
Huang, Y., Cheng, Y., Bapna, A., Firat, O., Chen, D., Chen, M., Lee, H., Ngiam,
J., Le, Q. V., Wu, Y., et al.

</span>
<span class="ltx_bibblock">Gpipe: Efficient training of giant neural networks using pipeline
parallelism.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, pp. 103–112, 2019.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Johnson et al. (2016)</span>
<span class="ltx_bibblock">
Johnson, A. E., Pollard, T. J., Shen, L., Li-Wei, H. L., Feng, M., Ghassemi,
M., Moody, B., Szolovits, P., Celi, L. A., and Mark, R. G.

</span>
<span class="ltx_bibblock">Mimic-iii, a freely accessible critical care database.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Scientific data</em>, 3(1):1–9, 2016.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et al. (2009)</span>
<span class="ltx_bibblock">
Krizhevsky, A., Hinton, G., et al.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock">2009.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">LeCun et al. (1998)</span>
<span class="ltx_bibblock">
LeCun, Y., Bottou, L., Bengio, Y., and Haffner, P.

</span>
<span class="ltx_bibblock">Gradient-based learning applied to document recognition.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE</em>, 86(11):2278–2324, 1998.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2018)</span>
<span class="ltx_bibblock">
Liu, K., Dolan-Gavitt, B., and Garg, S.

</span>
<span class="ltx_bibblock">Fine-pruning: Defending against backdooring attacks on deep neural
networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">International Symposium on Research in Attacks, Intrusions,
and Defenses</em>, pp.  273–294. Springer, 2018.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2017a)</span>
<span class="ltx_bibblock">
Liu, W., Dai, B., Humayun, A., Tay, C., Yu, C., Smith, L. B., Rehg, J. M., and
Song, L.

</span>
<span class="ltx_bibblock">Iterative machine teaching.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1705.10470</em>, 2017a.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2017b)</span>
<span class="ltx_bibblock">
Liu, Y., Xie, Y., and Srivastava, A.

</span>
<span class="ltx_bibblock">Neural trojans.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">2017 IEEE International Conference on Computer Design
(ICCD)</em>, pp.  45–48. IEEE, 2017b.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., and y Arcas, B. A.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Artificial Intelligence and Statistics</em>, pp.  1273–1282.
PMLR, 2017.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mnih et al. (2015)</span>
<span class="ltx_bibblock">
Mnih, V., Kavukcuoglu, K., Silver, D., Rusu, A. A., Veness, J., Bellemare,
M. G., Graves, A., Riedmiller, M., Fidjeland, A. K., Ostrovski, G., et al.

</span>
<span class="ltx_bibblock">Human-level control through deep reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">nature</em>, 518(7540):529–533, 2015.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pollard et al. (2018)</span>
<span class="ltx_bibblock">
Pollard, T. J., Johnson, A. E., Raffa, J. D., Celi, L. A., Mark, R. G., and
Badawi, O.

</span>
<span class="ltx_bibblock">The eicu collaborative research database, a freely available
multi-center database for critical care research.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Scientific data</em>, 5(1):1–13, 2018.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shailaja et al. (2018)</span>
<span class="ltx_bibblock">
Shailaja, K., Seetharamulu, B., and Jabbar, M.

</span>
<span class="ltx_bibblock">Machine learning in healthcare: A review.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">2018 Second international conference on electronics,
communication and aerospace technology (ICECA)</em>, pp.  910–914. IEEE, 2018.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sheikhalishahi et al. (2020)</span>
<span class="ltx_bibblock">
Sheikhalishahi, S., Balaraman, V., and Osmani, V.

</span>
<span class="ltx_bibblock">Benchmarking machine learning models on multi-centre eicu critical
care dataset.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Plos one</em>, 15(7):e0235424, 2020.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Such et al. (2019)</span>
<span class="ltx_bibblock">
Such, F. P., Rawal, A., Lehman, J., Stanley, K. O., and Clune, J.

</span>
<span class="ltx_bibblock">Generative teaching networks: Accelerating neural architecture search
by learning to generate synthetic training data.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1912.07768</em>, 2019.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tolpegin et al. (2020)</span>
<span class="ltx_bibblock">
Tolpegin, V., Truex, S., Gursoy, M. E., and Liu, L.

</span>
<span class="ltx_bibblock">Data poisoning attacks against federated learning systems.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">European Symposium on Research in Computer Security</em>, pp. 480–501. Springer, 2020.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2019)</span>
<span class="ltx_bibblock">
Wang, B., Yao, Y., Shan, S., Li, H., Viswanath, B., Zheng, H., and Zhao, B. Y.

</span>
<span class="ltx_bibblock">Neural cleanse: Identifying and mitigating backdoor attacks in neural
networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">2019 IEEE Symposium on Security and Privacy (SP)</em>, pp. 707–723. IEEE, 2019.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020a)</span>
<span class="ltx_bibblock">
Wang, H., Yurochkin, M., Sun, Y., Papailiopoulos, D., and Khazaeni, Y.

</span>
<span class="ltx_bibblock">Federated learning with matched averaging.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.06440</em>, 2020a.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2017)</span>
<span class="ltx_bibblock">
Wang, R., Fu, B., Fu, G., and Wang, M.

</span>
<span class="ltx_bibblock">Deep &amp; cross network for ad click predictions.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proceedings of the ADKDD’17</em>, pp.  1–7. 2017.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020b)</span>
<span class="ltx_bibblock">
Wang, X., Chen, Y., and Zhu, W.

</span>
<span class="ltx_bibblock">A comprehensive survey on curriculum learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.13166</em>, 2020b.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2019)</span>
<span class="ltx_bibblock">
Xu, R., Baracaldo, N., Zhou, Y., Anwar, A., and Ludwig, H.

</span>
<span class="ltx_bibblock">Hybridalpha: An efficient approach for privacy-preserving federated
learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 12th ACM Workshop on Artificial
Intelligence and Security</em>, pp.  13–23, 2019.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan &amp; Ma (2020)</span>
<span class="ltx_bibblock">
Yuan, H. and Ma, T.

</span>
<span class="ltx_bibblock">Federated accelerated stochastic gradient descent.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2006.08950</em>, 2020.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zahavy et al. (2020)</span>
<span class="ltx_bibblock">
Zahavy, T., Xu, Z., Veeriah, V., Hessel, M., Oh, J., van Hasselt, H. P.,
Silver, D., and Singh, S.

</span>
<span class="ltx_bibblock">A self-tuning actor-critic algorithm.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33, 2020.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Features</h2>

<figure id="A1.T3" class="ltx_table">
<table id="A1.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T3.1.1.1" class="ltx_tr">
<th id="A1.T3.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">Bacteriology test requested?</th>
<th id="A1.T3.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t">Biochemical tests requested?</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T3.1.2.1" class="ltx_tr">
<td id="A1.T3.1.2.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Blood cultures requested</td>
<td id="A1.T3.1.2.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Blood gas test requested?</td>
</tr>
<tr id="A1.T3.1.3.2" class="ltx_tr">
<td id="A1.T3.1.3.2.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">CT scan requested?</td>
<td id="A1.T3.1.3.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Cardiac enzyme test requested?</td>
</tr>
<tr id="A1.T3.1.4.3" class="ltx_tr">
<td id="A1.T3.1.4.3.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Clotting study requested</td>
<td id="A1.T3.1.4.3.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Blood cross-matching requested?</td>
</tr>
<tr id="A1.T3.1.5.4" class="ltx_tr">
<td id="A1.T3.1.5.4.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Heart rate at entry</td>
<td id="A1.T3.1.5.4.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Dental investigation requested?</td>
</tr>
<tr id="A1.T3.1.6.5" class="ltx_tr">
<td id="A1.T3.1.6.5.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">ECG requested?</td>
<td id="A1.T3.1.6.5.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Haematology test requested?</td>
</tr>
<tr id="A1.T3.1.7.6" class="ltx_tr">
<td id="A1.T3.1.7.6.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">MRI scan requested?</td>
<td id="A1.T3.1.7.6.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Immunology test requested?</td>
</tr>
<tr id="A1.T3.1.8.7" class="ltx_tr">
<td id="A1.T3.1.8.7.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Continuous vitals requested?</td>
<td id="A1.T3.1.8.7.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">No tests requested</td>
</tr>
<tr id="A1.T3.1.9.8" class="ltx_tr">
<td id="A1.T3.1.9.8.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Orthopedic tests requested?</td>
<td id="A1.T3.1.9.8.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Other tests requested?</td>
</tr>
<tr id="A1.T3.1.10.9" class="ltx_tr">
<td id="A1.T3.1.10.9.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Pregnancy test requested?</td>
<td id="A1.T3.1.10.9.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Respiratory rate at entry</td>
</tr>
<tr id="A1.T3.1.11.10" class="ltx_tr">
<td id="A1.T3.1.11.10.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Serology test requested?</td>
<td id="A1.T3.1.11.10.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Previous specialty</td>
</tr>
<tr id="A1.T3.1.12.11" class="ltx_tr">
<td id="A1.T3.1.12.11.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Toxicology test requested?</td>
<td id="A1.T3.1.12.11.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Ultrasound test requested?</td>
</tr>
<tr id="A1.T3.1.13.12" class="ltx_tr">
<td id="A1.T3.1.13.12.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Urine test requested?</td>
<td id="A1.T3.1.13.12.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">X-ray scan requested?</td>
</tr>
<tr id="A1.T3.1.14.13" class="ltx_tr">
<td id="A1.T3.1.14.13.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Admission method</td>
<td id="A1.T3.1.14.13.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Admission source</td>
</tr>
<tr id="A1.T3.1.15.14" class="ltx_tr">
<td id="A1.T3.1.15.14.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Age</td>
<td id="A1.T3.1.15.14.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Experiencing atrial fibrillation?</td>
</tr>
<tr id="A1.T3.1.16.15" class="ltx_tr">
<td id="A1.T3.1.16.15.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"># historic diagnoses</td>
<td id="A1.T3.1.16.15.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Previous management</td>
</tr>
<tr id="A1.T3.1.17.16" class="ltx_tr">
<td id="A1.T3.1.17.16.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Previous admission to ED?</td>
<td id="A1.T3.1.17.16.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Ethnic category</td>
</tr>
<tr id="A1.T3.1.18.17" class="ltx_tr">
<td id="A1.T3.1.18.17.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Frequently admitted?</td>
<td id="A1.T3.1.18.17.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Gender</td>
</tr>
<tr id="A1.T3.1.19.18" class="ltx_tr">
<td id="A1.T3.1.19.18.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Dist. of address to hospital</td>
<td id="A1.T3.1.19.18.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">No. Investigations requested</td>
</tr>
<tr id="A1.T3.1.20.19" class="ltx_tr">
<td id="A1.T3.1.20.19.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Previous ED visit days ago</td>
<td id="A1.T3.1.20.19.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Previous visit LOS</td>
</tr>
<tr id="A1.T3.1.21.20" class="ltx_tr">
<td id="A1.T3.1.21.20.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t">Mortality indicator severity score</td>
<td id="A1.T3.1.21.20.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t">Historic diagnosis codes</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Table containing the patient specific features available at initial medical assessment that were used in the OUH dataset.</figcaption>
</figure>
<figure id="A1.T4" class="ltx_table">
<table id="A1.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T4.1.1.1" class="ltx_tr">
<th id="A1.T4.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">Hours of sunlight</th>
<th id="A1.T4.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t">Hour admitted to ED</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T4.1.2.1" class="ltx_tr">
<td id="A1.T4.1.2.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Month admitted to ED</td>
<td id="A1.T4.1.2.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"># ED Attendees in last 12 hours</td>
</tr>
<tr id="A1.T4.1.3.2" class="ltx_tr">
<td id="A1.T4.1.3.2.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"># ED Attendees in last 4 hours</td>
<td id="A1.T4.1.3.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"># ED Attendees in last 8 hours</td>
</tr>
<tr id="A1.T4.1.4.3" class="ltx_tr">
<td id="A1.T4.1.4.3.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"># ED Attendees in last hour</td>
<td id="A1.T4.1.4.3.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"># Breaches last 12 hours</td>
</tr>
<tr id="A1.T4.1.5.4" class="ltx_tr">
<td id="A1.T4.1.5.4.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"># Breaches last 4 hours</td>
<td id="A1.T4.1.5.4.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"># Breaches last 8 hours</td>
</tr>
<tr id="A1.T4.1.6.5" class="ltx_tr">
<td id="A1.T4.1.6.5.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"># Breaches last hour</td>
<td id="A1.T4.1.6.5.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Has it rained today?</td>
</tr>
<tr id="A1.T4.1.7.6" class="ltx_tr">
<td id="A1.T4.1.7.6.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Min. day temp (degrees)</td>
<td id="A1.T4.1.7.6.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Max. day temp (degrees)</td>
</tr>
<tr id="A1.T4.1.8.7" class="ltx_tr">
<td id="A1.T4.1.8.7.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t">Weekday (one-hot)</td>
<td id="A1.T4.1.8.7.2" class="ltx_td ltx_border_b ltx_border_r ltx_border_t"></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Table containing the environmental/hospital features that were used in the OUH dataset.</figcaption>
</figure>
<figure id="A1.T5" class="ltx_table">
<table id="A1.T5.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T5.1.1.1" class="ltx_tr">
<th id="A1.T5.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">Heart rate</th>
<th id="A1.T5.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t">Mean arterial pressure</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T5.1.2.1" class="ltx_tr">
<td id="A1.T5.1.2.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Diastolic blood pressure</td>
<td id="A1.T5.1.2.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Systolic blood pressure</td>
</tr>
<tr id="A1.T5.1.3.2" class="ltx_tr">
<td id="A1.T5.1.3.2.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Blood oxygen saturation</td>
<td id="A1.T5.1.3.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Respiratory rate</td>
</tr>
<tr id="A1.T5.1.4.3" class="ltx_tr">
<td id="A1.T5.1.4.3.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Temperature</td>
<td id="A1.T5.1.4.3.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Glucose</td>
</tr>
<tr id="A1.T5.1.5.4" class="ltx_tr">
<td id="A1.T5.1.5.4.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Oxygen delivery rate</td>
<td id="A1.T5.1.5.4.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">pH</td>
</tr>
<tr id="A1.T5.1.6.5" class="ltx_tr">
<td id="A1.T5.1.6.5.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Height</td>
<td id="A1.T5.1.6.5.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Weight</td>
</tr>
<tr id="A1.T5.1.7.6" class="ltx_tr">
<td id="A1.T5.1.7.6.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Age</td>
<td id="A1.T5.1.7.6.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Admission diagnosis</td>
</tr>
<tr id="A1.T5.1.8.7" class="ltx_tr">
<td id="A1.T5.1.8.7.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Ethnicity</td>
<td id="A1.T5.1.8.7.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Gender</td>
</tr>
<tr id="A1.T5.1.9.8" class="ltx_tr">
<td id="A1.T5.1.9.8.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t">Glasgow coma score total</td>
<td id="A1.T5.1.9.8.2" class="ltx_td ltx_border_b ltx_border_r ltx_border_t"></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Table containing the features used for mortality prediction on the eICU dataset. Features are extracted from the first measurement of each patient upon admission to ICU.</figcaption>
</figure>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2107.01706" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2107.01707" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2107.01707">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2107.01707" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2107.01708" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Mar 19 12:31:57 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
