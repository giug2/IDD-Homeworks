<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation</title>
<!--Generated on Thu Sep  5 21:25:58 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Recommender Systems,  Sequential Recommendation" lang="en" name="keywords"/>
<base href="/html/2406.12580v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S1" title="In Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S2" title="In Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S2.SS1" title="In 2. Preliminaries ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Sequential Recommendation Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S2.SS2" title="In 2. Preliminaries ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Linear Recurrent Units</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S3" title="In Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S3.SS1" title="In 3. Methodology ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S3.SS2" title="In 3. Methodology ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Behavior-Dependent Linear Recurrent Units</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S3.SS3" title="In 3. Methodology ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Hardware-Aware Parallel Scan</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S4" title="In Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S4.SS1" title="In 4. Experiments ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S4.SS2" title="In 4. Experiments ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Overall Performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S4.SS3" title="In 4. Experiments ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Efficiency and Scalability Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S4.SS4" title="In 4. Experiments ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S4.SS5" title="In 4. Experiments ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Hyperparameter Sensitivity</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S5" title="In Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S6" title="In Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chengkai Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Texas A&amp;M University</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">College Station, TX</span><span class="ltx_text ltx_affiliation_country" id="id3.3.id3">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:liuchengkai@tamu.edu">liuchengkai@tamu.edu</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jianghao Lin
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.1.id1">Shanghai Jiao Tong University</span><span class="ltx_text ltx_affiliation_city" id="id5.2.id2">Shanghai</span><span class="ltx_text ltx_affiliation_country" id="id6.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:chiangel@sjtu.edu.cn">chiangel@sjtu.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hanzhou Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">Texas A&amp;M University</span><span class="ltx_text ltx_affiliation_city" id="id8.2.id2">College Station, TX</span><span class="ltx_text ltx_affiliation_country" id="id9.3.id3">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:hanzhou1996@tamu.edu">hanzhou1996@tamu.edu</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jianling Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id10.1.id1">Texas A&amp;M University</span><span class="ltx_text ltx_affiliation_city" id="id11.2.id2">College Station, TX</span><span class="ltx_text ltx_affiliation_country" id="id12.3.id3">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:jwang713@tamu.edu">jwang713@tamu.edu</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">James Caverlee
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id13.1.id1">Texas A&amp;M University</span><span class="ltx_text ltx_affiliation_city" id="id14.2.id2">College Station, TX</span><span class="ltx_text ltx_affiliation_country" id="id15.3.id3">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:caverlee@cse.tamu.edu">caverlee@cse.tamu.edu</a>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id16.id1">Sequential recommender systems aims to predict the users’ next interaction through user behavior modeling with various operators like RNNs and attentions.
However, existing models generally fail to achieve the three golden principles for sequential recommendation simultaneously, <em class="ltx_emph ltx_font_italic" id="id16.id1.1">i.e.</em>, training efficiency, low-cost inference, and strong performance.
To this end, we propose <span class="ltx_text ltx_font_bold" id="id16.id1.2">RecBLR</span>, an Efficient Sequential <span class="ltx_text ltx_framed ltx_framed_underline" id="id16.id1.3">Rec</span>ommendation Model based on <span class="ltx_text ltx_framed ltx_framed_underline" id="id16.id1.4">B</span>ehavior-Dependent <span class="ltx_text ltx_framed ltx_framed_underline" id="id16.id1.5">L</span>inear <span class="ltx_text ltx_framed ltx_framed_underline" id="id16.id1.6">R</span>ecurrent Units to accomplish the impossible triangle of the three principles. By incorporating gating mechanisms and behavior-dependent designs into linear recurrent units, our model significantly enhances user behavior modeling and recommendation performance.
Furthermore, we unlock the parallelizable training as well as inference efficiency for our model by designing a hardware-aware scanning acceleration algorithm with a customized CUDA kernel.
Extensive experiments on real-world datasets with varying lengths of user behavior sequences demonstrate RecBLR’s remarkable effectiveness in simultaneously achieving all three golden principles - strong recommendation performance, training efficiency, and low-cost inference, while exhibiting excellent scalability to datasets with long user interaction histories.</p>
</div>
<div class="ltx_keywords">Recommender Systems, Sequential Recommendation
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>rightsretained</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Proceedings of the 33rd ACM International Conference on Information and Knowledge Management; October 21–25, 2024; Boise, ID, USA</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>Proceedings of the 33rd ACM International Conference on Information and Knowledge Management (CIKM ’24), October 21–25, 2024, Boise, ID, USA</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3627673.3679717</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-0436-9/24/10</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommender systems</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Sequential recommender systems are crucial for personalized online services, capturing evolving user preferences through past interactions and predicting future actions by effectively modeling sequential dependencies within historical user behaviors <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">chen2018sequential</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">xie2022contrastive</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2024mamba4rec</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">lin2024rella</span>)</cite>.
The core of sequential recommendation is the user behavior modeling techniques, which have evolved significantly over time, advancing from traditional methods such as Markov chains <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">he2016fusing</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">rendle2010factorizing</span>)</cite> to sophisticated deep learning methods <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">hidasi2015session</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">yan2019cosrec</span>)</cite>.
As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, there is a triangle of golden principles for designing the user behavior modeling operators for sequential recommendation, <em class="ltx_emph ltx_font_italic" id="S1.p1.1.1">i.e.</em>, <span class="ltx_text ltx_font_italic" id="S1.p1.1.2">training efficiency</span>, <span class="ltx_text ltx_font_italic" id="S1.p1.1.3">low-cost inference</span>, and <span class="ltx_text ltx_font_italic" id="S1.p1.1.4">strong performance</span>.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="203" id="S1.F1.g1" src="x1.png" width="266"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>The triangle of three gold principles for the model design in sequential recommendation.</figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, earlier approaches like GRU4Rec <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">hidasi2015session</span>)</cite> and NARM <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">li2017neural</span>)</cite> are built based on recurrent neural networks (RNNs) <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">chung2014empirical</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">sherstinsky2020fundamentals</span>)</cite> or convolutional neural networks (CNNs) <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">o2015introduction</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">krizhevsky2012imagenet</span>)</cite>. Although they possess the low-cost inference property, they can easily suffer from inferior recommendation performance, as well as training inefficiency caused by their non-parallelism natures <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">sun2023retentive</span>)</cite>.
As an alternative, FMLP-Rec <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">zhou2022filter</span>)</cite> designs filtering-enhanced multi-layer perceptron (MLP) operators for user behavior modeling to achieve high efficiency in terms of both training and inference.
However its performance is still limited due to the catastrophic forgetting issues <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">schak2019study</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">kirkpatrick2017overcoming</span>)</cite>.
Meanwhile, as the Transformer <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">vaswani2017attention</span>)</cite> architecture is flourishing in natural language processing (NLP) domains, researchers start to investigate the potential of attention operators for sequential recommendation.
Classical models like SASRec <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">kang2018self</span>)</cite> and BERT4Rec <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">sun2019bert4rec</span>)</cite> enjoy both training parallelism and impressive performance at the cost of inefficient inference, because of the quadratic computational complexity and memory-bound key-value
cache <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">shazeer2019fast</span>)</cite>.
As the online platforms grow and user interaction sequences become longer, the limitation of attention mechanisms exacerbates, impeding scalability for sequential recommendation with long user behavior sequences.
As the latest research, LRURec <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">yue2024linear</span>)</cite> pioneers the application of linear recurrent unit (LRU) operators <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">martin2017parallelizing</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">orvieto2023resurrecting</span>)</cite> for sequential recommendation.
It achieves strong performance and low-cost inference, but turns out training inefficient due to the introduction of non-linearity and sequence padding.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Based on the discussions above, we can observe that the existing sequential recommendation models seemingly suffer from the “impossible triangle” of the three golden principles as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>.
That is, none of they could achieve superior performance and meanwhile enjoy high efficiency in terms of both training and inference.
Therefore, in this paper, we aim to propose and address such an open research question: <span class="ltx_text ltx_font_bold" id="S1.p3.1.1">can we establish a model with delicately designed user behavior modeling operators that could achieve all the three golden principles for sequential recommendation?</span></p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">We choose the linear recurrent unit (LRU) <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">martin2017parallelizing</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">orvieto2023resurrecting</span>)</cite> as the basic operator, and start by investigating its potential drawbacks in the case of sequential recommendation scenarios when considering the triangle of three golden principles.
<span class="ltx_text ltx_font_italic" id="S1.p4.1.1">Firstly</span>, the LRU operator is independent to the input user behaviors, <em class="ltx_emph ltx_font_italic" id="S1.p4.1.2">i.e.</em>, every single user behavior is transformed through the same network, thereby contributing equally to the user preference representation.
However, the diverse behaviors in the user sequence should make different contributions due to the multifaceted nature of user interests.
Hence, it is essential to build a behavior-dependent operator to improve the performance of user behavior modeling.
<span class="ltx_text ltx_font_italic" id="S1.p4.1.3">Secondly</span>, previous work, <em class="ltx_emph ltx_font_italic" id="S1.p4.1.4">i.e.</em>, LRURec <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">yue2024linear</span>)</cite>, simply follows the classical design of LRU by leveraging the eigenvalue decomposition in the complex domain.
Nevertheless, as demonstrated in <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">gu2023mamba</span>)</cite>, complex elements are beneficial for continuous modalities like video and audio, but not for discrete sequence modeling like user behaviors.
Moreover, complex-domain LRUs introduce a larger number of parameters compared to real-valued counterparts, potentially leading to overfitting and degenerated performance.
<span class="ltx_text ltx_font_italic" id="S1.p4.1.5">Lastly</span>, while the above two points both aim at the “strong performance” principle, they can largely hurt the training and inference efficiency due to the complicated design of behavior modeling operators (<em class="ltx_emph ltx_font_italic" id="S1.p4.1.6">i.e.</em>, behavior-dependent and non-complex).
Therefore, it is crucial to move beyond the simple model design, and consider hardware-aware parallelism acceleration algorithm for the rest two principles of “training efficiency” and “low-cost inference” simultaneously.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">To this end, in this work, we propose <span class="ltx_text ltx_font_bold" id="S1.p5.1.1">RecBLR</span>, an Efficient Sequential <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p5.1.2">Rec</span>ommendation Model with <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p5.1.3">B</span>ehavior-Dependent <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p5.1.4">L</span>inear <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p5.1.5">R</span>ecurrent Units.
RecBLR first achieves the “strong performance” principle by discarding complex numbers and designing a novel Behavior-Dependent Linear Recurrent Unit (BD-LRU).
BD-LRU, as the core of our user behavior modeling operators, introduces the gating mechanisms to capture the multifaceted characteristics of different user behaviors, thereby cast a multi-interest modeling over the whole user sequence.
Then, to compensate for the potential training overhead introduced by our BD-LRUs, we design a hardware-aware scanning acceleration algorithm for efficient parallelizable training. Specifically, we introduces a parallel scanning mechanism together with a customized CUDA kernel to significantly enhance the model’s computational efficiency.
Putting it all together, RecBLR is therefore specifically tailored for efficient sequential recommendation with superior performance, succeeding in achieving the triangle of three golden principles simultaneously, <em class="ltx_emph ltx_font_italic" id="S1.p5.1.6">i.e.</em>, training efficiency, low-cost inference, and strong performance.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">The key contributions of this paper are as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose a novel Efficient Sequential <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.I1.i1.p1.1.1">Rec</span>ommendation Model with <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.I1.i1.p1.1.2">B</span>ehavior-Dependent <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.I1.i1.p1.1.3">L</span>inear <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.I1.i1.p1.1.4">R</span>ecurrent Units (<span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.5">RecBLR</span>), which achieves the three golden principles simultaneously, <em class="ltx_emph ltx_font_italic" id="S1.I1.i1.p1.1.6">i.e.</em>, training efficiency, low-cost inference, and strong performance.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">For <span class="ltx_text ltx_font_italic" id="S1.I1.i2.p1.1.1">strong performance</span>, we discard complex numbers and design the Behavior-Dependent Linear Recurrent Unit (BD-LRU) operator, which capture the difference among diverse behaviors and thereby leads to improved multi-interest user behavior modeling.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">For <span class="ltx_text ltx_font_italic" id="S1.I1.i3.p1.1.1">training efficiency</span> and <span class="ltx_text ltx_font_italic" id="S1.I1.i3.p1.1.2">low-cost inference</span>, we further design a hardware-aware scanning acceleration algorithm with a customized CUDA kernel to enable efficiency computation.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">We conduct extensive experiments on datasets with various sequence lengths, demonstrating the effectiveness, efficiency, and scalability of our model, particularly on datasets with long user interaction sequences.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Preliminaries</h2>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="279" id="S2.F2.g1" src="x2.png" width="623"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>The overall architecture of RecBLR.</figcaption>
</figure>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.8">For sequential recommendation, we represent the user set as <math alttext="\mathcal{U}=\left\{u_{i}\right\}_{i=1}^{|\mathcal{U}|}" class="ltx_Math" display="inline" id="S2.p1.1.m1.2"><semantics id="S2.p1.1.m1.2a"><mrow id="S2.p1.1.m1.2.2" xref="S2.p1.1.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.1.m1.2.2.3" xref="S2.p1.1.m1.2.2.3.cmml">𝒰</mi><mo id="S2.p1.1.m1.2.2.2" xref="S2.p1.1.m1.2.2.2.cmml">=</mo><msubsup id="S2.p1.1.m1.2.2.1" xref="S2.p1.1.m1.2.2.1.cmml"><mrow id="S2.p1.1.m1.2.2.1.1.1.1" xref="S2.p1.1.m1.2.2.1.1.1.2.cmml"><mo id="S2.p1.1.m1.2.2.1.1.1.1.2" xref="S2.p1.1.m1.2.2.1.1.1.2.cmml">{</mo><msub id="S2.p1.1.m1.2.2.1.1.1.1.1" xref="S2.p1.1.m1.2.2.1.1.1.1.1.cmml"><mi id="S2.p1.1.m1.2.2.1.1.1.1.1.2" xref="S2.p1.1.m1.2.2.1.1.1.1.1.2.cmml">u</mi><mi id="S2.p1.1.m1.2.2.1.1.1.1.1.3" xref="S2.p1.1.m1.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p1.1.m1.2.2.1.1.1.1.3" xref="S2.p1.1.m1.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.p1.1.m1.2.2.1.1.3" xref="S2.p1.1.m1.2.2.1.1.3.cmml"><mi id="S2.p1.1.m1.2.2.1.1.3.2" xref="S2.p1.1.m1.2.2.1.1.3.2.cmml">i</mi><mo id="S2.p1.1.m1.2.2.1.1.3.1" xref="S2.p1.1.m1.2.2.1.1.3.1.cmml">=</mo><mn id="S2.p1.1.m1.2.2.1.1.3.3" xref="S2.p1.1.m1.2.2.1.1.3.3.cmml">1</mn></mrow><mrow id="S2.p1.1.m1.1.1.1.3" xref="S2.p1.1.m1.1.1.1.2.cmml"><mo id="S2.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S2.p1.1.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.1.m1.1.1.1.1" xref="S2.p1.1.m1.1.1.1.1.cmml">𝒰</mi><mo id="S2.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S2.p1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.2b"><apply id="S2.p1.1.m1.2.2.cmml" xref="S2.p1.1.m1.2.2"><eq id="S2.p1.1.m1.2.2.2.cmml" xref="S2.p1.1.m1.2.2.2"></eq><ci id="S2.p1.1.m1.2.2.3.cmml" xref="S2.p1.1.m1.2.2.3">𝒰</ci><apply id="S2.p1.1.m1.2.2.1.cmml" xref="S2.p1.1.m1.2.2.1"><csymbol cd="ambiguous" id="S2.p1.1.m1.2.2.1.2.cmml" xref="S2.p1.1.m1.2.2.1">superscript</csymbol><apply id="S2.p1.1.m1.2.2.1.1.cmml" xref="S2.p1.1.m1.2.2.1"><csymbol cd="ambiguous" id="S2.p1.1.m1.2.2.1.1.2.cmml" xref="S2.p1.1.m1.2.2.1">subscript</csymbol><set id="S2.p1.1.m1.2.2.1.1.1.2.cmml" xref="S2.p1.1.m1.2.2.1.1.1.1"><apply id="S2.p1.1.m1.2.2.1.1.1.1.1.cmml" xref="S2.p1.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.p1.1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.p1.1.m1.2.2.1.1.1.1.1.2">𝑢</ci><ci id="S2.p1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.p1.1.m1.2.2.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S2.p1.1.m1.2.2.1.1.3.cmml" xref="S2.p1.1.m1.2.2.1.1.3"><eq id="S2.p1.1.m1.2.2.1.1.3.1.cmml" xref="S2.p1.1.m1.2.2.1.1.3.1"></eq><ci id="S2.p1.1.m1.2.2.1.1.3.2.cmml" xref="S2.p1.1.m1.2.2.1.1.3.2">𝑖</ci><cn id="S2.p1.1.m1.2.2.1.1.3.3.cmml" type="integer" xref="S2.p1.1.m1.2.2.1.1.3.3">1</cn></apply></apply><apply id="S2.p1.1.m1.1.1.1.2.cmml" xref="S2.p1.1.m1.1.1.1.3"><abs id="S2.p1.1.m1.1.1.1.2.1.cmml" xref="S2.p1.1.m1.1.1.1.3.1"></abs><ci id="S2.p1.1.m1.1.1.1.1.cmml" xref="S2.p1.1.m1.1.1.1.1">𝒰</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.2c">\mathcal{U}=\left\{u_{i}\right\}_{i=1}^{|\mathcal{U}|}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.2d">caligraphic_U = { italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_U | end_POSTSUPERSCRIPT</annotation></semantics></math>, the item set as <math alttext="\mathcal{V}=\left\{v_{i}\right\}_{i=1}^{|\mathcal{V}|}" class="ltx_Math" display="inline" id="S2.p1.2.m2.2"><semantics id="S2.p1.2.m2.2a"><mrow id="S2.p1.2.m2.2.2" xref="S2.p1.2.m2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.2.m2.2.2.3" xref="S2.p1.2.m2.2.2.3.cmml">𝒱</mi><mo id="S2.p1.2.m2.2.2.2" xref="S2.p1.2.m2.2.2.2.cmml">=</mo><msubsup id="S2.p1.2.m2.2.2.1" xref="S2.p1.2.m2.2.2.1.cmml"><mrow id="S2.p1.2.m2.2.2.1.1.1.1" xref="S2.p1.2.m2.2.2.1.1.1.2.cmml"><mo id="S2.p1.2.m2.2.2.1.1.1.1.2" xref="S2.p1.2.m2.2.2.1.1.1.2.cmml">{</mo><msub id="S2.p1.2.m2.2.2.1.1.1.1.1" xref="S2.p1.2.m2.2.2.1.1.1.1.1.cmml"><mi id="S2.p1.2.m2.2.2.1.1.1.1.1.2" xref="S2.p1.2.m2.2.2.1.1.1.1.1.2.cmml">v</mi><mi id="S2.p1.2.m2.2.2.1.1.1.1.1.3" xref="S2.p1.2.m2.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p1.2.m2.2.2.1.1.1.1.3" xref="S2.p1.2.m2.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.p1.2.m2.2.2.1.1.3" xref="S2.p1.2.m2.2.2.1.1.3.cmml"><mi id="S2.p1.2.m2.2.2.1.1.3.2" xref="S2.p1.2.m2.2.2.1.1.3.2.cmml">i</mi><mo id="S2.p1.2.m2.2.2.1.1.3.1" xref="S2.p1.2.m2.2.2.1.1.3.1.cmml">=</mo><mn id="S2.p1.2.m2.2.2.1.1.3.3" xref="S2.p1.2.m2.2.2.1.1.3.3.cmml">1</mn></mrow><mrow id="S2.p1.2.m2.1.1.1.3" xref="S2.p1.2.m2.1.1.1.2.cmml"><mo id="S2.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S2.p1.2.m2.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.2.m2.1.1.1.1" xref="S2.p1.2.m2.1.1.1.1.cmml">𝒱</mi><mo id="S2.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S2.p1.2.m2.1.1.1.2.1.cmml">|</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.2b"><apply id="S2.p1.2.m2.2.2.cmml" xref="S2.p1.2.m2.2.2"><eq id="S2.p1.2.m2.2.2.2.cmml" xref="S2.p1.2.m2.2.2.2"></eq><ci id="S2.p1.2.m2.2.2.3.cmml" xref="S2.p1.2.m2.2.2.3">𝒱</ci><apply id="S2.p1.2.m2.2.2.1.cmml" xref="S2.p1.2.m2.2.2.1"><csymbol cd="ambiguous" id="S2.p1.2.m2.2.2.1.2.cmml" xref="S2.p1.2.m2.2.2.1">superscript</csymbol><apply id="S2.p1.2.m2.2.2.1.1.cmml" xref="S2.p1.2.m2.2.2.1"><csymbol cd="ambiguous" id="S2.p1.2.m2.2.2.1.1.2.cmml" xref="S2.p1.2.m2.2.2.1">subscript</csymbol><set id="S2.p1.2.m2.2.2.1.1.1.2.cmml" xref="S2.p1.2.m2.2.2.1.1.1.1"><apply id="S2.p1.2.m2.2.2.1.1.1.1.1.cmml" xref="S2.p1.2.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.2.m2.2.2.1.1.1.1.1.1.cmml" xref="S2.p1.2.m2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.2.m2.2.2.1.1.1.1.1.2.cmml" xref="S2.p1.2.m2.2.2.1.1.1.1.1.2">𝑣</ci><ci id="S2.p1.2.m2.2.2.1.1.1.1.1.3.cmml" xref="S2.p1.2.m2.2.2.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S2.p1.2.m2.2.2.1.1.3.cmml" xref="S2.p1.2.m2.2.2.1.1.3"><eq id="S2.p1.2.m2.2.2.1.1.3.1.cmml" xref="S2.p1.2.m2.2.2.1.1.3.1"></eq><ci id="S2.p1.2.m2.2.2.1.1.3.2.cmml" xref="S2.p1.2.m2.2.2.1.1.3.2">𝑖</ci><cn id="S2.p1.2.m2.2.2.1.1.3.3.cmml" type="integer" xref="S2.p1.2.m2.2.2.1.1.3.3">1</cn></apply></apply><apply id="S2.p1.2.m2.1.1.1.2.cmml" xref="S2.p1.2.m2.1.1.1.3"><abs id="S2.p1.2.m2.1.1.1.2.1.cmml" xref="S2.p1.2.m2.1.1.1.3.1"></abs><ci id="S2.p1.2.m2.1.1.1.1.cmml" xref="S2.p1.2.m2.1.1.1.1">𝒱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.2c">\mathcal{V}=\left\{v_{i}\right\}_{i=1}^{|\mathcal{V}|}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.2d">caligraphic_V = { italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_V | end_POSTSUPERSCRIPT</annotation></semantics></math>, and the interaction sequence of a user <math alttext="u\in\mathcal{U}" class="ltx_Math" display="inline" id="S2.p1.3.m3.1"><semantics id="S2.p1.3.m3.1a"><mrow id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml"><mi id="S2.p1.3.m3.1.1.2" xref="S2.p1.3.m3.1.1.2.cmml">u</mi><mo id="S2.p1.3.m3.1.1.1" xref="S2.p1.3.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.3.m3.1.1.3" xref="S2.p1.3.m3.1.1.3.cmml">𝒰</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><apply id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1"><in id="S2.p1.3.m3.1.1.1.cmml" xref="S2.p1.3.m3.1.1.1"></in><ci id="S2.p1.3.m3.1.1.2.cmml" xref="S2.p1.3.m3.1.1.2">𝑢</ci><ci id="S2.p1.3.m3.1.1.3.cmml" xref="S2.p1.3.m3.1.1.3">𝒰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">u\in\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.1d">italic_u ∈ caligraphic_U</annotation></semantics></math> as <math alttext="\mathcal{S}_{u}=\left\{v_{t}\right\}_{t=1}^{T}" class="ltx_Math" display="inline" id="S2.p1.4.m4.1"><semantics id="S2.p1.4.m4.1a"><mrow id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml"><msub id="S2.p1.4.m4.1.1.3" xref="S2.p1.4.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.4.m4.1.1.3.2" xref="S2.p1.4.m4.1.1.3.2.cmml">𝒮</mi><mi id="S2.p1.4.m4.1.1.3.3" xref="S2.p1.4.m4.1.1.3.3.cmml">u</mi></msub><mo id="S2.p1.4.m4.1.1.2" xref="S2.p1.4.m4.1.1.2.cmml">=</mo><msubsup id="S2.p1.4.m4.1.1.1" xref="S2.p1.4.m4.1.1.1.cmml"><mrow id="S2.p1.4.m4.1.1.1.1.1.1" xref="S2.p1.4.m4.1.1.1.1.1.2.cmml"><mo id="S2.p1.4.m4.1.1.1.1.1.1.2" xref="S2.p1.4.m4.1.1.1.1.1.2.cmml">{</mo><msub id="S2.p1.4.m4.1.1.1.1.1.1.1" xref="S2.p1.4.m4.1.1.1.1.1.1.1.cmml"><mi id="S2.p1.4.m4.1.1.1.1.1.1.1.2" xref="S2.p1.4.m4.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S2.p1.4.m4.1.1.1.1.1.1.1.3" xref="S2.p1.4.m4.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.p1.4.m4.1.1.1.1.1.1.3" xref="S2.p1.4.m4.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.p1.4.m4.1.1.1.1.3" xref="S2.p1.4.m4.1.1.1.1.3.cmml"><mi id="S2.p1.4.m4.1.1.1.1.3.2" xref="S2.p1.4.m4.1.1.1.1.3.2.cmml">t</mi><mo id="S2.p1.4.m4.1.1.1.1.3.1" xref="S2.p1.4.m4.1.1.1.1.3.1.cmml">=</mo><mn id="S2.p1.4.m4.1.1.1.1.3.3" xref="S2.p1.4.m4.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.p1.4.m4.1.1.1.3" xref="S2.p1.4.m4.1.1.1.3.cmml">T</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><apply id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1"><eq id="S2.p1.4.m4.1.1.2.cmml" xref="S2.p1.4.m4.1.1.2"></eq><apply id="S2.p1.4.m4.1.1.3.cmml" xref="S2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.3.1.cmml" xref="S2.p1.4.m4.1.1.3">subscript</csymbol><ci id="S2.p1.4.m4.1.1.3.2.cmml" xref="S2.p1.4.m4.1.1.3.2">𝒮</ci><ci id="S2.p1.4.m4.1.1.3.3.cmml" xref="S2.p1.4.m4.1.1.3.3">𝑢</ci></apply><apply id="S2.p1.4.m4.1.1.1.cmml" xref="S2.p1.4.m4.1.1.1"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.1.2.cmml" xref="S2.p1.4.m4.1.1.1">superscript</csymbol><apply id="S2.p1.4.m4.1.1.1.1.cmml" xref="S2.p1.4.m4.1.1.1"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.1.1.2.cmml" xref="S2.p1.4.m4.1.1.1">subscript</csymbol><set id="S2.p1.4.m4.1.1.1.1.1.2.cmml" xref="S2.p1.4.m4.1.1.1.1.1.1"><apply id="S2.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S2.p1.4.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.1.1.1.1.1.1.cmml" xref="S2.p1.4.m4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S2.p1.4.m4.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S2.p1.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S2.p1.4.m4.1.1.1.1.1.1.1.3">𝑡</ci></apply></set><apply id="S2.p1.4.m4.1.1.1.1.3.cmml" xref="S2.p1.4.m4.1.1.1.1.3"><eq id="S2.p1.4.m4.1.1.1.1.3.1.cmml" xref="S2.p1.4.m4.1.1.1.1.3.1"></eq><ci id="S2.p1.4.m4.1.1.1.1.3.2.cmml" xref="S2.p1.4.m4.1.1.1.1.3.2">𝑡</ci><cn id="S2.p1.4.m4.1.1.1.1.3.3.cmml" type="integer" xref="S2.p1.4.m4.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.p1.4.m4.1.1.1.3.cmml" xref="S2.p1.4.m4.1.1.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">\mathcal{S}_{u}=\left\{v_{t}\right\}_{t=1}^{T}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m4.1d">caligraphic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = { italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>. This interaction sequence is chronologically ordered, and its length is denoted by <math alttext="T" class="ltx_Math" display="inline" id="S2.p1.5.m5.1"><semantics id="S2.p1.5.m5.1a"><mi id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><ci id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">T</annotation><annotation encoding="application/x-llamapun" id="S2.p1.5.m5.1d">italic_T</annotation></semantics></math>. Given a user’s history <math alttext="\mathcal{S}_{u}" class="ltx_Math" display="inline" id="S2.p1.6.m6.1"><semantics id="S2.p1.6.m6.1a"><msub id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.6.m6.1.1.2" xref="S2.p1.6.m6.1.1.2.cmml">𝒮</mi><mi id="S2.p1.6.m6.1.1.3" xref="S2.p1.6.m6.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><apply id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.1.1.cmml" xref="S2.p1.6.m6.1.1">subscript</csymbol><ci id="S2.p1.6.m6.1.1.2.cmml" xref="S2.p1.6.m6.1.1.2">𝒮</ci><ci id="S2.p1.6.m6.1.1.3.cmml" xref="S2.p1.6.m6.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">\mathcal{S}_{u}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.6.m6.1d">caligraphic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, the task of sequential recommendation is to predict the next item <math alttext="v_{T+1}" class="ltx_Math" display="inline" id="S2.p1.7.m7.1"><semantics id="S2.p1.7.m7.1a"><msub id="S2.p1.7.m7.1.1" xref="S2.p1.7.m7.1.1.cmml"><mi id="S2.p1.7.m7.1.1.2" xref="S2.p1.7.m7.1.1.2.cmml">v</mi><mrow id="S2.p1.7.m7.1.1.3" xref="S2.p1.7.m7.1.1.3.cmml"><mi id="S2.p1.7.m7.1.1.3.2" xref="S2.p1.7.m7.1.1.3.2.cmml">T</mi><mo id="S2.p1.7.m7.1.1.3.1" xref="S2.p1.7.m7.1.1.3.1.cmml">+</mo><mn id="S2.p1.7.m7.1.1.3.3" xref="S2.p1.7.m7.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p1.7.m7.1b"><apply id="S2.p1.7.m7.1.1.cmml" xref="S2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.p1.7.m7.1.1.1.cmml" xref="S2.p1.7.m7.1.1">subscript</csymbol><ci id="S2.p1.7.m7.1.1.2.cmml" xref="S2.p1.7.m7.1.1.2">𝑣</ci><apply id="S2.p1.7.m7.1.1.3.cmml" xref="S2.p1.7.m7.1.1.3"><plus id="S2.p1.7.m7.1.1.3.1.cmml" xref="S2.p1.7.m7.1.1.3.1"></plus><ci id="S2.p1.7.m7.1.1.3.2.cmml" xref="S2.p1.7.m7.1.1.3.2">𝑇</ci><cn id="S2.p1.7.m7.1.1.3.3.cmml" type="integer" xref="S2.p1.7.m7.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m7.1c">v_{T+1}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.7.m7.1d">italic_v start_POSTSUBSCRIPT italic_T + 1 end_POSTSUBSCRIPT</annotation></semantics></math> that user <math alttext="u" class="ltx_Math" display="inline" id="S2.p1.8.m8.1"><semantics id="S2.p1.8.m8.1a"><mi id="S2.p1.8.m8.1.1" xref="S2.p1.8.m8.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.p1.8.m8.1b"><ci id="S2.p1.8.m8.1.1.cmml" xref="S2.p1.8.m8.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m8.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.p1.8.m8.1d">italic_u</annotation></semantics></math> is likely to interact with.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Sequential Recommendation Models</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Mainstream neural sequential recommendation models are typically comprised of three key components: the embedding layer, behavior modeling layer, and prediction layer.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.6"><span class="ltx_text ltx_font_bold" id="S2.SS1.p2.6.1">Embedding Layer.</span>
Similar to existing sequential recommendation models, our model employs a standard embedding layer to map item IDs into a high-dimensional vector space. The embedding layer utilizes a learnable embedding matrix <math alttext="\bm{E}\in\mathbb{R}^{|\mathcal{V}|\times D}" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mrow id="S2.SS1.p2.1.m1.1.2" xref="S2.SS1.p2.1.m1.1.2.cmml"><mi id="S2.SS1.p2.1.m1.1.2.2" xref="S2.SS1.p2.1.m1.1.2.2.cmml">𝑬</mi><mo id="S2.SS1.p2.1.m1.1.2.1" xref="S2.SS1.p2.1.m1.1.2.1.cmml">∈</mo><msup id="S2.SS1.p2.1.m1.1.2.3" xref="S2.SS1.p2.1.m1.1.2.3.cmml"><mi id="S2.SS1.p2.1.m1.1.2.3.2" xref="S2.SS1.p2.1.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p2.1.m1.1.1.1" xref="S2.SS1.p2.1.m1.1.1.1.cmml"><mrow id="S2.SS1.p2.1.m1.1.1.1.3.2" xref="S2.SS1.p2.1.m1.1.1.1.3.1.cmml"><mo id="S2.SS1.p2.1.m1.1.1.1.3.2.1" stretchy="false" xref="S2.SS1.p2.1.m1.1.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.1.m1.1.1.1.1" xref="S2.SS1.p2.1.m1.1.1.1.1.cmml">𝒱</mi><mo id="S2.SS1.p2.1.m1.1.1.1.3.2.2" rspace="0.055em" stretchy="false" xref="S2.SS1.p2.1.m1.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S2.SS1.p2.1.m1.1.1.1.2" rspace="0.222em" xref="S2.SS1.p2.1.m1.1.1.1.2.cmml">×</mo><mi id="S2.SS1.p2.1.m1.1.1.1.4" xref="S2.SS1.p2.1.m1.1.1.1.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.2"><in id="S2.SS1.p2.1.m1.1.2.1.cmml" xref="S2.SS1.p2.1.m1.1.2.1"></in><ci id="S2.SS1.p2.1.m1.1.2.2.cmml" xref="S2.SS1.p2.1.m1.1.2.2">𝑬</ci><apply id="S2.SS1.p2.1.m1.1.2.3.cmml" xref="S2.SS1.p2.1.m1.1.2.3"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.2.3.1.cmml" xref="S2.SS1.p2.1.m1.1.2.3">superscript</csymbol><ci id="S2.SS1.p2.1.m1.1.2.3.2.cmml" xref="S2.SS1.p2.1.m1.1.2.3.2">ℝ</ci><apply id="S2.SS1.p2.1.m1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1.1"><times id="S2.SS1.p2.1.m1.1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.1.2"></times><apply id="S2.SS1.p2.1.m1.1.1.1.3.1.cmml" xref="S2.SS1.p2.1.m1.1.1.1.3.2"><abs id="S2.SS1.p2.1.m1.1.1.1.3.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1.1.3.2.1"></abs><ci id="S2.SS1.p2.1.m1.1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1.1.1">𝒱</ci></apply><ci id="S2.SS1.p2.1.m1.1.1.1.4.cmml" xref="S2.SS1.p2.1.m1.1.1.1.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">\bm{E}\in\mathbb{R}^{|\mathcal{V}|\times D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">bold_italic_E ∈ blackboard_R start_POSTSUPERSCRIPT | caligraphic_V | × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.1"><semantics id="S2.SS1.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><ci id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.1d">caligraphic_V</annotation></semantics></math> denotes the item set and <math alttext="D" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m3.1"><semantics id="S2.SS1.p2.3.m3.1a"><mi id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><ci id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">D</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.1d">italic_D</annotation></semantics></math> represents the embedding dimension. By applying the embedding layer to the input item sequence <math alttext="\mathcal{S}_{u}" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m4.1"><semantics id="S2.SS1.p2.4.m4.1a"><msub id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.4.m4.1.1.2" xref="S2.SS1.p2.4.m4.1.1.2.cmml">𝒮</mi><mi id="S2.SS1.p2.4.m4.1.1.3" xref="S2.SS1.p2.4.m4.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><apply id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p2.4.m4.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.2">𝒮</ci><ci id="S2.SS1.p2.4.m4.1.1.3.cmml" xref="S2.SS1.p2.4.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">\mathcal{S}_{u}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m4.1d">caligraphic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> of length <math alttext="T" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m5.1"><semantics id="S2.SS1.p2.5.m5.1a"><mi id="S2.SS1.p2.5.m5.1.1" xref="S2.SS1.p2.5.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.1b"><ci id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.1c">T</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m5.1d">italic_T</annotation></semantics></math>, along with dropout <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">srivastava2014dropout</span>)</cite> and layer normalization <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">ba2016layer</span>)</cite>, we obtain the item embedding <math alttext="H\in\mathbb{R}^{T\times D}" class="ltx_Math" display="inline" id="S2.SS1.p2.6.m6.1"><semantics id="S2.SS1.p2.6.m6.1a"><mrow id="S2.SS1.p2.6.m6.1.1" xref="S2.SS1.p2.6.m6.1.1.cmml"><mi id="S2.SS1.p2.6.m6.1.1.2" xref="S2.SS1.p2.6.m6.1.1.2.cmml">H</mi><mo id="S2.SS1.p2.6.m6.1.1.1" xref="S2.SS1.p2.6.m6.1.1.1.cmml">∈</mo><msup id="S2.SS1.p2.6.m6.1.1.3" xref="S2.SS1.p2.6.m6.1.1.3.cmml"><mi id="S2.SS1.p2.6.m6.1.1.3.2" xref="S2.SS1.p2.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p2.6.m6.1.1.3.3" xref="S2.SS1.p2.6.m6.1.1.3.3.cmml"><mi id="S2.SS1.p2.6.m6.1.1.3.3.2" xref="S2.SS1.p2.6.m6.1.1.3.3.2.cmml">T</mi><mo id="S2.SS1.p2.6.m6.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p2.6.m6.1.1.3.3.1.cmml">×</mo><mi id="S2.SS1.p2.6.m6.1.1.3.3.3" xref="S2.SS1.p2.6.m6.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m6.1b"><apply id="S2.SS1.p2.6.m6.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1"><in id="S2.SS1.p2.6.m6.1.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1.1"></in><ci id="S2.SS1.p2.6.m6.1.1.2.cmml" xref="S2.SS1.p2.6.m6.1.1.2">𝐻</ci><apply id="S2.SS1.p2.6.m6.1.1.3.cmml" xref="S2.SS1.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m6.1.1.3.1.cmml" xref="S2.SS1.p2.6.m6.1.1.3">superscript</csymbol><ci id="S2.SS1.p2.6.m6.1.1.3.2.cmml" xref="S2.SS1.p2.6.m6.1.1.3.2">ℝ</ci><apply id="S2.SS1.p2.6.m6.1.1.3.3.cmml" xref="S2.SS1.p2.6.m6.1.1.3.3"><times id="S2.SS1.p2.6.m6.1.1.3.3.1.cmml" xref="S2.SS1.p2.6.m6.1.1.3.3.1"></times><ci id="S2.SS1.p2.6.m6.1.1.3.3.2.cmml" xref="S2.SS1.p2.6.m6.1.1.3.3.2">𝑇</ci><ci id="S2.SS1.p2.6.m6.1.1.3.3.3.cmml" xref="S2.SS1.p2.6.m6.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m6.1c">H\in\mathbb{R}^{T\times D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.6.m6.1d">italic_H ∈ blackboard_R start_POSTSUPERSCRIPT italic_T × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="H=\operatorname{LayerNorm}(\operatorname{Dropout}(\mathcal{S}_{u}\bm{E}))." class="ltx_Math" display="block" id="S2.E1.m1.3"><semantics id="S2.E1.m1.3a"><mrow id="S2.E1.m1.3.3.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml"><mi id="S2.E1.m1.3.3.1.1.3" xref="S2.E1.m1.3.3.1.1.3.cmml">H</mi><mo id="S2.E1.m1.3.3.1.1.2" xref="S2.E1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S2.E1.m1.3.3.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.2.cmml"><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">LayerNorm</mi><mo id="S2.E1.m1.3.3.1.1.1.1a" xref="S2.E1.m1.3.3.1.1.1.2.cmml">⁡</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.2.cmml"><mo id="S2.E1.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.3.3.1.1.1.2.cmml">(</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">Dropout</mi><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1a" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml"><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒮</mi><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">u</mi></msub><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">𝑬</mi></mrow><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.2" lspace="0em" xref="S2.E1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b"><apply id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1"><eq id="S2.E1.m1.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2"></eq><ci id="S2.E1.m1.3.3.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3">𝐻</ci><apply id="S2.E1.m1.3.3.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1"><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">LayerNorm</ci><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1"><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">Dropout</ci><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1"><times id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1"></times><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2">𝒮</ci><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3">𝑢</ci></apply><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3">𝑬</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.3c">H=\operatorname{LayerNorm}(\operatorname{Dropout}(\mathcal{S}_{u}\bm{E})).</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.3d">italic_H = roman_LayerNorm ( roman_Dropout ( caligraphic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT bold_italic_E ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p2.7">While Transformer-based sequential recommendation models <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">kang2018self</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">sun2019bert4rec</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">yuan2022multi</span>)</cite> often utilize positional embedding to capture chronological information, our recurrent architecture inherently captures position awareness. Therefore, we discard the need for additional positional embedding commonly used in the Transformer model <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">vaswani2017attention</span>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S2.SS1.p3.1.1">Behavior Modeling Layer.</span>
The primary distinction across various sequential recommendation models resides in the behavior modeling layer, using different operators such as attentions <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">kang2018self</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">sun2019bert4rec</span>)</cite>, convolutional neural networks (CNNs) <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">tang2018personalized</span>)</cite>, or recurrent neural networks (RNNs) <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">hidasi2015session</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">li2017neural</span>)</cite>. In the following methodology section, we illustrate our proposed behavior modeling layer in detail.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p4">
<p class="ltx_p" id="S2.SS1.p4.5"><span class="ltx_text ltx_font_bold" id="S2.SS1.p4.5.1">Prediction Layer.</span>
Most neural sequential recommenders share a common prediction layer design. We leverage this standard prediction layer (including neural baselines in this paper), which utilizes the last item embedding to generate the final prediction scores:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y}=\operatorname{Softmax}(h_{T}\bm{E}^{\top})\in\mathbb{R}^{|\mathcal{V}|}," class="ltx_Math" display="block" id="S2.E2.m1.3"><semantics id="S2.E2.m1.3a"><mrow id="S2.E2.m1.3.3.1" xref="S2.E2.m1.3.3.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.cmml"><mover accent="true" id="S2.E2.m1.3.3.1.1.3" xref="S2.E2.m1.3.3.1.1.3.cmml"><mi id="S2.E2.m1.3.3.1.1.3.2" xref="S2.E2.m1.3.3.1.1.3.2.cmml">y</mi><mo id="S2.E2.m1.3.3.1.1.3.1" xref="S2.E2.m1.3.3.1.1.3.1.cmml">^</mo></mover><mo id="S2.E2.m1.3.3.1.1.4" xref="S2.E2.m1.3.3.1.1.4.cmml">=</mo><mrow id="S2.E2.m1.3.3.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.2.cmml"><mi id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml">Softmax</mi><mo id="S2.E2.m1.3.3.1.1.1.1a" xref="S2.E2.m1.3.3.1.1.1.2.cmml">⁡</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.2.cmml"><mo id="S2.E2.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.3.3.1.1.1.2.cmml">(</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.3.3.1.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.2.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.2.2.cmml">h</mi><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.2.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.2.3.cmml">T</mi></msub><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="S2.E2.m1.3.3.1.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.3.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3.2.cmml">𝑬</mi><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.3.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3.3.cmml">⊤</mo></msup></mrow><mo id="S2.E2.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.3.3.1.1.5" xref="S2.E2.m1.3.3.1.1.5.cmml">∈</mo><msup id="S2.E2.m1.3.3.1.1.6" xref="S2.E2.m1.3.3.1.1.6.cmml"><mi id="S2.E2.m1.3.3.1.1.6.2" xref="S2.E2.m1.3.3.1.1.6.2.cmml">ℝ</mi><mrow id="S2.E2.m1.1.1.1.3" xref="S2.E2.m1.1.1.1.2.cmml"><mo id="S2.E2.m1.1.1.1.3.1" stretchy="false" xref="S2.E2.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">𝒱</mi><mo id="S2.E2.m1.1.1.1.3.2" stretchy="false" xref="S2.E2.m1.1.1.1.2.1.cmml">|</mo></mrow></msup></mrow><mo id="S2.E2.m1.3.3.1.2" xref="S2.E2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.3b"><apply id="S2.E2.m1.3.3.1.1.cmml" xref="S2.E2.m1.3.3.1"><and id="S2.E2.m1.3.3.1.1a.cmml" xref="S2.E2.m1.3.3.1"></and><apply id="S2.E2.m1.3.3.1.1b.cmml" xref="S2.E2.m1.3.3.1"><eq id="S2.E2.m1.3.3.1.1.4.cmml" xref="S2.E2.m1.3.3.1.1.4"></eq><apply id="S2.E2.m1.3.3.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.3"><ci id="S2.E2.m1.3.3.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.3.1">^</ci><ci id="S2.E2.m1.3.3.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.3.2">𝑦</ci></apply><apply id="S2.E2.m1.3.3.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1"><ci id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2">Softmax</ci><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1"><times id="S2.E2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1"></times><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.2.2">ℎ</ci><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3.2">𝑬</ci><csymbol cd="latexml" id="S2.E2.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3.3">top</csymbol></apply></apply></apply></apply><apply id="S2.E2.m1.3.3.1.1c.cmml" xref="S2.E2.m1.3.3.1"><in id="S2.E2.m1.3.3.1.1.5.cmml" xref="S2.E2.m1.3.3.1.1.5"></in><share href="https://arxiv.org/html/2406.12580v2#S2.E2.m1.3.3.1.1.1.cmml" id="S2.E2.m1.3.3.1.1d.cmml" xref="S2.E2.m1.3.3.1"></share><apply id="S2.E2.m1.3.3.1.1.6.cmml" xref="S2.E2.m1.3.3.1.1.6"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.6.1.cmml" xref="S2.E2.m1.3.3.1.1.6">superscript</csymbol><ci id="S2.E2.m1.3.3.1.1.6.2.cmml" xref="S2.E2.m1.3.3.1.1.6.2">ℝ</ci><apply id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.3"><abs id="S2.E2.m1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.3.1"></abs><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">𝒱</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.3c">\hat{y}=\operatorname{Softmax}(h_{T}\bm{E}^{\top})\in\mathbb{R}^{|\mathcal{V}|},</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.3d">over^ start_ARG italic_y end_ARG = roman_Softmax ( italic_h start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT bold_italic_E start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT | caligraphic_V | end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p4.4">where <math alttext="\bm{E}" class="ltx_Math" display="inline" id="S2.SS1.p4.1.m1.1"><semantics id="S2.SS1.p4.1.m1.1a"><mi id="S2.SS1.p4.1.m1.1.1" xref="S2.SS1.p4.1.m1.1.1.cmml">𝑬</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.1b"><ci id="S2.SS1.p4.1.m1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1">𝑬</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.1c">\bm{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.1.m1.1d">bold_italic_E</annotation></semantics></math> is the embedding matrix and <math alttext="h\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S2.SS1.p4.2.m2.1"><semantics id="S2.SS1.p4.2.m2.1a"><mrow id="S2.SS1.p4.2.m2.1.1" xref="S2.SS1.p4.2.m2.1.1.cmml"><mi id="S2.SS1.p4.2.m2.1.1.2" xref="S2.SS1.p4.2.m2.1.1.2.cmml">h</mi><mo id="S2.SS1.p4.2.m2.1.1.1" xref="S2.SS1.p4.2.m2.1.1.1.cmml">∈</mo><msup id="S2.SS1.p4.2.m2.1.1.3" xref="S2.SS1.p4.2.m2.1.1.3.cmml"><mi id="S2.SS1.p4.2.m2.1.1.3.2" xref="S2.SS1.p4.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS1.p4.2.m2.1.1.3.3" xref="S2.SS1.p4.2.m2.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.2.m2.1b"><apply id="S2.SS1.p4.2.m2.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1"><in id="S2.SS1.p4.2.m2.1.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1.1"></in><ci id="S2.SS1.p4.2.m2.1.1.2.cmml" xref="S2.SS1.p4.2.m2.1.1.2">ℎ</ci><apply id="S2.SS1.p4.2.m2.1.1.3.cmml" xref="S2.SS1.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p4.2.m2.1.1.3.1.cmml" xref="S2.SS1.p4.2.m2.1.1.3">superscript</csymbol><ci id="S2.SS1.p4.2.m2.1.1.3.2.cmml" xref="S2.SS1.p4.2.m2.1.1.3.2">ℝ</ci><ci id="S2.SS1.p4.2.m2.1.1.3.3.cmml" xref="S2.SS1.p4.2.m2.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.2.m2.1c">h\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.2.m2.1d">italic_h ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> is the last item embedding obtained from the final output of the behavior modeling layers. <math alttext="\hat{y}\in\mathbb{R}^{|\mathcal{V}|}" class="ltx_Math" display="inline" id="S2.SS1.p4.3.m3.1"><semantics id="S2.SS1.p4.3.m3.1a"><mrow id="S2.SS1.p4.3.m3.1.2" xref="S2.SS1.p4.3.m3.1.2.cmml"><mover accent="true" id="S2.SS1.p4.3.m3.1.2.2" xref="S2.SS1.p4.3.m3.1.2.2.cmml"><mi id="S2.SS1.p4.3.m3.1.2.2.2" xref="S2.SS1.p4.3.m3.1.2.2.2.cmml">y</mi><mo id="S2.SS1.p4.3.m3.1.2.2.1" xref="S2.SS1.p4.3.m3.1.2.2.1.cmml">^</mo></mover><mo id="S2.SS1.p4.3.m3.1.2.1" xref="S2.SS1.p4.3.m3.1.2.1.cmml">∈</mo><msup id="S2.SS1.p4.3.m3.1.2.3" xref="S2.SS1.p4.3.m3.1.2.3.cmml"><mi id="S2.SS1.p4.3.m3.1.2.3.2" xref="S2.SS1.p4.3.m3.1.2.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p4.3.m3.1.1.1.3" xref="S2.SS1.p4.3.m3.1.1.1.2.cmml"><mo id="S2.SS1.p4.3.m3.1.1.1.3.1" stretchy="false" xref="S2.SS1.p4.3.m3.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p4.3.m3.1.1.1.1" xref="S2.SS1.p4.3.m3.1.1.1.1.cmml">𝒱</mi><mo id="S2.SS1.p4.3.m3.1.1.1.3.2" stretchy="false" xref="S2.SS1.p4.3.m3.1.1.1.2.1.cmml">|</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.3.m3.1b"><apply id="S2.SS1.p4.3.m3.1.2.cmml" xref="S2.SS1.p4.3.m3.1.2"><in id="S2.SS1.p4.3.m3.1.2.1.cmml" xref="S2.SS1.p4.3.m3.1.2.1"></in><apply id="S2.SS1.p4.3.m3.1.2.2.cmml" xref="S2.SS1.p4.3.m3.1.2.2"><ci id="S2.SS1.p4.3.m3.1.2.2.1.cmml" xref="S2.SS1.p4.3.m3.1.2.2.1">^</ci><ci id="S2.SS1.p4.3.m3.1.2.2.2.cmml" xref="S2.SS1.p4.3.m3.1.2.2.2">𝑦</ci></apply><apply id="S2.SS1.p4.3.m3.1.2.3.cmml" xref="S2.SS1.p4.3.m3.1.2.3"><csymbol cd="ambiguous" id="S2.SS1.p4.3.m3.1.2.3.1.cmml" xref="S2.SS1.p4.3.m3.1.2.3">superscript</csymbol><ci id="S2.SS1.p4.3.m3.1.2.3.2.cmml" xref="S2.SS1.p4.3.m3.1.2.3.2">ℝ</ci><apply id="S2.SS1.p4.3.m3.1.1.1.2.cmml" xref="S2.SS1.p4.3.m3.1.1.1.3"><abs id="S2.SS1.p4.3.m3.1.1.1.2.1.cmml" xref="S2.SS1.p4.3.m3.1.1.1.3.1"></abs><ci id="S2.SS1.p4.3.m3.1.1.1.1.cmml" xref="S2.SS1.p4.3.m3.1.1.1.1">𝒱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.3.m3.1c">\hat{y}\in\mathbb{R}^{|\mathcal{V}|}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.3.m3.1d">over^ start_ARG italic_y end_ARG ∈ blackboard_R start_POSTSUPERSCRIPT | caligraphic_V | end_POSTSUPERSCRIPT</annotation></semantics></math> represents the probability distribution over the next item in the item set <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S2.SS1.p4.4.m4.1"><semantics id="S2.SS1.p4.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p4.4.m4.1.1" xref="S2.SS1.p4.4.m4.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.4.m4.1b"><ci id="S2.SS1.p4.4.m4.1.1.cmml" xref="S2.SS1.p4.4.m4.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.4.m4.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.4.m4.1d">caligraphic_V</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Linear Recurrent Units</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.11">Traditional Recurrent Neural Networks (<em class="ltx_emph ltx_font_italic" id="S2.SS2.p1.11.1">e.g.</em>, LSTM <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">hochreiter1997long</span>)</cite>, GRU <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">chung2014empirical</span>)</cite>) have achieved remarkable success in many sequential tasks. However, their inherent non-linear dependencies between hidden representations hinder efficient parallelizable training. Linear Recurrent Neural Networks have emerged as a promising alternative, addressing this limitation by employing linear transformations instead of non-linear activation functions such as tanh or ReLU functions. To achieve parallelizable training, Linear Recurrent Units (LRUs) are introduced in <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">gu2021efficiently</span>)</cite>:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E3">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E3X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle h_{t}" class="ltx_Math" display="inline" id="S2.E3X.2.1.1.m1.1"><semantics id="S2.E3X.2.1.1.m1.1a"><msub id="S2.E3X.2.1.1.m1.1.1" xref="S2.E3X.2.1.1.m1.1.1.cmml"><mi id="S2.E3X.2.1.1.m1.1.1.2" xref="S2.E3X.2.1.1.m1.1.1.2.cmml">h</mi><mi id="S2.E3X.2.1.1.m1.1.1.3" xref="S2.E3X.2.1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E3X.2.1.1.m1.1b"><apply id="S2.E3X.2.1.1.m1.1.1.cmml" xref="S2.E3X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E3X.2.1.1.m1.1.1.1.cmml" xref="S2.E3X.2.1.1.m1.1.1">subscript</csymbol><ci id="S2.E3X.2.1.1.m1.1.1.2.cmml" xref="S2.E3X.2.1.1.m1.1.1.2">ℎ</ci><ci id="S2.E3X.2.1.1.m1.1.1.3.cmml" xref="S2.E3X.2.1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3X.2.1.1.m1.1c">\displaystyle h_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.E3X.2.1.1.m1.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=Ah_{t-1}+Bx_{t}," class="ltx_Math" display="inline" id="S2.E3X.3.2.2.m1.1"><semantics id="S2.E3X.3.2.2.m1.1a"><mrow id="S2.E3X.3.2.2.m1.1.1.1" xref="S2.E3X.3.2.2.m1.1.1.1.1.cmml"><mrow id="S2.E3X.3.2.2.m1.1.1.1.1" xref="S2.E3X.3.2.2.m1.1.1.1.1.cmml"><mi id="S2.E3X.3.2.2.m1.1.1.1.1.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.2.cmml"></mi><mo id="S2.E3X.3.2.2.m1.1.1.1.1.1" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E3X.3.2.2.m1.1.1.1.1.3" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.cmml"><mrow id="S2.E3X.3.2.2.m1.1.1.1.1.3.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.2.cmml"><mi id="S2.E3X.3.2.2.m1.1.1.1.1.3.2.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.2.2.cmml">A</mi><mo id="S2.E3X.3.2.2.m1.1.1.1.1.3.2.1" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.2.1.cmml">⁢</mo><msub id="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.cmml"><mi id="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.2.cmml">h</mi><mrow id="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.3" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.3.cmml"><mi id="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.3.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.3.2.cmml">t</mi><mo id="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.3.1" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.3.1.cmml">−</mo><mn id="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.3.3" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S2.E3X.3.2.2.m1.1.1.1.1.3.1" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E3X.3.2.2.m1.1.1.1.1.3.3" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.3.cmml"><mi id="S2.E3X.3.2.2.m1.1.1.1.1.3.3.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.3.2.cmml">B</mi><mo id="S2.E3X.3.2.2.m1.1.1.1.1.3.3.1" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S2.E3X.3.2.2.m1.1.1.1.1.3.3.3" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.3.3.cmml"><mi id="S2.E3X.3.2.2.m1.1.1.1.1.3.3.3.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.3.3.2.cmml">x</mi><mi id="S2.E3X.3.2.2.m1.1.1.1.1.3.3.3.3" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.3.3.3.cmml">t</mi></msub></mrow></mrow></mrow><mo id="S2.E3X.3.2.2.m1.1.1.1.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3X.3.2.2.m1.1b"><apply id="S2.E3X.3.2.2.m1.1.1.1.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1"><eq id="S2.E3X.3.2.2.m1.1.1.1.1.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1"></eq><csymbol cd="latexml" id="S2.E3X.3.2.2.m1.1.1.1.1.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.2">absent</csymbol><apply id="S2.E3X.3.2.2.m1.1.1.1.1.3.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.3"><plus id="S2.E3X.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.1"></plus><apply id="S2.E3X.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.2"><times id="S2.E3X.3.2.2.m1.1.1.1.1.3.2.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.2.1"></times><ci id="S2.E3X.3.2.2.m1.1.1.1.1.3.2.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.2.2">𝐴</ci><apply id="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.2">ℎ</ci><apply id="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.3.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.3"><minus id="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.3.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.3.1"></minus><ci id="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.3.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.3.2">𝑡</ci><cn id="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.3.3.cmml" type="integer" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.2.3.3.3">1</cn></apply></apply></apply><apply id="S2.E3X.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.3"><times id="S2.E3X.3.2.2.m1.1.1.1.1.3.3.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.3.1"></times><ci id="S2.E3X.3.2.2.m1.1.1.1.1.3.3.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.3.2">𝐵</ci><apply id="S2.E3X.3.2.2.m1.1.1.1.1.3.3.3.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E3X.3.2.2.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.3.3.2">𝑥</ci><ci id="S2.E3X.3.2.2.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.3.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3X.3.2.2.m1.1c">\displaystyle=Ah_{t-1}+Bx_{t},</annotation><annotation encoding="application/x-llamapun" id="S2.E3X.3.2.2.m1.1d">= italic_A italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT + italic_B italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E3Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle y_{t}" class="ltx_Math" display="inline" id="S2.E3Xa.2.1.1.m1.1"><semantics id="S2.E3Xa.2.1.1.m1.1a"><msub id="S2.E3Xa.2.1.1.m1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.cmml"><mi id="S2.E3Xa.2.1.1.m1.1.1.2" xref="S2.E3Xa.2.1.1.m1.1.1.2.cmml">y</mi><mi id="S2.E3Xa.2.1.1.m1.1.1.3" xref="S2.E3Xa.2.1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E3Xa.2.1.1.m1.1b"><apply id="S2.E3Xa.2.1.1.m1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1">subscript</csymbol><ci id="S2.E3Xa.2.1.1.m1.1.1.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.2">𝑦</ci><ci id="S2.E3Xa.2.1.1.m1.1.1.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3Xa.2.1.1.m1.1c">\displaystyle y_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.E3Xa.2.1.1.m1.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=Ch_{t}+Dx_{t}," class="ltx_Math" display="inline" id="S2.E3Xa.3.2.2.m1.1"><semantics id="S2.E3Xa.3.2.2.m1.1a"><mrow id="S2.E3Xa.3.2.2.m1.1.1.1" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="S2.E3Xa.3.2.2.m1.1.1.1.1" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.cmml"><mi id="S2.E3Xa.3.2.2.m1.1.1.1.1.2" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.2.cmml"></mi><mo id="S2.E3Xa.3.2.2.m1.1.1.1.1.1" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E3Xa.3.2.2.m1.1.1.1.1.3" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.cmml"><mrow id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.cmml"><mi id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.cmml">C</mi><mo id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.1" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.1.cmml">⁢</mo><msub id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.3" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.3.cmml"><mi id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.3.2" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.3.2.cmml">h</mi><mi id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.3.3" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.3.3.cmml">t</mi></msub></mrow><mo id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.1" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.cmml"><mi id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.2" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.2.cmml">D</mi><mo id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.1" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.cmml"><mi id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.2" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.2.cmml">x</mi><mi id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.cmml">t</mi></msub></mrow></mrow></mrow><mo id="S2.E3Xa.3.2.2.m1.1.1.1.2" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3Xa.3.2.2.m1.1b"><apply id="S2.E3Xa.3.2.2.m1.1.1.1.1.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1"><eq id="S2.E3Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.1"></eq><csymbol cd="latexml" id="S2.E3Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.2">absent</csymbol><apply id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3"><plus id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.1"></plus><apply id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2"><times id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.1.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.1"></times><ci id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2">𝐶</ci><apply id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.3.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.3.1.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.3.2.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.3.2">ℎ</ci><ci id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.3.3.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.3.3">𝑡</ci></apply></apply><apply id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3"><times id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.1.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.1"></times><ci id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.2.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.2">𝐷</ci><apply id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.2">𝑥</ci><ci id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3Xa.3.2.2.m1.1c">\displaystyle=Ch_{t}+Dx_{t},</annotation><annotation encoding="application/x-llamapun" id="S2.E3Xa.3.2.2.m1.1d">= italic_C italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_D italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.10">where <math alttext="A\in\mathbb{R}^{N\times N},B\in\mathbb{R}^{N\times H_{\text{in }}},C\in\mathbb%
{R}^{H_{\text{out }}\times N},D\in\mathbb{R}^{H_{\text{out }}\times H_{\text{%
in}}}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.2"><semantics id="S2.SS2.p1.1.m1.2a"><mrow id="S2.SS2.p1.1.m1.2.2.2" xref="S2.SS2.p1.1.m1.2.2.3.cmml"><mrow id="S2.SS2.p1.1.m1.1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.1.1.2.cmml">A</mi><mo id="S2.SS2.p1.1.m1.1.1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml">∈</mo><msup id="S2.SS2.p1.1.m1.1.1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.1.1.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.1.1.3.2" xref="S2.SS2.p1.1.m1.1.1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p1.1.m1.1.1.1.1.3.3" xref="S2.SS2.p1.1.m1.1.1.1.1.3.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.1.1.3.3.2" xref="S2.SS2.p1.1.m1.1.1.1.1.3.3.2.cmml">N</mi><mo id="S2.SS2.p1.1.m1.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p1.1.m1.1.1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS2.p1.1.m1.1.1.1.1.3.3.3" xref="S2.SS2.p1.1.m1.1.1.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><mo id="S2.SS2.p1.1.m1.2.2.2.3" xref="S2.SS2.p1.1.m1.2.2.3a.cmml">,</mo><mrow id="S2.SS2.p1.1.m1.2.2.2.2.2" xref="S2.SS2.p1.1.m1.2.2.2.2.3.cmml"><mrow id="S2.SS2.p1.1.m1.2.2.2.2.1.1" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.cmml"><mi id="S2.SS2.p1.1.m1.2.2.2.2.1.1.2" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.2.cmml">B</mi><mo id="S2.SS2.p1.1.m1.2.2.2.2.1.1.1" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.1.cmml">∈</mo><msup id="S2.SS2.p1.1.m1.2.2.2.2.1.1.3" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.cmml"><mi id="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.2" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.cmml"><mi id="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.2" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.2.cmml">N</mi><mo id="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.1.cmml">×</mo><msub id="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.3" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.3.cmml"><mi id="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.3.2" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.3.2.cmml">H</mi><mtext id="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.3.3" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.3.3a.cmml">in </mtext></msub></mrow></msup></mrow><mo id="S2.SS2.p1.1.m1.2.2.2.2.2.3" xref="S2.SS2.p1.1.m1.2.2.2.2.3a.cmml">,</mo><mrow id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.3.cmml"><mrow id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.cmml"><mi id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.2" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.2.cmml">C</mi><mo id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.1" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.1.cmml">∈</mo><msup id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.cmml"><mi id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.2" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.cmml"><msub id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.2" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.2.cmml"><mi id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.2.2" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.2.2.cmml">H</mi><mtext id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.2.3" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.2.3a.cmml">out </mtext></msub><mo id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.1.cmml">×</mo><mi id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.3" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><mo id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.3" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.3a.cmml">,</mo><mrow id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.cmml"><mi id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.2" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.2.cmml">D</mi><mo id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.1" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.1.cmml">∈</mo><msup id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.cmml"><mi id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.2" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.cmml"><msub id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.2" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.2.cmml"><mi id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.2.2" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.2.2.cmml">H</mi><mtext id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.2.3" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.2.3a.cmml">out </mtext></msub><mo id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.1.cmml">×</mo><msub id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.3" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.3.cmml"><mi id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.3.2" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.3.2.cmml">H</mi><mtext id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.3.3" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.3.3a.cmml">in</mtext></msub></mrow></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.2b"><apply id="S2.SS2.p1.1.m1.2.2.3.cmml" xref="S2.SS2.p1.1.m1.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.2.2.3a.cmml" xref="S2.SS2.p1.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS2.p1.1.m1.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1"><in id="S2.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1"></in><ci id="S2.SS2.p1.1.m1.1.1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.2">𝐴</ci><apply id="S2.SS2.p1.1.m1.1.1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.1.1.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.1.1.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.3.2">ℝ</ci><apply id="S2.SS2.p1.1.m1.1.1.1.1.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.3.3"><times id="S2.SS2.p1.1.m1.1.1.1.1.3.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.3.3.1"></times><ci id="S2.SS2.p1.1.m1.1.1.1.1.3.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.3.3.2">𝑁</ci><ci id="S2.SS2.p1.1.m1.1.1.1.1.3.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.3.3.3">𝑁</ci></apply></apply></apply><apply id="S2.SS2.p1.1.m1.2.2.2.2.3.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.2.2.2.2.3a.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS2.p1.1.m1.2.2.2.2.1.1.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1"><in id="S2.SS2.p1.1.m1.2.2.2.2.1.1.1.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.1"></in><ci id="S2.SS2.p1.1.m1.2.2.2.2.1.1.2.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.2">𝐵</ci><apply id="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.1.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.2.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.2">ℝ</ci><apply id="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3"><times id="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.1.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.1"></times><ci id="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.2.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.2">𝑁</ci><apply id="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.3.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.3.1.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.3">subscript</csymbol><ci id="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.3.2.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.3.2">𝐻</ci><ci id="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.3.3a.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.3.3"><mtext id="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.3.3.cmml" mathsize="50%" xref="S2.SS2.p1.1.m1.2.2.2.2.1.1.3.3.3.3">in </mtext></ci></apply></apply></apply></apply><apply id="S2.SS2.p1.1.m1.2.2.2.2.2.2.3.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.2.2.2.2.2.2.3a.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1"><in id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.1"></in><ci id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.2.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.2">𝐶</ci><apply id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.1.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.2.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.2">ℝ</ci><apply id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3"><times id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.1.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.1"></times><apply id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.2.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.2.1.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.2">subscript</csymbol><ci id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.2.2.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.2.2">𝐻</ci><ci id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.2.3a.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.2.3"><mtext id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.2.3.cmml" mathsize="50%" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.2.3">out </mtext></ci></apply><ci id="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.3.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.3.3">𝑁</ci></apply></apply></apply><apply id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2"><in id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.1"></in><ci id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.2">𝐷</ci><apply id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.1.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3">superscript</csymbol><ci id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.2.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.2">ℝ</ci><apply id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3"><times id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.1.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.1"></times><apply id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.2.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.2.1.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.2">subscript</csymbol><ci id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.2.2.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.2.2">𝐻</ci><ci id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.2.3a.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.2.3"><mtext id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.2.3.cmml" mathsize="50%" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.2.3">out </mtext></ci></apply><apply id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.3.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.3.1.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.3">subscript</csymbol><ci id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.3.2.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.3.2">𝐻</ci><ci id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.3.3a.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.3.3"><mtext id="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.3.3.cmml" mathsize="50%" xref="S2.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.3.3.3">in</mtext></ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.2c">A\in\mathbb{R}^{N\times N},B\in\mathbb{R}^{N\times H_{\text{in }}},C\in\mathbb%
{R}^{H_{\text{out }}\times N},D\in\mathbb{R}^{H_{\text{out }}\times H_{\text{%
in}}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.2d">italic_A ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_N end_POSTSUPERSCRIPT , italic_B ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_H start_POSTSUBSCRIPT in end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_C ∈ blackboard_R start_POSTSUPERSCRIPT italic_H start_POSTSUBSCRIPT out end_POSTSUBSCRIPT × italic_N end_POSTSUPERSCRIPT , italic_D ∈ blackboard_R start_POSTSUPERSCRIPT italic_H start_POSTSUBSCRIPT out end_POSTSUBSCRIPT × italic_H start_POSTSUBSCRIPT in end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> are learnable parameters. With special initializations and parameterizations of the parameters <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">gu2021efficiently</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">orvieto2023resurrecting</span>)</cite>, LRUs achieve strong performance, as well as enjoy fast inference speed due to the nature of RNNs.
In addition, to achieve efficient parallelizable training, LRUs utilize complex diagonal matrix <math alttext="A" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">A</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">italic_A</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">orvieto2023resurrecting</span>)</cite>, allowing for a highly parallelizable unrolling to compute the hidden representation <math alttext="h_{k}=\sum_{j=0}^{k-1}A^{j}Bx_{k-j}" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.1"><semantics id="S2.SS2.p1.3.m3.1a"><mrow id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml"><msub id="S2.SS2.p1.3.m3.1.1.2" xref="S2.SS2.p1.3.m3.1.1.2.cmml"><mi id="S2.SS2.p1.3.m3.1.1.2.2" xref="S2.SS2.p1.3.m3.1.1.2.2.cmml">h</mi><mi id="S2.SS2.p1.3.m3.1.1.2.3" xref="S2.SS2.p1.3.m3.1.1.2.3.cmml">k</mi></msub><mo id="S2.SS2.p1.3.m3.1.1.1" rspace="0.111em" xref="S2.SS2.p1.3.m3.1.1.1.cmml">=</mo><mrow id="S2.SS2.p1.3.m3.1.1.3" xref="S2.SS2.p1.3.m3.1.1.3.cmml"><msubsup id="S2.SS2.p1.3.m3.1.1.3.1" xref="S2.SS2.p1.3.m3.1.1.3.1.cmml"><mo id="S2.SS2.p1.3.m3.1.1.3.1.2.2" xref="S2.SS2.p1.3.m3.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.SS2.p1.3.m3.1.1.3.1.2.3" xref="S2.SS2.p1.3.m3.1.1.3.1.2.3.cmml"><mi id="S2.SS2.p1.3.m3.1.1.3.1.2.3.2" xref="S2.SS2.p1.3.m3.1.1.3.1.2.3.2.cmml">j</mi><mo id="S2.SS2.p1.3.m3.1.1.3.1.2.3.1" xref="S2.SS2.p1.3.m3.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.SS2.p1.3.m3.1.1.3.1.2.3.3" xref="S2.SS2.p1.3.m3.1.1.3.1.2.3.3.cmml">0</mn></mrow><mrow id="S2.SS2.p1.3.m3.1.1.3.1.3" xref="S2.SS2.p1.3.m3.1.1.3.1.3.cmml"><mi id="S2.SS2.p1.3.m3.1.1.3.1.3.2" xref="S2.SS2.p1.3.m3.1.1.3.1.3.2.cmml">k</mi><mo id="S2.SS2.p1.3.m3.1.1.3.1.3.1" xref="S2.SS2.p1.3.m3.1.1.3.1.3.1.cmml">−</mo><mn id="S2.SS2.p1.3.m3.1.1.3.1.3.3" xref="S2.SS2.p1.3.m3.1.1.3.1.3.3.cmml">1</mn></mrow></msubsup><mrow id="S2.SS2.p1.3.m3.1.1.3.2" xref="S2.SS2.p1.3.m3.1.1.3.2.cmml"><msup id="S2.SS2.p1.3.m3.1.1.3.2.2" xref="S2.SS2.p1.3.m3.1.1.3.2.2.cmml"><mi id="S2.SS2.p1.3.m3.1.1.3.2.2.2" xref="S2.SS2.p1.3.m3.1.1.3.2.2.2.cmml">A</mi><mi id="S2.SS2.p1.3.m3.1.1.3.2.2.3" xref="S2.SS2.p1.3.m3.1.1.3.2.2.3.cmml">j</mi></msup><mo id="S2.SS2.p1.3.m3.1.1.3.2.1" xref="S2.SS2.p1.3.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S2.SS2.p1.3.m3.1.1.3.2.3" xref="S2.SS2.p1.3.m3.1.1.3.2.3.cmml">B</mi><mo id="S2.SS2.p1.3.m3.1.1.3.2.1a" xref="S2.SS2.p1.3.m3.1.1.3.2.1.cmml">⁢</mo><msub id="S2.SS2.p1.3.m3.1.1.3.2.4" xref="S2.SS2.p1.3.m3.1.1.3.2.4.cmml"><mi id="S2.SS2.p1.3.m3.1.1.3.2.4.2" xref="S2.SS2.p1.3.m3.1.1.3.2.4.2.cmml">x</mi><mrow id="S2.SS2.p1.3.m3.1.1.3.2.4.3" xref="S2.SS2.p1.3.m3.1.1.3.2.4.3.cmml"><mi id="S2.SS2.p1.3.m3.1.1.3.2.4.3.2" xref="S2.SS2.p1.3.m3.1.1.3.2.4.3.2.cmml">k</mi><mo id="S2.SS2.p1.3.m3.1.1.3.2.4.3.1" xref="S2.SS2.p1.3.m3.1.1.3.2.4.3.1.cmml">−</mo><mi id="S2.SS2.p1.3.m3.1.1.3.2.4.3.3" xref="S2.SS2.p1.3.m3.1.1.3.2.4.3.3.cmml">j</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><apply id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1"><eq id="S2.SS2.p1.3.m3.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1.1"></eq><apply id="S2.SS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.2.1.cmml" xref="S2.SS2.p1.3.m3.1.1.2">subscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.2.2.cmml" xref="S2.SS2.p1.3.m3.1.1.2.2">ℎ</ci><ci id="S2.SS2.p1.3.m3.1.1.2.3.cmml" xref="S2.SS2.p1.3.m3.1.1.2.3">𝑘</ci></apply><apply id="S2.SS2.p1.3.m3.1.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3"><apply id="S2.SS2.p1.3.m3.1.1.3.1.cmml" xref="S2.SS2.p1.3.m3.1.1.3.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1.3.1">superscript</csymbol><apply id="S2.SS2.p1.3.m3.1.1.3.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.3.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.3.1.2.1.cmml" xref="S2.SS2.p1.3.m3.1.1.3.1">subscript</csymbol><sum id="S2.SS2.p1.3.m3.1.1.3.1.2.2.cmml" xref="S2.SS2.p1.3.m3.1.1.3.1.2.2"></sum><apply id="S2.SS2.p1.3.m3.1.1.3.1.2.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3.1.2.3"><eq id="S2.SS2.p1.3.m3.1.1.3.1.2.3.1.cmml" xref="S2.SS2.p1.3.m3.1.1.3.1.2.3.1"></eq><ci id="S2.SS2.p1.3.m3.1.1.3.1.2.3.2.cmml" xref="S2.SS2.p1.3.m3.1.1.3.1.2.3.2">𝑗</ci><cn id="S2.SS2.p1.3.m3.1.1.3.1.2.3.3.cmml" type="integer" xref="S2.SS2.p1.3.m3.1.1.3.1.2.3.3">0</cn></apply></apply><apply id="S2.SS2.p1.3.m3.1.1.3.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3.1.3"><minus id="S2.SS2.p1.3.m3.1.1.3.1.3.1.cmml" xref="S2.SS2.p1.3.m3.1.1.3.1.3.1"></minus><ci id="S2.SS2.p1.3.m3.1.1.3.1.3.2.cmml" xref="S2.SS2.p1.3.m3.1.1.3.1.3.2">𝑘</ci><cn id="S2.SS2.p1.3.m3.1.1.3.1.3.3.cmml" type="integer" xref="S2.SS2.p1.3.m3.1.1.3.1.3.3">1</cn></apply></apply><apply id="S2.SS2.p1.3.m3.1.1.3.2.cmml" xref="S2.SS2.p1.3.m3.1.1.3.2"><times id="S2.SS2.p1.3.m3.1.1.3.2.1.cmml" xref="S2.SS2.p1.3.m3.1.1.3.2.1"></times><apply id="S2.SS2.p1.3.m3.1.1.3.2.2.cmml" xref="S2.SS2.p1.3.m3.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.3.2.2.1.cmml" xref="S2.SS2.p1.3.m3.1.1.3.2.2">superscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.3.2.2.2.cmml" xref="S2.SS2.p1.3.m3.1.1.3.2.2.2">𝐴</ci><ci id="S2.SS2.p1.3.m3.1.1.3.2.2.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3.2.2.3">𝑗</ci></apply><ci id="S2.SS2.p1.3.m3.1.1.3.2.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3.2.3">𝐵</ci><apply id="S2.SS2.p1.3.m3.1.1.3.2.4.cmml" xref="S2.SS2.p1.3.m3.1.1.3.2.4"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.3.2.4.1.cmml" xref="S2.SS2.p1.3.m3.1.1.3.2.4">subscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.3.2.4.2.cmml" xref="S2.SS2.p1.3.m3.1.1.3.2.4.2">𝑥</ci><apply id="S2.SS2.p1.3.m3.1.1.3.2.4.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3.2.4.3"><minus id="S2.SS2.p1.3.m3.1.1.3.2.4.3.1.cmml" xref="S2.SS2.p1.3.m3.1.1.3.2.4.3.1"></minus><ci id="S2.SS2.p1.3.m3.1.1.3.2.4.3.2.cmml" xref="S2.SS2.p1.3.m3.1.1.3.2.4.3.2">𝑘</ci><ci id="S2.SS2.p1.3.m3.1.1.3.2.4.3.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3.2.4.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">h_{k}=\sum_{j=0}^{k-1}A^{j}Bx_{k-j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.1d">italic_h start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_j = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k - 1 end_POSTSUPERSCRIPT italic_A start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT italic_B italic_x start_POSTSUBSCRIPT italic_k - italic_j end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="h_{0}=Bx_{0}" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m4.1"><semantics id="S2.SS2.p1.4.m4.1a"><mrow id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml"><msub id="S2.SS2.p1.4.m4.1.1.2" xref="S2.SS2.p1.4.m4.1.1.2.cmml"><mi id="S2.SS2.p1.4.m4.1.1.2.2" xref="S2.SS2.p1.4.m4.1.1.2.2.cmml">h</mi><mn id="S2.SS2.p1.4.m4.1.1.2.3" xref="S2.SS2.p1.4.m4.1.1.2.3.cmml">0</mn></msub><mo id="S2.SS2.p1.4.m4.1.1.1" xref="S2.SS2.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S2.SS2.p1.4.m4.1.1.3" xref="S2.SS2.p1.4.m4.1.1.3.cmml"><mi id="S2.SS2.p1.4.m4.1.1.3.2" xref="S2.SS2.p1.4.m4.1.1.3.2.cmml">B</mi><mo id="S2.SS2.p1.4.m4.1.1.3.1" xref="S2.SS2.p1.4.m4.1.1.3.1.cmml">⁢</mo><msub id="S2.SS2.p1.4.m4.1.1.3.3" xref="S2.SS2.p1.4.m4.1.1.3.3.cmml"><mi id="S2.SS2.p1.4.m4.1.1.3.3.2" xref="S2.SS2.p1.4.m4.1.1.3.3.2.cmml">x</mi><mn id="S2.SS2.p1.4.m4.1.1.3.3.3" xref="S2.SS2.p1.4.m4.1.1.3.3.3.cmml">0</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><apply id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1"><eq id="S2.SS2.p1.4.m4.1.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1.1"></eq><apply id="S2.SS2.p1.4.m4.1.1.2.cmml" xref="S2.SS2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.1.1.2.1.cmml" xref="S2.SS2.p1.4.m4.1.1.2">subscript</csymbol><ci id="S2.SS2.p1.4.m4.1.1.2.2.cmml" xref="S2.SS2.p1.4.m4.1.1.2.2">ℎ</ci><cn id="S2.SS2.p1.4.m4.1.1.2.3.cmml" type="integer" xref="S2.SS2.p1.4.m4.1.1.2.3">0</cn></apply><apply id="S2.SS2.p1.4.m4.1.1.3.cmml" xref="S2.SS2.p1.4.m4.1.1.3"><times id="S2.SS2.p1.4.m4.1.1.3.1.cmml" xref="S2.SS2.p1.4.m4.1.1.3.1"></times><ci id="S2.SS2.p1.4.m4.1.1.3.2.cmml" xref="S2.SS2.p1.4.m4.1.1.3.2">𝐵</ci><apply id="S2.SS2.p1.4.m4.1.1.3.3.cmml" xref="S2.SS2.p1.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.1.1.3.3.1.cmml" xref="S2.SS2.p1.4.m4.1.1.3.3">subscript</csymbol><ci id="S2.SS2.p1.4.m4.1.1.3.3.2.cmml" xref="S2.SS2.p1.4.m4.1.1.3.3.2">𝑥</ci><cn id="S2.SS2.p1.4.m4.1.1.3.3.3.cmml" type="integer" xref="S2.SS2.p1.4.m4.1.1.3.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">h_{0}=Bx_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m4.1d">italic_h start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = italic_B italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>. By leveraging eigendecomposition of the complex diagonalizable <math alttext="A" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m5.1"><semantics id="S2.SS2.p1.5.m5.1a"><mi id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><ci id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">A</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m5.1d">italic_A</annotation></semantics></math>, we can write <math alttext="A=P\Lambda P^{-1}" class="ltx_Math" display="inline" id="S2.SS2.p1.6.m6.1"><semantics id="S2.SS2.p1.6.m6.1a"><mrow id="S2.SS2.p1.6.m6.1.1" xref="S2.SS2.p1.6.m6.1.1.cmml"><mi id="S2.SS2.p1.6.m6.1.1.2" xref="S2.SS2.p1.6.m6.1.1.2.cmml">A</mi><mo id="S2.SS2.p1.6.m6.1.1.1" xref="S2.SS2.p1.6.m6.1.1.1.cmml">=</mo><mrow id="S2.SS2.p1.6.m6.1.1.3" xref="S2.SS2.p1.6.m6.1.1.3.cmml"><mi id="S2.SS2.p1.6.m6.1.1.3.2" xref="S2.SS2.p1.6.m6.1.1.3.2.cmml">P</mi><mo id="S2.SS2.p1.6.m6.1.1.3.1" xref="S2.SS2.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.6.m6.1.1.3.3" mathvariant="normal" xref="S2.SS2.p1.6.m6.1.1.3.3.cmml">Λ</mi><mo id="S2.SS2.p1.6.m6.1.1.3.1a" xref="S2.SS2.p1.6.m6.1.1.3.1.cmml">⁢</mo><msup id="S2.SS2.p1.6.m6.1.1.3.4" xref="S2.SS2.p1.6.m6.1.1.3.4.cmml"><mi id="S2.SS2.p1.6.m6.1.1.3.4.2" xref="S2.SS2.p1.6.m6.1.1.3.4.2.cmml">P</mi><mrow id="S2.SS2.p1.6.m6.1.1.3.4.3" xref="S2.SS2.p1.6.m6.1.1.3.4.3.cmml"><mo id="S2.SS2.p1.6.m6.1.1.3.4.3a" xref="S2.SS2.p1.6.m6.1.1.3.4.3.cmml">−</mo><mn id="S2.SS2.p1.6.m6.1.1.3.4.3.2" xref="S2.SS2.p1.6.m6.1.1.3.4.3.2.cmml">1</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.1b"><apply id="S2.SS2.p1.6.m6.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1"><eq id="S2.SS2.p1.6.m6.1.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1.1"></eq><ci id="S2.SS2.p1.6.m6.1.1.2.cmml" xref="S2.SS2.p1.6.m6.1.1.2">𝐴</ci><apply id="S2.SS2.p1.6.m6.1.1.3.cmml" xref="S2.SS2.p1.6.m6.1.1.3"><times id="S2.SS2.p1.6.m6.1.1.3.1.cmml" xref="S2.SS2.p1.6.m6.1.1.3.1"></times><ci id="S2.SS2.p1.6.m6.1.1.3.2.cmml" xref="S2.SS2.p1.6.m6.1.1.3.2">𝑃</ci><ci id="S2.SS2.p1.6.m6.1.1.3.3.cmml" xref="S2.SS2.p1.6.m6.1.1.3.3">Λ</ci><apply id="S2.SS2.p1.6.m6.1.1.3.4.cmml" xref="S2.SS2.p1.6.m6.1.1.3.4"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m6.1.1.3.4.1.cmml" xref="S2.SS2.p1.6.m6.1.1.3.4">superscript</csymbol><ci id="S2.SS2.p1.6.m6.1.1.3.4.2.cmml" xref="S2.SS2.p1.6.m6.1.1.3.4.2">𝑃</ci><apply id="S2.SS2.p1.6.m6.1.1.3.4.3.cmml" xref="S2.SS2.p1.6.m6.1.1.3.4.3"><minus id="S2.SS2.p1.6.m6.1.1.3.4.3.1.cmml" xref="S2.SS2.p1.6.m6.1.1.3.4.3"></minus><cn id="S2.SS2.p1.6.m6.1.1.3.4.3.2.cmml" type="integer" xref="S2.SS2.p1.6.m6.1.1.3.4.3.2">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.1c">A=P\Lambda P^{-1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.6.m6.1d">italic_A = italic_P roman_Λ italic_P start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="P\in\mathbb{C}^{N\times N}" class="ltx_Math" display="inline" id="S2.SS2.p1.7.m7.1"><semantics id="S2.SS2.p1.7.m7.1a"><mrow id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml"><mi id="S2.SS2.p1.7.m7.1.1.2" xref="S2.SS2.p1.7.m7.1.1.2.cmml">P</mi><mo id="S2.SS2.p1.7.m7.1.1.1" xref="S2.SS2.p1.7.m7.1.1.1.cmml">∈</mo><msup id="S2.SS2.p1.7.m7.1.1.3" xref="S2.SS2.p1.7.m7.1.1.3.cmml"><mi id="S2.SS2.p1.7.m7.1.1.3.2" xref="S2.SS2.p1.7.m7.1.1.3.2.cmml">ℂ</mi><mrow id="S2.SS2.p1.7.m7.1.1.3.3" xref="S2.SS2.p1.7.m7.1.1.3.3.cmml"><mi id="S2.SS2.p1.7.m7.1.1.3.3.2" xref="S2.SS2.p1.7.m7.1.1.3.3.2.cmml">N</mi><mo id="S2.SS2.p1.7.m7.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p1.7.m7.1.1.3.3.1.cmml">×</mo><mi id="S2.SS2.p1.7.m7.1.1.3.3.3" xref="S2.SS2.p1.7.m7.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.1b"><apply id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1"><in id="S2.SS2.p1.7.m7.1.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1.1"></in><ci id="S2.SS2.p1.7.m7.1.1.2.cmml" xref="S2.SS2.p1.7.m7.1.1.2">𝑃</ci><apply id="S2.SS2.p1.7.m7.1.1.3.cmml" xref="S2.SS2.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.1.1.3.1.cmml" xref="S2.SS2.p1.7.m7.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.7.m7.1.1.3.2.cmml" xref="S2.SS2.p1.7.m7.1.1.3.2">ℂ</ci><apply id="S2.SS2.p1.7.m7.1.1.3.3.cmml" xref="S2.SS2.p1.7.m7.1.1.3.3"><times id="S2.SS2.p1.7.m7.1.1.3.3.1.cmml" xref="S2.SS2.p1.7.m7.1.1.3.3.1"></times><ci id="S2.SS2.p1.7.m7.1.1.3.3.2.cmml" xref="S2.SS2.p1.7.m7.1.1.3.3.2">𝑁</ci><ci id="S2.SS2.p1.7.m7.1.1.3.3.3.cmml" xref="S2.SS2.p1.7.m7.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.1c">P\in\mathbb{C}^{N\times N}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.7.m7.1d">italic_P ∈ blackboard_C start_POSTSUPERSCRIPT italic_N × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> is an invertible matrix, and <math alttext="\Lambda=\operatorname{diag}\left(\lambda_{1},\lambda_{2},\ldots,\lambda_{N}%
\right)\in\mathbb{C}^{N\times N}" class="ltx_Math" display="inline" id="S2.SS2.p1.8.m8.5"><semantics id="S2.SS2.p1.8.m8.5a"><mrow id="S2.SS2.p1.8.m8.5.5" xref="S2.SS2.p1.8.m8.5.5.cmml"><mi id="S2.SS2.p1.8.m8.5.5.5" mathvariant="normal" xref="S2.SS2.p1.8.m8.5.5.5.cmml">Λ</mi><mo id="S2.SS2.p1.8.m8.5.5.6" xref="S2.SS2.p1.8.m8.5.5.6.cmml">=</mo><mrow id="S2.SS2.p1.8.m8.5.5.3.3" xref="S2.SS2.p1.8.m8.5.5.3.4.cmml"><mi id="S2.SS2.p1.8.m8.1.1" xref="S2.SS2.p1.8.m8.1.1.cmml">diag</mi><mo id="S2.SS2.p1.8.m8.5.5.3.3a" xref="S2.SS2.p1.8.m8.5.5.3.4.cmml">⁡</mo><mrow id="S2.SS2.p1.8.m8.5.5.3.3.3" xref="S2.SS2.p1.8.m8.5.5.3.4.cmml"><mo id="S2.SS2.p1.8.m8.5.5.3.3.3.4" xref="S2.SS2.p1.8.m8.5.5.3.4.cmml">(</mo><msub id="S2.SS2.p1.8.m8.3.3.1.1.1.1" xref="S2.SS2.p1.8.m8.3.3.1.1.1.1.cmml"><mi id="S2.SS2.p1.8.m8.3.3.1.1.1.1.2" xref="S2.SS2.p1.8.m8.3.3.1.1.1.1.2.cmml">λ</mi><mn id="S2.SS2.p1.8.m8.3.3.1.1.1.1.3" xref="S2.SS2.p1.8.m8.3.3.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p1.8.m8.5.5.3.3.3.5" xref="S2.SS2.p1.8.m8.5.5.3.4.cmml">,</mo><msub id="S2.SS2.p1.8.m8.4.4.2.2.2.2" xref="S2.SS2.p1.8.m8.4.4.2.2.2.2.cmml"><mi id="S2.SS2.p1.8.m8.4.4.2.2.2.2.2" xref="S2.SS2.p1.8.m8.4.4.2.2.2.2.2.cmml">λ</mi><mn id="S2.SS2.p1.8.m8.4.4.2.2.2.2.3" xref="S2.SS2.p1.8.m8.4.4.2.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS2.p1.8.m8.5.5.3.3.3.6" xref="S2.SS2.p1.8.m8.5.5.3.4.cmml">,</mo><mi id="S2.SS2.p1.8.m8.2.2" mathvariant="normal" xref="S2.SS2.p1.8.m8.2.2.cmml">…</mi><mo id="S2.SS2.p1.8.m8.5.5.3.3.3.7" xref="S2.SS2.p1.8.m8.5.5.3.4.cmml">,</mo><msub id="S2.SS2.p1.8.m8.5.5.3.3.3.3" xref="S2.SS2.p1.8.m8.5.5.3.3.3.3.cmml"><mi id="S2.SS2.p1.8.m8.5.5.3.3.3.3.2" xref="S2.SS2.p1.8.m8.5.5.3.3.3.3.2.cmml">λ</mi><mi id="S2.SS2.p1.8.m8.5.5.3.3.3.3.3" xref="S2.SS2.p1.8.m8.5.5.3.3.3.3.3.cmml">N</mi></msub><mo id="S2.SS2.p1.8.m8.5.5.3.3.3.8" xref="S2.SS2.p1.8.m8.5.5.3.4.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.8.m8.5.5.7" xref="S2.SS2.p1.8.m8.5.5.7.cmml">∈</mo><msup id="S2.SS2.p1.8.m8.5.5.8" xref="S2.SS2.p1.8.m8.5.5.8.cmml"><mi id="S2.SS2.p1.8.m8.5.5.8.2" xref="S2.SS2.p1.8.m8.5.5.8.2.cmml">ℂ</mi><mrow id="S2.SS2.p1.8.m8.5.5.8.3" xref="S2.SS2.p1.8.m8.5.5.8.3.cmml"><mi id="S2.SS2.p1.8.m8.5.5.8.3.2" xref="S2.SS2.p1.8.m8.5.5.8.3.2.cmml">N</mi><mo id="S2.SS2.p1.8.m8.5.5.8.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p1.8.m8.5.5.8.3.1.cmml">×</mo><mi id="S2.SS2.p1.8.m8.5.5.8.3.3" xref="S2.SS2.p1.8.m8.5.5.8.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.5b"><apply id="S2.SS2.p1.8.m8.5.5.cmml" xref="S2.SS2.p1.8.m8.5.5"><and id="S2.SS2.p1.8.m8.5.5a.cmml" xref="S2.SS2.p1.8.m8.5.5"></and><apply id="S2.SS2.p1.8.m8.5.5b.cmml" xref="S2.SS2.p1.8.m8.5.5"><eq id="S2.SS2.p1.8.m8.5.5.6.cmml" xref="S2.SS2.p1.8.m8.5.5.6"></eq><ci id="S2.SS2.p1.8.m8.5.5.5.cmml" xref="S2.SS2.p1.8.m8.5.5.5">Λ</ci><apply id="S2.SS2.p1.8.m8.5.5.3.4.cmml" xref="S2.SS2.p1.8.m8.5.5.3.3"><ci id="S2.SS2.p1.8.m8.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1">diag</ci><apply id="S2.SS2.p1.8.m8.3.3.1.1.1.1.cmml" xref="S2.SS2.p1.8.m8.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.3.3.1.1.1.1.1.cmml" xref="S2.SS2.p1.8.m8.3.3.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.8.m8.3.3.1.1.1.1.2.cmml" xref="S2.SS2.p1.8.m8.3.3.1.1.1.1.2">𝜆</ci><cn id="S2.SS2.p1.8.m8.3.3.1.1.1.1.3.cmml" type="integer" xref="S2.SS2.p1.8.m8.3.3.1.1.1.1.3">1</cn></apply><apply id="S2.SS2.p1.8.m8.4.4.2.2.2.2.cmml" xref="S2.SS2.p1.8.m8.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.4.4.2.2.2.2.1.cmml" xref="S2.SS2.p1.8.m8.4.4.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.8.m8.4.4.2.2.2.2.2.cmml" xref="S2.SS2.p1.8.m8.4.4.2.2.2.2.2">𝜆</ci><cn id="S2.SS2.p1.8.m8.4.4.2.2.2.2.3.cmml" type="integer" xref="S2.SS2.p1.8.m8.4.4.2.2.2.2.3">2</cn></apply><ci id="S2.SS2.p1.8.m8.2.2.cmml" xref="S2.SS2.p1.8.m8.2.2">…</ci><apply id="S2.SS2.p1.8.m8.5.5.3.3.3.3.cmml" xref="S2.SS2.p1.8.m8.5.5.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.5.5.3.3.3.3.1.cmml" xref="S2.SS2.p1.8.m8.5.5.3.3.3.3">subscript</csymbol><ci id="S2.SS2.p1.8.m8.5.5.3.3.3.3.2.cmml" xref="S2.SS2.p1.8.m8.5.5.3.3.3.3.2">𝜆</ci><ci id="S2.SS2.p1.8.m8.5.5.3.3.3.3.3.cmml" xref="S2.SS2.p1.8.m8.5.5.3.3.3.3.3">𝑁</ci></apply></apply></apply><apply id="S2.SS2.p1.8.m8.5.5c.cmml" xref="S2.SS2.p1.8.m8.5.5"><in id="S2.SS2.p1.8.m8.5.5.7.cmml" xref="S2.SS2.p1.8.m8.5.5.7"></in><share href="https://arxiv.org/html/2406.12580v2#S2.SS2.p1.8.m8.5.5.3.cmml" id="S2.SS2.p1.8.m8.5.5d.cmml" xref="S2.SS2.p1.8.m8.5.5"></share><apply id="S2.SS2.p1.8.m8.5.5.8.cmml" xref="S2.SS2.p1.8.m8.5.5.8"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.5.5.8.1.cmml" xref="S2.SS2.p1.8.m8.5.5.8">superscript</csymbol><ci id="S2.SS2.p1.8.m8.5.5.8.2.cmml" xref="S2.SS2.p1.8.m8.5.5.8.2">ℂ</ci><apply id="S2.SS2.p1.8.m8.5.5.8.3.cmml" xref="S2.SS2.p1.8.m8.5.5.8.3"><times id="S2.SS2.p1.8.m8.5.5.8.3.1.cmml" xref="S2.SS2.p1.8.m8.5.5.8.3.1"></times><ci id="S2.SS2.p1.8.m8.5.5.8.3.2.cmml" xref="S2.SS2.p1.8.m8.5.5.8.3.2">𝑁</ci><ci id="S2.SS2.p1.8.m8.5.5.8.3.3.cmml" xref="S2.SS2.p1.8.m8.5.5.8.3.3">𝑁</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.5c">\Lambda=\operatorname{diag}\left(\lambda_{1},\lambda_{2},\ldots,\lambda_{N}%
\right)\in\mathbb{C}^{N\times N}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.8.m8.5d">roman_Λ = roman_diag ( italic_λ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_λ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) ∈ blackboard_C start_POSTSUPERSCRIPT italic_N × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>. Therefore, the computation of <math alttext="A^{k}" class="ltx_Math" display="inline" id="S2.SS2.p1.9.m9.1"><semantics id="S2.SS2.p1.9.m9.1a"><msup id="S2.SS2.p1.9.m9.1.1" xref="S2.SS2.p1.9.m9.1.1.cmml"><mi id="S2.SS2.p1.9.m9.1.1.2" xref="S2.SS2.p1.9.m9.1.1.2.cmml">A</mi><mi id="S2.SS2.p1.9.m9.1.1.3" xref="S2.SS2.p1.9.m9.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m9.1b"><apply id="S2.SS2.p1.9.m9.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.9.m9.1.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1">superscript</csymbol><ci id="S2.SS2.p1.9.m9.1.1.2.cmml" xref="S2.SS2.p1.9.m9.1.1.2">𝐴</ci><ci id="S2.SS2.p1.9.m9.1.1.3.cmml" xref="S2.SS2.p1.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m9.1c">A^{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.9.m9.1d">italic_A start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> reduces to <math alttext="P\Lambda^{k}P^{-1}" class="ltx_Math" display="inline" id="S2.SS2.p1.10.m10.1"><semantics id="S2.SS2.p1.10.m10.1a"><mrow id="S2.SS2.p1.10.m10.1.1" xref="S2.SS2.p1.10.m10.1.1.cmml"><mi id="S2.SS2.p1.10.m10.1.1.2" xref="S2.SS2.p1.10.m10.1.1.2.cmml">P</mi><mo id="S2.SS2.p1.10.m10.1.1.1" xref="S2.SS2.p1.10.m10.1.1.1.cmml">⁢</mo><msup id="S2.SS2.p1.10.m10.1.1.3" xref="S2.SS2.p1.10.m10.1.1.3.cmml"><mi id="S2.SS2.p1.10.m10.1.1.3.2" mathvariant="normal" xref="S2.SS2.p1.10.m10.1.1.3.2.cmml">Λ</mi><mi id="S2.SS2.p1.10.m10.1.1.3.3" xref="S2.SS2.p1.10.m10.1.1.3.3.cmml">k</mi></msup><mo id="S2.SS2.p1.10.m10.1.1.1a" xref="S2.SS2.p1.10.m10.1.1.1.cmml">⁢</mo><msup id="S2.SS2.p1.10.m10.1.1.4" xref="S2.SS2.p1.10.m10.1.1.4.cmml"><mi id="S2.SS2.p1.10.m10.1.1.4.2" xref="S2.SS2.p1.10.m10.1.1.4.2.cmml">P</mi><mrow id="S2.SS2.p1.10.m10.1.1.4.3" xref="S2.SS2.p1.10.m10.1.1.4.3.cmml"><mo id="S2.SS2.p1.10.m10.1.1.4.3a" xref="S2.SS2.p1.10.m10.1.1.4.3.cmml">−</mo><mn id="S2.SS2.p1.10.m10.1.1.4.3.2" xref="S2.SS2.p1.10.m10.1.1.4.3.2.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m10.1b"><apply id="S2.SS2.p1.10.m10.1.1.cmml" xref="S2.SS2.p1.10.m10.1.1"><times id="S2.SS2.p1.10.m10.1.1.1.cmml" xref="S2.SS2.p1.10.m10.1.1.1"></times><ci id="S2.SS2.p1.10.m10.1.1.2.cmml" xref="S2.SS2.p1.10.m10.1.1.2">𝑃</ci><apply id="S2.SS2.p1.10.m10.1.1.3.cmml" xref="S2.SS2.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.10.m10.1.1.3.1.cmml" xref="S2.SS2.p1.10.m10.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.10.m10.1.1.3.2.cmml" xref="S2.SS2.p1.10.m10.1.1.3.2">Λ</ci><ci id="S2.SS2.p1.10.m10.1.1.3.3.cmml" xref="S2.SS2.p1.10.m10.1.1.3.3">𝑘</ci></apply><apply id="S2.SS2.p1.10.m10.1.1.4.cmml" xref="S2.SS2.p1.10.m10.1.1.4"><csymbol cd="ambiguous" id="S2.SS2.p1.10.m10.1.1.4.1.cmml" xref="S2.SS2.p1.10.m10.1.1.4">superscript</csymbol><ci id="S2.SS2.p1.10.m10.1.1.4.2.cmml" xref="S2.SS2.p1.10.m10.1.1.4.2">𝑃</ci><apply id="S2.SS2.p1.10.m10.1.1.4.3.cmml" xref="S2.SS2.p1.10.m10.1.1.4.3"><minus id="S2.SS2.p1.10.m10.1.1.4.3.1.cmml" xref="S2.SS2.p1.10.m10.1.1.4.3"></minus><cn id="S2.SS2.p1.10.m10.1.1.4.3.2.cmml" type="integer" xref="S2.SS2.p1.10.m10.1.1.4.3.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m10.1c">P\Lambda^{k}P^{-1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.10.m10.1d">italic_P roman_Λ start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_P start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> which becomes element-wise diagonal matrix multiplications and significantly improves the training efficiency.
While LRURec <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">yue2024linear</span>)</cite> pioneers the use of LRUs for sequential recommendation, its complex-valued hidden representations and learnable parameters are not ideal for this task. As demonstrated in <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">gu2023mamba</span>)</cite>, these complex elements are beneficial for continuous modalities like audio and video, but not for discrete sequence modeling like recommendations. Additionally, complex LRUs introduce a larger number of parameters compared to real-valued counterparts, potentially hindering performance on smaller datasets. Furthermore, the efficiency constraints of LRUs make the parameters in Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S2.E3" title="Equation 3 ‣ 2.2. Linear Recurrent Units ‣ 2. Preliminaries ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> static and independent of input user behaviors, unable to capture user behavior within the interaction sequence, limiting further improvement in recommendation accuracy.
Therefore, we aim to utilize real-valued LRUs with dependency on user behaviors, while maintaining fast training speed.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Methodology</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">Accurately capturing user behavior nuances is critical for recommendation systems, but traditional linear recurrent units (LRUs) and LRURec sacrifice their behavior-dependency of the learnable parameters to achieve efficient training, limiting their ability to adapt to diverse user interactions.
To further improve the recommendation performance, we discard the complex-valued parameters and training scheme of traditional LRUs, enabling behavior-dependent modeling. We propose a novel gated behavior-dependent recurrent model, RecBLR, that tackles the limitations through three key innovations: (1) a recurrent layer with gating mechanisms selectively controlling the relevant input behavior to LRUs, (2) behavior-dependent linear recurrent units (BD-LRUs) that adaptively learn important user behaviors, and (3) efficient hardware-aware parallel scan algorithm enabling parallelizable BD-LRU training on GPUs to compensate for the discarded traditional training scheme. This section introduces the overall architecture and then delves into the key innovations of RecBLR.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Overview</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">In this section, we present the overall architecture of our proposed RecBLR model. As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S2.F2" title="Figure 2 ‣ 2. Preliminaries ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, it comprises an embedding layer, followed by stacked behavior modeling layers, and a final prediction layer.
Our behavior modeling layer consists of a gated recurrent layer and a feedforward layer, along with dropout <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">srivastava2014dropout</span>)</cite>, layer normalization <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">ba2016layer</span>)</cite>, and residual connections <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">he2016deep</span>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.5"><span class="ltx_text ltx_font_bold" id="S3.SS1.p2.5.1">Gated Recurrent Layer.</span>
To further enhance the recommendation performance, our gated recurrent layer incorporates the gating mechanisms used in LSTM <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">hochreiter1997long</span>)</cite> and GRU <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">chung2014empirical</span>)</cite>. The gates regulate the flow of user behavior information inside the core Behavior-Dependent Linear Recurrent Unit (BD-LRU). As outlined in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#alg1" title="Algorithm 1 ‣ 3.1. Overview ‣ 3. Methodology ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, it begins by expanding the hidden dimension <math alttext="D" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_D</annotation></semantics></math> to <math alttext="DE" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">D</mi><mo id="S3.SS1.p2.2.m2.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><times id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1"></times><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝐷</ci><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">DE</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_D italic_E</annotation></semantics></math> using linear projections implemented by two fully connected layers with an expansion factor <math alttext="E" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">E</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_E</annotation></semantics></math>, creating two parallel branches.
In the main branch, a unidirectional causal 1D convolutional layer <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">fu2022hungry</span>)</cite> is applied to preserve the chronological order of the user interaction sequence. A SiLU activation <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">hendrycks2016gaussian</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">ramachandran2017searching</span>)</cite> follows this. Next, we use our proposed behavior-dependent linear recurrent unit, which is the core component of the recurrent layer.
In the secondary branch, the input is passed through a SiLU. The outputs of the two branches are then merged via element-wise multiplication.
Finally, a linear projection reduces the dimensionality of the merged output from <math alttext="DE" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">D</mi><mo id="S3.SS1.p2.4.m4.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><times id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1"></times><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝐷</ci><ci id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">DE</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_D italic_E</annotation></semantics></math> back to the original <math alttext="D" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_D</annotation></semantics></math> dimensions.
This gated recurrent layer design allows the model to capture intricate patterns and interactions within the sequential user behavioral data while effectively maintaining temporal dependencies through the recurrent BD-LRU component and gating mechanisms.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Gated Recurrent Layer</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l1.2">Input:</span> <math alttext="H_{i}:(B,T,D)" class="ltx_Math" display="inline" id="alg1.l1.m1.3"><semantics id="alg1.l1.m1.3a"><mrow id="alg1.l1.m1.3.4" xref="alg1.l1.m1.3.4.cmml"><msub id="alg1.l1.m1.3.4.2" xref="alg1.l1.m1.3.4.2.cmml"><mi id="alg1.l1.m1.3.4.2.2" xref="alg1.l1.m1.3.4.2.2.cmml">H</mi><mi id="alg1.l1.m1.3.4.2.3" xref="alg1.l1.m1.3.4.2.3.cmml">i</mi></msub><mo id="alg1.l1.m1.3.4.1" lspace="0.278em" rspace="0.278em" xref="alg1.l1.m1.3.4.1.cmml">:</mo><mrow id="alg1.l1.m1.3.4.3.2" xref="alg1.l1.m1.3.4.3.1.cmml"><mo id="alg1.l1.m1.3.4.3.2.1" stretchy="false" xref="alg1.l1.m1.3.4.3.1.cmml">(</mo><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">B</mi><mo id="alg1.l1.m1.3.4.3.2.2" xref="alg1.l1.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l1.m1.2.2" xref="alg1.l1.m1.2.2.cmml">T</mi><mo id="alg1.l1.m1.3.4.3.2.3" xref="alg1.l1.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l1.m1.3.3" xref="alg1.l1.m1.3.3.cmml">D</mi><mo id="alg1.l1.m1.3.4.3.2.4" stretchy="false" xref="alg1.l1.m1.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><apply id="alg1.l1.m1.3.4.cmml" xref="alg1.l1.m1.3.4"><ci id="alg1.l1.m1.3.4.1.cmml" xref="alg1.l1.m1.3.4.1">:</ci><apply id="alg1.l1.m1.3.4.2.cmml" xref="alg1.l1.m1.3.4.2"><csymbol cd="ambiguous" id="alg1.l1.m1.3.4.2.1.cmml" xref="alg1.l1.m1.3.4.2">subscript</csymbol><ci id="alg1.l1.m1.3.4.2.2.cmml" xref="alg1.l1.m1.3.4.2.2">𝐻</ci><ci id="alg1.l1.m1.3.4.2.3.cmml" xref="alg1.l1.m1.3.4.2.3">𝑖</ci></apply><vector id="alg1.l1.m1.3.4.3.1.cmml" xref="alg1.l1.m1.3.4.3.2"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝐵</ci><ci id="alg1.l1.m1.2.2.cmml" xref="alg1.l1.m1.2.2">𝑇</ci><ci id="alg1.l1.m1.3.3.cmml" xref="alg1.l1.m1.3.3">𝐷</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">H_{i}:(B,T,D)</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.3d">italic_H start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT : ( italic_B , italic_T , italic_D )</annotation></semantics></math> <span class="ltx_text" id="alg1.l1.3">(batch size, sequence length, dimension)</span>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l2.2">Output:</span> <math alttext="H_{o}:(B,T,D)" class="ltx_Math" display="inline" id="alg1.l2.m1.3"><semantics id="alg1.l2.m1.3a"><mrow id="alg1.l2.m1.3.4" xref="alg1.l2.m1.3.4.cmml"><msub id="alg1.l2.m1.3.4.2" xref="alg1.l2.m1.3.4.2.cmml"><mi id="alg1.l2.m1.3.4.2.2" xref="alg1.l2.m1.3.4.2.2.cmml">H</mi><mi id="alg1.l2.m1.3.4.2.3" xref="alg1.l2.m1.3.4.2.3.cmml">o</mi></msub><mo id="alg1.l2.m1.3.4.1" lspace="0.278em" rspace="0.278em" xref="alg1.l2.m1.3.4.1.cmml">:</mo><mrow id="alg1.l2.m1.3.4.3.2" xref="alg1.l2.m1.3.4.3.1.cmml"><mo id="alg1.l2.m1.3.4.3.2.1" stretchy="false" xref="alg1.l2.m1.3.4.3.1.cmml">(</mo><mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">B</mi><mo id="alg1.l2.m1.3.4.3.2.2" xref="alg1.l2.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml">T</mi><mo id="alg1.l2.m1.3.4.3.2.3" xref="alg1.l2.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l2.m1.3.3" xref="alg1.l2.m1.3.3.cmml">D</mi><mo id="alg1.l2.m1.3.4.3.2.4" stretchy="false" xref="alg1.l2.m1.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.3b"><apply id="alg1.l2.m1.3.4.cmml" xref="alg1.l2.m1.3.4"><ci id="alg1.l2.m1.3.4.1.cmml" xref="alg1.l2.m1.3.4.1">:</ci><apply id="alg1.l2.m1.3.4.2.cmml" xref="alg1.l2.m1.3.4.2"><csymbol cd="ambiguous" id="alg1.l2.m1.3.4.2.1.cmml" xref="alg1.l2.m1.3.4.2">subscript</csymbol><ci id="alg1.l2.m1.3.4.2.2.cmml" xref="alg1.l2.m1.3.4.2.2">𝐻</ci><ci id="alg1.l2.m1.3.4.2.3.cmml" xref="alg1.l2.m1.3.4.2.3">𝑜</ci></apply><vector id="alg1.l2.m1.3.4.3.1.cmml" xref="alg1.l2.m1.3.4.3.2"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">𝐵</ci><ci id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2">𝑇</ci><ci id="alg1.l2.m1.3.3.cmml" xref="alg1.l2.m1.3.3">𝐷</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.3c">H_{o}:(B,T,D)</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.3d">italic_H start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT : ( italic_B , italic_T , italic_D )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span><math alttext="H_{x}:(B,T,ED)\leftarrow\operatorname{Linear}(H_{i})" class="ltx_Math" display="inline" id="alg1.l3.m1.5"><semantics id="alg1.l3.m1.5a"><mrow id="alg1.l3.m1.5.5" xref="alg1.l3.m1.5.5.cmml"><msub id="alg1.l3.m1.5.5.4" xref="alg1.l3.m1.5.5.4.cmml"><mi id="alg1.l3.m1.5.5.4.2" xref="alg1.l3.m1.5.5.4.2.cmml">H</mi><mi id="alg1.l3.m1.5.5.4.3" xref="alg1.l3.m1.5.5.4.3.cmml">x</mi></msub><mo id="alg1.l3.m1.5.5.3" lspace="0.278em" rspace="0.278em" xref="alg1.l3.m1.5.5.3.cmml">:</mo><mrow id="alg1.l3.m1.5.5.2" xref="alg1.l3.m1.5.5.2.cmml"><mrow id="alg1.l3.m1.4.4.1.1.1" xref="alg1.l3.m1.4.4.1.1.2.cmml"><mo id="alg1.l3.m1.4.4.1.1.1.2" stretchy="false" xref="alg1.l3.m1.4.4.1.1.2.cmml">(</mo><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">B</mi><mo id="alg1.l3.m1.4.4.1.1.1.3" xref="alg1.l3.m1.4.4.1.1.2.cmml">,</mo><mi id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">T</mi><mo id="alg1.l3.m1.4.4.1.1.1.4" xref="alg1.l3.m1.4.4.1.1.2.cmml">,</mo><mrow id="alg1.l3.m1.4.4.1.1.1.1" xref="alg1.l3.m1.4.4.1.1.1.1.cmml"><mi id="alg1.l3.m1.4.4.1.1.1.1.2" xref="alg1.l3.m1.4.4.1.1.1.1.2.cmml">E</mi><mo id="alg1.l3.m1.4.4.1.1.1.1.1" xref="alg1.l3.m1.4.4.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l3.m1.4.4.1.1.1.1.3" xref="alg1.l3.m1.4.4.1.1.1.1.3.cmml">D</mi></mrow><mo id="alg1.l3.m1.4.4.1.1.1.5" stretchy="false" xref="alg1.l3.m1.4.4.1.1.2.cmml">)</mo></mrow><mo id="alg1.l3.m1.5.5.2.3" stretchy="false" xref="alg1.l3.m1.5.5.2.3.cmml">←</mo><mrow id="alg1.l3.m1.5.5.2.2.1" xref="alg1.l3.m1.5.5.2.2.2.cmml"><mi id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml">Linear</mi><mo id="alg1.l3.m1.5.5.2.2.1a" xref="alg1.l3.m1.5.5.2.2.2.cmml">⁡</mo><mrow id="alg1.l3.m1.5.5.2.2.1.1" xref="alg1.l3.m1.5.5.2.2.2.cmml"><mo id="alg1.l3.m1.5.5.2.2.1.1.2" stretchy="false" xref="alg1.l3.m1.5.5.2.2.2.cmml">(</mo><msub id="alg1.l3.m1.5.5.2.2.1.1.1" xref="alg1.l3.m1.5.5.2.2.1.1.1.cmml"><mi id="alg1.l3.m1.5.5.2.2.1.1.1.2" xref="alg1.l3.m1.5.5.2.2.1.1.1.2.cmml">H</mi><mi id="alg1.l3.m1.5.5.2.2.1.1.1.3" xref="alg1.l3.m1.5.5.2.2.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l3.m1.5.5.2.2.1.1.3" stretchy="false" xref="alg1.l3.m1.5.5.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.5b"><apply id="alg1.l3.m1.5.5.cmml" xref="alg1.l3.m1.5.5"><ci id="alg1.l3.m1.5.5.3.cmml" xref="alg1.l3.m1.5.5.3">:</ci><apply id="alg1.l3.m1.5.5.4.cmml" xref="alg1.l3.m1.5.5.4"><csymbol cd="ambiguous" id="alg1.l3.m1.5.5.4.1.cmml" xref="alg1.l3.m1.5.5.4">subscript</csymbol><ci id="alg1.l3.m1.5.5.4.2.cmml" xref="alg1.l3.m1.5.5.4.2">𝐻</ci><ci id="alg1.l3.m1.5.5.4.3.cmml" xref="alg1.l3.m1.5.5.4.3">𝑥</ci></apply><apply id="alg1.l3.m1.5.5.2.cmml" xref="alg1.l3.m1.5.5.2"><ci id="alg1.l3.m1.5.5.2.3.cmml" xref="alg1.l3.m1.5.5.2.3">←</ci><vector id="alg1.l3.m1.4.4.1.1.2.cmml" xref="alg1.l3.m1.4.4.1.1.1"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝐵</ci><ci id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">𝑇</ci><apply id="alg1.l3.m1.4.4.1.1.1.1.cmml" xref="alg1.l3.m1.4.4.1.1.1.1"><times id="alg1.l3.m1.4.4.1.1.1.1.1.cmml" xref="alg1.l3.m1.4.4.1.1.1.1.1"></times><ci id="alg1.l3.m1.4.4.1.1.1.1.2.cmml" xref="alg1.l3.m1.4.4.1.1.1.1.2">𝐸</ci><ci id="alg1.l3.m1.4.4.1.1.1.1.3.cmml" xref="alg1.l3.m1.4.4.1.1.1.1.3">𝐷</ci></apply></vector><apply id="alg1.l3.m1.5.5.2.2.2.cmml" xref="alg1.l3.m1.5.5.2.2.1"><ci id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3">Linear</ci><apply id="alg1.l3.m1.5.5.2.2.1.1.1.cmml" xref="alg1.l3.m1.5.5.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.5.5.2.2.1.1.1.1.cmml" xref="alg1.l3.m1.5.5.2.2.1.1.1">subscript</csymbol><ci id="alg1.l3.m1.5.5.2.2.1.1.1.2.cmml" xref="alg1.l3.m1.5.5.2.2.1.1.1.2">𝐻</ci><ci id="alg1.l3.m1.5.5.2.2.1.1.1.3.cmml" xref="alg1.l3.m1.5.5.2.2.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.5c">H_{x}:(B,T,ED)\leftarrow\operatorname{Linear}(H_{i})</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.5d">italic_H start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT : ( italic_B , italic_T , italic_E italic_D ) ← roman_Linear ( italic_H start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span><math alttext="H_{z}:(B,T,ED)\leftarrow\operatorname{Linear}(H_{i})" class="ltx_Math" display="inline" id="alg1.l4.m1.5"><semantics id="alg1.l4.m1.5a"><mrow id="alg1.l4.m1.5.5" xref="alg1.l4.m1.5.5.cmml"><msub id="alg1.l4.m1.5.5.4" xref="alg1.l4.m1.5.5.4.cmml"><mi id="alg1.l4.m1.5.5.4.2" xref="alg1.l4.m1.5.5.4.2.cmml">H</mi><mi id="alg1.l4.m1.5.5.4.3" xref="alg1.l4.m1.5.5.4.3.cmml">z</mi></msub><mo id="alg1.l4.m1.5.5.3" lspace="0.278em" rspace="0.278em" xref="alg1.l4.m1.5.5.3.cmml">:</mo><mrow id="alg1.l4.m1.5.5.2" xref="alg1.l4.m1.5.5.2.cmml"><mrow id="alg1.l4.m1.4.4.1.1.1" xref="alg1.l4.m1.4.4.1.1.2.cmml"><mo id="alg1.l4.m1.4.4.1.1.1.2" stretchy="false" xref="alg1.l4.m1.4.4.1.1.2.cmml">(</mo><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">B</mi><mo id="alg1.l4.m1.4.4.1.1.1.3" xref="alg1.l4.m1.4.4.1.1.2.cmml">,</mo><mi id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml">T</mi><mo id="alg1.l4.m1.4.4.1.1.1.4" xref="alg1.l4.m1.4.4.1.1.2.cmml">,</mo><mrow id="alg1.l4.m1.4.4.1.1.1.1" xref="alg1.l4.m1.4.4.1.1.1.1.cmml"><mi id="alg1.l4.m1.4.4.1.1.1.1.2" xref="alg1.l4.m1.4.4.1.1.1.1.2.cmml">E</mi><mo id="alg1.l4.m1.4.4.1.1.1.1.1" xref="alg1.l4.m1.4.4.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l4.m1.4.4.1.1.1.1.3" xref="alg1.l4.m1.4.4.1.1.1.1.3.cmml">D</mi></mrow><mo id="alg1.l4.m1.4.4.1.1.1.5" stretchy="false" xref="alg1.l4.m1.4.4.1.1.2.cmml">)</mo></mrow><mo id="alg1.l4.m1.5.5.2.3" stretchy="false" xref="alg1.l4.m1.5.5.2.3.cmml">←</mo><mrow id="alg1.l4.m1.5.5.2.2.1" xref="alg1.l4.m1.5.5.2.2.2.cmml"><mi id="alg1.l4.m1.3.3" xref="alg1.l4.m1.3.3.cmml">Linear</mi><mo id="alg1.l4.m1.5.5.2.2.1a" xref="alg1.l4.m1.5.5.2.2.2.cmml">⁡</mo><mrow id="alg1.l4.m1.5.5.2.2.1.1" xref="alg1.l4.m1.5.5.2.2.2.cmml"><mo id="alg1.l4.m1.5.5.2.2.1.1.2" stretchy="false" xref="alg1.l4.m1.5.5.2.2.2.cmml">(</mo><msub id="alg1.l4.m1.5.5.2.2.1.1.1" xref="alg1.l4.m1.5.5.2.2.1.1.1.cmml"><mi id="alg1.l4.m1.5.5.2.2.1.1.1.2" xref="alg1.l4.m1.5.5.2.2.1.1.1.2.cmml">H</mi><mi id="alg1.l4.m1.5.5.2.2.1.1.1.3" xref="alg1.l4.m1.5.5.2.2.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l4.m1.5.5.2.2.1.1.3" stretchy="false" xref="alg1.l4.m1.5.5.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.5b"><apply id="alg1.l4.m1.5.5.cmml" xref="alg1.l4.m1.5.5"><ci id="alg1.l4.m1.5.5.3.cmml" xref="alg1.l4.m1.5.5.3">:</ci><apply id="alg1.l4.m1.5.5.4.cmml" xref="alg1.l4.m1.5.5.4"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.4.1.cmml" xref="alg1.l4.m1.5.5.4">subscript</csymbol><ci id="alg1.l4.m1.5.5.4.2.cmml" xref="alg1.l4.m1.5.5.4.2">𝐻</ci><ci id="alg1.l4.m1.5.5.4.3.cmml" xref="alg1.l4.m1.5.5.4.3">𝑧</ci></apply><apply id="alg1.l4.m1.5.5.2.cmml" xref="alg1.l4.m1.5.5.2"><ci id="alg1.l4.m1.5.5.2.3.cmml" xref="alg1.l4.m1.5.5.2.3">←</ci><vector id="alg1.l4.m1.4.4.1.1.2.cmml" xref="alg1.l4.m1.4.4.1.1.1"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝐵</ci><ci id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2">𝑇</ci><apply id="alg1.l4.m1.4.4.1.1.1.1.cmml" xref="alg1.l4.m1.4.4.1.1.1.1"><times id="alg1.l4.m1.4.4.1.1.1.1.1.cmml" xref="alg1.l4.m1.4.4.1.1.1.1.1"></times><ci id="alg1.l4.m1.4.4.1.1.1.1.2.cmml" xref="alg1.l4.m1.4.4.1.1.1.1.2">𝐸</ci><ci id="alg1.l4.m1.4.4.1.1.1.1.3.cmml" xref="alg1.l4.m1.4.4.1.1.1.1.3">𝐷</ci></apply></vector><apply id="alg1.l4.m1.5.5.2.2.2.cmml" xref="alg1.l4.m1.5.5.2.2.1"><ci id="alg1.l4.m1.3.3.cmml" xref="alg1.l4.m1.3.3">Linear</ci><apply id="alg1.l4.m1.5.5.2.2.1.1.1.cmml" xref="alg1.l4.m1.5.5.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.2.2.1.1.1.1.cmml" xref="alg1.l4.m1.5.5.2.2.1.1.1">subscript</csymbol><ci id="alg1.l4.m1.5.5.2.2.1.1.1.2.cmml" xref="alg1.l4.m1.5.5.2.2.1.1.1.2">𝐻</ci><ci id="alg1.l4.m1.5.5.2.2.1.1.1.3.cmml" xref="alg1.l4.m1.5.5.2.2.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.5c">H_{z}:(B,T,ED)\leftarrow\operatorname{Linear}(H_{i})</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.5d">italic_H start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT : ( italic_B , italic_T , italic_E italic_D ) ← roman_Linear ( italic_H start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.2.1.1" style="font-size:80%;">5:</span></span><span class="ltx_text" id="alg1.l5.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l5.1.m1.1"><semantics id="alg1.l5.1.m1.1a"><mo id="alg1.l5.1.m1.1.1" xref="alg1.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l5.1.m1.1b"><ci id="alg1.l5.1.m1.1.1.cmml" xref="alg1.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.1.m1.1d">▷</annotation></semantics></math> Linear projections to expand dimensions
</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span><math alttext="H^{\prime}_{x}:(B,T,ED)\leftarrow\operatorname{SiLU}(\operatorname{Conv1d}(H_{%
x}))" class="ltx_Math" display="inline" id="alg1.l6.m1.6"><semantics id="alg1.l6.m1.6a"><mrow id="alg1.l6.m1.6.6" xref="alg1.l6.m1.6.6.cmml"><msubsup id="alg1.l6.m1.6.6.4" xref="alg1.l6.m1.6.6.4.cmml"><mi id="alg1.l6.m1.6.6.4.2.2" xref="alg1.l6.m1.6.6.4.2.2.cmml">H</mi><mi id="alg1.l6.m1.6.6.4.3" xref="alg1.l6.m1.6.6.4.3.cmml">x</mi><mo id="alg1.l6.m1.6.6.4.2.3" xref="alg1.l6.m1.6.6.4.2.3.cmml">′</mo></msubsup><mo id="alg1.l6.m1.6.6.3" lspace="0.278em" rspace="0.278em" xref="alg1.l6.m1.6.6.3.cmml">:</mo><mrow id="alg1.l6.m1.6.6.2" xref="alg1.l6.m1.6.6.2.cmml"><mrow id="alg1.l6.m1.5.5.1.1.1" xref="alg1.l6.m1.5.5.1.1.2.cmml"><mo id="alg1.l6.m1.5.5.1.1.1.2" stretchy="false" xref="alg1.l6.m1.5.5.1.1.2.cmml">(</mo><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">B</mi><mo id="alg1.l6.m1.5.5.1.1.1.3" xref="alg1.l6.m1.5.5.1.1.2.cmml">,</mo><mi id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml">T</mi><mo id="alg1.l6.m1.5.5.1.1.1.4" xref="alg1.l6.m1.5.5.1.1.2.cmml">,</mo><mrow id="alg1.l6.m1.5.5.1.1.1.1" xref="alg1.l6.m1.5.5.1.1.1.1.cmml"><mi id="alg1.l6.m1.5.5.1.1.1.1.2" xref="alg1.l6.m1.5.5.1.1.1.1.2.cmml">E</mi><mo id="alg1.l6.m1.5.5.1.1.1.1.1" xref="alg1.l6.m1.5.5.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l6.m1.5.5.1.1.1.1.3" xref="alg1.l6.m1.5.5.1.1.1.1.3.cmml">D</mi></mrow><mo id="alg1.l6.m1.5.5.1.1.1.5" stretchy="false" xref="alg1.l6.m1.5.5.1.1.2.cmml">)</mo></mrow><mo id="alg1.l6.m1.6.6.2.3" stretchy="false" xref="alg1.l6.m1.6.6.2.3.cmml">←</mo><mrow id="alg1.l6.m1.6.6.2.2.1" xref="alg1.l6.m1.6.6.2.2.2.cmml"><mi id="alg1.l6.m1.4.4" xref="alg1.l6.m1.4.4.cmml">SiLU</mi><mo id="alg1.l6.m1.6.6.2.2.1a" xref="alg1.l6.m1.6.6.2.2.2.cmml">⁡</mo><mrow id="alg1.l6.m1.6.6.2.2.1.1" xref="alg1.l6.m1.6.6.2.2.2.cmml"><mo id="alg1.l6.m1.6.6.2.2.1.1.2" stretchy="false" xref="alg1.l6.m1.6.6.2.2.2.cmml">(</mo><mrow id="alg1.l6.m1.6.6.2.2.1.1.1.1" xref="alg1.l6.m1.6.6.2.2.1.1.1.2.cmml"><mi id="alg1.l6.m1.3.3" xref="alg1.l6.m1.3.3.cmml">Conv1d</mi><mo id="alg1.l6.m1.6.6.2.2.1.1.1.1a" xref="alg1.l6.m1.6.6.2.2.1.1.1.2.cmml">⁡</mo><mrow id="alg1.l6.m1.6.6.2.2.1.1.1.1.1" xref="alg1.l6.m1.6.6.2.2.1.1.1.2.cmml"><mo id="alg1.l6.m1.6.6.2.2.1.1.1.1.1.2" stretchy="false" xref="alg1.l6.m1.6.6.2.2.1.1.1.2.cmml">(</mo><msub id="alg1.l6.m1.6.6.2.2.1.1.1.1.1.1" xref="alg1.l6.m1.6.6.2.2.1.1.1.1.1.1.cmml"><mi id="alg1.l6.m1.6.6.2.2.1.1.1.1.1.1.2" xref="alg1.l6.m1.6.6.2.2.1.1.1.1.1.1.2.cmml">H</mi><mi id="alg1.l6.m1.6.6.2.2.1.1.1.1.1.1.3" xref="alg1.l6.m1.6.6.2.2.1.1.1.1.1.1.3.cmml">x</mi></msub><mo id="alg1.l6.m1.6.6.2.2.1.1.1.1.1.3" stretchy="false" xref="alg1.l6.m1.6.6.2.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="alg1.l6.m1.6.6.2.2.1.1.3" stretchy="false" xref="alg1.l6.m1.6.6.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.6b"><apply id="alg1.l6.m1.6.6.cmml" xref="alg1.l6.m1.6.6"><ci id="alg1.l6.m1.6.6.3.cmml" xref="alg1.l6.m1.6.6.3">:</ci><apply id="alg1.l6.m1.6.6.4.cmml" xref="alg1.l6.m1.6.6.4"><csymbol cd="ambiguous" id="alg1.l6.m1.6.6.4.1.cmml" xref="alg1.l6.m1.6.6.4">subscript</csymbol><apply id="alg1.l6.m1.6.6.4.2.cmml" xref="alg1.l6.m1.6.6.4"><csymbol cd="ambiguous" id="alg1.l6.m1.6.6.4.2.1.cmml" xref="alg1.l6.m1.6.6.4">superscript</csymbol><ci id="alg1.l6.m1.6.6.4.2.2.cmml" xref="alg1.l6.m1.6.6.4.2.2">𝐻</ci><ci id="alg1.l6.m1.6.6.4.2.3.cmml" xref="alg1.l6.m1.6.6.4.2.3">′</ci></apply><ci id="alg1.l6.m1.6.6.4.3.cmml" xref="alg1.l6.m1.6.6.4.3">𝑥</ci></apply><apply id="alg1.l6.m1.6.6.2.cmml" xref="alg1.l6.m1.6.6.2"><ci id="alg1.l6.m1.6.6.2.3.cmml" xref="alg1.l6.m1.6.6.2.3">←</ci><vector id="alg1.l6.m1.5.5.1.1.2.cmml" xref="alg1.l6.m1.5.5.1.1.1"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝐵</ci><ci id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2">𝑇</ci><apply id="alg1.l6.m1.5.5.1.1.1.1.cmml" xref="alg1.l6.m1.5.5.1.1.1.1"><times id="alg1.l6.m1.5.5.1.1.1.1.1.cmml" xref="alg1.l6.m1.5.5.1.1.1.1.1"></times><ci id="alg1.l6.m1.5.5.1.1.1.1.2.cmml" xref="alg1.l6.m1.5.5.1.1.1.1.2">𝐸</ci><ci id="alg1.l6.m1.5.5.1.1.1.1.3.cmml" xref="alg1.l6.m1.5.5.1.1.1.1.3">𝐷</ci></apply></vector><apply id="alg1.l6.m1.6.6.2.2.2.cmml" xref="alg1.l6.m1.6.6.2.2.1"><ci id="alg1.l6.m1.4.4.cmml" xref="alg1.l6.m1.4.4">SiLU</ci><apply id="alg1.l6.m1.6.6.2.2.1.1.1.2.cmml" xref="alg1.l6.m1.6.6.2.2.1.1.1.1"><ci id="alg1.l6.m1.3.3.cmml" xref="alg1.l6.m1.3.3">Conv1d</ci><apply id="alg1.l6.m1.6.6.2.2.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.6.6.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.6.6.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.6.6.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.6.6.2.2.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.6.6.2.2.1.1.1.1.1.1.2">𝐻</ci><ci id="alg1.l6.m1.6.6.2.2.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.6.6.2.2.1.1.1.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.6c">H^{\prime}_{x}:(B,T,ED)\leftarrow\operatorname{SiLU}(\operatorname{Conv1d}(H_{%
x}))</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.6d">italic_H start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT : ( italic_B , italic_T , italic_E italic_D ) ← roman_SiLU ( Conv1d ( italic_H start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ) )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span><math alttext="H_{y}:(B,T,ED)\leftarrow\text{BD-LRU}(H^{\prime}_{x})" class="ltx_Math" display="inline" id="alg1.l7.m1.4"><semantics id="alg1.l7.m1.4a"><mrow id="alg1.l7.m1.4.4" xref="alg1.l7.m1.4.4.cmml"><msub id="alg1.l7.m1.4.4.4" xref="alg1.l7.m1.4.4.4.cmml"><mi id="alg1.l7.m1.4.4.4.2" xref="alg1.l7.m1.4.4.4.2.cmml">H</mi><mi id="alg1.l7.m1.4.4.4.3" xref="alg1.l7.m1.4.4.4.3.cmml">y</mi></msub><mo id="alg1.l7.m1.4.4.3" lspace="0.278em" rspace="0.278em" xref="alg1.l7.m1.4.4.3.cmml">:</mo><mrow id="alg1.l7.m1.4.4.2" xref="alg1.l7.m1.4.4.2.cmml"><mrow id="alg1.l7.m1.3.3.1.1.1" xref="alg1.l7.m1.3.3.1.1.2.cmml"><mo id="alg1.l7.m1.3.3.1.1.1.2" stretchy="false" xref="alg1.l7.m1.3.3.1.1.2.cmml">(</mo><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">B</mi><mo id="alg1.l7.m1.3.3.1.1.1.3" xref="alg1.l7.m1.3.3.1.1.2.cmml">,</mo><mi id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml">T</mi><mo id="alg1.l7.m1.3.3.1.1.1.4" xref="alg1.l7.m1.3.3.1.1.2.cmml">,</mo><mrow id="alg1.l7.m1.3.3.1.1.1.1" xref="alg1.l7.m1.3.3.1.1.1.1.cmml"><mi id="alg1.l7.m1.3.3.1.1.1.1.2" xref="alg1.l7.m1.3.3.1.1.1.1.2.cmml">E</mi><mo id="alg1.l7.m1.3.3.1.1.1.1.1" xref="alg1.l7.m1.3.3.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l7.m1.3.3.1.1.1.1.3" xref="alg1.l7.m1.3.3.1.1.1.1.3.cmml">D</mi></mrow><mo id="alg1.l7.m1.3.3.1.1.1.5" stretchy="false" xref="alg1.l7.m1.3.3.1.1.2.cmml">)</mo></mrow><mo id="alg1.l7.m1.4.4.2.3" stretchy="false" xref="alg1.l7.m1.4.4.2.3.cmml">←</mo><mrow id="alg1.l7.m1.4.4.2.2" xref="alg1.l7.m1.4.4.2.2.cmml"><mtext id="alg1.l7.m1.4.4.2.2.3" xref="alg1.l7.m1.4.4.2.2.3a.cmml">BD-LRU</mtext><mo id="alg1.l7.m1.4.4.2.2.2" xref="alg1.l7.m1.4.4.2.2.2.cmml">⁢</mo><mrow id="alg1.l7.m1.4.4.2.2.1.1" xref="alg1.l7.m1.4.4.2.2.1.1.1.cmml"><mo id="alg1.l7.m1.4.4.2.2.1.1.2" stretchy="false" xref="alg1.l7.m1.4.4.2.2.1.1.1.cmml">(</mo><msubsup id="alg1.l7.m1.4.4.2.2.1.1.1" xref="alg1.l7.m1.4.4.2.2.1.1.1.cmml"><mi id="alg1.l7.m1.4.4.2.2.1.1.1.2.2" xref="alg1.l7.m1.4.4.2.2.1.1.1.2.2.cmml">H</mi><mi id="alg1.l7.m1.4.4.2.2.1.1.1.3" xref="alg1.l7.m1.4.4.2.2.1.1.1.3.cmml">x</mi><mo id="alg1.l7.m1.4.4.2.2.1.1.1.2.3" xref="alg1.l7.m1.4.4.2.2.1.1.1.2.3.cmml">′</mo></msubsup><mo id="alg1.l7.m1.4.4.2.2.1.1.3" stretchy="false" xref="alg1.l7.m1.4.4.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.4b"><apply id="alg1.l7.m1.4.4.cmml" xref="alg1.l7.m1.4.4"><ci id="alg1.l7.m1.4.4.3.cmml" xref="alg1.l7.m1.4.4.3">:</ci><apply id="alg1.l7.m1.4.4.4.cmml" xref="alg1.l7.m1.4.4.4"><csymbol cd="ambiguous" id="alg1.l7.m1.4.4.4.1.cmml" xref="alg1.l7.m1.4.4.4">subscript</csymbol><ci id="alg1.l7.m1.4.4.4.2.cmml" xref="alg1.l7.m1.4.4.4.2">𝐻</ci><ci id="alg1.l7.m1.4.4.4.3.cmml" xref="alg1.l7.m1.4.4.4.3">𝑦</ci></apply><apply id="alg1.l7.m1.4.4.2.cmml" xref="alg1.l7.m1.4.4.2"><ci id="alg1.l7.m1.4.4.2.3.cmml" xref="alg1.l7.m1.4.4.2.3">←</ci><vector id="alg1.l7.m1.3.3.1.1.2.cmml" xref="alg1.l7.m1.3.3.1.1.1"><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝐵</ci><ci id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2">𝑇</ci><apply id="alg1.l7.m1.3.3.1.1.1.1.cmml" xref="alg1.l7.m1.3.3.1.1.1.1"><times id="alg1.l7.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.1"></times><ci id="alg1.l7.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.2">𝐸</ci><ci id="alg1.l7.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.3">𝐷</ci></apply></vector><apply id="alg1.l7.m1.4.4.2.2.cmml" xref="alg1.l7.m1.4.4.2.2"><times id="alg1.l7.m1.4.4.2.2.2.cmml" xref="alg1.l7.m1.4.4.2.2.2"></times><ci id="alg1.l7.m1.4.4.2.2.3a.cmml" xref="alg1.l7.m1.4.4.2.2.3"><mtext id="alg1.l7.m1.4.4.2.2.3.cmml" xref="alg1.l7.m1.4.4.2.2.3">BD-LRU</mtext></ci><apply id="alg1.l7.m1.4.4.2.2.1.1.1.cmml" xref="alg1.l7.m1.4.4.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.4.4.2.2.1.1.1.1.cmml" xref="alg1.l7.m1.4.4.2.2.1.1">subscript</csymbol><apply id="alg1.l7.m1.4.4.2.2.1.1.1.2.cmml" xref="alg1.l7.m1.4.4.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.4.4.2.2.1.1.1.2.1.cmml" xref="alg1.l7.m1.4.4.2.2.1.1">superscript</csymbol><ci id="alg1.l7.m1.4.4.2.2.1.1.1.2.2.cmml" xref="alg1.l7.m1.4.4.2.2.1.1.1.2.2">𝐻</ci><ci id="alg1.l7.m1.4.4.2.2.1.1.1.2.3.cmml" xref="alg1.l7.m1.4.4.2.2.1.1.1.2.3">′</ci></apply><ci id="alg1.l7.m1.4.4.2.2.1.1.1.3.cmml" xref="alg1.l7.m1.4.4.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.4c">H_{y}:(B,T,ED)\leftarrow\text{BD-LRU}(H^{\prime}_{x})</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.4d">italic_H start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT : ( italic_B , italic_T , italic_E italic_D ) ← BD-LRU ( italic_H start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.2.1.1" style="font-size:80%;">8:</span></span><math alttext="H^{\prime}_{y}:(B,T,ED)\leftarrow H_{y}\otimes\operatorname{SiLU}(H_{z})" class="ltx_Math" display="inline" id="alg1.l8.m1.5"><semantics id="alg1.l8.m1.5a"><mrow id="alg1.l8.m1.5.5" xref="alg1.l8.m1.5.5.cmml"><msubsup id="alg1.l8.m1.5.5.4" xref="alg1.l8.m1.5.5.4.cmml"><mi id="alg1.l8.m1.5.5.4.2.2" xref="alg1.l8.m1.5.5.4.2.2.cmml">H</mi><mi id="alg1.l8.m1.5.5.4.3" xref="alg1.l8.m1.5.5.4.3.cmml">y</mi><mo id="alg1.l8.m1.5.5.4.2.3" xref="alg1.l8.m1.5.5.4.2.3.cmml">′</mo></msubsup><mo id="alg1.l8.m1.5.5.3" lspace="0.278em" rspace="0.278em" xref="alg1.l8.m1.5.5.3.cmml">:</mo><mrow id="alg1.l8.m1.5.5.2" xref="alg1.l8.m1.5.5.2.cmml"><mrow id="alg1.l8.m1.4.4.1.1.1" xref="alg1.l8.m1.4.4.1.1.2.cmml"><mo id="alg1.l8.m1.4.4.1.1.1.2" stretchy="false" xref="alg1.l8.m1.4.4.1.1.2.cmml">(</mo><mi id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">B</mi><mo id="alg1.l8.m1.4.4.1.1.1.3" xref="alg1.l8.m1.4.4.1.1.2.cmml">,</mo><mi id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml">T</mi><mo id="alg1.l8.m1.4.4.1.1.1.4" xref="alg1.l8.m1.4.4.1.1.2.cmml">,</mo><mrow id="alg1.l8.m1.4.4.1.1.1.1" xref="alg1.l8.m1.4.4.1.1.1.1.cmml"><mi id="alg1.l8.m1.4.4.1.1.1.1.2" xref="alg1.l8.m1.4.4.1.1.1.1.2.cmml">E</mi><mo id="alg1.l8.m1.4.4.1.1.1.1.1" xref="alg1.l8.m1.4.4.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m1.4.4.1.1.1.1.3" xref="alg1.l8.m1.4.4.1.1.1.1.3.cmml">D</mi></mrow><mo id="alg1.l8.m1.4.4.1.1.1.5" stretchy="false" xref="alg1.l8.m1.4.4.1.1.2.cmml">)</mo></mrow><mo id="alg1.l8.m1.5.5.2.3" stretchy="false" xref="alg1.l8.m1.5.5.2.3.cmml">←</mo><mrow id="alg1.l8.m1.5.5.2.2" xref="alg1.l8.m1.5.5.2.2.cmml"><msub id="alg1.l8.m1.5.5.2.2.3" xref="alg1.l8.m1.5.5.2.2.3.cmml"><mi id="alg1.l8.m1.5.5.2.2.3.2" xref="alg1.l8.m1.5.5.2.2.3.2.cmml">H</mi><mi id="alg1.l8.m1.5.5.2.2.3.3" xref="alg1.l8.m1.5.5.2.2.3.3.cmml">y</mi></msub><mo id="alg1.l8.m1.5.5.2.2.2" lspace="0.222em" rspace="0.222em" xref="alg1.l8.m1.5.5.2.2.2.cmml">⊗</mo><mrow id="alg1.l8.m1.5.5.2.2.1.1" xref="alg1.l8.m1.5.5.2.2.1.2.cmml"><mi id="alg1.l8.m1.3.3" xref="alg1.l8.m1.3.3.cmml">SiLU</mi><mo id="alg1.l8.m1.5.5.2.2.1.1a" xref="alg1.l8.m1.5.5.2.2.1.2.cmml">⁡</mo><mrow id="alg1.l8.m1.5.5.2.2.1.1.1" xref="alg1.l8.m1.5.5.2.2.1.2.cmml"><mo id="alg1.l8.m1.5.5.2.2.1.1.1.2" stretchy="false" xref="alg1.l8.m1.5.5.2.2.1.2.cmml">(</mo><msub id="alg1.l8.m1.5.5.2.2.1.1.1.1" xref="alg1.l8.m1.5.5.2.2.1.1.1.1.cmml"><mi id="alg1.l8.m1.5.5.2.2.1.1.1.1.2" xref="alg1.l8.m1.5.5.2.2.1.1.1.1.2.cmml">H</mi><mi id="alg1.l8.m1.5.5.2.2.1.1.1.1.3" xref="alg1.l8.m1.5.5.2.2.1.1.1.1.3.cmml">z</mi></msub><mo id="alg1.l8.m1.5.5.2.2.1.1.1.3" stretchy="false" xref="alg1.l8.m1.5.5.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.5b"><apply id="alg1.l8.m1.5.5.cmml" xref="alg1.l8.m1.5.5"><ci id="alg1.l8.m1.5.5.3.cmml" xref="alg1.l8.m1.5.5.3">:</ci><apply id="alg1.l8.m1.5.5.4.cmml" xref="alg1.l8.m1.5.5.4"><csymbol cd="ambiguous" id="alg1.l8.m1.5.5.4.1.cmml" xref="alg1.l8.m1.5.5.4">subscript</csymbol><apply id="alg1.l8.m1.5.5.4.2.cmml" xref="alg1.l8.m1.5.5.4"><csymbol cd="ambiguous" id="alg1.l8.m1.5.5.4.2.1.cmml" xref="alg1.l8.m1.5.5.4">superscript</csymbol><ci id="alg1.l8.m1.5.5.4.2.2.cmml" xref="alg1.l8.m1.5.5.4.2.2">𝐻</ci><ci id="alg1.l8.m1.5.5.4.2.3.cmml" xref="alg1.l8.m1.5.5.4.2.3">′</ci></apply><ci id="alg1.l8.m1.5.5.4.3.cmml" xref="alg1.l8.m1.5.5.4.3">𝑦</ci></apply><apply id="alg1.l8.m1.5.5.2.cmml" xref="alg1.l8.m1.5.5.2"><ci id="alg1.l8.m1.5.5.2.3.cmml" xref="alg1.l8.m1.5.5.2.3">←</ci><vector id="alg1.l8.m1.4.4.1.1.2.cmml" xref="alg1.l8.m1.4.4.1.1.1"><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝐵</ci><ci id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2">𝑇</ci><apply id="alg1.l8.m1.4.4.1.1.1.1.cmml" xref="alg1.l8.m1.4.4.1.1.1.1"><times id="alg1.l8.m1.4.4.1.1.1.1.1.cmml" xref="alg1.l8.m1.4.4.1.1.1.1.1"></times><ci id="alg1.l8.m1.4.4.1.1.1.1.2.cmml" xref="alg1.l8.m1.4.4.1.1.1.1.2">𝐸</ci><ci id="alg1.l8.m1.4.4.1.1.1.1.3.cmml" xref="alg1.l8.m1.4.4.1.1.1.1.3">𝐷</ci></apply></vector><apply id="alg1.l8.m1.5.5.2.2.cmml" xref="alg1.l8.m1.5.5.2.2"><csymbol cd="latexml" id="alg1.l8.m1.5.5.2.2.2.cmml" xref="alg1.l8.m1.5.5.2.2.2">tensor-product</csymbol><apply id="alg1.l8.m1.5.5.2.2.3.cmml" xref="alg1.l8.m1.5.5.2.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.5.5.2.2.3.1.cmml" xref="alg1.l8.m1.5.5.2.2.3">subscript</csymbol><ci id="alg1.l8.m1.5.5.2.2.3.2.cmml" xref="alg1.l8.m1.5.5.2.2.3.2">𝐻</ci><ci id="alg1.l8.m1.5.5.2.2.3.3.cmml" xref="alg1.l8.m1.5.5.2.2.3.3">𝑦</ci></apply><apply id="alg1.l8.m1.5.5.2.2.1.2.cmml" xref="alg1.l8.m1.5.5.2.2.1.1"><ci id="alg1.l8.m1.3.3.cmml" xref="alg1.l8.m1.3.3">SiLU</ci><apply id="alg1.l8.m1.5.5.2.2.1.1.1.1.cmml" xref="alg1.l8.m1.5.5.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.5.5.2.2.1.1.1.1.1.cmml" xref="alg1.l8.m1.5.5.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l8.m1.5.5.2.2.1.1.1.1.2.cmml" xref="alg1.l8.m1.5.5.2.2.1.1.1.1.2">𝐻</ci><ci id="alg1.l8.m1.5.5.2.2.1.1.1.1.3.cmml" xref="alg1.l8.m1.5.5.2.2.1.1.1.1.3">𝑧</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.5c">H^{\prime}_{y}:(B,T,ED)\leftarrow H_{y}\otimes\operatorname{SiLU}(H_{z})</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.5d">italic_H start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT : ( italic_B , italic_T , italic_E italic_D ) ← italic_H start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ⊗ roman_SiLU ( italic_H start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT )</annotation></semantics></math>
<span class="ltx_text" id="alg1.l8.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l8.1.m1.1"><semantics id="alg1.l8.1.m1.1a"><mo id="alg1.l8.1.m1.1.1" xref="alg1.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l8.1.m1.1b"><ci id="alg1.l8.1.m1.1.1.cmml" xref="alg1.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.1.m1.1d">▷</annotation></semantics></math> Merge two branches
</span>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span><math alttext="H_{o}:(B,T,D)\leftarrow\operatorname{Linear}(H^{\prime}_{y})" class="ltx_Math" display="inline" id="alg1.l9.m1.5"><semantics id="alg1.l9.m1.5a"><mrow id="alg1.l9.m1.5.5" xref="alg1.l9.m1.5.5.cmml"><msub id="alg1.l9.m1.5.5.3" xref="alg1.l9.m1.5.5.3.cmml"><mi id="alg1.l9.m1.5.5.3.2" xref="alg1.l9.m1.5.5.3.2.cmml">H</mi><mi id="alg1.l9.m1.5.5.3.3" xref="alg1.l9.m1.5.5.3.3.cmml">o</mi></msub><mo id="alg1.l9.m1.5.5.2" lspace="0.278em" rspace="0.278em" xref="alg1.l9.m1.5.5.2.cmml">:</mo><mrow id="alg1.l9.m1.5.5.1" xref="alg1.l9.m1.5.5.1.cmml"><mrow id="alg1.l9.m1.5.5.1.3.2" xref="alg1.l9.m1.5.5.1.3.1.cmml"><mo id="alg1.l9.m1.5.5.1.3.2.1" stretchy="false" xref="alg1.l9.m1.5.5.1.3.1.cmml">(</mo><mi id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">B</mi><mo id="alg1.l9.m1.5.5.1.3.2.2" xref="alg1.l9.m1.5.5.1.3.1.cmml">,</mo><mi id="alg1.l9.m1.2.2" xref="alg1.l9.m1.2.2.cmml">T</mi><mo id="alg1.l9.m1.5.5.1.3.2.3" xref="alg1.l9.m1.5.5.1.3.1.cmml">,</mo><mi id="alg1.l9.m1.3.3" xref="alg1.l9.m1.3.3.cmml">D</mi><mo id="alg1.l9.m1.5.5.1.3.2.4" stretchy="false" xref="alg1.l9.m1.5.5.1.3.1.cmml">)</mo></mrow><mo id="alg1.l9.m1.5.5.1.2" stretchy="false" xref="alg1.l9.m1.5.5.1.2.cmml">←</mo><mrow id="alg1.l9.m1.5.5.1.1.1" xref="alg1.l9.m1.5.5.1.1.2.cmml"><mi id="alg1.l9.m1.4.4" xref="alg1.l9.m1.4.4.cmml">Linear</mi><mo id="alg1.l9.m1.5.5.1.1.1a" xref="alg1.l9.m1.5.5.1.1.2.cmml">⁡</mo><mrow id="alg1.l9.m1.5.5.1.1.1.1" xref="alg1.l9.m1.5.5.1.1.2.cmml"><mo id="alg1.l9.m1.5.5.1.1.1.1.2" stretchy="false" xref="alg1.l9.m1.5.5.1.1.2.cmml">(</mo><msubsup id="alg1.l9.m1.5.5.1.1.1.1.1" xref="alg1.l9.m1.5.5.1.1.1.1.1.cmml"><mi id="alg1.l9.m1.5.5.1.1.1.1.1.2.2" xref="alg1.l9.m1.5.5.1.1.1.1.1.2.2.cmml">H</mi><mi id="alg1.l9.m1.5.5.1.1.1.1.1.3" xref="alg1.l9.m1.5.5.1.1.1.1.1.3.cmml">y</mi><mo id="alg1.l9.m1.5.5.1.1.1.1.1.2.3" xref="alg1.l9.m1.5.5.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="alg1.l9.m1.5.5.1.1.1.1.3" stretchy="false" xref="alg1.l9.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.5b"><apply id="alg1.l9.m1.5.5.cmml" xref="alg1.l9.m1.5.5"><ci id="alg1.l9.m1.5.5.2.cmml" xref="alg1.l9.m1.5.5.2">:</ci><apply id="alg1.l9.m1.5.5.3.cmml" xref="alg1.l9.m1.5.5.3"><csymbol cd="ambiguous" id="alg1.l9.m1.5.5.3.1.cmml" xref="alg1.l9.m1.5.5.3">subscript</csymbol><ci id="alg1.l9.m1.5.5.3.2.cmml" xref="alg1.l9.m1.5.5.3.2">𝐻</ci><ci id="alg1.l9.m1.5.5.3.3.cmml" xref="alg1.l9.m1.5.5.3.3">𝑜</ci></apply><apply id="alg1.l9.m1.5.5.1.cmml" xref="alg1.l9.m1.5.5.1"><ci id="alg1.l9.m1.5.5.1.2.cmml" xref="alg1.l9.m1.5.5.1.2">←</ci><vector id="alg1.l9.m1.5.5.1.3.1.cmml" xref="alg1.l9.m1.5.5.1.3.2"><ci id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">𝐵</ci><ci id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2">𝑇</ci><ci id="alg1.l9.m1.3.3.cmml" xref="alg1.l9.m1.3.3">𝐷</ci></vector><apply id="alg1.l9.m1.5.5.1.1.2.cmml" xref="alg1.l9.m1.5.5.1.1.1"><ci id="alg1.l9.m1.4.4.cmml" xref="alg1.l9.m1.4.4">Linear</ci><apply id="alg1.l9.m1.5.5.1.1.1.1.1.cmml" xref="alg1.l9.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.5.5.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.5.5.1.1.1.1.1">subscript</csymbol><apply id="alg1.l9.m1.5.5.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.5.5.1.1.1.1.1.2.1.cmml" xref="alg1.l9.m1.5.5.1.1.1.1.1">superscript</csymbol><ci id="alg1.l9.m1.5.5.1.1.1.1.1.2.2.cmml" xref="alg1.l9.m1.5.5.1.1.1.1.1.2.2">𝐻</ci><ci id="alg1.l9.m1.5.5.1.1.1.1.1.2.3.cmml" xref="alg1.l9.m1.5.5.1.1.1.1.1.2.3">′</ci></apply><ci id="alg1.l9.m1.5.5.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.5.5.1.1.1.1.1.3">𝑦</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.5c">H_{o}:(B,T,D)\leftarrow\operatorname{Linear}(H^{\prime}_{y})</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.5d">italic_H start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT : ( italic_B , italic_T , italic_D ) ← roman_Linear ( italic_H start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.2.1.1" style="font-size:80%;">10:</span></span><span class="ltx_text" id="alg1.l10.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l10.1.m1.1"><semantics id="alg1.l10.1.m1.1a"><mo id="alg1.l10.1.m1.1.1" xref="alg1.l10.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l10.1.m1.1b"><ci id="alg1.l10.1.m1.1.1.cmml" xref="alg1.l10.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.1.m1.1d">▷</annotation></semantics></math> Linear projection to reduce dimensions
</span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l11.2">return</span> <math alttext="H_{o}" class="ltx_Math" display="inline" id="alg1.l11.m1.1"><semantics id="alg1.l11.m1.1a"><msub id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">H</mi><mi id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝐻</ci><ci id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">H_{o}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.1d">italic_H start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
</div>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.5"><span class="ltx_text ltx_font_bold" id="S3.SS1.p3.5.1">Feedforward Layer.</span>
In the feedforward layer, a position-wise feed-forward network (PFFN) is employed to enhance the modeling of user actions in the latent space. The feedforward network leverages two fully connected layers with a SiLU activation function to capture intricate patterns and interactions within the user interaction sequences. The PFFN is formulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{PFFN}(H)=\operatorname{SiLU}\left(H\bm{W}^{(1)}+\bm{b}^{(1)}%
\right)\bm{W}^{(2)}+\bm{b}^{(2)}," class="ltx_Math" display="block" id="S3.E4.m1.8"><semantics id="S3.E4.m1.8a"><mrow id="S3.E4.m1.8.8.1" xref="S3.E4.m1.8.8.1.1.cmml"><mrow id="S3.E4.m1.8.8.1.1" xref="S3.E4.m1.8.8.1.1.cmml"><mrow id="S3.E4.m1.8.8.1.1.3.2" xref="S3.E4.m1.8.8.1.1.3.1.cmml"><mi id="S3.E4.m1.5.5" xref="S3.E4.m1.5.5.cmml">PFFN</mi><mo id="S3.E4.m1.8.8.1.1.3.2a" xref="S3.E4.m1.8.8.1.1.3.1.cmml">⁡</mo><mrow id="S3.E4.m1.8.8.1.1.3.2.1" xref="S3.E4.m1.8.8.1.1.3.1.cmml"><mo id="S3.E4.m1.8.8.1.1.3.2.1.1" stretchy="false" xref="S3.E4.m1.8.8.1.1.3.1.cmml">(</mo><mi id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml">H</mi><mo id="S3.E4.m1.8.8.1.1.3.2.1.2" stretchy="false" xref="S3.E4.m1.8.8.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.8.8.1.1.2" xref="S3.E4.m1.8.8.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.8.8.1.1.1" xref="S3.E4.m1.8.8.1.1.1.cmml"><mrow id="S3.E4.m1.8.8.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.cmml"><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.7.7" xref="S3.E4.m1.7.7.cmml">SiLU</mi><mo id="S3.E4.m1.8.8.1.1.1.1.1.1a" xref="S3.E4.m1.8.8.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.1.2" xref="S3.E4.m1.8.8.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.2.cmml">H</mi><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msup id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.3.2.cmml">𝑾</mi><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E4.m1.1.1.1.3.1" stretchy="false" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><mn id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">1</mn><mo id="S3.E4.m1.1.1.1.3.2" stretchy="false" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></msup></mrow><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.cmml">+</mo><msup id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.3.2.cmml">𝒃</mi><mrow id="S3.E4.m1.2.2.1.3" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.3.cmml"><mo id="S3.E4.m1.2.2.1.3.1" stretchy="false" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.3.cmml">(</mo><mn id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml">1</mn><mo id="S3.E4.m1.2.2.1.3.2" stretchy="false" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.1.3" xref="S3.E4.m1.8.8.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.8.8.1.1.1.1.2" xref="S3.E4.m1.8.8.1.1.1.1.2.cmml">⁢</mo><msup id="S3.E4.m1.8.8.1.1.1.1.3" xref="S3.E4.m1.8.8.1.1.1.1.3.cmml"><mi id="S3.E4.m1.8.8.1.1.1.1.3.2" xref="S3.E4.m1.8.8.1.1.1.1.3.2.cmml">𝑾</mi><mrow id="S3.E4.m1.3.3.1.3" xref="S3.E4.m1.8.8.1.1.1.1.3.cmml"><mo id="S3.E4.m1.3.3.1.3.1" stretchy="false" xref="S3.E4.m1.8.8.1.1.1.1.3.cmml">(</mo><mn id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml">2</mn><mo id="S3.E4.m1.3.3.1.3.2" stretchy="false" xref="S3.E4.m1.8.8.1.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="S3.E4.m1.8.8.1.1.1.2" xref="S3.E4.m1.8.8.1.1.1.2.cmml">+</mo><msup id="S3.E4.m1.8.8.1.1.1.3" xref="S3.E4.m1.8.8.1.1.1.3.cmml"><mi id="S3.E4.m1.8.8.1.1.1.3.2" xref="S3.E4.m1.8.8.1.1.1.3.2.cmml">𝒃</mi><mrow id="S3.E4.m1.4.4.1.3" xref="S3.E4.m1.8.8.1.1.1.3.cmml"><mo id="S3.E4.m1.4.4.1.3.1" stretchy="false" xref="S3.E4.m1.8.8.1.1.1.3.cmml">(</mo><mn id="S3.E4.m1.4.4.1.1" xref="S3.E4.m1.4.4.1.1.cmml">2</mn><mo id="S3.E4.m1.4.4.1.3.2" stretchy="false" xref="S3.E4.m1.8.8.1.1.1.3.cmml">)</mo></mrow></msup></mrow></mrow><mo id="S3.E4.m1.8.8.1.2" xref="S3.E4.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.8b"><apply id="S3.E4.m1.8.8.1.1.cmml" xref="S3.E4.m1.8.8.1"><eq id="S3.E4.m1.8.8.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.2"></eq><apply id="S3.E4.m1.8.8.1.1.3.1.cmml" xref="S3.E4.m1.8.8.1.1.3.2"><ci id="S3.E4.m1.5.5.cmml" xref="S3.E4.m1.5.5">PFFN</ci><ci id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6">𝐻</ci></apply><apply id="S3.E4.m1.8.8.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.1"><plus id="S3.E4.m1.8.8.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.1.2"></plus><apply id="S3.E4.m1.8.8.1.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1"><times id="S3.E4.m1.8.8.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.2"></times><apply id="S3.E4.m1.8.8.1.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1"><ci id="S3.E4.m1.7.7.cmml" xref="S3.E4.m1.7.7">SiLU</ci><apply id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1"><plus id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2"><times id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.1"></times><ci id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.2">𝐻</ci><apply id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2.3.2">𝑾</ci><cn id="S3.E4.m1.1.1.1.1.cmml" type="integer" xref="S3.E4.m1.1.1.1.1">1</cn></apply></apply><apply id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.3.2">𝒃</ci><cn id="S3.E4.m1.2.2.1.1.cmml" type="integer" xref="S3.E4.m1.2.2.1.1">1</cn></apply></apply></apply><apply id="S3.E4.m1.8.8.1.1.1.1.3.cmml" xref="S3.E4.m1.8.8.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.1.1.3.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.3">superscript</csymbol><ci id="S3.E4.m1.8.8.1.1.1.1.3.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.3.2">𝑾</ci><cn id="S3.E4.m1.3.3.1.1.cmml" type="integer" xref="S3.E4.m1.3.3.1.1">2</cn></apply></apply><apply id="S3.E4.m1.8.8.1.1.1.3.cmml" xref="S3.E4.m1.8.8.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.1.3.1.cmml" xref="S3.E4.m1.8.8.1.1.1.3">superscript</csymbol><ci id="S3.E4.m1.8.8.1.1.1.3.2.cmml" xref="S3.E4.m1.8.8.1.1.1.3.2">𝒃</ci><cn id="S3.E4.m1.4.4.1.1.cmml" type="integer" xref="S3.E4.m1.4.4.1.1">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.8c">\operatorname{PFFN}(H)=\operatorname{SiLU}\left(H\bm{W}^{(1)}+\bm{b}^{(1)}%
\right)\bm{W}^{(2)}+\bm{b}^{(2)},</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.8d">roman_PFFN ( italic_H ) = roman_SiLU ( italic_H bold_italic_W start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT + bold_italic_b start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ) bold_italic_W start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT + bold_italic_b start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p3.4">where <math alttext="\bm{W}^{(1)}\in\mathbb{R}^{D\times 4D}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.2" xref="S3.SS1.p3.1.m1.1.2.cmml"><msup id="S3.SS1.p3.1.m1.1.2.2" xref="S3.SS1.p3.1.m1.1.2.2.cmml"><mi id="S3.SS1.p3.1.m1.1.2.2.2" xref="S3.SS1.p3.1.m1.1.2.2.2.cmml">𝑾</mi><mrow id="S3.SS1.p3.1.m1.1.1.1.3" xref="S3.SS1.p3.1.m1.1.2.2.cmml"><mo id="S3.SS1.p3.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS1.p3.1.m1.1.2.2.cmml">(</mo><mn id="S3.SS1.p3.1.m1.1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.1.cmml">1</mn><mo id="S3.SS1.p3.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS1.p3.1.m1.1.2.2.cmml">)</mo></mrow></msup><mo id="S3.SS1.p3.1.m1.1.2.1" xref="S3.SS1.p3.1.m1.1.2.1.cmml">∈</mo><msup id="S3.SS1.p3.1.m1.1.2.3" xref="S3.SS1.p3.1.m1.1.2.3.cmml"><mi id="S3.SS1.p3.1.m1.1.2.3.2" xref="S3.SS1.p3.1.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p3.1.m1.1.2.3.3" xref="S3.SS1.p3.1.m1.1.2.3.3.cmml"><mrow id="S3.SS1.p3.1.m1.1.2.3.3.2" xref="S3.SS1.p3.1.m1.1.2.3.3.2.cmml"><mi id="S3.SS1.p3.1.m1.1.2.3.3.2.2" xref="S3.SS1.p3.1.m1.1.2.3.3.2.2.cmml">D</mi><mo id="S3.SS1.p3.1.m1.1.2.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p3.1.m1.1.2.3.3.2.1.cmml">×</mo><mn id="S3.SS1.p3.1.m1.1.2.3.3.2.3" xref="S3.SS1.p3.1.m1.1.2.3.3.2.3.cmml">4</mn></mrow><mo id="S3.SS1.p3.1.m1.1.2.3.3.1" xref="S3.SS1.p3.1.m1.1.2.3.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.1.m1.1.2.3.3.3" xref="S3.SS1.p3.1.m1.1.2.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.2"><in id="S3.SS1.p3.1.m1.1.2.1.cmml" xref="S3.SS1.p3.1.m1.1.2.1"></in><apply id="S3.SS1.p3.1.m1.1.2.2.cmml" xref="S3.SS1.p3.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.2.2.1.cmml" xref="S3.SS1.p3.1.m1.1.2.2">superscript</csymbol><ci id="S3.SS1.p3.1.m1.1.2.2.2.cmml" xref="S3.SS1.p3.1.m1.1.2.2.2">𝑾</ci><cn id="S3.SS1.p3.1.m1.1.1.1.1.cmml" type="integer" xref="S3.SS1.p3.1.m1.1.1.1.1">1</cn></apply><apply id="S3.SS1.p3.1.m1.1.2.3.cmml" xref="S3.SS1.p3.1.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.2.3.1.cmml" xref="S3.SS1.p3.1.m1.1.2.3">superscript</csymbol><ci id="S3.SS1.p3.1.m1.1.2.3.2.cmml" xref="S3.SS1.p3.1.m1.1.2.3.2">ℝ</ci><apply id="S3.SS1.p3.1.m1.1.2.3.3.cmml" xref="S3.SS1.p3.1.m1.1.2.3.3"><times id="S3.SS1.p3.1.m1.1.2.3.3.1.cmml" xref="S3.SS1.p3.1.m1.1.2.3.3.1"></times><apply id="S3.SS1.p3.1.m1.1.2.3.3.2.cmml" xref="S3.SS1.p3.1.m1.1.2.3.3.2"><times id="S3.SS1.p3.1.m1.1.2.3.3.2.1.cmml" xref="S3.SS1.p3.1.m1.1.2.3.3.2.1"></times><ci id="S3.SS1.p3.1.m1.1.2.3.3.2.2.cmml" xref="S3.SS1.p3.1.m1.1.2.3.3.2.2">𝐷</ci><cn id="S3.SS1.p3.1.m1.1.2.3.3.2.3.cmml" type="integer" xref="S3.SS1.p3.1.m1.1.2.3.3.2.3">4</cn></apply><ci id="S3.SS1.p3.1.m1.1.2.3.3.3.cmml" xref="S3.SS1.p3.1.m1.1.2.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\bm{W}^{(1)}\in\mathbb{R}^{D\times 4D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">bold_italic_W start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D × 4 italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\bm{W}^{(2)}\in\mathbb{R}^{4D\times D}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><mrow id="S3.SS1.p3.2.m2.1.2" xref="S3.SS1.p3.2.m2.1.2.cmml"><msup id="S3.SS1.p3.2.m2.1.2.2" xref="S3.SS1.p3.2.m2.1.2.2.cmml"><mi id="S3.SS1.p3.2.m2.1.2.2.2" xref="S3.SS1.p3.2.m2.1.2.2.2.cmml">𝑾</mi><mrow id="S3.SS1.p3.2.m2.1.1.1.3" xref="S3.SS1.p3.2.m2.1.2.2.cmml"><mo id="S3.SS1.p3.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS1.p3.2.m2.1.2.2.cmml">(</mo><mn id="S3.SS1.p3.2.m2.1.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.1.cmml">2</mn><mo id="S3.SS1.p3.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS1.p3.2.m2.1.2.2.cmml">)</mo></mrow></msup><mo id="S3.SS1.p3.2.m2.1.2.1" xref="S3.SS1.p3.2.m2.1.2.1.cmml">∈</mo><msup id="S3.SS1.p3.2.m2.1.2.3" xref="S3.SS1.p3.2.m2.1.2.3.cmml"><mi id="S3.SS1.p3.2.m2.1.2.3.2" xref="S3.SS1.p3.2.m2.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p3.2.m2.1.2.3.3" xref="S3.SS1.p3.2.m2.1.2.3.3.cmml"><mrow id="S3.SS1.p3.2.m2.1.2.3.3.2" xref="S3.SS1.p3.2.m2.1.2.3.3.2.cmml"><mn id="S3.SS1.p3.2.m2.1.2.3.3.2.2" xref="S3.SS1.p3.2.m2.1.2.3.3.2.2.cmml">4</mn><mo id="S3.SS1.p3.2.m2.1.2.3.3.2.1" xref="S3.SS1.p3.2.m2.1.2.3.3.2.1.cmml">⁢</mo><mi id="S3.SS1.p3.2.m2.1.2.3.3.2.3" xref="S3.SS1.p3.2.m2.1.2.3.3.2.3.cmml">D</mi></mrow><mo id="S3.SS1.p3.2.m2.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p3.2.m2.1.2.3.3.1.cmml">×</mo><mi id="S3.SS1.p3.2.m2.1.2.3.3.3" xref="S3.SS1.p3.2.m2.1.2.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.2.cmml" xref="S3.SS1.p3.2.m2.1.2"><in id="S3.SS1.p3.2.m2.1.2.1.cmml" xref="S3.SS1.p3.2.m2.1.2.1"></in><apply id="S3.SS1.p3.2.m2.1.2.2.cmml" xref="S3.SS1.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.2.2.1.cmml" xref="S3.SS1.p3.2.m2.1.2.2">superscript</csymbol><ci id="S3.SS1.p3.2.m2.1.2.2.2.cmml" xref="S3.SS1.p3.2.m2.1.2.2.2">𝑾</ci><cn id="S3.SS1.p3.2.m2.1.1.1.1.cmml" type="integer" xref="S3.SS1.p3.2.m2.1.1.1.1">2</cn></apply><apply id="S3.SS1.p3.2.m2.1.2.3.cmml" xref="S3.SS1.p3.2.m2.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.2.3.1.cmml" xref="S3.SS1.p3.2.m2.1.2.3">superscript</csymbol><ci id="S3.SS1.p3.2.m2.1.2.3.2.cmml" xref="S3.SS1.p3.2.m2.1.2.3.2">ℝ</ci><apply id="S3.SS1.p3.2.m2.1.2.3.3.cmml" xref="S3.SS1.p3.2.m2.1.2.3.3"><times id="S3.SS1.p3.2.m2.1.2.3.3.1.cmml" xref="S3.SS1.p3.2.m2.1.2.3.3.1"></times><apply id="S3.SS1.p3.2.m2.1.2.3.3.2.cmml" xref="S3.SS1.p3.2.m2.1.2.3.3.2"><times id="S3.SS1.p3.2.m2.1.2.3.3.2.1.cmml" xref="S3.SS1.p3.2.m2.1.2.3.3.2.1"></times><cn id="S3.SS1.p3.2.m2.1.2.3.3.2.2.cmml" type="integer" xref="S3.SS1.p3.2.m2.1.2.3.3.2.2">4</cn><ci id="S3.SS1.p3.2.m2.1.2.3.3.2.3.cmml" xref="S3.SS1.p3.2.m2.1.2.3.3.2.3">𝐷</ci></apply><ci id="S3.SS1.p3.2.m2.1.2.3.3.3.cmml" xref="S3.SS1.p3.2.m2.1.2.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\bm{W}^{(2)}\in\mathbb{R}^{4D\times D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">bold_italic_W start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 4 italic_D × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\bm{b}^{(1)}\in\mathbb{R}^{4D}" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><mrow id="S3.SS1.p3.3.m3.1.2" xref="S3.SS1.p3.3.m3.1.2.cmml"><msup id="S3.SS1.p3.3.m3.1.2.2" xref="S3.SS1.p3.3.m3.1.2.2.cmml"><mi id="S3.SS1.p3.3.m3.1.2.2.2" xref="S3.SS1.p3.3.m3.1.2.2.2.cmml">𝒃</mi><mrow id="S3.SS1.p3.3.m3.1.1.1.3" xref="S3.SS1.p3.3.m3.1.2.2.cmml"><mo id="S3.SS1.p3.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS1.p3.3.m3.1.2.2.cmml">(</mo><mn id="S3.SS1.p3.3.m3.1.1.1.1" xref="S3.SS1.p3.3.m3.1.1.1.1.cmml">1</mn><mo id="S3.SS1.p3.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS1.p3.3.m3.1.2.2.cmml">)</mo></mrow></msup><mo id="S3.SS1.p3.3.m3.1.2.1" xref="S3.SS1.p3.3.m3.1.2.1.cmml">∈</mo><msup id="S3.SS1.p3.3.m3.1.2.3" xref="S3.SS1.p3.3.m3.1.2.3.cmml"><mi id="S3.SS1.p3.3.m3.1.2.3.2" xref="S3.SS1.p3.3.m3.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p3.3.m3.1.2.3.3" xref="S3.SS1.p3.3.m3.1.2.3.3.cmml"><mn id="S3.SS1.p3.3.m3.1.2.3.3.2" xref="S3.SS1.p3.3.m3.1.2.3.3.2.cmml">4</mn><mo id="S3.SS1.p3.3.m3.1.2.3.3.1" xref="S3.SS1.p3.3.m3.1.2.3.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.3.m3.1.2.3.3.3" xref="S3.SS1.p3.3.m3.1.2.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.2.cmml" xref="S3.SS1.p3.3.m3.1.2"><in id="S3.SS1.p3.3.m3.1.2.1.cmml" xref="S3.SS1.p3.3.m3.1.2.1"></in><apply id="S3.SS1.p3.3.m3.1.2.2.cmml" xref="S3.SS1.p3.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.2.2.1.cmml" xref="S3.SS1.p3.3.m3.1.2.2">superscript</csymbol><ci id="S3.SS1.p3.3.m3.1.2.2.2.cmml" xref="S3.SS1.p3.3.m3.1.2.2.2">𝒃</ci><cn id="S3.SS1.p3.3.m3.1.1.1.1.cmml" type="integer" xref="S3.SS1.p3.3.m3.1.1.1.1">1</cn></apply><apply id="S3.SS1.p3.3.m3.1.2.3.cmml" xref="S3.SS1.p3.3.m3.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.2.3.1.cmml" xref="S3.SS1.p3.3.m3.1.2.3">superscript</csymbol><ci id="S3.SS1.p3.3.m3.1.2.3.2.cmml" xref="S3.SS1.p3.3.m3.1.2.3.2">ℝ</ci><apply id="S3.SS1.p3.3.m3.1.2.3.3.cmml" xref="S3.SS1.p3.3.m3.1.2.3.3"><times id="S3.SS1.p3.3.m3.1.2.3.3.1.cmml" xref="S3.SS1.p3.3.m3.1.2.3.3.1"></times><cn id="S3.SS1.p3.3.m3.1.2.3.3.2.cmml" type="integer" xref="S3.SS1.p3.3.m3.1.2.3.3.2">4</cn><ci id="S3.SS1.p3.3.m3.1.2.3.3.3.cmml" xref="S3.SS1.p3.3.m3.1.2.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">\bm{b}^{(1)}\in\mathbb{R}^{4D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">bold_italic_b start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 4 italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="\bm{b}^{(2)}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.1"><semantics id="S3.SS1.p3.4.m4.1a"><mrow id="S3.SS1.p3.4.m4.1.2" xref="S3.SS1.p3.4.m4.1.2.cmml"><msup id="S3.SS1.p3.4.m4.1.2.2" xref="S3.SS1.p3.4.m4.1.2.2.cmml"><mi id="S3.SS1.p3.4.m4.1.2.2.2" xref="S3.SS1.p3.4.m4.1.2.2.2.cmml">𝒃</mi><mrow id="S3.SS1.p3.4.m4.1.1.1.3" xref="S3.SS1.p3.4.m4.1.2.2.cmml"><mo id="S3.SS1.p3.4.m4.1.1.1.3.1" stretchy="false" xref="S3.SS1.p3.4.m4.1.2.2.cmml">(</mo><mn id="S3.SS1.p3.4.m4.1.1.1.1" xref="S3.SS1.p3.4.m4.1.1.1.1.cmml">2</mn><mo id="S3.SS1.p3.4.m4.1.1.1.3.2" stretchy="false" xref="S3.SS1.p3.4.m4.1.2.2.cmml">)</mo></mrow></msup><mo id="S3.SS1.p3.4.m4.1.2.1" xref="S3.SS1.p3.4.m4.1.2.1.cmml">∈</mo><msup id="S3.SS1.p3.4.m4.1.2.3" xref="S3.SS1.p3.4.m4.1.2.3.cmml"><mi id="S3.SS1.p3.4.m4.1.2.3.2" xref="S3.SS1.p3.4.m4.1.2.3.2.cmml">ℝ</mi><mi id="S3.SS1.p3.4.m4.1.2.3.3" xref="S3.SS1.p3.4.m4.1.2.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.2.cmml" xref="S3.SS1.p3.4.m4.1.2"><in id="S3.SS1.p3.4.m4.1.2.1.cmml" xref="S3.SS1.p3.4.m4.1.2.1"></in><apply id="S3.SS1.p3.4.m4.1.2.2.cmml" xref="S3.SS1.p3.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.2.2.1.cmml" xref="S3.SS1.p3.4.m4.1.2.2">superscript</csymbol><ci id="S3.SS1.p3.4.m4.1.2.2.2.cmml" xref="S3.SS1.p3.4.m4.1.2.2.2">𝒃</ci><cn id="S3.SS1.p3.4.m4.1.1.1.1.cmml" type="integer" xref="S3.SS1.p3.4.m4.1.1.1.1">2</cn></apply><apply id="S3.SS1.p3.4.m4.1.2.3.cmml" xref="S3.SS1.p3.4.m4.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.2.3.1.cmml" xref="S3.SS1.p3.4.m4.1.2.3">superscript</csymbol><ci id="S3.SS1.p3.4.m4.1.2.3.2.cmml" xref="S3.SS1.p3.4.m4.1.2.3.2">ℝ</ci><ci id="S3.SS1.p3.4.m4.1.2.3.3.cmml" xref="S3.SS1.p3.4.m4.1.2.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">\bm{b}^{(2)}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.1d">bold_italic_b start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> are the parameters of two fully connected layers.
Furthermore, to improve model robustness and mitigate overfitting, we incorporate dropout and layer normalization as well.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Behavior-Dependent Linear Recurrent Units</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Traditional Linear Recurrent Units have limitations in capturing the nuances of user behavior over time. As shown in Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S3.E5" title="Equation 5 ‣ 3.2. Behavior-Dependent Linear Recurrent Units ‣ 3. Methodology ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>, the parameters of LRUs are independent of input behaviors from different time steps, which makes the LRUs behavior-independent and limits the recommendation performance. Consequently, LRURec based on LRUs struggles to differentiate between diverse user behaviors within interaction sequences, lacking the adaptability to effectively understand how users interact and their preferences evolve.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">To tackle this issue, we design the Behavior-Dependent Linear Recurrent Unit (BD-LRU), whose parameters are dependent on input behaviors across different time steps. The core idea behind BD-LRU is to selectively learn important user behaviors within a sequence. For example, when a user browses various categories before purchasing a product, the model can focus on the browsing history relevant to the eventual purchase, filtering out irrelevant categories the user might have casually explored. This is achieved through the behavior-dependent parameters, which act like a filter, allowing the model to focus on specific elements within the sequence while downplaying others.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.8">Different from traditional LRUs in Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S3.E5" title="Equation 5 ‣ 3.2. Behavior-Dependent Linear Recurrent Units ‣ 3. Methodology ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>, our behavior-dependent Linear Recurrent Unit updates by:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h_{t}=\alpha_{t}\odot h_{t-1}+\beta_{t}\odot x_{t}," class="ltx_Math" display="block" id="S3.E5.m1.1"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><msub id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.2.2.cmml">h</mi><mi id="S3.E5.m1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml"><mrow id="S3.E5.m1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.3.2.cmml"><msub id="S3.E5.m1.1.1.1.1.3.2.2" xref="S3.E5.m1.1.1.1.1.3.2.2.cmml"><mi id="S3.E5.m1.1.1.1.1.3.2.2.2" xref="S3.E5.m1.1.1.1.1.3.2.2.2.cmml">α</mi><mi id="S3.E5.m1.1.1.1.1.3.2.2.3" xref="S3.E5.m1.1.1.1.1.3.2.2.3.cmml">t</mi></msub><mo id="S3.E5.m1.1.1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E5.m1.1.1.1.1.3.2.1.cmml">⊙</mo><msub id="S3.E5.m1.1.1.1.1.3.2.3" xref="S3.E5.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.2.3.2" xref="S3.E5.m1.1.1.1.1.3.2.3.2.cmml">h</mi><mrow id="S3.E5.m1.1.1.1.1.3.2.3.3" xref="S3.E5.m1.1.1.1.1.3.2.3.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.2.3.3.2" xref="S3.E5.m1.1.1.1.1.3.2.3.3.2.cmml">t</mi><mo id="S3.E5.m1.1.1.1.1.3.2.3.3.1" xref="S3.E5.m1.1.1.1.1.3.2.3.3.1.cmml">−</mo><mn id="S3.E5.m1.1.1.1.1.3.2.3.3.3" xref="S3.E5.m1.1.1.1.1.3.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E5.m1.1.1.1.1.3.1" xref="S3.E5.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E5.m1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.3.3.cmml"><msub id="S3.E5.m1.1.1.1.1.3.3.2" xref="S3.E5.m1.1.1.1.1.3.3.2.cmml"><mi id="S3.E5.m1.1.1.1.1.3.3.2.2" xref="S3.E5.m1.1.1.1.1.3.3.2.2.cmml">β</mi><mi id="S3.E5.m1.1.1.1.1.3.3.2.3" xref="S3.E5.m1.1.1.1.1.3.3.2.3.cmml">t</mi></msub><mo id="S3.E5.m1.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E5.m1.1.1.1.1.3.3.1.cmml">⊙</mo><msub id="S3.E5.m1.1.1.1.1.3.3.3" xref="S3.E5.m1.1.1.1.1.3.3.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.3.3.2" xref="S3.E5.m1.1.1.1.1.3.3.3.2.cmml">x</mi><mi id="S3.E5.m1.1.1.1.1.3.3.3.3" xref="S3.E5.m1.1.1.1.1.3.3.3.3.cmml">t</mi></msub></mrow></mrow></mrow><mo id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><eq id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"></eq><apply id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2">ℎ</ci><ci id="S3.E5.m1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3"><plus id="S3.E5.m1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.1"></plus><apply id="S3.E5.m1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2"><csymbol cd="latexml" id="S3.E5.m1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3.2.1">direct-product</csymbol><apply id="S3.E5.m1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2.2">𝛼</ci><ci id="S3.E5.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2.3">𝑡</ci></apply><apply id="S3.E5.m1.1.1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.2">ℎ</ci><apply id="S3.E5.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.3"><minus id="S3.E5.m1.1.1.1.1.3.2.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.3.1"></minus><ci id="S3.E5.m1.1.1.1.1.3.2.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.3.2">𝑡</ci><cn id="S3.E5.m1.1.1.1.1.3.2.3.3.3.cmml" type="integer" xref="S3.E5.m1.1.1.1.1.3.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.E5.m1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3"><csymbol cd="latexml" id="S3.E5.m1.1.1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.1">direct-product</csymbol><apply id="S3.E5.m1.1.1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.2.2">𝛽</ci><ci id="S3.E5.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.2.3">𝑡</ci></apply><apply id="S3.E5.m1.1.1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.2">𝑥</ci><ci id="S3.E5.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">h_{t}=\alpha_{t}\odot h_{t-1}+\beta_{t}\odot x_{t},</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⊙ italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT + italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⊙ italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p3.7">where <math alttext="\alpha_{t}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">α</mi><mi id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝛼</ci><ci id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\alpha_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\beta_{t}" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><msub id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">β</mi><mi id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝛽</ci><ci id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">\beta_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> should not have non-linear dependencies on the prior hidden state <math alttext="h_{t-1}" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><msub id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml">h</mi><mrow id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml"><mi id="S3.SS2.p3.3.m3.1.1.3.2" xref="S3.SS2.p3.3.m3.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p3.3.m3.1.1.3.1" xref="S3.SS2.p3.3.m3.1.1.3.1.cmml">−</mo><mn id="S3.SS2.p3.3.m3.1.1.3.3" xref="S3.SS2.p3.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2">ℎ</ci><apply id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3"><minus id="S3.SS2.p3.3.m3.1.1.3.1.cmml" xref="S3.SS2.p3.3.m3.1.1.3.1"></minus><ci id="S3.SS2.p3.3.m3.1.1.3.2.cmml" xref="S3.SS2.p3.3.m3.1.1.3.2">𝑡</ci><cn id="S3.SS2.p3.3.m3.1.1.3.3.cmml" type="integer" xref="S3.SS2.p3.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">h_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math>, but depend solely on current input <math alttext="x_{t}" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1"><semantics id="S3.SS2.p3.4.m4.1a"><msub id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml">x</mi><mi id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2">𝑥</ci><ci id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">x_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. We use <math alttext="\odot" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.1"><semantics id="S3.SS2.p3.5.m5.1a"><mo id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><csymbol cd="latexml" id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.1d">⊙</annotation></semantics></math> to denote element-wise multiplication, and <math alttext="x_{t}" class="ltx_Math" display="inline" id="S3.SS2.p3.6.m6.1"><semantics id="S3.SS2.p3.6.m6.1a"><msub id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml"><mi id="S3.SS2.p3.6.m6.1.1.2" xref="S3.SS2.p3.6.m6.1.1.2.cmml">x</mi><mi id="S3.SS2.p3.6.m6.1.1.3" xref="S3.SS2.p3.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><apply id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p3.6.m6.1.1.2.cmml" xref="S3.SS2.p3.6.m6.1.1.2">𝑥</ci><ci id="S3.SS2.p3.6.m6.1.1.3.cmml" xref="S3.SS2.p3.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">x_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.6.m6.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> represents the input latent representation at time step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.p3.7.m7.1"><semantics id="S3.SS2.p3.7.m7.1a"><mi id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><ci id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.7.m7.1d">italic_t</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.9">Additionally, to achieve behavior-dependency and control the influence of the past and current input behaviors, we introduce the behavior-dependent recurrence and input gates, given by:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r_{t}=\sigma(\mathbf{W}_{r}x_{t}+\mathbf{b}_{r})," class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.3.2.cmml">r</mi><mi id="S3.E6.m1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.3.cmml">σ</mi><mo id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐖</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">r</mi></msub><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.2.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.E6.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">x</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E6.m1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝐛</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.cmml">r</mi></msub></mrow><mo id="S3.E6.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><eq id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"></eq><apply id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.2">𝑟</ci><ci id="S3.E6.m1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2"></times><ci id="S3.E6.m1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3">𝜎</ci><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1"><plus id="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2"><times id="S3.E6.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2">𝐖</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.3">𝑟</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.2">𝑥</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.2">𝐛</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.3">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">r_{t}=\sigma(\mathbf{W}_{r}x_{t}+\mathbf{b}_{r}),</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_σ ( bold_W start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + bold_b start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="i_{t}=\sigma(\mathbf{W}_{i}x_{t}+\mathbf{b}_{i})," class="ltx_Math" display="block" id="S3.E7.m1.1"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><msub id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.3.2.cmml">i</mi><mi id="S3.E7.m1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.3.cmml">σ</mi><mo id="S3.E7.m1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E7.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐖</mi><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.2.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.E7.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">x</mi><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E7.m1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝐛</mi><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E7.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><eq id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2"></eq><apply id="S3.E7.m1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E7.m1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.2"></times><ci id="S3.E7.m1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.3">𝜎</ci><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1"><plus id="S3.E7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2"><times id="S3.E7.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.2.2">𝐖</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.2">𝑥</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3.2">𝐛</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">i_{t}=\sigma(\mathbf{W}_{i}x_{t}+\mathbf{b}_{i}),</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.1d">italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_σ ( bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + bold_b start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p4.4">where <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">italic_σ</annotation></semantics></math> denotes the sigmoid function, normalizing the output of each gate to <math alttext="[0,1]" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.2"><semantics id="S3.SS2.p4.2.m2.2a"><mrow id="S3.SS2.p4.2.m2.2.3.2" xref="S3.SS2.p4.2.m2.2.3.1.cmml"><mo id="S3.SS2.p4.2.m2.2.3.2.1" stretchy="false" xref="S3.SS2.p4.2.m2.2.3.1.cmml">[</mo><mn id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml">0</mn><mo id="S3.SS2.p4.2.m2.2.3.2.2" xref="S3.SS2.p4.2.m2.2.3.1.cmml">,</mo><mn id="S3.SS2.p4.2.m2.2.2" xref="S3.SS2.p4.2.m2.2.2.cmml">1</mn><mo id="S3.SS2.p4.2.m2.2.3.2.3" stretchy="false" xref="S3.SS2.p4.2.m2.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.2b"><interval closure="closed" id="S3.SS2.p4.2.m2.2.3.1.cmml" xref="S3.SS2.p4.2.m2.2.3.2"><cn id="S3.SS2.p4.2.m2.1.1.cmml" type="integer" xref="S3.SS2.p4.2.m2.1.1">0</cn><cn id="S3.SS2.p4.2.m2.2.2.cmml" type="integer" xref="S3.SS2.p4.2.m2.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.2c">[0,1]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.2d">[ 0 , 1 ]</annotation></semantics></math> for reasonable gating semantics.
Both the recurrence gate and the input gate are dependent on the input <math alttext="x_{t}" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.1"><semantics id="S3.SS2.p4.3.m3.1a"><msub id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml"><mi id="S3.SS2.p4.3.m3.1.1.2" xref="S3.SS2.p4.3.m3.1.1.2.cmml">x</mi><mi id="S3.SS2.p4.3.m3.1.1.3" xref="S3.SS2.p4.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><apply id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p4.3.m3.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.2">𝑥</ci><ci id="S3.SS2.p4.3.m3.1.1.3.cmml" xref="S3.SS2.p4.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">x_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and independent of the prior hidden state <math alttext="h_{t-1}" class="ltx_Math" display="inline" id="S3.SS2.p4.4.m4.1"><semantics id="S3.SS2.p4.4.m4.1a"><msub id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml"><mi id="S3.SS2.p4.4.m4.1.1.2" xref="S3.SS2.p4.4.m4.1.1.2.cmml">h</mi><mrow id="S3.SS2.p4.4.m4.1.1.3" xref="S3.SS2.p4.4.m4.1.1.3.cmml"><mi id="S3.SS2.p4.4.m4.1.1.3.2" xref="S3.SS2.p4.4.m4.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p4.4.m4.1.1.3.1" xref="S3.SS2.p4.4.m4.1.1.3.1.cmml">−</mo><mn id="S3.SS2.p4.4.m4.1.1.3.3" xref="S3.SS2.p4.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><apply id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p4.4.m4.1.1.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2">ℎ</ci><apply id="S3.SS2.p4.4.m4.1.1.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3"><minus id="S3.SS2.p4.4.m4.1.1.3.1.cmml" xref="S3.SS2.p4.4.m4.1.1.3.1"></minus><ci id="S3.SS2.p4.4.m4.1.1.3.2.cmml" xref="S3.SS2.p4.4.m4.1.1.3.2">𝑡</ci><cn id="S3.SS2.p4.4.m4.1.1.3.3.cmml" type="integer" xref="S3.SS2.p4.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">h_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.4.m4.1d">italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math>. These gate designs make the parameters dependent on the input of different user behaviors and interactions.
We then follow the design in <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">orvieto2023resurrecting</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">de2024griffin</span>)</cite> to calculate the scaling factors:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E8">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E8X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\alpha_{t}" class="ltx_Math" display="inline" id="S3.E8X.2.1.1.m1.1"><semantics id="S3.E8X.2.1.1.m1.1a"><msub id="S3.E8X.2.1.1.m1.1.1" xref="S3.E8X.2.1.1.m1.1.1.cmml"><mi id="S3.E8X.2.1.1.m1.1.1.2" xref="S3.E8X.2.1.1.m1.1.1.2.cmml">α</mi><mi id="S3.E8X.2.1.1.m1.1.1.3" xref="S3.E8X.2.1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E8X.2.1.1.m1.1b"><apply id="S3.E8X.2.1.1.m1.1.1.cmml" xref="S3.E8X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.1.1.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.2">𝛼</ci><ci id="S3.E8X.2.1.1.m1.1.1.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8X.2.1.1.m1.1c">\displaystyle\alpha_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.E8X.2.1.1.m1.1d">italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\exp(-\operatorname{softplus}(\Lambda)\odot r_{t})," class="ltx_Math" display="inline" id="S3.E8X.3.2.2.m1.4"><semantics id="S3.E8X.3.2.2.m1.4a"><mrow id="S3.E8X.3.2.2.m1.4.4.1" xref="S3.E8X.3.2.2.m1.4.4.1.1.cmml"><mrow id="S3.E8X.3.2.2.m1.4.4.1.1" xref="S3.E8X.3.2.2.m1.4.4.1.1.cmml"><mi id="S3.E8X.3.2.2.m1.4.4.1.1.3" xref="S3.E8X.3.2.2.m1.4.4.1.1.3.cmml"></mi><mo id="S3.E8X.3.2.2.m1.4.4.1.1.2" xref="S3.E8X.3.2.2.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E8X.3.2.2.m1.4.4.1.1.1.1" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.2.cmml"><mi id="S3.E8X.3.2.2.m1.3.3" xref="S3.E8X.3.2.2.m1.3.3.cmml">exp</mi><mo id="S3.E8X.3.2.2.m1.4.4.1.1.1.1a" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.2.cmml">⁡</mo><mrow id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.2.cmml"><mo id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.2.cmml">(</mo><mrow id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1a" rspace="0.167em" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.cmml"><mrow id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.2.2" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.2.1.cmml"><mi id="S3.E8X.3.2.2.m1.1.1" xref="S3.E8X.3.2.2.m1.1.1.cmml">softplus</mi><mo id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.2.2a" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.2.1.cmml">⁡</mo><mrow id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.2.2.1" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.2.1.cmml"><mo id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.2.2.1.1" stretchy="false" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.2.1.cmml">(</mo><mi id="S3.E8X.3.2.2.m1.2.2" mathvariant="normal" xref="S3.E8X.3.2.2.m1.2.2.cmml">Λ</mi><mo id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.2.2.1.2" rspace="0.055em" stretchy="false" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.2.1.cmml">)</mo></mrow></mrow><mo id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1" rspace="0.222em" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.cmml">⊙</mo><msub id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.3" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.3.2" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.3.3" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.3.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8X.3.2.2.m1.4.4.1.2" xref="S3.E8X.3.2.2.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8X.3.2.2.m1.4b"><apply id="S3.E8X.3.2.2.m1.4.4.1.1.cmml" xref="S3.E8X.3.2.2.m1.4.4.1"><eq id="S3.E8X.3.2.2.m1.4.4.1.1.2.cmml" xref="S3.E8X.3.2.2.m1.4.4.1.1.2"></eq><csymbol cd="latexml" id="S3.E8X.3.2.2.m1.4.4.1.1.3.cmml" xref="S3.E8X.3.2.2.m1.4.4.1.1.3">absent</csymbol><apply id="S3.E8X.3.2.2.m1.4.4.1.1.1.2.cmml" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1"><exp id="S3.E8X.3.2.2.m1.3.3.cmml" xref="S3.E8X.3.2.2.m1.3.3"></exp><apply id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1"><minus id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1"></minus><apply id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1">direct-product</csymbol><apply id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.2.2"><ci id="S3.E8X.3.2.2.m1.1.1.cmml" xref="S3.E8X.3.2.2.m1.1.1">softplus</ci><ci id="S3.E8X.3.2.2.m1.2.2.cmml" xref="S3.E8X.3.2.2.m1.2.2">Λ</ci></apply><apply id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E8X.3.2.2.m1.4.4.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8X.3.2.2.m1.4c">\displaystyle=\exp(-\operatorname{softplus}(\Lambda)\odot r_{t}),</annotation><annotation encoding="application/x-llamapun" id="S3.E8X.3.2.2.m1.4d">= roman_exp ( - roman_softplus ( roman_Λ ) ⊙ italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E8Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\beta_{t}" class="ltx_Math" display="inline" id="S3.E8Xa.2.1.1.m1.1"><semantics id="S3.E8Xa.2.1.1.m1.1a"><msub id="S3.E8Xa.2.1.1.m1.1.1" xref="S3.E8Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E8Xa.2.1.1.m1.1.1.2" xref="S3.E8Xa.2.1.1.m1.1.1.2.cmml">β</mi><mi id="S3.E8Xa.2.1.1.m1.1.1.3" xref="S3.E8Xa.2.1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E8Xa.2.1.1.m1.1b"><apply id="S3.E8Xa.2.1.1.m1.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.2">𝛽</ci><ci id="S3.E8Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8Xa.2.1.1.m1.1c">\displaystyle\beta_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.E8Xa.2.1.1.m1.1d">italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sqrt{1-\alpha_{t}^{2}}\odot i_{t},\ " class="ltx_Math" display="inline" id="S3.E8Xa.3.2.2.m1.1"><semantics id="S3.E8Xa.3.2.2.m1.1a"><mrow id="S3.E8Xa.3.2.2.m1.1.1.1" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E8Xa.3.2.2.m1.1.1.1.1" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.cmml"><mi id="S3.E8Xa.3.2.2.m1.1.1.1.1.2" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.2.cmml"></mi><mo id="S3.E8Xa.3.2.2.m1.1.1.1.1.1" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E8Xa.3.2.2.m1.1.1.1.1.3" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.cmml"><msqrt id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.cmml"><mrow id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.cmml"><mn id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.2" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.2.cmml">1</mn><mo id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.1" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.1.cmml">−</mo><msubsup id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3.cmml"><mi id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3.2.2" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3.2.2.cmml">α</mi><mi id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3.2.3" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3.2.3.cmml">t</mi><mn id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3.3" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3.3.cmml">2</mn></msubsup></mrow></msqrt><mo id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.1.cmml">⊙</mo><msub id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.3" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.3.cmml"><mi id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.3.2" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.3.2.cmml">i</mi><mi id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.3.3" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.E8Xa.3.2.2.m1.1.1.1.2" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8Xa.3.2.2.m1.1b"><apply id="S3.E8Xa.3.2.2.m1.1.1.1.1.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1"><eq id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E8Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.2">absent</csymbol><apply id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3"><csymbol cd="latexml" id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.1">direct-product</csymbol><apply id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2"><root id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2a.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2"></root><apply id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2"><minus id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.1"></minus><cn id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.2.cmml" type="integer" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.2">1</cn><apply id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3.1.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3">superscript</csymbol><apply id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3.2.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3.2.1.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3">subscript</csymbol><ci id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3.2.2.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3.2.2">𝛼</ci><ci id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3.2.3.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3.2.3">𝑡</ci></apply><cn id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3.3.cmml" type="integer" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.3.3">2</cn></apply></apply></apply><apply id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.3.1.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.3.2.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.3.2">𝑖</ci><ci id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.3.3.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8Xa.3.2.2.m1.1c">\displaystyle=\sqrt{1-\alpha_{t}^{2}}\odot i_{t},\ </annotation><annotation encoding="application/x-llamapun" id="S3.E8Xa.3.2.2.m1.1d">= square-root start_ARG 1 - italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ⊙ italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS2.p4.8">where <math alttext="\Lambda" class="ltx_Math" display="inline" id="S3.SS2.p4.5.m1.1"><semantics id="S3.SS2.p4.5.m1.1a"><mi id="S3.SS2.p4.5.m1.1.1" mathvariant="normal" xref="S3.SS2.p4.5.m1.1.1.cmml">Λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m1.1b"><ci id="S3.SS2.p4.5.m1.1.1.cmml" xref="S3.SS2.p4.5.m1.1.1">Λ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m1.1c">\Lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.5.m1.1d">roman_Λ</annotation></semantics></math> is a learnable parameter for the recurrent gate, with the exponential function of a negative value, <math alttext="\alpha_{t}" class="ltx_Math" display="inline" id="S3.SS2.p4.6.m2.1"><semantics id="S3.SS2.p4.6.m2.1a"><msub id="S3.SS2.p4.6.m2.1.1" xref="S3.SS2.p4.6.m2.1.1.cmml"><mi id="S3.SS2.p4.6.m2.1.1.2" xref="S3.SS2.p4.6.m2.1.1.2.cmml">α</mi><mi id="S3.SS2.p4.6.m2.1.1.3" xref="S3.SS2.p4.6.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m2.1b"><apply id="S3.SS2.p4.6.m2.1.1.cmml" xref="S3.SS2.p4.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.6.m2.1.1.1.cmml" xref="S3.SS2.p4.6.m2.1.1">subscript</csymbol><ci id="S3.SS2.p4.6.m2.1.1.2.cmml" xref="S3.SS2.p4.6.m2.1.1.2">𝛼</ci><ci id="S3.SS2.p4.6.m2.1.1.3.cmml" xref="S3.SS2.p4.6.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m2.1c">\alpha_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.6.m2.1d">italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is guaranteed to be in <math alttext="[0,1]" class="ltx_Math" display="inline" id="S3.SS2.p4.7.m3.2"><semantics id="S3.SS2.p4.7.m3.2a"><mrow id="S3.SS2.p4.7.m3.2.3.2" xref="S3.SS2.p4.7.m3.2.3.1.cmml"><mo id="S3.SS2.p4.7.m3.2.3.2.1" stretchy="false" xref="S3.SS2.p4.7.m3.2.3.1.cmml">[</mo><mn id="S3.SS2.p4.7.m3.1.1" xref="S3.SS2.p4.7.m3.1.1.cmml">0</mn><mo id="S3.SS2.p4.7.m3.2.3.2.2" xref="S3.SS2.p4.7.m3.2.3.1.cmml">,</mo><mn id="S3.SS2.p4.7.m3.2.2" xref="S3.SS2.p4.7.m3.2.2.cmml">1</mn><mo id="S3.SS2.p4.7.m3.2.3.2.3" stretchy="false" xref="S3.SS2.p4.7.m3.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.7.m3.2b"><interval closure="closed" id="S3.SS2.p4.7.m3.2.3.1.cmml" xref="S3.SS2.p4.7.m3.2.3.2"><cn id="S3.SS2.p4.7.m3.1.1.cmml" type="integer" xref="S3.SS2.p4.7.m3.1.1">0</cn><cn id="S3.SS2.p4.7.m3.2.2.cmml" type="integer" xref="S3.SS2.p4.7.m3.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.7.m3.2c">[0,1]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.7.m3.2d">[ 0 , 1 ]</annotation></semantics></math>, and the square root term ensures the same for <math alttext="\beta_{t}\in[0,1]" class="ltx_Math" display="inline" id="S3.SS2.p4.8.m4.2"><semantics id="S3.SS2.p4.8.m4.2a"><mrow id="S3.SS2.p4.8.m4.2.3" xref="S3.SS2.p4.8.m4.2.3.cmml"><msub id="S3.SS2.p4.8.m4.2.3.2" xref="S3.SS2.p4.8.m4.2.3.2.cmml"><mi id="S3.SS2.p4.8.m4.2.3.2.2" xref="S3.SS2.p4.8.m4.2.3.2.2.cmml">β</mi><mi id="S3.SS2.p4.8.m4.2.3.2.3" xref="S3.SS2.p4.8.m4.2.3.2.3.cmml">t</mi></msub><mo id="S3.SS2.p4.8.m4.2.3.1" xref="S3.SS2.p4.8.m4.2.3.1.cmml">∈</mo><mrow id="S3.SS2.p4.8.m4.2.3.3.2" xref="S3.SS2.p4.8.m4.2.3.3.1.cmml"><mo id="S3.SS2.p4.8.m4.2.3.3.2.1" stretchy="false" xref="S3.SS2.p4.8.m4.2.3.3.1.cmml">[</mo><mn id="S3.SS2.p4.8.m4.1.1" xref="S3.SS2.p4.8.m4.1.1.cmml">0</mn><mo id="S3.SS2.p4.8.m4.2.3.3.2.2" xref="S3.SS2.p4.8.m4.2.3.3.1.cmml">,</mo><mn id="S3.SS2.p4.8.m4.2.2" xref="S3.SS2.p4.8.m4.2.2.cmml">1</mn><mo id="S3.SS2.p4.8.m4.2.3.3.2.3" stretchy="false" xref="S3.SS2.p4.8.m4.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.8.m4.2b"><apply id="S3.SS2.p4.8.m4.2.3.cmml" xref="S3.SS2.p4.8.m4.2.3"><in id="S3.SS2.p4.8.m4.2.3.1.cmml" xref="S3.SS2.p4.8.m4.2.3.1"></in><apply id="S3.SS2.p4.8.m4.2.3.2.cmml" xref="S3.SS2.p4.8.m4.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p4.8.m4.2.3.2.1.cmml" xref="S3.SS2.p4.8.m4.2.3.2">subscript</csymbol><ci id="S3.SS2.p4.8.m4.2.3.2.2.cmml" xref="S3.SS2.p4.8.m4.2.3.2.2">𝛽</ci><ci id="S3.SS2.p4.8.m4.2.3.2.3.cmml" xref="S3.SS2.p4.8.m4.2.3.2.3">𝑡</ci></apply><interval closure="closed" id="S3.SS2.p4.8.m4.2.3.3.1.cmml" xref="S3.SS2.p4.8.m4.2.3.3.2"><cn id="S3.SS2.p4.8.m4.1.1.cmml" type="integer" xref="S3.SS2.p4.8.m4.1.1">0</cn><cn id="S3.SS2.p4.8.m4.2.2.cmml" type="integer" xref="S3.SS2.p4.8.m4.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.8.m4.2c">\beta_{t}\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.8.m4.2d">italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ [ 0 , 1 ]</annotation></semantics></math>. This formulation ensures the stability of the linear recurrence unit.</p>
</div>
<div class="ltx_para" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.5">For the custom initialization scheme of <math alttext="\Lambda" class="ltx_Math" display="inline" id="S3.SS2.p5.1.m1.1"><semantics id="S3.SS2.p5.1.m1.1a"><mi id="S3.SS2.p5.1.m1.1.1" mathvariant="normal" xref="S3.SS2.p5.1.m1.1.1.cmml">Λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><ci id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">Λ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">\Lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.1.m1.1d">roman_Λ</annotation></semantics></math>, we follow the empirical setting from LRU <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">orvieto2023resurrecting</span>)</cite> that ensures <math alttext="\exp(-\operatorname{softplus}(\Lambda))" class="ltx_Math" display="inline" id="S3.SS2.p5.2.m2.4"><semantics id="S3.SS2.p5.2.m2.4a"><mrow id="S3.SS2.p5.2.m2.4.4.1" xref="S3.SS2.p5.2.m2.4.4.2.cmml"><mi id="S3.SS2.p5.2.m2.3.3" xref="S3.SS2.p5.2.m2.3.3.cmml">exp</mi><mo id="S3.SS2.p5.2.m2.4.4.1a" xref="S3.SS2.p5.2.m2.4.4.2.cmml">⁡</mo><mrow id="S3.SS2.p5.2.m2.4.4.1.1" xref="S3.SS2.p5.2.m2.4.4.2.cmml"><mo id="S3.SS2.p5.2.m2.4.4.1.1.2" stretchy="false" xref="S3.SS2.p5.2.m2.4.4.2.cmml">(</mo><mrow id="S3.SS2.p5.2.m2.4.4.1.1.1" xref="S3.SS2.p5.2.m2.4.4.1.1.1.cmml"><mo id="S3.SS2.p5.2.m2.4.4.1.1.1a" rspace="0.167em" xref="S3.SS2.p5.2.m2.4.4.1.1.1.cmml">−</mo><mrow id="S3.SS2.p5.2.m2.4.4.1.1.1.2.2" xref="S3.SS2.p5.2.m2.4.4.1.1.1.2.1.cmml"><mi id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml">softplus</mi><mo id="S3.SS2.p5.2.m2.4.4.1.1.1.2.2a" xref="S3.SS2.p5.2.m2.4.4.1.1.1.2.1.cmml">⁡</mo><mrow id="S3.SS2.p5.2.m2.4.4.1.1.1.2.2.1" xref="S3.SS2.p5.2.m2.4.4.1.1.1.2.1.cmml"><mo id="S3.SS2.p5.2.m2.4.4.1.1.1.2.2.1.1" stretchy="false" xref="S3.SS2.p5.2.m2.4.4.1.1.1.2.1.cmml">(</mo><mi id="S3.SS2.p5.2.m2.2.2" mathvariant="normal" xref="S3.SS2.p5.2.m2.2.2.cmml">Λ</mi><mo id="S3.SS2.p5.2.m2.4.4.1.1.1.2.2.1.2" stretchy="false" xref="S3.SS2.p5.2.m2.4.4.1.1.1.2.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS2.p5.2.m2.4.4.1.1.3" stretchy="false" xref="S3.SS2.p5.2.m2.4.4.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.4b"><apply id="S3.SS2.p5.2.m2.4.4.2.cmml" xref="S3.SS2.p5.2.m2.4.4.1"><exp id="S3.SS2.p5.2.m2.3.3.cmml" xref="S3.SS2.p5.2.m2.3.3"></exp><apply id="S3.SS2.p5.2.m2.4.4.1.1.1.cmml" xref="S3.SS2.p5.2.m2.4.4.1.1.1"><minus id="S3.SS2.p5.2.m2.4.4.1.1.1.1.cmml" xref="S3.SS2.p5.2.m2.4.4.1.1.1"></minus><apply id="S3.SS2.p5.2.m2.4.4.1.1.1.2.1.cmml" xref="S3.SS2.p5.2.m2.4.4.1.1.1.2.2"><ci id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">softplus</ci><ci id="S3.SS2.p5.2.m2.2.2.cmml" xref="S3.SS2.p5.2.m2.2.2">Λ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.4c">\exp(-\operatorname{softplus}(\Lambda))</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.2.m2.4d">roman_exp ( - roman_softplus ( roman_Λ ) )</annotation></semantics></math> is uniformly distributed in <math alttext="[0.9,0.999]" class="ltx_Math" display="inline" id="S3.SS2.p5.3.m3.2"><semantics id="S3.SS2.p5.3.m3.2a"><mrow id="S3.SS2.p5.3.m3.2.3.2" xref="S3.SS2.p5.3.m3.2.3.1.cmml"><mo id="S3.SS2.p5.3.m3.2.3.2.1" stretchy="false" xref="S3.SS2.p5.3.m3.2.3.1.cmml">[</mo><mn id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml">0.9</mn><mo id="S3.SS2.p5.3.m3.2.3.2.2" xref="S3.SS2.p5.3.m3.2.3.1.cmml">,</mo><mn id="S3.SS2.p5.3.m3.2.2" xref="S3.SS2.p5.3.m3.2.2.cmml">0.999</mn><mo id="S3.SS2.p5.3.m3.2.3.2.3" stretchy="false" xref="S3.SS2.p5.3.m3.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.2b"><interval closure="closed" id="S3.SS2.p5.3.m3.2.3.1.cmml" xref="S3.SS2.p5.3.m3.2.3.2"><cn id="S3.SS2.p5.3.m3.1.1.cmml" type="float" xref="S3.SS2.p5.3.m3.1.1">0.9</cn><cn id="S3.SS2.p5.3.m3.2.2.cmml" type="float" xref="S3.SS2.p5.3.m3.2.2">0.999</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.2c">[0.9,0.999]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.3.m3.2d">[ 0.9 , 0.999 ]</annotation></semantics></math>. This custom initialization helps yield better performance and stable training as shown in  <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">orvieto2023resurrecting</span>)</cite>.
The input gate <math alttext="i_{t}" class="ltx_Math" display="inline" id="S3.SS2.p5.4.m4.1"><semantics id="S3.SS2.p5.4.m4.1a"><msub id="S3.SS2.p5.4.m4.1.1" xref="S3.SS2.p5.4.m4.1.1.cmml"><mi id="S3.SS2.p5.4.m4.1.1.2" xref="S3.SS2.p5.4.m4.1.1.2.cmml">i</mi><mi id="S3.SS2.p5.4.m4.1.1.3" xref="S3.SS2.p5.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m4.1b"><apply id="S3.SS2.p5.4.m4.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.4.m4.1.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p5.4.m4.1.1.2.cmml" xref="S3.SS2.p5.4.m4.1.1.2">𝑖</ci><ci id="S3.SS2.p5.4.m4.1.1.3.cmml" xref="S3.SS2.p5.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.1c">i_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.4.m4.1d">italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> can filter the input latent <math alttext="x_{t}" class="ltx_Math" display="inline" id="S3.SS2.p5.5.m5.1"><semantics id="S3.SS2.p5.5.m5.1a"><msub id="S3.SS2.p5.5.m5.1.1" xref="S3.SS2.p5.5.m5.1.1.cmml"><mi id="S3.SS2.p5.5.m5.1.1.2" xref="S3.SS2.p5.5.m5.1.1.2.cmml">x</mi><mi id="S3.SS2.p5.5.m5.1.1.3" xref="S3.SS2.p5.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.5.m5.1b"><apply id="S3.SS2.p5.5.m5.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.5.m5.1.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p5.5.m5.1.1.2.cmml" xref="S3.SS2.p5.5.m5.1.1.2">𝑥</ci><ci id="S3.SS2.p5.5.m5.1.1.3.cmml" xref="S3.SS2.p5.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.5.m5.1c">x_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.5.m5.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. The recurrence state can mitigate the influence of irrelevant or noisy inputs and selectively focus on relevant information from the inputs and historical behaviors.
Although linear recurrence values can depend only linearly on previous elements, the stacking of linear recurrent layers separated by non-linearities allows for a non-linear dependence on the past. In this sense, the non-linear depth of a linear recurrent network is the number of layers rather than the sequence length. Stacking gated LRU layers allows for rich non-linear dependence on previous events while still taking advantage of fast parallel sequence evaluation.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Hardware-Aware Parallel Scan</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Previous linear recurrent units have efficiency constraints that the learnable parameters need to be independent of the inputs of different time steps to perform efficient computation. Moreover, to perform eigendecomposition of the diagonal matrix <math alttext="A" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_A</annotation></semantics></math> in Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S3.E5" title="Equation 5 ‣ 3.2. Behavior-Dependent Linear Recurrent Units ‣ 3. Methodology ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>, the parameters of LRUs must be complex-valued. This complex-value constraint introduces additional parameters without improving performance. Since we have to discard the previous training scheme in LRUs and use real-valued parameters, we employ a hardware-aware parallel scan algorithm to achieve efficient parallelizable training for our BD-LRUs.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.5">Since deep learning accelerators like GPUs are only optimized for operators like matrix multiplications and convolutions, we develop an efficient custom CUDA kernel for our BD-LRUs, implemented in OpenAI’s Triton <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">tillet2019triton</span>)</cite>, which is a language and compiler for GPU programming and parallel computing. Our hardware-aware algorithm is based on scans <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">blelloch1990prefix</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">martin2017parallelizing</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">smith2022simplified</span>)</cite>. It has been shown in <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">ladner1980parallel</span>)</cite> that there exist algorithms for parallel scans when <math alttext="\oplus" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><mo id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><csymbol cd="latexml" id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">⊕</annotation></semantics></math> is associative, <em class="ltx_emph ltx_font_italic" id="S3.SS3.p2.5.1">i.e.</em>, <math alttext="(a\oplus b)\oplus c=a\oplus(b\oplus c)" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.2"><semantics id="S3.SS3.p2.2.m2.2a"><mrow id="S3.SS3.p2.2.m2.2.2" xref="S3.SS3.p2.2.m2.2.2.cmml"><mrow id="S3.SS3.p2.2.m2.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.cmml"><mrow id="S3.SS3.p2.2.m2.1.1.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p2.2.m2.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.2.m2.1.1.1.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.1.1.1.1.2" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.2.cmml">a</mi><mo id="S3.SS3.p2.2.m2.1.1.1.1.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.1.cmml">⊕</mo><mi id="S3.SS3.p2.2.m2.1.1.1.1.1.1.3" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.3.cmml">b</mi></mrow><mo id="S3.SS3.p2.2.m2.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS3.p2.2.m2.1.1.1.2" xref="S3.SS3.p2.2.m2.1.1.1.2.cmml">⊕</mo><mi id="S3.SS3.p2.2.m2.1.1.1.3" xref="S3.SS3.p2.2.m2.1.1.1.3.cmml">c</mi></mrow><mo id="S3.SS3.p2.2.m2.2.2.3" xref="S3.SS3.p2.2.m2.2.2.3.cmml">=</mo><mrow id="S3.SS3.p2.2.m2.2.2.2" xref="S3.SS3.p2.2.m2.2.2.2.cmml"><mi id="S3.SS3.p2.2.m2.2.2.2.3" xref="S3.SS3.p2.2.m2.2.2.2.3.cmml">a</mi><mo id="S3.SS3.p2.2.m2.2.2.2.2" xref="S3.SS3.p2.2.m2.2.2.2.2.cmml">⊕</mo><mrow id="S3.SS3.p2.2.m2.2.2.2.1.1" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.cmml"><mo id="S3.SS3.p2.2.m2.2.2.2.1.1.2" stretchy="false" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.2.m2.2.2.2.1.1.1" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.cmml"><mi id="S3.SS3.p2.2.m2.2.2.2.1.1.1.2" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.2.cmml">b</mi><mo id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.cmml">⊕</mo><mi id="S3.SS3.p2.2.m2.2.2.2.1.1.1.3" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.3.cmml">c</mi></mrow><mo id="S3.SS3.p2.2.m2.2.2.2.1.1.3" stretchy="false" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.2b"><apply id="S3.SS3.p2.2.m2.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2"><eq id="S3.SS3.p2.2.m2.2.2.3.cmml" xref="S3.SS3.p2.2.m2.2.2.3"></eq><apply id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.2.m2.1.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.1.2">direct-sum</csymbol><apply id="S3.SS3.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.1">direct-sum</csymbol><ci id="S3.SS3.p2.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.2">𝑎</ci><ci id="S3.SS3.p2.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.3">𝑏</ci></apply><ci id="S3.SS3.p2.2.m2.1.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.1.3">𝑐</ci></apply><apply id="S3.SS3.p2.2.m2.2.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2"><csymbol cd="latexml" id="S3.SS3.p2.2.m2.2.2.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2.2">direct-sum</csymbol><ci id="S3.SS3.p2.2.m2.2.2.2.3.cmml" xref="S3.SS3.p2.2.m2.2.2.2.3">𝑎</ci><apply id="S3.SS3.p2.2.m2.2.2.2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1"><csymbol cd="latexml" id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1">direct-sum</csymbol><ci id="S3.SS3.p2.2.m2.2.2.2.1.1.1.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.2">𝑏</ci><ci id="S3.SS3.p2.2.m2.2.2.2.1.1.1.3.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.2c">(a\oplus b)\oplus c=a\oplus(b\oplus c)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.2d">( italic_a ⊕ italic_b ) ⊕ italic_c = italic_a ⊕ ( italic_b ⊕ italic_c )</annotation></semantics></math>. Given a binary associative operator <math alttext="\oplus" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><mo id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><csymbol cd="latexml" id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">⊕</annotation></semantics></math> and a sequence of <math alttext="n" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.1"><semantics id="S3.SS3.p2.4.m4.1a"><mi id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><ci id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.1d">italic_n</annotation></semantics></math> elements <math alttext="a_{1:n}" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.1"><semantics id="S3.SS3.p2.5.m5.1a"><msub id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">a</mi><mrow id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml"><mn id="S3.SS3.p2.5.m5.1.1.3.2" xref="S3.SS3.p2.5.m5.1.1.3.2.cmml">1</mn><mo id="S3.SS3.p2.5.m5.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.p2.5.m5.1.1.3.1.cmml">:</mo><mi id="S3.SS3.p2.5.m5.1.1.3.3" xref="S3.SS3.p2.5.m5.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">𝑎</ci><apply id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3"><ci id="S3.SS3.p2.5.m5.1.1.3.1.cmml" xref="S3.SS3.p2.5.m5.1.1.3.1">:</ci><cn id="S3.SS3.p2.5.m5.1.1.3.2.cmml" type="integer" xref="S3.SS3.p2.5.m5.1.1.3.2">1</cn><ci id="S3.SS3.p2.5.m5.1.1.3.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">a_{1:n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.1d">italic_a start_POSTSUBSCRIPT 1 : italic_n end_POSTSUBSCRIPT</annotation></semantics></math>, the scan operation is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{Scan}\left(\oplus,a_{1:n}\right)=[a_{1},(a_{2}\oplus a_{1}),%
\dots,(a_{n}\oplus\dots\oplus a_{2}\oplus a_{1})]." class="ltx_Math" display="block" id="S3.E9.m1.4"><semantics id="S3.E9.m1.4a"><mrow id="S3.E9.m1.4.4.1" xref="S3.E9.m1.4.4.1.1.cmml"><mrow id="S3.E9.m1.4.4.1.1" xref="S3.E9.m1.4.4.1.1.cmml"><mrow id="S3.E9.m1.4.4.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.2.cmml"><mi id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml">Scan</mi><mo id="S3.E9.m1.4.4.1.1.1.1a" xref="S3.E9.m1.4.4.1.1.1.2.cmml">⁡</mo><mrow id="S3.E9.m1.4.4.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.2.cmml"><mo id="S3.E9.m1.4.4.1.1.1.1.1.2" xref="S3.E9.m1.4.4.1.1.1.2.cmml">(</mo><mo id="S3.E9.m1.2.2" lspace="0em" rspace="0em" xref="S3.E9.m1.2.2.cmml">⊕</mo><mo id="S3.E9.m1.4.4.1.1.1.1.1.3" xref="S3.E9.m1.4.4.1.1.1.2.cmml">,</mo><msub id="S3.E9.m1.4.4.1.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.4.4.1.1.1.1.1.1.2" xref="S3.E9.m1.4.4.1.1.1.1.1.1.2.cmml">a</mi><mrow id="S3.E9.m1.4.4.1.1.1.1.1.1.3" xref="S3.E9.m1.4.4.1.1.1.1.1.1.3.cmml"><mn id="S3.E9.m1.4.4.1.1.1.1.1.1.3.2" xref="S3.E9.m1.4.4.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S3.E9.m1.4.4.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E9.m1.4.4.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S3.E9.m1.4.4.1.1.1.1.1.1.3.3" xref="S3.E9.m1.4.4.1.1.1.1.1.1.3.3.cmml">n</mi></mrow></msub><mo id="S3.E9.m1.4.4.1.1.1.1.1.4" xref="S3.E9.m1.4.4.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.4.4.1.1.5" xref="S3.E9.m1.4.4.1.1.5.cmml">=</mo><mrow id="S3.E9.m1.4.4.1.1.4.3" xref="S3.E9.m1.4.4.1.1.4.4.cmml"><mo id="S3.E9.m1.4.4.1.1.4.3.4" stretchy="false" xref="S3.E9.m1.4.4.1.1.4.4.cmml">[</mo><msub id="S3.E9.m1.4.4.1.1.2.1.1" xref="S3.E9.m1.4.4.1.1.2.1.1.cmml"><mi id="S3.E9.m1.4.4.1.1.2.1.1.2" xref="S3.E9.m1.4.4.1.1.2.1.1.2.cmml">a</mi><mn id="S3.E9.m1.4.4.1.1.2.1.1.3" xref="S3.E9.m1.4.4.1.1.2.1.1.3.cmml">1</mn></msub><mo id="S3.E9.m1.4.4.1.1.4.3.5" xref="S3.E9.m1.4.4.1.1.4.4.cmml">,</mo><mrow id="S3.E9.m1.4.4.1.1.3.2.2.1" xref="S3.E9.m1.4.4.1.1.3.2.2.1.1.cmml"><mo id="S3.E9.m1.4.4.1.1.3.2.2.1.2" stretchy="false" xref="S3.E9.m1.4.4.1.1.3.2.2.1.1.cmml">(</mo><mrow id="S3.E9.m1.4.4.1.1.3.2.2.1.1" xref="S3.E9.m1.4.4.1.1.3.2.2.1.1.cmml"><msub id="S3.E9.m1.4.4.1.1.3.2.2.1.1.2" xref="S3.E9.m1.4.4.1.1.3.2.2.1.1.2.cmml"><mi id="S3.E9.m1.4.4.1.1.3.2.2.1.1.2.2" xref="S3.E9.m1.4.4.1.1.3.2.2.1.1.2.2.cmml">a</mi><mn id="S3.E9.m1.4.4.1.1.3.2.2.1.1.2.3" xref="S3.E9.m1.4.4.1.1.3.2.2.1.1.2.3.cmml">2</mn></msub><mo id="S3.E9.m1.4.4.1.1.3.2.2.1.1.1" xref="S3.E9.m1.4.4.1.1.3.2.2.1.1.1.cmml">⊕</mo><msub id="S3.E9.m1.4.4.1.1.3.2.2.1.1.3" xref="S3.E9.m1.4.4.1.1.3.2.2.1.1.3.cmml"><mi id="S3.E9.m1.4.4.1.1.3.2.2.1.1.3.2" xref="S3.E9.m1.4.4.1.1.3.2.2.1.1.3.2.cmml">a</mi><mn id="S3.E9.m1.4.4.1.1.3.2.2.1.1.3.3" xref="S3.E9.m1.4.4.1.1.3.2.2.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.E9.m1.4.4.1.1.3.2.2.1.3" stretchy="false" xref="S3.E9.m1.4.4.1.1.3.2.2.1.1.cmml">)</mo></mrow><mo id="S3.E9.m1.4.4.1.1.4.3.6" xref="S3.E9.m1.4.4.1.1.4.4.cmml">,</mo><mi id="S3.E9.m1.3.3" mathvariant="normal" xref="S3.E9.m1.3.3.cmml">…</mi><mo id="S3.E9.m1.4.4.1.1.4.3.7" xref="S3.E9.m1.4.4.1.1.4.4.cmml">,</mo><mrow id="S3.E9.m1.4.4.1.1.4.3.3.1" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.cmml"><mo id="S3.E9.m1.4.4.1.1.4.3.3.1.2" stretchy="false" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.cmml">(</mo><mrow id="S3.E9.m1.4.4.1.1.4.3.3.1.1" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.cmml"><msub id="S3.E9.m1.4.4.1.1.4.3.3.1.1.2" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.2.cmml"><mi id="S3.E9.m1.4.4.1.1.4.3.3.1.1.2.2" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.2.2.cmml">a</mi><mi id="S3.E9.m1.4.4.1.1.4.3.3.1.1.2.3" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.2.3.cmml">n</mi></msub><mo id="S3.E9.m1.4.4.1.1.4.3.3.1.1.1" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.1.cmml">⊕</mo><mi id="S3.E9.m1.4.4.1.1.4.3.3.1.1.3" mathvariant="normal" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.3.cmml">⋯</mi><mo id="S3.E9.m1.4.4.1.1.4.3.3.1.1.1a" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.1.cmml">⊕</mo><msub id="S3.E9.m1.4.4.1.1.4.3.3.1.1.4" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.4.cmml"><mi id="S3.E9.m1.4.4.1.1.4.3.3.1.1.4.2" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.4.2.cmml">a</mi><mn id="S3.E9.m1.4.4.1.1.4.3.3.1.1.4.3" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.4.3.cmml">2</mn></msub><mo id="S3.E9.m1.4.4.1.1.4.3.3.1.1.1b" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.1.cmml">⊕</mo><msub id="S3.E9.m1.4.4.1.1.4.3.3.1.1.5" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.5.cmml"><mi id="S3.E9.m1.4.4.1.1.4.3.3.1.1.5.2" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.5.2.cmml">a</mi><mn id="S3.E9.m1.4.4.1.1.4.3.3.1.1.5.3" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.5.3.cmml">1</mn></msub></mrow><mo id="S3.E9.m1.4.4.1.1.4.3.3.1.3" stretchy="false" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.cmml">)</mo></mrow><mo id="S3.E9.m1.4.4.1.1.4.3.8" stretchy="false" xref="S3.E9.m1.4.4.1.1.4.4.cmml">]</mo></mrow></mrow><mo id="S3.E9.m1.4.4.1.2" lspace="0em" xref="S3.E9.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.4b"><apply id="S3.E9.m1.4.4.1.1.cmml" xref="S3.E9.m1.4.4.1"><eq id="S3.E9.m1.4.4.1.1.5.cmml" xref="S3.E9.m1.4.4.1.1.5"></eq><apply id="S3.E9.m1.4.4.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.1.1"><ci id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1">Scan</ci><csymbol cd="latexml" id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2">direct-sum</csymbol><apply id="S3.E9.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.2">𝑎</ci><apply id="S3.E9.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.3"><ci id="S3.E9.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.3.1">:</ci><cn id="S3.E9.m1.4.4.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.E9.m1.4.4.1.1.1.1.1.1.3.2">1</cn><ci id="S3.E9.m1.4.4.1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.3.3">𝑛</ci></apply></apply></apply><list id="S3.E9.m1.4.4.1.1.4.4.cmml" xref="S3.E9.m1.4.4.1.1.4.3"><apply id="S3.E9.m1.4.4.1.1.2.1.1.cmml" xref="S3.E9.m1.4.4.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.2.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.2.1.1">subscript</csymbol><ci id="S3.E9.m1.4.4.1.1.2.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.2.1.1.2">𝑎</ci><cn id="S3.E9.m1.4.4.1.1.2.1.1.3.cmml" type="integer" xref="S3.E9.m1.4.4.1.1.2.1.1.3">1</cn></apply><apply id="S3.E9.m1.4.4.1.1.3.2.2.1.1.cmml" xref="S3.E9.m1.4.4.1.1.3.2.2.1"><csymbol cd="latexml" id="S3.E9.m1.4.4.1.1.3.2.2.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.3.2.2.1.1.1">direct-sum</csymbol><apply id="S3.E9.m1.4.4.1.1.3.2.2.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.3.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.3.2.2.1.1.2.1.cmml" xref="S3.E9.m1.4.4.1.1.3.2.2.1.1.2">subscript</csymbol><ci id="S3.E9.m1.4.4.1.1.3.2.2.1.1.2.2.cmml" xref="S3.E9.m1.4.4.1.1.3.2.2.1.1.2.2">𝑎</ci><cn id="S3.E9.m1.4.4.1.1.3.2.2.1.1.2.3.cmml" type="integer" xref="S3.E9.m1.4.4.1.1.3.2.2.1.1.2.3">2</cn></apply><apply id="S3.E9.m1.4.4.1.1.3.2.2.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.3.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.3.2.2.1.1.3.1.cmml" xref="S3.E9.m1.4.4.1.1.3.2.2.1.1.3">subscript</csymbol><ci id="S3.E9.m1.4.4.1.1.3.2.2.1.1.3.2.cmml" xref="S3.E9.m1.4.4.1.1.3.2.2.1.1.3.2">𝑎</ci><cn id="S3.E9.m1.4.4.1.1.3.2.2.1.1.3.3.cmml" type="integer" xref="S3.E9.m1.4.4.1.1.3.2.2.1.1.3.3">1</cn></apply></apply><ci id="S3.E9.m1.3.3.cmml" xref="S3.E9.m1.3.3">…</ci><apply id="S3.E9.m1.4.4.1.1.4.3.3.1.1.cmml" xref="S3.E9.m1.4.4.1.1.4.3.3.1"><csymbol cd="latexml" id="S3.E9.m1.4.4.1.1.4.3.3.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.1">direct-sum</csymbol><apply id="S3.E9.m1.4.4.1.1.4.3.3.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.4.3.3.1.1.2.1.cmml" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.2">subscript</csymbol><ci id="S3.E9.m1.4.4.1.1.4.3.3.1.1.2.2.cmml" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.2.2">𝑎</ci><ci id="S3.E9.m1.4.4.1.1.4.3.3.1.1.2.3.cmml" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.2.3">𝑛</ci></apply><ci id="S3.E9.m1.4.4.1.1.4.3.3.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.3">⋯</ci><apply id="S3.E9.m1.4.4.1.1.4.3.3.1.1.4.cmml" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.4"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.4.3.3.1.1.4.1.cmml" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.4">subscript</csymbol><ci id="S3.E9.m1.4.4.1.1.4.3.3.1.1.4.2.cmml" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.4.2">𝑎</ci><cn id="S3.E9.m1.4.4.1.1.4.3.3.1.1.4.3.cmml" type="integer" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.4.3">2</cn></apply><apply id="S3.E9.m1.4.4.1.1.4.3.3.1.1.5.cmml" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.5"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.4.3.3.1.1.5.1.cmml" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.5">subscript</csymbol><ci id="S3.E9.m1.4.4.1.1.4.3.3.1.1.5.2.cmml" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.5.2">𝑎</ci><cn id="S3.E9.m1.4.4.1.1.4.3.3.1.1.5.3.cmml" type="integer" xref="S3.E9.m1.4.4.1.1.4.3.3.1.1.5.3">1</cn></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.4c">\operatorname{Scan}\left(\oplus,a_{1:n}\right)=[a_{1},(a_{2}\oplus a_{1}),%
\dots,(a_{n}\oplus\dots\oplus a_{2}\oplus a_{1})].</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.4d">roman_Scan ( ⊕ , italic_a start_POSTSUBSCRIPT 1 : italic_n end_POSTSUBSCRIPT ) = [ italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ( italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ⊕ italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) , … , ( italic_a start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ⊕ ⋯ ⊕ italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ⊕ italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.7">The first-order recurrence is defined as Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S3.E5" title="Equation 5 ‣ 3.2. Behavior-Dependent Linear Recurrent Units ‣ 3. Methodology ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>, where both element-wise multiplication and addition are associative operators (<em class="ltx_emph ltx_font_italic" id="S3.SS3.p2.7.1">i.e.</em>, <math alttext="(a\odot b)\odot c=a\odot(b\odot c)" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m1.2"><semantics id="S3.SS3.p2.6.m1.2a"><mrow id="S3.SS3.p2.6.m1.2.2" xref="S3.SS3.p2.6.m1.2.2.cmml"><mrow id="S3.SS3.p2.6.m1.1.1.1" xref="S3.SS3.p2.6.m1.1.1.1.cmml"><mrow id="S3.SS3.p2.6.m1.1.1.1.1.1" xref="S3.SS3.p2.6.m1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p2.6.m1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p2.6.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.6.m1.1.1.1.1.1.1" xref="S3.SS3.p2.6.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.6.m1.1.1.1.1.1.1.2" xref="S3.SS3.p2.6.m1.1.1.1.1.1.1.2.cmml">a</mi><mo id="S3.SS3.p2.6.m1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p2.6.m1.1.1.1.1.1.1.1.cmml">⊙</mo><mi id="S3.SS3.p2.6.m1.1.1.1.1.1.1.3" xref="S3.SS3.p2.6.m1.1.1.1.1.1.1.3.cmml">b</mi></mrow><mo id="S3.SS3.p2.6.m1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS3.p2.6.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS3.p2.6.m1.1.1.1.2" rspace="0.222em" xref="S3.SS3.p2.6.m1.1.1.1.2.cmml">⊙</mo><mi id="S3.SS3.p2.6.m1.1.1.1.3" xref="S3.SS3.p2.6.m1.1.1.1.3.cmml">c</mi></mrow><mo id="S3.SS3.p2.6.m1.2.2.3" xref="S3.SS3.p2.6.m1.2.2.3.cmml">=</mo><mrow id="S3.SS3.p2.6.m1.2.2.2" xref="S3.SS3.p2.6.m1.2.2.2.cmml"><mi id="S3.SS3.p2.6.m1.2.2.2.3" xref="S3.SS3.p2.6.m1.2.2.2.3.cmml">a</mi><mo id="S3.SS3.p2.6.m1.2.2.2.2" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p2.6.m1.2.2.2.2.cmml">⊙</mo><mrow id="S3.SS3.p2.6.m1.2.2.2.1.1" xref="S3.SS3.p2.6.m1.2.2.2.1.1.1.cmml"><mo id="S3.SS3.p2.6.m1.2.2.2.1.1.2" stretchy="false" xref="S3.SS3.p2.6.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.6.m1.2.2.2.1.1.1" xref="S3.SS3.p2.6.m1.2.2.2.1.1.1.cmml"><mi id="S3.SS3.p2.6.m1.2.2.2.1.1.1.2" xref="S3.SS3.p2.6.m1.2.2.2.1.1.1.2.cmml">b</mi><mo id="S3.SS3.p2.6.m1.2.2.2.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p2.6.m1.2.2.2.1.1.1.1.cmml">⊙</mo><mi id="S3.SS3.p2.6.m1.2.2.2.1.1.1.3" xref="S3.SS3.p2.6.m1.2.2.2.1.1.1.3.cmml">c</mi></mrow><mo id="S3.SS3.p2.6.m1.2.2.2.1.1.3" stretchy="false" xref="S3.SS3.p2.6.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m1.2b"><apply id="S3.SS3.p2.6.m1.2.2.cmml" xref="S3.SS3.p2.6.m1.2.2"><eq id="S3.SS3.p2.6.m1.2.2.3.cmml" xref="S3.SS3.p2.6.m1.2.2.3"></eq><apply id="S3.SS3.p2.6.m1.1.1.1.cmml" xref="S3.SS3.p2.6.m1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.6.m1.1.1.1.2.cmml" xref="S3.SS3.p2.6.m1.1.1.1.2">direct-product</csymbol><apply id="S3.SS3.p2.6.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.6.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.6.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.6.m1.1.1.1.1.1.1.1">direct-product</csymbol><ci id="S3.SS3.p2.6.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.6.m1.1.1.1.1.1.1.2">𝑎</ci><ci id="S3.SS3.p2.6.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.6.m1.1.1.1.1.1.1.3">𝑏</ci></apply><ci id="S3.SS3.p2.6.m1.1.1.1.3.cmml" xref="S3.SS3.p2.6.m1.1.1.1.3">𝑐</ci></apply><apply id="S3.SS3.p2.6.m1.2.2.2.cmml" xref="S3.SS3.p2.6.m1.2.2.2"><csymbol cd="latexml" id="S3.SS3.p2.6.m1.2.2.2.2.cmml" xref="S3.SS3.p2.6.m1.2.2.2.2">direct-product</csymbol><ci id="S3.SS3.p2.6.m1.2.2.2.3.cmml" xref="S3.SS3.p2.6.m1.2.2.2.3">𝑎</ci><apply id="S3.SS3.p2.6.m1.2.2.2.1.1.1.cmml" xref="S3.SS3.p2.6.m1.2.2.2.1.1"><csymbol cd="latexml" id="S3.SS3.p2.6.m1.2.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.6.m1.2.2.2.1.1.1.1">direct-product</csymbol><ci id="S3.SS3.p2.6.m1.2.2.2.1.1.1.2.cmml" xref="S3.SS3.p2.6.m1.2.2.2.1.1.1.2">𝑏</ci><ci id="S3.SS3.p2.6.m1.2.2.2.1.1.1.3.cmml" xref="S3.SS3.p2.6.m1.2.2.2.1.1.1.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m1.2c">(a\odot b)\odot c=a\odot(b\odot c)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m1.2d">( italic_a ⊙ italic_b ) ⊙ italic_c = italic_a ⊙ ( italic_b ⊙ italic_c )</annotation></semantics></math> and <math alttext="(a+b)+c=a+(b+c)" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m2.2"><semantics id="S3.SS3.p2.7.m2.2a"><mrow id="S3.SS3.p2.7.m2.2.2" xref="S3.SS3.p2.7.m2.2.2.cmml"><mrow id="S3.SS3.p2.7.m2.1.1.1" xref="S3.SS3.p2.7.m2.1.1.1.cmml"><mrow id="S3.SS3.p2.7.m2.1.1.1.1.1" xref="S3.SS3.p2.7.m2.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p2.7.m2.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p2.7.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.7.m2.1.1.1.1.1.1" xref="S3.SS3.p2.7.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.7.m2.1.1.1.1.1.1.2" xref="S3.SS3.p2.7.m2.1.1.1.1.1.1.2.cmml">a</mi><mo id="S3.SS3.p2.7.m2.1.1.1.1.1.1.1" xref="S3.SS3.p2.7.m2.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.SS3.p2.7.m2.1.1.1.1.1.1.3" xref="S3.SS3.p2.7.m2.1.1.1.1.1.1.3.cmml">b</mi></mrow><mo id="S3.SS3.p2.7.m2.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p2.7.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS3.p2.7.m2.1.1.1.2" xref="S3.SS3.p2.7.m2.1.1.1.2.cmml">+</mo><mi id="S3.SS3.p2.7.m2.1.1.1.3" xref="S3.SS3.p2.7.m2.1.1.1.3.cmml">c</mi></mrow><mo id="S3.SS3.p2.7.m2.2.2.3" xref="S3.SS3.p2.7.m2.2.2.3.cmml">=</mo><mrow id="S3.SS3.p2.7.m2.2.2.2" xref="S3.SS3.p2.7.m2.2.2.2.cmml"><mi id="S3.SS3.p2.7.m2.2.2.2.3" xref="S3.SS3.p2.7.m2.2.2.2.3.cmml">a</mi><mo id="S3.SS3.p2.7.m2.2.2.2.2" xref="S3.SS3.p2.7.m2.2.2.2.2.cmml">+</mo><mrow id="S3.SS3.p2.7.m2.2.2.2.1.1" xref="S3.SS3.p2.7.m2.2.2.2.1.1.1.cmml"><mo id="S3.SS3.p2.7.m2.2.2.2.1.1.2" stretchy="false" xref="S3.SS3.p2.7.m2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.7.m2.2.2.2.1.1.1" xref="S3.SS3.p2.7.m2.2.2.2.1.1.1.cmml"><mi id="S3.SS3.p2.7.m2.2.2.2.1.1.1.2" xref="S3.SS3.p2.7.m2.2.2.2.1.1.1.2.cmml">b</mi><mo id="S3.SS3.p2.7.m2.2.2.2.1.1.1.1" xref="S3.SS3.p2.7.m2.2.2.2.1.1.1.1.cmml">+</mo><mi id="S3.SS3.p2.7.m2.2.2.2.1.1.1.3" xref="S3.SS3.p2.7.m2.2.2.2.1.1.1.3.cmml">c</mi></mrow><mo id="S3.SS3.p2.7.m2.2.2.2.1.1.3" stretchy="false" xref="S3.SS3.p2.7.m2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m2.2b"><apply id="S3.SS3.p2.7.m2.2.2.cmml" xref="S3.SS3.p2.7.m2.2.2"><eq id="S3.SS3.p2.7.m2.2.2.3.cmml" xref="S3.SS3.p2.7.m2.2.2.3"></eq><apply id="S3.SS3.p2.7.m2.1.1.1.cmml" xref="S3.SS3.p2.7.m2.1.1.1"><plus id="S3.SS3.p2.7.m2.1.1.1.2.cmml" xref="S3.SS3.p2.7.m2.1.1.1.2"></plus><apply id="S3.SS3.p2.7.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.7.m2.1.1.1.1.1"><plus id="S3.SS3.p2.7.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.7.m2.1.1.1.1.1.1.1"></plus><ci id="S3.SS3.p2.7.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.7.m2.1.1.1.1.1.1.2">𝑎</ci><ci id="S3.SS3.p2.7.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.7.m2.1.1.1.1.1.1.3">𝑏</ci></apply><ci id="S3.SS3.p2.7.m2.1.1.1.3.cmml" xref="S3.SS3.p2.7.m2.1.1.1.3">𝑐</ci></apply><apply id="S3.SS3.p2.7.m2.2.2.2.cmml" xref="S3.SS3.p2.7.m2.2.2.2"><plus id="S3.SS3.p2.7.m2.2.2.2.2.cmml" xref="S3.SS3.p2.7.m2.2.2.2.2"></plus><ci id="S3.SS3.p2.7.m2.2.2.2.3.cmml" xref="S3.SS3.p2.7.m2.2.2.2.3">𝑎</ci><apply id="S3.SS3.p2.7.m2.2.2.2.1.1.1.cmml" xref="S3.SS3.p2.7.m2.2.2.2.1.1"><plus id="S3.SS3.p2.7.m2.2.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.7.m2.2.2.2.1.1.1.1"></plus><ci id="S3.SS3.p2.7.m2.2.2.2.1.1.1.2.cmml" xref="S3.SS3.p2.7.m2.2.2.2.1.1.1.2">𝑏</ci><ci id="S3.SS3.p2.7.m2.2.2.2.1.1.1.3.cmml" xref="S3.SS3.p2.7.m2.2.2.2.1.1.1.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m2.2c">(a+b)+c=a+(b+c)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m2.2d">( italic_a + italic_b ) + italic_c = italic_a + ( italic_b + italic_c )</annotation></semantics></math>). For simplicity, we express it in:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h_{t}=\begin{cases}c_{1}&amp;\text{ if }t=1\\
c_{t}\bullet h_{t-1}&amp;\text{ if }1&lt;t\leq T,\end{cases}" class="ltx_Math" display="block" id="S3.E10.m1.4"><semantics id="S3.E10.m1.4a"><mrow id="S3.E10.m1.4.5" xref="S3.E10.m1.4.5.cmml"><msub id="S3.E10.m1.4.5.2" xref="S3.E10.m1.4.5.2.cmml"><mi id="S3.E10.m1.4.5.2.2" xref="S3.E10.m1.4.5.2.2.cmml">h</mi><mi id="S3.E10.m1.4.5.2.3" xref="S3.E10.m1.4.5.2.3.cmml">t</mi></msub><mo id="S3.E10.m1.4.5.1" xref="S3.E10.m1.4.5.1.cmml">=</mo><mrow id="S3.E10.m1.4.4" xref="S3.E10.m1.4.5.3.1.cmml"><mo id="S3.E10.m1.4.4.5" xref="S3.E10.m1.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E10.m1.4.4.4" rowspacing="0pt" xref="S3.E10.m1.4.5.3.1.cmml"><mtr id="S3.E10.m1.4.4.4a" xref="S3.E10.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.4.4.4b" xref="S3.E10.m1.4.5.3.1.cmml"><msub id="S3.E10.m1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.2.cmml">c</mi><mn id="S3.E10.m1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.3.cmml">1</mn></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.4.4.4c" xref="S3.E10.m1.4.5.3.1.cmml"><mrow id="S3.E10.m1.2.2.2.2.2.1" xref="S3.E10.m1.2.2.2.2.2.1.cmml"><mrow id="S3.E10.m1.2.2.2.2.2.1.2" xref="S3.E10.m1.2.2.2.2.2.1.2.cmml"><mtext id="S3.E10.m1.2.2.2.2.2.1.2.2" xref="S3.E10.m1.2.2.2.2.2.1.2.2a.cmml"> if </mtext><mo id="S3.E10.m1.2.2.2.2.2.1.2.1" xref="S3.E10.m1.2.2.2.2.2.1.2.1.cmml">⁢</mo><mi id="S3.E10.m1.2.2.2.2.2.1.2.3" xref="S3.E10.m1.2.2.2.2.2.1.2.3.cmml">t</mi></mrow><mo id="S3.E10.m1.2.2.2.2.2.1.1" xref="S3.E10.m1.2.2.2.2.2.1.1.cmml">=</mo><mn id="S3.E10.m1.2.2.2.2.2.1.3" xref="S3.E10.m1.2.2.2.2.2.1.3.cmml">1</mn></mrow></mtd></mtr><mtr id="S3.E10.m1.4.4.4d" xref="S3.E10.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.4.4.4e" xref="S3.E10.m1.4.5.3.1.cmml"><mrow id="S3.E10.m1.3.3.3.3.1.1" xref="S3.E10.m1.3.3.3.3.1.1.cmml"><msub id="S3.E10.m1.3.3.3.3.1.1.2" xref="S3.E10.m1.3.3.3.3.1.1.2.cmml"><mi id="S3.E10.m1.3.3.3.3.1.1.2.2" xref="S3.E10.m1.3.3.3.3.1.1.2.2.cmml">c</mi><mi id="S3.E10.m1.3.3.3.3.1.1.2.3" xref="S3.E10.m1.3.3.3.3.1.1.2.3.cmml">t</mi></msub><mo id="S3.E10.m1.3.3.3.3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.E10.m1.3.3.3.3.1.1.1.cmml">∙</mo><msub id="S3.E10.m1.3.3.3.3.1.1.3" xref="S3.E10.m1.3.3.3.3.1.1.3.cmml"><mi id="S3.E10.m1.3.3.3.3.1.1.3.2" xref="S3.E10.m1.3.3.3.3.1.1.3.2.cmml">h</mi><mrow id="S3.E10.m1.3.3.3.3.1.1.3.3" xref="S3.E10.m1.3.3.3.3.1.1.3.3.cmml"><mi id="S3.E10.m1.3.3.3.3.1.1.3.3.2" xref="S3.E10.m1.3.3.3.3.1.1.3.3.2.cmml">t</mi><mo id="S3.E10.m1.3.3.3.3.1.1.3.3.1" xref="S3.E10.m1.3.3.3.3.1.1.3.3.1.cmml">−</mo><mn id="S3.E10.m1.3.3.3.3.1.1.3.3.3" xref="S3.E10.m1.3.3.3.3.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.4.4.4f" xref="S3.E10.m1.4.5.3.1.cmml"><mrow id="S3.E10.m1.4.4.4.4.2.1.1" xref="S3.E10.m1.4.4.4.4.2.1.1.1.cmml"><mrow id="S3.E10.m1.4.4.4.4.2.1.1.1" xref="S3.E10.m1.4.4.4.4.2.1.1.1.cmml"><mrow id="S3.E10.m1.4.4.4.4.2.1.1.1.2" xref="S3.E10.m1.4.4.4.4.2.1.1.1.2.cmml"><mtext id="S3.E10.m1.4.4.4.4.2.1.1.1.2.2" xref="S3.E10.m1.4.4.4.4.2.1.1.1.2.2a.cmml"> if </mtext><mo id="S3.E10.m1.4.4.4.4.2.1.1.1.2.1" xref="S3.E10.m1.4.4.4.4.2.1.1.1.2.1.cmml">⁢</mo><mn id="S3.E10.m1.4.4.4.4.2.1.1.1.2.3" xref="S3.E10.m1.4.4.4.4.2.1.1.1.2.3.cmml">1</mn></mrow><mo id="S3.E10.m1.4.4.4.4.2.1.1.1.3" xref="S3.E10.m1.4.4.4.4.2.1.1.1.3.cmml">&lt;</mo><mi id="S3.E10.m1.4.4.4.4.2.1.1.1.4" xref="S3.E10.m1.4.4.4.4.2.1.1.1.4.cmml">t</mi><mo id="S3.E10.m1.4.4.4.4.2.1.1.1.5" xref="S3.E10.m1.4.4.4.4.2.1.1.1.5.cmml">≤</mo><mi id="S3.E10.m1.4.4.4.4.2.1.1.1.6" xref="S3.E10.m1.4.4.4.4.2.1.1.1.6.cmml">T</mi></mrow><mo id="S3.E10.m1.4.4.4.4.2.1.1.2" xref="S3.E10.m1.4.4.4.4.2.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.4b"><apply id="S3.E10.m1.4.5.cmml" xref="S3.E10.m1.4.5"><eq id="S3.E10.m1.4.5.1.cmml" xref="S3.E10.m1.4.5.1"></eq><apply id="S3.E10.m1.4.5.2.cmml" xref="S3.E10.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E10.m1.4.5.2.1.cmml" xref="S3.E10.m1.4.5.2">subscript</csymbol><ci id="S3.E10.m1.4.5.2.2.cmml" xref="S3.E10.m1.4.5.2.2">ℎ</ci><ci id="S3.E10.m1.4.5.2.3.cmml" xref="S3.E10.m1.4.5.2.3">𝑡</ci></apply><apply id="S3.E10.m1.4.5.3.1.cmml" xref="S3.E10.m1.4.4"><csymbol cd="latexml" id="S3.E10.m1.4.5.3.1.1.cmml" xref="S3.E10.m1.4.4.5">cases</csymbol><apply id="S3.E10.m1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2">𝑐</ci><cn id="S3.E10.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E10.m1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E10.m1.2.2.2.2.2.1.cmml" xref="S3.E10.m1.2.2.2.2.2.1"><eq id="S3.E10.m1.2.2.2.2.2.1.1.cmml" xref="S3.E10.m1.2.2.2.2.2.1.1"></eq><apply id="S3.E10.m1.2.2.2.2.2.1.2.cmml" xref="S3.E10.m1.2.2.2.2.2.1.2"><times id="S3.E10.m1.2.2.2.2.2.1.2.1.cmml" xref="S3.E10.m1.2.2.2.2.2.1.2.1"></times><ci id="S3.E10.m1.2.2.2.2.2.1.2.2a.cmml" xref="S3.E10.m1.2.2.2.2.2.1.2.2"><mtext id="S3.E10.m1.2.2.2.2.2.1.2.2.cmml" xref="S3.E10.m1.2.2.2.2.2.1.2.2"> if </mtext></ci><ci id="S3.E10.m1.2.2.2.2.2.1.2.3.cmml" xref="S3.E10.m1.2.2.2.2.2.1.2.3">𝑡</ci></apply><cn id="S3.E10.m1.2.2.2.2.2.1.3.cmml" type="integer" xref="S3.E10.m1.2.2.2.2.2.1.3">1</cn></apply><apply id="S3.E10.m1.3.3.3.3.1.1.cmml" xref="S3.E10.m1.3.3.3.3.1.1"><ci id="S3.E10.m1.3.3.3.3.1.1.1.cmml" xref="S3.E10.m1.3.3.3.3.1.1.1">∙</ci><apply id="S3.E10.m1.3.3.3.3.1.1.2.cmml" xref="S3.E10.m1.3.3.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.3.3.1.1.2.1.cmml" xref="S3.E10.m1.3.3.3.3.1.1.2">subscript</csymbol><ci id="S3.E10.m1.3.3.3.3.1.1.2.2.cmml" xref="S3.E10.m1.3.3.3.3.1.1.2.2">𝑐</ci><ci id="S3.E10.m1.3.3.3.3.1.1.2.3.cmml" xref="S3.E10.m1.3.3.3.3.1.1.2.3">𝑡</ci></apply><apply id="S3.E10.m1.3.3.3.3.1.1.3.cmml" xref="S3.E10.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.3.3.1.1.3.1.cmml" xref="S3.E10.m1.3.3.3.3.1.1.3">subscript</csymbol><ci id="S3.E10.m1.3.3.3.3.1.1.3.2.cmml" xref="S3.E10.m1.3.3.3.3.1.1.3.2">ℎ</ci><apply id="S3.E10.m1.3.3.3.3.1.1.3.3.cmml" xref="S3.E10.m1.3.3.3.3.1.1.3.3"><minus id="S3.E10.m1.3.3.3.3.1.1.3.3.1.cmml" xref="S3.E10.m1.3.3.3.3.1.1.3.3.1"></minus><ci id="S3.E10.m1.3.3.3.3.1.1.3.3.2.cmml" xref="S3.E10.m1.3.3.3.3.1.1.3.3.2">𝑡</ci><cn id="S3.E10.m1.3.3.3.3.1.1.3.3.3.cmml" type="integer" xref="S3.E10.m1.3.3.3.3.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S3.E10.m1.4.4.4.4.2.1.1.1.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1"><and id="S3.E10.m1.4.4.4.4.2.1.1.1a.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1"></and><apply id="S3.E10.m1.4.4.4.4.2.1.1.1b.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1"><lt id="S3.E10.m1.4.4.4.4.2.1.1.1.3.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1.1.3"></lt><apply id="S3.E10.m1.4.4.4.4.2.1.1.1.2.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1.1.2"><times id="S3.E10.m1.4.4.4.4.2.1.1.1.2.1.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1.1.2.1"></times><ci id="S3.E10.m1.4.4.4.4.2.1.1.1.2.2a.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1.1.2.2"><mtext id="S3.E10.m1.4.4.4.4.2.1.1.1.2.2.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1.1.2.2"> if </mtext></ci><cn id="S3.E10.m1.4.4.4.4.2.1.1.1.2.3.cmml" type="integer" xref="S3.E10.m1.4.4.4.4.2.1.1.1.2.3">1</cn></apply><ci id="S3.E10.m1.4.4.4.4.2.1.1.1.4.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1.1.4">𝑡</ci></apply><apply id="S3.E10.m1.4.4.4.4.2.1.1.1c.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1"><leq id="S3.E10.m1.4.4.4.4.2.1.1.1.5.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1.1.5"></leq><share href="https://arxiv.org/html/2406.12580v2#S3.E10.m1.4.4.4.4.2.1.1.1.4.cmml" id="S3.E10.m1.4.4.4.4.2.1.1.1d.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1"></share><ci id="S3.E10.m1.4.4.4.4.2.1.1.1.6.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1.1.6">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.4c">h_{t}=\begin{cases}c_{1}&amp;\text{ if }t=1\\
c_{t}\bullet h_{t-1}&amp;\text{ if }1&lt;t\leq T,\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.4d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = { start_ROW start_CELL italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_CELL start_CELL if italic_t = 1 end_CELL end_ROW start_ROW start_CELL italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∙ italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT end_CELL start_CELL if 1 &lt; italic_t ≤ italic_T , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.8">where <math alttext="c_{t}" class="ltx_Math" display="inline" id="S3.SS3.p2.8.m1.1"><semantics id="S3.SS3.p2.8.m1.1a"><msub id="S3.SS3.p2.8.m1.1.1" xref="S3.SS3.p2.8.m1.1.1.cmml"><mi id="S3.SS3.p2.8.m1.1.1.2" xref="S3.SS3.p2.8.m1.1.1.2.cmml">c</mi><mi id="S3.SS3.p2.8.m1.1.1.3" xref="S3.SS3.p2.8.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m1.1b"><apply id="S3.SS3.p2.8.m1.1.1.cmml" xref="S3.SS3.p2.8.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m1.1.1.1.cmml" xref="S3.SS3.p2.8.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.8.m1.1.1.2.cmml" xref="S3.SS3.p2.8.m1.1.1.2">𝑐</ci><ci id="S3.SS3.p2.8.m1.1.1.3.cmml" xref="S3.SS3.p2.8.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m1.1c">c_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.8.m1.1d">italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="c_{t}=\begin{cases}\beta^{\prime}_{1}&amp;\text{ if }t=1\\
(\alpha_{t},\beta^{\prime}_{t})&amp;\text{ if }1&lt;t\leq T,\end{cases}" class="ltx_Math" display="block" id="S3.E11.m1.4"><semantics id="S3.E11.m1.4a"><mrow id="S3.E11.m1.4.5" xref="S3.E11.m1.4.5.cmml"><msub id="S3.E11.m1.4.5.2" xref="S3.E11.m1.4.5.2.cmml"><mi id="S3.E11.m1.4.5.2.2" xref="S3.E11.m1.4.5.2.2.cmml">c</mi><mi id="S3.E11.m1.4.5.2.3" xref="S3.E11.m1.4.5.2.3.cmml">t</mi></msub><mo id="S3.E11.m1.4.5.1" xref="S3.E11.m1.4.5.1.cmml">=</mo><mrow id="S3.E11.m1.4.4" xref="S3.E11.m1.4.5.3.1.cmml"><mo id="S3.E11.m1.4.4.5" xref="S3.E11.m1.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E11.m1.4.4.4" rowspacing="0pt" xref="S3.E11.m1.4.5.3.1.cmml"><mtr id="S3.E11.m1.4.4.4a" xref="S3.E11.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E11.m1.4.4.4b" xref="S3.E11.m1.4.5.3.1.cmml"><msubsup id="S3.E11.m1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.1.1.1.1.1.1.2.2" xref="S3.E11.m1.1.1.1.1.1.1.2.2.cmml">β</mi><mn id="S3.E11.m1.1.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.1.1.3.cmml">1</mn><mo id="S3.E11.m1.1.1.1.1.1.1.2.3" xref="S3.E11.m1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E11.m1.4.4.4c" xref="S3.E11.m1.4.5.3.1.cmml"><mrow id="S3.E11.m1.2.2.2.2.2.1" xref="S3.E11.m1.2.2.2.2.2.1.cmml"><mrow id="S3.E11.m1.2.2.2.2.2.1.2" xref="S3.E11.m1.2.2.2.2.2.1.2.cmml"><mtext id="S3.E11.m1.2.2.2.2.2.1.2.2" xref="S3.E11.m1.2.2.2.2.2.1.2.2a.cmml"> if </mtext><mo id="S3.E11.m1.2.2.2.2.2.1.2.1" xref="S3.E11.m1.2.2.2.2.2.1.2.1.cmml">⁢</mo><mi id="S3.E11.m1.2.2.2.2.2.1.2.3" xref="S3.E11.m1.2.2.2.2.2.1.2.3.cmml">t</mi></mrow><mo id="S3.E11.m1.2.2.2.2.2.1.1" xref="S3.E11.m1.2.2.2.2.2.1.1.cmml">=</mo><mn id="S3.E11.m1.2.2.2.2.2.1.3" xref="S3.E11.m1.2.2.2.2.2.1.3.cmml">1</mn></mrow></mtd></mtr><mtr id="S3.E11.m1.4.4.4d" xref="S3.E11.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E11.m1.4.4.4e" xref="S3.E11.m1.4.5.3.1.cmml"><mrow id="S3.E11.m1.3.3.3.3.1.1.2" xref="S3.E11.m1.3.3.3.3.1.1.3.cmml"><mo id="S3.E11.m1.3.3.3.3.1.1.2.3" stretchy="false" xref="S3.E11.m1.3.3.3.3.1.1.3.cmml">(</mo><msub id="S3.E11.m1.3.3.3.3.1.1.1.1" xref="S3.E11.m1.3.3.3.3.1.1.1.1.cmml"><mi id="S3.E11.m1.3.3.3.3.1.1.1.1.2" xref="S3.E11.m1.3.3.3.3.1.1.1.1.2.cmml">α</mi><mi id="S3.E11.m1.3.3.3.3.1.1.1.1.3" xref="S3.E11.m1.3.3.3.3.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E11.m1.3.3.3.3.1.1.2.4" xref="S3.E11.m1.3.3.3.3.1.1.3.cmml">,</mo><msubsup id="S3.E11.m1.3.3.3.3.1.1.2.2" xref="S3.E11.m1.3.3.3.3.1.1.2.2.cmml"><mi id="S3.E11.m1.3.3.3.3.1.1.2.2.2.2" xref="S3.E11.m1.3.3.3.3.1.1.2.2.2.2.cmml">β</mi><mi id="S3.E11.m1.3.3.3.3.1.1.2.2.3" xref="S3.E11.m1.3.3.3.3.1.1.2.2.3.cmml">t</mi><mo id="S3.E11.m1.3.3.3.3.1.1.2.2.2.3" xref="S3.E11.m1.3.3.3.3.1.1.2.2.2.3.cmml">′</mo></msubsup><mo id="S3.E11.m1.3.3.3.3.1.1.2.5" stretchy="false" xref="S3.E11.m1.3.3.3.3.1.1.3.cmml">)</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E11.m1.4.4.4f" xref="S3.E11.m1.4.5.3.1.cmml"><mrow id="S3.E11.m1.4.4.4.4.2.1.1" xref="S3.E11.m1.4.4.4.4.2.1.1.1.cmml"><mrow id="S3.E11.m1.4.4.4.4.2.1.1.1" xref="S3.E11.m1.4.4.4.4.2.1.1.1.cmml"><mrow id="S3.E11.m1.4.4.4.4.2.1.1.1.2" xref="S3.E11.m1.4.4.4.4.2.1.1.1.2.cmml"><mtext id="S3.E11.m1.4.4.4.4.2.1.1.1.2.2" xref="S3.E11.m1.4.4.4.4.2.1.1.1.2.2a.cmml"> if </mtext><mo id="S3.E11.m1.4.4.4.4.2.1.1.1.2.1" xref="S3.E11.m1.4.4.4.4.2.1.1.1.2.1.cmml">⁢</mo><mn id="S3.E11.m1.4.4.4.4.2.1.1.1.2.3" xref="S3.E11.m1.4.4.4.4.2.1.1.1.2.3.cmml">1</mn></mrow><mo id="S3.E11.m1.4.4.4.4.2.1.1.1.3" xref="S3.E11.m1.4.4.4.4.2.1.1.1.3.cmml">&lt;</mo><mi id="S3.E11.m1.4.4.4.4.2.1.1.1.4" xref="S3.E11.m1.4.4.4.4.2.1.1.1.4.cmml">t</mi><mo id="S3.E11.m1.4.4.4.4.2.1.1.1.5" xref="S3.E11.m1.4.4.4.4.2.1.1.1.5.cmml">≤</mo><mi id="S3.E11.m1.4.4.4.4.2.1.1.1.6" xref="S3.E11.m1.4.4.4.4.2.1.1.1.6.cmml">T</mi></mrow><mo id="S3.E11.m1.4.4.4.4.2.1.1.2" xref="S3.E11.m1.4.4.4.4.2.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.4b"><apply id="S3.E11.m1.4.5.cmml" xref="S3.E11.m1.4.5"><eq id="S3.E11.m1.4.5.1.cmml" xref="S3.E11.m1.4.5.1"></eq><apply id="S3.E11.m1.4.5.2.cmml" xref="S3.E11.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E11.m1.4.5.2.1.cmml" xref="S3.E11.m1.4.5.2">subscript</csymbol><ci id="S3.E11.m1.4.5.2.2.cmml" xref="S3.E11.m1.4.5.2.2">𝑐</ci><ci id="S3.E11.m1.4.5.2.3.cmml" xref="S3.E11.m1.4.5.2.3">𝑡</ci></apply><apply id="S3.E11.m1.4.5.3.1.cmml" xref="S3.E11.m1.4.4"><csymbol cd="latexml" id="S3.E11.m1.4.5.3.1.1.cmml" xref="S3.E11.m1.4.4.5">cases</csymbol><apply id="S3.E11.m1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E11.m1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E11.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.2.2">𝛽</ci><ci id="S3.E11.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.2.3">′</ci></apply><cn id="S3.E11.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E11.m1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E11.m1.2.2.2.2.2.1.cmml" xref="S3.E11.m1.2.2.2.2.2.1"><eq id="S3.E11.m1.2.2.2.2.2.1.1.cmml" xref="S3.E11.m1.2.2.2.2.2.1.1"></eq><apply id="S3.E11.m1.2.2.2.2.2.1.2.cmml" xref="S3.E11.m1.2.2.2.2.2.1.2"><times id="S3.E11.m1.2.2.2.2.2.1.2.1.cmml" xref="S3.E11.m1.2.2.2.2.2.1.2.1"></times><ci id="S3.E11.m1.2.2.2.2.2.1.2.2a.cmml" xref="S3.E11.m1.2.2.2.2.2.1.2.2"><mtext id="S3.E11.m1.2.2.2.2.2.1.2.2.cmml" xref="S3.E11.m1.2.2.2.2.2.1.2.2"> if </mtext></ci><ci id="S3.E11.m1.2.2.2.2.2.1.2.3.cmml" xref="S3.E11.m1.2.2.2.2.2.1.2.3">𝑡</ci></apply><cn id="S3.E11.m1.2.2.2.2.2.1.3.cmml" type="integer" xref="S3.E11.m1.2.2.2.2.2.1.3">1</cn></apply><interval closure="open" id="S3.E11.m1.3.3.3.3.1.1.3.cmml" xref="S3.E11.m1.3.3.3.3.1.1.2"><apply id="S3.E11.m1.3.3.3.3.1.1.1.1.cmml" xref="S3.E11.m1.3.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S3.E11.m1.3.3.3.3.1.1.1.1">subscript</csymbol><ci id="S3.E11.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S3.E11.m1.3.3.3.3.1.1.1.1.2">𝛼</ci><ci id="S3.E11.m1.3.3.3.3.1.1.1.1.3.cmml" xref="S3.E11.m1.3.3.3.3.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E11.m1.3.3.3.3.1.1.2.2.cmml" xref="S3.E11.m1.3.3.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.3.3.1.1.2.2.1.cmml" xref="S3.E11.m1.3.3.3.3.1.1.2.2">subscript</csymbol><apply id="S3.E11.m1.3.3.3.3.1.1.2.2.2.cmml" xref="S3.E11.m1.3.3.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.3.3.1.1.2.2.2.1.cmml" xref="S3.E11.m1.3.3.3.3.1.1.2.2">superscript</csymbol><ci id="S3.E11.m1.3.3.3.3.1.1.2.2.2.2.cmml" xref="S3.E11.m1.3.3.3.3.1.1.2.2.2.2">𝛽</ci><ci id="S3.E11.m1.3.3.3.3.1.1.2.2.2.3.cmml" xref="S3.E11.m1.3.3.3.3.1.1.2.2.2.3">′</ci></apply><ci id="S3.E11.m1.3.3.3.3.1.1.2.2.3.cmml" xref="S3.E11.m1.3.3.3.3.1.1.2.2.3">𝑡</ci></apply></interval><apply id="S3.E11.m1.4.4.4.4.2.1.1.1.cmml" xref="S3.E11.m1.4.4.4.4.2.1.1"><and id="S3.E11.m1.4.4.4.4.2.1.1.1a.cmml" xref="S3.E11.m1.4.4.4.4.2.1.1"></and><apply id="S3.E11.m1.4.4.4.4.2.1.1.1b.cmml" xref="S3.E11.m1.4.4.4.4.2.1.1"><lt id="S3.E11.m1.4.4.4.4.2.1.1.1.3.cmml" xref="S3.E11.m1.4.4.4.4.2.1.1.1.3"></lt><apply id="S3.E11.m1.4.4.4.4.2.1.1.1.2.cmml" xref="S3.E11.m1.4.4.4.4.2.1.1.1.2"><times id="S3.E11.m1.4.4.4.4.2.1.1.1.2.1.cmml" xref="S3.E11.m1.4.4.4.4.2.1.1.1.2.1"></times><ci id="S3.E11.m1.4.4.4.4.2.1.1.1.2.2a.cmml" xref="S3.E11.m1.4.4.4.4.2.1.1.1.2.2"><mtext id="S3.E11.m1.4.4.4.4.2.1.1.1.2.2.cmml" xref="S3.E11.m1.4.4.4.4.2.1.1.1.2.2"> if </mtext></ci><cn id="S3.E11.m1.4.4.4.4.2.1.1.1.2.3.cmml" type="integer" xref="S3.E11.m1.4.4.4.4.2.1.1.1.2.3">1</cn></apply><ci id="S3.E11.m1.4.4.4.4.2.1.1.1.4.cmml" xref="S3.E11.m1.4.4.4.4.2.1.1.1.4">𝑡</ci></apply><apply id="S3.E11.m1.4.4.4.4.2.1.1.1c.cmml" xref="S3.E11.m1.4.4.4.4.2.1.1"><leq id="S3.E11.m1.4.4.4.4.2.1.1.1.5.cmml" xref="S3.E11.m1.4.4.4.4.2.1.1.1.5"></leq><share href="https://arxiv.org/html/2406.12580v2#S3.E11.m1.4.4.4.4.2.1.1.1.4.cmml" id="S3.E11.m1.4.4.4.4.2.1.1.1d.cmml" xref="S3.E11.m1.4.4.4.4.2.1.1"></share><ci id="S3.E11.m1.4.4.4.4.2.1.1.1.6.cmml" xref="S3.E11.m1.4.4.4.4.2.1.1.1.6">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.4c">c_{t}=\begin{cases}\beta^{\prime}_{1}&amp;\text{ if }t=1\\
(\alpha_{t},\beta^{\prime}_{t})&amp;\text{ if }1&lt;t\leq T,\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.4d">italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = { start_ROW start_CELL italic_β start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_CELL start_CELL if italic_t = 1 end_CELL end_ROW start_ROW start_CELL ( italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_β start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_CELL start_CELL if 1 &lt; italic_t ≤ italic_T , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.13">when <math alttext="t&gt;1" class="ltx_Math" display="inline" id="S3.SS3.p2.9.m1.1"><semantics id="S3.SS3.p2.9.m1.1a"><mrow id="S3.SS3.p2.9.m1.1.1" xref="S3.SS3.p2.9.m1.1.1.cmml"><mi id="S3.SS3.p2.9.m1.1.1.2" xref="S3.SS3.p2.9.m1.1.1.2.cmml">t</mi><mo id="S3.SS3.p2.9.m1.1.1.1" xref="S3.SS3.p2.9.m1.1.1.1.cmml">&gt;</mo><mn id="S3.SS3.p2.9.m1.1.1.3" xref="S3.SS3.p2.9.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m1.1b"><apply id="S3.SS3.p2.9.m1.1.1.cmml" xref="S3.SS3.p2.9.m1.1.1"><gt id="S3.SS3.p2.9.m1.1.1.1.cmml" xref="S3.SS3.p2.9.m1.1.1.1"></gt><ci id="S3.SS3.p2.9.m1.1.1.2.cmml" xref="S3.SS3.p2.9.m1.1.1.2">𝑡</ci><cn id="S3.SS3.p2.9.m1.1.1.3.cmml" type="integer" xref="S3.SS3.p2.9.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m1.1c">t&gt;1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.9.m1.1d">italic_t &gt; 1</annotation></semantics></math>, <math alttext="c_{t}" class="ltx_Math" display="inline" id="S3.SS3.p2.10.m2.1"><semantics id="S3.SS3.p2.10.m2.1a"><msub id="S3.SS3.p2.10.m2.1.1" xref="S3.SS3.p2.10.m2.1.1.cmml"><mi id="S3.SS3.p2.10.m2.1.1.2" xref="S3.SS3.p2.10.m2.1.1.2.cmml">c</mi><mi id="S3.SS3.p2.10.m2.1.1.3" xref="S3.SS3.p2.10.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m2.1b"><apply id="S3.SS3.p2.10.m2.1.1.cmml" xref="S3.SS3.p2.10.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.10.m2.1.1.1.cmml" xref="S3.SS3.p2.10.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.10.m2.1.1.2.cmml" xref="S3.SS3.p2.10.m2.1.1.2">𝑐</ci><ci id="S3.SS3.p2.10.m2.1.1.3.cmml" xref="S3.SS3.p2.10.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m2.1c">c_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.10.m2.1d">italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is an ordered pair. We use <math alttext="\beta^{\prime}_{t}" class="ltx_Math" display="inline" id="S3.SS3.p2.11.m3.1"><semantics id="S3.SS3.p2.11.m3.1a"><msubsup id="S3.SS3.p2.11.m3.1.1" xref="S3.SS3.p2.11.m3.1.1.cmml"><mi id="S3.SS3.p2.11.m3.1.1.2.2" xref="S3.SS3.p2.11.m3.1.1.2.2.cmml">β</mi><mi id="S3.SS3.p2.11.m3.1.1.3" xref="S3.SS3.p2.11.m3.1.1.3.cmml">t</mi><mo id="S3.SS3.p2.11.m3.1.1.2.3" xref="S3.SS3.p2.11.m3.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.11.m3.1b"><apply id="S3.SS3.p2.11.m3.1.1.cmml" xref="S3.SS3.p2.11.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.11.m3.1.1.1.cmml" xref="S3.SS3.p2.11.m3.1.1">subscript</csymbol><apply id="S3.SS3.p2.11.m3.1.1.2.cmml" xref="S3.SS3.p2.11.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.11.m3.1.1.2.1.cmml" xref="S3.SS3.p2.11.m3.1.1">superscript</csymbol><ci id="S3.SS3.p2.11.m3.1.1.2.2.cmml" xref="S3.SS3.p2.11.m3.1.1.2.2">𝛽</ci><ci id="S3.SS3.p2.11.m3.1.1.2.3.cmml" xref="S3.SS3.p2.11.m3.1.1.2.3">′</ci></apply><ci id="S3.SS3.p2.11.m3.1.1.3.cmml" xref="S3.SS3.p2.11.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.11.m3.1c">\beta^{\prime}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.11.m3.1d">italic_β start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to denote <math alttext="\beta_{t}\odot x_{t}" class="ltx_Math" display="inline" id="S3.SS3.p2.12.m4.1"><semantics id="S3.SS3.p2.12.m4.1a"><mrow id="S3.SS3.p2.12.m4.1.1" xref="S3.SS3.p2.12.m4.1.1.cmml"><msub id="S3.SS3.p2.12.m4.1.1.2" xref="S3.SS3.p2.12.m4.1.1.2.cmml"><mi id="S3.SS3.p2.12.m4.1.1.2.2" xref="S3.SS3.p2.12.m4.1.1.2.2.cmml">β</mi><mi id="S3.SS3.p2.12.m4.1.1.2.3" xref="S3.SS3.p2.12.m4.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS3.p2.12.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p2.12.m4.1.1.1.cmml">⊙</mo><msub id="S3.SS3.p2.12.m4.1.1.3" xref="S3.SS3.p2.12.m4.1.1.3.cmml"><mi id="S3.SS3.p2.12.m4.1.1.3.2" xref="S3.SS3.p2.12.m4.1.1.3.2.cmml">x</mi><mi id="S3.SS3.p2.12.m4.1.1.3.3" xref="S3.SS3.p2.12.m4.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.12.m4.1b"><apply id="S3.SS3.p2.12.m4.1.1.cmml" xref="S3.SS3.p2.12.m4.1.1"><csymbol cd="latexml" id="S3.SS3.p2.12.m4.1.1.1.cmml" xref="S3.SS3.p2.12.m4.1.1.1">direct-product</csymbol><apply id="S3.SS3.p2.12.m4.1.1.2.cmml" xref="S3.SS3.p2.12.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.12.m4.1.1.2.1.cmml" xref="S3.SS3.p2.12.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.12.m4.1.1.2.2.cmml" xref="S3.SS3.p2.12.m4.1.1.2.2">𝛽</ci><ci id="S3.SS3.p2.12.m4.1.1.2.3.cmml" xref="S3.SS3.p2.12.m4.1.1.2.3">𝑡</ci></apply><apply id="S3.SS3.p2.12.m4.1.1.3.cmml" xref="S3.SS3.p2.12.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.12.m4.1.1.3.1.cmml" xref="S3.SS3.p2.12.m4.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.12.m4.1.1.3.2.cmml" xref="S3.SS3.p2.12.m4.1.1.3.2">𝑥</ci><ci id="S3.SS3.p2.12.m4.1.1.3.3.cmml" xref="S3.SS3.p2.12.m4.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.12.m4.1c">\beta_{t}\odot x_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.12.m4.1d">italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⊙ italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> for simplicity. And the binary operator <math alttext="\bullet" class="ltx_Math" display="inline" id="S3.SS3.p2.13.m5.1"><semantics id="S3.SS3.p2.13.m5.1a"><mo id="S3.SS3.p2.13.m5.1.1" xref="S3.SS3.p2.13.m5.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.13.m5.1b"><ci id="S3.SS3.p2.13.m5.1.1.cmml" xref="S3.SS3.p2.13.m5.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.13.m5.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.13.m5.1d">∙</annotation></semantics></math> is defined as:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E12">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E12X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="3"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle c_{2}\bullet c_{1}" class="ltx_Math" display="inline" id="S3.E12X.2.1.1.m1.1"><semantics id="S3.E12X.2.1.1.m1.1a"><mrow id="S3.E12X.2.1.1.m1.1.1" xref="S3.E12X.2.1.1.m1.1.1.cmml"><msub id="S3.E12X.2.1.1.m1.1.1.2" xref="S3.E12X.2.1.1.m1.1.1.2.cmml"><mi id="S3.E12X.2.1.1.m1.1.1.2.2" xref="S3.E12X.2.1.1.m1.1.1.2.2.cmml">c</mi><mn id="S3.E12X.2.1.1.m1.1.1.2.3" xref="S3.E12X.2.1.1.m1.1.1.2.3.cmml">2</mn></msub><mo id="S3.E12X.2.1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.E12X.2.1.1.m1.1.1.1.cmml">∙</mo><msub id="S3.E12X.2.1.1.m1.1.1.3" xref="S3.E12X.2.1.1.m1.1.1.3.cmml"><mi id="S3.E12X.2.1.1.m1.1.1.3.2" xref="S3.E12X.2.1.1.m1.1.1.3.2.cmml">c</mi><mn id="S3.E12X.2.1.1.m1.1.1.3.3" xref="S3.E12X.2.1.1.m1.1.1.3.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.E12X.2.1.1.m1.1b"><apply id="S3.E12X.2.1.1.m1.1.1.cmml" xref="S3.E12X.2.1.1.m1.1.1"><ci id="S3.E12X.2.1.1.m1.1.1.1.cmml" xref="S3.E12X.2.1.1.m1.1.1.1">∙</ci><apply id="S3.E12X.2.1.1.m1.1.1.2.cmml" xref="S3.E12X.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E12X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E12X.2.1.1.m1.1.1.2">subscript</csymbol><ci id="S3.E12X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E12X.2.1.1.m1.1.1.2.2">𝑐</ci><cn id="S3.E12X.2.1.1.m1.1.1.2.3.cmml" type="integer" xref="S3.E12X.2.1.1.m1.1.1.2.3">2</cn></apply><apply id="S3.E12X.2.1.1.m1.1.1.3.cmml" xref="S3.E12X.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E12X.2.1.1.m1.1.1.3.1.cmml" xref="S3.E12X.2.1.1.m1.1.1.3">subscript</csymbol><ci id="S3.E12X.2.1.1.m1.1.1.3.2.cmml" xref="S3.E12X.2.1.1.m1.1.1.3.2">𝑐</ci><cn id="S3.E12X.2.1.1.m1.1.1.3.3.cmml" type="integer" xref="S3.E12X.2.1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12X.2.1.1.m1.1c">\displaystyle c_{2}\bullet c_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.E12X.2.1.1.m1.1d">italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∙ italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=(\alpha_{2},\beta^{\prime}_{2})\bullet\beta^{\prime}_{1}=\alpha_%
{2}\odot\beta^{\prime}_{1}+\beta^{\prime}_{2}" class="ltx_Math" display="inline" id="S3.E12X.3.2.2.m1.2"><semantics id="S3.E12X.3.2.2.m1.2a"><mrow id="S3.E12X.3.2.2.m1.2.2" xref="S3.E12X.3.2.2.m1.2.2.cmml"><mi id="S3.E12X.3.2.2.m1.2.2.4" xref="S3.E12X.3.2.2.m1.2.2.4.cmml"></mi><mo id="S3.E12X.3.2.2.m1.2.2.5" xref="S3.E12X.3.2.2.m1.2.2.5.cmml">=</mo><mrow id="S3.E12X.3.2.2.m1.2.2.2" xref="S3.E12X.3.2.2.m1.2.2.2.cmml"><mrow id="S3.E12X.3.2.2.m1.2.2.2.2.2" xref="S3.E12X.3.2.2.m1.2.2.2.2.3.cmml"><mo id="S3.E12X.3.2.2.m1.2.2.2.2.2.3" stretchy="false" xref="S3.E12X.3.2.2.m1.2.2.2.2.3.cmml">(</mo><msub id="S3.E12X.3.2.2.m1.1.1.1.1.1.1" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.cmml"><mi id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.cmml">α</mi><mn id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="S3.E12X.3.2.2.m1.2.2.2.2.2.4" xref="S3.E12X.3.2.2.m1.2.2.2.2.3.cmml">,</mo><msubsup id="S3.E12X.3.2.2.m1.2.2.2.2.2.2" xref="S3.E12X.3.2.2.m1.2.2.2.2.2.2.cmml"><mi id="S3.E12X.3.2.2.m1.2.2.2.2.2.2.2.2" xref="S3.E12X.3.2.2.m1.2.2.2.2.2.2.2.2.cmml">β</mi><mn id="S3.E12X.3.2.2.m1.2.2.2.2.2.2.3" xref="S3.E12X.3.2.2.m1.2.2.2.2.2.2.3.cmml">2</mn><mo id="S3.E12X.3.2.2.m1.2.2.2.2.2.2.2.3" xref="S3.E12X.3.2.2.m1.2.2.2.2.2.2.2.3.cmml">′</mo></msubsup><mo id="S3.E12X.3.2.2.m1.2.2.2.2.2.5" rspace="0.055em" stretchy="false" xref="S3.E12X.3.2.2.m1.2.2.2.2.3.cmml">)</mo></mrow><mo id="S3.E12X.3.2.2.m1.2.2.2.3" rspace="0.222em" xref="S3.E12X.3.2.2.m1.2.2.2.3.cmml">∙</mo><msubsup id="S3.E12X.3.2.2.m1.2.2.2.4" xref="S3.E12X.3.2.2.m1.2.2.2.4.cmml"><mi id="S3.E12X.3.2.2.m1.2.2.2.4.2.2" xref="S3.E12X.3.2.2.m1.2.2.2.4.2.2.cmml">β</mi><mn id="S3.E12X.3.2.2.m1.2.2.2.4.3" xref="S3.E12X.3.2.2.m1.2.2.2.4.3.cmml">1</mn><mo id="S3.E12X.3.2.2.m1.2.2.2.4.2.3" xref="S3.E12X.3.2.2.m1.2.2.2.4.2.3.cmml">′</mo></msubsup></mrow><mo id="S3.E12X.3.2.2.m1.2.2.6" xref="S3.E12X.3.2.2.m1.2.2.6.cmml">=</mo><mrow id="S3.E12X.3.2.2.m1.2.2.7" xref="S3.E12X.3.2.2.m1.2.2.7.cmml"><mrow id="S3.E12X.3.2.2.m1.2.2.7.2" xref="S3.E12X.3.2.2.m1.2.2.7.2.cmml"><msub id="S3.E12X.3.2.2.m1.2.2.7.2.2" xref="S3.E12X.3.2.2.m1.2.2.7.2.2.cmml"><mi id="S3.E12X.3.2.2.m1.2.2.7.2.2.2" xref="S3.E12X.3.2.2.m1.2.2.7.2.2.2.cmml">α</mi><mn id="S3.E12X.3.2.2.m1.2.2.7.2.2.3" xref="S3.E12X.3.2.2.m1.2.2.7.2.2.3.cmml">2</mn></msub><mo id="S3.E12X.3.2.2.m1.2.2.7.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E12X.3.2.2.m1.2.2.7.2.1.cmml">⊙</mo><msubsup id="S3.E12X.3.2.2.m1.2.2.7.2.3" xref="S3.E12X.3.2.2.m1.2.2.7.2.3.cmml"><mi id="S3.E12X.3.2.2.m1.2.2.7.2.3.2.2" xref="S3.E12X.3.2.2.m1.2.2.7.2.3.2.2.cmml">β</mi><mn id="S3.E12X.3.2.2.m1.2.2.7.2.3.3" xref="S3.E12X.3.2.2.m1.2.2.7.2.3.3.cmml">1</mn><mo id="S3.E12X.3.2.2.m1.2.2.7.2.3.2.3" xref="S3.E12X.3.2.2.m1.2.2.7.2.3.2.3.cmml">′</mo></msubsup></mrow><mo id="S3.E12X.3.2.2.m1.2.2.7.1" xref="S3.E12X.3.2.2.m1.2.2.7.1.cmml">+</mo><msubsup id="S3.E12X.3.2.2.m1.2.2.7.3" xref="S3.E12X.3.2.2.m1.2.2.7.3.cmml"><mi id="S3.E12X.3.2.2.m1.2.2.7.3.2.2" xref="S3.E12X.3.2.2.m1.2.2.7.3.2.2.cmml">β</mi><mn id="S3.E12X.3.2.2.m1.2.2.7.3.3" xref="S3.E12X.3.2.2.m1.2.2.7.3.3.cmml">2</mn><mo id="S3.E12X.3.2.2.m1.2.2.7.3.2.3" xref="S3.E12X.3.2.2.m1.2.2.7.3.2.3.cmml">′</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12X.3.2.2.m1.2b"><apply id="S3.E12X.3.2.2.m1.2.2.cmml" xref="S3.E12X.3.2.2.m1.2.2"><and id="S3.E12X.3.2.2.m1.2.2a.cmml" xref="S3.E12X.3.2.2.m1.2.2"></and><apply id="S3.E12X.3.2.2.m1.2.2b.cmml" xref="S3.E12X.3.2.2.m1.2.2"><eq id="S3.E12X.3.2.2.m1.2.2.5.cmml" xref="S3.E12X.3.2.2.m1.2.2.5"></eq><csymbol cd="latexml" id="S3.E12X.3.2.2.m1.2.2.4.cmml" xref="S3.E12X.3.2.2.m1.2.2.4">absent</csymbol><apply id="S3.E12X.3.2.2.m1.2.2.2.cmml" xref="S3.E12X.3.2.2.m1.2.2.2"><ci id="S3.E12X.3.2.2.m1.2.2.2.3.cmml" xref="S3.E12X.3.2.2.m1.2.2.2.3">∙</ci><interval closure="open" id="S3.E12X.3.2.2.m1.2.2.2.2.3.cmml" xref="S3.E12X.3.2.2.m1.2.2.2.2.2"><apply id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2">𝛼</ci><cn id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.3">2</cn></apply><apply id="S3.E12X.3.2.2.m1.2.2.2.2.2.2.cmml" xref="S3.E12X.3.2.2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E12X.3.2.2.m1.2.2.2.2.2.2.1.cmml" xref="S3.E12X.3.2.2.m1.2.2.2.2.2.2">subscript</csymbol><apply id="S3.E12X.3.2.2.m1.2.2.2.2.2.2.2.cmml" xref="S3.E12X.3.2.2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E12X.3.2.2.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E12X.3.2.2.m1.2.2.2.2.2.2">superscript</csymbol><ci id="S3.E12X.3.2.2.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E12X.3.2.2.m1.2.2.2.2.2.2.2.2">𝛽</ci><ci id="S3.E12X.3.2.2.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E12X.3.2.2.m1.2.2.2.2.2.2.2.3">′</ci></apply><cn id="S3.E12X.3.2.2.m1.2.2.2.2.2.2.3.cmml" type="integer" xref="S3.E12X.3.2.2.m1.2.2.2.2.2.2.3">2</cn></apply></interval><apply id="S3.E12X.3.2.2.m1.2.2.2.4.cmml" xref="S3.E12X.3.2.2.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E12X.3.2.2.m1.2.2.2.4.1.cmml" xref="S3.E12X.3.2.2.m1.2.2.2.4">subscript</csymbol><apply id="S3.E12X.3.2.2.m1.2.2.2.4.2.cmml" xref="S3.E12X.3.2.2.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E12X.3.2.2.m1.2.2.2.4.2.1.cmml" xref="S3.E12X.3.2.2.m1.2.2.2.4">superscript</csymbol><ci id="S3.E12X.3.2.2.m1.2.2.2.4.2.2.cmml" xref="S3.E12X.3.2.2.m1.2.2.2.4.2.2">𝛽</ci><ci id="S3.E12X.3.2.2.m1.2.2.2.4.2.3.cmml" xref="S3.E12X.3.2.2.m1.2.2.2.4.2.3">′</ci></apply><cn id="S3.E12X.3.2.2.m1.2.2.2.4.3.cmml" type="integer" xref="S3.E12X.3.2.2.m1.2.2.2.4.3">1</cn></apply></apply></apply><apply id="S3.E12X.3.2.2.m1.2.2c.cmml" xref="S3.E12X.3.2.2.m1.2.2"><eq id="S3.E12X.3.2.2.m1.2.2.6.cmml" xref="S3.E12X.3.2.2.m1.2.2.6"></eq><share href="https://arxiv.org/html/2406.12580v2#S3.E12X.3.2.2.m1.2.2.2.cmml" id="S3.E12X.3.2.2.m1.2.2d.cmml" xref="S3.E12X.3.2.2.m1.2.2"></share><apply id="S3.E12X.3.2.2.m1.2.2.7.cmml" xref="S3.E12X.3.2.2.m1.2.2.7"><plus id="S3.E12X.3.2.2.m1.2.2.7.1.cmml" xref="S3.E12X.3.2.2.m1.2.2.7.1"></plus><apply id="S3.E12X.3.2.2.m1.2.2.7.2.cmml" xref="S3.E12X.3.2.2.m1.2.2.7.2"><csymbol cd="latexml" id="S3.E12X.3.2.2.m1.2.2.7.2.1.cmml" xref="S3.E12X.3.2.2.m1.2.2.7.2.1">direct-product</csymbol><apply id="S3.E12X.3.2.2.m1.2.2.7.2.2.cmml" xref="S3.E12X.3.2.2.m1.2.2.7.2.2"><csymbol cd="ambiguous" id="S3.E12X.3.2.2.m1.2.2.7.2.2.1.cmml" xref="S3.E12X.3.2.2.m1.2.2.7.2.2">subscript</csymbol><ci id="S3.E12X.3.2.2.m1.2.2.7.2.2.2.cmml" xref="S3.E12X.3.2.2.m1.2.2.7.2.2.2">𝛼</ci><cn id="S3.E12X.3.2.2.m1.2.2.7.2.2.3.cmml" type="integer" xref="S3.E12X.3.2.2.m1.2.2.7.2.2.3">2</cn></apply><apply id="S3.E12X.3.2.2.m1.2.2.7.2.3.cmml" xref="S3.E12X.3.2.2.m1.2.2.7.2.3"><csymbol cd="ambiguous" id="S3.E12X.3.2.2.m1.2.2.7.2.3.1.cmml" xref="S3.E12X.3.2.2.m1.2.2.7.2.3">subscript</csymbol><apply id="S3.E12X.3.2.2.m1.2.2.7.2.3.2.cmml" xref="S3.E12X.3.2.2.m1.2.2.7.2.3"><csymbol cd="ambiguous" id="S3.E12X.3.2.2.m1.2.2.7.2.3.2.1.cmml" xref="S3.E12X.3.2.2.m1.2.2.7.2.3">superscript</csymbol><ci id="S3.E12X.3.2.2.m1.2.2.7.2.3.2.2.cmml" xref="S3.E12X.3.2.2.m1.2.2.7.2.3.2.2">𝛽</ci><ci id="S3.E12X.3.2.2.m1.2.2.7.2.3.2.3.cmml" xref="S3.E12X.3.2.2.m1.2.2.7.2.3.2.3">′</ci></apply><cn id="S3.E12X.3.2.2.m1.2.2.7.2.3.3.cmml" type="integer" xref="S3.E12X.3.2.2.m1.2.2.7.2.3.3">1</cn></apply></apply><apply id="S3.E12X.3.2.2.m1.2.2.7.3.cmml" xref="S3.E12X.3.2.2.m1.2.2.7.3"><csymbol cd="ambiguous" id="S3.E12X.3.2.2.m1.2.2.7.3.1.cmml" xref="S3.E12X.3.2.2.m1.2.2.7.3">subscript</csymbol><apply id="S3.E12X.3.2.2.m1.2.2.7.3.2.cmml" xref="S3.E12X.3.2.2.m1.2.2.7.3"><csymbol cd="ambiguous" id="S3.E12X.3.2.2.m1.2.2.7.3.2.1.cmml" xref="S3.E12X.3.2.2.m1.2.2.7.3">superscript</csymbol><ci id="S3.E12X.3.2.2.m1.2.2.7.3.2.2.cmml" xref="S3.E12X.3.2.2.m1.2.2.7.3.2.2">𝛽</ci><ci id="S3.E12X.3.2.2.m1.2.2.7.3.2.3.cmml" xref="S3.E12X.3.2.2.m1.2.2.7.3.2.3">′</ci></apply><cn id="S3.E12X.3.2.2.m1.2.2.7.3.3.cmml" type="integer" xref="S3.E12X.3.2.2.m1.2.2.7.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12X.3.2.2.m1.2c">\displaystyle=(\alpha_{2},\beta^{\prime}_{2})\bullet\beta^{\prime}_{1}=\alpha_%
{2}\odot\beta^{\prime}_{1}+\beta^{\prime}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.E12X.3.2.2.m1.2d">= ( italic_α start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_β start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ∙ italic_β start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_α start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ⊙ italic_β start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_β start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E12Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle c_{t+1}\bullet c_{t}" class="ltx_Math" display="inline" id="S3.E12Xa.2.1.1.m1.1"><semantics id="S3.E12Xa.2.1.1.m1.1a"><mrow id="S3.E12Xa.2.1.1.m1.1.1" xref="S3.E12Xa.2.1.1.m1.1.1.cmml"><msub id="S3.E12Xa.2.1.1.m1.1.1.2" xref="S3.E12Xa.2.1.1.m1.1.1.2.cmml"><mi id="S3.E12Xa.2.1.1.m1.1.1.2.2" xref="S3.E12Xa.2.1.1.m1.1.1.2.2.cmml">c</mi><mrow id="S3.E12Xa.2.1.1.m1.1.1.2.3" xref="S3.E12Xa.2.1.1.m1.1.1.2.3.cmml"><mi id="S3.E12Xa.2.1.1.m1.1.1.2.3.2" xref="S3.E12Xa.2.1.1.m1.1.1.2.3.2.cmml">t</mi><mo id="S3.E12Xa.2.1.1.m1.1.1.2.3.1" xref="S3.E12Xa.2.1.1.m1.1.1.2.3.1.cmml">+</mo><mn id="S3.E12Xa.2.1.1.m1.1.1.2.3.3" xref="S3.E12Xa.2.1.1.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E12Xa.2.1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.E12Xa.2.1.1.m1.1.1.1.cmml">∙</mo><msub id="S3.E12Xa.2.1.1.m1.1.1.3" xref="S3.E12Xa.2.1.1.m1.1.1.3.cmml"><mi id="S3.E12Xa.2.1.1.m1.1.1.3.2" xref="S3.E12Xa.2.1.1.m1.1.1.3.2.cmml">c</mi><mi id="S3.E12Xa.2.1.1.m1.1.1.3.3" xref="S3.E12Xa.2.1.1.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.E12Xa.2.1.1.m1.1b"><apply id="S3.E12Xa.2.1.1.m1.1.1.cmml" xref="S3.E12Xa.2.1.1.m1.1.1"><ci id="S3.E12Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1">∙</ci><apply id="S3.E12Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E12Xa.2.1.1.m1.1.1.2.1.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.2">subscript</csymbol><ci id="S3.E12Xa.2.1.1.m1.1.1.2.2.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.2.2">𝑐</ci><apply id="S3.E12Xa.2.1.1.m1.1.1.2.3.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.2.3"><plus id="S3.E12Xa.2.1.1.m1.1.1.2.3.1.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.2.3.1"></plus><ci id="S3.E12Xa.2.1.1.m1.1.1.2.3.2.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.2.3.2">𝑡</ci><cn id="S3.E12Xa.2.1.1.m1.1.1.2.3.3.cmml" type="integer" xref="S3.E12Xa.2.1.1.m1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E12Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E12Xa.2.1.1.m1.1.1.3.1.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.3">subscript</csymbol><ci id="S3.E12Xa.2.1.1.m1.1.1.3.2.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.3.2">𝑐</ci><ci id="S3.E12Xa.2.1.1.m1.1.1.3.3.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12Xa.2.1.1.m1.1c">\displaystyle c_{t+1}\bullet c_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.E12Xa.2.1.1.m1.1d">italic_c start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ∙ italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=(\alpha_{t+1},\beta^{\prime}_{t+1})\bullet(\alpha_{t},\beta^{%
\prime}_{t})" class="ltx_Math" display="inline" id="S3.E12Xa.3.2.2.m1.4"><semantics id="S3.E12Xa.3.2.2.m1.4a"><mrow id="S3.E12Xa.3.2.2.m1.4.4" xref="S3.E12Xa.3.2.2.m1.4.4.cmml"><mi id="S3.E12Xa.3.2.2.m1.4.4.6" xref="S3.E12Xa.3.2.2.m1.4.4.6.cmml"></mi><mo id="S3.E12Xa.3.2.2.m1.4.4.5" xref="S3.E12Xa.3.2.2.m1.4.4.5.cmml">=</mo><mrow id="S3.E12Xa.3.2.2.m1.4.4.4" xref="S3.E12Xa.3.2.2.m1.4.4.4.cmml"><mrow id="S3.E12Xa.3.2.2.m1.2.2.2.2.2" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.3.cmml"><mo id="S3.E12Xa.3.2.2.m1.2.2.2.2.2.3" stretchy="false" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.3.cmml">(</mo><msub id="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1" xref="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><mi id="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.2" xref="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml">α</mi><mrow id="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.3.2" xref="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.3.1" xref="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.3.3" xref="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E12Xa.3.2.2.m1.2.2.2.2.2.4" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.3.cmml">,</mo><msubsup id="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.cmml"><mi id="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.2.2" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.2.2.cmml">β</mi><mrow id="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.3" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.3.cmml"><mi id="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.3.2" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.3.1" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.3.1.cmml">+</mo><mn id="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.3.3" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.3.3.cmml">1</mn></mrow><mo id="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.2.3" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.2.3.cmml">′</mo></msubsup><mo id="S3.E12Xa.3.2.2.m1.2.2.2.2.2.5" rspace="0.055em" stretchy="false" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.3.cmml">)</mo></mrow><mo id="S3.E12Xa.3.2.2.m1.4.4.4.5" rspace="0.222em" xref="S3.E12Xa.3.2.2.m1.4.4.4.5.cmml">∙</mo><mrow id="S3.E12Xa.3.2.2.m1.4.4.4.4.2" xref="S3.E12Xa.3.2.2.m1.4.4.4.4.3.cmml"><mo id="S3.E12Xa.3.2.2.m1.4.4.4.4.2.3" stretchy="false" xref="S3.E12Xa.3.2.2.m1.4.4.4.4.3.cmml">(</mo><msub id="S3.E12Xa.3.2.2.m1.3.3.3.3.1.1" xref="S3.E12Xa.3.2.2.m1.3.3.3.3.1.1.cmml"><mi id="S3.E12Xa.3.2.2.m1.3.3.3.3.1.1.2" xref="S3.E12Xa.3.2.2.m1.3.3.3.3.1.1.2.cmml">α</mi><mi id="S3.E12Xa.3.2.2.m1.3.3.3.3.1.1.3" xref="S3.E12Xa.3.2.2.m1.3.3.3.3.1.1.3.cmml">t</mi></msub><mo id="S3.E12Xa.3.2.2.m1.4.4.4.4.2.4" xref="S3.E12Xa.3.2.2.m1.4.4.4.4.3.cmml">,</mo><msubsup id="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2" xref="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2.cmml"><mi id="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2.2.2" xref="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2.2.2.cmml">β</mi><mi id="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2.3" xref="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2.3.cmml">t</mi><mo id="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2.2.3" xref="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2.2.3.cmml">′</mo></msubsup><mo id="S3.E12Xa.3.2.2.m1.4.4.4.4.2.5" stretchy="false" xref="S3.E12Xa.3.2.2.m1.4.4.4.4.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12Xa.3.2.2.m1.4b"><apply id="S3.E12Xa.3.2.2.m1.4.4.cmml" xref="S3.E12Xa.3.2.2.m1.4.4"><eq id="S3.E12Xa.3.2.2.m1.4.4.5.cmml" xref="S3.E12Xa.3.2.2.m1.4.4.5"></eq><csymbol cd="latexml" id="S3.E12Xa.3.2.2.m1.4.4.6.cmml" xref="S3.E12Xa.3.2.2.m1.4.4.6">absent</csymbol><apply id="S3.E12Xa.3.2.2.m1.4.4.4.cmml" xref="S3.E12Xa.3.2.2.m1.4.4.4"><ci id="S3.E12Xa.3.2.2.m1.4.4.4.5.cmml" xref="S3.E12Xa.3.2.2.m1.4.4.4.5">∙</ci><interval closure="open" id="S3.E12Xa.3.2.2.m1.2.2.2.2.3.cmml" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.2"><apply id="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.2">𝛼</ci><apply id="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.3"><plus id="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.3.1"></plus><ci id="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E12Xa.3.2.2.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.cmml" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.1.cmml" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2">subscript</csymbol><apply id="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.2.cmml" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2">superscript</csymbol><ci id="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.2.2">𝛽</ci><ci id="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.2.3">′</ci></apply><apply id="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.3.cmml" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.3"><plus id="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.3.1.cmml" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.3.1"></plus><ci id="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.3.2.cmml" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.3.2">𝑡</ci><cn id="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.E12Xa.3.2.2.m1.2.2.2.2.2.2.3.3">1</cn></apply></apply></interval><interval closure="open" id="S3.E12Xa.3.2.2.m1.4.4.4.4.3.cmml" xref="S3.E12Xa.3.2.2.m1.4.4.4.4.2"><apply id="S3.E12Xa.3.2.2.m1.3.3.3.3.1.1.cmml" xref="S3.E12Xa.3.2.2.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E12Xa.3.2.2.m1.3.3.3.3.1.1.1.cmml" xref="S3.E12Xa.3.2.2.m1.3.3.3.3.1.1">subscript</csymbol><ci id="S3.E12Xa.3.2.2.m1.3.3.3.3.1.1.2.cmml" xref="S3.E12Xa.3.2.2.m1.3.3.3.3.1.1.2">𝛼</ci><ci id="S3.E12Xa.3.2.2.m1.3.3.3.3.1.1.3.cmml" xref="S3.E12Xa.3.2.2.m1.3.3.3.3.1.1.3">𝑡</ci></apply><apply id="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2.cmml" xref="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2.1.cmml" xref="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2">subscript</csymbol><apply id="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2.2.cmml" xref="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2.2.1.cmml" xref="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2">superscript</csymbol><ci id="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2.2.2.cmml" xref="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2.2.2">𝛽</ci><ci id="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2.2.3.cmml" xref="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2.2.3">′</ci></apply><ci id="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2.3.cmml" xref="S3.E12Xa.3.2.2.m1.4.4.4.4.2.2.3">𝑡</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12Xa.3.2.2.m1.4c">\displaystyle=(\alpha_{t+1},\beta^{\prime}_{t+1})\bullet(\alpha_{t},\beta^{%
\prime}_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.E12Xa.3.2.2.m1.4d">= ( italic_α start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT , italic_β start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) ∙ ( italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_β start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E12Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=(\alpha_{t+1}\odot\alpha_{t},\alpha_{t+1}\odot\beta^{\prime}_{t}%
+\beta^{\prime}_{t+1})\quad(1&lt;t&lt;T)" class="ltx_Math" display="inline" id="S3.E12Xb.2.1.1.m1.2"><semantics id="S3.E12Xb.2.1.1.m1.2a"><mrow id="S3.E12Xb.2.1.1.m1.2.2" xref="S3.E12Xb.2.1.1.m1.2.2.cmml"><mi id="S3.E12Xb.2.1.1.m1.2.2.4" xref="S3.E12Xb.2.1.1.m1.2.2.4.cmml"></mi><mo id="S3.E12Xb.2.1.1.m1.2.2.3" xref="S3.E12Xb.2.1.1.m1.2.2.3.cmml">=</mo><mrow id="S3.E12Xb.2.1.1.m1.2.2.2.2" xref="S3.E12Xb.2.1.1.m1.2.2.2.3.cmml"><mrow id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.3.cmml"><mo id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.3" stretchy="false" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.3.cmml">(</mo><mrow id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.cmml"><msub id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.2" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.2.cmml">α</mi><mrow id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.3" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.3.2" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.3.1" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.3.3" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">⊙</mo><msub id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.3.2" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml">α</mi><mi id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.3.3" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.4" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.3.cmml">,</mo><mrow id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.cmml"><mrow id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.cmml"><msub id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.2" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.2.cmml">α</mi><mrow id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.3" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.2" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.2.cmml">t</mi><mo id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.1" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.1.cmml">+</mo><mn id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.3" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.1.cmml">⊙</mo><msubsup id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3.2.2" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3.2.2.cmml">β</mi><mi id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3.3" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3.3.cmml">t</mi><mo id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3.2.3" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3.2.3.cmml">′</mo></msubsup></mrow><mo id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.1" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.1.cmml">+</mo><msubsup id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.2.2" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.2.2.cmml">β</mi><mrow id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.3" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.3.cmml"><mi id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.3.2" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.3.2.cmml">t</mi><mo id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.3.1" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.3.1.cmml">+</mo><mn id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.3.3" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.3.3.cmml">1</mn></mrow><mo id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.2.3" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.2.3.cmml">′</mo></msubsup></mrow><mo id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.5" stretchy="false" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.3.cmml">)</mo></mrow><mspace id="S3.E12Xb.2.1.1.m1.2.2.2.2.3" width="1em" xref="S3.E12Xb.2.1.1.m1.2.2.2.3.cmml"></mspace><mrow id="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1" xref="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.cmml"><mo id="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.2" stretchy="false" xref="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1" xref="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.cmml"><mn id="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.2" xref="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.2.cmml">1</mn><mo id="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.3" xref="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.3.cmml">&lt;</mo><mi id="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.4" xref="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.4.cmml">t</mi><mo id="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.5" xref="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.5.cmml">&lt;</mo><mi id="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.6" xref="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.6.cmml">T</mi></mrow><mo id="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.3" stretchy="false" xref="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12Xb.2.1.1.m1.2b"><apply id="S3.E12Xb.2.1.1.m1.2.2.cmml" xref="S3.E12Xb.2.1.1.m1.2.2"><eq id="S3.E12Xb.2.1.1.m1.2.2.3.cmml" xref="S3.E12Xb.2.1.1.m1.2.2.3"></eq><csymbol cd="latexml" id="S3.E12Xb.2.1.1.m1.2.2.4.cmml" xref="S3.E12Xb.2.1.1.m1.2.2.4">absent</csymbol><list id="S3.E12Xb.2.1.1.m1.2.2.2.3.cmml" xref="S3.E12Xb.2.1.1.m1.2.2.2.2"><interval closure="open" id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2"><apply id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.1">direct-product</csymbol><apply id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.2">𝛼</ci><apply id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.3"><plus id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.3.1"></plus><ci id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.3.2">𝛼</ci><ci id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2"><plus id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.1"></plus><apply id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2"><csymbol cd="latexml" id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.1">direct-product</csymbol><apply id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.2">𝛼</ci><apply id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.3"><plus id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.1"></plus><ci id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.2">𝑡</ci><cn id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.3.cmml" type="integer" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.3">1</cn></apply></apply><apply id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3">subscript</csymbol><apply id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3.2.1.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3">superscript</csymbol><ci id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3.2.2.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3.2.2">𝛽</ci><ci id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3.2.3.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3.2.3">′</ci></apply><ci id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.2.3.3">𝑡</ci></apply></apply><apply id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3">subscript</csymbol><apply id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3">superscript</csymbol><ci id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.2.2">𝛽</ci><ci id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.2.3.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.2.3">′</ci></apply><apply id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.3"><plus id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.3.1.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.3.1"></plus><ci id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.3.2.cmml" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.3.2">𝑡</ci><cn id="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.3.3.cmml" type="integer" xref="S3.E12Xb.2.1.1.m1.1.1.1.1.1.2.2.3.3.3">1</cn></apply></apply></apply></interval><apply id="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.cmml" xref="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1"><and id="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1a.cmml" xref="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1"></and><apply id="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1b.cmml" xref="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1"><lt id="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.3.cmml" xref="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.3"></lt><cn id="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.2.cmml" type="integer" xref="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.2">1</cn><ci id="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.4.cmml" xref="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.4">𝑡</ci></apply><apply id="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1c.cmml" xref="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1"><lt id="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.5.cmml" xref="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.5"></lt><share href="https://arxiv.org/html/2406.12580v2#S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.4.cmml" id="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1d.cmml" xref="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1"></share><ci id="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.6.cmml" xref="S3.E12Xb.2.1.1.m1.2.2.2.2.2.1.1.6">𝑇</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12Xb.2.1.1.m1.2c">\displaystyle=(\alpha_{t+1}\odot\alpha_{t},\alpha_{t+1}\odot\beta^{\prime}_{t}%
+\beta^{\prime}_{t+1})\quad(1&lt;t&lt;T)</annotation><annotation encoding="application/x-llamapun" id="S3.E12Xb.2.1.1.m1.2d">= ( italic_α start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ⊙ italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_α start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ⊙ italic_β start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_β start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) ( 1 &lt; italic_t &lt; italic_T )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.26">Therefore, we can derive that:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h_{t}=c_{t}\bullet\cdots\bullet c_{2}\bullet c_{1}." class="ltx_Math" display="block" id="S3.E13.m1.1"><semantics id="S3.E13.m1.1a"><mrow id="S3.E13.m1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml"><mrow id="S3.E13.m1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml"><msub id="S3.E13.m1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.2.cmml"><mi id="S3.E13.m1.1.1.1.1.2.2" xref="S3.E13.m1.1.1.1.1.2.2.cmml">h</mi><mi id="S3.E13.m1.1.1.1.1.2.3" xref="S3.E13.m1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.E13.m1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E13.m1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.3.cmml"><msub id="S3.E13.m1.1.1.1.1.3.2" xref="S3.E13.m1.1.1.1.1.3.2.cmml"><mi id="S3.E13.m1.1.1.1.1.3.2.2" xref="S3.E13.m1.1.1.1.1.3.2.2.cmml">c</mi><mi id="S3.E13.m1.1.1.1.1.3.2.3" xref="S3.E13.m1.1.1.1.1.3.2.3.cmml">t</mi></msub><mo id="S3.E13.m1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E13.m1.1.1.1.1.3.1.cmml">∙</mo><mi id="S3.E13.m1.1.1.1.1.3.3" mathvariant="normal" xref="S3.E13.m1.1.1.1.1.3.3.cmml">⋯</mi><mo id="S3.E13.m1.1.1.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.E13.m1.1.1.1.1.3.1.cmml">∙</mo><msub id="S3.E13.m1.1.1.1.1.3.4" xref="S3.E13.m1.1.1.1.1.3.4.cmml"><mi id="S3.E13.m1.1.1.1.1.3.4.2" xref="S3.E13.m1.1.1.1.1.3.4.2.cmml">c</mi><mn id="S3.E13.m1.1.1.1.1.3.4.3" xref="S3.E13.m1.1.1.1.1.3.4.3.cmml">2</mn></msub><mo id="S3.E13.m1.1.1.1.1.3.1b" lspace="0.222em" rspace="0.222em" xref="S3.E13.m1.1.1.1.1.3.1.cmml">∙</mo><msub id="S3.E13.m1.1.1.1.1.3.5" xref="S3.E13.m1.1.1.1.1.3.5.cmml"><mi id="S3.E13.m1.1.1.1.1.3.5.2" xref="S3.E13.m1.1.1.1.1.3.5.2.cmml">c</mi><mn id="S3.E13.m1.1.1.1.1.3.5.3" xref="S3.E13.m1.1.1.1.1.3.5.3.cmml">1</mn></msub></mrow></mrow><mo id="S3.E13.m1.1.1.1.2" lspace="0em" xref="S3.E13.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.1b"><apply id="S3.E13.m1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1"><eq id="S3.E13.m1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1"></eq><apply id="S3.E13.m1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.2.1.cmml" xref="S3.E13.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.2.2.cmml" xref="S3.E13.m1.1.1.1.1.2.2">ℎ</ci><ci id="S3.E13.m1.1.1.1.1.2.3.cmml" xref="S3.E13.m1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E13.m1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.3"><ci id="S3.E13.m1.1.1.1.1.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.1">∙</ci><apply id="S3.E13.m1.1.1.1.1.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.2.1.cmml" xref="S3.E13.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.2.2.cmml" xref="S3.E13.m1.1.1.1.1.3.2.2">𝑐</ci><ci id="S3.E13.m1.1.1.1.1.3.2.3.cmml" xref="S3.E13.m1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S3.E13.m1.1.1.1.1.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.3">⋯</ci><apply id="S3.E13.m1.1.1.1.1.3.4.cmml" xref="S3.E13.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.4.1.cmml" xref="S3.E13.m1.1.1.1.1.3.4">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.4.2.cmml" xref="S3.E13.m1.1.1.1.1.3.4.2">𝑐</ci><cn id="S3.E13.m1.1.1.1.1.3.4.3.cmml" type="integer" xref="S3.E13.m1.1.1.1.1.3.4.3">2</cn></apply><apply id="S3.E13.m1.1.1.1.1.3.5.cmml" xref="S3.E13.m1.1.1.1.1.3.5"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.5.1.cmml" xref="S3.E13.m1.1.1.1.1.3.5">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.5.2.cmml" xref="S3.E13.m1.1.1.1.1.3.5.2">𝑐</ci><cn id="S3.E13.m1.1.1.1.1.3.5.3.cmml" type="integer" xref="S3.E13.m1.1.1.1.1.3.5.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.1c">h_{t}=c_{t}\bullet\cdots\bullet c_{2}\bullet c_{1}.</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∙ ⋯ ∙ italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∙ italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.15">Since the binary operator <math alttext="\bullet" class="ltx_Math" display="inline" id="S3.SS3.p2.14.m1.1"><semantics id="S3.SS3.p2.14.m1.1a"><mo id="S3.SS3.p2.14.m1.1.1" xref="S3.SS3.p2.14.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.14.m1.1b"><ci id="S3.SS3.p2.14.m1.1.1.cmml" xref="S3.SS3.p2.14.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.14.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.14.m1.1d">∙</annotation></semantics></math> has been shown to be associative in <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">blelloch1990prefix</span>)</cite>, we do not need to compute the hidden representations <math alttext="H" class="ltx_Math" display="inline" id="S3.SS3.p2.15.m2.1"><semantics id="S3.SS3.p2.15.m2.1a"><mi id="S3.SS3.p2.15.m2.1.1" xref="S3.SS3.p2.15.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.15.m2.1b"><ci id="S3.SS3.p2.15.m2.1.1.cmml" xref="S3.SS3.p2.15.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.15.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.15.m2.1d">italic_H</annotation></semantics></math> sequentially, but use the scan operation in Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S3.E9" title="Equation 9 ‣ 3.3. Hardware-Aware Parallel Scan ‣ 3. Methodology ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">9</span></a>:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E14">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E14X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="3"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(14)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle H" class="ltx_Math" display="inline" id="S3.E14X.2.1.1.m1.1"><semantics id="S3.E14X.2.1.1.m1.1a"><mi id="S3.E14X.2.1.1.m1.1.1" xref="S3.E14X.2.1.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.E14X.2.1.1.m1.1b"><ci id="S3.E14X.2.1.1.m1.1.1.cmml" xref="S3.E14X.2.1.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.E14X.2.1.1.m1.1c">\displaystyle H</annotation><annotation encoding="application/x-llamapun" id="S3.E14X.2.1.1.m1.1d">italic_H</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=[h_{1},h_{2},\dots,h_{T}]" class="ltx_Math" display="inline" id="S3.E14X.3.2.2.m1.4"><semantics id="S3.E14X.3.2.2.m1.4a"><mrow id="S3.E14X.3.2.2.m1.4.4" xref="S3.E14X.3.2.2.m1.4.4.cmml"><mi id="S3.E14X.3.2.2.m1.4.4.5" xref="S3.E14X.3.2.2.m1.4.4.5.cmml"></mi><mo id="S3.E14X.3.2.2.m1.4.4.4" xref="S3.E14X.3.2.2.m1.4.4.4.cmml">=</mo><mrow id="S3.E14X.3.2.2.m1.4.4.3.3" xref="S3.E14X.3.2.2.m1.4.4.3.4.cmml"><mo id="S3.E14X.3.2.2.m1.4.4.3.3.4" stretchy="false" xref="S3.E14X.3.2.2.m1.4.4.3.4.cmml">[</mo><msub id="S3.E14X.3.2.2.m1.2.2.1.1.1" xref="S3.E14X.3.2.2.m1.2.2.1.1.1.cmml"><mi id="S3.E14X.3.2.2.m1.2.2.1.1.1.2" xref="S3.E14X.3.2.2.m1.2.2.1.1.1.2.cmml">h</mi><mn id="S3.E14X.3.2.2.m1.2.2.1.1.1.3" xref="S3.E14X.3.2.2.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.E14X.3.2.2.m1.4.4.3.3.5" xref="S3.E14X.3.2.2.m1.4.4.3.4.cmml">,</mo><msub id="S3.E14X.3.2.2.m1.3.3.2.2.2" xref="S3.E14X.3.2.2.m1.3.3.2.2.2.cmml"><mi id="S3.E14X.3.2.2.m1.3.3.2.2.2.2" xref="S3.E14X.3.2.2.m1.3.3.2.2.2.2.cmml">h</mi><mn id="S3.E14X.3.2.2.m1.3.3.2.2.2.3" xref="S3.E14X.3.2.2.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.E14X.3.2.2.m1.4.4.3.3.6" xref="S3.E14X.3.2.2.m1.4.4.3.4.cmml">,</mo><mi id="S3.E14X.3.2.2.m1.1.1" mathvariant="normal" xref="S3.E14X.3.2.2.m1.1.1.cmml">…</mi><mo id="S3.E14X.3.2.2.m1.4.4.3.3.7" xref="S3.E14X.3.2.2.m1.4.4.3.4.cmml">,</mo><msub id="S3.E14X.3.2.2.m1.4.4.3.3.3" xref="S3.E14X.3.2.2.m1.4.4.3.3.3.cmml"><mi id="S3.E14X.3.2.2.m1.4.4.3.3.3.2" xref="S3.E14X.3.2.2.m1.4.4.3.3.3.2.cmml">h</mi><mi id="S3.E14X.3.2.2.m1.4.4.3.3.3.3" xref="S3.E14X.3.2.2.m1.4.4.3.3.3.3.cmml">T</mi></msub><mo id="S3.E14X.3.2.2.m1.4.4.3.3.8" stretchy="false" xref="S3.E14X.3.2.2.m1.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E14X.3.2.2.m1.4b"><apply id="S3.E14X.3.2.2.m1.4.4.cmml" xref="S3.E14X.3.2.2.m1.4.4"><eq id="S3.E14X.3.2.2.m1.4.4.4.cmml" xref="S3.E14X.3.2.2.m1.4.4.4"></eq><csymbol cd="latexml" id="S3.E14X.3.2.2.m1.4.4.5.cmml" xref="S3.E14X.3.2.2.m1.4.4.5">absent</csymbol><list id="S3.E14X.3.2.2.m1.4.4.3.4.cmml" xref="S3.E14X.3.2.2.m1.4.4.3.3"><apply id="S3.E14X.3.2.2.m1.2.2.1.1.1.cmml" xref="S3.E14X.3.2.2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E14X.3.2.2.m1.2.2.1.1.1.1.cmml" xref="S3.E14X.3.2.2.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E14X.3.2.2.m1.2.2.1.1.1.2.cmml" xref="S3.E14X.3.2.2.m1.2.2.1.1.1.2">ℎ</ci><cn id="S3.E14X.3.2.2.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.E14X.3.2.2.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.E14X.3.2.2.m1.3.3.2.2.2.cmml" xref="S3.E14X.3.2.2.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E14X.3.2.2.m1.3.3.2.2.2.1.cmml" xref="S3.E14X.3.2.2.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.E14X.3.2.2.m1.3.3.2.2.2.2.cmml" xref="S3.E14X.3.2.2.m1.3.3.2.2.2.2">ℎ</ci><cn id="S3.E14X.3.2.2.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.E14X.3.2.2.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.E14X.3.2.2.m1.1.1.cmml" xref="S3.E14X.3.2.2.m1.1.1">…</ci><apply id="S3.E14X.3.2.2.m1.4.4.3.3.3.cmml" xref="S3.E14X.3.2.2.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.E14X.3.2.2.m1.4.4.3.3.3.1.cmml" xref="S3.E14X.3.2.2.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.E14X.3.2.2.m1.4.4.3.3.3.2.cmml" xref="S3.E14X.3.2.2.m1.4.4.3.3.3.2">ℎ</ci><ci id="S3.E14X.3.2.2.m1.4.4.3.3.3.3.cmml" xref="S3.E14X.3.2.2.m1.4.4.3.3.3.3">𝑇</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14X.3.2.2.m1.4c">\displaystyle=[h_{1},h_{2},\dots,h_{T}]</annotation><annotation encoding="application/x-llamapun" id="S3.E14X.3.2.2.m1.4d">= [ italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_h start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E14Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{Scan}(\bullet,c_{1:T})" class="ltx_Math" display="inline" id="S3.E14Xa.2.1.1.m1.3"><semantics id="S3.E14Xa.2.1.1.m1.3a"><mrow id="S3.E14Xa.2.1.1.m1.3.3" xref="S3.E14Xa.2.1.1.m1.3.3.cmml"><mi id="S3.E14Xa.2.1.1.m1.3.3.3" xref="S3.E14Xa.2.1.1.m1.3.3.3.cmml"></mi><mo id="S3.E14Xa.2.1.1.m1.3.3.2" xref="S3.E14Xa.2.1.1.m1.3.3.2.cmml">=</mo><mrow id="S3.E14Xa.2.1.1.m1.3.3.1.1" xref="S3.E14Xa.2.1.1.m1.3.3.1.2.cmml"><mi id="S3.E14Xa.2.1.1.m1.1.1" xref="S3.E14Xa.2.1.1.m1.1.1.cmml">Scan</mi><mo id="S3.E14Xa.2.1.1.m1.3.3.1.1a" xref="S3.E14Xa.2.1.1.m1.3.3.1.2.cmml">⁡</mo><mrow id="S3.E14Xa.2.1.1.m1.3.3.1.1.1" xref="S3.E14Xa.2.1.1.m1.3.3.1.2.cmml"><mo id="S3.E14Xa.2.1.1.m1.3.3.1.1.1.2" stretchy="false" xref="S3.E14Xa.2.1.1.m1.3.3.1.2.cmml">(</mo><mo id="S3.E14Xa.2.1.1.m1.2.2" lspace="0em" rspace="0em" xref="S3.E14Xa.2.1.1.m1.2.2.cmml">∙</mo><mo id="S3.E14Xa.2.1.1.m1.3.3.1.1.1.3" xref="S3.E14Xa.2.1.1.m1.3.3.1.2.cmml">,</mo><msub id="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1" xref="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.cmml"><mi id="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.2" xref="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml">c</mi><mrow id="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.3" xref="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.3.cmml"><mn id="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.3.2" xref="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.3.2.cmml">1</mn><mo id="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.3.1.cmml">:</mo><mi id="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.3.3" xref="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.3.3.cmml">T</mi></mrow></msub><mo id="S3.E14Xa.2.1.1.m1.3.3.1.1.1.4" stretchy="false" xref="S3.E14Xa.2.1.1.m1.3.3.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E14Xa.2.1.1.m1.3b"><apply id="S3.E14Xa.2.1.1.m1.3.3.cmml" xref="S3.E14Xa.2.1.1.m1.3.3"><eq id="S3.E14Xa.2.1.1.m1.3.3.2.cmml" xref="S3.E14Xa.2.1.1.m1.3.3.2"></eq><csymbol cd="latexml" id="S3.E14Xa.2.1.1.m1.3.3.3.cmml" xref="S3.E14Xa.2.1.1.m1.3.3.3">absent</csymbol><apply id="S3.E14Xa.2.1.1.m1.3.3.1.2.cmml" xref="S3.E14Xa.2.1.1.m1.3.3.1.1"><ci id="S3.E14Xa.2.1.1.m1.1.1.cmml" xref="S3.E14Xa.2.1.1.m1.1.1">Scan</ci><ci id="S3.E14Xa.2.1.1.m1.2.2.cmml" xref="S3.E14Xa.2.1.1.m1.2.2">∙</ci><apply id="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.2">𝑐</ci><apply id="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.3.cmml" xref="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.3"><ci id="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.3.1">:</ci><cn id="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.3.2.cmml" type="integer" xref="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.3.2">1</cn><ci id="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E14Xa.2.1.1.m1.3.3.1.1.1.1.3.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14Xa.2.1.1.m1.3c">\displaystyle=\operatorname{Scan}(\bullet,c_{1:T})</annotation><annotation encoding="application/x-llamapun" id="S3.E14Xa.2.1.1.m1.3d">= roman_Scan ( ∙ , italic_c start_POSTSUBSCRIPT 1 : italic_T end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E14Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=[c_{1},(c_{2}\bullet c_{1}),\dots,(c_{T}\bullet\dots\bullet c_{2%
}\bullet c_{1})]." class="ltx_Math" display="inline" id="S3.E14Xb.2.1.1.m1.2"><semantics id="S3.E14Xb.2.1.1.m1.2a"><mrow id="S3.E14Xb.2.1.1.m1.2.2.1" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.cmml"><mrow id="S3.E14Xb.2.1.1.m1.2.2.1.1" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.cmml"><mi id="S3.E14Xb.2.1.1.m1.2.2.1.1.5" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.5.cmml"></mi><mo id="S3.E14Xb.2.1.1.m1.2.2.1.1.4" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.4.cmml">=</mo><mrow id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.4.cmml"><mo id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.4" stretchy="false" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.4.cmml">[</mo><msub id="S3.E14Xb.2.1.1.m1.2.2.1.1.1.1.1" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.E14Xb.2.1.1.m1.2.2.1.1.1.1.1.2" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.1.1.1.2.cmml">c</mi><mn id="S3.E14Xb.2.1.1.m1.2.2.1.1.1.1.1.3" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.5" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.4.cmml">,</mo><mrow id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.cmml"><mo id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.2" stretchy="false" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.cmml">(</mo><mrow id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.cmml"><msub id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.2" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.2.cmml"><mi id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.2.2" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.2.2.cmml">c</mi><mn id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.2.3" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.2.3.cmml">2</mn></msub><mo id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.1.cmml">∙</mo><msub id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.3" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.3.cmml"><mi id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.3.2" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.3.2.cmml">c</mi><mn id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.3.3" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.3" stretchy="false" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.cmml">)</mo></mrow><mo id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.6" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.4.cmml">,</mo><mi id="S3.E14Xb.2.1.1.m1.1.1" mathvariant="normal" xref="S3.E14Xb.2.1.1.m1.1.1.cmml">…</mi><mo id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.7" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.4.cmml">,</mo><mrow id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.cmml"><mo id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.2" stretchy="false" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.cmml">(</mo><mrow id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.cmml"><msub id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.2" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.2.cmml"><mi id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.2.2" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.2.2.cmml">c</mi><mi id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.2.3" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.2.3.cmml">T</mi></msub><mo id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.1.cmml">∙</mo><mi id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.3" mathvariant="normal" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.3.cmml">⋯</mi><mo id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.1.cmml">∙</mo><msub id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.4" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.4.cmml"><mi id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.4.2" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.4.2.cmml">c</mi><mn id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.4.3" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.4.3.cmml">2</mn></msub><mo id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.1b" lspace="0.222em" rspace="0.222em" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.1.cmml">∙</mo><msub id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.5" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.5.cmml"><mi id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.5.2" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.5.2.cmml">c</mi><mn id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.5.3" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.5.3.cmml">1</mn></msub></mrow><mo id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.3" stretchy="false" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.cmml">)</mo></mrow><mo id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.8" stretchy="false" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.4.cmml">]</mo></mrow></mrow><mo id="S3.E14Xb.2.1.1.m1.2.2.1.2" lspace="0em" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14Xb.2.1.1.m1.2b"><apply id="S3.E14Xb.2.1.1.m1.2.2.1.1.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1"><eq id="S3.E14Xb.2.1.1.m1.2.2.1.1.4.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.4"></eq><csymbol cd="latexml" id="S3.E14Xb.2.1.1.m1.2.2.1.1.5.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.5">absent</csymbol><list id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.4.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3"><apply id="S3.E14Xb.2.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14Xb.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E14Xb.2.1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.1.1.1.2">𝑐</ci><cn id="S3.E14Xb.2.1.1.m1.2.2.1.1.1.1.1.3.cmml" type="integer" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.1.1.1.3">1</cn></apply><apply id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1"><ci id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.1.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.1">∙</ci><apply id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.2.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.2.1.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.2.2.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.2.2">𝑐</ci><cn id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.2.3.cmml" type="integer" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.2.3">2</cn></apply><apply id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.3.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.3.1.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.3.2.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.3.2">𝑐</ci><cn id="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.3.3.cmml" type="integer" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.2.2.2.1.1.3.3">1</cn></apply></apply><ci id="S3.E14Xb.2.1.1.m1.1.1.cmml" xref="S3.E14Xb.2.1.1.m1.1.1">…</ci><apply id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1"><ci id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.1.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.1">∙</ci><apply id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.2.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.2.1.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.2">subscript</csymbol><ci id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.2.2.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.2.2">𝑐</ci><ci id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.2.3.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.2.3">𝑇</ci></apply><ci id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.3.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.3">⋯</ci><apply id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.4.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.4"><csymbol cd="ambiguous" id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.4.1.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.4">subscript</csymbol><ci id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.4.2.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.4.2">𝑐</ci><cn id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.4.3.cmml" type="integer" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.4.3">2</cn></apply><apply id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.5.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.5"><csymbol cd="ambiguous" id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.5.1.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.5">subscript</csymbol><ci id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.5.2.cmml" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.5.2">𝑐</ci><cn id="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.5.3.cmml" type="integer" xref="S3.E14Xb.2.1.1.m1.2.2.1.1.3.3.3.1.1.5.3">1</cn></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14Xb.2.1.1.m1.2c">\displaystyle=[c_{1},(c_{2}\bullet c_{1}),\dots,(c_{T}\bullet\dots\bullet c_{2%
}\bullet c_{1})].</annotation><annotation encoding="application/x-llamapun" id="S3.E14Xb.2.1.1.m1.2d">= [ italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ( italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∙ italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) , … , ( italic_c start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ∙ ⋯ ∙ italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∙ italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.20">Our parallel scan algorithm can be demonstrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S3.F3" title="Figure 3 ‣ 3.3. Hardware-Aware Parallel Scan ‣ 3. Methodology ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> using two perfect binary trees, which is a case of the sequence length <math alttext="T=8" class="ltx_Math" display="inline" id="S3.SS3.p2.16.m1.1"><semantics id="S3.SS3.p2.16.m1.1a"><mrow id="S3.SS3.p2.16.m1.1.1" xref="S3.SS3.p2.16.m1.1.1.cmml"><mi id="S3.SS3.p2.16.m1.1.1.2" xref="S3.SS3.p2.16.m1.1.1.2.cmml">T</mi><mo id="S3.SS3.p2.16.m1.1.1.1" xref="S3.SS3.p2.16.m1.1.1.1.cmml">=</mo><mn id="S3.SS3.p2.16.m1.1.1.3" xref="S3.SS3.p2.16.m1.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.16.m1.1b"><apply id="S3.SS3.p2.16.m1.1.1.cmml" xref="S3.SS3.p2.16.m1.1.1"><eq id="S3.SS3.p2.16.m1.1.1.1.cmml" xref="S3.SS3.p2.16.m1.1.1.1"></eq><ci id="S3.SS3.p2.16.m1.1.1.2.cmml" xref="S3.SS3.p2.16.m1.1.1.2">𝑇</ci><cn id="S3.SS3.p2.16.m1.1.1.3.cmml" type="integer" xref="S3.SS3.p2.16.m1.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.16.m1.1c">T=8</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.16.m1.1d">italic_T = 8</annotation></semantics></math>. For simplicity, <math alttext="c_{l,r}" class="ltx_Math" display="inline" id="S3.SS3.p2.17.m2.2"><semantics id="S3.SS3.p2.17.m2.2a"><msub id="S3.SS3.p2.17.m2.2.3" xref="S3.SS3.p2.17.m2.2.3.cmml"><mi id="S3.SS3.p2.17.m2.2.3.2" xref="S3.SS3.p2.17.m2.2.3.2.cmml">c</mi><mrow id="S3.SS3.p2.17.m2.2.2.2.4" xref="S3.SS3.p2.17.m2.2.2.2.3.cmml"><mi id="S3.SS3.p2.17.m2.1.1.1.1" xref="S3.SS3.p2.17.m2.1.1.1.1.cmml">l</mi><mo id="S3.SS3.p2.17.m2.2.2.2.4.1" xref="S3.SS3.p2.17.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p2.17.m2.2.2.2.2" xref="S3.SS3.p2.17.m2.2.2.2.2.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.17.m2.2b"><apply id="S3.SS3.p2.17.m2.2.3.cmml" xref="S3.SS3.p2.17.m2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.17.m2.2.3.1.cmml" xref="S3.SS3.p2.17.m2.2.3">subscript</csymbol><ci id="S3.SS3.p2.17.m2.2.3.2.cmml" xref="S3.SS3.p2.17.m2.2.3.2">𝑐</ci><list id="S3.SS3.p2.17.m2.2.2.2.3.cmml" xref="S3.SS3.p2.17.m2.2.2.2.4"><ci id="S3.SS3.p2.17.m2.1.1.1.1.cmml" xref="S3.SS3.p2.17.m2.1.1.1.1">𝑙</ci><ci id="S3.SS3.p2.17.m2.2.2.2.2.cmml" xref="S3.SS3.p2.17.m2.2.2.2.2">𝑟</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.17.m2.2c">c_{l,r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.17.m2.2d">italic_c start_POSTSUBSCRIPT italic_l , italic_r end_POSTSUBSCRIPT</annotation></semantics></math> denotes <math alttext="c_{l}\bullet c_{l-1}\bullet\dots\bullet c_{r+1}\bullet c_{r}" class="ltx_Math" display="inline" id="S3.SS3.p2.18.m3.1"><semantics id="S3.SS3.p2.18.m3.1a"><mrow id="S3.SS3.p2.18.m3.1.1" xref="S3.SS3.p2.18.m3.1.1.cmml"><msub id="S3.SS3.p2.18.m3.1.1.2" xref="S3.SS3.p2.18.m3.1.1.2.cmml"><mi id="S3.SS3.p2.18.m3.1.1.2.2" xref="S3.SS3.p2.18.m3.1.1.2.2.cmml">c</mi><mi id="S3.SS3.p2.18.m3.1.1.2.3" xref="S3.SS3.p2.18.m3.1.1.2.3.cmml">l</mi></msub><mo id="S3.SS3.p2.18.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p2.18.m3.1.1.1.cmml">∙</mo><msub id="S3.SS3.p2.18.m3.1.1.3" xref="S3.SS3.p2.18.m3.1.1.3.cmml"><mi id="S3.SS3.p2.18.m3.1.1.3.2" xref="S3.SS3.p2.18.m3.1.1.3.2.cmml">c</mi><mrow id="S3.SS3.p2.18.m3.1.1.3.3" xref="S3.SS3.p2.18.m3.1.1.3.3.cmml"><mi id="S3.SS3.p2.18.m3.1.1.3.3.2" xref="S3.SS3.p2.18.m3.1.1.3.3.2.cmml">l</mi><mo id="S3.SS3.p2.18.m3.1.1.3.3.1" xref="S3.SS3.p2.18.m3.1.1.3.3.1.cmml">−</mo><mn id="S3.SS3.p2.18.m3.1.1.3.3.3" xref="S3.SS3.p2.18.m3.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS3.p2.18.m3.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p2.18.m3.1.1.1.cmml">∙</mo><mi id="S3.SS3.p2.18.m3.1.1.4" mathvariant="normal" xref="S3.SS3.p2.18.m3.1.1.4.cmml">⋯</mi><mo id="S3.SS3.p2.18.m3.1.1.1b" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p2.18.m3.1.1.1.cmml">∙</mo><msub id="S3.SS3.p2.18.m3.1.1.5" xref="S3.SS3.p2.18.m3.1.1.5.cmml"><mi id="S3.SS3.p2.18.m3.1.1.5.2" xref="S3.SS3.p2.18.m3.1.1.5.2.cmml">c</mi><mrow id="S3.SS3.p2.18.m3.1.1.5.3" xref="S3.SS3.p2.18.m3.1.1.5.3.cmml"><mi id="S3.SS3.p2.18.m3.1.1.5.3.2" xref="S3.SS3.p2.18.m3.1.1.5.3.2.cmml">r</mi><mo id="S3.SS3.p2.18.m3.1.1.5.3.1" xref="S3.SS3.p2.18.m3.1.1.5.3.1.cmml">+</mo><mn id="S3.SS3.p2.18.m3.1.1.5.3.3" xref="S3.SS3.p2.18.m3.1.1.5.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS3.p2.18.m3.1.1.1c" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p2.18.m3.1.1.1.cmml">∙</mo><msub id="S3.SS3.p2.18.m3.1.1.6" xref="S3.SS3.p2.18.m3.1.1.6.cmml"><mi id="S3.SS3.p2.18.m3.1.1.6.2" xref="S3.SS3.p2.18.m3.1.1.6.2.cmml">c</mi><mi id="S3.SS3.p2.18.m3.1.1.6.3" xref="S3.SS3.p2.18.m3.1.1.6.3.cmml">r</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.18.m3.1b"><apply id="S3.SS3.p2.18.m3.1.1.cmml" xref="S3.SS3.p2.18.m3.1.1"><ci id="S3.SS3.p2.18.m3.1.1.1.cmml" xref="S3.SS3.p2.18.m3.1.1.1">∙</ci><apply id="S3.SS3.p2.18.m3.1.1.2.cmml" xref="S3.SS3.p2.18.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.18.m3.1.1.2.1.cmml" xref="S3.SS3.p2.18.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.18.m3.1.1.2.2.cmml" xref="S3.SS3.p2.18.m3.1.1.2.2">𝑐</ci><ci id="S3.SS3.p2.18.m3.1.1.2.3.cmml" xref="S3.SS3.p2.18.m3.1.1.2.3">𝑙</ci></apply><apply id="S3.SS3.p2.18.m3.1.1.3.cmml" xref="S3.SS3.p2.18.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.18.m3.1.1.3.1.cmml" xref="S3.SS3.p2.18.m3.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.18.m3.1.1.3.2.cmml" xref="S3.SS3.p2.18.m3.1.1.3.2">𝑐</ci><apply id="S3.SS3.p2.18.m3.1.1.3.3.cmml" xref="S3.SS3.p2.18.m3.1.1.3.3"><minus id="S3.SS3.p2.18.m3.1.1.3.3.1.cmml" xref="S3.SS3.p2.18.m3.1.1.3.3.1"></minus><ci id="S3.SS3.p2.18.m3.1.1.3.3.2.cmml" xref="S3.SS3.p2.18.m3.1.1.3.3.2">𝑙</ci><cn id="S3.SS3.p2.18.m3.1.1.3.3.3.cmml" type="integer" xref="S3.SS3.p2.18.m3.1.1.3.3.3">1</cn></apply></apply><ci id="S3.SS3.p2.18.m3.1.1.4.cmml" xref="S3.SS3.p2.18.m3.1.1.4">⋯</ci><apply id="S3.SS3.p2.18.m3.1.1.5.cmml" xref="S3.SS3.p2.18.m3.1.1.5"><csymbol cd="ambiguous" id="S3.SS3.p2.18.m3.1.1.5.1.cmml" xref="S3.SS3.p2.18.m3.1.1.5">subscript</csymbol><ci id="S3.SS3.p2.18.m3.1.1.5.2.cmml" xref="S3.SS3.p2.18.m3.1.1.5.2">𝑐</ci><apply id="S3.SS3.p2.18.m3.1.1.5.3.cmml" xref="S3.SS3.p2.18.m3.1.1.5.3"><plus id="S3.SS3.p2.18.m3.1.1.5.3.1.cmml" xref="S3.SS3.p2.18.m3.1.1.5.3.1"></plus><ci id="S3.SS3.p2.18.m3.1.1.5.3.2.cmml" xref="S3.SS3.p2.18.m3.1.1.5.3.2">𝑟</ci><cn id="S3.SS3.p2.18.m3.1.1.5.3.3.cmml" type="integer" xref="S3.SS3.p2.18.m3.1.1.5.3.3">1</cn></apply></apply><apply id="S3.SS3.p2.18.m3.1.1.6.cmml" xref="S3.SS3.p2.18.m3.1.1.6"><csymbol cd="ambiguous" id="S3.SS3.p2.18.m3.1.1.6.1.cmml" xref="S3.SS3.p2.18.m3.1.1.6">subscript</csymbol><ci id="S3.SS3.p2.18.m3.1.1.6.2.cmml" xref="S3.SS3.p2.18.m3.1.1.6.2">𝑐</ci><ci id="S3.SS3.p2.18.m3.1.1.6.3.cmml" xref="S3.SS3.p2.18.m3.1.1.6.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.18.m3.1c">c_{l}\bullet c_{l-1}\bullet\dots\bullet c_{r+1}\bullet c_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.18.m3.1d">italic_c start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∙ italic_c start_POSTSUBSCRIPT italic_l - 1 end_POSTSUBSCRIPT ∙ ⋯ ∙ italic_c start_POSTSUBSCRIPT italic_r + 1 end_POSTSUBSCRIPT ∙ italic_c start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>. We initialize all the leaves of Tree1 with <math alttext="c_{8},\dots,c_{1}" class="ltx_Math" display="inline" id="S3.SS3.p2.19.m4.3"><semantics id="S3.SS3.p2.19.m4.3a"><mrow id="S3.SS3.p2.19.m4.3.3.2" xref="S3.SS3.p2.19.m4.3.3.3.cmml"><msub id="S3.SS3.p2.19.m4.2.2.1.1" xref="S3.SS3.p2.19.m4.2.2.1.1.cmml"><mi id="S3.SS3.p2.19.m4.2.2.1.1.2" xref="S3.SS3.p2.19.m4.2.2.1.1.2.cmml">c</mi><mn id="S3.SS3.p2.19.m4.2.2.1.1.3" xref="S3.SS3.p2.19.m4.2.2.1.1.3.cmml">8</mn></msub><mo id="S3.SS3.p2.19.m4.3.3.2.3" xref="S3.SS3.p2.19.m4.3.3.3.cmml">,</mo><mi id="S3.SS3.p2.19.m4.1.1" mathvariant="normal" xref="S3.SS3.p2.19.m4.1.1.cmml">…</mi><mo id="S3.SS3.p2.19.m4.3.3.2.4" xref="S3.SS3.p2.19.m4.3.3.3.cmml">,</mo><msub id="S3.SS3.p2.19.m4.3.3.2.2" xref="S3.SS3.p2.19.m4.3.3.2.2.cmml"><mi id="S3.SS3.p2.19.m4.3.3.2.2.2" xref="S3.SS3.p2.19.m4.3.3.2.2.2.cmml">c</mi><mn id="S3.SS3.p2.19.m4.3.3.2.2.3" xref="S3.SS3.p2.19.m4.3.3.2.2.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.19.m4.3b"><list id="S3.SS3.p2.19.m4.3.3.3.cmml" xref="S3.SS3.p2.19.m4.3.3.2"><apply id="S3.SS3.p2.19.m4.2.2.1.1.cmml" xref="S3.SS3.p2.19.m4.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.19.m4.2.2.1.1.1.cmml" xref="S3.SS3.p2.19.m4.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p2.19.m4.2.2.1.1.2.cmml" xref="S3.SS3.p2.19.m4.2.2.1.1.2">𝑐</ci><cn id="S3.SS3.p2.19.m4.2.2.1.1.3.cmml" type="integer" xref="S3.SS3.p2.19.m4.2.2.1.1.3">8</cn></apply><ci id="S3.SS3.p2.19.m4.1.1.cmml" xref="S3.SS3.p2.19.m4.1.1">…</ci><apply id="S3.SS3.p2.19.m4.3.3.2.2.cmml" xref="S3.SS3.p2.19.m4.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.19.m4.3.3.2.2.1.cmml" xref="S3.SS3.p2.19.m4.3.3.2.2">subscript</csymbol><ci id="S3.SS3.p2.19.m4.3.3.2.2.2.cmml" xref="S3.SS3.p2.19.m4.3.3.2.2.2">𝑐</ci><cn id="S3.SS3.p2.19.m4.3.3.2.2.3.cmml" type="integer" xref="S3.SS3.p2.19.m4.3.3.2.2.3">1</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.19.m4.3c">c_{8},\dots,c_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.19.m4.3d">italic_c start_POSTSUBSCRIPT 8 end_POSTSUBSCRIPT , … , italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and the root of Tree2 with <math alttext="1" class="ltx_Math" display="inline" id="S3.SS3.p2.20.m5.1"><semantics id="S3.SS3.p2.20.m5.1a"><mn id="S3.SS3.p2.20.m5.1.1" xref="S3.SS3.p2.20.m5.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.20.m5.1b"><cn id="S3.SS3.p2.20.m5.1.1.cmml" type="integer" xref="S3.SS3.p2.20.m5.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.20.m5.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.20.m5.1d">1</annotation></semantics></math>. After initialization, we perform an up-sweep on Tree1, then a down-sweep on Tree2, updating the nodes according to the following rules:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E15">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E15X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="3"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(15)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\operatorname{Tree1}[v]" class="ltx_Math" display="inline" id="S3.E15X.2.1.1.m1.2"><semantics id="S3.E15X.2.1.1.m1.2a"><mrow id="S3.E15X.2.1.1.m1.2.3.2" xref="S3.E15X.2.1.1.m1.2.3.1.cmml"><mi id="S3.E15X.2.1.1.m1.1.1" xref="S3.E15X.2.1.1.m1.1.1.cmml">Tree1</mi><mo id="S3.E15X.2.1.1.m1.2.3.2a" xref="S3.E15X.2.1.1.m1.2.3.1.cmml">⁡</mo><mrow id="S3.E15X.2.1.1.m1.2.3.2.1" xref="S3.E15X.2.1.1.m1.2.3.1.cmml"><mo id="S3.E15X.2.1.1.m1.2.3.2.1.1" stretchy="false" xref="S3.E15X.2.1.1.m1.2.3.1.cmml">[</mo><mi id="S3.E15X.2.1.1.m1.2.2" xref="S3.E15X.2.1.1.m1.2.2.cmml">v</mi><mo id="S3.E15X.2.1.1.m1.2.3.2.1.2" stretchy="false" xref="S3.E15X.2.1.1.m1.2.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E15X.2.1.1.m1.2b"><apply id="S3.E15X.2.1.1.m1.2.3.1.cmml" xref="S3.E15X.2.1.1.m1.2.3.2"><ci id="S3.E15X.2.1.1.m1.1.1.cmml" xref="S3.E15X.2.1.1.m1.1.1">Tree1</ci><ci id="S3.E15X.2.1.1.m1.2.2.cmml" xref="S3.E15X.2.1.1.m1.2.2">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15X.2.1.1.m1.2c">\displaystyle\operatorname{Tree1}[v]</annotation><annotation encoding="application/x-llamapun" id="S3.E15X.2.1.1.m1.2d">Tree1 [ italic_v ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{Tree1}[L[v]]\bullet\operatorname{Tree1}[R[v]]" class="ltx_Math" display="inline" id="S3.E15X.3.2.2.m1.6"><semantics id="S3.E15X.3.2.2.m1.6a"><mrow id="S3.E15X.3.2.2.m1.6.6" xref="S3.E15X.3.2.2.m1.6.6.cmml"><mi id="S3.E15X.3.2.2.m1.6.6.4" xref="S3.E15X.3.2.2.m1.6.6.4.cmml"></mi><mo id="S3.E15X.3.2.2.m1.6.6.3" xref="S3.E15X.3.2.2.m1.6.6.3.cmml">=</mo><mrow id="S3.E15X.3.2.2.m1.6.6.2" xref="S3.E15X.3.2.2.m1.6.6.2.cmml"><mrow id="S3.E15X.3.2.2.m1.5.5.1.1.1" xref="S3.E15X.3.2.2.m1.5.5.1.1.2.cmml"><mi id="S3.E15X.3.2.2.m1.2.2" xref="S3.E15X.3.2.2.m1.2.2.cmml">Tree1</mi><mo id="S3.E15X.3.2.2.m1.5.5.1.1.1a" xref="S3.E15X.3.2.2.m1.5.5.1.1.2.cmml">⁡</mo><mrow id="S3.E15X.3.2.2.m1.5.5.1.1.1.1" xref="S3.E15X.3.2.2.m1.5.5.1.1.2.cmml"><mo id="S3.E15X.3.2.2.m1.5.5.1.1.1.1.2" stretchy="false" xref="S3.E15X.3.2.2.m1.5.5.1.1.2.cmml">[</mo><mrow id="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1" xref="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1.cmml"><mi id="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1.2" xref="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1.2.cmml">L</mi><mo id="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1.1" xref="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1.3.2" xref="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1.3.1.cmml"><mo id="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1.3.1.1.cmml">[</mo><mi id="S3.E15X.3.2.2.m1.1.1" xref="S3.E15X.3.2.2.m1.1.1.cmml">v</mi><mo id="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E15X.3.2.2.m1.5.5.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E15X.3.2.2.m1.5.5.1.1.2.cmml">]</mo></mrow></mrow><mo id="S3.E15X.3.2.2.m1.6.6.2.3" rspace="0.222em" xref="S3.E15X.3.2.2.m1.6.6.2.3.cmml">∙</mo><mrow id="S3.E15X.3.2.2.m1.6.6.2.2.1" xref="S3.E15X.3.2.2.m1.6.6.2.2.2.cmml"><mi id="S3.E15X.3.2.2.m1.4.4" xref="S3.E15X.3.2.2.m1.4.4.cmml">Tree1</mi><mo id="S3.E15X.3.2.2.m1.6.6.2.2.1a" xref="S3.E15X.3.2.2.m1.6.6.2.2.2.cmml">⁡</mo><mrow id="S3.E15X.3.2.2.m1.6.6.2.2.1.1" xref="S3.E15X.3.2.2.m1.6.6.2.2.2.cmml"><mo id="S3.E15X.3.2.2.m1.6.6.2.2.1.1.2" stretchy="false" xref="S3.E15X.3.2.2.m1.6.6.2.2.2.cmml">[</mo><mrow id="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1" xref="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1.cmml"><mi id="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1.2" xref="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1.2.cmml">R</mi><mo id="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1.1" xref="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1.3.2" xref="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1.3.1.cmml"><mo id="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1.3.2.1" stretchy="false" xref="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1.3.1.1.cmml">[</mo><mi id="S3.E15X.3.2.2.m1.3.3" xref="S3.E15X.3.2.2.m1.3.3.cmml">v</mi><mo id="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1.3.2.2" stretchy="false" xref="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E15X.3.2.2.m1.6.6.2.2.1.1.3" stretchy="false" xref="S3.E15X.3.2.2.m1.6.6.2.2.2.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E15X.3.2.2.m1.6b"><apply id="S3.E15X.3.2.2.m1.6.6.cmml" xref="S3.E15X.3.2.2.m1.6.6"><eq id="S3.E15X.3.2.2.m1.6.6.3.cmml" xref="S3.E15X.3.2.2.m1.6.6.3"></eq><csymbol cd="latexml" id="S3.E15X.3.2.2.m1.6.6.4.cmml" xref="S3.E15X.3.2.2.m1.6.6.4">absent</csymbol><apply id="S3.E15X.3.2.2.m1.6.6.2.cmml" xref="S3.E15X.3.2.2.m1.6.6.2"><ci id="S3.E15X.3.2.2.m1.6.6.2.3.cmml" xref="S3.E15X.3.2.2.m1.6.6.2.3">∙</ci><apply id="S3.E15X.3.2.2.m1.5.5.1.1.2.cmml" xref="S3.E15X.3.2.2.m1.5.5.1.1.1"><ci id="S3.E15X.3.2.2.m1.2.2.cmml" xref="S3.E15X.3.2.2.m1.2.2">Tree1</ci><apply id="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1.cmml" xref="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1"><times id="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1.1"></times><ci id="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1.2">𝐿</ci><apply id="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1.3.1.cmml" xref="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1.3.2"><csymbol cd="latexml" id="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1.3.1.1.cmml" xref="S3.E15X.3.2.2.m1.5.5.1.1.1.1.1.3.2.1">delimited-[]</csymbol><ci id="S3.E15X.3.2.2.m1.1.1.cmml" xref="S3.E15X.3.2.2.m1.1.1">𝑣</ci></apply></apply></apply><apply id="S3.E15X.3.2.2.m1.6.6.2.2.2.cmml" xref="S3.E15X.3.2.2.m1.6.6.2.2.1"><ci id="S3.E15X.3.2.2.m1.4.4.cmml" xref="S3.E15X.3.2.2.m1.4.4">Tree1</ci><apply id="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1.cmml" xref="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1"><times id="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1.1.cmml" xref="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1.1"></times><ci id="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1.2.cmml" xref="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1.2">𝑅</ci><apply id="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1.3.1.cmml" xref="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1.3.2"><csymbol cd="latexml" id="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1.3.1.1.cmml" xref="S3.E15X.3.2.2.m1.6.6.2.2.1.1.1.3.2.1">delimited-[]</csymbol><ci id="S3.E15X.3.2.2.m1.3.3.cmml" xref="S3.E15X.3.2.2.m1.3.3">𝑣</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15X.3.2.2.m1.6c">\displaystyle=\operatorname{Tree1}[L[v]]\bullet\operatorname{Tree1}[R[v]]</annotation><annotation encoding="application/x-llamapun" id="S3.E15X.3.2.2.m1.6d">= Tree1 [ italic_L [ italic_v ] ] ∙ Tree1 [ italic_R [ italic_v ] ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E15Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\operatorname{Tree2}[R[v]]" class="ltx_Math" display="inline" id="S3.E15Xa.2.1.1.m1.3"><semantics id="S3.E15Xa.2.1.1.m1.3a"><mrow id="S3.E15Xa.2.1.1.m1.3.3.1" xref="S3.E15Xa.2.1.1.m1.3.3.2.cmml"><mi id="S3.E15Xa.2.1.1.m1.2.2" xref="S3.E15Xa.2.1.1.m1.2.2.cmml">Tree2</mi><mo id="S3.E15Xa.2.1.1.m1.3.3.1a" xref="S3.E15Xa.2.1.1.m1.3.3.2.cmml">⁡</mo><mrow id="S3.E15Xa.2.1.1.m1.3.3.1.1" xref="S3.E15Xa.2.1.1.m1.3.3.2.cmml"><mo id="S3.E15Xa.2.1.1.m1.3.3.1.1.2" stretchy="false" xref="S3.E15Xa.2.1.1.m1.3.3.2.cmml">[</mo><mrow id="S3.E15Xa.2.1.1.m1.3.3.1.1.1" xref="S3.E15Xa.2.1.1.m1.3.3.1.1.1.cmml"><mi id="S3.E15Xa.2.1.1.m1.3.3.1.1.1.2" xref="S3.E15Xa.2.1.1.m1.3.3.1.1.1.2.cmml">R</mi><mo id="S3.E15Xa.2.1.1.m1.3.3.1.1.1.1" xref="S3.E15Xa.2.1.1.m1.3.3.1.1.1.1.cmml">⁢</mo><mrow id="S3.E15Xa.2.1.1.m1.3.3.1.1.1.3.2" xref="S3.E15Xa.2.1.1.m1.3.3.1.1.1.3.1.cmml"><mo id="S3.E15Xa.2.1.1.m1.3.3.1.1.1.3.2.1" stretchy="false" xref="S3.E15Xa.2.1.1.m1.3.3.1.1.1.3.1.1.cmml">[</mo><mi id="S3.E15Xa.2.1.1.m1.1.1" xref="S3.E15Xa.2.1.1.m1.1.1.cmml">v</mi><mo id="S3.E15Xa.2.1.1.m1.3.3.1.1.1.3.2.2" stretchy="false" xref="S3.E15Xa.2.1.1.m1.3.3.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E15Xa.2.1.1.m1.3.3.1.1.3" stretchy="false" xref="S3.E15Xa.2.1.1.m1.3.3.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E15Xa.2.1.1.m1.3b"><apply id="S3.E15Xa.2.1.1.m1.3.3.2.cmml" xref="S3.E15Xa.2.1.1.m1.3.3.1"><ci id="S3.E15Xa.2.1.1.m1.2.2.cmml" xref="S3.E15Xa.2.1.1.m1.2.2">Tree2</ci><apply id="S3.E15Xa.2.1.1.m1.3.3.1.1.1.cmml" xref="S3.E15Xa.2.1.1.m1.3.3.1.1.1"><times id="S3.E15Xa.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.E15Xa.2.1.1.m1.3.3.1.1.1.1"></times><ci id="S3.E15Xa.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.E15Xa.2.1.1.m1.3.3.1.1.1.2">𝑅</ci><apply id="S3.E15Xa.2.1.1.m1.3.3.1.1.1.3.1.cmml" xref="S3.E15Xa.2.1.1.m1.3.3.1.1.1.3.2"><csymbol cd="latexml" id="S3.E15Xa.2.1.1.m1.3.3.1.1.1.3.1.1.cmml" xref="S3.E15Xa.2.1.1.m1.3.3.1.1.1.3.2.1">delimited-[]</csymbol><ci id="S3.E15Xa.2.1.1.m1.1.1.cmml" xref="S3.E15Xa.2.1.1.m1.1.1">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15Xa.2.1.1.m1.3c">\displaystyle\operatorname{Tree2}[R[v]]</annotation><annotation encoding="application/x-llamapun" id="S3.E15Xa.2.1.1.m1.3d">Tree2 [ italic_R [ italic_v ] ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{Tree2}[v]" class="ltx_Math" display="inline" id="S3.E15Xa.3.2.2.m1.2"><semantics id="S3.E15Xa.3.2.2.m1.2a"><mrow id="S3.E15Xa.3.2.2.m1.2.3" xref="S3.E15Xa.3.2.2.m1.2.3.cmml"><mi id="S3.E15Xa.3.2.2.m1.2.3.2" xref="S3.E15Xa.3.2.2.m1.2.3.2.cmml"></mi><mo id="S3.E15Xa.3.2.2.m1.2.3.1" xref="S3.E15Xa.3.2.2.m1.2.3.1.cmml">=</mo><mrow id="S3.E15Xa.3.2.2.m1.2.3.3.2" xref="S3.E15Xa.3.2.2.m1.2.3.3.1.cmml"><mi id="S3.E15Xa.3.2.2.m1.1.1" xref="S3.E15Xa.3.2.2.m1.1.1.cmml">Tree2</mi><mo id="S3.E15Xa.3.2.2.m1.2.3.3.2a" xref="S3.E15Xa.3.2.2.m1.2.3.3.1.cmml">⁡</mo><mrow id="S3.E15Xa.3.2.2.m1.2.3.3.2.1" xref="S3.E15Xa.3.2.2.m1.2.3.3.1.cmml"><mo id="S3.E15Xa.3.2.2.m1.2.3.3.2.1.1" stretchy="false" xref="S3.E15Xa.3.2.2.m1.2.3.3.1.cmml">[</mo><mi id="S3.E15Xa.3.2.2.m1.2.2" xref="S3.E15Xa.3.2.2.m1.2.2.cmml">v</mi><mo id="S3.E15Xa.3.2.2.m1.2.3.3.2.1.2" stretchy="false" xref="S3.E15Xa.3.2.2.m1.2.3.3.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E15Xa.3.2.2.m1.2b"><apply id="S3.E15Xa.3.2.2.m1.2.3.cmml" xref="S3.E15Xa.3.2.2.m1.2.3"><eq id="S3.E15Xa.3.2.2.m1.2.3.1.cmml" xref="S3.E15Xa.3.2.2.m1.2.3.1"></eq><csymbol cd="latexml" id="S3.E15Xa.3.2.2.m1.2.3.2.cmml" xref="S3.E15Xa.3.2.2.m1.2.3.2">absent</csymbol><apply id="S3.E15Xa.3.2.2.m1.2.3.3.1.cmml" xref="S3.E15Xa.3.2.2.m1.2.3.3.2"><ci id="S3.E15Xa.3.2.2.m1.1.1.cmml" xref="S3.E15Xa.3.2.2.m1.1.1">Tree2</ci><ci id="S3.E15Xa.3.2.2.m1.2.2.cmml" xref="S3.E15Xa.3.2.2.m1.2.2">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15Xa.3.2.2.m1.2c">\displaystyle=\operatorname{Tree2}[v]</annotation><annotation encoding="application/x-llamapun" id="S3.E15Xa.3.2.2.m1.2d">= Tree2 [ italic_v ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E15Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\operatorname{Tree2}[L[v]]" class="ltx_Math" display="inline" id="S3.E15Xb.2.1.1.m1.3"><semantics id="S3.E15Xb.2.1.1.m1.3a"><mrow id="S3.E15Xb.2.1.1.m1.3.3.1" xref="S3.E15Xb.2.1.1.m1.3.3.2.cmml"><mi id="S3.E15Xb.2.1.1.m1.2.2" xref="S3.E15Xb.2.1.1.m1.2.2.cmml">Tree2</mi><mo id="S3.E15Xb.2.1.1.m1.3.3.1a" xref="S3.E15Xb.2.1.1.m1.3.3.2.cmml">⁡</mo><mrow id="S3.E15Xb.2.1.1.m1.3.3.1.1" xref="S3.E15Xb.2.1.1.m1.3.3.2.cmml"><mo id="S3.E15Xb.2.1.1.m1.3.3.1.1.2" stretchy="false" xref="S3.E15Xb.2.1.1.m1.3.3.2.cmml">[</mo><mrow id="S3.E15Xb.2.1.1.m1.3.3.1.1.1" xref="S3.E15Xb.2.1.1.m1.3.3.1.1.1.cmml"><mi id="S3.E15Xb.2.1.1.m1.3.3.1.1.1.2" xref="S3.E15Xb.2.1.1.m1.3.3.1.1.1.2.cmml">L</mi><mo id="S3.E15Xb.2.1.1.m1.3.3.1.1.1.1" xref="S3.E15Xb.2.1.1.m1.3.3.1.1.1.1.cmml">⁢</mo><mrow id="S3.E15Xb.2.1.1.m1.3.3.1.1.1.3.2" xref="S3.E15Xb.2.1.1.m1.3.3.1.1.1.3.1.cmml"><mo id="S3.E15Xb.2.1.1.m1.3.3.1.1.1.3.2.1" stretchy="false" xref="S3.E15Xb.2.1.1.m1.3.3.1.1.1.3.1.1.cmml">[</mo><mi id="S3.E15Xb.2.1.1.m1.1.1" xref="S3.E15Xb.2.1.1.m1.1.1.cmml">v</mi><mo id="S3.E15Xb.2.1.1.m1.3.3.1.1.1.3.2.2" stretchy="false" xref="S3.E15Xb.2.1.1.m1.3.3.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E15Xb.2.1.1.m1.3.3.1.1.3" stretchy="false" xref="S3.E15Xb.2.1.1.m1.3.3.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E15Xb.2.1.1.m1.3b"><apply id="S3.E15Xb.2.1.1.m1.3.3.2.cmml" xref="S3.E15Xb.2.1.1.m1.3.3.1"><ci id="S3.E15Xb.2.1.1.m1.2.2.cmml" xref="S3.E15Xb.2.1.1.m1.2.2">Tree2</ci><apply id="S3.E15Xb.2.1.1.m1.3.3.1.1.1.cmml" xref="S3.E15Xb.2.1.1.m1.3.3.1.1.1"><times id="S3.E15Xb.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.E15Xb.2.1.1.m1.3.3.1.1.1.1"></times><ci id="S3.E15Xb.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.E15Xb.2.1.1.m1.3.3.1.1.1.2">𝐿</ci><apply id="S3.E15Xb.2.1.1.m1.3.3.1.1.1.3.1.cmml" xref="S3.E15Xb.2.1.1.m1.3.3.1.1.1.3.2"><csymbol cd="latexml" id="S3.E15Xb.2.1.1.m1.3.3.1.1.1.3.1.1.cmml" xref="S3.E15Xb.2.1.1.m1.3.3.1.1.1.3.2.1">delimited-[]</csymbol><ci id="S3.E15Xb.2.1.1.m1.1.1.cmml" xref="S3.E15Xb.2.1.1.m1.1.1">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15Xb.2.1.1.m1.3c">\displaystyle\operatorname{Tree2}[L[v]]</annotation><annotation encoding="application/x-llamapun" id="S3.E15Xb.2.1.1.m1.3d">Tree2 [ italic_L [ italic_v ] ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{Tree1}[R[v]]\bullet\operatorname{Tree2}[v]" class="ltx_Math" display="inline" id="S3.E15Xb.3.2.2.m1.5"><semantics id="S3.E15Xb.3.2.2.m1.5a"><mrow id="S3.E15Xb.3.2.2.m1.5.5" xref="S3.E15Xb.3.2.2.m1.5.5.cmml"><mi id="S3.E15Xb.3.2.2.m1.5.5.3" xref="S3.E15Xb.3.2.2.m1.5.5.3.cmml"></mi><mo id="S3.E15Xb.3.2.2.m1.5.5.2" xref="S3.E15Xb.3.2.2.m1.5.5.2.cmml">=</mo><mrow id="S3.E15Xb.3.2.2.m1.5.5.1" xref="S3.E15Xb.3.2.2.m1.5.5.1.cmml"><mrow id="S3.E15Xb.3.2.2.m1.5.5.1.1.1" xref="S3.E15Xb.3.2.2.m1.5.5.1.1.2.cmml"><mi id="S3.E15Xb.3.2.2.m1.2.2" xref="S3.E15Xb.3.2.2.m1.2.2.cmml">Tree1</mi><mo id="S3.E15Xb.3.2.2.m1.5.5.1.1.1a" xref="S3.E15Xb.3.2.2.m1.5.5.1.1.2.cmml">⁡</mo><mrow id="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1" xref="S3.E15Xb.3.2.2.m1.5.5.1.1.2.cmml"><mo id="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.2" stretchy="false" xref="S3.E15Xb.3.2.2.m1.5.5.1.1.2.cmml">[</mo><mrow id="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1" xref="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1.cmml"><mi id="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1.2" xref="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1.2.cmml">R</mi><mo id="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1.1" xref="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1.3.2" xref="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1.3.1.cmml"><mo id="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1.3.1.1.cmml">[</mo><mi id="S3.E15Xb.3.2.2.m1.1.1" xref="S3.E15Xb.3.2.2.m1.1.1.cmml">v</mi><mo id="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E15Xb.3.2.2.m1.5.5.1.1.2.cmml">]</mo></mrow></mrow><mo id="S3.E15Xb.3.2.2.m1.5.5.1.2" rspace="0.222em" xref="S3.E15Xb.3.2.2.m1.5.5.1.2.cmml">∙</mo><mrow id="S3.E15Xb.3.2.2.m1.5.5.1.3.2" xref="S3.E15Xb.3.2.2.m1.5.5.1.3.1.cmml"><mi id="S3.E15Xb.3.2.2.m1.3.3" xref="S3.E15Xb.3.2.2.m1.3.3.cmml">Tree2</mi><mo id="S3.E15Xb.3.2.2.m1.5.5.1.3.2a" xref="S3.E15Xb.3.2.2.m1.5.5.1.3.1.cmml">⁡</mo><mrow id="S3.E15Xb.3.2.2.m1.5.5.1.3.2.1" xref="S3.E15Xb.3.2.2.m1.5.5.1.3.1.cmml"><mo id="S3.E15Xb.3.2.2.m1.5.5.1.3.2.1.1" stretchy="false" xref="S3.E15Xb.3.2.2.m1.5.5.1.3.1.cmml">[</mo><mi id="S3.E15Xb.3.2.2.m1.4.4" xref="S3.E15Xb.3.2.2.m1.4.4.cmml">v</mi><mo id="S3.E15Xb.3.2.2.m1.5.5.1.3.2.1.2" stretchy="false" xref="S3.E15Xb.3.2.2.m1.5.5.1.3.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E15Xb.3.2.2.m1.5b"><apply id="S3.E15Xb.3.2.2.m1.5.5.cmml" xref="S3.E15Xb.3.2.2.m1.5.5"><eq id="S3.E15Xb.3.2.2.m1.5.5.2.cmml" xref="S3.E15Xb.3.2.2.m1.5.5.2"></eq><csymbol cd="latexml" id="S3.E15Xb.3.2.2.m1.5.5.3.cmml" xref="S3.E15Xb.3.2.2.m1.5.5.3">absent</csymbol><apply id="S3.E15Xb.3.2.2.m1.5.5.1.cmml" xref="S3.E15Xb.3.2.2.m1.5.5.1"><ci id="S3.E15Xb.3.2.2.m1.5.5.1.2.cmml" xref="S3.E15Xb.3.2.2.m1.5.5.1.2">∙</ci><apply id="S3.E15Xb.3.2.2.m1.5.5.1.1.2.cmml" xref="S3.E15Xb.3.2.2.m1.5.5.1.1.1"><ci id="S3.E15Xb.3.2.2.m1.2.2.cmml" xref="S3.E15Xb.3.2.2.m1.2.2">Tree1</ci><apply id="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1.cmml" xref="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1"><times id="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1.1"></times><ci id="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1.2">𝑅</ci><apply id="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1.3.1.cmml" xref="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1.3.2"><csymbol cd="latexml" id="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1.3.1.1.cmml" xref="S3.E15Xb.3.2.2.m1.5.5.1.1.1.1.1.3.2.1">delimited-[]</csymbol><ci id="S3.E15Xb.3.2.2.m1.1.1.cmml" xref="S3.E15Xb.3.2.2.m1.1.1">𝑣</ci></apply></apply></apply><apply id="S3.E15Xb.3.2.2.m1.5.5.1.3.1.cmml" xref="S3.E15Xb.3.2.2.m1.5.5.1.3.2"><ci id="S3.E15Xb.3.2.2.m1.3.3.cmml" xref="S3.E15Xb.3.2.2.m1.3.3">Tree2</ci><ci id="S3.E15Xb.3.2.2.m1.4.4.cmml" xref="S3.E15Xb.3.2.2.m1.4.4">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15Xb.3.2.2.m1.5c">\displaystyle=\operatorname{Tree1}[R[v]]\bullet\operatorname{Tree2}[v]</annotation><annotation encoding="application/x-llamapun" id="S3.E15Xb.3.2.2.m1.5d">= Tree1 [ italic_R [ italic_v ] ] ∙ Tree2 [ italic_v ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.25">where <math alttext="v" class="ltx_Math" display="inline" id="S3.SS3.p2.21.m1.1"><semantics id="S3.SS3.p2.21.m1.1a"><mi id="S3.SS3.p2.21.m1.1.1" xref="S3.SS3.p2.21.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.21.m1.1b"><ci id="S3.SS3.p2.21.m1.1.1.cmml" xref="S3.SS3.p2.21.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.21.m1.1c">v</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.21.m1.1d">italic_v</annotation></semantics></math> denotes a node in Tree1 or Tree2, <math alttext="L[v]" class="ltx_Math" display="inline" id="S3.SS3.p2.22.m2.1"><semantics id="S3.SS3.p2.22.m2.1a"><mrow id="S3.SS3.p2.22.m2.1.2" xref="S3.SS3.p2.22.m2.1.2.cmml"><mi id="S3.SS3.p2.22.m2.1.2.2" xref="S3.SS3.p2.22.m2.1.2.2.cmml">L</mi><mo id="S3.SS3.p2.22.m2.1.2.1" xref="S3.SS3.p2.22.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p2.22.m2.1.2.3.2" xref="S3.SS3.p2.22.m2.1.2.3.1.cmml"><mo id="S3.SS3.p2.22.m2.1.2.3.2.1" stretchy="false" xref="S3.SS3.p2.22.m2.1.2.3.1.1.cmml">[</mo><mi id="S3.SS3.p2.22.m2.1.1" xref="S3.SS3.p2.22.m2.1.1.cmml">v</mi><mo id="S3.SS3.p2.22.m2.1.2.3.2.2" stretchy="false" xref="S3.SS3.p2.22.m2.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.22.m2.1b"><apply id="S3.SS3.p2.22.m2.1.2.cmml" xref="S3.SS3.p2.22.m2.1.2"><times id="S3.SS3.p2.22.m2.1.2.1.cmml" xref="S3.SS3.p2.22.m2.1.2.1"></times><ci id="S3.SS3.p2.22.m2.1.2.2.cmml" xref="S3.SS3.p2.22.m2.1.2.2">𝐿</ci><apply id="S3.SS3.p2.22.m2.1.2.3.1.cmml" xref="S3.SS3.p2.22.m2.1.2.3.2"><csymbol cd="latexml" id="S3.SS3.p2.22.m2.1.2.3.1.1.cmml" xref="S3.SS3.p2.22.m2.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS3.p2.22.m2.1.1.cmml" xref="S3.SS3.p2.22.m2.1.1">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.22.m2.1c">L[v]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.22.m2.1d">italic_L [ italic_v ]</annotation></semantics></math> denotes the left child, and <math alttext="R[v]" class="ltx_Math" display="inline" id="S3.SS3.p2.23.m3.1"><semantics id="S3.SS3.p2.23.m3.1a"><mrow id="S3.SS3.p2.23.m3.1.2" xref="S3.SS3.p2.23.m3.1.2.cmml"><mi id="S3.SS3.p2.23.m3.1.2.2" xref="S3.SS3.p2.23.m3.1.2.2.cmml">R</mi><mo id="S3.SS3.p2.23.m3.1.2.1" xref="S3.SS3.p2.23.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p2.23.m3.1.2.3.2" xref="S3.SS3.p2.23.m3.1.2.3.1.cmml"><mo id="S3.SS3.p2.23.m3.1.2.3.2.1" stretchy="false" xref="S3.SS3.p2.23.m3.1.2.3.1.1.cmml">[</mo><mi id="S3.SS3.p2.23.m3.1.1" xref="S3.SS3.p2.23.m3.1.1.cmml">v</mi><mo id="S3.SS3.p2.23.m3.1.2.3.2.2" stretchy="false" xref="S3.SS3.p2.23.m3.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.23.m3.1b"><apply id="S3.SS3.p2.23.m3.1.2.cmml" xref="S3.SS3.p2.23.m3.1.2"><times id="S3.SS3.p2.23.m3.1.2.1.cmml" xref="S3.SS3.p2.23.m3.1.2.1"></times><ci id="S3.SS3.p2.23.m3.1.2.2.cmml" xref="S3.SS3.p2.23.m3.1.2.2">𝑅</ci><apply id="S3.SS3.p2.23.m3.1.2.3.1.cmml" xref="S3.SS3.p2.23.m3.1.2.3.2"><csymbol cd="latexml" id="S3.SS3.p2.23.m3.1.2.3.1.1.cmml" xref="S3.SS3.p2.23.m3.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS3.p2.23.m3.1.1.cmml" xref="S3.SS3.p2.23.m3.1.1">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.23.m3.1c">R[v]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.23.m3.1d">italic_R [ italic_v ]</annotation></semantics></math> denotes the right child of <math alttext="v" class="ltx_Math" display="inline" id="S3.SS3.p2.24.m4.1"><semantics id="S3.SS3.p2.24.m4.1a"><mi id="S3.SS3.p2.24.m4.1.1" xref="S3.SS3.p2.24.m4.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.24.m4.1b"><ci id="S3.SS3.p2.24.m4.1.1.cmml" xref="S3.SS3.p2.24.m4.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.24.m4.1c">v</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.24.m4.1d">italic_v</annotation></semantics></math>. After sweeping the binary trees, the hidden representations <math alttext="H" class="ltx_Math" display="inline" id="S3.SS3.p2.25.m5.1"><semantics id="S3.SS3.p2.25.m5.1a"><mi id="S3.SS3.p2.25.m5.1.1" xref="S3.SS3.p2.25.m5.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.25.m5.1b"><ci id="S3.SS3.p2.25.m5.1.1.cmml" xref="S3.SS3.p2.25.m5.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.25.m5.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.25.m5.1d">italic_H</annotation></semantics></math> in Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S3.E14" title="Equation 14 ‣ 3.3. Hardware-Aware Parallel Scan ‣ 3. Methodology ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">14</span></a> are computed efficiently. In contrast to serial scan, computing the hidden representations in a sequential manner, with each step depending on the result of the previous step, parallel scan enables parallelizable computation across time steps, significantly enhancing efficiency.</p>
</div>
<figure class="ltx_figure" id="S3.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="133" id="S3.F3.g1" src="x3.png" width="274"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="141" id="S3.F3.g2" src="x4.png" width="290"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>Parallel scan for computing hidden representations.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.2"><span class="ltx_text ltx_font_bold" id="S3.SS3.p3.2.1">Embedding Padding.</span>
In real-world scenarios, the lengths of user behavior sequences can vary significantly. We often need to pad these sequences to achieve a uniform length for efficient and consistent processing. Moreover, our BD-LRUs with parallel scans require sequence lengths to be powers of two to build perfect binary trees for parallelizable training. To address this, a dynamic padding strategy should be employed, which involves determining the maximum sequence length, finding the nearest power of two greater than or equal to it, and padding all sequences to that length.
We deviate from the conventional approach of sequence padding and instead leverage embedding padding. Since parallel scans are exclusively performed within the core BD-LRUs, for the remaining convolutional and fully connected layers, padded sequence lengths introduce unnecessary computational costs.
Therefore, strategically apply embedding padding only to the hidden representations <math alttext="H" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">italic_H</annotation></semantics></math> immediately before each BD-LRU, and after the BD-LRU, we truncate the hidden representations <math alttext="H" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.1"><semantics id="S3.SS3.p3.2.m2.1a"><mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.m2.1d">italic_H</annotation></semantics></math> to the original length. This approach proves more efficient compared to sequence padding. Notably, we employ left-padding with zeros to preserve the chronological information within the behavior embeddings.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.p4.1.1">Algorithm Efficiency.</span>
We implement a custom CUDA kernel for the hardware-aware parallel scan algorithm to achieve high efficiency for GPU acceleration. The kernel unlocks parallel execution for training BD-LRUs on GPUs. This significantly reduces the time complexity by leveraging multiple GPU processors simultaneously. Furthermore, by employing embedding padding, we further optimize the computation, avoiding unnecessary operations and improving the overall efficiency of the algorithm.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1. </span>Performance comparison on five datasets. The best results are highlighted in bold, and the second-best are underlined. The relative improvements in comparison to the best baselines are indicated as Improv. The symbol <math alttext="*" class="ltx_Math" display="inline" id="S3.T1.3.m1.1"><semantics id="S3.T1.3.m1.1b"><mo id="S3.T1.3.m1.1.1" xref="S3.T1.3.m1.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S3.T1.3.m1.1c"><times id="S3.T1.3.m1.1.1.cmml" xref="S3.T1.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.m1.1d">*</annotation><annotation encoding="application/x-llamapun" id="S3.T1.3.m1.1e">∗</annotation></semantics></math> indicates a statistically significant improvement of RecBLR over the best baseline with <math alttext="p" class="ltx_Math" display="inline" id="S3.T1.4.m2.1"><semantics id="S3.T1.4.m2.1b"><mi id="S3.T1.4.m2.1.1" xref="S3.T1.4.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.T1.4.m2.1c"><ci id="S3.T1.4.m2.1.1.cmml" xref="S3.T1.4.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.m2.1d">p</annotation><annotation encoding="application/x-llamapun" id="S3.T1.4.m2.1e">italic_p</annotation></semantics></math>-value ¡ 0.01.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T1.34.30">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.34.30.31.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T1.34.30.31.1.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.34.30.31.1.1.1">Datasets</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T1.34.30.31.1.2" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.34.30.31.1.2.1">Metric</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.34.30.31.1.3" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.34.30.31.1.3.1">FPMC</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.34.30.31.1.4" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.34.30.31.1.4.1">Caser</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.34.30.31.1.5" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.34.30.31.1.5.1">NARM</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.34.30.31.1.6" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.34.30.31.1.6.1">GRU4Rec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.34.30.31.1.7" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.34.30.31.1.7.1">SASRec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.34.30.31.1.8" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.34.30.31.1.8.1">BERT4Rec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.34.30.31.1.9" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.34.30.31.1.9.1">FMLP-Rec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.34.30.31.1.10" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.34.30.31.1.10.1">LRURec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.34.30.31.1.11" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.34.30.31.1.11.1">RecBLR</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.34.30.31.1.12" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.34.30.31.1.12.1">Improv.</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.5.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.5.1.1.2" rowspan="6" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.1.2.1">ML-1M</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.5.1.1.3" style="padding-left:5.0pt;padding-right:5.0pt;">HR@10</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.1.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.1760</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.1.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.2399</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.1.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.2836</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.1.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.2937</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.1.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.2993</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.1.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.2950</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.1.10" style="padding-left:5.0pt;padding-right:5.0pt;">0.2732</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.1.11" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.5.1.1.11.1">0.3057</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.1.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.1.1.1">0.3285<sup class="ltx_sup" id="S3.T1.5.1.1.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.5.1.1.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.1.12" style="padding-left:5.0pt;padding-right:5.0pt;">7.46%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.6.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.6.2.2.2" style="padding-left:5.0pt;padding-right:5.0pt;">NDCG@10</th>
<td class="ltx_td ltx_align_center" id="S3.T1.6.2.2.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0933</td>
<td class="ltx_td ltx_align_center" id="S3.T1.6.2.2.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.1283</td>
<td class="ltx_td ltx_align_center" id="S3.T1.6.2.2.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.1597</td>
<td class="ltx_td ltx_align_center" id="S3.T1.6.2.2.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.1638</td>
<td class="ltx_td ltx_align_center" id="S3.T1.6.2.2.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.1692</td>
<td class="ltx_td ltx_align_center" id="S3.T1.6.2.2.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.1664</td>
<td class="ltx_td ltx_align_center" id="S3.T1.6.2.2.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.1416</td>
<td class="ltx_td ltx_align_center" id="S3.T1.6.2.2.10" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.6.2.2.10.1">0.1772</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.6.2.2.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.6.2.2.1.1">0.1901<sup class="ltx_sup" id="S3.T1.6.2.2.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.6.2.2.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.6.2.2.11" style="padding-left:5.0pt;padding-right:5.0pt;">7.28%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.3.3.2" style="padding-left:5.0pt;padding-right:5.0pt;">MRR@10</th>
<td class="ltx_td ltx_align_center" id="S3.T1.7.3.3.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0682</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.3.3.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0944</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.3.3.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.1220</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.3.3.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.1245</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.3.3.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.1294</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.3.3.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.1273</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.3.3.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.1056</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.3.3.10" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.7.3.3.10.1">0.1380</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.3.3.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.3.3.1.1">0.1478<sup class="ltx_sup" id="S3.T1.7.3.3.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.7.3.3.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.3.3.11" style="padding-left:5.0pt;padding-right:5.0pt;">7.10%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.8.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.8.4.4.2" style="padding-left:5.0pt;padding-right:5.0pt;">HR@20</th>
<td class="ltx_td ltx_align_center" id="S3.T1.8.4.4.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.2584</td>
<td class="ltx_td ltx_align_center" id="S3.T1.8.4.4.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.3457</td>
<td class="ltx_td ltx_align_center" id="S3.T1.8.4.4.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.3841</td>
<td class="ltx_td ltx_align_center" id="S3.T1.8.4.4.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.4013</td>
<td class="ltx_td ltx_align_center" id="S3.T1.8.4.4.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.4053</td>
<td class="ltx_td ltx_align_center" id="S3.T1.8.4.4.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.3978</td>
<td class="ltx_td ltx_align_center" id="S3.T1.8.4.4.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.3861</td>
<td class="ltx_td ltx_align_center" id="S3.T1.8.4.4.10" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.8.4.4.10.1">0.4078</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.8.4.4.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.8.4.4.1.1">0.4336<sup class="ltx_sup" id="S3.T1.8.4.4.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.8.4.4.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.8.4.4.11" style="padding-left:5.0pt;padding-right:5.0pt;">6.33%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.9.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.9.5.5.2" style="padding-left:5.0pt;padding-right:5.0pt;">NDCG@20</th>
<td class="ltx_td ltx_align_center" id="S3.T1.9.5.5.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.1140</td>
<td class="ltx_td ltx_align_center" id="S3.T1.9.5.5.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.1550</td>
<td class="ltx_td ltx_align_center" id="S3.T1.9.5.5.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.1851</td>
<td class="ltx_td ltx_align_center" id="S3.T1.9.5.5.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.1911</td>
<td class="ltx_td ltx_align_center" id="S3.T1.9.5.5.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.1958</td>
<td class="ltx_td ltx_align_center" id="S3.T1.9.5.5.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.1922</td>
<td class="ltx_td ltx_align_center" id="S3.T1.9.5.5.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.1672</td>
<td class="ltx_td ltx_align_center" id="S3.T1.9.5.5.10" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.9.5.5.10.1">0.2030</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.9.5.5.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.9.5.5.1.1">0.2161<sup class="ltx_sup" id="S3.T1.9.5.5.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.9.5.5.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.9.5.5.11" style="padding-left:5.0pt;padding-right:5.0pt;">6.45%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.10.6.6.2" style="padding-left:5.0pt;padding-right:5.0pt;">MRR@20</th>
<td class="ltx_td ltx_align_center" id="S3.T1.10.6.6.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0739</td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.6.6.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.1017</td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.6.6.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.1290</td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.6.6.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.1320</td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.6.6.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.1367</td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.6.6.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.1343</td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.6.6.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.1126</td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.6.6.10" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.10.6.6.10.1">0.1451</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.6.6.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.10.6.6.1.1">0.1547<sup class="ltx_sup" id="S3.T1.10.6.6.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.10.6.6.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.6.6.11" style="padding-left:5.0pt;padding-right:5.0pt;">6.62%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.11.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.11.7.7.2" rowspan="6" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.11.7.7.2.1">Gowalla</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.11.7.7.3" style="padding-left:5.0pt;padding-right:5.0pt;">HR@10</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.11.7.7.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0735</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.11.7.7.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0747</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.11.7.7.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0983</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.11.7.7.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.0953</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.11.7.7.8" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.11.7.7.8.1">0.1202</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.11.7.7.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.1033</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.11.7.7.10" style="padding-left:5.0pt;padding-right:5.0pt;">0.1152</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.11.7.7.11" style="padding-left:5.0pt;padding-right:5.0pt;">0.1189</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.11.7.7.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.11.7.7.1.1">0.1248<sup class="ltx_sup" id="S3.T1.11.7.7.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.11.7.7.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.11.7.7.12" style="padding-left:5.0pt;padding-right:5.0pt;">3.83%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.12.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.12.8.8.2" style="padding-left:5.0pt;padding-right:5.0pt;">NDCG@10</th>
<td class="ltx_td ltx_align_center" id="S3.T1.12.8.8.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0415</td>
<td class="ltx_td ltx_align_center" id="S3.T1.12.8.8.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0438</td>
<td class="ltx_td ltx_align_center" id="S3.T1.12.8.8.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0528</td>
<td class="ltx_td ltx_align_center" id="S3.T1.12.8.8.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0513</td>
<td class="ltx_td ltx_align_center" id="S3.T1.12.8.8.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.0565</td>
<td class="ltx_td ltx_align_center" id="S3.T1.12.8.8.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.0537</td>
<td class="ltx_td ltx_align_center" id="S3.T1.12.8.8.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.0569</td>
<td class="ltx_td ltx_align_center" id="S3.T1.12.8.8.10" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.12.8.8.10.1">0.0574</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.12.8.8.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.12.8.8.1.1">0.0601<sup class="ltx_sup" id="S3.T1.12.8.8.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.12.8.8.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.12.8.8.11" style="padding-left:5.0pt;padding-right:5.0pt;">4.70%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.13.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.13.9.9.2" style="padding-left:5.0pt;padding-right:5.0pt;">MRR@10</th>
<td class="ltx_td ltx_align_center" id="S3.T1.13.9.9.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0318</td>
<td class="ltx_td ltx_align_center" id="S3.T1.13.9.9.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0335</td>
<td class="ltx_td ltx_align_center" id="S3.T1.13.9.9.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0391</td>
<td class="ltx_td ltx_align_center" id="S3.T1.13.9.9.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0380</td>
<td class="ltx_td ltx_align_center" id="S3.T1.13.9.9.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.0370</td>
<td class="ltx_td ltx_align_center" id="S3.T1.13.9.9.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.0386</td>
<td class="ltx_td ltx_align_center" id="S3.T1.13.9.9.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.0379</td>
<td class="ltx_td ltx_align_center" id="S3.T1.13.9.9.10" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.13.9.9.10.1">0.0387</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.13.9.9.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.13.9.9.1.1">0.0405<sup class="ltx_sup" id="S3.T1.13.9.9.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.13.9.9.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.13.9.9.11" style="padding-left:5.0pt;padding-right:5.0pt;">4.65%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.14.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.14.10.10.2" style="padding-left:5.0pt;padding-right:5.0pt;">HR@20</th>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.10.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.1067</td>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.10.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.1109</td>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.10.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.1472</td>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.10.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.1415</td>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.10.7" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.14.10.10.7.1">0.1785</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.10.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.1541</td>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.10.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.1726</td>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.10.10" style="padding-left:5.0pt;padding-right:5.0pt;">0.1741</td>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.10.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.14.10.10.1.1">0.1837<sup class="ltx_sup" id="S3.T1.14.10.10.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.14.10.10.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.10.11" style="padding-left:5.0pt;padding-right:5.0pt;">2.91%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.15.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.15.11.11.2" style="padding-left:5.0pt;padding-right:5.0pt;">NDCG@20</th>
<td class="ltx_td ltx_align_center" id="S3.T1.15.11.11.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0498</td>
<td class="ltx_td ltx_align_center" id="S3.T1.15.11.11.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0519</td>
<td class="ltx_td ltx_align_center" id="S3.T1.15.11.11.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0651</td>
<td class="ltx_td ltx_align_center" id="S3.T1.15.11.11.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0629</td>
<td class="ltx_td ltx_align_center" id="S3.T1.15.11.11.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.0712</td>
<td class="ltx_td ltx_align_center" id="S3.T1.15.11.11.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.0664</td>
<td class="ltx_td ltx_align_center" id="S3.T1.15.11.11.9" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.15.11.11.9.1">0.0714</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.15.11.11.10" style="padding-left:5.0pt;padding-right:5.0pt;">0.0713</td>
<td class="ltx_td ltx_align_center" id="S3.T1.15.11.11.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.15.11.11.1.1">0.0751<sup class="ltx_sup" id="S3.T1.15.11.11.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.15.11.11.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.15.11.11.11" style="padding-left:5.0pt;padding-right:5.0pt;">5.18%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.16.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.16.12.12.2" style="padding-left:5.0pt;padding-right:5.0pt;">MRR@20</th>
<td class="ltx_td ltx_align_center" id="S3.T1.16.12.12.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0340</td>
<td class="ltx_td ltx_align_center" id="S3.T1.16.12.12.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0367</td>
<td class="ltx_td ltx_align_center" id="S3.T1.16.12.12.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0424</td>
<td class="ltx_td ltx_align_center" id="S3.T1.16.12.12.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0411</td>
<td class="ltx_td ltx_align_center" id="S3.T1.16.12.12.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.0410</td>
<td class="ltx_td ltx_align_center" id="S3.T1.16.12.12.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.0421</td>
<td class="ltx_td ltx_align_center" id="S3.T1.16.12.12.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.0421</td>
<td class="ltx_td ltx_align_center" id="S3.T1.16.12.12.10" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.16.12.12.10.1">0.0425</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.16.12.12.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.16.12.12.1.1">0.0445<sup class="ltx_sup" id="S3.T1.16.12.12.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.16.12.12.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.16.12.12.11" style="padding-left:5.0pt;padding-right:5.0pt;">4.71%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.17.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.17.13.13.2" rowspan="6" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.17.13.13.2.1">Steam</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.17.13.13.3" style="padding-left:5.0pt;padding-right:5.0pt;">HR@10</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.17.13.13.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.1171</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.17.13.13.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.1369</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.17.13.13.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.1315</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.17.13.13.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.1327</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.17.13.13.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.1391</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.17.13.13.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.1366</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.17.13.13.10" style="padding-left:5.0pt;padding-right:5.0pt;">0.1305</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.17.13.13.11" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.17.13.13.11.1">0.1397</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.17.13.13.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.17.13.13.1.1">0.1421<sup class="ltx_sup" id="S3.T1.17.13.13.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.17.13.13.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.17.13.13.12" style="padding-left:5.0pt;padding-right:5.0pt;">1.72%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.18.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.18.14.14.2" style="padding-left:5.0pt;padding-right:5.0pt;">NDCG@10</th>
<td class="ltx_td ltx_align_center" id="S3.T1.18.14.14.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0591</td>
<td class="ltx_td ltx_align_center" id="S3.T1.18.14.14.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0675</td>
<td class="ltx_td ltx_align_center" id="S3.T1.18.14.14.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0664</td>
<td class="ltx_td ltx_align_center" id="S3.T1.18.14.14.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0698</td>
<td class="ltx_td ltx_align_center" id="S3.T1.18.14.14.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.0705</td>
<td class="ltx_td ltx_align_center" id="S3.T1.18.14.14.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.0700</td>
<td class="ltx_td ltx_align_center" id="S3.T1.18.14.14.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.0673</td>
<td class="ltx_td ltx_align_center" id="S3.T1.18.14.14.10" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.18.14.14.10.1">0.0710</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.18.14.14.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.18.14.14.1.1">0.0745<sup class="ltx_sup" id="S3.T1.18.14.14.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.18.14.14.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.18.14.14.11" style="padding-left:5.0pt;padding-right:5.0pt;">4.93%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.19.15.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.19.15.15.2" style="padding-left:5.0pt;padding-right:5.0pt;">MRR@10</th>
<td class="ltx_td ltx_align_center" id="S3.T1.19.15.15.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0417</td>
<td class="ltx_td ltx_align_center" id="S3.T1.19.15.15.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0468</td>
<td class="ltx_td ltx_align_center" id="S3.T1.19.15.15.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0470</td>
<td class="ltx_td ltx_align_center" id="S3.T1.19.15.15.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0509</td>
<td class="ltx_td ltx_align_center" id="S3.T1.19.15.15.7" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.19.15.15.7.1">0.0511</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.19.15.15.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.0510</td>
<td class="ltx_td ltx_align_center" id="S3.T1.19.15.15.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.0484</td>
<td class="ltx_td ltx_align_center" id="S3.T1.19.15.15.10" style="padding-left:5.0pt;padding-right:5.0pt;">0.0504</td>
<td class="ltx_td ltx_align_center" id="S3.T1.19.15.15.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.19.15.15.1.1">0.0544<sup class="ltx_sup" id="S3.T1.19.15.15.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.19.15.15.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.19.15.15.11" style="padding-left:5.0pt;padding-right:5.0pt;">6.46%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.20.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.20.16.16.2" style="padding-left:5.0pt;padding-right:5.0pt;">HR@20</th>
<td class="ltx_td ltx_align_center" id="S3.T1.20.16.16.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.1670</td>
<td class="ltx_td ltx_align_center" id="S3.T1.20.16.16.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.2062</td>
<td class="ltx_td ltx_align_center" id="S3.T1.20.16.16.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.1945</td>
<td class="ltx_td ltx_align_center" id="S3.T1.20.16.16.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.2004</td>
<td class="ltx_td ltx_align_center" id="S3.T1.20.16.16.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.2026</td>
<td class="ltx_td ltx_align_center" id="S3.T1.20.16.16.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.2016</td>
<td class="ltx_td ltx_align_center" id="S3.T1.20.16.16.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.1919</td>
<td class="ltx_td ltx_align_center" id="S3.T1.20.16.16.10" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.20.16.16.10.1">0.2054</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.20.16.16.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.20.16.16.1.1">0.2116<sup class="ltx_sup" id="S3.T1.20.16.16.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.20.16.16.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.20.16.16.11" style="padding-left:5.0pt;padding-right:5.0pt;">3.02%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.21.17.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.21.17.17.2" style="padding-left:5.0pt;padding-right:5.0pt;">NDCG@20</th>
<td class="ltx_td ltx_align_center" id="S3.T1.21.17.17.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0716</td>
<td class="ltx_td ltx_align_center" id="S3.T1.21.17.17.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0850</td>
<td class="ltx_td ltx_align_center" id="S3.T1.21.17.17.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0823</td>
<td class="ltx_td ltx_align_center" id="S3.T1.21.17.17.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0869</td>
<td class="ltx_td ltx_align_center" id="S3.T1.21.17.17.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.0873</td>
<td class="ltx_td ltx_align_center" id="S3.T1.21.17.17.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.0871</td>
<td class="ltx_td ltx_align_center" id="S3.T1.21.17.17.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.0828</td>
<td class="ltx_td ltx_align_center" id="S3.T1.21.17.17.10" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.21.17.17.10.1">0.0876</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.21.17.17.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.21.17.17.1.1">0.0923<sup class="ltx_sup" id="S3.T1.21.17.17.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.21.17.17.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.21.17.17.11" style="padding-left:5.0pt;padding-right:5.0pt;">5.37%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.22.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.22.18.18.2" style="padding-left:5.0pt;padding-right:5.0pt;">MRR@20</th>
<td class="ltx_td ltx_align_center" id="S3.T1.22.18.18.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0450</td>
<td class="ltx_td ltx_align_center" id="S3.T1.22.18.18.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0516</td>
<td class="ltx_td ltx_align_center" id="S3.T1.22.18.18.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0513</td>
<td class="ltx_td ltx_align_center" id="S3.T1.22.18.18.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0556</td>
<td class="ltx_td ltx_align_center" id="S3.T1.22.18.18.7" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.22.18.18.7.1">0.0557</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.22.18.18.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.0554</td>
<td class="ltx_td ltx_align_center" id="S3.T1.22.18.18.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.0526</td>
<td class="ltx_td ltx_align_center" id="S3.T1.22.18.18.10" style="padding-left:5.0pt;padding-right:5.0pt;">0.0550</td>
<td class="ltx_td ltx_align_center" id="S3.T1.22.18.18.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.22.18.18.1.1">0.0593<sup class="ltx_sup" id="S3.T1.22.18.18.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.22.18.18.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.22.18.18.11" style="padding-left:5.0pt;padding-right:5.0pt;">6.46%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.23.19.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.23.19.19.2" rowspan="6" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.23.19.19.2.1">Beauty</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.23.19.19.3" style="padding-left:5.0pt;padding-right:5.0pt;">HR@10</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.23.19.19.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0559</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.23.19.19.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0582</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.23.19.19.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0627</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.23.19.19.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.0606</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.23.19.19.8" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.23.19.19.8.1">0.0829</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.23.19.19.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.0780</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.23.19.19.10" style="padding-left:5.0pt;padding-right:5.0pt;">0.0798</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.23.19.19.11" style="padding-left:5.0pt;padding-right:5.0pt;">0.0759</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.23.19.19.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.23.19.19.1.1">0.0881<sup class="ltx_sup" id="S3.T1.23.19.19.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.23.19.19.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.23.19.19.12" style="padding-left:5.0pt;padding-right:5.0pt;">6.27%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.24.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.24.20.20.2" style="padding-left:5.0pt;padding-right:5.0pt;">NDCG@10</th>
<td class="ltx_td ltx_align_center" id="S3.T1.24.20.20.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0309</td>
<td class="ltx_td ltx_align_center" id="S3.T1.24.20.20.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0318</td>
<td class="ltx_td ltx_align_center" id="S3.T1.24.20.20.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0333</td>
<td class="ltx_td ltx_align_center" id="S3.T1.24.20.20.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0332</td>
<td class="ltx_td ltx_align_center" id="S3.T1.24.20.20.7" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.24.20.20.7.1">0.0409</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.24.20.20.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.0399</td>
<td class="ltx_td ltx_align_center" id="S3.T1.24.20.20.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.0407</td>
<td class="ltx_td ltx_align_center" id="S3.T1.24.20.20.10" style="padding-left:5.0pt;padding-right:5.0pt;">0.0393</td>
<td class="ltx_td ltx_align_center" id="S3.T1.24.20.20.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.24.20.20.1.1">0.0446<sup class="ltx_sup" id="S3.T1.24.20.20.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.24.20.20.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.24.20.20.11" style="padding-left:5.0pt;padding-right:5.0pt;">9.05%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.25.21.21">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.25.21.21.2" style="padding-left:5.0pt;padding-right:5.0pt;">MRR@10</th>
<td class="ltx_td ltx_align_center" id="S3.T1.25.21.21.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0234</td>
<td class="ltx_td ltx_align_center" id="S3.T1.25.21.21.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0239</td>
<td class="ltx_td ltx_align_center" id="S3.T1.25.21.21.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0247</td>
<td class="ltx_td ltx_align_center" id="S3.T1.25.21.21.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0249</td>
<td class="ltx_td ltx_align_center" id="S3.T1.25.21.21.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.0281</td>
<td class="ltx_td ltx_align_center" id="S3.T1.25.21.21.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.0262</td>
<td class="ltx_td ltx_align_center" id="S3.T1.25.21.21.9" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.25.21.21.9.1">0.0288</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.25.21.21.10" style="padding-left:5.0pt;padding-right:5.0pt;">0.0280</td>
<td class="ltx_td ltx_align_center" id="S3.T1.25.21.21.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.25.21.21.1.1">0.0313<sup class="ltx_sup" id="S3.T1.25.21.21.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.25.21.21.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.25.21.21.11" style="padding-left:5.0pt;padding-right:5.0pt;">8.68%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.26.22.22">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.26.22.22.2" style="padding-left:5.0pt;padding-right:5.0pt;">HR@20</th>
<td class="ltx_td ltx_align_center" id="S3.T1.26.22.22.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0825</td>
<td class="ltx_td ltx_align_center" id="S3.T1.26.22.22.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0885</td>
<td class="ltx_td ltx_align_center" id="S3.T1.26.22.22.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0899</td>
<td class="ltx_td ltx_align_center" id="S3.T1.26.22.22.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0858</td>
<td class="ltx_td ltx_align_center" id="S3.T1.26.22.22.7" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.26.22.22.7.1">0.1163</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.26.22.22.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.1082</td>
<td class="ltx_td ltx_align_center" id="S3.T1.26.22.22.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.1159</td>
<td class="ltx_td ltx_align_center" id="S3.T1.26.22.22.10" style="padding-left:5.0pt;padding-right:5.0pt;">0.1107</td>
<td class="ltx_td ltx_align_center" id="S3.T1.26.22.22.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.26.22.22.1.1">0.1243<sup class="ltx_sup" id="S3.T1.26.22.22.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.26.22.22.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.26.22.22.11" style="padding-left:5.0pt;padding-right:5.0pt;">6.88%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.27.23.23">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.27.23.23.2" style="padding-left:5.0pt;padding-right:5.0pt;">NDCG@20</th>
<td class="ltx_td ltx_align_center" id="S3.T1.27.23.23.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0376</td>
<td class="ltx_td ltx_align_center" id="S3.T1.27.23.23.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0384</td>
<td class="ltx_td ltx_align_center" id="S3.T1.27.23.23.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0405</td>
<td class="ltx_td ltx_align_center" id="S3.T1.27.23.23.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0395</td>
<td class="ltx_td ltx_align_center" id="S3.T1.27.23.23.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.0494</td>
<td class="ltx_td ltx_align_center" id="S3.T1.27.23.23.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.0459</td>
<td class="ltx_td ltx_align_center" id="S3.T1.27.23.23.9" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.27.23.23.9.1">0.0497</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.27.23.23.10" style="padding-left:5.0pt;padding-right:5.0pt;">0.0480</td>
<td class="ltx_td ltx_align_center" id="S3.T1.27.23.23.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.27.23.23.1.1">0.0538<sup class="ltx_sup" id="S3.T1.27.23.23.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.27.23.23.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.27.23.23.11" style="padding-left:5.0pt;padding-right:5.0pt;">8.25%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.28.24.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.28.24.24.2" style="padding-left:5.0pt;padding-right:5.0pt;">MRR@20</th>
<td class="ltx_td ltx_align_center" id="S3.T1.28.24.24.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0252</td>
<td class="ltx_td ltx_align_center" id="S3.T1.28.24.24.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0262</td>
<td class="ltx_td ltx_align_center" id="S3.T1.28.24.24.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0267</td>
<td class="ltx_td ltx_align_center" id="S3.T1.28.24.24.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0266</td>
<td class="ltx_td ltx_align_center" id="S3.T1.28.24.24.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.0304</td>
<td class="ltx_td ltx_align_center" id="S3.T1.28.24.24.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.0286</td>
<td class="ltx_td ltx_align_center" id="S3.T1.28.24.24.9" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.28.24.24.9.1">0.0312</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.28.24.24.10" style="padding-left:5.0pt;padding-right:5.0pt;">0.0304</td>
<td class="ltx_td ltx_align_center" id="S3.T1.28.24.24.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.28.24.24.1.1">0.0338<sup class="ltx_sup" id="S3.T1.28.24.24.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.28.24.24.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.28.24.24.11" style="padding-left:5.0pt;padding-right:5.0pt;">8.33%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.29.25.25">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_bb ltx_border_t" id="S3.T1.29.25.25.2" rowspan="6" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.29.25.25.2.1">Sports</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.29.25.25.3" style="padding-left:5.0pt;padding-right:5.0pt;">HR@10</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.29.25.25.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0301</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.29.25.25.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0310</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.29.25.25.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0333</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.29.25.25.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.0318</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.29.25.25.8" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.29.25.25.8.1">0.0477</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.29.25.25.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.0459</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.29.25.25.10" style="padding-left:5.0pt;padding-right:5.0pt;">0.0474</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.29.25.25.11" style="padding-left:5.0pt;padding-right:5.0pt;">0.0464</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.29.25.25.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.29.25.25.1.1">0.0500<sup class="ltx_sup" id="S3.T1.29.25.25.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.29.25.25.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.29.25.25.12" style="padding-left:5.0pt;padding-right:5.0pt;">4.82%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.30.26.26">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.30.26.26.2" style="padding-left:5.0pt;padding-right:5.0pt;">NDCG@10</th>
<td class="ltx_td ltx_align_center" id="S3.T1.30.26.26.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0157</td>
<td class="ltx_td ltx_align_center" id="S3.T1.30.26.26.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0162</td>
<td class="ltx_td ltx_align_center" id="S3.T1.30.26.26.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0170</td>
<td class="ltx_td ltx_align_center" id="S3.T1.30.26.26.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0164</td>
<td class="ltx_td ltx_align_center" id="S3.T1.30.26.26.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.0225</td>
<td class="ltx_td ltx_align_center" id="S3.T1.30.26.26.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.0208</td>
<td class="ltx_td ltx_align_center" id="S3.T1.30.26.26.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.0229</td>
<td class="ltx_td ltx_align_center" id="S3.T1.30.26.26.10" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.30.26.26.10.1">0.0230</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.30.26.26.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.30.26.26.1.1">0.0238<sup class="ltx_sup" id="S3.T1.30.26.26.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.30.26.26.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.30.26.26.11" style="padding-left:5.0pt;padding-right:5.0pt;">3.48%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.31.27.27">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.31.27.27.2" style="padding-left:5.0pt;padding-right:5.0pt;">MRR@10</th>
<td class="ltx_td ltx_align_center" id="S3.T1.31.27.27.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0114</td>
<td class="ltx_td ltx_align_center" id="S3.T1.31.27.27.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0115</td>
<td class="ltx_td ltx_align_center" id="S3.T1.31.27.27.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0121</td>
<td class="ltx_td ltx_align_center" id="S3.T1.31.27.27.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0117</td>
<td class="ltx_td ltx_align_center" id="S3.T1.31.27.27.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.0148</td>
<td class="ltx_td ltx_align_center" id="S3.T1.31.27.27.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.0129</td>
<td class="ltx_td ltx_align_center" id="S3.T1.31.27.27.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.0154</td>
<td class="ltx_td ltx_align_center" id="S3.T1.31.27.27.10" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.31.27.27.10.1">0.0159</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.31.27.27.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.31.27.27.1.1">0.0161<sup class="ltx_sup" id="S3.T1.31.27.27.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.31.27.27.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.31.27.27.11" style="padding-left:5.0pt;padding-right:5.0pt;">1.26%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.32.28.28">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.32.28.28.2" style="padding-left:5.0pt;padding-right:5.0pt;">HR@20</th>
<td class="ltx_td ltx_align_center" id="S3.T1.32.28.28.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0464</td>
<td class="ltx_td ltx_align_center" id="S3.T1.32.28.28.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0475</td>
<td class="ltx_td ltx_align_center" id="S3.T1.32.28.28.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0519</td>
<td class="ltx_td ltx_align_center" id="S3.T1.32.28.28.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0494</td>
<td class="ltx_td ltx_align_center" id="S3.T1.32.28.28.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.0691</td>
<td class="ltx_td ltx_align_center" id="S3.T1.32.28.28.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.0685</td>
<td class="ltx_td ltx_align_center" id="S3.T1.32.28.28.9" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.32.28.28.9.1">0.0696</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.32.28.28.10" style="padding-left:5.0pt;padding-right:5.0pt;">0.0671</td>
<td class="ltx_td ltx_align_center" id="S3.T1.32.28.28.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.32.28.28.1.1">0.0735<sup class="ltx_sup" id="S3.T1.32.28.28.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.32.28.28.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.32.28.28.11" style="padding-left:5.0pt;padding-right:5.0pt;">5.60%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.33.29.29">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.33.29.29.2" style="padding-left:5.0pt;padding-right:5.0pt;">NDCG@20</th>
<td class="ltx_td ltx_align_center" id="S3.T1.33.29.29.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0198</td>
<td class="ltx_td ltx_align_center" id="S3.T1.33.29.29.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0206</td>
<td class="ltx_td ltx_align_center" id="S3.T1.33.29.29.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0216</td>
<td class="ltx_td ltx_align_center" id="S3.T1.33.29.29.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0208</td>
<td class="ltx_td ltx_align_center" id="S3.T1.33.29.29.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.0282</td>
<td class="ltx_td ltx_align_center" id="S3.T1.33.29.29.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.0263</td>
<td class="ltx_td ltx_align_center" id="S3.T1.33.29.29.9" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.33.29.29.9.1">0.0285</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.33.29.29.10" style="padding-left:5.0pt;padding-right:5.0pt;">0.0283</td>
<td class="ltx_td ltx_align_center" id="S3.T1.33.29.29.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.33.29.29.1.1">0.0297<sup class="ltx_sup" id="S3.T1.33.29.29.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.33.29.29.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.33.29.29.11" style="padding-left:5.0pt;padding-right:5.0pt;">4.20%</td>
</tr>
<tr class="ltx_tr" id="S3.T1.34.30.30">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_bb" id="S3.T1.34.30.30.2" style="padding-left:5.0pt;padding-right:5.0pt;">MRR@20</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb" id="S3.T1.34.30.30.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0125</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb" id="S3.T1.34.30.30.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.0127</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb" id="S3.T1.34.30.30.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.0133</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb" id="S3.T1.34.30.30.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.0129</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb" id="S3.T1.34.30.30.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.0163</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb" id="S3.T1.34.30.30.8" style="padding-left:5.0pt;padding-right:5.0pt;">0.0143</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb" id="S3.T1.34.30.30.9" style="padding-left:5.0pt;padding-right:5.0pt;">0.0169</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb" id="S3.T1.34.30.30.10" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.34.30.30.10.1">0.0173</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb" id="S3.T1.34.30.30.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.34.30.30.1.1">0.0175<sup class="ltx_sup" id="S3.T1.34.30.30.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.34.30.30.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb" id="S3.T1.34.30.30.11" style="padding-left:5.0pt;padding-right:5.0pt;">1.16%</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Experimental Setup</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">Datasets.</span> We choose the following public datasets for experiments: <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.2">MovieLens-1M</span> <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">harper2015movielens</span>)</cite> is a widely-used dataset consisting of 1 million movie ratings.
<span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.3">Gowalla</span> <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">cho2011friendship</span>)</cite> contains location check-ins from users of the Gowalla location-based social network. <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.4">Steam</span> <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">kang2018self</span>)</cite> contains reviews from an online video game distribution platform.
<span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.5">Amazon-Beauty</span> and <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.6">Amazon-Sports</span>  <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">mcauley2015image</span>)</cite> contain product ratings and reviews for the Beauty and Sports categories from Amazon.
<span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.7">XLong</span> <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">ren2019lifelong</span>)</cite> is a dataset from the Alibaba e-commerce platform with long user behavior sequences. We sample 5000 users from the original XLong dataset and use the reduced dataset for assessing efficiency and scalability.
We create a user interaction sequence for each user by chronologically sorting their interaction behaviors based on timestamps. Following the approach adopted in previous studies <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">kang2018self</span>)</cite>, we exclude users and items with fewer than five recorded interactions. Table <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S4.T2" title="Table 2 ‣ 4.1. Experimental Setup ‣ 4. Experiments ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a> summarizes the statistics of the datasets after preprocessing.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2. </span>Statistics of the experimented datasets.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.24" style="width:173.4pt;height:73.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-61.3pt,26.1pt) scale(0.585880789804412,0.585880789804412) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.24.24">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.24.24.25.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T2.24.24.25.1.1" style="padding-left:5.5pt;padding-right:5.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.24.24.25.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.24.24.25.1.2" style="padding-left:5.5pt;padding-right:5.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.24.24.25.1.2.1"># Users</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.24.24.25.1.3" style="padding-left:5.5pt;padding-right:5.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.24.24.25.1.3.1"># Items</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.24.24.25.1.4" style="padding-left:5.5pt;padding-right:5.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.24.24.25.1.4.1"># Interactions</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.24.24.25.1.5" style="padding-left:5.5pt;padding-right:5.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.24.24.25.1.5.1">Avg. Length</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.4.4.4.5" style="padding-left:5.5pt;padding-right:5.5pt;">ML-1M</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="6,040" class="ltx_Math" display="inline" id="S4.T2.1.1.1.1.m1.2"><semantics id="S4.T2.1.1.1.1.m1.2a"><mrow id="S4.T2.1.1.1.1.m1.2.3.2" xref="S4.T2.1.1.1.1.m1.2.3.1.cmml"><mn id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml">6</mn><mo id="S4.T2.1.1.1.1.m1.2.3.2.1" xref="S4.T2.1.1.1.1.m1.2.3.1.cmml">,</mo><mn id="S4.T2.1.1.1.1.m1.2.2" xref="S4.T2.1.1.1.1.m1.2.2.cmml">040</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.2b"><list id="S4.T2.1.1.1.1.m1.2.3.1.cmml" xref="S4.T2.1.1.1.1.m1.2.3.2"><cn id="S4.T2.1.1.1.1.m1.1.1.cmml" type="integer" xref="S4.T2.1.1.1.1.m1.1.1">6</cn><cn id="S4.T2.1.1.1.1.m1.2.2.cmml" type="integer" xref="S4.T2.1.1.1.1.m1.2.2">040</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.2c">6,040</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.1.m1.2d">6 , 040</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.2.2.2" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="3,416" class="ltx_Math" display="inline" id="S4.T2.2.2.2.2.m1.2"><semantics id="S4.T2.2.2.2.2.m1.2a"><mrow id="S4.T2.2.2.2.2.m1.2.3.2" xref="S4.T2.2.2.2.2.m1.2.3.1.cmml"><mn id="S4.T2.2.2.2.2.m1.1.1" xref="S4.T2.2.2.2.2.m1.1.1.cmml">3</mn><mo id="S4.T2.2.2.2.2.m1.2.3.2.1" xref="S4.T2.2.2.2.2.m1.2.3.1.cmml">,</mo><mn id="S4.T2.2.2.2.2.m1.2.2" xref="S4.T2.2.2.2.2.m1.2.2.cmml">416</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.m1.2b"><list id="S4.T2.2.2.2.2.m1.2.3.1.cmml" xref="S4.T2.2.2.2.2.m1.2.3.2"><cn id="S4.T2.2.2.2.2.m1.1.1.cmml" type="integer" xref="S4.T2.2.2.2.2.m1.1.1">3</cn><cn id="S4.T2.2.2.2.2.m1.2.2.cmml" type="integer" xref="S4.T2.2.2.2.2.m1.2.2">416</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.m1.2c">3,416</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.2.2.m1.2d">3 , 416</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.3.3.3" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="999,611" class="ltx_Math" display="inline" id="S4.T2.3.3.3.3.m1.2"><semantics id="S4.T2.3.3.3.3.m1.2a"><mrow id="S4.T2.3.3.3.3.m1.2.3.2" xref="S4.T2.3.3.3.3.m1.2.3.1.cmml"><mn id="S4.T2.3.3.3.3.m1.1.1" xref="S4.T2.3.3.3.3.m1.1.1.cmml">999</mn><mo id="S4.T2.3.3.3.3.m1.2.3.2.1" xref="S4.T2.3.3.3.3.m1.2.3.1.cmml">,</mo><mn id="S4.T2.3.3.3.3.m1.2.2" xref="S4.T2.3.3.3.3.m1.2.2.cmml">611</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.3.m1.2b"><list id="S4.T2.3.3.3.3.m1.2.3.1.cmml" xref="S4.T2.3.3.3.3.m1.2.3.2"><cn id="S4.T2.3.3.3.3.m1.1.1.cmml" type="integer" xref="S4.T2.3.3.3.3.m1.1.1">999</cn><cn id="S4.T2.3.3.3.3.m1.2.2.cmml" type="integer" xref="S4.T2.3.3.3.3.m1.2.2">611</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.3.m1.2c">999,611</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.3.3.3.m1.2d">999 , 611</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.4.4.4" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="165.5" class="ltx_Math" display="inline" id="S4.T2.4.4.4.4.m1.1"><semantics id="S4.T2.4.4.4.4.m1.1a"><mn id="S4.T2.4.4.4.4.m1.1.1" xref="S4.T2.4.4.4.4.m1.1.1.cmml">165.5</mn><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.4.m1.1b"><cn id="S4.T2.4.4.4.4.m1.1.1.cmml" type="float" xref="S4.T2.4.4.4.4.m1.1.1">165.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.4.m1.1c">165.5</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.4.4.4.m1.1d">165.5</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T2.8.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.8.8.8.5" style="padding-left:5.5pt;padding-right:5.5pt;">Gowalla</th>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.5.1" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="64,115" class="ltx_Math" display="inline" id="S4.T2.5.5.5.1.m1.2"><semantics id="S4.T2.5.5.5.1.m1.2a"><mrow id="S4.T2.5.5.5.1.m1.2.3.2" xref="S4.T2.5.5.5.1.m1.2.3.1.cmml"><mn id="S4.T2.5.5.5.1.m1.1.1" xref="S4.T2.5.5.5.1.m1.1.1.cmml">64</mn><mo id="S4.T2.5.5.5.1.m1.2.3.2.1" xref="S4.T2.5.5.5.1.m1.2.3.1.cmml">,</mo><mn id="S4.T2.5.5.5.1.m1.2.2" xref="S4.T2.5.5.5.1.m1.2.2.cmml">115</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.1.m1.2b"><list id="S4.T2.5.5.5.1.m1.2.3.1.cmml" xref="S4.T2.5.5.5.1.m1.2.3.2"><cn id="S4.T2.5.5.5.1.m1.1.1.cmml" type="integer" xref="S4.T2.5.5.5.1.m1.1.1">64</cn><cn id="S4.T2.5.5.5.1.m1.2.2.cmml" type="integer" xref="S4.T2.5.5.5.1.m1.2.2">115</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.1.m1.2c">64,115</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.5.5.1.m1.2d">64 , 115</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.6.2" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="164,533" class="ltx_Math" display="inline" id="S4.T2.6.6.6.2.m1.2"><semantics id="S4.T2.6.6.6.2.m1.2a"><mrow id="S4.T2.6.6.6.2.m1.2.3.2" xref="S4.T2.6.6.6.2.m1.2.3.1.cmml"><mn id="S4.T2.6.6.6.2.m1.1.1" xref="S4.T2.6.6.6.2.m1.1.1.cmml">164</mn><mo id="S4.T2.6.6.6.2.m1.2.3.2.1" xref="S4.T2.6.6.6.2.m1.2.3.1.cmml">,</mo><mn id="S4.T2.6.6.6.2.m1.2.2" xref="S4.T2.6.6.6.2.m1.2.2.cmml">533</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.6.2.m1.2b"><list id="S4.T2.6.6.6.2.m1.2.3.1.cmml" xref="S4.T2.6.6.6.2.m1.2.3.2"><cn id="S4.T2.6.6.6.2.m1.1.1.cmml" type="integer" xref="S4.T2.6.6.6.2.m1.1.1">164</cn><cn id="S4.T2.6.6.6.2.m1.2.2.cmml" type="integer" xref="S4.T2.6.6.6.2.m1.2.2">533</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.6.2.m1.2c">164,533</annotation><annotation encoding="application/x-llamapun" id="S4.T2.6.6.6.2.m1.2d">164 , 533</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.7.7.3" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="2,018,421" class="ltx_Math" display="inline" id="S4.T2.7.7.7.3.m1.3"><semantics id="S4.T2.7.7.7.3.m1.3a"><mrow id="S4.T2.7.7.7.3.m1.3.4.2" xref="S4.T2.7.7.7.3.m1.3.4.1.cmml"><mn id="S4.T2.7.7.7.3.m1.1.1" xref="S4.T2.7.7.7.3.m1.1.1.cmml">2</mn><mo id="S4.T2.7.7.7.3.m1.3.4.2.1" xref="S4.T2.7.7.7.3.m1.3.4.1.cmml">,</mo><mn id="S4.T2.7.7.7.3.m1.2.2" xref="S4.T2.7.7.7.3.m1.2.2.cmml">018</mn><mo id="S4.T2.7.7.7.3.m1.3.4.2.2" xref="S4.T2.7.7.7.3.m1.3.4.1.cmml">,</mo><mn id="S4.T2.7.7.7.3.m1.3.3" xref="S4.T2.7.7.7.3.m1.3.3.cmml">421</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.7.7.7.3.m1.3b"><list id="S4.T2.7.7.7.3.m1.3.4.1.cmml" xref="S4.T2.7.7.7.3.m1.3.4.2"><cn id="S4.T2.7.7.7.3.m1.1.1.cmml" type="integer" xref="S4.T2.7.7.7.3.m1.1.1">2</cn><cn id="S4.T2.7.7.7.3.m1.2.2.cmml" type="integer" xref="S4.T2.7.7.7.3.m1.2.2">018</cn><cn id="S4.T2.7.7.7.3.m1.3.3.cmml" type="integer" xref="S4.T2.7.7.7.3.m1.3.3">421</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.7.7.3.m1.3c">2,018,421</annotation><annotation encoding="application/x-llamapun" id="S4.T2.7.7.7.3.m1.3d">2 , 018 , 421</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.8.8.4" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="31.5" class="ltx_Math" display="inline" id="S4.T2.8.8.8.4.m1.1"><semantics id="S4.T2.8.8.8.4.m1.1a"><mn id="S4.T2.8.8.8.4.m1.1.1" xref="S4.T2.8.8.8.4.m1.1.1.cmml">31.5</mn><annotation-xml encoding="MathML-Content" id="S4.T2.8.8.8.4.m1.1b"><cn id="S4.T2.8.8.8.4.m1.1.1.cmml" type="float" xref="S4.T2.8.8.8.4.m1.1.1">31.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.8.8.4.m1.1c">31.5</annotation><annotation encoding="application/x-llamapun" id="S4.T2.8.8.8.4.m1.1d">31.5</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.12.12.12.5" style="padding-left:5.5pt;padding-right:5.5pt;">Steam</th>
<td class="ltx_td ltx_align_center" id="S4.T2.9.9.9.1" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="25,389" class="ltx_Math" display="inline" id="S4.T2.9.9.9.1.m1.2"><semantics id="S4.T2.9.9.9.1.m1.2a"><mrow id="S4.T2.9.9.9.1.m1.2.3.2" xref="S4.T2.9.9.9.1.m1.2.3.1.cmml"><mn id="S4.T2.9.9.9.1.m1.1.1" xref="S4.T2.9.9.9.1.m1.1.1.cmml">25</mn><mo id="S4.T2.9.9.9.1.m1.2.3.2.1" xref="S4.T2.9.9.9.1.m1.2.3.1.cmml">,</mo><mn id="S4.T2.9.9.9.1.m1.2.2" xref="S4.T2.9.9.9.1.m1.2.2.cmml">389</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.9.9.9.1.m1.2b"><list id="S4.T2.9.9.9.1.m1.2.3.1.cmml" xref="S4.T2.9.9.9.1.m1.2.3.2"><cn id="S4.T2.9.9.9.1.m1.1.1.cmml" type="integer" xref="S4.T2.9.9.9.1.m1.1.1">25</cn><cn id="S4.T2.9.9.9.1.m1.2.2.cmml" type="integer" xref="S4.T2.9.9.9.1.m1.2.2">389</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.9.9.1.m1.2c">25,389</annotation><annotation encoding="application/x-llamapun" id="S4.T2.9.9.9.1.m1.2d">25 , 389</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.10.10.10.2" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="4,090" class="ltx_Math" display="inline" id="S4.T2.10.10.10.2.m1.2"><semantics id="S4.T2.10.10.10.2.m1.2a"><mrow id="S4.T2.10.10.10.2.m1.2.3.2" xref="S4.T2.10.10.10.2.m1.2.3.1.cmml"><mn id="S4.T2.10.10.10.2.m1.1.1" xref="S4.T2.10.10.10.2.m1.1.1.cmml">4</mn><mo id="S4.T2.10.10.10.2.m1.2.3.2.1" xref="S4.T2.10.10.10.2.m1.2.3.1.cmml">,</mo><mn id="S4.T2.10.10.10.2.m1.2.2" xref="S4.T2.10.10.10.2.m1.2.2.cmml">090</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.10.10.10.2.m1.2b"><list id="S4.T2.10.10.10.2.m1.2.3.1.cmml" xref="S4.T2.10.10.10.2.m1.2.3.2"><cn id="S4.T2.10.10.10.2.m1.1.1.cmml" type="integer" xref="S4.T2.10.10.10.2.m1.1.1">4</cn><cn id="S4.T2.10.10.10.2.m1.2.2.cmml" type="integer" xref="S4.T2.10.10.10.2.m1.2.2">090</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.10.10.2.m1.2c">4,090</annotation><annotation encoding="application/x-llamapun" id="S4.T2.10.10.10.2.m1.2d">4 , 090</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.11.11.11.3" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="328,378" class="ltx_Math" display="inline" id="S4.T2.11.11.11.3.m1.2"><semantics id="S4.T2.11.11.11.3.m1.2a"><mrow id="S4.T2.11.11.11.3.m1.2.3.2" xref="S4.T2.11.11.11.3.m1.2.3.1.cmml"><mn id="S4.T2.11.11.11.3.m1.1.1" xref="S4.T2.11.11.11.3.m1.1.1.cmml">328</mn><mo id="S4.T2.11.11.11.3.m1.2.3.2.1" xref="S4.T2.11.11.11.3.m1.2.3.1.cmml">,</mo><mn id="S4.T2.11.11.11.3.m1.2.2" xref="S4.T2.11.11.11.3.m1.2.2.cmml">378</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.11.11.11.3.m1.2b"><list id="S4.T2.11.11.11.3.m1.2.3.1.cmml" xref="S4.T2.11.11.11.3.m1.2.3.2"><cn id="S4.T2.11.11.11.3.m1.1.1.cmml" type="integer" xref="S4.T2.11.11.11.3.m1.1.1">328</cn><cn id="S4.T2.11.11.11.3.m1.2.2.cmml" type="integer" xref="S4.T2.11.11.11.3.m1.2.2">378</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.11.11.3.m1.2c">328,378</annotation><annotation encoding="application/x-llamapun" id="S4.T2.11.11.11.3.m1.2d">328 , 378</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.4" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="12.9" class="ltx_Math" display="inline" id="S4.T2.12.12.12.4.m1.1"><semantics id="S4.T2.12.12.12.4.m1.1a"><mn id="S4.T2.12.12.12.4.m1.1.1" xref="S4.T2.12.12.12.4.m1.1.1.cmml">12.9</mn><annotation-xml encoding="MathML-Content" id="S4.T2.12.12.12.4.m1.1b"><cn id="S4.T2.12.12.12.4.m1.1.1.cmml" type="float" xref="S4.T2.12.12.12.4.m1.1.1">12.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.12.12.4.m1.1c">12.9</annotation><annotation encoding="application/x-llamapun" id="S4.T2.12.12.12.4.m1.1d">12.9</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T2.16.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.16.16.16.5" style="padding-left:5.5pt;padding-right:5.5pt;">Beauty</th>
<td class="ltx_td ltx_align_center" id="S4.T2.13.13.13.1" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="22,363" class="ltx_Math" display="inline" id="S4.T2.13.13.13.1.m1.2"><semantics id="S4.T2.13.13.13.1.m1.2a"><mrow id="S4.T2.13.13.13.1.m1.2.3.2" xref="S4.T2.13.13.13.1.m1.2.3.1.cmml"><mn id="S4.T2.13.13.13.1.m1.1.1" xref="S4.T2.13.13.13.1.m1.1.1.cmml">22</mn><mo id="S4.T2.13.13.13.1.m1.2.3.2.1" xref="S4.T2.13.13.13.1.m1.2.3.1.cmml">,</mo><mn id="S4.T2.13.13.13.1.m1.2.2" xref="S4.T2.13.13.13.1.m1.2.2.cmml">363</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.13.13.13.1.m1.2b"><list id="S4.T2.13.13.13.1.m1.2.3.1.cmml" xref="S4.T2.13.13.13.1.m1.2.3.2"><cn id="S4.T2.13.13.13.1.m1.1.1.cmml" type="integer" xref="S4.T2.13.13.13.1.m1.1.1">22</cn><cn id="S4.T2.13.13.13.1.m1.2.2.cmml" type="integer" xref="S4.T2.13.13.13.1.m1.2.2">363</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.13.13.1.m1.2c">22,363</annotation><annotation encoding="application/x-llamapun" id="S4.T2.13.13.13.1.m1.2d">22 , 363</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.14.14.14.2" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="12,101" class="ltx_Math" display="inline" id="S4.T2.14.14.14.2.m1.2"><semantics id="S4.T2.14.14.14.2.m1.2a"><mrow id="S4.T2.14.14.14.2.m1.2.3.2" xref="S4.T2.14.14.14.2.m1.2.3.1.cmml"><mn id="S4.T2.14.14.14.2.m1.1.1" xref="S4.T2.14.14.14.2.m1.1.1.cmml">12</mn><mo id="S4.T2.14.14.14.2.m1.2.3.2.1" xref="S4.T2.14.14.14.2.m1.2.3.1.cmml">,</mo><mn id="S4.T2.14.14.14.2.m1.2.2" xref="S4.T2.14.14.14.2.m1.2.2.cmml">101</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.14.14.14.2.m1.2b"><list id="S4.T2.14.14.14.2.m1.2.3.1.cmml" xref="S4.T2.14.14.14.2.m1.2.3.2"><cn id="S4.T2.14.14.14.2.m1.1.1.cmml" type="integer" xref="S4.T2.14.14.14.2.m1.1.1">12</cn><cn id="S4.T2.14.14.14.2.m1.2.2.cmml" type="integer" xref="S4.T2.14.14.14.2.m1.2.2">101</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.14.14.14.2.m1.2c">12,101</annotation><annotation encoding="application/x-llamapun" id="S4.T2.14.14.14.2.m1.2d">12 , 101</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.15.15.15.3" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="198,502" class="ltx_Math" display="inline" id="S4.T2.15.15.15.3.m1.2"><semantics id="S4.T2.15.15.15.3.m1.2a"><mrow id="S4.T2.15.15.15.3.m1.2.3.2" xref="S4.T2.15.15.15.3.m1.2.3.1.cmml"><mn id="S4.T2.15.15.15.3.m1.1.1" xref="S4.T2.15.15.15.3.m1.1.1.cmml">198</mn><mo id="S4.T2.15.15.15.3.m1.2.3.2.1" xref="S4.T2.15.15.15.3.m1.2.3.1.cmml">,</mo><mn id="S4.T2.15.15.15.3.m1.2.2" xref="S4.T2.15.15.15.3.m1.2.2.cmml">502</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.15.15.15.3.m1.2b"><list id="S4.T2.15.15.15.3.m1.2.3.1.cmml" xref="S4.T2.15.15.15.3.m1.2.3.2"><cn id="S4.T2.15.15.15.3.m1.1.1.cmml" type="integer" xref="S4.T2.15.15.15.3.m1.1.1">198</cn><cn id="S4.T2.15.15.15.3.m1.2.2.cmml" type="integer" xref="S4.T2.15.15.15.3.m1.2.2">502</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.15.15.15.3.m1.2c">198,502</annotation><annotation encoding="application/x-llamapun" id="S4.T2.15.15.15.3.m1.2d">198 , 502</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.16.16.16.4" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="8.9" class="ltx_Math" display="inline" id="S4.T2.16.16.16.4.m1.1"><semantics id="S4.T2.16.16.16.4.m1.1a"><mn id="S4.T2.16.16.16.4.m1.1.1" xref="S4.T2.16.16.16.4.m1.1.1.cmml">8.9</mn><annotation-xml encoding="MathML-Content" id="S4.T2.16.16.16.4.m1.1b"><cn id="S4.T2.16.16.16.4.m1.1.1.cmml" type="float" xref="S4.T2.16.16.16.4.m1.1.1">8.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.16.16.16.4.m1.1c">8.9</annotation><annotation encoding="application/x-llamapun" id="S4.T2.16.16.16.4.m1.1d">8.9</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T2.20.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.20.20.20.5" style="padding-left:5.5pt;padding-right:5.5pt;">Sports</th>
<td class="ltx_td ltx_align_center" id="S4.T2.17.17.17.1" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="35,598" class="ltx_Math" display="inline" id="S4.T2.17.17.17.1.m1.2"><semantics id="S4.T2.17.17.17.1.m1.2a"><mrow id="S4.T2.17.17.17.1.m1.2.3.2" xref="S4.T2.17.17.17.1.m1.2.3.1.cmml"><mn id="S4.T2.17.17.17.1.m1.1.1" xref="S4.T2.17.17.17.1.m1.1.1.cmml">35</mn><mo id="S4.T2.17.17.17.1.m1.2.3.2.1" xref="S4.T2.17.17.17.1.m1.2.3.1.cmml">,</mo><mn id="S4.T2.17.17.17.1.m1.2.2" xref="S4.T2.17.17.17.1.m1.2.2.cmml">598</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.17.17.17.1.m1.2b"><list id="S4.T2.17.17.17.1.m1.2.3.1.cmml" xref="S4.T2.17.17.17.1.m1.2.3.2"><cn id="S4.T2.17.17.17.1.m1.1.1.cmml" type="integer" xref="S4.T2.17.17.17.1.m1.1.1">35</cn><cn id="S4.T2.17.17.17.1.m1.2.2.cmml" type="integer" xref="S4.T2.17.17.17.1.m1.2.2">598</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.17.17.17.1.m1.2c">35,598</annotation><annotation encoding="application/x-llamapun" id="S4.T2.17.17.17.1.m1.2d">35 , 598</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.18.18.18.2" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="18,357" class="ltx_Math" display="inline" id="S4.T2.18.18.18.2.m1.2"><semantics id="S4.T2.18.18.18.2.m1.2a"><mrow id="S4.T2.18.18.18.2.m1.2.3.2" xref="S4.T2.18.18.18.2.m1.2.3.1.cmml"><mn id="S4.T2.18.18.18.2.m1.1.1" xref="S4.T2.18.18.18.2.m1.1.1.cmml">18</mn><mo id="S4.T2.18.18.18.2.m1.2.3.2.1" xref="S4.T2.18.18.18.2.m1.2.3.1.cmml">,</mo><mn id="S4.T2.18.18.18.2.m1.2.2" xref="S4.T2.18.18.18.2.m1.2.2.cmml">357</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.18.18.18.2.m1.2b"><list id="S4.T2.18.18.18.2.m1.2.3.1.cmml" xref="S4.T2.18.18.18.2.m1.2.3.2"><cn id="S4.T2.18.18.18.2.m1.1.1.cmml" type="integer" xref="S4.T2.18.18.18.2.m1.1.1">18</cn><cn id="S4.T2.18.18.18.2.m1.2.2.cmml" type="integer" xref="S4.T2.18.18.18.2.m1.2.2">357</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.18.18.18.2.m1.2c">18,357</annotation><annotation encoding="application/x-llamapun" id="S4.T2.18.18.18.2.m1.2d">18 , 357</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.19.19.19.3" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="296,337" class="ltx_Math" display="inline" id="S4.T2.19.19.19.3.m1.2"><semantics id="S4.T2.19.19.19.3.m1.2a"><mrow id="S4.T2.19.19.19.3.m1.2.3.2" xref="S4.T2.19.19.19.3.m1.2.3.1.cmml"><mn id="S4.T2.19.19.19.3.m1.1.1" xref="S4.T2.19.19.19.3.m1.1.1.cmml">296</mn><mo id="S4.T2.19.19.19.3.m1.2.3.2.1" xref="S4.T2.19.19.19.3.m1.2.3.1.cmml">,</mo><mn id="S4.T2.19.19.19.3.m1.2.2" xref="S4.T2.19.19.19.3.m1.2.2.cmml">337</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.19.19.19.3.m1.2b"><list id="S4.T2.19.19.19.3.m1.2.3.1.cmml" xref="S4.T2.19.19.19.3.m1.2.3.2"><cn id="S4.T2.19.19.19.3.m1.1.1.cmml" type="integer" xref="S4.T2.19.19.19.3.m1.1.1">296</cn><cn id="S4.T2.19.19.19.3.m1.2.2.cmml" type="integer" xref="S4.T2.19.19.19.3.m1.2.2">337</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.19.19.19.3.m1.2c">296,337</annotation><annotation encoding="application/x-llamapun" id="S4.T2.19.19.19.3.m1.2d">296 , 337</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.20.20.4" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="8.3" class="ltx_Math" display="inline" id="S4.T2.20.20.20.4.m1.1"><semantics id="S4.T2.20.20.20.4.m1.1a"><mn id="S4.T2.20.20.20.4.m1.1.1" xref="S4.T2.20.20.20.4.m1.1.1.cmml">8.3</mn><annotation-xml encoding="MathML-Content" id="S4.T2.20.20.20.4.m1.1b"><cn id="S4.T2.20.20.20.4.m1.1.1.cmml" type="float" xref="S4.T2.20.20.20.4.m1.1.1">8.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.20.20.20.4.m1.1c">8.3</annotation><annotation encoding="application/x-llamapun" id="S4.T2.20.20.20.4.m1.1d">8.3</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T2.24.24.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T2.24.24.24.5" style="padding-left:5.5pt;padding-right:5.5pt;">XLong</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.21.21.21.1" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="5,000" class="ltx_Math" display="inline" id="S4.T2.21.21.21.1.m1.2"><semantics id="S4.T2.21.21.21.1.m1.2a"><mrow id="S4.T2.21.21.21.1.m1.2.3.2" xref="S4.T2.21.21.21.1.m1.2.3.1.cmml"><mn id="S4.T2.21.21.21.1.m1.1.1" xref="S4.T2.21.21.21.1.m1.1.1.cmml">5</mn><mo id="S4.T2.21.21.21.1.m1.2.3.2.1" xref="S4.T2.21.21.21.1.m1.2.3.1.cmml">,</mo><mn id="S4.T2.21.21.21.1.m1.2.2" xref="S4.T2.21.21.21.1.m1.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.21.21.21.1.m1.2b"><list id="S4.T2.21.21.21.1.m1.2.3.1.cmml" xref="S4.T2.21.21.21.1.m1.2.3.2"><cn id="S4.T2.21.21.21.1.m1.1.1.cmml" type="integer" xref="S4.T2.21.21.21.1.m1.1.1">5</cn><cn id="S4.T2.21.21.21.1.m1.2.2.cmml" type="integer" xref="S4.T2.21.21.21.1.m1.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.21.21.21.1.m1.2c">5,000</annotation><annotation encoding="application/x-llamapun" id="S4.T2.21.21.21.1.m1.2d">5 , 000</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.22.22.22.2" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="329,722" class="ltx_Math" display="inline" id="S4.T2.22.22.22.2.m1.2"><semantics id="S4.T2.22.22.22.2.m1.2a"><mrow id="S4.T2.22.22.22.2.m1.2.3.2" xref="S4.T2.22.22.22.2.m1.2.3.1.cmml"><mn id="S4.T2.22.22.22.2.m1.1.1" xref="S4.T2.22.22.22.2.m1.1.1.cmml">329</mn><mo id="S4.T2.22.22.22.2.m1.2.3.2.1" xref="S4.T2.22.22.22.2.m1.2.3.1.cmml">,</mo><mn id="S4.T2.22.22.22.2.m1.2.2" xref="S4.T2.22.22.22.2.m1.2.2.cmml">722</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.22.22.22.2.m1.2b"><list id="S4.T2.22.22.22.2.m1.2.3.1.cmml" xref="S4.T2.22.22.22.2.m1.2.3.2"><cn id="S4.T2.22.22.22.2.m1.1.1.cmml" type="integer" xref="S4.T2.22.22.22.2.m1.1.1">329</cn><cn id="S4.T2.22.22.22.2.m1.2.2.cmml" type="integer" xref="S4.T2.22.22.22.2.m1.2.2">722</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.22.22.22.2.m1.2c">329,722</annotation><annotation encoding="application/x-llamapun" id="S4.T2.22.22.22.2.m1.2d">329 , 722</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.23.23.23.3" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="66,822,348" class="ltx_Math" display="inline" id="S4.T2.23.23.23.3.m1.3"><semantics id="S4.T2.23.23.23.3.m1.3a"><mrow id="S4.T2.23.23.23.3.m1.3.4.2" xref="S4.T2.23.23.23.3.m1.3.4.1.cmml"><mn id="S4.T2.23.23.23.3.m1.1.1" xref="S4.T2.23.23.23.3.m1.1.1.cmml">66</mn><mo id="S4.T2.23.23.23.3.m1.3.4.2.1" xref="S4.T2.23.23.23.3.m1.3.4.1.cmml">,</mo><mn id="S4.T2.23.23.23.3.m1.2.2" xref="S4.T2.23.23.23.3.m1.2.2.cmml">822</mn><mo id="S4.T2.23.23.23.3.m1.3.4.2.2" xref="S4.T2.23.23.23.3.m1.3.4.1.cmml">,</mo><mn id="S4.T2.23.23.23.3.m1.3.3" xref="S4.T2.23.23.23.3.m1.3.3.cmml">348</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.23.23.23.3.m1.3b"><list id="S4.T2.23.23.23.3.m1.3.4.1.cmml" xref="S4.T2.23.23.23.3.m1.3.4.2"><cn id="S4.T2.23.23.23.3.m1.1.1.cmml" type="integer" xref="S4.T2.23.23.23.3.m1.1.1">66</cn><cn id="S4.T2.23.23.23.3.m1.2.2.cmml" type="integer" xref="S4.T2.23.23.23.3.m1.2.2">822</cn><cn id="S4.T2.23.23.23.3.m1.3.3.cmml" type="integer" xref="S4.T2.23.23.23.3.m1.3.3">348</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.23.23.23.3.m1.3c">66,822,348</annotation><annotation encoding="application/x-llamapun" id="S4.T2.23.23.23.3.m1.3d">66 , 822 , 348</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.24.24.24.4" style="padding-left:5.5pt;padding-right:5.5pt;"><math alttext="785.9" class="ltx_Math" display="inline" id="S4.T2.24.24.24.4.m1.1"><semantics id="S4.T2.24.24.24.4.m1.1a"><mn id="S4.T2.24.24.24.4.m1.1.1" xref="S4.T2.24.24.24.4.m1.1.1.cmml">785.9</mn><annotation-xml encoding="MathML-Content" id="S4.T2.24.24.24.4.m1.1b"><cn id="S4.T2.24.24.24.4.m1.1.1.cmml" type="float" xref="S4.T2.24.24.24.4.m1.1.1">785.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.24.24.24.4.m1.1c">785.9</annotation><annotation encoding="application/x-llamapun" id="S4.T2.24.24.24.4.m1.1d">785.9</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">Baselines.</span> <span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.2">FPMC</span> <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">rendle2010factorizing</span>)</cite> combines Markov chains and matrix factorization for next-item prediction.
<span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.3">Caser</span> <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">tang2018personalized</span>)</cite> employs horizontal and vertical convolutions to learn user preferences.
<span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.4">GRU4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">hidasi2015session</span>)</cite> utilizes Gated Recurrent Units <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">chung2014empirical</span>)</cite> to model user interactions and predict the next-item.
<span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.5">NARM</span> <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">li2017neural</span>)</cite> is an RNN-based model with the attention mechanism using local and global encoders.
<span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.6">SASRec</span> <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">kang2018self</span>)</cite> is a unidirectional Transformer-based model leveraging self-attention to adaptively capture user preferences from their behavior sequences.
<span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.7">BERT4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">sun2019bert4rec</span>)</cite> uses bidirectional Transformer encoders to model user behavior sequences.
<span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.8">FMLP-Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">zhou2022filter</span>)</cite> is based on multilayer perceptron with learnable filters using Fast Fourier Transform.
<span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.9">LRURec</span> <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">yue2024linear</span>)</cite> is an RNN-based recommendation model with complex-valued Linear Recurrent Units <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">orvieto2023resurrecting</span>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.7"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.7.1">Evaluation Metrics.</span>
We employ three common metrics: Hit Ratio (HR), Normalized Discounted Cumulative Gain (NDCG), and Mean Reciprocal Rank (MRR). For each metric, we consider the top-<math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mi id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">italic_K</annotation></semantics></math> recommendation with a cutoff at <math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><mi id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><ci id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">italic_K</annotation></semantics></math>, denoted as HR@<math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.1"><semantics id="S4.SS1.p3.3.m3.1a"><mi id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><ci id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m3.1d">italic_K</annotation></semantics></math>, NDCG@<math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p3.4.m4.1"><semantics id="S4.SS1.p3.4.m4.1a"><mi id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><ci id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.4.m4.1d">italic_K</annotation></semantics></math>, and MRR@<math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p3.5.m5.1"><semantics id="S4.SS1.p3.5.m5.1a"><mi id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><ci id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.5.m5.1d">italic_K</annotation></semantics></math>. We evaluate these metrics at <math alttext="K=10" class="ltx_Math" display="inline" id="S4.SS1.p3.6.m6.1"><semantics id="S4.SS1.p3.6.m6.1a"><mrow id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml"><mi id="S4.SS1.p3.6.m6.1.1.2" xref="S4.SS1.p3.6.m6.1.1.2.cmml">K</mi><mo id="S4.SS1.p3.6.m6.1.1.1" xref="S4.SS1.p3.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS1.p3.6.m6.1.1.3" xref="S4.SS1.p3.6.m6.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.1b"><apply id="S4.SS1.p3.6.m6.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1"><eq id="S4.SS1.p3.6.m6.1.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1.1"></eq><ci id="S4.SS1.p3.6.m6.1.1.2.cmml" xref="S4.SS1.p3.6.m6.1.1.2">𝐾</ci><cn id="S4.SS1.p3.6.m6.1.1.3.cmml" type="integer" xref="S4.SS1.p3.6.m6.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.1c">K=10</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.6.m6.1d">italic_K = 10</annotation></semantics></math> and <math alttext="K=20" class="ltx_Math" display="inline" id="S4.SS1.p3.7.m7.1"><semantics id="S4.SS1.p3.7.m7.1a"><mrow id="S4.SS1.p3.7.m7.1.1" xref="S4.SS1.p3.7.m7.1.1.cmml"><mi id="S4.SS1.p3.7.m7.1.1.2" xref="S4.SS1.p3.7.m7.1.1.2.cmml">K</mi><mo id="S4.SS1.p3.7.m7.1.1.1" xref="S4.SS1.p3.7.m7.1.1.1.cmml">=</mo><mn id="S4.SS1.p3.7.m7.1.1.3" xref="S4.SS1.p3.7.m7.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.7.m7.1b"><apply id="S4.SS1.p3.7.m7.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1"><eq id="S4.SS1.p3.7.m7.1.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1.1"></eq><ci id="S4.SS1.p3.7.m7.1.1.2.cmml" xref="S4.SS1.p3.7.m7.1.1.2">𝐾</ci><cn id="S4.SS1.p3.7.m7.1.1.3.cmml" type="integer" xref="S4.SS1.p3.7.m7.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.7.m7.1c">K=20</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.7.m7.1d">italic_K = 20</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p4.1.1">Implementation Details.</span>
Our default model architecture utilizes two behavior modeling layers. We adopt Adam optimizer <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">kingma2014adam</span>)</cite> with a learning rate of 0.001. A batch size of 2048 is used for training, and 4096 for evaluation. For the XLong dataset specifically, we use a smaller batch size of 512 for training and 1024 for evaluation. Training stops early if validation NDCG@10 fails to improve for 10 consecutive epochs. All models leverage an embedding dimension of 64. The maximum sequence length is set based on the average user interaction length: 1000 for XLong, 200 for MovieLens-1M, 100 for Gowalla, and 50 for other datasets. We refer to a commonly used recommendation library RecBole <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">zhao2021recbole</span>)</cite> for further implementation details and baseline comparisons.
Our code is available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/chengkai-liu/RecBLR" title="">https://github.com/chengkai-liu/RecBLR</a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Overall Performance</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S3.T1" title="Table 1 ‣ 3.3. Hardware-Aware Parallel Scan ‣ 3. Methodology ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> presents the overall performance of RecBLR compared to eight baselines on five datasets. According to the experimental results, Transformer-based models, i.e., SASRec and BERT4Rec, demonstrate superior performance compared to CNN-based Caser and traditional RNN-based NARM and GRU4Rec. FMLP-Rec achieves competitive results on smaller, sparser datasets like Amazon-Beauty, and Amazon-Sports, but remains generally weaker than Transformer-based models and LRURec. Since the linear recurrent unit (LRU) is an improved RNN variant, LRU-based LRURec and RecBLR have significantly better performance than traditional RNN-based models and achieve competitive results with Transformer models. The experimental results also reveal several key insights for our RecBLR:</p>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1">RecBLR outperforms all baselines for all metrics and datasets. This demonstrates that our design significantly improves recommendation accuracy for users, regardless of the data platform.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1">The improvements are more pronounced on larger datasets with richer user-item interactions and more extensive user behavior histories. For instance, the MovieLens-1M dataset, which has dense interactions and relatively long interaction sequences, exhibits the most significant performance gains. In contrast, performance gains are more modest for sparser datasets with shorter sequences, such as Steam and Amazon-sports datasets.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1">The improvements in the metrics of NDCG and MRR are typically greater than those in HR. This is because NDCG and MRR are rank-aware metrics, while HR is not. Consequently, RecBLR excels in ranking, leading to more precise recommendations where users’ preferred items appear at higher rankings.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3. </span>Performance comparison of the variants of RecBLR.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T3.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T3.1.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.1.1">Variants</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.1.1.1.2" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.2.1">Metric</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.3.1">ML-1M</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.4.1">Gowalla</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.5.1">Steam</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.1.1.1.6"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.6.1">Amazon-Beauty</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.1.1.1.7"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.7.1">Amazon-Sports</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.2.1">HR / NDCG</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.2.2">HR / NDCG</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.2.3">HR / NDCG</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.2.4">HR / NDCG</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.2.5">HR / NDCG</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.1.3.3.1" rowspan="2"><span class="ltx_text" id="S4.T3.1.3.3.1.1">Default</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.3.3.2">@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.3.3.3">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.3.3.3.1">0.3285</span> / <span class="ltx_text ltx_font_bold" id="S4.T3.1.3.3.3.2">0.1901</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.3.3.4">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.3.3.4.1">0.1248</span> / <span class="ltx_text ltx_font_bold" id="S4.T3.1.3.3.4.2">0.0601</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.3.3.5">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.3.3.5.1">0.1421</span> / <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.3.3.5.2">0.0745</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.3.3.6">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.3.3.6.1">0.0881</span> / <span class="ltx_text ltx_font_bold" id="S4.T3.1.3.3.6.2">0.0446</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.3.3.7">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.3.3.7.1">0.0500</span> / <span class="ltx_text ltx_font_bold" id="S4.T3.1.3.3.7.2">0.0238</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.4.4">
<td class="ltx_td ltx_align_center" id="S4.T3.1.4.4.1">@20</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.4.4.2">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.4.4.2.1">0.4336</span> / <span class="ltx_text ltx_font_bold" id="S4.T3.1.4.4.2.2">0.2161</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.4.4.3">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.4.4.3.1">0.1837</span> / <span class="ltx_text ltx_font_bold" id="S4.T3.1.4.4.3.2">0.0751</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.4.4.4">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.4.4.4.1">0.2116</span> / <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.4.4.4.2">0.0923</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.4.4.5">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.4.4.5.1">0.1243</span> / <span class="ltx_text ltx_font_bold" id="S4.T3.1.4.4.5.2">0.0538</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.4.4.6">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.4.4.6.1">0.0735</span> / <span class="ltx_text ltx_font_bold" id="S4.T3.1.4.4.6.2">0.0297</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.1.5.5.1" rowspan="2"><span class="ltx_text" id="S4.T3.1.5.5.1.1">Single Recurrent Layer</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.5.5.2">@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.5.5.3">0.3127 / 0.1802</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.5.5.4">0.1240 / 0.0585</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.5.5.5">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.5.5.5.1">0.1434</span> / 0.0741</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.5.5.6">0.0808 / 0.0403</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.5.5.7">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.5.5.7.1">0.0483</span> / <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.5.5.7.2">0.0229</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.6.6">
<td class="ltx_td ltx_align_center" id="S4.T3.1.6.6.1">@20</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.6.6.2">0.4227 / 0.2079</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.6.6.3">0.1830 / 0.0734</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.6.6.4">0.2104 / 0.0911</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.6.6.5">0.1169 / 0.0494</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.6.6.6">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.6.6.6.1">0.0714</span> / <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.6.6.6.2">0.0287</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.1.7.7.1" rowspan="2"><span class="ltx_text" id="S4.T3.1.7.7.1.1">BD-LRU Only</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.7.7.2">@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.7.7.3">0.3010 / 0.1695</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.7.7.4">0.1199 / 0.0579</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.7.7.5">0.1392 / 0.0703</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.7.7.6">0.0840 / 0.0405</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.7.7.7">0.0454 / 0.0223</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.8.8">
<td class="ltx_td ltx_align_center" id="S4.T3.1.8.8.1">@20</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.8.8.2">0.4007 / 0.1947</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.8.8.3">0.1805 / 0.0732</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.8.8.4">0.2076 / 0.0876</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.8.8.5">0.1212 / 0.0499</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.8.8.6">0.0698 / 0.0285</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.1.9.9.1" rowspan="2"><span class="ltx_text" id="S4.T3.1.9.9.1.1">w/o Conv1D</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.9.9.2">@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.9.9.3">0.3245 / 0.1855</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.9.9.4">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.9.9.4.1">0.1241</span> / <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.9.9.4.2">0.0599</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.9.9.5">0.1418 / <span class="ltx_text ltx_font_bold" id="S4.T3.1.9.9.5.1">0.0754</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.9.9.6">0.0843 / 0.0433</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.9.9.7">0.0480 / 0.0228</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.10.10">
<td class="ltx_td ltx_align_center" id="S4.T3.1.10.10.1">@20</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.10.10.2">0.4301 / 0.2121</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.10.10.3">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.10.10.3.1">0.1835</span> / <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.10.10.3.2">0.0749</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.10.10.4">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.10.10.4.1">0.2117</span> / <span class="ltx_text ltx_font_bold" id="S4.T3.1.10.10.4.2">0.0931</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.10.10.5">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.10.10.5.1">0.1211</span> / <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.10.10.5.2">0.0527</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.10.10.6">0.0697 / 0.0284</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.1.11.11.1" rowspan="2"><span class="ltx_text" id="S4.T3.1.11.11.1.1">w/o PFFN</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.11.11.2">@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.11.11.3">0.3139 / 0.1780</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.11.11.4">0.1209 / 0.0576</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.11.11.5">0.1404 / 0.0728</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.11.11.6">0.0840 / 0.0425</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.11.11.7">0.0480 / 0.0227</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.12.12">
<td class="ltx_td ltx_align_center" id="S4.T3.1.12.12.1">@20</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.12.12.2">0.4172 / 0.2042</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.12.12.3">0.1775 / 0.0718</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.12.12.4">0.2066 / 0.0893</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.12.12.5">0.1209 / 0.0518</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.12.12.6">0.0705 / 0.0282</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t" id="S4.T3.1.13.13.1" rowspan="2"><span class="ltx_text" id="S4.T3.1.13.13.1.1">w/o Custom Initialization</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.13.13.2">@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.13.13.3">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.13.13.3.1">0.3263</span> / <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.13.13.3.2">0.1894</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.13.13.4">0.1188 / 0.0572</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.13.13.5">0.1414 / 0.0741</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.13.13.6">0.0834 / 0.0427</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.13.13.7">0.0479 / 0.0223</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.14.14">
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.14.14.1">@20</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.14.14.2">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.14.14.2.1">0.4329</span> / <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.14.14.2.2">0.2151</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.14.14.3">0.1744 / 0.0712</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.14.14.4">0.2100 / 0.0915</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.14.14.5">0.1180 / 0.0514</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.14.14.6">0.0703 / 0.0281</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Efficiency and Scalability Study</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">For a fair comparison, all experiments in this paper are conducted on a single Nvidia A100 GPU with 40GB of memory. We choose the XLong dataset with a sequence length of approximately 800 for scalability and efficiency study. Due to scalability constraints, we only conduct experiments on selected strong baselines SASRec, LRURec, and our RecBLR <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Training other RNN-based models, BERT4Rec, and FMLP-Rec is computationally impractical due to their slow speeds or GPU memory requirements exceeding the available 40GB.</span></span></span>. The results are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S4.T4" title="Table 4 ‣ 4.3. Efficiency and Scalability Study ‣ 4. Experiments ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>, Both LRU-based models RecBLR and LRURec significantly outperform Transformer-based SASRec because the designed parameterizations of LRUs ensure stability and the ability to avoid vanishing gradients and handle long-range dependencies <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">tay2020long</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">orvieto2023resurrecting</span>)</cite>. RecBLR achieves the best performance among the three models by leveraging its BD-LRUs and gating mechanisms.</p>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="120" id="S4.F4.g1" src="extracted/5836687/sequence_length.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>GPU memory, training time, and inference time per epoch on XLong with different sequence lengths.</figcaption>
</figure>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 4. </span>Performance comparison on XLong with long user behavior sequences.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T4.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.3.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T4.3.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T4.3.1.1.1.1" style="font-size:90%;">Models</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S4.T4.3.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T4.3.1.1.2.1" style="font-size:90%;">XLong</span></th>
</tr>
<tr class="ltx_tr" id="S4.T4.3.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.3.2.2.1"><span class="ltx_text" id="S4.T4.3.2.2.1.1" style="font-size:90%;">HR@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.3.2.2.2"><span class="ltx_text" id="S4.T4.3.2.2.2.1" style="font-size:90%;">NDCG@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.3.2.2.3"><span class="ltx_text" id="S4.T4.3.2.2.3.1" style="font-size:90%;">HR@20</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.3.2.2.4"><span class="ltx_text" id="S4.T4.3.2.2.4.1" style="font-size:90%;">NDCG@20</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.3.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T4.3.3.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.3.3.1.1.1" style="font-size:90%;">SASRec</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.3.1.2"><span class="ltx_text" id="S4.T4.3.3.1.2.1" style="font-size:90%;">0.1946</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.3.1.3"><span class="ltx_text" id="S4.T4.3.3.1.3.1" style="font-size:90%;">0.1507</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.3.1.4"><span class="ltx_text" id="S4.T4.3.3.1.4.1" style="font-size:90%;">0.2066</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.3.1.5"><span class="ltx_text" id="S4.T4.3.3.1.5.1" style="font-size:90%;">0.1538</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.3.4.2.1"><span class="ltx_text ltx_font_bold" id="S4.T4.3.4.2.1.1" style="font-size:90%;">LRURec</span></th>
<td class="ltx_td ltx_align_center" id="S4.T4.3.4.2.2"><span class="ltx_text" id="S4.T4.3.4.2.2.1" style="font-size:90%;">0.2576</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.4.2.3"><span class="ltx_text" id="S4.T4.3.4.2.3.1" style="font-size:90%;">0.2571</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.4.2.4"><span class="ltx_text" id="S4.T4.3.4.2.4.1" style="font-size:90%;">0.2586</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.4.2.5"><span class="ltx_text" id="S4.T4.3.4.2.5.1" style="font-size:90%;">0.2573</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T4.3.5.3.1"><span class="ltx_text ltx_font_bold" id="S4.T4.3.5.3.1.1" style="font-size:90%;">RecBLR</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.3.5.3.2"><span class="ltx_text ltx_font_bold" id="S4.T4.3.5.3.2.1" style="font-size:90%;">0.2696</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.3.5.3.3"><span class="ltx_text ltx_font_bold" id="S4.T4.3.5.3.3.1" style="font-size:90%;">0.2675</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.3.5.3.4"><span class="ltx_text ltx_font_bold" id="S4.T4.3.5.3.4.1" style="font-size:90%;">0.2708</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.3.5.3.5"><span class="ltx_text ltx_font_bold" id="S4.T4.3.5.3.5.1" style="font-size:90%;">0.2678</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p2.1.1">Efficiency of Different Sequence Lengths.</span>
We evaluate the impact on efficiency and scalability across varying maximum sequence lengths for XLong. Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S4.F4" title="Figure 4 ‣ 4.3. Efficiency and Scalability Study ‣ 4. Experiments ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> illustrates how the GPU memory cost and training/inference time per epoch escalate as the maximum sequence length increases. RecBLR excels in both GPU memory usage and training/inference time, particularly for longer sequences. SASRec suffers from the quadratic complexity of its attention mechanisms, leading to rapidly increasing memory usage and training/inference time. While both RecBLR and LRURec enjoy fast inference speeds due to their recurrent nature, LRURec’s training time is considerably longer than RecBLR, especially when the maximum sequence length is 700. Although LRURec has a parallelizable training scheme, its efficiency suffers due to its incorporation of non-linearity and sequence padding. The parallelizable training of LRURec and RecBLR requires sequences with lengths that are powers of two. However, the sequence padding (from 700 to 1024) used in LRURec inflates computational cost, whereas RecBLR employs an embedding padding scheme, incurring fewer additional computations. RecBLR’s efficiency advantage stems from its efficient parallel scan algorithm and embedding padding strategy. This advantage becomes more pronounced with longer sequences, making RecBLR well-suited for real-world applications involving lifelong user behavior sequences and evolving user interests.</p>
</div>
<figure class="ltx_figure" id="S4.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="120" id="S4.F5.g1" src="extracted/5836687/expansion_factor.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5. </span>Influence of the expansion factor on various metrics.</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="120" id="S4.F6.g1" src="extracted/5836687/dropout.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6. </span>Influence of the dropout rate on various metrics.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Ablation Study</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">To understand how different components contribute to RecBLR’s performance, we conduct an ablation study. We evaluate RecBLR variants with the following modifications: <span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.1">Single Behavior Modeling Layer:</span> Reduced the behavior modeling layers from two to one. <span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.2">BD-LRU Only:</span> Replaced the gated recurrent layer with a basic Behavior-Dependent Linear Recurrent Unit (BD-LRU), lacking linear projections, gating mechanisms, and causal convolutions. <span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.3">Without Conv1D</span>: Removed the unidirectional causal Conv1D layer from the gated recurrent layer. <span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.4">Without PFFN</span>: Removed the position-wise feedforward network (PFFN). <span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.5">Without Custon Initialization</span>: Replaced the custom LRU parameter initialization with random initialization. Table <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S4.T3" title="Table 3 ‣ 4.2. Overall Performance ‣ 4. Experiments ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> shows the performance comparison between the default RecBLR and its variants. We have the following observations and conclusions: <span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.6">Generalizability:</span> The default RecBLR achieves the best performance across most datasets, demonstrating strong generalization capabilities. <span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.7">Number of Behavior Modeling Layers:</span> While a single behavior modeling layer maintains decent performance, there is a trade-off between the number of layers and computational efficiency. A single layer can significantly improve training and inference speed. <span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.8">Importance of Gated Recurrent Layer:</span> The BD-LRU-only variant, removing linear projections and gating mechanisms in the gated recurrent layer, demonstrates the importance of these components in enhancing the BD-LRU’s user behavior modeling capabilities. <span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.9">Impact of Conv1D</span>: Removing the Conv1D layer, which captures temporal dependencies in sequential data, leads to slight performance degradation on most datasets except the Steam dataset, which may be due to the limited size and distribution of Steam. <span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.10">Impact of PFFN</span>: The PFFN contributes to behavior modeling regardless of the underlying operator (LRU or attention mechanisms) in the behavior modeling layer. Removing the PFFN consistently reduces performance. <span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.11">LRU Initialization</span>: The custom initialization scheme commonly used in LRUs  <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">orvieto2023resurrecting</span>)</cite>, plays a crucial role in enhancing the performance, especially for larger datasets like MovieLens-1M. Using random initialization yields lower performance.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS4.p2.1.1">Efficiency Ablation Study.</span>
To evaluate the computational efficiency of different scan and padding approaches, we conduct experiments comparing the training time per epoch for serial scan, parallel scan with sequence padding, and our proposed parallel scan with embedding padding. The serial scan computes the hidden representations of linear recurrent units sequentially, as each step depends on the result of the previous step. We employ sequence lengths of 200, 100, and 257 for MovieLens-1M, Gowalla, and XLong datasets, respectively. Due to the constraints of our parallel scan, paddings of 56, 28, and 255 elements are added to the original sequence or embedding lengths of 200, 100, and 257, respectively.
Table <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S4.T5" title="Table 5 ‣ 4.4. Ablation Study ‣ 4. Experiments ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a> demonstrates that parallel scan significantly reduces training time compared to the traditional serial scan. Additionally, our proposed embedding padding approach yields more time savings compared to sequence padding. This benefit becomes more pronounced with longer extra padded lengths, particularly evident on XLong with an extra padded length of 255, which represents an extreme case for padding.</p>
</div>
<figure class="ltx_table" id="S4.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5. </span>Training time per epoch on MovieLens-1M, Gowalla, and XLong datasets with different scan and padding schemes.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T5.1" style="width:151.8pt;height:49.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-33.7pt,11.1pt) scale(0.692339117272368,0.692339117272368) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T5.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T5.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T5.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.1.1.1.1" style="font-size:90%;">Scan Algorithm</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T5.1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.1.1.2.1" style="font-size:90%;">ML-1M</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T5.1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.1.1.3.1" style="font-size:90%;">Gowalla</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.1.1.4.1" style="font-size:90%;">XLong</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T5.1.1.2.1.1"><span class="ltx_text" id="S4.T5.1.1.2.1.1.1" style="font-size:90%;">Serial Scan</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.1.2.1.2"><span class="ltx_text" id="S4.T5.1.1.2.1.2.1" style="font-size:90%;">1022s</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.1.2.1.3"><span class="ltx_text" id="S4.T5.1.1.2.1.3.1" style="font-size:90%;">908s</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.2.1.4"><span class="ltx_text" id="S4.T5.1.1.2.1.4.1" style="font-size:90%;">5958s</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T5.1.1.3.2.1"><span class="ltx_text" id="S4.T5.1.1.3.2.1.1" style="font-size:90%;">Parallel Scan w/ SP</span></th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.1.3.2.2"><span class="ltx_text" id="S4.T5.1.1.3.2.2.1" style="font-size:90%;">75s</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.1.3.2.3"><span class="ltx_text" id="S4.T5.1.1.3.2.3.1" style="font-size:90%;">103s</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.3.2.4"><span class="ltx_text" id="S4.T5.1.1.3.2.4.1" style="font-size:90%;">595s</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T5.1.1.4.3.1"><span class="ltx_text" id="S4.T5.1.1.4.3.1.1" style="font-size:90%;">Parallel Scan w/ EP</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T5.1.1.4.3.2"><span class="ltx_text" id="S4.T5.1.1.4.3.2.1" style="font-size:90%;">61s</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T5.1.1.4.3.3"><span class="ltx_text" id="S4.T5.1.1.4.3.3.1" style="font-size:90%;">91s</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.1.4.3.4"><span class="ltx_text" id="S4.T5.1.1.4.3.4.1" style="font-size:90%;">263s</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5. </span>Hyperparameter Sensitivity</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">We conduct the hyperparameter analysis to assess the sensitivity of RecBLR’s to the expansion factor and the dropout rate.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.p2">
<p class="ltx_p" id="S4.SS5.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS5.p2.1.1">Expansion Factor.</span>
The expansion factor plays a crucial role in controlling the dimensionality of the hidden representations within the gated recurrent layer. A higher expansion factor can potentially improve the model’s ability to capture complex patterns and dependencies in the data, but it may also increase the computational requirements and the risk of overfitting. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S4.F5" title="Figure 5 ‣ 4.3. Efficiency and Scalability Study ‣ 4. Experiments ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>, an expansion factor of 2 often yields optimal performance across various datasets. Consequently, for practical purposes, we adopt a default expansion factor of 2 for the experiments.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.p3">
<p class="ltx_p" id="S4.SS5.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS5.p3.1.1">Dropout Rate.</span>
We have experimented with various dropout rates across different datasets (Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.12580v2#S4.F6" title="Figure 6 ‣ 4.3. Efficiency and Scalability Study ‣ 4. Experiments ‣ Behavior-Dependent Linear Recurrent Units for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>). We observe that selecting a higher dropout rate yields better performance for sparser datasets. For instance, the MovieLens-1M dataset, exhibiting relatively low sparsity, achieves optimal performance with a dropout rate of 0.2. Similarly, a dropout rate of 0.4 yields the best results for the Gowalla and Steam datasets. The sparse Amazon-Beauty and Amazon-Sports datasets achieve the highest performance at a dropout rate of 0.5. These observations suggest that considering the dataset’s sparsity is crucial when selecting dropout rates.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Related Work</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.p1.1.1">Sequential Recommendation.</span>
Sequential recommendation has undergone rapid advancements in recent years. Early approaches Markov Chains (MCs) with matrix factorization <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">rendle2010factorizing</span>)</cite> to model user preferences based on historical interactions. Recently, deep learning methods have significantly enhanced the expressivity of sequential recommendation systems <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">xi2023bird</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">lin2024can</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">lin2023map</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">xi2023towards</span>)</cite>. Earlier neural approaches adopting Convolutional Neural Networks <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">tang2018personalized</span>)</cite> and Recurrent Neural Networks (RNNs) <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">hidasi2015session</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">li2017neural</span>)</cite> pioneer the application of neural network in sequence recommendation. Transformer-based architectures have become dominant due to their self-attention mechanism, which captures complex item relationships and improves accuracy. Additionally, the parallelizable nature of attention addresses the efficiency concerns of RNNs. While Transformers offer high accuracy, research continues to optimize inference efficiency. Alternative approaches, such as MLP-based models like FMLP-Rec <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">zhou2022filter</span>)</cite> and LRURec <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">yue2024linear</span>)</cite> based on linear recurrent units (LRUs), offer a balance between accuracy and efficiency.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.1"><span class="ltx_text ltx_font_bold" id="S5.p2.1.1">Efficient Sequence Modeling.</span>
To address the dilemma of performance, training efficiency, and inference efficiency in sequence modeling, various approaches have been proposed such as linear attention, linear RNNs, and state space models (SSMs). Recently, linear RNNs and SSMs have achieved both efficiency and effectiveness. SSMs (<em class="ltx_emph ltx_font_italic" id="S5.p2.1.2">e.g.</em>, S4 <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">gu2021efficiently</span>)</cite>, S5 <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">smith2022simplified</span>)</cite>, Mamba <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">gu2023mamba</span>)</cite>) have been widely adopted as alternatives to traditional RNNs, CNNs, and Transformers in general sequence modeling tasks. Inspired by the success of SSMs, Linear Recurrent Units  <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">orvieto2023resurrecting</span>)</cite> reinvent RNNs, using linearization, diagonalization, stable exponential parameterization, and custom initialization to create RNN-based models with both strong performance and good efficiency.
Within the recommendation domain, LRURec <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">yue2024linear</span>)</cite> pioneers the application of linear recurrent units. However, there remains significant potential for exploring and adapting efficient sequence modeling approaches for sequential recommendation tasks.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this paper, we propose an effective and efficient sequential recommendation model RecBLR. By leveraging gating mechanisms and behavior-dependent linear recurrent units, it effectively captures users’ evolving interests and behavior patterns, leading to accurate recommendations. The recurrent architecture of RecBLR enables fast inference, while our designed hardware-aware parallel scan algorithm facilitates efficient training. Extensive experiments on real-world datasets demonstrate RecBLR’ superiority in both recommendation performance and computational efficiency, where RecBLR outperforms several competitive baselines based on CNNs, RNNs, and Transformers.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ba et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Jimmy Lei Ba, Jamie Ryan Kiros, and Geoffrey E Hinton. 2016.

</span>
<span class="ltx_bibblock">Layer normalization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">arXiv preprint arXiv:1607.06450</em> (2016).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Blelloch (1990)</span>
<span class="ltx_bibblock">
Guy E Blelloch. 1990.

</span>
<span class="ltx_bibblock">Prefix sums and their applications.

</span>
<span class="ltx_bibblock">(1990).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Xu Chen, Hongteng Xu, Yongfeng Zhang, Jiaxi Tang, Yixin Cao, Zheng Qin, and Hongyuan Zha. 2018.

</span>
<span class="ltx_bibblock">Sequential recommendation with user memory networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">Proceedings of the eleventh ACM international conference on web search and data mining</em>. 108–116.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cho et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2011)</span>
<span class="ltx_bibblock">
Eunjoon Cho, Seth A Myers, and Jure Leskovec. 2011.

</span>
<span class="ltx_bibblock">Friendship and mobility: user movement in location-based social networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">Proceedings of the 17th ACM SIGKDD international conference on Knowledge discovery and data mining</em>. 1082–1090.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chung et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Junyoung Chung, Caglar Gulcehre, KyungHyun Cho, and Yoshua Bengio. 2014.

</span>
<span class="ltx_bibblock">Empirical evaluation of gated recurrent neural networks on sequence modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">arXiv preprint arXiv:1412.3555</em> (2014).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">De et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Soham De, Samuel L Smith, Anushan Fernando, Aleksandar Botev, George Cristian-Muraru, Albert Gu, Ruba Haroun, Leonard Berrada, Yutian Chen, Srivatsan Srinivasan, et al<span class="ltx_text" id="bib.bib7.3.1">.</span> 2024.

</span>
<span class="ltx_bibblock">Griffin: Mixing Gated Linear Recurrences with Local Attention for Efficient Language Models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.4.1">arXiv preprint arXiv:2402.19427</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Daniel Y Fu, Tri Dao, Khaled K Saab, Armin W Thomas, Atri Rudra, and Christopher Ré. 2022.

</span>
<span class="ltx_bibblock">Hungry hungry hippos: Towards language modeling with state space models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">arXiv preprint arXiv:2212.14052</em> (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu and Dao (2023)</span>
<span class="ltx_bibblock">
Albert Gu and Tri Dao. 2023.

</span>
<span class="ltx_bibblock">Mamba: Linear-time sequence modeling with selective state spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:2312.00752</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Albert Gu, Karan Goel, and Christopher Ré. 2021.

</span>
<span class="ltx_bibblock">Efficiently modeling long sequences with structured state spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">arXiv preprint arXiv:2111.00396</em> (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harper and Konstan (2015)</span>
<span class="ltx_bibblock">
F Maxwell Harper and Joseph A Konstan. 2015.

</span>
<span class="ltx_bibblock">The movielens datasets: History and context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Acm transactions on interactive intelligent systems (tiis)</em> 5, 4 (2015), 1–19.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. 2016.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>. 770–778.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He and McAuley (2016)</span>
<span class="ltx_bibblock">
Ruining He and Julian McAuley. 2016.

</span>
<span class="ltx_bibblock">Fusing similarity models with markov chains for sparse sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">2016 IEEE 16th international conference on data mining (ICDM)</em>. IEEE, 191–200.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks and Gimpel (2016)</span>
<span class="ltx_bibblock">
Dan Hendrycks and Kevin Gimpel. 2016.

</span>
<span class="ltx_bibblock">Gaussian error linear units (gelus).

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:1606.08415</em> (2016).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Balázs Hidasi, Alexandros Karatzoglou, Linas Baltrunas, and Domonkos Tikk. 2015.

</span>
<span class="ltx_bibblock">Session-based recommendations with recurrent neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">arXiv preprint arXiv:1511.06939</em> (2015).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hochreiter and Schmidhuber (1997)</span>
<span class="ltx_bibblock">
Sepp Hochreiter and Jürgen Schmidhuber. 1997.

</span>
<span class="ltx_bibblock">Long short-term memory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Neural computation</em> 9, 8 (1997), 1735–1780.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2018)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and Julian McAuley. 2018.

</span>
<span class="ltx_bibblock">Self-attentive sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">2018 IEEE international conference on data mining (ICDM)</em>. IEEE, 197–206.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba (2014)</span>
<span class="ltx_bibblock">
Diederik P Kingma and Jimmy Ba. 2014.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:1412.6980</em> (2014).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirkpatrick et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
James Kirkpatrick, Razvan Pascanu, Neil Rabinowitz, Joel Veness, Guillaume Desjardins, Andrei A Rusu, Kieran Milan, John Quan, Tiago Ramalho, Agnieszka Grabska-Barwinska, et al<span class="ltx_text" id="bib.bib19.3.1">.</span> 2017.

</span>
<span class="ltx_bibblock">Overcoming catastrophic forgetting in neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.4.1">Proceedings of the national academy of sciences</em> 114, 13 (2017), 3521–3526.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2012)</span>
<span class="ltx_bibblock">
Alex Krizhevsky, Ilya Sutskever, and Geoffrey E Hinton. 2012.

</span>
<span class="ltx_bibblock">Imagenet classification with deep convolutional neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Advances in neural information processing systems</em> 25 (2012).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ladner and Fischer (1980)</span>
<span class="ltx_bibblock">
Richard E Ladner and Michael J Fischer. 1980.

</span>
<span class="ltx_bibblock">Parallel prefix computation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Journal of the ACM (JACM)</em> 27, 4 (1980), 831–838.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Jing Li, Pengjie Ren, Zhumin Chen, Zhaochun Ren, Tao Lian, and Jun Ma. 2017.

</span>
<span class="ltx_bibblock">Neural attentive session-based recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">Proceedings of the 2017 ACM on Conference on Information and Knowledge Management</em>. 1419–1428.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2024a)</span>
<span class="ltx_bibblock">
Jianghao Lin, Xinyi Dai, Yunjia Xi, Weiwen Liu, Bo Chen, Hao Zhang, Yong Liu, Chuhan Wu, Xiangyang Li, Chenxu Zhu, Huifeng Guo, Yong Yu, Ruiming Tang, and Weinan Zhang. 2024a.

</span>
<span class="ltx_bibblock">How Can Recommender Systems Benefit from Large Language Models: A Survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">ACM Trans. Inf. Syst.</em> (jul 2024).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3678004" title="">https://doi.org/10.1145/3678004</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jianghao Lin, Yanru Qu, Wei Guo, Xinyi Dai, Ruiming Tang, Yong Yu, and Weinan Zhang. 2023.

</span>
<span class="ltx_bibblock">MAP: A Model-agnostic Pretraining Framework for Click-through Rate Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>. 1384–1395.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2024b)</span>
<span class="ltx_bibblock">
Jianghao Lin, Rong Shan, Chenxu Zhu, Kounianhua Du, Bo Chen, Shigang Quan, Ruiming Tang, Yong Yu, and Weinan Zhang. 2024b.

</span>
<span class="ltx_bibblock">Rella: Retrieval-enhanced large language models for lifelong sequential behavior comprehension in recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">Proceedings of the ACM on Web Conference 2024</em>. 3497–3508.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Chengkai Liu, Jianghao Lin, Jianling Wang, Hanzhou Liu, and James Caverlee. 2024.

</span>
<span class="ltx_bibblock">Mamba4Rec: Towards Efficient Sequential Recommendation with Selective State Space Models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">arXiv preprint arXiv:2403.03900</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Martin and Cundy (2017)</span>
<span class="ltx_bibblock">
Eric Martin and Chris Cundy. 2017.

</span>
<span class="ltx_bibblock">Parallelizing linear recurrent neural nets over sequence length.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:1709.04057</em> (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McAuley et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Julian McAuley, Christopher Targett, Qinfeng Shi, and Anton Van Den Hengel. 2015.

</span>
<span class="ltx_bibblock">Image-based recommendations on styles and substitutes. In <em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">Proceedings of the 38th international ACM SIGIR conference on research and development in information retrieval</em>. 43–52.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Orvieto et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Antonio Orvieto, Samuel L Smith, Albert Gu, Anushan Fernando, Caglar Gulcehre, Razvan Pascanu, and Soham De. 2023.

</span>
<span class="ltx_bibblock">Resurrecting recurrent neural networks for long sequences. In <em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">International Conference on Machine Learning</em>. PMLR, 26670–26698.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">O’shea and Nash (2015)</span>
<span class="ltx_bibblock">
Keiron O’shea and Ryan Nash. 2015.

</span>
<span class="ltx_bibblock">An introduction to convolutional neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:1511.08458</em> (2015).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ramachandran et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Prajit Ramachandran, Barret Zoph, and Quoc V Le. 2017.

</span>
<span class="ltx_bibblock">Searching for activation functions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">arXiv preprint arXiv:1710.05941</em> (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Kan Ren, Jiarui Qin, Yuchen Fang, Weinan Zhang, Lei Zheng, Weijie Bian, Guorui Zhou, Jian Xu, Yong Yu, Xiaoqiang Zhu, et al<span class="ltx_text" id="bib.bib32.3.1">.</span> 2019.

</span>
<span class="ltx_bibblock">Lifelong sequential modeling with personalized memorization for user response prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib32.4.1">Proceedings of the 42nd International ACM SIGIR Conference on Research and Development in Information Retrieval</em>. 565–574.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2010)</span>
<span class="ltx_bibblock">
Steffen Rendle, Christoph Freudenthaler, and Lars Schmidt-Thieme. 2010.

</span>
<span class="ltx_bibblock">Factorizing personalized markov chains for next-basket recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">Proceedings of the 19th international conference on World wide web</em>. 811–820.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schak and Gepperth (2019)</span>
<span class="ltx_bibblock">
Monika Schak and Alexander Gepperth. 2019.

</span>
<span class="ltx_bibblock">A study on catastrophic forgetting in deep LSTM networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Artificial Neural Networks and Machine Learning–ICANN 2019: Deep Learning: 28th International Conference on Artificial Neural Networks, Munich, Germany, September 17–19, 2019, Proceedings, Part II 28</em>. Springer, 714–728.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer (2019)</span>
<span class="ltx_bibblock">
Noam Shazeer. 2019.

</span>
<span class="ltx_bibblock">Fast transformer decoding: One write-head is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">arXiv preprint arXiv:1911.02150</em> (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sherstinsky (2020)</span>
<span class="ltx_bibblock">
Alex Sherstinsky. 2020.

</span>
<span class="ltx_bibblock">Fundamentals of recurrent neural network (RNN) and long short-term memory (LSTM) network.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Physica D: Nonlinear Phenomena</em> 404 (2020), 132306.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smith et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Jimmy TH Smith, Andrew Warrington, and Scott W Linderman. 2022.

</span>
<span class="ltx_bibblock">Simplified state space layers for sequence modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">arXiv preprint arXiv:2208.04933</em> (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Srivastava et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Nitish Srivastava, Geoffrey Hinton, Alex Krizhevsky, Ilya Sutskever, and Ruslan Salakhutdinov. 2014.

</span>
<span class="ltx_bibblock">Dropout: a simple way to prevent neural networks from overfitting.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">The journal of machine learning research</em> 15, 1 (2014), 1929–1958.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fei Sun, Jun Liu, Jian Wu, Changhua Pei, Xiao Lin, Wenwu Ou, and Peng Jiang. 2019.

</span>
<span class="ltx_bibblock">BERT4Rec: Sequential recommendation with bidirectional encoder representations from transformer. In <em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">Proceedings of the 28th ACM international conference on information and knowledge management</em>. 1441–1450.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yutao Sun, Li Dong, Shaohan Huang, Shuming Ma, Yuqing Xia, Jilong Xue, Jianyong Wang, and Furu Wei. 2023.

</span>
<span class="ltx_bibblock">Retentive network: A successor to transformer for large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">arXiv preprint arXiv:2307.08621</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang and Wang (2018)</span>
<span class="ltx_bibblock">
Jiaxi Tang and Ke Wang. 2018.

</span>
<span class="ltx_bibblock">Personalized top-n sequential recommendation via convolutional sequence embedding. In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Proceedings of the eleventh ACM international conference on web search and data mining</em>. 565–573.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tay et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Yi Tay, Mostafa Dehghani, Samira Abnar, Yikang Shen, Dara Bahri, Philip Pham, Jinfeng Rao, Liu Yang, Sebastian Ruder, and Donald Metzler. 2020.

</span>
<span class="ltx_bibblock">Long range arena: A benchmark for efficient transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">arXiv preprint arXiv:2011.04006</em> (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tillet et al<span class="ltx_text" id="bib.bib43.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Philippe Tillet, Hsiang-Tsung Kung, and David Cox. 2019.

</span>
<span class="ltx_bibblock">Triton: an intermediate language and compiler for tiled neural network computations. In <em class="ltx_emph ltx_font_italic" id="bib.bib43.3.1">Proceedings of the 3rd ACM SIGPLAN International Workshop on Machine Learning and Programming Languages</em>. 10–19.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.3.1">Advances in neural information processing systems</em> 30 (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xi et al<span class="ltx_text" id="bib.bib45.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Yunjia Xi, Jianghao Lin, Weiwen Liu, Xinyi Dai, Weinan Zhang, Rui Zhang, Ruiming Tang, and Yong Yu. 2023a.

</span>
<span class="ltx_bibblock">A bird’s-eye view of reranking: from list level to page level. In <em class="ltx_emph ltx_font_italic" id="bib.bib45.3.1">Proceedings of the Sixteenth ACM International Conference on Web Search and Data Mining</em>. 1075–1083.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xi et al<span class="ltx_text" id="bib.bib46.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Yunjia Xi, Weiwen Liu, Jianghao Lin, Xiaoling Cai, Hong Zhu, Jieming Zhu, Bo Chen, Ruiming Tang, Weinan Zhang, Rui Zhang, et al<span class="ltx_text" id="bib.bib46.3.1">.</span> 2023b.

</span>
<span class="ltx_bibblock">Towards open-world recommendation with knowledge augmentation from large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.4.1">arXiv preprint arXiv:2306.10933</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al<span class="ltx_text" id="bib.bib47.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Xu Xie, Fei Sun, Zhaoyang Liu, Shiwen Wu, Jinyang Gao, Jiandong Zhang, Bolin Ding, and Bin Cui. 2022.

</span>
<span class="ltx_bibblock">Contrastive learning for sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib47.3.1">2022 IEEE 38th international conference on data engineering (ICDE)</em>. IEEE, 1259–1273.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan et al<span class="ltx_text" id="bib.bib48.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
An Yan, Shuo Cheng, Wang-Cheng Kang, Mengting Wan, and Julian McAuley. 2019.

</span>
<span class="ltx_bibblock">CosRec: 2D convolutional neural networks for sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib48.3.1">Proceedings of the 28th ACM international conference on information and knowledge management</em>. 2173–2176.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et al<span class="ltx_text" id="bib.bib49.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Enming Yuan, Wei Guo, Zhicheng He, Huifeng Guo, Chengkai Liu, and Ruiming Tang. 2022.

</span>
<span class="ltx_bibblock">Multi-behavior sequential transformer recommender. In <em class="ltx_emph ltx_font_italic" id="bib.bib49.3.1">Proceedings of the 45th international ACM SIGIR conference on research and development in information retrieval</em>. 1642–1652.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yue et al<span class="ltx_text" id="bib.bib50.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Zhenrui Yue, Yueqi Wang, Zhankui He, Huimin Zeng, Julian McAuley, and Dong Wang. 2024.

</span>
<span class="ltx_bibblock">Linear recurrent units for sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib50.3.1">Proceedings of the 17th ACM International Conference on Web Search and Data Mining</em>. 930–938.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib51.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Wayne Xin Zhao, Shanlei Mu, Yupeng Hou, Zihan Lin, Yushuo Chen, Xingyu Pan, Kaiyuan Li, Yujie Lu, Hui Wang, Changxin Tian, et al<span class="ltx_text" id="bib.bib51.3.1">.</span> 2021.

</span>
<span class="ltx_bibblock">Recbole: Towards a unified, comprehensive and efficient framework for recommendation algorithms. In <em class="ltx_emph ltx_font_italic" id="bib.bib51.4.1">proceedings of the 30th acm international conference on information &amp; knowledge management</em>. 4653–4664.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib52.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Kun Zhou, Hui Yu, Wayne Xin Zhao, and Ji-Rong Wen. 2022.

</span>
<span class="ltx_bibblock">Filter-enhanced MLP is all you need for sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib52.3.1">Proceedings of the ACM web conference 2022</em>. 2388–2399.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Sep  5 21:25:58 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
