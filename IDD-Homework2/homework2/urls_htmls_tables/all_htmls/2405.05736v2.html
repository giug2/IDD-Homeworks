<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Optimal Baseline Corrections for Off-Policy Contextual Bandits</title>
<!--Generated on Wed Aug 14 14:16:41 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="" lang="en" name="keywords"/>
<base href="/html/2405.05736v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S1" title="In Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction &amp; Motivation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2" title="In Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Background and Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2.SS1" title="In 2. Background and Related Work ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>On-policy contextual bandits</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2.SS2" title="In 2. Background and Related Work ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Off-policy estimation for general bandits</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3" title="In Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Unifying Off-Policy Estimators</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.SS1" title="In 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>A unified off-policy estimator</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.SS2" title="In 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Minimizing gradient variance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.SS3" title="In 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Minimizing estimation variance</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S4" title="In Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experimental Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S5" title="In Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Results and Discussion</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S5.SS1" title="In 5. Results and Discussion ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Off-policy learning performance (RQ1–3)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S5.SS2" title="In 5. Results and Discussion ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Off-policy evaluation performance (RQ4)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S6" title="In Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion and Future Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#A1" title="In Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix: Off-policy Estimator Variance</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno" lang="en">
<h1 class="ltx_title ltx_title_document">Optimal Baseline Corrections for Off-Policy Contextual Bandits</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shashank Gupta
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">University of Amsterdam</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Amsterdam</span><span class="ltx_text ltx_affiliation_country" id="id3.3.id3">The Netherlands</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:s.gupta2@uva.nl">s.gupta2@uva.nl</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Olivier Jeunen
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.1.id1">ShareChat</span><span class="ltx_text ltx_affiliation_city" id="id5.2.id2">Edinburgh</span><span class="ltx_text ltx_affiliation_country" id="id6.3.id3">United Kingdom</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:jeunen@sharechat.co">jeunen@sharechat.co</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Harrie Oosterhuis
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">Radboud University</span><span class="ltx_text ltx_affiliation_city" id="id8.2.id2">Nijmegen</span><span class="ltx_text ltx_affiliation_country" id="id9.3.id3">The Netherlands</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:harrie.oosterhuis@ru.nl">harrie.oosterhuis@ru.nl</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Maarten de Rijke
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id10.1.id1">University of Amsterdam</span><span class="ltx_text ltx_affiliation_city" id="id11.2.id2">Amsterdam</span><span class="ltx_text ltx_affiliation_country" id="id12.3.id3">The Netherlands</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:m.derijke@uva.nl">m.derijke@uva.nl</a>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id13.id1"><span class="ltx_text" id="id13.id1.1">The off-policy learning paradigm allows for recommender systems and general ranking applications to be framed as <em class="ltx_emph ltx_font_italic" id="id13.id1.1.1">decision-making</em> problems, where we aim to learn decision policies that optimize an unbiased <em class="ltx_emph ltx_font_italic" id="id13.id1.1.2">offline</em> estimate of an <em class="ltx_emph ltx_font_italic" id="id13.id1.1.3">online</em> reward metric.
With unbiasedness comes potentially high variance, and prevalent methods exist to reduce estimation variance.
These methods typically make use of control variates, either additive (i.e., baseline corrections or doubly robust methods) or multiplicative (i.e., self-normalisation).</span></p>
<p class="ltx_p" id="id14.id2"><span class="ltx_text" id="id14.id2.1">Our work unifies these approaches by proposing a single framework built on their equivalence in learning scenarios.
The foundation of our framework is the derivation of an equivalent baseline correction for all of the existing control variates.
Consequently, our framework enables us to characterize the variance-optimal unbiased estimator and provide a closed-form solution for it.
This optimal estimator brings significantly improved performance in both evaluation and learning, and minimizes data requirements.
Empirical observations corroborate our theoretical findings.</span></p>
</div>
<div class="ltx_keywords">
<span class="ltx_text" id="id15.id1">Contextual Bandits; Recommender Systems; Off-policy Learning</span>
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_submissionid" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">submissionid: </span>92</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>rightsretained</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>18th ACM Conference on Recommender
Systems; October 14–18, 2024; Bari, Italy</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>18th ACM Conference on Recommender Systems (RecSys ’24),
October 14–18, 2024, Bari, Italy</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3640457.3688105</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-0505-2/24/10</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id8"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span><span class="ltx_text" id="id8.1">Information systems Recommender systems</span></span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction &amp; Motivation</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recommender systems have undergone a paradigm shift in the last few decades, moving their focus from <em class="ltx_emph ltx_font_italic" id="S1.p1.1.1">rating</em> prediction in the days of the Netflix Prize <cite class="ltx_cite ltx_citemacro_citep">(Bennett et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib4" title="">2007</a>)</cite>, to <em class="ltx_emph ltx_font_italic" id="S1.p1.1.2">item</em> prediction from implicit feedback <cite class="ltx_cite ltx_citemacro_citep">(Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib48" title="">2022</a>)</cite> and <em class="ltx_emph ltx_font_italic" id="S1.p1.1.3">ranking</em> applications gaining practical importance <cite class="ltx_cite ltx_citemacro_citep">(Steck, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib57" title="">2013</a>; Jeunen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib31" title="">2024</a>)</cite>.
Recently, work that applies ideas from the algorithmic <em class="ltx_emph ltx_font_italic" id="S1.p1.1.4">decision-making</em> literature to recommendation problems has become more prominent <cite class="ltx_cite ltx_citemacro_citep">(Vasile et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib65" title="">2020</a>; Saito and Joachims, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib51" title="">2021</a>; Gupta et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib18" title="">2024a</a>; Jeunen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib29" title="">2022</a>)</cite>.
While this line of research is not inherently new <cite class="ltx_cite ltx_citemacro_citep">(Shani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib56" title="">2002</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib39" title="">2010</a>)</cite>, methods based on contextual bandits (or reinforcement learning by extension) have now become widespread in the recommendation field <cite class="ltx_cite ltx_citemacro_citep">(McInerney et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib43" title="">2018</a>; Mehrotra et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib44" title="">2020</a>; Bendada et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib3" title="">2020</a>; Jeunen and Goethals, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib27" title="">2021b</a>; Yi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib68" title="">2023</a>; Su et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib60" title="">2024</a>; Briand et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib6" title="">2024</a>)</cite>.
The <em class="ltx_emph ltx_font_italic" id="S1.p1.1.5">off-policy</em> setting is particularly attractive for practitioners <cite class="ltx_cite ltx_citemacro_citep">(van den Akker et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib64" title="">2024</a>)</cite>, as it allows models to be trained and evaluated in an offline manner <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib8" title="">2019</a>; Dong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib13" title="">2020</a>; Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib42" title="">2020</a>; Jeunen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib32" title="">2020</a>; Jeunen and Goethals, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib26" title="">2021a</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib9" title="">2021</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib40" title="">2022</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib10" title="">2022</a>; Jeunen and Goethals, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib28" title="">2023</a>; Gupta et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib21" title="">2023c</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib19" title="">a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib22" title="">2024b</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib20" title="">b</a>)</cite>.
Indeed, methods exist to obtain unbiased <em class="ltx_emph ltx_font_italic" id="S1.p1.1.6">offline</em> estimators of <em class="ltx_emph ltx_font_italic" id="S1.p1.1.7">online</em> reward metrics, which can then be optimized directly <cite class="ltx_cite ltx_citemacro_citep">(Jeunen, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib24" title="">2021</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Research at the forefront of this area typically aims to find Pareto-optimal solutions to the bias-variance trade-off that arises when choosing an estimator: reducing variance by accepting a small bias <cite class="ltx_cite ltx_citemacro_citep">(Ionides, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib23" title="">2008</a>; Su et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib58" title="">2020</a>)</cite>, by introducing control variates <cite class="ltx_cite ltx_citemacro_citep">(Dudík et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib14" title="">2014</a>; Swaminathan and Joachims, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib63" title="">2015b</a>)</cite>, or both <cite class="ltx_cite ltx_citemacro_citep">(Su et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib59" title="">2019</a>)</cite>.
Control variates are especially attractive as they (asymptotically) preserve the unbiasedness of the widespread inverse propensity scoring (IPS) estimator.
Additive control variates give rise to baseline corrections <cite class="ltx_cite ltx_citemacro_citep">(Greensmith et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib17" title="">2004</a>)</cite>, regression adjustments <cite class="ltx_cite ltx_citemacro_citep">(Freedman, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib16" title="">2008</a>)</cite>, and doubly robust estimators <cite class="ltx_cite ltx_citemacro_citep">(Dudík et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib14" title="">2014</a>)</cite>.
Multiplicative control variates lead to self-normalised estimators <cite class="ltx_cite ltx_citemacro_citep">(Kong, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib36" title="">1992</a>; Swaminathan and Joachims, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib63" title="">2015b</a>)</cite>.
Previous work has proven that for off-policy <em class="ltx_emph ltx_font_italic" id="S1.p2.1.1">learning</em> tasks, the multiplicative control variates can be re-framed using an equivalent additive variate <cite class="ltx_cite ltx_citemacro_citep">(Joachims et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib34" title="">2018</a>; Budylin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib7" title="">2018</a>)</cite>, enabling mini-batch optimization methods to be used.
We note that the self-normalised estimator is only <em class="ltx_emph ltx_font_italic" id="S1.p2.1.2">asymptotically</em> unbiased: a clear disadvantage for evaluation with finite samples.
The common problem which most existing methods tackle is that of <em class="ltx_emph ltx_font_italic" id="S1.p2.1.3">variance reduction</em> in offline value estimation, either for learning or for evaluation.
The common solution is the application of a control variate, either multiplicative or additive <cite class="ltx_cite ltx_citemacro_citep">(Owen, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib46" title="">2013</a>)</cite>.
However, to the best of our knowledge, there is no work that attempts to unify these methods.
Our work addresses this gap by presenting these methods in a unifying framework of baseline corrections which, in turn, allows us to find the optimal baseline correction for variance reduction.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In the context of off-policy learning, adding to the well-known equivalence between reward-translation and self-normalisation described by <cite class="ltx_cite ltx_citemacro_citet">Joachims et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib34" title="">2018</a>)</cite>, we demonstrate that the equivalence extends to baseline corrections, regression adjustments, and doubly robust estimators with a constant reward model.
Further, we derive a novel baseline correction method for off-policy learning that minimizes the variance of the gradient of the (unbiased) estimator. We further show that the baseline correction can be estimated in a closed-form fashion, allowing for easy practical implementation.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In line with recent work on off-policy evaluation/learning for recommendation <cite class="ltx_cite ltx_citemacro_citep">(Jeunen and Goethals, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib27" title="">2021b</a>; Jeunen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib30" title="">2023</a>; Jeunen and Goethals, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib26" title="">2021a</a>; Rohde et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib49" title="">2018</a>; Saito et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib53" title="">2021</a>)</cite>, we adopt an off-policy simulation environment to emulate real-world recommendation scenarios, such as stochastic rewards, large action spaces, and controlled randomisation.
This choice also encourages future reproducibility <cite class="ltx_cite ltx_citemacro_citep">(Saito et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib50" title="">2020</a>)</cite>.
Our experimental results indicate that our proposed baseline correction for gradient variance reduction enables substantially faster convergence and lower gradient variance during learning.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">In addition, we derive a closed-form solution to the optimal baseline correction for off-policy evaluation, i.e., the one that minimizes the variance of the estimator itself.
Importantly, since our framework only considers unbiased estimators, the variance-optimality implies overall optimality.
Our experimental results show that this leads to lower errors in policy value estimation than widely used doubly-robust and SNIPS estimators <cite class="ltx_cite ltx_citemacro_citep">(Dudík et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib14" title="">2014</a>; Swaminathan and Joachims, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib63" title="">2015b</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">All source code to reproduce our experimental results is available at: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/shashankg7/recsys2024_optimal_baseline" title="">https://github.com/shashankg7/recsys2024_optimal_baseline</a>.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Background and Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">The goal of this section is to introduce common contextual bandit setups for recommendation, both on-policy and off-policy.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>On-policy contextual bandits</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.6">We address a general contextual bandit setup <cite class="ltx_cite ltx_citemacro_citep">(Saito and Joachims, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib52" title="">2022</a>; Joachims and Swaminathan, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib33" title="">2016</a>)</cite> with contexts <math alttext="X" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_X</annotation></semantics></math>, actions <math alttext="A" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">A</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_A</annotation></semantics></math>, and rewards <math alttext="R" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">R</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_R</annotation></semantics></math>.
The context typically describes <em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.6.1">user</em> features, actions are the <em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.6.2">items</em> to recommend, and rewards can be any type of <em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.6.3">interaction</em> logged by the platform.
A policy <math alttext="\pi" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><mi id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">italic_π</annotation></semantics></math> defines a conditional probability distribution over actions <math alttext="x" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.1"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.1d">italic_x</annotation></semantics></math>: <math alttext="\mathsf{P}(A=a\mid X=x,\Pi=\pi)\equiv\pi(a\mid x)" class="ltx_math_unparsed" display="inline" id="S2.SS1.p1.6.m6.1"><semantics id="S2.SS1.p1.6.m6.1a"><mrow id="S2.SS1.p1.6.m6.1b"><mi id="S2.SS1.p1.6.m6.1.1">𝖯</mi><mrow id="S2.SS1.p1.6.m6.1.2"><mo id="S2.SS1.p1.6.m6.1.2.1" stretchy="false">(</mo><mi id="S2.SS1.p1.6.m6.1.2.2">A</mi><mo id="S2.SS1.p1.6.m6.1.2.3">=</mo><mi id="S2.SS1.p1.6.m6.1.2.4">a</mi><mo id="S2.SS1.p1.6.m6.1.2.5" lspace="0em" rspace="0.167em">∣</mo><mi id="S2.SS1.p1.6.m6.1.2.6">X</mi><mo id="S2.SS1.p1.6.m6.1.2.7">=</mo><mi id="S2.SS1.p1.6.m6.1.2.8">x</mi><mo id="S2.SS1.p1.6.m6.1.2.9">,</mo><mi id="S2.SS1.p1.6.m6.1.2.10" mathvariant="normal">Π</mi><mo id="S2.SS1.p1.6.m6.1.2.11">=</mo><mi id="S2.SS1.p1.6.m6.1.2.12">π</mi><mo id="S2.SS1.p1.6.m6.1.2.13" stretchy="false">)</mo></mrow><mo id="S2.SS1.p1.6.m6.1.3">≡</mo><mi id="S2.SS1.p1.6.m6.1.4">π</mi><mrow id="S2.SS1.p1.6.m6.1.5"><mo id="S2.SS1.p1.6.m6.1.5.1" stretchy="false">(</mo><mi id="S2.SS1.p1.6.m6.1.5.2">a</mi><mo id="S2.SS1.p1.6.m6.1.5.3" lspace="0em" rspace="0.167em">∣</mo><mi id="S2.SS1.p1.6.m6.1.5.4">x</mi><mo id="S2.SS1.p1.6.m6.1.5.5" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">\mathsf{P}(A=a\mid X=x,\Pi=\pi)\equiv\pi(a\mid x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">sansserif_P ( italic_A = italic_a ∣ italic_X = italic_x , roman_Π = italic_π ) ≡ italic_π ( italic_a ∣ italic_x )</annotation></semantics></math>.
Its <em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.6.4">value</em> is the expected reward it yields:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="V(\pi)=\mathop{\mathbb{E}}_{x\sim\mathsf{P}(X)}\Big{[}\mathop{\mathbb{E}}_{a%
\sim\pi(\cdot\mid x)}\left[R\right]\Big{]}." class="ltx_math_unparsed" display="block" id="S2.E1.m1.4"><semantics id="S2.E1.m1.4a"><mrow id="S2.E1.m1.4.4.1"><mrow id="S2.E1.m1.4.4.1.1"><mrow id="S2.E1.m1.4.4.1.1.3"><mi id="S2.E1.m1.4.4.1.1.3.2">V</mi><mo id="S2.E1.m1.4.4.1.1.3.1">⁢</mo><mrow id="S2.E1.m1.4.4.1.1.3.3.2"><mo id="S2.E1.m1.4.4.1.1.3.3.2.1" stretchy="false">(</mo><mi id="S2.E1.m1.2.2">π</mi><mo id="S2.E1.m1.4.4.1.1.3.3.2.2" stretchy="false">)</mo></mrow></mrow><mo id="S2.E1.m1.4.4.1.1.2" rspace="0.1389em">=</mo><mrow id="S2.E1.m1.4.4.1.1.1"><munder id="S2.E1.m1.4.4.1.1.1.2"><mo id="S2.E1.m1.4.4.1.1.1.2.2" lspace="0.1389em" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S2.E1.m1.1.1.1"><mi id="S2.E1.m1.1.1.1.3">x</mi><mo id="S2.E1.m1.1.1.1.2">∼</mo><mrow id="S2.E1.m1.1.1.1.4"><mi id="S2.E1.m1.1.1.1.4.2">𝖯</mi><mo id="S2.E1.m1.1.1.1.4.1">⁢</mo><mrow id="S2.E1.m1.1.1.1.4.3.2"><mo id="S2.E1.m1.1.1.1.4.3.2.1" stretchy="false">(</mo><mi id="S2.E1.m1.1.1.1.1">X</mi><mo id="S2.E1.m1.1.1.1.4.3.2.2" stretchy="false">)</mo></mrow></mrow></mrow></munder><mrow id="S2.E1.m1.4.4.1.1.1.1.1"><mo id="S2.E1.m1.4.4.1.1.1.1.1.2" maxsize="160%" minsize="160%">[</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1"><munder id="S2.E1.m1.4.4.1.1.1.1.1.1.1"><mo id="S2.E1.m1.4.4.1.1.1.1.1.1.1.2" lspace="0em" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1.1.3"><mi id="S2.E1.m1.4.4.1.1.1.1.1.1.1.3.1">a</mi><mo id="S2.E1.m1.4.4.1.1.1.1.1.1.1.3.2">∼</mo><mi id="S2.E1.m1.4.4.1.1.1.1.1.1.1.3.3">π</mi><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1.1.3.4"><mo id="S2.E1.m1.4.4.1.1.1.1.1.1.1.3.4.1" stretchy="false">(</mo><mo id="S2.E1.m1.4.4.1.1.1.1.1.1.1.3.4.2" lspace="0em" rspace="0em">⋅</mo><mo id="S2.E1.m1.4.4.1.1.1.1.1.1.1.3.4.3" lspace="0em" rspace="0.167em">∣</mo><mi id="S2.E1.m1.4.4.1.1.1.1.1.1.1.3.4.4">x</mi><mo id="S2.E1.m1.4.4.1.1.1.1.1.1.1.3.4.5" stretchy="false">)</mo></mrow></mrow></munder><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1.2.2"><mo id="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.1">[</mo><mi id="S2.E1.m1.3.3">R</mi><mo id="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.2">]</mo></mrow></mrow><mo id="S2.E1.m1.4.4.1.1.1.1.1.3" maxsize="160%" minsize="160%">]</mo></mrow></mrow></mrow><mo id="S2.E1.m1.4.4.1.2" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S2.E1.m1.4b">V(\pi)=\mathop{\mathbb{E}}_{x\sim\mathsf{P}(X)}\Big{[}\mathop{\mathbb{E}}_{a%
\sim\pi(\cdot\mid x)}\left[R\right]\Big{]}.</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.4c">italic_V ( italic_π ) = blackboard_E start_POSTSUBSCRIPT italic_x ∼ sansserif_P ( italic_X ) end_POSTSUBSCRIPT [ blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π ( ⋅ ∣ italic_x ) end_POSTSUBSCRIPT [ italic_R ] ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p1.10">When the policy <math alttext="\pi" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m1.1"><semantics id="S2.SS1.p1.7.m1.1a"><mi id="S2.SS1.p1.7.m1.1.1" xref="S2.SS1.p1.7.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m1.1b"><ci id="S2.SS1.p1.7.m1.1.1.cmml" xref="S2.SS1.p1.7.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m1.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m1.1d">italic_π</annotation></semantics></math> is deployed, we can estimate this quantity by averaging the rewards we observe.
We denote the expected reward for action <math alttext="a" class="ltx_Math" display="inline" id="S2.SS1.p1.8.m2.1"><semantics id="S2.SS1.p1.8.m2.1a"><mi id="S2.SS1.p1.8.m2.1.1" xref="S2.SS1.p1.8.m2.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m2.1b"><ci id="S2.SS1.p1.8.m2.1.1.cmml" xref="S2.SS1.p1.8.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m2.1c">a</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.8.m2.1d">italic_a</annotation></semantics></math> and context <math alttext="r" class="ltx_Math" display="inline" id="S2.SS1.p1.9.m3.1"><semantics id="S2.SS1.p1.9.m3.1a"><mi id="S2.SS1.p1.9.m3.1.1" xref="S2.SS1.p1.9.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m3.1b"><ci id="S2.SS1.p1.9.m3.1.1.cmml" xref="S2.SS1.p1.9.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m3.1c">r</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.9.m3.1d">italic_r</annotation></semantics></math> as <math alttext="r(a,x)\coloneqq\mathbb{E}[R\mid X=x;A=a]" class="ltx_Math" display="inline" id="S2.SS1.p1.10.m4.3"><semantics id="S2.SS1.p1.10.m4.3a"><mrow id="S2.SS1.p1.10.m4.3.3" xref="S2.SS1.p1.10.m4.3.3.cmml"><mrow id="S2.SS1.p1.10.m4.3.3.3" xref="S2.SS1.p1.10.m4.3.3.3.cmml"><mi id="S2.SS1.p1.10.m4.3.3.3.2" xref="S2.SS1.p1.10.m4.3.3.3.2.cmml">r</mi><mo id="S2.SS1.p1.10.m4.3.3.3.1" xref="S2.SS1.p1.10.m4.3.3.3.1.cmml">⁢</mo><mrow id="S2.SS1.p1.10.m4.3.3.3.3.2" xref="S2.SS1.p1.10.m4.3.3.3.3.1.cmml"><mo id="S2.SS1.p1.10.m4.3.3.3.3.2.1" stretchy="false" xref="S2.SS1.p1.10.m4.3.3.3.3.1.cmml">(</mo><mi id="S2.SS1.p1.10.m4.1.1" xref="S2.SS1.p1.10.m4.1.1.cmml">a</mi><mo id="S2.SS1.p1.10.m4.3.3.3.3.2.2" xref="S2.SS1.p1.10.m4.3.3.3.3.1.cmml">,</mo><mi id="S2.SS1.p1.10.m4.2.2" xref="S2.SS1.p1.10.m4.2.2.cmml">x</mi><mo id="S2.SS1.p1.10.m4.3.3.3.3.2.3" stretchy="false" xref="S2.SS1.p1.10.m4.3.3.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p1.10.m4.3.3.2" xref="S2.SS1.p1.10.m4.3.3.2.cmml">≔</mo><mrow id="S2.SS1.p1.10.m4.3.3.1" xref="S2.SS1.p1.10.m4.3.3.1.cmml"><mi id="S2.SS1.p1.10.m4.3.3.1.3" xref="S2.SS1.p1.10.m4.3.3.1.3.cmml">𝔼</mi><mo id="S2.SS1.p1.10.m4.3.3.1.2" xref="S2.SS1.p1.10.m4.3.3.1.2.cmml">⁢</mo><mrow id="S2.SS1.p1.10.m4.3.3.1.1.1" xref="S2.SS1.p1.10.m4.3.3.1.1.2.cmml"><mo id="S2.SS1.p1.10.m4.3.3.1.1.1.2" stretchy="false" xref="S2.SS1.p1.10.m4.3.3.1.1.2.1.cmml">[</mo><mrow id="S2.SS1.p1.10.m4.3.3.1.1.1.1.2" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.3.cmml"><mrow id="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.cmml"><mrow id="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.2" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.2.2" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.2.2.cmml">R</mi><mo id="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.2.1" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.2.1.cmml">∣</mo><mi id="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.2.3" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.2.3.cmml">X</mi></mrow><mo id="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.1" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.1.cmml">=</mo><mi id="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.3" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS1.p1.10.m4.3.3.1.1.1.1.2.3" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.3a.cmml">;</mo><mrow id="S2.SS1.p1.10.m4.3.3.1.1.1.1.2.2" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.2.2.cmml"><mi id="S2.SS1.p1.10.m4.3.3.1.1.1.1.2.2.2" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.2.2.2.cmml">A</mi><mo id="S2.SS1.p1.10.m4.3.3.1.1.1.1.2.2.1" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.2.2.1.cmml">=</mo><mi id="S2.SS1.p1.10.m4.3.3.1.1.1.1.2.2.3" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.2.2.3.cmml">a</mi></mrow></mrow><mo id="S2.SS1.p1.10.m4.3.3.1.1.1.3" stretchy="false" xref="S2.SS1.p1.10.m4.3.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m4.3b"><apply id="S2.SS1.p1.10.m4.3.3.cmml" xref="S2.SS1.p1.10.m4.3.3"><ci id="S2.SS1.p1.10.m4.3.3.2.cmml" xref="S2.SS1.p1.10.m4.3.3.2">≔</ci><apply id="S2.SS1.p1.10.m4.3.3.3.cmml" xref="S2.SS1.p1.10.m4.3.3.3"><times id="S2.SS1.p1.10.m4.3.3.3.1.cmml" xref="S2.SS1.p1.10.m4.3.3.3.1"></times><ci id="S2.SS1.p1.10.m4.3.3.3.2.cmml" xref="S2.SS1.p1.10.m4.3.3.3.2">𝑟</ci><interval closure="open" id="S2.SS1.p1.10.m4.3.3.3.3.1.cmml" xref="S2.SS1.p1.10.m4.3.3.3.3.2"><ci id="S2.SS1.p1.10.m4.1.1.cmml" xref="S2.SS1.p1.10.m4.1.1">𝑎</ci><ci id="S2.SS1.p1.10.m4.2.2.cmml" xref="S2.SS1.p1.10.m4.2.2">𝑥</ci></interval></apply><apply id="S2.SS1.p1.10.m4.3.3.1.cmml" xref="S2.SS1.p1.10.m4.3.3.1"><times id="S2.SS1.p1.10.m4.3.3.1.2.cmml" xref="S2.SS1.p1.10.m4.3.3.1.2"></times><ci id="S2.SS1.p1.10.m4.3.3.1.3.cmml" xref="S2.SS1.p1.10.m4.3.3.1.3">𝔼</ci><apply id="S2.SS1.p1.10.m4.3.3.1.1.2.cmml" xref="S2.SS1.p1.10.m4.3.3.1.1.1"><csymbol cd="latexml" id="S2.SS1.p1.10.m4.3.3.1.1.2.1.cmml" xref="S2.SS1.p1.10.m4.3.3.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS1.p1.10.m4.3.3.1.1.1.1.3.cmml" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m4.3.3.1.1.1.1.3a.cmml" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1"><eq id="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.1"></eq><apply id="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.2.1">conditional</csymbol><ci id="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.2.2">𝑅</ci><ci id="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.2.3">𝑋</ci></apply><ci id="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.1.1.3">𝑥</ci></apply><apply id="S2.SS1.p1.10.m4.3.3.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.2.2"><eq id="S2.SS1.p1.10.m4.3.3.1.1.1.1.2.2.1.cmml" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.2.2.1"></eq><ci id="S2.SS1.p1.10.m4.3.3.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.2.2.2">𝐴</ci><ci id="S2.SS1.p1.10.m4.3.3.1.1.1.1.2.2.3.cmml" xref="S2.SS1.p1.10.m4.3.3.1.1.1.1.2.2.3">𝑎</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m4.3c">r(a,x)\coloneqq\mathbb{E}[R\mid X=x;A=a]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.10.m4.3d">italic_r ( italic_a , italic_x ) ≔ blackboard_E [ italic_R ∣ italic_X = italic_x ; italic_A = italic_a ]</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.5">In the field of contextual bandits (and reinforcement learning (RL) by extension), one often wants to learn <math alttext="\pi" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">italic_π</annotation></semantics></math> to maximise <math alttext="V(\pi)" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.1"><semantics id="S2.SS1.p2.2.m2.1a"><mrow id="S2.SS1.p2.2.m2.1.2" xref="S2.SS1.p2.2.m2.1.2.cmml"><mi id="S2.SS1.p2.2.m2.1.2.2" xref="S2.SS1.p2.2.m2.1.2.2.cmml">V</mi><mo id="S2.SS1.p2.2.m2.1.2.1" xref="S2.SS1.p2.2.m2.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p2.2.m2.1.2.3.2" xref="S2.SS1.p2.2.m2.1.2.cmml"><mo id="S2.SS1.p2.2.m2.1.2.3.2.1" stretchy="false" xref="S2.SS1.p2.2.m2.1.2.cmml">(</mo><mi id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml">π</mi><mo id="S2.SS1.p2.2.m2.1.2.3.2.2" stretchy="false" xref="S2.SS1.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><apply id="S2.SS1.p2.2.m2.1.2.cmml" xref="S2.SS1.p2.2.m2.1.2"><times id="S2.SS1.p2.2.m2.1.2.1.cmml" xref="S2.SS1.p2.2.m2.1.2.1"></times><ci id="S2.SS1.p2.2.m2.1.2.2.cmml" xref="S2.SS1.p2.2.m2.1.2.2">𝑉</ci><ci id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">𝜋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">V(\pi)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.1d">italic_V ( italic_π )</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Sutton and Barto, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib61" title="">2018</a>; Lattimore and Szepesvári, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib37" title="">2020</a>)</cite>.
This is typically achieved through gradient ascent.
Assuming <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m3.1"><semantics id="S2.SS1.p2.3.m3.1a"><msub id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml"><mi id="S2.SS1.p2.3.m3.1.1.2" xref="S2.SS1.p2.3.m3.1.1.2.cmml">π</mi><mi id="S2.SS1.p2.3.m3.1.1.3" xref="S2.SS1.p2.3.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><apply id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.1.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p2.3.m3.1.1.2.cmml" xref="S2.SS1.p2.3.m3.1.1.2">𝜋</ci><ci id="S2.SS1.p2.3.m3.1.1.3.cmml" xref="S2.SS1.p2.3.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is parameterised by <math alttext="\theta" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m4.1"><semantics id="S2.SS1.p2.4.m4.1a"><mi id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><ci id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m4.1d">italic_θ</annotation></semantics></math>, we iteratively update with learning rate <math alttext="\eta" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m5.1"><semantics id="S2.SS1.p2.5.m5.1a"><mi id="S2.SS1.p2.5.m5.1.1" xref="S2.SS1.p2.5.m5.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.1b"><ci id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m5.1d">italic_η</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\theta_{t+1}=\theta_{t}+\eta\nabla_{\theta}(V(\pi_{\theta}))." class="ltx_Math" display="block" id="S2.E2.m1.1"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><msub id="S2.E2.m1.1.1.1.1.4" xref="S2.E2.m1.1.1.1.1.4.cmml"><mi id="S2.E2.m1.1.1.1.1.4.2" xref="S2.E2.m1.1.1.1.1.4.2.cmml">θ</mi><mrow id="S2.E2.m1.1.1.1.1.4.3" xref="S2.E2.m1.1.1.1.1.4.3.cmml"><mi id="S2.E2.m1.1.1.1.1.4.3.2" xref="S2.E2.m1.1.1.1.1.4.3.2.cmml">t</mi><mo id="S2.E2.m1.1.1.1.1.4.3.1" xref="S2.E2.m1.1.1.1.1.4.3.1.cmml">+</mo><mn id="S2.E2.m1.1.1.1.1.4.3.3" xref="S2.E2.m1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo id="S2.E2.m1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.3.cmml">=</mo><mrow id="S2.E2.m1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.cmml"><msub id="S2.E2.m1.1.1.1.1.2.4" xref="S2.E2.m1.1.1.1.1.2.4.cmml"><mi id="S2.E2.m1.1.1.1.1.2.4.2" xref="S2.E2.m1.1.1.1.1.2.4.2.cmml">θ</mi><mi id="S2.E2.m1.1.1.1.1.2.4.3" xref="S2.E2.m1.1.1.1.1.2.4.3.cmml">t</mi></msub><mo id="S2.E2.m1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.2.3.cmml">+</mo><mrow id="S2.E2.m1.1.1.1.1.2.2" xref="S2.E2.m1.1.1.1.1.2.2.cmml"><mi id="S2.E2.m1.1.1.1.1.2.2.4" xref="S2.E2.m1.1.1.1.1.2.2.4.cmml">η</mi><mo id="S2.E2.m1.1.1.1.1.2.2.3" lspace="0.167em" xref="S2.E2.m1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S2.E2.m1.1.1.1.1.2.2.2.2" xref="S2.E2.m1.1.1.1.1.2.2.2.3.cmml"><msub id="S2.E2.m1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml">∇</mo><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml">θ</mi></msub><mrow id="S2.E2.m1.1.1.1.1.2.2.2.2.2" xref="S2.E2.m1.1.1.1.1.2.2.2.3.cmml"><mo id="S2.E2.m1.1.1.1.1.2.2.2.2.2.2" stretchy="false" xref="S2.E2.m1.1.1.1.1.2.2.2.3.cmml">(</mo><mrow id="S2.E2.m1.1.1.1.1.2.2.2.2.2.1" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.cmml"><mi id="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.3" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.3.cmml">V</mi><mo id="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.2" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.1.1" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.cmml"><mo id="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.1.1.2" stretchy="false" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.cmml">(</mo><msub id="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.1.1.1" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.cmml">π</mi><mi id="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.3.cmml">θ</mi></msub><mo id="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.1.1.3" stretchy="false" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.1.1.1.1.2.2.2.2.2.3" stretchy="false" xref="S2.E2.m1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E2.m1.1.1.1.2" lspace="0em" xref="S2.E2.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><eq id="S2.E2.m1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.3"></eq><apply id="S2.E2.m1.1.1.1.1.4.cmml" xref="S2.E2.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.4.1.cmml" xref="S2.E2.m1.1.1.1.1.4">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.4.2.cmml" xref="S2.E2.m1.1.1.1.1.4.2">𝜃</ci><apply id="S2.E2.m1.1.1.1.1.4.3.cmml" xref="S2.E2.m1.1.1.1.1.4.3"><plus id="S2.E2.m1.1.1.1.1.4.3.1.cmml" xref="S2.E2.m1.1.1.1.1.4.3.1"></plus><ci id="S2.E2.m1.1.1.1.1.4.3.2.cmml" xref="S2.E2.m1.1.1.1.1.4.3.2">𝑡</ci><cn id="S2.E2.m1.1.1.1.1.4.3.3.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.4.3.3">1</cn></apply></apply><apply id="S2.E2.m1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2"><plus id="S2.E2.m1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.3"></plus><apply id="S2.E2.m1.1.1.1.1.2.4.cmml" xref="S2.E2.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.4.1.cmml" xref="S2.E2.m1.1.1.1.1.2.4">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.2.4.2.cmml" xref="S2.E2.m1.1.1.1.1.2.4.2">𝜃</ci><ci id="S2.E2.m1.1.1.1.1.2.4.3.cmml" xref="S2.E2.m1.1.1.1.1.2.4.3">𝑡</ci></apply><apply id="S2.E2.m1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2.2"><times id="S2.E2.m1.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.2.3"></times><ci id="S2.E2.m1.1.1.1.1.2.2.4.cmml" xref="S2.E2.m1.1.1.1.1.2.2.4">𝜂</ci><apply id="S2.E2.m1.1.1.1.1.2.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.2.2.2"><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2">∇</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3">𝜃</ci></apply><apply id="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.1"><times id="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.2"></times><ci id="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.3.cmml" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.3">𝑉</ci><apply id="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2">𝜋</ci><ci id="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.3">𝜃</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\theta_{t+1}=\theta_{t}+\eta\nabla_{\theta}(V(\pi_{\theta})).</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.1d">italic_θ start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_η ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_V ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p2.8">Using the well-known REINFORCE “log-trick” <cite class="ltx_cite ltx_citemacro_citep">(Williams, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib67" title="">1992</a>)</cite>, the above gradient can be formulated as an expectation over sampled actions, whereby tractable Monte Carlo estimation is made possible:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Ax1.EGx1">
<tbody id="S2.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\nabla_{\theta}(V(\pi_{\theta}))" class="ltx_Math" display="inline" id="S2.Ex1.m1.2"><semantics id="S2.Ex1.m1.2a"><mrow id="S2.Ex1.m1.2.2.2" xref="S2.Ex1.m1.2.2.3.cmml"><msub id="S2.Ex1.m1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.cmml"><mo id="S2.Ex1.m1.1.1.1.1.2" xref="S2.Ex1.m1.1.1.1.1.2.cmml">∇</mo><mi id="S2.Ex1.m1.1.1.1.1.3" xref="S2.Ex1.m1.1.1.1.1.3.cmml">θ</mi></msub><mrow id="S2.Ex1.m1.2.2.2.2" xref="S2.Ex1.m1.2.2.3.cmml"><mo id="S2.Ex1.m1.2.2.2.2.2" stretchy="false" xref="S2.Ex1.m1.2.2.3.cmml">(</mo><mrow id="S2.Ex1.m1.2.2.2.2.1" xref="S2.Ex1.m1.2.2.2.2.1.cmml"><mi id="S2.Ex1.m1.2.2.2.2.1.3" xref="S2.Ex1.m1.2.2.2.2.1.3.cmml">V</mi><mo id="S2.Ex1.m1.2.2.2.2.1.2" xref="S2.Ex1.m1.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S2.Ex1.m1.2.2.2.2.1.1.1" xref="S2.Ex1.m1.2.2.2.2.1.1.1.1.cmml"><mo id="S2.Ex1.m1.2.2.2.2.1.1.1.2" stretchy="false" xref="S2.Ex1.m1.2.2.2.2.1.1.1.1.cmml">(</mo><msub id="S2.Ex1.m1.2.2.2.2.1.1.1.1" xref="S2.Ex1.m1.2.2.2.2.1.1.1.1.cmml"><mi id="S2.Ex1.m1.2.2.2.2.1.1.1.1.2" xref="S2.Ex1.m1.2.2.2.2.1.1.1.1.2.cmml">π</mi><mi id="S2.Ex1.m1.2.2.2.2.1.1.1.1.3" xref="S2.Ex1.m1.2.2.2.2.1.1.1.1.3.cmml">θ</mi></msub><mo id="S2.Ex1.m1.2.2.2.2.1.1.1.3" stretchy="false" xref="S2.Ex1.m1.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex1.m1.2.2.2.2.3" stretchy="false" xref="S2.Ex1.m1.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.2b"><apply id="S2.Ex1.m1.2.2.3.cmml" xref="S2.Ex1.m1.2.2.2"><apply id="S2.Ex1.m1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1.2">∇</ci><ci id="S2.Ex1.m1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.1.1.3">𝜃</ci></apply><apply id="S2.Ex1.m1.2.2.2.2.1.cmml" xref="S2.Ex1.m1.2.2.2.2.1"><times id="S2.Ex1.m1.2.2.2.2.1.2.cmml" xref="S2.Ex1.m1.2.2.2.2.1.2"></times><ci id="S2.Ex1.m1.2.2.2.2.1.3.cmml" xref="S2.Ex1.m1.2.2.2.2.1.3">𝑉</ci><apply id="S2.Ex1.m1.2.2.2.2.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.Ex1.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.2.2.1.1.1.1.2">𝜋</ci><ci id="S2.Ex1.m1.2.2.2.2.1.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.2.2.1.1.1.1.3">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.2c">\displaystyle\nabla_{\theta}(V(\pi_{\theta}))</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m1.2d">∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_V ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\nabla_{\theta}\left(\mathop{\mathbb{E}}_{x\sim\mathsf{P}(X)}%
\left[\mathop{\mathbb{E}}_{a\sim\pi_{\theta}(\cdot\mid x)}\left[R\right]\right%
]\right)" class="ltx_math_unparsed" display="inline" id="S2.Ex1.m2.4"><semantics id="S2.Ex1.m2.4a"><mrow id="S2.Ex1.m2.4.4"><mi id="S2.Ex1.m2.4.4.4"></mi><mo id="S2.Ex1.m2.4.4.3">=</mo><mrow id="S2.Ex1.m2.4.4.2.2"><msub id="S2.Ex1.m2.3.3.1.1.1"><mo id="S2.Ex1.m2.3.3.1.1.1.2">∇</mo><mi id="S2.Ex1.m2.3.3.1.1.1.3">θ</mi></msub><mrow id="S2.Ex1.m2.4.4.2.2.2"><mo id="S2.Ex1.m2.4.4.2.2.2.2">(</mo><mrow id="S2.Ex1.m2.4.4.2.2.2.1"><munder id="S2.Ex1.m2.4.4.2.2.2.1.2"><mo id="S2.Ex1.m2.4.4.2.2.2.1.2.2" lspace="0em" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S2.Ex1.m2.1.1.1"><mi id="S2.Ex1.m2.1.1.1.3">x</mi><mo id="S2.Ex1.m2.1.1.1.2">∼</mo><mrow id="S2.Ex1.m2.1.1.1.4"><mi id="S2.Ex1.m2.1.1.1.4.2">𝖯</mi><mo id="S2.Ex1.m2.1.1.1.4.1">⁢</mo><mrow id="S2.Ex1.m2.1.1.1.4.3.2"><mo id="S2.Ex1.m2.1.1.1.4.3.2.1" stretchy="false">(</mo><mi id="S2.Ex1.m2.1.1.1.1">X</mi><mo id="S2.Ex1.m2.1.1.1.4.3.2.2" stretchy="false">)</mo></mrow></mrow></mrow></munder><mrow id="S2.Ex1.m2.4.4.2.2.2.1.1.1"><mo id="S2.Ex1.m2.4.4.2.2.2.1.1.1.2">[</mo><mrow id="S2.Ex1.m2.4.4.2.2.2.1.1.1.1"><munder id="S2.Ex1.m2.4.4.2.2.2.1.1.1.1.1"><mo id="S2.Ex1.m2.4.4.2.2.2.1.1.1.1.1.2" lspace="0em" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S2.Ex1.m2.4.4.2.2.2.1.1.1.1.1.3"><mi id="S2.Ex1.m2.4.4.2.2.2.1.1.1.1.1.3.1">a</mi><mo id="S2.Ex1.m2.4.4.2.2.2.1.1.1.1.1.3.2">∼</mo><msub id="S2.Ex1.m2.4.4.2.2.2.1.1.1.1.1.3.3"><mi id="S2.Ex1.m2.4.4.2.2.2.1.1.1.1.1.3.3.2">π</mi><mi id="S2.Ex1.m2.4.4.2.2.2.1.1.1.1.1.3.3.3">θ</mi></msub><mrow id="S2.Ex1.m2.4.4.2.2.2.1.1.1.1.1.3.4"><mo id="S2.Ex1.m2.4.4.2.2.2.1.1.1.1.1.3.4.1" stretchy="false">(</mo><mo id="S2.Ex1.m2.4.4.2.2.2.1.1.1.1.1.3.4.2" lspace="0em" rspace="0em">⋅</mo><mo id="S2.Ex1.m2.4.4.2.2.2.1.1.1.1.1.3.4.3" lspace="0em" rspace="0.167em">∣</mo><mi id="S2.Ex1.m2.4.4.2.2.2.1.1.1.1.1.3.4.4">x</mi><mo id="S2.Ex1.m2.4.4.2.2.2.1.1.1.1.1.3.4.5" stretchy="false">)</mo></mrow></mrow></munder><mrow id="S2.Ex1.m2.4.4.2.2.2.1.1.1.1.2.2"><mo id="S2.Ex1.m2.4.4.2.2.2.1.1.1.1.2.2.1">[</mo><mi id="S2.Ex1.m2.2.2">R</mi><mo id="S2.Ex1.m2.4.4.2.2.2.1.1.1.1.2.2.2">]</mo></mrow></mrow><mo id="S2.Ex1.m2.4.4.2.2.2.1.1.1.3">]</mo></mrow></mrow><mo id="S2.Ex1.m2.4.4.2.2.2.3">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S2.Ex1.m2.4b">\displaystyle=\nabla_{\theta}\left(\mathop{\mathbb{E}}_{x\sim\mathsf{P}(X)}%
\left[\mathop{\mathbb{E}}_{a\sim\pi_{\theta}(\cdot\mid x)}\left[R\right]\right%
]\right)</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m2.4c">= ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( blackboard_E start_POSTSUBSCRIPT italic_x ∼ sansserif_P ( italic_X ) end_POSTSUBSCRIPT [ blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( ⋅ ∣ italic_x ) end_POSTSUBSCRIPT [ italic_R ] ] )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\nabla_{\theta}\left(\int\sum_{a\in\mathcal{A}}\pi_{\theta}(a%
\mid x)r(a,x)\mathsf{P}(X=x)\rm{d}x\right)" class="ltx_Math" display="inline" id="S2.Ex2.m1.4"><semantics id="S2.Ex2.m1.4a"><mrow id="S2.Ex2.m1.4.4" xref="S2.Ex2.m1.4.4.cmml"><mi id="S2.Ex2.m1.4.4.4" xref="S2.Ex2.m1.4.4.4.cmml"></mi><mo id="S2.Ex2.m1.4.4.3" xref="S2.Ex2.m1.4.4.3.cmml">=</mo><mrow id="S2.Ex2.m1.4.4.2.2" xref="S2.Ex2.m1.4.4.2.3.cmml"><msub id="S2.Ex2.m1.3.3.1.1.1" xref="S2.Ex2.m1.3.3.1.1.1.cmml"><mo id="S2.Ex2.m1.3.3.1.1.1.2" xref="S2.Ex2.m1.3.3.1.1.1.2.cmml">∇</mo><mi id="S2.Ex2.m1.3.3.1.1.1.3" xref="S2.Ex2.m1.3.3.1.1.1.3.cmml">θ</mi></msub><mrow id="S2.Ex2.m1.4.4.2.2.2" xref="S2.Ex2.m1.4.4.2.3.cmml"><mo id="S2.Ex2.m1.4.4.2.2.2.2" xref="S2.Ex2.m1.4.4.2.3.cmml">(</mo><mstyle displaystyle="true" id="S2.Ex2.m1.4.4.2.2.2.1" xref="S2.Ex2.m1.4.4.2.2.2.1.cmml"><mrow id="S2.Ex2.m1.4.4.2.2.2.1a" xref="S2.Ex2.m1.4.4.2.2.2.1.cmml"><mo id="S2.Ex2.m1.4.4.2.2.2.1.3" rspace="0em" xref="S2.Ex2.m1.4.4.2.2.2.1.3.cmml">∫</mo><mrow id="S2.Ex2.m1.4.4.2.2.2.1.2" xref="S2.Ex2.m1.4.4.2.2.2.1.2.cmml"><munder id="S2.Ex2.m1.4.4.2.2.2.1.2.3" xref="S2.Ex2.m1.4.4.2.2.2.1.2.3.cmml"><mo id="S2.Ex2.m1.4.4.2.2.2.1.2.3.2" movablelimits="false" xref="S2.Ex2.m1.4.4.2.2.2.1.2.3.2.cmml">∑</mo><mrow id="S2.Ex2.m1.4.4.2.2.2.1.2.3.3" xref="S2.Ex2.m1.4.4.2.2.2.1.2.3.3.cmml"><mi id="S2.Ex2.m1.4.4.2.2.2.1.2.3.3.2" xref="S2.Ex2.m1.4.4.2.2.2.1.2.3.3.2.cmml">a</mi><mo id="S2.Ex2.m1.4.4.2.2.2.1.2.3.3.1" xref="S2.Ex2.m1.4.4.2.2.2.1.2.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.Ex2.m1.4.4.2.2.2.1.2.3.3.3" xref="S2.Ex2.m1.4.4.2.2.2.1.2.3.3.3.cmml">𝒜</mi></mrow></munder><mrow id="S2.Ex2.m1.4.4.2.2.2.1.2.2" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.cmml"><msub id="S2.Ex2.m1.4.4.2.2.2.1.2.2.4" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.4.cmml"><mi id="S2.Ex2.m1.4.4.2.2.2.1.2.2.4.2" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.4.2.cmml">π</mi><mi id="S2.Ex2.m1.4.4.2.2.2.1.2.2.4.3" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.4.3.cmml">θ</mi></msub><mo id="S2.Ex2.m1.4.4.2.2.2.1.2.2.3" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.3.cmml">⁢</mo><mrow id="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1" xref="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1.1.cmml"><mo id="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1.1" xref="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1.1.cmml"><mi id="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1.1.2" xref="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1.1.2.cmml">a</mi><mo id="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1.1.1" xref="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1.1.3" xref="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1.3" stretchy="false" xref="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.Ex2.m1.4.4.2.2.2.1.2.2.3a" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.3.cmml">⁢</mo><mi id="S2.Ex2.m1.4.4.2.2.2.1.2.2.5" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.5.cmml">r</mi><mo id="S2.Ex2.m1.4.4.2.2.2.1.2.2.3b" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.3.cmml">⁢</mo><mrow id="S2.Ex2.m1.4.4.2.2.2.1.2.2.6.2" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.6.1.cmml"><mo id="S2.Ex2.m1.4.4.2.2.2.1.2.2.6.2.1" stretchy="false" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.6.1.cmml">(</mo><mi id="S2.Ex2.m1.1.1" xref="S2.Ex2.m1.1.1.cmml">a</mi><mo id="S2.Ex2.m1.4.4.2.2.2.1.2.2.6.2.2" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.6.1.cmml">,</mo><mi id="S2.Ex2.m1.2.2" xref="S2.Ex2.m1.2.2.cmml">x</mi><mo id="S2.Ex2.m1.4.4.2.2.2.1.2.2.6.2.3" stretchy="false" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.6.1.cmml">)</mo></mrow><mo id="S2.Ex2.m1.4.4.2.2.2.1.2.2.3c" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.3.cmml">⁢</mo><mi id="S2.Ex2.m1.4.4.2.2.2.1.2.2.7" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.7.cmml">𝖯</mi><mo id="S2.Ex2.m1.4.4.2.2.2.1.2.2.3d" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.3.cmml">⁢</mo><mrow id="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1.1.cmml"><mo id="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1.2" stretchy="false" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1.1.cmml">(</mo><mrow id="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1.1" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1.1.cmml"><mi id="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1.1.2" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1.1.2.cmml">X</mi><mo id="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1.1.1" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1.1.1.cmml">=</mo><mi id="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1.1.3" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1.3" stretchy="false" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1.1.cmml">)</mo></mrow><mo id="S2.Ex2.m1.4.4.2.2.2.1.2.2.3e" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.3.cmml">⁢</mo><mi id="S2.Ex2.m1.4.4.2.2.2.1.2.2.8" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.8.cmml">dx</mi></mrow></mrow></mrow></mstyle><mo id="S2.Ex2.m1.4.4.2.2.2.3" xref="S2.Ex2.m1.4.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.4b"><apply id="S2.Ex2.m1.4.4.cmml" xref="S2.Ex2.m1.4.4"><eq id="S2.Ex2.m1.4.4.3.cmml" xref="S2.Ex2.m1.4.4.3"></eq><csymbol cd="latexml" id="S2.Ex2.m1.4.4.4.cmml" xref="S2.Ex2.m1.4.4.4">absent</csymbol><apply id="S2.Ex2.m1.4.4.2.3.cmml" xref="S2.Ex2.m1.4.4.2.2"><apply id="S2.Ex2.m1.3.3.1.1.1.cmml" xref="S2.Ex2.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.3.3.1.1.1.1.cmml" xref="S2.Ex2.m1.3.3.1.1.1">subscript</csymbol><ci id="S2.Ex2.m1.3.3.1.1.1.2.cmml" xref="S2.Ex2.m1.3.3.1.1.1.2">∇</ci><ci id="S2.Ex2.m1.3.3.1.1.1.3.cmml" xref="S2.Ex2.m1.3.3.1.1.1.3">𝜃</ci></apply><apply id="S2.Ex2.m1.4.4.2.2.2.1.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1"><int id="S2.Ex2.m1.4.4.2.2.2.1.3.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.3"></int><apply id="S2.Ex2.m1.4.4.2.2.2.1.2.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2"><apply id="S2.Ex2.m1.4.4.2.2.2.1.2.3.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.4.4.2.2.2.1.2.3.1.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.3">subscript</csymbol><sum id="S2.Ex2.m1.4.4.2.2.2.1.2.3.2.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.3.2"></sum><apply id="S2.Ex2.m1.4.4.2.2.2.1.2.3.3.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.3.3"><in id="S2.Ex2.m1.4.4.2.2.2.1.2.3.3.1.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.3.3.1"></in><ci id="S2.Ex2.m1.4.4.2.2.2.1.2.3.3.2.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.3.3.2">𝑎</ci><ci id="S2.Ex2.m1.4.4.2.2.2.1.2.3.3.3.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.3.3.3">𝒜</ci></apply></apply><apply id="S2.Ex2.m1.4.4.2.2.2.1.2.2.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2"><times id="S2.Ex2.m1.4.4.2.2.2.1.2.2.3.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.3"></times><apply id="S2.Ex2.m1.4.4.2.2.2.1.2.2.4.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.4"><csymbol cd="ambiguous" id="S2.Ex2.m1.4.4.2.2.2.1.2.2.4.1.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.4">subscript</csymbol><ci id="S2.Ex2.m1.4.4.2.2.2.1.2.2.4.2.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.4.2">𝜋</ci><ci id="S2.Ex2.m1.4.4.2.2.2.1.2.2.4.3.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.4.3">𝜃</ci></apply><apply id="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1.1.2">𝑎</ci><ci id="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.1.1.1.1.1.3">𝑥</ci></apply><ci id="S2.Ex2.m1.4.4.2.2.2.1.2.2.5.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.5">𝑟</ci><interval closure="open" id="S2.Ex2.m1.4.4.2.2.2.1.2.2.6.1.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.6.2"><ci id="S2.Ex2.m1.1.1.cmml" xref="S2.Ex2.m1.1.1">𝑎</ci><ci id="S2.Ex2.m1.2.2.cmml" xref="S2.Ex2.m1.2.2">𝑥</ci></interval><ci id="S2.Ex2.m1.4.4.2.2.2.1.2.2.7.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.7">𝖯</ci><apply id="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1.1.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1"><eq id="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1.1.1.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1.1.1"></eq><ci id="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1.1.2.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1.1.2">𝑋</ci><ci id="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1.1.3.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.2.1.1.3">𝑥</ci></apply><ci id="S2.Ex2.m1.4.4.2.2.2.1.2.2.8.cmml" xref="S2.Ex2.m1.4.4.2.2.2.1.2.2.8">dx</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m1.4c">\displaystyle=\nabla_{\theta}\left(\int\sum_{a\in\mathcal{A}}\pi_{\theta}(a%
\mid x)r(a,x)\mathsf{P}(X=x)\rm{d}x\right)</annotation><annotation encoding="application/x-llamapun" id="S2.Ex2.m1.4d">= ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( ∫ ∑ start_POSTSUBSCRIPT italic_a ∈ caligraphic_A end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ∣ italic_x ) italic_r ( italic_a , italic_x ) sansserif_P ( italic_X = italic_x ) roman_dx )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\int\sum_{a\in\mathcal{A}}\nabla_{\theta}\left(\pi_{\theta}(a%
\mid x)r(a,x)\right)\mathsf{P}(X=x)\rm{d}x" class="ltx_Math" display="inline" id="S2.E3.m1.5"><semantics id="S2.E3.m1.5a"><mrow id="S2.E3.m1.5.5" xref="S2.E3.m1.5.5.cmml"><mi id="S2.E3.m1.5.5.5" xref="S2.E3.m1.5.5.5.cmml"></mi><mo id="S2.E3.m1.5.5.4" xref="S2.E3.m1.5.5.4.cmml">=</mo><mstyle displaystyle="true" id="S2.E3.m1.5.5.3" xref="S2.E3.m1.5.5.3.cmml"><mrow id="S2.E3.m1.5.5.3a" xref="S2.E3.m1.5.5.3.cmml"><mo id="S2.E3.m1.5.5.3.4" rspace="0em" xref="S2.E3.m1.5.5.3.4.cmml">∫</mo><mrow id="S2.E3.m1.5.5.3.3" xref="S2.E3.m1.5.5.3.3.cmml"><munder id="S2.E3.m1.5.5.3.3.4" xref="S2.E3.m1.5.5.3.3.4.cmml"><mo id="S2.E3.m1.5.5.3.3.4.2" movablelimits="false" xref="S2.E3.m1.5.5.3.3.4.2.cmml">∑</mo><mrow id="S2.E3.m1.5.5.3.3.4.3" xref="S2.E3.m1.5.5.3.3.4.3.cmml"><mi id="S2.E3.m1.5.5.3.3.4.3.2" xref="S2.E3.m1.5.5.3.3.4.3.2.cmml">a</mi><mo id="S2.E3.m1.5.5.3.3.4.3.1" xref="S2.E3.m1.5.5.3.3.4.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.5.5.3.3.4.3.3" xref="S2.E3.m1.5.5.3.3.4.3.3.cmml">𝒜</mi></mrow></munder><mrow id="S2.E3.m1.5.5.3.3.3" xref="S2.E3.m1.5.5.3.3.3.cmml"><mrow id="S2.E3.m1.4.4.2.2.2.2" xref="S2.E3.m1.4.4.2.2.2.2.cmml"><mrow id="S2.E3.m1.4.4.2.2.2.2.2.2" xref="S2.E3.m1.4.4.2.2.2.2.2.3.cmml"><msub id="S2.E3.m1.3.3.1.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.cmml">∇</mo><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.cmml">θ</mi></msub><mrow id="S2.E3.m1.4.4.2.2.2.2.2.2.2" xref="S2.E3.m1.4.4.2.2.2.2.2.3.cmml"><mo id="S2.E3.m1.4.4.2.2.2.2.2.2.2.2" xref="S2.E3.m1.4.4.2.2.2.2.2.3.cmml">(</mo><mrow id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.cmml"><msub id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.3" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.3.cmml"><mi id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.3.2" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.3.2.cmml">π</mi><mi id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.3.3" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.3.3.cmml">θ</mi></msub><mo id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.2" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1.1.cmml"><mo id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1.2" stretchy="false" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1.1" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1.1.cmml"><mi id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1.1.2" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1.1.2.cmml">a</mi><mo id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1.1.1" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1.1.1.cmml">∣</mo><mi id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1.1.3" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1.3" stretchy="false" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.2a" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.2.cmml">⁢</mo><mi id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.4" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.4.cmml">r</mi><mo id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.2b" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.5.2" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.5.1.cmml"><mo id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.5.2.1" stretchy="false" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.5.1.cmml">(</mo><mi id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">a</mi><mo id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.5.2.2" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.5.1.cmml">,</mo><mi id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml">x</mi><mo id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.5.2.3" stretchy="false" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.5.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.4.4.2.2.2.2.2.2.2.3" xref="S2.E3.m1.4.4.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.4.4.2.2.2.2a" xref="S2.E3.m1.4.4.2.2.2.2.cmml">⁡</mo><mi id="S2.E3.m1.4.4.2.2.2.2.3" xref="S2.E3.m1.4.4.2.2.2.2.3.cmml">𝖯</mi></mrow><mo id="S2.E3.m1.5.5.3.3.3.4" xref="S2.E3.m1.5.5.3.3.3.4.cmml">⁢</mo><mrow id="S2.E3.m1.5.5.3.3.3.3.1" xref="S2.E3.m1.5.5.3.3.3.3.1.1.cmml"><mo id="S2.E3.m1.5.5.3.3.3.3.1.2" stretchy="false" xref="S2.E3.m1.5.5.3.3.3.3.1.1.cmml">(</mo><mrow id="S2.E3.m1.5.5.3.3.3.3.1.1" xref="S2.E3.m1.5.5.3.3.3.3.1.1.cmml"><mi id="S2.E3.m1.5.5.3.3.3.3.1.1.2" xref="S2.E3.m1.5.5.3.3.3.3.1.1.2.cmml">X</mi><mo id="S2.E3.m1.5.5.3.3.3.3.1.1.1" xref="S2.E3.m1.5.5.3.3.3.3.1.1.1.cmml">=</mo><mi id="S2.E3.m1.5.5.3.3.3.3.1.1.3" xref="S2.E3.m1.5.5.3.3.3.3.1.1.3.cmml">x</mi></mrow><mo id="S2.E3.m1.5.5.3.3.3.3.1.3" stretchy="false" xref="S2.E3.m1.5.5.3.3.3.3.1.1.cmml">)</mo></mrow><mo id="S2.E3.m1.5.5.3.3.3.4a" xref="S2.E3.m1.5.5.3.3.3.4.cmml">⁢</mo><mi id="S2.E3.m1.5.5.3.3.3.5" xref="S2.E3.m1.5.5.3.3.3.5.cmml">dx</mi></mrow></mrow></mrow></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.5b"><apply id="S2.E3.m1.5.5.cmml" xref="S2.E3.m1.5.5"><eq id="S2.E3.m1.5.5.4.cmml" xref="S2.E3.m1.5.5.4"></eq><csymbol cd="latexml" id="S2.E3.m1.5.5.5.cmml" xref="S2.E3.m1.5.5.5">absent</csymbol><apply id="S2.E3.m1.5.5.3.cmml" xref="S2.E3.m1.5.5.3"><int id="S2.E3.m1.5.5.3.4.cmml" xref="S2.E3.m1.5.5.3.4"></int><apply id="S2.E3.m1.5.5.3.3.cmml" xref="S2.E3.m1.5.5.3.3"><apply id="S2.E3.m1.5.5.3.3.4.cmml" xref="S2.E3.m1.5.5.3.3.4"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.3.3.4.1.cmml" xref="S2.E3.m1.5.5.3.3.4">subscript</csymbol><sum id="S2.E3.m1.5.5.3.3.4.2.cmml" xref="S2.E3.m1.5.5.3.3.4.2"></sum><apply id="S2.E3.m1.5.5.3.3.4.3.cmml" xref="S2.E3.m1.5.5.3.3.4.3"><in id="S2.E3.m1.5.5.3.3.4.3.1.cmml" xref="S2.E3.m1.5.5.3.3.4.3.1"></in><ci id="S2.E3.m1.5.5.3.3.4.3.2.cmml" xref="S2.E3.m1.5.5.3.3.4.3.2">𝑎</ci><ci id="S2.E3.m1.5.5.3.3.4.3.3.cmml" xref="S2.E3.m1.5.5.3.3.4.3.3">𝒜</ci></apply></apply><apply id="S2.E3.m1.5.5.3.3.3.cmml" xref="S2.E3.m1.5.5.3.3.3"><times id="S2.E3.m1.5.5.3.3.3.4.cmml" xref="S2.E3.m1.5.5.3.3.3.4"></times><apply id="S2.E3.m1.4.4.2.2.2.2.cmml" xref="S2.E3.m1.4.4.2.2.2.2"><apply id="S2.E3.m1.4.4.2.2.2.2.2.3.cmml" xref="S2.E3.m1.4.4.2.2.2.2.2.2"><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.2">∇</ci><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.3">𝜃</ci></apply><apply id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.cmml" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1"><times id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.2.cmml" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.2"></times><apply id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.3.cmml" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.3.1.cmml" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.3">subscript</csymbol><ci id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.3.2.cmml" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.3.2">𝜋</ci><ci id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.3.3.cmml" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.3.3">𝜃</ci></apply><apply id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1.1.1.cmml" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1.1.1">conditional</csymbol><ci id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1.1.2.cmml" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1.1.2">𝑎</ci><ci id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1.1.3.cmml" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.1.1.1.3">𝑥</ci></apply><ci id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.4.cmml" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.4">𝑟</ci><interval closure="open" id="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.5.1.cmml" xref="S2.E3.m1.4.4.2.2.2.2.2.2.2.1.5.2"><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">𝑎</ci><ci id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2">𝑥</ci></interval></apply></apply><ci id="S2.E3.m1.4.4.2.2.2.2.3.cmml" xref="S2.E3.m1.4.4.2.2.2.2.3">𝖯</ci></apply><apply id="S2.E3.m1.5.5.3.3.3.3.1.1.cmml" xref="S2.E3.m1.5.5.3.3.3.3.1"><eq id="S2.E3.m1.5.5.3.3.3.3.1.1.1.cmml" xref="S2.E3.m1.5.5.3.3.3.3.1.1.1"></eq><ci id="S2.E3.m1.5.5.3.3.3.3.1.1.2.cmml" xref="S2.E3.m1.5.5.3.3.3.3.1.1.2">𝑋</ci><ci id="S2.E3.m1.5.5.3.3.3.3.1.1.3.cmml" xref="S2.E3.m1.5.5.3.3.3.3.1.1.3">𝑥</ci></apply><ci id="S2.E3.m1.5.5.3.3.3.5.cmml" xref="S2.E3.m1.5.5.3.3.3.5">dx</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.5c">\displaystyle=\int\sum_{a\in\mathcal{A}}\nabla_{\theta}\left(\pi_{\theta}(a%
\mid x)r(a,x)\right)\mathsf{P}(X=x)\rm{d}x</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.5d">= ∫ ∑ start_POSTSUBSCRIPT italic_a ∈ caligraphic_A end_POSTSUBSCRIPT ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ∣ italic_x ) italic_r ( italic_a , italic_x ) ) sansserif_P ( italic_X = italic_x ) roman_dx</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\int\sum_{a\in\mathcal{A}}\pi_{\theta}(a|x)\nabla_{\theta}\left(%
\log(\pi_{\theta}(a|x))r(a,x)\right)\mathsf{P}(X=x)\rm{d}x" class="ltx_Math" display="inline" id="S2.Ex3.m1.7"><semantics id="S2.Ex3.m1.7a"><mrow id="S2.Ex3.m1.7.7" xref="S2.Ex3.m1.7.7.cmml"><mi id="S2.Ex3.m1.7.7.6" xref="S2.Ex3.m1.7.7.6.cmml"></mi><mo id="S2.Ex3.m1.7.7.5" xref="S2.Ex3.m1.7.7.5.cmml">=</mo><mstyle displaystyle="true" id="S2.Ex3.m1.7.7.4" xref="S2.Ex3.m1.7.7.4.cmml"><mrow id="S2.Ex3.m1.7.7.4a" xref="S2.Ex3.m1.7.7.4.cmml"><mo id="S2.Ex3.m1.7.7.4.5" rspace="0em" xref="S2.Ex3.m1.7.7.4.5.cmml">∫</mo><mrow id="S2.Ex3.m1.7.7.4.4" xref="S2.Ex3.m1.7.7.4.4.cmml"><munder id="S2.Ex3.m1.7.7.4.4.5" xref="S2.Ex3.m1.7.7.4.4.5.cmml"><mo id="S2.Ex3.m1.7.7.4.4.5.2" movablelimits="false" xref="S2.Ex3.m1.7.7.4.4.5.2.cmml">∑</mo><mrow id="S2.Ex3.m1.7.7.4.4.5.3" xref="S2.Ex3.m1.7.7.4.4.5.3.cmml"><mi id="S2.Ex3.m1.7.7.4.4.5.3.2" xref="S2.Ex3.m1.7.7.4.4.5.3.2.cmml">a</mi><mo id="S2.Ex3.m1.7.7.4.4.5.3.1" xref="S2.Ex3.m1.7.7.4.4.5.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.Ex3.m1.7.7.4.4.5.3.3" xref="S2.Ex3.m1.7.7.4.4.5.3.3.cmml">𝒜</mi></mrow></munder><mrow id="S2.Ex3.m1.7.7.4.4.4" xref="S2.Ex3.m1.7.7.4.4.4.cmml"><msub id="S2.Ex3.m1.7.7.4.4.4.6" xref="S2.Ex3.m1.7.7.4.4.4.6.cmml"><mi id="S2.Ex3.m1.7.7.4.4.4.6.2" xref="S2.Ex3.m1.7.7.4.4.4.6.2.cmml">π</mi><mi id="S2.Ex3.m1.7.7.4.4.4.6.3" xref="S2.Ex3.m1.7.7.4.4.4.6.3.cmml">θ</mi></msub><mo id="S2.Ex3.m1.7.7.4.4.4.5" xref="S2.Ex3.m1.7.7.4.4.4.5.cmml">⁢</mo><mrow id="S2.Ex3.m1.4.4.1.1.1.1.1" xref="S2.Ex3.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S2.Ex3.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S2.Ex3.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex3.m1.4.4.1.1.1.1.1.1" xref="S2.Ex3.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S2.Ex3.m1.4.4.1.1.1.1.1.1.2" xref="S2.Ex3.m1.4.4.1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.Ex3.m1.4.4.1.1.1.1.1.1.1" xref="S2.Ex3.m1.4.4.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex3.m1.4.4.1.1.1.1.1.1.3" xref="S2.Ex3.m1.4.4.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex3.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="S2.Ex3.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.Ex3.m1.7.7.4.4.4.5a" lspace="0.167em" xref="S2.Ex3.m1.7.7.4.4.4.5.cmml">⁢</mo><mrow id="S2.Ex3.m1.6.6.3.3.3.3" xref="S2.Ex3.m1.6.6.3.3.3.3.cmml"><mrow id="S2.Ex3.m1.6.6.3.3.3.3.2.2" xref="S2.Ex3.m1.6.6.3.3.3.3.2.3.cmml"><msub id="S2.Ex3.m1.5.5.2.2.2.2.1.1.1" xref="S2.Ex3.m1.5.5.2.2.2.2.1.1.1.cmml"><mo id="S2.Ex3.m1.5.5.2.2.2.2.1.1.1.2" xref="S2.Ex3.m1.5.5.2.2.2.2.1.1.1.2.cmml">∇</mo><mi id="S2.Ex3.m1.5.5.2.2.2.2.1.1.1.3" xref="S2.Ex3.m1.5.5.2.2.2.2.1.1.1.3.cmml">θ</mi></msub><mrow id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2" xref="S2.Ex3.m1.6.6.3.3.3.3.2.3.cmml"><mo id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.2" xref="S2.Ex3.m1.6.6.3.3.3.3.2.3.cmml">(</mo><mrow id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.cmml"><mrow id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.2.cmml"><mi id="S2.Ex3.m1.1.1" xref="S2.Ex3.m1.1.1.cmml">log</mi><mo id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1a" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.2.cmml">⁡</mo><mrow id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.2.cmml"><mo id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.2" stretchy="false" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.2.cmml">(</mo><mrow id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.cmml"><msub id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.3" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.3.cmml"><mi id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.3.2" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.3.2.cmml">π</mi><mi id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.3.3" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.2" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1.1" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1.1.2" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1.1.3" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.3" stretchy="false" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.2" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.2.cmml">⁢</mo><mi id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.3" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.3.cmml">r</mi><mo id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.2a" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.2.cmml">⁢</mo><mrow id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.4.2" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.4.1.cmml"><mo id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.4.2.1" stretchy="false" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.4.1.cmml">(</mo><mi id="S2.Ex3.m1.2.2" xref="S2.Ex3.m1.2.2.cmml">a</mi><mo id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.4.2.2" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.4.1.cmml">,</mo><mi id="S2.Ex3.m1.3.3" xref="S2.Ex3.m1.3.3.cmml">x</mi><mo id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.4.2.3" stretchy="false" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.4.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.3" xref="S2.Ex3.m1.6.6.3.3.3.3.2.3.cmml">)</mo></mrow></mrow><mo id="S2.Ex3.m1.6.6.3.3.3.3a" xref="S2.Ex3.m1.6.6.3.3.3.3.cmml">⁡</mo><mi id="S2.Ex3.m1.6.6.3.3.3.3.3" xref="S2.Ex3.m1.6.6.3.3.3.3.3.cmml">𝖯</mi></mrow><mo id="S2.Ex3.m1.7.7.4.4.4.5b" xref="S2.Ex3.m1.7.7.4.4.4.5.cmml">⁢</mo><mrow id="S2.Ex3.m1.7.7.4.4.4.4.1" xref="S2.Ex3.m1.7.7.4.4.4.4.1.1.cmml"><mo id="S2.Ex3.m1.7.7.4.4.4.4.1.2" stretchy="false" xref="S2.Ex3.m1.7.7.4.4.4.4.1.1.cmml">(</mo><mrow id="S2.Ex3.m1.7.7.4.4.4.4.1.1" xref="S2.Ex3.m1.7.7.4.4.4.4.1.1.cmml"><mi id="S2.Ex3.m1.7.7.4.4.4.4.1.1.2" xref="S2.Ex3.m1.7.7.4.4.4.4.1.1.2.cmml">X</mi><mo id="S2.Ex3.m1.7.7.4.4.4.4.1.1.1" xref="S2.Ex3.m1.7.7.4.4.4.4.1.1.1.cmml">=</mo><mi id="S2.Ex3.m1.7.7.4.4.4.4.1.1.3" xref="S2.Ex3.m1.7.7.4.4.4.4.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex3.m1.7.7.4.4.4.4.1.3" stretchy="false" xref="S2.Ex3.m1.7.7.4.4.4.4.1.1.cmml">)</mo></mrow><mo id="S2.Ex3.m1.7.7.4.4.4.5c" xref="S2.Ex3.m1.7.7.4.4.4.5.cmml">⁢</mo><mi id="S2.Ex3.m1.7.7.4.4.4.7" xref="S2.Ex3.m1.7.7.4.4.4.7.cmml">dx</mi></mrow></mrow></mrow></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex3.m1.7b"><apply id="S2.Ex3.m1.7.7.cmml" xref="S2.Ex3.m1.7.7"><eq id="S2.Ex3.m1.7.7.5.cmml" xref="S2.Ex3.m1.7.7.5"></eq><csymbol cd="latexml" id="S2.Ex3.m1.7.7.6.cmml" xref="S2.Ex3.m1.7.7.6">absent</csymbol><apply id="S2.Ex3.m1.7.7.4.cmml" xref="S2.Ex3.m1.7.7.4"><int id="S2.Ex3.m1.7.7.4.5.cmml" xref="S2.Ex3.m1.7.7.4.5"></int><apply id="S2.Ex3.m1.7.7.4.4.cmml" xref="S2.Ex3.m1.7.7.4.4"><apply id="S2.Ex3.m1.7.7.4.4.5.cmml" xref="S2.Ex3.m1.7.7.4.4.5"><csymbol cd="ambiguous" id="S2.Ex3.m1.7.7.4.4.5.1.cmml" xref="S2.Ex3.m1.7.7.4.4.5">subscript</csymbol><sum id="S2.Ex3.m1.7.7.4.4.5.2.cmml" xref="S2.Ex3.m1.7.7.4.4.5.2"></sum><apply id="S2.Ex3.m1.7.7.4.4.5.3.cmml" xref="S2.Ex3.m1.7.7.4.4.5.3"><in id="S2.Ex3.m1.7.7.4.4.5.3.1.cmml" xref="S2.Ex3.m1.7.7.4.4.5.3.1"></in><ci id="S2.Ex3.m1.7.7.4.4.5.3.2.cmml" xref="S2.Ex3.m1.7.7.4.4.5.3.2">𝑎</ci><ci id="S2.Ex3.m1.7.7.4.4.5.3.3.cmml" xref="S2.Ex3.m1.7.7.4.4.5.3.3">𝒜</ci></apply></apply><apply id="S2.Ex3.m1.7.7.4.4.4.cmml" xref="S2.Ex3.m1.7.7.4.4.4"><times id="S2.Ex3.m1.7.7.4.4.4.5.cmml" xref="S2.Ex3.m1.7.7.4.4.4.5"></times><apply id="S2.Ex3.m1.7.7.4.4.4.6.cmml" xref="S2.Ex3.m1.7.7.4.4.4.6"><csymbol cd="ambiguous" id="S2.Ex3.m1.7.7.4.4.4.6.1.cmml" xref="S2.Ex3.m1.7.7.4.4.4.6">subscript</csymbol><ci id="S2.Ex3.m1.7.7.4.4.4.6.2.cmml" xref="S2.Ex3.m1.7.7.4.4.4.6.2">𝜋</ci><ci id="S2.Ex3.m1.7.7.4.4.4.6.3.cmml" xref="S2.Ex3.m1.7.7.4.4.4.6.3">𝜃</ci></apply><apply id="S2.Ex3.m1.4.4.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="S2.Ex3.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.4.4.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex3.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S2.Ex3.m1.4.4.1.1.1.1.1.1.2">𝑎</ci><ci id="S2.Ex3.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S2.Ex3.m1.4.4.1.1.1.1.1.1.3">𝑥</ci></apply><apply id="S2.Ex3.m1.6.6.3.3.3.3.cmml" xref="S2.Ex3.m1.6.6.3.3.3.3"><apply id="S2.Ex3.m1.6.6.3.3.3.3.2.3.cmml" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2"><apply id="S2.Ex3.m1.5.5.2.2.2.2.1.1.1.cmml" xref="S2.Ex3.m1.5.5.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.5.5.2.2.2.2.1.1.1.1.cmml" xref="S2.Ex3.m1.5.5.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.Ex3.m1.5.5.2.2.2.2.1.1.1.2.cmml" xref="S2.Ex3.m1.5.5.2.2.2.2.1.1.1.2">∇</ci><ci id="S2.Ex3.m1.5.5.2.2.2.2.1.1.1.3.cmml" xref="S2.Ex3.m1.5.5.2.2.2.2.1.1.1.3">𝜃</ci></apply><apply id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.cmml" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1"><times id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.2.cmml" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.2"></times><apply id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.2.cmml" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1"><log id="S2.Ex3.m1.1.1.cmml" xref="S2.Ex3.m1.1.1"></log><apply id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.cmml" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1"><times id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.2.cmml" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.2"></times><apply id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.3.cmml" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.3.1.cmml" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.3.2.cmml" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.3.2">𝜋</ci><ci id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.3.3.cmml" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1.1.2">𝑎</ci><ci id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply></apply><ci id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.3.cmml" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.3">𝑟</ci><interval closure="open" id="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.4.1.cmml" xref="S2.Ex3.m1.6.6.3.3.3.3.2.2.2.1.4.2"><ci id="S2.Ex3.m1.2.2.cmml" xref="S2.Ex3.m1.2.2">𝑎</ci><ci id="S2.Ex3.m1.3.3.cmml" xref="S2.Ex3.m1.3.3">𝑥</ci></interval></apply></apply><ci id="S2.Ex3.m1.6.6.3.3.3.3.3.cmml" xref="S2.Ex3.m1.6.6.3.3.3.3.3">𝖯</ci></apply><apply id="S2.Ex3.m1.7.7.4.4.4.4.1.1.cmml" xref="S2.Ex3.m1.7.7.4.4.4.4.1"><eq id="S2.Ex3.m1.7.7.4.4.4.4.1.1.1.cmml" xref="S2.Ex3.m1.7.7.4.4.4.4.1.1.1"></eq><ci id="S2.Ex3.m1.7.7.4.4.4.4.1.1.2.cmml" xref="S2.Ex3.m1.7.7.4.4.4.4.1.1.2">𝑋</ci><ci id="S2.Ex3.m1.7.7.4.4.4.4.1.1.3.cmml" xref="S2.Ex3.m1.7.7.4.4.4.4.1.1.3">𝑥</ci></apply><ci id="S2.Ex3.m1.7.7.4.4.4.7.cmml" xref="S2.Ex3.m1.7.7.4.4.4.7">dx</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex3.m1.7c">\displaystyle=\int\sum_{a\in\mathcal{A}}\pi_{\theta}(a|x)\nabla_{\theta}\left(%
\log(\pi_{\theta}(a|x))r(a,x)\right)\mathsf{P}(X=x)\rm{d}x</annotation><annotation encoding="application/x-llamapun" id="S2.Ex3.m1.7d">= ∫ ∑ start_POSTSUBSCRIPT italic_a ∈ caligraphic_A end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | italic_x ) ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( roman_log ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | italic_x ) ) italic_r ( italic_a , italic_x ) ) sansserif_P ( italic_X = italic_x ) roman_dx</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathop{\mathbb{E}}_{x\sim\mathsf{P}(X)}\left[\mathop{\mathbb{E}%
}_{a\sim\pi_{\theta}(\cdot\mid x)}\left[\nabla_{\theta}\left(\log(\pi_{\theta}%
(a\mid x))R\right)\right]\right]." class="ltx_math_unparsed" display="inline" id="S2.Ex4.m1.3"><semantics id="S2.Ex4.m1.3a"><mrow id="S2.Ex4.m1.3.3.1"><mrow id="S2.Ex4.m1.3.3.1.1"><mi id="S2.Ex4.m1.3.3.1.1.3"></mi><mo id="S2.Ex4.m1.3.3.1.1.2" rspace="0.1389em">=</mo><mrow id="S2.Ex4.m1.3.3.1.1.1"><munder id="S2.Ex4.m1.3.3.1.1.1.2"><mo id="S2.Ex4.m1.3.3.1.1.1.2.2" lspace="0.1389em" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S2.Ex4.m1.1.1.1"><mi id="S2.Ex4.m1.1.1.1.3">x</mi><mo id="S2.Ex4.m1.1.1.1.2">∼</mo><mrow id="S2.Ex4.m1.1.1.1.4"><mi id="S2.Ex4.m1.1.1.1.4.2">𝖯</mi><mo id="S2.Ex4.m1.1.1.1.4.1">⁢</mo><mrow id="S2.Ex4.m1.1.1.1.4.3.2"><mo id="S2.Ex4.m1.1.1.1.4.3.2.1" stretchy="false">(</mo><mi id="S2.Ex4.m1.1.1.1.1">X</mi><mo id="S2.Ex4.m1.1.1.1.4.3.2.2" stretchy="false">)</mo></mrow></mrow></mrow></munder><mrow id="S2.Ex4.m1.3.3.1.1.1.1.1"><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.2">[</mo><mrow id="S2.Ex4.m1.3.3.1.1.1.1.1.1"><munder id="S2.Ex4.m1.3.3.1.1.1.1.1.1.2"><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.1.2.2" lspace="0em" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S2.Ex4.m1.3.3.1.1.1.1.1.1.2.3"><mi id="S2.Ex4.m1.3.3.1.1.1.1.1.1.2.3.1">a</mi><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.1.2.3.2">∼</mo><msub id="S2.Ex4.m1.3.3.1.1.1.1.1.1.2.3.3"><mi id="S2.Ex4.m1.3.3.1.1.1.1.1.1.2.3.3.2">π</mi><mi id="S2.Ex4.m1.3.3.1.1.1.1.1.1.2.3.3.3">θ</mi></msub><mrow id="S2.Ex4.m1.3.3.1.1.1.1.1.1.2.3.4"><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.1.2.3.4.1" stretchy="false">(</mo><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.1.2.3.4.2" lspace="0em" rspace="0em">⋅</mo><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.1.2.3.4.3" lspace="0em" rspace="0.167em">∣</mo><mi id="S2.Ex4.m1.3.3.1.1.1.1.1.1.2.3.4.4">x</mi><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.1.2.3.4.5" stretchy="false">)</mo></mrow></mrow></munder><mrow id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1"><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.2">[</mo><mrow id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2"><msub id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">∇</mo><mi id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">θ</mi></msub><mrow id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2"><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2">(</mo><mrow id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1"><mrow id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.1"><mi id="S2.Ex4.m1.2.2">log</mi><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.1a">⁡</mo><mrow id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1"><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2" stretchy="false">(</mo><mrow id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.1"><msub id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.1.3"><mi id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2">π</mi><mi id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.1.3.3">θ</mi></msub><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.1.2">⁢</mo><mrow id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1"><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.2" stretchy="false">(</mo><mrow id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1"><mi id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.2">a</mi><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1">∣</mo><mi id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.3">x</mi></mrow><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.2">⁢</mo><mi id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.3">R</mi></mrow><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.3">)</mo></mrow></mrow><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.3">]</mo></mrow></mrow><mo id="S2.Ex4.m1.3.3.1.1.1.1.1.3">]</mo></mrow></mrow></mrow><mo id="S2.Ex4.m1.3.3.1.2" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S2.Ex4.m1.3b">\displaystyle=\mathop{\mathbb{E}}_{x\sim\mathsf{P}(X)}\left[\mathop{\mathbb{E}%
}_{a\sim\pi_{\theta}(\cdot\mid x)}\left[\nabla_{\theta}\left(\log(\pi_{\theta}%
(a\mid x))R\right)\right]\right].</annotation><annotation encoding="application/x-llamapun" id="S2.Ex4.m1.3c">= blackboard_E start_POSTSUBSCRIPT italic_x ∼ sansserif_P ( italic_X ) end_POSTSUBSCRIPT [ blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( ⋅ ∣ italic_x ) end_POSTSUBSCRIPT [ ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( roman_log ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ∣ italic_x ) ) italic_R ) ] ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p2.7">This provides an unbiased estimate of the gradient of <math alttext="V(\pi_{\theta})" class="ltx_Math" display="inline" id="S2.SS1.p2.6.m1.1"><semantics id="S2.SS1.p2.6.m1.1a"><mrow id="S2.SS1.p2.6.m1.1.1" xref="S2.SS1.p2.6.m1.1.1.cmml"><mi id="S2.SS1.p2.6.m1.1.1.3" xref="S2.SS1.p2.6.m1.1.1.3.cmml">V</mi><mo id="S2.SS1.p2.6.m1.1.1.2" xref="S2.SS1.p2.6.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p2.6.m1.1.1.1.1" xref="S2.SS1.p2.6.m1.1.1.1.1.1.cmml"><mo id="S2.SS1.p2.6.m1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p2.6.m1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.p2.6.m1.1.1.1.1.1" xref="S2.SS1.p2.6.m1.1.1.1.1.1.cmml"><mi id="S2.SS1.p2.6.m1.1.1.1.1.1.2" xref="S2.SS1.p2.6.m1.1.1.1.1.1.2.cmml">π</mi><mi id="S2.SS1.p2.6.m1.1.1.1.1.1.3" xref="S2.SS1.p2.6.m1.1.1.1.1.1.3.cmml">θ</mi></msub><mo id="S2.SS1.p2.6.m1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p2.6.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m1.1b"><apply id="S2.SS1.p2.6.m1.1.1.cmml" xref="S2.SS1.p2.6.m1.1.1"><times id="S2.SS1.p2.6.m1.1.1.2.cmml" xref="S2.SS1.p2.6.m1.1.1.2"></times><ci id="S2.SS1.p2.6.m1.1.1.3.cmml" xref="S2.SS1.p2.6.m1.1.1.3">𝑉</ci><apply id="S2.SS1.p2.6.m1.1.1.1.1.1.cmml" xref="S2.SS1.p2.6.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.6.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.6.m1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.6.m1.1.1.1.1.1.2">𝜋</ci><ci id="S2.SS1.p2.6.m1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.6.m1.1.1.1.1.1.3">𝜃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m1.1c">V(\pi_{\theta})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.6.m1.1d">italic_V ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT )</annotation></semantics></math>. However, it may be subject to high variance due to the inherent variance of <math alttext="R" class="ltx_Math" display="inline" id="S2.SS1.p2.7.m2.1"><semantics id="S2.SS1.p2.7.m2.1a"><mi id="S2.SS1.p2.7.m2.1.1" xref="S2.SS1.p2.7.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m2.1b"><ci id="S2.SS1.p2.7.m2.1.1.cmml" xref="S2.SS1.p2.7.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m2.1c">R</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.7.m2.1d">italic_R</annotation></semantics></math>.
Several techniques have been proposed in the literature that aim to alleviate this, mostly using additive <em class="ltx_emph ltx_font_italic" id="S2.SS1.p2.7.1">control variates</em>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.4">Control variates are random variables with a known expectation <cite class="ltx_cite ltx_citemacro_citep">(Owen, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib46" title="">2013</a>, §8.9)</cite>.
If the control variate is correlated with the original estimand — in our case <math alttext="V(\pi_{\theta})" class="ltx_Math" display="inline" id="S2.SS1.p3.1.m1.1"><semantics id="S2.SS1.p3.1.m1.1a"><mrow id="S2.SS1.p3.1.m1.1.1" xref="S2.SS1.p3.1.m1.1.1.cmml"><mi id="S2.SS1.p3.1.m1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.3.cmml">V</mi><mo id="S2.SS1.p3.1.m1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p3.1.m1.1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS1.p3.1.m1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p3.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.p3.1.m1.1.1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS1.p3.1.m1.1.1.1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.1.1.1.2.cmml">π</mi><mi id="S2.SS1.p3.1.m1.1.1.1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.1.1.1.3.cmml">θ</mi></msub><mo id="S2.SS1.p3.1.m1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.1b"><apply id="S2.SS1.p3.1.m1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1"><times id="S2.SS1.p3.1.m1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.2"></times><ci id="S2.SS1.p3.1.m1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.3">𝑉</ci><apply id="S2.SS1.p3.1.m1.1.1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.2">𝜋</ci><ci id="S2.SS1.p3.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.3">𝜃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.1c">V(\pi_{\theta})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.1.m1.1d">italic_V ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT )</annotation></semantics></math> — they can be used to reduce the estimator’s variance.
A natural way to apply control variates to a sample average estimate for Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2.E1" title="In 2.1. On-policy contextual bandits ‣ 2. Background and Related Work ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">1</span></a> is to estimate a model of the reward <math alttext="\widehat{r}(a,x)\approx\mathbb{E}[R|X=x;A=a]" class="ltx_Math" display="inline" id="S2.SS1.p3.2.m2.3"><semantics id="S2.SS1.p3.2.m2.3a"><mrow id="S2.SS1.p3.2.m2.3.3" xref="S2.SS1.p3.2.m2.3.3.cmml"><mrow id="S2.SS1.p3.2.m2.3.3.3" xref="S2.SS1.p3.2.m2.3.3.3.cmml"><mover accent="true" id="S2.SS1.p3.2.m2.3.3.3.2" xref="S2.SS1.p3.2.m2.3.3.3.2.cmml"><mi id="S2.SS1.p3.2.m2.3.3.3.2.2" xref="S2.SS1.p3.2.m2.3.3.3.2.2.cmml">r</mi><mo id="S2.SS1.p3.2.m2.3.3.3.2.1" xref="S2.SS1.p3.2.m2.3.3.3.2.1.cmml">^</mo></mover><mo id="S2.SS1.p3.2.m2.3.3.3.1" xref="S2.SS1.p3.2.m2.3.3.3.1.cmml">⁢</mo><mrow id="S2.SS1.p3.2.m2.3.3.3.3.2" xref="S2.SS1.p3.2.m2.3.3.3.3.1.cmml"><mo id="S2.SS1.p3.2.m2.3.3.3.3.2.1" stretchy="false" xref="S2.SS1.p3.2.m2.3.3.3.3.1.cmml">(</mo><mi id="S2.SS1.p3.2.m2.1.1" xref="S2.SS1.p3.2.m2.1.1.cmml">a</mi><mo id="S2.SS1.p3.2.m2.3.3.3.3.2.2" xref="S2.SS1.p3.2.m2.3.3.3.3.1.cmml">,</mo><mi id="S2.SS1.p3.2.m2.2.2" xref="S2.SS1.p3.2.m2.2.2.cmml">x</mi><mo id="S2.SS1.p3.2.m2.3.3.3.3.2.3" stretchy="false" xref="S2.SS1.p3.2.m2.3.3.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p3.2.m2.3.3.2" xref="S2.SS1.p3.2.m2.3.3.2.cmml">≈</mo><mrow id="S2.SS1.p3.2.m2.3.3.1" xref="S2.SS1.p3.2.m2.3.3.1.cmml"><mi id="S2.SS1.p3.2.m2.3.3.1.3" xref="S2.SS1.p3.2.m2.3.3.1.3.cmml">𝔼</mi><mo id="S2.SS1.p3.2.m2.3.3.1.2" xref="S2.SS1.p3.2.m2.3.3.1.2.cmml">⁢</mo><mrow id="S2.SS1.p3.2.m2.3.3.1.1.1" xref="S2.SS1.p3.2.m2.3.3.1.1.2.cmml"><mo id="S2.SS1.p3.2.m2.3.3.1.1.1.2" stretchy="false" xref="S2.SS1.p3.2.m2.3.3.1.1.2.1.cmml">[</mo><mrow id="S2.SS1.p3.2.m2.3.3.1.1.1.1.2" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.3.cmml"><mrow id="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.cmml"><mrow id="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.2" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.2.2" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.2.2.cmml">R</mi><mo fence="false" id="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.2.1" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.2.1.cmml">|</mo><mi id="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.2.3" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.2.3.cmml">X</mi></mrow><mo id="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.1" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.1.cmml">=</mo><mi id="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.3" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS1.p3.2.m2.3.3.1.1.1.1.2.3" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.3a.cmml">;</mo><mrow id="S2.SS1.p3.2.m2.3.3.1.1.1.1.2.2" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.2.2.cmml"><mi id="S2.SS1.p3.2.m2.3.3.1.1.1.1.2.2.2" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.2.2.2.cmml">A</mi><mo id="S2.SS1.p3.2.m2.3.3.1.1.1.1.2.2.1" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.2.2.1.cmml">=</mo><mi id="S2.SS1.p3.2.m2.3.3.1.1.1.1.2.2.3" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.2.2.3.cmml">a</mi></mrow></mrow><mo id="S2.SS1.p3.2.m2.3.3.1.1.1.3" stretchy="false" xref="S2.SS1.p3.2.m2.3.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.2.m2.3b"><apply id="S2.SS1.p3.2.m2.3.3.cmml" xref="S2.SS1.p3.2.m2.3.3"><approx id="S2.SS1.p3.2.m2.3.3.2.cmml" xref="S2.SS1.p3.2.m2.3.3.2"></approx><apply id="S2.SS1.p3.2.m2.3.3.3.cmml" xref="S2.SS1.p3.2.m2.3.3.3"><times id="S2.SS1.p3.2.m2.3.3.3.1.cmml" xref="S2.SS1.p3.2.m2.3.3.3.1"></times><apply id="S2.SS1.p3.2.m2.3.3.3.2.cmml" xref="S2.SS1.p3.2.m2.3.3.3.2"><ci id="S2.SS1.p3.2.m2.3.3.3.2.1.cmml" xref="S2.SS1.p3.2.m2.3.3.3.2.1">^</ci><ci id="S2.SS1.p3.2.m2.3.3.3.2.2.cmml" xref="S2.SS1.p3.2.m2.3.3.3.2.2">𝑟</ci></apply><interval closure="open" id="S2.SS1.p3.2.m2.3.3.3.3.1.cmml" xref="S2.SS1.p3.2.m2.3.3.3.3.2"><ci id="S2.SS1.p3.2.m2.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1">𝑎</ci><ci id="S2.SS1.p3.2.m2.2.2.cmml" xref="S2.SS1.p3.2.m2.2.2">𝑥</ci></interval></apply><apply id="S2.SS1.p3.2.m2.3.3.1.cmml" xref="S2.SS1.p3.2.m2.3.3.1"><times id="S2.SS1.p3.2.m2.3.3.1.2.cmml" xref="S2.SS1.p3.2.m2.3.3.1.2"></times><ci id="S2.SS1.p3.2.m2.3.3.1.3.cmml" xref="S2.SS1.p3.2.m2.3.3.1.3">𝔼</ci><apply id="S2.SS1.p3.2.m2.3.3.1.1.2.cmml" xref="S2.SS1.p3.2.m2.3.3.1.1.1"><csymbol cd="latexml" id="S2.SS1.p3.2.m2.3.3.1.1.2.1.cmml" xref="S2.SS1.p3.2.m2.3.3.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS1.p3.2.m2.3.3.1.1.1.1.3.cmml" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p3.2.m2.3.3.1.1.1.1.3a.cmml" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1"><eq id="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.1"></eq><apply id="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.2.1">conditional</csymbol><ci id="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.2.2">𝑅</ci><ci id="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.2.3">𝑋</ci></apply><ci id="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.1.1.3">𝑥</ci></apply><apply id="S2.SS1.p3.2.m2.3.3.1.1.1.1.2.2.cmml" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.2.2"><eq id="S2.SS1.p3.2.m2.3.3.1.1.1.1.2.2.1.cmml" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.2.2.1"></eq><ci id="S2.SS1.p3.2.m2.3.3.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.2.2.2">𝐴</ci><ci id="S2.SS1.p3.2.m2.3.3.1.1.1.1.2.2.3.cmml" xref="S2.SS1.p3.2.m2.3.3.1.1.1.1.2.2.3">𝑎</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.2.m2.3c">\widehat{r}(a,x)\approx\mathbb{E}[R|X=x;A=a]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.2.m2.3d">over^ start_ARG italic_r end_ARG ( italic_a , italic_x ) ≈ blackboard_E [ italic_R | italic_X = italic_x ; italic_A = italic_a ]</annotation></semantics></math> and subtract it from the observed rewards <cite class="ltx_cite ltx_citemacro_citep">(Freedman, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib16" title="">2008</a>)</cite>.
This is at the heart of key RL techniques (i.a., generalised advantage estimation <cite class="ltx_cite ltx_citemacro_citep">(Schulman et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib55" title="">2016</a>)</cite>), and it underpins widely used methods to increase sensitivity in online controlled experiments <cite class="ltx_cite ltx_citemacro_citep">(Deng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib12" title="">2013</a>; Poyarkov et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib47" title="">2016</a>; Budylin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib7" title="">2018</a>; Baweja et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib2" title="">2024</a>)</cite>.
As such, it applies to both <em class="ltx_emph ltx_font_italic" id="S2.SS1.p3.4.1">evaluation</em> and <em class="ltx_emph ltx_font_italic" id="S2.SS1.p3.4.2">learning</em> tasks.
We note that if the model <math alttext="\widehat{r}(a,x)" class="ltx_Math" display="inline" id="S2.SS1.p3.3.m3.2"><semantics id="S2.SS1.p3.3.m3.2a"><mrow id="S2.SS1.p3.3.m3.2.3" xref="S2.SS1.p3.3.m3.2.3.cmml"><mover accent="true" id="S2.SS1.p3.3.m3.2.3.2" xref="S2.SS1.p3.3.m3.2.3.2.cmml"><mi id="S2.SS1.p3.3.m3.2.3.2.2" xref="S2.SS1.p3.3.m3.2.3.2.2.cmml">r</mi><mo id="S2.SS1.p3.3.m3.2.3.2.1" xref="S2.SS1.p3.3.m3.2.3.2.1.cmml">^</mo></mover><mo id="S2.SS1.p3.3.m3.2.3.1" xref="S2.SS1.p3.3.m3.2.3.1.cmml">⁢</mo><mrow id="S2.SS1.p3.3.m3.2.3.3.2" xref="S2.SS1.p3.3.m3.2.3.3.1.cmml"><mo id="S2.SS1.p3.3.m3.2.3.3.2.1" stretchy="false" xref="S2.SS1.p3.3.m3.2.3.3.1.cmml">(</mo><mi id="S2.SS1.p3.3.m3.1.1" xref="S2.SS1.p3.3.m3.1.1.cmml">a</mi><mo id="S2.SS1.p3.3.m3.2.3.3.2.2" xref="S2.SS1.p3.3.m3.2.3.3.1.cmml">,</mo><mi id="S2.SS1.p3.3.m3.2.2" xref="S2.SS1.p3.3.m3.2.2.cmml">x</mi><mo id="S2.SS1.p3.3.m3.2.3.3.2.3" stretchy="false" xref="S2.SS1.p3.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.3.m3.2b"><apply id="S2.SS1.p3.3.m3.2.3.cmml" xref="S2.SS1.p3.3.m3.2.3"><times id="S2.SS1.p3.3.m3.2.3.1.cmml" xref="S2.SS1.p3.3.m3.2.3.1"></times><apply id="S2.SS1.p3.3.m3.2.3.2.cmml" xref="S2.SS1.p3.3.m3.2.3.2"><ci id="S2.SS1.p3.3.m3.2.3.2.1.cmml" xref="S2.SS1.p3.3.m3.2.3.2.1">^</ci><ci id="S2.SS1.p3.3.m3.2.3.2.2.cmml" xref="S2.SS1.p3.3.m3.2.3.2.2">𝑟</ci></apply><interval closure="open" id="S2.SS1.p3.3.m3.2.3.3.1.cmml" xref="S2.SS1.p3.3.m3.2.3.3.2"><ci id="S2.SS1.p3.3.m3.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1">𝑎</ci><ci id="S2.SS1.p3.3.m3.2.2.cmml" xref="S2.SS1.p3.3.m3.2.2">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.3.m3.2c">\widehat{r}(a,x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.3.m3.2d">over^ start_ARG italic_r end_ARG ( italic_a , italic_x )</annotation></semantics></math> is biased, this bias propagates to the resulting estimator for <math alttext="V(\pi_{\theta})" class="ltx_Math" display="inline" id="S2.SS1.p3.4.m4.1"><semantics id="S2.SS1.p3.4.m4.1a"><mrow id="S2.SS1.p3.4.m4.1.1" xref="S2.SS1.p3.4.m4.1.1.cmml"><mi id="S2.SS1.p3.4.m4.1.1.3" xref="S2.SS1.p3.4.m4.1.1.3.cmml">V</mi><mo id="S2.SS1.p3.4.m4.1.1.2" xref="S2.SS1.p3.4.m4.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p3.4.m4.1.1.1.1" xref="S2.SS1.p3.4.m4.1.1.1.1.1.cmml"><mo id="S2.SS1.p3.4.m4.1.1.1.1.2" stretchy="false" xref="S2.SS1.p3.4.m4.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.p3.4.m4.1.1.1.1.1" xref="S2.SS1.p3.4.m4.1.1.1.1.1.cmml"><mi id="S2.SS1.p3.4.m4.1.1.1.1.1.2" xref="S2.SS1.p3.4.m4.1.1.1.1.1.2.cmml">π</mi><mi id="S2.SS1.p3.4.m4.1.1.1.1.1.3" xref="S2.SS1.p3.4.m4.1.1.1.1.1.3.cmml">θ</mi></msub><mo id="S2.SS1.p3.4.m4.1.1.1.1.3" stretchy="false" xref="S2.SS1.p3.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.4.m4.1b"><apply id="S2.SS1.p3.4.m4.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1"><times id="S2.SS1.p3.4.m4.1.1.2.cmml" xref="S2.SS1.p3.4.m4.1.1.2"></times><ci id="S2.SS1.p3.4.m4.1.1.3.cmml" xref="S2.SS1.p3.4.m4.1.1.3">𝑉</ci><apply id="S2.SS1.p3.4.m4.1.1.1.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.4.m4.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.4.m4.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.4.m4.1.1.1.1.1.2">𝜋</ci><ci id="S2.SS1.p3.4.m4.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.4.m4.1.1.1.1.1.3">𝜃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.4.m4.1c">V(\pi_{\theta})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.4.m4.1d">italic_V ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p4">
<p class="ltx_p" id="S2.SS1.p4.2">Alternatively, instead of focusing on reducing the variance of <math alttext="V(\pi_{\theta})" class="ltx_Math" display="inline" id="S2.SS1.p4.1.m1.1"><semantics id="S2.SS1.p4.1.m1.1a"><mrow id="S2.SS1.p4.1.m1.1.1" xref="S2.SS1.p4.1.m1.1.1.cmml"><mi id="S2.SS1.p4.1.m1.1.1.3" xref="S2.SS1.p4.1.m1.1.1.3.cmml">V</mi><mo id="S2.SS1.p4.1.m1.1.1.2" xref="S2.SS1.p4.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p4.1.m1.1.1.1.1" xref="S2.SS1.p4.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS1.p4.1.m1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p4.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.p4.1.m1.1.1.1.1.1" xref="S2.SS1.p4.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS1.p4.1.m1.1.1.1.1.1.2" xref="S2.SS1.p4.1.m1.1.1.1.1.1.2.cmml">π</mi><mi id="S2.SS1.p4.1.m1.1.1.1.1.1.3" xref="S2.SS1.p4.1.m1.1.1.1.1.1.3.cmml">θ</mi></msub><mo id="S2.SS1.p4.1.m1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.1b"><apply id="S2.SS1.p4.1.m1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1"><times id="S2.SS1.p4.1.m1.1.1.2.cmml" xref="S2.SS1.p4.1.m1.1.1.2"></times><ci id="S2.SS1.p4.1.m1.1.1.3.cmml" xref="S2.SS1.p4.1.m1.1.1.3">𝑉</ci><apply id="S2.SS1.p4.1.m1.1.1.1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p4.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS1.p4.1.m1.1.1.1.1.1.2">𝜋</ci><ci id="S2.SS1.p4.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS1.p4.1.m1.1.1.1.1.1.3">𝜃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.1c">V(\pi_{\theta})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.1.m1.1d">italic_V ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT )</annotation></semantics></math> directly, other often-used approaches tackle the variance of its gradient estimates <math alttext="\nabla_{\theta}(V(\pi_{\theta}))" class="ltx_Math" display="inline" id="S2.SS1.p4.2.m2.2"><semantics id="S2.SS1.p4.2.m2.2a"><mrow id="S2.SS1.p4.2.m2.2.2.2" xref="S2.SS1.p4.2.m2.2.2.3.cmml"><msub id="S2.SS1.p4.2.m2.1.1.1.1" xref="S2.SS1.p4.2.m2.1.1.1.1.cmml"><mo id="S2.SS1.p4.2.m2.1.1.1.1.2" xref="S2.SS1.p4.2.m2.1.1.1.1.2.cmml">∇</mo><mi id="S2.SS1.p4.2.m2.1.1.1.1.3" xref="S2.SS1.p4.2.m2.1.1.1.1.3.cmml">θ</mi></msub><mrow id="S2.SS1.p4.2.m2.2.2.2.2" xref="S2.SS1.p4.2.m2.2.2.3.cmml"><mo id="S2.SS1.p4.2.m2.2.2.2.2.2" stretchy="false" xref="S2.SS1.p4.2.m2.2.2.3.cmml">(</mo><mrow id="S2.SS1.p4.2.m2.2.2.2.2.1" xref="S2.SS1.p4.2.m2.2.2.2.2.1.cmml"><mi id="S2.SS1.p4.2.m2.2.2.2.2.1.3" xref="S2.SS1.p4.2.m2.2.2.2.2.1.3.cmml">V</mi><mo id="S2.SS1.p4.2.m2.2.2.2.2.1.2" xref="S2.SS1.p4.2.m2.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S2.SS1.p4.2.m2.2.2.2.2.1.1.1" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.1.1.cmml"><mo id="S2.SS1.p4.2.m2.2.2.2.2.1.1.1.2" stretchy="false" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.1.1.cmml">(</mo><msub id="S2.SS1.p4.2.m2.2.2.2.2.1.1.1.1" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.1.1.cmml"><mi id="S2.SS1.p4.2.m2.2.2.2.2.1.1.1.1.2" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.1.1.2.cmml">π</mi><mi id="S2.SS1.p4.2.m2.2.2.2.2.1.1.1.1.3" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.1.1.3.cmml">θ</mi></msub><mo id="S2.SS1.p4.2.m2.2.2.2.2.1.1.1.3" stretchy="false" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p4.2.m2.2.2.2.2.3" stretchy="false" xref="S2.SS1.p4.2.m2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.2.m2.2b"><apply id="S2.SS1.p4.2.m2.2.2.3.cmml" xref="S2.SS1.p4.2.m2.2.2.2"><apply id="S2.SS1.p4.2.m2.1.1.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.2.m2.1.1.1.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p4.2.m2.1.1.1.1.2.cmml" xref="S2.SS1.p4.2.m2.1.1.1.1.2">∇</ci><ci id="S2.SS1.p4.2.m2.1.1.1.1.3.cmml" xref="S2.SS1.p4.2.m2.1.1.1.1.3">𝜃</ci></apply><apply id="S2.SS1.p4.2.m2.2.2.2.2.1.cmml" xref="S2.SS1.p4.2.m2.2.2.2.2.1"><times id="S2.SS1.p4.2.m2.2.2.2.2.1.2.cmml" xref="S2.SS1.p4.2.m2.2.2.2.2.1.2"></times><ci id="S2.SS1.p4.2.m2.2.2.2.2.1.3.cmml" xref="S2.SS1.p4.2.m2.2.2.2.2.1.3">𝑉</ci><apply id="S2.SS1.p4.2.m2.2.2.2.2.1.1.1.1.cmml" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.2.m2.2.2.2.2.1.1.1.1.1.cmml" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p4.2.m2.2.2.2.2.1.1.1.1.2.cmml" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.1.1.2">𝜋</ci><ci id="S2.SS1.p4.2.m2.2.2.2.2.1.1.1.1.3.cmml" xref="S2.SS1.p4.2.m2.2.2.2.2.1.1.1.1.3">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.2.m2.2c">\nabla_{\theta}(V(\pi_{\theta}))</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.2.m2.2d">∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_V ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ) )</annotation></semantics></math> instead.</p>
</div>
<div class="ltx_para" id="S2.SS1.p5">
<p class="ltx_p" id="S2.SS1.p5.3">Observe that <math alttext="\mathop{\mathbb{E}}_{a\sim\pi_{\theta}(\cdot|x)}\left[\nabla_{\theta}\left(%
\log(\pi_{\theta}(a\mid x))\right)\right]=0" class="ltx_math_unparsed" display="inline" id="S2.SS1.p5.1.m1.2"><semantics id="S2.SS1.p5.1.m1.2a"><mrow id="S2.SS1.p5.1.m1.2.2"><mrow id="S2.SS1.p5.1.m1.2.2.1"><msub id="S2.SS1.p5.1.m1.2.2.1.2"><mo id="S2.SS1.p5.1.m1.2.2.1.2.2">𝔼</mo><mrow id="S2.SS1.p5.1.m1.2.2.1.2.3"><mi id="S2.SS1.p5.1.m1.2.2.1.2.3.1">a</mi><mo id="S2.SS1.p5.1.m1.2.2.1.2.3.2">∼</mo><msub id="S2.SS1.p5.1.m1.2.2.1.2.3.3"><mi id="S2.SS1.p5.1.m1.2.2.1.2.3.3.2">π</mi><mi id="S2.SS1.p5.1.m1.2.2.1.2.3.3.3">θ</mi></msub><mrow id="S2.SS1.p5.1.m1.2.2.1.2.3.4"><mo id="S2.SS1.p5.1.m1.2.2.1.2.3.4.1" stretchy="false">(</mo><mo id="S2.SS1.p5.1.m1.2.2.1.2.3.4.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S2.SS1.p5.1.m1.2.2.1.2.3.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="S2.SS1.p5.1.m1.2.2.1.2.3.4.4">x</mi><mo id="S2.SS1.p5.1.m1.2.2.1.2.3.4.5" stretchy="false">)</mo></mrow></mrow></msub><mrow id="S2.SS1.p5.1.m1.2.2.1.1.1"><mo id="S2.SS1.p5.1.m1.2.2.1.1.1.2" lspace="0em">[</mo><mrow id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2"><msub id="S2.SS1.p5.1.m1.2.2.1.1.1.1.1.1"><mo id="S2.SS1.p5.1.m1.2.2.1.1.1.1.1.1.2">∇</mo><mi id="S2.SS1.p5.1.m1.2.2.1.1.1.1.1.1.3">θ</mi></msub><mrow id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2.2"><mo id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2.2.2">(</mo><mrow id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2.2.1.1"><mi id="S2.SS1.p5.1.m1.1.1">log</mi><mo id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2.2.1.1a">⁡</mo><mrow id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2.2.1.1.1"><mo id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2.2.1.1.1.2" stretchy="false">(</mo><mrow id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2.2.1.1.1.1"><msub id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2.2.1.1.1.1.3"><mi id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2.2.1.1.1.1.3.2">π</mi><mi id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2.2.1.1.1.1.3.3">θ</mi></msub><mo id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2.2.1.1.1.1.2">⁢</mo><mrow id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1"><mo id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.2" stretchy="false">(</mo><mrow id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1"><mi id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.2">a</mi><mo id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1">∣</mo><mi id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.3">x</mi></mrow><mo id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mo id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2.2.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mo id="S2.SS1.p5.1.m1.2.2.1.1.1.1.2.2.3">)</mo></mrow></mrow><mo id="S2.SS1.p5.1.m1.2.2.1.1.1.3">]</mo></mrow></mrow><mo id="S2.SS1.p5.1.m1.2.2.2">=</mo><mn id="S2.SS1.p5.1.m1.2.2.3">0</mn></mrow><annotation encoding="application/x-tex" id="S2.SS1.p5.1.m1.2b">\mathop{\mathbb{E}}_{a\sim\pi_{\theta}(\cdot|x)}\left[\nabla_{\theta}\left(%
\log(\pi_{\theta}(a\mid x))\right)\right]=0</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.1.m1.2c">blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( ⋅ | italic_x ) end_POSTSUBSCRIPT [ ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( roman_log ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ∣ italic_x ) ) ) ] = 0</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Mohamed et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib45" title="">2020</a>, Eq. 12)</cite>.
This implies that a translation on the rewards in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2.E3" title="In 2.1. On-policy contextual bandits ‣ 2. Background and Related Work ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">3</span></a> does not affect the unbiasedness of the gradient estimate.
Nevertheless, as such a translation can be framed as an additive control variate, it will affect its variance.
Indeed, “<em class="ltx_emph ltx_font_italic" id="S2.SS1.p5.3.1">baseline corrections</em>” are a well-known variance reduction method for on-policy RL methods <cite class="ltx_cite ltx_citemacro_citep">(Greensmith et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib17" title="">2004</a>)</cite>.
For a dataset consisting of logged contexts, actions and rewards <math alttext="\mathcal{D}=\{(x_{i},a_{i},r_{i})_{i=1}^{N}\}" class="ltx_Math" display="inline" id="S2.SS1.p5.2.m2.1"><semantics id="S2.SS1.p5.2.m2.1a"><mrow id="S2.SS1.p5.2.m2.1.1" xref="S2.SS1.p5.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p5.2.m2.1.1.3" xref="S2.SS1.p5.2.m2.1.1.3.cmml">𝒟</mi><mo id="S2.SS1.p5.2.m2.1.1.2" xref="S2.SS1.p5.2.m2.1.1.2.cmml">=</mo><mrow id="S2.SS1.p5.2.m2.1.1.1.1" xref="S2.SS1.p5.2.m2.1.1.1.2.cmml"><mo id="S2.SS1.p5.2.m2.1.1.1.1.2" stretchy="false" xref="S2.SS1.p5.2.m2.1.1.1.2.cmml">{</mo><msubsup id="S2.SS1.p5.2.m2.1.1.1.1.1" xref="S2.SS1.p5.2.m2.1.1.1.1.1.cmml"><mrow id="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.3" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.4.cmml"><mo id="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.3.4" stretchy="false" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.4.cmml">(</mo><msub id="S2.SS1.p5.2.m2.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p5.2.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p5.2.m2.1.1.1.1.1.1.1.1.1.2" xref="S2.SS1.p5.2.m2.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.SS1.p5.2.m2.1.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p5.2.m2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.3.5" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.4.cmml">,</mo><msub id="S2.SS1.p5.2.m2.1.1.1.1.1.2.2.2.2" xref="S2.SS1.p5.2.m2.1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.SS1.p5.2.m2.1.1.1.1.1.2.2.2.2.2" xref="S2.SS1.p5.2.m2.1.1.1.1.1.2.2.2.2.2.cmml">a</mi><mi id="S2.SS1.p5.2.m2.1.1.1.1.1.2.2.2.2.3" xref="S2.SS1.p5.2.m2.1.1.1.1.1.2.2.2.2.3.cmml">i</mi></msub><mo id="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.3.6" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.4.cmml">,</mo><msub id="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.3.3" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.3.3.cmml"><mi id="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.3.3.2" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.3.3.2.cmml">r</mi><mi id="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.3.3.3" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.3.3.3.cmml">i</mi></msub><mo id="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.3.7" stretchy="false" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.4.cmml">)</mo></mrow><mrow id="S2.SS1.p5.2.m2.1.1.1.1.1.3.5" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.5.cmml"><mi id="S2.SS1.p5.2.m2.1.1.1.1.1.3.5.2" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.5.2.cmml">i</mi><mo id="S2.SS1.p5.2.m2.1.1.1.1.1.3.5.1" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.5.1.cmml">=</mo><mn id="S2.SS1.p5.2.m2.1.1.1.1.1.3.5.3" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.5.3.cmml">1</mn></mrow><mi id="S2.SS1.p5.2.m2.1.1.1.1.1.5" xref="S2.SS1.p5.2.m2.1.1.1.1.1.5.cmml">N</mi></msubsup><mo id="S2.SS1.p5.2.m2.1.1.1.1.3" stretchy="false" xref="S2.SS1.p5.2.m2.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.2.m2.1b"><apply id="S2.SS1.p5.2.m2.1.1.cmml" xref="S2.SS1.p5.2.m2.1.1"><eq id="S2.SS1.p5.2.m2.1.1.2.cmml" xref="S2.SS1.p5.2.m2.1.1.2"></eq><ci id="S2.SS1.p5.2.m2.1.1.3.cmml" xref="S2.SS1.p5.2.m2.1.1.3">𝒟</ci><set id="S2.SS1.p5.2.m2.1.1.1.2.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1"><apply id="S2.SS1.p5.2.m2.1.1.1.1.1.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.2.m2.1.1.1.1.1.4.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1">superscript</csymbol><apply id="S2.SS1.p5.2.m2.1.1.1.1.1.3.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.2.m2.1.1.1.1.1.3.4.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1">subscript</csymbol><vector id="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.4.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.3"><apply id="S2.SS1.p5.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.2.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p5.2.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.SS1.p5.2.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.SS1.p5.2.m2.1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p5.2.m2.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p5.2.m2.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1.2.2.2.2.2">𝑎</ci><ci id="S2.SS1.p5.2.m2.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply><apply id="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.3.3.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.3.3.1.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.3.3.2.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.3.3.2">𝑟</ci><ci id="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.3.3.3.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.3.3.3.3">𝑖</ci></apply></vector><apply id="S2.SS1.p5.2.m2.1.1.1.1.1.3.5.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.5"><eq id="S2.SS1.p5.2.m2.1.1.1.1.1.3.5.1.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.5.1"></eq><ci id="S2.SS1.p5.2.m2.1.1.1.1.1.3.5.2.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.5.2">𝑖</ci><cn id="S2.SS1.p5.2.m2.1.1.1.1.1.3.5.3.cmml" type="integer" xref="S2.SS1.p5.2.m2.1.1.1.1.1.3.5.3">1</cn></apply></apply><ci id="S2.SS1.p5.2.m2.1.1.1.1.1.5.cmml" xref="S2.SS1.p5.2.m2.1.1.1.1.1.5">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.2.m2.1c">\mathcal{D}=\{(x_{i},a_{i},r_{i})_{i=1}^{N}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.2.m2.1d">caligraphic_D = { ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT }</annotation></semantics></math>, we apply a <em class="ltx_emph ltx_font_italic" id="S2.SS1.p5.3.2">baseline</em> control variate <math alttext="\beta" class="ltx_Math" display="inline" id="S2.SS1.p5.3.m3.1"><semantics id="S2.SS1.p5.3.m3.1a"><mi id="S2.SS1.p5.3.m3.1.1" xref="S2.SS1.p5.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.3.m3.1b"><ci id="S2.SS1.p5.3.m3.1.1.cmml" xref="S2.SS1.p5.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.3.m3.1d">italic_β</annotation></semantics></math> to the estimate of the final gradient to obtain:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\nabla_{\theta}(V(\pi_{\theta}))&amp;\approx\widehat{\nabla_{\theta}(%
V_{\beta}(\pi_{\theta}))}\\
&amp;=\frac{1}{\left|\mathcal{D}\right|}\sum_{(x,a,r)\in\mathcal{D}}(r-\beta)%
\nabla_{\theta}\log\pi_{\theta}(a\mid x).\end{split}" class="ltx_Math" display="block" id="S2.E4.m1.35"><semantics id="S2.E4.m1.35a"><mtable columnspacing="0pt" displaystyle="true" id="S2.E4.m1.35.35.4" rowspacing="0pt"><mtr id="S2.E4.m1.35.35.4a"><mtd class="ltx_align_right" columnalign="right" id="S2.E4.m1.35.35.4b"><mrow id="S2.E4.m1.34.34.3.33.13.11.11"><msub id="S2.E4.m1.33.33.2.32.12.10.10.1"><mo id="S2.E4.m1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.cmml">∇</mo><mi id="S2.E4.m1.2.2.2.2.2.2.1" xref="S2.E4.m1.2.2.2.2.2.2.1.cmml">θ</mi></msub><mrow id="S2.E4.m1.34.34.3.33.13.11.11.2"><mo id="S2.E4.m1.3.3.3.3.3.3" stretchy="false" xref="S2.E4.m1.32.32.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.34.34.3.33.13.11.11.2.1"><mi id="S2.E4.m1.4.4.4.4.4.4" xref="S2.E4.m1.4.4.4.4.4.4.cmml">V</mi><mo id="S2.E4.m1.34.34.3.33.13.11.11.2.1.2" xref="S2.E4.m1.32.32.1.1.1.cmml">⁢</mo><mrow id="S2.E4.m1.34.34.3.33.13.11.11.2.1.1.1"><mo id="S2.E4.m1.5.5.5.5.5.5" stretchy="false" xref="S2.E4.m1.32.32.1.1.1.cmml">(</mo><msub id="S2.E4.m1.34.34.3.33.13.11.11.2.1.1.1.1"><mi id="S2.E4.m1.6.6.6.6.6.6" xref="S2.E4.m1.6.6.6.6.6.6.cmml">π</mi><mi id="S2.E4.m1.7.7.7.7.7.7.1" xref="S2.E4.m1.7.7.7.7.7.7.1.cmml">θ</mi></msub><mo id="S2.E4.m1.8.8.8.8.8.8" stretchy="false" xref="S2.E4.m1.32.32.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.9.9.9.9.9.9" stretchy="false" xref="S2.E4.m1.32.32.1.1.1.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E4.m1.35.35.4c"><mrow id="S2.E4.m1.11.11.11.11.2"><mi id="S2.E4.m1.11.11.11.11.2.3" xref="S2.E4.m1.32.32.1.1.1.cmml"></mi><mo id="S2.E4.m1.10.10.10.10.1.1" xref="S2.E4.m1.10.10.10.10.1.1.cmml">≈</mo><mover accent="true" id="S2.E4.m1.11.11.11.11.2.2" xref="S2.E4.m1.11.11.11.11.2.2.cmml"><mrow id="S2.E4.m1.11.11.11.11.2.2.2.2" xref="S2.E4.m1.11.11.11.11.2.2.2.3.cmml"><msub id="S2.E4.m1.11.11.11.11.2.2.1.1.1" xref="S2.E4.m1.11.11.11.11.2.2.1.1.1.cmml"><mo id="S2.E4.m1.11.11.11.11.2.2.1.1.1.2" xref="S2.E4.m1.11.11.11.11.2.2.1.1.1.2.cmml">∇</mo><mi id="S2.E4.m1.11.11.11.11.2.2.1.1.1.3" xref="S2.E4.m1.11.11.11.11.2.2.1.1.1.3.cmml">θ</mi></msub><mrow id="S2.E4.m1.11.11.11.11.2.2.2.2.2" xref="S2.E4.m1.11.11.11.11.2.2.2.3.cmml"><mo id="S2.E4.m1.11.11.11.11.2.2.2.2.2.2" stretchy="false" xref="S2.E4.m1.11.11.11.11.2.2.2.3.cmml">(</mo><mrow id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.cmml"><msub id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.3" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.3.cmml"><mi id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.3.2" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.3.2.cmml">V</mi><mi id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.3.3" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.3.3.cmml">β</mi></msub><mo id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.2" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.1.1" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.1.1.1.cmml"><mo id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.1.1.2" stretchy="false" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.1.1.1.cmml">(</mo><msub id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.1.1.1" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.1.1.1.cmml"><mi id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.1.1.1.2" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.1.1.1.2.cmml">π</mi><mi id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.1.1.1.3" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.1.1.1.3.cmml">θ</mi></msub><mo id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.1.1.3" stretchy="false" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.11.11.11.11.2.2.2.2.2.3" stretchy="false" xref="S2.E4.m1.11.11.11.11.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.11.11.11.11.2.2.3" xref="S2.E4.m1.11.11.11.11.2.2.3.cmml">^</mo></mover></mrow></mtd></mtr><mtr id="S2.E4.m1.35.35.4d"><mtd id="S2.E4.m1.35.35.4e" xref="S2.E4.m1.32.32.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E4.m1.35.35.4f"><mrow id="S2.E4.m1.35.35.4.34.21.21.21"><mrow id="S2.E4.m1.35.35.4.34.21.21.21.1"><mi id="S2.E4.m1.35.35.4.34.21.21.21.1.3" xref="S2.E4.m1.32.32.1.1.1.cmml"></mi><mo id="S2.E4.m1.12.12.12.1.1.1" xref="S2.E4.m1.12.12.12.1.1.1.cmml">=</mo><mrow id="S2.E4.m1.35.35.4.34.21.21.21.1.2"><mfrac id="S2.E4.m1.13.13.13.2.2.2" xref="S2.E4.m1.13.13.13.2.2.2.cmml"><mn id="S2.E4.m1.13.13.13.2.2.2.3" xref="S2.E4.m1.13.13.13.2.2.2.3.cmml">1</mn><mrow id="S2.E4.m1.13.13.13.2.2.2.1.3" xref="S2.E4.m1.13.13.13.2.2.2.1.2.cmml"><mo id="S2.E4.m1.13.13.13.2.2.2.1.3.1" xref="S2.E4.m1.13.13.13.2.2.2.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.13.13.13.2.2.2.1.1" xref="S2.E4.m1.13.13.13.2.2.2.1.1.cmml">𝒟</mi><mo id="S2.E4.m1.13.13.13.2.2.2.1.3.2" xref="S2.E4.m1.13.13.13.2.2.2.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S2.E4.m1.35.35.4.34.21.21.21.1.2.3" xref="S2.E4.m1.32.32.1.1.1.cmml">⁢</mo><mrow id="S2.E4.m1.35.35.4.34.21.21.21.1.2.2"><munder id="S2.E4.m1.35.35.4.34.21.21.21.1.2.2.3"><mo id="S2.E4.m1.14.14.14.3.3.3" movablelimits="false" rspace="0em" xref="S2.E4.m1.14.14.14.3.3.3.cmml">∑</mo><mrow id="S2.E4.m1.15.15.15.4.4.4.1" xref="S2.E4.m1.15.15.15.4.4.4.1.cmml"><mrow id="S2.E4.m1.15.15.15.4.4.4.1.5.2" xref="S2.E4.m1.15.15.15.4.4.4.1.5.1.cmml"><mo id="S2.E4.m1.15.15.15.4.4.4.1.5.2.1" stretchy="false" xref="S2.E4.m1.15.15.15.4.4.4.1.5.1.cmml">(</mo><mi id="S2.E4.m1.15.15.15.4.4.4.1.1" xref="S2.E4.m1.15.15.15.4.4.4.1.1.cmml">x</mi><mo id="S2.E4.m1.15.15.15.4.4.4.1.5.2.2" xref="S2.E4.m1.15.15.15.4.4.4.1.5.1.cmml">,</mo><mi id="S2.E4.m1.15.15.15.4.4.4.1.2" xref="S2.E4.m1.15.15.15.4.4.4.1.2.cmml">a</mi><mo id="S2.E4.m1.15.15.15.4.4.4.1.5.2.3" xref="S2.E4.m1.15.15.15.4.4.4.1.5.1.cmml">,</mo><mi id="S2.E4.m1.15.15.15.4.4.4.1.3" xref="S2.E4.m1.15.15.15.4.4.4.1.3.cmml">r</mi><mo id="S2.E4.m1.15.15.15.4.4.4.1.5.2.4" stretchy="false" xref="S2.E4.m1.15.15.15.4.4.4.1.5.1.cmml">)</mo></mrow><mo id="S2.E4.m1.15.15.15.4.4.4.1.4" xref="S2.E4.m1.15.15.15.4.4.4.1.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.15.15.15.4.4.4.1.6" xref="S2.E4.m1.15.15.15.4.4.4.1.6.cmml">𝒟</mi></mrow></munder><mrow id="S2.E4.m1.35.35.4.34.21.21.21.1.2.2.2"><mrow id="S2.E4.m1.35.35.4.34.21.21.21.1.1.1.1.1.1"><mo id="S2.E4.m1.16.16.16.5.5.5" stretchy="false" xref="S2.E4.m1.32.32.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.35.35.4.34.21.21.21.1.1.1.1.1.1.1"><mi id="S2.E4.m1.17.17.17.6.6.6" xref="S2.E4.m1.17.17.17.6.6.6.cmml">r</mi><mo id="S2.E4.m1.18.18.18.7.7.7" xref="S2.E4.m1.18.18.18.7.7.7.cmml">−</mo><mi id="S2.E4.m1.19.19.19.8.8.8" xref="S2.E4.m1.19.19.19.8.8.8.cmml">β</mi></mrow><mo id="S2.E4.m1.20.20.20.9.9.9" stretchy="false" xref="S2.E4.m1.32.32.1.1.1.cmml">)</mo></mrow><mo id="S2.E4.m1.35.35.4.34.21.21.21.1.2.2.2.3" lspace="0.167em" xref="S2.E4.m1.32.32.1.1.1.cmml">⁢</mo><mrow id="S2.E4.m1.35.35.4.34.21.21.21.1.2.2.2.4"><mrow id="S2.E4.m1.35.35.4.34.21.21.21.1.2.2.2.4.1"><msub id="S2.E4.m1.35.35.4.34.21.21.21.1.2.2.2.4.1.1"><mo id="S2.E4.m1.21.21.21.10.10.10" rspace="0.167em" xref="S2.E4.m1.21.21.21.10.10.10.cmml">∇</mo><mi id="S2.E4.m1.22.22.22.11.11.11.1" xref="S2.E4.m1.22.22.22.11.11.11.1.cmml">θ</mi></msub><mi id="S2.E4.m1.23.23.23.12.12.12" xref="S2.E4.m1.23.23.23.12.12.12.cmml">log</mi></mrow><mo id="S2.E4.m1.35.35.4.34.21.21.21.1.2.2.2.4a" lspace="0.167em" xref="S2.E4.m1.32.32.1.1.1.cmml">⁡</mo><msub id="S2.E4.m1.35.35.4.34.21.21.21.1.2.2.2.4.2"><mi id="S2.E4.m1.24.24.24.13.13.13" xref="S2.E4.m1.24.24.24.13.13.13.cmml">π</mi><mi id="S2.E4.m1.25.25.25.14.14.14.1" xref="S2.E4.m1.25.25.25.14.14.14.1.cmml">θ</mi></msub></mrow><mo id="S2.E4.m1.35.35.4.34.21.21.21.1.2.2.2.3a" xref="S2.E4.m1.32.32.1.1.1.cmml">⁢</mo><mrow id="S2.E4.m1.35.35.4.34.21.21.21.1.2.2.2.2.1"><mo id="S2.E4.m1.26.26.26.15.15.15" stretchy="false" xref="S2.E4.m1.32.32.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.35.35.4.34.21.21.21.1.2.2.2.2.1.1"><mi id="S2.E4.m1.27.27.27.16.16.16" xref="S2.E4.m1.27.27.27.16.16.16.cmml">a</mi><mo id="S2.E4.m1.28.28.28.17.17.17" xref="S2.E4.m1.28.28.28.17.17.17.cmml">∣</mo><mi id="S2.E4.m1.29.29.29.18.18.18" xref="S2.E4.m1.29.29.29.18.18.18.cmml">x</mi></mrow><mo id="S2.E4.m1.30.30.30.19.19.19" stretchy="false" xref="S2.E4.m1.32.32.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E4.m1.31.31.31.20.20.20" lspace="0em" xref="S2.E4.m1.32.32.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S2.E4.m1.35b"><apply id="S2.E4.m1.32.32.1.1.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3"><and id="S2.E4.m1.32.32.1.1.1a.cmml" xref="S2.E4.m1.3.3.3.3.3.3"></and><apply id="S2.E4.m1.32.32.1.1.1b.cmml" xref="S2.E4.m1.3.3.3.3.3.3"><approx id="S2.E4.m1.10.10.10.10.1.1.cmml" xref="S2.E4.m1.10.10.10.10.1.1"></approx><apply id="S2.E4.m1.32.32.1.1.1.2.3.cmml" xref="S2.E4.m1.3.3.3.3.3.3"><apply id="S2.E4.m1.32.32.1.1.1.1.1.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.32.32.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1">∇</ci><ci id="S2.E4.m1.2.2.2.2.2.2.1.cmml" xref="S2.E4.m1.2.2.2.2.2.2.1">𝜃</ci></apply><apply id="S2.E4.m1.32.32.1.1.1.2.2.2.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3"><times id="S2.E4.m1.32.32.1.1.1.2.2.2.1.2.cmml" xref="S2.E4.m1.3.3.3.3.3.3"></times><ci id="S2.E4.m1.4.4.4.4.4.4.cmml" xref="S2.E4.m1.4.4.4.4.4.4">𝑉</ci><apply id="S2.E4.m1.32.32.1.1.1.2.2.2.1.1.1.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.32.32.1.1.1.2.2.2.1.1.1.1.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3">subscript</csymbol><ci id="S2.E4.m1.6.6.6.6.6.6.cmml" xref="S2.E4.m1.6.6.6.6.6.6">𝜋</ci><ci id="S2.E4.m1.7.7.7.7.7.7.1.cmml" xref="S2.E4.m1.7.7.7.7.7.7.1">𝜃</ci></apply></apply></apply><apply id="S2.E4.m1.11.11.11.11.2.2.cmml" xref="S2.E4.m1.11.11.11.11.2.2"><ci id="S2.E4.m1.11.11.11.11.2.2.3.cmml" xref="S2.E4.m1.11.11.11.11.2.2.3">^</ci><apply id="S2.E4.m1.11.11.11.11.2.2.2.3.cmml" xref="S2.E4.m1.11.11.11.11.2.2.2.2"><apply id="S2.E4.m1.11.11.11.11.2.2.1.1.1.cmml" xref="S2.E4.m1.11.11.11.11.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.11.11.11.11.2.2.1.1.1.1.cmml" xref="S2.E4.m1.11.11.11.11.2.2.1.1.1">subscript</csymbol><ci id="S2.E4.m1.11.11.11.11.2.2.1.1.1.2.cmml" xref="S2.E4.m1.11.11.11.11.2.2.1.1.1.2">∇</ci><ci id="S2.E4.m1.11.11.11.11.2.2.1.1.1.3.cmml" xref="S2.E4.m1.11.11.11.11.2.2.1.1.1.3">𝜃</ci></apply><apply id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.cmml" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1"><times id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.2.cmml" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.2"></times><apply id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.3.cmml" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.3.1.cmml" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.3">subscript</csymbol><ci id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.3.2.cmml" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.3.2">𝑉</ci><ci id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.3.3.cmml" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.3.3">𝛽</ci></apply><apply id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.1.1.1.1.cmml" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.1.1.1.2.cmml" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.1.1.1.2">𝜋</ci><ci id="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.1.1.1.3.cmml" xref="S2.E4.m1.11.11.11.11.2.2.2.2.2.1.1.1.1.3">𝜃</ci></apply></apply></apply></apply></apply><apply id="S2.E4.m1.32.32.1.1.1c.cmml" xref="S2.E4.m1.3.3.3.3.3.3"><eq id="S2.E4.m1.12.12.12.1.1.1.cmml" xref="S2.E4.m1.12.12.12.1.1.1"></eq><share href="https://arxiv.org/html/2405.05736v2#S2.E4.m1.32.32.1.1.1.7.cmml" id="S2.E4.m1.32.32.1.1.1d.cmml" xref="S2.E4.m1.3.3.3.3.3.3"></share><apply id="S2.E4.m1.32.32.1.1.1.4.cmml" xref="S2.E4.m1.3.3.3.3.3.3"><times id="S2.E4.m1.32.32.1.1.1.4.3.cmml" xref="S2.E4.m1.3.3.3.3.3.3"></times><apply id="S2.E4.m1.13.13.13.2.2.2.cmml" xref="S2.E4.m1.13.13.13.2.2.2"><divide id="S2.E4.m1.13.13.13.2.2.2.2.cmml" xref="S2.E4.m1.13.13.13.2.2.2"></divide><cn id="S2.E4.m1.13.13.13.2.2.2.3.cmml" type="integer" xref="S2.E4.m1.13.13.13.2.2.2.3">1</cn><apply id="S2.E4.m1.13.13.13.2.2.2.1.2.cmml" xref="S2.E4.m1.13.13.13.2.2.2.1.3"><abs id="S2.E4.m1.13.13.13.2.2.2.1.2.1.cmml" xref="S2.E4.m1.13.13.13.2.2.2.1.3.1"></abs><ci id="S2.E4.m1.13.13.13.2.2.2.1.1.cmml" xref="S2.E4.m1.13.13.13.2.2.2.1.1">𝒟</ci></apply></apply><apply id="S2.E4.m1.32.32.1.1.1.4.2.cmml" xref="S2.E4.m1.3.3.3.3.3.3"><apply id="S2.E4.m1.32.32.1.1.1.4.2.3.cmml" xref="S2.E4.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.32.32.1.1.1.4.2.3.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3">subscript</csymbol><sum id="S2.E4.m1.14.14.14.3.3.3.cmml" xref="S2.E4.m1.14.14.14.3.3.3"></sum><apply id="S2.E4.m1.15.15.15.4.4.4.1.cmml" xref="S2.E4.m1.15.15.15.4.4.4.1"><in id="S2.E4.m1.15.15.15.4.4.4.1.4.cmml" xref="S2.E4.m1.15.15.15.4.4.4.1.4"></in><vector id="S2.E4.m1.15.15.15.4.4.4.1.5.1.cmml" xref="S2.E4.m1.15.15.15.4.4.4.1.5.2"><ci id="S2.E4.m1.15.15.15.4.4.4.1.1.cmml" xref="S2.E4.m1.15.15.15.4.4.4.1.1">𝑥</ci><ci id="S2.E4.m1.15.15.15.4.4.4.1.2.cmml" xref="S2.E4.m1.15.15.15.4.4.4.1.2">𝑎</ci><ci id="S2.E4.m1.15.15.15.4.4.4.1.3.cmml" xref="S2.E4.m1.15.15.15.4.4.4.1.3">𝑟</ci></vector><ci id="S2.E4.m1.15.15.15.4.4.4.1.6.cmml" xref="S2.E4.m1.15.15.15.4.4.4.1.6">𝒟</ci></apply></apply><apply id="S2.E4.m1.32.32.1.1.1.4.2.2.cmml" xref="S2.E4.m1.3.3.3.3.3.3"><times id="S2.E4.m1.32.32.1.1.1.4.2.2.3.cmml" xref="S2.E4.m1.3.3.3.3.3.3"></times><apply id="S2.E4.m1.32.32.1.1.1.3.1.1.1.1.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3"><minus id="S2.E4.m1.18.18.18.7.7.7.cmml" xref="S2.E4.m1.18.18.18.7.7.7"></minus><ci id="S2.E4.m1.17.17.17.6.6.6.cmml" xref="S2.E4.m1.17.17.17.6.6.6">𝑟</ci><ci id="S2.E4.m1.19.19.19.8.8.8.cmml" xref="S2.E4.m1.19.19.19.8.8.8">𝛽</ci></apply><apply id="S2.E4.m1.32.32.1.1.1.4.2.2.4.cmml" xref="S2.E4.m1.3.3.3.3.3.3"><apply id="S2.E4.m1.32.32.1.1.1.4.2.2.4.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3"><apply id="S2.E4.m1.32.32.1.1.1.4.2.2.4.1.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.32.32.1.1.1.4.2.2.4.1.1.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3">subscript</csymbol><ci id="S2.E4.m1.21.21.21.10.10.10.cmml" xref="S2.E4.m1.21.21.21.10.10.10">∇</ci><ci id="S2.E4.m1.22.22.22.11.11.11.1.cmml" xref="S2.E4.m1.22.22.22.11.11.11.1">𝜃</ci></apply><log id="S2.E4.m1.23.23.23.12.12.12.cmml" xref="S2.E4.m1.23.23.23.12.12.12"></log></apply><apply id="S2.E4.m1.32.32.1.1.1.4.2.2.4.2.cmml" xref="S2.E4.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.32.32.1.1.1.4.2.2.4.2.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3">subscript</csymbol><ci id="S2.E4.m1.24.24.24.13.13.13.cmml" xref="S2.E4.m1.24.24.24.13.13.13">𝜋</ci><ci id="S2.E4.m1.25.25.25.14.14.14.1.cmml" xref="S2.E4.m1.25.25.25.14.14.14.1">𝜃</ci></apply></apply><apply id="S2.E4.m1.32.32.1.1.1.4.2.2.2.1.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3"><csymbol cd="latexml" id="S2.E4.m1.28.28.28.17.17.17.cmml" xref="S2.E4.m1.28.28.28.17.17.17">conditional</csymbol><ci id="S2.E4.m1.27.27.27.16.16.16.cmml" xref="S2.E4.m1.27.27.27.16.16.16">𝑎</ci><ci id="S2.E4.m1.29.29.29.18.18.18.cmml" xref="S2.E4.m1.29.29.29.18.18.18">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.35c">\begin{split}\nabla_{\theta}(V(\pi_{\theta}))&amp;\approx\widehat{\nabla_{\theta}(%
V_{\beta}(\pi_{\theta}))}\\
&amp;=\frac{1}{\left|\mathcal{D}\right|}\sum_{(x,a,r)\in\mathcal{D}}(r-\beta)%
\nabla_{\theta}\log\pi_{\theta}(a\mid x).\end{split}</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.35d">start_ROW start_CELL ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_V ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ) ) end_CELL start_CELL ≈ over^ start_ARG ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_V start_POSTSUBSCRIPT italic_β end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ) ) end_ARG end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL = divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) ∈ caligraphic_D end_POSTSUBSCRIPT ( italic_r - italic_β ) ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT roman_log italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ∣ italic_x ) . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p5.4"><cite class="ltx_cite ltx_citemacro_citet">Williams (<a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib66" title="">1988</a>)</cite> originally proposed to use the average observed reward for <math alttext="\beta" class="ltx_Math" display="inline" id="S2.SS1.p5.4.m1.1"><semantics id="S2.SS1.p5.4.m1.1a"><mi id="S2.SS1.p5.4.m1.1.1" xref="S2.SS1.p5.4.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.4.m1.1b"><ci id="S2.SS1.p5.4.m1.1.1.cmml" xref="S2.SS1.p5.4.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.4.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.4.m1.1d">italic_β</annotation></semantics></math>. Subsequent work has derived optimal baselines for general on-policy RL scenarios <cite class="ltx_cite ltx_citemacro_citep">(Dayan, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib11" title="">1991</a>; Greensmith et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib17" title="">2004</a>)</cite>.
However, to the best of our knowledge, <em class="ltx_emph ltx_font_italic" id="S2.SS1.p5.4.1">optimal baselines for on-policy contextual bandits have not been considered in previous work</em>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p6">
<p class="ltx_p" id="S2.SS1.p6.1"><span class="ltx_text ltx_font_bold" id="S2.SS1.p6.1.1">Optimal baseline for on-policy bandits.</span>
The optimal baseline <math alttext="\beta" class="ltx_Math" display="inline" id="S2.SS1.p6.1.m1.1"><semantics id="S2.SS1.p6.1.m1.1a"><mi id="S2.SS1.p6.1.m1.1.1" xref="S2.SS1.p6.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.1.m1.1b"><ci id="S2.SS1.p6.1.m1.1.1.cmml" xref="S2.SS1.p6.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.1.m1.1d">italic_β</annotation></semantics></math> for the on-policy gradient estimate in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2.E4" title="In 2.1. On-policy contextual bandits ‣ 2. Background and Related Work ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">4</span></a> is the one that minimizes the variance of the gradient estimate.
In accordance with earlier work <cite class="ltx_cite ltx_citemacro_citep">(Greensmith et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib17" title="">2004</a>)</cite>,
we define the variance of a vector random variable as the sum of the variance of its individual components.
Therefore, the optimal baseline is given by:
</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Ax1.EGx2">
<tbody id="S2.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\operatorname*{arg\,min}_{\beta}\mathrm{Var}\left(\widehat{\nabla%
_{\theta}(V_{\beta}(\pi_{\theta}))}\right)" class="ltx_Math" display="inline" id="S2.Ex5.m1.2"><semantics id="S2.Ex5.m1.2a"><mrow id="S2.Ex5.m1.2.3" xref="S2.Ex5.m1.2.3.cmml"><mrow id="S2.Ex5.m1.2.3.2" xref="S2.Ex5.m1.2.3.2.cmml"><munder id="S2.Ex5.m1.2.3.2.1" xref="S2.Ex5.m1.2.3.2.1.cmml"><mrow id="S2.Ex5.m1.2.3.2.1.2" xref="S2.Ex5.m1.2.3.2.1.2.cmml"><mi id="S2.Ex5.m1.2.3.2.1.2.2" xref="S2.Ex5.m1.2.3.2.1.2.2.cmml">arg</mi><mo id="S2.Ex5.m1.2.3.2.1.2.1" lspace="0.170em" xref="S2.Ex5.m1.2.3.2.1.2.1.cmml">⁢</mo><mi id="S2.Ex5.m1.2.3.2.1.2.3" xref="S2.Ex5.m1.2.3.2.1.2.3.cmml">min</mi></mrow><mi id="S2.Ex5.m1.2.3.2.1.3" xref="S2.Ex5.m1.2.3.2.1.3.cmml">β</mi></munder><mo id="S2.Ex5.m1.2.3.2a" lspace="0.167em" xref="S2.Ex5.m1.2.3.2.cmml">⁡</mo><mi id="S2.Ex5.m1.2.3.2.2" xref="S2.Ex5.m1.2.3.2.2.cmml">Var</mi></mrow><mo id="S2.Ex5.m1.2.3.1" xref="S2.Ex5.m1.2.3.1.cmml">⁢</mo><mrow id="S2.Ex5.m1.2.3.3.2" xref="S2.Ex5.m1.2.2.cmml"><mo id="S2.Ex5.m1.2.3.3.2.1" xref="S2.Ex5.m1.2.2.cmml">(</mo><mover accent="true" id="S2.Ex5.m1.2.2" xref="S2.Ex5.m1.2.2.cmml"><mrow id="S2.Ex5.m1.2.2.2.2" xref="S2.Ex5.m1.2.2.2.3.cmml"><msub id="S2.Ex5.m1.1.1.1.1.1" xref="S2.Ex5.m1.1.1.1.1.1.cmml"><mo id="S2.Ex5.m1.1.1.1.1.1.2" xref="S2.Ex5.m1.1.1.1.1.1.2.cmml">∇</mo><mi id="S2.Ex5.m1.1.1.1.1.1.3" xref="S2.Ex5.m1.1.1.1.1.1.3.cmml">θ</mi></msub><mrow id="S2.Ex5.m1.2.2.2.2.2" xref="S2.Ex5.m1.2.2.2.3.cmml"><mo id="S2.Ex5.m1.2.2.2.2.2.2" stretchy="false" xref="S2.Ex5.m1.2.2.2.3.cmml">(</mo><mrow id="S2.Ex5.m1.2.2.2.2.2.1" xref="S2.Ex5.m1.2.2.2.2.2.1.cmml"><msub id="S2.Ex5.m1.2.2.2.2.2.1.3" xref="S2.Ex5.m1.2.2.2.2.2.1.3.cmml"><mi id="S2.Ex5.m1.2.2.2.2.2.1.3.2" xref="S2.Ex5.m1.2.2.2.2.2.1.3.2.cmml">V</mi><mi id="S2.Ex5.m1.2.2.2.2.2.1.3.3" xref="S2.Ex5.m1.2.2.2.2.2.1.3.3.cmml">β</mi></msub><mo id="S2.Ex5.m1.2.2.2.2.2.1.2" xref="S2.Ex5.m1.2.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S2.Ex5.m1.2.2.2.2.2.1.1.1" xref="S2.Ex5.m1.2.2.2.2.2.1.1.1.1.cmml"><mo id="S2.Ex5.m1.2.2.2.2.2.1.1.1.2" stretchy="false" xref="S2.Ex5.m1.2.2.2.2.2.1.1.1.1.cmml">(</mo><msub id="S2.Ex5.m1.2.2.2.2.2.1.1.1.1" xref="S2.Ex5.m1.2.2.2.2.2.1.1.1.1.cmml"><mi id="S2.Ex5.m1.2.2.2.2.2.1.1.1.1.2" xref="S2.Ex5.m1.2.2.2.2.2.1.1.1.1.2.cmml">π</mi><mi id="S2.Ex5.m1.2.2.2.2.2.1.1.1.1.3" xref="S2.Ex5.m1.2.2.2.2.2.1.1.1.1.3.cmml">θ</mi></msub><mo id="S2.Ex5.m1.2.2.2.2.2.1.1.1.3" stretchy="false" xref="S2.Ex5.m1.2.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex5.m1.2.2.2.2.2.3" stretchy="false" xref="S2.Ex5.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.Ex5.m1.2.2.3" xref="S2.Ex5.m1.2.2.3.cmml">^</mo></mover><mo id="S2.Ex5.m1.2.3.3.2.2" xref="S2.Ex5.m1.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex5.m1.2b"><apply id="S2.Ex5.m1.2.3.cmml" xref="S2.Ex5.m1.2.3"><times id="S2.Ex5.m1.2.3.1.cmml" xref="S2.Ex5.m1.2.3.1"></times><apply id="S2.Ex5.m1.2.3.2.cmml" xref="S2.Ex5.m1.2.3.2"><apply id="S2.Ex5.m1.2.3.2.1.cmml" xref="S2.Ex5.m1.2.3.2.1"><csymbol cd="ambiguous" id="S2.Ex5.m1.2.3.2.1.1.cmml" xref="S2.Ex5.m1.2.3.2.1">subscript</csymbol><apply id="S2.Ex5.m1.2.3.2.1.2.cmml" xref="S2.Ex5.m1.2.3.2.1.2"><times id="S2.Ex5.m1.2.3.2.1.2.1.cmml" xref="S2.Ex5.m1.2.3.2.1.2.1"></times><ci id="S2.Ex5.m1.2.3.2.1.2.2.cmml" xref="S2.Ex5.m1.2.3.2.1.2.2">arg</ci><ci id="S2.Ex5.m1.2.3.2.1.2.3.cmml" xref="S2.Ex5.m1.2.3.2.1.2.3">min</ci></apply><ci id="S2.Ex5.m1.2.3.2.1.3.cmml" xref="S2.Ex5.m1.2.3.2.1.3">𝛽</ci></apply><ci id="S2.Ex5.m1.2.3.2.2.cmml" xref="S2.Ex5.m1.2.3.2.2">Var</ci></apply><apply id="S2.Ex5.m1.2.2.cmml" xref="S2.Ex5.m1.2.3.3.2"><ci id="S2.Ex5.m1.2.2.3.cmml" xref="S2.Ex5.m1.2.2.3">^</ci><apply id="S2.Ex5.m1.2.2.2.3.cmml" xref="S2.Ex5.m1.2.2.2.2"><apply id="S2.Ex5.m1.1.1.1.1.1.cmml" xref="S2.Ex5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex5.m1.1.1.1.1.1.1.cmml" xref="S2.Ex5.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex5.m1.1.1.1.1.1.2.cmml" xref="S2.Ex5.m1.1.1.1.1.1.2">∇</ci><ci id="S2.Ex5.m1.1.1.1.1.1.3.cmml" xref="S2.Ex5.m1.1.1.1.1.1.3">𝜃</ci></apply><apply id="S2.Ex5.m1.2.2.2.2.2.1.cmml" xref="S2.Ex5.m1.2.2.2.2.2.1"><times id="S2.Ex5.m1.2.2.2.2.2.1.2.cmml" xref="S2.Ex5.m1.2.2.2.2.2.1.2"></times><apply id="S2.Ex5.m1.2.2.2.2.2.1.3.cmml" xref="S2.Ex5.m1.2.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S2.Ex5.m1.2.2.2.2.2.1.3.1.cmml" xref="S2.Ex5.m1.2.2.2.2.2.1.3">subscript</csymbol><ci id="S2.Ex5.m1.2.2.2.2.2.1.3.2.cmml" xref="S2.Ex5.m1.2.2.2.2.2.1.3.2">𝑉</ci><ci id="S2.Ex5.m1.2.2.2.2.2.1.3.3.cmml" xref="S2.Ex5.m1.2.2.2.2.2.1.3.3">𝛽</ci></apply><apply id="S2.Ex5.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S2.Ex5.m1.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.Ex5.m1.2.2.2.2.2.1.1.1.1.1.cmml" xref="S2.Ex5.m1.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.Ex5.m1.2.2.2.2.2.1.1.1.1.2.cmml" xref="S2.Ex5.m1.2.2.2.2.2.1.1.1.1.2">𝜋</ci><ci id="S2.Ex5.m1.2.2.2.2.2.1.1.1.1.3.cmml" xref="S2.Ex5.m1.2.2.2.2.2.1.1.1.1.3">𝜃</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex5.m1.2c">\displaystyle\operatorname*{arg\,min}_{\beta}\mathrm{Var}\left(\widehat{\nabla%
_{\theta}(V_{\beta}(\pi_{\theta}))}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.Ex5.m1.2d">start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT italic_β end_POSTSUBSCRIPT roman_Var ( over^ start_ARG ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_V start_POSTSUBSCRIPT italic_β end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ) ) end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname*{arg\,min}_{\beta}\frac{1}{\left|\mathcal{D}\right%
|}\mathop{\mathrm{Var}}\left[\nabla_{\theta}\left(\log(\pi_{\theta}(a|x))\left%
(r-\beta\right)\right)\right]" class="ltx_Math" display="inline" id="S2.E5.m1.3"><semantics id="S2.E5.m1.3a"><mrow id="S2.E5.m1.3.3" xref="S2.E5.m1.3.3.cmml"><mi id="S2.E5.m1.3.3.3" xref="S2.E5.m1.3.3.3.cmml"></mi><mo id="S2.E5.m1.3.3.2" xref="S2.E5.m1.3.3.2.cmml">=</mo><mrow id="S2.E5.m1.3.3.1" xref="S2.E5.m1.3.3.1.cmml"><mrow id="S2.E5.m1.3.3.1.3" xref="S2.E5.m1.3.3.1.3.cmml"><munder id="S2.E5.m1.3.3.1.3.1" xref="S2.E5.m1.3.3.1.3.1.cmml"><mrow id="S2.E5.m1.3.3.1.3.1.2" xref="S2.E5.m1.3.3.1.3.1.2.cmml"><mi id="S2.E5.m1.3.3.1.3.1.2.2" xref="S2.E5.m1.3.3.1.3.1.2.2.cmml">arg</mi><mo id="S2.E5.m1.3.3.1.3.1.2.1" lspace="0.170em" xref="S2.E5.m1.3.3.1.3.1.2.1.cmml">⁢</mo><mi id="S2.E5.m1.3.3.1.3.1.2.3" xref="S2.E5.m1.3.3.1.3.1.2.3.cmml">min</mi></mrow><mi id="S2.E5.m1.3.3.1.3.1.3" xref="S2.E5.m1.3.3.1.3.1.3.cmml">β</mi></munder><mo id="S2.E5.m1.3.3.1.3a" xref="S2.E5.m1.3.3.1.3.cmml">⁡</mo><mstyle displaystyle="true" id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml"><mfrac id="S2.E5.m1.1.1a" xref="S2.E5.m1.1.1.cmml"><mn id="S2.E5.m1.1.1.3" xref="S2.E5.m1.1.1.3.cmml">1</mn><mrow id="S2.E5.m1.1.1.1.3" xref="S2.E5.m1.1.1.1.2.cmml"><mo id="S2.E5.m1.1.1.1.3.1" xref="S2.E5.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml">𝒟</mi><mo id="S2.E5.m1.1.1.1.3.2" xref="S2.E5.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle></mrow><mo id="S2.E5.m1.3.3.1.2" lspace="0.167em" xref="S2.E5.m1.3.3.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.3.3.1.1" xref="S2.E5.m1.3.3.1.1.cmml"><mo id="S2.E5.m1.3.3.1.1.2" movablelimits="false" rspace="0em" xref="S2.E5.m1.3.3.1.1.2.cmml">Var</mo><mrow id="S2.E5.m1.3.3.1.1.1.1" xref="S2.E5.m1.3.3.1.1.1.2.cmml"><mo id="S2.E5.m1.3.3.1.1.1.1.2" xref="S2.E5.m1.3.3.1.1.1.2.1.cmml">[</mo><mrow id="S2.E5.m1.3.3.1.1.1.1.1.2" xref="S2.E5.m1.3.3.1.1.1.1.1.3.cmml"><msub id="S2.E5.m1.3.3.1.1.1.1.1.1.1" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S2.E5.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.2.cmml">∇</mo><mi id="S2.E5.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.3.cmml">θ</mi></msub><mrow id="S2.E5.m1.3.3.1.1.1.1.1.2.2" xref="S2.E5.m1.3.3.1.1.1.1.1.3.cmml"><mo id="S2.E5.m1.3.3.1.1.1.1.1.2.2.2" xref="S2.E5.m1.3.3.1.1.1.1.1.3.cmml">(</mo><mrow id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.cmml"><mrow id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.2.cmml"><mi id="S2.E5.m1.2.2" xref="S2.E5.m1.2.2.cmml">log</mi><mo id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1a" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.2.cmml">⁡</mo><mrow id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.2.cmml"><mo id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.2" stretchy="false" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.2.cmml">(</mo><mrow id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.cmml"><msub id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.3" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.3.cmml"><mi id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.3.2" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.3.2.cmml">π</mi><mi id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.3.3" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.2" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.3" stretchy="false" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.3" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.3.cmml">⁢</mo><mrow id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1.1.cmml"><mo id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1.2" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1.1.cmml">(</mo><mrow id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1.1" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1.1.cmml"><mi id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1.1.2" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1.1.2.cmml">r</mi><mo id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1.1.1" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1.1.1.cmml">−</mo><mi id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1.1.3" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1.1.3.cmml">β</mi></mrow><mo id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1.3" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.3.3.1.1.1.1.1.2.2.3" xref="S2.E5.m1.3.3.1.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.3.3.1.1.1.1.3" xref="S2.E5.m1.3.3.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.3b"><apply id="S2.E5.m1.3.3.cmml" xref="S2.E5.m1.3.3"><eq id="S2.E5.m1.3.3.2.cmml" xref="S2.E5.m1.3.3.2"></eq><csymbol cd="latexml" id="S2.E5.m1.3.3.3.cmml" xref="S2.E5.m1.3.3.3">absent</csymbol><apply id="S2.E5.m1.3.3.1.cmml" xref="S2.E5.m1.3.3.1"><times id="S2.E5.m1.3.3.1.2.cmml" xref="S2.E5.m1.3.3.1.2"></times><apply id="S2.E5.m1.3.3.1.3.cmml" xref="S2.E5.m1.3.3.1.3"><apply id="S2.E5.m1.3.3.1.3.1.cmml" xref="S2.E5.m1.3.3.1.3.1"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.1.3.1.1.cmml" xref="S2.E5.m1.3.3.1.3.1">subscript</csymbol><apply id="S2.E5.m1.3.3.1.3.1.2.cmml" xref="S2.E5.m1.3.3.1.3.1.2"><times id="S2.E5.m1.3.3.1.3.1.2.1.cmml" xref="S2.E5.m1.3.3.1.3.1.2.1"></times><ci id="S2.E5.m1.3.3.1.3.1.2.2.cmml" xref="S2.E5.m1.3.3.1.3.1.2.2">arg</ci><ci id="S2.E5.m1.3.3.1.3.1.2.3.cmml" xref="S2.E5.m1.3.3.1.3.1.2.3">min</ci></apply><ci id="S2.E5.m1.3.3.1.3.1.3.cmml" xref="S2.E5.m1.3.3.1.3.1.3">𝛽</ci></apply><apply id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1"><divide id="S2.E5.m1.1.1.2.cmml" xref="S2.E5.m1.1.1"></divide><cn id="S2.E5.m1.1.1.3.cmml" type="integer" xref="S2.E5.m1.1.1.3">1</cn><apply id="S2.E5.m1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.3"><abs id="S2.E5.m1.1.1.1.2.1.cmml" xref="S2.E5.m1.1.1.1.3.1"></abs><ci id="S2.E5.m1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1">𝒟</ci></apply></apply></apply><apply id="S2.E5.m1.3.3.1.1.cmml" xref="S2.E5.m1.3.3.1.1"><ci id="S2.E5.m1.3.3.1.1.2.cmml" xref="S2.E5.m1.3.3.1.1.2">Var</ci><apply id="S2.E5.m1.3.3.1.1.1.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.3.3.1.1.1.2.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E5.m1.3.3.1.1.1.1.1.3.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2"><apply id="S2.E5.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E5.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.2">∇</ci><ci id="S2.E5.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.3">𝜃</ci></apply><apply id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1"><times id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.3.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.3"></times><apply id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1"><log id="S2.E5.m1.2.2.cmml" xref="S2.E5.m1.2.2"></log><apply id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1"><times id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.2"></times><apply id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.3.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.3.2">𝜋</ci><ci id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.2">𝑎</ci><ci id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1"><minus id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1.1.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1.1.1"></minus><ci id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1.1.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1.1.2">𝑟</ci><ci id="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1.1.3.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.1.2.1.1.3">𝛽</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.3c">\displaystyle=\operatorname*{arg\,min}_{\beta}\frac{1}{\left|\mathcal{D}\right%
|}\mathop{\mathrm{Var}}\left[\nabla_{\theta}\left(\log(\pi_{\theta}(a|x))\left%
(r-\beta\right)\right)\right]</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.3d">= start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT italic_β end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG roman_Var [ ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( roman_log ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | italic_x ) ) ( italic_r - italic_β ) ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname*{arg\,min}_{\beta}\frac{1}{\left|\mathcal{D}\right%
|}\mathop{\mathbb{E}}\left[\nabla_{\theta}\log(\pi_{\theta}(a|x))^{\top}\nabla%
_{\theta}\log(\pi_{\theta}(a|x))\left(r-\beta\right)^{2}\right]" class="ltx_math_unparsed" display="inline" id="S2.E6.m1.1"><semantics id="S2.E6.m1.1a"><mrow id="S2.E6.m1.1b"><mo id="S2.E6.m1.1.2">=</mo><munder id="S2.E6.m1.1.3"><mrow id="S2.E6.m1.1.3.2"><mi id="S2.E6.m1.1.3.2.2">arg</mi><mo id="S2.E6.m1.1.3.2.1" lspace="0.170em">⁢</mo><mi id="S2.E6.m1.1.3.2.3">min</mi></mrow><mi id="S2.E6.m1.1.3.3">β</mi></munder><mstyle displaystyle="true" id="S2.E6.m1.1.1"><mfrac id="S2.E6.m1.1.1a"><mn id="S2.E6.m1.1.1.3">1</mn><mrow id="S2.E6.m1.1.1.1.3"><mo id="S2.E6.m1.1.1.1.3.1">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.1.1.1.1">𝒟</mi><mo id="S2.E6.m1.1.1.1.3.2">|</mo></mrow></mfrac></mstyle><mo id="S2.E6.m1.1.4" lspace="0.167em" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S2.E6.m1.1.5"><mo id="S2.E6.m1.1.5.1">[</mo><msub id="S2.E6.m1.1.5.2"><mo id="S2.E6.m1.1.5.2.2" rspace="0.167em">∇</mo><mi id="S2.E6.m1.1.5.2.3">θ</mi></msub><mi id="S2.E6.m1.1.5.3">log</mi><msup id="S2.E6.m1.1.5.4"><mrow id="S2.E6.m1.1.5.4.2"><mo id="S2.E6.m1.1.5.4.2.1" stretchy="false">(</mo><msub id="S2.E6.m1.1.5.4.2.2"><mi id="S2.E6.m1.1.5.4.2.2.2">π</mi><mi id="S2.E6.m1.1.5.4.2.2.3">θ</mi></msub><mrow id="S2.E6.m1.1.5.4.2.3"><mo id="S2.E6.m1.1.5.4.2.3.1" stretchy="false">(</mo><mi id="S2.E6.m1.1.5.4.2.3.2">a</mi><mo fence="false" id="S2.E6.m1.1.5.4.2.3.3" rspace="0.167em" stretchy="false">|</mo><mi id="S2.E6.m1.1.5.4.2.3.4">x</mi><mo id="S2.E6.m1.1.5.4.2.3.5" stretchy="false">)</mo></mrow><mo id="S2.E6.m1.1.5.4.2.4" rspace="0.167em" stretchy="false">)</mo></mrow><mo id="S2.E6.m1.1.5.4.3">⊤</mo></msup><msub id="S2.E6.m1.1.5.5"><mo id="S2.E6.m1.1.5.5.2" rspace="0.167em">∇</mo><mi id="S2.E6.m1.1.5.5.3">θ</mi></msub><mi id="S2.E6.m1.1.5.6">log</mi><mrow id="S2.E6.m1.1.5.7"><mo id="S2.E6.m1.1.5.7.1" stretchy="false">(</mo><msub id="S2.E6.m1.1.5.7.2"><mi id="S2.E6.m1.1.5.7.2.2">π</mi><mi id="S2.E6.m1.1.5.7.2.3">θ</mi></msub><mrow id="S2.E6.m1.1.5.7.3"><mo id="S2.E6.m1.1.5.7.3.1" stretchy="false">(</mo><mi id="S2.E6.m1.1.5.7.3.2">a</mi><mo fence="false" id="S2.E6.m1.1.5.7.3.3" rspace="0.167em" stretchy="false">|</mo><mi id="S2.E6.m1.1.5.7.3.4">x</mi><mo id="S2.E6.m1.1.5.7.3.5" stretchy="false">)</mo></mrow><mo id="S2.E6.m1.1.5.7.4" stretchy="false">)</mo></mrow><msup id="S2.E6.m1.1.5.8"><mrow id="S2.E6.m1.1.5.8.2"><mo id="S2.E6.m1.1.5.8.2.1">(</mo><mi id="S2.E6.m1.1.5.8.2.2">r</mi><mo id="S2.E6.m1.1.5.8.2.3">−</mo><mi id="S2.E6.m1.1.5.8.2.4">β</mi><mo id="S2.E6.m1.1.5.8.2.5">)</mo></mrow><mn id="S2.E6.m1.1.5.8.3">2</mn></msup><mo id="S2.E6.m1.1.5.9">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S2.E6.m1.1c">\displaystyle=\operatorname*{arg\,min}_{\beta}\frac{1}{\left|\mathcal{D}\right%
|}\mathop{\mathbb{E}}\left[\nabla_{\theta}\log(\pi_{\theta}(a|x))^{\top}\nabla%
_{\theta}\log(\pi_{\theta}(a|x))\left(r-\beta\right)^{2}\right]</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.1d">= start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT italic_β end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG blackboard_E [ ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT roman_log ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | italic_x ) ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT roman_log ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | italic_x ) ) ( italic_r - italic_β ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\quad-\frac{1}{\left|\mathcal{D}\right|}\mathop{\mathbb{E}}\left[%
\nabla_{\theta}\log(\pi_{\theta}(a|x))\left(r-\beta\right)\ \right]^{\top}%
\mathop{\mathbb{E}}\left[\nabla_{\theta}\log(\pi_{\theta}(a|x))\left(r-\beta%
\right)\right]" class="ltx_Math" display="inline" id="S2.Ex6.m1.3"><semantics id="S2.Ex6.m1.3a"><mrow id="S2.Ex6.m1.3.3" xref="S2.Ex6.m1.3.3.cmml"><mo id="S2.Ex6.m1.3.3a" xref="S2.Ex6.m1.3.3.cmml">−</mo><mrow id="S2.Ex6.m1.3.3.2" xref="S2.Ex6.m1.3.3.2.cmml"><mstyle displaystyle="true" id="S2.Ex6.m1.1.1" xref="S2.Ex6.m1.1.1.cmml"><mfrac id="S2.Ex6.m1.1.1a" xref="S2.Ex6.m1.1.1.cmml"><mn id="S2.Ex6.m1.1.1.3" xref="S2.Ex6.m1.1.1.3.cmml">1</mn><mrow id="S2.Ex6.m1.1.1.1.3" xref="S2.Ex6.m1.1.1.1.2.cmml"><mo id="S2.Ex6.m1.1.1.1.3.1" xref="S2.Ex6.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.Ex6.m1.1.1.1.1" xref="S2.Ex6.m1.1.1.1.1.cmml">𝒟</mi><mo id="S2.Ex6.m1.1.1.1.3.2" xref="S2.Ex6.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo id="S2.Ex6.m1.3.3.2.3" lspace="0.167em" xref="S2.Ex6.m1.3.3.2.3.cmml">⁢</mo><mrow id="S2.Ex6.m1.3.3.2.2" xref="S2.Ex6.m1.3.3.2.2.cmml"><mo id="S2.Ex6.m1.3.3.2.2.3" movablelimits="false" rspace="0em" xref="S2.Ex6.m1.3.3.2.2.3.cmml">𝔼</mo><mrow id="S2.Ex6.m1.3.3.2.2.2" xref="S2.Ex6.m1.3.3.2.2.2.cmml"><msup id="S2.Ex6.m1.2.2.1.1.1.1" xref="S2.Ex6.m1.2.2.1.1.1.1.cmml"><mrow id="S2.Ex6.m1.2.2.1.1.1.1.1.1" xref="S2.Ex6.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.2" xref="S2.Ex6.m1.2.2.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.3.cmml"><mrow id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" rspace="0.167em" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">∇</mo><mi id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">θ</mi></msub><mi id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">log</mi></mrow><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2a" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">⁡</mo><mrow id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.3.cmml"><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.2" stretchy="false" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">(</mo><mrow id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.cmml"><msub id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.3" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.3.cmml"><mi id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.3.2" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.3.2.cmml">π</mi><mi id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.3.3" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.3.3.cmml">θ</mi></msub><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.2" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.2.cmml">⁢</mo><mrow id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml"><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1.2" stretchy="false" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1.1" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml"><mi id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1.1.2" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1.1.1" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1.1.3" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1.3" stretchy="false" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.4" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.4.cmml">⁢</mo><mrow id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1.1.cmml"><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1.2" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1.1.cmml">(</mo><mrow id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1.1" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1.1.cmml"><mi id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1.1.2" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1.1.2.cmml">r</mi><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1.1.1" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1.1.1.cmml">−</mo><mi id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1.1.3" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1.1.3.cmml">β</mi></mrow><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1.3" rspace="0.500em" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.3" xref="S2.Ex6.m1.2.2.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="S2.Ex6.m1.2.2.1.1.1.1.3" xref="S2.Ex6.m1.2.2.1.1.1.1.3.cmml">⊤</mo></msup><mo id="S2.Ex6.m1.3.3.2.2.2.3" lspace="0.167em" xref="S2.Ex6.m1.3.3.2.2.2.3.cmml">⁢</mo><mrow id="S2.Ex6.m1.3.3.2.2.2.2" xref="S2.Ex6.m1.3.3.2.2.2.2.cmml"><mo id="S2.Ex6.m1.3.3.2.2.2.2.2" movablelimits="false" rspace="0em" xref="S2.Ex6.m1.3.3.2.2.2.2.2.cmml">𝔼</mo><mrow id="S2.Ex6.m1.3.3.2.2.2.2.1.1" xref="S2.Ex6.m1.3.3.2.2.2.2.1.2.cmml"><mo id="S2.Ex6.m1.3.3.2.2.2.2.1.1.2" xref="S2.Ex6.m1.3.3.2.2.2.2.1.2.1.cmml">[</mo><mrow id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.cmml"><mrow id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.3.cmml"><mrow id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1.cmml"><msub id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1.1" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.cmml"><mo id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.2" rspace="0.167em" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.2.cmml">∇</mo><mi id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.cmml">θ</mi></msub><mi id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1.2" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1.2.cmml">log</mi></mrow><mo id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2a" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.3.cmml">⁡</mo><mrow id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.3.cmml"><mo id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.2" stretchy="false" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.3.cmml">(</mo><mrow id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.cmml"><msub id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.3" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.3.cmml"><mi id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.3.2" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.3.2.cmml">π</mi><mi id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.3.3" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.3.3.cmml">θ</mi></msub><mo id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.2" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.2.cmml">⁢</mo><mrow id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1.1.cmml"><mo id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1.2" stretchy="false" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1.1" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1.1.cmml"><mi id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1.1.2" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1.1.1" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1.1.3" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1.3" stretchy="false" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.3" stretchy="false" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.4" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.4.cmml">⁢</mo><mrow id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1.1.cmml"><mo id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1.2" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1.1.cmml">(</mo><mrow id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1.1" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1.1.cmml"><mi id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1.1.2" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1.1.2.cmml">r</mi><mo id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1.1.1" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1.1.1.cmml">−</mo><mi id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1.1.3" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1.1.3.cmml">β</mi></mrow><mo id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1.3" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex6.m1.3.3.2.2.2.2.1.1.3" xref="S2.Ex6.m1.3.3.2.2.2.2.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex6.m1.3b"><apply id="S2.Ex6.m1.3.3.cmml" xref="S2.Ex6.m1.3.3"><minus id="S2.Ex6.m1.3.3.3.cmml" xref="S2.Ex6.m1.3.3"></minus><apply id="S2.Ex6.m1.3.3.2.cmml" xref="S2.Ex6.m1.3.3.2"><times id="S2.Ex6.m1.3.3.2.3.cmml" xref="S2.Ex6.m1.3.3.2.3"></times><apply id="S2.Ex6.m1.1.1.cmml" xref="S2.Ex6.m1.1.1"><divide id="S2.Ex6.m1.1.1.2.cmml" xref="S2.Ex6.m1.1.1"></divide><cn id="S2.Ex6.m1.1.1.3.cmml" type="integer" xref="S2.Ex6.m1.1.1.3">1</cn><apply id="S2.Ex6.m1.1.1.1.2.cmml" xref="S2.Ex6.m1.1.1.1.3"><abs id="S2.Ex6.m1.1.1.1.2.1.cmml" xref="S2.Ex6.m1.1.1.1.3.1"></abs><ci id="S2.Ex6.m1.1.1.1.1.cmml" xref="S2.Ex6.m1.1.1.1.1">𝒟</ci></apply></apply><apply id="S2.Ex6.m1.3.3.2.2.cmml" xref="S2.Ex6.m1.3.3.2.2"><ci id="S2.Ex6.m1.3.3.2.2.3.cmml" xref="S2.Ex6.m1.3.3.2.2.3">𝔼</ci><apply id="S2.Ex6.m1.3.3.2.2.2.cmml" xref="S2.Ex6.m1.3.3.2.2.2"><times id="S2.Ex6.m1.3.3.2.2.2.3.cmml" xref="S2.Ex6.m1.3.3.2.2.2.3"></times><apply id="S2.Ex6.m1.2.2.1.1.1.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex6.m1.2.2.1.1.1.1.2.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1">superscript</csymbol><apply id="S2.Ex6.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.Ex6.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1"><times id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.4.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.4"></times><apply id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2"><apply id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1"><apply id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">∇</ci><ci id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝜃</ci></apply><log id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2"></log></apply><apply id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1"><times id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.2.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.2"></times><apply id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.3.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.3.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.3">subscript</csymbol><ci id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.3.2.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.3.2">𝜋</ci><ci id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.3.3.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.3.3">𝜃</ci></apply><apply id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1"><csymbol cd="latexml" id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1.1.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1.1.2.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1.1.2">𝑎</ci><ci id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1.1.3.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1"><minus id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1.1.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1.1.1"></minus><ci id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1.1.2.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1.1.2">𝑟</ci><ci id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1.1.3.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.3.1.1.3">𝛽</ci></apply></apply></apply><csymbol cd="latexml" id="S2.Ex6.m1.2.2.1.1.1.1.3.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.3">top</csymbol></apply><apply id="S2.Ex6.m1.3.3.2.2.2.2.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2"><ci id="S2.Ex6.m1.3.3.2.2.2.2.2.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.2">𝔼</ci><apply id="S2.Ex6.m1.3.3.2.2.2.2.1.2.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1"><csymbol cd="latexml" id="S2.Ex6.m1.3.3.2.2.2.2.1.2.1.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.2">delimited-[]</csymbol><apply id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1"><times id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.4.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.4"></times><apply id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.3.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2"><apply id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1"><apply id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.2">∇</ci><ci id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3">𝜃</ci></apply><log id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.1.1.1.2"></log></apply><apply id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1"><times id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.2.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.2"></times><apply id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.3.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.3.1.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.3">subscript</csymbol><ci id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.3.2.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.3.2">𝜋</ci><ci id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.3.3.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.3.3">𝜃</ci></apply><apply id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1.1.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1"><csymbol cd="latexml" id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1.1.1.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1.1.2.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1.1.2">𝑎</ci><ci id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1.1.3.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.2.2.2.1.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1.1.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1"><minus id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1.1.1.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1.1.1"></minus><ci id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1.1.2.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1.1.2">𝑟</ci><ci id="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1.1.3.cmml" xref="S2.Ex6.m1.3.3.2.2.2.2.1.1.1.3.1.1.3">𝛽</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex6.m1.3c">\displaystyle\quad-\frac{1}{\left|\mathcal{D}\right|}\mathop{\mathbb{E}}\left[%
\nabla_{\theta}\log(\pi_{\theta}(a|x))\left(r-\beta\right)\ \right]^{\top}%
\mathop{\mathbb{E}}\left[\nabla_{\theta}\log(\pi_{\theta}(a|x))\left(r-\beta%
\right)\right]</annotation><annotation encoding="application/x-llamapun" id="S2.Ex6.m1.3d">- divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG blackboard_E [ ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT roman_log ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | italic_x ) ) ( italic_r - italic_β ) ] start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT blackboard_E [ ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT roman_log ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | italic_x ) ) ( italic_r - italic_β ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname*{arg\,min}_{\beta}\frac{1}{\left|\mathcal{D}\right%
|}\mathop{\mathbb{E}}\left[\|\nabla_{\theta}\log(\pi_{\theta}(a|x))\|^{2}_{2}%
\left(r-\beta\right)^{2}\right]," class="ltx_math_unparsed" display="inline" id="S2.E7.m1.1"><semantics id="S2.E7.m1.1a"><mrow id="S2.E7.m1.1b"><mo id="S2.E7.m1.1.2">=</mo><munder id="S2.E7.m1.1.3"><mrow id="S2.E7.m1.1.3.2"><mi id="S2.E7.m1.1.3.2.2">arg</mi><mo id="S2.E7.m1.1.3.2.1" lspace="0.170em">⁢</mo><mi id="S2.E7.m1.1.3.2.3">min</mi></mrow><mi id="S2.E7.m1.1.3.3">β</mi></munder><mstyle displaystyle="true" id="S2.E7.m1.1.1"><mfrac id="S2.E7.m1.1.1a"><mn id="S2.E7.m1.1.1.3">1</mn><mrow id="S2.E7.m1.1.1.1.3"><mo id="S2.E7.m1.1.1.1.3.1">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.E7.m1.1.1.1.1">𝒟</mi><mo id="S2.E7.m1.1.1.1.3.2">|</mo></mrow></mfrac></mstyle><mo id="S2.E7.m1.1.4" lspace="0.167em" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S2.E7.m1.1.5"><mo id="S2.E7.m1.1.5.1">[</mo><mo id="S2.E7.m1.1.5.2" lspace="0em" rspace="0.167em">∥</mo><msub id="S2.E7.m1.1.5.3"><mo id="S2.E7.m1.1.5.3.2" rspace="0.167em">∇</mo><mi id="S2.E7.m1.1.5.3.3">θ</mi></msub><mi id="S2.E7.m1.1.5.4">log</mi><mrow id="S2.E7.m1.1.5.5"><mo id="S2.E7.m1.1.5.5.1" stretchy="false">(</mo><msub id="S2.E7.m1.1.5.5.2"><mi id="S2.E7.m1.1.5.5.2.2">π</mi><mi id="S2.E7.m1.1.5.5.2.3">θ</mi></msub><mrow id="S2.E7.m1.1.5.5.3"><mo id="S2.E7.m1.1.5.5.3.1" stretchy="false">(</mo><mi id="S2.E7.m1.1.5.5.3.2">a</mi><mo fence="false" id="S2.E7.m1.1.5.5.3.3" rspace="0.167em" stretchy="false">|</mo><mi id="S2.E7.m1.1.5.5.3.4">x</mi><mo id="S2.E7.m1.1.5.5.3.5" stretchy="false">)</mo></mrow><mo id="S2.E7.m1.1.5.5.4" stretchy="false">)</mo></mrow><msubsup id="S2.E7.m1.1.5.6"><mo id="S2.E7.m1.1.5.6.2.2" lspace="0em" rspace="0.167em">∥</mo><mn id="S2.E7.m1.1.5.6.3">2</mn><mn id="S2.E7.m1.1.5.6.2.3">2</mn></msubsup><msup id="S2.E7.m1.1.5.7"><mrow id="S2.E7.m1.1.5.7.2"><mo id="S2.E7.m1.1.5.7.2.1">(</mo><mi id="S2.E7.m1.1.5.7.2.2">r</mi><mo id="S2.E7.m1.1.5.7.2.3">−</mo><mi id="S2.E7.m1.1.5.7.2.4">β</mi><mo id="S2.E7.m1.1.5.7.2.5">)</mo></mrow><mn id="S2.E7.m1.1.5.7.3">2</mn></msup><mo id="S2.E7.m1.1.5.8">]</mo></mrow><mo id="S2.E7.m1.1.6">,</mo></mrow><annotation encoding="application/x-tex" id="S2.E7.m1.1c">\displaystyle=\operatorname*{arg\,min}_{\beta}\frac{1}{\left|\mathcal{D}\right%
|}\mathop{\mathbb{E}}\left[\|\nabla_{\theta}\log(\pi_{\theta}(a|x))\|^{2}_{2}%
\left(r-\beta\right)^{2}\right],</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m1.1d">= start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT italic_β end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG blackboard_E [ ∥ ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT roman_log ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | italic_x ) ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_r - italic_β ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p6.2">where we ignore the second term in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2.E6" title="In 2.1. On-policy contextual bandits ‣ 2. Background and Related Work ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">6</span></a>, since it is independent of <math alttext="\beta" class="ltx_Math" display="inline" id="S2.SS1.p6.2.m1.1"><semantics id="S2.SS1.p6.2.m1.1a"><mi id="S2.SS1.p6.2.m1.1.1" xref="S2.SS1.p6.2.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.2.m1.1b"><ci id="S2.SS1.p6.2.m1.1.1.cmml" xref="S2.SS1.p6.2.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.2.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.2.m1.1d">italic_β</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Mohamed et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib45" title="">2020</a>, Eq. 12)</cite>.
The result from this derivation (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2.E7" title="In 2.1. On-policy contextual bandits ‣ 2. Background and Related Work ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">7</span></a>) reveals that the optimal baseline can be obtained by solving the following equation:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Ax1.EGx3">
<tbody id="S2.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mbox{}\frac{\partial\mathrm{Var}\big{(}\widehat{\nabla_{\theta}(%
V_{\beta}(\pi_{\theta}))}\big{)}}{\partial\beta}" class="ltx_Math" display="inline" id="S2.E8.m1.2"><semantics id="S2.E8.m1.2a"><mrow id="S2.E8.m1.2.3" xref="S2.E8.m1.2.3.cmml"><mrow id="S2.E8.m1.2.3.2" xref="S2.E8.m1.2.3.2a.cmml"></mrow><mo id="S2.E8.m1.2.3.1" rspace="0.222em" xref="S2.E8.m1.2.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="S2.E8.m1.2.2" xref="S2.E8.m1.2.2.cmml"><mfrac id="S2.E8.m1.2.2a" xref="S2.E8.m1.2.2.cmml"><mrow id="S2.E8.m1.2.2.2" xref="S2.E8.m1.2.2.2.cmml"><mo id="S2.E8.m1.2.2.2.3" rspace="0em" xref="S2.E8.m1.2.2.2.3.cmml">∂</mo><mrow id="S2.E8.m1.2.2.2.4" xref="S2.E8.m1.2.2.2.4.cmml"><mi id="S2.E8.m1.2.2.2.4.2" xref="S2.E8.m1.2.2.2.4.2.cmml">Var</mi><mo id="S2.E8.m1.2.2.2.4.1" xref="S2.E8.m1.2.2.2.4.1.cmml">⁢</mo><mrow id="S2.E8.m1.2.2.2.4.3.2" xref="S2.E8.m1.2.2.2.2.cmml"><mo id="S2.E8.m1.2.2.2.4.3.2.1" maxsize="120%" minsize="120%" xref="S2.E8.m1.2.2.2.2.cmml">(</mo><mover accent="true" id="S2.E8.m1.2.2.2.2" xref="S2.E8.m1.2.2.2.2.cmml"><mrow id="S2.E8.m1.2.2.2.2.2.2" xref="S2.E8.m1.2.2.2.2.2.3.cmml"><msub id="S2.E8.m1.1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.1.cmml"><mo id="S2.E8.m1.1.1.1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.1.1.1.2.cmml">∇</mo><mi id="S2.E8.m1.1.1.1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.1.1.1.3.cmml">θ</mi></msub><mrow id="S2.E8.m1.2.2.2.2.2.2.2" xref="S2.E8.m1.2.2.2.2.2.3.cmml"><mo id="S2.E8.m1.2.2.2.2.2.2.2.2" stretchy="false" xref="S2.E8.m1.2.2.2.2.2.3.cmml">(</mo><mrow id="S2.E8.m1.2.2.2.2.2.2.2.1" xref="S2.E8.m1.2.2.2.2.2.2.2.1.cmml"><msub id="S2.E8.m1.2.2.2.2.2.2.2.1.3" xref="S2.E8.m1.2.2.2.2.2.2.2.1.3.cmml"><mi id="S2.E8.m1.2.2.2.2.2.2.2.1.3.2" xref="S2.E8.m1.2.2.2.2.2.2.2.1.3.2.cmml">V</mi><mi id="S2.E8.m1.2.2.2.2.2.2.2.1.3.3" xref="S2.E8.m1.2.2.2.2.2.2.2.1.3.3.cmml">β</mi></msub><mo id="S2.E8.m1.2.2.2.2.2.2.2.1.2" xref="S2.E8.m1.2.2.2.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S2.E8.m1.2.2.2.2.2.2.2.1.1.1" xref="S2.E8.m1.2.2.2.2.2.2.2.1.1.1.1.cmml"><mo id="S2.E8.m1.2.2.2.2.2.2.2.1.1.1.2" stretchy="false" xref="S2.E8.m1.2.2.2.2.2.2.2.1.1.1.1.cmml">(</mo><msub id="S2.E8.m1.2.2.2.2.2.2.2.1.1.1.1" xref="S2.E8.m1.2.2.2.2.2.2.2.1.1.1.1.cmml"><mi id="S2.E8.m1.2.2.2.2.2.2.2.1.1.1.1.2" xref="S2.E8.m1.2.2.2.2.2.2.2.1.1.1.1.2.cmml">π</mi><mi id="S2.E8.m1.2.2.2.2.2.2.2.1.1.1.1.3" xref="S2.E8.m1.2.2.2.2.2.2.2.1.1.1.1.3.cmml">θ</mi></msub><mo id="S2.E8.m1.2.2.2.2.2.2.2.1.1.1.3" stretchy="false" xref="S2.E8.m1.2.2.2.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E8.m1.2.2.2.2.2.2.2.3" stretchy="false" xref="S2.E8.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E8.m1.2.2.2.2.3" xref="S2.E8.m1.2.2.2.2.3.cmml">^</mo></mover><mo id="S2.E8.m1.2.2.2.4.3.2.2" maxsize="120%" minsize="120%" xref="S2.E8.m1.2.2.2.2.cmml">)</mo></mrow></mrow></mrow><mrow id="S2.E8.m1.2.2.4" xref="S2.E8.m1.2.2.4.cmml"><mo id="S2.E8.m1.2.2.4.1" rspace="0em" xref="S2.E8.m1.2.2.4.1.cmml">∂</mo><mi id="S2.E8.m1.2.2.4.2" xref="S2.E8.m1.2.2.4.2.cmml">β</mi></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.2b"><apply id="S2.E8.m1.2.3.cmml" xref="S2.E8.m1.2.3"><times id="S2.E8.m1.2.3.1.cmml" xref="S2.E8.m1.2.3.1"></times><ci id="S2.E8.m1.2.3.2a.cmml" xref="S2.E8.m1.2.3.2"><mrow id="S2.E8.m1.2.3.2.cmml" xref="S2.E8.m1.2.3.2"></mrow></ci><apply id="S2.E8.m1.2.2.cmml" xref="S2.E8.m1.2.2"><divide id="S2.E8.m1.2.2.3.cmml" xref="S2.E8.m1.2.2"></divide><apply id="S2.E8.m1.2.2.2.cmml" xref="S2.E8.m1.2.2.2"><partialdiff id="S2.E8.m1.2.2.2.3.cmml" xref="S2.E8.m1.2.2.2.3"></partialdiff><apply id="S2.E8.m1.2.2.2.4.cmml" xref="S2.E8.m1.2.2.2.4"><times id="S2.E8.m1.2.2.2.4.1.cmml" xref="S2.E8.m1.2.2.2.4.1"></times><ci id="S2.E8.m1.2.2.2.4.2.cmml" xref="S2.E8.m1.2.2.2.4.2">Var</ci><apply id="S2.E8.m1.2.2.2.2.cmml" xref="S2.E8.m1.2.2.2.4.3.2"><ci id="S2.E8.m1.2.2.2.2.3.cmml" xref="S2.E8.m1.2.2.2.2.3">^</ci><apply id="S2.E8.m1.2.2.2.2.2.3.cmml" xref="S2.E8.m1.2.2.2.2.2.2"><apply id="S2.E8.m1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E8.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.2">∇</ci><ci id="S2.E8.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.3">𝜃</ci></apply><apply id="S2.E8.m1.2.2.2.2.2.2.2.1.cmml" xref="S2.E8.m1.2.2.2.2.2.2.2.1"><times id="S2.E8.m1.2.2.2.2.2.2.2.1.2.cmml" xref="S2.E8.m1.2.2.2.2.2.2.2.1.2"></times><apply id="S2.E8.m1.2.2.2.2.2.2.2.1.3.cmml" xref="S2.E8.m1.2.2.2.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.2.2.2.2.2.1.3.1.cmml" xref="S2.E8.m1.2.2.2.2.2.2.2.1.3">subscript</csymbol><ci id="S2.E8.m1.2.2.2.2.2.2.2.1.3.2.cmml" xref="S2.E8.m1.2.2.2.2.2.2.2.1.3.2">𝑉</ci><ci id="S2.E8.m1.2.2.2.2.2.2.2.1.3.3.cmml" xref="S2.E8.m1.2.2.2.2.2.2.2.1.3.3">𝛽</ci></apply><apply id="S2.E8.m1.2.2.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E8.m1.2.2.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.2.2.2.2.2.1.1.1.1.1.cmml" xref="S2.E8.m1.2.2.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E8.m1.2.2.2.2.2.2.2.1.1.1.1.2.cmml" xref="S2.E8.m1.2.2.2.2.2.2.2.1.1.1.1.2">𝜋</ci><ci id="S2.E8.m1.2.2.2.2.2.2.2.1.1.1.1.3.cmml" xref="S2.E8.m1.2.2.2.2.2.2.2.1.1.1.1.3">𝜃</ci></apply></apply></apply></apply></apply></apply><apply id="S2.E8.m1.2.2.4.cmml" xref="S2.E8.m1.2.2.4"><partialdiff id="S2.E8.m1.2.2.4.1.cmml" xref="S2.E8.m1.2.2.4.1"></partialdiff><ci id="S2.E8.m1.2.2.4.2.cmml" xref="S2.E8.m1.2.2.4.2">𝛽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.2c">\displaystyle\mbox{}\frac{\partial\mathrm{Var}\big{(}\widehat{\nabla_{\theta}(%
V_{\beta}(\pi_{\theta}))}\big{)}}{\partial\beta}</annotation><annotation encoding="application/x-llamapun" id="S2.E8.m1.2d">divide start_ARG ∂ roman_Var ( over^ start_ARG ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_V start_POSTSUBSCRIPT italic_β end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ) ) end_ARG ) end_ARG start_ARG ∂ italic_β end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{2}{\left|\mathcal{D}\right|}\mathop{\mathbb{E}}\left[\|%
\nabla_{\theta}\log(\pi_{\theta}(a\mid x))\|^{2}_{2}\left(\beta-r\right)\right%
]\!=0,\mbox{}" class="ltx_math_unparsed" display="inline" id="S2.E8.m2.1"><semantics id="S2.E8.m2.1a"><mrow id="S2.E8.m2.1b"><mo id="S2.E8.m2.1.2">=</mo><mstyle displaystyle="true" id="S2.E8.m2.1.1"><mfrac id="S2.E8.m2.1.1a"><mn id="S2.E8.m2.1.1.3">2</mn><mrow id="S2.E8.m2.1.1.1.3"><mo id="S2.E8.m2.1.1.1.3.1">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.E8.m2.1.1.1.1">𝒟</mi><mo id="S2.E8.m2.1.1.1.3.2">|</mo></mrow></mfrac></mstyle><mo id="S2.E8.m2.1.3" lspace="0.167em" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S2.E8.m2.1.4"><mo id="S2.E8.m2.1.4.1">[</mo><mo id="S2.E8.m2.1.4.2" lspace="0em" rspace="0.167em">∥</mo><msub id="S2.E8.m2.1.4.3"><mo id="S2.E8.m2.1.4.3.2" rspace="0.167em">∇</mo><mi id="S2.E8.m2.1.4.3.3">θ</mi></msub><mi id="S2.E8.m2.1.4.4">log</mi><mrow id="S2.E8.m2.1.4.5"><mo id="S2.E8.m2.1.4.5.1" stretchy="false">(</mo><msub id="S2.E8.m2.1.4.5.2"><mi id="S2.E8.m2.1.4.5.2.2">π</mi><mi id="S2.E8.m2.1.4.5.2.3">θ</mi></msub><mrow id="S2.E8.m2.1.4.5.3"><mo id="S2.E8.m2.1.4.5.3.1" stretchy="false">(</mo><mi id="S2.E8.m2.1.4.5.3.2">a</mi><mo id="S2.E8.m2.1.4.5.3.3" lspace="0em" rspace="0.167em">∣</mo><mi id="S2.E8.m2.1.4.5.3.4">x</mi><mo id="S2.E8.m2.1.4.5.3.5" stretchy="false">)</mo></mrow><mo id="S2.E8.m2.1.4.5.4" stretchy="false">)</mo></mrow><msubsup id="S2.E8.m2.1.4.6"><mo id="S2.E8.m2.1.4.6.2.2" lspace="0em" rspace="0.167em">∥</mo><mn id="S2.E8.m2.1.4.6.3">2</mn><mn id="S2.E8.m2.1.4.6.2.3">2</mn></msubsup><mrow id="S2.E8.m2.1.4.7"><mo id="S2.E8.m2.1.4.7.1">(</mo><mi id="S2.E8.m2.1.4.7.2">β</mi><mo id="S2.E8.m2.1.4.7.3">−</mo><mi id="S2.E8.m2.1.4.7.4">r</mi><mo id="S2.E8.m2.1.4.7.5">)</mo></mrow><mo id="S2.E8.m2.1.4.8">]</mo></mrow><mo id="S2.E8.m2.1.5" lspace="0.108em">=</mo><mn id="S2.E8.m2.1.6">0</mn><mo id="S2.E8.m2.1.7">,</mo><mrow id="S2.E8.m2.1.8"></mrow></mrow><annotation encoding="application/x-tex" id="S2.E8.m2.1c">\displaystyle=\frac{2}{\left|\mathcal{D}\right|}\mathop{\mathbb{E}}\left[\|%
\nabla_{\theta}\log(\pi_{\theta}(a\mid x))\|^{2}_{2}\left(\beta-r\right)\right%
]\!=0,\mbox{}</annotation><annotation encoding="application/x-llamapun" id="S2.E8.m2.1d">= divide start_ARG 2 end_ARG start_ARG | caligraphic_D | end_ARG blackboard_E [ ∥ ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT roman_log ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ∣ italic_x ) ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_β - italic_r ) ] = 0 ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p6.3">which results in the following optimal baseline correction:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\beta^{*}=\frac{\mathop{\mathbb{E}}\left[\|\nabla_{\theta}\log(\pi_{\theta}(a|%
x))\|^{2}_{2}r(a,x)\right]}{\mathop{\mathbb{E}}\left[\|\nabla_{\theta}\log(\pi%
_{\theta}(a|x))\|^{2}_{2}\right]}," class="ltx_math_unparsed" display="block" id="S2.E9.m1.1"><semantics id="S2.E9.m1.1a"><mrow id="S2.E9.m1.1.1.1"><mrow id="S2.E9.m1.1.1.1.1"><msup id="S2.E9.m1.1.1.1.1.2"><mi id="S2.E9.m1.1.1.1.1.2.2">β</mi><mo id="S2.E9.m1.1.1.1.1.2.3">∗</mo></msup><mo id="S2.E9.m1.1.1.1.1.1">=</mo><mfrac id="S2.E9.m1.1.1.1.1.3"><mrow id="S2.E9.m1.1.1.1.1.3.2"><mo id="S2.E9.m1.1.1.1.1.3.2.1" rspace="0em">𝔼</mo><mrow id="S2.E9.m1.1.1.1.1.3.2.2"><mo id="S2.E9.m1.1.1.1.1.3.2.2.1">[</mo><mo id="S2.E9.m1.1.1.1.1.3.2.2.2" lspace="0em" rspace="0.167em">∥</mo><msub id="S2.E9.m1.1.1.1.1.3.2.2.3"><mo id="S2.E9.m1.1.1.1.1.3.2.2.3.2" rspace="0.167em">∇</mo><mi id="S2.E9.m1.1.1.1.1.3.2.2.3.3">θ</mi></msub><mi id="S2.E9.m1.1.1.1.1.3.2.2.4">log</mi><mrow id="S2.E9.m1.1.1.1.1.3.2.2.5"><mo id="S2.E9.m1.1.1.1.1.3.2.2.5.1" stretchy="false">(</mo><msub id="S2.E9.m1.1.1.1.1.3.2.2.5.2"><mi id="S2.E9.m1.1.1.1.1.3.2.2.5.2.2">π</mi><mi id="S2.E9.m1.1.1.1.1.3.2.2.5.2.3">θ</mi></msub><mrow id="S2.E9.m1.1.1.1.1.3.2.2.5.3"><mo id="S2.E9.m1.1.1.1.1.3.2.2.5.3.1" stretchy="false">(</mo><mi id="S2.E9.m1.1.1.1.1.3.2.2.5.3.2">a</mi><mo fence="false" id="S2.E9.m1.1.1.1.1.3.2.2.5.3.3" rspace="0.167em" stretchy="false">|</mo><mi id="S2.E9.m1.1.1.1.1.3.2.2.5.3.4">x</mi><mo id="S2.E9.m1.1.1.1.1.3.2.2.5.3.5" stretchy="false">)</mo></mrow><mo id="S2.E9.m1.1.1.1.1.3.2.2.5.4" stretchy="false">)</mo></mrow><msubsup id="S2.E9.m1.1.1.1.1.3.2.2.6"><mo id="S2.E9.m1.1.1.1.1.3.2.2.6.2.2" lspace="0em" rspace="0.167em">∥</mo><mn id="S2.E9.m1.1.1.1.1.3.2.2.6.3">2</mn><mn id="S2.E9.m1.1.1.1.1.3.2.2.6.2.3">2</mn></msubsup><mi id="S2.E9.m1.1.1.1.1.3.2.2.7">r</mi><mrow id="S2.E9.m1.1.1.1.1.3.2.2.8"><mo id="S2.E9.m1.1.1.1.1.3.2.2.8.1" stretchy="false">(</mo><mi id="S2.E9.m1.1.1.1.1.3.2.2.8.2">a</mi><mo id="S2.E9.m1.1.1.1.1.3.2.2.8.3">,</mo><mi id="S2.E9.m1.1.1.1.1.3.2.2.8.4">x</mi><mo id="S2.E9.m1.1.1.1.1.3.2.2.8.5" stretchy="false">)</mo></mrow><mo id="S2.E9.m1.1.1.1.1.3.2.2.9">]</mo></mrow></mrow><mrow id="S2.E9.m1.1.1.1.1.3.3"><mo id="S2.E9.m1.1.1.1.1.3.3.1" rspace="0em">𝔼</mo><mrow id="S2.E9.m1.1.1.1.1.3.3.2"><mo id="S2.E9.m1.1.1.1.1.3.3.2.1">[</mo><mo id="S2.E9.m1.1.1.1.1.3.3.2.2" lspace="0em" rspace="0.167em">∥</mo><msub id="S2.E9.m1.1.1.1.1.3.3.2.3"><mo id="S2.E9.m1.1.1.1.1.3.3.2.3.2" rspace="0.167em">∇</mo><mi id="S2.E9.m1.1.1.1.1.3.3.2.3.3">θ</mi></msub><mi id="S2.E9.m1.1.1.1.1.3.3.2.4">log</mi><mrow id="S2.E9.m1.1.1.1.1.3.3.2.5"><mo id="S2.E9.m1.1.1.1.1.3.3.2.5.1" stretchy="false">(</mo><msub id="S2.E9.m1.1.1.1.1.3.3.2.5.2"><mi id="S2.E9.m1.1.1.1.1.3.3.2.5.2.2">π</mi><mi id="S2.E9.m1.1.1.1.1.3.3.2.5.2.3">θ</mi></msub><mrow id="S2.E9.m1.1.1.1.1.3.3.2.5.3"><mo id="S2.E9.m1.1.1.1.1.3.3.2.5.3.1" stretchy="false">(</mo><mi id="S2.E9.m1.1.1.1.1.3.3.2.5.3.2">a</mi><mo fence="false" id="S2.E9.m1.1.1.1.1.3.3.2.5.3.3" rspace="0.167em" stretchy="false">|</mo><mi id="S2.E9.m1.1.1.1.1.3.3.2.5.3.4">x</mi><mo id="S2.E9.m1.1.1.1.1.3.3.2.5.3.5" stretchy="false">)</mo></mrow><mo id="S2.E9.m1.1.1.1.1.3.3.2.5.4" stretchy="false">)</mo></mrow><msubsup id="S2.E9.m1.1.1.1.1.3.3.2.6"><mo id="S2.E9.m1.1.1.1.1.3.3.2.6.2.2" lspace="0em" rspace="0.167em">∥</mo><mn id="S2.E9.m1.1.1.1.1.3.3.2.6.3">2</mn><mn id="S2.E9.m1.1.1.1.1.3.3.2.6.2.3">2</mn></msubsup><mo id="S2.E9.m1.1.1.1.1.3.3.2.7">]</mo></mrow></mrow></mfrac></mrow><mo id="S2.E9.m1.1.1.1.2">,</mo></mrow><annotation encoding="application/x-tex" id="S2.E9.m1.1b">\beta^{*}=\frac{\mathop{\mathbb{E}}\left[\|\nabla_{\theta}\log(\pi_{\theta}(a|%
x))\|^{2}_{2}r(a,x)\right]}{\mathop{\mathbb{E}}\left[\|\nabla_{\theta}\log(\pi%
_{\theta}(a|x))\|^{2}_{2}\right]},</annotation><annotation encoding="application/x-llamapun" id="S2.E9.m1.1c">italic_β start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = divide start_ARG blackboard_E [ ∥ ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT roman_log ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | italic_x ) ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_r ( italic_a , italic_x ) ] end_ARG start_ARG blackboard_E [ ∥ ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT roman_log ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | italic_x ) ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ] end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p6.4">and the empirical estimate of the optimal baseline correction:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widehat{\beta^{*}}=\frac{\sum_{(x,a,r)\in\mathcal{D}}\left[\|\nabla_{\theta}%
\log(\pi_{\theta}(a|x))\|^{2}_{2}r(a,x)\right]}{\sum_{(x,a,r)\in\mathcal{D}}%
\left[\|\nabla_{\theta}\log(\pi_{\theta}(a|x))\|^{2}_{2}\right]}." class="ltx_math_unparsed" display="block" id="S2.E10.m1.7"><semantics id="S2.E10.m1.7a"><mrow id="S2.E10.m1.7.7.1"><mrow id="S2.E10.m1.7.7.1.1"><mover accent="true" id="S2.E10.m1.7.7.1.1.2"><msup id="S2.E10.m1.7.7.1.1.2.2"><mi id="S2.E10.m1.7.7.1.1.2.2.2">β</mi><mo id="S2.E10.m1.7.7.1.1.2.2.3">∗</mo></msup><mo id="S2.E10.m1.7.7.1.1.2.1">^</mo></mover><mo id="S2.E10.m1.7.7.1.1.1">=</mo><mfrac id="S2.E10.m1.6.6"><mrow id="S2.E10.m1.3.3.3"><msub id="S2.E10.m1.3.3.3.4"><mo id="S2.E10.m1.3.3.3.4.2">∑</mo><mrow id="S2.E10.m1.3.3.3.3.3"><mrow id="S2.E10.m1.3.3.3.3.3.5.2"><mo id="S2.E10.m1.3.3.3.3.3.5.2.1" stretchy="false">(</mo><mi id="S2.E10.m1.1.1.1.1.1.1">x</mi><mo id="S2.E10.m1.3.3.3.3.3.5.2.2">,</mo><mi id="S2.E10.m1.2.2.2.2.2.2">a</mi><mo id="S2.E10.m1.3.3.3.3.3.5.2.3">,</mo><mi id="S2.E10.m1.3.3.3.3.3.3">r</mi><mo id="S2.E10.m1.3.3.3.3.3.5.2.4" stretchy="false">)</mo></mrow><mo id="S2.E10.m1.3.3.3.3.3.4">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E10.m1.3.3.3.3.3.6">𝒟</mi></mrow></msub><mrow id="S2.E10.m1.3.3.3.5"><mo id="S2.E10.m1.3.3.3.5.1" lspace="0em">[</mo><mo id="S2.E10.m1.3.3.3.5.2" lspace="0em" rspace="0.167em">∥</mo><msub id="S2.E10.m1.3.3.3.5.3"><mo id="S2.E10.m1.3.3.3.5.3.2" rspace="0.167em">∇</mo><mi id="S2.E10.m1.3.3.3.5.3.3">θ</mi></msub><mi id="S2.E10.m1.3.3.3.5.4">log</mi><mrow id="S2.E10.m1.3.3.3.5.5"><mo id="S2.E10.m1.3.3.3.5.5.1" stretchy="false">(</mo><msub id="S2.E10.m1.3.3.3.5.5.2"><mi id="S2.E10.m1.3.3.3.5.5.2.2">π</mi><mi id="S2.E10.m1.3.3.3.5.5.2.3">θ</mi></msub><mrow id="S2.E10.m1.3.3.3.5.5.3"><mo id="S2.E10.m1.3.3.3.5.5.3.1" stretchy="false">(</mo><mi id="S2.E10.m1.3.3.3.5.5.3.2">a</mi><mo fence="false" id="S2.E10.m1.3.3.3.5.5.3.3" rspace="0.167em" stretchy="false">|</mo><mi id="S2.E10.m1.3.3.3.5.5.3.4">x</mi><mo id="S2.E10.m1.3.3.3.5.5.3.5" stretchy="false">)</mo></mrow><mo id="S2.E10.m1.3.3.3.5.5.4" stretchy="false">)</mo></mrow><msubsup id="S2.E10.m1.3.3.3.5.6"><mo id="S2.E10.m1.3.3.3.5.6.2.2" lspace="0em" rspace="0.167em">∥</mo><mn id="S2.E10.m1.3.3.3.5.6.3">2</mn><mn id="S2.E10.m1.3.3.3.5.6.2.3">2</mn></msubsup><mi id="S2.E10.m1.3.3.3.5.7">r</mi><mrow id="S2.E10.m1.3.3.3.5.8"><mo id="S2.E10.m1.3.3.3.5.8.1" stretchy="false">(</mo><mi id="S2.E10.m1.3.3.3.5.8.2">a</mi><mo id="S2.E10.m1.3.3.3.5.8.3">,</mo><mi id="S2.E10.m1.3.3.3.5.8.4">x</mi><mo id="S2.E10.m1.3.3.3.5.8.5" stretchy="false">)</mo></mrow><mo id="S2.E10.m1.3.3.3.5.9">]</mo></mrow></mrow><mrow id="S2.E10.m1.6.6.6"><msub id="S2.E10.m1.6.6.6.4"><mo id="S2.E10.m1.6.6.6.4.2">∑</mo><mrow id="S2.E10.m1.6.6.6.3.3"><mrow id="S2.E10.m1.6.6.6.3.3.5.2"><mo id="S2.E10.m1.6.6.6.3.3.5.2.1" stretchy="false">(</mo><mi id="S2.E10.m1.4.4.4.1.1.1">x</mi><mo id="S2.E10.m1.6.6.6.3.3.5.2.2">,</mo><mi id="S2.E10.m1.5.5.5.2.2.2">a</mi><mo id="S2.E10.m1.6.6.6.3.3.5.2.3">,</mo><mi id="S2.E10.m1.6.6.6.3.3.3">r</mi><mo id="S2.E10.m1.6.6.6.3.3.5.2.4" stretchy="false">)</mo></mrow><mo id="S2.E10.m1.6.6.6.3.3.4">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E10.m1.6.6.6.3.3.6">𝒟</mi></mrow></msub><mrow id="S2.E10.m1.6.6.6.5"><mo id="S2.E10.m1.6.6.6.5.1" lspace="0em">[</mo><mo id="S2.E10.m1.6.6.6.5.2" lspace="0em" rspace="0.167em">∥</mo><msub id="S2.E10.m1.6.6.6.5.3"><mo id="S2.E10.m1.6.6.6.5.3.2" rspace="0.167em">∇</mo><mi id="S2.E10.m1.6.6.6.5.3.3">θ</mi></msub><mi id="S2.E10.m1.6.6.6.5.4">log</mi><mrow id="S2.E10.m1.6.6.6.5.5"><mo id="S2.E10.m1.6.6.6.5.5.1" stretchy="false">(</mo><msub id="S2.E10.m1.6.6.6.5.5.2"><mi id="S2.E10.m1.6.6.6.5.5.2.2">π</mi><mi id="S2.E10.m1.6.6.6.5.5.2.3">θ</mi></msub><mrow id="S2.E10.m1.6.6.6.5.5.3"><mo id="S2.E10.m1.6.6.6.5.5.3.1" stretchy="false">(</mo><mi id="S2.E10.m1.6.6.6.5.5.3.2">a</mi><mo fence="false" id="S2.E10.m1.6.6.6.5.5.3.3" rspace="0.167em" stretchy="false">|</mo><mi id="S2.E10.m1.6.6.6.5.5.3.4">x</mi><mo id="S2.E10.m1.6.6.6.5.5.3.5" stretchy="false">)</mo></mrow><mo id="S2.E10.m1.6.6.6.5.5.4" stretchy="false">)</mo></mrow><msubsup id="S2.E10.m1.6.6.6.5.6"><mo id="S2.E10.m1.6.6.6.5.6.2.2" lspace="0em" rspace="0.167em">∥</mo><mn id="S2.E10.m1.6.6.6.5.6.3">2</mn><mn id="S2.E10.m1.6.6.6.5.6.2.3">2</mn></msubsup><mo id="S2.E10.m1.6.6.6.5.7">]</mo></mrow></mrow></mfrac></mrow><mo id="S2.E10.m1.7.7.1.2" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S2.E10.m1.7b">\widehat{\beta^{*}}=\frac{\sum_{(x,a,r)\in\mathcal{D}}\left[\|\nabla_{\theta}%
\log(\pi_{\theta}(a|x))\|^{2}_{2}r(a,x)\right]}{\sum_{(x,a,r)\in\mathcal{D}}%
\left[\|\nabla_{\theta}\log(\pi_{\theta}(a|x))\|^{2}_{2}\right]}.</annotation><annotation encoding="application/x-llamapun" id="S2.E10.m1.7c">over^ start_ARG italic_β start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_ARG = divide start_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) ∈ caligraphic_D end_POSTSUBSCRIPT [ ∥ ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT roman_log ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | italic_x ) ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_r ( italic_a , italic_x ) ] end_ARG start_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) ∈ caligraphic_D end_POSTSUBSCRIPT [ ∥ ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT roman_log ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | italic_x ) ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ] end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p6.5">This derivation follows the more general derivation from <cite class="ltx_cite ltx_citemacro_citet">Greensmith et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib17" title="">2004</a>)</cite> for partially observable Markov decision processes (POMDPs). We have not encountered its use in the existing bandit literature applied to recommendation problems. In Section <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.SS2" title="3.2. Minimizing gradient variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">3.2</span></a>, we show that a similar line of reasoning can be applied to derive a variance-optimal gradient for the off-policy contextual bandit setup.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Off-policy estimation for general bandits</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.4">Deploying <math alttext="\pi" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_π</annotation></semantics></math> is a costly prerequisite for estimating <math alttext="V(\pi)" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><mrow id="S2.SS2.p1.2.m2.1.2" xref="S2.SS2.p1.2.m2.1.2.cmml"><mi id="S2.SS2.p1.2.m2.1.2.2" xref="S2.SS2.p1.2.m2.1.2.2.cmml">V</mi><mo id="S2.SS2.p1.2.m2.1.2.1" xref="S2.SS2.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.p1.2.m2.1.2.3.2" xref="S2.SS2.p1.2.m2.1.2.cmml"><mo id="S2.SS2.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S2.SS2.p1.2.m2.1.2.cmml">(</mo><mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">π</mi><mo id="S2.SS2.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S2.SS2.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.2.cmml" xref="S2.SS2.p1.2.m2.1.2"><times id="S2.SS2.p1.2.m2.1.2.1.cmml" xref="S2.SS2.p1.2.m2.1.2.1"></times><ci id="S2.SS2.p1.2.m2.1.2.2.cmml" xref="S2.SS2.p1.2.m2.1.2.2">𝑉</ci><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">𝜋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">V(\pi)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">italic_V ( italic_π )</annotation></semantics></math>, that comes with the risk of deploying a possible poorly valued <math alttext="\pi" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.1"><semantics id="S2.SS2.p1.3.m3.1a"><mi id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><ci id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.1d">italic_π</annotation></semantics></math>.
Therefore, commonly in real-world model validation pipelines, practitioners wish to estimate <math alttext="V(\pi)" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m4.1"><semantics id="S2.SS2.p1.4.m4.1a"><mrow id="S2.SS2.p1.4.m4.1.2" xref="S2.SS2.p1.4.m4.1.2.cmml"><mi id="S2.SS2.p1.4.m4.1.2.2" xref="S2.SS2.p1.4.m4.1.2.2.cmml">V</mi><mo id="S2.SS2.p1.4.m4.1.2.1" xref="S2.SS2.p1.4.m4.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.p1.4.m4.1.2.3.2" xref="S2.SS2.p1.4.m4.1.2.cmml"><mo id="S2.SS2.p1.4.m4.1.2.3.2.1" stretchy="false" xref="S2.SS2.p1.4.m4.1.2.cmml">(</mo><mi id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml">π</mi><mo id="S2.SS2.p1.4.m4.1.2.3.2.2" stretchy="false" xref="S2.SS2.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><apply id="S2.SS2.p1.4.m4.1.2.cmml" xref="S2.SS2.p1.4.m4.1.2"><times id="S2.SS2.p1.4.m4.1.2.1.cmml" xref="S2.SS2.p1.4.m4.1.2.1"></times><ci id="S2.SS2.p1.4.m4.1.2.2.cmml" xref="S2.SS2.p1.4.m4.1.2.2">𝑉</ci><ci id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">𝜋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">V(\pi)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m4.1d">italic_V ( italic_π )</annotation></semantics></math> <em class="ltx_emph ltx_font_italic" id="S2.SS2.p1.4.1">before</em> deployment.
Accordingly, we will address this <em class="ltx_emph ltx_font_italic" id="S2.SS2.p1.4.2">counterfactual</em> evaluation scenario that falls inside the field of off-policy estimation (OPE) <cite class="ltx_cite ltx_citemacro_citep">(Saito et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib53" title="">2021</a>; Vasile et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib65" title="">2020</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.2">The expectation <math alttext="V(\pi)" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1"><semantics id="S2.SS2.p2.1.m1.1a"><mrow id="S2.SS2.p2.1.m1.1.2" xref="S2.SS2.p2.1.m1.1.2.cmml"><mi id="S2.SS2.p2.1.m1.1.2.2" xref="S2.SS2.p2.1.m1.1.2.2.cmml">V</mi><mo id="S2.SS2.p2.1.m1.1.2.1" xref="S2.SS2.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.p2.1.m1.1.2.3.2" xref="S2.SS2.p2.1.m1.1.2.cmml"><mo id="S2.SS2.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S2.SS2.p2.1.m1.1.2.cmml">(</mo><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">π</mi><mo id="S2.SS2.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S2.SS2.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.2"><times id="S2.SS2.p2.1.m1.1.2.1.cmml" xref="S2.SS2.p2.1.m1.1.2.1"></times><ci id="S2.SS2.p2.1.m1.1.2.2.cmml" xref="S2.SS2.p2.1.m1.1.2.2">𝑉</ci><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝜋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">V(\pi)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">italic_V ( italic_π )</annotation></semantics></math> can be unbiasedly estimated using samples from a <em class="ltx_emph ltx_font_italic" id="S2.SS2.p2.2.1">different</em> policy <math alttext="\pi_{0}" class="ltx_Math" display="inline" id="S2.SS2.p2.2.m2.1"><semantics id="S2.SS2.p2.2.m2.1a"><msub id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml">π</mi><mn id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">𝜋</ci><cn id="S2.SS2.p2.2.m2.1.1.3.cmml" type="integer" xref="S2.SS2.p2.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">\pi_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.1d">italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> through <em class="ltx_emph ltx_font_italic" id="S2.SS2.p2.2.2">importance sampling</em>, also known as inverse propensity score weighting (IPS) <cite class="ltx_cite ltx_citemacro_citep">(Owen, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib46" title="">2013</a>, §9)</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathop{\mathbb{E}}_{x\sim\mathsf{P}(X)}\left[\mathop{\mathbb{E}}_{a\sim\pi(%
\cdot|x)}\left[R\right]\right]=\mathop{\mathbb{E}}_{x\sim\mathsf{P}(X)}\left[%
\mathop{\mathbb{E}}_{a\sim\pi_{0}(\cdot|x)}\left[\frac{\pi(a\mid x)}{\pi_{0}(a%
\mid x)}R\right]\right]." class="ltx_math_unparsed" display="block" id="S2.E11.m1.6"><semantics id="S2.E11.m1.6a"><mrow id="S2.E11.m1.6.6.1"><mrow id="S2.E11.m1.6.6.1.1"><mrow id="S2.E11.m1.6.6.1.1.1"><munder id="S2.E11.m1.6.6.1.1.1.2"><mo id="S2.E11.m1.6.6.1.1.1.2.2" movablelimits="false">𝔼</mo><mrow id="S2.E11.m1.1.1.1"><mi id="S2.E11.m1.1.1.1.3">x</mi><mo id="S2.E11.m1.1.1.1.2">∼</mo><mrow id="S2.E11.m1.1.1.1.4"><mi id="S2.E11.m1.1.1.1.4.2">𝖯</mi><mo id="S2.E11.m1.1.1.1.4.1">⁢</mo><mrow id="S2.E11.m1.1.1.1.4.3.2"><mo id="S2.E11.m1.1.1.1.4.3.2.1" stretchy="false">(</mo><mi id="S2.E11.m1.1.1.1.1">X</mi><mo id="S2.E11.m1.1.1.1.4.3.2.2" stretchy="false">)</mo></mrow></mrow></mrow></munder><mrow id="S2.E11.m1.6.6.1.1.1.1.1"><mo id="S2.E11.m1.6.6.1.1.1.1.1.2" lspace="0em">[</mo><mrow id="S2.E11.m1.6.6.1.1.1.1.1.1"><munder id="S2.E11.m1.6.6.1.1.1.1.1.1.1"><mo id="S2.E11.m1.6.6.1.1.1.1.1.1.1.2" lspace="0em" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S2.E11.m1.6.6.1.1.1.1.1.1.1.3"><mi id="S2.E11.m1.6.6.1.1.1.1.1.1.1.3.1">a</mi><mo id="S2.E11.m1.6.6.1.1.1.1.1.1.1.3.2">∼</mo><mi id="S2.E11.m1.6.6.1.1.1.1.1.1.1.3.3">π</mi><mrow id="S2.E11.m1.6.6.1.1.1.1.1.1.1.3.4"><mo id="S2.E11.m1.6.6.1.1.1.1.1.1.1.3.4.1" stretchy="false">(</mo><mo id="S2.E11.m1.6.6.1.1.1.1.1.1.1.3.4.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S2.E11.m1.6.6.1.1.1.1.1.1.1.3.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="S2.E11.m1.6.6.1.1.1.1.1.1.1.3.4.4">x</mi><mo id="S2.E11.m1.6.6.1.1.1.1.1.1.1.3.4.5" stretchy="false">)</mo></mrow></mrow></munder><mrow id="S2.E11.m1.6.6.1.1.1.1.1.1.2.2"><mo id="S2.E11.m1.6.6.1.1.1.1.1.1.2.2.1">[</mo><mi id="S2.E11.m1.5.5">R</mi><mo id="S2.E11.m1.6.6.1.1.1.1.1.1.2.2.2">]</mo></mrow></mrow><mo id="S2.E11.m1.6.6.1.1.1.1.1.3">]</mo></mrow></mrow><mo id="S2.E11.m1.6.6.1.1.3" rspace="0.1389em">=</mo><mrow id="S2.E11.m1.6.6.1.1.2"><munder id="S2.E11.m1.6.6.1.1.2.2"><mo id="S2.E11.m1.6.6.1.1.2.2.2" lspace="0.1389em" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S2.E11.m1.2.2.1"><mi id="S2.E11.m1.2.2.1.3">x</mi><mo id="S2.E11.m1.2.2.1.2">∼</mo><mrow id="S2.E11.m1.2.2.1.4"><mi id="S2.E11.m1.2.2.1.4.2">𝖯</mi><mo id="S2.E11.m1.2.2.1.4.1">⁢</mo><mrow id="S2.E11.m1.2.2.1.4.3.2"><mo id="S2.E11.m1.2.2.1.4.3.2.1" stretchy="false">(</mo><mi id="S2.E11.m1.2.2.1.1">X</mi><mo id="S2.E11.m1.2.2.1.4.3.2.2" stretchy="false">)</mo></mrow></mrow></mrow></munder><mrow id="S2.E11.m1.6.6.1.1.2.1.1"><mo id="S2.E11.m1.6.6.1.1.2.1.1.2">[</mo><mrow id="S2.E11.m1.6.6.1.1.2.1.1.1"><munder id="S2.E11.m1.6.6.1.1.2.1.1.1.2"><mo id="S2.E11.m1.6.6.1.1.2.1.1.1.2.2" lspace="0em" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S2.E11.m1.6.6.1.1.2.1.1.1.2.3"><mi id="S2.E11.m1.6.6.1.1.2.1.1.1.2.3.1">a</mi><mo id="S2.E11.m1.6.6.1.1.2.1.1.1.2.3.2">∼</mo><msub id="S2.E11.m1.6.6.1.1.2.1.1.1.2.3.3"><mi id="S2.E11.m1.6.6.1.1.2.1.1.1.2.3.3.2">π</mi><mn id="S2.E11.m1.6.6.1.1.2.1.1.1.2.3.3.3">0</mn></msub><mrow id="S2.E11.m1.6.6.1.1.2.1.1.1.2.3.4"><mo id="S2.E11.m1.6.6.1.1.2.1.1.1.2.3.4.1" stretchy="false">(</mo><mo id="S2.E11.m1.6.6.1.1.2.1.1.1.2.3.4.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S2.E11.m1.6.6.1.1.2.1.1.1.2.3.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="S2.E11.m1.6.6.1.1.2.1.1.1.2.3.4.4">x</mi><mo id="S2.E11.m1.6.6.1.1.2.1.1.1.2.3.4.5" stretchy="false">)</mo></mrow></mrow></munder><mrow id="S2.E11.m1.6.6.1.1.2.1.1.1.1.1"><mo id="S2.E11.m1.6.6.1.1.2.1.1.1.1.1.2">[</mo><mrow id="S2.E11.m1.6.6.1.1.2.1.1.1.1.1.1"><mfrac id="S2.E11.m1.4.4"><mrow id="S2.E11.m1.3.3.1"><mi id="S2.E11.m1.3.3.1.3">π</mi><mo id="S2.E11.m1.3.3.1.2">⁢</mo><mrow id="S2.E11.m1.3.3.1.1.1"><mo id="S2.E11.m1.3.3.1.1.1.2" stretchy="false">(</mo><mrow id="S2.E11.m1.3.3.1.1.1.1"><mi id="S2.E11.m1.3.3.1.1.1.1.2">a</mi><mo id="S2.E11.m1.3.3.1.1.1.1.1">∣</mo><mi id="S2.E11.m1.3.3.1.1.1.1.3">x</mi></mrow><mo id="S2.E11.m1.3.3.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mrow id="S2.E11.m1.4.4.2"><msub id="S2.E11.m1.4.4.2.3"><mi id="S2.E11.m1.4.4.2.3.2">π</mi><mn id="S2.E11.m1.4.4.2.3.3">0</mn></msub><mo id="S2.E11.m1.4.4.2.2">⁢</mo><mrow id="S2.E11.m1.4.4.2.1.1"><mo id="S2.E11.m1.4.4.2.1.1.2" stretchy="false">(</mo><mrow id="S2.E11.m1.4.4.2.1.1.1"><mi id="S2.E11.m1.4.4.2.1.1.1.2">a</mi><mo id="S2.E11.m1.4.4.2.1.1.1.1">∣</mo><mi id="S2.E11.m1.4.4.2.1.1.1.3">x</mi></mrow><mo id="S2.E11.m1.4.4.2.1.1.3" stretchy="false">)</mo></mrow></mrow></mfrac><mo id="S2.E11.m1.6.6.1.1.2.1.1.1.1.1.1.1">⁢</mo><mi id="S2.E11.m1.6.6.1.1.2.1.1.1.1.1.1.2">R</mi></mrow><mo id="S2.E11.m1.6.6.1.1.2.1.1.1.1.1.3">]</mo></mrow></mrow><mo id="S2.E11.m1.6.6.1.1.2.1.1.3">]</mo></mrow></mrow></mrow><mo id="S2.E11.m1.6.6.1.2" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S2.E11.m1.6b">\mathop{\mathbb{E}}_{x\sim\mathsf{P}(X)}\left[\mathop{\mathbb{E}}_{a\sim\pi(%
\cdot|x)}\left[R\right]\right]=\mathop{\mathbb{E}}_{x\sim\mathsf{P}(X)}\left[%
\mathop{\mathbb{E}}_{a\sim\pi_{0}(\cdot|x)}\left[\frac{\pi(a\mid x)}{\pi_{0}(a%
\mid x)}R\right]\right].</annotation><annotation encoding="application/x-llamapun" id="S2.E11.m1.6c">blackboard_E start_POSTSUBSCRIPT italic_x ∼ sansserif_P ( italic_X ) end_POSTSUBSCRIPT [ blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π ( ⋅ | italic_x ) end_POSTSUBSCRIPT [ italic_R ] ] = blackboard_E start_POSTSUBSCRIPT italic_x ∼ sansserif_P ( italic_X ) end_POSTSUBSCRIPT [ blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( ⋅ | italic_x ) end_POSTSUBSCRIPT [ divide start_ARG italic_π ( italic_a ∣ italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ∣ italic_x ) end_ARG italic_R ] ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p2.4">To ensure that the so-called <em class="ltx_emph ltx_font_italic" id="S2.SS2.p2.4.1">importance weights</em> <math alttext="\frac{\pi(a\mid x)}{\pi_{0}(a\mid x)}" class="ltx_Math" display="inline" id="S2.SS2.p2.3.m1.2"><semantics id="S2.SS2.p2.3.m1.2a"><mfrac id="S2.SS2.p2.3.m1.2.2" xref="S2.SS2.p2.3.m1.2.2.cmml"><mrow id="S2.SS2.p2.3.m1.1.1.1" xref="S2.SS2.p2.3.m1.1.1.1.cmml"><mi id="S2.SS2.p2.3.m1.1.1.1.3" xref="S2.SS2.p2.3.m1.1.1.1.3.cmml">π</mi><mo id="S2.SS2.p2.3.m1.1.1.1.2" xref="S2.SS2.p2.3.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p2.3.m1.1.1.1.1.1" xref="S2.SS2.p2.3.m1.1.1.1.1.1.1.cmml"><mo id="S2.SS2.p2.3.m1.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p2.3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.3.m1.1.1.1.1.1.1" xref="S2.SS2.p2.3.m1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.3.m1.1.1.1.1.1.1.2" xref="S2.SS2.p2.3.m1.1.1.1.1.1.1.2.cmml">a</mi><mo id="S2.SS2.p2.3.m1.1.1.1.1.1.1.1" xref="S2.SS2.p2.3.m1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S2.SS2.p2.3.m1.1.1.1.1.1.1.3" xref="S2.SS2.p2.3.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS2.p2.3.m1.1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p2.3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.SS2.p2.3.m1.2.2.2" xref="S2.SS2.p2.3.m1.2.2.2.cmml"><msub id="S2.SS2.p2.3.m1.2.2.2.3" xref="S2.SS2.p2.3.m1.2.2.2.3.cmml"><mi id="S2.SS2.p2.3.m1.2.2.2.3.2" xref="S2.SS2.p2.3.m1.2.2.2.3.2.cmml">π</mi><mn id="S2.SS2.p2.3.m1.2.2.2.3.3" xref="S2.SS2.p2.3.m1.2.2.2.3.3.cmml">0</mn></msub><mo id="S2.SS2.p2.3.m1.2.2.2.2" xref="S2.SS2.p2.3.m1.2.2.2.2.cmml">⁢</mo><mrow id="S2.SS2.p2.3.m1.2.2.2.1.1" xref="S2.SS2.p2.3.m1.2.2.2.1.1.1.cmml"><mo id="S2.SS2.p2.3.m1.2.2.2.1.1.2" stretchy="false" xref="S2.SS2.p2.3.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.3.m1.2.2.2.1.1.1" xref="S2.SS2.p2.3.m1.2.2.2.1.1.1.cmml"><mi id="S2.SS2.p2.3.m1.2.2.2.1.1.1.2" xref="S2.SS2.p2.3.m1.2.2.2.1.1.1.2.cmml">a</mi><mo id="S2.SS2.p2.3.m1.2.2.2.1.1.1.1" xref="S2.SS2.p2.3.m1.2.2.2.1.1.1.1.cmml">∣</mo><mi id="S2.SS2.p2.3.m1.2.2.2.1.1.1.3" xref="S2.SS2.p2.3.m1.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS2.p2.3.m1.2.2.2.1.1.3" stretchy="false" xref="S2.SS2.p2.3.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m1.2b"><apply id="S2.SS2.p2.3.m1.2.2.cmml" xref="S2.SS2.p2.3.m1.2.2"><divide id="S2.SS2.p2.3.m1.2.2.3.cmml" xref="S2.SS2.p2.3.m1.2.2"></divide><apply id="S2.SS2.p2.3.m1.1.1.1.cmml" xref="S2.SS2.p2.3.m1.1.1.1"><times id="S2.SS2.p2.3.m1.1.1.1.2.cmml" xref="S2.SS2.p2.3.m1.1.1.1.2"></times><ci id="S2.SS2.p2.3.m1.1.1.1.3.cmml" xref="S2.SS2.p2.3.m1.1.1.1.3">𝜋</ci><apply id="S2.SS2.p2.3.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.3.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p2.3.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.3.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p2.3.m1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.3.m1.1.1.1.1.1.1.2">𝑎</ci><ci id="S2.SS2.p2.3.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.3.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.SS2.p2.3.m1.2.2.2.cmml" xref="S2.SS2.p2.3.m1.2.2.2"><times id="S2.SS2.p2.3.m1.2.2.2.2.cmml" xref="S2.SS2.p2.3.m1.2.2.2.2"></times><apply id="S2.SS2.p2.3.m1.2.2.2.3.cmml" xref="S2.SS2.p2.3.m1.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m1.2.2.2.3.1.cmml" xref="S2.SS2.p2.3.m1.2.2.2.3">subscript</csymbol><ci id="S2.SS2.p2.3.m1.2.2.2.3.2.cmml" xref="S2.SS2.p2.3.m1.2.2.2.3.2">𝜋</ci><cn id="S2.SS2.p2.3.m1.2.2.2.3.3.cmml" type="integer" xref="S2.SS2.p2.3.m1.2.2.2.3.3">0</cn></apply><apply id="S2.SS2.p2.3.m1.2.2.2.1.1.1.cmml" xref="S2.SS2.p2.3.m1.2.2.2.1.1"><csymbol cd="latexml" id="S2.SS2.p2.3.m1.2.2.2.1.1.1.1.cmml" xref="S2.SS2.p2.3.m1.2.2.2.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p2.3.m1.2.2.2.1.1.1.2.cmml" xref="S2.SS2.p2.3.m1.2.2.2.1.1.1.2">𝑎</ci><ci id="S2.SS2.p2.3.m1.2.2.2.1.1.1.3.cmml" xref="S2.SS2.p2.3.m1.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m1.2c">\frac{\pi(a\mid x)}{\pi_{0}(a\mid x)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m1.2d">divide start_ARG italic_π ( italic_a ∣ italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ∣ italic_x ) end_ARG</annotation></semantics></math> are well-defined, we assume “<em class="ltx_emph ltx_font_italic" id="S2.SS2.p2.4.2">common support</em>” by the logging policy: <math alttext="\forall a\in\mathcal{A},x\in\mathcal{X}:\pi(a\mid x)&gt;0\implies\pi_{0}(a\mid x)&gt;0" class="ltx_Math" display="inline" id="S2.SS2.p2.4.m2.4"><semantics id="S2.SS2.p2.4.m2.4a"><mrow id="S2.SS2.p2.4.m2.4.4" xref="S2.SS2.p2.4.m2.4.4.cmml"><mrow id="S2.SS2.p2.4.m2.2.2.2.2" xref="S2.SS2.p2.4.m2.2.2.2.3.cmml"><mrow id="S2.SS2.p2.4.m2.1.1.1.1.1" xref="S2.SS2.p2.4.m2.1.1.1.1.1.cmml"><mrow id="S2.SS2.p2.4.m2.1.1.1.1.1.2" xref="S2.SS2.p2.4.m2.1.1.1.1.1.2.cmml"><mo id="S2.SS2.p2.4.m2.1.1.1.1.1.2.1" rspace="0.167em" xref="S2.SS2.p2.4.m2.1.1.1.1.1.2.1.cmml">∀</mo><mi id="S2.SS2.p2.4.m2.1.1.1.1.1.2.2" xref="S2.SS2.p2.4.m2.1.1.1.1.1.2.2.cmml">a</mi></mrow><mo id="S2.SS2.p2.4.m2.1.1.1.1.1.1" xref="S2.SS2.p2.4.m2.1.1.1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.4.m2.1.1.1.1.1.3" xref="S2.SS2.p2.4.m2.1.1.1.1.1.3.cmml">𝒜</mi></mrow><mo id="S2.SS2.p2.4.m2.2.2.2.2.3" xref="S2.SS2.p2.4.m2.2.2.2.3a.cmml">,</mo><mrow id="S2.SS2.p2.4.m2.2.2.2.2.2" xref="S2.SS2.p2.4.m2.2.2.2.2.2.cmml"><mi id="S2.SS2.p2.4.m2.2.2.2.2.2.2" xref="S2.SS2.p2.4.m2.2.2.2.2.2.2.cmml">x</mi><mo id="S2.SS2.p2.4.m2.2.2.2.2.2.1" xref="S2.SS2.p2.4.m2.2.2.2.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.4.m2.2.2.2.2.2.3" xref="S2.SS2.p2.4.m2.2.2.2.2.2.3.cmml">𝒳</mi></mrow></mrow><mo id="S2.SS2.p2.4.m2.4.4.5" lspace="0.278em" rspace="0.278em" xref="S2.SS2.p2.4.m2.4.4.5.cmml">:</mo><mrow id="S2.SS2.p2.4.m2.4.4.4" xref="S2.SS2.p2.4.m2.4.4.4.cmml"><mrow id="S2.SS2.p2.4.m2.3.3.3.1" xref="S2.SS2.p2.4.m2.3.3.3.1.cmml"><mi id="S2.SS2.p2.4.m2.3.3.3.1.3" xref="S2.SS2.p2.4.m2.3.3.3.1.3.cmml">π</mi><mo id="S2.SS2.p2.4.m2.3.3.3.1.2" xref="S2.SS2.p2.4.m2.3.3.3.1.2.cmml">⁢</mo><mrow id="S2.SS2.p2.4.m2.3.3.3.1.1.1" xref="S2.SS2.p2.4.m2.3.3.3.1.1.1.1.cmml"><mo id="S2.SS2.p2.4.m2.3.3.3.1.1.1.2" stretchy="false" xref="S2.SS2.p2.4.m2.3.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.4.m2.3.3.3.1.1.1.1" xref="S2.SS2.p2.4.m2.3.3.3.1.1.1.1.cmml"><mi id="S2.SS2.p2.4.m2.3.3.3.1.1.1.1.2" xref="S2.SS2.p2.4.m2.3.3.3.1.1.1.1.2.cmml">a</mi><mo id="S2.SS2.p2.4.m2.3.3.3.1.1.1.1.1" xref="S2.SS2.p2.4.m2.3.3.3.1.1.1.1.1.cmml">∣</mo><mi id="S2.SS2.p2.4.m2.3.3.3.1.1.1.1.3" xref="S2.SS2.p2.4.m2.3.3.3.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS2.p2.4.m2.3.3.3.1.1.1.3" stretchy="false" xref="S2.SS2.p2.4.m2.3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p2.4.m2.4.4.4.4" xref="S2.SS2.p2.4.m2.4.4.4.4.cmml">&gt;</mo><mn id="S2.SS2.p2.4.m2.4.4.4.5" xref="S2.SS2.p2.4.m2.4.4.4.5.cmml">0</mn><mo id="S2.SS2.p2.4.m2.4.4.4.6" stretchy="false" xref="S2.SS2.p2.4.m2.4.4.4.6.cmml">⟹</mo><mrow id="S2.SS2.p2.4.m2.4.4.4.2" xref="S2.SS2.p2.4.m2.4.4.4.2.cmml"><msub id="S2.SS2.p2.4.m2.4.4.4.2.3" xref="S2.SS2.p2.4.m2.4.4.4.2.3.cmml"><mi id="S2.SS2.p2.4.m2.4.4.4.2.3.2" xref="S2.SS2.p2.4.m2.4.4.4.2.3.2.cmml">π</mi><mn id="S2.SS2.p2.4.m2.4.4.4.2.3.3" xref="S2.SS2.p2.4.m2.4.4.4.2.3.3.cmml">0</mn></msub><mo id="S2.SS2.p2.4.m2.4.4.4.2.2" xref="S2.SS2.p2.4.m2.4.4.4.2.2.cmml">⁢</mo><mrow id="S2.SS2.p2.4.m2.4.4.4.2.1.1" xref="S2.SS2.p2.4.m2.4.4.4.2.1.1.1.cmml"><mo id="S2.SS2.p2.4.m2.4.4.4.2.1.1.2" stretchy="false" xref="S2.SS2.p2.4.m2.4.4.4.2.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.4.m2.4.4.4.2.1.1.1" xref="S2.SS2.p2.4.m2.4.4.4.2.1.1.1.cmml"><mi id="S2.SS2.p2.4.m2.4.4.4.2.1.1.1.2" xref="S2.SS2.p2.4.m2.4.4.4.2.1.1.1.2.cmml">a</mi><mo id="S2.SS2.p2.4.m2.4.4.4.2.1.1.1.1" xref="S2.SS2.p2.4.m2.4.4.4.2.1.1.1.1.cmml">∣</mo><mi id="S2.SS2.p2.4.m2.4.4.4.2.1.1.1.3" xref="S2.SS2.p2.4.m2.4.4.4.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS2.p2.4.m2.4.4.4.2.1.1.3" stretchy="false" xref="S2.SS2.p2.4.m2.4.4.4.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p2.4.m2.4.4.4.7" xref="S2.SS2.p2.4.m2.4.4.4.7.cmml">&gt;</mo><mn id="S2.SS2.p2.4.m2.4.4.4.8" xref="S2.SS2.p2.4.m2.4.4.4.8.cmml">0</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m2.4b"><apply id="S2.SS2.p2.4.m2.4.4.cmml" xref="S2.SS2.p2.4.m2.4.4"><ci id="S2.SS2.p2.4.m2.4.4.5.cmml" xref="S2.SS2.p2.4.m2.4.4.5">:</ci><apply id="S2.SS2.p2.4.m2.2.2.2.3.cmml" xref="S2.SS2.p2.4.m2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m2.2.2.2.3a.cmml" xref="S2.SS2.p2.4.m2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS2.p2.4.m2.1.1.1.1.1.cmml" xref="S2.SS2.p2.4.m2.1.1.1.1.1"><in id="S2.SS2.p2.4.m2.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.4.m2.1.1.1.1.1.1"></in><apply id="S2.SS2.p2.4.m2.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.4.m2.1.1.1.1.1.2"><csymbol cd="latexml" id="S2.SS2.p2.4.m2.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p2.4.m2.1.1.1.1.1.2.1">for-all</csymbol><ci id="S2.SS2.p2.4.m2.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p2.4.m2.1.1.1.1.1.2.2">𝑎</ci></apply><ci id="S2.SS2.p2.4.m2.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.4.m2.1.1.1.1.1.3">𝒜</ci></apply><apply id="S2.SS2.p2.4.m2.2.2.2.2.2.cmml" xref="S2.SS2.p2.4.m2.2.2.2.2.2"><in id="S2.SS2.p2.4.m2.2.2.2.2.2.1.cmml" xref="S2.SS2.p2.4.m2.2.2.2.2.2.1"></in><ci id="S2.SS2.p2.4.m2.2.2.2.2.2.2.cmml" xref="S2.SS2.p2.4.m2.2.2.2.2.2.2">𝑥</ci><ci id="S2.SS2.p2.4.m2.2.2.2.2.2.3.cmml" xref="S2.SS2.p2.4.m2.2.2.2.2.2.3">𝒳</ci></apply></apply><apply id="S2.SS2.p2.4.m2.4.4.4.cmml" xref="S2.SS2.p2.4.m2.4.4.4"><and id="S2.SS2.p2.4.m2.4.4.4a.cmml" xref="S2.SS2.p2.4.m2.4.4.4"></and><apply id="S2.SS2.p2.4.m2.4.4.4b.cmml" xref="S2.SS2.p2.4.m2.4.4.4"><gt id="S2.SS2.p2.4.m2.4.4.4.4.cmml" xref="S2.SS2.p2.4.m2.4.4.4.4"></gt><apply id="S2.SS2.p2.4.m2.3.3.3.1.cmml" xref="S2.SS2.p2.4.m2.3.3.3.1"><times id="S2.SS2.p2.4.m2.3.3.3.1.2.cmml" xref="S2.SS2.p2.4.m2.3.3.3.1.2"></times><ci id="S2.SS2.p2.4.m2.3.3.3.1.3.cmml" xref="S2.SS2.p2.4.m2.3.3.3.1.3">𝜋</ci><apply id="S2.SS2.p2.4.m2.3.3.3.1.1.1.1.cmml" xref="S2.SS2.p2.4.m2.3.3.3.1.1.1"><csymbol cd="latexml" id="S2.SS2.p2.4.m2.3.3.3.1.1.1.1.1.cmml" xref="S2.SS2.p2.4.m2.3.3.3.1.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p2.4.m2.3.3.3.1.1.1.1.2.cmml" xref="S2.SS2.p2.4.m2.3.3.3.1.1.1.1.2">𝑎</ci><ci id="S2.SS2.p2.4.m2.3.3.3.1.1.1.1.3.cmml" xref="S2.SS2.p2.4.m2.3.3.3.1.1.1.1.3">𝑥</ci></apply></apply><cn id="S2.SS2.p2.4.m2.4.4.4.5.cmml" type="integer" xref="S2.SS2.p2.4.m2.4.4.4.5">0</cn></apply><apply id="S2.SS2.p2.4.m2.4.4.4c.cmml" xref="S2.SS2.p2.4.m2.4.4.4"><implies id="S2.SS2.p2.4.m2.4.4.4.6.cmml" xref="S2.SS2.p2.4.m2.4.4.4.6"></implies><share href="https://arxiv.org/html/2405.05736v2#S2.SS2.p2.4.m2.4.4.4.5.cmml" id="S2.SS2.p2.4.m2.4.4.4d.cmml" xref="S2.SS2.p2.4.m2.4.4.4"></share><apply id="S2.SS2.p2.4.m2.4.4.4.2.cmml" xref="S2.SS2.p2.4.m2.4.4.4.2"><times id="S2.SS2.p2.4.m2.4.4.4.2.2.cmml" xref="S2.SS2.p2.4.m2.4.4.4.2.2"></times><apply id="S2.SS2.p2.4.m2.4.4.4.2.3.cmml" xref="S2.SS2.p2.4.m2.4.4.4.2.3"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m2.4.4.4.2.3.1.cmml" xref="S2.SS2.p2.4.m2.4.4.4.2.3">subscript</csymbol><ci id="S2.SS2.p2.4.m2.4.4.4.2.3.2.cmml" xref="S2.SS2.p2.4.m2.4.4.4.2.3.2">𝜋</ci><cn id="S2.SS2.p2.4.m2.4.4.4.2.3.3.cmml" type="integer" xref="S2.SS2.p2.4.m2.4.4.4.2.3.3">0</cn></apply><apply id="S2.SS2.p2.4.m2.4.4.4.2.1.1.1.cmml" xref="S2.SS2.p2.4.m2.4.4.4.2.1.1"><csymbol cd="latexml" id="S2.SS2.p2.4.m2.4.4.4.2.1.1.1.1.cmml" xref="S2.SS2.p2.4.m2.4.4.4.2.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p2.4.m2.4.4.4.2.1.1.1.2.cmml" xref="S2.SS2.p2.4.m2.4.4.4.2.1.1.1.2">𝑎</ci><ci id="S2.SS2.p2.4.m2.4.4.4.2.1.1.1.3.cmml" xref="S2.SS2.p2.4.m2.4.4.4.2.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="S2.SS2.p2.4.m2.4.4.4e.cmml" xref="S2.SS2.p2.4.m2.4.4.4"><gt id="S2.SS2.p2.4.m2.4.4.4.7.cmml" xref="S2.SS2.p2.4.m2.4.4.4.7"></gt><share href="https://arxiv.org/html/2405.05736v2#S2.SS2.p2.4.m2.4.4.4.2.cmml" id="S2.SS2.p2.4.m2.4.4.4f.cmml" xref="S2.SS2.p2.4.m2.4.4.4"></share><cn id="S2.SS2.p2.4.m2.4.4.4.8.cmml" type="integer" xref="S2.SS2.p2.4.m2.4.4.4.8">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m2.4c">\forall a\in\mathcal{A},x\in\mathcal{X}:\pi(a\mid x)&gt;0\implies\pi_{0}(a\mid x)&gt;0</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.4.m2.4d">∀ italic_a ∈ caligraphic_A , italic_x ∈ caligraphic_X : italic_π ( italic_a ∣ italic_x ) &gt; 0 ⟹ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ∣ italic_x ) &gt; 0</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.3">From Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2.E11" title="In 2.2. Off-policy estimation for general bandits ‣ 2. Background and Related Work ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">11</span></a>, we can derive an unbiased estimator for <math alttext="V(\pi)" class="ltx_Math" display="inline" id="S2.SS2.p3.1.m1.1"><semantics id="S2.SS2.p3.1.m1.1a"><mrow id="S2.SS2.p3.1.m1.1.2" xref="S2.SS2.p3.1.m1.1.2.cmml"><mi id="S2.SS2.p3.1.m1.1.2.2" xref="S2.SS2.p3.1.m1.1.2.2.cmml">V</mi><mo id="S2.SS2.p3.1.m1.1.2.1" xref="S2.SS2.p3.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.p3.1.m1.1.2.3.2" xref="S2.SS2.p3.1.m1.1.2.cmml"><mo id="S2.SS2.p3.1.m1.1.2.3.2.1" stretchy="false" xref="S2.SS2.p3.1.m1.1.2.cmml">(</mo><mi id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml">π</mi><mo id="S2.SS2.p3.1.m1.1.2.3.2.2" stretchy="false" xref="S2.SS2.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><apply id="S2.SS2.p3.1.m1.1.2.cmml" xref="S2.SS2.p3.1.m1.1.2"><times id="S2.SS2.p3.1.m1.1.2.1.cmml" xref="S2.SS2.p3.1.m1.1.2.1"></times><ci id="S2.SS2.p3.1.m1.1.2.2.cmml" xref="S2.SS2.p3.1.m1.1.2.2">𝑉</ci><ci id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1">𝜋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">V(\pi)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.1.m1.1d">italic_V ( italic_π )</annotation></semantics></math> using contexts, actions and rewards logged under <math alttext="\pi_{0}" class="ltx_Math" display="inline" id="S2.SS2.p3.2.m2.1"><semantics id="S2.SS2.p3.2.m2.1a"><msub id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml"><mi id="S2.SS2.p3.2.m2.1.1.2" xref="S2.SS2.p3.2.m2.1.1.2.cmml">π</mi><mn id="S2.SS2.p3.2.m2.1.1.3" xref="S2.SS2.p3.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><apply id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m2.1.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p3.2.m2.1.1.2.cmml" xref="S2.SS2.p3.2.m2.1.1.2">𝜋</ci><cn id="S2.SS2.p3.2.m2.1.1.3.cmml" type="integer" xref="S2.SS2.p3.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">\pi_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.2.m2.1d">italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, denoted by <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S2.SS2.p3.3.m3.1"><semantics id="S2.SS2.p3.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.3.m3.1.1" xref="S2.SS2.p3.3.m3.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m3.1b"><ci id="S2.SS2.p3.3.m3.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m3.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.3.m3.1d">caligraphic_D</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widehat{V}_{\rm IPS}(\pi,\mathcal{D})=\frac{1}{\left|\mathcal{D}\right|}\sum_%
{(x,a,r)\in\mathcal{D}}\frac{\pi(a\mid x)}{\pi_{0}(a\mid x)}r." class="ltx_Math" display="block" id="S2.E12.m1.9"><semantics id="S2.E12.m1.9a"><mrow id="S2.E12.m1.9.9.1" xref="S2.E12.m1.9.9.1.1.cmml"><mrow id="S2.E12.m1.9.9.1.1" xref="S2.E12.m1.9.9.1.1.cmml"><mrow id="S2.E12.m1.9.9.1.1.2" xref="S2.E12.m1.9.9.1.1.2.cmml"><msub id="S2.E12.m1.9.9.1.1.2.2" xref="S2.E12.m1.9.9.1.1.2.2.cmml"><mover accent="true" id="S2.E12.m1.9.9.1.1.2.2.2" xref="S2.E12.m1.9.9.1.1.2.2.2.cmml"><mi id="S2.E12.m1.9.9.1.1.2.2.2.2" xref="S2.E12.m1.9.9.1.1.2.2.2.2.cmml">V</mi><mo id="S2.E12.m1.9.9.1.1.2.2.2.1" xref="S2.E12.m1.9.9.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S2.E12.m1.9.9.1.1.2.2.3" xref="S2.E12.m1.9.9.1.1.2.2.3.cmml">IPS</mi></msub><mo id="S2.E12.m1.9.9.1.1.2.1" xref="S2.E12.m1.9.9.1.1.2.1.cmml">⁢</mo><mrow id="S2.E12.m1.9.9.1.1.2.3.2" xref="S2.E12.m1.9.9.1.1.2.3.1.cmml"><mo id="S2.E12.m1.9.9.1.1.2.3.2.1" stretchy="false" xref="S2.E12.m1.9.9.1.1.2.3.1.cmml">(</mo><mi id="S2.E12.m1.7.7" xref="S2.E12.m1.7.7.cmml">π</mi><mo id="S2.E12.m1.9.9.1.1.2.3.2.2" xref="S2.E12.m1.9.9.1.1.2.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.E12.m1.8.8" xref="S2.E12.m1.8.8.cmml">𝒟</mi><mo id="S2.E12.m1.9.9.1.1.2.3.2.3" stretchy="false" xref="S2.E12.m1.9.9.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E12.m1.9.9.1.1.1" xref="S2.E12.m1.9.9.1.1.1.cmml">=</mo><mrow id="S2.E12.m1.9.9.1.1.3" xref="S2.E12.m1.9.9.1.1.3.cmml"><mfrac id="S2.E12.m1.1.1" xref="S2.E12.m1.1.1.cmml"><mn id="S2.E12.m1.1.1.3" xref="S2.E12.m1.1.1.3.cmml">1</mn><mrow id="S2.E12.m1.1.1.1.3" xref="S2.E12.m1.1.1.1.2.cmml"><mo id="S2.E12.m1.1.1.1.3.1" xref="S2.E12.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.E12.m1.1.1.1.1" xref="S2.E12.m1.1.1.1.1.cmml">𝒟</mi><mo id="S2.E12.m1.1.1.1.3.2" xref="S2.E12.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S2.E12.m1.9.9.1.1.3.1" xref="S2.E12.m1.9.9.1.1.3.1.cmml">⁢</mo><mrow id="S2.E12.m1.9.9.1.1.3.2" xref="S2.E12.m1.9.9.1.1.3.2.cmml"><munder id="S2.E12.m1.9.9.1.1.3.2.1" xref="S2.E12.m1.9.9.1.1.3.2.1.cmml"><mo id="S2.E12.m1.9.9.1.1.3.2.1.2" movablelimits="false" xref="S2.E12.m1.9.9.1.1.3.2.1.2.cmml">∑</mo><mrow id="S2.E12.m1.4.4.3" xref="S2.E12.m1.4.4.3.cmml"><mrow id="S2.E12.m1.4.4.3.5.2" xref="S2.E12.m1.4.4.3.5.1.cmml"><mo id="S2.E12.m1.4.4.3.5.2.1" stretchy="false" xref="S2.E12.m1.4.4.3.5.1.cmml">(</mo><mi id="S2.E12.m1.2.2.1.1" xref="S2.E12.m1.2.2.1.1.cmml">x</mi><mo id="S2.E12.m1.4.4.3.5.2.2" xref="S2.E12.m1.4.4.3.5.1.cmml">,</mo><mi id="S2.E12.m1.3.3.2.2" xref="S2.E12.m1.3.3.2.2.cmml">a</mi><mo id="S2.E12.m1.4.4.3.5.2.3" xref="S2.E12.m1.4.4.3.5.1.cmml">,</mo><mi id="S2.E12.m1.4.4.3.3" xref="S2.E12.m1.4.4.3.3.cmml">r</mi><mo id="S2.E12.m1.4.4.3.5.2.4" stretchy="false" xref="S2.E12.m1.4.4.3.5.1.cmml">)</mo></mrow><mo id="S2.E12.m1.4.4.3.4" xref="S2.E12.m1.4.4.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E12.m1.4.4.3.6" xref="S2.E12.m1.4.4.3.6.cmml">𝒟</mi></mrow></munder><mrow id="S2.E12.m1.9.9.1.1.3.2.2" xref="S2.E12.m1.9.9.1.1.3.2.2.cmml"><mfrac id="S2.E12.m1.6.6" xref="S2.E12.m1.6.6.cmml"><mrow id="S2.E12.m1.5.5.1" xref="S2.E12.m1.5.5.1.cmml"><mi id="S2.E12.m1.5.5.1.3" xref="S2.E12.m1.5.5.1.3.cmml">π</mi><mo id="S2.E12.m1.5.5.1.2" xref="S2.E12.m1.5.5.1.2.cmml">⁢</mo><mrow id="S2.E12.m1.5.5.1.1.1" xref="S2.E12.m1.5.5.1.1.1.1.cmml"><mo id="S2.E12.m1.5.5.1.1.1.2" stretchy="false" xref="S2.E12.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S2.E12.m1.5.5.1.1.1.1" xref="S2.E12.m1.5.5.1.1.1.1.cmml"><mi id="S2.E12.m1.5.5.1.1.1.1.2" xref="S2.E12.m1.5.5.1.1.1.1.2.cmml">a</mi><mo id="S2.E12.m1.5.5.1.1.1.1.1" xref="S2.E12.m1.5.5.1.1.1.1.1.cmml">∣</mo><mi id="S2.E12.m1.5.5.1.1.1.1.3" xref="S2.E12.m1.5.5.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E12.m1.5.5.1.1.1.3" stretchy="false" xref="S2.E12.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E12.m1.6.6.2" xref="S2.E12.m1.6.6.2.cmml"><msub id="S2.E12.m1.6.6.2.3" xref="S2.E12.m1.6.6.2.3.cmml"><mi id="S2.E12.m1.6.6.2.3.2" xref="S2.E12.m1.6.6.2.3.2.cmml">π</mi><mn id="S2.E12.m1.6.6.2.3.3" xref="S2.E12.m1.6.6.2.3.3.cmml">0</mn></msub><mo id="S2.E12.m1.6.6.2.2" xref="S2.E12.m1.6.6.2.2.cmml">⁢</mo><mrow id="S2.E12.m1.6.6.2.1.1" xref="S2.E12.m1.6.6.2.1.1.1.cmml"><mo id="S2.E12.m1.6.6.2.1.1.2" stretchy="false" xref="S2.E12.m1.6.6.2.1.1.1.cmml">(</mo><mrow id="S2.E12.m1.6.6.2.1.1.1" xref="S2.E12.m1.6.6.2.1.1.1.cmml"><mi id="S2.E12.m1.6.6.2.1.1.1.2" xref="S2.E12.m1.6.6.2.1.1.1.2.cmml">a</mi><mo id="S2.E12.m1.6.6.2.1.1.1.1" xref="S2.E12.m1.6.6.2.1.1.1.1.cmml">∣</mo><mi id="S2.E12.m1.6.6.2.1.1.1.3" xref="S2.E12.m1.6.6.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E12.m1.6.6.2.1.1.3" stretchy="false" xref="S2.E12.m1.6.6.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S2.E12.m1.9.9.1.1.3.2.2.1" xref="S2.E12.m1.9.9.1.1.3.2.2.1.cmml">⁢</mo><mi id="S2.E12.m1.9.9.1.1.3.2.2.2" xref="S2.E12.m1.9.9.1.1.3.2.2.2.cmml">r</mi></mrow></mrow></mrow></mrow><mo id="S2.E12.m1.9.9.1.2" lspace="0em" xref="S2.E12.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E12.m1.9b"><apply id="S2.E12.m1.9.9.1.1.cmml" xref="S2.E12.m1.9.9.1"><eq id="S2.E12.m1.9.9.1.1.1.cmml" xref="S2.E12.m1.9.9.1.1.1"></eq><apply id="S2.E12.m1.9.9.1.1.2.cmml" xref="S2.E12.m1.9.9.1.1.2"><times id="S2.E12.m1.9.9.1.1.2.1.cmml" xref="S2.E12.m1.9.9.1.1.2.1"></times><apply id="S2.E12.m1.9.9.1.1.2.2.cmml" xref="S2.E12.m1.9.9.1.1.2.2"><csymbol cd="ambiguous" id="S2.E12.m1.9.9.1.1.2.2.1.cmml" xref="S2.E12.m1.9.9.1.1.2.2">subscript</csymbol><apply id="S2.E12.m1.9.9.1.1.2.2.2.cmml" xref="S2.E12.m1.9.9.1.1.2.2.2"><ci id="S2.E12.m1.9.9.1.1.2.2.2.1.cmml" xref="S2.E12.m1.9.9.1.1.2.2.2.1">^</ci><ci id="S2.E12.m1.9.9.1.1.2.2.2.2.cmml" xref="S2.E12.m1.9.9.1.1.2.2.2.2">𝑉</ci></apply><ci id="S2.E12.m1.9.9.1.1.2.2.3.cmml" xref="S2.E12.m1.9.9.1.1.2.2.3">IPS</ci></apply><interval closure="open" id="S2.E12.m1.9.9.1.1.2.3.1.cmml" xref="S2.E12.m1.9.9.1.1.2.3.2"><ci id="S2.E12.m1.7.7.cmml" xref="S2.E12.m1.7.7">𝜋</ci><ci id="S2.E12.m1.8.8.cmml" xref="S2.E12.m1.8.8">𝒟</ci></interval></apply><apply id="S2.E12.m1.9.9.1.1.3.cmml" xref="S2.E12.m1.9.9.1.1.3"><times id="S2.E12.m1.9.9.1.1.3.1.cmml" xref="S2.E12.m1.9.9.1.1.3.1"></times><apply id="S2.E12.m1.1.1.cmml" xref="S2.E12.m1.1.1"><divide id="S2.E12.m1.1.1.2.cmml" xref="S2.E12.m1.1.1"></divide><cn id="S2.E12.m1.1.1.3.cmml" type="integer" xref="S2.E12.m1.1.1.3">1</cn><apply id="S2.E12.m1.1.1.1.2.cmml" xref="S2.E12.m1.1.1.1.3"><abs id="S2.E12.m1.1.1.1.2.1.cmml" xref="S2.E12.m1.1.1.1.3.1"></abs><ci id="S2.E12.m1.1.1.1.1.cmml" xref="S2.E12.m1.1.1.1.1">𝒟</ci></apply></apply><apply id="S2.E12.m1.9.9.1.1.3.2.cmml" xref="S2.E12.m1.9.9.1.1.3.2"><apply id="S2.E12.m1.9.9.1.1.3.2.1.cmml" xref="S2.E12.m1.9.9.1.1.3.2.1"><csymbol cd="ambiguous" id="S2.E12.m1.9.9.1.1.3.2.1.1.cmml" xref="S2.E12.m1.9.9.1.1.3.2.1">subscript</csymbol><sum id="S2.E12.m1.9.9.1.1.3.2.1.2.cmml" xref="S2.E12.m1.9.9.1.1.3.2.1.2"></sum><apply id="S2.E12.m1.4.4.3.cmml" xref="S2.E12.m1.4.4.3"><in id="S2.E12.m1.4.4.3.4.cmml" xref="S2.E12.m1.4.4.3.4"></in><vector id="S2.E12.m1.4.4.3.5.1.cmml" xref="S2.E12.m1.4.4.3.5.2"><ci id="S2.E12.m1.2.2.1.1.cmml" xref="S2.E12.m1.2.2.1.1">𝑥</ci><ci id="S2.E12.m1.3.3.2.2.cmml" xref="S2.E12.m1.3.3.2.2">𝑎</ci><ci id="S2.E12.m1.4.4.3.3.cmml" xref="S2.E12.m1.4.4.3.3">𝑟</ci></vector><ci id="S2.E12.m1.4.4.3.6.cmml" xref="S2.E12.m1.4.4.3.6">𝒟</ci></apply></apply><apply id="S2.E12.m1.9.9.1.1.3.2.2.cmml" xref="S2.E12.m1.9.9.1.1.3.2.2"><times id="S2.E12.m1.9.9.1.1.3.2.2.1.cmml" xref="S2.E12.m1.9.9.1.1.3.2.2.1"></times><apply id="S2.E12.m1.6.6.cmml" xref="S2.E12.m1.6.6"><divide id="S2.E12.m1.6.6.3.cmml" xref="S2.E12.m1.6.6"></divide><apply id="S2.E12.m1.5.5.1.cmml" xref="S2.E12.m1.5.5.1"><times id="S2.E12.m1.5.5.1.2.cmml" xref="S2.E12.m1.5.5.1.2"></times><ci id="S2.E12.m1.5.5.1.3.cmml" xref="S2.E12.m1.5.5.1.3">𝜋</ci><apply id="S2.E12.m1.5.5.1.1.1.1.cmml" xref="S2.E12.m1.5.5.1.1.1"><csymbol cd="latexml" id="S2.E12.m1.5.5.1.1.1.1.1.cmml" xref="S2.E12.m1.5.5.1.1.1.1.1">conditional</csymbol><ci id="S2.E12.m1.5.5.1.1.1.1.2.cmml" xref="S2.E12.m1.5.5.1.1.1.1.2">𝑎</ci><ci id="S2.E12.m1.5.5.1.1.1.1.3.cmml" xref="S2.E12.m1.5.5.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.E12.m1.6.6.2.cmml" xref="S2.E12.m1.6.6.2"><times id="S2.E12.m1.6.6.2.2.cmml" xref="S2.E12.m1.6.6.2.2"></times><apply id="S2.E12.m1.6.6.2.3.cmml" xref="S2.E12.m1.6.6.2.3"><csymbol cd="ambiguous" id="S2.E12.m1.6.6.2.3.1.cmml" xref="S2.E12.m1.6.6.2.3">subscript</csymbol><ci id="S2.E12.m1.6.6.2.3.2.cmml" xref="S2.E12.m1.6.6.2.3.2">𝜋</ci><cn id="S2.E12.m1.6.6.2.3.3.cmml" type="integer" xref="S2.E12.m1.6.6.2.3.3">0</cn></apply><apply id="S2.E12.m1.6.6.2.1.1.1.cmml" xref="S2.E12.m1.6.6.2.1.1"><csymbol cd="latexml" id="S2.E12.m1.6.6.2.1.1.1.1.cmml" xref="S2.E12.m1.6.6.2.1.1.1.1">conditional</csymbol><ci id="S2.E12.m1.6.6.2.1.1.1.2.cmml" xref="S2.E12.m1.6.6.2.1.1.1.2">𝑎</ci><ci id="S2.E12.m1.6.6.2.1.1.1.3.cmml" xref="S2.E12.m1.6.6.2.1.1.1.3">𝑥</ci></apply></apply></apply><ci id="S2.E12.m1.9.9.1.1.3.2.2.2.cmml" xref="S2.E12.m1.9.9.1.1.3.2.2.2">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E12.m1.9c">\widehat{V}_{\rm IPS}(\pi,\mathcal{D})=\frac{1}{\left|\mathcal{D}\right|}\sum_%
{(x,a,r)\in\mathcal{D}}\frac{\pi(a\mid x)}{\pi_{0}(a\mid x)}r.</annotation><annotation encoding="application/x-llamapun" id="S2.E12.m1.9d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_IPS end_POSTSUBSCRIPT ( italic_π , caligraphic_D ) = divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) ∈ caligraphic_D end_POSTSUBSCRIPT divide start_ARG italic_π ( italic_a ∣ italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ∣ italic_x ) end_ARG italic_r .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p3.4">To keep our notation brief, we suppress subscripts when they are clear from the context.
In the context of gradient-based optimization methods, we often refer to a minibatch <math alttext="\mathcal{B}\subset\mathcal{D}" class="ltx_Math" display="inline" id="S2.SS2.p3.4.m1.1"><semantics id="S2.SS2.p3.4.m1.1a"><mrow id="S2.SS2.p3.4.m1.1.1" xref="S2.SS2.p3.4.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.4.m1.1.1.2" xref="S2.SS2.p3.4.m1.1.1.2.cmml">ℬ</mi><mo id="S2.SS2.p3.4.m1.1.1.1" xref="S2.SS2.p3.4.m1.1.1.1.cmml">⊂</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.4.m1.1.1.3" xref="S2.SS2.p3.4.m1.1.1.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.4.m1.1b"><apply id="S2.SS2.p3.4.m1.1.1.cmml" xref="S2.SS2.p3.4.m1.1.1"><subset id="S2.SS2.p3.4.m1.1.1.1.cmml" xref="S2.SS2.p3.4.m1.1.1.1"></subset><ci id="S2.SS2.p3.4.m1.1.1.2.cmml" xref="S2.SS2.p3.4.m1.1.1.2">ℬ</ci><ci id="S2.SS2.p3.4.m1.1.1.3.cmml" xref="S2.SS2.p3.4.m1.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.4.m1.1c">\mathcal{B}\subset\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.4.m1.1d">caligraphic_B ⊂ caligraphic_D</annotation></semantics></math> instead of the whole dataset, as is typical for, e.g., stochastic gradient descent (SGD).</p>
</div>
<div class="ltx_para" id="S2.SS2.p4">
<p class="ltx_p" id="S2.SS2.p4.1">If we wish to learn a policy that maximises this estimator, we need to estimate its gradient for a batch <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="S2.SS2.p4.1.m1.1"><semantics id="S2.SS2.p4.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p4.1.m1.1.1" xref="S2.SS2.p4.1.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.1.m1.1b"><ci id="S2.SS2.p4.1.m1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.1.m1.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p4.1.m1.1d">caligraphic_B</annotation></semantics></math>.
Whilst some previous work has applied a REINFORCE estimator <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib8" title="">2019</a>; Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib42" title="">2020</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib10" title="">2022</a>)</cite>, we use a straightforward Monte Carlo estimate for the gradient:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla\widehat{V}_{\rm IPS}(\pi,\mathcal{B})=\frac{1}{\left|\mathcal{B}\right|%
}\sum_{(x,a,r)\in\mathcal{B}}\frac{\nabla\pi(a|x)}{\pi_{0}(a|x)}r." class="ltx_Math" display="block" id="S2.E13.m1.9"><semantics id="S2.E13.m1.9a"><mrow id="S2.E13.m1.9.9.1" xref="S2.E13.m1.9.9.1.1.cmml"><mrow id="S2.E13.m1.9.9.1.1" xref="S2.E13.m1.9.9.1.1.cmml"><mrow id="S2.E13.m1.9.9.1.1.2" xref="S2.E13.m1.9.9.1.1.2.cmml"><mrow id="S2.E13.m1.9.9.1.1.2.2" xref="S2.E13.m1.9.9.1.1.2.2.cmml"><mo id="S2.E13.m1.9.9.1.1.2.2.1" rspace="0.167em" xref="S2.E13.m1.9.9.1.1.2.2.1.cmml">∇</mo><msub id="S2.E13.m1.9.9.1.1.2.2.2" xref="S2.E13.m1.9.9.1.1.2.2.2.cmml"><mover accent="true" id="S2.E13.m1.9.9.1.1.2.2.2.2" xref="S2.E13.m1.9.9.1.1.2.2.2.2.cmml"><mi id="S2.E13.m1.9.9.1.1.2.2.2.2.2" xref="S2.E13.m1.9.9.1.1.2.2.2.2.2.cmml">V</mi><mo id="S2.E13.m1.9.9.1.1.2.2.2.2.1" xref="S2.E13.m1.9.9.1.1.2.2.2.2.1.cmml">^</mo></mover><mi id="S2.E13.m1.9.9.1.1.2.2.2.3" xref="S2.E13.m1.9.9.1.1.2.2.2.3.cmml">IPS</mi></msub></mrow><mo id="S2.E13.m1.9.9.1.1.2.1" xref="S2.E13.m1.9.9.1.1.2.1.cmml">⁢</mo><mrow id="S2.E13.m1.9.9.1.1.2.3.2" xref="S2.E13.m1.9.9.1.1.2.3.1.cmml"><mo id="S2.E13.m1.9.9.1.1.2.3.2.1" stretchy="false" xref="S2.E13.m1.9.9.1.1.2.3.1.cmml">(</mo><mi id="S2.E13.m1.7.7" xref="S2.E13.m1.7.7.cmml">π</mi><mo id="S2.E13.m1.9.9.1.1.2.3.2.2" xref="S2.E13.m1.9.9.1.1.2.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.E13.m1.8.8" xref="S2.E13.m1.8.8.cmml">ℬ</mi><mo id="S2.E13.m1.9.9.1.1.2.3.2.3" stretchy="false" xref="S2.E13.m1.9.9.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E13.m1.9.9.1.1.1" xref="S2.E13.m1.9.9.1.1.1.cmml">=</mo><mrow id="S2.E13.m1.9.9.1.1.3" xref="S2.E13.m1.9.9.1.1.3.cmml"><mfrac id="S2.E13.m1.1.1" xref="S2.E13.m1.1.1.cmml"><mn id="S2.E13.m1.1.1.3" xref="S2.E13.m1.1.1.3.cmml">1</mn><mrow id="S2.E13.m1.1.1.1.3" xref="S2.E13.m1.1.1.1.2.cmml"><mo id="S2.E13.m1.1.1.1.3.1" xref="S2.E13.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.E13.m1.1.1.1.1" xref="S2.E13.m1.1.1.1.1.cmml">ℬ</mi><mo id="S2.E13.m1.1.1.1.3.2" xref="S2.E13.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S2.E13.m1.9.9.1.1.3.1" xref="S2.E13.m1.9.9.1.1.3.1.cmml">⁢</mo><mrow id="S2.E13.m1.9.9.1.1.3.2" xref="S2.E13.m1.9.9.1.1.3.2.cmml"><munder id="S2.E13.m1.9.9.1.1.3.2.1" xref="S2.E13.m1.9.9.1.1.3.2.1.cmml"><mo id="S2.E13.m1.9.9.1.1.3.2.1.2" movablelimits="false" xref="S2.E13.m1.9.9.1.1.3.2.1.2.cmml">∑</mo><mrow id="S2.E13.m1.4.4.3" xref="S2.E13.m1.4.4.3.cmml"><mrow id="S2.E13.m1.4.4.3.5.2" xref="S2.E13.m1.4.4.3.5.1.cmml"><mo id="S2.E13.m1.4.4.3.5.2.1" stretchy="false" xref="S2.E13.m1.4.4.3.5.1.cmml">(</mo><mi id="S2.E13.m1.2.2.1.1" xref="S2.E13.m1.2.2.1.1.cmml">x</mi><mo id="S2.E13.m1.4.4.3.5.2.2" xref="S2.E13.m1.4.4.3.5.1.cmml">,</mo><mi id="S2.E13.m1.3.3.2.2" xref="S2.E13.m1.3.3.2.2.cmml">a</mi><mo id="S2.E13.m1.4.4.3.5.2.3" xref="S2.E13.m1.4.4.3.5.1.cmml">,</mo><mi id="S2.E13.m1.4.4.3.3" xref="S2.E13.m1.4.4.3.3.cmml">r</mi><mo id="S2.E13.m1.4.4.3.5.2.4" stretchy="false" xref="S2.E13.m1.4.4.3.5.1.cmml">)</mo></mrow><mo id="S2.E13.m1.4.4.3.4" xref="S2.E13.m1.4.4.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E13.m1.4.4.3.6" xref="S2.E13.m1.4.4.3.6.cmml">ℬ</mi></mrow></munder><mrow id="S2.E13.m1.9.9.1.1.3.2.2" xref="S2.E13.m1.9.9.1.1.3.2.2.cmml"><mfrac id="S2.E13.m1.6.6" xref="S2.E13.m1.6.6.cmml"><mrow id="S2.E13.m1.5.5.1" xref="S2.E13.m1.5.5.1.cmml"><mrow id="S2.E13.m1.5.5.1.3" xref="S2.E13.m1.5.5.1.3.cmml"><mo id="S2.E13.m1.5.5.1.3.1" rspace="0.167em" xref="S2.E13.m1.5.5.1.3.1.cmml">∇</mo><mi id="S2.E13.m1.5.5.1.3.2" xref="S2.E13.m1.5.5.1.3.2.cmml">π</mi></mrow><mo id="S2.E13.m1.5.5.1.2" xref="S2.E13.m1.5.5.1.2.cmml">⁢</mo><mrow id="S2.E13.m1.5.5.1.1.1" xref="S2.E13.m1.5.5.1.1.1.1.cmml"><mo id="S2.E13.m1.5.5.1.1.1.2" stretchy="false" xref="S2.E13.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S2.E13.m1.5.5.1.1.1.1" xref="S2.E13.m1.5.5.1.1.1.1.cmml"><mi id="S2.E13.m1.5.5.1.1.1.1.2" xref="S2.E13.m1.5.5.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.E13.m1.5.5.1.1.1.1.1" xref="S2.E13.m1.5.5.1.1.1.1.1.cmml">|</mo><mi id="S2.E13.m1.5.5.1.1.1.1.3" xref="S2.E13.m1.5.5.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E13.m1.5.5.1.1.1.3" stretchy="false" xref="S2.E13.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E13.m1.6.6.2" xref="S2.E13.m1.6.6.2.cmml"><msub id="S2.E13.m1.6.6.2.3" xref="S2.E13.m1.6.6.2.3.cmml"><mi id="S2.E13.m1.6.6.2.3.2" xref="S2.E13.m1.6.6.2.3.2.cmml">π</mi><mn id="S2.E13.m1.6.6.2.3.3" xref="S2.E13.m1.6.6.2.3.3.cmml">0</mn></msub><mo id="S2.E13.m1.6.6.2.2" xref="S2.E13.m1.6.6.2.2.cmml">⁢</mo><mrow id="S2.E13.m1.6.6.2.1.1" xref="S2.E13.m1.6.6.2.1.1.1.cmml"><mo id="S2.E13.m1.6.6.2.1.1.2" stretchy="false" xref="S2.E13.m1.6.6.2.1.1.1.cmml">(</mo><mrow id="S2.E13.m1.6.6.2.1.1.1" xref="S2.E13.m1.6.6.2.1.1.1.cmml"><mi id="S2.E13.m1.6.6.2.1.1.1.2" xref="S2.E13.m1.6.6.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.E13.m1.6.6.2.1.1.1.1" xref="S2.E13.m1.6.6.2.1.1.1.1.cmml">|</mo><mi id="S2.E13.m1.6.6.2.1.1.1.3" xref="S2.E13.m1.6.6.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E13.m1.6.6.2.1.1.3" stretchy="false" xref="S2.E13.m1.6.6.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S2.E13.m1.9.9.1.1.3.2.2.1" xref="S2.E13.m1.9.9.1.1.3.2.2.1.cmml">⁢</mo><mi id="S2.E13.m1.9.9.1.1.3.2.2.2" xref="S2.E13.m1.9.9.1.1.3.2.2.2.cmml">r</mi></mrow></mrow></mrow></mrow><mo id="S2.E13.m1.9.9.1.2" lspace="0em" xref="S2.E13.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E13.m1.9b"><apply id="S2.E13.m1.9.9.1.1.cmml" xref="S2.E13.m1.9.9.1"><eq id="S2.E13.m1.9.9.1.1.1.cmml" xref="S2.E13.m1.9.9.1.1.1"></eq><apply id="S2.E13.m1.9.9.1.1.2.cmml" xref="S2.E13.m1.9.9.1.1.2"><times id="S2.E13.m1.9.9.1.1.2.1.cmml" xref="S2.E13.m1.9.9.1.1.2.1"></times><apply id="S2.E13.m1.9.9.1.1.2.2.cmml" xref="S2.E13.m1.9.9.1.1.2.2"><ci id="S2.E13.m1.9.9.1.1.2.2.1.cmml" xref="S2.E13.m1.9.9.1.1.2.2.1">∇</ci><apply id="S2.E13.m1.9.9.1.1.2.2.2.cmml" xref="S2.E13.m1.9.9.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E13.m1.9.9.1.1.2.2.2.1.cmml" xref="S2.E13.m1.9.9.1.1.2.2.2">subscript</csymbol><apply id="S2.E13.m1.9.9.1.1.2.2.2.2.cmml" xref="S2.E13.m1.9.9.1.1.2.2.2.2"><ci id="S2.E13.m1.9.9.1.1.2.2.2.2.1.cmml" xref="S2.E13.m1.9.9.1.1.2.2.2.2.1">^</ci><ci id="S2.E13.m1.9.9.1.1.2.2.2.2.2.cmml" xref="S2.E13.m1.9.9.1.1.2.2.2.2.2">𝑉</ci></apply><ci id="S2.E13.m1.9.9.1.1.2.2.2.3.cmml" xref="S2.E13.m1.9.9.1.1.2.2.2.3">IPS</ci></apply></apply><interval closure="open" id="S2.E13.m1.9.9.1.1.2.3.1.cmml" xref="S2.E13.m1.9.9.1.1.2.3.2"><ci id="S2.E13.m1.7.7.cmml" xref="S2.E13.m1.7.7">𝜋</ci><ci id="S2.E13.m1.8.8.cmml" xref="S2.E13.m1.8.8">ℬ</ci></interval></apply><apply id="S2.E13.m1.9.9.1.1.3.cmml" xref="S2.E13.m1.9.9.1.1.3"><times id="S2.E13.m1.9.9.1.1.3.1.cmml" xref="S2.E13.m1.9.9.1.1.3.1"></times><apply id="S2.E13.m1.1.1.cmml" xref="S2.E13.m1.1.1"><divide id="S2.E13.m1.1.1.2.cmml" xref="S2.E13.m1.1.1"></divide><cn id="S2.E13.m1.1.1.3.cmml" type="integer" xref="S2.E13.m1.1.1.3">1</cn><apply id="S2.E13.m1.1.1.1.2.cmml" xref="S2.E13.m1.1.1.1.3"><abs id="S2.E13.m1.1.1.1.2.1.cmml" xref="S2.E13.m1.1.1.1.3.1"></abs><ci id="S2.E13.m1.1.1.1.1.cmml" xref="S2.E13.m1.1.1.1.1">ℬ</ci></apply></apply><apply id="S2.E13.m1.9.9.1.1.3.2.cmml" xref="S2.E13.m1.9.9.1.1.3.2"><apply id="S2.E13.m1.9.9.1.1.3.2.1.cmml" xref="S2.E13.m1.9.9.1.1.3.2.1"><csymbol cd="ambiguous" id="S2.E13.m1.9.9.1.1.3.2.1.1.cmml" xref="S2.E13.m1.9.9.1.1.3.2.1">subscript</csymbol><sum id="S2.E13.m1.9.9.1.1.3.2.1.2.cmml" xref="S2.E13.m1.9.9.1.1.3.2.1.2"></sum><apply id="S2.E13.m1.4.4.3.cmml" xref="S2.E13.m1.4.4.3"><in id="S2.E13.m1.4.4.3.4.cmml" xref="S2.E13.m1.4.4.3.4"></in><vector id="S2.E13.m1.4.4.3.5.1.cmml" xref="S2.E13.m1.4.4.3.5.2"><ci id="S2.E13.m1.2.2.1.1.cmml" xref="S2.E13.m1.2.2.1.1">𝑥</ci><ci id="S2.E13.m1.3.3.2.2.cmml" xref="S2.E13.m1.3.3.2.2">𝑎</ci><ci id="S2.E13.m1.4.4.3.3.cmml" xref="S2.E13.m1.4.4.3.3">𝑟</ci></vector><ci id="S2.E13.m1.4.4.3.6.cmml" xref="S2.E13.m1.4.4.3.6">ℬ</ci></apply></apply><apply id="S2.E13.m1.9.9.1.1.3.2.2.cmml" xref="S2.E13.m1.9.9.1.1.3.2.2"><times id="S2.E13.m1.9.9.1.1.3.2.2.1.cmml" xref="S2.E13.m1.9.9.1.1.3.2.2.1"></times><apply id="S2.E13.m1.6.6.cmml" xref="S2.E13.m1.6.6"><divide id="S2.E13.m1.6.6.3.cmml" xref="S2.E13.m1.6.6"></divide><apply id="S2.E13.m1.5.5.1.cmml" xref="S2.E13.m1.5.5.1"><times id="S2.E13.m1.5.5.1.2.cmml" xref="S2.E13.m1.5.5.1.2"></times><apply id="S2.E13.m1.5.5.1.3.cmml" xref="S2.E13.m1.5.5.1.3"><ci id="S2.E13.m1.5.5.1.3.1.cmml" xref="S2.E13.m1.5.5.1.3.1">∇</ci><ci id="S2.E13.m1.5.5.1.3.2.cmml" xref="S2.E13.m1.5.5.1.3.2">𝜋</ci></apply><apply id="S2.E13.m1.5.5.1.1.1.1.cmml" xref="S2.E13.m1.5.5.1.1.1"><csymbol cd="latexml" id="S2.E13.m1.5.5.1.1.1.1.1.cmml" xref="S2.E13.m1.5.5.1.1.1.1.1">conditional</csymbol><ci id="S2.E13.m1.5.5.1.1.1.1.2.cmml" xref="S2.E13.m1.5.5.1.1.1.1.2">𝑎</ci><ci id="S2.E13.m1.5.5.1.1.1.1.3.cmml" xref="S2.E13.m1.5.5.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.E13.m1.6.6.2.cmml" xref="S2.E13.m1.6.6.2"><times id="S2.E13.m1.6.6.2.2.cmml" xref="S2.E13.m1.6.6.2.2"></times><apply id="S2.E13.m1.6.6.2.3.cmml" xref="S2.E13.m1.6.6.2.3"><csymbol cd="ambiguous" id="S2.E13.m1.6.6.2.3.1.cmml" xref="S2.E13.m1.6.6.2.3">subscript</csymbol><ci id="S2.E13.m1.6.6.2.3.2.cmml" xref="S2.E13.m1.6.6.2.3.2">𝜋</ci><cn id="S2.E13.m1.6.6.2.3.3.cmml" type="integer" xref="S2.E13.m1.6.6.2.3.3">0</cn></apply><apply id="S2.E13.m1.6.6.2.1.1.1.cmml" xref="S2.E13.m1.6.6.2.1.1"><csymbol cd="latexml" id="S2.E13.m1.6.6.2.1.1.1.1.cmml" xref="S2.E13.m1.6.6.2.1.1.1.1">conditional</csymbol><ci id="S2.E13.m1.6.6.2.1.1.1.2.cmml" xref="S2.E13.m1.6.6.2.1.1.1.2">𝑎</ci><ci id="S2.E13.m1.6.6.2.1.1.1.3.cmml" xref="S2.E13.m1.6.6.2.1.1.1.3">𝑥</ci></apply></apply></apply><ci id="S2.E13.m1.9.9.1.1.3.2.2.2.cmml" xref="S2.E13.m1.9.9.1.1.3.2.2.2">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E13.m1.9c">\nabla\widehat{V}_{\rm IPS}(\pi,\mathcal{B})=\frac{1}{\left|\mathcal{B}\right|%
}\sum_{(x,a,r)\in\mathcal{B}}\frac{\nabla\pi(a|x)}{\pi_{0}(a|x)}r.</annotation><annotation encoding="application/x-llamapun" id="S2.E13.m1.9d">∇ over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_IPS end_POSTSUBSCRIPT ( italic_π , caligraphic_B ) = divide start_ARG 1 end_ARG start_ARG | caligraphic_B | end_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) ∈ caligraphic_B end_POSTSUBSCRIPT divide start_ARG ∇ italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG italic_r .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p4.2">Importance sampling — the bread and butter of unbiased off-policy estimation — often leads to increased variance compared to on-policy estimators.
Several variance reduction techniques have been proposed specifically to combat the excessive variance of <math alttext="\widehat{V}_{\rm IPS}" class="ltx_Math" display="inline" id="S2.SS2.p4.2.m1.1"><semantics id="S2.SS2.p4.2.m1.1a"><msub id="S2.SS2.p4.2.m1.1.1" xref="S2.SS2.p4.2.m1.1.1.cmml"><mover accent="true" id="S2.SS2.p4.2.m1.1.1.2" xref="S2.SS2.p4.2.m1.1.1.2.cmml"><mi id="S2.SS2.p4.2.m1.1.1.2.2" xref="S2.SS2.p4.2.m1.1.1.2.2.cmml">V</mi><mo id="S2.SS2.p4.2.m1.1.1.2.1" xref="S2.SS2.p4.2.m1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.p4.2.m1.1.1.3" xref="S2.SS2.p4.2.m1.1.1.3.cmml">IPS</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.2.m1.1b"><apply id="S2.SS2.p4.2.m1.1.1.cmml" xref="S2.SS2.p4.2.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.2.m1.1.1.1.cmml" xref="S2.SS2.p4.2.m1.1.1">subscript</csymbol><apply id="S2.SS2.p4.2.m1.1.1.2.cmml" xref="S2.SS2.p4.2.m1.1.1.2"><ci id="S2.SS2.p4.2.m1.1.1.2.1.cmml" xref="S2.SS2.p4.2.m1.1.1.2.1">^</ci><ci id="S2.SS2.p4.2.m1.1.1.2.2.cmml" xref="S2.SS2.p4.2.m1.1.1.2.2">𝑉</ci></apply><ci id="S2.SS2.p4.2.m1.1.1.3.cmml" xref="S2.SS2.p4.2.m1.1.1.3">IPS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.2.m1.1c">\widehat{V}_{\rm IPS}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p4.2.m1.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_IPS end_POSTSUBSCRIPT</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Ionides, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib23" title="">2008</a>; Dudík et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib14" title="">2014</a>; Swaminathan and Joachims, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib63" title="">2015b</a>)</cite>.
Within the scope of this work, we only consider techniques that reduce variance <em class="ltx_emph ltx_font_italic" id="S2.SS2.p4.2.1">without</em> introducing bias.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p5">
<p class="ltx_p" id="S2.SS2.p5.4"><span class="ltx_text ltx_font_bold" id="S2.SS2.p5.4.1">Self-normalised importance sampling.</span>
The key idea behind <em class="ltx_emph ltx_font_italic" id="S2.SS2.p5.4.2">self-normalisation</em> <cite class="ltx_cite ltx_citemacro_citep">(Owen, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib46" title="">2013</a>, §9.2)</cite> is to use a <em class="ltx_emph ltx_font_italic" id="S2.SS2.p5.4.3">multiplicative</em> control variate to rescale <math alttext="\widehat{V}_{\rm IPS}(\pi,\mathcal{D})" class="ltx_Math" display="inline" id="S2.SS2.p5.1.m1.2"><semantics id="S2.SS2.p5.1.m1.2a"><mrow id="S2.SS2.p5.1.m1.2.3" xref="S2.SS2.p5.1.m1.2.3.cmml"><msub id="S2.SS2.p5.1.m1.2.3.2" xref="S2.SS2.p5.1.m1.2.3.2.cmml"><mover accent="true" id="S2.SS2.p5.1.m1.2.3.2.2" xref="S2.SS2.p5.1.m1.2.3.2.2.cmml"><mi id="S2.SS2.p5.1.m1.2.3.2.2.2" xref="S2.SS2.p5.1.m1.2.3.2.2.2.cmml">V</mi><mo id="S2.SS2.p5.1.m1.2.3.2.2.1" xref="S2.SS2.p5.1.m1.2.3.2.2.1.cmml">^</mo></mover><mi id="S2.SS2.p5.1.m1.2.3.2.3" xref="S2.SS2.p5.1.m1.2.3.2.3.cmml">IPS</mi></msub><mo id="S2.SS2.p5.1.m1.2.3.1" xref="S2.SS2.p5.1.m1.2.3.1.cmml">⁢</mo><mrow id="S2.SS2.p5.1.m1.2.3.3.2" xref="S2.SS2.p5.1.m1.2.3.3.1.cmml"><mo id="S2.SS2.p5.1.m1.2.3.3.2.1" stretchy="false" xref="S2.SS2.p5.1.m1.2.3.3.1.cmml">(</mo><mi id="S2.SS2.p5.1.m1.1.1" xref="S2.SS2.p5.1.m1.1.1.cmml">π</mi><mo id="S2.SS2.p5.1.m1.2.3.3.2.2" xref="S2.SS2.p5.1.m1.2.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p5.1.m1.2.2" xref="S2.SS2.p5.1.m1.2.2.cmml">𝒟</mi><mo id="S2.SS2.p5.1.m1.2.3.3.2.3" stretchy="false" xref="S2.SS2.p5.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.1.m1.2b"><apply id="S2.SS2.p5.1.m1.2.3.cmml" xref="S2.SS2.p5.1.m1.2.3"><times id="S2.SS2.p5.1.m1.2.3.1.cmml" xref="S2.SS2.p5.1.m1.2.3.1"></times><apply id="S2.SS2.p5.1.m1.2.3.2.cmml" xref="S2.SS2.p5.1.m1.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.p5.1.m1.2.3.2.1.cmml" xref="S2.SS2.p5.1.m1.2.3.2">subscript</csymbol><apply id="S2.SS2.p5.1.m1.2.3.2.2.cmml" xref="S2.SS2.p5.1.m1.2.3.2.2"><ci id="S2.SS2.p5.1.m1.2.3.2.2.1.cmml" xref="S2.SS2.p5.1.m1.2.3.2.2.1">^</ci><ci id="S2.SS2.p5.1.m1.2.3.2.2.2.cmml" xref="S2.SS2.p5.1.m1.2.3.2.2.2">𝑉</ci></apply><ci id="S2.SS2.p5.1.m1.2.3.2.3.cmml" xref="S2.SS2.p5.1.m1.2.3.2.3">IPS</ci></apply><interval closure="open" id="S2.SS2.p5.1.m1.2.3.3.1.cmml" xref="S2.SS2.p5.1.m1.2.3.3.2"><ci id="S2.SS2.p5.1.m1.1.1.cmml" xref="S2.SS2.p5.1.m1.1.1">𝜋</ci><ci id="S2.SS2.p5.1.m1.2.2.cmml" xref="S2.SS2.p5.1.m1.2.2">𝒟</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.1.m1.2c">\widehat{V}_{\rm IPS}(\pi,\mathcal{D})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p5.1.m1.2d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_IPS end_POSTSUBSCRIPT ( italic_π , caligraphic_D )</annotation></semantics></math>.
An important observation for this approach is that for any policy <math alttext="\pi" class="ltx_Math" display="inline" id="S2.SS2.p5.2.m2.1"><semantics id="S2.SS2.p5.2.m2.1a"><mi id="S2.SS2.p5.2.m2.1.1" xref="S2.SS2.p5.2.m2.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.2.m2.1b"><ci id="S2.SS2.p5.2.m2.1.1.cmml" xref="S2.SS2.p5.2.m2.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.2.m2.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p5.2.m2.1d">italic_π</annotation></semantics></math> and a dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S2.SS2.p5.3.m3.1"><semantics id="S2.SS2.p5.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p5.3.m3.1.1" xref="S2.SS2.p5.3.m3.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.3.m3.1b"><ci id="S2.SS2.p5.3.m3.1.1.cmml" xref="S2.SS2.p5.3.m3.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.3.m3.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p5.3.m3.1d">caligraphic_D</annotation></semantics></math> logged under <math alttext="\pi_{0}" class="ltx_Math" display="inline" id="S2.SS2.p5.4.m4.1"><semantics id="S2.SS2.p5.4.m4.1a"><msub id="S2.SS2.p5.4.m4.1.1" xref="S2.SS2.p5.4.m4.1.1.cmml"><mi id="S2.SS2.p5.4.m4.1.1.2" xref="S2.SS2.p5.4.m4.1.1.2.cmml">π</mi><mn id="S2.SS2.p5.4.m4.1.1.3" xref="S2.SS2.p5.4.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.4.m4.1b"><apply id="S2.SS2.p5.4.m4.1.1.cmml" xref="S2.SS2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.4.m4.1.1.1.cmml" xref="S2.SS2.p5.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p5.4.m4.1.1.2.cmml" xref="S2.SS2.p5.4.m4.1.1.2">𝜋</ci><cn id="S2.SS2.p5.4.m4.1.1.3.cmml" type="integer" xref="S2.SS2.p5.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.4.m4.1c">\pi_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p5.4.m4.1d">italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, the expected average of importance weights should equal 1 <cite class="ltx_cite ltx_citemacro_citep">(Swaminathan and Joachims, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib63" title="">2015b</a>, §5)</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(14)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathop{\mathbb{E}}_{\mathcal{D}\sim\mathsf{P}(\mathcal{D})}\left[\frac{1}{%
\left|\mathcal{D}\right|}\sum_{(x,a,r)\in\mathcal{D}}\frac{\pi(a\mid x)}{\pi_{%
0}(a\mid x)}\right]=1." class="ltx_Math" display="block" id="S2.E14.m1.8"><semantics id="S2.E14.m1.8a"><mrow id="S2.E14.m1.8.8.1" xref="S2.E14.m1.8.8.1.1.cmml"><mrow id="S2.E14.m1.8.8.1.1" xref="S2.E14.m1.8.8.1.1.cmml"><mrow id="S2.E14.m1.8.8.1.1.1" xref="S2.E14.m1.8.8.1.1.1.cmml"><munder id="S2.E14.m1.8.8.1.1.1.2" xref="S2.E14.m1.8.8.1.1.1.2.cmml"><mo id="S2.E14.m1.8.8.1.1.1.2.2" movablelimits="false" xref="S2.E14.m1.8.8.1.1.1.2.2.cmml">𝔼</mo><mrow id="S2.E14.m1.1.1.1" xref="S2.E14.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E14.m1.1.1.1.3" xref="S2.E14.m1.1.1.1.3.cmml">𝒟</mi><mo id="S2.E14.m1.1.1.1.2" xref="S2.E14.m1.1.1.1.2.cmml">∼</mo><mrow id="S2.E14.m1.1.1.1.4" xref="S2.E14.m1.1.1.1.4.cmml"><mi id="S2.E14.m1.1.1.1.4.2" xref="S2.E14.m1.1.1.1.4.2.cmml">𝖯</mi><mo id="S2.E14.m1.1.1.1.4.1" xref="S2.E14.m1.1.1.1.4.1.cmml">⁢</mo><mrow id="S2.E14.m1.1.1.1.4.3.2" xref="S2.E14.m1.1.1.1.4.cmml"><mo id="S2.E14.m1.1.1.1.4.3.2.1" stretchy="false" xref="S2.E14.m1.1.1.1.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.E14.m1.1.1.1.1" xref="S2.E14.m1.1.1.1.1.cmml">𝒟</mi><mo id="S2.E14.m1.1.1.1.4.3.2.2" stretchy="false" xref="S2.E14.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></munder><mrow id="S2.E14.m1.8.8.1.1.1.1.1" xref="S2.E14.m1.8.8.1.1.1.1.2.cmml"><mo id="S2.E14.m1.8.8.1.1.1.1.1.2" lspace="0em" xref="S2.E14.m1.8.8.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E14.m1.8.8.1.1.1.1.1.1" xref="S2.E14.m1.8.8.1.1.1.1.1.1.cmml"><mfrac id="S2.E14.m1.2.2" xref="S2.E14.m1.2.2.cmml"><mn id="S2.E14.m1.2.2.3" xref="S2.E14.m1.2.2.3.cmml">1</mn><mrow id="S2.E14.m1.2.2.1.3" xref="S2.E14.m1.2.2.1.2.cmml"><mo id="S2.E14.m1.2.2.1.3.1" xref="S2.E14.m1.2.2.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.E14.m1.2.2.1.1" xref="S2.E14.m1.2.2.1.1.cmml">𝒟</mi><mo id="S2.E14.m1.2.2.1.3.2" xref="S2.E14.m1.2.2.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S2.E14.m1.8.8.1.1.1.1.1.1.1" xref="S2.E14.m1.8.8.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E14.m1.8.8.1.1.1.1.1.1.2" xref="S2.E14.m1.8.8.1.1.1.1.1.1.2.cmml"><munder id="S2.E14.m1.8.8.1.1.1.1.1.1.2.1" xref="S2.E14.m1.8.8.1.1.1.1.1.1.2.1.cmml"><mo id="S2.E14.m1.8.8.1.1.1.1.1.1.2.1.2" movablelimits="false" xref="S2.E14.m1.8.8.1.1.1.1.1.1.2.1.2.cmml">∑</mo><mrow id="S2.E14.m1.5.5.3" xref="S2.E14.m1.5.5.3.cmml"><mrow id="S2.E14.m1.5.5.3.5.2" xref="S2.E14.m1.5.5.3.5.1.cmml"><mo id="S2.E14.m1.5.5.3.5.2.1" stretchy="false" xref="S2.E14.m1.5.5.3.5.1.cmml">(</mo><mi id="S2.E14.m1.3.3.1.1" xref="S2.E14.m1.3.3.1.1.cmml">x</mi><mo id="S2.E14.m1.5.5.3.5.2.2" xref="S2.E14.m1.5.5.3.5.1.cmml">,</mo><mi id="S2.E14.m1.4.4.2.2" xref="S2.E14.m1.4.4.2.2.cmml">a</mi><mo id="S2.E14.m1.5.5.3.5.2.3" xref="S2.E14.m1.5.5.3.5.1.cmml">,</mo><mi id="S2.E14.m1.5.5.3.3" xref="S2.E14.m1.5.5.3.3.cmml">r</mi><mo id="S2.E14.m1.5.5.3.5.2.4" stretchy="false" xref="S2.E14.m1.5.5.3.5.1.cmml">)</mo></mrow><mo id="S2.E14.m1.5.5.3.4" xref="S2.E14.m1.5.5.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E14.m1.5.5.3.6" xref="S2.E14.m1.5.5.3.6.cmml">𝒟</mi></mrow></munder><mfrac id="S2.E14.m1.7.7" xref="S2.E14.m1.7.7.cmml"><mrow id="S2.E14.m1.6.6.1" xref="S2.E14.m1.6.6.1.cmml"><mi id="S2.E14.m1.6.6.1.3" xref="S2.E14.m1.6.6.1.3.cmml">π</mi><mo id="S2.E14.m1.6.6.1.2" xref="S2.E14.m1.6.6.1.2.cmml">⁢</mo><mrow id="S2.E14.m1.6.6.1.1.1" xref="S2.E14.m1.6.6.1.1.1.1.cmml"><mo id="S2.E14.m1.6.6.1.1.1.2" stretchy="false" xref="S2.E14.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="S2.E14.m1.6.6.1.1.1.1" xref="S2.E14.m1.6.6.1.1.1.1.cmml"><mi id="S2.E14.m1.6.6.1.1.1.1.2" xref="S2.E14.m1.6.6.1.1.1.1.2.cmml">a</mi><mo id="S2.E14.m1.6.6.1.1.1.1.1" xref="S2.E14.m1.6.6.1.1.1.1.1.cmml">∣</mo><mi id="S2.E14.m1.6.6.1.1.1.1.3" xref="S2.E14.m1.6.6.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E14.m1.6.6.1.1.1.3" stretchy="false" xref="S2.E14.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E14.m1.7.7.2" xref="S2.E14.m1.7.7.2.cmml"><msub id="S2.E14.m1.7.7.2.3" xref="S2.E14.m1.7.7.2.3.cmml"><mi id="S2.E14.m1.7.7.2.3.2" xref="S2.E14.m1.7.7.2.3.2.cmml">π</mi><mn id="S2.E14.m1.7.7.2.3.3" xref="S2.E14.m1.7.7.2.3.3.cmml">0</mn></msub><mo id="S2.E14.m1.7.7.2.2" xref="S2.E14.m1.7.7.2.2.cmml">⁢</mo><mrow id="S2.E14.m1.7.7.2.1.1" xref="S2.E14.m1.7.7.2.1.1.1.cmml"><mo id="S2.E14.m1.7.7.2.1.1.2" stretchy="false" xref="S2.E14.m1.7.7.2.1.1.1.cmml">(</mo><mrow id="S2.E14.m1.7.7.2.1.1.1" xref="S2.E14.m1.7.7.2.1.1.1.cmml"><mi id="S2.E14.m1.7.7.2.1.1.1.2" xref="S2.E14.m1.7.7.2.1.1.1.2.cmml">a</mi><mo id="S2.E14.m1.7.7.2.1.1.1.1" xref="S2.E14.m1.7.7.2.1.1.1.1.cmml">∣</mo><mi id="S2.E14.m1.7.7.2.1.1.1.3" xref="S2.E14.m1.7.7.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E14.m1.7.7.2.1.1.3" stretchy="false" xref="S2.E14.m1.7.7.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="S2.E14.m1.8.8.1.1.1.1.1.3" xref="S2.E14.m1.8.8.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.E14.m1.8.8.1.1.2" xref="S2.E14.m1.8.8.1.1.2.cmml">=</mo><mn id="S2.E14.m1.8.8.1.1.3" xref="S2.E14.m1.8.8.1.1.3.cmml">1</mn></mrow><mo id="S2.E14.m1.8.8.1.2" lspace="0em" xref="S2.E14.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E14.m1.8b"><apply id="S2.E14.m1.8.8.1.1.cmml" xref="S2.E14.m1.8.8.1"><eq id="S2.E14.m1.8.8.1.1.2.cmml" xref="S2.E14.m1.8.8.1.1.2"></eq><apply id="S2.E14.m1.8.8.1.1.1.cmml" xref="S2.E14.m1.8.8.1.1.1"><apply id="S2.E14.m1.8.8.1.1.1.2.cmml" xref="S2.E14.m1.8.8.1.1.1.2"><csymbol cd="ambiguous" id="S2.E14.m1.8.8.1.1.1.2.1.cmml" xref="S2.E14.m1.8.8.1.1.1.2">subscript</csymbol><ci id="S2.E14.m1.8.8.1.1.1.2.2.cmml" xref="S2.E14.m1.8.8.1.1.1.2.2">𝔼</ci><apply id="S2.E14.m1.1.1.1.cmml" xref="S2.E14.m1.1.1.1"><csymbol cd="latexml" id="S2.E14.m1.1.1.1.2.cmml" xref="S2.E14.m1.1.1.1.2">similar-to</csymbol><ci id="S2.E14.m1.1.1.1.3.cmml" xref="S2.E14.m1.1.1.1.3">𝒟</ci><apply id="S2.E14.m1.1.1.1.4.cmml" xref="S2.E14.m1.1.1.1.4"><times id="S2.E14.m1.1.1.1.4.1.cmml" xref="S2.E14.m1.1.1.1.4.1"></times><ci id="S2.E14.m1.1.1.1.4.2.cmml" xref="S2.E14.m1.1.1.1.4.2">𝖯</ci><ci id="S2.E14.m1.1.1.1.1.cmml" xref="S2.E14.m1.1.1.1.1">𝒟</ci></apply></apply></apply><apply id="S2.E14.m1.8.8.1.1.1.1.2.cmml" xref="S2.E14.m1.8.8.1.1.1.1.1"><csymbol cd="latexml" id="S2.E14.m1.8.8.1.1.1.1.2.1.cmml" xref="S2.E14.m1.8.8.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E14.m1.8.8.1.1.1.1.1.1.cmml" xref="S2.E14.m1.8.8.1.1.1.1.1.1"><times id="S2.E14.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S2.E14.m1.8.8.1.1.1.1.1.1.1"></times><apply id="S2.E14.m1.2.2.cmml" xref="S2.E14.m1.2.2"><divide id="S2.E14.m1.2.2.2.cmml" xref="S2.E14.m1.2.2"></divide><cn id="S2.E14.m1.2.2.3.cmml" type="integer" xref="S2.E14.m1.2.2.3">1</cn><apply id="S2.E14.m1.2.2.1.2.cmml" xref="S2.E14.m1.2.2.1.3"><abs id="S2.E14.m1.2.2.1.2.1.cmml" xref="S2.E14.m1.2.2.1.3.1"></abs><ci id="S2.E14.m1.2.2.1.1.cmml" xref="S2.E14.m1.2.2.1.1">𝒟</ci></apply></apply><apply id="S2.E14.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S2.E14.m1.8.8.1.1.1.1.1.1.2"><apply id="S2.E14.m1.8.8.1.1.1.1.1.1.2.1.cmml" xref="S2.E14.m1.8.8.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S2.E14.m1.8.8.1.1.1.1.1.1.2.1.1.cmml" xref="S2.E14.m1.8.8.1.1.1.1.1.1.2.1">subscript</csymbol><sum id="S2.E14.m1.8.8.1.1.1.1.1.1.2.1.2.cmml" xref="S2.E14.m1.8.8.1.1.1.1.1.1.2.1.2"></sum><apply id="S2.E14.m1.5.5.3.cmml" xref="S2.E14.m1.5.5.3"><in id="S2.E14.m1.5.5.3.4.cmml" xref="S2.E14.m1.5.5.3.4"></in><vector id="S2.E14.m1.5.5.3.5.1.cmml" xref="S2.E14.m1.5.5.3.5.2"><ci id="S2.E14.m1.3.3.1.1.cmml" xref="S2.E14.m1.3.3.1.1">𝑥</ci><ci id="S2.E14.m1.4.4.2.2.cmml" xref="S2.E14.m1.4.4.2.2">𝑎</ci><ci id="S2.E14.m1.5.5.3.3.cmml" xref="S2.E14.m1.5.5.3.3">𝑟</ci></vector><ci id="S2.E14.m1.5.5.3.6.cmml" xref="S2.E14.m1.5.5.3.6">𝒟</ci></apply></apply><apply id="S2.E14.m1.7.7.cmml" xref="S2.E14.m1.7.7"><divide id="S2.E14.m1.7.7.3.cmml" xref="S2.E14.m1.7.7"></divide><apply id="S2.E14.m1.6.6.1.cmml" xref="S2.E14.m1.6.6.1"><times id="S2.E14.m1.6.6.1.2.cmml" xref="S2.E14.m1.6.6.1.2"></times><ci id="S2.E14.m1.6.6.1.3.cmml" xref="S2.E14.m1.6.6.1.3">𝜋</ci><apply id="S2.E14.m1.6.6.1.1.1.1.cmml" xref="S2.E14.m1.6.6.1.1.1"><csymbol cd="latexml" id="S2.E14.m1.6.6.1.1.1.1.1.cmml" xref="S2.E14.m1.6.6.1.1.1.1.1">conditional</csymbol><ci id="S2.E14.m1.6.6.1.1.1.1.2.cmml" xref="S2.E14.m1.6.6.1.1.1.1.2">𝑎</ci><ci id="S2.E14.m1.6.6.1.1.1.1.3.cmml" xref="S2.E14.m1.6.6.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.E14.m1.7.7.2.cmml" xref="S2.E14.m1.7.7.2"><times id="S2.E14.m1.7.7.2.2.cmml" xref="S2.E14.m1.7.7.2.2"></times><apply id="S2.E14.m1.7.7.2.3.cmml" xref="S2.E14.m1.7.7.2.3"><csymbol cd="ambiguous" id="S2.E14.m1.7.7.2.3.1.cmml" xref="S2.E14.m1.7.7.2.3">subscript</csymbol><ci id="S2.E14.m1.7.7.2.3.2.cmml" xref="S2.E14.m1.7.7.2.3.2">𝜋</ci><cn id="S2.E14.m1.7.7.2.3.3.cmml" type="integer" xref="S2.E14.m1.7.7.2.3.3">0</cn></apply><apply id="S2.E14.m1.7.7.2.1.1.1.cmml" xref="S2.E14.m1.7.7.2.1.1"><csymbol cd="latexml" id="S2.E14.m1.7.7.2.1.1.1.1.cmml" xref="S2.E14.m1.7.7.2.1.1.1.1">conditional</csymbol><ci id="S2.E14.m1.7.7.2.1.1.1.2.cmml" xref="S2.E14.m1.7.7.2.1.1.1.2">𝑎</ci><ci id="S2.E14.m1.7.7.2.1.1.1.3.cmml" xref="S2.E14.m1.7.7.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply><cn id="S2.E14.m1.8.8.1.1.3.cmml" type="integer" xref="S2.E14.m1.8.8.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E14.m1.8c">\mathop{\mathbb{E}}_{\mathcal{D}\sim\mathsf{P}(\mathcal{D})}\left[\frac{1}{%
\left|\mathcal{D}\right|}\sum_{(x,a,r)\in\mathcal{D}}\frac{\pi(a\mid x)}{\pi_{%
0}(a\mid x)}\right]=1.</annotation><annotation encoding="application/x-llamapun" id="S2.E14.m1.8d">blackboard_E start_POSTSUBSCRIPT caligraphic_D ∼ sansserif_P ( caligraphic_D ) end_POSTSUBSCRIPT [ divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) ∈ caligraphic_D end_POSTSUBSCRIPT divide start_ARG italic_π ( italic_a ∣ italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ∣ italic_x ) end_ARG ] = 1 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p5.5">Furthermore, as this random variable (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2.E14" title="In 2.2. Off-policy estimation for general bandits ‣ 2. Background and Related Work ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">14</span></a>) is likely to be correlated with the IPS estimates, we can expect that its use as a control variate will lead to reduced variance (see <cite class="ltx_cite ltx_citemacro_citep">(e.g., Kong, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib36" title="">1992</a>)</cite>).
This gives rise to the asymptotically unbiased and parameter-free self-normalised IPS (SNIPS) estimator, with <math alttext="S\coloneqq\frac{1}{D}\sum_{(x,a,r)\in\mathcal{D}}\frac{\pi(a|x)}{\pi_{0}(a|x)}" class="ltx_Math" display="inline" id="S2.SS2.p5.5.m1.5"><semantics id="S2.SS2.p5.5.m1.5a"><mrow id="S2.SS2.p5.5.m1.5.6" xref="S2.SS2.p5.5.m1.5.6.cmml"><mi id="S2.SS2.p5.5.m1.5.6.2" xref="S2.SS2.p5.5.m1.5.6.2.cmml">S</mi><mo id="S2.SS2.p5.5.m1.5.6.1" xref="S2.SS2.p5.5.m1.5.6.1.cmml">≔</mo><mrow id="S2.SS2.p5.5.m1.5.6.3" xref="S2.SS2.p5.5.m1.5.6.3.cmml"><mfrac id="S2.SS2.p5.5.m1.5.6.3.2" xref="S2.SS2.p5.5.m1.5.6.3.2.cmml"><mn id="S2.SS2.p5.5.m1.5.6.3.2.2" xref="S2.SS2.p5.5.m1.5.6.3.2.2.cmml">1</mn><mi id="S2.SS2.p5.5.m1.5.6.3.2.3" xref="S2.SS2.p5.5.m1.5.6.3.2.3.cmml">D</mi></mfrac><mo id="S2.SS2.p5.5.m1.5.6.3.1" xref="S2.SS2.p5.5.m1.5.6.3.1.cmml">⁢</mo><mrow id="S2.SS2.p5.5.m1.5.6.3.3" xref="S2.SS2.p5.5.m1.5.6.3.3.cmml"><msub id="S2.SS2.p5.5.m1.5.6.3.3.1" xref="S2.SS2.p5.5.m1.5.6.3.3.1.cmml"><mo id="S2.SS2.p5.5.m1.5.6.3.3.1.2" xref="S2.SS2.p5.5.m1.5.6.3.3.1.2.cmml">∑</mo><mrow id="S2.SS2.p5.5.m1.3.3.3" xref="S2.SS2.p5.5.m1.3.3.3.cmml"><mrow id="S2.SS2.p5.5.m1.3.3.3.5.2" xref="S2.SS2.p5.5.m1.3.3.3.5.1.cmml"><mo id="S2.SS2.p5.5.m1.3.3.3.5.2.1" stretchy="false" xref="S2.SS2.p5.5.m1.3.3.3.5.1.cmml">(</mo><mi id="S2.SS2.p5.5.m1.1.1.1.1" xref="S2.SS2.p5.5.m1.1.1.1.1.cmml">x</mi><mo id="S2.SS2.p5.5.m1.3.3.3.5.2.2" xref="S2.SS2.p5.5.m1.3.3.3.5.1.cmml">,</mo><mi id="S2.SS2.p5.5.m1.2.2.2.2" xref="S2.SS2.p5.5.m1.2.2.2.2.cmml">a</mi><mo id="S2.SS2.p5.5.m1.3.3.3.5.2.3" xref="S2.SS2.p5.5.m1.3.3.3.5.1.cmml">,</mo><mi id="S2.SS2.p5.5.m1.3.3.3.3" xref="S2.SS2.p5.5.m1.3.3.3.3.cmml">r</mi><mo id="S2.SS2.p5.5.m1.3.3.3.5.2.4" stretchy="false" xref="S2.SS2.p5.5.m1.3.3.3.5.1.cmml">)</mo></mrow><mo id="S2.SS2.p5.5.m1.3.3.3.4" xref="S2.SS2.p5.5.m1.3.3.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p5.5.m1.3.3.3.6" xref="S2.SS2.p5.5.m1.3.3.3.6.cmml">𝒟</mi></mrow></msub><mfrac id="S2.SS2.p5.5.m1.5.5" xref="S2.SS2.p5.5.m1.5.5.cmml"><mrow id="S2.SS2.p5.5.m1.4.4.1" xref="S2.SS2.p5.5.m1.4.4.1.cmml"><mi id="S2.SS2.p5.5.m1.4.4.1.3" xref="S2.SS2.p5.5.m1.4.4.1.3.cmml">π</mi><mo id="S2.SS2.p5.5.m1.4.4.1.2" xref="S2.SS2.p5.5.m1.4.4.1.2.cmml">⁢</mo><mrow id="S2.SS2.p5.5.m1.4.4.1.1.1" xref="S2.SS2.p5.5.m1.4.4.1.1.1.1.cmml"><mo id="S2.SS2.p5.5.m1.4.4.1.1.1.2" stretchy="false" xref="S2.SS2.p5.5.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p5.5.m1.4.4.1.1.1.1" xref="S2.SS2.p5.5.m1.4.4.1.1.1.1.cmml"><mi id="S2.SS2.p5.5.m1.4.4.1.1.1.1.2" xref="S2.SS2.p5.5.m1.4.4.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.SS2.p5.5.m1.4.4.1.1.1.1.1" xref="S2.SS2.p5.5.m1.4.4.1.1.1.1.1.cmml">|</mo><mi id="S2.SS2.p5.5.m1.4.4.1.1.1.1.3" xref="S2.SS2.p5.5.m1.4.4.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS2.p5.5.m1.4.4.1.1.1.3" stretchy="false" xref="S2.SS2.p5.5.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.SS2.p5.5.m1.5.5.2" xref="S2.SS2.p5.5.m1.5.5.2.cmml"><msub id="S2.SS2.p5.5.m1.5.5.2.3" xref="S2.SS2.p5.5.m1.5.5.2.3.cmml"><mi id="S2.SS2.p5.5.m1.5.5.2.3.2" xref="S2.SS2.p5.5.m1.5.5.2.3.2.cmml">π</mi><mn id="S2.SS2.p5.5.m1.5.5.2.3.3" xref="S2.SS2.p5.5.m1.5.5.2.3.3.cmml">0</mn></msub><mo id="S2.SS2.p5.5.m1.5.5.2.2" xref="S2.SS2.p5.5.m1.5.5.2.2.cmml">⁢</mo><mrow id="S2.SS2.p5.5.m1.5.5.2.1.1" xref="S2.SS2.p5.5.m1.5.5.2.1.1.1.cmml"><mo id="S2.SS2.p5.5.m1.5.5.2.1.1.2" stretchy="false" xref="S2.SS2.p5.5.m1.5.5.2.1.1.1.cmml">(</mo><mrow id="S2.SS2.p5.5.m1.5.5.2.1.1.1" xref="S2.SS2.p5.5.m1.5.5.2.1.1.1.cmml"><mi id="S2.SS2.p5.5.m1.5.5.2.1.1.1.2" xref="S2.SS2.p5.5.m1.5.5.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.SS2.p5.5.m1.5.5.2.1.1.1.1" xref="S2.SS2.p5.5.m1.5.5.2.1.1.1.1.cmml">|</mo><mi id="S2.SS2.p5.5.m1.5.5.2.1.1.1.3" xref="S2.SS2.p5.5.m1.5.5.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS2.p5.5.m1.5.5.2.1.1.3" stretchy="false" xref="S2.SS2.p5.5.m1.5.5.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.5.m1.5b"><apply id="S2.SS2.p5.5.m1.5.6.cmml" xref="S2.SS2.p5.5.m1.5.6"><ci id="S2.SS2.p5.5.m1.5.6.1.cmml" xref="S2.SS2.p5.5.m1.5.6.1">≔</ci><ci id="S2.SS2.p5.5.m1.5.6.2.cmml" xref="S2.SS2.p5.5.m1.5.6.2">𝑆</ci><apply id="S2.SS2.p5.5.m1.5.6.3.cmml" xref="S2.SS2.p5.5.m1.5.6.3"><times id="S2.SS2.p5.5.m1.5.6.3.1.cmml" xref="S2.SS2.p5.5.m1.5.6.3.1"></times><apply id="S2.SS2.p5.5.m1.5.6.3.2.cmml" xref="S2.SS2.p5.5.m1.5.6.3.2"><divide id="S2.SS2.p5.5.m1.5.6.3.2.1.cmml" xref="S2.SS2.p5.5.m1.5.6.3.2"></divide><cn id="S2.SS2.p5.5.m1.5.6.3.2.2.cmml" type="integer" xref="S2.SS2.p5.5.m1.5.6.3.2.2">1</cn><ci id="S2.SS2.p5.5.m1.5.6.3.2.3.cmml" xref="S2.SS2.p5.5.m1.5.6.3.2.3">𝐷</ci></apply><apply id="S2.SS2.p5.5.m1.5.6.3.3.cmml" xref="S2.SS2.p5.5.m1.5.6.3.3"><apply id="S2.SS2.p5.5.m1.5.6.3.3.1.cmml" xref="S2.SS2.p5.5.m1.5.6.3.3.1"><csymbol cd="ambiguous" id="S2.SS2.p5.5.m1.5.6.3.3.1.1.cmml" xref="S2.SS2.p5.5.m1.5.6.3.3.1">subscript</csymbol><sum id="S2.SS2.p5.5.m1.5.6.3.3.1.2.cmml" xref="S2.SS2.p5.5.m1.5.6.3.3.1.2"></sum><apply id="S2.SS2.p5.5.m1.3.3.3.cmml" xref="S2.SS2.p5.5.m1.3.3.3"><in id="S2.SS2.p5.5.m1.3.3.3.4.cmml" xref="S2.SS2.p5.5.m1.3.3.3.4"></in><vector id="S2.SS2.p5.5.m1.3.3.3.5.1.cmml" xref="S2.SS2.p5.5.m1.3.3.3.5.2"><ci id="S2.SS2.p5.5.m1.1.1.1.1.cmml" xref="S2.SS2.p5.5.m1.1.1.1.1">𝑥</ci><ci id="S2.SS2.p5.5.m1.2.2.2.2.cmml" xref="S2.SS2.p5.5.m1.2.2.2.2">𝑎</ci><ci id="S2.SS2.p5.5.m1.3.3.3.3.cmml" xref="S2.SS2.p5.5.m1.3.3.3.3">𝑟</ci></vector><ci id="S2.SS2.p5.5.m1.3.3.3.6.cmml" xref="S2.SS2.p5.5.m1.3.3.3.6">𝒟</ci></apply></apply><apply id="S2.SS2.p5.5.m1.5.5.cmml" xref="S2.SS2.p5.5.m1.5.5"><divide id="S2.SS2.p5.5.m1.5.5.3.cmml" xref="S2.SS2.p5.5.m1.5.5"></divide><apply id="S2.SS2.p5.5.m1.4.4.1.cmml" xref="S2.SS2.p5.5.m1.4.4.1"><times id="S2.SS2.p5.5.m1.4.4.1.2.cmml" xref="S2.SS2.p5.5.m1.4.4.1.2"></times><ci id="S2.SS2.p5.5.m1.4.4.1.3.cmml" xref="S2.SS2.p5.5.m1.4.4.1.3">𝜋</ci><apply id="S2.SS2.p5.5.m1.4.4.1.1.1.1.cmml" xref="S2.SS2.p5.5.m1.4.4.1.1.1"><csymbol cd="latexml" id="S2.SS2.p5.5.m1.4.4.1.1.1.1.1.cmml" xref="S2.SS2.p5.5.m1.4.4.1.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p5.5.m1.4.4.1.1.1.1.2.cmml" xref="S2.SS2.p5.5.m1.4.4.1.1.1.1.2">𝑎</ci><ci id="S2.SS2.p5.5.m1.4.4.1.1.1.1.3.cmml" xref="S2.SS2.p5.5.m1.4.4.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.SS2.p5.5.m1.5.5.2.cmml" xref="S2.SS2.p5.5.m1.5.5.2"><times id="S2.SS2.p5.5.m1.5.5.2.2.cmml" xref="S2.SS2.p5.5.m1.5.5.2.2"></times><apply id="S2.SS2.p5.5.m1.5.5.2.3.cmml" xref="S2.SS2.p5.5.m1.5.5.2.3"><csymbol cd="ambiguous" id="S2.SS2.p5.5.m1.5.5.2.3.1.cmml" xref="S2.SS2.p5.5.m1.5.5.2.3">subscript</csymbol><ci id="S2.SS2.p5.5.m1.5.5.2.3.2.cmml" xref="S2.SS2.p5.5.m1.5.5.2.3.2">𝜋</ci><cn id="S2.SS2.p5.5.m1.5.5.2.3.3.cmml" type="integer" xref="S2.SS2.p5.5.m1.5.5.2.3.3">0</cn></apply><apply id="S2.SS2.p5.5.m1.5.5.2.1.1.1.cmml" xref="S2.SS2.p5.5.m1.5.5.2.1.1"><csymbol cd="latexml" id="S2.SS2.p5.5.m1.5.5.2.1.1.1.1.cmml" xref="S2.SS2.p5.5.m1.5.5.2.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p5.5.m1.5.5.2.1.1.1.2.cmml" xref="S2.SS2.p5.5.m1.5.5.2.1.1.1.2">𝑎</ci><ci id="S2.SS2.p5.5.m1.5.5.2.1.1.1.3.cmml" xref="S2.SS2.p5.5.m1.5.5.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.5.m1.5c">S\coloneqq\frac{1}{D}\sum_{(x,a,r)\in\mathcal{D}}\frac{\pi(a|x)}{\pi_{0}(a|x)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p5.5.m1.5d">italic_S ≔ divide start_ARG 1 end_ARG start_ARG italic_D end_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) ∈ caligraphic_D end_POSTSUBSCRIPT divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG</annotation></semantics></math> as its normalization term:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(15)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widehat{V}_{\rm SNIPS}(\pi,\mathcal{D})=\frac{\sum_{(x,a,r)\in\mathcal{D}}%
\frac{\pi(a|x)}{\pi_{0}(a|x)}r}{\sum_{(x,a,r)\in\mathcal{D}}\frac{\pi(a|x)}{%
\pi_{0}(a|x)}}=\frac{\widehat{V}_{\rm IPS}(\pi,\mathcal{D})}{S}." class="ltx_Math" display="block" id="S2.E15.m1.15"><semantics id="S2.E15.m1.15a"><mrow id="S2.E15.m1.15.15.1" xref="S2.E15.m1.15.15.1.1.cmml"><mrow id="S2.E15.m1.15.15.1.1" xref="S2.E15.m1.15.15.1.1.cmml"><mrow id="S2.E15.m1.15.15.1.1.2" xref="S2.E15.m1.15.15.1.1.2.cmml"><msub id="S2.E15.m1.15.15.1.1.2.2" xref="S2.E15.m1.15.15.1.1.2.2.cmml"><mover accent="true" id="S2.E15.m1.15.15.1.1.2.2.2" xref="S2.E15.m1.15.15.1.1.2.2.2.cmml"><mi id="S2.E15.m1.15.15.1.1.2.2.2.2" xref="S2.E15.m1.15.15.1.1.2.2.2.2.cmml">V</mi><mo id="S2.E15.m1.15.15.1.1.2.2.2.1" xref="S2.E15.m1.15.15.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S2.E15.m1.15.15.1.1.2.2.3" xref="S2.E15.m1.15.15.1.1.2.2.3.cmml">SNIPS</mi></msub><mo id="S2.E15.m1.15.15.1.1.2.1" xref="S2.E15.m1.15.15.1.1.2.1.cmml">⁢</mo><mrow id="S2.E15.m1.15.15.1.1.2.3.2" xref="S2.E15.m1.15.15.1.1.2.3.1.cmml"><mo id="S2.E15.m1.15.15.1.1.2.3.2.1" stretchy="false" xref="S2.E15.m1.15.15.1.1.2.3.1.cmml">(</mo><mi id="S2.E15.m1.13.13" xref="S2.E15.m1.13.13.cmml">π</mi><mo id="S2.E15.m1.15.15.1.1.2.3.2.2" xref="S2.E15.m1.15.15.1.1.2.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.E15.m1.14.14" xref="S2.E15.m1.14.14.cmml">𝒟</mi><mo id="S2.E15.m1.15.15.1.1.2.3.2.3" stretchy="false" xref="S2.E15.m1.15.15.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E15.m1.15.15.1.1.3" xref="S2.E15.m1.15.15.1.1.3.cmml">=</mo><mfrac id="S2.E15.m1.10.10" xref="S2.E15.m1.10.10.cmml"><mrow id="S2.E15.m1.5.5.5" xref="S2.E15.m1.5.5.5.cmml"><msub id="S2.E15.m1.5.5.5.6" xref="S2.E15.m1.5.5.5.6.cmml"><mo id="S2.E15.m1.5.5.5.6.2" xref="S2.E15.m1.5.5.5.6.2.cmml">∑</mo><mrow id="S2.E15.m1.3.3.3.3.3" xref="S2.E15.m1.3.3.3.3.3.cmml"><mrow id="S2.E15.m1.3.3.3.3.3.5.2" xref="S2.E15.m1.3.3.3.3.3.5.1.cmml"><mo id="S2.E15.m1.3.3.3.3.3.5.2.1" stretchy="false" xref="S2.E15.m1.3.3.3.3.3.5.1.cmml">(</mo><mi id="S2.E15.m1.1.1.1.1.1.1" xref="S2.E15.m1.1.1.1.1.1.1.cmml">x</mi><mo id="S2.E15.m1.3.3.3.3.3.5.2.2" xref="S2.E15.m1.3.3.3.3.3.5.1.cmml">,</mo><mi id="S2.E15.m1.2.2.2.2.2.2" xref="S2.E15.m1.2.2.2.2.2.2.cmml">a</mi><mo id="S2.E15.m1.3.3.3.3.3.5.2.3" xref="S2.E15.m1.3.3.3.3.3.5.1.cmml">,</mo><mi id="S2.E15.m1.3.3.3.3.3.3" xref="S2.E15.m1.3.3.3.3.3.3.cmml">r</mi><mo id="S2.E15.m1.3.3.3.3.3.5.2.4" stretchy="false" xref="S2.E15.m1.3.3.3.3.3.5.1.cmml">)</mo></mrow><mo id="S2.E15.m1.3.3.3.3.3.4" xref="S2.E15.m1.3.3.3.3.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E15.m1.3.3.3.3.3.6" xref="S2.E15.m1.3.3.3.3.3.6.cmml">𝒟</mi></mrow></msub><mrow id="S2.E15.m1.5.5.5.7" xref="S2.E15.m1.5.5.5.7.cmml"><mfrac id="S2.E15.m1.5.5.5.5" xref="S2.E15.m1.5.5.5.5.cmml"><mrow id="S2.E15.m1.4.4.4.4.1" xref="S2.E15.m1.4.4.4.4.1.cmml"><mi id="S2.E15.m1.4.4.4.4.1.3" xref="S2.E15.m1.4.4.4.4.1.3.cmml">π</mi><mo id="S2.E15.m1.4.4.4.4.1.2" xref="S2.E15.m1.4.4.4.4.1.2.cmml">⁢</mo><mrow id="S2.E15.m1.4.4.4.4.1.1.1" xref="S2.E15.m1.4.4.4.4.1.1.1.1.cmml"><mo id="S2.E15.m1.4.4.4.4.1.1.1.2" stretchy="false" xref="S2.E15.m1.4.4.4.4.1.1.1.1.cmml">(</mo><mrow id="S2.E15.m1.4.4.4.4.1.1.1.1" xref="S2.E15.m1.4.4.4.4.1.1.1.1.cmml"><mi id="S2.E15.m1.4.4.4.4.1.1.1.1.2" xref="S2.E15.m1.4.4.4.4.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.E15.m1.4.4.4.4.1.1.1.1.1" xref="S2.E15.m1.4.4.4.4.1.1.1.1.1.cmml">|</mo><mi id="S2.E15.m1.4.4.4.4.1.1.1.1.3" xref="S2.E15.m1.4.4.4.4.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E15.m1.4.4.4.4.1.1.1.3" stretchy="false" xref="S2.E15.m1.4.4.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E15.m1.5.5.5.5.2" xref="S2.E15.m1.5.5.5.5.2.cmml"><msub id="S2.E15.m1.5.5.5.5.2.3" xref="S2.E15.m1.5.5.5.5.2.3.cmml"><mi id="S2.E15.m1.5.5.5.5.2.3.2" xref="S2.E15.m1.5.5.5.5.2.3.2.cmml">π</mi><mn id="S2.E15.m1.5.5.5.5.2.3.3" xref="S2.E15.m1.5.5.5.5.2.3.3.cmml">0</mn></msub><mo id="S2.E15.m1.5.5.5.5.2.2" xref="S2.E15.m1.5.5.5.5.2.2.cmml">⁢</mo><mrow id="S2.E15.m1.5.5.5.5.2.1.1" xref="S2.E15.m1.5.5.5.5.2.1.1.1.cmml"><mo id="S2.E15.m1.5.5.5.5.2.1.1.2" stretchy="false" xref="S2.E15.m1.5.5.5.5.2.1.1.1.cmml">(</mo><mrow id="S2.E15.m1.5.5.5.5.2.1.1.1" xref="S2.E15.m1.5.5.5.5.2.1.1.1.cmml"><mi id="S2.E15.m1.5.5.5.5.2.1.1.1.2" xref="S2.E15.m1.5.5.5.5.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.E15.m1.5.5.5.5.2.1.1.1.1" xref="S2.E15.m1.5.5.5.5.2.1.1.1.1.cmml">|</mo><mi id="S2.E15.m1.5.5.5.5.2.1.1.1.3" xref="S2.E15.m1.5.5.5.5.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E15.m1.5.5.5.5.2.1.1.3" stretchy="false" xref="S2.E15.m1.5.5.5.5.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S2.E15.m1.5.5.5.7.1" xref="S2.E15.m1.5.5.5.7.1.cmml">⁢</mo><mi id="S2.E15.m1.5.5.5.7.2" xref="S2.E15.m1.5.5.5.7.2.cmml">r</mi></mrow></mrow><mrow id="S2.E15.m1.10.10.10" xref="S2.E15.m1.10.10.10.cmml"><msub id="S2.E15.m1.10.10.10.6" xref="S2.E15.m1.10.10.10.6.cmml"><mo id="S2.E15.m1.10.10.10.6.2" xref="S2.E15.m1.10.10.10.6.2.cmml">∑</mo><mrow id="S2.E15.m1.8.8.8.3.3" xref="S2.E15.m1.8.8.8.3.3.cmml"><mrow id="S2.E15.m1.8.8.8.3.3.5.2" xref="S2.E15.m1.8.8.8.3.3.5.1.cmml"><mo id="S2.E15.m1.8.8.8.3.3.5.2.1" stretchy="false" xref="S2.E15.m1.8.8.8.3.3.5.1.cmml">(</mo><mi id="S2.E15.m1.6.6.6.1.1.1" xref="S2.E15.m1.6.6.6.1.1.1.cmml">x</mi><mo id="S2.E15.m1.8.8.8.3.3.5.2.2" xref="S2.E15.m1.8.8.8.3.3.5.1.cmml">,</mo><mi id="S2.E15.m1.7.7.7.2.2.2" xref="S2.E15.m1.7.7.7.2.2.2.cmml">a</mi><mo id="S2.E15.m1.8.8.8.3.3.5.2.3" xref="S2.E15.m1.8.8.8.3.3.5.1.cmml">,</mo><mi id="S2.E15.m1.8.8.8.3.3.3" xref="S2.E15.m1.8.8.8.3.3.3.cmml">r</mi><mo id="S2.E15.m1.8.8.8.3.3.5.2.4" stretchy="false" xref="S2.E15.m1.8.8.8.3.3.5.1.cmml">)</mo></mrow><mo id="S2.E15.m1.8.8.8.3.3.4" xref="S2.E15.m1.8.8.8.3.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E15.m1.8.8.8.3.3.6" xref="S2.E15.m1.8.8.8.3.3.6.cmml">𝒟</mi></mrow></msub><mfrac id="S2.E15.m1.10.10.10.5" xref="S2.E15.m1.10.10.10.5.cmml"><mrow id="S2.E15.m1.9.9.9.4.1" xref="S2.E15.m1.9.9.9.4.1.cmml"><mi id="S2.E15.m1.9.9.9.4.1.3" xref="S2.E15.m1.9.9.9.4.1.3.cmml">π</mi><mo id="S2.E15.m1.9.9.9.4.1.2" xref="S2.E15.m1.9.9.9.4.1.2.cmml">⁢</mo><mrow id="S2.E15.m1.9.9.9.4.1.1.1" xref="S2.E15.m1.9.9.9.4.1.1.1.1.cmml"><mo id="S2.E15.m1.9.9.9.4.1.1.1.2" stretchy="false" xref="S2.E15.m1.9.9.9.4.1.1.1.1.cmml">(</mo><mrow id="S2.E15.m1.9.9.9.4.1.1.1.1" xref="S2.E15.m1.9.9.9.4.1.1.1.1.cmml"><mi id="S2.E15.m1.9.9.9.4.1.1.1.1.2" xref="S2.E15.m1.9.9.9.4.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.E15.m1.9.9.9.4.1.1.1.1.1" xref="S2.E15.m1.9.9.9.4.1.1.1.1.1.cmml">|</mo><mi id="S2.E15.m1.9.9.9.4.1.1.1.1.3" xref="S2.E15.m1.9.9.9.4.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E15.m1.9.9.9.4.1.1.1.3" stretchy="false" xref="S2.E15.m1.9.9.9.4.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E15.m1.10.10.10.5.2" xref="S2.E15.m1.10.10.10.5.2.cmml"><msub id="S2.E15.m1.10.10.10.5.2.3" xref="S2.E15.m1.10.10.10.5.2.3.cmml"><mi id="S2.E15.m1.10.10.10.5.2.3.2" xref="S2.E15.m1.10.10.10.5.2.3.2.cmml">π</mi><mn id="S2.E15.m1.10.10.10.5.2.3.3" xref="S2.E15.m1.10.10.10.5.2.3.3.cmml">0</mn></msub><mo id="S2.E15.m1.10.10.10.5.2.2" xref="S2.E15.m1.10.10.10.5.2.2.cmml">⁢</mo><mrow id="S2.E15.m1.10.10.10.5.2.1.1" xref="S2.E15.m1.10.10.10.5.2.1.1.1.cmml"><mo id="S2.E15.m1.10.10.10.5.2.1.1.2" stretchy="false" xref="S2.E15.m1.10.10.10.5.2.1.1.1.cmml">(</mo><mrow id="S2.E15.m1.10.10.10.5.2.1.1.1" xref="S2.E15.m1.10.10.10.5.2.1.1.1.cmml"><mi id="S2.E15.m1.10.10.10.5.2.1.1.1.2" xref="S2.E15.m1.10.10.10.5.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.E15.m1.10.10.10.5.2.1.1.1.1" xref="S2.E15.m1.10.10.10.5.2.1.1.1.1.cmml">|</mo><mi id="S2.E15.m1.10.10.10.5.2.1.1.1.3" xref="S2.E15.m1.10.10.10.5.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E15.m1.10.10.10.5.2.1.1.3" stretchy="false" xref="S2.E15.m1.10.10.10.5.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mfrac><mo id="S2.E15.m1.15.15.1.1.4" xref="S2.E15.m1.15.15.1.1.4.cmml">=</mo><mfrac id="S2.E15.m1.12.12" xref="S2.E15.m1.12.12.cmml"><mrow id="S2.E15.m1.12.12.2" xref="S2.E15.m1.12.12.2.cmml"><msub id="S2.E15.m1.12.12.2.4" xref="S2.E15.m1.12.12.2.4.cmml"><mover accent="true" id="S2.E15.m1.12.12.2.4.2" xref="S2.E15.m1.12.12.2.4.2.cmml"><mi id="S2.E15.m1.12.12.2.4.2.2" xref="S2.E15.m1.12.12.2.4.2.2.cmml">V</mi><mo id="S2.E15.m1.12.12.2.4.2.1" xref="S2.E15.m1.12.12.2.4.2.1.cmml">^</mo></mover><mi id="S2.E15.m1.12.12.2.4.3" xref="S2.E15.m1.12.12.2.4.3.cmml">IPS</mi></msub><mo id="S2.E15.m1.12.12.2.3" xref="S2.E15.m1.12.12.2.3.cmml">⁢</mo><mrow id="S2.E15.m1.12.12.2.5.2" xref="S2.E15.m1.12.12.2.5.1.cmml"><mo id="S2.E15.m1.12.12.2.5.2.1" stretchy="false" xref="S2.E15.m1.12.12.2.5.1.cmml">(</mo><mi id="S2.E15.m1.11.11.1.1" xref="S2.E15.m1.11.11.1.1.cmml">π</mi><mo id="S2.E15.m1.12.12.2.5.2.2" xref="S2.E15.m1.12.12.2.5.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.E15.m1.12.12.2.2" xref="S2.E15.m1.12.12.2.2.cmml">𝒟</mi><mo id="S2.E15.m1.12.12.2.5.2.3" stretchy="false" xref="S2.E15.m1.12.12.2.5.1.cmml">)</mo></mrow></mrow><mi id="S2.E15.m1.12.12.4" xref="S2.E15.m1.12.12.4.cmml">S</mi></mfrac></mrow><mo id="S2.E15.m1.15.15.1.2" lspace="0em" xref="S2.E15.m1.15.15.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E15.m1.15b"><apply id="S2.E15.m1.15.15.1.1.cmml" xref="S2.E15.m1.15.15.1"><and id="S2.E15.m1.15.15.1.1a.cmml" xref="S2.E15.m1.15.15.1"></and><apply id="S2.E15.m1.15.15.1.1b.cmml" xref="S2.E15.m1.15.15.1"><eq id="S2.E15.m1.15.15.1.1.3.cmml" xref="S2.E15.m1.15.15.1.1.3"></eq><apply id="S2.E15.m1.15.15.1.1.2.cmml" xref="S2.E15.m1.15.15.1.1.2"><times id="S2.E15.m1.15.15.1.1.2.1.cmml" xref="S2.E15.m1.15.15.1.1.2.1"></times><apply id="S2.E15.m1.15.15.1.1.2.2.cmml" xref="S2.E15.m1.15.15.1.1.2.2"><csymbol cd="ambiguous" id="S2.E15.m1.15.15.1.1.2.2.1.cmml" xref="S2.E15.m1.15.15.1.1.2.2">subscript</csymbol><apply id="S2.E15.m1.15.15.1.1.2.2.2.cmml" xref="S2.E15.m1.15.15.1.1.2.2.2"><ci id="S2.E15.m1.15.15.1.1.2.2.2.1.cmml" xref="S2.E15.m1.15.15.1.1.2.2.2.1">^</ci><ci id="S2.E15.m1.15.15.1.1.2.2.2.2.cmml" xref="S2.E15.m1.15.15.1.1.2.2.2.2">𝑉</ci></apply><ci id="S2.E15.m1.15.15.1.1.2.2.3.cmml" xref="S2.E15.m1.15.15.1.1.2.2.3">SNIPS</ci></apply><interval closure="open" id="S2.E15.m1.15.15.1.1.2.3.1.cmml" xref="S2.E15.m1.15.15.1.1.2.3.2"><ci id="S2.E15.m1.13.13.cmml" xref="S2.E15.m1.13.13">𝜋</ci><ci id="S2.E15.m1.14.14.cmml" xref="S2.E15.m1.14.14">𝒟</ci></interval></apply><apply id="S2.E15.m1.10.10.cmml" xref="S2.E15.m1.10.10"><divide id="S2.E15.m1.10.10.11.cmml" xref="S2.E15.m1.10.10"></divide><apply id="S2.E15.m1.5.5.5.cmml" xref="S2.E15.m1.5.5.5"><apply id="S2.E15.m1.5.5.5.6.cmml" xref="S2.E15.m1.5.5.5.6"><csymbol cd="ambiguous" id="S2.E15.m1.5.5.5.6.1.cmml" xref="S2.E15.m1.5.5.5.6">subscript</csymbol><sum id="S2.E15.m1.5.5.5.6.2.cmml" xref="S2.E15.m1.5.5.5.6.2"></sum><apply id="S2.E15.m1.3.3.3.3.3.cmml" xref="S2.E15.m1.3.3.3.3.3"><in id="S2.E15.m1.3.3.3.3.3.4.cmml" xref="S2.E15.m1.3.3.3.3.3.4"></in><vector id="S2.E15.m1.3.3.3.3.3.5.1.cmml" xref="S2.E15.m1.3.3.3.3.3.5.2"><ci id="S2.E15.m1.1.1.1.1.1.1.cmml" xref="S2.E15.m1.1.1.1.1.1.1">𝑥</ci><ci id="S2.E15.m1.2.2.2.2.2.2.cmml" xref="S2.E15.m1.2.2.2.2.2.2">𝑎</ci><ci id="S2.E15.m1.3.3.3.3.3.3.cmml" xref="S2.E15.m1.3.3.3.3.3.3">𝑟</ci></vector><ci id="S2.E15.m1.3.3.3.3.3.6.cmml" xref="S2.E15.m1.3.3.3.3.3.6">𝒟</ci></apply></apply><apply id="S2.E15.m1.5.5.5.7.cmml" xref="S2.E15.m1.5.5.5.7"><times id="S2.E15.m1.5.5.5.7.1.cmml" xref="S2.E15.m1.5.5.5.7.1"></times><apply id="S2.E15.m1.5.5.5.5.cmml" xref="S2.E15.m1.5.5.5.5"><divide id="S2.E15.m1.5.5.5.5.3.cmml" xref="S2.E15.m1.5.5.5.5"></divide><apply id="S2.E15.m1.4.4.4.4.1.cmml" xref="S2.E15.m1.4.4.4.4.1"><times id="S2.E15.m1.4.4.4.4.1.2.cmml" xref="S2.E15.m1.4.4.4.4.1.2"></times><ci id="S2.E15.m1.4.4.4.4.1.3.cmml" xref="S2.E15.m1.4.4.4.4.1.3">𝜋</ci><apply id="S2.E15.m1.4.4.4.4.1.1.1.1.cmml" xref="S2.E15.m1.4.4.4.4.1.1.1"><csymbol cd="latexml" id="S2.E15.m1.4.4.4.4.1.1.1.1.1.cmml" xref="S2.E15.m1.4.4.4.4.1.1.1.1.1">conditional</csymbol><ci id="S2.E15.m1.4.4.4.4.1.1.1.1.2.cmml" xref="S2.E15.m1.4.4.4.4.1.1.1.1.2">𝑎</ci><ci id="S2.E15.m1.4.4.4.4.1.1.1.1.3.cmml" xref="S2.E15.m1.4.4.4.4.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.E15.m1.5.5.5.5.2.cmml" xref="S2.E15.m1.5.5.5.5.2"><times id="S2.E15.m1.5.5.5.5.2.2.cmml" xref="S2.E15.m1.5.5.5.5.2.2"></times><apply id="S2.E15.m1.5.5.5.5.2.3.cmml" xref="S2.E15.m1.5.5.5.5.2.3"><csymbol cd="ambiguous" id="S2.E15.m1.5.5.5.5.2.3.1.cmml" xref="S2.E15.m1.5.5.5.5.2.3">subscript</csymbol><ci id="S2.E15.m1.5.5.5.5.2.3.2.cmml" xref="S2.E15.m1.5.5.5.5.2.3.2">𝜋</ci><cn id="S2.E15.m1.5.5.5.5.2.3.3.cmml" type="integer" xref="S2.E15.m1.5.5.5.5.2.3.3">0</cn></apply><apply id="S2.E15.m1.5.5.5.5.2.1.1.1.cmml" xref="S2.E15.m1.5.5.5.5.2.1.1"><csymbol cd="latexml" id="S2.E15.m1.5.5.5.5.2.1.1.1.1.cmml" xref="S2.E15.m1.5.5.5.5.2.1.1.1.1">conditional</csymbol><ci id="S2.E15.m1.5.5.5.5.2.1.1.1.2.cmml" xref="S2.E15.m1.5.5.5.5.2.1.1.1.2">𝑎</ci><ci id="S2.E15.m1.5.5.5.5.2.1.1.1.3.cmml" xref="S2.E15.m1.5.5.5.5.2.1.1.1.3">𝑥</ci></apply></apply></apply><ci id="S2.E15.m1.5.5.5.7.2.cmml" xref="S2.E15.m1.5.5.5.7.2">𝑟</ci></apply></apply><apply id="S2.E15.m1.10.10.10.cmml" xref="S2.E15.m1.10.10.10"><apply id="S2.E15.m1.10.10.10.6.cmml" xref="S2.E15.m1.10.10.10.6"><csymbol cd="ambiguous" id="S2.E15.m1.10.10.10.6.1.cmml" xref="S2.E15.m1.10.10.10.6">subscript</csymbol><sum id="S2.E15.m1.10.10.10.6.2.cmml" xref="S2.E15.m1.10.10.10.6.2"></sum><apply id="S2.E15.m1.8.8.8.3.3.cmml" xref="S2.E15.m1.8.8.8.3.3"><in id="S2.E15.m1.8.8.8.3.3.4.cmml" xref="S2.E15.m1.8.8.8.3.3.4"></in><vector id="S2.E15.m1.8.8.8.3.3.5.1.cmml" xref="S2.E15.m1.8.8.8.3.3.5.2"><ci id="S2.E15.m1.6.6.6.1.1.1.cmml" xref="S2.E15.m1.6.6.6.1.1.1">𝑥</ci><ci id="S2.E15.m1.7.7.7.2.2.2.cmml" xref="S2.E15.m1.7.7.7.2.2.2">𝑎</ci><ci id="S2.E15.m1.8.8.8.3.3.3.cmml" xref="S2.E15.m1.8.8.8.3.3.3">𝑟</ci></vector><ci id="S2.E15.m1.8.8.8.3.3.6.cmml" xref="S2.E15.m1.8.8.8.3.3.6">𝒟</ci></apply></apply><apply id="S2.E15.m1.10.10.10.5.cmml" xref="S2.E15.m1.10.10.10.5"><divide id="S2.E15.m1.10.10.10.5.3.cmml" xref="S2.E15.m1.10.10.10.5"></divide><apply id="S2.E15.m1.9.9.9.4.1.cmml" xref="S2.E15.m1.9.9.9.4.1"><times id="S2.E15.m1.9.9.9.4.1.2.cmml" xref="S2.E15.m1.9.9.9.4.1.2"></times><ci id="S2.E15.m1.9.9.9.4.1.3.cmml" xref="S2.E15.m1.9.9.9.4.1.3">𝜋</ci><apply id="S2.E15.m1.9.9.9.4.1.1.1.1.cmml" xref="S2.E15.m1.9.9.9.4.1.1.1"><csymbol cd="latexml" id="S2.E15.m1.9.9.9.4.1.1.1.1.1.cmml" xref="S2.E15.m1.9.9.9.4.1.1.1.1.1">conditional</csymbol><ci id="S2.E15.m1.9.9.9.4.1.1.1.1.2.cmml" xref="S2.E15.m1.9.9.9.4.1.1.1.1.2">𝑎</ci><ci id="S2.E15.m1.9.9.9.4.1.1.1.1.3.cmml" xref="S2.E15.m1.9.9.9.4.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.E15.m1.10.10.10.5.2.cmml" xref="S2.E15.m1.10.10.10.5.2"><times id="S2.E15.m1.10.10.10.5.2.2.cmml" xref="S2.E15.m1.10.10.10.5.2.2"></times><apply id="S2.E15.m1.10.10.10.5.2.3.cmml" xref="S2.E15.m1.10.10.10.5.2.3"><csymbol cd="ambiguous" id="S2.E15.m1.10.10.10.5.2.3.1.cmml" xref="S2.E15.m1.10.10.10.5.2.3">subscript</csymbol><ci id="S2.E15.m1.10.10.10.5.2.3.2.cmml" xref="S2.E15.m1.10.10.10.5.2.3.2">𝜋</ci><cn id="S2.E15.m1.10.10.10.5.2.3.3.cmml" type="integer" xref="S2.E15.m1.10.10.10.5.2.3.3">0</cn></apply><apply id="S2.E15.m1.10.10.10.5.2.1.1.1.cmml" xref="S2.E15.m1.10.10.10.5.2.1.1"><csymbol cd="latexml" id="S2.E15.m1.10.10.10.5.2.1.1.1.1.cmml" xref="S2.E15.m1.10.10.10.5.2.1.1.1.1">conditional</csymbol><ci id="S2.E15.m1.10.10.10.5.2.1.1.1.2.cmml" xref="S2.E15.m1.10.10.10.5.2.1.1.1.2">𝑎</ci><ci id="S2.E15.m1.10.10.10.5.2.1.1.1.3.cmml" xref="S2.E15.m1.10.10.10.5.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply><apply id="S2.E15.m1.15.15.1.1c.cmml" xref="S2.E15.m1.15.15.1"><eq id="S2.E15.m1.15.15.1.1.4.cmml" xref="S2.E15.m1.15.15.1.1.4"></eq><share href="https://arxiv.org/html/2405.05736v2#S2.E15.m1.10.10.cmml" id="S2.E15.m1.15.15.1.1d.cmml" xref="S2.E15.m1.15.15.1"></share><apply id="S2.E15.m1.12.12.cmml" xref="S2.E15.m1.12.12"><divide id="S2.E15.m1.12.12.3.cmml" xref="S2.E15.m1.12.12"></divide><apply id="S2.E15.m1.12.12.2.cmml" xref="S2.E15.m1.12.12.2"><times id="S2.E15.m1.12.12.2.3.cmml" xref="S2.E15.m1.12.12.2.3"></times><apply id="S2.E15.m1.12.12.2.4.cmml" xref="S2.E15.m1.12.12.2.4"><csymbol cd="ambiguous" id="S2.E15.m1.12.12.2.4.1.cmml" xref="S2.E15.m1.12.12.2.4">subscript</csymbol><apply id="S2.E15.m1.12.12.2.4.2.cmml" xref="S2.E15.m1.12.12.2.4.2"><ci id="S2.E15.m1.12.12.2.4.2.1.cmml" xref="S2.E15.m1.12.12.2.4.2.1">^</ci><ci id="S2.E15.m1.12.12.2.4.2.2.cmml" xref="S2.E15.m1.12.12.2.4.2.2">𝑉</ci></apply><ci id="S2.E15.m1.12.12.2.4.3.cmml" xref="S2.E15.m1.12.12.2.4.3">IPS</ci></apply><interval closure="open" id="S2.E15.m1.12.12.2.5.1.cmml" xref="S2.E15.m1.12.12.2.5.2"><ci id="S2.E15.m1.11.11.1.1.cmml" xref="S2.E15.m1.11.11.1.1">𝜋</ci><ci id="S2.E15.m1.12.12.2.2.cmml" xref="S2.E15.m1.12.12.2.2">𝒟</ci></interval></apply><ci id="S2.E15.m1.12.12.4.cmml" xref="S2.E15.m1.12.12.4">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E15.m1.15c">\widehat{V}_{\rm SNIPS}(\pi,\mathcal{D})=\frac{\sum_{(x,a,r)\in\mathcal{D}}%
\frac{\pi(a|x)}{\pi_{0}(a|x)}r}{\sum_{(x,a,r)\in\mathcal{D}}\frac{\pi(a|x)}{%
\pi_{0}(a|x)}}=\frac{\widehat{V}_{\rm IPS}(\pi,\mathcal{D})}{S}.</annotation><annotation encoding="application/x-llamapun" id="S2.E15.m1.15d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_SNIPS end_POSTSUBSCRIPT ( italic_π , caligraphic_D ) = divide start_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) ∈ caligraphic_D end_POSTSUBSCRIPT divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG italic_r end_ARG start_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) ∈ caligraphic_D end_POSTSUBSCRIPT divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG end_ARG = divide start_ARG over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_IPS end_POSTSUBSCRIPT ( italic_π , caligraphic_D ) end_ARG start_ARG italic_S end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p5.6">Given the properties of being asymptotically unbiased and parameter-free, this estimator is often a go-to method for off-policy <em class="ltx_emph ltx_font_italic" id="S2.SS2.p5.6.1">evaluation</em> use-cases <cite class="ltx_cite ltx_citemacro_citep">(Saito et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib53" title="">2021</a>)</cite>.
An additional advantage is that the SNIPS estimator is invariant to translations in the reward, which cannot be said for <math alttext="\widehat{V}_{\rm IPS}" class="ltx_Math" display="inline" id="S2.SS2.p5.6.m1.1"><semantics id="S2.SS2.p5.6.m1.1a"><msub id="S2.SS2.p5.6.m1.1.1" xref="S2.SS2.p5.6.m1.1.1.cmml"><mover accent="true" id="S2.SS2.p5.6.m1.1.1.2" xref="S2.SS2.p5.6.m1.1.1.2.cmml"><mi id="S2.SS2.p5.6.m1.1.1.2.2" xref="S2.SS2.p5.6.m1.1.1.2.2.cmml">V</mi><mo id="S2.SS2.p5.6.m1.1.1.2.1" xref="S2.SS2.p5.6.m1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.p5.6.m1.1.1.3" xref="S2.SS2.p5.6.m1.1.1.3.cmml">IPS</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.6.m1.1b"><apply id="S2.SS2.p5.6.m1.1.1.cmml" xref="S2.SS2.p5.6.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.6.m1.1.1.1.cmml" xref="S2.SS2.p5.6.m1.1.1">subscript</csymbol><apply id="S2.SS2.p5.6.m1.1.1.2.cmml" xref="S2.SS2.p5.6.m1.1.1.2"><ci id="S2.SS2.p5.6.m1.1.1.2.1.cmml" xref="S2.SS2.p5.6.m1.1.1.2.1">^</ci><ci id="S2.SS2.p5.6.m1.1.1.2.2.cmml" xref="S2.SS2.p5.6.m1.1.1.2.2">𝑉</ci></apply><ci id="S2.SS2.p5.6.m1.1.1.3.cmml" xref="S2.SS2.p5.6.m1.1.1.3">IPS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.6.m1.1c">\widehat{V}_{\rm IPS}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p5.6.m1.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_IPS end_POSTSUBSCRIPT</annotation></semantics></math>.
Whilst the formulation in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2.E15" title="In 2.2. Off-policy estimation for general bandits ‣ 2. Background and Related Work ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">15</span></a> is not obvious in this regard, it becomes clear when we consider its gradient:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Ax1.EGx4">
<tbody id="S2.Ex7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\nabla\widehat{V}_{\rm SNIPS}(\pi,\mathcal{D})=\nabla\left(\frac{%
\sum_{(x,a,r)}\frac{\pi(a|x)}{\pi_{0}(a|x)}r}{\sum_{(x,a)}\frac{\pi(a|x)}{\pi_%
{0}(a|x)}}\right)" class="ltx_Math" display="inline" id="S2.Ex7.m2.12"><semantics id="S2.Ex7.m2.12a"><mrow id="S2.Ex7.m2.12.13" xref="S2.Ex7.m2.12.13.cmml"><mrow id="S2.Ex7.m2.12.13.2" xref="S2.Ex7.m2.12.13.2.cmml"><mrow id="S2.Ex7.m2.12.13.2.2" xref="S2.Ex7.m2.12.13.2.2.cmml"><mo id="S2.Ex7.m2.12.13.2.2.1" rspace="0.167em" xref="S2.Ex7.m2.12.13.2.2.1.cmml">∇</mo><msub id="S2.Ex7.m2.12.13.2.2.2" xref="S2.Ex7.m2.12.13.2.2.2.cmml"><mover accent="true" id="S2.Ex7.m2.12.13.2.2.2.2" xref="S2.Ex7.m2.12.13.2.2.2.2.cmml"><mi id="S2.Ex7.m2.12.13.2.2.2.2.2" xref="S2.Ex7.m2.12.13.2.2.2.2.2.cmml">V</mi><mo id="S2.Ex7.m2.12.13.2.2.2.2.1" xref="S2.Ex7.m2.12.13.2.2.2.2.1.cmml">^</mo></mover><mi id="S2.Ex7.m2.12.13.2.2.2.3" xref="S2.Ex7.m2.12.13.2.2.2.3.cmml">SNIPS</mi></msub></mrow><mo id="S2.Ex7.m2.12.13.2.1" xref="S2.Ex7.m2.12.13.2.1.cmml">⁢</mo><mrow id="S2.Ex7.m2.12.13.2.3.2" xref="S2.Ex7.m2.12.13.2.3.1.cmml"><mo id="S2.Ex7.m2.12.13.2.3.2.1" stretchy="false" xref="S2.Ex7.m2.12.13.2.3.1.cmml">(</mo><mi id="S2.Ex7.m2.10.10" xref="S2.Ex7.m2.10.10.cmml">π</mi><mo id="S2.Ex7.m2.12.13.2.3.2.2" xref="S2.Ex7.m2.12.13.2.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.Ex7.m2.11.11" xref="S2.Ex7.m2.11.11.cmml">𝒟</mi><mo id="S2.Ex7.m2.12.13.2.3.2.3" stretchy="false" xref="S2.Ex7.m2.12.13.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex7.m2.12.13.1" xref="S2.Ex7.m2.12.13.1.cmml">=</mo><mrow id="S2.Ex7.m2.12.13.3.2" xref="S2.Ex7.m2.12.13.3.1.cmml"><mo id="S2.Ex7.m2.12.12" xref="S2.Ex7.m2.12.12.cmml">∇</mo><mrow id="S2.Ex7.m2.12.13.3.2.1" xref="S2.Ex7.m2.12.13.3.1.cmml"><mo id="S2.Ex7.m2.12.13.3.2.1.1" xref="S2.Ex7.m2.12.13.3.1.cmml">(</mo><mstyle displaystyle="true" id="S2.Ex7.m2.9.9" xref="S2.Ex7.m2.9.9.cmml"><mfrac id="S2.Ex7.m2.9.9a" xref="S2.Ex7.m2.9.9.cmml"><mrow id="S2.Ex7.m2.5.5.5" xref="S2.Ex7.m2.5.5.5.cmml"><msub id="S2.Ex7.m2.5.5.5.6" xref="S2.Ex7.m2.5.5.5.6.cmml"><mo id="S2.Ex7.m2.5.5.5.6.2" xref="S2.Ex7.m2.5.5.5.6.2.cmml">∑</mo><mrow id="S2.Ex7.m2.3.3.3.3.3.5" xref="S2.Ex7.m2.3.3.3.3.3.4.cmml"><mo id="S2.Ex7.m2.3.3.3.3.3.5.1" stretchy="false" xref="S2.Ex7.m2.3.3.3.3.3.4.cmml">(</mo><mi id="S2.Ex7.m2.1.1.1.1.1.1" xref="S2.Ex7.m2.1.1.1.1.1.1.cmml">x</mi><mo id="S2.Ex7.m2.3.3.3.3.3.5.2" xref="S2.Ex7.m2.3.3.3.3.3.4.cmml">,</mo><mi id="S2.Ex7.m2.2.2.2.2.2.2" xref="S2.Ex7.m2.2.2.2.2.2.2.cmml">a</mi><mo id="S2.Ex7.m2.3.3.3.3.3.5.3" xref="S2.Ex7.m2.3.3.3.3.3.4.cmml">,</mo><mi id="S2.Ex7.m2.3.3.3.3.3.3" xref="S2.Ex7.m2.3.3.3.3.3.3.cmml">r</mi><mo id="S2.Ex7.m2.3.3.3.3.3.5.4" stretchy="false" xref="S2.Ex7.m2.3.3.3.3.3.4.cmml">)</mo></mrow></msub><mrow id="S2.Ex7.m2.5.5.5.7" xref="S2.Ex7.m2.5.5.5.7.cmml"><mfrac id="S2.Ex7.m2.5.5.5.5" xref="S2.Ex7.m2.5.5.5.5.cmml"><mrow id="S2.Ex7.m2.4.4.4.4.1" xref="S2.Ex7.m2.4.4.4.4.1.cmml"><mi id="S2.Ex7.m2.4.4.4.4.1.3" xref="S2.Ex7.m2.4.4.4.4.1.3.cmml">π</mi><mo id="S2.Ex7.m2.4.4.4.4.1.2" xref="S2.Ex7.m2.4.4.4.4.1.2.cmml">⁢</mo><mrow id="S2.Ex7.m2.4.4.4.4.1.1.1" xref="S2.Ex7.m2.4.4.4.4.1.1.1.1.cmml"><mo id="S2.Ex7.m2.4.4.4.4.1.1.1.2" stretchy="false" xref="S2.Ex7.m2.4.4.4.4.1.1.1.1.cmml">(</mo><mrow id="S2.Ex7.m2.4.4.4.4.1.1.1.1" xref="S2.Ex7.m2.4.4.4.4.1.1.1.1.cmml"><mi id="S2.Ex7.m2.4.4.4.4.1.1.1.1.2" xref="S2.Ex7.m2.4.4.4.4.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.Ex7.m2.4.4.4.4.1.1.1.1.1" xref="S2.Ex7.m2.4.4.4.4.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex7.m2.4.4.4.4.1.1.1.1.3" xref="S2.Ex7.m2.4.4.4.4.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex7.m2.4.4.4.4.1.1.1.3" stretchy="false" xref="S2.Ex7.m2.4.4.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.Ex7.m2.5.5.5.5.2" xref="S2.Ex7.m2.5.5.5.5.2.cmml"><msub id="S2.Ex7.m2.5.5.5.5.2.3" xref="S2.Ex7.m2.5.5.5.5.2.3.cmml"><mi id="S2.Ex7.m2.5.5.5.5.2.3.2" xref="S2.Ex7.m2.5.5.5.5.2.3.2.cmml">π</mi><mn id="S2.Ex7.m2.5.5.5.5.2.3.3" xref="S2.Ex7.m2.5.5.5.5.2.3.3.cmml">0</mn></msub><mo id="S2.Ex7.m2.5.5.5.5.2.2" xref="S2.Ex7.m2.5.5.5.5.2.2.cmml">⁢</mo><mrow id="S2.Ex7.m2.5.5.5.5.2.1.1" xref="S2.Ex7.m2.5.5.5.5.2.1.1.1.cmml"><mo id="S2.Ex7.m2.5.5.5.5.2.1.1.2" stretchy="false" xref="S2.Ex7.m2.5.5.5.5.2.1.1.1.cmml">(</mo><mrow id="S2.Ex7.m2.5.5.5.5.2.1.1.1" xref="S2.Ex7.m2.5.5.5.5.2.1.1.1.cmml"><mi id="S2.Ex7.m2.5.5.5.5.2.1.1.1.2" xref="S2.Ex7.m2.5.5.5.5.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.Ex7.m2.5.5.5.5.2.1.1.1.1" xref="S2.Ex7.m2.5.5.5.5.2.1.1.1.1.cmml">|</mo><mi id="S2.Ex7.m2.5.5.5.5.2.1.1.1.3" xref="S2.Ex7.m2.5.5.5.5.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex7.m2.5.5.5.5.2.1.1.3" stretchy="false" xref="S2.Ex7.m2.5.5.5.5.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S2.Ex7.m2.5.5.5.7.1" xref="S2.Ex7.m2.5.5.5.7.1.cmml">⁢</mo><mi id="S2.Ex7.m2.5.5.5.7.2" xref="S2.Ex7.m2.5.5.5.7.2.cmml">r</mi></mrow></mrow><mrow id="S2.Ex7.m2.9.9.9" xref="S2.Ex7.m2.9.9.9.cmml"><msub id="S2.Ex7.m2.9.9.9.5" xref="S2.Ex7.m2.9.9.9.5.cmml"><mo id="S2.Ex7.m2.9.9.9.5.2" xref="S2.Ex7.m2.9.9.9.5.2.cmml">∑</mo><mrow id="S2.Ex7.m2.7.7.7.2.2.4" xref="S2.Ex7.m2.7.7.7.2.2.3.cmml"><mo id="S2.Ex7.m2.7.7.7.2.2.4.1" stretchy="false" xref="S2.Ex7.m2.7.7.7.2.2.3.cmml">(</mo><mi id="S2.Ex7.m2.6.6.6.1.1.1" xref="S2.Ex7.m2.6.6.6.1.1.1.cmml">x</mi><mo id="S2.Ex7.m2.7.7.7.2.2.4.2" xref="S2.Ex7.m2.7.7.7.2.2.3.cmml">,</mo><mi id="S2.Ex7.m2.7.7.7.2.2.2" xref="S2.Ex7.m2.7.7.7.2.2.2.cmml">a</mi><mo id="S2.Ex7.m2.7.7.7.2.2.4.3" stretchy="false" xref="S2.Ex7.m2.7.7.7.2.2.3.cmml">)</mo></mrow></msub><mfrac id="S2.Ex7.m2.9.9.9.4" xref="S2.Ex7.m2.9.9.9.4.cmml"><mrow id="S2.Ex7.m2.8.8.8.3.1" xref="S2.Ex7.m2.8.8.8.3.1.cmml"><mi id="S2.Ex7.m2.8.8.8.3.1.3" xref="S2.Ex7.m2.8.8.8.3.1.3.cmml">π</mi><mo id="S2.Ex7.m2.8.8.8.3.1.2" xref="S2.Ex7.m2.8.8.8.3.1.2.cmml">⁢</mo><mrow id="S2.Ex7.m2.8.8.8.3.1.1.1" xref="S2.Ex7.m2.8.8.8.3.1.1.1.1.cmml"><mo id="S2.Ex7.m2.8.8.8.3.1.1.1.2" stretchy="false" xref="S2.Ex7.m2.8.8.8.3.1.1.1.1.cmml">(</mo><mrow id="S2.Ex7.m2.8.8.8.3.1.1.1.1" xref="S2.Ex7.m2.8.8.8.3.1.1.1.1.cmml"><mi id="S2.Ex7.m2.8.8.8.3.1.1.1.1.2" xref="S2.Ex7.m2.8.8.8.3.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.Ex7.m2.8.8.8.3.1.1.1.1.1" xref="S2.Ex7.m2.8.8.8.3.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex7.m2.8.8.8.3.1.1.1.1.3" xref="S2.Ex7.m2.8.8.8.3.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex7.m2.8.8.8.3.1.1.1.3" stretchy="false" xref="S2.Ex7.m2.8.8.8.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.Ex7.m2.9.9.9.4.2" xref="S2.Ex7.m2.9.9.9.4.2.cmml"><msub id="S2.Ex7.m2.9.9.9.4.2.3" xref="S2.Ex7.m2.9.9.9.4.2.3.cmml"><mi id="S2.Ex7.m2.9.9.9.4.2.3.2" xref="S2.Ex7.m2.9.9.9.4.2.3.2.cmml">π</mi><mn id="S2.Ex7.m2.9.9.9.4.2.3.3" xref="S2.Ex7.m2.9.9.9.4.2.3.3.cmml">0</mn></msub><mo id="S2.Ex7.m2.9.9.9.4.2.2" xref="S2.Ex7.m2.9.9.9.4.2.2.cmml">⁢</mo><mrow id="S2.Ex7.m2.9.9.9.4.2.1.1" xref="S2.Ex7.m2.9.9.9.4.2.1.1.1.cmml"><mo id="S2.Ex7.m2.9.9.9.4.2.1.1.2" stretchy="false" xref="S2.Ex7.m2.9.9.9.4.2.1.1.1.cmml">(</mo><mrow id="S2.Ex7.m2.9.9.9.4.2.1.1.1" xref="S2.Ex7.m2.9.9.9.4.2.1.1.1.cmml"><mi id="S2.Ex7.m2.9.9.9.4.2.1.1.1.2" xref="S2.Ex7.m2.9.9.9.4.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.Ex7.m2.9.9.9.4.2.1.1.1.1" xref="S2.Ex7.m2.9.9.9.4.2.1.1.1.1.cmml">|</mo><mi id="S2.Ex7.m2.9.9.9.4.2.1.1.1.3" xref="S2.Ex7.m2.9.9.9.4.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex7.m2.9.9.9.4.2.1.1.3" stretchy="false" xref="S2.Ex7.m2.9.9.9.4.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mfrac></mstyle><mo id="S2.Ex7.m2.12.13.3.2.1.2" xref="S2.Ex7.m2.12.13.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex7.m2.12b"><apply id="S2.Ex7.m2.12.13.cmml" xref="S2.Ex7.m2.12.13"><eq id="S2.Ex7.m2.12.13.1.cmml" xref="S2.Ex7.m2.12.13.1"></eq><apply id="S2.Ex7.m2.12.13.2.cmml" xref="S2.Ex7.m2.12.13.2"><times id="S2.Ex7.m2.12.13.2.1.cmml" xref="S2.Ex7.m2.12.13.2.1"></times><apply id="S2.Ex7.m2.12.13.2.2.cmml" xref="S2.Ex7.m2.12.13.2.2"><ci id="S2.Ex7.m2.12.13.2.2.1.cmml" xref="S2.Ex7.m2.12.13.2.2.1">∇</ci><apply id="S2.Ex7.m2.12.13.2.2.2.cmml" xref="S2.Ex7.m2.12.13.2.2.2"><csymbol cd="ambiguous" id="S2.Ex7.m2.12.13.2.2.2.1.cmml" xref="S2.Ex7.m2.12.13.2.2.2">subscript</csymbol><apply id="S2.Ex7.m2.12.13.2.2.2.2.cmml" xref="S2.Ex7.m2.12.13.2.2.2.2"><ci id="S2.Ex7.m2.12.13.2.2.2.2.1.cmml" xref="S2.Ex7.m2.12.13.2.2.2.2.1">^</ci><ci id="S2.Ex7.m2.12.13.2.2.2.2.2.cmml" xref="S2.Ex7.m2.12.13.2.2.2.2.2">𝑉</ci></apply><ci id="S2.Ex7.m2.12.13.2.2.2.3.cmml" xref="S2.Ex7.m2.12.13.2.2.2.3">SNIPS</ci></apply></apply><interval closure="open" id="S2.Ex7.m2.12.13.2.3.1.cmml" xref="S2.Ex7.m2.12.13.2.3.2"><ci id="S2.Ex7.m2.10.10.cmml" xref="S2.Ex7.m2.10.10">𝜋</ci><ci id="S2.Ex7.m2.11.11.cmml" xref="S2.Ex7.m2.11.11">𝒟</ci></interval></apply><apply id="S2.Ex7.m2.12.13.3.1.cmml" xref="S2.Ex7.m2.12.13.3.2"><ci id="S2.Ex7.m2.12.12.cmml" xref="S2.Ex7.m2.12.12">∇</ci><apply id="S2.Ex7.m2.9.9.cmml" xref="S2.Ex7.m2.9.9"><divide id="S2.Ex7.m2.9.9.10.cmml" xref="S2.Ex7.m2.9.9"></divide><apply id="S2.Ex7.m2.5.5.5.cmml" xref="S2.Ex7.m2.5.5.5"><apply id="S2.Ex7.m2.5.5.5.6.cmml" xref="S2.Ex7.m2.5.5.5.6"><csymbol cd="ambiguous" id="S2.Ex7.m2.5.5.5.6.1.cmml" xref="S2.Ex7.m2.5.5.5.6">subscript</csymbol><sum id="S2.Ex7.m2.5.5.5.6.2.cmml" xref="S2.Ex7.m2.5.5.5.6.2"></sum><vector id="S2.Ex7.m2.3.3.3.3.3.4.cmml" xref="S2.Ex7.m2.3.3.3.3.3.5"><ci id="S2.Ex7.m2.1.1.1.1.1.1.cmml" xref="S2.Ex7.m2.1.1.1.1.1.1">𝑥</ci><ci id="S2.Ex7.m2.2.2.2.2.2.2.cmml" xref="S2.Ex7.m2.2.2.2.2.2.2">𝑎</ci><ci id="S2.Ex7.m2.3.3.3.3.3.3.cmml" xref="S2.Ex7.m2.3.3.3.3.3.3">𝑟</ci></vector></apply><apply id="S2.Ex7.m2.5.5.5.7.cmml" xref="S2.Ex7.m2.5.5.5.7"><times id="S2.Ex7.m2.5.5.5.7.1.cmml" xref="S2.Ex7.m2.5.5.5.7.1"></times><apply id="S2.Ex7.m2.5.5.5.5.cmml" xref="S2.Ex7.m2.5.5.5.5"><divide id="S2.Ex7.m2.5.5.5.5.3.cmml" xref="S2.Ex7.m2.5.5.5.5"></divide><apply id="S2.Ex7.m2.4.4.4.4.1.cmml" xref="S2.Ex7.m2.4.4.4.4.1"><times id="S2.Ex7.m2.4.4.4.4.1.2.cmml" xref="S2.Ex7.m2.4.4.4.4.1.2"></times><ci id="S2.Ex7.m2.4.4.4.4.1.3.cmml" xref="S2.Ex7.m2.4.4.4.4.1.3">𝜋</ci><apply id="S2.Ex7.m2.4.4.4.4.1.1.1.1.cmml" xref="S2.Ex7.m2.4.4.4.4.1.1.1"><csymbol cd="latexml" id="S2.Ex7.m2.4.4.4.4.1.1.1.1.1.cmml" xref="S2.Ex7.m2.4.4.4.4.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex7.m2.4.4.4.4.1.1.1.1.2.cmml" xref="S2.Ex7.m2.4.4.4.4.1.1.1.1.2">𝑎</ci><ci id="S2.Ex7.m2.4.4.4.4.1.1.1.1.3.cmml" xref="S2.Ex7.m2.4.4.4.4.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.Ex7.m2.5.5.5.5.2.cmml" xref="S2.Ex7.m2.5.5.5.5.2"><times id="S2.Ex7.m2.5.5.5.5.2.2.cmml" xref="S2.Ex7.m2.5.5.5.5.2.2"></times><apply id="S2.Ex7.m2.5.5.5.5.2.3.cmml" xref="S2.Ex7.m2.5.5.5.5.2.3"><csymbol cd="ambiguous" id="S2.Ex7.m2.5.5.5.5.2.3.1.cmml" xref="S2.Ex7.m2.5.5.5.5.2.3">subscript</csymbol><ci id="S2.Ex7.m2.5.5.5.5.2.3.2.cmml" xref="S2.Ex7.m2.5.5.5.5.2.3.2">𝜋</ci><cn id="S2.Ex7.m2.5.5.5.5.2.3.3.cmml" type="integer" xref="S2.Ex7.m2.5.5.5.5.2.3.3">0</cn></apply><apply id="S2.Ex7.m2.5.5.5.5.2.1.1.1.cmml" xref="S2.Ex7.m2.5.5.5.5.2.1.1"><csymbol cd="latexml" id="S2.Ex7.m2.5.5.5.5.2.1.1.1.1.cmml" xref="S2.Ex7.m2.5.5.5.5.2.1.1.1.1">conditional</csymbol><ci id="S2.Ex7.m2.5.5.5.5.2.1.1.1.2.cmml" xref="S2.Ex7.m2.5.5.5.5.2.1.1.1.2">𝑎</ci><ci id="S2.Ex7.m2.5.5.5.5.2.1.1.1.3.cmml" xref="S2.Ex7.m2.5.5.5.5.2.1.1.1.3">𝑥</ci></apply></apply></apply><ci id="S2.Ex7.m2.5.5.5.7.2.cmml" xref="S2.Ex7.m2.5.5.5.7.2">𝑟</ci></apply></apply><apply id="S2.Ex7.m2.9.9.9.cmml" xref="S2.Ex7.m2.9.9.9"><apply id="S2.Ex7.m2.9.9.9.5.cmml" xref="S2.Ex7.m2.9.9.9.5"><csymbol cd="ambiguous" id="S2.Ex7.m2.9.9.9.5.1.cmml" xref="S2.Ex7.m2.9.9.9.5">subscript</csymbol><sum id="S2.Ex7.m2.9.9.9.5.2.cmml" xref="S2.Ex7.m2.9.9.9.5.2"></sum><interval closure="open" id="S2.Ex7.m2.7.7.7.2.2.3.cmml" xref="S2.Ex7.m2.7.7.7.2.2.4"><ci id="S2.Ex7.m2.6.6.6.1.1.1.cmml" xref="S2.Ex7.m2.6.6.6.1.1.1">𝑥</ci><ci id="S2.Ex7.m2.7.7.7.2.2.2.cmml" xref="S2.Ex7.m2.7.7.7.2.2.2">𝑎</ci></interval></apply><apply id="S2.Ex7.m2.9.9.9.4.cmml" xref="S2.Ex7.m2.9.9.9.4"><divide id="S2.Ex7.m2.9.9.9.4.3.cmml" xref="S2.Ex7.m2.9.9.9.4"></divide><apply id="S2.Ex7.m2.8.8.8.3.1.cmml" xref="S2.Ex7.m2.8.8.8.3.1"><times id="S2.Ex7.m2.8.8.8.3.1.2.cmml" xref="S2.Ex7.m2.8.8.8.3.1.2"></times><ci id="S2.Ex7.m2.8.8.8.3.1.3.cmml" xref="S2.Ex7.m2.8.8.8.3.1.3">𝜋</ci><apply id="S2.Ex7.m2.8.8.8.3.1.1.1.1.cmml" xref="S2.Ex7.m2.8.8.8.3.1.1.1"><csymbol cd="latexml" id="S2.Ex7.m2.8.8.8.3.1.1.1.1.1.cmml" xref="S2.Ex7.m2.8.8.8.3.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex7.m2.8.8.8.3.1.1.1.1.2.cmml" xref="S2.Ex7.m2.8.8.8.3.1.1.1.1.2">𝑎</ci><ci id="S2.Ex7.m2.8.8.8.3.1.1.1.1.3.cmml" xref="S2.Ex7.m2.8.8.8.3.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.Ex7.m2.9.9.9.4.2.cmml" xref="S2.Ex7.m2.9.9.9.4.2"><times id="S2.Ex7.m2.9.9.9.4.2.2.cmml" xref="S2.Ex7.m2.9.9.9.4.2.2"></times><apply id="S2.Ex7.m2.9.9.9.4.2.3.cmml" xref="S2.Ex7.m2.9.9.9.4.2.3"><csymbol cd="ambiguous" id="S2.Ex7.m2.9.9.9.4.2.3.1.cmml" xref="S2.Ex7.m2.9.9.9.4.2.3">subscript</csymbol><ci id="S2.Ex7.m2.9.9.9.4.2.3.2.cmml" xref="S2.Ex7.m2.9.9.9.4.2.3.2">𝜋</ci><cn id="S2.Ex7.m2.9.9.9.4.2.3.3.cmml" type="integer" xref="S2.Ex7.m2.9.9.9.4.2.3.3">0</cn></apply><apply id="S2.Ex7.m2.9.9.9.4.2.1.1.1.cmml" xref="S2.Ex7.m2.9.9.9.4.2.1.1"><csymbol cd="latexml" id="S2.Ex7.m2.9.9.9.4.2.1.1.1.1.cmml" xref="S2.Ex7.m2.9.9.9.4.2.1.1.1.1">conditional</csymbol><ci id="S2.Ex7.m2.9.9.9.4.2.1.1.1.2.cmml" xref="S2.Ex7.m2.9.9.9.4.2.1.1.1.2">𝑎</ci><ci id="S2.Ex7.m2.9.9.9.4.2.1.1.1.3.cmml" xref="S2.Ex7.m2.9.9.9.4.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex7.m2.12c">\displaystyle\nabla\widehat{V}_{\rm SNIPS}(\pi,\mathcal{D})=\nabla\left(\frac{%
\sum_{(x,a,r)}\frac{\pi(a|x)}{\pi_{0}(a|x)}r}{\sum_{(x,a)}\frac{\pi(a|x)}{\pi_%
{0}(a|x)}}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.Ex7.m2.12d">∇ over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_SNIPS end_POSTSUBSCRIPT ( italic_π , caligraphic_D ) = ∇ ( divide start_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) end_POSTSUBSCRIPT divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG italic_r end_ARG start_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a ) end_POSTSUBSCRIPT divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\qquad\qquad\qquad=\frac{\left(\sum_{(x,a,r)}\frac{\nabla\pi(a|x)%
}{\pi_{0}(a|x)}r\right)\left(\sum_{(x,a)}\frac{\pi(a|x)}{\pi_{0}(a|x)}\right)}%
{\left({\sum_{(x,a)}\frac{\pi(a|x)}{\pi_{0}(a|x)}}\right)^{2}}" class="ltx_Math" display="inline" id="S2.Ex8.m1.16"><semantics id="S2.Ex8.m1.16a"><mrow id="S2.Ex8.m1.16.17" xref="S2.Ex8.m1.16.17.cmml"><mi id="S2.Ex8.m1.16.17.2" xref="S2.Ex8.m1.16.17.2.cmml"></mi><mo id="S2.Ex8.m1.16.17.1" lspace="6.278em" xref="S2.Ex8.m1.16.17.1.cmml">=</mo><mstyle displaystyle="true" id="S2.Ex8.m1.16.16" xref="S2.Ex8.m1.16.16.cmml"><mfrac id="S2.Ex8.m1.16.16a" xref="S2.Ex8.m1.16.16.cmml"><mrow id="S2.Ex8.m1.11.11.11" xref="S2.Ex8.m1.11.11.11.cmml"><mrow id="S2.Ex8.m1.10.10.10.10.1" xref="S2.Ex8.m1.10.10.10.10.1.1.cmml"><mo id="S2.Ex8.m1.10.10.10.10.1.2" xref="S2.Ex8.m1.10.10.10.10.1.1.cmml">(</mo><mrow id="S2.Ex8.m1.10.10.10.10.1.1" xref="S2.Ex8.m1.10.10.10.10.1.1.cmml"><msub id="S2.Ex8.m1.10.10.10.10.1.1.1" xref="S2.Ex8.m1.10.10.10.10.1.1.1.cmml"><mo id="S2.Ex8.m1.10.10.10.10.1.1.1.2" lspace="0em" xref="S2.Ex8.m1.10.10.10.10.1.1.1.2.cmml">∑</mo><mrow id="S2.Ex8.m1.3.3.3.3.3.5" xref="S2.Ex8.m1.3.3.3.3.3.4.cmml"><mo id="S2.Ex8.m1.3.3.3.3.3.5.1" stretchy="false" xref="S2.Ex8.m1.3.3.3.3.3.4.cmml">(</mo><mi id="S2.Ex8.m1.1.1.1.1.1.1" xref="S2.Ex8.m1.1.1.1.1.1.1.cmml">x</mi><mo id="S2.Ex8.m1.3.3.3.3.3.5.2" xref="S2.Ex8.m1.3.3.3.3.3.4.cmml">,</mo><mi id="S2.Ex8.m1.2.2.2.2.2.2" xref="S2.Ex8.m1.2.2.2.2.2.2.cmml">a</mi><mo id="S2.Ex8.m1.3.3.3.3.3.5.3" xref="S2.Ex8.m1.3.3.3.3.3.4.cmml">,</mo><mi id="S2.Ex8.m1.3.3.3.3.3.3" xref="S2.Ex8.m1.3.3.3.3.3.3.cmml">r</mi><mo id="S2.Ex8.m1.3.3.3.3.3.5.4" stretchy="false" xref="S2.Ex8.m1.3.3.3.3.3.4.cmml">)</mo></mrow></msub><mrow id="S2.Ex8.m1.10.10.10.10.1.1.2" xref="S2.Ex8.m1.10.10.10.10.1.1.2.cmml"><mfrac id="S2.Ex8.m1.5.5.5.5" xref="S2.Ex8.m1.5.5.5.5.cmml"><mrow id="S2.Ex8.m1.4.4.4.4.1" xref="S2.Ex8.m1.4.4.4.4.1.cmml"><mrow id="S2.Ex8.m1.4.4.4.4.1.3" xref="S2.Ex8.m1.4.4.4.4.1.3.cmml"><mo id="S2.Ex8.m1.4.4.4.4.1.3.1" rspace="0.167em" xref="S2.Ex8.m1.4.4.4.4.1.3.1.cmml">∇</mo><mi id="S2.Ex8.m1.4.4.4.4.1.3.2" xref="S2.Ex8.m1.4.4.4.4.1.3.2.cmml">π</mi></mrow><mo id="S2.Ex8.m1.4.4.4.4.1.2" xref="S2.Ex8.m1.4.4.4.4.1.2.cmml">⁢</mo><mrow id="S2.Ex8.m1.4.4.4.4.1.1.1" xref="S2.Ex8.m1.4.4.4.4.1.1.1.1.cmml"><mo id="S2.Ex8.m1.4.4.4.4.1.1.1.2" stretchy="false" xref="S2.Ex8.m1.4.4.4.4.1.1.1.1.cmml">(</mo><mrow id="S2.Ex8.m1.4.4.4.4.1.1.1.1" xref="S2.Ex8.m1.4.4.4.4.1.1.1.1.cmml"><mi id="S2.Ex8.m1.4.4.4.4.1.1.1.1.2" xref="S2.Ex8.m1.4.4.4.4.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.Ex8.m1.4.4.4.4.1.1.1.1.1" xref="S2.Ex8.m1.4.4.4.4.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex8.m1.4.4.4.4.1.1.1.1.3" xref="S2.Ex8.m1.4.4.4.4.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex8.m1.4.4.4.4.1.1.1.3" stretchy="false" xref="S2.Ex8.m1.4.4.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.Ex8.m1.5.5.5.5.2" xref="S2.Ex8.m1.5.5.5.5.2.cmml"><msub id="S2.Ex8.m1.5.5.5.5.2.3" xref="S2.Ex8.m1.5.5.5.5.2.3.cmml"><mi id="S2.Ex8.m1.5.5.5.5.2.3.2" xref="S2.Ex8.m1.5.5.5.5.2.3.2.cmml">π</mi><mn id="S2.Ex8.m1.5.5.5.5.2.3.3" xref="S2.Ex8.m1.5.5.5.5.2.3.3.cmml">0</mn></msub><mo id="S2.Ex8.m1.5.5.5.5.2.2" xref="S2.Ex8.m1.5.5.5.5.2.2.cmml">⁢</mo><mrow id="S2.Ex8.m1.5.5.5.5.2.1.1" xref="S2.Ex8.m1.5.5.5.5.2.1.1.1.cmml"><mo id="S2.Ex8.m1.5.5.5.5.2.1.1.2" stretchy="false" xref="S2.Ex8.m1.5.5.5.5.2.1.1.1.cmml">(</mo><mrow id="S2.Ex8.m1.5.5.5.5.2.1.1.1" xref="S2.Ex8.m1.5.5.5.5.2.1.1.1.cmml"><mi id="S2.Ex8.m1.5.5.5.5.2.1.1.1.2" xref="S2.Ex8.m1.5.5.5.5.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.Ex8.m1.5.5.5.5.2.1.1.1.1" xref="S2.Ex8.m1.5.5.5.5.2.1.1.1.1.cmml">|</mo><mi id="S2.Ex8.m1.5.5.5.5.2.1.1.1.3" xref="S2.Ex8.m1.5.5.5.5.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex8.m1.5.5.5.5.2.1.1.3" stretchy="false" xref="S2.Ex8.m1.5.5.5.5.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S2.Ex8.m1.10.10.10.10.1.1.2.1" xref="S2.Ex8.m1.10.10.10.10.1.1.2.1.cmml">⁢</mo><mi id="S2.Ex8.m1.10.10.10.10.1.1.2.2" xref="S2.Ex8.m1.10.10.10.10.1.1.2.2.cmml">r</mi></mrow></mrow><mo id="S2.Ex8.m1.10.10.10.10.1.3" xref="S2.Ex8.m1.10.10.10.10.1.1.cmml">)</mo></mrow><mo id="S2.Ex8.m1.11.11.11.12" xref="S2.Ex8.m1.11.11.11.12.cmml">⁢</mo><mrow id="S2.Ex8.m1.11.11.11.11.1" xref="S2.Ex8.m1.11.11.11.11.1.1.cmml"><mo id="S2.Ex8.m1.11.11.11.11.1.2" xref="S2.Ex8.m1.11.11.11.11.1.1.cmml">(</mo><mrow id="S2.Ex8.m1.11.11.11.11.1.1" xref="S2.Ex8.m1.11.11.11.11.1.1.cmml"><msub id="S2.Ex8.m1.11.11.11.11.1.1.1" xref="S2.Ex8.m1.11.11.11.11.1.1.1.cmml"><mo id="S2.Ex8.m1.11.11.11.11.1.1.1.2" lspace="0em" xref="S2.Ex8.m1.11.11.11.11.1.1.1.2.cmml">∑</mo><mrow id="S2.Ex8.m1.7.7.7.7.2.4" xref="S2.Ex8.m1.7.7.7.7.2.3.cmml"><mo id="S2.Ex8.m1.7.7.7.7.2.4.1" stretchy="false" xref="S2.Ex8.m1.7.7.7.7.2.3.cmml">(</mo><mi id="S2.Ex8.m1.6.6.6.6.1.1" xref="S2.Ex8.m1.6.6.6.6.1.1.cmml">x</mi><mo id="S2.Ex8.m1.7.7.7.7.2.4.2" xref="S2.Ex8.m1.7.7.7.7.2.3.cmml">,</mo><mi id="S2.Ex8.m1.7.7.7.7.2.2" xref="S2.Ex8.m1.7.7.7.7.2.2.cmml">a</mi><mo id="S2.Ex8.m1.7.7.7.7.2.4.3" stretchy="false" xref="S2.Ex8.m1.7.7.7.7.2.3.cmml">)</mo></mrow></msub><mfrac id="S2.Ex8.m1.9.9.9.9" xref="S2.Ex8.m1.9.9.9.9.cmml"><mrow id="S2.Ex8.m1.8.8.8.8.1" xref="S2.Ex8.m1.8.8.8.8.1.cmml"><mi id="S2.Ex8.m1.8.8.8.8.1.3" xref="S2.Ex8.m1.8.8.8.8.1.3.cmml">π</mi><mo id="S2.Ex8.m1.8.8.8.8.1.2" xref="S2.Ex8.m1.8.8.8.8.1.2.cmml">⁢</mo><mrow id="S2.Ex8.m1.8.8.8.8.1.1.1" xref="S2.Ex8.m1.8.8.8.8.1.1.1.1.cmml"><mo id="S2.Ex8.m1.8.8.8.8.1.1.1.2" stretchy="false" xref="S2.Ex8.m1.8.8.8.8.1.1.1.1.cmml">(</mo><mrow id="S2.Ex8.m1.8.8.8.8.1.1.1.1" xref="S2.Ex8.m1.8.8.8.8.1.1.1.1.cmml"><mi id="S2.Ex8.m1.8.8.8.8.1.1.1.1.2" xref="S2.Ex8.m1.8.8.8.8.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.Ex8.m1.8.8.8.8.1.1.1.1.1" xref="S2.Ex8.m1.8.8.8.8.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex8.m1.8.8.8.8.1.1.1.1.3" xref="S2.Ex8.m1.8.8.8.8.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex8.m1.8.8.8.8.1.1.1.3" stretchy="false" xref="S2.Ex8.m1.8.8.8.8.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.Ex8.m1.9.9.9.9.2" xref="S2.Ex8.m1.9.9.9.9.2.cmml"><msub id="S2.Ex8.m1.9.9.9.9.2.3" xref="S2.Ex8.m1.9.9.9.9.2.3.cmml"><mi id="S2.Ex8.m1.9.9.9.9.2.3.2" xref="S2.Ex8.m1.9.9.9.9.2.3.2.cmml">π</mi><mn id="S2.Ex8.m1.9.9.9.9.2.3.3" xref="S2.Ex8.m1.9.9.9.9.2.3.3.cmml">0</mn></msub><mo id="S2.Ex8.m1.9.9.9.9.2.2" xref="S2.Ex8.m1.9.9.9.9.2.2.cmml">⁢</mo><mrow id="S2.Ex8.m1.9.9.9.9.2.1.1" xref="S2.Ex8.m1.9.9.9.9.2.1.1.1.cmml"><mo id="S2.Ex8.m1.9.9.9.9.2.1.1.2" stretchy="false" xref="S2.Ex8.m1.9.9.9.9.2.1.1.1.cmml">(</mo><mrow id="S2.Ex8.m1.9.9.9.9.2.1.1.1" xref="S2.Ex8.m1.9.9.9.9.2.1.1.1.cmml"><mi id="S2.Ex8.m1.9.9.9.9.2.1.1.1.2" xref="S2.Ex8.m1.9.9.9.9.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.Ex8.m1.9.9.9.9.2.1.1.1.1" xref="S2.Ex8.m1.9.9.9.9.2.1.1.1.1.cmml">|</mo><mi id="S2.Ex8.m1.9.9.9.9.2.1.1.1.3" xref="S2.Ex8.m1.9.9.9.9.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex8.m1.9.9.9.9.2.1.1.3" stretchy="false" xref="S2.Ex8.m1.9.9.9.9.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S2.Ex8.m1.11.11.11.11.1.3" xref="S2.Ex8.m1.11.11.11.11.1.1.cmml">)</mo></mrow></mrow><msup id="S2.Ex8.m1.16.16.16" xref="S2.Ex8.m1.16.16.16.cmml"><mrow id="S2.Ex8.m1.16.16.16.5.1" xref="S2.Ex8.m1.16.16.16.5.1.1.cmml"><mo id="S2.Ex8.m1.16.16.16.5.1.2" xref="S2.Ex8.m1.16.16.16.5.1.1.cmml">(</mo><mrow id="S2.Ex8.m1.16.16.16.5.1.1" xref="S2.Ex8.m1.16.16.16.5.1.1.cmml"><msub id="S2.Ex8.m1.16.16.16.5.1.1.1" xref="S2.Ex8.m1.16.16.16.5.1.1.1.cmml"><mo id="S2.Ex8.m1.16.16.16.5.1.1.1.2" lspace="0em" xref="S2.Ex8.m1.16.16.16.5.1.1.1.2.cmml">∑</mo><mrow id="S2.Ex8.m1.13.13.13.2.2.4" xref="S2.Ex8.m1.13.13.13.2.2.3.cmml"><mo id="S2.Ex8.m1.13.13.13.2.2.4.1" stretchy="false" xref="S2.Ex8.m1.13.13.13.2.2.3.cmml">(</mo><mi id="S2.Ex8.m1.12.12.12.1.1.1" xref="S2.Ex8.m1.12.12.12.1.1.1.cmml">x</mi><mo id="S2.Ex8.m1.13.13.13.2.2.4.2" xref="S2.Ex8.m1.13.13.13.2.2.3.cmml">,</mo><mi id="S2.Ex8.m1.13.13.13.2.2.2" xref="S2.Ex8.m1.13.13.13.2.2.2.cmml">a</mi><mo id="S2.Ex8.m1.13.13.13.2.2.4.3" stretchy="false" xref="S2.Ex8.m1.13.13.13.2.2.3.cmml">)</mo></mrow></msub><mfrac id="S2.Ex8.m1.15.15.15.4" xref="S2.Ex8.m1.15.15.15.4.cmml"><mrow id="S2.Ex8.m1.14.14.14.3.1" xref="S2.Ex8.m1.14.14.14.3.1.cmml"><mi id="S2.Ex8.m1.14.14.14.3.1.3" xref="S2.Ex8.m1.14.14.14.3.1.3.cmml">π</mi><mo id="S2.Ex8.m1.14.14.14.3.1.2" xref="S2.Ex8.m1.14.14.14.3.1.2.cmml">⁢</mo><mrow id="S2.Ex8.m1.14.14.14.3.1.1.1" xref="S2.Ex8.m1.14.14.14.3.1.1.1.1.cmml"><mo id="S2.Ex8.m1.14.14.14.3.1.1.1.2" stretchy="false" xref="S2.Ex8.m1.14.14.14.3.1.1.1.1.cmml">(</mo><mrow id="S2.Ex8.m1.14.14.14.3.1.1.1.1" xref="S2.Ex8.m1.14.14.14.3.1.1.1.1.cmml"><mi id="S2.Ex8.m1.14.14.14.3.1.1.1.1.2" xref="S2.Ex8.m1.14.14.14.3.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.Ex8.m1.14.14.14.3.1.1.1.1.1" xref="S2.Ex8.m1.14.14.14.3.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex8.m1.14.14.14.3.1.1.1.1.3" xref="S2.Ex8.m1.14.14.14.3.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex8.m1.14.14.14.3.1.1.1.3" stretchy="false" xref="S2.Ex8.m1.14.14.14.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.Ex8.m1.15.15.15.4.2" xref="S2.Ex8.m1.15.15.15.4.2.cmml"><msub id="S2.Ex8.m1.15.15.15.4.2.3" xref="S2.Ex8.m1.15.15.15.4.2.3.cmml"><mi id="S2.Ex8.m1.15.15.15.4.2.3.2" xref="S2.Ex8.m1.15.15.15.4.2.3.2.cmml">π</mi><mn id="S2.Ex8.m1.15.15.15.4.2.3.3" xref="S2.Ex8.m1.15.15.15.4.2.3.3.cmml">0</mn></msub><mo id="S2.Ex8.m1.15.15.15.4.2.2" xref="S2.Ex8.m1.15.15.15.4.2.2.cmml">⁢</mo><mrow id="S2.Ex8.m1.15.15.15.4.2.1.1" xref="S2.Ex8.m1.15.15.15.4.2.1.1.1.cmml"><mo id="S2.Ex8.m1.15.15.15.4.2.1.1.2" stretchy="false" xref="S2.Ex8.m1.15.15.15.4.2.1.1.1.cmml">(</mo><mrow id="S2.Ex8.m1.15.15.15.4.2.1.1.1" xref="S2.Ex8.m1.15.15.15.4.2.1.1.1.cmml"><mi id="S2.Ex8.m1.15.15.15.4.2.1.1.1.2" xref="S2.Ex8.m1.15.15.15.4.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.Ex8.m1.15.15.15.4.2.1.1.1.1" xref="S2.Ex8.m1.15.15.15.4.2.1.1.1.1.cmml">|</mo><mi id="S2.Ex8.m1.15.15.15.4.2.1.1.1.3" xref="S2.Ex8.m1.15.15.15.4.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex8.m1.15.15.15.4.2.1.1.3" stretchy="false" xref="S2.Ex8.m1.15.15.15.4.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S2.Ex8.m1.16.16.16.5.1.3" xref="S2.Ex8.m1.16.16.16.5.1.1.cmml">)</mo></mrow><mn id="S2.Ex8.m1.16.16.16.7" xref="S2.Ex8.m1.16.16.16.7.cmml">2</mn></msup></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex8.m1.16b"><apply id="S2.Ex8.m1.16.17.cmml" xref="S2.Ex8.m1.16.17"><eq id="S2.Ex8.m1.16.17.1.cmml" xref="S2.Ex8.m1.16.17.1"></eq><csymbol cd="latexml" id="S2.Ex8.m1.16.17.2.cmml" xref="S2.Ex8.m1.16.17.2">absent</csymbol><apply id="S2.Ex8.m1.16.16.cmml" xref="S2.Ex8.m1.16.16"><divide id="S2.Ex8.m1.16.16.17.cmml" xref="S2.Ex8.m1.16.16"></divide><apply id="S2.Ex8.m1.11.11.11.cmml" xref="S2.Ex8.m1.11.11.11"><times id="S2.Ex8.m1.11.11.11.12.cmml" xref="S2.Ex8.m1.11.11.11.12"></times><apply id="S2.Ex8.m1.10.10.10.10.1.1.cmml" xref="S2.Ex8.m1.10.10.10.10.1"><apply id="S2.Ex8.m1.10.10.10.10.1.1.1.cmml" xref="S2.Ex8.m1.10.10.10.10.1.1.1"><csymbol cd="ambiguous" id="S2.Ex8.m1.10.10.10.10.1.1.1.1.cmml" xref="S2.Ex8.m1.10.10.10.10.1.1.1">subscript</csymbol><sum id="S2.Ex8.m1.10.10.10.10.1.1.1.2.cmml" xref="S2.Ex8.m1.10.10.10.10.1.1.1.2"></sum><vector id="S2.Ex8.m1.3.3.3.3.3.4.cmml" xref="S2.Ex8.m1.3.3.3.3.3.5"><ci id="S2.Ex8.m1.1.1.1.1.1.1.cmml" xref="S2.Ex8.m1.1.1.1.1.1.1">𝑥</ci><ci id="S2.Ex8.m1.2.2.2.2.2.2.cmml" xref="S2.Ex8.m1.2.2.2.2.2.2">𝑎</ci><ci id="S2.Ex8.m1.3.3.3.3.3.3.cmml" xref="S2.Ex8.m1.3.3.3.3.3.3">𝑟</ci></vector></apply><apply id="S2.Ex8.m1.10.10.10.10.1.1.2.cmml" xref="S2.Ex8.m1.10.10.10.10.1.1.2"><times id="S2.Ex8.m1.10.10.10.10.1.1.2.1.cmml" xref="S2.Ex8.m1.10.10.10.10.1.1.2.1"></times><apply id="S2.Ex8.m1.5.5.5.5.cmml" xref="S2.Ex8.m1.5.5.5.5"><divide id="S2.Ex8.m1.5.5.5.5.3.cmml" xref="S2.Ex8.m1.5.5.5.5"></divide><apply id="S2.Ex8.m1.4.4.4.4.1.cmml" xref="S2.Ex8.m1.4.4.4.4.1"><times id="S2.Ex8.m1.4.4.4.4.1.2.cmml" xref="S2.Ex8.m1.4.4.4.4.1.2"></times><apply id="S2.Ex8.m1.4.4.4.4.1.3.cmml" xref="S2.Ex8.m1.4.4.4.4.1.3"><ci id="S2.Ex8.m1.4.4.4.4.1.3.1.cmml" xref="S2.Ex8.m1.4.4.4.4.1.3.1">∇</ci><ci id="S2.Ex8.m1.4.4.4.4.1.3.2.cmml" xref="S2.Ex8.m1.4.4.4.4.1.3.2">𝜋</ci></apply><apply id="S2.Ex8.m1.4.4.4.4.1.1.1.1.cmml" xref="S2.Ex8.m1.4.4.4.4.1.1.1"><csymbol cd="latexml" id="S2.Ex8.m1.4.4.4.4.1.1.1.1.1.cmml" xref="S2.Ex8.m1.4.4.4.4.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex8.m1.4.4.4.4.1.1.1.1.2.cmml" xref="S2.Ex8.m1.4.4.4.4.1.1.1.1.2">𝑎</ci><ci id="S2.Ex8.m1.4.4.4.4.1.1.1.1.3.cmml" xref="S2.Ex8.m1.4.4.4.4.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.Ex8.m1.5.5.5.5.2.cmml" xref="S2.Ex8.m1.5.5.5.5.2"><times id="S2.Ex8.m1.5.5.5.5.2.2.cmml" xref="S2.Ex8.m1.5.5.5.5.2.2"></times><apply id="S2.Ex8.m1.5.5.5.5.2.3.cmml" xref="S2.Ex8.m1.5.5.5.5.2.3"><csymbol cd="ambiguous" id="S2.Ex8.m1.5.5.5.5.2.3.1.cmml" xref="S2.Ex8.m1.5.5.5.5.2.3">subscript</csymbol><ci id="S2.Ex8.m1.5.5.5.5.2.3.2.cmml" xref="S2.Ex8.m1.5.5.5.5.2.3.2">𝜋</ci><cn id="S2.Ex8.m1.5.5.5.5.2.3.3.cmml" type="integer" xref="S2.Ex8.m1.5.5.5.5.2.3.3">0</cn></apply><apply id="S2.Ex8.m1.5.5.5.5.2.1.1.1.cmml" xref="S2.Ex8.m1.5.5.5.5.2.1.1"><csymbol cd="latexml" id="S2.Ex8.m1.5.5.5.5.2.1.1.1.1.cmml" xref="S2.Ex8.m1.5.5.5.5.2.1.1.1.1">conditional</csymbol><ci id="S2.Ex8.m1.5.5.5.5.2.1.1.1.2.cmml" xref="S2.Ex8.m1.5.5.5.5.2.1.1.1.2">𝑎</ci><ci id="S2.Ex8.m1.5.5.5.5.2.1.1.1.3.cmml" xref="S2.Ex8.m1.5.5.5.5.2.1.1.1.3">𝑥</ci></apply></apply></apply><ci id="S2.Ex8.m1.10.10.10.10.1.1.2.2.cmml" xref="S2.Ex8.m1.10.10.10.10.1.1.2.2">𝑟</ci></apply></apply><apply id="S2.Ex8.m1.11.11.11.11.1.1.cmml" xref="S2.Ex8.m1.11.11.11.11.1"><apply id="S2.Ex8.m1.11.11.11.11.1.1.1.cmml" xref="S2.Ex8.m1.11.11.11.11.1.1.1"><csymbol cd="ambiguous" id="S2.Ex8.m1.11.11.11.11.1.1.1.1.cmml" xref="S2.Ex8.m1.11.11.11.11.1.1.1">subscript</csymbol><sum id="S2.Ex8.m1.11.11.11.11.1.1.1.2.cmml" xref="S2.Ex8.m1.11.11.11.11.1.1.1.2"></sum><interval closure="open" id="S2.Ex8.m1.7.7.7.7.2.3.cmml" xref="S2.Ex8.m1.7.7.7.7.2.4"><ci id="S2.Ex8.m1.6.6.6.6.1.1.cmml" xref="S2.Ex8.m1.6.6.6.6.1.1">𝑥</ci><ci id="S2.Ex8.m1.7.7.7.7.2.2.cmml" xref="S2.Ex8.m1.7.7.7.7.2.2">𝑎</ci></interval></apply><apply id="S2.Ex8.m1.9.9.9.9.cmml" xref="S2.Ex8.m1.9.9.9.9"><divide id="S2.Ex8.m1.9.9.9.9.3.cmml" xref="S2.Ex8.m1.9.9.9.9"></divide><apply id="S2.Ex8.m1.8.8.8.8.1.cmml" xref="S2.Ex8.m1.8.8.8.8.1"><times id="S2.Ex8.m1.8.8.8.8.1.2.cmml" xref="S2.Ex8.m1.8.8.8.8.1.2"></times><ci id="S2.Ex8.m1.8.8.8.8.1.3.cmml" xref="S2.Ex8.m1.8.8.8.8.1.3">𝜋</ci><apply id="S2.Ex8.m1.8.8.8.8.1.1.1.1.cmml" xref="S2.Ex8.m1.8.8.8.8.1.1.1"><csymbol cd="latexml" id="S2.Ex8.m1.8.8.8.8.1.1.1.1.1.cmml" xref="S2.Ex8.m1.8.8.8.8.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex8.m1.8.8.8.8.1.1.1.1.2.cmml" xref="S2.Ex8.m1.8.8.8.8.1.1.1.1.2">𝑎</ci><ci id="S2.Ex8.m1.8.8.8.8.1.1.1.1.3.cmml" xref="S2.Ex8.m1.8.8.8.8.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.Ex8.m1.9.9.9.9.2.cmml" xref="S2.Ex8.m1.9.9.9.9.2"><times id="S2.Ex8.m1.9.9.9.9.2.2.cmml" xref="S2.Ex8.m1.9.9.9.9.2.2"></times><apply id="S2.Ex8.m1.9.9.9.9.2.3.cmml" xref="S2.Ex8.m1.9.9.9.9.2.3"><csymbol cd="ambiguous" id="S2.Ex8.m1.9.9.9.9.2.3.1.cmml" xref="S2.Ex8.m1.9.9.9.9.2.3">subscript</csymbol><ci id="S2.Ex8.m1.9.9.9.9.2.3.2.cmml" xref="S2.Ex8.m1.9.9.9.9.2.3.2">𝜋</ci><cn id="S2.Ex8.m1.9.9.9.9.2.3.3.cmml" type="integer" xref="S2.Ex8.m1.9.9.9.9.2.3.3">0</cn></apply><apply id="S2.Ex8.m1.9.9.9.9.2.1.1.1.cmml" xref="S2.Ex8.m1.9.9.9.9.2.1.1"><csymbol cd="latexml" id="S2.Ex8.m1.9.9.9.9.2.1.1.1.1.cmml" xref="S2.Ex8.m1.9.9.9.9.2.1.1.1.1">conditional</csymbol><ci id="S2.Ex8.m1.9.9.9.9.2.1.1.1.2.cmml" xref="S2.Ex8.m1.9.9.9.9.2.1.1.1.2">𝑎</ci><ci id="S2.Ex8.m1.9.9.9.9.2.1.1.1.3.cmml" xref="S2.Ex8.m1.9.9.9.9.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply><apply id="S2.Ex8.m1.16.16.16.cmml" xref="S2.Ex8.m1.16.16.16"><csymbol cd="ambiguous" id="S2.Ex8.m1.16.16.16.6.cmml" xref="S2.Ex8.m1.16.16.16">superscript</csymbol><apply id="S2.Ex8.m1.16.16.16.5.1.1.cmml" xref="S2.Ex8.m1.16.16.16.5.1"><apply id="S2.Ex8.m1.16.16.16.5.1.1.1.cmml" xref="S2.Ex8.m1.16.16.16.5.1.1.1"><csymbol cd="ambiguous" id="S2.Ex8.m1.16.16.16.5.1.1.1.1.cmml" xref="S2.Ex8.m1.16.16.16.5.1.1.1">subscript</csymbol><sum id="S2.Ex8.m1.16.16.16.5.1.1.1.2.cmml" xref="S2.Ex8.m1.16.16.16.5.1.1.1.2"></sum><interval closure="open" id="S2.Ex8.m1.13.13.13.2.2.3.cmml" xref="S2.Ex8.m1.13.13.13.2.2.4"><ci id="S2.Ex8.m1.12.12.12.1.1.1.cmml" xref="S2.Ex8.m1.12.12.12.1.1.1">𝑥</ci><ci id="S2.Ex8.m1.13.13.13.2.2.2.cmml" xref="S2.Ex8.m1.13.13.13.2.2.2">𝑎</ci></interval></apply><apply id="S2.Ex8.m1.15.15.15.4.cmml" xref="S2.Ex8.m1.15.15.15.4"><divide id="S2.Ex8.m1.15.15.15.4.3.cmml" xref="S2.Ex8.m1.15.15.15.4"></divide><apply id="S2.Ex8.m1.14.14.14.3.1.cmml" xref="S2.Ex8.m1.14.14.14.3.1"><times id="S2.Ex8.m1.14.14.14.3.1.2.cmml" xref="S2.Ex8.m1.14.14.14.3.1.2"></times><ci id="S2.Ex8.m1.14.14.14.3.1.3.cmml" xref="S2.Ex8.m1.14.14.14.3.1.3">𝜋</ci><apply id="S2.Ex8.m1.14.14.14.3.1.1.1.1.cmml" xref="S2.Ex8.m1.14.14.14.3.1.1.1"><csymbol cd="latexml" id="S2.Ex8.m1.14.14.14.3.1.1.1.1.1.cmml" xref="S2.Ex8.m1.14.14.14.3.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex8.m1.14.14.14.3.1.1.1.1.2.cmml" xref="S2.Ex8.m1.14.14.14.3.1.1.1.1.2">𝑎</ci><ci id="S2.Ex8.m1.14.14.14.3.1.1.1.1.3.cmml" xref="S2.Ex8.m1.14.14.14.3.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.Ex8.m1.15.15.15.4.2.cmml" xref="S2.Ex8.m1.15.15.15.4.2"><times id="S2.Ex8.m1.15.15.15.4.2.2.cmml" xref="S2.Ex8.m1.15.15.15.4.2.2"></times><apply id="S2.Ex8.m1.15.15.15.4.2.3.cmml" xref="S2.Ex8.m1.15.15.15.4.2.3"><csymbol cd="ambiguous" id="S2.Ex8.m1.15.15.15.4.2.3.1.cmml" xref="S2.Ex8.m1.15.15.15.4.2.3">subscript</csymbol><ci id="S2.Ex8.m1.15.15.15.4.2.3.2.cmml" xref="S2.Ex8.m1.15.15.15.4.2.3.2">𝜋</ci><cn id="S2.Ex8.m1.15.15.15.4.2.3.3.cmml" type="integer" xref="S2.Ex8.m1.15.15.15.4.2.3.3">0</cn></apply><apply id="S2.Ex8.m1.15.15.15.4.2.1.1.1.cmml" xref="S2.Ex8.m1.15.15.15.4.2.1.1"><csymbol cd="latexml" id="S2.Ex8.m1.15.15.15.4.2.1.1.1.1.cmml" xref="S2.Ex8.m1.15.15.15.4.2.1.1.1.1">conditional</csymbol><ci id="S2.Ex8.m1.15.15.15.4.2.1.1.1.2.cmml" xref="S2.Ex8.m1.15.15.15.4.2.1.1.1.2">𝑎</ci><ci id="S2.Ex8.m1.15.15.15.4.2.1.1.1.3.cmml" xref="S2.Ex8.m1.15.15.15.4.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply><cn id="S2.Ex8.m1.16.16.16.7.cmml" type="integer" xref="S2.Ex8.m1.16.16.16.7">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex8.m1.16c">\displaystyle\qquad\qquad\qquad=\frac{\left(\sum_{(x,a,r)}\frac{\nabla\pi(a|x)%
}{\pi_{0}(a|x)}r\right)\left(\sum_{(x,a)}\frac{\pi(a|x)}{\pi_{0}(a|x)}\right)}%
{\left({\sum_{(x,a)}\frac{\pi(a|x)}{\pi_{0}(a|x)}}\right)^{2}}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex8.m1.16d">= divide start_ARG ( ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) end_POSTSUBSCRIPT divide start_ARG ∇ italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG italic_r ) ( ∑ start_POSTSUBSCRIPT ( italic_x , italic_a ) end_POSTSUBSCRIPT divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ) end_ARG start_ARG ( ∑ start_POSTSUBSCRIPT ( italic_x , italic_a ) end_POSTSUBSCRIPT divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(16)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\quad-\frac{\left(\sum_{(x,a,r)}\frac{\pi(a|x)}{\pi_{0}(a|x)}r%
\right)\left(\sum_{(x,a)}\frac{\nabla\pi(a|x)}{\pi_{0}(a|x)}\right)}{\left({%
\sum_{(x,a)}\frac{\pi(a|x)}{\pi_{0}(a|x)}}\right)^{2}}" class="ltx_Math" display="inline" id="S2.E16.m1.16"><semantics id="S2.E16.m1.16a"><mrow id="S2.E16.m1.16.17" xref="S2.E16.m1.16.17.cmml"><mo id="S2.E16.m1.16.17a" xref="S2.E16.m1.16.17.cmml">−</mo><mstyle displaystyle="true" id="S2.E16.m1.16.16" xref="S2.E16.m1.16.16.cmml"><mfrac id="S2.E16.m1.16.16a" xref="S2.E16.m1.16.16.cmml"><mrow id="S2.E16.m1.11.11.11" xref="S2.E16.m1.11.11.11.cmml"><mrow id="S2.E16.m1.10.10.10.10.1" xref="S2.E16.m1.10.10.10.10.1.1.cmml"><mo id="S2.E16.m1.10.10.10.10.1.2" xref="S2.E16.m1.10.10.10.10.1.1.cmml">(</mo><mrow id="S2.E16.m1.10.10.10.10.1.1" xref="S2.E16.m1.10.10.10.10.1.1.cmml"><msub id="S2.E16.m1.10.10.10.10.1.1.1" xref="S2.E16.m1.10.10.10.10.1.1.1.cmml"><mo id="S2.E16.m1.10.10.10.10.1.1.1.2" lspace="0em" xref="S2.E16.m1.10.10.10.10.1.1.1.2.cmml">∑</mo><mrow id="S2.E16.m1.3.3.3.3.3.5" xref="S2.E16.m1.3.3.3.3.3.4.cmml"><mo id="S2.E16.m1.3.3.3.3.3.5.1" stretchy="false" xref="S2.E16.m1.3.3.3.3.3.4.cmml">(</mo><mi id="S2.E16.m1.1.1.1.1.1.1" xref="S2.E16.m1.1.1.1.1.1.1.cmml">x</mi><mo id="S2.E16.m1.3.3.3.3.3.5.2" xref="S2.E16.m1.3.3.3.3.3.4.cmml">,</mo><mi id="S2.E16.m1.2.2.2.2.2.2" xref="S2.E16.m1.2.2.2.2.2.2.cmml">a</mi><mo id="S2.E16.m1.3.3.3.3.3.5.3" xref="S2.E16.m1.3.3.3.3.3.4.cmml">,</mo><mi id="S2.E16.m1.3.3.3.3.3.3" xref="S2.E16.m1.3.3.3.3.3.3.cmml">r</mi><mo id="S2.E16.m1.3.3.3.3.3.5.4" stretchy="false" xref="S2.E16.m1.3.3.3.3.3.4.cmml">)</mo></mrow></msub><mrow id="S2.E16.m1.10.10.10.10.1.1.2" xref="S2.E16.m1.10.10.10.10.1.1.2.cmml"><mfrac id="S2.E16.m1.5.5.5.5" xref="S2.E16.m1.5.5.5.5.cmml"><mrow id="S2.E16.m1.4.4.4.4.1" xref="S2.E16.m1.4.4.4.4.1.cmml"><mi id="S2.E16.m1.4.4.4.4.1.3" xref="S2.E16.m1.4.4.4.4.1.3.cmml">π</mi><mo id="S2.E16.m1.4.4.4.4.1.2" xref="S2.E16.m1.4.4.4.4.1.2.cmml">⁢</mo><mrow id="S2.E16.m1.4.4.4.4.1.1.1" xref="S2.E16.m1.4.4.4.4.1.1.1.1.cmml"><mo id="S2.E16.m1.4.4.4.4.1.1.1.2" stretchy="false" xref="S2.E16.m1.4.4.4.4.1.1.1.1.cmml">(</mo><mrow id="S2.E16.m1.4.4.4.4.1.1.1.1" xref="S2.E16.m1.4.4.4.4.1.1.1.1.cmml"><mi id="S2.E16.m1.4.4.4.4.1.1.1.1.2" xref="S2.E16.m1.4.4.4.4.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.E16.m1.4.4.4.4.1.1.1.1.1" xref="S2.E16.m1.4.4.4.4.1.1.1.1.1.cmml">|</mo><mi id="S2.E16.m1.4.4.4.4.1.1.1.1.3" xref="S2.E16.m1.4.4.4.4.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E16.m1.4.4.4.4.1.1.1.3" stretchy="false" xref="S2.E16.m1.4.4.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E16.m1.5.5.5.5.2" xref="S2.E16.m1.5.5.5.5.2.cmml"><msub id="S2.E16.m1.5.5.5.5.2.3" xref="S2.E16.m1.5.5.5.5.2.3.cmml"><mi id="S2.E16.m1.5.5.5.5.2.3.2" xref="S2.E16.m1.5.5.5.5.2.3.2.cmml">π</mi><mn id="S2.E16.m1.5.5.5.5.2.3.3" xref="S2.E16.m1.5.5.5.5.2.3.3.cmml">0</mn></msub><mo id="S2.E16.m1.5.5.5.5.2.2" xref="S2.E16.m1.5.5.5.5.2.2.cmml">⁢</mo><mrow id="S2.E16.m1.5.5.5.5.2.1.1" xref="S2.E16.m1.5.5.5.5.2.1.1.1.cmml"><mo id="S2.E16.m1.5.5.5.5.2.1.1.2" stretchy="false" xref="S2.E16.m1.5.5.5.5.2.1.1.1.cmml">(</mo><mrow id="S2.E16.m1.5.5.5.5.2.1.1.1" xref="S2.E16.m1.5.5.5.5.2.1.1.1.cmml"><mi id="S2.E16.m1.5.5.5.5.2.1.1.1.2" xref="S2.E16.m1.5.5.5.5.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.E16.m1.5.5.5.5.2.1.1.1.1" xref="S2.E16.m1.5.5.5.5.2.1.1.1.1.cmml">|</mo><mi id="S2.E16.m1.5.5.5.5.2.1.1.1.3" xref="S2.E16.m1.5.5.5.5.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E16.m1.5.5.5.5.2.1.1.3" stretchy="false" xref="S2.E16.m1.5.5.5.5.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S2.E16.m1.10.10.10.10.1.1.2.1" xref="S2.E16.m1.10.10.10.10.1.1.2.1.cmml">⁢</mo><mi id="S2.E16.m1.10.10.10.10.1.1.2.2" xref="S2.E16.m1.10.10.10.10.1.1.2.2.cmml">r</mi></mrow></mrow><mo id="S2.E16.m1.10.10.10.10.1.3" xref="S2.E16.m1.10.10.10.10.1.1.cmml">)</mo></mrow><mo id="S2.E16.m1.11.11.11.12" xref="S2.E16.m1.11.11.11.12.cmml">⁢</mo><mrow id="S2.E16.m1.11.11.11.11.1" xref="S2.E16.m1.11.11.11.11.1.1.cmml"><mo id="S2.E16.m1.11.11.11.11.1.2" xref="S2.E16.m1.11.11.11.11.1.1.cmml">(</mo><mrow id="S2.E16.m1.11.11.11.11.1.1" xref="S2.E16.m1.11.11.11.11.1.1.cmml"><msub id="S2.E16.m1.11.11.11.11.1.1.1" xref="S2.E16.m1.11.11.11.11.1.1.1.cmml"><mo id="S2.E16.m1.11.11.11.11.1.1.1.2" lspace="0em" xref="S2.E16.m1.11.11.11.11.1.1.1.2.cmml">∑</mo><mrow id="S2.E16.m1.7.7.7.7.2.4" xref="S2.E16.m1.7.7.7.7.2.3.cmml"><mo id="S2.E16.m1.7.7.7.7.2.4.1" stretchy="false" xref="S2.E16.m1.7.7.7.7.2.3.cmml">(</mo><mi id="S2.E16.m1.6.6.6.6.1.1" xref="S2.E16.m1.6.6.6.6.1.1.cmml">x</mi><mo id="S2.E16.m1.7.7.7.7.2.4.2" xref="S2.E16.m1.7.7.7.7.2.3.cmml">,</mo><mi id="S2.E16.m1.7.7.7.7.2.2" xref="S2.E16.m1.7.7.7.7.2.2.cmml">a</mi><mo id="S2.E16.m1.7.7.7.7.2.4.3" stretchy="false" xref="S2.E16.m1.7.7.7.7.2.3.cmml">)</mo></mrow></msub><mfrac id="S2.E16.m1.9.9.9.9" xref="S2.E16.m1.9.9.9.9.cmml"><mrow id="S2.E16.m1.8.8.8.8.1" xref="S2.E16.m1.8.8.8.8.1.cmml"><mrow id="S2.E16.m1.8.8.8.8.1.3" xref="S2.E16.m1.8.8.8.8.1.3.cmml"><mo id="S2.E16.m1.8.8.8.8.1.3.1" rspace="0.167em" xref="S2.E16.m1.8.8.8.8.1.3.1.cmml">∇</mo><mi id="S2.E16.m1.8.8.8.8.1.3.2" xref="S2.E16.m1.8.8.8.8.1.3.2.cmml">π</mi></mrow><mo id="S2.E16.m1.8.8.8.8.1.2" xref="S2.E16.m1.8.8.8.8.1.2.cmml">⁢</mo><mrow id="S2.E16.m1.8.8.8.8.1.1.1" xref="S2.E16.m1.8.8.8.8.1.1.1.1.cmml"><mo id="S2.E16.m1.8.8.8.8.1.1.1.2" stretchy="false" xref="S2.E16.m1.8.8.8.8.1.1.1.1.cmml">(</mo><mrow id="S2.E16.m1.8.8.8.8.1.1.1.1" xref="S2.E16.m1.8.8.8.8.1.1.1.1.cmml"><mi id="S2.E16.m1.8.8.8.8.1.1.1.1.2" xref="S2.E16.m1.8.8.8.8.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.E16.m1.8.8.8.8.1.1.1.1.1" xref="S2.E16.m1.8.8.8.8.1.1.1.1.1.cmml">|</mo><mi id="S2.E16.m1.8.8.8.8.1.1.1.1.3" xref="S2.E16.m1.8.8.8.8.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E16.m1.8.8.8.8.1.1.1.3" stretchy="false" xref="S2.E16.m1.8.8.8.8.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E16.m1.9.9.9.9.2" xref="S2.E16.m1.9.9.9.9.2.cmml"><msub id="S2.E16.m1.9.9.9.9.2.3" xref="S2.E16.m1.9.9.9.9.2.3.cmml"><mi id="S2.E16.m1.9.9.9.9.2.3.2" xref="S2.E16.m1.9.9.9.9.2.3.2.cmml">π</mi><mn id="S2.E16.m1.9.9.9.9.2.3.3" xref="S2.E16.m1.9.9.9.9.2.3.3.cmml">0</mn></msub><mo id="S2.E16.m1.9.9.9.9.2.2" xref="S2.E16.m1.9.9.9.9.2.2.cmml">⁢</mo><mrow id="S2.E16.m1.9.9.9.9.2.1.1" xref="S2.E16.m1.9.9.9.9.2.1.1.1.cmml"><mo id="S2.E16.m1.9.9.9.9.2.1.1.2" stretchy="false" xref="S2.E16.m1.9.9.9.9.2.1.1.1.cmml">(</mo><mrow id="S2.E16.m1.9.9.9.9.2.1.1.1" xref="S2.E16.m1.9.9.9.9.2.1.1.1.cmml"><mi id="S2.E16.m1.9.9.9.9.2.1.1.1.2" xref="S2.E16.m1.9.9.9.9.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.E16.m1.9.9.9.9.2.1.1.1.1" xref="S2.E16.m1.9.9.9.9.2.1.1.1.1.cmml">|</mo><mi id="S2.E16.m1.9.9.9.9.2.1.1.1.3" xref="S2.E16.m1.9.9.9.9.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E16.m1.9.9.9.9.2.1.1.3" stretchy="false" xref="S2.E16.m1.9.9.9.9.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S2.E16.m1.11.11.11.11.1.3" xref="S2.E16.m1.11.11.11.11.1.1.cmml">)</mo></mrow></mrow><msup id="S2.E16.m1.16.16.16" xref="S2.E16.m1.16.16.16.cmml"><mrow id="S2.E16.m1.16.16.16.5.1" xref="S2.E16.m1.16.16.16.5.1.1.cmml"><mo id="S2.E16.m1.16.16.16.5.1.2" xref="S2.E16.m1.16.16.16.5.1.1.cmml">(</mo><mrow id="S2.E16.m1.16.16.16.5.1.1" xref="S2.E16.m1.16.16.16.5.1.1.cmml"><msub id="S2.E16.m1.16.16.16.5.1.1.1" xref="S2.E16.m1.16.16.16.5.1.1.1.cmml"><mo id="S2.E16.m1.16.16.16.5.1.1.1.2" lspace="0em" xref="S2.E16.m1.16.16.16.5.1.1.1.2.cmml">∑</mo><mrow id="S2.E16.m1.13.13.13.2.2.4" xref="S2.E16.m1.13.13.13.2.2.3.cmml"><mo id="S2.E16.m1.13.13.13.2.2.4.1" stretchy="false" xref="S2.E16.m1.13.13.13.2.2.3.cmml">(</mo><mi id="S2.E16.m1.12.12.12.1.1.1" xref="S2.E16.m1.12.12.12.1.1.1.cmml">x</mi><mo id="S2.E16.m1.13.13.13.2.2.4.2" xref="S2.E16.m1.13.13.13.2.2.3.cmml">,</mo><mi id="S2.E16.m1.13.13.13.2.2.2" xref="S2.E16.m1.13.13.13.2.2.2.cmml">a</mi><mo id="S2.E16.m1.13.13.13.2.2.4.3" stretchy="false" xref="S2.E16.m1.13.13.13.2.2.3.cmml">)</mo></mrow></msub><mfrac id="S2.E16.m1.15.15.15.4" xref="S2.E16.m1.15.15.15.4.cmml"><mrow id="S2.E16.m1.14.14.14.3.1" xref="S2.E16.m1.14.14.14.3.1.cmml"><mi id="S2.E16.m1.14.14.14.3.1.3" xref="S2.E16.m1.14.14.14.3.1.3.cmml">π</mi><mo id="S2.E16.m1.14.14.14.3.1.2" xref="S2.E16.m1.14.14.14.3.1.2.cmml">⁢</mo><mrow id="S2.E16.m1.14.14.14.3.1.1.1" xref="S2.E16.m1.14.14.14.3.1.1.1.1.cmml"><mo id="S2.E16.m1.14.14.14.3.1.1.1.2" stretchy="false" xref="S2.E16.m1.14.14.14.3.1.1.1.1.cmml">(</mo><mrow id="S2.E16.m1.14.14.14.3.1.1.1.1" xref="S2.E16.m1.14.14.14.3.1.1.1.1.cmml"><mi id="S2.E16.m1.14.14.14.3.1.1.1.1.2" xref="S2.E16.m1.14.14.14.3.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.E16.m1.14.14.14.3.1.1.1.1.1" xref="S2.E16.m1.14.14.14.3.1.1.1.1.1.cmml">|</mo><mi id="S2.E16.m1.14.14.14.3.1.1.1.1.3" xref="S2.E16.m1.14.14.14.3.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E16.m1.14.14.14.3.1.1.1.3" stretchy="false" xref="S2.E16.m1.14.14.14.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E16.m1.15.15.15.4.2" xref="S2.E16.m1.15.15.15.4.2.cmml"><msub id="S2.E16.m1.15.15.15.4.2.3" xref="S2.E16.m1.15.15.15.4.2.3.cmml"><mi id="S2.E16.m1.15.15.15.4.2.3.2" xref="S2.E16.m1.15.15.15.4.2.3.2.cmml">π</mi><mn id="S2.E16.m1.15.15.15.4.2.3.3" xref="S2.E16.m1.15.15.15.4.2.3.3.cmml">0</mn></msub><mo id="S2.E16.m1.15.15.15.4.2.2" xref="S2.E16.m1.15.15.15.4.2.2.cmml">⁢</mo><mrow id="S2.E16.m1.15.15.15.4.2.1.1" xref="S2.E16.m1.15.15.15.4.2.1.1.1.cmml"><mo id="S2.E16.m1.15.15.15.4.2.1.1.2" stretchy="false" xref="S2.E16.m1.15.15.15.4.2.1.1.1.cmml">(</mo><mrow id="S2.E16.m1.15.15.15.4.2.1.1.1" xref="S2.E16.m1.15.15.15.4.2.1.1.1.cmml"><mi id="S2.E16.m1.15.15.15.4.2.1.1.1.2" xref="S2.E16.m1.15.15.15.4.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.E16.m1.15.15.15.4.2.1.1.1.1" xref="S2.E16.m1.15.15.15.4.2.1.1.1.1.cmml">|</mo><mi id="S2.E16.m1.15.15.15.4.2.1.1.1.3" xref="S2.E16.m1.15.15.15.4.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E16.m1.15.15.15.4.2.1.1.3" stretchy="false" xref="S2.E16.m1.15.15.15.4.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S2.E16.m1.16.16.16.5.1.3" xref="S2.E16.m1.16.16.16.5.1.1.cmml">)</mo></mrow><mn id="S2.E16.m1.16.16.16.7" xref="S2.E16.m1.16.16.16.7.cmml">2</mn></msup></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S2.E16.m1.16b"><apply id="S2.E16.m1.16.17.cmml" xref="S2.E16.m1.16.17"><minus id="S2.E16.m1.16.17.1.cmml" xref="S2.E16.m1.16.17"></minus><apply id="S2.E16.m1.16.16.cmml" xref="S2.E16.m1.16.16"><divide id="S2.E16.m1.16.16.17.cmml" xref="S2.E16.m1.16.16"></divide><apply id="S2.E16.m1.11.11.11.cmml" xref="S2.E16.m1.11.11.11"><times id="S2.E16.m1.11.11.11.12.cmml" xref="S2.E16.m1.11.11.11.12"></times><apply id="S2.E16.m1.10.10.10.10.1.1.cmml" xref="S2.E16.m1.10.10.10.10.1"><apply id="S2.E16.m1.10.10.10.10.1.1.1.cmml" xref="S2.E16.m1.10.10.10.10.1.1.1"><csymbol cd="ambiguous" id="S2.E16.m1.10.10.10.10.1.1.1.1.cmml" xref="S2.E16.m1.10.10.10.10.1.1.1">subscript</csymbol><sum id="S2.E16.m1.10.10.10.10.1.1.1.2.cmml" xref="S2.E16.m1.10.10.10.10.1.1.1.2"></sum><vector id="S2.E16.m1.3.3.3.3.3.4.cmml" xref="S2.E16.m1.3.3.3.3.3.5"><ci id="S2.E16.m1.1.1.1.1.1.1.cmml" xref="S2.E16.m1.1.1.1.1.1.1">𝑥</ci><ci id="S2.E16.m1.2.2.2.2.2.2.cmml" xref="S2.E16.m1.2.2.2.2.2.2">𝑎</ci><ci id="S2.E16.m1.3.3.3.3.3.3.cmml" xref="S2.E16.m1.3.3.3.3.3.3">𝑟</ci></vector></apply><apply id="S2.E16.m1.10.10.10.10.1.1.2.cmml" xref="S2.E16.m1.10.10.10.10.1.1.2"><times id="S2.E16.m1.10.10.10.10.1.1.2.1.cmml" xref="S2.E16.m1.10.10.10.10.1.1.2.1"></times><apply id="S2.E16.m1.5.5.5.5.cmml" xref="S2.E16.m1.5.5.5.5"><divide id="S2.E16.m1.5.5.5.5.3.cmml" xref="S2.E16.m1.5.5.5.5"></divide><apply id="S2.E16.m1.4.4.4.4.1.cmml" xref="S2.E16.m1.4.4.4.4.1"><times id="S2.E16.m1.4.4.4.4.1.2.cmml" xref="S2.E16.m1.4.4.4.4.1.2"></times><ci id="S2.E16.m1.4.4.4.4.1.3.cmml" xref="S2.E16.m1.4.4.4.4.1.3">𝜋</ci><apply id="S2.E16.m1.4.4.4.4.1.1.1.1.cmml" xref="S2.E16.m1.4.4.4.4.1.1.1"><csymbol cd="latexml" id="S2.E16.m1.4.4.4.4.1.1.1.1.1.cmml" xref="S2.E16.m1.4.4.4.4.1.1.1.1.1">conditional</csymbol><ci id="S2.E16.m1.4.4.4.4.1.1.1.1.2.cmml" xref="S2.E16.m1.4.4.4.4.1.1.1.1.2">𝑎</ci><ci id="S2.E16.m1.4.4.4.4.1.1.1.1.3.cmml" xref="S2.E16.m1.4.4.4.4.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.E16.m1.5.5.5.5.2.cmml" xref="S2.E16.m1.5.5.5.5.2"><times id="S2.E16.m1.5.5.5.5.2.2.cmml" xref="S2.E16.m1.5.5.5.5.2.2"></times><apply id="S2.E16.m1.5.5.5.5.2.3.cmml" xref="S2.E16.m1.5.5.5.5.2.3"><csymbol cd="ambiguous" id="S2.E16.m1.5.5.5.5.2.3.1.cmml" xref="S2.E16.m1.5.5.5.5.2.3">subscript</csymbol><ci id="S2.E16.m1.5.5.5.5.2.3.2.cmml" xref="S2.E16.m1.5.5.5.5.2.3.2">𝜋</ci><cn id="S2.E16.m1.5.5.5.5.2.3.3.cmml" type="integer" xref="S2.E16.m1.5.5.5.5.2.3.3">0</cn></apply><apply id="S2.E16.m1.5.5.5.5.2.1.1.1.cmml" xref="S2.E16.m1.5.5.5.5.2.1.1"><csymbol cd="latexml" id="S2.E16.m1.5.5.5.5.2.1.1.1.1.cmml" xref="S2.E16.m1.5.5.5.5.2.1.1.1.1">conditional</csymbol><ci id="S2.E16.m1.5.5.5.5.2.1.1.1.2.cmml" xref="S2.E16.m1.5.5.5.5.2.1.1.1.2">𝑎</ci><ci id="S2.E16.m1.5.5.5.5.2.1.1.1.3.cmml" xref="S2.E16.m1.5.5.5.5.2.1.1.1.3">𝑥</ci></apply></apply></apply><ci id="S2.E16.m1.10.10.10.10.1.1.2.2.cmml" xref="S2.E16.m1.10.10.10.10.1.1.2.2">𝑟</ci></apply></apply><apply id="S2.E16.m1.11.11.11.11.1.1.cmml" xref="S2.E16.m1.11.11.11.11.1"><apply id="S2.E16.m1.11.11.11.11.1.1.1.cmml" xref="S2.E16.m1.11.11.11.11.1.1.1"><csymbol cd="ambiguous" id="S2.E16.m1.11.11.11.11.1.1.1.1.cmml" xref="S2.E16.m1.11.11.11.11.1.1.1">subscript</csymbol><sum id="S2.E16.m1.11.11.11.11.1.1.1.2.cmml" xref="S2.E16.m1.11.11.11.11.1.1.1.2"></sum><interval closure="open" id="S2.E16.m1.7.7.7.7.2.3.cmml" xref="S2.E16.m1.7.7.7.7.2.4"><ci id="S2.E16.m1.6.6.6.6.1.1.cmml" xref="S2.E16.m1.6.6.6.6.1.1">𝑥</ci><ci id="S2.E16.m1.7.7.7.7.2.2.cmml" xref="S2.E16.m1.7.7.7.7.2.2">𝑎</ci></interval></apply><apply id="S2.E16.m1.9.9.9.9.cmml" xref="S2.E16.m1.9.9.9.9"><divide id="S2.E16.m1.9.9.9.9.3.cmml" xref="S2.E16.m1.9.9.9.9"></divide><apply id="S2.E16.m1.8.8.8.8.1.cmml" xref="S2.E16.m1.8.8.8.8.1"><times id="S2.E16.m1.8.8.8.8.1.2.cmml" xref="S2.E16.m1.8.8.8.8.1.2"></times><apply id="S2.E16.m1.8.8.8.8.1.3.cmml" xref="S2.E16.m1.8.8.8.8.1.3"><ci id="S2.E16.m1.8.8.8.8.1.3.1.cmml" xref="S2.E16.m1.8.8.8.8.1.3.1">∇</ci><ci id="S2.E16.m1.8.8.8.8.1.3.2.cmml" xref="S2.E16.m1.8.8.8.8.1.3.2">𝜋</ci></apply><apply id="S2.E16.m1.8.8.8.8.1.1.1.1.cmml" xref="S2.E16.m1.8.8.8.8.1.1.1"><csymbol cd="latexml" id="S2.E16.m1.8.8.8.8.1.1.1.1.1.cmml" xref="S2.E16.m1.8.8.8.8.1.1.1.1.1">conditional</csymbol><ci id="S2.E16.m1.8.8.8.8.1.1.1.1.2.cmml" xref="S2.E16.m1.8.8.8.8.1.1.1.1.2">𝑎</ci><ci id="S2.E16.m1.8.8.8.8.1.1.1.1.3.cmml" xref="S2.E16.m1.8.8.8.8.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.E16.m1.9.9.9.9.2.cmml" xref="S2.E16.m1.9.9.9.9.2"><times id="S2.E16.m1.9.9.9.9.2.2.cmml" xref="S2.E16.m1.9.9.9.9.2.2"></times><apply id="S2.E16.m1.9.9.9.9.2.3.cmml" xref="S2.E16.m1.9.9.9.9.2.3"><csymbol cd="ambiguous" id="S2.E16.m1.9.9.9.9.2.3.1.cmml" xref="S2.E16.m1.9.9.9.9.2.3">subscript</csymbol><ci id="S2.E16.m1.9.9.9.9.2.3.2.cmml" xref="S2.E16.m1.9.9.9.9.2.3.2">𝜋</ci><cn id="S2.E16.m1.9.9.9.9.2.3.3.cmml" type="integer" xref="S2.E16.m1.9.9.9.9.2.3.3">0</cn></apply><apply id="S2.E16.m1.9.9.9.9.2.1.1.1.cmml" xref="S2.E16.m1.9.9.9.9.2.1.1"><csymbol cd="latexml" id="S2.E16.m1.9.9.9.9.2.1.1.1.1.cmml" xref="S2.E16.m1.9.9.9.9.2.1.1.1.1">conditional</csymbol><ci id="S2.E16.m1.9.9.9.9.2.1.1.1.2.cmml" xref="S2.E16.m1.9.9.9.9.2.1.1.1.2">𝑎</ci><ci id="S2.E16.m1.9.9.9.9.2.1.1.1.3.cmml" xref="S2.E16.m1.9.9.9.9.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply><apply id="S2.E16.m1.16.16.16.cmml" xref="S2.E16.m1.16.16.16"><csymbol cd="ambiguous" id="S2.E16.m1.16.16.16.6.cmml" xref="S2.E16.m1.16.16.16">superscript</csymbol><apply id="S2.E16.m1.16.16.16.5.1.1.cmml" xref="S2.E16.m1.16.16.16.5.1"><apply id="S2.E16.m1.16.16.16.5.1.1.1.cmml" xref="S2.E16.m1.16.16.16.5.1.1.1"><csymbol cd="ambiguous" id="S2.E16.m1.16.16.16.5.1.1.1.1.cmml" xref="S2.E16.m1.16.16.16.5.1.1.1">subscript</csymbol><sum id="S2.E16.m1.16.16.16.5.1.1.1.2.cmml" xref="S2.E16.m1.16.16.16.5.1.1.1.2"></sum><interval closure="open" id="S2.E16.m1.13.13.13.2.2.3.cmml" xref="S2.E16.m1.13.13.13.2.2.4"><ci id="S2.E16.m1.12.12.12.1.1.1.cmml" xref="S2.E16.m1.12.12.12.1.1.1">𝑥</ci><ci id="S2.E16.m1.13.13.13.2.2.2.cmml" xref="S2.E16.m1.13.13.13.2.2.2">𝑎</ci></interval></apply><apply id="S2.E16.m1.15.15.15.4.cmml" xref="S2.E16.m1.15.15.15.4"><divide id="S2.E16.m1.15.15.15.4.3.cmml" xref="S2.E16.m1.15.15.15.4"></divide><apply id="S2.E16.m1.14.14.14.3.1.cmml" xref="S2.E16.m1.14.14.14.3.1"><times id="S2.E16.m1.14.14.14.3.1.2.cmml" xref="S2.E16.m1.14.14.14.3.1.2"></times><ci id="S2.E16.m1.14.14.14.3.1.3.cmml" xref="S2.E16.m1.14.14.14.3.1.3">𝜋</ci><apply id="S2.E16.m1.14.14.14.3.1.1.1.1.cmml" xref="S2.E16.m1.14.14.14.3.1.1.1"><csymbol cd="latexml" id="S2.E16.m1.14.14.14.3.1.1.1.1.1.cmml" xref="S2.E16.m1.14.14.14.3.1.1.1.1.1">conditional</csymbol><ci id="S2.E16.m1.14.14.14.3.1.1.1.1.2.cmml" xref="S2.E16.m1.14.14.14.3.1.1.1.1.2">𝑎</ci><ci id="S2.E16.m1.14.14.14.3.1.1.1.1.3.cmml" xref="S2.E16.m1.14.14.14.3.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.E16.m1.15.15.15.4.2.cmml" xref="S2.E16.m1.15.15.15.4.2"><times id="S2.E16.m1.15.15.15.4.2.2.cmml" xref="S2.E16.m1.15.15.15.4.2.2"></times><apply id="S2.E16.m1.15.15.15.4.2.3.cmml" xref="S2.E16.m1.15.15.15.4.2.3"><csymbol cd="ambiguous" id="S2.E16.m1.15.15.15.4.2.3.1.cmml" xref="S2.E16.m1.15.15.15.4.2.3">subscript</csymbol><ci id="S2.E16.m1.15.15.15.4.2.3.2.cmml" xref="S2.E16.m1.15.15.15.4.2.3.2">𝜋</ci><cn id="S2.E16.m1.15.15.15.4.2.3.3.cmml" type="integer" xref="S2.E16.m1.15.15.15.4.2.3.3">0</cn></apply><apply id="S2.E16.m1.15.15.15.4.2.1.1.1.cmml" xref="S2.E16.m1.15.15.15.4.2.1.1"><csymbol cd="latexml" id="S2.E16.m1.15.15.15.4.2.1.1.1.1.cmml" xref="S2.E16.m1.15.15.15.4.2.1.1.1.1">conditional</csymbol><ci id="S2.E16.m1.15.15.15.4.2.1.1.1.2.cmml" xref="S2.E16.m1.15.15.15.4.2.1.1.1.2">𝑎</ci><ci id="S2.E16.m1.15.15.15.4.2.1.1.1.3.cmml" xref="S2.E16.m1.15.15.15.4.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply><cn id="S2.E16.m1.16.16.16.7.cmml" type="integer" xref="S2.E16.m1.16.16.16.7">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E16.m1.16c">\displaystyle\quad-\frac{\left(\sum_{(x,a,r)}\frac{\pi(a|x)}{\pi_{0}(a|x)}r%
\right)\left(\sum_{(x,a)}\frac{\nabla\pi(a|x)}{\pi_{0}(a|x)}\right)}{\left({%
\sum_{(x,a)}\frac{\pi(a|x)}{\pi_{0}(a|x)}}\right)^{2}}</annotation><annotation encoding="application/x-llamapun" id="S2.E16.m1.16d">- divide start_ARG ( ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) end_POSTSUBSCRIPT divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG italic_r ) ( ∑ start_POSTSUBSCRIPT ( italic_x , italic_a ) end_POSTSUBSCRIPT divide start_ARG ∇ italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ) end_ARG start_ARG ( ∑ start_POSTSUBSCRIPT ( italic_x , italic_a ) end_POSTSUBSCRIPT divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\sum_{(x_{i},a_{i},r_{i})}\sum_{(x_{j},a_{j},r_{j})}\frac{%
\pi(a_{i}|x_{i})\nabla\pi(a_{j}|x_{j})}{\pi_{0}(a_{i}|x_{i})\pi_{0}(a_{j}|x_{j%
})}(r_{j}-r_{i})}{\left({\sum_{(x,a)}\frac{\pi(a|x)}{\pi_{0}(a|x)}}\right)^{2}}" class="ltx_Math" display="inline" id="S2.Ex9.m1.16"><semantics id="S2.Ex9.m1.16a"><mrow id="S2.Ex9.m1.16.17" xref="S2.Ex9.m1.16.17.cmml"><mi id="S2.Ex9.m1.16.17.2" xref="S2.Ex9.m1.16.17.2.cmml"></mi><mo id="S2.Ex9.m1.16.17.1" xref="S2.Ex9.m1.16.17.1.cmml">=</mo><mstyle displaystyle="true" id="S2.Ex9.m1.16.16" xref="S2.Ex9.m1.16.16.cmml"><mfrac id="S2.Ex9.m1.16.16a" xref="S2.Ex9.m1.16.16.cmml"><mrow id="S2.Ex9.m1.11.11.11" xref="S2.Ex9.m1.11.11.11.cmml"><msub id="S2.Ex9.m1.11.11.11.12" xref="S2.Ex9.m1.11.11.11.12.cmml"><mo id="S2.Ex9.m1.11.11.11.12.2" xref="S2.Ex9.m1.11.11.11.12.2.cmml">∑</mo><mrow id="S2.Ex9.m1.3.3.3.3.3.3" xref="S2.Ex9.m1.3.3.3.3.3.4.cmml"><mo id="S2.Ex9.m1.3.3.3.3.3.3.4" stretchy="false" xref="S2.Ex9.m1.3.3.3.3.3.4.cmml">(</mo><msub id="S2.Ex9.m1.1.1.1.1.1.1.1" xref="S2.Ex9.m1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex9.m1.1.1.1.1.1.1.1.2" xref="S2.Ex9.m1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.Ex9.m1.1.1.1.1.1.1.1.3" xref="S2.Ex9.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.Ex9.m1.3.3.3.3.3.3.5" xref="S2.Ex9.m1.3.3.3.3.3.4.cmml">,</mo><msub id="S2.Ex9.m1.2.2.2.2.2.2.2" xref="S2.Ex9.m1.2.2.2.2.2.2.2.cmml"><mi id="S2.Ex9.m1.2.2.2.2.2.2.2.2" xref="S2.Ex9.m1.2.2.2.2.2.2.2.2.cmml">a</mi><mi id="S2.Ex9.m1.2.2.2.2.2.2.2.3" xref="S2.Ex9.m1.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S2.Ex9.m1.3.3.3.3.3.3.6" xref="S2.Ex9.m1.3.3.3.3.3.4.cmml">,</mo><msub id="S2.Ex9.m1.3.3.3.3.3.3.3" xref="S2.Ex9.m1.3.3.3.3.3.3.3.cmml"><mi id="S2.Ex9.m1.3.3.3.3.3.3.3.2" xref="S2.Ex9.m1.3.3.3.3.3.3.3.2.cmml">r</mi><mi id="S2.Ex9.m1.3.3.3.3.3.3.3.3" xref="S2.Ex9.m1.3.3.3.3.3.3.3.3.cmml">i</mi></msub><mo id="S2.Ex9.m1.3.3.3.3.3.3.7" stretchy="false" xref="S2.Ex9.m1.3.3.3.3.3.4.cmml">)</mo></mrow></msub><mrow id="S2.Ex9.m1.11.11.11.11" xref="S2.Ex9.m1.11.11.11.11.cmml"><msub id="S2.Ex9.m1.11.11.11.11.2" xref="S2.Ex9.m1.11.11.11.11.2.cmml"><mo id="S2.Ex9.m1.11.11.11.11.2.2" lspace="0.167em" xref="S2.Ex9.m1.11.11.11.11.2.2.cmml">∑</mo><mrow id="S2.Ex9.m1.6.6.6.6.3.3" xref="S2.Ex9.m1.6.6.6.6.3.4.cmml"><mo id="S2.Ex9.m1.6.6.6.6.3.3.4" stretchy="false" xref="S2.Ex9.m1.6.6.6.6.3.4.cmml">(</mo><msub id="S2.Ex9.m1.4.4.4.4.1.1.1" xref="S2.Ex9.m1.4.4.4.4.1.1.1.cmml"><mi id="S2.Ex9.m1.4.4.4.4.1.1.1.2" xref="S2.Ex9.m1.4.4.4.4.1.1.1.2.cmml">x</mi><mi id="S2.Ex9.m1.4.4.4.4.1.1.1.3" xref="S2.Ex9.m1.4.4.4.4.1.1.1.3.cmml">j</mi></msub><mo id="S2.Ex9.m1.6.6.6.6.3.3.5" xref="S2.Ex9.m1.6.6.6.6.3.4.cmml">,</mo><msub id="S2.Ex9.m1.5.5.5.5.2.2.2" xref="S2.Ex9.m1.5.5.5.5.2.2.2.cmml"><mi id="S2.Ex9.m1.5.5.5.5.2.2.2.2" xref="S2.Ex9.m1.5.5.5.5.2.2.2.2.cmml">a</mi><mi id="S2.Ex9.m1.5.5.5.5.2.2.2.3" xref="S2.Ex9.m1.5.5.5.5.2.2.2.3.cmml">j</mi></msub><mo id="S2.Ex9.m1.6.6.6.6.3.3.6" xref="S2.Ex9.m1.6.6.6.6.3.4.cmml">,</mo><msub id="S2.Ex9.m1.6.6.6.6.3.3.3" xref="S2.Ex9.m1.6.6.6.6.3.3.3.cmml"><mi id="S2.Ex9.m1.6.6.6.6.3.3.3.2" xref="S2.Ex9.m1.6.6.6.6.3.3.3.2.cmml">r</mi><mi id="S2.Ex9.m1.6.6.6.6.3.3.3.3" xref="S2.Ex9.m1.6.6.6.6.3.3.3.3.cmml">j</mi></msub><mo id="S2.Ex9.m1.6.6.6.6.3.3.7" stretchy="false" xref="S2.Ex9.m1.6.6.6.6.3.4.cmml">)</mo></mrow></msub><mrow id="S2.Ex9.m1.11.11.11.11.1" xref="S2.Ex9.m1.11.11.11.11.1.cmml"><mfrac id="S2.Ex9.m1.10.10.10.10" xref="S2.Ex9.m1.10.10.10.10.cmml"><mrow id="S2.Ex9.m1.8.8.8.8.2" xref="S2.Ex9.m1.8.8.8.8.2.cmml"><mi id="S2.Ex9.m1.8.8.8.8.2.4" xref="S2.Ex9.m1.8.8.8.8.2.4.cmml">π</mi><mo id="S2.Ex9.m1.8.8.8.8.2.3" xref="S2.Ex9.m1.8.8.8.8.2.3.cmml">⁢</mo><mrow id="S2.Ex9.m1.7.7.7.7.1.1.1" xref="S2.Ex9.m1.7.7.7.7.1.1.1.1.cmml"><mo id="S2.Ex9.m1.7.7.7.7.1.1.1.2" stretchy="false" xref="S2.Ex9.m1.7.7.7.7.1.1.1.1.cmml">(</mo><mrow id="S2.Ex9.m1.7.7.7.7.1.1.1.1" xref="S2.Ex9.m1.7.7.7.7.1.1.1.1.cmml"><msub id="S2.Ex9.m1.7.7.7.7.1.1.1.1.2" xref="S2.Ex9.m1.7.7.7.7.1.1.1.1.2.cmml"><mi id="S2.Ex9.m1.7.7.7.7.1.1.1.1.2.2" xref="S2.Ex9.m1.7.7.7.7.1.1.1.1.2.2.cmml">a</mi><mi id="S2.Ex9.m1.7.7.7.7.1.1.1.1.2.3" xref="S2.Ex9.m1.7.7.7.7.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S2.Ex9.m1.7.7.7.7.1.1.1.1.1" xref="S2.Ex9.m1.7.7.7.7.1.1.1.1.1.cmml">|</mo><msub id="S2.Ex9.m1.7.7.7.7.1.1.1.1.3" xref="S2.Ex9.m1.7.7.7.7.1.1.1.1.3.cmml"><mi id="S2.Ex9.m1.7.7.7.7.1.1.1.1.3.2" xref="S2.Ex9.m1.7.7.7.7.1.1.1.1.3.2.cmml">x</mi><mi id="S2.Ex9.m1.7.7.7.7.1.1.1.1.3.3" xref="S2.Ex9.m1.7.7.7.7.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S2.Ex9.m1.7.7.7.7.1.1.1.3" stretchy="false" xref="S2.Ex9.m1.7.7.7.7.1.1.1.1.cmml">)</mo></mrow><mo id="S2.Ex9.m1.8.8.8.8.2.3a" lspace="0.167em" xref="S2.Ex9.m1.8.8.8.8.2.3.cmml">⁢</mo><mrow id="S2.Ex9.m1.8.8.8.8.2.5" xref="S2.Ex9.m1.8.8.8.8.2.5.cmml"><mo id="S2.Ex9.m1.8.8.8.8.2.5.1" rspace="0.167em" xref="S2.Ex9.m1.8.8.8.8.2.5.1.cmml">∇</mo><mi id="S2.Ex9.m1.8.8.8.8.2.5.2" xref="S2.Ex9.m1.8.8.8.8.2.5.2.cmml">π</mi></mrow><mo id="S2.Ex9.m1.8.8.8.8.2.3b" xref="S2.Ex9.m1.8.8.8.8.2.3.cmml">⁢</mo><mrow id="S2.Ex9.m1.8.8.8.8.2.2.1" xref="S2.Ex9.m1.8.8.8.8.2.2.1.1.cmml"><mo id="S2.Ex9.m1.8.8.8.8.2.2.1.2" stretchy="false" xref="S2.Ex9.m1.8.8.8.8.2.2.1.1.cmml">(</mo><mrow id="S2.Ex9.m1.8.8.8.8.2.2.1.1" xref="S2.Ex9.m1.8.8.8.8.2.2.1.1.cmml"><msub id="S2.Ex9.m1.8.8.8.8.2.2.1.1.2" xref="S2.Ex9.m1.8.8.8.8.2.2.1.1.2.cmml"><mi id="S2.Ex9.m1.8.8.8.8.2.2.1.1.2.2" xref="S2.Ex9.m1.8.8.8.8.2.2.1.1.2.2.cmml">a</mi><mi id="S2.Ex9.m1.8.8.8.8.2.2.1.1.2.3" xref="S2.Ex9.m1.8.8.8.8.2.2.1.1.2.3.cmml">j</mi></msub><mo fence="false" id="S2.Ex9.m1.8.8.8.8.2.2.1.1.1" xref="S2.Ex9.m1.8.8.8.8.2.2.1.1.1.cmml">|</mo><msub id="S2.Ex9.m1.8.8.8.8.2.2.1.1.3" xref="S2.Ex9.m1.8.8.8.8.2.2.1.1.3.cmml"><mi id="S2.Ex9.m1.8.8.8.8.2.2.1.1.3.2" xref="S2.Ex9.m1.8.8.8.8.2.2.1.1.3.2.cmml">x</mi><mi id="S2.Ex9.m1.8.8.8.8.2.2.1.1.3.3" xref="S2.Ex9.m1.8.8.8.8.2.2.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S2.Ex9.m1.8.8.8.8.2.2.1.3" stretchy="false" xref="S2.Ex9.m1.8.8.8.8.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.Ex9.m1.10.10.10.10.4" xref="S2.Ex9.m1.10.10.10.10.4.cmml"><msub id="S2.Ex9.m1.10.10.10.10.4.4" xref="S2.Ex9.m1.10.10.10.10.4.4.cmml"><mi id="S2.Ex9.m1.10.10.10.10.4.4.2" xref="S2.Ex9.m1.10.10.10.10.4.4.2.cmml">π</mi><mn id="S2.Ex9.m1.10.10.10.10.4.4.3" xref="S2.Ex9.m1.10.10.10.10.4.4.3.cmml">0</mn></msub><mo id="S2.Ex9.m1.10.10.10.10.4.3" xref="S2.Ex9.m1.10.10.10.10.4.3.cmml">⁢</mo><mrow id="S2.Ex9.m1.9.9.9.9.3.1.1" xref="S2.Ex9.m1.9.9.9.9.3.1.1.1.cmml"><mo id="S2.Ex9.m1.9.9.9.9.3.1.1.2" stretchy="false" xref="S2.Ex9.m1.9.9.9.9.3.1.1.1.cmml">(</mo><mrow id="S2.Ex9.m1.9.9.9.9.3.1.1.1" xref="S2.Ex9.m1.9.9.9.9.3.1.1.1.cmml"><msub id="S2.Ex9.m1.9.9.9.9.3.1.1.1.2" xref="S2.Ex9.m1.9.9.9.9.3.1.1.1.2.cmml"><mi id="S2.Ex9.m1.9.9.9.9.3.1.1.1.2.2" xref="S2.Ex9.m1.9.9.9.9.3.1.1.1.2.2.cmml">a</mi><mi id="S2.Ex9.m1.9.9.9.9.3.1.1.1.2.3" xref="S2.Ex9.m1.9.9.9.9.3.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S2.Ex9.m1.9.9.9.9.3.1.1.1.1" xref="S2.Ex9.m1.9.9.9.9.3.1.1.1.1.cmml">|</mo><msub id="S2.Ex9.m1.9.9.9.9.3.1.1.1.3" xref="S2.Ex9.m1.9.9.9.9.3.1.1.1.3.cmml"><mi id="S2.Ex9.m1.9.9.9.9.3.1.1.1.3.2" xref="S2.Ex9.m1.9.9.9.9.3.1.1.1.3.2.cmml">x</mi><mi id="S2.Ex9.m1.9.9.9.9.3.1.1.1.3.3" xref="S2.Ex9.m1.9.9.9.9.3.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S2.Ex9.m1.9.9.9.9.3.1.1.3" stretchy="false" xref="S2.Ex9.m1.9.9.9.9.3.1.1.1.cmml">)</mo></mrow><mo id="S2.Ex9.m1.10.10.10.10.4.3a" xref="S2.Ex9.m1.10.10.10.10.4.3.cmml">⁢</mo><msub id="S2.Ex9.m1.10.10.10.10.4.5" xref="S2.Ex9.m1.10.10.10.10.4.5.cmml"><mi id="S2.Ex9.m1.10.10.10.10.4.5.2" xref="S2.Ex9.m1.10.10.10.10.4.5.2.cmml">π</mi><mn id="S2.Ex9.m1.10.10.10.10.4.5.3" xref="S2.Ex9.m1.10.10.10.10.4.5.3.cmml">0</mn></msub><mo id="S2.Ex9.m1.10.10.10.10.4.3b" xref="S2.Ex9.m1.10.10.10.10.4.3.cmml">⁢</mo><mrow id="S2.Ex9.m1.10.10.10.10.4.2.1" xref="S2.Ex9.m1.10.10.10.10.4.2.1.1.cmml"><mo id="S2.Ex9.m1.10.10.10.10.4.2.1.2" stretchy="false" xref="S2.Ex9.m1.10.10.10.10.4.2.1.1.cmml">(</mo><mrow id="S2.Ex9.m1.10.10.10.10.4.2.1.1" xref="S2.Ex9.m1.10.10.10.10.4.2.1.1.cmml"><msub id="S2.Ex9.m1.10.10.10.10.4.2.1.1.2" xref="S2.Ex9.m1.10.10.10.10.4.2.1.1.2.cmml"><mi id="S2.Ex9.m1.10.10.10.10.4.2.1.1.2.2" xref="S2.Ex9.m1.10.10.10.10.4.2.1.1.2.2.cmml">a</mi><mi id="S2.Ex9.m1.10.10.10.10.4.2.1.1.2.3" xref="S2.Ex9.m1.10.10.10.10.4.2.1.1.2.3.cmml">j</mi></msub><mo fence="false" id="S2.Ex9.m1.10.10.10.10.4.2.1.1.1" xref="S2.Ex9.m1.10.10.10.10.4.2.1.1.1.cmml">|</mo><msub id="S2.Ex9.m1.10.10.10.10.4.2.1.1.3" xref="S2.Ex9.m1.10.10.10.10.4.2.1.1.3.cmml"><mi id="S2.Ex9.m1.10.10.10.10.4.2.1.1.3.2" xref="S2.Ex9.m1.10.10.10.10.4.2.1.1.3.2.cmml">x</mi><mi id="S2.Ex9.m1.10.10.10.10.4.2.1.1.3.3" xref="S2.Ex9.m1.10.10.10.10.4.2.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S2.Ex9.m1.10.10.10.10.4.2.1.3" stretchy="false" xref="S2.Ex9.m1.10.10.10.10.4.2.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S2.Ex9.m1.11.11.11.11.1.2" xref="S2.Ex9.m1.11.11.11.11.1.2.cmml">⁢</mo><mrow id="S2.Ex9.m1.11.11.11.11.1.1.1" xref="S2.Ex9.m1.11.11.11.11.1.1.1.1.cmml"><mo id="S2.Ex9.m1.11.11.11.11.1.1.1.2" stretchy="false" xref="S2.Ex9.m1.11.11.11.11.1.1.1.1.cmml">(</mo><mrow id="S2.Ex9.m1.11.11.11.11.1.1.1.1" xref="S2.Ex9.m1.11.11.11.11.1.1.1.1.cmml"><msub id="S2.Ex9.m1.11.11.11.11.1.1.1.1.2" xref="S2.Ex9.m1.11.11.11.11.1.1.1.1.2.cmml"><mi id="S2.Ex9.m1.11.11.11.11.1.1.1.1.2.2" xref="S2.Ex9.m1.11.11.11.11.1.1.1.1.2.2.cmml">r</mi><mi id="S2.Ex9.m1.11.11.11.11.1.1.1.1.2.3" xref="S2.Ex9.m1.11.11.11.11.1.1.1.1.2.3.cmml">j</mi></msub><mo id="S2.Ex9.m1.11.11.11.11.1.1.1.1.1" xref="S2.Ex9.m1.11.11.11.11.1.1.1.1.1.cmml">−</mo><msub id="S2.Ex9.m1.11.11.11.11.1.1.1.1.3" xref="S2.Ex9.m1.11.11.11.11.1.1.1.1.3.cmml"><mi id="S2.Ex9.m1.11.11.11.11.1.1.1.1.3.2" xref="S2.Ex9.m1.11.11.11.11.1.1.1.1.3.2.cmml">r</mi><mi id="S2.Ex9.m1.11.11.11.11.1.1.1.1.3.3" xref="S2.Ex9.m1.11.11.11.11.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S2.Ex9.m1.11.11.11.11.1.1.1.3" stretchy="false" xref="S2.Ex9.m1.11.11.11.11.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><msup id="S2.Ex9.m1.16.16.16" xref="S2.Ex9.m1.16.16.16.cmml"><mrow id="S2.Ex9.m1.16.16.16.5.1" xref="S2.Ex9.m1.16.16.16.5.1.1.cmml"><mo id="S2.Ex9.m1.16.16.16.5.1.2" xref="S2.Ex9.m1.16.16.16.5.1.1.cmml">(</mo><mrow id="S2.Ex9.m1.16.16.16.5.1.1" xref="S2.Ex9.m1.16.16.16.5.1.1.cmml"><msub id="S2.Ex9.m1.16.16.16.5.1.1.1" xref="S2.Ex9.m1.16.16.16.5.1.1.1.cmml"><mo id="S2.Ex9.m1.16.16.16.5.1.1.1.2" lspace="0em" xref="S2.Ex9.m1.16.16.16.5.1.1.1.2.cmml">∑</mo><mrow id="S2.Ex9.m1.13.13.13.2.2.4" xref="S2.Ex9.m1.13.13.13.2.2.3.cmml"><mo id="S2.Ex9.m1.13.13.13.2.2.4.1" stretchy="false" xref="S2.Ex9.m1.13.13.13.2.2.3.cmml">(</mo><mi id="S2.Ex9.m1.12.12.12.1.1.1" xref="S2.Ex9.m1.12.12.12.1.1.1.cmml">x</mi><mo id="S2.Ex9.m1.13.13.13.2.2.4.2" xref="S2.Ex9.m1.13.13.13.2.2.3.cmml">,</mo><mi id="S2.Ex9.m1.13.13.13.2.2.2" xref="S2.Ex9.m1.13.13.13.2.2.2.cmml">a</mi><mo id="S2.Ex9.m1.13.13.13.2.2.4.3" stretchy="false" xref="S2.Ex9.m1.13.13.13.2.2.3.cmml">)</mo></mrow></msub><mfrac id="S2.Ex9.m1.15.15.15.4" xref="S2.Ex9.m1.15.15.15.4.cmml"><mrow id="S2.Ex9.m1.14.14.14.3.1" xref="S2.Ex9.m1.14.14.14.3.1.cmml"><mi id="S2.Ex9.m1.14.14.14.3.1.3" xref="S2.Ex9.m1.14.14.14.3.1.3.cmml">π</mi><mo id="S2.Ex9.m1.14.14.14.3.1.2" xref="S2.Ex9.m1.14.14.14.3.1.2.cmml">⁢</mo><mrow id="S2.Ex9.m1.14.14.14.3.1.1.1" xref="S2.Ex9.m1.14.14.14.3.1.1.1.1.cmml"><mo id="S2.Ex9.m1.14.14.14.3.1.1.1.2" stretchy="false" xref="S2.Ex9.m1.14.14.14.3.1.1.1.1.cmml">(</mo><mrow id="S2.Ex9.m1.14.14.14.3.1.1.1.1" xref="S2.Ex9.m1.14.14.14.3.1.1.1.1.cmml"><mi id="S2.Ex9.m1.14.14.14.3.1.1.1.1.2" xref="S2.Ex9.m1.14.14.14.3.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.Ex9.m1.14.14.14.3.1.1.1.1.1" xref="S2.Ex9.m1.14.14.14.3.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex9.m1.14.14.14.3.1.1.1.1.3" xref="S2.Ex9.m1.14.14.14.3.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex9.m1.14.14.14.3.1.1.1.3" stretchy="false" xref="S2.Ex9.m1.14.14.14.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.Ex9.m1.15.15.15.4.2" xref="S2.Ex9.m1.15.15.15.4.2.cmml"><msub id="S2.Ex9.m1.15.15.15.4.2.3" xref="S2.Ex9.m1.15.15.15.4.2.3.cmml"><mi id="S2.Ex9.m1.15.15.15.4.2.3.2" xref="S2.Ex9.m1.15.15.15.4.2.3.2.cmml">π</mi><mn id="S2.Ex9.m1.15.15.15.4.2.3.3" xref="S2.Ex9.m1.15.15.15.4.2.3.3.cmml">0</mn></msub><mo id="S2.Ex9.m1.15.15.15.4.2.2" xref="S2.Ex9.m1.15.15.15.4.2.2.cmml">⁢</mo><mrow id="S2.Ex9.m1.15.15.15.4.2.1.1" xref="S2.Ex9.m1.15.15.15.4.2.1.1.1.cmml"><mo id="S2.Ex9.m1.15.15.15.4.2.1.1.2" stretchy="false" xref="S2.Ex9.m1.15.15.15.4.2.1.1.1.cmml">(</mo><mrow id="S2.Ex9.m1.15.15.15.4.2.1.1.1" xref="S2.Ex9.m1.15.15.15.4.2.1.1.1.cmml"><mi id="S2.Ex9.m1.15.15.15.4.2.1.1.1.2" xref="S2.Ex9.m1.15.15.15.4.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.Ex9.m1.15.15.15.4.2.1.1.1.1" xref="S2.Ex9.m1.15.15.15.4.2.1.1.1.1.cmml">|</mo><mi id="S2.Ex9.m1.15.15.15.4.2.1.1.1.3" xref="S2.Ex9.m1.15.15.15.4.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex9.m1.15.15.15.4.2.1.1.3" stretchy="false" xref="S2.Ex9.m1.15.15.15.4.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S2.Ex9.m1.16.16.16.5.1.3" xref="S2.Ex9.m1.16.16.16.5.1.1.cmml">)</mo></mrow><mn id="S2.Ex9.m1.16.16.16.7" xref="S2.Ex9.m1.16.16.16.7.cmml">2</mn></msup></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex9.m1.16b"><apply id="S2.Ex9.m1.16.17.cmml" xref="S2.Ex9.m1.16.17"><eq id="S2.Ex9.m1.16.17.1.cmml" xref="S2.Ex9.m1.16.17.1"></eq><csymbol cd="latexml" id="S2.Ex9.m1.16.17.2.cmml" xref="S2.Ex9.m1.16.17.2">absent</csymbol><apply id="S2.Ex9.m1.16.16.cmml" xref="S2.Ex9.m1.16.16"><divide id="S2.Ex9.m1.16.16.17.cmml" xref="S2.Ex9.m1.16.16"></divide><apply id="S2.Ex9.m1.11.11.11.cmml" xref="S2.Ex9.m1.11.11.11"><apply id="S2.Ex9.m1.11.11.11.12.cmml" xref="S2.Ex9.m1.11.11.11.12"><csymbol cd="ambiguous" id="S2.Ex9.m1.11.11.11.12.1.cmml" xref="S2.Ex9.m1.11.11.11.12">subscript</csymbol><sum id="S2.Ex9.m1.11.11.11.12.2.cmml" xref="S2.Ex9.m1.11.11.11.12.2"></sum><vector id="S2.Ex9.m1.3.3.3.3.3.4.cmml" xref="S2.Ex9.m1.3.3.3.3.3.3"><apply id="S2.Ex9.m1.1.1.1.1.1.1.1.cmml" xref="S2.Ex9.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex9.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex9.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex9.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex9.m1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.Ex9.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex9.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.Ex9.m1.2.2.2.2.2.2.2.cmml" xref="S2.Ex9.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex9.m1.2.2.2.2.2.2.2.1.cmml" xref="S2.Ex9.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S2.Ex9.m1.2.2.2.2.2.2.2.2.cmml" xref="S2.Ex9.m1.2.2.2.2.2.2.2.2">𝑎</ci><ci id="S2.Ex9.m1.2.2.2.2.2.2.2.3.cmml" xref="S2.Ex9.m1.2.2.2.2.2.2.2.3">𝑖</ci></apply><apply id="S2.Ex9.m1.3.3.3.3.3.3.3.cmml" xref="S2.Ex9.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.Ex9.m1.3.3.3.3.3.3.3.1.cmml" xref="S2.Ex9.m1.3.3.3.3.3.3.3">subscript</csymbol><ci id="S2.Ex9.m1.3.3.3.3.3.3.3.2.cmml" xref="S2.Ex9.m1.3.3.3.3.3.3.3.2">𝑟</ci><ci id="S2.Ex9.m1.3.3.3.3.3.3.3.3.cmml" xref="S2.Ex9.m1.3.3.3.3.3.3.3.3">𝑖</ci></apply></vector></apply><apply id="S2.Ex9.m1.11.11.11.11.cmml" xref="S2.Ex9.m1.11.11.11.11"><apply id="S2.Ex9.m1.11.11.11.11.2.cmml" xref="S2.Ex9.m1.11.11.11.11.2"><csymbol cd="ambiguous" id="S2.Ex9.m1.11.11.11.11.2.1.cmml" xref="S2.Ex9.m1.11.11.11.11.2">subscript</csymbol><sum id="S2.Ex9.m1.11.11.11.11.2.2.cmml" xref="S2.Ex9.m1.11.11.11.11.2.2"></sum><vector id="S2.Ex9.m1.6.6.6.6.3.4.cmml" xref="S2.Ex9.m1.6.6.6.6.3.3"><apply id="S2.Ex9.m1.4.4.4.4.1.1.1.cmml" xref="S2.Ex9.m1.4.4.4.4.1.1.1"><csymbol cd="ambiguous" id="S2.Ex9.m1.4.4.4.4.1.1.1.1.cmml" xref="S2.Ex9.m1.4.4.4.4.1.1.1">subscript</csymbol><ci id="S2.Ex9.m1.4.4.4.4.1.1.1.2.cmml" xref="S2.Ex9.m1.4.4.4.4.1.1.1.2">𝑥</ci><ci id="S2.Ex9.m1.4.4.4.4.1.1.1.3.cmml" xref="S2.Ex9.m1.4.4.4.4.1.1.1.3">𝑗</ci></apply><apply id="S2.Ex9.m1.5.5.5.5.2.2.2.cmml" xref="S2.Ex9.m1.5.5.5.5.2.2.2"><csymbol cd="ambiguous" id="S2.Ex9.m1.5.5.5.5.2.2.2.1.cmml" xref="S2.Ex9.m1.5.5.5.5.2.2.2">subscript</csymbol><ci id="S2.Ex9.m1.5.5.5.5.2.2.2.2.cmml" xref="S2.Ex9.m1.5.5.5.5.2.2.2.2">𝑎</ci><ci id="S2.Ex9.m1.5.5.5.5.2.2.2.3.cmml" xref="S2.Ex9.m1.5.5.5.5.2.2.2.3">𝑗</ci></apply><apply id="S2.Ex9.m1.6.6.6.6.3.3.3.cmml" xref="S2.Ex9.m1.6.6.6.6.3.3.3"><csymbol cd="ambiguous" id="S2.Ex9.m1.6.6.6.6.3.3.3.1.cmml" xref="S2.Ex9.m1.6.6.6.6.3.3.3">subscript</csymbol><ci id="S2.Ex9.m1.6.6.6.6.3.3.3.2.cmml" xref="S2.Ex9.m1.6.6.6.6.3.3.3.2">𝑟</ci><ci id="S2.Ex9.m1.6.6.6.6.3.3.3.3.cmml" xref="S2.Ex9.m1.6.6.6.6.3.3.3.3">𝑗</ci></apply></vector></apply><apply id="S2.Ex9.m1.11.11.11.11.1.cmml" xref="S2.Ex9.m1.11.11.11.11.1"><times id="S2.Ex9.m1.11.11.11.11.1.2.cmml" xref="S2.Ex9.m1.11.11.11.11.1.2"></times><apply id="S2.Ex9.m1.10.10.10.10.cmml" xref="S2.Ex9.m1.10.10.10.10"><divide id="S2.Ex9.m1.10.10.10.10.5.cmml" xref="S2.Ex9.m1.10.10.10.10"></divide><apply id="S2.Ex9.m1.8.8.8.8.2.cmml" xref="S2.Ex9.m1.8.8.8.8.2"><times id="S2.Ex9.m1.8.8.8.8.2.3.cmml" xref="S2.Ex9.m1.8.8.8.8.2.3"></times><ci id="S2.Ex9.m1.8.8.8.8.2.4.cmml" xref="S2.Ex9.m1.8.8.8.8.2.4">𝜋</ci><apply id="S2.Ex9.m1.7.7.7.7.1.1.1.1.cmml" xref="S2.Ex9.m1.7.7.7.7.1.1.1"><csymbol cd="latexml" id="S2.Ex9.m1.7.7.7.7.1.1.1.1.1.cmml" xref="S2.Ex9.m1.7.7.7.7.1.1.1.1.1">conditional</csymbol><apply id="S2.Ex9.m1.7.7.7.7.1.1.1.1.2.cmml" xref="S2.Ex9.m1.7.7.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex9.m1.7.7.7.7.1.1.1.1.2.1.cmml" xref="S2.Ex9.m1.7.7.7.7.1.1.1.1.2">subscript</csymbol><ci id="S2.Ex9.m1.7.7.7.7.1.1.1.1.2.2.cmml" xref="S2.Ex9.m1.7.7.7.7.1.1.1.1.2.2">𝑎</ci><ci id="S2.Ex9.m1.7.7.7.7.1.1.1.1.2.3.cmml" xref="S2.Ex9.m1.7.7.7.7.1.1.1.1.2.3">𝑖</ci></apply><apply id="S2.Ex9.m1.7.7.7.7.1.1.1.1.3.cmml" xref="S2.Ex9.m1.7.7.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex9.m1.7.7.7.7.1.1.1.1.3.1.cmml" xref="S2.Ex9.m1.7.7.7.7.1.1.1.1.3">subscript</csymbol><ci id="S2.Ex9.m1.7.7.7.7.1.1.1.1.3.2.cmml" xref="S2.Ex9.m1.7.7.7.7.1.1.1.1.3.2">𝑥</ci><ci id="S2.Ex9.m1.7.7.7.7.1.1.1.1.3.3.cmml" xref="S2.Ex9.m1.7.7.7.7.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S2.Ex9.m1.8.8.8.8.2.5.cmml" xref="S2.Ex9.m1.8.8.8.8.2.5"><ci id="S2.Ex9.m1.8.8.8.8.2.5.1.cmml" xref="S2.Ex9.m1.8.8.8.8.2.5.1">∇</ci><ci id="S2.Ex9.m1.8.8.8.8.2.5.2.cmml" xref="S2.Ex9.m1.8.8.8.8.2.5.2">𝜋</ci></apply><apply id="S2.Ex9.m1.8.8.8.8.2.2.1.1.cmml" xref="S2.Ex9.m1.8.8.8.8.2.2.1"><csymbol cd="latexml" id="S2.Ex9.m1.8.8.8.8.2.2.1.1.1.cmml" xref="S2.Ex9.m1.8.8.8.8.2.2.1.1.1">conditional</csymbol><apply id="S2.Ex9.m1.8.8.8.8.2.2.1.1.2.cmml" xref="S2.Ex9.m1.8.8.8.8.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.Ex9.m1.8.8.8.8.2.2.1.1.2.1.cmml" xref="S2.Ex9.m1.8.8.8.8.2.2.1.1.2">subscript</csymbol><ci id="S2.Ex9.m1.8.8.8.8.2.2.1.1.2.2.cmml" xref="S2.Ex9.m1.8.8.8.8.2.2.1.1.2.2">𝑎</ci><ci id="S2.Ex9.m1.8.8.8.8.2.2.1.1.2.3.cmml" xref="S2.Ex9.m1.8.8.8.8.2.2.1.1.2.3">𝑗</ci></apply><apply id="S2.Ex9.m1.8.8.8.8.2.2.1.1.3.cmml" xref="S2.Ex9.m1.8.8.8.8.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.Ex9.m1.8.8.8.8.2.2.1.1.3.1.cmml" xref="S2.Ex9.m1.8.8.8.8.2.2.1.1.3">subscript</csymbol><ci id="S2.Ex9.m1.8.8.8.8.2.2.1.1.3.2.cmml" xref="S2.Ex9.m1.8.8.8.8.2.2.1.1.3.2">𝑥</ci><ci id="S2.Ex9.m1.8.8.8.8.2.2.1.1.3.3.cmml" xref="S2.Ex9.m1.8.8.8.8.2.2.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S2.Ex9.m1.10.10.10.10.4.cmml" xref="S2.Ex9.m1.10.10.10.10.4"><times id="S2.Ex9.m1.10.10.10.10.4.3.cmml" xref="S2.Ex9.m1.10.10.10.10.4.3"></times><apply id="S2.Ex9.m1.10.10.10.10.4.4.cmml" xref="S2.Ex9.m1.10.10.10.10.4.4"><csymbol cd="ambiguous" id="S2.Ex9.m1.10.10.10.10.4.4.1.cmml" xref="S2.Ex9.m1.10.10.10.10.4.4">subscript</csymbol><ci id="S2.Ex9.m1.10.10.10.10.4.4.2.cmml" xref="S2.Ex9.m1.10.10.10.10.4.4.2">𝜋</ci><cn id="S2.Ex9.m1.10.10.10.10.4.4.3.cmml" type="integer" xref="S2.Ex9.m1.10.10.10.10.4.4.3">0</cn></apply><apply id="S2.Ex9.m1.9.9.9.9.3.1.1.1.cmml" xref="S2.Ex9.m1.9.9.9.9.3.1.1"><csymbol cd="latexml" id="S2.Ex9.m1.9.9.9.9.3.1.1.1.1.cmml" xref="S2.Ex9.m1.9.9.9.9.3.1.1.1.1">conditional</csymbol><apply id="S2.Ex9.m1.9.9.9.9.3.1.1.1.2.cmml" xref="S2.Ex9.m1.9.9.9.9.3.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex9.m1.9.9.9.9.3.1.1.1.2.1.cmml" xref="S2.Ex9.m1.9.9.9.9.3.1.1.1.2">subscript</csymbol><ci id="S2.Ex9.m1.9.9.9.9.3.1.1.1.2.2.cmml" xref="S2.Ex9.m1.9.9.9.9.3.1.1.1.2.2">𝑎</ci><ci id="S2.Ex9.m1.9.9.9.9.3.1.1.1.2.3.cmml" xref="S2.Ex9.m1.9.9.9.9.3.1.1.1.2.3">𝑖</ci></apply><apply id="S2.Ex9.m1.9.9.9.9.3.1.1.1.3.cmml" xref="S2.Ex9.m1.9.9.9.9.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex9.m1.9.9.9.9.3.1.1.1.3.1.cmml" xref="S2.Ex9.m1.9.9.9.9.3.1.1.1.3">subscript</csymbol><ci id="S2.Ex9.m1.9.9.9.9.3.1.1.1.3.2.cmml" xref="S2.Ex9.m1.9.9.9.9.3.1.1.1.3.2">𝑥</ci><ci id="S2.Ex9.m1.9.9.9.9.3.1.1.1.3.3.cmml" xref="S2.Ex9.m1.9.9.9.9.3.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S2.Ex9.m1.10.10.10.10.4.5.cmml" xref="S2.Ex9.m1.10.10.10.10.4.5"><csymbol cd="ambiguous" id="S2.Ex9.m1.10.10.10.10.4.5.1.cmml" xref="S2.Ex9.m1.10.10.10.10.4.5">subscript</csymbol><ci id="S2.Ex9.m1.10.10.10.10.4.5.2.cmml" xref="S2.Ex9.m1.10.10.10.10.4.5.2">𝜋</ci><cn id="S2.Ex9.m1.10.10.10.10.4.5.3.cmml" type="integer" xref="S2.Ex9.m1.10.10.10.10.4.5.3">0</cn></apply><apply id="S2.Ex9.m1.10.10.10.10.4.2.1.1.cmml" xref="S2.Ex9.m1.10.10.10.10.4.2.1"><csymbol cd="latexml" id="S2.Ex9.m1.10.10.10.10.4.2.1.1.1.cmml" xref="S2.Ex9.m1.10.10.10.10.4.2.1.1.1">conditional</csymbol><apply id="S2.Ex9.m1.10.10.10.10.4.2.1.1.2.cmml" xref="S2.Ex9.m1.10.10.10.10.4.2.1.1.2"><csymbol cd="ambiguous" id="S2.Ex9.m1.10.10.10.10.4.2.1.1.2.1.cmml" xref="S2.Ex9.m1.10.10.10.10.4.2.1.1.2">subscript</csymbol><ci id="S2.Ex9.m1.10.10.10.10.4.2.1.1.2.2.cmml" xref="S2.Ex9.m1.10.10.10.10.4.2.1.1.2.2">𝑎</ci><ci id="S2.Ex9.m1.10.10.10.10.4.2.1.1.2.3.cmml" xref="S2.Ex9.m1.10.10.10.10.4.2.1.1.2.3">𝑗</ci></apply><apply id="S2.Ex9.m1.10.10.10.10.4.2.1.1.3.cmml" xref="S2.Ex9.m1.10.10.10.10.4.2.1.1.3"><csymbol cd="ambiguous" id="S2.Ex9.m1.10.10.10.10.4.2.1.1.3.1.cmml" xref="S2.Ex9.m1.10.10.10.10.4.2.1.1.3">subscript</csymbol><ci id="S2.Ex9.m1.10.10.10.10.4.2.1.1.3.2.cmml" xref="S2.Ex9.m1.10.10.10.10.4.2.1.1.3.2">𝑥</ci><ci id="S2.Ex9.m1.10.10.10.10.4.2.1.1.3.3.cmml" xref="S2.Ex9.m1.10.10.10.10.4.2.1.1.3.3">𝑗</ci></apply></apply></apply></apply><apply id="S2.Ex9.m1.11.11.11.11.1.1.1.1.cmml" xref="S2.Ex9.m1.11.11.11.11.1.1.1"><minus id="S2.Ex9.m1.11.11.11.11.1.1.1.1.1.cmml" xref="S2.Ex9.m1.11.11.11.11.1.1.1.1.1"></minus><apply id="S2.Ex9.m1.11.11.11.11.1.1.1.1.2.cmml" xref="S2.Ex9.m1.11.11.11.11.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex9.m1.11.11.11.11.1.1.1.1.2.1.cmml" xref="S2.Ex9.m1.11.11.11.11.1.1.1.1.2">subscript</csymbol><ci id="S2.Ex9.m1.11.11.11.11.1.1.1.1.2.2.cmml" xref="S2.Ex9.m1.11.11.11.11.1.1.1.1.2.2">𝑟</ci><ci id="S2.Ex9.m1.11.11.11.11.1.1.1.1.2.3.cmml" xref="S2.Ex9.m1.11.11.11.11.1.1.1.1.2.3">𝑗</ci></apply><apply id="S2.Ex9.m1.11.11.11.11.1.1.1.1.3.cmml" xref="S2.Ex9.m1.11.11.11.11.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex9.m1.11.11.11.11.1.1.1.1.3.1.cmml" xref="S2.Ex9.m1.11.11.11.11.1.1.1.1.3">subscript</csymbol><ci id="S2.Ex9.m1.11.11.11.11.1.1.1.1.3.2.cmml" xref="S2.Ex9.m1.11.11.11.11.1.1.1.1.3.2">𝑟</ci><ci id="S2.Ex9.m1.11.11.11.11.1.1.1.1.3.3.cmml" xref="S2.Ex9.m1.11.11.11.11.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S2.Ex9.m1.16.16.16.cmml" xref="S2.Ex9.m1.16.16.16"><csymbol cd="ambiguous" id="S2.Ex9.m1.16.16.16.6.cmml" xref="S2.Ex9.m1.16.16.16">superscript</csymbol><apply id="S2.Ex9.m1.16.16.16.5.1.1.cmml" xref="S2.Ex9.m1.16.16.16.5.1"><apply id="S2.Ex9.m1.16.16.16.5.1.1.1.cmml" xref="S2.Ex9.m1.16.16.16.5.1.1.1"><csymbol cd="ambiguous" id="S2.Ex9.m1.16.16.16.5.1.1.1.1.cmml" xref="S2.Ex9.m1.16.16.16.5.1.1.1">subscript</csymbol><sum id="S2.Ex9.m1.16.16.16.5.1.1.1.2.cmml" xref="S2.Ex9.m1.16.16.16.5.1.1.1.2"></sum><interval closure="open" id="S2.Ex9.m1.13.13.13.2.2.3.cmml" xref="S2.Ex9.m1.13.13.13.2.2.4"><ci id="S2.Ex9.m1.12.12.12.1.1.1.cmml" xref="S2.Ex9.m1.12.12.12.1.1.1">𝑥</ci><ci id="S2.Ex9.m1.13.13.13.2.2.2.cmml" xref="S2.Ex9.m1.13.13.13.2.2.2">𝑎</ci></interval></apply><apply id="S2.Ex9.m1.15.15.15.4.cmml" xref="S2.Ex9.m1.15.15.15.4"><divide id="S2.Ex9.m1.15.15.15.4.3.cmml" xref="S2.Ex9.m1.15.15.15.4"></divide><apply id="S2.Ex9.m1.14.14.14.3.1.cmml" xref="S2.Ex9.m1.14.14.14.3.1"><times id="S2.Ex9.m1.14.14.14.3.1.2.cmml" xref="S2.Ex9.m1.14.14.14.3.1.2"></times><ci id="S2.Ex9.m1.14.14.14.3.1.3.cmml" xref="S2.Ex9.m1.14.14.14.3.1.3">𝜋</ci><apply id="S2.Ex9.m1.14.14.14.3.1.1.1.1.cmml" xref="S2.Ex9.m1.14.14.14.3.1.1.1"><csymbol cd="latexml" id="S2.Ex9.m1.14.14.14.3.1.1.1.1.1.cmml" xref="S2.Ex9.m1.14.14.14.3.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex9.m1.14.14.14.3.1.1.1.1.2.cmml" xref="S2.Ex9.m1.14.14.14.3.1.1.1.1.2">𝑎</ci><ci id="S2.Ex9.m1.14.14.14.3.1.1.1.1.3.cmml" xref="S2.Ex9.m1.14.14.14.3.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.Ex9.m1.15.15.15.4.2.cmml" xref="S2.Ex9.m1.15.15.15.4.2"><times id="S2.Ex9.m1.15.15.15.4.2.2.cmml" xref="S2.Ex9.m1.15.15.15.4.2.2"></times><apply id="S2.Ex9.m1.15.15.15.4.2.3.cmml" xref="S2.Ex9.m1.15.15.15.4.2.3"><csymbol cd="ambiguous" id="S2.Ex9.m1.15.15.15.4.2.3.1.cmml" xref="S2.Ex9.m1.15.15.15.4.2.3">subscript</csymbol><ci id="S2.Ex9.m1.15.15.15.4.2.3.2.cmml" xref="S2.Ex9.m1.15.15.15.4.2.3.2">𝜋</ci><cn id="S2.Ex9.m1.15.15.15.4.2.3.3.cmml" type="integer" xref="S2.Ex9.m1.15.15.15.4.2.3.3">0</cn></apply><apply id="S2.Ex9.m1.15.15.15.4.2.1.1.1.cmml" xref="S2.Ex9.m1.15.15.15.4.2.1.1"><csymbol cd="latexml" id="S2.Ex9.m1.15.15.15.4.2.1.1.1.1.cmml" xref="S2.Ex9.m1.15.15.15.4.2.1.1.1.1">conditional</csymbol><ci id="S2.Ex9.m1.15.15.15.4.2.1.1.1.2.cmml" xref="S2.Ex9.m1.15.15.15.4.2.1.1.1.2">𝑎</ci><ci id="S2.Ex9.m1.15.15.15.4.2.1.1.1.3.cmml" xref="S2.Ex9.m1.15.15.15.4.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply><cn id="S2.Ex9.m1.16.16.16.7.cmml" type="integer" xref="S2.Ex9.m1.16.16.16.7">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex9.m1.16c">\displaystyle=\frac{\sum_{(x_{i},a_{i},r_{i})}\sum_{(x_{j},a_{j},r_{j})}\frac{%
\pi(a_{i}|x_{i})\nabla\pi(a_{j}|x_{j})}{\pi_{0}(a_{i}|x_{i})\pi_{0}(a_{j}|x_{j%
})}(r_{j}-r_{i})}{\left({\sum_{(x,a)}\frac{\pi(a|x)}{\pi_{0}(a|x)}}\right)^{2}}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex9.m1.16d">= divide start_ARG ∑ start_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT divide start_ARG italic_π ( italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ∇ italic_π ( italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG ( italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG start_ARG ( ∑ start_POSTSUBSCRIPT ( italic_x , italic_a ) end_POSTSUBSCRIPT divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\sum\limits_{(x_{i},a_{i},r_{i})}\sum\limits_{(x_{j},a_{j}%
,r_{j})}\frac{\pi(a_{i}|x_{i})\pi(a_{j}|x_{j})}{\pi_{0}(a_{i}|x_{i})\pi_{0}(a_%
{j}|x_{j})}\nabla\log\pi(a_{j}|x_{j})(r_{j}-r_{i})}{\left({\sum_{(x,a)}\frac{%
\pi(a|x)}{\pi_{0}(a|x)}}\right)^{2}}." class="ltx_Math" display="inline" id="S2.Ex10.m1.18"><semantics id="S2.Ex10.m1.18a"><mrow id="S2.Ex10.m1.18.18.1" xref="S2.Ex10.m1.18.18.1.1.cmml"><mrow id="S2.Ex10.m1.18.18.1.1" xref="S2.Ex10.m1.18.18.1.1.cmml"><mi id="S2.Ex10.m1.18.18.1.1.2" xref="S2.Ex10.m1.18.18.1.1.2.cmml"></mi><mo id="S2.Ex10.m1.18.18.1.1.1" xref="S2.Ex10.m1.18.18.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S2.Ex10.m1.17.17" xref="S2.Ex10.m1.17.17.cmml"><mfrac id="S2.Ex10.m1.17.17a" xref="S2.Ex10.m1.17.17.cmml"><mrow id="S2.Ex10.m1.12.12.12" xref="S2.Ex10.m1.12.12.12.cmml"><munder id="S2.Ex10.m1.12.12.12.13" xref="S2.Ex10.m1.12.12.12.13.cmml"><mo id="S2.Ex10.m1.12.12.12.13.2" movablelimits="false" xref="S2.Ex10.m1.12.12.12.13.2.cmml">∑</mo><mrow id="S2.Ex10.m1.3.3.3.3.3.3" xref="S2.Ex10.m1.3.3.3.3.3.4.cmml"><mo id="S2.Ex10.m1.3.3.3.3.3.3.4" stretchy="false" xref="S2.Ex10.m1.3.3.3.3.3.4.cmml">(</mo><msub id="S2.Ex10.m1.1.1.1.1.1.1.1" xref="S2.Ex10.m1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex10.m1.1.1.1.1.1.1.1.2" xref="S2.Ex10.m1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.Ex10.m1.1.1.1.1.1.1.1.3" xref="S2.Ex10.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.Ex10.m1.3.3.3.3.3.3.5" xref="S2.Ex10.m1.3.3.3.3.3.4.cmml">,</mo><msub id="S2.Ex10.m1.2.2.2.2.2.2.2" xref="S2.Ex10.m1.2.2.2.2.2.2.2.cmml"><mi id="S2.Ex10.m1.2.2.2.2.2.2.2.2" xref="S2.Ex10.m1.2.2.2.2.2.2.2.2.cmml">a</mi><mi id="S2.Ex10.m1.2.2.2.2.2.2.2.3" xref="S2.Ex10.m1.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S2.Ex10.m1.3.3.3.3.3.3.6" xref="S2.Ex10.m1.3.3.3.3.3.4.cmml">,</mo><msub id="S2.Ex10.m1.3.3.3.3.3.3.3" xref="S2.Ex10.m1.3.3.3.3.3.3.3.cmml"><mi id="S2.Ex10.m1.3.3.3.3.3.3.3.2" xref="S2.Ex10.m1.3.3.3.3.3.3.3.2.cmml">r</mi><mi id="S2.Ex10.m1.3.3.3.3.3.3.3.3" xref="S2.Ex10.m1.3.3.3.3.3.3.3.3.cmml">i</mi></msub><mo id="S2.Ex10.m1.3.3.3.3.3.3.7" stretchy="false" xref="S2.Ex10.m1.3.3.3.3.3.4.cmml">)</mo></mrow></munder><mrow id="S2.Ex10.m1.12.12.12.12" xref="S2.Ex10.m1.12.12.12.12.cmml"><munder id="S2.Ex10.m1.12.12.12.12.3" xref="S2.Ex10.m1.12.12.12.12.3.cmml"><mo id="S2.Ex10.m1.12.12.12.12.3.2" lspace="0.167em" movablelimits="false" xref="S2.Ex10.m1.12.12.12.12.3.2.cmml">∑</mo><mrow id="S2.Ex10.m1.6.6.6.6.3.3" xref="S2.Ex10.m1.6.6.6.6.3.4.cmml"><mo id="S2.Ex10.m1.6.6.6.6.3.3.4" stretchy="false" xref="S2.Ex10.m1.6.6.6.6.3.4.cmml">(</mo><msub id="S2.Ex10.m1.4.4.4.4.1.1.1" xref="S2.Ex10.m1.4.4.4.4.1.1.1.cmml"><mi id="S2.Ex10.m1.4.4.4.4.1.1.1.2" xref="S2.Ex10.m1.4.4.4.4.1.1.1.2.cmml">x</mi><mi id="S2.Ex10.m1.4.4.4.4.1.1.1.3" xref="S2.Ex10.m1.4.4.4.4.1.1.1.3.cmml">j</mi></msub><mo id="S2.Ex10.m1.6.6.6.6.3.3.5" xref="S2.Ex10.m1.6.6.6.6.3.4.cmml">,</mo><msub id="S2.Ex10.m1.5.5.5.5.2.2.2" xref="S2.Ex10.m1.5.5.5.5.2.2.2.cmml"><mi id="S2.Ex10.m1.5.5.5.5.2.2.2.2" xref="S2.Ex10.m1.5.5.5.5.2.2.2.2.cmml">a</mi><mi id="S2.Ex10.m1.5.5.5.5.2.2.2.3" xref="S2.Ex10.m1.5.5.5.5.2.2.2.3.cmml">j</mi></msub><mo id="S2.Ex10.m1.6.6.6.6.3.3.6" xref="S2.Ex10.m1.6.6.6.6.3.4.cmml">,</mo><msub id="S2.Ex10.m1.6.6.6.6.3.3.3" xref="S2.Ex10.m1.6.6.6.6.3.3.3.cmml"><mi id="S2.Ex10.m1.6.6.6.6.3.3.3.2" xref="S2.Ex10.m1.6.6.6.6.3.3.3.2.cmml">r</mi><mi id="S2.Ex10.m1.6.6.6.6.3.3.3.3" xref="S2.Ex10.m1.6.6.6.6.3.3.3.3.cmml">j</mi></msub><mo id="S2.Ex10.m1.6.6.6.6.3.3.7" stretchy="false" xref="S2.Ex10.m1.6.6.6.6.3.4.cmml">)</mo></mrow></munder><mrow id="S2.Ex10.m1.12.12.12.12.2" xref="S2.Ex10.m1.12.12.12.12.2.cmml"><mfrac id="S2.Ex10.m1.10.10.10.10" xref="S2.Ex10.m1.10.10.10.10.cmml"><mrow id="S2.Ex10.m1.8.8.8.8.2" xref="S2.Ex10.m1.8.8.8.8.2.cmml"><mi id="S2.Ex10.m1.8.8.8.8.2.4" xref="S2.Ex10.m1.8.8.8.8.2.4.cmml">π</mi><mo id="S2.Ex10.m1.8.8.8.8.2.3" xref="S2.Ex10.m1.8.8.8.8.2.3.cmml">⁢</mo><mrow id="S2.Ex10.m1.7.7.7.7.1.1.1" xref="S2.Ex10.m1.7.7.7.7.1.1.1.1.cmml"><mo id="S2.Ex10.m1.7.7.7.7.1.1.1.2" stretchy="false" xref="S2.Ex10.m1.7.7.7.7.1.1.1.1.cmml">(</mo><mrow id="S2.Ex10.m1.7.7.7.7.1.1.1.1" xref="S2.Ex10.m1.7.7.7.7.1.1.1.1.cmml"><msub id="S2.Ex10.m1.7.7.7.7.1.1.1.1.2" xref="S2.Ex10.m1.7.7.7.7.1.1.1.1.2.cmml"><mi id="S2.Ex10.m1.7.7.7.7.1.1.1.1.2.2" xref="S2.Ex10.m1.7.7.7.7.1.1.1.1.2.2.cmml">a</mi><mi id="S2.Ex10.m1.7.7.7.7.1.1.1.1.2.3" xref="S2.Ex10.m1.7.7.7.7.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S2.Ex10.m1.7.7.7.7.1.1.1.1.1" xref="S2.Ex10.m1.7.7.7.7.1.1.1.1.1.cmml">|</mo><msub id="S2.Ex10.m1.7.7.7.7.1.1.1.1.3" xref="S2.Ex10.m1.7.7.7.7.1.1.1.1.3.cmml"><mi id="S2.Ex10.m1.7.7.7.7.1.1.1.1.3.2" xref="S2.Ex10.m1.7.7.7.7.1.1.1.1.3.2.cmml">x</mi><mi id="S2.Ex10.m1.7.7.7.7.1.1.1.1.3.3" xref="S2.Ex10.m1.7.7.7.7.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S2.Ex10.m1.7.7.7.7.1.1.1.3" stretchy="false" xref="S2.Ex10.m1.7.7.7.7.1.1.1.1.cmml">)</mo></mrow><mo id="S2.Ex10.m1.8.8.8.8.2.3a" xref="S2.Ex10.m1.8.8.8.8.2.3.cmml">⁢</mo><mi id="S2.Ex10.m1.8.8.8.8.2.5" xref="S2.Ex10.m1.8.8.8.8.2.5.cmml">π</mi><mo id="S2.Ex10.m1.8.8.8.8.2.3b" xref="S2.Ex10.m1.8.8.8.8.2.3.cmml">⁢</mo><mrow id="S2.Ex10.m1.8.8.8.8.2.2.1" xref="S2.Ex10.m1.8.8.8.8.2.2.1.1.cmml"><mo id="S2.Ex10.m1.8.8.8.8.2.2.1.2" stretchy="false" xref="S2.Ex10.m1.8.8.8.8.2.2.1.1.cmml">(</mo><mrow id="S2.Ex10.m1.8.8.8.8.2.2.1.1" xref="S2.Ex10.m1.8.8.8.8.2.2.1.1.cmml"><msub id="S2.Ex10.m1.8.8.8.8.2.2.1.1.2" xref="S2.Ex10.m1.8.8.8.8.2.2.1.1.2.cmml"><mi id="S2.Ex10.m1.8.8.8.8.2.2.1.1.2.2" xref="S2.Ex10.m1.8.8.8.8.2.2.1.1.2.2.cmml">a</mi><mi id="S2.Ex10.m1.8.8.8.8.2.2.1.1.2.3" xref="S2.Ex10.m1.8.8.8.8.2.2.1.1.2.3.cmml">j</mi></msub><mo fence="false" id="S2.Ex10.m1.8.8.8.8.2.2.1.1.1" xref="S2.Ex10.m1.8.8.8.8.2.2.1.1.1.cmml">|</mo><msub id="S2.Ex10.m1.8.8.8.8.2.2.1.1.3" xref="S2.Ex10.m1.8.8.8.8.2.2.1.1.3.cmml"><mi id="S2.Ex10.m1.8.8.8.8.2.2.1.1.3.2" xref="S2.Ex10.m1.8.8.8.8.2.2.1.1.3.2.cmml">x</mi><mi id="S2.Ex10.m1.8.8.8.8.2.2.1.1.3.3" xref="S2.Ex10.m1.8.8.8.8.2.2.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S2.Ex10.m1.8.8.8.8.2.2.1.3" stretchy="false" xref="S2.Ex10.m1.8.8.8.8.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.Ex10.m1.10.10.10.10.4" xref="S2.Ex10.m1.10.10.10.10.4.cmml"><msub id="S2.Ex10.m1.10.10.10.10.4.4" xref="S2.Ex10.m1.10.10.10.10.4.4.cmml"><mi id="S2.Ex10.m1.10.10.10.10.4.4.2" xref="S2.Ex10.m1.10.10.10.10.4.4.2.cmml">π</mi><mn id="S2.Ex10.m1.10.10.10.10.4.4.3" xref="S2.Ex10.m1.10.10.10.10.4.4.3.cmml">0</mn></msub><mo id="S2.Ex10.m1.10.10.10.10.4.3" xref="S2.Ex10.m1.10.10.10.10.4.3.cmml">⁢</mo><mrow id="S2.Ex10.m1.9.9.9.9.3.1.1" xref="S2.Ex10.m1.9.9.9.9.3.1.1.1.cmml"><mo id="S2.Ex10.m1.9.9.9.9.3.1.1.2" stretchy="false" xref="S2.Ex10.m1.9.9.9.9.3.1.1.1.cmml">(</mo><mrow id="S2.Ex10.m1.9.9.9.9.3.1.1.1" xref="S2.Ex10.m1.9.9.9.9.3.1.1.1.cmml"><msub id="S2.Ex10.m1.9.9.9.9.3.1.1.1.2" xref="S2.Ex10.m1.9.9.9.9.3.1.1.1.2.cmml"><mi id="S2.Ex10.m1.9.9.9.9.3.1.1.1.2.2" xref="S2.Ex10.m1.9.9.9.9.3.1.1.1.2.2.cmml">a</mi><mi id="S2.Ex10.m1.9.9.9.9.3.1.1.1.2.3" xref="S2.Ex10.m1.9.9.9.9.3.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S2.Ex10.m1.9.9.9.9.3.1.1.1.1" xref="S2.Ex10.m1.9.9.9.9.3.1.1.1.1.cmml">|</mo><msub id="S2.Ex10.m1.9.9.9.9.3.1.1.1.3" xref="S2.Ex10.m1.9.9.9.9.3.1.1.1.3.cmml"><mi id="S2.Ex10.m1.9.9.9.9.3.1.1.1.3.2" xref="S2.Ex10.m1.9.9.9.9.3.1.1.1.3.2.cmml">x</mi><mi id="S2.Ex10.m1.9.9.9.9.3.1.1.1.3.3" xref="S2.Ex10.m1.9.9.9.9.3.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S2.Ex10.m1.9.9.9.9.3.1.1.3" stretchy="false" xref="S2.Ex10.m1.9.9.9.9.3.1.1.1.cmml">)</mo></mrow><mo id="S2.Ex10.m1.10.10.10.10.4.3a" xref="S2.Ex10.m1.10.10.10.10.4.3.cmml">⁢</mo><msub id="S2.Ex10.m1.10.10.10.10.4.5" xref="S2.Ex10.m1.10.10.10.10.4.5.cmml"><mi id="S2.Ex10.m1.10.10.10.10.4.5.2" xref="S2.Ex10.m1.10.10.10.10.4.5.2.cmml">π</mi><mn id="S2.Ex10.m1.10.10.10.10.4.5.3" xref="S2.Ex10.m1.10.10.10.10.4.5.3.cmml">0</mn></msub><mo id="S2.Ex10.m1.10.10.10.10.4.3b" xref="S2.Ex10.m1.10.10.10.10.4.3.cmml">⁢</mo><mrow id="S2.Ex10.m1.10.10.10.10.4.2.1" xref="S2.Ex10.m1.10.10.10.10.4.2.1.1.cmml"><mo id="S2.Ex10.m1.10.10.10.10.4.2.1.2" stretchy="false" xref="S2.Ex10.m1.10.10.10.10.4.2.1.1.cmml">(</mo><mrow id="S2.Ex10.m1.10.10.10.10.4.2.1.1" xref="S2.Ex10.m1.10.10.10.10.4.2.1.1.cmml"><msub id="S2.Ex10.m1.10.10.10.10.4.2.1.1.2" xref="S2.Ex10.m1.10.10.10.10.4.2.1.1.2.cmml"><mi id="S2.Ex10.m1.10.10.10.10.4.2.1.1.2.2" xref="S2.Ex10.m1.10.10.10.10.4.2.1.1.2.2.cmml">a</mi><mi id="S2.Ex10.m1.10.10.10.10.4.2.1.1.2.3" xref="S2.Ex10.m1.10.10.10.10.4.2.1.1.2.3.cmml">j</mi></msub><mo fence="false" id="S2.Ex10.m1.10.10.10.10.4.2.1.1.1" xref="S2.Ex10.m1.10.10.10.10.4.2.1.1.1.cmml">|</mo><msub id="S2.Ex10.m1.10.10.10.10.4.2.1.1.3" xref="S2.Ex10.m1.10.10.10.10.4.2.1.1.3.cmml"><mi id="S2.Ex10.m1.10.10.10.10.4.2.1.1.3.2" xref="S2.Ex10.m1.10.10.10.10.4.2.1.1.3.2.cmml">x</mi><mi id="S2.Ex10.m1.10.10.10.10.4.2.1.1.3.3" xref="S2.Ex10.m1.10.10.10.10.4.2.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S2.Ex10.m1.10.10.10.10.4.2.1.3" stretchy="false" xref="S2.Ex10.m1.10.10.10.10.4.2.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S2.Ex10.m1.12.12.12.12.2.3" lspace="0.167em" xref="S2.Ex10.m1.12.12.12.12.2.3.cmml">⁢</mo><mrow id="S2.Ex10.m1.12.12.12.12.2.4" xref="S2.Ex10.m1.12.12.12.12.2.4.cmml"><mrow id="S2.Ex10.m1.12.12.12.12.2.4.1" xref="S2.Ex10.m1.12.12.12.12.2.4.1.cmml"><mo id="S2.Ex10.m1.12.12.12.12.2.4.1.1" rspace="0.167em" xref="S2.Ex10.m1.12.12.12.12.2.4.1.1.cmml">∇</mo><mi id="S2.Ex10.m1.12.12.12.12.2.4.1.2" xref="S2.Ex10.m1.12.12.12.12.2.4.1.2.cmml">log</mi></mrow><mo id="S2.Ex10.m1.12.12.12.12.2.4a" lspace="0.167em" xref="S2.Ex10.m1.12.12.12.12.2.4.cmml">⁡</mo><mi id="S2.Ex10.m1.12.12.12.12.2.4.2" xref="S2.Ex10.m1.12.12.12.12.2.4.2.cmml">π</mi></mrow><mo id="S2.Ex10.m1.12.12.12.12.2.3a" xref="S2.Ex10.m1.12.12.12.12.2.3.cmml">⁢</mo><mrow id="S2.Ex10.m1.11.11.11.11.1.1.1" xref="S2.Ex10.m1.11.11.11.11.1.1.1.1.cmml"><mo id="S2.Ex10.m1.11.11.11.11.1.1.1.2" stretchy="false" xref="S2.Ex10.m1.11.11.11.11.1.1.1.1.cmml">(</mo><mrow id="S2.Ex10.m1.11.11.11.11.1.1.1.1" xref="S2.Ex10.m1.11.11.11.11.1.1.1.1.cmml"><msub id="S2.Ex10.m1.11.11.11.11.1.1.1.1.2" xref="S2.Ex10.m1.11.11.11.11.1.1.1.1.2.cmml"><mi id="S2.Ex10.m1.11.11.11.11.1.1.1.1.2.2" xref="S2.Ex10.m1.11.11.11.11.1.1.1.1.2.2.cmml">a</mi><mi id="S2.Ex10.m1.11.11.11.11.1.1.1.1.2.3" xref="S2.Ex10.m1.11.11.11.11.1.1.1.1.2.3.cmml">j</mi></msub><mo fence="false" id="S2.Ex10.m1.11.11.11.11.1.1.1.1.1" xref="S2.Ex10.m1.11.11.11.11.1.1.1.1.1.cmml">|</mo><msub id="S2.Ex10.m1.11.11.11.11.1.1.1.1.3" xref="S2.Ex10.m1.11.11.11.11.1.1.1.1.3.cmml"><mi id="S2.Ex10.m1.11.11.11.11.1.1.1.1.3.2" xref="S2.Ex10.m1.11.11.11.11.1.1.1.1.3.2.cmml">x</mi><mi id="S2.Ex10.m1.11.11.11.11.1.1.1.1.3.3" xref="S2.Ex10.m1.11.11.11.11.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S2.Ex10.m1.11.11.11.11.1.1.1.3" stretchy="false" xref="S2.Ex10.m1.11.11.11.11.1.1.1.1.cmml">)</mo></mrow><mo id="S2.Ex10.m1.12.12.12.12.2.3b" xref="S2.Ex10.m1.12.12.12.12.2.3.cmml">⁢</mo><mrow id="S2.Ex10.m1.12.12.12.12.2.2.1" xref="S2.Ex10.m1.12.12.12.12.2.2.1.1.cmml"><mo id="S2.Ex10.m1.12.12.12.12.2.2.1.2" stretchy="false" xref="S2.Ex10.m1.12.12.12.12.2.2.1.1.cmml">(</mo><mrow id="S2.Ex10.m1.12.12.12.12.2.2.1.1" xref="S2.Ex10.m1.12.12.12.12.2.2.1.1.cmml"><msub id="S2.Ex10.m1.12.12.12.12.2.2.1.1.2" xref="S2.Ex10.m1.12.12.12.12.2.2.1.1.2.cmml"><mi id="S2.Ex10.m1.12.12.12.12.2.2.1.1.2.2" xref="S2.Ex10.m1.12.12.12.12.2.2.1.1.2.2.cmml">r</mi><mi id="S2.Ex10.m1.12.12.12.12.2.2.1.1.2.3" xref="S2.Ex10.m1.12.12.12.12.2.2.1.1.2.3.cmml">j</mi></msub><mo id="S2.Ex10.m1.12.12.12.12.2.2.1.1.1" xref="S2.Ex10.m1.12.12.12.12.2.2.1.1.1.cmml">−</mo><msub id="S2.Ex10.m1.12.12.12.12.2.2.1.1.3" xref="S2.Ex10.m1.12.12.12.12.2.2.1.1.3.cmml"><mi id="S2.Ex10.m1.12.12.12.12.2.2.1.1.3.2" xref="S2.Ex10.m1.12.12.12.12.2.2.1.1.3.2.cmml">r</mi><mi id="S2.Ex10.m1.12.12.12.12.2.2.1.1.3.3" xref="S2.Ex10.m1.12.12.12.12.2.2.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S2.Ex10.m1.12.12.12.12.2.2.1.3" stretchy="false" xref="S2.Ex10.m1.12.12.12.12.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><msup id="S2.Ex10.m1.17.17.17" xref="S2.Ex10.m1.17.17.17.cmml"><mrow id="S2.Ex10.m1.17.17.17.5.1" xref="S2.Ex10.m1.17.17.17.5.1.1.cmml"><mo id="S2.Ex10.m1.17.17.17.5.1.2" xref="S2.Ex10.m1.17.17.17.5.1.1.cmml">(</mo><mrow id="S2.Ex10.m1.17.17.17.5.1.1" xref="S2.Ex10.m1.17.17.17.5.1.1.cmml"><msub id="S2.Ex10.m1.17.17.17.5.1.1.1" xref="S2.Ex10.m1.17.17.17.5.1.1.1.cmml"><mo id="S2.Ex10.m1.17.17.17.5.1.1.1.2" lspace="0em" xref="S2.Ex10.m1.17.17.17.5.1.1.1.2.cmml">∑</mo><mrow id="S2.Ex10.m1.14.14.14.2.2.4" xref="S2.Ex10.m1.14.14.14.2.2.3.cmml"><mo id="S2.Ex10.m1.14.14.14.2.2.4.1" stretchy="false" xref="S2.Ex10.m1.14.14.14.2.2.3.cmml">(</mo><mi id="S2.Ex10.m1.13.13.13.1.1.1" xref="S2.Ex10.m1.13.13.13.1.1.1.cmml">x</mi><mo id="S2.Ex10.m1.14.14.14.2.2.4.2" xref="S2.Ex10.m1.14.14.14.2.2.3.cmml">,</mo><mi id="S2.Ex10.m1.14.14.14.2.2.2" xref="S2.Ex10.m1.14.14.14.2.2.2.cmml">a</mi><mo id="S2.Ex10.m1.14.14.14.2.2.4.3" stretchy="false" xref="S2.Ex10.m1.14.14.14.2.2.3.cmml">)</mo></mrow></msub><mfrac id="S2.Ex10.m1.16.16.16.4" xref="S2.Ex10.m1.16.16.16.4.cmml"><mrow id="S2.Ex10.m1.15.15.15.3.1" xref="S2.Ex10.m1.15.15.15.3.1.cmml"><mi id="S2.Ex10.m1.15.15.15.3.1.3" xref="S2.Ex10.m1.15.15.15.3.1.3.cmml">π</mi><mo id="S2.Ex10.m1.15.15.15.3.1.2" xref="S2.Ex10.m1.15.15.15.3.1.2.cmml">⁢</mo><mrow id="S2.Ex10.m1.15.15.15.3.1.1.1" xref="S2.Ex10.m1.15.15.15.3.1.1.1.1.cmml"><mo id="S2.Ex10.m1.15.15.15.3.1.1.1.2" stretchy="false" xref="S2.Ex10.m1.15.15.15.3.1.1.1.1.cmml">(</mo><mrow id="S2.Ex10.m1.15.15.15.3.1.1.1.1" xref="S2.Ex10.m1.15.15.15.3.1.1.1.1.cmml"><mi id="S2.Ex10.m1.15.15.15.3.1.1.1.1.2" xref="S2.Ex10.m1.15.15.15.3.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.Ex10.m1.15.15.15.3.1.1.1.1.1" xref="S2.Ex10.m1.15.15.15.3.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex10.m1.15.15.15.3.1.1.1.1.3" xref="S2.Ex10.m1.15.15.15.3.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex10.m1.15.15.15.3.1.1.1.3" stretchy="false" xref="S2.Ex10.m1.15.15.15.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.Ex10.m1.16.16.16.4.2" xref="S2.Ex10.m1.16.16.16.4.2.cmml"><msub id="S2.Ex10.m1.16.16.16.4.2.3" xref="S2.Ex10.m1.16.16.16.4.2.3.cmml"><mi id="S2.Ex10.m1.16.16.16.4.2.3.2" xref="S2.Ex10.m1.16.16.16.4.2.3.2.cmml">π</mi><mn id="S2.Ex10.m1.16.16.16.4.2.3.3" xref="S2.Ex10.m1.16.16.16.4.2.3.3.cmml">0</mn></msub><mo id="S2.Ex10.m1.16.16.16.4.2.2" xref="S2.Ex10.m1.16.16.16.4.2.2.cmml">⁢</mo><mrow id="S2.Ex10.m1.16.16.16.4.2.1.1" xref="S2.Ex10.m1.16.16.16.4.2.1.1.1.cmml"><mo id="S2.Ex10.m1.16.16.16.4.2.1.1.2" stretchy="false" xref="S2.Ex10.m1.16.16.16.4.2.1.1.1.cmml">(</mo><mrow id="S2.Ex10.m1.16.16.16.4.2.1.1.1" xref="S2.Ex10.m1.16.16.16.4.2.1.1.1.cmml"><mi id="S2.Ex10.m1.16.16.16.4.2.1.1.1.2" xref="S2.Ex10.m1.16.16.16.4.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.Ex10.m1.16.16.16.4.2.1.1.1.1" xref="S2.Ex10.m1.16.16.16.4.2.1.1.1.1.cmml">|</mo><mi id="S2.Ex10.m1.16.16.16.4.2.1.1.1.3" xref="S2.Ex10.m1.16.16.16.4.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex10.m1.16.16.16.4.2.1.1.3" stretchy="false" xref="S2.Ex10.m1.16.16.16.4.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S2.Ex10.m1.17.17.17.5.1.3" xref="S2.Ex10.m1.17.17.17.5.1.1.cmml">)</mo></mrow><mn id="S2.Ex10.m1.17.17.17.7" xref="S2.Ex10.m1.17.17.17.7.cmml">2</mn></msup></mfrac></mstyle></mrow><mo id="S2.Ex10.m1.18.18.1.2" lspace="0em" xref="S2.Ex10.m1.18.18.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex10.m1.18b"><apply id="S2.Ex10.m1.18.18.1.1.cmml" xref="S2.Ex10.m1.18.18.1"><eq id="S2.Ex10.m1.18.18.1.1.1.cmml" xref="S2.Ex10.m1.18.18.1.1.1"></eq><csymbol cd="latexml" id="S2.Ex10.m1.18.18.1.1.2.cmml" xref="S2.Ex10.m1.18.18.1.1.2">absent</csymbol><apply id="S2.Ex10.m1.17.17.cmml" xref="S2.Ex10.m1.17.17"><divide id="S2.Ex10.m1.17.17.18.cmml" xref="S2.Ex10.m1.17.17"></divide><apply id="S2.Ex10.m1.12.12.12.cmml" xref="S2.Ex10.m1.12.12.12"><apply id="S2.Ex10.m1.12.12.12.13.cmml" xref="S2.Ex10.m1.12.12.12.13"><csymbol cd="ambiguous" id="S2.Ex10.m1.12.12.12.13.1.cmml" xref="S2.Ex10.m1.12.12.12.13">subscript</csymbol><sum id="S2.Ex10.m1.12.12.12.13.2.cmml" xref="S2.Ex10.m1.12.12.12.13.2"></sum><vector id="S2.Ex10.m1.3.3.3.3.3.4.cmml" xref="S2.Ex10.m1.3.3.3.3.3.3"><apply id="S2.Ex10.m1.1.1.1.1.1.1.1.cmml" xref="S2.Ex10.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex10.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex10.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex10.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex10.m1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.Ex10.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex10.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.Ex10.m1.2.2.2.2.2.2.2.cmml" xref="S2.Ex10.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex10.m1.2.2.2.2.2.2.2.1.cmml" xref="S2.Ex10.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S2.Ex10.m1.2.2.2.2.2.2.2.2.cmml" xref="S2.Ex10.m1.2.2.2.2.2.2.2.2">𝑎</ci><ci id="S2.Ex10.m1.2.2.2.2.2.2.2.3.cmml" xref="S2.Ex10.m1.2.2.2.2.2.2.2.3">𝑖</ci></apply><apply id="S2.Ex10.m1.3.3.3.3.3.3.3.cmml" xref="S2.Ex10.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.Ex10.m1.3.3.3.3.3.3.3.1.cmml" xref="S2.Ex10.m1.3.3.3.3.3.3.3">subscript</csymbol><ci id="S2.Ex10.m1.3.3.3.3.3.3.3.2.cmml" xref="S2.Ex10.m1.3.3.3.3.3.3.3.2">𝑟</ci><ci id="S2.Ex10.m1.3.3.3.3.3.3.3.3.cmml" xref="S2.Ex10.m1.3.3.3.3.3.3.3.3">𝑖</ci></apply></vector></apply><apply id="S2.Ex10.m1.12.12.12.12.cmml" xref="S2.Ex10.m1.12.12.12.12"><apply id="S2.Ex10.m1.12.12.12.12.3.cmml" xref="S2.Ex10.m1.12.12.12.12.3"><csymbol cd="ambiguous" id="S2.Ex10.m1.12.12.12.12.3.1.cmml" xref="S2.Ex10.m1.12.12.12.12.3">subscript</csymbol><sum id="S2.Ex10.m1.12.12.12.12.3.2.cmml" xref="S2.Ex10.m1.12.12.12.12.3.2"></sum><vector id="S2.Ex10.m1.6.6.6.6.3.4.cmml" xref="S2.Ex10.m1.6.6.6.6.3.3"><apply id="S2.Ex10.m1.4.4.4.4.1.1.1.cmml" xref="S2.Ex10.m1.4.4.4.4.1.1.1"><csymbol cd="ambiguous" id="S2.Ex10.m1.4.4.4.4.1.1.1.1.cmml" xref="S2.Ex10.m1.4.4.4.4.1.1.1">subscript</csymbol><ci id="S2.Ex10.m1.4.4.4.4.1.1.1.2.cmml" xref="S2.Ex10.m1.4.4.4.4.1.1.1.2">𝑥</ci><ci id="S2.Ex10.m1.4.4.4.4.1.1.1.3.cmml" xref="S2.Ex10.m1.4.4.4.4.1.1.1.3">𝑗</ci></apply><apply id="S2.Ex10.m1.5.5.5.5.2.2.2.cmml" xref="S2.Ex10.m1.5.5.5.5.2.2.2"><csymbol cd="ambiguous" id="S2.Ex10.m1.5.5.5.5.2.2.2.1.cmml" xref="S2.Ex10.m1.5.5.5.5.2.2.2">subscript</csymbol><ci id="S2.Ex10.m1.5.5.5.5.2.2.2.2.cmml" xref="S2.Ex10.m1.5.5.5.5.2.2.2.2">𝑎</ci><ci id="S2.Ex10.m1.5.5.5.5.2.2.2.3.cmml" xref="S2.Ex10.m1.5.5.5.5.2.2.2.3">𝑗</ci></apply><apply id="S2.Ex10.m1.6.6.6.6.3.3.3.cmml" xref="S2.Ex10.m1.6.6.6.6.3.3.3"><csymbol cd="ambiguous" id="S2.Ex10.m1.6.6.6.6.3.3.3.1.cmml" xref="S2.Ex10.m1.6.6.6.6.3.3.3">subscript</csymbol><ci id="S2.Ex10.m1.6.6.6.6.3.3.3.2.cmml" xref="S2.Ex10.m1.6.6.6.6.3.3.3.2">𝑟</ci><ci id="S2.Ex10.m1.6.6.6.6.3.3.3.3.cmml" xref="S2.Ex10.m1.6.6.6.6.3.3.3.3">𝑗</ci></apply></vector></apply><apply id="S2.Ex10.m1.12.12.12.12.2.cmml" xref="S2.Ex10.m1.12.12.12.12.2"><times id="S2.Ex10.m1.12.12.12.12.2.3.cmml" xref="S2.Ex10.m1.12.12.12.12.2.3"></times><apply id="S2.Ex10.m1.10.10.10.10.cmml" xref="S2.Ex10.m1.10.10.10.10"><divide id="S2.Ex10.m1.10.10.10.10.5.cmml" xref="S2.Ex10.m1.10.10.10.10"></divide><apply id="S2.Ex10.m1.8.8.8.8.2.cmml" xref="S2.Ex10.m1.8.8.8.8.2"><times id="S2.Ex10.m1.8.8.8.8.2.3.cmml" xref="S2.Ex10.m1.8.8.8.8.2.3"></times><ci id="S2.Ex10.m1.8.8.8.8.2.4.cmml" xref="S2.Ex10.m1.8.8.8.8.2.4">𝜋</ci><apply id="S2.Ex10.m1.7.7.7.7.1.1.1.1.cmml" xref="S2.Ex10.m1.7.7.7.7.1.1.1"><csymbol cd="latexml" id="S2.Ex10.m1.7.7.7.7.1.1.1.1.1.cmml" xref="S2.Ex10.m1.7.7.7.7.1.1.1.1.1">conditional</csymbol><apply id="S2.Ex10.m1.7.7.7.7.1.1.1.1.2.cmml" xref="S2.Ex10.m1.7.7.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex10.m1.7.7.7.7.1.1.1.1.2.1.cmml" xref="S2.Ex10.m1.7.7.7.7.1.1.1.1.2">subscript</csymbol><ci id="S2.Ex10.m1.7.7.7.7.1.1.1.1.2.2.cmml" xref="S2.Ex10.m1.7.7.7.7.1.1.1.1.2.2">𝑎</ci><ci id="S2.Ex10.m1.7.7.7.7.1.1.1.1.2.3.cmml" xref="S2.Ex10.m1.7.7.7.7.1.1.1.1.2.3">𝑖</ci></apply><apply id="S2.Ex10.m1.7.7.7.7.1.1.1.1.3.cmml" xref="S2.Ex10.m1.7.7.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex10.m1.7.7.7.7.1.1.1.1.3.1.cmml" xref="S2.Ex10.m1.7.7.7.7.1.1.1.1.3">subscript</csymbol><ci id="S2.Ex10.m1.7.7.7.7.1.1.1.1.3.2.cmml" xref="S2.Ex10.m1.7.7.7.7.1.1.1.1.3.2">𝑥</ci><ci id="S2.Ex10.m1.7.7.7.7.1.1.1.1.3.3.cmml" xref="S2.Ex10.m1.7.7.7.7.1.1.1.1.3.3">𝑖</ci></apply></apply><ci id="S2.Ex10.m1.8.8.8.8.2.5.cmml" xref="S2.Ex10.m1.8.8.8.8.2.5">𝜋</ci><apply id="S2.Ex10.m1.8.8.8.8.2.2.1.1.cmml" xref="S2.Ex10.m1.8.8.8.8.2.2.1"><csymbol cd="latexml" id="S2.Ex10.m1.8.8.8.8.2.2.1.1.1.cmml" xref="S2.Ex10.m1.8.8.8.8.2.2.1.1.1">conditional</csymbol><apply id="S2.Ex10.m1.8.8.8.8.2.2.1.1.2.cmml" xref="S2.Ex10.m1.8.8.8.8.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.Ex10.m1.8.8.8.8.2.2.1.1.2.1.cmml" xref="S2.Ex10.m1.8.8.8.8.2.2.1.1.2">subscript</csymbol><ci id="S2.Ex10.m1.8.8.8.8.2.2.1.1.2.2.cmml" xref="S2.Ex10.m1.8.8.8.8.2.2.1.1.2.2">𝑎</ci><ci id="S2.Ex10.m1.8.8.8.8.2.2.1.1.2.3.cmml" xref="S2.Ex10.m1.8.8.8.8.2.2.1.1.2.3">𝑗</ci></apply><apply id="S2.Ex10.m1.8.8.8.8.2.2.1.1.3.cmml" xref="S2.Ex10.m1.8.8.8.8.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.Ex10.m1.8.8.8.8.2.2.1.1.3.1.cmml" xref="S2.Ex10.m1.8.8.8.8.2.2.1.1.3">subscript</csymbol><ci id="S2.Ex10.m1.8.8.8.8.2.2.1.1.3.2.cmml" xref="S2.Ex10.m1.8.8.8.8.2.2.1.1.3.2">𝑥</ci><ci id="S2.Ex10.m1.8.8.8.8.2.2.1.1.3.3.cmml" xref="S2.Ex10.m1.8.8.8.8.2.2.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S2.Ex10.m1.10.10.10.10.4.cmml" xref="S2.Ex10.m1.10.10.10.10.4"><times id="S2.Ex10.m1.10.10.10.10.4.3.cmml" xref="S2.Ex10.m1.10.10.10.10.4.3"></times><apply id="S2.Ex10.m1.10.10.10.10.4.4.cmml" xref="S2.Ex10.m1.10.10.10.10.4.4"><csymbol cd="ambiguous" id="S2.Ex10.m1.10.10.10.10.4.4.1.cmml" xref="S2.Ex10.m1.10.10.10.10.4.4">subscript</csymbol><ci id="S2.Ex10.m1.10.10.10.10.4.4.2.cmml" xref="S2.Ex10.m1.10.10.10.10.4.4.2">𝜋</ci><cn id="S2.Ex10.m1.10.10.10.10.4.4.3.cmml" type="integer" xref="S2.Ex10.m1.10.10.10.10.4.4.3">0</cn></apply><apply id="S2.Ex10.m1.9.9.9.9.3.1.1.1.cmml" xref="S2.Ex10.m1.9.9.9.9.3.1.1"><csymbol cd="latexml" id="S2.Ex10.m1.9.9.9.9.3.1.1.1.1.cmml" xref="S2.Ex10.m1.9.9.9.9.3.1.1.1.1">conditional</csymbol><apply id="S2.Ex10.m1.9.9.9.9.3.1.1.1.2.cmml" xref="S2.Ex10.m1.9.9.9.9.3.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex10.m1.9.9.9.9.3.1.1.1.2.1.cmml" xref="S2.Ex10.m1.9.9.9.9.3.1.1.1.2">subscript</csymbol><ci id="S2.Ex10.m1.9.9.9.9.3.1.1.1.2.2.cmml" xref="S2.Ex10.m1.9.9.9.9.3.1.1.1.2.2">𝑎</ci><ci id="S2.Ex10.m1.9.9.9.9.3.1.1.1.2.3.cmml" xref="S2.Ex10.m1.9.9.9.9.3.1.1.1.2.3">𝑖</ci></apply><apply id="S2.Ex10.m1.9.9.9.9.3.1.1.1.3.cmml" xref="S2.Ex10.m1.9.9.9.9.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex10.m1.9.9.9.9.3.1.1.1.3.1.cmml" xref="S2.Ex10.m1.9.9.9.9.3.1.1.1.3">subscript</csymbol><ci id="S2.Ex10.m1.9.9.9.9.3.1.1.1.3.2.cmml" xref="S2.Ex10.m1.9.9.9.9.3.1.1.1.3.2">𝑥</ci><ci id="S2.Ex10.m1.9.9.9.9.3.1.1.1.3.3.cmml" xref="S2.Ex10.m1.9.9.9.9.3.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S2.Ex10.m1.10.10.10.10.4.5.cmml" xref="S2.Ex10.m1.10.10.10.10.4.5"><csymbol cd="ambiguous" id="S2.Ex10.m1.10.10.10.10.4.5.1.cmml" xref="S2.Ex10.m1.10.10.10.10.4.5">subscript</csymbol><ci id="S2.Ex10.m1.10.10.10.10.4.5.2.cmml" xref="S2.Ex10.m1.10.10.10.10.4.5.2">𝜋</ci><cn id="S2.Ex10.m1.10.10.10.10.4.5.3.cmml" type="integer" xref="S2.Ex10.m1.10.10.10.10.4.5.3">0</cn></apply><apply id="S2.Ex10.m1.10.10.10.10.4.2.1.1.cmml" xref="S2.Ex10.m1.10.10.10.10.4.2.1"><csymbol cd="latexml" id="S2.Ex10.m1.10.10.10.10.4.2.1.1.1.cmml" xref="S2.Ex10.m1.10.10.10.10.4.2.1.1.1">conditional</csymbol><apply id="S2.Ex10.m1.10.10.10.10.4.2.1.1.2.cmml" xref="S2.Ex10.m1.10.10.10.10.4.2.1.1.2"><csymbol cd="ambiguous" id="S2.Ex10.m1.10.10.10.10.4.2.1.1.2.1.cmml" xref="S2.Ex10.m1.10.10.10.10.4.2.1.1.2">subscript</csymbol><ci id="S2.Ex10.m1.10.10.10.10.4.2.1.1.2.2.cmml" xref="S2.Ex10.m1.10.10.10.10.4.2.1.1.2.2">𝑎</ci><ci id="S2.Ex10.m1.10.10.10.10.4.2.1.1.2.3.cmml" xref="S2.Ex10.m1.10.10.10.10.4.2.1.1.2.3">𝑗</ci></apply><apply id="S2.Ex10.m1.10.10.10.10.4.2.1.1.3.cmml" xref="S2.Ex10.m1.10.10.10.10.4.2.1.1.3"><csymbol cd="ambiguous" id="S2.Ex10.m1.10.10.10.10.4.2.1.1.3.1.cmml" xref="S2.Ex10.m1.10.10.10.10.4.2.1.1.3">subscript</csymbol><ci id="S2.Ex10.m1.10.10.10.10.4.2.1.1.3.2.cmml" xref="S2.Ex10.m1.10.10.10.10.4.2.1.1.3.2">𝑥</ci><ci id="S2.Ex10.m1.10.10.10.10.4.2.1.1.3.3.cmml" xref="S2.Ex10.m1.10.10.10.10.4.2.1.1.3.3">𝑗</ci></apply></apply></apply></apply><apply id="S2.Ex10.m1.12.12.12.12.2.4.cmml" xref="S2.Ex10.m1.12.12.12.12.2.4"><apply id="S2.Ex10.m1.12.12.12.12.2.4.1.cmml" xref="S2.Ex10.m1.12.12.12.12.2.4.1"><ci id="S2.Ex10.m1.12.12.12.12.2.4.1.1.cmml" xref="S2.Ex10.m1.12.12.12.12.2.4.1.1">∇</ci><log id="S2.Ex10.m1.12.12.12.12.2.4.1.2.cmml" xref="S2.Ex10.m1.12.12.12.12.2.4.1.2"></log></apply><ci id="S2.Ex10.m1.12.12.12.12.2.4.2.cmml" xref="S2.Ex10.m1.12.12.12.12.2.4.2">𝜋</ci></apply><apply id="S2.Ex10.m1.11.11.11.11.1.1.1.1.cmml" xref="S2.Ex10.m1.11.11.11.11.1.1.1"><csymbol cd="latexml" id="S2.Ex10.m1.11.11.11.11.1.1.1.1.1.cmml" xref="S2.Ex10.m1.11.11.11.11.1.1.1.1.1">conditional</csymbol><apply id="S2.Ex10.m1.11.11.11.11.1.1.1.1.2.cmml" xref="S2.Ex10.m1.11.11.11.11.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex10.m1.11.11.11.11.1.1.1.1.2.1.cmml" xref="S2.Ex10.m1.11.11.11.11.1.1.1.1.2">subscript</csymbol><ci id="S2.Ex10.m1.11.11.11.11.1.1.1.1.2.2.cmml" xref="S2.Ex10.m1.11.11.11.11.1.1.1.1.2.2">𝑎</ci><ci id="S2.Ex10.m1.11.11.11.11.1.1.1.1.2.3.cmml" xref="S2.Ex10.m1.11.11.11.11.1.1.1.1.2.3">𝑗</ci></apply><apply id="S2.Ex10.m1.11.11.11.11.1.1.1.1.3.cmml" xref="S2.Ex10.m1.11.11.11.11.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex10.m1.11.11.11.11.1.1.1.1.3.1.cmml" xref="S2.Ex10.m1.11.11.11.11.1.1.1.1.3">subscript</csymbol><ci id="S2.Ex10.m1.11.11.11.11.1.1.1.1.3.2.cmml" xref="S2.Ex10.m1.11.11.11.11.1.1.1.1.3.2">𝑥</ci><ci id="S2.Ex10.m1.11.11.11.11.1.1.1.1.3.3.cmml" xref="S2.Ex10.m1.11.11.11.11.1.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S2.Ex10.m1.12.12.12.12.2.2.1.1.cmml" xref="S2.Ex10.m1.12.12.12.12.2.2.1"><minus id="S2.Ex10.m1.12.12.12.12.2.2.1.1.1.cmml" xref="S2.Ex10.m1.12.12.12.12.2.2.1.1.1"></minus><apply id="S2.Ex10.m1.12.12.12.12.2.2.1.1.2.cmml" xref="S2.Ex10.m1.12.12.12.12.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.Ex10.m1.12.12.12.12.2.2.1.1.2.1.cmml" xref="S2.Ex10.m1.12.12.12.12.2.2.1.1.2">subscript</csymbol><ci id="S2.Ex10.m1.12.12.12.12.2.2.1.1.2.2.cmml" xref="S2.Ex10.m1.12.12.12.12.2.2.1.1.2.2">𝑟</ci><ci id="S2.Ex10.m1.12.12.12.12.2.2.1.1.2.3.cmml" xref="S2.Ex10.m1.12.12.12.12.2.2.1.1.2.3">𝑗</ci></apply><apply id="S2.Ex10.m1.12.12.12.12.2.2.1.1.3.cmml" xref="S2.Ex10.m1.12.12.12.12.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.Ex10.m1.12.12.12.12.2.2.1.1.3.1.cmml" xref="S2.Ex10.m1.12.12.12.12.2.2.1.1.3">subscript</csymbol><ci id="S2.Ex10.m1.12.12.12.12.2.2.1.1.3.2.cmml" xref="S2.Ex10.m1.12.12.12.12.2.2.1.1.3.2">𝑟</ci><ci id="S2.Ex10.m1.12.12.12.12.2.2.1.1.3.3.cmml" xref="S2.Ex10.m1.12.12.12.12.2.2.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S2.Ex10.m1.17.17.17.cmml" xref="S2.Ex10.m1.17.17.17"><csymbol cd="ambiguous" id="S2.Ex10.m1.17.17.17.6.cmml" xref="S2.Ex10.m1.17.17.17">superscript</csymbol><apply id="S2.Ex10.m1.17.17.17.5.1.1.cmml" xref="S2.Ex10.m1.17.17.17.5.1"><apply id="S2.Ex10.m1.17.17.17.5.1.1.1.cmml" xref="S2.Ex10.m1.17.17.17.5.1.1.1"><csymbol cd="ambiguous" id="S2.Ex10.m1.17.17.17.5.1.1.1.1.cmml" xref="S2.Ex10.m1.17.17.17.5.1.1.1">subscript</csymbol><sum id="S2.Ex10.m1.17.17.17.5.1.1.1.2.cmml" xref="S2.Ex10.m1.17.17.17.5.1.1.1.2"></sum><interval closure="open" id="S2.Ex10.m1.14.14.14.2.2.3.cmml" xref="S2.Ex10.m1.14.14.14.2.2.4"><ci id="S2.Ex10.m1.13.13.13.1.1.1.cmml" xref="S2.Ex10.m1.13.13.13.1.1.1">𝑥</ci><ci id="S2.Ex10.m1.14.14.14.2.2.2.cmml" xref="S2.Ex10.m1.14.14.14.2.2.2">𝑎</ci></interval></apply><apply id="S2.Ex10.m1.16.16.16.4.cmml" xref="S2.Ex10.m1.16.16.16.4"><divide id="S2.Ex10.m1.16.16.16.4.3.cmml" xref="S2.Ex10.m1.16.16.16.4"></divide><apply id="S2.Ex10.m1.15.15.15.3.1.cmml" xref="S2.Ex10.m1.15.15.15.3.1"><times id="S2.Ex10.m1.15.15.15.3.1.2.cmml" xref="S2.Ex10.m1.15.15.15.3.1.2"></times><ci id="S2.Ex10.m1.15.15.15.3.1.3.cmml" xref="S2.Ex10.m1.15.15.15.3.1.3">𝜋</ci><apply id="S2.Ex10.m1.15.15.15.3.1.1.1.1.cmml" xref="S2.Ex10.m1.15.15.15.3.1.1.1"><csymbol cd="latexml" id="S2.Ex10.m1.15.15.15.3.1.1.1.1.1.cmml" xref="S2.Ex10.m1.15.15.15.3.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex10.m1.15.15.15.3.1.1.1.1.2.cmml" xref="S2.Ex10.m1.15.15.15.3.1.1.1.1.2">𝑎</ci><ci id="S2.Ex10.m1.15.15.15.3.1.1.1.1.3.cmml" xref="S2.Ex10.m1.15.15.15.3.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.Ex10.m1.16.16.16.4.2.cmml" xref="S2.Ex10.m1.16.16.16.4.2"><times id="S2.Ex10.m1.16.16.16.4.2.2.cmml" xref="S2.Ex10.m1.16.16.16.4.2.2"></times><apply id="S2.Ex10.m1.16.16.16.4.2.3.cmml" xref="S2.Ex10.m1.16.16.16.4.2.3"><csymbol cd="ambiguous" id="S2.Ex10.m1.16.16.16.4.2.3.1.cmml" xref="S2.Ex10.m1.16.16.16.4.2.3">subscript</csymbol><ci id="S2.Ex10.m1.16.16.16.4.2.3.2.cmml" xref="S2.Ex10.m1.16.16.16.4.2.3.2">𝜋</ci><cn id="S2.Ex10.m1.16.16.16.4.2.3.3.cmml" type="integer" xref="S2.Ex10.m1.16.16.16.4.2.3.3">0</cn></apply><apply id="S2.Ex10.m1.16.16.16.4.2.1.1.1.cmml" xref="S2.Ex10.m1.16.16.16.4.2.1.1"><csymbol cd="latexml" id="S2.Ex10.m1.16.16.16.4.2.1.1.1.1.cmml" xref="S2.Ex10.m1.16.16.16.4.2.1.1.1.1">conditional</csymbol><ci id="S2.Ex10.m1.16.16.16.4.2.1.1.1.2.cmml" xref="S2.Ex10.m1.16.16.16.4.2.1.1.1.2">𝑎</ci><ci id="S2.Ex10.m1.16.16.16.4.2.1.1.1.3.cmml" xref="S2.Ex10.m1.16.16.16.4.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply><cn id="S2.Ex10.m1.17.17.17.7.cmml" type="integer" xref="S2.Ex10.m1.17.17.17.7">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex10.m1.18c">\displaystyle=\frac{\sum\limits_{(x_{i},a_{i},r_{i})}\sum\limits_{(x_{j},a_{j}%
,r_{j})}\frac{\pi(a_{i}|x_{i})\pi(a_{j}|x_{j})}{\pi_{0}(a_{i}|x_{i})\pi_{0}(a_%
{j}|x_{j})}\nabla\log\pi(a_{j}|x_{j})(r_{j}-r_{i})}{\left({\sum_{(x,a)}\frac{%
\pi(a|x)}{\pi_{0}(a|x)}}\right)^{2}}.</annotation><annotation encoding="application/x-llamapun" id="S2.Ex10.m1.18d">= divide start_ARG ∑ start_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT divide start_ARG italic_π ( italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) italic_π ( italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG ∇ roman_log italic_π ( italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ( italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG start_ARG ( ∑ start_POSTSUBSCRIPT ( italic_x , italic_a ) end_POSTSUBSCRIPT divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p5.8">Indeed, as the SNIPS gradient relies on the <em class="ltx_emph ltx_font_italic" id="S2.SS2.p5.8.1">relative difference</em> in observed reward between two samples, a constant correction would not affect it (i.e., if <math alttext="\overline{r}=r-\beta" class="ltx_Math" display="inline" id="S2.SS2.p5.7.m1.1"><semantics id="S2.SS2.p5.7.m1.1a"><mrow id="S2.SS2.p5.7.m1.1.1" xref="S2.SS2.p5.7.m1.1.1.cmml"><mover accent="true" id="S2.SS2.p5.7.m1.1.1.2" xref="S2.SS2.p5.7.m1.1.1.2.cmml"><mi id="S2.SS2.p5.7.m1.1.1.2.2" xref="S2.SS2.p5.7.m1.1.1.2.2.cmml">r</mi><mo id="S2.SS2.p5.7.m1.1.1.2.1" xref="S2.SS2.p5.7.m1.1.1.2.1.cmml">¯</mo></mover><mo id="S2.SS2.p5.7.m1.1.1.1" xref="S2.SS2.p5.7.m1.1.1.1.cmml">=</mo><mrow id="S2.SS2.p5.7.m1.1.1.3" xref="S2.SS2.p5.7.m1.1.1.3.cmml"><mi id="S2.SS2.p5.7.m1.1.1.3.2" xref="S2.SS2.p5.7.m1.1.1.3.2.cmml">r</mi><mo id="S2.SS2.p5.7.m1.1.1.3.1" xref="S2.SS2.p5.7.m1.1.1.3.1.cmml">−</mo><mi id="S2.SS2.p5.7.m1.1.1.3.3" xref="S2.SS2.p5.7.m1.1.1.3.3.cmml">β</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.7.m1.1b"><apply id="S2.SS2.p5.7.m1.1.1.cmml" xref="S2.SS2.p5.7.m1.1.1"><eq id="S2.SS2.p5.7.m1.1.1.1.cmml" xref="S2.SS2.p5.7.m1.1.1.1"></eq><apply id="S2.SS2.p5.7.m1.1.1.2.cmml" xref="S2.SS2.p5.7.m1.1.1.2"><ci id="S2.SS2.p5.7.m1.1.1.2.1.cmml" xref="S2.SS2.p5.7.m1.1.1.2.1">¯</ci><ci id="S2.SS2.p5.7.m1.1.1.2.2.cmml" xref="S2.SS2.p5.7.m1.1.1.2.2">𝑟</ci></apply><apply id="S2.SS2.p5.7.m1.1.1.3.cmml" xref="S2.SS2.p5.7.m1.1.1.3"><minus id="S2.SS2.p5.7.m1.1.1.3.1.cmml" xref="S2.SS2.p5.7.m1.1.1.3.1"></minus><ci id="S2.SS2.p5.7.m1.1.1.3.2.cmml" xref="S2.SS2.p5.7.m1.1.1.3.2">𝑟</ci><ci id="S2.SS2.p5.7.m1.1.1.3.3.cmml" xref="S2.SS2.p5.7.m1.1.1.3.3">𝛽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.7.m1.1c">\overline{r}=r-\beta</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p5.7.m1.1d">over¯ start_ARG italic_r end_ARG = italic_r - italic_β</annotation></semantics></math>, then <math alttext="r_{j}-r_{i}\equiv\overline{r}_{j}-\overline{r}_{i}" class="ltx_Math" display="inline" id="S2.SS2.p5.8.m2.1"><semantics id="S2.SS2.p5.8.m2.1a"><mrow id="S2.SS2.p5.8.m2.1.1" xref="S2.SS2.p5.8.m2.1.1.cmml"><mrow id="S2.SS2.p5.8.m2.1.1.2" xref="S2.SS2.p5.8.m2.1.1.2.cmml"><msub id="S2.SS2.p5.8.m2.1.1.2.2" xref="S2.SS2.p5.8.m2.1.1.2.2.cmml"><mi id="S2.SS2.p5.8.m2.1.1.2.2.2" xref="S2.SS2.p5.8.m2.1.1.2.2.2.cmml">r</mi><mi id="S2.SS2.p5.8.m2.1.1.2.2.3" xref="S2.SS2.p5.8.m2.1.1.2.2.3.cmml">j</mi></msub><mo id="S2.SS2.p5.8.m2.1.1.2.1" xref="S2.SS2.p5.8.m2.1.1.2.1.cmml">−</mo><msub id="S2.SS2.p5.8.m2.1.1.2.3" xref="S2.SS2.p5.8.m2.1.1.2.3.cmml"><mi id="S2.SS2.p5.8.m2.1.1.2.3.2" xref="S2.SS2.p5.8.m2.1.1.2.3.2.cmml">r</mi><mi id="S2.SS2.p5.8.m2.1.1.2.3.3" xref="S2.SS2.p5.8.m2.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="S2.SS2.p5.8.m2.1.1.1" xref="S2.SS2.p5.8.m2.1.1.1.cmml">≡</mo><mrow id="S2.SS2.p5.8.m2.1.1.3" xref="S2.SS2.p5.8.m2.1.1.3.cmml"><msub id="S2.SS2.p5.8.m2.1.1.3.2" xref="S2.SS2.p5.8.m2.1.1.3.2.cmml"><mover accent="true" id="S2.SS2.p5.8.m2.1.1.3.2.2" xref="S2.SS2.p5.8.m2.1.1.3.2.2.cmml"><mi id="S2.SS2.p5.8.m2.1.1.3.2.2.2" xref="S2.SS2.p5.8.m2.1.1.3.2.2.2.cmml">r</mi><mo id="S2.SS2.p5.8.m2.1.1.3.2.2.1" xref="S2.SS2.p5.8.m2.1.1.3.2.2.1.cmml">¯</mo></mover><mi id="S2.SS2.p5.8.m2.1.1.3.2.3" xref="S2.SS2.p5.8.m2.1.1.3.2.3.cmml">j</mi></msub><mo id="S2.SS2.p5.8.m2.1.1.3.1" xref="S2.SS2.p5.8.m2.1.1.3.1.cmml">−</mo><msub id="S2.SS2.p5.8.m2.1.1.3.3" xref="S2.SS2.p5.8.m2.1.1.3.3.cmml"><mover accent="true" id="S2.SS2.p5.8.m2.1.1.3.3.2" xref="S2.SS2.p5.8.m2.1.1.3.3.2.cmml"><mi id="S2.SS2.p5.8.m2.1.1.3.3.2.2" xref="S2.SS2.p5.8.m2.1.1.3.3.2.2.cmml">r</mi><mo id="S2.SS2.p5.8.m2.1.1.3.3.2.1" xref="S2.SS2.p5.8.m2.1.1.3.3.2.1.cmml">¯</mo></mover><mi id="S2.SS2.p5.8.m2.1.1.3.3.3" xref="S2.SS2.p5.8.m2.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.8.m2.1b"><apply id="S2.SS2.p5.8.m2.1.1.cmml" xref="S2.SS2.p5.8.m2.1.1"><equivalent id="S2.SS2.p5.8.m2.1.1.1.cmml" xref="S2.SS2.p5.8.m2.1.1.1"></equivalent><apply id="S2.SS2.p5.8.m2.1.1.2.cmml" xref="S2.SS2.p5.8.m2.1.1.2"><minus id="S2.SS2.p5.8.m2.1.1.2.1.cmml" xref="S2.SS2.p5.8.m2.1.1.2.1"></minus><apply id="S2.SS2.p5.8.m2.1.1.2.2.cmml" xref="S2.SS2.p5.8.m2.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p5.8.m2.1.1.2.2.1.cmml" xref="S2.SS2.p5.8.m2.1.1.2.2">subscript</csymbol><ci id="S2.SS2.p5.8.m2.1.1.2.2.2.cmml" xref="S2.SS2.p5.8.m2.1.1.2.2.2">𝑟</ci><ci id="S2.SS2.p5.8.m2.1.1.2.2.3.cmml" xref="S2.SS2.p5.8.m2.1.1.2.2.3">𝑗</ci></apply><apply id="S2.SS2.p5.8.m2.1.1.2.3.cmml" xref="S2.SS2.p5.8.m2.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS2.p5.8.m2.1.1.2.3.1.cmml" xref="S2.SS2.p5.8.m2.1.1.2.3">subscript</csymbol><ci id="S2.SS2.p5.8.m2.1.1.2.3.2.cmml" xref="S2.SS2.p5.8.m2.1.1.2.3.2">𝑟</ci><ci id="S2.SS2.p5.8.m2.1.1.2.3.3.cmml" xref="S2.SS2.p5.8.m2.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S2.SS2.p5.8.m2.1.1.3.cmml" xref="S2.SS2.p5.8.m2.1.1.3"><minus id="S2.SS2.p5.8.m2.1.1.3.1.cmml" xref="S2.SS2.p5.8.m2.1.1.3.1"></minus><apply id="S2.SS2.p5.8.m2.1.1.3.2.cmml" xref="S2.SS2.p5.8.m2.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.p5.8.m2.1.1.3.2.1.cmml" xref="S2.SS2.p5.8.m2.1.1.3.2">subscript</csymbol><apply id="S2.SS2.p5.8.m2.1.1.3.2.2.cmml" xref="S2.SS2.p5.8.m2.1.1.3.2.2"><ci id="S2.SS2.p5.8.m2.1.1.3.2.2.1.cmml" xref="S2.SS2.p5.8.m2.1.1.3.2.2.1">¯</ci><ci id="S2.SS2.p5.8.m2.1.1.3.2.2.2.cmml" xref="S2.SS2.p5.8.m2.1.1.3.2.2.2">𝑟</ci></apply><ci id="S2.SS2.p5.8.m2.1.1.3.2.3.cmml" xref="S2.SS2.p5.8.m2.1.1.3.2.3">𝑗</ci></apply><apply id="S2.SS2.p5.8.m2.1.1.3.3.cmml" xref="S2.SS2.p5.8.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p5.8.m2.1.1.3.3.1.cmml" xref="S2.SS2.p5.8.m2.1.1.3.3">subscript</csymbol><apply id="S2.SS2.p5.8.m2.1.1.3.3.2.cmml" xref="S2.SS2.p5.8.m2.1.1.3.3.2"><ci id="S2.SS2.p5.8.m2.1.1.3.3.2.1.cmml" xref="S2.SS2.p5.8.m2.1.1.3.3.2.1">¯</ci><ci id="S2.SS2.p5.8.m2.1.1.3.3.2.2.cmml" xref="S2.SS2.p5.8.m2.1.1.3.3.2.2">𝑟</ci></apply><ci id="S2.SS2.p5.8.m2.1.1.3.3.3.cmml" xref="S2.SS2.p5.8.m2.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.8.m2.1c">r_{j}-r_{i}\equiv\overline{r}_{j}-\overline{r}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p5.8.m2.1d">italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ≡ over¯ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - over¯ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>).</p>
</div>
<div class="ltx_para" id="S2.SS2.p6">
<p class="ltx_p" id="S2.SS2.p6.3"><cite class="ltx_cite ltx_citemacro_citet">Swaminathan and Joachims (<a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib63" title="">2015b</a>)</cite> effectively apply the SNIPS estimator (with a variance regularisation term <cite class="ltx_cite ltx_citemacro_citep">(Swaminathan and Joachims, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib62" title="">2015a</a>)</cite>) to off-policy <em class="ltx_emph ltx_font_italic" id="S2.SS2.p6.3.1">learning</em> scenarios.
Note that while <math alttext="\widehat{V}_{\rm IPS}" class="ltx_Math" display="inline" id="S2.SS2.p6.1.m1.1"><semantics id="S2.SS2.p6.1.m1.1a"><msub id="S2.SS2.p6.1.m1.1.1" xref="S2.SS2.p6.1.m1.1.1.cmml"><mover accent="true" id="S2.SS2.p6.1.m1.1.1.2" xref="S2.SS2.p6.1.m1.1.1.2.cmml"><mi id="S2.SS2.p6.1.m1.1.1.2.2" xref="S2.SS2.p6.1.m1.1.1.2.2.cmml">V</mi><mo id="S2.SS2.p6.1.m1.1.1.2.1" xref="S2.SS2.p6.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.p6.1.m1.1.1.3" xref="S2.SS2.p6.1.m1.1.1.3.cmml">IPS</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p6.1.m1.1b"><apply id="S2.SS2.p6.1.m1.1.1.cmml" xref="S2.SS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p6.1.m1.1.1.1.cmml" xref="S2.SS2.p6.1.m1.1.1">subscript</csymbol><apply id="S2.SS2.p6.1.m1.1.1.2.cmml" xref="S2.SS2.p6.1.m1.1.1.2"><ci id="S2.SS2.p6.1.m1.1.1.2.1.cmml" xref="S2.SS2.p6.1.m1.1.1.2.1">^</ci><ci id="S2.SS2.p6.1.m1.1.1.2.2.cmml" xref="S2.SS2.p6.1.m1.1.1.2.2">𝑉</ci></apply><ci id="S2.SS2.p6.1.m1.1.1.3.cmml" xref="S2.SS2.p6.1.m1.1.1.3">IPS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p6.1.m1.1c">\widehat{V}_{\rm IPS}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p6.1.m1.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_IPS end_POSTSUBSCRIPT</annotation></semantics></math> neatly decomposes into a single sum over samples, <math alttext="\widehat{V}_{\rm SNIPS}" class="ltx_Math" display="inline" id="S2.SS2.p6.2.m2.1"><semantics id="S2.SS2.p6.2.m2.1a"><msub id="S2.SS2.p6.2.m2.1.1" xref="S2.SS2.p6.2.m2.1.1.cmml"><mover accent="true" id="S2.SS2.p6.2.m2.1.1.2" xref="S2.SS2.p6.2.m2.1.1.2.cmml"><mi id="S2.SS2.p6.2.m2.1.1.2.2" xref="S2.SS2.p6.2.m2.1.1.2.2.cmml">V</mi><mo id="S2.SS2.p6.2.m2.1.1.2.1" xref="S2.SS2.p6.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.p6.2.m2.1.1.3" xref="S2.SS2.p6.2.m2.1.1.3.cmml">SNIPS</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p6.2.m2.1b"><apply id="S2.SS2.p6.2.m2.1.1.cmml" xref="S2.SS2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p6.2.m2.1.1.1.cmml" xref="S2.SS2.p6.2.m2.1.1">subscript</csymbol><apply id="S2.SS2.p6.2.m2.1.1.2.cmml" xref="S2.SS2.p6.2.m2.1.1.2"><ci id="S2.SS2.p6.2.m2.1.1.2.1.cmml" xref="S2.SS2.p6.2.m2.1.1.2.1">^</ci><ci id="S2.SS2.p6.2.m2.1.1.2.2.cmml" xref="S2.SS2.p6.2.m2.1.1.2.2">𝑉</ci></apply><ci id="S2.SS2.p6.2.m2.1.1.3.cmml" xref="S2.SS2.p6.2.m2.1.1.3">SNIPS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p6.2.m2.1c">\widehat{V}_{\rm SNIPS}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p6.2.m2.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_SNIPS end_POSTSUBSCRIPT</annotation></semantics></math> no longer does.
Whilst this may be clear from the gradient formulation in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2.Ex7" title="2.2. Off-policy estimation for general bandits ‣ 2. Background and Related Work ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">2.2</span></a>, a formal proof can be found in <cite class="ltx_cite ltx_citemacro_citep">(Joachims et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib34" title="">2018</a>, App. C)</cite>.
This implies that mini-batch optimization methods (which are often necessary to support learning from large datasets) are no longer directly applicable to <math alttext="\widehat{V}_{\rm SNIPS}" class="ltx_Math" display="inline" id="S2.SS2.p6.3.m3.1"><semantics id="S2.SS2.p6.3.m3.1a"><msub id="S2.SS2.p6.3.m3.1.1" xref="S2.SS2.p6.3.m3.1.1.cmml"><mover accent="true" id="S2.SS2.p6.3.m3.1.1.2" xref="S2.SS2.p6.3.m3.1.1.2.cmml"><mi id="S2.SS2.p6.3.m3.1.1.2.2" xref="S2.SS2.p6.3.m3.1.1.2.2.cmml">V</mi><mo id="S2.SS2.p6.3.m3.1.1.2.1" xref="S2.SS2.p6.3.m3.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.p6.3.m3.1.1.3" xref="S2.SS2.p6.3.m3.1.1.3.cmml">SNIPS</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p6.3.m3.1b"><apply id="S2.SS2.p6.3.m3.1.1.cmml" xref="S2.SS2.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p6.3.m3.1.1.1.cmml" xref="S2.SS2.p6.3.m3.1.1">subscript</csymbol><apply id="S2.SS2.p6.3.m3.1.1.2.cmml" xref="S2.SS2.p6.3.m3.1.1.2"><ci id="S2.SS2.p6.3.m3.1.1.2.1.cmml" xref="S2.SS2.p6.3.m3.1.1.2.1">^</ci><ci id="S2.SS2.p6.3.m3.1.1.2.2.cmml" xref="S2.SS2.p6.3.m3.1.1.2.2">𝑉</ci></apply><ci id="S2.SS2.p6.3.m3.1.1.3.cmml" xref="S2.SS2.p6.3.m3.1.1.3">SNIPS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p6.3.m3.1c">\widehat{V}_{\rm SNIPS}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p6.3.m3.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_SNIPS end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p7">
<p class="ltx_p" id="S2.SS2.p7.2"><cite class="ltx_cite ltx_citemacro_citet">Joachims et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib34" title="">2018</a>)</cite> solve this by re-framing the task of maximising <math alttext="\widehat{V}_{\rm SNIPS}" class="ltx_Math" display="inline" id="S2.SS2.p7.1.m1.1"><semantics id="S2.SS2.p7.1.m1.1a"><msub id="S2.SS2.p7.1.m1.1.1" xref="S2.SS2.p7.1.m1.1.1.cmml"><mover accent="true" id="S2.SS2.p7.1.m1.1.1.2" xref="S2.SS2.p7.1.m1.1.1.2.cmml"><mi id="S2.SS2.p7.1.m1.1.1.2.2" xref="S2.SS2.p7.1.m1.1.1.2.2.cmml">V</mi><mo id="S2.SS2.p7.1.m1.1.1.2.1" xref="S2.SS2.p7.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.p7.1.m1.1.1.3" xref="S2.SS2.p7.1.m1.1.1.3.cmml">SNIPS</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.1.m1.1b"><apply id="S2.SS2.p7.1.m1.1.1.cmml" xref="S2.SS2.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p7.1.m1.1.1.1.cmml" xref="S2.SS2.p7.1.m1.1.1">subscript</csymbol><apply id="S2.SS2.p7.1.m1.1.1.2.cmml" xref="S2.SS2.p7.1.m1.1.1.2"><ci id="S2.SS2.p7.1.m1.1.1.2.1.cmml" xref="S2.SS2.p7.1.m1.1.1.2.1">^</ci><ci id="S2.SS2.p7.1.m1.1.1.2.2.cmml" xref="S2.SS2.p7.1.m1.1.1.2.2">𝑉</ci></apply><ci id="S2.SS2.p7.1.m1.1.1.3.cmml" xref="S2.SS2.p7.1.m1.1.1.3">SNIPS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.1.m1.1c">\widehat{V}_{\rm SNIPS}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p7.1.m1.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_SNIPS end_POSTSUBSCRIPT</annotation></semantics></math> as an optimization problem on <math alttext="\widehat{V}_{\rm IPS}" class="ltx_Math" display="inline" id="S2.SS2.p7.2.m2.1"><semantics id="S2.SS2.p7.2.m2.1a"><msub id="S2.SS2.p7.2.m2.1.1" xref="S2.SS2.p7.2.m2.1.1.cmml"><mover accent="true" id="S2.SS2.p7.2.m2.1.1.2" xref="S2.SS2.p7.2.m2.1.1.2.cmml"><mi id="S2.SS2.p7.2.m2.1.1.2.2" xref="S2.SS2.p7.2.m2.1.1.2.2.cmml">V</mi><mo id="S2.SS2.p7.2.m2.1.1.2.1" xref="S2.SS2.p7.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.p7.2.m2.1.1.3" xref="S2.SS2.p7.2.m2.1.1.3.cmml">IPS</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.2.m2.1b"><apply id="S2.SS2.p7.2.m2.1.1.cmml" xref="S2.SS2.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p7.2.m2.1.1.1.cmml" xref="S2.SS2.p7.2.m2.1.1">subscript</csymbol><apply id="S2.SS2.p7.2.m2.1.1.2.cmml" xref="S2.SS2.p7.2.m2.1.1.2"><ci id="S2.SS2.p7.2.m2.1.1.2.1.cmml" xref="S2.SS2.p7.2.m2.1.1.2.1">^</ci><ci id="S2.SS2.p7.2.m2.1.1.2.2.cmml" xref="S2.SS2.p7.2.m2.1.1.2.2">𝑉</ci></apply><ci id="S2.SS2.p7.2.m2.1.1.3.cmml" xref="S2.SS2.p7.2.m2.1.1.3">IPS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.2.m2.1c">\widehat{V}_{\rm IPS}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p7.2.m2.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_IPS end_POSTSUBSCRIPT</annotation></semantics></math> with a constraint on the self-normalisation term.
That is, if we define:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(17)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mbox{}\pi^{\star}\!=\!\operatorname*{arg\,max}_{\pi\in\Pi}\widehat{V}_{\rm
SNIPS%
}(\pi,\mathcal{D}),\text{ with }S^{\star}\!=\!\frac{1}{\left|\mathcal{D}\right%
|}\!\sum_{(x,a,r)\in\mathcal{D}}\!\frac{\pi^{\star}(a|x)}{\pi_{0}(a|x)}," class="ltx_Math" display="block" id="S2.E17.m1.9"><semantics id="S2.E17.m1.9a"><mrow id="S2.E17.m1.9.9.1"><mrow id="S2.E17.m1.9.9.1.1.2" xref="S2.E17.m1.9.9.1.1.3.cmml"><mrow id="S2.E17.m1.9.9.1.1.1.1" xref="S2.E17.m1.9.9.1.1.1.1.cmml"><mrow id="S2.E17.m1.9.9.1.1.1.1.2" xref="S2.E17.m1.9.9.1.1.1.1.2.cmml"><mrow id="S2.E17.m1.9.9.1.1.1.1.2.2" xref="S2.E17.m1.9.9.1.1.1.1.2.2a.cmml"></mrow><mo id="S2.E17.m1.9.9.1.1.1.1.2.1" rspace="0.222em" xref="S2.E17.m1.9.9.1.1.1.1.2.1.cmml">⁢</mo><msup id="S2.E17.m1.9.9.1.1.1.1.2.3" xref="S2.E17.m1.9.9.1.1.1.1.2.3.cmml"><mi id="S2.E17.m1.9.9.1.1.1.1.2.3.2" xref="S2.E17.m1.9.9.1.1.1.1.2.3.2.cmml">π</mi><mo id="S2.E17.m1.9.9.1.1.1.1.2.3.3" xref="S2.E17.m1.9.9.1.1.1.1.2.3.3.cmml">⋆</mo></msup></mrow><mo id="S2.E17.m1.9.9.1.1.1.1.1" rspace="0.108em" xref="S2.E17.m1.9.9.1.1.1.1.1.cmml">=</mo><mrow id="S2.E17.m1.9.9.1.1.1.1.3" xref="S2.E17.m1.9.9.1.1.1.1.3.cmml"><mrow id="S2.E17.m1.9.9.1.1.1.1.3.2" xref="S2.E17.m1.9.9.1.1.1.1.3.2.cmml"><munder id="S2.E17.m1.9.9.1.1.1.1.3.2.1" xref="S2.E17.m1.9.9.1.1.1.1.3.2.1.cmml"><mrow id="S2.E17.m1.9.9.1.1.1.1.3.2.1.2" xref="S2.E17.m1.9.9.1.1.1.1.3.2.1.2.cmml"><mi id="S2.E17.m1.9.9.1.1.1.1.3.2.1.2.2" xref="S2.E17.m1.9.9.1.1.1.1.3.2.1.2.2.cmml">arg</mi><mo id="S2.E17.m1.9.9.1.1.1.1.3.2.1.2.1" lspace="0.170em" xref="S2.E17.m1.9.9.1.1.1.1.3.2.1.2.1.cmml">⁢</mo><mi id="S2.E17.m1.9.9.1.1.1.1.3.2.1.2.3" xref="S2.E17.m1.9.9.1.1.1.1.3.2.1.2.3.cmml">max</mi></mrow><mrow id="S2.E17.m1.9.9.1.1.1.1.3.2.1.3" xref="S2.E17.m1.9.9.1.1.1.1.3.2.1.3.cmml"><mi id="S2.E17.m1.9.9.1.1.1.1.3.2.1.3.2" xref="S2.E17.m1.9.9.1.1.1.1.3.2.1.3.2.cmml">π</mi><mo id="S2.E17.m1.9.9.1.1.1.1.3.2.1.3.1" xref="S2.E17.m1.9.9.1.1.1.1.3.2.1.3.1.cmml">∈</mo><mi id="S2.E17.m1.9.9.1.1.1.1.3.2.1.3.3" mathvariant="normal" xref="S2.E17.m1.9.9.1.1.1.1.3.2.1.3.3.cmml">Π</mi></mrow></munder><mo id="S2.E17.m1.9.9.1.1.1.1.3.2a" xref="S2.E17.m1.9.9.1.1.1.1.3.2.cmml">⁡</mo><msub id="S2.E17.m1.9.9.1.1.1.1.3.2.2" xref="S2.E17.m1.9.9.1.1.1.1.3.2.2.cmml"><mover accent="true" id="S2.E17.m1.9.9.1.1.1.1.3.2.2.2" xref="S2.E17.m1.9.9.1.1.1.1.3.2.2.2.cmml"><mi id="S2.E17.m1.9.9.1.1.1.1.3.2.2.2.2" xref="S2.E17.m1.9.9.1.1.1.1.3.2.2.2.2.cmml">V</mi><mo id="S2.E17.m1.9.9.1.1.1.1.3.2.2.2.1" xref="S2.E17.m1.9.9.1.1.1.1.3.2.2.2.1.cmml">^</mo></mover><mi id="S2.E17.m1.9.9.1.1.1.1.3.2.2.3" xref="S2.E17.m1.9.9.1.1.1.1.3.2.2.3.cmml">SNIPS</mi></msub></mrow><mo id="S2.E17.m1.9.9.1.1.1.1.3.1" xref="S2.E17.m1.9.9.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.E17.m1.9.9.1.1.1.1.3.3.2" xref="S2.E17.m1.9.9.1.1.1.1.3.3.1.cmml"><mo id="S2.E17.m1.9.9.1.1.1.1.3.3.2.1" stretchy="false" xref="S2.E17.m1.9.9.1.1.1.1.3.3.1.cmml">(</mo><mi id="S2.E17.m1.7.7" xref="S2.E17.m1.7.7.cmml">π</mi><mo id="S2.E17.m1.9.9.1.1.1.1.3.3.2.2" xref="S2.E17.m1.9.9.1.1.1.1.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.E17.m1.8.8" xref="S2.E17.m1.8.8.cmml">𝒟</mi><mo id="S2.E17.m1.9.9.1.1.1.1.3.3.2.3" stretchy="false" xref="S2.E17.m1.9.9.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E17.m1.9.9.1.1.2.3" xref="S2.E17.m1.9.9.1.1.3a.cmml">,</mo><mrow id="S2.E17.m1.9.9.1.1.2.2" xref="S2.E17.m1.9.9.1.1.2.2.cmml"><mrow id="S2.E17.m1.9.9.1.1.2.2.2" xref="S2.E17.m1.9.9.1.1.2.2.2.cmml"><mtext id="S2.E17.m1.9.9.1.1.2.2.2.2" xref="S2.E17.m1.9.9.1.1.2.2.2.2a.cmml"> with </mtext><mo id="S2.E17.m1.9.9.1.1.2.2.2.1" xref="S2.E17.m1.9.9.1.1.2.2.2.1.cmml">⁢</mo><msup id="S2.E17.m1.9.9.1.1.2.2.2.3" xref="S2.E17.m1.9.9.1.1.2.2.2.3.cmml"><mi id="S2.E17.m1.9.9.1.1.2.2.2.3.2" xref="S2.E17.m1.9.9.1.1.2.2.2.3.2.cmml">S</mi><mo id="S2.E17.m1.9.9.1.1.2.2.2.3.3" xref="S2.E17.m1.9.9.1.1.2.2.2.3.3.cmml">⋆</mo></msup></mrow><mo id="S2.E17.m1.9.9.1.1.2.2.1" rspace="0.108em" xref="S2.E17.m1.9.9.1.1.2.2.1.cmml">=</mo><mrow id="S2.E17.m1.9.9.1.1.2.2.3" xref="S2.E17.m1.9.9.1.1.2.2.3.cmml"><mfrac id="S2.E17.m1.1.1" xref="S2.E17.m1.1.1.cmml"><mn id="S2.E17.m1.1.1.3" xref="S2.E17.m1.1.1.3.cmml">1</mn><mrow id="S2.E17.m1.1.1.1.3" xref="S2.E17.m1.1.1.1.2.cmml"><mo id="S2.E17.m1.1.1.1.3.1" xref="S2.E17.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.E17.m1.1.1.1.1" xref="S2.E17.m1.1.1.1.1.cmml">𝒟</mi><mo id="S2.E17.m1.1.1.1.3.2" xref="S2.E17.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S2.E17.m1.9.9.1.1.2.2.3.1" xref="S2.E17.m1.9.9.1.1.2.2.3.1.cmml">⁢</mo><mrow id="S2.E17.m1.9.9.1.1.2.2.3.2" xref="S2.E17.m1.9.9.1.1.2.2.3.2.cmml"><munder id="S2.E17.m1.9.9.1.1.2.2.3.2.1" xref="S2.E17.m1.9.9.1.1.2.2.3.2.1.cmml"><mo id="S2.E17.m1.9.9.1.1.2.2.3.2.1.2" movablelimits="false" xref="S2.E17.m1.9.9.1.1.2.2.3.2.1.2.cmml">∑</mo><mrow id="S2.E17.m1.4.4.3" xref="S2.E17.m1.4.4.3.cmml"><mrow id="S2.E17.m1.4.4.3.5.2" xref="S2.E17.m1.4.4.3.5.1.cmml"><mo id="S2.E17.m1.4.4.3.5.2.1" stretchy="false" xref="S2.E17.m1.4.4.3.5.1.cmml">(</mo><mi id="S2.E17.m1.2.2.1.1" xref="S2.E17.m1.2.2.1.1.cmml">x</mi><mo id="S2.E17.m1.4.4.3.5.2.2" xref="S2.E17.m1.4.4.3.5.1.cmml">,</mo><mi id="S2.E17.m1.3.3.2.2" xref="S2.E17.m1.3.3.2.2.cmml">a</mi><mo id="S2.E17.m1.4.4.3.5.2.3" xref="S2.E17.m1.4.4.3.5.1.cmml">,</mo><mi id="S2.E17.m1.4.4.3.3" xref="S2.E17.m1.4.4.3.3.cmml">r</mi><mo id="S2.E17.m1.4.4.3.5.2.4" stretchy="false" xref="S2.E17.m1.4.4.3.5.1.cmml">)</mo></mrow><mo id="S2.E17.m1.4.4.3.4" xref="S2.E17.m1.4.4.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E17.m1.4.4.3.6" xref="S2.E17.m1.4.4.3.6.cmml">𝒟</mi></mrow></munder><mfrac id="S2.E17.m1.6.6" xref="S2.E17.m1.6.6.cmml"><mrow id="S2.E17.m1.5.5.1" xref="S2.E17.m1.5.5.1.cmml"><msup id="S2.E17.m1.5.5.1.3" xref="S2.E17.m1.5.5.1.3.cmml"><mi id="S2.E17.m1.5.5.1.3.2" xref="S2.E17.m1.5.5.1.3.2.cmml">π</mi><mo id="S2.E17.m1.5.5.1.3.3" xref="S2.E17.m1.5.5.1.3.3.cmml">⋆</mo></msup><mo id="S2.E17.m1.5.5.1.2" xref="S2.E17.m1.5.5.1.2.cmml">⁢</mo><mrow id="S2.E17.m1.5.5.1.1.1" xref="S2.E17.m1.5.5.1.1.1.1.cmml"><mo id="S2.E17.m1.5.5.1.1.1.2" stretchy="false" xref="S2.E17.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S2.E17.m1.5.5.1.1.1.1" xref="S2.E17.m1.5.5.1.1.1.1.cmml"><mi id="S2.E17.m1.5.5.1.1.1.1.2" xref="S2.E17.m1.5.5.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.E17.m1.5.5.1.1.1.1.1" xref="S2.E17.m1.5.5.1.1.1.1.1.cmml">|</mo><mi id="S2.E17.m1.5.5.1.1.1.1.3" xref="S2.E17.m1.5.5.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E17.m1.5.5.1.1.1.3" stretchy="false" xref="S2.E17.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E17.m1.6.6.2" xref="S2.E17.m1.6.6.2.cmml"><msub id="S2.E17.m1.6.6.2.3" xref="S2.E17.m1.6.6.2.3.cmml"><mi id="S2.E17.m1.6.6.2.3.2" xref="S2.E17.m1.6.6.2.3.2.cmml">π</mi><mn id="S2.E17.m1.6.6.2.3.3" xref="S2.E17.m1.6.6.2.3.3.cmml">0</mn></msub><mo id="S2.E17.m1.6.6.2.2" xref="S2.E17.m1.6.6.2.2.cmml">⁢</mo><mrow id="S2.E17.m1.6.6.2.1.1" xref="S2.E17.m1.6.6.2.1.1.1.cmml"><mo id="S2.E17.m1.6.6.2.1.1.2" stretchy="false" xref="S2.E17.m1.6.6.2.1.1.1.cmml">(</mo><mrow id="S2.E17.m1.6.6.2.1.1.1" xref="S2.E17.m1.6.6.2.1.1.1.cmml"><mi id="S2.E17.m1.6.6.2.1.1.1.2" xref="S2.E17.m1.6.6.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.E17.m1.6.6.2.1.1.1.1" xref="S2.E17.m1.6.6.2.1.1.1.1.cmml">|</mo><mi id="S2.E17.m1.6.6.2.1.1.1.3" xref="S2.E17.m1.6.6.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E17.m1.6.6.2.1.1.3" stretchy="false" xref="S2.E17.m1.6.6.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow></mrow><mo id="S2.E17.m1.9.9.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E17.m1.9b"><apply id="S2.E17.m1.9.9.1.1.3.cmml" xref="S2.E17.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S2.E17.m1.9.9.1.1.3a.cmml" xref="S2.E17.m1.9.9.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E17.m1.9.9.1.1.1.1.cmml" xref="S2.E17.m1.9.9.1.1.1.1"><eq id="S2.E17.m1.9.9.1.1.1.1.1.cmml" xref="S2.E17.m1.9.9.1.1.1.1.1"></eq><apply id="S2.E17.m1.9.9.1.1.1.1.2.cmml" xref="S2.E17.m1.9.9.1.1.1.1.2"><times id="S2.E17.m1.9.9.1.1.1.1.2.1.cmml" xref="S2.E17.m1.9.9.1.1.1.1.2.1"></times><ci id="S2.E17.m1.9.9.1.1.1.1.2.2a.cmml" xref="S2.E17.m1.9.9.1.1.1.1.2.2"><mrow id="S2.E17.m1.9.9.1.1.1.1.2.2.cmml" xref="S2.E17.m1.9.9.1.1.1.1.2.2"></mrow></ci><apply id="S2.E17.m1.9.9.1.1.1.1.2.3.cmml" xref="S2.E17.m1.9.9.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E17.m1.9.9.1.1.1.1.2.3.1.cmml" xref="S2.E17.m1.9.9.1.1.1.1.2.3">superscript</csymbol><ci id="S2.E17.m1.9.9.1.1.1.1.2.3.2.cmml" xref="S2.E17.m1.9.9.1.1.1.1.2.3.2">𝜋</ci><ci id="S2.E17.m1.9.9.1.1.1.1.2.3.3.cmml" xref="S2.E17.m1.9.9.1.1.1.1.2.3.3">⋆</ci></apply></apply><apply id="S2.E17.m1.9.9.1.1.1.1.3.cmml" xref="S2.E17.m1.9.9.1.1.1.1.3"><times id="S2.E17.m1.9.9.1.1.1.1.3.1.cmml" xref="S2.E17.m1.9.9.1.1.1.1.3.1"></times><apply id="S2.E17.m1.9.9.1.1.1.1.3.2.cmml" xref="S2.E17.m1.9.9.1.1.1.1.3.2"><apply id="S2.E17.m1.9.9.1.1.1.1.3.2.1.cmml" xref="S2.E17.m1.9.9.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S2.E17.m1.9.9.1.1.1.1.3.2.1.1.cmml" xref="S2.E17.m1.9.9.1.1.1.1.3.2.1">subscript</csymbol><apply id="S2.E17.m1.9.9.1.1.1.1.3.2.1.2.cmml" xref="S2.E17.m1.9.9.1.1.1.1.3.2.1.2"><times id="S2.E17.m1.9.9.1.1.1.1.3.2.1.2.1.cmml" xref="S2.E17.m1.9.9.1.1.1.1.3.2.1.2.1"></times><ci id="S2.E17.m1.9.9.1.1.1.1.3.2.1.2.2.cmml" xref="S2.E17.m1.9.9.1.1.1.1.3.2.1.2.2">arg</ci><ci id="S2.E17.m1.9.9.1.1.1.1.3.2.1.2.3.cmml" xref="S2.E17.m1.9.9.1.1.1.1.3.2.1.2.3">max</ci></apply><apply id="S2.E17.m1.9.9.1.1.1.1.3.2.1.3.cmml" xref="S2.E17.m1.9.9.1.1.1.1.3.2.1.3"><in id="S2.E17.m1.9.9.1.1.1.1.3.2.1.3.1.cmml" xref="S2.E17.m1.9.9.1.1.1.1.3.2.1.3.1"></in><ci id="S2.E17.m1.9.9.1.1.1.1.3.2.1.3.2.cmml" xref="S2.E17.m1.9.9.1.1.1.1.3.2.1.3.2">𝜋</ci><ci id="S2.E17.m1.9.9.1.1.1.1.3.2.1.3.3.cmml" xref="S2.E17.m1.9.9.1.1.1.1.3.2.1.3.3">Π</ci></apply></apply><apply id="S2.E17.m1.9.9.1.1.1.1.3.2.2.cmml" xref="S2.E17.m1.9.9.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E17.m1.9.9.1.1.1.1.3.2.2.1.cmml" xref="S2.E17.m1.9.9.1.1.1.1.3.2.2">subscript</csymbol><apply id="S2.E17.m1.9.9.1.1.1.1.3.2.2.2.cmml" xref="S2.E17.m1.9.9.1.1.1.1.3.2.2.2"><ci id="S2.E17.m1.9.9.1.1.1.1.3.2.2.2.1.cmml" xref="S2.E17.m1.9.9.1.1.1.1.3.2.2.2.1">^</ci><ci id="S2.E17.m1.9.9.1.1.1.1.3.2.2.2.2.cmml" xref="S2.E17.m1.9.9.1.1.1.1.3.2.2.2.2">𝑉</ci></apply><ci id="S2.E17.m1.9.9.1.1.1.1.3.2.2.3.cmml" xref="S2.E17.m1.9.9.1.1.1.1.3.2.2.3">SNIPS</ci></apply></apply><interval closure="open" id="S2.E17.m1.9.9.1.1.1.1.3.3.1.cmml" xref="S2.E17.m1.9.9.1.1.1.1.3.3.2"><ci id="S2.E17.m1.7.7.cmml" xref="S2.E17.m1.7.7">𝜋</ci><ci id="S2.E17.m1.8.8.cmml" xref="S2.E17.m1.8.8">𝒟</ci></interval></apply></apply><apply id="S2.E17.m1.9.9.1.1.2.2.cmml" xref="S2.E17.m1.9.9.1.1.2.2"><eq id="S2.E17.m1.9.9.1.1.2.2.1.cmml" xref="S2.E17.m1.9.9.1.1.2.2.1"></eq><apply id="S2.E17.m1.9.9.1.1.2.2.2.cmml" xref="S2.E17.m1.9.9.1.1.2.2.2"><times id="S2.E17.m1.9.9.1.1.2.2.2.1.cmml" xref="S2.E17.m1.9.9.1.1.2.2.2.1"></times><ci id="S2.E17.m1.9.9.1.1.2.2.2.2a.cmml" xref="S2.E17.m1.9.9.1.1.2.2.2.2"><mtext id="S2.E17.m1.9.9.1.1.2.2.2.2.cmml" xref="S2.E17.m1.9.9.1.1.2.2.2.2"> with </mtext></ci><apply id="S2.E17.m1.9.9.1.1.2.2.2.3.cmml" xref="S2.E17.m1.9.9.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S2.E17.m1.9.9.1.1.2.2.2.3.1.cmml" xref="S2.E17.m1.9.9.1.1.2.2.2.3">superscript</csymbol><ci id="S2.E17.m1.9.9.1.1.2.2.2.3.2.cmml" xref="S2.E17.m1.9.9.1.1.2.2.2.3.2">𝑆</ci><ci id="S2.E17.m1.9.9.1.1.2.2.2.3.3.cmml" xref="S2.E17.m1.9.9.1.1.2.2.2.3.3">⋆</ci></apply></apply><apply id="S2.E17.m1.9.9.1.1.2.2.3.cmml" xref="S2.E17.m1.9.9.1.1.2.2.3"><times id="S2.E17.m1.9.9.1.1.2.2.3.1.cmml" xref="S2.E17.m1.9.9.1.1.2.2.3.1"></times><apply id="S2.E17.m1.1.1.cmml" xref="S2.E17.m1.1.1"><divide id="S2.E17.m1.1.1.2.cmml" xref="S2.E17.m1.1.1"></divide><cn id="S2.E17.m1.1.1.3.cmml" type="integer" xref="S2.E17.m1.1.1.3">1</cn><apply id="S2.E17.m1.1.1.1.2.cmml" xref="S2.E17.m1.1.1.1.3"><abs id="S2.E17.m1.1.1.1.2.1.cmml" xref="S2.E17.m1.1.1.1.3.1"></abs><ci id="S2.E17.m1.1.1.1.1.cmml" xref="S2.E17.m1.1.1.1.1">𝒟</ci></apply></apply><apply id="S2.E17.m1.9.9.1.1.2.2.3.2.cmml" xref="S2.E17.m1.9.9.1.1.2.2.3.2"><apply id="S2.E17.m1.9.9.1.1.2.2.3.2.1.cmml" xref="S2.E17.m1.9.9.1.1.2.2.3.2.1"><csymbol cd="ambiguous" id="S2.E17.m1.9.9.1.1.2.2.3.2.1.1.cmml" xref="S2.E17.m1.9.9.1.1.2.2.3.2.1">subscript</csymbol><sum id="S2.E17.m1.9.9.1.1.2.2.3.2.1.2.cmml" xref="S2.E17.m1.9.9.1.1.2.2.3.2.1.2"></sum><apply id="S2.E17.m1.4.4.3.cmml" xref="S2.E17.m1.4.4.3"><in id="S2.E17.m1.4.4.3.4.cmml" xref="S2.E17.m1.4.4.3.4"></in><vector id="S2.E17.m1.4.4.3.5.1.cmml" xref="S2.E17.m1.4.4.3.5.2"><ci id="S2.E17.m1.2.2.1.1.cmml" xref="S2.E17.m1.2.2.1.1">𝑥</ci><ci id="S2.E17.m1.3.3.2.2.cmml" xref="S2.E17.m1.3.3.2.2">𝑎</ci><ci id="S2.E17.m1.4.4.3.3.cmml" xref="S2.E17.m1.4.4.3.3">𝑟</ci></vector><ci id="S2.E17.m1.4.4.3.6.cmml" xref="S2.E17.m1.4.4.3.6">𝒟</ci></apply></apply><apply id="S2.E17.m1.6.6.cmml" xref="S2.E17.m1.6.6"><divide id="S2.E17.m1.6.6.3.cmml" xref="S2.E17.m1.6.6"></divide><apply id="S2.E17.m1.5.5.1.cmml" xref="S2.E17.m1.5.5.1"><times id="S2.E17.m1.5.5.1.2.cmml" xref="S2.E17.m1.5.5.1.2"></times><apply id="S2.E17.m1.5.5.1.3.cmml" xref="S2.E17.m1.5.5.1.3"><csymbol cd="ambiguous" id="S2.E17.m1.5.5.1.3.1.cmml" xref="S2.E17.m1.5.5.1.3">superscript</csymbol><ci id="S2.E17.m1.5.5.1.3.2.cmml" xref="S2.E17.m1.5.5.1.3.2">𝜋</ci><ci id="S2.E17.m1.5.5.1.3.3.cmml" xref="S2.E17.m1.5.5.1.3.3">⋆</ci></apply><apply id="S2.E17.m1.5.5.1.1.1.1.cmml" xref="S2.E17.m1.5.5.1.1.1"><csymbol cd="latexml" id="S2.E17.m1.5.5.1.1.1.1.1.cmml" xref="S2.E17.m1.5.5.1.1.1.1.1">conditional</csymbol><ci id="S2.E17.m1.5.5.1.1.1.1.2.cmml" xref="S2.E17.m1.5.5.1.1.1.1.2">𝑎</ci><ci id="S2.E17.m1.5.5.1.1.1.1.3.cmml" xref="S2.E17.m1.5.5.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.E17.m1.6.6.2.cmml" xref="S2.E17.m1.6.6.2"><times id="S2.E17.m1.6.6.2.2.cmml" xref="S2.E17.m1.6.6.2.2"></times><apply id="S2.E17.m1.6.6.2.3.cmml" xref="S2.E17.m1.6.6.2.3"><csymbol cd="ambiguous" id="S2.E17.m1.6.6.2.3.1.cmml" xref="S2.E17.m1.6.6.2.3">subscript</csymbol><ci id="S2.E17.m1.6.6.2.3.2.cmml" xref="S2.E17.m1.6.6.2.3.2">𝜋</ci><cn id="S2.E17.m1.6.6.2.3.3.cmml" type="integer" xref="S2.E17.m1.6.6.2.3.3">0</cn></apply><apply id="S2.E17.m1.6.6.2.1.1.1.cmml" xref="S2.E17.m1.6.6.2.1.1"><csymbol cd="latexml" id="S2.E17.m1.6.6.2.1.1.1.1.cmml" xref="S2.E17.m1.6.6.2.1.1.1.1">conditional</csymbol><ci id="S2.E17.m1.6.6.2.1.1.1.2.cmml" xref="S2.E17.m1.6.6.2.1.1.1.2">𝑎</ci><ci id="S2.E17.m1.6.6.2.1.1.1.3.cmml" xref="S2.E17.m1.6.6.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E17.m1.9c">\mbox{}\pi^{\star}\!=\!\operatorname*{arg\,max}_{\pi\in\Pi}\widehat{V}_{\rm
SNIPS%
}(\pi,\mathcal{D}),\text{ with }S^{\star}\!=\!\frac{1}{\left|\mathcal{D}\right%
|}\!\sum_{(x,a,r)\in\mathcal{D}}\!\frac{\pi^{\star}(a|x)}{\pi_{0}(a|x)},</annotation><annotation encoding="application/x-llamapun" id="S2.E17.m1.9d">italic_π start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT = start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_π ∈ roman_Π end_POSTSUBSCRIPT over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_SNIPS end_POSTSUBSCRIPT ( italic_π , caligraphic_D ) , with italic_S start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT = divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) ∈ caligraphic_D end_POSTSUBSCRIPT divide start_ARG italic_π start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p7.9">then, we can equivalently state this as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(18)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\pi^{\star}=\operatorname*{arg\,max}_{\pi\in\Pi}\widehat{V}_{\rm IPS}(\pi,%
\mathcal{D}),\text{ s.th. }\frac{1}{\left|\mathcal{D}\right|}\sum_{(x,a,r)\in%
\mathcal{D}}\frac{\pi(a|x)}{\pi_{0}(a|x)}=S^{\star}." class="ltx_Math" display="block" id="S2.E18.m1.9"><semantics id="S2.E18.m1.9a"><mrow id="S2.E18.m1.9.9.1"><mrow id="S2.E18.m1.9.9.1.1.2" xref="S2.E18.m1.9.9.1.1.3.cmml"><mrow id="S2.E18.m1.9.9.1.1.1.1" xref="S2.E18.m1.9.9.1.1.1.1.cmml"><msup id="S2.E18.m1.9.9.1.1.1.1.2" xref="S2.E18.m1.9.9.1.1.1.1.2.cmml"><mi id="S2.E18.m1.9.9.1.1.1.1.2.2" xref="S2.E18.m1.9.9.1.1.1.1.2.2.cmml">π</mi><mo id="S2.E18.m1.9.9.1.1.1.1.2.3" xref="S2.E18.m1.9.9.1.1.1.1.2.3.cmml">⋆</mo></msup><mo id="S2.E18.m1.9.9.1.1.1.1.1" xref="S2.E18.m1.9.9.1.1.1.1.1.cmml">=</mo><mrow id="S2.E18.m1.9.9.1.1.1.1.3" xref="S2.E18.m1.9.9.1.1.1.1.3.cmml"><mrow id="S2.E18.m1.9.9.1.1.1.1.3.2" xref="S2.E18.m1.9.9.1.1.1.1.3.2.cmml"><munder id="S2.E18.m1.9.9.1.1.1.1.3.2.1" xref="S2.E18.m1.9.9.1.1.1.1.3.2.1.cmml"><mrow id="S2.E18.m1.9.9.1.1.1.1.3.2.1.2" xref="S2.E18.m1.9.9.1.1.1.1.3.2.1.2.cmml"><mi id="S2.E18.m1.9.9.1.1.1.1.3.2.1.2.2" xref="S2.E18.m1.9.9.1.1.1.1.3.2.1.2.2.cmml">arg</mi><mo id="S2.E18.m1.9.9.1.1.1.1.3.2.1.2.1" lspace="0.170em" xref="S2.E18.m1.9.9.1.1.1.1.3.2.1.2.1.cmml">⁢</mo><mi id="S2.E18.m1.9.9.1.1.1.1.3.2.1.2.3" xref="S2.E18.m1.9.9.1.1.1.1.3.2.1.2.3.cmml">max</mi></mrow><mrow id="S2.E18.m1.9.9.1.1.1.1.3.2.1.3" xref="S2.E18.m1.9.9.1.1.1.1.3.2.1.3.cmml"><mi id="S2.E18.m1.9.9.1.1.1.1.3.2.1.3.2" xref="S2.E18.m1.9.9.1.1.1.1.3.2.1.3.2.cmml">π</mi><mo id="S2.E18.m1.9.9.1.1.1.1.3.2.1.3.1" xref="S2.E18.m1.9.9.1.1.1.1.3.2.1.3.1.cmml">∈</mo><mi id="S2.E18.m1.9.9.1.1.1.1.3.2.1.3.3" mathvariant="normal" xref="S2.E18.m1.9.9.1.1.1.1.3.2.1.3.3.cmml">Π</mi></mrow></munder><mo id="S2.E18.m1.9.9.1.1.1.1.3.2a" xref="S2.E18.m1.9.9.1.1.1.1.3.2.cmml">⁡</mo><msub id="S2.E18.m1.9.9.1.1.1.1.3.2.2" xref="S2.E18.m1.9.9.1.1.1.1.3.2.2.cmml"><mover accent="true" id="S2.E18.m1.9.9.1.1.1.1.3.2.2.2" xref="S2.E18.m1.9.9.1.1.1.1.3.2.2.2.cmml"><mi id="S2.E18.m1.9.9.1.1.1.1.3.2.2.2.2" xref="S2.E18.m1.9.9.1.1.1.1.3.2.2.2.2.cmml">V</mi><mo id="S2.E18.m1.9.9.1.1.1.1.3.2.2.2.1" xref="S2.E18.m1.9.9.1.1.1.1.3.2.2.2.1.cmml">^</mo></mover><mi id="S2.E18.m1.9.9.1.1.1.1.3.2.2.3" xref="S2.E18.m1.9.9.1.1.1.1.3.2.2.3.cmml">IPS</mi></msub></mrow><mo id="S2.E18.m1.9.9.1.1.1.1.3.1" xref="S2.E18.m1.9.9.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.E18.m1.9.9.1.1.1.1.3.3.2" xref="S2.E18.m1.9.9.1.1.1.1.3.3.1.cmml"><mo id="S2.E18.m1.9.9.1.1.1.1.3.3.2.1" stretchy="false" xref="S2.E18.m1.9.9.1.1.1.1.3.3.1.cmml">(</mo><mi id="S2.E18.m1.7.7" xref="S2.E18.m1.7.7.cmml">π</mi><mo id="S2.E18.m1.9.9.1.1.1.1.3.3.2.2" xref="S2.E18.m1.9.9.1.1.1.1.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.E18.m1.8.8" xref="S2.E18.m1.8.8.cmml">𝒟</mi><mo id="S2.E18.m1.9.9.1.1.1.1.3.3.2.3" stretchy="false" xref="S2.E18.m1.9.9.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E18.m1.9.9.1.1.2.3" xref="S2.E18.m1.9.9.1.1.3a.cmml">,</mo><mrow id="S2.E18.m1.9.9.1.1.2.2" xref="S2.E18.m1.9.9.1.1.2.2.cmml"><mrow id="S2.E18.m1.9.9.1.1.2.2.2" xref="S2.E18.m1.9.9.1.1.2.2.2.cmml"><mtext id="S2.E18.m1.9.9.1.1.2.2.2.2" xref="S2.E18.m1.9.9.1.1.2.2.2.2a.cmml"> s.th. </mtext><mo id="S2.E18.m1.9.9.1.1.2.2.2.1" xref="S2.E18.m1.9.9.1.1.2.2.2.1.cmml">⁢</mo><mfrac id="S2.E18.m1.1.1" xref="S2.E18.m1.1.1.cmml"><mn id="S2.E18.m1.1.1.3" xref="S2.E18.m1.1.1.3.cmml">1</mn><mrow id="S2.E18.m1.1.1.1.3" xref="S2.E18.m1.1.1.1.2.cmml"><mo id="S2.E18.m1.1.1.1.3.1" xref="S2.E18.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.E18.m1.1.1.1.1" xref="S2.E18.m1.1.1.1.1.cmml">𝒟</mi><mo id="S2.E18.m1.1.1.1.3.2" xref="S2.E18.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S2.E18.m1.9.9.1.1.2.2.2.1a" xref="S2.E18.m1.9.9.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S2.E18.m1.9.9.1.1.2.2.2.3" xref="S2.E18.m1.9.9.1.1.2.2.2.3.cmml"><munder id="S2.E18.m1.9.9.1.1.2.2.2.3.1" xref="S2.E18.m1.9.9.1.1.2.2.2.3.1.cmml"><mo id="S2.E18.m1.9.9.1.1.2.2.2.3.1.2" movablelimits="false" xref="S2.E18.m1.9.9.1.1.2.2.2.3.1.2.cmml">∑</mo><mrow id="S2.E18.m1.4.4.3" xref="S2.E18.m1.4.4.3.cmml"><mrow id="S2.E18.m1.4.4.3.5.2" xref="S2.E18.m1.4.4.3.5.1.cmml"><mo id="S2.E18.m1.4.4.3.5.2.1" stretchy="false" xref="S2.E18.m1.4.4.3.5.1.cmml">(</mo><mi id="S2.E18.m1.2.2.1.1" xref="S2.E18.m1.2.2.1.1.cmml">x</mi><mo id="S2.E18.m1.4.4.3.5.2.2" xref="S2.E18.m1.4.4.3.5.1.cmml">,</mo><mi id="S2.E18.m1.3.3.2.2" xref="S2.E18.m1.3.3.2.2.cmml">a</mi><mo id="S2.E18.m1.4.4.3.5.2.3" xref="S2.E18.m1.4.4.3.5.1.cmml">,</mo><mi id="S2.E18.m1.4.4.3.3" xref="S2.E18.m1.4.4.3.3.cmml">r</mi><mo id="S2.E18.m1.4.4.3.5.2.4" stretchy="false" xref="S2.E18.m1.4.4.3.5.1.cmml">)</mo></mrow><mo id="S2.E18.m1.4.4.3.4" xref="S2.E18.m1.4.4.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E18.m1.4.4.3.6" xref="S2.E18.m1.4.4.3.6.cmml">𝒟</mi></mrow></munder><mfrac id="S2.E18.m1.6.6" xref="S2.E18.m1.6.6.cmml"><mrow id="S2.E18.m1.5.5.1" xref="S2.E18.m1.5.5.1.cmml"><mi id="S2.E18.m1.5.5.1.3" xref="S2.E18.m1.5.5.1.3.cmml">π</mi><mo id="S2.E18.m1.5.5.1.2" xref="S2.E18.m1.5.5.1.2.cmml">⁢</mo><mrow id="S2.E18.m1.5.5.1.1.1" xref="S2.E18.m1.5.5.1.1.1.1.cmml"><mo id="S2.E18.m1.5.5.1.1.1.2" stretchy="false" xref="S2.E18.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S2.E18.m1.5.5.1.1.1.1" xref="S2.E18.m1.5.5.1.1.1.1.cmml"><mi id="S2.E18.m1.5.5.1.1.1.1.2" xref="S2.E18.m1.5.5.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.E18.m1.5.5.1.1.1.1.1" xref="S2.E18.m1.5.5.1.1.1.1.1.cmml">|</mo><mi id="S2.E18.m1.5.5.1.1.1.1.3" xref="S2.E18.m1.5.5.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E18.m1.5.5.1.1.1.3" stretchy="false" xref="S2.E18.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E18.m1.6.6.2" xref="S2.E18.m1.6.6.2.cmml"><msub id="S2.E18.m1.6.6.2.3" xref="S2.E18.m1.6.6.2.3.cmml"><mi id="S2.E18.m1.6.6.2.3.2" xref="S2.E18.m1.6.6.2.3.2.cmml">π</mi><mn id="S2.E18.m1.6.6.2.3.3" xref="S2.E18.m1.6.6.2.3.3.cmml">0</mn></msub><mo id="S2.E18.m1.6.6.2.2" xref="S2.E18.m1.6.6.2.2.cmml">⁢</mo><mrow id="S2.E18.m1.6.6.2.1.1" xref="S2.E18.m1.6.6.2.1.1.1.cmml"><mo id="S2.E18.m1.6.6.2.1.1.2" stretchy="false" xref="S2.E18.m1.6.6.2.1.1.1.cmml">(</mo><mrow id="S2.E18.m1.6.6.2.1.1.1" xref="S2.E18.m1.6.6.2.1.1.1.cmml"><mi id="S2.E18.m1.6.6.2.1.1.1.2" xref="S2.E18.m1.6.6.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.E18.m1.6.6.2.1.1.1.1" xref="S2.E18.m1.6.6.2.1.1.1.1.cmml">|</mo><mi id="S2.E18.m1.6.6.2.1.1.1.3" xref="S2.E18.m1.6.6.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E18.m1.6.6.2.1.1.3" stretchy="false" xref="S2.E18.m1.6.6.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="S2.E18.m1.9.9.1.1.2.2.1" xref="S2.E18.m1.9.9.1.1.2.2.1.cmml">=</mo><msup id="S2.E18.m1.9.9.1.1.2.2.3" xref="S2.E18.m1.9.9.1.1.2.2.3.cmml"><mi id="S2.E18.m1.9.9.1.1.2.2.3.2" xref="S2.E18.m1.9.9.1.1.2.2.3.2.cmml">S</mi><mo id="S2.E18.m1.9.9.1.1.2.2.3.3" xref="S2.E18.m1.9.9.1.1.2.2.3.3.cmml">⋆</mo></msup></mrow></mrow><mo id="S2.E18.m1.9.9.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E18.m1.9b"><apply id="S2.E18.m1.9.9.1.1.3.cmml" xref="S2.E18.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S2.E18.m1.9.9.1.1.3a.cmml" xref="S2.E18.m1.9.9.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E18.m1.9.9.1.1.1.1.cmml" xref="S2.E18.m1.9.9.1.1.1.1"><eq id="S2.E18.m1.9.9.1.1.1.1.1.cmml" xref="S2.E18.m1.9.9.1.1.1.1.1"></eq><apply id="S2.E18.m1.9.9.1.1.1.1.2.cmml" xref="S2.E18.m1.9.9.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E18.m1.9.9.1.1.1.1.2.1.cmml" xref="S2.E18.m1.9.9.1.1.1.1.2">superscript</csymbol><ci id="S2.E18.m1.9.9.1.1.1.1.2.2.cmml" xref="S2.E18.m1.9.9.1.1.1.1.2.2">𝜋</ci><ci id="S2.E18.m1.9.9.1.1.1.1.2.3.cmml" xref="S2.E18.m1.9.9.1.1.1.1.2.3">⋆</ci></apply><apply id="S2.E18.m1.9.9.1.1.1.1.3.cmml" xref="S2.E18.m1.9.9.1.1.1.1.3"><times id="S2.E18.m1.9.9.1.1.1.1.3.1.cmml" xref="S2.E18.m1.9.9.1.1.1.1.3.1"></times><apply id="S2.E18.m1.9.9.1.1.1.1.3.2.cmml" xref="S2.E18.m1.9.9.1.1.1.1.3.2"><apply id="S2.E18.m1.9.9.1.1.1.1.3.2.1.cmml" xref="S2.E18.m1.9.9.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S2.E18.m1.9.9.1.1.1.1.3.2.1.1.cmml" xref="S2.E18.m1.9.9.1.1.1.1.3.2.1">subscript</csymbol><apply id="S2.E18.m1.9.9.1.1.1.1.3.2.1.2.cmml" xref="S2.E18.m1.9.9.1.1.1.1.3.2.1.2"><times id="S2.E18.m1.9.9.1.1.1.1.3.2.1.2.1.cmml" xref="S2.E18.m1.9.9.1.1.1.1.3.2.1.2.1"></times><ci id="S2.E18.m1.9.9.1.1.1.1.3.2.1.2.2.cmml" xref="S2.E18.m1.9.9.1.1.1.1.3.2.1.2.2">arg</ci><ci id="S2.E18.m1.9.9.1.1.1.1.3.2.1.2.3.cmml" xref="S2.E18.m1.9.9.1.1.1.1.3.2.1.2.3">max</ci></apply><apply id="S2.E18.m1.9.9.1.1.1.1.3.2.1.3.cmml" xref="S2.E18.m1.9.9.1.1.1.1.3.2.1.3"><in id="S2.E18.m1.9.9.1.1.1.1.3.2.1.3.1.cmml" xref="S2.E18.m1.9.9.1.1.1.1.3.2.1.3.1"></in><ci id="S2.E18.m1.9.9.1.1.1.1.3.2.1.3.2.cmml" xref="S2.E18.m1.9.9.1.1.1.1.3.2.1.3.2">𝜋</ci><ci id="S2.E18.m1.9.9.1.1.1.1.3.2.1.3.3.cmml" xref="S2.E18.m1.9.9.1.1.1.1.3.2.1.3.3">Π</ci></apply></apply><apply id="S2.E18.m1.9.9.1.1.1.1.3.2.2.cmml" xref="S2.E18.m1.9.9.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E18.m1.9.9.1.1.1.1.3.2.2.1.cmml" xref="S2.E18.m1.9.9.1.1.1.1.3.2.2">subscript</csymbol><apply id="S2.E18.m1.9.9.1.1.1.1.3.2.2.2.cmml" xref="S2.E18.m1.9.9.1.1.1.1.3.2.2.2"><ci id="S2.E18.m1.9.9.1.1.1.1.3.2.2.2.1.cmml" xref="S2.E18.m1.9.9.1.1.1.1.3.2.2.2.1">^</ci><ci id="S2.E18.m1.9.9.1.1.1.1.3.2.2.2.2.cmml" xref="S2.E18.m1.9.9.1.1.1.1.3.2.2.2.2">𝑉</ci></apply><ci id="S2.E18.m1.9.9.1.1.1.1.3.2.2.3.cmml" xref="S2.E18.m1.9.9.1.1.1.1.3.2.2.3">IPS</ci></apply></apply><interval closure="open" id="S2.E18.m1.9.9.1.1.1.1.3.3.1.cmml" xref="S2.E18.m1.9.9.1.1.1.1.3.3.2"><ci id="S2.E18.m1.7.7.cmml" xref="S2.E18.m1.7.7">𝜋</ci><ci id="S2.E18.m1.8.8.cmml" xref="S2.E18.m1.8.8">𝒟</ci></interval></apply></apply><apply id="S2.E18.m1.9.9.1.1.2.2.cmml" xref="S2.E18.m1.9.9.1.1.2.2"><eq id="S2.E18.m1.9.9.1.1.2.2.1.cmml" xref="S2.E18.m1.9.9.1.1.2.2.1"></eq><apply id="S2.E18.m1.9.9.1.1.2.2.2.cmml" xref="S2.E18.m1.9.9.1.1.2.2.2"><times id="S2.E18.m1.9.9.1.1.2.2.2.1.cmml" xref="S2.E18.m1.9.9.1.1.2.2.2.1"></times><ci id="S2.E18.m1.9.9.1.1.2.2.2.2a.cmml" xref="S2.E18.m1.9.9.1.1.2.2.2.2"><mtext id="S2.E18.m1.9.9.1.1.2.2.2.2.cmml" xref="S2.E18.m1.9.9.1.1.2.2.2.2"> s.th. </mtext></ci><apply id="S2.E18.m1.1.1.cmml" xref="S2.E18.m1.1.1"><divide id="S2.E18.m1.1.1.2.cmml" xref="S2.E18.m1.1.1"></divide><cn id="S2.E18.m1.1.1.3.cmml" type="integer" xref="S2.E18.m1.1.1.3">1</cn><apply id="S2.E18.m1.1.1.1.2.cmml" xref="S2.E18.m1.1.1.1.3"><abs id="S2.E18.m1.1.1.1.2.1.cmml" xref="S2.E18.m1.1.1.1.3.1"></abs><ci id="S2.E18.m1.1.1.1.1.cmml" xref="S2.E18.m1.1.1.1.1">𝒟</ci></apply></apply><apply id="S2.E18.m1.9.9.1.1.2.2.2.3.cmml" xref="S2.E18.m1.9.9.1.1.2.2.2.3"><apply id="S2.E18.m1.9.9.1.1.2.2.2.3.1.cmml" xref="S2.E18.m1.9.9.1.1.2.2.2.3.1"><csymbol cd="ambiguous" id="S2.E18.m1.9.9.1.1.2.2.2.3.1.1.cmml" xref="S2.E18.m1.9.9.1.1.2.2.2.3.1">subscript</csymbol><sum id="S2.E18.m1.9.9.1.1.2.2.2.3.1.2.cmml" xref="S2.E18.m1.9.9.1.1.2.2.2.3.1.2"></sum><apply id="S2.E18.m1.4.4.3.cmml" xref="S2.E18.m1.4.4.3"><in id="S2.E18.m1.4.4.3.4.cmml" xref="S2.E18.m1.4.4.3.4"></in><vector id="S2.E18.m1.4.4.3.5.1.cmml" xref="S2.E18.m1.4.4.3.5.2"><ci id="S2.E18.m1.2.2.1.1.cmml" xref="S2.E18.m1.2.2.1.1">𝑥</ci><ci id="S2.E18.m1.3.3.2.2.cmml" xref="S2.E18.m1.3.3.2.2">𝑎</ci><ci id="S2.E18.m1.4.4.3.3.cmml" xref="S2.E18.m1.4.4.3.3">𝑟</ci></vector><ci id="S2.E18.m1.4.4.3.6.cmml" xref="S2.E18.m1.4.4.3.6">𝒟</ci></apply></apply><apply id="S2.E18.m1.6.6.cmml" xref="S2.E18.m1.6.6"><divide id="S2.E18.m1.6.6.3.cmml" xref="S2.E18.m1.6.6"></divide><apply id="S2.E18.m1.5.5.1.cmml" xref="S2.E18.m1.5.5.1"><times id="S2.E18.m1.5.5.1.2.cmml" xref="S2.E18.m1.5.5.1.2"></times><ci id="S2.E18.m1.5.5.1.3.cmml" xref="S2.E18.m1.5.5.1.3">𝜋</ci><apply id="S2.E18.m1.5.5.1.1.1.1.cmml" xref="S2.E18.m1.5.5.1.1.1"><csymbol cd="latexml" id="S2.E18.m1.5.5.1.1.1.1.1.cmml" xref="S2.E18.m1.5.5.1.1.1.1.1">conditional</csymbol><ci id="S2.E18.m1.5.5.1.1.1.1.2.cmml" xref="S2.E18.m1.5.5.1.1.1.1.2">𝑎</ci><ci id="S2.E18.m1.5.5.1.1.1.1.3.cmml" xref="S2.E18.m1.5.5.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.E18.m1.6.6.2.cmml" xref="S2.E18.m1.6.6.2"><times id="S2.E18.m1.6.6.2.2.cmml" xref="S2.E18.m1.6.6.2.2"></times><apply id="S2.E18.m1.6.6.2.3.cmml" xref="S2.E18.m1.6.6.2.3"><csymbol cd="ambiguous" id="S2.E18.m1.6.6.2.3.1.cmml" xref="S2.E18.m1.6.6.2.3">subscript</csymbol><ci id="S2.E18.m1.6.6.2.3.2.cmml" xref="S2.E18.m1.6.6.2.3.2">𝜋</ci><cn id="S2.E18.m1.6.6.2.3.3.cmml" type="integer" xref="S2.E18.m1.6.6.2.3.3">0</cn></apply><apply id="S2.E18.m1.6.6.2.1.1.1.cmml" xref="S2.E18.m1.6.6.2.1.1"><csymbol cd="latexml" id="S2.E18.m1.6.6.2.1.1.1.1.cmml" xref="S2.E18.m1.6.6.2.1.1.1.1">conditional</csymbol><ci id="S2.E18.m1.6.6.2.1.1.1.2.cmml" xref="S2.E18.m1.6.6.2.1.1.1.2">𝑎</ci><ci id="S2.E18.m1.6.6.2.1.1.1.3.cmml" xref="S2.E18.m1.6.6.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply><apply id="S2.E18.m1.9.9.1.1.2.2.3.cmml" xref="S2.E18.m1.9.9.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E18.m1.9.9.1.1.2.2.3.1.cmml" xref="S2.E18.m1.9.9.1.1.2.2.3">superscript</csymbol><ci id="S2.E18.m1.9.9.1.1.2.2.3.2.cmml" xref="S2.E18.m1.9.9.1.1.2.2.3.2">𝑆</ci><ci id="S2.E18.m1.9.9.1.1.2.2.3.3.cmml" xref="S2.E18.m1.9.9.1.1.2.2.3.3">⋆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E18.m1.9c">\pi^{\star}=\operatorname*{arg\,max}_{\pi\in\Pi}\widehat{V}_{\rm IPS}(\pi,%
\mathcal{D}),\text{ s.th. }\frac{1}{\left|\mathcal{D}\right|}\sum_{(x,a,r)\in%
\mathcal{D}}\frac{\pi(a|x)}{\pi_{0}(a|x)}=S^{\star}.</annotation><annotation encoding="application/x-llamapun" id="S2.E18.m1.9d">italic_π start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT = start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_π ∈ roman_Π end_POSTSUBSCRIPT over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_IPS end_POSTSUBSCRIPT ( italic_π , caligraphic_D ) , s.th. divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) ∈ caligraphic_D end_POSTSUBSCRIPT divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG = italic_S start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p7.3"><cite class="ltx_cite ltx_citemacro_citet">Joachims et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib34" title="">2018</a>)</cite> show via the Lagrange multiplier method that this optimization problem can be solved by optimising for <math alttext="\widehat{V}_{\rm IPS}" class="ltx_Math" display="inline" id="S2.SS2.p7.3.m1.1"><semantics id="S2.SS2.p7.3.m1.1a"><msub id="S2.SS2.p7.3.m1.1.1" xref="S2.SS2.p7.3.m1.1.1.cmml"><mover accent="true" id="S2.SS2.p7.3.m1.1.1.2" xref="S2.SS2.p7.3.m1.1.1.2.cmml"><mi id="S2.SS2.p7.3.m1.1.1.2.2" xref="S2.SS2.p7.3.m1.1.1.2.2.cmml">V</mi><mo id="S2.SS2.p7.3.m1.1.1.2.1" xref="S2.SS2.p7.3.m1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.p7.3.m1.1.1.3" xref="S2.SS2.p7.3.m1.1.1.3.cmml">IPS</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.3.m1.1b"><apply id="S2.SS2.p7.3.m1.1.1.cmml" xref="S2.SS2.p7.3.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p7.3.m1.1.1.1.cmml" xref="S2.SS2.p7.3.m1.1.1">subscript</csymbol><apply id="S2.SS2.p7.3.m1.1.1.2.cmml" xref="S2.SS2.p7.3.m1.1.1.2"><ci id="S2.SS2.p7.3.m1.1.1.2.1.cmml" xref="S2.SS2.p7.3.m1.1.1.2.1">^</ci><ci id="S2.SS2.p7.3.m1.1.1.2.2.cmml" xref="S2.SS2.p7.3.m1.1.1.2.2">𝑉</ci></apply><ci id="S2.SS2.p7.3.m1.1.1.3.cmml" xref="S2.SS2.p7.3.m1.1.1.3">IPS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.3.m1.1c">\widehat{V}_{\rm IPS}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p7.3.m1.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_IPS end_POSTSUBSCRIPT</annotation></semantics></math> with a translation on the reward:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E19">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(19)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\pi^{\star}=\operatorname*{arg\,max}_{\pi\in\Pi}\widehat{V}_{%
\lambda^{\star}\text{-}{\rm IPS}}(\pi,\mathcal{D}),\text{where }\\
\widehat{V}_{\lambda\text{-}{\rm IPS}}(\pi,\mathcal{D})=\frac{1}{\left|%
\mathcal{D}\right|}\sum_{(x,a,r)\in\mathcal{D}}\frac{\pi(a|x)}{\pi_{0}(a|x)}(r%
-\lambda).\end{split}" class="ltx_Math" display="block" id="S2.E19.m1.35"><semantics id="S2.E19.m1.35a"><mtable displaystyle="true" id="S2.E19.m1.35.35.3" rowspacing="0pt"><mtr id="S2.E19.m1.35.35.3a"><mtd class="ltx_align_right" columnalign="right" id="S2.E19.m1.35.35.3b"><mrow id="S2.E19.m1.34.34.2.33.15.15"><msup id="S2.E19.m1.34.34.2.33.15.15.16"><mi id="S2.E19.m1.1.1.1.1.1.1" xref="S2.E19.m1.1.1.1.1.1.1.cmml">π</mi><mo id="S2.E19.m1.2.2.2.2.2.2.1" xref="S2.E19.m1.2.2.2.2.2.2.1.cmml">⋆</mo></msup><mo id="S2.E19.m1.3.3.3.3.3.3" xref="S2.E19.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S2.E19.m1.34.34.2.33.15.15.15.1"><mrow id="S2.E19.m1.34.34.2.33.15.15.15.1.1"><mrow id="S2.E19.m1.34.34.2.33.15.15.15.1.1.2"><munder id="S2.E19.m1.34.34.2.33.15.15.15.1.1.2.1"><mrow id="S2.E19.m1.4.4.4.4.4.4" xref="S2.E19.m1.4.4.4.4.4.4.cmml"><mi id="S2.E19.m1.4.4.4.4.4.4.2" xref="S2.E19.m1.4.4.4.4.4.4.2.cmml">arg</mi><mo id="S2.E19.m1.4.4.4.4.4.4.1" lspace="0.170em" xref="S2.E19.m1.4.4.4.4.4.4.1.cmml">⁢</mo><mi id="S2.E19.m1.4.4.4.4.4.4.3" xref="S2.E19.m1.4.4.4.4.4.4.3.cmml">max</mi></mrow><mrow id="S2.E19.m1.5.5.5.5.5.5.1" xref="S2.E19.m1.5.5.5.5.5.5.1.cmml"><mi id="S2.E19.m1.5.5.5.5.5.5.1.2" xref="S2.E19.m1.5.5.5.5.5.5.1.2.cmml">π</mi><mo id="S2.E19.m1.5.5.5.5.5.5.1.1" xref="S2.E19.m1.5.5.5.5.5.5.1.1.cmml">∈</mo><mi id="S2.E19.m1.5.5.5.5.5.5.1.3" mathvariant="normal" xref="S2.E19.m1.5.5.5.5.5.5.1.3.cmml">Π</mi></mrow></munder><mo id="S2.E19.m1.34.34.2.33.15.15.15.1.1.2a">⁡</mo><msub id="S2.E19.m1.34.34.2.33.15.15.15.1.1.2.2"><mover accent="true" id="S2.E19.m1.6.6.6.6.6.6" xref="S2.E19.m1.6.6.6.6.6.6.cmml"><mi id="S2.E19.m1.6.6.6.6.6.6.2" xref="S2.E19.m1.6.6.6.6.6.6.2.cmml">V</mi><mo id="S2.E19.m1.6.6.6.6.6.6.1" xref="S2.E19.m1.6.6.6.6.6.6.1.cmml">^</mo></mover><mrow id="S2.E19.m1.7.7.7.7.7.7.1" xref="S2.E19.m1.7.7.7.7.7.7.1.cmml"><msup id="S2.E19.m1.7.7.7.7.7.7.1.2" xref="S2.E19.m1.7.7.7.7.7.7.1.2.cmml"><mi id="S2.E19.m1.7.7.7.7.7.7.1.2.2" xref="S2.E19.m1.7.7.7.7.7.7.1.2.2.cmml">λ</mi><mo id="S2.E19.m1.7.7.7.7.7.7.1.2.3" xref="S2.E19.m1.7.7.7.7.7.7.1.2.3.cmml">⋆</mo></msup><mo id="S2.E19.m1.7.7.7.7.7.7.1.1" xref="S2.E19.m1.7.7.7.7.7.7.1.1.cmml">⁢</mo><mtext id="S2.E19.m1.7.7.7.7.7.7.1.3" xref="S2.E19.m1.7.7.7.7.7.7.1.3a.cmml">-</mtext><mo id="S2.E19.m1.7.7.7.7.7.7.1.1a" xref="S2.E19.m1.7.7.7.7.7.7.1.1.cmml">⁢</mo><mi id="S2.E19.m1.7.7.7.7.7.7.1.4" xref="S2.E19.m1.7.7.7.7.7.7.1.4.cmml">IPS</mi></mrow></msub></mrow><mo id="S2.E19.m1.34.34.2.33.15.15.15.1.1.1">⁢</mo><mrow id="S2.E19.m1.34.34.2.33.15.15.15.1.1.3"><mo id="S2.E19.m1.8.8.8.8.8.8" stretchy="false">(</mo><mi id="S2.E19.m1.9.9.9.9.9.9" xref="S2.E19.m1.9.9.9.9.9.9.cmml">π</mi><mo id="S2.E19.m1.10.10.10.10.10.10">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.E19.m1.11.11.11.11.11.11" xref="S2.E19.m1.11.11.11.11.11.11.cmml">𝒟</mi><mo id="S2.E19.m1.12.12.12.12.12.12" stretchy="false">)</mo></mrow></mrow><mo id="S2.E19.m1.13.13.13.13.13.13">,</mo><mtext id="S2.E19.m1.14.14.14.14.14.14" xref="S2.E19.m1.14.14.14.14.14.14a.cmml">where </mtext></mrow></mrow></mtd></mtr><mtr id="S2.E19.m1.35.35.3c"><mtd class="ltx_align_right" columnalign="right" id="S2.E19.m1.35.35.3d"><mrow id="S2.E19.m1.35.35.3.34.19.19.19"><mrow id="S2.E19.m1.35.35.3.34.19.19.19.1"><mrow id="S2.E19.m1.35.35.3.34.19.19.19.1.2"><msub id="S2.E19.m1.35.35.3.34.19.19.19.1.2.2"><mover accent="true" id="S2.E19.m1.15.15.15.1.1.1" xref="S2.E19.m1.15.15.15.1.1.1.cmml"><mi id="S2.E19.m1.15.15.15.1.1.1.2" xref="S2.E19.m1.15.15.15.1.1.1.2.cmml">V</mi><mo id="S2.E19.m1.15.15.15.1.1.1.1" xref="S2.E19.m1.15.15.15.1.1.1.1.cmml">^</mo></mover><mrow id="S2.E19.m1.16.16.16.2.2.2.1" xref="S2.E19.m1.16.16.16.2.2.2.1.cmml"><mi id="S2.E19.m1.16.16.16.2.2.2.1.2" xref="S2.E19.m1.16.16.16.2.2.2.1.2.cmml">λ</mi><mo id="S2.E19.m1.16.16.16.2.2.2.1.1" xref="S2.E19.m1.16.16.16.2.2.2.1.1.cmml">⁢</mo><mtext id="S2.E19.m1.16.16.16.2.2.2.1.3" xref="S2.E19.m1.16.16.16.2.2.2.1.3a.cmml">-</mtext><mo id="S2.E19.m1.16.16.16.2.2.2.1.1a" xref="S2.E19.m1.16.16.16.2.2.2.1.1.cmml">⁢</mo><mi id="S2.E19.m1.16.16.16.2.2.2.1.4" xref="S2.E19.m1.16.16.16.2.2.2.1.4.cmml">IPS</mi></mrow></msub><mo id="S2.E19.m1.35.35.3.34.19.19.19.1.2.1">⁢</mo><mrow id="S2.E19.m1.35.35.3.34.19.19.19.1.2.3"><mo id="S2.E19.m1.17.17.17.3.3.3" stretchy="false">(</mo><mi id="S2.E19.m1.18.18.18.4.4.4" xref="S2.E19.m1.18.18.18.4.4.4.cmml">π</mi><mo id="S2.E19.m1.19.19.19.5.5.5">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.E19.m1.20.20.20.6.6.6" xref="S2.E19.m1.20.20.20.6.6.6.cmml">𝒟</mi><mo id="S2.E19.m1.21.21.21.7.7.7" stretchy="false">)</mo></mrow></mrow><mo id="S2.E19.m1.22.22.22.8.8.8" xref="S2.E19.m1.22.22.22.8.8.8.cmml">=</mo><mrow id="S2.E19.m1.35.35.3.34.19.19.19.1.1"><mfrac id="S2.E19.m1.23.23.23.9.9.9" xref="S2.E19.m1.23.23.23.9.9.9.cmml"><mn id="S2.E19.m1.23.23.23.9.9.9.3" xref="S2.E19.m1.23.23.23.9.9.9.3.cmml">1</mn><mrow id="S2.E19.m1.23.23.23.9.9.9.1.3" xref="S2.E19.m1.23.23.23.9.9.9.1.2.cmml"><mo id="S2.E19.m1.23.23.23.9.9.9.1.3.1" xref="S2.E19.m1.23.23.23.9.9.9.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.E19.m1.23.23.23.9.9.9.1.1" xref="S2.E19.m1.23.23.23.9.9.9.1.1.cmml">𝒟</mi><mo id="S2.E19.m1.23.23.23.9.9.9.1.3.2" xref="S2.E19.m1.23.23.23.9.9.9.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S2.E19.m1.35.35.3.34.19.19.19.1.1.2">⁢</mo><mrow id="S2.E19.m1.35.35.3.34.19.19.19.1.1.1"><munder id="S2.E19.m1.35.35.3.34.19.19.19.1.1.1.2"><mo id="S2.E19.m1.24.24.24.10.10.10" movablelimits="false" xref="S2.E19.m1.24.24.24.10.10.10.cmml">∑</mo><mrow id="S2.E19.m1.25.25.25.11.11.11.1" xref="S2.E19.m1.25.25.25.11.11.11.1.cmml"><mrow id="S2.E19.m1.25.25.25.11.11.11.1.5.2" xref="S2.E19.m1.25.25.25.11.11.11.1.5.1.cmml"><mo id="S2.E19.m1.25.25.25.11.11.11.1.5.2.1" stretchy="false" xref="S2.E19.m1.25.25.25.11.11.11.1.5.1.cmml">(</mo><mi id="S2.E19.m1.25.25.25.11.11.11.1.1" xref="S2.E19.m1.25.25.25.11.11.11.1.1.cmml">x</mi><mo id="S2.E19.m1.25.25.25.11.11.11.1.5.2.2" xref="S2.E19.m1.25.25.25.11.11.11.1.5.1.cmml">,</mo><mi id="S2.E19.m1.25.25.25.11.11.11.1.2" xref="S2.E19.m1.25.25.25.11.11.11.1.2.cmml">a</mi><mo id="S2.E19.m1.25.25.25.11.11.11.1.5.2.3" xref="S2.E19.m1.25.25.25.11.11.11.1.5.1.cmml">,</mo><mi id="S2.E19.m1.25.25.25.11.11.11.1.3" xref="S2.E19.m1.25.25.25.11.11.11.1.3.cmml">r</mi><mo id="S2.E19.m1.25.25.25.11.11.11.1.5.2.4" stretchy="false" xref="S2.E19.m1.25.25.25.11.11.11.1.5.1.cmml">)</mo></mrow><mo id="S2.E19.m1.25.25.25.11.11.11.1.4" xref="S2.E19.m1.25.25.25.11.11.11.1.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E19.m1.25.25.25.11.11.11.1.6" xref="S2.E19.m1.25.25.25.11.11.11.1.6.cmml">𝒟</mi></mrow></munder><mrow id="S2.E19.m1.35.35.3.34.19.19.19.1.1.1.1"><mfrac id="S2.E19.m1.26.26.26.12.12.12" xref="S2.E19.m1.26.26.26.12.12.12.cmml"><mrow id="S2.E19.m1.26.26.26.12.12.12.1" xref="S2.E19.m1.26.26.26.12.12.12.1.cmml"><mi id="S2.E19.m1.26.26.26.12.12.12.1.3" xref="S2.E19.m1.26.26.26.12.12.12.1.3.cmml">π</mi><mo id="S2.E19.m1.26.26.26.12.12.12.1.2" xref="S2.E19.m1.26.26.26.12.12.12.1.2.cmml">⁢</mo><mrow id="S2.E19.m1.26.26.26.12.12.12.1.1.1" xref="S2.E19.m1.26.26.26.12.12.12.1.1.1.1.cmml"><mo id="S2.E19.m1.26.26.26.12.12.12.1.1.1.2" stretchy="false" xref="S2.E19.m1.26.26.26.12.12.12.1.1.1.1.cmml">(</mo><mrow id="S2.E19.m1.26.26.26.12.12.12.1.1.1.1" xref="S2.E19.m1.26.26.26.12.12.12.1.1.1.1.cmml"><mi id="S2.E19.m1.26.26.26.12.12.12.1.1.1.1.2" xref="S2.E19.m1.26.26.26.12.12.12.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.E19.m1.26.26.26.12.12.12.1.1.1.1.1" xref="S2.E19.m1.26.26.26.12.12.12.1.1.1.1.1.cmml">|</mo><mi id="S2.E19.m1.26.26.26.12.12.12.1.1.1.1.3" xref="S2.E19.m1.26.26.26.12.12.12.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E19.m1.26.26.26.12.12.12.1.1.1.3" stretchy="false" xref="S2.E19.m1.26.26.26.12.12.12.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E19.m1.26.26.26.12.12.12.2" xref="S2.E19.m1.26.26.26.12.12.12.2.cmml"><msub id="S2.E19.m1.26.26.26.12.12.12.2.3" xref="S2.E19.m1.26.26.26.12.12.12.2.3.cmml"><mi id="S2.E19.m1.26.26.26.12.12.12.2.3.2" xref="S2.E19.m1.26.26.26.12.12.12.2.3.2.cmml">π</mi><mn id="S2.E19.m1.26.26.26.12.12.12.2.3.3" xref="S2.E19.m1.26.26.26.12.12.12.2.3.3.cmml">0</mn></msub><mo id="S2.E19.m1.26.26.26.12.12.12.2.2" xref="S2.E19.m1.26.26.26.12.12.12.2.2.cmml">⁢</mo><mrow id="S2.E19.m1.26.26.26.12.12.12.2.1.1" xref="S2.E19.m1.26.26.26.12.12.12.2.1.1.1.cmml"><mo id="S2.E19.m1.26.26.26.12.12.12.2.1.1.2" stretchy="false" xref="S2.E19.m1.26.26.26.12.12.12.2.1.1.1.cmml">(</mo><mrow id="S2.E19.m1.26.26.26.12.12.12.2.1.1.1" xref="S2.E19.m1.26.26.26.12.12.12.2.1.1.1.cmml"><mi id="S2.E19.m1.26.26.26.12.12.12.2.1.1.1.2" xref="S2.E19.m1.26.26.26.12.12.12.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.E19.m1.26.26.26.12.12.12.2.1.1.1.1" xref="S2.E19.m1.26.26.26.12.12.12.2.1.1.1.1.cmml">|</mo><mi id="S2.E19.m1.26.26.26.12.12.12.2.1.1.1.3" xref="S2.E19.m1.26.26.26.12.12.12.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E19.m1.26.26.26.12.12.12.2.1.1.3" stretchy="false" xref="S2.E19.m1.26.26.26.12.12.12.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S2.E19.m1.35.35.3.34.19.19.19.1.1.1.1.2">⁢</mo><mrow id="S2.E19.m1.35.35.3.34.19.19.19.1.1.1.1.1.1"><mo id="S2.E19.m1.27.27.27.13.13.13" stretchy="false">(</mo><mrow id="S2.E19.m1.35.35.3.34.19.19.19.1.1.1.1.1.1.1"><mi id="S2.E19.m1.28.28.28.14.14.14" xref="S2.E19.m1.28.28.28.14.14.14.cmml">r</mi><mo id="S2.E19.m1.29.29.29.15.15.15" xref="S2.E19.m1.29.29.29.15.15.15.cmml">−</mo><mi id="S2.E19.m1.30.30.30.16.16.16" xref="S2.E19.m1.30.30.30.16.16.16.cmml">λ</mi></mrow><mo id="S2.E19.m1.31.31.31.17.17.17" stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E19.m1.32.32.32.18.18.18" lspace="0em">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S2.E19.m1.35b"><apply id="S2.E19.m1.33.33.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S2.E19.m1.33.33.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S2.E19.m1.33.33.1.1.1.1.1.cmml"><eq id="S2.E19.m1.3.3.3.3.3.3.cmml" xref="S2.E19.m1.3.3.3.3.3.3"></eq><apply id="S2.E19.m1.33.33.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S2.E19.m1.33.33.1.1.1.1.1.2.1.cmml">superscript</csymbol><ci id="S2.E19.m1.1.1.1.1.1.1.cmml" xref="S2.E19.m1.1.1.1.1.1.1">𝜋</ci><ci id="S2.E19.m1.2.2.2.2.2.2.1.cmml" xref="S2.E19.m1.2.2.2.2.2.2.1">⋆</ci></apply><apply id="S2.E19.m1.33.33.1.1.1.1.1.3.cmml"><times id="S2.E19.m1.33.33.1.1.1.1.1.3.1.cmml"></times><apply id="S2.E19.m1.33.33.1.1.1.1.1.3.2.cmml"><apply id="S2.E19.m1.33.33.1.1.1.1.1.3.2.1.cmml"><csymbol cd="ambiguous" id="S2.E19.m1.33.33.1.1.1.1.1.3.2.1.1.cmml">subscript</csymbol><apply id="S2.E19.m1.4.4.4.4.4.4.cmml" xref="S2.E19.m1.4.4.4.4.4.4"><times id="S2.E19.m1.4.4.4.4.4.4.1.cmml" xref="S2.E19.m1.4.4.4.4.4.4.1"></times><ci id="S2.E19.m1.4.4.4.4.4.4.2.cmml" xref="S2.E19.m1.4.4.4.4.4.4.2">arg</ci><ci id="S2.E19.m1.4.4.4.4.4.4.3.cmml" xref="S2.E19.m1.4.4.4.4.4.4.3">max</ci></apply><apply id="S2.E19.m1.5.5.5.5.5.5.1.cmml" xref="S2.E19.m1.5.5.5.5.5.5.1"><in id="S2.E19.m1.5.5.5.5.5.5.1.1.cmml" xref="S2.E19.m1.5.5.5.5.5.5.1.1"></in><ci id="S2.E19.m1.5.5.5.5.5.5.1.2.cmml" xref="S2.E19.m1.5.5.5.5.5.5.1.2">𝜋</ci><ci id="S2.E19.m1.5.5.5.5.5.5.1.3.cmml" xref="S2.E19.m1.5.5.5.5.5.5.1.3">Π</ci></apply></apply><apply id="S2.E19.m1.33.33.1.1.1.1.1.3.2.2.cmml"><csymbol cd="ambiguous" id="S2.E19.m1.33.33.1.1.1.1.1.3.2.2.1.cmml">subscript</csymbol><apply id="S2.E19.m1.6.6.6.6.6.6.cmml" xref="S2.E19.m1.6.6.6.6.6.6"><ci id="S2.E19.m1.6.6.6.6.6.6.1.cmml" xref="S2.E19.m1.6.6.6.6.6.6.1">^</ci><ci id="S2.E19.m1.6.6.6.6.6.6.2.cmml" xref="S2.E19.m1.6.6.6.6.6.6.2">𝑉</ci></apply><apply id="S2.E19.m1.7.7.7.7.7.7.1.cmml" xref="S2.E19.m1.7.7.7.7.7.7.1"><times id="S2.E19.m1.7.7.7.7.7.7.1.1.cmml" xref="S2.E19.m1.7.7.7.7.7.7.1.1"></times><apply id="S2.E19.m1.7.7.7.7.7.7.1.2.cmml" xref="S2.E19.m1.7.7.7.7.7.7.1.2"><csymbol cd="ambiguous" id="S2.E19.m1.7.7.7.7.7.7.1.2.1.cmml" xref="S2.E19.m1.7.7.7.7.7.7.1.2">superscript</csymbol><ci id="S2.E19.m1.7.7.7.7.7.7.1.2.2.cmml" xref="S2.E19.m1.7.7.7.7.7.7.1.2.2">𝜆</ci><ci id="S2.E19.m1.7.7.7.7.7.7.1.2.3.cmml" xref="S2.E19.m1.7.7.7.7.7.7.1.2.3">⋆</ci></apply><ci id="S2.E19.m1.7.7.7.7.7.7.1.3a.cmml" xref="S2.E19.m1.7.7.7.7.7.7.1.3"><mtext id="S2.E19.m1.7.7.7.7.7.7.1.3.cmml" mathsize="70%" xref="S2.E19.m1.7.7.7.7.7.7.1.3">-</mtext></ci><ci id="S2.E19.m1.7.7.7.7.7.7.1.4.cmml" xref="S2.E19.m1.7.7.7.7.7.7.1.4">IPS</ci></apply></apply></apply><interval closure="open" id="S2.E19.m1.33.33.1.1.1.1.1.3.3.cmml"><ci id="S2.E19.m1.9.9.9.9.9.9.cmml" xref="S2.E19.m1.9.9.9.9.9.9">𝜋</ci><ci id="S2.E19.m1.11.11.11.11.11.11.cmml" xref="S2.E19.m1.11.11.11.11.11.11">𝒟</ci></interval></apply></apply><apply id="S2.E19.m1.33.33.1.1.1.2.2.cmml"><eq id="S2.E19.m1.22.22.22.8.8.8.cmml" xref="S2.E19.m1.22.22.22.8.8.8"></eq><apply id="S2.E19.m1.33.33.1.1.1.2.2.3.cmml"><times id="S2.E19.m1.33.33.1.1.1.2.2.3.1.cmml"></times><ci id="S2.E19.m1.14.14.14.14.14.14a.cmml" xref="S2.E19.m1.14.14.14.14.14.14"><mtext id="S2.E19.m1.14.14.14.14.14.14.cmml" xref="S2.E19.m1.14.14.14.14.14.14">where </mtext></ci><apply id="S2.E19.m1.33.33.1.1.1.2.2.3.3.cmml"><csymbol cd="ambiguous" id="S2.E19.m1.33.33.1.1.1.2.2.3.3.1.cmml">subscript</csymbol><apply id="S2.E19.m1.15.15.15.1.1.1.cmml" xref="S2.E19.m1.15.15.15.1.1.1"><ci id="S2.E19.m1.15.15.15.1.1.1.1.cmml" xref="S2.E19.m1.15.15.15.1.1.1.1">^</ci><ci id="S2.E19.m1.15.15.15.1.1.1.2.cmml" xref="S2.E19.m1.15.15.15.1.1.1.2">𝑉</ci></apply><apply id="S2.E19.m1.16.16.16.2.2.2.1.cmml" xref="S2.E19.m1.16.16.16.2.2.2.1"><times id="S2.E19.m1.16.16.16.2.2.2.1.1.cmml" xref="S2.E19.m1.16.16.16.2.2.2.1.1"></times><ci id="S2.E19.m1.16.16.16.2.2.2.1.2.cmml" xref="S2.E19.m1.16.16.16.2.2.2.1.2">𝜆</ci><ci id="S2.E19.m1.16.16.16.2.2.2.1.3a.cmml" xref="S2.E19.m1.16.16.16.2.2.2.1.3"><mtext id="S2.E19.m1.16.16.16.2.2.2.1.3.cmml" mathsize="70%" xref="S2.E19.m1.16.16.16.2.2.2.1.3">-</mtext></ci><ci id="S2.E19.m1.16.16.16.2.2.2.1.4.cmml" xref="S2.E19.m1.16.16.16.2.2.2.1.4">IPS</ci></apply></apply><interval closure="open" id="S2.E19.m1.33.33.1.1.1.2.2.3.4.cmml"><ci id="S2.E19.m1.18.18.18.4.4.4.cmml" xref="S2.E19.m1.18.18.18.4.4.4">𝜋</ci><ci id="S2.E19.m1.20.20.20.6.6.6.cmml" xref="S2.E19.m1.20.20.20.6.6.6">𝒟</ci></interval></apply><apply id="S2.E19.m1.33.33.1.1.1.2.2.1.cmml"><times id="S2.E19.m1.33.33.1.1.1.2.2.1.2.cmml"></times><apply id="S2.E19.m1.23.23.23.9.9.9.cmml" xref="S2.E19.m1.23.23.23.9.9.9"><divide id="S2.E19.m1.23.23.23.9.9.9.2.cmml" xref="S2.E19.m1.23.23.23.9.9.9"></divide><cn id="S2.E19.m1.23.23.23.9.9.9.3.cmml" type="integer" xref="S2.E19.m1.23.23.23.9.9.9.3">1</cn><apply id="S2.E19.m1.23.23.23.9.9.9.1.2.cmml" xref="S2.E19.m1.23.23.23.9.9.9.1.3"><abs id="S2.E19.m1.23.23.23.9.9.9.1.2.1.cmml" xref="S2.E19.m1.23.23.23.9.9.9.1.3.1"></abs><ci id="S2.E19.m1.23.23.23.9.9.9.1.1.cmml" xref="S2.E19.m1.23.23.23.9.9.9.1.1">𝒟</ci></apply></apply><apply id="S2.E19.m1.33.33.1.1.1.2.2.1.1.cmml"><apply id="S2.E19.m1.33.33.1.1.1.2.2.1.1.2.cmml"><csymbol cd="ambiguous" id="S2.E19.m1.33.33.1.1.1.2.2.1.1.2.1.cmml">subscript</csymbol><sum id="S2.E19.m1.24.24.24.10.10.10.cmml" xref="S2.E19.m1.24.24.24.10.10.10"></sum><apply id="S2.E19.m1.25.25.25.11.11.11.1.cmml" xref="S2.E19.m1.25.25.25.11.11.11.1"><in id="S2.E19.m1.25.25.25.11.11.11.1.4.cmml" xref="S2.E19.m1.25.25.25.11.11.11.1.4"></in><vector id="S2.E19.m1.25.25.25.11.11.11.1.5.1.cmml" xref="S2.E19.m1.25.25.25.11.11.11.1.5.2"><ci id="S2.E19.m1.25.25.25.11.11.11.1.1.cmml" xref="S2.E19.m1.25.25.25.11.11.11.1.1">𝑥</ci><ci id="S2.E19.m1.25.25.25.11.11.11.1.2.cmml" xref="S2.E19.m1.25.25.25.11.11.11.1.2">𝑎</ci><ci id="S2.E19.m1.25.25.25.11.11.11.1.3.cmml" xref="S2.E19.m1.25.25.25.11.11.11.1.3">𝑟</ci></vector><ci id="S2.E19.m1.25.25.25.11.11.11.1.6.cmml" xref="S2.E19.m1.25.25.25.11.11.11.1.6">𝒟</ci></apply></apply><apply id="S2.E19.m1.33.33.1.1.1.2.2.1.1.1.cmml"><times id="S2.E19.m1.33.33.1.1.1.2.2.1.1.1.2.cmml"></times><apply id="S2.E19.m1.26.26.26.12.12.12.cmml" xref="S2.E19.m1.26.26.26.12.12.12"><divide id="S2.E19.m1.26.26.26.12.12.12.3.cmml" xref="S2.E19.m1.26.26.26.12.12.12"></divide><apply id="S2.E19.m1.26.26.26.12.12.12.1.cmml" xref="S2.E19.m1.26.26.26.12.12.12.1"><times id="S2.E19.m1.26.26.26.12.12.12.1.2.cmml" xref="S2.E19.m1.26.26.26.12.12.12.1.2"></times><ci id="S2.E19.m1.26.26.26.12.12.12.1.3.cmml" xref="S2.E19.m1.26.26.26.12.12.12.1.3">𝜋</ci><apply id="S2.E19.m1.26.26.26.12.12.12.1.1.1.1.cmml" xref="S2.E19.m1.26.26.26.12.12.12.1.1.1"><csymbol cd="latexml" id="S2.E19.m1.26.26.26.12.12.12.1.1.1.1.1.cmml" xref="S2.E19.m1.26.26.26.12.12.12.1.1.1.1.1">conditional</csymbol><ci id="S2.E19.m1.26.26.26.12.12.12.1.1.1.1.2.cmml" xref="S2.E19.m1.26.26.26.12.12.12.1.1.1.1.2">𝑎</ci><ci id="S2.E19.m1.26.26.26.12.12.12.1.1.1.1.3.cmml" xref="S2.E19.m1.26.26.26.12.12.12.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.E19.m1.26.26.26.12.12.12.2.cmml" xref="S2.E19.m1.26.26.26.12.12.12.2"><times id="S2.E19.m1.26.26.26.12.12.12.2.2.cmml" xref="S2.E19.m1.26.26.26.12.12.12.2.2"></times><apply id="S2.E19.m1.26.26.26.12.12.12.2.3.cmml" xref="S2.E19.m1.26.26.26.12.12.12.2.3"><csymbol cd="ambiguous" id="S2.E19.m1.26.26.26.12.12.12.2.3.1.cmml" xref="S2.E19.m1.26.26.26.12.12.12.2.3">subscript</csymbol><ci id="S2.E19.m1.26.26.26.12.12.12.2.3.2.cmml" xref="S2.E19.m1.26.26.26.12.12.12.2.3.2">𝜋</ci><cn id="S2.E19.m1.26.26.26.12.12.12.2.3.3.cmml" type="integer" xref="S2.E19.m1.26.26.26.12.12.12.2.3.3">0</cn></apply><apply id="S2.E19.m1.26.26.26.12.12.12.2.1.1.1.cmml" xref="S2.E19.m1.26.26.26.12.12.12.2.1.1"><csymbol cd="latexml" id="S2.E19.m1.26.26.26.12.12.12.2.1.1.1.1.cmml" xref="S2.E19.m1.26.26.26.12.12.12.2.1.1.1.1">conditional</csymbol><ci id="S2.E19.m1.26.26.26.12.12.12.2.1.1.1.2.cmml" xref="S2.E19.m1.26.26.26.12.12.12.2.1.1.1.2">𝑎</ci><ci id="S2.E19.m1.26.26.26.12.12.12.2.1.1.1.3.cmml" xref="S2.E19.m1.26.26.26.12.12.12.2.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="S2.E19.m1.33.33.1.1.1.2.2.1.1.1.1.1.1.cmml"><minus id="S2.E19.m1.29.29.29.15.15.15.cmml" xref="S2.E19.m1.29.29.29.15.15.15"></minus><ci id="S2.E19.m1.28.28.28.14.14.14.cmml" xref="S2.E19.m1.28.28.28.14.14.14">𝑟</ci><ci id="S2.E19.m1.30.30.30.16.16.16.cmml" xref="S2.E19.m1.30.30.30.16.16.16">𝜆</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E19.m1.35c">\begin{split}\pi^{\star}=\operatorname*{arg\,max}_{\pi\in\Pi}\widehat{V}_{%
\lambda^{\star}\text{-}{\rm IPS}}(\pi,\mathcal{D}),\text{where }\\
\widehat{V}_{\lambda\text{-}{\rm IPS}}(\pi,\mathcal{D})=\frac{1}{\left|%
\mathcal{D}\right|}\sum_{(x,a,r)\in\mathcal{D}}\frac{\pi(a|x)}{\pi_{0}(a|x)}(r%
-\lambda).\end{split}</annotation><annotation encoding="application/x-llamapun" id="S2.E19.m1.35d">start_ROW start_CELL italic_π start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT = start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_π ∈ roman_Π end_POSTSUBSCRIPT over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_λ start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT - roman_IPS end_POSTSUBSCRIPT ( italic_π , caligraphic_D ) , where end_CELL end_ROW start_ROW start_CELL over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_λ - roman_IPS end_POSTSUBSCRIPT ( italic_π , caligraphic_D ) = divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) ∈ caligraphic_D end_POSTSUBSCRIPT divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ( italic_r - italic_λ ) . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p7.8">This approach is called BanditNet <cite class="ltx_cite ltx_citemacro_citep">(Joachims et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib34" title="">2018</a>)</cite>.
Naturally, we do not know <math alttext="\lambda^{\star}" class="ltx_Math" display="inline" id="S2.SS2.p7.4.m1.1"><semantics id="S2.SS2.p7.4.m1.1a"><msup id="S2.SS2.p7.4.m1.1.1" xref="S2.SS2.p7.4.m1.1.1.cmml"><mi id="S2.SS2.p7.4.m1.1.1.2" xref="S2.SS2.p7.4.m1.1.1.2.cmml">λ</mi><mo id="S2.SS2.p7.4.m1.1.1.3" xref="S2.SS2.p7.4.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.4.m1.1b"><apply id="S2.SS2.p7.4.m1.1.1.cmml" xref="S2.SS2.p7.4.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p7.4.m1.1.1.1.cmml" xref="S2.SS2.p7.4.m1.1.1">superscript</csymbol><ci id="S2.SS2.p7.4.m1.1.1.2.cmml" xref="S2.SS2.p7.4.m1.1.1.2">𝜆</ci><ci id="S2.SS2.p7.4.m1.1.1.3.cmml" xref="S2.SS2.p7.4.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.4.m1.1c">\lambda^{\star}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p7.4.m1.1d">italic_λ start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math> beforehand (because we do not know <math alttext="S^{\star}" class="ltx_Math" display="inline" id="S2.SS2.p7.5.m2.1"><semantics id="S2.SS2.p7.5.m2.1a"><msup id="S2.SS2.p7.5.m2.1.1" xref="S2.SS2.p7.5.m2.1.1.cmml"><mi id="S2.SS2.p7.5.m2.1.1.2" xref="S2.SS2.p7.5.m2.1.1.2.cmml">S</mi><mo id="S2.SS2.p7.5.m2.1.1.3" xref="S2.SS2.p7.5.m2.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.5.m2.1b"><apply id="S2.SS2.p7.5.m2.1.1.cmml" xref="S2.SS2.p7.5.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p7.5.m2.1.1.1.cmml" xref="S2.SS2.p7.5.m2.1.1">superscript</csymbol><ci id="S2.SS2.p7.5.m2.1.1.2.cmml" xref="S2.SS2.p7.5.m2.1.1.2">𝑆</ci><ci id="S2.SS2.p7.5.m2.1.1.3.cmml" xref="S2.SS2.p7.5.m2.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.5.m2.1c">S^{\star}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p7.5.m2.1d">italic_S start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math>), but we know that <math alttext="S^{\star}" class="ltx_Math" display="inline" id="S2.SS2.p7.6.m3.1"><semantics id="S2.SS2.p7.6.m3.1a"><msup id="S2.SS2.p7.6.m3.1.1" xref="S2.SS2.p7.6.m3.1.1.cmml"><mi id="S2.SS2.p7.6.m3.1.1.2" xref="S2.SS2.p7.6.m3.1.1.2.cmml">S</mi><mo id="S2.SS2.p7.6.m3.1.1.3" xref="S2.SS2.p7.6.m3.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.6.m3.1b"><apply id="S2.SS2.p7.6.m3.1.1.cmml" xref="S2.SS2.p7.6.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p7.6.m3.1.1.1.cmml" xref="S2.SS2.p7.6.m3.1.1">superscript</csymbol><ci id="S2.SS2.p7.6.m3.1.1.2.cmml" xref="S2.SS2.p7.6.m3.1.1.2">𝑆</ci><ci id="S2.SS2.p7.6.m3.1.1.3.cmml" xref="S2.SS2.p7.6.m3.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.6.m3.1c">S^{\star}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p7.6.m3.1d">italic_S start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math> should concentrate around 1 for large datasets (see Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2.E14" title="In 2.2. Off-policy estimation for general bandits ‣ 2. Background and Related Work ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">14</span></a>).
<cite class="ltx_cite ltx_citemacro_citet">Joachims et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib34" title="">2018</a>)</cite> essentially propose to treat <math alttext="\lambda" class="ltx_Math" display="inline" id="S2.SS2.p7.7.m4.1"><semantics id="S2.SS2.p7.7.m4.1a"><mi id="S2.SS2.p7.7.m4.1.1" xref="S2.SS2.p7.7.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.7.m4.1b"><ci id="S2.SS2.p7.7.m4.1.1.cmml" xref="S2.SS2.p7.7.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.7.m4.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p7.7.m4.1d">italic_λ</annotation></semantics></math> as a hyper-parameter to be tuned in order to find <math alttext="S^{\star}" class="ltx_Math" display="inline" id="S2.SS2.p7.8.m5.1"><semantics id="S2.SS2.p7.8.m5.1a"><msup id="S2.SS2.p7.8.m5.1.1" xref="S2.SS2.p7.8.m5.1.1.cmml"><mi id="S2.SS2.p7.8.m5.1.1.2" xref="S2.SS2.p7.8.m5.1.1.2.cmml">S</mi><mo id="S2.SS2.p7.8.m5.1.1.3" xref="S2.SS2.p7.8.m5.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.8.m5.1b"><apply id="S2.SS2.p7.8.m5.1.1.cmml" xref="S2.SS2.p7.8.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p7.8.m5.1.1.1.cmml" xref="S2.SS2.p7.8.m5.1.1">superscript</csymbol><ci id="S2.SS2.p7.8.m5.1.1.2.cmml" xref="S2.SS2.p7.8.m5.1.1.2">𝑆</ci><ci id="S2.SS2.p7.8.m5.1.1.3.cmml" xref="S2.SS2.p7.8.m5.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.8.m5.1c">S^{\star}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p7.8.m5.1d">italic_S start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p8">
<p class="ltx_p" id="S2.SS2.p8.4"><span class="ltx_text ltx_font_bold" id="S2.SS2.p8.4.1">Doubly robust estimation. </span>
Another way to reduce the variance of <math alttext="\widehat{V}_{\rm IPS}" class="ltx_Math" display="inline" id="S2.SS2.p8.1.m1.1"><semantics id="S2.SS2.p8.1.m1.1a"><msub id="S2.SS2.p8.1.m1.1.1" xref="S2.SS2.p8.1.m1.1.1.cmml"><mover accent="true" id="S2.SS2.p8.1.m1.1.1.2" xref="S2.SS2.p8.1.m1.1.1.2.cmml"><mi id="S2.SS2.p8.1.m1.1.1.2.2" xref="S2.SS2.p8.1.m1.1.1.2.2.cmml">V</mi><mo id="S2.SS2.p8.1.m1.1.1.2.1" xref="S2.SS2.p8.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.p8.1.m1.1.1.3" xref="S2.SS2.p8.1.m1.1.1.3.cmml">IPS</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p8.1.m1.1b"><apply id="S2.SS2.p8.1.m1.1.1.cmml" xref="S2.SS2.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p8.1.m1.1.1.1.cmml" xref="S2.SS2.p8.1.m1.1.1">subscript</csymbol><apply id="S2.SS2.p8.1.m1.1.1.2.cmml" xref="S2.SS2.p8.1.m1.1.1.2"><ci id="S2.SS2.p8.1.m1.1.1.2.1.cmml" xref="S2.SS2.p8.1.m1.1.1.2.1">^</ci><ci id="S2.SS2.p8.1.m1.1.1.2.2.cmml" xref="S2.SS2.p8.1.m1.1.1.2.2">𝑉</ci></apply><ci id="S2.SS2.p8.1.m1.1.1.3.cmml" xref="S2.SS2.p8.1.m1.1.1.3">IPS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p8.1.m1.1c">\widehat{V}_{\rm IPS}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p8.1.m1.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_IPS end_POSTSUBSCRIPT</annotation></semantics></math> is to use a model of the reward <math alttext="\widehat{r}(a,x)\approx\mathbb{E}[R|X=x;A=a]" class="ltx_Math" display="inline" id="S2.SS2.p8.2.m2.3"><semantics id="S2.SS2.p8.2.m2.3a"><mrow id="S2.SS2.p8.2.m2.3.3" xref="S2.SS2.p8.2.m2.3.3.cmml"><mrow id="S2.SS2.p8.2.m2.3.3.3" xref="S2.SS2.p8.2.m2.3.3.3.cmml"><mover accent="true" id="S2.SS2.p8.2.m2.3.3.3.2" xref="S2.SS2.p8.2.m2.3.3.3.2.cmml"><mi id="S2.SS2.p8.2.m2.3.3.3.2.2" xref="S2.SS2.p8.2.m2.3.3.3.2.2.cmml">r</mi><mo id="S2.SS2.p8.2.m2.3.3.3.2.1" xref="S2.SS2.p8.2.m2.3.3.3.2.1.cmml">^</mo></mover><mo id="S2.SS2.p8.2.m2.3.3.3.1" xref="S2.SS2.p8.2.m2.3.3.3.1.cmml">⁢</mo><mrow id="S2.SS2.p8.2.m2.3.3.3.3.2" xref="S2.SS2.p8.2.m2.3.3.3.3.1.cmml"><mo id="S2.SS2.p8.2.m2.3.3.3.3.2.1" stretchy="false" xref="S2.SS2.p8.2.m2.3.3.3.3.1.cmml">(</mo><mi id="S2.SS2.p8.2.m2.1.1" xref="S2.SS2.p8.2.m2.1.1.cmml">a</mi><mo id="S2.SS2.p8.2.m2.3.3.3.3.2.2" xref="S2.SS2.p8.2.m2.3.3.3.3.1.cmml">,</mo><mi id="S2.SS2.p8.2.m2.2.2" xref="S2.SS2.p8.2.m2.2.2.cmml">x</mi><mo id="S2.SS2.p8.2.m2.3.3.3.3.2.3" stretchy="false" xref="S2.SS2.p8.2.m2.3.3.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p8.2.m2.3.3.2" xref="S2.SS2.p8.2.m2.3.3.2.cmml">≈</mo><mrow id="S2.SS2.p8.2.m2.3.3.1" xref="S2.SS2.p8.2.m2.3.3.1.cmml"><mi id="S2.SS2.p8.2.m2.3.3.1.3" xref="S2.SS2.p8.2.m2.3.3.1.3.cmml">𝔼</mi><mo id="S2.SS2.p8.2.m2.3.3.1.2" xref="S2.SS2.p8.2.m2.3.3.1.2.cmml">⁢</mo><mrow id="S2.SS2.p8.2.m2.3.3.1.1.1" xref="S2.SS2.p8.2.m2.3.3.1.1.2.cmml"><mo id="S2.SS2.p8.2.m2.3.3.1.1.1.2" stretchy="false" xref="S2.SS2.p8.2.m2.3.3.1.1.2.1.cmml">[</mo><mrow id="S2.SS2.p8.2.m2.3.3.1.1.1.1.2" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.3.cmml"><mrow id="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.cmml"><mrow id="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.2" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.2.cmml"><mi id="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.2.2" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.2.2.cmml">R</mi><mo fence="false" id="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.2.1" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.2.1.cmml">|</mo><mi id="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.2.3" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.2.3.cmml">X</mi></mrow><mo id="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.1" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.1.cmml">=</mo><mi id="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.3" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS2.p8.2.m2.3.3.1.1.1.1.2.3" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.3a.cmml">;</mo><mrow id="S2.SS2.p8.2.m2.3.3.1.1.1.1.2.2" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.2.2.cmml"><mi id="S2.SS2.p8.2.m2.3.3.1.1.1.1.2.2.2" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.2.2.2.cmml">A</mi><mo id="S2.SS2.p8.2.m2.3.3.1.1.1.1.2.2.1" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.2.2.1.cmml">=</mo><mi id="S2.SS2.p8.2.m2.3.3.1.1.1.1.2.2.3" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.2.2.3.cmml">a</mi></mrow></mrow><mo id="S2.SS2.p8.2.m2.3.3.1.1.1.3" stretchy="false" xref="S2.SS2.p8.2.m2.3.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p8.2.m2.3b"><apply id="S2.SS2.p8.2.m2.3.3.cmml" xref="S2.SS2.p8.2.m2.3.3"><approx id="S2.SS2.p8.2.m2.3.3.2.cmml" xref="S2.SS2.p8.2.m2.3.3.2"></approx><apply id="S2.SS2.p8.2.m2.3.3.3.cmml" xref="S2.SS2.p8.2.m2.3.3.3"><times id="S2.SS2.p8.2.m2.3.3.3.1.cmml" xref="S2.SS2.p8.2.m2.3.3.3.1"></times><apply id="S2.SS2.p8.2.m2.3.3.3.2.cmml" xref="S2.SS2.p8.2.m2.3.3.3.2"><ci id="S2.SS2.p8.2.m2.3.3.3.2.1.cmml" xref="S2.SS2.p8.2.m2.3.3.3.2.1">^</ci><ci id="S2.SS2.p8.2.m2.3.3.3.2.2.cmml" xref="S2.SS2.p8.2.m2.3.3.3.2.2">𝑟</ci></apply><interval closure="open" id="S2.SS2.p8.2.m2.3.3.3.3.1.cmml" xref="S2.SS2.p8.2.m2.3.3.3.3.2"><ci id="S2.SS2.p8.2.m2.1.1.cmml" xref="S2.SS2.p8.2.m2.1.1">𝑎</ci><ci id="S2.SS2.p8.2.m2.2.2.cmml" xref="S2.SS2.p8.2.m2.2.2">𝑥</ci></interval></apply><apply id="S2.SS2.p8.2.m2.3.3.1.cmml" xref="S2.SS2.p8.2.m2.3.3.1"><times id="S2.SS2.p8.2.m2.3.3.1.2.cmml" xref="S2.SS2.p8.2.m2.3.3.1.2"></times><ci id="S2.SS2.p8.2.m2.3.3.1.3.cmml" xref="S2.SS2.p8.2.m2.3.3.1.3">𝔼</ci><apply id="S2.SS2.p8.2.m2.3.3.1.1.2.cmml" xref="S2.SS2.p8.2.m2.3.3.1.1.1"><csymbol cd="latexml" id="S2.SS2.p8.2.m2.3.3.1.1.2.1.cmml" xref="S2.SS2.p8.2.m2.3.3.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS2.p8.2.m2.3.3.1.1.1.1.3.cmml" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p8.2.m2.3.3.1.1.1.1.3a.cmml" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.cmml" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1"><eq id="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.1"></eq><apply id="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.2.1">conditional</csymbol><ci id="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.2.2">𝑅</ci><ci id="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.2.3">𝑋</ci></apply><ci id="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.1.1.3">𝑥</ci></apply><apply id="S2.SS2.p8.2.m2.3.3.1.1.1.1.2.2.cmml" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.2.2"><eq id="S2.SS2.p8.2.m2.3.3.1.1.1.1.2.2.1.cmml" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.2.2.1"></eq><ci id="S2.SS2.p8.2.m2.3.3.1.1.1.1.2.2.2.cmml" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.2.2.2">𝐴</ci><ci id="S2.SS2.p8.2.m2.3.3.1.1.1.1.2.2.3.cmml" xref="S2.SS2.p8.2.m2.3.3.1.1.1.1.2.2.3">𝑎</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p8.2.m2.3c">\widehat{r}(a,x)\approx\mathbb{E}[R|X=x;A=a]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p8.2.m2.3d">over^ start_ARG italic_r end_ARG ( italic_a , italic_x ) ≈ blackboard_E [ italic_R | italic_X = italic_x ; italic_A = italic_a ]</annotation></semantics></math>.
Including it as an additive control variate in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2.E12" title="In 2.2. Off-policy estimation for general bandits ‣ 2. Background and Related Work ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">12</span></a> gives rise to the doubly robust (DR) estimator, deriving its name from its unbiasedness if <em class="ltx_emph ltx_font_italic" id="S2.SS2.p8.4.2">either</em> the logging propensities <math alttext="\pi_{0}" class="ltx_Math" display="inline" id="S2.SS2.p8.3.m3.1"><semantics id="S2.SS2.p8.3.m3.1a"><msub id="S2.SS2.p8.3.m3.1.1" xref="S2.SS2.p8.3.m3.1.1.cmml"><mi id="S2.SS2.p8.3.m3.1.1.2" xref="S2.SS2.p8.3.m3.1.1.2.cmml">π</mi><mn id="S2.SS2.p8.3.m3.1.1.3" xref="S2.SS2.p8.3.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p8.3.m3.1b"><apply id="S2.SS2.p8.3.m3.1.1.cmml" xref="S2.SS2.p8.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p8.3.m3.1.1.1.cmml" xref="S2.SS2.p8.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p8.3.m3.1.1.2.cmml" xref="S2.SS2.p8.3.m3.1.1.2">𝜋</ci><cn id="S2.SS2.p8.3.m3.1.1.3.cmml" type="integer" xref="S2.SS2.p8.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p8.3.m3.1c">\pi_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p8.3.m3.1d">italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> or the reward model <math alttext="\widehat{r}" class="ltx_Math" display="inline" id="S2.SS2.p8.4.m4.1"><semantics id="S2.SS2.p8.4.m4.1a"><mover accent="true" id="S2.SS2.p8.4.m4.1.1" xref="S2.SS2.p8.4.m4.1.1.cmml"><mi id="S2.SS2.p8.4.m4.1.1.2" xref="S2.SS2.p8.4.m4.1.1.2.cmml">r</mi><mo id="S2.SS2.p8.4.m4.1.1.1" xref="S2.SS2.p8.4.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS2.p8.4.m4.1b"><apply id="S2.SS2.p8.4.m4.1.1.cmml" xref="S2.SS2.p8.4.m4.1.1"><ci id="S2.SS2.p8.4.m4.1.1.1.cmml" xref="S2.SS2.p8.4.m4.1.1.1">^</ci><ci id="S2.SS2.p8.4.m4.1.1.2.cmml" xref="S2.SS2.p8.4.m4.1.1.2">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p8.4.m4.1c">\widehat{r}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p8.4.m4.1d">over^ start_ARG italic_r end_ARG</annotation></semantics></math> is unbiased <cite class="ltx_cite ltx_citemacro_citep">(Dudík et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib14" title="">2014</a>)</cite>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Ax1.EGx5">
<tbody id="S2.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(20)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\widehat{V}_{\rm DR}(\pi,\mathcal{D})=" class="ltx_Math" display="inline" id="S2.E20.m2.2"><semantics id="S2.E20.m2.2a"><mrow id="S2.E20.m2.2.3" xref="S2.E20.m2.2.3.cmml"><mrow id="S2.E20.m2.2.3.2" xref="S2.E20.m2.2.3.2.cmml"><msub id="S2.E20.m2.2.3.2.2" xref="S2.E20.m2.2.3.2.2.cmml"><mover accent="true" id="S2.E20.m2.2.3.2.2.2" xref="S2.E20.m2.2.3.2.2.2.cmml"><mi id="S2.E20.m2.2.3.2.2.2.2" xref="S2.E20.m2.2.3.2.2.2.2.cmml">V</mi><mo id="S2.E20.m2.2.3.2.2.2.1" xref="S2.E20.m2.2.3.2.2.2.1.cmml">^</mo></mover><mi id="S2.E20.m2.2.3.2.2.3" xref="S2.E20.m2.2.3.2.2.3.cmml">DR</mi></msub><mo id="S2.E20.m2.2.3.2.1" xref="S2.E20.m2.2.3.2.1.cmml">⁢</mo><mrow id="S2.E20.m2.2.3.2.3.2" xref="S2.E20.m2.2.3.2.3.1.cmml"><mo id="S2.E20.m2.2.3.2.3.2.1" stretchy="false" xref="S2.E20.m2.2.3.2.3.1.cmml">(</mo><mi id="S2.E20.m2.1.1" xref="S2.E20.m2.1.1.cmml">π</mi><mo id="S2.E20.m2.2.3.2.3.2.2" xref="S2.E20.m2.2.3.2.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.E20.m2.2.2" xref="S2.E20.m2.2.2.cmml">𝒟</mi><mo id="S2.E20.m2.2.3.2.3.2.3" stretchy="false" xref="S2.E20.m2.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E20.m2.2.3.1" xref="S2.E20.m2.2.3.1.cmml">=</mo><mi id="S2.E20.m2.2.3.3" xref="S2.E20.m2.2.3.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S2.E20.m2.2b"><apply id="S2.E20.m2.2.3.cmml" xref="S2.E20.m2.2.3"><eq id="S2.E20.m2.2.3.1.cmml" xref="S2.E20.m2.2.3.1"></eq><apply id="S2.E20.m2.2.3.2.cmml" xref="S2.E20.m2.2.3.2"><times id="S2.E20.m2.2.3.2.1.cmml" xref="S2.E20.m2.2.3.2.1"></times><apply id="S2.E20.m2.2.3.2.2.cmml" xref="S2.E20.m2.2.3.2.2"><csymbol cd="ambiguous" id="S2.E20.m2.2.3.2.2.1.cmml" xref="S2.E20.m2.2.3.2.2">subscript</csymbol><apply id="S2.E20.m2.2.3.2.2.2.cmml" xref="S2.E20.m2.2.3.2.2.2"><ci id="S2.E20.m2.2.3.2.2.2.1.cmml" xref="S2.E20.m2.2.3.2.2.2.1">^</ci><ci id="S2.E20.m2.2.3.2.2.2.2.cmml" xref="S2.E20.m2.2.3.2.2.2.2">𝑉</ci></apply><ci id="S2.E20.m2.2.3.2.2.3.cmml" xref="S2.E20.m2.2.3.2.2.3">DR</ci></apply><interval closure="open" id="S2.E20.m2.2.3.2.3.1.cmml" xref="S2.E20.m2.2.3.2.3.2"><ci id="S2.E20.m2.1.1.cmml" xref="S2.E20.m2.1.1">𝜋</ci><ci id="S2.E20.m2.2.2.cmml" xref="S2.E20.m2.2.2">𝒟</ci></interval></apply><csymbol cd="latexml" id="S2.E20.m2.2.3.3.cmml" xref="S2.E20.m2.2.3.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E20.m2.2c">\displaystyle\widehat{V}_{\rm DR}(\pi,\mathcal{D})=</annotation><annotation encoding="application/x-llamapun" id="S2.E20.m2.2d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_DR end_POSTSUBSCRIPT ( italic_π , caligraphic_D ) =</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\;\;\;\frac{1}{\left|\mathcal{D}\right|}\sum_{(x,a,r)\in\mathcal{%
D}}\left(\frac{\pi(a\mid x)}{\pi_{0}(a\mid x)}(r-\widehat{r}(a,x))+\sum_{a^{%
\prime}\in\mathcal{A}}\pi(a^{\prime}\mid x)\widehat{r}(a^{\prime},x)\right)." class="ltx_Math" display="inline" id="S2.Ex11.m1.10"><semantics id="S2.Ex11.m1.10a"><mrow id="S2.Ex11.m1.10.10.1" xref="S2.Ex11.m1.10.10.1.1.cmml"><mrow id="S2.Ex11.m1.10.10.1.1" xref="S2.Ex11.m1.10.10.1.1.cmml"><mstyle displaystyle="true" id="S2.Ex11.m1.1.1" xref="S2.Ex11.m1.1.1.cmml"><mfrac id="S2.Ex11.m1.1.1a" xref="S2.Ex11.m1.1.1.cmml"><mn id="S2.Ex11.m1.1.1.3" xref="S2.Ex11.m1.1.1.3.cmml">1</mn><mrow id="S2.Ex11.m1.1.1.1.3" xref="S2.Ex11.m1.1.1.1.2.cmml"><mo id="S2.Ex11.m1.1.1.1.3.1" xref="S2.Ex11.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.Ex11.m1.1.1.1.1" xref="S2.Ex11.m1.1.1.1.1.cmml">𝒟</mi><mo id="S2.Ex11.m1.1.1.1.3.2" xref="S2.Ex11.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo id="S2.Ex11.m1.10.10.1.1.2" xref="S2.Ex11.m1.10.10.1.1.2.cmml">⁢</mo><mrow id="S2.Ex11.m1.10.10.1.1.1" xref="S2.Ex11.m1.10.10.1.1.1.cmml"><mstyle displaystyle="true" id="S2.Ex11.m1.10.10.1.1.1.2" xref="S2.Ex11.m1.10.10.1.1.1.2.cmml"><munder id="S2.Ex11.m1.10.10.1.1.1.2a" xref="S2.Ex11.m1.10.10.1.1.1.2.cmml"><mo id="S2.Ex11.m1.10.10.1.1.1.2.2" movablelimits="false" xref="S2.Ex11.m1.10.10.1.1.1.2.2.cmml">∑</mo><mrow id="S2.Ex11.m1.4.4.3" xref="S2.Ex11.m1.4.4.3.cmml"><mrow id="S2.Ex11.m1.4.4.3.5.2" xref="S2.Ex11.m1.4.4.3.5.1.cmml"><mo id="S2.Ex11.m1.4.4.3.5.2.1" stretchy="false" xref="S2.Ex11.m1.4.4.3.5.1.cmml">(</mo><mi id="S2.Ex11.m1.2.2.1.1" xref="S2.Ex11.m1.2.2.1.1.cmml">x</mi><mo id="S2.Ex11.m1.4.4.3.5.2.2" xref="S2.Ex11.m1.4.4.3.5.1.cmml">,</mo><mi id="S2.Ex11.m1.3.3.2.2" xref="S2.Ex11.m1.3.3.2.2.cmml">a</mi><mo id="S2.Ex11.m1.4.4.3.5.2.3" xref="S2.Ex11.m1.4.4.3.5.1.cmml">,</mo><mi id="S2.Ex11.m1.4.4.3.3" xref="S2.Ex11.m1.4.4.3.3.cmml">r</mi><mo id="S2.Ex11.m1.4.4.3.5.2.4" stretchy="false" xref="S2.Ex11.m1.4.4.3.5.1.cmml">)</mo></mrow><mo id="S2.Ex11.m1.4.4.3.4" xref="S2.Ex11.m1.4.4.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.Ex11.m1.4.4.3.6" xref="S2.Ex11.m1.4.4.3.6.cmml">𝒟</mi></mrow></munder></mstyle><mrow id="S2.Ex11.m1.10.10.1.1.1.1.1" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.cmml"><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.2" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex11.m1.10.10.1.1.1.1.1.1" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.cmml"><mrow id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.Ex11.m1.6.6" xref="S2.Ex11.m1.6.6.cmml"><mfrac id="S2.Ex11.m1.6.6a" xref="S2.Ex11.m1.6.6.cmml"><mrow id="S2.Ex11.m1.5.5.1" xref="S2.Ex11.m1.5.5.1.cmml"><mi id="S2.Ex11.m1.5.5.1.3" xref="S2.Ex11.m1.5.5.1.3.cmml">π</mi><mo id="S2.Ex11.m1.5.5.1.2" xref="S2.Ex11.m1.5.5.1.2.cmml">⁢</mo><mrow id="S2.Ex11.m1.5.5.1.1.1" xref="S2.Ex11.m1.5.5.1.1.1.1.cmml"><mo id="S2.Ex11.m1.5.5.1.1.1.2" stretchy="false" xref="S2.Ex11.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S2.Ex11.m1.5.5.1.1.1.1" xref="S2.Ex11.m1.5.5.1.1.1.1.cmml"><mi id="S2.Ex11.m1.5.5.1.1.1.1.2" xref="S2.Ex11.m1.5.5.1.1.1.1.2.cmml">a</mi><mo id="S2.Ex11.m1.5.5.1.1.1.1.1" xref="S2.Ex11.m1.5.5.1.1.1.1.1.cmml">∣</mo><mi id="S2.Ex11.m1.5.5.1.1.1.1.3" xref="S2.Ex11.m1.5.5.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex11.m1.5.5.1.1.1.3" stretchy="false" xref="S2.Ex11.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.Ex11.m1.6.6.2" xref="S2.Ex11.m1.6.6.2.cmml"><msub id="S2.Ex11.m1.6.6.2.3" xref="S2.Ex11.m1.6.6.2.3.cmml"><mi id="S2.Ex11.m1.6.6.2.3.2" xref="S2.Ex11.m1.6.6.2.3.2.cmml">π</mi><mn id="S2.Ex11.m1.6.6.2.3.3" xref="S2.Ex11.m1.6.6.2.3.3.cmml">0</mn></msub><mo id="S2.Ex11.m1.6.6.2.2" xref="S2.Ex11.m1.6.6.2.2.cmml">⁢</mo><mrow id="S2.Ex11.m1.6.6.2.1.1" xref="S2.Ex11.m1.6.6.2.1.1.1.cmml"><mo id="S2.Ex11.m1.6.6.2.1.1.2" stretchy="false" xref="S2.Ex11.m1.6.6.2.1.1.1.cmml">(</mo><mrow id="S2.Ex11.m1.6.6.2.1.1.1" xref="S2.Ex11.m1.6.6.2.1.1.1.cmml"><mi id="S2.Ex11.m1.6.6.2.1.1.1.2" xref="S2.Ex11.m1.6.6.2.1.1.1.2.cmml">a</mi><mo id="S2.Ex11.m1.6.6.2.1.1.1.1" xref="S2.Ex11.m1.6.6.2.1.1.1.1.cmml">∣</mo><mi id="S2.Ex11.m1.6.6.2.1.1.1.3" xref="S2.Ex11.m1.6.6.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex11.m1.6.6.2.1.1.3" stretchy="false" xref="S2.Ex11.m1.6.6.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.2" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">r</mi><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.1" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml"><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">(</mo><mi id="S2.Ex11.m1.7.7" xref="S2.Ex11.m1.7.7.cmml">a</mi><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S2.Ex11.m1.8.8" xref="S2.Ex11.m1.8.8.cmml">x</mi><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.2.3" stretchy="false" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.4" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.4.cmml">+</mo><mrow id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.cmml"><munder id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3a" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.cmml"><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.2" movablelimits="false" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.2.cmml">∑</mo><mrow id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.cmml"><msup id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.2" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.2.cmml"><mi id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.2.2" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.2.2.cmml">a</mi><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.2.3" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.2.3.cmml">′</mo></msup><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.1" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.3" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.3.cmml">𝒜</mi></mrow></munder></mstyle><mrow id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.cmml"><mi id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.4" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.4.cmml">π</mi><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.3" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.3.cmml">⁢</mo><mrow id="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.cmml"><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.2" stretchy="false" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.cmml"><msup id="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.2" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.2.cmml"><mi id="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.2.2" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.2.2.cmml">a</mi><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.2.3" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.2.3.cmml">′</mo></msup><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.1" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.1.cmml">∣</mo><mi id="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.3" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.3" stretchy="false" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.3a" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.3.cmml">⁢</mo><mover accent="true" id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.5" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.5.cmml"><mi id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.5.2" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.5.2.cmml">r</mi><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.5.1" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.5.1.cmml">^</mo></mover><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.3b" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.3.cmml">⁢</mo><mrow id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.1" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.2.cmml"><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.1.2" stretchy="false" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.2.cmml">(</mo><msup id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.1.1" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.1.1.cmml"><mi id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.1.1.2" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.1.1.2.cmml">a</mi><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.1.1.3" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.1.1.3.cmml">′</mo></msup><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.1.3" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.2.cmml">,</mo><mi id="S2.Ex11.m1.9.9" xref="S2.Ex11.m1.9.9.cmml">x</mi><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.1.4" stretchy="false" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.Ex11.m1.10.10.1.1.1.1.1.3" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.Ex11.m1.10.10.1.2" lspace="0em" xref="S2.Ex11.m1.10.10.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex11.m1.10b"><apply id="S2.Ex11.m1.10.10.1.1.cmml" xref="S2.Ex11.m1.10.10.1"><times id="S2.Ex11.m1.10.10.1.1.2.cmml" xref="S2.Ex11.m1.10.10.1.1.2"></times><apply id="S2.Ex11.m1.1.1.cmml" xref="S2.Ex11.m1.1.1"><divide id="S2.Ex11.m1.1.1.2.cmml" xref="S2.Ex11.m1.1.1"></divide><cn id="S2.Ex11.m1.1.1.3.cmml" type="integer" xref="S2.Ex11.m1.1.1.3">1</cn><apply id="S2.Ex11.m1.1.1.1.2.cmml" xref="S2.Ex11.m1.1.1.1.3"><abs id="S2.Ex11.m1.1.1.1.2.1.cmml" xref="S2.Ex11.m1.1.1.1.3.1"></abs><ci id="S2.Ex11.m1.1.1.1.1.cmml" xref="S2.Ex11.m1.1.1.1.1">𝒟</ci></apply></apply><apply id="S2.Ex11.m1.10.10.1.1.1.cmml" xref="S2.Ex11.m1.10.10.1.1.1"><apply id="S2.Ex11.m1.10.10.1.1.1.2.cmml" xref="S2.Ex11.m1.10.10.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex11.m1.10.10.1.1.1.2.1.cmml" xref="S2.Ex11.m1.10.10.1.1.1.2">subscript</csymbol><sum id="S2.Ex11.m1.10.10.1.1.1.2.2.cmml" xref="S2.Ex11.m1.10.10.1.1.1.2.2"></sum><apply id="S2.Ex11.m1.4.4.3.cmml" xref="S2.Ex11.m1.4.4.3"><in id="S2.Ex11.m1.4.4.3.4.cmml" xref="S2.Ex11.m1.4.4.3.4"></in><vector id="S2.Ex11.m1.4.4.3.5.1.cmml" xref="S2.Ex11.m1.4.4.3.5.2"><ci id="S2.Ex11.m1.2.2.1.1.cmml" xref="S2.Ex11.m1.2.2.1.1">𝑥</ci><ci id="S2.Ex11.m1.3.3.2.2.cmml" xref="S2.Ex11.m1.3.3.2.2">𝑎</ci><ci id="S2.Ex11.m1.4.4.3.3.cmml" xref="S2.Ex11.m1.4.4.3.3">𝑟</ci></vector><ci id="S2.Ex11.m1.4.4.3.6.cmml" xref="S2.Ex11.m1.4.4.3.6">𝒟</ci></apply></apply><apply id="S2.Ex11.m1.10.10.1.1.1.1.1.1.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1"><plus id="S2.Ex11.m1.10.10.1.1.1.1.1.1.4.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.4"></plus><apply id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1"><times id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.2"></times><apply id="S2.Ex11.m1.6.6.cmml" xref="S2.Ex11.m1.6.6"><divide id="S2.Ex11.m1.6.6.3.cmml" xref="S2.Ex11.m1.6.6"></divide><apply id="S2.Ex11.m1.5.5.1.cmml" xref="S2.Ex11.m1.5.5.1"><times id="S2.Ex11.m1.5.5.1.2.cmml" xref="S2.Ex11.m1.5.5.1.2"></times><ci id="S2.Ex11.m1.5.5.1.3.cmml" xref="S2.Ex11.m1.5.5.1.3">𝜋</ci><apply id="S2.Ex11.m1.5.5.1.1.1.1.cmml" xref="S2.Ex11.m1.5.5.1.1.1"><csymbol cd="latexml" id="S2.Ex11.m1.5.5.1.1.1.1.1.cmml" xref="S2.Ex11.m1.5.5.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex11.m1.5.5.1.1.1.1.2.cmml" xref="S2.Ex11.m1.5.5.1.1.1.1.2">𝑎</ci><ci id="S2.Ex11.m1.5.5.1.1.1.1.3.cmml" xref="S2.Ex11.m1.5.5.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.Ex11.m1.6.6.2.cmml" xref="S2.Ex11.m1.6.6.2"><times id="S2.Ex11.m1.6.6.2.2.cmml" xref="S2.Ex11.m1.6.6.2.2"></times><apply id="S2.Ex11.m1.6.6.2.3.cmml" xref="S2.Ex11.m1.6.6.2.3"><csymbol cd="ambiguous" id="S2.Ex11.m1.6.6.2.3.1.cmml" xref="S2.Ex11.m1.6.6.2.3">subscript</csymbol><ci id="S2.Ex11.m1.6.6.2.3.2.cmml" xref="S2.Ex11.m1.6.6.2.3.2">𝜋</ci><cn id="S2.Ex11.m1.6.6.2.3.3.cmml" type="integer" xref="S2.Ex11.m1.6.6.2.3.3">0</cn></apply><apply id="S2.Ex11.m1.6.6.2.1.1.1.cmml" xref="S2.Ex11.m1.6.6.2.1.1"><csymbol cd="latexml" id="S2.Ex11.m1.6.6.2.1.1.1.1.cmml" xref="S2.Ex11.m1.6.6.2.1.1.1.1">conditional</csymbol><ci id="S2.Ex11.m1.6.6.2.1.1.1.2.cmml" xref="S2.Ex11.m1.6.6.2.1.1.1.2">𝑎</ci><ci id="S2.Ex11.m1.6.6.2.1.1.1.3.cmml" xref="S2.Ex11.m1.6.6.2.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1"><minus id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.2">𝑟</ci><apply id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3"><times id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑟</ci></apply><interval closure="open" id="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.2"><ci id="S2.Ex11.m1.7.7.cmml" xref="S2.Ex11.m1.7.7">𝑎</ci><ci id="S2.Ex11.m1.8.8.cmml" xref="S2.Ex11.m1.8.8">𝑥</ci></interval></apply></apply></apply><apply id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3"><apply id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.1.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3">subscript</csymbol><sum id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.2.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.2"></sum><apply id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3"><in id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.1.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.1"></in><apply id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.2.1.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.2">superscript</csymbol><ci id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.2.2.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.2.2">𝑎</ci><ci id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.2.3.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.2.3">′</ci></apply><ci id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.3.3.3">𝒜</ci></apply></apply><apply id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2"><times id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.3.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.3"></times><ci id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.4.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.4">𝜋</ci><apply id="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1"><csymbol cd="latexml" id="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.1">conditional</csymbol><apply id="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.2">superscript</csymbol><ci id="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.2.2.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.2.2">𝑎</ci><ci id="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.2.3.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.2.3">′</ci></apply><ci id="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.2.1.1.1.1.3">𝑥</ci></apply><apply id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.5.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.5"><ci id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.5.1.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.5.1">^</ci><ci id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.5.2.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.5.2">𝑟</ci></apply><interval closure="open" id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.2.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.1"><apply id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.1.1.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.1.1"><csymbol cd="ambiguous" id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.1.1.1.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.1.1">superscript</csymbol><ci id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.1.1.2.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.1.1.2">𝑎</ci><ci id="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.1.1.3.cmml" xref="S2.Ex11.m1.10.10.1.1.1.1.1.1.3.2.2.1.1.3">′</ci></apply><ci id="S2.Ex11.m1.9.9.cmml" xref="S2.Ex11.m1.9.9">𝑥</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex11.m1.10c">\displaystyle\;\;\;\frac{1}{\left|\mathcal{D}\right|}\sum_{(x,a,r)\in\mathcal{%
D}}\left(\frac{\pi(a\mid x)}{\pi_{0}(a\mid x)}(r-\widehat{r}(a,x))+\sum_{a^{%
\prime}\in\mathcal{A}}\pi(a^{\prime}\mid x)\widehat{r}(a^{\prime},x)\right).</annotation><annotation encoding="application/x-llamapun" id="S2.Ex11.m1.10d">divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) ∈ caligraphic_D end_POSTSUBSCRIPT ( divide start_ARG italic_π ( italic_a ∣ italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ∣ italic_x ) end_ARG ( italic_r - over^ start_ARG italic_r end_ARG ( italic_a , italic_x ) ) + ∑ start_POSTSUBSCRIPT italic_a start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ caligraphic_A end_POSTSUBSCRIPT italic_π ( italic_a start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∣ italic_x ) over^ start_ARG italic_r end_ARG ( italic_a start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_x ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p8.10">Several further extensions have been proposed in the literature: one can optimize the reward model <math alttext="\widehat{r}(a,x)" class="ltx_Math" display="inline" id="S2.SS2.p8.5.m1.2"><semantics id="S2.SS2.p8.5.m1.2a"><mrow id="S2.SS2.p8.5.m1.2.3" xref="S2.SS2.p8.5.m1.2.3.cmml"><mover accent="true" id="S2.SS2.p8.5.m1.2.3.2" xref="S2.SS2.p8.5.m1.2.3.2.cmml"><mi id="S2.SS2.p8.5.m1.2.3.2.2" xref="S2.SS2.p8.5.m1.2.3.2.2.cmml">r</mi><mo id="S2.SS2.p8.5.m1.2.3.2.1" xref="S2.SS2.p8.5.m1.2.3.2.1.cmml">^</mo></mover><mo id="S2.SS2.p8.5.m1.2.3.1" xref="S2.SS2.p8.5.m1.2.3.1.cmml">⁢</mo><mrow id="S2.SS2.p8.5.m1.2.3.3.2" xref="S2.SS2.p8.5.m1.2.3.3.1.cmml"><mo id="S2.SS2.p8.5.m1.2.3.3.2.1" stretchy="false" xref="S2.SS2.p8.5.m1.2.3.3.1.cmml">(</mo><mi id="S2.SS2.p8.5.m1.1.1" xref="S2.SS2.p8.5.m1.1.1.cmml">a</mi><mo id="S2.SS2.p8.5.m1.2.3.3.2.2" xref="S2.SS2.p8.5.m1.2.3.3.1.cmml">,</mo><mi id="S2.SS2.p8.5.m1.2.2" xref="S2.SS2.p8.5.m1.2.2.cmml">x</mi><mo id="S2.SS2.p8.5.m1.2.3.3.2.3" stretchy="false" xref="S2.SS2.p8.5.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p8.5.m1.2b"><apply id="S2.SS2.p8.5.m1.2.3.cmml" xref="S2.SS2.p8.5.m1.2.3"><times id="S2.SS2.p8.5.m1.2.3.1.cmml" xref="S2.SS2.p8.5.m1.2.3.1"></times><apply id="S2.SS2.p8.5.m1.2.3.2.cmml" xref="S2.SS2.p8.5.m1.2.3.2"><ci id="S2.SS2.p8.5.m1.2.3.2.1.cmml" xref="S2.SS2.p8.5.m1.2.3.2.1">^</ci><ci id="S2.SS2.p8.5.m1.2.3.2.2.cmml" xref="S2.SS2.p8.5.m1.2.3.2.2">𝑟</ci></apply><interval closure="open" id="S2.SS2.p8.5.m1.2.3.3.1.cmml" xref="S2.SS2.p8.5.m1.2.3.3.2"><ci id="S2.SS2.p8.5.m1.1.1.cmml" xref="S2.SS2.p8.5.m1.1.1">𝑎</ci><ci id="S2.SS2.p8.5.m1.2.2.cmml" xref="S2.SS2.p8.5.m1.2.2">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p8.5.m1.2c">\widehat{r}(a,x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p8.5.m1.2d">over^ start_ARG italic_r end_ARG ( italic_a , italic_x )</annotation></semantics></math> to minimize the resulting variance of <math alttext="\widehat{V}_{\rm DR}" class="ltx_Math" display="inline" id="S2.SS2.p8.6.m2.1"><semantics id="S2.SS2.p8.6.m2.1a"><msub id="S2.SS2.p8.6.m2.1.1" xref="S2.SS2.p8.6.m2.1.1.cmml"><mover accent="true" id="S2.SS2.p8.6.m2.1.1.2" xref="S2.SS2.p8.6.m2.1.1.2.cmml"><mi id="S2.SS2.p8.6.m2.1.1.2.2" xref="S2.SS2.p8.6.m2.1.1.2.2.cmml">V</mi><mo id="S2.SS2.p8.6.m2.1.1.2.1" xref="S2.SS2.p8.6.m2.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.p8.6.m2.1.1.3" xref="S2.SS2.p8.6.m2.1.1.3.cmml">DR</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p8.6.m2.1b"><apply id="S2.SS2.p8.6.m2.1.1.cmml" xref="S2.SS2.p8.6.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p8.6.m2.1.1.1.cmml" xref="S2.SS2.p8.6.m2.1.1">subscript</csymbol><apply id="S2.SS2.p8.6.m2.1.1.2.cmml" xref="S2.SS2.p8.6.m2.1.1.2"><ci id="S2.SS2.p8.6.m2.1.1.2.1.cmml" xref="S2.SS2.p8.6.m2.1.1.2.1">^</ci><ci id="S2.SS2.p8.6.m2.1.1.2.2.cmml" xref="S2.SS2.p8.6.m2.1.1.2.2">𝑉</ci></apply><ci id="S2.SS2.p8.6.m2.1.1.3.cmml" xref="S2.SS2.p8.6.m2.1.1.3">DR</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p8.6.m2.1c">\widehat{V}_{\rm DR}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p8.6.m2.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_DR end_POSTSUBSCRIPT</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Farajtabar et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib15" title="">2018</a>)</cite>, further parameterise the trade-off relying on <math alttext="\widehat{V}_{\rm IPS}" class="ltx_Math" display="inline" id="S2.SS2.p8.7.m3.1"><semantics id="S2.SS2.p8.7.m3.1a"><msub id="S2.SS2.p8.7.m3.1.1" xref="S2.SS2.p8.7.m3.1.1.cmml"><mover accent="true" id="S2.SS2.p8.7.m3.1.1.2" xref="S2.SS2.p8.7.m3.1.1.2.cmml"><mi id="S2.SS2.p8.7.m3.1.1.2.2" xref="S2.SS2.p8.7.m3.1.1.2.2.cmml">V</mi><mo id="S2.SS2.p8.7.m3.1.1.2.1" xref="S2.SS2.p8.7.m3.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.p8.7.m3.1.1.3" xref="S2.SS2.p8.7.m3.1.1.3.cmml">IPS</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p8.7.m3.1b"><apply id="S2.SS2.p8.7.m3.1.1.cmml" xref="S2.SS2.p8.7.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p8.7.m3.1.1.1.cmml" xref="S2.SS2.p8.7.m3.1.1">subscript</csymbol><apply id="S2.SS2.p8.7.m3.1.1.2.cmml" xref="S2.SS2.p8.7.m3.1.1.2"><ci id="S2.SS2.p8.7.m3.1.1.2.1.cmml" xref="S2.SS2.p8.7.m3.1.1.2.1">^</ci><ci id="S2.SS2.p8.7.m3.1.1.2.2.cmml" xref="S2.SS2.p8.7.m3.1.1.2.2">𝑉</ci></apply><ci id="S2.SS2.p8.7.m3.1.1.3.cmml" xref="S2.SS2.p8.7.m3.1.1.3">IPS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p8.7.m3.1c">\widehat{V}_{\rm IPS}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p8.7.m3.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_IPS end_POSTSUBSCRIPT</annotation></semantics></math> or <math alttext="\widehat{r}(a,x)" class="ltx_Math" display="inline" id="S2.SS2.p8.8.m4.2"><semantics id="S2.SS2.p8.8.m4.2a"><mrow id="S2.SS2.p8.8.m4.2.3" xref="S2.SS2.p8.8.m4.2.3.cmml"><mover accent="true" id="S2.SS2.p8.8.m4.2.3.2" xref="S2.SS2.p8.8.m4.2.3.2.cmml"><mi id="S2.SS2.p8.8.m4.2.3.2.2" xref="S2.SS2.p8.8.m4.2.3.2.2.cmml">r</mi><mo id="S2.SS2.p8.8.m4.2.3.2.1" xref="S2.SS2.p8.8.m4.2.3.2.1.cmml">^</mo></mover><mo id="S2.SS2.p8.8.m4.2.3.1" xref="S2.SS2.p8.8.m4.2.3.1.cmml">⁢</mo><mrow id="S2.SS2.p8.8.m4.2.3.3.2" xref="S2.SS2.p8.8.m4.2.3.3.1.cmml"><mo id="S2.SS2.p8.8.m4.2.3.3.2.1" stretchy="false" xref="S2.SS2.p8.8.m4.2.3.3.1.cmml">(</mo><mi id="S2.SS2.p8.8.m4.1.1" xref="S2.SS2.p8.8.m4.1.1.cmml">a</mi><mo id="S2.SS2.p8.8.m4.2.3.3.2.2" xref="S2.SS2.p8.8.m4.2.3.3.1.cmml">,</mo><mi id="S2.SS2.p8.8.m4.2.2" xref="S2.SS2.p8.8.m4.2.2.cmml">x</mi><mo id="S2.SS2.p8.8.m4.2.3.3.2.3" stretchy="false" xref="S2.SS2.p8.8.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p8.8.m4.2b"><apply id="S2.SS2.p8.8.m4.2.3.cmml" xref="S2.SS2.p8.8.m4.2.3"><times id="S2.SS2.p8.8.m4.2.3.1.cmml" xref="S2.SS2.p8.8.m4.2.3.1"></times><apply id="S2.SS2.p8.8.m4.2.3.2.cmml" xref="S2.SS2.p8.8.m4.2.3.2"><ci id="S2.SS2.p8.8.m4.2.3.2.1.cmml" xref="S2.SS2.p8.8.m4.2.3.2.1">^</ci><ci id="S2.SS2.p8.8.m4.2.3.2.2.cmml" xref="S2.SS2.p8.8.m4.2.3.2.2">𝑟</ci></apply><interval closure="open" id="S2.SS2.p8.8.m4.2.3.3.1.cmml" xref="S2.SS2.p8.8.m4.2.3.3.2"><ci id="S2.SS2.p8.8.m4.1.1.cmml" xref="S2.SS2.p8.8.m4.1.1">𝑎</ci><ci id="S2.SS2.p8.8.m4.2.2.cmml" xref="S2.SS2.p8.8.m4.2.2">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p8.8.m4.2c">\widehat{r}(a,x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p8.8.m4.2d">over^ start_ARG italic_r end_ARG ( italic_a , italic_x )</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Su et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib59" title="">2019</a>)</cite>, or shrink the IPS weights to minimize a bound on the MSE of the resulting estimator <cite class="ltx_cite ltx_citemacro_citep">(Su et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib58" title="">2020</a>)</cite>.
One disadvantage of this method, is that practitioners are required to fit the secondary reward model <math alttext="\widehat{r}(a,x)" class="ltx_Math" display="inline" id="S2.SS2.p8.9.m5.2"><semantics id="S2.SS2.p8.9.m5.2a"><mrow id="S2.SS2.p8.9.m5.2.3" xref="S2.SS2.p8.9.m5.2.3.cmml"><mover accent="true" id="S2.SS2.p8.9.m5.2.3.2" xref="S2.SS2.p8.9.m5.2.3.2.cmml"><mi id="S2.SS2.p8.9.m5.2.3.2.2" xref="S2.SS2.p8.9.m5.2.3.2.2.cmml">r</mi><mo id="S2.SS2.p8.9.m5.2.3.2.1" xref="S2.SS2.p8.9.m5.2.3.2.1.cmml">^</mo></mover><mo id="S2.SS2.p8.9.m5.2.3.1" xref="S2.SS2.p8.9.m5.2.3.1.cmml">⁢</mo><mrow id="S2.SS2.p8.9.m5.2.3.3.2" xref="S2.SS2.p8.9.m5.2.3.3.1.cmml"><mo id="S2.SS2.p8.9.m5.2.3.3.2.1" stretchy="false" xref="S2.SS2.p8.9.m5.2.3.3.1.cmml">(</mo><mi id="S2.SS2.p8.9.m5.1.1" xref="S2.SS2.p8.9.m5.1.1.cmml">a</mi><mo id="S2.SS2.p8.9.m5.2.3.3.2.2" xref="S2.SS2.p8.9.m5.2.3.3.1.cmml">,</mo><mi id="S2.SS2.p8.9.m5.2.2" xref="S2.SS2.p8.9.m5.2.2.cmml">x</mi><mo id="S2.SS2.p8.9.m5.2.3.3.2.3" stretchy="false" xref="S2.SS2.p8.9.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p8.9.m5.2b"><apply id="S2.SS2.p8.9.m5.2.3.cmml" xref="S2.SS2.p8.9.m5.2.3"><times id="S2.SS2.p8.9.m5.2.3.1.cmml" xref="S2.SS2.p8.9.m5.2.3.1"></times><apply id="S2.SS2.p8.9.m5.2.3.2.cmml" xref="S2.SS2.p8.9.m5.2.3.2"><ci id="S2.SS2.p8.9.m5.2.3.2.1.cmml" xref="S2.SS2.p8.9.m5.2.3.2.1">^</ci><ci id="S2.SS2.p8.9.m5.2.3.2.2.cmml" xref="S2.SS2.p8.9.m5.2.3.2.2">𝑟</ci></apply><interval closure="open" id="S2.SS2.p8.9.m5.2.3.3.1.cmml" xref="S2.SS2.p8.9.m5.2.3.3.2"><ci id="S2.SS2.p8.9.m5.1.1.cmml" xref="S2.SS2.p8.9.m5.1.1">𝑎</ci><ci id="S2.SS2.p8.9.m5.2.2.cmml" xref="S2.SS2.p8.9.m5.2.2">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p8.9.m5.2c">\widehat{r}(a,x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p8.9.m5.2d">over^ start_ARG italic_r end_ARG ( italic_a , italic_x )</annotation></semantics></math>, which might be costly and sample inefficient.
Furthermore, variance reduction is generally not guaranteed, and stand-alone <math alttext="\widehat{V}_{\rm IPS}" class="ltx_Math" display="inline" id="S2.SS2.p8.10.m6.1"><semantics id="S2.SS2.p8.10.m6.1a"><msub id="S2.SS2.p8.10.m6.1.1" xref="S2.SS2.p8.10.m6.1.1.cmml"><mover accent="true" id="S2.SS2.p8.10.m6.1.1.2" xref="S2.SS2.p8.10.m6.1.1.2.cmml"><mi id="S2.SS2.p8.10.m6.1.1.2.2" xref="S2.SS2.p8.10.m6.1.1.2.2.cmml">V</mi><mo id="S2.SS2.p8.10.m6.1.1.2.1" xref="S2.SS2.p8.10.m6.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.p8.10.m6.1.1.3" xref="S2.SS2.p8.10.m6.1.1.3.cmml">IPS</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p8.10.m6.1b"><apply id="S2.SS2.p8.10.m6.1.1.cmml" xref="S2.SS2.p8.10.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p8.10.m6.1.1.1.cmml" xref="S2.SS2.p8.10.m6.1.1">subscript</csymbol><apply id="S2.SS2.p8.10.m6.1.1.2.cmml" xref="S2.SS2.p8.10.m6.1.1.2"><ci id="S2.SS2.p8.10.m6.1.1.2.1.cmml" xref="S2.SS2.p8.10.m6.1.1.2.1">^</ci><ci id="S2.SS2.p8.10.m6.1.1.2.2.cmml" xref="S2.SS2.p8.10.m6.1.1.2.2">𝑉</ci></apply><ci id="S2.SS2.p8.10.m6.1.1.3.cmml" xref="S2.SS2.p8.10.m6.1.1.3">IPS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p8.10.m6.1c">\widehat{V}_{\rm IPS}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p8.10.m6.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_IPS end_POSTSUBSCRIPT</annotation></semantics></math> can be empirically superior in some scenarios <cite class="ltx_cite ltx_citemacro_citep">(Jeunen and Goethals, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib25" title="">2020</a>)</cite>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Unifying Off-Policy Estimators</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">Section <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2" title="2. Background and Related Work ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">2</span></a> provides an overview of (asymptotically) unbiased estimators for the value of a policy.
We have introduced the contextual bandit setting, detailing often used variance reduction techniques for both on-policy (i.e., regression adjustments and baseline corrections) and off-policy estimation (i.e., self-normalisation and doubly robust estimation).
In this section, we demonstrate that they perform equivalent optimization as baseline-corrected estimation.
Subsequently, we characterize the baseline corrections that either minimize the variance of the estimator, or that of its gradient.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>A unified off-policy estimator</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.2"><span class="ltx_text ltx_font_bold" id="S3.SS1.p1.1.1">Baseline corrections for <math alttext="\nabla\widehat{V}_{{\rm IPS}}(\pi,\mathcal{D})" class="ltx_Math" display="inline" id="S3.SS1.p1.1.1.m1.2"><semantics id="S3.SS1.p1.1.1.m1.2a"><mrow id="S3.SS1.p1.1.1.m1.2.3" xref="S3.SS1.p1.1.1.m1.2.3.cmml"><mrow id="S3.SS1.p1.1.1.m1.2.3.2" xref="S3.SS1.p1.1.1.m1.2.3.2.cmml"><mo id="S3.SS1.p1.1.1.m1.2.3.2.1" rspace="0.167em" xref="S3.SS1.p1.1.1.m1.2.3.2.1.cmml">∇</mo><msub id="S3.SS1.p1.1.1.m1.2.3.2.2" xref="S3.SS1.p1.1.1.m1.2.3.2.2.cmml"><mover accent="true" id="S3.SS1.p1.1.1.m1.2.3.2.2.2" xref="S3.SS1.p1.1.1.m1.2.3.2.2.2.cmml"><mi id="S3.SS1.p1.1.1.m1.2.3.2.2.2.2" xref="S3.SS1.p1.1.1.m1.2.3.2.2.2.2.cmml">V</mi><mo id="S3.SS1.p1.1.1.m1.2.3.2.2.2.1" xref="S3.SS1.p1.1.1.m1.2.3.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS1.p1.1.1.m1.2.3.2.2.3" xref="S3.SS1.p1.1.1.m1.2.3.2.2.3.cmml">IPS</mi></msub></mrow><mo id="S3.SS1.p1.1.1.m1.2.3.1" xref="S3.SS1.p1.1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p1.1.1.m1.2.3.3.2" xref="S3.SS1.p1.1.1.m1.2.3.3.1.cmml"><mo id="S3.SS1.p1.1.1.m1.2.3.3.2.1" stretchy="false" xref="S3.SS1.p1.1.1.m1.2.3.3.1.cmml">(</mo><mi id="S3.SS1.p1.1.1.m1.1.1" xref="S3.SS1.p1.1.1.m1.1.1.cmml">π</mi><mo id="S3.SS1.p1.1.1.m1.2.3.3.2.2" xref="S3.SS1.p1.1.1.m1.2.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.1.m1.2.2" xref="S3.SS1.p1.1.1.m1.2.2.cmml">𝒟</mi><mo id="S3.SS1.p1.1.1.m1.2.3.3.2.3" stretchy="false" xref="S3.SS1.p1.1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.1.m1.2b"><apply id="S3.SS1.p1.1.1.m1.2.3.cmml" xref="S3.SS1.p1.1.1.m1.2.3"><times id="S3.SS1.p1.1.1.m1.2.3.1.cmml" xref="S3.SS1.p1.1.1.m1.2.3.1"></times><apply id="S3.SS1.p1.1.1.m1.2.3.2.cmml" xref="S3.SS1.p1.1.1.m1.2.3.2"><ci id="S3.SS1.p1.1.1.m1.2.3.2.1.cmml" xref="S3.SS1.p1.1.1.m1.2.3.2.1">∇</ci><apply id="S3.SS1.p1.1.1.m1.2.3.2.2.cmml" xref="S3.SS1.p1.1.1.m1.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.1.m1.2.3.2.2.1.cmml" xref="S3.SS1.p1.1.1.m1.2.3.2.2">subscript</csymbol><apply id="S3.SS1.p1.1.1.m1.2.3.2.2.2.cmml" xref="S3.SS1.p1.1.1.m1.2.3.2.2.2"><ci id="S3.SS1.p1.1.1.m1.2.3.2.2.2.1.cmml" xref="S3.SS1.p1.1.1.m1.2.3.2.2.2.1">^</ci><ci id="S3.SS1.p1.1.1.m1.2.3.2.2.2.2.cmml" xref="S3.SS1.p1.1.1.m1.2.3.2.2.2.2">𝑉</ci></apply><ci id="S3.SS1.p1.1.1.m1.2.3.2.2.3.cmml" xref="S3.SS1.p1.1.1.m1.2.3.2.2.3">IPS</ci></apply></apply><interval closure="open" id="S3.SS1.p1.1.1.m1.2.3.3.1.cmml" xref="S3.SS1.p1.1.1.m1.2.3.3.2"><ci id="S3.SS1.p1.1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.1.m1.1.1">𝜋</ci><ci id="S3.SS1.p1.1.1.m1.2.2.cmml" xref="S3.SS1.p1.1.1.m1.2.2">𝒟</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.1.m1.2c">\nabla\widehat{V}_{{\rm IPS}}(\pi,\mathcal{D})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.1.m1.2d">∇ over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_IPS end_POSTSUBSCRIPT ( italic_π , caligraphic_D )</annotation></semantics></math>.</span>
Baseline corrections are common in on-policy estimation, but occur less often in the off-policy literature.
The estimator is obtained by removing a baseline control variate <math alttext="\beta\in\mathbb{R}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m1.1"><semantics id="S3.SS1.p1.2.m1.1a"><mrow id="S3.SS1.p1.2.m1.1.1" xref="S3.SS1.p1.2.m1.1.1.cmml"><mi id="S3.SS1.p1.2.m1.1.1.2" xref="S3.SS1.p1.2.m1.1.1.2.cmml">β</mi><mo id="S3.SS1.p1.2.m1.1.1.1" xref="S3.SS1.p1.2.m1.1.1.1.cmml">∈</mo><mi id="S3.SS1.p1.2.m1.1.1.3" xref="S3.SS1.p1.2.m1.1.1.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m1.1b"><apply id="S3.SS1.p1.2.m1.1.1.cmml" xref="S3.SS1.p1.2.m1.1.1"><in id="S3.SS1.p1.2.m1.1.1.1.cmml" xref="S3.SS1.p1.2.m1.1.1.1"></in><ci id="S3.SS1.p1.2.m1.1.1.2.cmml" xref="S3.SS1.p1.2.m1.1.1.2">𝛽</ci><ci id="S3.SS1.p1.2.m1.1.1.3.cmml" xref="S3.SS1.p1.2.m1.1.1.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m1.1c">\beta\in\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m1.1d">italic_β ∈ blackboard_R</annotation></semantics></math> from the reward of each action, while also adding it to the estimator:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E21">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(21)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widehat{V}_{\beta\text{-}{\rm IPS}}=\beta+\frac{1}{\left|\mathcal{D}\right|}%
\sum_{(x,a,r)\in\mathcal{D}}\frac{\pi(a|x)}{\pi_{0}(a|x)}(r-\beta)." class="ltx_Math" display="block" id="S3.E21.m1.7"><semantics id="S3.E21.m1.7a"><mrow id="S3.E21.m1.7.7.1" xref="S3.E21.m1.7.7.1.1.cmml"><mrow id="S3.E21.m1.7.7.1.1" xref="S3.E21.m1.7.7.1.1.cmml"><msub id="S3.E21.m1.7.7.1.1.3" xref="S3.E21.m1.7.7.1.1.3.cmml"><mover accent="true" id="S3.E21.m1.7.7.1.1.3.2" xref="S3.E21.m1.7.7.1.1.3.2.cmml"><mi id="S3.E21.m1.7.7.1.1.3.2.2" xref="S3.E21.m1.7.7.1.1.3.2.2.cmml">V</mi><mo id="S3.E21.m1.7.7.1.1.3.2.1" xref="S3.E21.m1.7.7.1.1.3.2.1.cmml">^</mo></mover><mrow id="S3.E21.m1.7.7.1.1.3.3" xref="S3.E21.m1.7.7.1.1.3.3.cmml"><mi id="S3.E21.m1.7.7.1.1.3.3.2" xref="S3.E21.m1.7.7.1.1.3.3.2.cmml">β</mi><mo id="S3.E21.m1.7.7.1.1.3.3.1" xref="S3.E21.m1.7.7.1.1.3.3.1.cmml">⁢</mo><mtext id="S3.E21.m1.7.7.1.1.3.3.3" xref="S3.E21.m1.7.7.1.1.3.3.3a.cmml">-</mtext><mo id="S3.E21.m1.7.7.1.1.3.3.1a" xref="S3.E21.m1.7.7.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E21.m1.7.7.1.1.3.3.4" xref="S3.E21.m1.7.7.1.1.3.3.4.cmml">IPS</mi></mrow></msub><mo id="S3.E21.m1.7.7.1.1.2" xref="S3.E21.m1.7.7.1.1.2.cmml">=</mo><mrow id="S3.E21.m1.7.7.1.1.1" xref="S3.E21.m1.7.7.1.1.1.cmml"><mi id="S3.E21.m1.7.7.1.1.1.3" xref="S3.E21.m1.7.7.1.1.1.3.cmml">β</mi><mo id="S3.E21.m1.7.7.1.1.1.2" xref="S3.E21.m1.7.7.1.1.1.2.cmml">+</mo><mrow id="S3.E21.m1.7.7.1.1.1.1" xref="S3.E21.m1.7.7.1.1.1.1.cmml"><mfrac id="S3.E21.m1.1.1" xref="S3.E21.m1.1.1.cmml"><mn id="S3.E21.m1.1.1.3" xref="S3.E21.m1.1.1.3.cmml">1</mn><mrow id="S3.E21.m1.1.1.1.3" xref="S3.E21.m1.1.1.1.2.cmml"><mo id="S3.E21.m1.1.1.1.3.1" xref="S3.E21.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E21.m1.1.1.1.1" xref="S3.E21.m1.1.1.1.1.cmml">𝒟</mi><mo id="S3.E21.m1.1.1.1.3.2" xref="S3.E21.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.E21.m1.7.7.1.1.1.1.2" xref="S3.E21.m1.7.7.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E21.m1.7.7.1.1.1.1.1" xref="S3.E21.m1.7.7.1.1.1.1.1.cmml"><munder id="S3.E21.m1.7.7.1.1.1.1.1.2" xref="S3.E21.m1.7.7.1.1.1.1.1.2.cmml"><mo id="S3.E21.m1.7.7.1.1.1.1.1.2.2" movablelimits="false" xref="S3.E21.m1.7.7.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E21.m1.4.4.3" xref="S3.E21.m1.4.4.3.cmml"><mrow id="S3.E21.m1.4.4.3.5.2" xref="S3.E21.m1.4.4.3.5.1.cmml"><mo id="S3.E21.m1.4.4.3.5.2.1" stretchy="false" xref="S3.E21.m1.4.4.3.5.1.cmml">(</mo><mi id="S3.E21.m1.2.2.1.1" xref="S3.E21.m1.2.2.1.1.cmml">x</mi><mo id="S3.E21.m1.4.4.3.5.2.2" xref="S3.E21.m1.4.4.3.5.1.cmml">,</mo><mi id="S3.E21.m1.3.3.2.2" xref="S3.E21.m1.3.3.2.2.cmml">a</mi><mo id="S3.E21.m1.4.4.3.5.2.3" xref="S3.E21.m1.4.4.3.5.1.cmml">,</mo><mi id="S3.E21.m1.4.4.3.3" xref="S3.E21.m1.4.4.3.3.cmml">r</mi><mo id="S3.E21.m1.4.4.3.5.2.4" stretchy="false" xref="S3.E21.m1.4.4.3.5.1.cmml">)</mo></mrow><mo id="S3.E21.m1.4.4.3.4" xref="S3.E21.m1.4.4.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E21.m1.4.4.3.6" xref="S3.E21.m1.4.4.3.6.cmml">𝒟</mi></mrow></munder><mrow id="S3.E21.m1.7.7.1.1.1.1.1.1" xref="S3.E21.m1.7.7.1.1.1.1.1.1.cmml"><mfrac id="S3.E21.m1.6.6" xref="S3.E21.m1.6.6.cmml"><mrow id="S3.E21.m1.5.5.1" xref="S3.E21.m1.5.5.1.cmml"><mi id="S3.E21.m1.5.5.1.3" xref="S3.E21.m1.5.5.1.3.cmml">π</mi><mo id="S3.E21.m1.5.5.1.2" xref="S3.E21.m1.5.5.1.2.cmml">⁢</mo><mrow id="S3.E21.m1.5.5.1.1.1" xref="S3.E21.m1.5.5.1.1.1.1.cmml"><mo id="S3.E21.m1.5.5.1.1.1.2" stretchy="false" xref="S3.E21.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S3.E21.m1.5.5.1.1.1.1" xref="S3.E21.m1.5.5.1.1.1.1.cmml"><mi id="S3.E21.m1.5.5.1.1.1.1.2" xref="S3.E21.m1.5.5.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E21.m1.5.5.1.1.1.1.1" xref="S3.E21.m1.5.5.1.1.1.1.1.cmml">|</mo><mi id="S3.E21.m1.5.5.1.1.1.1.3" xref="S3.E21.m1.5.5.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E21.m1.5.5.1.1.1.3" stretchy="false" xref="S3.E21.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E21.m1.6.6.2" xref="S3.E21.m1.6.6.2.cmml"><msub id="S3.E21.m1.6.6.2.3" xref="S3.E21.m1.6.6.2.3.cmml"><mi id="S3.E21.m1.6.6.2.3.2" xref="S3.E21.m1.6.6.2.3.2.cmml">π</mi><mn id="S3.E21.m1.6.6.2.3.3" xref="S3.E21.m1.6.6.2.3.3.cmml">0</mn></msub><mo id="S3.E21.m1.6.6.2.2" xref="S3.E21.m1.6.6.2.2.cmml">⁢</mo><mrow id="S3.E21.m1.6.6.2.1.1" xref="S3.E21.m1.6.6.2.1.1.1.cmml"><mo id="S3.E21.m1.6.6.2.1.1.2" stretchy="false" xref="S3.E21.m1.6.6.2.1.1.1.cmml">(</mo><mrow id="S3.E21.m1.6.6.2.1.1.1" xref="S3.E21.m1.6.6.2.1.1.1.cmml"><mi id="S3.E21.m1.6.6.2.1.1.1.2" xref="S3.E21.m1.6.6.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E21.m1.6.6.2.1.1.1.1" xref="S3.E21.m1.6.6.2.1.1.1.1.cmml">|</mo><mi id="S3.E21.m1.6.6.2.1.1.1.3" xref="S3.E21.m1.6.6.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E21.m1.6.6.2.1.1.3" stretchy="false" xref="S3.E21.m1.6.6.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E21.m1.7.7.1.1.1.1.1.1.2" xref="S3.E21.m1.7.7.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E21.m1.7.7.1.1.1.1.1.1.1.1" xref="S3.E21.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E21.m1.7.7.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E21.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E21.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S3.E21.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E21.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="S3.E21.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="S3.E21.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S3.E21.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E21.m1.7.7.1.1.1.1.1.1.1.1.1.3" xref="S3.E21.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml">β</mi></mrow><mo id="S3.E21.m1.7.7.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E21.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E21.m1.7.7.1.2" lspace="0em" xref="S3.E21.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E21.m1.7b"><apply id="S3.E21.m1.7.7.1.1.cmml" xref="S3.E21.m1.7.7.1"><eq id="S3.E21.m1.7.7.1.1.2.cmml" xref="S3.E21.m1.7.7.1.1.2"></eq><apply id="S3.E21.m1.7.7.1.1.3.cmml" xref="S3.E21.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="S3.E21.m1.7.7.1.1.3.1.cmml" xref="S3.E21.m1.7.7.1.1.3">subscript</csymbol><apply id="S3.E21.m1.7.7.1.1.3.2.cmml" xref="S3.E21.m1.7.7.1.1.3.2"><ci id="S3.E21.m1.7.7.1.1.3.2.1.cmml" xref="S3.E21.m1.7.7.1.1.3.2.1">^</ci><ci id="S3.E21.m1.7.7.1.1.3.2.2.cmml" xref="S3.E21.m1.7.7.1.1.3.2.2">𝑉</ci></apply><apply id="S3.E21.m1.7.7.1.1.3.3.cmml" xref="S3.E21.m1.7.7.1.1.3.3"><times id="S3.E21.m1.7.7.1.1.3.3.1.cmml" xref="S3.E21.m1.7.7.1.1.3.3.1"></times><ci id="S3.E21.m1.7.7.1.1.3.3.2.cmml" xref="S3.E21.m1.7.7.1.1.3.3.2">𝛽</ci><ci id="S3.E21.m1.7.7.1.1.3.3.3a.cmml" xref="S3.E21.m1.7.7.1.1.3.3.3"><mtext id="S3.E21.m1.7.7.1.1.3.3.3.cmml" mathsize="70%" xref="S3.E21.m1.7.7.1.1.3.3.3">-</mtext></ci><ci id="S3.E21.m1.7.7.1.1.3.3.4.cmml" xref="S3.E21.m1.7.7.1.1.3.3.4">IPS</ci></apply></apply><apply id="S3.E21.m1.7.7.1.1.1.cmml" xref="S3.E21.m1.7.7.1.1.1"><plus id="S3.E21.m1.7.7.1.1.1.2.cmml" xref="S3.E21.m1.7.7.1.1.1.2"></plus><ci id="S3.E21.m1.7.7.1.1.1.3.cmml" xref="S3.E21.m1.7.7.1.1.1.3">𝛽</ci><apply id="S3.E21.m1.7.7.1.1.1.1.cmml" xref="S3.E21.m1.7.7.1.1.1.1"><times id="S3.E21.m1.7.7.1.1.1.1.2.cmml" xref="S3.E21.m1.7.7.1.1.1.1.2"></times><apply id="S3.E21.m1.1.1.cmml" xref="S3.E21.m1.1.1"><divide id="S3.E21.m1.1.1.2.cmml" xref="S3.E21.m1.1.1"></divide><cn id="S3.E21.m1.1.1.3.cmml" type="integer" xref="S3.E21.m1.1.1.3">1</cn><apply id="S3.E21.m1.1.1.1.2.cmml" xref="S3.E21.m1.1.1.1.3"><abs id="S3.E21.m1.1.1.1.2.1.cmml" xref="S3.E21.m1.1.1.1.3.1"></abs><ci id="S3.E21.m1.1.1.1.1.cmml" xref="S3.E21.m1.1.1.1.1">𝒟</ci></apply></apply><apply id="S3.E21.m1.7.7.1.1.1.1.1.cmml" xref="S3.E21.m1.7.7.1.1.1.1.1"><apply id="S3.E21.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.E21.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E21.m1.7.7.1.1.1.1.1.2.1.cmml" xref="S3.E21.m1.7.7.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E21.m1.7.7.1.1.1.1.1.2.2.cmml" xref="S3.E21.m1.7.7.1.1.1.1.1.2.2"></sum><apply id="S3.E21.m1.4.4.3.cmml" xref="S3.E21.m1.4.4.3"><in id="S3.E21.m1.4.4.3.4.cmml" xref="S3.E21.m1.4.4.3.4"></in><vector id="S3.E21.m1.4.4.3.5.1.cmml" xref="S3.E21.m1.4.4.3.5.2"><ci id="S3.E21.m1.2.2.1.1.cmml" xref="S3.E21.m1.2.2.1.1">𝑥</ci><ci id="S3.E21.m1.3.3.2.2.cmml" xref="S3.E21.m1.3.3.2.2">𝑎</ci><ci id="S3.E21.m1.4.4.3.3.cmml" xref="S3.E21.m1.4.4.3.3">𝑟</ci></vector><ci id="S3.E21.m1.4.4.3.6.cmml" xref="S3.E21.m1.4.4.3.6">𝒟</ci></apply></apply><apply id="S3.E21.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E21.m1.7.7.1.1.1.1.1.1"><times id="S3.E21.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E21.m1.7.7.1.1.1.1.1.1.2"></times><apply id="S3.E21.m1.6.6.cmml" xref="S3.E21.m1.6.6"><divide id="S3.E21.m1.6.6.3.cmml" xref="S3.E21.m1.6.6"></divide><apply id="S3.E21.m1.5.5.1.cmml" xref="S3.E21.m1.5.5.1"><times id="S3.E21.m1.5.5.1.2.cmml" xref="S3.E21.m1.5.5.1.2"></times><ci id="S3.E21.m1.5.5.1.3.cmml" xref="S3.E21.m1.5.5.1.3">𝜋</ci><apply id="S3.E21.m1.5.5.1.1.1.1.cmml" xref="S3.E21.m1.5.5.1.1.1"><csymbol cd="latexml" id="S3.E21.m1.5.5.1.1.1.1.1.cmml" xref="S3.E21.m1.5.5.1.1.1.1.1">conditional</csymbol><ci id="S3.E21.m1.5.5.1.1.1.1.2.cmml" xref="S3.E21.m1.5.5.1.1.1.1.2">𝑎</ci><ci id="S3.E21.m1.5.5.1.1.1.1.3.cmml" xref="S3.E21.m1.5.5.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.E21.m1.6.6.2.cmml" xref="S3.E21.m1.6.6.2"><times id="S3.E21.m1.6.6.2.2.cmml" xref="S3.E21.m1.6.6.2.2"></times><apply id="S3.E21.m1.6.6.2.3.cmml" xref="S3.E21.m1.6.6.2.3"><csymbol cd="ambiguous" id="S3.E21.m1.6.6.2.3.1.cmml" xref="S3.E21.m1.6.6.2.3">subscript</csymbol><ci id="S3.E21.m1.6.6.2.3.2.cmml" xref="S3.E21.m1.6.6.2.3.2">𝜋</ci><cn id="S3.E21.m1.6.6.2.3.3.cmml" type="integer" xref="S3.E21.m1.6.6.2.3.3">0</cn></apply><apply id="S3.E21.m1.6.6.2.1.1.1.cmml" xref="S3.E21.m1.6.6.2.1.1"><csymbol cd="latexml" id="S3.E21.m1.6.6.2.1.1.1.1.cmml" xref="S3.E21.m1.6.6.2.1.1.1.1">conditional</csymbol><ci id="S3.E21.m1.6.6.2.1.1.1.2.cmml" xref="S3.E21.m1.6.6.2.1.1.1.2">𝑎</ci><ci id="S3.E21.m1.6.6.2.1.1.1.3.cmml" xref="S3.E21.m1.6.6.2.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="S3.E21.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E21.m1.7.7.1.1.1.1.1.1.1.1"><minus id="S3.E21.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E21.m1.7.7.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.E21.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E21.m1.7.7.1.1.1.1.1.1.1.1.1.2">𝑟</ci><ci id="S3.E21.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E21.m1.7.7.1.1.1.1.1.1.1.1.1.3">𝛽</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E21.m1.7c">\widehat{V}_{\beta\text{-}{\rm IPS}}=\beta+\frac{1}{\left|\mathcal{D}\right|}%
\sum_{(x,a,r)\in\mathcal{D}}\frac{\pi(a|x)}{\pi_{0}(a|x)}(r-\beta).</annotation><annotation encoding="application/x-llamapun" id="S3.E21.m1.7d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_β - roman_IPS end_POSTSUBSCRIPT = italic_β + divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) ∈ caligraphic_D end_POSTSUBSCRIPT divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ( italic_r - italic_β ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.7">Its unbiasedness is easily verified:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E22">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(22)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\mathop{\mathbb{E}}\left[\widehat{V}_{\beta\text{-}{\rm IPS}}%
\right]&amp;=\mathop{\mathbb{E}}\left[\beta\right]+\mathop{\mathbb{E}}\left[\frac{%
\pi(a|x)}{\pi_{0}(a|x)}(r-\beta)\right]\\
&amp;=\beta+\mathop{\mathbb{E}}\left[\frac{\pi(a|x)}{\pi_{0}(a|x)}r\right]-\beta%
\qquad=V(\pi).\end{split}" class="ltx_math_unparsed" display="block" id="S3.E22.m1.38"><semantics id="S3.E22.m1.38a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E22.m1.38.38.2" rowspacing="0pt"><mtr id="S3.E22.m1.38.38.2a"><mtd class="ltx_align_right" columnalign="right" id="S3.E22.m1.38.38.2b"><mrow id="S3.E22.m1.37.37.1.37.21.6"><mo id="S3.E22.m1.1.1.1.1.1.1" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S3.E22.m1.37.37.1.37.21.6.6.1"><mo id="S3.E22.m1.2.2.2.2.2.2">[</mo><msub id="S3.E22.m1.37.37.1.37.21.6.6.1.1"><mover accent="true" id="S3.E22.m1.3.3.3.3.3.3"><mi id="S3.E22.m1.3.3.3.3.3.3.2">V</mi><mo id="S3.E22.m1.3.3.3.3.3.3.1">^</mo></mover><mrow id="S3.E22.m1.4.4.4.4.4.4.1"><mi id="S3.E22.m1.4.4.4.4.4.4.1.2">β</mi><mo id="S3.E22.m1.4.4.4.4.4.4.1.1">⁢</mo><mtext id="S3.E22.m1.4.4.4.4.4.4.1.3">-</mtext><mo id="S3.E22.m1.4.4.4.4.4.4.1.1a">⁢</mo><mi id="S3.E22.m1.4.4.4.4.4.4.1.4">IPS</mi></mrow></msub><mo id="S3.E22.m1.5.5.5.5.5.5">]</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E22.m1.38.38.2c"><mrow id="S3.E22.m1.38.38.2.38.22.16"><mi id="S3.E22.m1.38.38.2.38.22.16.17"></mi><mo id="S3.E22.m1.6.6.6.6.1.1" rspace="0.1389em">=</mo><mrow id="S3.E22.m1.38.38.2.38.22.16.16"><mrow id="S3.E22.m1.38.38.2.38.22.16.16.2"><mo id="S3.E22.m1.7.7.7.7.2.2" lspace="0.1389em" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S3.E22.m1.38.38.2.38.22.16.16.2.1"><mo id="S3.E22.m1.8.8.8.8.3.3">[</mo><mi id="S3.E22.m1.9.9.9.9.4.4">β</mi><mo id="S3.E22.m1.10.10.10.10.5.5">]</mo></mrow></mrow><mo id="S3.E22.m1.11.11.11.11.6.6">+</mo><mrow id="S3.E22.m1.38.38.2.38.22.16.16.1"><mo id="S3.E22.m1.12.12.12.12.7.7" lspace="0em" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S3.E22.m1.38.38.2.38.22.16.16.1.1.1"><mo id="S3.E22.m1.13.13.13.13.8.8">[</mo><mrow id="S3.E22.m1.38.38.2.38.22.16.16.1.1.1.1"><mfrac id="S3.E22.m1.14.14.14.14.9.9"><mrow id="S3.E22.m1.14.14.14.14.9.9.1"><mi id="S3.E22.m1.14.14.14.14.9.9.1.3">π</mi><mo id="S3.E22.m1.14.14.14.14.9.9.1.2">⁢</mo><mrow id="S3.E22.m1.14.14.14.14.9.9.1.1.1"><mo id="S3.E22.m1.14.14.14.14.9.9.1.1.1.2" stretchy="false">(</mo><mrow id="S3.E22.m1.14.14.14.14.9.9.1.1.1.1"><mi id="S3.E22.m1.14.14.14.14.9.9.1.1.1.1.2">a</mi><mo fence="false" id="S3.E22.m1.14.14.14.14.9.9.1.1.1.1.1">|</mo><mi id="S3.E22.m1.14.14.14.14.9.9.1.1.1.1.3">x</mi></mrow><mo id="S3.E22.m1.14.14.14.14.9.9.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mrow id="S3.E22.m1.14.14.14.14.9.9.2"><msub id="S3.E22.m1.14.14.14.14.9.9.2.3"><mi id="S3.E22.m1.14.14.14.14.9.9.2.3.2">π</mi><mn id="S3.E22.m1.14.14.14.14.9.9.2.3.3">0</mn></msub><mo id="S3.E22.m1.14.14.14.14.9.9.2.2">⁢</mo><mrow id="S3.E22.m1.14.14.14.14.9.9.2.1.1"><mo id="S3.E22.m1.14.14.14.14.9.9.2.1.1.2" stretchy="false">(</mo><mrow id="S3.E22.m1.14.14.14.14.9.9.2.1.1.1"><mi id="S3.E22.m1.14.14.14.14.9.9.2.1.1.1.2">a</mi><mo fence="false" id="S3.E22.m1.14.14.14.14.9.9.2.1.1.1.1">|</mo><mi id="S3.E22.m1.14.14.14.14.9.9.2.1.1.1.3">x</mi></mrow><mo id="S3.E22.m1.14.14.14.14.9.9.2.1.1.3" stretchy="false">)</mo></mrow></mrow></mfrac><mo id="S3.E22.m1.38.38.2.38.22.16.16.1.1.1.1.2">⁢</mo><mrow id="S3.E22.m1.38.38.2.38.22.16.16.1.1.1.1.1.1"><mo id="S3.E22.m1.15.15.15.15.10.10" stretchy="false">(</mo><mrow id="S3.E22.m1.38.38.2.38.22.16.16.1.1.1.1.1.1.1"><mi id="S3.E22.m1.16.16.16.16.11.11">r</mi><mo id="S3.E22.m1.17.17.17.17.12.12">−</mo><mi id="S3.E22.m1.18.18.18.18.13.13">β</mi></mrow><mo id="S3.E22.m1.19.19.19.19.14.14" stretchy="false">)</mo></mrow></mrow><mo id="S3.E22.m1.20.20.20.20.15.15">]</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E22.m1.38.38.2d"><mtd id="S3.E22.m1.38.38.2e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E22.m1.38.38.2f"><mrow id="S3.E22.m1.36.36.36.16.16"><mo id="S3.E22.m1.21.21.21.1.1.1">=</mo><mi id="S3.E22.m1.22.22.22.2.2.2">β</mi><mo id="S3.E22.m1.23.23.23.3.3.3">+</mo><mo id="S3.E22.m1.24.24.24.4.4.4" lspace="0em" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S3.E22.m1.36.36.36.16.16.17"><mo id="S3.E22.m1.25.25.25.5.5.5">[</mo><mfrac id="S3.E22.m1.26.26.26.6.6.6"><mrow id="S3.E22.m1.26.26.26.6.6.6.1"><mi id="S3.E22.m1.26.26.26.6.6.6.1.3">π</mi><mo id="S3.E22.m1.26.26.26.6.6.6.1.2">⁢</mo><mrow id="S3.E22.m1.26.26.26.6.6.6.1.1.1"><mo id="S3.E22.m1.26.26.26.6.6.6.1.1.1.2" stretchy="false">(</mo><mrow id="S3.E22.m1.26.26.26.6.6.6.1.1.1.1"><mi id="S3.E22.m1.26.26.26.6.6.6.1.1.1.1.2">a</mi><mo fence="false" id="S3.E22.m1.26.26.26.6.6.6.1.1.1.1.1">|</mo><mi id="S3.E22.m1.26.26.26.6.6.6.1.1.1.1.3">x</mi></mrow><mo id="S3.E22.m1.26.26.26.6.6.6.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mrow id="S3.E22.m1.26.26.26.6.6.6.2"><msub id="S3.E22.m1.26.26.26.6.6.6.2.3"><mi id="S3.E22.m1.26.26.26.6.6.6.2.3.2">π</mi><mn id="S3.E22.m1.26.26.26.6.6.6.2.3.3">0</mn></msub><mo id="S3.E22.m1.26.26.26.6.6.6.2.2">⁢</mo><mrow id="S3.E22.m1.26.26.26.6.6.6.2.1.1"><mo id="S3.E22.m1.26.26.26.6.6.6.2.1.1.2" stretchy="false">(</mo><mrow id="S3.E22.m1.26.26.26.6.6.6.2.1.1.1"><mi id="S3.E22.m1.26.26.26.6.6.6.2.1.1.1.2">a</mi><mo fence="false" id="S3.E22.m1.26.26.26.6.6.6.2.1.1.1.1">|</mo><mi id="S3.E22.m1.26.26.26.6.6.6.2.1.1.1.3">x</mi></mrow><mo id="S3.E22.m1.26.26.26.6.6.6.2.1.1.3" stretchy="false">)</mo></mrow></mrow></mfrac><mi id="S3.E22.m1.27.27.27.7.7.7">r</mi><mo id="S3.E22.m1.28.28.28.8.8.8">]</mo></mrow><mo id="S3.E22.m1.29.29.29.9.9.9">−</mo><mi id="S3.E22.m1.30.30.30.10.10.10">β</mi><mspace id="S3.E22.m1.36.36.36.16.16.18" width="2em"></mspace><mo id="S3.E22.m1.31.31.31.11.11.11">=</mo><mi id="S3.E22.m1.32.32.32.12.12.12">V</mi><mrow id="S3.E22.m1.36.36.36.16.16.19"><mo id="S3.E22.m1.33.33.33.13.13.13" stretchy="false">(</mo><mi id="S3.E22.m1.34.34.34.14.14.14">π</mi><mo id="S3.E22.m1.35.35.35.15.15.15" stretchy="false">)</mo></mrow><mo id="S3.E22.m1.36.36.36.16.16.16" lspace="0em">.</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S3.E22.m1.38b">\begin{split}\mathop{\mathbb{E}}\left[\widehat{V}_{\beta\text{-}{\rm IPS}}%
\right]&amp;=\mathop{\mathbb{E}}\left[\beta\right]+\mathop{\mathbb{E}}\left[\frac{%
\pi(a|x)}{\pi_{0}(a|x)}(r-\beta)\right]\\
&amp;=\beta+\mathop{\mathbb{E}}\left[\frac{\pi(a|x)}{\pi_{0}(a|x)}r\right]-\beta%
\qquad=V(\pi).\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E22.m1.38c">start_ROW start_CELL blackboard_E [ over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_β - roman_IPS end_POSTSUBSCRIPT ] end_CELL start_CELL = blackboard_E [ italic_β ] + blackboard_E [ divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ( italic_r - italic_β ) ] end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL = italic_β + blackboard_E [ divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG italic_r ] - italic_β = italic_V ( italic_π ) . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.3">From an optimization perspective, we are mainly interested in the gradient of the <math alttext="\widehat{V}_{{\rm\beta\text{-}IPS}}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m1.1"><semantics id="S3.SS1.p1.3.m1.1a"><msub id="S3.SS1.p1.3.m1.1.1" xref="S3.SS1.p1.3.m1.1.1.cmml"><mover accent="true" id="S3.SS1.p1.3.m1.1.1.2" xref="S3.SS1.p1.3.m1.1.1.2.cmml"><mi id="S3.SS1.p1.3.m1.1.1.2.2" xref="S3.SS1.p1.3.m1.1.1.2.2.cmml">V</mi><mo id="S3.SS1.p1.3.m1.1.1.2.1" xref="S3.SS1.p1.3.m1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS1.p1.3.m1.1.1.3" xref="S3.SS1.p1.3.m1.1.1.3.cmml"><mi id="S3.SS1.p1.3.m1.1.1.3.2" xref="S3.SS1.p1.3.m1.1.1.3.2.cmml">β</mi><mo id="S3.SS1.p1.3.m1.1.1.3.1" xref="S3.SS1.p1.3.m1.1.1.3.1.cmml">⁢</mo><mtext id="S3.SS1.p1.3.m1.1.1.3.3" xref="S3.SS1.p1.3.m1.1.1.3.3a.cmml">-</mtext><mo id="S3.SS1.p1.3.m1.1.1.3.1a" xref="S3.SS1.p1.3.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.3.m1.1.1.3.4" xref="S3.SS1.p1.3.m1.1.1.3.4.cmml">IPS</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m1.1b"><apply id="S3.SS1.p1.3.m1.1.1.cmml" xref="S3.SS1.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m1.1.1.1.cmml" xref="S3.SS1.p1.3.m1.1.1">subscript</csymbol><apply id="S3.SS1.p1.3.m1.1.1.2.cmml" xref="S3.SS1.p1.3.m1.1.1.2"><ci id="S3.SS1.p1.3.m1.1.1.2.1.cmml" xref="S3.SS1.p1.3.m1.1.1.2.1">^</ci><ci id="S3.SS1.p1.3.m1.1.1.2.2.cmml" xref="S3.SS1.p1.3.m1.1.1.2.2">𝑉</ci></apply><apply id="S3.SS1.p1.3.m1.1.1.3.cmml" xref="S3.SS1.p1.3.m1.1.1.3"><times id="S3.SS1.p1.3.m1.1.1.3.1.cmml" xref="S3.SS1.p1.3.m1.1.1.3.1"></times><ci id="S3.SS1.p1.3.m1.1.1.3.2.cmml" xref="S3.SS1.p1.3.m1.1.1.3.2">𝛽</ci><ci id="S3.SS1.p1.3.m1.1.1.3.3a.cmml" xref="S3.SS1.p1.3.m1.1.1.3.3"><mtext id="S3.SS1.p1.3.m1.1.1.3.3.cmml" mathsize="70%" xref="S3.SS1.p1.3.m1.1.1.3.3">-</mtext></ci><ci id="S3.SS1.p1.3.m1.1.1.3.4.cmml" xref="S3.SS1.p1.3.m1.1.1.3.4">IPS</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m1.1c">\widehat{V}_{{\rm\beta\text{-}IPS}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m1.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_β - roman_IPS end_POSTSUBSCRIPT</annotation></semantics></math> objective:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E23">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(23)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla\widehat{V}_{\beta\text{-}{\rm IPS}}(\pi,\mathcal{B})=\frac{1}{\left|%
\mathcal{B}\right|}\sum_{(x,a,r)\in\mathcal{B}}\frac{\nabla\pi(a|x)}{\pi_{0}(a%
|x)}\left(r-\beta\right)." class="ltx_Math" display="block" id="S3.E23.m1.9"><semantics id="S3.E23.m1.9a"><mrow id="S3.E23.m1.9.9.1" xref="S3.E23.m1.9.9.1.1.cmml"><mrow id="S3.E23.m1.9.9.1.1" xref="S3.E23.m1.9.9.1.1.cmml"><mrow id="S3.E23.m1.9.9.1.1.3" xref="S3.E23.m1.9.9.1.1.3.cmml"><mrow id="S3.E23.m1.9.9.1.1.3.2" xref="S3.E23.m1.9.9.1.1.3.2.cmml"><mo id="S3.E23.m1.9.9.1.1.3.2.1" rspace="0.167em" xref="S3.E23.m1.9.9.1.1.3.2.1.cmml">∇</mo><msub id="S3.E23.m1.9.9.1.1.3.2.2" xref="S3.E23.m1.9.9.1.1.3.2.2.cmml"><mover accent="true" id="S3.E23.m1.9.9.1.1.3.2.2.2" xref="S3.E23.m1.9.9.1.1.3.2.2.2.cmml"><mi id="S3.E23.m1.9.9.1.1.3.2.2.2.2" xref="S3.E23.m1.9.9.1.1.3.2.2.2.2.cmml">V</mi><mo id="S3.E23.m1.9.9.1.1.3.2.2.2.1" xref="S3.E23.m1.9.9.1.1.3.2.2.2.1.cmml">^</mo></mover><mrow id="S3.E23.m1.9.9.1.1.3.2.2.3" xref="S3.E23.m1.9.9.1.1.3.2.2.3.cmml"><mi id="S3.E23.m1.9.9.1.1.3.2.2.3.2" xref="S3.E23.m1.9.9.1.1.3.2.2.3.2.cmml">β</mi><mo id="S3.E23.m1.9.9.1.1.3.2.2.3.1" xref="S3.E23.m1.9.9.1.1.3.2.2.3.1.cmml">⁢</mo><mtext id="S3.E23.m1.9.9.1.1.3.2.2.3.3" xref="S3.E23.m1.9.9.1.1.3.2.2.3.3a.cmml">-</mtext><mo id="S3.E23.m1.9.9.1.1.3.2.2.3.1a" xref="S3.E23.m1.9.9.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S3.E23.m1.9.9.1.1.3.2.2.3.4" xref="S3.E23.m1.9.9.1.1.3.2.2.3.4.cmml">IPS</mi></mrow></msub></mrow><mo id="S3.E23.m1.9.9.1.1.3.1" xref="S3.E23.m1.9.9.1.1.3.1.cmml">⁢</mo><mrow id="S3.E23.m1.9.9.1.1.3.3.2" xref="S3.E23.m1.9.9.1.1.3.3.1.cmml"><mo id="S3.E23.m1.9.9.1.1.3.3.2.1" stretchy="false" xref="S3.E23.m1.9.9.1.1.3.3.1.cmml">(</mo><mi id="S3.E23.m1.7.7" xref="S3.E23.m1.7.7.cmml">π</mi><mo id="S3.E23.m1.9.9.1.1.3.3.2.2" xref="S3.E23.m1.9.9.1.1.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E23.m1.8.8" xref="S3.E23.m1.8.8.cmml">ℬ</mi><mo id="S3.E23.m1.9.9.1.1.3.3.2.3" stretchy="false" xref="S3.E23.m1.9.9.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E23.m1.9.9.1.1.2" xref="S3.E23.m1.9.9.1.1.2.cmml">=</mo><mrow id="S3.E23.m1.9.9.1.1.1" xref="S3.E23.m1.9.9.1.1.1.cmml"><mfrac id="S3.E23.m1.1.1" xref="S3.E23.m1.1.1.cmml"><mn id="S3.E23.m1.1.1.3" xref="S3.E23.m1.1.1.3.cmml">1</mn><mrow id="S3.E23.m1.1.1.1.3" xref="S3.E23.m1.1.1.1.2.cmml"><mo id="S3.E23.m1.1.1.1.3.1" xref="S3.E23.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E23.m1.1.1.1.1" xref="S3.E23.m1.1.1.1.1.cmml">ℬ</mi><mo id="S3.E23.m1.1.1.1.3.2" xref="S3.E23.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.E23.m1.9.9.1.1.1.2" xref="S3.E23.m1.9.9.1.1.1.2.cmml">⁢</mo><mrow id="S3.E23.m1.9.9.1.1.1.1" xref="S3.E23.m1.9.9.1.1.1.1.cmml"><munder id="S3.E23.m1.9.9.1.1.1.1.2" xref="S3.E23.m1.9.9.1.1.1.1.2.cmml"><mo id="S3.E23.m1.9.9.1.1.1.1.2.2" movablelimits="false" xref="S3.E23.m1.9.9.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E23.m1.4.4.3" xref="S3.E23.m1.4.4.3.cmml"><mrow id="S3.E23.m1.4.4.3.5.2" xref="S3.E23.m1.4.4.3.5.1.cmml"><mo id="S3.E23.m1.4.4.3.5.2.1" stretchy="false" xref="S3.E23.m1.4.4.3.5.1.cmml">(</mo><mi id="S3.E23.m1.2.2.1.1" xref="S3.E23.m1.2.2.1.1.cmml">x</mi><mo id="S3.E23.m1.4.4.3.5.2.2" xref="S3.E23.m1.4.4.3.5.1.cmml">,</mo><mi id="S3.E23.m1.3.3.2.2" xref="S3.E23.m1.3.3.2.2.cmml">a</mi><mo id="S3.E23.m1.4.4.3.5.2.3" xref="S3.E23.m1.4.4.3.5.1.cmml">,</mo><mi id="S3.E23.m1.4.4.3.3" xref="S3.E23.m1.4.4.3.3.cmml">r</mi><mo id="S3.E23.m1.4.4.3.5.2.4" stretchy="false" xref="S3.E23.m1.4.4.3.5.1.cmml">)</mo></mrow><mo id="S3.E23.m1.4.4.3.4" xref="S3.E23.m1.4.4.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E23.m1.4.4.3.6" xref="S3.E23.m1.4.4.3.6.cmml">ℬ</mi></mrow></munder><mrow id="S3.E23.m1.9.9.1.1.1.1.1" xref="S3.E23.m1.9.9.1.1.1.1.1.cmml"><mfrac id="S3.E23.m1.6.6" xref="S3.E23.m1.6.6.cmml"><mrow id="S3.E23.m1.5.5.1" xref="S3.E23.m1.5.5.1.cmml"><mrow id="S3.E23.m1.5.5.1.3" xref="S3.E23.m1.5.5.1.3.cmml"><mo id="S3.E23.m1.5.5.1.3.1" rspace="0.167em" xref="S3.E23.m1.5.5.1.3.1.cmml">∇</mo><mi id="S3.E23.m1.5.5.1.3.2" xref="S3.E23.m1.5.5.1.3.2.cmml">π</mi></mrow><mo id="S3.E23.m1.5.5.1.2" xref="S3.E23.m1.5.5.1.2.cmml">⁢</mo><mrow id="S3.E23.m1.5.5.1.1.1" xref="S3.E23.m1.5.5.1.1.1.1.cmml"><mo id="S3.E23.m1.5.5.1.1.1.2" stretchy="false" xref="S3.E23.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S3.E23.m1.5.5.1.1.1.1" xref="S3.E23.m1.5.5.1.1.1.1.cmml"><mi id="S3.E23.m1.5.5.1.1.1.1.2" xref="S3.E23.m1.5.5.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E23.m1.5.5.1.1.1.1.1" xref="S3.E23.m1.5.5.1.1.1.1.1.cmml">|</mo><mi id="S3.E23.m1.5.5.1.1.1.1.3" xref="S3.E23.m1.5.5.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E23.m1.5.5.1.1.1.3" stretchy="false" xref="S3.E23.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E23.m1.6.6.2" xref="S3.E23.m1.6.6.2.cmml"><msub id="S3.E23.m1.6.6.2.3" xref="S3.E23.m1.6.6.2.3.cmml"><mi id="S3.E23.m1.6.6.2.3.2" xref="S3.E23.m1.6.6.2.3.2.cmml">π</mi><mn id="S3.E23.m1.6.6.2.3.3" xref="S3.E23.m1.6.6.2.3.3.cmml">0</mn></msub><mo id="S3.E23.m1.6.6.2.2" xref="S3.E23.m1.6.6.2.2.cmml">⁢</mo><mrow id="S3.E23.m1.6.6.2.1.1" xref="S3.E23.m1.6.6.2.1.1.1.cmml"><mo id="S3.E23.m1.6.6.2.1.1.2" stretchy="false" xref="S3.E23.m1.6.6.2.1.1.1.cmml">(</mo><mrow id="S3.E23.m1.6.6.2.1.1.1" xref="S3.E23.m1.6.6.2.1.1.1.cmml"><mi id="S3.E23.m1.6.6.2.1.1.1.2" xref="S3.E23.m1.6.6.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E23.m1.6.6.2.1.1.1.1" xref="S3.E23.m1.6.6.2.1.1.1.1.cmml">|</mo><mi id="S3.E23.m1.6.6.2.1.1.1.3" xref="S3.E23.m1.6.6.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E23.m1.6.6.2.1.1.3" stretchy="false" xref="S3.E23.m1.6.6.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E23.m1.9.9.1.1.1.1.1.2" xref="S3.E23.m1.9.9.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E23.m1.9.9.1.1.1.1.1.1.1" xref="S3.E23.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E23.m1.9.9.1.1.1.1.1.1.1.2" xref="S3.E23.m1.9.9.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E23.m1.9.9.1.1.1.1.1.1.1.1" xref="S3.E23.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E23.m1.9.9.1.1.1.1.1.1.1.1.2" xref="S3.E23.m1.9.9.1.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="S3.E23.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S3.E23.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E23.m1.9.9.1.1.1.1.1.1.1.1.3" xref="S3.E23.m1.9.9.1.1.1.1.1.1.1.1.3.cmml">β</mi></mrow><mo id="S3.E23.m1.9.9.1.1.1.1.1.1.1.3" xref="S3.E23.m1.9.9.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E23.m1.9.9.1.2" lspace="0em" xref="S3.E23.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E23.m1.9b"><apply id="S3.E23.m1.9.9.1.1.cmml" xref="S3.E23.m1.9.9.1"><eq id="S3.E23.m1.9.9.1.1.2.cmml" xref="S3.E23.m1.9.9.1.1.2"></eq><apply id="S3.E23.m1.9.9.1.1.3.cmml" xref="S3.E23.m1.9.9.1.1.3"><times id="S3.E23.m1.9.9.1.1.3.1.cmml" xref="S3.E23.m1.9.9.1.1.3.1"></times><apply id="S3.E23.m1.9.9.1.1.3.2.cmml" xref="S3.E23.m1.9.9.1.1.3.2"><ci id="S3.E23.m1.9.9.1.1.3.2.1.cmml" xref="S3.E23.m1.9.9.1.1.3.2.1">∇</ci><apply id="S3.E23.m1.9.9.1.1.3.2.2.cmml" xref="S3.E23.m1.9.9.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E23.m1.9.9.1.1.3.2.2.1.cmml" xref="S3.E23.m1.9.9.1.1.3.2.2">subscript</csymbol><apply id="S3.E23.m1.9.9.1.1.3.2.2.2.cmml" xref="S3.E23.m1.9.9.1.1.3.2.2.2"><ci id="S3.E23.m1.9.9.1.1.3.2.2.2.1.cmml" xref="S3.E23.m1.9.9.1.1.3.2.2.2.1">^</ci><ci id="S3.E23.m1.9.9.1.1.3.2.2.2.2.cmml" xref="S3.E23.m1.9.9.1.1.3.2.2.2.2">𝑉</ci></apply><apply id="S3.E23.m1.9.9.1.1.3.2.2.3.cmml" xref="S3.E23.m1.9.9.1.1.3.2.2.3"><times id="S3.E23.m1.9.9.1.1.3.2.2.3.1.cmml" xref="S3.E23.m1.9.9.1.1.3.2.2.3.1"></times><ci id="S3.E23.m1.9.9.1.1.3.2.2.3.2.cmml" xref="S3.E23.m1.9.9.1.1.3.2.2.3.2">𝛽</ci><ci id="S3.E23.m1.9.9.1.1.3.2.2.3.3a.cmml" xref="S3.E23.m1.9.9.1.1.3.2.2.3.3"><mtext id="S3.E23.m1.9.9.1.1.3.2.2.3.3.cmml" mathsize="70%" xref="S3.E23.m1.9.9.1.1.3.2.2.3.3">-</mtext></ci><ci id="S3.E23.m1.9.9.1.1.3.2.2.3.4.cmml" xref="S3.E23.m1.9.9.1.1.3.2.2.3.4">IPS</ci></apply></apply></apply><interval closure="open" id="S3.E23.m1.9.9.1.1.3.3.1.cmml" xref="S3.E23.m1.9.9.1.1.3.3.2"><ci id="S3.E23.m1.7.7.cmml" xref="S3.E23.m1.7.7">𝜋</ci><ci id="S3.E23.m1.8.8.cmml" xref="S3.E23.m1.8.8">ℬ</ci></interval></apply><apply id="S3.E23.m1.9.9.1.1.1.cmml" xref="S3.E23.m1.9.9.1.1.1"><times id="S3.E23.m1.9.9.1.1.1.2.cmml" xref="S3.E23.m1.9.9.1.1.1.2"></times><apply id="S3.E23.m1.1.1.cmml" xref="S3.E23.m1.1.1"><divide id="S3.E23.m1.1.1.2.cmml" xref="S3.E23.m1.1.1"></divide><cn id="S3.E23.m1.1.1.3.cmml" type="integer" xref="S3.E23.m1.1.1.3">1</cn><apply id="S3.E23.m1.1.1.1.2.cmml" xref="S3.E23.m1.1.1.1.3"><abs id="S3.E23.m1.1.1.1.2.1.cmml" xref="S3.E23.m1.1.1.1.3.1"></abs><ci id="S3.E23.m1.1.1.1.1.cmml" xref="S3.E23.m1.1.1.1.1">ℬ</ci></apply></apply><apply id="S3.E23.m1.9.9.1.1.1.1.cmml" xref="S3.E23.m1.9.9.1.1.1.1"><apply id="S3.E23.m1.9.9.1.1.1.1.2.cmml" xref="S3.E23.m1.9.9.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E23.m1.9.9.1.1.1.1.2.1.cmml" xref="S3.E23.m1.9.9.1.1.1.1.2">subscript</csymbol><sum id="S3.E23.m1.9.9.1.1.1.1.2.2.cmml" xref="S3.E23.m1.9.9.1.1.1.1.2.2"></sum><apply id="S3.E23.m1.4.4.3.cmml" xref="S3.E23.m1.4.4.3"><in id="S3.E23.m1.4.4.3.4.cmml" xref="S3.E23.m1.4.4.3.4"></in><vector id="S3.E23.m1.4.4.3.5.1.cmml" xref="S3.E23.m1.4.4.3.5.2"><ci id="S3.E23.m1.2.2.1.1.cmml" xref="S3.E23.m1.2.2.1.1">𝑥</ci><ci id="S3.E23.m1.3.3.2.2.cmml" xref="S3.E23.m1.3.3.2.2">𝑎</ci><ci id="S3.E23.m1.4.4.3.3.cmml" xref="S3.E23.m1.4.4.3.3">𝑟</ci></vector><ci id="S3.E23.m1.4.4.3.6.cmml" xref="S3.E23.m1.4.4.3.6">ℬ</ci></apply></apply><apply id="S3.E23.m1.9.9.1.1.1.1.1.cmml" xref="S3.E23.m1.9.9.1.1.1.1.1"><times id="S3.E23.m1.9.9.1.1.1.1.1.2.cmml" xref="S3.E23.m1.9.9.1.1.1.1.1.2"></times><apply id="S3.E23.m1.6.6.cmml" xref="S3.E23.m1.6.6"><divide id="S3.E23.m1.6.6.3.cmml" xref="S3.E23.m1.6.6"></divide><apply id="S3.E23.m1.5.5.1.cmml" xref="S3.E23.m1.5.5.1"><times id="S3.E23.m1.5.5.1.2.cmml" xref="S3.E23.m1.5.5.1.2"></times><apply id="S3.E23.m1.5.5.1.3.cmml" xref="S3.E23.m1.5.5.1.3"><ci id="S3.E23.m1.5.5.1.3.1.cmml" xref="S3.E23.m1.5.5.1.3.1">∇</ci><ci id="S3.E23.m1.5.5.1.3.2.cmml" xref="S3.E23.m1.5.5.1.3.2">𝜋</ci></apply><apply id="S3.E23.m1.5.5.1.1.1.1.cmml" xref="S3.E23.m1.5.5.1.1.1"><csymbol cd="latexml" id="S3.E23.m1.5.5.1.1.1.1.1.cmml" xref="S3.E23.m1.5.5.1.1.1.1.1">conditional</csymbol><ci id="S3.E23.m1.5.5.1.1.1.1.2.cmml" xref="S3.E23.m1.5.5.1.1.1.1.2">𝑎</ci><ci id="S3.E23.m1.5.5.1.1.1.1.3.cmml" xref="S3.E23.m1.5.5.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.E23.m1.6.6.2.cmml" xref="S3.E23.m1.6.6.2"><times id="S3.E23.m1.6.6.2.2.cmml" xref="S3.E23.m1.6.6.2.2"></times><apply id="S3.E23.m1.6.6.2.3.cmml" xref="S3.E23.m1.6.6.2.3"><csymbol cd="ambiguous" id="S3.E23.m1.6.6.2.3.1.cmml" xref="S3.E23.m1.6.6.2.3">subscript</csymbol><ci id="S3.E23.m1.6.6.2.3.2.cmml" xref="S3.E23.m1.6.6.2.3.2">𝜋</ci><cn id="S3.E23.m1.6.6.2.3.3.cmml" type="integer" xref="S3.E23.m1.6.6.2.3.3">0</cn></apply><apply id="S3.E23.m1.6.6.2.1.1.1.cmml" xref="S3.E23.m1.6.6.2.1.1"><csymbol cd="latexml" id="S3.E23.m1.6.6.2.1.1.1.1.cmml" xref="S3.E23.m1.6.6.2.1.1.1.1">conditional</csymbol><ci id="S3.E23.m1.6.6.2.1.1.1.2.cmml" xref="S3.E23.m1.6.6.2.1.1.1.2">𝑎</ci><ci id="S3.E23.m1.6.6.2.1.1.1.3.cmml" xref="S3.E23.m1.6.6.2.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="S3.E23.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S3.E23.m1.9.9.1.1.1.1.1.1.1"><minus id="S3.E23.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E23.m1.9.9.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.E23.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E23.m1.9.9.1.1.1.1.1.1.1.1.2">𝑟</ci><ci id="S3.E23.m1.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E23.m1.9.9.1.1.1.1.1.1.1.1.3">𝛽</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E23.m1.9c">\nabla\widehat{V}_{\beta\text{-}{\rm IPS}}(\pi,\mathcal{B})=\frac{1}{\left|%
\mathcal{B}\right|}\sum_{(x,a,r)\in\mathcal{B}}\frac{\nabla\pi(a|x)}{\pi_{0}(a%
|x)}\left(r-\beta\right).</annotation><annotation encoding="application/x-llamapun" id="S3.E23.m1.9d">∇ over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_β - roman_IPS end_POSTSUBSCRIPT ( italic_π , caligraphic_B ) = divide start_ARG 1 end_ARG start_ARG | caligraphic_B | end_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) ∈ caligraphic_B end_POSTSUBSCRIPT divide start_ARG ∇ italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ( italic_r - italic_β ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.6">Our key insight is that SNIPS and certain doubly-robust estimators have an equivalent gradient to the proposed <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m1.1"><semantics id="S3.SS1.p1.4.m1.1a"><mi id="S3.SS1.p1.4.m1.1.1" xref="S3.SS1.p1.4.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m1.1b"><ci id="S3.SS1.p1.4.m1.1.1.cmml" xref="S3.SS1.p1.4.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m1.1d">italic_β</annotation></semantics></math>-IPS estimator.
As a result, optimizing them is equivalent to optimizing <math alttext="\widehat{V}_{\beta\text{-}{\rm IPS}}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m2.1"><semantics id="S3.SS1.p1.5.m2.1a"><msub id="S3.SS1.p1.5.m2.1.1" xref="S3.SS1.p1.5.m2.1.1.cmml"><mover accent="true" id="S3.SS1.p1.5.m2.1.1.2" xref="S3.SS1.p1.5.m2.1.1.2.cmml"><mi id="S3.SS1.p1.5.m2.1.1.2.2" xref="S3.SS1.p1.5.m2.1.1.2.2.cmml">V</mi><mo id="S3.SS1.p1.5.m2.1.1.2.1" xref="S3.SS1.p1.5.m2.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS1.p1.5.m2.1.1.3" xref="S3.SS1.p1.5.m2.1.1.3.cmml"><mi id="S3.SS1.p1.5.m2.1.1.3.2" xref="S3.SS1.p1.5.m2.1.1.3.2.cmml">β</mi><mo id="S3.SS1.p1.5.m2.1.1.3.1" xref="S3.SS1.p1.5.m2.1.1.3.1.cmml">⁢</mo><mtext id="S3.SS1.p1.5.m2.1.1.3.3" xref="S3.SS1.p1.5.m2.1.1.3.3a.cmml">-</mtext><mo id="S3.SS1.p1.5.m2.1.1.3.1a" xref="S3.SS1.p1.5.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.5.m2.1.1.3.4" xref="S3.SS1.p1.5.m2.1.1.3.4.cmml">IPS</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m2.1b"><apply id="S3.SS1.p1.5.m2.1.1.cmml" xref="S3.SS1.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m2.1.1.1.cmml" xref="S3.SS1.p1.5.m2.1.1">subscript</csymbol><apply id="S3.SS1.p1.5.m2.1.1.2.cmml" xref="S3.SS1.p1.5.m2.1.1.2"><ci id="S3.SS1.p1.5.m2.1.1.2.1.cmml" xref="S3.SS1.p1.5.m2.1.1.2.1">^</ci><ci id="S3.SS1.p1.5.m2.1.1.2.2.cmml" xref="S3.SS1.p1.5.m2.1.1.2.2">𝑉</ci></apply><apply id="S3.SS1.p1.5.m2.1.1.3.cmml" xref="S3.SS1.p1.5.m2.1.1.3"><times id="S3.SS1.p1.5.m2.1.1.3.1.cmml" xref="S3.SS1.p1.5.m2.1.1.3.1"></times><ci id="S3.SS1.p1.5.m2.1.1.3.2.cmml" xref="S3.SS1.p1.5.m2.1.1.3.2">𝛽</ci><ci id="S3.SS1.p1.5.m2.1.1.3.3a.cmml" xref="S3.SS1.p1.5.m2.1.1.3.3"><mtext id="S3.SS1.p1.5.m2.1.1.3.3.cmml" mathsize="70%" xref="S3.SS1.p1.5.m2.1.1.3.3">-</mtext></ci><ci id="S3.SS1.p1.5.m2.1.1.3.4.cmml" xref="S3.SS1.p1.5.m2.1.1.3.4">IPS</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m2.1c">\widehat{V}_{\beta\text{-}{\rm IPS}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m2.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_β - roman_IPS end_POSTSUBSCRIPT</annotation></semantics></math> for a specific <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m3.1"><semantics id="S3.SS1.p1.6.m3.1a"><mi id="S3.SS1.p1.6.m3.1.1" xref="S3.SS1.p1.6.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m3.1b"><ci id="S3.SS1.p1.6.m3.1.1.cmml" xref="S3.SS1.p1.6.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m3.1d">italic_β</annotation></semantics></math> value.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p2.1.1">Self-normalisation through BanditNet and <math alttext="\widehat{V}_{\lambda\text{-}{\rm IPS}}(\pi,\mathcal{D})" class="ltx_Math" display="inline" id="S3.SS1.p2.1.1.m1.2"><semantics id="S3.SS1.p2.1.1.m1.2a"><mrow id="S3.SS1.p2.1.1.m1.2.3" xref="S3.SS1.p2.1.1.m1.2.3.cmml"><msub id="S3.SS1.p2.1.1.m1.2.3.2" xref="S3.SS1.p2.1.1.m1.2.3.2.cmml"><mover accent="true" id="S3.SS1.p2.1.1.m1.2.3.2.2" xref="S3.SS1.p2.1.1.m1.2.3.2.2.cmml"><mi id="S3.SS1.p2.1.1.m1.2.3.2.2.2" xref="S3.SS1.p2.1.1.m1.2.3.2.2.2.cmml">V</mi><mo id="S3.SS1.p2.1.1.m1.2.3.2.2.1" xref="S3.SS1.p2.1.1.m1.2.3.2.2.1.cmml">^</mo></mover><mrow id="S3.SS1.p2.1.1.m1.2.3.2.3" xref="S3.SS1.p2.1.1.m1.2.3.2.3.cmml"><mi id="S3.SS1.p2.1.1.m1.2.3.2.3.2" xref="S3.SS1.p2.1.1.m1.2.3.2.3.2.cmml">λ</mi><mo id="S3.SS1.p2.1.1.m1.2.3.2.3.1" xref="S3.SS1.p2.1.1.m1.2.3.2.3.1.cmml">⁢</mo><mtext class="ltx_mathvariant_bold" id="S3.SS1.p2.1.1.m1.2.3.2.3.3" xref="S3.SS1.p2.1.1.m1.2.3.2.3.3a.cmml">-</mtext><mo id="S3.SS1.p2.1.1.m1.2.3.2.3.1a" xref="S3.SS1.p2.1.1.m1.2.3.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.1.1.m1.2.3.2.3.4" xref="S3.SS1.p2.1.1.m1.2.3.2.3.4.cmml">IPS</mi></mrow></msub><mo id="S3.SS1.p2.1.1.m1.2.3.1" xref="S3.SS1.p2.1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p2.1.1.m1.2.3.3.2" xref="S3.SS1.p2.1.1.m1.2.3.3.1.cmml"><mo id="S3.SS1.p2.1.1.m1.2.3.3.2.1" stretchy="false" xref="S3.SS1.p2.1.1.m1.2.3.3.1.cmml">(</mo><mi id="S3.SS1.p2.1.1.m1.1.1" xref="S3.SS1.p2.1.1.m1.1.1.cmml">π</mi><mo id="S3.SS1.p2.1.1.m1.2.3.3.2.2" xref="S3.SS1.p2.1.1.m1.2.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.1.m1.2.2" xref="S3.SS1.p2.1.1.m1.2.2.cmml">𝒟</mi><mo id="S3.SS1.p2.1.1.m1.2.3.3.2.3" stretchy="false" xref="S3.SS1.p2.1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.1.m1.2b"><apply id="S3.SS1.p2.1.1.m1.2.3.cmml" xref="S3.SS1.p2.1.1.m1.2.3"><times id="S3.SS1.p2.1.1.m1.2.3.1.cmml" xref="S3.SS1.p2.1.1.m1.2.3.1"></times><apply id="S3.SS1.p2.1.1.m1.2.3.2.cmml" xref="S3.SS1.p2.1.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.1.m1.2.3.2.1.cmml" xref="S3.SS1.p2.1.1.m1.2.3.2">subscript</csymbol><apply id="S3.SS1.p2.1.1.m1.2.3.2.2.cmml" xref="S3.SS1.p2.1.1.m1.2.3.2.2"><ci id="S3.SS1.p2.1.1.m1.2.3.2.2.1.cmml" xref="S3.SS1.p2.1.1.m1.2.3.2.2.1">^</ci><ci id="S3.SS1.p2.1.1.m1.2.3.2.2.2.cmml" xref="S3.SS1.p2.1.1.m1.2.3.2.2.2">𝑉</ci></apply><apply id="S3.SS1.p2.1.1.m1.2.3.2.3.cmml" xref="S3.SS1.p2.1.1.m1.2.3.2.3"><times id="S3.SS1.p2.1.1.m1.2.3.2.3.1.cmml" xref="S3.SS1.p2.1.1.m1.2.3.2.3.1"></times><ci id="S3.SS1.p2.1.1.m1.2.3.2.3.2.cmml" xref="S3.SS1.p2.1.1.m1.2.3.2.3.2">𝜆</ci><ci id="S3.SS1.p2.1.1.m1.2.3.2.3.3a.cmml" xref="S3.SS1.p2.1.1.m1.2.3.2.3.3"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p2.1.1.m1.2.3.2.3.3.cmml" mathsize="70%" xref="S3.SS1.p2.1.1.m1.2.3.2.3.3">-</mtext></ci><ci id="S3.SS1.p2.1.1.m1.2.3.2.3.4.cmml" xref="S3.SS1.p2.1.1.m1.2.3.2.3.4">IPS</ci></apply></apply><interval closure="open" id="S3.SS1.p2.1.1.m1.2.3.3.1.cmml" xref="S3.SS1.p2.1.1.m1.2.3.3.2"><ci id="S3.SS1.p2.1.1.m1.1.1.cmml" xref="S3.SS1.p2.1.1.m1.1.1">𝜋</ci><ci id="S3.SS1.p2.1.1.m1.2.2.cmml" xref="S3.SS1.p2.1.1.m1.2.2">𝒟</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.1.m1.2c">\widehat{V}_{\lambda\text{-}{\rm IPS}}(\pi,\mathcal{D})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.1.m1.2d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_λ - roman_IPS end_POSTSUBSCRIPT ( italic_π , caligraphic_D )</annotation></semantics></math>.</span>
If we consider the optimization problem for SNIPS that is solved by BanditNet in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2.E19" title="In 2.2. Off-policy estimation for general bandits ‣ 2. Background and Related Work ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">19</span></a> <cite class="ltx_cite ltx_citemacro_citep">(Joachims et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib34" title="">2018</a>)</cite>, we see that its gradient is given by:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E24">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(24)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla\widehat{V}_{\lambda\text{-}{\rm IPS}}(\pi,\mathcal{B})=\frac{1}{\left|%
\mathcal{B}\right|}\sum_{(x,a,r)\in\mathcal{B}}\frac{\nabla\pi(a|x)}{\pi_{0}(a%
|x)}\left(r-\lambda\right)." class="ltx_Math" display="block" id="S3.E24.m1.9"><semantics id="S3.E24.m1.9a"><mrow id="S3.E24.m1.9.9.1" xref="S3.E24.m1.9.9.1.1.cmml"><mrow id="S3.E24.m1.9.9.1.1" xref="S3.E24.m1.9.9.1.1.cmml"><mrow id="S3.E24.m1.9.9.1.1.3" xref="S3.E24.m1.9.9.1.1.3.cmml"><mrow id="S3.E24.m1.9.9.1.1.3.2" xref="S3.E24.m1.9.9.1.1.3.2.cmml"><mo id="S3.E24.m1.9.9.1.1.3.2.1" rspace="0.167em" xref="S3.E24.m1.9.9.1.1.3.2.1.cmml">∇</mo><msub id="S3.E24.m1.9.9.1.1.3.2.2" xref="S3.E24.m1.9.9.1.1.3.2.2.cmml"><mover accent="true" id="S3.E24.m1.9.9.1.1.3.2.2.2" xref="S3.E24.m1.9.9.1.1.3.2.2.2.cmml"><mi id="S3.E24.m1.9.9.1.1.3.2.2.2.2" xref="S3.E24.m1.9.9.1.1.3.2.2.2.2.cmml">V</mi><mo id="S3.E24.m1.9.9.1.1.3.2.2.2.1" xref="S3.E24.m1.9.9.1.1.3.2.2.2.1.cmml">^</mo></mover><mrow id="S3.E24.m1.9.9.1.1.3.2.2.3" xref="S3.E24.m1.9.9.1.1.3.2.2.3.cmml"><mi id="S3.E24.m1.9.9.1.1.3.2.2.3.2" xref="S3.E24.m1.9.9.1.1.3.2.2.3.2.cmml">λ</mi><mo id="S3.E24.m1.9.9.1.1.3.2.2.3.1" xref="S3.E24.m1.9.9.1.1.3.2.2.3.1.cmml">⁢</mo><mtext id="S3.E24.m1.9.9.1.1.3.2.2.3.3" xref="S3.E24.m1.9.9.1.1.3.2.2.3.3a.cmml">-</mtext><mo id="S3.E24.m1.9.9.1.1.3.2.2.3.1a" xref="S3.E24.m1.9.9.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S3.E24.m1.9.9.1.1.3.2.2.3.4" xref="S3.E24.m1.9.9.1.1.3.2.2.3.4.cmml">IPS</mi></mrow></msub></mrow><mo id="S3.E24.m1.9.9.1.1.3.1" xref="S3.E24.m1.9.9.1.1.3.1.cmml">⁢</mo><mrow id="S3.E24.m1.9.9.1.1.3.3.2" xref="S3.E24.m1.9.9.1.1.3.3.1.cmml"><mo id="S3.E24.m1.9.9.1.1.3.3.2.1" stretchy="false" xref="S3.E24.m1.9.9.1.1.3.3.1.cmml">(</mo><mi id="S3.E24.m1.7.7" xref="S3.E24.m1.7.7.cmml">π</mi><mo id="S3.E24.m1.9.9.1.1.3.3.2.2" xref="S3.E24.m1.9.9.1.1.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E24.m1.8.8" xref="S3.E24.m1.8.8.cmml">ℬ</mi><mo id="S3.E24.m1.9.9.1.1.3.3.2.3" stretchy="false" xref="S3.E24.m1.9.9.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E24.m1.9.9.1.1.2" xref="S3.E24.m1.9.9.1.1.2.cmml">=</mo><mrow id="S3.E24.m1.9.9.1.1.1" xref="S3.E24.m1.9.9.1.1.1.cmml"><mfrac id="S3.E24.m1.1.1" xref="S3.E24.m1.1.1.cmml"><mn id="S3.E24.m1.1.1.3" xref="S3.E24.m1.1.1.3.cmml">1</mn><mrow id="S3.E24.m1.1.1.1.3" xref="S3.E24.m1.1.1.1.2.cmml"><mo id="S3.E24.m1.1.1.1.3.1" xref="S3.E24.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E24.m1.1.1.1.1" xref="S3.E24.m1.1.1.1.1.cmml">ℬ</mi><mo id="S3.E24.m1.1.1.1.3.2" xref="S3.E24.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.E24.m1.9.9.1.1.1.2" xref="S3.E24.m1.9.9.1.1.1.2.cmml">⁢</mo><mrow id="S3.E24.m1.9.9.1.1.1.1" xref="S3.E24.m1.9.9.1.1.1.1.cmml"><munder id="S3.E24.m1.9.9.1.1.1.1.2" xref="S3.E24.m1.9.9.1.1.1.1.2.cmml"><mo id="S3.E24.m1.9.9.1.1.1.1.2.2" movablelimits="false" xref="S3.E24.m1.9.9.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E24.m1.4.4.3" xref="S3.E24.m1.4.4.3.cmml"><mrow id="S3.E24.m1.4.4.3.5.2" xref="S3.E24.m1.4.4.3.5.1.cmml"><mo id="S3.E24.m1.4.4.3.5.2.1" stretchy="false" xref="S3.E24.m1.4.4.3.5.1.cmml">(</mo><mi id="S3.E24.m1.2.2.1.1" xref="S3.E24.m1.2.2.1.1.cmml">x</mi><mo id="S3.E24.m1.4.4.3.5.2.2" xref="S3.E24.m1.4.4.3.5.1.cmml">,</mo><mi id="S3.E24.m1.3.3.2.2" xref="S3.E24.m1.3.3.2.2.cmml">a</mi><mo id="S3.E24.m1.4.4.3.5.2.3" xref="S3.E24.m1.4.4.3.5.1.cmml">,</mo><mi id="S3.E24.m1.4.4.3.3" xref="S3.E24.m1.4.4.3.3.cmml">r</mi><mo id="S3.E24.m1.4.4.3.5.2.4" stretchy="false" xref="S3.E24.m1.4.4.3.5.1.cmml">)</mo></mrow><mo id="S3.E24.m1.4.4.3.4" xref="S3.E24.m1.4.4.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E24.m1.4.4.3.6" xref="S3.E24.m1.4.4.3.6.cmml">ℬ</mi></mrow></munder><mrow id="S3.E24.m1.9.9.1.1.1.1.1" xref="S3.E24.m1.9.9.1.1.1.1.1.cmml"><mfrac id="S3.E24.m1.6.6" xref="S3.E24.m1.6.6.cmml"><mrow id="S3.E24.m1.5.5.1" xref="S3.E24.m1.5.5.1.cmml"><mrow id="S3.E24.m1.5.5.1.3" xref="S3.E24.m1.5.5.1.3.cmml"><mo id="S3.E24.m1.5.5.1.3.1" rspace="0.167em" xref="S3.E24.m1.5.5.1.3.1.cmml">∇</mo><mi id="S3.E24.m1.5.5.1.3.2" xref="S3.E24.m1.5.5.1.3.2.cmml">π</mi></mrow><mo id="S3.E24.m1.5.5.1.2" xref="S3.E24.m1.5.5.1.2.cmml">⁢</mo><mrow id="S3.E24.m1.5.5.1.1.1" xref="S3.E24.m1.5.5.1.1.1.1.cmml"><mo id="S3.E24.m1.5.5.1.1.1.2" stretchy="false" xref="S3.E24.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S3.E24.m1.5.5.1.1.1.1" xref="S3.E24.m1.5.5.1.1.1.1.cmml"><mi id="S3.E24.m1.5.5.1.1.1.1.2" xref="S3.E24.m1.5.5.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E24.m1.5.5.1.1.1.1.1" xref="S3.E24.m1.5.5.1.1.1.1.1.cmml">|</mo><mi id="S3.E24.m1.5.5.1.1.1.1.3" xref="S3.E24.m1.5.5.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E24.m1.5.5.1.1.1.3" stretchy="false" xref="S3.E24.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E24.m1.6.6.2" xref="S3.E24.m1.6.6.2.cmml"><msub id="S3.E24.m1.6.6.2.3" xref="S3.E24.m1.6.6.2.3.cmml"><mi id="S3.E24.m1.6.6.2.3.2" xref="S3.E24.m1.6.6.2.3.2.cmml">π</mi><mn id="S3.E24.m1.6.6.2.3.3" xref="S3.E24.m1.6.6.2.3.3.cmml">0</mn></msub><mo id="S3.E24.m1.6.6.2.2" xref="S3.E24.m1.6.6.2.2.cmml">⁢</mo><mrow id="S3.E24.m1.6.6.2.1.1" xref="S3.E24.m1.6.6.2.1.1.1.cmml"><mo id="S3.E24.m1.6.6.2.1.1.2" stretchy="false" xref="S3.E24.m1.6.6.2.1.1.1.cmml">(</mo><mrow id="S3.E24.m1.6.6.2.1.1.1" xref="S3.E24.m1.6.6.2.1.1.1.cmml"><mi id="S3.E24.m1.6.6.2.1.1.1.2" xref="S3.E24.m1.6.6.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E24.m1.6.6.2.1.1.1.1" xref="S3.E24.m1.6.6.2.1.1.1.1.cmml">|</mo><mi id="S3.E24.m1.6.6.2.1.1.1.3" xref="S3.E24.m1.6.6.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E24.m1.6.6.2.1.1.3" stretchy="false" xref="S3.E24.m1.6.6.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E24.m1.9.9.1.1.1.1.1.2" xref="S3.E24.m1.9.9.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E24.m1.9.9.1.1.1.1.1.1.1" xref="S3.E24.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E24.m1.9.9.1.1.1.1.1.1.1.2" xref="S3.E24.m1.9.9.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E24.m1.9.9.1.1.1.1.1.1.1.1" xref="S3.E24.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E24.m1.9.9.1.1.1.1.1.1.1.1.2" xref="S3.E24.m1.9.9.1.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="S3.E24.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S3.E24.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E24.m1.9.9.1.1.1.1.1.1.1.1.3" xref="S3.E24.m1.9.9.1.1.1.1.1.1.1.1.3.cmml">λ</mi></mrow><mo id="S3.E24.m1.9.9.1.1.1.1.1.1.1.3" xref="S3.E24.m1.9.9.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E24.m1.9.9.1.2" lspace="0em" xref="S3.E24.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E24.m1.9b"><apply id="S3.E24.m1.9.9.1.1.cmml" xref="S3.E24.m1.9.9.1"><eq id="S3.E24.m1.9.9.1.1.2.cmml" xref="S3.E24.m1.9.9.1.1.2"></eq><apply id="S3.E24.m1.9.9.1.1.3.cmml" xref="S3.E24.m1.9.9.1.1.3"><times id="S3.E24.m1.9.9.1.1.3.1.cmml" xref="S3.E24.m1.9.9.1.1.3.1"></times><apply id="S3.E24.m1.9.9.1.1.3.2.cmml" xref="S3.E24.m1.9.9.1.1.3.2"><ci id="S3.E24.m1.9.9.1.1.3.2.1.cmml" xref="S3.E24.m1.9.9.1.1.3.2.1">∇</ci><apply id="S3.E24.m1.9.9.1.1.3.2.2.cmml" xref="S3.E24.m1.9.9.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E24.m1.9.9.1.1.3.2.2.1.cmml" xref="S3.E24.m1.9.9.1.1.3.2.2">subscript</csymbol><apply id="S3.E24.m1.9.9.1.1.3.2.2.2.cmml" xref="S3.E24.m1.9.9.1.1.3.2.2.2"><ci id="S3.E24.m1.9.9.1.1.3.2.2.2.1.cmml" xref="S3.E24.m1.9.9.1.1.3.2.2.2.1">^</ci><ci id="S3.E24.m1.9.9.1.1.3.2.2.2.2.cmml" xref="S3.E24.m1.9.9.1.1.3.2.2.2.2">𝑉</ci></apply><apply id="S3.E24.m1.9.9.1.1.3.2.2.3.cmml" xref="S3.E24.m1.9.9.1.1.3.2.2.3"><times id="S3.E24.m1.9.9.1.1.3.2.2.3.1.cmml" xref="S3.E24.m1.9.9.1.1.3.2.2.3.1"></times><ci id="S3.E24.m1.9.9.1.1.3.2.2.3.2.cmml" xref="S3.E24.m1.9.9.1.1.3.2.2.3.2">𝜆</ci><ci id="S3.E24.m1.9.9.1.1.3.2.2.3.3a.cmml" xref="S3.E24.m1.9.9.1.1.3.2.2.3.3"><mtext id="S3.E24.m1.9.9.1.1.3.2.2.3.3.cmml" mathsize="70%" xref="S3.E24.m1.9.9.1.1.3.2.2.3.3">-</mtext></ci><ci id="S3.E24.m1.9.9.1.1.3.2.2.3.4.cmml" xref="S3.E24.m1.9.9.1.1.3.2.2.3.4">IPS</ci></apply></apply></apply><interval closure="open" id="S3.E24.m1.9.9.1.1.3.3.1.cmml" xref="S3.E24.m1.9.9.1.1.3.3.2"><ci id="S3.E24.m1.7.7.cmml" xref="S3.E24.m1.7.7">𝜋</ci><ci id="S3.E24.m1.8.8.cmml" xref="S3.E24.m1.8.8">ℬ</ci></interval></apply><apply id="S3.E24.m1.9.9.1.1.1.cmml" xref="S3.E24.m1.9.9.1.1.1"><times id="S3.E24.m1.9.9.1.1.1.2.cmml" xref="S3.E24.m1.9.9.1.1.1.2"></times><apply id="S3.E24.m1.1.1.cmml" xref="S3.E24.m1.1.1"><divide id="S3.E24.m1.1.1.2.cmml" xref="S3.E24.m1.1.1"></divide><cn id="S3.E24.m1.1.1.3.cmml" type="integer" xref="S3.E24.m1.1.1.3">1</cn><apply id="S3.E24.m1.1.1.1.2.cmml" xref="S3.E24.m1.1.1.1.3"><abs id="S3.E24.m1.1.1.1.2.1.cmml" xref="S3.E24.m1.1.1.1.3.1"></abs><ci id="S3.E24.m1.1.1.1.1.cmml" xref="S3.E24.m1.1.1.1.1">ℬ</ci></apply></apply><apply id="S3.E24.m1.9.9.1.1.1.1.cmml" xref="S3.E24.m1.9.9.1.1.1.1"><apply id="S3.E24.m1.9.9.1.1.1.1.2.cmml" xref="S3.E24.m1.9.9.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E24.m1.9.9.1.1.1.1.2.1.cmml" xref="S3.E24.m1.9.9.1.1.1.1.2">subscript</csymbol><sum id="S3.E24.m1.9.9.1.1.1.1.2.2.cmml" xref="S3.E24.m1.9.9.1.1.1.1.2.2"></sum><apply id="S3.E24.m1.4.4.3.cmml" xref="S3.E24.m1.4.4.3"><in id="S3.E24.m1.4.4.3.4.cmml" xref="S3.E24.m1.4.4.3.4"></in><vector id="S3.E24.m1.4.4.3.5.1.cmml" xref="S3.E24.m1.4.4.3.5.2"><ci id="S3.E24.m1.2.2.1.1.cmml" xref="S3.E24.m1.2.2.1.1">𝑥</ci><ci id="S3.E24.m1.3.3.2.2.cmml" xref="S3.E24.m1.3.3.2.2">𝑎</ci><ci id="S3.E24.m1.4.4.3.3.cmml" xref="S3.E24.m1.4.4.3.3">𝑟</ci></vector><ci id="S3.E24.m1.4.4.3.6.cmml" xref="S3.E24.m1.4.4.3.6">ℬ</ci></apply></apply><apply id="S3.E24.m1.9.9.1.1.1.1.1.cmml" xref="S3.E24.m1.9.9.1.1.1.1.1"><times id="S3.E24.m1.9.9.1.1.1.1.1.2.cmml" xref="S3.E24.m1.9.9.1.1.1.1.1.2"></times><apply id="S3.E24.m1.6.6.cmml" xref="S3.E24.m1.6.6"><divide id="S3.E24.m1.6.6.3.cmml" xref="S3.E24.m1.6.6"></divide><apply id="S3.E24.m1.5.5.1.cmml" xref="S3.E24.m1.5.5.1"><times id="S3.E24.m1.5.5.1.2.cmml" xref="S3.E24.m1.5.5.1.2"></times><apply id="S3.E24.m1.5.5.1.3.cmml" xref="S3.E24.m1.5.5.1.3"><ci id="S3.E24.m1.5.5.1.3.1.cmml" xref="S3.E24.m1.5.5.1.3.1">∇</ci><ci id="S3.E24.m1.5.5.1.3.2.cmml" xref="S3.E24.m1.5.5.1.3.2">𝜋</ci></apply><apply id="S3.E24.m1.5.5.1.1.1.1.cmml" xref="S3.E24.m1.5.5.1.1.1"><csymbol cd="latexml" id="S3.E24.m1.5.5.1.1.1.1.1.cmml" xref="S3.E24.m1.5.5.1.1.1.1.1">conditional</csymbol><ci id="S3.E24.m1.5.5.1.1.1.1.2.cmml" xref="S3.E24.m1.5.5.1.1.1.1.2">𝑎</ci><ci id="S3.E24.m1.5.5.1.1.1.1.3.cmml" xref="S3.E24.m1.5.5.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.E24.m1.6.6.2.cmml" xref="S3.E24.m1.6.6.2"><times id="S3.E24.m1.6.6.2.2.cmml" xref="S3.E24.m1.6.6.2.2"></times><apply id="S3.E24.m1.6.6.2.3.cmml" xref="S3.E24.m1.6.6.2.3"><csymbol cd="ambiguous" id="S3.E24.m1.6.6.2.3.1.cmml" xref="S3.E24.m1.6.6.2.3">subscript</csymbol><ci id="S3.E24.m1.6.6.2.3.2.cmml" xref="S3.E24.m1.6.6.2.3.2">𝜋</ci><cn id="S3.E24.m1.6.6.2.3.3.cmml" type="integer" xref="S3.E24.m1.6.6.2.3.3">0</cn></apply><apply id="S3.E24.m1.6.6.2.1.1.1.cmml" xref="S3.E24.m1.6.6.2.1.1"><csymbol cd="latexml" id="S3.E24.m1.6.6.2.1.1.1.1.cmml" xref="S3.E24.m1.6.6.2.1.1.1.1">conditional</csymbol><ci id="S3.E24.m1.6.6.2.1.1.1.2.cmml" xref="S3.E24.m1.6.6.2.1.1.1.2">𝑎</ci><ci id="S3.E24.m1.6.6.2.1.1.1.3.cmml" xref="S3.E24.m1.6.6.2.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="S3.E24.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S3.E24.m1.9.9.1.1.1.1.1.1.1"><minus id="S3.E24.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E24.m1.9.9.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.E24.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E24.m1.9.9.1.1.1.1.1.1.1.1.2">𝑟</ci><ci id="S3.E24.m1.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E24.m1.9.9.1.1.1.1.1.1.1.1.3">𝜆</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E24.m1.9c">\nabla\widehat{V}_{\lambda\text{-}{\rm IPS}}(\pi,\mathcal{B})=\frac{1}{\left|%
\mathcal{B}\right|}\sum_{(x,a,r)\in\mathcal{B}}\frac{\nabla\pi(a|x)}{\pi_{0}(a%
|x)}\left(r-\lambda\right).</annotation><annotation encoding="application/x-llamapun" id="S3.E24.m1.9d">∇ over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_λ - roman_IPS end_POSTSUBSCRIPT ( italic_π , caligraphic_B ) = divide start_ARG 1 end_ARG start_ARG | caligraphic_B | end_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) ∈ caligraphic_B end_POSTSUBSCRIPT divide start_ARG ∇ italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ( italic_r - italic_λ ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.3"><span class="ltx_text ltx_font_bold" id="S3.SS1.p3.1.1">Doubly robust estimation via <math alttext="\widehat{V}_{\rm DR}(\pi,\mathcal{D})" class="ltx_Math" display="inline" id="S3.SS1.p3.1.1.m1.2"><semantics id="S3.SS1.p3.1.1.m1.2a"><mrow id="S3.SS1.p3.1.1.m1.2.3" xref="S3.SS1.p3.1.1.m1.2.3.cmml"><msub id="S3.SS1.p3.1.1.m1.2.3.2" xref="S3.SS1.p3.1.1.m1.2.3.2.cmml"><mover accent="true" id="S3.SS1.p3.1.1.m1.2.3.2.2" xref="S3.SS1.p3.1.1.m1.2.3.2.2.cmml"><mi id="S3.SS1.p3.1.1.m1.2.3.2.2.2" xref="S3.SS1.p3.1.1.m1.2.3.2.2.2.cmml">V</mi><mo id="S3.SS1.p3.1.1.m1.2.3.2.2.1" xref="S3.SS1.p3.1.1.m1.2.3.2.2.1.cmml">^</mo></mover><mi id="S3.SS1.p3.1.1.m1.2.3.2.3" xref="S3.SS1.p3.1.1.m1.2.3.2.3.cmml">DR</mi></msub><mo id="S3.SS1.p3.1.1.m1.2.3.1" xref="S3.SS1.p3.1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p3.1.1.m1.2.3.3.2" xref="S3.SS1.p3.1.1.m1.2.3.3.1.cmml"><mo id="S3.SS1.p3.1.1.m1.2.3.3.2.1" stretchy="false" xref="S3.SS1.p3.1.1.m1.2.3.3.1.cmml">(</mo><mi id="S3.SS1.p3.1.1.m1.1.1" xref="S3.SS1.p3.1.1.m1.1.1.cmml">π</mi><mo id="S3.SS1.p3.1.1.m1.2.3.3.2.2" xref="S3.SS1.p3.1.1.m1.2.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.1.1.m1.2.2" xref="S3.SS1.p3.1.1.m1.2.2.cmml">𝒟</mi><mo id="S3.SS1.p3.1.1.m1.2.3.3.2.3" stretchy="false" xref="S3.SS1.p3.1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.1.m1.2b"><apply id="S3.SS1.p3.1.1.m1.2.3.cmml" xref="S3.SS1.p3.1.1.m1.2.3"><times id="S3.SS1.p3.1.1.m1.2.3.1.cmml" xref="S3.SS1.p3.1.1.m1.2.3.1"></times><apply id="S3.SS1.p3.1.1.m1.2.3.2.cmml" xref="S3.SS1.p3.1.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p3.1.1.m1.2.3.2.1.cmml" xref="S3.SS1.p3.1.1.m1.2.3.2">subscript</csymbol><apply id="S3.SS1.p3.1.1.m1.2.3.2.2.cmml" xref="S3.SS1.p3.1.1.m1.2.3.2.2"><ci id="S3.SS1.p3.1.1.m1.2.3.2.2.1.cmml" xref="S3.SS1.p3.1.1.m1.2.3.2.2.1">^</ci><ci id="S3.SS1.p3.1.1.m1.2.3.2.2.2.cmml" xref="S3.SS1.p3.1.1.m1.2.3.2.2.2">𝑉</ci></apply><ci id="S3.SS1.p3.1.1.m1.2.3.2.3.cmml" xref="S3.SS1.p3.1.1.m1.2.3.2.3">DR</ci></apply><interval closure="open" id="S3.SS1.p3.1.1.m1.2.3.3.1.cmml" xref="S3.SS1.p3.1.1.m1.2.3.3.2"><ci id="S3.SS1.p3.1.1.m1.1.1.cmml" xref="S3.SS1.p3.1.1.m1.1.1">𝜋</ci><ci id="S3.SS1.p3.1.1.m1.2.2.cmml" xref="S3.SS1.p3.1.1.m1.2.2">𝒟</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.1.m1.2c">\widehat{V}_{\rm DR}(\pi,\mathcal{D})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.1.m1.2d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_DR end_POSTSUBSCRIPT ( italic_π , caligraphic_D )</annotation></semantics></math></span>.
As mentioned, a nuisance of doubly robust estimators is the requirement of fitting a regression model <math alttext="\widehat{r}(a,x)" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m1.2"><semantics id="S3.SS1.p3.2.m1.2a"><mrow id="S3.SS1.p3.2.m1.2.3" xref="S3.SS1.p3.2.m1.2.3.cmml"><mover accent="true" id="S3.SS1.p3.2.m1.2.3.2" xref="S3.SS1.p3.2.m1.2.3.2.cmml"><mi id="S3.SS1.p3.2.m1.2.3.2.2" xref="S3.SS1.p3.2.m1.2.3.2.2.cmml">r</mi><mo id="S3.SS1.p3.2.m1.2.3.2.1" xref="S3.SS1.p3.2.m1.2.3.2.1.cmml">^</mo></mover><mo id="S3.SS1.p3.2.m1.2.3.1" xref="S3.SS1.p3.2.m1.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p3.2.m1.2.3.3.2" xref="S3.SS1.p3.2.m1.2.3.3.1.cmml"><mo id="S3.SS1.p3.2.m1.2.3.3.2.1" stretchy="false" xref="S3.SS1.p3.2.m1.2.3.3.1.cmml">(</mo><mi id="S3.SS1.p3.2.m1.1.1" xref="S3.SS1.p3.2.m1.1.1.cmml">a</mi><mo id="S3.SS1.p3.2.m1.2.3.3.2.2" xref="S3.SS1.p3.2.m1.2.3.3.1.cmml">,</mo><mi id="S3.SS1.p3.2.m1.2.2" xref="S3.SS1.p3.2.m1.2.2.cmml">x</mi><mo id="S3.SS1.p3.2.m1.2.3.3.2.3" stretchy="false" xref="S3.SS1.p3.2.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m1.2b"><apply id="S3.SS1.p3.2.m1.2.3.cmml" xref="S3.SS1.p3.2.m1.2.3"><times id="S3.SS1.p3.2.m1.2.3.1.cmml" xref="S3.SS1.p3.2.m1.2.3.1"></times><apply id="S3.SS1.p3.2.m1.2.3.2.cmml" xref="S3.SS1.p3.2.m1.2.3.2"><ci id="S3.SS1.p3.2.m1.2.3.2.1.cmml" xref="S3.SS1.p3.2.m1.2.3.2.1">^</ci><ci id="S3.SS1.p3.2.m1.2.3.2.2.cmml" xref="S3.SS1.p3.2.m1.2.3.2.2">𝑟</ci></apply><interval closure="open" id="S3.SS1.p3.2.m1.2.3.3.1.cmml" xref="S3.SS1.p3.2.m1.2.3.3.2"><ci id="S3.SS1.p3.2.m1.1.1.cmml" xref="S3.SS1.p3.2.m1.1.1">𝑎</ci><ci id="S3.SS1.p3.2.m1.2.2.cmml" xref="S3.SS1.p3.2.m1.2.2">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m1.2c">\widehat{r}(a,x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m1.2d">over^ start_ARG italic_r end_ARG ( italic_a , italic_x )</annotation></semantics></math>.
Suppose that we instead treat <math alttext="\widehat{r}" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m2.1"><semantics id="S3.SS1.p3.3.m2.1a"><mover accent="true" id="S3.SS1.p3.3.m2.1.1" xref="S3.SS1.p3.3.m2.1.1.cmml"><mi id="S3.SS1.p3.3.m2.1.1.2" xref="S3.SS1.p3.3.m2.1.1.2.cmml">r</mi><mo id="S3.SS1.p3.3.m2.1.1.1" xref="S3.SS1.p3.3.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m2.1b"><apply id="S3.SS1.p3.3.m2.1.1.cmml" xref="S3.SS1.p3.3.m2.1.1"><ci id="S3.SS1.p3.3.m2.1.1.1.cmml" xref="S3.SS1.p3.3.m2.1.1.1">^</ci><ci id="S3.SS1.p3.3.m2.1.1.2.cmml" xref="S3.SS1.p3.3.m2.1.1.2">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m2.1c">\widehat{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m2.1d">over^ start_ARG italic_r end_ARG</annotation></semantics></math> as a single scalar hyper-parameter, akin to the BanditNet approach.
Then, the gradient of such an estimator would be given by:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E25">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(25)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla\widehat{V}_{\widehat{r}\text{-}{\rm DR}}(\pi,\mathcal{B})=\frac{1}{%
\left|\mathcal{B}\right|}\sum_{(x,a,r)\in\mathcal{B}}\frac{\nabla\pi(a|x)}{\pi%
_{0}(a|x)}\left(r-\widehat{r}\right)." class="ltx_Math" display="block" id="S3.E25.m1.9"><semantics id="S3.E25.m1.9a"><mrow id="S3.E25.m1.9.9.1" xref="S3.E25.m1.9.9.1.1.cmml"><mrow id="S3.E25.m1.9.9.1.1" xref="S3.E25.m1.9.9.1.1.cmml"><mrow id="S3.E25.m1.9.9.1.1.3" xref="S3.E25.m1.9.9.1.1.3.cmml"><mrow id="S3.E25.m1.9.9.1.1.3.2" xref="S3.E25.m1.9.9.1.1.3.2.cmml"><mo id="S3.E25.m1.9.9.1.1.3.2.1" rspace="0.167em" xref="S3.E25.m1.9.9.1.1.3.2.1.cmml">∇</mo><msub id="S3.E25.m1.9.9.1.1.3.2.2" xref="S3.E25.m1.9.9.1.1.3.2.2.cmml"><mover accent="true" id="S3.E25.m1.9.9.1.1.3.2.2.2" xref="S3.E25.m1.9.9.1.1.3.2.2.2.cmml"><mi id="S3.E25.m1.9.9.1.1.3.2.2.2.2" xref="S3.E25.m1.9.9.1.1.3.2.2.2.2.cmml">V</mi><mo id="S3.E25.m1.9.9.1.1.3.2.2.2.1" xref="S3.E25.m1.9.9.1.1.3.2.2.2.1.cmml">^</mo></mover><mrow id="S3.E25.m1.9.9.1.1.3.2.2.3" xref="S3.E25.m1.9.9.1.1.3.2.2.3.cmml"><mover accent="true" id="S3.E25.m1.9.9.1.1.3.2.2.3.2" xref="S3.E25.m1.9.9.1.1.3.2.2.3.2.cmml"><mi id="S3.E25.m1.9.9.1.1.3.2.2.3.2.2" xref="S3.E25.m1.9.9.1.1.3.2.2.3.2.2.cmml">r</mi><mo id="S3.E25.m1.9.9.1.1.3.2.2.3.2.1" xref="S3.E25.m1.9.9.1.1.3.2.2.3.2.1.cmml">^</mo></mover><mo id="S3.E25.m1.9.9.1.1.3.2.2.3.1" xref="S3.E25.m1.9.9.1.1.3.2.2.3.1.cmml">⁢</mo><mtext id="S3.E25.m1.9.9.1.1.3.2.2.3.3" xref="S3.E25.m1.9.9.1.1.3.2.2.3.3a.cmml">-</mtext><mo id="S3.E25.m1.9.9.1.1.3.2.2.3.1a" xref="S3.E25.m1.9.9.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S3.E25.m1.9.9.1.1.3.2.2.3.4" xref="S3.E25.m1.9.9.1.1.3.2.2.3.4.cmml">DR</mi></mrow></msub></mrow><mo id="S3.E25.m1.9.9.1.1.3.1" xref="S3.E25.m1.9.9.1.1.3.1.cmml">⁢</mo><mrow id="S3.E25.m1.9.9.1.1.3.3.2" xref="S3.E25.m1.9.9.1.1.3.3.1.cmml"><mo id="S3.E25.m1.9.9.1.1.3.3.2.1" stretchy="false" xref="S3.E25.m1.9.9.1.1.3.3.1.cmml">(</mo><mi id="S3.E25.m1.7.7" xref="S3.E25.m1.7.7.cmml">π</mi><mo id="S3.E25.m1.9.9.1.1.3.3.2.2" xref="S3.E25.m1.9.9.1.1.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E25.m1.8.8" xref="S3.E25.m1.8.8.cmml">ℬ</mi><mo id="S3.E25.m1.9.9.1.1.3.3.2.3" stretchy="false" xref="S3.E25.m1.9.9.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E25.m1.9.9.1.1.2" xref="S3.E25.m1.9.9.1.1.2.cmml">=</mo><mrow id="S3.E25.m1.9.9.1.1.1" xref="S3.E25.m1.9.9.1.1.1.cmml"><mfrac id="S3.E25.m1.1.1" xref="S3.E25.m1.1.1.cmml"><mn id="S3.E25.m1.1.1.3" xref="S3.E25.m1.1.1.3.cmml">1</mn><mrow id="S3.E25.m1.1.1.1.3" xref="S3.E25.m1.1.1.1.2.cmml"><mo id="S3.E25.m1.1.1.1.3.1" xref="S3.E25.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E25.m1.1.1.1.1" xref="S3.E25.m1.1.1.1.1.cmml">ℬ</mi><mo id="S3.E25.m1.1.1.1.3.2" xref="S3.E25.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.E25.m1.9.9.1.1.1.2" xref="S3.E25.m1.9.9.1.1.1.2.cmml">⁢</mo><mrow id="S3.E25.m1.9.9.1.1.1.1" xref="S3.E25.m1.9.9.1.1.1.1.cmml"><munder id="S3.E25.m1.9.9.1.1.1.1.2" xref="S3.E25.m1.9.9.1.1.1.1.2.cmml"><mo id="S3.E25.m1.9.9.1.1.1.1.2.2" movablelimits="false" xref="S3.E25.m1.9.9.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E25.m1.4.4.3" xref="S3.E25.m1.4.4.3.cmml"><mrow id="S3.E25.m1.4.4.3.5.2" xref="S3.E25.m1.4.4.3.5.1.cmml"><mo id="S3.E25.m1.4.4.3.5.2.1" stretchy="false" xref="S3.E25.m1.4.4.3.5.1.cmml">(</mo><mi id="S3.E25.m1.2.2.1.1" xref="S3.E25.m1.2.2.1.1.cmml">x</mi><mo id="S3.E25.m1.4.4.3.5.2.2" xref="S3.E25.m1.4.4.3.5.1.cmml">,</mo><mi id="S3.E25.m1.3.3.2.2" xref="S3.E25.m1.3.3.2.2.cmml">a</mi><mo id="S3.E25.m1.4.4.3.5.2.3" xref="S3.E25.m1.4.4.3.5.1.cmml">,</mo><mi id="S3.E25.m1.4.4.3.3" xref="S3.E25.m1.4.4.3.3.cmml">r</mi><mo id="S3.E25.m1.4.4.3.5.2.4" stretchy="false" xref="S3.E25.m1.4.4.3.5.1.cmml">)</mo></mrow><mo id="S3.E25.m1.4.4.3.4" xref="S3.E25.m1.4.4.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E25.m1.4.4.3.6" xref="S3.E25.m1.4.4.3.6.cmml">ℬ</mi></mrow></munder><mrow id="S3.E25.m1.9.9.1.1.1.1.1" xref="S3.E25.m1.9.9.1.1.1.1.1.cmml"><mfrac id="S3.E25.m1.6.6" xref="S3.E25.m1.6.6.cmml"><mrow id="S3.E25.m1.5.5.1" xref="S3.E25.m1.5.5.1.cmml"><mrow id="S3.E25.m1.5.5.1.3" xref="S3.E25.m1.5.5.1.3.cmml"><mo id="S3.E25.m1.5.5.1.3.1" rspace="0.167em" xref="S3.E25.m1.5.5.1.3.1.cmml">∇</mo><mi id="S3.E25.m1.5.5.1.3.2" xref="S3.E25.m1.5.5.1.3.2.cmml">π</mi></mrow><mo id="S3.E25.m1.5.5.1.2" xref="S3.E25.m1.5.5.1.2.cmml">⁢</mo><mrow id="S3.E25.m1.5.5.1.1.1" xref="S3.E25.m1.5.5.1.1.1.1.cmml"><mo id="S3.E25.m1.5.5.1.1.1.2" stretchy="false" xref="S3.E25.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S3.E25.m1.5.5.1.1.1.1" xref="S3.E25.m1.5.5.1.1.1.1.cmml"><mi id="S3.E25.m1.5.5.1.1.1.1.2" xref="S3.E25.m1.5.5.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E25.m1.5.5.1.1.1.1.1" xref="S3.E25.m1.5.5.1.1.1.1.1.cmml">|</mo><mi id="S3.E25.m1.5.5.1.1.1.1.3" xref="S3.E25.m1.5.5.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E25.m1.5.5.1.1.1.3" stretchy="false" xref="S3.E25.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E25.m1.6.6.2" xref="S3.E25.m1.6.6.2.cmml"><msub id="S3.E25.m1.6.6.2.3" xref="S3.E25.m1.6.6.2.3.cmml"><mi id="S3.E25.m1.6.6.2.3.2" xref="S3.E25.m1.6.6.2.3.2.cmml">π</mi><mn id="S3.E25.m1.6.6.2.3.3" xref="S3.E25.m1.6.6.2.3.3.cmml">0</mn></msub><mo id="S3.E25.m1.6.6.2.2" xref="S3.E25.m1.6.6.2.2.cmml">⁢</mo><mrow id="S3.E25.m1.6.6.2.1.1" xref="S3.E25.m1.6.6.2.1.1.1.cmml"><mo id="S3.E25.m1.6.6.2.1.1.2" stretchy="false" xref="S3.E25.m1.6.6.2.1.1.1.cmml">(</mo><mrow id="S3.E25.m1.6.6.2.1.1.1" xref="S3.E25.m1.6.6.2.1.1.1.cmml"><mi id="S3.E25.m1.6.6.2.1.1.1.2" xref="S3.E25.m1.6.6.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E25.m1.6.6.2.1.1.1.1" xref="S3.E25.m1.6.6.2.1.1.1.1.cmml">|</mo><mi id="S3.E25.m1.6.6.2.1.1.1.3" xref="S3.E25.m1.6.6.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E25.m1.6.6.2.1.1.3" stretchy="false" xref="S3.E25.m1.6.6.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E25.m1.9.9.1.1.1.1.1.2" xref="S3.E25.m1.9.9.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E25.m1.9.9.1.1.1.1.1.1.1" xref="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E25.m1.9.9.1.1.1.1.1.1.1.2" xref="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E25.m1.9.9.1.1.1.1.1.1.1.1" xref="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.2" xref="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.3" xref="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.3.2" xref="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mo id="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.3.1" xref="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.3.1.cmml">^</mo></mover></mrow><mo id="S3.E25.m1.9.9.1.1.1.1.1.1.1.3" xref="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E25.m1.9.9.1.2" lspace="0em" xref="S3.E25.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E25.m1.9b"><apply id="S3.E25.m1.9.9.1.1.cmml" xref="S3.E25.m1.9.9.1"><eq id="S3.E25.m1.9.9.1.1.2.cmml" xref="S3.E25.m1.9.9.1.1.2"></eq><apply id="S3.E25.m1.9.9.1.1.3.cmml" xref="S3.E25.m1.9.9.1.1.3"><times id="S3.E25.m1.9.9.1.1.3.1.cmml" xref="S3.E25.m1.9.9.1.1.3.1"></times><apply id="S3.E25.m1.9.9.1.1.3.2.cmml" xref="S3.E25.m1.9.9.1.1.3.2"><ci id="S3.E25.m1.9.9.1.1.3.2.1.cmml" xref="S3.E25.m1.9.9.1.1.3.2.1">∇</ci><apply id="S3.E25.m1.9.9.1.1.3.2.2.cmml" xref="S3.E25.m1.9.9.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E25.m1.9.9.1.1.3.2.2.1.cmml" xref="S3.E25.m1.9.9.1.1.3.2.2">subscript</csymbol><apply id="S3.E25.m1.9.9.1.1.3.2.2.2.cmml" xref="S3.E25.m1.9.9.1.1.3.2.2.2"><ci id="S3.E25.m1.9.9.1.1.3.2.2.2.1.cmml" xref="S3.E25.m1.9.9.1.1.3.2.2.2.1">^</ci><ci id="S3.E25.m1.9.9.1.1.3.2.2.2.2.cmml" xref="S3.E25.m1.9.9.1.1.3.2.2.2.2">𝑉</ci></apply><apply id="S3.E25.m1.9.9.1.1.3.2.2.3.cmml" xref="S3.E25.m1.9.9.1.1.3.2.2.3"><times id="S3.E25.m1.9.9.1.1.3.2.2.3.1.cmml" xref="S3.E25.m1.9.9.1.1.3.2.2.3.1"></times><apply id="S3.E25.m1.9.9.1.1.3.2.2.3.2.cmml" xref="S3.E25.m1.9.9.1.1.3.2.2.3.2"><ci id="S3.E25.m1.9.9.1.1.3.2.2.3.2.1.cmml" xref="S3.E25.m1.9.9.1.1.3.2.2.3.2.1">^</ci><ci id="S3.E25.m1.9.9.1.1.3.2.2.3.2.2.cmml" xref="S3.E25.m1.9.9.1.1.3.2.2.3.2.2">𝑟</ci></apply><ci id="S3.E25.m1.9.9.1.1.3.2.2.3.3a.cmml" xref="S3.E25.m1.9.9.1.1.3.2.2.3.3"><mtext id="S3.E25.m1.9.9.1.1.3.2.2.3.3.cmml" mathsize="70%" xref="S3.E25.m1.9.9.1.1.3.2.2.3.3">-</mtext></ci><ci id="S3.E25.m1.9.9.1.1.3.2.2.3.4.cmml" xref="S3.E25.m1.9.9.1.1.3.2.2.3.4">DR</ci></apply></apply></apply><interval closure="open" id="S3.E25.m1.9.9.1.1.3.3.1.cmml" xref="S3.E25.m1.9.9.1.1.3.3.2"><ci id="S3.E25.m1.7.7.cmml" xref="S3.E25.m1.7.7">𝜋</ci><ci id="S3.E25.m1.8.8.cmml" xref="S3.E25.m1.8.8">ℬ</ci></interval></apply><apply id="S3.E25.m1.9.9.1.1.1.cmml" xref="S3.E25.m1.9.9.1.1.1"><times id="S3.E25.m1.9.9.1.1.1.2.cmml" xref="S3.E25.m1.9.9.1.1.1.2"></times><apply id="S3.E25.m1.1.1.cmml" xref="S3.E25.m1.1.1"><divide id="S3.E25.m1.1.1.2.cmml" xref="S3.E25.m1.1.1"></divide><cn id="S3.E25.m1.1.1.3.cmml" type="integer" xref="S3.E25.m1.1.1.3">1</cn><apply id="S3.E25.m1.1.1.1.2.cmml" xref="S3.E25.m1.1.1.1.3"><abs id="S3.E25.m1.1.1.1.2.1.cmml" xref="S3.E25.m1.1.1.1.3.1"></abs><ci id="S3.E25.m1.1.1.1.1.cmml" xref="S3.E25.m1.1.1.1.1">ℬ</ci></apply></apply><apply id="S3.E25.m1.9.9.1.1.1.1.cmml" xref="S3.E25.m1.9.9.1.1.1.1"><apply id="S3.E25.m1.9.9.1.1.1.1.2.cmml" xref="S3.E25.m1.9.9.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E25.m1.9.9.1.1.1.1.2.1.cmml" xref="S3.E25.m1.9.9.1.1.1.1.2">subscript</csymbol><sum id="S3.E25.m1.9.9.1.1.1.1.2.2.cmml" xref="S3.E25.m1.9.9.1.1.1.1.2.2"></sum><apply id="S3.E25.m1.4.4.3.cmml" xref="S3.E25.m1.4.4.3"><in id="S3.E25.m1.4.4.3.4.cmml" xref="S3.E25.m1.4.4.3.4"></in><vector id="S3.E25.m1.4.4.3.5.1.cmml" xref="S3.E25.m1.4.4.3.5.2"><ci id="S3.E25.m1.2.2.1.1.cmml" xref="S3.E25.m1.2.2.1.1">𝑥</ci><ci id="S3.E25.m1.3.3.2.2.cmml" xref="S3.E25.m1.3.3.2.2">𝑎</ci><ci id="S3.E25.m1.4.4.3.3.cmml" xref="S3.E25.m1.4.4.3.3">𝑟</ci></vector><ci id="S3.E25.m1.4.4.3.6.cmml" xref="S3.E25.m1.4.4.3.6">ℬ</ci></apply></apply><apply id="S3.E25.m1.9.9.1.1.1.1.1.cmml" xref="S3.E25.m1.9.9.1.1.1.1.1"><times id="S3.E25.m1.9.9.1.1.1.1.1.2.cmml" xref="S3.E25.m1.9.9.1.1.1.1.1.2"></times><apply id="S3.E25.m1.6.6.cmml" xref="S3.E25.m1.6.6"><divide id="S3.E25.m1.6.6.3.cmml" xref="S3.E25.m1.6.6"></divide><apply id="S3.E25.m1.5.5.1.cmml" xref="S3.E25.m1.5.5.1"><times id="S3.E25.m1.5.5.1.2.cmml" xref="S3.E25.m1.5.5.1.2"></times><apply id="S3.E25.m1.5.5.1.3.cmml" xref="S3.E25.m1.5.5.1.3"><ci id="S3.E25.m1.5.5.1.3.1.cmml" xref="S3.E25.m1.5.5.1.3.1">∇</ci><ci id="S3.E25.m1.5.5.1.3.2.cmml" xref="S3.E25.m1.5.5.1.3.2">𝜋</ci></apply><apply id="S3.E25.m1.5.5.1.1.1.1.cmml" xref="S3.E25.m1.5.5.1.1.1"><csymbol cd="latexml" id="S3.E25.m1.5.5.1.1.1.1.1.cmml" xref="S3.E25.m1.5.5.1.1.1.1.1">conditional</csymbol><ci id="S3.E25.m1.5.5.1.1.1.1.2.cmml" xref="S3.E25.m1.5.5.1.1.1.1.2">𝑎</ci><ci id="S3.E25.m1.5.5.1.1.1.1.3.cmml" xref="S3.E25.m1.5.5.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.E25.m1.6.6.2.cmml" xref="S3.E25.m1.6.6.2"><times id="S3.E25.m1.6.6.2.2.cmml" xref="S3.E25.m1.6.6.2.2"></times><apply id="S3.E25.m1.6.6.2.3.cmml" xref="S3.E25.m1.6.6.2.3"><csymbol cd="ambiguous" id="S3.E25.m1.6.6.2.3.1.cmml" xref="S3.E25.m1.6.6.2.3">subscript</csymbol><ci id="S3.E25.m1.6.6.2.3.2.cmml" xref="S3.E25.m1.6.6.2.3.2">𝜋</ci><cn id="S3.E25.m1.6.6.2.3.3.cmml" type="integer" xref="S3.E25.m1.6.6.2.3.3">0</cn></apply><apply id="S3.E25.m1.6.6.2.1.1.1.cmml" xref="S3.E25.m1.6.6.2.1.1"><csymbol cd="latexml" id="S3.E25.m1.6.6.2.1.1.1.1.cmml" xref="S3.E25.m1.6.6.2.1.1.1.1">conditional</csymbol><ci id="S3.E25.m1.6.6.2.1.1.1.2.cmml" xref="S3.E25.m1.6.6.2.1.1.1.2">𝑎</ci><ci id="S3.E25.m1.6.6.2.1.1.1.3.cmml" xref="S3.E25.m1.6.6.2.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S3.E25.m1.9.9.1.1.1.1.1.1.1"><minus id="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.2">𝑟</ci><apply id="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.3"><ci id="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.3.1">^</ci><ci id="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E25.m1.9.9.1.1.1.1.1.1.1.1.3.2">𝑟</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E25.m1.9c">\nabla\widehat{V}_{\widehat{r}\text{-}{\rm DR}}(\pi,\mathcal{B})=\frac{1}{%
\left|\mathcal{B}\right|}\sum_{(x,a,r)\in\mathcal{B}}\frac{\nabla\pi(a|x)}{\pi%
_{0}(a|x)}\left(r-\widehat{r}\right).</annotation><annotation encoding="application/x-llamapun" id="S3.E25.m1.9d">∇ over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT over^ start_ARG italic_r end_ARG - roman_DR end_POSTSUBSCRIPT ( italic_π , caligraphic_B ) = divide start_ARG 1 end_ARG start_ARG | caligraphic_B | end_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) ∈ caligraphic_B end_POSTSUBSCRIPT divide start_ARG ∇ italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ( italic_r - over^ start_ARG italic_r end_ARG ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.1">Importantly, these three approaches are motivated through entirely different lenses: minimizing gradient variance, applying a multiplicative control variate to reduce estimation variance, and applying an additive control variate to improve robustness.
But they result in equivalent gradients, and thus, in equivalent optima.
Specifically, for optimization, the estimators are equivalent when <math alttext="\beta\equiv\lambda\equiv\widehat{r}" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><mrow id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml">β</mi><mo id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml">≡</mo><mi id="S3.SS1.p4.1.m1.1.1.4" xref="S3.SS1.p4.1.m1.1.1.4.cmml">λ</mi><mo id="S3.SS1.p4.1.m1.1.1.5" xref="S3.SS1.p4.1.m1.1.1.5.cmml">≡</mo><mover accent="true" id="S3.SS1.p4.1.m1.1.1.6" xref="S3.SS1.p4.1.m1.1.1.6.cmml"><mi id="S3.SS1.p4.1.m1.1.1.6.2" xref="S3.SS1.p4.1.m1.1.1.6.2.cmml">r</mi><mo id="S3.SS1.p4.1.m1.1.1.6.1" xref="S3.SS1.p4.1.m1.1.1.6.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><and id="S3.SS1.p4.1.m1.1.1a.cmml" xref="S3.SS1.p4.1.m1.1.1"></and><apply id="S3.SS1.p4.1.m1.1.1b.cmml" xref="S3.SS1.p4.1.m1.1.1"><equivalent id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3"></equivalent><ci id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2">𝛽</ci><ci id="S3.SS1.p4.1.m1.1.1.4.cmml" xref="S3.SS1.p4.1.m1.1.1.4">𝜆</ci></apply><apply id="S3.SS1.p4.1.m1.1.1c.cmml" xref="S3.SS1.p4.1.m1.1.1"><equivalent id="S3.SS1.p4.1.m1.1.1.5.cmml" xref="S3.SS1.p4.1.m1.1.1.5"></equivalent><share href="https://arxiv.org/html/2405.05736v2#S3.SS1.p4.1.m1.1.1.4.cmml" id="S3.SS1.p4.1.m1.1.1d.cmml" xref="S3.SS1.p4.1.m1.1.1"></share><apply id="S3.SS1.p4.1.m1.1.1.6.cmml" xref="S3.SS1.p4.1.m1.1.1.6"><ci id="S3.SS1.p4.1.m1.1.1.6.1.cmml" xref="S3.SS1.p4.1.m1.1.1.6.1">^</ci><ci id="S3.SS1.p4.1.m1.1.1.6.2.cmml" xref="S3.SS1.p4.1.m1.1.1.6.2">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\beta\equiv\lambda\equiv\widehat{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">italic_β ≡ italic_λ ≡ over^ start_ARG italic_r end_ARG</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.4">This equivalence implies that the choice between these three approaches is not important.
Since the simple baseline correction estimator <math alttext="\widehat{V}_{\beta\text{-}{\rm IPS}}" class="ltx_Math" display="inline" id="S3.SS1.p5.1.m1.1"><semantics id="S3.SS1.p5.1.m1.1a"><msub id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml"><mover accent="true" id="S3.SS1.p5.1.m1.1.1.2" xref="S3.SS1.p5.1.m1.1.1.2.cmml"><mi id="S3.SS1.p5.1.m1.1.1.2.2" xref="S3.SS1.p5.1.m1.1.1.2.2.cmml">V</mi><mo id="S3.SS1.p5.1.m1.1.1.2.1" xref="S3.SS1.p5.1.m1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS1.p5.1.m1.1.1.3" xref="S3.SS1.p5.1.m1.1.1.3.cmml"><mi id="S3.SS1.p5.1.m1.1.1.3.2" xref="S3.SS1.p5.1.m1.1.1.3.2.cmml">β</mi><mo id="S3.SS1.p5.1.m1.1.1.3.1" xref="S3.SS1.p5.1.m1.1.1.3.1.cmml">⁢</mo><mtext id="S3.SS1.p5.1.m1.1.1.3.3" xref="S3.SS1.p5.1.m1.1.1.3.3a.cmml">-</mtext><mo id="S3.SS1.p5.1.m1.1.1.3.1a" xref="S3.SS1.p5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p5.1.m1.1.1.3.4" xref="S3.SS1.p5.1.m1.1.1.3.4.cmml">IPS</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><apply id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.1.m1.1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">subscript</csymbol><apply id="S3.SS1.p5.1.m1.1.1.2.cmml" xref="S3.SS1.p5.1.m1.1.1.2"><ci id="S3.SS1.p5.1.m1.1.1.2.1.cmml" xref="S3.SS1.p5.1.m1.1.1.2.1">^</ci><ci id="S3.SS1.p5.1.m1.1.1.2.2.cmml" xref="S3.SS1.p5.1.m1.1.1.2.2">𝑉</ci></apply><apply id="S3.SS1.p5.1.m1.1.1.3.cmml" xref="S3.SS1.p5.1.m1.1.1.3"><times id="S3.SS1.p5.1.m1.1.1.3.1.cmml" xref="S3.SS1.p5.1.m1.1.1.3.1"></times><ci id="S3.SS1.p5.1.m1.1.1.3.2.cmml" xref="S3.SS1.p5.1.m1.1.1.3.2">𝛽</ci><ci id="S3.SS1.p5.1.m1.1.1.3.3a.cmml" xref="S3.SS1.p5.1.m1.1.1.3.3"><mtext id="S3.SS1.p5.1.m1.1.1.3.3.cmml" mathsize="70%" xref="S3.SS1.p5.1.m1.1.1.3.3">-</mtext></ci><ci id="S3.SS1.p5.1.m1.1.1.3.4.cmml" xref="S3.SS1.p5.1.m1.1.1.3.4">IPS</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">\widehat{V}_{\beta\text{-}{\rm IPS}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.1.m1.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_β - roman_IPS end_POSTSUBSCRIPT</annotation></semantics></math> (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E21" title="In 3.1. A unified off-policy estimator ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">21</span></a>) has an equivalence with all SNIPS estimators and all doubly-robust estimators with a constant reward, we propose that <math alttext="\widehat{V}_{\beta\text{-}{\rm IPS}}" class="ltx_Math" display="inline" id="S3.SS1.p5.2.m2.1"><semantics id="S3.SS1.p5.2.m2.1a"><msub id="S3.SS1.p5.2.m2.1.1" xref="S3.SS1.p5.2.m2.1.1.cmml"><mover accent="true" id="S3.SS1.p5.2.m2.1.1.2" xref="S3.SS1.p5.2.m2.1.1.2.cmml"><mi id="S3.SS1.p5.2.m2.1.1.2.2" xref="S3.SS1.p5.2.m2.1.1.2.2.cmml">V</mi><mo id="S3.SS1.p5.2.m2.1.1.2.1" xref="S3.SS1.p5.2.m2.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS1.p5.2.m2.1.1.3" xref="S3.SS1.p5.2.m2.1.1.3.cmml"><mi id="S3.SS1.p5.2.m2.1.1.3.2" xref="S3.SS1.p5.2.m2.1.1.3.2.cmml">β</mi><mo id="S3.SS1.p5.2.m2.1.1.3.1" xref="S3.SS1.p5.2.m2.1.1.3.1.cmml">⁢</mo><mtext id="S3.SS1.p5.2.m2.1.1.3.3" xref="S3.SS1.p5.2.m2.1.1.3.3a.cmml">-</mtext><mo id="S3.SS1.p5.2.m2.1.1.3.1a" xref="S3.SS1.p5.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p5.2.m2.1.1.3.4" xref="S3.SS1.p5.2.m2.1.1.3.4.cmml">IPS</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.2.m2.1b"><apply id="S3.SS1.p5.2.m2.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.2.m2.1.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1">subscript</csymbol><apply id="S3.SS1.p5.2.m2.1.1.2.cmml" xref="S3.SS1.p5.2.m2.1.1.2"><ci id="S3.SS1.p5.2.m2.1.1.2.1.cmml" xref="S3.SS1.p5.2.m2.1.1.2.1">^</ci><ci id="S3.SS1.p5.2.m2.1.1.2.2.cmml" xref="S3.SS1.p5.2.m2.1.1.2.2">𝑉</ci></apply><apply id="S3.SS1.p5.2.m2.1.1.3.cmml" xref="S3.SS1.p5.2.m2.1.1.3"><times id="S3.SS1.p5.2.m2.1.1.3.1.cmml" xref="S3.SS1.p5.2.m2.1.1.3.1"></times><ci id="S3.SS1.p5.2.m2.1.1.3.2.cmml" xref="S3.SS1.p5.2.m2.1.1.3.2">𝛽</ci><ci id="S3.SS1.p5.2.m2.1.1.3.3a.cmml" xref="S3.SS1.p5.2.m2.1.1.3.3"><mtext id="S3.SS1.p5.2.m2.1.1.3.3.cmml" mathsize="70%" xref="S3.SS1.p5.2.m2.1.1.3.3">-</mtext></ci><ci id="S3.SS1.p5.2.m2.1.1.3.4.cmml" xref="S3.SS1.p5.2.m2.1.1.3.4">IPS</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.2.m2.1c">\widehat{V}_{\beta\text{-}{\rm IPS}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.2.m2.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_β - roman_IPS end_POSTSUBSCRIPT</annotation></semantics></math> should be seen as an estimator that unifies all three approaches.
Accordingly, we argue that the real task is to find the optimal <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS1.p5.3.m3.1"><semantics id="S3.SS1.p5.3.m3.1a"><mi id="S3.SS1.p5.3.m3.1.1" xref="S3.SS1.p5.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.3.m3.1b"><ci id="S3.SS1.p5.3.m3.1.1.cmml" xref="S3.SS1.p5.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.3.m3.1d">italic_β</annotation></semantics></math> value for <math alttext="\widehat{V}_{\beta\text{-}{\rm IPS}}" class="ltx_Math" display="inline" id="S3.SS1.p5.4.m4.1"><semantics id="S3.SS1.p5.4.m4.1a"><msub id="S3.SS1.p5.4.m4.1.1" xref="S3.SS1.p5.4.m4.1.1.cmml"><mover accent="true" id="S3.SS1.p5.4.m4.1.1.2" xref="S3.SS1.p5.4.m4.1.1.2.cmml"><mi id="S3.SS1.p5.4.m4.1.1.2.2" xref="S3.SS1.p5.4.m4.1.1.2.2.cmml">V</mi><mo id="S3.SS1.p5.4.m4.1.1.2.1" xref="S3.SS1.p5.4.m4.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS1.p5.4.m4.1.1.3" xref="S3.SS1.p5.4.m4.1.1.3.cmml"><mi id="S3.SS1.p5.4.m4.1.1.3.2" xref="S3.SS1.p5.4.m4.1.1.3.2.cmml">β</mi><mo id="S3.SS1.p5.4.m4.1.1.3.1" xref="S3.SS1.p5.4.m4.1.1.3.1.cmml">⁢</mo><mtext id="S3.SS1.p5.4.m4.1.1.3.3" xref="S3.SS1.p5.4.m4.1.1.3.3a.cmml">-</mtext><mo id="S3.SS1.p5.4.m4.1.1.3.1a" xref="S3.SS1.p5.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p5.4.m4.1.1.3.4" xref="S3.SS1.p5.4.m4.1.1.3.4.cmml">IPS</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.4.m4.1b"><apply id="S3.SS1.p5.4.m4.1.1.cmml" xref="S3.SS1.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.4.m4.1.1.1.cmml" xref="S3.SS1.p5.4.m4.1.1">subscript</csymbol><apply id="S3.SS1.p5.4.m4.1.1.2.cmml" xref="S3.SS1.p5.4.m4.1.1.2"><ci id="S3.SS1.p5.4.m4.1.1.2.1.cmml" xref="S3.SS1.p5.4.m4.1.1.2.1">^</ci><ci id="S3.SS1.p5.4.m4.1.1.2.2.cmml" xref="S3.SS1.p5.4.m4.1.1.2.2">𝑉</ci></apply><apply id="S3.SS1.p5.4.m4.1.1.3.cmml" xref="S3.SS1.p5.4.m4.1.1.3"><times id="S3.SS1.p5.4.m4.1.1.3.1.cmml" xref="S3.SS1.p5.4.m4.1.1.3.1"></times><ci id="S3.SS1.p5.4.m4.1.1.3.2.cmml" xref="S3.SS1.p5.4.m4.1.1.3.2">𝛽</ci><ci id="S3.SS1.p5.4.m4.1.1.3.3a.cmml" xref="S3.SS1.p5.4.m4.1.1.3.3"><mtext id="S3.SS1.p5.4.m4.1.1.3.3.cmml" mathsize="70%" xref="S3.SS1.p5.4.m4.1.1.3.3">-</mtext></ci><ci id="S3.SS1.p5.4.m4.1.1.3.4.cmml" xref="S3.SS1.p5.4.m4.1.1.3.4">IPS</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.4.m4.1c">\widehat{V}_{\beta\text{-}{\rm IPS}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.4.m4.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_β - roman_IPS end_POSTSUBSCRIPT</annotation></semantics></math>, since this results in an estimator that is at least as optimal as any estimator in the underlying families of estimators, and possibly superior to them.</p>
</div>
<div class="ltx_para" id="S3.SS1.p6">
<p class="ltx_p" id="S3.SS1.p6.1">The remainder of this section describes the optimal <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS1.p6.1.m1.1"><semantics id="S3.SS1.p6.1.m1.1a"><mi id="S3.SS1.p6.1.m1.1.1" xref="S3.SS1.p6.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.1.m1.1b"><ci id="S3.SS1.p6.1.m1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.1.m1.1d">italic_β</annotation></semantics></math> values for minimizing gradient variance and estimation value variance.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Minimizing gradient variance</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.2">Similar to the on-policy variant derived in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2.E7" title="In 2.1. On-policy contextual bandits ‣ 2. Background and Related Work ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">7</span></a>, we can derive the optimal baseline in the off-policy case as the one which results in the minimum variance for the gradient estimate given by Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2.E13" title="In 2.2. Off-policy estimation for general bandits ‣ 2. Background and Related Work ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">13</span></a>:
</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Ax1.EGx6">
<tbody id="S3.E26"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(26)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\operatorname*{arg\,min}_{\beta}\mathrm{Var}" class="ltx_Math" display="inline" id="S3.E26.m1.1"><semantics id="S3.E26.m1.1a"><mrow id="S3.E26.m1.1.1" xref="S3.E26.m1.1.1.cmml"><munder id="S3.E26.m1.1.1.1" xref="S3.E26.m1.1.1.1.cmml"><mrow id="S3.E26.m1.1.1.1.2" xref="S3.E26.m1.1.1.1.2.cmml"><mi id="S3.E26.m1.1.1.1.2.2" xref="S3.E26.m1.1.1.1.2.2.cmml">arg</mi><mo id="S3.E26.m1.1.1.1.2.1" lspace="0.170em" xref="S3.E26.m1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.E26.m1.1.1.1.2.3" xref="S3.E26.m1.1.1.1.2.3.cmml">min</mi></mrow><mi id="S3.E26.m1.1.1.1.3" xref="S3.E26.m1.1.1.1.3.cmml">β</mi></munder><mo id="S3.E26.m1.1.1a" lspace="0.167em" xref="S3.E26.m1.1.1.cmml">⁡</mo><mi id="S3.E26.m1.1.1.2" xref="S3.E26.m1.1.1.2.cmml">Var</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E26.m1.1b"><apply id="S3.E26.m1.1.1.cmml" xref="S3.E26.m1.1.1"><apply id="S3.E26.m1.1.1.1.cmml" xref="S3.E26.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E26.m1.1.1.1.1.cmml" xref="S3.E26.m1.1.1.1">subscript</csymbol><apply id="S3.E26.m1.1.1.1.2.cmml" xref="S3.E26.m1.1.1.1.2"><times id="S3.E26.m1.1.1.1.2.1.cmml" xref="S3.E26.m1.1.1.1.2.1"></times><ci id="S3.E26.m1.1.1.1.2.2.cmml" xref="S3.E26.m1.1.1.1.2.2">arg</ci><ci id="S3.E26.m1.1.1.1.2.3.cmml" xref="S3.E26.m1.1.1.1.2.3">min</ci></apply><ci id="S3.E26.m1.1.1.1.3.cmml" xref="S3.E26.m1.1.1.1.3">𝛽</ci></apply><ci id="S3.E26.m1.1.1.2.cmml" xref="S3.E26.m1.1.1.2">Var</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E26.m1.1c">\displaystyle\operatorname*{arg\,min}_{\beta}\mathrm{Var}</annotation><annotation encoding="application/x-llamapun" id="S3.E26.m1.1d">start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT italic_β end_POSTSUBSCRIPT roman_Var</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\left(\nabla_{\theta}(\widehat{V}_{\beta\text{-}{\rm IPS}}(\pi_{%
\theta},\mathcal{B}))\right)" class="ltx_Math" display="inline" id="S3.E26.m2.2"><semantics id="S3.E26.m2.2a"><mrow id="S3.E26.m2.2.2.1"><mo id="S3.E26.m2.2.2.1.2">(</mo><mrow id="S3.E26.m2.2.2.1.1.2" xref="S3.E26.m2.2.2.1.1.3.cmml"><msub id="S3.E26.m2.2.2.1.1.1.1" xref="S3.E26.m2.2.2.1.1.1.1.cmml"><mo id="S3.E26.m2.2.2.1.1.1.1.2" xref="S3.E26.m2.2.2.1.1.1.1.2.cmml">∇</mo><mi id="S3.E26.m2.2.2.1.1.1.1.3" xref="S3.E26.m2.2.2.1.1.1.1.3.cmml">θ</mi></msub><mrow id="S3.E26.m2.2.2.1.1.2.2" xref="S3.E26.m2.2.2.1.1.3.cmml"><mo id="S3.E26.m2.2.2.1.1.2.2.2" stretchy="false" xref="S3.E26.m2.2.2.1.1.3.cmml">(</mo><mrow id="S3.E26.m2.2.2.1.1.2.2.1" xref="S3.E26.m2.2.2.1.1.2.2.1.cmml"><msub id="S3.E26.m2.2.2.1.1.2.2.1.3" xref="S3.E26.m2.2.2.1.1.2.2.1.3.cmml"><mover accent="true" id="S3.E26.m2.2.2.1.1.2.2.1.3.2" xref="S3.E26.m2.2.2.1.1.2.2.1.3.2.cmml"><mi id="S3.E26.m2.2.2.1.1.2.2.1.3.2.2" xref="S3.E26.m2.2.2.1.1.2.2.1.3.2.2.cmml">V</mi><mo id="S3.E26.m2.2.2.1.1.2.2.1.3.2.1" xref="S3.E26.m2.2.2.1.1.2.2.1.3.2.1.cmml">^</mo></mover><mrow id="S3.E26.m2.2.2.1.1.2.2.1.3.3" xref="S3.E26.m2.2.2.1.1.2.2.1.3.3.cmml"><mi id="S3.E26.m2.2.2.1.1.2.2.1.3.3.2" xref="S3.E26.m2.2.2.1.1.2.2.1.3.3.2.cmml">β</mi><mo id="S3.E26.m2.2.2.1.1.2.2.1.3.3.1" xref="S3.E26.m2.2.2.1.1.2.2.1.3.3.1.cmml">⁢</mo><mtext id="S3.E26.m2.2.2.1.1.2.2.1.3.3.3" xref="S3.E26.m2.2.2.1.1.2.2.1.3.3.3a.cmml">-</mtext><mo id="S3.E26.m2.2.2.1.1.2.2.1.3.3.1a" xref="S3.E26.m2.2.2.1.1.2.2.1.3.3.1.cmml">⁢</mo><mi id="S3.E26.m2.2.2.1.1.2.2.1.3.3.4" xref="S3.E26.m2.2.2.1.1.2.2.1.3.3.4.cmml">IPS</mi></mrow></msub><mo id="S3.E26.m2.2.2.1.1.2.2.1.2" xref="S3.E26.m2.2.2.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E26.m2.2.2.1.1.2.2.1.1.1" xref="S3.E26.m2.2.2.1.1.2.2.1.1.2.cmml"><mo id="S3.E26.m2.2.2.1.1.2.2.1.1.1.2" stretchy="false" xref="S3.E26.m2.2.2.1.1.2.2.1.1.2.cmml">(</mo><msub id="S3.E26.m2.2.2.1.1.2.2.1.1.1.1" xref="S3.E26.m2.2.2.1.1.2.2.1.1.1.1.cmml"><mi id="S3.E26.m2.2.2.1.1.2.2.1.1.1.1.2" xref="S3.E26.m2.2.2.1.1.2.2.1.1.1.1.2.cmml">π</mi><mi id="S3.E26.m2.2.2.1.1.2.2.1.1.1.1.3" xref="S3.E26.m2.2.2.1.1.2.2.1.1.1.1.3.cmml">θ</mi></msub><mo id="S3.E26.m2.2.2.1.1.2.2.1.1.1.3" xref="S3.E26.m2.2.2.1.1.2.2.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E26.m2.1.1" xref="S3.E26.m2.1.1.cmml">ℬ</mi><mo id="S3.E26.m2.2.2.1.1.2.2.1.1.1.4" stretchy="false" xref="S3.E26.m2.2.2.1.1.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E26.m2.2.2.1.1.2.2.3" stretchy="false" xref="S3.E26.m2.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E26.m2.2.2.1.3">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E26.m2.2b"><apply id="S3.E26.m2.2.2.1.1.3.cmml" xref="S3.E26.m2.2.2.1.1.2"><apply id="S3.E26.m2.2.2.1.1.1.1.cmml" xref="S3.E26.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E26.m2.2.2.1.1.1.1.1.cmml" xref="S3.E26.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E26.m2.2.2.1.1.1.1.2.cmml" xref="S3.E26.m2.2.2.1.1.1.1.2">∇</ci><ci id="S3.E26.m2.2.2.1.1.1.1.3.cmml" xref="S3.E26.m2.2.2.1.1.1.1.3">𝜃</ci></apply><apply id="S3.E26.m2.2.2.1.1.2.2.1.cmml" xref="S3.E26.m2.2.2.1.1.2.2.1"><times id="S3.E26.m2.2.2.1.1.2.2.1.2.cmml" xref="S3.E26.m2.2.2.1.1.2.2.1.2"></times><apply id="S3.E26.m2.2.2.1.1.2.2.1.3.cmml" xref="S3.E26.m2.2.2.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E26.m2.2.2.1.1.2.2.1.3.1.cmml" xref="S3.E26.m2.2.2.1.1.2.2.1.3">subscript</csymbol><apply id="S3.E26.m2.2.2.1.1.2.2.1.3.2.cmml" xref="S3.E26.m2.2.2.1.1.2.2.1.3.2"><ci id="S3.E26.m2.2.2.1.1.2.2.1.3.2.1.cmml" xref="S3.E26.m2.2.2.1.1.2.2.1.3.2.1">^</ci><ci id="S3.E26.m2.2.2.1.1.2.2.1.3.2.2.cmml" xref="S3.E26.m2.2.2.1.1.2.2.1.3.2.2">𝑉</ci></apply><apply id="S3.E26.m2.2.2.1.1.2.2.1.3.3.cmml" xref="S3.E26.m2.2.2.1.1.2.2.1.3.3"><times id="S3.E26.m2.2.2.1.1.2.2.1.3.3.1.cmml" xref="S3.E26.m2.2.2.1.1.2.2.1.3.3.1"></times><ci id="S3.E26.m2.2.2.1.1.2.2.1.3.3.2.cmml" xref="S3.E26.m2.2.2.1.1.2.2.1.3.3.2">𝛽</ci><ci id="S3.E26.m2.2.2.1.1.2.2.1.3.3.3a.cmml" xref="S3.E26.m2.2.2.1.1.2.2.1.3.3.3"><mtext id="S3.E26.m2.2.2.1.1.2.2.1.3.3.3.cmml" mathsize="70%" xref="S3.E26.m2.2.2.1.1.2.2.1.3.3.3">-</mtext></ci><ci id="S3.E26.m2.2.2.1.1.2.2.1.3.3.4.cmml" xref="S3.E26.m2.2.2.1.1.2.2.1.3.3.4">IPS</ci></apply></apply><interval closure="open" id="S3.E26.m2.2.2.1.1.2.2.1.1.2.cmml" xref="S3.E26.m2.2.2.1.1.2.2.1.1.1"><apply id="S3.E26.m2.2.2.1.1.2.2.1.1.1.1.cmml" xref="S3.E26.m2.2.2.1.1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E26.m2.2.2.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E26.m2.2.2.1.1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E26.m2.2.2.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E26.m2.2.2.1.1.2.2.1.1.1.1.2">𝜋</ci><ci id="S3.E26.m2.2.2.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E26.m2.2.2.1.1.2.2.1.1.1.1.3">𝜃</ci></apply><ci id="S3.E26.m2.1.1.cmml" xref="S3.E26.m2.1.1">ℬ</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E26.m2.2c">\displaystyle\left(\nabla_{\theta}(\widehat{V}_{\beta\text{-}{\rm IPS}}(\pi_{%
\theta},\mathcal{B}))\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E26.m2.2d">( ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_β - roman_IPS end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT , caligraphic_B ) ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E27"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(27)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname*{arg\,min}_{\beta}\frac{1}{\left|\mathcal{B}\right%
|}\mathop{\mathrm{Var}}\left[\frac{\nabla\pi(a|x)}{\pi_{0}(a|x)}\left(r-\beta%
\right)\right]" class="ltx_Math" display="inline" id="S3.E27.m1.4"><semantics id="S3.E27.m1.4a"><mrow id="S3.E27.m1.4.4" xref="S3.E27.m1.4.4.cmml"><mi id="S3.E27.m1.4.4.3" xref="S3.E27.m1.4.4.3.cmml"></mi><mo id="S3.E27.m1.4.4.2" xref="S3.E27.m1.4.4.2.cmml">=</mo><mrow id="S3.E27.m1.4.4.1" xref="S3.E27.m1.4.4.1.cmml"><mrow id="S3.E27.m1.4.4.1.3" xref="S3.E27.m1.4.4.1.3.cmml"><munder id="S3.E27.m1.4.4.1.3.1" xref="S3.E27.m1.4.4.1.3.1.cmml"><mrow id="S3.E27.m1.4.4.1.3.1.2" xref="S3.E27.m1.4.4.1.3.1.2.cmml"><mi id="S3.E27.m1.4.4.1.3.1.2.2" xref="S3.E27.m1.4.4.1.3.1.2.2.cmml">arg</mi><mo id="S3.E27.m1.4.4.1.3.1.2.1" lspace="0.170em" xref="S3.E27.m1.4.4.1.3.1.2.1.cmml">⁢</mo><mi id="S3.E27.m1.4.4.1.3.1.2.3" xref="S3.E27.m1.4.4.1.3.1.2.3.cmml">min</mi></mrow><mi id="S3.E27.m1.4.4.1.3.1.3" xref="S3.E27.m1.4.4.1.3.1.3.cmml">β</mi></munder><mo id="S3.E27.m1.4.4.1.3a" xref="S3.E27.m1.4.4.1.3.cmml">⁡</mo><mstyle displaystyle="true" id="S3.E27.m1.1.1" xref="S3.E27.m1.1.1.cmml"><mfrac id="S3.E27.m1.1.1a" xref="S3.E27.m1.1.1.cmml"><mn id="S3.E27.m1.1.1.3" xref="S3.E27.m1.1.1.3.cmml">1</mn><mrow id="S3.E27.m1.1.1.1.3" xref="S3.E27.m1.1.1.1.2.cmml"><mo id="S3.E27.m1.1.1.1.3.1" xref="S3.E27.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E27.m1.1.1.1.1" xref="S3.E27.m1.1.1.1.1.cmml">ℬ</mi><mo id="S3.E27.m1.1.1.1.3.2" xref="S3.E27.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle></mrow><mo id="S3.E27.m1.4.4.1.2" lspace="0.167em" xref="S3.E27.m1.4.4.1.2.cmml">⁢</mo><mrow id="S3.E27.m1.4.4.1.1" xref="S3.E27.m1.4.4.1.1.cmml"><mo id="S3.E27.m1.4.4.1.1.2" movablelimits="false" rspace="0em" xref="S3.E27.m1.4.4.1.1.2.cmml">Var</mo><mrow id="S3.E27.m1.4.4.1.1.1.1" xref="S3.E27.m1.4.4.1.1.1.2.cmml"><mo id="S3.E27.m1.4.4.1.1.1.1.2" xref="S3.E27.m1.4.4.1.1.1.2.1.cmml">[</mo><mrow id="S3.E27.m1.4.4.1.1.1.1.1" xref="S3.E27.m1.4.4.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E27.m1.3.3" xref="S3.E27.m1.3.3.cmml"><mfrac id="S3.E27.m1.3.3a" xref="S3.E27.m1.3.3.cmml"><mrow id="S3.E27.m1.2.2.1" xref="S3.E27.m1.2.2.1.cmml"><mrow id="S3.E27.m1.2.2.1.3" xref="S3.E27.m1.2.2.1.3.cmml"><mo id="S3.E27.m1.2.2.1.3.1" rspace="0.167em" xref="S3.E27.m1.2.2.1.3.1.cmml">∇</mo><mi id="S3.E27.m1.2.2.1.3.2" xref="S3.E27.m1.2.2.1.3.2.cmml">π</mi></mrow><mo id="S3.E27.m1.2.2.1.2" xref="S3.E27.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E27.m1.2.2.1.1.1" xref="S3.E27.m1.2.2.1.1.1.1.cmml"><mo id="S3.E27.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E27.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E27.m1.2.2.1.1.1.1" xref="S3.E27.m1.2.2.1.1.1.1.cmml"><mi id="S3.E27.m1.2.2.1.1.1.1.2" xref="S3.E27.m1.2.2.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E27.m1.2.2.1.1.1.1.1" xref="S3.E27.m1.2.2.1.1.1.1.1.cmml">|</mo><mi id="S3.E27.m1.2.2.1.1.1.1.3" xref="S3.E27.m1.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E27.m1.2.2.1.1.1.3" stretchy="false" xref="S3.E27.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E27.m1.3.3.2" xref="S3.E27.m1.3.3.2.cmml"><msub id="S3.E27.m1.3.3.2.3" xref="S3.E27.m1.3.3.2.3.cmml"><mi id="S3.E27.m1.3.3.2.3.2" xref="S3.E27.m1.3.3.2.3.2.cmml">π</mi><mn id="S3.E27.m1.3.3.2.3.3" xref="S3.E27.m1.3.3.2.3.3.cmml">0</mn></msub><mo id="S3.E27.m1.3.3.2.2" xref="S3.E27.m1.3.3.2.2.cmml">⁢</mo><mrow id="S3.E27.m1.3.3.2.1.1" xref="S3.E27.m1.3.3.2.1.1.1.cmml"><mo id="S3.E27.m1.3.3.2.1.1.2" stretchy="false" xref="S3.E27.m1.3.3.2.1.1.1.cmml">(</mo><mrow id="S3.E27.m1.3.3.2.1.1.1" xref="S3.E27.m1.3.3.2.1.1.1.cmml"><mi id="S3.E27.m1.3.3.2.1.1.1.2" xref="S3.E27.m1.3.3.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E27.m1.3.3.2.1.1.1.1" xref="S3.E27.m1.3.3.2.1.1.1.1.cmml">|</mo><mi id="S3.E27.m1.3.3.2.1.1.1.3" xref="S3.E27.m1.3.3.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E27.m1.3.3.2.1.1.3" stretchy="false" xref="S3.E27.m1.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S3.E27.m1.4.4.1.1.1.1.1.2" xref="S3.E27.m1.4.4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E27.m1.4.4.1.1.1.1.1.1.1" xref="S3.E27.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E27.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E27.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E27.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E27.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E27.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E27.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="S3.E27.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E27.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E27.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E27.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">β</mi></mrow><mo id="S3.E27.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E27.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E27.m1.4.4.1.1.1.1.3" xref="S3.E27.m1.4.4.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E27.m1.4b"><apply id="S3.E27.m1.4.4.cmml" xref="S3.E27.m1.4.4"><eq id="S3.E27.m1.4.4.2.cmml" xref="S3.E27.m1.4.4.2"></eq><csymbol cd="latexml" id="S3.E27.m1.4.4.3.cmml" xref="S3.E27.m1.4.4.3">absent</csymbol><apply id="S3.E27.m1.4.4.1.cmml" xref="S3.E27.m1.4.4.1"><times id="S3.E27.m1.4.4.1.2.cmml" xref="S3.E27.m1.4.4.1.2"></times><apply id="S3.E27.m1.4.4.1.3.cmml" xref="S3.E27.m1.4.4.1.3"><apply id="S3.E27.m1.4.4.1.3.1.cmml" xref="S3.E27.m1.4.4.1.3.1"><csymbol cd="ambiguous" id="S3.E27.m1.4.4.1.3.1.1.cmml" xref="S3.E27.m1.4.4.1.3.1">subscript</csymbol><apply id="S3.E27.m1.4.4.1.3.1.2.cmml" xref="S3.E27.m1.4.4.1.3.1.2"><times id="S3.E27.m1.4.4.1.3.1.2.1.cmml" xref="S3.E27.m1.4.4.1.3.1.2.1"></times><ci id="S3.E27.m1.4.4.1.3.1.2.2.cmml" xref="S3.E27.m1.4.4.1.3.1.2.2">arg</ci><ci id="S3.E27.m1.4.4.1.3.1.2.3.cmml" xref="S3.E27.m1.4.4.1.3.1.2.3">min</ci></apply><ci id="S3.E27.m1.4.4.1.3.1.3.cmml" xref="S3.E27.m1.4.4.1.3.1.3">𝛽</ci></apply><apply id="S3.E27.m1.1.1.cmml" xref="S3.E27.m1.1.1"><divide id="S3.E27.m1.1.1.2.cmml" xref="S3.E27.m1.1.1"></divide><cn id="S3.E27.m1.1.1.3.cmml" type="integer" xref="S3.E27.m1.1.1.3">1</cn><apply id="S3.E27.m1.1.1.1.2.cmml" xref="S3.E27.m1.1.1.1.3"><abs id="S3.E27.m1.1.1.1.2.1.cmml" xref="S3.E27.m1.1.1.1.3.1"></abs><ci id="S3.E27.m1.1.1.1.1.cmml" xref="S3.E27.m1.1.1.1.1">ℬ</ci></apply></apply></apply><apply id="S3.E27.m1.4.4.1.1.cmml" xref="S3.E27.m1.4.4.1.1"><ci id="S3.E27.m1.4.4.1.1.2.cmml" xref="S3.E27.m1.4.4.1.1.2">Var</ci><apply id="S3.E27.m1.4.4.1.1.1.2.cmml" xref="S3.E27.m1.4.4.1.1.1.1"><csymbol cd="latexml" id="S3.E27.m1.4.4.1.1.1.2.1.cmml" xref="S3.E27.m1.4.4.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E27.m1.4.4.1.1.1.1.1.cmml" xref="S3.E27.m1.4.4.1.1.1.1.1"><times id="S3.E27.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E27.m1.4.4.1.1.1.1.1.2"></times><apply id="S3.E27.m1.3.3.cmml" xref="S3.E27.m1.3.3"><divide id="S3.E27.m1.3.3.3.cmml" xref="S3.E27.m1.3.3"></divide><apply id="S3.E27.m1.2.2.1.cmml" xref="S3.E27.m1.2.2.1"><times id="S3.E27.m1.2.2.1.2.cmml" xref="S3.E27.m1.2.2.1.2"></times><apply id="S3.E27.m1.2.2.1.3.cmml" xref="S3.E27.m1.2.2.1.3"><ci id="S3.E27.m1.2.2.1.3.1.cmml" xref="S3.E27.m1.2.2.1.3.1">∇</ci><ci id="S3.E27.m1.2.2.1.3.2.cmml" xref="S3.E27.m1.2.2.1.3.2">𝜋</ci></apply><apply id="S3.E27.m1.2.2.1.1.1.1.cmml" xref="S3.E27.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E27.m1.2.2.1.1.1.1.1.cmml" xref="S3.E27.m1.2.2.1.1.1.1.1">conditional</csymbol><ci id="S3.E27.m1.2.2.1.1.1.1.2.cmml" xref="S3.E27.m1.2.2.1.1.1.1.2">𝑎</ci><ci id="S3.E27.m1.2.2.1.1.1.1.3.cmml" xref="S3.E27.m1.2.2.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.E27.m1.3.3.2.cmml" xref="S3.E27.m1.3.3.2"><times id="S3.E27.m1.3.3.2.2.cmml" xref="S3.E27.m1.3.3.2.2"></times><apply id="S3.E27.m1.3.3.2.3.cmml" xref="S3.E27.m1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E27.m1.3.3.2.3.1.cmml" xref="S3.E27.m1.3.3.2.3">subscript</csymbol><ci id="S3.E27.m1.3.3.2.3.2.cmml" xref="S3.E27.m1.3.3.2.3.2">𝜋</ci><cn id="S3.E27.m1.3.3.2.3.3.cmml" type="integer" xref="S3.E27.m1.3.3.2.3.3">0</cn></apply><apply id="S3.E27.m1.3.3.2.1.1.1.cmml" xref="S3.E27.m1.3.3.2.1.1"><csymbol cd="latexml" id="S3.E27.m1.3.3.2.1.1.1.1.cmml" xref="S3.E27.m1.3.3.2.1.1.1.1">conditional</csymbol><ci id="S3.E27.m1.3.3.2.1.1.1.2.cmml" xref="S3.E27.m1.3.3.2.1.1.1.2">𝑎</ci><ci id="S3.E27.m1.3.3.2.1.1.1.3.cmml" xref="S3.E27.m1.3.3.2.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="S3.E27.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E27.m1.4.4.1.1.1.1.1.1.1"><minus id="S3.E27.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E27.m1.4.4.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.E27.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E27.m1.4.4.1.1.1.1.1.1.1.1.2">𝑟</ci><ci id="S3.E27.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E27.m1.4.4.1.1.1.1.1.1.1.1.3">𝛽</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E27.m1.4c">\displaystyle=\operatorname*{arg\,min}_{\beta}\frac{1}{\left|\mathcal{B}\right%
|}\mathop{\mathrm{Var}}\left[\frac{\nabla\pi(a|x)}{\pi_{0}(a|x)}\left(r-\beta%
\right)\right]</annotation><annotation encoding="application/x-llamapun" id="S3.E27.m1.4d">= start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT italic_β end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG | caligraphic_B | end_ARG roman_Var [ divide start_ARG ∇ italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ( italic_r - italic_β ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E28"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(28)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname*{arg\,min}_{\beta}\frac{1}{\left|\mathcal{B}\right%
|}\mathop{\mathbb{E}}\left[\|\nabla\pi(a|x))\|^{2}_{2}\Big{(}\frac{r-\beta}{%
\pi_{0}(a|x)}\Big{)}^{2}\ \right]" class="ltx_math_unparsed" display="inline" id="S3.E28.m1.2"><semantics id="S3.E28.m1.2a"><mrow id="S3.E28.m1.2b"><mo id="S3.E28.m1.2.3">=</mo><munder id="S3.E28.m1.2.4"><mrow id="S3.E28.m1.2.4.2"><mi id="S3.E28.m1.2.4.2.2">arg</mi><mo id="S3.E28.m1.2.4.2.1" lspace="0.170em">⁢</mo><mi id="S3.E28.m1.2.4.2.3">min</mi></mrow><mi id="S3.E28.m1.2.4.3">β</mi></munder><mstyle displaystyle="true" id="S3.E28.m1.1.1"><mfrac id="S3.E28.m1.1.1a"><mn id="S3.E28.m1.1.1.3">1</mn><mrow id="S3.E28.m1.1.1.1.3"><mo id="S3.E28.m1.1.1.1.3.1">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E28.m1.1.1.1.1">ℬ</mi><mo id="S3.E28.m1.1.1.1.3.2">|</mo></mrow></mfrac></mstyle><mo id="S3.E28.m1.2.5" lspace="0.167em" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S3.E28.m1.2.6"><mo id="S3.E28.m1.2.6.1">[</mo><mo id="S3.E28.m1.2.6.2" lspace="0em" rspace="0.167em">∥</mo><mo id="S3.E28.m1.2.6.3" rspace="0.167em">∇</mo><mi id="S3.E28.m1.2.6.4">π</mi><mrow id="S3.E28.m1.2.6.5"><mo id="S3.E28.m1.2.6.5.1" stretchy="false">(</mo><mi id="S3.E28.m1.2.6.5.2">a</mi><mo fence="false" id="S3.E28.m1.2.6.5.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E28.m1.2.6.5.4">x</mi><mo id="S3.E28.m1.2.6.5.5" stretchy="false">)</mo></mrow><mo id="S3.E28.m1.2.6.6" stretchy="false">)</mo></mrow><msubsup id="S3.E28.m1.2.7"><mo id="S3.E28.m1.2.7.2.2" lspace="0em" rspace="0.167em">∥</mo><mn id="S3.E28.m1.2.7.3">2</mn><mn id="S3.E28.m1.2.7.2.3">2</mn></msubsup><msup id="S3.E28.m1.2.8"><mrow id="S3.E28.m1.2.8.2"><mo id="S3.E28.m1.2.8.2.1" maxsize="160%" minsize="160%">(</mo><mstyle displaystyle="true" id="S3.E28.m1.2.2"><mfrac id="S3.E28.m1.2.2a"><mrow id="S3.E28.m1.2.2.3"><mi id="S3.E28.m1.2.2.3.2">r</mi><mo id="S3.E28.m1.2.2.3.1">−</mo><mi id="S3.E28.m1.2.2.3.3">β</mi></mrow><mrow id="S3.E28.m1.2.2.1"><msub id="S3.E28.m1.2.2.1.3"><mi id="S3.E28.m1.2.2.1.3.2">π</mi><mn id="S3.E28.m1.2.2.1.3.3">0</mn></msub><mo id="S3.E28.m1.2.2.1.2">⁢</mo><mrow id="S3.E28.m1.2.2.1.1.1"><mo id="S3.E28.m1.2.2.1.1.1.2" stretchy="false">(</mo><mrow id="S3.E28.m1.2.2.1.1.1.1"><mi id="S3.E28.m1.2.2.1.1.1.1.2">a</mi><mo fence="false" id="S3.E28.m1.2.2.1.1.1.1.1">|</mo><mi id="S3.E28.m1.2.2.1.1.1.1.3">x</mi></mrow><mo id="S3.E28.m1.2.2.1.1.1.3" stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo id="S3.E28.m1.2.8.2.2" maxsize="160%" minsize="160%">)</mo></mrow><mn id="S3.E28.m1.2.8.3">2</mn></msup><mo id="S3.E28.m1.2.9">]</mo></mrow><annotation encoding="application/x-tex" id="S3.E28.m1.2c">\displaystyle=\operatorname*{arg\,min}_{\beta}\frac{1}{\left|\mathcal{B}\right%
|}\mathop{\mathbb{E}}\left[\|\nabla\pi(a|x))\|^{2}_{2}\Big{(}\frac{r-\beta}{%
\pi_{0}(a|x)}\Big{)}^{2}\ \right]</annotation><annotation encoding="application/x-llamapun" id="S3.E28.m1.2d">= start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT italic_β end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG | caligraphic_B | end_ARG blackboard_E [ ∥ ∇ italic_π ( italic_a | italic_x ) ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( divide start_ARG italic_r - italic_β end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\qquad\qquad\qquad-\frac{1}{\left|\mathcal{B}\right|}\|\mathop{%
\mathbb{E}}\left[\frac{\nabla\pi(a|x)}{\pi_{0}(a|x)}\left(r-\beta\right)\right%
]\|^{2}_{2}" class="ltx_Math" display="inline" id="S3.Ex12.m1.4"><semantics id="S3.Ex12.m1.4a"><mrow id="S3.Ex12.m1.4.4" xref="S3.Ex12.m1.4.4.cmml"><mo id="S3.Ex12.m1.4.4a" xref="S3.Ex12.m1.4.4.cmml">−</mo><mrow id="S3.Ex12.m1.4.4.1" xref="S3.Ex12.m1.4.4.1.cmml"><mstyle displaystyle="true" id="S3.Ex12.m1.1.1" xref="S3.Ex12.m1.1.1.cmml"><mfrac id="S3.Ex12.m1.1.1a" xref="S3.Ex12.m1.1.1.cmml"><mn id="S3.Ex12.m1.1.1.3" xref="S3.Ex12.m1.1.1.3.cmml">1</mn><mrow id="S3.Ex12.m1.1.1.1.3" xref="S3.Ex12.m1.1.1.1.2.cmml"><mo id="S3.Ex12.m1.1.1.1.3.1" xref="S3.Ex12.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex12.m1.1.1.1.1" xref="S3.Ex12.m1.1.1.1.1.cmml">ℬ</mi><mo id="S3.Ex12.m1.1.1.1.3.2" xref="S3.Ex12.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo id="S3.Ex12.m1.4.4.1.2" xref="S3.Ex12.m1.4.4.1.2.cmml">⁢</mo><msubsup id="S3.Ex12.m1.4.4.1.1" xref="S3.Ex12.m1.4.4.1.1.cmml"><mrow id="S3.Ex12.m1.4.4.1.1.1.1.1" xref="S3.Ex12.m1.4.4.1.1.1.1.2.cmml"><mo id="S3.Ex12.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S3.Ex12.m1.4.4.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.Ex12.m1.4.4.1.1.1.1.1.1" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S3.Ex12.m1.4.4.1.1.1.1.1.1.2" lspace="0em" movablelimits="false" rspace="0em" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.2.cmml">𝔼</mo><mrow id="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mo id="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex12.m1.3.3" xref="S3.Ex12.m1.3.3.cmml"><mfrac id="S3.Ex12.m1.3.3a" xref="S3.Ex12.m1.3.3.cmml"><mrow id="S3.Ex12.m1.2.2.1" xref="S3.Ex12.m1.2.2.1.cmml"><mrow id="S3.Ex12.m1.2.2.1.3" xref="S3.Ex12.m1.2.2.1.3.cmml"><mo id="S3.Ex12.m1.2.2.1.3.1" rspace="0.167em" xref="S3.Ex12.m1.2.2.1.3.1.cmml">∇</mo><mi id="S3.Ex12.m1.2.2.1.3.2" xref="S3.Ex12.m1.2.2.1.3.2.cmml">π</mi></mrow><mo id="S3.Ex12.m1.2.2.1.2" xref="S3.Ex12.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.Ex12.m1.2.2.1.1.1" xref="S3.Ex12.m1.2.2.1.1.1.1.cmml"><mo id="S3.Ex12.m1.2.2.1.1.1.2" stretchy="false" xref="S3.Ex12.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.Ex12.m1.2.2.1.1.1.1" xref="S3.Ex12.m1.2.2.1.1.1.1.cmml"><mi id="S3.Ex12.m1.2.2.1.1.1.1.2" xref="S3.Ex12.m1.2.2.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.Ex12.m1.2.2.1.1.1.1.1" xref="S3.Ex12.m1.2.2.1.1.1.1.1.cmml">|</mo><mi id="S3.Ex12.m1.2.2.1.1.1.1.3" xref="S3.Ex12.m1.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.Ex12.m1.2.2.1.1.1.3" stretchy="false" xref="S3.Ex12.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.Ex12.m1.3.3.2" xref="S3.Ex12.m1.3.3.2.cmml"><msub id="S3.Ex12.m1.3.3.2.3" xref="S3.Ex12.m1.3.3.2.3.cmml"><mi id="S3.Ex12.m1.3.3.2.3.2" xref="S3.Ex12.m1.3.3.2.3.2.cmml">π</mi><mn id="S3.Ex12.m1.3.3.2.3.3" xref="S3.Ex12.m1.3.3.2.3.3.cmml">0</mn></msub><mo id="S3.Ex12.m1.3.3.2.2" xref="S3.Ex12.m1.3.3.2.2.cmml">⁢</mo><mrow id="S3.Ex12.m1.3.3.2.1.1" xref="S3.Ex12.m1.3.3.2.1.1.1.cmml"><mo id="S3.Ex12.m1.3.3.2.1.1.2" stretchy="false" xref="S3.Ex12.m1.3.3.2.1.1.1.cmml">(</mo><mrow id="S3.Ex12.m1.3.3.2.1.1.1" xref="S3.Ex12.m1.3.3.2.1.1.1.cmml"><mi id="S3.Ex12.m1.3.3.2.1.1.1.2" xref="S3.Ex12.m1.3.3.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.Ex12.m1.3.3.2.1.1.1.1" xref="S3.Ex12.m1.3.3.2.1.1.1.1.cmml">|</mo><mi id="S3.Ex12.m1.3.3.2.1.1.1.3" xref="S3.Ex12.m1.3.3.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.Ex12.m1.3.3.2.1.1.3" stretchy="false" xref="S3.Ex12.m1.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">β</mi></mrow><mo id="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.Ex12.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="S3.Ex12.m1.4.4.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.Ex12.m1.4.4.1.1.3" xref="S3.Ex12.m1.4.4.1.1.3.cmml">2</mn><mn id="S3.Ex12.m1.4.4.1.1.1.3" xref="S3.Ex12.m1.4.4.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex12.m1.4b"><apply id="S3.Ex12.m1.4.4.cmml" xref="S3.Ex12.m1.4.4"><minus id="S3.Ex12.m1.4.4.2.cmml" xref="S3.Ex12.m1.4.4"></minus><apply id="S3.Ex12.m1.4.4.1.cmml" xref="S3.Ex12.m1.4.4.1"><times id="S3.Ex12.m1.4.4.1.2.cmml" xref="S3.Ex12.m1.4.4.1.2"></times><apply id="S3.Ex12.m1.1.1.cmml" xref="S3.Ex12.m1.1.1"><divide id="S3.Ex12.m1.1.1.2.cmml" xref="S3.Ex12.m1.1.1"></divide><cn id="S3.Ex12.m1.1.1.3.cmml" type="integer" xref="S3.Ex12.m1.1.1.3">1</cn><apply id="S3.Ex12.m1.1.1.1.2.cmml" xref="S3.Ex12.m1.1.1.1.3"><abs id="S3.Ex12.m1.1.1.1.2.1.cmml" xref="S3.Ex12.m1.1.1.1.3.1"></abs><ci id="S3.Ex12.m1.1.1.1.1.cmml" xref="S3.Ex12.m1.1.1.1.1">ℬ</ci></apply></apply><apply id="S3.Ex12.m1.4.4.1.1.cmml" xref="S3.Ex12.m1.4.4.1.1"><csymbol cd="ambiguous" id="S3.Ex12.m1.4.4.1.1.2.cmml" xref="S3.Ex12.m1.4.4.1.1">subscript</csymbol><apply id="S3.Ex12.m1.4.4.1.1.1.cmml" xref="S3.Ex12.m1.4.4.1.1"><csymbol cd="ambiguous" id="S3.Ex12.m1.4.4.1.1.1.2.cmml" xref="S3.Ex12.m1.4.4.1.1">superscript</csymbol><apply id="S3.Ex12.m1.4.4.1.1.1.1.2.cmml" xref="S3.Ex12.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex12.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.Ex12.m1.4.4.1.1.1.1.1.2">norm</csymbol><apply id="S3.Ex12.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1"><ci id="S3.Ex12.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.2">𝔼</ci><apply id="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1"><times id="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.Ex12.m1.3.3.cmml" xref="S3.Ex12.m1.3.3"><divide id="S3.Ex12.m1.3.3.3.cmml" xref="S3.Ex12.m1.3.3"></divide><apply id="S3.Ex12.m1.2.2.1.cmml" xref="S3.Ex12.m1.2.2.1"><times id="S3.Ex12.m1.2.2.1.2.cmml" xref="S3.Ex12.m1.2.2.1.2"></times><apply id="S3.Ex12.m1.2.2.1.3.cmml" xref="S3.Ex12.m1.2.2.1.3"><ci id="S3.Ex12.m1.2.2.1.3.1.cmml" xref="S3.Ex12.m1.2.2.1.3.1">∇</ci><ci id="S3.Ex12.m1.2.2.1.3.2.cmml" xref="S3.Ex12.m1.2.2.1.3.2">𝜋</ci></apply><apply id="S3.Ex12.m1.2.2.1.1.1.1.cmml" xref="S3.Ex12.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.Ex12.m1.2.2.1.1.1.1.1.cmml" xref="S3.Ex12.m1.2.2.1.1.1.1.1">conditional</csymbol><ci id="S3.Ex12.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex12.m1.2.2.1.1.1.1.2">𝑎</ci><ci id="S3.Ex12.m1.2.2.1.1.1.1.3.cmml" xref="S3.Ex12.m1.2.2.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.Ex12.m1.3.3.2.cmml" xref="S3.Ex12.m1.3.3.2"><times id="S3.Ex12.m1.3.3.2.2.cmml" xref="S3.Ex12.m1.3.3.2.2"></times><apply id="S3.Ex12.m1.3.3.2.3.cmml" xref="S3.Ex12.m1.3.3.2.3"><csymbol cd="ambiguous" id="S3.Ex12.m1.3.3.2.3.1.cmml" xref="S3.Ex12.m1.3.3.2.3">subscript</csymbol><ci id="S3.Ex12.m1.3.3.2.3.2.cmml" xref="S3.Ex12.m1.3.3.2.3.2">𝜋</ci><cn id="S3.Ex12.m1.3.3.2.3.3.cmml" type="integer" xref="S3.Ex12.m1.3.3.2.3.3">0</cn></apply><apply id="S3.Ex12.m1.3.3.2.1.1.1.cmml" xref="S3.Ex12.m1.3.3.2.1.1"><csymbol cd="latexml" id="S3.Ex12.m1.3.3.2.1.1.1.1.cmml" xref="S3.Ex12.m1.3.3.2.1.1.1.1">conditional</csymbol><ci id="S3.Ex12.m1.3.3.2.1.1.1.2.cmml" xref="S3.Ex12.m1.3.3.2.1.1.1.2">𝑎</ci><ci id="S3.Ex12.m1.3.3.2.1.1.1.3.cmml" xref="S3.Ex12.m1.3.3.2.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑟</ci><ci id="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex12.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3">𝛽</ci></apply></apply></apply></apply></apply><cn id="S3.Ex12.m1.4.4.1.1.1.3.cmml" type="integer" xref="S3.Ex12.m1.4.4.1.1.1.3">2</cn></apply><cn id="S3.Ex12.m1.4.4.1.1.3.cmml" type="integer" xref="S3.Ex12.m1.4.4.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex12.m1.4c">\displaystyle\qquad\qquad\qquad-\frac{1}{\left|\mathcal{B}\right|}\|\mathop{%
\mathbb{E}}\left[\frac{\nabla\pi(a|x)}{\pi_{0}(a|x)}\left(r-\beta\right)\right%
]\|^{2}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex12.m1.4d">- divide start_ARG 1 end_ARG start_ARG | caligraphic_B | end_ARG ∥ blackboard_E [ divide start_ARG ∇ italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ( italic_r - italic_β ) ] ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E29"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(29)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname*{arg\,min}_{\beta}\frac{1}{\left|\mathcal{B}\right%
|}\mathop{\mathbb{E}}\left[\frac{\|\nabla\pi(a|x))\|^{2}_{2}}{\pi_{0}(a|x)^{2}%
}\left(r-\beta\right)^{2}\ \right]," class="ltx_math_unparsed" display="inline" id="S3.E29.m1.3"><semantics id="S3.E29.m1.3a"><mrow id="S3.E29.m1.3.3.1"><mrow id="S3.E29.m1.3.3.1.1"><mi id="S3.E29.m1.3.3.1.1.3"></mi><mo id="S3.E29.m1.3.3.1.1.2">=</mo><mrow id="S3.E29.m1.3.3.1.1.1"><mrow id="S3.E29.m1.3.3.1.1.1.3"><munder id="S3.E29.m1.3.3.1.1.1.3.1"><mrow id="S3.E29.m1.3.3.1.1.1.3.1.2"><mi id="S3.E29.m1.3.3.1.1.1.3.1.2.2">arg</mi><mo id="S3.E29.m1.3.3.1.1.1.3.1.2.1" lspace="0.170em">⁢</mo><mi id="S3.E29.m1.3.3.1.1.1.3.1.2.3">min</mi></mrow><mi id="S3.E29.m1.3.3.1.1.1.3.1.3">β</mi></munder><mo id="S3.E29.m1.3.3.1.1.1.3a">⁡</mo><mstyle displaystyle="true" id="S3.E29.m1.1.1"><mfrac id="S3.E29.m1.1.1a"><mn id="S3.E29.m1.1.1.3">1</mn><mrow id="S3.E29.m1.1.1.1.3"><mo id="S3.E29.m1.1.1.1.3.1">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E29.m1.1.1.1.1">ℬ</mi><mo id="S3.E29.m1.1.1.1.3.2">|</mo></mrow></mfrac></mstyle></mrow><mo id="S3.E29.m1.3.3.1.1.1.2" lspace="0.167em">⁢</mo><mrow id="S3.E29.m1.3.3.1.1.1.1"><mo id="S3.E29.m1.3.3.1.1.1.1.2" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S3.E29.m1.3.3.1.1.1.1.1.1"><mo id="S3.E29.m1.3.3.1.1.1.1.1.1.2">[</mo><mrow id="S3.E29.m1.3.3.1.1.1.1.1.1.1"><mstyle displaystyle="true" id="S3.E29.m1.2.2"><mfrac id="S3.E29.m1.2.2a"><mrow id="S3.E29.m1.2.2.3"><mo id="S3.E29.m1.2.2.3.1" rspace="0.167em">∥</mo><mo id="S3.E29.m1.2.2.3.2" rspace="0.167em">∇</mo><mi id="S3.E29.m1.2.2.3.3">π</mi><mrow id="S3.E29.m1.2.2.3.4"><mo id="S3.E29.m1.2.2.3.4.1" stretchy="false">(</mo><mi id="S3.E29.m1.2.2.3.4.2">a</mi><mo fence="false" id="S3.E29.m1.2.2.3.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E29.m1.2.2.3.4.4">x</mi><mo id="S3.E29.m1.2.2.3.4.5" stretchy="false">)</mo></mrow><mo id="S3.E29.m1.2.2.3.5" stretchy="false">)</mo><mo id="S3.E29.m1.2.2.3.6" lspace="0em" rspace="0.167em">∥</mo><msup id="S3.E29.m1.2.2.3.7"><mi id="S3.E29.m1.2.2.3.7a"></mi><mn id="S3.E29.m1.2.2.3.7.1">2</mn></msup><msub id="S3.E29.m1.2.2.3.8"><mi id="S3.E29.m1.2.2.3.8a"></mi><mn id="S3.E29.m1.2.2.3.8.1">2</mn></msub></mrow><mrow id="S3.E29.m1.2.2.1"><msub id="S3.E29.m1.2.2.1.3"><mi id="S3.E29.m1.2.2.1.3.2">π</mi><mn id="S3.E29.m1.2.2.1.3.3">0</mn></msub><mo id="S3.E29.m1.2.2.1.2">⁢</mo><msup id="S3.E29.m1.2.2.1.1"><mrow id="S3.E29.m1.2.2.1.1.1.1"><mo id="S3.E29.m1.2.2.1.1.1.1.2" stretchy="false">(</mo><mrow id="S3.E29.m1.2.2.1.1.1.1.1"><mi id="S3.E29.m1.2.2.1.1.1.1.1.2">a</mi><mo fence="false" id="S3.E29.m1.2.2.1.1.1.1.1.1">|</mo><mi id="S3.E29.m1.2.2.1.1.1.1.1.3">x</mi></mrow><mo id="S3.E29.m1.2.2.1.1.1.1.3" stretchy="false">)</mo></mrow><mn id="S3.E29.m1.2.2.1.1.3">2</mn></msup></mrow></mfrac></mstyle><mo id="S3.E29.m1.3.3.1.1.1.1.1.1.1.2">⁢</mo><msup id="S3.E29.m1.3.3.1.1.1.1.1.1.1.1"><mrow id="S3.E29.m1.3.3.1.1.1.1.1.1.1.1.1.1"><mo id="S3.E29.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">(</mo><mrow id="S3.E29.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><mi id="S3.E29.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">r</mi><mo id="S3.E29.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1">−</mo><mi id="S3.E29.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">β</mi></mrow><mo id="S3.E29.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">)</mo></mrow><mn id="S3.E29.m1.3.3.1.1.1.1.1.1.1.1.3">2</mn></msup></mrow><mo id="S3.E29.m1.3.3.1.1.1.1.1.1.3">]</mo></mrow></mrow></mrow></mrow><mo id="S3.E29.m1.3.3.1.2">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E29.m1.3b">\displaystyle=\operatorname*{arg\,min}_{\beta}\frac{1}{\left|\mathcal{B}\right%
|}\mathop{\mathbb{E}}\left[\frac{\|\nabla\pi(a|x))\|^{2}_{2}}{\pi_{0}(a|x)^{2}%
}\left(r-\beta\right)^{2}\ \right],</annotation><annotation encoding="application/x-llamapun" id="S3.E29.m1.3c">= start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT italic_β end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG | caligraphic_B | end_ARG blackboard_E [ divide start_ARG ∥ ∇ italic_π ( italic_a | italic_x ) ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ( italic_r - italic_β ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.1">where we can ignore the second term of the variance in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E28" title="In 3.2. Minimizing gradient variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">28</span></a>, since it is independent of <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_β</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Mohamed et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib45" title="">2020</a>, Eq. 12)</cite>. The optimal baseline can be obtained by solving for:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E30">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(30)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{\partial\mathrm{Var}\left(\nabla(\widehat{V}_{\beta\text{-}{\rm IPS}}(%
\pi,\mathcal{B}))\right)}{\partial\beta}=\frac{2}{\left|\mathcal{B}\right|}%
\mathop{\mathbb{E}}\left[\frac{\|\nabla\pi(a|x))\|^{2}_{2}}{\pi_{0}(a|x)^{2}}%
\left(\beta-r\right)\right]=0," class="ltx_math_unparsed" display="block" id="S3.E30.m1.7"><semantics id="S3.E30.m1.7a"><mrow id="S3.E30.m1.7.7.1"><mrow id="S3.E30.m1.7.7.1.1"><mfrac id="S3.E30.m1.4.4"><mrow id="S3.E30.m1.4.4.4"><mo id="S3.E30.m1.4.4.4.5" rspace="0em">∂</mo><mrow id="S3.E30.m1.4.4.4.4"><mi id="S3.E30.m1.4.4.4.4.3">Var</mi><mo id="S3.E30.m1.4.4.4.4.2">⁢</mo><mrow id="S3.E30.m1.4.4.4.4.1.1"><mo id="S3.E30.m1.4.4.4.4.1.1.2">(</mo><mrow id="S3.E30.m1.4.4.4.4.1.1.1.1"><mo id="S3.E30.m1.3.3.3.3">∇</mo><mrow id="S3.E30.m1.4.4.4.4.1.1.1.1.1"><mo id="S3.E30.m1.4.4.4.4.1.1.1.1.1.2" stretchy="false">(</mo><mrow id="S3.E30.m1.4.4.4.4.1.1.1.1.1.1"><msub id="S3.E30.m1.4.4.4.4.1.1.1.1.1.1.2"><mover accent="true" id="S3.E30.m1.4.4.4.4.1.1.1.1.1.1.2.2"><mi id="S3.E30.m1.4.4.4.4.1.1.1.1.1.1.2.2.2">V</mi><mo id="S3.E30.m1.4.4.4.4.1.1.1.1.1.1.2.2.1">^</mo></mover><mrow id="S3.E30.m1.4.4.4.4.1.1.1.1.1.1.2.3"><mi id="S3.E30.m1.4.4.4.4.1.1.1.1.1.1.2.3.2">β</mi><mo id="S3.E30.m1.4.4.4.4.1.1.1.1.1.1.2.3.1">⁢</mo><mtext id="S3.E30.m1.4.4.4.4.1.1.1.1.1.1.2.3.3">-</mtext><mo id="S3.E30.m1.4.4.4.4.1.1.1.1.1.1.2.3.1a">⁢</mo><mi id="S3.E30.m1.4.4.4.4.1.1.1.1.1.1.2.3.4">IPS</mi></mrow></msub><mo id="S3.E30.m1.4.4.4.4.1.1.1.1.1.1.1">⁢</mo><mrow id="S3.E30.m1.4.4.4.4.1.1.1.1.1.1.3.2"><mo id="S3.E30.m1.4.4.4.4.1.1.1.1.1.1.3.2.1" stretchy="false">(</mo><mi id="S3.E30.m1.1.1.1.1">π</mi><mo id="S3.E30.m1.4.4.4.4.1.1.1.1.1.1.3.2.2">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E30.m1.2.2.2.2">ℬ</mi><mo id="S3.E30.m1.4.4.4.4.1.1.1.1.1.1.3.2.3" stretchy="false">)</mo></mrow></mrow><mo id="S3.E30.m1.4.4.4.4.1.1.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mo id="S3.E30.m1.4.4.4.4.1.1.3">)</mo></mrow></mrow></mrow><mrow id="S3.E30.m1.4.4.6"><mo id="S3.E30.m1.4.4.6.1" rspace="0em">∂</mo><mi id="S3.E30.m1.4.4.6.2">β</mi></mrow></mfrac><mo id="S3.E30.m1.7.7.1.1.3">=</mo><mrow id="S3.E30.m1.7.7.1.1.1"><mfrac id="S3.E30.m1.5.5"><mn id="S3.E30.m1.5.5.3">2</mn><mrow id="S3.E30.m1.5.5.1.3"><mo id="S3.E30.m1.5.5.1.3.1">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E30.m1.5.5.1.1">ℬ</mi><mo id="S3.E30.m1.5.5.1.3.2">|</mo></mrow></mfrac><mo id="S3.E30.m1.7.7.1.1.1.2" lspace="0.167em">⁢</mo><mrow id="S3.E30.m1.7.7.1.1.1.1"><mo id="S3.E30.m1.7.7.1.1.1.1.2" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S3.E30.m1.7.7.1.1.1.1.1.1"><mo id="S3.E30.m1.7.7.1.1.1.1.1.1.2">[</mo><mrow id="S3.E30.m1.7.7.1.1.1.1.1.1.1"><mfrac id="S3.E30.m1.6.6"><mrow id="S3.E30.m1.6.6.3"><mo id="S3.E30.m1.6.6.3.1" rspace="0.167em">∥</mo><mo id="S3.E30.m1.6.6.3.2" rspace="0.167em">∇</mo><mi id="S3.E30.m1.6.6.3.3">π</mi><mrow id="S3.E30.m1.6.6.3.4"><mo id="S3.E30.m1.6.6.3.4.1" stretchy="false">(</mo><mi id="S3.E30.m1.6.6.3.4.2">a</mi><mo fence="false" id="S3.E30.m1.6.6.3.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E30.m1.6.6.3.4.4">x</mi><mo id="S3.E30.m1.6.6.3.4.5" stretchy="false">)</mo></mrow><mo id="S3.E30.m1.6.6.3.5" stretchy="false">)</mo><mo id="S3.E30.m1.6.6.3.6" lspace="0em" rspace="0.167em">∥</mo><msup id="S3.E30.m1.6.6.3.7"><mi id="S3.E30.m1.6.6.3.7a"></mi><mn id="S3.E30.m1.6.6.3.7.1">2</mn></msup><msub id="S3.E30.m1.6.6.3.8"><mi id="S3.E30.m1.6.6.3.8a"></mi><mn id="S3.E30.m1.6.6.3.8.1">2</mn></msub></mrow><mrow id="S3.E30.m1.6.6.1"><msub id="S3.E30.m1.6.6.1.3"><mi id="S3.E30.m1.6.6.1.3.2">π</mi><mn id="S3.E30.m1.6.6.1.3.3">0</mn></msub><mo id="S3.E30.m1.6.6.1.2">⁢</mo><msup id="S3.E30.m1.6.6.1.1"><mrow id="S3.E30.m1.6.6.1.1.1.1"><mo id="S3.E30.m1.6.6.1.1.1.1.2" stretchy="false">(</mo><mrow id="S3.E30.m1.6.6.1.1.1.1.1"><mi id="S3.E30.m1.6.6.1.1.1.1.1.2">a</mi><mo fence="false" id="S3.E30.m1.6.6.1.1.1.1.1.1">|</mo><mi id="S3.E30.m1.6.6.1.1.1.1.1.3">x</mi></mrow><mo id="S3.E30.m1.6.6.1.1.1.1.3" stretchy="false">)</mo></mrow><mn id="S3.E30.m1.6.6.1.1.3">2</mn></msup></mrow></mfrac><mo id="S3.E30.m1.7.7.1.1.1.1.1.1.1.2">⁢</mo><mrow id="S3.E30.m1.7.7.1.1.1.1.1.1.1.1.1"><mo id="S3.E30.m1.7.7.1.1.1.1.1.1.1.1.1.2">(</mo><mrow id="S3.E30.m1.7.7.1.1.1.1.1.1.1.1.1.1"><mi id="S3.E30.m1.7.7.1.1.1.1.1.1.1.1.1.1.2">β</mi><mo id="S3.E30.m1.7.7.1.1.1.1.1.1.1.1.1.1.1">−</mo><mi id="S3.E30.m1.7.7.1.1.1.1.1.1.1.1.1.1.3">r</mi></mrow><mo id="S3.E30.m1.7.7.1.1.1.1.1.1.1.1.1.3">)</mo></mrow></mrow><mo id="S3.E30.m1.7.7.1.1.1.1.1.1.3">]</mo></mrow></mrow></mrow><mo id="S3.E30.m1.7.7.1.1.4">=</mo><mn id="S3.E30.m1.7.7.1.1.5">0</mn></mrow><mo id="S3.E30.m1.7.7.1.2">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E30.m1.7b">\frac{\partial\mathrm{Var}\left(\nabla(\widehat{V}_{\beta\text{-}{\rm IPS}}(%
\pi,\mathcal{B}))\right)}{\partial\beta}=\frac{2}{\left|\mathcal{B}\right|}%
\mathop{\mathbb{E}}\left[\frac{\|\nabla\pi(a|x))\|^{2}_{2}}{\pi_{0}(a|x)^{2}}%
\left(\beta-r\right)\right]=0,</annotation><annotation encoding="application/x-llamapun" id="S3.E30.m1.7c">divide start_ARG ∂ roman_Var ( ∇ ( over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_β - roman_IPS end_POSTSUBSCRIPT ( italic_π , caligraphic_B ) ) ) end_ARG start_ARG ∂ italic_β end_ARG = divide start_ARG 2 end_ARG start_ARG | caligraphic_B | end_ARG blackboard_E [ divide start_ARG ∥ ∇ italic_π ( italic_a | italic_x ) ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ( italic_β - italic_r ) ] = 0 ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.3">which results in the following optimal baseline:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E31">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(31)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\beta^{*}=\frac{\mathop{\mathbb{E}}\limits_{x,a\sim\pi_{0},r}\left[\frac{\|%
\nabla\pi(a|x))\|^{2}_{2}}{\pi_{0}(a|x)^{2}}r(a,x)\right]}{\mathop{\mathbb{E}}%
\limits_{x,a\sim\pi_{0},r}\left[\frac{\|\nabla\pi(a|x))\|^{2}_{2}}{\pi_{0}(a|x%
)^{2}}\right]}," class="ltx_math_unparsed" display="block" id="S3.E31.m1.14"><semantics id="S3.E31.m1.14a"><mrow id="S3.E31.m1.14.14.1"><mrow id="S3.E31.m1.14.14.1.1"><msup id="S3.E31.m1.14.14.1.1.2"><mi id="S3.E31.m1.14.14.1.1.2.2">β</mi><mo id="S3.E31.m1.14.14.1.1.2.3">∗</mo></msup><mo id="S3.E31.m1.14.14.1.1.1">=</mo><mfrac id="S3.E31.m1.13.13"><mrow id="S3.E31.m1.8.8.8"><munder id="S3.E31.m1.8.8.8.9"><mo id="S3.E31.m1.8.8.8.9.2" movablelimits="false">𝔼</mo><mrow id="S3.E31.m1.4.4.4.4.4.4"><mrow id="S3.E31.m1.4.4.4.4.4.4.1"><mrow id="S3.E31.m1.4.4.4.4.4.4.1.2.2"><mi id="S3.E31.m1.1.1.1.1.1.1">x</mi><mo id="S3.E31.m1.4.4.4.4.4.4.1.2.2.1">,</mo><mi id="S3.E31.m1.2.2.2.2.2.2">a</mi></mrow><mo id="S3.E31.m1.4.4.4.4.4.4.1.1">∼</mo><msub id="S3.E31.m1.4.4.4.4.4.4.1.3"><mi id="S3.E31.m1.4.4.4.4.4.4.1.3.2">π</mi><mn id="S3.E31.m1.4.4.4.4.4.4.1.3.3">0</mn></msub></mrow><mo id="S3.E31.m1.4.4.4.4.4.4.2">,</mo><mi id="S3.E31.m1.3.3.3.3.3.3">r</mi></mrow></munder><mrow id="S3.E31.m1.8.8.8.8.1"><mo id="S3.E31.m1.8.8.8.8.1.2" lspace="0em">[</mo><mrow id="S3.E31.m1.8.8.8.8.1.1"><mfrac id="S3.E31.m1.5.5.5.5"><mrow id="S3.E31.m1.5.5.5.5.3"><mo id="S3.E31.m1.5.5.5.5.3.1" rspace="0.167em">∥</mo><mo id="S3.E31.m1.5.5.5.5.3.2" rspace="0.167em">∇</mo><mi id="S3.E31.m1.5.5.5.5.3.3">π</mi><mrow id="S3.E31.m1.5.5.5.5.3.4"><mo id="S3.E31.m1.5.5.5.5.3.4.1" stretchy="false">(</mo><mi id="S3.E31.m1.5.5.5.5.3.4.2">a</mi><mo fence="false" id="S3.E31.m1.5.5.5.5.3.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E31.m1.5.5.5.5.3.4.4">x</mi><mo id="S3.E31.m1.5.5.5.5.3.4.5" stretchy="false">)</mo></mrow><mo id="S3.E31.m1.5.5.5.5.3.5" stretchy="false">)</mo><mo id="S3.E31.m1.5.5.5.5.3.6" lspace="0em" rspace="0.167em">∥</mo><msup id="S3.E31.m1.5.5.5.5.3.7"><mi id="S3.E31.m1.5.5.5.5.3.7a"></mi><mn id="S3.E31.m1.5.5.5.5.3.7.1">2</mn></msup><msub id="S3.E31.m1.5.5.5.5.3.8"><mi id="S3.E31.m1.5.5.5.5.3.8a"></mi><mn id="S3.E31.m1.5.5.5.5.3.8.1">2</mn></msub></mrow><mrow id="S3.E31.m1.5.5.5.5.1"><msub id="S3.E31.m1.5.5.5.5.1.3"><mi id="S3.E31.m1.5.5.5.5.1.3.2">π</mi><mn id="S3.E31.m1.5.5.5.5.1.3.3">0</mn></msub><mo id="S3.E31.m1.5.5.5.5.1.2">⁢</mo><msup id="S3.E31.m1.5.5.5.5.1.1"><mrow id="S3.E31.m1.5.5.5.5.1.1.1.1"><mo id="S3.E31.m1.5.5.5.5.1.1.1.1.2" stretchy="false">(</mo><mrow id="S3.E31.m1.5.5.5.5.1.1.1.1.1"><mi id="S3.E31.m1.5.5.5.5.1.1.1.1.1.2">a</mi><mo fence="false" id="S3.E31.m1.5.5.5.5.1.1.1.1.1.1">|</mo><mi id="S3.E31.m1.5.5.5.5.1.1.1.1.1.3">x</mi></mrow><mo id="S3.E31.m1.5.5.5.5.1.1.1.1.3" stretchy="false">)</mo></mrow><mn id="S3.E31.m1.5.5.5.5.1.1.3">2</mn></msup></mrow></mfrac><mo id="S3.E31.m1.8.8.8.8.1.1.1">⁢</mo><mi id="S3.E31.m1.8.8.8.8.1.1.2">r</mi><mo id="S3.E31.m1.8.8.8.8.1.1.1a">⁢</mo><mrow id="S3.E31.m1.8.8.8.8.1.1.3.2"><mo id="S3.E31.m1.8.8.8.8.1.1.3.2.1" stretchy="false">(</mo><mi id="S3.E31.m1.6.6.6.6">a</mi><mo id="S3.E31.m1.8.8.8.8.1.1.3.2.2">,</mo><mi id="S3.E31.m1.7.7.7.7">x</mi><mo id="S3.E31.m1.8.8.8.8.1.1.3.2.3" stretchy="false">)</mo></mrow></mrow><mo id="S3.E31.m1.8.8.8.8.1.3">]</mo></mrow></mrow><mrow id="S3.E31.m1.13.13.13"><munder id="S3.E31.m1.13.13.13.6"><mo id="S3.E31.m1.13.13.13.6.2" movablelimits="false">𝔼</mo><mrow id="S3.E31.m1.12.12.12.4.4.4"><mrow id="S3.E31.m1.12.12.12.4.4.4.1"><mrow id="S3.E31.m1.12.12.12.4.4.4.1.2.2"><mi id="S3.E31.m1.9.9.9.1.1.1">x</mi><mo id="S3.E31.m1.12.12.12.4.4.4.1.2.2.1">,</mo><mi id="S3.E31.m1.10.10.10.2.2.2">a</mi></mrow><mo id="S3.E31.m1.12.12.12.4.4.4.1.1">∼</mo><msub id="S3.E31.m1.12.12.12.4.4.4.1.3"><mi id="S3.E31.m1.12.12.12.4.4.4.1.3.2">π</mi><mn id="S3.E31.m1.12.12.12.4.4.4.1.3.3">0</mn></msub></mrow><mo id="S3.E31.m1.12.12.12.4.4.4.2">,</mo><mi id="S3.E31.m1.11.11.11.3.3.3">r</mi></mrow></munder><mrow id="S3.E31.m1.13.13.13.7.2"><mo id="S3.E31.m1.13.13.13.7.2.1" lspace="0em">[</mo><mfrac id="S3.E31.m1.13.13.13.5"><mrow id="S3.E31.m1.13.13.13.5.3"><mo id="S3.E31.m1.13.13.13.5.3.1" rspace="0.167em">∥</mo><mo id="S3.E31.m1.13.13.13.5.3.2" rspace="0.167em">∇</mo><mi id="S3.E31.m1.13.13.13.5.3.3">π</mi><mrow id="S3.E31.m1.13.13.13.5.3.4"><mo id="S3.E31.m1.13.13.13.5.3.4.1" stretchy="false">(</mo><mi id="S3.E31.m1.13.13.13.5.3.4.2">a</mi><mo fence="false" id="S3.E31.m1.13.13.13.5.3.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E31.m1.13.13.13.5.3.4.4">x</mi><mo id="S3.E31.m1.13.13.13.5.3.4.5" stretchy="false">)</mo></mrow><mo id="S3.E31.m1.13.13.13.5.3.5" stretchy="false">)</mo><mo id="S3.E31.m1.13.13.13.5.3.6" lspace="0em" rspace="0.167em">∥</mo><msup id="S3.E31.m1.13.13.13.5.3.7"><mi id="S3.E31.m1.13.13.13.5.3.7a"></mi><mn id="S3.E31.m1.13.13.13.5.3.7.1">2</mn></msup><msub id="S3.E31.m1.13.13.13.5.3.8"><mi id="S3.E31.m1.13.13.13.5.3.8a"></mi><mn id="S3.E31.m1.13.13.13.5.3.8.1">2</mn></msub></mrow><mrow id="S3.E31.m1.13.13.13.5.1"><msub id="S3.E31.m1.13.13.13.5.1.3"><mi id="S3.E31.m1.13.13.13.5.1.3.2">π</mi><mn id="S3.E31.m1.13.13.13.5.1.3.3">0</mn></msub><mo id="S3.E31.m1.13.13.13.5.1.2">⁢</mo><msup id="S3.E31.m1.13.13.13.5.1.1"><mrow id="S3.E31.m1.13.13.13.5.1.1.1.1"><mo id="S3.E31.m1.13.13.13.5.1.1.1.1.2" stretchy="false">(</mo><mrow id="S3.E31.m1.13.13.13.5.1.1.1.1.1"><mi id="S3.E31.m1.13.13.13.5.1.1.1.1.1.2">a</mi><mo fence="false" id="S3.E31.m1.13.13.13.5.1.1.1.1.1.1">|</mo><mi id="S3.E31.m1.13.13.13.5.1.1.1.1.1.3">x</mi></mrow><mo id="S3.E31.m1.13.13.13.5.1.1.1.1.3" stretchy="false">)</mo></mrow><mn id="S3.E31.m1.13.13.13.5.1.1.3">2</mn></msup></mrow></mfrac><mo id="S3.E31.m1.13.13.13.7.2.2">]</mo></mrow></mrow></mfrac></mrow><mo id="S3.E31.m1.14.14.1.2">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E31.m1.14b">\beta^{*}=\frac{\mathop{\mathbb{E}}\limits_{x,a\sim\pi_{0},r}\left[\frac{\|%
\nabla\pi(a|x))\|^{2}_{2}}{\pi_{0}(a|x)^{2}}r(a,x)\right]}{\mathop{\mathbb{E}}%
\limits_{x,a\sim\pi_{0},r}\left[\frac{\|\nabla\pi(a|x))\|^{2}_{2}}{\pi_{0}(a|x%
)^{2}}\right]},</annotation><annotation encoding="application/x-llamapun" id="S3.E31.m1.14c">italic_β start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = divide start_ARG blackboard_E start_POSTSUBSCRIPT italic_x , italic_a ∼ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_r end_POSTSUBSCRIPT [ divide start_ARG ∥ ∇ italic_π ( italic_a | italic_x ) ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG italic_r ( italic_a , italic_x ) ] end_ARG start_ARG blackboard_E start_POSTSUBSCRIPT italic_x , italic_a ∼ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_r end_POSTSUBSCRIPT [ divide start_ARG ∥ ∇ italic_π ( italic_a | italic_x ) ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ] end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.4">with its empirical estimate given by:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E32">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(32)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widehat{\beta^{*}}=\frac{\sum_{(x,a,r)\in\mathcal{B}}\left[\frac{\|\nabla\pi(%
a|x))\|^{2}_{2}}{\pi_{0}(a|x)^{2}}r\right]}{\sum_{(x,a,r)\in\mathcal{B}}\left[%
\frac{\|\nabla\pi(a|x))\|^{2}_{2}}{\pi_{0}(a|x)^{2}}\right]}." class="ltx_math_unparsed" display="block" id="S3.E32.m1.10"><semantics id="S3.E32.m1.10a"><mrow id="S3.E32.m1.10.10.1"><mrow id="S3.E32.m1.10.10.1.1"><mover accent="true" id="S3.E32.m1.10.10.1.1.2"><msup id="S3.E32.m1.10.10.1.1.2.2"><mi id="S3.E32.m1.10.10.1.1.2.2.2">β</mi><mo id="S3.E32.m1.10.10.1.1.2.2.3">∗</mo></msup><mo id="S3.E32.m1.10.10.1.1.2.1">^</mo></mover><mo id="S3.E32.m1.10.10.1.1.1">=</mo><mfrac id="S3.E32.m1.9.9"><mrow id="S3.E32.m1.5.5.5"><msub id="S3.E32.m1.5.5.5.6"><mo id="S3.E32.m1.5.5.5.6.2">∑</mo><mrow id="S3.E32.m1.3.3.3.3.3"><mrow id="S3.E32.m1.3.3.3.3.3.5.2"><mo id="S3.E32.m1.3.3.3.3.3.5.2.1" stretchy="false">(</mo><mi id="S3.E32.m1.1.1.1.1.1.1">x</mi><mo id="S3.E32.m1.3.3.3.3.3.5.2.2">,</mo><mi id="S3.E32.m1.2.2.2.2.2.2">a</mi><mo id="S3.E32.m1.3.3.3.3.3.5.2.3">,</mo><mi id="S3.E32.m1.3.3.3.3.3.3">r</mi><mo id="S3.E32.m1.3.3.3.3.3.5.2.4" stretchy="false">)</mo></mrow><mo id="S3.E32.m1.3.3.3.3.3.4">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E32.m1.3.3.3.3.3.6">ℬ</mi></mrow></msub><mrow id="S3.E32.m1.5.5.5.5.1"><mo id="S3.E32.m1.5.5.5.5.1.2" lspace="0em">[</mo><mrow id="S3.E32.m1.5.5.5.5.1.1"><mfrac id="S3.E32.m1.4.4.4.4"><mrow id="S3.E32.m1.4.4.4.4.3"><mo id="S3.E32.m1.4.4.4.4.3.1" rspace="0.167em">∥</mo><mo id="S3.E32.m1.4.4.4.4.3.2" rspace="0.167em">∇</mo><mi id="S3.E32.m1.4.4.4.4.3.3">π</mi><mrow id="S3.E32.m1.4.4.4.4.3.4"><mo id="S3.E32.m1.4.4.4.4.3.4.1" stretchy="false">(</mo><mi id="S3.E32.m1.4.4.4.4.3.4.2">a</mi><mo fence="false" id="S3.E32.m1.4.4.4.4.3.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E32.m1.4.4.4.4.3.4.4">x</mi><mo id="S3.E32.m1.4.4.4.4.3.4.5" stretchy="false">)</mo></mrow><mo id="S3.E32.m1.4.4.4.4.3.5" stretchy="false">)</mo><mo id="S3.E32.m1.4.4.4.4.3.6" lspace="0em" rspace="0.167em">∥</mo><msup id="S3.E32.m1.4.4.4.4.3.7"><mi id="S3.E32.m1.4.4.4.4.3.7a"></mi><mn id="S3.E32.m1.4.4.4.4.3.7.1">2</mn></msup><msub id="S3.E32.m1.4.4.4.4.3.8"><mi id="S3.E32.m1.4.4.4.4.3.8a"></mi><mn id="S3.E32.m1.4.4.4.4.3.8.1">2</mn></msub></mrow><mrow id="S3.E32.m1.4.4.4.4.1"><msub id="S3.E32.m1.4.4.4.4.1.3"><mi id="S3.E32.m1.4.4.4.4.1.3.2">π</mi><mn id="S3.E32.m1.4.4.4.4.1.3.3">0</mn></msub><mo id="S3.E32.m1.4.4.4.4.1.2">⁢</mo><msup id="S3.E32.m1.4.4.4.4.1.1"><mrow id="S3.E32.m1.4.4.4.4.1.1.1.1"><mo id="S3.E32.m1.4.4.4.4.1.1.1.1.2" stretchy="false">(</mo><mrow id="S3.E32.m1.4.4.4.4.1.1.1.1.1"><mi id="S3.E32.m1.4.4.4.4.1.1.1.1.1.2">a</mi><mo fence="false" id="S3.E32.m1.4.4.4.4.1.1.1.1.1.1">|</mo><mi id="S3.E32.m1.4.4.4.4.1.1.1.1.1.3">x</mi></mrow><mo id="S3.E32.m1.4.4.4.4.1.1.1.1.3" stretchy="false">)</mo></mrow><mn id="S3.E32.m1.4.4.4.4.1.1.3">2</mn></msup></mrow></mfrac><mo id="S3.E32.m1.5.5.5.5.1.1.1">⁢</mo><mi id="S3.E32.m1.5.5.5.5.1.1.2">r</mi></mrow><mo id="S3.E32.m1.5.5.5.5.1.3">]</mo></mrow></mrow><mrow id="S3.E32.m1.9.9.9"><msub id="S3.E32.m1.9.9.9.5"><mo id="S3.E32.m1.9.9.9.5.2">∑</mo><mrow id="S3.E32.m1.8.8.8.3.3"><mrow id="S3.E32.m1.8.8.8.3.3.5.2"><mo id="S3.E32.m1.8.8.8.3.3.5.2.1" stretchy="false">(</mo><mi id="S3.E32.m1.6.6.6.1.1.1">x</mi><mo id="S3.E32.m1.8.8.8.3.3.5.2.2">,</mo><mi id="S3.E32.m1.7.7.7.2.2.2">a</mi><mo id="S3.E32.m1.8.8.8.3.3.5.2.3">,</mo><mi id="S3.E32.m1.8.8.8.3.3.3">r</mi><mo id="S3.E32.m1.8.8.8.3.3.5.2.4" stretchy="false">)</mo></mrow><mo id="S3.E32.m1.8.8.8.3.3.4">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E32.m1.8.8.8.3.3.6">ℬ</mi></mrow></msub><mrow id="S3.E32.m1.9.9.9.6.2"><mo id="S3.E32.m1.9.9.9.6.2.1" lspace="0em">[</mo><mfrac id="S3.E32.m1.9.9.9.4"><mrow id="S3.E32.m1.9.9.9.4.3"><mo id="S3.E32.m1.9.9.9.4.3.1" rspace="0.167em">∥</mo><mo id="S3.E32.m1.9.9.9.4.3.2" rspace="0.167em">∇</mo><mi id="S3.E32.m1.9.9.9.4.3.3">π</mi><mrow id="S3.E32.m1.9.9.9.4.3.4"><mo id="S3.E32.m1.9.9.9.4.3.4.1" stretchy="false">(</mo><mi id="S3.E32.m1.9.9.9.4.3.4.2">a</mi><mo fence="false" id="S3.E32.m1.9.9.9.4.3.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E32.m1.9.9.9.4.3.4.4">x</mi><mo id="S3.E32.m1.9.9.9.4.3.4.5" stretchy="false">)</mo></mrow><mo id="S3.E32.m1.9.9.9.4.3.5" stretchy="false">)</mo><mo id="S3.E32.m1.9.9.9.4.3.6" lspace="0em" rspace="0.167em">∥</mo><msup id="S3.E32.m1.9.9.9.4.3.7"><mi id="S3.E32.m1.9.9.9.4.3.7a"></mi><mn id="S3.E32.m1.9.9.9.4.3.7.1">2</mn></msup><msub id="S3.E32.m1.9.9.9.4.3.8"><mi id="S3.E32.m1.9.9.9.4.3.8a"></mi><mn id="S3.E32.m1.9.9.9.4.3.8.1">2</mn></msub></mrow><mrow id="S3.E32.m1.9.9.9.4.1"><msub id="S3.E32.m1.9.9.9.4.1.3"><mi id="S3.E32.m1.9.9.9.4.1.3.2">π</mi><mn id="S3.E32.m1.9.9.9.4.1.3.3">0</mn></msub><mo id="S3.E32.m1.9.9.9.4.1.2">⁢</mo><msup id="S3.E32.m1.9.9.9.4.1.1"><mrow id="S3.E32.m1.9.9.9.4.1.1.1.1"><mo id="S3.E32.m1.9.9.9.4.1.1.1.1.2" stretchy="false">(</mo><mrow id="S3.E32.m1.9.9.9.4.1.1.1.1.1"><mi id="S3.E32.m1.9.9.9.4.1.1.1.1.1.2">a</mi><mo fence="false" id="S3.E32.m1.9.9.9.4.1.1.1.1.1.1">|</mo><mi id="S3.E32.m1.9.9.9.4.1.1.1.1.1.3">x</mi></mrow><mo id="S3.E32.m1.9.9.9.4.1.1.1.1.3" stretchy="false">)</mo></mrow><mn id="S3.E32.m1.9.9.9.4.1.1.3">2</mn></msup></mrow></mfrac><mo id="S3.E32.m1.9.9.9.6.2.2">]</mo></mrow></mrow></mfrac></mrow><mo id="S3.E32.m1.10.10.1.2" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S3.E32.m1.10b">\widehat{\beta^{*}}=\frac{\sum_{(x,a,r)\in\mathcal{B}}\left[\frac{\|\nabla\pi(%
a|x))\|^{2}_{2}}{\pi_{0}(a|x)^{2}}r\right]}{\sum_{(x,a,r)\in\mathcal{B}}\left[%
\frac{\|\nabla\pi(a|x))\|^{2}_{2}}{\pi_{0}(a|x)^{2}}\right]}.</annotation><annotation encoding="application/x-llamapun" id="S3.E32.m1.10c">over^ start_ARG italic_β start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_ARG = divide start_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) ∈ caligraphic_B end_POSTSUBSCRIPT [ divide start_ARG ∥ ∇ italic_π ( italic_a | italic_x ) ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG italic_r ] end_ARG start_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_a , italic_r ) ∈ caligraphic_B end_POSTSUBSCRIPT [ divide start_ARG ∥ ∇ italic_π ( italic_a | italic_x ) ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ] end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">Note that this expectation is over actions sampled by the <em class="ltx_emph ltx_font_italic" id="S3.SS2.p2.1.1">logging</em> policy.
As a result, we can obtain Monte Carlo estimates of the corresponding expectations.
The derivation has high similarity with the on-policy case (cf. Section <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2.SS1" title="2.1. On-policy contextual bandits ‣ 2. Background and Related Work ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">2.1</span></a>) <cite class="ltx_cite ltx_citemacro_citep">(Greensmith et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib17" title="">2004</a>)</cite>.
Nevertheless, we are unaware of any work on off-policy learning that uses it.
<cite class="ltx_cite ltx_citemacro_citet">Joachims et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib34" title="">2018</a>)</cite> refer to the on-policy variant with: “<em class="ltx_emph ltx_font_italic" id="S3.SS2.p2.1.2">we cannot sample new roll-outs from the current policy under consideration, which means we cannot use the standard variance-optimal estimator used in REINFORCE</em>.”
Since the expectation is over actions sampled by the <em class="ltx_emph ltx_font_italic" id="S3.SS2.p2.1.3">logging</em> policy and not the <em class="ltx_emph ltx_font_italic" id="S3.SS2.p2.1.4">target</em> policy, we have shown that we do not need new roll-outs.
Thereby, our estimation strategy is a novel off-policy approach that estimates the variance-optimal baseline.</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="S3.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Theorem 1.</h6>
<div class="ltx_para" id="S3.Thmtheorem1.p1">
<p class="ltx_p" id="S3.Thmtheorem1.p1.3"><span class="ltx_text ltx_font_italic" id="S3.Thmtheorem1.p1.3.3">Within the family of gradient estimators with a global additive control variate, i.e., <math alttext="\beta" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.1.1.m1.1"><semantics id="S3.Thmtheorem1.p1.1.1.m1.1a"><mi id="S3.Thmtheorem1.p1.1.1.m1.1.1" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.1.1.m1.1b"><ci id="S3.Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.1.1.m1.1d">italic_β</annotation></semantics></math>-IPS (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E23" title="In 3.1. A unified off-policy estimator ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">23</span></a>), IPS (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2.E13" title="In 2.2. Off-policy estimation for general bandits ‣ 2. Background and Related Work ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">13</span></a>), BanditNet (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E24" title="In 3.1. A unified off-policy estimator ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">24</span></a>), and DR with a constant correction (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E25" title="In 3.1. A unified off-policy estimator ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">25</span></a>), <math alttext="\beta" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.2.2.m2.1"><semantics id="S3.Thmtheorem1.p1.2.2.m2.1a"><mi id="S3.Thmtheorem1.p1.2.2.m2.1.1" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.2.2.m2.1b"><ci id="S3.Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="S3.Thmtheorem1.p1.2.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.2.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.2.2.m2.1d">italic_β</annotation></semantics></math>-IPS with our proposed choice of <math alttext="\beta" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.3.3.m3.1"><semantics id="S3.Thmtheorem1.p1.3.3.m3.1a"><mi id="S3.Thmtheorem1.p1.3.3.m3.1.1" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.3.3.m3.1b"><ci id="S3.Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.3.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.3.3.m3.1d">italic_β</annotation></semantics></math> in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E31" title="In 3.2. Minimizing gradient variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">31</span></a> has minimal gradient variance.</span></p>
</div>
</div>
<div class="ltx_proof" id="S3.SS2.1">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S3.SS2.1.p1">
<p class="ltx_p" id="S3.SS2.1.p1.2">Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E30" title="In 3.2. Minimizing gradient variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">30</span></a> shows that the <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS2.1.p1.1.m1.1"><semantics id="S3.SS2.1.p1.1.m1.1a"><mi id="S3.SS2.1.p1.1.m1.1.1" xref="S3.SS2.1.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.1.p1.1.m1.1b"><ci id="S3.SS2.1.p1.1.m1.1.1.cmml" xref="S3.SS2.1.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.1.p1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.1.p1.1.m1.1d">italic_β</annotation></semantics></math> value in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E31" title="In 3.2. Minimizing gradient variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">31</span></a> attains a minimum.
Because the variance of the gradient estimate (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E28" title="In 3.2. Minimizing gradient variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">28</span></a>) is a quadratic function of <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS2.1.p1.2.m2.1"><semantics id="S3.SS2.1.p1.2.m2.1a"><mi id="S3.SS2.1.p1.2.m2.1.1" xref="S3.SS2.1.p1.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.1.p1.2.m2.1b"><ci id="S3.SS2.1.p1.2.m2.1.1.cmml" xref="S3.SS2.1.p1.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.1.p1.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.1.p1.2.m2.1d">italic_β</annotation></semantics></math>, and hence a convex function (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E29" title="In 3.2. Minimizing gradient variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">29</span></a>), it must be the global minimum for the gradient variance.
∎</p>
</div>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Minimizing estimation variance</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.3">Besides minimizing gradient variance, one can also aim to minimize the variance of estimation, i.e., the variance of the estimated value.
We note that the <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_β</annotation></semantics></math> value for minimizing estimation need not be the same value that minimizes gradient variance.
Furthermore, since <math alttext="\widehat{V}_{\beta\text{-}{\rm IPS}}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><msub id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mover accent="true" id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2.2" xref="S3.SS3.p1.2.m2.1.1.2.2.cmml">V</mi><mo id="S3.SS3.p1.2.m2.1.1.2.1" xref="S3.SS3.p1.2.m2.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml"><mi id="S3.SS3.p1.2.m2.1.1.3.2" xref="S3.SS3.p1.2.m2.1.1.3.2.cmml">β</mi><mo id="S3.SS3.p1.2.m2.1.1.3.1" xref="S3.SS3.p1.2.m2.1.1.3.1.cmml">⁢</mo><mtext id="S3.SS3.p1.2.m2.1.1.3.3" xref="S3.SS3.p1.2.m2.1.1.3.3a.cmml">-</mtext><mo id="S3.SS3.p1.2.m2.1.1.3.1a" xref="S3.SS3.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.2.m2.1.1.3.4" xref="S3.SS3.p1.2.m2.1.1.3.4.cmml">IPS</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><apply id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2"><ci id="S3.SS3.p1.2.m2.1.1.2.1.cmml" xref="S3.SS3.p1.2.m2.1.1.2.1">^</ci><ci id="S3.SS3.p1.2.m2.1.1.2.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2">𝑉</ci></apply><apply id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3"><times id="S3.SS3.p1.2.m2.1.1.3.1.cmml" xref="S3.SS3.p1.2.m2.1.1.3.1"></times><ci id="S3.SS3.p1.2.m2.1.1.3.2.cmml" xref="S3.SS3.p1.2.m2.1.1.3.2">𝛽</ci><ci id="S3.SS3.p1.2.m2.1.1.3.3a.cmml" xref="S3.SS3.p1.2.m2.1.1.3.3"><mtext id="S3.SS3.p1.2.m2.1.1.3.3.cmml" mathsize="70%" xref="S3.SS3.p1.2.m2.1.1.3.3">-</mtext></ci><ci id="S3.SS3.p1.2.m2.1.1.3.4.cmml" xref="S3.SS3.p1.2.m2.1.1.3.4">IPS</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\widehat{V}_{\beta\text{-}{\rm IPS}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_β - roman_IPS end_POSTSUBSCRIPT</annotation></semantics></math> is unbiased, any estimation error will entirely be driven by variance.
As a result, the value for <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_β</annotation></semantics></math> that results in minimal variance will also result in minimal estimation error:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Ax1.EGx7">
<tbody id="S3.E33"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(33)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\operatorname*{arg\,min}_{\beta}\mathrm{Var}\left(\widehat{V}_{%
\beta\text{-}{\rm IPS}}(\pi,\mathcal{D})\right)" class="ltx_Math" display="inline" id="S3.E33.m1.3"><semantics id="S3.E33.m1.3a"><mrow id="S3.E33.m1.3.3" xref="S3.E33.m1.3.3.cmml"><mrow id="S3.E33.m1.3.3.3" xref="S3.E33.m1.3.3.3.cmml"><munder id="S3.E33.m1.3.3.3.1" xref="S3.E33.m1.3.3.3.1.cmml"><mrow id="S3.E33.m1.3.3.3.1.2" xref="S3.E33.m1.3.3.3.1.2.cmml"><mi id="S3.E33.m1.3.3.3.1.2.2" xref="S3.E33.m1.3.3.3.1.2.2.cmml">arg</mi><mo id="S3.E33.m1.3.3.3.1.2.1" lspace="0.170em" xref="S3.E33.m1.3.3.3.1.2.1.cmml">⁢</mo><mi id="S3.E33.m1.3.3.3.1.2.3" xref="S3.E33.m1.3.3.3.1.2.3.cmml">min</mi></mrow><mi id="S3.E33.m1.3.3.3.1.3" xref="S3.E33.m1.3.3.3.1.3.cmml">β</mi></munder><mo id="S3.E33.m1.3.3.3a" lspace="0.167em" xref="S3.E33.m1.3.3.3.cmml">⁡</mo><mi id="S3.E33.m1.3.3.3.2" xref="S3.E33.m1.3.3.3.2.cmml">Var</mi></mrow><mo id="S3.E33.m1.3.3.2" xref="S3.E33.m1.3.3.2.cmml">⁢</mo><mrow id="S3.E33.m1.3.3.1.1" xref="S3.E33.m1.3.3.1.1.1.cmml"><mo id="S3.E33.m1.3.3.1.1.2" xref="S3.E33.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.E33.m1.3.3.1.1.1" xref="S3.E33.m1.3.3.1.1.1.cmml"><msub id="S3.E33.m1.3.3.1.1.1.2" xref="S3.E33.m1.3.3.1.1.1.2.cmml"><mover accent="true" id="S3.E33.m1.3.3.1.1.1.2.2" xref="S3.E33.m1.3.3.1.1.1.2.2.cmml"><mi id="S3.E33.m1.3.3.1.1.1.2.2.2" xref="S3.E33.m1.3.3.1.1.1.2.2.2.cmml">V</mi><mo id="S3.E33.m1.3.3.1.1.1.2.2.1" xref="S3.E33.m1.3.3.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.E33.m1.3.3.1.1.1.2.3" xref="S3.E33.m1.3.3.1.1.1.2.3.cmml"><mi id="S3.E33.m1.3.3.1.1.1.2.3.2" xref="S3.E33.m1.3.3.1.1.1.2.3.2.cmml">β</mi><mo id="S3.E33.m1.3.3.1.1.1.2.3.1" xref="S3.E33.m1.3.3.1.1.1.2.3.1.cmml">⁢</mo><mtext id="S3.E33.m1.3.3.1.1.1.2.3.3" xref="S3.E33.m1.3.3.1.1.1.2.3.3a.cmml">-</mtext><mo id="S3.E33.m1.3.3.1.1.1.2.3.1a" xref="S3.E33.m1.3.3.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E33.m1.3.3.1.1.1.2.3.4" xref="S3.E33.m1.3.3.1.1.1.2.3.4.cmml">IPS</mi></mrow></msub><mo id="S3.E33.m1.3.3.1.1.1.1" xref="S3.E33.m1.3.3.1.1.1.1.cmml">⁢</mo><mrow id="S3.E33.m1.3.3.1.1.1.3.2" xref="S3.E33.m1.3.3.1.1.1.3.1.cmml"><mo id="S3.E33.m1.3.3.1.1.1.3.2.1" stretchy="false" xref="S3.E33.m1.3.3.1.1.1.3.1.cmml">(</mo><mi id="S3.E33.m1.1.1" xref="S3.E33.m1.1.1.cmml">π</mi><mo id="S3.E33.m1.3.3.1.1.1.3.2.2" xref="S3.E33.m1.3.3.1.1.1.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E33.m1.2.2" xref="S3.E33.m1.2.2.cmml">𝒟</mi><mo id="S3.E33.m1.3.3.1.1.1.3.2.3" stretchy="false" xref="S3.E33.m1.3.3.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E33.m1.3.3.1.1.3" xref="S3.E33.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E33.m1.3b"><apply id="S3.E33.m1.3.3.cmml" xref="S3.E33.m1.3.3"><times id="S3.E33.m1.3.3.2.cmml" xref="S3.E33.m1.3.3.2"></times><apply id="S3.E33.m1.3.3.3.cmml" xref="S3.E33.m1.3.3.3"><apply id="S3.E33.m1.3.3.3.1.cmml" xref="S3.E33.m1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E33.m1.3.3.3.1.1.cmml" xref="S3.E33.m1.3.3.3.1">subscript</csymbol><apply id="S3.E33.m1.3.3.3.1.2.cmml" xref="S3.E33.m1.3.3.3.1.2"><times id="S3.E33.m1.3.3.3.1.2.1.cmml" xref="S3.E33.m1.3.3.3.1.2.1"></times><ci id="S3.E33.m1.3.3.3.1.2.2.cmml" xref="S3.E33.m1.3.3.3.1.2.2">arg</ci><ci id="S3.E33.m1.3.3.3.1.2.3.cmml" xref="S3.E33.m1.3.3.3.1.2.3">min</ci></apply><ci id="S3.E33.m1.3.3.3.1.3.cmml" xref="S3.E33.m1.3.3.3.1.3">𝛽</ci></apply><ci id="S3.E33.m1.3.3.3.2.cmml" xref="S3.E33.m1.3.3.3.2">Var</ci></apply><apply id="S3.E33.m1.3.3.1.1.1.cmml" xref="S3.E33.m1.3.3.1.1"><times id="S3.E33.m1.3.3.1.1.1.1.cmml" xref="S3.E33.m1.3.3.1.1.1.1"></times><apply id="S3.E33.m1.3.3.1.1.1.2.cmml" xref="S3.E33.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E33.m1.3.3.1.1.1.2.1.cmml" xref="S3.E33.m1.3.3.1.1.1.2">subscript</csymbol><apply id="S3.E33.m1.3.3.1.1.1.2.2.cmml" xref="S3.E33.m1.3.3.1.1.1.2.2"><ci id="S3.E33.m1.3.3.1.1.1.2.2.1.cmml" xref="S3.E33.m1.3.3.1.1.1.2.2.1">^</ci><ci id="S3.E33.m1.3.3.1.1.1.2.2.2.cmml" xref="S3.E33.m1.3.3.1.1.1.2.2.2">𝑉</ci></apply><apply id="S3.E33.m1.3.3.1.1.1.2.3.cmml" xref="S3.E33.m1.3.3.1.1.1.2.3"><times id="S3.E33.m1.3.3.1.1.1.2.3.1.cmml" xref="S3.E33.m1.3.3.1.1.1.2.3.1"></times><ci id="S3.E33.m1.3.3.1.1.1.2.3.2.cmml" xref="S3.E33.m1.3.3.1.1.1.2.3.2">𝛽</ci><ci id="S3.E33.m1.3.3.1.1.1.2.3.3a.cmml" xref="S3.E33.m1.3.3.1.1.1.2.3.3"><mtext id="S3.E33.m1.3.3.1.1.1.2.3.3.cmml" mathsize="70%" xref="S3.E33.m1.3.3.1.1.1.2.3.3">-</mtext></ci><ci id="S3.E33.m1.3.3.1.1.1.2.3.4.cmml" xref="S3.E33.m1.3.3.1.1.1.2.3.4">IPS</ci></apply></apply><interval closure="open" id="S3.E33.m1.3.3.1.1.1.3.1.cmml" xref="S3.E33.m1.3.3.1.1.1.3.2"><ci id="S3.E33.m1.1.1.cmml" xref="S3.E33.m1.1.1">𝜋</ci><ci id="S3.E33.m1.2.2.cmml" xref="S3.E33.m1.2.2">𝒟</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E33.m1.3c">\displaystyle\operatorname*{arg\,min}_{\beta}\mathrm{Var}\left(\widehat{V}_{%
\beta\text{-}{\rm IPS}}(\pi,\mathcal{D})\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E33.m1.3d">start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT italic_β end_POSTSUBSCRIPT roman_Var ( over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_β - roman_IPS end_POSTSUBSCRIPT ( italic_π , caligraphic_D ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E34"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(34)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\qquad=\operatorname*{arg\,min}_{\beta}\frac{1}{\left|\mathcal{D}%
\right|}\mathop{\mathrm{Var}}\left[\frac{\pi(a|x)}{\pi_{0}(a|x)}\left(r-\beta%
\right)\right]" class="ltx_Math" display="inline" id="S3.E34.m1.4"><semantics id="S3.E34.m1.4a"><mrow id="S3.E34.m1.4.4" xref="S3.E34.m1.4.4.cmml"><mi id="S3.E34.m1.4.4.3" xref="S3.E34.m1.4.4.3.cmml"></mi><mo id="S3.E34.m1.4.4.2" lspace="2.278em" xref="S3.E34.m1.4.4.2.cmml">=</mo><mrow id="S3.E34.m1.4.4.1" xref="S3.E34.m1.4.4.1.cmml"><mrow id="S3.E34.m1.4.4.1.3" xref="S3.E34.m1.4.4.1.3.cmml"><munder id="S3.E34.m1.4.4.1.3.1" xref="S3.E34.m1.4.4.1.3.1.cmml"><mrow id="S3.E34.m1.4.4.1.3.1.2" xref="S3.E34.m1.4.4.1.3.1.2.cmml"><mi id="S3.E34.m1.4.4.1.3.1.2.2" xref="S3.E34.m1.4.4.1.3.1.2.2.cmml">arg</mi><mo id="S3.E34.m1.4.4.1.3.1.2.1" lspace="0.170em" xref="S3.E34.m1.4.4.1.3.1.2.1.cmml">⁢</mo><mi id="S3.E34.m1.4.4.1.3.1.2.3" xref="S3.E34.m1.4.4.1.3.1.2.3.cmml">min</mi></mrow><mi id="S3.E34.m1.4.4.1.3.1.3" xref="S3.E34.m1.4.4.1.3.1.3.cmml">β</mi></munder><mo id="S3.E34.m1.4.4.1.3a" xref="S3.E34.m1.4.4.1.3.cmml">⁡</mo><mstyle displaystyle="true" id="S3.E34.m1.1.1" xref="S3.E34.m1.1.1.cmml"><mfrac id="S3.E34.m1.1.1a" xref="S3.E34.m1.1.1.cmml"><mn id="S3.E34.m1.1.1.3" xref="S3.E34.m1.1.1.3.cmml">1</mn><mrow id="S3.E34.m1.1.1.1.3" xref="S3.E34.m1.1.1.1.2.cmml"><mo id="S3.E34.m1.1.1.1.3.1" xref="S3.E34.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E34.m1.1.1.1.1" xref="S3.E34.m1.1.1.1.1.cmml">𝒟</mi><mo id="S3.E34.m1.1.1.1.3.2" xref="S3.E34.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle></mrow><mo id="S3.E34.m1.4.4.1.2" lspace="0.167em" xref="S3.E34.m1.4.4.1.2.cmml">⁢</mo><mrow id="S3.E34.m1.4.4.1.1" xref="S3.E34.m1.4.4.1.1.cmml"><mo id="S3.E34.m1.4.4.1.1.2" movablelimits="false" rspace="0em" xref="S3.E34.m1.4.4.1.1.2.cmml">Var</mo><mrow id="S3.E34.m1.4.4.1.1.1.1" xref="S3.E34.m1.4.4.1.1.1.2.cmml"><mo id="S3.E34.m1.4.4.1.1.1.1.2" xref="S3.E34.m1.4.4.1.1.1.2.1.cmml">[</mo><mrow id="S3.E34.m1.4.4.1.1.1.1.1" xref="S3.E34.m1.4.4.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E34.m1.3.3" xref="S3.E34.m1.3.3.cmml"><mfrac id="S3.E34.m1.3.3a" xref="S3.E34.m1.3.3.cmml"><mrow id="S3.E34.m1.2.2.1" xref="S3.E34.m1.2.2.1.cmml"><mi id="S3.E34.m1.2.2.1.3" xref="S3.E34.m1.2.2.1.3.cmml">π</mi><mo id="S3.E34.m1.2.2.1.2" xref="S3.E34.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E34.m1.2.2.1.1.1" xref="S3.E34.m1.2.2.1.1.1.1.cmml"><mo id="S3.E34.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E34.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E34.m1.2.2.1.1.1.1" xref="S3.E34.m1.2.2.1.1.1.1.cmml"><mi id="S3.E34.m1.2.2.1.1.1.1.2" xref="S3.E34.m1.2.2.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E34.m1.2.2.1.1.1.1.1" xref="S3.E34.m1.2.2.1.1.1.1.1.cmml">|</mo><mi id="S3.E34.m1.2.2.1.1.1.1.3" xref="S3.E34.m1.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E34.m1.2.2.1.1.1.3" stretchy="false" xref="S3.E34.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E34.m1.3.3.2" xref="S3.E34.m1.3.3.2.cmml"><msub id="S3.E34.m1.3.3.2.3" xref="S3.E34.m1.3.3.2.3.cmml"><mi id="S3.E34.m1.3.3.2.3.2" xref="S3.E34.m1.3.3.2.3.2.cmml">π</mi><mn id="S3.E34.m1.3.3.2.3.3" xref="S3.E34.m1.3.3.2.3.3.cmml">0</mn></msub><mo id="S3.E34.m1.3.3.2.2" xref="S3.E34.m1.3.3.2.2.cmml">⁢</mo><mrow id="S3.E34.m1.3.3.2.1.1" xref="S3.E34.m1.3.3.2.1.1.1.cmml"><mo id="S3.E34.m1.3.3.2.1.1.2" stretchy="false" xref="S3.E34.m1.3.3.2.1.1.1.cmml">(</mo><mrow id="S3.E34.m1.3.3.2.1.1.1" xref="S3.E34.m1.3.3.2.1.1.1.cmml"><mi id="S3.E34.m1.3.3.2.1.1.1.2" xref="S3.E34.m1.3.3.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E34.m1.3.3.2.1.1.1.1" xref="S3.E34.m1.3.3.2.1.1.1.1.cmml">|</mo><mi id="S3.E34.m1.3.3.2.1.1.1.3" xref="S3.E34.m1.3.3.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E34.m1.3.3.2.1.1.3" stretchy="false" xref="S3.E34.m1.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S3.E34.m1.4.4.1.1.1.1.1.2" xref="S3.E34.m1.4.4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E34.m1.4.4.1.1.1.1.1.1.1" xref="S3.E34.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E34.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E34.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E34.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E34.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E34.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E34.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="S3.E34.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E34.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E34.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E34.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">β</mi></mrow><mo id="S3.E34.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E34.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E34.m1.4.4.1.1.1.1.3" xref="S3.E34.m1.4.4.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E34.m1.4b"><apply id="S3.E34.m1.4.4.cmml" xref="S3.E34.m1.4.4"><eq id="S3.E34.m1.4.4.2.cmml" xref="S3.E34.m1.4.4.2"></eq><csymbol cd="latexml" id="S3.E34.m1.4.4.3.cmml" xref="S3.E34.m1.4.4.3">absent</csymbol><apply id="S3.E34.m1.4.4.1.cmml" xref="S3.E34.m1.4.4.1"><times id="S3.E34.m1.4.4.1.2.cmml" xref="S3.E34.m1.4.4.1.2"></times><apply id="S3.E34.m1.4.4.1.3.cmml" xref="S3.E34.m1.4.4.1.3"><apply id="S3.E34.m1.4.4.1.3.1.cmml" xref="S3.E34.m1.4.4.1.3.1"><csymbol cd="ambiguous" id="S3.E34.m1.4.4.1.3.1.1.cmml" xref="S3.E34.m1.4.4.1.3.1">subscript</csymbol><apply id="S3.E34.m1.4.4.1.3.1.2.cmml" xref="S3.E34.m1.4.4.1.3.1.2"><times id="S3.E34.m1.4.4.1.3.1.2.1.cmml" xref="S3.E34.m1.4.4.1.3.1.2.1"></times><ci id="S3.E34.m1.4.4.1.3.1.2.2.cmml" xref="S3.E34.m1.4.4.1.3.1.2.2">arg</ci><ci id="S3.E34.m1.4.4.1.3.1.2.3.cmml" xref="S3.E34.m1.4.4.1.3.1.2.3">min</ci></apply><ci id="S3.E34.m1.4.4.1.3.1.3.cmml" xref="S3.E34.m1.4.4.1.3.1.3">𝛽</ci></apply><apply id="S3.E34.m1.1.1.cmml" xref="S3.E34.m1.1.1"><divide id="S3.E34.m1.1.1.2.cmml" xref="S3.E34.m1.1.1"></divide><cn id="S3.E34.m1.1.1.3.cmml" type="integer" xref="S3.E34.m1.1.1.3">1</cn><apply id="S3.E34.m1.1.1.1.2.cmml" xref="S3.E34.m1.1.1.1.3"><abs id="S3.E34.m1.1.1.1.2.1.cmml" xref="S3.E34.m1.1.1.1.3.1"></abs><ci id="S3.E34.m1.1.1.1.1.cmml" xref="S3.E34.m1.1.1.1.1">𝒟</ci></apply></apply></apply><apply id="S3.E34.m1.4.4.1.1.cmml" xref="S3.E34.m1.4.4.1.1"><ci id="S3.E34.m1.4.4.1.1.2.cmml" xref="S3.E34.m1.4.4.1.1.2">Var</ci><apply id="S3.E34.m1.4.4.1.1.1.2.cmml" xref="S3.E34.m1.4.4.1.1.1.1"><csymbol cd="latexml" id="S3.E34.m1.4.4.1.1.1.2.1.cmml" xref="S3.E34.m1.4.4.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E34.m1.4.4.1.1.1.1.1.cmml" xref="S3.E34.m1.4.4.1.1.1.1.1"><times id="S3.E34.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E34.m1.4.4.1.1.1.1.1.2"></times><apply id="S3.E34.m1.3.3.cmml" xref="S3.E34.m1.3.3"><divide id="S3.E34.m1.3.3.3.cmml" xref="S3.E34.m1.3.3"></divide><apply id="S3.E34.m1.2.2.1.cmml" xref="S3.E34.m1.2.2.1"><times id="S3.E34.m1.2.2.1.2.cmml" xref="S3.E34.m1.2.2.1.2"></times><ci id="S3.E34.m1.2.2.1.3.cmml" xref="S3.E34.m1.2.2.1.3">𝜋</ci><apply id="S3.E34.m1.2.2.1.1.1.1.cmml" xref="S3.E34.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E34.m1.2.2.1.1.1.1.1.cmml" xref="S3.E34.m1.2.2.1.1.1.1.1">conditional</csymbol><ci id="S3.E34.m1.2.2.1.1.1.1.2.cmml" xref="S3.E34.m1.2.2.1.1.1.1.2">𝑎</ci><ci id="S3.E34.m1.2.2.1.1.1.1.3.cmml" xref="S3.E34.m1.2.2.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.E34.m1.3.3.2.cmml" xref="S3.E34.m1.3.3.2"><times id="S3.E34.m1.3.3.2.2.cmml" xref="S3.E34.m1.3.3.2.2"></times><apply id="S3.E34.m1.3.3.2.3.cmml" xref="S3.E34.m1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E34.m1.3.3.2.3.1.cmml" xref="S3.E34.m1.3.3.2.3">subscript</csymbol><ci id="S3.E34.m1.3.3.2.3.2.cmml" xref="S3.E34.m1.3.3.2.3.2">𝜋</ci><cn id="S3.E34.m1.3.3.2.3.3.cmml" type="integer" xref="S3.E34.m1.3.3.2.3.3">0</cn></apply><apply id="S3.E34.m1.3.3.2.1.1.1.cmml" xref="S3.E34.m1.3.3.2.1.1"><csymbol cd="latexml" id="S3.E34.m1.3.3.2.1.1.1.1.cmml" xref="S3.E34.m1.3.3.2.1.1.1.1">conditional</csymbol><ci id="S3.E34.m1.3.3.2.1.1.1.2.cmml" xref="S3.E34.m1.3.3.2.1.1.1.2">𝑎</ci><ci id="S3.E34.m1.3.3.2.1.1.1.3.cmml" xref="S3.E34.m1.3.3.2.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="S3.E34.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E34.m1.4.4.1.1.1.1.1.1.1"><minus id="S3.E34.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E34.m1.4.4.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.E34.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E34.m1.4.4.1.1.1.1.1.1.1.1.2">𝑟</ci><ci id="S3.E34.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E34.m1.4.4.1.1.1.1.1.1.1.1.3">𝛽</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E34.m1.4c">\displaystyle\qquad=\operatorname*{arg\,min}_{\beta}\frac{1}{\left|\mathcal{D}%
\right|}\mathop{\mathrm{Var}}\left[\frac{\pi(a|x)}{\pi_{0}(a|x)}\left(r-\beta%
\right)\right]</annotation><annotation encoding="application/x-llamapun" id="S3.E34.m1.4d">= start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT italic_β end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG roman_Var [ divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ( italic_r - italic_β ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E35"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(35)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\qquad=\operatorname*{arg\,min}_{\beta}\frac{1}{\left|\mathcal{D}%
\right|}\mathop{\mathbb{E}}\left[\Big{(}\frac{\pi(a|x)}{\pi_{0}(a|x)}\left(r-%
\beta\right)\Big{)}^{2}\ \right]" class="ltx_Math" display="inline" id="S3.E35.m1.4"><semantics id="S3.E35.m1.4a"><mrow id="S3.E35.m1.4.4" xref="S3.E35.m1.4.4.cmml"><mi id="S3.E35.m1.4.4.3" xref="S3.E35.m1.4.4.3.cmml"></mi><mo id="S3.E35.m1.4.4.2" lspace="2.278em" xref="S3.E35.m1.4.4.2.cmml">=</mo><mrow id="S3.E35.m1.4.4.1" xref="S3.E35.m1.4.4.1.cmml"><mrow id="S3.E35.m1.4.4.1.3" xref="S3.E35.m1.4.4.1.3.cmml"><munder id="S3.E35.m1.4.4.1.3.1" xref="S3.E35.m1.4.4.1.3.1.cmml"><mrow id="S3.E35.m1.4.4.1.3.1.2" xref="S3.E35.m1.4.4.1.3.1.2.cmml"><mi id="S3.E35.m1.4.4.1.3.1.2.2" xref="S3.E35.m1.4.4.1.3.1.2.2.cmml">arg</mi><mo id="S3.E35.m1.4.4.1.3.1.2.1" lspace="0.170em" xref="S3.E35.m1.4.4.1.3.1.2.1.cmml">⁢</mo><mi id="S3.E35.m1.4.4.1.3.1.2.3" xref="S3.E35.m1.4.4.1.3.1.2.3.cmml">min</mi></mrow><mi id="S3.E35.m1.4.4.1.3.1.3" xref="S3.E35.m1.4.4.1.3.1.3.cmml">β</mi></munder><mo id="S3.E35.m1.4.4.1.3a" xref="S3.E35.m1.4.4.1.3.cmml">⁡</mo><mstyle displaystyle="true" id="S3.E35.m1.1.1" xref="S3.E35.m1.1.1.cmml"><mfrac id="S3.E35.m1.1.1a" xref="S3.E35.m1.1.1.cmml"><mn id="S3.E35.m1.1.1.3" xref="S3.E35.m1.1.1.3.cmml">1</mn><mrow id="S3.E35.m1.1.1.1.3" xref="S3.E35.m1.1.1.1.2.cmml"><mo id="S3.E35.m1.1.1.1.3.1" xref="S3.E35.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E35.m1.1.1.1.1" xref="S3.E35.m1.1.1.1.1.cmml">𝒟</mi><mo id="S3.E35.m1.1.1.1.3.2" xref="S3.E35.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle></mrow><mo id="S3.E35.m1.4.4.1.2" lspace="0.167em" xref="S3.E35.m1.4.4.1.2.cmml">⁢</mo><mrow id="S3.E35.m1.4.4.1.1" xref="S3.E35.m1.4.4.1.1.cmml"><mo id="S3.E35.m1.4.4.1.1.2" movablelimits="false" rspace="0em" xref="S3.E35.m1.4.4.1.1.2.cmml">𝔼</mo><mrow id="S3.E35.m1.4.4.1.1.1.1" xref="S3.E35.m1.4.4.1.1.1.2.cmml"><mo id="S3.E35.m1.4.4.1.1.1.1.2" xref="S3.E35.m1.4.4.1.1.1.2.1.cmml">[</mo><msup id="S3.E35.m1.4.4.1.1.1.1.1" xref="S3.E35.m1.4.4.1.1.1.1.1.cmml"><mrow id="S3.E35.m1.4.4.1.1.1.1.1.1.1" xref="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E35.m1.4.4.1.1.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E35.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E35.m1.3.3" xref="S3.E35.m1.3.3.cmml"><mfrac id="S3.E35.m1.3.3a" xref="S3.E35.m1.3.3.cmml"><mrow id="S3.E35.m1.2.2.1" xref="S3.E35.m1.2.2.1.cmml"><mi id="S3.E35.m1.2.2.1.3" xref="S3.E35.m1.2.2.1.3.cmml">π</mi><mo id="S3.E35.m1.2.2.1.2" xref="S3.E35.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E35.m1.2.2.1.1.1" xref="S3.E35.m1.2.2.1.1.1.1.cmml"><mo id="S3.E35.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E35.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E35.m1.2.2.1.1.1.1" xref="S3.E35.m1.2.2.1.1.1.1.cmml"><mi id="S3.E35.m1.2.2.1.1.1.1.2" xref="S3.E35.m1.2.2.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E35.m1.2.2.1.1.1.1.1" xref="S3.E35.m1.2.2.1.1.1.1.1.cmml">|</mo><mi id="S3.E35.m1.2.2.1.1.1.1.3" xref="S3.E35.m1.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E35.m1.2.2.1.1.1.3" stretchy="false" xref="S3.E35.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E35.m1.3.3.2" xref="S3.E35.m1.3.3.2.cmml"><msub id="S3.E35.m1.3.3.2.3" xref="S3.E35.m1.3.3.2.3.cmml"><mi id="S3.E35.m1.3.3.2.3.2" xref="S3.E35.m1.3.3.2.3.2.cmml">π</mi><mn id="S3.E35.m1.3.3.2.3.3" xref="S3.E35.m1.3.3.2.3.3.cmml">0</mn></msub><mo id="S3.E35.m1.3.3.2.2" xref="S3.E35.m1.3.3.2.2.cmml">⁢</mo><mrow id="S3.E35.m1.3.3.2.1.1" xref="S3.E35.m1.3.3.2.1.1.1.cmml"><mo id="S3.E35.m1.3.3.2.1.1.2" stretchy="false" xref="S3.E35.m1.3.3.2.1.1.1.cmml">(</mo><mrow id="S3.E35.m1.3.3.2.1.1.1" xref="S3.E35.m1.3.3.2.1.1.1.cmml"><mi id="S3.E35.m1.3.3.2.1.1.1.2" xref="S3.E35.m1.3.3.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E35.m1.3.3.2.1.1.1.1" xref="S3.E35.m1.3.3.2.1.1.1.1.cmml">|</mo><mi id="S3.E35.m1.3.3.2.1.1.1.3" xref="S3.E35.m1.3.3.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E35.m1.3.3.2.1.1.3" stretchy="false" xref="S3.E35.m1.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml">β</mi></mrow><mo id="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E35.m1.4.4.1.1.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E35.m1.4.4.1.1.1.1.1.3" xref="S3.E35.m1.4.4.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.E35.m1.4.4.1.1.1.1.3" xref="S3.E35.m1.4.4.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E35.m1.4b"><apply id="S3.E35.m1.4.4.cmml" xref="S3.E35.m1.4.4"><eq id="S3.E35.m1.4.4.2.cmml" xref="S3.E35.m1.4.4.2"></eq><csymbol cd="latexml" id="S3.E35.m1.4.4.3.cmml" xref="S3.E35.m1.4.4.3">absent</csymbol><apply id="S3.E35.m1.4.4.1.cmml" xref="S3.E35.m1.4.4.1"><times id="S3.E35.m1.4.4.1.2.cmml" xref="S3.E35.m1.4.4.1.2"></times><apply id="S3.E35.m1.4.4.1.3.cmml" xref="S3.E35.m1.4.4.1.3"><apply id="S3.E35.m1.4.4.1.3.1.cmml" xref="S3.E35.m1.4.4.1.3.1"><csymbol cd="ambiguous" id="S3.E35.m1.4.4.1.3.1.1.cmml" xref="S3.E35.m1.4.4.1.3.1">subscript</csymbol><apply id="S3.E35.m1.4.4.1.3.1.2.cmml" xref="S3.E35.m1.4.4.1.3.1.2"><times id="S3.E35.m1.4.4.1.3.1.2.1.cmml" xref="S3.E35.m1.4.4.1.3.1.2.1"></times><ci id="S3.E35.m1.4.4.1.3.1.2.2.cmml" xref="S3.E35.m1.4.4.1.3.1.2.2">arg</ci><ci id="S3.E35.m1.4.4.1.3.1.2.3.cmml" xref="S3.E35.m1.4.4.1.3.1.2.3">min</ci></apply><ci id="S3.E35.m1.4.4.1.3.1.3.cmml" xref="S3.E35.m1.4.4.1.3.1.3">𝛽</ci></apply><apply id="S3.E35.m1.1.1.cmml" xref="S3.E35.m1.1.1"><divide id="S3.E35.m1.1.1.2.cmml" xref="S3.E35.m1.1.1"></divide><cn id="S3.E35.m1.1.1.3.cmml" type="integer" xref="S3.E35.m1.1.1.3">1</cn><apply id="S3.E35.m1.1.1.1.2.cmml" xref="S3.E35.m1.1.1.1.3"><abs id="S3.E35.m1.1.1.1.2.1.cmml" xref="S3.E35.m1.1.1.1.3.1"></abs><ci id="S3.E35.m1.1.1.1.1.cmml" xref="S3.E35.m1.1.1.1.1">𝒟</ci></apply></apply></apply><apply id="S3.E35.m1.4.4.1.1.cmml" xref="S3.E35.m1.4.4.1.1"><ci id="S3.E35.m1.4.4.1.1.2.cmml" xref="S3.E35.m1.4.4.1.1.2">𝔼</ci><apply id="S3.E35.m1.4.4.1.1.1.2.cmml" xref="S3.E35.m1.4.4.1.1.1.1"><csymbol cd="latexml" id="S3.E35.m1.4.4.1.1.1.2.1.cmml" xref="S3.E35.m1.4.4.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E35.m1.4.4.1.1.1.1.1.cmml" xref="S3.E35.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E35.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E35.m1.4.4.1.1.1.1.1">superscript</csymbol><apply id="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E35.m1.4.4.1.1.1.1.1.1.1"><times id="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E35.m1.3.3.cmml" xref="S3.E35.m1.3.3"><divide id="S3.E35.m1.3.3.3.cmml" xref="S3.E35.m1.3.3"></divide><apply id="S3.E35.m1.2.2.1.cmml" xref="S3.E35.m1.2.2.1"><times id="S3.E35.m1.2.2.1.2.cmml" xref="S3.E35.m1.2.2.1.2"></times><ci id="S3.E35.m1.2.2.1.3.cmml" xref="S3.E35.m1.2.2.1.3">𝜋</ci><apply id="S3.E35.m1.2.2.1.1.1.1.cmml" xref="S3.E35.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E35.m1.2.2.1.1.1.1.1.cmml" xref="S3.E35.m1.2.2.1.1.1.1.1">conditional</csymbol><ci id="S3.E35.m1.2.2.1.1.1.1.2.cmml" xref="S3.E35.m1.2.2.1.1.1.1.2">𝑎</ci><ci id="S3.E35.m1.2.2.1.1.1.1.3.cmml" xref="S3.E35.m1.2.2.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.E35.m1.3.3.2.cmml" xref="S3.E35.m1.3.3.2"><times id="S3.E35.m1.3.3.2.2.cmml" xref="S3.E35.m1.3.3.2.2"></times><apply id="S3.E35.m1.3.3.2.3.cmml" xref="S3.E35.m1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E35.m1.3.3.2.3.1.cmml" xref="S3.E35.m1.3.3.2.3">subscript</csymbol><ci id="S3.E35.m1.3.3.2.3.2.cmml" xref="S3.E35.m1.3.3.2.3.2">𝜋</ci><cn id="S3.E35.m1.3.3.2.3.3.cmml" type="integer" xref="S3.E35.m1.3.3.2.3.3">0</cn></apply><apply id="S3.E35.m1.3.3.2.1.1.1.cmml" xref="S3.E35.m1.3.3.2.1.1"><csymbol cd="latexml" id="S3.E35.m1.3.3.2.1.1.1.1.cmml" xref="S3.E35.m1.3.3.2.1.1.1.1">conditional</csymbol><ci id="S3.E35.m1.3.3.2.1.1.1.2.cmml" xref="S3.E35.m1.3.3.2.1.1.1.2">𝑎</ci><ci id="S3.E35.m1.3.3.2.1.1.1.3.cmml" xref="S3.E35.m1.3.3.2.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2">𝑟</ci><ci id="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E35.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3">𝛽</ci></apply></apply><cn id="S3.E35.m1.4.4.1.1.1.1.1.3.cmml" type="integer" xref="S3.E35.m1.4.4.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E35.m1.4c">\displaystyle\qquad=\operatorname*{arg\,min}_{\beta}\frac{1}{\left|\mathcal{D}%
\right|}\mathop{\mathbb{E}}\left[\Big{(}\frac{\pi(a|x)}{\pi_{0}(a|x)}\left(r-%
\beta\right)\Big{)}^{2}\ \right]</annotation><annotation encoding="application/x-llamapun" id="S3.E35.m1.4d">= start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT italic_β end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG blackboard_E [ ( divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ( italic_r - italic_β ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\qquad\qquad\qquad\qquad\qquad-\frac{1}{\left|\mathcal{D}\right|}%
\Big{(}\mathop{\mathbb{E}}\left[\frac{\pi(a|x)}{\pi_{0}(a|x)}\left(r-\beta%
\right)\right]\Big{)}^{2}" class="ltx_Math" display="inline" id="S3.Ex13.m1.4"><semantics id="S3.Ex13.m1.4a"><mrow id="S3.Ex13.m1.4.4" xref="S3.Ex13.m1.4.4.cmml"><mo id="S3.Ex13.m1.4.4a" xref="S3.Ex13.m1.4.4.cmml">−</mo><mrow id="S3.Ex13.m1.4.4.1" xref="S3.Ex13.m1.4.4.1.cmml"><mstyle displaystyle="true" id="S3.Ex13.m1.1.1" xref="S3.Ex13.m1.1.1.cmml"><mfrac id="S3.Ex13.m1.1.1a" xref="S3.Ex13.m1.1.1.cmml"><mn id="S3.Ex13.m1.1.1.3" xref="S3.Ex13.m1.1.1.3.cmml">1</mn><mrow id="S3.Ex13.m1.1.1.1.3" xref="S3.Ex13.m1.1.1.1.2.cmml"><mo id="S3.Ex13.m1.1.1.1.3.1" xref="S3.Ex13.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex13.m1.1.1.1.1" xref="S3.Ex13.m1.1.1.1.1.cmml">𝒟</mi><mo id="S3.Ex13.m1.1.1.1.3.2" xref="S3.Ex13.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo id="S3.Ex13.m1.4.4.1.2" xref="S3.Ex13.m1.4.4.1.2.cmml">⁢</mo><msup id="S3.Ex13.m1.4.4.1.1" xref="S3.Ex13.m1.4.4.1.1.cmml"><mrow id="S3.Ex13.m1.4.4.1.1.1.1" xref="S3.Ex13.m1.4.4.1.1.1.1.1.cmml"><mo id="S3.Ex13.m1.4.4.1.1.1.1.2" maxsize="160%" minsize="160%" xref="S3.Ex13.m1.4.4.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex13.m1.4.4.1.1.1.1.1" xref="S3.Ex13.m1.4.4.1.1.1.1.1.cmml"><mo id="S3.Ex13.m1.4.4.1.1.1.1.1.2" lspace="0em" movablelimits="false" rspace="0em" xref="S3.Ex13.m1.4.4.1.1.1.1.1.2.cmml">𝔼</mo><mrow id="S3.Ex13.m1.4.4.1.1.1.1.1.1.1" xref="S3.Ex13.m1.4.4.1.1.1.1.1.1.2.cmml"><mo id="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.Ex13.m1.4.4.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex13.m1.3.3" xref="S3.Ex13.m1.3.3.cmml"><mfrac id="S3.Ex13.m1.3.3a" xref="S3.Ex13.m1.3.3.cmml"><mrow id="S3.Ex13.m1.2.2.1" xref="S3.Ex13.m1.2.2.1.cmml"><mi id="S3.Ex13.m1.2.2.1.3" xref="S3.Ex13.m1.2.2.1.3.cmml">π</mi><mo id="S3.Ex13.m1.2.2.1.2" xref="S3.Ex13.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.Ex13.m1.2.2.1.1.1" xref="S3.Ex13.m1.2.2.1.1.1.1.cmml"><mo id="S3.Ex13.m1.2.2.1.1.1.2" stretchy="false" xref="S3.Ex13.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.Ex13.m1.2.2.1.1.1.1" xref="S3.Ex13.m1.2.2.1.1.1.1.cmml"><mi id="S3.Ex13.m1.2.2.1.1.1.1.2" xref="S3.Ex13.m1.2.2.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.Ex13.m1.2.2.1.1.1.1.1" xref="S3.Ex13.m1.2.2.1.1.1.1.1.cmml">|</mo><mi id="S3.Ex13.m1.2.2.1.1.1.1.3" xref="S3.Ex13.m1.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.Ex13.m1.2.2.1.1.1.3" stretchy="false" xref="S3.Ex13.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.Ex13.m1.3.3.2" xref="S3.Ex13.m1.3.3.2.cmml"><msub id="S3.Ex13.m1.3.3.2.3" xref="S3.Ex13.m1.3.3.2.3.cmml"><mi id="S3.Ex13.m1.3.3.2.3.2" xref="S3.Ex13.m1.3.3.2.3.2.cmml">π</mi><mn id="S3.Ex13.m1.3.3.2.3.3" xref="S3.Ex13.m1.3.3.2.3.3.cmml">0</mn></msub><mo id="S3.Ex13.m1.3.3.2.2" xref="S3.Ex13.m1.3.3.2.2.cmml">⁢</mo><mrow id="S3.Ex13.m1.3.3.2.1.1" xref="S3.Ex13.m1.3.3.2.1.1.1.cmml"><mo id="S3.Ex13.m1.3.3.2.1.1.2" stretchy="false" xref="S3.Ex13.m1.3.3.2.1.1.1.cmml">(</mo><mrow id="S3.Ex13.m1.3.3.2.1.1.1" xref="S3.Ex13.m1.3.3.2.1.1.1.cmml"><mi id="S3.Ex13.m1.3.3.2.1.1.1.2" xref="S3.Ex13.m1.3.3.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.Ex13.m1.3.3.2.1.1.1.1" xref="S3.Ex13.m1.3.3.2.1.1.1.1.cmml">|</mo><mi id="S3.Ex13.m1.3.3.2.1.1.1.3" xref="S3.Ex13.m1.3.3.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.Ex13.m1.3.3.2.1.1.3" stretchy="false" xref="S3.Ex13.m1.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml">β</mi></mrow><mo id="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.Ex13.m1.4.4.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.Ex13.m1.4.4.1.1.1.1.3" maxsize="160%" minsize="160%" xref="S3.Ex13.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.Ex13.m1.4.4.1.1.3" xref="S3.Ex13.m1.4.4.1.1.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex13.m1.4b"><apply id="S3.Ex13.m1.4.4.cmml" xref="S3.Ex13.m1.4.4"><minus id="S3.Ex13.m1.4.4.2.cmml" xref="S3.Ex13.m1.4.4"></minus><apply id="S3.Ex13.m1.4.4.1.cmml" xref="S3.Ex13.m1.4.4.1"><times id="S3.Ex13.m1.4.4.1.2.cmml" xref="S3.Ex13.m1.4.4.1.2"></times><apply id="S3.Ex13.m1.1.1.cmml" xref="S3.Ex13.m1.1.1"><divide id="S3.Ex13.m1.1.1.2.cmml" xref="S3.Ex13.m1.1.1"></divide><cn id="S3.Ex13.m1.1.1.3.cmml" type="integer" xref="S3.Ex13.m1.1.1.3">1</cn><apply id="S3.Ex13.m1.1.1.1.2.cmml" xref="S3.Ex13.m1.1.1.1.3"><abs id="S3.Ex13.m1.1.1.1.2.1.cmml" xref="S3.Ex13.m1.1.1.1.3.1"></abs><ci id="S3.Ex13.m1.1.1.1.1.cmml" xref="S3.Ex13.m1.1.1.1.1">𝒟</ci></apply></apply><apply id="S3.Ex13.m1.4.4.1.1.cmml" xref="S3.Ex13.m1.4.4.1.1"><csymbol cd="ambiguous" id="S3.Ex13.m1.4.4.1.1.2.cmml" xref="S3.Ex13.m1.4.4.1.1">superscript</csymbol><apply id="S3.Ex13.m1.4.4.1.1.1.1.1.cmml" xref="S3.Ex13.m1.4.4.1.1.1.1"><ci id="S3.Ex13.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.Ex13.m1.4.4.1.1.1.1.1.2">𝔼</ci><apply id="S3.Ex13.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.Ex13.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex13.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1"><times id="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.2"></times><apply id="S3.Ex13.m1.3.3.cmml" xref="S3.Ex13.m1.3.3"><divide id="S3.Ex13.m1.3.3.3.cmml" xref="S3.Ex13.m1.3.3"></divide><apply id="S3.Ex13.m1.2.2.1.cmml" xref="S3.Ex13.m1.2.2.1"><times id="S3.Ex13.m1.2.2.1.2.cmml" xref="S3.Ex13.m1.2.2.1.2"></times><ci id="S3.Ex13.m1.2.2.1.3.cmml" xref="S3.Ex13.m1.2.2.1.3">𝜋</ci><apply id="S3.Ex13.m1.2.2.1.1.1.1.cmml" xref="S3.Ex13.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.Ex13.m1.2.2.1.1.1.1.1.cmml" xref="S3.Ex13.m1.2.2.1.1.1.1.1">conditional</csymbol><ci id="S3.Ex13.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex13.m1.2.2.1.1.1.1.2">𝑎</ci><ci id="S3.Ex13.m1.2.2.1.1.1.1.3.cmml" xref="S3.Ex13.m1.2.2.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.Ex13.m1.3.3.2.cmml" xref="S3.Ex13.m1.3.3.2"><times id="S3.Ex13.m1.3.3.2.2.cmml" xref="S3.Ex13.m1.3.3.2.2"></times><apply id="S3.Ex13.m1.3.3.2.3.cmml" xref="S3.Ex13.m1.3.3.2.3"><csymbol cd="ambiguous" id="S3.Ex13.m1.3.3.2.3.1.cmml" xref="S3.Ex13.m1.3.3.2.3">subscript</csymbol><ci id="S3.Ex13.m1.3.3.2.3.2.cmml" xref="S3.Ex13.m1.3.3.2.3.2">𝜋</ci><cn id="S3.Ex13.m1.3.3.2.3.3.cmml" type="integer" xref="S3.Ex13.m1.3.3.2.3.3">0</cn></apply><apply id="S3.Ex13.m1.3.3.2.1.1.1.cmml" xref="S3.Ex13.m1.3.3.2.1.1"><csymbol cd="latexml" id="S3.Ex13.m1.3.3.2.1.1.1.1.cmml" xref="S3.Ex13.m1.3.3.2.1.1.1.1">conditional</csymbol><ci id="S3.Ex13.m1.3.3.2.1.1.1.2.cmml" xref="S3.Ex13.m1.3.3.2.1.1.1.2">𝑎</ci><ci id="S3.Ex13.m1.3.3.2.1.1.1.3.cmml" xref="S3.Ex13.m1.3.3.2.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1"><minus id="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2">𝑟</ci><ci id="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex13.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3">𝛽</ci></apply></apply></apply></apply><cn id="S3.Ex13.m1.4.4.1.1.3.cmml" type="integer" xref="S3.Ex13.m1.4.4.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex13.m1.4c">\displaystyle\qquad\qquad\qquad\qquad\qquad-\frac{1}{\left|\mathcal{D}\right|}%
\Big{(}\mathop{\mathbb{E}}\left[\frac{\pi(a|x)}{\pi_{0}(a|x)}\left(r-\beta%
\right)\right]\Big{)}^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex13.m1.4d">- divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG ( blackboard_E [ divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ( italic_r - italic_β ) ] ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E36"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(36)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\qquad=\operatorname*{arg\,min}_{\beta}\frac{1}{\left|\mathcal{D}%
\right|}\mathop{\mathbb{E}}\left[\left(\frac{\pi(a|x)}{\pi_{0}(a|x)}\right)^{2%
}\left(r-\beta\right)^{2}\ \right]" class="ltx_Math" display="inline" id="S3.E36.m1.4"><semantics id="S3.E36.m1.4a"><mrow id="S3.E36.m1.4.4" xref="S3.E36.m1.4.4.cmml"><mi id="S3.E36.m1.4.4.3" xref="S3.E36.m1.4.4.3.cmml"></mi><mo id="S3.E36.m1.4.4.2" lspace="2.278em" xref="S3.E36.m1.4.4.2.cmml">=</mo><mrow id="S3.E36.m1.4.4.1" xref="S3.E36.m1.4.4.1.cmml"><mrow id="S3.E36.m1.4.4.1.3" xref="S3.E36.m1.4.4.1.3.cmml"><munder id="S3.E36.m1.4.4.1.3.1" xref="S3.E36.m1.4.4.1.3.1.cmml"><mrow id="S3.E36.m1.4.4.1.3.1.2" xref="S3.E36.m1.4.4.1.3.1.2.cmml"><mi id="S3.E36.m1.4.4.1.3.1.2.2" xref="S3.E36.m1.4.4.1.3.1.2.2.cmml">arg</mi><mo id="S3.E36.m1.4.4.1.3.1.2.1" lspace="0.170em" xref="S3.E36.m1.4.4.1.3.1.2.1.cmml">⁢</mo><mi id="S3.E36.m1.4.4.1.3.1.2.3" xref="S3.E36.m1.4.4.1.3.1.2.3.cmml">min</mi></mrow><mi id="S3.E36.m1.4.4.1.3.1.3" xref="S3.E36.m1.4.4.1.3.1.3.cmml">β</mi></munder><mo id="S3.E36.m1.4.4.1.3a" xref="S3.E36.m1.4.4.1.3.cmml">⁡</mo><mstyle displaystyle="true" id="S3.E36.m1.1.1" xref="S3.E36.m1.1.1.cmml"><mfrac id="S3.E36.m1.1.1a" xref="S3.E36.m1.1.1.cmml"><mn id="S3.E36.m1.1.1.3" xref="S3.E36.m1.1.1.3.cmml">1</mn><mrow id="S3.E36.m1.1.1.1.3" xref="S3.E36.m1.1.1.1.2.cmml"><mo id="S3.E36.m1.1.1.1.3.1" xref="S3.E36.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E36.m1.1.1.1.1" xref="S3.E36.m1.1.1.1.1.cmml">𝒟</mi><mo id="S3.E36.m1.1.1.1.3.2" xref="S3.E36.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle></mrow><mo id="S3.E36.m1.4.4.1.2" lspace="0.167em" xref="S3.E36.m1.4.4.1.2.cmml">⁢</mo><mrow id="S3.E36.m1.4.4.1.1" xref="S3.E36.m1.4.4.1.1.cmml"><mo id="S3.E36.m1.4.4.1.1.2" movablelimits="false" rspace="0em" xref="S3.E36.m1.4.4.1.1.2.cmml">𝔼</mo><mrow id="S3.E36.m1.4.4.1.1.1.1" xref="S3.E36.m1.4.4.1.1.1.2.cmml"><mo id="S3.E36.m1.4.4.1.1.1.1.2" xref="S3.E36.m1.4.4.1.1.1.2.1.cmml">[</mo><mrow id="S3.E36.m1.4.4.1.1.1.1.1" xref="S3.E36.m1.4.4.1.1.1.1.1.cmml"><msup id="S3.E36.m1.4.4.1.1.1.1.1.3" xref="S3.E36.m1.4.4.1.1.1.1.1.3.cmml"><mrow id="S3.E36.m1.4.4.1.1.1.1.1.3.2.2" xref="S3.E36.m1.3.3.cmml"><mo id="S3.E36.m1.4.4.1.1.1.1.1.3.2.2.1" xref="S3.E36.m1.3.3.cmml">(</mo><mstyle displaystyle="true" id="S3.E36.m1.3.3" xref="S3.E36.m1.3.3.cmml"><mfrac id="S3.E36.m1.3.3a" xref="S3.E36.m1.3.3.cmml"><mrow id="S3.E36.m1.2.2.1" xref="S3.E36.m1.2.2.1.cmml"><mi id="S3.E36.m1.2.2.1.3" xref="S3.E36.m1.2.2.1.3.cmml">π</mi><mo id="S3.E36.m1.2.2.1.2" xref="S3.E36.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E36.m1.2.2.1.1.1" xref="S3.E36.m1.2.2.1.1.1.1.cmml"><mo id="S3.E36.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E36.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E36.m1.2.2.1.1.1.1" xref="S3.E36.m1.2.2.1.1.1.1.cmml"><mi id="S3.E36.m1.2.2.1.1.1.1.2" xref="S3.E36.m1.2.2.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E36.m1.2.2.1.1.1.1.1" xref="S3.E36.m1.2.2.1.1.1.1.1.cmml">|</mo><mi id="S3.E36.m1.2.2.1.1.1.1.3" xref="S3.E36.m1.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E36.m1.2.2.1.1.1.3" stretchy="false" xref="S3.E36.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E36.m1.3.3.2" xref="S3.E36.m1.3.3.2.cmml"><msub id="S3.E36.m1.3.3.2.3" xref="S3.E36.m1.3.3.2.3.cmml"><mi id="S3.E36.m1.3.3.2.3.2" xref="S3.E36.m1.3.3.2.3.2.cmml">π</mi><mn id="S3.E36.m1.3.3.2.3.3" xref="S3.E36.m1.3.3.2.3.3.cmml">0</mn></msub><mo id="S3.E36.m1.3.3.2.2" xref="S3.E36.m1.3.3.2.2.cmml">⁢</mo><mrow id="S3.E36.m1.3.3.2.1.1" xref="S3.E36.m1.3.3.2.1.1.1.cmml"><mo id="S3.E36.m1.3.3.2.1.1.2" stretchy="false" xref="S3.E36.m1.3.3.2.1.1.1.cmml">(</mo><mrow id="S3.E36.m1.3.3.2.1.1.1" xref="S3.E36.m1.3.3.2.1.1.1.cmml"><mi id="S3.E36.m1.3.3.2.1.1.1.2" xref="S3.E36.m1.3.3.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E36.m1.3.3.2.1.1.1.1" xref="S3.E36.m1.3.3.2.1.1.1.1.cmml">|</mo><mi id="S3.E36.m1.3.3.2.1.1.1.3" xref="S3.E36.m1.3.3.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E36.m1.3.3.2.1.1.3" stretchy="false" xref="S3.E36.m1.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S3.E36.m1.4.4.1.1.1.1.1.3.2.2.2" xref="S3.E36.m1.3.3.cmml">)</mo></mrow><mn id="S3.E36.m1.4.4.1.1.1.1.1.3.3" xref="S3.E36.m1.4.4.1.1.1.1.1.3.3.cmml">2</mn></msup><mo id="S3.E36.m1.4.4.1.1.1.1.1.2" xref="S3.E36.m1.4.4.1.1.1.1.1.2.cmml">⁢</mo><msup id="S3.E36.m1.4.4.1.1.1.1.1.1" xref="S3.E36.m1.4.4.1.1.1.1.1.1.cmml"><mrow id="S3.E36.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E36.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E36.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E36.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E36.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E36.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E36.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S3.E36.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="S3.E36.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E36.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E36.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S3.E36.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml">β</mi></mrow><mo id="S3.E36.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E36.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E36.m1.4.4.1.1.1.1.1.1.3" xref="S3.E36.m1.4.4.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow><mo id="S3.E36.m1.4.4.1.1.1.1.3" xref="S3.E36.m1.4.4.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E36.m1.4b"><apply id="S3.E36.m1.4.4.cmml" xref="S3.E36.m1.4.4"><eq id="S3.E36.m1.4.4.2.cmml" xref="S3.E36.m1.4.4.2"></eq><csymbol cd="latexml" id="S3.E36.m1.4.4.3.cmml" xref="S3.E36.m1.4.4.3">absent</csymbol><apply id="S3.E36.m1.4.4.1.cmml" xref="S3.E36.m1.4.4.1"><times id="S3.E36.m1.4.4.1.2.cmml" xref="S3.E36.m1.4.4.1.2"></times><apply id="S3.E36.m1.4.4.1.3.cmml" xref="S3.E36.m1.4.4.1.3"><apply id="S3.E36.m1.4.4.1.3.1.cmml" xref="S3.E36.m1.4.4.1.3.1"><csymbol cd="ambiguous" id="S3.E36.m1.4.4.1.3.1.1.cmml" xref="S3.E36.m1.4.4.1.3.1">subscript</csymbol><apply id="S3.E36.m1.4.4.1.3.1.2.cmml" xref="S3.E36.m1.4.4.1.3.1.2"><times id="S3.E36.m1.4.4.1.3.1.2.1.cmml" xref="S3.E36.m1.4.4.1.3.1.2.1"></times><ci id="S3.E36.m1.4.4.1.3.1.2.2.cmml" xref="S3.E36.m1.4.4.1.3.1.2.2">arg</ci><ci id="S3.E36.m1.4.4.1.3.1.2.3.cmml" xref="S3.E36.m1.4.4.1.3.1.2.3">min</ci></apply><ci id="S3.E36.m1.4.4.1.3.1.3.cmml" xref="S3.E36.m1.4.4.1.3.1.3">𝛽</ci></apply><apply id="S3.E36.m1.1.1.cmml" xref="S3.E36.m1.1.1"><divide id="S3.E36.m1.1.1.2.cmml" xref="S3.E36.m1.1.1"></divide><cn id="S3.E36.m1.1.1.3.cmml" type="integer" xref="S3.E36.m1.1.1.3">1</cn><apply id="S3.E36.m1.1.1.1.2.cmml" xref="S3.E36.m1.1.1.1.3"><abs id="S3.E36.m1.1.1.1.2.1.cmml" xref="S3.E36.m1.1.1.1.3.1"></abs><ci id="S3.E36.m1.1.1.1.1.cmml" xref="S3.E36.m1.1.1.1.1">𝒟</ci></apply></apply></apply><apply id="S3.E36.m1.4.4.1.1.cmml" xref="S3.E36.m1.4.4.1.1"><ci id="S3.E36.m1.4.4.1.1.2.cmml" xref="S3.E36.m1.4.4.1.1.2">𝔼</ci><apply id="S3.E36.m1.4.4.1.1.1.2.cmml" xref="S3.E36.m1.4.4.1.1.1.1"><csymbol cd="latexml" id="S3.E36.m1.4.4.1.1.1.2.1.cmml" xref="S3.E36.m1.4.4.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E36.m1.4.4.1.1.1.1.1.cmml" xref="S3.E36.m1.4.4.1.1.1.1.1"><times id="S3.E36.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E36.m1.4.4.1.1.1.1.1.2"></times><apply id="S3.E36.m1.4.4.1.1.1.1.1.3.cmml" xref="S3.E36.m1.4.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E36.m1.4.4.1.1.1.1.1.3.1.cmml" xref="S3.E36.m1.4.4.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E36.m1.3.3.cmml" xref="S3.E36.m1.4.4.1.1.1.1.1.3.2.2"><divide id="S3.E36.m1.3.3.3.cmml" xref="S3.E36.m1.4.4.1.1.1.1.1.3.2.2"></divide><apply id="S3.E36.m1.2.2.1.cmml" xref="S3.E36.m1.2.2.1"><times id="S3.E36.m1.2.2.1.2.cmml" xref="S3.E36.m1.2.2.1.2"></times><ci id="S3.E36.m1.2.2.1.3.cmml" xref="S3.E36.m1.2.2.1.3">𝜋</ci><apply id="S3.E36.m1.2.2.1.1.1.1.cmml" xref="S3.E36.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E36.m1.2.2.1.1.1.1.1.cmml" xref="S3.E36.m1.2.2.1.1.1.1.1">conditional</csymbol><ci id="S3.E36.m1.2.2.1.1.1.1.2.cmml" xref="S3.E36.m1.2.2.1.1.1.1.2">𝑎</ci><ci id="S3.E36.m1.2.2.1.1.1.1.3.cmml" xref="S3.E36.m1.2.2.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.E36.m1.3.3.2.cmml" xref="S3.E36.m1.3.3.2"><times id="S3.E36.m1.3.3.2.2.cmml" xref="S3.E36.m1.3.3.2.2"></times><apply id="S3.E36.m1.3.3.2.3.cmml" xref="S3.E36.m1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E36.m1.3.3.2.3.1.cmml" xref="S3.E36.m1.3.3.2.3">subscript</csymbol><ci id="S3.E36.m1.3.3.2.3.2.cmml" xref="S3.E36.m1.3.3.2.3.2">𝜋</ci><cn id="S3.E36.m1.3.3.2.3.3.cmml" type="integer" xref="S3.E36.m1.3.3.2.3.3">0</cn></apply><apply id="S3.E36.m1.3.3.2.1.1.1.cmml" xref="S3.E36.m1.3.3.2.1.1"><csymbol cd="latexml" id="S3.E36.m1.3.3.2.1.1.1.1.cmml" xref="S3.E36.m1.3.3.2.1.1.1.1">conditional</csymbol><ci id="S3.E36.m1.3.3.2.1.1.1.2.cmml" xref="S3.E36.m1.3.3.2.1.1.1.2">𝑎</ci><ci id="S3.E36.m1.3.3.2.1.1.1.3.cmml" xref="S3.E36.m1.3.3.2.1.1.1.3">𝑥</ci></apply></apply></apply><cn id="S3.E36.m1.4.4.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E36.m1.4.4.1.1.1.1.1.3.3">2</cn></apply><apply id="S3.E36.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E36.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E36.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E36.m1.4.4.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E36.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E36.m1.4.4.1.1.1.1.1.1.1.1"><minus id="S3.E36.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E36.m1.4.4.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.E36.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E36.m1.4.4.1.1.1.1.1.1.1.1.1.2">𝑟</ci><ci id="S3.E36.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E36.m1.4.4.1.1.1.1.1.1.1.1.1.3">𝛽</ci></apply><cn id="S3.E36.m1.4.4.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E36.m1.4.4.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E36.m1.4c">\displaystyle\qquad=\operatorname*{arg\,min}_{\beta}\frac{1}{\left|\mathcal{D}%
\right|}\mathop{\mathbb{E}}\left[\left(\frac{\pi(a|x)}{\pi_{0}(a|x)}\right)^{2%
}\left(r-\beta\right)^{2}\ \right]</annotation><annotation encoding="application/x-llamapun" id="S3.E36.m1.4d">= start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT italic_β end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG blackboard_E [ ( divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_r - italic_β ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\qquad\qquad\qquad\qquad\qquad-\frac{1}{\left|\mathcal{D}\right|}%
\Big{(}\mathop{\mathbb{E}}\left[\frac{\pi(a|x)}{\pi_{0}(a|x)}r\right]-\beta%
\Big{)}^{2}." class="ltx_Math" display="inline" id="S3.Ex14.m1.4"><semantics id="S3.Ex14.m1.4a"><mrow id="S3.Ex14.m1.4.4.1" xref="S3.Ex14.m1.4.4.1.1.cmml"><mrow id="S3.Ex14.m1.4.4.1.1" xref="S3.Ex14.m1.4.4.1.1.cmml"><mo id="S3.Ex14.m1.4.4.1.1a" xref="S3.Ex14.m1.4.4.1.1.cmml">−</mo><mrow id="S3.Ex14.m1.4.4.1.1.1" xref="S3.Ex14.m1.4.4.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex14.m1.1.1" xref="S3.Ex14.m1.1.1.cmml"><mfrac id="S3.Ex14.m1.1.1a" xref="S3.Ex14.m1.1.1.cmml"><mn id="S3.Ex14.m1.1.1.3" xref="S3.Ex14.m1.1.1.3.cmml">1</mn><mrow id="S3.Ex14.m1.1.1.1.3" xref="S3.Ex14.m1.1.1.1.2.cmml"><mo id="S3.Ex14.m1.1.1.1.3.1" xref="S3.Ex14.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex14.m1.1.1.1.1" xref="S3.Ex14.m1.1.1.1.1.cmml">𝒟</mi><mo id="S3.Ex14.m1.1.1.1.3.2" xref="S3.Ex14.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo id="S3.Ex14.m1.4.4.1.1.1.2" xref="S3.Ex14.m1.4.4.1.1.1.2.cmml">⁢</mo><msup id="S3.Ex14.m1.4.4.1.1.1.1" xref="S3.Ex14.m1.4.4.1.1.1.1.cmml"><mrow id="S3.Ex14.m1.4.4.1.1.1.1.1.1" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex14.m1.4.4.1.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.cmml"><mrow id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2" lspace="0em" movablelimits="false" rspace="0em" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">𝔼</mo><mrow id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex14.m1.3.3" xref="S3.Ex14.m1.3.3.cmml"><mfrac id="S3.Ex14.m1.3.3a" xref="S3.Ex14.m1.3.3.cmml"><mrow id="S3.Ex14.m1.2.2.1" xref="S3.Ex14.m1.2.2.1.cmml"><mi id="S3.Ex14.m1.2.2.1.3" xref="S3.Ex14.m1.2.2.1.3.cmml">π</mi><mo id="S3.Ex14.m1.2.2.1.2" xref="S3.Ex14.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.Ex14.m1.2.2.1.1.1" xref="S3.Ex14.m1.2.2.1.1.1.1.cmml"><mo id="S3.Ex14.m1.2.2.1.1.1.2" stretchy="false" xref="S3.Ex14.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.Ex14.m1.2.2.1.1.1.1" xref="S3.Ex14.m1.2.2.1.1.1.1.cmml"><mi id="S3.Ex14.m1.2.2.1.1.1.1.2" xref="S3.Ex14.m1.2.2.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.Ex14.m1.2.2.1.1.1.1.1" xref="S3.Ex14.m1.2.2.1.1.1.1.1.cmml">|</mo><mi id="S3.Ex14.m1.2.2.1.1.1.1.3" xref="S3.Ex14.m1.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.Ex14.m1.2.2.1.1.1.3" stretchy="false" xref="S3.Ex14.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.Ex14.m1.3.3.2" xref="S3.Ex14.m1.3.3.2.cmml"><msub id="S3.Ex14.m1.3.3.2.3" xref="S3.Ex14.m1.3.3.2.3.cmml"><mi id="S3.Ex14.m1.3.3.2.3.2" xref="S3.Ex14.m1.3.3.2.3.2.cmml">π</mi><mn id="S3.Ex14.m1.3.3.2.3.3" xref="S3.Ex14.m1.3.3.2.3.3.cmml">0</mn></msub><mo id="S3.Ex14.m1.3.3.2.2" xref="S3.Ex14.m1.3.3.2.2.cmml">⁢</mo><mrow id="S3.Ex14.m1.3.3.2.1.1" xref="S3.Ex14.m1.3.3.2.1.1.1.cmml"><mo id="S3.Ex14.m1.3.3.2.1.1.2" stretchy="false" xref="S3.Ex14.m1.3.3.2.1.1.1.cmml">(</mo><mrow id="S3.Ex14.m1.3.3.2.1.1.1" xref="S3.Ex14.m1.3.3.2.1.1.1.cmml"><mi id="S3.Ex14.m1.3.3.2.1.1.1.2" xref="S3.Ex14.m1.3.3.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.Ex14.m1.3.3.2.1.1.1.1" xref="S3.Ex14.m1.3.3.2.1.1.1.1.cmml">|</mo><mi id="S3.Ex14.m1.3.3.2.1.1.1.3" xref="S3.Ex14.m1.3.3.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.Ex14.m1.3.3.2.1.1.3" stretchy="false" xref="S3.Ex14.m1.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml">r</mi></mrow><mo id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.2.cmml">−</mo><mi id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.3.cmml">β</mi></mrow><mo id="S3.Ex14.m1.4.4.1.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.Ex14.m1.4.4.1.1.1.1.3" xref="S3.Ex14.m1.4.4.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S3.Ex14.m1.4.4.1.2" lspace="0em" xref="S3.Ex14.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex14.m1.4b"><apply id="S3.Ex14.m1.4.4.1.1.cmml" xref="S3.Ex14.m1.4.4.1"><minus id="S3.Ex14.m1.4.4.1.1.2.cmml" xref="S3.Ex14.m1.4.4.1"></minus><apply id="S3.Ex14.m1.4.4.1.1.1.cmml" xref="S3.Ex14.m1.4.4.1.1.1"><times id="S3.Ex14.m1.4.4.1.1.1.2.cmml" xref="S3.Ex14.m1.4.4.1.1.1.2"></times><apply id="S3.Ex14.m1.1.1.cmml" xref="S3.Ex14.m1.1.1"><divide id="S3.Ex14.m1.1.1.2.cmml" xref="S3.Ex14.m1.1.1"></divide><cn id="S3.Ex14.m1.1.1.3.cmml" type="integer" xref="S3.Ex14.m1.1.1.3">1</cn><apply id="S3.Ex14.m1.1.1.1.2.cmml" xref="S3.Ex14.m1.1.1.1.3"><abs id="S3.Ex14.m1.1.1.1.2.1.cmml" xref="S3.Ex14.m1.1.1.1.3.1"></abs><ci id="S3.Ex14.m1.1.1.1.1.cmml" xref="S3.Ex14.m1.1.1.1.1">𝒟</ci></apply></apply><apply id="S3.Ex14.m1.4.4.1.1.1.1.cmml" xref="S3.Ex14.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex14.m1.4.4.1.1.1.1.2.cmml" xref="S3.Ex14.m1.4.4.1.1.1.1">superscript</csymbol><apply id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1"><minus id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.2"></minus><apply id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1"><ci id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2">𝔼</ci><apply id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.Ex14.m1.3.3.cmml" xref="S3.Ex14.m1.3.3"><divide id="S3.Ex14.m1.3.3.3.cmml" xref="S3.Ex14.m1.3.3"></divide><apply id="S3.Ex14.m1.2.2.1.cmml" xref="S3.Ex14.m1.2.2.1"><times id="S3.Ex14.m1.2.2.1.2.cmml" xref="S3.Ex14.m1.2.2.1.2"></times><ci id="S3.Ex14.m1.2.2.1.3.cmml" xref="S3.Ex14.m1.2.2.1.3">𝜋</ci><apply id="S3.Ex14.m1.2.2.1.1.1.1.cmml" xref="S3.Ex14.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.Ex14.m1.2.2.1.1.1.1.1.cmml" xref="S3.Ex14.m1.2.2.1.1.1.1.1">conditional</csymbol><ci id="S3.Ex14.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex14.m1.2.2.1.1.1.1.2">𝑎</ci><ci id="S3.Ex14.m1.2.2.1.1.1.1.3.cmml" xref="S3.Ex14.m1.2.2.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.Ex14.m1.3.3.2.cmml" xref="S3.Ex14.m1.3.3.2"><times id="S3.Ex14.m1.3.3.2.2.cmml" xref="S3.Ex14.m1.3.3.2.2"></times><apply id="S3.Ex14.m1.3.3.2.3.cmml" xref="S3.Ex14.m1.3.3.2.3"><csymbol cd="ambiguous" id="S3.Ex14.m1.3.3.2.3.1.cmml" xref="S3.Ex14.m1.3.3.2.3">subscript</csymbol><ci id="S3.Ex14.m1.3.3.2.3.2.cmml" xref="S3.Ex14.m1.3.3.2.3.2">𝜋</ci><cn id="S3.Ex14.m1.3.3.2.3.3.cmml" type="integer" xref="S3.Ex14.m1.3.3.2.3.3">0</cn></apply><apply id="S3.Ex14.m1.3.3.2.1.1.1.cmml" xref="S3.Ex14.m1.3.3.2.1.1"><csymbol cd="latexml" id="S3.Ex14.m1.3.3.2.1.1.1.1.cmml" xref="S3.Ex14.m1.3.3.2.1.1.1.1">conditional</csymbol><ci id="S3.Ex14.m1.3.3.2.1.1.1.2.cmml" xref="S3.Ex14.m1.3.3.2.1.1.1.2">𝑎</ci><ci id="S3.Ex14.m1.3.3.2.1.1.1.3.cmml" xref="S3.Ex14.m1.3.3.2.1.1.1.3">𝑥</ci></apply></apply></apply><ci id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2">𝑟</ci></apply></apply></apply><ci id="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex14.m1.4.4.1.1.1.1.1.1.1.3">𝛽</ci></apply><cn id="S3.Ex14.m1.4.4.1.1.1.1.3.cmml" type="integer" xref="S3.Ex14.m1.4.4.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex14.m1.4c">\displaystyle\qquad\qquad\qquad\qquad\qquad-\frac{1}{\left|\mathcal{D}\right|}%
\Big{(}\mathop{\mathbb{E}}\left[\frac{\pi(a|x)}{\pi_{0}(a|x)}r\right]-\beta%
\Big{)}^{2}.</annotation><annotation encoding="application/x-llamapun" id="S3.Ex14.m1.4d">- divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG ( blackboard_E [ divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG italic_r ] - italic_β ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.6">The minimum is obtained by solving for the following equation:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Ax1.EGx8">
<tbody id="S3.E37"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(37)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\frac{\partial\left(\mathrm{Var}\left(\widehat{V}_{\beta\text{-}{%
\rm IPS}}(\pi,\mathcal{D})\right)\right)}{\partial\beta}" class="ltx_Math" display="inline" id="S3.E37.m1.3"><semantics id="S3.E37.m1.3a"><mstyle displaystyle="true" id="S3.E37.m1.3.3" xref="S3.E37.m1.3.3.cmml"><mfrac id="S3.E37.m1.3.3a" xref="S3.E37.m1.3.3.cmml"><mrow id="S3.E37.m1.3.3.3" xref="S3.E37.m1.3.3.3.cmml"><mo id="S3.E37.m1.3.3.3.4" rspace="0em" xref="S3.E37.m1.3.3.3.4.cmml">∂</mo><mrow id="S3.E37.m1.3.3.3.3.1" xref="S3.E37.m1.3.3.3.3.1.1.cmml"><mo id="S3.E37.m1.3.3.3.3.1.2" xref="S3.E37.m1.3.3.3.3.1.1.cmml">(</mo><mrow id="S3.E37.m1.3.3.3.3.1.1" xref="S3.E37.m1.3.3.3.3.1.1.cmml"><mi id="S3.E37.m1.3.3.3.3.1.1.3" xref="S3.E37.m1.3.3.3.3.1.1.3.cmml">Var</mi><mo id="S3.E37.m1.3.3.3.3.1.1.2" xref="S3.E37.m1.3.3.3.3.1.1.2.cmml">⁢</mo><mrow id="S3.E37.m1.3.3.3.3.1.1.1.1" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.cmml"><mo id="S3.E37.m1.3.3.3.3.1.1.1.1.2" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.E37.m1.3.3.3.3.1.1.1.1.1" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.cmml"><msub id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.2" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.2.cmml"><mi id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.2.2" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.2.2.cmml">V</mi><mo id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.2.1" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.cmml"><mi id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.2" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.2.cmml">β</mi><mo id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.1" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.1.cmml">⁢</mo><mtext id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.3" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.3a.cmml">-</mtext><mo id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.1a" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.4" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.4.cmml">IPS</mi></mrow></msub><mo id="S3.E37.m1.3.3.3.3.1.1.1.1.1.1" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E37.m1.3.3.3.3.1.1.1.1.1.3.2" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.3.1.cmml"><mo id="S3.E37.m1.3.3.3.3.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.3.1.cmml">(</mo><mi id="S3.E37.m1.1.1.1.1" xref="S3.E37.m1.1.1.1.1.cmml">π</mi><mo id="S3.E37.m1.3.3.3.3.1.1.1.1.1.3.2.2" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E37.m1.2.2.2.2" xref="S3.E37.m1.2.2.2.2.cmml">𝒟</mi><mo id="S3.E37.m1.3.3.3.3.1.1.1.1.1.3.2.3" stretchy="false" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E37.m1.3.3.3.3.1.1.1.1.3" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E37.m1.3.3.3.3.1.3" xref="S3.E37.m1.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E37.m1.3.3.5" xref="S3.E37.m1.3.3.5.cmml"><mo id="S3.E37.m1.3.3.5.1" rspace="0em" xref="S3.E37.m1.3.3.5.1.cmml">∂</mo><mi id="S3.E37.m1.3.3.5.2" xref="S3.E37.m1.3.3.5.2.cmml">β</mi></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="S3.E37.m1.3b"><apply id="S3.E37.m1.3.3.cmml" xref="S3.E37.m1.3.3"><divide id="S3.E37.m1.3.3.4.cmml" xref="S3.E37.m1.3.3"></divide><apply id="S3.E37.m1.3.3.3.cmml" xref="S3.E37.m1.3.3.3"><partialdiff id="S3.E37.m1.3.3.3.4.cmml" xref="S3.E37.m1.3.3.3.4"></partialdiff><apply id="S3.E37.m1.3.3.3.3.1.1.cmml" xref="S3.E37.m1.3.3.3.3.1"><times id="S3.E37.m1.3.3.3.3.1.1.2.cmml" xref="S3.E37.m1.3.3.3.3.1.1.2"></times><ci id="S3.E37.m1.3.3.3.3.1.1.3.cmml" xref="S3.E37.m1.3.3.3.3.1.1.3">Var</ci><apply id="S3.E37.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S3.E37.m1.3.3.3.3.1.1.1.1"><times id="S3.E37.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.1"></times><apply id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.2.cmml" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.2"><ci id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.2.1.cmml" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.2.2.cmml" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.2.2">𝑉</ci></apply><apply id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.cmml" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3"><times id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.1.cmml" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.1"></times><ci id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.2.cmml" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.2">𝛽</ci><ci id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.3a.cmml" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.3"><mtext id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.3.cmml" mathsize="70%" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.3">-</mtext></ci><ci id="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.4.cmml" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.2.3.4">IPS</ci></apply></apply><interval closure="open" id="S3.E37.m1.3.3.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E37.m1.3.3.3.3.1.1.1.1.1.3.2"><ci id="S3.E37.m1.1.1.1.1.cmml" xref="S3.E37.m1.1.1.1.1">𝜋</ci><ci id="S3.E37.m1.2.2.2.2.cmml" xref="S3.E37.m1.2.2.2.2">𝒟</ci></interval></apply></apply></apply><apply id="S3.E37.m1.3.3.5.cmml" xref="S3.E37.m1.3.3.5"><partialdiff id="S3.E37.m1.3.3.5.1.cmml" xref="S3.E37.m1.3.3.5.1"></partialdiff><ci id="S3.E37.m1.3.3.5.2.cmml" xref="S3.E37.m1.3.3.5.2">𝛽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E37.m1.3c">\displaystyle\frac{\partial\left(\mathrm{Var}\left(\widehat{V}_{\beta\text{-}{%
\rm IPS}}(\pi,\mathcal{D})\right)\right)}{\partial\beta}</annotation><annotation encoding="application/x-llamapun" id="S3.E37.m1.3d">divide start_ARG ∂ ( roman_Var ( over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_β - roman_IPS end_POSTSUBSCRIPT ( italic_π , caligraphic_D ) ) ) end_ARG start_ARG ∂ italic_β end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\quad\;=\frac{2}{\left|\mathcal{D}\right|}\mathop{\mathbb{E}}%
\left[\left(\frac{\pi(a|x)}{\pi_{0}(a|x)}\right)^{2}\left(\beta-r\right)\ %
\right]-\frac{2}{\left|\mathcal{D}\right|}\left(\beta-\mathop{\mathbb{E}}\left%
[\frac{\pi(a|x)}{\pi_{0}(a|x)}r\right]\right)=0," class="ltx_Math" display="inline" id="S3.Ex15.m1.7"><semantics id="S3.Ex15.m1.7a"><mrow id="S3.Ex15.m1.7.7.1" xref="S3.Ex15.m1.7.7.1.1.cmml"><mrow id="S3.Ex15.m1.7.7.1.1" xref="S3.Ex15.m1.7.7.1.1.cmml"><mi id="S3.Ex15.m1.7.7.1.1.4" xref="S3.Ex15.m1.7.7.1.1.4.cmml"></mi><mo id="S3.Ex15.m1.7.7.1.1.5" lspace="1.558em" xref="S3.Ex15.m1.7.7.1.1.5.cmml">=</mo><mrow id="S3.Ex15.m1.7.7.1.1.2" xref="S3.Ex15.m1.7.7.1.1.2.cmml"><mrow id="S3.Ex15.m1.7.7.1.1.1.1" xref="S3.Ex15.m1.7.7.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex15.m1.1.1" xref="S3.Ex15.m1.1.1.cmml"><mfrac id="S3.Ex15.m1.1.1a" xref="S3.Ex15.m1.1.1.cmml"><mn id="S3.Ex15.m1.1.1.3" xref="S3.Ex15.m1.1.1.3.cmml">2</mn><mrow id="S3.Ex15.m1.1.1.1.3" xref="S3.Ex15.m1.1.1.1.2.cmml"><mo id="S3.Ex15.m1.1.1.1.3.1" xref="S3.Ex15.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex15.m1.1.1.1.1" xref="S3.Ex15.m1.1.1.1.1.cmml">𝒟</mi><mo id="S3.Ex15.m1.1.1.1.3.2" xref="S3.Ex15.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo id="S3.Ex15.m1.7.7.1.1.1.1.2" lspace="0.167em" xref="S3.Ex15.m1.7.7.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex15.m1.7.7.1.1.1.1.1" xref="S3.Ex15.m1.7.7.1.1.1.1.1.cmml"><mo id="S3.Ex15.m1.7.7.1.1.1.1.1.2" movablelimits="false" rspace="0em" xref="S3.Ex15.m1.7.7.1.1.1.1.1.2.cmml">𝔼</mo><mrow id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.2.cmml"><mo id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.2" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.cmml"><msup id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.3.cmml"><mrow id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.3.2.2" xref="S3.Ex15.m1.3.3.cmml"><mo id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.3.2.2.1" xref="S3.Ex15.m1.3.3.cmml">(</mo><mstyle displaystyle="true" id="S3.Ex15.m1.3.3" xref="S3.Ex15.m1.3.3.cmml"><mfrac id="S3.Ex15.m1.3.3a" xref="S3.Ex15.m1.3.3.cmml"><mrow id="S3.Ex15.m1.2.2.1" xref="S3.Ex15.m1.2.2.1.cmml"><mi id="S3.Ex15.m1.2.2.1.3" xref="S3.Ex15.m1.2.2.1.3.cmml">π</mi><mo id="S3.Ex15.m1.2.2.1.2" xref="S3.Ex15.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.Ex15.m1.2.2.1.1.1" xref="S3.Ex15.m1.2.2.1.1.1.1.cmml"><mo id="S3.Ex15.m1.2.2.1.1.1.2" stretchy="false" xref="S3.Ex15.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.Ex15.m1.2.2.1.1.1.1" xref="S3.Ex15.m1.2.2.1.1.1.1.cmml"><mi id="S3.Ex15.m1.2.2.1.1.1.1.2" xref="S3.Ex15.m1.2.2.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.Ex15.m1.2.2.1.1.1.1.1" xref="S3.Ex15.m1.2.2.1.1.1.1.1.cmml">|</mo><mi id="S3.Ex15.m1.2.2.1.1.1.1.3" xref="S3.Ex15.m1.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.Ex15.m1.2.2.1.1.1.3" stretchy="false" xref="S3.Ex15.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.Ex15.m1.3.3.2" xref="S3.Ex15.m1.3.3.2.cmml"><msub id="S3.Ex15.m1.3.3.2.3" xref="S3.Ex15.m1.3.3.2.3.cmml"><mi id="S3.Ex15.m1.3.3.2.3.2" xref="S3.Ex15.m1.3.3.2.3.2.cmml">π</mi><mn id="S3.Ex15.m1.3.3.2.3.3" xref="S3.Ex15.m1.3.3.2.3.3.cmml">0</mn></msub><mo id="S3.Ex15.m1.3.3.2.2" xref="S3.Ex15.m1.3.3.2.2.cmml">⁢</mo><mrow id="S3.Ex15.m1.3.3.2.1.1" xref="S3.Ex15.m1.3.3.2.1.1.1.cmml"><mo id="S3.Ex15.m1.3.3.2.1.1.2" stretchy="false" xref="S3.Ex15.m1.3.3.2.1.1.1.cmml">(</mo><mrow id="S3.Ex15.m1.3.3.2.1.1.1" xref="S3.Ex15.m1.3.3.2.1.1.1.cmml"><mi id="S3.Ex15.m1.3.3.2.1.1.1.2" xref="S3.Ex15.m1.3.3.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.Ex15.m1.3.3.2.1.1.1.1" xref="S3.Ex15.m1.3.3.2.1.1.1.1.cmml">|</mo><mi id="S3.Ex15.m1.3.3.2.1.1.1.3" xref="S3.Ex15.m1.3.3.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.Ex15.m1.3.3.2.1.1.3" stretchy="false" xref="S3.Ex15.m1.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.3.2.2.2" xref="S3.Ex15.m1.3.3.cmml">)</mo></mrow><mn id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msup><mo id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml">β</mi><mo id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.cmml">r</mi></mrow><mo id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1.3" rspace="0.500em" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.3" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.Ex15.m1.7.7.1.1.2.3" xref="S3.Ex15.m1.7.7.1.1.2.3.cmml">−</mo><mrow id="S3.Ex15.m1.7.7.1.1.2.2" xref="S3.Ex15.m1.7.7.1.1.2.2.cmml"><mstyle displaystyle="true" id="S3.Ex15.m1.4.4" xref="S3.Ex15.m1.4.4.cmml"><mfrac id="S3.Ex15.m1.4.4a" xref="S3.Ex15.m1.4.4.cmml"><mn id="S3.Ex15.m1.4.4.3" xref="S3.Ex15.m1.4.4.3.cmml">2</mn><mrow id="S3.Ex15.m1.4.4.1.3" xref="S3.Ex15.m1.4.4.1.2.cmml"><mo id="S3.Ex15.m1.4.4.1.3.1" xref="S3.Ex15.m1.4.4.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex15.m1.4.4.1.1" xref="S3.Ex15.m1.4.4.1.1.cmml">𝒟</mi><mo id="S3.Ex15.m1.4.4.1.3.2" xref="S3.Ex15.m1.4.4.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo id="S3.Ex15.m1.7.7.1.1.2.2.2" xref="S3.Ex15.m1.7.7.1.1.2.2.2.cmml">⁢</mo><mrow id="S3.Ex15.m1.7.7.1.1.2.2.1.1" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.cmml"><mo id="S3.Ex15.m1.7.7.1.1.2.2.1.1.2" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.cmml">(</mo><mrow id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.cmml"><mi id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.3" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.3.cmml">β</mi><mo id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.2" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.2.cmml">−</mo><mrow id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.cmml"><mo id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.2" lspace="0em" movablelimits="false" rspace="0em" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.2.cmml">𝔼</mo><mrow id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.1" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.2.cmml"><mo id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.1.2" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.1.1" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex15.m1.6.6" xref="S3.Ex15.m1.6.6.cmml"><mfrac id="S3.Ex15.m1.6.6a" xref="S3.Ex15.m1.6.6.cmml"><mrow id="S3.Ex15.m1.5.5.1" xref="S3.Ex15.m1.5.5.1.cmml"><mi id="S3.Ex15.m1.5.5.1.3" xref="S3.Ex15.m1.5.5.1.3.cmml">π</mi><mo id="S3.Ex15.m1.5.5.1.2" xref="S3.Ex15.m1.5.5.1.2.cmml">⁢</mo><mrow id="S3.Ex15.m1.5.5.1.1.1" xref="S3.Ex15.m1.5.5.1.1.1.1.cmml"><mo id="S3.Ex15.m1.5.5.1.1.1.2" stretchy="false" xref="S3.Ex15.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S3.Ex15.m1.5.5.1.1.1.1" xref="S3.Ex15.m1.5.5.1.1.1.1.cmml"><mi id="S3.Ex15.m1.5.5.1.1.1.1.2" xref="S3.Ex15.m1.5.5.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.Ex15.m1.5.5.1.1.1.1.1" xref="S3.Ex15.m1.5.5.1.1.1.1.1.cmml">|</mo><mi id="S3.Ex15.m1.5.5.1.1.1.1.3" xref="S3.Ex15.m1.5.5.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.Ex15.m1.5.5.1.1.1.3" stretchy="false" xref="S3.Ex15.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.Ex15.m1.6.6.2" xref="S3.Ex15.m1.6.6.2.cmml"><msub id="S3.Ex15.m1.6.6.2.3" xref="S3.Ex15.m1.6.6.2.3.cmml"><mi id="S3.Ex15.m1.6.6.2.3.2" xref="S3.Ex15.m1.6.6.2.3.2.cmml">π</mi><mn id="S3.Ex15.m1.6.6.2.3.3" xref="S3.Ex15.m1.6.6.2.3.3.cmml">0</mn></msub><mo id="S3.Ex15.m1.6.6.2.2" xref="S3.Ex15.m1.6.6.2.2.cmml">⁢</mo><mrow id="S3.Ex15.m1.6.6.2.1.1" xref="S3.Ex15.m1.6.6.2.1.1.1.cmml"><mo id="S3.Ex15.m1.6.6.2.1.1.2" stretchy="false" xref="S3.Ex15.m1.6.6.2.1.1.1.cmml">(</mo><mrow id="S3.Ex15.m1.6.6.2.1.1.1" xref="S3.Ex15.m1.6.6.2.1.1.1.cmml"><mi id="S3.Ex15.m1.6.6.2.1.1.1.2" xref="S3.Ex15.m1.6.6.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.Ex15.m1.6.6.2.1.1.1.1" xref="S3.Ex15.m1.6.6.2.1.1.1.1.cmml">|</mo><mi id="S3.Ex15.m1.6.6.2.1.1.1.3" xref="S3.Ex15.m1.6.6.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.Ex15.m1.6.6.2.1.1.3" stretchy="false" xref="S3.Ex15.m1.6.6.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.2.cmml">r</mi></mrow><mo id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.1.3" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.Ex15.m1.7.7.1.1.2.2.1.1.3" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex15.m1.7.7.1.1.6" xref="S3.Ex15.m1.7.7.1.1.6.cmml">=</mo><mn id="S3.Ex15.m1.7.7.1.1.7" xref="S3.Ex15.m1.7.7.1.1.7.cmml">0</mn></mrow><mo id="S3.Ex15.m1.7.7.1.2" xref="S3.Ex15.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex15.m1.7b"><apply id="S3.Ex15.m1.7.7.1.1.cmml" xref="S3.Ex15.m1.7.7.1"><and id="S3.Ex15.m1.7.7.1.1a.cmml" xref="S3.Ex15.m1.7.7.1"></and><apply id="S3.Ex15.m1.7.7.1.1b.cmml" xref="S3.Ex15.m1.7.7.1"><eq id="S3.Ex15.m1.7.7.1.1.5.cmml" xref="S3.Ex15.m1.7.7.1.1.5"></eq><csymbol cd="latexml" id="S3.Ex15.m1.7.7.1.1.4.cmml" xref="S3.Ex15.m1.7.7.1.1.4">absent</csymbol><apply id="S3.Ex15.m1.7.7.1.1.2.cmml" xref="S3.Ex15.m1.7.7.1.1.2"><minus id="S3.Ex15.m1.7.7.1.1.2.3.cmml" xref="S3.Ex15.m1.7.7.1.1.2.3"></minus><apply id="S3.Ex15.m1.7.7.1.1.1.1.cmml" xref="S3.Ex15.m1.7.7.1.1.1.1"><times id="S3.Ex15.m1.7.7.1.1.1.1.2.cmml" xref="S3.Ex15.m1.7.7.1.1.1.1.2"></times><apply id="S3.Ex15.m1.1.1.cmml" xref="S3.Ex15.m1.1.1"><divide id="S3.Ex15.m1.1.1.2.cmml" xref="S3.Ex15.m1.1.1"></divide><cn id="S3.Ex15.m1.1.1.3.cmml" type="integer" xref="S3.Ex15.m1.1.1.3">2</cn><apply id="S3.Ex15.m1.1.1.1.2.cmml" xref="S3.Ex15.m1.1.1.1.3"><abs id="S3.Ex15.m1.1.1.1.2.1.cmml" xref="S3.Ex15.m1.1.1.1.3.1"></abs><ci id="S3.Ex15.m1.1.1.1.1.cmml" xref="S3.Ex15.m1.1.1.1.1">𝒟</ci></apply></apply><apply id="S3.Ex15.m1.7.7.1.1.1.1.1.cmml" xref="S3.Ex15.m1.7.7.1.1.1.1.1"><ci id="S3.Ex15.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.Ex15.m1.7.7.1.1.1.1.1.2">𝔼</ci><apply id="S3.Ex15.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex15.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1"><times id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.2"></times><apply id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.Ex15.m1.3.3.cmml" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.3.2.2"><divide id="S3.Ex15.m1.3.3.3.cmml" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.3.2.2"></divide><apply id="S3.Ex15.m1.2.2.1.cmml" xref="S3.Ex15.m1.2.2.1"><times id="S3.Ex15.m1.2.2.1.2.cmml" xref="S3.Ex15.m1.2.2.1.2"></times><ci id="S3.Ex15.m1.2.2.1.3.cmml" xref="S3.Ex15.m1.2.2.1.3">𝜋</ci><apply id="S3.Ex15.m1.2.2.1.1.1.1.cmml" xref="S3.Ex15.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.Ex15.m1.2.2.1.1.1.1.1.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.1">conditional</csymbol><ci id="S3.Ex15.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.2">𝑎</ci><ci id="S3.Ex15.m1.2.2.1.1.1.1.3.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.Ex15.m1.3.3.2.cmml" xref="S3.Ex15.m1.3.3.2"><times id="S3.Ex15.m1.3.3.2.2.cmml" xref="S3.Ex15.m1.3.3.2.2"></times><apply id="S3.Ex15.m1.3.3.2.3.cmml" xref="S3.Ex15.m1.3.3.2.3"><csymbol cd="ambiguous" id="S3.Ex15.m1.3.3.2.3.1.cmml" xref="S3.Ex15.m1.3.3.2.3">subscript</csymbol><ci id="S3.Ex15.m1.3.3.2.3.2.cmml" xref="S3.Ex15.m1.3.3.2.3.2">𝜋</ci><cn id="S3.Ex15.m1.3.3.2.3.3.cmml" type="integer" xref="S3.Ex15.m1.3.3.2.3.3">0</cn></apply><apply id="S3.Ex15.m1.3.3.2.1.1.1.cmml" xref="S3.Ex15.m1.3.3.2.1.1"><csymbol cd="latexml" id="S3.Ex15.m1.3.3.2.1.1.1.1.cmml" xref="S3.Ex15.m1.3.3.2.1.1.1.1">conditional</csymbol><ci id="S3.Ex15.m1.3.3.2.1.1.1.2.cmml" xref="S3.Ex15.m1.3.3.2.1.1.1.2">𝑎</ci><ci id="S3.Ex15.m1.3.3.2.1.1.1.3.cmml" xref="S3.Ex15.m1.3.3.2.1.1.1.3">𝑥</ci></apply></apply></apply><cn id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.3.3">2</cn></apply><apply id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1"><minus id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2">𝛽</ci><ci id="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex15.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3">𝑟</ci></apply></apply></apply></apply></apply><apply id="S3.Ex15.m1.7.7.1.1.2.2.cmml" xref="S3.Ex15.m1.7.7.1.1.2.2"><times id="S3.Ex15.m1.7.7.1.1.2.2.2.cmml" xref="S3.Ex15.m1.7.7.1.1.2.2.2"></times><apply id="S3.Ex15.m1.4.4.cmml" xref="S3.Ex15.m1.4.4"><divide id="S3.Ex15.m1.4.4.2.cmml" xref="S3.Ex15.m1.4.4"></divide><cn id="S3.Ex15.m1.4.4.3.cmml" type="integer" xref="S3.Ex15.m1.4.4.3">2</cn><apply id="S3.Ex15.m1.4.4.1.2.cmml" xref="S3.Ex15.m1.4.4.1.3"><abs id="S3.Ex15.m1.4.4.1.2.1.cmml" xref="S3.Ex15.m1.4.4.1.3.1"></abs><ci id="S3.Ex15.m1.4.4.1.1.cmml" xref="S3.Ex15.m1.4.4.1.1">𝒟</ci></apply></apply><apply id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.cmml" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1"><minus id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.2.cmml" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.2"></minus><ci id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.3.cmml" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.3">𝛽</ci><apply id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.cmml" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1"><ci id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.2.cmml" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.2">𝔼</ci><apply id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.2.cmml" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.1.1"><times id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1"></times><apply id="S3.Ex15.m1.6.6.cmml" xref="S3.Ex15.m1.6.6"><divide id="S3.Ex15.m1.6.6.3.cmml" xref="S3.Ex15.m1.6.6"></divide><apply id="S3.Ex15.m1.5.5.1.cmml" xref="S3.Ex15.m1.5.5.1"><times id="S3.Ex15.m1.5.5.1.2.cmml" xref="S3.Ex15.m1.5.5.1.2"></times><ci id="S3.Ex15.m1.5.5.1.3.cmml" xref="S3.Ex15.m1.5.5.1.3">𝜋</ci><apply id="S3.Ex15.m1.5.5.1.1.1.1.cmml" xref="S3.Ex15.m1.5.5.1.1.1"><csymbol cd="latexml" id="S3.Ex15.m1.5.5.1.1.1.1.1.cmml" xref="S3.Ex15.m1.5.5.1.1.1.1.1">conditional</csymbol><ci id="S3.Ex15.m1.5.5.1.1.1.1.2.cmml" xref="S3.Ex15.m1.5.5.1.1.1.1.2">𝑎</ci><ci id="S3.Ex15.m1.5.5.1.1.1.1.3.cmml" xref="S3.Ex15.m1.5.5.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.Ex15.m1.6.6.2.cmml" xref="S3.Ex15.m1.6.6.2"><times id="S3.Ex15.m1.6.6.2.2.cmml" xref="S3.Ex15.m1.6.6.2.2"></times><apply id="S3.Ex15.m1.6.6.2.3.cmml" xref="S3.Ex15.m1.6.6.2.3"><csymbol cd="ambiguous" id="S3.Ex15.m1.6.6.2.3.1.cmml" xref="S3.Ex15.m1.6.6.2.3">subscript</csymbol><ci id="S3.Ex15.m1.6.6.2.3.2.cmml" xref="S3.Ex15.m1.6.6.2.3.2">𝜋</ci><cn id="S3.Ex15.m1.6.6.2.3.3.cmml" type="integer" xref="S3.Ex15.m1.6.6.2.3.3">0</cn></apply><apply id="S3.Ex15.m1.6.6.2.1.1.1.cmml" xref="S3.Ex15.m1.6.6.2.1.1"><csymbol cd="latexml" id="S3.Ex15.m1.6.6.2.1.1.1.1.cmml" xref="S3.Ex15.m1.6.6.2.1.1.1.1">conditional</csymbol><ci id="S3.Ex15.m1.6.6.2.1.1.1.2.cmml" xref="S3.Ex15.m1.6.6.2.1.1.1.2">𝑎</ci><ci id="S3.Ex15.m1.6.6.2.1.1.1.3.cmml" xref="S3.Ex15.m1.6.6.2.1.1.1.3">𝑥</ci></apply></apply></apply><ci id="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex15.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.2">𝑟</ci></apply></apply></apply></apply></apply></apply></apply><apply id="S3.Ex15.m1.7.7.1.1c.cmml" xref="S3.Ex15.m1.7.7.1"><eq id="S3.Ex15.m1.7.7.1.1.6.cmml" xref="S3.Ex15.m1.7.7.1.1.6"></eq><share href="https://arxiv.org/html/2405.05736v2#S3.Ex15.m1.7.7.1.1.2.cmml" id="S3.Ex15.m1.7.7.1.1d.cmml" xref="S3.Ex15.m1.7.7.1"></share><cn id="S3.Ex15.m1.7.7.1.1.7.cmml" type="integer" xref="S3.Ex15.m1.7.7.1.1.7">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex15.m1.7c">\displaystyle\quad\;=\frac{2}{\left|\mathcal{D}\right|}\mathop{\mathbb{E}}%
\left[\left(\frac{\pi(a|x)}{\pi_{0}(a|x)}\right)^{2}\left(\beta-r\right)\ %
\right]-\frac{2}{\left|\mathcal{D}\right|}\left(\beta-\mathop{\mathbb{E}}\left%
[\frac{\pi(a|x)}{\pi_{0}(a|x)}r\right]\right)=0,</annotation><annotation encoding="application/x-llamapun" id="S3.Ex15.m1.7d">= divide start_ARG 2 end_ARG start_ARG | caligraphic_D | end_ARG blackboard_E [ ( divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_β - italic_r ) ] - divide start_ARG 2 end_ARG start_ARG | caligraphic_D | end_ARG ( italic_β - blackboard_E [ divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG italic_r ] ) = 0 ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.7">which results in the following optimal baseline:
</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Ax1.EGx9">
<tbody id="S3.E38"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(38)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\beta^{*}" class="ltx_Math" display="inline" id="S3.E38.m1.1"><semantics id="S3.E38.m1.1a"><msup id="S3.E38.m1.1.1" xref="S3.E38.m1.1.1.cmml"><mi id="S3.E38.m1.1.1.2" xref="S3.E38.m1.1.1.2.cmml">β</mi><mo id="S3.E38.m1.1.1.3" xref="S3.E38.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.E38.m1.1b"><apply id="S3.E38.m1.1.1.cmml" xref="S3.E38.m1.1.1"><csymbol cd="ambiguous" id="S3.E38.m1.1.1.1.cmml" xref="S3.E38.m1.1.1">superscript</csymbol><ci id="S3.E38.m1.1.1.2.cmml" xref="S3.E38.m1.1.1.2">𝛽</ci><times id="S3.E38.m1.1.1.3.cmml" xref="S3.E38.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E38.m1.1c">\displaystyle\beta^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.E38.m1.1d">italic_β start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\mathop{\mathbb{E}}\left[\left(\left(\frac{\pi(a|x)}{\pi_{%
0}(a|x)}\right)^{2}-\frac{\pi(a|x)}{\pi_{0}(a|x)}\right)r(a,x)\right]}{\mathop%
{\mathbb{E}}\left[\left(\frac{\pi(a|x)}{\pi_{0}(a|x)}\right)^{2}-\left(\frac{%
\pi(a|x)}{\pi_{0}(a|x)}\right)\right]}." class="ltx_Math" display="inline" id="S3.E38.m2.13"><semantics id="S3.E38.m2.13a"><mrow id="S3.E38.m2.13.13.1" xref="S3.E38.m2.13.13.1.1.cmml"><mrow id="S3.E38.m2.13.13.1.1" xref="S3.E38.m2.13.13.1.1.cmml"><mi id="S3.E38.m2.13.13.1.1.2" xref="S3.E38.m2.13.13.1.1.2.cmml"></mi><mo id="S3.E38.m2.13.13.1.1.1" xref="S3.E38.m2.13.13.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E38.m2.12.12" xref="S3.E38.m2.12.12.cmml"><mfrac id="S3.E38.m2.12.12a" xref="S3.E38.m2.12.12.cmml"><mrow id="S3.E38.m2.7.7.7" xref="S3.E38.m2.7.7.7.cmml"><mo id="S3.E38.m2.7.7.7.8" rspace="0em" xref="S3.E38.m2.7.7.7.8.cmml">𝔼</mo><mrow id="S3.E38.m2.7.7.7.7.1" xref="S3.E38.m2.7.7.7.7.2.cmml"><mo id="S3.E38.m2.7.7.7.7.1.2" xref="S3.E38.m2.7.7.7.7.2.1.cmml">[</mo><mrow id="S3.E38.m2.7.7.7.7.1.1" xref="S3.E38.m2.7.7.7.7.1.1.cmml"><mrow id="S3.E38.m2.7.7.7.7.1.1.1.1" xref="S3.E38.m2.7.7.7.7.1.1.1.1.1.cmml"><mo id="S3.E38.m2.7.7.7.7.1.1.1.1.2" xref="S3.E38.m2.7.7.7.7.1.1.1.1.1.cmml">(</mo><mrow id="S3.E38.m2.7.7.7.7.1.1.1.1.1" xref="S3.E38.m2.7.7.7.7.1.1.1.1.1.cmml"><msup id="S3.E38.m2.7.7.7.7.1.1.1.1.1.2" xref="S3.E38.m2.7.7.7.7.1.1.1.1.1.2.cmml"><mrow id="S3.E38.m2.7.7.7.7.1.1.1.1.1.2.2.2" xref="S3.E38.m2.2.2.2.2.cmml"><mo id="S3.E38.m2.7.7.7.7.1.1.1.1.1.2.2.2.1" xref="S3.E38.m2.2.2.2.2.cmml">(</mo><mfrac id="S3.E38.m2.2.2.2.2" xref="S3.E38.m2.2.2.2.2.cmml"><mrow id="S3.E38.m2.1.1.1.1.1" xref="S3.E38.m2.1.1.1.1.1.cmml"><mi id="S3.E38.m2.1.1.1.1.1.3" xref="S3.E38.m2.1.1.1.1.1.3.cmml">π</mi><mo id="S3.E38.m2.1.1.1.1.1.2" xref="S3.E38.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E38.m2.1.1.1.1.1.1.1" xref="S3.E38.m2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E38.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E38.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E38.m2.1.1.1.1.1.1.1.1" xref="S3.E38.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E38.m2.1.1.1.1.1.1.1.1.2" xref="S3.E38.m2.1.1.1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E38.m2.1.1.1.1.1.1.1.1.1" xref="S3.E38.m2.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E38.m2.1.1.1.1.1.1.1.1.3" xref="S3.E38.m2.1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E38.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E38.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E38.m2.2.2.2.2.2" xref="S3.E38.m2.2.2.2.2.2.cmml"><msub id="S3.E38.m2.2.2.2.2.2.3" xref="S3.E38.m2.2.2.2.2.2.3.cmml"><mi id="S3.E38.m2.2.2.2.2.2.3.2" xref="S3.E38.m2.2.2.2.2.2.3.2.cmml">π</mi><mn id="S3.E38.m2.2.2.2.2.2.3.3" xref="S3.E38.m2.2.2.2.2.2.3.3.cmml">0</mn></msub><mo id="S3.E38.m2.2.2.2.2.2.2" xref="S3.E38.m2.2.2.2.2.2.2.cmml">⁢</mo><mrow id="S3.E38.m2.2.2.2.2.2.1.1" xref="S3.E38.m2.2.2.2.2.2.1.1.1.cmml"><mo id="S3.E38.m2.2.2.2.2.2.1.1.2" stretchy="false" xref="S3.E38.m2.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E38.m2.2.2.2.2.2.1.1.1" xref="S3.E38.m2.2.2.2.2.2.1.1.1.cmml"><mi id="S3.E38.m2.2.2.2.2.2.1.1.1.2" xref="S3.E38.m2.2.2.2.2.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E38.m2.2.2.2.2.2.1.1.1.1" xref="S3.E38.m2.2.2.2.2.2.1.1.1.1.cmml">|</mo><mi id="S3.E38.m2.2.2.2.2.2.1.1.1.3" xref="S3.E38.m2.2.2.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E38.m2.2.2.2.2.2.1.1.3" stretchy="false" xref="S3.E38.m2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E38.m2.7.7.7.7.1.1.1.1.1.2.2.2.2" xref="S3.E38.m2.2.2.2.2.cmml">)</mo></mrow><mn id="S3.E38.m2.7.7.7.7.1.1.1.1.1.2.3" xref="S3.E38.m2.7.7.7.7.1.1.1.1.1.2.3.cmml">2</mn></msup><mo id="S3.E38.m2.7.7.7.7.1.1.1.1.1.1" xref="S3.E38.m2.7.7.7.7.1.1.1.1.1.1.cmml">−</mo><mfrac id="S3.E38.m2.4.4.4.4" xref="S3.E38.m2.4.4.4.4.cmml"><mrow id="S3.E38.m2.3.3.3.3.1" xref="S3.E38.m2.3.3.3.3.1.cmml"><mi id="S3.E38.m2.3.3.3.3.1.3" xref="S3.E38.m2.3.3.3.3.1.3.cmml">π</mi><mo id="S3.E38.m2.3.3.3.3.1.2" xref="S3.E38.m2.3.3.3.3.1.2.cmml">⁢</mo><mrow id="S3.E38.m2.3.3.3.3.1.1.1" xref="S3.E38.m2.3.3.3.3.1.1.1.1.cmml"><mo id="S3.E38.m2.3.3.3.3.1.1.1.2" stretchy="false" xref="S3.E38.m2.3.3.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E38.m2.3.3.3.3.1.1.1.1" xref="S3.E38.m2.3.3.3.3.1.1.1.1.cmml"><mi id="S3.E38.m2.3.3.3.3.1.1.1.1.2" xref="S3.E38.m2.3.3.3.3.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E38.m2.3.3.3.3.1.1.1.1.1" xref="S3.E38.m2.3.3.3.3.1.1.1.1.1.cmml">|</mo><mi id="S3.E38.m2.3.3.3.3.1.1.1.1.3" xref="S3.E38.m2.3.3.3.3.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E38.m2.3.3.3.3.1.1.1.3" stretchy="false" xref="S3.E38.m2.3.3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E38.m2.4.4.4.4.2" xref="S3.E38.m2.4.4.4.4.2.cmml"><msub id="S3.E38.m2.4.4.4.4.2.3" xref="S3.E38.m2.4.4.4.4.2.3.cmml"><mi id="S3.E38.m2.4.4.4.4.2.3.2" xref="S3.E38.m2.4.4.4.4.2.3.2.cmml">π</mi><mn id="S3.E38.m2.4.4.4.4.2.3.3" xref="S3.E38.m2.4.4.4.4.2.3.3.cmml">0</mn></msub><mo id="S3.E38.m2.4.4.4.4.2.2" xref="S3.E38.m2.4.4.4.4.2.2.cmml">⁢</mo><mrow id="S3.E38.m2.4.4.4.4.2.1.1" xref="S3.E38.m2.4.4.4.4.2.1.1.1.cmml"><mo id="S3.E38.m2.4.4.4.4.2.1.1.2" stretchy="false" xref="S3.E38.m2.4.4.4.4.2.1.1.1.cmml">(</mo><mrow id="S3.E38.m2.4.4.4.4.2.1.1.1" xref="S3.E38.m2.4.4.4.4.2.1.1.1.cmml"><mi id="S3.E38.m2.4.4.4.4.2.1.1.1.2" xref="S3.E38.m2.4.4.4.4.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E38.m2.4.4.4.4.2.1.1.1.1" xref="S3.E38.m2.4.4.4.4.2.1.1.1.1.cmml">|</mo><mi id="S3.E38.m2.4.4.4.4.2.1.1.1.3" xref="S3.E38.m2.4.4.4.4.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E38.m2.4.4.4.4.2.1.1.3" stretchy="false" xref="S3.E38.m2.4.4.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S3.E38.m2.7.7.7.7.1.1.1.1.3" xref="S3.E38.m2.7.7.7.7.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E38.m2.7.7.7.7.1.1.2" xref="S3.E38.m2.7.7.7.7.1.1.2.cmml">⁢</mo><mi id="S3.E38.m2.7.7.7.7.1.1.3" xref="S3.E38.m2.7.7.7.7.1.1.3.cmml">r</mi><mo id="S3.E38.m2.7.7.7.7.1.1.2a" xref="S3.E38.m2.7.7.7.7.1.1.2.cmml">⁢</mo><mrow id="S3.E38.m2.7.7.7.7.1.1.4.2" xref="S3.E38.m2.7.7.7.7.1.1.4.1.cmml"><mo id="S3.E38.m2.7.7.7.7.1.1.4.2.1" stretchy="false" xref="S3.E38.m2.7.7.7.7.1.1.4.1.cmml">(</mo><mi id="S3.E38.m2.5.5.5.5" xref="S3.E38.m2.5.5.5.5.cmml">a</mi><mo id="S3.E38.m2.7.7.7.7.1.1.4.2.2" xref="S3.E38.m2.7.7.7.7.1.1.4.1.cmml">,</mo><mi id="S3.E38.m2.6.6.6.6" xref="S3.E38.m2.6.6.6.6.cmml">x</mi><mo id="S3.E38.m2.7.7.7.7.1.1.4.2.3" stretchy="false" xref="S3.E38.m2.7.7.7.7.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="S3.E38.m2.7.7.7.7.1.3" xref="S3.E38.m2.7.7.7.7.2.1.cmml">]</mo></mrow></mrow><mrow id="S3.E38.m2.12.12.12" xref="S3.E38.m2.12.12.12.cmml"><mo id="S3.E38.m2.12.12.12.6" rspace="0em" xref="S3.E38.m2.12.12.12.6.cmml">𝔼</mo><mrow id="S3.E38.m2.12.12.12.5.1" xref="S3.E38.m2.12.12.12.5.2.cmml"><mo id="S3.E38.m2.12.12.12.5.1.2" xref="S3.E38.m2.12.12.12.5.2.1.cmml">[</mo><mrow id="S3.E38.m2.12.12.12.5.1.1" xref="S3.E38.m2.12.12.12.5.1.1.cmml"><msup id="S3.E38.m2.12.12.12.5.1.1.2" xref="S3.E38.m2.12.12.12.5.1.1.2.cmml"><mrow id="S3.E38.m2.12.12.12.5.1.1.2.2.2" xref="S3.E38.m2.9.9.9.2.cmml"><mo id="S3.E38.m2.12.12.12.5.1.1.2.2.2.1" xref="S3.E38.m2.9.9.9.2.cmml">(</mo><mfrac id="S3.E38.m2.9.9.9.2" xref="S3.E38.m2.9.9.9.2.cmml"><mrow id="S3.E38.m2.8.8.8.1.1" xref="S3.E38.m2.8.8.8.1.1.cmml"><mi id="S3.E38.m2.8.8.8.1.1.3" xref="S3.E38.m2.8.8.8.1.1.3.cmml">π</mi><mo id="S3.E38.m2.8.8.8.1.1.2" xref="S3.E38.m2.8.8.8.1.1.2.cmml">⁢</mo><mrow id="S3.E38.m2.8.8.8.1.1.1.1" xref="S3.E38.m2.8.8.8.1.1.1.1.1.cmml"><mo id="S3.E38.m2.8.8.8.1.1.1.1.2" stretchy="false" xref="S3.E38.m2.8.8.8.1.1.1.1.1.cmml">(</mo><mrow id="S3.E38.m2.8.8.8.1.1.1.1.1" xref="S3.E38.m2.8.8.8.1.1.1.1.1.cmml"><mi id="S3.E38.m2.8.8.8.1.1.1.1.1.2" xref="S3.E38.m2.8.8.8.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E38.m2.8.8.8.1.1.1.1.1.1" xref="S3.E38.m2.8.8.8.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E38.m2.8.8.8.1.1.1.1.1.3" xref="S3.E38.m2.8.8.8.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E38.m2.8.8.8.1.1.1.1.3" stretchy="false" xref="S3.E38.m2.8.8.8.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E38.m2.9.9.9.2.2" xref="S3.E38.m2.9.9.9.2.2.cmml"><msub id="S3.E38.m2.9.9.9.2.2.3" xref="S3.E38.m2.9.9.9.2.2.3.cmml"><mi id="S3.E38.m2.9.9.9.2.2.3.2" xref="S3.E38.m2.9.9.9.2.2.3.2.cmml">π</mi><mn id="S3.E38.m2.9.9.9.2.2.3.3" xref="S3.E38.m2.9.9.9.2.2.3.3.cmml">0</mn></msub><mo id="S3.E38.m2.9.9.9.2.2.2" xref="S3.E38.m2.9.9.9.2.2.2.cmml">⁢</mo><mrow id="S3.E38.m2.9.9.9.2.2.1.1" xref="S3.E38.m2.9.9.9.2.2.1.1.1.cmml"><mo id="S3.E38.m2.9.9.9.2.2.1.1.2" stretchy="false" xref="S3.E38.m2.9.9.9.2.2.1.1.1.cmml">(</mo><mrow id="S3.E38.m2.9.9.9.2.2.1.1.1" xref="S3.E38.m2.9.9.9.2.2.1.1.1.cmml"><mi id="S3.E38.m2.9.9.9.2.2.1.1.1.2" xref="S3.E38.m2.9.9.9.2.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E38.m2.9.9.9.2.2.1.1.1.1" xref="S3.E38.m2.9.9.9.2.2.1.1.1.1.cmml">|</mo><mi id="S3.E38.m2.9.9.9.2.2.1.1.1.3" xref="S3.E38.m2.9.9.9.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E38.m2.9.9.9.2.2.1.1.3" stretchy="false" xref="S3.E38.m2.9.9.9.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E38.m2.12.12.12.5.1.1.2.2.2.2" xref="S3.E38.m2.9.9.9.2.cmml">)</mo></mrow><mn id="S3.E38.m2.12.12.12.5.1.1.2.3" xref="S3.E38.m2.12.12.12.5.1.1.2.3.cmml">2</mn></msup><mo id="S3.E38.m2.12.12.12.5.1.1.1" xref="S3.E38.m2.12.12.12.5.1.1.1.cmml">−</mo><mrow id="S3.E38.m2.12.12.12.5.1.1.3.2" xref="S3.E38.m2.11.11.11.4.cmml"><mo id="S3.E38.m2.12.12.12.5.1.1.3.2.1" xref="S3.E38.m2.11.11.11.4.cmml">(</mo><mfrac id="S3.E38.m2.11.11.11.4" xref="S3.E38.m2.11.11.11.4.cmml"><mrow id="S3.E38.m2.10.10.10.3.1" xref="S3.E38.m2.10.10.10.3.1.cmml"><mi id="S3.E38.m2.10.10.10.3.1.3" xref="S3.E38.m2.10.10.10.3.1.3.cmml">π</mi><mo id="S3.E38.m2.10.10.10.3.1.2" xref="S3.E38.m2.10.10.10.3.1.2.cmml">⁢</mo><mrow id="S3.E38.m2.10.10.10.3.1.1.1" xref="S3.E38.m2.10.10.10.3.1.1.1.1.cmml"><mo id="S3.E38.m2.10.10.10.3.1.1.1.2" stretchy="false" xref="S3.E38.m2.10.10.10.3.1.1.1.1.cmml">(</mo><mrow id="S3.E38.m2.10.10.10.3.1.1.1.1" xref="S3.E38.m2.10.10.10.3.1.1.1.1.cmml"><mi id="S3.E38.m2.10.10.10.3.1.1.1.1.2" xref="S3.E38.m2.10.10.10.3.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E38.m2.10.10.10.3.1.1.1.1.1" xref="S3.E38.m2.10.10.10.3.1.1.1.1.1.cmml">|</mo><mi id="S3.E38.m2.10.10.10.3.1.1.1.1.3" xref="S3.E38.m2.10.10.10.3.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E38.m2.10.10.10.3.1.1.1.3" stretchy="false" xref="S3.E38.m2.10.10.10.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E38.m2.11.11.11.4.2" xref="S3.E38.m2.11.11.11.4.2.cmml"><msub id="S3.E38.m2.11.11.11.4.2.3" xref="S3.E38.m2.11.11.11.4.2.3.cmml"><mi id="S3.E38.m2.11.11.11.4.2.3.2" xref="S3.E38.m2.11.11.11.4.2.3.2.cmml">π</mi><mn id="S3.E38.m2.11.11.11.4.2.3.3" xref="S3.E38.m2.11.11.11.4.2.3.3.cmml">0</mn></msub><mo id="S3.E38.m2.11.11.11.4.2.2" xref="S3.E38.m2.11.11.11.4.2.2.cmml">⁢</mo><mrow id="S3.E38.m2.11.11.11.4.2.1.1" xref="S3.E38.m2.11.11.11.4.2.1.1.1.cmml"><mo id="S3.E38.m2.11.11.11.4.2.1.1.2" stretchy="false" xref="S3.E38.m2.11.11.11.4.2.1.1.1.cmml">(</mo><mrow id="S3.E38.m2.11.11.11.4.2.1.1.1" xref="S3.E38.m2.11.11.11.4.2.1.1.1.cmml"><mi id="S3.E38.m2.11.11.11.4.2.1.1.1.2" xref="S3.E38.m2.11.11.11.4.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E38.m2.11.11.11.4.2.1.1.1.1" xref="S3.E38.m2.11.11.11.4.2.1.1.1.1.cmml">|</mo><mi id="S3.E38.m2.11.11.11.4.2.1.1.1.3" xref="S3.E38.m2.11.11.11.4.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E38.m2.11.11.11.4.2.1.1.3" stretchy="false" xref="S3.E38.m2.11.11.11.4.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E38.m2.12.12.12.5.1.1.3.2.2" xref="S3.E38.m2.11.11.11.4.cmml">)</mo></mrow></mrow><mo id="S3.E38.m2.12.12.12.5.1.3" xref="S3.E38.m2.12.12.12.5.2.1.cmml">]</mo></mrow></mrow></mfrac></mstyle></mrow><mo id="S3.E38.m2.13.13.1.2" lspace="0em" xref="S3.E38.m2.13.13.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E38.m2.13b"><apply id="S3.E38.m2.13.13.1.1.cmml" xref="S3.E38.m2.13.13.1"><eq id="S3.E38.m2.13.13.1.1.1.cmml" xref="S3.E38.m2.13.13.1.1.1"></eq><csymbol cd="latexml" id="S3.E38.m2.13.13.1.1.2.cmml" xref="S3.E38.m2.13.13.1.1.2">absent</csymbol><apply id="S3.E38.m2.12.12.cmml" xref="S3.E38.m2.12.12"><divide id="S3.E38.m2.12.12.13.cmml" xref="S3.E38.m2.12.12"></divide><apply id="S3.E38.m2.7.7.7.cmml" xref="S3.E38.m2.7.7.7"><ci id="S3.E38.m2.7.7.7.8.cmml" xref="S3.E38.m2.7.7.7.8">𝔼</ci><apply id="S3.E38.m2.7.7.7.7.2.cmml" xref="S3.E38.m2.7.7.7.7.1"><csymbol cd="latexml" id="S3.E38.m2.7.7.7.7.2.1.cmml" xref="S3.E38.m2.7.7.7.7.1.2">delimited-[]</csymbol><apply id="S3.E38.m2.7.7.7.7.1.1.cmml" xref="S3.E38.m2.7.7.7.7.1.1"><times id="S3.E38.m2.7.7.7.7.1.1.2.cmml" xref="S3.E38.m2.7.7.7.7.1.1.2"></times><apply id="S3.E38.m2.7.7.7.7.1.1.1.1.1.cmml" xref="S3.E38.m2.7.7.7.7.1.1.1.1"><minus id="S3.E38.m2.7.7.7.7.1.1.1.1.1.1.cmml" xref="S3.E38.m2.7.7.7.7.1.1.1.1.1.1"></minus><apply id="S3.E38.m2.7.7.7.7.1.1.1.1.1.2.cmml" xref="S3.E38.m2.7.7.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E38.m2.7.7.7.7.1.1.1.1.1.2.1.cmml" xref="S3.E38.m2.7.7.7.7.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E38.m2.2.2.2.2.cmml" xref="S3.E38.m2.7.7.7.7.1.1.1.1.1.2.2.2"><divide id="S3.E38.m2.2.2.2.2.3.cmml" xref="S3.E38.m2.7.7.7.7.1.1.1.1.1.2.2.2"></divide><apply id="S3.E38.m2.1.1.1.1.1.cmml" xref="S3.E38.m2.1.1.1.1.1"><times id="S3.E38.m2.1.1.1.1.1.2.cmml" xref="S3.E38.m2.1.1.1.1.1.2"></times><ci id="S3.E38.m2.1.1.1.1.1.3.cmml" xref="S3.E38.m2.1.1.1.1.1.3">𝜋</ci><apply id="S3.E38.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E38.m2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E38.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E38.m2.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E38.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E38.m2.1.1.1.1.1.1.1.1.2">𝑎</ci><ci id="S3.E38.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E38.m2.1.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.E38.m2.2.2.2.2.2.cmml" xref="S3.E38.m2.2.2.2.2.2"><times id="S3.E38.m2.2.2.2.2.2.2.cmml" xref="S3.E38.m2.2.2.2.2.2.2"></times><apply id="S3.E38.m2.2.2.2.2.2.3.cmml" xref="S3.E38.m2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E38.m2.2.2.2.2.2.3.1.cmml" xref="S3.E38.m2.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E38.m2.2.2.2.2.2.3.2.cmml" xref="S3.E38.m2.2.2.2.2.2.3.2">𝜋</ci><cn id="S3.E38.m2.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.E38.m2.2.2.2.2.2.3.3">0</cn></apply><apply id="S3.E38.m2.2.2.2.2.2.1.1.1.cmml" xref="S3.E38.m2.2.2.2.2.2.1.1"><csymbol cd="latexml" id="S3.E38.m2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E38.m2.2.2.2.2.2.1.1.1.1">conditional</csymbol><ci id="S3.E38.m2.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E38.m2.2.2.2.2.2.1.1.1.2">𝑎</ci><ci id="S3.E38.m2.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E38.m2.2.2.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply><cn id="S3.E38.m2.7.7.7.7.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.E38.m2.7.7.7.7.1.1.1.1.1.2.3">2</cn></apply><apply id="S3.E38.m2.4.4.4.4.cmml" xref="S3.E38.m2.4.4.4.4"><divide id="S3.E38.m2.4.4.4.4.3.cmml" xref="S3.E38.m2.4.4.4.4"></divide><apply id="S3.E38.m2.3.3.3.3.1.cmml" xref="S3.E38.m2.3.3.3.3.1"><times id="S3.E38.m2.3.3.3.3.1.2.cmml" xref="S3.E38.m2.3.3.3.3.1.2"></times><ci id="S3.E38.m2.3.3.3.3.1.3.cmml" xref="S3.E38.m2.3.3.3.3.1.3">𝜋</ci><apply id="S3.E38.m2.3.3.3.3.1.1.1.1.cmml" xref="S3.E38.m2.3.3.3.3.1.1.1"><csymbol cd="latexml" id="S3.E38.m2.3.3.3.3.1.1.1.1.1.cmml" xref="S3.E38.m2.3.3.3.3.1.1.1.1.1">conditional</csymbol><ci id="S3.E38.m2.3.3.3.3.1.1.1.1.2.cmml" xref="S3.E38.m2.3.3.3.3.1.1.1.1.2">𝑎</ci><ci id="S3.E38.m2.3.3.3.3.1.1.1.1.3.cmml" xref="S3.E38.m2.3.3.3.3.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.E38.m2.4.4.4.4.2.cmml" xref="S3.E38.m2.4.4.4.4.2"><times id="S3.E38.m2.4.4.4.4.2.2.cmml" xref="S3.E38.m2.4.4.4.4.2.2"></times><apply id="S3.E38.m2.4.4.4.4.2.3.cmml" xref="S3.E38.m2.4.4.4.4.2.3"><csymbol cd="ambiguous" id="S3.E38.m2.4.4.4.4.2.3.1.cmml" xref="S3.E38.m2.4.4.4.4.2.3">subscript</csymbol><ci id="S3.E38.m2.4.4.4.4.2.3.2.cmml" xref="S3.E38.m2.4.4.4.4.2.3.2">𝜋</ci><cn id="S3.E38.m2.4.4.4.4.2.3.3.cmml" type="integer" xref="S3.E38.m2.4.4.4.4.2.3.3">0</cn></apply><apply id="S3.E38.m2.4.4.4.4.2.1.1.1.cmml" xref="S3.E38.m2.4.4.4.4.2.1.1"><csymbol cd="latexml" id="S3.E38.m2.4.4.4.4.2.1.1.1.1.cmml" xref="S3.E38.m2.4.4.4.4.2.1.1.1.1">conditional</csymbol><ci id="S3.E38.m2.4.4.4.4.2.1.1.1.2.cmml" xref="S3.E38.m2.4.4.4.4.2.1.1.1.2">𝑎</ci><ci id="S3.E38.m2.4.4.4.4.2.1.1.1.3.cmml" xref="S3.E38.m2.4.4.4.4.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply><ci id="S3.E38.m2.7.7.7.7.1.1.3.cmml" xref="S3.E38.m2.7.7.7.7.1.1.3">𝑟</ci><interval closure="open" id="S3.E38.m2.7.7.7.7.1.1.4.1.cmml" xref="S3.E38.m2.7.7.7.7.1.1.4.2"><ci id="S3.E38.m2.5.5.5.5.cmml" xref="S3.E38.m2.5.5.5.5">𝑎</ci><ci id="S3.E38.m2.6.6.6.6.cmml" xref="S3.E38.m2.6.6.6.6">𝑥</ci></interval></apply></apply></apply><apply id="S3.E38.m2.12.12.12.cmml" xref="S3.E38.m2.12.12.12"><ci id="S3.E38.m2.12.12.12.6.cmml" xref="S3.E38.m2.12.12.12.6">𝔼</ci><apply id="S3.E38.m2.12.12.12.5.2.cmml" xref="S3.E38.m2.12.12.12.5.1"><csymbol cd="latexml" id="S3.E38.m2.12.12.12.5.2.1.cmml" xref="S3.E38.m2.12.12.12.5.1.2">delimited-[]</csymbol><apply id="S3.E38.m2.12.12.12.5.1.1.cmml" xref="S3.E38.m2.12.12.12.5.1.1"><minus id="S3.E38.m2.12.12.12.5.1.1.1.cmml" xref="S3.E38.m2.12.12.12.5.1.1.1"></minus><apply id="S3.E38.m2.12.12.12.5.1.1.2.cmml" xref="S3.E38.m2.12.12.12.5.1.1.2"><csymbol cd="ambiguous" id="S3.E38.m2.12.12.12.5.1.1.2.1.cmml" xref="S3.E38.m2.12.12.12.5.1.1.2">superscript</csymbol><apply id="S3.E38.m2.9.9.9.2.cmml" xref="S3.E38.m2.12.12.12.5.1.1.2.2.2"><divide id="S3.E38.m2.9.9.9.2.3.cmml" xref="S3.E38.m2.12.12.12.5.1.1.2.2.2"></divide><apply id="S3.E38.m2.8.8.8.1.1.cmml" xref="S3.E38.m2.8.8.8.1.1"><times id="S3.E38.m2.8.8.8.1.1.2.cmml" xref="S3.E38.m2.8.8.8.1.1.2"></times><ci id="S3.E38.m2.8.8.8.1.1.3.cmml" xref="S3.E38.m2.8.8.8.1.1.3">𝜋</ci><apply id="S3.E38.m2.8.8.8.1.1.1.1.1.cmml" xref="S3.E38.m2.8.8.8.1.1.1.1"><csymbol cd="latexml" id="S3.E38.m2.8.8.8.1.1.1.1.1.1.cmml" xref="S3.E38.m2.8.8.8.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E38.m2.8.8.8.1.1.1.1.1.2.cmml" xref="S3.E38.m2.8.8.8.1.1.1.1.1.2">𝑎</ci><ci id="S3.E38.m2.8.8.8.1.1.1.1.1.3.cmml" xref="S3.E38.m2.8.8.8.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.E38.m2.9.9.9.2.2.cmml" xref="S3.E38.m2.9.9.9.2.2"><times id="S3.E38.m2.9.9.9.2.2.2.cmml" xref="S3.E38.m2.9.9.9.2.2.2"></times><apply id="S3.E38.m2.9.9.9.2.2.3.cmml" xref="S3.E38.m2.9.9.9.2.2.3"><csymbol cd="ambiguous" id="S3.E38.m2.9.9.9.2.2.3.1.cmml" xref="S3.E38.m2.9.9.9.2.2.3">subscript</csymbol><ci id="S3.E38.m2.9.9.9.2.2.3.2.cmml" xref="S3.E38.m2.9.9.9.2.2.3.2">𝜋</ci><cn id="S3.E38.m2.9.9.9.2.2.3.3.cmml" type="integer" xref="S3.E38.m2.9.9.9.2.2.3.3">0</cn></apply><apply id="S3.E38.m2.9.9.9.2.2.1.1.1.cmml" xref="S3.E38.m2.9.9.9.2.2.1.1"><csymbol cd="latexml" id="S3.E38.m2.9.9.9.2.2.1.1.1.1.cmml" xref="S3.E38.m2.9.9.9.2.2.1.1.1.1">conditional</csymbol><ci id="S3.E38.m2.9.9.9.2.2.1.1.1.2.cmml" xref="S3.E38.m2.9.9.9.2.2.1.1.1.2">𝑎</ci><ci id="S3.E38.m2.9.9.9.2.2.1.1.1.3.cmml" xref="S3.E38.m2.9.9.9.2.2.1.1.1.3">𝑥</ci></apply></apply></apply><cn id="S3.E38.m2.12.12.12.5.1.1.2.3.cmml" type="integer" xref="S3.E38.m2.12.12.12.5.1.1.2.3">2</cn></apply><apply id="S3.E38.m2.11.11.11.4.cmml" xref="S3.E38.m2.12.12.12.5.1.1.3.2"><divide id="S3.E38.m2.11.11.11.4.3.cmml" xref="S3.E38.m2.12.12.12.5.1.1.3.2"></divide><apply id="S3.E38.m2.10.10.10.3.1.cmml" xref="S3.E38.m2.10.10.10.3.1"><times id="S3.E38.m2.10.10.10.3.1.2.cmml" xref="S3.E38.m2.10.10.10.3.1.2"></times><ci id="S3.E38.m2.10.10.10.3.1.3.cmml" xref="S3.E38.m2.10.10.10.3.1.3">𝜋</ci><apply id="S3.E38.m2.10.10.10.3.1.1.1.1.cmml" xref="S3.E38.m2.10.10.10.3.1.1.1"><csymbol cd="latexml" id="S3.E38.m2.10.10.10.3.1.1.1.1.1.cmml" xref="S3.E38.m2.10.10.10.3.1.1.1.1.1">conditional</csymbol><ci id="S3.E38.m2.10.10.10.3.1.1.1.1.2.cmml" xref="S3.E38.m2.10.10.10.3.1.1.1.1.2">𝑎</ci><ci id="S3.E38.m2.10.10.10.3.1.1.1.1.3.cmml" xref="S3.E38.m2.10.10.10.3.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.E38.m2.11.11.11.4.2.cmml" xref="S3.E38.m2.11.11.11.4.2"><times id="S3.E38.m2.11.11.11.4.2.2.cmml" xref="S3.E38.m2.11.11.11.4.2.2"></times><apply id="S3.E38.m2.11.11.11.4.2.3.cmml" xref="S3.E38.m2.11.11.11.4.2.3"><csymbol cd="ambiguous" id="S3.E38.m2.11.11.11.4.2.3.1.cmml" xref="S3.E38.m2.11.11.11.4.2.3">subscript</csymbol><ci id="S3.E38.m2.11.11.11.4.2.3.2.cmml" xref="S3.E38.m2.11.11.11.4.2.3.2">𝜋</ci><cn id="S3.E38.m2.11.11.11.4.2.3.3.cmml" type="integer" xref="S3.E38.m2.11.11.11.4.2.3.3">0</cn></apply><apply id="S3.E38.m2.11.11.11.4.2.1.1.1.cmml" xref="S3.E38.m2.11.11.11.4.2.1.1"><csymbol cd="latexml" id="S3.E38.m2.11.11.11.4.2.1.1.1.1.cmml" xref="S3.E38.m2.11.11.11.4.2.1.1.1.1">conditional</csymbol><ci id="S3.E38.m2.11.11.11.4.2.1.1.1.2.cmml" xref="S3.E38.m2.11.11.11.4.2.1.1.1.2">𝑎</ci><ci id="S3.E38.m2.11.11.11.4.2.1.1.1.3.cmml" xref="S3.E38.m2.11.11.11.4.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E38.m2.13c">\displaystyle=\frac{\mathop{\mathbb{E}}\left[\left(\left(\frac{\pi(a|x)}{\pi_{%
0}(a|x)}\right)^{2}-\frac{\pi(a|x)}{\pi_{0}(a|x)}\right)r(a,x)\right]}{\mathop%
{\mathbb{E}}\left[\left(\frac{\pi(a|x)}{\pi_{0}(a|x)}\right)^{2}-\left(\frac{%
\pi(a|x)}{\pi_{0}(a|x)}\right)\right]}.</annotation><annotation encoding="application/x-llamapun" id="S3.E38.m2.13d">= divide start_ARG blackboard_E [ ( ( divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ) italic_r ( italic_a , italic_x ) ] end_ARG start_ARG blackboard_E [ ( divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - ( divide start_ARG italic_π ( italic_a | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a | italic_x ) end_ARG ) ] end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.5">We can estimate <math alttext="\beta^{*}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m1.1"><semantics id="S3.SS3.p1.4.m1.1a"><msup id="S3.SS3.p1.4.m1.1.1" xref="S3.SS3.p1.4.m1.1.1.cmml"><mi id="S3.SS3.p1.4.m1.1.1.2" xref="S3.SS3.p1.4.m1.1.1.2.cmml">β</mi><mo id="S3.SS3.p1.4.m1.1.1.3" xref="S3.SS3.p1.4.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m1.1b"><apply id="S3.SS3.p1.4.m1.1.1.cmml" xref="S3.SS3.p1.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m1.1.1.1.cmml" xref="S3.SS3.p1.4.m1.1.1">superscript</csymbol><ci id="S3.SS3.p1.4.m1.1.1.2.cmml" xref="S3.SS3.p1.4.m1.1.1.2">𝛽</ci><times id="S3.SS3.p1.4.m1.1.1.3.cmml" xref="S3.SS3.p1.4.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m1.1c">\beta^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m1.1d">italic_β start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> using logged data, resulting in a Monte Carlo estimate of the optimal baseline.
Such a sample estimate will not be unbiased (because it is a ratio of expectations), but the bias will vanish asymptotically (similar to the bias of the <math alttext="\widehat{V}_{\rm SNIPS}" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m2.1"><semantics id="S3.SS3.p1.5.m2.1a"><msub id="S3.SS3.p1.5.m2.1.1" xref="S3.SS3.p1.5.m2.1.1.cmml"><mover accent="true" id="S3.SS3.p1.5.m2.1.1.2" xref="S3.SS3.p1.5.m2.1.1.2.cmml"><mi id="S3.SS3.p1.5.m2.1.1.2.2" xref="S3.SS3.p1.5.m2.1.1.2.2.cmml">V</mi><mo id="S3.SS3.p1.5.m2.1.1.2.1" xref="S3.SS3.p1.5.m2.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p1.5.m2.1.1.3" xref="S3.SS3.p1.5.m2.1.1.3.cmml">SNIPS</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m2.1b"><apply id="S3.SS3.p1.5.m2.1.1.cmml" xref="S3.SS3.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m2.1.1.1.cmml" xref="S3.SS3.p1.5.m2.1.1">subscript</csymbol><apply id="S3.SS3.p1.5.m2.1.1.2.cmml" xref="S3.SS3.p1.5.m2.1.1.2"><ci id="S3.SS3.p1.5.m2.1.1.2.1.cmml" xref="S3.SS3.p1.5.m2.1.1.2.1">^</ci><ci id="S3.SS3.p1.5.m2.1.1.2.2.cmml" xref="S3.SS3.p1.5.m2.1.1.2.2">𝑉</ci></apply><ci id="S3.SS3.p1.5.m2.1.1.3.cmml" xref="S3.SS3.p1.5.m2.1.1.3">SNIPS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m2.1c">\widehat{V}_{\rm SNIPS}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m2.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_SNIPS end_POSTSUBSCRIPT</annotation></semantics></math> estimator).</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">Next, we formally prove that optimal estimator variance leads to overall optimality (in terms of the MSE of the estimator).</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="S3.Thmtheorem2">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Theorem 2.</h6>
<div class="ltx_para" id="S3.Thmtheorem2.p1">
<p class="ltx_p" id="S3.Thmtheorem2.p1.3"><span class="ltx_text ltx_font_italic" id="S3.Thmtheorem2.p1.3.3">Within the family of offline estimators with a global additive control variate, i.e., <math alttext="\beta" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.1.1.m1.1"><semantics id="S3.Thmtheorem2.p1.1.1.m1.1a"><mi id="S3.Thmtheorem2.p1.1.1.m1.1.1" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.1.1.m1.1b"><ci id="S3.Thmtheorem2.p1.1.1.m1.1.1.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem2.p1.1.1.m1.1d">italic_β</annotation></semantics></math>-IPS (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E21" title="In 3.1. A unified off-policy estimator ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">21</span></a>), IPS (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S2.E12" title="In 2.2. Off-policy estimation for general bandits ‣ 2. Background and Related Work ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">12</span></a>), and DR with a constant correction (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E25" title="In 3.1. A unified off-policy estimator ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">25</span></a>), <math alttext="\beta" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.2.2.m2.1"><semantics id="S3.Thmtheorem2.p1.2.2.m2.1a"><mi id="S3.Thmtheorem2.p1.2.2.m2.1.1" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.2.2.m2.1b"><ci id="S3.Thmtheorem2.p1.2.2.m2.1.1.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.2.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem2.p1.2.2.m2.1d">italic_β</annotation></semantics></math>-IPS with our proposed <math alttext="\beta" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.3.3.m3.1"><semantics id="S3.Thmtheorem2.p1.3.3.m3.1a"><mi id="S3.Thmtheorem2.p1.3.3.m3.1.1" xref="S3.Thmtheorem2.p1.3.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.3.3.m3.1b"><ci id="S3.Thmtheorem2.p1.3.3.m3.1.1.cmml" xref="S3.Thmtheorem2.p1.3.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.3.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem2.p1.3.3.m3.1d">italic_β</annotation></semantics></math> in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E38" title="In 3.3. Minimizing estimation variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">38</span></a> has the minimum mean squared error (MSE):</span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E39">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(39)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\rm MSE}(\hat{V}(\pi))\coloneq\mathbb{E}_{\mathcal{D}}\left[(\hat{V}(\pi,%
\mathcal{D})-V(\pi))^{2}\right]." class="ltx_Math" display="block" id="S3.E39.m1.5"><semantics id="S3.E39.m1.5a"><mrow id="S3.E39.m1.5.5.1" xref="S3.E39.m1.5.5.1.1.cmml"><mrow id="S3.E39.m1.5.5.1.1" xref="S3.E39.m1.5.5.1.1.cmml"><mrow id="S3.E39.m1.5.5.1.1.1" xref="S3.E39.m1.5.5.1.1.1.cmml"><mi id="S3.E39.m1.5.5.1.1.1.3" xref="S3.E39.m1.5.5.1.1.1.3.cmml">MSE</mi><mo id="S3.E39.m1.5.5.1.1.1.2" xref="S3.E39.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E39.m1.5.5.1.1.1.1.1" xref="S3.E39.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S3.E39.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.E39.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E39.m1.5.5.1.1.1.1.1.1" xref="S3.E39.m1.5.5.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E39.m1.5.5.1.1.1.1.1.1.2" xref="S3.E39.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="S3.E39.m1.5.5.1.1.1.1.1.1.2.2" xref="S3.E39.m1.5.5.1.1.1.1.1.1.2.2.cmml">V</mi><mo id="S3.E39.m1.5.5.1.1.1.1.1.1.2.1" xref="S3.E39.m1.5.5.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S3.E39.m1.5.5.1.1.1.1.1.1.1" xref="S3.E39.m1.5.5.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E39.m1.5.5.1.1.1.1.1.1.3.2" xref="S3.E39.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S3.E39.m1.5.5.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E39.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E39.m1.1.1" xref="S3.E39.m1.1.1.cmml">π</mi><mo id="S3.E39.m1.5.5.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E39.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E39.m1.5.5.1.1.1.1.1.3" rspace="0.278em" stretchy="false" xref="S3.E39.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E39.m1.5.5.1.1.3" rspace="0.278em" xref="S3.E39.m1.5.5.1.1.3.cmml">:-</mo><mrow id="S3.E39.m1.5.5.1.1.2" xref="S3.E39.m1.5.5.1.1.2.cmml"><msub id="S3.E39.m1.5.5.1.1.2.3" xref="S3.E39.m1.5.5.1.1.2.3.cmml"><mi id="S3.E39.m1.5.5.1.1.2.3.2" xref="S3.E39.m1.5.5.1.1.2.3.2.cmml">𝔼</mi><mi class="ltx_font_mathcaligraphic" id="S3.E39.m1.5.5.1.1.2.3.3" xref="S3.E39.m1.5.5.1.1.2.3.3.cmml">𝒟</mi></msub><mo id="S3.E39.m1.5.5.1.1.2.2" xref="S3.E39.m1.5.5.1.1.2.2.cmml">⁢</mo><mrow id="S3.E39.m1.5.5.1.1.2.1.1" xref="S3.E39.m1.5.5.1.1.2.1.2.cmml"><mo id="S3.E39.m1.5.5.1.1.2.1.1.2" xref="S3.E39.m1.5.5.1.1.2.1.2.1.cmml">[</mo><msup id="S3.E39.m1.5.5.1.1.2.1.1.1" xref="S3.E39.m1.5.5.1.1.2.1.1.1.cmml"><mrow id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.cmml"><mo id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.2" stretchy="false" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.cmml"><mrow id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.2" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.2.2" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.2.2.cmml">V</mi><mo id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.2.1" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mo id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.1" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.3.2" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.3.1.cmml"><mo id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S3.E39.m1.2.2" xref="S3.E39.m1.2.2.cmml">π</mi><mo id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.3.2.2" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E39.m1.3.3" xref="S3.E39.m1.3.3.cmml">𝒟</mi><mo id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.3.2.3" stretchy="false" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.1" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.3" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.3.2" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.3.2.cmml">V</mi><mo id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.3.1" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.3.3.2" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.3.cmml"><mo id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.3.cmml">(</mo><mi id="S3.E39.m1.4.4" xref="S3.E39.m1.4.4.cmml">π</mi><mo id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.3" stretchy="false" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E39.m1.5.5.1.1.2.1.1.1.3" xref="S3.E39.m1.5.5.1.1.2.1.1.1.3.cmml">2</mn></msup><mo id="S3.E39.m1.5.5.1.1.2.1.1.3" xref="S3.E39.m1.5.5.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E39.m1.5.5.1.2" lspace="0em" xref="S3.E39.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E39.m1.5b"><apply id="S3.E39.m1.5.5.1.1.cmml" xref="S3.E39.m1.5.5.1"><ci id="S3.E39.m1.5.5.1.1.3.cmml" xref="S3.E39.m1.5.5.1.1.3">:-</ci><apply id="S3.E39.m1.5.5.1.1.1.cmml" xref="S3.E39.m1.5.5.1.1.1"><times id="S3.E39.m1.5.5.1.1.1.2.cmml" xref="S3.E39.m1.5.5.1.1.1.2"></times><ci id="S3.E39.m1.5.5.1.1.1.3.cmml" xref="S3.E39.m1.5.5.1.1.1.3">MSE</ci><apply id="S3.E39.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E39.m1.5.5.1.1.1.1.1"><times id="S3.E39.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E39.m1.5.5.1.1.1.1.1.1.1"></times><apply id="S3.E39.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E39.m1.5.5.1.1.1.1.1.1.2"><ci id="S3.E39.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E39.m1.5.5.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E39.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E39.m1.5.5.1.1.1.1.1.1.2.2">𝑉</ci></apply><ci id="S3.E39.m1.1.1.cmml" xref="S3.E39.m1.1.1">𝜋</ci></apply></apply><apply id="S3.E39.m1.5.5.1.1.2.cmml" xref="S3.E39.m1.5.5.1.1.2"><times id="S3.E39.m1.5.5.1.1.2.2.cmml" xref="S3.E39.m1.5.5.1.1.2.2"></times><apply id="S3.E39.m1.5.5.1.1.2.3.cmml" xref="S3.E39.m1.5.5.1.1.2.3"><csymbol cd="ambiguous" id="S3.E39.m1.5.5.1.1.2.3.1.cmml" xref="S3.E39.m1.5.5.1.1.2.3">subscript</csymbol><ci id="S3.E39.m1.5.5.1.1.2.3.2.cmml" xref="S3.E39.m1.5.5.1.1.2.3.2">𝔼</ci><ci id="S3.E39.m1.5.5.1.1.2.3.3.cmml" xref="S3.E39.m1.5.5.1.1.2.3.3">𝒟</ci></apply><apply id="S3.E39.m1.5.5.1.1.2.1.2.cmml" xref="S3.E39.m1.5.5.1.1.2.1.1"><csymbol cd="latexml" id="S3.E39.m1.5.5.1.1.2.1.2.1.cmml" xref="S3.E39.m1.5.5.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S3.E39.m1.5.5.1.1.2.1.1.1.cmml" xref="S3.E39.m1.5.5.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E39.m1.5.5.1.1.2.1.1.1.2.cmml" xref="S3.E39.m1.5.5.1.1.2.1.1.1">superscript</csymbol><apply id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1"><minus id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.1"></minus><apply id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2"><times id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.1"></times><apply id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.2"><ci id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.2.2">𝑉</ci></apply><interval closure="open" id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.2.3.2"><ci id="S3.E39.m1.2.2.cmml" xref="S3.E39.m1.2.2">𝜋</ci><ci id="S3.E39.m1.3.3.cmml" xref="S3.E39.m1.3.3">𝒟</ci></interval></apply><apply id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.3.cmml" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.3"><times id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.3.1"></times><ci id="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E39.m1.5.5.1.1.2.1.1.1.1.1.1.3.2">𝑉</ci><ci id="S3.E39.m1.4.4.cmml" xref="S3.E39.m1.4.4">𝜋</ci></apply></apply><cn id="S3.E39.m1.5.5.1.1.2.1.1.1.3.cmml" type="integer" xref="S3.E39.m1.5.5.1.1.2.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E39.m1.5c">{\rm MSE}(\hat{V}(\pi))\coloneq\mathbb{E}_{\mathcal{D}}\left[(\hat{V}(\pi,%
\mathcal{D})-V(\pi))^{2}\right].</annotation><annotation encoding="application/x-llamapun" id="S3.E39.m1.5d">roman_MSE ( over^ start_ARG italic_V end_ARG ( italic_π ) ) :- blackboard_E start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT [ ( over^ start_ARG italic_V end_ARG ( italic_π , caligraphic_D ) - italic_V ( italic_π ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_proof" id="S3.SS3.1">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S3.SS3.1.p1">
<p class="ltx_p" id="S3.SS3.1.p1.1">The MSE of any off-policy estimator <math alttext="\hat{V}(\pi,\mathcal{D})" class="ltx_Math" display="inline" id="S3.SS3.1.p1.1.m1.2"><semantics id="S3.SS3.1.p1.1.m1.2a"><mrow id="S3.SS3.1.p1.1.m1.2.3" xref="S3.SS3.1.p1.1.m1.2.3.cmml"><mover accent="true" id="S3.SS3.1.p1.1.m1.2.3.2" xref="S3.SS3.1.p1.1.m1.2.3.2.cmml"><mi id="S3.SS3.1.p1.1.m1.2.3.2.2" xref="S3.SS3.1.p1.1.m1.2.3.2.2.cmml">V</mi><mo id="S3.SS3.1.p1.1.m1.2.3.2.1" xref="S3.SS3.1.p1.1.m1.2.3.2.1.cmml">^</mo></mover><mo id="S3.SS3.1.p1.1.m1.2.3.1" xref="S3.SS3.1.p1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.1.p1.1.m1.2.3.3.2" xref="S3.SS3.1.p1.1.m1.2.3.3.1.cmml"><mo id="S3.SS3.1.p1.1.m1.2.3.3.2.1" stretchy="false" xref="S3.SS3.1.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="S3.SS3.1.p1.1.m1.1.1" xref="S3.SS3.1.p1.1.m1.1.1.cmml">π</mi><mo id="S3.SS3.1.p1.1.m1.2.3.3.2.2" xref="S3.SS3.1.p1.1.m1.2.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.1.p1.1.m1.2.2" xref="S3.SS3.1.p1.1.m1.2.2.cmml">𝒟</mi><mo id="S3.SS3.1.p1.1.m1.2.3.3.2.3" stretchy="false" xref="S3.SS3.1.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.1.p1.1.m1.2b"><apply id="S3.SS3.1.p1.1.m1.2.3.cmml" xref="S3.SS3.1.p1.1.m1.2.3"><times id="S3.SS3.1.p1.1.m1.2.3.1.cmml" xref="S3.SS3.1.p1.1.m1.2.3.1"></times><apply id="S3.SS3.1.p1.1.m1.2.3.2.cmml" xref="S3.SS3.1.p1.1.m1.2.3.2"><ci id="S3.SS3.1.p1.1.m1.2.3.2.1.cmml" xref="S3.SS3.1.p1.1.m1.2.3.2.1">^</ci><ci id="S3.SS3.1.p1.1.m1.2.3.2.2.cmml" xref="S3.SS3.1.p1.1.m1.2.3.2.2">𝑉</ci></apply><interval closure="open" id="S3.SS3.1.p1.1.m1.2.3.3.1.cmml" xref="S3.SS3.1.p1.1.m1.2.3.3.2"><ci id="S3.SS3.1.p1.1.m1.1.1.cmml" xref="S3.SS3.1.p1.1.m1.1.1">𝜋</ci><ci id="S3.SS3.1.p1.1.m1.2.2.cmml" xref="S3.SS3.1.p1.1.m1.2.2">𝒟</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.1.p1.1.m1.2c">\hat{V}(\pi,\mathcal{D})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.1.p1.1.m1.2d">over^ start_ARG italic_V end_ARG ( italic_π , caligraphic_D )</annotation></semantics></math> can be decomposed in terms of the bias and variance of the estimator <cite class="ltx_cite ltx_citemacro_citep">(Su et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib58" title="">2020</a>)</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E40">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(40)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{MSE}(\hat{V}(\pi))=\text{Bias}(\hat{V}(\pi),\mathcal{D})^{2}+\text{%
Variance}(\hat{V}(\pi),\mathcal{D})," class="ltx_Math" display="block" id="S3.E40.m1.6"><semantics id="S3.E40.m1.6a"><mrow id="S3.E40.m1.6.6.1" xref="S3.E40.m1.6.6.1.1.cmml"><mrow id="S3.E40.m1.6.6.1.1" xref="S3.E40.m1.6.6.1.1.cmml"><mrow id="S3.E40.m1.6.6.1.1.1" xref="S3.E40.m1.6.6.1.1.1.cmml"><mtext id="S3.E40.m1.6.6.1.1.1.3" xref="S3.E40.m1.6.6.1.1.1.3a.cmml">MSE</mtext><mo id="S3.E40.m1.6.6.1.1.1.2" xref="S3.E40.m1.6.6.1.1.1.2.cmml">⁢</mo><mrow id="S3.E40.m1.6.6.1.1.1.1.1" xref="S3.E40.m1.6.6.1.1.1.1.1.1.cmml"><mo id="S3.E40.m1.6.6.1.1.1.1.1.2" stretchy="false" xref="S3.E40.m1.6.6.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E40.m1.6.6.1.1.1.1.1.1" xref="S3.E40.m1.6.6.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E40.m1.6.6.1.1.1.1.1.1.2" xref="S3.E40.m1.6.6.1.1.1.1.1.1.2.cmml"><mi id="S3.E40.m1.6.6.1.1.1.1.1.1.2.2" xref="S3.E40.m1.6.6.1.1.1.1.1.1.2.2.cmml">V</mi><mo id="S3.E40.m1.6.6.1.1.1.1.1.1.2.1" xref="S3.E40.m1.6.6.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S3.E40.m1.6.6.1.1.1.1.1.1.1" xref="S3.E40.m1.6.6.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E40.m1.6.6.1.1.1.1.1.1.3.2" xref="S3.E40.m1.6.6.1.1.1.1.1.1.cmml"><mo id="S3.E40.m1.6.6.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E40.m1.6.6.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E40.m1.1.1" xref="S3.E40.m1.1.1.cmml">π</mi><mo id="S3.E40.m1.6.6.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E40.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E40.m1.6.6.1.1.1.1.1.3" stretchy="false" xref="S3.E40.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E40.m1.6.6.1.1.4" xref="S3.E40.m1.6.6.1.1.4.cmml">=</mo><mrow id="S3.E40.m1.6.6.1.1.3" xref="S3.E40.m1.6.6.1.1.3.cmml"><mrow id="S3.E40.m1.6.6.1.1.2.1" xref="S3.E40.m1.6.6.1.1.2.1.cmml"><mtext id="S3.E40.m1.6.6.1.1.2.1.3" xref="S3.E40.m1.6.6.1.1.2.1.3a.cmml">Bias</mtext><mo id="S3.E40.m1.6.6.1.1.2.1.2" xref="S3.E40.m1.6.6.1.1.2.1.2.cmml">⁢</mo><msup id="S3.E40.m1.6.6.1.1.2.1.1" xref="S3.E40.m1.6.6.1.1.2.1.1.cmml"><mrow id="S3.E40.m1.6.6.1.1.2.1.1.1.1" xref="S3.E40.m1.6.6.1.1.2.1.1.1.2.cmml"><mo id="S3.E40.m1.6.6.1.1.2.1.1.1.1.2" stretchy="false" xref="S3.E40.m1.6.6.1.1.2.1.1.1.2.cmml">(</mo><mrow id="S3.E40.m1.6.6.1.1.2.1.1.1.1.1" xref="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.cmml"><mover accent="true" id="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.2" xref="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.2.cmml"><mi id="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.2.2" xref="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.2.2.cmml">V</mi><mo id="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.2.1" xref="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.1" xref="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.3.2" xref="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.cmml"><mo id="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.cmml">(</mo><mi id="S3.E40.m1.2.2" xref="S3.E40.m1.2.2.cmml">π</mi><mo id="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E40.m1.6.6.1.1.2.1.1.1.1.3" xref="S3.E40.m1.6.6.1.1.2.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E40.m1.3.3" xref="S3.E40.m1.3.3.cmml">𝒟</mi><mo id="S3.E40.m1.6.6.1.1.2.1.1.1.1.4" stretchy="false" xref="S3.E40.m1.6.6.1.1.2.1.1.1.2.cmml">)</mo></mrow><mn id="S3.E40.m1.6.6.1.1.2.1.1.3" xref="S3.E40.m1.6.6.1.1.2.1.1.3.cmml">2</mn></msup></mrow><mo id="S3.E40.m1.6.6.1.1.3.3" xref="S3.E40.m1.6.6.1.1.3.3.cmml">+</mo><mrow id="S3.E40.m1.6.6.1.1.3.2" xref="S3.E40.m1.6.6.1.1.3.2.cmml"><mtext id="S3.E40.m1.6.6.1.1.3.2.3" xref="S3.E40.m1.6.6.1.1.3.2.3a.cmml">Variance</mtext><mo id="S3.E40.m1.6.6.1.1.3.2.2" xref="S3.E40.m1.6.6.1.1.3.2.2.cmml">⁢</mo><mrow id="S3.E40.m1.6.6.1.1.3.2.1.1" xref="S3.E40.m1.6.6.1.1.3.2.1.2.cmml"><mo id="S3.E40.m1.6.6.1.1.3.2.1.1.2" stretchy="false" xref="S3.E40.m1.6.6.1.1.3.2.1.2.cmml">(</mo><mrow id="S3.E40.m1.6.6.1.1.3.2.1.1.1" xref="S3.E40.m1.6.6.1.1.3.2.1.1.1.cmml"><mover accent="true" id="S3.E40.m1.6.6.1.1.3.2.1.1.1.2" xref="S3.E40.m1.6.6.1.1.3.2.1.1.1.2.cmml"><mi id="S3.E40.m1.6.6.1.1.3.2.1.1.1.2.2" xref="S3.E40.m1.6.6.1.1.3.2.1.1.1.2.2.cmml">V</mi><mo id="S3.E40.m1.6.6.1.1.3.2.1.1.1.2.1" xref="S3.E40.m1.6.6.1.1.3.2.1.1.1.2.1.cmml">^</mo></mover><mo id="S3.E40.m1.6.6.1.1.3.2.1.1.1.1" xref="S3.E40.m1.6.6.1.1.3.2.1.1.1.1.cmml">⁢</mo><mrow id="S3.E40.m1.6.6.1.1.3.2.1.1.1.3.2" xref="S3.E40.m1.6.6.1.1.3.2.1.1.1.cmml"><mo id="S3.E40.m1.6.6.1.1.3.2.1.1.1.3.2.1" stretchy="false" xref="S3.E40.m1.6.6.1.1.3.2.1.1.1.cmml">(</mo><mi id="S3.E40.m1.4.4" xref="S3.E40.m1.4.4.cmml">π</mi><mo id="S3.E40.m1.6.6.1.1.3.2.1.1.1.3.2.2" stretchy="false" xref="S3.E40.m1.6.6.1.1.3.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E40.m1.6.6.1.1.3.2.1.1.3" xref="S3.E40.m1.6.6.1.1.3.2.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E40.m1.5.5" xref="S3.E40.m1.5.5.cmml">𝒟</mi><mo id="S3.E40.m1.6.6.1.1.3.2.1.1.4" stretchy="false" xref="S3.E40.m1.6.6.1.1.3.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E40.m1.6.6.1.2" xref="S3.E40.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E40.m1.6b"><apply id="S3.E40.m1.6.6.1.1.cmml" xref="S3.E40.m1.6.6.1"><eq id="S3.E40.m1.6.6.1.1.4.cmml" xref="S3.E40.m1.6.6.1.1.4"></eq><apply id="S3.E40.m1.6.6.1.1.1.cmml" xref="S3.E40.m1.6.6.1.1.1"><times id="S3.E40.m1.6.6.1.1.1.2.cmml" xref="S3.E40.m1.6.6.1.1.1.2"></times><ci id="S3.E40.m1.6.6.1.1.1.3a.cmml" xref="S3.E40.m1.6.6.1.1.1.3"><mtext id="S3.E40.m1.6.6.1.1.1.3.cmml" xref="S3.E40.m1.6.6.1.1.1.3">MSE</mtext></ci><apply id="S3.E40.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E40.m1.6.6.1.1.1.1.1"><times id="S3.E40.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E40.m1.6.6.1.1.1.1.1.1.1"></times><apply id="S3.E40.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E40.m1.6.6.1.1.1.1.1.1.2"><ci id="S3.E40.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="S3.E40.m1.6.6.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E40.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="S3.E40.m1.6.6.1.1.1.1.1.1.2.2">𝑉</ci></apply><ci id="S3.E40.m1.1.1.cmml" xref="S3.E40.m1.1.1">𝜋</ci></apply></apply><apply id="S3.E40.m1.6.6.1.1.3.cmml" xref="S3.E40.m1.6.6.1.1.3"><plus id="S3.E40.m1.6.6.1.1.3.3.cmml" xref="S3.E40.m1.6.6.1.1.3.3"></plus><apply id="S3.E40.m1.6.6.1.1.2.1.cmml" xref="S3.E40.m1.6.6.1.1.2.1"><times id="S3.E40.m1.6.6.1.1.2.1.2.cmml" xref="S3.E40.m1.6.6.1.1.2.1.2"></times><ci id="S3.E40.m1.6.6.1.1.2.1.3a.cmml" xref="S3.E40.m1.6.6.1.1.2.1.3"><mtext id="S3.E40.m1.6.6.1.1.2.1.3.cmml" xref="S3.E40.m1.6.6.1.1.2.1.3">Bias</mtext></ci><apply id="S3.E40.m1.6.6.1.1.2.1.1.cmml" xref="S3.E40.m1.6.6.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E40.m1.6.6.1.1.2.1.1.2.cmml" xref="S3.E40.m1.6.6.1.1.2.1.1">superscript</csymbol><interval closure="open" id="S3.E40.m1.6.6.1.1.2.1.1.1.2.cmml" xref="S3.E40.m1.6.6.1.1.2.1.1.1.1"><apply id="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.cmml" xref="S3.E40.m1.6.6.1.1.2.1.1.1.1.1"><times id="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.1"></times><apply id="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.2"><ci id="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.2.1.cmml" xref="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.2.1">^</ci><ci id="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.2.2.cmml" xref="S3.E40.m1.6.6.1.1.2.1.1.1.1.1.2.2">𝑉</ci></apply><ci id="S3.E40.m1.2.2.cmml" xref="S3.E40.m1.2.2">𝜋</ci></apply><ci id="S3.E40.m1.3.3.cmml" xref="S3.E40.m1.3.3">𝒟</ci></interval><cn id="S3.E40.m1.6.6.1.1.2.1.1.3.cmml" type="integer" xref="S3.E40.m1.6.6.1.1.2.1.1.3">2</cn></apply></apply><apply id="S3.E40.m1.6.6.1.1.3.2.cmml" xref="S3.E40.m1.6.6.1.1.3.2"><times id="S3.E40.m1.6.6.1.1.3.2.2.cmml" xref="S3.E40.m1.6.6.1.1.3.2.2"></times><ci id="S3.E40.m1.6.6.1.1.3.2.3a.cmml" xref="S3.E40.m1.6.6.1.1.3.2.3"><mtext id="S3.E40.m1.6.6.1.1.3.2.3.cmml" xref="S3.E40.m1.6.6.1.1.3.2.3">Variance</mtext></ci><interval closure="open" id="S3.E40.m1.6.6.1.1.3.2.1.2.cmml" xref="S3.E40.m1.6.6.1.1.3.2.1.1"><apply id="S3.E40.m1.6.6.1.1.3.2.1.1.1.cmml" xref="S3.E40.m1.6.6.1.1.3.2.1.1.1"><times id="S3.E40.m1.6.6.1.1.3.2.1.1.1.1.cmml" xref="S3.E40.m1.6.6.1.1.3.2.1.1.1.1"></times><apply id="S3.E40.m1.6.6.1.1.3.2.1.1.1.2.cmml" xref="S3.E40.m1.6.6.1.1.3.2.1.1.1.2"><ci id="S3.E40.m1.6.6.1.1.3.2.1.1.1.2.1.cmml" xref="S3.E40.m1.6.6.1.1.3.2.1.1.1.2.1">^</ci><ci id="S3.E40.m1.6.6.1.1.3.2.1.1.1.2.2.cmml" xref="S3.E40.m1.6.6.1.1.3.2.1.1.1.2.2">𝑉</ci></apply><ci id="S3.E40.m1.4.4.cmml" xref="S3.E40.m1.4.4">𝜋</ci></apply><ci id="S3.E40.m1.5.5.cmml" xref="S3.E40.m1.5.5">𝒟</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E40.m1.6c">\text{MSE}(\hat{V}(\pi))=\text{Bias}(\hat{V}(\pi),\mathcal{D})^{2}+\text{%
Variance}(\hat{V}(\pi),\mathcal{D}),</annotation><annotation encoding="application/x-llamapun" id="S3.E40.m1.6d">MSE ( over^ start_ARG italic_V end_ARG ( italic_π ) ) = Bias ( over^ start_ARG italic_V end_ARG ( italic_π ) , caligraphic_D ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + Variance ( over^ start_ARG italic_V end_ARG ( italic_π ) , caligraphic_D ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.1.p1.4">where the bias of the estimator is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E41">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(41)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Bias}(\hat{V}(\pi),\mathcal{D})=\left|\mathbb{E}_{\mathcal{D}}\left[\hat%
{V}(\pi,\mathcal{D})-V(\pi)\right]\right|," class="ltx_Math" display="block" id="S3.E41.m1.6"><semantics id="S3.E41.m1.6a"><mrow id="S3.E41.m1.6.6.1" xref="S3.E41.m1.6.6.1.1.cmml"><mrow id="S3.E41.m1.6.6.1.1" xref="S3.E41.m1.6.6.1.1.cmml"><mrow id="S3.E41.m1.6.6.1.1.1" xref="S3.E41.m1.6.6.1.1.1.cmml"><mtext id="S3.E41.m1.6.6.1.1.1.3" xref="S3.E41.m1.6.6.1.1.1.3a.cmml">Bias</mtext><mo id="S3.E41.m1.6.6.1.1.1.2" xref="S3.E41.m1.6.6.1.1.1.2.cmml">⁢</mo><mrow id="S3.E41.m1.6.6.1.1.1.1.1" xref="S3.E41.m1.6.6.1.1.1.1.2.cmml"><mo id="S3.E41.m1.6.6.1.1.1.1.1.2" stretchy="false" xref="S3.E41.m1.6.6.1.1.1.1.2.cmml">(</mo><mrow id="S3.E41.m1.6.6.1.1.1.1.1.1" xref="S3.E41.m1.6.6.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E41.m1.6.6.1.1.1.1.1.1.2" xref="S3.E41.m1.6.6.1.1.1.1.1.1.2.cmml"><mi id="S3.E41.m1.6.6.1.1.1.1.1.1.2.2" xref="S3.E41.m1.6.6.1.1.1.1.1.1.2.2.cmml">V</mi><mo id="S3.E41.m1.6.6.1.1.1.1.1.1.2.1" xref="S3.E41.m1.6.6.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S3.E41.m1.6.6.1.1.1.1.1.1.1" xref="S3.E41.m1.6.6.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E41.m1.6.6.1.1.1.1.1.1.3.2" xref="S3.E41.m1.6.6.1.1.1.1.1.1.cmml"><mo id="S3.E41.m1.6.6.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E41.m1.6.6.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E41.m1.1.1" xref="S3.E41.m1.1.1.cmml">π</mi><mo id="S3.E41.m1.6.6.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E41.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E41.m1.6.6.1.1.1.1.1.3" xref="S3.E41.m1.6.6.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E41.m1.2.2" xref="S3.E41.m1.2.2.cmml">𝒟</mi><mo id="S3.E41.m1.6.6.1.1.1.1.1.4" stretchy="false" xref="S3.E41.m1.6.6.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E41.m1.6.6.1.1.3" xref="S3.E41.m1.6.6.1.1.3.cmml">=</mo><mrow id="S3.E41.m1.6.6.1.1.2.1" xref="S3.E41.m1.6.6.1.1.2.2.cmml"><mo id="S3.E41.m1.6.6.1.1.2.1.2" xref="S3.E41.m1.6.6.1.1.2.2.1.cmml">|</mo><mrow id="S3.E41.m1.6.6.1.1.2.1.1" xref="S3.E41.m1.6.6.1.1.2.1.1.cmml"><msub id="S3.E41.m1.6.6.1.1.2.1.1.3" xref="S3.E41.m1.6.6.1.1.2.1.1.3.cmml"><mi id="S3.E41.m1.6.6.1.1.2.1.1.3.2" xref="S3.E41.m1.6.6.1.1.2.1.1.3.2.cmml">𝔼</mi><mi class="ltx_font_mathcaligraphic" id="S3.E41.m1.6.6.1.1.2.1.1.3.3" xref="S3.E41.m1.6.6.1.1.2.1.1.3.3.cmml">𝒟</mi></msub><mo id="S3.E41.m1.6.6.1.1.2.1.1.2" xref="S3.E41.m1.6.6.1.1.2.1.1.2.cmml">⁢</mo><mrow id="S3.E41.m1.6.6.1.1.2.1.1.1.1" xref="S3.E41.m1.6.6.1.1.2.1.1.1.2.cmml"><mo id="S3.E41.m1.6.6.1.1.2.1.1.1.1.2" xref="S3.E41.m1.6.6.1.1.2.1.1.1.2.1.cmml">[</mo><mrow id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.cmml"><mrow id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.2" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.2.cmml"><mi id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.2.2" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.2.2.cmml">V</mi><mo id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.2.1" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mo id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.1" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.3.2" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.3.1.cmml"><mo id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S3.E41.m1.3.3" xref="S3.E41.m1.3.3.cmml">π</mi><mo id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.3.2.2" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E41.m1.4.4" xref="S3.E41.m1.4.4.cmml">𝒟</mi><mo id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.3.2.3" stretchy="false" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.1" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.3" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.3.cmml"><mi id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.3.2" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.3.2.cmml">V</mi><mo id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.3.1" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.3.3.2" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.3.cmml"><mo id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.3.cmml">(</mo><mi id="S3.E41.m1.5.5" xref="S3.E41.m1.5.5.cmml">π</mi><mo id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E41.m1.6.6.1.1.2.1.1.1.1.3" xref="S3.E41.m1.6.6.1.1.2.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E41.m1.6.6.1.1.2.1.3" xref="S3.E41.m1.6.6.1.1.2.2.1.cmml">|</mo></mrow></mrow><mo id="S3.E41.m1.6.6.1.2" xref="S3.E41.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E41.m1.6b"><apply id="S3.E41.m1.6.6.1.1.cmml" xref="S3.E41.m1.6.6.1"><eq id="S3.E41.m1.6.6.1.1.3.cmml" xref="S3.E41.m1.6.6.1.1.3"></eq><apply id="S3.E41.m1.6.6.1.1.1.cmml" xref="S3.E41.m1.6.6.1.1.1"><times id="S3.E41.m1.6.6.1.1.1.2.cmml" xref="S3.E41.m1.6.6.1.1.1.2"></times><ci id="S3.E41.m1.6.6.1.1.1.3a.cmml" xref="S3.E41.m1.6.6.1.1.1.3"><mtext id="S3.E41.m1.6.6.1.1.1.3.cmml" xref="S3.E41.m1.6.6.1.1.1.3">Bias</mtext></ci><interval closure="open" id="S3.E41.m1.6.6.1.1.1.1.2.cmml" xref="S3.E41.m1.6.6.1.1.1.1.1"><apply id="S3.E41.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E41.m1.6.6.1.1.1.1.1.1"><times id="S3.E41.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E41.m1.6.6.1.1.1.1.1.1.1"></times><apply id="S3.E41.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E41.m1.6.6.1.1.1.1.1.1.2"><ci id="S3.E41.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="S3.E41.m1.6.6.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E41.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="S3.E41.m1.6.6.1.1.1.1.1.1.2.2">𝑉</ci></apply><ci id="S3.E41.m1.1.1.cmml" xref="S3.E41.m1.1.1">𝜋</ci></apply><ci id="S3.E41.m1.2.2.cmml" xref="S3.E41.m1.2.2">𝒟</ci></interval></apply><apply id="S3.E41.m1.6.6.1.1.2.2.cmml" xref="S3.E41.m1.6.6.1.1.2.1"><abs id="S3.E41.m1.6.6.1.1.2.2.1.cmml" xref="S3.E41.m1.6.6.1.1.2.1.2"></abs><apply id="S3.E41.m1.6.6.1.1.2.1.1.cmml" xref="S3.E41.m1.6.6.1.1.2.1.1"><times id="S3.E41.m1.6.6.1.1.2.1.1.2.cmml" xref="S3.E41.m1.6.6.1.1.2.1.1.2"></times><apply id="S3.E41.m1.6.6.1.1.2.1.1.3.cmml" xref="S3.E41.m1.6.6.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S3.E41.m1.6.6.1.1.2.1.1.3.1.cmml" xref="S3.E41.m1.6.6.1.1.2.1.1.3">subscript</csymbol><ci id="S3.E41.m1.6.6.1.1.2.1.1.3.2.cmml" xref="S3.E41.m1.6.6.1.1.2.1.1.3.2">𝔼</ci><ci id="S3.E41.m1.6.6.1.1.2.1.1.3.3.cmml" xref="S3.E41.m1.6.6.1.1.2.1.1.3.3">𝒟</ci></apply><apply id="S3.E41.m1.6.6.1.1.2.1.1.1.2.cmml" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1"><csymbol cd="latexml" id="S3.E41.m1.6.6.1.1.2.1.1.1.2.1.cmml" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.cmml" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1"><minus id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.1"></minus><apply id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2"><times id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.1.cmml" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.1"></times><apply id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.2.cmml" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.2"><ci id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.2.1.cmml" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.2.2.cmml" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.2.2">𝑉</ci></apply><interval closure="open" id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.3.1.cmml" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.2.3.2"><ci id="S3.E41.m1.3.3.cmml" xref="S3.E41.m1.3.3">𝜋</ci><ci id="S3.E41.m1.4.4.cmml" xref="S3.E41.m1.4.4">𝒟</ci></interval></apply><apply id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.3.cmml" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.3"><times id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.3.1.cmml" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.3.1"></times><ci id="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.3.2.cmml" xref="S3.E41.m1.6.6.1.1.2.1.1.1.1.1.3.2">𝑉</ci><ci id="S3.E41.m1.5.5.cmml" xref="S3.E41.m1.5.5">𝜋</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E41.m1.6c">\text{Bias}(\hat{V}(\pi),\mathcal{D})=\left|\mathbb{E}_{\mathcal{D}}\left[\hat%
{V}(\pi,\mathcal{D})-V(\pi)\right]\right|,</annotation><annotation encoding="application/x-llamapun" id="S3.E41.m1.6d">Bias ( over^ start_ARG italic_V end_ARG ( italic_π ) , caligraphic_D ) = | blackboard_E start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT [ over^ start_ARG italic_V end_ARG ( italic_π , caligraphic_D ) - italic_V ( italic_π ) ] | ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.1.p1.3">and the variance of the estimator is defined previously (see Section <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.SS3" title="3.3. Minimizing estimation variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">3.3</span></a>).
Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E22" title="In 3.1. A unified off-policy estimator ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">22</span></a> proves that <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS3.1.p1.2.m1.1"><semantics id="S3.SS3.1.p1.2.m1.1a"><mi id="S3.SS3.1.p1.2.m1.1.1" xref="S3.SS3.1.p1.2.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.1.p1.2.m1.1b"><ci id="S3.SS3.1.p1.2.m1.1.1.cmml" xref="S3.SS3.1.p1.2.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.1.p1.2.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.1.p1.2.m1.1d">italic_β</annotation></semantics></math>-IPS is unbiased: <math alttext="\text{Bias}(\hat{V}(\pi),\mathcal{D})=0" class="ltx_Math" display="inline" id="S3.SS3.1.p1.3.m2.3"><semantics id="S3.SS3.1.p1.3.m2.3a"><mrow id="S3.SS3.1.p1.3.m2.3.3" xref="S3.SS3.1.p1.3.m2.3.3.cmml"><mrow id="S3.SS3.1.p1.3.m2.3.3.1" xref="S3.SS3.1.p1.3.m2.3.3.1.cmml"><mtext id="S3.SS3.1.p1.3.m2.3.3.1.3" xref="S3.SS3.1.p1.3.m2.3.3.1.3a.cmml">Bias</mtext><mo id="S3.SS3.1.p1.3.m2.3.3.1.2" xref="S3.SS3.1.p1.3.m2.3.3.1.2.cmml">⁢</mo><mrow id="S3.SS3.1.p1.3.m2.3.3.1.1.1" xref="S3.SS3.1.p1.3.m2.3.3.1.1.2.cmml"><mo id="S3.SS3.1.p1.3.m2.3.3.1.1.1.2" stretchy="false" xref="S3.SS3.1.p1.3.m2.3.3.1.1.2.cmml">(</mo><mrow id="S3.SS3.1.p1.3.m2.3.3.1.1.1.1" xref="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.cmml"><mover accent="true" id="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.2" xref="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.2.cmml"><mi id="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.2.2" xref="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.2.2.cmml">V</mi><mo id="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.2.1" xref="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.1" xref="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.3.2" xref="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.cmml"><mo id="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.3.2.1" stretchy="false" xref="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.cmml">(</mo><mi id="S3.SS3.1.p1.3.m2.1.1" xref="S3.SS3.1.p1.3.m2.1.1.cmml">π</mi><mo id="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.3.2.2" stretchy="false" xref="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.1.p1.3.m2.3.3.1.1.1.3" xref="S3.SS3.1.p1.3.m2.3.3.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.1.p1.3.m2.2.2" xref="S3.SS3.1.p1.3.m2.2.2.cmml">𝒟</mi><mo id="S3.SS3.1.p1.3.m2.3.3.1.1.1.4" stretchy="false" xref="S3.SS3.1.p1.3.m2.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS3.1.p1.3.m2.3.3.2" xref="S3.SS3.1.p1.3.m2.3.3.2.cmml">=</mo><mn id="S3.SS3.1.p1.3.m2.3.3.3" xref="S3.SS3.1.p1.3.m2.3.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.1.p1.3.m2.3b"><apply id="S3.SS3.1.p1.3.m2.3.3.cmml" xref="S3.SS3.1.p1.3.m2.3.3"><eq id="S3.SS3.1.p1.3.m2.3.3.2.cmml" xref="S3.SS3.1.p1.3.m2.3.3.2"></eq><apply id="S3.SS3.1.p1.3.m2.3.3.1.cmml" xref="S3.SS3.1.p1.3.m2.3.3.1"><times id="S3.SS3.1.p1.3.m2.3.3.1.2.cmml" xref="S3.SS3.1.p1.3.m2.3.3.1.2"></times><ci id="S3.SS3.1.p1.3.m2.3.3.1.3a.cmml" xref="S3.SS3.1.p1.3.m2.3.3.1.3"><mtext id="S3.SS3.1.p1.3.m2.3.3.1.3.cmml" xref="S3.SS3.1.p1.3.m2.3.3.1.3">Bias</mtext></ci><interval closure="open" id="S3.SS3.1.p1.3.m2.3.3.1.1.2.cmml" xref="S3.SS3.1.p1.3.m2.3.3.1.1.1"><apply id="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.cmml" xref="S3.SS3.1.p1.3.m2.3.3.1.1.1.1"><times id="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.1.cmml" xref="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.1"></times><apply id="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.2.cmml" xref="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.2"><ci id="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.2.1.cmml" xref="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.2.1">^</ci><ci id="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.2.2.cmml" xref="S3.SS3.1.p1.3.m2.3.3.1.1.1.1.2.2">𝑉</ci></apply><ci id="S3.SS3.1.p1.3.m2.1.1.cmml" xref="S3.SS3.1.p1.3.m2.1.1">𝜋</ci></apply><ci id="S3.SS3.1.p1.3.m2.2.2.cmml" xref="S3.SS3.1.p1.3.m2.2.2">𝒟</ci></interval></apply><cn id="S3.SS3.1.p1.3.m2.3.3.3.cmml" type="integer" xref="S3.SS3.1.p1.3.m2.3.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.1.p1.3.m2.3c">\text{Bias}(\hat{V}(\pi),\mathcal{D})=0</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.1.p1.3.m2.3d">Bias ( over^ start_ARG italic_V end_ARG ( italic_π ) , caligraphic_D ) = 0</annotation></semantics></math>.
Thus, the minimum variance (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E37" title="In 3.3. Minimizing estimation variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">37</span></a>) implies minimum MSE.
∎</p>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">We note that SNIPS is not covered by this theorem, as it is only asymptotically unbiased.
As a result, the variance reduction brought on by SNIPS might be higher than that by <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">italic_β</annotation></semantics></math>-IPS, but as it introduces bias, its estimation error (MSE) is not guaranteed to be better.
Our experimental results below indicate that our method is always at least as good as SNIPS, and outperforms it in most cases, in both learning and evaluation tasks.</p>
</div>
<figure class="ltx_figure" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="208" id="S3.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F1.2.1.1" style="font-size:90%;">Figure 1</span>. </span><span class="ltx_text" id="S3.F1.3.2" style="font-size:90%;">Performance of different off-policy learning methods trained in a full-batch gradient descent fashion in terms of the policy value on the test set. x-axis corresponds to the training epoch during the optimization (we use a maximum of 500 epochs for all methods), and y-axis corresponds to the policy value.
A decaying learning rate is used.
Reported results are averages over 32 independent runs with 95% confidence interval. </span></figcaption>
</figure>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="208" id="S3.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.2.1.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text" id="S3.F2.3.2" style="font-size:90%;">Performance of different off-policy learning methods trained in a mini-batch gradient descent fashion in terms of policy value on the test set. The axis labels are similar to Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.F1" title="Figure 1 ‣ 3.3. Minimizing estimation variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">1</span></a>.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experimental Setup</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In order to evaluate off-policy learning and evaluation methods, we need access to logged data sampled from a stochastic policy involving logging propensities (exact or estimated) along with the corresponding context and action pairs.
Recent work that focuses on off-policy learning or evaluation for contextual bandits in recommender systems follows a supervised-to-bandit conversion process to simulate a real-world bandit feedback dataset <cite class="ltx_cite ltx_citemacro_citep">(Jeunen and Goethals, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib27" title="">2021b</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib26" title="">a</a>; Jeunen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib30" title="">2023</a>; Saito et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib53" title="">2021</a>; Su et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib58" title="">2020</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib59" title="">2019</a>)</cite>, or conducts a live experiment on actual user traffic to evaluate the policy in an <em class="ltx_emph ltx_font_italic" id="S4.p1.1.1">on-policy</em> or <em class="ltx_emph ltx_font_italic" id="S4.p1.1.2">online</em> fashion <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib8" title="">2019</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib10" title="">2022</a>)</cite>.
In this work, we adopt the Open Bandit Pipeline (OBP) to simulate, in a reproducible manner, real-world recommendation setups with stochastic rewards, large action spaces, and controlled randomization <cite class="ltx_cite ltx_citemacro_citep">(Rohde et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib49" title="">2018</a>)</cite>.
Although the Open Bandit Pipeline simulates a generic offline contextual bandit setup, there is a strong correspondence to real-world recommendation setups where the environment context vector corresponds to the user context and the actions correspond to the items recommended to the user.
Finally, the reward corresponds to the user feedback received on the item (click, purchase, etc.).
As an added advantage, the simulator allows us to conduct experiments in a <em class="ltx_emph ltx_font_italic" id="S4.p1.1.3">realistic</em> setting where the logging policy is sub-optimal to a controlled extent, the logged data size is limited, and the action space is large.
In addition, we conduct experiments with real-world recommendation logs from the OBP for off-policy evaluation.<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://research.zozo.com/data.html" title="">https://research.zozo.com/data.html</a></span></span></span></p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">The research questions we answer with our experimental results are:</p>
<ol class="ltx_enumerate" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.1.1.1">RQ1</span></span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1">Does the proposed <em class="ltx_emph ltx_font_italic" id="S4.I1.i1.p1.1.1">estimator-variance-minimizing</em> baseline correction (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E38" title="In 3.3. Minimizing estimation variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">38</span></a>) improve off-policy learning (OPL) in a full-batch setting?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.1.1.1">RQ2</span></span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1">Does the proposed <em class="ltx_emph ltx_font_italic" id="S4.I1.i2.p1.1.1">gradient-variance-minimizing</em> baseline correction (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E31" title="In 3.2. Minimizing gradient variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">31</span></a>) improve OPL in a mini-batch setting?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.1.1.1">RQ3</span></span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1">How does the proposed <em class="ltx_emph ltx_font_italic" id="S4.I1.i3.p1.1.1">gradient-variance-minimizing</em> baseline correction (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E31" title="In 3.2. Minimizing gradient variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">31</span></a>) affect gradient variance during OPL?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S4.I1.i4.1.1.1">RQ4</span></span>
<div class="ltx_para" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.1">Does the proposed <em class="ltx_emph ltx_font_italic" id="S4.I1.i4.p1.1.1">estimator-variance-minimizing</em> baseline correction (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E38" title="In 3.3. Minimizing estimation variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">38</span></a>) improve OPE performance?</p>
</div>
</li>
</ol>
</div>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="208" id="S4.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.2.1.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text" id="S4.F3.3.2" style="font-size:90%;">Empirical variance of the gradient of different off-policy learning estimators in a mini-batch optimization setup with varying learning rates (in title). We compute gradient variance for each mini-batch during training and then report the average value across all mini-batches in a training epoch. Results are averaged across 32 independent runs with 95% confidence interval.</span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Results and Discussion</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Off-policy learning performance (RQ1–3) </h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">To evaluate the performance of the proposed <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mi id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><ci id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">italic_β</annotation></semantics></math>-IPS method on an OPL task, we consider two learning setups:</p>
<ol class="ltx_enumerate" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(1)</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1"><em class="ltx_emph ltx_font_italic" id="S5.I1.i1.p1.1.1">Full-batch</em>. In this setup, we directly optimize the <math alttext="\beta" class="ltx_Math" display="inline" id="S5.I1.i1.p1.1.m1.1"><semantics id="S5.I1.i1.p1.1.m1.1a"><mi id="S5.I1.i1.p1.1.m1.1.1" xref="S5.I1.i1.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.I1.i1.p1.1.m1.1b"><ci id="S5.I1.i1.p1.1.m1.1.1.cmml" xref="S5.I1.i1.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i1.p1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i1.p1.1.m1.1d">italic_β</annotation></semantics></math>-IPS policy value estimator (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E21" title="In 3.1. A unified off-policy estimator ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">21</span></a>) with the optimal baseline correction, which minimizes the variance of the value (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E38" title="In 3.3. Minimizing estimation variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">38</span></a>). Given that the optimal baseline correction involves a ratio of two expectations, optimizing the value function directly via a mini-batch stochastic optimization is not possible for the same reason as the SNIPS estimator, i.e., it is not possible to get an unbiased gradient estimate with a ratio function <cite class="ltx_cite ltx_citemacro_citep">(Joachims et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib34" title="">2018</a>)</cite>. Therefore, for this particular setting, we use a <em class="ltx_emph ltx_font_italic" id="S5.I1.i1.p1.1.2">full-batch</em> gradient descent method for the optimization, where the gradient is computed over the entire training dataset.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(2)</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1"><em class="ltx_emph ltx_font_italic" id="S5.I1.i2.p1.1.1">Mini-batch</em>. In this setup, we focus on optimizing the <math alttext="\beta" class="ltx_Math" display="inline" id="S5.I1.i2.p1.1.m1.1"><semantics id="S5.I1.i2.p1.1.m1.1a"><mi id="S5.I1.i2.p1.1.m1.1.1" xref="S5.I1.i2.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.I1.i2.p1.1.m1.1b"><ci id="S5.I1.i2.p1.1.m1.1.1.cmml" xref="S5.I1.i2.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i2.p1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i2.p1.1.m1.1d">italic_β</annotation></semantics></math>-IPS policy value estimator with the baseline correction, which minimizes the gradient estimate (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E31" title="In 3.2. Minimizing gradient variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">31</span></a>). This setup translates to a traditional machine learning training setup where the model is optimized in a stochastic mini-batch fashion.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p2.1.1">Full-batch.</span> The results for the full-batch training in terms of the policy value on the test set are reported in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.F1" title="Figure 1 ‣ 3.3. Minimizing estimation variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">1</span></a>, over the number of training epochs. To minimize the impact of external factors, we use a linear model without bias, followed by a softmax to generate a distribution over all actions, given a context vector <math alttext="x" class="ltx_Math" display="inline" id="S5.SS1.p2.1.m1.1"><semantics id="S5.SS1.p2.1.m1.1a"><mi id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><ci id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.1.m1.1d">italic_x</annotation></semantics></math> (this is a common setup, see <cite class="ltx_cite ltx_citemacro_citep">(e.g., Jeunen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib32" title="">2020</a>; Jeunen and Goethals, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib25" title="">2020</a>; Sakhi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib54" title="">2020</a>)</cite>).
We note that the goal of this work is not to get the maximum possible policy value on the test set but rather to evaluate the effect of baseline corrections on gradient and estimation variance. The simple model setup allows us to easily track the empirical gradient variance, given that we have only one parameter vector.</p>
</div>
<div class="ltx_para" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.1">An advantage of the full-batch setup is that we can compute the gradient of the SNIPS estimator directly <cite class="ltx_cite ltx_citemacro_citep">(Swaminathan and Joachims, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib63" title="">2015b</a>)</cite>.
SNIPS is a natural baseline method to consider, along with the traditional IPS estimator.
Because of practical concerns, we only consider 500 epochs of optimization.
Additionally, we use the state-of-the-art and widely used Adam optimizer <cite class="ltx_cite ltx_citemacro_citep">(Kingma and Ba, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib35" title="">2014</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S5.SS1.p4">
<p class="ltx_p" id="S5.SS1.p4.1">The IPS method converges to a lower test policy value in comparison to the SNIPS and the proposed <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS1.p4.1.m1.1"><semantics id="S5.SS1.p4.1.m1.1a"><mi id="S5.SS1.p4.1.m1.1.1" xref="S5.SS1.p4.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.1.m1.1b"><ci id="S5.SS1.p4.1.m1.1.1.cmml" xref="S5.SS1.p4.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p4.1.m1.1d">italic_β</annotation></semantics></math>-IPS methods, even after 500 epochs.
A likely reason is the high-variance of the IPS estimator <cite class="ltx_cite ltx_citemacro_citep">(Dudík et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib14" title="">2014</a>)</cite>, which can cause it to get stuck in bad local minima.</p>
</div>
<div class="ltx_para" id="S5.SS1.p5">
<p class="ltx_p" id="S5.SS1.p5.3">The methods with a control variate, i.e., SNIPS (with multiplicative control variate) and <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS1.p5.1.m1.1"><semantics id="S5.SS1.p5.1.m1.1a"><mi id="S5.SS1.p5.1.m1.1.1" xref="S5.SS1.p5.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.1.m1.1b"><ci id="S5.SS1.p5.1.m1.1.1.cmml" xref="S5.SS1.p5.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p5.1.m1.1d">italic_β</annotation></semantics></math>-IPS (with additive control variate) converge to substantially better test policy values.
In terms of the convergence speed, <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS1.p5.2.m2.1"><semantics id="S5.SS1.p5.2.m2.1a"><mi id="S5.SS1.p5.2.m2.1.1" xref="S5.SS1.p5.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.2.m2.1b"><ci id="S5.SS1.p5.2.m2.1.1.cmml" xref="S5.SS1.p5.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p5.2.m2.1d">italic_β</annotation></semantics></math>-IPS converges to the optimal value faster than the SNIPS estimator, most likely because it has lower estimator variance than SNIPS. With this, we can answer RQ1 as follows: in the full-batch setting, our proposed optimal baseline correction enables <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS1.p5.3.m3.1"><semantics id="S5.SS1.p5.3.m3.1a"><mi id="S5.SS1.p5.3.m3.1.1" xref="S5.SS1.p5.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.3.m3.1b"><ci id="S5.SS1.p5.3.m3.1.1.cmml" xref="S5.SS1.p5.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p5.3.m3.1d">italic_β</annotation></semantics></math>-IPS to converge faster than SNIPS at similar performance.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p6">
<p class="ltx_p" id="S5.SS1.p6.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p6.1.1">Mini-batch.</span> The results for mini-batch training in terms of the test policy value are reported in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.F2" title="Figure 2 ‣ 3.3. Minimizing estimation variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">2</span></a>.
Different from the full-batch setup, where the focus is on reducing the variance of the <em class="ltx_emph ltx_font_italic" id="S5.SS1.p6.1.2">estimator</em> value (Section <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.SS3" title="3.3. Minimizing estimation variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">3.3</span></a>), in the mini-batch mode, the focus is on reducing the variance of the gradient estimate (Section <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.SS2" title="3.2. Minimizing gradient variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">3.2</span></a>).
The model and training setup are similar to the full-batch mode, except that we fixed the batch size to 1024 for the mini-batch experiments.
Preliminary results indicated that the batch size hyper-parameter has a limited effect.</p>
</div>
<div class="ltx_para" id="S5.SS1.p7">
<p class="ltx_p" id="S5.SS1.p7.1">Analogous to the full-batch setup, the IPS estimator results in a lower test policy value, most likely because of the high gradient variance which prevents convergence to high performance.
In contrast, due to their baseline corrections, BanditNet (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E24" title="In 3.1. A unified off-policy estimator ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">24</span></a>) and <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS1.p7.1.m1.1"><semantics id="S5.SS1.p7.1.m1.1a"><mi id="S5.SS1.p7.1.m1.1.1" xref="S5.SS1.p7.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p7.1.m1.1b"><ci id="S5.SS1.p7.1.m1.1.1.cmml" xref="S5.SS1.p7.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p7.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p7.1.m1.1d">italic_β</annotation></semantics></math>-IPS have a lower gradient variance.
Accordingly, they also converge to better performance <cite class="ltx_cite ltx_citemacro_citep">(Bottou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib5" title="">2018</a>)</cite>, i.e., resulting in superior test policy values.</p>
</div>
<div class="ltx_para" id="S5.SS1.p8">
<p class="ltx_p" id="S5.SS1.p8.2">Amongst these baseline-corrected gradient-based methods (BanditNet and <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS1.p8.1.m1.1"><semantics id="S5.SS1.p8.1.m1.1a"><mi id="S5.SS1.p8.1.m1.1.1" xref="S5.SS1.p8.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p8.1.m1.1b"><ci id="S5.SS1.p8.1.m1.1.1.cmml" xref="S5.SS1.p8.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p8.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p8.1.m1.1d">italic_β</annotation></semantics></math>-IPS), our proposed <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS1.p8.2.m2.1"><semantics id="S5.SS1.p8.2.m2.1a"><mi id="S5.SS1.p8.2.m2.1.1" xref="S5.SS1.p8.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p8.2.m2.1b"><ci id="S5.SS1.p8.2.m2.1.1.cmml" xref="S5.SS1.p8.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p8.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p8.2.m2.1d">italic_β</annotation></semantics></math>-IPS estimator outperforms BanditNet as it provides a policy with substantially higher value.
The differences are observed over different choices of learning rates.
Thus we answer RQ2 accordingly: in the mini-batch setting, our proposed gradient-minimizing baseline method results in considerably higher policy value compared to both IPS and BanditNet.</p>
</div>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="433" id="S5.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F4.6.3.1" style="font-size:90%;">Figure 4</span>. </span><span class="ltx_text" id="S5.F4.4.2" style="font-size:90%;">Mean Squared Error (MSE) of different off-policy estimators with varying action space (from left to right), and varying inverse temperature parameter of the softmax logging policy (from top to bottom). X-axis corresponds to the size of the logged data simulated (ranging from <math alttext="10^{2}" class="ltx_Math" display="inline" id="S5.F4.3.1.m1.1"><semantics id="S5.F4.3.1.m1.1b"><msup id="S5.F4.3.1.m1.1.1" xref="S5.F4.3.1.m1.1.1.cmml"><mn id="S5.F4.3.1.m1.1.1.2" xref="S5.F4.3.1.m1.1.1.2.cmml">10</mn><mn id="S5.F4.3.1.m1.1.1.3" xref="S5.F4.3.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S5.F4.3.1.m1.1c"><apply id="S5.F4.3.1.m1.1.1.cmml" xref="S5.F4.3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.F4.3.1.m1.1.1.1.cmml" xref="S5.F4.3.1.m1.1.1">superscript</csymbol><cn id="S5.F4.3.1.m1.1.1.2.cmml" type="integer" xref="S5.F4.3.1.m1.1.1.2">10</cn><cn id="S5.F4.3.1.m1.1.1.3.cmml" type="integer" xref="S5.F4.3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.3.1.m1.1d">10^{2}</annotation><annotation encoding="application/x-llamapun" id="S5.F4.3.1.m1.1e">10 start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> to <math alttext="10^{6}" class="ltx_Math" display="inline" id="S5.F4.4.2.m2.1"><semantics id="S5.F4.4.2.m2.1b"><msup id="S5.F4.4.2.m2.1.1" xref="S5.F4.4.2.m2.1.1.cmml"><mn id="S5.F4.4.2.m2.1.1.2" xref="S5.F4.4.2.m2.1.1.2.cmml">10</mn><mn id="S5.F4.4.2.m2.1.1.3" xref="S5.F4.4.2.m2.1.1.3.cmml">6</mn></msup><annotation-xml encoding="MathML-Content" id="S5.F4.4.2.m2.1c"><apply id="S5.F4.4.2.m2.1.1.cmml" xref="S5.F4.4.2.m2.1.1"><csymbol cd="ambiguous" id="S5.F4.4.2.m2.1.1.1.cmml" xref="S5.F4.4.2.m2.1.1">superscript</csymbol><cn id="S5.F4.4.2.m2.1.1.2.cmml" type="integer" xref="S5.F4.4.2.m2.1.1.2">10</cn><cn id="S5.F4.4.2.m2.1.1.3.cmml" type="integer" xref="S5.F4.4.2.m2.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.4.2.m2.1d">10^{6}</annotation><annotation encoding="application/x-llamapun" id="S5.F4.4.2.m2.1e">10 start_POSTSUPERSCRIPT 6 end_POSTSUPERSCRIPT</annotation></semantics></math>), and the y-axis corresponds to the MSE (evaluated over 100 independent samples of the synthetic data) along with 95% confidence interval. Each row corresponds to a different setting of inverse temperature of the softmax logging policy.
We only consider unbiased (asymptotically or otherwise) estimators.</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS1.p9">
<p class="ltx_p" id="S5.SS1.p9.3">Next, we directly consider the empirical gradient variance of different estimators;
Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S4.F3" title="Figure 3 ‣ 4. Experimental Setup ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">3</span></a> reports the average mini-batch gradient variance per epoch.
As expected, the IPS estimator has the highest gradient variance by a large margin. For BanditNet, we observe a lower gradient variance, which is the desired result of the additive baseline it employs.
Finally, we observe that our proposed method <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS1.p9.1.m1.1"><semantics id="S5.SS1.p9.1.m1.1a"><mi id="S5.SS1.p9.1.m1.1.1" xref="S5.SS1.p9.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p9.1.m1.1b"><ci id="S5.SS1.p9.1.m1.1.1.cmml" xref="S5.SS1.p9.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p9.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p9.1.m1.1d">italic_β</annotation></semantics></math>-IPS has the lowest gradient variance.
This result corroborates the theoretical claim (Theorem <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.Thmtheorem1" title="Theorem 1. ‣ 3.2. Minimizing gradient variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">1</span></a>) that the <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS1.p9.2.m2.1"><semantics id="S5.SS1.p9.2.m2.1a"><mi id="S5.SS1.p9.2.m2.1.1" xref="S5.SS1.p9.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p9.2.m2.1b"><ci id="S5.SS1.p9.2.m2.1.1.cmml" xref="S5.SS1.p9.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p9.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p9.2.m2.1d">italic_β</annotation></semantics></math>-IPS estimator has the lowest gradient variance amongst all global additive control variates (including IPS and BanditNet).
Our answer to RQ3 is thus clear: our proposed <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS1.p9.3.m3.1"><semantics id="S5.SS1.p9.3.m3.1a"><mi id="S5.SS1.p9.3.m3.1.1" xref="S5.SS1.p9.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p9.3.m3.1b"><ci id="S5.SS1.p9.3.m3.1.1.cmml" xref="S5.SS1.p9.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p9.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p9.3.m3.1d">italic_β</annotation></semantics></math>-IPS results in considerably lower gradient variance compared to BanditNet and IPS.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Off-policy evaluation performance (RQ4)</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.4">To evaluate the performance of the proposed <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS2.p1.1.m1.1"><semantics id="S5.SS2.p1.1.m1.1a"><mi id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><ci id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.1.m1.1d">italic_β</annotation></semantics></math>-IPS method, which minimizes the estimated policy value (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E38" title="In 3.3. Minimizing estimation variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">38</span></a>), in an OPE task, results are presented in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S5.F4" title="Figure 4 ‣ 5.1. Off-policy learning performance (RQ1–3) ‣ 5. Results and Discussion ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">4</span></a>. The target policy (to be evaluated) is a logistic regression model trained via the IPS objective on logged data and evaluated on a separate full-information test set.
We evaluate the MSE of the estimated policy value against the <span class="ltx_text ltx_font_italic" id="S5.SS2.p1.4.1">true</span> policy value (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E39" title="In Theorem 2. ‣ 3.3. Minimizing estimation variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">39</span></a>).
To evaluate the MSE of different estimators realistically, we report results with varying degrees of the optimality of the behavior policy (decided by the inverse temperature parameter of the softmax) and with a varying cardinality of the action space. A positive (and higher) inverse softmax temperature results in a increasingly optimal behavior policy (selects action with highest reward probability), and a negative (and lower) inverse softmax temperature parameter results in an increasingly sub-optimal behavior policy (selects actions with lowest reward probability).
Our proposed <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS2.p1.2.m2.1"><semantics id="S5.SS2.p1.2.m2.1a"><mi id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><ci id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.2.m2.1d">italic_β</annotation></semantics></math>-IPS method has the lowest MSE in all simulated settings.
Interestingly, the proposed <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS2.p1.3.m3.1"><semantics id="S5.SS2.p1.3.m3.1a"><mi id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><ci id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.3.m3.1d">italic_β</annotation></semantics></math>-IPS has a lower MSE than the DR method, which has a regression model-based control variate, arguably more powerful than the constant control variate from the proposed <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS2.p1.4.m4.1"><semantics id="S5.SS2.p1.4.m4.1a"><mi id="S5.SS2.p1.4.m4.1.1" xref="S5.SS2.p1.4.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.4.m4.1b"><ci id="S5.SS2.p1.4.m4.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.4.m4.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.4.m4.1d">italic_β</annotation></semantics></math>-IPS method.
Similar observations have been made in previous work, e.g., <cite class="ltx_cite ltx_citemacro_citet">Jeunen and Goethals (<a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib25" title="">2020</a>)</cite> reported that the DR estimator’s performance heavily depends on the logging policy.</p>
</div>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T1.4.1.1" style="font-size:90%;">Table 1</span>. </span><span class="ltx_text" id="S5.T1.5.2" style="font-size:90%;">Comparison of different OPE methods on real-world recommender system logs of ZOZOTOWN from a campaign targeted towards men with a uniformly random production policy. We report the mean relative absolute error (with std).</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T1.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T1.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.2.1">OPE estimator</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1">
<span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.1">Abs. relative error</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T1.1.1.1.m1.1"><semantics id="S5.T1.1.1.1.m1.1a"><mo id="S5.T1.1.1.1.m1.1.1" stretchy="false" xref="S5.T1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T1.1.1.1.m1.1b"><ci id="S5.T1.1.1.1.m1.1.1.cmml" xref="S5.T1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.1.1.1.m1.1d">↓</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T1.2.3.1.1">IPS</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.2.3.1.2">0.1277 (0.0142)</td>
</tr>
<tr class="ltx_tr" id="S5.T1.2.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T1.2.4.2.1">SNIPS</th>
<td class="ltx_td ltx_align_center" id="S5.T1.2.4.2.2">0.1113 (0.0372)</td>
</tr>
<tr class="ltx_tr" id="S5.T1.2.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T1.2.5.3.1">DR</th>
<td class="ltx_td ltx_align_center" id="S5.T1.2.5.3.2">0.1144 (0.0366)</td>
</tr>
<tr class="ltx_tr" id="S5.T1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T1.2.2.1">
<math alttext="\beta" class="ltx_Math" display="inline" id="S5.T1.2.2.1.m1.1"><semantics id="S5.T1.2.2.1.m1.1a"><mi id="S5.T1.2.2.1.m1.1.1" xref="S5.T1.2.2.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.T1.2.2.1.m1.1b"><ci id="S5.T1.2.2.1.m1.1.1.cmml" xref="S5.T1.2.2.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.2.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.T1.2.2.1.m1.1d">italic_β</annotation></semantics></math>-IPS</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.2.2.2"><span class="ltx_text ltx_font_bold" id="S5.T1.2.2.2.1">0.1078 (0.0383)</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.3">Depending on the setting, we see that <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS2.p2.1.m1.1"><semantics id="S5.SS2.p2.1.m1.1a"><mi id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><ci id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.1.m1.1d">italic_β</annotation></semantics></math>-IPS either has performance comparable to the SNIPS estimator, i.e., when inverse temperature <math alttext="\in\{-1,1\}" class="ltx_Math" display="inline" id="S5.SS2.p2.2.m2.2"><semantics id="S5.SS2.p2.2.m2.2a"><mrow id="S5.SS2.p2.2.m2.2.2" xref="S5.SS2.p2.2.m2.2.2.cmml"><mi id="S5.SS2.p2.2.m2.2.2.3" xref="S5.SS2.p2.2.m2.2.2.3.cmml"></mi><mo id="S5.SS2.p2.2.m2.2.2.2" xref="S5.SS2.p2.2.m2.2.2.2.cmml">∈</mo><mrow id="S5.SS2.p2.2.m2.2.2.1.1" xref="S5.SS2.p2.2.m2.2.2.1.2.cmml"><mo id="S5.SS2.p2.2.m2.2.2.1.1.2" stretchy="false" xref="S5.SS2.p2.2.m2.2.2.1.2.cmml">{</mo><mrow id="S5.SS2.p2.2.m2.2.2.1.1.1" xref="S5.SS2.p2.2.m2.2.2.1.1.1.cmml"><mo id="S5.SS2.p2.2.m2.2.2.1.1.1a" xref="S5.SS2.p2.2.m2.2.2.1.1.1.cmml">−</mo><mn id="S5.SS2.p2.2.m2.2.2.1.1.1.2" xref="S5.SS2.p2.2.m2.2.2.1.1.1.2.cmml">1</mn></mrow><mo id="S5.SS2.p2.2.m2.2.2.1.1.3" xref="S5.SS2.p2.2.m2.2.2.1.2.cmml">,</mo><mn id="S5.SS2.p2.2.m2.1.1" xref="S5.SS2.p2.2.m2.1.1.cmml">1</mn><mo id="S5.SS2.p2.2.m2.2.2.1.1.4" stretchy="false" xref="S5.SS2.p2.2.m2.2.2.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.2.m2.2b"><apply id="S5.SS2.p2.2.m2.2.2.cmml" xref="S5.SS2.p2.2.m2.2.2"><in id="S5.SS2.p2.2.m2.2.2.2.cmml" xref="S5.SS2.p2.2.m2.2.2.2"></in><csymbol cd="latexml" id="S5.SS2.p2.2.m2.2.2.3.cmml" xref="S5.SS2.p2.2.m2.2.2.3">absent</csymbol><set id="S5.SS2.p2.2.m2.2.2.1.2.cmml" xref="S5.SS2.p2.2.m2.2.2.1.1"><apply id="S5.SS2.p2.2.m2.2.2.1.1.1.cmml" xref="S5.SS2.p2.2.m2.2.2.1.1.1"><minus id="S5.SS2.p2.2.m2.2.2.1.1.1.1.cmml" xref="S5.SS2.p2.2.m2.2.2.1.1.1"></minus><cn id="S5.SS2.p2.2.m2.2.2.1.1.1.2.cmml" type="integer" xref="S5.SS2.p2.2.m2.2.2.1.1.1.2">1</cn></apply><cn id="S5.SS2.p2.2.m2.1.1.cmml" type="integer" xref="S5.SS2.p2.2.m2.1.1">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.2.m2.2c">\in\{-1,1\}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.2.m2.2d">∈ { - 1 , 1 }</annotation></semantics></math>;
or noticeably higher performance than SNIPS, i.e., when inverse temperature <math alttext="\in\{-5,5\}" class="ltx_Math" display="inline" id="S5.SS2.p2.3.m3.2"><semantics id="S5.SS2.p2.3.m3.2a"><mrow id="S5.SS2.p2.3.m3.2.2" xref="S5.SS2.p2.3.m3.2.2.cmml"><mi id="S5.SS2.p2.3.m3.2.2.3" xref="S5.SS2.p2.3.m3.2.2.3.cmml"></mi><mo id="S5.SS2.p2.3.m3.2.2.2" xref="S5.SS2.p2.3.m3.2.2.2.cmml">∈</mo><mrow id="S5.SS2.p2.3.m3.2.2.1.1" xref="S5.SS2.p2.3.m3.2.2.1.2.cmml"><mo id="S5.SS2.p2.3.m3.2.2.1.1.2" stretchy="false" xref="S5.SS2.p2.3.m3.2.2.1.2.cmml">{</mo><mrow id="S5.SS2.p2.3.m3.2.2.1.1.1" xref="S5.SS2.p2.3.m3.2.2.1.1.1.cmml"><mo id="S5.SS2.p2.3.m3.2.2.1.1.1a" xref="S5.SS2.p2.3.m3.2.2.1.1.1.cmml">−</mo><mn id="S5.SS2.p2.3.m3.2.2.1.1.1.2" xref="S5.SS2.p2.3.m3.2.2.1.1.1.2.cmml">5</mn></mrow><mo id="S5.SS2.p2.3.m3.2.2.1.1.3" xref="S5.SS2.p2.3.m3.2.2.1.2.cmml">,</mo><mn id="S5.SS2.p2.3.m3.1.1" xref="S5.SS2.p2.3.m3.1.1.cmml">5</mn><mo id="S5.SS2.p2.3.m3.2.2.1.1.4" stretchy="false" xref="S5.SS2.p2.3.m3.2.2.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.3.m3.2b"><apply id="S5.SS2.p2.3.m3.2.2.cmml" xref="S5.SS2.p2.3.m3.2.2"><in id="S5.SS2.p2.3.m3.2.2.2.cmml" xref="S5.SS2.p2.3.m3.2.2.2"></in><csymbol cd="latexml" id="S5.SS2.p2.3.m3.2.2.3.cmml" xref="S5.SS2.p2.3.m3.2.2.3">absent</csymbol><set id="S5.SS2.p2.3.m3.2.2.1.2.cmml" xref="S5.SS2.p2.3.m3.2.2.1.1"><apply id="S5.SS2.p2.3.m3.2.2.1.1.1.cmml" xref="S5.SS2.p2.3.m3.2.2.1.1.1"><minus id="S5.SS2.p2.3.m3.2.2.1.1.1.1.cmml" xref="S5.SS2.p2.3.m3.2.2.1.1.1"></minus><cn id="S5.SS2.p2.3.m3.2.2.1.1.1.2.cmml" type="integer" xref="S5.SS2.p2.3.m3.2.2.1.1.1.2">5</cn></apply><cn id="S5.SS2.p2.3.m3.1.1.cmml" type="integer" xref="S5.SS2.p2.3.m3.1.1">5</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.3.m3.2c">\in\{-5,5\}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.3.m3.2d">∈ { - 5 , 5 }</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p3.1.1">Real-world evaluation.</span> To evaluate different estimators in a real-world recommender systems setup, we report the results of OPE from the production logs of a real-world recommender system in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S5.T1" title="Table 1 ‣ 5.2. Off-policy evaluation performance (RQ4) ‣ 5. Results and Discussion ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">1</span></a>.
Similar to the simulation setup, the proposed <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS2.p3.1.m1.1"><semantics id="S5.SS2.p3.1.m1.1a"><mi id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.1b"><ci id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.1.m1.1d">italic_β</annotation></semantics></math>-IPS has the lowest absoluate relative error amongst all estimators in the comparison.
In conclusion, we answer RQ4:
our proposed policy-value variance minimizing baseline method results in substantially improved MSE, compared to IPS, SNIPS and DR, in offline evaluation tasks that are typical recommender system use-cases.</p>
</div>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="432" id="S5.F5.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F5.6.3.1" style="font-size:90%;">Figure 5</span>. </span><span class="ltx_text" id="S5.F5.4.2" style="font-size:90%;">Empirical variance of different off-policy estimators with varying action space (from left to right), and varying sub-optimality of a temperature-based softmax behavior policy (from top to bottom). The x-axis corresponds to the size of the logged data simulated (ranging from <math alttext="10^{2}" class="ltx_Math" display="inline" id="S5.F5.3.1.m1.1"><semantics id="S5.F5.3.1.m1.1b"><msup id="S5.F5.3.1.m1.1.1" xref="S5.F5.3.1.m1.1.1.cmml"><mn id="S5.F5.3.1.m1.1.1.2" xref="S5.F5.3.1.m1.1.1.2.cmml">10</mn><mn id="S5.F5.3.1.m1.1.1.3" xref="S5.F5.3.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S5.F5.3.1.m1.1c"><apply id="S5.F5.3.1.m1.1.1.cmml" xref="S5.F5.3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.F5.3.1.m1.1.1.1.cmml" xref="S5.F5.3.1.m1.1.1">superscript</csymbol><cn id="S5.F5.3.1.m1.1.1.2.cmml" type="integer" xref="S5.F5.3.1.m1.1.1.2">10</cn><cn id="S5.F5.3.1.m1.1.1.3.cmml" type="integer" xref="S5.F5.3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.3.1.m1.1d">10^{2}</annotation><annotation encoding="application/x-llamapun" id="S5.F5.3.1.m1.1e">10 start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> to <math alttext="10^{6}" class="ltx_Math" display="inline" id="S5.F5.4.2.m2.1"><semantics id="S5.F5.4.2.m2.1b"><msup id="S5.F5.4.2.m2.1.1" xref="S5.F5.4.2.m2.1.1.cmml"><mn id="S5.F5.4.2.m2.1.1.2" xref="S5.F5.4.2.m2.1.1.2.cmml">10</mn><mn id="S5.F5.4.2.m2.1.1.3" xref="S5.F5.4.2.m2.1.1.3.cmml">6</mn></msup><annotation-xml encoding="MathML-Content" id="S5.F5.4.2.m2.1c"><apply id="S5.F5.4.2.m2.1.1.cmml" xref="S5.F5.4.2.m2.1.1"><csymbol cd="ambiguous" id="S5.F5.4.2.m2.1.1.1.cmml" xref="S5.F5.4.2.m2.1.1">superscript</csymbol><cn id="S5.F5.4.2.m2.1.1.2.cmml" type="integer" xref="S5.F5.4.2.m2.1.1.2">10</cn><cn id="S5.F5.4.2.m2.1.1.3.cmml" type="integer" xref="S5.F5.4.2.m2.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.4.2.m2.1d">10^{6}</annotation><annotation encoding="application/x-llamapun" id="S5.F5.4.2.m2.1e">10 start_POSTSUPERSCRIPT 6 end_POSTSUPERSCRIPT</annotation></semantics></math>), and the y-axis corresponds to the variance of different estimators (evaluated over 100 independent samples of the synthetic data) along with 95% confidence interval. Each row corresponds to a different optimality level of the logging policy, decided by the inverse temperature parameter. We only consider unbiased (asymptotically or otherwise) estimators.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion and Future Work</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this work, we have proposed to unify different off-policy estimators as equivalent additive baseline corrections.
We look at off-policy evaluation and learning settings and propose baseline corrections that minimize the variance in the estimated policy value and the empirical gradient of the off-policy learning objective.
Extensive experimental comparisons on a synthetic benchmark with realistic settings show that our proposed methods improve performance in the off-policy estimation (OPE) and off-policy learning (OPL) tasks.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">We believe our work represents a significant step forward in the understanding and use of off-policy estimation methods (for both evaluation and learning use-cases), since we show that the prevalent SNIPS estimator can be improved upon with essentially no cost, as our proposed method is parameter-free and — in contrast with SNIPS — it retains the unbiasedness that comes with IPS.</p>
</div>
<div class="ltx_para" id="S6.p3">
<p class="ltx_p" id="S6.p3.1">Future work may apply a similar approach to offline reinforcement learning setups <cite class="ltx_cite ltx_citemacro_citep">(Levine et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib38" title="">2020</a>)</cite>, or consider extensions of our approach for ranking applications <cite class="ltx_cite ltx_citemacro_citep">(London et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#bib.bib41" title="">2023</a>)</cite>.</p>
</div>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix: Off-policy Estimator Variance</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">In this appendix, we report additional results from the experimental section (Section 4 from the main paper), answering RQ4. Specifically, we look the the empirical variance of various offline estimators for the task of off-policy evaluation. The mean squared error (MSE) of different offline estimators are reported in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S5.F4" title="Figure 4 ‣ 5.1. Off-policy learning performance (RQ1–3) ‣ 5. Results and Discussion ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">4</span></a>. In this appendix, we report the empirical variance of various offline estimators in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S5.F5" title="Figure 5 ‣ 5.2. Off-policy evaluation performance (RQ4) ‣ 5. Results and Discussion ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<div class="ltx_para" id="A1.p2">
<p class="ltx_p" id="A1.p2.7">From the figure, it is clear that our proposed <math alttext="\beta" class="ltx_Math" display="inline" id="A1.p2.1.m1.1"><semantics id="A1.p2.1.m1.1a"><mi id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.1b"><ci id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.p2.1.m1.1d">italic_β</annotation></semantics></math>-IPS estimator with estimator variance minimizing <math alttext="\beta" class="ltx_Math" display="inline" id="A1.p2.2.m2.1"><semantics id="A1.p2.2.m2.1a"><mi id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.1b"><ci id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.p2.2.m2.1d">italic_β</annotation></semantics></math> value (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E38" title="In 3.3. Minimizing estimation variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">38</span></a>) results in the lowest empirical variance in most of the cases. It is interesting to note that when the logged data is limited (<math alttext="N&lt;10^{3}" class="ltx_Math" display="inline" id="A1.p2.3.m3.1"><semantics id="A1.p2.3.m3.1a"><mrow id="A1.p2.3.m3.1.1" xref="A1.p2.3.m3.1.1.cmml"><mi id="A1.p2.3.m3.1.1.2" xref="A1.p2.3.m3.1.1.2.cmml">N</mi><mo id="A1.p2.3.m3.1.1.1" xref="A1.p2.3.m3.1.1.1.cmml">&lt;</mo><msup id="A1.p2.3.m3.1.1.3" xref="A1.p2.3.m3.1.1.3.cmml"><mn id="A1.p2.3.m3.1.1.3.2" xref="A1.p2.3.m3.1.1.3.2.cmml">10</mn><mn id="A1.p2.3.m3.1.1.3.3" xref="A1.p2.3.m3.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.3.m3.1b"><apply id="A1.p2.3.m3.1.1.cmml" xref="A1.p2.3.m3.1.1"><lt id="A1.p2.3.m3.1.1.1.cmml" xref="A1.p2.3.m3.1.1.1"></lt><ci id="A1.p2.3.m3.1.1.2.cmml" xref="A1.p2.3.m3.1.1.2">𝑁</ci><apply id="A1.p2.3.m3.1.1.3.cmml" xref="A1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="A1.p2.3.m3.1.1.3.1.cmml" xref="A1.p2.3.m3.1.1.3">superscript</csymbol><cn id="A1.p2.3.m3.1.1.3.2.cmml" type="integer" xref="A1.p2.3.m3.1.1.3.2">10</cn><cn id="A1.p2.3.m3.1.1.3.3.cmml" type="integer" xref="A1.p2.3.m3.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.3.m3.1c">N&lt;10^{3}</annotation><annotation encoding="application/x-llamapun" id="A1.p2.3.m3.1d">italic_N &lt; 10 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>), sometimes the SNIPS estimator has lower estimator variance. We suspect that the reason could be a bias in the estimate of the variance-optimal <math alttext="\beta" class="ltx_Math" display="inline" id="A1.p2.4.m4.1"><semantics id="A1.p2.4.m4.1a"><mi id="A1.p2.4.m4.1.1" xref="A1.p2.4.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.p2.4.m4.1b"><ci id="A1.p2.4.m4.1.1.cmml" xref="A1.p2.4.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.4.m4.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.p2.4.m4.1d">italic_β</annotation></semantics></math> estimate (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.05736v2#S3.E38" title="In 3.3. Minimizing estimation variance ‣ 3. Unifying Off-Policy Estimators ‣ Optimal Baseline Corrections for Off-Policy Contextual Bandits"><span class="ltx_text ltx_ref_tag">38</span></a>), when the dataset size is small, given that it is a ratio estimate of expectations. For practical settings, i.e., when <math alttext="N&gt;10^{3}" class="ltx_Math" display="inline" id="A1.p2.5.m5.1"><semantics id="A1.p2.5.m5.1a"><mrow id="A1.p2.5.m5.1.1" xref="A1.p2.5.m5.1.1.cmml"><mi id="A1.p2.5.m5.1.1.2" xref="A1.p2.5.m5.1.1.2.cmml">N</mi><mo id="A1.p2.5.m5.1.1.1" xref="A1.p2.5.m5.1.1.1.cmml">&gt;</mo><msup id="A1.p2.5.m5.1.1.3" xref="A1.p2.5.m5.1.1.3.cmml"><mn id="A1.p2.5.m5.1.1.3.2" xref="A1.p2.5.m5.1.1.3.2.cmml">10</mn><mn id="A1.p2.5.m5.1.1.3.3" xref="A1.p2.5.m5.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.5.m5.1b"><apply id="A1.p2.5.m5.1.1.cmml" xref="A1.p2.5.m5.1.1"><gt id="A1.p2.5.m5.1.1.1.cmml" xref="A1.p2.5.m5.1.1.1"></gt><ci id="A1.p2.5.m5.1.1.2.cmml" xref="A1.p2.5.m5.1.1.2">𝑁</ci><apply id="A1.p2.5.m5.1.1.3.cmml" xref="A1.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="A1.p2.5.m5.1.1.3.1.cmml" xref="A1.p2.5.m5.1.1.3">superscript</csymbol><cn id="A1.p2.5.m5.1.1.3.2.cmml" type="integer" xref="A1.p2.5.m5.1.1.3.2">10</cn><cn id="A1.p2.5.m5.1.1.3.3.cmml" type="integer" xref="A1.p2.5.m5.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.5.m5.1c">N&gt;10^{3}</annotation><annotation encoding="application/x-llamapun" id="A1.p2.5.m5.1d">italic_N &gt; 10 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, the proposed estimator <math alttext="\beta" class="ltx_Math" display="inline" id="A1.p2.6.m6.1"><semantics id="A1.p2.6.m6.1a"><mi id="A1.p2.6.m6.1.1" xref="A1.p2.6.m6.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.p2.6.m6.1b"><ci id="A1.p2.6.m6.1.1.cmml" xref="A1.p2.6.m6.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.6.m6.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.p2.6.m6.1d">italic_β</annotation></semantics></math>-IPS results in a minimum sample variance, thereby empirically validating the effectiveness of our proposed <math alttext="\beta" class="ltx_Math" display="inline" id="A1.p2.7.m7.1"><semantics id="A1.p2.7.m7.1a"><mi id="A1.p2.7.m7.1.1" xref="A1.p2.7.m7.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.p2.7.m7.1b"><ci id="A1.p2.7.m7.1.1.cmml" xref="A1.p2.7.m7.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.7.m7.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.p2.7.m7.1d">italic_β</annotation></semantics></math>-IPS estimator for the task of OPE.</p>
</div>
</section>
<section class="ltx_appendix" id="Ax1">
<h2 class="ltx_title ltx_title_appendix">Acknowledgements</h2>
<div class="ltx_para" id="Ax1.p1">
<p class="ltx_p" id="Ax1.p1.1">The authors would like to thank Adith Swaminathan, Thorsten Joachims, Ben London, and Philipp Hager for valuable discussions and feedback on early drafts of this manuscript.</p>
</div>
<div class="ltx_para" id="Ax1.p2">
<p class="ltx_p" id="Ax1.p2.1">This research was supported by Huawei Finland,
the Dutch Research Council (NWO), under project numbers VI.Veni.222.269, 024.004.022, NWA.1389.20.183, and KICH3.LTP.20.006,
and the European Union’s Horizon Europe program under grant agreement No 101070212.
All content represents the opinion of the authors, which is not necessarily shared or endorsed by their respective employers and/or sponsors.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Baweja et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Shubham Baweja, Neeti Pokharna, Aleksei Ustimenko, and Olivier Jeunen. 2024.

</span>
<span class="ltx_bibblock">Variance Reduction in Ratio Metrics for Efficient Online Experiments. In <em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">Proc. of the 46th European Conference on Information Retrieval</em> <em class="ltx_emph ltx_font_italic" id="bib.bib2.4.2">(ECIR ’24)</em>. Springer.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bendada et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Walid Bendada, Guillaume Salha, and Théo Bontempelli. 2020.

</span>
<span class="ltx_bibblock">Carousel Personalization in Music Streaming Apps with Contextual Bandits. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">Proceedings of the 14th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib3.4.2">(RecSys ’20)</em>. ACM, 420–425.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3383313.3412217" title="">https://doi.org/10.1145/3383313.3412217</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bennett et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2007)</span>
<span class="ltx_bibblock">
James Bennett, Stan Lanning, et al<span class="ltx_text" id="bib.bib4.3.1">.</span> 2007.

</span>
<span class="ltx_bibblock">The Netflix Prize. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.4.1">Proceedings of KDD cup and workshop</em>, Vol. 2007. 35.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bottou et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Léon Bottou, Frank E. Curtis, and Jorge Nocedal. 2018.

</span>
<span class="ltx_bibblock">Optimization Methods for Large-scale Machine Learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">SIAM review</em> 60, 2 (2018), 223–311.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Briand et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Léa Briand, Théo Bontempelli, Walid Bendada, Mathieu Morlon, François Rigaud, Benjamin Chapus, Thomas Bouabça, and Guillaume Salha-Galvan. 2024.

</span>
<span class="ltx_bibblock">Let’s Get It Started: Fostering the Discoverability of New Releases on Deezer. In <em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">Proc. of the 46th European Conference on Information Retrieval</em> <em class="ltx_emph ltx_font_italic" id="bib.bib6.4.2">(ECIR ’24)</em>. Springer.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Budylin et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Roman Budylin, Alexey Drutsa, Ilya Katsev, and Valeriya Tsoy. 2018.

</span>
<span class="ltx_bibblock">Consistent Transformation of Ratio Metrics for Efficient Online Controlled Experiments. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">Proc. of the Eleventh ACM International Conference on Web Search and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib7.4.2">(WSDM ’18)</em>. ACM, 55–63.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3159652.3159699" title="">https://doi.org/10.1145/3159652.3159699</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Minmin Chen, Alex Beutel, Paul Covington, Sagar Jain, Francois Belletti, and Ed H. Chi. 2019.

</span>
<span class="ltx_bibblock">Top-K Off-Policy Correction for a REINFORCE Recommender System. In <em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">Proceedings of the Twelfth ACM International Conference on Web Search and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib8.4.2">(WSDM ’19)</em>. ACM, 456–464.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3289600.3290999" title="">https://doi.org/10.1145/3289600.3290999</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Minmin Chen, Bo Chang, Can Xu, and Ed H. Chi. 2021.

</span>
<span class="ltx_bibblock">User Response Models to Improve a REINFORCE Recommender System. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Proceedings of the 14th ACM International Conference on Web Search and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib9.4.2">(WSDM ’21)</em>. ACM, New York, NY, USA, 121–129.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3437963.3441764" title="">https://doi.org/10.1145/3437963.3441764</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Minmin Chen, Can Xu, Vince Gatto, Devanshu Jain, Aviral Kumar, and Ed Chi. 2022.

</span>
<span class="ltx_bibblock">Off-Policy Actor-Critic for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">Proceedings of the 16th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib10.4.2">(RecSys ’22)</em>. ACM, 338–349.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3523227.3546758" title="">https://doi.org/10.1145/3523227.3546758</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dayan (1991)</span>
<span class="ltx_bibblock">
Peter Dayan. 1991.

</span>
<span class="ltx_bibblock">Reinforcement Comparison.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Connectionist Models</em>, David S. Touretzky, Jeffrey L. Elman, Terrence J. Sejnowski, and Geoffrey E. Hinton (Eds.). Morgan Kaufmann, 45–51.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1016/B978-1-4832-1448-1.50011-1" title="">https://doi.org/10.1016/B978-1-4832-1448-1.50011-1</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2013)</span>
<span class="ltx_bibblock">
Alex Deng, Ya Xu, Ron Kohavi, and Toby Walker. 2013.

</span>
<span class="ltx_bibblock">Improving the Sensitivity of Online Controlled Experiments by Utilizing Pre-Experiment Data. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">Proc. of the Sixth ACM International Conference on Web Search and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib12.4.2">(WSDM ’13)</em>. ACM, 123–132.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2433396.2433413" title="">https://doi.org/10.1145/2433396.2433413</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Zhenhua Dong, Hong Zhu, Pengxiang Cheng, Xinhua Feng, Guohao Cai, Xiuqiang He, Jun Xu, and Jirong Wen. 2020.

</span>
<span class="ltx_bibblock">Counterfactual learning for recommender system. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">Proceedings of the 14th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib13.4.2">(RecSys ’20)</em>. ACM, 568–569.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3383313.3411552" title="">https://doi.org/10.1145/3383313.3411552</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dudík et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Miroslav Dudík, Dumitru Erhan, John Langford, and Lihong Li. 2014.

</span>
<span class="ltx_bibblock">Doubly Robust Policy Evaluation and Optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Statist. Sci.</em> 29, 4 (2014), 485 – 511.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1214/14-STS500" title="">https://doi.org/10.1214/14-STS500</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Farajtabar et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Mehrdad Farajtabar, Yinlam Chow, and Mohammad Ghavamzadeh. 2018.

</span>
<span class="ltx_bibblock">More Robust Doubly Robust Off-policy Evaluation. In <em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">Proceedings of the 35th International Conference on Machine Learning</em> <em class="ltx_emph ltx_font_italic" id="bib.bib15.4.2">(Proceedings of Machine Learning Research, Vol. 80)</em>, Jennifer Dy and Andreas Krause (Eds.). PMLR, 1447–1456.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v80/farajtabar18a.html" title="">https://proceedings.mlr.press/v80/farajtabar18a.html</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Freedman (2008)</span>
<span class="ltx_bibblock">
David A. Freedman. 2008.

</span>
<span class="ltx_bibblock">On Regression Adjustments to Experimental Data.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Advances in Applied Mathematics</em> 40, 2 (2008), 180–193.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1016/j.aam.2006.12.003" title="">https://doi.org/10.1016/j.aam.2006.12.003</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Greensmith et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2004)</span>
<span class="ltx_bibblock">
Evan Greensmith, Peter L. Bartlett, and Jonathan Baxter. 2004.

</span>
<span class="ltx_bibblock">Variance Reduction Techniques for Gradient Estimates in Reinforcement Learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">J. Mach. Learn. Res.</em> 5 (dec 2004), 1471–1530.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2024a)</span>
<span class="ltx_bibblock">
Shashank Gupta, Philipp Hager, Jin Huang, Ali Vardasbi, and Harrie Oosterhuis. 2024a.

</span>
<span class="ltx_bibblock">Unbiased Learning to Rank: On Recent Advances and Practical Applications. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">Proceedings of the 17th ACM International Conference on Web Search and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib18.4.2">(WSDM ’24)</em>. ACM, 1118–1121.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3616855.3636451" title="">https://doi.org/10.1145/3616855.3636451</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Shashank Gupta, Harrie Oosterhuis, and Maarten de Rijke. 2023a.

</span>
<span class="ltx_bibblock">A Deep Generative Recommendation Method for Unbiased Learning from Implicit Feedback. In <em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">Proceedings of the 2023 ACM SIGIR International Conference on Theory of Information Retrieval</em>. 87–93.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Shashank Gupta, Harrie Oosterhuis, and Maarten de Rijke. 2023b.

</span>
<span class="ltx_bibblock">A First Look at Selection Bias in Preference Elicitation for Recommendation (Abstract). In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">CONSEQUENCES Workshop at RecSys ’23</em>. ACM.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2023c)</span>
<span class="ltx_bibblock">
Shashank Gupta, Harrie Oosterhuis, and Maarten de Rijke. 2023c.

</span>
<span class="ltx_bibblock">Safe Deployment for Counterfactual Learning to Rank with Exposure-based Risk Minimization. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>. 249–258.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2024b)</span>
<span class="ltx_bibblock">
Shashank Gupta, Harrie Oosterhuis, and Maarten de Rijke. 2024b.

</span>
<span class="ltx_bibblock">Practical and Robust Safety Guarantees for Advanced Counterfactual Learning to Rank. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">CIKM 2024: 33rd ACM International Conference on Information and Knowledge Management</em>. ACM.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ionides (2008)</span>
<span class="ltx_bibblock">
Edward L Ionides. 2008.

</span>
<span class="ltx_bibblock">Truncated Importance Sampling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Journal of Computational and Graphical Statistics</em> 17, 2 (2008), 295–311.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1198/106186008X320456" title="">https://doi.org/10.1198/106186008X320456</a>
arXiv:https://doi.org/10.1198/106186008X320456

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeunen (2021)</span>
<span class="ltx_bibblock">
Olivier Jeunen. 2021.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Offline Approaches to Recommendation with Online Success</em>.

</span>
<span class="ltx_bibblock">Ph. D. Dissertation. University of Antwerp.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeunen and Goethals (2020)</span>
<span class="ltx_bibblock">
Olivier Jeunen and Bart Goethals. 2020.

</span>
<span class="ltx_bibblock">An Empirical Evaluation of Doubly Robust Learning for Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proc. of the ACM RecSys Workshop on Bandit Learning from User Interactions</em> <em class="ltx_emph ltx_font_italic" id="bib.bib25.2.2">(REVEAL ’20)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeunen and Goethals (2021a)</span>
<span class="ltx_bibblock">
Olivier Jeunen and Bart Goethals. 2021a.

</span>
<span class="ltx_bibblock">Pessimistic Reward Models for Off-Policy Learning in Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the 15th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib26.2.2">(RecSys ’21)</em>. ACM, 63–74.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3460231.3474247" title="">https://doi.org/10.1145/3460231.3474247</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeunen and Goethals (2021b)</span>
<span class="ltx_bibblock">
Olivier Jeunen and Bart Goethals. 2021b.

</span>
<span class="ltx_bibblock">Top-K Contextual Bandits with Equity of Exposure. In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Proceedings of the 15th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib27.2.2">(RecSys ’21)</em>. ACM, 310–320.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3460231.3474248" title="">https://doi.org/10.1145/3460231.3474248</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeunen and Goethals (2023)</span>
<span class="ltx_bibblock">
Olivier Jeunen and Bart Goethals. 2023.

</span>
<span class="ltx_bibblock">Pessimistic Decision-Making for Recommender Systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">ACM Trans. Recomm. Syst.</em> 1, 1, Article 4 (feb 2023), 27 pages.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3568029" title="">https://doi.org/10.1145/3568029</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeunen et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Olivier Jeunen, Thorsten Joachims, Harrie Oosterhuis, Yuta Saito, and Flavian Vasile. 2022.

</span>
<span class="ltx_bibblock">CONSEQUENCES—Causality, Counterfactuals and Sequential Decision-Making for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">Proceedings of the 16th ACM Conference on Recommender Systems</em>. 654–657.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeunen et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Olivier Jeunen, Sean Murphy, and Ben Allison. 2023.

</span>
<span class="ltx_bibblock">Off-Policy Learning-to-Bid with AuctionGym. In <em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib30.4.2">(KDD ’23)</em>. ACM, 4219–4228.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3580305.3599877" title="">https://doi.org/10.1145/3580305.3599877</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeunen et al<span class="ltx_text" id="bib.bib31.3.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Olivier Jeunen, Ivan Potapov, and Aleksei Ustimenko. 2024.

</span>
<span class="ltx_bibblock">On (Normalised) Discounted Cumulative Gain as an Offline Evaluation Metric for Top-<math alttext="n" class="ltx_Math" display="inline" id="bib.bib31.1.m1.1"><semantics id="bib.bib31.1.m1.1a"><mi id="bib.bib31.1.m1.1.1" xref="bib.bib31.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="bib.bib31.1.m1.1b"><ci id="bib.bib31.1.m1.1.1.cmml" xref="bib.bib31.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib31.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="bib.bib31.1.m1.1d">italic_n</annotation></semantics></math> Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib31.4.1">Proceedings of the 30th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib31.5.2">(KDD ’24)</em>.

</span>
<span class="ltx_bibblock">arXiv:2307.15053 [cs.IR]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeunen et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Olivier Jeunen, David Rohde, Flavian Vasile, and Martin Bompaire. 2020.

</span>
<span class="ltx_bibblock">Joint Policy-Value Learning for Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib32.4.2">(KDD ’20)</em>. ACM, 1223–1233.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3394486.3403175" title="">https://doi.org/10.1145/3394486.3403175</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Joachims and Swaminathan (2016)</span>
<span class="ltx_bibblock">
Thorsten Joachims and Adith Swaminathan. 2016.

</span>
<span class="ltx_bibblock">Counterfactual Evaluation and Learning for Search, Recommendation and Ad Placement. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Proceedings of the 39th International ACM SIGIR conference on Research and Development in Information Retrieval</em>. 1199–1201.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Joachims et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Thorsten Joachims, Adith Swaminathan, and Maarten de Rijke. 2018.

</span>
<span class="ltx_bibblock">Deep Learning with Logged Bandit Feedback. In <em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">International Conference on Learning Representations</em>.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=SJaP_-xAb" title="">https://openreview.net/forum?id=SJaP_-xAb</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba (2014)</span>
<span class="ltx_bibblock">
Diederik P. Kingma and Jimmy Ba. 2014.

</span>
<span class="ltx_bibblock">Adam: A Method for Stochastic Optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">arXiv preprint arXiv:1412.6980</em> (2014).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kong (1992)</span>
<span class="ltx_bibblock">
Augustine Kong. 1992.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">A Note on Importance Sampling Using Standardized Weights</em>.

</span>
<span class="ltx_bibblock">Technical Report 348. University of Chicago, Dept. of Statistics.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lattimore and Szepesvári (2020)</span>
<span class="ltx_bibblock">
Tor Lattimore and Csaba Szepesvári. 2020.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Bandit Algorithms</em>.

</span>
<span class="ltx_bibblock">Cambridge University Press.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Levine et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Sergey Levine, Aviral Kumar, George Tucker, and Justin Fu. 2020.

</span>
<span class="ltx_bibblock">Offline Reinforcement Learning: Tutorial, Review, and Perspectives on Open Problems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">arXiv preprint arXiv:2005.01643</em> (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2010)</span>
<span class="ltx_bibblock">
Lihong Li, Wei Chu, John Langford, and Robert E. Schapire. 2010.

</span>
<span class="ltx_bibblock">A Contextual-bandit Approach to Personalized News Article Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">Proceedings of the 19th International Conference on World Wide Web</em> (Raleigh, North Carolina, USA) <em class="ltx_emph ltx_font_italic" id="bib.bib39.4.2">(WWW ’10)</em>. ACM, 661–670.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/1772690.1772758" title="">https://doi.org/10.1145/1772690.1772758</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yaxu Liu, Jui-Nan Yen, Bowen Yuan, Rundong Shi, Peng Yan, and Chih-Jen Lin. 2022.

</span>
<span class="ltx_bibblock">Practical Counterfactual Policy Learning for Top-K Recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib40.4.2">(KDD ’22)</em>. ACM, 1141–1151.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3534678.3539295" title="">https://doi.org/10.1145/3534678.3539295</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">London et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Ben London, Alexander Buchholz, Giuseppe Di Benedetto, Jan Malte Lichtenberg, Yannik Stein, and Thorsten Joachims. 2023.

</span>
<span class="ltx_bibblock">Self-Normalized Off-Policy Estimators for Ranking. In <em class="ltx_emph ltx_font_italic" id="bib.bib41.3.1">CONSEQUENCES Workshop at ACM RecSys ’23</em> <em class="ltx_emph ltx_font_italic" id="bib.bib41.4.2">(CONSEQUENCES ’23)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jiaqi Ma, Zhe Zhao, Xinyang Yi, Ji Yang, Minmin Chen, Jiaxi Tang, Lichan Hong, and Ed H. Chi. 2020.

</span>
<span class="ltx_bibblock">Off-Policy Learning in Two-Stage Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">Proceedings of The Web Conference 2020</em> <em class="ltx_emph ltx_font_italic" id="bib.bib42.4.2">(WWW ’20)</em>. ACM, 463–473.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3366423.3380130" title="">https://doi.org/10.1145/3366423.3380130</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McInerney et al<span class="ltx_text" id="bib.bib43.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
James McInerney, Benjamin Lacker, Samantha Hansen, Karl Higley, Hugues Bouchard, Alois Gruson, and Rishabh Mehrotra. 2018.

</span>
<span class="ltx_bibblock">Explore, Exploit, and Explain: Personalizing Explainable Recommendations with Bandits. In <em class="ltx_emph ltx_font_italic" id="bib.bib43.3.1">Proceedings of the 12th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib43.4.2">(RecSys ’18)</em>. ACM, 31–39.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3240323.3240354" title="">https://doi.org/10.1145/3240323.3240354</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mehrotra et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Rishabh Mehrotra, Niannan Xue, and Mounia Lalmas. 2020.

</span>
<span class="ltx_bibblock">Bandit based Optimization of Multiple Objectives on a Music Streaming Platform. In <em class="ltx_emph ltx_font_italic" id="bib.bib44.3.1">Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib44.4.2">(KDD ’20)</em>. ACM, 3224–3233.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3394486.3403374" title="">https://doi.org/10.1145/3394486.3403374</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mohamed et al<span class="ltx_text" id="bib.bib45.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Shakir Mohamed, Mihaela Rosca, Michael Figurnov, and Andriy Mnih. 2020.

</span>
<span class="ltx_bibblock">Monte Carlo Gradient Estimation in Machine Learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.3.1">J. Mach. Learn. Res.</em> 21, 1, Article 132 (jan 2020), 62 pages.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Owen (2013)</span>
<span class="ltx_bibblock">
Art B. Owen. 2013.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Monte Carlo Theory, Methods and Examples</em>.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://artowen.su.domains/mc/" title="">https://artowen.su.domains/mc/</a>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Poyarkov et al<span class="ltx_text" id="bib.bib47.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Alexey Poyarkov, Alexey Drutsa, Andrey Khalyavin, Gleb Gusev, and Pavel Serdyukov. 2016.

</span>
<span class="ltx_bibblock">Boosted Decision Tree Regression Adjustment for Variance Reduction in Online Controlled Experiments. In <em class="ltx_emph ltx_font_italic" id="bib.bib47.3.1">Proc. of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib47.4.2">(KDD ’16)</em>. ACM, 235–244.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2939672.2939688" title="">https://doi.org/10.1145/2939672.2939688</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle (2022)</span>
<span class="ltx_bibblock">
Steffen Rendle. 2022.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">Item Recommendation from Implicit Feedback</em>.

</span>
<span class="ltx_bibblock">Springer US, New York, NY, 143–171.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1007/978-1-0716-2197-4_4" title="">https://doi.org/10.1007/978-1-0716-2197-4_4</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rohde et al<span class="ltx_text" id="bib.bib49.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
David Rohde, Stephen Bonner, Travis Dunlop, Flavian Vasile, and Alexandros Karatzoglou. 2018.

</span>
<span class="ltx_bibblock">RecoGym: A Reinforcement Learning Environment for the Problem of Product Recommendation in Online Advertising.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.3.1">arXiv preprint arXiv:1808.00720</em> (2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Saito et al<span class="ltx_text" id="bib.bib50.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Yuta Saito, Shunsuke Aihara, Megumi Matsutani, and Yusuke Narita. 2020.

</span>
<span class="ltx_bibblock">Open Bandit Dataset and Pipeline: Towards Realistic and Reproducible Off-policy Evaluation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.3.1">arXiv preprint arXiv:2008.07146</em> (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Saito and Joachims (2021)</span>
<span class="ltx_bibblock">
Yuta Saito and Thorsten Joachims. 2021.

</span>
<span class="ltx_bibblock">Counterfactual Learning and Evaluation for Recommender Systems: Foundations, Implementations, and Recent Advances. In <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">Proc. of the 15th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib51.2.2">(RecSys ’21)</em>. ACM, 828–830.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3460231.3473320" title="">https://doi.org/10.1145/3460231.3473320</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Saito and Joachims (2022)</span>
<span class="ltx_bibblock">
Yuta Saito and Thorsten Joachims. 2022.

</span>
<span class="ltx_bibblock">Counterfactual Evaluation and Learning for Interactive Systems: Foundations, Implementations, and Recent Advances. In <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>. 4824–4825.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Saito et al<span class="ltx_text" id="bib.bib53.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Yuta Saito, Takuma Udagawa, Haruka Kiyohara, Kazuki Mogi, Yusuke Narita, and Kei Tateno. 2021.

</span>
<span class="ltx_bibblock">Evaluating the Robustness of Off-Policy Evaluation. In <em class="ltx_emph ltx_font_italic" id="bib.bib53.3.1">Proceedings of the 15th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib53.4.2">(RecSys ’21)</em>. ACM, 114–123.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3460231.3474245" title="">https://doi.org/10.1145/3460231.3474245</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sakhi et al<span class="ltx_text" id="bib.bib54.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Otmane Sakhi, Stephen Bonner, David Rohde, and Flavian Vasile. 2020.

</span>
<span class="ltx_bibblock">BLOB: A Probabilistic Model for Recommendation that Combines Organic and Bandit Signals. In <em class="ltx_emph ltx_font_italic" id="bib.bib54.3.1">Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib54.4.2">(KDD ’20)</em>. ACM, 783–793.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3394486.3403121" title="">https://doi.org/10.1145/3394486.3403121</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schulman et al<span class="ltx_text" id="bib.bib55.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
John Schulman, Philipp Moritz, Sergey Levine, Michael Jordan, and Pieter Abbeel. 2016.

</span>
<span class="ltx_bibblock">High-Dimensional Continuous Control Using Generalized Advantage Estimation. In <em class="ltx_emph ltx_font_italic" id="bib.bib55.3.1">Proceedings of the International Conference on Learning Representations (ICLR)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shani et al<span class="ltx_text" id="bib.bib56.2.2.1">.</span> (2002)</span>
<span class="ltx_bibblock">
Guy Shani, Ronen I. Brafman, and David Heckerman. 2002.

</span>
<span class="ltx_bibblock">An MDP-based Recommender System. In <em class="ltx_emph ltx_font_italic" id="bib.bib56.3.1">Proceedings of the Eighteenth Conference on Uncertainty in Artificial Intelligence</em> (Alberta, Canada) <em class="ltx_emph ltx_font_italic" id="bib.bib56.4.2">(UAI’02)</em>. Morgan Kaufmann Publishers Inc., San Francisco, CA, USA, 453–460.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Steck (2013)</span>
<span class="ltx_bibblock">
Harald Steck. 2013.

</span>
<span class="ltx_bibblock">Evaluation of Recommendations: Rating-prediction and Ranking. In <em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">Proc. of the 7th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib57.2.2">(RecSys ’13)</em>. ACM, 213–220.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2507157.2507160" title="">https://doi.org/10.1145/2507157.2507160</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al<span class="ltx_text" id="bib.bib58.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Yi Su, Maria Dimakopoulou, Akshay Krishnamurthy, and Miroslav Dudík. 2020.

</span>
<span class="ltx_bibblock">Doubly Robust Off-policy Evaluation with Shrinkage. In <em class="ltx_emph ltx_font_italic" id="bib.bib58.3.1">International Conference on Machine Learning</em>. PMLR, 9167–9176.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al<span class="ltx_text" id="bib.bib59.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Yi Su, Lequn Wang, Michele Santacatterina, and Thorsten Joachims. 2019.

</span>
<span class="ltx_bibblock">CAB: Continuous Adaptive Blending for Policy Evaluation and Learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib59.3.1">Proc. of the 36th International Conference on Machine Learning</em> <em class="ltx_emph ltx_font_italic" id="bib.bib59.4.2">(ICML ’19, Vol. 97)</em>. PMLR, 6005–6014.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v97/su19a.html" title="">https://proceedings.mlr.press/v97/su19a.html</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al<span class="ltx_text" id="bib.bib60.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Yi Su, Xiangyu Wang, Elaine Ya Le, Liang Liu, Yuening Li, Haokai Lu, Benjamin Lipshitz, Sriraj Badam, Lukasz Heldt, Shuchao Bi, Ed H. Chi, Cristos Goodrow, Su-Lin Wu, Lexi Baugher, and Minmin Chen. 2024.

</span>
<span class="ltx_bibblock">Long-Term Value of Exploration: Measurements, Findings and Algorithms. In <em class="ltx_emph ltx_font_italic" id="bib.bib60.3.1">Proceedings of the 17th ACM International Conference on Web Search and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib60.4.2">(WSDM ’24)</em>. ACM, 636–644.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3616855.3635833" title="">https://doi.org/10.1145/3616855.3635833</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sutton and Barto (2018)</span>
<span class="ltx_bibblock">
Richard S. Sutton and Andrew G. Barto. 2018.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">Reinforcement Learning: An Introduction</em>.

</span>
<span class="ltx_bibblock">MIT press.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Swaminathan and Joachims (2015a)</span>
<span class="ltx_bibblock">
Adith Swaminathan and Thorsten Joachims. 2015a.

</span>
<span class="ltx_bibblock">Batch Learning from Logged Bandit Feedback through Counterfactual Risk Minimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">The Journal of Machine Learning Research</em> 16, 1 (2015), 1731–1755.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Swaminathan and Joachims (2015b)</span>
<span class="ltx_bibblock">
Adith Swaminathan and Thorsten Joachims. 2015b.

</span>
<span class="ltx_bibblock">The Self-Normalized Estimator for Counterfactual Learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib63.1.1">Advances in Neural Information Processing Systems</em>, Vol. 28.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2015/file/39027dfad5138c9ca0c474d71db915c3-Paper.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2015/file/39027dfad5138c9ca0c474d71db915c3-Paper.pdf</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">van den Akker et al<span class="ltx_text" id="bib.bib64.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Bram van den Akker, Olivier Jeunen, Ying Li, Ben London, Zahra Nazari, and Devesh Parekh. 2024.

</span>
<span class="ltx_bibblock">Practical Bandits: An Industry Perspective. In <em class="ltx_emph ltx_font_italic" id="bib.bib64.3.1">Proceedings of the 17th ACM International Conference on Web Search and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib64.4.2">(WSDM ’24)</em>. ACM, 1132–1135.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3616855.3636449" title="">https://doi.org/10.1145/3616855.3636449</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vasile et al<span class="ltx_text" id="bib.bib65.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Flavian Vasile, David Rohde, Olivier Jeunen, and Amine Benhalloum. 2020.

</span>
<span class="ltx_bibblock">A Gentle Introduction to Recommendation as Counterfactual Policy Learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib65.3.1">Proceedings of the 28th ACM Conference on User Modeling, Adaptation and Personalization</em> <em class="ltx_emph ltx_font_italic" id="bib.bib65.4.2">(UMAP ’20)</em>. ACM, 392–393.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3340631.3398666" title="">https://doi.org/10.1145/3340631.3398666</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Williams (1988)</span>
<span class="ltx_bibblock">
Ronald J. Williams. 1988.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib66.1.1">Toward a Theory of Reinforcement-learning Connectionist Systems</em>.

</span>
<span class="ltx_bibblock">Technical Report NU-CCS-88-3. Northeastern University.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Williams (1992)</span>
<span class="ltx_bibblock">
Ronald J. Williams. 1992.

</span>
<span class="ltx_bibblock">Simple Statistical Gradient-following Algorithms for Connectionist Reinforcement Learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib67.1.1">Machine Learning</em> 8, 3 (01 May 1992), 229–256.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1007/BF00992696" title="">https://doi.org/10.1007/BF00992696</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yi et al<span class="ltx_text" id="bib.bib68.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Xinyang Yi, Shao-Chuan Wang, Ruining He, Hariharan Chandrasekaran, Charles Wu, Lukasz Heldt, Lichan Hong, Minmin Chen, and Ed H. Chi. 2023.

</span>
<span class="ltx_bibblock">Online Matching: A Real-time Bandit System for Large-scale Recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib68.3.1">Proceedings of the 17th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib68.4.2">(RecSys ’23)</em>. ACM, New York, NY, USA, 403–414.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3604915.3608792" title="">https://doi.org/10.1145/3604915.3608792</a>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Aug 14 14:16:41 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
