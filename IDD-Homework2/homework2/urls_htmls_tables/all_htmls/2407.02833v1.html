<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation</title>
<!--Generated on Wed Jul  3 06:07:57 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2407.02833v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S1" title="In LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S2" title="In LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S2.SS1" title="In 2 Related Work ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Explainable Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S2.SS2" title="In 2 Related Work ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Prompting LLMs For Recommendation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S3" title="In LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S3.SS1" title="In 3 Methodology ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Problem Statement</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S3.SS2" title="In 3 Methodology ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>LANE</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S3.SS2.SSS1" title="In 3.2 LANE ‣ 3 Methodology ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S3.SS2.SSS2" title="In 3.2 LANE ‣ 3 Methodology ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Semantic Embedding Module</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S3.SS2.SSS3" title="In 3.2 LANE ‣ 3 Methodology ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.3 </span>Integrated Model Module</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S3.SS2.SSS4" title="In 3.2 LANE ‣ 3 Methodology ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.4 </span>Users’ Multi-Preferences Generation Module</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S3.SS2.SSS5" title="In 3.2 LANE ‣ 3 Methodology ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.5 </span>Semantic Alignment Module</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S3.SS2.SSS5.Px1" title="In 3.2.5 Semantic Alignment Module ‣ 3.2 LANE ‣ 3 Methodology ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title">Multi-Head Attention.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S3.SS2.SSS5.Px2" title="In 3.2.5 Semantic Alignment Module ‣ 3.2 LANE ‣ 3 Methodology ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title">Position-wise Feed-Forward Networks.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S3.SS2.SSS5.Px3" title="In 3.2.5 Semantic Alignment Module ‣ 3.2 LANE ‣ 3 Methodology ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title">Residual Connections and Layer Normalization.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S3.SS2.SSS6" title="In 3.2 LANE ‣ 3 Methodology ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.6 </span>Prediction Module</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S3.SS2.SSS6.Px1" title="In 3.2.6 Prediction Module ‣ 3.2 LANE ‣ 3 Methodology ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title">Model Training.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S3.SS2.SSS7" title="In 3.2 LANE ‣ 3 Methodology ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.7 </span>Explainable Recommendation Generation Module</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4" title="In LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4.SS1" title="In 4 Experiments ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experiment Settings</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4.SS1.SSS0.Px1" title="In 4.1 Experiment Settings ‣ 4 Experiments ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title">Dateset.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4.SS1.SSS0.Px2" title="In 4.1 Experiment Settings ‣ 4 Experiments ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title">Baseline.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4.SS1.SSS0.Px3" title="In 4.1 Experiment Settings ‣ 4 Experiments ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title">Evaluation Metrics.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4.SS1.SSS0.Px4" title="In 4.1 Experiment Settings ‣ 4 Experiments ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title">Implementation Details.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4.SS2" title="In 4 Experiments ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Experiment Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4.SS3" title="In 4 Experiments ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Sensitivity Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4.SS4" title="In 4 Experiments ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Case Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4.SS5" title="In 4 Experiments ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Quality Analysis of Explanation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S5" title="In LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#A1" title="In LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Seven metrics and their description problems</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#A2" title="In LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Sample Information and explanation of framework output</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
<span class="ltx_text ltx_font_italic" id="id1.id1">LANE</span>: <span class="ltx_text ltx_font_italic" id="id2.id2">L</span>ogic <span class="ltx_text ltx_font_italic" id="id3.id3">A</span>lignment of <span class="ltx_text ltx_font_italic" id="id4.id4">N</span>on-tuning Large Language Models and Online Recommendation Systems for <span class="ltx_text ltx_font_italic" id="id5.id5">E</span>xplainable Reason Generation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hongke Zhao  
<br class="ltx_break"/>Tianjing University 
<br class="ltx_break"/>&amp;Songming Zheng <span class="ltx_note ltx_role_footnotemark" id="footnotex1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">1</span></span></span></span>
<br class="ltx_break"/>Tianjing University 
<br class="ltx_break"/>Likang Wu 
<br class="ltx_break"/>Tianjing University 
<br class="ltx_break"/>&amp;Bowen Yu 
<br class="ltx_break"/>Baidu Talent Intelligence Center, Baidu Inc 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id6.1.id1">yubowen04@baidu.com</span>
<br class="ltx_break"/>&amp;Jing Wang 
<br class="ltx_break"/>Baidu Talent Intelligence Center, Baidu Inc 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id7.2.id2">wangjing79@baidu.com</span>
<br class="ltx_break"/>
</span><span class="ltx_author_notes">These authors contributed equally to this work.Corresponding author.</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id8.id1">The explainability of recommendation systems is crucial for enhancing user trust and satisfaction. Leveraging large language models (LLMs) offers new opportunities for comprehensive recommendation logic generation. However, in existing related studies, fine-tuning LLM models for recommendation tasks incurs high computational costs and alignment issues with existing systems, limiting the application potential of proven proprietary/closed-source LLM models, such as GPT-4. In this work, our proposed effective strategy <span class="ltx_text ltx_font_bold" id="id8.id1.1">LANE</span> aligns LLMs with online recommendation systems without additional LLMs tuning, reducing costs and improving explainability. This innovative approach addresses key challenges in integrating language models with recommendation systems while fully utilizing the capabilities of powerful proprietary models. Specifically, our strategy operates through several key components: semantic embedding, user multi-preference extraction using zero-shot prompting, semantic alignment, and explainable recommendation generation using Chain of Thought (CoT) prompting. By embedding item titles instead of IDs and utilizing multi-head attention mechanisms, our approach aligns the semantic features of user preferences with those of candidate items, ensuring coherent and user-aligned recommendations. Sufficient experimental results including performance comparison, questionnaire voting, and visualization cases prove that our method can not only ensure recommendation performance, but also provide easy-to-understand and reasonable recommendation logic.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In the realm of recommendation systems, the explainability of results has emerged as a critical factor. The importance of explainability lies in its ability to enhance user trust and satisfaction by providing clear and understandable reasons behind recommendations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib57" title="">57</a>]</cite>. The advent of large language models (LLMs) with their robust language comprehension and generation capabilities opens new avenues for bolstering the explainability of recommendation systems<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib52" title="">52</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib14" title="">14</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Utilizing large language models to generate recommendation reasons involves fine-tuning or prompt-tuning approaches <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib32" title="">32</a>]</cite>. Model tuning allows LLMs to adjust their parameters based on specific datasets , aligning their outputs closely with the desired recommendation logic <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib53" title="">53</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib29" title="">29</a>]</cite>. Through this direct way, LLMs can effectively summarize and learn user preferences inherent in recommendation tasks. Consequently, LLMs can function both as recommenders and explainers, or serve as auxiliary explainers to augment the explainability of existing online recommendation systems, such as SASrec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib25" title="">25</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">However, these tuning strategies are not without their drawbacks. Firstly, compared to traditional recommendation models, training and updating LLMs incur substantial computational resource costs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib42" title="">42</a>]</cite>. The significant computational demands translate to higher energy consumption and increased operational expenses, posing practical challenges for widespread deployment. Moreover, representative proprietary models, like ChatGPT-4 , exhibit superior language generation and commercial application capabilities relative to open-source models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib31" title="">31</a>]</cite>. Nevertheless, there is a misalignment between the user preferences inferred through historical sequence prompts and those used by online recommendation systems, leading to inconsistent recommendation logic. This discrepancy implies that proprietary models cannot be effectively utilized in practical explainable recommendation tasks if they require tuning for alignment.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To address these issues, our objective is to propose a novel learning strategy that aligns the recommendation logic of LLMs with that of online recommendation systems without necessitating the training of the LLMs themselves. This approach aims to significantly reduce model training and maintenance costs while harnessing the potential of proprietary commercial models to enhance the explainability of existing recommendation systems. Achieving this goal represents a significant breakthrough in combining large models with recommendation systems, overcoming a critical application bottleneck.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">In this paper, we propose an innovative explainable recommendation framework <span class="ltx_text ltx_font_bold" id="S1.p5.1.1">LANE</span> that leverages large language models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib46" title="">46</a>]</cite> requiring no tuning to align with the recommendation logic of ordinary recommenders. This framework generates reasonable and easily understandable explanations of recommendation reasons. Our primary strategy involves using large language models to sample potential user preferences from multiple perspectives. These preferences are then matched with the embeddings of the operational recommendation system using a query-based learning approach. This straightforward and effective method ensures that the textual explanations of user preferences are consistent with the recommendation logic of the actual system. Our framework is not only model-agnostic but also offers good model explainability. Additionally, to simplify the use of advanced LLMs and fully utilize their capabilities, avoiding issues such as closed-source LLMs or limited computational resources, this LLM part does not require tuning. Instead, it directly employs pre-trained LLMs (such as GPT-4 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib1" title="">1</a>]</cite>) to generate explanation information. The primary technology improvements of different key components in our framework are as follows:</p>
</div>
<div class="ltx_para" id="S1.p6">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">Design of the Explainable Framework</span>: We design a model-agnostic and efficient explainable recommendation framework that uses large language models to generate highly explainable personalized recommendation statements.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">Capturing Users’ Multi-Preferences</span>: We utilize the excellent in-context learning (ICL) ability of LLMs and have meticulously designed a zero-shot prompt template for extracting users’ multi-preferences. This template guides LLMs to capture the Multi-Preferences inherent in the users’ historical interaction sequences without providing any examples.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">Preference Semantic Alignment</span>: We propose an attention-based learning strategy to align the reasoning logic of LLM explainer and recommender, which automatically selects the consistent and reasonable user’s preference.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i4.p1.1.1">Generation of Personalized Recommendation Texts</span>: To ensure that the generated recommendation results have clearer explainability, we designed a Chain of Thought (CoT) prompt template. This template enhances the reasoning process of LLMs to improve the quality of text generation. It guides LLMs step-by-step, analyzing the origins of multiple user preferences, the characteristics of recommended items, their alignment with user preferences, and the generation of personalized recommendation texts.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">We introduced related representative studies concisely in this section.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Explainable Recommendation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">In the field of recommendation systems, explainable recommendation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib57" title="">57</a>]</cite> has become an important research direction. Explainable recommendation systems refer to systems that not only provide personalized recommendations but also explain the reasons and logic behind the recommendations, enabling users to understand how recommendations are made.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">In general, explainable recommendation systems could be divided into two major categories. The first category is embedded explainable recommendation systems, which can be further subdivided into several subclasses based on the methods they employ, including factorization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib58" title="">58</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib44" title="">44</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib6" title="">6</a>]</cite>, topic modeling <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib39" title="">39</a>]</cite>, graph <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib49" title="">49</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib54" title="">54</a>]</cite>, knowledge graph <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib56" title="">56</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib33" title="">33</a>]</cite>, and other deep learning ways <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib3" title="">3</a>]</cite>. The other category is post-hoc explainable recommendation systems, which primarily rely on rules, retrieval, or generation models to generate explanations. For example, Peake et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib36" title="">36</a>]</cite> proposed an association rule mining method to implement post-hoc explainable recommendations. Singh et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib41" title="">41</a>]</cite> investigated post-hoc explanations using a learning-to-rank algorithm based on web search. Wang et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib48" title="">48</a>]</cite> introduced a model-agnostic reinforcement learning framework that can generate sentence explanations for any recommendation model.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Prompting LLMs For Recommendation</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Current research utilizing LLMs for recommendations can be broadly categorized into three paradigms <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib55" title="">55</a>]</cite>: pre-training, fine-tuning, and prompting. The prompting paradigm, being the most recent, adapts LLMs to specific downstream tasks (such as Top-N recommendation and explainable recommendation) through prompts. This paradigm includes three representative methods: in-context learning, prompt tuning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib28" title="">28</a>]</cite>, and instruction tuning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib53" title="">53</a>]</cite>. Our research falls under the in-context learning method within the prompting paradigm, which allows LLMs to perform recommendation tasks without any fine-tuning.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">Increasingly, advanced techniques like In-context Learning (ICL) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib37" title="">37</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib11" title="">11</a>]</cite> and Chain of Thought (CoT) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib51" title="">51</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib27" title="">27</a>]</cite> are being explored to manually design prompts for various recommendation tasks. For example, He et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib20" title="">20</a>]</cite> proposed leveraging LLMs as zero-shot conversational recommender systems (CRS) and introduced numerous exploratory tasks to investigate the mechanisms underlying the remarkable performance of LLMs in conversational recommendations. Liu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib30" title="">30</a>]</cite> evaluated the performance of ChatGPT on various recommendation tasks by performing ICL on corresponding input-output examples for each task, without fine-tuning. InteRecAgent <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib24" title="">24</a>]</cite> and RecMind <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib50" title="">50</a>]</cite> employing CoT prompts, enable LLMs to act as agents, handling complex recommendation tasks.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Problem Statement</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.15">This paper primarily focuses on the prevalent task of sequential recommendation and conducts research based on this task. In the setup of our explainable sequential recommendation problem, we assume a user set <math alttext="U=\{u_{1},u_{2},...,u_{|U|}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.5"><semantics id="S3.SS1.p1.1.m1.5a"><mrow id="S3.SS1.p1.1.m1.5.5" xref="S3.SS1.p1.1.m1.5.5.cmml"><mi id="S3.SS1.p1.1.m1.5.5.5" xref="S3.SS1.p1.1.m1.5.5.5.cmml">U</mi><mo id="S3.SS1.p1.1.m1.5.5.4" xref="S3.SS1.p1.1.m1.5.5.4.cmml">=</mo><mrow id="S3.SS1.p1.1.m1.5.5.3.3" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml"><mo id="S3.SS1.p1.1.m1.5.5.3.3.4" stretchy="false" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">{</mo><msub id="S3.SS1.p1.1.m1.3.3.1.1.1" xref="S3.SS1.p1.1.m1.3.3.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.3.3.1.1.1.2" xref="S3.SS1.p1.1.m1.3.3.1.1.1.2.cmml">u</mi><mn id="S3.SS1.p1.1.m1.3.3.1.1.1.3" xref="S3.SS1.p1.1.m1.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.1.m1.5.5.3.3.5" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">,</mo><msub id="S3.SS1.p1.1.m1.4.4.2.2.2" xref="S3.SS1.p1.1.m1.4.4.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.4.4.2.2.2.2" xref="S3.SS1.p1.1.m1.4.4.2.2.2.2.cmml">u</mi><mn id="S3.SS1.p1.1.m1.4.4.2.2.2.3" xref="S3.SS1.p1.1.m1.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.1.m1.5.5.3.3.6" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">,</mo><mi id="S3.SS1.p1.1.m1.2.2" mathvariant="normal" xref="S3.SS1.p1.1.m1.2.2.cmml">…</mi><mo id="S3.SS1.p1.1.m1.5.5.3.3.7" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">,</mo><msub id="S3.SS1.p1.1.m1.5.5.3.3.3" xref="S3.SS1.p1.1.m1.5.5.3.3.3.cmml"><mi id="S3.SS1.p1.1.m1.5.5.3.3.3.2" xref="S3.SS1.p1.1.m1.5.5.3.3.3.2.cmml">u</mi><mrow id="S3.SS1.p1.1.m1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.2.cmml"><mo id="S3.SS1.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.1.m1.1.1.1.2.1.cmml">|</mo><mi id="S3.SS1.p1.1.m1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.cmml">U</mi><mo id="S3.SS1.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S3.SS1.p1.1.m1.5.5.3.3.8" stretchy="false" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.5b"><apply id="S3.SS1.p1.1.m1.5.5.cmml" xref="S3.SS1.p1.1.m1.5.5"><eq id="S3.SS1.p1.1.m1.5.5.4.cmml" xref="S3.SS1.p1.1.m1.5.5.4"></eq><ci id="S3.SS1.p1.1.m1.5.5.5.cmml" xref="S3.SS1.p1.1.m1.5.5.5">𝑈</ci><set id="S3.SS1.p1.1.m1.5.5.3.4.cmml" xref="S3.SS1.p1.1.m1.5.5.3.3"><apply id="S3.SS1.p1.1.m1.3.3.1.1.1.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1.1.2">𝑢</ci><cn id="S3.SS1.p1.1.m1.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.3.3.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.1.m1.4.4.2.2.2.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.4.4.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.4.4.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2.2">𝑢</ci><cn id="S3.SS1.p1.1.m1.4.4.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.4.4.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.1.m1.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2">…</ci><apply id="S3.SS1.p1.1.m1.5.5.3.3.3.cmml" xref="S3.SS1.p1.1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.5.5.3.3.3.1.cmml" xref="S3.SS1.p1.1.m1.5.5.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.1.m1.5.5.3.3.3.2.cmml" xref="S3.SS1.p1.1.m1.5.5.3.3.3.2">𝑢</ci><apply id="S3.SS1.p1.1.m1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.3"><abs id="S3.SS1.p1.1.m1.1.1.1.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.3.1"></abs><ci id="S3.SS1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1">𝑈</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.5c">U=\{u_{1},u_{2},...,u_{|U|}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.5d">italic_U = { italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_u start_POSTSUBSCRIPT | italic_U | end_POSTSUBSCRIPT }</annotation></semantics></math> and an item set <math alttext="I=\{i_{1},i_{2},...,i_{|I|}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.5"><semantics id="S3.SS1.p1.2.m2.5a"><mrow id="S3.SS1.p1.2.m2.5.5" xref="S3.SS1.p1.2.m2.5.5.cmml"><mi id="S3.SS1.p1.2.m2.5.5.5" xref="S3.SS1.p1.2.m2.5.5.5.cmml">I</mi><mo id="S3.SS1.p1.2.m2.5.5.4" xref="S3.SS1.p1.2.m2.5.5.4.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.5.5.3.3" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml"><mo id="S3.SS1.p1.2.m2.5.5.3.3.4" stretchy="false" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">{</mo><msub id="S3.SS1.p1.2.m2.3.3.1.1.1" xref="S3.SS1.p1.2.m2.3.3.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.3.3.1.1.1.2" xref="S3.SS1.p1.2.m2.3.3.1.1.1.2.cmml">i</mi><mn id="S3.SS1.p1.2.m2.3.3.1.1.1.3" xref="S3.SS1.p1.2.m2.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m2.5.5.3.3.5" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.4.4.2.2.2" xref="S3.SS1.p1.2.m2.4.4.2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.4.4.2.2.2.2" xref="S3.SS1.p1.2.m2.4.4.2.2.2.2.cmml">i</mi><mn id="S3.SS1.p1.2.m2.4.4.2.2.2.3" xref="S3.SS1.p1.2.m2.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.2.m2.5.5.3.3.6" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">,</mo><mi id="S3.SS1.p1.2.m2.2.2" mathvariant="normal" xref="S3.SS1.p1.2.m2.2.2.cmml">…</mi><mo id="S3.SS1.p1.2.m2.5.5.3.3.7" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.5.5.3.3.3" xref="S3.SS1.p1.2.m2.5.5.3.3.3.cmml"><mi id="S3.SS1.p1.2.m2.5.5.3.3.3.2" xref="S3.SS1.p1.2.m2.5.5.3.3.3.2.cmml">i</mi><mrow id="S3.SS1.p1.2.m2.1.1.1.3" xref="S3.SS1.p1.2.m2.1.1.1.2.cmml"><mo id="S3.SS1.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.2.1.cmml">|</mo><mi id="S3.SS1.p1.2.m2.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.cmml">I</mi><mo id="S3.SS1.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S3.SS1.p1.2.m2.5.5.3.3.8" stretchy="false" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.5b"><apply id="S3.SS1.p1.2.m2.5.5.cmml" xref="S3.SS1.p1.2.m2.5.5"><eq id="S3.SS1.p1.2.m2.5.5.4.cmml" xref="S3.SS1.p1.2.m2.5.5.4"></eq><ci id="S3.SS1.p1.2.m2.5.5.5.cmml" xref="S3.SS1.p1.2.m2.5.5.5">𝐼</ci><set id="S3.SS1.p1.2.m2.5.5.3.4.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3"><apply id="S3.SS1.p1.2.m2.3.3.1.1.1.cmml" xref="S3.SS1.p1.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.3.3.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.3.3.1.1.1.2">𝑖</ci><cn id="S3.SS1.p1.2.m2.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.3.3.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.2.m2.4.4.2.2.2.cmml" xref="S3.SS1.p1.2.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.4.4.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.4.4.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.4.4.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.4.4.2.2.2.2">𝑖</ci><cn id="S3.SS1.p1.2.m2.4.4.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.4.4.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.2.m2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2">…</ci><apply id="S3.SS1.p1.2.m2.5.5.3.3.3.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.3.3.3.1.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.5.5.3.3.3.2.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3.3.2">𝑖</ci><apply id="S3.SS1.p1.2.m2.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3"><abs id="S3.SS1.p1.2.m2.1.1.1.2.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3.1"></abs><ci id="S3.SS1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1">𝐼</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.5c">I=\{i_{1},i_{2},...,i_{|I|}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.5d">italic_I = { italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_i start_POSTSUBSCRIPT | italic_I | end_POSTSUBSCRIPT }</annotation></semantics></math>, where <math alttext="|U|" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.2.2" xref="S3.SS1.p1.3.m3.1.2.1.cmml"><mo id="S3.SS1.p1.3.m3.1.2.2.1" stretchy="false" xref="S3.SS1.p1.3.m3.1.2.1.1.cmml">|</mo><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">U</mi><mo id="S3.SS1.p1.3.m3.1.2.2.2" stretchy="false" xref="S3.SS1.p1.3.m3.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.2.2"><abs id="S3.SS1.p1.3.m3.1.2.1.1.cmml" xref="S3.SS1.p1.3.m3.1.2.2.1"></abs><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">|U|</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">| italic_U |</annotation></semantics></math> and <math alttext="|I|" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mrow id="S3.SS1.p1.4.m4.1.2.2" xref="S3.SS1.p1.4.m4.1.2.1.cmml"><mo id="S3.SS1.p1.4.m4.1.2.2.1" stretchy="false" xref="S3.SS1.p1.4.m4.1.2.1.1.cmml">|</mo><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">I</mi><mo id="S3.SS1.p1.4.m4.1.2.2.2" stretchy="false" xref="S3.SS1.p1.4.m4.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.2.1.cmml" xref="S3.SS1.p1.4.m4.1.2.2"><abs id="S3.SS1.p1.4.m4.1.2.1.1.cmml" xref="S3.SS1.p1.4.m4.1.2.2.1"></abs><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">|I|</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">| italic_I |</annotation></semantics></math> represent the number of users and items, respectively. Given the historical interaction sequence <math alttext="S^{u}=\{S_{1}^{u},S_{1}^{u},...,S_{|S^{u}|}^{u}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.5"><semantics id="S3.SS1.p1.5.m5.5a"><mrow id="S3.SS1.p1.5.m5.5.5" xref="S3.SS1.p1.5.m5.5.5.cmml"><msup id="S3.SS1.p1.5.m5.5.5.5" xref="S3.SS1.p1.5.m5.5.5.5.cmml"><mi id="S3.SS1.p1.5.m5.5.5.5.2" xref="S3.SS1.p1.5.m5.5.5.5.2.cmml">S</mi><mi id="S3.SS1.p1.5.m5.5.5.5.3" xref="S3.SS1.p1.5.m5.5.5.5.3.cmml">u</mi></msup><mo id="S3.SS1.p1.5.m5.5.5.4" xref="S3.SS1.p1.5.m5.5.5.4.cmml">=</mo><mrow id="S3.SS1.p1.5.m5.5.5.3.3" xref="S3.SS1.p1.5.m5.5.5.3.4.cmml"><mo id="S3.SS1.p1.5.m5.5.5.3.3.4" stretchy="false" xref="S3.SS1.p1.5.m5.5.5.3.4.cmml">{</mo><msubsup id="S3.SS1.p1.5.m5.3.3.1.1.1" xref="S3.SS1.p1.5.m5.3.3.1.1.1.cmml"><mi id="S3.SS1.p1.5.m5.3.3.1.1.1.2.2" xref="S3.SS1.p1.5.m5.3.3.1.1.1.2.2.cmml">S</mi><mn id="S3.SS1.p1.5.m5.3.3.1.1.1.2.3" xref="S3.SS1.p1.5.m5.3.3.1.1.1.2.3.cmml">1</mn><mi id="S3.SS1.p1.5.m5.3.3.1.1.1.3" xref="S3.SS1.p1.5.m5.3.3.1.1.1.3.cmml">u</mi></msubsup><mo id="S3.SS1.p1.5.m5.5.5.3.3.5" xref="S3.SS1.p1.5.m5.5.5.3.4.cmml">,</mo><msubsup id="S3.SS1.p1.5.m5.4.4.2.2.2" xref="S3.SS1.p1.5.m5.4.4.2.2.2.cmml"><mi id="S3.SS1.p1.5.m5.4.4.2.2.2.2.2" xref="S3.SS1.p1.5.m5.4.4.2.2.2.2.2.cmml">S</mi><mn id="S3.SS1.p1.5.m5.4.4.2.2.2.2.3" xref="S3.SS1.p1.5.m5.4.4.2.2.2.2.3.cmml">1</mn><mi id="S3.SS1.p1.5.m5.4.4.2.2.2.3" xref="S3.SS1.p1.5.m5.4.4.2.2.2.3.cmml">u</mi></msubsup><mo id="S3.SS1.p1.5.m5.5.5.3.3.6" xref="S3.SS1.p1.5.m5.5.5.3.4.cmml">,</mo><mi id="S3.SS1.p1.5.m5.2.2" mathvariant="normal" xref="S3.SS1.p1.5.m5.2.2.cmml">…</mi><mo id="S3.SS1.p1.5.m5.5.5.3.3.7" xref="S3.SS1.p1.5.m5.5.5.3.4.cmml">,</mo><msubsup id="S3.SS1.p1.5.m5.5.5.3.3.3" xref="S3.SS1.p1.5.m5.5.5.3.3.3.cmml"><mi id="S3.SS1.p1.5.m5.5.5.3.3.3.2.2" xref="S3.SS1.p1.5.m5.5.5.3.3.3.2.2.cmml">S</mi><mrow id="S3.SS1.p1.5.m5.1.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.2.cmml"><mo id="S3.SS1.p1.5.m5.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.5.m5.1.1.1.2.1.cmml">|</mo><msup id="S3.SS1.p1.5.m5.1.1.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.1.1.1.2" xref="S3.SS1.p1.5.m5.1.1.1.1.1.2.cmml">S</mi><mi id="S3.SS1.p1.5.m5.1.1.1.1.1.3" xref="S3.SS1.p1.5.m5.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S3.SS1.p1.5.m5.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.5.m5.1.1.1.2.1.cmml">|</mo></mrow><mi id="S3.SS1.p1.5.m5.5.5.3.3.3.3" xref="S3.SS1.p1.5.m5.5.5.3.3.3.3.cmml">u</mi></msubsup><mo id="S3.SS1.p1.5.m5.5.5.3.3.8" stretchy="false" xref="S3.SS1.p1.5.m5.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.5b"><apply id="S3.SS1.p1.5.m5.5.5.cmml" xref="S3.SS1.p1.5.m5.5.5"><eq id="S3.SS1.p1.5.m5.5.5.4.cmml" xref="S3.SS1.p1.5.m5.5.5.4"></eq><apply id="S3.SS1.p1.5.m5.5.5.5.cmml" xref="S3.SS1.p1.5.m5.5.5.5"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.5.5.5.1.cmml" xref="S3.SS1.p1.5.m5.5.5.5">superscript</csymbol><ci id="S3.SS1.p1.5.m5.5.5.5.2.cmml" xref="S3.SS1.p1.5.m5.5.5.5.2">𝑆</ci><ci id="S3.SS1.p1.5.m5.5.5.5.3.cmml" xref="S3.SS1.p1.5.m5.5.5.5.3">𝑢</ci></apply><set id="S3.SS1.p1.5.m5.5.5.3.4.cmml" xref="S3.SS1.p1.5.m5.5.5.3.3"><apply id="S3.SS1.p1.5.m5.3.3.1.1.1.cmml" xref="S3.SS1.p1.5.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.3.3.1.1.1">superscript</csymbol><apply id="S3.SS1.p1.5.m5.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.5.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.3.3.1.1.1.2.1.cmml" xref="S3.SS1.p1.5.m5.3.3.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.3.3.1.1.1.2.2.cmml" xref="S3.SS1.p1.5.m5.3.3.1.1.1.2.2">𝑆</ci><cn id="S3.SS1.p1.5.m5.3.3.1.1.1.2.3.cmml" type="integer" xref="S3.SS1.p1.5.m5.3.3.1.1.1.2.3">1</cn></apply><ci id="S3.SS1.p1.5.m5.3.3.1.1.1.3.cmml" xref="S3.SS1.p1.5.m5.3.3.1.1.1.3">𝑢</ci></apply><apply id="S3.SS1.p1.5.m5.4.4.2.2.2.cmml" xref="S3.SS1.p1.5.m5.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.4.4.2.2.2.1.cmml" xref="S3.SS1.p1.5.m5.4.4.2.2.2">superscript</csymbol><apply id="S3.SS1.p1.5.m5.4.4.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.4.4.2.2.2.2.1.cmml" xref="S3.SS1.p1.5.m5.4.4.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.5.m5.4.4.2.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.4.4.2.2.2.2.2">𝑆</ci><cn id="S3.SS1.p1.5.m5.4.4.2.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.5.m5.4.4.2.2.2.2.3">1</cn></apply><ci id="S3.SS1.p1.5.m5.4.4.2.2.2.3.cmml" xref="S3.SS1.p1.5.m5.4.4.2.2.2.3">𝑢</ci></apply><ci id="S3.SS1.p1.5.m5.2.2.cmml" xref="S3.SS1.p1.5.m5.2.2">…</ci><apply id="S3.SS1.p1.5.m5.5.5.3.3.3.cmml" xref="S3.SS1.p1.5.m5.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.5.5.3.3.3.1.cmml" xref="S3.SS1.p1.5.m5.5.5.3.3.3">superscript</csymbol><apply id="S3.SS1.p1.5.m5.5.5.3.3.3.2.cmml" xref="S3.SS1.p1.5.m5.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.5.5.3.3.3.2.1.cmml" xref="S3.SS1.p1.5.m5.5.5.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.5.m5.5.5.3.3.3.2.2.cmml" xref="S3.SS1.p1.5.m5.5.5.3.3.3.2.2">𝑆</ci><apply id="S3.SS1.p1.5.m5.1.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1"><abs id="S3.SS1.p1.5.m5.1.1.1.2.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.2"></abs><apply id="S3.SS1.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.1.2">𝑆</ci><ci id="S3.SS1.p1.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.1.3">𝑢</ci></apply></apply></apply><ci id="S3.SS1.p1.5.m5.5.5.3.3.3.3.cmml" xref="S3.SS1.p1.5.m5.5.5.3.3.3.3">𝑢</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.5c">S^{u}=\{S_{1}^{u},S_{1}^{u},...,S_{|S^{u}|}^{u}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.5d">italic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = { italic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , italic_S start_POSTSUBSCRIPT | italic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT }</annotation></semantics></math> for user <math alttext="u\in U" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">u</mi><mo id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml">∈</mo><mi id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">U</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><in id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1"></in><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝑢</ci><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">𝑈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">u\in U</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_u ∈ italic_U</annotation></semantics></math>, where <math alttext="S_{t}^{u}\in I" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mrow id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><msubsup id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2.2.2" xref="S3.SS1.p1.7.m7.1.1.2.2.2.cmml">S</mi><mi id="S3.SS1.p1.7.m7.1.1.2.2.3" xref="S3.SS1.p1.7.m7.1.1.2.2.3.cmml">t</mi><mi id="S3.SS1.p1.7.m7.1.1.2.3" xref="S3.SS1.p1.7.m7.1.1.2.3.cmml">u</mi></msubsup><mo id="S3.SS1.p1.7.m7.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.cmml">∈</mo><mi id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><in id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1"></in><apply id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.2.1.cmml" xref="S3.SS1.p1.7.m7.1.1.2">superscript</csymbol><apply id="S3.SS1.p1.7.m7.1.1.2.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.2.2.1.cmml" xref="S3.SS1.p1.7.m7.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.2.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2.2.2">𝑆</ci><ci id="S3.SS1.p1.7.m7.1.1.2.2.3.cmml" xref="S3.SS1.p1.7.m7.1.1.2.2.3">𝑡</ci></apply><ci id="S3.SS1.p1.7.m7.1.1.2.3.cmml" xref="S3.SS1.p1.7.m7.1.1.2.3">𝑢</ci></apply><ci id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">S_{t}^{u}\in I</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∈ italic_I</annotation></semantics></math> denotes the interacted item by user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">italic_u</annotation></semantics></math> at time step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">italic_t</annotation></semantics></math>, and <math alttext="|S^{u}|" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><mrow id="S3.SS1.p1.10.m10.1.1.1" xref="S3.SS1.p1.10.m10.1.1.2.cmml"><mo id="S3.SS1.p1.10.m10.1.1.1.2" stretchy="false" xref="S3.SS1.p1.10.m10.1.1.2.1.cmml">|</mo><msup id="S3.SS1.p1.10.m10.1.1.1.1" xref="S3.SS1.p1.10.m10.1.1.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.1.1.2" xref="S3.SS1.p1.10.m10.1.1.1.1.2.cmml">S</mi><mi id="S3.SS1.p1.10.m10.1.1.1.1.3" xref="S3.SS1.p1.10.m10.1.1.1.1.3.cmml">u</mi></msup><mo id="S3.SS1.p1.10.m10.1.1.1.3" stretchy="false" xref="S3.SS1.p1.10.m10.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.1"><abs id="S3.SS1.p1.10.m10.1.1.2.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1.2"></abs><apply id="S3.SS1.p1.10.m10.1.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.2">𝑆</ci><ci id="S3.SS1.p1.10.m10.1.1.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">|S^{u}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">| italic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT |</annotation></semantics></math> denotes the length of the sequence. We aim to take the sequence <math alttext="\{S_{1}^{u},S_{1}^{u},...,S_{(|S^{u}|-1)}^{u}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.5"><semantics id="S3.SS1.p1.11.m11.5a"><mrow id="S3.SS1.p1.11.m11.5.5.3" xref="S3.SS1.p1.11.m11.5.5.4.cmml"><mo id="S3.SS1.p1.11.m11.5.5.3.4" stretchy="false" xref="S3.SS1.p1.11.m11.5.5.4.cmml">{</mo><msubsup id="S3.SS1.p1.11.m11.3.3.1.1" xref="S3.SS1.p1.11.m11.3.3.1.1.cmml"><mi id="S3.SS1.p1.11.m11.3.3.1.1.2.2" xref="S3.SS1.p1.11.m11.3.3.1.1.2.2.cmml">S</mi><mn id="S3.SS1.p1.11.m11.3.3.1.1.2.3" xref="S3.SS1.p1.11.m11.3.3.1.1.2.3.cmml">1</mn><mi id="S3.SS1.p1.11.m11.3.3.1.1.3" xref="S3.SS1.p1.11.m11.3.3.1.1.3.cmml">u</mi></msubsup><mo id="S3.SS1.p1.11.m11.5.5.3.5" xref="S3.SS1.p1.11.m11.5.5.4.cmml">,</mo><msubsup id="S3.SS1.p1.11.m11.4.4.2.2" xref="S3.SS1.p1.11.m11.4.4.2.2.cmml"><mi id="S3.SS1.p1.11.m11.4.4.2.2.2.2" xref="S3.SS1.p1.11.m11.4.4.2.2.2.2.cmml">S</mi><mn id="S3.SS1.p1.11.m11.4.4.2.2.2.3" xref="S3.SS1.p1.11.m11.4.4.2.2.2.3.cmml">1</mn><mi id="S3.SS1.p1.11.m11.4.4.2.2.3" xref="S3.SS1.p1.11.m11.4.4.2.2.3.cmml">u</mi></msubsup><mo id="S3.SS1.p1.11.m11.5.5.3.6" xref="S3.SS1.p1.11.m11.5.5.4.cmml">,</mo><mi id="S3.SS1.p1.11.m11.2.2" mathvariant="normal" xref="S3.SS1.p1.11.m11.2.2.cmml">…</mi><mo id="S3.SS1.p1.11.m11.5.5.3.7" xref="S3.SS1.p1.11.m11.5.5.4.cmml">,</mo><msubsup id="S3.SS1.p1.11.m11.5.5.3.3" xref="S3.SS1.p1.11.m11.5.5.3.3.cmml"><mi id="S3.SS1.p1.11.m11.5.5.3.3.2.2" xref="S3.SS1.p1.11.m11.5.5.3.3.2.2.cmml">S</mi><mrow id="S3.SS1.p1.11.m11.1.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.11.m11.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.11.m11.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.11.m11.1.1.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.1.1.cmml"><mrow id="S3.SS1.p1.11.m11.1.1.1.1.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.cmml"><mo id="S3.SS1.p1.11.m11.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.1.cmml">|</mo><msup id="S3.SS1.p1.11.m11.1.1.1.1.1.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.11.m11.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.1.1.2.cmml">S</mi><mi id="S3.SS1.p1.11.m11.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S3.SS1.p1.11.m11.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.SS1.p1.11.m11.1.1.1.1.1.2" xref="S3.SS1.p1.11.m11.1.1.1.1.1.2.cmml">−</mo><mn id="S3.SS1.p1.11.m11.1.1.1.1.1.3" xref="S3.SS1.p1.11.m11.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.p1.11.m11.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.11.m11.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.SS1.p1.11.m11.5.5.3.3.3" xref="S3.SS1.p1.11.m11.5.5.3.3.3.cmml">u</mi></msubsup><mo id="S3.SS1.p1.11.m11.5.5.3.8" stretchy="false" xref="S3.SS1.p1.11.m11.5.5.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.5b"><set id="S3.SS1.p1.11.m11.5.5.4.cmml" xref="S3.SS1.p1.11.m11.5.5.3"><apply id="S3.SS1.p1.11.m11.3.3.1.1.cmml" xref="S3.SS1.p1.11.m11.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.3.3.1.1.1.cmml" xref="S3.SS1.p1.11.m11.3.3.1.1">superscript</csymbol><apply id="S3.SS1.p1.11.m11.3.3.1.1.2.cmml" xref="S3.SS1.p1.11.m11.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.3.3.1.1.2.1.cmml" xref="S3.SS1.p1.11.m11.3.3.1.1">subscript</csymbol><ci id="S3.SS1.p1.11.m11.3.3.1.1.2.2.cmml" xref="S3.SS1.p1.11.m11.3.3.1.1.2.2">𝑆</ci><cn id="S3.SS1.p1.11.m11.3.3.1.1.2.3.cmml" type="integer" xref="S3.SS1.p1.11.m11.3.3.1.1.2.3">1</cn></apply><ci id="S3.SS1.p1.11.m11.3.3.1.1.3.cmml" xref="S3.SS1.p1.11.m11.3.3.1.1.3">𝑢</ci></apply><apply id="S3.SS1.p1.11.m11.4.4.2.2.cmml" xref="S3.SS1.p1.11.m11.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.4.4.2.2.1.cmml" xref="S3.SS1.p1.11.m11.4.4.2.2">superscript</csymbol><apply id="S3.SS1.p1.11.m11.4.4.2.2.2.cmml" xref="S3.SS1.p1.11.m11.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.4.4.2.2.2.1.cmml" xref="S3.SS1.p1.11.m11.4.4.2.2">subscript</csymbol><ci id="S3.SS1.p1.11.m11.4.4.2.2.2.2.cmml" xref="S3.SS1.p1.11.m11.4.4.2.2.2.2">𝑆</ci><cn id="S3.SS1.p1.11.m11.4.4.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.11.m11.4.4.2.2.2.3">1</cn></apply><ci id="S3.SS1.p1.11.m11.4.4.2.2.3.cmml" xref="S3.SS1.p1.11.m11.4.4.2.2.3">𝑢</ci></apply><ci id="S3.SS1.p1.11.m11.2.2.cmml" xref="S3.SS1.p1.11.m11.2.2">…</ci><apply id="S3.SS1.p1.11.m11.5.5.3.3.cmml" xref="S3.SS1.p1.11.m11.5.5.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.5.5.3.3.1.cmml" xref="S3.SS1.p1.11.m11.5.5.3.3">superscript</csymbol><apply id="S3.SS1.p1.11.m11.5.5.3.3.2.cmml" xref="S3.SS1.p1.11.m11.5.5.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.5.5.3.3.2.1.cmml" xref="S3.SS1.p1.11.m11.5.5.3.3">subscript</csymbol><ci id="S3.SS1.p1.11.m11.5.5.3.3.2.2.cmml" xref="S3.SS1.p1.11.m11.5.5.3.3.2.2">𝑆</ci><apply id="S3.SS1.p1.11.m11.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1"><minus id="S3.SS1.p1.11.m11.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.2"></minus><apply id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.1"><abs id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.1.2"></abs><apply id="S3.SS1.p1.11.m11.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.1.1.2">𝑆</ci><ci id="S3.SS1.p1.11.m11.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.1.1.3">𝑢</ci></apply></apply><cn id="S3.SS1.p1.11.m11.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.11.m11.1.1.1.1.1.3">1</cn></apply></apply><ci id="S3.SS1.p1.11.m11.5.5.3.3.3.cmml" xref="S3.SS1.p1.11.m11.5.5.3.3.3">𝑢</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.5c">\{S_{1}^{u},S_{1}^{u},...,S_{(|S^{u}|-1)}^{u}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.5d">{ italic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , italic_S start_POSTSUBSCRIPT ( | italic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | - 1 ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT }</annotation></semantics></math> as input to predict the next interaction item <math alttext="S_{|S^{u}|}^{u}" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.1"><semantics id="S3.SS1.p1.12.m12.1a"><msubsup id="S3.SS1.p1.12.m12.1.2" xref="S3.SS1.p1.12.m12.1.2.cmml"><mi id="S3.SS1.p1.12.m12.1.2.2.2" xref="S3.SS1.p1.12.m12.1.2.2.2.cmml">S</mi><mrow id="S3.SS1.p1.12.m12.1.1.1.1" xref="S3.SS1.p1.12.m12.1.1.1.2.cmml"><mo id="S3.SS1.p1.12.m12.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.12.m12.1.1.1.2.1.cmml">|</mo><msup id="S3.SS1.p1.12.m12.1.1.1.1.1" xref="S3.SS1.p1.12.m12.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.12.m12.1.1.1.1.1.2" xref="S3.SS1.p1.12.m12.1.1.1.1.1.2.cmml">S</mi><mi id="S3.SS1.p1.12.m12.1.1.1.1.1.3" xref="S3.SS1.p1.12.m12.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S3.SS1.p1.12.m12.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.12.m12.1.1.1.2.1.cmml">|</mo></mrow><mi id="S3.SS1.p1.12.m12.1.2.3" xref="S3.SS1.p1.12.m12.1.2.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.2.cmml" xref="S3.SS1.p1.12.m12.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.2.1.cmml" xref="S3.SS1.p1.12.m12.1.2">superscript</csymbol><apply id="S3.SS1.p1.12.m12.1.2.2.cmml" xref="S3.SS1.p1.12.m12.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.2.2.1.cmml" xref="S3.SS1.p1.12.m12.1.2">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.2.2.2.cmml" xref="S3.SS1.p1.12.m12.1.2.2.2">𝑆</ci><apply id="S3.SS1.p1.12.m12.1.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.1.1"><abs id="S3.SS1.p1.12.m12.1.1.1.2.1.cmml" xref="S3.SS1.p1.12.m12.1.1.1.1.2"></abs><apply id="S3.SS1.p1.12.m12.1.1.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.1.1.1.2">𝑆</ci><ci id="S3.SS1.p1.12.m12.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.1.1.1.3">𝑢</ci></apply></apply></apply><ci id="S3.SS1.p1.12.m12.1.2.3.cmml" xref="S3.SS1.p1.12.m12.1.2.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">S_{|S^{u}|}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.1d">italic_S start_POSTSUBSCRIPT | italic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> for user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m13.1"><semantics id="S3.SS1.p1.13.m13.1a"><mi id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><ci id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m13.1d">italic_u</annotation></semantics></math>, and generate personalized explainable reason <math alttext="\text{Explanation}^{u}" class="ltx_Math" display="inline" id="S3.SS1.p1.14.m14.1"><semantics id="S3.SS1.p1.14.m14.1a"><msup id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml"><mtext id="S3.SS1.p1.14.m14.1.1.2" xref="S3.SS1.p1.14.m14.1.1.2a.cmml">Explanation</mtext><mi id="S3.SS1.p1.14.m14.1.1.3" xref="S3.SS1.p1.14.m14.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b"><apply id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1">superscript</csymbol><ci id="S3.SS1.p1.14.m14.1.1.2a.cmml" xref="S3.SS1.p1.14.m14.1.1.2"><mtext id="S3.SS1.p1.14.m14.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.2">Explanation</mtext></ci><ci id="S3.SS1.p1.14.m14.1.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">\text{Explanation}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.14.m14.1d">Explanation start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> about <math alttext="S_{|S^{u}|}^{u}" class="ltx_Math" display="inline" id="S3.SS1.p1.15.m15.1"><semantics id="S3.SS1.p1.15.m15.1a"><msubsup id="S3.SS1.p1.15.m15.1.2" xref="S3.SS1.p1.15.m15.1.2.cmml"><mi id="S3.SS1.p1.15.m15.1.2.2.2" xref="S3.SS1.p1.15.m15.1.2.2.2.cmml">S</mi><mrow id="S3.SS1.p1.15.m15.1.1.1.1" xref="S3.SS1.p1.15.m15.1.1.1.2.cmml"><mo id="S3.SS1.p1.15.m15.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.15.m15.1.1.1.2.1.cmml">|</mo><msup id="S3.SS1.p1.15.m15.1.1.1.1.1" xref="S3.SS1.p1.15.m15.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.15.m15.1.1.1.1.1.2" xref="S3.SS1.p1.15.m15.1.1.1.1.1.2.cmml">S</mi><mi id="S3.SS1.p1.15.m15.1.1.1.1.1.3" xref="S3.SS1.p1.15.m15.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S3.SS1.p1.15.m15.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.15.m15.1.1.1.2.1.cmml">|</mo></mrow><mi id="S3.SS1.p1.15.m15.1.2.3" xref="S3.SS1.p1.15.m15.1.2.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b"><apply id="S3.SS1.p1.15.m15.1.2.cmml" xref="S3.SS1.p1.15.m15.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.2.1.cmml" xref="S3.SS1.p1.15.m15.1.2">superscript</csymbol><apply id="S3.SS1.p1.15.m15.1.2.2.cmml" xref="S3.SS1.p1.15.m15.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.2.2.1.cmml" xref="S3.SS1.p1.15.m15.1.2">subscript</csymbol><ci id="S3.SS1.p1.15.m15.1.2.2.2.cmml" xref="S3.SS1.p1.15.m15.1.2.2.2">𝑆</ci><apply id="S3.SS1.p1.15.m15.1.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1"><abs id="S3.SS1.p1.15.m15.1.1.1.2.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.2"></abs><apply id="S3.SS1.p1.15.m15.1.1.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.15.m15.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.2">𝑆</ci><ci id="S3.SS1.p1.15.m15.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.3">𝑢</ci></apply></apply></apply><ci id="S3.SS1.p1.15.m15.1.2.3.cmml" xref="S3.SS1.p1.15.m15.1.2.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">S_{|S^{u}|}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.15.m15.1d">italic_S start_POSTSUBSCRIPT | italic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> to explain the prediction results.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>LANE</h3>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Overview</h4>
<figure class="ltx_figure" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="630" id="S3.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The overview of LANE. It consists of six crucial components: (I) semantic embedding module, (II) integrated model module, (III) users’ multi-preference generation module, (IV) semantic alignment module, (V) prediction module, and (VI) explainable recommendation generation module.</figcaption>
</figure>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.1">Our proposed explainable recommendation framework LANE is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S3.F1" title="Figure 1 ‣ 3.2.1 Overview ‣ 3.2 LANE ‣ 3 Methodology ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_tag">1</span></a>. The model acquires semantic embeddings of item titles using a text encoder and utilizes these embeddings to initialize the embedding layer of the integrated recommendation model. User interaction sequences are input into predefined prompt templates to guide the LLM in extracting Multi-Preferences, which are then semantically embedded using the same text encoder. A multi-head attention mechanism aligns the semantic features of user sequences with their Multi-Preferences. The aligned vectors and candidate item embeddings are then used to compute recommendation scores, resulting in the final item ranking. Additionally, the model generates explanation information for the recommendations by inputting the user interaction sequences, the previously obtained attention weights, and the multiple preferences into predefined prompt templates.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Semantic Embedding Module</h4>
<div class="ltx_para" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.2">Our proposed framework relies on the powerful language understanding and generation capabilities of large language model (LLM) for the explanation generation part of the recommendation results. To ensure that the users’ historical interaction sequence contains more semantic information and to facilitate the understanding of this sequence by the large model, unlike conventional ID-based recommendation models, our proposed model is text(title)-based. Hence, the user interaction sequence <math alttext="S^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.1.m1.1"><semantics id="S3.SS2.SSS2.p1.1.m1.1a"><msup id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.1.1.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml">S</mi><mi id="S3.SS2.SSS2.p1.1.m1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.1b"><apply id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.2">𝑆</ci><ci id="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.1c">S^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.1.m1.1d">italic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> we use is no longer a sequence sorted by item IDs but by item titles. As <math alttext="S^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.2.m2.1"><semantics id="S3.SS2.SSS2.p1.2.m2.1a"><msup id="S3.SS2.SSS2.p1.2.m2.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS2.p1.2.m2.1.1.2" xref="S3.SS2.SSS2.p1.2.m2.1.1.2.cmml">S</mi><mi id="S3.SS2.SSS2.p1.2.m2.1.1.3" xref="S3.SS2.SSS2.p1.2.m2.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.1b"><apply id="S3.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.2">𝑆</ci><ci id="S3.SS2.SSS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.1c">S^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.2.m2.1d">italic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> is a text sequence, we need to encode it while preserving its semantic information. Given the excellent performance of Sentence-bert in sentence embedding <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib38" title="">38</a>]</cite>, we choose it as the TextEncoder. By inputting all item titles into the TextEncoder, we capture an embedding matrix:</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{M}=\left[\begin{array}[]{c}\mathbf{m}_{1}\\
\mathbf{m}_{2}\\
\vdots\\
\mathbf{m}_{n}\end{array}\right]=\text{TextEncoder}\left(\left[\begin{array}[]%
{c}i_{1}\\
i_{2}\\
\vdots\\
i_{n}\end{array}\right]\right)," class="ltx_Math" display="block" id="S3.E1.m1.3"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml">𝐌</mi><mo id="S3.E1.m1.3.3.1.1.4" xref="S3.E1.m1.3.3.1.1.4.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.5.2" xref="S3.E1.m1.3.3.1.1.5.1.cmml"><mo id="S3.E1.m1.3.3.1.1.5.2.1" xref="S3.E1.m1.3.3.1.1.5.1.1.cmml">[</mo><mtable displaystyle="true" id="S3.E1.m1.1.1" rowspacing="0pt" xref="S3.E1.m1.1.1.cmml"><mtr id="S3.E1.m1.1.1a" xref="S3.E1.m1.1.1.cmml"><mtd id="S3.E1.m1.1.1b" xref="S3.E1.m1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">𝐦</mi><mn id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml">1</mn></msub></mtd></mtr><mtr id="S3.E1.m1.1.1c" xref="S3.E1.m1.1.1.cmml"><mtd id="S3.E1.m1.1.1d" xref="S3.E1.m1.1.1.cmml"><msub id="S3.E1.m1.1.1.2.1.1" xref="S3.E1.m1.1.1.2.1.1.cmml"><mi id="S3.E1.m1.1.1.2.1.1.2" xref="S3.E1.m1.1.1.2.1.1.2.cmml">𝐦</mi><mn id="S3.E1.m1.1.1.2.1.1.3" xref="S3.E1.m1.1.1.2.1.1.3.cmml">2</mn></msub></mtd></mtr><mtr id="S3.E1.m1.1.1e" xref="S3.E1.m1.1.1.cmml"><mtd id="S3.E1.m1.1.1f" xref="S3.E1.m1.1.1.cmml"><mi id="S3.E1.m1.1.1.3.1.1" mathvariant="normal" xref="S3.E1.m1.1.1.3.1.1.cmml">⋮</mi></mtd></mtr><mtr id="S3.E1.m1.1.1g" xref="S3.E1.m1.1.1.cmml"><mtd id="S3.E1.m1.1.1h" xref="S3.E1.m1.1.1.cmml"><msub id="S3.E1.m1.1.1.4.1.1" xref="S3.E1.m1.1.1.4.1.1.cmml"><mi id="S3.E1.m1.1.1.4.1.1.2" xref="S3.E1.m1.1.1.4.1.1.2.cmml">𝐦</mi><mi id="S3.E1.m1.1.1.4.1.1.3" xref="S3.E1.m1.1.1.4.1.1.3.cmml">n</mi></msub></mtd></mtr></mtable><mo id="S3.E1.m1.3.3.1.1.5.2.2" xref="S3.E1.m1.3.3.1.1.5.1.1.cmml">]</mo></mrow><mo id="S3.E1.m1.3.3.1.1.6" xref="S3.E1.m1.3.3.1.1.6.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml"><mtext id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.3a.cmml">TextEncoder</mtext><mo id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml">[</mo><mtable displaystyle="true" id="S3.E1.m1.2.2" rowspacing="0pt" xref="S3.E1.m1.2.2.cmml"><mtr id="S3.E1.m1.2.2a" xref="S3.E1.m1.2.2.cmml"><mtd id="S3.E1.m1.2.2b" xref="S3.E1.m1.2.2.cmml"><msub id="S3.E1.m1.2.2.1.1.1" xref="S3.E1.m1.2.2.1.1.1.cmml"><mi id="S3.E1.m1.2.2.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.2.cmml">i</mi><mn id="S3.E1.m1.2.2.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.3.cmml">1</mn></msub></mtd></mtr><mtr id="S3.E1.m1.2.2c" xref="S3.E1.m1.2.2.cmml"><mtd id="S3.E1.m1.2.2d" xref="S3.E1.m1.2.2.cmml"><msub id="S3.E1.m1.2.2.2.1.1" xref="S3.E1.m1.2.2.2.1.1.cmml"><mi id="S3.E1.m1.2.2.2.1.1.2" xref="S3.E1.m1.2.2.2.1.1.2.cmml">i</mi><mn id="S3.E1.m1.2.2.2.1.1.3" xref="S3.E1.m1.2.2.2.1.1.3.cmml">2</mn></msub></mtd></mtr><mtr id="S3.E1.m1.2.2e" xref="S3.E1.m1.2.2.cmml"><mtd id="S3.E1.m1.2.2f" xref="S3.E1.m1.2.2.cmml"><mi id="S3.E1.m1.2.2.3.1.1" mathvariant="normal" xref="S3.E1.m1.2.2.3.1.1.cmml">⋮</mi></mtd></mtr><mtr id="S3.E1.m1.2.2g" xref="S3.E1.m1.2.2.cmml"><mtd id="S3.E1.m1.2.2h" xref="S3.E1.m1.2.2.cmml"><msub id="S3.E1.m1.2.2.4.1.1" xref="S3.E1.m1.2.2.4.1.1.cmml"><mi id="S3.E1.m1.2.2.4.1.1.2" xref="S3.E1.m1.2.2.4.1.1.2.cmml">i</mi><mi id="S3.E1.m1.2.2.4.1.1.3" xref="S3.E1.m1.2.2.4.1.1.3.cmml">n</mi></msub></mtd></mtr></mtable><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml">]</mo></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><and id="S3.E1.m1.3.3.1.1a.cmml" xref="S3.E1.m1.3.3.1"></and><apply id="S3.E1.m1.3.3.1.1b.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.4"></eq><ci id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3">𝐌</ci><apply id="S3.E1.m1.3.3.1.1.5.1.cmml" xref="S3.E1.m1.3.3.1.1.5.2"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.5.1.1.cmml" xref="S3.E1.m1.3.3.1.1.5.2.1">delimited-[]</csymbol><matrix id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><matrixrow id="S3.E1.m1.1.1a.cmml" xref="S3.E1.m1.1.1"><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2">𝐦</ci><cn id="S3.E1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.1.3">1</cn></apply></matrixrow><matrixrow id="S3.E1.m1.1.1b.cmml" xref="S3.E1.m1.1.1"><apply id="S3.E1.m1.1.1.2.1.1.cmml" xref="S3.E1.m1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.2.1.1.1.cmml" xref="S3.E1.m1.1.1.2.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.2.1.1.2.cmml" xref="S3.E1.m1.1.1.2.1.1.2">𝐦</ci><cn id="S3.E1.m1.1.1.2.1.1.3.cmml" type="integer" xref="S3.E1.m1.1.1.2.1.1.3">2</cn></apply></matrixrow><matrixrow id="S3.E1.m1.1.1c.cmml" xref="S3.E1.m1.1.1"><ci id="S3.E1.m1.1.1.3.1.1.cmml" xref="S3.E1.m1.1.1.3.1.1">⋮</ci></matrixrow><matrixrow id="S3.E1.m1.1.1d.cmml" xref="S3.E1.m1.1.1"><apply id="S3.E1.m1.1.1.4.1.1.cmml" xref="S3.E1.m1.1.1.4.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.4.1.1.1.cmml" xref="S3.E1.m1.1.1.4.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.4.1.1.2.cmml" xref="S3.E1.m1.1.1.4.1.1.2">𝐦</ci><ci id="S3.E1.m1.1.1.4.1.1.3.cmml" xref="S3.E1.m1.1.1.4.1.1.3">𝑛</ci></apply></matrixrow></matrix></apply></apply><apply id="S3.E1.m1.3.3.1.1c.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.6.cmml" xref="S3.E1.m1.3.3.1.1.6"></eq><share href="https://arxiv.org/html/2407.02833v1#S3.E1.m1.3.3.1.1.5.cmml" id="S3.E1.m1.3.3.1.1d.cmml" xref="S3.E1.m1.3.3.1"></share><apply id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2"></times><ci id="S3.E1.m1.3.3.1.1.1.3a.cmml" xref="S3.E1.m1.3.3.1.1.1.3"><mtext id="S3.E1.m1.3.3.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3">TextEncoder</mtext></ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1">delimited-[]</csymbol><matrix id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2"><matrixrow id="S3.E1.m1.2.2a.cmml" xref="S3.E1.m1.2.2"><apply id="S3.E1.m1.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.2">𝑖</ci><cn id="S3.E1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.2.2.1.1.1.3">1</cn></apply></matrixrow><matrixrow id="S3.E1.m1.2.2b.cmml" xref="S3.E1.m1.2.2"><apply id="S3.E1.m1.2.2.2.1.1.cmml" xref="S3.E1.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.2.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.2.1.1.2">𝑖</ci><cn id="S3.E1.m1.2.2.2.1.1.3.cmml" type="integer" xref="S3.E1.m1.2.2.2.1.1.3">2</cn></apply></matrixrow><matrixrow id="S3.E1.m1.2.2c.cmml" xref="S3.E1.m1.2.2"><ci id="S3.E1.m1.2.2.3.1.1.cmml" xref="S3.E1.m1.2.2.3.1.1">⋮</ci></matrixrow><matrixrow id="S3.E1.m1.2.2d.cmml" xref="S3.E1.m1.2.2"><apply id="S3.E1.m1.2.2.4.1.1.cmml" xref="S3.E1.m1.2.2.4.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.4.1.1.1.cmml" xref="S3.E1.m1.2.2.4.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.4.1.1.2.cmml" xref="S3.E1.m1.2.2.4.1.1.2">𝑖</ci><ci id="S3.E1.m1.2.2.4.1.1.3.cmml" xref="S3.E1.m1.2.2.4.1.1.3">𝑛</ci></apply></matrixrow></matrix></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\mathbf{M}=\left[\begin{array}[]{c}\mathbf{m}_{1}\\
\mathbf{m}_{2}\\
\vdots\\
\mathbf{m}_{n}\end{array}\right]=\text{TextEncoder}\left(\left[\begin{array}[]%
{c}i_{1}\\
i_{2}\\
\vdots\\
i_{n}\end{array}\right]\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.3d">bold_M = [ start_ARRAY start_ROW start_CELL bold_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL bold_m start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL ⋮ end_CELL end_ROW start_ROW start_CELL bold_m start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_CELL end_ROW end_ARRAY ] = TextEncoder ( [ start_ARRAY start_ROW start_CELL italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL ⋮ end_CELL end_ROW start_ROW start_CELL italic_i start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_CELL end_ROW end_ARRAY ] ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p3">
<p class="ltx_p" id="S3.SS2.SSS2.p3.18">where <math alttext="M\in\mathbb{R}^{|I|\times d}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.1.m1.1"><semantics id="S3.SS2.SSS2.p3.1.m1.1a"><mrow id="S3.SS2.SSS2.p3.1.m1.1.2" xref="S3.SS2.SSS2.p3.1.m1.1.2.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.1.2.2" xref="S3.SS2.SSS2.p3.1.m1.1.2.2.cmml">M</mi><mo id="S3.SS2.SSS2.p3.1.m1.1.2.1" xref="S3.SS2.SSS2.p3.1.m1.1.2.1.cmml">∈</mo><msup id="S3.SS2.SSS2.p3.1.m1.1.2.3" xref="S3.SS2.SSS2.p3.1.m1.1.2.3.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.1.2.3.2" xref="S3.SS2.SSS2.p3.1.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS2.p3.1.m1.1.1.1" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.cmml"><mrow id="S3.SS2.SSS2.p3.1.m1.1.1.1.3.2" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.3.1.cmml"><mo id="S3.SS2.SSS2.p3.1.m1.1.1.1.3.2.1" stretchy="false" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.3.1.1.cmml">|</mo><mi id="S3.SS2.SSS2.p3.1.m1.1.1.1.1" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.cmml">I</mi><mo id="S3.SS2.SSS2.p3.1.m1.1.1.1.3.2.2" rspace="0.055em" stretchy="false" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S3.SS2.SSS2.p3.1.m1.1.1.1.2" rspace="0.222em" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.2.cmml">×</mo><mi id="S3.SS2.SSS2.p3.1.m1.1.1.1.4" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.1.m1.1b"><apply id="S3.SS2.SSS2.p3.1.m1.1.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.2"><in id="S3.SS2.SSS2.p3.1.m1.1.2.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.2.1"></in><ci id="S3.SS2.SSS2.p3.1.m1.1.2.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.2.2">𝑀</ci><apply id="S3.SS2.SSS2.p3.1.m1.1.2.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.1.m1.1.2.3.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.2.3">superscript</csymbol><ci id="S3.SS2.SSS2.p3.1.m1.1.2.3.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.2.3.2">ℝ</ci><apply id="S3.SS2.SSS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1"><times id="S3.SS2.SSS2.p3.1.m1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.2"></times><apply id="S3.SS2.SSS2.p3.1.m1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.3.2"><abs id="S3.SS2.SSS2.p3.1.m1.1.1.1.3.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.3.2.1"></abs><ci id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1">𝐼</ci></apply><ci id="S3.SS2.SSS2.p3.1.m1.1.1.1.4.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.4">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.1.m1.1c">M\in\mathbb{R}^{|I|\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.1.m1.1d">italic_M ∈ blackboard_R start_POSTSUPERSCRIPT | italic_I | × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the embedding matrix, <math alttext="d" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.2.m2.1"><semantics id="S3.SS2.SSS2.p3.2.m2.1a"><mi id="S3.SS2.SSS2.p3.2.m2.1.1" xref="S3.SS2.SSS2.p3.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.2.m2.1b"><ci id="S3.SS2.SSS2.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.2.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.2.m2.1d">italic_d</annotation></semantics></math> denotes the embedding dimension, <math alttext="\mathbf{m}_{k}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.3.m3.1"><semantics id="S3.SS2.SSS2.p3.3.m3.1a"><mrow id="S3.SS2.SSS2.p3.3.m3.1.1" xref="S3.SS2.SSS2.p3.3.m3.1.1.cmml"><msub id="S3.SS2.SSS2.p3.3.m3.1.1.2" xref="S3.SS2.SSS2.p3.3.m3.1.1.2.cmml"><mi id="S3.SS2.SSS2.p3.3.m3.1.1.2.2" xref="S3.SS2.SSS2.p3.3.m3.1.1.2.2.cmml">𝐦</mi><mi id="S3.SS2.SSS2.p3.3.m3.1.1.2.3" xref="S3.SS2.SSS2.p3.3.m3.1.1.2.3.cmml">k</mi></msub><mo id="S3.SS2.SSS2.p3.3.m3.1.1.1" xref="S3.SS2.SSS2.p3.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS2.p3.3.m3.1.1.3" xref="S3.SS2.SSS2.p3.3.m3.1.1.3.cmml"><mi id="S3.SS2.SSS2.p3.3.m3.1.1.3.2" xref="S3.SS2.SSS2.p3.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.SSS2.p3.3.m3.1.1.3.3" xref="S3.SS2.SSS2.p3.3.m3.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.3.m3.1b"><apply id="S3.SS2.SSS2.p3.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1"><in id="S3.SS2.SSS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1.1"></in><apply id="S3.SS2.SSS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.3.m3.1.1.2.1.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS2.p3.3.m3.1.1.2.2.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1.2.2">𝐦</ci><ci id="S3.SS2.SSS2.p3.3.m3.1.1.2.3.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1.2.3">𝑘</ci></apply><apply id="S3.SS2.SSS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS2.p3.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1.3.2">ℝ</ci><ci id="S3.SS2.SSS2.p3.3.m3.1.1.3.3.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.3.m3.1c">\mathbf{m}_{k}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.3.m3.1d">bold_m start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the embedding vector of the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.4.m4.1"><semantics id="S3.SS2.SSS2.p3.4.m4.1a"><mi id="S3.SS2.SSS2.p3.4.m4.1.1" xref="S3.SS2.SSS2.p3.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.4.m4.1b"><ci id="S3.SS2.SSS2.p3.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p3.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.4.m4.1d">italic_k</annotation></semantics></math>-th item title, and <math alttext="\mathbf{i}_{k}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.5.m5.1"><semantics id="S3.SS2.SSS2.p3.5.m5.1a"><msub id="S3.SS2.SSS2.p3.5.m5.1.1" xref="S3.SS2.SSS2.p3.5.m5.1.1.cmml"><mi id="S3.SS2.SSS2.p3.5.m5.1.1.2" xref="S3.SS2.SSS2.p3.5.m5.1.1.2.cmml">𝐢</mi><mi id="S3.SS2.SSS2.p3.5.m5.1.1.3" xref="S3.SS2.SSS2.p3.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.5.m5.1b"><apply id="S3.SS2.SSS2.p3.5.m5.1.1.cmml" xref="S3.SS2.SSS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.SSS2.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.SSS2.p3.5.m5.1.1.2">𝐢</ci><ci id="S3.SS2.SSS2.p3.5.m5.1.1.3.cmml" xref="S3.SS2.SSS2.p3.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.5.m5.1c">\mathbf{i}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.5.m5.1d">bold_i start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> represents the title of the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.6.m6.1"><semantics id="S3.SS2.SSS2.p3.6.m6.1a"><mi id="S3.SS2.SSS2.p3.6.m6.1.1" xref="S3.SS2.SSS2.p3.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.6.m6.1b"><ci id="S3.SS2.SSS2.p3.6.m6.1.1.cmml" xref="S3.SS2.SSS2.p3.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.6.m6.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.6.m6.1d">italic_k</annotation></semantics></math>-th item. <math alttext="\text{TextEncoder}(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.7.m7.1"><semantics id="S3.SS2.SSS2.p3.7.m7.1a"><mrow id="S3.SS2.SSS2.p3.7.m7.1.2" xref="S3.SS2.SSS2.p3.7.m7.1.2.cmml"><mtext id="S3.SS2.SSS2.p3.7.m7.1.2.2" xref="S3.SS2.SSS2.p3.7.m7.1.2.2a.cmml">TextEncoder</mtext><mo id="S3.SS2.SSS2.p3.7.m7.1.2.1" xref="S3.SS2.SSS2.p3.7.m7.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p3.7.m7.1.2.3.2" xref="S3.SS2.SSS2.p3.7.m7.1.2.cmml"><mo id="S3.SS2.SSS2.p3.7.m7.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS2.p3.7.m7.1.2.cmml">(</mo><mo id="S3.SS2.SSS2.p3.7.m7.1.1" lspace="0em" rspace="0em" xref="S3.SS2.SSS2.p3.7.m7.1.1.cmml">⋅</mo><mo id="S3.SS2.SSS2.p3.7.m7.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS2.p3.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.7.m7.1b"><apply id="S3.SS2.SSS2.p3.7.m7.1.2.cmml" xref="S3.SS2.SSS2.p3.7.m7.1.2"><times id="S3.SS2.SSS2.p3.7.m7.1.2.1.cmml" xref="S3.SS2.SSS2.p3.7.m7.1.2.1"></times><ci id="S3.SS2.SSS2.p3.7.m7.1.2.2a.cmml" xref="S3.SS2.SSS2.p3.7.m7.1.2.2"><mtext id="S3.SS2.SSS2.p3.7.m7.1.2.2.cmml" xref="S3.SS2.SSS2.p3.7.m7.1.2.2">TextEncoder</mtext></ci><ci id="S3.SS2.SSS2.p3.7.m7.1.1.cmml" xref="S3.SS2.SSS2.p3.7.m7.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.7.m7.1c">\text{TextEncoder}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.7.m7.1d">TextEncoder ( ⋅ )</annotation></semantics></math> refers to the Sentence-bert model. By retrieving the embedding matrix <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.8.m8.1"><semantics id="S3.SS2.SSS2.p3.8.m8.1a"><mi id="S3.SS2.SSS2.p3.8.m8.1.1" xref="S3.SS2.SSS2.p3.8.m8.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.8.m8.1b"><ci id="S3.SS2.SSS2.p3.8.m8.1.1.cmml" xref="S3.SS2.SSS2.p3.8.m8.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.8.m8.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.8.m8.1d">italic_M</annotation></semantics></math>, and applying truncation or padding, we can transform the user interaction sequence <math alttext="\{S_{1}^{u},S_{2}^{u},...,S_{(|S^{u}|-1)}^{u}\}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.9.m9.5"><semantics id="S3.SS2.SSS2.p3.9.m9.5a"><mrow id="S3.SS2.SSS2.p3.9.m9.5.5.3" xref="S3.SS2.SSS2.p3.9.m9.5.5.4.cmml"><mo id="S3.SS2.SSS2.p3.9.m9.5.5.3.4" stretchy="false" xref="S3.SS2.SSS2.p3.9.m9.5.5.4.cmml">{</mo><msubsup id="S3.SS2.SSS2.p3.9.m9.3.3.1.1" xref="S3.SS2.SSS2.p3.9.m9.3.3.1.1.cmml"><mi id="S3.SS2.SSS2.p3.9.m9.3.3.1.1.2.2" xref="S3.SS2.SSS2.p3.9.m9.3.3.1.1.2.2.cmml">S</mi><mn id="S3.SS2.SSS2.p3.9.m9.3.3.1.1.2.3" xref="S3.SS2.SSS2.p3.9.m9.3.3.1.1.2.3.cmml">1</mn><mi id="S3.SS2.SSS2.p3.9.m9.3.3.1.1.3" xref="S3.SS2.SSS2.p3.9.m9.3.3.1.1.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS2.p3.9.m9.5.5.3.5" xref="S3.SS2.SSS2.p3.9.m9.5.5.4.cmml">,</mo><msubsup id="S3.SS2.SSS2.p3.9.m9.4.4.2.2" xref="S3.SS2.SSS2.p3.9.m9.4.4.2.2.cmml"><mi id="S3.SS2.SSS2.p3.9.m9.4.4.2.2.2.2" xref="S3.SS2.SSS2.p3.9.m9.4.4.2.2.2.2.cmml">S</mi><mn id="S3.SS2.SSS2.p3.9.m9.4.4.2.2.2.3" xref="S3.SS2.SSS2.p3.9.m9.4.4.2.2.2.3.cmml">2</mn><mi id="S3.SS2.SSS2.p3.9.m9.4.4.2.2.3" xref="S3.SS2.SSS2.p3.9.m9.4.4.2.2.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS2.p3.9.m9.5.5.3.6" xref="S3.SS2.SSS2.p3.9.m9.5.5.4.cmml">,</mo><mi id="S3.SS2.SSS2.p3.9.m9.2.2" mathvariant="normal" xref="S3.SS2.SSS2.p3.9.m9.2.2.cmml">…</mi><mo id="S3.SS2.SSS2.p3.9.m9.5.5.3.7" xref="S3.SS2.SSS2.p3.9.m9.5.5.4.cmml">,</mo><msubsup id="S3.SS2.SSS2.p3.9.m9.5.5.3.3" xref="S3.SS2.SSS2.p3.9.m9.5.5.3.3.cmml"><mi id="S3.SS2.SSS2.p3.9.m9.5.5.3.3.2.2" xref="S3.SS2.SSS2.p3.9.m9.5.5.3.3.2.2.cmml">S</mi><mrow id="S3.SS2.SSS2.p3.9.m9.1.1.1.1" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS2.p3.9.m9.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.cmml"><mrow id="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.1" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.2.cmml"><mo id="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.2.1.cmml">|</mo><msup id="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.1.1.2.cmml">S</mi><mi id="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.2" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.2.cmml">−</mo><mn id="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.3" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS2.SSS2.p3.9.m9.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.SS2.SSS2.p3.9.m9.5.5.3.3.3" xref="S3.SS2.SSS2.p3.9.m9.5.5.3.3.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS2.p3.9.m9.5.5.3.8" stretchy="false" xref="S3.SS2.SSS2.p3.9.m9.5.5.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.9.m9.5b"><set id="S3.SS2.SSS2.p3.9.m9.5.5.4.cmml" xref="S3.SS2.SSS2.p3.9.m9.5.5.3"><apply id="S3.SS2.SSS2.p3.9.m9.3.3.1.1.cmml" xref="S3.SS2.SSS2.p3.9.m9.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.9.m9.3.3.1.1.1.cmml" xref="S3.SS2.SSS2.p3.9.m9.3.3.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p3.9.m9.3.3.1.1.2.cmml" xref="S3.SS2.SSS2.p3.9.m9.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.9.m9.3.3.1.1.2.1.cmml" xref="S3.SS2.SSS2.p3.9.m9.3.3.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p3.9.m9.3.3.1.1.2.2.cmml" xref="S3.SS2.SSS2.p3.9.m9.3.3.1.1.2.2">𝑆</ci><cn id="S3.SS2.SSS2.p3.9.m9.3.3.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS2.p3.9.m9.3.3.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS2.p3.9.m9.3.3.1.1.3.cmml" xref="S3.SS2.SSS2.p3.9.m9.3.3.1.1.3">𝑢</ci></apply><apply id="S3.SS2.SSS2.p3.9.m9.4.4.2.2.cmml" xref="S3.SS2.SSS2.p3.9.m9.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.9.m9.4.4.2.2.1.cmml" xref="S3.SS2.SSS2.p3.9.m9.4.4.2.2">superscript</csymbol><apply id="S3.SS2.SSS2.p3.9.m9.4.4.2.2.2.cmml" xref="S3.SS2.SSS2.p3.9.m9.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.9.m9.4.4.2.2.2.1.cmml" xref="S3.SS2.SSS2.p3.9.m9.4.4.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p3.9.m9.4.4.2.2.2.2.cmml" xref="S3.SS2.SSS2.p3.9.m9.4.4.2.2.2.2">𝑆</ci><cn id="S3.SS2.SSS2.p3.9.m9.4.4.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS2.p3.9.m9.4.4.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS2.p3.9.m9.4.4.2.2.3.cmml" xref="S3.SS2.SSS2.p3.9.m9.4.4.2.2.3">𝑢</ci></apply><ci id="S3.SS2.SSS2.p3.9.m9.2.2.cmml" xref="S3.SS2.SSS2.p3.9.m9.2.2">…</ci><apply id="S3.SS2.SSS2.p3.9.m9.5.5.3.3.cmml" xref="S3.SS2.SSS2.p3.9.m9.5.5.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.9.m9.5.5.3.3.1.cmml" xref="S3.SS2.SSS2.p3.9.m9.5.5.3.3">superscript</csymbol><apply id="S3.SS2.SSS2.p3.9.m9.5.5.3.3.2.cmml" xref="S3.SS2.SSS2.p3.9.m9.5.5.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.9.m9.5.5.3.3.2.1.cmml" xref="S3.SS2.SSS2.p3.9.m9.5.5.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.p3.9.m9.5.5.3.3.2.2.cmml" xref="S3.SS2.SSS2.p3.9.m9.5.5.3.3.2.2">𝑆</ci><apply id="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1"><minus id="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.2"></minus><apply id="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.1"><abs id="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.1.2"></abs><apply id="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.1.1.2">𝑆</ci><ci id="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.1.1.1.3">𝑢</ci></apply></apply><cn id="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p3.9.m9.1.1.1.1.1.3">1</cn></apply></apply><ci id="S3.SS2.SSS2.p3.9.m9.5.5.3.3.3.cmml" xref="S3.SS2.SSS2.p3.9.m9.5.5.3.3.3">𝑢</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.9.m9.5c">\{S_{1}^{u},S_{2}^{u},...,S_{(|S^{u}|-1)}^{u}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.9.m9.5d">{ italic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_S start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , italic_S start_POSTSUBSCRIPT ( | italic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | - 1 ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT }</annotation></semantics></math> into a fixed-length vector sequence <math alttext="\mathbf{s}^{u}=\{\mathbf{s}_{1}^{u},\mathbf{s}_{2}^{u},...,\mathbf{s}_{n}^{u}\}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.10.m10.4"><semantics id="S3.SS2.SSS2.p3.10.m10.4a"><mrow id="S3.SS2.SSS2.p3.10.m10.4.4" xref="S3.SS2.SSS2.p3.10.m10.4.4.cmml"><msup id="S3.SS2.SSS2.p3.10.m10.4.4.5" xref="S3.SS2.SSS2.p3.10.m10.4.4.5.cmml"><mi id="S3.SS2.SSS2.p3.10.m10.4.4.5.2" xref="S3.SS2.SSS2.p3.10.m10.4.4.5.2.cmml">𝐬</mi><mi id="S3.SS2.SSS2.p3.10.m10.4.4.5.3" xref="S3.SS2.SSS2.p3.10.m10.4.4.5.3.cmml">u</mi></msup><mo id="S3.SS2.SSS2.p3.10.m10.4.4.4" xref="S3.SS2.SSS2.p3.10.m10.4.4.4.cmml">=</mo><mrow id="S3.SS2.SSS2.p3.10.m10.4.4.3.3" xref="S3.SS2.SSS2.p3.10.m10.4.4.3.4.cmml"><mo id="S3.SS2.SSS2.p3.10.m10.4.4.3.3.4" stretchy="false" xref="S3.SS2.SSS2.p3.10.m10.4.4.3.4.cmml">{</mo><msubsup id="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1" xref="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1.2.2" xref="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1.2.2.cmml">𝐬</mi><mn id="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1.2.3" xref="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1.2.3.cmml">1</mn><mi id="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1.3" xref="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS2.p3.10.m10.4.4.3.3.5" xref="S3.SS2.SSS2.p3.10.m10.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2" xref="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2.cmml"><mi id="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2.2.2" xref="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2.2.2.cmml">𝐬</mi><mn id="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2.2.3" xref="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2.2.3.cmml">2</mn><mi id="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2.3" xref="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS2.p3.10.m10.4.4.3.3.6" xref="S3.SS2.SSS2.p3.10.m10.4.4.3.4.cmml">,</mo><mi id="S3.SS2.SSS2.p3.10.m10.1.1" mathvariant="normal" xref="S3.SS2.SSS2.p3.10.m10.1.1.cmml">…</mi><mo id="S3.SS2.SSS2.p3.10.m10.4.4.3.3.7" xref="S3.SS2.SSS2.p3.10.m10.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3" xref="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3.cmml"><mi id="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3.2.2" xref="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3.2.2.cmml">𝐬</mi><mi id="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3.2.3" xref="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3.2.3.cmml">n</mi><mi id="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3.3" xref="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS2.p3.10.m10.4.4.3.3.8" stretchy="false" xref="S3.SS2.SSS2.p3.10.m10.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.10.m10.4b"><apply id="S3.SS2.SSS2.p3.10.m10.4.4.cmml" xref="S3.SS2.SSS2.p3.10.m10.4.4"><eq id="S3.SS2.SSS2.p3.10.m10.4.4.4.cmml" xref="S3.SS2.SSS2.p3.10.m10.4.4.4"></eq><apply id="S3.SS2.SSS2.p3.10.m10.4.4.5.cmml" xref="S3.SS2.SSS2.p3.10.m10.4.4.5"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.10.m10.4.4.5.1.cmml" xref="S3.SS2.SSS2.p3.10.m10.4.4.5">superscript</csymbol><ci id="S3.SS2.SSS2.p3.10.m10.4.4.5.2.cmml" xref="S3.SS2.SSS2.p3.10.m10.4.4.5.2">𝐬</ci><ci id="S3.SS2.SSS2.p3.10.m10.4.4.5.3.cmml" xref="S3.SS2.SSS2.p3.10.m10.4.4.5.3">𝑢</ci></apply><set id="S3.SS2.SSS2.p3.10.m10.4.4.3.4.cmml" xref="S3.SS2.SSS2.p3.10.m10.4.4.3.3"><apply id="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1.2.2">𝐬</ci><cn id="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS2.p3.10.m10.2.2.1.1.1.3">𝑢</ci></apply><apply id="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2.cmml" xref="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2.2.2">𝐬</ci><cn id="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2.3.cmml" xref="S3.SS2.SSS2.p3.10.m10.3.3.2.2.2.3">𝑢</ci></apply><ci id="S3.SS2.SSS2.p3.10.m10.1.1.cmml" xref="S3.SS2.SSS2.p3.10.m10.1.1">…</ci><apply id="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3.cmml" xref="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3.1.cmml" xref="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3">superscript</csymbol><apply id="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3.2.cmml" xref="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3.2.1.cmml" xref="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3.2.2.cmml" xref="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3.2.2">𝐬</ci><ci id="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3.2.3.cmml" xref="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3.2.3">𝑛</ci></apply><ci id="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3.3.cmml" xref="S3.SS2.SSS2.p3.10.m10.4.4.3.3.3.3">𝑢</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.10.m10.4c">\mathbf{s}^{u}=\{\mathbf{s}_{1}^{u},\mathbf{s}_{2}^{u},...,\mathbf{s}_{n}^{u}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.10.m10.4d">bold_s start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = { bold_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , bold_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , bold_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT }</annotation></semantics></math>, where <math alttext="\mathbf{s}_{t}^{u}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.11.m11.1"><semantics id="S3.SS2.SSS2.p3.11.m11.1a"><mrow id="S3.SS2.SSS2.p3.11.m11.1.1" xref="S3.SS2.SSS2.p3.11.m11.1.1.cmml"><msubsup id="S3.SS2.SSS2.p3.11.m11.1.1.2" xref="S3.SS2.SSS2.p3.11.m11.1.1.2.cmml"><mi id="S3.SS2.SSS2.p3.11.m11.1.1.2.2.2" xref="S3.SS2.SSS2.p3.11.m11.1.1.2.2.2.cmml">𝐬</mi><mi id="S3.SS2.SSS2.p3.11.m11.1.1.2.2.3" xref="S3.SS2.SSS2.p3.11.m11.1.1.2.2.3.cmml">t</mi><mi id="S3.SS2.SSS2.p3.11.m11.1.1.2.3" xref="S3.SS2.SSS2.p3.11.m11.1.1.2.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS2.p3.11.m11.1.1.1" xref="S3.SS2.SSS2.p3.11.m11.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS2.p3.11.m11.1.1.3" xref="S3.SS2.SSS2.p3.11.m11.1.1.3.cmml"><mi id="S3.SS2.SSS2.p3.11.m11.1.1.3.2" xref="S3.SS2.SSS2.p3.11.m11.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.SSS2.p3.11.m11.1.1.3.3" xref="S3.SS2.SSS2.p3.11.m11.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.11.m11.1b"><apply id="S3.SS2.SSS2.p3.11.m11.1.1.cmml" xref="S3.SS2.SSS2.p3.11.m11.1.1"><in id="S3.SS2.SSS2.p3.11.m11.1.1.1.cmml" xref="S3.SS2.SSS2.p3.11.m11.1.1.1"></in><apply id="S3.SS2.SSS2.p3.11.m11.1.1.2.cmml" xref="S3.SS2.SSS2.p3.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.11.m11.1.1.2.1.cmml" xref="S3.SS2.SSS2.p3.11.m11.1.1.2">superscript</csymbol><apply id="S3.SS2.SSS2.p3.11.m11.1.1.2.2.cmml" xref="S3.SS2.SSS2.p3.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.11.m11.1.1.2.2.1.cmml" xref="S3.SS2.SSS2.p3.11.m11.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS2.p3.11.m11.1.1.2.2.2.cmml" xref="S3.SS2.SSS2.p3.11.m11.1.1.2.2.2">𝐬</ci><ci id="S3.SS2.SSS2.p3.11.m11.1.1.2.2.3.cmml" xref="S3.SS2.SSS2.p3.11.m11.1.1.2.2.3">𝑡</ci></apply><ci id="S3.SS2.SSS2.p3.11.m11.1.1.2.3.cmml" xref="S3.SS2.SSS2.p3.11.m11.1.1.2.3">𝑢</ci></apply><apply id="S3.SS2.SSS2.p3.11.m11.1.1.3.cmml" xref="S3.SS2.SSS2.p3.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.11.m11.1.1.3.1.cmml" xref="S3.SS2.SSS2.p3.11.m11.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS2.p3.11.m11.1.1.3.2.cmml" xref="S3.SS2.SSS2.p3.11.m11.1.1.3.2">ℝ</ci><ci id="S3.SS2.SSS2.p3.11.m11.1.1.3.3.cmml" xref="S3.SS2.SSS2.p3.11.m11.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.11.m11.1c">\mathbf{s}_{t}^{u}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.11.m11.1d">bold_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the embedding vector of item <math alttext="S_{t}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.12.m12.1"><semantics id="S3.SS2.SSS2.p3.12.m12.1a"><msubsup id="S3.SS2.SSS2.p3.12.m12.1.1" xref="S3.SS2.SSS2.p3.12.m12.1.1.cmml"><mi id="S3.SS2.SSS2.p3.12.m12.1.1.2.2" xref="S3.SS2.SSS2.p3.12.m12.1.1.2.2.cmml">S</mi><mi id="S3.SS2.SSS2.p3.12.m12.1.1.2.3" xref="S3.SS2.SSS2.p3.12.m12.1.1.2.3.cmml">t</mi><mi id="S3.SS2.SSS2.p3.12.m12.1.1.3" xref="S3.SS2.SSS2.p3.12.m12.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.12.m12.1b"><apply id="S3.SS2.SSS2.p3.12.m12.1.1.cmml" xref="S3.SS2.SSS2.p3.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.12.m12.1.1.1.cmml" xref="S3.SS2.SSS2.p3.12.m12.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p3.12.m12.1.1.2.cmml" xref="S3.SS2.SSS2.p3.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.12.m12.1.1.2.1.cmml" xref="S3.SS2.SSS2.p3.12.m12.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p3.12.m12.1.1.2.2.cmml" xref="S3.SS2.SSS2.p3.12.m12.1.1.2.2">𝑆</ci><ci id="S3.SS2.SSS2.p3.12.m12.1.1.2.3.cmml" xref="S3.SS2.SSS2.p3.12.m12.1.1.2.3">𝑡</ci></apply><ci id="S3.SS2.SSS2.p3.12.m12.1.1.3.cmml" xref="S3.SS2.SSS2.p3.12.m12.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.12.m12.1c">S_{t}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.12.m12.1d">italic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="n" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.13.m13.1"><semantics id="S3.SS2.SSS2.p3.13.m13.1a"><mi id="S3.SS2.SSS2.p3.13.m13.1.1" xref="S3.SS2.SSS2.p3.13.m13.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.13.m13.1b"><ci id="S3.SS2.SSS2.p3.13.m13.1.1.cmml" xref="S3.SS2.SSS2.p3.13.m13.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.13.m13.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.13.m13.1d">italic_n</annotation></semantics></math> denotes the fixed-length of sequence. If the sequence length exceeds <math alttext="n" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.14.m14.1"><semantics id="S3.SS2.SSS2.p3.14.m14.1a"><mi id="S3.SS2.SSS2.p3.14.m14.1.1" xref="S3.SS2.SSS2.p3.14.m14.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.14.m14.1b"><ci id="S3.SS2.SSS2.p3.14.m14.1.1.cmml" xref="S3.SS2.SSS2.p3.14.m14.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.14.m14.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.14.m14.1d">italic_n</annotation></semantics></math>, we extract the last <math alttext="n" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.15.m15.1"><semantics id="S3.SS2.SSS2.p3.15.m15.1a"><mi id="S3.SS2.SSS2.p3.15.m15.1.1" xref="S3.SS2.SSS2.p3.15.m15.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.15.m15.1b"><ci id="S3.SS2.SSS2.p3.15.m15.1.1.cmml" xref="S3.SS2.SSS2.p3.15.m15.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.15.m15.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.15.m15.1d">italic_n</annotation></semantics></math> items from the sequence. Conversely, if the sequence length is less than <math alttext="n" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.16.m16.1"><semantics id="S3.SS2.SSS2.p3.16.m16.1a"><mi id="S3.SS2.SSS2.p3.16.m16.1.1" xref="S3.SS2.SSS2.p3.16.m16.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.16.m16.1b"><ci id="S3.SS2.SSS2.p3.16.m16.1.1.cmml" xref="S3.SS2.SSS2.p3.16.m16.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.16.m16.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.16.m16.1d">italic_n</annotation></semantics></math>, we prepend a padding zero vector <math alttext="\mathbf{0}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.17.m17.1"><semantics id="S3.SS2.SSS2.p3.17.m17.1a"><mn id="S3.SS2.SSS2.p3.17.m17.1.1" xref="S3.SS2.SSS2.p3.17.m17.1.1.cmml">𝟎</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.17.m17.1b"><cn id="S3.SS2.SSS2.p3.17.m17.1.1.cmml" type="integer" xref="S3.SS2.SSS2.p3.17.m17.1.1">0</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.17.m17.1c">\mathbf{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.17.m17.1d">bold_0</annotation></semantics></math> until the sequence reaches the desired length <math alttext="n" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.18.m18.1"><semantics id="S3.SS2.SSS2.p3.18.m18.1a"><mi id="S3.SS2.SSS2.p3.18.m18.1.1" xref="S3.SS2.SSS2.p3.18.m18.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.18.m18.1b"><ci id="S3.SS2.SSS2.p3.18.m18.1.1.cmml" xref="S3.SS2.SSS2.p3.18.m18.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.18.m18.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.18.m18.1d">italic_n</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.3 </span>Integrated Model Module</h4>
<div class="ltx_para" id="S3.SS2.SSS3.p1">
<p class="ltx_p" id="S3.SS2.SSS3.p1.1">The primary objective of our proposed framework is to leverage large-scale models to achieve explainability for recommendations generated by traditional black-box models.
Therefore, our framework needs to integrate sequential recommendation models as the objects to be explained. Among non-explainable sequential recommendation models, SASRec has demonstrated outstanding performance across numerous sequential recommendation datasets and applications <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib25" title="">25</a>]</cite>, making it highly representative. <span class="ltx_text ltx_font_bold" id="S3.SS2.SSS3.p1.1.1">Hence, we have selected SASRec as an example to illustrate this module, and other recommendation models follow a similar development.</span></p>
</div>
<div class="ltx_para" id="S3.SS2.SSS3.p2">
<p class="ltx_p" id="S3.SS2.SSS3.p2.1">Recommender is the target we aim to empower, we largely retain all settings of SASRec and only make adaptive modifications to the following two parts:
1). Since SASRec is an ID-based model, we have made modifications to its embedding layer. The embedding layer of SASRec is no longer initialized randomly but with the previously obtained embedding matrix <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p2.1.m1.1"><semantics id="S3.SS2.SSS3.p2.1.m1.1a"><mi id="S3.SS2.SSS3.p2.1.m1.1.1" xref="S3.SS2.SSS3.p2.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.1.m1.1b"><ci id="S3.SS2.SSS3.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p2.1.m1.1d">italic_M</annotation></semantics></math> to preserve the original semantic information. The position encoding of the embedding layer is still retained, and it is a randomly initialized learnable embedding matrix.
2). The recommender serves as an embedding part of our framework, it does not need to output the final prediction results (the ranking scores for each candidate item). Instead, SASRec only needs to output the feature vectors of the user sequences used for calculating the ranking scores. Therefore, we have also modified the prediction layer to directly return the feature vectors of the sequences.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS3.p3">
<p class="ltx_p" id="S3.SS2.SSS3.p3.2">We maintain consistency with the original implementation of SASRec for other aspects, and specific implementation details can be referred to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib25" title="">25</a>]</cite>. Given the interaction sequence <math alttext="\{\mathbf{s}_{1}^{u},\mathbf{s}_{2}^{u},...,\mathbf{s}_{n}^{u}\}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p3.1.m1.4"><semantics id="S3.SS2.SSS3.p3.1.m1.4a"><mrow id="S3.SS2.SSS3.p3.1.m1.4.4.3" xref="S3.SS2.SSS3.p3.1.m1.4.4.4.cmml"><mo id="S3.SS2.SSS3.p3.1.m1.4.4.3.4" stretchy="false" xref="S3.SS2.SSS3.p3.1.m1.4.4.4.cmml">{</mo><msubsup id="S3.SS2.SSS3.p3.1.m1.2.2.1.1" xref="S3.SS2.SSS3.p3.1.m1.2.2.1.1.cmml"><mi id="S3.SS2.SSS3.p3.1.m1.2.2.1.1.2.2" xref="S3.SS2.SSS3.p3.1.m1.2.2.1.1.2.2.cmml">𝐬</mi><mn id="S3.SS2.SSS3.p3.1.m1.2.2.1.1.2.3" xref="S3.SS2.SSS3.p3.1.m1.2.2.1.1.2.3.cmml">1</mn><mi id="S3.SS2.SSS3.p3.1.m1.2.2.1.1.3" xref="S3.SS2.SSS3.p3.1.m1.2.2.1.1.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS3.p3.1.m1.4.4.3.5" xref="S3.SS2.SSS3.p3.1.m1.4.4.4.cmml">,</mo><msubsup id="S3.SS2.SSS3.p3.1.m1.3.3.2.2" xref="S3.SS2.SSS3.p3.1.m1.3.3.2.2.cmml"><mi id="S3.SS2.SSS3.p3.1.m1.3.3.2.2.2.2" xref="S3.SS2.SSS3.p3.1.m1.3.3.2.2.2.2.cmml">𝐬</mi><mn id="S3.SS2.SSS3.p3.1.m1.3.3.2.2.2.3" xref="S3.SS2.SSS3.p3.1.m1.3.3.2.2.2.3.cmml">2</mn><mi id="S3.SS2.SSS3.p3.1.m1.3.3.2.2.3" xref="S3.SS2.SSS3.p3.1.m1.3.3.2.2.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS3.p3.1.m1.4.4.3.6" xref="S3.SS2.SSS3.p3.1.m1.4.4.4.cmml">,</mo><mi id="S3.SS2.SSS3.p3.1.m1.1.1" mathvariant="normal" xref="S3.SS2.SSS3.p3.1.m1.1.1.cmml">…</mi><mo id="S3.SS2.SSS3.p3.1.m1.4.4.3.7" xref="S3.SS2.SSS3.p3.1.m1.4.4.4.cmml">,</mo><msubsup id="S3.SS2.SSS3.p3.1.m1.4.4.3.3" xref="S3.SS2.SSS3.p3.1.m1.4.4.3.3.cmml"><mi id="S3.SS2.SSS3.p3.1.m1.4.4.3.3.2.2" xref="S3.SS2.SSS3.p3.1.m1.4.4.3.3.2.2.cmml">𝐬</mi><mi id="S3.SS2.SSS3.p3.1.m1.4.4.3.3.2.3" xref="S3.SS2.SSS3.p3.1.m1.4.4.3.3.2.3.cmml">n</mi><mi id="S3.SS2.SSS3.p3.1.m1.4.4.3.3.3" xref="S3.SS2.SSS3.p3.1.m1.4.4.3.3.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS3.p3.1.m1.4.4.3.8" stretchy="false" xref="S3.SS2.SSS3.p3.1.m1.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p3.1.m1.4b"><set id="S3.SS2.SSS3.p3.1.m1.4.4.4.cmml" xref="S3.SS2.SSS3.p3.1.m1.4.4.3"><apply id="S3.SS2.SSS3.p3.1.m1.2.2.1.1.cmml" xref="S3.SS2.SSS3.p3.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p3.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.SSS3.p3.1.m1.2.2.1.1">superscript</csymbol><apply id="S3.SS2.SSS3.p3.1.m1.2.2.1.1.2.cmml" xref="S3.SS2.SSS3.p3.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p3.1.m1.2.2.1.1.2.1.cmml" xref="S3.SS2.SSS3.p3.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p3.1.m1.2.2.1.1.2.2.cmml" xref="S3.SS2.SSS3.p3.1.m1.2.2.1.1.2.2">𝐬</ci><cn id="S3.SS2.SSS3.p3.1.m1.2.2.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS3.p3.1.m1.2.2.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS3.p3.1.m1.2.2.1.1.3.cmml" xref="S3.SS2.SSS3.p3.1.m1.2.2.1.1.3">𝑢</ci></apply><apply id="S3.SS2.SSS3.p3.1.m1.3.3.2.2.cmml" xref="S3.SS2.SSS3.p3.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p3.1.m1.3.3.2.2.1.cmml" xref="S3.SS2.SSS3.p3.1.m1.3.3.2.2">superscript</csymbol><apply id="S3.SS2.SSS3.p3.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.SSS3.p3.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p3.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS3.p3.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS2.SSS3.p3.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS3.p3.1.m1.3.3.2.2.2.2">𝐬</ci><cn id="S3.SS2.SSS3.p3.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS3.p3.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS3.p3.1.m1.3.3.2.2.3.cmml" xref="S3.SS2.SSS3.p3.1.m1.3.3.2.2.3">𝑢</ci></apply><ci id="S3.SS2.SSS3.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p3.1.m1.1.1">…</ci><apply id="S3.SS2.SSS3.p3.1.m1.4.4.3.3.cmml" xref="S3.SS2.SSS3.p3.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p3.1.m1.4.4.3.3.1.cmml" xref="S3.SS2.SSS3.p3.1.m1.4.4.3.3">superscript</csymbol><apply id="S3.SS2.SSS3.p3.1.m1.4.4.3.3.2.cmml" xref="S3.SS2.SSS3.p3.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p3.1.m1.4.4.3.3.2.1.cmml" xref="S3.SS2.SSS3.p3.1.m1.4.4.3.3">subscript</csymbol><ci id="S3.SS2.SSS3.p3.1.m1.4.4.3.3.2.2.cmml" xref="S3.SS2.SSS3.p3.1.m1.4.4.3.3.2.2">𝐬</ci><ci id="S3.SS2.SSS3.p3.1.m1.4.4.3.3.2.3.cmml" xref="S3.SS2.SSS3.p3.1.m1.4.4.3.3.2.3">𝑛</ci></apply><ci id="S3.SS2.SSS3.p3.1.m1.4.4.3.3.3.cmml" xref="S3.SS2.SSS3.p3.1.m1.4.4.3.3.3">𝑢</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p3.1.m1.4c">\{\mathbf{s}_{1}^{u},\mathbf{s}_{2}^{u},...,\mathbf{s}_{n}^{u}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p3.1.m1.4d">{ bold_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , bold_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , bold_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT }</annotation></semantics></math>, where <math alttext="\mathbf{s}_{t}^{u}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p3.2.m2.1"><semantics id="S3.SS2.SSS3.p3.2.m2.1a"><mrow id="S3.SS2.SSS3.p3.2.m2.1.1" xref="S3.SS2.SSS3.p3.2.m2.1.1.cmml"><msubsup id="S3.SS2.SSS3.p3.2.m2.1.1.2" xref="S3.SS2.SSS3.p3.2.m2.1.1.2.cmml"><mi id="S3.SS2.SSS3.p3.2.m2.1.1.2.2.2" xref="S3.SS2.SSS3.p3.2.m2.1.1.2.2.2.cmml">𝐬</mi><mi id="S3.SS2.SSS3.p3.2.m2.1.1.2.2.3" xref="S3.SS2.SSS3.p3.2.m2.1.1.2.2.3.cmml">t</mi><mi id="S3.SS2.SSS3.p3.2.m2.1.1.2.3" xref="S3.SS2.SSS3.p3.2.m2.1.1.2.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS3.p3.2.m2.1.1.1" xref="S3.SS2.SSS3.p3.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS3.p3.2.m2.1.1.3" xref="S3.SS2.SSS3.p3.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS3.p3.2.m2.1.1.3.2" xref="S3.SS2.SSS3.p3.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.SSS3.p3.2.m2.1.1.3.3" xref="S3.SS2.SSS3.p3.2.m2.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p3.2.m2.1b"><apply id="S3.SS2.SSS3.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1"><in id="S3.SS2.SSS3.p3.2.m2.1.1.1.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1.1"></in><apply id="S3.SS2.SSS3.p3.2.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p3.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1.2">superscript</csymbol><apply id="S3.SS2.SSS3.p3.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p3.2.m2.1.1.2.2.1.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS3.p3.2.m2.1.1.2.2.2.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1.2.2.2">𝐬</ci><ci id="S3.SS2.SSS3.p3.2.m2.1.1.2.2.3.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1.2.2.3">𝑡</ci></apply><ci id="S3.SS2.SSS3.p3.2.m2.1.1.2.3.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1.2.3">𝑢</ci></apply><apply id="S3.SS2.SSS3.p3.2.m2.1.1.3.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p3.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS3.p3.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1.3.2">ℝ</ci><ci id="S3.SS2.SSS3.p3.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p3.2.m2.1c">\mathbf{s}_{t}^{u}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p3.2.m2.1d">bold_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, the formulation can be expressed as follows:</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS3.p4">
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{E}^{u}=\left[\begin{array}[]{c}\mathbf{e}_{1}^{u}\\
\mathbf{e}_{2}^{u}\\
\vdots\\
\mathbf{e}_{n}^{u}\end{array}\right]=\left[\begin{array}[]{c}\mathbf{s}_{1}^{u%
}+\mathbf{PE}_{1}\\
\mathbf{s}_{2}^{u}+\mathbf{PE}_{2}\\
\vdots\\
\mathbf{s}_{n}^{u}+\mathbf{PE}_{n}\end{array}\right]," class="ltx_Math" display="block" id="S3.E2.m1.3"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><msup id="S3.E2.m1.3.3.1.1.2" xref="S3.E2.m1.3.3.1.1.2.cmml"><mi id="S3.E2.m1.3.3.1.1.2.2" xref="S3.E2.m1.3.3.1.1.2.2.cmml">𝐄</mi><mi id="S3.E2.m1.3.3.1.1.2.3" xref="S3.E2.m1.3.3.1.1.2.3.cmml">u</mi></msup><mo id="S3.E2.m1.3.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.4.2" xref="S3.E2.m1.3.3.1.1.4.1.cmml"><mo id="S3.E2.m1.3.3.1.1.4.2.1" xref="S3.E2.m1.3.3.1.1.4.1.1.cmml">[</mo><mtable displaystyle="true" id="S3.E2.m1.1.1" rowspacing="0pt" xref="S3.E2.m1.1.1.cmml"><mtr id="S3.E2.m1.1.1a" xref="S3.E2.m1.1.1.cmml"><mtd id="S3.E2.m1.1.1b" xref="S3.E2.m1.1.1.cmml"><msubsup id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.2.2.cmml">𝐞</mi><mn id="S3.E2.m1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.2.3.cmml">1</mn><mi id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml">u</mi></msubsup></mtd></mtr><mtr id="S3.E2.m1.1.1c" xref="S3.E2.m1.1.1.cmml"><mtd id="S3.E2.m1.1.1d" xref="S3.E2.m1.1.1.cmml"><msubsup id="S3.E2.m1.1.1.2.1.1" xref="S3.E2.m1.1.1.2.1.1.cmml"><mi id="S3.E2.m1.1.1.2.1.1.2.2" xref="S3.E2.m1.1.1.2.1.1.2.2.cmml">𝐞</mi><mn id="S3.E2.m1.1.1.2.1.1.2.3" xref="S3.E2.m1.1.1.2.1.1.2.3.cmml">2</mn><mi id="S3.E2.m1.1.1.2.1.1.3" xref="S3.E2.m1.1.1.2.1.1.3.cmml">u</mi></msubsup></mtd></mtr><mtr id="S3.E2.m1.1.1e" xref="S3.E2.m1.1.1.cmml"><mtd id="S3.E2.m1.1.1f" xref="S3.E2.m1.1.1.cmml"><mi id="S3.E2.m1.1.1.3.1.1" mathvariant="normal" xref="S3.E2.m1.1.1.3.1.1.cmml">⋮</mi></mtd></mtr><mtr id="S3.E2.m1.1.1g" xref="S3.E2.m1.1.1.cmml"><mtd id="S3.E2.m1.1.1h" xref="S3.E2.m1.1.1.cmml"><msubsup id="S3.E2.m1.1.1.4.1.1" xref="S3.E2.m1.1.1.4.1.1.cmml"><mi id="S3.E2.m1.1.1.4.1.1.2.2" xref="S3.E2.m1.1.1.4.1.1.2.2.cmml">𝐞</mi><mi id="S3.E2.m1.1.1.4.1.1.2.3" xref="S3.E2.m1.1.1.4.1.1.2.3.cmml">n</mi><mi id="S3.E2.m1.1.1.4.1.1.3" xref="S3.E2.m1.1.1.4.1.1.3.cmml">u</mi></msubsup></mtd></mtr></mtable><mo id="S3.E2.m1.3.3.1.1.4.2.2" xref="S3.E2.m1.3.3.1.1.4.1.1.cmml">]</mo></mrow><mo id="S3.E2.m1.3.3.1.1.5" xref="S3.E2.m1.3.3.1.1.5.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.6.2" xref="S3.E2.m1.3.3.1.1.6.1.cmml"><mo id="S3.E2.m1.3.3.1.1.6.2.1" xref="S3.E2.m1.3.3.1.1.6.1.1.cmml">[</mo><mtable displaystyle="true" id="S3.E2.m1.2.2" rowspacing="0pt" xref="S3.E2.m1.2.2.cmml"><mtr id="S3.E2.m1.2.2a" xref="S3.E2.m1.2.2.cmml"><mtd id="S3.E2.m1.2.2b" xref="S3.E2.m1.2.2.cmml"><mrow id="S3.E2.m1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.cmml"><msubsup id="S3.E2.m1.2.2.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.2.cmml"><mi id="S3.E2.m1.2.2.1.1.1.2.2.2" xref="S3.E2.m1.2.2.1.1.1.2.2.2.cmml">𝐬</mi><mn id="S3.E2.m1.2.2.1.1.1.2.2.3" xref="S3.E2.m1.2.2.1.1.1.2.2.3.cmml">1</mn><mi id="S3.E2.m1.2.2.1.1.1.2.3" xref="S3.E2.m1.2.2.1.1.1.2.3.cmml">u</mi></msubsup><mo id="S3.E2.m1.2.2.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.cmml">+</mo><msub id="S3.E2.m1.2.2.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.1.3.2.cmml">𝐏𝐄</mi><mn id="S3.E2.m1.2.2.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.1.3.3.cmml">1</mn></msub></mrow></mtd></mtr><mtr id="S3.E2.m1.2.2c" xref="S3.E2.m1.2.2.cmml"><mtd id="S3.E2.m1.2.2d" xref="S3.E2.m1.2.2.cmml"><mrow id="S3.E2.m1.2.2.2.1.1" xref="S3.E2.m1.2.2.2.1.1.cmml"><msubsup id="S3.E2.m1.2.2.2.1.1.2" xref="S3.E2.m1.2.2.2.1.1.2.cmml"><mi id="S3.E2.m1.2.2.2.1.1.2.2.2" xref="S3.E2.m1.2.2.2.1.1.2.2.2.cmml">𝐬</mi><mn id="S3.E2.m1.2.2.2.1.1.2.2.3" xref="S3.E2.m1.2.2.2.1.1.2.2.3.cmml">2</mn><mi id="S3.E2.m1.2.2.2.1.1.2.3" xref="S3.E2.m1.2.2.2.1.1.2.3.cmml">u</mi></msubsup><mo id="S3.E2.m1.2.2.2.1.1.1" xref="S3.E2.m1.2.2.2.1.1.1.cmml">+</mo><msub id="S3.E2.m1.2.2.2.1.1.3" xref="S3.E2.m1.2.2.2.1.1.3.cmml"><mi id="S3.E2.m1.2.2.2.1.1.3.2" xref="S3.E2.m1.2.2.2.1.1.3.2.cmml">𝐏𝐄</mi><mn id="S3.E2.m1.2.2.2.1.1.3.3" xref="S3.E2.m1.2.2.2.1.1.3.3.cmml">2</mn></msub></mrow></mtd></mtr><mtr id="S3.E2.m1.2.2e" xref="S3.E2.m1.2.2.cmml"><mtd id="S3.E2.m1.2.2f" xref="S3.E2.m1.2.2.cmml"><mi id="S3.E2.m1.2.2.3.1.1" mathvariant="normal" xref="S3.E2.m1.2.2.3.1.1.cmml">⋮</mi></mtd></mtr><mtr id="S3.E2.m1.2.2g" xref="S3.E2.m1.2.2.cmml"><mtd id="S3.E2.m1.2.2h" xref="S3.E2.m1.2.2.cmml"><mrow id="S3.E2.m1.2.2.4.1.1" xref="S3.E2.m1.2.2.4.1.1.cmml"><msubsup id="S3.E2.m1.2.2.4.1.1.2" xref="S3.E2.m1.2.2.4.1.1.2.cmml"><mi id="S3.E2.m1.2.2.4.1.1.2.2.2" xref="S3.E2.m1.2.2.4.1.1.2.2.2.cmml">𝐬</mi><mi id="S3.E2.m1.2.2.4.1.1.2.2.3" xref="S3.E2.m1.2.2.4.1.1.2.2.3.cmml">n</mi><mi id="S3.E2.m1.2.2.4.1.1.2.3" xref="S3.E2.m1.2.2.4.1.1.2.3.cmml">u</mi></msubsup><mo id="S3.E2.m1.2.2.4.1.1.1" xref="S3.E2.m1.2.2.4.1.1.1.cmml">+</mo><msub id="S3.E2.m1.2.2.4.1.1.3" xref="S3.E2.m1.2.2.4.1.1.3.cmml"><mi id="S3.E2.m1.2.2.4.1.1.3.2" xref="S3.E2.m1.2.2.4.1.1.3.2.cmml">𝐏𝐄</mi><mi id="S3.E2.m1.2.2.4.1.1.3.3" xref="S3.E2.m1.2.2.4.1.1.3.3.cmml">n</mi></msub></mrow></mtd></mtr></mtable><mo id="S3.E2.m1.3.3.1.1.6.2.2" xref="S3.E2.m1.3.3.1.1.6.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E2.m1.3.3.1.2" xref="S3.E2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1"><and id="S3.E2.m1.3.3.1.1a.cmml" xref="S3.E2.m1.3.3.1"></and><apply id="S3.E2.m1.3.3.1.1b.cmml" xref="S3.E2.m1.3.3.1"><eq id="S3.E2.m1.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3"></eq><apply id="S3.E2.m1.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2">superscript</csymbol><ci id="S3.E2.m1.3.3.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2">𝐄</ci><ci id="S3.E2.m1.3.3.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.2.3">𝑢</ci></apply><apply id="S3.E2.m1.3.3.1.1.4.1.cmml" xref="S3.E2.m1.3.3.1.1.4.2"><csymbol cd="latexml" id="S3.E2.m1.3.3.1.1.4.1.1.cmml" xref="S3.E2.m1.3.3.1.1.4.2.1">delimited-[]</csymbol><matrix id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><matrixrow id="S3.E2.m1.1.1a.cmml" xref="S3.E2.m1.1.1"><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2.2">𝐞</ci><cn id="S3.E2.m1.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.E2.m1.1.1.1.1.1.2.3">1</cn></apply><ci id="S3.E2.m1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3">𝑢</ci></apply></matrixrow><matrixrow id="S3.E2.m1.1.1b.cmml" xref="S3.E2.m1.1.1"><apply id="S3.E2.m1.1.1.2.1.1.cmml" xref="S3.E2.m1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.2.1.1.1.cmml" xref="S3.E2.m1.1.1.2.1.1">superscript</csymbol><apply id="S3.E2.m1.1.1.2.1.1.2.cmml" xref="S3.E2.m1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.2.1.1.2.1.cmml" xref="S3.E2.m1.1.1.2.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.2.1.1.2.2.cmml" xref="S3.E2.m1.1.1.2.1.1.2.2">𝐞</ci><cn id="S3.E2.m1.1.1.2.1.1.2.3.cmml" type="integer" xref="S3.E2.m1.1.1.2.1.1.2.3">2</cn></apply><ci id="S3.E2.m1.1.1.2.1.1.3.cmml" xref="S3.E2.m1.1.1.2.1.1.3">𝑢</ci></apply></matrixrow><matrixrow id="S3.E2.m1.1.1c.cmml" xref="S3.E2.m1.1.1"><ci id="S3.E2.m1.1.1.3.1.1.cmml" xref="S3.E2.m1.1.1.3.1.1">⋮</ci></matrixrow><matrixrow id="S3.E2.m1.1.1d.cmml" xref="S3.E2.m1.1.1"><apply id="S3.E2.m1.1.1.4.1.1.cmml" xref="S3.E2.m1.1.1.4.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.4.1.1.1.cmml" xref="S3.E2.m1.1.1.4.1.1">superscript</csymbol><apply id="S3.E2.m1.1.1.4.1.1.2.cmml" xref="S3.E2.m1.1.1.4.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.4.1.1.2.1.cmml" xref="S3.E2.m1.1.1.4.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.4.1.1.2.2.cmml" xref="S3.E2.m1.1.1.4.1.1.2.2">𝐞</ci><ci id="S3.E2.m1.1.1.4.1.1.2.3.cmml" xref="S3.E2.m1.1.1.4.1.1.2.3">𝑛</ci></apply><ci id="S3.E2.m1.1.1.4.1.1.3.cmml" xref="S3.E2.m1.1.1.4.1.1.3">𝑢</ci></apply></matrixrow></matrix></apply></apply><apply id="S3.E2.m1.3.3.1.1c.cmml" xref="S3.E2.m1.3.3.1"><eq id="S3.E2.m1.3.3.1.1.5.cmml" xref="S3.E2.m1.3.3.1.1.5"></eq><share href="https://arxiv.org/html/2407.02833v1#S3.E2.m1.3.3.1.1.4.cmml" id="S3.E2.m1.3.3.1.1d.cmml" xref="S3.E2.m1.3.3.1"></share><apply id="S3.E2.m1.3.3.1.1.6.1.cmml" xref="S3.E2.m1.3.3.1.1.6.2"><csymbol cd="latexml" id="S3.E2.m1.3.3.1.1.6.1.1.cmml" xref="S3.E2.m1.3.3.1.1.6.2.1">delimited-[]</csymbol><matrix id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><matrixrow id="S3.E2.m1.2.2a.cmml" xref="S3.E2.m1.2.2"><apply id="S3.E2.m1.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1"><plus id="S3.E2.m1.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1"></plus><apply id="S3.E2.m1.2.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.2.2.1.1.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.2.2.2">𝐬</ci><cn id="S3.E2.m1.2.2.1.1.1.2.2.3.cmml" type="integer" xref="S3.E2.m1.2.2.1.1.1.2.2.3">1</cn></apply><ci id="S3.E2.m1.2.2.1.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.2.3">𝑢</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.3.2">𝐏𝐄</ci><cn id="S3.E2.m1.2.2.1.1.1.3.3.cmml" type="integer" xref="S3.E2.m1.2.2.1.1.1.3.3">1</cn></apply></apply></matrixrow><matrixrow id="S3.E2.m1.2.2b.cmml" xref="S3.E2.m1.2.2"><apply id="S3.E2.m1.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1"><plus id="S3.E2.m1.2.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1"></plus><apply id="S3.E2.m1.2.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.1.2.1.cmml" xref="S3.E2.m1.2.2.2.1.1.2">superscript</csymbol><apply id="S3.E2.m1.2.2.2.1.1.2.2.cmml" xref="S3.E2.m1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.1.2.2.1.cmml" xref="S3.E2.m1.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E2.m1.2.2.2.1.1.2.2.2.cmml" xref="S3.E2.m1.2.2.2.1.1.2.2.2">𝐬</ci><cn id="S3.E2.m1.2.2.2.1.1.2.2.3.cmml" type="integer" xref="S3.E2.m1.2.2.2.1.1.2.2.3">2</cn></apply><ci id="S3.E2.m1.2.2.2.1.1.2.3.cmml" xref="S3.E2.m1.2.2.2.1.1.2.3">𝑢</ci></apply><apply id="S3.E2.m1.2.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.1.3.1.cmml" xref="S3.E2.m1.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.2.1.1.3.2.cmml" xref="S3.E2.m1.2.2.2.1.1.3.2">𝐏𝐄</ci><cn id="S3.E2.m1.2.2.2.1.1.3.3.cmml" type="integer" xref="S3.E2.m1.2.2.2.1.1.3.3">2</cn></apply></apply></matrixrow><matrixrow id="S3.E2.m1.2.2c.cmml" xref="S3.E2.m1.2.2"><ci id="S3.E2.m1.2.2.3.1.1.cmml" xref="S3.E2.m1.2.2.3.1.1">⋮</ci></matrixrow><matrixrow id="S3.E2.m1.2.2d.cmml" xref="S3.E2.m1.2.2"><apply id="S3.E2.m1.2.2.4.1.1.cmml" xref="S3.E2.m1.2.2.4.1.1"><plus id="S3.E2.m1.2.2.4.1.1.1.cmml" xref="S3.E2.m1.2.2.4.1.1.1"></plus><apply id="S3.E2.m1.2.2.4.1.1.2.cmml" xref="S3.E2.m1.2.2.4.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.4.1.1.2.1.cmml" xref="S3.E2.m1.2.2.4.1.1.2">superscript</csymbol><apply id="S3.E2.m1.2.2.4.1.1.2.2.cmml" xref="S3.E2.m1.2.2.4.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.4.1.1.2.2.1.cmml" xref="S3.E2.m1.2.2.4.1.1.2">subscript</csymbol><ci id="S3.E2.m1.2.2.4.1.1.2.2.2.cmml" xref="S3.E2.m1.2.2.4.1.1.2.2.2">𝐬</ci><ci id="S3.E2.m1.2.2.4.1.1.2.2.3.cmml" xref="S3.E2.m1.2.2.4.1.1.2.2.3">𝑛</ci></apply><ci id="S3.E2.m1.2.2.4.1.1.2.3.cmml" xref="S3.E2.m1.2.2.4.1.1.2.3">𝑢</ci></apply><apply id="S3.E2.m1.2.2.4.1.1.3.cmml" xref="S3.E2.m1.2.2.4.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.4.1.1.3.1.cmml" xref="S3.E2.m1.2.2.4.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.4.1.1.3.2.cmml" xref="S3.E2.m1.2.2.4.1.1.3.2">𝐏𝐄</ci><ci id="S3.E2.m1.2.2.4.1.1.3.3.cmml" xref="S3.E2.m1.2.2.4.1.1.3.3">𝑛</ci></apply></apply></matrixrow></matrix></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">\mathbf{E}^{u}=\left[\begin{array}[]{c}\mathbf{e}_{1}^{u}\\
\mathbf{e}_{2}^{u}\\
\vdots\\
\mathbf{e}_{n}^{u}\end{array}\right]=\left[\begin{array}[]{c}\mathbf{s}_{1}^{u%
}+\mathbf{PE}_{1}\\
\mathbf{s}_{2}^{u}+\mathbf{PE}_{2}\\
\vdots\\
\mathbf{s}_{n}^{u}+\mathbf{PE}_{n}\end{array}\right],</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.3d">bold_E start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = [ start_ARRAY start_ROW start_CELL bold_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT end_CELL end_ROW start_ROW start_CELL bold_e start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT end_CELL end_ROW start_ROW start_CELL ⋮ end_CELL end_ROW start_ROW start_CELL bold_e start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT end_CELL end_ROW end_ARRAY ] = [ start_ARRAY start_ROW start_CELL bold_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT + bold_PE start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL bold_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT + bold_PE start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL ⋮ end_CELL end_ROW start_ROW start_CELL bold_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT + bold_PE start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_CELL end_ROW end_ARRAY ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS3.p5">
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Q}^{u}=\left[\begin{array}[]{c}\mathbf{q}_{1}^{u}\\
\mathbf{q}_{2}^{u}\\
\vdots\\
\mathbf{q}_{n}^{u}\end{array}\right]=\text{SASRec}_{\text{Adapted}}(\mathbf{E}%
^{u})," class="ltx_Math" display="block" id="S3.E3.m1.2"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml"><msup id="S3.E3.m1.2.2.1.1.3" xref="S3.E3.m1.2.2.1.1.3.cmml"><mi id="S3.E3.m1.2.2.1.1.3.2" xref="S3.E3.m1.2.2.1.1.3.2.cmml">𝐐</mi><mi id="S3.E3.m1.2.2.1.1.3.3" xref="S3.E3.m1.2.2.1.1.3.3.cmml">u</mi></msup><mo id="S3.E3.m1.2.2.1.1.4" xref="S3.E3.m1.2.2.1.1.4.cmml">=</mo><mrow id="S3.E3.m1.2.2.1.1.5.2" xref="S3.E3.m1.2.2.1.1.5.1.cmml"><mo id="S3.E3.m1.2.2.1.1.5.2.1" xref="S3.E3.m1.2.2.1.1.5.1.1.cmml">[</mo><mtable displaystyle="true" id="S3.E3.m1.1.1" rowspacing="0pt" xref="S3.E3.m1.1.1.cmml"><mtr id="S3.E3.m1.1.1a" xref="S3.E3.m1.1.1.cmml"><mtd id="S3.E3.m1.1.1b" xref="S3.E3.m1.1.1.cmml"><msubsup id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.2.2.cmml">𝐪</mi><mn id="S3.E3.m1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.2.3.cmml">1</mn><mi id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.3.cmml">u</mi></msubsup></mtd></mtr><mtr id="S3.E3.m1.1.1c" xref="S3.E3.m1.1.1.cmml"><mtd id="S3.E3.m1.1.1d" xref="S3.E3.m1.1.1.cmml"><msubsup id="S3.E3.m1.1.1.2.1.1" xref="S3.E3.m1.1.1.2.1.1.cmml"><mi id="S3.E3.m1.1.1.2.1.1.2.2" xref="S3.E3.m1.1.1.2.1.1.2.2.cmml">𝐪</mi><mn id="S3.E3.m1.1.1.2.1.1.2.3" xref="S3.E3.m1.1.1.2.1.1.2.3.cmml">2</mn><mi id="S3.E3.m1.1.1.2.1.1.3" xref="S3.E3.m1.1.1.2.1.1.3.cmml">u</mi></msubsup></mtd></mtr><mtr id="S3.E3.m1.1.1e" xref="S3.E3.m1.1.1.cmml"><mtd id="S3.E3.m1.1.1f" xref="S3.E3.m1.1.1.cmml"><mi id="S3.E3.m1.1.1.3.1.1" mathvariant="normal" xref="S3.E3.m1.1.1.3.1.1.cmml">⋮</mi></mtd></mtr><mtr id="S3.E3.m1.1.1g" xref="S3.E3.m1.1.1.cmml"><mtd id="S3.E3.m1.1.1h" xref="S3.E3.m1.1.1.cmml"><msubsup id="S3.E3.m1.1.1.4.1.1" xref="S3.E3.m1.1.1.4.1.1.cmml"><mi id="S3.E3.m1.1.1.4.1.1.2.2" xref="S3.E3.m1.1.1.4.1.1.2.2.cmml">𝐪</mi><mi id="S3.E3.m1.1.1.4.1.1.2.3" xref="S3.E3.m1.1.1.4.1.1.2.3.cmml">n</mi><mi id="S3.E3.m1.1.1.4.1.1.3" xref="S3.E3.m1.1.1.4.1.1.3.cmml">u</mi></msubsup></mtd></mtr></mtable><mo id="S3.E3.m1.2.2.1.1.5.2.2" xref="S3.E3.m1.2.2.1.1.5.1.1.cmml">]</mo></mrow><mo id="S3.E3.m1.2.2.1.1.6" xref="S3.E3.m1.2.2.1.1.6.cmml">=</mo><mrow id="S3.E3.m1.2.2.1.1.1" xref="S3.E3.m1.2.2.1.1.1.cmml"><msub id="S3.E3.m1.2.2.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.3.cmml"><mtext id="S3.E3.m1.2.2.1.1.1.3.2" xref="S3.E3.m1.2.2.1.1.1.3.2a.cmml">SASRec</mtext><mtext id="S3.E3.m1.2.2.1.1.1.3.3" xref="S3.E3.m1.2.2.1.1.1.3.3a.cmml">Adapted</mtext></msub><mo id="S3.E3.m1.2.2.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E3.m1.2.2.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.cmml">𝐄</mi><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S3.E3.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.2.2.1.2" xref="S3.E3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1"><and id="S3.E3.m1.2.2.1.1a.cmml" xref="S3.E3.m1.2.2.1"></and><apply id="S3.E3.m1.2.2.1.1b.cmml" xref="S3.E3.m1.2.2.1"><eq id="S3.E3.m1.2.2.1.1.4.cmml" xref="S3.E3.m1.2.2.1.1.4"></eq><apply id="S3.E3.m1.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.3">superscript</csymbol><ci id="S3.E3.m1.2.2.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.3.2">𝐐</ci><ci id="S3.E3.m1.2.2.1.1.3.3.cmml" xref="S3.E3.m1.2.2.1.1.3.3">𝑢</ci></apply><apply id="S3.E3.m1.2.2.1.1.5.1.cmml" xref="S3.E3.m1.2.2.1.1.5.2"><csymbol cd="latexml" id="S3.E3.m1.2.2.1.1.5.1.1.cmml" xref="S3.E3.m1.2.2.1.1.5.2.1">delimited-[]</csymbol><matrix id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><matrixrow id="S3.E3.m1.1.1a.cmml" xref="S3.E3.m1.1.1"><apply id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2.2">𝐪</ci><cn id="S3.E3.m1.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.2.3">1</cn></apply><ci id="S3.E3.m1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3">𝑢</ci></apply></matrixrow><matrixrow id="S3.E3.m1.1.1b.cmml" xref="S3.E3.m1.1.1"><apply id="S3.E3.m1.1.1.2.1.1.cmml" xref="S3.E3.m1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.2.1.1.1.cmml" xref="S3.E3.m1.1.1.2.1.1">superscript</csymbol><apply id="S3.E3.m1.1.1.2.1.1.2.cmml" xref="S3.E3.m1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.2.1.1.2.1.cmml" xref="S3.E3.m1.1.1.2.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.2.1.1.2.2.cmml" xref="S3.E3.m1.1.1.2.1.1.2.2">𝐪</ci><cn id="S3.E3.m1.1.1.2.1.1.2.3.cmml" type="integer" xref="S3.E3.m1.1.1.2.1.1.2.3">2</cn></apply><ci id="S3.E3.m1.1.1.2.1.1.3.cmml" xref="S3.E3.m1.1.1.2.1.1.3">𝑢</ci></apply></matrixrow><matrixrow id="S3.E3.m1.1.1c.cmml" xref="S3.E3.m1.1.1"><ci id="S3.E3.m1.1.1.3.1.1.cmml" xref="S3.E3.m1.1.1.3.1.1">⋮</ci></matrixrow><matrixrow id="S3.E3.m1.1.1d.cmml" xref="S3.E3.m1.1.1"><apply id="S3.E3.m1.1.1.4.1.1.cmml" xref="S3.E3.m1.1.1.4.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.4.1.1.1.cmml" xref="S3.E3.m1.1.1.4.1.1">superscript</csymbol><apply id="S3.E3.m1.1.1.4.1.1.2.cmml" xref="S3.E3.m1.1.1.4.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.4.1.1.2.1.cmml" xref="S3.E3.m1.1.1.4.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.4.1.1.2.2.cmml" xref="S3.E3.m1.1.1.4.1.1.2.2">𝐪</ci><ci id="S3.E3.m1.1.1.4.1.1.2.3.cmml" xref="S3.E3.m1.1.1.4.1.1.2.3">𝑛</ci></apply><ci id="S3.E3.m1.1.1.4.1.1.3.cmml" xref="S3.E3.m1.1.1.4.1.1.3">𝑢</ci></apply></matrixrow></matrix></apply></apply><apply id="S3.E3.m1.2.2.1.1c.cmml" xref="S3.E3.m1.2.2.1"><eq id="S3.E3.m1.2.2.1.1.6.cmml" xref="S3.E3.m1.2.2.1.1.6"></eq><share href="https://arxiv.org/html/2407.02833v1#S3.E3.m1.2.2.1.1.5.cmml" id="S3.E3.m1.2.2.1.1d.cmml" xref="S3.E3.m1.2.2.1"></share><apply id="S3.E3.m1.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1"><times id="S3.E3.m1.2.2.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.2"></times><apply id="S3.E3.m1.2.2.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.3.2a.cmml" xref="S3.E3.m1.2.2.1.1.1.3.2"><mtext id="S3.E3.m1.2.2.1.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.3.2">SASRec</mtext></ci><ci id="S3.E3.m1.2.2.1.1.1.3.3a.cmml" xref="S3.E3.m1.2.2.1.1.1.3.3"><mtext id="S3.E3.m1.2.2.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E3.m1.2.2.1.1.1.3.3">Adapted</mtext></ci></apply><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2">𝐄</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3">𝑢</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\mathbf{Q}^{u}=\left[\begin{array}[]{c}\mathbf{q}_{1}^{u}\\
\mathbf{q}_{2}^{u}\\
\vdots\\
\mathbf{q}_{n}^{u}\end{array}\right]=\text{SASRec}_{\text{Adapted}}(\mathbf{E}%
^{u}),</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.2d">bold_Q start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = [ start_ARRAY start_ROW start_CELL bold_q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT end_CELL end_ROW start_ROW start_CELL bold_q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT end_CELL end_ROW start_ROW start_CELL ⋮ end_CELL end_ROW start_ROW start_CELL bold_q start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT end_CELL end_ROW end_ARRAY ] = SASRec start_POSTSUBSCRIPT Adapted end_POSTSUBSCRIPT ( bold_E start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS3.p6">
<p class="ltx_p" id="S3.SS2.SSS3.p6.10">where <math alttext="\mathbf{PE}_{t}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p6.1.m1.1"><semantics id="S3.SS2.SSS3.p6.1.m1.1a"><mrow id="S3.SS2.SSS3.p6.1.m1.1.1" xref="S3.SS2.SSS3.p6.1.m1.1.1.cmml"><msub id="S3.SS2.SSS3.p6.1.m1.1.1.2" xref="S3.SS2.SSS3.p6.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS3.p6.1.m1.1.1.2.2" xref="S3.SS2.SSS3.p6.1.m1.1.1.2.2.cmml">𝐏𝐄</mi><mi id="S3.SS2.SSS3.p6.1.m1.1.1.2.3" xref="S3.SS2.SSS3.p6.1.m1.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS2.SSS3.p6.1.m1.1.1.1" xref="S3.SS2.SSS3.p6.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS3.p6.1.m1.1.1.3" xref="S3.SS2.SSS3.p6.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS3.p6.1.m1.1.1.3.2" xref="S3.SS2.SSS3.p6.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.SSS3.p6.1.m1.1.1.3.3" xref="S3.SS2.SSS3.p6.1.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p6.1.m1.1b"><apply id="S3.SS2.SSS3.p6.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p6.1.m1.1.1"><in id="S3.SS2.SSS3.p6.1.m1.1.1.1.cmml" xref="S3.SS2.SSS3.p6.1.m1.1.1.1"></in><apply id="S3.SS2.SSS3.p6.1.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p6.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p6.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS3.p6.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS3.p6.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS3.p6.1.m1.1.1.2.2">𝐏𝐄</ci><ci id="S3.SS2.SSS3.p6.1.m1.1.1.2.3.cmml" xref="S3.SS2.SSS3.p6.1.m1.1.1.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS3.p6.1.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p6.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p6.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS3.p6.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS3.p6.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS3.p6.1.m1.1.1.3.2">ℝ</ci><ci id="S3.SS2.SSS3.p6.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS3.p6.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p6.1.m1.1c">\mathbf{PE}_{t}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p6.1.m1.1d">bold_PE start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the positional encoding at time step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p6.2.m2.1"><semantics id="S3.SS2.SSS3.p6.2.m2.1a"><mi id="S3.SS2.SSS3.p6.2.m2.1.1" xref="S3.SS2.SSS3.p6.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p6.2.m2.1b"><ci id="S3.SS2.SSS3.p6.2.m2.1.1.cmml" xref="S3.SS2.SSS3.p6.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p6.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p6.2.m2.1d">italic_t</annotation></semantics></math> in the sequence, <math alttext="\mathbf{E}^{u}\in\mathbb{R}^{n\times d}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p6.3.m3.1"><semantics id="S3.SS2.SSS3.p6.3.m3.1a"><mrow id="S3.SS2.SSS3.p6.3.m3.1.1" xref="S3.SS2.SSS3.p6.3.m3.1.1.cmml"><msup id="S3.SS2.SSS3.p6.3.m3.1.1.2" xref="S3.SS2.SSS3.p6.3.m3.1.1.2.cmml"><mi id="S3.SS2.SSS3.p6.3.m3.1.1.2.2" xref="S3.SS2.SSS3.p6.3.m3.1.1.2.2.cmml">𝐄</mi><mi id="S3.SS2.SSS3.p6.3.m3.1.1.2.3" xref="S3.SS2.SSS3.p6.3.m3.1.1.2.3.cmml">u</mi></msup><mo id="S3.SS2.SSS3.p6.3.m3.1.1.1" xref="S3.SS2.SSS3.p6.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS3.p6.3.m3.1.1.3" xref="S3.SS2.SSS3.p6.3.m3.1.1.3.cmml"><mi id="S3.SS2.SSS3.p6.3.m3.1.1.3.2" xref="S3.SS2.SSS3.p6.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS3.p6.3.m3.1.1.3.3" xref="S3.SS2.SSS3.p6.3.m3.1.1.3.3.cmml"><mi id="S3.SS2.SSS3.p6.3.m3.1.1.3.3.2" xref="S3.SS2.SSS3.p6.3.m3.1.1.3.3.2.cmml">n</mi><mo id="S3.SS2.SSS3.p6.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS3.p6.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS3.p6.3.m3.1.1.3.3.3" xref="S3.SS2.SSS3.p6.3.m3.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p6.3.m3.1b"><apply id="S3.SS2.SSS3.p6.3.m3.1.1.cmml" xref="S3.SS2.SSS3.p6.3.m3.1.1"><in id="S3.SS2.SSS3.p6.3.m3.1.1.1.cmml" xref="S3.SS2.SSS3.p6.3.m3.1.1.1"></in><apply id="S3.SS2.SSS3.p6.3.m3.1.1.2.cmml" xref="S3.SS2.SSS3.p6.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p6.3.m3.1.1.2.1.cmml" xref="S3.SS2.SSS3.p6.3.m3.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS3.p6.3.m3.1.1.2.2.cmml" xref="S3.SS2.SSS3.p6.3.m3.1.1.2.2">𝐄</ci><ci id="S3.SS2.SSS3.p6.3.m3.1.1.2.3.cmml" xref="S3.SS2.SSS3.p6.3.m3.1.1.2.3">𝑢</ci></apply><apply id="S3.SS2.SSS3.p6.3.m3.1.1.3.cmml" xref="S3.SS2.SSS3.p6.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p6.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS3.p6.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS3.p6.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS3.p6.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS3.p6.3.m3.1.1.3.3.cmml" xref="S3.SS2.SSS3.p6.3.m3.1.1.3.3"><times id="S3.SS2.SSS3.p6.3.m3.1.1.3.3.1.cmml" xref="S3.SS2.SSS3.p6.3.m3.1.1.3.3.1"></times><ci id="S3.SS2.SSS3.p6.3.m3.1.1.3.3.2.cmml" xref="S3.SS2.SSS3.p6.3.m3.1.1.3.3.2">𝑛</ci><ci id="S3.SS2.SSS3.p6.3.m3.1.1.3.3.3.cmml" xref="S3.SS2.SSS3.p6.3.m3.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p6.3.m3.1c">\mathbf{E}^{u}\in\mathbb{R}^{n\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p6.3.m3.1d">bold_E start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the input embedding matrix of the interaction sequence for user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p6.4.m4.1"><semantics id="S3.SS2.SSS3.p6.4.m4.1a"><mi id="S3.SS2.SSS3.p6.4.m4.1.1" xref="S3.SS2.SSS3.p6.4.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p6.4.m4.1b"><ci id="S3.SS2.SSS3.p6.4.m4.1.1.cmml" xref="S3.SS2.SSS3.p6.4.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p6.4.m4.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p6.4.m4.1d">italic_u</annotation></semantics></math>, <math alttext="\text{SASRec}_{\text{Adapted}}(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p6.5.m5.1"><semantics id="S3.SS2.SSS3.p6.5.m5.1a"><mrow id="S3.SS2.SSS3.p6.5.m5.1.2" xref="S3.SS2.SSS3.p6.5.m5.1.2.cmml"><msub id="S3.SS2.SSS3.p6.5.m5.1.2.2" xref="S3.SS2.SSS3.p6.5.m5.1.2.2.cmml"><mtext id="S3.SS2.SSS3.p6.5.m5.1.2.2.2" xref="S3.SS2.SSS3.p6.5.m5.1.2.2.2a.cmml">SASRec</mtext><mtext id="S3.SS2.SSS3.p6.5.m5.1.2.2.3" xref="S3.SS2.SSS3.p6.5.m5.1.2.2.3a.cmml">Adapted</mtext></msub><mo id="S3.SS2.SSS3.p6.5.m5.1.2.1" xref="S3.SS2.SSS3.p6.5.m5.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS3.p6.5.m5.1.2.3.2" xref="S3.SS2.SSS3.p6.5.m5.1.2.cmml"><mo id="S3.SS2.SSS3.p6.5.m5.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS3.p6.5.m5.1.2.cmml">(</mo><mo id="S3.SS2.SSS3.p6.5.m5.1.1" lspace="0em" rspace="0em" xref="S3.SS2.SSS3.p6.5.m5.1.1.cmml">⋅</mo><mo id="S3.SS2.SSS3.p6.5.m5.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS3.p6.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p6.5.m5.1b"><apply id="S3.SS2.SSS3.p6.5.m5.1.2.cmml" xref="S3.SS2.SSS3.p6.5.m5.1.2"><times id="S3.SS2.SSS3.p6.5.m5.1.2.1.cmml" xref="S3.SS2.SSS3.p6.5.m5.1.2.1"></times><apply id="S3.SS2.SSS3.p6.5.m5.1.2.2.cmml" xref="S3.SS2.SSS3.p6.5.m5.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p6.5.m5.1.2.2.1.cmml" xref="S3.SS2.SSS3.p6.5.m5.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS3.p6.5.m5.1.2.2.2a.cmml" xref="S3.SS2.SSS3.p6.5.m5.1.2.2.2"><mtext id="S3.SS2.SSS3.p6.5.m5.1.2.2.2.cmml" xref="S3.SS2.SSS3.p6.5.m5.1.2.2.2">SASRec</mtext></ci><ci id="S3.SS2.SSS3.p6.5.m5.1.2.2.3a.cmml" xref="S3.SS2.SSS3.p6.5.m5.1.2.2.3"><mtext id="S3.SS2.SSS3.p6.5.m5.1.2.2.3.cmml" mathsize="70%" xref="S3.SS2.SSS3.p6.5.m5.1.2.2.3">Adapted</mtext></ci></apply><ci id="S3.SS2.SSS3.p6.5.m5.1.1.cmml" xref="S3.SS2.SSS3.p6.5.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p6.5.m5.1c">\text{SASRec}_{\text{Adapted}}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p6.5.m5.1d">SASRec start_POSTSUBSCRIPT Adapted end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> denotes the SASRec model adapted after modifications, <math alttext="\mathbf{Q}^{u}\in\mathbb{R}^{n\times d}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p6.6.m6.1"><semantics id="S3.SS2.SSS3.p6.6.m6.1a"><mrow id="S3.SS2.SSS3.p6.6.m6.1.1" xref="S3.SS2.SSS3.p6.6.m6.1.1.cmml"><msup id="S3.SS2.SSS3.p6.6.m6.1.1.2" xref="S3.SS2.SSS3.p6.6.m6.1.1.2.cmml"><mi id="S3.SS2.SSS3.p6.6.m6.1.1.2.2" xref="S3.SS2.SSS3.p6.6.m6.1.1.2.2.cmml">𝐐</mi><mi id="S3.SS2.SSS3.p6.6.m6.1.1.2.3" xref="S3.SS2.SSS3.p6.6.m6.1.1.2.3.cmml">u</mi></msup><mo id="S3.SS2.SSS3.p6.6.m6.1.1.1" xref="S3.SS2.SSS3.p6.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS3.p6.6.m6.1.1.3" xref="S3.SS2.SSS3.p6.6.m6.1.1.3.cmml"><mi id="S3.SS2.SSS3.p6.6.m6.1.1.3.2" xref="S3.SS2.SSS3.p6.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS3.p6.6.m6.1.1.3.3" xref="S3.SS2.SSS3.p6.6.m6.1.1.3.3.cmml"><mi id="S3.SS2.SSS3.p6.6.m6.1.1.3.3.2" xref="S3.SS2.SSS3.p6.6.m6.1.1.3.3.2.cmml">n</mi><mo id="S3.SS2.SSS3.p6.6.m6.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS3.p6.6.m6.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS3.p6.6.m6.1.1.3.3.3" xref="S3.SS2.SSS3.p6.6.m6.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p6.6.m6.1b"><apply id="S3.SS2.SSS3.p6.6.m6.1.1.cmml" xref="S3.SS2.SSS3.p6.6.m6.1.1"><in id="S3.SS2.SSS3.p6.6.m6.1.1.1.cmml" xref="S3.SS2.SSS3.p6.6.m6.1.1.1"></in><apply id="S3.SS2.SSS3.p6.6.m6.1.1.2.cmml" xref="S3.SS2.SSS3.p6.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p6.6.m6.1.1.2.1.cmml" xref="S3.SS2.SSS3.p6.6.m6.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS3.p6.6.m6.1.1.2.2.cmml" xref="S3.SS2.SSS3.p6.6.m6.1.1.2.2">𝐐</ci><ci id="S3.SS2.SSS3.p6.6.m6.1.1.2.3.cmml" xref="S3.SS2.SSS3.p6.6.m6.1.1.2.3">𝑢</ci></apply><apply id="S3.SS2.SSS3.p6.6.m6.1.1.3.cmml" xref="S3.SS2.SSS3.p6.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p6.6.m6.1.1.3.1.cmml" xref="S3.SS2.SSS3.p6.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS3.p6.6.m6.1.1.3.2.cmml" xref="S3.SS2.SSS3.p6.6.m6.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS3.p6.6.m6.1.1.3.3.cmml" xref="S3.SS2.SSS3.p6.6.m6.1.1.3.3"><times id="S3.SS2.SSS3.p6.6.m6.1.1.3.3.1.cmml" xref="S3.SS2.SSS3.p6.6.m6.1.1.3.3.1"></times><ci id="S3.SS2.SSS3.p6.6.m6.1.1.3.3.2.cmml" xref="S3.SS2.SSS3.p6.6.m6.1.1.3.3.2">𝑛</ci><ci id="S3.SS2.SSS3.p6.6.m6.1.1.3.3.3.cmml" xref="S3.SS2.SSS3.p6.6.m6.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p6.6.m6.1c">\mathbf{Q}^{u}\in\mathbb{R}^{n\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p6.6.m6.1d">bold_Q start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the feature matrix of the interaction sequence for user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p6.7.m7.1"><semantics id="S3.SS2.SSS3.p6.7.m7.1a"><mi id="S3.SS2.SSS3.p6.7.m7.1.1" xref="S3.SS2.SSS3.p6.7.m7.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p6.7.m7.1b"><ci id="S3.SS2.SSS3.p6.7.m7.1.1.cmml" xref="S3.SS2.SSS3.p6.7.m7.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p6.7.m7.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p6.7.m7.1d">italic_u</annotation></semantics></math>, and <math alttext="\mathbf{q}_{t}^{u}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p6.8.m8.1"><semantics id="S3.SS2.SSS3.p6.8.m8.1a"><mrow id="S3.SS2.SSS3.p6.8.m8.1.1" xref="S3.SS2.SSS3.p6.8.m8.1.1.cmml"><msubsup id="S3.SS2.SSS3.p6.8.m8.1.1.2" xref="S3.SS2.SSS3.p6.8.m8.1.1.2.cmml"><mi id="S3.SS2.SSS3.p6.8.m8.1.1.2.2.2" xref="S3.SS2.SSS3.p6.8.m8.1.1.2.2.2.cmml">𝐪</mi><mi id="S3.SS2.SSS3.p6.8.m8.1.1.2.2.3" xref="S3.SS2.SSS3.p6.8.m8.1.1.2.2.3.cmml">t</mi><mi id="S3.SS2.SSS3.p6.8.m8.1.1.2.3" xref="S3.SS2.SSS3.p6.8.m8.1.1.2.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS3.p6.8.m8.1.1.1" xref="S3.SS2.SSS3.p6.8.m8.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS3.p6.8.m8.1.1.3" xref="S3.SS2.SSS3.p6.8.m8.1.1.3.cmml"><mi id="S3.SS2.SSS3.p6.8.m8.1.1.3.2" xref="S3.SS2.SSS3.p6.8.m8.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.SSS3.p6.8.m8.1.1.3.3" xref="S3.SS2.SSS3.p6.8.m8.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p6.8.m8.1b"><apply id="S3.SS2.SSS3.p6.8.m8.1.1.cmml" xref="S3.SS2.SSS3.p6.8.m8.1.1"><in id="S3.SS2.SSS3.p6.8.m8.1.1.1.cmml" xref="S3.SS2.SSS3.p6.8.m8.1.1.1"></in><apply id="S3.SS2.SSS3.p6.8.m8.1.1.2.cmml" xref="S3.SS2.SSS3.p6.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p6.8.m8.1.1.2.1.cmml" xref="S3.SS2.SSS3.p6.8.m8.1.1.2">superscript</csymbol><apply id="S3.SS2.SSS3.p6.8.m8.1.1.2.2.cmml" xref="S3.SS2.SSS3.p6.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p6.8.m8.1.1.2.2.1.cmml" xref="S3.SS2.SSS3.p6.8.m8.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS3.p6.8.m8.1.1.2.2.2.cmml" xref="S3.SS2.SSS3.p6.8.m8.1.1.2.2.2">𝐪</ci><ci id="S3.SS2.SSS3.p6.8.m8.1.1.2.2.3.cmml" xref="S3.SS2.SSS3.p6.8.m8.1.1.2.2.3">𝑡</ci></apply><ci id="S3.SS2.SSS3.p6.8.m8.1.1.2.3.cmml" xref="S3.SS2.SSS3.p6.8.m8.1.1.2.3">𝑢</ci></apply><apply id="S3.SS2.SSS3.p6.8.m8.1.1.3.cmml" xref="S3.SS2.SSS3.p6.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p6.8.m8.1.1.3.1.cmml" xref="S3.SS2.SSS3.p6.8.m8.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS3.p6.8.m8.1.1.3.2.cmml" xref="S3.SS2.SSS3.p6.8.m8.1.1.3.2">ℝ</ci><ci id="S3.SS2.SSS3.p6.8.m8.1.1.3.3.cmml" xref="S3.SS2.SSS3.p6.8.m8.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p6.8.m8.1c">\mathbf{q}_{t}^{u}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p6.8.m8.1d">bold_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the feature vector of the subsequence consisting of the first <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p6.9.m9.1"><semantics id="S3.SS2.SSS3.p6.9.m9.1a"><mi id="S3.SS2.SSS3.p6.9.m9.1.1" xref="S3.SS2.SSS3.p6.9.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p6.9.m9.1b"><ci id="S3.SS2.SSS3.p6.9.m9.1.1.cmml" xref="S3.SS2.SSS3.p6.9.m9.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p6.9.m9.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p6.9.m9.1d">italic_t</annotation></semantics></math> items for user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p6.10.m10.1"><semantics id="S3.SS2.SSS3.p6.10.m10.1a"><mi id="S3.SS2.SSS3.p6.10.m10.1.1" xref="S3.SS2.SSS3.p6.10.m10.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p6.10.m10.1b"><ci id="S3.SS2.SSS3.p6.10.m10.1.1.cmml" xref="S3.SS2.SSS3.p6.10.m10.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p6.10.m10.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p6.10.m10.1d">italic_u</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.4 </span>Users’ Multi-Preferences Generation Module</h4>
<div class="ltx_para" id="S3.SS2.SSS4.p1">
<p class="ltx_p" id="S3.SS2.SSS4.p1.1">In recent years, significant breakthroughs have been achieved in natural language model research, leading to the emergence of many large-scale models with outstanding language understanding and generation capabilities. These models have been widely applied across various domains, including recommendation systems. GPT is a notable representative in this regard. Given LLM’s remarkable In-Context Learning (ICL) ability <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib5" title="">5</a>]</cite>, we leverage zero-shot prompting to guide LLM in extracting features from user interaction sequences and generating human-understandable feature texts—Multi-Preferences. To achieve this, we design a zero-shot prompt template to capture the Multi-Preferences contained in user historical interaction sequences, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S3.F2" title="Figure 2 ‣ 3.2.4 Users’ Multi-Preferences Generation Module ‣ 3.2 LANE ‣ 3 Methodology ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="723" id="S3.F2.g1" src="x2.png" width="789"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The zero-shot prompt template. It consists of five components and fills in a user interaction sequence in the Steam dataset as an example, where <math alttext="n" class="ltx_Math" display="inline" id="S3.F2.2.m1.1"><semantics id="S3.F2.2.m1.1b"><mi id="S3.F2.2.m1.1.1" xref="S3.F2.2.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.F2.2.m1.1c"><ci id="S3.F2.2.m1.1.1.cmml" xref="S3.F2.2.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.2.m1.1d">n</annotation><annotation encoding="application/x-llamapun" id="S3.F2.2.m1.1e">italic_n</annotation></semantics></math> refers to the number of user preferences.</figcaption>
</figure>
<div class="ltx_para" id="S3.SS2.SSS4.p2">
<p class="ltx_p" id="S3.SS2.SSS4.p2.1">The prompt template is composed of five components: Task, Role, Requirements, Standard Template, and Historical Interaction Sequence. In the Task component, we briefly describe the task we need the large model to accomplish. In the Role component, we specify the role of the large model as a “seasoned expert in analyzing and capturing user preferences” to enhance its performance. In the Requirements component, we detail the requirements that LLM needs to follow when completing the specified task, including supplementary item-related information and more diverse preferences. The Standard Template and Historical Interaction Sequence components provide the standard style of LLM’s response and the users’ historical interaction sequence, respectively.</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="306" id="S3.F3.g1" src="x3.png" width="581"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>An example of users’ multi-preferences. It was generated by GPT under the guidance of a zero-shot prompt template, where the number of user preferences <math alttext="n" class="ltx_Math" display="inline" id="S3.F3.2.m1.1"><semantics id="S3.F3.2.m1.1b"><mi id="S3.F3.2.m1.1.1" xref="S3.F3.2.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.F3.2.m1.1c"><ci id="S3.F3.2.m1.1.1.cmml" xref="S3.F3.2.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.2.m1.1d">n</annotation><annotation encoding="application/x-llamapun" id="S3.F3.2.m1.1e">italic_n</annotation></semantics></math> is equal to 5.</figcaption>
</figure>
<div class="ltx_para" id="S3.SS2.SSS4.p3">
<p class="ltx_p" id="S3.SS2.SSS4.p3.1">Utilizing this prompt template, we can guide the LLM model to generate users’ multi-preferences, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S3.F3" title="Figure 3 ‣ 3.2.4 Users’ Multi-Preferences Generation Module ‣ 3.2 LANE ‣ 3 Methodology ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_tag">3</span></a>. Subsequently, by feeding the users’ multiple preferences into the TextEncoder mentioned in Section <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S3.SS2.SSS2" title="3.2.2 Semantic Embedding Module ‣ 3.2 LANE ‣ 3 Methodology ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_tag">3.2.2</span></a>, we can obtain embedding vectors of the users’ multi-preferences. This process can be expressed by the following formulas:</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS4.p4">
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Preference}^{u}=\text{LLM}({\text{prompt}}_{p}(S^{u}))," class="ltx_Math" display="block" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><msup id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.cmml"><mtext id="S3.E4.m1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.3.2a.cmml">Preference</mtext><mi id="S3.E4.m1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.3.3.cmml">u</mi></msup><mo id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml"><mtext id="S3.E4.m1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.3a.cmml">LLM</mtext><mo id="S3.E4.m1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.cmml"><mtext id="S3.E4.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.2a.cmml">prompt</mtext><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.3.cmml">p</mi></msub><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">S</mi><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2"></eq><apply id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.2a.cmml" xref="S3.E4.m1.1.1.1.1.3.2"><mtext id="S3.E4.m1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2">Preference</mtext></ci><ci id="S3.E4.m1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3">𝑢</ci></apply><apply id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.2"></times><ci id="S3.E4.m1.1.1.1.1.1.3a.cmml" xref="S3.E4.m1.1.1.1.1.1.3"><mtext id="S3.E4.m1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3">LLM</mtext></ci><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.3.2a.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.2"><mtext id="S3.E4.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.2">prompt</mtext></ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.3">𝑝</ci></apply><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝑆</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑢</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\text{Preference}^{u}=\text{LLM}({\text{prompt}}_{p}(S^{u})),</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">Preference start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = LLM ( prompt start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS4.p5">
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{P}^{u}=\text{TextEncoder}(\text{Preference}^{u})," class="ltx_Math" display="block" id="S3.E5.m1.1"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><msup id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.3.2.cmml">𝐏</mi><mi id="S3.E5.m1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.3.3.cmml">u</mi></msup><mo id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml"><mtext id="S3.E5.m1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.3a.cmml">TextEncoder</mtext><mo id="S3.E5.m1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E5.m1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E5.m1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2a.cmml">Preference</mtext><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S3.E5.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><eq id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2"></eq><apply id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2">𝐏</ci><ci id="S3.E5.m1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3">𝑢</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2"></times><ci id="S3.E5.m1.1.1.1.1.1.3a.cmml" xref="S3.E5.m1.1.1.1.1.1.3"><mtext id="S3.E5.m1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.3">TextEncoder</mtext></ci><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.2a.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2"><mtext id="S3.E5.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2">Preference</mtext></ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\mathbf{P}^{u}=\text{TextEncoder}(\text{Preference}^{u}),</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.1d">bold_P start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = TextEncoder ( Preference start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS4.p6">
<p class="ltx_p" id="S3.SS2.SSS4.p6.8">where <math alttext="\text{LLM}(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.SSS4.p6.1.m1.1"><semantics id="S3.SS2.SSS4.p6.1.m1.1a"><mrow id="S3.SS2.SSS4.p6.1.m1.1.2" xref="S3.SS2.SSS4.p6.1.m1.1.2.cmml"><mtext id="S3.SS2.SSS4.p6.1.m1.1.2.2" xref="S3.SS2.SSS4.p6.1.m1.1.2.2a.cmml">LLM</mtext><mo id="S3.SS2.SSS4.p6.1.m1.1.2.1" xref="S3.SS2.SSS4.p6.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS4.p6.1.m1.1.2.3.2" xref="S3.SS2.SSS4.p6.1.m1.1.2.cmml"><mo id="S3.SS2.SSS4.p6.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS4.p6.1.m1.1.2.cmml">(</mo><mo id="S3.SS2.SSS4.p6.1.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS2.SSS4.p6.1.m1.1.1.cmml">⋅</mo><mo id="S3.SS2.SSS4.p6.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS4.p6.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS4.p6.1.m1.1b"><apply id="S3.SS2.SSS4.p6.1.m1.1.2.cmml" xref="S3.SS2.SSS4.p6.1.m1.1.2"><times id="S3.SS2.SSS4.p6.1.m1.1.2.1.cmml" xref="S3.SS2.SSS4.p6.1.m1.1.2.1"></times><ci id="S3.SS2.SSS4.p6.1.m1.1.2.2a.cmml" xref="S3.SS2.SSS4.p6.1.m1.1.2.2"><mtext id="S3.SS2.SSS4.p6.1.m1.1.2.2.cmml" xref="S3.SS2.SSS4.p6.1.m1.1.2.2">LLM</mtext></ci><ci id="S3.SS2.SSS4.p6.1.m1.1.1.cmml" xref="S3.SS2.SSS4.p6.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS4.p6.1.m1.1c">\text{LLM}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS4.p6.1.m1.1d">LLM ( ⋅ )</annotation></semantics></math> denotes the generation of LLM model, <math alttext="{\text{prompt}}_{p}(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.SSS4.p6.2.m2.1"><semantics id="S3.SS2.SSS4.p6.2.m2.1a"><mrow id="S3.SS2.SSS4.p6.2.m2.1.2" xref="S3.SS2.SSS4.p6.2.m2.1.2.cmml"><msub id="S3.SS2.SSS4.p6.2.m2.1.2.2" xref="S3.SS2.SSS4.p6.2.m2.1.2.2.cmml"><mtext id="S3.SS2.SSS4.p6.2.m2.1.2.2.2" xref="S3.SS2.SSS4.p6.2.m2.1.2.2.2a.cmml">prompt</mtext><mi id="S3.SS2.SSS4.p6.2.m2.1.2.2.3" xref="S3.SS2.SSS4.p6.2.m2.1.2.2.3.cmml">p</mi></msub><mo id="S3.SS2.SSS4.p6.2.m2.1.2.1" xref="S3.SS2.SSS4.p6.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS4.p6.2.m2.1.2.3.2" xref="S3.SS2.SSS4.p6.2.m2.1.2.cmml"><mo id="S3.SS2.SSS4.p6.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS4.p6.2.m2.1.2.cmml">(</mo><mo id="S3.SS2.SSS4.p6.2.m2.1.1" lspace="0em" rspace="0em" xref="S3.SS2.SSS4.p6.2.m2.1.1.cmml">⋅</mo><mo id="S3.SS2.SSS4.p6.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS4.p6.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS4.p6.2.m2.1b"><apply id="S3.SS2.SSS4.p6.2.m2.1.2.cmml" xref="S3.SS2.SSS4.p6.2.m2.1.2"><times id="S3.SS2.SSS4.p6.2.m2.1.2.1.cmml" xref="S3.SS2.SSS4.p6.2.m2.1.2.1"></times><apply id="S3.SS2.SSS4.p6.2.m2.1.2.2.cmml" xref="S3.SS2.SSS4.p6.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS4.p6.2.m2.1.2.2.1.cmml" xref="S3.SS2.SSS4.p6.2.m2.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS4.p6.2.m2.1.2.2.2a.cmml" xref="S3.SS2.SSS4.p6.2.m2.1.2.2.2"><mtext id="S3.SS2.SSS4.p6.2.m2.1.2.2.2.cmml" xref="S3.SS2.SSS4.p6.2.m2.1.2.2.2">prompt</mtext></ci><ci id="S3.SS2.SSS4.p6.2.m2.1.2.2.3.cmml" xref="S3.SS2.SSS4.p6.2.m2.1.2.2.3">𝑝</ci></apply><ci id="S3.SS2.SSS4.p6.2.m2.1.1.cmml" xref="S3.SS2.SSS4.p6.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS4.p6.2.m2.1c">{\text{prompt}}_{p}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS4.p6.2.m2.1d">prompt start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> denotes the zero-shot prompt template, <math alttext="\text{Preference}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS4.p6.3.m3.1"><semantics id="S3.SS2.SSS4.p6.3.m3.1a"><msup id="S3.SS2.SSS4.p6.3.m3.1.1" xref="S3.SS2.SSS4.p6.3.m3.1.1.cmml"><mtext id="S3.SS2.SSS4.p6.3.m3.1.1.2" xref="S3.SS2.SSS4.p6.3.m3.1.1.2a.cmml">Preference</mtext><mi id="S3.SS2.SSS4.p6.3.m3.1.1.3" xref="S3.SS2.SSS4.p6.3.m3.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS4.p6.3.m3.1b"><apply id="S3.SS2.SSS4.p6.3.m3.1.1.cmml" xref="S3.SS2.SSS4.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS4.p6.3.m3.1.1.1.cmml" xref="S3.SS2.SSS4.p6.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.SSS4.p6.3.m3.1.1.2a.cmml" xref="S3.SS2.SSS4.p6.3.m3.1.1.2"><mtext id="S3.SS2.SSS4.p6.3.m3.1.1.2.cmml" xref="S3.SS2.SSS4.p6.3.m3.1.1.2">Preference</mtext></ci><ci id="S3.SS2.SSS4.p6.3.m3.1.1.3.cmml" xref="S3.SS2.SSS4.p6.3.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS4.p6.3.m3.1c">\text{Preference}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS4.p6.3.m3.1d">Preference start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the <math alttext="m" class="ltx_Math" display="inline" id="S3.SS2.SSS4.p6.4.m4.1"><semantics id="S3.SS2.SSS4.p6.4.m4.1a"><mi id="S3.SS2.SSS4.p6.4.m4.1.1" xref="S3.SS2.SSS4.p6.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS4.p6.4.m4.1b"><ci id="S3.SS2.SSS4.p6.4.m4.1.1.cmml" xref="S3.SS2.SSS4.p6.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS4.p6.4.m4.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS4.p6.4.m4.1d">italic_m</annotation></semantics></math> preferences of user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS2.SSS4.p6.5.m5.1"><semantics id="S3.SS2.SSS4.p6.5.m5.1a"><mi id="S3.SS2.SSS4.p6.5.m5.1.1" xref="S3.SS2.SSS4.p6.5.m5.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS4.p6.5.m5.1b"><ci id="S3.SS2.SSS4.p6.5.m5.1.1.cmml" xref="S3.SS2.SSS4.p6.5.m5.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS4.p6.5.m5.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS4.p6.5.m5.1d">italic_u</annotation></semantics></math>, <math alttext="\mathbf{P}^{u}\in\mathbb{R}^{m\times d}" class="ltx_Math" display="inline" id="S3.SS2.SSS4.p6.6.m6.1"><semantics id="S3.SS2.SSS4.p6.6.m6.1a"><mrow id="S3.SS2.SSS4.p6.6.m6.1.1" xref="S3.SS2.SSS4.p6.6.m6.1.1.cmml"><msup id="S3.SS2.SSS4.p6.6.m6.1.1.2" xref="S3.SS2.SSS4.p6.6.m6.1.1.2.cmml"><mi id="S3.SS2.SSS4.p6.6.m6.1.1.2.2" xref="S3.SS2.SSS4.p6.6.m6.1.1.2.2.cmml">𝐏</mi><mi id="S3.SS2.SSS4.p6.6.m6.1.1.2.3" xref="S3.SS2.SSS4.p6.6.m6.1.1.2.3.cmml">u</mi></msup><mo id="S3.SS2.SSS4.p6.6.m6.1.1.1" xref="S3.SS2.SSS4.p6.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS4.p6.6.m6.1.1.3" xref="S3.SS2.SSS4.p6.6.m6.1.1.3.cmml"><mi id="S3.SS2.SSS4.p6.6.m6.1.1.3.2" xref="S3.SS2.SSS4.p6.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS4.p6.6.m6.1.1.3.3" xref="S3.SS2.SSS4.p6.6.m6.1.1.3.3.cmml"><mi id="S3.SS2.SSS4.p6.6.m6.1.1.3.3.2" xref="S3.SS2.SSS4.p6.6.m6.1.1.3.3.2.cmml">m</mi><mo id="S3.SS2.SSS4.p6.6.m6.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS4.p6.6.m6.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS4.p6.6.m6.1.1.3.3.3" xref="S3.SS2.SSS4.p6.6.m6.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS4.p6.6.m6.1b"><apply id="S3.SS2.SSS4.p6.6.m6.1.1.cmml" xref="S3.SS2.SSS4.p6.6.m6.1.1"><in id="S3.SS2.SSS4.p6.6.m6.1.1.1.cmml" xref="S3.SS2.SSS4.p6.6.m6.1.1.1"></in><apply id="S3.SS2.SSS4.p6.6.m6.1.1.2.cmml" xref="S3.SS2.SSS4.p6.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS4.p6.6.m6.1.1.2.1.cmml" xref="S3.SS2.SSS4.p6.6.m6.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS4.p6.6.m6.1.1.2.2.cmml" xref="S3.SS2.SSS4.p6.6.m6.1.1.2.2">𝐏</ci><ci id="S3.SS2.SSS4.p6.6.m6.1.1.2.3.cmml" xref="S3.SS2.SSS4.p6.6.m6.1.1.2.3">𝑢</ci></apply><apply id="S3.SS2.SSS4.p6.6.m6.1.1.3.cmml" xref="S3.SS2.SSS4.p6.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS4.p6.6.m6.1.1.3.1.cmml" xref="S3.SS2.SSS4.p6.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS4.p6.6.m6.1.1.3.2.cmml" xref="S3.SS2.SSS4.p6.6.m6.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS4.p6.6.m6.1.1.3.3.cmml" xref="S3.SS2.SSS4.p6.6.m6.1.1.3.3"><times id="S3.SS2.SSS4.p6.6.m6.1.1.3.3.1.cmml" xref="S3.SS2.SSS4.p6.6.m6.1.1.3.3.1"></times><ci id="S3.SS2.SSS4.p6.6.m6.1.1.3.3.2.cmml" xref="S3.SS2.SSS4.p6.6.m6.1.1.3.3.2">𝑚</ci><ci id="S3.SS2.SSS4.p6.6.m6.1.1.3.3.3.cmml" xref="S3.SS2.SSS4.p6.6.m6.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS4.p6.6.m6.1c">\mathbf{P}^{u}\in\mathbb{R}^{m\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS4.p6.6.m6.1d">bold_P start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the embedding vectors of the <math alttext="m" class="ltx_Math" display="inline" id="S3.SS2.SSS4.p6.7.m7.1"><semantics id="S3.SS2.SSS4.p6.7.m7.1a"><mi id="S3.SS2.SSS4.p6.7.m7.1.1" xref="S3.SS2.SSS4.p6.7.m7.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS4.p6.7.m7.1b"><ci id="S3.SS2.SSS4.p6.7.m7.1.1.cmml" xref="S3.SS2.SSS4.p6.7.m7.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS4.p6.7.m7.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS4.p6.7.m7.1d">italic_m</annotation></semantics></math> preferences of user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS2.SSS4.p6.8.m8.1"><semantics id="S3.SS2.SSS4.p6.8.m8.1a"><mi id="S3.SS2.SSS4.p6.8.m8.1.1" xref="S3.SS2.SSS4.p6.8.m8.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS4.p6.8.m8.1b"><ci id="S3.SS2.SSS4.p6.8.m8.1.1.cmml" xref="S3.SS2.SSS4.p6.8.m8.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS4.p6.8.m8.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS4.p6.8.m8.1d">italic_u</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS5">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.5 </span>Semantic Alignment Module</h4>
<div class="ltx_para" id="S3.SS2.SSS5.p1">
<p class="ltx_p" id="S3.SS2.SSS5.p1.1">The lack of explainability in the recommendation results of the “black box” recommendation model stems from our inability to explain the sequence feature vectors it outputs. To achieve explainability in recommendation results, it is formally equivalent to finding an explainable alignment vector to replace the sequence feature vectors output by the “black box” recommender. This alignment vector would then undergo similarity calculations with the embedding vectors of candidate items to generate ranking scores. The generation of this alignment vector can be facilitated through a semantic alignment module.</p>
</div>
<section class="ltx_paragraph" id="S3.SS2.SSS5.Px1">
<h5 class="ltx_title ltx_title_paragraph">Multi-Head Attention.</h5>
<div class="ltx_para" id="S3.SS2.SSS5.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS5.Px1.p1.1">The multi-head attention mechanism can calculates semantic similarities between queries and keys and generates corresponding attention weights based on these similarities, which are then used to weight and sum the values <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib47" title="">47</a>]</cite>. Leveraging the characteristics of multi-head attention, we treat the two sets of vectors that need alignment as queries and key-value pairs, enabling semantic alignment between these two sets of vectors.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS5.Px1.p2">
<p class="ltx_p" id="S3.SS2.SSS5.Px1.p2.9">In the multi-head attention layer, we employ the scaled dot-product attention, defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Attention}(\mathbf{Q},\mathbf{K},\mathbf{V})=\text{softmax}\left(\frac{%
\mathbf{Q}\mathbf{K}^{T}}{\sqrt{d_{k}}}\right)\mathbf{V}," class="ltx_Math" display="block" id="S3.E6.m1.5"><semantics id="S3.E6.m1.5a"><mrow id="S3.E6.m1.5.5.1" xref="S3.E6.m1.5.5.1.1.cmml"><mrow id="S3.E6.m1.5.5.1.1" xref="S3.E6.m1.5.5.1.1.cmml"><mrow id="S3.E6.m1.5.5.1.1.2" xref="S3.E6.m1.5.5.1.1.2.cmml"><mtext id="S3.E6.m1.5.5.1.1.2.2" xref="S3.E6.m1.5.5.1.1.2.2a.cmml">Attention</mtext><mo id="S3.E6.m1.5.5.1.1.2.1" xref="S3.E6.m1.5.5.1.1.2.1.cmml">⁢</mo><mrow id="S3.E6.m1.5.5.1.1.2.3.2" xref="S3.E6.m1.5.5.1.1.2.3.1.cmml"><mo id="S3.E6.m1.5.5.1.1.2.3.2.1" stretchy="false" xref="S3.E6.m1.5.5.1.1.2.3.1.cmml">(</mo><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">𝐐</mi><mo id="S3.E6.m1.5.5.1.1.2.3.2.2" xref="S3.E6.m1.5.5.1.1.2.3.1.cmml">,</mo><mi id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">𝐊</mi><mo id="S3.E6.m1.5.5.1.1.2.3.2.3" xref="S3.E6.m1.5.5.1.1.2.3.1.cmml">,</mo><mi id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml">𝐕</mi><mo id="S3.E6.m1.5.5.1.1.2.3.2.4" stretchy="false" xref="S3.E6.m1.5.5.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.5.5.1.1.1" xref="S3.E6.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E6.m1.5.5.1.1.3" xref="S3.E6.m1.5.5.1.1.3.cmml"><mtext id="S3.E6.m1.5.5.1.1.3.2" xref="S3.E6.m1.5.5.1.1.3.2a.cmml">softmax</mtext><mo id="S3.E6.m1.5.5.1.1.3.1" xref="S3.E6.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S3.E6.m1.5.5.1.1.3.3.2" xref="S3.E6.m1.4.4.cmml"><mo id="S3.E6.m1.5.5.1.1.3.3.2.1" xref="S3.E6.m1.4.4.cmml">(</mo><mfrac id="S3.E6.m1.4.4" xref="S3.E6.m1.4.4.cmml"><msup id="S3.E6.m1.4.4.2" xref="S3.E6.m1.4.4.2.cmml"><mi id="S3.E6.m1.4.4.2.2" xref="S3.E6.m1.4.4.2.2.cmml">𝐐𝐊</mi><mi id="S3.E6.m1.4.4.2.3" xref="S3.E6.m1.4.4.2.3.cmml">T</mi></msup><msqrt id="S3.E6.m1.4.4.3" xref="S3.E6.m1.4.4.3.cmml"><msub id="S3.E6.m1.4.4.3.2" xref="S3.E6.m1.4.4.3.2.cmml"><mi id="S3.E6.m1.4.4.3.2.2" xref="S3.E6.m1.4.4.3.2.2.cmml">d</mi><mi id="S3.E6.m1.4.4.3.2.3" xref="S3.E6.m1.4.4.3.2.3.cmml">k</mi></msub></msqrt></mfrac><mo id="S3.E6.m1.5.5.1.1.3.3.2.2" xref="S3.E6.m1.4.4.cmml">)</mo></mrow><mo id="S3.E6.m1.5.5.1.1.3.1a" xref="S3.E6.m1.5.5.1.1.3.1.cmml">⁢</mo><mi id="S3.E6.m1.5.5.1.1.3.4" xref="S3.E6.m1.5.5.1.1.3.4.cmml">𝐕</mi></mrow></mrow><mo id="S3.E6.m1.5.5.1.2" xref="S3.E6.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.5b"><apply id="S3.E6.m1.5.5.1.1.cmml" xref="S3.E6.m1.5.5.1"><eq id="S3.E6.m1.5.5.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1"></eq><apply id="S3.E6.m1.5.5.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.2"><times id="S3.E6.m1.5.5.1.1.2.1.cmml" xref="S3.E6.m1.5.5.1.1.2.1"></times><ci id="S3.E6.m1.5.5.1.1.2.2a.cmml" xref="S3.E6.m1.5.5.1.1.2.2"><mtext id="S3.E6.m1.5.5.1.1.2.2.cmml" xref="S3.E6.m1.5.5.1.1.2.2">Attention</mtext></ci><vector id="S3.E6.m1.5.5.1.1.2.3.1.cmml" xref="S3.E6.m1.5.5.1.1.2.3.2"><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝐐</ci><ci id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">𝐊</ci><ci id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3">𝐕</ci></vector></apply><apply id="S3.E6.m1.5.5.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.3"><times id="S3.E6.m1.5.5.1.1.3.1.cmml" xref="S3.E6.m1.5.5.1.1.3.1"></times><ci id="S3.E6.m1.5.5.1.1.3.2a.cmml" xref="S3.E6.m1.5.5.1.1.3.2"><mtext id="S3.E6.m1.5.5.1.1.3.2.cmml" xref="S3.E6.m1.5.5.1.1.3.2">softmax</mtext></ci><apply id="S3.E6.m1.4.4.cmml" xref="S3.E6.m1.5.5.1.1.3.3.2"><divide id="S3.E6.m1.4.4.1.cmml" xref="S3.E6.m1.5.5.1.1.3.3.2"></divide><apply id="S3.E6.m1.4.4.2.cmml" xref="S3.E6.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.2.1.cmml" xref="S3.E6.m1.4.4.2">superscript</csymbol><ci id="S3.E6.m1.4.4.2.2.cmml" xref="S3.E6.m1.4.4.2.2">𝐐𝐊</ci><ci id="S3.E6.m1.4.4.2.3.cmml" xref="S3.E6.m1.4.4.2.3">𝑇</ci></apply><apply id="S3.E6.m1.4.4.3.cmml" xref="S3.E6.m1.4.4.3"><root id="S3.E6.m1.4.4.3a.cmml" xref="S3.E6.m1.4.4.3"></root><apply id="S3.E6.m1.4.4.3.2.cmml" xref="S3.E6.m1.4.4.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.3.2.1.cmml" xref="S3.E6.m1.4.4.3.2">subscript</csymbol><ci id="S3.E6.m1.4.4.3.2.2.cmml" xref="S3.E6.m1.4.4.3.2.2">𝑑</ci><ci id="S3.E6.m1.4.4.3.2.3.cmml" xref="S3.E6.m1.4.4.3.2.3">𝑘</ci></apply></apply></apply><ci id="S3.E6.m1.5.5.1.1.3.4.cmml" xref="S3.E6.m1.5.5.1.1.3.4">𝐕</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.5c">\text{Attention}(\mathbf{Q},\mathbf{K},\mathbf{V})=\text{softmax}\left(\frac{%
\mathbf{Q}\mathbf{K}^{T}}{\sqrt{d_{k}}}\right)\mathbf{V},</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.5d">Attention ( bold_Q , bold_K , bold_V ) = softmax ( divide start_ARG bold_QK start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG end_ARG ) bold_V ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS5.Px1.p2.8">where <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p2.1.m1.1"><semantics id="S3.SS2.SSS5.Px1.p2.1.m1.1a"><mi id="S3.SS2.SSS5.Px1.p2.1.m1.1.1" xref="S3.SS2.SSS5.Px1.p2.1.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p2.1.m1.1b"><ci id="S3.SS2.SSS5.Px1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS5.Px1.p2.1.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p2.1.m1.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p2.1.m1.1d">bold_Q</annotation></semantics></math> denotes queries, and <math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p2.2.m2.1"><semantics id="S3.SS2.SSS5.Px1.p2.2.m2.1a"><mi id="S3.SS2.SSS5.Px1.p2.2.m2.1.1" xref="S3.SS2.SSS5.Px1.p2.2.m2.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p2.2.m2.1b"><ci id="S3.SS2.SSS5.Px1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS5.Px1.p2.2.m2.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p2.2.m2.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p2.2.m2.1d">bold_K</annotation></semantics></math> and <math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p2.3.m3.1"><semantics id="S3.SS2.SSS5.Px1.p2.3.m3.1a"><mi id="S3.SS2.SSS5.Px1.p2.3.m3.1.1" xref="S3.SS2.SSS5.Px1.p2.3.m3.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p2.3.m3.1b"><ci id="S3.SS2.SSS5.Px1.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS5.Px1.p2.3.m3.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p2.3.m3.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p2.3.m3.1d">bold_V</annotation></semantics></math> denotes keys and values, respectively. <math alttext="\sqrt{d_{k}}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p2.4.m4.1"><semantics id="S3.SS2.SSS5.Px1.p2.4.m4.1a"><msqrt id="S3.SS2.SSS5.Px1.p2.4.m4.1.1" xref="S3.SS2.SSS5.Px1.p2.4.m4.1.1.cmml"><msub id="S3.SS2.SSS5.Px1.p2.4.m4.1.1.2" xref="S3.SS2.SSS5.Px1.p2.4.m4.1.1.2.cmml"><mi id="S3.SS2.SSS5.Px1.p2.4.m4.1.1.2.2" xref="S3.SS2.SSS5.Px1.p2.4.m4.1.1.2.2.cmml">d</mi><mi id="S3.SS2.SSS5.Px1.p2.4.m4.1.1.2.3" xref="S3.SS2.SSS5.Px1.p2.4.m4.1.1.2.3.cmml">k</mi></msub></msqrt><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p2.4.m4.1b"><apply id="S3.SS2.SSS5.Px1.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS5.Px1.p2.4.m4.1.1"><root id="S3.SS2.SSS5.Px1.p2.4.m4.1.1a.cmml" xref="S3.SS2.SSS5.Px1.p2.4.m4.1.1"></root><apply id="S3.SS2.SSS5.Px1.p2.4.m4.1.1.2.cmml" xref="S3.SS2.SSS5.Px1.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p2.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS5.Px1.p2.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS5.Px1.p2.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS5.Px1.p2.4.m4.1.1.2.2">𝑑</ci><ci id="S3.SS2.SSS5.Px1.p2.4.m4.1.1.2.3.cmml" xref="S3.SS2.SSS5.Px1.p2.4.m4.1.1.2.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p2.4.m4.1c">\sqrt{d_{k}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p2.4.m4.1d">square-root start_ARG italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> denotes the scaling factor. The multi-head attention mechanism performs the scaled dot-product attention function multiple times on <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p2.5.m5.1"><semantics id="S3.SS2.SSS5.Px1.p2.5.m5.1a"><mi id="S3.SS2.SSS5.Px1.p2.5.m5.1.1" xref="S3.SS2.SSS5.Px1.p2.5.m5.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p2.5.m5.1b"><ci id="S3.SS2.SSS5.Px1.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS5.Px1.p2.5.m5.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p2.5.m5.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p2.5.m5.1d">bold_Q</annotation></semantics></math>, <math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p2.6.m6.1"><semantics id="S3.SS2.SSS5.Px1.p2.6.m6.1a"><mi id="S3.SS2.SSS5.Px1.p2.6.m6.1.1" xref="S3.SS2.SSS5.Px1.p2.6.m6.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p2.6.m6.1b"><ci id="S3.SS2.SSS5.Px1.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS5.Px1.p2.6.m6.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p2.6.m6.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p2.6.m6.1d">bold_K</annotation></semantics></math>, and <math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p2.7.m7.1"><semantics id="S3.SS2.SSS5.Px1.p2.7.m7.1a"><mi id="S3.SS2.SSS5.Px1.p2.7.m7.1.1" xref="S3.SS2.SSS5.Px1.p2.7.m7.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p2.7.m7.1b"><ci id="S3.SS2.SSS5.Px1.p2.7.m7.1.1.cmml" xref="S3.SS2.SSS5.Px1.p2.7.m7.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p2.7.m7.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p2.7.m7.1d">bold_K</annotation></semantics></math> across the <math alttext="d_{k}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p2.8.m8.1"><semantics id="S3.SS2.SSS5.Px1.p2.8.m8.1a"><msub id="S3.SS2.SSS5.Px1.p2.8.m8.1.1" xref="S3.SS2.SSS5.Px1.p2.8.m8.1.1.cmml"><mi id="S3.SS2.SSS5.Px1.p2.8.m8.1.1.2" xref="S3.SS2.SSS5.Px1.p2.8.m8.1.1.2.cmml">d</mi><mi id="S3.SS2.SSS5.Px1.p2.8.m8.1.1.3" xref="S3.SS2.SSS5.Px1.p2.8.m8.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p2.8.m8.1b"><apply id="S3.SS2.SSS5.Px1.p2.8.m8.1.1.cmml" xref="S3.SS2.SSS5.Px1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p2.8.m8.1.1.1.cmml" xref="S3.SS2.SSS5.Px1.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.SSS5.Px1.p2.8.m8.1.1.2.cmml" xref="S3.SS2.SSS5.Px1.p2.8.m8.1.1.2">𝑑</ci><ci id="S3.SS2.SSS5.Px1.p2.8.m8.1.1.3.cmml" xref="S3.SS2.SSS5.Px1.p2.8.m8.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p2.8.m8.1c">d_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p2.8.m8.1d">italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> dimension, concatenates the outputs of these parallel single attention layers, and then performs linear projection. This can be expressed as:</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS5.Px1.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Multihead}(\mathbf{Q},\mathbf{K},\mathbf{V})=\text{Concat}(\text{head}_{%
1},\ldots,\text{head}_{h})W^{o}," class="ltx_Math" display="block" id="S3.E7.m1.5"><semantics id="S3.E7.m1.5a"><mrow id="S3.E7.m1.5.5.1" xref="S3.E7.m1.5.5.1.1.cmml"><mrow id="S3.E7.m1.5.5.1.1" xref="S3.E7.m1.5.5.1.1.cmml"><mrow id="S3.E7.m1.5.5.1.1.4" xref="S3.E7.m1.5.5.1.1.4.cmml"><mtext id="S3.E7.m1.5.5.1.1.4.2" xref="S3.E7.m1.5.5.1.1.4.2a.cmml">Multihead</mtext><mo id="S3.E7.m1.5.5.1.1.4.1" xref="S3.E7.m1.5.5.1.1.4.1.cmml">⁢</mo><mrow id="S3.E7.m1.5.5.1.1.4.3.2" xref="S3.E7.m1.5.5.1.1.4.3.1.cmml"><mo id="S3.E7.m1.5.5.1.1.4.3.2.1" stretchy="false" xref="S3.E7.m1.5.5.1.1.4.3.1.cmml">(</mo><mi id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml">𝐐</mi><mo id="S3.E7.m1.5.5.1.1.4.3.2.2" xref="S3.E7.m1.5.5.1.1.4.3.1.cmml">,</mo><mi id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml">𝐊</mi><mo id="S3.E7.m1.5.5.1.1.4.3.2.3" xref="S3.E7.m1.5.5.1.1.4.3.1.cmml">,</mo><mi id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3.cmml">𝐕</mi><mo id="S3.E7.m1.5.5.1.1.4.3.2.4" stretchy="false" xref="S3.E7.m1.5.5.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.5.5.1.1.3" xref="S3.E7.m1.5.5.1.1.3.cmml">=</mo><mrow id="S3.E7.m1.5.5.1.1.2" xref="S3.E7.m1.5.5.1.1.2.cmml"><mtext id="S3.E7.m1.5.5.1.1.2.4" xref="S3.E7.m1.5.5.1.1.2.4a.cmml">Concat</mtext><mo id="S3.E7.m1.5.5.1.1.2.3" xref="S3.E7.m1.5.5.1.1.2.3.cmml">⁢</mo><mrow id="S3.E7.m1.5.5.1.1.2.2.2" xref="S3.E7.m1.5.5.1.1.2.2.3.cmml"><mo id="S3.E7.m1.5.5.1.1.2.2.2.3" stretchy="false" xref="S3.E7.m1.5.5.1.1.2.2.3.cmml">(</mo><msub id="S3.E7.m1.5.5.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.cmml"><mtext id="S3.E7.m1.5.5.1.1.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2a.cmml">head</mtext><mn id="S3.E7.m1.5.5.1.1.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E7.m1.5.5.1.1.2.2.2.4" xref="S3.E7.m1.5.5.1.1.2.2.3.cmml">,</mo><mi id="S3.E7.m1.4.4" mathvariant="normal" xref="S3.E7.m1.4.4.cmml">…</mi><mo id="S3.E7.m1.5.5.1.1.2.2.2.5" xref="S3.E7.m1.5.5.1.1.2.2.3.cmml">,</mo><msub id="S3.E7.m1.5.5.1.1.2.2.2.2" xref="S3.E7.m1.5.5.1.1.2.2.2.2.cmml"><mtext id="S3.E7.m1.5.5.1.1.2.2.2.2.2" xref="S3.E7.m1.5.5.1.1.2.2.2.2.2a.cmml">head</mtext><mi id="S3.E7.m1.5.5.1.1.2.2.2.2.3" xref="S3.E7.m1.5.5.1.1.2.2.2.2.3.cmml">h</mi></msub><mo id="S3.E7.m1.5.5.1.1.2.2.2.6" stretchy="false" xref="S3.E7.m1.5.5.1.1.2.2.3.cmml">)</mo></mrow><mo id="S3.E7.m1.5.5.1.1.2.3a" xref="S3.E7.m1.5.5.1.1.2.3.cmml">⁢</mo><msup id="S3.E7.m1.5.5.1.1.2.5" xref="S3.E7.m1.5.5.1.1.2.5.cmml"><mi id="S3.E7.m1.5.5.1.1.2.5.2" xref="S3.E7.m1.5.5.1.1.2.5.2.cmml">W</mi><mi id="S3.E7.m1.5.5.1.1.2.5.3" xref="S3.E7.m1.5.5.1.1.2.5.3.cmml">o</mi></msup></mrow></mrow><mo id="S3.E7.m1.5.5.1.2" xref="S3.E7.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.5b"><apply id="S3.E7.m1.5.5.1.1.cmml" xref="S3.E7.m1.5.5.1"><eq id="S3.E7.m1.5.5.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.3"></eq><apply id="S3.E7.m1.5.5.1.1.4.cmml" xref="S3.E7.m1.5.5.1.1.4"><times id="S3.E7.m1.5.5.1.1.4.1.cmml" xref="S3.E7.m1.5.5.1.1.4.1"></times><ci id="S3.E7.m1.5.5.1.1.4.2a.cmml" xref="S3.E7.m1.5.5.1.1.4.2"><mtext id="S3.E7.m1.5.5.1.1.4.2.cmml" xref="S3.E7.m1.5.5.1.1.4.2">Multihead</mtext></ci><vector id="S3.E7.m1.5.5.1.1.4.3.1.cmml" xref="S3.E7.m1.5.5.1.1.4.3.2"><ci id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1">𝐐</ci><ci id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2">𝐊</ci><ci id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3">𝐕</ci></vector></apply><apply id="S3.E7.m1.5.5.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.2"><times id="S3.E7.m1.5.5.1.1.2.3.cmml" xref="S3.E7.m1.5.5.1.1.2.3"></times><ci id="S3.E7.m1.5.5.1.1.2.4a.cmml" xref="S3.E7.m1.5.5.1.1.2.4"><mtext id="S3.E7.m1.5.5.1.1.2.4.cmml" xref="S3.E7.m1.5.5.1.1.2.4">Concat</mtext></ci><vector id="S3.E7.m1.5.5.1.1.2.2.3.cmml" xref="S3.E7.m1.5.5.1.1.2.2.2"><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.2a.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2"><mtext id="S3.E7.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2">head</mtext></ci><cn id="S3.E7.m1.5.5.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E7.m1.5.5.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.E7.m1.4.4.cmml" xref="S3.E7.m1.4.4">…</ci><apply id="S3.E7.m1.5.5.1.1.2.2.2.2.cmml" xref="S3.E7.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S3.E7.m1.5.5.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.2.2.2.2.2a.cmml" xref="S3.E7.m1.5.5.1.1.2.2.2.2.2"><mtext id="S3.E7.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S3.E7.m1.5.5.1.1.2.2.2.2.2">head</mtext></ci><ci id="S3.E7.m1.5.5.1.1.2.2.2.2.3.cmml" xref="S3.E7.m1.5.5.1.1.2.2.2.2.3">ℎ</ci></apply></vector><apply id="S3.E7.m1.5.5.1.1.2.5.cmml" xref="S3.E7.m1.5.5.1.1.2.5"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.2.5.1.cmml" xref="S3.E7.m1.5.5.1.1.2.5">superscript</csymbol><ci id="S3.E7.m1.5.5.1.1.2.5.2.cmml" xref="S3.E7.m1.5.5.1.1.2.5.2">𝑊</ci><ci id="S3.E7.m1.5.5.1.1.2.5.3.cmml" xref="S3.E7.m1.5.5.1.1.2.5.3">𝑜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.5c">\text{Multihead}(\mathbf{Q},\mathbf{K},\mathbf{V})=\text{Concat}(\text{head}_{%
1},\ldots,\text{head}_{h})W^{o},</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.5d">Multihead ( bold_Q , bold_K , bold_V ) = Concat ( head start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , head start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) italic_W start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS5.Px1.1">
<p class="ltx_p ltx_align_center" id="S3.SS2.SSS5.Px1.1.1">where <math alttext="\text{head}_{i}=\text{Attention}(\mathbf{Q}\mathbf{W}_{i}^{Q},\mathbf{K}%
\mathbf{W}_{i}^{K},\mathbf{V}\mathbf{W}_{i}^{V})" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.1.1.m1.3"><semantics id="S3.SS2.SSS5.Px1.1.1.m1.3a"><mrow id="S3.SS2.SSS5.Px1.1.1.m1.3.3" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.cmml"><msub id="S3.SS2.SSS5.Px1.1.1.m1.3.3.5" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.5.cmml"><mtext id="S3.SS2.SSS5.Px1.1.1.m1.3.3.5.2" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.5.2a.cmml">head</mtext><mi id="S3.SS2.SSS5.Px1.1.1.m1.3.3.5.3" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.5.3.cmml">i</mi></msub><mo id="S3.SS2.SSS5.Px1.1.1.m1.3.3.4" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.4.cmml">=</mo><mrow id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.cmml"><mtext id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.5" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.5a.cmml">Attention</mtext><mo id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.4" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.4.cmml">⁢</mo><mrow id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.4.cmml"><mo id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.4" stretchy="false" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.4.cmml">(</mo><msubsup id="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1" xref="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1.2.2" xref="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1.2.2.cmml">𝐐𝐖</mi><mi id="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1.2.3" xref="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1.3" xref="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1.3.cmml">Q</mi></msubsup><mo id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.5" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2" xref="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2.2.2" xref="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2.2.2.cmml">𝐊𝐖</mi><mi id="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2.2.3" xref="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2.2.3.cmml">i</mi><mi id="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2.3" xref="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2.3.cmml">K</mi></msubsup><mo id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.6" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3.cmml"><mi id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3.2.2" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3.2.2.cmml">𝐕𝐖</mi><mi id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3.2.3" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3.2.3.cmml">i</mi><mi id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3.3" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3.3.cmml">V</mi></msubsup><mo id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.7" stretchy="false" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.1.1.m1.3b"><apply id="S3.SS2.SSS5.Px1.1.1.m1.3.3.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3"><eq id="S3.SS2.SSS5.Px1.1.1.m1.3.3.4.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.4"></eq><apply id="S3.SS2.SSS5.Px1.1.1.m1.3.3.5.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.5"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.1.1.m1.3.3.5.1.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.5">subscript</csymbol><ci id="S3.SS2.SSS5.Px1.1.1.m1.3.3.5.2a.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.5.2"><mtext id="S3.SS2.SSS5.Px1.1.1.m1.3.3.5.2.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.5.2">head</mtext></ci><ci id="S3.SS2.SSS5.Px1.1.1.m1.3.3.5.3.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.5.3">𝑖</ci></apply><apply id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3"><times id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.4.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.4"></times><ci id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.5a.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.5"><mtext id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.5.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.5">Attention</mtext></ci><vector id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.4.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3"><apply id="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1.2.2">𝐐𝐖</ci><ci id="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.1.1.1.1.1.1.3">𝑄</ci></apply><apply id="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2.2.2">𝐊𝐖</ci><ci id="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.2.2.2.2.2.2.3">𝐾</ci></apply><apply id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3.1.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3">superscript</csymbol><apply id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3.2.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3.2.1.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3.2.2.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3.2.2">𝐕𝐖</ci><ci id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3.2.3.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3.3.cmml" xref="S3.SS2.SSS5.Px1.1.1.m1.3.3.3.3.3.3.3">𝑉</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.1.1.m1.3c">\text{head}_{i}=\text{Attention}(\mathbf{Q}\mathbf{W}_{i}^{Q},\mathbf{K}%
\mathbf{W}_{i}^{K},\mathbf{V}\mathbf{W}_{i}^{V})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.1.1.m1.3d">head start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = Attention ( bold_QW start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT , bold_KW start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT , bold_VW start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT )</annotation></semantics></math>,</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS5.Px1.p4">
<p class="ltx_p" id="S3.SS2.SSS5.Px1.p4.13">where <math alttext="\mathbf{W}_{i}^{Q}\in\mathbb{R}^{d\times d_{k}}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p4.1.m1.1"><semantics id="S3.SS2.SSS5.Px1.p4.1.m1.1a"><mrow id="S3.SS2.SSS5.Px1.p4.1.m1.1.1" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.cmml"><msubsup id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2.2.2" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2.2.2.cmml">𝐖</mi><mi id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2.2.3" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2.2.3.cmml">i</mi><mi id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2.3" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2.3.cmml">Q</mi></msubsup><mo id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.1" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.2" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.2" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.2.cmml">d</mi><mo id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.3" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.3.2" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.3.3" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p4.1.m1.1b"><apply id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1"><in id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.1"></in><apply id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2.cmml" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2">superscript</csymbol><apply id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2.2.1.cmml" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2.2.2.cmml" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2.2.2">𝐖</ci><ci id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2.2.3.cmml" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2.3.cmml" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.2.3">𝑄</ci></apply><apply id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.cmml" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3"><times id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.1"></times><ci id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.2">𝑑</ci><apply id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS5.Px1.p4.1.m1.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p4.1.m1.1c">\mathbf{W}_{i}^{Q}\in\mathbb{R}^{d\times d_{k}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p4.1.m1.1d">bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{W}_{i}^{K}\in\mathbb{R}^{d\times d_{k}}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p4.2.m2.1"><semantics id="S3.SS2.SSS5.Px1.p4.2.m2.1a"><mrow id="S3.SS2.SSS5.Px1.p4.2.m2.1.1" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.cmml"><msubsup id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2.cmml"><mi id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2.2.2" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2.2.2.cmml">𝐖</mi><mi id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2.2.3" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2.2.3.cmml">i</mi><mi id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2.3" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2.3.cmml">K</mi></msubsup><mo id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.1" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.2" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.cmml"><mi id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.2" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.2.cmml">d</mi><mo id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.3" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.3.2" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.3.3" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p4.2.m2.1b"><apply id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1"><in id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.1"></in><apply id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2.cmml" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2">superscript</csymbol><apply id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2.2.1.cmml" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2.2.2.cmml" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2.2.2">𝐖</ci><ci id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2.2.3.cmml" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2.3.cmml" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.2.3">𝐾</ci></apply><apply id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.cmml" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3"><times id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.1"></times><ci id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.2">𝑑</ci><apply id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS5.Px1.p4.2.m2.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p4.2.m2.1c">\mathbf{W}_{i}^{K}\in\mathbb{R}^{d\times d_{k}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p4.2.m2.1d">bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{W}_{i}^{V}\in\mathbb{R}^{d\times d_{k}}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p4.3.m3.1"><semantics id="S3.SS2.SSS5.Px1.p4.3.m3.1a"><mrow id="S3.SS2.SSS5.Px1.p4.3.m3.1.1" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.cmml"><msubsup id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2.cmml"><mi id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2.2.2" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2.2.2.cmml">𝐖</mi><mi id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2.2.3" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2.2.3.cmml">i</mi><mi id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2.3" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2.3.cmml">V</mi></msubsup><mo id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.1" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.cmml"><mi id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.2" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.cmml"><mi id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.2" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.2.cmml">d</mi><mo id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.3" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.3.2" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.3.3" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p4.3.m3.1b"><apply id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1"><in id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.1"></in><apply id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2.cmml" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2.1.cmml" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2">superscript</csymbol><apply id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2.2.cmml" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2.2.1.cmml" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2.2.2.cmml" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2.2.2">𝐖</ci><ci id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2.2.3.cmml" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2.3.cmml" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.2.3">𝑉</ci></apply><apply id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.cmml" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.cmml" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3"><times id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.1.cmml" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.1"></times><ci id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.2.cmml" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.2">𝑑</ci><apply id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.3.cmml" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS5.Px1.p4.3.m3.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p4.3.m3.1c">\mathbf{W}_{i}^{V}\in\mathbb{R}^{d\times d_{k}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p4.3.m3.1d">bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="\mathbf{W}^{o}\in\mathbb{R}^{hd_{k}\times d}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p4.4.m4.1"><semantics id="S3.SS2.SSS5.Px1.p4.4.m4.1a"><mrow id="S3.SS2.SSS5.Px1.p4.4.m4.1.1" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.cmml"><msup id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.2" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.2.cmml"><mi id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.2.2" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.2.2.cmml">𝐖</mi><mi id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.2.3" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.2.3.cmml">o</mi></msup><mo id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.1" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.cmml"><mi id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.2" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.cmml"><mrow id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.cmml"><mi id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.2" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.2.cmml">h</mi><mo id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.1" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.1.cmml">⁢</mo><msub id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.3" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.3.cmml"><mi id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.3.2" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.3.2.cmml">d</mi><mi id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.3.3" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.3.3.cmml">k</mi></msub></mrow><mo id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.3" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p4.4.m4.1b"><apply id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1"><in id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.1"></in><apply id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.2.cmml" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.2.2">𝐖</ci><ci id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.2.3.cmml" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.2.3">𝑜</ci></apply><apply id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.cmml" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.1.cmml" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.2.cmml" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.cmml" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3"><times id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.1.cmml" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.1"></times><apply id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.cmml" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2"><times id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.1"></times><ci id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.2">ℎ</ci><apply id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.3.cmml" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.3.1.cmml" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.3">subscript</csymbol><ci id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.3.2.cmml" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.3.2">𝑑</ci><ci id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.3.3.cmml" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.2.3.3">𝑘</ci></apply></apply><ci id="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.3.cmml" xref="S3.SS2.SSS5.Px1.p4.4.m4.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p4.4.m4.1c">\mathbf{W}^{o}\in\mathbb{R}^{hd_{k}\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p4.4.m4.1d">bold_W start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_h italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> denotes projection matrices, and <math alttext="i\in\{1,2,\ldots,h\}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p4.5.m5.4"><semantics id="S3.SS2.SSS5.Px1.p4.5.m5.4a"><mrow id="S3.SS2.SSS5.Px1.p4.5.m5.4.5" xref="S3.SS2.SSS5.Px1.p4.5.m5.4.5.cmml"><mi id="S3.SS2.SSS5.Px1.p4.5.m5.4.5.2" xref="S3.SS2.SSS5.Px1.p4.5.m5.4.5.2.cmml">i</mi><mo id="S3.SS2.SSS5.Px1.p4.5.m5.4.5.1" xref="S3.SS2.SSS5.Px1.p4.5.m5.4.5.1.cmml">∈</mo><mrow id="S3.SS2.SSS5.Px1.p4.5.m5.4.5.3.2" xref="S3.SS2.SSS5.Px1.p4.5.m5.4.5.3.1.cmml"><mo id="S3.SS2.SSS5.Px1.p4.5.m5.4.5.3.2.1" stretchy="false" xref="S3.SS2.SSS5.Px1.p4.5.m5.4.5.3.1.cmml">{</mo><mn id="S3.SS2.SSS5.Px1.p4.5.m5.1.1" xref="S3.SS2.SSS5.Px1.p4.5.m5.1.1.cmml">1</mn><mo id="S3.SS2.SSS5.Px1.p4.5.m5.4.5.3.2.2" xref="S3.SS2.SSS5.Px1.p4.5.m5.4.5.3.1.cmml">,</mo><mn id="S3.SS2.SSS5.Px1.p4.5.m5.2.2" xref="S3.SS2.SSS5.Px1.p4.5.m5.2.2.cmml">2</mn><mo id="S3.SS2.SSS5.Px1.p4.5.m5.4.5.3.2.3" xref="S3.SS2.SSS5.Px1.p4.5.m5.4.5.3.1.cmml">,</mo><mi id="S3.SS2.SSS5.Px1.p4.5.m5.3.3" mathvariant="normal" xref="S3.SS2.SSS5.Px1.p4.5.m5.3.3.cmml">…</mi><mo id="S3.SS2.SSS5.Px1.p4.5.m5.4.5.3.2.4" xref="S3.SS2.SSS5.Px1.p4.5.m5.4.5.3.1.cmml">,</mo><mi id="S3.SS2.SSS5.Px1.p4.5.m5.4.4" xref="S3.SS2.SSS5.Px1.p4.5.m5.4.4.cmml">h</mi><mo id="S3.SS2.SSS5.Px1.p4.5.m5.4.5.3.2.5" stretchy="false" xref="S3.SS2.SSS5.Px1.p4.5.m5.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p4.5.m5.4b"><apply id="S3.SS2.SSS5.Px1.p4.5.m5.4.5.cmml" xref="S3.SS2.SSS5.Px1.p4.5.m5.4.5"><in id="S3.SS2.SSS5.Px1.p4.5.m5.4.5.1.cmml" xref="S3.SS2.SSS5.Px1.p4.5.m5.4.5.1"></in><ci id="S3.SS2.SSS5.Px1.p4.5.m5.4.5.2.cmml" xref="S3.SS2.SSS5.Px1.p4.5.m5.4.5.2">𝑖</ci><set id="S3.SS2.SSS5.Px1.p4.5.m5.4.5.3.1.cmml" xref="S3.SS2.SSS5.Px1.p4.5.m5.4.5.3.2"><cn id="S3.SS2.SSS5.Px1.p4.5.m5.1.1.cmml" type="integer" xref="S3.SS2.SSS5.Px1.p4.5.m5.1.1">1</cn><cn id="S3.SS2.SSS5.Px1.p4.5.m5.2.2.cmml" type="integer" xref="S3.SS2.SSS5.Px1.p4.5.m5.2.2">2</cn><ci id="S3.SS2.SSS5.Px1.p4.5.m5.3.3.cmml" xref="S3.SS2.SSS5.Px1.p4.5.m5.3.3">…</ci><ci id="S3.SS2.SSS5.Px1.p4.5.m5.4.4.cmml" xref="S3.SS2.SSS5.Px1.p4.5.m5.4.4">ℎ</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p4.5.m5.4c">i\in\{1,2,\ldots,h\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p4.5.m5.4d">italic_i ∈ { 1 , 2 , … , italic_h }</annotation></semantics></math>, <math alttext="h" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p4.6.m6.1"><semantics id="S3.SS2.SSS5.Px1.p4.6.m6.1a"><mi id="S3.SS2.SSS5.Px1.p4.6.m6.1.1" xref="S3.SS2.SSS5.Px1.p4.6.m6.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p4.6.m6.1b"><ci id="S3.SS2.SSS5.Px1.p4.6.m6.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.6.m6.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p4.6.m6.1c">h</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p4.6.m6.1d">italic_h</annotation></semantics></math> denotes the number of heads. We treat <math alttext="\mathbf{Q}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p4.7.m7.1"><semantics id="S3.SS2.SSS5.Px1.p4.7.m7.1a"><msup id="S3.SS2.SSS5.Px1.p4.7.m7.1.1" xref="S3.SS2.SSS5.Px1.p4.7.m7.1.1.cmml"><mi id="S3.SS2.SSS5.Px1.p4.7.m7.1.1.2" xref="S3.SS2.SSS5.Px1.p4.7.m7.1.1.2.cmml">𝐐</mi><mi id="S3.SS2.SSS5.Px1.p4.7.m7.1.1.3" xref="S3.SS2.SSS5.Px1.p4.7.m7.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p4.7.m7.1b"><apply id="S3.SS2.SSS5.Px1.p4.7.m7.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.7.m7.1.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.7.m7.1.1">superscript</csymbol><ci id="S3.SS2.SSS5.Px1.p4.7.m7.1.1.2.cmml" xref="S3.SS2.SSS5.Px1.p4.7.m7.1.1.2">𝐐</ci><ci id="S3.SS2.SSS5.Px1.p4.7.m7.1.1.3.cmml" xref="S3.SS2.SSS5.Px1.p4.7.m7.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p4.7.m7.1c">\mathbf{Q}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p4.7.m7.1d">bold_Q start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> as queries and <math alttext="\mathbf{P}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p4.8.m8.1"><semantics id="S3.SS2.SSS5.Px1.p4.8.m8.1a"><msup id="S3.SS2.SSS5.Px1.p4.8.m8.1.1" xref="S3.SS2.SSS5.Px1.p4.8.m8.1.1.cmml"><mi id="S3.SS2.SSS5.Px1.p4.8.m8.1.1.2" xref="S3.SS2.SSS5.Px1.p4.8.m8.1.1.2.cmml">𝐏</mi><mi id="S3.SS2.SSS5.Px1.p4.8.m8.1.1.3" xref="S3.SS2.SSS5.Px1.p4.8.m8.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p4.8.m8.1b"><apply id="S3.SS2.SSS5.Px1.p4.8.m8.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.8.m8.1.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.8.m8.1.1">superscript</csymbol><ci id="S3.SS2.SSS5.Px1.p4.8.m8.1.1.2.cmml" xref="S3.SS2.SSS5.Px1.p4.8.m8.1.1.2">𝐏</ci><ci id="S3.SS2.SSS5.Px1.p4.8.m8.1.1.3.cmml" xref="S3.SS2.SSS5.Px1.p4.8.m8.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p4.8.m8.1c">\mathbf{P}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p4.8.m8.1d">bold_P start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> as key-value pairs, where keys and values are the same. Leveraging the multi-head attention mechanism, we can use the users’ multi-preferences embedding vector <math alttext="\mathbf{P}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p4.9.m9.1"><semantics id="S3.SS2.SSS5.Px1.p4.9.m9.1a"><msup id="S3.SS2.SSS5.Px1.p4.9.m9.1.1" xref="S3.SS2.SSS5.Px1.p4.9.m9.1.1.cmml"><mi id="S3.SS2.SSS5.Px1.p4.9.m9.1.1.2" xref="S3.SS2.SSS5.Px1.p4.9.m9.1.1.2.cmml">𝐏</mi><mi id="S3.SS2.SSS5.Px1.p4.9.m9.1.1.3" xref="S3.SS2.SSS5.Px1.p4.9.m9.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p4.9.m9.1b"><apply id="S3.SS2.SSS5.Px1.p4.9.m9.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.9.m9.1.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.9.m9.1.1">superscript</csymbol><ci id="S3.SS2.SSS5.Px1.p4.9.m9.1.1.2.cmml" xref="S3.SS2.SSS5.Px1.p4.9.m9.1.1.2">𝐏</ci><ci id="S3.SS2.SSS5.Px1.p4.9.m9.1.1.3.cmml" xref="S3.SS2.SSS5.Px1.p4.9.m9.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p4.9.m9.1c">\mathbf{P}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p4.9.m9.1d">bold_P start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> to capture the semantic information of the sequence feature vector <math alttext="\mathbf{Q}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p4.10.m10.1"><semantics id="S3.SS2.SSS5.Px1.p4.10.m10.1a"><msup id="S3.SS2.SSS5.Px1.p4.10.m10.1.1" xref="S3.SS2.SSS5.Px1.p4.10.m10.1.1.cmml"><mi id="S3.SS2.SSS5.Px1.p4.10.m10.1.1.2" xref="S3.SS2.SSS5.Px1.p4.10.m10.1.1.2.cmml">𝐐</mi><mi id="S3.SS2.SSS5.Px1.p4.10.m10.1.1.3" xref="S3.SS2.SSS5.Px1.p4.10.m10.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p4.10.m10.1b"><apply id="S3.SS2.SSS5.Px1.p4.10.m10.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.10.m10.1.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.10.m10.1.1">superscript</csymbol><ci id="S3.SS2.SSS5.Px1.p4.10.m10.1.1.2.cmml" xref="S3.SS2.SSS5.Px1.p4.10.m10.1.1.2">𝐐</ci><ci id="S3.SS2.SSS5.Px1.p4.10.m10.1.1.3.cmml" xref="S3.SS2.SSS5.Px1.p4.10.m10.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p4.10.m10.1c">\mathbf{Q}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p4.10.m10.1d">bold_Q start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>, aligning <math alttext="\mathbf{Q}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p4.11.m11.1"><semantics id="S3.SS2.SSS5.Px1.p4.11.m11.1a"><msup id="S3.SS2.SSS5.Px1.p4.11.m11.1.1" xref="S3.SS2.SSS5.Px1.p4.11.m11.1.1.cmml"><mi id="S3.SS2.SSS5.Px1.p4.11.m11.1.1.2" xref="S3.SS2.SSS5.Px1.p4.11.m11.1.1.2.cmml">𝐐</mi><mi id="S3.SS2.SSS5.Px1.p4.11.m11.1.1.3" xref="S3.SS2.SSS5.Px1.p4.11.m11.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p4.11.m11.1b"><apply id="S3.SS2.SSS5.Px1.p4.11.m11.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.11.m11.1.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.11.m11.1.1">superscript</csymbol><ci id="S3.SS2.SSS5.Px1.p4.11.m11.1.1.2.cmml" xref="S3.SS2.SSS5.Px1.p4.11.m11.1.1.2">𝐐</ci><ci id="S3.SS2.SSS5.Px1.p4.11.m11.1.1.3.cmml" xref="S3.SS2.SSS5.Px1.p4.11.m11.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p4.11.m11.1c">\mathbf{Q}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p4.11.m11.1d">bold_Q start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{P}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p4.12.m12.1"><semantics id="S3.SS2.SSS5.Px1.p4.12.m12.1a"><msup id="S3.SS2.SSS5.Px1.p4.12.m12.1.1" xref="S3.SS2.SSS5.Px1.p4.12.m12.1.1.cmml"><mi id="S3.SS2.SSS5.Px1.p4.12.m12.1.1.2" xref="S3.SS2.SSS5.Px1.p4.12.m12.1.1.2.cmml">𝐏</mi><mi id="S3.SS2.SSS5.Px1.p4.12.m12.1.1.3" xref="S3.SS2.SSS5.Px1.p4.12.m12.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p4.12.m12.1b"><apply id="S3.SS2.SSS5.Px1.p4.12.m12.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.12.m12.1.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.12.m12.1.1">superscript</csymbol><ci id="S3.SS2.SSS5.Px1.p4.12.m12.1.1.2.cmml" xref="S3.SS2.SSS5.Px1.p4.12.m12.1.1.2">𝐏</ci><ci id="S3.SS2.SSS5.Px1.p4.12.m12.1.1.3.cmml" xref="S3.SS2.SSS5.Px1.p4.12.m12.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p4.12.m12.1c">\mathbf{P}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p4.12.m12.1d">bold_P start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> semantically to obtain an alignment matrix regarding <math alttext="\mathbf{Q}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px1.p4.13.m13.1"><semantics id="S3.SS2.SSS5.Px1.p4.13.m13.1a"><msup id="S3.SS2.SSS5.Px1.p4.13.m13.1.1" xref="S3.SS2.SSS5.Px1.p4.13.m13.1.1.cmml"><mi id="S3.SS2.SSS5.Px1.p4.13.m13.1.1.2" xref="S3.SS2.SSS5.Px1.p4.13.m13.1.1.2.cmml">𝐐</mi><mi id="S3.SS2.SSS5.Px1.p4.13.m13.1.1.3" xref="S3.SS2.SSS5.Px1.p4.13.m13.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px1.p4.13.m13.1b"><apply id="S3.SS2.SSS5.Px1.p4.13.m13.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px1.p4.13.m13.1.1.1.cmml" xref="S3.SS2.SSS5.Px1.p4.13.m13.1.1">superscript</csymbol><ci id="S3.SS2.SSS5.Px1.p4.13.m13.1.1.2.cmml" xref="S3.SS2.SSS5.Px1.p4.13.m13.1.1.2">𝐐</ci><ci id="S3.SS2.SSS5.Px1.p4.13.m13.1.1.3.cmml" xref="S3.SS2.SSS5.Px1.p4.13.m13.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px1.p4.13.m13.1c">\mathbf{Q}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px1.p4.13.m13.1d">bold_Q start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS5.Px2">
<h5 class="ltx_title ltx_title_paragraph">Position-wise Feed-Forward Networks.</h5>
<div class="ltx_para" id="S3.SS2.SSS5.Px2.p1">
<p class="ltx_p" id="S3.SS2.SSS5.Px2.p1.1">While the multi-head attention mechanism can capture local dependencies and semantic information in the input sequence, it may not be sufficient to model complex nonlinear relationships. Therefore, we introduce an additional nonlinear component by incorporating a Position-wise Feed-Forward Network to enhance the model’s expressive power and learning capacity. Assuming the input vector is <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px2.p1.1.m1.1"><semantics id="S3.SS2.SSS5.Px2.p1.1.m1.1a"><mi id="S3.SS2.SSS5.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS5.Px2.p1.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px2.p1.1.m1.1b"><ci id="S3.SS2.SSS5.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS5.Px2.p1.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px2.p1.1.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px2.p1.1.m1.1d">bold_x</annotation></semantics></math>, the definition of the Position-wise Feed-Forward Network is:</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS5.Px2.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{FNN}(\mathbf{x})=\text{ReLU}(\mathbf{x}\mathbf{W}_{1}+\mathbf{b}_{1})%
\mathbf{W}_{2}+\mathbf{b}_{2}," class="ltx_Math" display="block" id="S3.E8.m1.2"><semantics id="S3.E8.m1.2a"><mrow id="S3.E8.m1.2.2.1" xref="S3.E8.m1.2.2.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1" xref="S3.E8.m1.2.2.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1.3" xref="S3.E8.m1.2.2.1.1.3.cmml"><mtext id="S3.E8.m1.2.2.1.1.3.2" xref="S3.E8.m1.2.2.1.1.3.2a.cmml">FNN</mtext><mo id="S3.E8.m1.2.2.1.1.3.1" xref="S3.E8.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S3.E8.m1.2.2.1.1.3.3.2" xref="S3.E8.m1.2.2.1.1.3.cmml"><mo id="S3.E8.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S3.E8.m1.2.2.1.1.3.cmml">(</mo><mi id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">𝐱</mi><mo id="S3.E8.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="S3.E8.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.2.2.1.1.2" xref="S3.E8.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E8.m1.2.2.1.1.1" xref="S3.E8.m1.2.2.1.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.cmml"><mtext id="S3.E8.m1.2.2.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.3a.cmml">ReLU</mtext><mo id="S3.E8.m1.2.2.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">𝐱𝐖</mi><mn id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E8.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">𝐛</mi><mn id="S3.E8.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E8.m1.2.2.1.1.1.1.2a" xref="S3.E8.m1.2.2.1.1.1.1.2.cmml">⁢</mo><msub id="S3.E8.m1.2.2.1.1.1.1.4" xref="S3.E8.m1.2.2.1.1.1.1.4.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.4.2" xref="S3.E8.m1.2.2.1.1.1.1.4.2.cmml">𝐖</mi><mn id="S3.E8.m1.2.2.1.1.1.1.4.3" xref="S3.E8.m1.2.2.1.1.1.1.4.3.cmml">2</mn></msub></mrow><mo id="S3.E8.m1.2.2.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.2.cmml">+</mo><msub id="S3.E8.m1.2.2.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.3.cmml"><mi id="S3.E8.m1.2.2.1.1.1.3.2" xref="S3.E8.m1.2.2.1.1.1.3.2.cmml">𝐛</mi><mn id="S3.E8.m1.2.2.1.1.1.3.3" xref="S3.E8.m1.2.2.1.1.1.3.3.cmml">2</mn></msub></mrow></mrow><mo id="S3.E8.m1.2.2.1.2" xref="S3.E8.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.2b"><apply id="S3.E8.m1.2.2.1.1.cmml" xref="S3.E8.m1.2.2.1"><eq id="S3.E8.m1.2.2.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.2"></eq><apply id="S3.E8.m1.2.2.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3"><times id="S3.E8.m1.2.2.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1"></times><ci id="S3.E8.m1.2.2.1.1.3.2a.cmml" xref="S3.E8.m1.2.2.1.1.3.2"><mtext id="S3.E8.m1.2.2.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.2">FNN</mtext></ci><ci id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">𝐱</ci></apply><apply id="S3.E8.m1.2.2.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1"><plus id="S3.E8.m1.2.2.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.2"></plus><apply id="S3.E8.m1.2.2.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1"><times id="S3.E8.m1.2.2.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.2"></times><ci id="S3.E8.m1.2.2.1.1.1.1.3a.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3"><mtext id="S3.E8.m1.2.2.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3">ReLU</mtext></ci><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1"><plus id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1"></plus><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2">𝐱𝐖</ci><cn id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.3">1</cn></apply><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.3.2">𝐛</ci><cn id="S3.E8.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E8.m1.2.2.1.1.1.1.4.cmml" xref="S3.E8.m1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.4.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.4">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.4.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.4.2">𝐖</ci><cn id="S3.E8.m1.2.2.1.1.1.1.4.3.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.1.1.4.3">2</cn></apply></apply><apply id="S3.E8.m1.2.2.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.1.3.2">𝐛</ci><cn id="S3.E8.m1.2.2.1.1.1.3.3.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.1.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.2c">\text{FNN}(\mathbf{x})=\text{ReLU}(\mathbf{x}\mathbf{W}_{1}+\mathbf{b}_{1})%
\mathbf{W}_{2}+\mathbf{b}_{2},</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.2d">FNN ( bold_x ) = ReLU ( bold_xW start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + bold_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) bold_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + bold_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS5.Px2.p3">
<p class="ltx_p" id="S3.SS2.SSS5.Px2.p3.4">where <math alttext="\mathbf{W}_{1}\in\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px2.p3.1.m1.1"><semantics id="S3.SS2.SSS5.Px2.p3.1.m1.1a"><mrow id="S3.SS2.SSS5.Px2.p3.1.m1.1.1" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.cmml"><msub id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.2" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.2.2" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.2.2.cmml">𝐖</mi><mn id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.2.3" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.1" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.2" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.3" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.3.2" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.3.2.cmml">d</mi><mo id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.3.3" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px2.p3.1.m1.1b"><apply id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1"><in id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.1"></in><apply id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.2.2">𝐖</ci><cn id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.2.3">1</cn></apply><apply id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.3"><times id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.3.1"></times><ci id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.3.2">𝑑</ci><ci id="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS5.Px2.p3.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px2.p3.1.m1.1c">\mathbf{W}_{1}\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px2.p3.1.m1.1d">bold_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{W}_{2}\in\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px2.p3.2.m2.1"><semantics id="S3.SS2.SSS5.Px2.p3.2.m2.1a"><mrow id="S3.SS2.SSS5.Px2.p3.2.m2.1.1" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.cmml"><msub id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.2" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.2.cmml"><mi id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.2.2" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.2.2.cmml">𝐖</mi><mn id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.2.3" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.1" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.2" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.3" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.3.cmml"><mi id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.3.2" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.3.2.cmml">d</mi><mo id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.3.3" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px2.p3.2.m2.1b"><apply id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1"><in id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.1"></in><apply id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.2.2">𝐖</ci><cn id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.2.3">2</cn></apply><apply id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.3"><times id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.3.1"></times><ci id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.3.2">𝑑</ci><ci id="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.SSS5.Px2.p3.2.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px2.p3.2.m2.1c">\mathbf{W}_{2}\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px2.p3.2.m2.1d">bold_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{b}_{1}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px2.p3.3.m3.1"><semantics id="S3.SS2.SSS5.Px2.p3.3.m3.1a"><mrow id="S3.SS2.SSS5.Px2.p3.3.m3.1.1" xref="S3.SS2.SSS5.Px2.p3.3.m3.1.1.cmml"><msub id="S3.SS2.SSS5.Px2.p3.3.m3.1.1.2" xref="S3.SS2.SSS5.Px2.p3.3.m3.1.1.2.cmml"><mi id="S3.SS2.SSS5.Px2.p3.3.m3.1.1.2.2" xref="S3.SS2.SSS5.Px2.p3.3.m3.1.1.2.2.cmml">𝐛</mi><mn id="S3.SS2.SSS5.Px2.p3.3.m3.1.1.2.3" xref="S3.SS2.SSS5.Px2.p3.3.m3.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS2.SSS5.Px2.p3.3.m3.1.1.1" xref="S3.SS2.SSS5.Px2.p3.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS5.Px2.p3.3.m3.1.1.3" xref="S3.SS2.SSS5.Px2.p3.3.m3.1.1.3.cmml"><mi id="S3.SS2.SSS5.Px2.p3.3.m3.1.1.3.2" xref="S3.SS2.SSS5.Px2.p3.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.SSS5.Px2.p3.3.m3.1.1.3.3" xref="S3.SS2.SSS5.Px2.p3.3.m3.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px2.p3.3.m3.1b"><apply id="S3.SS2.SSS5.Px2.p3.3.m3.1.1.cmml" xref="S3.SS2.SSS5.Px2.p3.3.m3.1.1"><in id="S3.SS2.SSS5.Px2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.SSS5.Px2.p3.3.m3.1.1.1"></in><apply id="S3.SS2.SSS5.Px2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.SSS5.Px2.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px2.p3.3.m3.1.1.2.1.cmml" xref="S3.SS2.SSS5.Px2.p3.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS5.Px2.p3.3.m3.1.1.2.2.cmml" xref="S3.SS2.SSS5.Px2.p3.3.m3.1.1.2.2">𝐛</ci><cn id="S3.SS2.SSS5.Px2.p3.3.m3.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS5.Px2.p3.3.m3.1.1.2.3">1</cn></apply><apply id="S3.SS2.SSS5.Px2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.SSS5.Px2.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px2.p3.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS5.Px2.p3.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS5.Px2.p3.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS5.Px2.p3.3.m3.1.1.3.2">ℝ</ci><ci id="S3.SS2.SSS5.Px2.p3.3.m3.1.1.3.3.cmml" xref="S3.SS2.SSS5.Px2.p3.3.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px2.p3.3.m3.1c">\mathbf{b}_{1}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px2.p3.3.m3.1d">bold_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="\mathbf{b}_{2}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px2.p3.4.m4.1"><semantics id="S3.SS2.SSS5.Px2.p3.4.m4.1a"><mrow id="S3.SS2.SSS5.Px2.p3.4.m4.1.1" xref="S3.SS2.SSS5.Px2.p3.4.m4.1.1.cmml"><msub id="S3.SS2.SSS5.Px2.p3.4.m4.1.1.2" xref="S3.SS2.SSS5.Px2.p3.4.m4.1.1.2.cmml"><mi id="S3.SS2.SSS5.Px2.p3.4.m4.1.1.2.2" xref="S3.SS2.SSS5.Px2.p3.4.m4.1.1.2.2.cmml">𝐛</mi><mn id="S3.SS2.SSS5.Px2.p3.4.m4.1.1.2.3" xref="S3.SS2.SSS5.Px2.p3.4.m4.1.1.2.3.cmml">2</mn></msub><mo id="S3.SS2.SSS5.Px2.p3.4.m4.1.1.1" xref="S3.SS2.SSS5.Px2.p3.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS5.Px2.p3.4.m4.1.1.3" xref="S3.SS2.SSS5.Px2.p3.4.m4.1.1.3.cmml"><mi id="S3.SS2.SSS5.Px2.p3.4.m4.1.1.3.2" xref="S3.SS2.SSS5.Px2.p3.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.SSS5.Px2.p3.4.m4.1.1.3.3" xref="S3.SS2.SSS5.Px2.p3.4.m4.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px2.p3.4.m4.1b"><apply id="S3.SS2.SSS5.Px2.p3.4.m4.1.1.cmml" xref="S3.SS2.SSS5.Px2.p3.4.m4.1.1"><in id="S3.SS2.SSS5.Px2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.SSS5.Px2.p3.4.m4.1.1.1"></in><apply id="S3.SS2.SSS5.Px2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.SSS5.Px2.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px2.p3.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS5.Px2.p3.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS5.Px2.p3.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS5.Px2.p3.4.m4.1.1.2.2">𝐛</ci><cn id="S3.SS2.SSS5.Px2.p3.4.m4.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS5.Px2.p3.4.m4.1.1.2.3">2</cn></apply><apply id="S3.SS2.SSS5.Px2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.SSS5.Px2.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px2.p3.4.m4.1.1.3.1.cmml" xref="S3.SS2.SSS5.Px2.p3.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS5.Px2.p3.4.m4.1.1.3.2.cmml" xref="S3.SS2.SSS5.Px2.p3.4.m4.1.1.3.2">ℝ</ci><ci id="S3.SS2.SSS5.Px2.p3.4.m4.1.1.3.3.cmml" xref="S3.SS2.SSS5.Px2.p3.4.m4.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px2.p3.4.m4.1c">\mathbf{b}_{2}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px2.p3.4.m4.1d">bold_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> denote projection matrices and bias terms. The feedforward neural network consists of two linear transformations with a ReLU activation function between them.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS5.Px3">
<h5 class="ltx_title ltx_title_paragraph">Residual Connections and Layer Normalization.</h5>
<div class="ltx_para" id="S3.SS2.SSS5.Px3.p1">
<p class="ltx_p" id="S3.SS2.SSS5.Px3.p1.1">Residual connections allow useful low-level information to be preserved at higher layers. To better preserve the performance of the integrated model and to ensure more stable and faster training, we incorporate residual connections <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib17" title="">17</a>]</cite>. Additionally, we utilize layer normalization to further accelerate model training and improve generalization capabilities <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib2" title="">2</a>]</cite>. Assuming the input vector is <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px3.p1.1.m1.1"><semantics id="S3.SS2.SSS5.Px3.p1.1.m1.1a"><mi id="S3.SS2.SSS5.Px3.p1.1.m1.1.1" xref="S3.SS2.SSS5.Px3.p1.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px3.p1.1.m1.1b"><ci id="S3.SS2.SSS5.Px3.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS5.Px3.p1.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px3.p1.1.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px3.p1.1.m1.1d">bold_x</annotation></semantics></math>, the definition of layer normalization is:</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS5.Px3.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{LayerNorm}(\mathbf{x})=\alpha\odot\left(\frac{\mathbf{x}-\mu}{\sqrt{%
\sigma^{2}+\epsilon}}\right)+\beta," class="ltx_Math" display="block" id="S3.E9.m1.3"><semantics id="S3.E9.m1.3a"><mrow id="S3.E9.m1.3.3.1" xref="S3.E9.m1.3.3.1.1.cmml"><mrow id="S3.E9.m1.3.3.1.1" xref="S3.E9.m1.3.3.1.1.cmml"><mrow id="S3.E9.m1.3.3.1.1.2" xref="S3.E9.m1.3.3.1.1.2.cmml"><mtext id="S3.E9.m1.3.3.1.1.2.2" xref="S3.E9.m1.3.3.1.1.2.2a.cmml">LayerNorm</mtext><mo id="S3.E9.m1.3.3.1.1.2.1" xref="S3.E9.m1.3.3.1.1.2.1.cmml">⁢</mo><mrow id="S3.E9.m1.3.3.1.1.2.3.2" xref="S3.E9.m1.3.3.1.1.2.cmml"><mo id="S3.E9.m1.3.3.1.1.2.3.2.1" stretchy="false" xref="S3.E9.m1.3.3.1.1.2.cmml">(</mo><mi id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml">𝐱</mi><mo id="S3.E9.m1.3.3.1.1.2.3.2.2" stretchy="false" xref="S3.E9.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.3.3.1.1.1" xref="S3.E9.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E9.m1.3.3.1.1.3" xref="S3.E9.m1.3.3.1.1.3.cmml"><mrow id="S3.E9.m1.3.3.1.1.3.2" xref="S3.E9.m1.3.3.1.1.3.2.cmml"><mi id="S3.E9.m1.3.3.1.1.3.2.2" xref="S3.E9.m1.3.3.1.1.3.2.2.cmml">α</mi><mo id="S3.E9.m1.3.3.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E9.m1.3.3.1.1.3.2.1.cmml">⊙</mo><mrow id="S3.E9.m1.3.3.1.1.3.2.3.2" xref="S3.E9.m1.2.2.cmml"><mo id="S3.E9.m1.3.3.1.1.3.2.3.2.1" xref="S3.E9.m1.2.2.cmml">(</mo><mfrac id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml"><mrow id="S3.E9.m1.2.2.2" xref="S3.E9.m1.2.2.2.cmml"><mi id="S3.E9.m1.2.2.2.2" xref="S3.E9.m1.2.2.2.2.cmml">𝐱</mi><mo id="S3.E9.m1.2.2.2.1" xref="S3.E9.m1.2.2.2.1.cmml">−</mo><mi id="S3.E9.m1.2.2.2.3" xref="S3.E9.m1.2.2.2.3.cmml">μ</mi></mrow><msqrt id="S3.E9.m1.2.2.3" xref="S3.E9.m1.2.2.3.cmml"><mrow id="S3.E9.m1.2.2.3.2" xref="S3.E9.m1.2.2.3.2.cmml"><msup id="S3.E9.m1.2.2.3.2.2" xref="S3.E9.m1.2.2.3.2.2.cmml"><mi id="S3.E9.m1.2.2.3.2.2.2" xref="S3.E9.m1.2.2.3.2.2.2.cmml">σ</mi><mn id="S3.E9.m1.2.2.3.2.2.3" xref="S3.E9.m1.2.2.3.2.2.3.cmml">2</mn></msup><mo id="S3.E9.m1.2.2.3.2.1" xref="S3.E9.m1.2.2.3.2.1.cmml">+</mo><mi id="S3.E9.m1.2.2.3.2.3" xref="S3.E9.m1.2.2.3.2.3.cmml">ϵ</mi></mrow></msqrt></mfrac><mo id="S3.E9.m1.3.3.1.1.3.2.3.2.2" xref="S3.E9.m1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.3.3.1.1.3.1" xref="S3.E9.m1.3.3.1.1.3.1.cmml">+</mo><mi id="S3.E9.m1.3.3.1.1.3.3" xref="S3.E9.m1.3.3.1.1.3.3.cmml">β</mi></mrow></mrow><mo id="S3.E9.m1.3.3.1.2" xref="S3.E9.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.3b"><apply id="S3.E9.m1.3.3.1.1.cmml" xref="S3.E9.m1.3.3.1"><eq id="S3.E9.m1.3.3.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1"></eq><apply id="S3.E9.m1.3.3.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.2"><times id="S3.E9.m1.3.3.1.1.2.1.cmml" xref="S3.E9.m1.3.3.1.1.2.1"></times><ci id="S3.E9.m1.3.3.1.1.2.2a.cmml" xref="S3.E9.m1.3.3.1.1.2.2"><mtext id="S3.E9.m1.3.3.1.1.2.2.cmml" xref="S3.E9.m1.3.3.1.1.2.2">LayerNorm</mtext></ci><ci id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1">𝐱</ci></apply><apply id="S3.E9.m1.3.3.1.1.3.cmml" xref="S3.E9.m1.3.3.1.1.3"><plus id="S3.E9.m1.3.3.1.1.3.1.cmml" xref="S3.E9.m1.3.3.1.1.3.1"></plus><apply id="S3.E9.m1.3.3.1.1.3.2.cmml" xref="S3.E9.m1.3.3.1.1.3.2"><csymbol cd="latexml" id="S3.E9.m1.3.3.1.1.3.2.1.cmml" xref="S3.E9.m1.3.3.1.1.3.2.1">direct-product</csymbol><ci id="S3.E9.m1.3.3.1.1.3.2.2.cmml" xref="S3.E9.m1.3.3.1.1.3.2.2">𝛼</ci><apply id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.3.3.1.1.3.2.3.2"><divide id="S3.E9.m1.2.2.1.cmml" xref="S3.E9.m1.3.3.1.1.3.2.3.2"></divide><apply id="S3.E9.m1.2.2.2.cmml" xref="S3.E9.m1.2.2.2"><minus id="S3.E9.m1.2.2.2.1.cmml" xref="S3.E9.m1.2.2.2.1"></minus><ci id="S3.E9.m1.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2">𝐱</ci><ci id="S3.E9.m1.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.3">𝜇</ci></apply><apply id="S3.E9.m1.2.2.3.cmml" xref="S3.E9.m1.2.2.3"><root id="S3.E9.m1.2.2.3a.cmml" xref="S3.E9.m1.2.2.3"></root><apply id="S3.E9.m1.2.2.3.2.cmml" xref="S3.E9.m1.2.2.3.2"><plus id="S3.E9.m1.2.2.3.2.1.cmml" xref="S3.E9.m1.2.2.3.2.1"></plus><apply id="S3.E9.m1.2.2.3.2.2.cmml" xref="S3.E9.m1.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.3.2.2.1.cmml" xref="S3.E9.m1.2.2.3.2.2">superscript</csymbol><ci id="S3.E9.m1.2.2.3.2.2.2.cmml" xref="S3.E9.m1.2.2.3.2.2.2">𝜎</ci><cn id="S3.E9.m1.2.2.3.2.2.3.cmml" type="integer" xref="S3.E9.m1.2.2.3.2.2.3">2</cn></apply><ci id="S3.E9.m1.2.2.3.2.3.cmml" xref="S3.E9.m1.2.2.3.2.3">italic-ϵ</ci></apply></apply></apply></apply><ci id="S3.E9.m1.3.3.1.1.3.3.cmml" xref="S3.E9.m1.3.3.1.1.3.3">𝛽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.3c">\text{LayerNorm}(\mathbf{x})=\alpha\odot\left(\frac{\mathbf{x}-\mu}{\sqrt{%
\sigma^{2}+\epsilon}}\right)+\beta,</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.3d">LayerNorm ( bold_x ) = italic_α ⊙ ( divide start_ARG bold_x - italic_μ end_ARG start_ARG square-root start_ARG italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_ϵ end_ARG end_ARG ) + italic_β ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS5.Px3.p2.6">where <math alttext="\odot" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px3.p2.1.m1.1"><semantics id="S3.SS2.SSS5.Px3.p2.1.m1.1a"><mo id="S3.SS2.SSS5.Px3.p2.1.m1.1.1" xref="S3.SS2.SSS5.Px3.p2.1.m1.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px3.p2.1.m1.1b"><csymbol cd="latexml" id="S3.SS2.SSS5.Px3.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS5.Px3.p2.1.m1.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px3.p2.1.m1.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px3.p2.1.m1.1d">⊙</annotation></semantics></math> denotes element-wise product (Hadamard product), <math alttext="\mu" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px3.p2.2.m2.1"><semantics id="S3.SS2.SSS5.Px3.p2.2.m2.1a"><mi id="S3.SS2.SSS5.Px3.p2.2.m2.1.1" xref="S3.SS2.SSS5.Px3.p2.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px3.p2.2.m2.1b"><ci id="S3.SS2.SSS5.Px3.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS5.Px3.p2.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px3.p2.2.m2.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px3.p2.2.m2.1d">italic_μ</annotation></semantics></math> and <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px3.p2.3.m3.1"><semantics id="S3.SS2.SSS5.Px3.p2.3.m3.1a"><mi id="S3.SS2.SSS5.Px3.p2.3.m3.1.1" xref="S3.SS2.SSS5.Px3.p2.3.m3.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px3.p2.3.m3.1b"><ci id="S3.SS2.SSS5.Px3.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS5.Px3.p2.3.m3.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px3.p2.3.m3.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px3.p2.3.m3.1d">italic_σ</annotation></semantics></math> denote the mean and variance of <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px3.p2.4.m4.1"><semantics id="S3.SS2.SSS5.Px3.p2.4.m4.1a"><mi id="S3.SS2.SSS5.Px3.p2.4.m4.1.1" xref="S3.SS2.SSS5.Px3.p2.4.m4.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px3.p2.4.m4.1b"><ci id="S3.SS2.SSS5.Px3.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS5.Px3.p2.4.m4.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px3.p2.4.m4.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px3.p2.4.m4.1d">bold_x</annotation></semantics></math>, <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px3.p2.5.m5.1"><semantics id="S3.SS2.SSS5.Px3.p2.5.m5.1a"><mi id="S3.SS2.SSS5.Px3.p2.5.m5.1.1" xref="S3.SS2.SSS5.Px3.p2.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px3.p2.5.m5.1b"><ci id="S3.SS2.SSS5.Px3.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS5.Px3.p2.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px3.p2.5.m5.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px3.p2.5.m5.1d">italic_α</annotation></semantics></math> and <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px3.p2.6.m6.1"><semantics id="S3.SS2.SSS5.Px3.p2.6.m6.1a"><mi id="S3.SS2.SSS5.Px3.p2.6.m6.1.1" xref="S3.SS2.SSS5.Px3.p2.6.m6.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px3.p2.6.m6.1b"><ci id="S3.SS2.SSS5.Px3.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS5.Px3.p2.6.m6.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px3.p2.6.m6.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px3.p2.6.m6.1d">italic_β</annotation></semantics></math> denote learned scale factor and bias term.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS5.Px3.p3">
<p class="ltx_p" id="S3.SS2.SSS5.Px3.p3.2">We treat the sequence feature matrix <math alttext="\mathbf{Q}^{u}\in\mathbb{R}^{n\times d}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px3.p3.1.m1.1"><semantics id="S3.SS2.SSS5.Px3.p3.1.m1.1a"><mrow id="S3.SS2.SSS5.Px3.p3.1.m1.1.1" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.cmml"><msup id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.2" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.2.2" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.2.2.cmml">𝐐</mi><mi id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.2.3" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.2.3.cmml">u</mi></msup><mo id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.1" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.2" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.3" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.3.2" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.3.2.cmml">n</mi><mo id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.3.3" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px3.p3.1.m1.1b"><apply id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1"><in id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.1.cmml" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.1"></in><apply id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.2.cmml" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.2.2">𝐐</ci><ci id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.2.3.cmml" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.2.3">𝑢</ci></apply><apply id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.cmml" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.3"><times id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.3.1"></times><ci id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.3.2">𝑛</ci><ci id="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS5.Px3.p3.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px3.p3.1.m1.1c">\mathbf{Q}^{u}\in\mathbb{R}^{n\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px3.p3.1.m1.1d">bold_Q start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> as queries, and the users’ multiple-preferences <math alttext="\mathbf{P}^{u}\in\mathbb{R}^{m\times d}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px3.p3.2.m2.1"><semantics id="S3.SS2.SSS5.Px3.p3.2.m2.1a"><mrow id="S3.SS2.SSS5.Px3.p3.2.m2.1.1" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.cmml"><msup id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.2" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.2.cmml"><mi id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.2.2" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.2.2.cmml">𝐏</mi><mi id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.2.3" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.2.3.cmml">u</mi></msup><mo id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.1" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.2" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.3" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.3.cmml"><mi id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.3.2" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.3.2.cmml">m</mi><mo id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.3.3" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px3.p3.2.m2.1b"><apply id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1"><in id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.1.cmml" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.1"></in><apply id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.2.cmml" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.2.2">𝐏</ci><ci id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.2.3.cmml" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.2.3">𝑢</ci></apply><apply id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.cmml" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.3"><times id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.3.1"></times><ci id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.3.2">𝑚</ci><ci id="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.SSS5.Px3.p3.2.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px3.p3.2.m2.1c">\mathbf{P}^{u}\in\mathbb{R}^{m\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px3.p3.2.m2.1d">bold_P start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> as key-value pairs. The preference alignment module can be represented by the following formulas:</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS5.Px3.p4">
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{att}^{u}=\text{LayerNorm}\left(\text{Multihead}(\mathbf{Q}^{u},\mathbf{P%
}^{u},\mathbf{P}^{u})\right)+\mathbf{Q}^{u}," class="ltx_Math" display="block" id="S3.E10.m1.1"><semantics id="S3.E10.m1.1a"><mrow id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><mrow id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><msup id="S3.E10.m1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.3.cmml"><mtext id="S3.E10.m1.1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.1.3.2a.cmml">att</mtext><mi id="S3.E10.m1.1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.1.3.3.cmml">u</mi></msup><mo id="S3.E10.m1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E10.m1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.cmml"><mrow id="S3.E10.m1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.cmml"><mtext id="S3.E10.m1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.3a.cmml">LayerNorm</mtext><mo id="S3.E10.m1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E10.m1.1.1.1.1.1.1.1.1.1.5" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.5a.cmml">Multihead</mtext><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.1.4" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.4.cmml">⁢</mo><mrow id="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.4.cmml"><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3.4" stretchy="false" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.4.cmml">(</mo><msup id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐐</mi><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3.5" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.4.cmml">,</mo><msup id="S3.E10.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐏</mi><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">u</mi></msup><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3.6" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.4.cmml">,</mo><msup id="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3.3.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">𝐏</mi><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">u</mi></msup><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3.7" stretchy="false" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.2.cmml">+</mo><msup id="S3.E10.m1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.3.cmml"><mi id="S3.E10.m1.1.1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.1.1.3.2.cmml">𝐐</mi><mi id="S3.E10.m1.1.1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.1.1.3.3.cmml">u</mi></msup></mrow></mrow><mo id="S3.E10.m1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"><eq id="S3.E10.m1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.2"></eq><apply id="S3.E10.m1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.E10.m1.1.1.1.1.3.2a.cmml" xref="S3.E10.m1.1.1.1.1.3.2"><mtext id="S3.E10.m1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.2">att</mtext></ci><ci id="S3.E10.m1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.3">𝑢</ci></apply><apply id="S3.E10.m1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1"><plus id="S3.E10.m1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.2"></plus><apply id="S3.E10.m1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1"><times id="S3.E10.m1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2"></times><ci id="S3.E10.m1.1.1.1.1.1.1.3a.cmml" xref="S3.E10.m1.1.1.1.1.1.1.3"><mtext id="S3.E10.m1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.3">LayerNorm</mtext></ci><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1"><times id="S3.E10.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.4"></times><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.1.5a.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.5"><mtext id="S3.E10.m1.1.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.5">Multihead</mtext></ci><vector id="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3"><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐐</ci><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝐏</ci><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑢</ci></apply><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3.3">superscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3.3.2">𝐏</ci><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3.3.3">𝑢</ci></apply></vector></apply></apply><apply id="S3.E10.m1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.1.1.3.2">𝐐</ci><ci id="S3.E10.m1.1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.1.1.3.3">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">\text{att}^{u}=\text{LayerNorm}\left(\text{Multihead}(\mathbf{Q}^{u},\mathbf{P%
}^{u},\mathbf{P}^{u})\right)+\mathbf{Q}^{u},</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.1d">att start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = LayerNorm ( Multihead ( bold_Q start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , bold_P start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , bold_P start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) ) + bold_Q start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS5.Px3.p5">
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{F}^{u}=\left[\begin{array}[]{c}\mathbf{f}_{1}^{u}\\
\mathbf{f}_{2}^{u}\\
\vdots\\
\mathbf{f}_{n}^{u}\end{array}\right]=\text{LayerNorm}\left(\text{FNN}(\text{%
att}^{u})\right)+\text{att}^{u}," class="ltx_Math" display="block" id="S3.E11.m1.2"><semantics id="S3.E11.m1.2a"><mrow id="S3.E11.m1.2.2.1" xref="S3.E11.m1.2.2.1.1.cmml"><mrow id="S3.E11.m1.2.2.1.1" xref="S3.E11.m1.2.2.1.1.cmml"><msup id="S3.E11.m1.2.2.1.1.3" xref="S3.E11.m1.2.2.1.1.3.cmml"><mi id="S3.E11.m1.2.2.1.1.3.2" xref="S3.E11.m1.2.2.1.1.3.2.cmml">𝐅</mi><mi id="S3.E11.m1.2.2.1.1.3.3" xref="S3.E11.m1.2.2.1.1.3.3.cmml">u</mi></msup><mo id="S3.E11.m1.2.2.1.1.4" xref="S3.E11.m1.2.2.1.1.4.cmml">=</mo><mrow id="S3.E11.m1.2.2.1.1.5.2" xref="S3.E11.m1.2.2.1.1.5.1.cmml"><mo id="S3.E11.m1.2.2.1.1.5.2.1" xref="S3.E11.m1.2.2.1.1.5.1.1.cmml">[</mo><mtable displaystyle="true" id="S3.E11.m1.1.1" rowspacing="0pt" xref="S3.E11.m1.1.1.cmml"><mtr id="S3.E11.m1.1.1a" xref="S3.E11.m1.1.1.cmml"><mtd id="S3.E11.m1.1.1b" xref="S3.E11.m1.1.1.cmml"><msubsup id="S3.E11.m1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.1.1.1.1.1.2.2" xref="S3.E11.m1.1.1.1.1.1.2.2.cmml">𝐟</mi><mn id="S3.E11.m1.1.1.1.1.1.2.3" xref="S3.E11.m1.1.1.1.1.1.2.3.cmml">1</mn><mi id="S3.E11.m1.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.1.3.cmml">u</mi></msubsup></mtd></mtr><mtr id="S3.E11.m1.1.1c" xref="S3.E11.m1.1.1.cmml"><mtd id="S3.E11.m1.1.1d" xref="S3.E11.m1.1.1.cmml"><msubsup id="S3.E11.m1.1.1.2.1.1" xref="S3.E11.m1.1.1.2.1.1.cmml"><mi id="S3.E11.m1.1.1.2.1.1.2.2" xref="S3.E11.m1.1.1.2.1.1.2.2.cmml">𝐟</mi><mn id="S3.E11.m1.1.1.2.1.1.2.3" xref="S3.E11.m1.1.1.2.1.1.2.3.cmml">2</mn><mi id="S3.E11.m1.1.1.2.1.1.3" xref="S3.E11.m1.1.1.2.1.1.3.cmml">u</mi></msubsup></mtd></mtr><mtr id="S3.E11.m1.1.1e" xref="S3.E11.m1.1.1.cmml"><mtd id="S3.E11.m1.1.1f" xref="S3.E11.m1.1.1.cmml"><mi id="S3.E11.m1.1.1.3.1.1" mathvariant="normal" xref="S3.E11.m1.1.1.3.1.1.cmml">⋮</mi></mtd></mtr><mtr id="S3.E11.m1.1.1g" xref="S3.E11.m1.1.1.cmml"><mtd id="S3.E11.m1.1.1h" xref="S3.E11.m1.1.1.cmml"><msubsup id="S3.E11.m1.1.1.4.1.1" xref="S3.E11.m1.1.1.4.1.1.cmml"><mi id="S3.E11.m1.1.1.4.1.1.2.2" xref="S3.E11.m1.1.1.4.1.1.2.2.cmml">𝐟</mi><mi id="S3.E11.m1.1.1.4.1.1.2.3" xref="S3.E11.m1.1.1.4.1.1.2.3.cmml">n</mi><mi id="S3.E11.m1.1.1.4.1.1.3" xref="S3.E11.m1.1.1.4.1.1.3.cmml">u</mi></msubsup></mtd></mtr></mtable><mo id="S3.E11.m1.2.2.1.1.5.2.2" xref="S3.E11.m1.2.2.1.1.5.1.1.cmml">]</mo></mrow><mo id="S3.E11.m1.2.2.1.1.6" xref="S3.E11.m1.2.2.1.1.6.cmml">=</mo><mrow id="S3.E11.m1.2.2.1.1.1" xref="S3.E11.m1.2.2.1.1.1.cmml"><mrow id="S3.E11.m1.2.2.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.1.cmml"><mtext id="S3.E11.m1.2.2.1.1.1.1.3" xref="S3.E11.m1.2.2.1.1.1.1.3a.cmml">LayerNorm</mtext><mo id="S3.E11.m1.2.2.1.1.1.1.2" xref="S3.E11.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E11.m1.2.2.1.1.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.E11.m1.2.2.1.1.1.1.1.1.2" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E11.m1.2.2.1.1.1.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.cmml"><mtext id="S3.E11.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.3a.cmml">FNN</mtext><mo id="S3.E11.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.2a.cmml">att</mtext><mi id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.2.2.1.1.1.1.1.1.3" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.2.2.1.1.1.2" xref="S3.E11.m1.2.2.1.1.1.2.cmml">+</mo><msup id="S3.E11.m1.2.2.1.1.1.3" xref="S3.E11.m1.2.2.1.1.1.3.cmml"><mtext id="S3.E11.m1.2.2.1.1.1.3.2" xref="S3.E11.m1.2.2.1.1.1.3.2a.cmml">att</mtext><mi id="S3.E11.m1.2.2.1.1.1.3.3" xref="S3.E11.m1.2.2.1.1.1.3.3.cmml">u</mi></msup></mrow></mrow><mo id="S3.E11.m1.2.2.1.2" xref="S3.E11.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.2b"><apply id="S3.E11.m1.2.2.1.1.cmml" xref="S3.E11.m1.2.2.1"><and id="S3.E11.m1.2.2.1.1a.cmml" xref="S3.E11.m1.2.2.1"></and><apply id="S3.E11.m1.2.2.1.1b.cmml" xref="S3.E11.m1.2.2.1"><eq id="S3.E11.m1.2.2.1.1.4.cmml" xref="S3.E11.m1.2.2.1.1.4"></eq><apply id="S3.E11.m1.2.2.1.1.3.cmml" xref="S3.E11.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.1.1.3.1.cmml" xref="S3.E11.m1.2.2.1.1.3">superscript</csymbol><ci id="S3.E11.m1.2.2.1.1.3.2.cmml" xref="S3.E11.m1.2.2.1.1.3.2">𝐅</ci><ci id="S3.E11.m1.2.2.1.1.3.3.cmml" xref="S3.E11.m1.2.2.1.1.3.3">𝑢</ci></apply><apply id="S3.E11.m1.2.2.1.1.5.1.cmml" xref="S3.E11.m1.2.2.1.1.5.2"><csymbol cd="latexml" id="S3.E11.m1.2.2.1.1.5.1.1.cmml" xref="S3.E11.m1.2.2.1.1.5.2.1">delimited-[]</csymbol><matrix id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1"><matrixrow id="S3.E11.m1.1.1a.cmml" xref="S3.E11.m1.1.1"><apply id="S3.E11.m1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.E11.m1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.1.1.1.1.1.2.2">𝐟</ci><cn id="S3.E11.m1.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.E11.m1.1.1.1.1.1.2.3">1</cn></apply><ci id="S3.E11.m1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.1.3">𝑢</ci></apply></matrixrow><matrixrow id="S3.E11.m1.1.1b.cmml" xref="S3.E11.m1.1.1"><apply id="S3.E11.m1.1.1.2.1.1.cmml" xref="S3.E11.m1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.2.1.1.1.cmml" xref="S3.E11.m1.1.1.2.1.1">superscript</csymbol><apply id="S3.E11.m1.1.1.2.1.1.2.cmml" xref="S3.E11.m1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.2.1.1.2.1.cmml" xref="S3.E11.m1.1.1.2.1.1">subscript</csymbol><ci id="S3.E11.m1.1.1.2.1.1.2.2.cmml" xref="S3.E11.m1.1.1.2.1.1.2.2">𝐟</ci><cn id="S3.E11.m1.1.1.2.1.1.2.3.cmml" type="integer" xref="S3.E11.m1.1.1.2.1.1.2.3">2</cn></apply><ci id="S3.E11.m1.1.1.2.1.1.3.cmml" xref="S3.E11.m1.1.1.2.1.1.3">𝑢</ci></apply></matrixrow><matrixrow id="S3.E11.m1.1.1c.cmml" xref="S3.E11.m1.1.1"><ci id="S3.E11.m1.1.1.3.1.1.cmml" xref="S3.E11.m1.1.1.3.1.1">⋮</ci></matrixrow><matrixrow id="S3.E11.m1.1.1d.cmml" xref="S3.E11.m1.1.1"><apply id="S3.E11.m1.1.1.4.1.1.cmml" xref="S3.E11.m1.1.1.4.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.4.1.1.1.cmml" xref="S3.E11.m1.1.1.4.1.1">superscript</csymbol><apply id="S3.E11.m1.1.1.4.1.1.2.cmml" xref="S3.E11.m1.1.1.4.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.4.1.1.2.1.cmml" xref="S3.E11.m1.1.1.4.1.1">subscript</csymbol><ci id="S3.E11.m1.1.1.4.1.1.2.2.cmml" xref="S3.E11.m1.1.1.4.1.1.2.2">𝐟</ci><ci id="S3.E11.m1.1.1.4.1.1.2.3.cmml" xref="S3.E11.m1.1.1.4.1.1.2.3">𝑛</ci></apply><ci id="S3.E11.m1.1.1.4.1.1.3.cmml" xref="S3.E11.m1.1.1.4.1.1.3">𝑢</ci></apply></matrixrow></matrix></apply></apply><apply id="S3.E11.m1.2.2.1.1c.cmml" xref="S3.E11.m1.2.2.1"><eq id="S3.E11.m1.2.2.1.1.6.cmml" xref="S3.E11.m1.2.2.1.1.6"></eq><share href="https://arxiv.org/html/2407.02833v1#S3.E11.m1.2.2.1.1.5.cmml" id="S3.E11.m1.2.2.1.1d.cmml" xref="S3.E11.m1.2.2.1"></share><apply id="S3.E11.m1.2.2.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1"><plus id="S3.E11.m1.2.2.1.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.1.2"></plus><apply id="S3.E11.m1.2.2.1.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1"><times id="S3.E11.m1.2.2.1.1.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.1.1.2"></times><ci id="S3.E11.m1.2.2.1.1.1.1.3a.cmml" xref="S3.E11.m1.2.2.1.1.1.1.3"><mtext id="S3.E11.m1.2.2.1.1.1.1.3.cmml" xref="S3.E11.m1.2.2.1.1.1.1.3">LayerNorm</mtext></ci><apply id="S3.E11.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1"><times id="S3.E11.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.2"></times><ci id="S3.E11.m1.2.2.1.1.1.1.1.1.1.3a.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.3"><mtext id="S3.E11.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.3">FNN</mtext></ci><apply id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.2a.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.2"><mtext id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">att</mtext></ci><ci id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑢</ci></apply></apply></apply><apply id="S3.E11.m1.2.2.1.1.1.3.cmml" xref="S3.E11.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.1.1.1.3.1.cmml" xref="S3.E11.m1.2.2.1.1.1.3">superscript</csymbol><ci id="S3.E11.m1.2.2.1.1.1.3.2a.cmml" xref="S3.E11.m1.2.2.1.1.1.3.2"><mtext id="S3.E11.m1.2.2.1.1.1.3.2.cmml" xref="S3.E11.m1.2.2.1.1.1.3.2">att</mtext></ci><ci id="S3.E11.m1.2.2.1.1.1.3.3.cmml" xref="S3.E11.m1.2.2.1.1.1.3.3">𝑢</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.2c">\mathbf{F}^{u}=\left[\begin{array}[]{c}\mathbf{f}_{1}^{u}\\
\mathbf{f}_{2}^{u}\\
\vdots\\
\mathbf{f}_{n}^{u}\end{array}\right]=\text{LayerNorm}\left(\text{FNN}(\text{%
att}^{u})\right)+\text{att}^{u},</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.2d">bold_F start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = [ start_ARRAY start_ROW start_CELL bold_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT end_CELL end_ROW start_ROW start_CELL bold_f start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT end_CELL end_ROW start_ROW start_CELL ⋮ end_CELL end_ROW start_ROW start_CELL bold_f start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT end_CELL end_ROW end_ARRAY ] = LayerNorm ( FNN ( att start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) ) + att start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS5.Px3.p6">
<p class="ltx_p" id="S3.SS2.SSS5.Px3.p6.6">where <math alttext="\text{att}^{u}\in\mathbb{R}^{n\times d}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px3.p6.1.m1.1"><semantics id="S3.SS2.SSS5.Px3.p6.1.m1.1a"><mrow id="S3.SS2.SSS5.Px3.p6.1.m1.1.1" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.cmml"><msup id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.2" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.2.cmml"><mtext id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.2.2" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.2.2a.cmml">att</mtext><mi id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.2.3" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.2.3.cmml">u</mi></msup><mo id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.1" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.2" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.3" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.3.2" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.3.2.cmml">n</mi><mo id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.3.3" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px3.p6.1.m1.1b"><apply id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.cmml" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1"><in id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.1.cmml" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.1"></in><apply id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.2.cmml" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.2.2a.cmml" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.2.2"><mtext id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.2.2">att</mtext></ci><ci id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.2.3.cmml" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.2.3">𝑢</ci></apply><apply id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.cmml" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.3"><times id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.3.1"></times><ci id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.3.2">𝑛</ci><ci id="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS5.Px3.p6.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px3.p6.1.m1.1c">\text{att}^{u}\in\mathbb{R}^{n\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px3.p6.1.m1.1d">att start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the result obtained after the output of the multi-head attention layer goes through layer normalization and residual connection. <math alttext="\mathbf{F}^{u}\in\mathbb{R}^{n\times d}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px3.p6.2.m2.1"><semantics id="S3.SS2.SSS5.Px3.p6.2.m2.1a"><mrow id="S3.SS2.SSS5.Px3.p6.2.m2.1.1" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.cmml"><msup id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.2" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.2.cmml"><mi id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.2.2" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.2.2.cmml">𝐅</mi><mi id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.2.3" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.2.3.cmml">u</mi></msup><mo id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.1" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.2" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.3" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.3.cmml"><mi id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.3.2" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.3.2.cmml">n</mi><mo id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.3.3" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px3.p6.2.m2.1b"><apply id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.cmml" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1"><in id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.1.cmml" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.1"></in><apply id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.2.cmml" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.2.2">𝐅</ci><ci id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.2.3.cmml" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.2.3">𝑢</ci></apply><apply id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.cmml" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.3"><times id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.3.1"></times><ci id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.3.2">𝑛</ci><ci id="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.SSS5.Px3.p6.2.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px3.p6.2.m2.1c">\mathbf{F}^{u}\in\mathbb{R}^{n\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px3.p6.2.m2.1d">bold_F start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the final alignment matrix, and <math alttext="\mathbf{f}_{t}^{u}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px3.p6.3.m3.1"><semantics id="S3.SS2.SSS5.Px3.p6.3.m3.1a"><mrow id="S3.SS2.SSS5.Px3.p6.3.m3.1.1" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.cmml"><msubsup id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2.cmml"><mi id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2.2.2" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2.2.2.cmml">𝐟</mi><mi id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2.2.3" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2.2.3.cmml">t</mi><mi id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2.3" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.1" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.3" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.3.cmml"><mi id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.3.2" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.3.3" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px3.p6.3.m3.1b"><apply id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.cmml" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1"><in id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.1.cmml" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.1"></in><apply id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2.cmml" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2.1.cmml" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2">superscript</csymbol><apply id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2.2.cmml" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2.2.1.cmml" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2.2.2.cmml" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2.2.2">𝐟</ci><ci id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2.2.3.cmml" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2.2.3">𝑡</ci></apply><ci id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2.3.cmml" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.2.3">𝑢</ci></apply><apply id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.3.cmml" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.3.2">ℝ</ci><ci id="S3.SS2.SSS5.Px3.p6.3.m3.1.1.3.3.cmml" xref="S3.SS2.SSS5.Px3.p6.3.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px3.p6.3.m3.1c">\mathbf{f}_{t}^{u}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px3.p6.3.m3.1d">bold_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the alignment vector corresponding to the feature vector <math alttext="\mathbf{q}_{t}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px3.p6.4.m4.1"><semantics id="S3.SS2.SSS5.Px3.p6.4.m4.1a"><msubsup id="S3.SS2.SSS5.Px3.p6.4.m4.1.1" xref="S3.SS2.SSS5.Px3.p6.4.m4.1.1.cmml"><mi id="S3.SS2.SSS5.Px3.p6.4.m4.1.1.2.2" xref="S3.SS2.SSS5.Px3.p6.4.m4.1.1.2.2.cmml">𝐪</mi><mi id="S3.SS2.SSS5.Px3.p6.4.m4.1.1.2.3" xref="S3.SS2.SSS5.Px3.p6.4.m4.1.1.2.3.cmml">t</mi><mi id="S3.SS2.SSS5.Px3.p6.4.m4.1.1.3" xref="S3.SS2.SSS5.Px3.p6.4.m4.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px3.p6.4.m4.1b"><apply id="S3.SS2.SSS5.Px3.p6.4.m4.1.1.cmml" xref="S3.SS2.SSS5.Px3.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px3.p6.4.m4.1.1.1.cmml" xref="S3.SS2.SSS5.Px3.p6.4.m4.1.1">superscript</csymbol><apply id="S3.SS2.SSS5.Px3.p6.4.m4.1.1.2.cmml" xref="S3.SS2.SSS5.Px3.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS5.Px3.p6.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS5.Px3.p6.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS5.Px3.p6.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS5.Px3.p6.4.m4.1.1.2.2">𝐪</ci><ci id="S3.SS2.SSS5.Px3.p6.4.m4.1.1.2.3.cmml" xref="S3.SS2.SSS5.Px3.p6.4.m4.1.1.2.3">𝑡</ci></apply><ci id="S3.SS2.SSS5.Px3.p6.4.m4.1.1.3.cmml" xref="S3.SS2.SSS5.Px3.p6.4.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px3.p6.4.m4.1c">\mathbf{q}_{t}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px3.p6.4.m4.1d">bold_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> of the subsequence composed of the first <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px3.p6.5.m5.1"><semantics id="S3.SS2.SSS5.Px3.p6.5.m5.1a"><mi id="S3.SS2.SSS5.Px3.p6.5.m5.1.1" xref="S3.SS2.SSS5.Px3.p6.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px3.p6.5.m5.1b"><ci id="S3.SS2.SSS5.Px3.p6.5.m5.1.1.cmml" xref="S3.SS2.SSS5.Px3.p6.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px3.p6.5.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px3.p6.5.m5.1d">italic_t</annotation></semantics></math> items in user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS2.SSS5.Px3.p6.6.m6.1"><semantics id="S3.SS2.SSS5.Px3.p6.6.m6.1a"><mi id="S3.SS2.SSS5.Px3.p6.6.m6.1.1" xref="S3.SS2.SSS5.Px3.p6.6.m6.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS5.Px3.p6.6.m6.1b"><ci id="S3.SS2.SSS5.Px3.p6.6.m6.1.1.cmml" xref="S3.SS2.SSS5.Px3.p6.6.m6.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS5.Px3.p6.6.m6.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS5.Px3.p6.6.m6.1d">italic_u</annotation></semantics></math>’s interaction sequence.</p>
</div>
</section>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS6">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.6 </span>Prediction Module</h4>
<div class="ltx_para" id="S3.SS2.SSS6.p1">
<p class="ltx_p" id="S3.SS2.SSS6.p1.5">To prevent overfitting and reduce the number of parameters, candidate item embeddings are still obtained by retrieving the embedding matrix <math alttext="\mathbf{M}" class="ltx_Math" display="inline" id="S3.SS2.SSS6.p1.1.m1.1"><semantics id="S3.SS2.SSS6.p1.1.m1.1a"><mi id="S3.SS2.SSS6.p1.1.m1.1.1" xref="S3.SS2.SSS6.p1.1.m1.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.p1.1.m1.1b"><ci id="S3.SS2.SSS6.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS6.p1.1.m1.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.p1.1.m1.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.p1.1.m1.1d">bold_M</annotation></semantics></math> of embedding layer. Given the embedding vector <math alttext="\mathbf{m}_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS6.p1.2.m2.1"><semantics id="S3.SS2.SSS6.p1.2.m2.1a"><msub id="S3.SS2.SSS6.p1.2.m2.1.1" xref="S3.SS2.SSS6.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS6.p1.2.m2.1.1.2" xref="S3.SS2.SSS6.p1.2.m2.1.1.2.cmml">𝐦</mi><mi id="S3.SS2.SSS6.p1.2.m2.1.1.3" xref="S3.SS2.SSS6.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.p1.2.m2.1b"><apply id="S3.SS2.SSS6.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS6.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS6.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS6.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS6.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS6.p1.2.m2.1.1.2">𝐦</ci><ci id="S3.SS2.SSS6.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS6.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.p1.2.m2.1c">\mathbf{m}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.p1.2.m2.1d">bold_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> of candidate item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.SSS6.p1.3.m3.1"><semantics id="S3.SS2.SSS6.p1.3.m3.1a"><mi id="S3.SS2.SSS6.p1.3.m3.1.1" xref="S3.SS2.SSS6.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.p1.3.m3.1b"><ci id="S3.SS2.SSS6.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS6.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.p1.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.p1.3.m3.1d">italic_i</annotation></semantics></math> and the alignment vector <math alttext="\mathbf{f}_{t}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS6.p1.4.m4.1"><semantics id="S3.SS2.SSS6.p1.4.m4.1a"><msubsup id="S3.SS2.SSS6.p1.4.m4.1.1" xref="S3.SS2.SSS6.p1.4.m4.1.1.cmml"><mi id="S3.SS2.SSS6.p1.4.m4.1.1.2.2" xref="S3.SS2.SSS6.p1.4.m4.1.1.2.2.cmml">𝐟</mi><mi id="S3.SS2.SSS6.p1.4.m4.1.1.2.3" xref="S3.SS2.SSS6.p1.4.m4.1.1.2.3.cmml">t</mi><mi id="S3.SS2.SSS6.p1.4.m4.1.1.3" xref="S3.SS2.SSS6.p1.4.m4.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.p1.4.m4.1b"><apply id="S3.SS2.SSS6.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS6.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS6.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS6.p1.4.m4.1.1">superscript</csymbol><apply id="S3.SS2.SSS6.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS6.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS6.p1.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS6.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS6.p1.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS6.p1.4.m4.1.1.2.2">𝐟</ci><ci id="S3.SS2.SSS6.p1.4.m4.1.1.2.3.cmml" xref="S3.SS2.SSS6.p1.4.m4.1.1.2.3">𝑡</ci></apply><ci id="S3.SS2.SSS6.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS6.p1.4.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.p1.4.m4.1c">\mathbf{f}_{t}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.p1.4.m4.1d">bold_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>, they are input into the prediction layer to obtain the recommendation score based on the feature vector <math alttext="\mathbf{q}_{t}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS6.p1.5.m5.1"><semantics id="S3.SS2.SSS6.p1.5.m5.1a"><msubsup id="S3.SS2.SSS6.p1.5.m5.1.1" xref="S3.SS2.SSS6.p1.5.m5.1.1.cmml"><mi id="S3.SS2.SSS6.p1.5.m5.1.1.2.2" xref="S3.SS2.SSS6.p1.5.m5.1.1.2.2.cmml">𝐪</mi><mi id="S3.SS2.SSS6.p1.5.m5.1.1.2.3" xref="S3.SS2.SSS6.p1.5.m5.1.1.2.3.cmml">t</mi><mi id="S3.SS2.SSS6.p1.5.m5.1.1.3" xref="S3.SS2.SSS6.p1.5.m5.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.p1.5.m5.1b"><apply id="S3.SS2.SSS6.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS6.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS6.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS6.p1.5.m5.1.1">superscript</csymbol><apply id="S3.SS2.SSS6.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS6.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS6.p1.5.m5.1.1.2.1.cmml" xref="S3.SS2.SSS6.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS6.p1.5.m5.1.1.2.2.cmml" xref="S3.SS2.SSS6.p1.5.m5.1.1.2.2">𝐪</ci><ci id="S3.SS2.SSS6.p1.5.m5.1.1.2.3.cmml" xref="S3.SS2.SSS6.p1.5.m5.1.1.2.3">𝑡</ci></apply><ci id="S3.SS2.SSS6.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS6.p1.5.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.p1.5.m5.1c">\mathbf{q}_{t}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.p1.5.m5.1d">bold_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>. The formula is as follows:</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS6.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{r}_{t,i}^{u}=\mathbf{f}_{t}^{u}\cdot\mathbf{m}_{i}," class="ltx_Math" display="block" id="S3.E12.m1.3"><semantics id="S3.E12.m1.3a"><mrow id="S3.E12.m1.3.3.1" xref="S3.E12.m1.3.3.1.1.cmml"><mrow id="S3.E12.m1.3.3.1.1" xref="S3.E12.m1.3.3.1.1.cmml"><msubsup id="S3.E12.m1.3.3.1.1.2" xref="S3.E12.m1.3.3.1.1.2.cmml"><mi id="S3.E12.m1.3.3.1.1.2.2.2" xref="S3.E12.m1.3.3.1.1.2.2.2.cmml">𝐫</mi><mrow id="S3.E12.m1.2.2.2.4" xref="S3.E12.m1.2.2.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.cmml">t</mi><mo id="S3.E12.m1.2.2.2.4.1" xref="S3.E12.m1.2.2.2.3.cmml">,</mo><mi id="S3.E12.m1.2.2.2.2" xref="S3.E12.m1.2.2.2.2.cmml">i</mi></mrow><mi id="S3.E12.m1.3.3.1.1.2.3" xref="S3.E12.m1.3.3.1.1.2.3.cmml">u</mi></msubsup><mo id="S3.E12.m1.3.3.1.1.1" xref="S3.E12.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E12.m1.3.3.1.1.3" xref="S3.E12.m1.3.3.1.1.3.cmml"><msubsup id="S3.E12.m1.3.3.1.1.3.2" xref="S3.E12.m1.3.3.1.1.3.2.cmml"><mi id="S3.E12.m1.3.3.1.1.3.2.2.2" xref="S3.E12.m1.3.3.1.1.3.2.2.2.cmml">𝐟</mi><mi id="S3.E12.m1.3.3.1.1.3.2.2.3" xref="S3.E12.m1.3.3.1.1.3.2.2.3.cmml">t</mi><mi id="S3.E12.m1.3.3.1.1.3.2.3" xref="S3.E12.m1.3.3.1.1.3.2.3.cmml">u</mi></msubsup><mo id="S3.E12.m1.3.3.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E12.m1.3.3.1.1.3.1.cmml">⋅</mo><msub id="S3.E12.m1.3.3.1.1.3.3" xref="S3.E12.m1.3.3.1.1.3.3.cmml"><mi id="S3.E12.m1.3.3.1.1.3.3.2" xref="S3.E12.m1.3.3.1.1.3.3.2.cmml">𝐦</mi><mi id="S3.E12.m1.3.3.1.1.3.3.3" xref="S3.E12.m1.3.3.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.E12.m1.3.3.1.2" xref="S3.E12.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.3b"><apply id="S3.E12.m1.3.3.1.1.cmml" xref="S3.E12.m1.3.3.1"><eq id="S3.E12.m1.3.3.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1"></eq><apply id="S3.E12.m1.3.3.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.2.1.cmml" xref="S3.E12.m1.3.3.1.1.2">superscript</csymbol><apply id="S3.E12.m1.3.3.1.1.2.2.cmml" xref="S3.E12.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.2.2.1.cmml" xref="S3.E12.m1.3.3.1.1.2">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.2.2.2.cmml" xref="S3.E12.m1.3.3.1.1.2.2.2">𝐫</ci><list id="S3.E12.m1.2.2.2.3.cmml" xref="S3.E12.m1.2.2.2.4"><ci id="S3.E12.m1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1">𝑡</ci><ci id="S3.E12.m1.2.2.2.2.cmml" xref="S3.E12.m1.2.2.2.2">𝑖</ci></list></apply><ci id="S3.E12.m1.3.3.1.1.2.3.cmml" xref="S3.E12.m1.3.3.1.1.2.3">𝑢</ci></apply><apply id="S3.E12.m1.3.3.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.3"><ci id="S3.E12.m1.3.3.1.1.3.1.cmml" xref="S3.E12.m1.3.3.1.1.3.1">⋅</ci><apply id="S3.E12.m1.3.3.1.1.3.2.cmml" xref="S3.E12.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.3.2.1.cmml" xref="S3.E12.m1.3.3.1.1.3.2">superscript</csymbol><apply id="S3.E12.m1.3.3.1.1.3.2.2.cmml" xref="S3.E12.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.3.2.2.1.cmml" xref="S3.E12.m1.3.3.1.1.3.2">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.3.2.2.2.cmml" xref="S3.E12.m1.3.3.1.1.3.2.2.2">𝐟</ci><ci id="S3.E12.m1.3.3.1.1.3.2.2.3.cmml" xref="S3.E12.m1.3.3.1.1.3.2.2.3">𝑡</ci></apply><ci id="S3.E12.m1.3.3.1.1.3.2.3.cmml" xref="S3.E12.m1.3.3.1.1.3.2.3">𝑢</ci></apply><apply id="S3.E12.m1.3.3.1.1.3.3.cmml" xref="S3.E12.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.3.3.1.cmml" xref="S3.E12.m1.3.3.1.1.3.3">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.3.3.2.cmml" xref="S3.E12.m1.3.3.1.1.3.3.2">𝐦</ci><ci id="S3.E12.m1.3.3.1.1.3.3.3.cmml" xref="S3.E12.m1.3.3.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.3c">\mathbf{r}_{t,i}^{u}=\mathbf{f}_{t}^{u}\cdot\mathbf{m}_{i},</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.3d">bold_r start_POSTSUBSCRIPT italic_t , italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = bold_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ⋅ bold_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS6.p3">
<p class="ltx_p" id="S3.SS2.SSS6.p3.5">where <math alttext="\mathbf{r}_{t,i}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS6.p3.1.m1.2"><semantics id="S3.SS2.SSS6.p3.1.m1.2a"><msubsup id="S3.SS2.SSS6.p3.1.m1.2.3" xref="S3.SS2.SSS6.p3.1.m1.2.3.cmml"><mi id="S3.SS2.SSS6.p3.1.m1.2.3.2.2" xref="S3.SS2.SSS6.p3.1.m1.2.3.2.2.cmml">𝐫</mi><mrow id="S3.SS2.SSS6.p3.1.m1.2.2.2.4" xref="S3.SS2.SSS6.p3.1.m1.2.2.2.3.cmml"><mi id="S3.SS2.SSS6.p3.1.m1.1.1.1.1" xref="S3.SS2.SSS6.p3.1.m1.1.1.1.1.cmml">t</mi><mo id="S3.SS2.SSS6.p3.1.m1.2.2.2.4.1" xref="S3.SS2.SSS6.p3.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS2.SSS6.p3.1.m1.2.2.2.2" xref="S3.SS2.SSS6.p3.1.m1.2.2.2.2.cmml">i</mi></mrow><mi id="S3.SS2.SSS6.p3.1.m1.2.3.3" xref="S3.SS2.SSS6.p3.1.m1.2.3.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.p3.1.m1.2b"><apply id="S3.SS2.SSS6.p3.1.m1.2.3.cmml" xref="S3.SS2.SSS6.p3.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS6.p3.1.m1.2.3.1.cmml" xref="S3.SS2.SSS6.p3.1.m1.2.3">superscript</csymbol><apply id="S3.SS2.SSS6.p3.1.m1.2.3.2.cmml" xref="S3.SS2.SSS6.p3.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS6.p3.1.m1.2.3.2.1.cmml" xref="S3.SS2.SSS6.p3.1.m1.2.3">subscript</csymbol><ci id="S3.SS2.SSS6.p3.1.m1.2.3.2.2.cmml" xref="S3.SS2.SSS6.p3.1.m1.2.3.2.2">𝐫</ci><list id="S3.SS2.SSS6.p3.1.m1.2.2.2.3.cmml" xref="S3.SS2.SSS6.p3.1.m1.2.2.2.4"><ci id="S3.SS2.SSS6.p3.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS6.p3.1.m1.1.1.1.1">𝑡</ci><ci id="S3.SS2.SSS6.p3.1.m1.2.2.2.2.cmml" xref="S3.SS2.SSS6.p3.1.m1.2.2.2.2">𝑖</ci></list></apply><ci id="S3.SS2.SSS6.p3.1.m1.2.3.3.cmml" xref="S3.SS2.SSS6.p3.1.m1.2.3.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.p3.1.m1.2c">\mathbf{r}_{t,i}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.p3.1.m1.2d">bold_r start_POSTSUBSCRIPT italic_t , italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the prediction score of candidate item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.SSS6.p3.2.m2.1"><semantics id="S3.SS2.SSS6.p3.2.m2.1a"><mi id="S3.SS2.SSS6.p3.2.m2.1.1" xref="S3.SS2.SSS6.p3.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.p3.2.m2.1b"><ci id="S3.SS2.SSS6.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS6.p3.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.p3.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.p3.2.m2.1d">italic_i</annotation></semantics></math> as the next interaction item <math alttext="\mathbf{s}_{t+1}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS6.p3.3.m3.1"><semantics id="S3.SS2.SSS6.p3.3.m3.1a"><msubsup id="S3.SS2.SSS6.p3.3.m3.1.1" xref="S3.SS2.SSS6.p3.3.m3.1.1.cmml"><mi id="S3.SS2.SSS6.p3.3.m3.1.1.2.2" xref="S3.SS2.SSS6.p3.3.m3.1.1.2.2.cmml">𝐬</mi><mrow id="S3.SS2.SSS6.p3.3.m3.1.1.2.3" xref="S3.SS2.SSS6.p3.3.m3.1.1.2.3.cmml"><mi id="S3.SS2.SSS6.p3.3.m3.1.1.2.3.2" xref="S3.SS2.SSS6.p3.3.m3.1.1.2.3.2.cmml">t</mi><mo id="S3.SS2.SSS6.p3.3.m3.1.1.2.3.1" xref="S3.SS2.SSS6.p3.3.m3.1.1.2.3.1.cmml">+</mo><mn id="S3.SS2.SSS6.p3.3.m3.1.1.2.3.3" xref="S3.SS2.SSS6.p3.3.m3.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS6.p3.3.m3.1.1.3" xref="S3.SS2.SSS6.p3.3.m3.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.p3.3.m3.1b"><apply id="S3.SS2.SSS6.p3.3.m3.1.1.cmml" xref="S3.SS2.SSS6.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS6.p3.3.m3.1.1.1.cmml" xref="S3.SS2.SSS6.p3.3.m3.1.1">superscript</csymbol><apply id="S3.SS2.SSS6.p3.3.m3.1.1.2.cmml" xref="S3.SS2.SSS6.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS6.p3.3.m3.1.1.2.1.cmml" xref="S3.SS2.SSS6.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS6.p3.3.m3.1.1.2.2.cmml" xref="S3.SS2.SSS6.p3.3.m3.1.1.2.2">𝐬</ci><apply id="S3.SS2.SSS6.p3.3.m3.1.1.2.3.cmml" xref="S3.SS2.SSS6.p3.3.m3.1.1.2.3"><plus id="S3.SS2.SSS6.p3.3.m3.1.1.2.3.1.cmml" xref="S3.SS2.SSS6.p3.3.m3.1.1.2.3.1"></plus><ci id="S3.SS2.SSS6.p3.3.m3.1.1.2.3.2.cmml" xref="S3.SS2.SSS6.p3.3.m3.1.1.2.3.2">𝑡</ci><cn id="S3.SS2.SSS6.p3.3.m3.1.1.2.3.3.cmml" type="integer" xref="S3.SS2.SSS6.p3.3.m3.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS2.SSS6.p3.3.m3.1.1.3.cmml" xref="S3.SS2.SSS6.p3.3.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.p3.3.m3.1c">\mathbf{s}_{t+1}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.p3.3.m3.1d">bold_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> in the user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS2.SSS6.p3.4.m4.1"><semantics id="S3.SS2.SSS6.p3.4.m4.1a"><mi id="S3.SS2.SSS6.p3.4.m4.1.1" xref="S3.SS2.SSS6.p3.4.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.p3.4.m4.1b"><ci id="S3.SS2.SSS6.p3.4.m4.1.1.cmml" xref="S3.SS2.SSS6.p3.4.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.p3.4.m4.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.p3.4.m4.1d">italic_u</annotation></semantics></math>’s interaction sequence <math alttext="\{\mathbf{s}_{1}^{u},\mathbf{s}_{2}^{u},\ldots,\mathbf{s}_{t}^{u}\}" class="ltx_Math" display="inline" id="S3.SS2.SSS6.p3.5.m5.4"><semantics id="S3.SS2.SSS6.p3.5.m5.4a"><mrow id="S3.SS2.SSS6.p3.5.m5.4.4.3" xref="S3.SS2.SSS6.p3.5.m5.4.4.4.cmml"><mo id="S3.SS2.SSS6.p3.5.m5.4.4.3.4" stretchy="false" xref="S3.SS2.SSS6.p3.5.m5.4.4.4.cmml">{</mo><msubsup id="S3.SS2.SSS6.p3.5.m5.2.2.1.1" xref="S3.SS2.SSS6.p3.5.m5.2.2.1.1.cmml"><mi id="S3.SS2.SSS6.p3.5.m5.2.2.1.1.2.2" xref="S3.SS2.SSS6.p3.5.m5.2.2.1.1.2.2.cmml">𝐬</mi><mn id="S3.SS2.SSS6.p3.5.m5.2.2.1.1.2.3" xref="S3.SS2.SSS6.p3.5.m5.2.2.1.1.2.3.cmml">1</mn><mi id="S3.SS2.SSS6.p3.5.m5.2.2.1.1.3" xref="S3.SS2.SSS6.p3.5.m5.2.2.1.1.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS6.p3.5.m5.4.4.3.5" xref="S3.SS2.SSS6.p3.5.m5.4.4.4.cmml">,</mo><msubsup id="S3.SS2.SSS6.p3.5.m5.3.3.2.2" xref="S3.SS2.SSS6.p3.5.m5.3.3.2.2.cmml"><mi id="S3.SS2.SSS6.p3.5.m5.3.3.2.2.2.2" xref="S3.SS2.SSS6.p3.5.m5.3.3.2.2.2.2.cmml">𝐬</mi><mn id="S3.SS2.SSS6.p3.5.m5.3.3.2.2.2.3" xref="S3.SS2.SSS6.p3.5.m5.3.3.2.2.2.3.cmml">2</mn><mi id="S3.SS2.SSS6.p3.5.m5.3.3.2.2.3" xref="S3.SS2.SSS6.p3.5.m5.3.3.2.2.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS6.p3.5.m5.4.4.3.6" xref="S3.SS2.SSS6.p3.5.m5.4.4.4.cmml">,</mo><mi id="S3.SS2.SSS6.p3.5.m5.1.1" mathvariant="normal" xref="S3.SS2.SSS6.p3.5.m5.1.1.cmml">…</mi><mo id="S3.SS2.SSS6.p3.5.m5.4.4.3.7" xref="S3.SS2.SSS6.p3.5.m5.4.4.4.cmml">,</mo><msubsup id="S3.SS2.SSS6.p3.5.m5.4.4.3.3" xref="S3.SS2.SSS6.p3.5.m5.4.4.3.3.cmml"><mi id="S3.SS2.SSS6.p3.5.m5.4.4.3.3.2.2" xref="S3.SS2.SSS6.p3.5.m5.4.4.3.3.2.2.cmml">𝐬</mi><mi id="S3.SS2.SSS6.p3.5.m5.4.4.3.3.2.3" xref="S3.SS2.SSS6.p3.5.m5.4.4.3.3.2.3.cmml">t</mi><mi id="S3.SS2.SSS6.p3.5.m5.4.4.3.3.3" xref="S3.SS2.SSS6.p3.5.m5.4.4.3.3.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS6.p3.5.m5.4.4.3.8" stretchy="false" xref="S3.SS2.SSS6.p3.5.m5.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.p3.5.m5.4b"><set id="S3.SS2.SSS6.p3.5.m5.4.4.4.cmml" xref="S3.SS2.SSS6.p3.5.m5.4.4.3"><apply id="S3.SS2.SSS6.p3.5.m5.2.2.1.1.cmml" xref="S3.SS2.SSS6.p3.5.m5.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS6.p3.5.m5.2.2.1.1.1.cmml" xref="S3.SS2.SSS6.p3.5.m5.2.2.1.1">superscript</csymbol><apply id="S3.SS2.SSS6.p3.5.m5.2.2.1.1.2.cmml" xref="S3.SS2.SSS6.p3.5.m5.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS6.p3.5.m5.2.2.1.1.2.1.cmml" xref="S3.SS2.SSS6.p3.5.m5.2.2.1.1">subscript</csymbol><ci id="S3.SS2.SSS6.p3.5.m5.2.2.1.1.2.2.cmml" xref="S3.SS2.SSS6.p3.5.m5.2.2.1.1.2.2">𝐬</ci><cn id="S3.SS2.SSS6.p3.5.m5.2.2.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS6.p3.5.m5.2.2.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS6.p3.5.m5.2.2.1.1.3.cmml" xref="S3.SS2.SSS6.p3.5.m5.2.2.1.1.3">𝑢</ci></apply><apply id="S3.SS2.SSS6.p3.5.m5.3.3.2.2.cmml" xref="S3.SS2.SSS6.p3.5.m5.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS6.p3.5.m5.3.3.2.2.1.cmml" xref="S3.SS2.SSS6.p3.5.m5.3.3.2.2">superscript</csymbol><apply id="S3.SS2.SSS6.p3.5.m5.3.3.2.2.2.cmml" xref="S3.SS2.SSS6.p3.5.m5.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS6.p3.5.m5.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS6.p3.5.m5.3.3.2.2">subscript</csymbol><ci id="S3.SS2.SSS6.p3.5.m5.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS6.p3.5.m5.3.3.2.2.2.2">𝐬</ci><cn id="S3.SS2.SSS6.p3.5.m5.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS6.p3.5.m5.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS6.p3.5.m5.3.3.2.2.3.cmml" xref="S3.SS2.SSS6.p3.5.m5.3.3.2.2.3">𝑢</ci></apply><ci id="S3.SS2.SSS6.p3.5.m5.1.1.cmml" xref="S3.SS2.SSS6.p3.5.m5.1.1">…</ci><apply id="S3.SS2.SSS6.p3.5.m5.4.4.3.3.cmml" xref="S3.SS2.SSS6.p3.5.m5.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS6.p3.5.m5.4.4.3.3.1.cmml" xref="S3.SS2.SSS6.p3.5.m5.4.4.3.3">superscript</csymbol><apply id="S3.SS2.SSS6.p3.5.m5.4.4.3.3.2.cmml" xref="S3.SS2.SSS6.p3.5.m5.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS6.p3.5.m5.4.4.3.3.2.1.cmml" xref="S3.SS2.SSS6.p3.5.m5.4.4.3.3">subscript</csymbol><ci id="S3.SS2.SSS6.p3.5.m5.4.4.3.3.2.2.cmml" xref="S3.SS2.SSS6.p3.5.m5.4.4.3.3.2.2">𝐬</ci><ci id="S3.SS2.SSS6.p3.5.m5.4.4.3.3.2.3.cmml" xref="S3.SS2.SSS6.p3.5.m5.4.4.3.3.2.3">𝑡</ci></apply><ci id="S3.SS2.SSS6.p3.5.m5.4.4.3.3.3.cmml" xref="S3.SS2.SSS6.p3.5.m5.4.4.3.3.3">𝑢</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.p3.5.m5.4c">\{\mathbf{s}_{1}^{u},\mathbf{s}_{2}^{u},\ldots,\mathbf{s}_{t}^{u}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.p3.5.m5.4d">{ bold_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , bold_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , bold_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT }</annotation></semantics></math>.</p>
</div>
<section class="ltx_paragraph" id="S3.SS2.SSS6.Px1">
<h5 class="ltx_title ltx_title_paragraph">Model Training.</h5>
<div class="ltx_para" id="S3.SS2.SSS6.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS6.Px1.p1.12">As mentioned in the Section <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S3.SS2.SSS2" title="3.2.2 Semantic Embedding Module ‣ 3.2 LANE ‣ 3 Methodology ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_tag">3.2.2</span></a>, We transform the interaction sequence <math alttext="\{S_{1}^{u},S_{2}^{u},\ldots,S_{|S^{u}|-1}^{u}\}" class="ltx_Math" display="inline" id="S3.SS2.SSS6.Px1.p1.1.m1.5"><semantics id="S3.SS2.SSS6.Px1.p1.1.m1.5a"><mrow id="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3" xref="S3.SS2.SSS6.Px1.p1.1.m1.5.5.4.cmml"><mo id="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.4" stretchy="false" xref="S3.SS2.SSS6.Px1.p1.1.m1.5.5.4.cmml">{</mo><msubsup id="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1" xref="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1.cmml"><mi id="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1.2.2" xref="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1.2.2.cmml">S</mi><mn id="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1.2.3" xref="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1.2.3.cmml">1</mn><mi id="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1.3" xref="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.5" xref="S3.SS2.SSS6.Px1.p1.1.m1.5.5.4.cmml">,</mo><msubsup id="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2" xref="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2.cmml"><mi id="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2.2.2" xref="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2.2.2.cmml">S</mi><mn id="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2.2.3" xref="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2.2.3.cmml">2</mn><mi id="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2.3" xref="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.6" xref="S3.SS2.SSS6.Px1.p1.1.m1.5.5.4.cmml">,</mo><mi id="S3.SS2.SSS6.Px1.p1.1.m1.2.2" mathvariant="normal" xref="S3.SS2.SSS6.Px1.p1.1.m1.2.2.cmml">…</mi><mo id="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.7" xref="S3.SS2.SSS6.Px1.p1.1.m1.5.5.4.cmml">,</mo><msubsup id="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.3" xref="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.3.cmml"><mi id="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.3.2.2" xref="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.3.2.2.cmml">S</mi><mrow id="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1" xref="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.cmml"><mrow id="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.1" xref="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.2.cmml"><mo id="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.2.1.cmml">|</mo><msup id="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.1.1" xref="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.1.1.2" xref="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.1.1.2.cmml">S</mi><mi id="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.1.1.3" xref="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.2" xref="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.2.cmml">−</mo><mn id="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.3" xref="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.3.3" xref="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.3.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.8" stretchy="false" xref="S3.SS2.SSS6.Px1.p1.1.m1.5.5.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.Px1.p1.1.m1.5b"><set id="S3.SS2.SSS6.Px1.p1.1.m1.5.5.4.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3"><apply id="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1">superscript</csymbol><apply id="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1.2.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1.2.1.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1">subscript</csymbol><ci id="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1.2.2.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1.2.2">𝑆</ci><cn id="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1.3.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.3.3.1.1.3">𝑢</ci></apply><apply id="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2.1.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2">superscript</csymbol><apply id="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2.2.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2.2.1.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2">subscript</csymbol><ci id="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2.2.2.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2.2.2">𝑆</ci><cn id="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2.3.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.4.4.2.2.3">𝑢</ci></apply><ci id="S3.SS2.SSS6.Px1.p1.1.m1.2.2.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.2.2">…</ci><apply id="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.3.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.3.1.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.3">superscript</csymbol><apply id="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.3.2.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.3.2.1.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.3">subscript</csymbol><ci id="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.3.2.2.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.3.2.2">𝑆</ci><apply id="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1"><minus id="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.2.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.2"></minus><apply id="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.1"><abs id="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.1.2"></abs><apply id="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.1.1.2">𝑆</ci><ci id="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.1.1.1.3">𝑢</ci></apply></apply><cn id="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS6.Px1.p1.1.m1.1.1.1.3">1</cn></apply></apply><ci id="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.3.3.cmml" xref="S3.SS2.SSS6.Px1.p1.1.m1.5.5.3.3.3">𝑢</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.Px1.p1.1.m1.5c">\{S_{1}^{u},S_{2}^{u},\ldots,S_{|S^{u}|-1}^{u}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.Px1.p1.1.m1.5d">{ italic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_S start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , italic_S start_POSTSUBSCRIPT | italic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT }</annotation></semantics></math> of user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS2.SSS6.Px1.p1.2.m2.1"><semantics id="S3.SS2.SSS6.Px1.p1.2.m2.1a"><mi id="S3.SS2.SSS6.Px1.p1.2.m2.1.1" xref="S3.SS2.SSS6.Px1.p1.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.Px1.p1.2.m2.1b"><ci id="S3.SS2.SSS6.Px1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.Px1.p1.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.Px1.p1.2.m2.1d">italic_u</annotation></semantics></math> into a fixed-length vector sequence <math alttext="\{\mathbf{s}_{1}^{u},\mathbf{s}_{2}^{u},\ldots,\mathbf{s}_{n}^{u}\}" class="ltx_Math" display="inline" id="S3.SS2.SSS6.Px1.p1.3.m3.4"><semantics id="S3.SS2.SSS6.Px1.p1.3.m3.4a"><mrow id="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3" xref="S3.SS2.SSS6.Px1.p1.3.m3.4.4.4.cmml"><mo id="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.4" stretchy="false" xref="S3.SS2.SSS6.Px1.p1.3.m3.4.4.4.cmml">{</mo><msubsup id="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1" xref="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1.cmml"><mi id="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1.2.2" xref="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1.2.2.cmml">𝐬</mi><mn id="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1.2.3" xref="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1.2.3.cmml">1</mn><mi id="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1.3" xref="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.5" xref="S3.SS2.SSS6.Px1.p1.3.m3.4.4.4.cmml">,</mo><msubsup id="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2" xref="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2.cmml"><mi id="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2.2.2" xref="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2.2.2.cmml">𝐬</mi><mn id="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2.2.3" xref="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2.2.3.cmml">2</mn><mi id="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2.3" xref="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.6" xref="S3.SS2.SSS6.Px1.p1.3.m3.4.4.4.cmml">,</mo><mi id="S3.SS2.SSS6.Px1.p1.3.m3.1.1" mathvariant="normal" xref="S3.SS2.SSS6.Px1.p1.3.m3.1.1.cmml">…</mi><mo id="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.7" xref="S3.SS2.SSS6.Px1.p1.3.m3.4.4.4.cmml">,</mo><msubsup id="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3" xref="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3.cmml"><mi id="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3.2.2" xref="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3.2.2.cmml">𝐬</mi><mi id="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3.2.3" xref="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3.2.3.cmml">n</mi><mi id="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3.3" xref="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.8" stretchy="false" xref="S3.SS2.SSS6.Px1.p1.3.m3.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.Px1.p1.3.m3.4b"><set id="S3.SS2.SSS6.Px1.p1.3.m3.4.4.4.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3"><apply id="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1">superscript</csymbol><apply id="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1.2.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1.2.1.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1.2.2.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1.2.2">𝐬</ci><cn id="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1.3.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.2.2.1.1.3">𝑢</ci></apply><apply id="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2.1.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2">superscript</csymbol><apply id="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2.2.2">𝐬</ci><cn id="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2.3.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.3.3.2.2.3">𝑢</ci></apply><ci id="S3.SS2.SSS6.Px1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.1.1">…</ci><apply id="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3.1.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3">superscript</csymbol><apply id="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3.2.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3.2.1.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3">subscript</csymbol><ci id="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3.2.2.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3.2.2">𝐬</ci><ci id="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3.2.3.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3.2.3">𝑛</ci></apply><ci id="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3.3.cmml" xref="S3.SS2.SSS6.Px1.p1.3.m3.4.4.3.3.3">𝑢</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.Px1.p1.3.m3.4c">\{\mathbf{s}_{1}^{u},\mathbf{s}_{2}^{u},\ldots,\mathbf{s}_{n}^{u}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.Px1.p1.3.m3.4d">{ bold_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , bold_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , bold_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT }</annotation></semantics></math>, where <math alttext="n" class="ltx_Math" display="inline" id="S3.SS2.SSS6.Px1.p1.4.m4.1"><semantics id="S3.SS2.SSS6.Px1.p1.4.m4.1a"><mi id="S3.SS2.SSS6.Px1.p1.4.m4.1.1" xref="S3.SS2.SSS6.Px1.p1.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.Px1.p1.4.m4.1b"><ci id="S3.SS2.SSS6.Px1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.Px1.p1.4.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.Px1.p1.4.m4.1d">italic_n</annotation></semantics></math> is a fixed length. We denote the collection of all user vector sequences as <math alttext="\mathbf{s}" class="ltx_Math" display="inline" id="S3.SS2.SSS6.Px1.p1.5.m5.1"><semantics id="S3.SS2.SSS6.Px1.p1.5.m5.1a"><mi id="S3.SS2.SSS6.Px1.p1.5.m5.1.1" xref="S3.SS2.SSS6.Px1.p1.5.m5.1.1.cmml">𝐬</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.Px1.p1.5.m5.1b"><ci id="S3.SS2.SSS6.Px1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.5.m5.1.1">𝐬</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.Px1.p1.5.m5.1c">\mathbf{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.Px1.p1.5.m5.1d">bold_s</annotation></semantics></math>, where <math alttext="\mathbf{s}^{u}\in\mathbf{s}" class="ltx_Math" display="inline" id="S3.SS2.SSS6.Px1.p1.6.m6.1"><semantics id="S3.SS2.SSS6.Px1.p1.6.m6.1a"><mrow id="S3.SS2.SSS6.Px1.p1.6.m6.1.1" xref="S3.SS2.SSS6.Px1.p1.6.m6.1.1.cmml"><msup id="S3.SS2.SSS6.Px1.p1.6.m6.1.1.2" xref="S3.SS2.SSS6.Px1.p1.6.m6.1.1.2.cmml"><mi id="S3.SS2.SSS6.Px1.p1.6.m6.1.1.2.2" xref="S3.SS2.SSS6.Px1.p1.6.m6.1.1.2.2.cmml">𝐬</mi><mi id="S3.SS2.SSS6.Px1.p1.6.m6.1.1.2.3" xref="S3.SS2.SSS6.Px1.p1.6.m6.1.1.2.3.cmml">u</mi></msup><mo id="S3.SS2.SSS6.Px1.p1.6.m6.1.1.1" xref="S3.SS2.SSS6.Px1.p1.6.m6.1.1.1.cmml">∈</mo><mi id="S3.SS2.SSS6.Px1.p1.6.m6.1.1.3" xref="S3.SS2.SSS6.Px1.p1.6.m6.1.1.3.cmml">𝐬</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.Px1.p1.6.m6.1b"><apply id="S3.SS2.SSS6.Px1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.6.m6.1.1"><in id="S3.SS2.SSS6.Px1.p1.6.m6.1.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.6.m6.1.1.1"></in><apply id="S3.SS2.SSS6.Px1.p1.6.m6.1.1.2.cmml" xref="S3.SS2.SSS6.Px1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.6.m6.1.1.2.1.cmml" xref="S3.SS2.SSS6.Px1.p1.6.m6.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS6.Px1.p1.6.m6.1.1.2.2.cmml" xref="S3.SS2.SSS6.Px1.p1.6.m6.1.1.2.2">𝐬</ci><ci id="S3.SS2.SSS6.Px1.p1.6.m6.1.1.2.3.cmml" xref="S3.SS2.SSS6.Px1.p1.6.m6.1.1.2.3">𝑢</ci></apply><ci id="S3.SS2.SSS6.Px1.p1.6.m6.1.1.3.cmml" xref="S3.SS2.SSS6.Px1.p1.6.m6.1.1.3">𝐬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.Px1.p1.6.m6.1c">\mathbf{s}^{u}\in\mathbf{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.Px1.p1.6.m6.1d">bold_s start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∈ bold_s</annotation></semantics></math>. Suppose given <math alttext="\{\mathbf{s}_{1}^{u},\mathbf{s}_{2}^{u},\ldots,\mathbf{s}_{t}^{u}\}" class="ltx_Math" display="inline" id="S3.SS2.SSS6.Px1.p1.7.m7.4"><semantics id="S3.SS2.SSS6.Px1.p1.7.m7.4a"><mrow id="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3" xref="S3.SS2.SSS6.Px1.p1.7.m7.4.4.4.cmml"><mo id="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.4" stretchy="false" xref="S3.SS2.SSS6.Px1.p1.7.m7.4.4.4.cmml">{</mo><msubsup id="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1" xref="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1.cmml"><mi id="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1.2.2" xref="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1.2.2.cmml">𝐬</mi><mn id="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1.2.3" xref="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1.2.3.cmml">1</mn><mi id="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1.3" xref="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.5" xref="S3.SS2.SSS6.Px1.p1.7.m7.4.4.4.cmml">,</mo><msubsup id="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2" xref="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2.cmml"><mi id="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2.2.2" xref="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2.2.2.cmml">𝐬</mi><mn id="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2.2.3" xref="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2.2.3.cmml">2</mn><mi id="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2.3" xref="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.6" xref="S3.SS2.SSS6.Px1.p1.7.m7.4.4.4.cmml">,</mo><mi id="S3.SS2.SSS6.Px1.p1.7.m7.1.1" mathvariant="normal" xref="S3.SS2.SSS6.Px1.p1.7.m7.1.1.cmml">…</mi><mo id="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.7" xref="S3.SS2.SSS6.Px1.p1.7.m7.4.4.4.cmml">,</mo><msubsup id="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3" xref="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3.cmml"><mi id="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3.2.2" xref="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3.2.2.cmml">𝐬</mi><mi id="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3.2.3" xref="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3.2.3.cmml">t</mi><mi id="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3.3" xref="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.8" stretchy="false" xref="S3.SS2.SSS6.Px1.p1.7.m7.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.Px1.p1.7.m7.4b"><set id="S3.SS2.SSS6.Px1.p1.7.m7.4.4.4.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3"><apply id="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1">superscript</csymbol><apply id="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1.2.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1.2.1.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1">subscript</csymbol><ci id="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1.2.2.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1.2.2">𝐬</ci><cn id="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1.3.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.2.2.1.1.3">𝑢</ci></apply><apply id="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2.1.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2">superscript</csymbol><apply id="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2.2.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2">subscript</csymbol><ci id="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2.2.2">𝐬</ci><cn id="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2.3.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.3.3.2.2.3">𝑢</ci></apply><ci id="S3.SS2.SSS6.Px1.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.1.1">…</ci><apply id="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3.1.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3">superscript</csymbol><apply id="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3.2.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3.2.1.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3">subscript</csymbol><ci id="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3.2.2.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3.2.2">𝐬</ci><ci id="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3.2.3.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3.2.3">𝑡</ci></apply><ci id="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3.3.cmml" xref="S3.SS2.SSS6.Px1.p1.7.m7.4.4.3.3.3">𝑢</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.Px1.p1.7.m7.4c">\{\mathbf{s}_{1}^{u},\mathbf{s}_{2}^{u},\ldots,\mathbf{s}_{t}^{u}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.Px1.p1.7.m7.4d">{ bold_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , bold_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , bold_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT }</annotation></semantics></math>, we denote its next expected item <math alttext="\mathbf{s}_{t+1}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS6.Px1.p1.8.m8.1"><semantics id="S3.SS2.SSS6.Px1.p1.8.m8.1a"><msubsup id="S3.SS2.SSS6.Px1.p1.8.m8.1.1" xref="S3.SS2.SSS6.Px1.p1.8.m8.1.1.cmml"><mi id="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.2" xref="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.2.cmml">𝐬</mi><mrow id="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.3" xref="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.3.cmml"><mi id="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.3.2" xref="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.3.2.cmml">t</mi><mo id="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.3.1" xref="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.3.1.cmml">+</mo><mn id="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.3.3" xref="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS6.Px1.p1.8.m8.1.1.3" xref="S3.SS2.SSS6.Px1.p1.8.m8.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.Px1.p1.8.m8.1b"><apply id="S3.SS2.SSS6.Px1.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.8.m8.1.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.8.m8.1.1">superscript</csymbol><apply id="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.cmml" xref="S3.SS2.SSS6.Px1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.1.cmml" xref="S3.SS2.SSS6.Px1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.2.cmml" xref="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.2">𝐬</ci><apply id="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.3.cmml" xref="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.3"><plus id="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.3.1.cmml" xref="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.3.1"></plus><ci id="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.3.2.cmml" xref="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.3.2">𝑡</ci><cn id="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.3.3.cmml" type="integer" xref="S3.SS2.SSS6.Px1.p1.8.m8.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS2.SSS6.Px1.p1.8.m8.1.1.3.cmml" xref="S3.SS2.SSS6.Px1.p1.8.m8.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.Px1.p1.8.m8.1c">\mathbf{s}_{t+1}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.Px1.p1.8.m8.1d">bold_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> as the positive sample <math alttext="\mathbf{pos}_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS6.Px1.p1.9.m9.1"><semantics id="S3.SS2.SSS6.Px1.p1.9.m9.1a"><msub id="S3.SS2.SSS6.Px1.p1.9.m9.1.1" xref="S3.SS2.SSS6.Px1.p1.9.m9.1.1.cmml"><mi id="S3.SS2.SSS6.Px1.p1.9.m9.1.1.2" xref="S3.SS2.SSS6.Px1.p1.9.m9.1.1.2.cmml">𝐩𝐨𝐬</mi><mi id="S3.SS2.SSS6.Px1.p1.9.m9.1.1.3" xref="S3.SS2.SSS6.Px1.p1.9.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.Px1.p1.9.m9.1b"><apply id="S3.SS2.SSS6.Px1.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.9.m9.1.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.SSS6.Px1.p1.9.m9.1.1.2.cmml" xref="S3.SS2.SSS6.Px1.p1.9.m9.1.1.2">𝐩𝐨𝐬</ci><ci id="S3.SS2.SSS6.Px1.p1.9.m9.1.1.3.cmml" xref="S3.SS2.SSS6.Px1.p1.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.Px1.p1.9.m9.1c">\mathbf{pos}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.Px1.p1.9.m9.1d">bold_pos start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. A negative sample is randomly sampled from the item set <math alttext="I" class="ltx_Math" display="inline" id="S3.SS2.SSS6.Px1.p1.10.m10.1"><semantics id="S3.SS2.SSS6.Px1.p1.10.m10.1a"><mi id="S3.SS2.SSS6.Px1.p1.10.m10.1.1" xref="S3.SS2.SSS6.Px1.p1.10.m10.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.Px1.p1.10.m10.1b"><ci id="S3.SS2.SSS6.Px1.p1.10.m10.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.10.m10.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.Px1.p1.10.m10.1c">I</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.Px1.p1.10.m10.1d">italic_I</annotation></semantics></math>, and its embedding vector is denoted as <math alttext="\mathbf{neg}_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS6.Px1.p1.11.m11.1"><semantics id="S3.SS2.SSS6.Px1.p1.11.m11.1a"><msub id="S3.SS2.SSS6.Px1.p1.11.m11.1.1" xref="S3.SS2.SSS6.Px1.p1.11.m11.1.1.cmml"><mi id="S3.SS2.SSS6.Px1.p1.11.m11.1.1.2" xref="S3.SS2.SSS6.Px1.p1.11.m11.1.1.2.cmml">𝐧𝐞𝐠</mi><mi id="S3.SS2.SSS6.Px1.p1.11.m11.1.1.3" xref="S3.SS2.SSS6.Px1.p1.11.m11.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.Px1.p1.11.m11.1b"><apply id="S3.SS2.SSS6.Px1.p1.11.m11.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.11.m11.1.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS2.SSS6.Px1.p1.11.m11.1.1.2.cmml" xref="S3.SS2.SSS6.Px1.p1.11.m11.1.1.2">𝐧𝐞𝐠</ci><ci id="S3.SS2.SSS6.Px1.p1.11.m11.1.1.3.cmml" xref="S3.SS2.SSS6.Px1.p1.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.Px1.p1.11.m11.1c">\mathbf{neg}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.Px1.p1.11.m11.1d">bold_neg start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="\mathbf{neg}_{t}\notin\mathbf{s}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS6.Px1.p1.12.m12.1"><semantics id="S3.SS2.SSS6.Px1.p1.12.m12.1a"><mrow id="S3.SS2.SSS6.Px1.p1.12.m12.1.1" xref="S3.SS2.SSS6.Px1.p1.12.m12.1.1.cmml"><msub id="S3.SS2.SSS6.Px1.p1.12.m12.1.1.2" xref="S3.SS2.SSS6.Px1.p1.12.m12.1.1.2.cmml"><mi id="S3.SS2.SSS6.Px1.p1.12.m12.1.1.2.2" xref="S3.SS2.SSS6.Px1.p1.12.m12.1.1.2.2.cmml">𝐧𝐞𝐠</mi><mi id="S3.SS2.SSS6.Px1.p1.12.m12.1.1.2.3" xref="S3.SS2.SSS6.Px1.p1.12.m12.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS2.SSS6.Px1.p1.12.m12.1.1.1" xref="S3.SS2.SSS6.Px1.p1.12.m12.1.1.1.cmml">∉</mo><msup id="S3.SS2.SSS6.Px1.p1.12.m12.1.1.3" xref="S3.SS2.SSS6.Px1.p1.12.m12.1.1.3.cmml"><mi id="S3.SS2.SSS6.Px1.p1.12.m12.1.1.3.2" xref="S3.SS2.SSS6.Px1.p1.12.m12.1.1.3.2.cmml">𝐬</mi><mi id="S3.SS2.SSS6.Px1.p1.12.m12.1.1.3.3" xref="S3.SS2.SSS6.Px1.p1.12.m12.1.1.3.3.cmml">u</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS6.Px1.p1.12.m12.1b"><apply id="S3.SS2.SSS6.Px1.p1.12.m12.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.12.m12.1.1"><notin id="S3.SS2.SSS6.Px1.p1.12.m12.1.1.1.cmml" xref="S3.SS2.SSS6.Px1.p1.12.m12.1.1.1"></notin><apply id="S3.SS2.SSS6.Px1.p1.12.m12.1.1.2.cmml" xref="S3.SS2.SSS6.Px1.p1.12.m12.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.12.m12.1.1.2.1.cmml" xref="S3.SS2.SSS6.Px1.p1.12.m12.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS6.Px1.p1.12.m12.1.1.2.2.cmml" xref="S3.SS2.SSS6.Px1.p1.12.m12.1.1.2.2">𝐧𝐞𝐠</ci><ci id="S3.SS2.SSS6.Px1.p1.12.m12.1.1.2.3.cmml" xref="S3.SS2.SSS6.Px1.p1.12.m12.1.1.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS6.Px1.p1.12.m12.1.1.3.cmml" xref="S3.SS2.SSS6.Px1.p1.12.m12.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS6.Px1.p1.12.m12.1.1.3.1.cmml" xref="S3.SS2.SSS6.Px1.p1.12.m12.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS6.Px1.p1.12.m12.1.1.3.2.cmml" xref="S3.SS2.SSS6.Px1.p1.12.m12.1.1.3.2">𝐬</ci><ci id="S3.SS2.SSS6.Px1.p1.12.m12.1.1.3.3.cmml" xref="S3.SS2.SSS6.Px1.p1.12.m12.1.1.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS6.Px1.p1.12.m12.1c">\mathbf{neg}_{t}\notin\mathbf{s}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS6.Px1.p1.12.m12.1d">bold_neg start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∉ bold_s start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>. Binary cross-entropy loss is used as the loss function:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=-\sum_{\mathbf{s}^{u}\in\mathbf{s}}\sum_{t\in\{1,2,...,n\}}[\log(%
\sigma(\mathbf{r}_{t,\mathbf{pos}_{t}}^{u}))+\log(1-\sigma(\mathbf{r}_{t,%
\mathbf{neg}_{t}}^{u}))]." class="ltx_Math" display="block" id="S3.E13.m1.11"><semantics id="S3.E13.m1.11a"><mrow id="S3.E13.m1.11.11.1" xref="S3.E13.m1.11.11.1.1.cmml"><mrow id="S3.E13.m1.11.11.1.1" xref="S3.E13.m1.11.11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.11.11.1.1.3" xref="S3.E13.m1.11.11.1.1.3.cmml">ℒ</mi><mo id="S3.E13.m1.11.11.1.1.2" xref="S3.E13.m1.11.11.1.1.2.cmml">=</mo><mrow id="S3.E13.m1.11.11.1.1.1" xref="S3.E13.m1.11.11.1.1.1.cmml"><mo id="S3.E13.m1.11.11.1.1.1a" xref="S3.E13.m1.11.11.1.1.1.cmml">−</mo><mrow id="S3.E13.m1.11.11.1.1.1.1" xref="S3.E13.m1.11.11.1.1.1.1.cmml"><munder id="S3.E13.m1.11.11.1.1.1.1.2" xref="S3.E13.m1.11.11.1.1.1.1.2.cmml"><mo id="S3.E13.m1.11.11.1.1.1.1.2.2" movablelimits="false" rspace="0em" xref="S3.E13.m1.11.11.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E13.m1.11.11.1.1.1.1.2.3" xref="S3.E13.m1.11.11.1.1.1.1.2.3.cmml"><msup id="S3.E13.m1.11.11.1.1.1.1.2.3.2" xref="S3.E13.m1.11.11.1.1.1.1.2.3.2.cmml"><mi id="S3.E13.m1.11.11.1.1.1.1.2.3.2.2" xref="S3.E13.m1.11.11.1.1.1.1.2.3.2.2.cmml">𝐬</mi><mi id="S3.E13.m1.11.11.1.1.1.1.2.3.2.3" xref="S3.E13.m1.11.11.1.1.1.1.2.3.2.3.cmml">u</mi></msup><mo id="S3.E13.m1.11.11.1.1.1.1.2.3.1" xref="S3.E13.m1.11.11.1.1.1.1.2.3.1.cmml">∈</mo><mi id="S3.E13.m1.11.11.1.1.1.1.2.3.3" xref="S3.E13.m1.11.11.1.1.1.1.2.3.3.cmml">𝐬</mi></mrow></munder><mrow id="S3.E13.m1.11.11.1.1.1.1.1" xref="S3.E13.m1.11.11.1.1.1.1.1.cmml"><munder id="S3.E13.m1.11.11.1.1.1.1.1.2" xref="S3.E13.m1.11.11.1.1.1.1.1.2.cmml"><mo id="S3.E13.m1.11.11.1.1.1.1.1.2.2" movablelimits="false" rspace="0em" xref="S3.E13.m1.11.11.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E13.m1.4.4.4" xref="S3.E13.m1.4.4.4.cmml"><mi id="S3.E13.m1.4.4.4.6" xref="S3.E13.m1.4.4.4.6.cmml">t</mi><mo id="S3.E13.m1.4.4.4.5" xref="S3.E13.m1.4.4.4.5.cmml">∈</mo><mrow id="S3.E13.m1.4.4.4.7.2" xref="S3.E13.m1.4.4.4.7.1.cmml"><mo id="S3.E13.m1.4.4.4.7.2.1" stretchy="false" xref="S3.E13.m1.4.4.4.7.1.cmml">{</mo><mn id="S3.E13.m1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml">1</mn><mo id="S3.E13.m1.4.4.4.7.2.2" xref="S3.E13.m1.4.4.4.7.1.cmml">,</mo><mn id="S3.E13.m1.2.2.2.2" xref="S3.E13.m1.2.2.2.2.cmml">2</mn><mo id="S3.E13.m1.4.4.4.7.2.3" xref="S3.E13.m1.4.4.4.7.1.cmml">,</mo><mi id="S3.E13.m1.3.3.3.3" mathvariant="normal" xref="S3.E13.m1.3.3.3.3.cmml">…</mi><mo id="S3.E13.m1.4.4.4.7.2.4" xref="S3.E13.m1.4.4.4.7.1.cmml">,</mo><mi id="S3.E13.m1.4.4.4.4" xref="S3.E13.m1.4.4.4.4.cmml">n</mi><mo id="S3.E13.m1.4.4.4.7.2.5" stretchy="false" xref="S3.E13.m1.4.4.4.7.1.cmml">}</mo></mrow></mrow></munder><mrow id="S3.E13.m1.11.11.1.1.1.1.1.1.1" xref="S3.E13.m1.11.11.1.1.1.1.1.1.2.cmml"><mo id="S3.E13.m1.11.11.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E13.m1.11.11.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E13.m1.9.9" xref="S3.E13.m1.9.9.cmml">log</mi><mo id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1a" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">σ</mi><mo id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐫</mi><mrow id="S3.E13.m1.6.6.2.2" xref="S3.E13.m1.6.6.2.3.cmml"><mi id="S3.E13.m1.5.5.1.1" xref="S3.E13.m1.5.5.1.1.cmml">t</mi><mo id="S3.E13.m1.6.6.2.2.2" xref="S3.E13.m1.6.6.2.3.cmml">,</mo><msub id="S3.E13.m1.6.6.2.2.1" xref="S3.E13.m1.6.6.2.2.1.cmml"><mi id="S3.E13.m1.6.6.2.2.1.2" xref="S3.E13.m1.6.6.2.2.1.2.cmml">𝐩𝐨𝐬</mi><mi id="S3.E13.m1.6.6.2.2.1.3" xref="S3.E13.m1.6.6.2.2.1.3.cmml">t</mi></msub></mrow><mi id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.3" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.3.cmml">+</mo><mrow id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E13.m1.10.10" xref="S3.E13.m1.10.10.cmml">log</mi><mo id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1a" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.2.cmml">⁡</mo><mrow id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.2.cmml"><mo id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.2.cmml">(</mo><mrow id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mn id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml">1</mn><mo id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">−</mo><mrow id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml"><mi id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.3" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.3.cmml">σ</mi><mo id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.2" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mo id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.2" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.2.cmml">𝐫</mi><mrow id="S3.E13.m1.8.8.2.2" xref="S3.E13.m1.8.8.2.3.cmml"><mi id="S3.E13.m1.7.7.1.1" xref="S3.E13.m1.7.7.1.1.cmml">t</mi><mo id="S3.E13.m1.8.8.2.2.2" xref="S3.E13.m1.8.8.2.3.cmml">,</mo><msub id="S3.E13.m1.8.8.2.2.1" xref="S3.E13.m1.8.8.2.2.1.cmml"><mi id="S3.E13.m1.8.8.2.2.1.2" xref="S3.E13.m1.8.8.2.2.1.2.cmml">𝐧𝐞𝐠</mi><mi id="S3.E13.m1.8.8.2.2.1.3" xref="S3.E13.m1.8.8.2.2.1.3.cmml">t</mi></msub></mrow><mi id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E13.m1.11.11.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E13.m1.11.11.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E13.m1.11.11.1.2" lspace="0em" xref="S3.E13.m1.11.11.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.11b"><apply id="S3.E13.m1.11.11.1.1.cmml" xref="S3.E13.m1.11.11.1"><eq id="S3.E13.m1.11.11.1.1.2.cmml" xref="S3.E13.m1.11.11.1.1.2"></eq><ci id="S3.E13.m1.11.11.1.1.3.cmml" xref="S3.E13.m1.11.11.1.1.3">ℒ</ci><apply id="S3.E13.m1.11.11.1.1.1.cmml" xref="S3.E13.m1.11.11.1.1.1"><minus id="S3.E13.m1.11.11.1.1.1.2.cmml" xref="S3.E13.m1.11.11.1.1.1"></minus><apply id="S3.E13.m1.11.11.1.1.1.1.cmml" xref="S3.E13.m1.11.11.1.1.1.1"><apply id="S3.E13.m1.11.11.1.1.1.1.2.cmml" xref="S3.E13.m1.11.11.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.11.11.1.1.1.1.2.1.cmml" xref="S3.E13.m1.11.11.1.1.1.1.2">subscript</csymbol><sum id="S3.E13.m1.11.11.1.1.1.1.2.2.cmml" xref="S3.E13.m1.11.11.1.1.1.1.2.2"></sum><apply id="S3.E13.m1.11.11.1.1.1.1.2.3.cmml" xref="S3.E13.m1.11.11.1.1.1.1.2.3"><in id="S3.E13.m1.11.11.1.1.1.1.2.3.1.cmml" xref="S3.E13.m1.11.11.1.1.1.1.2.3.1"></in><apply id="S3.E13.m1.11.11.1.1.1.1.2.3.2.cmml" xref="S3.E13.m1.11.11.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E13.m1.11.11.1.1.1.1.2.3.2.1.cmml" xref="S3.E13.m1.11.11.1.1.1.1.2.3.2">superscript</csymbol><ci id="S3.E13.m1.11.11.1.1.1.1.2.3.2.2.cmml" xref="S3.E13.m1.11.11.1.1.1.1.2.3.2.2">𝐬</ci><ci id="S3.E13.m1.11.11.1.1.1.1.2.3.2.3.cmml" xref="S3.E13.m1.11.11.1.1.1.1.2.3.2.3">𝑢</ci></apply><ci id="S3.E13.m1.11.11.1.1.1.1.2.3.3.cmml" xref="S3.E13.m1.11.11.1.1.1.1.2.3.3">𝐬</ci></apply></apply><apply id="S3.E13.m1.11.11.1.1.1.1.1.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1"><apply id="S3.E13.m1.11.11.1.1.1.1.1.2.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.11.11.1.1.1.1.1.2.1.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E13.m1.11.11.1.1.1.1.1.2.2.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.2.2"></sum><apply id="S3.E13.m1.4.4.4.cmml" xref="S3.E13.m1.4.4.4"><in id="S3.E13.m1.4.4.4.5.cmml" xref="S3.E13.m1.4.4.4.5"></in><ci id="S3.E13.m1.4.4.4.6.cmml" xref="S3.E13.m1.4.4.4.6">𝑡</ci><set id="S3.E13.m1.4.4.4.7.1.cmml" xref="S3.E13.m1.4.4.4.7.2"><cn id="S3.E13.m1.1.1.1.1.cmml" type="integer" xref="S3.E13.m1.1.1.1.1">1</cn><cn id="S3.E13.m1.2.2.2.2.cmml" type="integer" xref="S3.E13.m1.2.2.2.2">2</cn><ci id="S3.E13.m1.3.3.3.3.cmml" xref="S3.E13.m1.3.3.3.3">…</ci><ci id="S3.E13.m1.4.4.4.4.cmml" xref="S3.E13.m1.4.4.4.4">𝑛</ci></set></apply></apply><apply id="S3.E13.m1.11.11.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E13.m1.11.11.1.1.1.1.1.1.2.1.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1"><plus id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.3"></plus><apply id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1"><log id="S3.E13.m1.9.9.cmml" xref="S3.E13.m1.9.9"></log><apply id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.3">𝜎</ci><apply id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐫</ci><list id="S3.E13.m1.6.6.2.3.cmml" xref="S3.E13.m1.6.6.2.2"><ci id="S3.E13.m1.5.5.1.1.cmml" xref="S3.E13.m1.5.5.1.1">𝑡</ci><apply id="S3.E13.m1.6.6.2.2.1.cmml" xref="S3.E13.m1.6.6.2.2.1"><csymbol cd="ambiguous" id="S3.E13.m1.6.6.2.2.1.1.cmml" xref="S3.E13.m1.6.6.2.2.1">subscript</csymbol><ci id="S3.E13.m1.6.6.2.2.1.2.cmml" xref="S3.E13.m1.6.6.2.2.1.2">𝐩𝐨𝐬</ci><ci id="S3.E13.m1.6.6.2.2.1.3.cmml" xref="S3.E13.m1.6.6.2.2.1.3">𝑡</ci></apply></list></apply><ci id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑢</ci></apply></apply></apply><apply id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1"><log id="S3.E13.m1.10.10.cmml" xref="S3.E13.m1.10.10"></log><apply id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1"><minus id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.2"></minus><cn id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" type="integer" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.3">1</cn><apply id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1"><times id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.2"></times><ci id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.3">𝜎</ci><apply id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.2">𝐫</ci><list id="S3.E13.m1.8.8.2.3.cmml" xref="S3.E13.m1.8.8.2.2"><ci id="S3.E13.m1.7.7.1.1.cmml" xref="S3.E13.m1.7.7.1.1">𝑡</ci><apply id="S3.E13.m1.8.8.2.2.1.cmml" xref="S3.E13.m1.8.8.2.2.1"><csymbol cd="ambiguous" id="S3.E13.m1.8.8.2.2.1.1.cmml" xref="S3.E13.m1.8.8.2.2.1">subscript</csymbol><ci id="S3.E13.m1.8.8.2.2.1.2.cmml" xref="S3.E13.m1.8.8.2.2.1.2">𝐧𝐞𝐠</ci><ci id="S3.E13.m1.8.8.2.2.1.3.cmml" xref="S3.E13.m1.8.8.2.2.1.3">𝑡</ci></apply></list></apply><ci id="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3">𝑢</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.11c">\mathcal{L}=-\sum_{\mathbf{s}^{u}\in\mathbf{s}}\sum_{t\in\{1,2,...,n\}}[\log(%
\sigma(\mathbf{r}_{t,\mathbf{pos}_{t}}^{u}))+\log(1-\sigma(\mathbf{r}_{t,%
\mathbf{neg}_{t}}^{u}))].</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.11d">caligraphic_L = - ∑ start_POSTSUBSCRIPT bold_s start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∈ bold_s end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_t ∈ { 1 , 2 , … , italic_n } end_POSTSUBSCRIPT [ roman_log ( italic_σ ( bold_r start_POSTSUBSCRIPT italic_t , bold_pos start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) ) + roman_log ( 1 - italic_σ ( bold_r start_POSTSUBSCRIPT italic_t , bold_neg start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS6.Px1.p2">
<p class="ltx_p" id="S3.SS2.SSS6.Px1.p2.1">The model is optimized by the Adam optimizer, which is a variant of stochastic gradient descent (SGD) with adaptive moment estimation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib26" title="">26</a>]</cite>. To prevent overfitting, we also adopt the Early Stopping strategy. When the performance of the model on the validation set stabilizes and no longer improves, we terminate the training in advance.</p>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="834" id="S3.F4.g1" src="x4.png" width="747"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The CoT prompt template. It mainly consists of four progressive steps, and needs to fill in the user’s interaction sequence, target item, user‘s multi-preferences and attention weight, also taking the data on the Steam dataset as an example.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS7">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.7 </span>Explainable Recommendation Generation Module</h4>
<div class="ltx_para" id="S3.SS2.SSS7.p1">
<p class="ltx_p" id="S3.SS2.SSS7.p1.1">In this module, we guide the LLM model to generate explainable reasons for our recommendation results. Since the generated recommendation texts aim to provide semantic explanations for the recommendation model’s results from the perspective of user preferences and there are no expected recommendation texts, it is not involved in model training but serves as an output head to provide explanations for the recommendation results.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS7.p2">
<p class="ltx_p" id="S3.SS2.SSS7.p2.4">As described in the previous sections, by inputting <math alttext="\{\mathbf{s}_{1}^{u},\mathbf{s}_{2}^{u},\ldots,\mathbf{s}_{n}^{u}\}" class="ltx_Math" display="inline" id="S3.SS2.SSS7.p2.1.m1.4"><semantics id="S3.SS2.SSS7.p2.1.m1.4a"><mrow id="S3.SS2.SSS7.p2.1.m1.4.4.3" xref="S3.SS2.SSS7.p2.1.m1.4.4.4.cmml"><mo id="S3.SS2.SSS7.p2.1.m1.4.4.3.4" stretchy="false" xref="S3.SS2.SSS7.p2.1.m1.4.4.4.cmml">{</mo><msubsup id="S3.SS2.SSS7.p2.1.m1.2.2.1.1" xref="S3.SS2.SSS7.p2.1.m1.2.2.1.1.cmml"><mi id="S3.SS2.SSS7.p2.1.m1.2.2.1.1.2.2" xref="S3.SS2.SSS7.p2.1.m1.2.2.1.1.2.2.cmml">𝐬</mi><mn id="S3.SS2.SSS7.p2.1.m1.2.2.1.1.2.3" xref="S3.SS2.SSS7.p2.1.m1.2.2.1.1.2.3.cmml">1</mn><mi id="S3.SS2.SSS7.p2.1.m1.2.2.1.1.3" xref="S3.SS2.SSS7.p2.1.m1.2.2.1.1.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS7.p2.1.m1.4.4.3.5" xref="S3.SS2.SSS7.p2.1.m1.4.4.4.cmml">,</mo><msubsup id="S3.SS2.SSS7.p2.1.m1.3.3.2.2" xref="S3.SS2.SSS7.p2.1.m1.3.3.2.2.cmml"><mi id="S3.SS2.SSS7.p2.1.m1.3.3.2.2.2.2" xref="S3.SS2.SSS7.p2.1.m1.3.3.2.2.2.2.cmml">𝐬</mi><mn id="S3.SS2.SSS7.p2.1.m1.3.3.2.2.2.3" xref="S3.SS2.SSS7.p2.1.m1.3.3.2.2.2.3.cmml">2</mn><mi id="S3.SS2.SSS7.p2.1.m1.3.3.2.2.3" xref="S3.SS2.SSS7.p2.1.m1.3.3.2.2.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS7.p2.1.m1.4.4.3.6" xref="S3.SS2.SSS7.p2.1.m1.4.4.4.cmml">,</mo><mi id="S3.SS2.SSS7.p2.1.m1.1.1" mathvariant="normal" xref="S3.SS2.SSS7.p2.1.m1.1.1.cmml">…</mi><mo id="S3.SS2.SSS7.p2.1.m1.4.4.3.7" xref="S3.SS2.SSS7.p2.1.m1.4.4.4.cmml">,</mo><msubsup id="S3.SS2.SSS7.p2.1.m1.4.4.3.3" xref="S3.SS2.SSS7.p2.1.m1.4.4.3.3.cmml"><mi id="S3.SS2.SSS7.p2.1.m1.4.4.3.3.2.2" xref="S3.SS2.SSS7.p2.1.m1.4.4.3.3.2.2.cmml">𝐬</mi><mi id="S3.SS2.SSS7.p2.1.m1.4.4.3.3.2.3" xref="S3.SS2.SSS7.p2.1.m1.4.4.3.3.2.3.cmml">n</mi><mi id="S3.SS2.SSS7.p2.1.m1.4.4.3.3.3" xref="S3.SS2.SSS7.p2.1.m1.4.4.3.3.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS7.p2.1.m1.4.4.3.8" stretchy="false" xref="S3.SS2.SSS7.p2.1.m1.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS7.p2.1.m1.4b"><set id="S3.SS2.SSS7.p2.1.m1.4.4.4.cmml" xref="S3.SS2.SSS7.p2.1.m1.4.4.3"><apply id="S3.SS2.SSS7.p2.1.m1.2.2.1.1.cmml" xref="S3.SS2.SSS7.p2.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.SSS7.p2.1.m1.2.2.1.1">superscript</csymbol><apply id="S3.SS2.SSS7.p2.1.m1.2.2.1.1.2.cmml" xref="S3.SS2.SSS7.p2.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p2.1.m1.2.2.1.1.2.1.cmml" xref="S3.SS2.SSS7.p2.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS2.SSS7.p2.1.m1.2.2.1.1.2.2.cmml" xref="S3.SS2.SSS7.p2.1.m1.2.2.1.1.2.2">𝐬</ci><cn id="S3.SS2.SSS7.p2.1.m1.2.2.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS7.p2.1.m1.2.2.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS7.p2.1.m1.2.2.1.1.3.cmml" xref="S3.SS2.SSS7.p2.1.m1.2.2.1.1.3">𝑢</ci></apply><apply id="S3.SS2.SSS7.p2.1.m1.3.3.2.2.cmml" xref="S3.SS2.SSS7.p2.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p2.1.m1.3.3.2.2.1.cmml" xref="S3.SS2.SSS7.p2.1.m1.3.3.2.2">superscript</csymbol><apply id="S3.SS2.SSS7.p2.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.SSS7.p2.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS7.p2.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS2.SSS7.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS7.p2.1.m1.3.3.2.2.2.2">𝐬</ci><cn id="S3.SS2.SSS7.p2.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS7.p2.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS7.p2.1.m1.3.3.2.2.3.cmml" xref="S3.SS2.SSS7.p2.1.m1.3.3.2.2.3">𝑢</ci></apply><ci id="S3.SS2.SSS7.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS7.p2.1.m1.1.1">…</ci><apply id="S3.SS2.SSS7.p2.1.m1.4.4.3.3.cmml" xref="S3.SS2.SSS7.p2.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p2.1.m1.4.4.3.3.1.cmml" xref="S3.SS2.SSS7.p2.1.m1.4.4.3.3">superscript</csymbol><apply id="S3.SS2.SSS7.p2.1.m1.4.4.3.3.2.cmml" xref="S3.SS2.SSS7.p2.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p2.1.m1.4.4.3.3.2.1.cmml" xref="S3.SS2.SSS7.p2.1.m1.4.4.3.3">subscript</csymbol><ci id="S3.SS2.SSS7.p2.1.m1.4.4.3.3.2.2.cmml" xref="S3.SS2.SSS7.p2.1.m1.4.4.3.3.2.2">𝐬</ci><ci id="S3.SS2.SSS7.p2.1.m1.4.4.3.3.2.3.cmml" xref="S3.SS2.SSS7.p2.1.m1.4.4.3.3.2.3">𝑛</ci></apply><ci id="S3.SS2.SSS7.p2.1.m1.4.4.3.3.3.cmml" xref="S3.SS2.SSS7.p2.1.m1.4.4.3.3.3">𝑢</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS7.p2.1.m1.4c">\{\mathbf{s}_{1}^{u},\mathbf{s}_{2}^{u},\ldots,\mathbf{s}_{n}^{u}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS7.p2.1.m1.4d">{ bold_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , bold_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , bold_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT }</annotation></semantics></math> into the model, we can obtain the feature vector <math alttext="\mathbf{q}_{n}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS7.p2.2.m2.1"><semantics id="S3.SS2.SSS7.p2.2.m2.1a"><msubsup id="S3.SS2.SSS7.p2.2.m2.1.1" xref="S3.SS2.SSS7.p2.2.m2.1.1.cmml"><mi id="S3.SS2.SSS7.p2.2.m2.1.1.2.2" xref="S3.SS2.SSS7.p2.2.m2.1.1.2.2.cmml">𝐪</mi><mi id="S3.SS2.SSS7.p2.2.m2.1.1.2.3" xref="S3.SS2.SSS7.p2.2.m2.1.1.2.3.cmml">n</mi><mi id="S3.SS2.SSS7.p2.2.m2.1.1.3" xref="S3.SS2.SSS7.p2.2.m2.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS7.p2.2.m2.1b"><apply id="S3.SS2.SSS7.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS7.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS7.p2.2.m2.1.1">superscript</csymbol><apply id="S3.SS2.SSS7.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS7.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p2.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS7.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS7.p2.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS7.p2.2.m2.1.1.2.2">𝐪</ci><ci id="S3.SS2.SSS7.p2.2.m2.1.1.2.3.cmml" xref="S3.SS2.SSS7.p2.2.m2.1.1.2.3">𝑛</ci></apply><ci id="S3.SS2.SSS7.p2.2.m2.1.1.3.cmml" xref="S3.SS2.SSS7.p2.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS7.p2.2.m2.1c">\mathbf{q}_{n}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS7.p2.2.m2.1d">bold_q start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> of this sequence, as well as the users’ multi-preferences <math alttext="\text{preference}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS7.p2.3.m3.1"><semantics id="S3.SS2.SSS7.p2.3.m3.1a"><msup id="S3.SS2.SSS7.p2.3.m3.1.1" xref="S3.SS2.SSS7.p2.3.m3.1.1.cmml"><mtext id="S3.SS2.SSS7.p2.3.m3.1.1.2" xref="S3.SS2.SSS7.p2.3.m3.1.1.2a.cmml">preference</mtext><mi id="S3.SS2.SSS7.p2.3.m3.1.1.3" xref="S3.SS2.SSS7.p2.3.m3.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS7.p2.3.m3.1b"><apply id="S3.SS2.SSS7.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS7.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p2.3.m3.1.1.1.cmml" xref="S3.SS2.SSS7.p2.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.SSS7.p2.3.m3.1.1.2a.cmml" xref="S3.SS2.SSS7.p2.3.m3.1.1.2"><mtext id="S3.SS2.SSS7.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS7.p2.3.m3.1.1.2">preference</mtext></ci><ci id="S3.SS2.SSS7.p2.3.m3.1.1.3.cmml" xref="S3.SS2.SSS7.p2.3.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS7.p2.3.m3.1c">\text{preference}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS7.p2.3.m3.1d">preference start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> and its embedding <math alttext="\mathbf{P}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS7.p2.4.m4.1"><semantics id="S3.SS2.SSS7.p2.4.m4.1a"><msup id="S3.SS2.SSS7.p2.4.m4.1.1" xref="S3.SS2.SSS7.p2.4.m4.1.1.cmml"><mi id="S3.SS2.SSS7.p2.4.m4.1.1.2" xref="S3.SS2.SSS7.p2.4.m4.1.1.2.cmml">𝐏</mi><mi id="S3.SS2.SSS7.p2.4.m4.1.1.3" xref="S3.SS2.SSS7.p2.4.m4.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS7.p2.4.m4.1b"><apply id="S3.SS2.SSS7.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS7.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p2.4.m4.1.1.1.cmml" xref="S3.SS2.SSS7.p2.4.m4.1.1">superscript</csymbol><ci id="S3.SS2.SSS7.p2.4.m4.1.1.2.cmml" xref="S3.SS2.SSS7.p2.4.m4.1.1.2">𝐏</ci><ci id="S3.SS2.SSS7.p2.4.m4.1.1.3.cmml" xref="S3.SS2.SSS7.p2.4.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS7.p2.4.m4.1c">\mathbf{P}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS7.p2.4.m4.1d">bold_P start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>. By using the projection matrices in the preference alignment module, we can obtain the attention weights regarding users’ multi-preferences, which can be described as follows:</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS7.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Q}_{n}^{u}=\text{Concat}(\mathbf{q}_{n}^{u}\mathbf{W}_{1}^{Q},\ldots,%
\mathbf{q}_{n}^{u}\mathbf{W}_{h}^{Q})," class="ltx_Math" display="block" id="S3.E14.m1.2"><semantics id="S3.E14.m1.2a"><mrow id="S3.E14.m1.2.2.1" xref="S3.E14.m1.2.2.1.1.cmml"><mrow id="S3.E14.m1.2.2.1.1" xref="S3.E14.m1.2.2.1.1.cmml"><msubsup id="S3.E14.m1.2.2.1.1.4" xref="S3.E14.m1.2.2.1.1.4.cmml"><mi id="S3.E14.m1.2.2.1.1.4.2.2" xref="S3.E14.m1.2.2.1.1.4.2.2.cmml">𝐐</mi><mi id="S3.E14.m1.2.2.1.1.4.2.3" xref="S3.E14.m1.2.2.1.1.4.2.3.cmml">n</mi><mi id="S3.E14.m1.2.2.1.1.4.3" xref="S3.E14.m1.2.2.1.1.4.3.cmml">u</mi></msubsup><mo id="S3.E14.m1.2.2.1.1.3" xref="S3.E14.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E14.m1.2.2.1.1.2" xref="S3.E14.m1.2.2.1.1.2.cmml"><mtext id="S3.E14.m1.2.2.1.1.2.4" xref="S3.E14.m1.2.2.1.1.2.4a.cmml">Concat</mtext><mo id="S3.E14.m1.2.2.1.1.2.3" xref="S3.E14.m1.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S3.E14.m1.2.2.1.1.2.2.2" xref="S3.E14.m1.2.2.1.1.2.2.3.cmml"><mo id="S3.E14.m1.2.2.1.1.2.2.2.3" stretchy="false" xref="S3.E14.m1.2.2.1.1.2.2.3.cmml">(</mo><mrow id="S3.E14.m1.2.2.1.1.1.1.1.1" xref="S3.E14.m1.2.2.1.1.1.1.1.1.cmml"><msubsup id="S3.E14.m1.2.2.1.1.1.1.1.1.2" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.cmml">𝐪</mi><mi id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.3" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.3.cmml">n</mi><mi id="S3.E14.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.3.cmml">u</mi></msubsup><mo id="S3.E14.m1.2.2.1.1.1.1.1.1.1" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S3.E14.m1.2.2.1.1.1.1.1.1.3" xref="S3.E14.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E14.m1.2.2.1.1.1.1.1.1.3.2.2" xref="S3.E14.m1.2.2.1.1.1.1.1.1.3.2.2.cmml">𝐖</mi><mn id="S3.E14.m1.2.2.1.1.1.1.1.1.3.2.3" xref="S3.E14.m1.2.2.1.1.1.1.1.1.3.2.3.cmml">1</mn><mi id="S3.E14.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E14.m1.2.2.1.1.1.1.1.1.3.3.cmml">Q</mi></msubsup></mrow><mo id="S3.E14.m1.2.2.1.1.2.2.2.4" xref="S3.E14.m1.2.2.1.1.2.2.3.cmml">,</mo><mi id="S3.E14.m1.1.1" mathvariant="normal" xref="S3.E14.m1.1.1.cmml">…</mi><mo id="S3.E14.m1.2.2.1.1.2.2.2.5" xref="S3.E14.m1.2.2.1.1.2.2.3.cmml">,</mo><mrow id="S3.E14.m1.2.2.1.1.2.2.2.2" xref="S3.E14.m1.2.2.1.1.2.2.2.2.cmml"><msubsup id="S3.E14.m1.2.2.1.1.2.2.2.2.2" xref="S3.E14.m1.2.2.1.1.2.2.2.2.2.cmml"><mi id="S3.E14.m1.2.2.1.1.2.2.2.2.2.2.2" xref="S3.E14.m1.2.2.1.1.2.2.2.2.2.2.2.cmml">𝐪</mi><mi id="S3.E14.m1.2.2.1.1.2.2.2.2.2.2.3" xref="S3.E14.m1.2.2.1.1.2.2.2.2.2.2.3.cmml">n</mi><mi id="S3.E14.m1.2.2.1.1.2.2.2.2.2.3" xref="S3.E14.m1.2.2.1.1.2.2.2.2.2.3.cmml">u</mi></msubsup><mo id="S3.E14.m1.2.2.1.1.2.2.2.2.1" xref="S3.E14.m1.2.2.1.1.2.2.2.2.1.cmml">⁢</mo><msubsup id="S3.E14.m1.2.2.1.1.2.2.2.2.3" xref="S3.E14.m1.2.2.1.1.2.2.2.2.3.cmml"><mi id="S3.E14.m1.2.2.1.1.2.2.2.2.3.2.2" xref="S3.E14.m1.2.2.1.1.2.2.2.2.3.2.2.cmml">𝐖</mi><mi id="S3.E14.m1.2.2.1.1.2.2.2.2.3.2.3" xref="S3.E14.m1.2.2.1.1.2.2.2.2.3.2.3.cmml">h</mi><mi id="S3.E14.m1.2.2.1.1.2.2.2.2.3.3" xref="S3.E14.m1.2.2.1.1.2.2.2.2.3.3.cmml">Q</mi></msubsup></mrow><mo id="S3.E14.m1.2.2.1.1.2.2.2.6" stretchy="false" xref="S3.E14.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E14.m1.2.2.1.2" xref="S3.E14.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.2b"><apply id="S3.E14.m1.2.2.1.1.cmml" xref="S3.E14.m1.2.2.1"><eq id="S3.E14.m1.2.2.1.1.3.cmml" xref="S3.E14.m1.2.2.1.1.3"></eq><apply id="S3.E14.m1.2.2.1.1.4.cmml" xref="S3.E14.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E14.m1.2.2.1.1.4.1.cmml" xref="S3.E14.m1.2.2.1.1.4">superscript</csymbol><apply id="S3.E14.m1.2.2.1.1.4.2.cmml" xref="S3.E14.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E14.m1.2.2.1.1.4.2.1.cmml" xref="S3.E14.m1.2.2.1.1.4">subscript</csymbol><ci id="S3.E14.m1.2.2.1.1.4.2.2.cmml" xref="S3.E14.m1.2.2.1.1.4.2.2">𝐐</ci><ci id="S3.E14.m1.2.2.1.1.4.2.3.cmml" xref="S3.E14.m1.2.2.1.1.4.2.3">𝑛</ci></apply><ci id="S3.E14.m1.2.2.1.1.4.3.cmml" xref="S3.E14.m1.2.2.1.1.4.3">𝑢</ci></apply><apply id="S3.E14.m1.2.2.1.1.2.cmml" xref="S3.E14.m1.2.2.1.1.2"><times id="S3.E14.m1.2.2.1.1.2.3.cmml" xref="S3.E14.m1.2.2.1.1.2.3"></times><ci id="S3.E14.m1.2.2.1.1.2.4a.cmml" xref="S3.E14.m1.2.2.1.1.2.4"><mtext id="S3.E14.m1.2.2.1.1.2.4.cmml" xref="S3.E14.m1.2.2.1.1.2.4">Concat</mtext></ci><vector id="S3.E14.m1.2.2.1.1.2.2.3.cmml" xref="S3.E14.m1.2.2.1.1.2.2.2"><apply id="S3.E14.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1"><times id="S3.E14.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1"></times><apply id="S3.E14.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E14.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2">𝐪</ci><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.3">𝑛</ci></apply><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.3">𝑢</ci></apply><apply id="S3.E14.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E14.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.3.2.2">𝐖</ci><cn id="S3.E14.m1.2.2.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="S3.E14.m1.2.2.1.1.1.1.1.1.3.2.3">1</cn></apply><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.3.3">𝑄</ci></apply></apply><ci id="S3.E14.m1.1.1.cmml" xref="S3.E14.m1.1.1">…</ci><apply id="S3.E14.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E14.m1.2.2.1.1.2.2.2.2"><times id="S3.E14.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E14.m1.2.2.1.1.2.2.2.2.1"></times><apply id="S3.E14.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E14.m1.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E14.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="S3.E14.m1.2.2.1.1.2.2.2.2.2">superscript</csymbol><apply id="S3.E14.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S3.E14.m1.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E14.m1.2.2.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E14.m1.2.2.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E14.m1.2.2.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E14.m1.2.2.1.1.2.2.2.2.2.2.2">𝐪</ci><ci id="S3.E14.m1.2.2.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E14.m1.2.2.1.1.2.2.2.2.2.2.3">𝑛</ci></apply><ci id="S3.E14.m1.2.2.1.1.2.2.2.2.2.3.cmml" xref="S3.E14.m1.2.2.1.1.2.2.2.2.2.3">𝑢</ci></apply><apply id="S3.E14.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E14.m1.2.2.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E14.m1.2.2.1.1.2.2.2.2.3.1.cmml" xref="S3.E14.m1.2.2.1.1.2.2.2.2.3">superscript</csymbol><apply id="S3.E14.m1.2.2.1.1.2.2.2.2.3.2.cmml" xref="S3.E14.m1.2.2.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E14.m1.2.2.1.1.2.2.2.2.3.2.1.cmml" xref="S3.E14.m1.2.2.1.1.2.2.2.2.3">subscript</csymbol><ci id="S3.E14.m1.2.2.1.1.2.2.2.2.3.2.2.cmml" xref="S3.E14.m1.2.2.1.1.2.2.2.2.3.2.2">𝐖</ci><ci id="S3.E14.m1.2.2.1.1.2.2.2.2.3.2.3.cmml" xref="S3.E14.m1.2.2.1.1.2.2.2.2.3.2.3">ℎ</ci></apply><ci id="S3.E14.m1.2.2.1.1.2.2.2.2.3.3.cmml" xref="S3.E14.m1.2.2.1.1.2.2.2.2.3.3">𝑄</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.2c">\mathbf{Q}_{n}^{u}=\text{Concat}(\mathbf{q}_{n}^{u}\mathbf{W}_{1}^{Q},\ldots,%
\mathbf{q}_{n}^{u}\mathbf{W}_{h}^{Q}),</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m1.2d">bold_Q start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = Concat ( bold_q start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT bold_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT , … , bold_q start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT bold_W start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS7.p4">
<table class="ltx_equation ltx_eqn_table" id="S3.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{K}^{u}=\text{Concat}(\mathbf{P}^{u}\mathbf{W}_{1}^{K},\ldots,\mathbf{P%
}^{u}\mathbf{W}_{h}^{K})," class="ltx_Math" display="block" id="S3.E15.m1.2"><semantics id="S3.E15.m1.2a"><mrow id="S3.E15.m1.2.2.1" xref="S3.E15.m1.2.2.1.1.cmml"><mrow id="S3.E15.m1.2.2.1.1" xref="S3.E15.m1.2.2.1.1.cmml"><msup id="S3.E15.m1.2.2.1.1.4" xref="S3.E15.m1.2.2.1.1.4.cmml"><mi id="S3.E15.m1.2.2.1.1.4.2" xref="S3.E15.m1.2.2.1.1.4.2.cmml">𝐊</mi><mi id="S3.E15.m1.2.2.1.1.4.3" xref="S3.E15.m1.2.2.1.1.4.3.cmml">u</mi></msup><mo id="S3.E15.m1.2.2.1.1.3" xref="S3.E15.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E15.m1.2.2.1.1.2" xref="S3.E15.m1.2.2.1.1.2.cmml"><mtext id="S3.E15.m1.2.2.1.1.2.4" xref="S3.E15.m1.2.2.1.1.2.4a.cmml">Concat</mtext><mo id="S3.E15.m1.2.2.1.1.2.3" xref="S3.E15.m1.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S3.E15.m1.2.2.1.1.2.2.2" xref="S3.E15.m1.2.2.1.1.2.2.3.cmml"><mo id="S3.E15.m1.2.2.1.1.2.2.2.3" stretchy="false" xref="S3.E15.m1.2.2.1.1.2.2.3.cmml">(</mo><mrow id="S3.E15.m1.2.2.1.1.1.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.cmml"><msup id="S3.E15.m1.2.2.1.1.1.1.1.1.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E15.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.cmml">𝐏</mi><mi id="S3.E15.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.3.cmml">u</mi></msup><mo id="S3.E15.m1.2.2.1.1.1.1.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S3.E15.m1.2.2.1.1.1.1.1.1.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E15.m1.2.2.1.1.1.1.1.1.3.2.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3.2.2.cmml">𝐖</mi><mn id="S3.E15.m1.2.2.1.1.1.1.1.1.3.2.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3.2.3.cmml">1</mn><mi id="S3.E15.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3.3.cmml">K</mi></msubsup></mrow><mo id="S3.E15.m1.2.2.1.1.2.2.2.4" xref="S3.E15.m1.2.2.1.1.2.2.3.cmml">,</mo><mi id="S3.E15.m1.1.1" mathvariant="normal" xref="S3.E15.m1.1.1.cmml">…</mi><mo id="S3.E15.m1.2.2.1.1.2.2.2.5" xref="S3.E15.m1.2.2.1.1.2.2.3.cmml">,</mo><mrow id="S3.E15.m1.2.2.1.1.2.2.2.2" xref="S3.E15.m1.2.2.1.1.2.2.2.2.cmml"><msup id="S3.E15.m1.2.2.1.1.2.2.2.2.2" xref="S3.E15.m1.2.2.1.1.2.2.2.2.2.cmml"><mi id="S3.E15.m1.2.2.1.1.2.2.2.2.2.2" xref="S3.E15.m1.2.2.1.1.2.2.2.2.2.2.cmml">𝐏</mi><mi id="S3.E15.m1.2.2.1.1.2.2.2.2.2.3" xref="S3.E15.m1.2.2.1.1.2.2.2.2.2.3.cmml">u</mi></msup><mo id="S3.E15.m1.2.2.1.1.2.2.2.2.1" xref="S3.E15.m1.2.2.1.1.2.2.2.2.1.cmml">⁢</mo><msubsup id="S3.E15.m1.2.2.1.1.2.2.2.2.3" xref="S3.E15.m1.2.2.1.1.2.2.2.2.3.cmml"><mi id="S3.E15.m1.2.2.1.1.2.2.2.2.3.2.2" xref="S3.E15.m1.2.2.1.1.2.2.2.2.3.2.2.cmml">𝐖</mi><mi id="S3.E15.m1.2.2.1.1.2.2.2.2.3.2.3" xref="S3.E15.m1.2.2.1.1.2.2.2.2.3.2.3.cmml">h</mi><mi id="S3.E15.m1.2.2.1.1.2.2.2.2.3.3" xref="S3.E15.m1.2.2.1.1.2.2.2.2.3.3.cmml">K</mi></msubsup></mrow><mo id="S3.E15.m1.2.2.1.1.2.2.2.6" stretchy="false" xref="S3.E15.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E15.m1.2.2.1.2" xref="S3.E15.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m1.2b"><apply id="S3.E15.m1.2.2.1.1.cmml" xref="S3.E15.m1.2.2.1"><eq id="S3.E15.m1.2.2.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.3"></eq><apply id="S3.E15.m1.2.2.1.1.4.cmml" xref="S3.E15.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.4.1.cmml" xref="S3.E15.m1.2.2.1.1.4">superscript</csymbol><ci id="S3.E15.m1.2.2.1.1.4.2.cmml" xref="S3.E15.m1.2.2.1.1.4.2">𝐊</ci><ci id="S3.E15.m1.2.2.1.1.4.3.cmml" xref="S3.E15.m1.2.2.1.1.4.3">𝑢</ci></apply><apply id="S3.E15.m1.2.2.1.1.2.cmml" xref="S3.E15.m1.2.2.1.1.2"><times id="S3.E15.m1.2.2.1.1.2.3.cmml" xref="S3.E15.m1.2.2.1.1.2.3"></times><ci id="S3.E15.m1.2.2.1.1.2.4a.cmml" xref="S3.E15.m1.2.2.1.1.2.4"><mtext id="S3.E15.m1.2.2.1.1.2.4.cmml" xref="S3.E15.m1.2.2.1.1.2.4">Concat</mtext></ci><vector id="S3.E15.m1.2.2.1.1.2.2.3.cmml" xref="S3.E15.m1.2.2.1.1.2.2.2"><apply id="S3.E15.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1"><times id="S3.E15.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1"></times><apply id="S3.E15.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.2">𝐏</ci><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.3">𝑢</ci></apply><apply id="S3.E15.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E15.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3.2.2">𝐖</ci><cn id="S3.E15.m1.2.2.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3.2.3">1</cn></apply><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3.3">𝐾</ci></apply></apply><ci id="S3.E15.m1.1.1.cmml" xref="S3.E15.m1.1.1">…</ci><apply id="S3.E15.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E15.m1.2.2.1.1.2.2.2.2"><times id="S3.E15.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E15.m1.2.2.1.1.2.2.2.2.1"></times><apply id="S3.E15.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E15.m1.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="S3.E15.m1.2.2.1.1.2.2.2.2.2">superscript</csymbol><ci id="S3.E15.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S3.E15.m1.2.2.1.1.2.2.2.2.2.2">𝐏</ci><ci id="S3.E15.m1.2.2.1.1.2.2.2.2.2.3.cmml" xref="S3.E15.m1.2.2.1.1.2.2.2.2.2.3">𝑢</ci></apply><apply id="S3.E15.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E15.m1.2.2.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.2.2.2.2.3.1.cmml" xref="S3.E15.m1.2.2.1.1.2.2.2.2.3">superscript</csymbol><apply id="S3.E15.m1.2.2.1.1.2.2.2.2.3.2.cmml" xref="S3.E15.m1.2.2.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.2.2.2.2.3.2.1.cmml" xref="S3.E15.m1.2.2.1.1.2.2.2.2.3">subscript</csymbol><ci id="S3.E15.m1.2.2.1.1.2.2.2.2.3.2.2.cmml" xref="S3.E15.m1.2.2.1.1.2.2.2.2.3.2.2">𝐖</ci><ci id="S3.E15.m1.2.2.1.1.2.2.2.2.3.2.3.cmml" xref="S3.E15.m1.2.2.1.1.2.2.2.2.3.2.3">ℎ</ci></apply><ci id="S3.E15.m1.2.2.1.1.2.2.2.2.3.3.cmml" xref="S3.E15.m1.2.2.1.1.2.2.2.2.3.3">𝐾</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.2c">\mathbf{K}^{u}=\text{Concat}(\mathbf{P}^{u}\mathbf{W}_{1}^{K},\ldots,\mathbf{P%
}^{u}\mathbf{W}_{h}^{K}),</annotation><annotation encoding="application/x-llamapun" id="S3.E15.m1.2d">bold_K start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = Concat ( bold_P start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT bold_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT , … , bold_P start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT bold_W start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS7.p5">
<table class="ltx_equation ltx_eqn_table" id="S3.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{\omega}^{u}=\text{softmax}\left(\frac{{\mathbf{Q}_{n}^{u}\mathbf{K}^{u%
}}^{T}}{\sqrt{{hd}_{k}}}\right)," class="ltx_Math" display="block" id="S3.E16.m1.2"><semantics id="S3.E16.m1.2a"><mrow id="S3.E16.m1.2.2.1" xref="S3.E16.m1.2.2.1.1.cmml"><mrow id="S3.E16.m1.2.2.1.1" xref="S3.E16.m1.2.2.1.1.cmml"><msup id="S3.E16.m1.2.2.1.1.2" xref="S3.E16.m1.2.2.1.1.2.cmml"><mi id="S3.E16.m1.2.2.1.1.2.2" xref="S3.E16.m1.2.2.1.1.2.2.cmml">ω</mi><mi id="S3.E16.m1.2.2.1.1.2.3" xref="S3.E16.m1.2.2.1.1.2.3.cmml">u</mi></msup><mo id="S3.E16.m1.2.2.1.1.1" xref="S3.E16.m1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E16.m1.2.2.1.1.3" xref="S3.E16.m1.2.2.1.1.3.cmml"><mtext id="S3.E16.m1.2.2.1.1.3.2" xref="S3.E16.m1.2.2.1.1.3.2a.cmml">softmax</mtext><mo id="S3.E16.m1.2.2.1.1.3.1" xref="S3.E16.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S3.E16.m1.2.2.1.1.3.3.2" xref="S3.E16.m1.1.1.cmml"><mo id="S3.E16.m1.2.2.1.1.3.3.2.1" xref="S3.E16.m1.1.1.cmml">(</mo><mfrac id="S3.E16.m1.1.1" xref="S3.E16.m1.1.1.cmml"><mrow id="S3.E16.m1.1.1.2" xref="S3.E16.m1.1.1.2.cmml"><msubsup id="S3.E16.m1.1.1.2.2" xref="S3.E16.m1.1.1.2.2.cmml"><mi id="S3.E16.m1.1.1.2.2.2.2" xref="S3.E16.m1.1.1.2.2.2.2.cmml">𝐐</mi><mi id="S3.E16.m1.1.1.2.2.2.3" xref="S3.E16.m1.1.1.2.2.2.3.cmml">n</mi><mi id="S3.E16.m1.1.1.2.2.3" xref="S3.E16.m1.1.1.2.2.3.cmml">u</mi></msubsup><mo id="S3.E16.m1.1.1.2.1" xref="S3.E16.m1.1.1.2.1.cmml">⁢</mo><mmultiscripts id="S3.E16.m1.1.1.2.3" xref="S3.E16.m1.1.1.2.3.cmml"><mi id="S3.E16.m1.1.1.2.3.2.2" xref="S3.E16.m1.1.1.2.3.2.2.cmml">𝐊</mi><mrow id="S3.E16.m1.1.1.2.3a" xref="S3.E16.m1.1.1.2.3.cmml"></mrow><mi id="S3.E16.m1.1.1.2.3.2.3" xref="S3.E16.m1.1.1.2.3.2.3.cmml">u</mi><mrow id="S3.E16.m1.1.1.2.3b" xref="S3.E16.m1.1.1.2.3.cmml"></mrow><mi id="S3.E16.m1.1.1.2.3.3" xref="S3.E16.m1.1.1.2.3.3.cmml">T</mi></mmultiscripts></mrow><msqrt id="S3.E16.m1.1.1.3" xref="S3.E16.m1.1.1.3.cmml"><mrow id="S3.E16.m1.1.1.3.2" xref="S3.E16.m1.1.1.3.2.cmml"><mi id="S3.E16.m1.1.1.3.2.2" xref="S3.E16.m1.1.1.3.2.2.cmml">h</mi><mo id="S3.E16.m1.1.1.3.2.1" xref="S3.E16.m1.1.1.3.2.1.cmml">⁢</mo><msub id="S3.E16.m1.1.1.3.2.3" xref="S3.E16.m1.1.1.3.2.3.cmml"><mi id="S3.E16.m1.1.1.3.2.3.2" xref="S3.E16.m1.1.1.3.2.3.2.cmml">d</mi><mi id="S3.E16.m1.1.1.3.2.3.3" xref="S3.E16.m1.1.1.3.2.3.3.cmml">k</mi></msub></mrow></msqrt></mfrac><mo id="S3.E16.m1.2.2.1.1.3.3.2.2" xref="S3.E16.m1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E16.m1.2.2.1.2" xref="S3.E16.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E16.m1.2b"><apply id="S3.E16.m1.2.2.1.1.cmml" xref="S3.E16.m1.2.2.1"><eq id="S3.E16.m1.2.2.1.1.1.cmml" xref="S3.E16.m1.2.2.1.1.1"></eq><apply id="S3.E16.m1.2.2.1.1.2.cmml" xref="S3.E16.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E16.m1.2.2.1.1.2.1.cmml" xref="S3.E16.m1.2.2.1.1.2">superscript</csymbol><ci id="S3.E16.m1.2.2.1.1.2.2.cmml" xref="S3.E16.m1.2.2.1.1.2.2">𝜔</ci><ci id="S3.E16.m1.2.2.1.1.2.3.cmml" xref="S3.E16.m1.2.2.1.1.2.3">𝑢</ci></apply><apply id="S3.E16.m1.2.2.1.1.3.cmml" xref="S3.E16.m1.2.2.1.1.3"><times id="S3.E16.m1.2.2.1.1.3.1.cmml" xref="S3.E16.m1.2.2.1.1.3.1"></times><ci id="S3.E16.m1.2.2.1.1.3.2a.cmml" xref="S3.E16.m1.2.2.1.1.3.2"><mtext id="S3.E16.m1.2.2.1.1.3.2.cmml" xref="S3.E16.m1.2.2.1.1.3.2">softmax</mtext></ci><apply id="S3.E16.m1.1.1.cmml" xref="S3.E16.m1.2.2.1.1.3.3.2"><divide id="S3.E16.m1.1.1.1.cmml" xref="S3.E16.m1.2.2.1.1.3.3.2"></divide><apply id="S3.E16.m1.1.1.2.cmml" xref="S3.E16.m1.1.1.2"><times id="S3.E16.m1.1.1.2.1.cmml" xref="S3.E16.m1.1.1.2.1"></times><apply id="S3.E16.m1.1.1.2.2.cmml" xref="S3.E16.m1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.2.2.1.cmml" xref="S3.E16.m1.1.1.2.2">superscript</csymbol><apply id="S3.E16.m1.1.1.2.2.2.cmml" xref="S3.E16.m1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.2.2.2.1.cmml" xref="S3.E16.m1.1.1.2.2">subscript</csymbol><ci id="S3.E16.m1.1.1.2.2.2.2.cmml" xref="S3.E16.m1.1.1.2.2.2.2">𝐐</ci><ci id="S3.E16.m1.1.1.2.2.2.3.cmml" xref="S3.E16.m1.1.1.2.2.2.3">𝑛</ci></apply><ci id="S3.E16.m1.1.1.2.2.3.cmml" xref="S3.E16.m1.1.1.2.2.3">𝑢</ci></apply><apply id="S3.E16.m1.1.1.2.3.cmml" xref="S3.E16.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.2.3.1.cmml" xref="S3.E16.m1.1.1.2.3">superscript</csymbol><apply id="S3.E16.m1.1.1.2.3.2.cmml" xref="S3.E16.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.2.3.2.1.cmml" xref="S3.E16.m1.1.1.2.3">superscript</csymbol><ci id="S3.E16.m1.1.1.2.3.2.2.cmml" xref="S3.E16.m1.1.1.2.3.2.2">𝐊</ci><ci id="S3.E16.m1.1.1.2.3.2.3.cmml" xref="S3.E16.m1.1.1.2.3.2.3">𝑢</ci></apply><ci id="S3.E16.m1.1.1.2.3.3.cmml" xref="S3.E16.m1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S3.E16.m1.1.1.3.cmml" xref="S3.E16.m1.1.1.3"><root id="S3.E16.m1.1.1.3a.cmml" xref="S3.E16.m1.1.1.3"></root><apply id="S3.E16.m1.1.1.3.2.cmml" xref="S3.E16.m1.1.1.3.2"><times id="S3.E16.m1.1.1.3.2.1.cmml" xref="S3.E16.m1.1.1.3.2.1"></times><ci id="S3.E16.m1.1.1.3.2.2.cmml" xref="S3.E16.m1.1.1.3.2.2">ℎ</ci><apply id="S3.E16.m1.1.1.3.2.3.cmml" xref="S3.E16.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.3.2.3.1.cmml" xref="S3.E16.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.E16.m1.1.1.3.2.3.2.cmml" xref="S3.E16.m1.1.1.3.2.3.2">𝑑</ci><ci id="S3.E16.m1.1.1.3.2.3.3.cmml" xref="S3.E16.m1.1.1.3.2.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m1.2c">\mathbf{\omega}^{u}=\text{softmax}\left(\frac{{\mathbf{Q}_{n}^{u}\mathbf{K}^{u%
}}^{T}}{\sqrt{{hd}_{k}}}\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E16.m1.2d">italic_ω start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = softmax ( divide start_ARG bold_Q start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT bold_K start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_h italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS7.p6">
<p class="ltx_p" id="S3.SS2.SSS7.p6.7">where <math alttext="\mathbf{W}_{i}^{Q}\in\mathbb{R}^{d\times d_{k}}" class="ltx_Math" display="inline" id="S3.SS2.SSS7.p6.1.m1.1"><semantics id="S3.SS2.SSS7.p6.1.m1.1a"><mrow id="S3.SS2.SSS7.p6.1.m1.1.1" xref="S3.SS2.SSS7.p6.1.m1.1.1.cmml"><msubsup id="S3.SS2.SSS7.p6.1.m1.1.1.2" xref="S3.SS2.SSS7.p6.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS7.p6.1.m1.1.1.2.2.2" xref="S3.SS2.SSS7.p6.1.m1.1.1.2.2.2.cmml">𝐖</mi><mi id="S3.SS2.SSS7.p6.1.m1.1.1.2.2.3" xref="S3.SS2.SSS7.p6.1.m1.1.1.2.2.3.cmml">i</mi><mi id="S3.SS2.SSS7.p6.1.m1.1.1.2.3" xref="S3.SS2.SSS7.p6.1.m1.1.1.2.3.cmml">Q</mi></msubsup><mo id="S3.SS2.SSS7.p6.1.m1.1.1.1" xref="S3.SS2.SSS7.p6.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS7.p6.1.m1.1.1.3" xref="S3.SS2.SSS7.p6.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS7.p6.1.m1.1.1.3.2" xref="S3.SS2.SSS7.p6.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS7.p6.1.m1.1.1.3.3" xref="S3.SS2.SSS7.p6.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.SSS7.p6.1.m1.1.1.3.3.2" xref="S3.SS2.SSS7.p6.1.m1.1.1.3.3.2.cmml">d</mi><mo id="S3.SS2.SSS7.p6.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS7.p6.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.SSS7.p6.1.m1.1.1.3.3.3" xref="S3.SS2.SSS7.p6.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS7.p6.1.m1.1.1.3.3.3.2" xref="S3.SS2.SSS7.p6.1.m1.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS2.SSS7.p6.1.m1.1.1.3.3.3.3" xref="S3.SS2.SSS7.p6.1.m1.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS7.p6.1.m1.1b"><apply id="S3.SS2.SSS7.p6.1.m1.1.1.cmml" xref="S3.SS2.SSS7.p6.1.m1.1.1"><in id="S3.SS2.SSS7.p6.1.m1.1.1.1.cmml" xref="S3.SS2.SSS7.p6.1.m1.1.1.1"></in><apply id="S3.SS2.SSS7.p6.1.m1.1.1.2.cmml" xref="S3.SS2.SSS7.p6.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p6.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS7.p6.1.m1.1.1.2">superscript</csymbol><apply id="S3.SS2.SSS7.p6.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS7.p6.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p6.1.m1.1.1.2.2.1.cmml" xref="S3.SS2.SSS7.p6.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS7.p6.1.m1.1.1.2.2.2.cmml" xref="S3.SS2.SSS7.p6.1.m1.1.1.2.2.2">𝐖</ci><ci id="S3.SS2.SSS7.p6.1.m1.1.1.2.2.3.cmml" xref="S3.SS2.SSS7.p6.1.m1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS7.p6.1.m1.1.1.2.3.cmml" xref="S3.SS2.SSS7.p6.1.m1.1.1.2.3">𝑄</ci></apply><apply id="S3.SS2.SSS7.p6.1.m1.1.1.3.cmml" xref="S3.SS2.SSS7.p6.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p6.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS7.p6.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS7.p6.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS7.p6.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS7.p6.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS7.p6.1.m1.1.1.3.3"><times id="S3.SS2.SSS7.p6.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS7.p6.1.m1.1.1.3.3.1"></times><ci id="S3.SS2.SSS7.p6.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS7.p6.1.m1.1.1.3.3.2">𝑑</ci><apply id="S3.SS2.SSS7.p6.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS7.p6.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p6.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS7.p6.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS7.p6.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS7.p6.1.m1.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.SSS7.p6.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS7.p6.1.m1.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS7.p6.1.m1.1c">\mathbf{W}_{i}^{Q}\in\mathbb{R}^{d\times d_{k}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS7.p6.1.m1.1d">bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{W}_{i}^{K}\in\mathbb{R}^{d\times d_{k}}" class="ltx_Math" display="inline" id="S3.SS2.SSS7.p6.2.m2.1"><semantics id="S3.SS2.SSS7.p6.2.m2.1a"><mrow id="S3.SS2.SSS7.p6.2.m2.1.1" xref="S3.SS2.SSS7.p6.2.m2.1.1.cmml"><msubsup id="S3.SS2.SSS7.p6.2.m2.1.1.2" xref="S3.SS2.SSS7.p6.2.m2.1.1.2.cmml"><mi id="S3.SS2.SSS7.p6.2.m2.1.1.2.2.2" xref="S3.SS2.SSS7.p6.2.m2.1.1.2.2.2.cmml">𝐖</mi><mi id="S3.SS2.SSS7.p6.2.m2.1.1.2.2.3" xref="S3.SS2.SSS7.p6.2.m2.1.1.2.2.3.cmml">i</mi><mi id="S3.SS2.SSS7.p6.2.m2.1.1.2.3" xref="S3.SS2.SSS7.p6.2.m2.1.1.2.3.cmml">K</mi></msubsup><mo id="S3.SS2.SSS7.p6.2.m2.1.1.1" xref="S3.SS2.SSS7.p6.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS7.p6.2.m2.1.1.3" xref="S3.SS2.SSS7.p6.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS7.p6.2.m2.1.1.3.2" xref="S3.SS2.SSS7.p6.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS7.p6.2.m2.1.1.3.3" xref="S3.SS2.SSS7.p6.2.m2.1.1.3.3.cmml"><mi id="S3.SS2.SSS7.p6.2.m2.1.1.3.3.2" xref="S3.SS2.SSS7.p6.2.m2.1.1.3.3.2.cmml">d</mi><mo id="S3.SS2.SSS7.p6.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS7.p6.2.m2.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.SSS7.p6.2.m2.1.1.3.3.3" xref="S3.SS2.SSS7.p6.2.m2.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS7.p6.2.m2.1.1.3.3.3.2" xref="S3.SS2.SSS7.p6.2.m2.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS2.SSS7.p6.2.m2.1.1.3.3.3.3" xref="S3.SS2.SSS7.p6.2.m2.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS7.p6.2.m2.1b"><apply id="S3.SS2.SSS7.p6.2.m2.1.1.cmml" xref="S3.SS2.SSS7.p6.2.m2.1.1"><in id="S3.SS2.SSS7.p6.2.m2.1.1.1.cmml" xref="S3.SS2.SSS7.p6.2.m2.1.1.1"></in><apply id="S3.SS2.SSS7.p6.2.m2.1.1.2.cmml" xref="S3.SS2.SSS7.p6.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p6.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS7.p6.2.m2.1.1.2">superscript</csymbol><apply id="S3.SS2.SSS7.p6.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS7.p6.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p6.2.m2.1.1.2.2.1.cmml" xref="S3.SS2.SSS7.p6.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS7.p6.2.m2.1.1.2.2.2.cmml" xref="S3.SS2.SSS7.p6.2.m2.1.1.2.2.2">𝐖</ci><ci id="S3.SS2.SSS7.p6.2.m2.1.1.2.2.3.cmml" xref="S3.SS2.SSS7.p6.2.m2.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS7.p6.2.m2.1.1.2.3.cmml" xref="S3.SS2.SSS7.p6.2.m2.1.1.2.3">𝐾</ci></apply><apply id="S3.SS2.SSS7.p6.2.m2.1.1.3.cmml" xref="S3.SS2.SSS7.p6.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p6.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS7.p6.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS7.p6.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS7.p6.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS7.p6.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS7.p6.2.m2.1.1.3.3"><times id="S3.SS2.SSS7.p6.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.SSS7.p6.2.m2.1.1.3.3.1"></times><ci id="S3.SS2.SSS7.p6.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.SSS7.p6.2.m2.1.1.3.3.2">𝑑</ci><apply id="S3.SS2.SSS7.p6.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.SSS7.p6.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p6.2.m2.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS7.p6.2.m2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS7.p6.2.m2.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS7.p6.2.m2.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.SSS7.p6.2.m2.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS7.p6.2.m2.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS7.p6.2.m2.1c">\mathbf{W}_{i}^{K}\in\mathbb{R}^{d\times d_{k}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS7.p6.2.m2.1d">bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> are the projection matrices in the preference alignment module, <math alttext="\mathbf{Q}_{n}^{u}\in\mathbb{R}^{1\times hd_{k}}" class="ltx_Math" display="inline" id="S3.SS2.SSS7.p6.3.m3.1"><semantics id="S3.SS2.SSS7.p6.3.m3.1a"><mrow id="S3.SS2.SSS7.p6.3.m3.1.1" xref="S3.SS2.SSS7.p6.3.m3.1.1.cmml"><msubsup id="S3.SS2.SSS7.p6.3.m3.1.1.2" xref="S3.SS2.SSS7.p6.3.m3.1.1.2.cmml"><mi id="S3.SS2.SSS7.p6.3.m3.1.1.2.2.2" xref="S3.SS2.SSS7.p6.3.m3.1.1.2.2.2.cmml">𝐐</mi><mi id="S3.SS2.SSS7.p6.3.m3.1.1.2.2.3" xref="S3.SS2.SSS7.p6.3.m3.1.1.2.2.3.cmml">n</mi><mi id="S3.SS2.SSS7.p6.3.m3.1.1.2.3" xref="S3.SS2.SSS7.p6.3.m3.1.1.2.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS7.p6.3.m3.1.1.1" xref="S3.SS2.SSS7.p6.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS7.p6.3.m3.1.1.3" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.cmml"><mi id="S3.SS2.SSS7.p6.3.m3.1.1.3.2" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS7.p6.3.m3.1.1.3.3" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.3.cmml"><mrow id="S3.SS2.SSS7.p6.3.m3.1.1.3.3.2" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.3.2.cmml"><mn id="S3.SS2.SSS7.p6.3.m3.1.1.3.3.2.2" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.3.2.2.cmml">1</mn><mo id="S3.SS2.SSS7.p6.3.m3.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.3.2.1.cmml">×</mo><mi id="S3.SS2.SSS7.p6.3.m3.1.1.3.3.2.3" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.3.2.3.cmml">h</mi></mrow><mo id="S3.SS2.SSS7.p6.3.m3.1.1.3.3.1" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.3.1.cmml">⁢</mo><msub id="S3.SS2.SSS7.p6.3.m3.1.1.3.3.3" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS7.p6.3.m3.1.1.3.3.3.2" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS2.SSS7.p6.3.m3.1.1.3.3.3.3" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS7.p6.3.m3.1b"><apply id="S3.SS2.SSS7.p6.3.m3.1.1.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1"><in id="S3.SS2.SSS7.p6.3.m3.1.1.1.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1.1"></in><apply id="S3.SS2.SSS7.p6.3.m3.1.1.2.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p6.3.m3.1.1.2.1.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1.2">superscript</csymbol><apply id="S3.SS2.SSS7.p6.3.m3.1.1.2.2.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p6.3.m3.1.1.2.2.1.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS7.p6.3.m3.1.1.2.2.2.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1.2.2.2">𝐐</ci><ci id="S3.SS2.SSS7.p6.3.m3.1.1.2.2.3.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1.2.2.3">𝑛</ci></apply><ci id="S3.SS2.SSS7.p6.3.m3.1.1.2.3.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1.2.3">𝑢</ci></apply><apply id="S3.SS2.SSS7.p6.3.m3.1.1.3.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p6.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS7.p6.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS7.p6.3.m3.1.1.3.3.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.3"><times id="S3.SS2.SSS7.p6.3.m3.1.1.3.3.1.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.3.1"></times><apply id="S3.SS2.SSS7.p6.3.m3.1.1.3.3.2.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.3.2"><times id="S3.SS2.SSS7.p6.3.m3.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.3.2.1"></times><cn id="S3.SS2.SSS7.p6.3.m3.1.1.3.3.2.2.cmml" type="integer" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.3.2.2">1</cn><ci id="S3.SS2.SSS7.p6.3.m3.1.1.3.3.2.3.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.3.2.3">ℎ</ci></apply><apply id="S3.SS2.SSS7.p6.3.m3.1.1.3.3.3.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p6.3.m3.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS7.p6.3.m3.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.SSS7.p6.3.m3.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS7.p6.3.m3.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS7.p6.3.m3.1c">\mathbf{Q}_{n}^{u}\in\mathbb{R}^{1\times hd_{k}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS7.p6.3.m3.1d">bold_Q start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 1 × italic_h italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{K}^{u}\in\mathbb{R}^{m\times hd_{k}}" class="ltx_Math" display="inline" id="S3.SS2.SSS7.p6.4.m4.1"><semantics id="S3.SS2.SSS7.p6.4.m4.1a"><mrow id="S3.SS2.SSS7.p6.4.m4.1.1" xref="S3.SS2.SSS7.p6.4.m4.1.1.cmml"><msup id="S3.SS2.SSS7.p6.4.m4.1.1.2" xref="S3.SS2.SSS7.p6.4.m4.1.1.2.cmml"><mi id="S3.SS2.SSS7.p6.4.m4.1.1.2.2" xref="S3.SS2.SSS7.p6.4.m4.1.1.2.2.cmml">𝐊</mi><mi id="S3.SS2.SSS7.p6.4.m4.1.1.2.3" xref="S3.SS2.SSS7.p6.4.m4.1.1.2.3.cmml">u</mi></msup><mo id="S3.SS2.SSS7.p6.4.m4.1.1.1" xref="S3.SS2.SSS7.p6.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS7.p6.4.m4.1.1.3" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.cmml"><mi id="S3.SS2.SSS7.p6.4.m4.1.1.3.2" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS7.p6.4.m4.1.1.3.3" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.3.cmml"><mrow id="S3.SS2.SSS7.p6.4.m4.1.1.3.3.2" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.3.2.cmml"><mi id="S3.SS2.SSS7.p6.4.m4.1.1.3.3.2.2" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.3.2.2.cmml">m</mi><mo id="S3.SS2.SSS7.p6.4.m4.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.3.2.1.cmml">×</mo><mi id="S3.SS2.SSS7.p6.4.m4.1.1.3.3.2.3" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.3.2.3.cmml">h</mi></mrow><mo id="S3.SS2.SSS7.p6.4.m4.1.1.3.3.1" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.3.1.cmml">⁢</mo><msub id="S3.SS2.SSS7.p6.4.m4.1.1.3.3.3" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS7.p6.4.m4.1.1.3.3.3.2" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS2.SSS7.p6.4.m4.1.1.3.3.3.3" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS7.p6.4.m4.1b"><apply id="S3.SS2.SSS7.p6.4.m4.1.1.cmml" xref="S3.SS2.SSS7.p6.4.m4.1.1"><in id="S3.SS2.SSS7.p6.4.m4.1.1.1.cmml" xref="S3.SS2.SSS7.p6.4.m4.1.1.1"></in><apply id="S3.SS2.SSS7.p6.4.m4.1.1.2.cmml" xref="S3.SS2.SSS7.p6.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p6.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS7.p6.4.m4.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS7.p6.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS7.p6.4.m4.1.1.2.2">𝐊</ci><ci id="S3.SS2.SSS7.p6.4.m4.1.1.2.3.cmml" xref="S3.SS2.SSS7.p6.4.m4.1.1.2.3">𝑢</ci></apply><apply id="S3.SS2.SSS7.p6.4.m4.1.1.3.cmml" xref="S3.SS2.SSS7.p6.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p6.4.m4.1.1.3.1.cmml" xref="S3.SS2.SSS7.p6.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS7.p6.4.m4.1.1.3.2.cmml" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS7.p6.4.m4.1.1.3.3.cmml" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.3"><times id="S3.SS2.SSS7.p6.4.m4.1.1.3.3.1.cmml" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.3.1"></times><apply id="S3.SS2.SSS7.p6.4.m4.1.1.3.3.2.cmml" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.3.2"><times id="S3.SS2.SSS7.p6.4.m4.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.3.2.1"></times><ci id="S3.SS2.SSS7.p6.4.m4.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.3.2.2">𝑚</ci><ci id="S3.SS2.SSS7.p6.4.m4.1.1.3.3.2.3.cmml" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.3.2.3">ℎ</ci></apply><apply id="S3.SS2.SSS7.p6.4.m4.1.1.3.3.3.cmml" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p6.4.m4.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS7.p6.4.m4.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.SSS7.p6.4.m4.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS7.p6.4.m4.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS7.p6.4.m4.1c">\mathbf{K}^{u}\in\mathbb{R}^{m\times hd_{k}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS7.p6.4.m4.1d">bold_K start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_h italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> denote the projected <math alttext="\mathbf{q}_{n}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS7.p6.5.m5.1"><semantics id="S3.SS2.SSS7.p6.5.m5.1a"><msubsup id="S3.SS2.SSS7.p6.5.m5.1.1" xref="S3.SS2.SSS7.p6.5.m5.1.1.cmml"><mi id="S3.SS2.SSS7.p6.5.m5.1.1.2.2" xref="S3.SS2.SSS7.p6.5.m5.1.1.2.2.cmml">𝐪</mi><mi id="S3.SS2.SSS7.p6.5.m5.1.1.2.3" xref="S3.SS2.SSS7.p6.5.m5.1.1.2.3.cmml">n</mi><mi id="S3.SS2.SSS7.p6.5.m5.1.1.3" xref="S3.SS2.SSS7.p6.5.m5.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS7.p6.5.m5.1b"><apply id="S3.SS2.SSS7.p6.5.m5.1.1.cmml" xref="S3.SS2.SSS7.p6.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p6.5.m5.1.1.1.cmml" xref="S3.SS2.SSS7.p6.5.m5.1.1">superscript</csymbol><apply id="S3.SS2.SSS7.p6.5.m5.1.1.2.cmml" xref="S3.SS2.SSS7.p6.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p6.5.m5.1.1.2.1.cmml" xref="S3.SS2.SSS7.p6.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS7.p6.5.m5.1.1.2.2.cmml" xref="S3.SS2.SSS7.p6.5.m5.1.1.2.2">𝐪</ci><ci id="S3.SS2.SSS7.p6.5.m5.1.1.2.3.cmml" xref="S3.SS2.SSS7.p6.5.m5.1.1.2.3">𝑛</ci></apply><ci id="S3.SS2.SSS7.p6.5.m5.1.1.3.cmml" xref="S3.SS2.SSS7.p6.5.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS7.p6.5.m5.1c">\mathbf{q}_{n}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS7.p6.5.m5.1d">bold_q start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{P}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS7.p6.6.m6.1"><semantics id="S3.SS2.SSS7.p6.6.m6.1a"><msup id="S3.SS2.SSS7.p6.6.m6.1.1" xref="S3.SS2.SSS7.p6.6.m6.1.1.cmml"><mi id="S3.SS2.SSS7.p6.6.m6.1.1.2" xref="S3.SS2.SSS7.p6.6.m6.1.1.2.cmml">𝐏</mi><mi id="S3.SS2.SSS7.p6.6.m6.1.1.3" xref="S3.SS2.SSS7.p6.6.m6.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS7.p6.6.m6.1b"><apply id="S3.SS2.SSS7.p6.6.m6.1.1.cmml" xref="S3.SS2.SSS7.p6.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p6.6.m6.1.1.1.cmml" xref="S3.SS2.SSS7.p6.6.m6.1.1">superscript</csymbol><ci id="S3.SS2.SSS7.p6.6.m6.1.1.2.cmml" xref="S3.SS2.SSS7.p6.6.m6.1.1.2">𝐏</ci><ci id="S3.SS2.SSS7.p6.6.m6.1.1.3.cmml" xref="S3.SS2.SSS7.p6.6.m6.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS7.p6.6.m6.1c">\mathbf{P}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS7.p6.6.m6.1d">bold_P start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> respectively, and <math alttext="\mathbf{\omega}^{u}\in\mathbb{R}^{1\times m}" class="ltx_Math" display="inline" id="S3.SS2.SSS7.p6.7.m7.1"><semantics id="S3.SS2.SSS7.p6.7.m7.1a"><mrow id="S3.SS2.SSS7.p6.7.m7.1.1" xref="S3.SS2.SSS7.p6.7.m7.1.1.cmml"><msup id="S3.SS2.SSS7.p6.7.m7.1.1.2" xref="S3.SS2.SSS7.p6.7.m7.1.1.2.cmml"><mi id="S3.SS2.SSS7.p6.7.m7.1.1.2.2" xref="S3.SS2.SSS7.p6.7.m7.1.1.2.2.cmml">ω</mi><mi id="S3.SS2.SSS7.p6.7.m7.1.1.2.3" xref="S3.SS2.SSS7.p6.7.m7.1.1.2.3.cmml">u</mi></msup><mo id="S3.SS2.SSS7.p6.7.m7.1.1.1" xref="S3.SS2.SSS7.p6.7.m7.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS7.p6.7.m7.1.1.3" xref="S3.SS2.SSS7.p6.7.m7.1.1.3.cmml"><mi id="S3.SS2.SSS7.p6.7.m7.1.1.3.2" xref="S3.SS2.SSS7.p6.7.m7.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS7.p6.7.m7.1.1.3.3" xref="S3.SS2.SSS7.p6.7.m7.1.1.3.3.cmml"><mn id="S3.SS2.SSS7.p6.7.m7.1.1.3.3.2" xref="S3.SS2.SSS7.p6.7.m7.1.1.3.3.2.cmml">1</mn><mo id="S3.SS2.SSS7.p6.7.m7.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS7.p6.7.m7.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS7.p6.7.m7.1.1.3.3.3" xref="S3.SS2.SSS7.p6.7.m7.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS7.p6.7.m7.1b"><apply id="S3.SS2.SSS7.p6.7.m7.1.1.cmml" xref="S3.SS2.SSS7.p6.7.m7.1.1"><in id="S3.SS2.SSS7.p6.7.m7.1.1.1.cmml" xref="S3.SS2.SSS7.p6.7.m7.1.1.1"></in><apply id="S3.SS2.SSS7.p6.7.m7.1.1.2.cmml" xref="S3.SS2.SSS7.p6.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p6.7.m7.1.1.2.1.cmml" xref="S3.SS2.SSS7.p6.7.m7.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS7.p6.7.m7.1.1.2.2.cmml" xref="S3.SS2.SSS7.p6.7.m7.1.1.2.2">𝜔</ci><ci id="S3.SS2.SSS7.p6.7.m7.1.1.2.3.cmml" xref="S3.SS2.SSS7.p6.7.m7.1.1.2.3">𝑢</ci></apply><apply id="S3.SS2.SSS7.p6.7.m7.1.1.3.cmml" xref="S3.SS2.SSS7.p6.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p6.7.m7.1.1.3.1.cmml" xref="S3.SS2.SSS7.p6.7.m7.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS7.p6.7.m7.1.1.3.2.cmml" xref="S3.SS2.SSS7.p6.7.m7.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS7.p6.7.m7.1.1.3.3.cmml" xref="S3.SS2.SSS7.p6.7.m7.1.1.3.3"><times id="S3.SS2.SSS7.p6.7.m7.1.1.3.3.1.cmml" xref="S3.SS2.SSS7.p6.7.m7.1.1.3.3.1"></times><cn id="S3.SS2.SSS7.p6.7.m7.1.1.3.3.2.cmml" type="integer" xref="S3.SS2.SSS7.p6.7.m7.1.1.3.3.2">1</cn><ci id="S3.SS2.SSS7.p6.7.m7.1.1.3.3.3.cmml" xref="S3.SS2.SSS7.p6.7.m7.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS7.p6.7.m7.1c">\mathbf{\omega}^{u}\in\mathbb{R}^{1\times m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS7.p6.7.m7.1d">italic_ω start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 1 × italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the attention weights of the users’ multi-preferences. The calculated attention weights would be optimized to select the most aligned LLM’s generated preference and recommender’s (e.g. SASRec) preference embedding within the training process of attention module.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS7.p7">
<p class="ltx_p" id="S3.SS2.SSS7.p7.1">The Chain-of-Thought (CoT) prompt leveraging intermediate reasoning steps to enable LLM to achieve complex reasoning capabilities <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib51" title="">51</a>]</cite>. To guide LLM accurately in generating the explainable recommendation texts we desire, we have meticulously designed a zero-shot CoT prompt template, which consists of four progressive steps, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S3.F4" title="Figure 4 ‣ Model Training. ‣ 3.2.6 Prediction Module ‣ 3.2 LANE ‣ 3 Methodology ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS7.p8">
<p class="ltx_p" id="S3.SS2.SSS7.p8.1">By employing these four progressive steps, we guide LLM to achieve the ultimate goal of generating explainable recommendation text. This module can be described as:</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS7.p9">
<table class="ltx_equation ltx_eqn_table" id="S3.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Explanation}^{u}=\text{LLM}(\text{prompt}_{e}(S^{u},\text{preference}^{u%
},\mathbf{\omega}^{u},S_{|S^{u}|}^{u}))," class="ltx_Math" display="block" id="S3.E17.m1.2"><semantics id="S3.E17.m1.2a"><mrow id="S3.E17.m1.2.2.1" xref="S3.E17.m1.2.2.1.1.cmml"><mrow id="S3.E17.m1.2.2.1.1" xref="S3.E17.m1.2.2.1.1.cmml"><msup id="S3.E17.m1.2.2.1.1.3" xref="S3.E17.m1.2.2.1.1.3.cmml"><mtext id="S3.E17.m1.2.2.1.1.3.2" xref="S3.E17.m1.2.2.1.1.3.2a.cmml">Explanation</mtext><mi id="S3.E17.m1.2.2.1.1.3.3" xref="S3.E17.m1.2.2.1.1.3.3.cmml">u</mi></msup><mo id="S3.E17.m1.2.2.1.1.2" xref="S3.E17.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E17.m1.2.2.1.1.1" xref="S3.E17.m1.2.2.1.1.1.cmml"><mtext id="S3.E17.m1.2.2.1.1.1.3" xref="S3.E17.m1.2.2.1.1.1.3a.cmml">LLM</mtext><mo id="S3.E17.m1.2.2.1.1.1.2" xref="S3.E17.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E17.m1.2.2.1.1.1.1.1" xref="S3.E17.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E17.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E17.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E17.m1.2.2.1.1.1.1.1.1" xref="S3.E17.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E17.m1.2.2.1.1.1.1.1.1.6" xref="S3.E17.m1.2.2.1.1.1.1.1.1.6.cmml"><mtext id="S3.E17.m1.2.2.1.1.1.1.1.1.6.2" xref="S3.E17.m1.2.2.1.1.1.1.1.1.6.2a.cmml">prompt</mtext><mi id="S3.E17.m1.2.2.1.1.1.1.1.1.6.3" xref="S3.E17.m1.2.2.1.1.1.1.1.1.6.3.cmml">e</mi></msub><mo id="S3.E17.m1.2.2.1.1.1.1.1.1.5" xref="S3.E17.m1.2.2.1.1.1.1.1.1.5.cmml">⁢</mo><mrow id="S3.E17.m1.2.2.1.1.1.1.1.1.4.4" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.5.cmml"><mo id="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.5" stretchy="false" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.5.cmml">(</mo><msup id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">S</mi><mi id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.6" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.5.cmml">,</mo><msup id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2.cmml"><mtext id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2.2" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2.2a.cmml">preference</mtext><mi id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2.3" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml">u</mi></msup><mo id="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.7" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.5.cmml">,</mo><msup id="S3.E17.m1.2.2.1.1.1.1.1.1.3.3.3" xref="S3.E17.m1.2.2.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E17.m1.2.2.1.1.1.1.1.1.3.3.3.2" xref="S3.E17.m1.2.2.1.1.1.1.1.1.3.3.3.2.cmml">ω</mi><mi id="S3.E17.m1.2.2.1.1.1.1.1.1.3.3.3.3" xref="S3.E17.m1.2.2.1.1.1.1.1.1.3.3.3.3.cmml">u</mi></msup><mo id="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.8" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.5.cmml">,</mo><msubsup id="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.4" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.4.cmml"><mi id="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.4.2.2" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.4.2.2.cmml">S</mi><mrow id="S3.E17.m1.1.1.1.1" xref="S3.E17.m1.1.1.1.2.cmml"><mo id="S3.E17.m1.1.1.1.1.2" stretchy="false" xref="S3.E17.m1.1.1.1.2.1.cmml">|</mo><msup id="S3.E17.m1.1.1.1.1.1" xref="S3.E17.m1.1.1.1.1.1.cmml"><mi id="S3.E17.m1.1.1.1.1.1.2" xref="S3.E17.m1.1.1.1.1.1.2.cmml">S</mi><mi id="S3.E17.m1.1.1.1.1.1.3" xref="S3.E17.m1.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S3.E17.m1.1.1.1.1.3" stretchy="false" xref="S3.E17.m1.1.1.1.2.1.cmml">|</mo></mrow><mi id="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.4.3" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.4.3.cmml">u</mi></msubsup><mo id="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.9" stretchy="false" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.5.cmml">)</mo></mrow></mrow><mo id="S3.E17.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E17.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E17.m1.2.2.1.2" xref="S3.E17.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E17.m1.2b"><apply id="S3.E17.m1.2.2.1.1.cmml" xref="S3.E17.m1.2.2.1"><eq id="S3.E17.m1.2.2.1.1.2.cmml" xref="S3.E17.m1.2.2.1.1.2"></eq><apply id="S3.E17.m1.2.2.1.1.3.cmml" xref="S3.E17.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E17.m1.2.2.1.1.3.1.cmml" xref="S3.E17.m1.2.2.1.1.3">superscript</csymbol><ci id="S3.E17.m1.2.2.1.1.3.2a.cmml" xref="S3.E17.m1.2.2.1.1.3.2"><mtext id="S3.E17.m1.2.2.1.1.3.2.cmml" xref="S3.E17.m1.2.2.1.1.3.2">Explanation</mtext></ci><ci id="S3.E17.m1.2.2.1.1.3.3.cmml" xref="S3.E17.m1.2.2.1.1.3.3">𝑢</ci></apply><apply id="S3.E17.m1.2.2.1.1.1.cmml" xref="S3.E17.m1.2.2.1.1.1"><times id="S3.E17.m1.2.2.1.1.1.2.cmml" xref="S3.E17.m1.2.2.1.1.1.2"></times><ci id="S3.E17.m1.2.2.1.1.1.3a.cmml" xref="S3.E17.m1.2.2.1.1.1.3"><mtext id="S3.E17.m1.2.2.1.1.1.3.cmml" xref="S3.E17.m1.2.2.1.1.1.3">LLM</mtext></ci><apply id="S3.E17.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1"><times id="S3.E17.m1.2.2.1.1.1.1.1.1.5.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.5"></times><apply id="S3.E17.m1.2.2.1.1.1.1.1.1.6.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E17.m1.2.2.1.1.1.1.1.1.6.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.6">subscript</csymbol><ci id="S3.E17.m1.2.2.1.1.1.1.1.1.6.2a.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.6.2"><mtext id="S3.E17.m1.2.2.1.1.1.1.1.1.6.2.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.6.2">prompt</mtext></ci><ci id="S3.E17.m1.2.2.1.1.1.1.1.1.6.3.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.6.3">𝑒</ci></apply><vector id="S3.E17.m1.2.2.1.1.1.1.1.1.4.5.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.4"><apply id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝑆</ci><ci id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2.2a.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2.2"><mtext id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2.2">preference</mtext></ci><ci id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2.3">𝑢</ci></apply><apply id="S3.E17.m1.2.2.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E17.m1.2.2.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.3.3.3">superscript</csymbol><ci id="S3.E17.m1.2.2.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.3.3.3.2">𝜔</ci><ci id="S3.E17.m1.2.2.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.3.3.3.3">𝑢</ci></apply><apply id="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.4.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.4.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.4">superscript</csymbol><apply id="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.4.2.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.4.2.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.4">subscript</csymbol><ci id="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.4.2.2.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.4.2.2">𝑆</ci><apply id="S3.E17.m1.1.1.1.2.cmml" xref="S3.E17.m1.1.1.1.1"><abs id="S3.E17.m1.1.1.1.2.1.cmml" xref="S3.E17.m1.1.1.1.1.2"></abs><apply id="S3.E17.m1.1.1.1.1.1.cmml" xref="S3.E17.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.E17.m1.1.1.1.1.1.2.cmml" xref="S3.E17.m1.1.1.1.1.1.2">𝑆</ci><ci id="S3.E17.m1.1.1.1.1.1.3.cmml" xref="S3.E17.m1.1.1.1.1.1.3">𝑢</ci></apply></apply></apply><ci id="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.4.3.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.4.4.3">𝑢</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17.m1.2c">\text{Explanation}^{u}=\text{LLM}(\text{prompt}_{e}(S^{u},\text{preference}^{u%
},\mathbf{\omega}^{u},S_{|S^{u}|}^{u})),</annotation><annotation encoding="application/x-llamapun" id="S3.E17.m1.2d">Explanation start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = LLM ( prompt start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( italic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , preference start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_ω start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_S start_POSTSUBSCRIPT | italic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS7.p10">
<p class="ltx_p" id="S3.SS2.SSS7.p10.4">where <math alttext="\text{prompt}_{e}(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.SSS7.p10.1.m1.1"><semantics id="S3.SS2.SSS7.p10.1.m1.1a"><mrow id="S3.SS2.SSS7.p10.1.m1.1.2" xref="S3.SS2.SSS7.p10.1.m1.1.2.cmml"><msub id="S3.SS2.SSS7.p10.1.m1.1.2.2" xref="S3.SS2.SSS7.p10.1.m1.1.2.2.cmml"><mtext id="S3.SS2.SSS7.p10.1.m1.1.2.2.2" xref="S3.SS2.SSS7.p10.1.m1.1.2.2.2a.cmml">prompt</mtext><mi id="S3.SS2.SSS7.p10.1.m1.1.2.2.3" xref="S3.SS2.SSS7.p10.1.m1.1.2.2.3.cmml">e</mi></msub><mo id="S3.SS2.SSS7.p10.1.m1.1.2.1" xref="S3.SS2.SSS7.p10.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS7.p10.1.m1.1.2.3.2" xref="S3.SS2.SSS7.p10.1.m1.1.2.cmml"><mo id="S3.SS2.SSS7.p10.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS7.p10.1.m1.1.2.cmml">(</mo><mo id="S3.SS2.SSS7.p10.1.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS2.SSS7.p10.1.m1.1.1.cmml">⋅</mo><mo id="S3.SS2.SSS7.p10.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS7.p10.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS7.p10.1.m1.1b"><apply id="S3.SS2.SSS7.p10.1.m1.1.2.cmml" xref="S3.SS2.SSS7.p10.1.m1.1.2"><times id="S3.SS2.SSS7.p10.1.m1.1.2.1.cmml" xref="S3.SS2.SSS7.p10.1.m1.1.2.1"></times><apply id="S3.SS2.SSS7.p10.1.m1.1.2.2.cmml" xref="S3.SS2.SSS7.p10.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p10.1.m1.1.2.2.1.cmml" xref="S3.SS2.SSS7.p10.1.m1.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS7.p10.1.m1.1.2.2.2a.cmml" xref="S3.SS2.SSS7.p10.1.m1.1.2.2.2"><mtext id="S3.SS2.SSS7.p10.1.m1.1.2.2.2.cmml" xref="S3.SS2.SSS7.p10.1.m1.1.2.2.2">prompt</mtext></ci><ci id="S3.SS2.SSS7.p10.1.m1.1.2.2.3.cmml" xref="S3.SS2.SSS7.p10.1.m1.1.2.2.3">𝑒</ci></apply><ci id="S3.SS2.SSS7.p10.1.m1.1.1.cmml" xref="S3.SS2.SSS7.p10.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS7.p10.1.m1.1c">\text{prompt}_{e}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS7.p10.1.m1.1d">prompt start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> denotes the zero-shot CoT prompt template. <math alttext="S^{u}=\{S_{1}^{u},S_{1}^{u},...,S_{|S^{u}|-1}^{u}\}" class="ltx_Math" display="inline" id="S3.SS2.SSS7.p10.2.m2.5"><semantics id="S3.SS2.SSS7.p10.2.m2.5a"><mrow id="S3.SS2.SSS7.p10.2.m2.5.5" xref="S3.SS2.SSS7.p10.2.m2.5.5.cmml"><msup id="S3.SS2.SSS7.p10.2.m2.5.5.5" xref="S3.SS2.SSS7.p10.2.m2.5.5.5.cmml"><mi id="S3.SS2.SSS7.p10.2.m2.5.5.5.2" xref="S3.SS2.SSS7.p10.2.m2.5.5.5.2.cmml">S</mi><mi id="S3.SS2.SSS7.p10.2.m2.5.5.5.3" xref="S3.SS2.SSS7.p10.2.m2.5.5.5.3.cmml">u</mi></msup><mo id="S3.SS2.SSS7.p10.2.m2.5.5.4" xref="S3.SS2.SSS7.p10.2.m2.5.5.4.cmml">=</mo><mrow id="S3.SS2.SSS7.p10.2.m2.5.5.3.3" xref="S3.SS2.SSS7.p10.2.m2.5.5.3.4.cmml"><mo id="S3.SS2.SSS7.p10.2.m2.5.5.3.3.4" stretchy="false" xref="S3.SS2.SSS7.p10.2.m2.5.5.3.4.cmml">{</mo><msubsup id="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1" xref="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1.cmml"><mi id="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1.2.2" xref="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1.2.2.cmml">S</mi><mn id="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1.2.3" xref="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1.2.3.cmml">1</mn><mi id="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1.3" xref="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS7.p10.2.m2.5.5.3.3.5" xref="S3.SS2.SSS7.p10.2.m2.5.5.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2" xref="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2.cmml"><mi id="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2.2.2" xref="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2.2.2.cmml">S</mi><mn id="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2.2.3" xref="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2.2.3.cmml">1</mn><mi id="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2.3" xref="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS7.p10.2.m2.5.5.3.3.6" xref="S3.SS2.SSS7.p10.2.m2.5.5.3.4.cmml">,</mo><mi id="S3.SS2.SSS7.p10.2.m2.2.2" mathvariant="normal" xref="S3.SS2.SSS7.p10.2.m2.2.2.cmml">…</mi><mo id="S3.SS2.SSS7.p10.2.m2.5.5.3.3.7" xref="S3.SS2.SSS7.p10.2.m2.5.5.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS7.p10.2.m2.5.5.3.3.3" xref="S3.SS2.SSS7.p10.2.m2.5.5.3.3.3.cmml"><mi id="S3.SS2.SSS7.p10.2.m2.5.5.3.3.3.2.2" xref="S3.SS2.SSS7.p10.2.m2.5.5.3.3.3.2.2.cmml">S</mi><mrow id="S3.SS2.SSS7.p10.2.m2.1.1.1" xref="S3.SS2.SSS7.p10.2.m2.1.1.1.cmml"><mrow id="S3.SS2.SSS7.p10.2.m2.1.1.1.1.1" xref="S3.SS2.SSS7.p10.2.m2.1.1.1.1.2.cmml"><mo id="S3.SS2.SSS7.p10.2.m2.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS7.p10.2.m2.1.1.1.1.2.1.cmml">|</mo><msup id="S3.SS2.SSS7.p10.2.m2.1.1.1.1.1.1" xref="S3.SS2.SSS7.p10.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS7.p10.2.m2.1.1.1.1.1.1.2" xref="S3.SS2.SSS7.p10.2.m2.1.1.1.1.1.1.2.cmml">S</mi><mi id="S3.SS2.SSS7.p10.2.m2.1.1.1.1.1.1.3" xref="S3.SS2.SSS7.p10.2.m2.1.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S3.SS2.SSS7.p10.2.m2.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS7.p10.2.m2.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.SS2.SSS7.p10.2.m2.1.1.1.2" xref="S3.SS2.SSS7.p10.2.m2.1.1.1.2.cmml">−</mo><mn id="S3.SS2.SSS7.p10.2.m2.1.1.1.3" xref="S3.SS2.SSS7.p10.2.m2.1.1.1.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS7.p10.2.m2.5.5.3.3.3.3" xref="S3.SS2.SSS7.p10.2.m2.5.5.3.3.3.3.cmml">u</mi></msubsup><mo id="S3.SS2.SSS7.p10.2.m2.5.5.3.3.8" stretchy="false" xref="S3.SS2.SSS7.p10.2.m2.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS7.p10.2.m2.5b"><apply id="S3.SS2.SSS7.p10.2.m2.5.5.cmml" xref="S3.SS2.SSS7.p10.2.m2.5.5"><eq id="S3.SS2.SSS7.p10.2.m2.5.5.4.cmml" xref="S3.SS2.SSS7.p10.2.m2.5.5.4"></eq><apply id="S3.SS2.SSS7.p10.2.m2.5.5.5.cmml" xref="S3.SS2.SSS7.p10.2.m2.5.5.5"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p10.2.m2.5.5.5.1.cmml" xref="S3.SS2.SSS7.p10.2.m2.5.5.5">superscript</csymbol><ci id="S3.SS2.SSS7.p10.2.m2.5.5.5.2.cmml" xref="S3.SS2.SSS7.p10.2.m2.5.5.5.2">𝑆</ci><ci id="S3.SS2.SSS7.p10.2.m2.5.5.5.3.cmml" xref="S3.SS2.SSS7.p10.2.m2.5.5.5.3">𝑢</ci></apply><set id="S3.SS2.SSS7.p10.2.m2.5.5.3.4.cmml" xref="S3.SS2.SSS7.p10.2.m2.5.5.3.3"><apply id="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1.cmml" xref="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1.1.cmml" xref="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1.2.cmml" xref="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1.2.1.cmml" xref="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1.2.2.cmml" xref="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1.2.2">𝑆</ci><cn id="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1.3.cmml" xref="S3.SS2.SSS7.p10.2.m2.3.3.1.1.1.3">𝑢</ci></apply><apply id="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2.cmml" xref="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2.1.cmml" xref="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2.2.cmml" xref="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2.2.1.cmml" xref="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2.2.2.cmml" xref="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2.2.2">𝑆</ci><cn id="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2.2.3">1</cn></apply><ci id="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2.3.cmml" xref="S3.SS2.SSS7.p10.2.m2.4.4.2.2.2.3">𝑢</ci></apply><ci id="S3.SS2.SSS7.p10.2.m2.2.2.cmml" xref="S3.SS2.SSS7.p10.2.m2.2.2">…</ci><apply id="S3.SS2.SSS7.p10.2.m2.5.5.3.3.3.cmml" xref="S3.SS2.SSS7.p10.2.m2.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p10.2.m2.5.5.3.3.3.1.cmml" xref="S3.SS2.SSS7.p10.2.m2.5.5.3.3.3">superscript</csymbol><apply id="S3.SS2.SSS7.p10.2.m2.5.5.3.3.3.2.cmml" xref="S3.SS2.SSS7.p10.2.m2.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p10.2.m2.5.5.3.3.3.2.1.cmml" xref="S3.SS2.SSS7.p10.2.m2.5.5.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS7.p10.2.m2.5.5.3.3.3.2.2.cmml" xref="S3.SS2.SSS7.p10.2.m2.5.5.3.3.3.2.2">𝑆</ci><apply id="S3.SS2.SSS7.p10.2.m2.1.1.1.cmml" xref="S3.SS2.SSS7.p10.2.m2.1.1.1"><minus id="S3.SS2.SSS7.p10.2.m2.1.1.1.2.cmml" xref="S3.SS2.SSS7.p10.2.m2.1.1.1.2"></minus><apply id="S3.SS2.SSS7.p10.2.m2.1.1.1.1.2.cmml" xref="S3.SS2.SSS7.p10.2.m2.1.1.1.1.1"><abs id="S3.SS2.SSS7.p10.2.m2.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS7.p10.2.m2.1.1.1.1.1.2"></abs><apply id="S3.SS2.SSS7.p10.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS7.p10.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p10.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS7.p10.2.m2.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS7.p10.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS7.p10.2.m2.1.1.1.1.1.1.2">𝑆</ci><ci id="S3.SS2.SSS7.p10.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS7.p10.2.m2.1.1.1.1.1.1.3">𝑢</ci></apply></apply><cn id="S3.SS2.SSS7.p10.2.m2.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS7.p10.2.m2.1.1.1.3">1</cn></apply></apply><ci id="S3.SS2.SSS7.p10.2.m2.5.5.3.3.3.3.cmml" xref="S3.SS2.SSS7.p10.2.m2.5.5.3.3.3.3">𝑢</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS7.p10.2.m2.5c">S^{u}=\{S_{1}^{u},S_{1}^{u},...,S_{|S^{u}|-1}^{u}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS7.p10.2.m2.5d">italic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = { italic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , italic_S start_POSTSUBSCRIPT | italic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT }</annotation></semantics></math> denotes the interaction sequence of user u. <math alttext="S_{|S^{u}|}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS7.p10.3.m3.1"><semantics id="S3.SS2.SSS7.p10.3.m3.1a"><msubsup id="S3.SS2.SSS7.p10.3.m3.1.2" xref="S3.SS2.SSS7.p10.3.m3.1.2.cmml"><mi id="S3.SS2.SSS7.p10.3.m3.1.2.2.2" xref="S3.SS2.SSS7.p10.3.m3.1.2.2.2.cmml">S</mi><mrow id="S3.SS2.SSS7.p10.3.m3.1.1.1.1" xref="S3.SS2.SSS7.p10.3.m3.1.1.1.2.cmml"><mo id="S3.SS2.SSS7.p10.3.m3.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS7.p10.3.m3.1.1.1.2.1.cmml">|</mo><msup id="S3.SS2.SSS7.p10.3.m3.1.1.1.1.1" xref="S3.SS2.SSS7.p10.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS7.p10.3.m3.1.1.1.1.1.2" xref="S3.SS2.SSS7.p10.3.m3.1.1.1.1.1.2.cmml">S</mi><mi id="S3.SS2.SSS7.p10.3.m3.1.1.1.1.1.3" xref="S3.SS2.SSS7.p10.3.m3.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S3.SS2.SSS7.p10.3.m3.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS7.p10.3.m3.1.1.1.2.1.cmml">|</mo></mrow><mi id="S3.SS2.SSS7.p10.3.m3.1.2.3" xref="S3.SS2.SSS7.p10.3.m3.1.2.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS7.p10.3.m3.1b"><apply id="S3.SS2.SSS7.p10.3.m3.1.2.cmml" xref="S3.SS2.SSS7.p10.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p10.3.m3.1.2.1.cmml" xref="S3.SS2.SSS7.p10.3.m3.1.2">superscript</csymbol><apply id="S3.SS2.SSS7.p10.3.m3.1.2.2.cmml" xref="S3.SS2.SSS7.p10.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p10.3.m3.1.2.2.1.cmml" xref="S3.SS2.SSS7.p10.3.m3.1.2">subscript</csymbol><ci id="S3.SS2.SSS7.p10.3.m3.1.2.2.2.cmml" xref="S3.SS2.SSS7.p10.3.m3.1.2.2.2">𝑆</ci><apply id="S3.SS2.SSS7.p10.3.m3.1.1.1.2.cmml" xref="S3.SS2.SSS7.p10.3.m3.1.1.1.1"><abs id="S3.SS2.SSS7.p10.3.m3.1.1.1.2.1.cmml" xref="S3.SS2.SSS7.p10.3.m3.1.1.1.1.2"></abs><apply id="S3.SS2.SSS7.p10.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS7.p10.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p10.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS7.p10.3.m3.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS7.p10.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS7.p10.3.m3.1.1.1.1.1.2">𝑆</ci><ci id="S3.SS2.SSS7.p10.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS7.p10.3.m3.1.1.1.1.1.3">𝑢</ci></apply></apply></apply><ci id="S3.SS2.SSS7.p10.3.m3.1.2.3.cmml" xref="S3.SS2.SSS7.p10.3.m3.1.2.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS7.p10.3.m3.1c">S_{|S^{u}|}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS7.p10.3.m3.1d">italic_S start_POSTSUBSCRIPT | italic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the target item. <math alttext="\text{Explanation}^{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS7.p10.4.m4.1"><semantics id="S3.SS2.SSS7.p10.4.m4.1a"><msup id="S3.SS2.SSS7.p10.4.m4.1.1" xref="S3.SS2.SSS7.p10.4.m4.1.1.cmml"><mtext id="S3.SS2.SSS7.p10.4.m4.1.1.2" xref="S3.SS2.SSS7.p10.4.m4.1.1.2a.cmml">Explanation</mtext><mi id="S3.SS2.SSS7.p10.4.m4.1.1.3" xref="S3.SS2.SSS7.p10.4.m4.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS7.p10.4.m4.1b"><apply id="S3.SS2.SSS7.p10.4.m4.1.1.cmml" xref="S3.SS2.SSS7.p10.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS7.p10.4.m4.1.1.1.cmml" xref="S3.SS2.SSS7.p10.4.m4.1.1">superscript</csymbol><ci id="S3.SS2.SSS7.p10.4.m4.1.1.2a.cmml" xref="S3.SS2.SSS7.p10.4.m4.1.1.2"><mtext id="S3.SS2.SSS7.p10.4.m4.1.1.2.cmml" xref="S3.SS2.SSS7.p10.4.m4.1.1.2">Explanation</mtext></ci><ci id="S3.SS2.SSS7.p10.4.m4.1.1.3.cmml" xref="S3.SS2.SSS7.p10.4.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS7.p10.4.m4.1c">\text{Explanation}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS7.p10.4.m4.1d">Explanation start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the explainable recommendation texts.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experiment Settings</h3>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Dateset.</h5>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.1">We evaluated our method on three real-world datasets, which exhibit significant differences in domain and sparsity. These datasets have unique and distinct item titles, enabling LLMs to utilize only item titles to understand the relevant information and generate explainable recommendations.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p2">
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">MovieLens:</span> MovieLens is a classic dataset for movie recommendation systems, created and maintained by the GroupLens Research lab <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib16" title="">16</a>]</cite>. We used the version with 1 million user ratings (ML-1M).</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1">Amazon:</span> Amazon is one of the world’s largest online retailers, selling a variety of products including cosmetics and books. We used the large-scale Amazon review dataset collected by the McAuley Lab — Amazon Reviews 2014 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib35" title="">35</a>]</cite>. This dataset is divided into several individual datasets according to top product categories on Amazon. We adopted the Beauty category.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.1.1">Steam:</span> Steam is one of the world’s largest digital game distribution platforms, offering game purchases, social networking, digital rights management, and more. We used the Steam dataset introduced by Kang et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib25" title="">25</a>]</cite>, which includes user reviews and game information scraped from the Steam platform.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p3">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p3.3">We regard the presence of reviewer ratings as implicit feedback (i.e., user-item interactions) and use timestamps to determine the sequence of actions. To avoid excessive data sparsity and improve recommendation quality, we discarded users and items with fewer than 5 interactions in ML-1M and Beauty datasets, and fewer than 20 interactions in the Steam dataset. Additionally, we divided each user’s historical sequence <math alttext="S^{u}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p3.1.m1.1"><semantics id="S4.SS1.SSS0.Px1.p3.1.m1.1a"><msup id="S4.SS1.SSS0.Px1.p3.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p3.1.m1.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p3.1.m1.1.1.2" xref="S4.SS1.SSS0.Px1.p3.1.m1.1.1.2.cmml">S</mi><mi id="S4.SS1.SSS0.Px1.p3.1.m1.1.1.3" xref="S4.SS1.SSS0.Px1.p3.1.m1.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p3.1.m1.1b"><apply id="S4.SS1.SSS0.Px1.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.1.m1.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.1.m1.1.1.2">𝑆</ci><ci id="S4.SS1.SSS0.Px1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p3.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p3.1.m1.1c">S^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p3.1.m1.1d">italic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> into three parts based on their usage: (1). the most recent action <math alttext="S_{|S^{u}|}^{u}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p3.2.m2.1"><semantics id="S4.SS1.SSS0.Px1.p3.2.m2.1a"><msubsup id="S4.SS1.SSS0.Px1.p3.2.m2.1.2" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p3.2.m2.1.2.2.2" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.2.2.2.cmml">S</mi><mrow id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.1" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.2.cmml"><mo id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.1.2" stretchy="false" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.2.1.cmml">|</mo><msup id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.1.1.2.cmml">S</mi><mi id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.1.3" stretchy="false" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.2.1.cmml">|</mo></mrow><mi id="S4.SS1.SSS0.Px1.p3.2.m2.1.2.3" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.2.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p3.2.m2.1b"><apply id="S4.SS1.SSS0.Px1.p3.2.m2.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p3.2.m2.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.2">superscript</csymbol><apply id="S4.SS1.SSS0.Px1.p3.2.m2.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p3.2.m2.1.2.2.1.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p3.2.m2.1.2.2.2.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.2.2.2">𝑆</ci><apply id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.1"><abs id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.1.2"></abs><apply id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.1.1.2">𝑆</ci><ci id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.1.1.3">𝑢</ci></apply></apply></apply><ci id="S4.SS1.SSS0.Px1.p3.2.m2.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.2.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p3.2.m2.1c">S_{|S^{u}|}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p3.2.m2.1d">italic_S start_POSTSUBSCRIPT | italic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> for testing, (2). the second most recent action <math alttext="S_{|S^{u}|-1}^{u}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p3.3.m3.1"><semantics id="S4.SS1.SSS0.Px1.p3.3.m3.1a"><msubsup id="S4.SS1.SSS0.Px1.p3.3.m3.1.2" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p3.3.m3.1.2.2.2" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.2.2.2.cmml">S</mi><mrow id="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.cmml"><mrow id="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.2.cmml"><mo id="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.2.1.cmml">|</mo><msup id="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.1.1.2.cmml">S</mi><mi id="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.2" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.2.cmml">−</mo><mn id="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.3" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.3.cmml">1</mn></mrow><mi id="S4.SS1.SSS0.Px1.p3.3.m3.1.2.3" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.2.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p3.3.m3.1b"><apply id="S4.SS1.SSS0.Px1.p3.3.m3.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p3.3.m3.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.2">superscript</csymbol><apply id="S4.SS1.SSS0.Px1.p3.3.m3.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p3.3.m3.1.2.2.1.cmml" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p3.3.m3.1.2.2.2.cmml" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.2.2.2">𝑆</ci><apply id="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1"><minus id="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.2"></minus><apply id="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.1"><abs id="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.1.2"></abs><apply id="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.1.1.2">𝑆</ci><ci id="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.1.1.1.3">𝑢</ci></apply></apply><cn id="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.1.1.3">1</cn></apply></apply><ci id="S4.SS1.SSS0.Px1.p3.3.m3.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.2.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p3.3.m3.1c">S_{|S^{u}|-1}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p3.3.m3.1d">italic_S start_POSTSUBSCRIPT | italic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> for validation, and (3). all remaining actions for training. Finally, we also removed a small number of user sequences from which large models could not correctly extract preferences.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Statistics of the datasets</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S4.T1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.1">Dataset</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.2.1">Beauty</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.3.1">Steam</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.4.1">ML-1M</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T1.1.2.2.1">#Users</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.2">21849</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.3">39626</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.4">6040</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.1.3.3.1">#Items</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.3.3.2">12066</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.3.3.3">9261</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.3.3.4">3416</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.1.4.4.1">#actions</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.2">195141</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.3">1774231</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.4">999611</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.1.5.5.1">Avg.actions/User</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.2">8.93</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.3">44.77</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.4">163.5</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.1.6.6.1">Avg.actions/Item</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.2">16.17</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.3">191.58</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.4">292.63</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T1.1.7.7.1">Sparsity</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.7.7.2">99.93%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.7.7.3">99.52%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.7.7.4">95.16%</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p4">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p4.1">After preprocessing, the statistics of the datasets is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4.T1" title="Table 1 ‣ Dateset. ‣ 4.1 Experiment Settings ‣ 4 Experiments ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_tag">1</span></a>. The Beauty dataset has the smallest average number of interactions per user and per item, making it the sparsest. The Steam dataset follows, while the ML-1M dataset is the most dense.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Baseline.</h5>
<div class="ltx_para" id="S4.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p1.1">We selected three widely used sequential recommendation models as baseline models:</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS0.Px2.p2">
<ul class="ltx_itemize" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i1.p1.1.1">GRU4Rec</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib22" title="">22</a>]</cite> based on Gated Recurrent Unit (GRU) architecture, learns representations of user sequence behaviors for personalized recommendations. It possesses the ability to capture long-term dependencies and handle variable-length sequences.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i2.p1.1.1">BERT4Rec</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib43" title="">43</a>]</cite> leverages pre-trained BERT models to achieve deeper semantic understanding and personalized recommendations by learning representations of user historical behavior sequences.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i3.p1">
<p class="ltx_p" id="S4.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i3.p1.1.1">SASRec</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib25" title="">25</a>]</cite> is a sequential recommendation model based on self-attention mechanism. By introducing self-attention mechanism, it effectively captures the correlation between different items in user behavior sequences.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS1.SSS0.Px2.p3">
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p3.1">By integrating these three baseline models into our framework, we obtain LANE-GRU4Rec, LANE-BERT4Rec, and LANE-SASRec, respectively.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Evaluation Metrics.</h5>
<div class="ltx_para" id="S4.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px3.p1.1">To accurately evaluate the performance differences between recommendation models, we adopted two common Top-N metrics: HitRate@10 and NDCG@10. To avoid the computational burden of evaluating all user-item pairs, we followed the evaluation strategies described in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib25" title="">25</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#bib.bib19" title="">19</a>]</cite>. For each user <math alttext="u" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px3.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p1.1.m1.1d">italic_u</annotation></semantics></math>, we randomly sampled 100 negative items and ranked these items along with the ground truth item. Based on the ranking of these 101 items, we evaluated the performance using HitRate@10 and NDCG@10.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Implementation Details.</h5>
<div class="ltx_para" id="S4.SS1.SSS0.Px4.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px4.p1.6">To ensure a fair comparison, all baseline models and the proposed framework were implemented using the PyTorch framework and optimized using the Adam optimizer. Other hyperparameters and initialization strategies were kept the same as in the original papers or provided by the open-source code of the respective models.
For the proposed framework, we integrated baseline models as the recommendation model to be explained. Our framework utilizes GPT-3.5 as the large language model for generating multiple preferences and transcribing recommendation reasons. The embedding dimension <math alttext="d" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px4.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px4.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px4.p1.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.1.m1.1d">italic_d</annotation></semantics></math> was set to 384 (the same as Sentence-BERT), the number of heads <math alttext="h" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px4.p1.2.m2.1a"><mi id="S4.SS1.SSS0.Px4.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.2.m2.1b"><ci id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.2.m2.1c">h</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.2.m2.1d">italic_h</annotation></semantics></math> was 4, the hidden size <math alttext="d_{k}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.3.m3.1"><semantics id="S4.SS1.SSS0.Px4.p1.3.m3.1a"><msub id="S4.SS1.SSS0.Px4.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.cmml"><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.cmml">d</mi><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.3" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.3.m3.1b"><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2">𝑑</ci><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.3.m3.1c">d_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.3.m3.1d">italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> was 384, the number of user preferences <math alttext="m" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.4.m4.1"><semantics id="S4.SS1.SSS0.Px4.p1.4.m4.1a"><mi id="S4.SS1.SSS0.Px4.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px4.p1.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.4.m4.1b"><ci id="S4.SS1.SSS0.Px4.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.4.m4.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.4.m4.1d">italic_m</annotation></semantics></math> was 5, the learning rate was 0.001, the batch size was 128, and the dropout rate was 0.5. For the ML-1M dataset, we set the maximum sequence length <math alttext="n" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.5.m5.1"><semantics id="S4.SS1.SSS0.Px4.p1.5.m5.1a"><mi id="S4.SS1.SSS0.Px4.p1.5.m5.1.1" xref="S4.SS1.SSS0.Px4.p1.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.5.m5.1b"><ci id="S4.SS1.SSS0.Px4.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.5.m5.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.5.m5.1d">italic_n</annotation></semantics></math> to 200, and for the other two datasets, the maximum sequence length <math alttext="n" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.6.m6.1"><semantics id="S4.SS1.SSS0.Px4.p1.6.m6.1a"><mi id="S4.SS1.SSS0.Px4.p1.6.m6.1.1" xref="S4.SS1.SSS0.Px4.p1.6.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.6.m6.1b"><ci id="S4.SS1.SSS0.Px4.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.6.m6.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.6.m6.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.6.m6.1d">italic_n</annotation></semantics></math> was set to 50. All other hyperparameters used within baseline models were consistent with those in the original paper.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Experiment Results</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Our proposed explainable recommendation framework is highly flexible and can be integrated with any type of sequential recommendation model. Table <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4.T2" title="Table 2 ‣ 4.2 Experiment Results ‣ 4 Experiments ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_tag">2</span></a> shows the recommendation performance of our proposed explainable framework and all baseline models on three datasets. Through the performance results of the baseline model before and after nested frameworks, we can see that our proposed frameworks have achieved significant performance improvements on all baseline models, which further confirms the effectiveness of our model in enhancing traditional recommendations. Compared with the original baseline model, LANE-GRU4Rec’s NDCG@10 and HitRate@10 increased by 7.52% and 4.51% on average, LANE-BERT4Rec’s NDCG@10 and HitRate@10 increased by 12.44% and 9.67% on average, and LANE-SASRec’s NDCG@10 and HitRate@10 increased by 15.09% and 11.37% on average. This performance improvement is attributed to the stronger semantic derivation and induction capabilities of LLMs than the original baseline model. Based on their rich knowledge, LLMs can deduce additional higher-level semantic information from interaction sequences, thereby achieving stronger recommendation performance than integrated models.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Recommendation Performance Comparison</figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S4.T2.1" style="width:424.9pt;height:208.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(10.3pt,-5.1pt) scale(1.05112164140063,1.05112164140063) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.1.1.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.1.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T2.1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.1.1.2.1">Beauty</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T2.1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.1.1.3.1">Steam</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T2.1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.1.1.4.1">ML-1M</span></th>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.1"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.2.2.1.1">NDCG@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.2"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.2.2.2.1">HR@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.3"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.2.2.3.1">NDCG@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.4"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.2.2.4.1">HR@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.5"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.2.2.5.1">NDCG@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.6"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.2.2.6.1">HR@10</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.1.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.1.1.3.1.1">GRU4Rec</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.2">0.2853</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.3">0.4422</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.4">0.5025</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.5">0.7492</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.6">0.5277</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.7">0.7614</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.1.4.2.1">LANE-GRU4Rec</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.2">0.3238</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.3">0.4825</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.4">0.5109</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.5">0.7598</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.6">0.5667</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.7">0.7844</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.1.1.5.3.1"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.5.3.1.1">Improv.</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.5.3.2"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.5.3.2.1">13.49%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.5.3.3"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.5.3.3.1">9.11%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.5.3.4"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.5.3.4.1">1.67 %</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.5.3.5"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.5.3.5.1">1.41%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.5.3.6"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.5.3.6.1">7.39%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.5.3.7"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.5.3.7.1">3.02%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.1.1.6.4.1">BERT4Rec</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.6.4.2">0.224</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.6.4.3">0.3808</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.6.4.4">0.477</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.6.4.5">0.7261</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.6.4.6">0.4611</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.6.4.7">0.7151</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.1.7.5.1">LANE-ERT4Rec</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.2">0.2734</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.3">0.4526</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.4">0.4982</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.5">0.7495</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.6">0.5111</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.7">0.7646</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.1.1.8.6.1"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.8.6.1.1">Improv.</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.8.6.2"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.8.6.2.1">22.05%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.8.6.3"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.8.6.3.1">18.86%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.8.6.4"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.8.6.4.1">4.44%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.8.6.5"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.8.6.5.1">3.22%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.8.6.6"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.8.6.6.1">10.84%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.8.6.7"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.8.6.7.1">6.92%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.9.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.1.1.9.7.1">SASRec</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.9.7.2">0.2831</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.9.7.3">0.423</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.9.7.4">0.4789</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.9.7.5">0.728</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.9.7.6">0.5701</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.9.7.7">0.7983</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.10.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.1.10.8.1">LANE-SASRec</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.10.8.2">0.3511</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.10.8.3">0.5172</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.10.8.4">0.5649</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.10.8.5">0.803</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.10.8.6">0.5888</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.10.8.7">0.8106</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.11.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S4.T2.1.1.11.9.1"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.11.9.1.1">Improv.</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.1.1.11.9.2"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.11.9.2.1">24.02%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.1.1.11.9.3"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.11.9.3.1">22.27%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.1.1.11.9.4"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.11.9.4.1">17.96%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.1.1.11.9.5"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.11.9.5.1">10.30%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.1.1.11.9.6"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.11.9.6.1">3.28%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.1.1.11.9.7"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.11.9.7.1">1.54%</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">In addition, we can find that the improvement achieved on sparse datasets is more obvious than that on dense datasets. For example, on the Beauty dataset, LANE-SASRec improved NDCG@10 and HR@10 by 24.02% and 22.27% over SASRec, but on ML-1M dataset, the improvement was only 3.28% and 1.54%.Because in sparse data sets, the features that can be extracted by the original sequence recommendation model are limited, the improvement brought by the additional semantic information brought by LLMs will be more obvious.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Sensitivity Analysis</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.4">We conducted sensitivity analysis to investigate the impact of four important hyperparameters: hidden size<math alttext="d_{k}" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><msub id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">d</mi><mi id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">𝑑</ci><ci id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">d_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, number of heads <math alttext="h" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mi id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">h</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">italic_h</annotation></semantics></math>, maximum sequence length <math alttext="n" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.1"><semantics id="S4.SS3.p1.3.m3.1a"><mi id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><ci id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m3.1d">italic_n</annotation></semantics></math>, and number of user preferences <math alttext="m" class="ltx_Math" display="inline" id="S4.SS3.p1.4.m4.1"><semantics id="S4.SS3.p1.4.m4.1a"><mi id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><ci id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.4.m4.1d">italic_m</annotation></semantics></math>. In each experiment, we only changed the current hyperparameter under study while keeping the remaining hyperparameters at their default values as specified in Section <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4.SS1" title="4.1 Experiment Settings ‣ 4 Experiments ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_tag">4.1</span></a>. Additionally, we selected HitRate@5, HitRate@10, NDCG@5, and NDCG@10 as evaluation metrics and performed all hyperparameter experiments on the ML-1M dataset.</p>
</div>
<figure class="ltx_figure" id="S4.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="810" id="S4.F5.g1" src="x5.png" width="814"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>The experimental results of the sensitivity analysis on the ML-1M dataset for the four hyperparameters: (a) - (d) hidden size<math alttext="d_{k}" class="ltx_Math" display="inline" id="S4.F5.5.m1.1"><semantics id="S4.F5.5.m1.1b"><msub id="S4.F5.5.m1.1.1" xref="S4.F5.5.m1.1.1.cmml"><mi id="S4.F5.5.m1.1.1.2" xref="S4.F5.5.m1.1.1.2.cmml">d</mi><mi id="S4.F5.5.m1.1.1.3" xref="S4.F5.5.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F5.5.m1.1c"><apply id="S4.F5.5.m1.1.1.cmml" xref="S4.F5.5.m1.1.1"><csymbol cd="ambiguous" id="S4.F5.5.m1.1.1.1.cmml" xref="S4.F5.5.m1.1.1">subscript</csymbol><ci id="S4.F5.5.m1.1.1.2.cmml" xref="S4.F5.5.m1.1.1.2">𝑑</ci><ci id="S4.F5.5.m1.1.1.3.cmml" xref="S4.F5.5.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.5.m1.1d">d_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.F5.5.m1.1e">italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, (e) - (h) number of heads <math alttext="h" class="ltx_Math" display="inline" id="S4.F5.6.m2.1"><semantics id="S4.F5.6.m2.1b"><mi id="S4.F5.6.m2.1.1" xref="S4.F5.6.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.F5.6.m2.1c"><ci id="S4.F5.6.m2.1.1.cmml" xref="S4.F5.6.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.6.m2.1d">h</annotation><annotation encoding="application/x-llamapun" id="S4.F5.6.m2.1e">italic_h</annotation></semantics></math>, (i) - (l) maximum sequence length <math alttext="n" class="ltx_Math" display="inline" id="S4.F5.7.m3.1"><semantics id="S4.F5.7.m3.1b"><mi id="S4.F5.7.m3.1.1" xref="S4.F5.7.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.F5.7.m3.1c"><ci id="S4.F5.7.m3.1.1.cmml" xref="S4.F5.7.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.7.m3.1d">n</annotation><annotation encoding="application/x-llamapun" id="S4.F5.7.m3.1e">italic_n</annotation></semantics></math>, (m) - (p) and number of user preferences <math alttext="m" class="ltx_Math" display="inline" id="S4.F5.8.m4.1"><semantics id="S4.F5.8.m4.1b"><mi id="S4.F5.8.m4.1.1" xref="S4.F5.8.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.F5.8.m4.1c"><ci id="S4.F5.8.m4.1.1.cmml" xref="S4.F5.8.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.8.m4.1d">m</annotation><annotation encoding="application/x-llamapun" id="S4.F5.8.m4.1e">italic_m</annotation></semantics></math>. The evaluation metrics used are NDCG@5, NDCG@10, HitRate@5, and HitRate@10, .</figcaption>
</figure>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.8">The specific experimental results are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4.F5" title="Figure 5 ‣ 4.3 Sensitivity Analysis ‣ 4 Experiments ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_tag">5</span></a>. According to Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4.F5" title="Figure 5 ‣ 4.3 Sensitivity Analysis ‣ 4 Experiments ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_tag">5</span></a> (a) - (d), it is observed that when the hidden size <math alttext="d_{k}" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><msub id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mi id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml">d</mi><mi id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2">𝑑</ci><ci id="S4.SS3.p2.1.m1.1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">d_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> equals the embedding dimension <math alttext="d" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.1"><semantics id="S4.SS3.p2.2.m2.1a"><mi id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><ci id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.1d">italic_d</annotation></semantics></math>, the model performs optimally. Moreover, within a certain range, increasing <math alttext="d_{k}" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m3.1"><semantics id="S4.SS3.p2.3.m3.1a"><msub id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml"><mi id="S4.SS3.p2.3.m3.1.1.2" xref="S4.SS3.p2.3.m3.1.1.2.cmml">d</mi><mi id="S4.SS3.p2.3.m3.1.1.3" xref="S4.SS3.p2.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><apply id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.1.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p2.3.m3.1.1.2.cmml" xref="S4.SS3.p2.3.m3.1.1.2">𝑑</ci><ci id="S4.SS3.p2.3.m3.1.1.3.cmml" xref="S4.SS3.p2.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">d_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m3.1d">italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> leads to better model performance, but excessively large values may result in overfitting.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4.F5" title="Figure 5 ‣ 4.3 Sensitivity Analysis ‣ 4 Experiments ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_tag">5</span></a> (e) - (h) indicate that appropriately increasing the number of heads <math alttext="h" class="ltx_Math" display="inline" id="S4.SS3.p2.4.m4.1"><semantics id="S4.SS3.p2.4.m4.1a"><mi id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><ci id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">h</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m4.1d">italic_h</annotation></semantics></math> appropriately can enhance the model’s projection capability, leading to better generalization but sacrificing some accuracy. Consequently, in Top-N recommendations, when N is relatively large, the recommendation performance improves. However, when N is small, the performance may deteriorate.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4.F5" title="Figure 5 ‣ 4.3 Sensitivity Analysis ‣ 4 Experiments ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_tag">5</span></a> (i) - (l) indicate that increasing the maximum sequence length <math alttext="n" class="ltx_Math" display="inline" id="S4.SS3.p2.5.m5.1"><semantics id="S4.SS3.p2.5.m5.1a"><mi id="S4.SS3.p2.5.m5.1.1" xref="S4.SS3.p2.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m5.1b"><ci id="S4.SS3.p2.5.m5.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m5.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.5.m5.1d">italic_n</annotation></semantics></math> improves recommendation performance, but the effect gradually diminishes. Considering the balance between performance and training cost, it is common to choose a value slightly larger than the average sequence length of users.
As for the number of user preferences <math alttext="m" class="ltx_Math" display="inline" id="S4.SS3.p2.6.m6.1"><semantics id="S4.SS3.p2.6.m6.1a"><mi id="S4.SS3.p2.6.m6.1.1" xref="S4.SS3.p2.6.m6.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m6.1b"><ci id="S4.SS3.p2.6.m6.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m6.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.6.m6.1d">italic_m</annotation></semantics></math>, Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4.F5" title="Figure 5 ‣ 4.3 Sensitivity Analysis ‣ 4 Experiments ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_tag">5</span></a> (m) - (p) indicate that the performance is optimal when <math alttext="m=5" class="ltx_Math" display="inline" id="S4.SS3.p2.7.m7.1"><semantics id="S4.SS3.p2.7.m7.1a"><mrow id="S4.SS3.p2.7.m7.1.1" xref="S4.SS3.p2.7.m7.1.1.cmml"><mi id="S4.SS3.p2.7.m7.1.1.2" xref="S4.SS3.p2.7.m7.1.1.2.cmml">m</mi><mo id="S4.SS3.p2.7.m7.1.1.1" xref="S4.SS3.p2.7.m7.1.1.1.cmml">=</mo><mn id="S4.SS3.p2.7.m7.1.1.3" xref="S4.SS3.p2.7.m7.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m7.1b"><apply id="S4.SS3.p2.7.m7.1.1.cmml" xref="S4.SS3.p2.7.m7.1.1"><eq id="S4.SS3.p2.7.m7.1.1.1.cmml" xref="S4.SS3.p2.7.m7.1.1.1"></eq><ci id="S4.SS3.p2.7.m7.1.1.2.cmml" xref="S4.SS3.p2.7.m7.1.1.2">𝑚</ci><cn id="S4.SS3.p2.7.m7.1.1.3.cmml" type="integer" xref="S4.SS3.p2.7.m7.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m7.1c">m=5</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.7.m7.1d">italic_m = 5</annotation></semantics></math>. <math alttext="m" class="ltx_Math" display="inline" id="S4.SS3.p2.8.m8.1"><semantics id="S4.SS3.p2.8.m8.1a"><mi id="S4.SS3.p2.8.m8.1.1" xref="S4.SS3.p2.8.m8.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.8.m8.1b"><ci id="S4.SS3.p2.8.m8.1.1.cmml" xref="S4.SS3.p2.8.m8.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.8.m8.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.8.m8.1d">italic_m</annotation></semantics></math> should be chosen moderately, as too large a value may lead to information loss, while too small a value may introduce noise and increase training costs.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Case Study</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">In this study, we randomly selected a user interaction sequence from the Steam dataset as a sample to analyze the explanation results output by our framework (Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4.F6" title="Figure 6 ‣ 4.4 Case Study ‣ 4 Experiments ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_tag">6</span></a>). The complete results are shown in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#A2" title="Appendix B Sample Information and explanation of framework output ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_tag">B</span></a>. According to the CoT prompt and the standard response template we specified, LLM generates the corresponding text step by step. The core idea is to simulate and replicate the recommendation process of the recommendation model for explanation purposes.</p>
</div>
<figure class="ltx_figure" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="714" id="S4.F6.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Recommended results and corresponding explanations for the sample. <span class="ltx_text ltx_font_bold" id="S4.F6.3.1">Top</span>: "User preferences" gives the user preference and the corresponding attention weight, and "Rank in candidate" is the ranking of the target items finally output by our model. <span class="ltx_text ltx_font_bold" id="S4.F6.4.2">Bottom</span>: The explanation generated by LLM under the guidance of the CoT prompt template. It gives the results of the four steps in the CoT prompt template respectively.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1">Step 1 simulates and makes transparent the process of extracting features from user interaction sequences. In this step, our framework guides LLM to explain the origin of the previously extracted user interaction sequence features (user’s multiple preferences). For example, for the origin of the user’s preference for "Action-oriented gameplay", LLM explains that the user has also played games with intense and fast-paced action elements such as ‘Mortal Kombat Komplete Edition’, ‘Call of Duty®’, ‘Assassin’s Creed® III’ and ‘Crysis 2 - Maximum Edition’, and speculates that the user may like the adrenaline rush and sense of participation provided by these types of games.</p>
</div>
<div class="ltx_para" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.1">Step 2 simulates and makes transparent the process of embedding the target item. In this step, LLM will first generate a basic introduction for the target item, which provides users with basic information about the recommended item while ensuring that LLM can grasp the relevant information of the target item. Subsequently, LLM will compare the target item information it has grasped with the user’s multiple preferences one by one, evaluate the fit between the preferences and the target item, and explain the reasons. For example, for the good article "Action-oriented gameplay", the fit evaluation generated by LLM is "0.7", and the explanation given is "Far Cry® 2 is a typical action-adventure game with open world exploration, combat, and various missions."</p>
</div>
<div class="ltx_para" id="S4.SS4.p4">
<p class="ltx_p" id="S4.SS4.p4.1">Step 3 simulates and makes transparent the process of obtaining the recommendation score. In this step, LLM will predict whether the user will interact with the target item based on the fit evaluation of each preference in Step 2 and the attention weight of the user’s multiple preferences, and give a corresponding explanation. In the example we gave, LLM gave an interaction probability evaluation of “Medium” and gave the reason for the evaluation in "Reason".</p>
</div>
<div class="ltx_para" id="S4.SS4.p5">
<p class="ltx_p" id="S4.SS4.p5.1">The role of Step 4 is to convert the process-based explanations obtained in the previous steps into personalized recommendation text that fits the real scene. In this step, GPT will combine all the information in the first three steps to generate a personalized recommendation text about the target item for the user. From the generated recommendation text, we can see that the target item fits the user’s preferences, such as "realistic combat", "intense action" and "engaging and immersive experience".</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Quality Analysis of Explanation</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">We used an expert scoring method to evaluate the quality of the explanations generated by our model from seven metrics: clarity, detail, effectiveness, relevance, logic, trust, and satisfaction. The specific meaning of each metric is described by a question and scored on a 5-point scale. The model is anonymous. The complete questions are shown in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#A1" title="Appendix A Seven metrics and their description problems ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_tag">A</span></a>. We selected ERNIE-4.0, GPT-3.5-Turbo, and GPT-4o as the baseline models for this experiment.</p>
</div>
<div class="ltx_para" id="S4.SS5.p2">
<p class="ltx_p" id="S4.SS5.p2.1">In order to distinguish the different needs of merchants and users for the explanation content output by the recommendation system, we conducted two surveys: 1). Survey 1 is for user(consumer)-oriented explanations. Compared with the lengthy explanation of the model recommendation process, users pay more attention to the explanation of the recommendation results. Therefore, we randomly selected 50 samples from the Steam dataset and only intercepted the recommendation output by the model in Step 4 as the evaluation object. For fair comparison, we also let the other baseline models generate explanations of comparable text length and avoid outputting redundant process analysis. 2). Survey 2 is for merchant-oriented explanations. Unlike users, merchants need more detailed recommendation explanations, including explanations of the recommendation process of the recommendation system. Therefore, we randomly selected 20 samples and retained the complete explanation of the model output as the evaluation object. Correspondingly, we also let the baseline model give its complete recommendation process.</p>
</div>
<figure class="ltx_figure" id="S4.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="415" id="S4.F7.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>The score distribution of all samples for each model in Survey 1 and Survey 2 on the seven metrics.</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="426" id="S4.F8.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>The average scores of all samples for each model in Survey 1 and Survey 2 on the seven metrics.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS5.p3">
<p class="ltx_p" id="S4.SS5.p3.1">The score distribution of all samples in Survey 1 and Survey 2 is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4.F7" title="Figure 7 ‣ 4.5 Quality Analysis of Explanation ‣ 4 Experiments ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_tag">7</span></a>. We can see that our model is generally above other models in the distribution of the seven metrics, and performs best. Specifically, our model is significantly better than other models in terms of detail, relevance, logic, and satisfaction, and the score distribution of each metric is relatively concentrated, showing stable high performance. "ERNIE-4.0" and "GPT-4o" performed second, each with its own advantages, and only in some metrics the score distribution was wide and showed fluctuations. "GPT-3.5-turbo" scored the lowest in all metrics, and the distribution was relatively scattered, indicating that its performance was poor and not stable enough.</p>
</div>
<div class="ltx_para" id="S4.SS5.p4">
<p class="ltx_p" id="S4.SS5.p4.1">The average scores of all samples in survey 1 and survey 2 for each metric are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#S4.F8" title="Figure 8 ‣ 4.5 Quality Analysis of Explanation ‣ 4 Experiments ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_tag">8</span></a>. We can see that our model has the best average scores on the 7 metrics in both surveys, "GPT-4.0" and "ERNIE-4.0" are in the middle, and GPT-3.5-Turbo is the weakest. Among them, "GPT-4.0" performs better than "ERNIE-4.0" in survey 1, and vice versa in survey 2.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We propose an innovative explainable recommendation framework based on large language models (LLMs). This framework can improve the recommendation performance of its integrated "black box" recommendation model without tuning parameter-complex LLMs, and utilizes the language generation ability of LLMs to generate comprehensive and highly interpretable recommendation logic. Therefore, many more powerful closed-source commercial large language models can also enhance the explainability of online recommendation systems through API calls. Our research highlights the potential of LLMs as explainers in recommendation systems and their advantages in reducing training and maintenance costs. We conducted experiments on several real-world benchmark datasets to verify the effectiveness of the framework, and demonstrated its ability to generate accurate, diverse, high-quality explanations and obtain high user satisfaction through visualization cases and questionnaire voting. Future work can further explore how to further optimize this framework to adapt to different types and sizes of recommendation systems, provide more diversified explanations, and expand to a wider range of commercial applications.
</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib1.1.1">Achiam, J., Adler, S., Agarwal, S., Ahmad, L., Akkaya, I., Aleman, F. L., Almeida, D., Altenschmidt, J., Altman, S., Anadkat, S., et al.</span>
</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib1.2.1">arXiv preprint arXiv:2303.08774</span> (2023).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib2.1.1">Ba, J. L., Kiros, J. R., and Hinton, G. E.</span>
</span>
<span class="ltx_bibblock">Layer normalization.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib2.2.1">arXiv preprint arXiv:1607.06450</span> (2016).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib3.1.1">Balog, K., Radlinski, F., and Arakelyan, S.</span>
</span>
<span class="ltx_bibblock">Transparent, scrutable and explainable user models for personalized recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib3.2.1">Proceedings of the 42nd international acm sigir conference on research and development in information retrieval</span> (2019), pp. 265–274.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib4.1.1">Bao, K., Zhang, J., Zhang, Y., Wang, W., Feng, F., and He, X.</span>
</span>
<span class="ltx_bibblock">Tallrec: An effective and efficient tuning framework to align large language model with recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib4.2.1">Proceedings of the 17th ACM Conference on Recommender Systems</span> (2023), pp. 1007–1014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib5.1.1">Brown, T., Mann, B., Ryder, N., Subbiah, M., Kaplan, J. D., Dhariwal, P., Neelakantan, A., Shyam, P., Sastry, G., Askell, A., et al.</span>
</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib5.2.1">Advances in neural information processing systems 33</span> (2020), 1877–1901.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib6.1.1">Chen, J., Zhuang, F., Hong, X., Ao, X., Xie, X., and He, Q.</span>
</span>
<span class="ltx_bibblock">Attention-driven factor model for explainable personalized recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib6.2.1">The 41st international ACM SIGIR conference on research &amp; development in information retrieval</span> (2018), pp. 909–912.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib7.1.1">Chen, X., Chen, H., Xu, H., Zhang, Y., Cao, Y., Qin, Z., and Zha, H.</span>
</span>
<span class="ltx_bibblock">Personalized fashion recommendation with visual explanations based on multimodal attention network: Towards visually explainable recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib7.2.1">Proceedings of the 42nd International ACM SIGIR Conference on Research and Development in Information Retrieval</span> (2019), pp. 765–774.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib8.1.1">Cheng, H., Wang, S., Lu, W., Zhang, W., Zhou, M., Lu, K., and Liao, H.</span>
</span>
<span class="ltx_bibblock">Explainable recommendation with personalized review retrieval and aspect learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib8.2.1">arXiv preprint arXiv:2306.12657</span> (2023).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib9.1.1">Cheng, W., Shen, Y., Huang, L., and Zhu, Y.</span>
</span>
<span class="ltx_bibblock">Incorporating interpretability into latent factor models via fast influence analysis.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib9.2.1">Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</span> (2019), pp. 885–893.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib10.1.1">Devlin, J., Chang, M.-W., Lee, K., and Toutanova, K.</span>
</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional transformers for language understanding.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib10.2.1">arXiv preprint arXiv:1810.04805</span> (2018).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib11.1.1">Dong, Q., Li, L., Dai, D., Zheng, C., Wu, Z., Chang, B., Sun, X., Xu, J., and Sui, Z.</span>
</span>
<span class="ltx_bibblock">A survey on in-context learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib11.2.1">arXiv preprint arXiv:2301.00234</span> (2022).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib12.1.1">Fan, W., Zhao, Z., Li, J., Liu, Y., Mei, X., Wang, Y., Tang, J., and Li, Q.</span>
</span>
<span class="ltx_bibblock">Recommender systems in the era of large language models (llms).

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib12.2.1">arXiv preprint arXiv:2307.02046</span> (2023).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib13.1.1">Gedikli, F., Jannach, D., and Ge, M.</span>
</span>
<span class="ltx_bibblock">How should i explain? a comparison of different explanation types for recommender systems.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib13.2.1">International Journal of Human-Computer Studies 72</span>, 4 (2014), 367–382.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib14.1.1">Guan, Z., Wu, L., Zhao, H., He, M., and Fan, J.</span>
</span>
<span class="ltx_bibblock">Enhancing collaborative semantics of language model-driven recommendations via graph-aware learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib14.2.1">arXiv preprint arXiv:2406.13235</span> (2024).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib15.1.1">Guan, Z., Zhao, H., Wu, L., He, M., and Fan, J.</span>
</span>
<span class="ltx_bibblock">Langtopo: Aligning language descriptions of graphs with tokenized topological modeling.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib15.2.1">arXiv preprint arXiv:2406.13250</span> (2024).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib16.1.1">Harper, F. M., and Konstan, J. A.</span>
</span>
<span class="ltx_bibblock">The movielens datasets: History and context.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib16.2.1">Acm transactions on interactive intelligent systems (tiis) 5</span>, 4 (2015), 1–19.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib17.1.1">He, K., Zhang, X., Ren, S., and Sun, J.</span>
</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib17.2.1">Proceedings of the IEEE conference on computer vision and pattern recognition</span> (2016), pp. 770–778.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib18.1.1">He, X., Chen, T., Kan, M.-Y., and Chen, X.</span>
</span>
<span class="ltx_bibblock">Trirank: Review-aware explainable recommendation by modeling aspects.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib18.2.1">Proceedings of the 24th ACM international on conference on information and knowledge management</span> (2015), pp. 1661–1670.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib19.1.1">He, X., Liao, L., Zhang, H., Nie, L., Hu, X., and Chua, T.-S.</span>
</span>
<span class="ltx_bibblock">Neural collaborative filtering.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib19.2.1">Proceedings of the 26th international conference on world wide web</span> (2017), pp. 173–182.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib20.1.1">He, Z., Xie, Z., Jha, R., Steck, H., Liang, D., Feng, Y., Majumder, B. P., Kallus, N., and McAuley, J.</span>
</span>
<span class="ltx_bibblock">Large language models as zero-shot conversational recommenders.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib20.2.1">Proceedings of the 32nd ACM international conference on information and knowledge management</span> (2023), pp. 720–730.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib21.1.1">Heckel, R., Vlachos, M., Parnell, T., and Dünner, C.</span>
</span>
<span class="ltx_bibblock">Scalable and interpretable product recommendations via overlapping co-clustering.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib21.2.1">2017 IEEE 33rd International Conference on Data Engineering (ICDE)</span> (2017), IEEE, pp. 1033–1044.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib22.1.1">Hidasi, B., Karatzoglou, A., Baltrunas, L., and Tikk, D.</span>
</span>
<span class="ltx_bibblock">Session-based recommendations with recurrent neural networks.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib22.2.1">arXiv preprint arXiv:1511.06939</span> (2015).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib23.1.1">Hou, Y., Zhang, J., Lin, Z., Lu, H., Xie, R., McAuley, J., and Zhao, W. X.</span>
</span>
<span class="ltx_bibblock">Large language models are zero-shot rankers for recommender systems.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib23.2.1">European Conference on Information Retrieval</span> (2024), Springer, pp. 364–381.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib24.1.1">Huang, X., Lian, J., Lei, Y., Yao, J., Lian, D., and Xie, X.</span>
</span>
<span class="ltx_bibblock">Recommender ai agent: Integrating large language models for interactive recommendations.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib24.2.1">arXiv preprint arXiv:2308.16505</span> (2023).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib25.1.1">Kang, W.-C., and McAuley, J.</span>
</span>
<span class="ltx_bibblock">Self-attentive sequential recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib25.2.1">2018 IEEE international conference on data mining (ICDM)</span> (2018), IEEE, pp. 197–206.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib26.1.1">Kingma, D. P., and Ba, J.</span>
</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib26.2.1">arXiv preprint arXiv:1412.6980</span> (2014).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib27.1.1">Kojima, T., Gu, S. S., Reid, M., Matsuo, Y., and Iwasawa, Y.</span>
</span>
<span class="ltx_bibblock">Large language models are zero-shot reasoners.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib27.2.1">Advances in neural information processing systems 35</span> (2022), 22199–22213.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib28.1.1">Li, L., Zhang, Y., and Chen, L.</span>
</span>
<span class="ltx_bibblock">Personalized prompt learning for explainable recommendation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib28.2.1">ACM Transactions on Information Systems 41</span>, 4 (2023), 1–26.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib29.1.1">Lin, X., Wang, W., Li, Y., Yang, S., Feng, F., Wei, Y., and Chua, T.-S.</span>
</span>
<span class="ltx_bibblock">Data-efficient fine-tuning for llm-based recommendation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib29.2.1">arXiv preprint arXiv:2401.17197</span> (2024).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib30.1.1">Liu, J., Liu, C., Zhou, P., Lv, R., Zhou, K., and Zhang, Y.</span>
</span>
<span class="ltx_bibblock">Is chatgpt a good recommender? a preliminary study.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib30.2.1">arXiv preprint arXiv:2304.10149</span> (2023).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib31.1.1">Liu, Y., Han, T., Ma, S., Zhang, J., Yang, Y., Tian, J., He, H., Li, A., He, M., Liu, Z., et al.</span>
</span>
<span class="ltx_bibblock">Summary of chatgpt-related research and perspective towards the future of large language models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib31.2.1">Meta-Radiology</span> (2023), 100017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib32.1.1">Liu, Z., Wu, L., He, M., Guan, Z., Zhao, H., and Feng, N.</span>
</span>
<span class="ltx_bibblock">Dr. e bridges graphs with large language models through words.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib32.2.1">arXiv preprint arXiv:2406.15504</span> (2024).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib33.1.1">Ma, W., Zhang, M., Cao, Y., Jin, W., Wang, C., Liu, Y., Ma, S., and Ren, X.</span>
</span>
<span class="ltx_bibblock">Jointly learning explainable rules for recommendation with knowledge graph.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib33.2.1">The world wide web conference</span> (2019), pp. 1210–1221.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib34.1.1">McAuley, J., and Leskovec, J.</span>
</span>
<span class="ltx_bibblock">Hidden factors and hidden topics: understanding rating dimensions with review text.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib34.2.1">Proceedings of the 7th ACM conference on Recommender systems</span> (2013), pp. 165–172.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib35.1.1">McAuley, J., Targett, C., Shi, Q., and Van Den Hengel, A.</span>
</span>
<span class="ltx_bibblock">Image-based recommendations on styles and substitutes.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib35.2.1">Proceedings of the 38th international ACM SIGIR conference on research and development in information retrieval</span> (2015), pp. 43–52.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib36.1.1">Peake, G., and Wang, J.</span>
</span>
<span class="ltx_bibblock">Explanation mining: Post hoc interpretability of latent factor models for recommendation systems.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib36.2.1">Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</span> (2018), pp. 2060–2069.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib37.1.1">Radford, A., Wu, J., Child, R., Luan, D., Amodei, D., Sutskever, I., et al.</span>
</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib38.1.1">Reimers, N., and Gurevych, I.</span>
</span>
<span class="ltx_bibblock">Sentence-bert: Sentence embeddings using siamese bert-networks.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib38.2.1">Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing</span> (11 2019), Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib39.1.1">Ren, Z., Liang, S., Li, P., Wang, S., and de Rijke, M.</span>
</span>
<span class="ltx_bibblock">Social collaborative viewpoint regression with explainable recommendations.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib39.2.1">Proceedings of the tenth ACM international conference on web search and data mining</span> (2017), pp. 485–494.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib40.1.1">Shin, T., Razeghi, Y., Logan IV, R. L., Wallace, E., and Singh, S.</span>
</span>
<span class="ltx_bibblock">Autoprompt: Eliciting knowledge from language models with automatically generated prompts.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib40.2.1">arXiv preprint arXiv:2010.15980</span> (2020).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib41.1.1">Singh, J., and Anand, A.</span>
</span>
<span class="ltx_bibblock">Posthoc interpretability of learning to rank models using secondary training data.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib41.2.1">arXiv preprint arXiv:1806.11330</span> (2018).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib42.1.1">Strubell, E., Ganesh, A., and McCallum, A.</span>
</span>
<span class="ltx_bibblock">Energy and policy considerations for deep learning in nlp.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib42.2.1">arXiv preprint arXiv:1906.02243</span> (2019).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib43.1.1">Sun, F., Liu, J., Wu, J., Pei, C., Lin, X., Ou, W., and Jiang, P.</span>
</span>
<span class="ltx_bibblock">Bert4rec: Sequential recommendation with bidirectional encoder representations from transformer.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib43.2.1">Proceedings of the 28th ACM international conference on information and knowledge management</span> (2019), pp. 1441–1450.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib44.1.1">Tao, Y., Jia, Y., Wang, N., and Wang, H.</span>
</span>
<span class="ltx_bibblock">The fact: Taming latent factor models for explainability with factorization trees.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib44.2.1">Proceedings of the 42nd international ACM SIGIR conference on research and development in information retrieval</span> (2019), pp. 295–304.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib45.1.1">Tintarev, N., and Masthoff, J.</span>
</span>
<span class="ltx_bibblock">Explaining recommendations: Design and evaluation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib45.2.1">Recommender systems handbook</span>. Springer, 2015, pp. 353–382.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib46.1.1">Touvron, H., Lavril, T., Izacard, G., Martinet, X., Lachaux, M.-A., Lacroix, T., Rozière, B., Goyal, N., Hambro, E., Azhar, F., et al.</span>
</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib46.2.1">arXiv preprint arXiv:2302.13971</span> (2023).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib47.1.1">Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A. N., Kaiser, Ł., and Polosukhin, I.</span>
</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib47.2.1">Advances in neural information processing systems 30</span> (2017).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib48.1.1">Wang, X., Chen, Y., Yang, J., Wu, L., Wu, Z., and Xie, X.</span>
</span>
<span class="ltx_bibblock">A reinforcement learning framework for explainable recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib48.2.1">2018 IEEE international conference on data mining (ICDM)</span> (2018), IEEE, pp. 587–596.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib49.1.1">Wang, X., He, X., Feng, F., Nie, L., and Chua, T.-S.</span>
</span>
<span class="ltx_bibblock">Tem: Tree-enhanced embedding model for explainable recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib49.2.1">Proceedings of the 2018 world wide web conference</span> (2018), pp. 1543–1552.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib50.1.1">Wang, Y., Jiang, Z., Chen, Z., Yang, F., Zhou, Y., Cho, E., Fan, X., Huang, X., Lu, Y., and Yang, Y.</span>
</span>
<span class="ltx_bibblock">Recmind: Large language model powered agent for recommendation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib50.2.1">arXiv preprint arXiv:2308.14296</span> (2023).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib51.1.1">Wei, J., Wang, X., Schuurmans, D., Bosma, M., Xia, F., Chi, E., Le, Q. V., Zhou, D., et al.</span>
</span>
<span class="ltx_bibblock">Chain-of-thought prompting elicits reasoning in large language models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib51.2.1">Advances in neural information processing systems 35</span> (2022), 24824–24837.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib52.1.1">Wei, W., Ren, X., Tang, J., Wang, Q., Su, L., Cheng, S., Wang, J., Yin, D., and Huang, C.</span>
</span>
<span class="ltx_bibblock">Llmrec: Large language models with graph augmentation for recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib52.2.1">Proceedings of the 17th ACM International Conference on Web Search and Data Mining</span> (2024), pp. 806–815.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib53.1.1">Wu, L., Qiu, Z., Zheng, Z., Zhu, H., and Chen, E.</span>
</span>
<span class="ltx_bibblock">Exploring large language model for graph data understanding in online job recommendations.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib53.2.1">Proceedings of the AAAI Conference on Artificial Intelligence</span> (2024), vol. 38, pp. 9178–9186.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib54.1.1">Wu, L., Zhao, H., Li, Z., Huang, Z., Liu, Q., and Chen, E.</span>
</span>
<span class="ltx_bibblock">Learning the explainable semantic relations via unified graph topic-disentangled neural networks.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib54.2.1">ACM Transactions on Knowledge Discovery from Data 17</span>, 8 (2023), 1–23.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib55.1.1">Wu, L., Zheng, Z., Qiu, Z., Wang, H., Gu, H., Shen, T., Qin, C., Zhu, C., Zhu, H., Liu, Q., et al.</span>
</span>
<span class="ltx_bibblock">A survey on large language models for recommendation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib55.2.1">arXiv preprint arXiv:2305.19860</span> (2023).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib56.1.1">Xian, Y., Fu, Z., Muthukrishnan, S., De Melo, G., and Zhang, Y.</span>
</span>
<span class="ltx_bibblock">Reinforcement knowledge graph reasoning for explainable recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib56.2.1">Proceedings of the 42nd international ACM SIGIR conference on research and development in information retrieval</span> (2019), pp. 285–294.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib57.1.1">Zhang, Y., Chen, X., et al.</span>
</span>
<span class="ltx_bibblock">Explainable recommendation: A survey and new perspectives.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib57.2.1">Foundations and Trends® in Information Retrieval 14</span>, 1 (2020), 1–101.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
<span class="ltx_text ltx_font_smallcaps" id="bib.bib58.1.1">Zhang, Y., Lai, G., Zhang, M., Zhang, Y., Liu, Y., and Ma, S.</span>
</span>
<span class="ltx_bibblock">Explicit factor models for explainable recommendation based on phrase-level sentiment analysis.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib58.2.1">Proceedings of the 37th international ACM SIGIR conference on Research &amp; development in information retrieval</span> (2014), pp. 83–92.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Seven metrics and their description problems</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">The seven metrics and their complete description problems are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.02833v1#A1.T3" title="Table 3 ‣ Appendix A Seven metrics and their description problems ‣ LANE: Logic Alignment of Non-tuning Large Language Models and Online Recommendation Systems for Explainable Reason Generation"><span class="ltx_text ltx_ref_tag">3</span></a>, where Modelx represents the number name of each model, which is used to hide the model information.</p>
</div>
<figure class="ltx_table" id="A1.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>metrics and description problems</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T3.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="A1.T3.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A1.T3.1.1.1.1.1">Metric</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A1.T3.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A1.T3.1.1.1.2.1">Description Problems</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T3.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T3.1.2.1.1">clarity</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.1.2.1.2">Is the explanation provided by Modelx easy to understand?</td>
</tr>
<tr class="ltx_tr" id="A1.T3.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A1.T3.1.3.2.1">detail</th>
<td class="ltx_td ltx_align_left" id="A1.T3.1.3.2.2">Is the explanation of Modelx detailed enough?</td>
</tr>
<tr class="ltx_tr" id="A1.T3.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A1.T3.1.4.3.1">effectiveness</th>
<td class="ltx_td ltx_align_left" id="A1.T3.1.4.3.2">Does the explanation of Modelx help you understand the reason for the recommendation?</td>
</tr>
<tr class="ltx_tr" id="A1.T3.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A1.T3.1.5.4.1">relevance</th>
<td class="ltx_td ltx_align_left" id="A1.T3.1.5.4.2">Is the explanation of Modeli accurate and consistent?</td>
</tr>
<tr class="ltx_tr" id="A1.T3.1.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A1.T3.1.6.5.1">logic</th>
<td class="ltx_td ltx_align_left" id="A1.T3.1.6.5.2">Is the explanation of Modeli reasonable in structure and logically rigorous?</td>
</tr>
<tr class="ltx_tr" id="A1.T3.1.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A1.T3.1.7.6.1">trust</th>
<td class="ltx_td ltx_align_left" id="A1.T3.1.7.6.2">Do you trust the recommendations provided by Modelx?</td>
</tr>
<tr class="ltx_tr" id="A1.T3.1.8.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A1.T3.1.8.7.1">satisfaction</th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T3.1.8.7.2">What is your overall satisfaction with Modelx?</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Sample Information and explanation of framework output</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1"><span class="ltx_text ltx_font_bold" id="A2.p1.1.1">1. Sample Information</span></p>
</div>
<div class="ltx_para" id="A2.p2">
<p class="ltx_p" id="A2.p2.1"><span class="ltx_text ltx_font_bold" id="A2.p2.1.1">User’s interaction sequence</span>: [‘Condemned: Criminal Origins’, ‘BioShock® 2’, ‘Alan Wake’, ‘Mortal Kombat Komplete Edition’, ‘The Dig®’, ‘World of Goo’, ‘Mass Effect 2’, ‘STAR WARS™ Jedi Knight - Mysteries of the Sith™’, ‘STAR WARS™ Jedi Knight - Jedi Academy™’, ‘Machinarium’, ‘Samorost 2’, ‘Thief’, ‘Hector: Badge of Carnage - Full Series’, ‘Antichamber’, ‘Call of Duty®’, ‘Assassin’s Creed® III’, ‘Murdered: Soul Suspect’, ‘Home’, ‘Crysis 2 - Maximum Edition’, ‘Botanicula’, ‘LISA’, ‘Home is Where One Starts…’, ‘Call of Duty®: Black Ops’, ‘The Novelist’, ‘STAR WARS™ - The Force Unleashed™ Ultimate Sith Edition’, ‘Deus Ex: Human Revolution - Director’s Cut’, ‘Borderlands’, ‘The Talos Principle’, ‘To the Moon’, ‘The Typing of The Dead: Overkill’, ‘Electronic Super Joy’, ‘BIT.TRIP RUNNER’, ‘A Story About My Uncle’, ‘Deadly Premonition: The Director’s Cut’, ‘Deadly Premonition: The Director’s Cut’, ‘Remember Me’, ‘BIT.TRIP FLUX’]</p>
</div>
<div class="ltx_para" id="A2.p3">
<p class="ltx_p" id="A2.p3.1"><span class="ltx_text ltx_font_bold" id="A2.p3.1.1">User preferences</span>: {‘Action and Adventure Games’: 0.3561, ‘Sci-Fi Themed Games’: 0.3094, ‘Indie Games with Unique Storylines’: 0.1041, ‘Puzzle and Platform Games’: 0.108, ‘Games with Strong Narrative Elements’: 0.1225}</p>
</div>
<div class="ltx_para" id="A2.p4">
<p class="ltx_p" id="A2.p4.1"><span class="ltx_text ltx_font_bold" id="A2.p4.1.1">Target item</span>: Far Cry® 2: Fortune’s Edition</p>
</div>
<div class="ltx_para" id="A2.p5">
<p class="ltx_p" id="A2.p5.1"><span class="ltx_text ltx_font_bold" id="A2.p5.1.1">Rank in candidate</span>: 5/101</p>
</div>
<div class="ltx_para" id="A2.p6">
<p class="ltx_p" id="A2.p6.1"><span class="ltx_text ltx_font_bold" id="A2.p6.1.1">2. Explanation of framework output</span></p>
</div>
<div class="ltx_para" id="A2.p7">
<p class="ltx_p" id="A2.p7.1"><span class="ltx_text ltx_font_bold" id="A2.p7.1.1">Step 1</span>:</p>
</div>
<div class="ltx_para" id="A2.p8">
<p class="ltx_p" id="A2.p8.1"><span class="ltx_text ltx_font_bold" id="A2.p8.1.1">Preference 1</span>: Action and Adventure Games</p>
</div>
<div class="ltx_para" id="A2.p9">
<p class="ltx_p" id="A2.p9.1"><span class="ltx_text ltx_font_bold" id="A2.p9.1.1">Analysis</span>: The user has a strong inclination towards action and adventure games as seen from several titles in their historical interaction sequence, such as ‘Mortal Kombat Komplete Edition’, ‘Call of Duty®’, ‘Assassin’s Creed® III’, and ‘Crysis 2 - Maximum Edition’. These games offer thrilling experiences with dynamic gameplay and immersive worlds that capture the player’s interest. The user likely enjoys the adrenaline rush and engagement provided by these genres.</p>
</div>
<div class="ltx_para" id="A2.p10">
<p class="ltx_p" id="A2.p10.1"><span class="ltx_text ltx_font_bold" id="A2.p10.1.1">Preference 2</span>: Sci-Fi Themed Games</p>
</div>
<div class="ltx_para" id="A2.p11">
<p class="ltx_p" id="A2.p11.1"><span class="ltx_text ltx_font_bold" id="A2.p11.1.1">Analysis</span>: The user has shown a solid preference for sci-fi themed games, as evidenced by titles like ‘BioShock® 2’, ‘Mass Effect 2’, ‘STAR WARS™ Jedi Knight - Jedi Academy™’, and ‘Deus Ex: Human Revolution - Director’s Cut’. These games typically feature futuristic settings, advanced technology, and complex plotlines, which suggest that the user finds enjoyment in speculative and imaginative scenarios.</p>
</div>
<div class="ltx_para" id="A2.p12">
<p class="ltx_p" id="A2.p12.1"><span class="ltx_text ltx_font_bold" id="A2.p12.1.1">Preference 3</span>: Indie Games with Unique Storylines</p>
</div>
<div class="ltx_para" id="A2.p13">
<p class="ltx_p" id="A2.p13.1"><span class="ltx_text ltx_font_bold" id="A2.p13.1.1">Analysis</span>: The user’s interest in indie games with unique storylines is evident from their interactions with titles such as ‘Antichamber’, ‘World of Goo’, ‘Machinarium’, and ‘To the Moon’. These games often feature distinct art styles and innovative narratives that mainstream games might not offer, indicating the user’s appreciation for creativity and original storytelling.</p>
</div>
<div class="ltx_para" id="A2.p14">
<p class="ltx_p" id="A2.p14.1"><span class="ltx_text ltx_font_bold" id="A2.p14.1.1">Preference 4</span>: Puzzle and Platform Games</p>
</div>
<div class="ltx_para" id="A2.p15">
<p class="ltx_p" id="A2.p15.1"><span class="ltx_text ltx_font_bold" id="A2.p15.1.1">Analysis</span>: The user has shown affinity for puzzle and platform games through their interaction with titles like ‘The Talos Principle’, ‘BIT.TRIP RUNNER’, ‘World of Goo’, and ‘A Story About My Uncle’. These games challenge the player’s problem-solving skills and often feature platforming elements, which the user seems to enjoy.</p>
</div>
<div class="ltx_para" id="A2.p16">
<p class="ltx_p" id="A2.p16.1"><span class="ltx_text ltx_font_bold" id="A2.p16.1.1">Preference 5</span>: Games with Strong Narrative Elements</p>
</div>
<div class="ltx_para" id="A2.p17">
<p class="ltx_p" id="A2.p17.1"><span class="ltx_text ltx_font_bold" id="A2.p17.1.1">Analysis</span>: The user appears to have a penchant for games with strong narrative elements, as seen from ‘The Novelist’, ‘Remember Me’, ‘Murdered: Soul Suspect’, and ‘The Dig®’. These games focus heavily on storytelling and character development, indicating that the user values a compelling story along with gameplay.</p>
</div>
<div class="ltx_para" id="A2.p18">
<p class="ltx_p" id="A2.p18.1"><span class="ltx_text ltx_font_bold" id="A2.p18.1.1">Step 2</span>:</p>
</div>
<div class="ltx_para" id="A2.p19">
<p class="ltx_p" id="A2.p19.1"><span class="ltx_text ltx_font_bold" id="A2.p19.1.1">Target item introduction</span>:</p>
</div>
<div class="ltx_para" id="A2.p20">
<p class="ltx_p" id="A2.p20.1">‘Far Cry® 2: Fortune’s Edition’ is an open-world first-person shooter game set in a fictional African country embroiled in conflict. The game features a dynamic weather system, realistic fire propagation, and a mission-driven storyline.</p>
</div>
<div class="ltx_para" id="A2.p21">
<p class="ltx_p" id="A2.p21.1"><span class="ltx_text ltx_font_bold" id="A2.p21.1.1">Preference Fitness</span>:</p>
</div>
<div class="ltx_para" id="A2.p22">
<p class="ltx_p" id="A2.p22.1">1. <span class="ltx_text ltx_font_bold" id="A2.p22.1.1">Action and Adventure Games</span>: 0.9</p>
</div>
<div class="ltx_para" id="A2.p23">
<p class="ltx_p" id="A2.p23.1"><span class="ltx_text ltx_font_bold" id="A2.p23.1.1">Reason</span>: ‘Far Cry® 2’ is a quintessential action and adventure game with open-world exploration, combat, and various missions.</p>
</div>
<div class="ltx_para" id="A2.p24">
<p class="ltx_p" id="A2.p24.1">2. <span class="ltx_text ltx_font_bold" id="A2.p24.1.1">Sci-Fi Themed Games</span>: 0.2</p>
</div>
<div class="ltx_para" id="A2.p25">
<p class="ltx_p" id="A2.p25.1"><span class="ltx_text ltx_font_bold" id="A2.p25.1.1">Reason</span>: ‘Far Cry® 2’ is not set in a sci-fi universe and lacks futuristic elements, reducing its appeal based on this preference.</p>
</div>
<div class="ltx_para" id="A2.p26">
<p class="ltx_p" id="A2.p26.1">3. <span class="ltx_text ltx_font_bold" id="A2.p26.1.1">Indie Games with Unique Storylines</span>: 0.3</p>
</div>
<div class="ltx_para" id="A2.p27">
<p class="ltx_p" id="A2.p27.1"><span class="ltx_text ltx_font_bold" id="A2.p27.1.1">Reason</span>: While ‘Far Cry® 2’ has a strong narrative, it is not an indie game, nor does it possess a particularly unique storyline compared to the user’s indie game preferences.</p>
</div>
<div class="ltx_para" id="A2.p28">
<p class="ltx_p" id="A2.p28.1">4. <span class="ltx_text ltx_font_bold" id="A2.p28.1.1">Puzzle and Platform Games</span>: 0.1</p>
</div>
<div class="ltx_para" id="A2.p29">
<p class="ltx_p" id="A2.p29.1"><span class="ltx_text ltx_font_bold" id="A2.p29.1.1">Reason</span>: The game does not focus on puzzles or platforming mechanics, making it a poor fit for this preference.</p>
</div>
<div class="ltx_para" id="A2.p30">
<p class="ltx_p" id="A2.p30.1">5. <span class="ltx_text ltx_font_bold" id="A2.p30.1.1">Games with Strong Narrative Elements</span>: 0.7</p>
</div>
<div class="ltx_para" id="A2.p31">
<p class="ltx_p" id="A2.p31.1"><span class="ltx_text ltx_font_bold" id="A2.p31.1.1">Reason:</span> ‘Far Cry® 2’ does have a compelling narrative involving mercenaries, war, and survival, providing some level of satisfaction for this preference.</p>
</div>
<div class="ltx_para" id="A2.p32">
<p class="ltx_p" id="A2.p32.1"><span class="ltx_text ltx_font_bold" id="A2.p32.1.1">Step 3</span>:</p>
</div>
<div class="ltx_para" id="A2.p33">
<p class="ltx_p" id="A2.p33.1"><span class="ltx_text ltx_font_bold" id="A2.p33.1.1">Interaction probability</span>: Medium</p>
</div>
<div class="ltx_para" id="A2.p34">
<p class="ltx_p" id="A2.p34.1"><span class="ltx_text ltx_font_bold" id="A2.p34.1.1">Reason</span>: Given the strong alignment with the user’s top preferences (Action and Adventure Games with a weight of 0.3561 and a high fitness score of 0.9, and Games with Strong Narrative Elements with a weight of 0.1225 and a fitness score of 0.7), there is a significant probability that the user would interact with ‘Far Cry® 2: Fortune’s Edition’. The lower fitness scores for Sci-Fi Themed Games, Indie Games with Unique Storylines, and Puzzle and Platform Games reduce overall interaction probability but do not overpower the strong inclinations.</p>
</div>
<div class="ltx_para" id="A2.p35">
<p class="ltx_p" id="A2.p35.1"><span class="ltx_text ltx_font_bold" id="A2.p35.1.1">Step 4</span>:</p>
</div>
<div class="ltx_para" id="A2.p36">
<p class="ltx_p" id="A2.p36.1"><span class="ltx_text ltx_font_bold" id="A2.p36.1.1">Recommendation</span>: Based on your strong preference for action-packed adventure games and those with compelling narratives, ‘Far Cry® 2: Fortune’s Edition’ aligns well with your gaming tastes. While it may lack the sci-fi elements and unique indie storytelling you’re also fond of, the game’s immersive open-world experience and engaging missions make it a solid option for your next adventure. Enjoy the exploration and tactical combat in the realistic setting of Far Cry® 2!</p>
</div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Jul  3 06:07:57 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
