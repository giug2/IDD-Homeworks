<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations</title>
<!--Generated on Sun Aug 18 07:53:10 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="
Recommender Systems,  Large Language Models,  ID Tokenization,  Vector Quantization,  Collaborative Filtering.
" lang="en" name="keywords"/>
<base href="/html/2406.10450v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S1" title="In TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">I </span><span class="ltx_text ltx_font_smallcaps">Introduction</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2" title="In TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">II </span><span class="ltx_text ltx_font_smallcaps">The Proposed Method</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.SS1" title="In II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-A</span> </span><span class="ltx_text ltx_font_italic">Notations and Definitions</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.SS2" title="In II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-B</span> </span><span class="ltx_text ltx_font_italic">An Overview of the Proposed Framework</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.SS3" title="In II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-C</span> </span><span class="ltx_text ltx_font_italic">Masked Vector-Quantized Tokenizers for Users and Items</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.SS3.SSS1" title="In II-C Masked Vector-Quantized Tokenizers for Users and Items â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-C</span>1 </span><span class="ltx_text ltx_font_bold">Collaborative Knowledge</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.SS3.SSS2" title="In II-C Masked Vector-Quantized Tokenizers for Users and Items â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-C</span>2 </span><span class="ltx_text ltx_font_bold">Masking Operation</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.SS3.SSS3" title="In II-C Masked Vector-Quantized Tokenizers for Users and Items â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-C</span>3 </span><math alttext="K" class="ltx_Math" display="inline"><semantics><mi>K</mi><annotation-xml encoding="MathML-Content"><ci>ğ¾</ci></annotation-xml><annotation encoding="application/x-tex">K</annotation><annotation encoding="application/x-llamapun">italic_K</annotation></semantics></math><span class="ltx_text ltx_font_bold">-way Encoder and Codebook</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.SS3.SSS4" title="In II-C Masked Vector-Quantized Tokenizers for Users and Items â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-C</span>4 </span><math alttext="K" class="ltx_Math" display="inline"><semantics><mi>K</mi><annotation-xml encoding="MathML-Content"><ci>ğ¾</ci></annotation-xml><annotation encoding="application/x-tex">K</annotation><annotation encoding="application/x-llamapun">italic_K</annotation></semantics></math><span class="ltx_text ltx_font_bold">-to-1 Decoder</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.SS3.SSS5" title="In II-C Masked Vector-Quantized Tokenizers for Users and Items â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-C</span>5 </span><span class="ltx_text ltx_font_bold">Learning Objective</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.SS4" title="In II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-D</span> </span><span class="ltx_text ltx_font_italic">Generative Retrieval for Recommendations</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.SS4.SSS1" title="In II-D Generative Retrieval for Recommendations â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-D</span>1 </span><span class="ltx_text ltx_font_bold">Tokenization&amp;Prompts</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.SS4.SSS2" title="In II-D Generative Retrieval for Recommendations â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-D</span>2 </span><span class="ltx_text ltx_font_bold">User Modeling via LLM</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.SS4.SSS3" title="In II-D Generative Retrieval for Recommendations â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-D</span>3 </span><span class="ltx_text ltx_font_bold">Generative Retrieval</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.SS5" title="In II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-E</span> </span><span class="ltx_text ltx_font_italic">TokenRecâ€™s Training and Inference </span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.SS5.SSS1" title="In II-E TokenRecâ€™s Training and Inference â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-E</span>1 </span><span class="ltx_text ltx_font_bold">Training</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.SS5.SSS2" title="In II-E TokenRecâ€™s Training and Inference â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-E</span>2 </span><span class="ltx_text ltx_font_bold">Inference</span></span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3" title="In TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">III </span><span class="ltx_text ltx_font_smallcaps">Experiment</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.SS1" title="In III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span> </span><span class="ltx_text ltx_font_italic">Experimental Settings</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.SS1.SSS1" title="In III-A Experimental Settings â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span>1 </span><span class="ltx_text ltx_font_bold">Datasets</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.SS1.SSS2" title="In III-A Experimental Settings â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span>2 </span><span class="ltx_text ltx_font_bold">Baselines</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.SS1.SSS3" title="In III-A Experimental Settings â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span>3 </span><span class="ltx_text ltx_font_bold">Evaluation Metrics</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.SS1.SSS4" title="In III-A Experimental Settings â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span>4 </span><span class="ltx_text ltx_font_bold">Hyper-parameter Settings</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.SS2" title="In III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-B</span> </span><span class="ltx_text ltx_font_italic">Performance Comparison of Recommender Systems</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.SS3" title="In III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-C</span> </span><span class="ltx_text ltx_font_italic">Generalizability Evaluation</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.SS4" title="In III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-D</span> </span><span class="ltx_text ltx_font_italic">Efficiency Evaluation</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.SS5" title="In III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-E</span> </span><span class="ltx_text ltx_font_italic">Ablation Study</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.SS6" title="In III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-F</span> </span><span class="ltx_text ltx_font_italic">Hyper-parameter Analysis</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.SS6.SSS1" title="In III-F Hyper-parameter Analysis â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-F</span>1 </span><span class="ltx_text ltx_font_bold">Effect of Masking Ratio <math alttext="\rho" class="ltx_Math" display="inline"><semantics><mi>Ï</mi><annotation-xml encoding="MathML-Content"><ci>ğœŒ</ci></annotation-xml><annotation encoding="application/x-tex">\rho</annotation><annotation encoding="application/x-llamapun">italic_Ï</annotation></semantics></math></span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.SS6.SSS2" title="In III-F Hyper-parameter Analysis â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-F</span>2 </span><span class="ltx_text ltx_font_bold">Effect of Codebook Settings <math alttext="K" class="ltx_Math" display="inline"><semantics><mi>K</mi><annotation-xml encoding="MathML-Content"><ci>ğ¾</ci></annotation-xml><annotation encoding="application/x-tex">K</annotation><annotation encoding="application/x-llamapun">italic_K</annotation></semantics></math> and <math alttext="L" class="ltx_Math" display="inline"><semantics><mi>L</mi><annotation-xml encoding="MathML-Content"><ci>ğ¿</ci></annotation-xml><annotation encoding="application/x-tex">L</annotation><annotation encoding="application/x-llamapun">italic_L</annotation></semantics></math></span></span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S4" title="In TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">IV </span><span class="ltx_text ltx_font_smallcaps">Related Work</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S4.SS1" title="In IV Related Work â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-A</span> </span><span class="ltx_text ltx_font_italic">Collaborative Filtering</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S4.SS2" title="In IV Related Work â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-B</span> </span><span class="ltx_text ltx_font_italic">LLM-based Recommender Systems</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S5" title="In TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">V </span><span class="ltx_text ltx_font_smallcaps">Conclusion</span></span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Haohao Qu, Wenqi Fan<sup class="ltx_sup" id="id6.2.id1">âˆ—</sup>, Zihuai Zhao, Qing Li,Â 
<br class="ltx_break"/>
</span><span class="ltx_author_notes">
H. Qu, Z. Zhao, and Q. Li are with the Department of Computing, The Kong Kong Polytechnic University. E-mail: haohao.qu@connect.polyu.hk, Scofield.zzh@gmail.com, qing-prof.li@polyu.edu.hk.
W. Fan is with the Department of Computing (COMP) and Department of Management and Marketing (MM), The Hong Kong Polytechnic Univerisity. E-mail: wenqifan03@gmail.com
*Corresponding author: Wenqi Fan</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id7.id1">There is a growing interest in utilizing large language models (LLMs) to advance next-generation Recommender Systems (RecSys), driven by their outstanding language understanding and reasoning capabilities. In this scenario, tokenizing users and items becomes essential for ensuring seamless alignment of LLMs with recommendations. While studies have made progress in representing users and items using textual contents or latent representations, challenges remain in capturing high-order collaborative knowledge into discrete tokens compatible with LLMs and generalizing to unseen users/items. To address these challenges, we propose a novel framework called <span class="ltx_text ltx_font_bold" id="id7.id1.1">TokenRec</span>, which introduces an effective ID tokenization strategy and an efficient retrieval paradigm for LLM-based recommendations. Our tokenization strategy involves quantizing the masked user/item representations learned from collaborative filtering into discrete tokens, thus achieving smooth incorporation of high-order collaborative knowledge and generalizable tokenization of users and items for LLM-based RecSys. Meanwhile, our generative retrieval paradigm is designed to efficiently recommend top-K items for users, eliminating the need for the time-consuming auto-regressive decoding and beam search processes used by LLMs, thus significantly reducing inference time. Comprehensive experiments validate the effectiveness of the proposed methods, demonstrating that TokenRec outperforms competitive benchmarks, including both traditional recommender systems and emerging LLM-based recommender systems.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Recommender Systems, Large Language Models, ID Tokenization, Vector Quantization, Collaborative Filtering.

</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">Introduction</span>
</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">As a prominent branch in the data mining field, recommender systems (<span class="ltx_text ltx_font_bold" id="S1.p1.1.1">RecSys</span>) serve as an indispensable and effective technique in addressing information overload problems and enriching user experience across diverse applicationsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib2" title="">2</a>]</cite>, such as e-commerce, job search, and social media platforms.
To provide personalized recommendations that accord with user preferences, one of the most representative techniques is collaborative filtering (CF), which aims to capture collaborative knowledge by modeling the history of user-item interactionsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib3" title="">3</a>]</cite>.
For example, as the most classic CF method, Matrix Factorization (MF)Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib4" title="">4</a>]</cite> decomposes the use-item matrix into two low-rank matrices (i.e., user&amp;item representations) to represent each user and item with a unique ID (namely ID indexing/tokenizing), and calculates matching scores to predict user behaviors and generate recommendations via the inner product between their representations.
Due to the superior ability in representation learning on graph-structured data, Graph Neural Networks (GNNs) (e.g., LightGCNÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib5" title="">5</a>]</cite> and GTNÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib6" title="">6</a>]</cite>) have been recently employed to significantly enhance CF by capturing higher-order collaborative knowledge on user-item interaction graphs for recommendations in IDs manners.
The main idea of the existing methods is to obtain learnable representations (i.e., token embeddings) for discrete user&amp;item IDs (i.e., tokens).</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="302" id="S1.F1.g1" src="x1.png" width="822"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Comparison of ID tokenization methods in LLM-based recommendations. Unlike the existing methods, our approach can tokenize users and items with LLM-compatible tokens by leveraging high-order collaborative knowledge.
</figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">More recently, the rapid development of Large Language Models (LLMs) techniques (e.g., ChatGPT and LLaMA) has showcased notable milestones for revolutionizing natural language processing techniquesÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib8" title="">8</a>]</cite>.
Technically, the unprecedented power of LLMs can be attributed to the scaling up of model/parameter size alongside a tremendous amount of training corpus.
In particular, LLMs equipped with billion-scale parameters have exhibited unprecedented language understanding and generation abilities, along with remarkable generalization capability and in-context learning skills that facilitate LLMs to better generalize to unseen tasks and domainsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib8" title="">8</a>]</cite>.
Given the emerging trends and aforementioned advancements of LLMs, LLM-empowered recommender systems have drawn increasing attention from recent studies and demonstrated distinctive abilities for advancing recommender systemsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib2" title="">2</a>]</cite>.
For example, ChatRecÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib9" title="">9</a>]</cite> integrates ChatGPT into conversational recommendations, which enables users to deliver their explicit preferences in natural language.
P5Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib10" title="">10</a>]</cite> introduces an LLM-based recommendation framework that unifies diverse recommendation tasks by multi-task prompt-based pre-training.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Unlike the ID-based recommendation methods (e.g., MF and GNN-based), users&amp;items tokenization is one of the most critical steps to take advantage of LLMs within recommendations, as shown in FigureÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S1.F1" title="Figure 1 â€£ I Introduction â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">1</span></a>.
To be more specific, the naive approach known as Independent Indexing (IID) assigns special tokens (i.e., ID) to tokenize each user and item within language models directly. However, this approach becomes infeasible and unrealistic when dealing with large-scale real-world recommender systems, in which the sizes of users and items typically reach billions, dramatically expanding the token vocabulary in LLMs.
Meanwhile, as a natural solution, textual title indexing is proposed to utilize LLMsâ€™ in-vocabulary tokens to represent items based on their titles and descriptions, such as the example â€<em class="ltx_emph ltx_font_italic" id="S1.p3.1.1">Apple iPhone 15, 256 GB, black</em>â€, thus avoiding vocabulary size explosion in LLMsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib11" title="">11</a>]</cite>.
To achieve a closer alignment between recommendations and natural language, P5 employs <em class="ltx_emph ltx_font_italic" id="S1.p3.1.2">whole-word embedding</em>Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib12" title="">12</a>]</cite> to indicate whether consecutive sub-word tokens originate from the same entities (i.e., user/item).
Some studies use continuous embedding (i.e., soft indexing) learned from encoders to represent users&amp;items in LLM-based recommendationsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib14" title="">14</a>]</cite>.
Despite the success mentioned above, the majority of existing methods for users&amp;items tokenization for LLM-based recommender systems still have several limitations.
For example, the use of whole-word embedding cannot effectively capture high-order collaborative knowledge and generalize well to unseen users/items for recommendation.
In addition, due to the nature of discrete tokens in language models, using continuous indexing makes it challenging to align LLMs in recommender systems closely.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To address such challenges, we propose a novel LLM-based framework for recommender systems (<span class="ltx_text ltx_font_bold" id="S1.p4.1.1">TokenRec</span>), in which a novel tokenization strategy is proposed to tokenize numerical ID (i.e., identifiers) of users and items by seamlessly integrating high-order collaborative knowledge into LLMs.
Meanwhile, a generative retrieval paradigm is developed to generate item representations and retrieve appropriate items for collaborative recommendations.
Our major contributions are summarized as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We introduce a principle strategy named <span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">Masked Vector-Quantized Tokenizer</span> to tokenize users and items tailored to LLMs, which contributes to incorporating high-order collaborative knowledge in LLM-based recommendations.
More specifically, two novel mechanisms (i.e., masking and <math alttext="K" class="ltx_Math" display="inline" id="S1.I1.i1.p1.1.m1.1"><semantics id="S1.I1.i1.p1.1.m1.1a"><mi id="S1.I1.i1.p1.1.m1.1.1" xref="S1.I1.i1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.1.m1.1b"><ci id="S1.I1.i1.p1.1.m1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.1.m1.1d">italic_K</annotation></semantics></math>-way encoder) are designed to enhance the generalization capability of the proposed tokenization method in LLM-based recommendations.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose a novel framework (<span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">TokenRec</span>) for recommender systems in the era of LLMs, where a generative retrieval paradigm is designed to effectively and efficiently recommend top-<math alttext="K" class="ltx_Math" display="inline" id="S1.I1.i2.p1.1.m1.1"><semantics id="S1.I1.i2.p1.1.m1.1a"><mi id="S1.I1.i2.p1.1.m1.1.1" xref="S1.I1.i2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.1.m1.1b"><ci id="S1.I1.i2.p1.1.m1.1.1.cmml" xref="S1.I1.i2.p1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.1.m1.1d">italic_K</annotation></semantics></math> items for users rather than directly generating tokens in natural language.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We conduct extensive experiments on four widely used real-world datasets to empirically demonstrate the effectiveness of our proposed TokenRec, including the superior recommendation performance and its generalization ability in predicting new and unseen usersâ€™ preferences.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">The remainder of this paper is structured as follows.
Section <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2" title="II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">II</span></a> introduces the
proposed approach, which is evaluated in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3" title="III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">III</span></a>.
Then, Section <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S4" title="IV Related Work â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">IV</span></a> summarizes the recent development of collaborative filtering and LLM-based RecSys. Finally, conclusions are drawn in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S5" title="V Conclusion â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">V</span></a>.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">The Proposed Method</span>
</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">This section will begin by reformulating the collaborative recommendation as a language-processing task.
Then, we provide an overview of the proposed TokenRec, followed by a detailed explanation of each model component.
Finally, we will discuss the model training and inference of TokenRec.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS1.4.1.1">II-A</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS1.5.2">Notations and Definitions</span>
</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.11">Let <math alttext="\mathcal{U}=\{u_{1},u_{2},...,u_{n}\}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.4"><semantics id="S2.SS1.p1.1.m1.4a"><mrow id="S2.SS1.p1.1.m1.4.4" xref="S2.SS1.p1.1.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.1.m1.4.4.5" xref="S2.SS1.p1.1.m1.4.4.5.cmml">ğ’°</mi><mo id="S2.SS1.p1.1.m1.4.4.4" xref="S2.SS1.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S2.SS1.p1.1.m1.4.4.3.3" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml"><mo id="S2.SS1.p1.1.m1.4.4.3.3.4" stretchy="false" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml">{</mo><msub id="S2.SS1.p1.1.m1.2.2.1.1.1" xref="S2.SS1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.2.2.1.1.1.2" xref="S2.SS1.p1.1.m1.2.2.1.1.1.2.cmml">u</mi><mn id="S2.SS1.p1.1.m1.2.2.1.1.1.3" xref="S2.SS1.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.1.m1.4.4.3.3.5" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.1.m1.3.3.2.2.2" xref="S2.SS1.p1.1.m1.3.3.2.2.2.cmml"><mi id="S2.SS1.p1.1.m1.3.3.2.2.2.2" xref="S2.SS1.p1.1.m1.3.3.2.2.2.2.cmml">u</mi><mn id="S2.SS1.p1.1.m1.3.3.2.2.2.3" xref="S2.SS1.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.p1.1.m1.4.4.3.3.6" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><mi id="S2.SS1.p1.1.m1.1.1" mathvariant="normal" xref="S2.SS1.p1.1.m1.1.1.cmml">â€¦</mi><mo id="S2.SS1.p1.1.m1.4.4.3.3.7" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.1.m1.4.4.3.3.3" xref="S2.SS1.p1.1.m1.4.4.3.3.3.cmml"><mi id="S2.SS1.p1.1.m1.4.4.3.3.3.2" xref="S2.SS1.p1.1.m1.4.4.3.3.3.2.cmml">u</mi><mi id="S2.SS1.p1.1.m1.4.4.3.3.3.3" xref="S2.SS1.p1.1.m1.4.4.3.3.3.3.cmml">n</mi></msub><mo id="S2.SS1.p1.1.m1.4.4.3.3.8" stretchy="false" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.4b"><apply id="S2.SS1.p1.1.m1.4.4.cmml" xref="S2.SS1.p1.1.m1.4.4"><eq id="S2.SS1.p1.1.m1.4.4.4.cmml" xref="S2.SS1.p1.1.m1.4.4.4"></eq><ci id="S2.SS1.p1.1.m1.4.4.5.cmml" xref="S2.SS1.p1.1.m1.4.4.5">ğ’°</ci><set id="S2.SS1.p1.1.m1.4.4.3.4.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3"><apply id="S2.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="S2.SS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.2.2.1.1.1.2">ğ‘¢</ci><cn id="S2.SS1.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS1.p1.1.m1.3.3.2.2.2.cmml" xref="S2.SS1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS1.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS1.p1.1.m1.3.3.2.2.2.2">ğ‘¢</ci><cn id="S2.SS1.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS1.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">â€¦</ci><apply id="S2.SS1.p1.1.m1.4.4.3.3.3.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.4.4.3.3.3.1.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.1.m1.4.4.3.3.3.2.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3.3.2">ğ‘¢</ci><ci id="S2.SS1.p1.1.m1.4.4.3.3.3.3.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3.3.3">ğ‘›</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.4c">\mathcal{U}=\{u_{1},u_{2},...,u_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.4d">caligraphic_U = { italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , â€¦ , italic_u start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> and <math alttext="\mathcal{V}=\{v_{1},v_{2},...,v_{m}\}" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.4"><semantics id="S2.SS1.p1.2.m2.4a"><mrow id="S2.SS1.p1.2.m2.4.4" xref="S2.SS1.p1.2.m2.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.2.m2.4.4.5" xref="S2.SS1.p1.2.m2.4.4.5.cmml">ğ’±</mi><mo id="S2.SS1.p1.2.m2.4.4.4" xref="S2.SS1.p1.2.m2.4.4.4.cmml">=</mo><mrow id="S2.SS1.p1.2.m2.4.4.3.3" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml"><mo id="S2.SS1.p1.2.m2.4.4.3.3.4" stretchy="false" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml">{</mo><msub id="S2.SS1.p1.2.m2.2.2.1.1.1" xref="S2.SS1.p1.2.m2.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.2.m2.2.2.1.1.1.2" xref="S2.SS1.p1.2.m2.2.2.1.1.1.2.cmml">v</mi><mn id="S2.SS1.p1.2.m2.2.2.1.1.1.3" xref="S2.SS1.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.2.m2.4.4.3.3.5" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.2.m2.3.3.2.2.2" xref="S2.SS1.p1.2.m2.3.3.2.2.2.cmml"><mi id="S2.SS1.p1.2.m2.3.3.2.2.2.2" xref="S2.SS1.p1.2.m2.3.3.2.2.2.2.cmml">v</mi><mn id="S2.SS1.p1.2.m2.3.3.2.2.2.3" xref="S2.SS1.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.p1.2.m2.4.4.3.3.6" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><mi id="S2.SS1.p1.2.m2.1.1" mathvariant="normal" xref="S2.SS1.p1.2.m2.1.1.cmml">â€¦</mi><mo id="S2.SS1.p1.2.m2.4.4.3.3.7" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.2.m2.4.4.3.3.3" xref="S2.SS1.p1.2.m2.4.4.3.3.3.cmml"><mi id="S2.SS1.p1.2.m2.4.4.3.3.3.2" xref="S2.SS1.p1.2.m2.4.4.3.3.3.2.cmml">v</mi><mi id="S2.SS1.p1.2.m2.4.4.3.3.3.3" xref="S2.SS1.p1.2.m2.4.4.3.3.3.3.cmml">m</mi></msub><mo id="S2.SS1.p1.2.m2.4.4.3.3.8" stretchy="false" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.4b"><apply id="S2.SS1.p1.2.m2.4.4.cmml" xref="S2.SS1.p1.2.m2.4.4"><eq id="S2.SS1.p1.2.m2.4.4.4.cmml" xref="S2.SS1.p1.2.m2.4.4.4"></eq><ci id="S2.SS1.p1.2.m2.4.4.5.cmml" xref="S2.SS1.p1.2.m2.4.4.5">ğ’±</ci><set id="S2.SS1.p1.2.m2.4.4.3.4.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3"><apply id="S2.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.1.2">ğ‘£</ci><cn id="S2.SS1.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.3.3.2.2.2.1.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.2.2">ğ‘£</ci><cn id="S2.SS1.p1.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS1.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">â€¦</ci><apply id="S2.SS1.p1.2.m2.4.4.3.3.3.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.4.4.3.3.3.1.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.2.m2.4.4.3.3.3.2.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.3.2">ğ‘£</ci><ci id="S2.SS1.p1.2.m2.4.4.3.3.3.3.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.3.3">ğ‘š</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.4c">\mathcal{V}=\{v_{1},v_{2},...,v_{m}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.4d">caligraphic_V = { italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , â€¦ , italic_v start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT }</annotation></semantics></math> be the sets of users and items, respectively, where <math alttext="n" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">ğ‘›</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_n</annotation></semantics></math> is the number of users, and <math alttext="m" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><mi id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">ğ‘š</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">italic_m</annotation></semantics></math> is the number of items.
Moreover, we use <math alttext="\mathcal{N}_{(u_{i})}" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.1"><semantics id="S2.SS1.p1.5.m5.1a"><msub id="S2.SS1.p1.5.m5.1.2" xref="S2.SS1.p1.5.m5.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.5.m5.1.2.2" xref="S2.SS1.p1.5.m5.1.2.2.cmml">ğ’©</mi><mrow id="S2.SS1.p1.5.m5.1.1.1.1" xref="S2.SS1.p1.5.m5.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.5.m5.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.5.m5.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.p1.5.m5.1.1.1.1.1" xref="S2.SS1.p1.5.m5.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.5.m5.1.1.1.1.1.2" xref="S2.SS1.p1.5.m5.1.1.1.1.1.2.cmml">u</mi><mi id="S2.SS1.p1.5.m5.1.1.1.1.1.3" xref="S2.SS1.p1.5.m5.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS1.p1.5.m5.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><apply id="S2.SS1.p1.5.m5.1.2.cmml" xref="S2.SS1.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.1.2.1.cmml" xref="S2.SS1.p1.5.m5.1.2">subscript</csymbol><ci id="S2.SS1.p1.5.m5.1.2.2.cmml" xref="S2.SS1.p1.5.m5.1.2.2">ğ’©</ci><apply id="S2.SS1.p1.5.m5.1.1.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.5.m5.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.5.m5.1.1.1.1.1.2">ğ‘¢</ci><ci id="S2.SS1.p1.5.m5.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.5.m5.1.1.1.1.1.3">ğ‘–</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">\mathcal{N}_{(u_{i})}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.1d">caligraphic_N start_POSTSUBSCRIPT ( italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT</annotation></semantics></math> to denote the item set that user <math alttext="u_{i}" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.1"><semantics id="S2.SS1.p1.6.m6.1a"><msub id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mi id="S2.SS1.p1.6.m6.1.1.2" xref="S2.SS1.p1.6.m6.1.1.2.cmml">u</mi><mi id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2">ğ‘¢</ci><ci id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> has interacted in the history.
As the traditional collaborative filtering methods, user <math alttext="u_{i}" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m7.1"><semantics id="S2.SS1.p1.7.m7.1a"><msub id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml"><mi id="S2.SS1.p1.7.m7.1.1.2" xref="S2.SS1.p1.7.m7.1.1.2.cmml">u</mi><mi id="S2.SS1.p1.7.m7.1.1.3" xref="S2.SS1.p1.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><apply id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.1.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S2.SS1.p1.7.m7.1.1.2.cmml" xref="S2.SS1.p1.7.m7.1.1.2">ğ‘¢</ci><ci id="S2.SS1.p1.7.m7.1.1.3.cmml" xref="S2.SS1.p1.7.m7.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m7.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and item <math alttext="v_{j}" class="ltx_Math" display="inline" id="S2.SS1.p1.8.m8.1"><semantics id="S2.SS1.p1.8.m8.1a"><msub id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml"><mi id="S2.SS1.p1.8.m8.1.1.2" xref="S2.SS1.p1.8.m8.1.1.2.cmml">v</mi><mi id="S2.SS1.p1.8.m8.1.1.3" xref="S2.SS1.p1.8.m8.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><apply id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m8.1.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S2.SS1.p1.8.m8.1.1.2.cmml" xref="S2.SS1.p1.8.m8.1.1.2">ğ‘£</ci><ci id="S2.SS1.p1.8.m8.1.1.3.cmml" xref="S2.SS1.p1.8.m8.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.8.m8.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> can be embedded into low-dimensional latent vectors (i.e., collaborative representations of users and items) <math alttext="\mathbf{p}_{i}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S2.SS1.p1.9.m9.1"><semantics id="S2.SS1.p1.9.m9.1a"><mrow id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml"><msub id="S2.SS1.p1.9.m9.1.1.2" xref="S2.SS1.p1.9.m9.1.1.2.cmml"><mi id="S2.SS1.p1.9.m9.1.1.2.2" xref="S2.SS1.p1.9.m9.1.1.2.2.cmml">ğ©</mi><mi id="S2.SS1.p1.9.m9.1.1.2.3" xref="S2.SS1.p1.9.m9.1.1.2.3.cmml">i</mi></msub><mo id="S2.SS1.p1.9.m9.1.1.1" xref="S2.SS1.p1.9.m9.1.1.1.cmml">âˆˆ</mo><msup id="S2.SS1.p1.9.m9.1.1.3" xref="S2.SS1.p1.9.m9.1.1.3.cmml"><mi id="S2.SS1.p1.9.m9.1.1.3.2" xref="S2.SS1.p1.9.m9.1.1.3.2.cmml">â„</mi><mi id="S2.SS1.p1.9.m9.1.1.3.3" xref="S2.SS1.p1.9.m9.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><apply id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1"><in id="S2.SS1.p1.9.m9.1.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1.1"></in><apply id="S2.SS1.p1.9.m9.1.1.2.cmml" xref="S2.SS1.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.1.1.2.1.cmml" xref="S2.SS1.p1.9.m9.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.9.m9.1.1.2.2.cmml" xref="S2.SS1.p1.9.m9.1.1.2.2">ğ©</ci><ci id="S2.SS1.p1.9.m9.1.1.2.3.cmml" xref="S2.SS1.p1.9.m9.1.1.2.3">ğ‘–</ci></apply><apply id="S2.SS1.p1.9.m9.1.1.3.cmml" xref="S2.SS1.p1.9.m9.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.1.1.3.1.cmml" xref="S2.SS1.p1.9.m9.1.1.3">superscript</csymbol><ci id="S2.SS1.p1.9.m9.1.1.3.2.cmml" xref="S2.SS1.p1.9.m9.1.1.3.2">â„</ci><ci id="S2.SS1.p1.9.m9.1.1.3.3.cmml" xref="S2.SS1.p1.9.m9.1.1.3.3">ğ‘‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">\mathbf{p}_{i}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.9.m9.1d">bold_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{q}_{j}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S2.SS1.p1.10.m10.1"><semantics id="S2.SS1.p1.10.m10.1a"><mrow id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml"><msub id="S2.SS1.p1.10.m10.1.1.2" xref="S2.SS1.p1.10.m10.1.1.2.cmml"><mi id="S2.SS1.p1.10.m10.1.1.2.2" xref="S2.SS1.p1.10.m10.1.1.2.2.cmml">ğª</mi><mi id="S2.SS1.p1.10.m10.1.1.2.3" xref="S2.SS1.p1.10.m10.1.1.2.3.cmml">j</mi></msub><mo id="S2.SS1.p1.10.m10.1.1.1" xref="S2.SS1.p1.10.m10.1.1.1.cmml">âˆˆ</mo><msup id="S2.SS1.p1.10.m10.1.1.3" xref="S2.SS1.p1.10.m10.1.1.3.cmml"><mi id="S2.SS1.p1.10.m10.1.1.3.2" xref="S2.SS1.p1.10.m10.1.1.3.2.cmml">â„</mi><mi id="S2.SS1.p1.10.m10.1.1.3.3" xref="S2.SS1.p1.10.m10.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><apply id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1"><in id="S2.SS1.p1.10.m10.1.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1.1"></in><apply id="S2.SS1.p1.10.m10.1.1.2.cmml" xref="S2.SS1.p1.10.m10.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.2.1.cmml" xref="S2.SS1.p1.10.m10.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.10.m10.1.1.2.2.cmml" xref="S2.SS1.p1.10.m10.1.1.2.2">ğª</ci><ci id="S2.SS1.p1.10.m10.1.1.2.3.cmml" xref="S2.SS1.p1.10.m10.1.1.2.3">ğ‘—</ci></apply><apply id="S2.SS1.p1.10.m10.1.1.3.cmml" xref="S2.SS1.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.3.1.cmml" xref="S2.SS1.p1.10.m10.1.1.3">superscript</csymbol><ci id="S2.SS1.p1.10.m10.1.1.3.2.cmml" xref="S2.SS1.p1.10.m10.1.1.3.2">â„</ci><ci id="S2.SS1.p1.10.m10.1.1.3.3.cmml" xref="S2.SS1.p1.10.m10.1.1.3.3">ğ‘‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">\mathbf{q}_{j}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.10.m10.1d">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> respectively, where <math alttext="d" class="ltx_Math" display="inline" id="S2.SS1.p1.11.m11.1"><semantics id="S2.SS1.p1.11.m11.1a"><mi id="S2.SS1.p1.11.m11.1.1" xref="S2.SS1.p1.11.m11.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.1b"><ci id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1">ğ‘‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.11.m11.1d">italic_d</annotation></semantics></math> is the length of the vector.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.9">In general, the goal of a recommender system is to understand usersâ€™ preferences by modeling interactions (e.g., clicks and bought) between users <math alttext="\mathcal{U}=\{u_{1},u_{2},...,u_{n}\}" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.4"><semantics id="S2.SS1.p2.1.m1.4a"><mrow id="S2.SS1.p2.1.m1.4.4" xref="S2.SS1.p2.1.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.1.m1.4.4.5" xref="S2.SS1.p2.1.m1.4.4.5.cmml">ğ’°</mi><mo id="S2.SS1.p2.1.m1.4.4.4" xref="S2.SS1.p2.1.m1.4.4.4.cmml">=</mo><mrow id="S2.SS1.p2.1.m1.4.4.3.3" xref="S2.SS1.p2.1.m1.4.4.3.4.cmml"><mo id="S2.SS1.p2.1.m1.4.4.3.3.4" stretchy="false" xref="S2.SS1.p2.1.m1.4.4.3.4.cmml">{</mo><msub id="S2.SS1.p2.1.m1.2.2.1.1.1" xref="S2.SS1.p2.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS1.p2.1.m1.2.2.1.1.1.2" xref="S2.SS1.p2.1.m1.2.2.1.1.1.2.cmml">u</mi><mn id="S2.SS1.p2.1.m1.2.2.1.1.1.3" xref="S2.SS1.p2.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p2.1.m1.4.4.3.3.5" xref="S2.SS1.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p2.1.m1.3.3.2.2.2" xref="S2.SS1.p2.1.m1.3.3.2.2.2.cmml"><mi id="S2.SS1.p2.1.m1.3.3.2.2.2.2" xref="S2.SS1.p2.1.m1.3.3.2.2.2.2.cmml">u</mi><mn id="S2.SS1.p2.1.m1.3.3.2.2.2.3" xref="S2.SS1.p2.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.p2.1.m1.4.4.3.3.6" xref="S2.SS1.p2.1.m1.4.4.3.4.cmml">,</mo><mi id="S2.SS1.p2.1.m1.1.1" mathvariant="normal" xref="S2.SS1.p2.1.m1.1.1.cmml">â€¦</mi><mo id="S2.SS1.p2.1.m1.4.4.3.3.7" xref="S2.SS1.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p2.1.m1.4.4.3.3.3" xref="S2.SS1.p2.1.m1.4.4.3.3.3.cmml"><mi id="S2.SS1.p2.1.m1.4.4.3.3.3.2" xref="S2.SS1.p2.1.m1.4.4.3.3.3.2.cmml">u</mi><mi id="S2.SS1.p2.1.m1.4.4.3.3.3.3" xref="S2.SS1.p2.1.m1.4.4.3.3.3.3.cmml">n</mi></msub><mo id="S2.SS1.p2.1.m1.4.4.3.3.8" stretchy="false" xref="S2.SS1.p2.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.4b"><apply id="S2.SS1.p2.1.m1.4.4.cmml" xref="S2.SS1.p2.1.m1.4.4"><eq id="S2.SS1.p2.1.m1.4.4.4.cmml" xref="S2.SS1.p2.1.m1.4.4.4"></eq><ci id="S2.SS1.p2.1.m1.4.4.5.cmml" xref="S2.SS1.p2.1.m1.4.4.5">ğ’°</ci><set id="S2.SS1.p2.1.m1.4.4.3.4.cmml" xref="S2.SS1.p2.1.m1.4.4.3.3"><apply id="S2.SS1.p2.1.m1.2.2.1.1.1.cmml" xref="S2.SS1.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.2.2.1.1.1.2">ğ‘¢</ci><cn id="S2.SS1.p2.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS1.p2.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS1.p2.1.m1.3.3.2.2.2.cmml" xref="S2.SS1.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS1.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p2.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS1.p2.1.m1.3.3.2.2.2.2">ğ‘¢</ci><cn id="S2.SS1.p2.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS1.p2.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">â€¦</ci><apply id="S2.SS1.p2.1.m1.4.4.3.3.3.cmml" xref="S2.SS1.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.4.4.3.3.3.1.cmml" xref="S2.SS1.p2.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S2.SS1.p2.1.m1.4.4.3.3.3.2.cmml" xref="S2.SS1.p2.1.m1.4.4.3.3.3.2">ğ‘¢</ci><ci id="S2.SS1.p2.1.m1.4.4.3.3.3.3.cmml" xref="S2.SS1.p2.1.m1.4.4.3.3.3.3">ğ‘›</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.4c">\mathcal{U}=\{u_{1},u_{2},...,u_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.4d">caligraphic_U = { italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , â€¦ , italic_u start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> and items <math alttext="\mathcal{V}=\{v_{1},v_{2},...,v_{m}\}" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.4"><semantics id="S2.SS1.p2.2.m2.4a"><mrow id="S2.SS1.p2.2.m2.4.4" xref="S2.SS1.p2.2.m2.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.2.m2.4.4.5" xref="S2.SS1.p2.2.m2.4.4.5.cmml">ğ’±</mi><mo id="S2.SS1.p2.2.m2.4.4.4" xref="S2.SS1.p2.2.m2.4.4.4.cmml">=</mo><mrow id="S2.SS1.p2.2.m2.4.4.3.3" xref="S2.SS1.p2.2.m2.4.4.3.4.cmml"><mo id="S2.SS1.p2.2.m2.4.4.3.3.4" stretchy="false" xref="S2.SS1.p2.2.m2.4.4.3.4.cmml">{</mo><msub id="S2.SS1.p2.2.m2.2.2.1.1.1" xref="S2.SS1.p2.2.m2.2.2.1.1.1.cmml"><mi id="S2.SS1.p2.2.m2.2.2.1.1.1.2" xref="S2.SS1.p2.2.m2.2.2.1.1.1.2.cmml">v</mi><mn id="S2.SS1.p2.2.m2.2.2.1.1.1.3" xref="S2.SS1.p2.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p2.2.m2.4.4.3.3.5" xref="S2.SS1.p2.2.m2.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p2.2.m2.3.3.2.2.2" xref="S2.SS1.p2.2.m2.3.3.2.2.2.cmml"><mi id="S2.SS1.p2.2.m2.3.3.2.2.2.2" xref="S2.SS1.p2.2.m2.3.3.2.2.2.2.cmml">v</mi><mn id="S2.SS1.p2.2.m2.3.3.2.2.2.3" xref="S2.SS1.p2.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.p2.2.m2.4.4.3.3.6" xref="S2.SS1.p2.2.m2.4.4.3.4.cmml">,</mo><mi id="S2.SS1.p2.2.m2.1.1" mathvariant="normal" xref="S2.SS1.p2.2.m2.1.1.cmml">â€¦</mi><mo id="S2.SS1.p2.2.m2.4.4.3.3.7" xref="S2.SS1.p2.2.m2.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p2.2.m2.4.4.3.3.3" xref="S2.SS1.p2.2.m2.4.4.3.3.3.cmml"><mi id="S2.SS1.p2.2.m2.4.4.3.3.3.2" xref="S2.SS1.p2.2.m2.4.4.3.3.3.2.cmml">v</mi><mi id="S2.SS1.p2.2.m2.4.4.3.3.3.3" xref="S2.SS1.p2.2.m2.4.4.3.3.3.3.cmml">m</mi></msub><mo id="S2.SS1.p2.2.m2.4.4.3.3.8" stretchy="false" xref="S2.SS1.p2.2.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.4b"><apply id="S2.SS1.p2.2.m2.4.4.cmml" xref="S2.SS1.p2.2.m2.4.4"><eq id="S2.SS1.p2.2.m2.4.4.4.cmml" xref="S2.SS1.p2.2.m2.4.4.4"></eq><ci id="S2.SS1.p2.2.m2.4.4.5.cmml" xref="S2.SS1.p2.2.m2.4.4.5">ğ’±</ci><set id="S2.SS1.p2.2.m2.4.4.3.4.cmml" xref="S2.SS1.p2.2.m2.4.4.3.3"><apply id="S2.SS1.p2.2.m2.2.2.1.1.1.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.2.m2.2.2.1.1.1.2.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1.1.2">ğ‘£</ci><cn id="S2.SS1.p2.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS1.p2.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS1.p2.2.m2.3.3.2.2.2.cmml" xref="S2.SS1.p2.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.3.3.2.2.2.1.cmml" xref="S2.SS1.p2.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p2.2.m2.3.3.2.2.2.2.cmml" xref="S2.SS1.p2.2.m2.3.3.2.2.2.2">ğ‘£</ci><cn id="S2.SS1.p2.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS1.p2.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">â€¦</ci><apply id="S2.SS1.p2.2.m2.4.4.3.3.3.cmml" xref="S2.SS1.p2.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.4.4.3.3.3.1.cmml" xref="S2.SS1.p2.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S2.SS1.p2.2.m2.4.4.3.3.3.2.cmml" xref="S2.SS1.p2.2.m2.4.4.3.3.3.2">ğ‘£</ci><ci id="S2.SS1.p2.2.m2.4.4.3.3.3.3.cmml" xref="S2.SS1.p2.2.m2.4.4.3.3.3.3">ğ‘š</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.4c">\mathcal{V}=\{v_{1},v_{2},...,v_{m}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.4d">caligraphic_V = { italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , â€¦ , italic_v start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT }</annotation></semantics></math>.
As a widely used solution, collaborative filtering (CF) techniques are developed to learn user and item representations from historical user-item interactions.
Thus, we reformulate the CF recommendation in the language model paradigm.
Assume that we only have token IDs <math alttext="\mathcal{T}_{i}" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m3.1"><semantics id="S2.SS1.p2.3.m3.1a"><msub id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.3.m3.1.1.2" xref="S2.SS1.p2.3.m3.1.1.2.cmml">ğ’¯</mi><mi id="S2.SS1.p2.3.m3.1.1.3" xref="S2.SS1.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><apply id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.1.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p2.3.m3.1.1.2.cmml" xref="S2.SS1.p2.3.m3.1.1.2">ğ’¯</ci><ci id="S2.SS1.p2.3.m3.1.1.3.cmml" xref="S2.SS1.p2.3.m3.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">\mathcal{T}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.1d">caligraphic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{T}_{j}" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m4.1"><semantics id="S2.SS1.p2.4.m4.1a"><msub id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.4.m4.1.1.2" xref="S2.SS1.p2.4.m4.1.1.2.cmml">ğ’¯</mi><mi id="S2.SS1.p2.4.m4.1.1.3" xref="S2.SS1.p2.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><apply id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p2.4.m4.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.2">ğ’¯</ci><ci id="S2.SS1.p2.4.m4.1.1.3.cmml" xref="S2.SS1.p2.4.m4.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">\mathcal{T}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m4.1d">caligraphic_T start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> for each user <math alttext="u_{i}" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m5.1"><semantics id="S2.SS1.p2.5.m5.1a"><msub id="S2.SS1.p2.5.m5.1.1" xref="S2.SS1.p2.5.m5.1.1.cmml"><mi id="S2.SS1.p2.5.m5.1.1.2" xref="S2.SS1.p2.5.m5.1.1.2.cmml">u</mi><mi id="S2.SS1.p2.5.m5.1.1.3" xref="S2.SS1.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.1b"><apply id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.1.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p2.5.m5.1.1.2.cmml" xref="S2.SS1.p2.5.m5.1.1.2">ğ‘¢</ci><ci id="S2.SS1.p2.5.m5.1.1.3.cmml" xref="S2.SS1.p2.5.m5.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m5.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and item <math alttext="v_{j}" class="ltx_Math" display="inline" id="S2.SS1.p2.6.m6.1"><semantics id="S2.SS1.p2.6.m6.1a"><msub id="S2.SS1.p2.6.m6.1.1" xref="S2.SS1.p2.6.m6.1.1.cmml"><mi id="S2.SS1.p2.6.m6.1.1.2" xref="S2.SS1.p2.6.m6.1.1.2.cmml">v</mi><mi id="S2.SS1.p2.6.m6.1.1.3" xref="S2.SS1.p2.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m6.1b"><apply id="S2.SS1.p2.6.m6.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m6.1.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p2.6.m6.1.1.2.cmml" xref="S2.SS1.p2.6.m6.1.1.2">ğ‘£</ci><ci id="S2.SS1.p2.6.m6.1.1.3.cmml" xref="S2.SS1.p2.6.m6.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m6.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.6.m6.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.
By integrating these IDs into textual prompts <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S2.SS1.p2.7.m7.1"><semantics id="S2.SS1.p2.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.7.m7.1.1" xref="S2.SS1.p2.7.m7.1.1.cmml">ğ’«</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m7.1b"><ci id="S2.SS1.p2.7.m7.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1">ğ’«</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m7.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.7.m7.1d">caligraphic_P</annotation></semantics></math>, LLM generates the representation <math alttext="\mathbf{z}_{i}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S2.SS1.p2.8.m8.1"><semantics id="S2.SS1.p2.8.m8.1a"><mrow id="S2.SS1.p2.8.m8.1.1" xref="S2.SS1.p2.8.m8.1.1.cmml"><msub id="S2.SS1.p2.8.m8.1.1.2" xref="S2.SS1.p2.8.m8.1.1.2.cmml"><mi id="S2.SS1.p2.8.m8.1.1.2.2" xref="S2.SS1.p2.8.m8.1.1.2.2.cmml">ğ³</mi><mi id="S2.SS1.p2.8.m8.1.1.2.3" xref="S2.SS1.p2.8.m8.1.1.2.3.cmml">i</mi></msub><mo id="S2.SS1.p2.8.m8.1.1.1" xref="S2.SS1.p2.8.m8.1.1.1.cmml">âˆˆ</mo><msup id="S2.SS1.p2.8.m8.1.1.3" xref="S2.SS1.p2.8.m8.1.1.3.cmml"><mi id="S2.SS1.p2.8.m8.1.1.3.2" xref="S2.SS1.p2.8.m8.1.1.3.2.cmml">â„</mi><mi id="S2.SS1.p2.8.m8.1.1.3.3" xref="S2.SS1.p2.8.m8.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.8.m8.1b"><apply id="S2.SS1.p2.8.m8.1.1.cmml" xref="S2.SS1.p2.8.m8.1.1"><in id="S2.SS1.p2.8.m8.1.1.1.cmml" xref="S2.SS1.p2.8.m8.1.1.1"></in><apply id="S2.SS1.p2.8.m8.1.1.2.cmml" xref="S2.SS1.p2.8.m8.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p2.8.m8.1.1.2.1.cmml" xref="S2.SS1.p2.8.m8.1.1.2">subscript</csymbol><ci id="S2.SS1.p2.8.m8.1.1.2.2.cmml" xref="S2.SS1.p2.8.m8.1.1.2.2">ğ³</ci><ci id="S2.SS1.p2.8.m8.1.1.2.3.cmml" xref="S2.SS1.p2.8.m8.1.1.2.3">ğ‘–</ci></apply><apply id="S2.SS1.p2.8.m8.1.1.3.cmml" xref="S2.SS1.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.8.m8.1.1.3.1.cmml" xref="S2.SS1.p2.8.m8.1.1.3">superscript</csymbol><ci id="S2.SS1.p2.8.m8.1.1.3.2.cmml" xref="S2.SS1.p2.8.m8.1.1.3.2">â„</ci><ci id="S2.SS1.p2.8.m8.1.1.3.3.cmml" xref="S2.SS1.p2.8.m8.1.1.3.3">ğ‘‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.8.m8.1c">\mathbf{z}_{i}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.8.m8.1d">bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> of items that a user <math alttext="u_{i}" class="ltx_Math" display="inline" id="S2.SS1.p2.9.m9.1"><semantics id="S2.SS1.p2.9.m9.1a"><msub id="S2.SS1.p2.9.m9.1.1" xref="S2.SS1.p2.9.m9.1.1.cmml"><mi id="S2.SS1.p2.9.m9.1.1.2" xref="S2.SS1.p2.9.m9.1.1.2.cmml">u</mi><mi id="S2.SS1.p2.9.m9.1.1.3" xref="S2.SS1.p2.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.9.m9.1b"><apply id="S2.SS1.p2.9.m9.1.1.cmml" xref="S2.SS1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.9.m9.1.1.1.cmml" xref="S2.SS1.p2.9.m9.1.1">subscript</csymbol><ci id="S2.SS1.p2.9.m9.1.1.2.cmml" xref="S2.SS1.p2.9.m9.1.1.2">ğ‘¢</ci><ci id="S2.SS1.p2.9.m9.1.1.3.cmml" xref="S2.SS1.p2.9.m9.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.9.m9.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.9.m9.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> may like, expressed as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx1">
<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{z}_{i}={\rm LLM}(\mathcal{P},\mathcal{T}_{i},\{\mathcal{T%
}_{j}|v_{j}\in\mathcal{N}_{(u_{i})}\})." class="ltx_Math" display="inline" id="S2.E1.m1.3"><semantics id="S2.E1.m1.3a"><mrow id="S2.E1.m1.3.3.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml"><msub id="S2.E1.m1.3.3.1.1.4" xref="S2.E1.m1.3.3.1.1.4.cmml"><mi id="S2.E1.m1.3.3.1.1.4.2" xref="S2.E1.m1.3.3.1.1.4.2.cmml">ğ³</mi><mi id="S2.E1.m1.3.3.1.1.4.3" xref="S2.E1.m1.3.3.1.1.4.3.cmml">i</mi></msub><mo id="S2.E1.m1.3.3.1.1.3" xref="S2.E1.m1.3.3.1.1.3.cmml">=</mo><mrow id="S2.E1.m1.3.3.1.1.2" xref="S2.E1.m1.3.3.1.1.2.cmml"><mi id="S2.E1.m1.3.3.1.1.2.4" xref="S2.E1.m1.3.3.1.1.2.4.cmml">LLM</mi><mo id="S2.E1.m1.3.3.1.1.2.3" xref="S2.E1.m1.3.3.1.1.2.3.cmml">â¢</mo><mrow id="S2.E1.m1.3.3.1.1.2.2.2" xref="S2.E1.m1.3.3.1.1.2.2.3.cmml"><mo id="S2.E1.m1.3.3.1.1.2.2.2.3" stretchy="false" xref="S2.E1.m1.3.3.1.1.2.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">ğ’«</mi><mo id="S2.E1.m1.3.3.1.1.2.2.2.4" xref="S2.E1.m1.3.3.1.1.2.2.3.cmml">,</mo><msub id="S2.E1.m1.3.3.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.3.3.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml">ğ’¯</mi><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E1.m1.3.3.1.1.2.2.2.5" xref="S2.E1.m1.3.3.1.1.2.2.3.cmml">,</mo><mrow id="S2.E1.m1.3.3.1.1.2.2.2.2.2" xref="S2.E1.m1.3.3.1.1.2.2.2.2.3.cmml"><mo id="S2.E1.m1.3.3.1.1.2.2.2.2.2.3" stretchy="false" xref="S2.E1.m1.3.3.1.1.2.2.2.2.3.1.cmml">{</mo><msub id="S2.E1.m1.3.3.1.1.2.2.2.2.1.1" xref="S2.E1.m1.3.3.1.1.2.2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.3.3.1.1.2.2.2.2.1.1.2" xref="S2.E1.m1.3.3.1.1.2.2.2.2.1.1.2.cmml">ğ’¯</mi><mi id="S2.E1.m1.3.3.1.1.2.2.2.2.1.1.3" xref="S2.E1.m1.3.3.1.1.2.2.2.2.1.1.3.cmml">j</mi></msub><mo id="S2.E1.m1.3.3.1.1.2.2.2.2.2.4" lspace="0em" rspace="0em" xref="S2.E1.m1.3.3.1.1.2.2.2.2.3.1.cmml">|</mo><mrow id="S2.E1.m1.3.3.1.1.2.2.2.2.2.2" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.cmml"><msub id="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.2" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.2.cmml"><mi id="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.2.2" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.2.2.cmml">v</mi><mi id="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.2.3" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.1" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.1.cmml">âˆˆ</mo><msub id="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.3" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.3.2" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.3.2.cmml">ğ’©</mi><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.cmml">(</mo><msub id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.2.cmml">u</mi><mi id="S2.E1.m1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E1.m1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.cmml">)</mo></mrow></msub></mrow><mo id="S2.E1.m1.3.3.1.1.2.2.2.2.2.5" stretchy="false" xref="S2.E1.m1.3.3.1.1.2.2.2.2.3.1.cmml">}</mo></mrow><mo id="S2.E1.m1.3.3.1.1.2.2.2.6" stretchy="false" xref="S2.E1.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.2" lspace="0em" xref="S2.E1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b"><apply id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1"><eq id="S2.E1.m1.3.3.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3"></eq><apply id="S2.E1.m1.3.3.1.1.4.cmml" xref="S2.E1.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.4.1.cmml" xref="S2.E1.m1.3.3.1.1.4">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.4.2.cmml" xref="S2.E1.m1.3.3.1.1.4.2">ğ³</ci><ci id="S2.E1.m1.3.3.1.1.4.3.cmml" xref="S2.E1.m1.3.3.1.1.4.3">ğ‘–</ci></apply><apply id="S2.E1.m1.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2"><times id="S2.E1.m1.3.3.1.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.3"></times><ci id="S2.E1.m1.3.3.1.1.2.4.cmml" xref="S2.E1.m1.3.3.1.1.2.4">LLM</ci><vector id="S2.E1.m1.3.3.1.1.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2"><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">ğ’«</ci><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2">ğ’¯</ci><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="S2.E1.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2"><csymbol cd="latexml" id="S2.E1.m1.3.3.1.1.2.2.2.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.3">conditional-set</csymbol><apply id="S2.E1.m1.3.3.1.1.2.2.2.2.1.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.2.2.2.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.1.1">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.2.2.2.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.1.1.2">ğ’¯</ci><ci id="S2.E1.m1.3.3.1.1.2.2.2.2.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.1.1.3">ğ‘—</ci></apply><apply id="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.2"><in id="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.1"></in><apply id="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.2.2">ğ‘£</ci><ci id="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.2.3">ğ‘—</ci></apply><apply id="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.3">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.3.2">ğ’©</ci><apply id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2">ğ‘¢</ci><ci id="S2.E1.m1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.3">ğ‘–</ci></apply></apply></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.3c">\displaystyle\mathbf{z}_{i}={\rm LLM}(\mathcal{P},\mathcal{T}_{i},\{\mathcal{T%
}_{j}|v_{j}\in\mathcal{N}_{(u_{i})}\}).</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.3d">bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = roman_LLM ( caligraphic_P , caligraphic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , { caligraphic_T start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT âˆˆ caligraphic_N start_POSTSUBSCRIPT ( italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT } ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p2.10">Notably, the interacted items <math alttext="\mathcal{N}_{(u_{i})}" class="ltx_Math" display="inline" id="S2.SS1.p2.10.m1.1"><semantics id="S2.SS1.p2.10.m1.1a"><msub id="S2.SS1.p2.10.m1.1.2" xref="S2.SS1.p2.10.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.10.m1.1.2.2" xref="S2.SS1.p2.10.m1.1.2.2.cmml">ğ’©</mi><mrow id="S2.SS1.p2.10.m1.1.1.1.1" xref="S2.SS1.p2.10.m1.1.1.1.1.1.cmml"><mo id="S2.SS1.p2.10.m1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p2.10.m1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.p2.10.m1.1.1.1.1.1" xref="S2.SS1.p2.10.m1.1.1.1.1.1.cmml"><mi id="S2.SS1.p2.10.m1.1.1.1.1.1.2" xref="S2.SS1.p2.10.m1.1.1.1.1.1.2.cmml">u</mi><mi id="S2.SS1.p2.10.m1.1.1.1.1.1.3" xref="S2.SS1.p2.10.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS1.p2.10.m1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p2.10.m1.1.1.1.1.1.cmml">)</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.10.m1.1b"><apply id="S2.SS1.p2.10.m1.1.2.cmml" xref="S2.SS1.p2.10.m1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p2.10.m1.1.2.1.cmml" xref="S2.SS1.p2.10.m1.1.2">subscript</csymbol><ci id="S2.SS1.p2.10.m1.1.2.2.cmml" xref="S2.SS1.p2.10.m1.1.2.2">ğ’©</ci><apply id="S2.SS1.p2.10.m1.1.1.1.1.1.cmml" xref="S2.SS1.p2.10.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.10.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.10.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.10.m1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.10.m1.1.1.1.1.1.2">ğ‘¢</ci><ci id="S2.SS1.p2.10.m1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.10.m1.1.1.1.1.1.3">ğ‘–</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.10.m1.1c">\mathcal{N}_{(u_{i})}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.10.m1.1d">caligraphic_N start_POSTSUBSCRIPT ( italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT</annotation></semantics></math> will be placed into the language model in a <em class="ltx_emph ltx_font_italic" id="S2.SS1.p2.10.1">non-sequential way</em> to accommodate the setting of collaborative filtering.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS2.4.1.1">II-B</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS2.5.2">An Overview of the Proposed Framework</span>
</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.2">To better align natural language with recommendation tasks, we propose a novel LLM-based generative recommendation framework (TokenRec).
As shown in FigureÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.F2" title="Figure 2 â€£ II-B An Overview of the Proposed Framework â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">2</span></a>, the proposed framework consists of two key modules, namely <span class="ltx_text ltx_font_bold" id="S2.SS2.p1.2.1">Masked Vector-Quantized (MQ) Tokenizer for Users and Items</span> and <span class="ltx_text ltx_font_bold" id="S2.SS2.p1.2.2">Generative Retrieval for Recommendations</span>.
The first module aims to address the fundamental task of ID tokenization in LLM-based recommendations so as to seamlessly integrate users&amp;items (i.e., numeric ID) into natural language form.
However, tokenizing users&amp;items faces tremendous challenges due to the huge number of users and items in recommender systems.
To address the emerging challenges, we introduce a Masked Vector-Quantized Tokenizer (MQ-Tokenizer) to learn specific codebooks and represent users&amp;items with a list of special tokens through encoder and decoder networks.
The goal of the second module is to perform user modeling via LLM for personalized recommendations.
To achieve this, a generative retrieval paradigm is introduced to retrieve the <math alttext="K" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_K</annotation></semantics></math>-nearest items from the whole item set for generating a personalized top-<math alttext="K" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">italic_K</annotation></semantics></math> recommendation list in an effective and efficient manner.
The details of the proposed method, TokenRec, will be described in the following sections.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="339" id="S2.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The overall framework of the proposed TokenRec,
which consists of the masked vector-quantized tokenizer with a <math alttext="K" class="ltx_Math" display="inline" id="S2.F2.2.m1.1"><semantics id="S2.F2.2.m1.1b"><mi id="S2.F2.2.m1.1.1" xref="S2.F2.2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.F2.2.m1.1c"><ci id="S2.F2.2.m1.1.1.cmml" xref="S2.F2.2.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.2.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="S2.F2.2.m1.1e">italic_K</annotation></semantics></math>-way encoder for item ID tokenization and the generative retrieval paradigm for recommendation generation. Note that we detail the item MQ-Tokenizer while omitting the user MQ-Tokenizer for simplicity.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS3.4.1.1">II-C</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS3.5.2">Masked Vector-Quantized Tokenizers for Users and Items</span>
</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Instead of assigning each user and item with a specific token (causing a significant increase in vocabulary size), we propose a novel strategy to tokenize users and items to align with natural language, where quantization techniques are developed to represent each user and item with certain discrete indices (i.e., tokens).
More specifically, as one of the most representative quantization techniques, Vector Quantization (VQ) aims to convert inputs into a set of discrete tokens (i.e., codes) and learn a discrete latent representation space (i.e., codebook) by reconstructing the original inputsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib17" title="">17</a>]</cite>.
Moreover, in order to capture <em class="ltx_emph ltx_font_italic" id="S2.SS3.p1.1.1">high-order collaborative knowledge</em> from usersâ€™ interaction history, we propose to conduct the vector quantization on the well-trained representations learned from advanced GNN-based recommendations.
However, naively applying vector quantization to index/tokenize users and items is fraught with critical challenges due to poor generalization capability.
For example, certain noise and propagation errors in the cascade process of user and item tokenizations in the LLMs greatly hinder the expressiveness of the vanilla VQ.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.4">To tackle these challenges, we propose a Masked Vector-Quantized Tokenizer (<span class="ltx_text ltx_font_bold" id="S2.SS3.p2.4.1">MQ-Tokenizer</span>) for tokenizing users and item IDs, where two novel strategies, namely masking and <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.p2.1.m1.1"><semantics id="S2.SS3.p2.1.m1.1a"><mi id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><ci id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.1.m1.1d">italic_K</annotation></semantics></math>-way encoding, are designed to enhance the generalization capability of our proposed tokenization in LLM-based recommendations.
More specifically, the proposed MQ-Tokenizer consists of a masking operation on the inputs (i.e., users&amp;items representations), a <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.p2.2.m2.1"><semantics id="S2.SS3.p2.2.m2.1a"><mi id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b"><ci id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.2.m2.1d">italic_K</annotation></semantics></math>-way encoder for multi-head feature extraction with a corresponding <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.p2.3.m3.1"><semantics id="S2.SS3.p2.3.m3.1a"><mi id="S2.SS3.p2.3.m3.1.1" xref="S2.SS3.p2.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.1b"><ci id="S2.SS3.p2.3.m3.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.3.m3.1d">italic_K</annotation></semantics></math>-way codebook for latent feature quantization, and a <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.p2.4.m4.1"><semantics id="S2.SS3.p2.4.m4.1a"><mi id="S2.SS3.p2.4.m4.1.1" xref="S2.SS3.p2.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m4.1b"><ci id="S2.SS3.p2.4.m4.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.4.m4.1d">italic_K</annotation></semantics></math>-to-1 decoder that reconstructs the input representations with the quantized features.
It is worth mentioning that the proposed tokenization method will design the specific MQ-Tokenizers for the user and item respectively (i.e., <em class="ltx_emph ltx_font_italic" id="S2.SS3.p2.4.2">Item MQ-Tokenizer</em> and <em class="ltx_emph ltx_font_italic" id="S2.SS3.p2.4.3">User MQ-Tokenizer</em>), in which they share the same architecture.
Thus, for simplicity, we will detail the item MQ-Tokenizer for item ID tokenization while omitting the user MQ-Tokenizer, as shown in FigureÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.F2" title="Figure 2 â€£ II-B An Overview of the Proposed Framework â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<section class="ltx_subsubsection" id="S2.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S2.SS3.SSS1.4.1.1">II-C</span>1 </span><span class="ltx_text ltx_font_bold" id="S2.SS3.SSS1.5.2">Collaborative Knowledge</span>
</h4>
<div class="ltx_para" id="S2.SS3.SSS1.p1">
<p class="ltx_p" id="S2.SS3.SSS1.p1.1">The primary objective of our proposed MQ-Tokenizer lies in capturing high-order collaborative knowledge into latent representations through vector quantization.
Collaborative knowledge has been widely proven informative for predicting user preferences in recommender systemsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib3" title="">3</a>]</cite>, as it reveals the in-depth behavioral similarity among users (or items).
However, it is challenging for LLMs to map textual descriptions of the high-order collaborative relationships between users and items explicitly with natural languageÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib19" title="">19</a>]</cite>.
Meanwhile, as the most advanced collaborative filtering techniques, graph neural networks (GNNs) are proposed to learn user and item representations by capturing high-order collaborative signals among users and items in recommendationsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib6" title="">6</a>]</cite>.
Despite great potential, it is challenging to fully harness the high-order signals from user-item interactions in natural language for LLM-based recommendations.
Thus, we propose to perform vector quantization on the collaborative representations learned by advanced GNN-based methods for indexing/tokenizing users and items.
Specifically, our MQ-Tokenizer assigns each user and item a small number of discrete tokens generated by quantizing the GNN-based representations.
In other words, it is suggested that users and items in close proximity to each other in the latent space of collaborative knowledge (i.e., user/item representations) are more likely to share similar tokens/indices, which naturally aligns LLMs with recommendations by tokenizing users and items in natural language.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S2.SS3.SSS2.4.1.1">II-C</span>2 </span><span class="ltx_text ltx_font_bold" id="S2.SS3.SSS2.5.2">Masking Operation</span>
</h4>
<div class="ltx_para" id="S2.SS3.SSS2.p1">
<p class="ltx_p" id="S2.SS3.SSS2.p1.1">On the basis of introducing the collaborative representations learned from GNN-based collaborative filtering methods, which are stored in a vector database, we propose to randomly mask these representations to create a challenging task that enables the tokenizer to build a comprehensive understanding and generalize well.
Specifically, we introduce an element-wise masking strategy <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.1.m1.1"><semantics id="S2.SS3.SSS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS2.p1.1.m1.1.1" xref="S2.SS3.SSS2.p1.1.m1.1.1.cmml">â„°</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.1.m1.1b"><ci id="S2.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1">â„°</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.1.m1.1c">\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.1.m1.1d">caligraphic_E</annotation></semantics></math> following Bernoulli distribution as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx2">
<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{E}\sim{\rm Bernoulli}(\rho)," class="ltx_Math" display="inline" id="S2.E2.m1.2"><semantics id="S2.E2.m1.2a"><mrow id="S2.E2.m1.2.2.1" xref="S2.E2.m1.2.2.1.1.cmml"><mrow id="S2.E2.m1.2.2.1.1" xref="S2.E2.m1.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.2.2.1.1.2" xref="S2.E2.m1.2.2.1.1.2.cmml">â„°</mi><mo id="S2.E2.m1.2.2.1.1.1" xref="S2.E2.m1.2.2.1.1.1.cmml">âˆ¼</mo><mrow id="S2.E2.m1.2.2.1.1.3" xref="S2.E2.m1.2.2.1.1.3.cmml"><mi id="S2.E2.m1.2.2.1.1.3.2" xref="S2.E2.m1.2.2.1.1.3.2.cmml">Bernoulli</mi><mo id="S2.E2.m1.2.2.1.1.3.1" xref="S2.E2.m1.2.2.1.1.3.1.cmml">â¢</mo><mrow id="S2.E2.m1.2.2.1.1.3.3.2" xref="S2.E2.m1.2.2.1.1.3.cmml"><mo id="S2.E2.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S2.E2.m1.2.2.1.1.3.cmml">(</mo><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">Ï</mi><mo id="S2.E2.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="S2.E2.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.2.2.1.2" xref="S2.E2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.2b"><apply id="S2.E2.m1.2.2.1.1.cmml" xref="S2.E2.m1.2.2.1"><csymbol cd="latexml" id="S2.E2.m1.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1">similar-to</csymbol><ci id="S2.E2.m1.2.2.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.2">â„°</ci><apply id="S2.E2.m1.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.3"><times id="S2.E2.m1.2.2.1.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.3.1"></times><ci id="S2.E2.m1.2.2.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.3.2">Bernoulli</ci><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">ğœŒ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.2c">\displaystyle\mathcal{E}\sim{\rm Bernoulli}(\rho),</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.2d">caligraphic_E âˆ¼ roman_Bernoulli ( italic_Ï ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS2.p1.6">where <math alttext="\rho" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.2.m1.1"><semantics id="S2.SS3.SSS2.p1.2.m1.1a"><mi id="S2.SS3.SSS2.p1.2.m1.1.1" xref="S2.SS3.SSS2.p1.2.m1.1.1.cmml">Ï</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.2.m1.1b"><ci id="S2.SS3.SSS2.p1.2.m1.1.1.cmml" xref="S2.SS3.SSS2.p1.2.m1.1.1">ğœŒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.2.m1.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.2.m1.1d">italic_Ï</annotation></semantics></math> is the masking ratio.
The Bernoulli distribution is the discrete probability distribution of a random variable, which takes the value 1 with probability <math alttext="\rho" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.3.m2.1"><semantics id="S2.SS3.SSS2.p1.3.m2.1a"><mi id="S2.SS3.SSS2.p1.3.m2.1.1" xref="S2.SS3.SSS2.p1.3.m2.1.1.cmml">Ï</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.3.m2.1b"><ci id="S2.SS3.SSS2.p1.3.m2.1.1.cmml" xref="S2.SS3.SSS2.p1.3.m2.1.1">ğœŒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.3.m2.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.3.m2.1d">italic_Ï</annotation></semantics></math> and the value 0 with probability <math alttext="1-\rho" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.4.m3.1"><semantics id="S2.SS3.SSS2.p1.4.m3.1a"><mrow id="S2.SS3.SSS2.p1.4.m3.1.1" xref="S2.SS3.SSS2.p1.4.m3.1.1.cmml"><mn id="S2.SS3.SSS2.p1.4.m3.1.1.2" xref="S2.SS3.SSS2.p1.4.m3.1.1.2.cmml">1</mn><mo id="S2.SS3.SSS2.p1.4.m3.1.1.1" xref="S2.SS3.SSS2.p1.4.m3.1.1.1.cmml">âˆ’</mo><mi id="S2.SS3.SSS2.p1.4.m3.1.1.3" xref="S2.SS3.SSS2.p1.4.m3.1.1.3.cmml">Ï</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.4.m3.1b"><apply id="S2.SS3.SSS2.p1.4.m3.1.1.cmml" xref="S2.SS3.SSS2.p1.4.m3.1.1"><minus id="S2.SS3.SSS2.p1.4.m3.1.1.1.cmml" xref="S2.SS3.SSS2.p1.4.m3.1.1.1"></minus><cn id="S2.SS3.SSS2.p1.4.m3.1.1.2.cmml" type="integer" xref="S2.SS3.SSS2.p1.4.m3.1.1.2">1</cn><ci id="S2.SS3.SSS2.p1.4.m3.1.1.3.cmml" xref="S2.SS3.SSS2.p1.4.m3.1.1.3">ğœŒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.4.m3.1c">1-\rho</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.4.m3.1d">1 - italic_Ï</annotation></semantics></math>.
Given the collaborative representations <math alttext="\mathbf{p}_{i}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.5.m4.1"><semantics id="S2.SS3.SSS2.p1.5.m4.1a"><msub id="S2.SS3.SSS2.p1.5.m4.1.1" xref="S2.SS3.SSS2.p1.5.m4.1.1.cmml"><mi id="S2.SS3.SSS2.p1.5.m4.1.1.2" xref="S2.SS3.SSS2.p1.5.m4.1.1.2.cmml">ğ©</mi><mi id="S2.SS3.SSS2.p1.5.m4.1.1.3" xref="S2.SS3.SSS2.p1.5.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.5.m4.1b"><apply id="S2.SS3.SSS2.p1.5.m4.1.1.cmml" xref="S2.SS3.SSS2.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.5.m4.1.1.1.cmml" xref="S2.SS3.SSS2.p1.5.m4.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p1.5.m4.1.1.2.cmml" xref="S2.SS3.SSS2.p1.5.m4.1.1.2">ğ©</ci><ci id="S2.SS3.SSS2.p1.5.m4.1.1.3.cmml" xref="S2.SS3.SSS2.p1.5.m4.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.5.m4.1c">\mathbf{p}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.5.m4.1d">bold_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{q}_{j}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.6.m5.1"><semantics id="S2.SS3.SSS2.p1.6.m5.1a"><msub id="S2.SS3.SSS2.p1.6.m5.1.1" xref="S2.SS3.SSS2.p1.6.m5.1.1.cmml"><mi id="S2.SS3.SSS2.p1.6.m5.1.1.2" xref="S2.SS3.SSS2.p1.6.m5.1.1.2.cmml">ğª</mi><mi id="S2.SS3.SSS2.p1.6.m5.1.1.3" xref="S2.SS3.SSS2.p1.6.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.6.m5.1b"><apply id="S2.SS3.SSS2.p1.6.m5.1.1.cmml" xref="S2.SS3.SSS2.p1.6.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.6.m5.1.1.1.cmml" xref="S2.SS3.SSS2.p1.6.m5.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p1.6.m5.1.1.2.cmml" xref="S2.SS3.SSS2.p1.6.m5.1.1.2">ğª</ci><ci id="S2.SS3.SSS2.p1.6.m5.1.1.3.cmml" xref="S2.SS3.SSS2.p1.6.m5.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.6.m5.1c">\mathbf{q}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.6.m5.1d">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, the masking process can be presented by</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx3">
<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{p}^{\prime}_{i}=\text{Mask}(\mathbf{p}_{i},\mathcal{E}),%
\ \mathbf{q}^{\prime}_{j}=\text{Mask}(\mathbf{q}_{j},\mathcal{E})," class="ltx_Math" display="inline" id="S2.E3.m1.3"><semantics id="S2.E3.m1.3a"><mrow id="S2.E3.m1.3.3.1"><mrow id="S2.E3.m1.3.3.1.1.2" xref="S2.E3.m1.3.3.1.1.3.cmml"><mrow id="S2.E3.m1.3.3.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.cmml"><msubsup id="S2.E3.m1.3.3.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.3.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1.3.2.2" xref="S2.E3.m1.3.3.1.1.1.1.3.2.2.cmml">ğ©</mi><mi id="S2.E3.m1.3.3.1.1.1.1.3.3" xref="S2.E3.m1.3.3.1.1.1.1.3.3.cmml">i</mi><mo id="S2.E3.m1.3.3.1.1.1.1.3.2.3" xref="S2.E3.m1.3.3.1.1.1.1.3.2.3.cmml">â€²</mo></msubsup><mo id="S2.E3.m1.3.3.1.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.1.2.cmml">=</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.cmml"><mtext id="S2.E3.m1.3.3.1.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.1.3a.cmml">Mask</mtext><mo id="S2.E3.m1.3.3.1.1.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.1.1.2.cmml">â¢</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.2.cmml"><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.3.3.1.1.1.1.1.1.2.cmml">(</mo><msub id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">ğ©</mi><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">â„°</mi><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.4" stretchy="false" xref="S2.E3.m1.3.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.3.3.1.1.2.3" rspace="0.667em" xref="S2.E3.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S2.E3.m1.3.3.1.1.2.2" xref="S2.E3.m1.3.3.1.1.2.2.cmml"><msubsup id="S2.E3.m1.3.3.1.1.2.2.3" xref="S2.E3.m1.3.3.1.1.2.2.3.cmml"><mi id="S2.E3.m1.3.3.1.1.2.2.3.2.2" xref="S2.E3.m1.3.3.1.1.2.2.3.2.2.cmml">ğª</mi><mi id="S2.E3.m1.3.3.1.1.2.2.3.3" xref="S2.E3.m1.3.3.1.1.2.2.3.3.cmml">j</mi><mo id="S2.E3.m1.3.3.1.1.2.2.3.2.3" xref="S2.E3.m1.3.3.1.1.2.2.3.2.3.cmml">â€²</mo></msubsup><mo id="S2.E3.m1.3.3.1.1.2.2.2" xref="S2.E3.m1.3.3.1.1.2.2.2.cmml">=</mo><mrow id="S2.E3.m1.3.3.1.1.2.2.1" xref="S2.E3.m1.3.3.1.1.2.2.1.cmml"><mtext id="S2.E3.m1.3.3.1.1.2.2.1.3" xref="S2.E3.m1.3.3.1.1.2.2.1.3a.cmml">Mask</mtext><mo id="S2.E3.m1.3.3.1.1.2.2.1.2" xref="S2.E3.m1.3.3.1.1.2.2.1.2.cmml">â¢</mo><mrow id="S2.E3.m1.3.3.1.1.2.2.1.1.1" xref="S2.E3.m1.3.3.1.1.2.2.1.1.2.cmml"><mo id="S2.E3.m1.3.3.1.1.2.2.1.1.1.2" stretchy="false" xref="S2.E3.m1.3.3.1.1.2.2.1.1.2.cmml">(</mo><msub id="S2.E3.m1.3.3.1.1.2.2.1.1.1.1" xref="S2.E3.m1.3.3.1.1.2.2.1.1.1.1.cmml"><mi id="S2.E3.m1.3.3.1.1.2.2.1.1.1.1.2" xref="S2.E3.m1.3.3.1.1.2.2.1.1.1.1.2.cmml">ğª</mi><mi id="S2.E3.m1.3.3.1.1.2.2.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.2.2.1.1.1.1.3.cmml">j</mi></msub><mo id="S2.E3.m1.3.3.1.1.2.2.1.1.1.3" xref="S2.E3.m1.3.3.1.1.2.2.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml">â„°</mi><mo id="S2.E3.m1.3.3.1.1.2.2.1.1.1.4" stretchy="false" xref="S2.E3.m1.3.3.1.1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E3.m1.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.3b"><apply id="S2.E3.m1.3.3.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.3a.cmml" xref="S2.E3.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E3.m1.3.3.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1"><eq id="S2.E3.m1.3.3.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.2"></eq><apply id="S2.E3.m1.3.3.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.3.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.3">subscript</csymbol><apply id="S2.E3.m1.3.3.1.1.1.1.3.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.3">superscript</csymbol><ci id="S2.E3.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.3.2.2">ğ©</ci><ci id="S2.E3.m1.3.3.1.1.1.1.3.2.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.3.2.3">â€²</ci></apply><ci id="S2.E3.m1.3.3.1.1.1.1.3.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.3.3">ğ‘–</ci></apply><apply id="S2.E3.m1.3.3.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1"><times id="S2.E3.m1.3.3.1.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.2"></times><ci id="S2.E3.m1.3.3.1.1.1.1.1.3a.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.3"><mtext id="S2.E3.m1.3.3.1.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.3">Mask</mtext></ci><interval closure="open" id="S2.E3.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1"><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.2">ğ©</ci><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">â„°</ci></interval></apply></apply><apply id="S2.E3.m1.3.3.1.1.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2"><eq id="S2.E3.m1.3.3.1.1.2.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2"></eq><apply id="S2.E3.m1.3.3.1.1.2.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.2.2.3.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3">subscript</csymbol><apply id="S2.E3.m1.3.3.1.1.2.2.3.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.2.2.3.2.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3">superscript</csymbol><ci id="S2.E3.m1.3.3.1.1.2.2.3.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3.2.2">ğª</ci><ci id="S2.E3.m1.3.3.1.1.2.2.3.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3.2.3">â€²</ci></apply><ci id="S2.E3.m1.3.3.1.1.2.2.3.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3.3">ğ‘—</ci></apply><apply id="S2.E3.m1.3.3.1.1.2.2.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.1"><times id="S2.E3.m1.3.3.1.1.2.2.1.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.1.2"></times><ci id="S2.E3.m1.3.3.1.1.2.2.1.3a.cmml" xref="S2.E3.m1.3.3.1.1.2.2.1.3"><mtext id="S2.E3.m1.3.3.1.1.2.2.1.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.1.3">Mask</mtext></ci><interval closure="open" id="S2.E3.m1.3.3.1.1.2.2.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.1.1.1"><apply id="S2.E3.m1.3.3.1.1.2.2.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.2.2.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.2.2.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.1.1.1.1.2">ğª</ci><ci id="S2.E3.m1.3.3.1.1.2.2.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.1.1.1.1.3">ğ‘—</ci></apply><ci id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2">â„°</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.3c">\displaystyle\mathbf{p}^{\prime}_{i}=\text{Mask}(\mathbf{p}_{i},\mathcal{E}),%
\ \mathbf{q}^{\prime}_{j}=\text{Mask}(\mathbf{q}_{j},\mathcal{E}),</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.3d">bold_p start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = Mask ( bold_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , caligraphic_E ) , bold_q start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = Mask ( bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , caligraphic_E ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS2.p1.11">where <math alttext="\mathbf{p}^{\prime}_{i}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.7.m1.1"><semantics id="S2.SS3.SSS2.p1.7.m1.1a"><msubsup id="S2.SS3.SSS2.p1.7.m1.1.1" xref="S2.SS3.SSS2.p1.7.m1.1.1.cmml"><mi id="S2.SS3.SSS2.p1.7.m1.1.1.2.2" xref="S2.SS3.SSS2.p1.7.m1.1.1.2.2.cmml">ğ©</mi><mi id="S2.SS3.SSS2.p1.7.m1.1.1.3" xref="S2.SS3.SSS2.p1.7.m1.1.1.3.cmml">i</mi><mo id="S2.SS3.SSS2.p1.7.m1.1.1.2.3" xref="S2.SS3.SSS2.p1.7.m1.1.1.2.3.cmml">â€²</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.7.m1.1b"><apply id="S2.SS3.SSS2.p1.7.m1.1.1.cmml" xref="S2.SS3.SSS2.p1.7.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.7.m1.1.1.1.cmml" xref="S2.SS3.SSS2.p1.7.m1.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p1.7.m1.1.1.2.cmml" xref="S2.SS3.SSS2.p1.7.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.7.m1.1.1.2.1.cmml" xref="S2.SS3.SSS2.p1.7.m1.1.1">superscript</csymbol><ci id="S2.SS3.SSS2.p1.7.m1.1.1.2.2.cmml" xref="S2.SS3.SSS2.p1.7.m1.1.1.2.2">ğ©</ci><ci id="S2.SS3.SSS2.p1.7.m1.1.1.2.3.cmml" xref="S2.SS3.SSS2.p1.7.m1.1.1.2.3">â€²</ci></apply><ci id="S2.SS3.SSS2.p1.7.m1.1.1.3.cmml" xref="S2.SS3.SSS2.p1.7.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.7.m1.1c">\mathbf{p}^{\prime}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.7.m1.1d">bold_p start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{q}^{\prime}_{j}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.8.m2.1"><semantics id="S2.SS3.SSS2.p1.8.m2.1a"><msubsup id="S2.SS3.SSS2.p1.8.m2.1.1" xref="S2.SS3.SSS2.p1.8.m2.1.1.cmml"><mi id="S2.SS3.SSS2.p1.8.m2.1.1.2.2" xref="S2.SS3.SSS2.p1.8.m2.1.1.2.2.cmml">ğª</mi><mi id="S2.SS3.SSS2.p1.8.m2.1.1.3" xref="S2.SS3.SSS2.p1.8.m2.1.1.3.cmml">j</mi><mo id="S2.SS3.SSS2.p1.8.m2.1.1.2.3" xref="S2.SS3.SSS2.p1.8.m2.1.1.2.3.cmml">â€²</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.8.m2.1b"><apply id="S2.SS3.SSS2.p1.8.m2.1.1.cmml" xref="S2.SS3.SSS2.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.8.m2.1.1.1.cmml" xref="S2.SS3.SSS2.p1.8.m2.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p1.8.m2.1.1.2.cmml" xref="S2.SS3.SSS2.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.8.m2.1.1.2.1.cmml" xref="S2.SS3.SSS2.p1.8.m2.1.1">superscript</csymbol><ci id="S2.SS3.SSS2.p1.8.m2.1.1.2.2.cmml" xref="S2.SS3.SSS2.p1.8.m2.1.1.2.2">ğª</ci><ci id="S2.SS3.SSS2.p1.8.m2.1.1.2.3.cmml" xref="S2.SS3.SSS2.p1.8.m2.1.1.2.3">â€²</ci></apply><ci id="S2.SS3.SSS2.p1.8.m2.1.1.3.cmml" xref="S2.SS3.SSS2.p1.8.m2.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.8.m2.1c">\mathbf{q}^{\prime}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.8.m2.1d">bold_q start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are the masked representations of user <math alttext="u_{i}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.9.m3.1"><semantics id="S2.SS3.SSS2.p1.9.m3.1a"><msub id="S2.SS3.SSS2.p1.9.m3.1.1" xref="S2.SS3.SSS2.p1.9.m3.1.1.cmml"><mi id="S2.SS3.SSS2.p1.9.m3.1.1.2" xref="S2.SS3.SSS2.p1.9.m3.1.1.2.cmml">u</mi><mi id="S2.SS3.SSS2.p1.9.m3.1.1.3" xref="S2.SS3.SSS2.p1.9.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.9.m3.1b"><apply id="S2.SS3.SSS2.p1.9.m3.1.1.cmml" xref="S2.SS3.SSS2.p1.9.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.9.m3.1.1.1.cmml" xref="S2.SS3.SSS2.p1.9.m3.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p1.9.m3.1.1.2.cmml" xref="S2.SS3.SSS2.p1.9.m3.1.1.2">ğ‘¢</ci><ci id="S2.SS3.SSS2.p1.9.m3.1.1.3.cmml" xref="S2.SS3.SSS2.p1.9.m3.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.9.m3.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.9.m3.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and item <math alttext="v_{j}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.10.m4.1"><semantics id="S2.SS3.SSS2.p1.10.m4.1a"><msub id="S2.SS3.SSS2.p1.10.m4.1.1" xref="S2.SS3.SSS2.p1.10.m4.1.1.cmml"><mi id="S2.SS3.SSS2.p1.10.m4.1.1.2" xref="S2.SS3.SSS2.p1.10.m4.1.1.2.cmml">v</mi><mi id="S2.SS3.SSS2.p1.10.m4.1.1.3" xref="S2.SS3.SSS2.p1.10.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.10.m4.1b"><apply id="S2.SS3.SSS2.p1.10.m4.1.1.cmml" xref="S2.SS3.SSS2.p1.10.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.10.m4.1.1.1.cmml" xref="S2.SS3.SSS2.p1.10.m4.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p1.10.m4.1.1.2.cmml" xref="S2.SS3.SSS2.p1.10.m4.1.1.2">ğ‘£</ci><ci id="S2.SS3.SSS2.p1.10.m4.1.1.3.cmml" xref="S2.SS3.SSS2.p1.10.m4.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.10.m4.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.10.m4.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, respectively.
It should be noted that <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.11.m5.1"><semantics id="S2.SS3.SSS2.p1.11.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS2.p1.11.m5.1.1" xref="S2.SS3.SSS2.p1.11.m5.1.1.cmml">â„°</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.11.m5.1b"><ci id="S2.SS3.SSS2.p1.11.m5.1.1.cmml" xref="S2.SS3.SSS2.p1.11.m5.1.1">â„°</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.11.m5.1c">\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.11.m5.1d">caligraphic_E</annotation></semantics></math> randomly generates masks at each training epoch to create multifarious samples so as to enhance the generalization capability in the proposed tokenizers.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S2.SS3.SSS3.5.1.1">II-C</span>3 </span><math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS3.1.m1.1"><semantics id="S2.SS3.SSS3.1.m1.1b"><mi id="S2.SS3.SSS3.1.m1.1.1" xref="S2.SS3.SSS3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.1.m1.1c"><ci id="S2.SS3.SSS3.1.m1.1.1.cmml" xref="S2.SS3.SSS3.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.1.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.1.m1.1e">italic_K</annotation></semantics></math><span class="ltx_text ltx_font_bold" id="S2.SS3.SSS3.6.2">-way Encoder and Codebook</span>
</h4>
<div class="ltx_para" id="S2.SS3.SSS3.p1">
<p class="ltx_p" id="S2.SS3.SSS3.p1.10">In light of the masked collaborative representations of items, we propose a novel vector quantization framework to tokenize each item as a handful of discrete tokens.
To be more specific, a <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.1.m1.1"><semantics id="S2.SS3.SSS3.p1.1.m1.1a"><mi id="S2.SS3.SSS3.p1.1.m1.1.1" xref="S2.SS3.SSS3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.1.m1.1b"><ci id="S2.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS3.p1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.1.m1.1d">italic_K</annotation></semantics></math>-way encoder <math alttext="\text{Enc}(\cdot)" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.2.m2.1"><semantics id="S2.SS3.SSS3.p1.2.m2.1a"><mrow id="S2.SS3.SSS3.p1.2.m2.1.2" xref="S2.SS3.SSS3.p1.2.m2.1.2.cmml"><mtext id="S2.SS3.SSS3.p1.2.m2.1.2.2" xref="S2.SS3.SSS3.p1.2.m2.1.2.2a.cmml">Enc</mtext><mo id="S2.SS3.SSS3.p1.2.m2.1.2.1" xref="S2.SS3.SSS3.p1.2.m2.1.2.1.cmml">â¢</mo><mrow id="S2.SS3.SSS3.p1.2.m2.1.2.3.2" xref="S2.SS3.SSS3.p1.2.m2.1.2.cmml"><mo id="S2.SS3.SSS3.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S2.SS3.SSS3.p1.2.m2.1.2.cmml">(</mo><mo id="S2.SS3.SSS3.p1.2.m2.1.1" lspace="0em" rspace="0em" xref="S2.SS3.SSS3.p1.2.m2.1.1.cmml">â‹…</mo><mo id="S2.SS3.SSS3.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S2.SS3.SSS3.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.2.m2.1b"><apply id="S2.SS3.SSS3.p1.2.m2.1.2.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.2"><times id="S2.SS3.SSS3.p1.2.m2.1.2.1.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.2.1"></times><ci id="S2.SS3.SSS3.p1.2.m2.1.2.2a.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.2.2"><mtext id="S2.SS3.SSS3.p1.2.m2.1.2.2.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.2.2">Enc</mtext></ci><ci id="S2.SS3.SSS3.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.1">â‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.2.m2.1c">\text{Enc}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.2.m2.1d">Enc ( â‹… )</annotation></semantics></math> is developed to learn a corresponding <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.3.m3.1"><semantics id="S2.SS3.SSS3.p1.3.m3.1a"><mi id="S2.SS3.SSS3.p1.3.m3.1.1" xref="S2.SS3.SSS3.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.3.m3.1b"><ci id="S2.SS3.SSS3.p1.3.m3.1.1.cmml" xref="S2.SS3.SSS3.p1.3.m3.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.3.m3.1d">italic_K</annotation></semantics></math>-way codebook <math alttext="\mathbf{C}=\{\mathbf{c}^{1},\mathbf{c}^{2},...,\mathbf{c}^{k},...,\mathbf{c}^{%
K}\}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.4.m4.6"><semantics id="S2.SS3.SSS3.p1.4.m4.6a"><mrow id="S2.SS3.SSS3.p1.4.m4.6.6" xref="S2.SS3.SSS3.p1.4.m4.6.6.cmml"><mi id="S2.SS3.SSS3.p1.4.m4.6.6.6" xref="S2.SS3.SSS3.p1.4.m4.6.6.6.cmml">ğ‚</mi><mo id="S2.SS3.SSS3.p1.4.m4.6.6.5" xref="S2.SS3.SSS3.p1.4.m4.6.6.5.cmml">=</mo><mrow id="S2.SS3.SSS3.p1.4.m4.6.6.4.4" xref="S2.SS3.SSS3.p1.4.m4.6.6.4.5.cmml"><mo id="S2.SS3.SSS3.p1.4.m4.6.6.4.4.5" stretchy="false" xref="S2.SS3.SSS3.p1.4.m4.6.6.4.5.cmml">{</mo><msup id="S2.SS3.SSS3.p1.4.m4.3.3.1.1.1" xref="S2.SS3.SSS3.p1.4.m4.3.3.1.1.1.cmml"><mi id="S2.SS3.SSS3.p1.4.m4.3.3.1.1.1.2" xref="S2.SS3.SSS3.p1.4.m4.3.3.1.1.1.2.cmml">ğœ</mi><mn id="S2.SS3.SSS3.p1.4.m4.3.3.1.1.1.3" xref="S2.SS3.SSS3.p1.4.m4.3.3.1.1.1.3.cmml">1</mn></msup><mo id="S2.SS3.SSS3.p1.4.m4.6.6.4.4.6" xref="S2.SS3.SSS3.p1.4.m4.6.6.4.5.cmml">,</mo><msup id="S2.SS3.SSS3.p1.4.m4.4.4.2.2.2" xref="S2.SS3.SSS3.p1.4.m4.4.4.2.2.2.cmml"><mi id="S2.SS3.SSS3.p1.4.m4.4.4.2.2.2.2" xref="S2.SS3.SSS3.p1.4.m4.4.4.2.2.2.2.cmml">ğœ</mi><mn id="S2.SS3.SSS3.p1.4.m4.4.4.2.2.2.3" xref="S2.SS3.SSS3.p1.4.m4.4.4.2.2.2.3.cmml">2</mn></msup><mo id="S2.SS3.SSS3.p1.4.m4.6.6.4.4.7" xref="S2.SS3.SSS3.p1.4.m4.6.6.4.5.cmml">,</mo><mi id="S2.SS3.SSS3.p1.4.m4.1.1" mathvariant="normal" xref="S2.SS3.SSS3.p1.4.m4.1.1.cmml">â€¦</mi><mo id="S2.SS3.SSS3.p1.4.m4.6.6.4.4.8" xref="S2.SS3.SSS3.p1.4.m4.6.6.4.5.cmml">,</mo><msup id="S2.SS3.SSS3.p1.4.m4.5.5.3.3.3" xref="S2.SS3.SSS3.p1.4.m4.5.5.3.3.3.cmml"><mi id="S2.SS3.SSS3.p1.4.m4.5.5.3.3.3.2" xref="S2.SS3.SSS3.p1.4.m4.5.5.3.3.3.2.cmml">ğœ</mi><mi id="S2.SS3.SSS3.p1.4.m4.5.5.3.3.3.3" xref="S2.SS3.SSS3.p1.4.m4.5.5.3.3.3.3.cmml">k</mi></msup><mo id="S2.SS3.SSS3.p1.4.m4.6.6.4.4.9" xref="S2.SS3.SSS3.p1.4.m4.6.6.4.5.cmml">,</mo><mi id="S2.SS3.SSS3.p1.4.m4.2.2" mathvariant="normal" xref="S2.SS3.SSS3.p1.4.m4.2.2.cmml">â€¦</mi><mo id="S2.SS3.SSS3.p1.4.m4.6.6.4.4.10" xref="S2.SS3.SSS3.p1.4.m4.6.6.4.5.cmml">,</mo><msup id="S2.SS3.SSS3.p1.4.m4.6.6.4.4.4" xref="S2.SS3.SSS3.p1.4.m4.6.6.4.4.4.cmml"><mi id="S2.SS3.SSS3.p1.4.m4.6.6.4.4.4.2" xref="S2.SS3.SSS3.p1.4.m4.6.6.4.4.4.2.cmml">ğœ</mi><mi id="S2.SS3.SSS3.p1.4.m4.6.6.4.4.4.3" xref="S2.SS3.SSS3.p1.4.m4.6.6.4.4.4.3.cmml">K</mi></msup><mo id="S2.SS3.SSS3.p1.4.m4.6.6.4.4.11" stretchy="false" xref="S2.SS3.SSS3.p1.4.m4.6.6.4.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.4.m4.6b"><apply id="S2.SS3.SSS3.p1.4.m4.6.6.cmml" xref="S2.SS3.SSS3.p1.4.m4.6.6"><eq id="S2.SS3.SSS3.p1.4.m4.6.6.5.cmml" xref="S2.SS3.SSS3.p1.4.m4.6.6.5"></eq><ci id="S2.SS3.SSS3.p1.4.m4.6.6.6.cmml" xref="S2.SS3.SSS3.p1.4.m4.6.6.6">ğ‚</ci><set id="S2.SS3.SSS3.p1.4.m4.6.6.4.5.cmml" xref="S2.SS3.SSS3.p1.4.m4.6.6.4.4"><apply id="S2.SS3.SSS3.p1.4.m4.3.3.1.1.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.4.m4.3.3.1.1.1.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.3.3.1.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p1.4.m4.3.3.1.1.1.2.cmml" xref="S2.SS3.SSS3.p1.4.m4.3.3.1.1.1.2">ğœ</ci><cn id="S2.SS3.SSS3.p1.4.m4.3.3.1.1.1.3.cmml" type="integer" xref="S2.SS3.SSS3.p1.4.m4.3.3.1.1.1.3">1</cn></apply><apply id="S2.SS3.SSS3.p1.4.m4.4.4.2.2.2.cmml" xref="S2.SS3.SSS3.p1.4.m4.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.4.m4.4.4.2.2.2.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.4.4.2.2.2">superscript</csymbol><ci id="S2.SS3.SSS3.p1.4.m4.4.4.2.2.2.2.cmml" xref="S2.SS3.SSS3.p1.4.m4.4.4.2.2.2.2">ğœ</ci><cn id="S2.SS3.SSS3.p1.4.m4.4.4.2.2.2.3.cmml" type="integer" xref="S2.SS3.SSS3.p1.4.m4.4.4.2.2.2.3">2</cn></apply><ci id="S2.SS3.SSS3.p1.4.m4.1.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1">â€¦</ci><apply id="S2.SS3.SSS3.p1.4.m4.5.5.3.3.3.cmml" xref="S2.SS3.SSS3.p1.4.m4.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.4.m4.5.5.3.3.3.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.5.5.3.3.3">superscript</csymbol><ci id="S2.SS3.SSS3.p1.4.m4.5.5.3.3.3.2.cmml" xref="S2.SS3.SSS3.p1.4.m4.5.5.3.3.3.2">ğœ</ci><ci id="S2.SS3.SSS3.p1.4.m4.5.5.3.3.3.3.cmml" xref="S2.SS3.SSS3.p1.4.m4.5.5.3.3.3.3">ğ‘˜</ci></apply><ci id="S2.SS3.SSS3.p1.4.m4.2.2.cmml" xref="S2.SS3.SSS3.p1.4.m4.2.2">â€¦</ci><apply id="S2.SS3.SSS3.p1.4.m4.6.6.4.4.4.cmml" xref="S2.SS3.SSS3.p1.4.m4.6.6.4.4.4"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.4.m4.6.6.4.4.4.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.6.6.4.4.4">superscript</csymbol><ci id="S2.SS3.SSS3.p1.4.m4.6.6.4.4.4.2.cmml" xref="S2.SS3.SSS3.p1.4.m4.6.6.4.4.4.2">ğœ</ci><ci id="S2.SS3.SSS3.p1.4.m4.6.6.4.4.4.3.cmml" xref="S2.SS3.SSS3.p1.4.m4.6.6.4.4.4.3">ğ¾</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.4.m4.6c">\mathbf{C}=\{\mathbf{c}^{1},\mathbf{c}^{2},...,\mathbf{c}^{k},...,\mathbf{c}^{%
K}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.4.m4.6d">bold_C = { bold_c start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , bold_c start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , â€¦ , bold_c start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT , â€¦ , bold_c start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT }</annotation></semantics></math> for items, where <math alttext="\mathbf{c}^{k}\in\mathbb{R}^{L\times d_{c}}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.5.m5.1"><semantics id="S2.SS3.SSS3.p1.5.m5.1a"><mrow id="S2.SS3.SSS3.p1.5.m5.1.1" xref="S2.SS3.SSS3.p1.5.m5.1.1.cmml"><msup id="S2.SS3.SSS3.p1.5.m5.1.1.2" xref="S2.SS3.SSS3.p1.5.m5.1.1.2.cmml"><mi id="S2.SS3.SSS3.p1.5.m5.1.1.2.2" xref="S2.SS3.SSS3.p1.5.m5.1.1.2.2.cmml">ğœ</mi><mi id="S2.SS3.SSS3.p1.5.m5.1.1.2.3" xref="S2.SS3.SSS3.p1.5.m5.1.1.2.3.cmml">k</mi></msup><mo id="S2.SS3.SSS3.p1.5.m5.1.1.1" xref="S2.SS3.SSS3.p1.5.m5.1.1.1.cmml">âˆˆ</mo><msup id="S2.SS3.SSS3.p1.5.m5.1.1.3" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.cmml"><mi id="S2.SS3.SSS3.p1.5.m5.1.1.3.2" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.2.cmml">â„</mi><mrow id="S2.SS3.SSS3.p1.5.m5.1.1.3.3" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.3.cmml"><mi id="S2.SS3.SSS3.p1.5.m5.1.1.3.3.2" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.3.2.cmml">L</mi><mo id="S2.SS3.SSS3.p1.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.3.1.cmml">Ã—</mo><msub id="S2.SS3.SSS3.p1.5.m5.1.1.3.3.3" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.3.3.cmml"><mi id="S2.SS3.SSS3.p1.5.m5.1.1.3.3.3.2" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.3.3.2.cmml">d</mi><mi id="S2.SS3.SSS3.p1.5.m5.1.1.3.3.3.3" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.3.3.3.cmml">c</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.5.m5.1b"><apply id="S2.SS3.SSS3.p1.5.m5.1.1.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1"><in id="S2.SS3.SSS3.p1.5.m5.1.1.1.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.1"></in><apply id="S2.SS3.SSS3.p1.5.m5.1.1.2.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.5.m5.1.1.2.1.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.2">superscript</csymbol><ci id="S2.SS3.SSS3.p1.5.m5.1.1.2.2.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.2.2">ğœ</ci><ci id="S2.SS3.SSS3.p1.5.m5.1.1.2.3.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.2.3">ğ‘˜</ci></apply><apply id="S2.SS3.SSS3.p1.5.m5.1.1.3.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.5.m5.1.1.3.1.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.3">superscript</csymbol><ci id="S2.SS3.SSS3.p1.5.m5.1.1.3.2.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.2">â„</ci><apply id="S2.SS3.SSS3.p1.5.m5.1.1.3.3.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.3"><times id="S2.SS3.SSS3.p1.5.m5.1.1.3.3.1.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.3.1"></times><ci id="S2.SS3.SSS3.p1.5.m5.1.1.3.3.2.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.3.2">ğ¿</ci><apply id="S2.SS3.SSS3.p1.5.m5.1.1.3.3.3.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.5.m5.1.1.3.3.3.1.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.3.3">subscript</csymbol><ci id="S2.SS3.SSS3.p1.5.m5.1.1.3.3.3.2.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.3.3.2">ğ‘‘</ci><ci id="S2.SS3.SSS3.p1.5.m5.1.1.3.3.3.3.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.3.3.3">ğ‘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.5.m5.1c">\mathbf{c}^{k}\in\mathbb{R}^{L\times d_{c}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.5.m5.1d">bold_c start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_L Ã— italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is a latent space (i.e., the <math alttext="k" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.6.m6.1"><semantics id="S2.SS3.SSS3.p1.6.m6.1a"><mi id="S2.SS3.SSS3.p1.6.m6.1.1" xref="S2.SS3.SSS3.p1.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.6.m6.1b"><ci id="S2.SS3.SSS3.p1.6.m6.1.1.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.6.m6.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.6.m6.1d">italic_k</annotation></semantics></math>-th sub-codebook) with <math alttext="L" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.7.m7.1"><semantics id="S2.SS3.SSS3.p1.7.m7.1a"><mi id="S2.SS3.SSS3.p1.7.m7.1.1" xref="S2.SS3.SSS3.p1.7.m7.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.7.m7.1b"><ci id="S2.SS3.SSS3.p1.7.m7.1.1.cmml" xref="S2.SS3.SSS3.p1.7.m7.1.1">ğ¿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.7.m7.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.7.m7.1d">italic_L</annotation></semantics></math> pairs of codeword (i.e., token<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>In this work, the terms â€™codewordâ€™ and â€™tokenâ€™ are used interchangeably. â€™Codewordâ€™ is a common term in the context of codebooks, while â€™tokenâ€™ is more widely used in the language modeling literature. </span></span></span>) and <math alttext="w^{k}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.8.m8.1"><semantics id="S2.SS3.SSS3.p1.8.m8.1a"><msup id="S2.SS3.SSS3.p1.8.m8.1.1" xref="S2.SS3.SSS3.p1.8.m8.1.1.cmml"><mi id="S2.SS3.SSS3.p1.8.m8.1.1.2" xref="S2.SS3.SSS3.p1.8.m8.1.1.2.cmml">w</mi><mi id="S2.SS3.SSS3.p1.8.m8.1.1.3" xref="S2.SS3.SSS3.p1.8.m8.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.8.m8.1b"><apply id="S2.SS3.SSS3.p1.8.m8.1.1.cmml" xref="S2.SS3.SSS3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.8.m8.1.1.1.cmml" xref="S2.SS3.SSS3.p1.8.m8.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p1.8.m8.1.1.2.cmml" xref="S2.SS3.SSS3.p1.8.m8.1.1.2">ğ‘¤</ci><ci id="S2.SS3.SSS3.p1.8.m8.1.1.3.cmml" xref="S2.SS3.SSS3.p1.8.m8.1.1.3">ğ‘˜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.8.m8.1c">w^{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.8.m8.1d">italic_w start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> and its <math alttext="d_{c}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.9.m9.1"><semantics id="S2.SS3.SSS3.p1.9.m9.1a"><msub id="S2.SS3.SSS3.p1.9.m9.1.1" xref="S2.SS3.SSS3.p1.9.m9.1.1.cmml"><mi id="S2.SS3.SSS3.p1.9.m9.1.1.2" xref="S2.SS3.SSS3.p1.9.m9.1.1.2.cmml">d</mi><mi id="S2.SS3.SSS3.p1.9.m9.1.1.3" xref="S2.SS3.SSS3.p1.9.m9.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.9.m9.1b"><apply id="S2.SS3.SSS3.p1.9.m9.1.1.cmml" xref="S2.SS3.SSS3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.9.m9.1.1.1.cmml" xref="S2.SS3.SSS3.p1.9.m9.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p1.9.m9.1.1.2.cmml" xref="S2.SS3.SSS3.p1.9.m9.1.1.2">ğ‘‘</ci><ci id="S2.SS3.SSS3.p1.9.m9.1.1.3.cmml" xref="S2.SS3.SSS3.p1.9.m9.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.9.m9.1c">d_{c}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.9.m9.1d">italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>-dimensional codeword embedding <math alttext="\mathbf{c}^{k}_{w^{k}}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.10.m10.1"><semantics id="S2.SS3.SSS3.p1.10.m10.1a"><msubsup id="S2.SS3.SSS3.p1.10.m10.1.1" xref="S2.SS3.SSS3.p1.10.m10.1.1.cmml"><mi id="S2.SS3.SSS3.p1.10.m10.1.1.2.2" xref="S2.SS3.SSS3.p1.10.m10.1.1.2.2.cmml">ğœ</mi><msup id="S2.SS3.SSS3.p1.10.m10.1.1.3" xref="S2.SS3.SSS3.p1.10.m10.1.1.3.cmml"><mi id="S2.SS3.SSS3.p1.10.m10.1.1.3.2" xref="S2.SS3.SSS3.p1.10.m10.1.1.3.2.cmml">w</mi><mi id="S2.SS3.SSS3.p1.10.m10.1.1.3.3" xref="S2.SS3.SSS3.p1.10.m10.1.1.3.3.cmml">k</mi></msup><mi id="S2.SS3.SSS3.p1.10.m10.1.1.2.3" xref="S2.SS3.SSS3.p1.10.m10.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.10.m10.1b"><apply id="S2.SS3.SSS3.p1.10.m10.1.1.cmml" xref="S2.SS3.SSS3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.10.m10.1.1.1.cmml" xref="S2.SS3.SSS3.p1.10.m10.1.1">subscript</csymbol><apply id="S2.SS3.SSS3.p1.10.m10.1.1.2.cmml" xref="S2.SS3.SSS3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.10.m10.1.1.2.1.cmml" xref="S2.SS3.SSS3.p1.10.m10.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p1.10.m10.1.1.2.2.cmml" xref="S2.SS3.SSS3.p1.10.m10.1.1.2.2">ğœ</ci><ci id="S2.SS3.SSS3.p1.10.m10.1.1.2.3.cmml" xref="S2.SS3.SSS3.p1.10.m10.1.1.2.3">ğ‘˜</ci></apply><apply id="S2.SS3.SSS3.p1.10.m10.1.1.3.cmml" xref="S2.SS3.SSS3.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.10.m10.1.1.3.1.cmml" xref="S2.SS3.SSS3.p1.10.m10.1.1.3">superscript</csymbol><ci id="S2.SS3.SSS3.p1.10.m10.1.1.3.2.cmml" xref="S2.SS3.SSS3.p1.10.m10.1.1.3.2">ğ‘¤</ci><ci id="S2.SS3.SSS3.p1.10.m10.1.1.3.3.cmml" xref="S2.SS3.SSS3.p1.10.m10.1.1.3.3">ğ‘˜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.10.m10.1c">\mathbf{c}^{k}_{w^{k}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.10.m10.1d">bold_c start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>.
The idea behind this is to represent the users/items with entries of a learned codebook (indexed by discrete tokens), providing great potential to tokenize the discrete users and items based on their collaborative representations in an LLM-compatible manner.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS3.p2">
<p class="ltx_p" id="S2.SS3.SSS3.p2.7">In general, the proposed quantization method for user/item tokenization involves two main steps.
Taking item <math alttext="v_{j}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p2.1.m1.1"><semantics id="S2.SS3.SSS3.p2.1.m1.1a"><msub id="S2.SS3.SSS3.p2.1.m1.1.1" xref="S2.SS3.SSS3.p2.1.m1.1.1.cmml"><mi id="S2.SS3.SSS3.p2.1.m1.1.1.2" xref="S2.SS3.SSS3.p2.1.m1.1.1.2.cmml">v</mi><mi id="S2.SS3.SSS3.p2.1.m1.1.1.3" xref="S2.SS3.SSS3.p2.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p2.1.m1.1b"><apply id="S2.SS3.SSS3.p2.1.m1.1.1.cmml" xref="S2.SS3.SSS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.1.m1.1.1.1.cmml" xref="S2.SS3.SSS3.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p2.1.m1.1.1.2.cmml" xref="S2.SS3.SSS3.p2.1.m1.1.1.2">ğ‘£</ci><ci id="S2.SS3.SSS3.p2.1.m1.1.1.3.cmml" xref="S2.SS3.SSS3.p2.1.m1.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p2.1.m1.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p2.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> as an example, the <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p2.2.m2.1"><semantics id="S2.SS3.SSS3.p2.2.m2.1a"><mi id="S2.SS3.SSS3.p2.2.m2.1.1" xref="S2.SS3.SSS3.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p2.2.m2.1b"><ci id="S2.SS3.SSS3.p2.2.m2.1.1.cmml" xref="S2.SS3.SSS3.p2.2.m2.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p2.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p2.2.m2.1d">italic_K</annotation></semantics></math>-way encoder first employs <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p2.3.m3.1"><semantics id="S2.SS3.SSS3.p2.3.m3.1a"><mi id="S2.SS3.SSS3.p2.3.m3.1.1" xref="S2.SS3.SSS3.p2.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p2.3.m3.1b"><ci id="S2.SS3.SSS3.p2.3.m3.1.1.cmml" xref="S2.SS3.SSS3.p2.3.m3.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p2.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p2.3.m3.1d">italic_K</annotation></semantics></math> different encoders <math alttext="\text{Enc}^{k}(\cdot)" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p2.4.m4.1"><semantics id="S2.SS3.SSS3.p2.4.m4.1a"><mrow id="S2.SS3.SSS3.p2.4.m4.1.2" xref="S2.SS3.SSS3.p2.4.m4.1.2.cmml"><msup id="S2.SS3.SSS3.p2.4.m4.1.2.2" xref="S2.SS3.SSS3.p2.4.m4.1.2.2.cmml"><mtext id="S2.SS3.SSS3.p2.4.m4.1.2.2.2" xref="S2.SS3.SSS3.p2.4.m4.1.2.2.2a.cmml">Enc</mtext><mi id="S2.SS3.SSS3.p2.4.m4.1.2.2.3" xref="S2.SS3.SSS3.p2.4.m4.1.2.2.3.cmml">k</mi></msup><mo id="S2.SS3.SSS3.p2.4.m4.1.2.1" xref="S2.SS3.SSS3.p2.4.m4.1.2.1.cmml">â¢</mo><mrow id="S2.SS3.SSS3.p2.4.m4.1.2.3.2" xref="S2.SS3.SSS3.p2.4.m4.1.2.cmml"><mo id="S2.SS3.SSS3.p2.4.m4.1.2.3.2.1" stretchy="false" xref="S2.SS3.SSS3.p2.4.m4.1.2.cmml">(</mo><mo id="S2.SS3.SSS3.p2.4.m4.1.1" lspace="0em" rspace="0em" xref="S2.SS3.SSS3.p2.4.m4.1.1.cmml">â‹…</mo><mo id="S2.SS3.SSS3.p2.4.m4.1.2.3.2.2" stretchy="false" xref="S2.SS3.SSS3.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p2.4.m4.1b"><apply id="S2.SS3.SSS3.p2.4.m4.1.2.cmml" xref="S2.SS3.SSS3.p2.4.m4.1.2"><times id="S2.SS3.SSS3.p2.4.m4.1.2.1.cmml" xref="S2.SS3.SSS3.p2.4.m4.1.2.1"></times><apply id="S2.SS3.SSS3.p2.4.m4.1.2.2.cmml" xref="S2.SS3.SSS3.p2.4.m4.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.4.m4.1.2.2.1.cmml" xref="S2.SS3.SSS3.p2.4.m4.1.2.2">superscript</csymbol><ci id="S2.SS3.SSS3.p2.4.m4.1.2.2.2a.cmml" xref="S2.SS3.SSS3.p2.4.m4.1.2.2.2"><mtext id="S2.SS3.SSS3.p2.4.m4.1.2.2.2.cmml" xref="S2.SS3.SSS3.p2.4.m4.1.2.2.2">Enc</mtext></ci><ci id="S2.SS3.SSS3.p2.4.m4.1.2.2.3.cmml" xref="S2.SS3.SSS3.p2.4.m4.1.2.2.3">ğ‘˜</ci></apply><ci id="S2.SS3.SSS3.p2.4.m4.1.1.cmml" xref="S2.SS3.SSS3.p2.4.m4.1.1">â‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p2.4.m4.1c">\text{Enc}^{k}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p2.4.m4.1d">Enc start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( â‹… )</annotation></semantics></math> to encode the masked item representation <math alttext="\mathbf{q}^{\prime}_{j}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p2.5.m5.1"><semantics id="S2.SS3.SSS3.p2.5.m5.1a"><msubsup id="S2.SS3.SSS3.p2.5.m5.1.1" xref="S2.SS3.SSS3.p2.5.m5.1.1.cmml"><mi id="S2.SS3.SSS3.p2.5.m5.1.1.2.2" xref="S2.SS3.SSS3.p2.5.m5.1.1.2.2.cmml">ğª</mi><mi id="S2.SS3.SSS3.p2.5.m5.1.1.3" xref="S2.SS3.SSS3.p2.5.m5.1.1.3.cmml">j</mi><mo id="S2.SS3.SSS3.p2.5.m5.1.1.2.3" xref="S2.SS3.SSS3.p2.5.m5.1.1.2.3.cmml">â€²</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p2.5.m5.1b"><apply id="S2.SS3.SSS3.p2.5.m5.1.1.cmml" xref="S2.SS3.SSS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.5.m5.1.1.1.cmml" xref="S2.SS3.SSS3.p2.5.m5.1.1">subscript</csymbol><apply id="S2.SS3.SSS3.p2.5.m5.1.1.2.cmml" xref="S2.SS3.SSS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.5.m5.1.1.2.1.cmml" xref="S2.SS3.SSS3.p2.5.m5.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p2.5.m5.1.1.2.2.cmml" xref="S2.SS3.SSS3.p2.5.m5.1.1.2.2">ğª</ci><ci id="S2.SS3.SSS3.p2.5.m5.1.1.2.3.cmml" xref="S2.SS3.SSS3.p2.5.m5.1.1.2.3">â€²</ci></apply><ci id="S2.SS3.SSS3.p2.5.m5.1.1.3.cmml" xref="S2.SS3.SSS3.p2.5.m5.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p2.5.m5.1c">\mathbf{q}^{\prime}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p2.5.m5.1d">bold_q start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and generate <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p2.6.m6.1"><semantics id="S2.SS3.SSS3.p2.6.m6.1a"><mi id="S2.SS3.SSS3.p2.6.m6.1.1" xref="S2.SS3.SSS3.p2.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p2.6.m6.1b"><ci id="S2.SS3.SSS3.p2.6.m6.1.1.cmml" xref="S2.SS3.SSS3.p2.6.m6.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p2.6.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p2.6.m6.1d">italic_K</annotation></semantics></math> corresponding latent vectors <math alttext="\{\mathbf{a}^{k}_{j}\}^{K}_{k=1}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p2.7.m7.1"><semantics id="S2.SS3.SSS3.p2.7.m7.1a"><msubsup id="S2.SS3.SSS3.p2.7.m7.1.1" xref="S2.SS3.SSS3.p2.7.m7.1.1.cmml"><mrow id="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1" xref="S2.SS3.SSS3.p2.7.m7.1.1.1.1.2.cmml"><mo id="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.2" stretchy="false" xref="S2.SS3.SSS3.p2.7.m7.1.1.1.1.2.cmml">{</mo><msubsup id="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1" xref="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1.cmml"><mi id="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1.2.2" xref="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1.2.2.cmml">ğš</mi><mi id="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1.3" xref="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1.3.cmml">j</mi><mi id="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1.2.3" xref="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.3" stretchy="false" xref="S2.SS3.SSS3.p2.7.m7.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS3.SSS3.p2.7.m7.1.1.3" xref="S2.SS3.SSS3.p2.7.m7.1.1.3.cmml"><mi id="S2.SS3.SSS3.p2.7.m7.1.1.3.2" xref="S2.SS3.SSS3.p2.7.m7.1.1.3.2.cmml">k</mi><mo id="S2.SS3.SSS3.p2.7.m7.1.1.3.1" xref="S2.SS3.SSS3.p2.7.m7.1.1.3.1.cmml">=</mo><mn id="S2.SS3.SSS3.p2.7.m7.1.1.3.3" xref="S2.SS3.SSS3.p2.7.m7.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS3.SSS3.p2.7.m7.1.1.1.3" xref="S2.SS3.SSS3.p2.7.m7.1.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p2.7.m7.1b"><apply id="S2.SS3.SSS3.p2.7.m7.1.1.cmml" xref="S2.SS3.SSS3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.7.m7.1.1.2.cmml" xref="S2.SS3.SSS3.p2.7.m7.1.1">subscript</csymbol><apply id="S2.SS3.SSS3.p2.7.m7.1.1.1.cmml" xref="S2.SS3.SSS3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.7.m7.1.1.1.2.cmml" xref="S2.SS3.SSS3.p2.7.m7.1.1">superscript</csymbol><set id="S2.SS3.SSS3.p2.7.m7.1.1.1.1.2.cmml" xref="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1"><apply id="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1">subscript</csymbol><apply id="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1.2.cmml" xref="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1.2.1.cmml" xref="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1.2.2.cmml" xref="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1.2.2">ğš</ci><ci id="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1.2.3.cmml" xref="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1.2.3">ğ‘˜</ci></apply><ci id="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1.3.cmml" xref="S2.SS3.SSS3.p2.7.m7.1.1.1.1.1.1.3">ğ‘—</ci></apply></set><ci id="S2.SS3.SSS3.p2.7.m7.1.1.1.3.cmml" xref="S2.SS3.SSS3.p2.7.m7.1.1.1.3">ğ¾</ci></apply><apply id="S2.SS3.SSS3.p2.7.m7.1.1.3.cmml" xref="S2.SS3.SSS3.p2.7.m7.1.1.3"><eq id="S2.SS3.SSS3.p2.7.m7.1.1.3.1.cmml" xref="S2.SS3.SSS3.p2.7.m7.1.1.3.1"></eq><ci id="S2.SS3.SSS3.p2.7.m7.1.1.3.2.cmml" xref="S2.SS3.SSS3.p2.7.m7.1.1.3.2">ğ‘˜</ci><cn id="S2.SS3.SSS3.p2.7.m7.1.1.3.3.cmml" type="integer" xref="S2.SS3.SSS3.p2.7.m7.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p2.7.m7.1c">\{\mathbf{a}^{k}_{j}\}^{K}_{k=1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p2.7.m7.1d">{ bold_a start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT } start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT</annotation></semantics></math> as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx4">
<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{a}^{k}_{j}=\text{Enc}^{k}(\mathbf{q}^{\prime}_{j})=\text{%
MLP}^{k}(\mathbf{q}^{\prime}_{j})," class="ltx_Math" display="inline" id="S2.E4.m1.1"><semantics id="S2.E4.m1.1a"><mrow id="S2.E4.m1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml"><mrow id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml"><msubsup id="S2.E4.m1.1.1.1.1.4" xref="S2.E4.m1.1.1.1.1.4.cmml"><mi id="S2.E4.m1.1.1.1.1.4.2.2" xref="S2.E4.m1.1.1.1.1.4.2.2.cmml">ğš</mi><mi id="S2.E4.m1.1.1.1.1.4.3" xref="S2.E4.m1.1.1.1.1.4.3.cmml">j</mi><mi id="S2.E4.m1.1.1.1.1.4.2.3" xref="S2.E4.m1.1.1.1.1.4.2.3.cmml">k</mi></msubsup><mo id="S2.E4.m1.1.1.1.1.5" xref="S2.E4.m1.1.1.1.1.5.cmml">=</mo><mrow id="S2.E4.m1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.cmml"><msup id="S2.E4.m1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.3.cmml"><mtext id="S2.E4.m1.1.1.1.1.1.3.2" xref="S2.E4.m1.1.1.1.1.1.3.2a.cmml">Enc</mtext><mi id="S2.E4.m1.1.1.1.1.1.3.3" xref="S2.E4.m1.1.1.1.1.1.3.3.cmml">k</mi></msup><mo id="S2.E4.m1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.2.cmml">â¢</mo><mrow id="S2.E4.m1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E4.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.E4.m1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.2.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.cmml">ğª</mi><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3.cmml">j</mi><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.2.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.3.cmml">â€²</mo></msubsup><mo id="S2.E4.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.1.1.1.1.6" xref="S2.E4.m1.1.1.1.1.6.cmml">=</mo><mrow id="S2.E4.m1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.2.cmml"><msup id="S2.E4.m1.1.1.1.1.2.3" xref="S2.E4.m1.1.1.1.1.2.3.cmml"><mtext id="S2.E4.m1.1.1.1.1.2.3.2" xref="S2.E4.m1.1.1.1.1.2.3.2a.cmml">MLP</mtext><mi id="S2.E4.m1.1.1.1.1.2.3.3" xref="S2.E4.m1.1.1.1.1.2.3.3.cmml">k</mi></msup><mo id="S2.E4.m1.1.1.1.1.2.2" xref="S2.E4.m1.1.1.1.1.2.2.cmml">â¢</mo><mrow id="S2.E4.m1.1.1.1.1.2.1.1" xref="S2.E4.m1.1.1.1.1.2.1.1.1.cmml"><mo id="S2.E4.m1.1.1.1.1.2.1.1.2" stretchy="false" xref="S2.E4.m1.1.1.1.1.2.1.1.1.cmml">(</mo><msubsup id="S2.E4.m1.1.1.1.1.2.1.1.1" xref="S2.E4.m1.1.1.1.1.2.1.1.1.cmml"><mi id="S2.E4.m1.1.1.1.1.2.1.1.1.2.2" xref="S2.E4.m1.1.1.1.1.2.1.1.1.2.2.cmml">ğª</mi><mi id="S2.E4.m1.1.1.1.1.2.1.1.1.3" xref="S2.E4.m1.1.1.1.1.2.1.1.1.3.cmml">j</mi><mo id="S2.E4.m1.1.1.1.1.2.1.1.1.2.3" xref="S2.E4.m1.1.1.1.1.2.1.1.1.2.3.cmml">â€²</mo></msubsup><mo id="S2.E4.m1.1.1.1.1.2.1.1.3" stretchy="false" xref="S2.E4.m1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1"><and id="S2.E4.m1.1.1.1.1a.cmml" xref="S2.E4.m1.1.1.1"></and><apply id="S2.E4.m1.1.1.1.1b.cmml" xref="S2.E4.m1.1.1.1"><eq id="S2.E4.m1.1.1.1.1.5.cmml" xref="S2.E4.m1.1.1.1.1.5"></eq><apply id="S2.E4.m1.1.1.1.1.4.cmml" xref="S2.E4.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.4.1.cmml" xref="S2.E4.m1.1.1.1.1.4">subscript</csymbol><apply id="S2.E4.m1.1.1.1.1.4.2.cmml" xref="S2.E4.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.4.2.1.cmml" xref="S2.E4.m1.1.1.1.1.4">superscript</csymbol><ci id="S2.E4.m1.1.1.1.1.4.2.2.cmml" xref="S2.E4.m1.1.1.1.1.4.2.2">ğš</ci><ci id="S2.E4.m1.1.1.1.1.4.2.3.cmml" xref="S2.E4.m1.1.1.1.1.4.2.3">ğ‘˜</ci></apply><ci id="S2.E4.m1.1.1.1.1.4.3.cmml" xref="S2.E4.m1.1.1.1.1.4.3">ğ‘—</ci></apply><apply id="S2.E4.m1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1"><times id="S2.E4.m1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.2"></times><apply id="S2.E4.m1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.3.2a.cmml" xref="S2.E4.m1.1.1.1.1.1.3.2"><mtext id="S2.E4.m1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.1.1.3.2">Enc</mtext></ci><ci id="S2.E4.m1.1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.1.1.1.1.1.3.3">ğ‘˜</ci></apply><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.2">ğª</ci><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.3">â€²</ci></apply><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3">ğ‘—</ci></apply></apply></apply><apply id="S2.E4.m1.1.1.1.1c.cmml" xref="S2.E4.m1.1.1.1"><eq id="S2.E4.m1.1.1.1.1.6.cmml" xref="S2.E4.m1.1.1.1.1.6"></eq><share href="https://arxiv.org/html/2406.10450v2#S2.E4.m1.1.1.1.1.1.cmml" id="S2.E4.m1.1.1.1.1d.cmml" xref="S2.E4.m1.1.1.1"></share><apply id="S2.E4.m1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.2"><times id="S2.E4.m1.1.1.1.1.2.2.cmml" xref="S2.E4.m1.1.1.1.1.2.2"></times><apply id="S2.E4.m1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.2.3.1.cmml" xref="S2.E4.m1.1.1.1.1.2.3">superscript</csymbol><ci id="S2.E4.m1.1.1.1.1.2.3.2a.cmml" xref="S2.E4.m1.1.1.1.1.2.3.2"><mtext id="S2.E4.m1.1.1.1.1.2.3.2.cmml" xref="S2.E4.m1.1.1.1.1.2.3.2">MLP</mtext></ci><ci id="S2.E4.m1.1.1.1.1.2.3.3.cmml" xref="S2.E4.m1.1.1.1.1.2.3.3">ğ‘˜</ci></apply><apply id="S2.E4.m1.1.1.1.1.2.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.2.1.1">subscript</csymbol><apply id="S2.E4.m1.1.1.1.1.2.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S2.E4.m1.1.1.1.1.2.1.1">superscript</csymbol><ci id="S2.E4.m1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S2.E4.m1.1.1.1.1.2.1.1.1.2.2">ğª</ci><ci id="S2.E4.m1.1.1.1.1.2.1.1.1.2.3.cmml" xref="S2.E4.m1.1.1.1.1.2.1.1.1.2.3">â€²</ci></apply><ci id="S2.E4.m1.1.1.1.1.2.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.2.1.1.1.3">ğ‘—</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\displaystyle\mathbf{a}^{k}_{j}=\text{Enc}^{k}(\mathbf{q}^{\prime}_{j})=\text{%
MLP}^{k}(\mathbf{q}^{\prime}_{j}),</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.1d">bold_a start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = Enc start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( bold_q start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = MLP start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( bold_q start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS3.p2.10">where <math alttext="\mathbf{a}^{k}_{j}\in\mathbb{R}^{d_{c}}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p2.8.m1.1"><semantics id="S2.SS3.SSS3.p2.8.m1.1a"><mrow id="S2.SS3.SSS3.p2.8.m1.1.1" xref="S2.SS3.SSS3.p2.8.m1.1.1.cmml"><msubsup id="S2.SS3.SSS3.p2.8.m1.1.1.2" xref="S2.SS3.SSS3.p2.8.m1.1.1.2.cmml"><mi id="S2.SS3.SSS3.p2.8.m1.1.1.2.2.2" xref="S2.SS3.SSS3.p2.8.m1.1.1.2.2.2.cmml">ğš</mi><mi id="S2.SS3.SSS3.p2.8.m1.1.1.2.3" xref="S2.SS3.SSS3.p2.8.m1.1.1.2.3.cmml">j</mi><mi id="S2.SS3.SSS3.p2.8.m1.1.1.2.2.3" xref="S2.SS3.SSS3.p2.8.m1.1.1.2.2.3.cmml">k</mi></msubsup><mo id="S2.SS3.SSS3.p2.8.m1.1.1.1" xref="S2.SS3.SSS3.p2.8.m1.1.1.1.cmml">âˆˆ</mo><msup id="S2.SS3.SSS3.p2.8.m1.1.1.3" xref="S2.SS3.SSS3.p2.8.m1.1.1.3.cmml"><mi id="S2.SS3.SSS3.p2.8.m1.1.1.3.2" xref="S2.SS3.SSS3.p2.8.m1.1.1.3.2.cmml">â„</mi><msub id="S2.SS3.SSS3.p2.8.m1.1.1.3.3" xref="S2.SS3.SSS3.p2.8.m1.1.1.3.3.cmml"><mi id="S2.SS3.SSS3.p2.8.m1.1.1.3.3.2" xref="S2.SS3.SSS3.p2.8.m1.1.1.3.3.2.cmml">d</mi><mi id="S2.SS3.SSS3.p2.8.m1.1.1.3.3.3" xref="S2.SS3.SSS3.p2.8.m1.1.1.3.3.3.cmml">c</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p2.8.m1.1b"><apply id="S2.SS3.SSS3.p2.8.m1.1.1.cmml" xref="S2.SS3.SSS3.p2.8.m1.1.1"><in id="S2.SS3.SSS3.p2.8.m1.1.1.1.cmml" xref="S2.SS3.SSS3.p2.8.m1.1.1.1"></in><apply id="S2.SS3.SSS3.p2.8.m1.1.1.2.cmml" xref="S2.SS3.SSS3.p2.8.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.8.m1.1.1.2.1.cmml" xref="S2.SS3.SSS3.p2.8.m1.1.1.2">subscript</csymbol><apply id="S2.SS3.SSS3.p2.8.m1.1.1.2.2.cmml" xref="S2.SS3.SSS3.p2.8.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.8.m1.1.1.2.2.1.cmml" xref="S2.SS3.SSS3.p2.8.m1.1.1.2">superscript</csymbol><ci id="S2.SS3.SSS3.p2.8.m1.1.1.2.2.2.cmml" xref="S2.SS3.SSS3.p2.8.m1.1.1.2.2.2">ğš</ci><ci id="S2.SS3.SSS3.p2.8.m1.1.1.2.2.3.cmml" xref="S2.SS3.SSS3.p2.8.m1.1.1.2.2.3">ğ‘˜</ci></apply><ci id="S2.SS3.SSS3.p2.8.m1.1.1.2.3.cmml" xref="S2.SS3.SSS3.p2.8.m1.1.1.2.3">ğ‘—</ci></apply><apply id="S2.SS3.SSS3.p2.8.m1.1.1.3.cmml" xref="S2.SS3.SSS3.p2.8.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.8.m1.1.1.3.1.cmml" xref="S2.SS3.SSS3.p2.8.m1.1.1.3">superscript</csymbol><ci id="S2.SS3.SSS3.p2.8.m1.1.1.3.2.cmml" xref="S2.SS3.SSS3.p2.8.m1.1.1.3.2">â„</ci><apply id="S2.SS3.SSS3.p2.8.m1.1.1.3.3.cmml" xref="S2.SS3.SSS3.p2.8.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.8.m1.1.1.3.3.1.cmml" xref="S2.SS3.SSS3.p2.8.m1.1.1.3.3">subscript</csymbol><ci id="S2.SS3.SSS3.p2.8.m1.1.1.3.3.2.cmml" xref="S2.SS3.SSS3.p2.8.m1.1.1.3.3.2">ğ‘‘</ci><ci id="S2.SS3.SSS3.p2.8.m1.1.1.3.3.3.cmml" xref="S2.SS3.SSS3.p2.8.m1.1.1.3.3.3">ğ‘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p2.8.m1.1c">\mathbf{a}^{k}_{j}\in\mathbb{R}^{d_{c}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p2.8.m1.1d">bold_a start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, and each encoder <math alttext="\text{Enc}^{k}(\cdot)" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p2.9.m2.1"><semantics id="S2.SS3.SSS3.p2.9.m2.1a"><mrow id="S2.SS3.SSS3.p2.9.m2.1.2" xref="S2.SS3.SSS3.p2.9.m2.1.2.cmml"><msup id="S2.SS3.SSS3.p2.9.m2.1.2.2" xref="S2.SS3.SSS3.p2.9.m2.1.2.2.cmml"><mtext id="S2.SS3.SSS3.p2.9.m2.1.2.2.2" xref="S2.SS3.SSS3.p2.9.m2.1.2.2.2a.cmml">Enc</mtext><mi id="S2.SS3.SSS3.p2.9.m2.1.2.2.3" xref="S2.SS3.SSS3.p2.9.m2.1.2.2.3.cmml">k</mi></msup><mo id="S2.SS3.SSS3.p2.9.m2.1.2.1" xref="S2.SS3.SSS3.p2.9.m2.1.2.1.cmml">â¢</mo><mrow id="S2.SS3.SSS3.p2.9.m2.1.2.3.2" xref="S2.SS3.SSS3.p2.9.m2.1.2.cmml"><mo id="S2.SS3.SSS3.p2.9.m2.1.2.3.2.1" stretchy="false" xref="S2.SS3.SSS3.p2.9.m2.1.2.cmml">(</mo><mo id="S2.SS3.SSS3.p2.9.m2.1.1" lspace="0em" rspace="0em" xref="S2.SS3.SSS3.p2.9.m2.1.1.cmml">â‹…</mo><mo id="S2.SS3.SSS3.p2.9.m2.1.2.3.2.2" stretchy="false" xref="S2.SS3.SSS3.p2.9.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p2.9.m2.1b"><apply id="S2.SS3.SSS3.p2.9.m2.1.2.cmml" xref="S2.SS3.SSS3.p2.9.m2.1.2"><times id="S2.SS3.SSS3.p2.9.m2.1.2.1.cmml" xref="S2.SS3.SSS3.p2.9.m2.1.2.1"></times><apply id="S2.SS3.SSS3.p2.9.m2.1.2.2.cmml" xref="S2.SS3.SSS3.p2.9.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.9.m2.1.2.2.1.cmml" xref="S2.SS3.SSS3.p2.9.m2.1.2.2">superscript</csymbol><ci id="S2.SS3.SSS3.p2.9.m2.1.2.2.2a.cmml" xref="S2.SS3.SSS3.p2.9.m2.1.2.2.2"><mtext id="S2.SS3.SSS3.p2.9.m2.1.2.2.2.cmml" xref="S2.SS3.SSS3.p2.9.m2.1.2.2.2">Enc</mtext></ci><ci id="S2.SS3.SSS3.p2.9.m2.1.2.2.3.cmml" xref="S2.SS3.SSS3.p2.9.m2.1.2.2.3">ğ‘˜</ci></apply><ci id="S2.SS3.SSS3.p2.9.m2.1.1.cmml" xref="S2.SS3.SSS3.p2.9.m2.1.1">â‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p2.9.m2.1c">\text{Enc}^{k}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p2.9.m2.1d">Enc start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( â‹… )</annotation></semantics></math> can be implemented as a multilayer perceptron network (MLP) with three hidden layers.
Powered by different encoders, the proposed <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p2.10.m3.1"><semantics id="S2.SS3.SSS3.p2.10.m3.1a"><mi id="S2.SS3.SSS3.p2.10.m3.1.1" xref="S2.SS3.SSS3.p2.10.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p2.10.m3.1b"><ci id="S2.SS3.SSS3.p2.10.m3.1.1.cmml" xref="S2.SS3.SSS3.p2.10.m3.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p2.10.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p2.10.m3.1d">italic_K</annotation></semantics></math>-way Encoder enables multiple attentions and uncovers different patterns on the inputs to enhance the generalization capability towards users&amp;items representations.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS3.p3">
<p class="ltx_p" id="S2.SS3.SSS3.p3.10">The next step is to quantize the encoded vectors <math alttext="\{\mathbf{a}^{k}_{j}\}^{K}_{k=1}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p3.1.m1.1"><semantics id="S2.SS3.SSS3.p3.1.m1.1a"><msubsup id="S2.SS3.SSS3.p3.1.m1.1.1" xref="S2.SS3.SSS3.p3.1.m1.1.1.cmml"><mrow id="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1" xref="S2.SS3.SSS3.p3.1.m1.1.1.1.1.2.cmml"><mo id="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.2" stretchy="false" xref="S2.SS3.SSS3.p3.1.m1.1.1.1.1.2.cmml">{</mo><msubsup id="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1" xref="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.cmml"><mi id="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.2.2" xref="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.2.2.cmml">ğš</mi><mi id="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.3" xref="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.3.cmml">j</mi><mi id="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.2.3" xref="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.3" stretchy="false" xref="S2.SS3.SSS3.p3.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS3.SSS3.p3.1.m1.1.1.3" xref="S2.SS3.SSS3.p3.1.m1.1.1.3.cmml"><mi id="S2.SS3.SSS3.p3.1.m1.1.1.3.2" xref="S2.SS3.SSS3.p3.1.m1.1.1.3.2.cmml">k</mi><mo id="S2.SS3.SSS3.p3.1.m1.1.1.3.1" xref="S2.SS3.SSS3.p3.1.m1.1.1.3.1.cmml">=</mo><mn id="S2.SS3.SSS3.p3.1.m1.1.1.3.3" xref="S2.SS3.SSS3.p3.1.m1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS3.SSS3.p3.1.m1.1.1.1.3" xref="S2.SS3.SSS3.p3.1.m1.1.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p3.1.m1.1b"><apply id="S2.SS3.SSS3.p3.1.m1.1.1.cmml" xref="S2.SS3.SSS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.1.m1.1.1.2.cmml" xref="S2.SS3.SSS3.p3.1.m1.1.1">subscript</csymbol><apply id="S2.SS3.SSS3.p3.1.m1.1.1.1.cmml" xref="S2.SS3.SSS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.1.m1.1.1.1.2.cmml" xref="S2.SS3.SSS3.p3.1.m1.1.1">superscript</csymbol><set id="S2.SS3.SSS3.p3.1.m1.1.1.1.1.2.cmml" xref="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1"><apply id="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.2.2">ğš</ci><ci id="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.2.3">ğ‘˜</ci></apply><ci id="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.3">ğ‘—</ci></apply></set><ci id="S2.SS3.SSS3.p3.1.m1.1.1.1.3.cmml" xref="S2.SS3.SSS3.p3.1.m1.1.1.1.3">ğ¾</ci></apply><apply id="S2.SS3.SSS3.p3.1.m1.1.1.3.cmml" xref="S2.SS3.SSS3.p3.1.m1.1.1.3"><eq id="S2.SS3.SSS3.p3.1.m1.1.1.3.1.cmml" xref="S2.SS3.SSS3.p3.1.m1.1.1.3.1"></eq><ci id="S2.SS3.SSS3.p3.1.m1.1.1.3.2.cmml" xref="S2.SS3.SSS3.p3.1.m1.1.1.3.2">ğ‘˜</ci><cn id="S2.SS3.SSS3.p3.1.m1.1.1.3.3.cmml" type="integer" xref="S2.SS3.SSS3.p3.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p3.1.m1.1c">\{\mathbf{a}^{k}_{j}\}^{K}_{k=1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p3.1.m1.1d">{ bold_a start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT } start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT</annotation></semantics></math> into discrete tokens (i.e., indices) by looking up nearest neighbors in the learnable <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p3.2.m2.1"><semantics id="S2.SS3.SSS3.p3.2.m2.1a"><mi id="S2.SS3.SSS3.p3.2.m2.1.1" xref="S2.SS3.SSS3.p3.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p3.2.m2.1b"><ci id="S2.SS3.SSS3.p3.2.m2.1.1.cmml" xref="S2.SS3.SSS3.p3.2.m2.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p3.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p3.2.m2.1d">italic_K</annotation></semantics></math>-way codebook <math alttext="\mathbf{C}=\{\mathbf{c}^{1},\mathbf{c}^{2},...,\mathbf{c}^{k},...,\mathbf{c}^{%
K}\}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p3.3.m3.6"><semantics id="S2.SS3.SSS3.p3.3.m3.6a"><mrow id="S2.SS3.SSS3.p3.3.m3.6.6" xref="S2.SS3.SSS3.p3.3.m3.6.6.cmml"><mi id="S2.SS3.SSS3.p3.3.m3.6.6.6" xref="S2.SS3.SSS3.p3.3.m3.6.6.6.cmml">ğ‚</mi><mo id="S2.SS3.SSS3.p3.3.m3.6.6.5" xref="S2.SS3.SSS3.p3.3.m3.6.6.5.cmml">=</mo><mrow id="S2.SS3.SSS3.p3.3.m3.6.6.4.4" xref="S2.SS3.SSS3.p3.3.m3.6.6.4.5.cmml"><mo id="S2.SS3.SSS3.p3.3.m3.6.6.4.4.5" stretchy="false" xref="S2.SS3.SSS3.p3.3.m3.6.6.4.5.cmml">{</mo><msup id="S2.SS3.SSS3.p3.3.m3.3.3.1.1.1" xref="S2.SS3.SSS3.p3.3.m3.3.3.1.1.1.cmml"><mi id="S2.SS3.SSS3.p3.3.m3.3.3.1.1.1.2" xref="S2.SS3.SSS3.p3.3.m3.3.3.1.1.1.2.cmml">ğœ</mi><mn id="S2.SS3.SSS3.p3.3.m3.3.3.1.1.1.3" xref="S2.SS3.SSS3.p3.3.m3.3.3.1.1.1.3.cmml">1</mn></msup><mo id="S2.SS3.SSS3.p3.3.m3.6.6.4.4.6" xref="S2.SS3.SSS3.p3.3.m3.6.6.4.5.cmml">,</mo><msup id="S2.SS3.SSS3.p3.3.m3.4.4.2.2.2" xref="S2.SS3.SSS3.p3.3.m3.4.4.2.2.2.cmml"><mi id="S2.SS3.SSS3.p3.3.m3.4.4.2.2.2.2" xref="S2.SS3.SSS3.p3.3.m3.4.4.2.2.2.2.cmml">ğœ</mi><mn id="S2.SS3.SSS3.p3.3.m3.4.4.2.2.2.3" xref="S2.SS3.SSS3.p3.3.m3.4.4.2.2.2.3.cmml">2</mn></msup><mo id="S2.SS3.SSS3.p3.3.m3.6.6.4.4.7" xref="S2.SS3.SSS3.p3.3.m3.6.6.4.5.cmml">,</mo><mi id="S2.SS3.SSS3.p3.3.m3.1.1" mathvariant="normal" xref="S2.SS3.SSS3.p3.3.m3.1.1.cmml">â€¦</mi><mo id="S2.SS3.SSS3.p3.3.m3.6.6.4.4.8" xref="S2.SS3.SSS3.p3.3.m3.6.6.4.5.cmml">,</mo><msup id="S2.SS3.SSS3.p3.3.m3.5.5.3.3.3" xref="S2.SS3.SSS3.p3.3.m3.5.5.3.3.3.cmml"><mi id="S2.SS3.SSS3.p3.3.m3.5.5.3.3.3.2" xref="S2.SS3.SSS3.p3.3.m3.5.5.3.3.3.2.cmml">ğœ</mi><mi id="S2.SS3.SSS3.p3.3.m3.5.5.3.3.3.3" xref="S2.SS3.SSS3.p3.3.m3.5.5.3.3.3.3.cmml">k</mi></msup><mo id="S2.SS3.SSS3.p3.3.m3.6.6.4.4.9" xref="S2.SS3.SSS3.p3.3.m3.6.6.4.5.cmml">,</mo><mi id="S2.SS3.SSS3.p3.3.m3.2.2" mathvariant="normal" xref="S2.SS3.SSS3.p3.3.m3.2.2.cmml">â€¦</mi><mo id="S2.SS3.SSS3.p3.3.m3.6.6.4.4.10" xref="S2.SS3.SSS3.p3.3.m3.6.6.4.5.cmml">,</mo><msup id="S2.SS3.SSS3.p3.3.m3.6.6.4.4.4" xref="S2.SS3.SSS3.p3.3.m3.6.6.4.4.4.cmml"><mi id="S2.SS3.SSS3.p3.3.m3.6.6.4.4.4.2" xref="S2.SS3.SSS3.p3.3.m3.6.6.4.4.4.2.cmml">ğœ</mi><mi id="S2.SS3.SSS3.p3.3.m3.6.6.4.4.4.3" xref="S2.SS3.SSS3.p3.3.m3.6.6.4.4.4.3.cmml">K</mi></msup><mo id="S2.SS3.SSS3.p3.3.m3.6.6.4.4.11" stretchy="false" xref="S2.SS3.SSS3.p3.3.m3.6.6.4.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p3.3.m3.6b"><apply id="S2.SS3.SSS3.p3.3.m3.6.6.cmml" xref="S2.SS3.SSS3.p3.3.m3.6.6"><eq id="S2.SS3.SSS3.p3.3.m3.6.6.5.cmml" xref="S2.SS3.SSS3.p3.3.m3.6.6.5"></eq><ci id="S2.SS3.SSS3.p3.3.m3.6.6.6.cmml" xref="S2.SS3.SSS3.p3.3.m3.6.6.6">ğ‚</ci><set id="S2.SS3.SSS3.p3.3.m3.6.6.4.5.cmml" xref="S2.SS3.SSS3.p3.3.m3.6.6.4.4"><apply id="S2.SS3.SSS3.p3.3.m3.3.3.1.1.1.cmml" xref="S2.SS3.SSS3.p3.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.3.m3.3.3.1.1.1.1.cmml" xref="S2.SS3.SSS3.p3.3.m3.3.3.1.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p3.3.m3.3.3.1.1.1.2.cmml" xref="S2.SS3.SSS3.p3.3.m3.3.3.1.1.1.2">ğœ</ci><cn id="S2.SS3.SSS3.p3.3.m3.3.3.1.1.1.3.cmml" type="integer" xref="S2.SS3.SSS3.p3.3.m3.3.3.1.1.1.3">1</cn></apply><apply id="S2.SS3.SSS3.p3.3.m3.4.4.2.2.2.cmml" xref="S2.SS3.SSS3.p3.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.3.m3.4.4.2.2.2.1.cmml" xref="S2.SS3.SSS3.p3.3.m3.4.4.2.2.2">superscript</csymbol><ci id="S2.SS3.SSS3.p3.3.m3.4.4.2.2.2.2.cmml" xref="S2.SS3.SSS3.p3.3.m3.4.4.2.2.2.2">ğœ</ci><cn id="S2.SS3.SSS3.p3.3.m3.4.4.2.2.2.3.cmml" type="integer" xref="S2.SS3.SSS3.p3.3.m3.4.4.2.2.2.3">2</cn></apply><ci id="S2.SS3.SSS3.p3.3.m3.1.1.cmml" xref="S2.SS3.SSS3.p3.3.m3.1.1">â€¦</ci><apply id="S2.SS3.SSS3.p3.3.m3.5.5.3.3.3.cmml" xref="S2.SS3.SSS3.p3.3.m3.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.3.m3.5.5.3.3.3.1.cmml" xref="S2.SS3.SSS3.p3.3.m3.5.5.3.3.3">superscript</csymbol><ci id="S2.SS3.SSS3.p3.3.m3.5.5.3.3.3.2.cmml" xref="S2.SS3.SSS3.p3.3.m3.5.5.3.3.3.2">ğœ</ci><ci id="S2.SS3.SSS3.p3.3.m3.5.5.3.3.3.3.cmml" xref="S2.SS3.SSS3.p3.3.m3.5.5.3.3.3.3">ğ‘˜</ci></apply><ci id="S2.SS3.SSS3.p3.3.m3.2.2.cmml" xref="S2.SS3.SSS3.p3.3.m3.2.2">â€¦</ci><apply id="S2.SS3.SSS3.p3.3.m3.6.6.4.4.4.cmml" xref="S2.SS3.SSS3.p3.3.m3.6.6.4.4.4"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.3.m3.6.6.4.4.4.1.cmml" xref="S2.SS3.SSS3.p3.3.m3.6.6.4.4.4">superscript</csymbol><ci id="S2.SS3.SSS3.p3.3.m3.6.6.4.4.4.2.cmml" xref="S2.SS3.SSS3.p3.3.m3.6.6.4.4.4.2">ğœ</ci><ci id="S2.SS3.SSS3.p3.3.m3.6.6.4.4.4.3.cmml" xref="S2.SS3.SSS3.p3.3.m3.6.6.4.4.4.3">ğ¾</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p3.3.m3.6c">\mathbf{C}=\{\mathbf{c}^{1},\mathbf{c}^{2},...,\mathbf{c}^{k},...,\mathbf{c}^{%
K}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p3.3.m3.6d">bold_C = { bold_c start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , bold_c start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , â€¦ , bold_c start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT , â€¦ , bold_c start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT }</annotation></semantics></math>.
More specifically, given the item <math alttext="v_{j}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p3.4.m4.1"><semantics id="S2.SS3.SSS3.p3.4.m4.1a"><msub id="S2.SS3.SSS3.p3.4.m4.1.1" xref="S2.SS3.SSS3.p3.4.m4.1.1.cmml"><mi id="S2.SS3.SSS3.p3.4.m4.1.1.2" xref="S2.SS3.SSS3.p3.4.m4.1.1.2.cmml">v</mi><mi id="S2.SS3.SSS3.p3.4.m4.1.1.3" xref="S2.SS3.SSS3.p3.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p3.4.m4.1b"><apply id="S2.SS3.SSS3.p3.4.m4.1.1.cmml" xref="S2.SS3.SSS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.4.m4.1.1.1.cmml" xref="S2.SS3.SSS3.p3.4.m4.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p3.4.m4.1.1.2.cmml" xref="S2.SS3.SSS3.p3.4.m4.1.1.2">ğ‘£</ci><ci id="S2.SS3.SSS3.p3.4.m4.1.1.3.cmml" xref="S2.SS3.SSS3.p3.4.m4.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p3.4.m4.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p3.4.m4.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and a sub-codebook <math alttext="\mathbf{c}^{k}\in\mathbb{R}^{L\times d_{c}}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p3.5.m5.1"><semantics id="S2.SS3.SSS3.p3.5.m5.1a"><mrow id="S2.SS3.SSS3.p3.5.m5.1.1" xref="S2.SS3.SSS3.p3.5.m5.1.1.cmml"><msup id="S2.SS3.SSS3.p3.5.m5.1.1.2" xref="S2.SS3.SSS3.p3.5.m5.1.1.2.cmml"><mi id="S2.SS3.SSS3.p3.5.m5.1.1.2.2" xref="S2.SS3.SSS3.p3.5.m5.1.1.2.2.cmml">ğœ</mi><mi id="S2.SS3.SSS3.p3.5.m5.1.1.2.3" xref="S2.SS3.SSS3.p3.5.m5.1.1.2.3.cmml">k</mi></msup><mo id="S2.SS3.SSS3.p3.5.m5.1.1.1" xref="S2.SS3.SSS3.p3.5.m5.1.1.1.cmml">âˆˆ</mo><msup id="S2.SS3.SSS3.p3.5.m5.1.1.3" xref="S2.SS3.SSS3.p3.5.m5.1.1.3.cmml"><mi id="S2.SS3.SSS3.p3.5.m5.1.1.3.2" xref="S2.SS3.SSS3.p3.5.m5.1.1.3.2.cmml">â„</mi><mrow id="S2.SS3.SSS3.p3.5.m5.1.1.3.3" xref="S2.SS3.SSS3.p3.5.m5.1.1.3.3.cmml"><mi id="S2.SS3.SSS3.p3.5.m5.1.1.3.3.2" xref="S2.SS3.SSS3.p3.5.m5.1.1.3.3.2.cmml">L</mi><mo id="S2.SS3.SSS3.p3.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS3.p3.5.m5.1.1.3.3.1.cmml">Ã—</mo><msub id="S2.SS3.SSS3.p3.5.m5.1.1.3.3.3" xref="S2.SS3.SSS3.p3.5.m5.1.1.3.3.3.cmml"><mi id="S2.SS3.SSS3.p3.5.m5.1.1.3.3.3.2" xref="S2.SS3.SSS3.p3.5.m5.1.1.3.3.3.2.cmml">d</mi><mi id="S2.SS3.SSS3.p3.5.m5.1.1.3.3.3.3" xref="S2.SS3.SSS3.p3.5.m5.1.1.3.3.3.3.cmml">c</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p3.5.m5.1b"><apply id="S2.SS3.SSS3.p3.5.m5.1.1.cmml" xref="S2.SS3.SSS3.p3.5.m5.1.1"><in id="S2.SS3.SSS3.p3.5.m5.1.1.1.cmml" xref="S2.SS3.SSS3.p3.5.m5.1.1.1"></in><apply id="S2.SS3.SSS3.p3.5.m5.1.1.2.cmml" xref="S2.SS3.SSS3.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.5.m5.1.1.2.1.cmml" xref="S2.SS3.SSS3.p3.5.m5.1.1.2">superscript</csymbol><ci id="S2.SS3.SSS3.p3.5.m5.1.1.2.2.cmml" xref="S2.SS3.SSS3.p3.5.m5.1.1.2.2">ğœ</ci><ci id="S2.SS3.SSS3.p3.5.m5.1.1.2.3.cmml" xref="S2.SS3.SSS3.p3.5.m5.1.1.2.3">ğ‘˜</ci></apply><apply id="S2.SS3.SSS3.p3.5.m5.1.1.3.cmml" xref="S2.SS3.SSS3.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.5.m5.1.1.3.1.cmml" xref="S2.SS3.SSS3.p3.5.m5.1.1.3">superscript</csymbol><ci id="S2.SS3.SSS3.p3.5.m5.1.1.3.2.cmml" xref="S2.SS3.SSS3.p3.5.m5.1.1.3.2">â„</ci><apply id="S2.SS3.SSS3.p3.5.m5.1.1.3.3.cmml" xref="S2.SS3.SSS3.p3.5.m5.1.1.3.3"><times id="S2.SS3.SSS3.p3.5.m5.1.1.3.3.1.cmml" xref="S2.SS3.SSS3.p3.5.m5.1.1.3.3.1"></times><ci id="S2.SS3.SSS3.p3.5.m5.1.1.3.3.2.cmml" xref="S2.SS3.SSS3.p3.5.m5.1.1.3.3.2">ğ¿</ci><apply id="S2.SS3.SSS3.p3.5.m5.1.1.3.3.3.cmml" xref="S2.SS3.SSS3.p3.5.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.5.m5.1.1.3.3.3.1.cmml" xref="S2.SS3.SSS3.p3.5.m5.1.1.3.3.3">subscript</csymbol><ci id="S2.SS3.SSS3.p3.5.m5.1.1.3.3.3.2.cmml" xref="S2.SS3.SSS3.p3.5.m5.1.1.3.3.3.2">ğ‘‘</ci><ci id="S2.SS3.SSS3.p3.5.m5.1.1.3.3.3.3.cmml" xref="S2.SS3.SSS3.p3.5.m5.1.1.3.3.3.3">ğ‘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p3.5.m5.1c">\mathbf{c}^{k}\in\mathbb{R}^{L\times d_{c}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p3.5.m5.1d">bold_c start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_L Ã— italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> from the <math alttext="k" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p3.6.m6.1"><semantics id="S2.SS3.SSS3.p3.6.m6.1a"><mi id="S2.SS3.SSS3.p3.6.m6.1.1" xref="S2.SS3.SSS3.p3.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p3.6.m6.1b"><ci id="S2.SS3.SSS3.p3.6.m6.1.1.cmml" xref="S2.SS3.SSS3.p3.6.m6.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p3.6.m6.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p3.6.m6.1d">italic_k</annotation></semantics></math>-th encoder <math alttext="\text{Enc}^{k}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p3.7.m7.1"><semantics id="S2.SS3.SSS3.p3.7.m7.1a"><msup id="S2.SS3.SSS3.p3.7.m7.1.1" xref="S2.SS3.SSS3.p3.7.m7.1.1.cmml"><mtext id="S2.SS3.SSS3.p3.7.m7.1.1.2" xref="S2.SS3.SSS3.p3.7.m7.1.1.2a.cmml">Enc</mtext><mi id="S2.SS3.SSS3.p3.7.m7.1.1.3" xref="S2.SS3.SSS3.p3.7.m7.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p3.7.m7.1b"><apply id="S2.SS3.SSS3.p3.7.m7.1.1.cmml" xref="S2.SS3.SSS3.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.7.m7.1.1.1.cmml" xref="S2.SS3.SSS3.p3.7.m7.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p3.7.m7.1.1.2a.cmml" xref="S2.SS3.SSS3.p3.7.m7.1.1.2"><mtext id="S2.SS3.SSS3.p3.7.m7.1.1.2.cmml" xref="S2.SS3.SSS3.p3.7.m7.1.1.2">Enc</mtext></ci><ci id="S2.SS3.SSS3.p3.7.m7.1.1.3.cmml" xref="S2.SS3.SSS3.p3.7.m7.1.1.3">ğ‘˜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p3.7.m7.1c">\text{Enc}^{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p3.7.m7.1d">Enc start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>,
a practical approach is leveraging the Euclidean distance to calculate similarity scores between the encoded vector <math alttext="\mathbf{a}^{k}_{j}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p3.8.m8.1"><semantics id="S2.SS3.SSS3.p3.8.m8.1a"><msubsup id="S2.SS3.SSS3.p3.8.m8.1.1" xref="S2.SS3.SSS3.p3.8.m8.1.1.cmml"><mi id="S2.SS3.SSS3.p3.8.m8.1.1.2.2" xref="S2.SS3.SSS3.p3.8.m8.1.1.2.2.cmml">ğš</mi><mi id="S2.SS3.SSS3.p3.8.m8.1.1.3" xref="S2.SS3.SSS3.p3.8.m8.1.1.3.cmml">j</mi><mi id="S2.SS3.SSS3.p3.8.m8.1.1.2.3" xref="S2.SS3.SSS3.p3.8.m8.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p3.8.m8.1b"><apply id="S2.SS3.SSS3.p3.8.m8.1.1.cmml" xref="S2.SS3.SSS3.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.8.m8.1.1.1.cmml" xref="S2.SS3.SSS3.p3.8.m8.1.1">subscript</csymbol><apply id="S2.SS3.SSS3.p3.8.m8.1.1.2.cmml" xref="S2.SS3.SSS3.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.8.m8.1.1.2.1.cmml" xref="S2.SS3.SSS3.p3.8.m8.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p3.8.m8.1.1.2.2.cmml" xref="S2.SS3.SSS3.p3.8.m8.1.1.2.2">ğš</ci><ci id="S2.SS3.SSS3.p3.8.m8.1.1.2.3.cmml" xref="S2.SS3.SSS3.p3.8.m8.1.1.2.3">ğ‘˜</ci></apply><ci id="S2.SS3.SSS3.p3.8.m8.1.1.3.cmml" xref="S2.SS3.SSS3.p3.8.m8.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p3.8.m8.1c">\mathbf{a}^{k}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p3.8.m8.1d">bold_a start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and all the codeword embeddings <math alttext="\{\mathbf{c}^{k}_{l}\}^{L}_{l=1}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p3.9.m9.1"><semantics id="S2.SS3.SSS3.p3.9.m9.1a"><msubsup id="S2.SS3.SSS3.p3.9.m9.1.1" xref="S2.SS3.SSS3.p3.9.m9.1.1.cmml"><mrow id="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1" xref="S2.SS3.SSS3.p3.9.m9.1.1.1.1.2.cmml"><mo id="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.2" stretchy="false" xref="S2.SS3.SSS3.p3.9.m9.1.1.1.1.2.cmml">{</mo><msubsup id="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1" xref="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1.cmml"><mi id="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1.2.2" xref="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1.2.2.cmml">ğœ</mi><mi id="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1.3" xref="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1.3.cmml">l</mi><mi id="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1.2.3" xref="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.3" stretchy="false" xref="S2.SS3.SSS3.p3.9.m9.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS3.SSS3.p3.9.m9.1.1.3" xref="S2.SS3.SSS3.p3.9.m9.1.1.3.cmml"><mi id="S2.SS3.SSS3.p3.9.m9.1.1.3.2" xref="S2.SS3.SSS3.p3.9.m9.1.1.3.2.cmml">l</mi><mo id="S2.SS3.SSS3.p3.9.m9.1.1.3.1" xref="S2.SS3.SSS3.p3.9.m9.1.1.3.1.cmml">=</mo><mn id="S2.SS3.SSS3.p3.9.m9.1.1.3.3" xref="S2.SS3.SSS3.p3.9.m9.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS3.SSS3.p3.9.m9.1.1.1.3" xref="S2.SS3.SSS3.p3.9.m9.1.1.1.3.cmml">L</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p3.9.m9.1b"><apply id="S2.SS3.SSS3.p3.9.m9.1.1.cmml" xref="S2.SS3.SSS3.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.9.m9.1.1.2.cmml" xref="S2.SS3.SSS3.p3.9.m9.1.1">subscript</csymbol><apply id="S2.SS3.SSS3.p3.9.m9.1.1.1.cmml" xref="S2.SS3.SSS3.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.9.m9.1.1.1.2.cmml" xref="S2.SS3.SSS3.p3.9.m9.1.1">superscript</csymbol><set id="S2.SS3.SSS3.p3.9.m9.1.1.1.1.2.cmml" xref="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1"><apply id="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1">subscript</csymbol><apply id="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1.2.cmml" xref="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1.2.1.cmml" xref="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1.2.2.cmml" xref="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1.2.2">ğœ</ci><ci id="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1.2.3.cmml" xref="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1.2.3">ğ‘˜</ci></apply><ci id="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1.3.cmml" xref="S2.SS3.SSS3.p3.9.m9.1.1.1.1.1.1.3">ğ‘™</ci></apply></set><ci id="S2.SS3.SSS3.p3.9.m9.1.1.1.3.cmml" xref="S2.SS3.SSS3.p3.9.m9.1.1.1.3">ğ¿</ci></apply><apply id="S2.SS3.SSS3.p3.9.m9.1.1.3.cmml" xref="S2.SS3.SSS3.p3.9.m9.1.1.3"><eq id="S2.SS3.SSS3.p3.9.m9.1.1.3.1.cmml" xref="S2.SS3.SSS3.p3.9.m9.1.1.3.1"></eq><ci id="S2.SS3.SSS3.p3.9.m9.1.1.3.2.cmml" xref="S2.SS3.SSS3.p3.9.m9.1.1.3.2">ğ‘™</ci><cn id="S2.SS3.SSS3.p3.9.m9.1.1.3.3.cmml" type="integer" xref="S2.SS3.SSS3.p3.9.m9.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p3.9.m9.1c">\{\mathbf{c}^{k}_{l}\}^{L}_{l=1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p3.9.m9.1d">{ bold_c start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT } start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT</annotation></semantics></math>, so as to find the nearest embedding (i.e., token embedding) that can be used to effectively represent the encoded vector <math alttext="\mathbf{a}^{k}_{j}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p3.10.m10.1"><semantics id="S2.SS3.SSS3.p3.10.m10.1a"><msubsup id="S2.SS3.SSS3.p3.10.m10.1.1" xref="S2.SS3.SSS3.p3.10.m10.1.1.cmml"><mi id="S2.SS3.SSS3.p3.10.m10.1.1.2.2" xref="S2.SS3.SSS3.p3.10.m10.1.1.2.2.cmml">ğš</mi><mi id="S2.SS3.SSS3.p3.10.m10.1.1.3" xref="S2.SS3.SSS3.p3.10.m10.1.1.3.cmml">j</mi><mi id="S2.SS3.SSS3.p3.10.m10.1.1.2.3" xref="S2.SS3.SSS3.p3.10.m10.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p3.10.m10.1b"><apply id="S2.SS3.SSS3.p3.10.m10.1.1.cmml" xref="S2.SS3.SSS3.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.10.m10.1.1.1.cmml" xref="S2.SS3.SSS3.p3.10.m10.1.1">subscript</csymbol><apply id="S2.SS3.SSS3.p3.10.m10.1.1.2.cmml" xref="S2.SS3.SSS3.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.10.m10.1.1.2.1.cmml" xref="S2.SS3.SSS3.p3.10.m10.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p3.10.m10.1.1.2.2.cmml" xref="S2.SS3.SSS3.p3.10.m10.1.1.2.2">ğš</ci><ci id="S2.SS3.SSS3.p3.10.m10.1.1.2.3.cmml" xref="S2.SS3.SSS3.p3.10.m10.1.1.2.3">ğ‘˜</ci></apply><ci id="S2.SS3.SSS3.p3.10.m10.1.1.3.cmml" xref="S2.SS3.SSS3.p3.10.m10.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p3.10.m10.1c">\mathbf{a}^{k}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p3.10.m10.1d">bold_a start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx5">
<tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle w^{k}_{j}=\text{arg min}_{l}\|\mathbf{a}^{k}_{j}-\mathbf{c}_{l}^%
{k}\|^{2}," class="ltx_Math" display="inline" id="S2.E5.m1.1"><semantics id="S2.E5.m1.1a"><mrow id="S2.E5.m1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml"><mrow id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml"><msubsup id="S2.E5.m1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.3.cmml"><mi id="S2.E5.m1.1.1.1.1.3.2.2" xref="S2.E5.m1.1.1.1.1.3.2.2.cmml">w</mi><mi id="S2.E5.m1.1.1.1.1.3.3" xref="S2.E5.m1.1.1.1.1.3.3.cmml">j</mi><mi id="S2.E5.m1.1.1.1.1.3.2.3" xref="S2.E5.m1.1.1.1.1.3.2.3.cmml">k</mi></msubsup><mo id="S2.E5.m1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E5.m1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.cmml"><msub id="S2.E5.m1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.3.cmml"><mtext id="S2.E5.m1.1.1.1.1.1.3.2" xref="S2.E5.m1.1.1.1.1.1.3.2a.cmml">arg min</mtext><mi id="S2.E5.m1.1.1.1.1.1.3.3" xref="S2.E5.m1.1.1.1.1.1.3.3.cmml">l</mi></msub><mo id="S2.E5.m1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.2.cmml">â¢</mo><msup id="S2.E5.m1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.cmml"><mrow id="S2.E5.m1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E5.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E5.m1.1.1.1.1.1.1.1.2.1.cmml">â€–</mo><mrow id="S2.E5.m1.1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S2.E5.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">ğš</mi><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">k</mi></msubsup><mo id="S2.E5.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml">âˆ’</mo><msubsup id="S2.E5.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">ğœ</mi><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">l</mi><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msubsup></mrow><mo id="S2.E5.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E5.m1.1.1.1.1.1.1.1.2.1.cmml">â€–</mo></mrow><mn id="S2.E5.m1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S2.E5.m1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.1b"><apply id="S2.E5.m1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1"><eq id="S2.E5.m1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.2"></eq><apply id="S2.E5.m1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1.1.3">subscript</csymbol><apply id="S2.E5.m1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.3.2.1.cmml" xref="S2.E5.m1.1.1.1.1.3">superscript</csymbol><ci id="S2.E5.m1.1.1.1.1.3.2.2.cmml" xref="S2.E5.m1.1.1.1.1.3.2.2">ğ‘¤</ci><ci id="S2.E5.m1.1.1.1.1.3.2.3.cmml" xref="S2.E5.m1.1.1.1.1.3.2.3">ğ‘˜</ci></apply><ci id="S2.E5.m1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.1.1.3.3">ğ‘—</ci></apply><apply id="S2.E5.m1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1"><times id="S2.E5.m1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.2"></times><apply id="S2.E5.m1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.3.2a.cmml" xref="S2.E5.m1.1.1.1.1.1.3.2"><mtext id="S2.E5.m1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.1.1.3.2">arg min</mtext></ci><ci id="S2.E5.m1.1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.1.1.1.3.3">ğ‘™</ci></apply><apply id="S2.E5.m1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E5.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1"><minus id="S2.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.2.2">ğš</ci><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.2.3">ğ‘˜</ci></apply><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.3">ğ‘—</ci></apply><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.2">ğœ</ci><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.3">ğ‘™</ci></apply><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.3">ğ‘˜</ci></apply></apply></apply><cn id="S2.E5.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E5.m1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.1c">\displaystyle w^{k}_{j}=\text{arg min}_{l}\|\mathbf{a}^{k}_{j}-\mathbf{c}_{l}^%
{k}\|^{2},</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.1d">italic_w start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = arg min start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT âˆ¥ bold_a start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - bold_c start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT âˆ¥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="S2.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{Quantize}(\mathbf{a}^{k}_{j})=\mathbf{c}^{k}_{w^{k}_{j}}," class="ltx_Math" display="inline" id="S2.E6.m1.1"><semantics id="S2.E6.m1.1a"><mrow id="S2.E6.m1.1.1.1" xref="S2.E6.m1.1.1.1.1.cmml"><mrow id="S2.E6.m1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.cmml"><mrow id="S2.E6.m1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.cmml"><mtext id="S2.E6.m1.1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.1.3a.cmml">Quantize</mtext><mo id="S2.E6.m1.1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.1.2.cmml">â¢</mo><mrow id="S2.E6.m1.1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E6.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E6.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.E6.m1.1.1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E6.m1.1.1.1.1.1.1.1.1.2.2" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2.2.cmml">ğš</mi><mi id="S2.E6.m1.1.1.1.1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.1.1.1.1.3.cmml">j</mi><mi id="S2.E6.m1.1.1.1.1.1.1.1.1.2.3" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S2.E6.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E6.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E6.m1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.2.cmml">=</mo><msubsup id="S2.E6.m1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.3.cmml"><mi id="S2.E6.m1.1.1.1.1.3.2.2" xref="S2.E6.m1.1.1.1.1.3.2.2.cmml">ğœ</mi><msubsup id="S2.E6.m1.1.1.1.1.3.3" xref="S2.E6.m1.1.1.1.1.3.3.cmml"><mi id="S2.E6.m1.1.1.1.1.3.3.2.2" xref="S2.E6.m1.1.1.1.1.3.3.2.2.cmml">w</mi><mi id="S2.E6.m1.1.1.1.1.3.3.3" xref="S2.E6.m1.1.1.1.1.3.3.3.cmml">j</mi><mi id="S2.E6.m1.1.1.1.1.3.3.2.3" xref="S2.E6.m1.1.1.1.1.3.3.2.3.cmml">k</mi></msubsup><mi id="S2.E6.m1.1.1.1.1.3.2.3" xref="S2.E6.m1.1.1.1.1.3.2.3.cmml">k</mi></msubsup></mrow><mo id="S2.E6.m1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.1b"><apply id="S2.E6.m1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1"><eq id="S2.E6.m1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.2"></eq><apply id="S2.E6.m1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1"><times id="S2.E6.m1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.1.2"></times><ci id="S2.E6.m1.1.1.1.1.1.3a.cmml" xref="S2.E6.m1.1.1.1.1.1.3"><mtext id="S2.E6.m1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.1.3">Quantize</mtext></ci><apply id="S2.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2.2">ğš</ci><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2.3">ğ‘˜</ci></apply><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.3">ğ‘—</ci></apply></apply><apply id="S2.E6.m1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.3.1.cmml" xref="S2.E6.m1.1.1.1.1.3">subscript</csymbol><apply id="S2.E6.m1.1.1.1.1.3.2.cmml" xref="S2.E6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.3.2.1.cmml" xref="S2.E6.m1.1.1.1.1.3">superscript</csymbol><ci id="S2.E6.m1.1.1.1.1.3.2.2.cmml" xref="S2.E6.m1.1.1.1.1.3.2.2">ğœ</ci><ci id="S2.E6.m1.1.1.1.1.3.2.3.cmml" xref="S2.E6.m1.1.1.1.1.3.2.3">ğ‘˜</ci></apply><apply id="S2.E6.m1.1.1.1.1.3.3.cmml" xref="S2.E6.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.3.3.1.cmml" xref="S2.E6.m1.1.1.1.1.3.3">subscript</csymbol><apply id="S2.E6.m1.1.1.1.1.3.3.2.cmml" xref="S2.E6.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.3.3.2.1.cmml" xref="S2.E6.m1.1.1.1.1.3.3">superscript</csymbol><ci id="S2.E6.m1.1.1.1.1.3.3.2.2.cmml" xref="S2.E6.m1.1.1.1.1.3.3.2.2">ğ‘¤</ci><ci id="S2.E6.m1.1.1.1.1.3.3.2.3.cmml" xref="S2.E6.m1.1.1.1.1.3.3.2.3">ğ‘˜</ci></apply><ci id="S2.E6.m1.1.1.1.1.3.3.3.cmml" xref="S2.E6.m1.1.1.1.1.3.3.3">ğ‘—</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.1c">\displaystyle\text{Quantize}(\mathbf{a}^{k}_{j})=\mathbf{c}^{k}_{w^{k}_{j}},</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.1d">Quantize ( bold_a start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = bold_c start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS3.p3.15">where <math alttext="w^{k}_{j}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p3.11.m1.1"><semantics id="S2.SS3.SSS3.p3.11.m1.1a"><msubsup id="S2.SS3.SSS3.p3.11.m1.1.1" xref="S2.SS3.SSS3.p3.11.m1.1.1.cmml"><mi id="S2.SS3.SSS3.p3.11.m1.1.1.2.2" xref="S2.SS3.SSS3.p3.11.m1.1.1.2.2.cmml">w</mi><mi id="S2.SS3.SSS3.p3.11.m1.1.1.3" xref="S2.SS3.SSS3.p3.11.m1.1.1.3.cmml">j</mi><mi id="S2.SS3.SSS3.p3.11.m1.1.1.2.3" xref="S2.SS3.SSS3.p3.11.m1.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p3.11.m1.1b"><apply id="S2.SS3.SSS3.p3.11.m1.1.1.cmml" xref="S2.SS3.SSS3.p3.11.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.11.m1.1.1.1.cmml" xref="S2.SS3.SSS3.p3.11.m1.1.1">subscript</csymbol><apply id="S2.SS3.SSS3.p3.11.m1.1.1.2.cmml" xref="S2.SS3.SSS3.p3.11.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.11.m1.1.1.2.1.cmml" xref="S2.SS3.SSS3.p3.11.m1.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p3.11.m1.1.1.2.2.cmml" xref="S2.SS3.SSS3.p3.11.m1.1.1.2.2">ğ‘¤</ci><ci id="S2.SS3.SSS3.p3.11.m1.1.1.2.3.cmml" xref="S2.SS3.SSS3.p3.11.m1.1.1.2.3">ğ‘˜</ci></apply><ci id="S2.SS3.SSS3.p3.11.m1.1.1.3.cmml" xref="S2.SS3.SSS3.p3.11.m1.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p3.11.m1.1c">w^{k}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p3.11.m1.1d">italic_w start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> denotes the codeword (i.e., ID token) of the nearest neighbor at sub-codebook <math alttext="\mathbf{c}^{k}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p3.12.m2.1"><semantics id="S2.SS3.SSS3.p3.12.m2.1a"><msup id="S2.SS3.SSS3.p3.12.m2.1.1" xref="S2.SS3.SSS3.p3.12.m2.1.1.cmml"><mi id="S2.SS3.SSS3.p3.12.m2.1.1.2" xref="S2.SS3.SSS3.p3.12.m2.1.1.2.cmml">ğœ</mi><mi id="S2.SS3.SSS3.p3.12.m2.1.1.3" xref="S2.SS3.SSS3.p3.12.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p3.12.m2.1b"><apply id="S2.SS3.SSS3.p3.12.m2.1.1.cmml" xref="S2.SS3.SSS3.p3.12.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.12.m2.1.1.1.cmml" xref="S2.SS3.SSS3.p3.12.m2.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p3.12.m2.1.1.2.cmml" xref="S2.SS3.SSS3.p3.12.m2.1.1.2">ğœ</ci><ci id="S2.SS3.SSS3.p3.12.m2.1.1.3.cmml" xref="S2.SS3.SSS3.p3.12.m2.1.1.3">ğ‘˜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p3.12.m2.1c">\mathbf{c}^{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p3.12.m2.1d">bold_c start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> for the item <math alttext="v_{j}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p3.13.m3.1"><semantics id="S2.SS3.SSS3.p3.13.m3.1a"><msub id="S2.SS3.SSS3.p3.13.m3.1.1" xref="S2.SS3.SSS3.p3.13.m3.1.1.cmml"><mi id="S2.SS3.SSS3.p3.13.m3.1.1.2" xref="S2.SS3.SSS3.p3.13.m3.1.1.2.cmml">v</mi><mi id="S2.SS3.SSS3.p3.13.m3.1.1.3" xref="S2.SS3.SSS3.p3.13.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p3.13.m3.1b"><apply id="S2.SS3.SSS3.p3.13.m3.1.1.cmml" xref="S2.SS3.SSS3.p3.13.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.13.m3.1.1.1.cmml" xref="S2.SS3.SSS3.p3.13.m3.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p3.13.m3.1.1.2.cmml" xref="S2.SS3.SSS3.p3.13.m3.1.1.2">ğ‘£</ci><ci id="S2.SS3.SSS3.p3.13.m3.1.1.3.cmml" xref="S2.SS3.SSS3.p3.13.m3.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p3.13.m3.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p3.13.m3.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\|\cdot\|^{2}" class="ltx_math_unparsed" display="inline" id="S2.SS3.SSS3.p3.14.m4.1"><semantics id="S2.SS3.SSS3.p3.14.m4.1a"><mrow id="S2.SS3.SSS3.p3.14.m4.1b"><mo id="S2.SS3.SSS3.p3.14.m4.1.1" rspace="0em">âˆ¥</mo><mo id="S2.SS3.SSS3.p3.14.m4.1.2" lspace="0em" rspace="0em">â‹…</mo><msup id="S2.SS3.SSS3.p3.14.m4.1.3"><mo id="S2.SS3.SSS3.p3.14.m4.1.3.2" lspace="0em">âˆ¥</mo><mn id="S2.SS3.SSS3.p3.14.m4.1.3.3">2</mn></msup></mrow><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p3.14.m4.1c">\|\cdot\|^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p3.14.m4.1d">âˆ¥ â‹… âˆ¥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the <math alttext="l_{2}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p3.15.m5.1"><semantics id="S2.SS3.SSS3.p3.15.m5.1a"><msub id="S2.SS3.SSS3.p3.15.m5.1.1" xref="S2.SS3.SSS3.p3.15.m5.1.1.cmml"><mi id="S2.SS3.SSS3.p3.15.m5.1.1.2" xref="S2.SS3.SSS3.p3.15.m5.1.1.2.cmml">l</mi><mn id="S2.SS3.SSS3.p3.15.m5.1.1.3" xref="S2.SS3.SSS3.p3.15.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p3.15.m5.1b"><apply id="S2.SS3.SSS3.p3.15.m5.1.1.cmml" xref="S2.SS3.SSS3.p3.15.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.15.m5.1.1.1.cmml" xref="S2.SS3.SSS3.p3.15.m5.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p3.15.m5.1.1.2.cmml" xref="S2.SS3.SSS3.p3.15.m5.1.1.2">ğ‘™</ci><cn id="S2.SS3.SSS3.p3.15.m5.1.1.3.cmml" type="integer" xref="S2.SS3.SSS3.p3.15.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p3.15.m5.1c">l_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p3.15.m5.1d">italic_l start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> norm of the variables.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS3.p4">
<p class="ltx_p" id="S2.SS3.SSS3.p4.2">In other words, the proposed Item MQ-Tokenizer can tokenize the discrete ID of item <math alttext="v_{j}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p4.1.m1.1"><semantics id="S2.SS3.SSS3.p4.1.m1.1a"><msub id="S2.SS3.SSS3.p4.1.m1.1.1" xref="S2.SS3.SSS3.p4.1.m1.1.1.cmml"><mi id="S2.SS3.SSS3.p4.1.m1.1.1.2" xref="S2.SS3.SSS3.p4.1.m1.1.1.2.cmml">v</mi><mi id="S2.SS3.SSS3.p4.1.m1.1.1.3" xref="S2.SS3.SSS3.p4.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p4.1.m1.1b"><apply id="S2.SS3.SSS3.p4.1.m1.1.1.cmml" xref="S2.SS3.SSS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p4.1.m1.1.1.1.cmml" xref="S2.SS3.SSS3.p4.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p4.1.m1.1.1.2.cmml" xref="S2.SS3.SSS3.p4.1.m1.1.1.2">ğ‘£</ci><ci id="S2.SS3.SSS3.p4.1.m1.1.1.3.cmml" xref="S2.SS3.SSS3.p4.1.m1.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p4.1.m1.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p4.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p4.2.m2.1"><semantics id="S2.SS3.SSS3.p4.2.m2.1a"><mi id="S2.SS3.SSS3.p4.2.m2.1.1" xref="S2.SS3.SSS3.p4.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p4.2.m2.1b"><ci id="S2.SS3.SSS3.p4.2.m2.1.1.cmml" xref="S2.SS3.SSS3.p4.2.m2.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p4.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p4.2.m2.1d">italic_K</annotation></semantics></math> discrete codebook tokens along with their corresponding codeword embeddings in LLM-based recommender systems as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx6">
<tbody id="S2.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{item}~{}v_{j}" class="ltx_Math" display="inline" id="S2.E7.m1.1"><semantics id="S2.E7.m1.1a"><mrow id="S2.E7.m1.1.1" xref="S2.E7.m1.1.1.cmml"><mtext id="S2.E7.m1.1.1.2" xref="S2.E7.m1.1.1.2a.cmml">item</mtext><mo id="S2.E7.m1.1.1.1" lspace="0.330em" xref="S2.E7.m1.1.1.1.cmml">â¢</mo><msub id="S2.E7.m1.1.1.3" xref="S2.E7.m1.1.1.3.cmml"><mi id="S2.E7.m1.1.1.3.2" xref="S2.E7.m1.1.1.3.2.cmml">v</mi><mi id="S2.E7.m1.1.1.3.3" xref="S2.E7.m1.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.1b"><apply id="S2.E7.m1.1.1.cmml" xref="S2.E7.m1.1.1"><times id="S2.E7.m1.1.1.1.cmml" xref="S2.E7.m1.1.1.1"></times><ci id="S2.E7.m1.1.1.2a.cmml" xref="S2.E7.m1.1.1.2"><mtext id="S2.E7.m1.1.1.2.cmml" xref="S2.E7.m1.1.1.2">item</mtext></ci><apply id="S2.E7.m1.1.1.3.cmml" xref="S2.E7.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.3.1.cmml" xref="S2.E7.m1.1.1.3">subscript</csymbol><ci id="S2.E7.m1.1.1.3.2.cmml" xref="S2.E7.m1.1.1.3.2">ğ‘£</ci><ci id="S2.E7.m1.1.1.3.3.cmml" xref="S2.E7.m1.1.1.3.3">ğ‘—</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.1c">\displaystyle\text{item}~{}v_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m1.1d">item italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\rightarrow\text{tokens: }\{w_{j}^{1},w_{j}^{2},...,w_{j}^{K}\}" class="ltx_Math" display="inline" id="S2.E7.m2.4"><semantics id="S2.E7.m2.4a"><mrow id="S2.E7.m2.4.4" xref="S2.E7.m2.4.4.cmml"><mi id="S2.E7.m2.4.4.5" xref="S2.E7.m2.4.4.5.cmml"></mi><mo id="S2.E7.m2.4.4.4" stretchy="false" xref="S2.E7.m2.4.4.4.cmml">â†’</mo><mrow id="S2.E7.m2.4.4.3" xref="S2.E7.m2.4.4.3.cmml"><mtext id="S2.E7.m2.4.4.3.5" xref="S2.E7.m2.4.4.3.5a.cmml">tokens:Â </mtext><mo id="S2.E7.m2.4.4.3.4" xref="S2.E7.m2.4.4.3.4.cmml">â¢</mo><mrow id="S2.E7.m2.4.4.3.3.3" xref="S2.E7.m2.4.4.3.3.4.cmml"><mo id="S2.E7.m2.4.4.3.3.3.4" stretchy="false" xref="S2.E7.m2.4.4.3.3.4.cmml">{</mo><msubsup id="S2.E7.m2.2.2.1.1.1.1" xref="S2.E7.m2.2.2.1.1.1.1.cmml"><mi id="S2.E7.m2.2.2.1.1.1.1.2.2" xref="S2.E7.m2.2.2.1.1.1.1.2.2.cmml">w</mi><mi id="S2.E7.m2.2.2.1.1.1.1.2.3" xref="S2.E7.m2.2.2.1.1.1.1.2.3.cmml">j</mi><mn id="S2.E7.m2.2.2.1.1.1.1.3" xref="S2.E7.m2.2.2.1.1.1.1.3.cmml">1</mn></msubsup><mo id="S2.E7.m2.4.4.3.3.3.5" xref="S2.E7.m2.4.4.3.3.4.cmml">,</mo><msubsup id="S2.E7.m2.3.3.2.2.2.2" xref="S2.E7.m2.3.3.2.2.2.2.cmml"><mi id="S2.E7.m2.3.3.2.2.2.2.2.2" xref="S2.E7.m2.3.3.2.2.2.2.2.2.cmml">w</mi><mi id="S2.E7.m2.3.3.2.2.2.2.2.3" xref="S2.E7.m2.3.3.2.2.2.2.2.3.cmml">j</mi><mn id="S2.E7.m2.3.3.2.2.2.2.3" xref="S2.E7.m2.3.3.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S2.E7.m2.4.4.3.3.3.6" xref="S2.E7.m2.4.4.3.3.4.cmml">,</mo><mi id="S2.E7.m2.1.1" mathvariant="normal" xref="S2.E7.m2.1.1.cmml">â€¦</mi><mo id="S2.E7.m2.4.4.3.3.3.7" xref="S2.E7.m2.4.4.3.3.4.cmml">,</mo><msubsup id="S2.E7.m2.4.4.3.3.3.3" xref="S2.E7.m2.4.4.3.3.3.3.cmml"><mi id="S2.E7.m2.4.4.3.3.3.3.2.2" xref="S2.E7.m2.4.4.3.3.3.3.2.2.cmml">w</mi><mi id="S2.E7.m2.4.4.3.3.3.3.2.3" xref="S2.E7.m2.4.4.3.3.3.3.2.3.cmml">j</mi><mi id="S2.E7.m2.4.4.3.3.3.3.3" xref="S2.E7.m2.4.4.3.3.3.3.3.cmml">K</mi></msubsup><mo id="S2.E7.m2.4.4.3.3.3.8" stretchy="false" xref="S2.E7.m2.4.4.3.3.4.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m2.4b"><apply id="S2.E7.m2.4.4.cmml" xref="S2.E7.m2.4.4"><ci id="S2.E7.m2.4.4.4.cmml" xref="S2.E7.m2.4.4.4">â†’</ci><csymbol cd="latexml" id="S2.E7.m2.4.4.5.cmml" xref="S2.E7.m2.4.4.5">absent</csymbol><apply id="S2.E7.m2.4.4.3.cmml" xref="S2.E7.m2.4.4.3"><times id="S2.E7.m2.4.4.3.4.cmml" xref="S2.E7.m2.4.4.3.4"></times><ci id="S2.E7.m2.4.4.3.5a.cmml" xref="S2.E7.m2.4.4.3.5"><mtext id="S2.E7.m2.4.4.3.5.cmml" xref="S2.E7.m2.4.4.3.5">tokens:Â </mtext></ci><set id="S2.E7.m2.4.4.3.3.4.cmml" xref="S2.E7.m2.4.4.3.3.3"><apply id="S2.E7.m2.2.2.1.1.1.1.cmml" xref="S2.E7.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.2.2.1.1.1.1.1.cmml" xref="S2.E7.m2.2.2.1.1.1.1">superscript</csymbol><apply id="S2.E7.m2.2.2.1.1.1.1.2.cmml" xref="S2.E7.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.2.2.1.1.1.1.2.1.cmml" xref="S2.E7.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S2.E7.m2.2.2.1.1.1.1.2.2.cmml" xref="S2.E7.m2.2.2.1.1.1.1.2.2">ğ‘¤</ci><ci id="S2.E7.m2.2.2.1.1.1.1.2.3.cmml" xref="S2.E7.m2.2.2.1.1.1.1.2.3">ğ‘—</ci></apply><cn id="S2.E7.m2.2.2.1.1.1.1.3.cmml" type="integer" xref="S2.E7.m2.2.2.1.1.1.1.3">1</cn></apply><apply id="S2.E7.m2.3.3.2.2.2.2.cmml" xref="S2.E7.m2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.E7.m2.3.3.2.2.2.2.1.cmml" xref="S2.E7.m2.3.3.2.2.2.2">superscript</csymbol><apply id="S2.E7.m2.3.3.2.2.2.2.2.cmml" xref="S2.E7.m2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.E7.m2.3.3.2.2.2.2.2.1.cmml" xref="S2.E7.m2.3.3.2.2.2.2">subscript</csymbol><ci id="S2.E7.m2.3.3.2.2.2.2.2.2.cmml" xref="S2.E7.m2.3.3.2.2.2.2.2.2">ğ‘¤</ci><ci id="S2.E7.m2.3.3.2.2.2.2.2.3.cmml" xref="S2.E7.m2.3.3.2.2.2.2.2.3">ğ‘—</ci></apply><cn id="S2.E7.m2.3.3.2.2.2.2.3.cmml" type="integer" xref="S2.E7.m2.3.3.2.2.2.2.3">2</cn></apply><ci id="S2.E7.m2.1.1.cmml" xref="S2.E7.m2.1.1">â€¦</ci><apply id="S2.E7.m2.4.4.3.3.3.3.cmml" xref="S2.E7.m2.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S2.E7.m2.4.4.3.3.3.3.1.cmml" xref="S2.E7.m2.4.4.3.3.3.3">superscript</csymbol><apply id="S2.E7.m2.4.4.3.3.3.3.2.cmml" xref="S2.E7.m2.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S2.E7.m2.4.4.3.3.3.3.2.1.cmml" xref="S2.E7.m2.4.4.3.3.3.3">subscript</csymbol><ci id="S2.E7.m2.4.4.3.3.3.3.2.2.cmml" xref="S2.E7.m2.4.4.3.3.3.3.2.2">ğ‘¤</ci><ci id="S2.E7.m2.4.4.3.3.3.3.2.3.cmml" xref="S2.E7.m2.4.4.3.3.3.3.2.3">ğ‘—</ci></apply><ci id="S2.E7.m2.4.4.3.3.3.3.3.cmml" xref="S2.E7.m2.4.4.3.3.3.3.3">ğ¾</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m2.4c">\displaystyle\rightarrow\text{tokens: }\{w_{j}^{1},w_{j}^{2},...,w_{j}^{K}\}</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m2.4d">â†’ tokens: { italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , â€¦ , italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
<tbody id="S2.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\rightarrow\text{tokens' embeddings: }[\mathbf{c}^{1}_{w^{1}_{j}}%
,\mathbf{c}^{2}_{w^{2}_{j}},...,\mathbf{c}^{K}_{w^{K}_{j}}]." class="ltx_Math" display="inline" id="S2.E8.m1.2"><semantics id="S2.E8.m1.2a"><mrow id="S2.E8.m1.2.2.1" xref="S2.E8.m1.2.2.1.1.cmml"><mrow id="S2.E8.m1.2.2.1.1" xref="S2.E8.m1.2.2.1.1.cmml"><mi id="S2.E8.m1.2.2.1.1.5" xref="S2.E8.m1.2.2.1.1.5.cmml"></mi><mo id="S2.E8.m1.2.2.1.1.4" stretchy="false" xref="S2.E8.m1.2.2.1.1.4.cmml">â†’</mo><mrow id="S2.E8.m1.2.2.1.1.3" xref="S2.E8.m1.2.2.1.1.3.cmml"><mtext id="S2.E8.m1.2.2.1.1.3.5" xref="S2.E8.m1.2.2.1.1.3.5a.cmml">tokensâ€™ embeddings:Â </mtext><mo id="S2.E8.m1.2.2.1.1.3.4" xref="S2.E8.m1.2.2.1.1.3.4.cmml">â¢</mo><mrow id="S2.E8.m1.2.2.1.1.3.3.3" xref="S2.E8.m1.2.2.1.1.3.3.4.cmml"><mo id="S2.E8.m1.2.2.1.1.3.3.3.4" stretchy="false" xref="S2.E8.m1.2.2.1.1.3.3.4.cmml">[</mo><msubsup id="S2.E8.m1.2.2.1.1.1.1.1.1" xref="S2.E8.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E8.m1.2.2.1.1.1.1.1.1.2.2" xref="S2.E8.m1.2.2.1.1.1.1.1.1.2.2.cmml">ğœ</mi><msubsup id="S2.E8.m1.2.2.1.1.1.1.1.1.3" xref="S2.E8.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S2.E8.m1.2.2.1.1.1.1.1.1.3.2.2" xref="S2.E8.m1.2.2.1.1.1.1.1.1.3.2.2.cmml">w</mi><mi id="S2.E8.m1.2.2.1.1.1.1.1.1.3.3" xref="S2.E8.m1.2.2.1.1.1.1.1.1.3.3.cmml">j</mi><mn id="S2.E8.m1.2.2.1.1.1.1.1.1.3.2.3" xref="S2.E8.m1.2.2.1.1.1.1.1.1.3.2.3.cmml">1</mn></msubsup><mn id="S2.E8.m1.2.2.1.1.1.1.1.1.2.3" xref="S2.E8.m1.2.2.1.1.1.1.1.1.2.3.cmml">1</mn></msubsup><mo id="S2.E8.m1.2.2.1.1.3.3.3.5" xref="S2.E8.m1.2.2.1.1.3.3.4.cmml">,</mo><msubsup id="S2.E8.m1.2.2.1.1.2.2.2.2" xref="S2.E8.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S2.E8.m1.2.2.1.1.2.2.2.2.2.2" xref="S2.E8.m1.2.2.1.1.2.2.2.2.2.2.cmml">ğœ</mi><msubsup id="S2.E8.m1.2.2.1.1.2.2.2.2.3" xref="S2.E8.m1.2.2.1.1.2.2.2.2.3.cmml"><mi id="S2.E8.m1.2.2.1.1.2.2.2.2.3.2.2" xref="S2.E8.m1.2.2.1.1.2.2.2.2.3.2.2.cmml">w</mi><mi id="S2.E8.m1.2.2.1.1.2.2.2.2.3.3" xref="S2.E8.m1.2.2.1.1.2.2.2.2.3.3.cmml">j</mi><mn id="S2.E8.m1.2.2.1.1.2.2.2.2.3.2.3" xref="S2.E8.m1.2.2.1.1.2.2.2.2.3.2.3.cmml">2</mn></msubsup><mn id="S2.E8.m1.2.2.1.1.2.2.2.2.2.3" xref="S2.E8.m1.2.2.1.1.2.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S2.E8.m1.2.2.1.1.3.3.3.6" xref="S2.E8.m1.2.2.1.1.3.3.4.cmml">,</mo><mi id="S2.E8.m1.1.1" mathvariant="normal" xref="S2.E8.m1.1.1.cmml">â€¦</mi><mo id="S2.E8.m1.2.2.1.1.3.3.3.7" xref="S2.E8.m1.2.2.1.1.3.3.4.cmml">,</mo><msubsup id="S2.E8.m1.2.2.1.1.3.3.3.3" xref="S2.E8.m1.2.2.1.1.3.3.3.3.cmml"><mi id="S2.E8.m1.2.2.1.1.3.3.3.3.2.2" xref="S2.E8.m1.2.2.1.1.3.3.3.3.2.2.cmml">ğœ</mi><msubsup id="S2.E8.m1.2.2.1.1.3.3.3.3.3" xref="S2.E8.m1.2.2.1.1.3.3.3.3.3.cmml"><mi id="S2.E8.m1.2.2.1.1.3.3.3.3.3.2.2" xref="S2.E8.m1.2.2.1.1.3.3.3.3.3.2.2.cmml">w</mi><mi id="S2.E8.m1.2.2.1.1.3.3.3.3.3.3" xref="S2.E8.m1.2.2.1.1.3.3.3.3.3.3.cmml">j</mi><mi id="S2.E8.m1.2.2.1.1.3.3.3.3.3.2.3" xref="S2.E8.m1.2.2.1.1.3.3.3.3.3.2.3.cmml">K</mi></msubsup><mi id="S2.E8.m1.2.2.1.1.3.3.3.3.2.3" xref="S2.E8.m1.2.2.1.1.3.3.3.3.2.3.cmml">K</mi></msubsup><mo id="S2.E8.m1.2.2.1.1.3.3.3.8" stretchy="false" xref="S2.E8.m1.2.2.1.1.3.3.4.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E8.m1.2.2.1.2" lspace="0em" xref="S2.E8.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.2b"><apply id="S2.E8.m1.2.2.1.1.cmml" xref="S2.E8.m1.2.2.1"><ci id="S2.E8.m1.2.2.1.1.4.cmml" xref="S2.E8.m1.2.2.1.1.4">â†’</ci><csymbol cd="latexml" id="S2.E8.m1.2.2.1.1.5.cmml" xref="S2.E8.m1.2.2.1.1.5">absent</csymbol><apply id="S2.E8.m1.2.2.1.1.3.cmml" xref="S2.E8.m1.2.2.1.1.3"><times id="S2.E8.m1.2.2.1.1.3.4.cmml" xref="S2.E8.m1.2.2.1.1.3.4"></times><ci id="S2.E8.m1.2.2.1.1.3.5a.cmml" xref="S2.E8.m1.2.2.1.1.3.5"><mtext id="S2.E8.m1.2.2.1.1.3.5.cmml" xref="S2.E8.m1.2.2.1.1.3.5">tokensâ€™ embeddings:Â </mtext></ci><list id="S2.E8.m1.2.2.1.1.3.3.4.cmml" xref="S2.E8.m1.2.2.1.1.3.3.3"><apply id="S2.E8.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E8.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E8.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S2.E8.m1.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E8.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S2.E8.m1.2.2.1.1.1.1.1.1.2.2">ğœ</ci><cn id="S2.E8.m1.2.2.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S2.E8.m1.2.2.1.1.1.1.1.1.2.3">1</cn></apply><apply id="S2.E8.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E8.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.E8.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><apply id="S2.E8.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.E8.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E8.m1.2.2.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E8.m1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E8.m1.2.2.1.1.1.1.1.1.3.2.2">ğ‘¤</ci><cn id="S2.E8.m1.2.2.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="S2.E8.m1.2.2.1.1.1.1.1.1.3.2.3">1</cn></apply><ci id="S2.E8.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.E8.m1.2.2.1.1.1.1.1.1.3.3">ğ‘—</ci></apply></apply><apply id="S2.E8.m1.2.2.1.1.2.2.2.2.cmml" xref="S2.E8.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S2.E8.m1.2.2.1.1.2.2.2.2">subscript</csymbol><apply id="S2.E8.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S2.E8.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="S2.E8.m1.2.2.1.1.2.2.2.2">superscript</csymbol><ci id="S2.E8.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S2.E8.m1.2.2.1.1.2.2.2.2.2.2">ğœ</ci><cn id="S2.E8.m1.2.2.1.1.2.2.2.2.2.3.cmml" type="integer" xref="S2.E8.m1.2.2.1.1.2.2.2.2.2.3">2</cn></apply><apply id="S2.E8.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S2.E8.m1.2.2.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.1.1.2.2.2.2.3.1.cmml" xref="S2.E8.m1.2.2.1.1.2.2.2.2.3">subscript</csymbol><apply id="S2.E8.m1.2.2.1.1.2.2.2.2.3.2.cmml" xref="S2.E8.m1.2.2.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.1.1.2.2.2.2.3.2.1.cmml" xref="S2.E8.m1.2.2.1.1.2.2.2.2.3">superscript</csymbol><ci id="S2.E8.m1.2.2.1.1.2.2.2.2.3.2.2.cmml" xref="S2.E8.m1.2.2.1.1.2.2.2.2.3.2.2">ğ‘¤</ci><cn id="S2.E8.m1.2.2.1.1.2.2.2.2.3.2.3.cmml" type="integer" xref="S2.E8.m1.2.2.1.1.2.2.2.2.3.2.3">2</cn></apply><ci id="S2.E8.m1.2.2.1.1.2.2.2.2.3.3.cmml" xref="S2.E8.m1.2.2.1.1.2.2.2.2.3.3">ğ‘—</ci></apply></apply><ci id="S2.E8.m1.1.1.cmml" xref="S2.E8.m1.1.1">â€¦</ci><apply id="S2.E8.m1.2.2.1.1.3.3.3.3.cmml" xref="S2.E8.m1.2.2.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.1.1.3.3.3.3.1.cmml" xref="S2.E8.m1.2.2.1.1.3.3.3.3">subscript</csymbol><apply id="S2.E8.m1.2.2.1.1.3.3.3.3.2.cmml" xref="S2.E8.m1.2.2.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.1.1.3.3.3.3.2.1.cmml" xref="S2.E8.m1.2.2.1.1.3.3.3.3">superscript</csymbol><ci id="S2.E8.m1.2.2.1.1.3.3.3.3.2.2.cmml" xref="S2.E8.m1.2.2.1.1.3.3.3.3.2.2">ğœ</ci><ci id="S2.E8.m1.2.2.1.1.3.3.3.3.2.3.cmml" xref="S2.E8.m1.2.2.1.1.3.3.3.3.2.3">ğ¾</ci></apply><apply id="S2.E8.m1.2.2.1.1.3.3.3.3.3.cmml" xref="S2.E8.m1.2.2.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.1.1.3.3.3.3.3.1.cmml" xref="S2.E8.m1.2.2.1.1.3.3.3.3.3">subscript</csymbol><apply id="S2.E8.m1.2.2.1.1.3.3.3.3.3.2.cmml" xref="S2.E8.m1.2.2.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.1.1.3.3.3.3.3.2.1.cmml" xref="S2.E8.m1.2.2.1.1.3.3.3.3.3">superscript</csymbol><ci id="S2.E8.m1.2.2.1.1.3.3.3.3.3.2.2.cmml" xref="S2.E8.m1.2.2.1.1.3.3.3.3.3.2.2">ğ‘¤</ci><ci id="S2.E8.m1.2.2.1.1.3.3.3.3.3.2.3.cmml" xref="S2.E8.m1.2.2.1.1.3.3.3.3.3.2.3">ğ¾</ci></apply><ci id="S2.E8.m1.2.2.1.1.3.3.3.3.3.3.cmml" xref="S2.E8.m1.2.2.1.1.3.3.3.3.3.3">ğ‘—</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.2c">\displaystyle\rightarrow\text{tokens' embeddings: }[\mathbf{c}^{1}_{w^{1}_{j}}%
,\mathbf{c}^{2}_{w^{2}_{j}},...,\mathbf{c}^{K}_{w^{K}_{j}}].</annotation><annotation encoding="application/x-llamapun" id="S2.E8.m1.2d">â†’ tokensâ€™ embeddings: [ bold_c start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT , bold_c start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , bold_c start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS3.p4.3">It is worth noting that we can also apply a similar quantification process to tokenize users in LLM-based recommendations.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS3.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S2.SS3.SSS4.5.1.1">II-C</span>4 </span><math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS4.1.m1.1"><semantics id="S2.SS3.SSS4.1.m1.1b"><mi id="S2.SS3.SSS4.1.m1.1.1" xref="S2.SS3.SSS4.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS4.1.m1.1c"><ci id="S2.SS3.SSS4.1.m1.1.1.cmml" xref="S2.SS3.SSS4.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS4.1.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS4.1.m1.1e">italic_K</annotation></semantics></math><span class="ltx_text ltx_font_bold" id="S2.SS3.SSS4.6.2">-to-1 Decoder</span>
</h4>
<div class="ltx_para" id="S2.SS3.SSS4.p1">
<p class="ltx_p" id="S2.SS3.SSS4.p1.13">After the <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS4.p1.1.m1.1"><semantics id="S2.SS3.SSS4.p1.1.m1.1a"><mi id="S2.SS3.SSS4.p1.1.m1.1.1" xref="S2.SS3.SSS4.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS4.p1.1.m1.1b"><ci id="S2.SS3.SSS4.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS4.p1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS4.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS4.p1.1.m1.1d">italic_K</annotation></semantics></math>-way encoder, a <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS4.p1.2.m2.1"><semantics id="S2.SS3.SSS4.p1.2.m2.1a"><mi id="S2.SS3.SSS4.p1.2.m2.1.1" xref="S2.SS3.SSS4.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS4.p1.2.m2.1b"><ci id="S2.SS3.SSS4.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS4.p1.2.m2.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS4.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS4.p1.2.m2.1d">italic_K</annotation></semantics></math>-to-1 decoder <math alttext="\text{Dec}(\cdot)" class="ltx_Math" display="inline" id="S2.SS3.SSS4.p1.3.m3.1"><semantics id="S2.SS3.SSS4.p1.3.m3.1a"><mrow id="S2.SS3.SSS4.p1.3.m3.1.2" xref="S2.SS3.SSS4.p1.3.m3.1.2.cmml"><mtext id="S2.SS3.SSS4.p1.3.m3.1.2.2" xref="S2.SS3.SSS4.p1.3.m3.1.2.2a.cmml">Dec</mtext><mo id="S2.SS3.SSS4.p1.3.m3.1.2.1" xref="S2.SS3.SSS4.p1.3.m3.1.2.1.cmml">â¢</mo><mrow id="S2.SS3.SSS4.p1.3.m3.1.2.3.2" xref="S2.SS3.SSS4.p1.3.m3.1.2.cmml"><mo id="S2.SS3.SSS4.p1.3.m3.1.2.3.2.1" stretchy="false" xref="S2.SS3.SSS4.p1.3.m3.1.2.cmml">(</mo><mo id="S2.SS3.SSS4.p1.3.m3.1.1" lspace="0em" rspace="0em" xref="S2.SS3.SSS4.p1.3.m3.1.1.cmml">â‹…</mo><mo id="S2.SS3.SSS4.p1.3.m3.1.2.3.2.2" stretchy="false" xref="S2.SS3.SSS4.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS4.p1.3.m3.1b"><apply id="S2.SS3.SSS4.p1.3.m3.1.2.cmml" xref="S2.SS3.SSS4.p1.3.m3.1.2"><times id="S2.SS3.SSS4.p1.3.m3.1.2.1.cmml" xref="S2.SS3.SSS4.p1.3.m3.1.2.1"></times><ci id="S2.SS3.SSS4.p1.3.m3.1.2.2a.cmml" xref="S2.SS3.SSS4.p1.3.m3.1.2.2"><mtext id="S2.SS3.SSS4.p1.3.m3.1.2.2.cmml" xref="S2.SS3.SSS4.p1.3.m3.1.2.2">Dec</mtext></ci><ci id="S2.SS3.SSS4.p1.3.m3.1.1.cmml" xref="S2.SS3.SSS4.p1.3.m3.1.1">â‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS4.p1.3.m3.1c">\text{Dec}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS4.p1.3.m3.1d">Dec ( â‹… )</annotation></semantics></math> is introduced to conduct input reconstruction.
The basic idea is that <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS4.p1.4.m4.1"><semantics id="S2.SS3.SSS4.p1.4.m4.1a"><mi id="S2.SS3.SSS4.p1.4.m4.1.1" xref="S2.SS3.SSS4.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS4.p1.4.m4.1b"><ci id="S2.SS3.SSS4.p1.4.m4.1.1.cmml" xref="S2.SS3.SSS4.p1.4.m4.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS4.p1.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS4.p1.4.m4.1d">italic_K</annotation></semantics></math> different embeddings indexed by <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS4.p1.5.m5.1"><semantics id="S2.SS3.SSS4.p1.5.m5.1a"><mi id="S2.SS3.SSS4.p1.5.m5.1.1" xref="S2.SS3.SSS4.p1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS4.p1.5.m5.1b"><ci id="S2.SS3.SSS4.p1.5.m5.1.1.cmml" xref="S2.SS3.SSS4.p1.5.m5.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS4.p1.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS4.p1.5.m5.1d">italic_K</annotation></semantics></math> discrete tokens in the <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS4.p1.6.m6.1"><semantics id="S2.SS3.SSS4.p1.6.m6.1a"><mi id="S2.SS3.SSS4.p1.6.m6.1.1" xref="S2.SS3.SSS4.p1.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS4.p1.6.m6.1b"><ci id="S2.SS3.SSS4.p1.6.m6.1.1.cmml" xref="S2.SS3.SSS4.p1.6.m6.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS4.p1.6.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS4.p1.6.m6.1d">italic_K</annotation></semantics></math>-way codebook <math alttext="\mathbf{C}" class="ltx_Math" display="inline" id="S2.SS3.SSS4.p1.7.m7.1"><semantics id="S2.SS3.SSS4.p1.7.m7.1a"><mi id="S2.SS3.SSS4.p1.7.m7.1.1" xref="S2.SS3.SSS4.p1.7.m7.1.1.cmml">ğ‚</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS4.p1.7.m7.1b"><ci id="S2.SS3.SSS4.p1.7.m7.1.1.cmml" xref="S2.SS3.SSS4.p1.7.m7.1.1">ğ‚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS4.p1.7.m7.1c">\mathbf{C}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS4.p1.7.m7.1d">bold_C</annotation></semantics></math> are fed into the <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS4.p1.8.m8.1"><semantics id="S2.SS3.SSS4.p1.8.m8.1a"><mi id="S2.SS3.SSS4.p1.8.m8.1.1" xref="S2.SS3.SSS4.p1.8.m8.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS4.p1.8.m8.1b"><ci id="S2.SS3.SSS4.p1.8.m8.1.1.cmml" xref="S2.SS3.SSS4.p1.8.m8.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS4.p1.8.m8.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS4.p1.8.m8.1d">italic_K</annotation></semantics></math>-to-1 decoder to reconstruct the input representations of user <math alttext="\mathbf{p}_{i}" class="ltx_Math" display="inline" id="S2.SS3.SSS4.p1.9.m9.1"><semantics id="S2.SS3.SSS4.p1.9.m9.1a"><msub id="S2.SS3.SSS4.p1.9.m9.1.1" xref="S2.SS3.SSS4.p1.9.m9.1.1.cmml"><mi id="S2.SS3.SSS4.p1.9.m9.1.1.2" xref="S2.SS3.SSS4.p1.9.m9.1.1.2.cmml">ğ©</mi><mi id="S2.SS3.SSS4.p1.9.m9.1.1.3" xref="S2.SS3.SSS4.p1.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS4.p1.9.m9.1b"><apply id="S2.SS3.SSS4.p1.9.m9.1.1.cmml" xref="S2.SS3.SSS4.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS4.p1.9.m9.1.1.1.cmml" xref="S2.SS3.SSS4.p1.9.m9.1.1">subscript</csymbol><ci id="S2.SS3.SSS4.p1.9.m9.1.1.2.cmml" xref="S2.SS3.SSS4.p1.9.m9.1.1.2">ğ©</ci><ci id="S2.SS3.SSS4.p1.9.m9.1.1.3.cmml" xref="S2.SS3.SSS4.p1.9.m9.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS4.p1.9.m9.1c">\mathbf{p}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS4.p1.9.m9.1d">bold_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> or item <math alttext="\mathbf{q}_{j}" class="ltx_Math" display="inline" id="S2.SS3.SSS4.p1.10.m10.1"><semantics id="S2.SS3.SSS4.p1.10.m10.1a"><msub id="S2.SS3.SSS4.p1.10.m10.1.1" xref="S2.SS3.SSS4.p1.10.m10.1.1.cmml"><mi id="S2.SS3.SSS4.p1.10.m10.1.1.2" xref="S2.SS3.SSS4.p1.10.m10.1.1.2.cmml">ğª</mi><mi id="S2.SS3.SSS4.p1.10.m10.1.1.3" xref="S2.SS3.SSS4.p1.10.m10.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS4.p1.10.m10.1b"><apply id="S2.SS3.SSS4.p1.10.m10.1.1.cmml" xref="S2.SS3.SSS4.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS4.p1.10.m10.1.1.1.cmml" xref="S2.SS3.SSS4.p1.10.m10.1.1">subscript</csymbol><ci id="S2.SS3.SSS4.p1.10.m10.1.1.2.cmml" xref="S2.SS3.SSS4.p1.10.m10.1.1.2">ğª</ci><ci id="S2.SS3.SSS4.p1.10.m10.1.1.3.cmml" xref="S2.SS3.SSS4.p1.10.m10.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS4.p1.10.m10.1c">\mathbf{q}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS4.p1.10.m10.1d">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.
Mathematically, given item <math alttext="v_{j}" class="ltx_Math" display="inline" id="S2.SS3.SSS4.p1.11.m11.1"><semantics id="S2.SS3.SSS4.p1.11.m11.1a"><msub id="S2.SS3.SSS4.p1.11.m11.1.1" xref="S2.SS3.SSS4.p1.11.m11.1.1.cmml"><mi id="S2.SS3.SSS4.p1.11.m11.1.1.2" xref="S2.SS3.SSS4.p1.11.m11.1.1.2.cmml">v</mi><mi id="S2.SS3.SSS4.p1.11.m11.1.1.3" xref="S2.SS3.SSS4.p1.11.m11.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS4.p1.11.m11.1b"><apply id="S2.SS3.SSS4.p1.11.m11.1.1.cmml" xref="S2.SS3.SSS4.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS4.p1.11.m11.1.1.1.cmml" xref="S2.SS3.SSS4.p1.11.m11.1.1">subscript</csymbol><ci id="S2.SS3.SSS4.p1.11.m11.1.1.2.cmml" xref="S2.SS3.SSS4.p1.11.m11.1.1.2">ğ‘£</ci><ci id="S2.SS3.SSS4.p1.11.m11.1.1.3.cmml" xref="S2.SS3.SSS4.p1.11.m11.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS4.p1.11.m11.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS4.p1.11.m11.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and its quantized tokens <math alttext="\{w_{j}^{1},w_{j}^{2},...,w_{j}^{K}\}" class="ltx_Math" display="inline" id="S2.SS3.SSS4.p1.12.m12.4"><semantics id="S2.SS3.SSS4.p1.12.m12.4a"><mrow id="S2.SS3.SSS4.p1.12.m12.4.4.3" xref="S2.SS3.SSS4.p1.12.m12.4.4.4.cmml"><mo id="S2.SS3.SSS4.p1.12.m12.4.4.3.4" stretchy="false" xref="S2.SS3.SSS4.p1.12.m12.4.4.4.cmml">{</mo><msubsup id="S2.SS3.SSS4.p1.12.m12.2.2.1.1" xref="S2.SS3.SSS4.p1.12.m12.2.2.1.1.cmml"><mi id="S2.SS3.SSS4.p1.12.m12.2.2.1.1.2.2" xref="S2.SS3.SSS4.p1.12.m12.2.2.1.1.2.2.cmml">w</mi><mi id="S2.SS3.SSS4.p1.12.m12.2.2.1.1.2.3" xref="S2.SS3.SSS4.p1.12.m12.2.2.1.1.2.3.cmml">j</mi><mn id="S2.SS3.SSS4.p1.12.m12.2.2.1.1.3" xref="S2.SS3.SSS4.p1.12.m12.2.2.1.1.3.cmml">1</mn></msubsup><mo id="S2.SS3.SSS4.p1.12.m12.4.4.3.5" xref="S2.SS3.SSS4.p1.12.m12.4.4.4.cmml">,</mo><msubsup id="S2.SS3.SSS4.p1.12.m12.3.3.2.2" xref="S2.SS3.SSS4.p1.12.m12.3.3.2.2.cmml"><mi id="S2.SS3.SSS4.p1.12.m12.3.3.2.2.2.2" xref="S2.SS3.SSS4.p1.12.m12.3.3.2.2.2.2.cmml">w</mi><mi id="S2.SS3.SSS4.p1.12.m12.3.3.2.2.2.3" xref="S2.SS3.SSS4.p1.12.m12.3.3.2.2.2.3.cmml">j</mi><mn id="S2.SS3.SSS4.p1.12.m12.3.3.2.2.3" xref="S2.SS3.SSS4.p1.12.m12.3.3.2.2.3.cmml">2</mn></msubsup><mo id="S2.SS3.SSS4.p1.12.m12.4.4.3.6" xref="S2.SS3.SSS4.p1.12.m12.4.4.4.cmml">,</mo><mi id="S2.SS3.SSS4.p1.12.m12.1.1" mathvariant="normal" xref="S2.SS3.SSS4.p1.12.m12.1.1.cmml">â€¦</mi><mo id="S2.SS3.SSS4.p1.12.m12.4.4.3.7" xref="S2.SS3.SSS4.p1.12.m12.4.4.4.cmml">,</mo><msubsup id="S2.SS3.SSS4.p1.12.m12.4.4.3.3" xref="S2.SS3.SSS4.p1.12.m12.4.4.3.3.cmml"><mi id="S2.SS3.SSS4.p1.12.m12.4.4.3.3.2.2" xref="S2.SS3.SSS4.p1.12.m12.4.4.3.3.2.2.cmml">w</mi><mi id="S2.SS3.SSS4.p1.12.m12.4.4.3.3.2.3" xref="S2.SS3.SSS4.p1.12.m12.4.4.3.3.2.3.cmml">j</mi><mi id="S2.SS3.SSS4.p1.12.m12.4.4.3.3.3" xref="S2.SS3.SSS4.p1.12.m12.4.4.3.3.3.cmml">K</mi></msubsup><mo id="S2.SS3.SSS4.p1.12.m12.4.4.3.8" stretchy="false" xref="S2.SS3.SSS4.p1.12.m12.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS4.p1.12.m12.4b"><set id="S2.SS3.SSS4.p1.12.m12.4.4.4.cmml" xref="S2.SS3.SSS4.p1.12.m12.4.4.3"><apply id="S2.SS3.SSS4.p1.12.m12.2.2.1.1.cmml" xref="S2.SS3.SSS4.p1.12.m12.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS4.p1.12.m12.2.2.1.1.1.cmml" xref="S2.SS3.SSS4.p1.12.m12.2.2.1.1">superscript</csymbol><apply id="S2.SS3.SSS4.p1.12.m12.2.2.1.1.2.cmml" xref="S2.SS3.SSS4.p1.12.m12.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS4.p1.12.m12.2.2.1.1.2.1.cmml" xref="S2.SS3.SSS4.p1.12.m12.2.2.1.1">subscript</csymbol><ci id="S2.SS3.SSS4.p1.12.m12.2.2.1.1.2.2.cmml" xref="S2.SS3.SSS4.p1.12.m12.2.2.1.1.2.2">ğ‘¤</ci><ci id="S2.SS3.SSS4.p1.12.m12.2.2.1.1.2.3.cmml" xref="S2.SS3.SSS4.p1.12.m12.2.2.1.1.2.3">ğ‘—</ci></apply><cn id="S2.SS3.SSS4.p1.12.m12.2.2.1.1.3.cmml" type="integer" xref="S2.SS3.SSS4.p1.12.m12.2.2.1.1.3">1</cn></apply><apply id="S2.SS3.SSS4.p1.12.m12.3.3.2.2.cmml" xref="S2.SS3.SSS4.p1.12.m12.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS4.p1.12.m12.3.3.2.2.1.cmml" xref="S2.SS3.SSS4.p1.12.m12.3.3.2.2">superscript</csymbol><apply id="S2.SS3.SSS4.p1.12.m12.3.3.2.2.2.cmml" xref="S2.SS3.SSS4.p1.12.m12.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS4.p1.12.m12.3.3.2.2.2.1.cmml" xref="S2.SS3.SSS4.p1.12.m12.3.3.2.2">subscript</csymbol><ci id="S2.SS3.SSS4.p1.12.m12.3.3.2.2.2.2.cmml" xref="S2.SS3.SSS4.p1.12.m12.3.3.2.2.2.2">ğ‘¤</ci><ci id="S2.SS3.SSS4.p1.12.m12.3.3.2.2.2.3.cmml" xref="S2.SS3.SSS4.p1.12.m12.3.3.2.2.2.3">ğ‘—</ci></apply><cn id="S2.SS3.SSS4.p1.12.m12.3.3.2.2.3.cmml" type="integer" xref="S2.SS3.SSS4.p1.12.m12.3.3.2.2.3">2</cn></apply><ci id="S2.SS3.SSS4.p1.12.m12.1.1.cmml" xref="S2.SS3.SSS4.p1.12.m12.1.1">â€¦</ci><apply id="S2.SS3.SSS4.p1.12.m12.4.4.3.3.cmml" xref="S2.SS3.SSS4.p1.12.m12.4.4.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS4.p1.12.m12.4.4.3.3.1.cmml" xref="S2.SS3.SSS4.p1.12.m12.4.4.3.3">superscript</csymbol><apply id="S2.SS3.SSS4.p1.12.m12.4.4.3.3.2.cmml" xref="S2.SS3.SSS4.p1.12.m12.4.4.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS4.p1.12.m12.4.4.3.3.2.1.cmml" xref="S2.SS3.SSS4.p1.12.m12.4.4.3.3">subscript</csymbol><ci id="S2.SS3.SSS4.p1.12.m12.4.4.3.3.2.2.cmml" xref="S2.SS3.SSS4.p1.12.m12.4.4.3.3.2.2">ğ‘¤</ci><ci id="S2.SS3.SSS4.p1.12.m12.4.4.3.3.2.3.cmml" xref="S2.SS3.SSS4.p1.12.m12.4.4.3.3.2.3">ğ‘—</ci></apply><ci id="S2.SS3.SSS4.p1.12.m12.4.4.3.3.3.cmml" xref="S2.SS3.SSS4.p1.12.m12.4.4.3.3.3">ğ¾</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS4.p1.12.m12.4c">\{w_{j}^{1},w_{j}^{2},...,w_{j}^{K}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS4.p1.12.m12.4d">{ italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , â€¦ , italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT }</annotation></semantics></math>,
the decoder first performs average pooling and then generates the reconstructed input representation <math alttext="\mathbf{r}_{j}" class="ltx_Math" display="inline" id="S2.SS3.SSS4.p1.13.m13.1"><semantics id="S2.SS3.SSS4.p1.13.m13.1a"><msub id="S2.SS3.SSS4.p1.13.m13.1.1" xref="S2.SS3.SSS4.p1.13.m13.1.1.cmml"><mi id="S2.SS3.SSS4.p1.13.m13.1.1.2" xref="S2.SS3.SSS4.p1.13.m13.1.1.2.cmml">ğ«</mi><mi id="S2.SS3.SSS4.p1.13.m13.1.1.3" xref="S2.SS3.SSS4.p1.13.m13.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS4.p1.13.m13.1b"><apply id="S2.SS3.SSS4.p1.13.m13.1.1.cmml" xref="S2.SS3.SSS4.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS4.p1.13.m13.1.1.1.cmml" xref="S2.SS3.SSS4.p1.13.m13.1.1">subscript</csymbol><ci id="S2.SS3.SSS4.p1.13.m13.1.1.2.cmml" xref="S2.SS3.SSS4.p1.13.m13.1.1.2">ğ«</ci><ci id="S2.SS3.SSS4.p1.13.m13.1.1.3.cmml" xref="S2.SS3.SSS4.p1.13.m13.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS4.p1.13.m13.1c">\mathbf{r}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS4.p1.13.m13.1d">bold_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> via a three-layer MLP as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx7">
<tbody id="S2.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{r}_{j}=\text{Dec}(\{w_{j}^{1},w_{j}^{2},...,w_{j}^{K}\})=%
\text{MLP}(\frac{1}{K}\sum_{k=1}^{K}\mathbf{c}^{k}_{w^{k}_{j}})." class="ltx_Math" display="inline" id="S2.E9.m1.2"><semantics id="S2.E9.m1.2a"><mrow id="S2.E9.m1.2.2.1" xref="S2.E9.m1.2.2.1.1.cmml"><mrow id="S2.E9.m1.2.2.1.1" xref="S2.E9.m1.2.2.1.1.cmml"><msub id="S2.E9.m1.2.2.1.1.4" xref="S2.E9.m1.2.2.1.1.4.cmml"><mi id="S2.E9.m1.2.2.1.1.4.2" xref="S2.E9.m1.2.2.1.1.4.2.cmml">ğ«</mi><mi id="S2.E9.m1.2.2.1.1.4.3" xref="S2.E9.m1.2.2.1.1.4.3.cmml">j</mi></msub><mo id="S2.E9.m1.2.2.1.1.5" xref="S2.E9.m1.2.2.1.1.5.cmml">=</mo><mrow id="S2.E9.m1.2.2.1.1.1" xref="S2.E9.m1.2.2.1.1.1.cmml"><mtext id="S2.E9.m1.2.2.1.1.1.3" xref="S2.E9.m1.2.2.1.1.1.3a.cmml">Dec</mtext><mo id="S2.E9.m1.2.2.1.1.1.2" xref="S2.E9.m1.2.2.1.1.1.2.cmml">â¢</mo><mrow id="S2.E9.m1.2.2.1.1.1.1.1" xref="S2.E9.m1.2.2.1.1.1.cmml"><mo id="S2.E9.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.E9.m1.2.2.1.1.1.cmml">(</mo><mrow id="S2.E9.m1.2.2.1.1.1.1.1.1.3" xref="S2.E9.m1.2.2.1.1.1.1.1.1.4.cmml"><mo id="S2.E9.m1.2.2.1.1.1.1.1.1.3.4" stretchy="false" xref="S2.E9.m1.2.2.1.1.1.1.1.1.4.cmml">{</mo><msubsup id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">j</mi><mn id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">1</mn></msubsup><mo id="S2.E9.m1.2.2.1.1.1.1.1.1.3.5" xref="S2.E9.m1.2.2.1.1.1.1.1.1.4.cmml">,</mo><msubsup id="S2.E9.m1.2.2.1.1.1.1.1.1.2.2" xref="S2.E9.m1.2.2.1.1.1.1.1.1.2.2.cmml"><mi id="S2.E9.m1.2.2.1.1.1.1.1.1.2.2.2.2" xref="S2.E9.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml">w</mi><mi id="S2.E9.m1.2.2.1.1.1.1.1.1.2.2.2.3" xref="S2.E9.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml">j</mi><mn id="S2.E9.m1.2.2.1.1.1.1.1.1.2.2.3" xref="S2.E9.m1.2.2.1.1.1.1.1.1.2.2.3.cmml">2</mn></msubsup><mo id="S2.E9.m1.2.2.1.1.1.1.1.1.3.6" xref="S2.E9.m1.2.2.1.1.1.1.1.1.4.cmml">,</mo><mi id="S2.E9.m1.1.1" mathvariant="normal" xref="S2.E9.m1.1.1.cmml">â€¦</mi><mo id="S2.E9.m1.2.2.1.1.1.1.1.1.3.7" xref="S2.E9.m1.2.2.1.1.1.1.1.1.4.cmml">,</mo><msubsup id="S2.E9.m1.2.2.1.1.1.1.1.1.3.3" xref="S2.E9.m1.2.2.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E9.m1.2.2.1.1.1.1.1.1.3.3.2.2" xref="S2.E9.m1.2.2.1.1.1.1.1.1.3.3.2.2.cmml">w</mi><mi id="S2.E9.m1.2.2.1.1.1.1.1.1.3.3.2.3" xref="S2.E9.m1.2.2.1.1.1.1.1.1.3.3.2.3.cmml">j</mi><mi id="S2.E9.m1.2.2.1.1.1.1.1.1.3.3.3" xref="S2.E9.m1.2.2.1.1.1.1.1.1.3.3.3.cmml">K</mi></msubsup><mo id="S2.E9.m1.2.2.1.1.1.1.1.1.3.8" stretchy="false" xref="S2.E9.m1.2.2.1.1.1.1.1.1.4.cmml">}</mo></mrow><mo id="S2.E9.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S2.E9.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E9.m1.2.2.1.1.6" xref="S2.E9.m1.2.2.1.1.6.cmml">=</mo><mrow id="S2.E9.m1.2.2.1.1.2" xref="S2.E9.m1.2.2.1.1.2.cmml"><mtext id="S2.E9.m1.2.2.1.1.2.3" xref="S2.E9.m1.2.2.1.1.2.3a.cmml">MLP</mtext><mo id="S2.E9.m1.2.2.1.1.2.2" xref="S2.E9.m1.2.2.1.1.2.2.cmml">â¢</mo><mrow id="S2.E9.m1.2.2.1.1.2.1.1" xref="S2.E9.m1.2.2.1.1.2.1.1.1.cmml"><mo id="S2.E9.m1.2.2.1.1.2.1.1.2" stretchy="false" xref="S2.E9.m1.2.2.1.1.2.1.1.1.cmml">(</mo><mrow id="S2.E9.m1.2.2.1.1.2.1.1.1" xref="S2.E9.m1.2.2.1.1.2.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E9.m1.2.2.1.1.2.1.1.1.2" xref="S2.E9.m1.2.2.1.1.2.1.1.1.2.cmml"><mfrac id="S2.E9.m1.2.2.1.1.2.1.1.1.2a" xref="S2.E9.m1.2.2.1.1.2.1.1.1.2.cmml"><mn id="S2.E9.m1.2.2.1.1.2.1.1.1.2.2" xref="S2.E9.m1.2.2.1.1.2.1.1.1.2.2.cmml">1</mn><mi id="S2.E9.m1.2.2.1.1.2.1.1.1.2.3" xref="S2.E9.m1.2.2.1.1.2.1.1.1.2.3.cmml">K</mi></mfrac></mstyle><mo id="S2.E9.m1.2.2.1.1.2.1.1.1.1" xref="S2.E9.m1.2.2.1.1.2.1.1.1.1.cmml">â¢</mo><mrow id="S2.E9.m1.2.2.1.1.2.1.1.1.3" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.cmml"><mstyle displaystyle="true" id="S2.E9.m1.2.2.1.1.2.1.1.1.3.1" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.cmml"><munderover id="S2.E9.m1.2.2.1.1.2.1.1.1.3.1a" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.cmml"><mo id="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.2" movablelimits="false" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.2.cmml">âˆ‘</mo><mrow id="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.3" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.3.cmml"><mi id="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.3.2" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.3.2.cmml">k</mi><mo id="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.3.1" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.3.3" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.3" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.3.cmml">K</mi></munderover></mstyle><msubsup id="S2.E9.m1.2.2.1.1.2.1.1.1.3.2" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.cmml"><mi id="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.2.2" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.2.2.cmml">ğœ</mi><msubsup id="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3.cmml"><mi id="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3.2.2" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3.2.2.cmml">w</mi><mi id="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3.3" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3.3.cmml">j</mi><mi id="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3.2.3" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3.2.3.cmml">k</mi></msubsup><mi id="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.2.3" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.2.3.cmml">k</mi></msubsup></mrow></mrow><mo id="S2.E9.m1.2.2.1.1.2.1.1.3" stretchy="false" xref="S2.E9.m1.2.2.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E9.m1.2.2.1.2" lspace="0em" xref="S2.E9.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m1.2b"><apply id="S2.E9.m1.2.2.1.1.cmml" xref="S2.E9.m1.2.2.1"><and id="S2.E9.m1.2.2.1.1a.cmml" xref="S2.E9.m1.2.2.1"></and><apply id="S2.E9.m1.2.2.1.1b.cmml" xref="S2.E9.m1.2.2.1"><eq id="S2.E9.m1.2.2.1.1.5.cmml" xref="S2.E9.m1.2.2.1.1.5"></eq><apply id="S2.E9.m1.2.2.1.1.4.cmml" xref="S2.E9.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.1.1.4.1.cmml" xref="S2.E9.m1.2.2.1.1.4">subscript</csymbol><ci id="S2.E9.m1.2.2.1.1.4.2.cmml" xref="S2.E9.m1.2.2.1.1.4.2">ğ«</ci><ci id="S2.E9.m1.2.2.1.1.4.3.cmml" xref="S2.E9.m1.2.2.1.1.4.3">ğ‘—</ci></apply><apply id="S2.E9.m1.2.2.1.1.1.cmml" xref="S2.E9.m1.2.2.1.1.1"><times id="S2.E9.m1.2.2.1.1.1.2.cmml" xref="S2.E9.m1.2.2.1.1.1.2"></times><ci id="S2.E9.m1.2.2.1.1.1.3a.cmml" xref="S2.E9.m1.2.2.1.1.1.3"><mtext id="S2.E9.m1.2.2.1.1.1.3.cmml" xref="S2.E9.m1.2.2.1.1.1.3">Dec</mtext></ci><set id="S2.E9.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.3"><apply id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.2.2">ğ‘¤</ci><ci id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.2.3">ğ‘—</ci></apply><cn id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S2.E9.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S2.E9.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.E9.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.2.2.2.2">ğ‘¤</ci><ci id="S2.E9.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.2.2.2.3">ğ‘—</ci></apply><cn id="S2.E9.m1.2.2.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S2.E9.m1.2.2.1.1.1.1.1.1.2.2.3">2</cn></apply><ci id="S2.E9.m1.1.1.cmml" xref="S2.E9.m1.1.1">â€¦</ci><apply id="S2.E9.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S2.E9.m1.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.1.1.1.1.1.1.3.3.2.1.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E9.m1.2.2.1.1.1.1.1.1.3.3.2.2.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.3.3.2.2">ğ‘¤</ci><ci id="S2.E9.m1.2.2.1.1.1.1.1.1.3.3.2.3.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.3.3.2.3">ğ‘—</ci></apply><ci id="S2.E9.m1.2.2.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.3.3.3">ğ¾</ci></apply></set></apply></apply><apply id="S2.E9.m1.2.2.1.1c.cmml" xref="S2.E9.m1.2.2.1"><eq id="S2.E9.m1.2.2.1.1.6.cmml" xref="S2.E9.m1.2.2.1.1.6"></eq><share href="https://arxiv.org/html/2406.10450v2#S2.E9.m1.2.2.1.1.1.cmml" id="S2.E9.m1.2.2.1.1d.cmml" xref="S2.E9.m1.2.2.1"></share><apply id="S2.E9.m1.2.2.1.1.2.cmml" xref="S2.E9.m1.2.2.1.1.2"><times id="S2.E9.m1.2.2.1.1.2.2.cmml" xref="S2.E9.m1.2.2.1.1.2.2"></times><ci id="S2.E9.m1.2.2.1.1.2.3a.cmml" xref="S2.E9.m1.2.2.1.1.2.3"><mtext id="S2.E9.m1.2.2.1.1.2.3.cmml" xref="S2.E9.m1.2.2.1.1.2.3">MLP</mtext></ci><apply id="S2.E9.m1.2.2.1.1.2.1.1.1.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1"><times id="S2.E9.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.1"></times><apply id="S2.E9.m1.2.2.1.1.2.1.1.1.2.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.2"><divide id="S2.E9.m1.2.2.1.1.2.1.1.1.2.1.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.2"></divide><cn id="S2.E9.m1.2.2.1.1.2.1.1.1.2.2.cmml" type="integer" xref="S2.E9.m1.2.2.1.1.2.1.1.1.2.2">1</cn><ci id="S2.E9.m1.2.2.1.1.2.1.1.1.2.3.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.2.3">ğ¾</ci></apply><apply id="S2.E9.m1.2.2.1.1.2.1.1.1.3.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3"><apply id="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.1.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.1">superscript</csymbol><apply id="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.1.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.1">subscript</csymbol><sum id="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.2.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.2"></sum><apply id="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.3.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.3"><eq id="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.3.1.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.3.1"></eq><ci id="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.3.2.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.3.2">ğ‘˜</ci><cn id="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.3.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.1.3">ğ¾</ci></apply><apply id="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.1.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.2">subscript</csymbol><apply id="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.2.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.2.1.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.2">superscript</csymbol><ci id="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.2.2.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.2.2">ğœ</ci><ci id="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.2.3.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.2.3">ğ‘˜</ci></apply><apply id="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3.1.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3">subscript</csymbol><apply id="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3.2.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3.2.1.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3">superscript</csymbol><ci id="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3.2.2.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3.2.2">ğ‘¤</ci><ci id="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3.2.3.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3.2.3">ğ‘˜</ci></apply><ci id="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3.3.cmml" xref="S2.E9.m1.2.2.1.1.2.1.1.1.3.2.3.3">ğ‘—</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m1.2c">\displaystyle\mathbf{r}_{j}=\text{Dec}(\{w_{j}^{1},w_{j}^{2},...,w_{j}^{K}\})=%
\text{MLP}(\frac{1}{K}\sum_{k=1}^{K}\mathbf{c}^{k}_{w^{k}_{j}}).</annotation><annotation encoding="application/x-llamapun" id="S2.E9.m1.2d">bold_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = Dec ( { italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , â€¦ , italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT } ) = MLP ( divide start_ARG 1 end_ARG start_ARG italic_K end_ARG âˆ‘ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT bold_c start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS3.SSS5">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S2.SS3.SSS5.4.1.1">II-C</span>5 </span><span class="ltx_text ltx_font_bold" id="S2.SS3.SSS5.5.2">Learning Objective</span>
</h4>
<div class="ltx_para" id="S2.SS3.SSS5.p1">
<p class="ltx_p" id="S2.SS3.SSS5.p1.6">In order to effectively learn the <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p1.1.m1.1"><semantics id="S2.SS3.SSS5.p1.1.m1.1a"><mi id="S2.SS3.SSS5.p1.1.m1.1.1" xref="S2.SS3.SSS5.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p1.1.m1.1b"><ci id="S2.SS3.SSS5.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS5.p1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p1.1.m1.1d">italic_K</annotation></semantics></math>-way encoder, codebook, and <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p1.2.m2.1"><semantics id="S2.SS3.SSS5.p1.2.m2.1a"><mi id="S2.SS3.SSS5.p1.2.m2.1.1" xref="S2.SS3.SSS5.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p1.2.m2.1b"><ci id="S2.SS3.SSS5.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS5.p1.2.m2.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p1.2.m2.1d">italic_K</annotation></semantics></math>-to-1 Decoder for user and item MQ-Tokenizers, a <em class="ltx_emph ltx_font_italic" id="S2.SS3.SSS5.p1.6.1">reconstruction loss</em> is designed to reconstruct the prototype inputs from the set of discrete vectors.
To be more specific, given the item <math alttext="v_{j}" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p1.3.m3.1"><semantics id="S2.SS3.SSS5.p1.3.m3.1a"><msub id="S2.SS3.SSS5.p1.3.m3.1.1" xref="S2.SS3.SSS5.p1.3.m3.1.1.cmml"><mi id="S2.SS3.SSS5.p1.3.m3.1.1.2" xref="S2.SS3.SSS5.p1.3.m3.1.1.2.cmml">v</mi><mi id="S2.SS3.SSS5.p1.3.m3.1.1.3" xref="S2.SS3.SSS5.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p1.3.m3.1b"><apply id="S2.SS3.SSS5.p1.3.m3.1.1.cmml" xref="S2.SS3.SSS5.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS5.p1.3.m3.1.1.1.cmml" xref="S2.SS3.SSS5.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.SSS5.p1.3.m3.1.1.2.cmml" xref="S2.SS3.SSS5.p1.3.m3.1.1.2">ğ‘£</ci><ci id="S2.SS3.SSS5.p1.3.m3.1.1.3.cmml" xref="S2.SS3.SSS5.p1.3.m3.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p1.3.m3.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p1.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, the reconstruction loss encourages the reconstructed representation <math alttext="\mathbf{r}_{j}" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p1.4.m4.1"><semantics id="S2.SS3.SSS5.p1.4.m4.1a"><msub id="S2.SS3.SSS5.p1.4.m4.1.1" xref="S2.SS3.SSS5.p1.4.m4.1.1.cmml"><mi id="S2.SS3.SSS5.p1.4.m4.1.1.2" xref="S2.SS3.SSS5.p1.4.m4.1.1.2.cmml">ğ«</mi><mi id="S2.SS3.SSS5.p1.4.m4.1.1.3" xref="S2.SS3.SSS5.p1.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p1.4.m4.1b"><apply id="S2.SS3.SSS5.p1.4.m4.1.1.cmml" xref="S2.SS3.SSS5.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS5.p1.4.m4.1.1.1.cmml" xref="S2.SS3.SSS5.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS3.SSS5.p1.4.m4.1.1.2.cmml" xref="S2.SS3.SSS5.p1.4.m4.1.1.2">ğ«</ci><ci id="S2.SS3.SSS5.p1.4.m4.1.1.3.cmml" xref="S2.SS3.SSS5.p1.4.m4.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p1.4.m4.1c">\mathbf{r}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p1.4.m4.1d">bold_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> from the <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p1.5.m5.1"><semantics id="S2.SS3.SSS5.p1.5.m5.1a"><mi id="S2.SS3.SSS5.p1.5.m5.1.1" xref="S2.SS3.SSS5.p1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p1.5.m5.1b"><ci id="S2.SS3.SSS5.p1.5.m5.1.1.cmml" xref="S2.SS3.SSS5.p1.5.m5.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p1.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p1.5.m5.1d">italic_K</annotation></semantics></math>-to-1 decoder to approximate original item representation <math alttext="\mathbf{q}_{j}" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p1.6.m6.1"><semantics id="S2.SS3.SSS5.p1.6.m6.1a"><msub id="S2.SS3.SSS5.p1.6.m6.1.1" xref="S2.SS3.SSS5.p1.6.m6.1.1.cmml"><mi id="S2.SS3.SSS5.p1.6.m6.1.1.2" xref="S2.SS3.SSS5.p1.6.m6.1.1.2.cmml">ğª</mi><mi id="S2.SS3.SSS5.p1.6.m6.1.1.3" xref="S2.SS3.SSS5.p1.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p1.6.m6.1b"><apply id="S2.SS3.SSS5.p1.6.m6.1.1.cmml" xref="S2.SS3.SSS5.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS5.p1.6.m6.1.1.1.cmml" xref="S2.SS3.SSS5.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS3.SSS5.p1.6.m6.1.1.2.cmml" xref="S2.SS3.SSS5.p1.6.m6.1.1.2">ğª</ci><ci id="S2.SS3.SSS5.p1.6.m6.1.1.3.cmml" xref="S2.SS3.SSS5.p1.6.m6.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p1.6.m6.1c">\mathbf{q}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p1.6.m6.1d">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> learned from GNNs, which can be defined as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx8">
<tbody id="S2.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}^{Item}_{recon}=\|\mathbf{q}_{j}-\mathbf{r}_{j}\|^{2}." class="ltx_Math" display="inline" id="S2.E10.m1.1"><semantics id="S2.E10.m1.1a"><mrow id="S2.E10.m1.1.1.1" xref="S2.E10.m1.1.1.1.1.cmml"><mrow id="S2.E10.m1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.cmml"><msubsup id="S2.E10.m1.1.1.1.1.3" xref="S2.E10.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E10.m1.1.1.1.1.3.2.2" xref="S2.E10.m1.1.1.1.1.3.2.2.cmml">â„’</mi><mrow id="S2.E10.m1.1.1.1.1.3.3" xref="S2.E10.m1.1.1.1.1.3.3.cmml"><mi id="S2.E10.m1.1.1.1.1.3.3.2" xref="S2.E10.m1.1.1.1.1.3.3.2.cmml">r</mi><mo id="S2.E10.m1.1.1.1.1.3.3.1" xref="S2.E10.m1.1.1.1.1.3.3.1.cmml">â¢</mo><mi id="S2.E10.m1.1.1.1.1.3.3.3" xref="S2.E10.m1.1.1.1.1.3.3.3.cmml">e</mi><mo id="S2.E10.m1.1.1.1.1.3.3.1a" xref="S2.E10.m1.1.1.1.1.3.3.1.cmml">â¢</mo><mi id="S2.E10.m1.1.1.1.1.3.3.4" xref="S2.E10.m1.1.1.1.1.3.3.4.cmml">c</mi><mo id="S2.E10.m1.1.1.1.1.3.3.1b" xref="S2.E10.m1.1.1.1.1.3.3.1.cmml">â¢</mo><mi id="S2.E10.m1.1.1.1.1.3.3.5" xref="S2.E10.m1.1.1.1.1.3.3.5.cmml">o</mi><mo id="S2.E10.m1.1.1.1.1.3.3.1c" xref="S2.E10.m1.1.1.1.1.3.3.1.cmml">â¢</mo><mi id="S2.E10.m1.1.1.1.1.3.3.6" xref="S2.E10.m1.1.1.1.1.3.3.6.cmml">n</mi></mrow><mrow id="S2.E10.m1.1.1.1.1.3.2.3" xref="S2.E10.m1.1.1.1.1.3.2.3.cmml"><mi id="S2.E10.m1.1.1.1.1.3.2.3.2" xref="S2.E10.m1.1.1.1.1.3.2.3.2.cmml">I</mi><mo id="S2.E10.m1.1.1.1.1.3.2.3.1" xref="S2.E10.m1.1.1.1.1.3.2.3.1.cmml">â¢</mo><mi id="S2.E10.m1.1.1.1.1.3.2.3.3" xref="S2.E10.m1.1.1.1.1.3.2.3.3.cmml">t</mi><mo id="S2.E10.m1.1.1.1.1.3.2.3.1a" xref="S2.E10.m1.1.1.1.1.3.2.3.1.cmml">â¢</mo><mi id="S2.E10.m1.1.1.1.1.3.2.3.4" xref="S2.E10.m1.1.1.1.1.3.2.3.4.cmml">e</mi><mo id="S2.E10.m1.1.1.1.1.3.2.3.1b" xref="S2.E10.m1.1.1.1.1.3.2.3.1.cmml">â¢</mo><mi id="S2.E10.m1.1.1.1.1.3.2.3.5" xref="S2.E10.m1.1.1.1.1.3.2.3.5.cmml">m</mi></mrow></msubsup><mo id="S2.E10.m1.1.1.1.1.2" xref="S2.E10.m1.1.1.1.1.2.cmml">=</mo><msup id="S2.E10.m1.1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.1.cmml"><mrow id="S2.E10.m1.1.1.1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.1.1.2.cmml"><mo id="S2.E10.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E10.m1.1.1.1.1.1.1.2.1.cmml">â€–</mo><mrow id="S2.E10.m1.1.1.1.1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E10.m1.1.1.1.1.1.1.1.1.2" xref="S2.E10.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E10.m1.1.1.1.1.1.1.1.1.2.2" xref="S2.E10.m1.1.1.1.1.1.1.1.1.2.2.cmml">ğª</mi><mi id="S2.E10.m1.1.1.1.1.1.1.1.1.2.3" xref="S2.E10.m1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="S2.E10.m1.1.1.1.1.1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.cmml">âˆ’</mo><msub id="S2.E10.m1.1.1.1.1.1.1.1.1.3" xref="S2.E10.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E10.m1.1.1.1.1.1.1.1.1.3.2" xref="S2.E10.m1.1.1.1.1.1.1.1.1.3.2.cmml">ğ«</mi><mi id="S2.E10.m1.1.1.1.1.1.1.1.1.3.3" xref="S2.E10.m1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S2.E10.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E10.m1.1.1.1.1.1.1.2.1.cmml">â€–</mo></mrow><mn id="S2.E10.m1.1.1.1.1.1.3" xref="S2.E10.m1.1.1.1.1.1.3.cmml">2</mn></msup></mrow><mo id="S2.E10.m1.1.1.1.2" lspace="0em" xref="S2.E10.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E10.m1.1b"><apply id="S2.E10.m1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1"><eq id="S2.E10.m1.1.1.1.1.2.cmml" xref="S2.E10.m1.1.1.1.1.2"></eq><apply id="S2.E10.m1.1.1.1.1.3.cmml" xref="S2.E10.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.1.1.3.1.cmml" xref="S2.E10.m1.1.1.1.1.3">subscript</csymbol><apply id="S2.E10.m1.1.1.1.1.3.2.cmml" xref="S2.E10.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.1.1.3.2.1.cmml" xref="S2.E10.m1.1.1.1.1.3">superscript</csymbol><ci id="S2.E10.m1.1.1.1.1.3.2.2.cmml" xref="S2.E10.m1.1.1.1.1.3.2.2">â„’</ci><apply id="S2.E10.m1.1.1.1.1.3.2.3.cmml" xref="S2.E10.m1.1.1.1.1.3.2.3"><times id="S2.E10.m1.1.1.1.1.3.2.3.1.cmml" xref="S2.E10.m1.1.1.1.1.3.2.3.1"></times><ci id="S2.E10.m1.1.1.1.1.3.2.3.2.cmml" xref="S2.E10.m1.1.1.1.1.3.2.3.2">ğ¼</ci><ci id="S2.E10.m1.1.1.1.1.3.2.3.3.cmml" xref="S2.E10.m1.1.1.1.1.3.2.3.3">ğ‘¡</ci><ci id="S2.E10.m1.1.1.1.1.3.2.3.4.cmml" xref="S2.E10.m1.1.1.1.1.3.2.3.4">ğ‘’</ci><ci id="S2.E10.m1.1.1.1.1.3.2.3.5.cmml" xref="S2.E10.m1.1.1.1.1.3.2.3.5">ğ‘š</ci></apply></apply><apply id="S2.E10.m1.1.1.1.1.3.3.cmml" xref="S2.E10.m1.1.1.1.1.3.3"><times id="S2.E10.m1.1.1.1.1.3.3.1.cmml" xref="S2.E10.m1.1.1.1.1.3.3.1"></times><ci id="S2.E10.m1.1.1.1.1.3.3.2.cmml" xref="S2.E10.m1.1.1.1.1.3.3.2">ğ‘Ÿ</ci><ci id="S2.E10.m1.1.1.1.1.3.3.3.cmml" xref="S2.E10.m1.1.1.1.1.3.3.3">ğ‘’</ci><ci id="S2.E10.m1.1.1.1.1.3.3.4.cmml" xref="S2.E10.m1.1.1.1.1.3.3.4">ğ‘</ci><ci id="S2.E10.m1.1.1.1.1.3.3.5.cmml" xref="S2.E10.m1.1.1.1.1.3.3.5">ğ‘œ</ci><ci id="S2.E10.m1.1.1.1.1.3.3.6.cmml" xref="S2.E10.m1.1.1.1.1.3.3.6">ğ‘›</ci></apply></apply><apply id="S2.E10.m1.1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.1.1.1.2.cmml" xref="S2.E10.m1.1.1.1.1.1">superscript</csymbol><apply id="S2.E10.m1.1.1.1.1.1.1.2.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E10.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1"><minus id="S2.E10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S2.E10.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E10.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.2.2">ğª</ci><ci id="S2.E10.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.2.3">ğ‘—</ci></apply><apply id="S2.E10.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E10.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.3.2">ğ«</ci><ci id="S2.E10.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.3.3">ğ‘—</ci></apply></apply></apply><cn id="S2.E10.m1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E10.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E10.m1.1c">\displaystyle\mathcal{L}^{Item}_{recon}=\|\mathbf{q}_{j}-\mathbf{r}_{j}\|^{2}.</annotation><annotation encoding="application/x-llamapun" id="S2.E10.m1.1d">caligraphic_L start_POSTSUPERSCRIPT italic_I italic_t italic_e italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r italic_e italic_c italic_o italic_n end_POSTSUBSCRIPT = âˆ¥ bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - bold_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT âˆ¥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS5.p1.7">However, the <em class="ltx_emph ltx_font_italic" id="S2.SS3.SSS5.p1.7.1">argÂ min</em> operation in Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.E5" title="In II-C3 ğ¾-way Encoder and Codebook â€£ II-C Masked Vector-Quantized Tokenizers for Users and Items â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">5</span></a>) is non-differentiableÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib21" title="">21</a>]</cite>, leading to an intractable computation for the gradient back-propagation in the reconstruction loss <math alttext="\mathcal{L}^{Item}_{recon}" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p1.7.m1.1"><semantics id="S2.SS3.SSS5.p1.7.m1.1a"><msubsup id="S2.SS3.SSS5.p1.7.m1.1.1" xref="S2.SS3.SSS5.p1.7.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS5.p1.7.m1.1.1.2.2" xref="S2.SS3.SSS5.p1.7.m1.1.1.2.2.cmml">â„’</mi><mrow id="S2.SS3.SSS5.p1.7.m1.1.1.3" xref="S2.SS3.SSS5.p1.7.m1.1.1.3.cmml"><mi id="S2.SS3.SSS5.p1.7.m1.1.1.3.2" xref="S2.SS3.SSS5.p1.7.m1.1.1.3.2.cmml">r</mi><mo id="S2.SS3.SSS5.p1.7.m1.1.1.3.1" xref="S2.SS3.SSS5.p1.7.m1.1.1.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p1.7.m1.1.1.3.3" xref="S2.SS3.SSS5.p1.7.m1.1.1.3.3.cmml">e</mi><mo id="S2.SS3.SSS5.p1.7.m1.1.1.3.1a" xref="S2.SS3.SSS5.p1.7.m1.1.1.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p1.7.m1.1.1.3.4" xref="S2.SS3.SSS5.p1.7.m1.1.1.3.4.cmml">c</mi><mo id="S2.SS3.SSS5.p1.7.m1.1.1.3.1b" xref="S2.SS3.SSS5.p1.7.m1.1.1.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p1.7.m1.1.1.3.5" xref="S2.SS3.SSS5.p1.7.m1.1.1.3.5.cmml">o</mi><mo id="S2.SS3.SSS5.p1.7.m1.1.1.3.1c" xref="S2.SS3.SSS5.p1.7.m1.1.1.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p1.7.m1.1.1.3.6" xref="S2.SS3.SSS5.p1.7.m1.1.1.3.6.cmml">n</mi></mrow><mrow id="S2.SS3.SSS5.p1.7.m1.1.1.2.3" xref="S2.SS3.SSS5.p1.7.m1.1.1.2.3.cmml"><mi id="S2.SS3.SSS5.p1.7.m1.1.1.2.3.2" xref="S2.SS3.SSS5.p1.7.m1.1.1.2.3.2.cmml">I</mi><mo id="S2.SS3.SSS5.p1.7.m1.1.1.2.3.1" xref="S2.SS3.SSS5.p1.7.m1.1.1.2.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p1.7.m1.1.1.2.3.3" xref="S2.SS3.SSS5.p1.7.m1.1.1.2.3.3.cmml">t</mi><mo id="S2.SS3.SSS5.p1.7.m1.1.1.2.3.1a" xref="S2.SS3.SSS5.p1.7.m1.1.1.2.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p1.7.m1.1.1.2.3.4" xref="S2.SS3.SSS5.p1.7.m1.1.1.2.3.4.cmml">e</mi><mo id="S2.SS3.SSS5.p1.7.m1.1.1.2.3.1b" xref="S2.SS3.SSS5.p1.7.m1.1.1.2.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p1.7.m1.1.1.2.3.5" xref="S2.SS3.SSS5.p1.7.m1.1.1.2.3.5.cmml">m</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p1.7.m1.1b"><apply id="S2.SS3.SSS5.p1.7.m1.1.1.cmml" xref="S2.SS3.SSS5.p1.7.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS5.p1.7.m1.1.1.1.cmml" xref="S2.SS3.SSS5.p1.7.m1.1.1">subscript</csymbol><apply id="S2.SS3.SSS5.p1.7.m1.1.1.2.cmml" xref="S2.SS3.SSS5.p1.7.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS5.p1.7.m1.1.1.2.1.cmml" xref="S2.SS3.SSS5.p1.7.m1.1.1">superscript</csymbol><ci id="S2.SS3.SSS5.p1.7.m1.1.1.2.2.cmml" xref="S2.SS3.SSS5.p1.7.m1.1.1.2.2">â„’</ci><apply id="S2.SS3.SSS5.p1.7.m1.1.1.2.3.cmml" xref="S2.SS3.SSS5.p1.7.m1.1.1.2.3"><times id="S2.SS3.SSS5.p1.7.m1.1.1.2.3.1.cmml" xref="S2.SS3.SSS5.p1.7.m1.1.1.2.3.1"></times><ci id="S2.SS3.SSS5.p1.7.m1.1.1.2.3.2.cmml" xref="S2.SS3.SSS5.p1.7.m1.1.1.2.3.2">ğ¼</ci><ci id="S2.SS3.SSS5.p1.7.m1.1.1.2.3.3.cmml" xref="S2.SS3.SSS5.p1.7.m1.1.1.2.3.3">ğ‘¡</ci><ci id="S2.SS3.SSS5.p1.7.m1.1.1.2.3.4.cmml" xref="S2.SS3.SSS5.p1.7.m1.1.1.2.3.4">ğ‘’</ci><ci id="S2.SS3.SSS5.p1.7.m1.1.1.2.3.5.cmml" xref="S2.SS3.SSS5.p1.7.m1.1.1.2.3.5">ğ‘š</ci></apply></apply><apply id="S2.SS3.SSS5.p1.7.m1.1.1.3.cmml" xref="S2.SS3.SSS5.p1.7.m1.1.1.3"><times id="S2.SS3.SSS5.p1.7.m1.1.1.3.1.cmml" xref="S2.SS3.SSS5.p1.7.m1.1.1.3.1"></times><ci id="S2.SS3.SSS5.p1.7.m1.1.1.3.2.cmml" xref="S2.SS3.SSS5.p1.7.m1.1.1.3.2">ğ‘Ÿ</ci><ci id="S2.SS3.SSS5.p1.7.m1.1.1.3.3.cmml" xref="S2.SS3.SSS5.p1.7.m1.1.1.3.3">ğ‘’</ci><ci id="S2.SS3.SSS5.p1.7.m1.1.1.3.4.cmml" xref="S2.SS3.SSS5.p1.7.m1.1.1.3.4">ğ‘</ci><ci id="S2.SS3.SSS5.p1.7.m1.1.1.3.5.cmml" xref="S2.SS3.SSS5.p1.7.m1.1.1.3.5">ğ‘œ</ci><ci id="S2.SS3.SSS5.p1.7.m1.1.1.3.6.cmml" xref="S2.SS3.SSS5.p1.7.m1.1.1.3.6">ğ‘›</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p1.7.m1.1c">\mathcal{L}^{Item}_{recon}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p1.7.m1.1d">caligraphic_L start_POSTSUPERSCRIPT italic_I italic_t italic_e italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r italic_e italic_c italic_o italic_n end_POSTSUBSCRIPT</annotation></semantics></math> during optimization.
To this end, a straight-through gradient estimatorÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib17" title="">17</a>]</cite> is introduced to directly assign the gradients of the decoder inputs (i.e., the selected tokensâ€™ embeddings) to the encoder outputs (i.e ., the encoded representations), so as to optimize the encoders and decoder.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS5.p2">
<p class="ltx_p" id="S2.SS3.SSS5.p2.10">Meanwhile, optimizing the reconstruction loss <math alttext="\mathcal{L}^{Item}_{recon}" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p2.1.m1.1"><semantics id="S2.SS3.SSS5.p2.1.m1.1a"><msubsup id="S2.SS3.SSS5.p2.1.m1.1.1" xref="S2.SS3.SSS5.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS5.p2.1.m1.1.1.2.2" xref="S2.SS3.SSS5.p2.1.m1.1.1.2.2.cmml">â„’</mi><mrow id="S2.SS3.SSS5.p2.1.m1.1.1.3" xref="S2.SS3.SSS5.p2.1.m1.1.1.3.cmml"><mi id="S2.SS3.SSS5.p2.1.m1.1.1.3.2" xref="S2.SS3.SSS5.p2.1.m1.1.1.3.2.cmml">r</mi><mo id="S2.SS3.SSS5.p2.1.m1.1.1.3.1" xref="S2.SS3.SSS5.p2.1.m1.1.1.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p2.1.m1.1.1.3.3" xref="S2.SS3.SSS5.p2.1.m1.1.1.3.3.cmml">e</mi><mo id="S2.SS3.SSS5.p2.1.m1.1.1.3.1a" xref="S2.SS3.SSS5.p2.1.m1.1.1.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p2.1.m1.1.1.3.4" xref="S2.SS3.SSS5.p2.1.m1.1.1.3.4.cmml">c</mi><mo id="S2.SS3.SSS5.p2.1.m1.1.1.3.1b" xref="S2.SS3.SSS5.p2.1.m1.1.1.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p2.1.m1.1.1.3.5" xref="S2.SS3.SSS5.p2.1.m1.1.1.3.5.cmml">o</mi><mo id="S2.SS3.SSS5.p2.1.m1.1.1.3.1c" xref="S2.SS3.SSS5.p2.1.m1.1.1.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p2.1.m1.1.1.3.6" xref="S2.SS3.SSS5.p2.1.m1.1.1.3.6.cmml">n</mi></mrow><mrow id="S2.SS3.SSS5.p2.1.m1.1.1.2.3" xref="S2.SS3.SSS5.p2.1.m1.1.1.2.3.cmml"><mi id="S2.SS3.SSS5.p2.1.m1.1.1.2.3.2" xref="S2.SS3.SSS5.p2.1.m1.1.1.2.3.2.cmml">I</mi><mo id="S2.SS3.SSS5.p2.1.m1.1.1.2.3.1" xref="S2.SS3.SSS5.p2.1.m1.1.1.2.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p2.1.m1.1.1.2.3.3" xref="S2.SS3.SSS5.p2.1.m1.1.1.2.3.3.cmml">t</mi><mo id="S2.SS3.SSS5.p2.1.m1.1.1.2.3.1a" xref="S2.SS3.SSS5.p2.1.m1.1.1.2.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p2.1.m1.1.1.2.3.4" xref="S2.SS3.SSS5.p2.1.m1.1.1.2.3.4.cmml">e</mi><mo id="S2.SS3.SSS5.p2.1.m1.1.1.2.3.1b" xref="S2.SS3.SSS5.p2.1.m1.1.1.2.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p2.1.m1.1.1.2.3.5" xref="S2.SS3.SSS5.p2.1.m1.1.1.2.3.5.cmml">m</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p2.1.m1.1b"><apply id="S2.SS3.SSS5.p2.1.m1.1.1.cmml" xref="S2.SS3.SSS5.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS5.p2.1.m1.1.1.1.cmml" xref="S2.SS3.SSS5.p2.1.m1.1.1">subscript</csymbol><apply id="S2.SS3.SSS5.p2.1.m1.1.1.2.cmml" xref="S2.SS3.SSS5.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS5.p2.1.m1.1.1.2.1.cmml" xref="S2.SS3.SSS5.p2.1.m1.1.1">superscript</csymbol><ci id="S2.SS3.SSS5.p2.1.m1.1.1.2.2.cmml" xref="S2.SS3.SSS5.p2.1.m1.1.1.2.2">â„’</ci><apply id="S2.SS3.SSS5.p2.1.m1.1.1.2.3.cmml" xref="S2.SS3.SSS5.p2.1.m1.1.1.2.3"><times id="S2.SS3.SSS5.p2.1.m1.1.1.2.3.1.cmml" xref="S2.SS3.SSS5.p2.1.m1.1.1.2.3.1"></times><ci id="S2.SS3.SSS5.p2.1.m1.1.1.2.3.2.cmml" xref="S2.SS3.SSS5.p2.1.m1.1.1.2.3.2">ğ¼</ci><ci id="S2.SS3.SSS5.p2.1.m1.1.1.2.3.3.cmml" xref="S2.SS3.SSS5.p2.1.m1.1.1.2.3.3">ğ‘¡</ci><ci id="S2.SS3.SSS5.p2.1.m1.1.1.2.3.4.cmml" xref="S2.SS3.SSS5.p2.1.m1.1.1.2.3.4">ğ‘’</ci><ci id="S2.SS3.SSS5.p2.1.m1.1.1.2.3.5.cmml" xref="S2.SS3.SSS5.p2.1.m1.1.1.2.3.5">ğ‘š</ci></apply></apply><apply id="S2.SS3.SSS5.p2.1.m1.1.1.3.cmml" xref="S2.SS3.SSS5.p2.1.m1.1.1.3"><times id="S2.SS3.SSS5.p2.1.m1.1.1.3.1.cmml" xref="S2.SS3.SSS5.p2.1.m1.1.1.3.1"></times><ci id="S2.SS3.SSS5.p2.1.m1.1.1.3.2.cmml" xref="S2.SS3.SSS5.p2.1.m1.1.1.3.2">ğ‘Ÿ</ci><ci id="S2.SS3.SSS5.p2.1.m1.1.1.3.3.cmml" xref="S2.SS3.SSS5.p2.1.m1.1.1.3.3">ğ‘’</ci><ci id="S2.SS3.SSS5.p2.1.m1.1.1.3.4.cmml" xref="S2.SS3.SSS5.p2.1.m1.1.1.3.4">ğ‘</ci><ci id="S2.SS3.SSS5.p2.1.m1.1.1.3.5.cmml" xref="S2.SS3.SSS5.p2.1.m1.1.1.3.5">ğ‘œ</ci><ci id="S2.SS3.SSS5.p2.1.m1.1.1.3.6.cmml" xref="S2.SS3.SSS5.p2.1.m1.1.1.3.6">ğ‘›</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p2.1.m1.1c">\mathcal{L}^{Item}_{recon}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p2.1.m1.1d">caligraphic_L start_POSTSUPERSCRIPT italic_I italic_t italic_e italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r italic_e italic_c italic_o italic_n end_POSTSUBSCRIPT</annotation></semantics></math> cannot provide any gradients to update itemsâ€™ <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p2.2.m2.1"><semantics id="S2.SS3.SSS5.p2.2.m2.1a"><mi id="S2.SS3.SSS5.p2.2.m2.1.1" xref="S2.SS3.SSS5.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p2.2.m2.1b"><ci id="S2.SS3.SSS5.p2.2.m2.1.1.cmml" xref="S2.SS3.SSS5.p2.2.m2.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p2.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p2.2.m2.1d">italic_K</annotation></semantics></math>-way codebook <math alttext="\mathbf{C}" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p2.3.m3.1"><semantics id="S2.SS3.SSS5.p2.3.m3.1a"><mi id="S2.SS3.SSS5.p2.3.m3.1.1" xref="S2.SS3.SSS5.p2.3.m3.1.1.cmml">ğ‚</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p2.3.m3.1b"><ci id="S2.SS3.SSS5.p2.3.m3.1.1.cmml" xref="S2.SS3.SSS5.p2.3.m3.1.1">ğ‚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p2.3.m3.1c">\mathbf{C}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p2.3.m3.1d">bold_C</annotation></semantics></math>. To address this, a <em class="ltx_emph ltx_font_italic" id="S2.SS3.SSS5.p2.10.1">codebook loss</em> <math alttext="\mathcal{L}^{Item}_{cb}" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p2.4.m4.1"><semantics id="S2.SS3.SSS5.p2.4.m4.1a"><msubsup id="S2.SS3.SSS5.p2.4.m4.1.1" xref="S2.SS3.SSS5.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS5.p2.4.m4.1.1.2.2" xref="S2.SS3.SSS5.p2.4.m4.1.1.2.2.cmml">â„’</mi><mrow id="S2.SS3.SSS5.p2.4.m4.1.1.3" xref="S2.SS3.SSS5.p2.4.m4.1.1.3.cmml"><mi id="S2.SS3.SSS5.p2.4.m4.1.1.3.2" xref="S2.SS3.SSS5.p2.4.m4.1.1.3.2.cmml">c</mi><mo id="S2.SS3.SSS5.p2.4.m4.1.1.3.1" xref="S2.SS3.SSS5.p2.4.m4.1.1.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p2.4.m4.1.1.3.3" xref="S2.SS3.SSS5.p2.4.m4.1.1.3.3.cmml">b</mi></mrow><mrow id="S2.SS3.SSS5.p2.4.m4.1.1.2.3" xref="S2.SS3.SSS5.p2.4.m4.1.1.2.3.cmml"><mi id="S2.SS3.SSS5.p2.4.m4.1.1.2.3.2" xref="S2.SS3.SSS5.p2.4.m4.1.1.2.3.2.cmml">I</mi><mo id="S2.SS3.SSS5.p2.4.m4.1.1.2.3.1" xref="S2.SS3.SSS5.p2.4.m4.1.1.2.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p2.4.m4.1.1.2.3.3" xref="S2.SS3.SSS5.p2.4.m4.1.1.2.3.3.cmml">t</mi><mo id="S2.SS3.SSS5.p2.4.m4.1.1.2.3.1a" xref="S2.SS3.SSS5.p2.4.m4.1.1.2.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p2.4.m4.1.1.2.3.4" xref="S2.SS3.SSS5.p2.4.m4.1.1.2.3.4.cmml">e</mi><mo id="S2.SS3.SSS5.p2.4.m4.1.1.2.3.1b" xref="S2.SS3.SSS5.p2.4.m4.1.1.2.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p2.4.m4.1.1.2.3.5" xref="S2.SS3.SSS5.p2.4.m4.1.1.2.3.5.cmml">m</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p2.4.m4.1b"><apply id="S2.SS3.SSS5.p2.4.m4.1.1.cmml" xref="S2.SS3.SSS5.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS5.p2.4.m4.1.1.1.cmml" xref="S2.SS3.SSS5.p2.4.m4.1.1">subscript</csymbol><apply id="S2.SS3.SSS5.p2.4.m4.1.1.2.cmml" xref="S2.SS3.SSS5.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS5.p2.4.m4.1.1.2.1.cmml" xref="S2.SS3.SSS5.p2.4.m4.1.1">superscript</csymbol><ci id="S2.SS3.SSS5.p2.4.m4.1.1.2.2.cmml" xref="S2.SS3.SSS5.p2.4.m4.1.1.2.2">â„’</ci><apply id="S2.SS3.SSS5.p2.4.m4.1.1.2.3.cmml" xref="S2.SS3.SSS5.p2.4.m4.1.1.2.3"><times id="S2.SS3.SSS5.p2.4.m4.1.1.2.3.1.cmml" xref="S2.SS3.SSS5.p2.4.m4.1.1.2.3.1"></times><ci id="S2.SS3.SSS5.p2.4.m4.1.1.2.3.2.cmml" xref="S2.SS3.SSS5.p2.4.m4.1.1.2.3.2">ğ¼</ci><ci id="S2.SS3.SSS5.p2.4.m4.1.1.2.3.3.cmml" xref="S2.SS3.SSS5.p2.4.m4.1.1.2.3.3">ğ‘¡</ci><ci id="S2.SS3.SSS5.p2.4.m4.1.1.2.3.4.cmml" xref="S2.SS3.SSS5.p2.4.m4.1.1.2.3.4">ğ‘’</ci><ci id="S2.SS3.SSS5.p2.4.m4.1.1.2.3.5.cmml" xref="S2.SS3.SSS5.p2.4.m4.1.1.2.3.5">ğ‘š</ci></apply></apply><apply id="S2.SS3.SSS5.p2.4.m4.1.1.3.cmml" xref="S2.SS3.SSS5.p2.4.m4.1.1.3"><times id="S2.SS3.SSS5.p2.4.m4.1.1.3.1.cmml" xref="S2.SS3.SSS5.p2.4.m4.1.1.3.1"></times><ci id="S2.SS3.SSS5.p2.4.m4.1.1.3.2.cmml" xref="S2.SS3.SSS5.p2.4.m4.1.1.3.2">ğ‘</ci><ci id="S2.SS3.SSS5.p2.4.m4.1.1.3.3.cmml" xref="S2.SS3.SSS5.p2.4.m4.1.1.3.3">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p2.4.m4.1c">\mathcal{L}^{Item}_{cb}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p2.4.m4.1d">caligraphic_L start_POSTSUPERSCRIPT italic_I italic_t italic_e italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c italic_b end_POSTSUBSCRIPT</annotation></semantics></math> for items is further designed to bring the selected tokenâ€™s embedding <math alttext="\mathbf{c}^{k}_{w^{k}}" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p2.5.m5.1"><semantics id="S2.SS3.SSS5.p2.5.m5.1a"><msubsup id="S2.SS3.SSS5.p2.5.m5.1.1" xref="S2.SS3.SSS5.p2.5.m5.1.1.cmml"><mi id="S2.SS3.SSS5.p2.5.m5.1.1.2.2" xref="S2.SS3.SSS5.p2.5.m5.1.1.2.2.cmml">ğœ</mi><msup id="S2.SS3.SSS5.p2.5.m5.1.1.3" xref="S2.SS3.SSS5.p2.5.m5.1.1.3.cmml"><mi id="S2.SS3.SSS5.p2.5.m5.1.1.3.2" xref="S2.SS3.SSS5.p2.5.m5.1.1.3.2.cmml">w</mi><mi id="S2.SS3.SSS5.p2.5.m5.1.1.3.3" xref="S2.SS3.SSS5.p2.5.m5.1.1.3.3.cmml">k</mi></msup><mi id="S2.SS3.SSS5.p2.5.m5.1.1.2.3" xref="S2.SS3.SSS5.p2.5.m5.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p2.5.m5.1b"><apply id="S2.SS3.SSS5.p2.5.m5.1.1.cmml" xref="S2.SS3.SSS5.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS5.p2.5.m5.1.1.1.cmml" xref="S2.SS3.SSS5.p2.5.m5.1.1">subscript</csymbol><apply id="S2.SS3.SSS5.p2.5.m5.1.1.2.cmml" xref="S2.SS3.SSS5.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS5.p2.5.m5.1.1.2.1.cmml" xref="S2.SS3.SSS5.p2.5.m5.1.1">superscript</csymbol><ci id="S2.SS3.SSS5.p2.5.m5.1.1.2.2.cmml" xref="S2.SS3.SSS5.p2.5.m5.1.1.2.2">ğœ</ci><ci id="S2.SS3.SSS5.p2.5.m5.1.1.2.3.cmml" xref="S2.SS3.SSS5.p2.5.m5.1.1.2.3">ğ‘˜</ci></apply><apply id="S2.SS3.SSS5.p2.5.m5.1.1.3.cmml" xref="S2.SS3.SSS5.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS5.p2.5.m5.1.1.3.1.cmml" xref="S2.SS3.SSS5.p2.5.m5.1.1.3">superscript</csymbol><ci id="S2.SS3.SSS5.p2.5.m5.1.1.3.2.cmml" xref="S2.SS3.SSS5.p2.5.m5.1.1.3.2">ğ‘¤</ci><ci id="S2.SS3.SSS5.p2.5.m5.1.1.3.3.cmml" xref="S2.SS3.SSS5.p2.5.m5.1.1.3.3">ğ‘˜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p2.5.m5.1c">\mathbf{c}^{k}_{w^{k}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p2.5.m5.1d">bold_c start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> close to the outputs of the <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p2.6.m6.1"><semantics id="S2.SS3.SSS5.p2.6.m6.1a"><mi id="S2.SS3.SSS5.p2.6.m6.1.1" xref="S2.SS3.SSS5.p2.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p2.6.m6.1b"><ci id="S2.SS3.SSS5.p2.6.m6.1.1.cmml" xref="S2.SS3.SSS5.p2.6.m6.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p2.6.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p2.6.m6.1d">italic_K</annotation></semantics></math>-way encoder <math alttext="\text{Enc}^{k}(\cdot)" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p2.7.m7.1"><semantics id="S2.SS3.SSS5.p2.7.m7.1a"><mrow id="S2.SS3.SSS5.p2.7.m7.1.2" xref="S2.SS3.SSS5.p2.7.m7.1.2.cmml"><msup id="S2.SS3.SSS5.p2.7.m7.1.2.2" xref="S2.SS3.SSS5.p2.7.m7.1.2.2.cmml"><mtext id="S2.SS3.SSS5.p2.7.m7.1.2.2.2" xref="S2.SS3.SSS5.p2.7.m7.1.2.2.2a.cmml">Enc</mtext><mi id="S2.SS3.SSS5.p2.7.m7.1.2.2.3" xref="S2.SS3.SSS5.p2.7.m7.1.2.2.3.cmml">k</mi></msup><mo id="S2.SS3.SSS5.p2.7.m7.1.2.1" xref="S2.SS3.SSS5.p2.7.m7.1.2.1.cmml">â¢</mo><mrow id="S2.SS3.SSS5.p2.7.m7.1.2.3.2" xref="S2.SS3.SSS5.p2.7.m7.1.2.cmml"><mo id="S2.SS3.SSS5.p2.7.m7.1.2.3.2.1" stretchy="false" xref="S2.SS3.SSS5.p2.7.m7.1.2.cmml">(</mo><mo id="S2.SS3.SSS5.p2.7.m7.1.1" lspace="0em" rspace="0em" xref="S2.SS3.SSS5.p2.7.m7.1.1.cmml">â‹…</mo><mo id="S2.SS3.SSS5.p2.7.m7.1.2.3.2.2" stretchy="false" xref="S2.SS3.SSS5.p2.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p2.7.m7.1b"><apply id="S2.SS3.SSS5.p2.7.m7.1.2.cmml" xref="S2.SS3.SSS5.p2.7.m7.1.2"><times id="S2.SS3.SSS5.p2.7.m7.1.2.1.cmml" xref="S2.SS3.SSS5.p2.7.m7.1.2.1"></times><apply id="S2.SS3.SSS5.p2.7.m7.1.2.2.cmml" xref="S2.SS3.SSS5.p2.7.m7.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS5.p2.7.m7.1.2.2.1.cmml" xref="S2.SS3.SSS5.p2.7.m7.1.2.2">superscript</csymbol><ci id="S2.SS3.SSS5.p2.7.m7.1.2.2.2a.cmml" xref="S2.SS3.SSS5.p2.7.m7.1.2.2.2"><mtext id="S2.SS3.SSS5.p2.7.m7.1.2.2.2.cmml" xref="S2.SS3.SSS5.p2.7.m7.1.2.2.2">Enc</mtext></ci><ci id="S2.SS3.SSS5.p2.7.m7.1.2.2.3.cmml" xref="S2.SS3.SSS5.p2.7.m7.1.2.2.3">ğ‘˜</ci></apply><ci id="S2.SS3.SSS5.p2.7.m7.1.1.cmml" xref="S2.SS3.SSS5.p2.7.m7.1.1">â‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p2.7.m7.1c">\text{Enc}^{k}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p2.7.m7.1d">Enc start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( â‹… )</annotation></semantics></math> using the <math alttext="l_{2}" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p2.8.m8.1"><semantics id="S2.SS3.SSS5.p2.8.m8.1a"><msub id="S2.SS3.SSS5.p2.8.m8.1.1" xref="S2.SS3.SSS5.p2.8.m8.1.1.cmml"><mi id="S2.SS3.SSS5.p2.8.m8.1.1.2" xref="S2.SS3.SSS5.p2.8.m8.1.1.2.cmml">l</mi><mn id="S2.SS3.SSS5.p2.8.m8.1.1.3" xref="S2.SS3.SSS5.p2.8.m8.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p2.8.m8.1b"><apply id="S2.SS3.SSS5.p2.8.m8.1.1.cmml" xref="S2.SS3.SSS5.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS5.p2.8.m8.1.1.1.cmml" xref="S2.SS3.SSS5.p2.8.m8.1.1">subscript</csymbol><ci id="S2.SS3.SSS5.p2.8.m8.1.1.2.cmml" xref="S2.SS3.SSS5.p2.8.m8.1.1.2">ğ‘™</ci><cn id="S2.SS3.SSS5.p2.8.m8.1.1.3.cmml" type="integer" xref="S2.SS3.SSS5.p2.8.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p2.8.m8.1c">l_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p2.8.m8.1d">italic_l start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> error for updating <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p2.9.m9.1"><semantics id="S2.SS3.SSS5.p2.9.m9.1a"><mi id="S2.SS3.SSS5.p2.9.m9.1.1" xref="S2.SS3.SSS5.p2.9.m9.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p2.9.m9.1b"><ci id="S2.SS3.SSS5.p2.9.m9.1.1.cmml" xref="S2.SS3.SSS5.p2.9.m9.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p2.9.m9.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p2.9.m9.1d">italic_K</annotation></semantics></math>-way codebook <math alttext="\mathbf{C}" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p2.10.m10.1"><semantics id="S2.SS3.SSS5.p2.10.m10.1a"><mi id="S2.SS3.SSS5.p2.10.m10.1.1" xref="S2.SS3.SSS5.p2.10.m10.1.1.cmml">ğ‚</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p2.10.m10.1b"><ci id="S2.SS3.SSS5.p2.10.m10.1.1.cmml" xref="S2.SS3.SSS5.p2.10.m10.1.1">ğ‚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p2.10.m10.1c">\mathbf{C}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p2.10.m10.1d">bold_C</annotation></semantics></math> as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx9">
<tbody id="S2.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}^{Item}_{cb}" class="ltx_Math" display="inline" id="S2.E11.m1.1"><semantics id="S2.E11.m1.1a"><msubsup id="S2.E11.m1.1.1" xref="S2.E11.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E11.m1.1.1.2.2" xref="S2.E11.m1.1.1.2.2.cmml">â„’</mi><mrow id="S2.E11.m1.1.1.3" xref="S2.E11.m1.1.1.3.cmml"><mi id="S2.E11.m1.1.1.3.2" xref="S2.E11.m1.1.1.3.2.cmml">c</mi><mo id="S2.E11.m1.1.1.3.1" xref="S2.E11.m1.1.1.3.1.cmml">â¢</mo><mi id="S2.E11.m1.1.1.3.3" xref="S2.E11.m1.1.1.3.3.cmml">b</mi></mrow><mrow id="S2.E11.m1.1.1.2.3" xref="S2.E11.m1.1.1.2.3.cmml"><mi id="S2.E11.m1.1.1.2.3.2" xref="S2.E11.m1.1.1.2.3.2.cmml">I</mi><mo id="S2.E11.m1.1.1.2.3.1" xref="S2.E11.m1.1.1.2.3.1.cmml">â¢</mo><mi id="S2.E11.m1.1.1.2.3.3" xref="S2.E11.m1.1.1.2.3.3.cmml">t</mi><mo id="S2.E11.m1.1.1.2.3.1a" xref="S2.E11.m1.1.1.2.3.1.cmml">â¢</mo><mi id="S2.E11.m1.1.1.2.3.4" xref="S2.E11.m1.1.1.2.3.4.cmml">e</mi><mo id="S2.E11.m1.1.1.2.3.1b" xref="S2.E11.m1.1.1.2.3.1.cmml">â¢</mo><mi id="S2.E11.m1.1.1.2.3.5" xref="S2.E11.m1.1.1.2.3.5.cmml">m</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.E11.m1.1b"><apply id="S2.E11.m1.1.1.cmml" xref="S2.E11.m1.1.1"><csymbol cd="ambiguous" id="S2.E11.m1.1.1.1.cmml" xref="S2.E11.m1.1.1">subscript</csymbol><apply id="S2.E11.m1.1.1.2.cmml" xref="S2.E11.m1.1.1"><csymbol cd="ambiguous" id="S2.E11.m1.1.1.2.1.cmml" xref="S2.E11.m1.1.1">superscript</csymbol><ci id="S2.E11.m1.1.1.2.2.cmml" xref="S2.E11.m1.1.1.2.2">â„’</ci><apply id="S2.E11.m1.1.1.2.3.cmml" xref="S2.E11.m1.1.1.2.3"><times id="S2.E11.m1.1.1.2.3.1.cmml" xref="S2.E11.m1.1.1.2.3.1"></times><ci id="S2.E11.m1.1.1.2.3.2.cmml" xref="S2.E11.m1.1.1.2.3.2">ğ¼</ci><ci id="S2.E11.m1.1.1.2.3.3.cmml" xref="S2.E11.m1.1.1.2.3.3">ğ‘¡</ci><ci id="S2.E11.m1.1.1.2.3.4.cmml" xref="S2.E11.m1.1.1.2.3.4">ğ‘’</ci><ci id="S2.E11.m1.1.1.2.3.5.cmml" xref="S2.E11.m1.1.1.2.3.5">ğ‘š</ci></apply></apply><apply id="S2.E11.m1.1.1.3.cmml" xref="S2.E11.m1.1.1.3"><times id="S2.E11.m1.1.1.3.1.cmml" xref="S2.E11.m1.1.1.3.1"></times><ci id="S2.E11.m1.1.1.3.2.cmml" xref="S2.E11.m1.1.1.3.2">ğ‘</ci><ci id="S2.E11.m1.1.1.3.3.cmml" xref="S2.E11.m1.1.1.3.3">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E11.m1.1c">\displaystyle\mathcal{L}^{Item}_{cb}</annotation><annotation encoding="application/x-llamapun" id="S2.E11.m1.1d">caligraphic_L start_POSTSUPERSCRIPT italic_I italic_t italic_e italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c italic_b end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{k=1}^{K}\|\text{sg}[~{}\text{Enc}^{k}(\mathbf{q}^{\prime}_%
{j})~{}]-\mathbf{c}^{k}_{w^{k}_{j}}\|^{2}," class="ltx_Math" display="inline" id="S2.E11.m2.1"><semantics id="S2.E11.m2.1a"><mrow id="S2.E11.m2.1.1.1" xref="S2.E11.m2.1.1.1.1.cmml"><mrow id="S2.E11.m2.1.1.1.1" xref="S2.E11.m2.1.1.1.1.cmml"><mi id="S2.E11.m2.1.1.1.1.3" xref="S2.E11.m2.1.1.1.1.3.cmml"></mi><mo id="S2.E11.m2.1.1.1.1.2" xref="S2.E11.m2.1.1.1.1.2.cmml">=</mo><mrow id="S2.E11.m2.1.1.1.1.1" xref="S2.E11.m2.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E11.m2.1.1.1.1.1.2" xref="S2.E11.m2.1.1.1.1.1.2.cmml"><munderover id="S2.E11.m2.1.1.1.1.1.2a" xref="S2.E11.m2.1.1.1.1.1.2.cmml"><mo id="S2.E11.m2.1.1.1.1.1.2.2.2" movablelimits="false" xref="S2.E11.m2.1.1.1.1.1.2.2.2.cmml">âˆ‘</mo><mrow id="S2.E11.m2.1.1.1.1.1.2.2.3" xref="S2.E11.m2.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E11.m2.1.1.1.1.1.2.2.3.2" xref="S2.E11.m2.1.1.1.1.1.2.2.3.2.cmml">k</mi><mo id="S2.E11.m2.1.1.1.1.1.2.2.3.1" xref="S2.E11.m2.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E11.m2.1.1.1.1.1.2.2.3.3" xref="S2.E11.m2.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E11.m2.1.1.1.1.1.2.3" xref="S2.E11.m2.1.1.1.1.1.2.3.cmml">K</mi></munderover></mstyle><msup id="S2.E11.m2.1.1.1.1.1.1" xref="S2.E11.m2.1.1.1.1.1.1.cmml"><mrow id="S2.E11.m2.1.1.1.1.1.1.1.1" xref="S2.E11.m2.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E11.m2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E11.m2.1.1.1.1.1.1.1.2.1.cmml">â€–</mo><mrow id="S2.E11.m2.1.1.1.1.1.1.1.1.1" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.3a.cmml">sg</mtext><mo id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.2.cmml">â¢</mo><mrow id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.2" rspace="0.330em" stretchy="false" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msup id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mtext id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2a.cmml">Enc</mtext><mi id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msup><mo id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">â¢</mo><mrow id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">ğª</mi><mi id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi><mo id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">â€²</mo></msubsup><mo id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" rspace="0.330em" stretchy="false" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.E11.m2.1.1.1.1.1.1.1.1.1.2" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.2.cmml">âˆ’</mo><msubsup id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.2.2.cmml">ğœ</mi><msubsup id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml">w</mi><mi id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3.3.cmml">j</mi><mi id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3.2.3" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml">k</mi></msubsup><mi id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.2.3.cmml">k</mi></msubsup></mrow><mo id="S2.E11.m2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E11.m2.1.1.1.1.1.1.1.2.1.cmml">â€–</mo></mrow><mn id="S2.E11.m2.1.1.1.1.1.1.3" xref="S2.E11.m2.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S2.E11.m2.1.1.1.2" xref="S2.E11.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E11.m2.1b"><apply id="S2.E11.m2.1.1.1.1.cmml" xref="S2.E11.m2.1.1.1"><eq id="S2.E11.m2.1.1.1.1.2.cmml" xref="S2.E11.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S2.E11.m2.1.1.1.1.3.cmml" xref="S2.E11.m2.1.1.1.1.3">absent</csymbol><apply id="S2.E11.m2.1.1.1.1.1.cmml" xref="S2.E11.m2.1.1.1.1.1"><apply id="S2.E11.m2.1.1.1.1.1.2.cmml" xref="S2.E11.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E11.m2.1.1.1.1.1.2.1.cmml" xref="S2.E11.m2.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E11.m2.1.1.1.1.1.2.2.cmml" xref="S2.E11.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E11.m2.1.1.1.1.1.2.2.1.cmml" xref="S2.E11.m2.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E11.m2.1.1.1.1.1.2.2.2.cmml" xref="S2.E11.m2.1.1.1.1.1.2.2.2"></sum><apply id="S2.E11.m2.1.1.1.1.1.2.2.3.cmml" xref="S2.E11.m2.1.1.1.1.1.2.2.3"><eq id="S2.E11.m2.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E11.m2.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E11.m2.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E11.m2.1.1.1.1.1.2.2.3.2">ğ‘˜</ci><cn id="S2.E11.m2.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E11.m2.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E11.m2.1.1.1.1.1.2.3.cmml" xref="S2.E11.m2.1.1.1.1.1.2.3">ğ¾</ci></apply><apply id="S2.E11.m2.1.1.1.1.1.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E11.m2.1.1.1.1.1.1.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E11.m2.1.1.1.1.1.1.1.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E11.m2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E11.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1"><minus id="S2.E11.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.2"></minus><apply id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1"><times id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.3"><mtext id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.3">sg</mtext></ci><apply id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2a.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2"><mtext id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">Enc</mtext></ci><ci id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">ğ‘˜</ci></apply><apply id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">ğª</ci><ci id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">â€²</ci></apply><ci id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">ğ‘—</ci></apply></apply></apply></apply><apply id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.2.2">ğœ</ci><ci id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.2.3">ğ‘˜</ci></apply><apply id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><apply id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3.2.2">ğ‘¤</ci><ci id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3.2.3">ğ‘˜</ci></apply><ci id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.3.3">ğ‘—</ci></apply></apply></apply></apply><cn id="S2.E11.m2.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E11.m2.1.1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E11.m2.1c">\displaystyle=\sum_{k=1}^{K}\|\text{sg}[~{}\text{Enc}^{k}(\mathbf{q}^{\prime}_%
{j})~{}]-\mathbf{c}^{k}_{w^{k}_{j}}\|^{2},</annotation><annotation encoding="application/x-llamapun" id="S2.E11.m2.1d">= âˆ‘ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT âˆ¥ sg [ Enc start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( bold_q start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ] - bold_c start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT âˆ¥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS5.p2.12">where <math alttext="\text{sg}[\cdot]" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p2.11.m1.1"><semantics id="S2.SS3.SSS5.p2.11.m1.1a"><mrow id="S2.SS3.SSS5.p2.11.m1.1.2" xref="S2.SS3.SSS5.p2.11.m1.1.2.cmml"><mtext id="S2.SS3.SSS5.p2.11.m1.1.2.2" xref="S2.SS3.SSS5.p2.11.m1.1.2.2a.cmml">sg</mtext><mo id="S2.SS3.SSS5.p2.11.m1.1.2.1" xref="S2.SS3.SSS5.p2.11.m1.1.2.1.cmml">â¢</mo><mrow id="S2.SS3.SSS5.p2.11.m1.1.2.3.2" xref="S2.SS3.SSS5.p2.11.m1.1.2.3.1.cmml"><mo id="S2.SS3.SSS5.p2.11.m1.1.2.3.2.1" stretchy="false" xref="S2.SS3.SSS5.p2.11.m1.1.2.3.1.1.cmml">[</mo><mo id="S2.SS3.SSS5.p2.11.m1.1.1" lspace="0em" rspace="0em" xref="S2.SS3.SSS5.p2.11.m1.1.1.cmml">â‹…</mo><mo id="S2.SS3.SSS5.p2.11.m1.1.2.3.2.2" stretchy="false" xref="S2.SS3.SSS5.p2.11.m1.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p2.11.m1.1b"><apply id="S2.SS3.SSS5.p2.11.m1.1.2.cmml" xref="S2.SS3.SSS5.p2.11.m1.1.2"><times id="S2.SS3.SSS5.p2.11.m1.1.2.1.cmml" xref="S2.SS3.SSS5.p2.11.m1.1.2.1"></times><ci id="S2.SS3.SSS5.p2.11.m1.1.2.2a.cmml" xref="S2.SS3.SSS5.p2.11.m1.1.2.2"><mtext id="S2.SS3.SSS5.p2.11.m1.1.2.2.cmml" xref="S2.SS3.SSS5.p2.11.m1.1.2.2">sg</mtext></ci><apply id="S2.SS3.SSS5.p2.11.m1.1.2.3.1.cmml" xref="S2.SS3.SSS5.p2.11.m1.1.2.3.2"><csymbol cd="latexml" id="S2.SS3.SSS5.p2.11.m1.1.2.3.1.1.cmml" xref="S2.SS3.SSS5.p2.11.m1.1.2.3.2.1">delimited-[]</csymbol><ci id="S2.SS3.SSS5.p2.11.m1.1.1.cmml" xref="S2.SS3.SSS5.p2.11.m1.1.1">â‹…</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p2.11.m1.1c">\text{sg}[\cdot]</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p2.11.m1.1d">sg [ â‹… ]</annotation></semantics></math> denotes the a stop-gradient operator.
To be specific, the gradient of the variable in <math alttext="\text{sg}[\cdot]" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p2.12.m2.1"><semantics id="S2.SS3.SSS5.p2.12.m2.1a"><mrow id="S2.SS3.SSS5.p2.12.m2.1.2" xref="S2.SS3.SSS5.p2.12.m2.1.2.cmml"><mtext id="S2.SS3.SSS5.p2.12.m2.1.2.2" xref="S2.SS3.SSS5.p2.12.m2.1.2.2a.cmml">sg</mtext><mo id="S2.SS3.SSS5.p2.12.m2.1.2.1" xref="S2.SS3.SSS5.p2.12.m2.1.2.1.cmml">â¢</mo><mrow id="S2.SS3.SSS5.p2.12.m2.1.2.3.2" xref="S2.SS3.SSS5.p2.12.m2.1.2.3.1.cmml"><mo id="S2.SS3.SSS5.p2.12.m2.1.2.3.2.1" stretchy="false" xref="S2.SS3.SSS5.p2.12.m2.1.2.3.1.1.cmml">[</mo><mo id="S2.SS3.SSS5.p2.12.m2.1.1" lspace="0em" rspace="0em" xref="S2.SS3.SSS5.p2.12.m2.1.1.cmml">â‹…</mo><mo id="S2.SS3.SSS5.p2.12.m2.1.2.3.2.2" stretchy="false" xref="S2.SS3.SSS5.p2.12.m2.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p2.12.m2.1b"><apply id="S2.SS3.SSS5.p2.12.m2.1.2.cmml" xref="S2.SS3.SSS5.p2.12.m2.1.2"><times id="S2.SS3.SSS5.p2.12.m2.1.2.1.cmml" xref="S2.SS3.SSS5.p2.12.m2.1.2.1"></times><ci id="S2.SS3.SSS5.p2.12.m2.1.2.2a.cmml" xref="S2.SS3.SSS5.p2.12.m2.1.2.2"><mtext id="S2.SS3.SSS5.p2.12.m2.1.2.2.cmml" xref="S2.SS3.SSS5.p2.12.m2.1.2.2">sg</mtext></ci><apply id="S2.SS3.SSS5.p2.12.m2.1.2.3.1.cmml" xref="S2.SS3.SSS5.p2.12.m2.1.2.3.2"><csymbol cd="latexml" id="S2.SS3.SSS5.p2.12.m2.1.2.3.1.1.cmml" xref="S2.SS3.SSS5.p2.12.m2.1.2.3.2.1">delimited-[]</csymbol><ci id="S2.SS3.SSS5.p2.12.m2.1.1.cmml" xref="S2.SS3.SSS5.p2.12.m2.1.1">â‹…</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p2.12.m2.1c">\text{sg}[\cdot]</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p2.12.m2.1d">sg [ â‹… ]</annotation></semantics></math> takes the value 0 when performing back-propagated gradient calculation.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS5.p3">
<p class="ltx_p" id="S2.SS3.SSS5.p3.1">Furthermore, to encourage a smooth gradient passing for the <em class="ltx_emph ltx_font_italic" id="S2.SS3.SSS5.p3.1.1">argÂ min</em> operation from Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.E5" title="In II-C3 ğ¾-way Encoder and Codebook â€£ II-C Masked Vector-Quantized Tokenizers for Users and Items â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">5</span></a>), a <em class="ltx_emph ltx_font_italic" id="S2.SS3.SSS5.p3.1.2">commitment loss</em> <math alttext="\mathcal{L}^{Item}_{cm}" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p3.1.m1.1"><semantics id="S2.SS3.SSS5.p3.1.m1.1a"><msubsup id="S2.SS3.SSS5.p3.1.m1.1.1" xref="S2.SS3.SSS5.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS5.p3.1.m1.1.1.2.2" xref="S2.SS3.SSS5.p3.1.m1.1.1.2.2.cmml">â„’</mi><mrow id="S2.SS3.SSS5.p3.1.m1.1.1.3" xref="S2.SS3.SSS5.p3.1.m1.1.1.3.cmml"><mi id="S2.SS3.SSS5.p3.1.m1.1.1.3.2" xref="S2.SS3.SSS5.p3.1.m1.1.1.3.2.cmml">c</mi><mo id="S2.SS3.SSS5.p3.1.m1.1.1.3.1" xref="S2.SS3.SSS5.p3.1.m1.1.1.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p3.1.m1.1.1.3.3" xref="S2.SS3.SSS5.p3.1.m1.1.1.3.3.cmml">m</mi></mrow><mrow id="S2.SS3.SSS5.p3.1.m1.1.1.2.3" xref="S2.SS3.SSS5.p3.1.m1.1.1.2.3.cmml"><mi id="S2.SS3.SSS5.p3.1.m1.1.1.2.3.2" xref="S2.SS3.SSS5.p3.1.m1.1.1.2.3.2.cmml">I</mi><mo id="S2.SS3.SSS5.p3.1.m1.1.1.2.3.1" xref="S2.SS3.SSS5.p3.1.m1.1.1.2.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p3.1.m1.1.1.2.3.3" xref="S2.SS3.SSS5.p3.1.m1.1.1.2.3.3.cmml">t</mi><mo id="S2.SS3.SSS5.p3.1.m1.1.1.2.3.1a" xref="S2.SS3.SSS5.p3.1.m1.1.1.2.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p3.1.m1.1.1.2.3.4" xref="S2.SS3.SSS5.p3.1.m1.1.1.2.3.4.cmml">e</mi><mo id="S2.SS3.SSS5.p3.1.m1.1.1.2.3.1b" xref="S2.SS3.SSS5.p3.1.m1.1.1.2.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p3.1.m1.1.1.2.3.5" xref="S2.SS3.SSS5.p3.1.m1.1.1.2.3.5.cmml">m</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p3.1.m1.1b"><apply id="S2.SS3.SSS5.p3.1.m1.1.1.cmml" xref="S2.SS3.SSS5.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS5.p3.1.m1.1.1.1.cmml" xref="S2.SS3.SSS5.p3.1.m1.1.1">subscript</csymbol><apply id="S2.SS3.SSS5.p3.1.m1.1.1.2.cmml" xref="S2.SS3.SSS5.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS5.p3.1.m1.1.1.2.1.cmml" xref="S2.SS3.SSS5.p3.1.m1.1.1">superscript</csymbol><ci id="S2.SS3.SSS5.p3.1.m1.1.1.2.2.cmml" xref="S2.SS3.SSS5.p3.1.m1.1.1.2.2">â„’</ci><apply id="S2.SS3.SSS5.p3.1.m1.1.1.2.3.cmml" xref="S2.SS3.SSS5.p3.1.m1.1.1.2.3"><times id="S2.SS3.SSS5.p3.1.m1.1.1.2.3.1.cmml" xref="S2.SS3.SSS5.p3.1.m1.1.1.2.3.1"></times><ci id="S2.SS3.SSS5.p3.1.m1.1.1.2.3.2.cmml" xref="S2.SS3.SSS5.p3.1.m1.1.1.2.3.2">ğ¼</ci><ci id="S2.SS3.SSS5.p3.1.m1.1.1.2.3.3.cmml" xref="S2.SS3.SSS5.p3.1.m1.1.1.2.3.3">ğ‘¡</ci><ci id="S2.SS3.SSS5.p3.1.m1.1.1.2.3.4.cmml" xref="S2.SS3.SSS5.p3.1.m1.1.1.2.3.4">ğ‘’</ci><ci id="S2.SS3.SSS5.p3.1.m1.1.1.2.3.5.cmml" xref="S2.SS3.SSS5.p3.1.m1.1.1.2.3.5">ğ‘š</ci></apply></apply><apply id="S2.SS3.SSS5.p3.1.m1.1.1.3.cmml" xref="S2.SS3.SSS5.p3.1.m1.1.1.3"><times id="S2.SS3.SSS5.p3.1.m1.1.1.3.1.cmml" xref="S2.SS3.SSS5.p3.1.m1.1.1.3.1"></times><ci id="S2.SS3.SSS5.p3.1.m1.1.1.3.2.cmml" xref="S2.SS3.SSS5.p3.1.m1.1.1.3.2">ğ‘</ci><ci id="S2.SS3.SSS5.p3.1.m1.1.1.3.3.cmml" xref="S2.SS3.SSS5.p3.1.m1.1.1.3.3">ğ‘š</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p3.1.m1.1c">\mathcal{L}^{Item}_{cm}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p3.1.m1.1d">caligraphic_L start_POSTSUPERSCRIPT italic_I italic_t italic_e italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c italic_m end_POSTSUBSCRIPT</annotation></semantics></math> is introduced to prevent the encoded features from fluctuating too frequently from one codeword to another. Unlike the codebook loss, the commitment loss only applies to the encoder weights, which can be calculated by:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx10">
<tbody id="S2.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}^{Item}_{cm}=\sum_{k=1}^{K}\|~{}\text{Enc}^{k}(\mathbf%
{q}^{\prime}_{j})~{}-\text{sg}[\mathbf{c}^{k}_{w^{k}_{j}}]\|^{2}." class="ltx_Math" display="inline" id="S2.E12.m1.1"><semantics id="S2.E12.m1.1a"><mrow id="S2.E12.m1.1.1.1" xref="S2.E12.m1.1.1.1.1.cmml"><mrow id="S2.E12.m1.1.1.1.1" xref="S2.E12.m1.1.1.1.1.cmml"><msubsup id="S2.E12.m1.1.1.1.1.3" xref="S2.E12.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E12.m1.1.1.1.1.3.2.2" xref="S2.E12.m1.1.1.1.1.3.2.2.cmml">â„’</mi><mrow id="S2.E12.m1.1.1.1.1.3.3" xref="S2.E12.m1.1.1.1.1.3.3.cmml"><mi id="S2.E12.m1.1.1.1.1.3.3.2" xref="S2.E12.m1.1.1.1.1.3.3.2.cmml">c</mi><mo id="S2.E12.m1.1.1.1.1.3.3.1" xref="S2.E12.m1.1.1.1.1.3.3.1.cmml">â¢</mo><mi id="S2.E12.m1.1.1.1.1.3.3.3" xref="S2.E12.m1.1.1.1.1.3.3.3.cmml">m</mi></mrow><mrow id="S2.E12.m1.1.1.1.1.3.2.3" xref="S2.E12.m1.1.1.1.1.3.2.3.cmml"><mi id="S2.E12.m1.1.1.1.1.3.2.3.2" xref="S2.E12.m1.1.1.1.1.3.2.3.2.cmml">I</mi><mo id="S2.E12.m1.1.1.1.1.3.2.3.1" xref="S2.E12.m1.1.1.1.1.3.2.3.1.cmml">â¢</mo><mi id="S2.E12.m1.1.1.1.1.3.2.3.3" xref="S2.E12.m1.1.1.1.1.3.2.3.3.cmml">t</mi><mo id="S2.E12.m1.1.1.1.1.3.2.3.1a" xref="S2.E12.m1.1.1.1.1.3.2.3.1.cmml">â¢</mo><mi id="S2.E12.m1.1.1.1.1.3.2.3.4" xref="S2.E12.m1.1.1.1.1.3.2.3.4.cmml">e</mi><mo id="S2.E12.m1.1.1.1.1.3.2.3.1b" xref="S2.E12.m1.1.1.1.1.3.2.3.1.cmml">â¢</mo><mi id="S2.E12.m1.1.1.1.1.3.2.3.5" xref="S2.E12.m1.1.1.1.1.3.2.3.5.cmml">m</mi></mrow></msubsup><mo id="S2.E12.m1.1.1.1.1.2" xref="S2.E12.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E12.m1.1.1.1.1.1" xref="S2.E12.m1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E12.m1.1.1.1.1.1.2" xref="S2.E12.m1.1.1.1.1.1.2.cmml"><munderover id="S2.E12.m1.1.1.1.1.1.2a" xref="S2.E12.m1.1.1.1.1.1.2.cmml"><mo id="S2.E12.m1.1.1.1.1.1.2.2.2" movablelimits="false" xref="S2.E12.m1.1.1.1.1.1.2.2.2.cmml">âˆ‘</mo><mrow id="S2.E12.m1.1.1.1.1.1.2.2.3" xref="S2.E12.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E12.m1.1.1.1.1.1.2.2.3.2" xref="S2.E12.m1.1.1.1.1.1.2.2.3.2.cmml">k</mi><mo id="S2.E12.m1.1.1.1.1.1.2.2.3.1" xref="S2.E12.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E12.m1.1.1.1.1.1.2.2.3.3" xref="S2.E12.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E12.m1.1.1.1.1.1.2.3" xref="S2.E12.m1.1.1.1.1.1.2.3.cmml">K</mi></munderover></mstyle><msup id="S2.E12.m1.1.1.1.1.1.1" xref="S2.E12.m1.1.1.1.1.1.1.cmml"><mrow id="S2.E12.m1.1.1.1.1.1.1.1.1" xref="S2.E12.m1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E12.m1.1.1.1.1.1.1.1.1.2" rspace="0.330em" stretchy="false" xref="S2.E12.m1.1.1.1.1.1.1.1.2.1.cmml">â€–</mo><mrow id="S2.E12.m1.1.1.1.1.1.1.1.1.1" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msup id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mtext id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.3.2a.cmml">Enc</mtext><mi id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msup><mo id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">â¢</mo><mrow id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">ğª</mi><mi id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi><mo id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">â€²</mo></msubsup><mo id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" rspace="0.330em" stretchy="false" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E12.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.3.cmml">âˆ’</mo><mrow id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mtext id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.3a.cmml">sg</mtext><mo id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">â¢</mo><mrow id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.2.cmml"><mo id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.2.1.cmml">[</mo><msubsup id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.cmml">ğœ</mi><msubsup id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.2" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.2.cmml">w</mi><mi id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml">j</mi><mi id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.3" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.3.cmml">k</mi></msubsup><mi id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.3" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E12.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E12.m1.1.1.1.1.1.1.1.2.1.cmml">â€–</mo></mrow><mn id="S2.E12.m1.1.1.1.1.1.1.3" xref="S2.E12.m1.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S2.E12.m1.1.1.1.2" lspace="0em" xref="S2.E12.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E12.m1.1b"><apply id="S2.E12.m1.1.1.1.1.cmml" xref="S2.E12.m1.1.1.1"><eq id="S2.E12.m1.1.1.1.1.2.cmml" xref="S2.E12.m1.1.1.1.1.2"></eq><apply id="S2.E12.m1.1.1.1.1.3.cmml" xref="S2.E12.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.1.1.3.1.cmml" xref="S2.E12.m1.1.1.1.1.3">subscript</csymbol><apply id="S2.E12.m1.1.1.1.1.3.2.cmml" xref="S2.E12.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.1.1.3.2.1.cmml" xref="S2.E12.m1.1.1.1.1.3">superscript</csymbol><ci id="S2.E12.m1.1.1.1.1.3.2.2.cmml" xref="S2.E12.m1.1.1.1.1.3.2.2">â„’</ci><apply id="S2.E12.m1.1.1.1.1.3.2.3.cmml" xref="S2.E12.m1.1.1.1.1.3.2.3"><times id="S2.E12.m1.1.1.1.1.3.2.3.1.cmml" xref="S2.E12.m1.1.1.1.1.3.2.3.1"></times><ci id="S2.E12.m1.1.1.1.1.3.2.3.2.cmml" xref="S2.E12.m1.1.1.1.1.3.2.3.2">ğ¼</ci><ci id="S2.E12.m1.1.1.1.1.3.2.3.3.cmml" xref="S2.E12.m1.1.1.1.1.3.2.3.3">ğ‘¡</ci><ci id="S2.E12.m1.1.1.1.1.3.2.3.4.cmml" xref="S2.E12.m1.1.1.1.1.3.2.3.4">ğ‘’</ci><ci id="S2.E12.m1.1.1.1.1.3.2.3.5.cmml" xref="S2.E12.m1.1.1.1.1.3.2.3.5">ğ‘š</ci></apply></apply><apply id="S2.E12.m1.1.1.1.1.3.3.cmml" xref="S2.E12.m1.1.1.1.1.3.3"><times id="S2.E12.m1.1.1.1.1.3.3.1.cmml" xref="S2.E12.m1.1.1.1.1.3.3.1"></times><ci id="S2.E12.m1.1.1.1.1.3.3.2.cmml" xref="S2.E12.m1.1.1.1.1.3.3.2">ğ‘</ci><ci id="S2.E12.m1.1.1.1.1.3.3.3.cmml" xref="S2.E12.m1.1.1.1.1.3.3.3">ğ‘š</ci></apply></apply><apply id="S2.E12.m1.1.1.1.1.1.cmml" xref="S2.E12.m1.1.1.1.1.1"><apply id="S2.E12.m1.1.1.1.1.1.2.cmml" xref="S2.E12.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.1.1.1.2.1.cmml" xref="S2.E12.m1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E12.m1.1.1.1.1.1.2.2.cmml" xref="S2.E12.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.1.1.1.2.2.1.cmml" xref="S2.E12.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E12.m1.1.1.1.1.1.2.2.2.cmml" xref="S2.E12.m1.1.1.1.1.1.2.2.2"></sum><apply id="S2.E12.m1.1.1.1.1.1.2.2.3.cmml" xref="S2.E12.m1.1.1.1.1.1.2.2.3"><eq id="S2.E12.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E12.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E12.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E12.m1.1.1.1.1.1.2.2.3.2">ğ‘˜</ci><cn id="S2.E12.m1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E12.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E12.m1.1.1.1.1.1.2.3.cmml" xref="S2.E12.m1.1.1.1.1.1.2.3">ğ¾</ci></apply><apply id="S2.E12.m1.1.1.1.1.1.1.cmml" xref="S2.E12.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.1.1.1.1.2.cmml" xref="S2.E12.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E12.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E12.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E12.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1"><minus id="S2.E12.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.3"></minus><apply id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.3.2a.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.3.2"><mtext id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.3.2">Enc</mtext></ci><ci id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.3.3">ğ‘˜</ci></apply><apply id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">ğª</ci><ci id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">â€²</ci></apply><ci id="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">ğ‘—</ci></apply></apply><apply id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2"><times id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.2"></times><ci id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.3"><mtext id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.3">sg</mtext></ci><apply id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.2.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.2.1.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1">subscript</csymbol><apply id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1">superscript</csymbol><ci id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2">ğœ</ci><ci id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.3.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.3">ğ‘˜</ci></apply><apply id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><apply id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.1.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3">superscript</csymbol><ci id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.2.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.2">ğ‘¤</ci><ci id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.3.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.3">ğ‘˜</ci></apply><ci id="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3">ğ‘—</ci></apply></apply></apply></apply></apply></apply><cn id="S2.E12.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E12.m1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E12.m1.1c">\displaystyle\mathcal{L}^{Item}_{cm}=\sum_{k=1}^{K}\|~{}\text{Enc}^{k}(\mathbf%
{q}^{\prime}_{j})~{}-\text{sg}[\mathbf{c}^{k}_{w^{k}_{j}}]\|^{2}.</annotation><annotation encoding="application/x-llamapun" id="S2.E12.m1.1d">caligraphic_L start_POSTSUPERSCRIPT italic_I italic_t italic_e italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c italic_m end_POSTSUBSCRIPT = âˆ‘ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT âˆ¥ Enc start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( bold_q start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) - sg [ bold_c start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] âˆ¥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS3.SSS5.p4">
<p class="ltx_p" id="S2.SS3.SSS5.p4.3">Finally, the overall optimization objective for item MQ-Tokenizer can be formulated by incorporating the aforementioned losses to jointly update the <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p4.1.m1.1"><semantics id="S2.SS3.SSS5.p4.1.m1.1a"><mi id="S2.SS3.SSS5.p4.1.m1.1.1" xref="S2.SS3.SSS5.p4.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p4.1.m1.1b"><ci id="S2.SS3.SSS5.p4.1.m1.1.1.cmml" xref="S2.SS3.SSS5.p4.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p4.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p4.1.m1.1d">italic_K</annotation></semantics></math>-way encoder, the <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p4.2.m2.1"><semantics id="S2.SS3.SSS5.p4.2.m2.1a"><mi id="S2.SS3.SSS5.p4.2.m2.1.1" xref="S2.SS3.SSS5.p4.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p4.2.m2.1b"><ci id="S2.SS3.SSS5.p4.2.m2.1.1.cmml" xref="S2.SS3.SSS5.p4.2.m2.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p4.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p4.2.m2.1d">italic_K</annotation></semantics></math>-way codebook, and the <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p4.3.m3.1"><semantics id="S2.SS3.SSS5.p4.3.m3.1a"><mi id="S2.SS3.SSS5.p4.3.m3.1.1" xref="S2.SS3.SSS5.p4.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p4.3.m3.1b"><ci id="S2.SS3.SSS5.p4.3.m3.1.1.cmml" xref="S2.SS3.SSS5.p4.3.m3.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p4.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p4.3.m3.1d">italic_K</annotation></semantics></math>-to-1 decoder:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx11">
<tbody id="S2.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}^{Item}_{MQ}" class="ltx_Math" display="inline" id="S2.E13.m1.1"><semantics id="S2.E13.m1.1a"><msubsup id="S2.E13.m1.1.1" xref="S2.E13.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E13.m1.1.1.2.2" xref="S2.E13.m1.1.1.2.2.cmml">â„’</mi><mrow id="S2.E13.m1.1.1.3" xref="S2.E13.m1.1.1.3.cmml"><mi id="S2.E13.m1.1.1.3.2" xref="S2.E13.m1.1.1.3.2.cmml">M</mi><mo id="S2.E13.m1.1.1.3.1" xref="S2.E13.m1.1.1.3.1.cmml">â¢</mo><mi id="S2.E13.m1.1.1.3.3" xref="S2.E13.m1.1.1.3.3.cmml">Q</mi></mrow><mrow id="S2.E13.m1.1.1.2.3" xref="S2.E13.m1.1.1.2.3.cmml"><mi id="S2.E13.m1.1.1.2.3.2" xref="S2.E13.m1.1.1.2.3.2.cmml">I</mi><mo id="S2.E13.m1.1.1.2.3.1" xref="S2.E13.m1.1.1.2.3.1.cmml">â¢</mo><mi id="S2.E13.m1.1.1.2.3.3" xref="S2.E13.m1.1.1.2.3.3.cmml">t</mi><mo id="S2.E13.m1.1.1.2.3.1a" xref="S2.E13.m1.1.1.2.3.1.cmml">â¢</mo><mi id="S2.E13.m1.1.1.2.3.4" xref="S2.E13.m1.1.1.2.3.4.cmml">e</mi><mo id="S2.E13.m1.1.1.2.3.1b" xref="S2.E13.m1.1.1.2.3.1.cmml">â¢</mo><mi id="S2.E13.m1.1.1.2.3.5" xref="S2.E13.m1.1.1.2.3.5.cmml">m</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.E13.m1.1b"><apply id="S2.E13.m1.1.1.cmml" xref="S2.E13.m1.1.1"><csymbol cd="ambiguous" id="S2.E13.m1.1.1.1.cmml" xref="S2.E13.m1.1.1">subscript</csymbol><apply id="S2.E13.m1.1.1.2.cmml" xref="S2.E13.m1.1.1"><csymbol cd="ambiguous" id="S2.E13.m1.1.1.2.1.cmml" xref="S2.E13.m1.1.1">superscript</csymbol><ci id="S2.E13.m1.1.1.2.2.cmml" xref="S2.E13.m1.1.1.2.2">â„’</ci><apply id="S2.E13.m1.1.1.2.3.cmml" xref="S2.E13.m1.1.1.2.3"><times id="S2.E13.m1.1.1.2.3.1.cmml" xref="S2.E13.m1.1.1.2.3.1"></times><ci id="S2.E13.m1.1.1.2.3.2.cmml" xref="S2.E13.m1.1.1.2.3.2">ğ¼</ci><ci id="S2.E13.m1.1.1.2.3.3.cmml" xref="S2.E13.m1.1.1.2.3.3">ğ‘¡</ci><ci id="S2.E13.m1.1.1.2.3.4.cmml" xref="S2.E13.m1.1.1.2.3.4">ğ‘’</ci><ci id="S2.E13.m1.1.1.2.3.5.cmml" xref="S2.E13.m1.1.1.2.3.5">ğ‘š</ci></apply></apply><apply id="S2.E13.m1.1.1.3.cmml" xref="S2.E13.m1.1.1.3"><times id="S2.E13.m1.1.1.3.1.cmml" xref="S2.E13.m1.1.1.3.1"></times><ci id="S2.E13.m1.1.1.3.2.cmml" xref="S2.E13.m1.1.1.3.2">ğ‘€</ci><ci id="S2.E13.m1.1.1.3.3.cmml" xref="S2.E13.m1.1.1.3.3">ğ‘„</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E13.m1.1c">\displaystyle\mathcal{L}^{Item}_{MQ}</annotation><annotation encoding="application/x-llamapun" id="S2.E13.m1.1d">caligraphic_L start_POSTSUPERSCRIPT italic_I italic_t italic_e italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_M italic_Q end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathcal{L}^{Item}_{recon}+\mathcal{L}^{Item}_{cb}+\beta^{Item}%
\times\mathcal{L}^{Item}_{cm}," class="ltx_Math" display="inline" id="S2.E13.m2.1"><semantics id="S2.E13.m2.1a"><mrow id="S2.E13.m2.1.1.1" xref="S2.E13.m2.1.1.1.1.cmml"><mrow id="S2.E13.m2.1.1.1.1" xref="S2.E13.m2.1.1.1.1.cmml"><mi id="S2.E13.m2.1.1.1.1.2" xref="S2.E13.m2.1.1.1.1.2.cmml"></mi><mo id="S2.E13.m2.1.1.1.1.1" xref="S2.E13.m2.1.1.1.1.1.cmml">=</mo><mrow id="S2.E13.m2.1.1.1.1.3" xref="S2.E13.m2.1.1.1.1.3.cmml"><msubsup id="S2.E13.m2.1.1.1.1.3.2" xref="S2.E13.m2.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E13.m2.1.1.1.1.3.2.2.2" xref="S2.E13.m2.1.1.1.1.3.2.2.2.cmml">â„’</mi><mrow id="S2.E13.m2.1.1.1.1.3.2.3" xref="S2.E13.m2.1.1.1.1.3.2.3.cmml"><mi id="S2.E13.m2.1.1.1.1.3.2.3.2" xref="S2.E13.m2.1.1.1.1.3.2.3.2.cmml">r</mi><mo id="S2.E13.m2.1.1.1.1.3.2.3.1" xref="S2.E13.m2.1.1.1.1.3.2.3.1.cmml">â¢</mo><mi id="S2.E13.m2.1.1.1.1.3.2.3.3" xref="S2.E13.m2.1.1.1.1.3.2.3.3.cmml">e</mi><mo id="S2.E13.m2.1.1.1.1.3.2.3.1a" xref="S2.E13.m2.1.1.1.1.3.2.3.1.cmml">â¢</mo><mi id="S2.E13.m2.1.1.1.1.3.2.3.4" xref="S2.E13.m2.1.1.1.1.3.2.3.4.cmml">c</mi><mo id="S2.E13.m2.1.1.1.1.3.2.3.1b" xref="S2.E13.m2.1.1.1.1.3.2.3.1.cmml">â¢</mo><mi id="S2.E13.m2.1.1.1.1.3.2.3.5" xref="S2.E13.m2.1.1.1.1.3.2.3.5.cmml">o</mi><mo id="S2.E13.m2.1.1.1.1.3.2.3.1c" xref="S2.E13.m2.1.1.1.1.3.2.3.1.cmml">â¢</mo><mi id="S2.E13.m2.1.1.1.1.3.2.3.6" xref="S2.E13.m2.1.1.1.1.3.2.3.6.cmml">n</mi></mrow><mrow id="S2.E13.m2.1.1.1.1.3.2.2.3" xref="S2.E13.m2.1.1.1.1.3.2.2.3.cmml"><mi id="S2.E13.m2.1.1.1.1.3.2.2.3.2" xref="S2.E13.m2.1.1.1.1.3.2.2.3.2.cmml">I</mi><mo id="S2.E13.m2.1.1.1.1.3.2.2.3.1" xref="S2.E13.m2.1.1.1.1.3.2.2.3.1.cmml">â¢</mo><mi id="S2.E13.m2.1.1.1.1.3.2.2.3.3" xref="S2.E13.m2.1.1.1.1.3.2.2.3.3.cmml">t</mi><mo id="S2.E13.m2.1.1.1.1.3.2.2.3.1a" xref="S2.E13.m2.1.1.1.1.3.2.2.3.1.cmml">â¢</mo><mi id="S2.E13.m2.1.1.1.1.3.2.2.3.4" xref="S2.E13.m2.1.1.1.1.3.2.2.3.4.cmml">e</mi><mo id="S2.E13.m2.1.1.1.1.3.2.2.3.1b" xref="S2.E13.m2.1.1.1.1.3.2.2.3.1.cmml">â¢</mo><mi id="S2.E13.m2.1.1.1.1.3.2.2.3.5" xref="S2.E13.m2.1.1.1.1.3.2.2.3.5.cmml">m</mi></mrow></msubsup><mo id="S2.E13.m2.1.1.1.1.3.1" xref="S2.E13.m2.1.1.1.1.3.1.cmml">+</mo><msubsup id="S2.E13.m2.1.1.1.1.3.3" xref="S2.E13.m2.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E13.m2.1.1.1.1.3.3.2.2" xref="S2.E13.m2.1.1.1.1.3.3.2.2.cmml">â„’</mi><mrow id="S2.E13.m2.1.1.1.1.3.3.3" xref="S2.E13.m2.1.1.1.1.3.3.3.cmml"><mi id="S2.E13.m2.1.1.1.1.3.3.3.2" xref="S2.E13.m2.1.1.1.1.3.3.3.2.cmml">c</mi><mo id="S2.E13.m2.1.1.1.1.3.3.3.1" xref="S2.E13.m2.1.1.1.1.3.3.3.1.cmml">â¢</mo><mi id="S2.E13.m2.1.1.1.1.3.3.3.3" xref="S2.E13.m2.1.1.1.1.3.3.3.3.cmml">b</mi></mrow><mrow id="S2.E13.m2.1.1.1.1.3.3.2.3" xref="S2.E13.m2.1.1.1.1.3.3.2.3.cmml"><mi id="S2.E13.m2.1.1.1.1.3.3.2.3.2" xref="S2.E13.m2.1.1.1.1.3.3.2.3.2.cmml">I</mi><mo id="S2.E13.m2.1.1.1.1.3.3.2.3.1" xref="S2.E13.m2.1.1.1.1.3.3.2.3.1.cmml">â¢</mo><mi id="S2.E13.m2.1.1.1.1.3.3.2.3.3" xref="S2.E13.m2.1.1.1.1.3.3.2.3.3.cmml">t</mi><mo id="S2.E13.m2.1.1.1.1.3.3.2.3.1a" xref="S2.E13.m2.1.1.1.1.3.3.2.3.1.cmml">â¢</mo><mi id="S2.E13.m2.1.1.1.1.3.3.2.3.4" xref="S2.E13.m2.1.1.1.1.3.3.2.3.4.cmml">e</mi><mo id="S2.E13.m2.1.1.1.1.3.3.2.3.1b" xref="S2.E13.m2.1.1.1.1.3.3.2.3.1.cmml">â¢</mo><mi id="S2.E13.m2.1.1.1.1.3.3.2.3.5" xref="S2.E13.m2.1.1.1.1.3.3.2.3.5.cmml">m</mi></mrow></msubsup><mo id="S2.E13.m2.1.1.1.1.3.1a" xref="S2.E13.m2.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E13.m2.1.1.1.1.3.4" xref="S2.E13.m2.1.1.1.1.3.4.cmml"><msup id="S2.E13.m2.1.1.1.1.3.4.2" xref="S2.E13.m2.1.1.1.1.3.4.2.cmml"><mi id="S2.E13.m2.1.1.1.1.3.4.2.2" xref="S2.E13.m2.1.1.1.1.3.4.2.2.cmml">Î²</mi><mrow id="S2.E13.m2.1.1.1.1.3.4.2.3" xref="S2.E13.m2.1.1.1.1.3.4.2.3.cmml"><mi id="S2.E13.m2.1.1.1.1.3.4.2.3.2" xref="S2.E13.m2.1.1.1.1.3.4.2.3.2.cmml">I</mi><mo id="S2.E13.m2.1.1.1.1.3.4.2.3.1" xref="S2.E13.m2.1.1.1.1.3.4.2.3.1.cmml">â¢</mo><mi id="S2.E13.m2.1.1.1.1.3.4.2.3.3" xref="S2.E13.m2.1.1.1.1.3.4.2.3.3.cmml">t</mi><mo id="S2.E13.m2.1.1.1.1.3.4.2.3.1a" xref="S2.E13.m2.1.1.1.1.3.4.2.3.1.cmml">â¢</mo><mi id="S2.E13.m2.1.1.1.1.3.4.2.3.4" xref="S2.E13.m2.1.1.1.1.3.4.2.3.4.cmml">e</mi><mo id="S2.E13.m2.1.1.1.1.3.4.2.3.1b" xref="S2.E13.m2.1.1.1.1.3.4.2.3.1.cmml">â¢</mo><mi id="S2.E13.m2.1.1.1.1.3.4.2.3.5" xref="S2.E13.m2.1.1.1.1.3.4.2.3.5.cmml">m</mi></mrow></msup><mo id="S2.E13.m2.1.1.1.1.3.4.1" lspace="0.222em" rspace="0.222em" xref="S2.E13.m2.1.1.1.1.3.4.1.cmml">Ã—</mo><msubsup id="S2.E13.m2.1.1.1.1.3.4.3" xref="S2.E13.m2.1.1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E13.m2.1.1.1.1.3.4.3.2.2" xref="S2.E13.m2.1.1.1.1.3.4.3.2.2.cmml">â„’</mi><mrow id="S2.E13.m2.1.1.1.1.3.4.3.3" xref="S2.E13.m2.1.1.1.1.3.4.3.3.cmml"><mi id="S2.E13.m2.1.1.1.1.3.4.3.3.2" xref="S2.E13.m2.1.1.1.1.3.4.3.3.2.cmml">c</mi><mo id="S2.E13.m2.1.1.1.1.3.4.3.3.1" xref="S2.E13.m2.1.1.1.1.3.4.3.3.1.cmml">â¢</mo><mi id="S2.E13.m2.1.1.1.1.3.4.3.3.3" xref="S2.E13.m2.1.1.1.1.3.4.3.3.3.cmml">m</mi></mrow><mrow id="S2.E13.m2.1.1.1.1.3.4.3.2.3" xref="S2.E13.m2.1.1.1.1.3.4.3.2.3.cmml"><mi id="S2.E13.m2.1.1.1.1.3.4.3.2.3.2" xref="S2.E13.m2.1.1.1.1.3.4.3.2.3.2.cmml">I</mi><mo id="S2.E13.m2.1.1.1.1.3.4.3.2.3.1" xref="S2.E13.m2.1.1.1.1.3.4.3.2.3.1.cmml">â¢</mo><mi id="S2.E13.m2.1.1.1.1.3.4.3.2.3.3" xref="S2.E13.m2.1.1.1.1.3.4.3.2.3.3.cmml">t</mi><mo id="S2.E13.m2.1.1.1.1.3.4.3.2.3.1a" xref="S2.E13.m2.1.1.1.1.3.4.3.2.3.1.cmml">â¢</mo><mi id="S2.E13.m2.1.1.1.1.3.4.3.2.3.4" xref="S2.E13.m2.1.1.1.1.3.4.3.2.3.4.cmml">e</mi><mo id="S2.E13.m2.1.1.1.1.3.4.3.2.3.1b" xref="S2.E13.m2.1.1.1.1.3.4.3.2.3.1.cmml">â¢</mo><mi id="S2.E13.m2.1.1.1.1.3.4.3.2.3.5" xref="S2.E13.m2.1.1.1.1.3.4.3.2.3.5.cmml">m</mi></mrow></msubsup></mrow></mrow></mrow><mo id="S2.E13.m2.1.1.1.2" xref="S2.E13.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E13.m2.1b"><apply id="S2.E13.m2.1.1.1.1.cmml" xref="S2.E13.m2.1.1.1"><eq id="S2.E13.m2.1.1.1.1.1.cmml" xref="S2.E13.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S2.E13.m2.1.1.1.1.2.cmml" xref="S2.E13.m2.1.1.1.1.2">absent</csymbol><apply id="S2.E13.m2.1.1.1.1.3.cmml" xref="S2.E13.m2.1.1.1.1.3"><plus id="S2.E13.m2.1.1.1.1.3.1.cmml" xref="S2.E13.m2.1.1.1.1.3.1"></plus><apply id="S2.E13.m2.1.1.1.1.3.2.cmml" xref="S2.E13.m2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E13.m2.1.1.1.1.3.2.1.cmml" xref="S2.E13.m2.1.1.1.1.3.2">subscript</csymbol><apply id="S2.E13.m2.1.1.1.1.3.2.2.cmml" xref="S2.E13.m2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E13.m2.1.1.1.1.3.2.2.1.cmml" xref="S2.E13.m2.1.1.1.1.3.2">superscript</csymbol><ci id="S2.E13.m2.1.1.1.1.3.2.2.2.cmml" xref="S2.E13.m2.1.1.1.1.3.2.2.2">â„’</ci><apply id="S2.E13.m2.1.1.1.1.3.2.2.3.cmml" xref="S2.E13.m2.1.1.1.1.3.2.2.3"><times id="S2.E13.m2.1.1.1.1.3.2.2.3.1.cmml" xref="S2.E13.m2.1.1.1.1.3.2.2.3.1"></times><ci id="S2.E13.m2.1.1.1.1.3.2.2.3.2.cmml" xref="S2.E13.m2.1.1.1.1.3.2.2.3.2">ğ¼</ci><ci id="S2.E13.m2.1.1.1.1.3.2.2.3.3.cmml" xref="S2.E13.m2.1.1.1.1.3.2.2.3.3">ğ‘¡</ci><ci id="S2.E13.m2.1.1.1.1.3.2.2.3.4.cmml" xref="S2.E13.m2.1.1.1.1.3.2.2.3.4">ğ‘’</ci><ci id="S2.E13.m2.1.1.1.1.3.2.2.3.5.cmml" xref="S2.E13.m2.1.1.1.1.3.2.2.3.5">ğ‘š</ci></apply></apply><apply id="S2.E13.m2.1.1.1.1.3.2.3.cmml" xref="S2.E13.m2.1.1.1.1.3.2.3"><times id="S2.E13.m2.1.1.1.1.3.2.3.1.cmml" xref="S2.E13.m2.1.1.1.1.3.2.3.1"></times><ci id="S2.E13.m2.1.1.1.1.3.2.3.2.cmml" xref="S2.E13.m2.1.1.1.1.3.2.3.2">ğ‘Ÿ</ci><ci id="S2.E13.m2.1.1.1.1.3.2.3.3.cmml" xref="S2.E13.m2.1.1.1.1.3.2.3.3">ğ‘’</ci><ci id="S2.E13.m2.1.1.1.1.3.2.3.4.cmml" xref="S2.E13.m2.1.1.1.1.3.2.3.4">ğ‘</ci><ci id="S2.E13.m2.1.1.1.1.3.2.3.5.cmml" xref="S2.E13.m2.1.1.1.1.3.2.3.5">ğ‘œ</ci><ci id="S2.E13.m2.1.1.1.1.3.2.3.6.cmml" xref="S2.E13.m2.1.1.1.1.3.2.3.6">ğ‘›</ci></apply></apply><apply id="S2.E13.m2.1.1.1.1.3.3.cmml" xref="S2.E13.m2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E13.m2.1.1.1.1.3.3.1.cmml" xref="S2.E13.m2.1.1.1.1.3.3">subscript</csymbol><apply id="S2.E13.m2.1.1.1.1.3.3.2.cmml" xref="S2.E13.m2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E13.m2.1.1.1.1.3.3.2.1.cmml" xref="S2.E13.m2.1.1.1.1.3.3">superscript</csymbol><ci id="S2.E13.m2.1.1.1.1.3.3.2.2.cmml" xref="S2.E13.m2.1.1.1.1.3.3.2.2">â„’</ci><apply id="S2.E13.m2.1.1.1.1.3.3.2.3.cmml" xref="S2.E13.m2.1.1.1.1.3.3.2.3"><times id="S2.E13.m2.1.1.1.1.3.3.2.3.1.cmml" xref="S2.E13.m2.1.1.1.1.3.3.2.3.1"></times><ci id="S2.E13.m2.1.1.1.1.3.3.2.3.2.cmml" xref="S2.E13.m2.1.1.1.1.3.3.2.3.2">ğ¼</ci><ci id="S2.E13.m2.1.1.1.1.3.3.2.3.3.cmml" xref="S2.E13.m2.1.1.1.1.3.3.2.3.3">ğ‘¡</ci><ci id="S2.E13.m2.1.1.1.1.3.3.2.3.4.cmml" xref="S2.E13.m2.1.1.1.1.3.3.2.3.4">ğ‘’</ci><ci id="S2.E13.m2.1.1.1.1.3.3.2.3.5.cmml" xref="S2.E13.m2.1.1.1.1.3.3.2.3.5">ğ‘š</ci></apply></apply><apply id="S2.E13.m2.1.1.1.1.3.3.3.cmml" xref="S2.E13.m2.1.1.1.1.3.3.3"><times id="S2.E13.m2.1.1.1.1.3.3.3.1.cmml" xref="S2.E13.m2.1.1.1.1.3.3.3.1"></times><ci id="S2.E13.m2.1.1.1.1.3.3.3.2.cmml" xref="S2.E13.m2.1.1.1.1.3.3.3.2">ğ‘</ci><ci id="S2.E13.m2.1.1.1.1.3.3.3.3.cmml" xref="S2.E13.m2.1.1.1.1.3.3.3.3">ğ‘</ci></apply></apply><apply id="S2.E13.m2.1.1.1.1.3.4.cmml" xref="S2.E13.m2.1.1.1.1.3.4"><times id="S2.E13.m2.1.1.1.1.3.4.1.cmml" xref="S2.E13.m2.1.1.1.1.3.4.1"></times><apply id="S2.E13.m2.1.1.1.1.3.4.2.cmml" xref="S2.E13.m2.1.1.1.1.3.4.2"><csymbol cd="ambiguous" id="S2.E13.m2.1.1.1.1.3.4.2.1.cmml" xref="S2.E13.m2.1.1.1.1.3.4.2">superscript</csymbol><ci id="S2.E13.m2.1.1.1.1.3.4.2.2.cmml" xref="S2.E13.m2.1.1.1.1.3.4.2.2">ğ›½</ci><apply id="S2.E13.m2.1.1.1.1.3.4.2.3.cmml" xref="S2.E13.m2.1.1.1.1.3.4.2.3"><times id="S2.E13.m2.1.1.1.1.3.4.2.3.1.cmml" xref="S2.E13.m2.1.1.1.1.3.4.2.3.1"></times><ci id="S2.E13.m2.1.1.1.1.3.4.2.3.2.cmml" xref="S2.E13.m2.1.1.1.1.3.4.2.3.2">ğ¼</ci><ci id="S2.E13.m2.1.1.1.1.3.4.2.3.3.cmml" xref="S2.E13.m2.1.1.1.1.3.4.2.3.3">ğ‘¡</ci><ci id="S2.E13.m2.1.1.1.1.3.4.2.3.4.cmml" xref="S2.E13.m2.1.1.1.1.3.4.2.3.4">ğ‘’</ci><ci id="S2.E13.m2.1.1.1.1.3.4.2.3.5.cmml" xref="S2.E13.m2.1.1.1.1.3.4.2.3.5">ğ‘š</ci></apply></apply><apply id="S2.E13.m2.1.1.1.1.3.4.3.cmml" xref="S2.E13.m2.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S2.E13.m2.1.1.1.1.3.4.3.1.cmml" xref="S2.E13.m2.1.1.1.1.3.4.3">subscript</csymbol><apply id="S2.E13.m2.1.1.1.1.3.4.3.2.cmml" xref="S2.E13.m2.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S2.E13.m2.1.1.1.1.3.4.3.2.1.cmml" xref="S2.E13.m2.1.1.1.1.3.4.3">superscript</csymbol><ci id="S2.E13.m2.1.1.1.1.3.4.3.2.2.cmml" xref="S2.E13.m2.1.1.1.1.3.4.3.2.2">â„’</ci><apply id="S2.E13.m2.1.1.1.1.3.4.3.2.3.cmml" xref="S2.E13.m2.1.1.1.1.3.4.3.2.3"><times id="S2.E13.m2.1.1.1.1.3.4.3.2.3.1.cmml" xref="S2.E13.m2.1.1.1.1.3.4.3.2.3.1"></times><ci id="S2.E13.m2.1.1.1.1.3.4.3.2.3.2.cmml" xref="S2.E13.m2.1.1.1.1.3.4.3.2.3.2">ğ¼</ci><ci id="S2.E13.m2.1.1.1.1.3.4.3.2.3.3.cmml" xref="S2.E13.m2.1.1.1.1.3.4.3.2.3.3">ğ‘¡</ci><ci id="S2.E13.m2.1.1.1.1.3.4.3.2.3.4.cmml" xref="S2.E13.m2.1.1.1.1.3.4.3.2.3.4">ğ‘’</ci><ci id="S2.E13.m2.1.1.1.1.3.4.3.2.3.5.cmml" xref="S2.E13.m2.1.1.1.1.3.4.3.2.3.5">ğ‘š</ci></apply></apply><apply id="S2.E13.m2.1.1.1.1.3.4.3.3.cmml" xref="S2.E13.m2.1.1.1.1.3.4.3.3"><times id="S2.E13.m2.1.1.1.1.3.4.3.3.1.cmml" xref="S2.E13.m2.1.1.1.1.3.4.3.3.1"></times><ci id="S2.E13.m2.1.1.1.1.3.4.3.3.2.cmml" xref="S2.E13.m2.1.1.1.1.3.4.3.3.2">ğ‘</ci><ci id="S2.E13.m2.1.1.1.1.3.4.3.3.3.cmml" xref="S2.E13.m2.1.1.1.1.3.4.3.3.3">ğ‘š</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E13.m2.1c">\displaystyle=\mathcal{L}^{Item}_{recon}+\mathcal{L}^{Item}_{cb}+\beta^{Item}%
\times\mathcal{L}^{Item}_{cm},</annotation><annotation encoding="application/x-llamapun" id="S2.E13.m2.1d">= caligraphic_L start_POSTSUPERSCRIPT italic_I italic_t italic_e italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r italic_e italic_c italic_o italic_n end_POSTSUBSCRIPT + caligraphic_L start_POSTSUPERSCRIPT italic_I italic_t italic_e italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c italic_b end_POSTSUBSCRIPT + italic_Î² start_POSTSUPERSCRIPT italic_I italic_t italic_e italic_m end_POSTSUPERSCRIPT Ã— caligraphic_L start_POSTSUPERSCRIPT italic_I italic_t italic_e italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c italic_m end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS5.p4.4">where <math alttext="\beta^{Item}" class="ltx_Math" display="inline" id="S2.SS3.SSS5.p4.4.m1.1"><semantics id="S2.SS3.SSS5.p4.4.m1.1a"><msup id="S2.SS3.SSS5.p4.4.m1.1.1" xref="S2.SS3.SSS5.p4.4.m1.1.1.cmml"><mi id="S2.SS3.SSS5.p4.4.m1.1.1.2" xref="S2.SS3.SSS5.p4.4.m1.1.1.2.cmml">Î²</mi><mrow id="S2.SS3.SSS5.p4.4.m1.1.1.3" xref="S2.SS3.SSS5.p4.4.m1.1.1.3.cmml"><mi id="S2.SS3.SSS5.p4.4.m1.1.1.3.2" xref="S2.SS3.SSS5.p4.4.m1.1.1.3.2.cmml">I</mi><mo id="S2.SS3.SSS5.p4.4.m1.1.1.3.1" xref="S2.SS3.SSS5.p4.4.m1.1.1.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p4.4.m1.1.1.3.3" xref="S2.SS3.SSS5.p4.4.m1.1.1.3.3.cmml">t</mi><mo id="S2.SS3.SSS5.p4.4.m1.1.1.3.1a" xref="S2.SS3.SSS5.p4.4.m1.1.1.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p4.4.m1.1.1.3.4" xref="S2.SS3.SSS5.p4.4.m1.1.1.3.4.cmml">e</mi><mo id="S2.SS3.SSS5.p4.4.m1.1.1.3.1b" xref="S2.SS3.SSS5.p4.4.m1.1.1.3.1.cmml">â¢</mo><mi id="S2.SS3.SSS5.p4.4.m1.1.1.3.5" xref="S2.SS3.SSS5.p4.4.m1.1.1.3.5.cmml">m</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS5.p4.4.m1.1b"><apply id="S2.SS3.SSS5.p4.4.m1.1.1.cmml" xref="S2.SS3.SSS5.p4.4.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS5.p4.4.m1.1.1.1.cmml" xref="S2.SS3.SSS5.p4.4.m1.1.1">superscript</csymbol><ci id="S2.SS3.SSS5.p4.4.m1.1.1.2.cmml" xref="S2.SS3.SSS5.p4.4.m1.1.1.2">ğ›½</ci><apply id="S2.SS3.SSS5.p4.4.m1.1.1.3.cmml" xref="S2.SS3.SSS5.p4.4.m1.1.1.3"><times id="S2.SS3.SSS5.p4.4.m1.1.1.3.1.cmml" xref="S2.SS3.SSS5.p4.4.m1.1.1.3.1"></times><ci id="S2.SS3.SSS5.p4.4.m1.1.1.3.2.cmml" xref="S2.SS3.SSS5.p4.4.m1.1.1.3.2">ğ¼</ci><ci id="S2.SS3.SSS5.p4.4.m1.1.1.3.3.cmml" xref="S2.SS3.SSS5.p4.4.m1.1.1.3.3">ğ‘¡</ci><ci id="S2.SS3.SSS5.p4.4.m1.1.1.3.4.cmml" xref="S2.SS3.SSS5.p4.4.m1.1.1.3.4">ğ‘’</ci><ci id="S2.SS3.SSS5.p4.4.m1.1.1.3.5.cmml" xref="S2.SS3.SSS5.p4.4.m1.1.1.3.5">ğ‘š</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS5.p4.4.m1.1c">\beta^{Item}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS5.p4.4.m1.1d">italic_Î² start_POSTSUPERSCRIPT italic_I italic_t italic_e italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> is a hyper-parameter that aims to balance the importance of the commitment loss in the overall objective.
Additionally, the aforementioned optimization objective for optimizing the user MQ-Tokenizer can be designed as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx12">
<tbody id="S2.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}^{User}_{MQ}" class="ltx_Math" display="inline" id="S2.E14.m1.1"><semantics id="S2.E14.m1.1a"><msubsup id="S2.E14.m1.1.1" xref="S2.E14.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E14.m1.1.1.2.2" xref="S2.E14.m1.1.1.2.2.cmml">â„’</mi><mrow id="S2.E14.m1.1.1.3" xref="S2.E14.m1.1.1.3.cmml"><mi id="S2.E14.m1.1.1.3.2" xref="S2.E14.m1.1.1.3.2.cmml">M</mi><mo id="S2.E14.m1.1.1.3.1" xref="S2.E14.m1.1.1.3.1.cmml">â¢</mo><mi id="S2.E14.m1.1.1.3.3" xref="S2.E14.m1.1.1.3.3.cmml">Q</mi></mrow><mrow id="S2.E14.m1.1.1.2.3" xref="S2.E14.m1.1.1.2.3.cmml"><mi id="S2.E14.m1.1.1.2.3.2" xref="S2.E14.m1.1.1.2.3.2.cmml">U</mi><mo id="S2.E14.m1.1.1.2.3.1" xref="S2.E14.m1.1.1.2.3.1.cmml">â¢</mo><mi id="S2.E14.m1.1.1.2.3.3" xref="S2.E14.m1.1.1.2.3.3.cmml">s</mi><mo id="S2.E14.m1.1.1.2.3.1a" xref="S2.E14.m1.1.1.2.3.1.cmml">â¢</mo><mi id="S2.E14.m1.1.1.2.3.4" xref="S2.E14.m1.1.1.2.3.4.cmml">e</mi><mo id="S2.E14.m1.1.1.2.3.1b" xref="S2.E14.m1.1.1.2.3.1.cmml">â¢</mo><mi id="S2.E14.m1.1.1.2.3.5" xref="S2.E14.m1.1.1.2.3.5.cmml">r</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.E14.m1.1b"><apply id="S2.E14.m1.1.1.cmml" xref="S2.E14.m1.1.1"><csymbol cd="ambiguous" id="S2.E14.m1.1.1.1.cmml" xref="S2.E14.m1.1.1">subscript</csymbol><apply id="S2.E14.m1.1.1.2.cmml" xref="S2.E14.m1.1.1"><csymbol cd="ambiguous" id="S2.E14.m1.1.1.2.1.cmml" xref="S2.E14.m1.1.1">superscript</csymbol><ci id="S2.E14.m1.1.1.2.2.cmml" xref="S2.E14.m1.1.1.2.2">â„’</ci><apply id="S2.E14.m1.1.1.2.3.cmml" xref="S2.E14.m1.1.1.2.3"><times id="S2.E14.m1.1.1.2.3.1.cmml" xref="S2.E14.m1.1.1.2.3.1"></times><ci id="S2.E14.m1.1.1.2.3.2.cmml" xref="S2.E14.m1.1.1.2.3.2">ğ‘ˆ</ci><ci id="S2.E14.m1.1.1.2.3.3.cmml" xref="S2.E14.m1.1.1.2.3.3">ğ‘ </ci><ci id="S2.E14.m1.1.1.2.3.4.cmml" xref="S2.E14.m1.1.1.2.3.4">ğ‘’</ci><ci id="S2.E14.m1.1.1.2.3.5.cmml" xref="S2.E14.m1.1.1.2.3.5">ğ‘Ÿ</ci></apply></apply><apply id="S2.E14.m1.1.1.3.cmml" xref="S2.E14.m1.1.1.3"><times id="S2.E14.m1.1.1.3.1.cmml" xref="S2.E14.m1.1.1.3.1"></times><ci id="S2.E14.m1.1.1.3.2.cmml" xref="S2.E14.m1.1.1.3.2">ğ‘€</ci><ci id="S2.E14.m1.1.1.3.3.cmml" xref="S2.E14.m1.1.1.3.3">ğ‘„</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E14.m1.1c">\displaystyle\mathcal{L}^{User}_{MQ}</annotation><annotation encoding="application/x-llamapun" id="S2.E14.m1.1d">caligraphic_L start_POSTSUPERSCRIPT italic_U italic_s italic_e italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_M italic_Q end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathcal{L}^{User}_{recon}+\mathcal{L}^{User}_{cb}+\beta^{User}%
\times\mathcal{L}^{User}_{cm}." class="ltx_Math" display="inline" id="S2.E14.m2.1"><semantics id="S2.E14.m2.1a"><mrow id="S2.E14.m2.1.1.1" xref="S2.E14.m2.1.1.1.1.cmml"><mrow id="S2.E14.m2.1.1.1.1" xref="S2.E14.m2.1.1.1.1.cmml"><mi id="S2.E14.m2.1.1.1.1.2" xref="S2.E14.m2.1.1.1.1.2.cmml"></mi><mo id="S2.E14.m2.1.1.1.1.1" xref="S2.E14.m2.1.1.1.1.1.cmml">=</mo><mrow id="S2.E14.m2.1.1.1.1.3" xref="S2.E14.m2.1.1.1.1.3.cmml"><msubsup id="S2.E14.m2.1.1.1.1.3.2" xref="S2.E14.m2.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E14.m2.1.1.1.1.3.2.2.2" xref="S2.E14.m2.1.1.1.1.3.2.2.2.cmml">â„’</mi><mrow id="S2.E14.m2.1.1.1.1.3.2.3" xref="S2.E14.m2.1.1.1.1.3.2.3.cmml"><mi id="S2.E14.m2.1.1.1.1.3.2.3.2" xref="S2.E14.m2.1.1.1.1.3.2.3.2.cmml">r</mi><mo id="S2.E14.m2.1.1.1.1.3.2.3.1" xref="S2.E14.m2.1.1.1.1.3.2.3.1.cmml">â¢</mo><mi id="S2.E14.m2.1.1.1.1.3.2.3.3" xref="S2.E14.m2.1.1.1.1.3.2.3.3.cmml">e</mi><mo id="S2.E14.m2.1.1.1.1.3.2.3.1a" xref="S2.E14.m2.1.1.1.1.3.2.3.1.cmml">â¢</mo><mi id="S2.E14.m2.1.1.1.1.3.2.3.4" xref="S2.E14.m2.1.1.1.1.3.2.3.4.cmml">c</mi><mo id="S2.E14.m2.1.1.1.1.3.2.3.1b" xref="S2.E14.m2.1.1.1.1.3.2.3.1.cmml">â¢</mo><mi id="S2.E14.m2.1.1.1.1.3.2.3.5" xref="S2.E14.m2.1.1.1.1.3.2.3.5.cmml">o</mi><mo id="S2.E14.m2.1.1.1.1.3.2.3.1c" xref="S2.E14.m2.1.1.1.1.3.2.3.1.cmml">â¢</mo><mi id="S2.E14.m2.1.1.1.1.3.2.3.6" xref="S2.E14.m2.1.1.1.1.3.2.3.6.cmml">n</mi></mrow><mrow id="S2.E14.m2.1.1.1.1.3.2.2.3" xref="S2.E14.m2.1.1.1.1.3.2.2.3.cmml"><mi id="S2.E14.m2.1.1.1.1.3.2.2.3.2" xref="S2.E14.m2.1.1.1.1.3.2.2.3.2.cmml">U</mi><mo id="S2.E14.m2.1.1.1.1.3.2.2.3.1" xref="S2.E14.m2.1.1.1.1.3.2.2.3.1.cmml">â¢</mo><mi id="S2.E14.m2.1.1.1.1.3.2.2.3.3" xref="S2.E14.m2.1.1.1.1.3.2.2.3.3.cmml">s</mi><mo id="S2.E14.m2.1.1.1.1.3.2.2.3.1a" xref="S2.E14.m2.1.1.1.1.3.2.2.3.1.cmml">â¢</mo><mi id="S2.E14.m2.1.1.1.1.3.2.2.3.4" xref="S2.E14.m2.1.1.1.1.3.2.2.3.4.cmml">e</mi><mo id="S2.E14.m2.1.1.1.1.3.2.2.3.1b" xref="S2.E14.m2.1.1.1.1.3.2.2.3.1.cmml">â¢</mo><mi id="S2.E14.m2.1.1.1.1.3.2.2.3.5" xref="S2.E14.m2.1.1.1.1.3.2.2.3.5.cmml">r</mi></mrow></msubsup><mo id="S2.E14.m2.1.1.1.1.3.1" xref="S2.E14.m2.1.1.1.1.3.1.cmml">+</mo><msubsup id="S2.E14.m2.1.1.1.1.3.3" xref="S2.E14.m2.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E14.m2.1.1.1.1.3.3.2.2" xref="S2.E14.m2.1.1.1.1.3.3.2.2.cmml">â„’</mi><mrow id="S2.E14.m2.1.1.1.1.3.3.3" xref="S2.E14.m2.1.1.1.1.3.3.3.cmml"><mi id="S2.E14.m2.1.1.1.1.3.3.3.2" xref="S2.E14.m2.1.1.1.1.3.3.3.2.cmml">c</mi><mo id="S2.E14.m2.1.1.1.1.3.3.3.1" xref="S2.E14.m2.1.1.1.1.3.3.3.1.cmml">â¢</mo><mi id="S2.E14.m2.1.1.1.1.3.3.3.3" xref="S2.E14.m2.1.1.1.1.3.3.3.3.cmml">b</mi></mrow><mrow id="S2.E14.m2.1.1.1.1.3.3.2.3" xref="S2.E14.m2.1.1.1.1.3.3.2.3.cmml"><mi id="S2.E14.m2.1.1.1.1.3.3.2.3.2" xref="S2.E14.m2.1.1.1.1.3.3.2.3.2.cmml">U</mi><mo id="S2.E14.m2.1.1.1.1.3.3.2.3.1" xref="S2.E14.m2.1.1.1.1.3.3.2.3.1.cmml">â¢</mo><mi id="S2.E14.m2.1.1.1.1.3.3.2.3.3" xref="S2.E14.m2.1.1.1.1.3.3.2.3.3.cmml">s</mi><mo id="S2.E14.m2.1.1.1.1.3.3.2.3.1a" xref="S2.E14.m2.1.1.1.1.3.3.2.3.1.cmml">â¢</mo><mi id="S2.E14.m2.1.1.1.1.3.3.2.3.4" xref="S2.E14.m2.1.1.1.1.3.3.2.3.4.cmml">e</mi><mo id="S2.E14.m2.1.1.1.1.3.3.2.3.1b" xref="S2.E14.m2.1.1.1.1.3.3.2.3.1.cmml">â¢</mo><mi id="S2.E14.m2.1.1.1.1.3.3.2.3.5" xref="S2.E14.m2.1.1.1.1.3.3.2.3.5.cmml">r</mi></mrow></msubsup><mo id="S2.E14.m2.1.1.1.1.3.1a" xref="S2.E14.m2.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E14.m2.1.1.1.1.3.4" xref="S2.E14.m2.1.1.1.1.3.4.cmml"><msup id="S2.E14.m2.1.1.1.1.3.4.2" xref="S2.E14.m2.1.1.1.1.3.4.2.cmml"><mi id="S2.E14.m2.1.1.1.1.3.4.2.2" xref="S2.E14.m2.1.1.1.1.3.4.2.2.cmml">Î²</mi><mrow id="S2.E14.m2.1.1.1.1.3.4.2.3" xref="S2.E14.m2.1.1.1.1.3.4.2.3.cmml"><mi id="S2.E14.m2.1.1.1.1.3.4.2.3.2" xref="S2.E14.m2.1.1.1.1.3.4.2.3.2.cmml">U</mi><mo id="S2.E14.m2.1.1.1.1.3.4.2.3.1" xref="S2.E14.m2.1.1.1.1.3.4.2.3.1.cmml">â¢</mo><mi id="S2.E14.m2.1.1.1.1.3.4.2.3.3" xref="S2.E14.m2.1.1.1.1.3.4.2.3.3.cmml">s</mi><mo id="S2.E14.m2.1.1.1.1.3.4.2.3.1a" xref="S2.E14.m2.1.1.1.1.3.4.2.3.1.cmml">â¢</mo><mi id="S2.E14.m2.1.1.1.1.3.4.2.3.4" xref="S2.E14.m2.1.1.1.1.3.4.2.3.4.cmml">e</mi><mo id="S2.E14.m2.1.1.1.1.3.4.2.3.1b" xref="S2.E14.m2.1.1.1.1.3.4.2.3.1.cmml">â¢</mo><mi id="S2.E14.m2.1.1.1.1.3.4.2.3.5" xref="S2.E14.m2.1.1.1.1.3.4.2.3.5.cmml">r</mi></mrow></msup><mo id="S2.E14.m2.1.1.1.1.3.4.1" lspace="0.222em" rspace="0.222em" xref="S2.E14.m2.1.1.1.1.3.4.1.cmml">Ã—</mo><msubsup id="S2.E14.m2.1.1.1.1.3.4.3" xref="S2.E14.m2.1.1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E14.m2.1.1.1.1.3.4.3.2.2" xref="S2.E14.m2.1.1.1.1.3.4.3.2.2.cmml">â„’</mi><mrow id="S2.E14.m2.1.1.1.1.3.4.3.3" xref="S2.E14.m2.1.1.1.1.3.4.3.3.cmml"><mi id="S2.E14.m2.1.1.1.1.3.4.3.3.2" xref="S2.E14.m2.1.1.1.1.3.4.3.3.2.cmml">c</mi><mo id="S2.E14.m2.1.1.1.1.3.4.3.3.1" xref="S2.E14.m2.1.1.1.1.3.4.3.3.1.cmml">â¢</mo><mi id="S2.E14.m2.1.1.1.1.3.4.3.3.3" xref="S2.E14.m2.1.1.1.1.3.4.3.3.3.cmml">m</mi></mrow><mrow id="S2.E14.m2.1.1.1.1.3.4.3.2.3" xref="S2.E14.m2.1.1.1.1.3.4.3.2.3.cmml"><mi id="S2.E14.m2.1.1.1.1.3.4.3.2.3.2" xref="S2.E14.m2.1.1.1.1.3.4.3.2.3.2.cmml">U</mi><mo id="S2.E14.m2.1.1.1.1.3.4.3.2.3.1" xref="S2.E14.m2.1.1.1.1.3.4.3.2.3.1.cmml">â¢</mo><mi id="S2.E14.m2.1.1.1.1.3.4.3.2.3.3" xref="S2.E14.m2.1.1.1.1.3.4.3.2.3.3.cmml">s</mi><mo id="S2.E14.m2.1.1.1.1.3.4.3.2.3.1a" xref="S2.E14.m2.1.1.1.1.3.4.3.2.3.1.cmml">â¢</mo><mi id="S2.E14.m2.1.1.1.1.3.4.3.2.3.4" xref="S2.E14.m2.1.1.1.1.3.4.3.2.3.4.cmml">e</mi><mo id="S2.E14.m2.1.1.1.1.3.4.3.2.3.1b" xref="S2.E14.m2.1.1.1.1.3.4.3.2.3.1.cmml">â¢</mo><mi id="S2.E14.m2.1.1.1.1.3.4.3.2.3.5" xref="S2.E14.m2.1.1.1.1.3.4.3.2.3.5.cmml">r</mi></mrow></msubsup></mrow></mrow></mrow><mo id="S2.E14.m2.1.1.1.2" lspace="0em" xref="S2.E14.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E14.m2.1b"><apply id="S2.E14.m2.1.1.1.1.cmml" xref="S2.E14.m2.1.1.1"><eq id="S2.E14.m2.1.1.1.1.1.cmml" xref="S2.E14.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S2.E14.m2.1.1.1.1.2.cmml" xref="S2.E14.m2.1.1.1.1.2">absent</csymbol><apply id="S2.E14.m2.1.1.1.1.3.cmml" xref="S2.E14.m2.1.1.1.1.3"><plus id="S2.E14.m2.1.1.1.1.3.1.cmml" xref="S2.E14.m2.1.1.1.1.3.1"></plus><apply id="S2.E14.m2.1.1.1.1.3.2.cmml" xref="S2.E14.m2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E14.m2.1.1.1.1.3.2.1.cmml" xref="S2.E14.m2.1.1.1.1.3.2">subscript</csymbol><apply id="S2.E14.m2.1.1.1.1.3.2.2.cmml" xref="S2.E14.m2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E14.m2.1.1.1.1.3.2.2.1.cmml" xref="S2.E14.m2.1.1.1.1.3.2">superscript</csymbol><ci id="S2.E14.m2.1.1.1.1.3.2.2.2.cmml" xref="S2.E14.m2.1.1.1.1.3.2.2.2">â„’</ci><apply id="S2.E14.m2.1.1.1.1.3.2.2.3.cmml" xref="S2.E14.m2.1.1.1.1.3.2.2.3"><times id="S2.E14.m2.1.1.1.1.3.2.2.3.1.cmml" xref="S2.E14.m2.1.1.1.1.3.2.2.3.1"></times><ci id="S2.E14.m2.1.1.1.1.3.2.2.3.2.cmml" xref="S2.E14.m2.1.1.1.1.3.2.2.3.2">ğ‘ˆ</ci><ci id="S2.E14.m2.1.1.1.1.3.2.2.3.3.cmml" xref="S2.E14.m2.1.1.1.1.3.2.2.3.3">ğ‘ </ci><ci id="S2.E14.m2.1.1.1.1.3.2.2.3.4.cmml" xref="S2.E14.m2.1.1.1.1.3.2.2.3.4">ğ‘’</ci><ci id="S2.E14.m2.1.1.1.1.3.2.2.3.5.cmml" xref="S2.E14.m2.1.1.1.1.3.2.2.3.5">ğ‘Ÿ</ci></apply></apply><apply id="S2.E14.m2.1.1.1.1.3.2.3.cmml" xref="S2.E14.m2.1.1.1.1.3.2.3"><times id="S2.E14.m2.1.1.1.1.3.2.3.1.cmml" xref="S2.E14.m2.1.1.1.1.3.2.3.1"></times><ci id="S2.E14.m2.1.1.1.1.3.2.3.2.cmml" xref="S2.E14.m2.1.1.1.1.3.2.3.2">ğ‘Ÿ</ci><ci id="S2.E14.m2.1.1.1.1.3.2.3.3.cmml" xref="S2.E14.m2.1.1.1.1.3.2.3.3">ğ‘’</ci><ci id="S2.E14.m2.1.1.1.1.3.2.3.4.cmml" xref="S2.E14.m2.1.1.1.1.3.2.3.4">ğ‘</ci><ci id="S2.E14.m2.1.1.1.1.3.2.3.5.cmml" xref="S2.E14.m2.1.1.1.1.3.2.3.5">ğ‘œ</ci><ci id="S2.E14.m2.1.1.1.1.3.2.3.6.cmml" xref="S2.E14.m2.1.1.1.1.3.2.3.6">ğ‘›</ci></apply></apply><apply id="S2.E14.m2.1.1.1.1.3.3.cmml" xref="S2.E14.m2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E14.m2.1.1.1.1.3.3.1.cmml" xref="S2.E14.m2.1.1.1.1.3.3">subscript</csymbol><apply id="S2.E14.m2.1.1.1.1.3.3.2.cmml" xref="S2.E14.m2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E14.m2.1.1.1.1.3.3.2.1.cmml" xref="S2.E14.m2.1.1.1.1.3.3">superscript</csymbol><ci id="S2.E14.m2.1.1.1.1.3.3.2.2.cmml" xref="S2.E14.m2.1.1.1.1.3.3.2.2">â„’</ci><apply id="S2.E14.m2.1.1.1.1.3.3.2.3.cmml" xref="S2.E14.m2.1.1.1.1.3.3.2.3"><times id="S2.E14.m2.1.1.1.1.3.3.2.3.1.cmml" xref="S2.E14.m2.1.1.1.1.3.3.2.3.1"></times><ci id="S2.E14.m2.1.1.1.1.3.3.2.3.2.cmml" xref="S2.E14.m2.1.1.1.1.3.3.2.3.2">ğ‘ˆ</ci><ci id="S2.E14.m2.1.1.1.1.3.3.2.3.3.cmml" xref="S2.E14.m2.1.1.1.1.3.3.2.3.3">ğ‘ </ci><ci id="S2.E14.m2.1.1.1.1.3.3.2.3.4.cmml" xref="S2.E14.m2.1.1.1.1.3.3.2.3.4">ğ‘’</ci><ci id="S2.E14.m2.1.1.1.1.3.3.2.3.5.cmml" xref="S2.E14.m2.1.1.1.1.3.3.2.3.5">ğ‘Ÿ</ci></apply></apply><apply id="S2.E14.m2.1.1.1.1.3.3.3.cmml" xref="S2.E14.m2.1.1.1.1.3.3.3"><times id="S2.E14.m2.1.1.1.1.3.3.3.1.cmml" xref="S2.E14.m2.1.1.1.1.3.3.3.1"></times><ci id="S2.E14.m2.1.1.1.1.3.3.3.2.cmml" xref="S2.E14.m2.1.1.1.1.3.3.3.2">ğ‘</ci><ci id="S2.E14.m2.1.1.1.1.3.3.3.3.cmml" xref="S2.E14.m2.1.1.1.1.3.3.3.3">ğ‘</ci></apply></apply><apply id="S2.E14.m2.1.1.1.1.3.4.cmml" xref="S2.E14.m2.1.1.1.1.3.4"><times id="S2.E14.m2.1.1.1.1.3.4.1.cmml" xref="S2.E14.m2.1.1.1.1.3.4.1"></times><apply id="S2.E14.m2.1.1.1.1.3.4.2.cmml" xref="S2.E14.m2.1.1.1.1.3.4.2"><csymbol cd="ambiguous" id="S2.E14.m2.1.1.1.1.3.4.2.1.cmml" xref="S2.E14.m2.1.1.1.1.3.4.2">superscript</csymbol><ci id="S2.E14.m2.1.1.1.1.3.4.2.2.cmml" xref="S2.E14.m2.1.1.1.1.3.4.2.2">ğ›½</ci><apply id="S2.E14.m2.1.1.1.1.3.4.2.3.cmml" xref="S2.E14.m2.1.1.1.1.3.4.2.3"><times id="S2.E14.m2.1.1.1.1.3.4.2.3.1.cmml" xref="S2.E14.m2.1.1.1.1.3.4.2.3.1"></times><ci id="S2.E14.m2.1.1.1.1.3.4.2.3.2.cmml" xref="S2.E14.m2.1.1.1.1.3.4.2.3.2">ğ‘ˆ</ci><ci id="S2.E14.m2.1.1.1.1.3.4.2.3.3.cmml" xref="S2.E14.m2.1.1.1.1.3.4.2.3.3">ğ‘ </ci><ci id="S2.E14.m2.1.1.1.1.3.4.2.3.4.cmml" xref="S2.E14.m2.1.1.1.1.3.4.2.3.4">ğ‘’</ci><ci id="S2.E14.m2.1.1.1.1.3.4.2.3.5.cmml" xref="S2.E14.m2.1.1.1.1.3.4.2.3.5">ğ‘Ÿ</ci></apply></apply><apply id="S2.E14.m2.1.1.1.1.3.4.3.cmml" xref="S2.E14.m2.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S2.E14.m2.1.1.1.1.3.4.3.1.cmml" xref="S2.E14.m2.1.1.1.1.3.4.3">subscript</csymbol><apply id="S2.E14.m2.1.1.1.1.3.4.3.2.cmml" xref="S2.E14.m2.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S2.E14.m2.1.1.1.1.3.4.3.2.1.cmml" xref="S2.E14.m2.1.1.1.1.3.4.3">superscript</csymbol><ci id="S2.E14.m2.1.1.1.1.3.4.3.2.2.cmml" xref="S2.E14.m2.1.1.1.1.3.4.3.2.2">â„’</ci><apply id="S2.E14.m2.1.1.1.1.3.4.3.2.3.cmml" xref="S2.E14.m2.1.1.1.1.3.4.3.2.3"><times id="S2.E14.m2.1.1.1.1.3.4.3.2.3.1.cmml" xref="S2.E14.m2.1.1.1.1.3.4.3.2.3.1"></times><ci id="S2.E14.m2.1.1.1.1.3.4.3.2.3.2.cmml" xref="S2.E14.m2.1.1.1.1.3.4.3.2.3.2">ğ‘ˆ</ci><ci id="S2.E14.m2.1.1.1.1.3.4.3.2.3.3.cmml" xref="S2.E14.m2.1.1.1.1.3.4.3.2.3.3">ğ‘ </ci><ci id="S2.E14.m2.1.1.1.1.3.4.3.2.3.4.cmml" xref="S2.E14.m2.1.1.1.1.3.4.3.2.3.4">ğ‘’</ci><ci id="S2.E14.m2.1.1.1.1.3.4.3.2.3.5.cmml" xref="S2.E14.m2.1.1.1.1.3.4.3.2.3.5">ğ‘Ÿ</ci></apply></apply><apply id="S2.E14.m2.1.1.1.1.3.4.3.3.cmml" xref="S2.E14.m2.1.1.1.1.3.4.3.3"><times id="S2.E14.m2.1.1.1.1.3.4.3.3.1.cmml" xref="S2.E14.m2.1.1.1.1.3.4.3.3.1"></times><ci id="S2.E14.m2.1.1.1.1.3.4.3.3.2.cmml" xref="S2.E14.m2.1.1.1.1.3.4.3.3.2">ğ‘</ci><ci id="S2.E14.m2.1.1.1.1.3.4.3.3.3.cmml" xref="S2.E14.m2.1.1.1.1.3.4.3.3.3">ğ‘š</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E14.m2.1c">\displaystyle=\mathcal{L}^{User}_{recon}+\mathcal{L}^{User}_{cb}+\beta^{User}%
\times\mathcal{L}^{User}_{cm}.</annotation><annotation encoding="application/x-llamapun" id="S2.E14.m2.1d">= caligraphic_L start_POSTSUPERSCRIPT italic_U italic_s italic_e italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r italic_e italic_c italic_o italic_n end_POSTSUBSCRIPT + caligraphic_L start_POSTSUPERSCRIPT italic_U italic_s italic_e italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c italic_b end_POSTSUBSCRIPT + italic_Î² start_POSTSUPERSCRIPT italic_U italic_s italic_e italic_r end_POSTSUPERSCRIPT Ã— caligraphic_L start_POSTSUPERSCRIPT italic_U italic_s italic_e italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c italic_m end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS4.4.1.1">II-D</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS4.5.2">Generative Retrieval for Recommendations</span>
</h3>
<div class="ltx_para" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.1">In this subsection, we introduce a novel framework that takes advantage of LLMs for recommendations.
Particularly, a generative retrieval paradigm is designed to generate item representations and retrieve appropriate items for collaborative recommendations.
To align large language models with collaborative recommendations, the proposed framework involves three key components to reformulate collaborative filtering: tokenization&amp;prompting, user modeling via LLM, and generative retrieval.</p>
</div>
<section class="ltx_subsubsection" id="S2.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S2.SS4.SSS1.4.1.1">II-D</span>1 </span><span class="ltx_text ltx_font_bold" id="S2.SS4.SSS1.5.2">Tokenization&amp;Prompts</span>
</h4>
<div class="ltx_para" id="S2.SS4.SSS1.p1">
<p class="ltx_p" id="S2.SS4.SSS1.p1.3">Tokenization is the most crucial process of splitting the textual input and output into smaller units that language models can process.
In general, LLMs have thousands of tokens in their vocabularies (i.e., <em class="ltx_emph ltx_font_italic" id="S2.SS4.SSS1.p1.3.1">in-vocabulary words</em>).
For instance, a representative LLM, LLaMAÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib23" title="">23</a>]</cite>, has a vocabulary size of 32,000.
Nonetheless, the number of tokens in LLMs remains relatively small compared to the enormous number of users and items in real-world recommendation scenarios, often reaching millions or billions.
Therefore, we introduce <em class="ltx_emph ltx_font_italic" id="S2.SS4.SSS1.p1.3.2">out-of-vocabulary tokens</em> learned from the proposed <em class="ltx_emph ltx_font_italic" id="S2.SS4.SSS1.p1.3.3">user and item MQ-Tokenizers</em> to facilitate the tokenization of user and item IDs.
Using the MQ-Tokenizers, only a limited number of <math alttext="K\times L" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.1.m1.1"><semantics id="S2.SS4.SSS1.p1.1.m1.1a"><mrow id="S2.SS4.SSS1.p1.1.m1.1.1" xref="S2.SS4.SSS1.p1.1.m1.1.1.cmml"><mi id="S2.SS4.SSS1.p1.1.m1.1.1.2" xref="S2.SS4.SSS1.p1.1.m1.1.1.2.cmml">K</mi><mo id="S2.SS4.SSS1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS4.SSS1.p1.1.m1.1.1.1.cmml">Ã—</mo><mi id="S2.SS4.SSS1.p1.1.m1.1.1.3" xref="S2.SS4.SSS1.p1.1.m1.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.1.m1.1b"><apply id="S2.SS4.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS4.SSS1.p1.1.m1.1.1"><times id="S2.SS4.SSS1.p1.1.m1.1.1.1.cmml" xref="S2.SS4.SSS1.p1.1.m1.1.1.1"></times><ci id="S2.SS4.SSS1.p1.1.m1.1.1.2.cmml" xref="S2.SS4.SSS1.p1.1.m1.1.1.2">ğ¾</ci><ci id="S2.SS4.SSS1.p1.1.m1.1.1.3.cmml" xref="S2.SS4.SSS1.p1.1.m1.1.1.3">ğ¿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.1.m1.1c">K\times L</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.1.m1.1d">italic_K Ã— italic_L</annotation></semantics></math> out-of-vocabulary (OOV) tokens are required to tokenize millions or billions of users or items effectively.
For example, in our experiments (see SectionÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3" title="III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">III</span></a>), we can use only 1,536 (i.e., 3 <math alttext="\times" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.2.m2.1"><semantics id="S2.SS4.SSS1.p1.2.m2.1a"><mo id="S2.SS4.SSS1.p1.2.m2.1.1" xref="S2.SS4.SSS1.p1.2.m2.1.1.cmml">Ã—</mo><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.2.m2.1b"><times id="S2.SS4.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS4.SSS1.p1.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.2.m2.1d">Ã—</annotation></semantics></math> 512) OOV tokens to tokenize a total of 39,387 items in the Amazon-Clothing dataset.
The vocabulary expansion for tokenizing users and items by MQ-Tokenizers is much more efficient and affordable for LLM-based recommendations.
In other words, textual contents are tokenized by the LLM tokenizer (e.g., SentencePiece), while user and item IDs are tokenized into <math alttext="K" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.3.m3.1"><semantics id="S2.SS4.SSS1.p1.3.m3.1a"><mi id="S2.SS4.SSS1.p1.3.m3.1.1" xref="S2.SS4.SSS1.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.3.m3.1b"><ci id="S2.SS4.SSS1.p1.3.m3.1.1.cmml" xref="S2.SS4.SSS1.p1.3.m3.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.3.m3.1d">italic_K</annotation></semantics></math> discrete OOV tokens via the corresponding MQ-Tokenizers, respectively.</p>
</div>
<div class="ltx_para" id="S2.SS4.SSS1.p2">
<p class="ltx_p" id="S2.SS4.SSS1.p2.1">To further enhance the capabilities of LLMs, prompting has been developed to provide explicit guidance to LLMs, enabling them to make better predictions for downstream tasksÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib2" title="">2</a>]</cite>.
Building upon this insight, we design several prompts instructing the LLM backbone to understand usersâ€™ preferences for making recommendations.
In these prompts, the ID tokens provided by the well-established MQ-Tokenizers are used to represent users and items in the language space of LLM-based recommender systems.
For example, given the sub-codebook number <math alttext="K=3" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p2.1.m1.1"><semantics id="S2.SS4.SSS1.p2.1.m1.1a"><mrow id="S2.SS4.SSS1.p2.1.m1.1.1" xref="S2.SS4.SSS1.p2.1.m1.1.1.cmml"><mi id="S2.SS4.SSS1.p2.1.m1.1.1.2" xref="S2.SS4.SSS1.p2.1.m1.1.1.2.cmml">K</mi><mo id="S2.SS4.SSS1.p2.1.m1.1.1.1" xref="S2.SS4.SSS1.p2.1.m1.1.1.1.cmml">=</mo><mn id="S2.SS4.SSS1.p2.1.m1.1.1.3" xref="S2.SS4.SSS1.p2.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p2.1.m1.1b"><apply id="S2.SS4.SSS1.p2.1.m1.1.1.cmml" xref="S2.SS4.SSS1.p2.1.m1.1.1"><eq id="S2.SS4.SSS1.p2.1.m1.1.1.1.cmml" xref="S2.SS4.SSS1.p2.1.m1.1.1.1"></eq><ci id="S2.SS4.SSS1.p2.1.m1.1.1.2.cmml" xref="S2.SS4.SSS1.p2.1.m1.1.1.2">ğ¾</ci><cn id="S2.SS4.SSS1.p2.1.m1.1.1.3.cmml" type="integer" xref="S2.SS4.SSS1.p2.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p2.1.m1.1c">K=3</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p2.1.m1.1d">italic_K = 3</annotation></semantics></math>, two representative prompts in our method and their user&amp;item tokenizations are defined as follows:</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS4.SSS1.p3">
<svg class="ltx_picture" height="110.68" id="S2.SS4.SSS1.p3.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,110.68) matrix(1 0 0 -1 0 0)"><g fill="#404040" fill-opacity="1.0"><path d="M 0 5.91 L 0 104.77 C 0 108.04 2.64 110.68 5.91 110.68 L 594.09 110.68 C 597.36 110.68 600 108.04 600 104.77 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 104.77 C 1.97 106.95 3.73 108.71 5.91 108.71 L 594.09 108.71 C 596.27 108.71 598.03 106.95 598.03 104.77 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g color="#404040" fill="#404040" stroke="#404040" stroke-dasharray="2.84528pt,2.84528pt" stroke-dashoffset="1.42264pt" stroke-opacity="1.0"><path d="M 1.97 56.03 L 598.03 56.03" style="fill:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 67.84)"><foreignobject color="#000000" height="29.06" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S2.SS4.SSS1.p3.pic1.3.3.3.1.1" style="width:402.3pt;">
<span class="ltx_p" id="S2.SS4.SSS1.p3.pic1.3.3.3.1.1.1">Prompt 1 (without userâ€™s historical interactions):</span>
<span class="ltx_p" id="S2.SS4.SSS1.p3.pic1.3.3.3.1.1.2">I wonder what the <span class="ltx_text ltx_font_bold" id="S2.SS4.SSS1.p3.pic1.3.3.3.1.1.2.1" style="background-color:#B3FFFF;">user_03</span> will like. Can you help me decide?</span>
</span></foreignobject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="30.44" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2" style="width:402.3pt;">
<span class="ltx_p" id="S2.SS4.SSS1.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="\Longrightarrow" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.SS4.SSS1.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S2.SS4.SSS1.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" stretchy="false" xref="S2.SS4.SSS1.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">âŸ¹</mo><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S2.SS4.SSS1.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.SS4.SSS1.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">âŸ¹</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\Longrightarrow</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">âŸ¹</annotation></semantics></math> I wonder what the</span>
<span class="ltx_p" id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2"><math alttext="user\_\left\langle u1\text{-}128\right\rangle\left\langle u2\text{-}21\right%
\rangle\left\langle u3\text{-}35\right\rangle" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3" style="background-color:#B3FFFF;"><semantics id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3a"><mrow id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.cmml"><mi id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.5" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.5.cmml">u</mi><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4.cmml">â¢</mo><mi id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.6" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.6.cmml">s</mi><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4a" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4.cmml">â¢</mo><mi id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.7" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.7.cmml">e</mi><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4b" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4.cmml">â¢</mo><mi id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.8" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.8.cmml">r</mi><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4c" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4.cmml">â¢</mo><mi id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.9" mathbackground="#B3FFFF" mathvariant="normal" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.9.cmml">_</mi><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4d" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4.cmml">â¢</mo><mrow id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.2.cmml"><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.2" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.2.1.cmml">âŸ¨</mo><mrow id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.cmml"><mi id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.2" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.2.cmml">u</mi><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.1" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.3" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.3.cmml">1</mn><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.1a" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.1.cmml">â¢</mo><mtext id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.4" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.4a.cmml">-</mtext><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.1b" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.5" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.5.cmml">128</mn></mrow><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.3" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.2.1.cmml">âŸ©</mo></mrow><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4e" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4.cmml">â¢</mo><mrow id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.2.cmml"><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.2" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.2.1.cmml">âŸ¨</mo><mrow id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.cmml"><mi id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.2" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.2.cmml">u</mi><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.1" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.3" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.3.cmml">2</mn><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.1a" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.1.cmml">â¢</mo><mtext id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.4" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.4a.cmml">-</mtext><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.1b" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.5" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.5.cmml">21</mn></mrow><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.3" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.2.1.cmml">âŸ©</mo></mrow><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4f" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4.cmml">â¢</mo><mrow id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.2.cmml"><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.2" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.2.1.cmml">âŸ¨</mo><mrow id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.cmml"><mi id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.2" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.2.cmml">u</mi><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.1" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.3" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.3.cmml">3</mn><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.1a" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.1.cmml">â¢</mo><mtext id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.4" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.4a.cmml">-</mtext><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.1b" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.5" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.5.cmml">35</mn></mrow><mo id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.3" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.2.1.cmml">âŸ©</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3b"><apply id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3"><times id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4"></times><ci id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.5.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.5">ğ‘¢</ci><ci id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.6.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.6">ğ‘ </ci><ci id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.7.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.7">ğ‘’</ci><ci id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.8.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.8">ğ‘Ÿ</ci><ci id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.9.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.9">_</ci><apply id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.2.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.2.1.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.2">delimited-âŸ¨âŸ©</csymbol><apply id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1"><times id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.1.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.1"></times><ci id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.2.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.2">ğ‘¢</ci><cn id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.3">1</cn><ci id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.4a.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.4"><mtext id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.4.cmml" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.4">-</mtext></ci><cn id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.5.cmml" type="integer" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.5">128</cn></apply></apply><apply id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.2.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1"><csymbol cd="latexml" id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.2.1.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.2">delimited-âŸ¨âŸ©</csymbol><apply id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1"><times id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.1.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.1"></times><ci id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.2.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.2">ğ‘¢</ci><cn id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.3.cmml" type="integer" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.3">2</cn><ci id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.4a.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.4"><mtext id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.4.cmml" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.4">-</mtext></ci><cn id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.5.cmml" type="integer" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.5">21</cn></apply></apply><apply id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.2.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1"><csymbol cd="latexml" id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.2.1.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.2">delimited-âŸ¨âŸ©</csymbol><apply id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1"><times id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.1.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.1"></times><ci id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.2.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.2">ğ‘¢</ci><cn id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.3.cmml" type="integer" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.3">3</cn><ci id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.4a.cmml" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.4"><mtext id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.4.cmml" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.4">-</mtext></ci><cn id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.5.cmml" type="integer" xref="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.5">35</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3c">user\_\left\langle u1\text{-}128\right\rangle\left\langle u2\text{-}21\right%
\rangle\left\langle u3\text{-}35\right\rangle</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3d">italic_u italic_s italic_e italic_r _ âŸ¨ italic_u 1 - 128 âŸ© âŸ¨ italic_u 2 - 21 âŸ© âŸ¨ italic_u 3 - 35 âŸ©</annotation></semantics></math></span>
<span class="ltx_p" id="S2.SS4.SSS1.p3.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.3">will like. Can you help me decide?</span>
</span></foreignobject></g></g></svg>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS4.SSS1.p4">
<svg class="ltx_picture" height="139.51" id="S2.SS4.SSS1.p4.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,139.51) matrix(1 0 0 -1 0 0)"><g fill="#404040" fill-opacity="1.0"><path d="M 0 5.91 L 0 133.6 C 0 136.86 2.64 139.51 5.91 139.51 L 594.09 139.51 C 597.36 139.51 600 136.86 600 133.6 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 133.6 C 1.97 135.78 3.73 137.54 5.91 137.54 L 594.09 137.54 C 596.27 137.54 598.03 135.78 598.03 133.6 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g color="#404040" fill="#404040" stroke="#404040" stroke-dasharray="2.84528pt,2.84528pt" stroke-dashoffset="1.42264pt" stroke-opacity="1.0"><path d="M 1.97 68.41 L 598.03 68.41" style="fill:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 80.22)"><foreignobject color="#000000" height="45.51" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S2.SS4.SSS1.p4.pic1.6.6.6.1.1" style="width:402.3pt;">
<span class="ltx_p" id="S2.SS4.SSS1.p4.pic1.6.6.6.1.1.1">Prompt 2 (with userâ€™s historical interactions):</span>
<span class="ltx_p" id="S2.SS4.SSS1.p4.pic1.6.6.6.1.1.2">According to what items the <span class="ltx_text ltx_font_bold" id="S2.SS4.SSS1.p4.pic1.6.6.6.1.1.2.1" style="background-color:#B3FFFF;">user_03</span> has interacted with: <span class="ltx_text ltx_font_bold" id="S2.SS4.SSS1.p4.pic1.6.6.6.1.1.2.2" style="background-color:#FFB3B3;">item_08</span>, <span class="ltx_text ltx_font_bold" id="S2.SS4.SSS1.p4.pic1.6.6.6.1.1.2.3" style="background-color:#FFB3B3;">item_24</span>, <span class="ltx_text ltx_font_bold" id="S2.SS4.SSS1.p4.pic1.6.6.6.1.1.2.4" style="background-color:#FFB3B3;">item_63</span>. Can you describe the userâ€™s preferences?</span>
</span></foreignobject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="42.82" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5" style="width:402.3pt;">
<span class="ltx_p" id="S2.SS4.SSS1.p4.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="\Longrightarrow" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p4.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.SS4.SSS1.p4.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S2.SS4.SSS1.p4.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" stretchy="false" xref="S2.SS4.SSS1.p4.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">âŸ¹</mo><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p4.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S2.SS4.SSS1.p4.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">âŸ¹</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p4.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\Longrightarrow</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p4.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">âŸ¹</annotation></semantics></math> According to what items the</span>
<span class="ltx_p" id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2"><math alttext="user\_\left\langle u1\text{-}128\right\rangle\left\langle u2\text{-}21\right%
\rangle\left\langle u3\text{-}35\right\rangle" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3" style="background-color:#B3FFFF;"><semantics id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3a"><mrow id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.cmml"><mi id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.5" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.5.cmml">u</mi><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4.cmml">â¢</mo><mi id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.6" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.6.cmml">s</mi><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4a" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4.cmml">â¢</mo><mi id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.7" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.7.cmml">e</mi><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4b" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4.cmml">â¢</mo><mi id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.8" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.8.cmml">r</mi><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4c" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4.cmml">â¢</mo><mi id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.9" mathbackground="#B3FFFF" mathvariant="normal" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.9.cmml">_</mi><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4d" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4.cmml">â¢</mo><mrow id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.2.cmml"><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.2" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.2.1.cmml">âŸ¨</mo><mrow id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.cmml"><mi id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.2" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.2.cmml">u</mi><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.1" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.3" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.3.cmml">1</mn><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.1a" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.1.cmml">â¢</mo><mtext id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.4" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.4a.cmml">-</mtext><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.1b" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.5" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.5.cmml">128</mn></mrow><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.3" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.2.1.cmml">âŸ©</mo></mrow><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4e" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4.cmml">â¢</mo><mrow id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.2.cmml"><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.2" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.2.1.cmml">âŸ¨</mo><mrow id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.cmml"><mi id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.2" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.2.cmml">u</mi><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.1" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.3" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.3.cmml">2</mn><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.1a" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.1.cmml">â¢</mo><mtext id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.4" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.4a.cmml">-</mtext><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.1b" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.5" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.5.cmml">21</mn></mrow><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.3" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.2.1.cmml">âŸ©</mo></mrow><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4f" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4.cmml">â¢</mo><mrow id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.2.cmml"><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.2" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.2.1.cmml">âŸ¨</mo><mrow id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.cmml"><mi id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.2" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.2.cmml">u</mi><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.1" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.3" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.3.cmml">3</mn><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.1a" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.1.cmml">â¢</mo><mtext id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.4" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.4a.cmml">-</mtext><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.1b" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.5" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.5.cmml">35</mn></mrow><mo id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.3" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.2.1.cmml">âŸ©</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3b"><apply id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3"><times id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.4"></times><ci id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.5.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.5">ğ‘¢</ci><ci id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.6.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.6">ğ‘ </ci><ci id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.7.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.7">ğ‘’</ci><ci id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.8.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.8">ğ‘Ÿ</ci><ci id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.9.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.9">_</ci><apply id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.2.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.2.1.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.2">delimited-âŸ¨âŸ©</csymbol><apply id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1"><times id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.1"></times><ci id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.2.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.2">ğ‘¢</ci><cn id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.3">1</cn><ci id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.4a.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.4"><mtext id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.4.cmml" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.4">-</mtext></ci><cn id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.5.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.1.1.1.5">128</cn></apply></apply><apply id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.2.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1"><csymbol cd="latexml" id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.2.1.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.2">delimited-âŸ¨âŸ©</csymbol><apply id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1"><times id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.1"></times><ci id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.2.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.2">ğ‘¢</ci><cn id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.3.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.3">2</cn><ci id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.4a.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.4"><mtext id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.4.cmml" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.4">-</mtext></ci><cn id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.5.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.2.2.2.1.1.5">21</cn></apply></apply><apply id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.2.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1"><csymbol cd="latexml" id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.2.1.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.2">delimited-âŸ¨âŸ©</csymbol><apply id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1"><times id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.1"></times><ci id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.2.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.2">ğ‘¢</ci><cn id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.3.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.3">3</cn><ci id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.4a.cmml" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.4"><mtext id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.4.cmml" mathbackground="#B3FFFF" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.4">-</mtext></ci><cn id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.5.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3.3.3.1.1.5">35</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3c">user\_\left\langle u1\text{-}128\right\rangle\left\langle u2\text{-}21\right%
\rangle\left\langle u3\text{-}35\right\rangle</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p4.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.3d">italic_u italic_s italic_e italic_r _ âŸ¨ italic_u 1 - 128 âŸ© âŸ¨ italic_u 2 - 21 âŸ© âŸ¨ italic_u 3 - 35 âŸ©</annotation></semantics></math></span>
<span class="ltx_p" id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.6">has interacted with:</span>
<span class="ltx_p" id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3"><math alttext="item\_\left\langle v1\text{-}42\right\rangle\left\langle v2\text{-}12\right%
\rangle\left\langle v3\text{-}98\right\rangle" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3" style="background-color:#FFB3B3;"><semantics id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3a"><mrow id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.cmml"><mi id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.5" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.5.cmml">i</mi><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.4" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.4.cmml">â¢</mo><mi id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.6" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.6.cmml">t</mi><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.4a" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.4.cmml">â¢</mo><mi id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.7" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.7.cmml">e</mi><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.4b" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.4.cmml">â¢</mo><mi id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.8" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.8.cmml">m</mi><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.4c" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.4.cmml">â¢</mo><mi id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.9" mathbackground="#FFB3B3" mathvariant="normal" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.9.cmml">_</mi><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.4d" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.4.cmml">â¢</mo><mrow id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.2.cmml"><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.2" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.2.1.cmml">âŸ¨</mo><mrow id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.cmml"><mi id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.2" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.2.cmml">v</mi><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.1" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.3" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.3.cmml">1</mn><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.1a" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.1.cmml">â¢</mo><mtext id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.4" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.4a.cmml">-</mtext><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.1b" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.5" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.5.cmml">42</mn></mrow><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.3" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.2.1.cmml">âŸ©</mo></mrow><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.4e" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.4.cmml">â¢</mo><mrow id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.2.cmml"><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.2" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.2.1.cmml">âŸ¨</mo><mrow id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.cmml"><mi id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.2" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.2.cmml">v</mi><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.1" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.3" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.3.cmml">2</mn><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.1a" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.1.cmml">â¢</mo><mtext id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.4" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.4a.cmml">-</mtext><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.1b" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.5" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.5.cmml">12</mn></mrow><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.3" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.2.1.cmml">âŸ©</mo></mrow><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.4f" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.4.cmml">â¢</mo><mrow id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.2.cmml"><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.2" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.2.1.cmml">âŸ¨</mo><mrow id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.cmml"><mi id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.2" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.2.cmml">v</mi><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.1" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.3" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.3.cmml">3</mn><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.1a" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.1.cmml">â¢</mo><mtext id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.4" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.4a.cmml">-</mtext><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.1b" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.5" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.5.cmml">98</mn></mrow><mo id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.3" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.2.1.cmml">âŸ©</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3b"><apply id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3"><times id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.4.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.4"></times><ci id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.5.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.5">ğ‘–</ci><ci id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.6.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.6">ğ‘¡</ci><ci id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.7.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.7">ğ‘’</ci><ci id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.8.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.8">ğ‘š</ci><ci id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.9.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.9">_</ci><apply id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.2.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.2.1.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.2">delimited-âŸ¨âŸ©</csymbol><apply id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1"><times id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.1"></times><ci id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.2.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.2">ğ‘£</ci><cn id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.3">1</cn><ci id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.4a.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.4"><mtext id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.4.cmml" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.4">-</mtext></ci><cn id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.5.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.1.1.1.5">42</cn></apply></apply><apply id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.2.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1"><csymbol cd="latexml" id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.2.1.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.2">delimited-âŸ¨âŸ©</csymbol><apply id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1"><times id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.1"></times><ci id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.2.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.2">ğ‘£</ci><cn id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.3.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.3">2</cn><ci id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.4a.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.4"><mtext id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.4.cmml" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.4">-</mtext></ci><cn id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.5.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.2.2.2.1.1.5">12</cn></apply></apply><apply id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.2.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1"><csymbol cd="latexml" id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.2.1.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.2">delimited-âŸ¨âŸ©</csymbol><apply id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1"><times id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.1"></times><ci id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.2.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.2">ğ‘£</ci><cn id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.3.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.3">3</cn><ci id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.4a.cmml" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.4"><mtext id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.4.cmml" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.4">-</mtext></ci><cn id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.5.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3.3.3.1.1.5">98</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3c">item\_\left\langle v1\text{-}42\right\rangle\left\langle v2\text{-}12\right%
\rangle\left\langle v3\text{-}98\right\rangle</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p4.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.3d">italic_i italic_t italic_e italic_m _ âŸ¨ italic_v 1 - 42 âŸ© âŸ¨ italic_v 2 - 12 âŸ© âŸ¨ italic_v 3 - 98 âŸ©</annotation></semantics></math></span>
<span class="ltx_p" id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5">,
<span class="ltx_text" id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1"><math alttext="item\_\left\langle v1\text{-}42\right\rangle\left\langle v2\text{-}12\right%
\rangle\left\langle v3\text{-}87\right\rangle" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3" style="background-color:#FFB3B3;"><semantics id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3a"><mrow id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.cmml"><mi id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.5" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.5.cmml">i</mi><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.4" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.4.cmml">â¢</mo><mi id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.6" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.6.cmml">t</mi><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.4a" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.4.cmml">â¢</mo><mi id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.7" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.7.cmml">e</mi><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.4b" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.4.cmml">â¢</mo><mi id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.8" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.8.cmml">m</mi><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.4c" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.4.cmml">â¢</mo><mi id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.9" mathbackground="#FFB3B3" mathvariant="normal" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.9.cmml">_</mi><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.4d" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.4.cmml">â¢</mo><mrow id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.2.cmml"><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.2" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.2.1.cmml">âŸ¨</mo><mrow id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.2" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.2.cmml">v</mi><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.1" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.3" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.3.cmml">1</mn><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.1a" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.1.cmml">â¢</mo><mtext id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.4" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.4a.cmml">-</mtext><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.1b" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.5" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.5.cmml">42</mn></mrow><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.3" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.2.1.cmml">âŸ©</mo></mrow><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.4e" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.4.cmml">â¢</mo><mrow id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.2.cmml"><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.2" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.2.1.cmml">âŸ¨</mo><mrow id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.cmml"><mi id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.2" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.2.cmml">v</mi><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.1" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.3" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.3.cmml">2</mn><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.1a" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.1.cmml">â¢</mo><mtext id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.4" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.4a.cmml">-</mtext><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.1b" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.5" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.5.cmml">12</mn></mrow><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.3" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.2.1.cmml">âŸ©</mo></mrow><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.4f" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.4.cmml">â¢</mo><mrow id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.2.cmml"><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.2" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.2.1.cmml">âŸ¨</mo><mrow id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.cmml"><mi id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.2" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.2.cmml">v</mi><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.1" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.3" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.3.cmml">3</mn><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.1a" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.1.cmml">â¢</mo><mtext id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.4" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.4a.cmml">-</mtext><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.1b" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.5" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.5.cmml">87</mn></mrow><mo id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.3" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.2.1.cmml">âŸ©</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3b"><apply id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3"><times id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.4.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.4"></times><ci id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.5.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.5">ğ‘–</ci><ci id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.6.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.6">ğ‘¡</ci><ci id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.7.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.7">ğ‘’</ci><ci id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.8.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.8">ğ‘š</ci><ci id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.9.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.9">_</ci><apply id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.2.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.2.1.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.2">delimited-âŸ¨âŸ©</csymbol><apply id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1"><times id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.1"></times><ci id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.2">ğ‘£</ci><cn id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.3">1</cn><ci id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.4a.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.4"><mtext id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.4.cmml" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.4">-</mtext></ci><cn id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.5.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.1.1.1.5">42</cn></apply></apply><apply id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.2.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1"><csymbol cd="latexml" id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.2.1.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.2">delimited-âŸ¨âŸ©</csymbol><apply id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1"><times id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.1"></times><ci id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.2.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.2">ğ‘£</ci><cn id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.3.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.3">2</cn><ci id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.4a.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.4"><mtext id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.4.cmml" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.4">-</mtext></ci><cn id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.5.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.2.2.2.1.1.5">12</cn></apply></apply><apply id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.2.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1"><csymbol cd="latexml" id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.2.1.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.2">delimited-âŸ¨âŸ©</csymbol><apply id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1"><times id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.1"></times><ci id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.2.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.2">ğ‘£</ci><cn id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.3.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.3">3</cn><ci id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.4a.cmml" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.4"><mtext id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.4.cmml" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.4">-</mtext></ci><cn id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.5.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3.3.3.1.1.5">87</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3c">item\_\left\langle v1\text{-}42\right\rangle\left\langle v2\text{-}12\right%
\rangle\left\langle v3\text{-}87\right\rangle</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p4.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.3d">italic_i italic_t italic_e italic_m _ âŸ¨ italic_v 1 - 42 âŸ© âŸ¨ italic_v 2 - 12 âŸ© âŸ¨ italic_v 3 - 87 âŸ©</annotation></semantics></math></span>,
<span class="ltx_text" id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2"><math alttext="item\_\left\langle v1\text{-}42\right\rangle\left\langle v2\text{-}53\right%
\rangle\left\langle v3\text{-}128\right\rangle" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3" style="background-color:#FFB3B3;"><semantics id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3a"><mrow id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.cmml"><mi id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.5" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.5.cmml">i</mi><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.4" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.4.cmml">â¢</mo><mi id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.6" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.6.cmml">t</mi><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.4a" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.4.cmml">â¢</mo><mi id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.7" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.7.cmml">e</mi><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.4b" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.4.cmml">â¢</mo><mi id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.8" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.8.cmml">m</mi><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.4c" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.4.cmml">â¢</mo><mi id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.9" mathbackground="#FFB3B3" mathvariant="normal" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.9.cmml">_</mi><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.4d" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.4.cmml">â¢</mo><mrow id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.2.cmml"><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.2" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.2.1.cmml">âŸ¨</mo><mrow id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.cmml"><mi id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.2" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.2.cmml">v</mi><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.1" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.3" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.3.cmml">1</mn><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.1a" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.1.cmml">â¢</mo><mtext id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.4" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.4a.cmml">-</mtext><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.1b" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.5" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.5.cmml">42</mn></mrow><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.3" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.2.1.cmml">âŸ©</mo></mrow><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.4e" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.4.cmml">â¢</mo><mrow id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.2.cmml"><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.2" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.2.1.cmml">âŸ¨</mo><mrow id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.cmml"><mi id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.2" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.2.cmml">v</mi><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.1" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.3" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.3.cmml">2</mn><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.1a" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.1.cmml">â¢</mo><mtext id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.4" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.4a.cmml">-</mtext><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.1b" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.5" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.5.cmml">53</mn></mrow><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.3" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.2.1.cmml">âŸ©</mo></mrow><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.4f" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.4.cmml">â¢</mo><mrow id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.2.cmml"><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.2" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.2.1.cmml">âŸ¨</mo><mrow id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.cmml"><mi id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.2" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.2.cmml">v</mi><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.1" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.3" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.3.cmml">3</mn><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.1a" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.1.cmml">â¢</mo><mtext id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.4" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.4a.cmml">-</mtext><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.1b" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.5" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.5.cmml">128</mn></mrow><mo id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.3" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.2.1.cmml">âŸ©</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3b"><apply id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3"><times id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.4.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.4"></times><ci id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.5.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.5">ğ‘–</ci><ci id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.6.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.6">ğ‘¡</ci><ci id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.7.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.7">ğ‘’</ci><ci id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.8.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.8">ğ‘š</ci><ci id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.9.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.9">_</ci><apply id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.2.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.2.1.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.2">delimited-âŸ¨âŸ©</csymbol><apply id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1"><times id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.1"></times><ci id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.2.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.2">ğ‘£</ci><cn id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.3">1</cn><ci id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.4a.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.4"><mtext id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.4.cmml" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.4">-</mtext></ci><cn id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.5.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.1.1.1.1.1.5">42</cn></apply></apply><apply id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.2.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1"><csymbol cd="latexml" id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.2.1.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.2">delimited-âŸ¨âŸ©</csymbol><apply id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1"><times id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.1"></times><ci id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.2.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.2">ğ‘£</ci><cn id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.3.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.3">2</cn><ci id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.4a.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.4"><mtext id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.4.cmml" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.4">-</mtext></ci><cn id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.5.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.2.2.2.1.1.5">53</cn></apply></apply><apply id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.2.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1"><csymbol cd="latexml" id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.2.1.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.2">delimited-âŸ¨âŸ©</csymbol><apply id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1"><times id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.1.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.1"></times><ci id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.2.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.2">ğ‘£</ci><cn id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.3.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.3">3</cn><ci id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.4a.cmml" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.4"><mtext id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.4.cmml" mathbackground="#FFB3B3" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.4">-</mtext></ci><cn id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.5.cmml" type="integer" xref="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3.3.3.1.1.5">128</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3c">item\_\left\langle v1\text{-}42\right\rangle\left\langle v2\text{-}53\right%
\rangle\left\langle v3\text{-}128\right\rangle</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.m1.3d">italic_i italic_t italic_e italic_m _ âŸ¨ italic_v 1 - 42 âŸ© âŸ¨ italic_v 2 - 53 âŸ© âŸ¨ italic_v 3 - 128 âŸ©</annotation></semantics></math></span>.</span>
<span class="ltx_p" id="S2.SS4.SSS1.p4.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.7">Can you describe the userâ€™s preferences?</span>
</span></foreignobject></g></g></svg>
</div>
<div class="ltx_para" id="S2.SS4.SSS1.p5">
<p class="ltx_p" id="S2.SS4.SSS1.p5.4">Technically, Prompt 1 and Prompt 2 showcase the input prompts without and with item interactions as supporting information, respectively, in which <math alttext="\left\langle uk\text{-}\cdot\right\rangle" class="ltx_math_unparsed" display="inline" id="S2.SS4.SSS1.p5.1.m1.1"><semantics id="S2.SS4.SSS1.p5.1.m1.1a"><mrow id="S2.SS4.SSS1.p5.1.m1.1b"><mo id="S2.SS4.SSS1.p5.1.m1.1.1">âŸ¨</mo><mi id="S2.SS4.SSS1.p5.1.m1.1.2">u</mi><mi id="S2.SS4.SSS1.p5.1.m1.1.3">k</mi><mtext id="S2.SS4.SSS1.p5.1.m1.1.4">-</mtext><mo id="S2.SS4.SSS1.p5.1.m1.1.5" lspace="0.222em" rspace="0em">â‹…</mo><mo id="S2.SS4.SSS1.p5.1.m1.1.6">âŸ©</mo></mrow><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p5.1.m1.1c">\left\langle uk\text{-}\cdot\right\rangle</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p5.1.m1.1d">âŸ¨ italic_u italic_k - â‹… âŸ©</annotation></semantics></math> denotes the out-of-vocabulary (OOV) tokens in the <math alttext="k_{th}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p5.2.m2.1"><semantics id="S2.SS4.SSS1.p5.2.m2.1a"><msub id="S2.SS4.SSS1.p5.2.m2.1.1" xref="S2.SS4.SSS1.p5.2.m2.1.1.cmml"><mi id="S2.SS4.SSS1.p5.2.m2.1.1.2" xref="S2.SS4.SSS1.p5.2.m2.1.1.2.cmml">k</mi><mrow id="S2.SS4.SSS1.p5.2.m2.1.1.3" xref="S2.SS4.SSS1.p5.2.m2.1.1.3.cmml"><mi id="S2.SS4.SSS1.p5.2.m2.1.1.3.2" xref="S2.SS4.SSS1.p5.2.m2.1.1.3.2.cmml">t</mi><mo id="S2.SS4.SSS1.p5.2.m2.1.1.3.1" xref="S2.SS4.SSS1.p5.2.m2.1.1.3.1.cmml">â¢</mo><mi id="S2.SS4.SSS1.p5.2.m2.1.1.3.3" xref="S2.SS4.SSS1.p5.2.m2.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p5.2.m2.1b"><apply id="S2.SS4.SSS1.p5.2.m2.1.1.cmml" xref="S2.SS4.SSS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p5.2.m2.1.1.1.cmml" xref="S2.SS4.SSS1.p5.2.m2.1.1">subscript</csymbol><ci id="S2.SS4.SSS1.p5.2.m2.1.1.2.cmml" xref="S2.SS4.SSS1.p5.2.m2.1.1.2">ğ‘˜</ci><apply id="S2.SS4.SSS1.p5.2.m2.1.1.3.cmml" xref="S2.SS4.SSS1.p5.2.m2.1.1.3"><times id="S2.SS4.SSS1.p5.2.m2.1.1.3.1.cmml" xref="S2.SS4.SSS1.p5.2.m2.1.1.3.1"></times><ci id="S2.SS4.SSS1.p5.2.m2.1.1.3.2.cmml" xref="S2.SS4.SSS1.p5.2.m2.1.1.3.2">ğ‘¡</ci><ci id="S2.SS4.SSS1.p5.2.m2.1.1.3.3.cmml" xref="S2.SS4.SSS1.p5.2.m2.1.1.3.3">â„</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p5.2.m2.1c">k_{th}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p5.2.m2.1d">italic_k start_POSTSUBSCRIPT italic_t italic_h end_POSTSUBSCRIPT</annotation></semantics></math> sub-codebook.
For instance, <math alttext="\left\langle u2\text{-}21\right\rangle" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p5.3.m3.1"><semantics id="S2.SS4.SSS1.p5.3.m3.1a"><mrow id="S2.SS4.SSS1.p5.3.m3.1.1.1" xref="S2.SS4.SSS1.p5.3.m3.1.1.2.cmml"><mo id="S2.SS4.SSS1.p5.3.m3.1.1.1.2" xref="S2.SS4.SSS1.p5.3.m3.1.1.2.1.cmml">âŸ¨</mo><mrow id="S2.SS4.SSS1.p5.3.m3.1.1.1.1" xref="S2.SS4.SSS1.p5.3.m3.1.1.1.1.cmml"><mi id="S2.SS4.SSS1.p5.3.m3.1.1.1.1.2" xref="S2.SS4.SSS1.p5.3.m3.1.1.1.1.2.cmml">u</mi><mo id="S2.SS4.SSS1.p5.3.m3.1.1.1.1.1" xref="S2.SS4.SSS1.p5.3.m3.1.1.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p5.3.m3.1.1.1.1.3" xref="S2.SS4.SSS1.p5.3.m3.1.1.1.1.3.cmml">2</mn><mo id="S2.SS4.SSS1.p5.3.m3.1.1.1.1.1a" xref="S2.SS4.SSS1.p5.3.m3.1.1.1.1.1.cmml">â¢</mo><mtext id="S2.SS4.SSS1.p5.3.m3.1.1.1.1.4" xref="S2.SS4.SSS1.p5.3.m3.1.1.1.1.4a.cmml">-</mtext><mo id="S2.SS4.SSS1.p5.3.m3.1.1.1.1.1b" xref="S2.SS4.SSS1.p5.3.m3.1.1.1.1.1.cmml">â¢</mo><mn id="S2.SS4.SSS1.p5.3.m3.1.1.1.1.5" xref="S2.SS4.SSS1.p5.3.m3.1.1.1.1.5.cmml">21</mn></mrow><mo id="S2.SS4.SSS1.p5.3.m3.1.1.1.3" xref="S2.SS4.SSS1.p5.3.m3.1.1.2.1.cmml">âŸ©</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p5.3.m3.1b"><apply id="S2.SS4.SSS1.p5.3.m3.1.1.2.cmml" xref="S2.SS4.SSS1.p5.3.m3.1.1.1"><csymbol cd="latexml" id="S2.SS4.SSS1.p5.3.m3.1.1.2.1.cmml" xref="S2.SS4.SSS1.p5.3.m3.1.1.1.2">delimited-âŸ¨âŸ©</csymbol><apply id="S2.SS4.SSS1.p5.3.m3.1.1.1.1.cmml" xref="S2.SS4.SSS1.p5.3.m3.1.1.1.1"><times id="S2.SS4.SSS1.p5.3.m3.1.1.1.1.1.cmml" xref="S2.SS4.SSS1.p5.3.m3.1.1.1.1.1"></times><ci id="S2.SS4.SSS1.p5.3.m3.1.1.1.1.2.cmml" xref="S2.SS4.SSS1.p5.3.m3.1.1.1.1.2">ğ‘¢</ci><cn id="S2.SS4.SSS1.p5.3.m3.1.1.1.1.3.cmml" type="integer" xref="S2.SS4.SSS1.p5.3.m3.1.1.1.1.3">2</cn><ci id="S2.SS4.SSS1.p5.3.m3.1.1.1.1.4a.cmml" xref="S2.SS4.SSS1.p5.3.m3.1.1.1.1.4"><mtext id="S2.SS4.SSS1.p5.3.m3.1.1.1.1.4.cmml" xref="S2.SS4.SSS1.p5.3.m3.1.1.1.1.4">-</mtext></ci><cn id="S2.SS4.SSS1.p5.3.m3.1.1.1.1.5.cmml" type="integer" xref="S2.SS4.SSS1.p5.3.m3.1.1.1.1.5">21</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p5.3.m3.1c">\left\langle u2\text{-}21\right\rangle</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p5.3.m3.1d">âŸ¨ italic_u 2 - 21 âŸ©</annotation></semantics></math> represents the <math alttext="21_{st}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p5.4.m4.1"><semantics id="S2.SS4.SSS1.p5.4.m4.1a"><msub id="S2.SS4.SSS1.p5.4.m4.1.1" xref="S2.SS4.SSS1.p5.4.m4.1.1.cmml"><mn id="S2.SS4.SSS1.p5.4.m4.1.1.2" xref="S2.SS4.SSS1.p5.4.m4.1.1.2.cmml">21</mn><mrow id="S2.SS4.SSS1.p5.4.m4.1.1.3" xref="S2.SS4.SSS1.p5.4.m4.1.1.3.cmml"><mi id="S2.SS4.SSS1.p5.4.m4.1.1.3.2" xref="S2.SS4.SSS1.p5.4.m4.1.1.3.2.cmml">s</mi><mo id="S2.SS4.SSS1.p5.4.m4.1.1.3.1" xref="S2.SS4.SSS1.p5.4.m4.1.1.3.1.cmml">â¢</mo><mi id="S2.SS4.SSS1.p5.4.m4.1.1.3.3" xref="S2.SS4.SSS1.p5.4.m4.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p5.4.m4.1b"><apply id="S2.SS4.SSS1.p5.4.m4.1.1.cmml" xref="S2.SS4.SSS1.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p5.4.m4.1.1.1.cmml" xref="S2.SS4.SSS1.p5.4.m4.1.1">subscript</csymbol><cn id="S2.SS4.SSS1.p5.4.m4.1.1.2.cmml" type="integer" xref="S2.SS4.SSS1.p5.4.m4.1.1.2">21</cn><apply id="S2.SS4.SSS1.p5.4.m4.1.1.3.cmml" xref="S2.SS4.SSS1.p5.4.m4.1.1.3"><times id="S2.SS4.SSS1.p5.4.m4.1.1.3.1.cmml" xref="S2.SS4.SSS1.p5.4.m4.1.1.3.1"></times><ci id="S2.SS4.SSS1.p5.4.m4.1.1.3.2.cmml" xref="S2.SS4.SSS1.p5.4.m4.1.1.3.2">ğ‘ </ci><ci id="S2.SS4.SSS1.p5.4.m4.1.1.3.3.cmml" xref="S2.SS4.SSS1.p5.4.m4.1.1.3.3">ğ‘¡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p5.4.m4.1c">21_{st}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p5.4.m4.1d">21 start_POSTSUBSCRIPT italic_s italic_t end_POSTSUBSCRIPT</annotation></semantics></math> token in the second sub-codebook for the <span class="ltx_text ltx_font_bold" id="S2.SS4.SSS1.p5.4.1">user_03</span>.
This also applies to tokenizing items in LLMs.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S2.SS4.SSS2.4.1.1">II-D</span>2 </span><span class="ltx_text ltx_font_bold" id="S2.SS4.SSS2.5.2">User Modeling via LLM</span>
</h4>
<div class="ltx_para" id="S2.SS4.SSS2.p1">
<p class="ltx_p" id="S2.SS4.SSS2.p1.5">The goal of the user modeling component is to capture usersâ€™ preferences for generating the representations of items that user <math alttext="u_{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p1.1.m1.1"><semantics id="S2.SS4.SSS2.p1.1.m1.1a"><msub id="S2.SS4.SSS2.p1.1.m1.1.1" xref="S2.SS4.SSS2.p1.1.m1.1.1.cmml"><mi id="S2.SS4.SSS2.p1.1.m1.1.1.2" xref="S2.SS4.SSS2.p1.1.m1.1.1.2.cmml">u</mi><mi id="S2.SS4.SSS2.p1.1.m1.1.1.3" xref="S2.SS4.SSS2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p1.1.m1.1b"><apply id="S2.SS4.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS4.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.1.m1.1.1.1.cmml" xref="S2.SS4.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p1.1.m1.1.1.2.cmml" xref="S2.SS4.SSS2.p1.1.m1.1.1.2">ğ‘¢</ci><ci id="S2.SS4.SSS2.p1.1.m1.1.1.3.cmml" xref="S2.SS4.SSS2.p1.1.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p1.1.m1.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p1.1.m1.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> may like.
A typical input <math alttext="\mathcal{X}_{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p1.2.m2.1"><semantics id="S2.SS4.SSS2.p1.2.m2.1a"><msub id="S2.SS4.SSS2.p1.2.m2.1.1" xref="S2.SS4.SSS2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS2.p1.2.m2.1.1.2" xref="S2.SS4.SSS2.p1.2.m2.1.1.2.cmml">ğ’³</mi><mi id="S2.SS4.SSS2.p1.2.m2.1.1.3" xref="S2.SS4.SSS2.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p1.2.m2.1b"><apply id="S2.SS4.SSS2.p1.2.m2.1.1.cmml" xref="S2.SS4.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.2.m2.1.1.1.cmml" xref="S2.SS4.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p1.2.m2.1.1.2.cmml" xref="S2.SS4.SSS2.p1.2.m2.1.1.2">ğ’³</ci><ci id="S2.SS4.SSS2.p1.2.m2.1.1.3.cmml" xref="S2.SS4.SSS2.p1.2.m2.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p1.2.m2.1c">\mathcal{X}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p1.2.m2.1d">caligraphic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> of our LLM backbone can be formed by selecting a prompt template <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p1.3.m3.1"><semantics id="S2.SS4.SSS2.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS2.p1.3.m3.1.1" xref="S2.SS4.SSS2.p1.3.m3.1.1.cmml">ğ’«</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p1.3.m3.1b"><ci id="S2.SS4.SSS2.p1.3.m3.1.1.cmml" xref="S2.SS4.SSS2.p1.3.m3.1.1">ğ’«</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p1.3.m3.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p1.3.m3.1d">caligraphic_P</annotation></semantics></math> and the corresponding ID tokens for user <math alttext="u_{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p1.4.m4.1"><semantics id="S2.SS4.SSS2.p1.4.m4.1a"><msub id="S2.SS4.SSS2.p1.4.m4.1.1" xref="S2.SS4.SSS2.p1.4.m4.1.1.cmml"><mi id="S2.SS4.SSS2.p1.4.m4.1.1.2" xref="S2.SS4.SSS2.p1.4.m4.1.1.2.cmml">u</mi><mi id="S2.SS4.SSS2.p1.4.m4.1.1.3" xref="S2.SS4.SSS2.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p1.4.m4.1b"><apply id="S2.SS4.SSS2.p1.4.m4.1.1.cmml" xref="S2.SS4.SSS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.4.m4.1.1.1.cmml" xref="S2.SS4.SSS2.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p1.4.m4.1.1.2.cmml" xref="S2.SS4.SSS2.p1.4.m4.1.1.2">ğ‘¢</ci><ci id="S2.SS4.SSS2.p1.4.m4.1.1.3.cmml" xref="S2.SS4.SSS2.p1.4.m4.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p1.4.m4.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p1.4.m4.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and his/her interacted items <math alttext="\mathcal{N}_{(u_{i})}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p1.5.m5.1"><semantics id="S2.SS4.SSS2.p1.5.m5.1a"><msub id="S2.SS4.SSS2.p1.5.m5.1.2" xref="S2.SS4.SSS2.p1.5.m5.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS2.p1.5.m5.1.2.2" xref="S2.SS4.SSS2.p1.5.m5.1.2.2.cmml">ğ’©</mi><mrow id="S2.SS4.SSS2.p1.5.m5.1.1.1.1" xref="S2.SS4.SSS2.p1.5.m5.1.1.1.1.1.cmml"><mo id="S2.SS4.SSS2.p1.5.m5.1.1.1.1.2" stretchy="false" xref="S2.SS4.SSS2.p1.5.m5.1.1.1.1.1.cmml">(</mo><msub id="S2.SS4.SSS2.p1.5.m5.1.1.1.1.1" xref="S2.SS4.SSS2.p1.5.m5.1.1.1.1.1.cmml"><mi id="S2.SS4.SSS2.p1.5.m5.1.1.1.1.1.2" xref="S2.SS4.SSS2.p1.5.m5.1.1.1.1.1.2.cmml">u</mi><mi id="S2.SS4.SSS2.p1.5.m5.1.1.1.1.1.3" xref="S2.SS4.SSS2.p1.5.m5.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS4.SSS2.p1.5.m5.1.1.1.1.3" stretchy="false" xref="S2.SS4.SSS2.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p1.5.m5.1b"><apply id="S2.SS4.SSS2.p1.5.m5.1.2.cmml" xref="S2.SS4.SSS2.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.5.m5.1.2.1.cmml" xref="S2.SS4.SSS2.p1.5.m5.1.2">subscript</csymbol><ci id="S2.SS4.SSS2.p1.5.m5.1.2.2.cmml" xref="S2.SS4.SSS2.p1.5.m5.1.2.2">ğ’©</ci><apply id="S2.SS4.SSS2.p1.5.m5.1.1.1.1.1.cmml" xref="S2.SS4.SSS2.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.5.m5.1.1.1.1.1.1.cmml" xref="S2.SS4.SSS2.p1.5.m5.1.1.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p1.5.m5.1.1.1.1.1.2.cmml" xref="S2.SS4.SSS2.p1.5.m5.1.1.1.1.1.2">ğ‘¢</ci><ci id="S2.SS4.SSS2.p1.5.m5.1.1.1.1.1.3.cmml" xref="S2.SS4.SSS2.p1.5.m5.1.1.1.1.1.3">ğ‘–</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p1.5.m5.1c">\mathcal{N}_{(u_{i})}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p1.5.m5.1d">caligraphic_N start_POSTSUBSCRIPT ( italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT</annotation></semantics></math> in the history as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx13">
<tbody id="S2.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{X}_{i}\rightarrow(\mathcal{P},\mathcal{T}^{c}_{u_{i}})\ %
or\ (\mathcal{P},\mathcal{T}^{c}_{u_{i}},\{\mathcal{T}^{c}_{v_{j}}|v_{j}\in%
\mathcal{N}_{(u_{i})}\})," class="ltx_Math" display="inline" id="S2.E15.m1.4"><semantics id="S2.E15.m1.4a"><mrow id="S2.E15.m1.4.4.1" xref="S2.E15.m1.4.4.1.1.cmml"><mrow id="S2.E15.m1.4.4.1.1" xref="S2.E15.m1.4.4.1.1.cmml"><msub id="S2.E15.m1.4.4.1.1.5" xref="S2.E15.m1.4.4.1.1.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E15.m1.4.4.1.1.5.2" xref="S2.E15.m1.4.4.1.1.5.2.cmml">ğ’³</mi><mi id="S2.E15.m1.4.4.1.1.5.3" xref="S2.E15.m1.4.4.1.1.5.3.cmml">i</mi></msub><mo id="S2.E15.m1.4.4.1.1.4" stretchy="false" xref="S2.E15.m1.4.4.1.1.4.cmml">â†’</mo><mrow id="S2.E15.m1.4.4.1.1.3" xref="S2.E15.m1.4.4.1.1.3.cmml"><mrow id="S2.E15.m1.4.4.1.1.1.1.1" xref="S2.E15.m1.4.4.1.1.1.1.2.cmml"><mo id="S2.E15.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S2.E15.m1.4.4.1.1.1.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.E15.m1.2.2" xref="S2.E15.m1.2.2.cmml">ğ’«</mi><mo id="S2.E15.m1.4.4.1.1.1.1.1.3" xref="S2.E15.m1.4.4.1.1.1.1.2.cmml">,</mo><msubsup id="S2.E15.m1.4.4.1.1.1.1.1.1" xref="S2.E15.m1.4.4.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E15.m1.4.4.1.1.1.1.1.1.2.2" xref="S2.E15.m1.4.4.1.1.1.1.1.1.2.2.cmml">ğ’¯</mi><msub id="S2.E15.m1.4.4.1.1.1.1.1.1.3" xref="S2.E15.m1.4.4.1.1.1.1.1.1.3.cmml"><mi id="S2.E15.m1.4.4.1.1.1.1.1.1.3.2" xref="S2.E15.m1.4.4.1.1.1.1.1.1.3.2.cmml">u</mi><mi id="S2.E15.m1.4.4.1.1.1.1.1.1.3.3" xref="S2.E15.m1.4.4.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mi id="S2.E15.m1.4.4.1.1.1.1.1.1.2.3" xref="S2.E15.m1.4.4.1.1.1.1.1.1.2.3.cmml">c</mi></msubsup><mo id="S2.E15.m1.4.4.1.1.1.1.1.4" stretchy="false" xref="S2.E15.m1.4.4.1.1.1.1.2.cmml">)</mo></mrow><mo id="S2.E15.m1.4.4.1.1.3.4" lspace="0.500em" xref="S2.E15.m1.4.4.1.1.3.4.cmml">â¢</mo><mi id="S2.E15.m1.4.4.1.1.3.5" xref="S2.E15.m1.4.4.1.1.3.5.cmml">o</mi><mo id="S2.E15.m1.4.4.1.1.3.4a" xref="S2.E15.m1.4.4.1.1.3.4.cmml">â¢</mo><mi id="S2.E15.m1.4.4.1.1.3.6" xref="S2.E15.m1.4.4.1.1.3.6.cmml">r</mi><mo id="S2.E15.m1.4.4.1.1.3.4b" lspace="0.500em" xref="S2.E15.m1.4.4.1.1.3.4.cmml">â¢</mo><mrow id="S2.E15.m1.4.4.1.1.3.3.2" xref="S2.E15.m1.4.4.1.1.3.3.3.cmml"><mo id="S2.E15.m1.4.4.1.1.3.3.2.3" stretchy="false" xref="S2.E15.m1.4.4.1.1.3.3.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.E15.m1.3.3" xref="S2.E15.m1.3.3.cmml">ğ’«</mi><mo id="S2.E15.m1.4.4.1.1.3.3.2.4" xref="S2.E15.m1.4.4.1.1.3.3.3.cmml">,</mo><msubsup id="S2.E15.m1.4.4.1.1.2.2.1.1" xref="S2.E15.m1.4.4.1.1.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E15.m1.4.4.1.1.2.2.1.1.2.2" xref="S2.E15.m1.4.4.1.1.2.2.1.1.2.2.cmml">ğ’¯</mi><msub id="S2.E15.m1.4.4.1.1.2.2.1.1.3" xref="S2.E15.m1.4.4.1.1.2.2.1.1.3.cmml"><mi id="S2.E15.m1.4.4.1.1.2.2.1.1.3.2" xref="S2.E15.m1.4.4.1.1.2.2.1.1.3.2.cmml">u</mi><mi id="S2.E15.m1.4.4.1.1.2.2.1.1.3.3" xref="S2.E15.m1.4.4.1.1.2.2.1.1.3.3.cmml">i</mi></msub><mi id="S2.E15.m1.4.4.1.1.2.2.1.1.2.3" xref="S2.E15.m1.4.4.1.1.2.2.1.1.2.3.cmml">c</mi></msubsup><mo id="S2.E15.m1.4.4.1.1.3.3.2.5" xref="S2.E15.m1.4.4.1.1.3.3.3.cmml">,</mo><mrow id="S2.E15.m1.4.4.1.1.3.3.2.2.2" xref="S2.E15.m1.4.4.1.1.3.3.2.2.3.cmml"><mo id="S2.E15.m1.4.4.1.1.3.3.2.2.2.3" stretchy="false" xref="S2.E15.m1.4.4.1.1.3.3.2.2.3.1.cmml">{</mo><msubsup id="S2.E15.m1.4.4.1.1.3.3.2.2.1.1" xref="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.2.2" xref="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.2.2.cmml">ğ’¯</mi><msub id="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.3" xref="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.3.cmml"><mi id="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.3.2" xref="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.3.2.cmml">v</mi><mi id="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.3.3" xref="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.3.3.cmml">j</mi></msub><mi id="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.2.3" xref="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.2.3.cmml">c</mi></msubsup><mo id="S2.E15.m1.4.4.1.1.3.3.2.2.2.4" lspace="0em" rspace="0em" xref="S2.E15.m1.4.4.1.1.3.3.2.2.3.1.cmml">|</mo><mrow id="S2.E15.m1.4.4.1.1.3.3.2.2.2.2" xref="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.cmml"><msub id="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.2" xref="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.2.cmml"><mi id="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.2.2" xref="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.2.2.cmml">v</mi><mi id="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.2.3" xref="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.1" xref="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.1.cmml">âˆˆ</mo><msub id="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.3" xref="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.3.2" xref="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.3.2.cmml">ğ’©</mi><mrow id="S2.E15.m1.1.1.1.1" xref="S2.E15.m1.1.1.1.1.1.cmml"><mo id="S2.E15.m1.1.1.1.1.2" stretchy="false" xref="S2.E15.m1.1.1.1.1.1.cmml">(</mo><msub id="S2.E15.m1.1.1.1.1.1" xref="S2.E15.m1.1.1.1.1.1.cmml"><mi id="S2.E15.m1.1.1.1.1.1.2" xref="S2.E15.m1.1.1.1.1.1.2.cmml">u</mi><mi id="S2.E15.m1.1.1.1.1.1.3" xref="S2.E15.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E15.m1.1.1.1.1.3" stretchy="false" xref="S2.E15.m1.1.1.1.1.1.cmml">)</mo></mrow></msub></mrow><mo id="S2.E15.m1.4.4.1.1.3.3.2.2.2.5" stretchy="false" xref="S2.E15.m1.4.4.1.1.3.3.2.2.3.1.cmml">}</mo></mrow><mo id="S2.E15.m1.4.4.1.1.3.3.2.6" stretchy="false" xref="S2.E15.m1.4.4.1.1.3.3.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E15.m1.4.4.1.2" xref="S2.E15.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E15.m1.4b"><apply id="S2.E15.m1.4.4.1.1.cmml" xref="S2.E15.m1.4.4.1"><ci id="S2.E15.m1.4.4.1.1.4.cmml" xref="S2.E15.m1.4.4.1.1.4">â†’</ci><apply id="S2.E15.m1.4.4.1.1.5.cmml" xref="S2.E15.m1.4.4.1.1.5"><csymbol cd="ambiguous" id="S2.E15.m1.4.4.1.1.5.1.cmml" xref="S2.E15.m1.4.4.1.1.5">subscript</csymbol><ci id="S2.E15.m1.4.4.1.1.5.2.cmml" xref="S2.E15.m1.4.4.1.1.5.2">ğ’³</ci><ci id="S2.E15.m1.4.4.1.1.5.3.cmml" xref="S2.E15.m1.4.4.1.1.5.3">ğ‘–</ci></apply><apply id="S2.E15.m1.4.4.1.1.3.cmml" xref="S2.E15.m1.4.4.1.1.3"><times id="S2.E15.m1.4.4.1.1.3.4.cmml" xref="S2.E15.m1.4.4.1.1.3.4"></times><interval closure="open" id="S2.E15.m1.4.4.1.1.1.1.2.cmml" xref="S2.E15.m1.4.4.1.1.1.1.1"><ci id="S2.E15.m1.2.2.cmml" xref="S2.E15.m1.2.2">ğ’«</ci><apply id="S2.E15.m1.4.4.1.1.1.1.1.1.cmml" xref="S2.E15.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E15.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E15.m1.4.4.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E15.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S2.E15.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E15.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S2.E15.m1.4.4.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E15.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S2.E15.m1.4.4.1.1.1.1.1.1.2.2">ğ’¯</ci><ci id="S2.E15.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="S2.E15.m1.4.4.1.1.1.1.1.1.2.3">ğ‘</ci></apply><apply id="S2.E15.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S2.E15.m1.4.4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E15.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S2.E15.m1.4.4.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E15.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="S2.E15.m1.4.4.1.1.1.1.1.1.3.2">ğ‘¢</ci><ci id="S2.E15.m1.4.4.1.1.1.1.1.1.3.3.cmml" xref="S2.E15.m1.4.4.1.1.1.1.1.1.3.3">ğ‘–</ci></apply></apply></interval><ci id="S2.E15.m1.4.4.1.1.3.5.cmml" xref="S2.E15.m1.4.4.1.1.3.5">ğ‘œ</ci><ci id="S2.E15.m1.4.4.1.1.3.6.cmml" xref="S2.E15.m1.4.4.1.1.3.6">ğ‘Ÿ</ci><vector id="S2.E15.m1.4.4.1.1.3.3.3.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2"><ci id="S2.E15.m1.3.3.cmml" xref="S2.E15.m1.3.3">ğ’«</ci><apply id="S2.E15.m1.4.4.1.1.2.2.1.1.cmml" xref="S2.E15.m1.4.4.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S2.E15.m1.4.4.1.1.2.2.1.1.1.cmml" xref="S2.E15.m1.4.4.1.1.2.2.1.1">subscript</csymbol><apply id="S2.E15.m1.4.4.1.1.2.2.1.1.2.cmml" xref="S2.E15.m1.4.4.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S2.E15.m1.4.4.1.1.2.2.1.1.2.1.cmml" xref="S2.E15.m1.4.4.1.1.2.2.1.1">superscript</csymbol><ci id="S2.E15.m1.4.4.1.1.2.2.1.1.2.2.cmml" xref="S2.E15.m1.4.4.1.1.2.2.1.1.2.2">ğ’¯</ci><ci id="S2.E15.m1.4.4.1.1.2.2.1.1.2.3.cmml" xref="S2.E15.m1.4.4.1.1.2.2.1.1.2.3">ğ‘</ci></apply><apply id="S2.E15.m1.4.4.1.1.2.2.1.1.3.cmml" xref="S2.E15.m1.4.4.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E15.m1.4.4.1.1.2.2.1.1.3.1.cmml" xref="S2.E15.m1.4.4.1.1.2.2.1.1.3">subscript</csymbol><ci id="S2.E15.m1.4.4.1.1.2.2.1.1.3.2.cmml" xref="S2.E15.m1.4.4.1.1.2.2.1.1.3.2">ğ‘¢</ci><ci id="S2.E15.m1.4.4.1.1.2.2.1.1.3.3.cmml" xref="S2.E15.m1.4.4.1.1.2.2.1.1.3.3">ğ‘–</ci></apply></apply><apply id="S2.E15.m1.4.4.1.1.3.3.2.2.3.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.2"><csymbol cd="latexml" id="S2.E15.m1.4.4.1.1.3.3.2.2.3.1.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.2.3">conditional-set</csymbol><apply id="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.1.1"><csymbol cd="ambiguous" id="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.1.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.1.1">subscript</csymbol><apply id="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.2.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.1.1"><csymbol cd="ambiguous" id="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.2.1.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.1.1">superscript</csymbol><ci id="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.2.2.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.2.2">ğ’¯</ci><ci id="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.2.3.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.2.3">ğ‘</ci></apply><apply id="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.3.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.3.1.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.3">subscript</csymbol><ci id="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.3.2.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.3.2">ğ‘£</ci><ci id="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.3.3.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.1.1.3.3">ğ‘—</ci></apply></apply><apply id="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.2.2"><in id="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.1.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.1"></in><apply id="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.2.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.2.1.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.2">subscript</csymbol><ci id="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.2.2.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.2.2">ğ‘£</ci><ci id="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.2.3.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.2.3">ğ‘—</ci></apply><apply id="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.3.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.3.1.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.3">subscript</csymbol><ci id="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.3.2.cmml" xref="S2.E15.m1.4.4.1.1.3.3.2.2.2.2.3.2">ğ’©</ci><apply id="S2.E15.m1.1.1.1.1.1.cmml" xref="S2.E15.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E15.m1.1.1.1.1.1.1.cmml" xref="S2.E15.m1.1.1.1.1">subscript</csymbol><ci id="S2.E15.m1.1.1.1.1.1.2.cmml" xref="S2.E15.m1.1.1.1.1.1.2">ğ‘¢</ci><ci id="S2.E15.m1.1.1.1.1.1.3.cmml" xref="S2.E15.m1.1.1.1.1.1.3">ğ‘–</ci></apply></apply></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E15.m1.4c">\displaystyle\mathcal{X}_{i}\rightarrow(\mathcal{P},\mathcal{T}^{c}_{u_{i}})\ %
or\ (\mathcal{P},\mathcal{T}^{c}_{u_{i}},\{\mathcal{T}^{c}_{v_{j}}|v_{j}\in%
\mathcal{N}_{(u_{i})}\}),</annotation><annotation encoding="application/x-llamapun" id="S2.E15.m1.4d">caligraphic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT â†’ ( caligraphic_P , caligraphic_T start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) italic_o italic_r ( caligraphic_P , caligraphic_T start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT , { caligraphic_T start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT | italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT âˆˆ caligraphic_N start_POSTSUBSCRIPT ( italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT } ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.SSS2.p1.11">where <math alttext="\mathcal{T}^{c}_{u_{i}}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p1.6.m1.1"><semantics id="S2.SS4.SSS2.p1.6.m1.1a"><msubsup id="S2.SS4.SSS2.p1.6.m1.1.1" xref="S2.SS4.SSS2.p1.6.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS2.p1.6.m1.1.1.2.2" xref="S2.SS4.SSS2.p1.6.m1.1.1.2.2.cmml">ğ’¯</mi><msub id="S2.SS4.SSS2.p1.6.m1.1.1.3" xref="S2.SS4.SSS2.p1.6.m1.1.1.3.cmml"><mi id="S2.SS4.SSS2.p1.6.m1.1.1.3.2" xref="S2.SS4.SSS2.p1.6.m1.1.1.3.2.cmml">u</mi><mi id="S2.SS4.SSS2.p1.6.m1.1.1.3.3" xref="S2.SS4.SSS2.p1.6.m1.1.1.3.3.cmml">i</mi></msub><mi id="S2.SS4.SSS2.p1.6.m1.1.1.2.3" xref="S2.SS4.SSS2.p1.6.m1.1.1.2.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p1.6.m1.1b"><apply id="S2.SS4.SSS2.p1.6.m1.1.1.cmml" xref="S2.SS4.SSS2.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.6.m1.1.1.1.cmml" xref="S2.SS4.SSS2.p1.6.m1.1.1">subscript</csymbol><apply id="S2.SS4.SSS2.p1.6.m1.1.1.2.cmml" xref="S2.SS4.SSS2.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.6.m1.1.1.2.1.cmml" xref="S2.SS4.SSS2.p1.6.m1.1.1">superscript</csymbol><ci id="S2.SS4.SSS2.p1.6.m1.1.1.2.2.cmml" xref="S2.SS4.SSS2.p1.6.m1.1.1.2.2">ğ’¯</ci><ci id="S2.SS4.SSS2.p1.6.m1.1.1.2.3.cmml" xref="S2.SS4.SSS2.p1.6.m1.1.1.2.3">ğ‘</ci></apply><apply id="S2.SS4.SSS2.p1.6.m1.1.1.3.cmml" xref="S2.SS4.SSS2.p1.6.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.6.m1.1.1.3.1.cmml" xref="S2.SS4.SSS2.p1.6.m1.1.1.3">subscript</csymbol><ci id="S2.SS4.SSS2.p1.6.m1.1.1.3.2.cmml" xref="S2.SS4.SSS2.p1.6.m1.1.1.3.2">ğ‘¢</ci><ci id="S2.SS4.SSS2.p1.6.m1.1.1.3.3.cmml" xref="S2.SS4.SSS2.p1.6.m1.1.1.3.3">ğ‘–</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p1.6.m1.1c">\mathcal{T}^{c}_{u_{i}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p1.6.m1.1d">caligraphic_T start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> represents the ID tokens generated by the user MQ-Tokenizer for user <math alttext="u_{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p1.7.m2.1"><semantics id="S2.SS4.SSS2.p1.7.m2.1a"><msub id="S2.SS4.SSS2.p1.7.m2.1.1" xref="S2.SS4.SSS2.p1.7.m2.1.1.cmml"><mi id="S2.SS4.SSS2.p1.7.m2.1.1.2" xref="S2.SS4.SSS2.p1.7.m2.1.1.2.cmml">u</mi><mi id="S2.SS4.SSS2.p1.7.m2.1.1.3" xref="S2.SS4.SSS2.p1.7.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p1.7.m2.1b"><apply id="S2.SS4.SSS2.p1.7.m2.1.1.cmml" xref="S2.SS4.SSS2.p1.7.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.7.m2.1.1.1.cmml" xref="S2.SS4.SSS2.p1.7.m2.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p1.7.m2.1.1.2.cmml" xref="S2.SS4.SSS2.p1.7.m2.1.1.2">ğ‘¢</ci><ci id="S2.SS4.SSS2.p1.7.m2.1.1.3.cmml" xref="S2.SS4.SSS2.p1.7.m2.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p1.7.m2.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p1.7.m2.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. <math alttext="\{\mathcal{T}^{c}_{v_{j}}|v_{j}\in\mathcal{N}_{(u_{i})}\}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p1.8.m3.3"><semantics id="S2.SS4.SSS2.p1.8.m3.3a"><mrow id="S2.SS4.SSS2.p1.8.m3.3.3.2" xref="S2.SS4.SSS2.p1.8.m3.3.3.3.cmml"><mo id="S2.SS4.SSS2.p1.8.m3.3.3.2.3" stretchy="false" xref="S2.SS4.SSS2.p1.8.m3.3.3.3.1.cmml">{</mo><msubsup id="S2.SS4.SSS2.p1.8.m3.2.2.1.1" xref="S2.SS4.SSS2.p1.8.m3.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS2.p1.8.m3.2.2.1.1.2.2" xref="S2.SS4.SSS2.p1.8.m3.2.2.1.1.2.2.cmml">ğ’¯</mi><msub id="S2.SS4.SSS2.p1.8.m3.2.2.1.1.3" xref="S2.SS4.SSS2.p1.8.m3.2.2.1.1.3.cmml"><mi id="S2.SS4.SSS2.p1.8.m3.2.2.1.1.3.2" xref="S2.SS4.SSS2.p1.8.m3.2.2.1.1.3.2.cmml">v</mi><mi id="S2.SS4.SSS2.p1.8.m3.2.2.1.1.3.3" xref="S2.SS4.SSS2.p1.8.m3.2.2.1.1.3.3.cmml">j</mi></msub><mi id="S2.SS4.SSS2.p1.8.m3.2.2.1.1.2.3" xref="S2.SS4.SSS2.p1.8.m3.2.2.1.1.2.3.cmml">c</mi></msubsup><mo id="S2.SS4.SSS2.p1.8.m3.3.3.2.4" lspace="0em" rspace="0em" xref="S2.SS4.SSS2.p1.8.m3.3.3.3.1.cmml">|</mo><mrow id="S2.SS4.SSS2.p1.8.m3.3.3.2.2" xref="S2.SS4.SSS2.p1.8.m3.3.3.2.2.cmml"><msub id="S2.SS4.SSS2.p1.8.m3.3.3.2.2.2" xref="S2.SS4.SSS2.p1.8.m3.3.3.2.2.2.cmml"><mi id="S2.SS4.SSS2.p1.8.m3.3.3.2.2.2.2" xref="S2.SS4.SSS2.p1.8.m3.3.3.2.2.2.2.cmml">v</mi><mi id="S2.SS4.SSS2.p1.8.m3.3.3.2.2.2.3" xref="S2.SS4.SSS2.p1.8.m3.3.3.2.2.2.3.cmml">j</mi></msub><mo id="S2.SS4.SSS2.p1.8.m3.3.3.2.2.1" xref="S2.SS4.SSS2.p1.8.m3.3.3.2.2.1.cmml">âˆˆ</mo><msub id="S2.SS4.SSS2.p1.8.m3.3.3.2.2.3" xref="S2.SS4.SSS2.p1.8.m3.3.3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS2.p1.8.m3.3.3.2.2.3.2" xref="S2.SS4.SSS2.p1.8.m3.3.3.2.2.3.2.cmml">ğ’©</mi><mrow id="S2.SS4.SSS2.p1.8.m3.1.1.1.1" xref="S2.SS4.SSS2.p1.8.m3.1.1.1.1.1.cmml"><mo id="S2.SS4.SSS2.p1.8.m3.1.1.1.1.2" stretchy="false" xref="S2.SS4.SSS2.p1.8.m3.1.1.1.1.1.cmml">(</mo><msub id="S2.SS4.SSS2.p1.8.m3.1.1.1.1.1" xref="S2.SS4.SSS2.p1.8.m3.1.1.1.1.1.cmml"><mi id="S2.SS4.SSS2.p1.8.m3.1.1.1.1.1.2" xref="S2.SS4.SSS2.p1.8.m3.1.1.1.1.1.2.cmml">u</mi><mi id="S2.SS4.SSS2.p1.8.m3.1.1.1.1.1.3" xref="S2.SS4.SSS2.p1.8.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS4.SSS2.p1.8.m3.1.1.1.1.3" stretchy="false" xref="S2.SS4.SSS2.p1.8.m3.1.1.1.1.1.cmml">)</mo></mrow></msub></mrow><mo id="S2.SS4.SSS2.p1.8.m3.3.3.2.5" stretchy="false" xref="S2.SS4.SSS2.p1.8.m3.3.3.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p1.8.m3.3b"><apply id="S2.SS4.SSS2.p1.8.m3.3.3.3.cmml" xref="S2.SS4.SSS2.p1.8.m3.3.3.2"><csymbol cd="latexml" id="S2.SS4.SSS2.p1.8.m3.3.3.3.1.cmml" xref="S2.SS4.SSS2.p1.8.m3.3.3.2.3">conditional-set</csymbol><apply id="S2.SS4.SSS2.p1.8.m3.2.2.1.1.cmml" xref="S2.SS4.SSS2.p1.8.m3.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.8.m3.2.2.1.1.1.cmml" xref="S2.SS4.SSS2.p1.8.m3.2.2.1.1">subscript</csymbol><apply id="S2.SS4.SSS2.p1.8.m3.2.2.1.1.2.cmml" xref="S2.SS4.SSS2.p1.8.m3.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.8.m3.2.2.1.1.2.1.cmml" xref="S2.SS4.SSS2.p1.8.m3.2.2.1.1">superscript</csymbol><ci id="S2.SS4.SSS2.p1.8.m3.2.2.1.1.2.2.cmml" xref="S2.SS4.SSS2.p1.8.m3.2.2.1.1.2.2">ğ’¯</ci><ci id="S2.SS4.SSS2.p1.8.m3.2.2.1.1.2.3.cmml" xref="S2.SS4.SSS2.p1.8.m3.2.2.1.1.2.3">ğ‘</ci></apply><apply id="S2.SS4.SSS2.p1.8.m3.2.2.1.1.3.cmml" xref="S2.SS4.SSS2.p1.8.m3.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.8.m3.2.2.1.1.3.1.cmml" xref="S2.SS4.SSS2.p1.8.m3.2.2.1.1.3">subscript</csymbol><ci id="S2.SS4.SSS2.p1.8.m3.2.2.1.1.3.2.cmml" xref="S2.SS4.SSS2.p1.8.m3.2.2.1.1.3.2">ğ‘£</ci><ci id="S2.SS4.SSS2.p1.8.m3.2.2.1.1.3.3.cmml" xref="S2.SS4.SSS2.p1.8.m3.2.2.1.1.3.3">ğ‘—</ci></apply></apply><apply id="S2.SS4.SSS2.p1.8.m3.3.3.2.2.cmml" xref="S2.SS4.SSS2.p1.8.m3.3.3.2.2"><in id="S2.SS4.SSS2.p1.8.m3.3.3.2.2.1.cmml" xref="S2.SS4.SSS2.p1.8.m3.3.3.2.2.1"></in><apply id="S2.SS4.SSS2.p1.8.m3.3.3.2.2.2.cmml" xref="S2.SS4.SSS2.p1.8.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.8.m3.3.3.2.2.2.1.cmml" xref="S2.SS4.SSS2.p1.8.m3.3.3.2.2.2">subscript</csymbol><ci id="S2.SS4.SSS2.p1.8.m3.3.3.2.2.2.2.cmml" xref="S2.SS4.SSS2.p1.8.m3.3.3.2.2.2.2">ğ‘£</ci><ci id="S2.SS4.SSS2.p1.8.m3.3.3.2.2.2.3.cmml" xref="S2.SS4.SSS2.p1.8.m3.3.3.2.2.2.3">ğ‘—</ci></apply><apply id="S2.SS4.SSS2.p1.8.m3.3.3.2.2.3.cmml" xref="S2.SS4.SSS2.p1.8.m3.3.3.2.2.3"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.8.m3.3.3.2.2.3.1.cmml" xref="S2.SS4.SSS2.p1.8.m3.3.3.2.2.3">subscript</csymbol><ci id="S2.SS4.SSS2.p1.8.m3.3.3.2.2.3.2.cmml" xref="S2.SS4.SSS2.p1.8.m3.3.3.2.2.3.2">ğ’©</ci><apply id="S2.SS4.SSS2.p1.8.m3.1.1.1.1.1.cmml" xref="S2.SS4.SSS2.p1.8.m3.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.8.m3.1.1.1.1.1.1.cmml" xref="S2.SS4.SSS2.p1.8.m3.1.1.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p1.8.m3.1.1.1.1.1.2.cmml" xref="S2.SS4.SSS2.p1.8.m3.1.1.1.1.1.2">ğ‘¢</ci><ci id="S2.SS4.SSS2.p1.8.m3.1.1.1.1.1.3.cmml" xref="S2.SS4.SSS2.p1.8.m3.1.1.1.1.1.3">ğ‘–</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p1.8.m3.3c">\{\mathcal{T}^{c}_{v_{j}}|v_{j}\in\mathcal{N}_{(u_{i})}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p1.8.m3.3d">{ caligraphic_T start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT | italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT âˆˆ caligraphic_N start_POSTSUBSCRIPT ( italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT }</annotation></semantics></math> denotes the ID tokens generated by our item MQ-Tokenizer for the items that user <math alttext="u_{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p1.9.m4.1"><semantics id="S2.SS4.SSS2.p1.9.m4.1a"><msub id="S2.SS4.SSS2.p1.9.m4.1.1" xref="S2.SS4.SSS2.p1.9.m4.1.1.cmml"><mi id="S2.SS4.SSS2.p1.9.m4.1.1.2" xref="S2.SS4.SSS2.p1.9.m4.1.1.2.cmml">u</mi><mi id="S2.SS4.SSS2.p1.9.m4.1.1.3" xref="S2.SS4.SSS2.p1.9.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p1.9.m4.1b"><apply id="S2.SS4.SSS2.p1.9.m4.1.1.cmml" xref="S2.SS4.SSS2.p1.9.m4.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.9.m4.1.1.1.cmml" xref="S2.SS4.SSS2.p1.9.m4.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p1.9.m4.1.1.2.cmml" xref="S2.SS4.SSS2.p1.9.m4.1.1.2">ğ‘¢</ci><ci id="S2.SS4.SSS2.p1.9.m4.1.1.3.cmml" xref="S2.SS4.SSS2.p1.9.m4.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p1.9.m4.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p1.9.m4.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> has interacted with.
It is worth noting that we can randomly shuffle their interactions in <math alttext="\mathcal{N}_{(u_{i})}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p1.10.m5.1"><semantics id="S2.SS4.SSS2.p1.10.m5.1a"><msub id="S2.SS4.SSS2.p1.10.m5.1.2" xref="S2.SS4.SSS2.p1.10.m5.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS2.p1.10.m5.1.2.2" xref="S2.SS4.SSS2.p1.10.m5.1.2.2.cmml">ğ’©</mi><mrow id="S2.SS4.SSS2.p1.10.m5.1.1.1.1" xref="S2.SS4.SSS2.p1.10.m5.1.1.1.1.1.cmml"><mo id="S2.SS4.SSS2.p1.10.m5.1.1.1.1.2" stretchy="false" xref="S2.SS4.SSS2.p1.10.m5.1.1.1.1.1.cmml">(</mo><msub id="S2.SS4.SSS2.p1.10.m5.1.1.1.1.1" xref="S2.SS4.SSS2.p1.10.m5.1.1.1.1.1.cmml"><mi id="S2.SS4.SSS2.p1.10.m5.1.1.1.1.1.2" xref="S2.SS4.SSS2.p1.10.m5.1.1.1.1.1.2.cmml">u</mi><mi id="S2.SS4.SSS2.p1.10.m5.1.1.1.1.1.3" xref="S2.SS4.SSS2.p1.10.m5.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS4.SSS2.p1.10.m5.1.1.1.1.3" stretchy="false" xref="S2.SS4.SSS2.p1.10.m5.1.1.1.1.1.cmml">)</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p1.10.m5.1b"><apply id="S2.SS4.SSS2.p1.10.m5.1.2.cmml" xref="S2.SS4.SSS2.p1.10.m5.1.2"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.10.m5.1.2.1.cmml" xref="S2.SS4.SSS2.p1.10.m5.1.2">subscript</csymbol><ci id="S2.SS4.SSS2.p1.10.m5.1.2.2.cmml" xref="S2.SS4.SSS2.p1.10.m5.1.2.2">ğ’©</ci><apply id="S2.SS4.SSS2.p1.10.m5.1.1.1.1.1.cmml" xref="S2.SS4.SSS2.p1.10.m5.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.10.m5.1.1.1.1.1.1.cmml" xref="S2.SS4.SSS2.p1.10.m5.1.1.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p1.10.m5.1.1.1.1.1.2.cmml" xref="S2.SS4.SSS2.p1.10.m5.1.1.1.1.1.2">ğ‘¢</ci><ci id="S2.SS4.SSS2.p1.10.m5.1.1.1.1.1.3.cmml" xref="S2.SS4.SSS2.p1.10.m5.1.1.1.1.1.3">ğ‘–</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p1.10.m5.1c">\mathcal{N}_{(u_{i})}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p1.10.m5.1d">caligraphic_N start_POSTSUBSCRIPT ( italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT</annotation></semantics></math> for neglecting the consideration of user <math alttext="u_{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p1.11.m6.1"><semantics id="S2.SS4.SSS2.p1.11.m6.1a"><msub id="S2.SS4.SSS2.p1.11.m6.1.1" xref="S2.SS4.SSS2.p1.11.m6.1.1.cmml"><mi id="S2.SS4.SSS2.p1.11.m6.1.1.2" xref="S2.SS4.SSS2.p1.11.m6.1.1.2.cmml">u</mi><mi id="S2.SS4.SSS2.p1.11.m6.1.1.3" xref="S2.SS4.SSS2.p1.11.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p1.11.m6.1b"><apply id="S2.SS4.SSS2.p1.11.m6.1.1.cmml" xref="S2.SS4.SSS2.p1.11.m6.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.11.m6.1.1.1.cmml" xref="S2.SS4.SSS2.p1.11.m6.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p1.11.m6.1.1.2.cmml" xref="S2.SS4.SSS2.p1.11.m6.1.1.2">ğ‘¢</ci><ci id="S2.SS4.SSS2.p1.11.m6.1.1.3.cmml" xref="S2.SS4.SSS2.p1.11.m6.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p1.11.m6.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p1.11.m6.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>â€™s sequential signals towards items.</p>
</div>
<div class="ltx_para" id="S2.SS4.SSS2.p2">
<p class="ltx_p" id="S2.SS4.SSS2.p2.2">Under the conventional text-to-text generation paradigm (e.g., P5), the user modeling process involves receiving a text input <math alttext="\mathcal{X}_{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p2.1.m1.1"><semantics id="S2.SS4.SSS2.p2.1.m1.1a"><msub id="S2.SS4.SSS2.p2.1.m1.1.1" xref="S2.SS4.SSS2.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS2.p2.1.m1.1.1.2" xref="S2.SS4.SSS2.p2.1.m1.1.1.2.cmml">ğ’³</mi><mi id="S2.SS4.SSS2.p2.1.m1.1.1.3" xref="S2.SS4.SSS2.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p2.1.m1.1b"><apply id="S2.SS4.SSS2.p2.1.m1.1.1.cmml" xref="S2.SS4.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p2.1.m1.1.1.1.cmml" xref="S2.SS4.SSS2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p2.1.m1.1.1.2.cmml" xref="S2.SS4.SSS2.p2.1.m1.1.1.2">ğ’³</ci><ci id="S2.SS4.SSS2.p2.1.m1.1.1.3.cmml" xref="S2.SS4.SSS2.p2.1.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p2.1.m1.1c">\mathcal{X}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p2.1.m1.1d">caligraphic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for user <math alttext="u_{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p2.2.m2.1"><semantics id="S2.SS4.SSS2.p2.2.m2.1a"><msub id="S2.SS4.SSS2.p2.2.m2.1.1" xref="S2.SS4.SSS2.p2.2.m2.1.1.cmml"><mi id="S2.SS4.SSS2.p2.2.m2.1.1.2" xref="S2.SS4.SSS2.p2.2.m2.1.1.2.cmml">u</mi><mi id="S2.SS4.SSS2.p2.2.m2.1.1.3" xref="S2.SS4.SSS2.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p2.2.m2.1b"><apply id="S2.SS4.SSS2.p2.2.m2.1.1.cmml" xref="S2.SS4.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p2.2.m2.1.1.1.cmml" xref="S2.SS4.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p2.2.m2.1.1.2.cmml" xref="S2.SS4.SSS2.p2.2.m2.1.1.2">ğ‘¢</ci><ci id="S2.SS4.SSS2.p2.2.m2.1.1.3.cmml" xref="S2.SS4.SSS2.p2.2.m2.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p2.2.m2.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p2.2.m2.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and generating descriptive texts for potential items in <span class="ltx_text ltx_font_bold" id="S2.SS4.SSS2.p2.2.1">an auto-regressive manner</span>, which can be formalized as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx14">
<tbody id="S2.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{T}_{t}=\text{LLM}(\mathcal{X}_{i},\mathcal{T}_{i:t-1})," class="ltx_Math" display="inline" id="S2.E16.m1.1"><semantics id="S2.E16.m1.1a"><mrow id="S2.E16.m1.1.1.1" xref="S2.E16.m1.1.1.1.1.cmml"><mrow id="S2.E16.m1.1.1.1.1" xref="S2.E16.m1.1.1.1.1.cmml"><msub id="S2.E16.m1.1.1.1.1.4" xref="S2.E16.m1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E16.m1.1.1.1.1.4.2" xref="S2.E16.m1.1.1.1.1.4.2.cmml">ğ’¯</mi><mi id="S2.E16.m1.1.1.1.1.4.3" xref="S2.E16.m1.1.1.1.1.4.3.cmml">t</mi></msub><mo id="S2.E16.m1.1.1.1.1.3" xref="S2.E16.m1.1.1.1.1.3.cmml">=</mo><mrow id="S2.E16.m1.1.1.1.1.2" xref="S2.E16.m1.1.1.1.1.2.cmml"><mtext id="S2.E16.m1.1.1.1.1.2.4" xref="S2.E16.m1.1.1.1.1.2.4a.cmml">LLM</mtext><mo id="S2.E16.m1.1.1.1.1.2.3" xref="S2.E16.m1.1.1.1.1.2.3.cmml">â¢</mo><mrow id="S2.E16.m1.1.1.1.1.2.2.2" xref="S2.E16.m1.1.1.1.1.2.2.3.cmml"><mo id="S2.E16.m1.1.1.1.1.2.2.2.3" stretchy="false" xref="S2.E16.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S2.E16.m1.1.1.1.1.1.1.1.1" xref="S2.E16.m1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E16.m1.1.1.1.1.1.1.1.1.2" xref="S2.E16.m1.1.1.1.1.1.1.1.1.2.cmml">ğ’³</mi><mi id="S2.E16.m1.1.1.1.1.1.1.1.1.3" xref="S2.E16.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E16.m1.1.1.1.1.2.2.2.4" xref="S2.E16.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S2.E16.m1.1.1.1.1.2.2.2.2" xref="S2.E16.m1.1.1.1.1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E16.m1.1.1.1.1.2.2.2.2.2" xref="S2.E16.m1.1.1.1.1.2.2.2.2.2.cmml">ğ’¯</mi><mrow id="S2.E16.m1.1.1.1.1.2.2.2.2.3" xref="S2.E16.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S2.E16.m1.1.1.1.1.2.2.2.2.3.2" xref="S2.E16.m1.1.1.1.1.2.2.2.2.3.2.cmml">i</mi><mo id="S2.E16.m1.1.1.1.1.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E16.m1.1.1.1.1.2.2.2.2.3.1.cmml">:</mo><mrow id="S2.E16.m1.1.1.1.1.2.2.2.2.3.3" xref="S2.E16.m1.1.1.1.1.2.2.2.2.3.3.cmml"><mi id="S2.E16.m1.1.1.1.1.2.2.2.2.3.3.2" xref="S2.E16.m1.1.1.1.1.2.2.2.2.3.3.2.cmml">t</mi><mo id="S2.E16.m1.1.1.1.1.2.2.2.2.3.3.1" xref="S2.E16.m1.1.1.1.1.2.2.2.2.3.3.1.cmml">âˆ’</mo><mn id="S2.E16.m1.1.1.1.1.2.2.2.2.3.3.3" xref="S2.E16.m1.1.1.1.1.2.2.2.2.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S2.E16.m1.1.1.1.1.2.2.2.5" stretchy="false" xref="S2.E16.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E16.m1.1.1.1.2" xref="S2.E16.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E16.m1.1b"><apply id="S2.E16.m1.1.1.1.1.cmml" xref="S2.E16.m1.1.1.1"><eq id="S2.E16.m1.1.1.1.1.3.cmml" xref="S2.E16.m1.1.1.1.1.3"></eq><apply id="S2.E16.m1.1.1.1.1.4.cmml" xref="S2.E16.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E16.m1.1.1.1.1.4.1.cmml" xref="S2.E16.m1.1.1.1.1.4">subscript</csymbol><ci id="S2.E16.m1.1.1.1.1.4.2.cmml" xref="S2.E16.m1.1.1.1.1.4.2">ğ’¯</ci><ci id="S2.E16.m1.1.1.1.1.4.3.cmml" xref="S2.E16.m1.1.1.1.1.4.3">ğ‘¡</ci></apply><apply id="S2.E16.m1.1.1.1.1.2.cmml" xref="S2.E16.m1.1.1.1.1.2"><times id="S2.E16.m1.1.1.1.1.2.3.cmml" xref="S2.E16.m1.1.1.1.1.2.3"></times><ci id="S2.E16.m1.1.1.1.1.2.4a.cmml" xref="S2.E16.m1.1.1.1.1.2.4"><mtext id="S2.E16.m1.1.1.1.1.2.4.cmml" xref="S2.E16.m1.1.1.1.1.2.4">LLM</mtext></ci><interval closure="open" id="S2.E16.m1.1.1.1.1.2.2.3.cmml" xref="S2.E16.m1.1.1.1.1.2.2.2"><apply id="S2.E16.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E16.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E16.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E16.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E16.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E16.m1.1.1.1.1.1.1.1.1.2">ğ’³</ci><ci id="S2.E16.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E16.m1.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="S2.E16.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.E16.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E16.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E16.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E16.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E16.m1.1.1.1.1.2.2.2.2.2">ğ’¯</ci><apply id="S2.E16.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E16.m1.1.1.1.1.2.2.2.2.3"><ci id="S2.E16.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S2.E16.m1.1.1.1.1.2.2.2.2.3.1">:</ci><ci id="S2.E16.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S2.E16.m1.1.1.1.1.2.2.2.2.3.2">ğ‘–</ci><apply id="S2.E16.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S2.E16.m1.1.1.1.1.2.2.2.2.3.3"><minus id="S2.E16.m1.1.1.1.1.2.2.2.2.3.3.1.cmml" xref="S2.E16.m1.1.1.1.1.2.2.2.2.3.3.1"></minus><ci id="S2.E16.m1.1.1.1.1.2.2.2.2.3.3.2.cmml" xref="S2.E16.m1.1.1.1.1.2.2.2.2.3.3.2">ğ‘¡</ci><cn id="S2.E16.m1.1.1.1.1.2.2.2.2.3.3.3.cmml" type="integer" xref="S2.E16.m1.1.1.1.1.2.2.2.2.3.3.3">1</cn></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E16.m1.1c">\displaystyle\mathcal{T}_{t}=\text{LLM}(\mathcal{X}_{i},\mathcal{T}_{i:t-1}),</annotation><annotation encoding="application/x-llamapun" id="S2.E16.m1.1d">caligraphic_T start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = LLM ( caligraphic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , caligraphic_T start_POSTSUBSCRIPT italic_i : italic_t - 1 end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.SSS2.p2.9">where <math alttext="\mathcal{T}_{t}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p2.3.m1.1"><semantics id="S2.SS4.SSS2.p2.3.m1.1a"><msub id="S2.SS4.SSS2.p2.3.m1.1.1" xref="S2.SS4.SSS2.p2.3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS2.p2.3.m1.1.1.2" xref="S2.SS4.SSS2.p2.3.m1.1.1.2.cmml">ğ’¯</mi><mi id="S2.SS4.SSS2.p2.3.m1.1.1.3" xref="S2.SS4.SSS2.p2.3.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p2.3.m1.1b"><apply id="S2.SS4.SSS2.p2.3.m1.1.1.cmml" xref="S2.SS4.SSS2.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p2.3.m1.1.1.1.cmml" xref="S2.SS4.SSS2.p2.3.m1.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p2.3.m1.1.1.2.cmml" xref="S2.SS4.SSS2.p2.3.m1.1.1.2">ğ’¯</ci><ci id="S2.SS4.SSS2.p2.3.m1.1.1.3.cmml" xref="S2.SS4.SSS2.p2.3.m1.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p2.3.m1.1c">\mathcal{T}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p2.3.m1.1d">caligraphic_T start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> represents the token being generated at the <math alttext="t_{th}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p2.4.m2.1"><semantics id="S2.SS4.SSS2.p2.4.m2.1a"><msub id="S2.SS4.SSS2.p2.4.m2.1.1" xref="S2.SS4.SSS2.p2.4.m2.1.1.cmml"><mi id="S2.SS4.SSS2.p2.4.m2.1.1.2" xref="S2.SS4.SSS2.p2.4.m2.1.1.2.cmml">t</mi><mrow id="S2.SS4.SSS2.p2.4.m2.1.1.3" xref="S2.SS4.SSS2.p2.4.m2.1.1.3.cmml"><mi id="S2.SS4.SSS2.p2.4.m2.1.1.3.2" xref="S2.SS4.SSS2.p2.4.m2.1.1.3.2.cmml">t</mi><mo id="S2.SS4.SSS2.p2.4.m2.1.1.3.1" xref="S2.SS4.SSS2.p2.4.m2.1.1.3.1.cmml">â¢</mo><mi id="S2.SS4.SSS2.p2.4.m2.1.1.3.3" xref="S2.SS4.SSS2.p2.4.m2.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p2.4.m2.1b"><apply id="S2.SS4.SSS2.p2.4.m2.1.1.cmml" xref="S2.SS4.SSS2.p2.4.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p2.4.m2.1.1.1.cmml" xref="S2.SS4.SSS2.p2.4.m2.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p2.4.m2.1.1.2.cmml" xref="S2.SS4.SSS2.p2.4.m2.1.1.2">ğ‘¡</ci><apply id="S2.SS4.SSS2.p2.4.m2.1.1.3.cmml" xref="S2.SS4.SSS2.p2.4.m2.1.1.3"><times id="S2.SS4.SSS2.p2.4.m2.1.1.3.1.cmml" xref="S2.SS4.SSS2.p2.4.m2.1.1.3.1"></times><ci id="S2.SS4.SSS2.p2.4.m2.1.1.3.2.cmml" xref="S2.SS4.SSS2.p2.4.m2.1.1.3.2">ğ‘¡</ci><ci id="S2.SS4.SSS2.p2.4.m2.1.1.3.3.cmml" xref="S2.SS4.SSS2.p2.4.m2.1.1.3.3">â„</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p2.4.m2.1c">t_{th}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p2.4.m2.1d">italic_t start_POSTSUBSCRIPT italic_t italic_h end_POSTSUBSCRIPT</annotation></semantics></math> position, while <math alttext="\mathcal{T}_{1:t-1}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p2.5.m3.1"><semantics id="S2.SS4.SSS2.p2.5.m3.1a"><msub id="S2.SS4.SSS2.p2.5.m3.1.1" xref="S2.SS4.SSS2.p2.5.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS2.p2.5.m3.1.1.2" xref="S2.SS4.SSS2.p2.5.m3.1.1.2.cmml">ğ’¯</mi><mrow id="S2.SS4.SSS2.p2.5.m3.1.1.3" xref="S2.SS4.SSS2.p2.5.m3.1.1.3.cmml"><mn id="S2.SS4.SSS2.p2.5.m3.1.1.3.2" xref="S2.SS4.SSS2.p2.5.m3.1.1.3.2.cmml">1</mn><mo id="S2.SS4.SSS2.p2.5.m3.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS4.SSS2.p2.5.m3.1.1.3.1.cmml">:</mo><mrow id="S2.SS4.SSS2.p2.5.m3.1.1.3.3" xref="S2.SS4.SSS2.p2.5.m3.1.1.3.3.cmml"><mi id="S2.SS4.SSS2.p2.5.m3.1.1.3.3.2" xref="S2.SS4.SSS2.p2.5.m3.1.1.3.3.2.cmml">t</mi><mo id="S2.SS4.SSS2.p2.5.m3.1.1.3.3.1" xref="S2.SS4.SSS2.p2.5.m3.1.1.3.3.1.cmml">âˆ’</mo><mn id="S2.SS4.SSS2.p2.5.m3.1.1.3.3.3" xref="S2.SS4.SSS2.p2.5.m3.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p2.5.m3.1b"><apply id="S2.SS4.SSS2.p2.5.m3.1.1.cmml" xref="S2.SS4.SSS2.p2.5.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p2.5.m3.1.1.1.cmml" xref="S2.SS4.SSS2.p2.5.m3.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p2.5.m3.1.1.2.cmml" xref="S2.SS4.SSS2.p2.5.m3.1.1.2">ğ’¯</ci><apply id="S2.SS4.SSS2.p2.5.m3.1.1.3.cmml" xref="S2.SS4.SSS2.p2.5.m3.1.1.3"><ci id="S2.SS4.SSS2.p2.5.m3.1.1.3.1.cmml" xref="S2.SS4.SSS2.p2.5.m3.1.1.3.1">:</ci><cn id="S2.SS4.SSS2.p2.5.m3.1.1.3.2.cmml" type="integer" xref="S2.SS4.SSS2.p2.5.m3.1.1.3.2">1</cn><apply id="S2.SS4.SSS2.p2.5.m3.1.1.3.3.cmml" xref="S2.SS4.SSS2.p2.5.m3.1.1.3.3"><minus id="S2.SS4.SSS2.p2.5.m3.1.1.3.3.1.cmml" xref="S2.SS4.SSS2.p2.5.m3.1.1.3.3.1"></minus><ci id="S2.SS4.SSS2.p2.5.m3.1.1.3.3.2.cmml" xref="S2.SS4.SSS2.p2.5.m3.1.1.3.3.2">ğ‘¡</ci><cn id="S2.SS4.SSS2.p2.5.m3.1.1.3.3.3.cmml" type="integer" xref="S2.SS4.SSS2.p2.5.m3.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p2.5.m3.1c">\mathcal{T}_{1:t-1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p2.5.m3.1d">caligraphic_T start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math> denotes the previously generated tokens from the LLM.
In contrast, our user modeling process differs from the previous approach.
To be more specific, we take the input <math alttext="\mathcal{X}_{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p2.6.m4.1"><semantics id="S2.SS4.SSS2.p2.6.m4.1a"><msub id="S2.SS4.SSS2.p2.6.m4.1.1" xref="S2.SS4.SSS2.p2.6.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS2.p2.6.m4.1.1.2" xref="S2.SS4.SSS2.p2.6.m4.1.1.2.cmml">ğ’³</mi><mi id="S2.SS4.SSS2.p2.6.m4.1.1.3" xref="S2.SS4.SSS2.p2.6.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p2.6.m4.1b"><apply id="S2.SS4.SSS2.p2.6.m4.1.1.cmml" xref="S2.SS4.SSS2.p2.6.m4.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p2.6.m4.1.1.1.cmml" xref="S2.SS4.SSS2.p2.6.m4.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p2.6.m4.1.1.2.cmml" xref="S2.SS4.SSS2.p2.6.m4.1.1.2">ğ’³</ci><ci id="S2.SS4.SSS2.p2.6.m4.1.1.3.cmml" xref="S2.SS4.SSS2.p2.6.m4.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p2.6.m4.1c">\mathcal{X}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p2.6.m4.1d">caligraphic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and pass it through the LLM backbone, denoted as <math alttext="\text{LLM4Rec}(\cdot)" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p2.7.m5.1"><semantics id="S2.SS4.SSS2.p2.7.m5.1a"><mrow id="S2.SS4.SSS2.p2.7.m5.1.2" xref="S2.SS4.SSS2.p2.7.m5.1.2.cmml"><mtext id="S2.SS4.SSS2.p2.7.m5.1.2.2" xref="S2.SS4.SSS2.p2.7.m5.1.2.2a.cmml">LLM4Rec</mtext><mo id="S2.SS4.SSS2.p2.7.m5.1.2.1" xref="S2.SS4.SSS2.p2.7.m5.1.2.1.cmml">â¢</mo><mrow id="S2.SS4.SSS2.p2.7.m5.1.2.3.2" xref="S2.SS4.SSS2.p2.7.m5.1.2.cmml"><mo id="S2.SS4.SSS2.p2.7.m5.1.2.3.2.1" stretchy="false" xref="S2.SS4.SSS2.p2.7.m5.1.2.cmml">(</mo><mo id="S2.SS4.SSS2.p2.7.m5.1.1" lspace="0em" rspace="0em" xref="S2.SS4.SSS2.p2.7.m5.1.1.cmml">â‹…</mo><mo id="S2.SS4.SSS2.p2.7.m5.1.2.3.2.2" stretchy="false" xref="S2.SS4.SSS2.p2.7.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p2.7.m5.1b"><apply id="S2.SS4.SSS2.p2.7.m5.1.2.cmml" xref="S2.SS4.SSS2.p2.7.m5.1.2"><times id="S2.SS4.SSS2.p2.7.m5.1.2.1.cmml" xref="S2.SS4.SSS2.p2.7.m5.1.2.1"></times><ci id="S2.SS4.SSS2.p2.7.m5.1.2.2a.cmml" xref="S2.SS4.SSS2.p2.7.m5.1.2.2"><mtext id="S2.SS4.SSS2.p2.7.m5.1.2.2.cmml" xref="S2.SS4.SSS2.p2.7.m5.1.2.2">LLM4Rec</mtext></ci><ci id="S2.SS4.SSS2.p2.7.m5.1.1.cmml" xref="S2.SS4.SSS2.p2.7.m5.1.1">â‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p2.7.m5.1c">\text{LLM4Rec}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p2.7.m5.1d">LLM4Rec ( â‹… )</annotation></semantics></math> to generate a hidden representation <math alttext="\mathbf{h}_{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p2.8.m6.1"><semantics id="S2.SS4.SSS2.p2.8.m6.1a"><msub id="S2.SS4.SSS2.p2.8.m6.1.1" xref="S2.SS4.SSS2.p2.8.m6.1.1.cmml"><mi id="S2.SS4.SSS2.p2.8.m6.1.1.2" xref="S2.SS4.SSS2.p2.8.m6.1.1.2.cmml">ğ¡</mi><mi id="S2.SS4.SSS2.p2.8.m6.1.1.3" xref="S2.SS4.SSS2.p2.8.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p2.8.m6.1b"><apply id="S2.SS4.SSS2.p2.8.m6.1.1.cmml" xref="S2.SS4.SSS2.p2.8.m6.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p2.8.m6.1.1.1.cmml" xref="S2.SS4.SSS2.p2.8.m6.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p2.8.m6.1.1.2.cmml" xref="S2.SS4.SSS2.p2.8.m6.1.1.2">ğ¡</ci><ci id="S2.SS4.SSS2.p2.8.m6.1.1.3.cmml" xref="S2.SS4.SSS2.p2.8.m6.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p2.8.m6.1c">\mathbf{h}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p2.8.m6.1d">bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> that reflects the modelâ€™s comprehension of user <math alttext="u_{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p2.9.m7.1"><semantics id="S2.SS4.SSS2.p2.9.m7.1a"><msub id="S2.SS4.SSS2.p2.9.m7.1.1" xref="S2.SS4.SSS2.p2.9.m7.1.1.cmml"><mi id="S2.SS4.SSS2.p2.9.m7.1.1.2" xref="S2.SS4.SSS2.p2.9.m7.1.1.2.cmml">u</mi><mi id="S2.SS4.SSS2.p2.9.m7.1.1.3" xref="S2.SS4.SSS2.p2.9.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p2.9.m7.1b"><apply id="S2.SS4.SSS2.p2.9.m7.1.1.cmml" xref="S2.SS4.SSS2.p2.9.m7.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p2.9.m7.1.1.1.cmml" xref="S2.SS4.SSS2.p2.9.m7.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p2.9.m7.1.1.2.cmml" xref="S2.SS4.SSS2.p2.9.m7.1.1.2">ğ‘¢</ci><ci id="S2.SS4.SSS2.p2.9.m7.1.1.3.cmml" xref="S2.SS4.SSS2.p2.9.m7.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p2.9.m7.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p2.9.m7.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>â€™s preferences for next-items recommendations.
Mathematically, we can express this process as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx15">
<tbody id="S2.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{h}_{i}=\text{LLM4Rec}(\mathcal{X}_{i})." class="ltx_Math" display="inline" id="S2.E17.m1.1"><semantics id="S2.E17.m1.1a"><mrow id="S2.E17.m1.1.1.1" xref="S2.E17.m1.1.1.1.1.cmml"><mrow id="S2.E17.m1.1.1.1.1" xref="S2.E17.m1.1.1.1.1.cmml"><msub id="S2.E17.m1.1.1.1.1.3" xref="S2.E17.m1.1.1.1.1.3.cmml"><mi id="S2.E17.m1.1.1.1.1.3.2" xref="S2.E17.m1.1.1.1.1.3.2.cmml">ğ¡</mi><mi id="S2.E17.m1.1.1.1.1.3.3" xref="S2.E17.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S2.E17.m1.1.1.1.1.2" xref="S2.E17.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E17.m1.1.1.1.1.1" xref="S2.E17.m1.1.1.1.1.1.cmml"><mtext id="S2.E17.m1.1.1.1.1.1.3" xref="S2.E17.m1.1.1.1.1.1.3a.cmml">LLM4Rec</mtext><mo id="S2.E17.m1.1.1.1.1.1.2" xref="S2.E17.m1.1.1.1.1.1.2.cmml">â¢</mo><mrow id="S2.E17.m1.1.1.1.1.1.1.1" xref="S2.E17.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E17.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E17.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E17.m1.1.1.1.1.1.1.1.1" xref="S2.E17.m1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E17.m1.1.1.1.1.1.1.1.1.2" xref="S2.E17.m1.1.1.1.1.1.1.1.1.2.cmml">ğ’³</mi><mi id="S2.E17.m1.1.1.1.1.1.1.1.1.3" xref="S2.E17.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E17.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E17.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E17.m1.1.1.1.2" lspace="0em" xref="S2.E17.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E17.m1.1b"><apply id="S2.E17.m1.1.1.1.1.cmml" xref="S2.E17.m1.1.1.1"><eq id="S2.E17.m1.1.1.1.1.2.cmml" xref="S2.E17.m1.1.1.1.1.2"></eq><apply id="S2.E17.m1.1.1.1.1.3.cmml" xref="S2.E17.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E17.m1.1.1.1.1.3.1.cmml" xref="S2.E17.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.E17.m1.1.1.1.1.3.2.cmml" xref="S2.E17.m1.1.1.1.1.3.2">ğ¡</ci><ci id="S2.E17.m1.1.1.1.1.3.3.cmml" xref="S2.E17.m1.1.1.1.1.3.3">ğ‘–</ci></apply><apply id="S2.E17.m1.1.1.1.1.1.cmml" xref="S2.E17.m1.1.1.1.1.1"><times id="S2.E17.m1.1.1.1.1.1.2.cmml" xref="S2.E17.m1.1.1.1.1.1.2"></times><ci id="S2.E17.m1.1.1.1.1.1.3a.cmml" xref="S2.E17.m1.1.1.1.1.1.3"><mtext id="S2.E17.m1.1.1.1.1.1.3.cmml" xref="S2.E17.m1.1.1.1.1.1.3">LLM4Rec</mtext></ci><apply id="S2.E17.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E17.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E17.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E17.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E17.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E17.m1.1.1.1.1.1.1.1.1.2">ğ’³</ci><ci id="S2.E17.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E17.m1.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E17.m1.1c">\displaystyle\mathbf{h}_{i}=\text{LLM4Rec}(\mathcal{X}_{i}).</annotation><annotation encoding="application/x-llamapun" id="S2.E17.m1.1d">bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = LLM4Rec ( caligraphic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.SSS2.p2.11">In other words, the final encoded representation <math alttext="\mathbf{h}_{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p2.10.m1.1"><semantics id="S2.SS4.SSS2.p2.10.m1.1a"><msub id="S2.SS4.SSS2.p2.10.m1.1.1" xref="S2.SS4.SSS2.p2.10.m1.1.1.cmml"><mi id="S2.SS4.SSS2.p2.10.m1.1.1.2" xref="S2.SS4.SSS2.p2.10.m1.1.1.2.cmml">ğ¡</mi><mi id="S2.SS4.SSS2.p2.10.m1.1.1.3" xref="S2.SS4.SSS2.p2.10.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p2.10.m1.1b"><apply id="S2.SS4.SSS2.p2.10.m1.1.1.cmml" xref="S2.SS4.SSS2.p2.10.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p2.10.m1.1.1.1.cmml" xref="S2.SS4.SSS2.p2.10.m1.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p2.10.m1.1.1.2.cmml" xref="S2.SS4.SSS2.p2.10.m1.1.1.2">ğ¡</ci><ci id="S2.SS4.SSS2.p2.10.m1.1.1.3.cmml" xref="S2.SS4.SSS2.p2.10.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p2.10.m1.1c">\mathbf{h}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p2.10.m1.1d">bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> can be considered as user <math alttext="u_{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p2.11.m2.1"><semantics id="S2.SS4.SSS2.p2.11.m2.1a"><msub id="S2.SS4.SSS2.p2.11.m2.1.1" xref="S2.SS4.SSS2.p2.11.m2.1.1.cmml"><mi id="S2.SS4.SSS2.p2.11.m2.1.1.2" xref="S2.SS4.SSS2.p2.11.m2.1.1.2.cmml">u</mi><mi id="S2.SS4.SSS2.p2.11.m2.1.1.3" xref="S2.SS4.SSS2.p2.11.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p2.11.m2.1b"><apply id="S2.SS4.SSS2.p2.11.m2.1.1.cmml" xref="S2.SS4.SSS2.p2.11.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p2.11.m2.1.1.1.cmml" xref="S2.SS4.SSS2.p2.11.m2.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p2.11.m2.1.1.2.cmml" xref="S2.SS4.SSS2.p2.11.m2.1.1.2">ğ‘¢</ci><ci id="S2.SS4.SSS2.p2.11.m2.1.1.3.cmml" xref="S2.SS4.SSS2.p2.11.m2.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p2.11.m2.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p2.11.m2.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>â€™s generative preferences of the next items for making personalized recommendations.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS4.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S2.SS4.SSS3.4.1.1">II-D</span>3 </span><span class="ltx_text ltx_font_bold" id="S2.SS4.SSS3.5.2">Generative Retrieval</span>
</h4>
<div class="ltx_para" id="S2.SS4.SSS3.p1">
<p class="ltx_p" id="S2.SS4.SSS3.p1.1">In general, LLM-based recommender systems employ auto-regressive generation to decode recommendations in natural languageÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib24" title="">24</a>]</cite>, such as producing textual strings like â€<em class="ltx_emph ltx_font_italic" id="S2.SS4.SSS3.p1.1.1">item_1234</em>â€ or <em class="ltx_emph ltx_font_italic" id="S2.SS4.SSS3.p1.1.2">â€the user love electronics â€¦</em>â€.
However, the beam search decoding in LLMs can be very time-consuming during auto-regressive generationÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib25" title="">25</a>]</cite>, which is impractical for various real-time recommendation scenarios.
Moreover, due to the hallucination issue, generating accurate item titles and descriptions is highly challenging when making personalized recommendations.
For example, itemsâ€™ title â€œ<em class="ltx_emph ltx_font_italic" id="S2.SS4.SSS3.p1.1.3">iPhone SE, 256 GB, starlight</em>â€ and â€œ<em class="ltx_emph ltx_font_italic" id="S2.SS4.SSS3.p1.1.4">iPhone 15, 256 GB, starlight</em>â€ share most tokens but are significantly different products - with â€œ<em class="ltx_emph ltx_font_italic" id="S2.SS4.SSS3.p1.1.5">iPhone 15, 256 GB, starlight</em>â€™ being a non-factual product.
The hallucination issue is likely more severe in e-commerce platforms, where billions of products are sold, leading to invalid item identifiers for recommendations.
Furthermore, title generation in LLM-based recommendations cannot generate unseen items in the fine-tuning stage, which is often infeasible in practice.
To this end, we propose a generative retrieval paradigm for LLM-based recommendations, where a simple but effective and efficient strategy is designed to project generative usersâ€™ preferences for retrieving potential items from the whole item pool.</p>
</div>
<div class="ltx_para" id="S2.SS4.SSS3.p2">
<p class="ltx_p" id="S2.SS4.SSS3.p2.4">More specifically, the hidden state <math alttext="\mathbf{h}_{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p2.1.m1.1"><semantics id="S2.SS4.SSS3.p2.1.m1.1a"><msub id="S2.SS4.SSS3.p2.1.m1.1.1" xref="S2.SS4.SSS3.p2.1.m1.1.1.cmml"><mi id="S2.SS4.SSS3.p2.1.m1.1.1.2" xref="S2.SS4.SSS3.p2.1.m1.1.1.2.cmml">ğ¡</mi><mi id="S2.SS4.SSS3.p2.1.m1.1.1.3" xref="S2.SS4.SSS3.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p2.1.m1.1b"><apply id="S2.SS4.SSS3.p2.1.m1.1.1.cmml" xref="S2.SS4.SSS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS3.p2.1.m1.1.1.1.cmml" xref="S2.SS4.SSS3.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS4.SSS3.p2.1.m1.1.1.2.cmml" xref="S2.SS4.SSS3.p2.1.m1.1.1.2">ğ¡</ci><ci id="S2.SS4.SSS3.p2.1.m1.1.1.3.cmml" xref="S2.SS4.SSS3.p2.1.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p2.1.m1.1c">\mathbf{h}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p2.1.m1.1d">bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> from <math alttext="\text{LLM4Rec}(\cdot)" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p2.2.m2.1"><semantics id="S2.SS4.SSS3.p2.2.m2.1a"><mrow id="S2.SS4.SSS3.p2.2.m2.1.2" xref="S2.SS4.SSS3.p2.2.m2.1.2.cmml"><mtext id="S2.SS4.SSS3.p2.2.m2.1.2.2" xref="S2.SS4.SSS3.p2.2.m2.1.2.2a.cmml">LLM4Rec</mtext><mo id="S2.SS4.SSS3.p2.2.m2.1.2.1" xref="S2.SS4.SSS3.p2.2.m2.1.2.1.cmml">â¢</mo><mrow id="S2.SS4.SSS3.p2.2.m2.1.2.3.2" xref="S2.SS4.SSS3.p2.2.m2.1.2.cmml"><mo id="S2.SS4.SSS3.p2.2.m2.1.2.3.2.1" stretchy="false" xref="S2.SS4.SSS3.p2.2.m2.1.2.cmml">(</mo><mo id="S2.SS4.SSS3.p2.2.m2.1.1" lspace="0em" rspace="0em" xref="S2.SS4.SSS3.p2.2.m2.1.1.cmml">â‹…</mo><mo id="S2.SS4.SSS3.p2.2.m2.1.2.3.2.2" stretchy="false" xref="S2.SS4.SSS3.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p2.2.m2.1b"><apply id="S2.SS4.SSS3.p2.2.m2.1.2.cmml" xref="S2.SS4.SSS3.p2.2.m2.1.2"><times id="S2.SS4.SSS3.p2.2.m2.1.2.1.cmml" xref="S2.SS4.SSS3.p2.2.m2.1.2.1"></times><ci id="S2.SS4.SSS3.p2.2.m2.1.2.2a.cmml" xref="S2.SS4.SSS3.p2.2.m2.1.2.2"><mtext id="S2.SS4.SSS3.p2.2.m2.1.2.2.cmml" xref="S2.SS4.SSS3.p2.2.m2.1.2.2">LLM4Rec</mtext></ci><ci id="S2.SS4.SSS3.p2.2.m2.1.1.cmml" xref="S2.SS4.SSS3.p2.2.m2.1.1">â‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p2.2.m2.1c">\text{LLM4Rec}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p2.2.m2.1d">LLM4Rec ( â‹… )</annotation></semantics></math> will be projected to a latent representation <math alttext="\mathbf{z}_{i}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p2.3.m3.1"><semantics id="S2.SS4.SSS3.p2.3.m3.1a"><mrow id="S2.SS4.SSS3.p2.3.m3.1.1" xref="S2.SS4.SSS3.p2.3.m3.1.1.cmml"><msub id="S2.SS4.SSS3.p2.3.m3.1.1.2" xref="S2.SS4.SSS3.p2.3.m3.1.1.2.cmml"><mi id="S2.SS4.SSS3.p2.3.m3.1.1.2.2" xref="S2.SS4.SSS3.p2.3.m3.1.1.2.2.cmml">ğ³</mi><mi id="S2.SS4.SSS3.p2.3.m3.1.1.2.3" xref="S2.SS4.SSS3.p2.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="S2.SS4.SSS3.p2.3.m3.1.1.1" xref="S2.SS4.SSS3.p2.3.m3.1.1.1.cmml">âˆˆ</mo><msup id="S2.SS4.SSS3.p2.3.m3.1.1.3" xref="S2.SS4.SSS3.p2.3.m3.1.1.3.cmml"><mi id="S2.SS4.SSS3.p2.3.m3.1.1.3.2" xref="S2.SS4.SSS3.p2.3.m3.1.1.3.2.cmml">â„</mi><mi id="S2.SS4.SSS3.p2.3.m3.1.1.3.3" xref="S2.SS4.SSS3.p2.3.m3.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p2.3.m3.1b"><apply id="S2.SS4.SSS3.p2.3.m3.1.1.cmml" xref="S2.SS4.SSS3.p2.3.m3.1.1"><in id="S2.SS4.SSS3.p2.3.m3.1.1.1.cmml" xref="S2.SS4.SSS3.p2.3.m3.1.1.1"></in><apply id="S2.SS4.SSS3.p2.3.m3.1.1.2.cmml" xref="S2.SS4.SSS3.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.SSS3.p2.3.m3.1.1.2.1.cmml" xref="S2.SS4.SSS3.p2.3.m3.1.1.2">subscript</csymbol><ci id="S2.SS4.SSS3.p2.3.m3.1.1.2.2.cmml" xref="S2.SS4.SSS3.p2.3.m3.1.1.2.2">ğ³</ci><ci id="S2.SS4.SSS3.p2.3.m3.1.1.2.3.cmml" xref="S2.SS4.SSS3.p2.3.m3.1.1.2.3">ğ‘–</ci></apply><apply id="S2.SS4.SSS3.p2.3.m3.1.1.3.cmml" xref="S2.SS4.SSS3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.SSS3.p2.3.m3.1.1.3.1.cmml" xref="S2.SS4.SSS3.p2.3.m3.1.1.3">superscript</csymbol><ci id="S2.SS4.SSS3.p2.3.m3.1.1.3.2.cmml" xref="S2.SS4.SSS3.p2.3.m3.1.1.3.2">â„</ci><ci id="S2.SS4.SSS3.p2.3.m3.1.1.3.3.cmml" xref="S2.SS4.SSS3.p2.3.m3.1.1.3.3">ğ‘‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p2.3.m3.1c">\mathbf{z}_{i}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p2.3.m3.1d">bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> through a projection layer <math alttext="\text{Proj}(\cdot)" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p2.4.m4.1"><semantics id="S2.SS4.SSS3.p2.4.m4.1a"><mrow id="S2.SS4.SSS3.p2.4.m4.1.2" xref="S2.SS4.SSS3.p2.4.m4.1.2.cmml"><mtext id="S2.SS4.SSS3.p2.4.m4.1.2.2" xref="S2.SS4.SSS3.p2.4.m4.1.2.2a.cmml">Proj</mtext><mo id="S2.SS4.SSS3.p2.4.m4.1.2.1" xref="S2.SS4.SSS3.p2.4.m4.1.2.1.cmml">â¢</mo><mrow id="S2.SS4.SSS3.p2.4.m4.1.2.3.2" xref="S2.SS4.SSS3.p2.4.m4.1.2.cmml"><mo id="S2.SS4.SSS3.p2.4.m4.1.2.3.2.1" stretchy="false" xref="S2.SS4.SSS3.p2.4.m4.1.2.cmml">(</mo><mo id="S2.SS4.SSS3.p2.4.m4.1.1" lspace="0em" rspace="0em" xref="S2.SS4.SSS3.p2.4.m4.1.1.cmml">â‹…</mo><mo id="S2.SS4.SSS3.p2.4.m4.1.2.3.2.2" stretchy="false" xref="S2.SS4.SSS3.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p2.4.m4.1b"><apply id="S2.SS4.SSS3.p2.4.m4.1.2.cmml" xref="S2.SS4.SSS3.p2.4.m4.1.2"><times id="S2.SS4.SSS3.p2.4.m4.1.2.1.cmml" xref="S2.SS4.SSS3.p2.4.m4.1.2.1"></times><ci id="S2.SS4.SSS3.p2.4.m4.1.2.2a.cmml" xref="S2.SS4.SSS3.p2.4.m4.1.2.2"><mtext id="S2.SS4.SSS3.p2.4.m4.1.2.2.cmml" xref="S2.SS4.SSS3.p2.4.m4.1.2.2">Proj</mtext></ci><ci id="S2.SS4.SSS3.p2.4.m4.1.1.cmml" xref="S2.SS4.SSS3.p2.4.m4.1.1">â‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p2.4.m4.1c">\text{Proj}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p2.4.m4.1d">Proj ( â‹… )</annotation></semantics></math>, to make the alignment between the LLM-generated representation and item representations learned from GNNs as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx16">
<tbody id="S2.E18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{z}_{i}=\text{Proj}(\mathbf{h}_{i})," class="ltx_Math" display="inline" id="S2.E18.m1.1"><semantics id="S2.E18.m1.1a"><mrow id="S2.E18.m1.1.1.1" xref="S2.E18.m1.1.1.1.1.cmml"><mrow id="S2.E18.m1.1.1.1.1" xref="S2.E18.m1.1.1.1.1.cmml"><msub id="S2.E18.m1.1.1.1.1.3" xref="S2.E18.m1.1.1.1.1.3.cmml"><mi id="S2.E18.m1.1.1.1.1.3.2" xref="S2.E18.m1.1.1.1.1.3.2.cmml">ğ³</mi><mi id="S2.E18.m1.1.1.1.1.3.3" xref="S2.E18.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S2.E18.m1.1.1.1.1.2" xref="S2.E18.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E18.m1.1.1.1.1.1" xref="S2.E18.m1.1.1.1.1.1.cmml"><mtext id="S2.E18.m1.1.1.1.1.1.3" xref="S2.E18.m1.1.1.1.1.1.3a.cmml">Proj</mtext><mo id="S2.E18.m1.1.1.1.1.1.2" xref="S2.E18.m1.1.1.1.1.1.2.cmml">â¢</mo><mrow id="S2.E18.m1.1.1.1.1.1.1.1" xref="S2.E18.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E18.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E18.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E18.m1.1.1.1.1.1.1.1.1" xref="S2.E18.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E18.m1.1.1.1.1.1.1.1.1.2" xref="S2.E18.m1.1.1.1.1.1.1.1.1.2.cmml">ğ¡</mi><mi id="S2.E18.m1.1.1.1.1.1.1.1.1.3" xref="S2.E18.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E18.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E18.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E18.m1.1.1.1.2" xref="S2.E18.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E18.m1.1b"><apply id="S2.E18.m1.1.1.1.1.cmml" xref="S2.E18.m1.1.1.1"><eq id="S2.E18.m1.1.1.1.1.2.cmml" xref="S2.E18.m1.1.1.1.1.2"></eq><apply id="S2.E18.m1.1.1.1.1.3.cmml" xref="S2.E18.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E18.m1.1.1.1.1.3.1.cmml" xref="S2.E18.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.E18.m1.1.1.1.1.3.2.cmml" xref="S2.E18.m1.1.1.1.1.3.2">ğ³</ci><ci id="S2.E18.m1.1.1.1.1.3.3.cmml" xref="S2.E18.m1.1.1.1.1.3.3">ğ‘–</ci></apply><apply id="S2.E18.m1.1.1.1.1.1.cmml" xref="S2.E18.m1.1.1.1.1.1"><times id="S2.E18.m1.1.1.1.1.1.2.cmml" xref="S2.E18.m1.1.1.1.1.1.2"></times><ci id="S2.E18.m1.1.1.1.1.1.3a.cmml" xref="S2.E18.m1.1.1.1.1.1.3"><mtext id="S2.E18.m1.1.1.1.1.1.3.cmml" xref="S2.E18.m1.1.1.1.1.1.3">Proj</mtext></ci><apply id="S2.E18.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E18.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E18.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E18.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E18.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E18.m1.1.1.1.1.1.1.1.1.2">ğ¡</ci><ci id="S2.E18.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E18.m1.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E18.m1.1c">\displaystyle\mathbf{z}_{i}=\text{Proj}(\mathbf{h}_{i}),</annotation><annotation encoding="application/x-llamapun" id="S2.E18.m1.1d">bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = Proj ( bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.SSS3.p2.17">where <math alttext="\text{Proj}(\cdot)" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p2.5.m1.1"><semantics id="S2.SS4.SSS3.p2.5.m1.1a"><mrow id="S2.SS4.SSS3.p2.5.m1.1.2" xref="S2.SS4.SSS3.p2.5.m1.1.2.cmml"><mtext id="S2.SS4.SSS3.p2.5.m1.1.2.2" xref="S2.SS4.SSS3.p2.5.m1.1.2.2a.cmml">Proj</mtext><mo id="S2.SS4.SSS3.p2.5.m1.1.2.1" xref="S2.SS4.SSS3.p2.5.m1.1.2.1.cmml">â¢</mo><mrow id="S2.SS4.SSS3.p2.5.m1.1.2.3.2" xref="S2.SS4.SSS3.p2.5.m1.1.2.cmml"><mo id="S2.SS4.SSS3.p2.5.m1.1.2.3.2.1" stretchy="false" xref="S2.SS4.SSS3.p2.5.m1.1.2.cmml">(</mo><mo id="S2.SS4.SSS3.p2.5.m1.1.1" lspace="0em" rspace="0em" xref="S2.SS4.SSS3.p2.5.m1.1.1.cmml">â‹…</mo><mo id="S2.SS4.SSS3.p2.5.m1.1.2.3.2.2" stretchy="false" xref="S2.SS4.SSS3.p2.5.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p2.5.m1.1b"><apply id="S2.SS4.SSS3.p2.5.m1.1.2.cmml" xref="S2.SS4.SSS3.p2.5.m1.1.2"><times id="S2.SS4.SSS3.p2.5.m1.1.2.1.cmml" xref="S2.SS4.SSS3.p2.5.m1.1.2.1"></times><ci id="S2.SS4.SSS3.p2.5.m1.1.2.2a.cmml" xref="S2.SS4.SSS3.p2.5.m1.1.2.2"><mtext id="S2.SS4.SSS3.p2.5.m1.1.2.2.cmml" xref="S2.SS4.SSS3.p2.5.m1.1.2.2">Proj</mtext></ci><ci id="S2.SS4.SSS3.p2.5.m1.1.1.cmml" xref="S2.SS4.SSS3.p2.5.m1.1.1">â‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p2.5.m1.1c">\text{Proj}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p2.5.m1.1d">Proj ( â‹… )</annotation></semantics></math> can be modeled by a three-layer MLPs.
Note that <math alttext="\mathbf{z}_{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p2.6.m2.1"><semantics id="S2.SS4.SSS3.p2.6.m2.1a"><msub id="S2.SS4.SSS3.p2.6.m2.1.1" xref="S2.SS4.SSS3.p2.6.m2.1.1.cmml"><mi id="S2.SS4.SSS3.p2.6.m2.1.1.2" xref="S2.SS4.SSS3.p2.6.m2.1.1.2.cmml">ğ³</mi><mi id="S2.SS4.SSS3.p2.6.m2.1.1.3" xref="S2.SS4.SSS3.p2.6.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p2.6.m2.1b"><apply id="S2.SS4.SSS3.p2.6.m2.1.1.cmml" xref="S2.SS4.SSS3.p2.6.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS3.p2.6.m2.1.1.1.cmml" xref="S2.SS4.SSS3.p2.6.m2.1.1">subscript</csymbol><ci id="S2.SS4.SSS3.p2.6.m2.1.1.2.cmml" xref="S2.SS4.SSS3.p2.6.m2.1.1.2">ğ³</ci><ci id="S2.SS4.SSS3.p2.6.m2.1.1.3.cmml" xref="S2.SS4.SSS3.p2.6.m2.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p2.6.m2.1c">\mathbf{z}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p2.6.m2.1d">bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> can be considered the generative representation of the next recommended items for user <math alttext="u_{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p2.7.m3.1"><semantics id="S2.SS4.SSS3.p2.7.m3.1a"><msub id="S2.SS4.SSS3.p2.7.m3.1.1" xref="S2.SS4.SSS3.p2.7.m3.1.1.cmml"><mi id="S2.SS4.SSS3.p2.7.m3.1.1.2" xref="S2.SS4.SSS3.p2.7.m3.1.1.2.cmml">u</mi><mi id="S2.SS4.SSS3.p2.7.m3.1.1.3" xref="S2.SS4.SSS3.p2.7.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p2.7.m3.1b"><apply id="S2.SS4.SSS3.p2.7.m3.1.1.cmml" xref="S2.SS4.SSS3.p2.7.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS3.p2.7.m3.1.1.1.cmml" xref="S2.SS4.SSS3.p2.7.m3.1.1">subscript</csymbol><ci id="S2.SS4.SSS3.p2.7.m3.1.1.2.cmml" xref="S2.SS4.SSS3.p2.7.m3.1.1.2">ğ‘¢</ci><ci id="S2.SS4.SSS3.p2.7.m3.1.1.3.cmml" xref="S2.SS4.SSS3.p2.7.m3.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p2.7.m3.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p2.7.m3.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>â€™.
After that, we propose to retrieve the <math alttext="K" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p2.8.m4.1"><semantics id="S2.SS4.SSS3.p2.8.m4.1a"><mi id="S2.SS4.SSS3.p2.8.m4.1.1" xref="S2.SS4.SSS3.p2.8.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p2.8.m4.1b"><ci id="S2.SS4.SSS3.p2.8.m4.1.1.cmml" xref="S2.SS4.SSS3.p2.8.m4.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p2.8.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p2.8.m4.1d">italic_K</annotation></semantics></math>-nearest items from the whole item set <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p2.9.m5.1"><semantics id="S2.SS4.SSS3.p2.9.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS3.p2.9.m5.1.1" xref="S2.SS4.SSS3.p2.9.m5.1.1.cmml">ğ’±</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p2.9.m5.1b"><ci id="S2.SS4.SSS3.p2.9.m5.1.1.cmml" xref="S2.SS4.SSS3.p2.9.m5.1.1">ğ’±</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p2.9.m5.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p2.9.m5.1d">caligraphic_V</annotation></semantics></math> for generating the personalized top-<math alttext="K" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p2.10.m6.1"><semantics id="S2.SS4.SSS3.p2.10.m6.1a"><mi id="S2.SS4.SSS3.p2.10.m6.1.1" xref="S2.SS4.SSS3.p2.10.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p2.10.m6.1b"><ci id="S2.SS4.SSS3.p2.10.m6.1.1.cmml" xref="S2.SS4.SSS3.p2.10.m6.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p2.10.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p2.10.m6.1d">italic_K</annotation></semantics></math> recommendation list.
This can be achieved by measuring the similarity scores between the target userâ€™s generative preference and high-order itemsâ€™ representations from the well-trained GNN-based recommendation method.
For example, the predicted similarity score <math alttext="y_{ij}" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p2.11.m7.1"><semantics id="S2.SS4.SSS3.p2.11.m7.1a"><msub id="S2.SS4.SSS3.p2.11.m7.1.1" xref="S2.SS4.SSS3.p2.11.m7.1.1.cmml"><mi id="S2.SS4.SSS3.p2.11.m7.1.1.2" xref="S2.SS4.SSS3.p2.11.m7.1.1.2.cmml">y</mi><mrow id="S2.SS4.SSS3.p2.11.m7.1.1.3" xref="S2.SS4.SSS3.p2.11.m7.1.1.3.cmml"><mi id="S2.SS4.SSS3.p2.11.m7.1.1.3.2" xref="S2.SS4.SSS3.p2.11.m7.1.1.3.2.cmml">i</mi><mo id="S2.SS4.SSS3.p2.11.m7.1.1.3.1" xref="S2.SS4.SSS3.p2.11.m7.1.1.3.1.cmml">â¢</mo><mi id="S2.SS4.SSS3.p2.11.m7.1.1.3.3" xref="S2.SS4.SSS3.p2.11.m7.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p2.11.m7.1b"><apply id="S2.SS4.SSS3.p2.11.m7.1.1.cmml" xref="S2.SS4.SSS3.p2.11.m7.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS3.p2.11.m7.1.1.1.cmml" xref="S2.SS4.SSS3.p2.11.m7.1.1">subscript</csymbol><ci id="S2.SS4.SSS3.p2.11.m7.1.1.2.cmml" xref="S2.SS4.SSS3.p2.11.m7.1.1.2">ğ‘¦</ci><apply id="S2.SS4.SSS3.p2.11.m7.1.1.3.cmml" xref="S2.SS4.SSS3.p2.11.m7.1.1.3"><times id="S2.SS4.SSS3.p2.11.m7.1.1.3.1.cmml" xref="S2.SS4.SSS3.p2.11.m7.1.1.3.1"></times><ci id="S2.SS4.SSS3.p2.11.m7.1.1.3.2.cmml" xref="S2.SS4.SSS3.p2.11.m7.1.1.3.2">ğ‘–</ci><ci id="S2.SS4.SSS3.p2.11.m7.1.1.3.3.cmml" xref="S2.SS4.SSS3.p2.11.m7.1.1.3.3">ğ‘—</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p2.11.m7.1c">y_{ij}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p2.11.m7.1d">italic_y start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> of user <math alttext="u_{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p2.12.m8.1"><semantics id="S2.SS4.SSS3.p2.12.m8.1a"><msub id="S2.SS4.SSS3.p2.12.m8.1.1" xref="S2.SS4.SSS3.p2.12.m8.1.1.cmml"><mi id="S2.SS4.SSS3.p2.12.m8.1.1.2" xref="S2.SS4.SSS3.p2.12.m8.1.1.2.cmml">u</mi><mi id="S2.SS4.SSS3.p2.12.m8.1.1.3" xref="S2.SS4.SSS3.p2.12.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p2.12.m8.1b"><apply id="S2.SS4.SSS3.p2.12.m8.1.1.cmml" xref="S2.SS4.SSS3.p2.12.m8.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS3.p2.12.m8.1.1.1.cmml" xref="S2.SS4.SSS3.p2.12.m8.1.1">subscript</csymbol><ci id="S2.SS4.SSS3.p2.12.m8.1.1.2.cmml" xref="S2.SS4.SSS3.p2.12.m8.1.1.2">ğ‘¢</ci><ci id="S2.SS4.SSS3.p2.12.m8.1.1.3.cmml" xref="S2.SS4.SSS3.p2.12.m8.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p2.12.m8.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p2.12.m8.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> towards item <math alttext="v_{j}" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p2.13.m9.1"><semantics id="S2.SS4.SSS3.p2.13.m9.1a"><msub id="S2.SS4.SSS3.p2.13.m9.1.1" xref="S2.SS4.SSS3.p2.13.m9.1.1.cmml"><mi id="S2.SS4.SSS3.p2.13.m9.1.1.2" xref="S2.SS4.SSS3.p2.13.m9.1.1.2.cmml">v</mi><mi id="S2.SS4.SSS3.p2.13.m9.1.1.3" xref="S2.SS4.SSS3.p2.13.m9.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p2.13.m9.1b"><apply id="S2.SS4.SSS3.p2.13.m9.1.1.cmml" xref="S2.SS4.SSS3.p2.13.m9.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS3.p2.13.m9.1.1.1.cmml" xref="S2.SS4.SSS3.p2.13.m9.1.1">subscript</csymbol><ci id="S2.SS4.SSS3.p2.13.m9.1.1.2.cmml" xref="S2.SS4.SSS3.p2.13.m9.1.1.2">ğ‘£</ci><ci id="S2.SS4.SSS3.p2.13.m9.1.1.3.cmml" xref="S2.SS4.SSS3.p2.13.m9.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p2.13.m9.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p2.13.m9.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> can be calculated by a matching function (e.g., cosine similarity) between user <math alttext="u_{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p2.14.m10.1"><semantics id="S2.SS4.SSS3.p2.14.m10.1a"><msub id="S2.SS4.SSS3.p2.14.m10.1.1" xref="S2.SS4.SSS3.p2.14.m10.1.1.cmml"><mi id="S2.SS4.SSS3.p2.14.m10.1.1.2" xref="S2.SS4.SSS3.p2.14.m10.1.1.2.cmml">u</mi><mi id="S2.SS4.SSS3.p2.14.m10.1.1.3" xref="S2.SS4.SSS3.p2.14.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p2.14.m10.1b"><apply id="S2.SS4.SSS3.p2.14.m10.1.1.cmml" xref="S2.SS4.SSS3.p2.14.m10.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS3.p2.14.m10.1.1.1.cmml" xref="S2.SS4.SSS3.p2.14.m10.1.1">subscript</csymbol><ci id="S2.SS4.SSS3.p2.14.m10.1.1.2.cmml" xref="S2.SS4.SSS3.p2.14.m10.1.1.2">ğ‘¢</ci><ci id="S2.SS4.SSS3.p2.14.m10.1.1.3.cmml" xref="S2.SS4.SSS3.p2.14.m10.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p2.14.m10.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p2.14.m10.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>â€™s generative item representation <math alttext="\mathbf{z}_{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p2.15.m11.1"><semantics id="S2.SS4.SSS3.p2.15.m11.1a"><msub id="S2.SS4.SSS3.p2.15.m11.1.1" xref="S2.SS4.SSS3.p2.15.m11.1.1.cmml"><mi id="S2.SS4.SSS3.p2.15.m11.1.1.2" xref="S2.SS4.SSS3.p2.15.m11.1.1.2.cmml">ğ³</mi><mi id="S2.SS4.SSS3.p2.15.m11.1.1.3" xref="S2.SS4.SSS3.p2.15.m11.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p2.15.m11.1b"><apply id="S2.SS4.SSS3.p2.15.m11.1.1.cmml" xref="S2.SS4.SSS3.p2.15.m11.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS3.p2.15.m11.1.1.1.cmml" xref="S2.SS4.SSS3.p2.15.m11.1.1">subscript</csymbol><ci id="S2.SS4.SSS3.p2.15.m11.1.1.2.cmml" xref="S2.SS4.SSS3.p2.15.m11.1.1.2">ğ³</ci><ci id="S2.SS4.SSS3.p2.15.m11.1.1.3.cmml" xref="S2.SS4.SSS3.p2.15.m11.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p2.15.m11.1c">\mathbf{z}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p2.15.m11.1d">bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and GNN-based itemâ€™s <math alttext="v_{j}" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p2.16.m12.1"><semantics id="S2.SS4.SSS3.p2.16.m12.1a"><msub id="S2.SS4.SSS3.p2.16.m12.1.1" xref="S2.SS4.SSS3.p2.16.m12.1.1.cmml"><mi id="S2.SS4.SSS3.p2.16.m12.1.1.2" xref="S2.SS4.SSS3.p2.16.m12.1.1.2.cmml">v</mi><mi id="S2.SS4.SSS3.p2.16.m12.1.1.3" xref="S2.SS4.SSS3.p2.16.m12.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p2.16.m12.1b"><apply id="S2.SS4.SSS3.p2.16.m12.1.1.cmml" xref="S2.SS4.SSS3.p2.16.m12.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS3.p2.16.m12.1.1.1.cmml" xref="S2.SS4.SSS3.p2.16.m12.1.1">subscript</csymbol><ci id="S2.SS4.SSS3.p2.16.m12.1.1.2.cmml" xref="S2.SS4.SSS3.p2.16.m12.1.1.2">ğ‘£</ci><ci id="S2.SS4.SSS3.p2.16.m12.1.1.3.cmml" xref="S2.SS4.SSS3.p2.16.m12.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p2.16.m12.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p2.16.m12.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> representation <math alttext="\mathbf{q}_{j}" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p2.17.m13.1"><semantics id="S2.SS4.SSS3.p2.17.m13.1a"><msub id="S2.SS4.SSS3.p2.17.m13.1.1" xref="S2.SS4.SSS3.p2.17.m13.1.1.cmml"><mi id="S2.SS4.SSS3.p2.17.m13.1.1.2" xref="S2.SS4.SSS3.p2.17.m13.1.1.2.cmml">ğª</mi><mi id="S2.SS4.SSS3.p2.17.m13.1.1.3" xref="S2.SS4.SSS3.p2.17.m13.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p2.17.m13.1b"><apply id="S2.SS4.SSS3.p2.17.m13.1.1.cmml" xref="S2.SS4.SSS3.p2.17.m13.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS3.p2.17.m13.1.1.1.cmml" xref="S2.SS4.SSS3.p2.17.m13.1.1">subscript</csymbol><ci id="S2.SS4.SSS3.p2.17.m13.1.1.2.cmml" xref="S2.SS4.SSS3.p2.17.m13.1.1.2">ğª</ci><ci id="S2.SS4.SSS3.p2.17.m13.1.1.3.cmml" xref="S2.SS4.SSS3.p2.17.m13.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p2.17.m13.1c">\mathbf{q}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p2.17.m13.1d">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> which is stored in a vector database:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx17">
<tbody id="S2.E19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle y_{ij}=\frac{\mathbf{z}_{i}\mathbf{q}_{j}}{\|\mathbf{z}_{i}\|\|%
\mathbf{q}_{j}\|}." class="ltx_Math" display="inline" id="S2.E19.m1.3"><semantics id="S2.E19.m1.3a"><mrow id="S2.E19.m1.3.3.1" xref="S2.E19.m1.3.3.1.1.cmml"><mrow id="S2.E19.m1.3.3.1.1" xref="S2.E19.m1.3.3.1.1.cmml"><msub id="S2.E19.m1.3.3.1.1.2" xref="S2.E19.m1.3.3.1.1.2.cmml"><mi id="S2.E19.m1.3.3.1.1.2.2" xref="S2.E19.m1.3.3.1.1.2.2.cmml">y</mi><mrow id="S2.E19.m1.3.3.1.1.2.3" xref="S2.E19.m1.3.3.1.1.2.3.cmml"><mi id="S2.E19.m1.3.3.1.1.2.3.2" xref="S2.E19.m1.3.3.1.1.2.3.2.cmml">i</mi><mo id="S2.E19.m1.3.3.1.1.2.3.1" xref="S2.E19.m1.3.3.1.1.2.3.1.cmml">â¢</mo><mi id="S2.E19.m1.3.3.1.1.2.3.3" xref="S2.E19.m1.3.3.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.E19.m1.3.3.1.1.1" xref="S2.E19.m1.3.3.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S2.E19.m1.2.2" xref="S2.E19.m1.2.2.cmml"><mfrac id="S2.E19.m1.2.2a" xref="S2.E19.m1.2.2.cmml"><mrow id="S2.E19.m1.2.2.4" xref="S2.E19.m1.2.2.4.cmml"><msub id="S2.E19.m1.2.2.4.2" xref="S2.E19.m1.2.2.4.2.cmml"><mi id="S2.E19.m1.2.2.4.2.2" xref="S2.E19.m1.2.2.4.2.2.cmml">ğ³</mi><mi id="S2.E19.m1.2.2.4.2.3" xref="S2.E19.m1.2.2.4.2.3.cmml">i</mi></msub><mo id="S2.E19.m1.2.2.4.1" xref="S2.E19.m1.2.2.4.1.cmml">â¢</mo><msub id="S2.E19.m1.2.2.4.3" xref="S2.E19.m1.2.2.4.3.cmml"><mi id="S2.E19.m1.2.2.4.3.2" xref="S2.E19.m1.2.2.4.3.2.cmml">ğª</mi><mi id="S2.E19.m1.2.2.4.3.3" xref="S2.E19.m1.2.2.4.3.3.cmml">j</mi></msub></mrow><mrow id="S2.E19.m1.2.2.2" xref="S2.E19.m1.2.2.2.cmml"><mrow id="S2.E19.m1.1.1.1.1.1" xref="S2.E19.m1.1.1.1.1.2.cmml"><mo id="S2.E19.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E19.m1.1.1.1.1.2.1.cmml">â€–</mo><msub id="S2.E19.m1.1.1.1.1.1.1" xref="S2.E19.m1.1.1.1.1.1.1.cmml"><mi id="S2.E19.m1.1.1.1.1.1.1.2" xref="S2.E19.m1.1.1.1.1.1.1.2.cmml">ğ³</mi><mi id="S2.E19.m1.1.1.1.1.1.1.3" xref="S2.E19.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E19.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E19.m1.1.1.1.1.2.1.cmml">â€–</mo></mrow><mo id="S2.E19.m1.2.2.2.3" xref="S2.E19.m1.2.2.2.3.cmml">â¢</mo><mrow id="S2.E19.m1.2.2.2.2.1" xref="S2.E19.m1.2.2.2.2.2.cmml"><mo id="S2.E19.m1.2.2.2.2.1.2" stretchy="false" xref="S2.E19.m1.2.2.2.2.2.1.cmml">â€–</mo><msub id="S2.E19.m1.2.2.2.2.1.1" xref="S2.E19.m1.2.2.2.2.1.1.cmml"><mi id="S2.E19.m1.2.2.2.2.1.1.2" xref="S2.E19.m1.2.2.2.2.1.1.2.cmml">ğª</mi><mi id="S2.E19.m1.2.2.2.2.1.1.3" xref="S2.E19.m1.2.2.2.2.1.1.3.cmml">j</mi></msub><mo id="S2.E19.m1.2.2.2.2.1.3" stretchy="false" xref="S2.E19.m1.2.2.2.2.2.1.cmml">â€–</mo></mrow></mrow></mfrac></mstyle></mrow><mo id="S2.E19.m1.3.3.1.2" lspace="0em" xref="S2.E19.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E19.m1.3b"><apply id="S2.E19.m1.3.3.1.1.cmml" xref="S2.E19.m1.3.3.1"><eq id="S2.E19.m1.3.3.1.1.1.cmml" xref="S2.E19.m1.3.3.1.1.1"></eq><apply id="S2.E19.m1.3.3.1.1.2.cmml" xref="S2.E19.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E19.m1.3.3.1.1.2.1.cmml" xref="S2.E19.m1.3.3.1.1.2">subscript</csymbol><ci id="S2.E19.m1.3.3.1.1.2.2.cmml" xref="S2.E19.m1.3.3.1.1.2.2">ğ‘¦</ci><apply id="S2.E19.m1.3.3.1.1.2.3.cmml" xref="S2.E19.m1.3.3.1.1.2.3"><times id="S2.E19.m1.3.3.1.1.2.3.1.cmml" xref="S2.E19.m1.3.3.1.1.2.3.1"></times><ci id="S2.E19.m1.3.3.1.1.2.3.2.cmml" xref="S2.E19.m1.3.3.1.1.2.3.2">ğ‘–</ci><ci id="S2.E19.m1.3.3.1.1.2.3.3.cmml" xref="S2.E19.m1.3.3.1.1.2.3.3">ğ‘—</ci></apply></apply><apply id="S2.E19.m1.2.2.cmml" xref="S2.E19.m1.2.2"><divide id="S2.E19.m1.2.2.3.cmml" xref="S2.E19.m1.2.2"></divide><apply id="S2.E19.m1.2.2.4.cmml" xref="S2.E19.m1.2.2.4"><times id="S2.E19.m1.2.2.4.1.cmml" xref="S2.E19.m1.2.2.4.1"></times><apply id="S2.E19.m1.2.2.4.2.cmml" xref="S2.E19.m1.2.2.4.2"><csymbol cd="ambiguous" id="S2.E19.m1.2.2.4.2.1.cmml" xref="S2.E19.m1.2.2.4.2">subscript</csymbol><ci id="S2.E19.m1.2.2.4.2.2.cmml" xref="S2.E19.m1.2.2.4.2.2">ğ³</ci><ci id="S2.E19.m1.2.2.4.2.3.cmml" xref="S2.E19.m1.2.2.4.2.3">ğ‘–</ci></apply><apply id="S2.E19.m1.2.2.4.3.cmml" xref="S2.E19.m1.2.2.4.3"><csymbol cd="ambiguous" id="S2.E19.m1.2.2.4.3.1.cmml" xref="S2.E19.m1.2.2.4.3">subscript</csymbol><ci id="S2.E19.m1.2.2.4.3.2.cmml" xref="S2.E19.m1.2.2.4.3.2">ğª</ci><ci id="S2.E19.m1.2.2.4.3.3.cmml" xref="S2.E19.m1.2.2.4.3.3">ğ‘—</ci></apply></apply><apply id="S2.E19.m1.2.2.2.cmml" xref="S2.E19.m1.2.2.2"><times id="S2.E19.m1.2.2.2.3.cmml" xref="S2.E19.m1.2.2.2.3"></times><apply id="S2.E19.m1.1.1.1.1.2.cmml" xref="S2.E19.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E19.m1.1.1.1.1.2.1.cmml" xref="S2.E19.m1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E19.m1.1.1.1.1.1.1.cmml" xref="S2.E19.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E19.m1.1.1.1.1.1.1.1.cmml" xref="S2.E19.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E19.m1.1.1.1.1.1.1.2.cmml" xref="S2.E19.m1.1.1.1.1.1.1.2">ğ³</ci><ci id="S2.E19.m1.1.1.1.1.1.1.3.cmml" xref="S2.E19.m1.1.1.1.1.1.1.3">ğ‘–</ci></apply></apply><apply id="S2.E19.m1.2.2.2.2.2.cmml" xref="S2.E19.m1.2.2.2.2.1"><csymbol cd="latexml" id="S2.E19.m1.2.2.2.2.2.1.cmml" xref="S2.E19.m1.2.2.2.2.1.2">norm</csymbol><apply id="S2.E19.m1.2.2.2.2.1.1.cmml" xref="S2.E19.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E19.m1.2.2.2.2.1.1.1.cmml" xref="S2.E19.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S2.E19.m1.2.2.2.2.1.1.2.cmml" xref="S2.E19.m1.2.2.2.2.1.1.2">ğª</ci><ci id="S2.E19.m1.2.2.2.2.1.1.3.cmml" xref="S2.E19.m1.2.2.2.2.1.1.3">ğ‘—</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E19.m1.3c">\displaystyle y_{ij}=\frac{\mathbf{z}_{i}\mathbf{q}_{j}}{\|\mathbf{z}_{i}\|\|%
\mathbf{q}_{j}\|}.</annotation><annotation encoding="application/x-llamapun" id="S2.E19.m1.3d">italic_y start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = divide start_ARG bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG âˆ¥ bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ¥ âˆ¥ bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT âˆ¥ end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS4.SSS3.p3">
<p class="ltx_p" id="S2.SS4.SSS3.p3.2">Given the scores of all items in the item base, the proposed TokenRec can easily retrieve top-<math alttext="K" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p3.1.m1.1"><semantics id="S2.SS4.SSS3.p3.1.m1.1a"><mi id="S2.SS4.SSS3.p3.1.m1.1.1" xref="S2.SS4.SSS3.p3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p3.1.m1.1b"><ci id="S2.SS4.SSS3.p3.1.m1.1.1.cmml" xref="S2.SS4.SSS3.p3.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p3.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p3.1.m1.1d">italic_K</annotation></semantics></math> items for users rather than directly generating tokens in natural language, thus offering advantages in terms of efficiency in inference and avoiding hallucinations.
Furthermore, unseen items in the fine-tuning stage can be retrieved by only updating the item representations pool <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p3.2.m2.1"><semantics id="S2.SS4.SSS3.p3.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS3.p3.2.m2.1.1" xref="S2.SS4.SSS3.p3.2.m2.1.1.cmml">ğ’±</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p3.2.m2.1b"><ci id="S2.SS4.SSS3.p3.2.m2.1.1.cmml" xref="S2.SS4.SSS3.p3.2.m2.1.1">ğ’±</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p3.2.m2.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p3.2.m2.1d">caligraphic_V</annotation></semantics></math> instead of retraining the entire LLM model.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS5.4.1.1">II-E</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS5.5.2">TokenRecâ€™s Training and Inference </span>
</h3>
<section class="ltx_subsubsection" id="S2.SS5.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S2.SS5.SSS1.4.1.1">II-E</span>1 </span><span class="ltx_text ltx_font_bold" id="S2.SS5.SSS1.5.2">Training</span>
</h4>
<div class="ltx_para" id="S2.SS5.SSS1.p1">
<p class="ltx_p" id="S2.SS5.SSS1.p1.1">Technically, the proposed MQ-Tokenizer is responsible for incorporating high-order collaborative knowledge into ID tokenization, while the LLM4Rec backbone is used to capture user preferences and generate the list of items for recommendations.
One straightforward approach is to update these two components jointly.
However, the large gap between quantization and language processing makes it difficult to achieve updates synchronously.
Here, we first train MQ-Tokenizers for users/items and then freeze the well-trained MQ-Tokenizers components to guide the tuning process of our LLM backbone.
More specifically, our training process is as follows:</p>
<ul class="ltx_itemize" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.2"><span class="ltx_text ltx_font_bold" id="S2.I1.i1.p1.2.1">Step 1. Training Users&amp;Items MQ-Tokenizers</span>.
In order to learn users&amp;items ID tokenization, our initial focus lies in training MQ-Tokenizers to quantize the collaborative representations for users and items independently.
Specifically, we use the combined losses as given in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.E13" title="In II-C5 Learning Objective â€£ II-C Masked Vector-Quantized Tokenizers for Users and Items â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">13</span></a>) and Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.E14" title="In II-C5 Learning Objective â€£ II-C Masked Vector-Quantized Tokenizers for Users and Items â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">14</span></a>) to train the MQ-Tokenizers for items <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S2.I1.i1.p1.1.m1.1"><semantics id="S2.I1.i1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i1.p1.1.m1.1.1" xref="S2.I1.i1.p1.1.m1.1.1.cmml">ğ’±</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.1.m1.1b"><ci id="S2.I1.i1.p1.1.m1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1">ğ’±</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.1.m1.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.1.m1.1d">caligraphic_V</annotation></semantics></math> and users <math alttext="\mathcal{U}" class="ltx_Math" display="inline" id="S2.I1.i1.p1.2.m2.1"><semantics id="S2.I1.i1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i1.p1.2.m2.1.1" xref="S2.I1.i1.p1.2.m2.1.1.cmml">ğ’°</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.2.m2.1b"><ci id="S2.I1.i1.p1.2.m2.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1">ğ’°</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.2.m2.1c">\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.2.m2.1d">caligraphic_U</annotation></semantics></math>, separately.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.5"><span class="ltx_text ltx_font_bold" id="S2.I1.i2.p1.5.1">Step 2. Tuning the LLM4Rec for Generative Retrieval</span>.
In this step, we tune the LLM backbone (e.g., T5), LLM token embeddings, and the projection layer for generative retrieval recommendations while keeping the MQ-Tokenizers frozen.
More specifically, the objective of generative retrieval is to identify potential items from the whole item pool,
such that top-<math alttext="K" class="ltx_Math" display="inline" id="S2.I1.i2.p1.1.m1.1"><semantics id="S2.I1.i2.p1.1.m1.1a"><mi id="S2.I1.i2.p1.1.m1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.1.m1.1b"><ci id="S2.I1.i2.p1.1.m1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.1.m1.1d">italic_K</annotation></semantics></math> ranked items are relevant to the specific query (i.e., generative item representations of users).
To achieve such an objective, a general solution is to perform metric learning by predicting the relative similarity or distance based on the dense representations between inputsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib28" title="">28</a>]</cite>.
In other words, the proposed TokenRec aims to perform the nearest neighbor retrieval, achieved by calculating ranking scores between the userâ€™s generative item representation and collaborative item representations learned from GNNs, so as to retrieve top-<math alttext="K" class="ltx_Math" display="inline" id="S2.I1.i2.p1.2.m2.1"><semantics id="S2.I1.i2.p1.2.m2.1a"><mi id="S2.I1.i2.p1.2.m2.1.1" xref="S2.I1.i2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.2.m2.1b"><ci id="S2.I1.i2.p1.2.m2.1.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.2.m2.1d">italic_K</annotation></semantics></math> next items to the target user for personalized recommendations.
Mathematically, we utilize a pairwise ranking loss for our tuning process, which encourages the query closer to the positive set (i.e., when <math alttext="\lambda=1" class="ltx_Math" display="inline" id="S2.I1.i2.p1.3.m3.1"><semantics id="S2.I1.i2.p1.3.m3.1a"><mrow id="S2.I1.i2.p1.3.m3.1.1" xref="S2.I1.i2.p1.3.m3.1.1.cmml"><mi id="S2.I1.i2.p1.3.m3.1.1.2" xref="S2.I1.i2.p1.3.m3.1.1.2.cmml">Î»</mi><mo id="S2.I1.i2.p1.3.m3.1.1.1" xref="S2.I1.i2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S2.I1.i2.p1.3.m3.1.1.3" xref="S2.I1.i2.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.3.m3.1b"><apply id="S2.I1.i2.p1.3.m3.1.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1"><eq id="S2.I1.i2.p1.3.m3.1.1.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1"></eq><ci id="S2.I1.i2.p1.3.m3.1.1.2.cmml" xref="S2.I1.i2.p1.3.m3.1.1.2">ğœ†</ci><cn id="S2.I1.i2.p1.3.m3.1.1.3.cmml" type="integer" xref="S2.I1.i2.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.3.m3.1c">\lambda=1</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.3.m3.1d">italic_Î» = 1</annotation></semantics></math>) than to the negative set by a fixed margin <math alttext="\gamma" class="ltx_Math" display="inline" id="S2.I1.i2.p1.4.m4.1"><semantics id="S2.I1.i2.p1.4.m4.1a"><mi id="S2.I1.i2.p1.4.m4.1.1" xref="S2.I1.i2.p1.4.m4.1.1.cmml">Î³</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.4.m4.1b"><ci id="S2.I1.i2.p1.4.m4.1.1.cmml" xref="S2.I1.i2.p1.4.m4.1.1">ğ›¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.4.m4.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.4.m4.1d">italic_Î³</annotation></semantics></math> (i.e., when <math alttext="\lambda=-1" class="ltx_Math" display="inline" id="S2.I1.i2.p1.5.m5.1"><semantics id="S2.I1.i2.p1.5.m5.1a"><mrow id="S2.I1.i2.p1.5.m5.1.1" xref="S2.I1.i2.p1.5.m5.1.1.cmml"><mi id="S2.I1.i2.p1.5.m5.1.1.2" xref="S2.I1.i2.p1.5.m5.1.1.2.cmml">Î»</mi><mo id="S2.I1.i2.p1.5.m5.1.1.1" xref="S2.I1.i2.p1.5.m5.1.1.1.cmml">=</mo><mrow id="S2.I1.i2.p1.5.m5.1.1.3" xref="S2.I1.i2.p1.5.m5.1.1.3.cmml"><mo id="S2.I1.i2.p1.5.m5.1.1.3a" xref="S2.I1.i2.p1.5.m5.1.1.3.cmml">âˆ’</mo><mn id="S2.I1.i2.p1.5.m5.1.1.3.2" xref="S2.I1.i2.p1.5.m5.1.1.3.2.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.5.m5.1b"><apply id="S2.I1.i2.p1.5.m5.1.1.cmml" xref="S2.I1.i2.p1.5.m5.1.1"><eq id="S2.I1.i2.p1.5.m5.1.1.1.cmml" xref="S2.I1.i2.p1.5.m5.1.1.1"></eq><ci id="S2.I1.i2.p1.5.m5.1.1.2.cmml" xref="S2.I1.i2.p1.5.m5.1.1.2">ğœ†</ci><apply id="S2.I1.i2.p1.5.m5.1.1.3.cmml" xref="S2.I1.i2.p1.5.m5.1.1.3"><minus id="S2.I1.i2.p1.5.m5.1.1.3.1.cmml" xref="S2.I1.i2.p1.5.m5.1.1.3"></minus><cn id="S2.I1.i2.p1.5.m5.1.1.3.2.cmml" type="integer" xref="S2.I1.i2.p1.5.m5.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.5.m5.1c">\lambda=-1</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.5.m5.1d">italic_Î» = - 1</annotation></semantics></math>) as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx18">
<tbody id="S2.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{LLM4Rec}}=\begin{cases}1-\text{sim}(\mathbf{z}%
_{i},\mathbf{q}_{j}),&amp;\text{if}\ \lambda=1\\
\max(0,\text{sim}(\mathbf{z}_{i},\mathbf{q}_{j})-\gamma),&amp;\text{if}\ \lambda=-%
1\end{cases}" class="ltx_Math" display="inline" id="S2.E20.m1.4"><semantics id="S2.E20.m1.4a"><mrow id="S2.E20.m1.4.5" xref="S2.E20.m1.4.5.cmml"><msub id="S2.E20.m1.4.5.2" xref="S2.E20.m1.4.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E20.m1.4.5.2.2" xref="S2.E20.m1.4.5.2.2.cmml">â„’</mi><mtext id="S2.E20.m1.4.5.2.3" xref="S2.E20.m1.4.5.2.3a.cmml">LLM4Rec</mtext></msub><mo id="S2.E20.m1.4.5.1" xref="S2.E20.m1.4.5.1.cmml">=</mo><mrow id="S2.E20.m1.4.4a" xref="S2.E20.m1.4.5.3.1.cmml"><mo id="S2.E20.m1.4.4a.5" xref="S2.E20.m1.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" id="S2.E20.m1.4.4.4a" rowspacing="0pt" xref="S2.E20.m1.4.5.3.1.cmml"><mtr id="S2.E20.m1.4.4.4aa" xref="S2.E20.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E20.m1.4.4.4ab" xref="S2.E20.m1.4.5.3.1.cmml"><mrow id="S2.E20.m1.1.1.1.1.1.1.1" xref="S2.E20.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E20.m1.1.1.1.1.1.1.1.1" xref="S2.E20.m1.1.1.1.1.1.1.1.1.cmml"><mn id="S2.E20.m1.1.1.1.1.1.1.1.1.4" xref="S2.E20.m1.1.1.1.1.1.1.1.1.4.cmml">1</mn><mo id="S2.E20.m1.1.1.1.1.1.1.1.1.3" xref="S2.E20.m1.1.1.1.1.1.1.1.1.3.cmml">âˆ’</mo><mrow id="S2.E20.m1.1.1.1.1.1.1.1.1.2" xref="S2.E20.m1.1.1.1.1.1.1.1.1.2.cmml"><mtext id="S2.E20.m1.1.1.1.1.1.1.1.1.2.4" xref="S2.E20.m1.1.1.1.1.1.1.1.1.2.4a.cmml">sim</mtext><mo id="S2.E20.m1.1.1.1.1.1.1.1.1.2.3" xref="S2.E20.m1.1.1.1.1.1.1.1.1.2.3.cmml">â¢</mo><mrow id="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mo id="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S2.E20.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E20.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E20.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E20.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">ğ³</mi><mi id="S2.E20.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E20.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.2.4" xref="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">ğª</mi><mi id="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">j</mi></msub><mo id="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.2.5" stretchy="false" xref="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E20.m1.1.1.1.1.1.1.1.2" xref="S2.E20.m1.1.1.1.1.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E20.m1.4.4.4ac" xref="S2.E20.m1.4.5.3.1.cmml"><mrow id="S2.E20.m1.2.2.2.2.2.1" xref="S2.E20.m1.2.2.2.2.2.1.cmml"><mrow id="S2.E20.m1.2.2.2.2.2.1.2" xref="S2.E20.m1.2.2.2.2.2.1.2.cmml"><mtext id="S2.E20.m1.2.2.2.2.2.1.2.2" xref="S2.E20.m1.2.2.2.2.2.1.2.2a.cmml">if</mtext><mo id="S2.E20.m1.2.2.2.2.2.1.2.1" lspace="0.500em" xref="S2.E20.m1.2.2.2.2.2.1.2.1.cmml">â¢</mo><mi id="S2.E20.m1.2.2.2.2.2.1.2.3" xref="S2.E20.m1.2.2.2.2.2.1.2.3.cmml">Î»</mi></mrow><mo id="S2.E20.m1.2.2.2.2.2.1.1" xref="S2.E20.m1.2.2.2.2.2.1.1.cmml">=</mo><mn id="S2.E20.m1.2.2.2.2.2.1.3" xref="S2.E20.m1.2.2.2.2.2.1.3.cmml">1</mn></mrow></mtd></mtr><mtr id="S2.E20.m1.4.4.4ad" xref="S2.E20.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E20.m1.4.4.4ae" xref="S2.E20.m1.4.5.3.1.cmml"><mrow id="S2.E20.m1.3.3.3.3.1.1.3" xref="S2.E20.m1.4.5.3.1.cmml"><mrow id="S2.E20.m1.3.3.3.3.1.1.3.1.1" xref="S2.E20.m1.3.3.3.3.1.1.3.1.2.cmml"><mi id="S2.E20.m1.3.3.3.3.1.1.1" xref="S2.E20.m1.3.3.3.3.1.1.1.cmml">max</mi><mo id="S2.E20.m1.3.3.3.3.1.1.3.1.1a" xref="S2.E20.m1.3.3.3.3.1.1.3.1.2.cmml">â¡</mo><mrow id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1" xref="S2.E20.m1.3.3.3.3.1.1.3.1.2.cmml"><mo id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.2" stretchy="false" xref="S2.E20.m1.3.3.3.3.1.1.3.1.2.cmml">(</mo><mn id="S2.E20.m1.3.3.3.3.1.1.2" xref="S2.E20.m1.3.3.3.3.1.1.2.cmml">0</mn><mo id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.3" xref="S2.E20.m1.3.3.3.3.1.1.3.1.2.cmml">,</mo><mrow id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.cmml"><mrow id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.cmml"><mtext id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.4" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.4a.cmml">sim</mtext><mo id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.3" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.3.cmml">â¢</mo><mrow id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.2" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.3.cmml"><mo id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.2.3" stretchy="false" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.3.cmml">(</mo><msub id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.1.1.1.1" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.1.1.1.1.2" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.1.1.1.1.2.cmml">ğ³</mi><mi id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.1.1.1.1.3" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.2.4" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.3.cmml">,</mo><msub id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.2.2" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.2.2.2" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.2.2.2.cmml">ğª</mi><mi id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.2.2.3" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.2.2.3.cmml">j</mi></msub><mo id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.2.5" stretchy="false" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.cmml">âˆ’</mo><mi id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.4" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.4.cmml">Î³</mi></mrow><mo id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.4" stretchy="false" xref="S2.E20.m1.3.3.3.3.1.1.3.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E20.m1.3.3.3.3.1.1.3.2" xref="S2.E20.m1.4.5.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E20.m1.4.4.4af" xref="S2.E20.m1.4.5.3.1.cmml"><mrow id="S2.E20.m1.4.4.4.4.2.1" xref="S2.E20.m1.4.4.4.4.2.1.cmml"><mrow id="S2.E20.m1.4.4.4.4.2.1.2" xref="S2.E20.m1.4.4.4.4.2.1.2.cmml"><mtext id="S2.E20.m1.4.4.4.4.2.1.2.2" xref="S2.E20.m1.4.4.4.4.2.1.2.2a.cmml">if</mtext><mo id="S2.E20.m1.4.4.4.4.2.1.2.1" lspace="0.500em" xref="S2.E20.m1.4.4.4.4.2.1.2.1.cmml">â¢</mo><mi id="S2.E20.m1.4.4.4.4.2.1.2.3" xref="S2.E20.m1.4.4.4.4.2.1.2.3.cmml">Î»</mi></mrow><mo id="S2.E20.m1.4.4.4.4.2.1.1" xref="S2.E20.m1.4.4.4.4.2.1.1.cmml">=</mo><mrow id="S2.E20.m1.4.4.4.4.2.1.3" xref="S2.E20.m1.4.4.4.4.2.1.3.cmml"><mo id="S2.E20.m1.4.4.4.4.2.1.3a" xref="S2.E20.m1.4.4.4.4.2.1.3.cmml">âˆ’</mo><mn id="S2.E20.m1.4.4.4.4.2.1.3.2" xref="S2.E20.m1.4.4.4.4.2.1.3.2.cmml">1</mn></mrow></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E20.m1.4b"><apply id="S2.E20.m1.4.5.cmml" xref="S2.E20.m1.4.5"><eq id="S2.E20.m1.4.5.1.cmml" xref="S2.E20.m1.4.5.1"></eq><apply id="S2.E20.m1.4.5.2.cmml" xref="S2.E20.m1.4.5.2"><csymbol cd="ambiguous" id="S2.E20.m1.4.5.2.1.cmml" xref="S2.E20.m1.4.5.2">subscript</csymbol><ci id="S2.E20.m1.4.5.2.2.cmml" xref="S2.E20.m1.4.5.2.2">â„’</ci><ci id="S2.E20.m1.4.5.2.3a.cmml" xref="S2.E20.m1.4.5.2.3"><mtext id="S2.E20.m1.4.5.2.3.cmml" mathsize="70%" xref="S2.E20.m1.4.5.2.3">LLM4Rec</mtext></ci></apply><apply id="S2.E20.m1.4.5.3.1.cmml" xref="S2.E20.m1.4.4a"><csymbol cd="latexml" id="S2.E20.m1.4.5.3.1.1.cmml" xref="S2.E20.m1.4.4a.5">cases</csymbol><apply id="S2.E20.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E20.m1.1.1.1.1.1.1.1"><minus id="S2.E20.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E20.m1.1.1.1.1.1.1.1.1.3"></minus><cn id="S2.E20.m1.1.1.1.1.1.1.1.1.4.cmml" type="integer" xref="S2.E20.m1.1.1.1.1.1.1.1.1.4">1</cn><apply id="S2.E20.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E20.m1.1.1.1.1.1.1.1.1.2"><times id="S2.E20.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E20.m1.1.1.1.1.1.1.1.1.2.3"></times><ci id="S2.E20.m1.1.1.1.1.1.1.1.1.2.4a.cmml" xref="S2.E20.m1.1.1.1.1.1.1.1.1.2.4"><mtext id="S2.E20.m1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S2.E20.m1.1.1.1.1.1.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.2"><apply id="S2.E20.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E20.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E20.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E20.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E20.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E20.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">ğ³</ci><ci id="S2.E20.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E20.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.2.2.2">ğª</ci><ci id="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E20.m1.1.1.1.1.1.1.1.1.2.2.2.2.3">ğ‘—</ci></apply></interval></apply></apply><apply id="S2.E20.m1.2.2.2.2.2.1.cmml" xref="S2.E20.m1.2.2.2.2.2.1"><eq id="S2.E20.m1.2.2.2.2.2.1.1.cmml" xref="S2.E20.m1.2.2.2.2.2.1.1"></eq><apply id="S2.E20.m1.2.2.2.2.2.1.2.cmml" xref="S2.E20.m1.2.2.2.2.2.1.2"><times id="S2.E20.m1.2.2.2.2.2.1.2.1.cmml" xref="S2.E20.m1.2.2.2.2.2.1.2.1"></times><ci id="S2.E20.m1.2.2.2.2.2.1.2.2a.cmml" xref="S2.E20.m1.2.2.2.2.2.1.2.2"><mtext id="S2.E20.m1.2.2.2.2.2.1.2.2.cmml" xref="S2.E20.m1.2.2.2.2.2.1.2.2">if</mtext></ci><ci id="S2.E20.m1.2.2.2.2.2.1.2.3.cmml" xref="S2.E20.m1.2.2.2.2.2.1.2.3">ğœ†</ci></apply><cn id="S2.E20.m1.2.2.2.2.2.1.3.cmml" type="integer" xref="S2.E20.m1.2.2.2.2.2.1.3">1</cn></apply><apply id="S2.E20.m1.3.3.3.3.1.1.3.1.2.cmml" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1"><max id="S2.E20.m1.3.3.3.3.1.1.1.cmml" xref="S2.E20.m1.3.3.3.3.1.1.1"></max><cn id="S2.E20.m1.3.3.3.3.1.1.2.cmml" type="integer" xref="S2.E20.m1.3.3.3.3.1.1.2">0</cn><apply id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.cmml" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1"><minus id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.cmml" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3"></minus><apply id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.cmml" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2"><times id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.3.cmml" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.3"></times><ci id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.4a.cmml" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.4"><mtext id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.4.cmml" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.3.cmml" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.2"><apply id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.1.1.1.1.2">ğ³</ci><ci id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.2.2.cmml" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.2.2.2">ğª</ci><ci id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.2.2.2.3">ğ‘—</ci></apply></interval></apply><ci id="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.4.cmml" xref="S2.E20.m1.3.3.3.3.1.1.3.1.1.1.1.4">ğ›¾</ci></apply></apply><apply id="S2.E20.m1.4.4.4.4.2.1.cmml" xref="S2.E20.m1.4.4.4.4.2.1"><eq id="S2.E20.m1.4.4.4.4.2.1.1.cmml" xref="S2.E20.m1.4.4.4.4.2.1.1"></eq><apply id="S2.E20.m1.4.4.4.4.2.1.2.cmml" xref="S2.E20.m1.4.4.4.4.2.1.2"><times id="S2.E20.m1.4.4.4.4.2.1.2.1.cmml" xref="S2.E20.m1.4.4.4.4.2.1.2.1"></times><ci id="S2.E20.m1.4.4.4.4.2.1.2.2a.cmml" xref="S2.E20.m1.4.4.4.4.2.1.2.2"><mtext id="S2.E20.m1.4.4.4.4.2.1.2.2.cmml" xref="S2.E20.m1.4.4.4.4.2.1.2.2">if</mtext></ci><ci id="S2.E20.m1.4.4.4.4.2.1.2.3.cmml" xref="S2.E20.m1.4.4.4.4.2.1.2.3">ğœ†</ci></apply><apply id="S2.E20.m1.4.4.4.4.2.1.3.cmml" xref="S2.E20.m1.4.4.4.4.2.1.3"><minus id="S2.E20.m1.4.4.4.4.2.1.3.1.cmml" xref="S2.E20.m1.4.4.4.4.2.1.3"></minus><cn id="S2.E20.m1.4.4.4.4.2.1.3.2.cmml" type="integer" xref="S2.E20.m1.4.4.4.4.2.1.3.2">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E20.m1.4c">\displaystyle\mathcal{L}_{\text{LLM4Rec}}=\begin{cases}1-\text{sim}(\mathbf{z}%
_{i},\mathbf{q}_{j}),&amp;\text{if}\ \lambda=1\\
\max(0,\text{sim}(\mathbf{z}_{i},\mathbf{q}_{j})-\gamma),&amp;\text{if}\ \lambda=-%
1\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S2.E20.m1.4d">caligraphic_L start_POSTSUBSCRIPT LLM4Rec end_POSTSUBSCRIPT = { start_ROW start_CELL 1 - sim ( bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) , end_CELL start_CELL if italic_Î» = 1 end_CELL end_ROW start_ROW start_CELL roman_max ( 0 , sim ( bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) - italic_Î³ ) , end_CELL start_CELL if italic_Î» = - 1 end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.I1.i2.p1.22">where <math alttext="\mathbf{z}_{i}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.6.m1.1"><semantics id="S2.I1.i2.p1.6.m1.1a"><msub id="S2.I1.i2.p1.6.m1.1.1" xref="S2.I1.i2.p1.6.m1.1.1.cmml"><mi id="S2.I1.i2.p1.6.m1.1.1.2" xref="S2.I1.i2.p1.6.m1.1.1.2.cmml">ğ³</mi><mi id="S2.I1.i2.p1.6.m1.1.1.3" xref="S2.I1.i2.p1.6.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.6.m1.1b"><apply id="S2.I1.i2.p1.6.m1.1.1.cmml" xref="S2.I1.i2.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.6.m1.1.1.1.cmml" xref="S2.I1.i2.p1.6.m1.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.6.m1.1.1.2.cmml" xref="S2.I1.i2.p1.6.m1.1.1.2">ğ³</ci><ci id="S2.I1.i2.p1.6.m1.1.1.3.cmml" xref="S2.I1.i2.p1.6.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.6.m1.1c">\mathbf{z}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.6.m1.1d">bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{q}_{j}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.7.m2.1"><semantics id="S2.I1.i2.p1.7.m2.1a"><msub id="S2.I1.i2.p1.7.m2.1.1" xref="S2.I1.i2.p1.7.m2.1.1.cmml"><mi id="S2.I1.i2.p1.7.m2.1.1.2" xref="S2.I1.i2.p1.7.m2.1.1.2.cmml">ğª</mi><mi id="S2.I1.i2.p1.7.m2.1.1.3" xref="S2.I1.i2.p1.7.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.7.m2.1b"><apply id="S2.I1.i2.p1.7.m2.1.1.cmml" xref="S2.I1.i2.p1.7.m2.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.7.m2.1.1.1.cmml" xref="S2.I1.i2.p1.7.m2.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.7.m2.1.1.2.cmml" xref="S2.I1.i2.p1.7.m2.1.1.2">ğª</ci><ci id="S2.I1.i2.p1.7.m2.1.1.3.cmml" xref="S2.I1.i2.p1.7.m2.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.7.m2.1c">\mathbf{q}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.7.m2.1d">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> denote the generative item representation of user <math alttext="u_{i}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.8.m3.1"><semantics id="S2.I1.i2.p1.8.m3.1a"><msub id="S2.I1.i2.p1.8.m3.1.1" xref="S2.I1.i2.p1.8.m3.1.1.cmml"><mi id="S2.I1.i2.p1.8.m3.1.1.2" xref="S2.I1.i2.p1.8.m3.1.1.2.cmml">u</mi><mi id="S2.I1.i2.p1.8.m3.1.1.3" xref="S2.I1.i2.p1.8.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.8.m3.1b"><apply id="S2.I1.i2.p1.8.m3.1.1.cmml" xref="S2.I1.i2.p1.8.m3.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.8.m3.1.1.1.cmml" xref="S2.I1.i2.p1.8.m3.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.8.m3.1.1.2.cmml" xref="S2.I1.i2.p1.8.m3.1.1.2">ğ‘¢</ci><ci id="S2.I1.i2.p1.8.m3.1.1.3.cmml" xref="S2.I1.i2.p1.8.m3.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.8.m3.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.8.m3.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and the collaborative representation of item <math alttext="v_{j}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.9.m4.1"><semantics id="S2.I1.i2.p1.9.m4.1a"><msub id="S2.I1.i2.p1.9.m4.1.1" xref="S2.I1.i2.p1.9.m4.1.1.cmml"><mi id="S2.I1.i2.p1.9.m4.1.1.2" xref="S2.I1.i2.p1.9.m4.1.1.2.cmml">v</mi><mi id="S2.I1.i2.p1.9.m4.1.1.3" xref="S2.I1.i2.p1.9.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.9.m4.1b"><apply id="S2.I1.i2.p1.9.m4.1.1.cmml" xref="S2.I1.i2.p1.9.m4.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.9.m4.1.1.1.cmml" xref="S2.I1.i2.p1.9.m4.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.9.m4.1.1.2.cmml" xref="S2.I1.i2.p1.9.m4.1.1.2">ğ‘£</ci><ci id="S2.I1.i2.p1.9.m4.1.1.3.cmml" xref="S2.I1.i2.p1.9.m4.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.9.m4.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.9.m4.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, respectively.
<math alttext="\text{sim}(\cdot,\cdot)" class="ltx_Math" display="inline" id="S2.I1.i2.p1.10.m5.2"><semantics id="S2.I1.i2.p1.10.m5.2a"><mrow id="S2.I1.i2.p1.10.m5.2.3" xref="S2.I1.i2.p1.10.m5.2.3.cmml"><mtext id="S2.I1.i2.p1.10.m5.2.3.2" xref="S2.I1.i2.p1.10.m5.2.3.2a.cmml">sim</mtext><mo id="S2.I1.i2.p1.10.m5.2.3.1" xref="S2.I1.i2.p1.10.m5.2.3.1.cmml">â¢</mo><mrow id="S2.I1.i2.p1.10.m5.2.3.3.2" xref="S2.I1.i2.p1.10.m5.2.3.3.1.cmml"><mo id="S2.I1.i2.p1.10.m5.2.3.3.2.1" stretchy="false" xref="S2.I1.i2.p1.10.m5.2.3.3.1.cmml">(</mo><mo id="S2.I1.i2.p1.10.m5.1.1" lspace="0em" rspace="0em" xref="S2.I1.i2.p1.10.m5.1.1.cmml">â‹…</mo><mo id="S2.I1.i2.p1.10.m5.2.3.3.2.2" rspace="0em" xref="S2.I1.i2.p1.10.m5.2.3.3.1.cmml">,</mo><mo id="S2.I1.i2.p1.10.m5.2.2" lspace="0em" rspace="0em" xref="S2.I1.i2.p1.10.m5.2.2.cmml">â‹…</mo><mo id="S2.I1.i2.p1.10.m5.2.3.3.2.3" stretchy="false" xref="S2.I1.i2.p1.10.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.10.m5.2b"><apply id="S2.I1.i2.p1.10.m5.2.3.cmml" xref="S2.I1.i2.p1.10.m5.2.3"><times id="S2.I1.i2.p1.10.m5.2.3.1.cmml" xref="S2.I1.i2.p1.10.m5.2.3.1"></times><ci id="S2.I1.i2.p1.10.m5.2.3.2a.cmml" xref="S2.I1.i2.p1.10.m5.2.3.2"><mtext id="S2.I1.i2.p1.10.m5.2.3.2.cmml" xref="S2.I1.i2.p1.10.m5.2.3.2">sim</mtext></ci><interval closure="open" id="S2.I1.i2.p1.10.m5.2.3.3.1.cmml" xref="S2.I1.i2.p1.10.m5.2.3.3.2"><ci id="S2.I1.i2.p1.10.m5.1.1.cmml" xref="S2.I1.i2.p1.10.m5.1.1">â‹…</ci><ci id="S2.I1.i2.p1.10.m5.2.2.cmml" xref="S2.I1.i2.p1.10.m5.2.2">â‹…</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.10.m5.2c">\text{sim}(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.10.m5.2d">sim ( â‹… , â‹… )</annotation></semantics></math> is a metric function to measure the similarity between dense representations, such as cosine similarity.
<math alttext="\lambda" class="ltx_Math" display="inline" id="S2.I1.i2.p1.11.m6.1"><semantics id="S2.I1.i2.p1.11.m6.1a"><mi id="S2.I1.i2.p1.11.m6.1.1" xref="S2.I1.i2.p1.11.m6.1.1.cmml">Î»</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.11.m6.1b"><ci id="S2.I1.i2.p1.11.m6.1.1.cmml" xref="S2.I1.i2.p1.11.m6.1.1">ğœ†</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.11.m6.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.11.m6.1d">italic_Î»</annotation></semantics></math> indicates whether user <math alttext="u_{i}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.12.m7.1"><semantics id="S2.I1.i2.p1.12.m7.1a"><msub id="S2.I1.i2.p1.12.m7.1.1" xref="S2.I1.i2.p1.12.m7.1.1.cmml"><mi id="S2.I1.i2.p1.12.m7.1.1.2" xref="S2.I1.i2.p1.12.m7.1.1.2.cmml">u</mi><mi id="S2.I1.i2.p1.12.m7.1.1.3" xref="S2.I1.i2.p1.12.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.12.m7.1b"><apply id="S2.I1.i2.p1.12.m7.1.1.cmml" xref="S2.I1.i2.p1.12.m7.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.12.m7.1.1.1.cmml" xref="S2.I1.i2.p1.12.m7.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.12.m7.1.1.2.cmml" xref="S2.I1.i2.p1.12.m7.1.1.2">ğ‘¢</ci><ci id="S2.I1.i2.p1.12.m7.1.1.3.cmml" xref="S2.I1.i2.p1.12.m7.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.12.m7.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.12.m7.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> has interacted with item <math alttext="v_{j}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.13.m8.1"><semantics id="S2.I1.i2.p1.13.m8.1a"><msub id="S2.I1.i2.p1.13.m8.1.1" xref="S2.I1.i2.p1.13.m8.1.1.cmml"><mi id="S2.I1.i2.p1.13.m8.1.1.2" xref="S2.I1.i2.p1.13.m8.1.1.2.cmml">v</mi><mi id="S2.I1.i2.p1.13.m8.1.1.3" xref="S2.I1.i2.p1.13.m8.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.13.m8.1b"><apply id="S2.I1.i2.p1.13.m8.1.1.cmml" xref="S2.I1.i2.p1.13.m8.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.13.m8.1.1.1.cmml" xref="S2.I1.i2.p1.13.m8.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.13.m8.1.1.2.cmml" xref="S2.I1.i2.p1.13.m8.1.1.2">ğ‘£</ci><ci id="S2.I1.i2.p1.13.m8.1.1.3.cmml" xref="S2.I1.i2.p1.13.m8.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.13.m8.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.13.m8.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.
Moreover, <math alttext="\gamma" class="ltx_Math" display="inline" id="S2.I1.i2.p1.14.m9.1"><semantics id="S2.I1.i2.p1.14.m9.1a"><mi id="S2.I1.i2.p1.14.m9.1.1" xref="S2.I1.i2.p1.14.m9.1.1.cmml">Î³</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.14.m9.1b"><ci id="S2.I1.i2.p1.14.m9.1.1.cmml" xref="S2.I1.i2.p1.14.m9.1.1">ğ›¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.14.m9.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.14.m9.1d">italic_Î³</annotation></semantics></math> is the margin value for negative pairs.
It ensures that when the representations of a negative pair are already adequately distant, there is no need to expend additional effort in increasing the distance between them.
This mechanism allows more focused training on pairs that are more challenging for recommendations.
More specifically, we use cosine similarity as the metric function to maximize the similarity between user <math alttext="u_{i}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.15.m10.1"><semantics id="S2.I1.i2.p1.15.m10.1a"><msub id="S2.I1.i2.p1.15.m10.1.1" xref="S2.I1.i2.p1.15.m10.1.1.cmml"><mi id="S2.I1.i2.p1.15.m10.1.1.2" xref="S2.I1.i2.p1.15.m10.1.1.2.cmml">u</mi><mi id="S2.I1.i2.p1.15.m10.1.1.3" xref="S2.I1.i2.p1.15.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.15.m10.1b"><apply id="S2.I1.i2.p1.15.m10.1.1.cmml" xref="S2.I1.i2.p1.15.m10.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.15.m10.1.1.1.cmml" xref="S2.I1.i2.p1.15.m10.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.15.m10.1.1.2.cmml" xref="S2.I1.i2.p1.15.m10.1.1.2">ğ‘¢</ci><ci id="S2.I1.i2.p1.15.m10.1.1.3.cmml" xref="S2.I1.i2.p1.15.m10.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.15.m10.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.15.m10.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>â€™ s generative representation <math alttext="\mathbf{z}_{i}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.16.m11.1"><semantics id="S2.I1.i2.p1.16.m11.1a"><msub id="S2.I1.i2.p1.16.m11.1.1" xref="S2.I1.i2.p1.16.m11.1.1.cmml"><mi id="S2.I1.i2.p1.16.m11.1.1.2" xref="S2.I1.i2.p1.16.m11.1.1.2.cmml">ğ³</mi><mi id="S2.I1.i2.p1.16.m11.1.1.3" xref="S2.I1.i2.p1.16.m11.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.16.m11.1b"><apply id="S2.I1.i2.p1.16.m11.1.1.cmml" xref="S2.I1.i2.p1.16.m11.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.16.m11.1.1.1.cmml" xref="S2.I1.i2.p1.16.m11.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.16.m11.1.1.2.cmml" xref="S2.I1.i2.p1.16.m11.1.1.2">ğ³</ci><ci id="S2.I1.i2.p1.16.m11.1.1.3.cmml" xref="S2.I1.i2.p1.16.m11.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.16.m11.1c">\mathbf{z}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.16.m11.1d">bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> of next item and the <em class="ltx_emph ltx_font_italic" id="S2.I1.i2.p1.17.1">positive item <math alttext="v_{j}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.17.1.m1.1"><semantics id="S2.I1.i2.p1.17.1.m1.1a"><msub id="S2.I1.i2.p1.17.1.m1.1.1" xref="S2.I1.i2.p1.17.1.m1.1.1.cmml"><mi id="S2.I1.i2.p1.17.1.m1.1.1.2" xref="S2.I1.i2.p1.17.1.m1.1.1.2.cmml">v</mi><mi id="S2.I1.i2.p1.17.1.m1.1.1.3" xref="S2.I1.i2.p1.17.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.17.1.m1.1b"><apply id="S2.I1.i2.p1.17.1.m1.1.1.cmml" xref="S2.I1.i2.p1.17.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.17.1.m1.1.1.1.cmml" xref="S2.I1.i2.p1.17.1.m1.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.17.1.m1.1.1.2.cmml" xref="S2.I1.i2.p1.17.1.m1.1.1.2">ğ‘£</ci><ci id="S2.I1.i2.p1.17.1.m1.1.1.3.cmml" xref="S2.I1.i2.p1.17.1.m1.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.17.1.m1.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.17.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> representation</em> <math alttext="\mathbf{q}_{j}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.18.m12.1"><semantics id="S2.I1.i2.p1.18.m12.1a"><msub id="S2.I1.i2.p1.18.m12.1.1" xref="S2.I1.i2.p1.18.m12.1.1.cmml"><mi id="S2.I1.i2.p1.18.m12.1.1.2" xref="S2.I1.i2.p1.18.m12.1.1.2.cmml">ğª</mi><mi id="S2.I1.i2.p1.18.m12.1.1.3" xref="S2.I1.i2.p1.18.m12.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.18.m12.1b"><apply id="S2.I1.i2.p1.18.m12.1.1.cmml" xref="S2.I1.i2.p1.18.m12.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.18.m12.1.1.1.cmml" xref="S2.I1.i2.p1.18.m12.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.18.m12.1.1.2.cmml" xref="S2.I1.i2.p1.18.m12.1.1.2">ğª</ci><ci id="S2.I1.i2.p1.18.m12.1.1.3.cmml" xref="S2.I1.i2.p1.18.m12.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.18.m12.1c">\mathbf{q}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.18.m12.1d">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> (i.e., item <math alttext="v_{j}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.19.m13.1"><semantics id="S2.I1.i2.p1.19.m13.1a"><msub id="S2.I1.i2.p1.19.m13.1.1" xref="S2.I1.i2.p1.19.m13.1.1.cmml"><mi id="S2.I1.i2.p1.19.m13.1.1.2" xref="S2.I1.i2.p1.19.m13.1.1.2.cmml">v</mi><mi id="S2.I1.i2.p1.19.m13.1.1.3" xref="S2.I1.i2.p1.19.m13.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.19.m13.1b"><apply id="S2.I1.i2.p1.19.m13.1.1.cmml" xref="S2.I1.i2.p1.19.m13.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.19.m13.1.1.1.cmml" xref="S2.I1.i2.p1.19.m13.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.19.m13.1.1.2.cmml" xref="S2.I1.i2.p1.19.m13.1.1.2">ğ‘£</ci><ci id="S2.I1.i2.p1.19.m13.1.1.3.cmml" xref="S2.I1.i2.p1.19.m13.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.19.m13.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.19.m13.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> in user <math alttext="u_{i}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.20.m14.1"><semantics id="S2.I1.i2.p1.20.m14.1a"><msub id="S2.I1.i2.p1.20.m14.1.1" xref="S2.I1.i2.p1.20.m14.1.1.cmml"><mi id="S2.I1.i2.p1.20.m14.1.1.2" xref="S2.I1.i2.p1.20.m14.1.1.2.cmml">u</mi><mi id="S2.I1.i2.p1.20.m14.1.1.3" xref="S2.I1.i2.p1.20.m14.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.20.m14.1b"><apply id="S2.I1.i2.p1.20.m14.1.1.cmml" xref="S2.I1.i2.p1.20.m14.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.20.m14.1.1.1.cmml" xref="S2.I1.i2.p1.20.m14.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.20.m14.1.1.2.cmml" xref="S2.I1.i2.p1.20.m14.1.1.2">ğ‘¢</ci><ci id="S2.I1.i2.p1.20.m14.1.1.3.cmml" xref="S2.I1.i2.p1.20.m14.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.20.m14.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.20.m14.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>â€™s historical interactions) when <math alttext="\lambda=1" class="ltx_Math" display="inline" id="S2.I1.i2.p1.21.m15.1"><semantics id="S2.I1.i2.p1.21.m15.1a"><mrow id="S2.I1.i2.p1.21.m15.1.1" xref="S2.I1.i2.p1.21.m15.1.1.cmml"><mi id="S2.I1.i2.p1.21.m15.1.1.2" xref="S2.I1.i2.p1.21.m15.1.1.2.cmml">Î»</mi><mo id="S2.I1.i2.p1.21.m15.1.1.1" xref="S2.I1.i2.p1.21.m15.1.1.1.cmml">=</mo><mn id="S2.I1.i2.p1.21.m15.1.1.3" xref="S2.I1.i2.p1.21.m15.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.21.m15.1b"><apply id="S2.I1.i2.p1.21.m15.1.1.cmml" xref="S2.I1.i2.p1.21.m15.1.1"><eq id="S2.I1.i2.p1.21.m15.1.1.1.cmml" xref="S2.I1.i2.p1.21.m15.1.1.1"></eq><ci id="S2.I1.i2.p1.21.m15.1.1.2.cmml" xref="S2.I1.i2.p1.21.m15.1.1.2">ğœ†</ci><cn id="S2.I1.i2.p1.21.m15.1.1.3.cmml" type="integer" xref="S2.I1.i2.p1.21.m15.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.21.m15.1c">\lambda=1</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.21.m15.1d">italic_Î» = 1</annotation></semantics></math>, while <math alttext="\lambda=-1" class="ltx_Math" display="inline" id="S2.I1.i2.p1.22.m16.1"><semantics id="S2.I1.i2.p1.22.m16.1a"><mrow id="S2.I1.i2.p1.22.m16.1.1" xref="S2.I1.i2.p1.22.m16.1.1.cmml"><mi id="S2.I1.i2.p1.22.m16.1.1.2" xref="S2.I1.i2.p1.22.m16.1.1.2.cmml">Î»</mi><mo id="S2.I1.i2.p1.22.m16.1.1.1" xref="S2.I1.i2.p1.22.m16.1.1.1.cmml">=</mo><mrow id="S2.I1.i2.p1.22.m16.1.1.3" xref="S2.I1.i2.p1.22.m16.1.1.3.cmml"><mo id="S2.I1.i2.p1.22.m16.1.1.3a" xref="S2.I1.i2.p1.22.m16.1.1.3.cmml">âˆ’</mo><mn id="S2.I1.i2.p1.22.m16.1.1.3.2" xref="S2.I1.i2.p1.22.m16.1.1.3.2.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.22.m16.1b"><apply id="S2.I1.i2.p1.22.m16.1.1.cmml" xref="S2.I1.i2.p1.22.m16.1.1"><eq id="S2.I1.i2.p1.22.m16.1.1.1.cmml" xref="S2.I1.i2.p1.22.m16.1.1.1"></eq><ci id="S2.I1.i2.p1.22.m16.1.1.2.cmml" xref="S2.I1.i2.p1.22.m16.1.1.2">ğœ†</ci><apply id="S2.I1.i2.p1.22.m16.1.1.3.cmml" xref="S2.I1.i2.p1.22.m16.1.1.3"><minus id="S2.I1.i2.p1.22.m16.1.1.3.1.cmml" xref="S2.I1.i2.p1.22.m16.1.1.3"></minus><cn id="S2.I1.i2.p1.22.m16.1.1.3.2.cmml" type="integer" xref="S2.I1.i2.p1.22.m16.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.22.m16.1c">\lambda=-1</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.22.m16.1d">italic_Î» = - 1</annotation></semantics></math> otherwise.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_figure" id="S2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="480" id="S2.F3.g1" src="x3.png" width="822"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The TokenRecâ€™s efficiency and generalization capability for new users and items during the inference stage.
Rather than retraining the entire model, which can be computationally expensive and time-consuming, only the GNN needs to be updated for learning representations for new users and items while keeping the MQ-Tokenizers and LLM backbone frozen.
This significantly reduces the computational burden and allows faster adaptation to new users and items.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S2.SS5.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S2.SS5.SSS2.4.1.1">II-E</span>2 </span><span class="ltx_text ltx_font_bold" id="S2.SS5.SSS2.5.2">Inference</span>
</h4>
<div class="ltx_para" id="S2.SS5.SSS2.p1">
<p class="ltx_p" id="S2.SS5.SSS2.p1.1">The typical inference of LLMs refers to the process of generating target tokens.
It suffers from laborious generation and insufficient modeling for unseen users and items.
By utilizing the generative retrieval framework, our inference process overcomes these challenges in an efficient way.
Specifically, the advantages of our proposed method can be summarized as follows:</p>
<ul class="ltx_itemize" id="S2.I2">
<li class="ltx_item" id="S2.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S2.I2.i1.p1">
<p class="ltx_p" id="S2.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I2.i1.p1.1.1">Efficient Recommendations</span>. TokenRec proposes a novel LLM-empowered collaborative recommendation framework in generative retrieval paradigms, bypassing the time-consuming decoding process.
In particular, the proposed LLM-based recommendation framework aims to output generative item representation and retrieve appropriate items for collaborative recommendations instead of a sequence of discrete tokens (e.g., item titles). This contributes to reducing the considerable computing cost of online RecSys. The efficiency evaluation can be found in SectionÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.SS4" title="III-D Efficiency Evaluation â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-D</span></span></a> and TableÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.T5" title="TABLE V â€£ III-D Efficiency Evaluation â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">V</span></a>.</p>
</div>
</li>
<li class="ltx_item" id="S2.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S2.I2.i2.p1">
<p class="ltx_p" id="S2.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I2.i2.p1.1.1">Generalizability to New Users and Items</span>.
The proposed architecture can provide robust ID tokenization for unseen users and items without fine-tuning the LLM4Rec component.
As shown in FigureÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.F3" title="Figure 3 â€£ II-E1 Training â€£ II-E TokenRecâ€™s Training and Inference â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">3</span></a>, when new users and items are added to the system, retraining is only required for the collaborative filtering component (e.g., MF and LightGCN) to capture collaborative knowledge in learning representations of these users and items (i.e., updating vector database).
In contrast, the MQ-Tokenizers and LLM backbone can remain frozen and perform well, thanks to the masking and <math alttext="K" class="ltx_Math" display="inline" id="S2.I2.i2.p1.1.m1.1"><semantics id="S2.I2.i2.p1.1.m1.1a"><mi id="S2.I2.i2.p1.1.m1.1.1" xref="S2.I2.i2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.I2.i2.p1.1.m1.1b"><ci id="S2.I2.i2.p1.1.m1.1.1.cmml" xref="S2.I2.i2.p1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I2.i2.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.I2.i2.p1.1.m1.1d">italic_K</annotation></semantics></math>-way encoder mechanisms in vector quantization.
This eliminates the need for retraining LLM-related components and therefore saves huge computational resources: compared to the finetuning of LLMs, the training of GNNs is far more efficientÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib29" title="">29</a>]</cite>.
Notably, the capability to adapt to new users and items is demonstrated in SectionÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.SS3" title="III-C Generalizability Evaluation â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-C</span></span></a> and TableÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.T4" title="TABLE IV â€£ III-C Generalizability Evaluation â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">IV</span></a>.</p>
</div>
</li>
<li class="ltx_item" id="S2.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S2.I2.i3.p1">
<p class="ltx_p" id="S2.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I2.i3.p1.1.1">Concise Prompts</span>. TokenRec provides an inference alternative that relies solely on user ID tokens, e.g., Prompt 1 in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.SS4.SSS1" title="II-D1 Tokenization&amp;Prompts â€£ II-D Generative Retrieval for Recommendations â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">II-D</span>1</span></a>, for LLM-based recommendation generation.
This is made possible by incorporating the collaborative knowledge of users into user ID tokens through our MQ-Tokenizer.
By doing so, TokenRec eliminates the necessity of including interacted items in inputs, thus reducing significant computing resources during inference.
Additionally, this mechanism proves advantageous when dealing with users who have interacted with a large number of items, effectively avoiding the prevalent issue of context length limitation of many LLMs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib31" title="">31</a>]</cite>, e.g., 512 tokens in T5Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib32" title="">32</a>]</cite> and 2048 tokens in ChatGPT.
The recommendation performance using user ID tokens only for model input can be observed in TableÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.T2" title="TABLE II â€£ III-A4 Hyper-parameter Settings â€£ III-A Experimental Settings â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">II</span></a> and TableÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.T3" title="TABLE III â€£ III-A4 Hyper-parameter Settings â€£ III-A Experimental Settings â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">III</span></a>.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">Experiment</span>
</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS1.4.1.1">III-A</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS1.5.2">Experimental Settings</span>
</h3>
<section class="ltx_subsubsection" id="S3.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS1.SSS1.4.1.1">III-A</span>1 </span><span class="ltx_text ltx_font_bold" id="S3.SS1.SSS1.5.2">Datasets</span>
</h4>
<div class="ltx_para" id="S3.SS1.SSS1.p1">
<p class="ltx_p" id="S3.SS1.SSS1.p1.1">To demonstrate the effectiveness of the proposed method, we conduct comprehensive experiments over four benchmark datasets: Amazon-Beauty (Beauty for short), Amazon-Clothing (Clothing for short), LastFM, and MovieLens 1M (ML1M for short).
The first two datasets<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><span class="ltx_ERROR undefined" id="footnote2.1">\url</span>https://nijianmo.github.io/amazon/</span></span></span> are obtained from the <em class="ltx_emph ltx_font_italic" id="S3.SS1.SSS1.p1.1.1">amazon.com</em> e-commerce platform, encompassing a broad spectrum of user interactions with Beauty and Clothing products.
The LastFM<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><span class="ltx_ERROR undefined" id="footnote3.1">\url</span>https://grouplens.org/datasets/hetrec-2011/</span></span></span> dataset provides music artist listening records from users at the Last.fm online music system.
The ML1M<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><span class="ltx_ERROR undefined" id="footnote4.1">\url</span>https://grouplens.org/datasets/movielens/1m/</span></span></span> dataset offers a collection of movie ratings made by MovieLens users.
TableÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.T1" title="TABLE I â€£ III-A1 Datasets â€£ III-A Experimental Settings â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">I</span></a> shows the statistics of these four datasets, where the maximum item sequence length is set to 100 to accommodate the input length of the LLM backbone T5 (512 tokens).
Moreover, our training-validation-testing combination follows the leave-one-out policyÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib10" title="">10</a>]</cite>, i.e., using all but the last observation in usersâ€™ interaction history as the training set.
Last but not least, we randomly shuffle usersâ€™ interaction history to provide a non-chronological item list to align with the settings of collaborative filtering methods.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Basic statistics of benchmark datasets.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T1.1" style="width:491.2pt;height:111.6pt;vertical-align:-3.6pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1.0,1.0) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S3.T1.1.1.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.1.1">Datasets</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="S3.T1.1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.2.1">User-Item Interaction</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.1.2.2.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.2.1.1">#Users</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.1.2.2.2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.2.2.1">#Items</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.1.2.2.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.2.3.1">#Interactions</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.2.2.4"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.2.4.1">Density (%)</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.1.1.3.3.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.3.3.1.1">LastFM</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.1.3.3.2">1,090</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.1.3.3.3">3,646</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.1.3.3.4">37,080</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.3.3.5">0.9330</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.1.4.4.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.4.4.1.1">ML1M</span></th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.1.4.4.2">3,416</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.1.4.4.3">6,040</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.1.4.4.4">447,294</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.4.5">2.1679</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.1.5.5.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.5.5.1.1">Beauty</span></th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.1.5.5.2">22,363</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.1.5.5.3">12,101</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.1.5.5.4">197,861</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.5.5">0.0731</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S3.T1.1.1.6.6.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.6.6.1.1">Clothing</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.1.1.6.6.2">23,033</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.1.1.6.6.3">39,387</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.1.1.6.6.4">278,641</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.6.6.5">0.0307</td>
</tr>
</tbody>
</table>
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1"><span class="ltx_text" id="S3.I1.i1.p1.1.1" style="font-size:80%;"># represents the number of users, items, and interactions.</span></p>
</div>
</li>
</ul>
</span></div>
</figure>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS1.SSS2.4.1.1">III-A</span>2 </span><span class="ltx_text ltx_font_bold" id="S3.SS1.SSS2.5.2">Baselines</span>
</h4>
<div class="ltx_para" id="S3.SS1.SSS2.p1">
<p class="ltx_p" id="S3.SS1.SSS2.p1.1">Here, we compare our approach with four representative collaborative filtering methods (i.e., MF, NeuCF, LightGCN, GTN, and LTGNN), three widely-used sequential recommendation methods (i.e., SASRec, BERT4Rec, and S<sup class="ltx_sup" id="S3.SS1.SSS2.p1.1.1">3</sup>Rec), and four state-of-the-art LLM-based recommendation methods(i.e., P5, CID, POD, and CoLLM).</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS2.p2">
<ul class="ltx_itemize" id="S3.I2">
<li class="ltx_item" id="S3.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I2.i1.p1">
<p class="ltx_p" id="S3.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i1.p1.1.1">Collaborative Filtering:</span> <span class="ltx_text ltx_font_bold" id="S3.I2.i1.p1.1.2">MF</span>Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib33" title="">33</a>]</cite> is the most classic CF method, while <span class="ltx_text ltx_font_bold" id="S3.I2.i1.p1.1.3">NeuCF</span>Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib34" title="">34</a>]</cite> is the very first DNNs based collaborative filtering. <span class="ltx_text ltx_font_bold" id="S3.I2.i1.p1.1.4">LightGCN</span>Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib5" title="">5</a>]</cite> and <span class="ltx_text ltx_font_bold" id="S3.I2.i1.p1.1.5">GTN</span>Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib6" title="">6</a>]</cite> are representative CF based on GNNs techniques.
<span class="ltx_text ltx_font_bold" id="S3.I2.i1.p1.1.6">LTGNN</span>Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib29" title="">29</a>]</cite> is the most advanced GNN-based collaborative filtering method.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I2.i2.p1">
<p class="ltx_p" id="S3.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i2.p1.1.2">Sequential Recommendations:</span> <span class="ltx_text ltx_font_bold" id="S3.I2.i2.p1.1.3">SASRec</span>Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib35" title="">35</a>]</cite> is a self-attention based sequential recommendation model. <span class="ltx_text ltx_font_bold" id="S3.I2.i2.p1.1.4">BERT4Rec</span>Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib36" title="">36</a>]</cite> is a bidirectional Transformer-based recommender trained with the BERT-style cloze task. <span class="ltx_text ltx_font_bold" id="S3.I2.i2.p1.1.1">S<sup class="ltx_sup" id="S3.I2.i2.p1.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.I2.i2.p1.1.1.1.1">3</span></sup>Rec</span>Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib37" title="">37</a>]</cite> is a representative sequential recommendation model trained by self-supervised learning.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I2.i3.p1">
<p class="ltx_p" id="S3.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i3.p1.1.1">P5</span>Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib10" title="">10</a>]</cite> is a pioneering work on LLM-based RecSys, which describes recommendation tasks in a text-to-text format and employs LLMs to capture deeper semantics for personalization and recommendation. In our experiments, we deploy two indexing methods, i.e., <em class="ltx_emph ltx_font_italic" id="S3.I2.i3.p1.1.2">random indexing (RID)</em> and <em class="ltx_emph ltx_font_italic" id="S3.I2.i3.p1.1.3">sequential indexing (SID)</em>, on the P5 model.
Among these, P5-SID is chosen as a baseline for our efficiency evaluation, generalizability evaluation, and ablation study in our experiments.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I2.i4.p1">
<p class="ltx_p" id="S3.I2.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i4.p1.1.1">CID</span>Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib38" title="">38</a>]</cite> is a non-trivial indexing approach that considers the co-occurrence matrix of items to design numeric IDs so that items co-occur in user-item interactions will have similar numeric IDs. To be consistent, we employ the P5 model as its LLM backbone.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I2.i5.p1">
<p class="ltx_p" id="S3.I2.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i5.p1.1.1">POD</span>Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib39" title="">39</a>]</cite> encodes discrete prompts into continuous embeddings to reduce the excessive input length of LLMs based on P5 architecture.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I2.i6.p1">
<p class="ltx_p" id="S3.I2.i6.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i6.p1.1.1">CoLLM</span>Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib14" title="">14</a>]</cite> employs GNNs to provide continuous embeddings representing items and users for LLM-based recommendations.
Notably, in our experiments, CoLLMâ€™s binary classification output (i.e., whether or not a user likes an item) is reformatted to generate item IDs consistent with the output setting of top-<math alttext="K" class="ltx_Math" display="inline" id="S3.I2.i6.p1.1.m1.1"><semantics id="S3.I2.i6.p1.1.m1.1a"><mi id="S3.I2.i6.p1.1.m1.1.1" xref="S3.I2.i6.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i6.p1.1.m1.1b"><ci id="S3.I2.i6.p1.1.m1.1.1.cmml" xref="S3.I2.i6.p1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i6.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i6.p1.1.m1.1d">italic_K</annotation></semantics></math> recommendations.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS1.SSS3.4.1.1">III-A</span>3 </span><span class="ltx_text ltx_font_bold" id="S3.SS1.SSS3.5.2">Evaluation Metrics</span>
</h4>
<div class="ltx_para" id="S3.SS1.SSS3.p1">
<p class="ltx_p" id="S3.SS1.SSS3.p1.5">In order to evaluate the quality of recommendation results, we adopt two widely used evaluation metrics: top-<math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p1.1.m1.1"><semantics id="S3.SS1.SSS3.p1.1.m1.1a"><mi id="S3.SS1.SSS3.p1.1.m1.1.1" xref="S3.SS1.SSS3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.1.m1.1b"><ci id="S3.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS3.p1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p1.1.m1.1d">italic_K</annotation></semantics></math> Hit Ratio (HR@<math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p1.2.m2.1"><semantics id="S3.SS1.SSS3.p1.2.m2.1a"><mi id="S3.SS1.SSS3.p1.2.m2.1.1" xref="S3.SS1.SSS3.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.2.m2.1b"><ci id="S3.SS1.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS3.p1.2.m2.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p1.2.m2.1d">italic_K</annotation></semantics></math>) and top-<math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p1.3.m3.1"><semantics id="S3.SS1.SSS3.p1.3.m3.1a"><mi id="S3.SS1.SSS3.p1.3.m3.1.1" xref="S3.SS1.SSS3.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.3.m3.1b"><ci id="S3.SS1.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS3.p1.3.m3.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p1.3.m3.1d">italic_K</annotation></semantics></math> Normalized Discounted Cumulative Gain (NDCG@<math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p1.4.m4.1"><semantics id="S3.SS1.SSS3.p1.4.m4.1a"><mi id="S3.SS1.SSS3.p1.4.m4.1.1" xref="S3.SS1.SSS3.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.4.m4.1b"><ci id="S3.SS1.SSS3.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS3.p1.4.m4.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p1.4.m4.1d">italic_K</annotation></semantics></math>)Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib29" title="">29</a>]</cite>, in which higher values indicate better performance for recommendations.
And the average metrics for all users in the test set are reported.
In addition, we set the values of <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p1.5.m5.1"><semantics id="S3.SS1.SSS3.p1.5.m5.1a"><mi id="S3.SS1.SSS3.p1.5.m5.1.1" xref="S3.SS1.SSS3.p1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.5.m5.1b"><ci id="S3.SS1.SSS3.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS3.p1.5.m5.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p1.5.m5.1d">italic_K</annotation></semantics></math> as 10, 20, and 30, among which 20 is the default value for ablation experiments.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS1.SSS4.4.1.1">III-A</span>4 </span><span class="ltx_text ltx_font_bold" id="S3.SS1.SSS4.5.2">Hyper-parameter Settings</span>
</h4>
<div class="ltx_para" id="S3.SS1.SSS4.p1">
<p class="ltx_p" id="S3.SS1.SSS4.p1.7">Our proposed model is implemented based on Hugging Face and PyTorch.
The codebook number <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.1.m1.1"><semantics id="S3.SS1.SSS4.p1.1.m1.1a"><mi id="S3.SS1.SSS4.p1.1.m1.1.1" xref="S3.SS1.SSS4.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.1.m1.1b"><ci id="S3.SS1.SSS4.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS4.p1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.1.m1.1d">italic_K</annotation></semantics></math> (i.e., the subencoder), the token number <math alttext="L" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.2.m2.1"><semantics id="S3.SS1.SSS4.p1.2.m2.1a"><mi id="S3.SS1.SSS4.p1.2.m2.1.1" xref="S3.SS1.SSS4.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.2.m2.1b"><ci id="S3.SS1.SSS4.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS4.p1.2.m2.1.1">ğ¿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.2.m2.1d">italic_L</annotation></semantics></math> at each subcodebook, and the ratio <math alttext="\rho" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.3.m3.1"><semantics id="S3.SS1.SSS4.p1.3.m3.1a"><mi id="S3.SS1.SSS4.p1.3.m3.1.1" xref="S3.SS1.SSS4.p1.3.m3.1.1.cmml">Ï</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.3.m3.1b"><ci id="S3.SS1.SSS4.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS4.p1.3.m3.1.1">ğœŒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.3.m3.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.3.m3.1d">italic_Ï</annotation></semantics></math> of our masking operation are search in the ranges of <math alttext="\{1,2,3,4,5\}" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.4.m4.5"><semantics id="S3.SS1.SSS4.p1.4.m4.5a"><mrow id="S3.SS1.SSS4.p1.4.m4.5.6.2" xref="S3.SS1.SSS4.p1.4.m4.5.6.1.cmml"><mo id="S3.SS1.SSS4.p1.4.m4.5.6.2.1" stretchy="false" xref="S3.SS1.SSS4.p1.4.m4.5.6.1.cmml">{</mo><mn id="S3.SS1.SSS4.p1.4.m4.1.1" xref="S3.SS1.SSS4.p1.4.m4.1.1.cmml">1</mn><mo id="S3.SS1.SSS4.p1.4.m4.5.6.2.2" xref="S3.SS1.SSS4.p1.4.m4.5.6.1.cmml">,</mo><mn id="S3.SS1.SSS4.p1.4.m4.2.2" xref="S3.SS1.SSS4.p1.4.m4.2.2.cmml">2</mn><mo id="S3.SS1.SSS4.p1.4.m4.5.6.2.3" xref="S3.SS1.SSS4.p1.4.m4.5.6.1.cmml">,</mo><mn id="S3.SS1.SSS4.p1.4.m4.3.3" xref="S3.SS1.SSS4.p1.4.m4.3.3.cmml">3</mn><mo id="S3.SS1.SSS4.p1.4.m4.5.6.2.4" xref="S3.SS1.SSS4.p1.4.m4.5.6.1.cmml">,</mo><mn id="S3.SS1.SSS4.p1.4.m4.4.4" xref="S3.SS1.SSS4.p1.4.m4.4.4.cmml">4</mn><mo id="S3.SS1.SSS4.p1.4.m4.5.6.2.5" xref="S3.SS1.SSS4.p1.4.m4.5.6.1.cmml">,</mo><mn id="S3.SS1.SSS4.p1.4.m4.5.5" xref="S3.SS1.SSS4.p1.4.m4.5.5.cmml">5</mn><mo id="S3.SS1.SSS4.p1.4.m4.5.6.2.6" stretchy="false" xref="S3.SS1.SSS4.p1.4.m4.5.6.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.4.m4.5b"><set id="S3.SS1.SSS4.p1.4.m4.5.6.1.cmml" xref="S3.SS1.SSS4.p1.4.m4.5.6.2"><cn id="S3.SS1.SSS4.p1.4.m4.1.1.cmml" type="integer" xref="S3.SS1.SSS4.p1.4.m4.1.1">1</cn><cn id="S3.SS1.SSS4.p1.4.m4.2.2.cmml" type="integer" xref="S3.SS1.SSS4.p1.4.m4.2.2">2</cn><cn id="S3.SS1.SSS4.p1.4.m4.3.3.cmml" type="integer" xref="S3.SS1.SSS4.p1.4.m4.3.3">3</cn><cn id="S3.SS1.SSS4.p1.4.m4.4.4.cmml" type="integer" xref="S3.SS1.SSS4.p1.4.m4.4.4">4</cn><cn id="S3.SS1.SSS4.p1.4.m4.5.5.cmml" type="integer" xref="S3.SS1.SSS4.p1.4.m4.5.5">5</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.4.m4.5c">\{1,2,3,4,5\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.4.m4.5d">{ 1 , 2 , 3 , 4 , 5 }</annotation></semantics></math>, <math alttext="\{128,256,512,1024\}" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.5.m5.4"><semantics id="S3.SS1.SSS4.p1.5.m5.4a"><mrow id="S3.SS1.SSS4.p1.5.m5.4.5.2" xref="S3.SS1.SSS4.p1.5.m5.4.5.1.cmml"><mo id="S3.SS1.SSS4.p1.5.m5.4.5.2.1" stretchy="false" xref="S3.SS1.SSS4.p1.5.m5.4.5.1.cmml">{</mo><mn id="S3.SS1.SSS4.p1.5.m5.1.1" xref="S3.SS1.SSS4.p1.5.m5.1.1.cmml">128</mn><mo id="S3.SS1.SSS4.p1.5.m5.4.5.2.2" xref="S3.SS1.SSS4.p1.5.m5.4.5.1.cmml">,</mo><mn id="S3.SS1.SSS4.p1.5.m5.2.2" xref="S3.SS1.SSS4.p1.5.m5.2.2.cmml">256</mn><mo id="S3.SS1.SSS4.p1.5.m5.4.5.2.3" xref="S3.SS1.SSS4.p1.5.m5.4.5.1.cmml">,</mo><mn id="S3.SS1.SSS4.p1.5.m5.3.3" xref="S3.SS1.SSS4.p1.5.m5.3.3.cmml">512</mn><mo id="S3.SS1.SSS4.p1.5.m5.4.5.2.4" xref="S3.SS1.SSS4.p1.5.m5.4.5.1.cmml">,</mo><mn id="S3.SS1.SSS4.p1.5.m5.4.4" xref="S3.SS1.SSS4.p1.5.m5.4.4.cmml">1024</mn><mo id="S3.SS1.SSS4.p1.5.m5.4.5.2.5" stretchy="false" xref="S3.SS1.SSS4.p1.5.m5.4.5.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.5.m5.4b"><set id="S3.SS1.SSS4.p1.5.m5.4.5.1.cmml" xref="S3.SS1.SSS4.p1.5.m5.4.5.2"><cn id="S3.SS1.SSS4.p1.5.m5.1.1.cmml" type="integer" xref="S3.SS1.SSS4.p1.5.m5.1.1">128</cn><cn id="S3.SS1.SSS4.p1.5.m5.2.2.cmml" type="integer" xref="S3.SS1.SSS4.p1.5.m5.2.2">256</cn><cn id="S3.SS1.SSS4.p1.5.m5.3.3.cmml" type="integer" xref="S3.SS1.SSS4.p1.5.m5.3.3">512</cn><cn id="S3.SS1.SSS4.p1.5.m5.4.4.cmml" type="integer" xref="S3.SS1.SSS4.p1.5.m5.4.4">1024</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.5.m5.4c">\{128,256,512,1024\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.5.m5.4d">{ 128 , 256 , 512 , 1024 }</annotation></semantics></math>, and {0 to 1} in 0.1 increments, respectively.
Moreover, during the fine-tuning process of our proposal LLM-based recommendation framework, the ratio of negative sampling <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.6.m6.1"><semantics id="S3.SS1.SSS4.p1.6.m6.1a"><mi id="S3.SS1.SSS4.p1.6.m6.1.1" xref="S3.SS1.SSS4.p1.6.m6.1.1.cmml">Î»</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.6.m6.1b"><ci id="S3.SS1.SSS4.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS4.p1.6.m6.1.1">ğœ†</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.6.m6.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.6.m6.1d">italic_Î»</annotation></semantics></math> presented in Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.E20" title="In 2nd item â€£ II-E1 Training â€£ II-E TokenRecâ€™s Training and Inference â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">20</span></a>) is fixed at 1:1, in which we randomly select an un-interacted item from the whole item base as the negative sample for each positive sample.
The margin <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.7.m7.1"><semantics id="S3.SS1.SSS4.p1.7.m7.1a"><mi id="S3.SS1.SSS4.p1.7.m7.1.1" xref="S3.SS1.SSS4.p1.7.m7.1.1.cmml">Î³</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.7.m7.1b"><ci id="S3.SS1.SSS4.p1.7.m7.1.1.cmml" xref="S3.SS1.SSS4.p1.7.m7.1.1">ğ›¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.7.m7.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.7.m7.1d">italic_Î³</annotation></semantics></math> in Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.E20" title="In 2nd item â€£ II-E1 Training â€£ II-E TokenRecâ€™s Training and Inference â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">20</span></a>) is set to 0 to 0.2.
We optimize the MQ-Tokenizers and the LLM backbone with AdamWÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib40" title="">40</a>]</cite> in a mini-batch manner.
Note that the high-order collaborative representations for users and items are obtained from a representative collaborative filtering method, namely LightGCNÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib5" title="">5</a>]</cite>.
For prompting, we design 11 templates for TokenRec: 10 of them are set to be <em class="ltx_emph ltx_font_italic" id="S3.SS1.SSS4.p1.7.1">seen</em> prompts, and the remaining one is evaluated as an <em class="ltx_emph ltx_font_italic" id="S3.SS1.SSS4.p1.7.2">unseen</em> prompt.
For a fair comparison, we employ a widely-used lightweight LLM, i.e., <em class="ltx_emph ltx_font_italic" id="S3.SS1.SSS4.p1.7.3">T5-small</em>Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib32" title="">32</a>]</cite>, for TokenRec and all LLM-based baselines.
The other default hyper-parameters for baseline methods are set as suggested by the corresponding papers.</p>
</div>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Performance comparison of recommendation algorithms on the LastFM and ML1M datasets.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T2.1" style="width:601.6pt;height:328.8pt;vertical-align:-21.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-15.8pt,8.1pt) scale(0.95,0.95) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T2.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.1.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S3.T2.1.1.2.1.1" rowspan="2"><span class="ltx_text" id="S3.T2.1.1.2.1.1.1">Model</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="6" id="S3.T2.1.1.2.1.2"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.2.1.2.1">LastFM</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="6" id="S3.T2.1.1.2.1.3"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.2.1.3.1">ML1M</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.3.2">
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.3.2.1">HR@10</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.3.2.2">HR@20</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.3.2.3">HR@30</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.3.2.4">NG@10</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.3.2.5">NG@20</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.3.2.6">NG@30</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.3.2.7">HR@10</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.3.2.8">HR@20</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.3.2.9">HR@30</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.3.2.10">NG@10</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.3.2.11">NG@20</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.3.2.12">NG@30</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T2.1.1.4.3.1">BERT4Rec</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.4.3.2">0.0319</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.4.3.3">0.0461</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.4.3.4">0.0640</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.4.3.5">0.0128</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.4.3.6">0.0234</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.1.1.4.3.7">0.0244</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.4.3.8">0.0779</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.4.3.9">0.1255</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.4.3.10">0.1736</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.4.3.11">0.0353</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.4.3.12">0.0486</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.4.3.13">0.0595</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.1.5.4.1">SASRec</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.5.4.2">0.0345</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.5.4.3">0.0484</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.5.4.4">0.0658</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.5.4.5">0.0142</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.5.4.6">0.0236</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.5.4.7">0.0248</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.5.4.8">0.0785</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.5.4.9">0.1293</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.5.4.10">0.1739</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.5.4.11">0.0367</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.5.4.12">0.052</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.5.4.13">0.0622</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.1.1.1">S<sup class="ltx_sup" id="S3.T2.1.1.1.1.1">3</sup>Rec</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.1.2">0.0385</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.1.3">0.0490</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.1.4">0.0689</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.1.5">0.0177</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.1.6">0.0266</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.1.7">0.0266</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.1.8">0.0867</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.1.9">0.1270</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.1.10">0.1811</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.1.11">0.0361</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.1.12">0.0501</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.1.13">0.0601</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T2.1.1.6.5.1">MF</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.6.5.2">0.0239</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.6.5.3">0.0450</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.6.5.4">0.0569</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.6.5.5">0.0114</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.6.5.6">0.0166</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.1.1.6.5.7">0.0192</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.6.5.8">0.078</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.6.5.9">0.1272</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.6.5.10">0.1733</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.6.5.11">0.0357</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.6.5.12">0.0503</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.6.5.13">0.0591</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.1.7.6.1">NCF</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.7.6.2">0.0321</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.7.6.3">0.0462</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.7.6.4">0.0643</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.7.6.5">0.0141</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.7.6.6">0.0252</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.7.6.7">0.0254</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.7.6.8">0.0786</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.7.6.9">0.1273</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.7.6.10">0.1738</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.7.6.11">0.0363</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.7.6.12">0.0504</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.7.6.13">0.0601</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.8.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.1.8.7.1">LightGCN</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.8.7.2">0.0385</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.8.7.3">0.0661</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.8.7.4">0.0982</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.8.7.5">0.0199</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.8.7.6">0.0269</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.8.7.7">0.0336</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.8.7.8">0.0877</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.8.7.9">0.1288</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.8.7.10">0.1813</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.8.7.11">0.0374</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.8.7.12">0.0509</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.8.7.13">0.0604</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.9.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.1.9.8.1">GTN</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.9.8.2">0.0394</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.9.8.3">0.0688</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.9.8.4">0.0963</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.9.8.5">0.0199</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.9.8.6">0.0273</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.9.8.7">0.0331</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.9.8.8">0.0883</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.9.8.9">0.1307</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.9.8.10">0.1826</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.9.8.11">0.0378</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.9.8.12">0.0512</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.9.8.13">0.0677</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.10.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.1.10.9.1">LTGNN</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.10.9.2">0.0471</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.10.9.3">0.076</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.10.9.4">0.0925</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.10.9.5">0.0234</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.10.9.6">0.0318</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.10.9.7">0.0354</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.10.9.8">0.0915</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.10.9.9">0.1387</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.10.9.10">0.1817</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.10.9.11">0.0419</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.10.9.12">0.0570</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.10.9.13">0.0659</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.11.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T2.1.1.11.10.1">P5-RID</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.11.10.2">0.0312</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.11.10.3">0.0523</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.11.10.4">0.0706</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.11.10.5">0.0144</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.11.10.6">0.0199</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.1.1.11.10.7">0.0238</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.11.10.8">0.0867</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.11.10.9">0.1248</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.11.10.10">0.1811</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.11.10.11">0.0381</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.11.10.12">0.0486</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.11.10.13">0.0662</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.12.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.1.12.11.1">P5-SID</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.12.11.2">0.0375</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.12.11.3">0.0536</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.12.11.4">0.0851</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.12.11.5">0.0224</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.12.11.6">0.0255</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.12.11.7">0.0261</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.12.11.8">0.0892</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.12.11.9">0.1380</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.12.11.10">0.1784</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.12.11.11">0.0422</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.12.11.12">0.0550</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.12.11.13">0.0641</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.13.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.1.13.12.1">CID</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.13.12.2">0.0381</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.13.12.3">0.0552</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.13.12.4">0.0870</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.13.12.5">0.0229</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.13.12.6">0.0260</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.13.12.7">0.0277</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.13.12.8">0.0901</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.13.12.9">0.1294</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.13.12.10">0.1863</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.13.12.11">0.0379</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.13.12.12">0.0525</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.13.12.13">0.0706</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.14.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.1.14.13.1">POD</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.14.13.2">0.0367</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.14.13.3">0.0572</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.14.13.4">0.0747</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.14.13.5">0.0184</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.14.13.6">0.0220</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.14.13.7">0.0273</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.14.13.8">0.0886</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.14.13.9">0.1277</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.14.13.10">0.1846</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.14.13.11">0.0373</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.14.13.12">0.0487</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.14.13.13">0.0668</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.15.14">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.1.15.14.1">CoLLM</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.15.14.2">0.0483</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.15.14.3">0.0786</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.15.14.4">0.1017</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.15.14.5">0.0234</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.15.14.6">0.0319</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.15.14.7">0.0366</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.15.14.8">0.0923</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.15.14.9">0.1499</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.15.14.10">0.1998</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.15.14.11">0.0456</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.15.14.12">0.0620</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.15.14.13">0.0719</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.16.15">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T2.1.1.16.15.1">* (User ID Only)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.16.15.2">0.0505</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.16.15.3">0.0881</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.16.15.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.1.16.15.4.1">0.1128</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.16.15.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.1.16.15.5.1">0.0251</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.16.15.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.1.16.15.6.1">0.0345</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.1.1.16.15.7">0.0397</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.16.15.8">0.0964</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.16.15.9">0.1546</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.16.15.10">0.2043</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.16.15.11">0.0493</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.16.15.12">0.0640</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.16.15.13">0.0745</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.17.16">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.1.17.16.1">(Unseen Prompt)</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.17.16.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.1.17.16.2.1">0.0514</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.17.16.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.1.17.16.3.1">0.0917</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.17.16.4"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.17.16.4.1">0.1294</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.17.16.5"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.17.16.5.1">0.0252</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.17.16.6">0.0343</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.17.16.7"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.17.16.7.1">0.0422</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.17.16.8"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.17.16.8.1">0.1012</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.17.16.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.1.17.16.9.1">0.1672</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.17.16.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.1.17.16.10.1">0.2144</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.17.16.11"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.17.16.11.1">0.0532</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.17.16.12"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.17.16.12.1">0.0698</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.17.16.13"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.17.16.13.1">0.0798</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.18.17">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S3.T2.1.1.18.17.1">TokenRec</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.1.18.17.2"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.18.17.2.1">0.0532</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.1.18.17.3"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.18.17.3.1">0.0936</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.1.18.17.4">0.1248</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.1.18.17.5">0.0247</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.1.18.17.6"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.18.17.6.1">0.0348</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T2.1.1.18.17.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.1.18.17.7.1">0.0415</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.1.18.17.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.1.18.17.8.1">0.1008</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.1.18.17.9"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.18.17.9.1">0.1677</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.1.18.17.10"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.18.17.10.1">0.2149</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.1.18.17.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.1.18.17.11.1">0.0528</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.1.18.17.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.1.18.17.12.1">0.0697</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.1.18.17.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.1.18.17.13.1">0.0797</span></td>
</tr>
</tbody>
</table>
<ul class="ltx_itemize" id="S3.I3">
<li class="ltx_item" id="S3.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I3.i1.p1">
<p class="ltx_p" id="S3.I3.i1.p1.1"><span class="ltx_text" id="S3.I3.i1.p1.1.1" style="font-size:80%;">* are the variants of </span><span class="ltx_text ltx_font_bold" id="S3.I3.i1.p1.1.2" style="font-size:80%;">TokenRec</span><span class="ltx_text" id="S3.I3.i1.p1.1.3" style="font-size:80%;">, namely the cases of using user ID tokens only for model inputs without considering item interaction history and using the unseen prompt during evaluation.</span></p>
</div>
</li>
</ul>
</span></div>
</figure>
<figure class="ltx_table" id="S3.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Performance comparison of recommendation algorithms on the Beauty and Clothing datasets.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T3.1" style="width:601.6pt;height:328.8pt;vertical-align:-21.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-15.8pt,8.1pt) scale(0.95,0.95) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T3.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T3.1.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S3.T3.1.1.2.1.1" rowspan="2"><span class="ltx_text" id="S3.T3.1.1.2.1.1.1">Model</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="6" id="S3.T3.1.1.2.1.2"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.2.1.2.1">Beauty</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="6" id="S3.T3.1.1.2.1.3"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.2.1.3.1">Clothing</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.3.2">
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.3.2.1">HR@10</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.3.2.2">HR@20</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.3.2.3">HR@30</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.3.2.4">NG@10</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.3.2.5">NG@20</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.3.2.6">NG@30</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.3.2.7">HR@10</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.3.2.8">HR@20</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.3.2.9">HR@30</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.3.2.10">NG@10</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.3.2.11">NG@20</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.3.2.12">NG@30</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T3.1.1.4.3.1">BERT4Rec</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.3.2">0.0329</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.3.3">0.0464</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.3.4">0.0637</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.3.5">0.0162</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.3.6">0.0205</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T3.1.1.4.3.7">0.0255</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.3.8">0.0135</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.3.9">0.0217</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.3.10">0.0248</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.3.11">0.0061</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.3.12">0.0074</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.3.13">0.0079</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T3.1.1.5.4.1">SASRec</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.4.2">0.0338</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.4.3">0.0472</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.4.4">0.0637</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.4.5">0.0170</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.4.6">0.0213</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.5.4.7">0.0260</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.4.8">0.0136</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.4.9">0.0221</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.4.10">0.0256</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.4.11">0.0063</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.4.12">0.0076</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.4.13">0.0081</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T3.1.1.1.1">S<sup class="ltx_sup" id="S3.T3.1.1.1.1.1">3</sup>Rec</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.2">0.0351</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.3">0.0471</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.4">0.0664</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.5">0.0169</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.6">0.0237</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.1.7">0.0278</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.8">0.0140</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.9">0.0213</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.10">0.0256</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.11">0.0069</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.12">0.0081</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.13">0.0086</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T3.1.1.6.5.1">MF</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.6.5.2">0.0127</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.6.5.3">0.0195</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.6.5.4">0.0245</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.6.5.5">0.0063</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.6.5.6">0.0081</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T3.1.1.6.5.7">0.0091</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.6.5.8">0.0116</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.6.5.9">0.0175</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.6.5.10">0.0234</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.6.5.11">0.0074</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.6.5.12">0.0088</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.6.5.13">0.0101</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T3.1.1.7.6.1">NCF</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.6.2">0.0315</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.6.3">0.0462</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.6.4">0.0623</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.6.5">0.0160</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.6.6">0.0196</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.7.6.7">0.0237</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.6.8">0.0119</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.6.9">0.0178</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.6.10">0.024</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.6.11">0.0072</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.6.12">0.0090</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.6.13">0.0103</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.8.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T3.1.1.8.7.1">LightGCN</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.7.2">0.0344</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.7.3">0.0498</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.7.4">0.0630</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.7.5">0.0194</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.7.6">0.0233</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.8.7.7">0.0261</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.7.8">0.0157</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.7.9">0.0226</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.7.10">0.0279</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.7.11">0.0085</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.7.12">0.0103</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.7.13">0.0114</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.9.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T3.1.1.9.8.1">GTN</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.8.2">0.0345</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.8.3">0.0502</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.8.4">0.0635</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.8.5">0.0198</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.8.6">0.0241</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.9.8.7">0.0268</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.8.8">0.0158</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.8.9">0.0226</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.8.10">0.0282</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.8.11">0.0084</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.8.12">0.0103</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.8.13">0.0111</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.10.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T3.1.1.10.9.1">LTGNN</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.9.2">0.0385</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.9.3">0.0564</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.9.4">0.0719</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.9.5">0.0207</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.9.6">0.0252</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.10.9.7">0.0285</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.9.8">0.0155</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.9.9">0.0218</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.9.10">0.0272</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.9.11">0.0082</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.9.12">0.0110</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.9.13">0.0116</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.11.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T3.1.1.11.10.1">P5-RID</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.10.2">0.0330</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.10.3">0.0511</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.10.4">0.0651</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.10.5">0.0146</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.10.6">0.0200</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T3.1.1.11.10.7">0.0144</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.10.8">0.0148</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.10.9">0.0225</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.10.10">0.0263</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.10.11">0.0071</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.10.12">0.0086</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.10.13">0.0095</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.12.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T3.1.1.12.11.1">P5-SID</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.11.2">0.0340</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.11.3">0.0516</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.11.4">0.0672</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.11.5">0.0154</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.11.6">0.0231</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.12.11.7">0.0176</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.11.8">0.0143</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.11.9">0.0222</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.11.10">0.0258</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.11.11">0.0070</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.11.12">0.0086</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.11.13">0.0091</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.13.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T3.1.1.13.12.1">CID</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.12.2">0.0341</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.12.3">0.0516</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.12.4">0.0673</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.12.5">0.0165</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.12.6">0.0236</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.13.12.7">0.0177</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.12.8">0.0146</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.12.9">0.0226</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.12.10">0.0276</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.12.11">0.0070</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.12.12">0.0087</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.12.13">0.0092</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.14.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T3.1.1.14.13.1">POD</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.14.13.2">0.0339</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.14.13.3">0.0498</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.14.13.4">0.0639</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.14.13.5">0.0185</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.14.13.6">0.0222</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.14.13.7">0.0221</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.14.13.8">0.0147</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.14.13.9">0.0225</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.14.13.10">0.0261</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.14.13.11">0.0074</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.14.13.12">0.0087</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.14.13.13">0.0091</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.15.14">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T3.1.1.15.14.1">CoLLM</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.15.14.2">0.0391</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.15.14.3">0.0606</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.15.14.4">0.0772</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.15.14.5">0.0200</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.15.14.6">0.0259</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.15.14.7">0.0303</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.15.14.8">0.0150</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.15.14.9">0.0218</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.15.14.10">0.0274</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.15.14.11">0.0079</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.15.14.12">0.0091</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.15.14.13">0.0117</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.16.15">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T3.1.1.16.15.1">* (User ID Only)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.16.15.2">0.0396</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.16.15.3">0.0599</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.16.15.4">0.0763</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.16.15.5">0.0214</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.16.15.6">0.0265</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T3.1.1.16.15.7">0.0300</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.16.15.8">0.0160</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.16.15.9">0.0228</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.16.15.10">0.0282</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.16.15.11">0.0092</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.16.15.12">0.0109</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.16.15.13">0.0119</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.17.16">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T3.1.1.17.16.1">(Unseen Prompt)</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.17.16.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.17.16.2.1">0.0402</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.17.16.3"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.17.16.3.1">0.0622</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.17.16.4"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.17.16.4.1">0.0791</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.17.16.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.17.16.5.1">0.0215</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.17.16.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.17.16.6.1">0.0270</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.17.16.7"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.17.16.7.1">0.0306</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.17.16.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.17.16.8.1">0.0164</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.17.16.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.17.16.9.1">0.0233</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.17.16.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.17.16.10.1">0.0286</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.17.16.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.17.16.11.1">0.0096</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.17.16.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.17.16.12.1">0.0111</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.17.16.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.17.16.13.1">0.0124</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.18.17">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S3.T3.1.1.18.17.1">TokenRec</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.18.17.2"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.18.17.2.1">0.0407</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.18.17.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.18.17.3.1">0.0615</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.18.17.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.18.17.4.1">0.0782</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.18.17.5"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.18.17.5.1">0.0222</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.18.17.6"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.18.17.6.1">0.0276</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T3.1.1.18.17.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.18.17.7.1">0.0303</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.18.17.8"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.18.17.8.1">0.0171</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.18.17.9"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.18.17.9.1">0.0240</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.18.17.10"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.18.17.10.1">0.0291</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.18.17.11"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.18.17.11.1">0.0108</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.18.17.12"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.18.17.12.1">0.0112</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.18.17.13"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.18.17.13.1">0.0130</span></td>
</tr>
</tbody>
</table>
<ul class="ltx_itemize" id="S3.I4">
<li class="ltx_item" id="S3.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I4.i1.p1">
<p class="ltx_p" id="S3.I4.i1.p1.1"><span class="ltx_text" id="S3.I4.i1.p1.1.1" style="font-size:80%;">* are the variants of </span><span class="ltx_text ltx_font_bold" id="S3.I4.i1.p1.1.2" style="font-size:80%;">TokenRec</span><span class="ltx_text" id="S3.I4.i1.p1.1.3" style="font-size:80%;">, namely the cases of using user ID tokens only for model inputs without considering item interaction history and using the unseen prompt during evaluation.</span></p>
</div>
</li>
</ul>
</span></div>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS2.4.1.1">III-B</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS2.5.2">Performance Comparison of Recommender Systems</span>
</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">We first compare the recommendation performance between TokenRec and all baselines over four benchmark datasets.
TableÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.T2" title="TABLE II â€£ III-A4 Hyper-parameter Settings â€£ III-A Experimental Settings â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">II</span></a> and TableÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.T3" title="TABLE III â€£ III-A4 Hyper-parameter Settings â€£ III-A Experimental Settings â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">III</span></a> present the overall performance comparison on the four datasets, where * denotes the proposed TokenRec, and the best and second best results are marked by <span class="ltx_text ltx_font_bold" id="S3.SS2.p1.1.1">Bold</span> and <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.SS2.p1.1.2">underlined</span>.
Notably, the proposed model using unseen prompts will be indicated by the suffix (Unseen Prompt).
Besides, the suffix of (User ID Only) denotes the case of using <span class="ltx_text ltx_font_bold" id="S3.SS2.p1.1.3">user ID tokens</span> only for LLM-empowered recommendation without considering usersâ€™ interaction history towards items.
We make the following observations:</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<ul class="ltx_itemize" id="S3.I5">
<li class="ltx_item" id="S3.I5.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I5.i1.p1">
<p class="ltx_p" id="S3.I5.i1.p1.1">Our proposed TokenRec achieves the best performance and consistently outperforms all the baselines across all datasets regarding metrics with either unseen personalized prompts.
On average, TokenRec significantly exceeds the strongest baselines by 19.08% on HR@20 and 9.09% on NCDG@20 in the LastFM dataset.
Such improvement demonstrates the effectiveness of our proposed method and the great potential of exploring collaborative indexing (i.e., tokenization) in LLM-based RecSys.</p>
</div>
</li>
<li class="ltx_item" id="S3.I5.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I5.i2.p1">
<p class="ltx_p" id="S3.I5.i2.p1.1">Even when using only user ID tokens, TokenRec surpasses most baselines in terms of accuracy, indicating its superior performance in collaborative recommendations.
Such a result implies that TokenRec is capable of effectively modeling user even in the absence of their interaction history.
Rather than spending a large number of tokens describing usersâ€™ interacted items, this allows TokenRec to generate recommendations using a concise input, thus circumventing the input length restrictions imposed by LLMs and saving considerable computation resources.</p>
</div>
</li>
<li class="ltx_item" id="S3.I5.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I5.i3.p1">
<p class="ltx_p" id="S3.I5.i3.p1.1">As an earlier non-trivial indexing method to capture hidden knowledge in co-occurrence frequency, Collaborative Indexing (CID) outperforms Random Indexing (RID) and Sequential Indexing (SID) given the same setting of P5.
These observations suggest the potential of integrating collaborative knowledge for item&amp;user tokenization/indexing.
However, the P5 variants and POD are inferior to the existing GNN-based collaborative filtering (i.e., LightGCN, GTN, and LTGNN), implying their inability to capture collaborative information using LLMs.</p>
</div>
</li>
<li class="ltx_item" id="S3.I5.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I5.i4.p1">
<p class="ltx_p" id="S3.I5.i4.p1.1">The GNN-based collaborative filtering methods perform relatively better than the traditional CF methods (i.e., MF and NCF) and representative sequential recommendation methods (i.e., BERT4Rec, SASRec, and S<sup class="ltx_sup" id="S3.I5.i4.p1.1.1">3</sup>Rec). The results demonstrate the effectiveness of GNNs in capturing collaborative signals via high-order connectivity.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS3.4.1.1">III-C</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS3.5.2">Generalizability Evaluation</span>
</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">In most e-commerce and social media platforms, a significant number of new users and items are added daily to recommender systems.
As a result, well-established systems are required to frequently conduct updates and enhancements to accommodate and generalize to the preferences of new users and the characteristics of new items, thereby providing personalized recommendations that cater to the evolving dynamics of their user base.
Since newly added users and items lack their interactions in fine-tuning LLM4Rec, most existing LLM-based RecSys fail to retrieve suitable items as potential candidates, thus requiring extensive retraining.
In contrast, our proposed TokenRec can easily generalize effectively even in cases where the user is not present in the training and fine-tuning corpus.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">For this analysis, we consider the Beauty and LastFM datasets and exclude the 5% of users (ref as <em class="ltx_emph ltx_font_italic" id="S3.SS3.p2.1.1">unseen users</em>) with the least interaction history from the training data split to simulate newly added users.
In this evaluation, the performance of TokenRec is compared to other LLM-based recommendation models, i.e., P5, POD, CID, and CoLLM.
To ensure the absence of data leakage concerning unseen users, only the training split is utilized for establishing these LLM4Rec models, while it is allowed to update the vector database to provide collaborative representations of unseen users and items (as shown in FigureÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S2.F3" title="Figure 3 â€£ II-E1 Training â€£ II-E TokenRecâ€™s Training and Inference â€£ II The Proposed Method â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">3</span></a>), which consumes far less computational resources than updating the LLM backbone of LLM-based RecSys.
From the recommendation results presented in TableÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.T4" title="TABLE IV â€£ III-C Generalizability Evaluation â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">IV</span></a>, several key observations can be made:</p>
<ul class="ltx_itemize" id="S3.I6">
<li class="ltx_item" id="S3.I6.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I6.i1.p1">
<p class="ltx_p" id="S3.I6.i1.p1.1">Existing LLM-based recommendation methods face challenges in generalizability, as evidenced by a significant drop of over 40% in HR@20 and NDCG@20 for P5 and POD when recommending items to unseen users.</p>
</div>
</li>
<li class="ltx_item" id="S3.I6.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I6.i2.p1">
<p class="ltx_p" id="S3.I6.i2.p1.1">The inclusion of collaborative knowledge in CID and CoLLM leads to a relatively improved performance in model generalization, as indicated by a reduced performance degradation in P5 and POD.
However, these methods still experience more than a 20% drop, indicating that they overlook the importance of stable ID tokenization for LLM-based recommendations.</p>
</div>
</li>
<li class="ltx_item" id="S3.I6.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I6.i3.p1">
<p class="ltx_p" id="S3.I6.i3.p1.1">In comparison, TokenRec outperforms all the compared methods for not only the training users but also the unseen users in both datasets.
For instance, in the Amazon-Beauty dataset, the performance of TokenRec decreases by only 7% on average, demonstrating the strong generalization capability of TokenRec for newly added users.
Such a superiority can be attributed to our MQ-Tokenizer for robust ID tokenization and the generative retrieval paradigm for flexible recommendation generation.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_table" id="S3.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>Performance comparison on seen and unseen users for generalizability evaluation.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T4.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S3.T4.1.1.1.1" rowspan="2"><span class="ltx_text" id="S3.T4.1.1.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S3.T4.1.1.1.2" rowspan="2"><span class="ltx_text" id="S3.T4.1.1.1.2.1">Model</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S3.T4.1.1.1.3">Seen</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S3.T4.1.1.1.4">Unseen</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.2.2">
<td class="ltx_td ltx_align_center" id="S3.T4.1.2.2.1">HR@20</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.1.2.2.2">NG@20</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.2.2.3">HR@20</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.2.2.4">NG@20</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T4.1.3.3.1" rowspan="5"><span class="ltx_text" id="S3.T4.1.3.3.1.1">LastFM</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T4.1.3.3.2">P5</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.3.3.3">0.0704</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T4.1.3.3.4">0.0320</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.3.3.5">0.0399</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.3.3.6">0.0137</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T4.1.4.4.1">POD</th>
<td class="ltx_td ltx_align_center" id="S3.T4.1.4.4.2">0.0709</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.1.4.4.3">0.0323</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.4.4.4">0.0401</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.4.4.5">0.0138</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T4.1.5.5.1">CID</th>
<td class="ltx_td ltx_align_center" id="S3.T4.1.5.5.2">0.0697</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.1.5.5.3">0.0314</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.5.5.4">0.0452</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.5.5.5">0.0196</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T4.1.6.6.1">CoLLM</th>
<td class="ltx_td ltx_align_center" id="S3.T4.1.6.6.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.1.6.6.2.1">0.0812</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.1.6.6.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.1.6.6.3.1">0.0336</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.6.6.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.1.6.6.4.1">0.0574</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.6.6.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.1.6.6.5.1">0.0235</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T4.1.7.7.1">TokenRec</th>
<td class="ltx_td ltx_align_center" id="S3.T4.1.7.7.2"><span class="ltx_text ltx_font_bold" id="S3.T4.1.7.7.2.1">0.0973</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.1.7.7.3"><span class="ltx_text ltx_font_bold" id="S3.T4.1.7.7.3.1">0.0353</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.7.7.4"><span class="ltx_text ltx_font_bold" id="S3.T4.1.7.7.4.1">0.0773</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.7.7.5"><span class="ltx_text ltx_font_bold" id="S3.T4.1.7.7.5.1">0.0268</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S3.T4.1.8.8.1" rowspan="5"><span class="ltx_text" id="S3.T4.1.8.8.1.1">Beauty</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T4.1.8.8.2">P5</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.8.8.3">0.0511</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T4.1.8.8.4">0.0236</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.8.8.5">0.0274</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.8.8.6">0.0130</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.9.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T4.1.9.9.1">POD</th>
<td class="ltx_td ltx_align_center" id="S3.T4.1.9.9.2">0.0507</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.1.9.9.3">0.0225</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.9.9.4">0.0269</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.9.9.5">0.0123</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.10.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T4.1.10.10.1">CID</th>
<td class="ltx_td ltx_align_center" id="S3.T4.1.10.10.2">0.5234</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.1.10.10.3">0.0240</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.10.10.4">0.3336</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.10.10.5">0.0146</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.11.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T4.1.11.11.1">CoLLM</th>
<td class="ltx_td ltx_align_center" id="S3.T4.1.11.11.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.1.11.11.2.1">0.0612</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.1.11.11.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.1.11.11.3.1">0.0261</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.11.11.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.1.11.11.4.1">0.0477</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.11.11.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.1.11.11.5.1">0.0195</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.12.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S3.T4.1.12.12.1">TokenRec</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.12.12.2"><span class="ltx_text ltx_font_bold" id="S3.T4.1.12.12.2.1">0.0629</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T4.1.12.12.3"><span class="ltx_text ltx_font_bold" id="S3.T4.1.12.12.3.1">0.0289</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.12.12.4"><span class="ltx_text ltx_font_bold" id="S3.T4.1.12.12.4.1">0.0591</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.12.12.5"><span class="ltx_text ltx_font_bold" id="S3.T4.1.12.12.5.1">0.0266</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS4.4.1.1">III-D</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS4.5.2">Efficiency Evaluation</span>
</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">In this subsection, we analyze the inference efficiency of TokenRec compared with the general LLM-based recommendation methods (i.e., P5, CID, and POD), which generate the tokens (e.g., IDs, titles, and descriptions) for Top-<math alttext="K" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><mi id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">italic_K</annotation></semantics></math> items by using auto-regressive decoding and beam search.
Our proposed method discards this text-decoding generation solution and introduces a generative retrieval paradigm to perform collaborative recommendations.
The results, as presented in TableÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.T5" title="TABLE V â€£ III-D Efficiency Evaluation â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">V</span></a>,
demonstrate that TokenRec can achieve superior inference efficiency with a significant improvement of approximately 1306.5% compared to the LLM-based recommendation baselines.
This can be attributed to our generative retrieval paradigm, bypassing the most time-consuming auto-regressive decoding and beam search processes of LLMsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib25" title="">25</a>]</cite>.</p>
</div>
<figure class="ltx_table" id="S3.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE V: </span>Average inference time (milliseconds) per user.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle" id="S3.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T5.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.1.1.1.1">Inference Time</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.1.1.1.2">LastFM</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.1.1.1.3">ML1M</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.1.1.1.4">Beauty</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.1.1.1.5">Clothing</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T5.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.2.1.1">P5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.2.1.2">96.04</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.2.1.3">99.75</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.2.1.4">86.39</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.2.1.5">93.38</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.3.2">
<td class="ltx_td ltx_align_center" id="S3.T5.1.3.2.1">POD</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.3.2.2">96.30</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.3.2.3">101.42</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.3.2.4">87.69</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.3.2.5">94.48</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.4.3">
<td class="ltx_td ltx_align_center" id="S3.T5.1.4.3.1">CID</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.4.3.2">94.96</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.4.3.3">99.42</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.4.3.4">84.87</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.4.3.5">92.02</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.5.4">
<td class="ltx_td ltx_align_center" id="S3.T5.1.5.4.1">TokenRec</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.5.4.2">6.92</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.5.4.3">8.43</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.5.4.4">5.76</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.5.4.5">6.00</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.6.5">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T5.1.6.5.1">Acceleration*</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T5.1.6.5.2">1284%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T5.1.6.5.3">1089%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T5.1.6.5.4">1398%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T5.1.6.5.5">1455%</td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<ul class="ltx_itemize ltx_centering ltx_figure_panel" id="S3.I7">
<li class="ltx_item" id="S3.I7.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I7.i1.p1">
<p class="ltx_p" id="S3.I7.i1.p1.1"><span class="ltx_text" id="S3.I7.i1.p1.1.1" style="font-size:80%;">* The average improvement compared to the baselines.</span></p>
</div>
</li>
</ul>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS5.4.1.1">III-E</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS5.5.2">Ablation Study</span>
</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.1">In order to assess the effectiveness of the proposed key components, we conducted ablation experiments on the LastFM and Amazon-Beauty datasets, where the influence of each component was eliminated separately as follows:</p>
<ul class="ltx_itemize" id="S3.I8">
<li class="ltx_item" id="S3.I8.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I8.i1.p1">
<p class="ltx_p" id="S3.I8.i1.p1.1">w/o High-Order Collaborative Knowledge (HOCK):
Use Matrix Factorization (MF) to learn the collaborative representations of users and items for ID tokenization in MQ-Tokenizers.
Compared to advanced GNN-based methods (e.g., LightGCN), it is challenging for MF to capture high-order collaborative signals explicitly among user-item interactions.</p>
</div>
</li>
<li class="ltx_item" id="S3.I8.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I8.i2.p1">
<p class="ltx_p" id="S3.I8.i2.p1.3">w/o <math alttext="K" class="ltx_Math" display="inline" id="S3.I8.i2.p1.1.m1.1"><semantics id="S3.I8.i2.p1.1.m1.1a"><mi id="S3.I8.i2.p1.1.m1.1.1" xref="S3.I8.i2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.I8.i2.p1.1.m1.1b"><ci id="S3.I8.i2.p1.1.m1.1.1.cmml" xref="S3.I8.i2.p1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I8.i2.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.I8.i2.p1.1.m1.1d">italic_K</annotation></semantics></math>-way: Replace the <math alttext="K" class="ltx_Math" display="inline" id="S3.I8.i2.p1.2.m2.1"><semantics id="S3.I8.i2.p1.2.m2.1a"><mi id="S3.I8.i2.p1.2.m2.1.1" xref="S3.I8.i2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.I8.i2.p1.2.m2.1b"><ci id="S3.I8.i2.p1.2.m2.1.1.cmml" xref="S3.I8.i2.p1.2.m2.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I8.i2.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.I8.i2.p1.2.m2.1d">italic_K</annotation></semantics></math>-way encoder and codebook with <math alttext="1" class="ltx_Math" display="inline" id="S3.I8.i2.p1.3.m3.1"><semantics id="S3.I8.i2.p1.3.m3.1a"><mn id="S3.I8.i2.p1.3.m3.1.1" xref="S3.I8.i2.p1.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.I8.i2.p1.3.m3.1b"><cn id="S3.I8.i2.p1.3.m3.1.1.cmml" type="integer" xref="S3.I8.i2.p1.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.I8.i2.p1.3.m3.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.I8.i2.p1.3.m3.1d">1</annotation></semantics></math>-way ones while keeping the total number of codebook tokens (i.e., codewords) consistent.</p>
</div>
</li>
<li class="ltx_item" id="S3.I8.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I8.i3.p1">
<p class="ltx_p" id="S3.I8.i3.p1.1">w/o Masking: Deactivate the masking operation in our user and item MQ-Tokenizers.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S3.SS5.p2">
<p class="ltx_p" id="S3.SS5.p2.1">We can have the following observations from the ablation results in TableÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.T6" title="TABLE VI â€£ III-E Ablation Study â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">VI</span></a>.
First, each component in our approach contributes to the overall performance since eliminating any of them would result in performance degradation.
Second, the masking operation and the <math alttext="K" class="ltx_Math" display="inline" id="S3.SS5.p2.1.m1.1"><semantics id="S3.SS5.p2.1.m1.1a"><mi id="S3.SS5.p2.1.m1.1.1" xref="S3.SS5.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.1.m1.1b"><ci id="S3.SS5.p2.1.m1.1.1.cmml" xref="S3.SS5.p2.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.1.m1.1d">italic_K</annotation></semantics></math>-way framework introduced in our approach not only enhance the generalizability, as demonstrated in TableÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.T4" title="TABLE IV â€£ III-C Generalizability Evaluation â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">IV</span></a>, but also result in moderate performance improvements during the ablation experiment.
Finally, the removal of the high-order collaborative knowledge learned by advanced GNNs resulted in a significant drop in performance.
This indicates the importance of incorporating such knowledge for the alignment of LLMs and personalized recommendations.</p>
</div>
<figure class="ltx_table" id="S3.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE VI: </span>Results of Ablation Studies</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle" id="S3.T6.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T6.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T6.1.2.1.1" rowspan="2"><span class="ltx_text" id="S3.T6.1.2.1.1.1">Module</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S3.T6.1.2.1.2">LastFM</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S3.T6.1.2.1.3">Beauty</th>
</tr>
<tr class="ltx_tr" id="S3.T6.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T6.1.3.2.1">HR@20</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T6.1.3.2.2">NG@20</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T6.1.3.2.3">HR@20</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T6.1.3.2.4">NG@20</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T6.1.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T6.1.4.1.1">w/o HOCK</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.4.1.2">0.0549</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.4.1.3">0.0172</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.4.1.4">0.0407</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.4.1.5">0.0149</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T6.1.1.1">w/o <math alttext="K" class="ltx_Math" display="inline" id="S3.T6.1.1.1.m1.1"><semantics id="S3.T6.1.1.1.m1.1a"><mi id="S3.T6.1.1.1.m1.1.1" xref="S3.T6.1.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.T6.1.1.1.m1.1b"><ci id="S3.T6.1.1.1.m1.1.1.cmml" xref="S3.T6.1.1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.1.1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.T6.1.1.1.m1.1d">italic_K</annotation></semantics></math>-way</th>
<td class="ltx_td ltx_align_center" id="S3.T6.1.1.2">0.0820</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.1.3">0.0309</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.1.4">0.0592</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.1.5">0.0250</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T6.1.5.2.1">w/o Masking</th>
<td class="ltx_td ltx_align_center" id="S3.T6.1.5.2.2">0.0848</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.5.2.3">0.0332</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.5.2.4">0.0573</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.5.2.5">0.0253</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.6.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T6.1.6.3.1">Full*</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.1.6.3.2">0.0936</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.1.6.3.3">0.0348</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.1.6.3.4">0.0615</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.1.6.3.5">0.0276</td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<ul class="ltx_itemize ltx_centering ltx_figure_panel" id="S3.I9">
<li class="ltx_item" id="S3.I9.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I9.i1.p1">
<p class="ltx_p" id="S3.I9.i1.p1.1"><span class="ltx_text" id="S3.I9.i1.p1.1.1" style="font-size:80%;">* â€Fullâ€ denotes the complete version of TokenRec.</span></p>
</div>
</li>
</ul>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS6.4.1.1">III-F</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS6.5.2">Hyper-parameter Analysis</span>
</h3>
<div class="ltx_para" id="S3.SS6.p1">
<p class="ltx_p" id="S3.SS6.p1.3">In TokenRec, we introduce three critical hyper-parameters, namely the masking ratio <math alttext="\rho" class="ltx_Math" display="inline" id="S3.SS6.p1.1.m1.1"><semantics id="S3.SS6.p1.1.m1.1a"><mi id="S3.SS6.p1.1.m1.1.1" xref="S3.SS6.p1.1.m1.1.1.cmml">Ï</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.1.m1.1b"><ci id="S3.SS6.p1.1.m1.1.1.cmml" xref="S3.SS6.p1.1.m1.1.1">ğœŒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.1.m1.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.1.m1.1d">italic_Ï</annotation></semantics></math> in vector quantization, the number of sub-encoders/sub-codebooks <math alttext="K" class="ltx_Math" display="inline" id="S3.SS6.p1.2.m2.1"><semantics id="S3.SS6.p1.2.m2.1a"><mi id="S3.SS6.p1.2.m2.1.1" xref="S3.SS6.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.2.m2.1b"><ci id="S3.SS6.p1.2.m2.1.1.cmml" xref="S3.SS6.p1.2.m2.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.2.m2.1d">italic_K</annotation></semantics></math>, and the number of tokens <math alttext="L" class="ltx_Math" display="inline" id="S3.SS6.p1.3.m3.1"><semantics id="S3.SS6.p1.3.m3.1a"><mi id="S3.SS6.p1.3.m3.1.1" xref="S3.SS6.p1.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.3.m3.1b"><ci id="S3.SS6.p1.3.m3.1.1.cmml" xref="S3.SS6.p1.3.m3.1.1">ğ¿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.3.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.3.m3.1d">italic_L</annotation></semantics></math> in each sub-codebook.
Their value sensitivities are evaluated in this section to facilitate the future application of our proposed model.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS6.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS6.SSS1.5.2.1">III-F</span>1 </span><span class="ltx_text ltx_font_bold" id="S3.SS6.SSS1.1.1">Effect of Masking Ratio <math alttext="\rho" class="ltx_Math" display="inline" id="S3.SS6.SSS1.1.1.m1.1"><semantics id="S3.SS6.SSS1.1.1.m1.1b"><mi id="S3.SS6.SSS1.1.1.m1.1.1" xref="S3.SS6.SSS1.1.1.m1.1.1.cmml">Ï</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS1.1.1.m1.1c"><ci id="S3.SS6.SSS1.1.1.m1.1.1.cmml" xref="S3.SS6.SSS1.1.1.m1.1.1">ğœŒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS1.1.1.m1.1d">\rho</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS1.1.1.m1.1e">italic_Ï</annotation></semantics></math></span>
</h4>
<div class="ltx_para" id="S3.SS6.SSS1.p1">
<p class="ltx_p" id="S3.SS6.SSS1.p1.3">We first investigate the impact of the hyper-parameter <math alttext="\rho" class="ltx_Math" display="inline" id="S3.SS6.SSS1.p1.1.m1.1"><semantics id="S3.SS6.SSS1.p1.1.m1.1a"><mi id="S3.SS6.SSS1.p1.1.m1.1.1" xref="S3.SS6.SSS1.p1.1.m1.1.1.cmml">Ï</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS1.p1.1.m1.1b"><ci id="S3.SS6.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS6.SSS1.p1.1.m1.1.1">ğœŒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS1.p1.1.m1.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS1.p1.1.m1.1d">italic_Ï</annotation></semantics></math> in MQ-Tokenizer, which controls the masking ratio of our vector quantization for users&amp; items ID tokenization. FigureÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.F4" title="Figure 4 â€£ III-F1 Effect of Masking Ratio ğœŒ â€£ III-F Hyper-parameter Analysis â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">4</span></a> shows the performance change of TokenRec w.r.t. HR@20 and NDCG@20.
We can find that introducing a small ratio of masking brings performance improvements.
In most cases, the recommendation performance of our proposed method improves when <math alttext="\rho&lt;0.5" class="ltx_Math" display="inline" id="S3.SS6.SSS1.p1.2.m2.1"><semantics id="S3.SS6.SSS1.p1.2.m2.1a"><mrow id="S3.SS6.SSS1.p1.2.m2.1.1" xref="S3.SS6.SSS1.p1.2.m2.1.1.cmml"><mi id="S3.SS6.SSS1.p1.2.m2.1.1.2" xref="S3.SS6.SSS1.p1.2.m2.1.1.2.cmml">Ï</mi><mo id="S3.SS6.SSS1.p1.2.m2.1.1.1" xref="S3.SS6.SSS1.p1.2.m2.1.1.1.cmml">&lt;</mo><mn id="S3.SS6.SSS1.p1.2.m2.1.1.3" xref="S3.SS6.SSS1.p1.2.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS1.p1.2.m2.1b"><apply id="S3.SS6.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS6.SSS1.p1.2.m2.1.1"><lt id="S3.SS6.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS6.SSS1.p1.2.m2.1.1.1"></lt><ci id="S3.SS6.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS6.SSS1.p1.2.m2.1.1.2">ğœŒ</ci><cn id="S3.SS6.SSS1.p1.2.m2.1.1.3.cmml" type="float" xref="S3.SS6.SSS1.p1.2.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS1.p1.2.m2.1c">\rho&lt;0.5</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS1.p1.2.m2.1d">italic_Ï &lt; 0.5</annotation></semantics></math>, among which 0.2 can achieve the best improvement in our experiments.
The experimental results also reveal that the recommendation performance degrades when the masking ratio <math alttext="\rho&gt;=0.5" class="ltx_Math" display="inline" id="S3.SS6.SSS1.p1.3.m3.1"><semantics id="S3.SS6.SSS1.p1.3.m3.1a"><mrow id="S3.SS6.SSS1.p1.3.m3.1.1" xref="S3.SS6.SSS1.p1.3.m3.1.1.cmml"><mi id="S3.SS6.SSS1.p1.3.m3.1.1.2" xref="S3.SS6.SSS1.p1.3.m3.1.1.2.cmml">Ï</mi><mo id="S3.SS6.SSS1.p1.3.m3.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS6.SSS1.p1.3.m3.1.1.1.cmml">&gt;=</mo><mn id="S3.SS6.SSS1.p1.3.m3.1.1.3" xref="S3.SS6.SSS1.p1.3.m3.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS1.p1.3.m3.1b"><apply id="S3.SS6.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS6.SSS1.p1.3.m3.1.1"><geq id="S3.SS6.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS6.SSS1.p1.3.m3.1.1.1"></geq><ci id="S3.SS6.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS6.SSS1.p1.3.m3.1.1.2">ğœŒ</ci><cn id="S3.SS6.SSS1.p1.3.m3.1.1.3.cmml" type="float" xref="S3.SS6.SSS1.p1.3.m3.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS1.p1.3.m3.1c">\rho&gt;=0.5</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS1.p1.3.m3.1d">italic_Ï &gt; = 0.5</annotation></semantics></math>, suggesting excessive masking should be avoided.</p>
</div>
<figure class="ltx_figure" id="S3.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F4.sf1.g1" src="x4.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.sf1.2.1.1" style="font-size:80%;">(a)</span> </span><span class="ltx_text" id="S3.F4.sf1.3.2" style="font-size:80%;">LastFM - HR@20</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F4.sf2.g1" src="x5.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.sf2.2.1.1" style="font-size:80%;">(b)</span> </span><span class="ltx_text" id="S3.F4.sf2.3.2" style="font-size:80%;">ML1M - HR@20</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F4.sf3.g1" src="x6.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.sf3.2.1.1" style="font-size:80%;">(c)</span> </span><span class="ltx_text" id="S3.F4.sf3.3.2" style="font-size:80%;">Amazon-Beauty - HR@20</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F4.sf4.g1" src="x7.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.sf4.2.1.1" style="font-size:80%;">(d)</span> </span><span class="ltx_text" id="S3.F4.sf4.3.2" style="font-size:80%;">Amazon-Clothing - HR@20</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F4.sf5.g1" src="x8.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.sf5.2.1.1" style="font-size:80%;">(e)</span> </span><span class="ltx_text" id="S3.F4.sf5.3.2" style="font-size:80%;">LastFM - NDCG@20</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F4.sf6.g1" src="x9.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.sf6.2.1.1" style="font-size:80%;">(f)</span> </span><span class="ltx_text" id="S3.F4.sf6.3.2" style="font-size:80%;">ML1M - NDCG@20</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf7"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F4.sf7.g1" src="x10.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.sf7.2.1.1" style="font-size:80%;">(g)</span> </span><span class="ltx_text" id="S3.F4.sf7.3.2" style="font-size:80%;">Amazon-Beauty - NDCG@20</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf8"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F4.sf8.g1" src="x11.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.sf8.2.1.1" style="font-size:80%;">(h)</span> </span><span class="ltx_text" id="S3.F4.sf8.3.2" style="font-size:80%;">Amazon-Clothing - NDCG@20</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The effect of masking ratio <math alttext="\rho" class="ltx_Math" display="inline" id="S3.F4.2.m1.1"><semantics id="S3.F4.2.m1.1b"><mi id="S3.F4.2.m1.1.1" xref="S3.F4.2.m1.1.1.cmml">Ï</mi><annotation-xml encoding="MathML-Content" id="S3.F4.2.m1.1c"><ci id="S3.F4.2.m1.1.1.cmml" xref="S3.F4.2.m1.1.1">ğœŒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.2.m1.1d">\rho</annotation><annotation encoding="application/x-llamapun" id="S3.F4.2.m1.1e">italic_Ï</annotation></semantics></math> under HR@20 and NDCG@20 metrics.</figcaption>
</figure>
<figure class="ltx_figure" id="S3.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F5.sf1.g1" src="x12.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.sf1.2.1.1" style="font-size:80%;">(a)</span> </span><span class="ltx_text" id="S3.F5.sf1.3.2" style="font-size:80%;">LastFM - HR@20</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F5.sf2.g1" src="x13.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.sf2.2.1.1" style="font-size:80%;">(b)</span> </span><span class="ltx_text" id="S3.F5.sf2.3.2" style="font-size:80%;">ML1M - HR@20</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F5.sf3.g1" src="x14.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.sf3.2.1.1" style="font-size:80%;">(c)</span> </span><span class="ltx_text" id="S3.F5.sf3.3.2" style="font-size:80%;">Amazon-Beauty - HR@20</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F5.sf4.g1" src="x15.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.sf4.2.1.1" style="font-size:80%;">(d)</span> </span><span class="ltx_text" id="S3.F5.sf4.3.2" style="font-size:80%;">Amazon-Clothing - HR@20</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F5.sf5.g1" src="x16.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.sf5.2.1.1" style="font-size:80%;">(e)</span> </span><span class="ltx_text" id="S3.F5.sf5.3.2" style="font-size:80%;">LastFM - NDCG@20</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F5.sf6.g1" src="x17.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.sf6.2.1.1" style="font-size:80%;">(f)</span> </span><span class="ltx_text" id="S3.F5.sf6.3.2" style="font-size:80%;">ML1M - NDCG@20</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf7"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F5.sf7.g1" src="x18.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.sf7.2.1.1" style="font-size:80%;">(g)</span> </span><span class="ltx_text" id="S3.F5.sf7.3.2" style="font-size:80%;">Amazon-Beauty - NDCG@20</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf8"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F5.sf8.g1" src="x19.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.sf8.2.1.1" style="font-size:80%;">(h)</span> </span><span class="ltx_text" id="S3.F5.sf8.3.2" style="font-size:80%;">Amazon-Clothing - NDCG@20</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>The effect of the number of sub-codebooks <math alttext="K" class="ltx_Math" display="inline" id="S3.F5.3.m1.1"><semantics id="S3.F5.3.m1.1b"><mi id="S3.F5.3.m1.1.1" xref="S3.F5.3.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.F5.3.m1.1c"><ci id="S3.F5.3.m1.1.1.cmml" xref="S3.F5.3.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.3.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="S3.F5.3.m1.1e">italic_K</annotation></semantics></math> and the number of tokens in each sub-codebook <math alttext="J" class="ltx_Math" display="inline" id="S3.F5.4.m2.1"><semantics id="S3.F5.4.m2.1b"><mi id="S3.F5.4.m2.1.1" xref="S3.F5.4.m2.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S3.F5.4.m2.1c"><ci id="S3.F5.4.m2.1.1.cmml" xref="S3.F5.4.m2.1.1">ğ½</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.4.m2.1d">J</annotation><annotation encoding="application/x-llamapun" id="S3.F5.4.m2.1e">italic_J</annotation></semantics></math> under HR@20 and NDCG@20 metrics.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S3.SS6.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS6.SSS2.6.3.1">III-F</span>2 </span><span class="ltx_text ltx_font_bold" id="S3.SS6.SSS2.2.2">Effect of Codebook Settings <math alttext="K" class="ltx_Math" display="inline" id="S3.SS6.SSS2.1.1.m1.1"><semantics id="S3.SS6.SSS2.1.1.m1.1b"><mi id="S3.SS6.SSS2.1.1.m1.1.1" xref="S3.SS6.SSS2.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS2.1.1.m1.1c"><ci id="S3.SS6.SSS2.1.1.m1.1.1.cmml" xref="S3.SS6.SSS2.1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS2.1.1.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS2.1.1.m1.1e">italic_K</annotation></semantics></math> and <math alttext="L" class="ltx_Math" display="inline" id="S3.SS6.SSS2.2.2.m2.1"><semantics id="S3.SS6.SSS2.2.2.m2.1b"><mi id="S3.SS6.SSS2.2.2.m2.1.1" xref="S3.SS6.SSS2.2.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS2.2.2.m2.1c"><ci id="S3.SS6.SSS2.2.2.m2.1.1.cmml" xref="S3.SS6.SSS2.2.2.m2.1.1">ğ¿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS2.2.2.m2.1d">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS2.2.2.m2.1e">italic_L</annotation></semantics></math></span>
</h4>
<div class="ltx_para" id="S3.SS6.SSS2.p1">
<p class="ltx_p" id="S3.SS6.SSS2.p1.2">To study whether our proposed method TokenRec can benefit from stacking more sub-codebooks and introducing more codebook tokens, we vary the numbers of the hyper-parameters <math alttext="K" class="ltx_Math" display="inline" id="S3.SS6.SSS2.p1.1.m1.1"><semantics id="S3.SS6.SSS2.p1.1.m1.1a"><mi id="S3.SS6.SSS2.p1.1.m1.1.1" xref="S3.SS6.SSS2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS2.p1.1.m1.1b"><ci id="S3.SS6.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS6.SSS2.p1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS2.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS2.p1.1.m1.1d">italic_K</annotation></semantics></math> and <math alttext="L" class="ltx_Math" display="inline" id="S3.SS6.SSS2.p1.2.m2.1"><semantics id="S3.SS6.SSS2.p1.2.m2.1a"><mi id="S3.SS6.SSS2.p1.2.m2.1.1" xref="S3.SS6.SSS2.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS2.p1.2.m2.1b"><ci id="S3.SS6.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS6.SSS2.p1.2.m2.1.1">ğ¿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS2.p1.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS2.p1.2.m2.1d">italic_L</annotation></semantics></math> in the range of {1, 2, 3, 4, 5} and {128, 256, 512, 1024}, respectively, and report the performance on all datasets in FigureÂ <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#S3.F5" title="Figure 5 â€£ III-F1 Effect of Masking Ratio ğœŒ â€£ III-F Hyper-parameter Analysis â€£ III Experiment â€£ TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendations"><span class="ltx_text ltx_ref_tag">5</span></a>, with the optimal cases highlighted by black box.
From the figure, we can make the following observations.</p>
<ul class="ltx_itemize" id="S3.I10">
<li class="ltx_item" id="S3.I10.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I10.i1.p1">
<p class="ltx_p" id="S3.I10.i1.p1.2">With the increase of codebook depth, a progressive performance improvement of our model for recommendations is witnessed in all datasets.
Nevertheless, when <math alttext="K&gt;3" class="ltx_Math" display="inline" id="S3.I10.i1.p1.1.m1.1"><semantics id="S3.I10.i1.p1.1.m1.1a"><mrow id="S3.I10.i1.p1.1.m1.1.1" xref="S3.I10.i1.p1.1.m1.1.1.cmml"><mi id="S3.I10.i1.p1.1.m1.1.1.2" xref="S3.I10.i1.p1.1.m1.1.1.2.cmml">K</mi><mo id="S3.I10.i1.p1.1.m1.1.1.1" xref="S3.I10.i1.p1.1.m1.1.1.1.cmml">&gt;</mo><mn id="S3.I10.i1.p1.1.m1.1.1.3" xref="S3.I10.i1.p1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I10.i1.p1.1.m1.1b"><apply id="S3.I10.i1.p1.1.m1.1.1.cmml" xref="S3.I10.i1.p1.1.m1.1.1"><gt id="S3.I10.i1.p1.1.m1.1.1.1.cmml" xref="S3.I10.i1.p1.1.m1.1.1.1"></gt><ci id="S3.I10.i1.p1.1.m1.1.1.2.cmml" xref="S3.I10.i1.p1.1.m1.1.1.2">ğ¾</ci><cn id="S3.I10.i1.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.I10.i1.p1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I10.i1.p1.1.m1.1c">K&gt;3</annotation><annotation encoding="application/x-llamapun" id="S3.I10.i1.p1.1.m1.1d">italic_K &gt; 3</annotation></semantics></math>, the improvement of recommendation performance becomes relatively marginal.
As a result, <math alttext="K=3" class="ltx_Math" display="inline" id="S3.I10.i1.p1.2.m2.1"><semantics id="S3.I10.i1.p1.2.m2.1a"><mrow id="S3.I10.i1.p1.2.m2.1.1" xref="S3.I10.i1.p1.2.m2.1.1.cmml"><mi id="S3.I10.i1.p1.2.m2.1.1.2" xref="S3.I10.i1.p1.2.m2.1.1.2.cmml">K</mi><mo id="S3.I10.i1.p1.2.m2.1.1.1" xref="S3.I10.i1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S3.I10.i1.p1.2.m2.1.1.3" xref="S3.I10.i1.p1.2.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I10.i1.p1.2.m2.1b"><apply id="S3.I10.i1.p1.2.m2.1.1.cmml" xref="S3.I10.i1.p1.2.m2.1.1"><eq id="S3.I10.i1.p1.2.m2.1.1.1.cmml" xref="S3.I10.i1.p1.2.m2.1.1.1"></eq><ci id="S3.I10.i1.p1.2.m2.1.1.2.cmml" xref="S3.I10.i1.p1.2.m2.1.1.2">ğ¾</ci><cn id="S3.I10.i1.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.I10.i1.p1.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I10.i1.p1.2.m2.1c">K=3</annotation><annotation encoding="application/x-llamapun" id="S3.I10.i1.p1.2.m2.1d">italic_K = 3</annotation></semantics></math> is suggested by considering the trade-off between effectiveness and efficiency.</p>
</div>
</li>
<li class="ltx_item" id="S3.I10.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I10.i2.p1">
<p class="ltx_p" id="S3.I10.i2.p1.2">The optimal value of <math alttext="L" class="ltx_Math" display="inline" id="S3.I10.i2.p1.1.m1.1"><semantics id="S3.I10.i2.p1.1.m1.1a"><mi id="S3.I10.i2.p1.1.m1.1.1" xref="S3.I10.i2.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.I10.i2.p1.1.m1.1b"><ci id="S3.I10.i2.p1.1.m1.1.1.cmml" xref="S3.I10.i2.p1.1.m1.1.1">ğ¿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I10.i2.p1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.I10.i2.p1.1.m1.1d">italic_L</annotation></semantics></math> varies in relation to the differing sizes of users and items.
Specifically, the best-balanced performance in terms of effectiveness and efficiency can be observed at a <math alttext="L" class="ltx_Math" display="inline" id="S3.I10.i2.p1.2.m2.1"><semantics id="S3.I10.i2.p1.2.m2.1a"><mi id="S3.I10.i2.p1.2.m2.1.1" xref="S3.I10.i2.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.I10.i2.p1.2.m2.1b"><ci id="S3.I10.i2.p1.2.m2.1.1.cmml" xref="S3.I10.i2.p1.2.m2.1.1">ğ¿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I10.i2.p1.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.I10.i2.p1.2.m2.1d">italic_L</annotation></semantics></math> of 256 and 512 on the LastFM/ML1M (smaller sizes) and the Amazon-Beauty/Clothing (larger sizes) datasets, respectively.
This implies that slightly more codebook tokens should be used in each sub-codebook for datasets with more users/items.</p>
</div>
</li>
<li class="ltx_item" id="S3.I10.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I10.i3.p1">
<p class="ltx_p" id="S3.I10.i3.p1.1">Additionally, in the case of a single codebook, merely increasing the number of codebook tokens cannot effectively deliver performance gains in recommendations.
This demonstrates the effectiveness of the proposed <math alttext="K" class="ltx_Math" display="inline" id="S3.I10.i3.p1.1.m1.1"><semantics id="S3.I10.i3.p1.1.m1.1a"><mi id="S3.I10.i3.p1.1.m1.1.1" xref="S3.I10.i3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.I10.i3.p1.1.m1.1b"><ci id="S3.I10.i3.p1.1.m1.1.1.cmml" xref="S3.I10.i3.p1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I10.i3.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.I10.i3.p1.1.m1.1d">italic_K</annotation></semantics></math>-way mechanism in our MQ-Tokenizer for recommendations.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span class="ltx_text ltx_font_smallcaps" id="S4.1.1">Related Work</span>
</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we briefly review related work, including collaborative filtering and Large Language Models (LLMs).</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS1.4.1.1">IV-A</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS1.5.2">Collaborative Filtering</span>
</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">In order to provide personalized recommendations that accord with user preferences, collaborative filtering (CF) serves as a representative technique for modeling collaborative information in recommender systems, such as user-item interactions, to capture similar user patterns and predict future interactionsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib42" title="">42</a>]</cite>.
As a representative example, matrix factorization (MF)Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib43" title="">43</a>]</cite> vectorizes users and items into dense representations and models their interactions (i.e., user-item ID matrix) by calculating the inner products between the vectorized representations.
Subsequently, NeuCFÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib34" title="">34</a>]</cite> incorporates neural networks with MF to decompose the use-item interactions into two low-rank matrices representing user&amp;item embeddings.
Later on, DSCFÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib44" title="">44</a>]</cite> takes advantage of deep language models to enhance user representations for collaborative recommendations by capturing auxiliary information from neighbors in social networks.
Due to the superior representation learning capability in graphs, Graph Neural Networks (GNNs), such as LightGCNÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib5" title="">5</a>]</cite>, GTNÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib6" title="">6</a>]</cite>, and LTGNNÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib29" title="">29</a>]</cite>, are proposed to capture high-order collaborative knowledge on user-item interaction graphs for enhancing the performance of recommender systems.
More specifically, GNNs take advantage of the graph-structured nature of user-item interactions and model similar user behavior patterns toward items through information propagation on user-item interaction graphs.
For example, GraphRecÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib45" title="">45</a>]</cite> introduces a graph attention network-based framework to encode user-item interactions and user-user social relations for social recommendations.
LightGCNÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib5" title="">5</a>]</cite> is introduced to largely simplify the GNN-based recommendation methods by removing feature transformation and nonlinear activation, achieving state-of-the-art prediction performance for recommendations.
In addition, GTNÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib45" title="">45</a>]</cite> and LTGNNÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib29" title="">29</a>]</cite> provide an improvement by capturing the adaptive reliability and high-order linear-time patterns of interactions, respectively.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS2.4.1.1">IV-B</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS2.5.2">LLM-based Recommender Systems</span>
</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">With the rapid development of Large Language Models (LLMs), such as ChatGPT and GPT-4, notable milestones have been showcased for revolutionizing natural language processing techniquesÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib46" title="">46</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib47" title="">47</a>]</cite>.
Technically, the unprecedented power of LLMs can be attributed to the scaling up of model/parameter size alongside a tremendous amount of training corpusÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib48" title="">48</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib49" title="">49</a>]</cite>.
In particular, LLMs equipped with billion-scale parameters have exhibited unprecedented language understanding and generation ability, along with remarkable generalization capability and reasoning skills that facilitate LLMs to better generalize to unseen tasks and domainsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib50" title="">50</a>]</cite>.
Given the emerging trends and aforementioned advancements of LLMs, LLM-empowered recommender systems have drawn increasing attention from recent studies and demonstrated distinctive abilities for advancing recommender systemsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib25" title="">25</a>]</cite>.
Notably, to harness the distinctive capabilities of LLMs for advancing recommender systems, existing studies have actively investigated various paradigmsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib8" title="">8</a>]</cite>, including pre-training, fine-tuning, and prompting (e.g., in-context learning, chain-of-thought, and instruction tuning), for adapting LLMs to recommendation tasks.
For example, P5Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib10" title="">10</a>]</cite> introduces an LLM-based recommendation model that unifies diverse recommendation tasks by multi-task prompt-based pre-training, which achieves impressive zero-shot generalization capability to unseen recommendation tasks with the help of personalized prompts.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">Despite effectiveness, most LLM-based recommendation methods still have an intrinsic limitation on indexing users and itemsâ€™ IDs in language models.
The naive approach known as Independent Indexing (IID) directly assigns special tokens to represent users and items within language models.
Moreover, as a natural solution, textual title indexing is proposed to utilize textual contents (e.g., titles and description) to tokenize items using LLMsâ€™ in-vocabulary tokensÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib11" title="">11</a>]</cite>, such as the example â€<em class="ltx_emph ltx_font_italic" id="S4.SS2.p2.1.1">Apple iPhone 15, 256 GB, black</em>â€.
P5Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib10" title="">10</a>]</cite> and PODÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib39" title="">39</a>]</cite> apply positional and whole-word embeddings to highlight the tokens representing items and users.
Most recently, several studies borrow the conception of soft prompt and utilize exogenous tokens with continuous embeddings to represent users and items in LLM-based recommendationsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib13" title="">13</a>]</cite>.
Although the use of title indexing and whole-word embeddings can mitigate the issue of vocabulary explosion, it fails to capture high-order collaborative knowledge effectively and lacks generalizability for recommending to unseen users or items, as seen in P5Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib10" title="">10</a>]</cite> and PODÂ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.10450v2#bib.bib39" title="">39</a>]</cite>.
Furthermore, the discrete nature of tokens in language models presents a challenge in achieving tight alignment of LLMs in recommendations when utilizing continuous representations.
Additionally, most LLM-based RecSys suffer from time-consuming inference due to auto-regressive decoding and beam search.
However, the majority of existing methods for users&amp;items tokenization fail to capture high-order collaborative knowledge in personalized recommendations effectively.
Thus, this paper proposes a novel framework for LLM-based recommendations, TokenRec, which not only introduces a generalizable ID tokenization strategy to capture high-order collaborative knowledge but also proposes a generative retrieval paradigm to generate top-<math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_K</annotation></semantics></math> items efficiently.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span class="ltx_text ltx_font_smallcaps" id="S5.1.1">Conclusion</span>
</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">While existing large language model-based recommendation methods achieve promising prediction performance, they fail to capture high-order collaborative knowledge and suffer from inferior generalization capability for tokenizing users&amp;items.
Additionally, the time-consuming inference remains an emerging challenge in LLM-based recommender systems.
To tackle these shortcomings, we propose a novel approach, named TokenRec, which not only introduces a generalizable user&amp;item ID tokenization strategy to capture high-order collaborative knowledge but also presents a generative retrieval paradigm for the efficient generation of top-<math alttext="K" class="ltx_Math" display="inline" id="S5.p1.1.m1.1"><semantics id="S5.p1.1.m1.1a"><mi id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><ci id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.p1.1.m1.1d">italic_K</annotation></semantics></math> items.
Particularly, a Masked Vector-Quantized Tokenizer (MQ-Tokenizer) is developed to tokenize users and items in LLM-based recommendations by incorporating high-order collaborative knowledge.
Through comprehensive experiments on four distinct datasets, we demonstrated that our model can achieve state-of-the-art recommendation performance while also exhibiting the capacity to generalize to unseen users.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
X.Â Chen, W.Â Fan, J.Â Chen, H.Â Liu, Z.Â Liu, Z.Â Zhang, and Q.Â Li, â€œFairly
adaptive negative sampling for recommendations,â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Proceedings of the
ACM Web Conference 2023</em>, 2023, pp. 3723â€“3733.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Z.Â Zhao, W.Â Fan, J.Â Li, Y.Â Liu, X.Â Mei, Y.Â Wang, Z.Â Wen, F.Â Wang, X.Â Zhao,
J.Â Tang <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">etÂ al.</em>, â€œRecommender systems in the era of large language
models (llms),â€ <em class="ltx_emph ltx_font_italic" id="bib.bib2.2.2">IEEE Transactions on Knowledge and Data Engineering</em>,
2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
W.Â Fan, Y.Â Ma, Q.Â Li, Y.Â He, E.Â Zhao, J.Â Tang, and D.Â Yin, â€œGraph neural
networks for social recommendation,â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">WWW</em>, 2019, pp. 417â€“426.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Y.Â Koren, R.Â Bell, and C.Â Volinsky, â€œMatrix factorization techniques for
recommender systems,â€ <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Computer</em>, vol.Â 42, no.Â 8, pp. 30â€“37, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
X.Â He, K.Â Deng, X.Â Wang, Y.Â Li, Y.Â Zhang, and M.Â Wang, â€œLightgcn: Simplifying
and powering graph convolution network for recommendation,â€ in
<em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the 43rd International ACM SIGIR conference on research
and development in Information Retrieval</em>, 2020, pp. 639â€“648.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
W.Â Fan, X.Â Liu, W.Â Jin, X.Â Zhao, J.Â Tang, and Q.Â Li, â€œGraph trend filtering
networks for recommendation,â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the 45th International
ACM SIGIR Conference on Research and Development in Information Retrieval</em>,
2022, pp. 112â€“121.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
T.Â Brown, B.Â Mann, N.Â Ryder, M.Â Subbiah, J.Â D. Kaplan, P.Â Dhariwal,
A.Â Neelakantan, P.Â Shyam, G.Â Sastry, A.Â Askell <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">etÂ al.</em>, â€œLanguage
models are few-shot learners,â€ <em class="ltx_emph ltx_font_italic" id="bib.bib7.2.2">Advances in neural information
processing systems</em>, vol.Â 33, pp. 1877â€“1901, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
W.Â X. Zhao, K.Â Zhou, J.Â Li, T.Â Tang, X.Â Wang, Y.Â Hou, Y.Â Min, B.Â Zhang,
J.Â Zhang, Z.Â Dong <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">etÂ al.</em>, â€œA survey of large language models,â€
<em class="ltx_emph ltx_font_italic" id="bib.bib8.2.2">arXiv preprint arXiv:2303.18223</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Y.Â Gao, T.Â Sheng, Y.Â Xiang, Y.Â Xiong, H.Â Wang, and J.Â Zhang, â€œChat-rec:
Towards interactive and explainable llms-augmented recommender system,â€
<em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:2303.14524</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
S.Â Geng, S.Â Liu, Z.Â Fu, Y.Â Ge, and Y.Â Zhang, â€œRecommendation as language
processing (rlp): A unified pretrain, personalized prompt &amp; predict paradigm
(p5),â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Proceedings of the 16th ACM Conference on Recommender
Systems</em>, 2022, pp. 299â€“315.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
K.Â Bao, J.Â Zhang, Y.Â Zhang, W.Â Wang, F.Â Feng, and X.Â He, â€œTallrec: An
effective and efficient tuning framework to align large language model with
recommendation,â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Proceedings of the 17th ACM Conference on
Recommender Systems</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
S.Â Takase and S.Â Kobayashi, â€œAll word embeddings from one embedding,â€
<em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Advances in Neural Information Processing Systems</em>, vol.Â 33, pp.
3775â€“3785, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
J.Â Liao, S.Â Li, Z.Â Yang, J.Â Wu, Y.Â Yuan, X.Â Wang, and X.Â He, â€œLlara: Aligning
large language models with sequential recommenders,â€ <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint
arXiv:2312.02445</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Y.Â Zhang, F.Â Feng, J.Â Zhang, K.Â Bao, Q.Â Wang, and X.Â He, â€œCollm: Integrating
collaborative embeddings into large language models for recommendation,â€
<em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2310.19488</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
P.Â Esser, R.Â Rombach, and B.Â Ommer, â€œTaming transformers for high-resolution
image synthesis,â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the IEEE/CVF conference on
computer vision and pattern recognition</em>, 2021, pp. 12â€‰873â€“12â€‰883.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
A.Â Ramesh, M.Â Pavlov, G.Â Goh, S.Â Gray, C.Â Voss, A.Â Radford, M.Â Chen, and
I.Â Sutskever, â€œZero-shot text-to-image generation,â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">International
Conference on Machine Learning</em>.Â Â Â PMLR,
2021, pp. 8821â€“8831.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
A.Â Van DenÂ Oord, O.Â Vinyals <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">etÂ al.</em>, â€œNeural discrete representation
learning,â€ <em class="ltx_emph ltx_font_italic" id="bib.bib17.2.2">Advances in neural information processing systems</em>,
vol.Â 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
X.Â Wang, X.Â He, M.Â Wang, F.Â Feng, and T.-S. Chua, â€œNeural graph collaborative
filtering,â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the 42nd international ACM SIGIR
conference on Research and development in Information Retrieval</em>, 2019, pp.
165â€“174.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
H.Â Wang, S.Â Feng, T.Â He, Z.Â Tan, X.Â Han, and Y.Â Tsvetkov, â€œCan language models
solve graph problems in natural language?â€ <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Advances in Neural
Information Processing Systems</em>, vol.Â 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Q.Â Berthet, M.Â Blondel, O.Â Teboul, M.Â Cuturi, J.-P. Vert, and F.Â Bach,
â€œLearning with differentiable pertubed optimizers,â€ <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Advances in
neural information processing systems</em>, vol.Â 33, pp. 9508â€“9519, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
G.Â Lorberbom, A.Â Gane, T.Â Jaakkola, and T.Â Hazan, â€œDirect optimization through
argmax for discrete variational auto-encoder,â€ <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Advances in neural
information processing systems</em>, vol.Â 32, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Y.Â Bengio, N.Â LÃ©onard, and A.Â Courville, â€œEstimating or propagating
gradients through stochastic neurons for conditional computation,â€
<em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:1308.3432</em>, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
H.Â Touvron, T.Â Lavril, G.Â Izacard, X.Â Martinet, M.-A. Lachaux, T.Â Lacroix,
B.Â RoziÃ¨re, N.Â Goyal, E.Â Hambro, F.Â Azhar <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">etÂ al.</em>, â€œLlama: Open
and efficient foundation language models,â€ <em class="ltx_emph ltx_font_italic" id="bib.bib23.2.2">arXiv preprint
arXiv:2302.13971</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
B.Â Zheng, Y.Â Hou, H.Â Lu, Y.Â Chen, W.Â X. Zhao, and J.-R. Wen, â€œAdapting large
language models by integrating collaborative semantics for recommendation,â€
<em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:2311.09049</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
H.Â Wang, X.Â Liu, W.Â Fan, X.Â Zhao, V.Â Kini, D.Â Yadav, F.Â Wang, Z.Â Wen, J.Â Tang,
and H.Â Liu, â€œRethinking large language model architectures for sequential
recommendations,â€ <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2402.09543</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
F.Â Cakir, K.Â He, X.Â Xia, B.Â Kulis, and S.Â Sclaroff, â€œDeep metric learning to
rank,â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the IEEE/CVF conference on computer vision
and pattern recognition</em>, 2019, pp. 1861â€“1870.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
B.Â McFee and G.Â Lanckriet, â€œMetric learning to rank,â€ 2010.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
T.-Y. Liu <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">etÂ al.</em>, â€œLearning to rank for information retrieval,â€
<em class="ltx_emph ltx_font_italic" id="bib.bib28.2.2">Foundations and TrendsÂ® in Information Retrieval</em>,
vol.Â 3, no.Â 3, pp. 225â€“331, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
J.Â Zhang, R.Â Xue, W.Â Fan, X.Â Xu, Q.Â Li, J.Â Pei, and X.Â Liu, â€œLinear-time graph
neural networks for scalable recommendations,â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the
ACM on Web Conference 2024</em>, 2024, pp. 3533â€“3544.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
N.Â F. Liu, K.Â Lin, J.Â Hewitt, A.Â Paranjape, M.Â Bevilacqua, F.Â Petroni, and
P.Â Liang, â€œLost in the middle: How language models use long contexts,â€
<em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Transactions of the Association for Computational Linguistics</em>,
vol.Â 12, pp. 157â€“173, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
M.Â Kaneko and N.Â Okazaki, â€œReducing sequence length by predicting edit spans
with large language models,â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the 2023 Conference on
Empirical Methods in Natural Language Processing</em>, 2023, pp.
10â€‰017â€“10â€‰029.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
C.Â Raffel, N.Â Shazeer, A.Â Roberts, K.Â Lee, S.Â Narang, M.Â Matena, Y.Â Zhou,
W.Â Li, and P.Â J. Liu, â€œExploring the limits of transfer learning with a
unified text-to-text transformer,â€ <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Journal of machine learning
research</em>, vol.Â 21, no. 140, pp. 1â€“67, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
S.Â Rendle, C.Â Freudenthaler, Z.Â Gantner, and L.Â Schmidt-Thieme, â€œBpr: Bayesian
personalized ranking from implicit feedback,â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">UAI</em>, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
X.Â He, L.Â Liao, H.Â Zhang, L.Â Nie, X.Â Hu, and T.-S. Chua, â€œNeural collaborative
filtering,â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Proceedings of the 26th international conference on
world wide web</em>, 2017, pp. 173â€“182.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
W.-C. Kang and J.Â McAuley, â€œSelf-attentive sequential recommendation,â€ in
<em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">2018 IEEE international conference on data mining (ICDM)</em>.Â Â Â IEEE, 2018, pp. 197â€“206.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
F.Â Sun, J.Â Liu, J.Â Wu, C.Â Pei, X.Â Lin, W.Â Ou, and P.Â Jiang, â€œBert4rec:
Sequential recommendation with bidirectional encoder representations from
transformer,â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Proceedings of the 28th ACM international conference
on information and knowledge management</em>, 2019, pp. 1441â€“1450.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
K.Â Zhou, H.Â Wang, W.Â X. Zhao, Y.Â Zhu, S.Â Wang, F.Â Zhang, Z.Â Wang, and J.-R.
Wen, â€œS3-rec: Self-supervised learning for sequential recommendation with
mutual information maximization,â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Proceedings of the 29th ACM
international conference on information &amp; knowledge management</em>, 2020, pp.
1893â€“1902.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
W.Â Hua, S.Â Xu, Y.Â Ge, and Y.Â Zhang, â€œHow to index item ids for recommendation
foundation models,â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Proceedings of the Annual International ACM
SIGIR Conference on Research and Development in Information Retrieval in the
Asia Pacific Region</em>, 2023, pp. 195â€“204.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
L.Â Li, Y.Â Zhang, and L.Â Chen, â€œPrompt distillation for efficient llm-based
recommendation,â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Proceedings of the 32nd ACM International
Conference on Information and Knowledge Management</em>, 2023, pp. 1348â€“1357.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
I.Â Loshchilov and F.Â Hutter, â€œDecoupled weight decay regularization,â€ in
<em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Proceeding of the 7th International Conference on Learning
Representations</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
W.Â Fan, T.Â Derr, X.Â Zhao, Y.Â Ma, H.Â Liu, J.Â Wang, J.Â Tang, and Q.Â Li,
â€œAttacking black-box recommendations via copying cross-domain user
profiles,â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">2021 IEEE 37th International Conference on Data
Engineering (ICDE)</em>.Â Â Â IEEE, 2021, pp.
1583â€“1594.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
W.Â Fan, T.Â Derr, Y.Â Ma, J.Â Wang, J.Â Tang, and Q.Â Li, â€œDeep adversarial social
recommendation,â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">28th International Joint Conference on Artificial
Intelligence (IJCAI-19)</em>.Â Â Â International Joint Conferences on Artificial Intelligence, 2019, pp.
1351â€“1357.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
W.Â Fan, Q.Â Li, and M.Â Cheng, â€œDeep modeling of social relations for
recommendation,â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Proceedings of the AAAI Conference on Artificial
Intelligence</em>, vol.Â 32, no.Â 1, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
W.Â Fan, Y.Â Ma, D.Â Yin, J.Â Wang, J.Â Tang, and Q.Â Li, â€œDeep social collaborative
filtering,â€ in <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Proceedings of the 13th ACM conference on recommender
systems</em>, 2019, pp. 305â€“313.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
W.Â Fan, Y.Â Ma, Q.Â Li, J.Â Wang, G.Â Cai, J.Â Tang, and D.Â Yin, â€œA graph neural
network framework for social recommendations,â€ <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">IEEE Transactions on
Knowledge and Data Engineering</em>, vol.Â 34, no.Â 5, pp. 2033â€“2047, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Y.Â Ding, W.Â Fan, L.Â Ning, S.Â Wang, H.Â Li, D.Â Yin, T.-S. Chua, and Q.Â Li, â€œA
survey on rag meets llms: Towards retrieval-augmented large language
models,â€ <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">arXiv preprint arXiv:2405.06211</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Y.Â Ding, Y.Â Ma, W.Â Fan, Y.Â Yao, T.-S. Chua, and Q.Â Li, â€œFashionregen:
Llm-empowered fashion report generation,â€ <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">arXiv preprint
arXiv:2403.06660</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
W.Â Fan, S.Â Wang, J.Â Huang, Z.Â Chen, Y.Â Song, W.Â Tang, H.Â Mao, H.Â Liu, X.Â Liu,
D.Â Yin <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">etÂ al.</em>, â€œGraph machine learning in the era of large language
models (llms),â€ <em class="ltx_emph ltx_font_italic" id="bib.bib48.2.2">arXiv preprint arXiv:2404.14928</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
J.Â Li, Y.Â Liu, W.Â Fan, X.-Y. Wei, H.Â Liu, J.Â Tang, and Q.Â Li, â€œEmpowering
molecule discovery for molecule-caption translation with large language
models: A chatgpt perspective,â€ <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">IEEE Transactions on Knowledge and
Data Engineering</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Z.Â Chen, H.Â Mao, H.Â Li, W.Â Jin, H.Â Wen, X.Â Wei, S.Â Wang, D.Â Yin, W.Â Fan, H.Â Liu
<em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">etÂ al.</em>, â€œExploring the potential of large language models (llms) in
learning on graphs,â€ <em class="ltx_emph ltx_font_italic" id="bib.bib50.2.2">ACM SIGKDD Explorations Newsletter</em>, vol.Â 25,
no.Â 2, pp. 42â€“61, 2024.

</span>
</li>
</ul>
</section>
<figure class="ltx_float biography" id="id2">
<table class="ltx_tabular" id="id2.1">
<tr class="ltx_tr" id="id2.1.1">
<td class="ltx_td" id="id2.1.1.1"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_portrait" height="125" id="id2.1.1.1.g1" src="extracted/5798033/photos/haohao.jpg" width="97"/></td>
<td class="ltx_td" id="id2.1.1.2">
<span class="ltx_inline-block" id="id2.1.1.2.1">
<span class="ltx_p" id="id2.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="id2.1.1.2.1.1.1">Haohao Qu</span>  is currently a PhD student of the Department of Computing (COMP), The Hong Kong Polytechnic University (PolyU), under the supervision of Dr. Wenqi Fan and Prof. Qing Li. Before joining the PolyU, he received both a Masterâ€™s degree and a Bachelorâ€™s degree from Sun Yat-sen University in 2022 and 2019, respectively. His research interest covers Recommender Systems and Large Language Models. He has published innovative works in top-tier journals such as IEEE-TITS and IoT-J. For more information, please visit https://quhaoh233.github.io/page.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure class="ltx_float biography" id="id3">
<table class="ltx_tabular" id="id3.1">
<tr class="ltx_tr" id="id3.1.1">
<td class="ltx_td" id="id3.1.1.1"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_square" height="119" id="id3.1.1.1.g1" src="extracted/5798033/photos/wenqi.jpeg" width="100"/></td>
<td class="ltx_td" id="id3.1.1.2">
<span class="ltx_inline-block" id="id3.1.1.2.1">
<span class="ltx_p" id="id3.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="id3.1.1.2.1.1.1">Wenqi Fan</span>  is an assistant professor of the Department of Computing (COMP) and the Department of Management and Marketing (MM) at The Hong Kong Polytechnic University (PolyU). He received his Ph.D. degree from the City University of Hong Kong (CityU) in 2020.
From 2018 to 2020, he was a visiting research scholar at Michigan State University (MSU).
His research interests are in the broad areas of machine learning and data mining, with a particular focus on Recommender Systems, Graph Neural Networks, and Trustworthy Recommendations. He has published innovative papers in top-tier journals and conferences such as TKDE, TIST, KDD, WWW, ICDE, NeurIPS, ICLR, SIGIR, IJCAI, AAAI, RecSys, WSDM, etc.
He serves as top-tier conference (Area/Senior) Program Committee members and session chairs (e.g., ICML, ICLR, NeurIPS, KDD, WWW, AAAI, IJCAI, WSDM, EMNLP, ACL, etc.), and journal reviewers (e.g., TKDE, TIST, TKDD, TOIS, TAI, etc.).
More information about him can be found at https://wenqifan03.github.io.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure class="ltx_float biography" id="id4">
<table class="ltx_tabular" id="id4.1">
<tr class="ltx_tr" id="id4.1.1">
<td class="ltx_td" id="id4.1.1.1"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_portrait" height="125" id="id4.1.1.1.g1" src="extracted/5798033/photos/zihuai.jpeg" width="94"/></td>
<td class="ltx_td" id="id4.1.1.2">
<span class="ltx_inline-block" id="id4.1.1.2.1">
<span class="ltx_p" id="id4.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="id4.1.1.2.1.1.1">Zihuai Zhao</span>  is currently a PhD student of the Department of Computing (COMP), Hong Kong Polytechnic University (PolyU), under the supervision of Prof. Qing Li and Dr. Wenqi Fan. Before joining the PolyU, he received both a Masterâ€™s degree (MPhil in Electrical Engineering) and a Bachelorâ€™s degree (B.Eng. (Hons) in Electrical Engineering) from the University of Sydney in 2023 and 2020, respectively. His research interest covers Recommender Systems, Natural Language Processing, and Deep Reinforcement Learning. He has published innovative works in top-tier journals such as IEEE-TKDE and IoT-J. For more information, please visit https://scofizz.github.io/.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure class="ltx_float biography" id="id5">
<table class="ltx_tabular" id="id5.1">
<tr class="ltx_tr" id="id5.1.1">
<td class="ltx_td" id="id5.1.1.1"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_portrait" height="125" id="id5.1.1.1.g1" src="extracted/5798033/photos/qingli.jpeg" width="82"/></td>
<td class="ltx_td" id="id5.1.1.2">
<span class="ltx_inline-block" id="id5.1.1.2.1">
<span class="ltx_p" id="id5.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="id5.1.1.2.1.1.1">Qing Li</span> 
received the B.Eng. degree from Hunan University, Changsha, China, and the M.Sc. and Ph.D. degrees from the University of Southern California, Los Angeles, all in computer science.
He is currently a Chair Professor (Data Science) and the Head of the Department of Computing, the Hong Kong Polytechnic University. He is a Fellow of IEEE and IET, a member of ACM SIGMOD and IEEE Technical Committee on Data Engineering.
His research interests include object modeling, multimedia databases, social media, and recommender systems.
He has been actively involved in the research community by serving as an associate editor and reviewer for technical journals, and as an organizer/co-organizer of numerous international conferences. He is the chairperson of the Hong Kong Web Society, and also served/is serving as an executive committee (EXCO) member of IEEE-Hong Kong Computer Chapter and ACM Hong Kong Chapter. In addition, he serves as a councilor of the Database Society of Chinese Computer Federation (CCF), a member of the Big Data Expert Committee of CCF, and is a Steering Committee member of DASFAA, ER, ICWL, UMEDIA, and WISE Society.</span>
</span>
</td>
</tr>
</table>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sun Aug 18 07:53:10 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
