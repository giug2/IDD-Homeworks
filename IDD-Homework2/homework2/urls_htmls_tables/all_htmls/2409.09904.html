<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2409.09904] Enhancing Visual Inertial SLAM with Magnetic Measurements</title><meta property="og:description" content="This paper presents an extension to visual inertial odometry (VIO) by introducing tightly-coupled fusion of magnetometer measurements. A sliding window of keyframes is optimized by minimizing re-projection errors, rela…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Enhancing Visual Inertial SLAM with Magnetic Measurements">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Enhancing Visual Inertial SLAM with Magnetic Measurements">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2409.09904">

<!--Generated on Sat Oct  5 23:05:45 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p"><pre id="p1.1.1" class="ltx_verbatim ltx_font_typewriter">file}
      \verb RahmanOceans2018.pdf
      \endverb
    \endentry
    \entry</pre><span id="p1.1.2" class="ltx_text">okvisarticle


















<pre id="p1.1.2.1" class="ltx_verbatim ltx_font_typewriter">doi}
      \verb 10.1177/0278364914554813
      \endverb
    \endentry
    \entry</pre>qin2017vins_monoarticle

















































































<span id="p1.1.2.2" class="ltx_ERROR undefined">\true</span>moreauthor
<span id="p1.1.2.3" class="ltx_ERROR undefined">\true</span>morelabelname
































































































<pre id="p1.1.2.4" class="ltx_verbatim ltx_font_typewriter">file}
      \verb JoshiAUV2022.pdf
      \endverb
    \endentry
    \entry</pre>colmap_sfminproceedings

































<pre id="p1.1.2.5" class="ltx_verbatim ltx_font_typewriter">file}
      \verb RekleitisISERVO2016.pdf
      \endverb
    \endentry
    \entry</pre>JoshiIROS2019inproceedings





















<pre id="p1.1.2.6" class="ltx_verbatim ltx_font_typewriter">doi}
      \verb https://doi.org/10.1109/iros40897.2019.8968049
      \endverb
      \verb</pre>file
<code id="p1.1.2.7" class="ltx_verbatim ltx_font_typewriter">ROS19_0500_F</code>.pdf
<span id="p1.1.2.8" class="ltx_ERROR undefined">\endverb</span><pre id="p1.1.2.9" class="ltx_verbatim ltx_font_typewriter">urlraw}
      \verb https://arxiv.org/abs/1904.02215
      \endverb
      \verb</pre>url
<pre id="p1.1.2.10" class="ltx_verbatim ltx_font_typewriter">ttps://arxiv.org/abs/1904.02215
      \endverb
    \endentry
    \entry{Ra</pre>manICRA2018inproceedings





















<pre id="p1.1.2.11" class="ltx_verbatim ltx_font_typewriter">doi}
      \verb https://doi.org/10.1109/icra.2018.8460545
      \endverb
      \verb</pre>file
<code id="p1.1.2.12" class="ltx_verbatim ltx_font_typewriter">ahmanIC</code>A2018.pdf
<span id="p1.1.2.13" class="ltx_ERROR undefined">\endverb</span>





















<pre id="p1.1.2.14" class="ltx_verbatim ltx_font_typewriter">doi}
      \verb https://doi.org/10.1109/iros40897.2019.8967703
      \endverb
      \verb</pre>file
<code id="p1.1.2.15" class="ltx_verbatim ltx_font_typewriter">ROS19_0269_F</code>.pdf
<span id="p1.1.2.16" class="ltx_ERROR undefined">\endverb</span>






















<pre id="p1.1.2.17" class="ltx_verbatim ltx_font_typewriter">doi}
      \verb 10.1177/02783649221110259
      \endverb
      \verb</pre>file
<code id="p1.1.2.18" class="ltx_verbatim ltx_font_typewriter">ahmanIJ</code>R2022.pdf
<span id="p1.1.2.19" class="ltx_ERROR undefined">\endverb</span>




















<pre id="p1.1.2.20" class="ltx_verbatim ltx_font_typewriter">file}
      \verb ICRA22_1224_FI.pdf
      \endverb
    \endentry
    \entry</pre>orbslam3article

















































<pre id="p1.1.2.21" class="ltx_verbatim ltx_font_typewriter">doi}
      \verb 10.1109/ICORR.2011.5975346
      \endverb
    \endentry
    \entry</pre>complimentary_filterarticle



















<pre id="p1.1.2.22" class="ltx_verbatim ltx_font_typewriter">doi}
      \verb 10.3390/s150819302
      \endverb
      \verb</pre>urlraw
<pre id="p1.1.2.23" class="ltx_verbatim ltx_font_typewriter">ttps://www.mdpi.com/1424-8220/15/8/19302
      \endverb
      \verb{url}
      \verb </pre>ttps://www.mdpi.com/1424-8220/15/8/19302
<span id="p1.1.2.24" class="ltx_ERROR undefined">\endverb</span>


















<pre id="p1.1.2.25" class="ltx_verbatim ltx_font_typewriter">doi}
      \verb 10.1109/JSEN.2011.2166066
      \endverb
    \endentry
    \entry</pre>wang_vimoarticle

















<pre id="p1.1.2.26" class="ltx_verbatim ltx_font_typewriter">urlraw}
      \verb https://www.mdpi.com/1424-8220/20/16/4386
      \endverb
      \verb</pre>url
<pre id="p1.1.2.27" class="ltx_verbatim ltx_font_typewriter">ttps://www.mdpi.com/1424-8220/20/16/4386
      \endverb
    \endentry
    \entry{Siebler}{article}{}
      \name{aut</pre>or3hash=5318b743078945b6b7a0a4d820f41845family=Siebler,
familyi=S.,
given=Benjamin,
giveni=B.hash=8bf107a2f05747ae4d366f50266dfcc6family=Sand,
familyi=S.,
given=Stephan,
giveni=S.hash=5520e2275056a55170c6896464012581family=Hanebeck,
familyi=H.,
given=Uwe D.,
giveni=U.D.

















<pre id="p1.1.2.28" class="ltx_verbatim ltx_font_typewriter">doi}
      \verb 10.1109/JSEN.2020.3024073
      \endverb
    \endentry
    \entry</pre>caruso_mimuinproceedings

















<pre id="p1.1.2.29" class="ltx_verbatim ltx_font_typewriter">doi}
      \verb 10.1109/IROS.2017.8206304
      \endverb
    \endentry
    \entry</pre>caruso_mimu_kfinproceedings

















<pre id="p1.1.2.30" class="ltx_verbatim ltx_font_typewriter">doi}
      \verb 10.1109/IPIN.2017.8115888
      \endverb
    \endentry
    \entry</pre>mag_extra_calibarticle





































<pre id="p1.1.2.31" class="ltx_verbatim ltx_font_typewriter">doi}
      \verb 10.1109/TAES.2011.5751259
      \endverb
    \endentry
    \entry</pre>magnetometer_inertial_calibrationarticle


















<pre id="p1.1.2.32" class="ltx_verbatim ltx_font_typewriter">doi}
      \verb 10.1109/JSEN.2016.2569160
      \endverb
    \endentry
    \entry</pre>solin_gaussianarticle


















<pre id="p1.1.2.33" class="ltx_verbatim ltx_font_typewriter">doi}
      \verb 10.1109/TRO.2018.2830326
      \endverb
    \endentry
    \entry</pre>quatenrion_solamisc













<pre id="p1.1.2.34" class="ltx_verbatim ltx_font_typewriter">eprint}
      \verb arXiv:1711.02508
      \endverb
    \endentry
    \entry</pre>kalibrinproceedings
















<pre id="p1.1.2.35" class="ltx_verbatim ltx_font_typewriter">doi}
      \verb 10.1109/IROS.2013.6696514
      \endverb
    \endentry
    \entry</pre>ieee_imu_standardarticle








<pre id="p1.1.2.36" class="ltx_verbatim ltx_font_typewriter">doi}
      \verb 10.1109/IEEESTD.2021.9353434
      \endverb
    \endentry
    \entry</pre>mag_ellipsoidarticle


















<pre id="p1.1.2.37" class="ltx_verbatim ltx_font_typewriter">doi}
      \verb 10.1109/JSEN.2015.2459767
      \endverb
    \endentry
    \entry</pre>umeyamaarticle


















<pre id="p1.1.2.38" class="ltx_verbatim ltx_font_typewriter">doi}
      \verb 10.1109/34.88573
      \endverb
    \endentry
    \entry</pre>absolute_traj_errorinproceedings
















<pre id="p1.1.2.39" class="ltx_verbatim ltx_font_typewriter">doi}
      \verb 10.1109/IROS.2012.6385773
      \endverb
    \endentry
    \entry</pre>Zhang18irosinproceedings


















































<code id="p1.1.2.40" class="ltx_verbatim"></code>file˝
      “verb iros05-1053.pdf
      “endverb
    “endentry
  “enddatalist
“endrefsection
“endinput


<span id="p1.1.2.41" class="ltx_inline-block ltx_minipage ltx_align_middle" style="width:390.3pt;">
<span id="p1.1.2.41.1" class="ltx_p ltx_align_center">This paper has been accepted for publication in <span id="p1.1.2.41.1.1" class="ltx_text ltx_font_italic">IEEE Conference on Robotics and Automation 2024</span>.</span>
<span id="p1.1.2.41.2" class="ltx_p">©2024 IEEE. Personal use of this material is permitted. Permission from IEEE must be obtained for all other uses, in any current or future media, including reprinting/republishing this material for advertising or promotional purposes, creating new collective works, for resale or redistribution to servers or lists, or reuse of any copyrighted component of this work in other works.</span>
<div class="ltx_pagination ltx_role_newpage"></div>
</span></span></p>
</div>
<h1 class="ltx_title ltx_font_bold ltx_title_document" style="font-size:173%;">Enhancing Visual Inertial SLAM with Magnetic Measurements
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Bharat Joshi and Ioannis Rekleitis
</span><span class="ltx_author_notes"><span class="ltx_rule" style="width:142.3pt;height:0.5pt;background:black;display:inline-block;"> </span>The authors are with the Department of Computer Science and Engineering, University of South Carolina, Columbia, SC 29208, USA. <span id="id1.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">bjoshi@email.sc.edu, yiannisr@cse.sc.edu.</span>This research has been supported in part by the National Science Foundation under grants 1943205 and 2024741. The authors also acknowledge the help of the Woodville Karst Plain Project (WKPP), El Centro Investigador del Sistema Acuífero de Quintana Roo A.C. (CINDAQ), Ricardo Constantino, Project Baseline, and Evan Kornacki in collecting data, providing access to challenging underwater caves, and mentoring us in underwater cave exploration. The authors are also grateful for equipment support by Halcyon Dive Systems, Teledyne FLIR LLC, and KELDAN GmbH lights.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">This paper presents an extension to visual inertial odometry (VIO) by introducing tightly-coupled fusion of magnetometer measurements. A sliding window of keyframes is optimized by minimizing re-projection errors, relative inertial errors, and relative magnetometer orientation errors. The results of IMU orientation propagation are used to efficiently transform magnetometer measurements between frames producing relative orientation constraints between consecutive frames. The soft and hard iron effects are calibrated using an ellipsoid fitting algorithm. The introduction of magnetometer data results in significant reductions in the orientation error and also in recovery of the true yaw orientation with respect to the magnetic north. The proposed framework operates in all environments with slow-varying magnetic fields, mainly outdoors and underwater. We have focused our work on the underwater domain, especially in underwater caves, as the narrow passage and turbulent flow make it difficult to perform loop closures and reset the localization drift. The underwater caves present challenges to VIO due to the absence of ambient light and the confined nature of the environment, while also being a crucial source of fresh water and providing valuable historical records. Experimental results from underwater caves demonstrate the improvements in accuracy and robustness introduced by the proposed VIO extension.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Magnetic measurements are an often neglected source of information mainly because of their sensitivity to ambient noise; however, there are several situations in which they can provide useful information with minimal cost and low computational overhead. In this work we are targeting the underwater domain with the use of a sensor suite <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">RahmanOceans2018</span>]</cite>. The used sensor suite, comprised of a stereo camera, a 9-axis IMU, a water depth sensor, and a pencil beam mechanically scanning sonar, can be deployed by a human to collect data inside an underwater cave; see  Fig.  <a href="#S1.F1" title="Figure 1 ‣ I Introduction ‣ Enhancing Visual Inertial SLAM with Magnetic Measurements" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. We propose a tightly coupled optimization-based fusion of visual, inertial, and magnetometer information. Magnetometer measurements are added as new factors to the keyframe-based sliding window optimization graph proposed in  <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">okvis</span>]</cite>. We leverage the IMU preintegration algorithm from <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">qin2017vins_mono</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">forster2016manifold</span>]</cite> to efficiently compute magnetometer residuals for all measurements. Since the IMU preintegration terms are already defined in the relative inertial error, the additional computational cost is relatively small. The magnetometer data are sensitive to the local magnetic field and require an explicit calibration procedure. As such, the magnetometer measurements are calibrated to account for soft and hard iron effects using an ellipsoid fitting algorithm. Experiments have shown that after calibration, the local magnetic noise is relatively low throughout the trajectory. Furthermore, magnetic data present an absolute measurement based on the magnetic field of Earth and while noisy they are consistent over long trajectories. Our target application is the mapping of underwater caves.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2409.09904/assets/figures/RigSpain1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="331" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">Sensor suite deployed inside the Cueva del Agua, Spain.</span></figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Mapping underwater cave systems is extremely important for environmental protection, fresh water management <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">Florida2010</span>]</cite>, and resource utilization <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">ZexuanReports2016</span>]</cite>. Moreover, caves provide valuable historical evidence as they present an undisturbed time capsule <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">Abbott2014</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">macdonald2020paleoindian</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">rissolo2015novel</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">de2015ancient</span>]</cite>, and information about geological processes <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">KresicMikszewski2013</span>]</cite>. Diver centered mapping is a dangerous, labor-intensive, tedious, and slow task.  In addition to limited visibility, color absorption, hazing, and lightning variations, there is no ambient light and the environment is often cluttered and fragile, making navigation difficult, with inadvertent motion maneuvers often reducing visibility to zero. Furthermore, the confined environment prevents resurfacing in case of a problem or emergency. During operations inside underwater caves, there are two constraining factors. First, the passages are often narrow, and the view on the way in is completely different from the view on the way out, making maneuvering difficult. Second, there is significant water flow that makes staying in one spot to collect data in 360 degrees very challenging. These conditions contribute to reducing the number of loop closures that are feasible.
Moreover, underwater cave systems provide an exciting opportunity to use magnetometer measurements as they are devoid of significant magnetic disturbances due to ferromagnetic materials. The introduction of magnetic field measurements in the state estimation process, proposed in this paper, leads to two significant contributions. First of all, absolute orientation measurements are introduced to orient the produced trajectory with respect to the magnetic north. This makes the produced trajectories compatible with the existing man-made maps of the caves. Second, the introduction of magnetometer data constrains the produced trajectories along the yaw direction, producing much more consistent results, eliminating the orientation drift that plagued earlier deployments <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">JoshiAUV2022</span>]</cite>.
To the best of our knowledge, our work is the first to use IMU preintegration to introduce high frequency magnetometer measurements in the optimization framework. The proposed framework has been tested in a variety of underwater caves in Florida and Mexico. Qualitative results demonstrate the alignment of the produced trajectories to the existing maps of the caves, and also a significant reduction in orientation error (drift). The produced trajectories resulted in significantly reduced error, compared to the baseline trajectories obtained using COLMAP <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">colmap_sfm</span>]</cite> (a bundle adjustment, global optimization framework).</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Vision-based state estimation has proven to be extremely challenging due to the varying lightning conditions, scattering and haziness from floating particulates, and color variations due to light absorption in the water. Several visual and visual-inertial state estimation packages have exhibited severe failures <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">QuattriniLiISERVO2016</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">JoshiIROS2019</span>]</cite>. Rahman <em id="S2.p1.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p1.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">RahmanICRA2018</span>]</cite> proposed an extension of OKVIS <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">okvis</span>]</cite> incorporating a pencil beam mechanically scanning sonar, a water depth sensor, and loop closure capabilities <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">RahmanIROS2019a</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">RahmanIJRR2022</span>]</cite>. The framework was then adapted for inexpensive action cameras, GoPro 9, <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">JoshiICRA2022</span>]</cite> producing superior performance. More recent packages such as ORB-SLAM3 <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">orbslam3</span>]</cite>, OpenVINS <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">geneva2020openvins</span>]</cite>, <em id="S2.p1.1.3" class="ltx_emph ltx_font_italic">etc</em>.<span id="S2.p1.1.4" class="ltx_text"></span> have demonstrated better performance, but there is no in-depth analysis of their accuracy and robustness.
Magnetometers have traditionally been fused with acceleration and angular velocity measurements to estimate the vehicle’s attitude; such systems are termed attitude and heading reference systems (AHRS)  <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">madwick_filter</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">complimentary_filter</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">zhao_imu_mag_ultrasonic</span>]</cite>. Some recent work on the fusion of magnetic field measurements with a visual sensor has gained traction. Wang <em id="S2.p1.1.5" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p1.1.6" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">wang_vimo</span>]</cite> performed visual, inertial, and magnetometer fusion first by initializing the VIO in the reference frame of Earth and then computing the error between magnetometer measurement and Earth’s magnetic field. The authors included only magnetometer measurements near the keyframe, skipping most of the high-frequency magnetometer measurements. Siebler <em id="S2.p1.1.7" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p1.1.8" class="ltx_text"></span> proposed a particle filter method to use magnetic field distortions for magnetometer calibration and localization  <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">Siebler</span>]</cite>; without focusing on continuous state estimation. The closest approach to ours used inter-frame preintegrated magnetometer measurements <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">caruso_mimu</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">caruso_mimu_kf</span>]</cite>. However, it requires an array of magnetometers measuring magnetic field and it’s gradient. Our work is focused on a single 9-axis IMU without requiring additional hardware enhancements.
The calibration of soft and hard iron offsets for magnetometer is very important as they can introduce huge errors in the estimation process. In  <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">mag_extra_calib</span>]</cite> an iterative batch least squares estimation was introduced to calibrate a full three-axis magnetometer. Vasconcelos <em id="S2.p1.1.9" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p1.1.10" class="ltx_text"></span> used maximum likelihood estimation to find the optimal calibration parameters that best fit the reading of the onboard sensors to calibrate the 3-axis strapless magnetometer  <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">mag_calib</span>]</cite>. Kok <em id="S2.p1.1.11" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p1.1.12" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">magnetometer_inertial_calibration</span>]</cite> proposed maximal likelihood calibration using orientation estimation from inertial sensors. Taking things to the next step, Solin <em id="S2.p1.1.13" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p1.1.14" class="ltx_text"></span> created a map of the magnetic field in an indoor environment by imposing a Gaussian process (GP) prior to the latent scalar potential of the magnetic field <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">solin_gaussian</span>]</cite>.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Visual-Inertial-Magnetometer Fusion</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Visual-Inertial Odometry aims to estimate the pose of the moving camera-imu system by fusing inertial information with images. In this work, we extend visual-inertial odometry to fuse magnetometer measurements in a tightly coupled fashion using IMU preintegration.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.5.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.6.2" class="ltx_text ltx_font_italic">Problem Formulation</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">We consider the visual inertial magnetometer odometry problem where we want to track the <span id="S3.SS1.p1.1.1" class="ltx_text ltx_font_italic">state</span> of a sensing system (a handheld underwater sensor suite) equipped with an IMU, a stereo/monocular camera, and a magnetometer. The IMU frame coincides with the body frame ”B” we want to track, and the transformation between the camera and the IMU (<math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\text{T}_{\text{BC}}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mtext id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2a.cmml">T</mtext><mtext id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3a.cmml">BC</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2a.cmml" xref="S3.SS1.p1.1.m1.1.1.2"><mtext id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">T</mtext></ci><ci id="S3.SS1.p1.1.m1.1.1.3a.cmml" xref="S3.SS1.p1.1.m1.1.1.3"><mtext mathsize="70%" id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">BC</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\text{T}_{\text{BC}}</annotation></semantics></math>) is known by calibrating the extrinsic parameters and remains constant throughout the experiment; see  Fig. <a href="#S3.F2" title="Figure 2 ‣ III-A Problem Formulation ‣ III Visual-Inertial-Magnetometer Fusion ‣ Enhancing Visual Inertial SLAM with Magnetic Measurements" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> . In this work, we use a 9-axis IMU that includes an accelerometer, a gyroscope, and a magnetometer. As such, we assume that the magnetometer and IMU (gyroscope and accelerometer) axes are aligned and that there is no significant axis misalignment. When using stereo cameras, we assume that they are rigidly attached with known extrinsic parameters between the cameras and between the cameras and the IMU.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2409.09904/assets/figures/coordinate_frame.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="419" height="287" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.6.3.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.4.2" class="ltx_text" style="font-size:90%;">The body pose <math id="S3.F2.3.1.m1.1" class="ltx_math_unparsed" alttext="\text{T}_{\text{WB}}\doteq(\text{R}_{\text{WB}},{}_{\text{W}}\textbf{p}" display="inline"><semantics id="S3.F2.3.1.m1.1b"><mrow id="S3.F2.3.1.m1.1c"><msub id="S3.F2.3.1.m1.1.1"><mtext id="S3.F2.3.1.m1.1.1.2">T</mtext><mtext id="S3.F2.3.1.m1.1.1.3">WB</mtext></msub><mo id="S3.F2.3.1.m1.1.2">≐</mo><mrow id="S3.F2.3.1.m1.1.3"><mo stretchy="false" id="S3.F2.3.1.m1.1.3.1">(</mo><msub id="S3.F2.3.1.m1.1.3.2"><mtext id="S3.F2.3.1.m1.1.3.2.2">R</mtext><mtext id="S3.F2.3.1.m1.1.3.2.3">WB</mtext></msub><mo id="S3.F2.3.1.m1.1.3.3">,</mo><mmultiscripts id="S3.F2.3.1.m1.1.3.4"><mtext class="ltx_mathvariant_bold" id="S3.F2.3.1.m1.1.3.4.2">p</mtext><mprescripts id="S3.F2.3.1.m1.1.3.4b"></mprescripts><mtext id="S3.F2.3.1.m1.1.3.4.3">W</mtext><mrow id="S3.F2.3.1.m1.1.3.4c"></mrow></mmultiscripts></mrow></mrow><annotation encoding="application/x-tex" id="S3.F2.3.1.m1.1d">\text{T}_{\text{WB}}\doteq(\text{R}_{\text{WB}},{}_{\text{W}}\textbf{p}</annotation></semantics></math>) which coincides with 9-axis IMU is tracked w.r.t the world frame W. The camera pose in body frame <math id="S3.F2.4.2.m2.1" class="ltx_Math" alttext="\text{T}_{BC}" display="inline"><semantics id="S3.F2.4.2.m2.1b"><msub id="S3.F2.4.2.m2.1.1" xref="S3.F2.4.2.m2.1.1.cmml"><mtext id="S3.F2.4.2.m2.1.1.2" xref="S3.F2.4.2.m2.1.1.2a.cmml">T</mtext><mrow id="S3.F2.4.2.m2.1.1.3" xref="S3.F2.4.2.m2.1.1.3.cmml"><mi id="S3.F2.4.2.m2.1.1.3.2" xref="S3.F2.4.2.m2.1.1.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="S3.F2.4.2.m2.1.1.3.1" xref="S3.F2.4.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.F2.4.2.m2.1.1.3.3" xref="S3.F2.4.2.m2.1.1.3.3.cmml">C</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.F2.4.2.m2.1c"><apply id="S3.F2.4.2.m2.1.1.cmml" xref="S3.F2.4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.F2.4.2.m2.1.1.1.cmml" xref="S3.F2.4.2.m2.1.1">subscript</csymbol><ci id="S3.F2.4.2.m2.1.1.2a.cmml" xref="S3.F2.4.2.m2.1.1.2"><mtext id="S3.F2.4.2.m2.1.1.2.cmml" xref="S3.F2.4.2.m2.1.1.2">T</mtext></ci><apply id="S3.F2.4.2.m2.1.1.3.cmml" xref="S3.F2.4.2.m2.1.1.3"><times id="S3.F2.4.2.m2.1.1.3.1.cmml" xref="S3.F2.4.2.m2.1.1.3.1"></times><ci id="S3.F2.4.2.m2.1.1.3.2.cmml" xref="S3.F2.4.2.m2.1.1.3.2">𝐵</ci><ci id="S3.F2.4.2.m2.1.1.3.3.cmml" xref="S3.F2.4.2.m2.1.1.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.4.2.m2.1d">\text{T}_{BC}</annotation></semantics></math> is fixed and known from prior calibration. The world frame W coincides with East, North and Up direction in Earth coordinates.</span></figcaption>
</figure>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.12" class="ltx_p">Nonlinear keyframe-based sliding window optimization is performed to estimate body poses and 3D landmark positions by minimizing the reprojection error of landmarks seen in the camera frame. Thus, we need to estimate the variables <math id="S3.SS1.p2.1.m1.2" class="ltx_Math" alttext="\pazocal{X}=\{\pazocal{X}_{\text{B}},\pazocal{L}\}" display="inline"><semantics id="S3.SS1.p2.1.m1.2a"><mrow id="S3.SS1.p2.1.m1.2.2" xref="S3.SS1.p2.1.m1.2.2.cmml"><mi mathvariant="normal" id="S3.SS1.p2.1.m1.2.2.3" xref="S3.SS1.p2.1.m1.2.2.3.cmml">X</mi><mo id="S3.SS1.p2.1.m1.2.2.2" xref="S3.SS1.p2.1.m1.2.2.2.cmml">=</mo><mrow id="S3.SS1.p2.1.m1.2.2.1.1" xref="S3.SS1.p2.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.2.2.1.1.2" xref="S3.SS1.p2.1.m1.2.2.1.2.cmml">{</mo><msub id="S3.SS1.p2.1.m1.2.2.1.1.1" xref="S3.SS1.p2.1.m1.2.2.1.1.1.cmml"><mi mathvariant="normal" id="S3.SS1.p2.1.m1.2.2.1.1.1.2" xref="S3.SS1.p2.1.m1.2.2.1.1.1.2.cmml">X</mi><mtext id="S3.SS1.p2.1.m1.2.2.1.1.1.3" xref="S3.SS1.p2.1.m1.2.2.1.1.1.3a.cmml">B</mtext></msub><mo id="S3.SS1.p2.1.m1.2.2.1.1.3" xref="S3.SS1.p2.1.m1.2.2.1.2.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">L</mi><mo stretchy="false" id="S3.SS1.p2.1.m1.2.2.1.1.4" xref="S3.SS1.p2.1.m1.2.2.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.2b"><apply id="S3.SS1.p2.1.m1.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2"><eq id="S3.SS1.p2.1.m1.2.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2"></eq><ci id="S3.SS1.p2.1.m1.2.2.3.cmml" xref="S3.SS1.p2.1.m1.2.2.3">X</ci><set id="S3.SS1.p2.1.m1.2.2.1.2.cmml" xref="S3.SS1.p2.1.m1.2.2.1.1"><apply id="S3.SS1.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.2.2.1.1.1.2">X</ci><ci id="S3.SS1.p2.1.m1.2.2.1.1.1.3a.cmml" xref="S3.SS1.p2.1.m1.2.2.1.1.1.3"><mtext mathsize="70%" id="S3.SS1.p2.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.2.2.1.1.1.3">B</mtext></ci></apply><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">L</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.2c">\pazocal{X}=\{\pazocal{X}_{\text{B}},\pazocal{L}\}</annotation></semantics></math> where <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="\pazocal{L}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi mathvariant="normal" id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">L</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\pazocal{L}</annotation></semantics></math> represents 3D landmark positions visible in the sliding window and <math id="S3.SS1.p2.3.m3.3" class="ltx_Math" alttext="\pazocal{X}_{\text{B}}=[\mathbf{x}_{1},...,\mathbf{x}_{K}]" display="inline"><semantics id="S3.SS1.p2.3.m3.3a"><mrow id="S3.SS1.p2.3.m3.3.3" xref="S3.SS1.p2.3.m3.3.3.cmml"><msub id="S3.SS1.p2.3.m3.3.3.4" xref="S3.SS1.p2.3.m3.3.3.4.cmml"><mi mathvariant="normal" id="S3.SS1.p2.3.m3.3.3.4.2" xref="S3.SS1.p2.3.m3.3.3.4.2.cmml">X</mi><mtext id="S3.SS1.p2.3.m3.3.3.4.3" xref="S3.SS1.p2.3.m3.3.3.4.3a.cmml">B</mtext></msub><mo id="S3.SS1.p2.3.m3.3.3.3" xref="S3.SS1.p2.3.m3.3.3.3.cmml">=</mo><mrow id="S3.SS1.p2.3.m3.3.3.2.2" xref="S3.SS1.p2.3.m3.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS1.p2.3.m3.3.3.2.2.3" xref="S3.SS1.p2.3.m3.3.3.2.3.cmml">[</mo><msub id="S3.SS1.p2.3.m3.2.2.1.1.1" xref="S3.SS1.p2.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.3.m3.2.2.1.1.1.2" xref="S3.SS1.p2.3.m3.2.2.1.1.1.2.cmml">𝐱</mi><mn id="S3.SS1.p2.3.m3.2.2.1.1.1.3" xref="S3.SS1.p2.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p2.3.m3.3.3.2.2.4" xref="S3.SS1.p2.3.m3.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">…</mi><mo id="S3.SS1.p2.3.m3.3.3.2.2.5" xref="S3.SS1.p2.3.m3.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p2.3.m3.3.3.2.2.2" xref="S3.SS1.p2.3.m3.3.3.2.2.2.cmml"><mi id="S3.SS1.p2.3.m3.3.3.2.2.2.2" xref="S3.SS1.p2.3.m3.3.3.2.2.2.2.cmml">𝐱</mi><mi mathvariant="normal" id="S3.SS1.p2.3.m3.3.3.2.2.2.3" xref="S3.SS1.p2.3.m3.3.3.2.2.2.3.cmml">K</mi></msub><mo stretchy="false" id="S3.SS1.p2.3.m3.3.3.2.2.6" xref="S3.SS1.p2.3.m3.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.3b"><apply id="S3.SS1.p2.3.m3.3.3.cmml" xref="S3.SS1.p2.3.m3.3.3"><eq id="S3.SS1.p2.3.m3.3.3.3.cmml" xref="S3.SS1.p2.3.m3.3.3.3"></eq><apply id="S3.SS1.p2.3.m3.3.3.4.cmml" xref="S3.SS1.p2.3.m3.3.3.4"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.3.3.4.1.cmml" xref="S3.SS1.p2.3.m3.3.3.4">subscript</csymbol><ci id="S3.SS1.p2.3.m3.3.3.4.2.cmml" xref="S3.SS1.p2.3.m3.3.3.4.2">X</ci><ci id="S3.SS1.p2.3.m3.3.3.4.3a.cmml" xref="S3.SS1.p2.3.m3.3.3.4.3"><mtext mathsize="70%" id="S3.SS1.p2.3.m3.3.3.4.3.cmml" xref="S3.SS1.p2.3.m3.3.3.4.3">B</mtext></ci></apply><list id="S3.SS1.p2.3.m3.3.3.2.3.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2"><apply id="S3.SS1.p2.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.2">𝐱</ci><cn type="integer" id="S3.SS1.p2.3.m3.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">…</ci><apply id="S3.SS1.p2.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.2.2">𝐱</ci><ci id="S3.SS1.p2.3.m3.3.3.2.2.2.3.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.2.3">K</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.3c">\pazocal{X}_{\text{B}}=[\mathbf{x}_{1},...,\mathbf{x}_{K}]</annotation></semantics></math> holds the system states at camera times 1 to <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">K</annotation></semantics></math> with <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">K</annotation></semantics></math> being the total number of keyframes in the sliding window. The system state <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="\mathbf{x}_{k}" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><msub id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mi id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2">𝐱</ci><ci id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">\mathbf{x}_{k}</annotation></semantics></math> at time <math id="S3.SS1.p2.7.m7.1" class="ltx_Math" alttext="t_{k}" display="inline"><semantics id="S3.SS1.p2.7.m7.1a"><msub id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml"><mi id="S3.SS1.p2.7.m7.1.1.2" xref="S3.SS1.p2.7.m7.1.1.2.cmml">t</mi><mi id="S3.SS1.p2.7.m7.1.1.3" xref="S3.SS1.p2.7.m7.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><apply id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p2.7.m7.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1.2">𝑡</ci><ci id="S3.SS1.p2.7.m7.1.1.3.cmml" xref="S3.SS1.p2.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">t_{k}</annotation></semantics></math> holds position <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="{}_{\text{W}}\mathbf{p}^{k}" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><mmultiscripts id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><mi id="S3.SS1.p2.8.m8.1.1.2.2" xref="S3.SS1.p2.8.m8.1.1.2.2.cmml">𝐩</mi><mrow id="S3.SS1.p2.8.m8.1.1a" xref="S3.SS1.p2.8.m8.1.1.cmml"></mrow><mi id="S3.SS1.p2.8.m8.1.1.2.3" xref="S3.SS1.p2.8.m8.1.1.2.3.cmml">k</mi><mprescripts id="S3.SS1.p2.8.m8.1.1b" xref="S3.SS1.p2.8.m8.1.1.cmml"></mprescripts><mtext id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3a.cmml">W</mtext><mrow id="S3.SS1.p2.8.m8.1.1c" xref="S3.SS1.p2.8.m8.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">subscript</csymbol><apply id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.2.1.cmml" xref="S3.SS1.p2.8.m8.1.1">superscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.2.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2.2">𝐩</ci><ci id="S3.SS1.p2.8.m8.1.1.2.3.cmml" xref="S3.SS1.p2.8.m8.1.1.2.3">𝑘</ci></apply><ci id="S3.SS1.p2.8.m8.1.1.3a.cmml" xref="S3.SS1.p2.8.m8.1.1.3"><mtext mathsize="70%" id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3">W</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">{}_{\text{W}}\mathbf{p}^{k}</annotation></semantics></math> and orientation <math id="S3.SS1.p2.9.m9.1" class="ltx_Math" alttext="\mathbf{q}_{\text{WB}}^{k}" display="inline"><semantics id="S3.SS1.p2.9.m9.1a"><msubsup id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml"><mi id="S3.SS1.p2.9.m9.1.1.2.2" xref="S3.SS1.p2.9.m9.1.1.2.2.cmml">𝐪</mi><mtext id="S3.SS1.p2.9.m9.1.1.2.3" xref="S3.SS1.p2.9.m9.1.1.2.3a.cmml">WB</mtext><mi id="S3.SS1.p2.9.m9.1.1.3" xref="S3.SS1.p2.9.m9.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><apply id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.1.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">superscript</csymbol><apply id="S3.SS1.p2.9.m9.1.1.2.cmml" xref="S3.SS1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.1.1.2.1.cmml" xref="S3.SS1.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p2.9.m9.1.1.2.2.cmml" xref="S3.SS1.p2.9.m9.1.1.2.2">𝐪</ci><ci id="S3.SS1.p2.9.m9.1.1.2.3a.cmml" xref="S3.SS1.p2.9.m9.1.1.2.3"><mtext mathsize="70%" id="S3.SS1.p2.9.m9.1.1.2.3.cmml" xref="S3.SS1.p2.9.m9.1.1.2.3">WB</mtext></ci></apply><ci id="S3.SS1.p2.9.m9.1.1.3.cmml" xref="S3.SS1.p2.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">\mathbf{q}_{\text{WB}}^{k}</annotation></semantics></math> in the world frame, velocity in the inertial frame <math id="S3.SS1.p2.10.m10.1" class="ltx_Math" alttext="{}_{\text{W}}\mathbf{v}^{k}" display="inline"><semantics id="S3.SS1.p2.10.m10.1a"><mmultiscripts id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml"><mi id="S3.SS1.p2.10.m10.1.1.2.2" xref="S3.SS1.p2.10.m10.1.1.2.2.cmml">𝐯</mi><mrow id="S3.SS1.p2.10.m10.1.1a" xref="S3.SS1.p2.10.m10.1.1.cmml"></mrow><mi id="S3.SS1.p2.10.m10.1.1.2.3" xref="S3.SS1.p2.10.m10.1.1.2.3.cmml">k</mi><mprescripts id="S3.SS1.p2.10.m10.1.1b" xref="S3.SS1.p2.10.m10.1.1.cmml"></mprescripts><mtext id="S3.SS1.p2.10.m10.1.1.3" xref="S3.SS1.p2.10.m10.1.1.3a.cmml">W</mtext><mrow id="S3.SS1.p2.10.m10.1.1c" xref="S3.SS1.p2.10.m10.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b"><apply id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1">subscript</csymbol><apply id="S3.SS1.p2.10.m10.1.1.2.cmml" xref="S3.SS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.2.1.cmml" xref="S3.SS1.p2.10.m10.1.1">superscript</csymbol><ci id="S3.SS1.p2.10.m10.1.1.2.2.cmml" xref="S3.SS1.p2.10.m10.1.1.2.2">𝐯</ci><ci id="S3.SS1.p2.10.m10.1.1.2.3.cmml" xref="S3.SS1.p2.10.m10.1.1.2.3">𝑘</ci></apply><ci id="S3.SS1.p2.10.m10.1.1.3a.cmml" xref="S3.SS1.p2.10.m10.1.1.3"><mtext mathsize="70%" id="S3.SS1.p2.10.m10.1.1.3.cmml" xref="S3.SS1.p2.10.m10.1.1.3">W</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">{}_{\text{W}}\mathbf{v}^{k}</annotation></semantics></math>, as well as biases of the gyroscope <math id="S3.SS1.p2.11.m11.1" class="ltx_Math" alttext="\mathbf{b}_{g}^{k}" display="inline"><semantics id="S3.SS1.p2.11.m11.1a"><msubsup id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml"><mi id="S3.SS1.p2.11.m11.1.1.2.2" xref="S3.SS1.p2.11.m11.1.1.2.2.cmml">𝐛</mi><mi id="S3.SS1.p2.11.m11.1.1.2.3" xref="S3.SS1.p2.11.m11.1.1.2.3.cmml">g</mi><mi id="S3.SS1.p2.11.m11.1.1.3" xref="S3.SS1.p2.11.m11.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b"><apply id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1">superscript</csymbol><apply id="S3.SS1.p2.11.m11.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.2.1.cmml" xref="S3.SS1.p2.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p2.11.m11.1.1.2.2.cmml" xref="S3.SS1.p2.11.m11.1.1.2.2">𝐛</ci><ci id="S3.SS1.p2.11.m11.1.1.2.3.cmml" xref="S3.SS1.p2.11.m11.1.1.2.3">𝑔</ci></apply><ci id="S3.SS1.p2.11.m11.1.1.3.cmml" xref="S3.SS1.p2.11.m11.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">\mathbf{b}_{g}^{k}</annotation></semantics></math> and accelerometer <math id="S3.SS1.p2.12.m12.1" class="ltx_Math" alttext="\mathbf{b}_{a}^{k}" display="inline"><semantics id="S3.SS1.p2.12.m12.1a"><msubsup id="S3.SS1.p2.12.m12.1.1" xref="S3.SS1.p2.12.m12.1.1.cmml"><mi id="S3.SS1.p2.12.m12.1.1.2.2" xref="S3.SS1.p2.12.m12.1.1.2.2.cmml">𝐛</mi><mi id="S3.SS1.p2.12.m12.1.1.2.3" xref="S3.SS1.p2.12.m12.1.1.2.3.cmml">a</mi><mi id="S3.SS1.p2.12.m12.1.1.3" xref="S3.SS1.p2.12.m12.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m12.1b"><apply id="S3.SS1.p2.12.m12.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.1.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1">superscript</csymbol><apply id="S3.SS1.p2.12.m12.1.1.2.cmml" xref="S3.SS1.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.1.1.2.1.cmml" xref="S3.SS1.p2.12.m12.1.1">subscript</csymbol><ci id="S3.SS1.p2.12.m12.1.1.2.2.cmml" xref="S3.SS1.p2.12.m12.1.1.2.2">𝐛</ci><ci id="S3.SS1.p2.12.m12.1.1.2.3.cmml" xref="S3.SS1.p2.12.m12.1.1.2.3">𝑎</ci></apply><ci id="S3.SS1.p2.12.m12.1.1.3.cmml" xref="S3.SS1.p2.12.m12.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m12.1c">\mathbf{b}_{a}^{k}</annotation></semantics></math>. The system state can be written as</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.5" class="ltx_Math" alttext="\mathbf{x}_{k}=[{}_{\text{W}}\mathbf{p}^{k},\mathbf{q}_{\text{WB}}^{k},{}_{\text{W}}\mathbf{v}^{k},\mathbf{b}_{g}^{k},\mathbf{b}_{a}^{k}]" display="block"><semantics id="S3.E1.m1.5a"><mrow id="S3.E1.m1.5.5" xref="S3.E1.m1.5.5.cmml"><msub id="S3.E1.m1.5.5.7" xref="S3.E1.m1.5.5.7.cmml"><mi id="S3.E1.m1.5.5.7.2" xref="S3.E1.m1.5.5.7.2.cmml">𝐱</mi><mi id="S3.E1.m1.5.5.7.3" xref="S3.E1.m1.5.5.7.3.cmml">k</mi></msub><mo id="S3.E1.m1.5.5.6" xref="S3.E1.m1.5.5.6.cmml">=</mo><mrow id="S3.E1.m1.5.5.5.5" xref="S3.E1.m1.5.5.5.6.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.5.5.6" xref="S3.E1.m1.5.5.5.6.cmml">[</mo><mmultiscripts id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.2.2.cmml">𝐩</mi><mrow id="S3.E1.m1.1.1.1.1.1a" xref="S3.E1.m1.1.1.1.1.1.cmml"></mrow><mi id="S3.E1.m1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.2.3.cmml">k</mi><mprescripts id="S3.E1.m1.1.1.1.1.1b" xref="S3.E1.m1.1.1.1.1.1.cmml"></mprescripts><mtext id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3a.cmml">W</mtext><mrow id="S3.E1.m1.1.1.1.1.1c" xref="S3.E1.m1.1.1.1.1.1.cmml"></mrow></mmultiscripts><mo id="S3.E1.m1.5.5.5.5.7" xref="S3.E1.m1.5.5.5.6.cmml">,</mo><msubsup id="S3.E1.m1.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.2.cmml">𝐪</mi><mtext id="S3.E1.m1.2.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.2.2.3a.cmml">WB</mtext><mi id="S3.E1.m1.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.2.3.cmml">k</mi></msubsup><mo id="S3.E1.m1.5.5.5.5.8" xref="S3.E1.m1.5.5.5.6.cmml">,</mo><mmultiscripts id="S3.E1.m1.3.3.3.3.3" xref="S3.E1.m1.3.3.3.3.3.cmml"><mi id="S3.E1.m1.3.3.3.3.3.2.2" xref="S3.E1.m1.3.3.3.3.3.2.2.cmml">𝐯</mi><mrow id="S3.E1.m1.3.3.3.3.3a" xref="S3.E1.m1.3.3.3.3.3.cmml"></mrow><mi id="S3.E1.m1.3.3.3.3.3.2.3" xref="S3.E1.m1.3.3.3.3.3.2.3.cmml">k</mi><mprescripts id="S3.E1.m1.3.3.3.3.3b" xref="S3.E1.m1.3.3.3.3.3.cmml"></mprescripts><mtext id="S3.E1.m1.3.3.3.3.3.3" xref="S3.E1.m1.3.3.3.3.3.3a.cmml">W</mtext><mrow id="S3.E1.m1.3.3.3.3.3c" xref="S3.E1.m1.3.3.3.3.3.cmml"></mrow></mmultiscripts><mo id="S3.E1.m1.5.5.5.5.9" xref="S3.E1.m1.5.5.5.6.cmml">,</mo><msubsup id="S3.E1.m1.4.4.4.4.4" xref="S3.E1.m1.4.4.4.4.4.cmml"><mi id="S3.E1.m1.4.4.4.4.4.2.2" xref="S3.E1.m1.4.4.4.4.4.2.2.cmml">𝐛</mi><mi id="S3.E1.m1.4.4.4.4.4.2.3" xref="S3.E1.m1.4.4.4.4.4.2.3.cmml">g</mi><mi id="S3.E1.m1.4.4.4.4.4.3" xref="S3.E1.m1.4.4.4.4.4.3.cmml">k</mi></msubsup><mo id="S3.E1.m1.5.5.5.5.10" xref="S3.E1.m1.5.5.5.6.cmml">,</mo><msubsup id="S3.E1.m1.5.5.5.5.5" xref="S3.E1.m1.5.5.5.5.5.cmml"><mi id="S3.E1.m1.5.5.5.5.5.2.2" xref="S3.E1.m1.5.5.5.5.5.2.2.cmml">𝐛</mi><mi id="S3.E1.m1.5.5.5.5.5.2.3" xref="S3.E1.m1.5.5.5.5.5.2.3.cmml">a</mi><mi id="S3.E1.m1.5.5.5.5.5.3" xref="S3.E1.m1.5.5.5.5.5.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.E1.m1.5.5.5.5.11" xref="S3.E1.m1.5.5.5.6.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.5b"><apply id="S3.E1.m1.5.5.cmml" xref="S3.E1.m1.5.5"><eq id="S3.E1.m1.5.5.6.cmml" xref="S3.E1.m1.5.5.6"></eq><apply id="S3.E1.m1.5.5.7.cmml" xref="S3.E1.m1.5.5.7"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.7.1.cmml" xref="S3.E1.m1.5.5.7">subscript</csymbol><ci id="S3.E1.m1.5.5.7.2.cmml" xref="S3.E1.m1.5.5.7.2">𝐱</ci><ci id="S3.E1.m1.5.5.7.3.cmml" xref="S3.E1.m1.5.5.7.3">𝑘</ci></apply><list id="S3.E1.m1.5.5.5.6.cmml" xref="S3.E1.m1.5.5.5.5"><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2.2">𝐩</ci><ci id="S3.E1.m1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S3.E1.m1.1.1.1.1.1.3a.cmml" xref="S3.E1.m1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3">W</mtext></ci></apply><apply id="S3.E1.m1.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2">superscript</csymbol><apply id="S3.E1.m1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.2">𝐪</ci><ci id="S3.E1.m1.2.2.2.2.2.2.3a.cmml" xref="S3.E1.m1.2.2.2.2.2.2.3"><mtext mathsize="70%" id="S3.E1.m1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.3">WB</mtext></ci></apply><ci id="S3.E1.m1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.3">𝑘</ci></apply><apply id="S3.E1.m1.3.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.3.3.1.cmml" xref="S3.E1.m1.3.3.3.3.3">subscript</csymbol><apply id="S3.E1.m1.3.3.3.3.3.2.cmml" xref="S3.E1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.3.3.2.1.cmml" xref="S3.E1.m1.3.3.3.3.3">superscript</csymbol><ci id="S3.E1.m1.3.3.3.3.3.2.2.cmml" xref="S3.E1.m1.3.3.3.3.3.2.2">𝐯</ci><ci id="S3.E1.m1.3.3.3.3.3.2.3.cmml" xref="S3.E1.m1.3.3.3.3.3.2.3">𝑘</ci></apply><ci id="S3.E1.m1.3.3.3.3.3.3a.cmml" xref="S3.E1.m1.3.3.3.3.3.3"><mtext mathsize="70%" id="S3.E1.m1.3.3.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3">W</mtext></ci></apply><apply id="S3.E1.m1.4.4.4.4.4.cmml" xref="S3.E1.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.4.4.1.cmml" xref="S3.E1.m1.4.4.4.4.4">superscript</csymbol><apply id="S3.E1.m1.4.4.4.4.4.2.cmml" xref="S3.E1.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.4.4.2.1.cmml" xref="S3.E1.m1.4.4.4.4.4">subscript</csymbol><ci id="S3.E1.m1.4.4.4.4.4.2.2.cmml" xref="S3.E1.m1.4.4.4.4.4.2.2">𝐛</ci><ci id="S3.E1.m1.4.4.4.4.4.2.3.cmml" xref="S3.E1.m1.4.4.4.4.4.2.3">𝑔</ci></apply><ci id="S3.E1.m1.4.4.4.4.4.3.cmml" xref="S3.E1.m1.4.4.4.4.4.3">𝑘</ci></apply><apply id="S3.E1.m1.5.5.5.5.5.cmml" xref="S3.E1.m1.5.5.5.5.5"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.5.5.5.1.cmml" xref="S3.E1.m1.5.5.5.5.5">superscript</csymbol><apply id="S3.E1.m1.5.5.5.5.5.2.cmml" xref="S3.E1.m1.5.5.5.5.5"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.5.5.5.2.1.cmml" xref="S3.E1.m1.5.5.5.5.5">subscript</csymbol><ci id="S3.E1.m1.5.5.5.5.5.2.2.cmml" xref="S3.E1.m1.5.5.5.5.5.2.2">𝐛</ci><ci id="S3.E1.m1.5.5.5.5.5.2.3.cmml" xref="S3.E1.m1.5.5.5.5.5.2.3">𝑎</ci></apply><ci id="S3.E1.m1.5.5.5.5.5.3.cmml" xref="S3.E1.m1.5.5.5.5.5.3">𝑘</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.5c">\mathbf{x}_{k}=[{}_{\text{W}}\mathbf{p}^{k},\mathbf{q}_{\text{WB}}^{k},{}_{\text{W}}\mathbf{v}^{k},\mathbf{b}_{g}^{k},\mathbf{b}_{a}^{k}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.14" class="ltx_p">where <math id="S3.SS1.p2.13.m1.1" class="ltx_Math" alttext="\mathbf{q}_{\text{WB}}" display="inline"><semantics id="S3.SS1.p2.13.m1.1a"><msub id="S3.SS1.p2.13.m1.1.1" xref="S3.SS1.p2.13.m1.1.1.cmml"><mi id="S3.SS1.p2.13.m1.1.1.2" xref="S3.SS1.p2.13.m1.1.1.2.cmml">𝐪</mi><mtext id="S3.SS1.p2.13.m1.1.1.3" xref="S3.SS1.p2.13.m1.1.1.3a.cmml">WB</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.13.m1.1b"><apply id="S3.SS1.p2.13.m1.1.1.cmml" xref="S3.SS1.p2.13.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m1.1.1.1.cmml" xref="S3.SS1.p2.13.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.13.m1.1.1.2.cmml" xref="S3.SS1.p2.13.m1.1.1.2">𝐪</ci><ci id="S3.SS1.p2.13.m1.1.1.3a.cmml" xref="S3.SS1.p2.13.m1.1.1.3"><mtext mathsize="70%" id="S3.SS1.p2.13.m1.1.1.3.cmml" xref="S3.SS1.p2.13.m1.1.1.3">WB</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.13.m1.1c">\mathbf{q}_{\text{WB}}</annotation></semantics></math> is the quaternion representation of the orientation <math id="S3.SS1.p2.14.m2.1" class="ltx_Math" alttext="\text{R}_{\text{WB}}" display="inline"><semantics id="S3.SS1.p2.14.m2.1a"><msub id="S3.SS1.p2.14.m2.1.1" xref="S3.SS1.p2.14.m2.1.1.cmml"><mtext id="S3.SS1.p2.14.m2.1.1.2" xref="S3.SS1.p2.14.m2.1.1.2a.cmml">R</mtext><mtext id="S3.SS1.p2.14.m2.1.1.3" xref="S3.SS1.p2.14.m2.1.1.3a.cmml">WB</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.14.m2.1b"><apply id="S3.SS1.p2.14.m2.1.1.cmml" xref="S3.SS1.p2.14.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.14.m2.1.1.1.cmml" xref="S3.SS1.p2.14.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.14.m2.1.1.2a.cmml" xref="S3.SS1.p2.14.m2.1.1.2"><mtext id="S3.SS1.p2.14.m2.1.1.2.cmml" xref="S3.SS1.p2.14.m2.1.1.2">R</mtext></ci><ci id="S3.SS1.p2.14.m2.1.1.3a.cmml" xref="S3.SS1.p2.14.m2.1.1.3"><mtext mathsize="70%" id="S3.SS1.p2.14.m2.1.1.3.cmml" xref="S3.SS1.p2.14.m2.1.1.3">WB</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.14.m2.1c">\text{R}_{\text{WB}}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.5.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.6.2" class="ltx_text ltx_font_italic">Fusing visual, inertial and magnetometer measurements</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">The keyframe-based visual-inertial SLAM is formulated as joint nonlinear optimization that maximizes the posterior probability of the system state <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\pazocal{X}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi mathvariant="normal" id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">X</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\pazocal{X}</annotation></semantics></math>. Using the problem formulation proposed in  <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">okvis</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">RahmanIJRR2022</span>]</cite>, the following cost function is minimized</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.8" class="ltx_Math" alttext="J_{VI}(\pazocal{X})=\sum_{k=1}^{K}\sum_{j\in\pazocal{J}_{k}}\lVert\mathbf{e_{r}}^{j,k}\rVert^{2}_{\mathbf{W_{r}}^{j,k}}+\sum_{k=1}^{K}\lVert\mathbf{e_{i}}^{k}\rVert^{2}_{\mathbf{W_{i}}^{k}}+\lVert\mathbf{e_{p}}\rVert^{2}" display="block"><semantics id="S3.E2.m1.8a"><mrow id="S3.E2.m1.8.8" xref="S3.E2.m1.8.8.cmml"><mrow id="S3.E2.m1.8.8.5" xref="S3.E2.m1.8.8.5.cmml"><msub id="S3.E2.m1.8.8.5.2" xref="S3.E2.m1.8.8.5.2.cmml"><mi id="S3.E2.m1.8.8.5.2.2" xref="S3.E2.m1.8.8.5.2.2.cmml">J</mi><mrow id="S3.E2.m1.8.8.5.2.3" xref="S3.E2.m1.8.8.5.2.3.cmml"><mi id="S3.E2.m1.8.8.5.2.3.2" xref="S3.E2.m1.8.8.5.2.3.2.cmml">V</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.8.8.5.2.3.1" xref="S3.E2.m1.8.8.5.2.3.1.cmml">​</mo><mi id="S3.E2.m1.8.8.5.2.3.3" xref="S3.E2.m1.8.8.5.2.3.3.cmml">I</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.8.8.5.1" xref="S3.E2.m1.8.8.5.1.cmml">​</mo><mrow id="S3.E2.m1.8.8.5.3.2" xref="S3.E2.m1.8.8.5.cmml"><mo stretchy="false" id="S3.E2.m1.8.8.5.3.2.1" xref="S3.E2.m1.8.8.5.cmml">(</mo><mi mathvariant="normal" id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">X</mi><mo stretchy="false" id="S3.E2.m1.8.8.5.3.2.2" xref="S3.E2.m1.8.8.5.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E2.m1.8.8.4" xref="S3.E2.m1.8.8.4.cmml">=</mo><mrow id="S3.E2.m1.8.8.3" xref="S3.E2.m1.8.8.3.cmml"><mrow id="S3.E2.m1.6.6.1.1" xref="S3.E2.m1.6.6.1.1.cmml"><munderover id="S3.E2.m1.6.6.1.1.2" xref="S3.E2.m1.6.6.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E2.m1.6.6.1.1.2.2.2" xref="S3.E2.m1.6.6.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.6.6.1.1.2.2.3" xref="S3.E2.m1.6.6.1.1.2.2.3.cmml"><mi mathvariant="normal" id="S3.E2.m1.6.6.1.1.2.2.3.2" xref="S3.E2.m1.6.6.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E2.m1.6.6.1.1.2.2.3.1" xref="S3.E2.m1.6.6.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.6.6.1.1.2.2.3.3" xref="S3.E2.m1.6.6.1.1.2.2.3.3.cmml">1</mn></mrow><mi mathvariant="normal" id="S3.E2.m1.6.6.1.1.2.3" xref="S3.E2.m1.6.6.1.1.2.3.cmml">K</mi></munderover><mrow id="S3.E2.m1.6.6.1.1.1" xref="S3.E2.m1.6.6.1.1.1.cmml"><munder id="S3.E2.m1.6.6.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E2.m1.6.6.1.1.1.2.2" xref="S3.E2.m1.6.6.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.6.6.1.1.1.2.3" xref="S3.E2.m1.6.6.1.1.1.2.3.cmml"><mi mathvariant="normal" id="S3.E2.m1.6.6.1.1.1.2.3.2" xref="S3.E2.m1.6.6.1.1.1.2.3.2.cmml">j</mi><mo id="S3.E2.m1.6.6.1.1.1.2.3.1" xref="S3.E2.m1.6.6.1.1.1.2.3.1.cmml">∈</mo><msub id="S3.E2.m1.6.6.1.1.1.2.3.3" xref="S3.E2.m1.6.6.1.1.1.2.3.3.cmml"><mi mathvariant="normal" id="S3.E2.m1.6.6.1.1.1.2.3.3.2" xref="S3.E2.m1.6.6.1.1.1.2.3.3.2.cmml">J</mi><mi mathvariant="normal" id="S3.E2.m1.6.6.1.1.1.2.3.3.3" xref="S3.E2.m1.6.6.1.1.1.2.3.3.3.cmml">k</mi></msub></mrow></munder><msubsup id="S3.E2.m1.6.6.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.cmml"><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.cmml"><mo fence="true" lspace="0em" rspace="0em" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.1.cmml">∥</mo><mmultiscripts id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.2.cmml">𝐞</mi><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.3.cmml">𝐫</mi><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1a" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.cmml"></mrow><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1b" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.cmml"></mrow><mrow id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.3.cmml"><mi mathvariant="normal" id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">j</mi><mo id="S3.E2.m1.2.2.2.4.1" xref="S3.E2.m1.2.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">k</mi></mrow></mmultiscripts><mo fence="true" lspace="0em" rspace="0em" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.1.cmml">∥</mo></mrow><mmultiscripts id="S3.E2.m1.4.4.2" xref="S3.E2.m1.4.4.2.cmml"><mi id="S3.E2.m1.4.4.2.4.2" xref="S3.E2.m1.4.4.2.4.2.cmml">𝐖</mi><mi id="S3.E2.m1.4.4.2.4.3" xref="S3.E2.m1.4.4.2.4.3.cmml">𝐫</mi><mrow id="S3.E2.m1.4.4.2a" xref="S3.E2.m1.4.4.2.cmml"></mrow><mrow id="S3.E2.m1.4.4.2b" xref="S3.E2.m1.4.4.2.cmml"></mrow><mrow id="S3.E2.m1.4.4.2.2.2.4" xref="S3.E2.m1.4.4.2.2.2.3.cmml"><mi mathvariant="normal" id="S3.E2.m1.3.3.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.cmml">j</mi><mo id="S3.E2.m1.4.4.2.2.2.4.1" xref="S3.E2.m1.4.4.2.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.E2.m1.4.4.2.2.2.2" xref="S3.E2.m1.4.4.2.2.2.2.cmml">k</mi></mrow></mmultiscripts><mn id="S3.E2.m1.6.6.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow><mo rspace="0.055em" id="S3.E2.m1.8.8.3.4" xref="S3.E2.m1.8.8.3.4.cmml">+</mo><mrow id="S3.E2.m1.7.7.2.2" xref="S3.E2.m1.7.7.2.2.cmml"><munderover id="S3.E2.m1.7.7.2.2.2" xref="S3.E2.m1.7.7.2.2.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E2.m1.7.7.2.2.2.2.2" xref="S3.E2.m1.7.7.2.2.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.7.7.2.2.2.2.3" xref="S3.E2.m1.7.7.2.2.2.2.3.cmml"><mi mathvariant="normal" id="S3.E2.m1.7.7.2.2.2.2.3.2" xref="S3.E2.m1.7.7.2.2.2.2.3.2.cmml">k</mi><mo id="S3.E2.m1.7.7.2.2.2.2.3.1" xref="S3.E2.m1.7.7.2.2.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.7.7.2.2.2.2.3.3" xref="S3.E2.m1.7.7.2.2.2.2.3.3.cmml">1</mn></mrow><mi mathvariant="normal" id="S3.E2.m1.7.7.2.2.2.3" xref="S3.E2.m1.7.7.2.2.2.3.cmml">K</mi></munderover><msubsup id="S3.E2.m1.7.7.2.2.1" xref="S3.E2.m1.7.7.2.2.1.cmml"><mrow id="S3.E2.m1.7.7.2.2.1.1.1.1" xref="S3.E2.m1.7.7.2.2.1.1.1.2.cmml"><mo fence="true" lspace="0em" rspace="0em" id="S3.E2.m1.7.7.2.2.1.1.1.1.2" xref="S3.E2.m1.7.7.2.2.1.1.1.2.1.cmml">∥</mo><mmultiscripts id="S3.E2.m1.7.7.2.2.1.1.1.1.1" xref="S3.E2.m1.7.7.2.2.1.1.1.1.1.cmml"><mi id="S3.E2.m1.7.7.2.2.1.1.1.1.1.2.2" xref="S3.E2.m1.7.7.2.2.1.1.1.1.1.2.2.cmml">𝐞</mi><mi id="S3.E2.m1.7.7.2.2.1.1.1.1.1.2.3" xref="S3.E2.m1.7.7.2.2.1.1.1.1.1.2.3.cmml">𝐢</mi><mrow id="S3.E2.m1.7.7.2.2.1.1.1.1.1a" xref="S3.E2.m1.7.7.2.2.1.1.1.1.1.cmml"></mrow><mrow id="S3.E2.m1.7.7.2.2.1.1.1.1.1b" xref="S3.E2.m1.7.7.2.2.1.1.1.1.1.cmml"></mrow><mi mathvariant="normal" id="S3.E2.m1.7.7.2.2.1.1.1.1.1.3" xref="S3.E2.m1.7.7.2.2.1.1.1.1.1.3.cmml">k</mi></mmultiscripts><mo fence="true" lspace="0em" rspace="0em" id="S3.E2.m1.7.7.2.2.1.1.1.1.3" xref="S3.E2.m1.7.7.2.2.1.1.1.2.1.cmml">∥</mo></mrow><mmultiscripts id="S3.E2.m1.7.7.2.2.1.3" xref="S3.E2.m1.7.7.2.2.1.3.cmml"><mi id="S3.E2.m1.7.7.2.2.1.3.2.2" xref="S3.E2.m1.7.7.2.2.1.3.2.2.cmml">𝐖</mi><mi id="S3.E2.m1.7.7.2.2.1.3.2.3" xref="S3.E2.m1.7.7.2.2.1.3.2.3.cmml">𝐢</mi><mrow id="S3.E2.m1.7.7.2.2.1.3a" xref="S3.E2.m1.7.7.2.2.1.3.cmml"></mrow><mrow id="S3.E2.m1.7.7.2.2.1.3b" xref="S3.E2.m1.7.7.2.2.1.3.cmml"></mrow><mi mathvariant="normal" id="S3.E2.m1.7.7.2.2.1.3.3" xref="S3.E2.m1.7.7.2.2.1.3.3.cmml">k</mi></mmultiscripts><mn id="S3.E2.m1.7.7.2.2.1.1.3" xref="S3.E2.m1.7.7.2.2.1.1.3.cmml">2</mn></msubsup></mrow><mo id="S3.E2.m1.8.8.3.4a" xref="S3.E2.m1.8.8.3.4.cmml">+</mo><msup id="S3.E2.m1.8.8.3.3" xref="S3.E2.m1.8.8.3.3.cmml"><mrow id="S3.E2.m1.8.8.3.3.1.1" xref="S3.E2.m1.8.8.3.3.1.2.cmml"><mo fence="true" lspace="0em" rspace="0em" id="S3.E2.m1.8.8.3.3.1.1.2" xref="S3.E2.m1.8.8.3.3.1.2.1.cmml">∥</mo><msub id="S3.E2.m1.8.8.3.3.1.1.1" xref="S3.E2.m1.8.8.3.3.1.1.1.cmml"><mi id="S3.E2.m1.8.8.3.3.1.1.1.2" xref="S3.E2.m1.8.8.3.3.1.1.1.2.cmml">𝐞</mi><mi id="S3.E2.m1.8.8.3.3.1.1.1.3" xref="S3.E2.m1.8.8.3.3.1.1.1.3.cmml">𝐩</mi></msub><mo fence="true" lspace="0em" id="S3.E2.m1.8.8.3.3.1.1.3" xref="S3.E2.m1.8.8.3.3.1.2.1.cmml">∥</mo></mrow><mn id="S3.E2.m1.8.8.3.3.3" xref="S3.E2.m1.8.8.3.3.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.8b"><apply id="S3.E2.m1.8.8.cmml" xref="S3.E2.m1.8.8"><eq id="S3.E2.m1.8.8.4.cmml" xref="S3.E2.m1.8.8.4"></eq><apply id="S3.E2.m1.8.8.5.cmml" xref="S3.E2.m1.8.8.5"><times id="S3.E2.m1.8.8.5.1.cmml" xref="S3.E2.m1.8.8.5.1"></times><apply id="S3.E2.m1.8.8.5.2.cmml" xref="S3.E2.m1.8.8.5.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.5.2.1.cmml" xref="S3.E2.m1.8.8.5.2">subscript</csymbol><ci id="S3.E2.m1.8.8.5.2.2.cmml" xref="S3.E2.m1.8.8.5.2.2">𝐽</ci><apply id="S3.E2.m1.8.8.5.2.3.cmml" xref="S3.E2.m1.8.8.5.2.3"><times id="S3.E2.m1.8.8.5.2.3.1.cmml" xref="S3.E2.m1.8.8.5.2.3.1"></times><ci id="S3.E2.m1.8.8.5.2.3.2.cmml" xref="S3.E2.m1.8.8.5.2.3.2">𝑉</ci><ci id="S3.E2.m1.8.8.5.2.3.3.cmml" xref="S3.E2.m1.8.8.5.2.3.3">𝐼</ci></apply></apply><ci id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5">X</ci></apply><apply id="S3.E2.m1.8.8.3.cmml" xref="S3.E2.m1.8.8.3"><plus id="S3.E2.m1.8.8.3.4.cmml" xref="S3.E2.m1.8.8.3.4"></plus><apply id="S3.E2.m1.6.6.1.1.cmml" xref="S3.E2.m1.6.6.1.1"><apply id="S3.E2.m1.6.6.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.2">superscript</csymbol><apply id="S3.E2.m1.6.6.1.1.2.2.cmml" xref="S3.E2.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.2.2.1.cmml" xref="S3.E2.m1.6.6.1.1.2">subscript</csymbol><sum id="S3.E2.m1.6.6.1.1.2.2.2.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2"></sum><apply id="S3.E2.m1.6.6.1.1.2.2.3.cmml" xref="S3.E2.m1.6.6.1.1.2.2.3"><eq id="S3.E2.m1.6.6.1.1.2.2.3.1.cmml" xref="S3.E2.m1.6.6.1.1.2.2.3.1"></eq><ci id="S3.E2.m1.6.6.1.1.2.2.3.2.cmml" xref="S3.E2.m1.6.6.1.1.2.2.3.2">k</ci><cn type="integer" id="S3.E2.m1.6.6.1.1.2.2.3.3.cmml" xref="S3.E2.m1.6.6.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.6.6.1.1.2.3.cmml" xref="S3.E2.m1.6.6.1.1.2.3">K</ci></apply><apply id="S3.E2.m1.6.6.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1"><apply id="S3.E2.m1.6.6.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.2">subscript</csymbol><sum id="S3.E2.m1.6.6.1.1.1.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.2.2"></sum><apply id="S3.E2.m1.6.6.1.1.1.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.2.3"><in id="S3.E2.m1.6.6.1.1.1.2.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.2.3.1"></in><ci id="S3.E2.m1.6.6.1.1.1.2.3.2.cmml" xref="S3.E2.m1.6.6.1.1.1.2.3.2">j</ci><apply id="S3.E2.m1.6.6.1.1.1.2.3.3.cmml" xref="S3.E2.m1.6.6.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.2.3.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.2.3.3">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.2.3.3.2.cmml" xref="S3.E2.m1.6.6.1.1.1.2.3.3.2">J</ci><ci id="S3.E2.m1.6.6.1.1.1.2.3.3.3.cmml" xref="S3.E2.m1.6.6.1.1.1.2.3.3.3">k</ci></apply></apply></apply><apply id="S3.E2.m1.6.6.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1">subscript</csymbol><apply id="S3.E2.m1.6.6.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.2">𝐞</ci><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.3">𝐫</ci></apply><list id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.4"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">j</ci><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">k</ci></list></apply></apply><cn type="integer" id="S3.E2.m1.6.6.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.3">2</cn></apply><apply id="S3.E2.m1.4.4.2.cmml" xref="S3.E2.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.3.cmml" xref="S3.E2.m1.4.4.2">superscript</csymbol><apply id="S3.E2.m1.4.4.2.4.cmml" xref="S3.E2.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.4.1.cmml" xref="S3.E2.m1.4.4.2">subscript</csymbol><ci id="S3.E2.m1.4.4.2.4.2.cmml" xref="S3.E2.m1.4.4.2.4.2">𝐖</ci><ci id="S3.E2.m1.4.4.2.4.3.cmml" xref="S3.E2.m1.4.4.2.4.3">𝐫</ci></apply><list id="S3.E2.m1.4.4.2.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.2.4"><ci id="S3.E2.m1.3.3.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1">j</ci><ci id="S3.E2.m1.4.4.2.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2.2">k</ci></list></apply></apply></apply></apply><apply id="S3.E2.m1.7.7.2.2.cmml" xref="S3.E2.m1.7.7.2.2"><apply id="S3.E2.m1.7.7.2.2.2.cmml" xref="S3.E2.m1.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.2.2.2.1.cmml" xref="S3.E2.m1.7.7.2.2.2">superscript</csymbol><apply id="S3.E2.m1.7.7.2.2.2.2.cmml" xref="S3.E2.m1.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.2.2.2.2.1.cmml" xref="S3.E2.m1.7.7.2.2.2">subscript</csymbol><sum id="S3.E2.m1.7.7.2.2.2.2.2.cmml" xref="S3.E2.m1.7.7.2.2.2.2.2"></sum><apply id="S3.E2.m1.7.7.2.2.2.2.3.cmml" xref="S3.E2.m1.7.7.2.2.2.2.3"><eq id="S3.E2.m1.7.7.2.2.2.2.3.1.cmml" xref="S3.E2.m1.7.7.2.2.2.2.3.1"></eq><ci id="S3.E2.m1.7.7.2.2.2.2.3.2.cmml" xref="S3.E2.m1.7.7.2.2.2.2.3.2">k</ci><cn type="integer" id="S3.E2.m1.7.7.2.2.2.2.3.3.cmml" xref="S3.E2.m1.7.7.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.7.7.2.2.2.3.cmml" xref="S3.E2.m1.7.7.2.2.2.3">K</ci></apply><apply id="S3.E2.m1.7.7.2.2.1.cmml" xref="S3.E2.m1.7.7.2.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.2.2.1.2.cmml" xref="S3.E2.m1.7.7.2.2.1">subscript</csymbol><apply id="S3.E2.m1.7.7.2.2.1.1.cmml" xref="S3.E2.m1.7.7.2.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.2.2.1.1.2.cmml" xref="S3.E2.m1.7.7.2.2.1">superscript</csymbol><apply id="S3.E2.m1.7.7.2.2.1.1.1.2.cmml" xref="S3.E2.m1.7.7.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.7.7.2.2.1.1.1.2.1.cmml" xref="S3.E2.m1.7.7.2.2.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S3.E2.m1.7.7.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.2.2.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.7.7.2.2.1.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.7.7.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.7.7.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.7.7.2.2.1.1.1.1.1.2.2">𝐞</ci><ci id="S3.E2.m1.7.7.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.7.7.2.2.1.1.1.1.1.2.3">𝐢</ci></apply><ci id="S3.E2.m1.7.7.2.2.1.1.1.1.1.3.cmml" xref="S3.E2.m1.7.7.2.2.1.1.1.1.1.3">k</ci></apply></apply><cn type="integer" id="S3.E2.m1.7.7.2.2.1.1.3.cmml" xref="S3.E2.m1.7.7.2.2.1.1.3">2</cn></apply><apply id="S3.E2.m1.7.7.2.2.1.3.cmml" xref="S3.E2.m1.7.7.2.2.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.2.2.1.3.1.cmml" xref="S3.E2.m1.7.7.2.2.1.3">superscript</csymbol><apply id="S3.E2.m1.7.7.2.2.1.3.2.cmml" xref="S3.E2.m1.7.7.2.2.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.2.2.1.3.2.1.cmml" xref="S3.E2.m1.7.7.2.2.1.3">subscript</csymbol><ci id="S3.E2.m1.7.7.2.2.1.3.2.2.cmml" xref="S3.E2.m1.7.7.2.2.1.3.2.2">𝐖</ci><ci id="S3.E2.m1.7.7.2.2.1.3.2.3.cmml" xref="S3.E2.m1.7.7.2.2.1.3.2.3">𝐢</ci></apply><ci id="S3.E2.m1.7.7.2.2.1.3.3.cmml" xref="S3.E2.m1.7.7.2.2.1.3.3">k</ci></apply></apply></apply><apply id="S3.E2.m1.8.8.3.3.cmml" xref="S3.E2.m1.8.8.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.3.3.2.cmml" xref="S3.E2.m1.8.8.3.3">superscript</csymbol><apply id="S3.E2.m1.8.8.3.3.1.2.cmml" xref="S3.E2.m1.8.8.3.3.1.1"><csymbol cd="latexml" id="S3.E2.m1.8.8.3.3.1.2.1.cmml" xref="S3.E2.m1.8.8.3.3.1.1.2">delimited-∥∥</csymbol><apply id="S3.E2.m1.8.8.3.3.1.1.1.cmml" xref="S3.E2.m1.8.8.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.3.3.1.1.1.1.cmml" xref="S3.E2.m1.8.8.3.3.1.1.1">subscript</csymbol><ci id="S3.E2.m1.8.8.3.3.1.1.1.2.cmml" xref="S3.E2.m1.8.8.3.3.1.1.1.2">𝐞</ci><ci id="S3.E2.m1.8.8.3.3.1.1.1.3.cmml" xref="S3.E2.m1.8.8.3.3.1.1.1.3">𝐩</ci></apply></apply><cn type="integer" id="S3.E2.m1.8.8.3.3.3.cmml" xref="S3.E2.m1.8.8.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.8c">J_{VI}(\pazocal{X})=\sum_{k=1}^{K}\sum_{j\in\pazocal{J}_{k}}\lVert\mathbf{e_{r}}^{j,k}\rVert^{2}_{\mathbf{W_{r}}^{j,k}}+\sum_{k=1}^{K}\lVert\mathbf{e_{i}}^{k}\rVert^{2}_{\mathbf{W_{i}}^{k}}+\lVert\mathbf{e_{p}}\rVert^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.14" class="ltx_p">where <math id="S3.SS2.p1.2.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p1.2.m1.1a"><mi id="S3.SS2.p1.2.m1.1.1" xref="S3.SS2.p1.2.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m1.1b"><ci id="S3.SS2.p1.2.m1.1.1.cmml" xref="S3.SS2.p1.2.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m1.1c">k</annotation></semantics></math> denotes the camera frame index and <math id="S3.SS2.p1.3.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.p1.3.m2.1a"><mi id="S3.SS2.p1.3.m2.1.1" xref="S3.SS2.p1.3.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m2.1b"><ci id="S3.SS2.p1.3.m2.1.1.cmml" xref="S3.SS2.p1.3.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m2.1c">j</annotation></semantics></math> denotes the landmark index. The cost function contains the reprojection <math id="S3.SS2.p1.4.m3.1" class="ltx_Math" alttext="\mathbf{e_{r}}" display="inline"><semantics id="S3.SS2.p1.4.m3.1a"><msub id="S3.SS2.p1.4.m3.1.1" xref="S3.SS2.p1.4.m3.1.1.cmml"><mi id="S3.SS2.p1.4.m3.1.1.2" xref="S3.SS2.p1.4.m3.1.1.2.cmml">𝐞</mi><mi id="S3.SS2.p1.4.m3.1.1.3" xref="S3.SS2.p1.4.m3.1.1.3.cmml">𝐫</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m3.1b"><apply id="S3.SS2.p1.4.m3.1.1.cmml" xref="S3.SS2.p1.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m3.1.1.1.cmml" xref="S3.SS2.p1.4.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m3.1.1.2.cmml" xref="S3.SS2.p1.4.m3.1.1.2">𝐞</ci><ci id="S3.SS2.p1.4.m3.1.1.3.cmml" xref="S3.SS2.p1.4.m3.1.1.3">𝐫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m3.1c">\mathbf{e_{r}}</annotation></semantics></math>, inertial <math id="S3.SS2.p1.5.m4.1" class="ltx_Math" alttext="\mathbf{e_{i}}" display="inline"><semantics id="S3.SS2.p1.5.m4.1a"><msub id="S3.SS2.p1.5.m4.1.1" xref="S3.SS2.p1.5.m4.1.1.cmml"><mi id="S3.SS2.p1.5.m4.1.1.2" xref="S3.SS2.p1.5.m4.1.1.2.cmml">𝐞</mi><mi id="S3.SS2.p1.5.m4.1.1.3" xref="S3.SS2.p1.5.m4.1.1.3.cmml">𝐢</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m4.1b"><apply id="S3.SS2.p1.5.m4.1.1.cmml" xref="S3.SS2.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m4.1.1.1.cmml" xref="S3.SS2.p1.5.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m4.1.1.2.cmml" xref="S3.SS2.p1.5.m4.1.1.2">𝐞</ci><ci id="S3.SS2.p1.5.m4.1.1.3.cmml" xref="S3.SS2.p1.5.m4.1.1.3">𝐢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m4.1c">\mathbf{e_{i}}</annotation></semantics></math>, and marginalization <math id="S3.SS2.p1.6.m5.1" class="ltx_Math" alttext="\mathbf{e_{p}}" display="inline"><semantics id="S3.SS2.p1.6.m5.1a"><msub id="S3.SS2.p1.6.m5.1.1" xref="S3.SS2.p1.6.m5.1.1.cmml"><mi id="S3.SS2.p1.6.m5.1.1.2" xref="S3.SS2.p1.6.m5.1.1.2.cmml">𝐞</mi><mi id="S3.SS2.p1.6.m5.1.1.3" xref="S3.SS2.p1.6.m5.1.1.3.cmml">𝐩</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m5.1b"><apply id="S3.SS2.p1.6.m5.1.1.cmml" xref="S3.SS2.p1.6.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m5.1.1.1.cmml" xref="S3.SS2.p1.6.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m5.1.1.2.cmml" xref="S3.SS2.p1.6.m5.1.1.2">𝐞</ci><ci id="S3.SS2.p1.6.m5.1.1.3.cmml" xref="S3.SS2.p1.6.m5.1.1.3">𝐩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m5.1c">\mathbf{e_{p}}</annotation></semantics></math> residuals weighted by their respective information matrices.
The reprojection error for the landmark <math id="S3.SS2.p1.7.m6.1" class="ltx_Math" alttext="{}_{W}\mathbf{l}_{j}\in\pazocal{J}_{k}" display="inline"><semantics id="S3.SS2.p1.7.m6.1a"><mrow id="S3.SS2.p1.7.m6.1.1" xref="S3.SS2.p1.7.m6.1.1.cmml"><mmultiscripts id="S3.SS2.p1.7.m6.1.1.2" xref="S3.SS2.p1.7.m6.1.1.2.cmml"><mi id="S3.SS2.p1.7.m6.1.1.2.2.2" xref="S3.SS2.p1.7.m6.1.1.2.2.2.cmml">𝐥</mi><mi id="S3.SS2.p1.7.m6.1.1.2.2.3" xref="S3.SS2.p1.7.m6.1.1.2.2.3.cmml">j</mi><mrow id="S3.SS2.p1.7.m6.1.1.2a" xref="S3.SS2.p1.7.m6.1.1.2.cmml"></mrow><mprescripts id="S3.SS2.p1.7.m6.1.1.2b" xref="S3.SS2.p1.7.m6.1.1.2.cmml"></mprescripts><mi id="S3.SS2.p1.7.m6.1.1.2.3" xref="S3.SS2.p1.7.m6.1.1.2.3.cmml">W</mi><mrow id="S3.SS2.p1.7.m6.1.1.2c" xref="S3.SS2.p1.7.m6.1.1.2.cmml"></mrow></mmultiscripts><mo id="S3.SS2.p1.7.m6.1.1.1" xref="S3.SS2.p1.7.m6.1.1.1.cmml">∈</mo><msub id="S3.SS2.p1.7.m6.1.1.3" xref="S3.SS2.p1.7.m6.1.1.3.cmml"><mi mathvariant="normal" id="S3.SS2.p1.7.m6.1.1.3.2" xref="S3.SS2.p1.7.m6.1.1.3.2.cmml">J</mi><mi mathvariant="normal" id="S3.SS2.p1.7.m6.1.1.3.3" xref="S3.SS2.p1.7.m6.1.1.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m6.1b"><apply id="S3.SS2.p1.7.m6.1.1.cmml" xref="S3.SS2.p1.7.m6.1.1"><in id="S3.SS2.p1.7.m6.1.1.1.cmml" xref="S3.SS2.p1.7.m6.1.1.1"></in><apply id="S3.SS2.p1.7.m6.1.1.2.cmml" xref="S3.SS2.p1.7.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m6.1.1.2.1.cmml" xref="S3.SS2.p1.7.m6.1.1.2">subscript</csymbol><apply id="S3.SS2.p1.7.m6.1.1.2.2.cmml" xref="S3.SS2.p1.7.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m6.1.1.2.2.1.cmml" xref="S3.SS2.p1.7.m6.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.7.m6.1.1.2.2.2.cmml" xref="S3.SS2.p1.7.m6.1.1.2.2.2">𝐥</ci><ci id="S3.SS2.p1.7.m6.1.1.2.2.3.cmml" xref="S3.SS2.p1.7.m6.1.1.2.2.3">𝑗</ci></apply><ci id="S3.SS2.p1.7.m6.1.1.2.3.cmml" xref="S3.SS2.p1.7.m6.1.1.2.3">𝑊</ci></apply><apply id="S3.SS2.p1.7.m6.1.1.3.cmml" xref="S3.SS2.p1.7.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m6.1.1.3.1.cmml" xref="S3.SS2.p1.7.m6.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.7.m6.1.1.3.2.cmml" xref="S3.SS2.p1.7.m6.1.1.3.2">J</ci><ci id="S3.SS2.p1.7.m6.1.1.3.3.cmml" xref="S3.SS2.p1.7.m6.1.1.3.3">k</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m6.1c">{}_{W}\mathbf{l}_{j}\in\pazocal{J}_{k}</annotation></semantics></math> is calculated as <math id="S3.SS2.p1.8.m7.5" class="ltx_Math" alttext="\mathbf{e_{r}}^{i,j}=h({}_{W}\mathbf{l}_{j})-\mathbf{z}^{j,k}" display="inline"><semantics id="S3.SS2.p1.8.m7.5a"><mrow id="S3.SS2.p1.8.m7.5.5" xref="S3.SS2.p1.8.m7.5.5.cmml"><mmultiscripts id="S3.SS2.p1.8.m7.5.5.3" xref="S3.SS2.p1.8.m7.5.5.3.cmml"><mi id="S3.SS2.p1.8.m7.5.5.3.2.2" xref="S3.SS2.p1.8.m7.5.5.3.2.2.cmml">𝐞</mi><mi id="S3.SS2.p1.8.m7.5.5.3.2.3" xref="S3.SS2.p1.8.m7.5.5.3.2.3.cmml">𝐫</mi><mrow id="S3.SS2.p1.8.m7.5.5.3a" xref="S3.SS2.p1.8.m7.5.5.3.cmml"></mrow><mrow id="S3.SS2.p1.8.m7.5.5.3b" xref="S3.SS2.p1.8.m7.5.5.3.cmml"></mrow><mrow id="S3.SS2.p1.8.m7.2.2.2.4" xref="S3.SS2.p1.8.m7.2.2.2.3.cmml"><mi id="S3.SS2.p1.8.m7.1.1.1.1" xref="S3.SS2.p1.8.m7.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p1.8.m7.2.2.2.4.1" xref="S3.SS2.p1.8.m7.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p1.8.m7.2.2.2.2" xref="S3.SS2.p1.8.m7.2.2.2.2.cmml">j</mi></mrow></mmultiscripts><mo id="S3.SS2.p1.8.m7.5.5.2" xref="S3.SS2.p1.8.m7.5.5.2.cmml">=</mo><mrow id="S3.SS2.p1.8.m7.5.5.1" xref="S3.SS2.p1.8.m7.5.5.1.cmml"><mrow id="S3.SS2.p1.8.m7.5.5.1.1" xref="S3.SS2.p1.8.m7.5.5.1.1.cmml"><mi id="S3.SS2.p1.8.m7.5.5.1.1.3" xref="S3.SS2.p1.8.m7.5.5.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.8.m7.5.5.1.1.2" xref="S3.SS2.p1.8.m7.5.5.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.8.m7.5.5.1.1.1.1" xref="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.8.m7.5.5.1.1.1.1.2" xref="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.cmml">(</mo><mmultiscripts id="S3.SS2.p1.8.m7.5.5.1.1.1.1.1" xref="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.2.2" xref="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.2.2.cmml">𝐥</mi><mi id="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.2.3" xref="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.2.3.cmml">j</mi><mrow id="S3.SS2.p1.8.m7.5.5.1.1.1.1.1a" xref="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.cmml"></mrow><mprescripts id="S3.SS2.p1.8.m7.5.5.1.1.1.1.1b" xref="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.cmml"></mprescripts><mi id="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.3" xref="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.3.cmml">W</mi><mrow id="S3.SS2.p1.8.m7.5.5.1.1.1.1.1c" xref="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.cmml"></mrow></mmultiscripts><mo stretchy="false" id="S3.SS2.p1.8.m7.5.5.1.1.1.1.3" xref="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.8.m7.5.5.1.2" xref="S3.SS2.p1.8.m7.5.5.1.2.cmml">−</mo><msup id="S3.SS2.p1.8.m7.5.5.1.3" xref="S3.SS2.p1.8.m7.5.5.1.3.cmml"><mi id="S3.SS2.p1.8.m7.5.5.1.3.2" xref="S3.SS2.p1.8.m7.5.5.1.3.2.cmml">𝐳</mi><mrow id="S3.SS2.p1.8.m7.4.4.2.4" xref="S3.SS2.p1.8.m7.4.4.2.3.cmml"><mi id="S3.SS2.p1.8.m7.3.3.1.1" xref="S3.SS2.p1.8.m7.3.3.1.1.cmml">j</mi><mo id="S3.SS2.p1.8.m7.4.4.2.4.1" xref="S3.SS2.p1.8.m7.4.4.2.3.cmml">,</mo><mi id="S3.SS2.p1.8.m7.4.4.2.2" xref="S3.SS2.p1.8.m7.4.4.2.2.cmml">k</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m7.5b"><apply id="S3.SS2.p1.8.m7.5.5.cmml" xref="S3.SS2.p1.8.m7.5.5"><eq id="S3.SS2.p1.8.m7.5.5.2.cmml" xref="S3.SS2.p1.8.m7.5.5.2"></eq><apply id="S3.SS2.p1.8.m7.5.5.3.cmml" xref="S3.SS2.p1.8.m7.5.5.3"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m7.5.5.3.1.cmml" xref="S3.SS2.p1.8.m7.5.5.3">superscript</csymbol><apply id="S3.SS2.p1.8.m7.5.5.3.2.cmml" xref="S3.SS2.p1.8.m7.5.5.3"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m7.5.5.3.2.1.cmml" xref="S3.SS2.p1.8.m7.5.5.3">subscript</csymbol><ci id="S3.SS2.p1.8.m7.5.5.3.2.2.cmml" xref="S3.SS2.p1.8.m7.5.5.3.2.2">𝐞</ci><ci id="S3.SS2.p1.8.m7.5.5.3.2.3.cmml" xref="S3.SS2.p1.8.m7.5.5.3.2.3">𝐫</ci></apply><list id="S3.SS2.p1.8.m7.2.2.2.3.cmml" xref="S3.SS2.p1.8.m7.2.2.2.4"><ci id="S3.SS2.p1.8.m7.1.1.1.1.cmml" xref="S3.SS2.p1.8.m7.1.1.1.1">𝑖</ci><ci id="S3.SS2.p1.8.m7.2.2.2.2.cmml" xref="S3.SS2.p1.8.m7.2.2.2.2">𝑗</ci></list></apply><apply id="S3.SS2.p1.8.m7.5.5.1.cmml" xref="S3.SS2.p1.8.m7.5.5.1"><minus id="S3.SS2.p1.8.m7.5.5.1.2.cmml" xref="S3.SS2.p1.8.m7.5.5.1.2"></minus><apply id="S3.SS2.p1.8.m7.5.5.1.1.cmml" xref="S3.SS2.p1.8.m7.5.5.1.1"><times id="S3.SS2.p1.8.m7.5.5.1.1.2.cmml" xref="S3.SS2.p1.8.m7.5.5.1.1.2"></times><ci id="S3.SS2.p1.8.m7.5.5.1.1.3.cmml" xref="S3.SS2.p1.8.m7.5.5.1.1.3">ℎ</ci><apply id="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.cmml" xref="S3.SS2.p1.8.m7.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.8.m7.5.5.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.8.m7.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.8.m7.5.5.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.2.2">𝐥</ci><ci id="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.8.m7.5.5.1.1.1.1.1.3">𝑊</ci></apply></apply><apply id="S3.SS2.p1.8.m7.5.5.1.3.cmml" xref="S3.SS2.p1.8.m7.5.5.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m7.5.5.1.3.1.cmml" xref="S3.SS2.p1.8.m7.5.5.1.3">superscript</csymbol><ci id="S3.SS2.p1.8.m7.5.5.1.3.2.cmml" xref="S3.SS2.p1.8.m7.5.5.1.3.2">𝐳</ci><list id="S3.SS2.p1.8.m7.4.4.2.3.cmml" xref="S3.SS2.p1.8.m7.4.4.2.4"><ci id="S3.SS2.p1.8.m7.3.3.1.1.cmml" xref="S3.SS2.p1.8.m7.3.3.1.1">𝑗</ci><ci id="S3.SS2.p1.8.m7.4.4.2.2.cmml" xref="S3.SS2.p1.8.m7.4.4.2.2">𝑘</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m7.5c">\mathbf{e_{r}}^{i,j}=h({}_{W}\mathbf{l}_{j})-\mathbf{z}^{j,k}</annotation></semantics></math> where <math id="S3.SS2.p1.9.m8.1" class="ltx_Math" alttext="\pazocal{J}_{k}" display="inline"><semantics id="S3.SS2.p1.9.m8.1a"><msub id="S3.SS2.p1.9.m8.1.1" xref="S3.SS2.p1.9.m8.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p1.9.m8.1.1.2" xref="S3.SS2.p1.9.m8.1.1.2.cmml">J</mi><mi mathvariant="normal" id="S3.SS2.p1.9.m8.1.1.3" xref="S3.SS2.p1.9.m8.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m8.1b"><apply id="S3.SS2.p1.9.m8.1.1.cmml" xref="S3.SS2.p1.9.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m8.1.1.1.cmml" xref="S3.SS2.p1.9.m8.1.1">subscript</csymbol><ci id="S3.SS2.p1.9.m8.1.1.2.cmml" xref="S3.SS2.p1.9.m8.1.1.2">J</ci><ci id="S3.SS2.p1.9.m8.1.1.3.cmml" xref="S3.SS2.p1.9.m8.1.1.3">k</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m8.1c">\pazocal{J}_{k}</annotation></semantics></math> is the set of all the landmarks visible in the keyframe <math id="S3.SS2.p1.10.m9.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p1.10.m9.1a"><mi id="S3.SS2.p1.10.m9.1.1" xref="S3.SS2.p1.10.m9.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m9.1b"><ci id="S3.SS2.p1.10.m9.1.1.cmml" xref="S3.SS2.p1.10.m9.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m9.1c">k</annotation></semantics></math>. Here, <math id="S3.SS2.p1.11.m10.1" class="ltx_math_unparsed" alttext="h(.)" display="inline"><semantics id="S3.SS2.p1.11.m10.1a"><mrow id="S3.SS2.p1.11.m10.1b"><mi id="S3.SS2.p1.11.m10.1.1">h</mi><mrow id="S3.SS2.p1.11.m10.1.2"><mo stretchy="false" id="S3.SS2.p1.11.m10.1.2.1">(</mo><mo lspace="0em" rspace="0.167em" id="S3.SS2.p1.11.m10.1.2.2">.</mo><mo stretchy="false" id="S3.SS2.p1.11.m10.1.2.3">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m10.1c">h(.)</annotation></semantics></math> denotes the camera projection model and <math id="S3.SS2.p1.12.m11.2" class="ltx_Math" alttext="\mathbf{z}^{j,k}" display="inline"><semantics id="S3.SS2.p1.12.m11.2a"><msup id="S3.SS2.p1.12.m11.2.3" xref="S3.SS2.p1.12.m11.2.3.cmml"><mi id="S3.SS2.p1.12.m11.2.3.2" xref="S3.SS2.p1.12.m11.2.3.2.cmml">𝐳</mi><mrow id="S3.SS2.p1.12.m11.2.2.2.4" xref="S3.SS2.p1.12.m11.2.2.2.3.cmml"><mi id="S3.SS2.p1.12.m11.1.1.1.1" xref="S3.SS2.p1.12.m11.1.1.1.1.cmml">j</mi><mo id="S3.SS2.p1.12.m11.2.2.2.4.1" xref="S3.SS2.p1.12.m11.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p1.12.m11.2.2.2.2" xref="S3.SS2.p1.12.m11.2.2.2.2.cmml">k</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m11.2b"><apply id="S3.SS2.p1.12.m11.2.3.cmml" xref="S3.SS2.p1.12.m11.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m11.2.3.1.cmml" xref="S3.SS2.p1.12.m11.2.3">superscript</csymbol><ci id="S3.SS2.p1.12.m11.2.3.2.cmml" xref="S3.SS2.p1.12.m11.2.3.2">𝐳</ci><list id="S3.SS2.p1.12.m11.2.2.2.3.cmml" xref="S3.SS2.p1.12.m11.2.2.2.4"><ci id="S3.SS2.p1.12.m11.1.1.1.1.cmml" xref="S3.SS2.p1.12.m11.1.1.1.1">𝑗</ci><ci id="S3.SS2.p1.12.m11.2.2.2.2.cmml" xref="S3.SS2.p1.12.m11.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m11.2c">\mathbf{z}^{j,k}</annotation></semantics></math> the measurements in the image coordinates. For more details, please refer to  <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">okvis</span>]</cite>. The inertial residuals <math id="S3.SS2.p1.13.m12.1" class="ltx_Math" alttext="\mathbf{e_{i}}" display="inline"><semantics id="S3.SS2.p1.13.m12.1a"><msub id="S3.SS2.p1.13.m12.1.1" xref="S3.SS2.p1.13.m12.1.1.cmml"><mi id="S3.SS2.p1.13.m12.1.1.2" xref="S3.SS2.p1.13.m12.1.1.2.cmml">𝐞</mi><mi id="S3.SS2.p1.13.m12.1.1.3" xref="S3.SS2.p1.13.m12.1.1.3.cmml">𝐢</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m12.1b"><apply id="S3.SS2.p1.13.m12.1.1.cmml" xref="S3.SS2.p1.13.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m12.1.1.1.cmml" xref="S3.SS2.p1.13.m12.1.1">subscript</csymbol><ci id="S3.SS2.p1.13.m12.1.1.2.cmml" xref="S3.SS2.p1.13.m12.1.1.2">𝐞</ci><ci id="S3.SS2.p1.13.m12.1.1.3.cmml" xref="S3.SS2.p1.13.m12.1.1.3">𝐢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m12.1c">\mathbf{e_{i}}</annotation></semantics></math> are obtained using the IMU preintegration theory proposed in  <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">qin2017vins_mono</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">quatenrion_sola</span>]</cite> which is detailed in  Section  <a href="#S3.SS3" title="III-C IMU Preintegration ‣ III Visual-Inertial-Magnetometer Fusion ‣ Enhancing Visual Inertial SLAM with Magnetic Measurements" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-C</span></span></a>. We employ a marginalization strategy similar to  <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">okvis</span>]</cite> to obtain the marginalization prior error term, <math id="S3.SS2.p1.14.m13.1" class="ltx_Math" alttext="\mathbf{e_{p}}" display="inline"><semantics id="S3.SS2.p1.14.m13.1a"><msub id="S3.SS2.p1.14.m13.1.1" xref="S3.SS2.p1.14.m13.1.1.cmml"><mi id="S3.SS2.p1.14.m13.1.1.2" xref="S3.SS2.p1.14.m13.1.1.2.cmml">𝐞</mi><mi id="S3.SS2.p1.14.m13.1.1.3" xref="S3.SS2.p1.14.m13.1.1.3.cmml">𝐩</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.14.m13.1b"><apply id="S3.SS2.p1.14.m13.1.1.cmml" xref="S3.SS2.p1.14.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.14.m13.1.1.1.cmml" xref="S3.SS2.p1.14.m13.1.1">subscript</csymbol><ci id="S3.SS2.p1.14.m13.1.1.2.cmml" xref="S3.SS2.p1.14.m13.1.1.2">𝐞</ci><ci id="S3.SS2.p1.14.m13.1.1.3.cmml" xref="S3.SS2.p1.14.m13.1.1.3">𝐩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.14.m13.1c">\mathbf{e_{p}}</annotation></semantics></math>. Whenever a new frame is inserted in the optimization window, the marginalization operation is classified into two cases. If the oldest frame in the sliding window is not a keyframe, it is marginalized together with the oldest speed and bias states, and all its landmark measurements are dropped to maintain sparsity. In the case where the oldest frame is a keyframe, only the landmarks that are visible in that frame but not in the most recent keyframe are marginalized out.
We introduce the magnetometer residuals based on IMU preintegration into  Eq.  <a href="#S3.E2" title="In III-B Fusing visual, inertial and magnetometer measurements ‣ III Visual-Inertial-Magnetometer Fusion ‣ Enhancing Visual Inertial SLAM with Magnetic Measurements" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> to obtain the cost function used in this work as</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.5" class="ltx_Math" alttext="J(\pazocal{X})=J_{VI}(\pazocal{X})+\sum_{k=1}^{K}\sum_{j\in\pazocal{M}_{k}}\lVert\mathbf{e_{m}}^{j,k}\rVert^{2}_{\mathbf{W_{m}}^{k}}" display="block"><semantics id="S3.E3.m1.5a"><mrow id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml"><mrow id="S3.E3.m1.5.5.3" xref="S3.E3.m1.5.5.3.cmml"><mi id="S3.E3.m1.5.5.3.2" xref="S3.E3.m1.5.5.3.2.cmml">J</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.3.1" xref="S3.E3.m1.5.5.3.1.cmml">​</mo><mrow id="S3.E3.m1.5.5.3.3.2" xref="S3.E3.m1.5.5.3.cmml"><mo stretchy="false" id="S3.E3.m1.5.5.3.3.2.1" xref="S3.E3.m1.5.5.3.cmml">(</mo><mi mathvariant="normal" id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">X</mi><mo stretchy="false" id="S3.E3.m1.5.5.3.3.2.2" xref="S3.E3.m1.5.5.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.5.5.2" xref="S3.E3.m1.5.5.2.cmml">=</mo><mrow id="S3.E3.m1.5.5.1" xref="S3.E3.m1.5.5.1.cmml"><mrow id="S3.E3.m1.5.5.1.3" xref="S3.E3.m1.5.5.1.3.cmml"><msub id="S3.E3.m1.5.5.1.3.2" xref="S3.E3.m1.5.5.1.3.2.cmml"><mi mathvariant="normal" id="S3.E3.m1.5.5.1.3.2.2" xref="S3.E3.m1.5.5.1.3.2.2.cmml">J</mi><mrow id="S3.E3.m1.5.5.1.3.2.3" xref="S3.E3.m1.5.5.1.3.2.3.cmml"><mi mathvariant="normal" id="S3.E3.m1.5.5.1.3.2.3.2" xref="S3.E3.m1.5.5.1.3.2.3.2.cmml">V</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.1.3.2.3.1" xref="S3.E3.m1.5.5.1.3.2.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E3.m1.5.5.1.3.2.3.3" xref="S3.E3.m1.5.5.1.3.2.3.3.cmml">I</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.1.3.1" xref="S3.E3.m1.5.5.1.3.1.cmml">​</mo><mrow id="S3.E3.m1.5.5.1.3.3.2" xref="S3.E3.m1.5.5.1.3.cmml"><mo stretchy="false" id="S3.E3.m1.5.5.1.3.3.2.1" xref="S3.E3.m1.5.5.1.3.cmml">(</mo><mi mathvariant="normal" id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml">X</mi><mo stretchy="false" id="S3.E3.m1.5.5.1.3.3.2.2" xref="S3.E3.m1.5.5.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.055em" id="S3.E3.m1.5.5.1.2" xref="S3.E3.m1.5.5.1.2.cmml">+</mo><mrow id="S3.E3.m1.5.5.1.1" xref="S3.E3.m1.5.5.1.1.cmml"><munderover id="S3.E3.m1.5.5.1.1.2" xref="S3.E3.m1.5.5.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E3.m1.5.5.1.1.2.2.2" xref="S3.E3.m1.5.5.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E3.m1.5.5.1.1.2.2.3" xref="S3.E3.m1.5.5.1.1.2.2.3.cmml"><mi mathvariant="normal" id="S3.E3.m1.5.5.1.1.2.2.3.2" xref="S3.E3.m1.5.5.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E3.m1.5.5.1.1.2.2.3.1" xref="S3.E3.m1.5.5.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E3.m1.5.5.1.1.2.2.3.3" xref="S3.E3.m1.5.5.1.1.2.2.3.3.cmml">1</mn></mrow><mi mathvariant="normal" id="S3.E3.m1.5.5.1.1.2.3" xref="S3.E3.m1.5.5.1.1.2.3.cmml">K</mi></munderover><mrow id="S3.E3.m1.5.5.1.1.1" xref="S3.E3.m1.5.5.1.1.1.cmml"><munder id="S3.E3.m1.5.5.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E3.m1.5.5.1.1.1.2.2" xref="S3.E3.m1.5.5.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.5.5.1.1.1.2.3" xref="S3.E3.m1.5.5.1.1.1.2.3.cmml"><mi mathvariant="normal" id="S3.E3.m1.5.5.1.1.1.2.3.2" xref="S3.E3.m1.5.5.1.1.1.2.3.2.cmml">j</mi><mo id="S3.E3.m1.5.5.1.1.1.2.3.1" xref="S3.E3.m1.5.5.1.1.1.2.3.1.cmml">∈</mo><msub id="S3.E3.m1.5.5.1.1.1.2.3.3" xref="S3.E3.m1.5.5.1.1.1.2.3.3.cmml"><mi mathvariant="normal" id="S3.E3.m1.5.5.1.1.1.2.3.3.2" xref="S3.E3.m1.5.5.1.1.1.2.3.3.2.cmml">M</mi><mi mathvariant="normal" id="S3.E3.m1.5.5.1.1.1.2.3.3.3" xref="S3.E3.m1.5.5.1.1.1.2.3.3.3.cmml">k</mi></msub></mrow></munder><msubsup id="S3.E3.m1.5.5.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.cmml"><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.2.cmml"><mo fence="true" lspace="0em" rspace="0em" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.2.1.cmml">∥</mo><mmultiscripts id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml">𝐞</mi><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.3.cmml">𝐦</mi><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1a" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.cmml"></mrow><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1b" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.cmml"></mrow><mrow id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.3.cmml"><mi mathvariant="normal" id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">j</mi><mo id="S3.E3.m1.2.2.2.4.1" xref="S3.E3.m1.2.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">k</mi></mrow></mmultiscripts><mo fence="true" lspace="0em" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.2.1.cmml">∥</mo></mrow><mmultiscripts id="S3.E3.m1.5.5.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.3.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.3.2.2" xref="S3.E3.m1.5.5.1.1.1.1.3.2.2.cmml">𝐖</mi><mi id="S3.E3.m1.5.5.1.1.1.1.3.2.3" xref="S3.E3.m1.5.5.1.1.1.1.3.2.3.cmml">𝐦</mi><mrow id="S3.E3.m1.5.5.1.1.1.1.3a" xref="S3.E3.m1.5.5.1.1.1.1.3.cmml"></mrow><mrow id="S3.E3.m1.5.5.1.1.1.1.3b" xref="S3.E3.m1.5.5.1.1.1.1.3.cmml"></mrow><mi mathvariant="normal" id="S3.E3.m1.5.5.1.1.1.1.3.3" xref="S3.E3.m1.5.5.1.1.1.1.3.3.cmml">k</mi></mmultiscripts><mn id="S3.E3.m1.5.5.1.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.5b"><apply id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5"><eq id="S3.E3.m1.5.5.2.cmml" xref="S3.E3.m1.5.5.2"></eq><apply id="S3.E3.m1.5.5.3.cmml" xref="S3.E3.m1.5.5.3"><times id="S3.E3.m1.5.5.3.1.cmml" xref="S3.E3.m1.5.5.3.1"></times><ci id="S3.E3.m1.5.5.3.2.cmml" xref="S3.E3.m1.5.5.3.2">𝐽</ci><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">X</ci></apply><apply id="S3.E3.m1.5.5.1.cmml" xref="S3.E3.m1.5.5.1"><plus id="S3.E3.m1.5.5.1.2.cmml" xref="S3.E3.m1.5.5.1.2"></plus><apply id="S3.E3.m1.5.5.1.3.cmml" xref="S3.E3.m1.5.5.1.3"><times id="S3.E3.m1.5.5.1.3.1.cmml" xref="S3.E3.m1.5.5.1.3.1"></times><apply id="S3.E3.m1.5.5.1.3.2.cmml" xref="S3.E3.m1.5.5.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.3.2.1.cmml" xref="S3.E3.m1.5.5.1.3.2">subscript</csymbol><ci id="S3.E3.m1.5.5.1.3.2.2.cmml" xref="S3.E3.m1.5.5.1.3.2.2">J</ci><apply id="S3.E3.m1.5.5.1.3.2.3.cmml" xref="S3.E3.m1.5.5.1.3.2.3"><times id="S3.E3.m1.5.5.1.3.2.3.1.cmml" xref="S3.E3.m1.5.5.1.3.2.3.1"></times><ci id="S3.E3.m1.5.5.1.3.2.3.2.cmml" xref="S3.E3.m1.5.5.1.3.2.3.2">V</ci><ci id="S3.E3.m1.5.5.1.3.2.3.3.cmml" xref="S3.E3.m1.5.5.1.3.2.3.3">I</ci></apply></apply><ci id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4">X</ci></apply><apply id="S3.E3.m1.5.5.1.1.cmml" xref="S3.E3.m1.5.5.1.1"><apply id="S3.E3.m1.5.5.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.2.1.cmml" xref="S3.E3.m1.5.5.1.1.2">superscript</csymbol><apply id="S3.E3.m1.5.5.1.1.2.2.cmml" xref="S3.E3.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.2.2.1.cmml" xref="S3.E3.m1.5.5.1.1.2">subscript</csymbol><sum id="S3.E3.m1.5.5.1.1.2.2.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2.2"></sum><apply id="S3.E3.m1.5.5.1.1.2.2.3.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3"><eq id="S3.E3.m1.5.5.1.1.2.2.3.1.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.1"></eq><ci id="S3.E3.m1.5.5.1.1.2.2.3.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.2">k</ci><cn type="integer" id="S3.E3.m1.5.5.1.1.2.2.3.3.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.5.5.1.1.2.3.cmml" xref="S3.E3.m1.5.5.1.1.2.3">K</ci></apply><apply id="S3.E3.m1.5.5.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1"><apply id="S3.E3.m1.5.5.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.2">subscript</csymbol><sum id="S3.E3.m1.5.5.1.1.1.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.2.2"></sum><apply id="S3.E3.m1.5.5.1.1.1.2.3.cmml" xref="S3.E3.m1.5.5.1.1.1.2.3"><in id="S3.E3.m1.5.5.1.1.1.2.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.2.3.1"></in><ci id="S3.E3.m1.5.5.1.1.1.2.3.2.cmml" xref="S3.E3.m1.5.5.1.1.1.2.3.2">j</ci><apply id="S3.E3.m1.5.5.1.1.1.2.3.3.cmml" xref="S3.E3.m1.5.5.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.2.3.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.2.3.3">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.2.3.3.2.cmml" xref="S3.E3.m1.5.5.1.1.1.2.3.3.2">M</ci><ci id="S3.E3.m1.5.5.1.1.1.2.3.3.3.cmml" xref="S3.E3.m1.5.5.1.1.1.2.3.3.3">k</ci></apply></apply></apply><apply id="S3.E3.m1.5.5.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.2">𝐞</ci><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.3">𝐦</ci></apply><list id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.4"><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">j</ci><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">k</ci></list></apply></apply><cn type="integer" id="S3.E3.m1.5.5.1.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.3">2</cn></apply><apply id="S3.E3.m1.5.5.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3">superscript</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.3.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3.2.2">𝐖</ci><ci id="S3.E3.m1.5.5.1.1.1.1.3.2.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3.2.3">𝐦</ci></apply><ci id="S3.E3.m1.5.5.1.1.1.1.3.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3.3">k</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.5c">J(\pazocal{X})=J_{VI}(\pazocal{X})+\sum_{k=1}^{K}\sum_{j\in\pazocal{M}_{k}}\lVert\mathbf{e_{m}}^{j,k}\rVert^{2}_{\mathbf{W_{m}}^{k}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.18" class="ltx_p">where <math id="S3.SS2.p1.15.m1.1" class="ltx_Math" alttext="\pazocal{M}_{k}" display="inline"><semantics id="S3.SS2.p1.15.m1.1a"><msub id="S3.SS2.p1.15.m1.1.1" xref="S3.SS2.p1.15.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p1.15.m1.1.1.2" xref="S3.SS2.p1.15.m1.1.1.2.cmml">M</mi><mi mathvariant="normal" id="S3.SS2.p1.15.m1.1.1.3" xref="S3.SS2.p1.15.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.15.m1.1b"><apply id="S3.SS2.p1.15.m1.1.1.cmml" xref="S3.SS2.p1.15.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.15.m1.1.1.1.cmml" xref="S3.SS2.p1.15.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.15.m1.1.1.2.cmml" xref="S3.SS2.p1.15.m1.1.1.2">M</ci><ci id="S3.SS2.p1.15.m1.1.1.3.cmml" xref="S3.SS2.p1.15.m1.1.1.3">k</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.15.m1.1c">\pazocal{M}_{k}</annotation></semantics></math> denotes all magnetometer measurements attached to the system state <math id="S3.SS2.p1.16.m2.1" class="ltx_Math" alttext="\mathbf{x}_{k}" display="inline"><semantics id="S3.SS2.p1.16.m2.1a"><msub id="S3.SS2.p1.16.m2.1.1" xref="S3.SS2.p1.16.m2.1.1.cmml"><mi id="S3.SS2.p1.16.m2.1.1.2" xref="S3.SS2.p1.16.m2.1.1.2.cmml">𝐱</mi><mi id="S3.SS2.p1.16.m2.1.1.3" xref="S3.SS2.p1.16.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.16.m2.1b"><apply id="S3.SS2.p1.16.m2.1.1.cmml" xref="S3.SS2.p1.16.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.16.m2.1.1.1.cmml" xref="S3.SS2.p1.16.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.16.m2.1.1.2.cmml" xref="S3.SS2.p1.16.m2.1.1.2">𝐱</ci><ci id="S3.SS2.p1.16.m2.1.1.3.cmml" xref="S3.SS2.p1.16.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.16.m2.1c">\mathbf{x}_{k}</annotation></semantics></math> by the error term. In the remainder of  Section  <a href="#S3" title="III Visual-Inertial-Magnetometer Fusion ‣ Enhancing Visual Inertial SLAM with Magnetic Measurements" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>, we use the output of the IMU preintegration algorithm to derive the magnetometer error term <math id="S3.SS2.p1.17.m3.2" class="ltx_Math" alttext="\mathbf{e_{m}}^{j,k}" display="inline"><semantics id="S3.SS2.p1.17.m3.2a"><mmultiscripts id="S3.SS2.p1.17.m3.2.3" xref="S3.SS2.p1.17.m3.2.3.cmml"><mi id="S3.SS2.p1.17.m3.2.3.2.2" xref="S3.SS2.p1.17.m3.2.3.2.2.cmml">𝐞</mi><mi id="S3.SS2.p1.17.m3.2.3.2.3" xref="S3.SS2.p1.17.m3.2.3.2.3.cmml">𝐦</mi><mrow id="S3.SS2.p1.17.m3.2.3a" xref="S3.SS2.p1.17.m3.2.3.cmml"></mrow><mrow id="S3.SS2.p1.17.m3.2.3b" xref="S3.SS2.p1.17.m3.2.3.cmml"></mrow><mrow id="S3.SS2.p1.17.m3.2.2.2.4" xref="S3.SS2.p1.17.m3.2.2.2.3.cmml"><mi id="S3.SS2.p1.17.m3.1.1.1.1" xref="S3.SS2.p1.17.m3.1.1.1.1.cmml">j</mi><mo id="S3.SS2.p1.17.m3.2.2.2.4.1" xref="S3.SS2.p1.17.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p1.17.m3.2.2.2.2" xref="S3.SS2.p1.17.m3.2.2.2.2.cmml">k</mi></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.17.m3.2b"><apply id="S3.SS2.p1.17.m3.2.3.cmml" xref="S3.SS2.p1.17.m3.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.17.m3.2.3.1.cmml" xref="S3.SS2.p1.17.m3.2.3">superscript</csymbol><apply id="S3.SS2.p1.17.m3.2.3.2.cmml" xref="S3.SS2.p1.17.m3.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.17.m3.2.3.2.1.cmml" xref="S3.SS2.p1.17.m3.2.3">subscript</csymbol><ci id="S3.SS2.p1.17.m3.2.3.2.2.cmml" xref="S3.SS2.p1.17.m3.2.3.2.2">𝐞</ci><ci id="S3.SS2.p1.17.m3.2.3.2.3.cmml" xref="S3.SS2.p1.17.m3.2.3.2.3">𝐦</ci></apply><list id="S3.SS2.p1.17.m3.2.2.2.3.cmml" xref="S3.SS2.p1.17.m3.2.2.2.4"><ci id="S3.SS2.p1.17.m3.1.1.1.1.cmml" xref="S3.SS2.p1.17.m3.1.1.1.1">𝑗</ci><ci id="S3.SS2.p1.17.m3.2.2.2.2.cmml" xref="S3.SS2.p1.17.m3.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.17.m3.2c">\mathbf{e_{m}}^{j,k}</annotation></semantics></math> and the residual weights <math id="S3.SS2.p1.18.m4.1" class="ltx_Math" alttext="\mathbf{W_{m}}^{k}" display="inline"><semantics id="S3.SS2.p1.18.m4.1a"><mmultiscripts id="S3.SS2.p1.18.m4.1.1" xref="S3.SS2.p1.18.m4.1.1.cmml"><mi id="S3.SS2.p1.18.m4.1.1.2.2" xref="S3.SS2.p1.18.m4.1.1.2.2.cmml">𝐖</mi><mi id="S3.SS2.p1.18.m4.1.1.2.3" xref="S3.SS2.p1.18.m4.1.1.2.3.cmml">𝐦</mi><mrow id="S3.SS2.p1.18.m4.1.1a" xref="S3.SS2.p1.18.m4.1.1.cmml"></mrow><mrow id="S3.SS2.p1.18.m4.1.1b" xref="S3.SS2.p1.18.m4.1.1.cmml"></mrow><mi id="S3.SS2.p1.18.m4.1.1.3" xref="S3.SS2.p1.18.m4.1.1.3.cmml">k</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.18.m4.1b"><apply id="S3.SS2.p1.18.m4.1.1.cmml" xref="S3.SS2.p1.18.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.18.m4.1.1.1.cmml" xref="S3.SS2.p1.18.m4.1.1">superscript</csymbol><apply id="S3.SS2.p1.18.m4.1.1.2.cmml" xref="S3.SS2.p1.18.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.18.m4.1.1.2.1.cmml" xref="S3.SS2.p1.18.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.18.m4.1.1.2.2.cmml" xref="S3.SS2.p1.18.m4.1.1.2.2">𝐖</ci><ci id="S3.SS2.p1.18.m4.1.1.2.3.cmml" xref="S3.SS2.p1.18.m4.1.1.2.3">𝐦</ci></apply><ci id="S3.SS2.p1.18.m4.1.1.3.cmml" xref="S3.SS2.p1.18.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.18.m4.1c">\mathbf{W_{m}}^{k}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.5.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.6.2" class="ltx_text ltx_font_italic">IMU Preintegration</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.3" class="ltx_p">In this section, we review the IMU preintegration formulation, which in turn will be used to derive the magnetometer residuals in  Section  <a href="#S3.SS4" title="III-D Magnetometer Residuals ‣ III Visual-Inertial-Magnetometer Fusion ‣ Enhancing Visual Inertial SLAM with Magnetic Measurements" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-D</span></span></a>. The IMU preintegration formulation is based on  <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">qin2017vins_mono</span>]</cite> inspired by continuous-time quaternion kinematics from  <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">quatenrion_sola</span>]</cite> and uses IMU bias manipulation according to  <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">forster2016manifold</span>]</cite>.
The accelerometer and gyroscope measurements in body frame B at time <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">t</annotation></semantics></math> are affected by the additive white noise <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="\boldsymbol{\eta}" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">𝜼</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝜼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\boldsymbol{\eta}</annotation></semantics></math> and slowing varying bias <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{b}" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">𝐛</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝐛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">\mathbf{b}</annotation></semantics></math></p>
<table id="S3.E4" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E4X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle{}_{\text{B}}\tilde{\boldsymbol{w}}(t)" display="inline"><semantics id="S3.E4X.2.1.1.m1.1a"><mrow id="S3.E4X.2.1.1.m1.1.2" xref="S3.E4X.2.1.1.m1.1.2.cmml"><mmultiscripts id="S3.E4X.2.1.1.m1.1.2.2" xref="S3.E4X.2.1.1.m1.1.2.2.cmml"><mover accent="true" id="S3.E4X.2.1.1.m1.1.2.2.2" xref="S3.E4X.2.1.1.m1.1.2.2.2.cmml"><mi id="S3.E4X.2.1.1.m1.1.2.2.2.2" xref="S3.E4X.2.1.1.m1.1.2.2.2.2.cmml">𝒘</mi><mo id="S3.E4X.2.1.1.m1.1.2.2.2.1" xref="S3.E4X.2.1.1.m1.1.2.2.2.1.cmml">~</mo></mover><mprescripts id="S3.E4X.2.1.1.m1.1.2.2a" xref="S3.E4X.2.1.1.m1.1.2.2.cmml"></mprescripts><mtext id="S3.E4X.2.1.1.m1.1.2.2.3" xref="S3.E4X.2.1.1.m1.1.2.2.3a.cmml">B</mtext><mrow id="S3.E4X.2.1.1.m1.1.2.2b" xref="S3.E4X.2.1.1.m1.1.2.2.cmml"></mrow></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.E4X.2.1.1.m1.1.2.1" xref="S3.E4X.2.1.1.m1.1.2.1.cmml">​</mo><mrow id="S3.E4X.2.1.1.m1.1.2.3.2" xref="S3.E4X.2.1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.E4X.2.1.1.m1.1.2.3.2.1" xref="S3.E4X.2.1.1.m1.1.2.cmml">(</mo><mi id="S3.E4X.2.1.1.m1.1.1" xref="S3.E4X.2.1.1.m1.1.1.cmml">t</mi><mo stretchy="false" id="S3.E4X.2.1.1.m1.1.2.3.2.2" xref="S3.E4X.2.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4X.2.1.1.m1.1b"><apply id="S3.E4X.2.1.1.m1.1.2.cmml" xref="S3.E4X.2.1.1.m1.1.2"><times id="S3.E4X.2.1.1.m1.1.2.1.cmml" xref="S3.E4X.2.1.1.m1.1.2.1"></times><apply id="S3.E4X.2.1.1.m1.1.2.2.cmml" xref="S3.E4X.2.1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.1.2.2.1.cmml" xref="S3.E4X.2.1.1.m1.1.2.2">subscript</csymbol><apply id="S3.E4X.2.1.1.m1.1.2.2.2.cmml" xref="S3.E4X.2.1.1.m1.1.2.2.2"><ci id="S3.E4X.2.1.1.m1.1.2.2.2.1.cmml" xref="S3.E4X.2.1.1.m1.1.2.2.2.1">~</ci><ci id="S3.E4X.2.1.1.m1.1.2.2.2.2.cmml" xref="S3.E4X.2.1.1.m1.1.2.2.2.2">𝒘</ci></apply><ci id="S3.E4X.2.1.1.m1.1.2.2.3a.cmml" xref="S3.E4X.2.1.1.m1.1.2.2.3"><mtext mathsize="70%" id="S3.E4X.2.1.1.m1.1.2.2.3.cmml" xref="S3.E4X.2.1.1.m1.1.2.2.3">B</mtext></ci></apply><ci id="S3.E4X.2.1.1.m1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4X.2.1.1.m1.1c">\displaystyle{}_{\text{B}}\tilde{\boldsymbol{w}}(t)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E4X.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle={}_{\text{B}}\boldsymbol{w}(t)+\mathbf{b}_{g}(t)+\boldsymbol{\eta}_{g}" display="inline"><semantics id="S3.E4X.3.2.2.m1.2a"><mrow id="S3.E4X.3.2.2.m1.2.3" xref="S3.E4X.3.2.2.m1.2.3.cmml"><mi id="S3.E4X.3.2.2.m1.2.3.2" xref="S3.E4X.3.2.2.m1.2.3.2.cmml"></mi><mo id="S3.E4X.3.2.2.m1.2.3.1" xref="S3.E4X.3.2.2.m1.2.3.1.cmml">=</mo><mrow id="S3.E4X.3.2.2.m1.2.3.3" xref="S3.E4X.3.2.2.m1.2.3.3.cmml"><mrow id="S3.E4X.3.2.2.m1.2.3.3.2" xref="S3.E4X.3.2.2.m1.2.3.3.2.cmml"><mmultiscripts id="S3.E4X.3.2.2.m1.2.3.3.2.2" xref="S3.E4X.3.2.2.m1.2.3.3.2.2.cmml"><mi id="S3.E4X.3.2.2.m1.2.3.3.2.2.2" xref="S3.E4X.3.2.2.m1.2.3.3.2.2.2.cmml">𝒘</mi><mprescripts id="S3.E4X.3.2.2.m1.2.3.3.2.2a" xref="S3.E4X.3.2.2.m1.2.3.3.2.2.cmml"></mprescripts><mtext id="S3.E4X.3.2.2.m1.2.3.3.2.2.3" xref="S3.E4X.3.2.2.m1.2.3.3.2.2.3a.cmml">B</mtext><mrow id="S3.E4X.3.2.2.m1.2.3.3.2.2b" xref="S3.E4X.3.2.2.m1.2.3.3.2.2.cmml"></mrow></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.E4X.3.2.2.m1.2.3.3.2.1" xref="S3.E4X.3.2.2.m1.2.3.3.2.1.cmml">​</mo><mrow id="S3.E4X.3.2.2.m1.2.3.3.2.3.2" xref="S3.E4X.3.2.2.m1.2.3.3.2.cmml"><mo stretchy="false" id="S3.E4X.3.2.2.m1.2.3.3.2.3.2.1" xref="S3.E4X.3.2.2.m1.2.3.3.2.cmml">(</mo><mi id="S3.E4X.3.2.2.m1.1.1" xref="S3.E4X.3.2.2.m1.1.1.cmml">t</mi><mo stretchy="false" id="S3.E4X.3.2.2.m1.2.3.3.2.3.2.2" xref="S3.E4X.3.2.2.m1.2.3.3.2.cmml">)</mo></mrow></mrow><mo id="S3.E4X.3.2.2.m1.2.3.3.1" xref="S3.E4X.3.2.2.m1.2.3.3.1.cmml">+</mo><mrow id="S3.E4X.3.2.2.m1.2.3.3.3" xref="S3.E4X.3.2.2.m1.2.3.3.3.cmml"><msub id="S3.E4X.3.2.2.m1.2.3.3.3.2" xref="S3.E4X.3.2.2.m1.2.3.3.3.2.cmml"><mi id="S3.E4X.3.2.2.m1.2.3.3.3.2.2" xref="S3.E4X.3.2.2.m1.2.3.3.3.2.2.cmml">𝐛</mi><mi id="S3.E4X.3.2.2.m1.2.3.3.3.2.3" xref="S3.E4X.3.2.2.m1.2.3.3.3.2.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4X.3.2.2.m1.2.3.3.3.1" xref="S3.E4X.3.2.2.m1.2.3.3.3.1.cmml">​</mo><mrow id="S3.E4X.3.2.2.m1.2.3.3.3.3.2" xref="S3.E4X.3.2.2.m1.2.3.3.3.cmml"><mo stretchy="false" id="S3.E4X.3.2.2.m1.2.3.3.3.3.2.1" xref="S3.E4X.3.2.2.m1.2.3.3.3.cmml">(</mo><mi id="S3.E4X.3.2.2.m1.2.2" xref="S3.E4X.3.2.2.m1.2.2.cmml">t</mi><mo stretchy="false" id="S3.E4X.3.2.2.m1.2.3.3.3.3.2.2" xref="S3.E4X.3.2.2.m1.2.3.3.3.cmml">)</mo></mrow></mrow><mo id="S3.E4X.3.2.2.m1.2.3.3.1a" xref="S3.E4X.3.2.2.m1.2.3.3.1.cmml">+</mo><msub id="S3.E4X.3.2.2.m1.2.3.3.4" xref="S3.E4X.3.2.2.m1.2.3.3.4.cmml"><mi id="S3.E4X.3.2.2.m1.2.3.3.4.2" xref="S3.E4X.3.2.2.m1.2.3.3.4.2.cmml">𝜼</mi><mi id="S3.E4X.3.2.2.m1.2.3.3.4.3" xref="S3.E4X.3.2.2.m1.2.3.3.4.3.cmml">g</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4X.3.2.2.m1.2b"><apply id="S3.E4X.3.2.2.m1.2.3.cmml" xref="S3.E4X.3.2.2.m1.2.3"><eq id="S3.E4X.3.2.2.m1.2.3.1.cmml" xref="S3.E4X.3.2.2.m1.2.3.1"></eq><csymbol cd="latexml" id="S3.E4X.3.2.2.m1.2.3.2.cmml" xref="S3.E4X.3.2.2.m1.2.3.2">absent</csymbol><apply id="S3.E4X.3.2.2.m1.2.3.3.cmml" xref="S3.E4X.3.2.2.m1.2.3.3"><plus id="S3.E4X.3.2.2.m1.2.3.3.1.cmml" xref="S3.E4X.3.2.2.m1.2.3.3.1"></plus><apply id="S3.E4X.3.2.2.m1.2.3.3.2.cmml" xref="S3.E4X.3.2.2.m1.2.3.3.2"><times id="S3.E4X.3.2.2.m1.2.3.3.2.1.cmml" xref="S3.E4X.3.2.2.m1.2.3.3.2.1"></times><apply id="S3.E4X.3.2.2.m1.2.3.3.2.2.cmml" xref="S3.E4X.3.2.2.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.2.3.3.2.2.1.cmml" xref="S3.E4X.3.2.2.m1.2.3.3.2.2">subscript</csymbol><ci id="S3.E4X.3.2.2.m1.2.3.3.2.2.2.cmml" xref="S3.E4X.3.2.2.m1.2.3.3.2.2.2">𝒘</ci><ci id="S3.E4X.3.2.2.m1.2.3.3.2.2.3a.cmml" xref="S3.E4X.3.2.2.m1.2.3.3.2.2.3"><mtext mathsize="70%" id="S3.E4X.3.2.2.m1.2.3.3.2.2.3.cmml" xref="S3.E4X.3.2.2.m1.2.3.3.2.2.3">B</mtext></ci></apply><ci id="S3.E4X.3.2.2.m1.1.1.cmml" xref="S3.E4X.3.2.2.m1.1.1">𝑡</ci></apply><apply id="S3.E4X.3.2.2.m1.2.3.3.3.cmml" xref="S3.E4X.3.2.2.m1.2.3.3.3"><times id="S3.E4X.3.2.2.m1.2.3.3.3.1.cmml" xref="S3.E4X.3.2.2.m1.2.3.3.3.1"></times><apply id="S3.E4X.3.2.2.m1.2.3.3.3.2.cmml" xref="S3.E4X.3.2.2.m1.2.3.3.3.2"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.2.3.3.3.2.1.cmml" xref="S3.E4X.3.2.2.m1.2.3.3.3.2">subscript</csymbol><ci id="S3.E4X.3.2.2.m1.2.3.3.3.2.2.cmml" xref="S3.E4X.3.2.2.m1.2.3.3.3.2.2">𝐛</ci><ci id="S3.E4X.3.2.2.m1.2.3.3.3.2.3.cmml" xref="S3.E4X.3.2.2.m1.2.3.3.3.2.3">𝑔</ci></apply><ci id="S3.E4X.3.2.2.m1.2.2.cmml" xref="S3.E4X.3.2.2.m1.2.2">𝑡</ci></apply><apply id="S3.E4X.3.2.2.m1.2.3.3.4.cmml" xref="S3.E4X.3.2.2.m1.2.3.3.4"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.2.3.3.4.1.cmml" xref="S3.E4X.3.2.2.m1.2.3.3.4">subscript</csymbol><ci id="S3.E4X.3.2.2.m1.2.3.3.4.2.cmml" xref="S3.E4X.3.2.2.m1.2.3.3.4.2">𝜼</ci><ci id="S3.E4X.3.2.2.m1.2.3.3.4.3.cmml" xref="S3.E4X.3.2.2.m1.2.3.3.4.3">𝑔</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4X.3.2.2.m1.2c">\displaystyle={}_{\text{B}}\boldsymbol{w}(t)+\mathbf{b}_{g}(t)+\boldsymbol{\eta}_{g}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
<tr id="S3.E4Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle{}_{\text{B}}\tilde{\mathbf{a}}(t)" display="inline"><semantics id="S3.E4Xa.2.1.1.m1.1a"><mrow id="S3.E4Xa.2.1.1.m1.1.2" xref="S3.E4Xa.2.1.1.m1.1.2.cmml"><mmultiscripts id="S3.E4Xa.2.1.1.m1.1.2.2" xref="S3.E4Xa.2.1.1.m1.1.2.2.cmml"><mover accent="true" id="S3.E4Xa.2.1.1.m1.1.2.2.2" xref="S3.E4Xa.2.1.1.m1.1.2.2.2.cmml"><mi id="S3.E4Xa.2.1.1.m1.1.2.2.2.2" xref="S3.E4Xa.2.1.1.m1.1.2.2.2.2.cmml">𝐚</mi><mo id="S3.E4Xa.2.1.1.m1.1.2.2.2.1" xref="S3.E4Xa.2.1.1.m1.1.2.2.2.1.cmml">~</mo></mover><mprescripts id="S3.E4Xa.2.1.1.m1.1.2.2a" xref="S3.E4Xa.2.1.1.m1.1.2.2.cmml"></mprescripts><mtext id="S3.E4Xa.2.1.1.m1.1.2.2.3" xref="S3.E4Xa.2.1.1.m1.1.2.2.3a.cmml">B</mtext><mrow id="S3.E4Xa.2.1.1.m1.1.2.2b" xref="S3.E4Xa.2.1.1.m1.1.2.2.cmml"></mrow></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.E4Xa.2.1.1.m1.1.2.1" xref="S3.E4Xa.2.1.1.m1.1.2.1.cmml">​</mo><mrow id="S3.E4Xa.2.1.1.m1.1.2.3.2" xref="S3.E4Xa.2.1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.E4Xa.2.1.1.m1.1.2.3.2.1" xref="S3.E4Xa.2.1.1.m1.1.2.cmml">(</mo><mi id="S3.E4Xa.2.1.1.m1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.cmml">t</mi><mo stretchy="false" id="S3.E4Xa.2.1.1.m1.1.2.3.2.2" xref="S3.E4Xa.2.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4Xa.2.1.1.m1.1b"><apply id="S3.E4Xa.2.1.1.m1.1.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.2"><times id="S3.E4Xa.2.1.1.m1.1.2.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.2.1"></times><apply id="S3.E4Xa.2.1.1.m1.1.2.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E4Xa.2.1.1.m1.1.2.2.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.2.2">subscript</csymbol><apply id="S3.E4Xa.2.1.1.m1.1.2.2.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.2.2.2"><ci id="S3.E4Xa.2.1.1.m1.1.2.2.2.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.2.2.2.1">~</ci><ci id="S3.E4Xa.2.1.1.m1.1.2.2.2.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.2.2.2.2">𝐚</ci></apply><ci id="S3.E4Xa.2.1.1.m1.1.2.2.3a.cmml" xref="S3.E4Xa.2.1.1.m1.1.2.2.3"><mtext mathsize="70%" id="S3.E4Xa.2.1.1.m1.1.2.2.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.2.2.3">B</mtext></ci></apply><ci id="S3.E4Xa.2.1.1.m1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4Xa.2.1.1.m1.1c">\displaystyle{}_{\text{B}}\tilde{\mathbf{a}}(t)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E4Xa.3.2.2.m1.3" class="ltx_Math" alttext="\displaystyle=\text{R}_{\text{WB}}^{\text{T}}({}_{\text{W}}\mathbf{a}(t)-{}_{\text{W}}\mathbf{g})+\mathbf{b}_{a}(t)+\boldsymbol{\eta}_{a}" display="inline"><semantics id="S3.E4Xa.3.2.2.m1.3a"><mrow id="S3.E4Xa.3.2.2.m1.3.3" xref="S3.E4Xa.3.2.2.m1.3.3.cmml"><mi id="S3.E4Xa.3.2.2.m1.3.3.3" xref="S3.E4Xa.3.2.2.m1.3.3.3.cmml"></mi><mo id="S3.E4Xa.3.2.2.m1.3.3.2" xref="S3.E4Xa.3.2.2.m1.3.3.2.cmml">=</mo><mrow id="S3.E4Xa.3.2.2.m1.3.3.1" xref="S3.E4Xa.3.2.2.m1.3.3.1.cmml"><mrow id="S3.E4Xa.3.2.2.m1.3.3.1.1" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.cmml"><msubsup id="S3.E4Xa.3.2.2.m1.3.3.1.1.3" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3.cmml"><mtext id="S3.E4Xa.3.2.2.m1.3.3.1.1.3.2.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3.2.2a.cmml">R</mtext><mtext id="S3.E4Xa.3.2.2.m1.3.3.1.1.3.2.3" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3.2.3a.cmml">WB</mtext><mtext id="S3.E4Xa.3.2.2.m1.3.3.1.1.3.3" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3.3a.cmml">T</mtext></msubsup><mo lspace="0em" rspace="0em" id="S3.E4Xa.3.2.2.m1.3.3.1.1.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.2.cmml">​</mo><mrow id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.cmml"><mrow id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.cmml"><mmultiscripts id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.2.cmml"><mi id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.2.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.2.2.cmml">𝐚</mi><mprescripts id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.2a" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.2.cmml"></mprescripts><mtext id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.2.3" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.2.3a.cmml">W</mtext><mrow id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.2b" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.2.cmml"></mrow></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.1" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.1.cmml">​</mo><mrow id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.3.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.3.2.1" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E4Xa.3.2.2.m1.1.1" xref="S3.E4Xa.3.2.2.m1.1.1.cmml">t</mi><mo stretchy="false" id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.3.2.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.1" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.1.cmml">−</mo><mmultiscripts id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.3" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.3.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.3.2.cmml">𝐠</mi><mprescripts id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.3a" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.3.cmml"></mprescripts><mtext id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.3.3" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.3.3a.cmml">W</mtext><mrow id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.3b" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.3.cmml"></mrow></mmultiscripts></mrow><mo stretchy="false" id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.3" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4Xa.3.2.2.m1.3.3.1.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.2.cmml">+</mo><mrow id="S3.E4Xa.3.2.2.m1.3.3.1.3" xref="S3.E4Xa.3.2.2.m1.3.3.1.3.cmml"><msub id="S3.E4Xa.3.2.2.m1.3.3.1.3.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.3.2.cmml"><mi id="S3.E4Xa.3.2.2.m1.3.3.1.3.2.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.3.2.2.cmml">𝐛</mi><mi id="S3.E4Xa.3.2.2.m1.3.3.1.3.2.3" xref="S3.E4Xa.3.2.2.m1.3.3.1.3.2.3.cmml">a</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4Xa.3.2.2.m1.3.3.1.3.1" xref="S3.E4Xa.3.2.2.m1.3.3.1.3.1.cmml">​</mo><mrow id="S3.E4Xa.3.2.2.m1.3.3.1.3.3.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.3.cmml"><mo stretchy="false" id="S3.E4Xa.3.2.2.m1.3.3.1.3.3.2.1" xref="S3.E4Xa.3.2.2.m1.3.3.1.3.cmml">(</mo><mi id="S3.E4Xa.3.2.2.m1.2.2" xref="S3.E4Xa.3.2.2.m1.2.2.cmml">t</mi><mo stretchy="false" id="S3.E4Xa.3.2.2.m1.3.3.1.3.3.2.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E4Xa.3.2.2.m1.3.3.1.2a" xref="S3.E4Xa.3.2.2.m1.3.3.1.2.cmml">+</mo><msub id="S3.E4Xa.3.2.2.m1.3.3.1.4" xref="S3.E4Xa.3.2.2.m1.3.3.1.4.cmml"><mi id="S3.E4Xa.3.2.2.m1.3.3.1.4.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.4.2.cmml">𝜼</mi><mi id="S3.E4Xa.3.2.2.m1.3.3.1.4.3" xref="S3.E4Xa.3.2.2.m1.3.3.1.4.3.cmml">a</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4Xa.3.2.2.m1.3b"><apply id="S3.E4Xa.3.2.2.m1.3.3.cmml" xref="S3.E4Xa.3.2.2.m1.3.3"><eq id="S3.E4Xa.3.2.2.m1.3.3.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.2"></eq><csymbol cd="latexml" id="S3.E4Xa.3.2.2.m1.3.3.3.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.3">absent</csymbol><apply id="S3.E4Xa.3.2.2.m1.3.3.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1"><plus id="S3.E4Xa.3.2.2.m1.3.3.1.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.2"></plus><apply id="S3.E4Xa.3.2.2.m1.3.3.1.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1"><times id="S3.E4Xa.3.2.2.m1.3.3.1.1.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.2"></times><apply id="S3.E4Xa.3.2.2.m1.3.3.1.1.3.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E4Xa.3.2.2.m1.3.3.1.1.3.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3">superscript</csymbol><apply id="S3.E4Xa.3.2.2.m1.3.3.1.1.3.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E4Xa.3.2.2.m1.3.3.1.1.3.2.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.3.2.2a.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3.2.2"><mtext id="S3.E4Xa.3.2.2.m1.3.3.1.1.3.2.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3.2.2">R</mtext></ci><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.3.2.3a.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3.2.3"><mtext mathsize="70%" id="S3.E4Xa.3.2.2.m1.3.3.1.1.3.2.3.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3.2.3">WB</mtext></ci></apply><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.3.3a.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3.3"><mtext mathsize="70%" id="S3.E4Xa.3.2.2.m1.3.3.1.1.3.3.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3.3">T</mtext></ci></apply><apply id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1"><minus id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.1"></minus><apply id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2"><times id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.1"></times><apply id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.2.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.2.2">𝐚</ci><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.2.3a.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.2.3"><mtext mathsize="70%" id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.2.3.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.2.2.3">W</mtext></ci></apply><ci id="S3.E4Xa.3.2.2.m1.1.1.cmml" xref="S3.E4Xa.3.2.2.m1.1.1">𝑡</ci></apply><apply id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.3.2">𝐠</ci><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.3.3a.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.3.3"><mtext mathsize="70%" id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.3.3">W</mtext></ci></apply></apply></apply><apply id="S3.E4Xa.3.2.2.m1.3.3.1.3.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.3"><times id="S3.E4Xa.3.2.2.m1.3.3.1.3.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.3.1"></times><apply id="S3.E4Xa.3.2.2.m1.3.3.1.3.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.3.2"><csymbol cd="ambiguous" id="S3.E4Xa.3.2.2.m1.3.3.1.3.2.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.3.2">subscript</csymbol><ci id="S3.E4Xa.3.2.2.m1.3.3.1.3.2.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.3.2.2">𝐛</ci><ci id="S3.E4Xa.3.2.2.m1.3.3.1.3.2.3.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.3.2.3">𝑎</ci></apply><ci id="S3.E4Xa.3.2.2.m1.2.2.cmml" xref="S3.E4Xa.3.2.2.m1.2.2">𝑡</ci></apply><apply id="S3.E4Xa.3.2.2.m1.3.3.1.4.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.4"><csymbol cd="ambiguous" id="S3.E4Xa.3.2.2.m1.3.3.1.4.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.4">subscript</csymbol><ci id="S3.E4Xa.3.2.2.m1.3.3.1.4.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.4.2">𝜼</ci><ci id="S3.E4Xa.3.2.2.m1.3.3.1.4.3.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.4.3">𝑎</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4Xa.3.2.2.m1.3c">\displaystyle=\text{R}_{\text{WB}}^{\text{T}}({}_{\text{W}}\mathbf{a}(t)-{}_{\text{W}}\mathbf{g})+\mathbf{b}_{a}(t)+\boldsymbol{\eta}_{a}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS3.p1.15" class="ltx_p">The accelerometer and gyroscope noise is modeled as additive Gaussian noise with <math id="S3.SS3.p1.4.m1.2" class="ltx_Math" alttext="\boldsymbol{\eta}_{a}\sim\pazocal{N}(\mathbf{0},\sigma_{a}^{2}\cdot\mathbf{I})" display="inline"><semantics id="S3.SS3.p1.4.m1.2a"><mrow id="S3.SS3.p1.4.m1.2.2" xref="S3.SS3.p1.4.m1.2.2.cmml"><msub id="S3.SS3.p1.4.m1.2.2.3" xref="S3.SS3.p1.4.m1.2.2.3.cmml"><mi id="S3.SS3.p1.4.m1.2.2.3.2" xref="S3.SS3.p1.4.m1.2.2.3.2.cmml">𝜼</mi><mi id="S3.SS3.p1.4.m1.2.2.3.3" xref="S3.SS3.p1.4.m1.2.2.3.3.cmml">a</mi></msub><mo id="S3.SS3.p1.4.m1.2.2.2" xref="S3.SS3.p1.4.m1.2.2.2.cmml">∼</mo><mrow id="S3.SS3.p1.4.m1.2.2.1" xref="S3.SS3.p1.4.m1.2.2.1.cmml"><mi mathvariant="normal" id="S3.SS3.p1.4.m1.2.2.1.3" xref="S3.SS3.p1.4.m1.2.2.1.3.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.4.m1.2.2.1.2" xref="S3.SS3.p1.4.m1.2.2.1.2.cmml">​</mo><mrow id="S3.SS3.p1.4.m1.2.2.1.1.1" xref="S3.SS3.p1.4.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.4.m1.2.2.1.1.1.2" xref="S3.SS3.p1.4.m1.2.2.1.1.2.cmml">(</mo><mn id="S3.SS3.p1.4.m1.1.1" xref="S3.SS3.p1.4.m1.1.1.cmml">𝟎</mn><mo id="S3.SS3.p1.4.m1.2.2.1.1.1.3" xref="S3.SS3.p1.4.m1.2.2.1.1.2.cmml">,</mo><mrow id="S3.SS3.p1.4.m1.2.2.1.1.1.1" xref="S3.SS3.p1.4.m1.2.2.1.1.1.1.cmml"><msubsup id="S3.SS3.p1.4.m1.2.2.1.1.1.1.2" xref="S3.SS3.p1.4.m1.2.2.1.1.1.1.2.cmml"><mi id="S3.SS3.p1.4.m1.2.2.1.1.1.1.2.2.2" xref="S3.SS3.p1.4.m1.2.2.1.1.1.1.2.2.2.cmml">σ</mi><mi mathvariant="normal" id="S3.SS3.p1.4.m1.2.2.1.1.1.1.2.2.3" xref="S3.SS3.p1.4.m1.2.2.1.1.1.1.2.2.3.cmml">a</mi><mn id="S3.SS3.p1.4.m1.2.2.1.1.1.1.2.3" xref="S3.SS3.p1.4.m1.2.2.1.1.1.1.2.3.cmml">2</mn></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.4.m1.2.2.1.1.1.1.1" xref="S3.SS3.p1.4.m1.2.2.1.1.1.1.1.cmml">⋅</mo><mi id="S3.SS3.p1.4.m1.2.2.1.1.1.1.3" xref="S3.SS3.p1.4.m1.2.2.1.1.1.1.3.cmml">𝐈</mi></mrow><mo stretchy="false" id="S3.SS3.p1.4.m1.2.2.1.1.1.4" xref="S3.SS3.p1.4.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m1.2b"><apply id="S3.SS3.p1.4.m1.2.2.cmml" xref="S3.SS3.p1.4.m1.2.2"><csymbol cd="latexml" id="S3.SS3.p1.4.m1.2.2.2.cmml" xref="S3.SS3.p1.4.m1.2.2.2">similar-to</csymbol><apply id="S3.SS3.p1.4.m1.2.2.3.cmml" xref="S3.SS3.p1.4.m1.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m1.2.2.3.1.cmml" xref="S3.SS3.p1.4.m1.2.2.3">subscript</csymbol><ci id="S3.SS3.p1.4.m1.2.2.3.2.cmml" xref="S3.SS3.p1.4.m1.2.2.3.2">𝜼</ci><ci id="S3.SS3.p1.4.m1.2.2.3.3.cmml" xref="S3.SS3.p1.4.m1.2.2.3.3">𝑎</ci></apply><apply id="S3.SS3.p1.4.m1.2.2.1.cmml" xref="S3.SS3.p1.4.m1.2.2.1"><times id="S3.SS3.p1.4.m1.2.2.1.2.cmml" xref="S3.SS3.p1.4.m1.2.2.1.2"></times><ci id="S3.SS3.p1.4.m1.2.2.1.3.cmml" xref="S3.SS3.p1.4.m1.2.2.1.3">N</ci><interval closure="open" id="S3.SS3.p1.4.m1.2.2.1.1.2.cmml" xref="S3.SS3.p1.4.m1.2.2.1.1.1"><cn type="integer" id="S3.SS3.p1.4.m1.1.1.cmml" xref="S3.SS3.p1.4.m1.1.1">0</cn><apply id="S3.SS3.p1.4.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.4.m1.2.2.1.1.1.1"><ci id="S3.SS3.p1.4.m1.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p1.4.m1.2.2.1.1.1.1.1">⋅</ci><apply id="S3.SS3.p1.4.m1.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p1.4.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.SS3.p1.4.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S3.SS3.p1.4.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.SS3.p1.4.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p1.4.m1.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.4.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p1.4.m1.2.2.1.1.1.1.2.2.2">𝜎</ci><ci id="S3.SS3.p1.4.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S3.SS3.p1.4.m1.2.2.1.1.1.1.2.2.3">a</ci></apply><cn type="integer" id="S3.SS3.p1.4.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.SS3.p1.4.m1.2.2.1.1.1.1.2.3">2</cn></apply><ci id="S3.SS3.p1.4.m1.2.2.1.1.1.1.3.cmml" xref="S3.SS3.p1.4.m1.2.2.1.1.1.1.3">𝐈</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m1.2c">\boldsymbol{\eta}_{a}\sim\pazocal{N}(\mathbf{0},\sigma_{a}^{2}\cdot\mathbf{I})</annotation></semantics></math> and <math id="S3.SS3.p1.5.m2.2" class="ltx_Math" alttext="\boldsymbol{\eta}_{w}\sim\pazocal{N}(\mathbf{0},\sigma_{w}^{2}\cdot\mathbf{I})" display="inline"><semantics id="S3.SS3.p1.5.m2.2a"><mrow id="S3.SS3.p1.5.m2.2.2" xref="S3.SS3.p1.5.m2.2.2.cmml"><msub id="S3.SS3.p1.5.m2.2.2.3" xref="S3.SS3.p1.5.m2.2.2.3.cmml"><mi id="S3.SS3.p1.5.m2.2.2.3.2" xref="S3.SS3.p1.5.m2.2.2.3.2.cmml">𝜼</mi><mi id="S3.SS3.p1.5.m2.2.2.3.3" xref="S3.SS3.p1.5.m2.2.2.3.3.cmml">w</mi></msub><mo id="S3.SS3.p1.5.m2.2.2.2" xref="S3.SS3.p1.5.m2.2.2.2.cmml">∼</mo><mrow id="S3.SS3.p1.5.m2.2.2.1" xref="S3.SS3.p1.5.m2.2.2.1.cmml"><mi mathvariant="normal" id="S3.SS3.p1.5.m2.2.2.1.3" xref="S3.SS3.p1.5.m2.2.2.1.3.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.5.m2.2.2.1.2" xref="S3.SS3.p1.5.m2.2.2.1.2.cmml">​</mo><mrow id="S3.SS3.p1.5.m2.2.2.1.1.1" xref="S3.SS3.p1.5.m2.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.5.m2.2.2.1.1.1.2" xref="S3.SS3.p1.5.m2.2.2.1.1.2.cmml">(</mo><mn id="S3.SS3.p1.5.m2.1.1" xref="S3.SS3.p1.5.m2.1.1.cmml">𝟎</mn><mo id="S3.SS3.p1.5.m2.2.2.1.1.1.3" xref="S3.SS3.p1.5.m2.2.2.1.1.2.cmml">,</mo><mrow id="S3.SS3.p1.5.m2.2.2.1.1.1.1" xref="S3.SS3.p1.5.m2.2.2.1.1.1.1.cmml"><msubsup id="S3.SS3.p1.5.m2.2.2.1.1.1.1.2" xref="S3.SS3.p1.5.m2.2.2.1.1.1.1.2.cmml"><mi id="S3.SS3.p1.5.m2.2.2.1.1.1.1.2.2.2" xref="S3.SS3.p1.5.m2.2.2.1.1.1.1.2.2.2.cmml">σ</mi><mi mathvariant="normal" id="S3.SS3.p1.5.m2.2.2.1.1.1.1.2.2.3" xref="S3.SS3.p1.5.m2.2.2.1.1.1.1.2.2.3.cmml">w</mi><mn id="S3.SS3.p1.5.m2.2.2.1.1.1.1.2.3" xref="S3.SS3.p1.5.m2.2.2.1.1.1.1.2.3.cmml">2</mn></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.5.m2.2.2.1.1.1.1.1" xref="S3.SS3.p1.5.m2.2.2.1.1.1.1.1.cmml">⋅</mo><mi id="S3.SS3.p1.5.m2.2.2.1.1.1.1.3" xref="S3.SS3.p1.5.m2.2.2.1.1.1.1.3.cmml">𝐈</mi></mrow><mo stretchy="false" id="S3.SS3.p1.5.m2.2.2.1.1.1.4" xref="S3.SS3.p1.5.m2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m2.2b"><apply id="S3.SS3.p1.5.m2.2.2.cmml" xref="S3.SS3.p1.5.m2.2.2"><csymbol cd="latexml" id="S3.SS3.p1.5.m2.2.2.2.cmml" xref="S3.SS3.p1.5.m2.2.2.2">similar-to</csymbol><apply id="S3.SS3.p1.5.m2.2.2.3.cmml" xref="S3.SS3.p1.5.m2.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m2.2.2.3.1.cmml" xref="S3.SS3.p1.5.m2.2.2.3">subscript</csymbol><ci id="S3.SS3.p1.5.m2.2.2.3.2.cmml" xref="S3.SS3.p1.5.m2.2.2.3.2">𝜼</ci><ci id="S3.SS3.p1.5.m2.2.2.3.3.cmml" xref="S3.SS3.p1.5.m2.2.2.3.3">𝑤</ci></apply><apply id="S3.SS3.p1.5.m2.2.2.1.cmml" xref="S3.SS3.p1.5.m2.2.2.1"><times id="S3.SS3.p1.5.m2.2.2.1.2.cmml" xref="S3.SS3.p1.5.m2.2.2.1.2"></times><ci id="S3.SS3.p1.5.m2.2.2.1.3.cmml" xref="S3.SS3.p1.5.m2.2.2.1.3">N</ci><interval closure="open" id="S3.SS3.p1.5.m2.2.2.1.1.2.cmml" xref="S3.SS3.p1.5.m2.2.2.1.1.1"><cn type="integer" id="S3.SS3.p1.5.m2.1.1.cmml" xref="S3.SS3.p1.5.m2.1.1">0</cn><apply id="S3.SS3.p1.5.m2.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.5.m2.2.2.1.1.1.1"><ci id="S3.SS3.p1.5.m2.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p1.5.m2.2.2.1.1.1.1.1">⋅</ci><apply id="S3.SS3.p1.5.m2.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p1.5.m2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m2.2.2.1.1.1.1.2.1.cmml" xref="S3.SS3.p1.5.m2.2.2.1.1.1.1.2">superscript</csymbol><apply id="S3.SS3.p1.5.m2.2.2.1.1.1.1.2.2.cmml" xref="S3.SS3.p1.5.m2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m2.2.2.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p1.5.m2.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.5.m2.2.2.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p1.5.m2.2.2.1.1.1.1.2.2.2">𝜎</ci><ci id="S3.SS3.p1.5.m2.2.2.1.1.1.1.2.2.3.cmml" xref="S3.SS3.p1.5.m2.2.2.1.1.1.1.2.2.3">w</ci></apply><cn type="integer" id="S3.SS3.p1.5.m2.2.2.1.1.1.1.2.3.cmml" xref="S3.SS3.p1.5.m2.2.2.1.1.1.1.2.3">2</cn></apply><ci id="S3.SS3.p1.5.m2.2.2.1.1.1.1.3.cmml" xref="S3.SS3.p1.5.m2.2.2.1.1.1.1.3">𝐈</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m2.2c">\boldsymbol{\eta}_{w}\sim\pazocal{N}(\mathbf{0},\sigma_{w}^{2}\cdot\mathbf{I})</annotation></semantics></math>, where <math id="S3.SS3.p1.6.m3.1" class="ltx_Math" alttext="\mathbf{I}" display="inline"><semantics id="S3.SS3.p1.6.m3.1a"><mi id="S3.SS3.p1.6.m3.1.1" xref="S3.SS3.p1.6.m3.1.1.cmml">𝐈</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m3.1b"><ci id="S3.SS3.p1.6.m3.1.1.cmml" xref="S3.SS3.p1.6.m3.1.1">𝐈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m3.1c">\mathbf{I}</annotation></semantics></math> being the identity matrix. IMU biases are modeled as a slowly varying random walk with <math id="S3.SS3.p1.7.m4.1" class="ltx_Math" alttext="\dot{\mathbf{b}}_{w_{t}}=\boldsymbol{\eta}_{b_{w}}" display="inline"><semantics id="S3.SS3.p1.7.m4.1a"><mrow id="S3.SS3.p1.7.m4.1.1" xref="S3.SS3.p1.7.m4.1.1.cmml"><msub id="S3.SS3.p1.7.m4.1.1.2" xref="S3.SS3.p1.7.m4.1.1.2.cmml"><mover accent="true" id="S3.SS3.p1.7.m4.1.1.2.2" xref="S3.SS3.p1.7.m4.1.1.2.2.cmml"><mi id="S3.SS3.p1.7.m4.1.1.2.2.2" xref="S3.SS3.p1.7.m4.1.1.2.2.2.cmml">𝐛</mi><mo id="S3.SS3.p1.7.m4.1.1.2.2.1" xref="S3.SS3.p1.7.m4.1.1.2.2.1.cmml">˙</mo></mover><msub id="S3.SS3.p1.7.m4.1.1.2.3" xref="S3.SS3.p1.7.m4.1.1.2.3.cmml"><mi id="S3.SS3.p1.7.m4.1.1.2.3.2" xref="S3.SS3.p1.7.m4.1.1.2.3.2.cmml">w</mi><mi id="S3.SS3.p1.7.m4.1.1.2.3.3" xref="S3.SS3.p1.7.m4.1.1.2.3.3.cmml">t</mi></msub></msub><mo id="S3.SS3.p1.7.m4.1.1.1" xref="S3.SS3.p1.7.m4.1.1.1.cmml">=</mo><msub id="S3.SS3.p1.7.m4.1.1.3" xref="S3.SS3.p1.7.m4.1.1.3.cmml"><mi id="S3.SS3.p1.7.m4.1.1.3.2" xref="S3.SS3.p1.7.m4.1.1.3.2.cmml">𝜼</mi><msub id="S3.SS3.p1.7.m4.1.1.3.3" xref="S3.SS3.p1.7.m4.1.1.3.3.cmml"><mi id="S3.SS3.p1.7.m4.1.1.3.3.2" xref="S3.SS3.p1.7.m4.1.1.3.3.2.cmml">b</mi><mi id="S3.SS3.p1.7.m4.1.1.3.3.3" xref="S3.SS3.p1.7.m4.1.1.3.3.3.cmml">w</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m4.1b"><apply id="S3.SS3.p1.7.m4.1.1.cmml" xref="S3.SS3.p1.7.m4.1.1"><eq id="S3.SS3.p1.7.m4.1.1.1.cmml" xref="S3.SS3.p1.7.m4.1.1.1"></eq><apply id="S3.SS3.p1.7.m4.1.1.2.cmml" xref="S3.SS3.p1.7.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m4.1.1.2.1.cmml" xref="S3.SS3.p1.7.m4.1.1.2">subscript</csymbol><apply id="S3.SS3.p1.7.m4.1.1.2.2.cmml" xref="S3.SS3.p1.7.m4.1.1.2.2"><ci id="S3.SS3.p1.7.m4.1.1.2.2.1.cmml" xref="S3.SS3.p1.7.m4.1.1.2.2.1">˙</ci><ci id="S3.SS3.p1.7.m4.1.1.2.2.2.cmml" xref="S3.SS3.p1.7.m4.1.1.2.2.2">𝐛</ci></apply><apply id="S3.SS3.p1.7.m4.1.1.2.3.cmml" xref="S3.SS3.p1.7.m4.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m4.1.1.2.3.1.cmml" xref="S3.SS3.p1.7.m4.1.1.2.3">subscript</csymbol><ci id="S3.SS3.p1.7.m4.1.1.2.3.2.cmml" xref="S3.SS3.p1.7.m4.1.1.2.3.2">𝑤</ci><ci id="S3.SS3.p1.7.m4.1.1.2.3.3.cmml" xref="S3.SS3.p1.7.m4.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S3.SS3.p1.7.m4.1.1.3.cmml" xref="S3.SS3.p1.7.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m4.1.1.3.1.cmml" xref="S3.SS3.p1.7.m4.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.7.m4.1.1.3.2.cmml" xref="S3.SS3.p1.7.m4.1.1.3.2">𝜼</ci><apply id="S3.SS3.p1.7.m4.1.1.3.3.cmml" xref="S3.SS3.p1.7.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m4.1.1.3.3.1.cmml" xref="S3.SS3.p1.7.m4.1.1.3.3">subscript</csymbol><ci id="S3.SS3.p1.7.m4.1.1.3.3.2.cmml" xref="S3.SS3.p1.7.m4.1.1.3.3.2">𝑏</ci><ci id="S3.SS3.p1.7.m4.1.1.3.3.3.cmml" xref="S3.SS3.p1.7.m4.1.1.3.3.3">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m4.1c">\dot{\mathbf{b}}_{w_{t}}=\boldsymbol{\eta}_{b_{w}}</annotation></semantics></math> and <math id="S3.SS3.p1.8.m5.1" class="ltx_Math" alttext="\dot{\mathbf{b}}_{a_{t}}=\boldsymbol{\eta}_{b_{a}}" display="inline"><semantics id="S3.SS3.p1.8.m5.1a"><mrow id="S3.SS3.p1.8.m5.1.1" xref="S3.SS3.p1.8.m5.1.1.cmml"><msub id="S3.SS3.p1.8.m5.1.1.2" xref="S3.SS3.p1.8.m5.1.1.2.cmml"><mover accent="true" id="S3.SS3.p1.8.m5.1.1.2.2" xref="S3.SS3.p1.8.m5.1.1.2.2.cmml"><mi id="S3.SS3.p1.8.m5.1.1.2.2.2" xref="S3.SS3.p1.8.m5.1.1.2.2.2.cmml">𝐛</mi><mo id="S3.SS3.p1.8.m5.1.1.2.2.1" xref="S3.SS3.p1.8.m5.1.1.2.2.1.cmml">˙</mo></mover><msub id="S3.SS3.p1.8.m5.1.1.2.3" xref="S3.SS3.p1.8.m5.1.1.2.3.cmml"><mi id="S3.SS3.p1.8.m5.1.1.2.3.2" xref="S3.SS3.p1.8.m5.1.1.2.3.2.cmml">a</mi><mi id="S3.SS3.p1.8.m5.1.1.2.3.3" xref="S3.SS3.p1.8.m5.1.1.2.3.3.cmml">t</mi></msub></msub><mo id="S3.SS3.p1.8.m5.1.1.1" xref="S3.SS3.p1.8.m5.1.1.1.cmml">=</mo><msub id="S3.SS3.p1.8.m5.1.1.3" xref="S3.SS3.p1.8.m5.1.1.3.cmml"><mi id="S3.SS3.p1.8.m5.1.1.3.2" xref="S3.SS3.p1.8.m5.1.1.3.2.cmml">𝜼</mi><msub id="S3.SS3.p1.8.m5.1.1.3.3" xref="S3.SS3.p1.8.m5.1.1.3.3.cmml"><mi id="S3.SS3.p1.8.m5.1.1.3.3.2" xref="S3.SS3.p1.8.m5.1.1.3.3.2.cmml">b</mi><mi id="S3.SS3.p1.8.m5.1.1.3.3.3" xref="S3.SS3.p1.8.m5.1.1.3.3.3.cmml">a</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m5.1b"><apply id="S3.SS3.p1.8.m5.1.1.cmml" xref="S3.SS3.p1.8.m5.1.1"><eq id="S3.SS3.p1.8.m5.1.1.1.cmml" xref="S3.SS3.p1.8.m5.1.1.1"></eq><apply id="S3.SS3.p1.8.m5.1.1.2.cmml" xref="S3.SS3.p1.8.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m5.1.1.2.1.cmml" xref="S3.SS3.p1.8.m5.1.1.2">subscript</csymbol><apply id="S3.SS3.p1.8.m5.1.1.2.2.cmml" xref="S3.SS3.p1.8.m5.1.1.2.2"><ci id="S3.SS3.p1.8.m5.1.1.2.2.1.cmml" xref="S3.SS3.p1.8.m5.1.1.2.2.1">˙</ci><ci id="S3.SS3.p1.8.m5.1.1.2.2.2.cmml" xref="S3.SS3.p1.8.m5.1.1.2.2.2">𝐛</ci></apply><apply id="S3.SS3.p1.8.m5.1.1.2.3.cmml" xref="S3.SS3.p1.8.m5.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m5.1.1.2.3.1.cmml" xref="S3.SS3.p1.8.m5.1.1.2.3">subscript</csymbol><ci id="S3.SS3.p1.8.m5.1.1.2.3.2.cmml" xref="S3.SS3.p1.8.m5.1.1.2.3.2">𝑎</ci><ci id="S3.SS3.p1.8.m5.1.1.2.3.3.cmml" xref="S3.SS3.p1.8.m5.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S3.SS3.p1.8.m5.1.1.3.cmml" xref="S3.SS3.p1.8.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m5.1.1.3.1.cmml" xref="S3.SS3.p1.8.m5.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.8.m5.1.1.3.2.cmml" xref="S3.SS3.p1.8.m5.1.1.3.2">𝜼</ci><apply id="S3.SS3.p1.8.m5.1.1.3.3.cmml" xref="S3.SS3.p1.8.m5.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m5.1.1.3.3.1.cmml" xref="S3.SS3.p1.8.m5.1.1.3.3">subscript</csymbol><ci id="S3.SS3.p1.8.m5.1.1.3.3.2.cmml" xref="S3.SS3.p1.8.m5.1.1.3.3.2">𝑏</ci><ci id="S3.SS3.p1.8.m5.1.1.3.3.3.cmml" xref="S3.SS3.p1.8.m5.1.1.3.3.3">𝑎</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m5.1c">\dot{\mathbf{b}}_{a_{t}}=\boldsymbol{\eta}_{b_{a}}</annotation></semantics></math> where <math id="S3.SS3.p1.9.m6.2" class="ltx_Math" alttext="\boldsymbol{\eta}_{b_{w}}\sim\pazocal{N}(\mathbf{0},\sigma_{b_{w}}^{2}\cdot\mathbf{I})" display="inline"><semantics id="S3.SS3.p1.9.m6.2a"><mrow id="S3.SS3.p1.9.m6.2.2" xref="S3.SS3.p1.9.m6.2.2.cmml"><msub id="S3.SS3.p1.9.m6.2.2.3" xref="S3.SS3.p1.9.m6.2.2.3.cmml"><mi id="S3.SS3.p1.9.m6.2.2.3.2" xref="S3.SS3.p1.9.m6.2.2.3.2.cmml">𝜼</mi><msub id="S3.SS3.p1.9.m6.2.2.3.3" xref="S3.SS3.p1.9.m6.2.2.3.3.cmml"><mi id="S3.SS3.p1.9.m6.2.2.3.3.2" xref="S3.SS3.p1.9.m6.2.2.3.3.2.cmml">b</mi><mi id="S3.SS3.p1.9.m6.2.2.3.3.3" xref="S3.SS3.p1.9.m6.2.2.3.3.3.cmml">w</mi></msub></msub><mo id="S3.SS3.p1.9.m6.2.2.2" xref="S3.SS3.p1.9.m6.2.2.2.cmml">∼</mo><mrow id="S3.SS3.p1.9.m6.2.2.1" xref="S3.SS3.p1.9.m6.2.2.1.cmml"><mi mathvariant="normal" id="S3.SS3.p1.9.m6.2.2.1.3" xref="S3.SS3.p1.9.m6.2.2.1.3.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.9.m6.2.2.1.2" xref="S3.SS3.p1.9.m6.2.2.1.2.cmml">​</mo><mrow id="S3.SS3.p1.9.m6.2.2.1.1.1" xref="S3.SS3.p1.9.m6.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.9.m6.2.2.1.1.1.2" xref="S3.SS3.p1.9.m6.2.2.1.1.2.cmml">(</mo><mn id="S3.SS3.p1.9.m6.1.1" xref="S3.SS3.p1.9.m6.1.1.cmml">𝟎</mn><mo id="S3.SS3.p1.9.m6.2.2.1.1.1.3" xref="S3.SS3.p1.9.m6.2.2.1.1.2.cmml">,</mo><mrow id="S3.SS3.p1.9.m6.2.2.1.1.1.1" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.cmml"><msubsup id="S3.SS3.p1.9.m6.2.2.1.1.1.1.2" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.cmml"><mi id="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.2.2" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.2.2.cmml">σ</mi><msub id="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.2.3" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.2.3.cmml"><mi mathvariant="normal" id="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.2.3.2" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.2.3.2.cmml">b</mi><mi mathvariant="normal" id="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.2.3.3" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.2.3.3.cmml">w</mi></msub><mn id="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.3" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.3.cmml">2</mn></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.9.m6.2.2.1.1.1.1.1" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.1.cmml">⋅</mo><mi id="S3.SS3.p1.9.m6.2.2.1.1.1.1.3" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.3.cmml">𝐈</mi></mrow><mo stretchy="false" id="S3.SS3.p1.9.m6.2.2.1.1.1.4" xref="S3.SS3.p1.9.m6.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m6.2b"><apply id="S3.SS3.p1.9.m6.2.2.cmml" xref="S3.SS3.p1.9.m6.2.2"><csymbol cd="latexml" id="S3.SS3.p1.9.m6.2.2.2.cmml" xref="S3.SS3.p1.9.m6.2.2.2">similar-to</csymbol><apply id="S3.SS3.p1.9.m6.2.2.3.cmml" xref="S3.SS3.p1.9.m6.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m6.2.2.3.1.cmml" xref="S3.SS3.p1.9.m6.2.2.3">subscript</csymbol><ci id="S3.SS3.p1.9.m6.2.2.3.2.cmml" xref="S3.SS3.p1.9.m6.2.2.3.2">𝜼</ci><apply id="S3.SS3.p1.9.m6.2.2.3.3.cmml" xref="S3.SS3.p1.9.m6.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m6.2.2.3.3.1.cmml" xref="S3.SS3.p1.9.m6.2.2.3.3">subscript</csymbol><ci id="S3.SS3.p1.9.m6.2.2.3.3.2.cmml" xref="S3.SS3.p1.9.m6.2.2.3.3.2">𝑏</ci><ci id="S3.SS3.p1.9.m6.2.2.3.3.3.cmml" xref="S3.SS3.p1.9.m6.2.2.3.3.3">𝑤</ci></apply></apply><apply id="S3.SS3.p1.9.m6.2.2.1.cmml" xref="S3.SS3.p1.9.m6.2.2.1"><times id="S3.SS3.p1.9.m6.2.2.1.2.cmml" xref="S3.SS3.p1.9.m6.2.2.1.2"></times><ci id="S3.SS3.p1.9.m6.2.2.1.3.cmml" xref="S3.SS3.p1.9.m6.2.2.1.3">N</ci><interval closure="open" id="S3.SS3.p1.9.m6.2.2.1.1.2.cmml" xref="S3.SS3.p1.9.m6.2.2.1.1.1"><cn type="integer" id="S3.SS3.p1.9.m6.1.1.cmml" xref="S3.SS3.p1.9.m6.1.1">0</cn><apply id="S3.SS3.p1.9.m6.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1"><ci id="S3.SS3.p1.9.m6.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.1">⋅</ci><apply id="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.1.cmml" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.2">superscript</csymbol><apply id="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.2.cmml" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.2.2">𝜎</ci><apply id="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.2.3.cmml" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.2.3.1.cmml" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.2.3">subscript</csymbol><ci id="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.2.3.2.cmml" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.2.3.2">b</ci><ci id="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.2.3.3.cmml" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.2.3.3">w</ci></apply></apply><cn type="integer" id="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.3.cmml" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.2.3">2</cn></apply><ci id="S3.SS3.p1.9.m6.2.2.1.1.1.1.3.cmml" xref="S3.SS3.p1.9.m6.2.2.1.1.1.1.3">𝐈</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m6.2c">\boldsymbol{\eta}_{b_{w}}\sim\pazocal{N}(\mathbf{0},\sigma_{b_{w}}^{2}\cdot\mathbf{I})</annotation></semantics></math> and <math id="S3.SS3.p1.10.m7.2" class="ltx_Math" alttext="\boldsymbol{\eta}_{b_{a}}\sim\pazocal{N}(\mathbf{0},\sigma_{b_{a}}^{2}\cdot\mathbf{I})" display="inline"><semantics id="S3.SS3.p1.10.m7.2a"><mrow id="S3.SS3.p1.10.m7.2.2" xref="S3.SS3.p1.10.m7.2.2.cmml"><msub id="S3.SS3.p1.10.m7.2.2.3" xref="S3.SS3.p1.10.m7.2.2.3.cmml"><mi id="S3.SS3.p1.10.m7.2.2.3.2" xref="S3.SS3.p1.10.m7.2.2.3.2.cmml">𝜼</mi><msub id="S3.SS3.p1.10.m7.2.2.3.3" xref="S3.SS3.p1.10.m7.2.2.3.3.cmml"><mi id="S3.SS3.p1.10.m7.2.2.3.3.2" xref="S3.SS3.p1.10.m7.2.2.3.3.2.cmml">b</mi><mi id="S3.SS3.p1.10.m7.2.2.3.3.3" xref="S3.SS3.p1.10.m7.2.2.3.3.3.cmml">a</mi></msub></msub><mo id="S3.SS3.p1.10.m7.2.2.2" xref="S3.SS3.p1.10.m7.2.2.2.cmml">∼</mo><mrow id="S3.SS3.p1.10.m7.2.2.1" xref="S3.SS3.p1.10.m7.2.2.1.cmml"><mi mathvariant="normal" id="S3.SS3.p1.10.m7.2.2.1.3" xref="S3.SS3.p1.10.m7.2.2.1.3.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.10.m7.2.2.1.2" xref="S3.SS3.p1.10.m7.2.2.1.2.cmml">​</mo><mrow id="S3.SS3.p1.10.m7.2.2.1.1.1" xref="S3.SS3.p1.10.m7.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.10.m7.2.2.1.1.1.2" xref="S3.SS3.p1.10.m7.2.2.1.1.2.cmml">(</mo><mn id="S3.SS3.p1.10.m7.1.1" xref="S3.SS3.p1.10.m7.1.1.cmml">𝟎</mn><mo id="S3.SS3.p1.10.m7.2.2.1.1.1.3" xref="S3.SS3.p1.10.m7.2.2.1.1.2.cmml">,</mo><mrow id="S3.SS3.p1.10.m7.2.2.1.1.1.1" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.cmml"><msubsup id="S3.SS3.p1.10.m7.2.2.1.1.1.1.2" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.cmml"><mi id="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.2.2" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.2.2.cmml">σ</mi><msub id="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.2.3" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.2.3.cmml"><mi mathvariant="normal" id="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.2.3.2" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.2.3.2.cmml">b</mi><mi mathvariant="normal" id="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.2.3.3" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.2.3.3.cmml">a</mi></msub><mn id="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.3" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.3.cmml">2</mn></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.10.m7.2.2.1.1.1.1.1" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.1.cmml">⋅</mo><mi id="S3.SS3.p1.10.m7.2.2.1.1.1.1.3" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.3.cmml">𝐈</mi></mrow><mo stretchy="false" id="S3.SS3.p1.10.m7.2.2.1.1.1.4" xref="S3.SS3.p1.10.m7.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m7.2b"><apply id="S3.SS3.p1.10.m7.2.2.cmml" xref="S3.SS3.p1.10.m7.2.2"><csymbol cd="latexml" id="S3.SS3.p1.10.m7.2.2.2.cmml" xref="S3.SS3.p1.10.m7.2.2.2">similar-to</csymbol><apply id="S3.SS3.p1.10.m7.2.2.3.cmml" xref="S3.SS3.p1.10.m7.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m7.2.2.3.1.cmml" xref="S3.SS3.p1.10.m7.2.2.3">subscript</csymbol><ci id="S3.SS3.p1.10.m7.2.2.3.2.cmml" xref="S3.SS3.p1.10.m7.2.2.3.2">𝜼</ci><apply id="S3.SS3.p1.10.m7.2.2.3.3.cmml" xref="S3.SS3.p1.10.m7.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m7.2.2.3.3.1.cmml" xref="S3.SS3.p1.10.m7.2.2.3.3">subscript</csymbol><ci id="S3.SS3.p1.10.m7.2.2.3.3.2.cmml" xref="S3.SS3.p1.10.m7.2.2.3.3.2">𝑏</ci><ci id="S3.SS3.p1.10.m7.2.2.3.3.3.cmml" xref="S3.SS3.p1.10.m7.2.2.3.3.3">𝑎</ci></apply></apply><apply id="S3.SS3.p1.10.m7.2.2.1.cmml" xref="S3.SS3.p1.10.m7.2.2.1"><times id="S3.SS3.p1.10.m7.2.2.1.2.cmml" xref="S3.SS3.p1.10.m7.2.2.1.2"></times><ci id="S3.SS3.p1.10.m7.2.2.1.3.cmml" xref="S3.SS3.p1.10.m7.2.2.1.3">N</ci><interval closure="open" id="S3.SS3.p1.10.m7.2.2.1.1.2.cmml" xref="S3.SS3.p1.10.m7.2.2.1.1.1"><cn type="integer" id="S3.SS3.p1.10.m7.1.1.cmml" xref="S3.SS3.p1.10.m7.1.1">0</cn><apply id="S3.SS3.p1.10.m7.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1"><ci id="S3.SS3.p1.10.m7.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.1">⋅</ci><apply id="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.1.cmml" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.2">superscript</csymbol><apply id="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.2.cmml" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.2.2">𝜎</ci><apply id="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.2.3.cmml" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.2.3.1.cmml" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.2.3">subscript</csymbol><ci id="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.2.3.2.cmml" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.2.3.2">b</ci><ci id="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.2.3.3.cmml" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.2.3.3">a</ci></apply></apply><cn type="integer" id="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.3.cmml" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.2.3">2</cn></apply><ci id="S3.SS3.p1.10.m7.2.2.1.1.1.1.3.cmml" xref="S3.SS3.p1.10.m7.2.2.1.1.1.1.3">𝐈</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m7.2c">\boldsymbol{\eta}_{b_{a}}\sim\pazocal{N}(\mathbf{0},\sigma_{b_{a}}^{2}\cdot\mathbf{I})</annotation></semantics></math>. Most modern 9-axis IMUs provide high-frequency synchronized accelerometer, gyroscope, and magnetometer measurements, as shown in Fig. <a href="#S3.F3" title="Figure 3 ‣ III-D Magnetometer Residuals ‣ III Visual-Inertial-Magnetometer Fusion ‣ Enhancing Visual Inertial SLAM with Magnetic Measurements" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. As such, <math id="S3.SS3.p1.11.m8.2" class="ltx_Math" alttext="{}_{\text{W}}\mathbf{p}^{i},\mathbf{q}_{\text{WB}}^{i}" display="inline"><semantics id="S3.SS3.p1.11.m8.2a"><mrow id="S3.SS3.p1.11.m8.2.2.2" xref="S3.SS3.p1.11.m8.2.2.3.cmml"><mmultiscripts id="S3.SS3.p1.11.m8.1.1.1.1" xref="S3.SS3.p1.11.m8.1.1.1.1.cmml"><mi id="S3.SS3.p1.11.m8.1.1.1.1.2.2" xref="S3.SS3.p1.11.m8.1.1.1.1.2.2.cmml">𝐩</mi><mrow id="S3.SS3.p1.11.m8.1.1.1.1a" xref="S3.SS3.p1.11.m8.1.1.1.1.cmml"></mrow><mi id="S3.SS3.p1.11.m8.1.1.1.1.2.3" xref="S3.SS3.p1.11.m8.1.1.1.1.2.3.cmml">i</mi><mprescripts id="S3.SS3.p1.11.m8.1.1.1.1b" xref="S3.SS3.p1.11.m8.1.1.1.1.cmml"></mprescripts><mtext id="S3.SS3.p1.11.m8.1.1.1.1.3" xref="S3.SS3.p1.11.m8.1.1.1.1.3a.cmml">W</mtext><mrow id="S3.SS3.p1.11.m8.1.1.1.1c" xref="S3.SS3.p1.11.m8.1.1.1.1.cmml"></mrow></mmultiscripts><mo id="S3.SS3.p1.11.m8.2.2.2.3" xref="S3.SS3.p1.11.m8.2.2.3.cmml">,</mo><msubsup id="S3.SS3.p1.11.m8.2.2.2.2" xref="S3.SS3.p1.11.m8.2.2.2.2.cmml"><mi id="S3.SS3.p1.11.m8.2.2.2.2.2.2" xref="S3.SS3.p1.11.m8.2.2.2.2.2.2.cmml">𝐪</mi><mtext id="S3.SS3.p1.11.m8.2.2.2.2.2.3" xref="S3.SS3.p1.11.m8.2.2.2.2.2.3a.cmml">WB</mtext><mi id="S3.SS3.p1.11.m8.2.2.2.2.3" xref="S3.SS3.p1.11.m8.2.2.2.2.3.cmml">i</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m8.2b"><list id="S3.SS3.p1.11.m8.2.2.3.cmml" xref="S3.SS3.p1.11.m8.2.2.2"><apply id="S3.SS3.p1.11.m8.1.1.1.1.cmml" xref="S3.SS3.p1.11.m8.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.11.m8.1.1.1.1.1.cmml" xref="S3.SS3.p1.11.m8.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p1.11.m8.1.1.1.1.2.cmml" xref="S3.SS3.p1.11.m8.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.11.m8.1.1.1.1.2.1.cmml" xref="S3.SS3.p1.11.m8.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p1.11.m8.1.1.1.1.2.2.cmml" xref="S3.SS3.p1.11.m8.1.1.1.1.2.2">𝐩</ci><ci id="S3.SS3.p1.11.m8.1.1.1.1.2.3.cmml" xref="S3.SS3.p1.11.m8.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS3.p1.11.m8.1.1.1.1.3a.cmml" xref="S3.SS3.p1.11.m8.1.1.1.1.3"><mtext mathsize="70%" id="S3.SS3.p1.11.m8.1.1.1.1.3.cmml" xref="S3.SS3.p1.11.m8.1.1.1.1.3">W</mtext></ci></apply><apply id="S3.SS3.p1.11.m8.2.2.2.2.cmml" xref="S3.SS3.p1.11.m8.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.11.m8.2.2.2.2.1.cmml" xref="S3.SS3.p1.11.m8.2.2.2.2">superscript</csymbol><apply id="S3.SS3.p1.11.m8.2.2.2.2.2.cmml" xref="S3.SS3.p1.11.m8.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.11.m8.2.2.2.2.2.1.cmml" xref="S3.SS3.p1.11.m8.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.11.m8.2.2.2.2.2.2.cmml" xref="S3.SS3.p1.11.m8.2.2.2.2.2.2">𝐪</ci><ci id="S3.SS3.p1.11.m8.2.2.2.2.2.3a.cmml" xref="S3.SS3.p1.11.m8.2.2.2.2.2.3"><mtext mathsize="70%" id="S3.SS3.p1.11.m8.2.2.2.2.2.3.cmml" xref="S3.SS3.p1.11.m8.2.2.2.2.2.3">WB</mtext></ci></apply><ci id="S3.SS3.p1.11.m8.2.2.2.2.3.cmml" xref="S3.SS3.p1.11.m8.2.2.2.2.3">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m8.2c">{}_{\text{W}}\mathbf{p}^{i},\mathbf{q}_{\text{WB}}^{i}</annotation></semantics></math> and <math id="S3.SS3.p1.12.m9.1" class="ltx_Math" alttext="{}_{\text{W}}\mathbf{v}^{i}" display="inline"><semantics id="S3.SS3.p1.12.m9.1a"><mmultiscripts id="S3.SS3.p1.12.m9.1.1" xref="S3.SS3.p1.12.m9.1.1.cmml"><mi id="S3.SS3.p1.12.m9.1.1.2.2" xref="S3.SS3.p1.12.m9.1.1.2.2.cmml">𝐯</mi><mrow id="S3.SS3.p1.12.m9.1.1a" xref="S3.SS3.p1.12.m9.1.1.cmml"></mrow><mi id="S3.SS3.p1.12.m9.1.1.2.3" xref="S3.SS3.p1.12.m9.1.1.2.3.cmml">i</mi><mprescripts id="S3.SS3.p1.12.m9.1.1b" xref="S3.SS3.p1.12.m9.1.1.cmml"></mprescripts><mtext id="S3.SS3.p1.12.m9.1.1.3" xref="S3.SS3.p1.12.m9.1.1.3a.cmml">W</mtext><mrow id="S3.SS3.p1.12.m9.1.1c" xref="S3.SS3.p1.12.m9.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.12.m9.1b"><apply id="S3.SS3.p1.12.m9.1.1.cmml" xref="S3.SS3.p1.12.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.12.m9.1.1.1.cmml" xref="S3.SS3.p1.12.m9.1.1">subscript</csymbol><apply id="S3.SS3.p1.12.m9.1.1.2.cmml" xref="S3.SS3.p1.12.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.12.m9.1.1.2.1.cmml" xref="S3.SS3.p1.12.m9.1.1">superscript</csymbol><ci id="S3.SS3.p1.12.m9.1.1.2.2.cmml" xref="S3.SS3.p1.12.m9.1.1.2.2">𝐯</ci><ci id="S3.SS3.p1.12.m9.1.1.2.3.cmml" xref="S3.SS3.p1.12.m9.1.1.2.3">𝑖</ci></apply><ci id="S3.SS3.p1.12.m9.1.1.3a.cmml" xref="S3.SS3.p1.12.m9.1.1.3"><mtext mathsize="70%" id="S3.SS3.p1.12.m9.1.1.3.cmml" xref="S3.SS3.p1.12.m9.1.1.3">W</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.12.m9.1c">{}_{\text{W}}\mathbf{v}^{i}</annotation></semantics></math> can be propagated in the time interval <math id="S3.SS3.p1.13.m10.2" class="ltx_Math" alttext="[t_{k},t_{k+1}]" display="inline"><semantics id="S3.SS3.p1.13.m10.2a"><mrow id="S3.SS3.p1.13.m10.2.2.2" xref="S3.SS3.p1.13.m10.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.p1.13.m10.2.2.2.3" xref="S3.SS3.p1.13.m10.2.2.3.cmml">[</mo><msub id="S3.SS3.p1.13.m10.1.1.1.1" xref="S3.SS3.p1.13.m10.1.1.1.1.cmml"><mi id="S3.SS3.p1.13.m10.1.1.1.1.2" xref="S3.SS3.p1.13.m10.1.1.1.1.2.cmml">t</mi><mi id="S3.SS3.p1.13.m10.1.1.1.1.3" xref="S3.SS3.p1.13.m10.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS3.p1.13.m10.2.2.2.4" xref="S3.SS3.p1.13.m10.2.2.3.cmml">,</mo><msub id="S3.SS3.p1.13.m10.2.2.2.2" xref="S3.SS3.p1.13.m10.2.2.2.2.cmml"><mi id="S3.SS3.p1.13.m10.2.2.2.2.2" xref="S3.SS3.p1.13.m10.2.2.2.2.2.cmml">t</mi><mrow id="S3.SS3.p1.13.m10.2.2.2.2.3" xref="S3.SS3.p1.13.m10.2.2.2.2.3.cmml"><mi id="S3.SS3.p1.13.m10.2.2.2.2.3.2" xref="S3.SS3.p1.13.m10.2.2.2.2.3.2.cmml">k</mi><mo id="S3.SS3.p1.13.m10.2.2.2.2.3.1" xref="S3.SS3.p1.13.m10.2.2.2.2.3.1.cmml">+</mo><mn id="S3.SS3.p1.13.m10.2.2.2.2.3.3" xref="S3.SS3.p1.13.m10.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.SS3.p1.13.m10.2.2.2.5" xref="S3.SS3.p1.13.m10.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.13.m10.2b"><interval closure="closed" id="S3.SS3.p1.13.m10.2.2.3.cmml" xref="S3.SS3.p1.13.m10.2.2.2"><apply id="S3.SS3.p1.13.m10.1.1.1.1.cmml" xref="S3.SS3.p1.13.m10.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.13.m10.1.1.1.1.1.cmml" xref="S3.SS3.p1.13.m10.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.13.m10.1.1.1.1.2.cmml" xref="S3.SS3.p1.13.m10.1.1.1.1.2">𝑡</ci><ci id="S3.SS3.p1.13.m10.1.1.1.1.3.cmml" xref="S3.SS3.p1.13.m10.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS3.p1.13.m10.2.2.2.2.cmml" xref="S3.SS3.p1.13.m10.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.13.m10.2.2.2.2.1.cmml" xref="S3.SS3.p1.13.m10.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.13.m10.2.2.2.2.2.cmml" xref="S3.SS3.p1.13.m10.2.2.2.2.2">𝑡</ci><apply id="S3.SS3.p1.13.m10.2.2.2.2.3.cmml" xref="S3.SS3.p1.13.m10.2.2.2.2.3"><plus id="S3.SS3.p1.13.m10.2.2.2.2.3.1.cmml" xref="S3.SS3.p1.13.m10.2.2.2.2.3.1"></plus><ci id="S3.SS3.p1.13.m10.2.2.2.2.3.2.cmml" xref="S3.SS3.p1.13.m10.2.2.2.2.3.2">𝑘</ci><cn type="integer" id="S3.SS3.p1.13.m10.2.2.2.2.3.3.cmml" xref="S3.SS3.p1.13.m10.2.2.2.2.3.3">1</cn></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.13.m10.2c">[t_{k},t_{k+1}]</annotation></semantics></math> using accelerometer and gyroscope measurements. Although in practice IMU measurements may not perfectly synchronize with image timestamps, the sensor setup is calibrated using Kalibr <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">kalibr</span>]</cite> beforehand. Propagation in the world frame requires knowledge of the initial state of the system at time <math id="S3.SS3.p1.14.m11.1" class="ltx_Math" alttext="t_{k}" display="inline"><semantics id="S3.SS3.p1.14.m11.1a"><msub id="S3.SS3.p1.14.m11.1.1" xref="S3.SS3.p1.14.m11.1.1.cmml"><mi id="S3.SS3.p1.14.m11.1.1.2" xref="S3.SS3.p1.14.m11.1.1.2.cmml">t</mi><mi id="S3.SS3.p1.14.m11.1.1.3" xref="S3.SS3.p1.14.m11.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.14.m11.1b"><apply id="S3.SS3.p1.14.m11.1.1.cmml" xref="S3.SS3.p1.14.m11.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m11.1.1.1.cmml" xref="S3.SS3.p1.14.m11.1.1">subscript</csymbol><ci id="S3.SS3.p1.14.m11.1.1.2.cmml" xref="S3.SS3.p1.14.m11.1.1.2">𝑡</ci><ci id="S3.SS3.p1.14.m11.1.1.3.cmml" xref="S3.SS3.p1.14.m11.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.14.m11.1c">t_{k}</annotation></semantics></math>. Whenever the system state changes during optimization, repropagation is needed. Thus, the IMU preintegration is performed in the body frame to avoid repropagation whenever system state is updated during optimization for computational efficiency.
The propagation is performed in body frame <math id="S3.SS3.p1.15.m12.1" class="ltx_Math" alttext="\text{B}_{k}" display="inline"><semantics id="S3.SS3.p1.15.m12.1a"><msub id="S3.SS3.p1.15.m12.1.1" xref="S3.SS3.p1.15.m12.1.1.cmml"><mtext id="S3.SS3.p1.15.m12.1.1.2" xref="S3.SS3.p1.15.m12.1.1.2a.cmml">B</mtext><mi id="S3.SS3.p1.15.m12.1.1.3" xref="S3.SS3.p1.15.m12.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.15.m12.1b"><apply id="S3.SS3.p1.15.m12.1.1.cmml" xref="S3.SS3.p1.15.m12.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.15.m12.1.1.1.cmml" xref="S3.SS3.p1.15.m12.1.1">subscript</csymbol><ci id="S3.SS3.p1.15.m12.1.1.2a.cmml" xref="S3.SS3.p1.15.m12.1.1.2"><mtext id="S3.SS3.p1.15.m12.1.1.2.cmml" xref="S3.SS3.p1.15.m12.1.1.2">B</mtext></ci><ci id="S3.SS3.p1.15.m12.1.1.3.cmml" xref="S3.SS3.p1.15.m12.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.15.m12.1c">\text{B}_{k}</annotation></semantics></math> instead of the world frame as</p>
<table id="S3.E5" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E5X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\text{R}_{\text{BW}}^{k}\ {}_{\text{W}}\mathbf{p}^{k+1}" display="inline"><semantics id="S3.E5X.2.1.1.m1.1a"><mrow id="S3.E5X.2.1.1.m1.1.1" xref="S3.E5X.2.1.1.m1.1.1.cmml"><msubsup id="S3.E5X.2.1.1.m1.1.1.2" xref="S3.E5X.2.1.1.m1.1.1.2.cmml"><mtext id="S3.E5X.2.1.1.m1.1.1.2.2.2" xref="S3.E5X.2.1.1.m1.1.1.2.2.2a.cmml">R</mtext><mtext id="S3.E5X.2.1.1.m1.1.1.2.2.3" xref="S3.E5X.2.1.1.m1.1.1.2.2.3a.cmml">BW</mtext><mi id="S3.E5X.2.1.1.m1.1.1.2.3" xref="S3.E5X.2.1.1.m1.1.1.2.3.cmml">k</mi></msubsup><mo lspace="0.500em" rspace="0em" id="S3.E5X.2.1.1.m1.1.1.1" xref="S3.E5X.2.1.1.m1.1.1.1.cmml">​</mo><mmultiscripts id="S3.E5X.2.1.1.m1.1.1.3" xref="S3.E5X.2.1.1.m1.1.1.3.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.3.2.2" xref="S3.E5X.2.1.1.m1.1.1.3.2.2.cmml">𝐩</mi><mrow id="S3.E5X.2.1.1.m1.1.1.3a" xref="S3.E5X.2.1.1.m1.1.1.3.cmml"></mrow><mrow id="S3.E5X.2.1.1.m1.1.1.3.2.3" xref="S3.E5X.2.1.1.m1.1.1.3.2.3.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.3.2.3.2" xref="S3.E5X.2.1.1.m1.1.1.3.2.3.2.cmml">k</mi><mo id="S3.E5X.2.1.1.m1.1.1.3.2.3.1" xref="S3.E5X.2.1.1.m1.1.1.3.2.3.1.cmml">+</mo><mn id="S3.E5X.2.1.1.m1.1.1.3.2.3.3" xref="S3.E5X.2.1.1.m1.1.1.3.2.3.3.cmml">1</mn></mrow><mprescripts id="S3.E5X.2.1.1.m1.1.1.3b" xref="S3.E5X.2.1.1.m1.1.1.3.cmml"></mprescripts><mtext id="S3.E5X.2.1.1.m1.1.1.3.3" xref="S3.E5X.2.1.1.m1.1.1.3.3a.cmml">W</mtext><mrow id="S3.E5X.2.1.1.m1.1.1.3c" xref="S3.E5X.2.1.1.m1.1.1.3.cmml"></mrow></mmultiscripts></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.2.1.1.m1.1b"><apply id="S3.E5X.2.1.1.m1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1"><times id="S3.E5X.2.1.1.m1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1"></times><apply id="S3.E5X.2.1.1.m1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.2">superscript</csymbol><apply id="S3.E5X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.2.2.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.2">subscript</csymbol><ci id="S3.E5X.2.1.1.m1.1.1.2.2.2a.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.2.2"><mtext id="S3.E5X.2.1.1.m1.1.1.2.2.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.2.2">R</mtext></ci><ci id="S3.E5X.2.1.1.m1.1.1.2.2.3a.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.2.3"><mtext mathsize="70%" id="S3.E5X.2.1.1.m1.1.1.2.2.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.2.3">BW</mtext></ci></apply><ci id="S3.E5X.2.1.1.m1.1.1.2.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.3">𝑘</ci></apply><apply id="S3.E5X.2.1.1.m1.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.3.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.3">subscript</csymbol><apply id="S3.E5X.2.1.1.m1.1.1.3.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.3.2.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.3">superscript</csymbol><ci id="S3.E5X.2.1.1.m1.1.1.3.2.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.3.2.2">𝐩</ci><apply id="S3.E5X.2.1.1.m1.1.1.3.2.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.3.2.3"><plus id="S3.E5X.2.1.1.m1.1.1.3.2.3.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.3.2.3.1"></plus><ci id="S3.E5X.2.1.1.m1.1.1.3.2.3.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.3.2.3.2">𝑘</ci><cn type="integer" id="S3.E5X.2.1.1.m1.1.1.3.2.3.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.3.2.3.3">1</cn></apply></apply><ci id="S3.E5X.2.1.1.m1.1.1.3.3a.cmml" xref="S3.E5X.2.1.1.m1.1.1.3.3"><mtext mathsize="70%" id="S3.E5X.2.1.1.m1.1.1.3.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.3.3">W</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.2.1.1.m1.1c">\displaystyle\text{R}_{\text{BW}}^{k}\ {}_{\text{W}}\mathbf{p}^{k+1}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5X.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=\text{R}_{\text{BW}}^{k}({}_{\text{W}}\mathbf{p}^{k}+{}_{\text{W}}\mathbf{v}^{j}\Delta{t_{k}}-\frac{1}{2}{}_{\text{W}}\mathbf{g}\Delta{t_{k}}^{2})+\boldsymbol{\alpha}_{k}^{k+1}" display="inline"><semantics id="S3.E5X.3.2.2.m1.1a"><mrow id="S3.E5X.3.2.2.m1.1.1" xref="S3.E5X.3.2.2.m1.1.1.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.3.cmml"></mi><mo id="S3.E5X.3.2.2.m1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.cmml"><mrow id="S3.E5X.3.2.2.m1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.cmml"><msubsup id="S3.E5X.3.2.2.m1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.cmml"><mtext id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2.2a.cmml">R</mtext><mtext id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2.3a.cmml">BW</mtext><mi id="S3.E5X.3.2.2.m1.1.1.1.1.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml"><mmultiscripts id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐩</mi><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2a" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.cmml"></mrow><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.3.cmml">k</mi><mprescripts id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2b" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.cmml"></mprescripts><mtext id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3a.cmml">W</mtext><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2c" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.cmml"></mrow></mmultiscripts><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.1.cmml">+</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.cmml"><mmultiscripts id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.2.2.cmml">𝐯</mi><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2a" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.cmml"></mrow><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.2.3.cmml">j</mi><mprescripts id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2b" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.cmml"></mprescripts><mtext id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.3a.cmml">W</mtext><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2c" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.cmml"></mrow></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.3.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.1a" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><msub id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.4" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.4.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.4.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.4.2.cmml">t</mi><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.4.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.4.3.cmml">k</mi></msub></mrow></mrow><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml"><mfrac id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.2a" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml"><mn id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.2.2.cmml">1</mn><mn id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.2.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mmultiscripts id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.cmml">𝐠</mi><mprescripts id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.3a" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml"></mprescripts><mtext id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.3.3a.cmml">W</mtext><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.3b" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml"></mrow></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.1a" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.4" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.4.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.1b" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mmultiscripts id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5.2.2.cmml">t</mi><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5.2.3.cmml">k</mi><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5a" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5.cmml"></mrow><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5b" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5.cmml"></mrow><mn id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5.3.cmml">2</mn></mmultiscripts></mrow></mrow><mo stretchy="false" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5X.3.2.2.m1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.2.cmml">+</mo><msubsup id="S3.E5X.3.2.2.m1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.3.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.3.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.3.2.2.cmml">𝜶</mi><mi id="S3.E5X.3.2.2.m1.1.1.1.3.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.3.2.3.cmml">k</mi><mrow id="S3.E5X.3.2.2.m1.1.1.1.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.3.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.2.cmml">k</mi><mo id="S3.E5X.3.2.2.m1.1.1.1.3.3.1" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.E5X.3.2.2.m1.1.1.1.3.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.3.2.2.m1.1b"><apply id="S3.E5X.3.2.2.m1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1"><eq id="S3.E5X.3.2.2.m1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E5X.3.2.2.m1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.3">absent</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1"><plus id="S3.E5X.3.2.2.m1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.2"></plus><apply id="S3.E5X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1"><times id="S3.E5X.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.2"></times><apply id="S3.E5X.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3">superscript</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.2a.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2.2"><mtext id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2.2">R</mtext></ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.3a.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2.3"><mtext mathsize="70%" id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2.3">BW</mtext></ci></apply><ci id="S3.E5X.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.3">𝑘</ci></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1"><minus id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2"><plus id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.1"></plus><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.2">𝐩</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.3">𝑘</ci></apply><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3a.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3"><mtext mathsize="70%" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3">W</mtext></ci></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3"><times id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.1"></times><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2">subscript</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2">superscript</csymbol><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.2.2">𝐯</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.2.3">𝑗</ci></apply><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.3a.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.3"><mtext mathsize="70%" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.3">W</mtext></ci></apply><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.3">Δ</ci><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.4"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.4.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.4">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.4.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.4.2">𝑡</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.4.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.3.4.3">𝑘</ci></apply></apply></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3"><times id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.2"><divide id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.2"></divide><cn type="integer" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.2.2">1</cn><cn type="integer" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.2.3">2</cn></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2">𝐠</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.3.3a.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.3.3"><mtext mathsize="70%" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.3.3">W</mtext></ci></apply><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.4">Δ</ci><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5">superscript</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5.2.2">𝑡</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5.2.3">𝑘</ci></apply><cn type="integer" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.5.3">2</cn></apply></apply></apply></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3">superscript</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.3.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.1.1.1.3.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3.2.2">𝜶</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.3.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3.2.3">𝑘</ci></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3.3"><plus id="S3.E5X.3.2.2.m1.1.1.1.3.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.1"></plus><ci id="S3.E5X.3.2.2.m1.1.1.1.3.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.2">𝑘</ci><cn type="integer" id="S3.E5X.3.2.2.m1.1.1.1.3.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.3.2.2.m1.1c">\displaystyle=\text{R}_{\text{BW}}^{k}({}_{\text{W}}\mathbf{p}^{k}+{}_{\text{W}}\mathbf{v}^{j}\Delta{t_{k}}-\frac{1}{2}{}_{\text{W}}\mathbf{g}\Delta{t_{k}}^{2})+\boldsymbol{\alpha}_{k}^{k+1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="3" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr id="S3.E5Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\text{R}_{\text{BW}}^{k}\ {}_{\text{W}}\mathbf{v}^{k+1}" display="inline"><semantics id="S3.E5Xa.2.1.1.m1.1a"><mrow id="S3.E5Xa.2.1.1.m1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.cmml"><msubsup id="S3.E5Xa.2.1.1.m1.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.2.cmml"><mtext id="S3.E5Xa.2.1.1.m1.1.1.2.2.2" xref="S3.E5Xa.2.1.1.m1.1.1.2.2.2a.cmml">R</mtext><mtext id="S3.E5Xa.2.1.1.m1.1.1.2.2.3" xref="S3.E5Xa.2.1.1.m1.1.1.2.2.3a.cmml">BW</mtext><mi id="S3.E5Xa.2.1.1.m1.1.1.2.3" xref="S3.E5Xa.2.1.1.m1.1.1.2.3.cmml">k</mi></msubsup><mo lspace="0.500em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.cmml">​</mo><mmultiscripts id="S3.E5Xa.2.1.1.m1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.3.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.3.2.2" xref="S3.E5Xa.2.1.1.m1.1.1.3.2.2.cmml">𝐯</mi><mrow id="S3.E5Xa.2.1.1.m1.1.1.3a" xref="S3.E5Xa.2.1.1.m1.1.1.3.cmml"></mrow><mrow id="S3.E5Xa.2.1.1.m1.1.1.3.2.3" xref="S3.E5Xa.2.1.1.m1.1.1.3.2.3.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.3.2.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.3.2.3.2.cmml">k</mi><mo id="S3.E5Xa.2.1.1.m1.1.1.3.2.3.1" xref="S3.E5Xa.2.1.1.m1.1.1.3.2.3.1.cmml">+</mo><mn id="S3.E5Xa.2.1.1.m1.1.1.3.2.3.3" xref="S3.E5Xa.2.1.1.m1.1.1.3.2.3.3.cmml">1</mn></mrow><mprescripts id="S3.E5Xa.2.1.1.m1.1.1.3b" xref="S3.E5Xa.2.1.1.m1.1.1.3.cmml"></mprescripts><mtext id="S3.E5Xa.2.1.1.m1.1.1.3.3" xref="S3.E5Xa.2.1.1.m1.1.1.3.3a.cmml">W</mtext><mrow id="S3.E5Xa.2.1.1.m1.1.1.3c" xref="S3.E5Xa.2.1.1.m1.1.1.3.cmml"></mrow></mmultiscripts></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xa.2.1.1.m1.1b"><apply id="S3.E5Xa.2.1.1.m1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1"><times id="S3.E5Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1"></times><apply id="S3.E5Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.2">superscript</csymbol><apply id="S3.E5Xa.2.1.1.m1.1.1.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.2.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.2">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.1.1.2.2.2a.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.2.2.2"><mtext id="S3.E5Xa.2.1.1.m1.1.1.2.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.2.2.2">R</mtext></ci><ci id="S3.E5Xa.2.1.1.m1.1.1.2.2.3a.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.2.2.3"><mtext mathsize="70%" id="S3.E5Xa.2.1.1.m1.1.1.2.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.2.2.3">BW</mtext></ci></apply><ci id="S3.E5Xa.2.1.1.m1.1.1.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.2.3">𝑘</ci></apply><apply id="S3.E5Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.3">subscript</csymbol><apply id="S3.E5Xa.2.1.1.m1.1.1.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.3.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.3">superscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.1.1.3.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.3.2.2">𝐯</ci><apply id="S3.E5Xa.2.1.1.m1.1.1.3.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.3.2.3"><plus id="S3.E5Xa.2.1.1.m1.1.1.3.2.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.3.2.3.1"></plus><ci id="S3.E5Xa.2.1.1.m1.1.1.3.2.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.3.2.3.2">𝑘</ci><cn type="integer" id="S3.E5Xa.2.1.1.m1.1.1.3.2.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.3.2.3.3">1</cn></apply></apply><ci id="S3.E5Xa.2.1.1.m1.1.1.3.3a.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.3.3"><mtext mathsize="70%" id="S3.E5Xa.2.1.1.m1.1.1.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.3.3">W</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.2.1.1.m1.1c">\displaystyle\text{R}_{\text{BW}}^{k}\ {}_{\text{W}}\mathbf{v}^{k+1}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5Xa.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=\text{R}_{\text{BW}}^{k}({}_{\text{W}}\mathbf{v}^{k}-{}_{\text{W}}\mathbf{g}\Delta{t_{k}})+\boldsymbol{\beta}_{k}^{k+1}" display="inline"><semantics id="S3.E5Xa.3.2.2.m1.1a"><mrow id="S3.E5Xa.3.2.2.m1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.3.cmml"></mi><mo id="S3.E5Xa.3.2.2.m1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="S3.E5Xa.3.2.2.m1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.cmml"><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.cmml"><msubsup id="S3.E5Xa.3.2.2.m1.1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.cmml"><mtext id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.2a.cmml">R</mtext><mtext id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.3a.cmml">BW</mtext><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E5Xa.3.2.2.m1.1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mmultiscripts id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.2.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.cmml">𝐯</mi><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2a" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.cmml"></mrow><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.2.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.2.3.cmml">k</mi><mprescripts id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2b" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.cmml"></mprescripts><mtext id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.3a.cmml">W</mtext><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2c" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.cmml"></mrow></mmultiscripts><mo id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.cmml"><mmultiscripts id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2.2.cmml">𝐠</mi><mprescripts id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2a" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml"></mprescripts><mtext id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2.3a.cmml">W</mtext><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2b" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml"></mrow></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.1a" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.4" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.4.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.4.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.4.2.cmml">t</mi><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.4.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.4.3.cmml">k</mi></msub></mrow></mrow><mo stretchy="false" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5Xa.3.2.2.m1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.2.cmml">+</mo><msubsup id="S3.E5Xa.3.2.2.m1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.2.cmml">𝜷</mi><mi id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.3.cmml">k</mi><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.3.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.3.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.3.3.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.3.2.cmml">k</mi><mo id="S3.E5Xa.3.2.2.m1.1.1.1.3.3.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.E5Xa.3.2.2.m1.1.1.1.3.3.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xa.3.2.2.m1.1b"><apply id="S3.E5Xa.3.2.2.m1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1"><eq id="S3.E5Xa.3.2.2.m1.1.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E5Xa.3.2.2.m1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.3">absent</csymbol><apply id="S3.E5Xa.3.2.2.m1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1"><plus id="S3.E5Xa.3.2.2.m1.1.1.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.2"></plus><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1"><times id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2"></times><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3">superscript</csymbol><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.2a.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.2"><mtext id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.2">R</mtext></ci><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.3a.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.3"><mtext mathsize="70%" id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.3">BW</mtext></ci></apply><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3">𝑘</ci></apply><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1"><minus id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.2.2">𝐯</ci><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.2.3">𝑘</ci></apply><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2.3">W</mtext></ci></apply><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3"><times id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2.2">𝐠</ci><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2.3a.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2.3"><mtext mathsize="70%" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2.3">W</mtext></ci></apply><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.3">Δ</ci><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.4.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.4">subscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.4.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.4.2">𝑡</ci><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.4.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3.4.3">𝑘</ci></apply></apply></apply></apply><apply id="S3.E5Xa.3.2.2.m1.1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3">superscript</csymbol><apply id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3">subscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.2">𝜷</ci><ci id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.3">𝑘</ci></apply><apply id="S3.E5Xa.3.2.2.m1.1.1.1.3.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.3"><plus id="S3.E5Xa.3.2.2.m1.1.1.1.3.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.3.1"></plus><ci id="S3.E5Xa.3.2.2.m1.1.1.1.3.3.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.3.2">𝑘</ci><cn type="integer" id="S3.E5Xa.3.2.2.m1.1.1.1.3.3.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.3.2.2.m1.1c">\displaystyle=\text{R}_{\text{BW}}^{k}({}_{\text{W}}\mathbf{v}^{k}-{}_{\text{W}}\mathbf{g}\Delta{t_{k}})+\boldsymbol{\beta}_{k}^{k+1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E5Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5Xb.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\textbf{q}_{\text{BW}}^{k}\otimes\textbf{q}_{\text{WB}}^{k+1}" display="inline"><semantics id="S3.E5Xb.2.1.1.m1.1a"><mrow id="S3.E5Xb.2.1.1.m1.1.1" xref="S3.E5Xb.2.1.1.m1.1.1.cmml"><msubsup id="S3.E5Xb.2.1.1.m1.1.1.2" xref="S3.E5Xb.2.1.1.m1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E5Xb.2.1.1.m1.1.1.2.2.2" xref="S3.E5Xb.2.1.1.m1.1.1.2.2.2a.cmml">q</mtext><mtext id="S3.E5Xb.2.1.1.m1.1.1.2.2.3" xref="S3.E5Xb.2.1.1.m1.1.1.2.2.3a.cmml">BW</mtext><mi id="S3.E5Xb.2.1.1.m1.1.1.2.3" xref="S3.E5Xb.2.1.1.m1.1.1.2.3.cmml">k</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E5Xb.2.1.1.m1.1.1.1" xref="S3.E5Xb.2.1.1.m1.1.1.1.cmml">⊗</mo><msubsup id="S3.E5Xb.2.1.1.m1.1.1.3" xref="S3.E5Xb.2.1.1.m1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E5Xb.2.1.1.m1.1.1.3.2.2" xref="S3.E5Xb.2.1.1.m1.1.1.3.2.2a.cmml">q</mtext><mtext id="S3.E5Xb.2.1.1.m1.1.1.3.2.3" xref="S3.E5Xb.2.1.1.m1.1.1.3.2.3a.cmml">WB</mtext><mrow id="S3.E5Xb.2.1.1.m1.1.1.3.3" xref="S3.E5Xb.2.1.1.m1.1.1.3.3.cmml"><mi id="S3.E5Xb.2.1.1.m1.1.1.3.3.2" xref="S3.E5Xb.2.1.1.m1.1.1.3.3.2.cmml">k</mi><mo id="S3.E5Xb.2.1.1.m1.1.1.3.3.1" xref="S3.E5Xb.2.1.1.m1.1.1.3.3.1.cmml">+</mo><mn id="S3.E5Xb.2.1.1.m1.1.1.3.3.3" xref="S3.E5Xb.2.1.1.m1.1.1.3.3.3.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xb.2.1.1.m1.1b"><apply id="S3.E5Xb.2.1.1.m1.1.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1"><csymbol cd="latexml" id="S3.E5Xb.2.1.1.m1.1.1.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1">tensor-product</csymbol><apply id="S3.E5Xb.2.1.1.m1.1.1.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E5Xb.2.1.1.m1.1.1.2.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.2">superscript</csymbol><apply id="S3.E5Xb.2.1.1.m1.1.1.2.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E5Xb.2.1.1.m1.1.1.2.2.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.2">subscript</csymbol><ci id="S3.E5Xb.2.1.1.m1.1.1.2.2.2a.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E5Xb.2.1.1.m1.1.1.2.2.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.2.2.2">q</mtext></ci><ci id="S3.E5Xb.2.1.1.m1.1.1.2.2.3a.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.2.2.3"><mtext mathsize="70%" id="S3.E5Xb.2.1.1.m1.1.1.2.2.3.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.2.2.3">BW</mtext></ci></apply><ci id="S3.E5Xb.2.1.1.m1.1.1.2.3.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.2.3">𝑘</ci></apply><apply id="S3.E5Xb.2.1.1.m1.1.1.3.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E5Xb.2.1.1.m1.1.1.3.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.3">superscript</csymbol><apply id="S3.E5Xb.2.1.1.m1.1.1.3.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E5Xb.2.1.1.m1.1.1.3.2.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.3">subscript</csymbol><ci id="S3.E5Xb.2.1.1.m1.1.1.3.2.2a.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E5Xb.2.1.1.m1.1.1.3.2.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.3.2.2">q</mtext></ci><ci id="S3.E5Xb.2.1.1.m1.1.1.3.2.3a.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.3.2.3"><mtext mathsize="70%" id="S3.E5Xb.2.1.1.m1.1.1.3.2.3.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.3.2.3">WB</mtext></ci></apply><apply id="S3.E5Xb.2.1.1.m1.1.1.3.3.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.3.3"><plus id="S3.E5Xb.2.1.1.m1.1.1.3.3.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.3.3.1"></plus><ci id="S3.E5Xb.2.1.1.m1.1.1.3.3.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.3.3.2">𝑘</ci><cn type="integer" id="S3.E5Xb.2.1.1.m1.1.1.3.3.3.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xb.2.1.1.m1.1c">\displaystyle\textbf{q}_{\text{BW}}^{k}\otimes\textbf{q}_{\text{WB}}^{k+1}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5Xb.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=\boldsymbol{\gamma}_{k}^{k+1}" display="inline"><semantics id="S3.E5Xb.3.2.2.m1.1a"><mrow id="S3.E5Xb.3.2.2.m1.1.1" xref="S3.E5Xb.3.2.2.m1.1.1.cmml"><mi id="S3.E5Xb.3.2.2.m1.1.1.2" xref="S3.E5Xb.3.2.2.m1.1.1.2.cmml"></mi><mo id="S3.E5Xb.3.2.2.m1.1.1.1" xref="S3.E5Xb.3.2.2.m1.1.1.1.cmml">=</mo><msubsup id="S3.E5Xb.3.2.2.m1.1.1.3" xref="S3.E5Xb.3.2.2.m1.1.1.3.cmml"><mi id="S3.E5Xb.3.2.2.m1.1.1.3.2.2" xref="S3.E5Xb.3.2.2.m1.1.1.3.2.2.cmml">𝜸</mi><mi id="S3.E5Xb.3.2.2.m1.1.1.3.2.3" xref="S3.E5Xb.3.2.2.m1.1.1.3.2.3.cmml">k</mi><mrow id="S3.E5Xb.3.2.2.m1.1.1.3.3" xref="S3.E5Xb.3.2.2.m1.1.1.3.3.cmml"><mi id="S3.E5Xb.3.2.2.m1.1.1.3.3.2" xref="S3.E5Xb.3.2.2.m1.1.1.3.3.2.cmml">k</mi><mo id="S3.E5Xb.3.2.2.m1.1.1.3.3.1" xref="S3.E5Xb.3.2.2.m1.1.1.3.3.1.cmml">+</mo><mn id="S3.E5Xb.3.2.2.m1.1.1.3.3.3" xref="S3.E5Xb.3.2.2.m1.1.1.3.3.3.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xb.3.2.2.m1.1b"><apply id="S3.E5Xb.3.2.2.m1.1.1.cmml" xref="S3.E5Xb.3.2.2.m1.1.1"><eq id="S3.E5Xb.3.2.2.m1.1.1.1.cmml" xref="S3.E5Xb.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="S3.E5Xb.3.2.2.m1.1.1.2.cmml" xref="S3.E5Xb.3.2.2.m1.1.1.2">absent</csymbol><apply id="S3.E5Xb.3.2.2.m1.1.1.3.cmml" xref="S3.E5Xb.3.2.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E5Xb.3.2.2.m1.1.1.3.1.cmml" xref="S3.E5Xb.3.2.2.m1.1.1.3">superscript</csymbol><apply id="S3.E5Xb.3.2.2.m1.1.1.3.2.cmml" xref="S3.E5Xb.3.2.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E5Xb.3.2.2.m1.1.1.3.2.1.cmml" xref="S3.E5Xb.3.2.2.m1.1.1.3">subscript</csymbol><ci id="S3.E5Xb.3.2.2.m1.1.1.3.2.2.cmml" xref="S3.E5Xb.3.2.2.m1.1.1.3.2.2">𝜸</ci><ci id="S3.E5Xb.3.2.2.m1.1.1.3.2.3.cmml" xref="S3.E5Xb.3.2.2.m1.1.1.3.2.3">𝑘</ci></apply><apply id="S3.E5Xb.3.2.2.m1.1.1.3.3.cmml" xref="S3.E5Xb.3.2.2.m1.1.1.3.3"><plus id="S3.E5Xb.3.2.2.m1.1.1.3.3.1.cmml" xref="S3.E5Xb.3.2.2.m1.1.1.3.3.1"></plus><ci id="S3.E5Xb.3.2.2.m1.1.1.3.3.2.cmml" xref="S3.E5Xb.3.2.2.m1.1.1.3.3.2">𝑘</ci><cn type="integer" id="S3.E5Xb.3.2.2.m1.1.1.3.3.3.cmml" xref="S3.E5Xb.3.2.2.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xb.3.2.2.m1.1c">\displaystyle=\boldsymbol{\gamma}_{k}^{k+1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS3.p1.23" class="ltx_p">where <math id="S3.SS3.p1.16.m1.1" class="ltx_Math" alttext="\boldsymbol{\alpha}_{k}^{k+1}" display="inline"><semantics id="S3.SS3.p1.16.m1.1a"><msubsup id="S3.SS3.p1.16.m1.1.1" xref="S3.SS3.p1.16.m1.1.1.cmml"><mi id="S3.SS3.p1.16.m1.1.1.2.2" xref="S3.SS3.p1.16.m1.1.1.2.2.cmml">𝜶</mi><mi id="S3.SS3.p1.16.m1.1.1.2.3" xref="S3.SS3.p1.16.m1.1.1.2.3.cmml">k</mi><mrow id="S3.SS3.p1.16.m1.1.1.3" xref="S3.SS3.p1.16.m1.1.1.3.cmml"><mi id="S3.SS3.p1.16.m1.1.1.3.2" xref="S3.SS3.p1.16.m1.1.1.3.2.cmml">k</mi><mo id="S3.SS3.p1.16.m1.1.1.3.1" xref="S3.SS3.p1.16.m1.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p1.16.m1.1.1.3.3" xref="S3.SS3.p1.16.m1.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.16.m1.1b"><apply id="S3.SS3.p1.16.m1.1.1.cmml" xref="S3.SS3.p1.16.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.16.m1.1.1.1.cmml" xref="S3.SS3.p1.16.m1.1.1">superscript</csymbol><apply id="S3.SS3.p1.16.m1.1.1.2.cmml" xref="S3.SS3.p1.16.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.16.m1.1.1.2.1.cmml" xref="S3.SS3.p1.16.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.16.m1.1.1.2.2.cmml" xref="S3.SS3.p1.16.m1.1.1.2.2">𝜶</ci><ci id="S3.SS3.p1.16.m1.1.1.2.3.cmml" xref="S3.SS3.p1.16.m1.1.1.2.3">𝑘</ci></apply><apply id="S3.SS3.p1.16.m1.1.1.3.cmml" xref="S3.SS3.p1.16.m1.1.1.3"><plus id="S3.SS3.p1.16.m1.1.1.3.1.cmml" xref="S3.SS3.p1.16.m1.1.1.3.1"></plus><ci id="S3.SS3.p1.16.m1.1.1.3.2.cmml" xref="S3.SS3.p1.16.m1.1.1.3.2">𝑘</ci><cn type="integer" id="S3.SS3.p1.16.m1.1.1.3.3.cmml" xref="S3.SS3.p1.16.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.16.m1.1c">\boldsymbol{\alpha}_{k}^{k+1}</annotation></semantics></math>, <math id="S3.SS3.p1.17.m2.1" class="ltx_Math" alttext="\boldsymbol{\beta}_{k}^{k+1}" display="inline"><semantics id="S3.SS3.p1.17.m2.1a"><msubsup id="S3.SS3.p1.17.m2.1.1" xref="S3.SS3.p1.17.m2.1.1.cmml"><mi id="S3.SS3.p1.17.m2.1.1.2.2" xref="S3.SS3.p1.17.m2.1.1.2.2.cmml">𝜷</mi><mi id="S3.SS3.p1.17.m2.1.1.2.3" xref="S3.SS3.p1.17.m2.1.1.2.3.cmml">k</mi><mrow id="S3.SS3.p1.17.m2.1.1.3" xref="S3.SS3.p1.17.m2.1.1.3.cmml"><mi id="S3.SS3.p1.17.m2.1.1.3.2" xref="S3.SS3.p1.17.m2.1.1.3.2.cmml">k</mi><mo id="S3.SS3.p1.17.m2.1.1.3.1" xref="S3.SS3.p1.17.m2.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p1.17.m2.1.1.3.3" xref="S3.SS3.p1.17.m2.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.17.m2.1b"><apply id="S3.SS3.p1.17.m2.1.1.cmml" xref="S3.SS3.p1.17.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.17.m2.1.1.1.cmml" xref="S3.SS3.p1.17.m2.1.1">superscript</csymbol><apply id="S3.SS3.p1.17.m2.1.1.2.cmml" xref="S3.SS3.p1.17.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.17.m2.1.1.2.1.cmml" xref="S3.SS3.p1.17.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.17.m2.1.1.2.2.cmml" xref="S3.SS3.p1.17.m2.1.1.2.2">𝜷</ci><ci id="S3.SS3.p1.17.m2.1.1.2.3.cmml" xref="S3.SS3.p1.17.m2.1.1.2.3">𝑘</ci></apply><apply id="S3.SS3.p1.17.m2.1.1.3.cmml" xref="S3.SS3.p1.17.m2.1.1.3"><plus id="S3.SS3.p1.17.m2.1.1.3.1.cmml" xref="S3.SS3.p1.17.m2.1.1.3.1"></plus><ci id="S3.SS3.p1.17.m2.1.1.3.2.cmml" xref="S3.SS3.p1.17.m2.1.1.3.2">𝑘</ci><cn type="integer" id="S3.SS3.p1.17.m2.1.1.3.3.cmml" xref="S3.SS3.p1.17.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.17.m2.1c">\boldsymbol{\beta}_{k}^{k+1}</annotation></semantics></math> and <math id="S3.SS3.p1.18.m3.1" class="ltx_Math" alttext="\boldsymbol{\gamma}_{k}^{k+1}" display="inline"><semantics id="S3.SS3.p1.18.m3.1a"><msubsup id="S3.SS3.p1.18.m3.1.1" xref="S3.SS3.p1.18.m3.1.1.cmml"><mi id="S3.SS3.p1.18.m3.1.1.2.2" xref="S3.SS3.p1.18.m3.1.1.2.2.cmml">𝜸</mi><mi id="S3.SS3.p1.18.m3.1.1.2.3" xref="S3.SS3.p1.18.m3.1.1.2.3.cmml">k</mi><mrow id="S3.SS3.p1.18.m3.1.1.3" xref="S3.SS3.p1.18.m3.1.1.3.cmml"><mi id="S3.SS3.p1.18.m3.1.1.3.2" xref="S3.SS3.p1.18.m3.1.1.3.2.cmml">k</mi><mo id="S3.SS3.p1.18.m3.1.1.3.1" xref="S3.SS3.p1.18.m3.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p1.18.m3.1.1.3.3" xref="S3.SS3.p1.18.m3.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.18.m3.1b"><apply id="S3.SS3.p1.18.m3.1.1.cmml" xref="S3.SS3.p1.18.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.18.m3.1.1.1.cmml" xref="S3.SS3.p1.18.m3.1.1">superscript</csymbol><apply id="S3.SS3.p1.18.m3.1.1.2.cmml" xref="S3.SS3.p1.18.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.18.m3.1.1.2.1.cmml" xref="S3.SS3.p1.18.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.18.m3.1.1.2.2.cmml" xref="S3.SS3.p1.18.m3.1.1.2.2">𝜸</ci><ci id="S3.SS3.p1.18.m3.1.1.2.3.cmml" xref="S3.SS3.p1.18.m3.1.1.2.3">𝑘</ci></apply><apply id="S3.SS3.p1.18.m3.1.1.3.cmml" xref="S3.SS3.p1.18.m3.1.1.3"><plus id="S3.SS3.p1.18.m3.1.1.3.1.cmml" xref="S3.SS3.p1.18.m3.1.1.3.1"></plus><ci id="S3.SS3.p1.18.m3.1.1.3.2.cmml" xref="S3.SS3.p1.18.m3.1.1.3.2">𝑘</ci><cn type="integer" id="S3.SS3.p1.18.m3.1.1.3.3.cmml" xref="S3.SS3.p1.18.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.18.m3.1c">\boldsymbol{\gamma}_{k}^{k+1}</annotation></semantics></math> are the preintegration terms which only depend on the inertial measurements and biases. These preintegration terms along with their covariance <math id="S3.SS3.p1.19.m4.1" class="ltx_Math" alttext="{}_{\text{B}}\mathbf{P}_{k}^{k+1}" display="inline"><semantics id="S3.SS3.p1.19.m4.1a"><mmultiscripts id="S3.SS3.p1.19.m4.1.1" xref="S3.SS3.p1.19.m4.1.1.cmml"><mi id="S3.SS3.p1.19.m4.1.1.2.2.2" xref="S3.SS3.p1.19.m4.1.1.2.2.2.cmml">𝐏</mi><mi id="S3.SS3.p1.19.m4.1.1.2.2.3" xref="S3.SS3.p1.19.m4.1.1.2.2.3.cmml">k</mi><mrow id="S3.SS3.p1.19.m4.1.1.2.3" xref="S3.SS3.p1.19.m4.1.1.2.3.cmml"><mi id="S3.SS3.p1.19.m4.1.1.2.3.2" xref="S3.SS3.p1.19.m4.1.1.2.3.2.cmml">k</mi><mo id="S3.SS3.p1.19.m4.1.1.2.3.1" xref="S3.SS3.p1.19.m4.1.1.2.3.1.cmml">+</mo><mn id="S3.SS3.p1.19.m4.1.1.2.3.3" xref="S3.SS3.p1.19.m4.1.1.2.3.3.cmml">1</mn></mrow><mprescripts id="S3.SS3.p1.19.m4.1.1a" xref="S3.SS3.p1.19.m4.1.1.cmml"></mprescripts><mtext id="S3.SS3.p1.19.m4.1.1.3" xref="S3.SS3.p1.19.m4.1.1.3a.cmml">B</mtext><mrow id="S3.SS3.p1.19.m4.1.1b" xref="S3.SS3.p1.19.m4.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.19.m4.1b"><apply id="S3.SS3.p1.19.m4.1.1.cmml" xref="S3.SS3.p1.19.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.19.m4.1.1.1.cmml" xref="S3.SS3.p1.19.m4.1.1">subscript</csymbol><apply id="S3.SS3.p1.19.m4.1.1.2.cmml" xref="S3.SS3.p1.19.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.19.m4.1.1.2.1.cmml" xref="S3.SS3.p1.19.m4.1.1">superscript</csymbol><apply id="S3.SS3.p1.19.m4.1.1.2.2.cmml" xref="S3.SS3.p1.19.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.19.m4.1.1.2.2.1.cmml" xref="S3.SS3.p1.19.m4.1.1">subscript</csymbol><ci id="S3.SS3.p1.19.m4.1.1.2.2.2.cmml" xref="S3.SS3.p1.19.m4.1.1.2.2.2">𝐏</ci><ci id="S3.SS3.p1.19.m4.1.1.2.2.3.cmml" xref="S3.SS3.p1.19.m4.1.1.2.2.3">𝑘</ci></apply><apply id="S3.SS3.p1.19.m4.1.1.2.3.cmml" xref="S3.SS3.p1.19.m4.1.1.2.3"><plus id="S3.SS3.p1.19.m4.1.1.2.3.1.cmml" xref="S3.SS3.p1.19.m4.1.1.2.3.1"></plus><ci id="S3.SS3.p1.19.m4.1.1.2.3.2.cmml" xref="S3.SS3.p1.19.m4.1.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS3.p1.19.m4.1.1.2.3.3.cmml" xref="S3.SS3.p1.19.m4.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS3.p1.19.m4.1.1.3a.cmml" xref="S3.SS3.p1.19.m4.1.1.3"><mtext mathsize="70%" id="S3.SS3.p1.19.m4.1.1.3.cmml" xref="S3.SS3.p1.19.m4.1.1.3">B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.19.m4.1c">{}_{\text{B}}\mathbf{P}_{k}^{k+1}</annotation></semantics></math> can be updated iteratively using discrete accelerometer and gyroscope measurements; see  <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">qin2017vins_mono</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">forster2016manifold</span>]</cite> for details. The preintegrated terms <math id="S3.SS3.p1.20.m5.1" class="ltx_Math" alttext="\boldsymbol{\alpha}_{k}^{k+1}" display="inline"><semantics id="S3.SS3.p1.20.m5.1a"><msubsup id="S3.SS3.p1.20.m5.1.1" xref="S3.SS3.p1.20.m5.1.1.cmml"><mi id="S3.SS3.p1.20.m5.1.1.2.2" xref="S3.SS3.p1.20.m5.1.1.2.2.cmml">𝜶</mi><mi id="S3.SS3.p1.20.m5.1.1.2.3" xref="S3.SS3.p1.20.m5.1.1.2.3.cmml">k</mi><mrow id="S3.SS3.p1.20.m5.1.1.3" xref="S3.SS3.p1.20.m5.1.1.3.cmml"><mi id="S3.SS3.p1.20.m5.1.1.3.2" xref="S3.SS3.p1.20.m5.1.1.3.2.cmml">k</mi><mo id="S3.SS3.p1.20.m5.1.1.3.1" xref="S3.SS3.p1.20.m5.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p1.20.m5.1.1.3.3" xref="S3.SS3.p1.20.m5.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.20.m5.1b"><apply id="S3.SS3.p1.20.m5.1.1.cmml" xref="S3.SS3.p1.20.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.20.m5.1.1.1.cmml" xref="S3.SS3.p1.20.m5.1.1">superscript</csymbol><apply id="S3.SS3.p1.20.m5.1.1.2.cmml" xref="S3.SS3.p1.20.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.20.m5.1.1.2.1.cmml" xref="S3.SS3.p1.20.m5.1.1">subscript</csymbol><ci id="S3.SS3.p1.20.m5.1.1.2.2.cmml" xref="S3.SS3.p1.20.m5.1.1.2.2">𝜶</ci><ci id="S3.SS3.p1.20.m5.1.1.2.3.cmml" xref="S3.SS3.p1.20.m5.1.1.2.3">𝑘</ci></apply><apply id="S3.SS3.p1.20.m5.1.1.3.cmml" xref="S3.SS3.p1.20.m5.1.1.3"><plus id="S3.SS3.p1.20.m5.1.1.3.1.cmml" xref="S3.SS3.p1.20.m5.1.1.3.1"></plus><ci id="S3.SS3.p1.20.m5.1.1.3.2.cmml" xref="S3.SS3.p1.20.m5.1.1.3.2">𝑘</ci><cn type="integer" id="S3.SS3.p1.20.m5.1.1.3.3.cmml" xref="S3.SS3.p1.20.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.20.m5.1c">\boldsymbol{\alpha}_{k}^{k+1}</annotation></semantics></math>, <math id="S3.SS3.p1.21.m6.1" class="ltx_Math" alttext="\boldsymbol{\beta}_{k}^{k+1}" display="inline"><semantics id="S3.SS3.p1.21.m6.1a"><msubsup id="S3.SS3.p1.21.m6.1.1" xref="S3.SS3.p1.21.m6.1.1.cmml"><mi id="S3.SS3.p1.21.m6.1.1.2.2" xref="S3.SS3.p1.21.m6.1.1.2.2.cmml">𝜷</mi><mi id="S3.SS3.p1.21.m6.1.1.2.3" xref="S3.SS3.p1.21.m6.1.1.2.3.cmml">k</mi><mrow id="S3.SS3.p1.21.m6.1.1.3" xref="S3.SS3.p1.21.m6.1.1.3.cmml"><mi id="S3.SS3.p1.21.m6.1.1.3.2" xref="S3.SS3.p1.21.m6.1.1.3.2.cmml">k</mi><mo id="S3.SS3.p1.21.m6.1.1.3.1" xref="S3.SS3.p1.21.m6.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p1.21.m6.1.1.3.3" xref="S3.SS3.p1.21.m6.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.21.m6.1b"><apply id="S3.SS3.p1.21.m6.1.1.cmml" xref="S3.SS3.p1.21.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.21.m6.1.1.1.cmml" xref="S3.SS3.p1.21.m6.1.1">superscript</csymbol><apply id="S3.SS3.p1.21.m6.1.1.2.cmml" xref="S3.SS3.p1.21.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.21.m6.1.1.2.1.cmml" xref="S3.SS3.p1.21.m6.1.1">subscript</csymbol><ci id="S3.SS3.p1.21.m6.1.1.2.2.cmml" xref="S3.SS3.p1.21.m6.1.1.2.2">𝜷</ci><ci id="S3.SS3.p1.21.m6.1.1.2.3.cmml" xref="S3.SS3.p1.21.m6.1.1.2.3">𝑘</ci></apply><apply id="S3.SS3.p1.21.m6.1.1.3.cmml" xref="S3.SS3.p1.21.m6.1.1.3"><plus id="S3.SS3.p1.21.m6.1.1.3.1.cmml" xref="S3.SS3.p1.21.m6.1.1.3.1"></plus><ci id="S3.SS3.p1.21.m6.1.1.3.2.cmml" xref="S3.SS3.p1.21.m6.1.1.3.2">𝑘</ci><cn type="integer" id="S3.SS3.p1.21.m6.1.1.3.3.cmml" xref="S3.SS3.p1.21.m6.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.21.m6.1c">\boldsymbol{\beta}_{k}^{k+1}</annotation></semantics></math> and <math id="S3.SS3.p1.22.m7.1" class="ltx_Math" alttext="\boldsymbol{\gamma}_{k}^{k+1}" display="inline"><semantics id="S3.SS3.p1.22.m7.1a"><msubsup id="S3.SS3.p1.22.m7.1.1" xref="S3.SS3.p1.22.m7.1.1.cmml"><mi id="S3.SS3.p1.22.m7.1.1.2.2" xref="S3.SS3.p1.22.m7.1.1.2.2.cmml">𝜸</mi><mi id="S3.SS3.p1.22.m7.1.1.2.3" xref="S3.SS3.p1.22.m7.1.1.2.3.cmml">k</mi><mrow id="S3.SS3.p1.22.m7.1.1.3" xref="S3.SS3.p1.22.m7.1.1.3.cmml"><mi id="S3.SS3.p1.22.m7.1.1.3.2" xref="S3.SS3.p1.22.m7.1.1.3.2.cmml">k</mi><mo id="S3.SS3.p1.22.m7.1.1.3.1" xref="S3.SS3.p1.22.m7.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p1.22.m7.1.1.3.3" xref="S3.SS3.p1.22.m7.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.22.m7.1b"><apply id="S3.SS3.p1.22.m7.1.1.cmml" xref="S3.SS3.p1.22.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.22.m7.1.1.1.cmml" xref="S3.SS3.p1.22.m7.1.1">superscript</csymbol><apply id="S3.SS3.p1.22.m7.1.1.2.cmml" xref="S3.SS3.p1.22.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.22.m7.1.1.2.1.cmml" xref="S3.SS3.p1.22.m7.1.1">subscript</csymbol><ci id="S3.SS3.p1.22.m7.1.1.2.2.cmml" xref="S3.SS3.p1.22.m7.1.1.2.2">𝜸</ci><ci id="S3.SS3.p1.22.m7.1.1.2.3.cmml" xref="S3.SS3.p1.22.m7.1.1.2.3">𝑘</ci></apply><apply id="S3.SS3.p1.22.m7.1.1.3.cmml" xref="S3.SS3.p1.22.m7.1.1.3"><plus id="S3.SS3.p1.22.m7.1.1.3.1.cmml" xref="S3.SS3.p1.22.m7.1.1.3.1"></plus><ci id="S3.SS3.p1.22.m7.1.1.3.2.cmml" xref="S3.SS3.p1.22.m7.1.1.3.2">𝑘</ci><cn type="integer" id="S3.SS3.p1.22.m7.1.1.3.3.cmml" xref="S3.SS3.p1.22.m7.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.22.m7.1c">\boldsymbol{\gamma}_{k}^{k+1}</annotation></semantics></math> are updated using the first-order approximation with respect to their biases if the bias estimates are relatively unchanged as proposed in  <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">forster2016manifold</span>]</cite>. Otherwise, we redo the propagation using the updated bias estimates. The inertial error <math id="S3.SS3.p1.23.m8.1" class="ltx_Math" alttext="\mathbf{e_{i}}^{k}" display="inline"><semantics id="S3.SS3.p1.23.m8.1a"><mmultiscripts id="S3.SS3.p1.23.m8.1.1" xref="S3.SS3.p1.23.m8.1.1.cmml"><mi id="S3.SS3.p1.23.m8.1.1.2.2" xref="S3.SS3.p1.23.m8.1.1.2.2.cmml">𝐞</mi><mi id="S3.SS3.p1.23.m8.1.1.2.3" xref="S3.SS3.p1.23.m8.1.1.2.3.cmml">𝐢</mi><mrow id="S3.SS3.p1.23.m8.1.1a" xref="S3.SS3.p1.23.m8.1.1.cmml"></mrow><mrow id="S3.SS3.p1.23.m8.1.1b" xref="S3.SS3.p1.23.m8.1.1.cmml"></mrow><mi id="S3.SS3.p1.23.m8.1.1.3" xref="S3.SS3.p1.23.m8.1.1.3.cmml">k</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.23.m8.1b"><apply id="S3.SS3.p1.23.m8.1.1.cmml" xref="S3.SS3.p1.23.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.23.m8.1.1.1.cmml" xref="S3.SS3.p1.23.m8.1.1">superscript</csymbol><apply id="S3.SS3.p1.23.m8.1.1.2.cmml" xref="S3.SS3.p1.23.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.23.m8.1.1.2.1.cmml" xref="S3.SS3.p1.23.m8.1.1">subscript</csymbol><ci id="S3.SS3.p1.23.m8.1.1.2.2.cmml" xref="S3.SS3.p1.23.m8.1.1.2.2">𝐞</ci><ci id="S3.SS3.p1.23.m8.1.1.2.3.cmml" xref="S3.SS3.p1.23.m8.1.1.2.3">𝐢</ci></apply><ci id="S3.SS3.p1.23.m8.1.1.3.cmml" xref="S3.SS3.p1.23.m8.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.23.m8.1c">\mathbf{e_{i}}^{k}</annotation></semantics></math> is obtained from  Eq.  <a href="#S3.E5" title="In III-C IMU Preintegration ‣ III Visual-Inertial-Magnetometer Fusion ‣ Enhancing Visual Inertial SLAM with Magnetic Measurements" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> as</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.1" class="ltx_Math" alttext="\leavevmode\resizebox{424.94574pt}{}{
$\mathbf{e_{i}}^{k}=\begin{bmatrix}\text{R}_{\text{BW}}^{k}({}_{\text{W}}\mathbf{p}^{k+1}-{}_{\text{W}}\mathbf{p}^{k}-{}_{\text{W}}\mathbf{v}^{j}\Delta{t_{k}}+\frac{1}{2}{}_{\text{W}}\mathbf{g}\Delta{t_{k}}^{2})-\boldsymbol{\alpha}_{k}^{k+1}\\
\text{R}_{\text{BW}}^{k}{}(_{\text{W}}\mathbf{v}^{k+1}-{}_{\text{W}}\mathbf{v}^{k}+{}_{\text{W}}\mathbf{g}\Delta{t_{k}})-\boldsymbol{\beta}_{k}^{k+1}\\
2[(q_{\text{WB}}^{k})^{-1}\otimes q_{\text{WB}}^{k+1}\otimes(\boldsymbol{\gamma}_{k}^{k+1})^{-1}]_{xyz}\\
\mathbf{b}_{g}^{k+1}-\mathbf{b}_{g}^{k}\\
\mathbf{b}_{a}^{k+1}-\mathbf{b}_{a}^{k}\end{bmatrix}$
}." display="block"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.2.2" xref="S3.E6.m1.1.1.1.1.cmml"><mpadded depth="4.6pt" height="137.4pt" width="424.9pt" id="S3.E6.m1.1.1.1.1.m1.1.2" xref="S3.E6.m1.1.1.1.1.m1.1.2.cmml"><mmultiscripts id="S3.E6.m1.1.1.1.1.m1.1.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.2.2.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.2.2.2.2.cmml">𝐞</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.2.2.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.2.2.2.3.cmml">𝐢</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.2.2a" xref="S3.E6.m1.1.1.1.1.m1.1.2.2.cmml"></mrow><mrow id="S3.E6.m1.1.1.1.1.m1.1.2.2b" xref="S3.E6.m1.1.1.1.1.m1.1.2.2.cmml"></mrow><mi id="S3.E6.m1.1.1.1.1.m1.1.2.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.2.2.3.cmml">k</mi></mmultiscripts><mo id="S3.E6.m1.1.1.1.1.m1.1.2.1" xref="S3.E6.m1.1.1.1.1.m1.1.2.1.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.3.cmml"><mo id="S3.E6.m1.1.1.1.1.m1.1.1.3.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.3.cmml">[</mo><mtable displaystyle="true" rowspacing="0pt" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.cmml"><mtr id="S3.E6.m1.1.1.1.1.m1.1.1.1.1a" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.cmml"><mtd id="S3.E6.m1.1.1.1.1.m1.1.1.1.1b" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">R</mtext><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">BW</mtext><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mmultiscripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐩</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2a" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"></mrow><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml">k</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml">+</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow><mprescripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2b" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"></mprescripts><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">W</mtext><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2c" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"></mrow></mmultiscripts><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">−</mo><mmultiscripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml">𝐩</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3a" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"></mrow><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml">k</mi><mprescripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3b" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"></mprescripts><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">W</mtext><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3c" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"></mrow></mmultiscripts><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1a" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">−</mo><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.cmml"><mmultiscripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2.2.2.cmml">𝐯</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2a" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2.cmml"></mrow><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2.2.3.cmml">j</mi><mprescripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2b" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2.cmml"></mprescripts><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2.3.cmml">W</mtext><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2c" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2.cmml"></mrow></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.1.cmml">​</mo><mi mathvariant="normal" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.3.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.1a" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.1.cmml">​</mo><msub id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.4" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.4.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.4.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.4.2.cmml">t</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.4.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.4.3.cmml">k</mi></msub></mrow></mrow><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mstyle displaystyle="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mfrac id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2a" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">1</mn><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mmultiscripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐠</mi><mprescripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3a" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"></mprescripts><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">W</mtext><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3b" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"></mrow></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1a" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1b" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mmultiscripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.2.2.cmml">t</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.2.3.cmml">k</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5a" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.cmml"></mrow><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5b" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.cmml"></mrow><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.3.cmml">2</mn></mmultiscripts></mrow></mrow><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">−</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝜶</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">k</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">k</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msubsup></mrow></mtd></mtr><mtr id="S3.E6.m1.1.1.1.1.m1.1.1.1.1c" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.cmml"><mtd id="S3.E6.m1.1.1.1.1.m1.1.1.1.1d" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.cmml"><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.1.cmml"><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.1.2.2.cmml">R</mtext><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.1.2.3.cmml">BW</mtext><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.1.3.cmml">k</mi></msubsup><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.cmml"><msub id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.1.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.1.2.cmml">(</mo><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.1.3.cmml">W</mtext></msub><msup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.2.cmml">𝐯</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.3.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.3.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.3.1.cmml">+</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.3.3.cmml">1</mn></mrow></msup><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.3.cmml">−</mo><mmultiscripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4.2.2.cmml">𝐯</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4a" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4.cmml"></mrow><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4.2.3.cmml">k</mi><mprescripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4b" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4.cmml"></mprescripts><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4.3.cmml">W</mtext><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4c" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4.cmml"></mrow></mmultiscripts><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.5" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.5.cmml">+</mo><mmultiscripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.6" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.6.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.6.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.6.2.cmml">𝐠</mi><mprescripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.6a" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.6.cmml"></mprescripts><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.6.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.6.3.cmml">W</mtext><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.6b" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.6.cmml"></mrow></mmultiscripts><mi mathvariant="normal" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.7" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.7.cmml">Δ</mi><msub id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.8" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.8.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.8.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.8.2.cmml">t</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.8.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.8.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.9" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.9.cmml">)</mo></mrow><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.3.cmml">−</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.2.2.cmml">𝜷</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.2.3.cmml">k</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.3.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.3.2.cmml">k</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.3.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.3.1.cmml">+</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.3.3.cmml">1</mn></mrow></msubsup></mrow></mtd></mtr><mtr id="S3.E6.m1.1.1.1.1.m1.1.1.1.1e" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.cmml"><mtd id="S3.E6.m1.1.1.1.1.m1.1.1.1.1f" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.cmml"><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.2.cmml">​</mo><msub id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.cmml">[</mo><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml"><msup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">q</mi><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">WB</mtext><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo rspace="0.055em" stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.cmml"><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3a" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.cmml">−</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.2.cmml">1</mn></mrow></msup><mo rspace="0.222em" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.cmml">⊗</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.2.2.cmml">q</mi><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.2.3.cmml">WB</mtext><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.3.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.3.2.cmml">k</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.3.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.3.1.cmml">+</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3a" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.cmml">⊗</mo><msup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.cmml"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.cmml">(</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.2.2.cmml">𝜸</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.2.3.cmml">k</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.3.2.cmml">k</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.3.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.3.1.cmml">+</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.cmml">)</mo></mrow><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.3a" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.3.cmml">−</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.3.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.3.2.cmml">1</mn></mrow></msup></mrow><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.cmml">]</mo></mrow><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.1a" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.4" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.4.cmml">z</mi></mrow></msub></mrow></mtd></mtr><mtr id="S3.E6.m1.1.1.1.1.m1.1.1.1.1g" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.cmml"><mtd id="S3.E6.m1.1.1.1.1.m1.1.1.1.1h" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.cmml"><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.2.2.cmml">𝐛</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.2.3.cmml">g</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.3.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.3.2.cmml">k</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.3.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.3.1.cmml">+</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.1.cmml">−</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.3.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.3.2.2.cmml">𝐛</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.3.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.3.2.3.cmml">g</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.3.3.cmml">k</mi></msubsup></mrow></mtd></mtr><mtr id="S3.E6.m1.1.1.1.1.m1.1.1.1.1i" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.cmml"><mtd id="S3.E6.m1.1.1.1.1.m1.1.1.1.1j" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.cmml"><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.2.2.cmml">𝐛</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.2.3.cmml">a</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.3.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.3.2.cmml">k</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.3.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.3.1.cmml">+</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.1.cmml">−</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.3.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.3.2.2.cmml">𝐛</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.3.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.3.2.3.cmml">a</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.3.3.cmml">k</mi></msubsup></mrow></mtd></mtr></mtable><mo id="S3.E6.m1.1.1.1.1.m1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.3.cmml">]</mo></mrow></mpadded><mo lspace="0em" id="S3.E6.m1.1.2.2.1" xref="S3.E6.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.2.2"><mpadded depth="4.6pt" height="137.4pt" width="424.9pt" id="S3.E6.m1.1.1.1.1.m1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.2"><mmultiscripts id="S3.E6.m1.1.1.1.1.m1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.2.2"><mi id="S3.E6.m1.1.1.1.1.m1.1.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.2.2.2.2">𝐞</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.2.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.2.2.2.3">𝐢</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.2.2a.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.2.2"></mrow><mrow id="S3.E6.m1.1.1.1.1.m1.1.2.2b.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.2.2"></mrow><mi id="S3.E6.m1.1.1.1.1.m1.1.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.2.2.3">k</mi></mmultiscripts><mo id="S3.E6.m1.1.1.1.1.m1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.2.1">=</mo><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.3"><mo id="S3.E6.m1.1.1.1.1.m1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.3">[</mo><mtable rowspacing="0pt" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1"><mtr id="S3.E6.m1.1.1.1.1.m1.1.1.1.1a.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1"><mtd id="S3.E6.m1.1.1.1.1.m1.1.1.1.1b.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1"><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3"><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.2">R</mtext><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.3">BW</mtext><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3">k</mi></msubsup><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2" lspace='0px' rspace='0px'></mo><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1">(</mo><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"><mmultiscripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝐩</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"></mrow><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.2">k</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.1">+</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.3">1</mn></mrow><mprescripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2b.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"></mprescripts><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">W</mtext><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2c.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"></mrow></mmultiscripts><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1">−</mo><mmultiscripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.2">𝐩</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"></mrow><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.3">k</mi><mprescripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3b.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"></mprescripts><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">W</mtext><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3c.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"></mrow></mmultiscripts><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1a.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1">−</mo><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4"><mmultiscripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2.2.2">𝐯</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2a.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2"></mrow><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2.2.3">j</mi><mprescripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2b.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2"></mprescripts><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2.3">W</mtext><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2c.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.2"></mrow></mmultiscripts><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.1" lspace='0px' rspace='0px'></mo><mi mathvariant="normal" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.3">Δ</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.1a.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.1" lspace='0px' rspace='0px'></mo><msub id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.4.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.4"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.4.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.4.2">t</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.4.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.4.4.3">k</mi></msub></mrow></mrow><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">+</mo><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><mfrac id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2"><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">1</mn><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">2</mn></mfrac><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" lspace='0px' rspace='0px'></mo><mmultiscripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝐠</mi><mprescripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"></mprescripts><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">W</mtext><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3b.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"></mrow></mmultiscripts><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1a.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" lspace='0px' rspace='0px'></mo><mi mathvariant="normal" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4">Δ</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1b.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" lspace='0px' rspace='0px'></mo><mmultiscripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.2.2">t</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.2.3">k</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5a.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5"></mrow><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5b.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5"></mrow><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.3">2</mn></mmultiscripts></mrow></mrow><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1">)</mo></mrow></mrow><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.2">−</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.2.2">𝜶</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.2.3">k</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.3"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.3.2">k</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.3.1">+</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3.3.3">1</mn></mrow></msubsup></mrow></mtd></mtr><mtr id="S3.E6.m1.1.1.1.1.m1.1.1.1.1c.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1"><mtd id="S3.E6.m1.1.1.1.1.m1.1.1.1.1d.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1"><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.1"><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.1.2.2">R</mtext><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.1.2.3">BW</mtext><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.1.3">k</mi></msubsup><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2"><msub id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.1"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.1.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.1.2">(</mo><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.1.3">W</mtext></msub><msup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.2">𝐯</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.3"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.3.2">k</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.3.1">+</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.2.3.3">1</mn></mrow></msup><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.3">−</mo><mmultiscripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4.2.2">𝐯</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4a.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4"></mrow><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4.2.3">k</mi><mprescripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4b.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4"></mprescripts><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4.3">W</mtext><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4c.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.4"></mrow></mmultiscripts><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.5.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.5">+</mo><mmultiscripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.6.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.6"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.6.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.6.2">𝐠</mi><mprescripts id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.6a.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.6"></mprescripts><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.6.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.6.3">W</mtext><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.6b.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.6"></mrow></mmultiscripts><mi mathvariant="normal" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.7.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.7">Δ</mi><msub id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.8.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.8"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.8.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.8.2">t</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.8.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.8.3">k</mi></msub><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.9.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.2.9">)</mo></mrow><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.3">−</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.2.2">𝜷</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.2.3">k</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.3"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.3.2">k</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.3.1">+</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.3.1.1.4.3.3">1</mn></mrow></msubsup></mrow></mtd></mtr><mtr id="S3.E6.m1.1.1.1.1.m1.1.1.1.1e.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1"><mtd id="S3.E6.m1.1.1.1.1.m1.1.1.1.1f.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1"><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.3">2</mn><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.2" lspace='0px' rspace='0px'></mo><msub id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1">[</mo><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1"><msup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1">(</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1.2.2">q</mi><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1.2.3">WB</mtext><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1.3">k</mi></msubsup><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1">)</mo></mrow><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3"><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3a.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3">−</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.2">1</mn></mrow></msup><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3">⊗</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.2.2">q</mi><mtext id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.2.3">WB</mtext><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.3"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.3.2">k</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.3.1">+</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.4.3.3">1</mn></mrow></msubsup><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3a.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3">⊗</mo><msup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1">(</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.2.2">𝜸</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.2.3">k</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.3"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.3.2">k</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.3.1">+</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.1.3.3">1</mn></mrow></msubsup><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.1">)</mo></mrow><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.3"><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.3a.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.3">−</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.3.2">1</mn></mrow></msup></mrow><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.1.1">]</mo></mrow><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.2">x</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.1" lspace='0px' rspace='0px'></mo><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.3">y</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.1a.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.1" lspace='0px' rspace='0px'></mo><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.4.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.2.2.1.1.1.3.4">z</mi></mrow></msub></mrow></mtd></mtr><mtr id="S3.E6.m1.1.1.1.1.m1.1.1.1.1g.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1"><mtd id="S3.E6.m1.1.1.1.1.m1.1.1.1.1h.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1"><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.2.2">𝐛</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.2.3">g</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.3"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.3.2">k</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.3.1">+</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.2.3.3">1</mn></mrow></msubsup><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.1">−</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.3"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.3.2.2">𝐛</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.3.2.3">g</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.4.1.1.3.3">k</mi></msubsup></mrow></mtd></mtr><mtr id="S3.E6.m1.1.1.1.1.m1.1.1.1.1i.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1"><mtd id="S3.E6.m1.1.1.1.1.m1.1.1.1.1j.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1"><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.2.2">𝐛</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.2.3">a</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.3"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.3.2">k</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.3.1">+</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.2.3.3">1</mn></mrow></msubsup><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.1">−</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.3"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.3.2.2">𝐛</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.3.2.3">a</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.5.1.1.3.3">k</mi></msubsup></mrow></mtd></mtr></mtable><mo id="S3.E6.m1.1.1.1.1.m1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.3">]</mo></mrow></mpadded></ci></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\leavevmode\resizebox{424.94574pt}{}{
$\mathbf{e_{i}}^{k}=\begin{bmatrix}\text{R}_{\text{BW}}^{k}({}_{\text{W}}\mathbf{p}^{k+1}-{}_{\text{W}}\mathbf{p}^{k}-{}_{\text{W}}\mathbf{v}^{j}\Delta{t_{k}}+\frac{1}{2}{}_{\text{W}}\mathbf{g}\Delta{t_{k}}^{2})-\boldsymbol{\alpha}_{k}^{k+1}\\
\text{R}_{\text{BW}}^{k}{}(_{\text{W}}\mathbf{v}^{k+1}-{}_{\text{W}}\mathbf{v}^{k}+{}_{\text{W}}\mathbf{g}\Delta{t_{k}})-\boldsymbol{\beta}_{k}^{k+1}\\
2[(q_{\text{WB}}^{k})^{-1}\otimes q_{\text{WB}}^{k+1}\otimes(\boldsymbol{\gamma}_{k}^{k+1})^{-1}]_{xyz}\\
\mathbf{b}_{g}^{k+1}-\mathbf{b}_{g}^{k}\\
\mathbf{b}_{a}^{k+1}-\mathbf{b}_{a}^{k}\end{bmatrix}$
}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.24" class="ltx_p">The preintegration term allows us to estimate the body orientation at time <math id="S3.SS3.p1.24.m1.2" class="ltx_Math" alttext="j\in(k,k+1]" display="inline"><semantics id="S3.SS3.p1.24.m1.2a"><mrow id="S3.SS3.p1.24.m1.2.2" xref="S3.SS3.p1.24.m1.2.2.cmml"><mi id="S3.SS3.p1.24.m1.2.2.3" xref="S3.SS3.p1.24.m1.2.2.3.cmml">j</mi><mo id="S3.SS3.p1.24.m1.2.2.2" xref="S3.SS3.p1.24.m1.2.2.2.cmml">∈</mo><mrow id="S3.SS3.p1.24.m1.2.2.1.1" xref="S3.SS3.p1.24.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.24.m1.2.2.1.1.2" xref="S3.SS3.p1.24.m1.2.2.1.2.cmml">(</mo><mi id="S3.SS3.p1.24.m1.1.1" xref="S3.SS3.p1.24.m1.1.1.cmml">k</mi><mo id="S3.SS3.p1.24.m1.2.2.1.1.3" xref="S3.SS3.p1.24.m1.2.2.1.2.cmml">,</mo><mrow id="S3.SS3.p1.24.m1.2.2.1.1.1" xref="S3.SS3.p1.24.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.p1.24.m1.2.2.1.1.1.2" xref="S3.SS3.p1.24.m1.2.2.1.1.1.2.cmml">k</mi><mo id="S3.SS3.p1.24.m1.2.2.1.1.1.1" xref="S3.SS3.p1.24.m1.2.2.1.1.1.1.cmml">+</mo><mn id="S3.SS3.p1.24.m1.2.2.1.1.1.3" xref="S3.SS3.p1.24.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS3.p1.24.m1.2.2.1.1.4" xref="S3.SS3.p1.24.m1.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.24.m1.2b"><apply id="S3.SS3.p1.24.m1.2.2.cmml" xref="S3.SS3.p1.24.m1.2.2"><in id="S3.SS3.p1.24.m1.2.2.2.cmml" xref="S3.SS3.p1.24.m1.2.2.2"></in><ci id="S3.SS3.p1.24.m1.2.2.3.cmml" xref="S3.SS3.p1.24.m1.2.2.3">𝑗</ci><interval closure="open-closed" id="S3.SS3.p1.24.m1.2.2.1.2.cmml" xref="S3.SS3.p1.24.m1.2.2.1.1"><ci id="S3.SS3.p1.24.m1.1.1.cmml" xref="S3.SS3.p1.24.m1.1.1">𝑘</ci><apply id="S3.SS3.p1.24.m1.2.2.1.1.1.cmml" xref="S3.SS3.p1.24.m1.2.2.1.1.1"><plus id="S3.SS3.p1.24.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.24.m1.2.2.1.1.1.1"></plus><ci id="S3.SS3.p1.24.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.p1.24.m1.2.2.1.1.1.2">𝑘</ci><cn type="integer" id="S3.SS3.p1.24.m1.2.2.1.1.1.3.cmml" xref="S3.SS3.p1.24.m1.2.2.1.1.1.3">1</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.24.m1.2c">j\in(k,k+1]</annotation></semantics></math> during recursive updates which we will use to obtain the magnetometer error in the next section.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS4.5.1.1" class="ltx_text">III-D</span> </span><span id="S3.SS4.6.2" class="ltx_text ltx_font_italic">Magnetometer Residuals</span>
</h3>

<figure id="S3.F3" class="ltx_figure"><img src="/html/2409.09904/assets/figures/magnetometer_diagram.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="509" height="189" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S3.F3.3.2" class="ltx_text" style="font-size:90%;">Illustration of visual, inertial and magnetometer measurement timing</span></figcaption>
</figure>
<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.21" class="ltx_p">Magnetometer and IMU measurements obtained from 9-axis IMU used in attitude and heading reference systems (AHRS) are synchronized as shown in Fig. <a href="#S3.F3" title="Figure 3 ‣ III-D Magnetometer Residuals ‣ III Visual-Inertial-Magnetometer Fusion ‣ Enhancing Visual Inertial SLAM with Magnetic Measurements" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The uncertainty of magnetometer measurements is modeled as Gaussian noise such that the magnetometer measurement is</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.1" class="ltx_Math" alttext="{}_{\text{B}}\tilde{\mathbf{m}}=\text{R}_{\text{WB}}^{\text{T}}\ {}_{\text{W}}\mathbf{m}+\boldsymbol{\eta}_{m}" display="block"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><mmultiscripts id="S3.E7.m1.1.1.2" xref="S3.E7.m1.1.1.2.cmml"><mover accent="true" id="S3.E7.m1.1.1.2.2" xref="S3.E7.m1.1.1.2.2.cmml"><mi id="S3.E7.m1.1.1.2.2.2" xref="S3.E7.m1.1.1.2.2.2.cmml">𝐦</mi><mo id="S3.E7.m1.1.1.2.2.1" xref="S3.E7.m1.1.1.2.2.1.cmml">~</mo></mover><mprescripts id="S3.E7.m1.1.1.2a" xref="S3.E7.m1.1.1.2.cmml"></mprescripts><mtext id="S3.E7.m1.1.1.2.3" xref="S3.E7.m1.1.1.2.3a.cmml">B</mtext><mrow id="S3.E7.m1.1.1.2b" xref="S3.E7.m1.1.1.2.cmml"></mrow></mmultiscripts><mo id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml"><mrow id="S3.E7.m1.1.1.3.2" xref="S3.E7.m1.1.1.3.2.cmml"><msubsup id="S3.E7.m1.1.1.3.2.2" xref="S3.E7.m1.1.1.3.2.2.cmml"><mtext id="S3.E7.m1.1.1.3.2.2.2.2" xref="S3.E7.m1.1.1.3.2.2.2.2a.cmml">R</mtext><mtext id="S3.E7.m1.1.1.3.2.2.2.3" xref="S3.E7.m1.1.1.3.2.2.2.3a.cmml">WB</mtext><mtext id="S3.E7.m1.1.1.3.2.2.3" xref="S3.E7.m1.1.1.3.2.2.3a.cmml">T</mtext></msubsup><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.3.2.1" xref="S3.E7.m1.1.1.3.2.1.cmml">​</mo><mmultiscripts id="S3.E7.m1.1.1.3.2.3" xref="S3.E7.m1.1.1.3.2.3.cmml"><mi id="S3.E7.m1.1.1.3.2.3.2" xref="S3.E7.m1.1.1.3.2.3.2.cmml">𝐦</mi><mprescripts id="S3.E7.m1.1.1.3.2.3a" xref="S3.E7.m1.1.1.3.2.3.cmml"></mprescripts><mtext id="S3.E7.m1.1.1.3.2.3.3" xref="S3.E7.m1.1.1.3.2.3.3a.cmml">W</mtext><mrow id="S3.E7.m1.1.1.3.2.3b" xref="S3.E7.m1.1.1.3.2.3.cmml"></mrow></mmultiscripts></mrow><mo id="S3.E7.m1.1.1.3.1" xref="S3.E7.m1.1.1.3.1.cmml">+</mo><msub id="S3.E7.m1.1.1.3.3" xref="S3.E7.m1.1.1.3.3.cmml"><mi id="S3.E7.m1.1.1.3.3.2" xref="S3.E7.m1.1.1.3.3.2.cmml">𝜼</mi><mi id="S3.E7.m1.1.1.3.3.3" xref="S3.E7.m1.1.1.3.3.3.cmml">m</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><eq id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"></eq><apply id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.2">subscript</csymbol><apply id="S3.E7.m1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.2.2"><ci id="S3.E7.m1.1.1.2.2.1.cmml" xref="S3.E7.m1.1.1.2.2.1">~</ci><ci id="S3.E7.m1.1.1.2.2.2.cmml" xref="S3.E7.m1.1.1.2.2.2">𝐦</ci></apply><ci id="S3.E7.m1.1.1.2.3a.cmml" xref="S3.E7.m1.1.1.2.3"><mtext mathsize="70%" id="S3.E7.m1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.2.3">B</mtext></ci></apply><apply id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3"><plus id="S3.E7.m1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.3.1"></plus><apply id="S3.E7.m1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.3.2"><times id="S3.E7.m1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.3.2.1"></times><apply id="S3.E7.m1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.3.2.2.1.cmml" xref="S3.E7.m1.1.1.3.2.2">superscript</csymbol><apply id="S3.E7.m1.1.1.3.2.2.2.cmml" xref="S3.E7.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.3.2.2.2.1.cmml" xref="S3.E7.m1.1.1.3.2.2">subscript</csymbol><ci id="S3.E7.m1.1.1.3.2.2.2.2a.cmml" xref="S3.E7.m1.1.1.3.2.2.2.2"><mtext id="S3.E7.m1.1.1.3.2.2.2.2.cmml" xref="S3.E7.m1.1.1.3.2.2.2.2">R</mtext></ci><ci id="S3.E7.m1.1.1.3.2.2.2.3a.cmml" xref="S3.E7.m1.1.1.3.2.2.2.3"><mtext mathsize="70%" id="S3.E7.m1.1.1.3.2.2.2.3.cmml" xref="S3.E7.m1.1.1.3.2.2.2.3">WB</mtext></ci></apply><ci id="S3.E7.m1.1.1.3.2.2.3a.cmml" xref="S3.E7.m1.1.1.3.2.2.3"><mtext mathsize="70%" id="S3.E7.m1.1.1.3.2.2.3.cmml" xref="S3.E7.m1.1.1.3.2.2.3">T</mtext></ci></apply><apply id="S3.E7.m1.1.1.3.2.3.cmml" xref="S3.E7.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.3.2.3.1.cmml" xref="S3.E7.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.E7.m1.1.1.3.2.3.2.cmml" xref="S3.E7.m1.1.1.3.2.3.2">𝐦</ci><ci id="S3.E7.m1.1.1.3.2.3.3a.cmml" xref="S3.E7.m1.1.1.3.2.3.3"><mtext mathsize="70%" id="S3.E7.m1.1.1.3.2.3.3.cmml" xref="S3.E7.m1.1.1.3.2.3.3">W</mtext></ci></apply></apply><apply id="S3.E7.m1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.3.3.1.cmml" xref="S3.E7.m1.1.1.3.3">subscript</csymbol><ci id="S3.E7.m1.1.1.3.3.2.cmml" xref="S3.E7.m1.1.1.3.3.2">𝜼</ci><ci id="S3.E7.m1.1.1.3.3.3.cmml" xref="S3.E7.m1.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">{}_{\text{B}}\tilde{\mathbf{m}}=\text{R}_{\text{WB}}^{\text{T}}\ {}_{\text{W}}\mathbf{m}+\boldsymbol{\eta}_{m}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.5" class="ltx_p">where <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="{}_{\text{W}}\mathbf{m}" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><mmultiscripts id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">𝐦</mi><mprescripts id="S3.SS4.p1.1.m1.1.1a" xref="S3.SS4.p1.1.m1.1.1.cmml"></mprescripts><mtext id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3a.cmml">W</mtext><mrow id="S3.SS4.p1.1.m1.1.1b" xref="S3.SS4.p1.1.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">𝐦</ci><ci id="S3.SS4.p1.1.m1.1.1.3a.cmml" xref="S3.SS4.p1.1.m1.1.1.3"><mtext mathsize="70%" id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3">W</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">{}_{\text{W}}\mathbf{m}</annotation></semantics></math> is the earth’s magnetic field at the location in world coordinate frame which is aligned with earth’s east, north and up (ENU) direction. The magnetometer additive white noise can be expressed as <math id="S3.SS4.p1.2.m2.2" class="ltx_Math" alttext="\boldsymbol{\eta}_{m}\sim\pazocal{N}(\mathbf{0},\sigma_{m}^{2}\cdot\mathbf{I})" display="inline"><semantics id="S3.SS4.p1.2.m2.2a"><mrow id="S3.SS4.p1.2.m2.2.2" xref="S3.SS4.p1.2.m2.2.2.cmml"><msub id="S3.SS4.p1.2.m2.2.2.3" xref="S3.SS4.p1.2.m2.2.2.3.cmml"><mi id="S3.SS4.p1.2.m2.2.2.3.2" xref="S3.SS4.p1.2.m2.2.2.3.2.cmml">𝜼</mi><mi id="S3.SS4.p1.2.m2.2.2.3.3" xref="S3.SS4.p1.2.m2.2.2.3.3.cmml">m</mi></msub><mo id="S3.SS4.p1.2.m2.2.2.2" xref="S3.SS4.p1.2.m2.2.2.2.cmml">∼</mo><mrow id="S3.SS4.p1.2.m2.2.2.1" xref="S3.SS4.p1.2.m2.2.2.1.cmml"><mi mathvariant="normal" id="S3.SS4.p1.2.m2.2.2.1.3" xref="S3.SS4.p1.2.m2.2.2.1.3.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.2.2.1.2" xref="S3.SS4.p1.2.m2.2.2.1.2.cmml">​</mo><mrow id="S3.SS4.p1.2.m2.2.2.1.1.1" xref="S3.SS4.p1.2.m2.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS4.p1.2.m2.2.2.1.1.1.2" xref="S3.SS4.p1.2.m2.2.2.1.1.2.cmml">(</mo><mn id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml">𝟎</mn><mo id="S3.SS4.p1.2.m2.2.2.1.1.1.3" xref="S3.SS4.p1.2.m2.2.2.1.1.2.cmml">,</mo><mrow id="S3.SS4.p1.2.m2.2.2.1.1.1.1" xref="S3.SS4.p1.2.m2.2.2.1.1.1.1.cmml"><msubsup id="S3.SS4.p1.2.m2.2.2.1.1.1.1.2" xref="S3.SS4.p1.2.m2.2.2.1.1.1.1.2.cmml"><mi id="S3.SS4.p1.2.m2.2.2.1.1.1.1.2.2.2" xref="S3.SS4.p1.2.m2.2.2.1.1.1.1.2.2.2.cmml">σ</mi><mi mathvariant="normal" id="S3.SS4.p1.2.m2.2.2.1.1.1.1.2.2.3" xref="S3.SS4.p1.2.m2.2.2.1.1.1.1.2.2.3.cmml">m</mi><mn id="S3.SS4.p1.2.m2.2.2.1.1.1.1.2.3" xref="S3.SS4.p1.2.m2.2.2.1.1.1.1.2.3.cmml">2</mn></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p1.2.m2.2.2.1.1.1.1.1" xref="S3.SS4.p1.2.m2.2.2.1.1.1.1.1.cmml">⋅</mo><mi id="S3.SS4.p1.2.m2.2.2.1.1.1.1.3" xref="S3.SS4.p1.2.m2.2.2.1.1.1.1.3.cmml">𝐈</mi></mrow><mo stretchy="false" id="S3.SS4.p1.2.m2.2.2.1.1.1.4" xref="S3.SS4.p1.2.m2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.2b"><apply id="S3.SS4.p1.2.m2.2.2.cmml" xref="S3.SS4.p1.2.m2.2.2"><csymbol cd="latexml" id="S3.SS4.p1.2.m2.2.2.2.cmml" xref="S3.SS4.p1.2.m2.2.2.2">similar-to</csymbol><apply id="S3.SS4.p1.2.m2.2.2.3.cmml" xref="S3.SS4.p1.2.m2.2.2.3"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.2.2.3.1.cmml" xref="S3.SS4.p1.2.m2.2.2.3">subscript</csymbol><ci id="S3.SS4.p1.2.m2.2.2.3.2.cmml" xref="S3.SS4.p1.2.m2.2.2.3.2">𝜼</ci><ci id="S3.SS4.p1.2.m2.2.2.3.3.cmml" xref="S3.SS4.p1.2.m2.2.2.3.3">𝑚</ci></apply><apply id="S3.SS4.p1.2.m2.2.2.1.cmml" xref="S3.SS4.p1.2.m2.2.2.1"><times id="S3.SS4.p1.2.m2.2.2.1.2.cmml" xref="S3.SS4.p1.2.m2.2.2.1.2"></times><ci id="S3.SS4.p1.2.m2.2.2.1.3.cmml" xref="S3.SS4.p1.2.m2.2.2.1.3">N</ci><interval closure="open" id="S3.SS4.p1.2.m2.2.2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1.1"><cn type="integer" id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">0</cn><apply id="S3.SS4.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1.1.1"><ci id="S3.SS4.p1.2.m2.2.2.1.1.1.1.1.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1.1.1.1">⋅</ci><apply id="S3.SS4.p1.2.m2.2.2.1.1.1.1.2.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.2.2.1.1.1.1.2.1.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1.1.1.2">superscript</csymbol><apply id="S3.SS4.p1.2.m2.2.2.1.1.1.1.2.2.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.2.2.1.1.1.1.2.2.1.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.2.m2.2.2.1.1.1.1.2.2.2.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1.1.1.2.2.2">𝜎</ci><ci id="S3.SS4.p1.2.m2.2.2.1.1.1.1.2.2.3.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1.1.1.2.2.3">m</ci></apply><cn type="integer" id="S3.SS4.p1.2.m2.2.2.1.1.1.1.2.3.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1.1.1.2.3">2</cn></apply><ci id="S3.SS4.p1.2.m2.2.2.1.1.1.1.3.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1.1.1.3">𝐈</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.2c">\boldsymbol{\eta}_{m}\sim\pazocal{N}(\mathbf{0},\sigma_{m}^{2}\cdot\mathbf{I})</annotation></semantics></math>. We estimate the magnetometer white noise similar to IMU  <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">ieee_imu_standard</span>]</cite> using the allan-variance plot.
However, the magnetometer measures the superposition of Earth’s magnetic field and local magnetic field because of the presence of magnetic materials in the sensor’s vicinity. Thus, the magnetometer is calibrated before experiments to estimate the soft and hard iron effects. The calibration procedure is explained in the next section. During VIO initialization, we align the orientation of the body frame in the ENU direction. When properly calibrated, the Earth’s magnetic field points in the north-down direction. First, the upward-pointing gravity direction is obtained from the accelerometer measurements. The cross product of the magnetic field and the gravity direction provides the east direction. The remaining axis can be obtained from the cross product of the estimated axes. This is a common procedure used in AHRS systems such as the Madgwick filter <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">madwick_filter</span>]</cite> and the complementary filter <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">complimentary_filter</span>]</cite>. Formulating the magnetometer residual directly in terms of Eq.  <a href="#S3.E4" title="In III-C IMU Preintegration ‣ III Visual-Inertial-Magnetometer Fusion ‣ Enhancing Visual Inertial SLAM with Magnetic Measurements" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> has one significant drawback that any error during the initial alignment is also included in the estimation process. Thus, we formulate the magnetometer residuals as relative orientation constraint between two consecutive frames.
For the magnetometer residual formulation, we assume that the magnetometer samples are calibrated following the procedure in  Section  <a href="#S3.SS5" title="III-E Soft and Hard Iron Effect Calibration ‣ III Visual-Inertial-Magnetometer Fusion ‣ Enhancing Visual Inertial SLAM with Magnetic Measurements" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-E</span></span></a>. Using the preintegrated orientation term allows us to use all magnetometer measurements between consecutive frames. Given the current consecutive frame state estimates <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{x}_{k}" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><msub id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml"><mi id="S3.SS4.p1.3.m3.1.1.2" xref="S3.SS4.p1.3.m3.1.1.2.cmml">𝐱</mi><mi id="S3.SS4.p1.3.m3.1.1.3" xref="S3.SS4.p1.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p1.3.m3.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2">𝐱</ci><ci id="S3.SS4.p1.3.m3.1.1.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">\mathbf{x}_{k}</annotation></semantics></math> and <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="\mathbf{x}_{k+1}" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><msub id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml"><mi id="S3.SS4.p1.4.m4.1.1.2" xref="S3.SS4.p1.4.m4.1.1.2.cmml">𝐱</mi><mrow id="S3.SS4.p1.4.m4.1.1.3" xref="S3.SS4.p1.4.m4.1.1.3.cmml"><mi id="S3.SS4.p1.4.m4.1.1.3.2" xref="S3.SS4.p1.4.m4.1.1.3.2.cmml">k</mi><mo id="S3.SS4.p1.4.m4.1.1.3.1" xref="S3.SS4.p1.4.m4.1.1.3.1.cmml">+</mo><mn id="S3.SS4.p1.4.m4.1.1.3.3" xref="S3.SS4.p1.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><apply id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.p1.4.m4.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2">𝐱</ci><apply id="S3.SS4.p1.4.m4.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3"><plus id="S3.SS4.p1.4.m4.1.1.3.1.cmml" xref="S3.SS4.p1.4.m4.1.1.3.1"></plus><ci id="S3.SS4.p1.4.m4.1.1.3.2.cmml" xref="S3.SS4.p1.4.m4.1.1.3.2">𝑘</ci><cn type="integer" id="S3.SS4.p1.4.m4.1.1.3.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">\mathbf{x}_{k+1}</annotation></semantics></math>, we define the magnetometer residual for measurement at time <math id="S3.SS4.p1.5.m5.2" class="ltx_Math" alttext="t_{j}\in(t_{k},t_{k+1}]" display="inline"><semantics id="S3.SS4.p1.5.m5.2a"><mrow id="S3.SS4.p1.5.m5.2.2" xref="S3.SS4.p1.5.m5.2.2.cmml"><msub id="S3.SS4.p1.5.m5.2.2.4" xref="S3.SS4.p1.5.m5.2.2.4.cmml"><mi id="S3.SS4.p1.5.m5.2.2.4.2" xref="S3.SS4.p1.5.m5.2.2.4.2.cmml">t</mi><mi id="S3.SS4.p1.5.m5.2.2.4.3" xref="S3.SS4.p1.5.m5.2.2.4.3.cmml">j</mi></msub><mo id="S3.SS4.p1.5.m5.2.2.3" xref="S3.SS4.p1.5.m5.2.2.3.cmml">∈</mo><mrow id="S3.SS4.p1.5.m5.2.2.2.2" xref="S3.SS4.p1.5.m5.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.p1.5.m5.2.2.2.2.3" xref="S3.SS4.p1.5.m5.2.2.2.3.cmml">(</mo><msub id="S3.SS4.p1.5.m5.1.1.1.1.1" xref="S3.SS4.p1.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS4.p1.5.m5.1.1.1.1.1.2" xref="S3.SS4.p1.5.m5.1.1.1.1.1.2.cmml">t</mi><mi id="S3.SS4.p1.5.m5.1.1.1.1.1.3" xref="S3.SS4.p1.5.m5.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS4.p1.5.m5.2.2.2.2.4" xref="S3.SS4.p1.5.m5.2.2.2.3.cmml">,</mo><msub id="S3.SS4.p1.5.m5.2.2.2.2.2" xref="S3.SS4.p1.5.m5.2.2.2.2.2.cmml"><mi id="S3.SS4.p1.5.m5.2.2.2.2.2.2" xref="S3.SS4.p1.5.m5.2.2.2.2.2.2.cmml">t</mi><mrow id="S3.SS4.p1.5.m5.2.2.2.2.2.3" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.cmml"><mi id="S3.SS4.p1.5.m5.2.2.2.2.2.3.2" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.2.cmml">k</mi><mo id="S3.SS4.p1.5.m5.2.2.2.2.2.3.1" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.1.cmml">+</mo><mn id="S3.SS4.p1.5.m5.2.2.2.2.2.3.3" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.SS4.p1.5.m5.2.2.2.2.5" xref="S3.SS4.p1.5.m5.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.2b"><apply id="S3.SS4.p1.5.m5.2.2.cmml" xref="S3.SS4.p1.5.m5.2.2"><in id="S3.SS4.p1.5.m5.2.2.3.cmml" xref="S3.SS4.p1.5.m5.2.2.3"></in><apply id="S3.SS4.p1.5.m5.2.2.4.cmml" xref="S3.SS4.p1.5.m5.2.2.4"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.2.2.4.1.cmml" xref="S3.SS4.p1.5.m5.2.2.4">subscript</csymbol><ci id="S3.SS4.p1.5.m5.2.2.4.2.cmml" xref="S3.SS4.p1.5.m5.2.2.4.2">𝑡</ci><ci id="S3.SS4.p1.5.m5.2.2.4.3.cmml" xref="S3.SS4.p1.5.m5.2.2.4.3">𝑗</ci></apply><interval closure="open-closed" id="S3.SS4.p1.5.m5.2.2.2.3.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2"><apply id="S3.SS4.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.2">𝑡</ci><ci id="S3.SS4.p1.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS4.p1.5.m5.2.2.2.2.2.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.2.2.2.2.2.1.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p1.5.m5.2.2.2.2.2.2.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.2">𝑡</ci><apply id="S3.SS4.p1.5.m5.2.2.2.2.2.3.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3"><plus id="S3.SS4.p1.5.m5.2.2.2.2.2.3.1.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.1"></plus><ci id="S3.SS4.p1.5.m5.2.2.2.2.2.3.2.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.2">𝑘</ci><cn type="integer" id="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.2c">t_{j}\in(t_{k},t_{k+1}]</annotation></semantics></math> as</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.2" class="ltx_Math" alttext="\mathbf{e_{m}}^{j,k}=\text{R}_{\text{BW}}^{k}\ \text{R}_{\text{WB}}^{k+1}\ {}_{\text{B}}\tilde{\mathbf{m}}^{k+1}-{}\Delta\text{R}_{k}^{j}\ {}_{\text{B}}\tilde{\mathbf{m}}^{j}" display="block"><semantics id="S3.E8.m1.2a"><mrow id="S3.E8.m1.2.3" xref="S3.E8.m1.2.3.cmml"><mmultiscripts id="S3.E8.m1.2.3.2" xref="S3.E8.m1.2.3.2.cmml"><mi id="S3.E8.m1.2.3.2.2.2" xref="S3.E8.m1.2.3.2.2.2.cmml">𝐞</mi><mi id="S3.E8.m1.2.3.2.2.3" xref="S3.E8.m1.2.3.2.2.3.cmml">𝐦</mi><mrow id="S3.E8.m1.2.3.2a" xref="S3.E8.m1.2.3.2.cmml"></mrow><mrow id="S3.E8.m1.2.3.2b" xref="S3.E8.m1.2.3.2.cmml"></mrow><mrow id="S3.E8.m1.2.2.2.4" xref="S3.E8.m1.2.2.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">j</mi><mo id="S3.E8.m1.2.2.2.4.1" xref="S3.E8.m1.2.2.2.3.cmml">,</mo><mi id="S3.E8.m1.2.2.2.2" xref="S3.E8.m1.2.2.2.2.cmml">k</mi></mrow></mmultiscripts><mo id="S3.E8.m1.2.3.1" xref="S3.E8.m1.2.3.1.cmml">=</mo><mrow id="S3.E8.m1.2.3.3" xref="S3.E8.m1.2.3.3.cmml"><mrow id="S3.E8.m1.2.3.3.2" xref="S3.E8.m1.2.3.3.2.cmml"><msubsup id="S3.E8.m1.2.3.3.2.2" xref="S3.E8.m1.2.3.3.2.2.cmml"><mtext id="S3.E8.m1.2.3.3.2.2.2.2" xref="S3.E8.m1.2.3.3.2.2.2.2a.cmml">R</mtext><mtext id="S3.E8.m1.2.3.3.2.2.2.3" xref="S3.E8.m1.2.3.3.2.2.2.3a.cmml">BW</mtext><mi id="S3.E8.m1.2.3.3.2.2.3" xref="S3.E8.m1.2.3.3.2.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.3.3.2.1" xref="S3.E8.m1.2.3.3.2.1.cmml">​</mo><msubsup id="S3.E8.m1.2.3.3.2.3" xref="S3.E8.m1.2.3.3.2.3.cmml"><mtext id="S3.E8.m1.2.3.3.2.3.2.2" xref="S3.E8.m1.2.3.3.2.3.2.2a.cmml">R</mtext><mtext id="S3.E8.m1.2.3.3.2.3.2.3" xref="S3.E8.m1.2.3.3.2.3.2.3a.cmml">WB</mtext><mrow id="S3.E8.m1.2.3.3.2.3.3" xref="S3.E8.m1.2.3.3.2.3.3.cmml"><mi id="S3.E8.m1.2.3.3.2.3.3.2" xref="S3.E8.m1.2.3.3.2.3.3.2.cmml">k</mi><mo id="S3.E8.m1.2.3.3.2.3.3.1" xref="S3.E8.m1.2.3.3.2.3.3.1.cmml">+</mo><mn id="S3.E8.m1.2.3.3.2.3.3.3" xref="S3.E8.m1.2.3.3.2.3.3.3.cmml">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.3.3.2.1a" xref="S3.E8.m1.2.3.3.2.1.cmml">​</mo><mmultiscripts id="S3.E8.m1.2.3.3.2.4" xref="S3.E8.m1.2.3.3.2.4.cmml"><mover accent="true" id="S3.E8.m1.2.3.3.2.4.2.2" xref="S3.E8.m1.2.3.3.2.4.2.2.cmml"><mi id="S3.E8.m1.2.3.3.2.4.2.2.2" xref="S3.E8.m1.2.3.3.2.4.2.2.2.cmml">𝐦</mi><mo id="S3.E8.m1.2.3.3.2.4.2.2.1" xref="S3.E8.m1.2.3.3.2.4.2.2.1.cmml">~</mo></mover><mrow id="S3.E8.m1.2.3.3.2.4a" xref="S3.E8.m1.2.3.3.2.4.cmml"></mrow><mrow id="S3.E8.m1.2.3.3.2.4.2.3" xref="S3.E8.m1.2.3.3.2.4.2.3.cmml"><mi id="S3.E8.m1.2.3.3.2.4.2.3.2" xref="S3.E8.m1.2.3.3.2.4.2.3.2.cmml">k</mi><mo id="S3.E8.m1.2.3.3.2.4.2.3.1" xref="S3.E8.m1.2.3.3.2.4.2.3.1.cmml">+</mo><mn id="S3.E8.m1.2.3.3.2.4.2.3.3" xref="S3.E8.m1.2.3.3.2.4.2.3.3.cmml">1</mn></mrow><mprescripts id="S3.E8.m1.2.3.3.2.4b" xref="S3.E8.m1.2.3.3.2.4.cmml"></mprescripts><mtext id="S3.E8.m1.2.3.3.2.4.3" xref="S3.E8.m1.2.3.3.2.4.3a.cmml">B</mtext><mrow id="S3.E8.m1.2.3.3.2.4c" xref="S3.E8.m1.2.3.3.2.4.cmml"></mrow></mmultiscripts></mrow><mo id="S3.E8.m1.2.3.3.1" xref="S3.E8.m1.2.3.3.1.cmml">−</mo><mrow id="S3.E8.m1.2.3.3.3" xref="S3.E8.m1.2.3.3.3.cmml"><mi mathvariant="normal" id="S3.E8.m1.2.3.3.3.2" xref="S3.E8.m1.2.3.3.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.3.3.3.1" xref="S3.E8.m1.2.3.3.3.1.cmml">​</mo><msubsup id="S3.E8.m1.2.3.3.3.3" xref="S3.E8.m1.2.3.3.3.3.cmml"><mtext id="S3.E8.m1.2.3.3.3.3.2.2" xref="S3.E8.m1.2.3.3.3.3.2.2a.cmml">R</mtext><mi id="S3.E8.m1.2.3.3.3.3.2.3" xref="S3.E8.m1.2.3.3.3.3.2.3.cmml">k</mi><mi id="S3.E8.m1.2.3.3.3.3.3" xref="S3.E8.m1.2.3.3.3.3.3.cmml">j</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.3.3.3.1a" xref="S3.E8.m1.2.3.3.3.1.cmml">​</mo><mmultiscripts id="S3.E8.m1.2.3.3.3.4" xref="S3.E8.m1.2.3.3.3.4.cmml"><mover accent="true" id="S3.E8.m1.2.3.3.3.4.2.2" xref="S3.E8.m1.2.3.3.3.4.2.2.cmml"><mi id="S3.E8.m1.2.3.3.3.4.2.2.2" xref="S3.E8.m1.2.3.3.3.4.2.2.2.cmml">𝐦</mi><mo id="S3.E8.m1.2.3.3.3.4.2.2.1" xref="S3.E8.m1.2.3.3.3.4.2.2.1.cmml">~</mo></mover><mrow id="S3.E8.m1.2.3.3.3.4a" xref="S3.E8.m1.2.3.3.3.4.cmml"></mrow><mi id="S3.E8.m1.2.3.3.3.4.2.3" xref="S3.E8.m1.2.3.3.3.4.2.3.cmml">j</mi><mprescripts id="S3.E8.m1.2.3.3.3.4b" xref="S3.E8.m1.2.3.3.3.4.cmml"></mprescripts><mtext id="S3.E8.m1.2.3.3.3.4.3" xref="S3.E8.m1.2.3.3.3.4.3a.cmml">B</mtext><mrow id="S3.E8.m1.2.3.3.3.4c" xref="S3.E8.m1.2.3.3.3.4.cmml"></mrow></mmultiscripts></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.2b"><apply id="S3.E8.m1.2.3.cmml" xref="S3.E8.m1.2.3"><eq id="S3.E8.m1.2.3.1.cmml" xref="S3.E8.m1.2.3.1"></eq><apply id="S3.E8.m1.2.3.2.cmml" xref="S3.E8.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.3.2.1.cmml" xref="S3.E8.m1.2.3.2">superscript</csymbol><apply id="S3.E8.m1.2.3.2.2.cmml" xref="S3.E8.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.3.2.2.1.cmml" xref="S3.E8.m1.2.3.2">subscript</csymbol><ci id="S3.E8.m1.2.3.2.2.2.cmml" xref="S3.E8.m1.2.3.2.2.2">𝐞</ci><ci id="S3.E8.m1.2.3.2.2.3.cmml" xref="S3.E8.m1.2.3.2.2.3">𝐦</ci></apply><list id="S3.E8.m1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.4"><ci id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">𝑗</ci><ci id="S3.E8.m1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2">𝑘</ci></list></apply><apply id="S3.E8.m1.2.3.3.cmml" xref="S3.E8.m1.2.3.3"><minus id="S3.E8.m1.2.3.3.1.cmml" xref="S3.E8.m1.2.3.3.1"></minus><apply id="S3.E8.m1.2.3.3.2.cmml" xref="S3.E8.m1.2.3.3.2"><times id="S3.E8.m1.2.3.3.2.1.cmml" xref="S3.E8.m1.2.3.3.2.1"></times><apply id="S3.E8.m1.2.3.3.2.2.cmml" xref="S3.E8.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.3.3.2.2.1.cmml" xref="S3.E8.m1.2.3.3.2.2">superscript</csymbol><apply id="S3.E8.m1.2.3.3.2.2.2.cmml" xref="S3.E8.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.3.3.2.2.2.1.cmml" xref="S3.E8.m1.2.3.3.2.2">subscript</csymbol><ci id="S3.E8.m1.2.3.3.2.2.2.2a.cmml" xref="S3.E8.m1.2.3.3.2.2.2.2"><mtext id="S3.E8.m1.2.3.3.2.2.2.2.cmml" xref="S3.E8.m1.2.3.3.2.2.2.2">R</mtext></ci><ci id="S3.E8.m1.2.3.3.2.2.2.3a.cmml" xref="S3.E8.m1.2.3.3.2.2.2.3"><mtext mathsize="70%" id="S3.E8.m1.2.3.3.2.2.2.3.cmml" xref="S3.E8.m1.2.3.3.2.2.2.3">BW</mtext></ci></apply><ci id="S3.E8.m1.2.3.3.2.2.3.cmml" xref="S3.E8.m1.2.3.3.2.2.3">𝑘</ci></apply><apply id="S3.E8.m1.2.3.3.2.3.cmml" xref="S3.E8.m1.2.3.3.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.3.3.2.3.1.cmml" xref="S3.E8.m1.2.3.3.2.3">superscript</csymbol><apply id="S3.E8.m1.2.3.3.2.3.2.cmml" xref="S3.E8.m1.2.3.3.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.3.3.2.3.2.1.cmml" xref="S3.E8.m1.2.3.3.2.3">subscript</csymbol><ci id="S3.E8.m1.2.3.3.2.3.2.2a.cmml" xref="S3.E8.m1.2.3.3.2.3.2.2"><mtext id="S3.E8.m1.2.3.3.2.3.2.2.cmml" xref="S3.E8.m1.2.3.3.2.3.2.2">R</mtext></ci><ci id="S3.E8.m1.2.3.3.2.3.2.3a.cmml" xref="S3.E8.m1.2.3.3.2.3.2.3"><mtext mathsize="70%" id="S3.E8.m1.2.3.3.2.3.2.3.cmml" xref="S3.E8.m1.2.3.3.2.3.2.3">WB</mtext></ci></apply><apply id="S3.E8.m1.2.3.3.2.3.3.cmml" xref="S3.E8.m1.2.3.3.2.3.3"><plus id="S3.E8.m1.2.3.3.2.3.3.1.cmml" xref="S3.E8.m1.2.3.3.2.3.3.1"></plus><ci id="S3.E8.m1.2.3.3.2.3.3.2.cmml" xref="S3.E8.m1.2.3.3.2.3.3.2">𝑘</ci><cn type="integer" id="S3.E8.m1.2.3.3.2.3.3.3.cmml" xref="S3.E8.m1.2.3.3.2.3.3.3">1</cn></apply></apply><apply id="S3.E8.m1.2.3.3.2.4.cmml" xref="S3.E8.m1.2.3.3.2.4"><csymbol cd="ambiguous" id="S3.E8.m1.2.3.3.2.4.1.cmml" xref="S3.E8.m1.2.3.3.2.4">subscript</csymbol><apply id="S3.E8.m1.2.3.3.2.4.2.cmml" xref="S3.E8.m1.2.3.3.2.4"><csymbol cd="ambiguous" id="S3.E8.m1.2.3.3.2.4.2.1.cmml" xref="S3.E8.m1.2.3.3.2.4">superscript</csymbol><apply id="S3.E8.m1.2.3.3.2.4.2.2.cmml" xref="S3.E8.m1.2.3.3.2.4.2.2"><ci id="S3.E8.m1.2.3.3.2.4.2.2.1.cmml" xref="S3.E8.m1.2.3.3.2.4.2.2.1">~</ci><ci id="S3.E8.m1.2.3.3.2.4.2.2.2.cmml" xref="S3.E8.m1.2.3.3.2.4.2.2.2">𝐦</ci></apply><apply id="S3.E8.m1.2.3.3.2.4.2.3.cmml" xref="S3.E8.m1.2.3.3.2.4.2.3"><plus id="S3.E8.m1.2.3.3.2.4.2.3.1.cmml" xref="S3.E8.m1.2.3.3.2.4.2.3.1"></plus><ci id="S3.E8.m1.2.3.3.2.4.2.3.2.cmml" xref="S3.E8.m1.2.3.3.2.4.2.3.2">𝑘</ci><cn type="integer" id="S3.E8.m1.2.3.3.2.4.2.3.3.cmml" xref="S3.E8.m1.2.3.3.2.4.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.2.3.3.2.4.3a.cmml" xref="S3.E8.m1.2.3.3.2.4.3"><mtext mathsize="70%" id="S3.E8.m1.2.3.3.2.4.3.cmml" xref="S3.E8.m1.2.3.3.2.4.3">B</mtext></ci></apply></apply><apply id="S3.E8.m1.2.3.3.3.cmml" xref="S3.E8.m1.2.3.3.3"><times id="S3.E8.m1.2.3.3.3.1.cmml" xref="S3.E8.m1.2.3.3.3.1"></times><ci id="S3.E8.m1.2.3.3.3.2.cmml" xref="S3.E8.m1.2.3.3.3.2">Δ</ci><apply id="S3.E8.m1.2.3.3.3.3.cmml" xref="S3.E8.m1.2.3.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.3.3.3.3.1.cmml" xref="S3.E8.m1.2.3.3.3.3">superscript</csymbol><apply id="S3.E8.m1.2.3.3.3.3.2.cmml" xref="S3.E8.m1.2.3.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.3.3.3.3.2.1.cmml" xref="S3.E8.m1.2.3.3.3.3">subscript</csymbol><ci id="S3.E8.m1.2.3.3.3.3.2.2a.cmml" xref="S3.E8.m1.2.3.3.3.3.2.2"><mtext id="S3.E8.m1.2.3.3.3.3.2.2.cmml" xref="S3.E8.m1.2.3.3.3.3.2.2">R</mtext></ci><ci id="S3.E8.m1.2.3.3.3.3.2.3.cmml" xref="S3.E8.m1.2.3.3.3.3.2.3">𝑘</ci></apply><ci id="S3.E8.m1.2.3.3.3.3.3.cmml" xref="S3.E8.m1.2.3.3.3.3.3">𝑗</ci></apply><apply id="S3.E8.m1.2.3.3.3.4.cmml" xref="S3.E8.m1.2.3.3.3.4"><csymbol cd="ambiguous" id="S3.E8.m1.2.3.3.3.4.1.cmml" xref="S3.E8.m1.2.3.3.3.4">subscript</csymbol><apply id="S3.E8.m1.2.3.3.3.4.2.cmml" xref="S3.E8.m1.2.3.3.3.4"><csymbol cd="ambiguous" id="S3.E8.m1.2.3.3.3.4.2.1.cmml" xref="S3.E8.m1.2.3.3.3.4">superscript</csymbol><apply id="S3.E8.m1.2.3.3.3.4.2.2.cmml" xref="S3.E8.m1.2.3.3.3.4.2.2"><ci id="S3.E8.m1.2.3.3.3.4.2.2.1.cmml" xref="S3.E8.m1.2.3.3.3.4.2.2.1">~</ci><ci id="S3.E8.m1.2.3.3.3.4.2.2.2.cmml" xref="S3.E8.m1.2.3.3.3.4.2.2.2">𝐦</ci></apply><ci id="S3.E8.m1.2.3.3.3.4.2.3.cmml" xref="S3.E8.m1.2.3.3.3.4.2.3">𝑗</ci></apply><ci id="S3.E8.m1.2.3.3.3.4.3a.cmml" xref="S3.E8.m1.2.3.3.3.4.3"><mtext mathsize="70%" id="S3.E8.m1.2.3.3.3.4.3.cmml" xref="S3.E8.m1.2.3.3.3.4.3">B</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.2c">\mathbf{e_{m}}^{j,k}=\text{R}_{\text{BW}}^{k}\ \text{R}_{\text{WB}}^{k+1}\ {}_{\text{B}}\tilde{\mathbf{m}}^{k+1}-{}\Delta\text{R}_{k}^{j}\ {}_{\text{B}}\tilde{\mathbf{m}}^{j}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.20" class="ltx_p">where <math id="S3.SS4.p1.6.m1.1" class="ltx_Math" alttext="\Delta\text{R}_{k}^{j}" display="inline"><semantics id="S3.SS4.p1.6.m1.1a"><mrow id="S3.SS4.p1.6.m1.1.1" xref="S3.SS4.p1.6.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS4.p1.6.m1.1.1.2" xref="S3.SS4.p1.6.m1.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.6.m1.1.1.1" xref="S3.SS4.p1.6.m1.1.1.1.cmml">​</mo><msubsup id="S3.SS4.p1.6.m1.1.1.3" xref="S3.SS4.p1.6.m1.1.1.3.cmml"><mtext id="S3.SS4.p1.6.m1.1.1.3.2.2" xref="S3.SS4.p1.6.m1.1.1.3.2.2a.cmml">R</mtext><mi id="S3.SS4.p1.6.m1.1.1.3.2.3" xref="S3.SS4.p1.6.m1.1.1.3.2.3.cmml">k</mi><mi id="S3.SS4.p1.6.m1.1.1.3.3" xref="S3.SS4.p1.6.m1.1.1.3.3.cmml">j</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m1.1b"><apply id="S3.SS4.p1.6.m1.1.1.cmml" xref="S3.SS4.p1.6.m1.1.1"><times id="S3.SS4.p1.6.m1.1.1.1.cmml" xref="S3.SS4.p1.6.m1.1.1.1"></times><ci id="S3.SS4.p1.6.m1.1.1.2.cmml" xref="S3.SS4.p1.6.m1.1.1.2">Δ</ci><apply id="S3.SS4.p1.6.m1.1.1.3.cmml" xref="S3.SS4.p1.6.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m1.1.1.3.1.cmml" xref="S3.SS4.p1.6.m1.1.1.3">superscript</csymbol><apply id="S3.SS4.p1.6.m1.1.1.3.2.cmml" xref="S3.SS4.p1.6.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m1.1.1.3.2.1.cmml" xref="S3.SS4.p1.6.m1.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.6.m1.1.1.3.2.2a.cmml" xref="S3.SS4.p1.6.m1.1.1.3.2.2"><mtext id="S3.SS4.p1.6.m1.1.1.3.2.2.cmml" xref="S3.SS4.p1.6.m1.1.1.3.2.2">R</mtext></ci><ci id="S3.SS4.p1.6.m1.1.1.3.2.3.cmml" xref="S3.SS4.p1.6.m1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.SS4.p1.6.m1.1.1.3.3.cmml" xref="S3.SS4.p1.6.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m1.1c">\Delta\text{R}_{k}^{j}</annotation></semantics></math> is the propagated orientation between the time interval <math id="S3.SS4.p1.7.m2.2" class="ltx_Math" alttext="[t_{k},t_{j}]" display="inline"><semantics id="S3.SS4.p1.7.m2.2a"><mrow id="S3.SS4.p1.7.m2.2.2.2" xref="S3.SS4.p1.7.m2.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.p1.7.m2.2.2.2.3" xref="S3.SS4.p1.7.m2.2.2.3.cmml">[</mo><msub id="S3.SS4.p1.7.m2.1.1.1.1" xref="S3.SS4.p1.7.m2.1.1.1.1.cmml"><mi id="S3.SS4.p1.7.m2.1.1.1.1.2" xref="S3.SS4.p1.7.m2.1.1.1.1.2.cmml">t</mi><mi id="S3.SS4.p1.7.m2.1.1.1.1.3" xref="S3.SS4.p1.7.m2.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS4.p1.7.m2.2.2.2.4" xref="S3.SS4.p1.7.m2.2.2.3.cmml">,</mo><msub id="S3.SS4.p1.7.m2.2.2.2.2" xref="S3.SS4.p1.7.m2.2.2.2.2.cmml"><mi id="S3.SS4.p1.7.m2.2.2.2.2.2" xref="S3.SS4.p1.7.m2.2.2.2.2.2.cmml">t</mi><mi id="S3.SS4.p1.7.m2.2.2.2.2.3" xref="S3.SS4.p1.7.m2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS4.p1.7.m2.2.2.2.5" xref="S3.SS4.p1.7.m2.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m2.2b"><interval closure="closed" id="S3.SS4.p1.7.m2.2.2.3.cmml" xref="S3.SS4.p1.7.m2.2.2.2"><apply id="S3.SS4.p1.7.m2.1.1.1.1.cmml" xref="S3.SS4.p1.7.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m2.1.1.1.1.1.cmml" xref="S3.SS4.p1.7.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.7.m2.1.1.1.1.2.cmml" xref="S3.SS4.p1.7.m2.1.1.1.1.2">𝑡</ci><ci id="S3.SS4.p1.7.m2.1.1.1.1.3.cmml" xref="S3.SS4.p1.7.m2.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS4.p1.7.m2.2.2.2.2.cmml" xref="S3.SS4.p1.7.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m2.2.2.2.2.1.cmml" xref="S3.SS4.p1.7.m2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p1.7.m2.2.2.2.2.2.cmml" xref="S3.SS4.p1.7.m2.2.2.2.2.2">𝑡</ci><ci id="S3.SS4.p1.7.m2.2.2.2.2.3.cmml" xref="S3.SS4.p1.7.m2.2.2.2.2.3">𝑗</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m2.2c">[t_{k},t_{j}]</annotation></semantics></math> and transforms the magnetometer measurement from time <math id="S3.SS4.p1.8.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS4.p1.8.m3.1a"><mi id="S3.SS4.p1.8.m3.1.1" xref="S3.SS4.p1.8.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m3.1b"><ci id="S3.SS4.p1.8.m3.1.1.cmml" xref="S3.SS4.p1.8.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m3.1c">j</annotation></semantics></math> to <math id="S3.SS4.p1.9.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS4.p1.9.m4.1a"><mi id="S3.SS4.p1.9.m4.1.1" xref="S3.SS4.p1.9.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.9.m4.1b"><ci id="S3.SS4.p1.9.m4.1.1.cmml" xref="S3.SS4.p1.9.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.9.m4.1c">k</annotation></semantics></math>. This propagated orientation is the rotation matrix representation of the intermediate preintegration result <math id="S3.SS4.p1.10.m5.1" class="ltx_Math" alttext="\boldsymbol{\gamma}_{k}^{j}" display="inline"><semantics id="S3.SS4.p1.10.m5.1a"><msubsup id="S3.SS4.p1.10.m5.1.1" xref="S3.SS4.p1.10.m5.1.1.cmml"><mi id="S3.SS4.p1.10.m5.1.1.2.2" xref="S3.SS4.p1.10.m5.1.1.2.2.cmml">𝜸</mi><mi id="S3.SS4.p1.10.m5.1.1.2.3" xref="S3.SS4.p1.10.m5.1.1.2.3.cmml">k</mi><mi id="S3.SS4.p1.10.m5.1.1.3" xref="S3.SS4.p1.10.m5.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.10.m5.1b"><apply id="S3.SS4.p1.10.m5.1.1.cmml" xref="S3.SS4.p1.10.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.10.m5.1.1.1.cmml" xref="S3.SS4.p1.10.m5.1.1">superscript</csymbol><apply id="S3.SS4.p1.10.m5.1.1.2.cmml" xref="S3.SS4.p1.10.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.10.m5.1.1.2.1.cmml" xref="S3.SS4.p1.10.m5.1.1">subscript</csymbol><ci id="S3.SS4.p1.10.m5.1.1.2.2.cmml" xref="S3.SS4.p1.10.m5.1.1.2.2">𝜸</ci><ci id="S3.SS4.p1.10.m5.1.1.2.3.cmml" xref="S3.SS4.p1.10.m5.1.1.2.3">𝑘</ci></apply><ci id="S3.SS4.p1.10.m5.1.1.3.cmml" xref="S3.SS4.p1.10.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.10.m5.1c">\boldsymbol{\gamma}_{k}^{j}</annotation></semantics></math>. Rotation <math id="S3.SS4.p1.11.m6.1" class="ltx_Math" alttext="\text{R}_{\text{BW}}^{k}\ \text{R}_{\text{WB}}^{k+1}" display="inline"><semantics id="S3.SS4.p1.11.m6.1a"><mrow id="S3.SS4.p1.11.m6.1.1" xref="S3.SS4.p1.11.m6.1.1.cmml"><msubsup id="S3.SS4.p1.11.m6.1.1.2" xref="S3.SS4.p1.11.m6.1.1.2.cmml"><mtext id="S3.SS4.p1.11.m6.1.1.2.2.2" xref="S3.SS4.p1.11.m6.1.1.2.2.2a.cmml">R</mtext><mtext id="S3.SS4.p1.11.m6.1.1.2.2.3" xref="S3.SS4.p1.11.m6.1.1.2.2.3a.cmml">BW</mtext><mi id="S3.SS4.p1.11.m6.1.1.2.3" xref="S3.SS4.p1.11.m6.1.1.2.3.cmml">k</mi></msubsup><mo lspace="0.500em" rspace="0em" id="S3.SS4.p1.11.m6.1.1.1" xref="S3.SS4.p1.11.m6.1.1.1.cmml">​</mo><msubsup id="S3.SS4.p1.11.m6.1.1.3" xref="S3.SS4.p1.11.m6.1.1.3.cmml"><mtext id="S3.SS4.p1.11.m6.1.1.3.2.2" xref="S3.SS4.p1.11.m6.1.1.3.2.2a.cmml">R</mtext><mtext id="S3.SS4.p1.11.m6.1.1.3.2.3" xref="S3.SS4.p1.11.m6.1.1.3.2.3a.cmml">WB</mtext><mrow id="S3.SS4.p1.11.m6.1.1.3.3" xref="S3.SS4.p1.11.m6.1.1.3.3.cmml"><mi id="S3.SS4.p1.11.m6.1.1.3.3.2" xref="S3.SS4.p1.11.m6.1.1.3.3.2.cmml">k</mi><mo id="S3.SS4.p1.11.m6.1.1.3.3.1" xref="S3.SS4.p1.11.m6.1.1.3.3.1.cmml">+</mo><mn id="S3.SS4.p1.11.m6.1.1.3.3.3" xref="S3.SS4.p1.11.m6.1.1.3.3.3.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.11.m6.1b"><apply id="S3.SS4.p1.11.m6.1.1.cmml" xref="S3.SS4.p1.11.m6.1.1"><times id="S3.SS4.p1.11.m6.1.1.1.cmml" xref="S3.SS4.p1.11.m6.1.1.1"></times><apply id="S3.SS4.p1.11.m6.1.1.2.cmml" xref="S3.SS4.p1.11.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m6.1.1.2.1.cmml" xref="S3.SS4.p1.11.m6.1.1.2">superscript</csymbol><apply id="S3.SS4.p1.11.m6.1.1.2.2.cmml" xref="S3.SS4.p1.11.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m6.1.1.2.2.1.cmml" xref="S3.SS4.p1.11.m6.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.11.m6.1.1.2.2.2a.cmml" xref="S3.SS4.p1.11.m6.1.1.2.2.2"><mtext id="S3.SS4.p1.11.m6.1.1.2.2.2.cmml" xref="S3.SS4.p1.11.m6.1.1.2.2.2">R</mtext></ci><ci id="S3.SS4.p1.11.m6.1.1.2.2.3a.cmml" xref="S3.SS4.p1.11.m6.1.1.2.2.3"><mtext mathsize="70%" id="S3.SS4.p1.11.m6.1.1.2.2.3.cmml" xref="S3.SS4.p1.11.m6.1.1.2.2.3">BW</mtext></ci></apply><ci id="S3.SS4.p1.11.m6.1.1.2.3.cmml" xref="S3.SS4.p1.11.m6.1.1.2.3">𝑘</ci></apply><apply id="S3.SS4.p1.11.m6.1.1.3.cmml" xref="S3.SS4.p1.11.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m6.1.1.3.1.cmml" xref="S3.SS4.p1.11.m6.1.1.3">superscript</csymbol><apply id="S3.SS4.p1.11.m6.1.1.3.2.cmml" xref="S3.SS4.p1.11.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m6.1.1.3.2.1.cmml" xref="S3.SS4.p1.11.m6.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.11.m6.1.1.3.2.2a.cmml" xref="S3.SS4.p1.11.m6.1.1.3.2.2"><mtext id="S3.SS4.p1.11.m6.1.1.3.2.2.cmml" xref="S3.SS4.p1.11.m6.1.1.3.2.2">R</mtext></ci><ci id="S3.SS4.p1.11.m6.1.1.3.2.3a.cmml" xref="S3.SS4.p1.11.m6.1.1.3.2.3"><mtext mathsize="70%" id="S3.SS4.p1.11.m6.1.1.3.2.3.cmml" xref="S3.SS4.p1.11.m6.1.1.3.2.3">WB</mtext></ci></apply><apply id="S3.SS4.p1.11.m6.1.1.3.3.cmml" xref="S3.SS4.p1.11.m6.1.1.3.3"><plus id="S3.SS4.p1.11.m6.1.1.3.3.1.cmml" xref="S3.SS4.p1.11.m6.1.1.3.3.1"></plus><ci id="S3.SS4.p1.11.m6.1.1.3.3.2.cmml" xref="S3.SS4.p1.11.m6.1.1.3.3.2">𝑘</ci><cn type="integer" id="S3.SS4.p1.11.m6.1.1.3.3.3.cmml" xref="S3.SS4.p1.11.m6.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.11.m6.1c">\text{R}_{\text{BW}}^{k}\ \text{R}_{\text{WB}}^{k+1}</annotation></semantics></math> represents relative orientation during the time interval <math id="S3.SS4.p1.12.m7.2" class="ltx_Math" alttext="[t_{k},t_{k+1}]" display="inline"><semantics id="S3.SS4.p1.12.m7.2a"><mrow id="S3.SS4.p1.12.m7.2.2.2" xref="S3.SS4.p1.12.m7.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.p1.12.m7.2.2.2.3" xref="S3.SS4.p1.12.m7.2.2.3.cmml">[</mo><msub id="S3.SS4.p1.12.m7.1.1.1.1" xref="S3.SS4.p1.12.m7.1.1.1.1.cmml"><mi id="S3.SS4.p1.12.m7.1.1.1.1.2" xref="S3.SS4.p1.12.m7.1.1.1.1.2.cmml">t</mi><mi id="S3.SS4.p1.12.m7.1.1.1.1.3" xref="S3.SS4.p1.12.m7.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS4.p1.12.m7.2.2.2.4" xref="S3.SS4.p1.12.m7.2.2.3.cmml">,</mo><msub id="S3.SS4.p1.12.m7.2.2.2.2" xref="S3.SS4.p1.12.m7.2.2.2.2.cmml"><mi id="S3.SS4.p1.12.m7.2.2.2.2.2" xref="S3.SS4.p1.12.m7.2.2.2.2.2.cmml">t</mi><mrow id="S3.SS4.p1.12.m7.2.2.2.2.3" xref="S3.SS4.p1.12.m7.2.2.2.2.3.cmml"><mi id="S3.SS4.p1.12.m7.2.2.2.2.3.2" xref="S3.SS4.p1.12.m7.2.2.2.2.3.2.cmml">k</mi><mo id="S3.SS4.p1.12.m7.2.2.2.2.3.1" xref="S3.SS4.p1.12.m7.2.2.2.2.3.1.cmml">+</mo><mn id="S3.SS4.p1.12.m7.2.2.2.2.3.3" xref="S3.SS4.p1.12.m7.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.SS4.p1.12.m7.2.2.2.5" xref="S3.SS4.p1.12.m7.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.12.m7.2b"><interval closure="closed" id="S3.SS4.p1.12.m7.2.2.3.cmml" xref="S3.SS4.p1.12.m7.2.2.2"><apply id="S3.SS4.p1.12.m7.1.1.1.1.cmml" xref="S3.SS4.p1.12.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.12.m7.1.1.1.1.1.cmml" xref="S3.SS4.p1.12.m7.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.12.m7.1.1.1.1.2.cmml" xref="S3.SS4.p1.12.m7.1.1.1.1.2">𝑡</ci><ci id="S3.SS4.p1.12.m7.1.1.1.1.3.cmml" xref="S3.SS4.p1.12.m7.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS4.p1.12.m7.2.2.2.2.cmml" xref="S3.SS4.p1.12.m7.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.12.m7.2.2.2.2.1.cmml" xref="S3.SS4.p1.12.m7.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p1.12.m7.2.2.2.2.2.cmml" xref="S3.SS4.p1.12.m7.2.2.2.2.2">𝑡</ci><apply id="S3.SS4.p1.12.m7.2.2.2.2.3.cmml" xref="S3.SS4.p1.12.m7.2.2.2.2.3"><plus id="S3.SS4.p1.12.m7.2.2.2.2.3.1.cmml" xref="S3.SS4.p1.12.m7.2.2.2.2.3.1"></plus><ci id="S3.SS4.p1.12.m7.2.2.2.2.3.2.cmml" xref="S3.SS4.p1.12.m7.2.2.2.2.3.2">𝑘</ci><cn type="integer" id="S3.SS4.p1.12.m7.2.2.2.2.3.3.cmml" xref="S3.SS4.p1.12.m7.2.2.2.2.3.3">1</cn></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.12.m7.2c">[t_{k},t_{k+1}]</annotation></semantics></math> in the body frame <math id="S3.SS4.p1.13.m8.1" class="ltx_Math" alttext="\text{B}_{k}" display="inline"><semantics id="S3.SS4.p1.13.m8.1a"><msub id="S3.SS4.p1.13.m8.1.1" xref="S3.SS4.p1.13.m8.1.1.cmml"><mtext id="S3.SS4.p1.13.m8.1.1.2" xref="S3.SS4.p1.13.m8.1.1.2a.cmml">B</mtext><mi id="S3.SS4.p1.13.m8.1.1.3" xref="S3.SS4.p1.13.m8.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.13.m8.1b"><apply id="S3.SS4.p1.13.m8.1.1.cmml" xref="S3.SS4.p1.13.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.13.m8.1.1.1.cmml" xref="S3.SS4.p1.13.m8.1.1">subscript</csymbol><ci id="S3.SS4.p1.13.m8.1.1.2a.cmml" xref="S3.SS4.p1.13.m8.1.1.2"><mtext id="S3.SS4.p1.13.m8.1.1.2.cmml" xref="S3.SS4.p1.13.m8.1.1.2">B</mtext></ci><ci id="S3.SS4.p1.13.m8.1.1.3.cmml" xref="S3.SS4.p1.13.m8.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.13.m8.1c">\text{B}_{k}</annotation></semantics></math> and transforms the magnetometer measurement from time <math id="S3.SS4.p1.14.m9.1" class="ltx_Math" alttext="t_{k+1}" display="inline"><semantics id="S3.SS4.p1.14.m9.1a"><msub id="S3.SS4.p1.14.m9.1.1" xref="S3.SS4.p1.14.m9.1.1.cmml"><mi id="S3.SS4.p1.14.m9.1.1.2" xref="S3.SS4.p1.14.m9.1.1.2.cmml">t</mi><mrow id="S3.SS4.p1.14.m9.1.1.3" xref="S3.SS4.p1.14.m9.1.1.3.cmml"><mi id="S3.SS4.p1.14.m9.1.1.3.2" xref="S3.SS4.p1.14.m9.1.1.3.2.cmml">k</mi><mo id="S3.SS4.p1.14.m9.1.1.3.1" xref="S3.SS4.p1.14.m9.1.1.3.1.cmml">+</mo><mn id="S3.SS4.p1.14.m9.1.1.3.3" xref="S3.SS4.p1.14.m9.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.14.m9.1b"><apply id="S3.SS4.p1.14.m9.1.1.cmml" xref="S3.SS4.p1.14.m9.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.14.m9.1.1.1.cmml" xref="S3.SS4.p1.14.m9.1.1">subscript</csymbol><ci id="S3.SS4.p1.14.m9.1.1.2.cmml" xref="S3.SS4.p1.14.m9.1.1.2">𝑡</ci><apply id="S3.SS4.p1.14.m9.1.1.3.cmml" xref="S3.SS4.p1.14.m9.1.1.3"><plus id="S3.SS4.p1.14.m9.1.1.3.1.cmml" xref="S3.SS4.p1.14.m9.1.1.3.1"></plus><ci id="S3.SS4.p1.14.m9.1.1.3.2.cmml" xref="S3.SS4.p1.14.m9.1.1.3.2">𝑘</ci><cn type="integer" id="S3.SS4.p1.14.m9.1.1.3.3.cmml" xref="S3.SS4.p1.14.m9.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.14.m9.1c">t_{k+1}</annotation></semantics></math> to <math id="S3.SS4.p1.15.m10.1" class="ltx_Math" alttext="t_{k}" display="inline"><semantics id="S3.SS4.p1.15.m10.1a"><msub id="S3.SS4.p1.15.m10.1.1" xref="S3.SS4.p1.15.m10.1.1.cmml"><mi id="S3.SS4.p1.15.m10.1.1.2" xref="S3.SS4.p1.15.m10.1.1.2.cmml">t</mi><mi id="S3.SS4.p1.15.m10.1.1.3" xref="S3.SS4.p1.15.m10.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.15.m10.1b"><apply id="S3.SS4.p1.15.m10.1.1.cmml" xref="S3.SS4.p1.15.m10.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.15.m10.1.1.1.cmml" xref="S3.SS4.p1.15.m10.1.1">subscript</csymbol><ci id="S3.SS4.p1.15.m10.1.1.2.cmml" xref="S3.SS4.p1.15.m10.1.1.2">𝑡</ci><ci id="S3.SS4.p1.15.m10.1.1.3.cmml" xref="S3.SS4.p1.15.m10.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.15.m10.1c">t_{k}</annotation></semantics></math>. By expressing the error term in the body frame, we can recursively calculate <math id="S3.SS4.p1.16.m11.1" class="ltx_Math" alttext="\boldsymbol{\gamma}_{k}^{j}" display="inline"><semantics id="S3.SS4.p1.16.m11.1a"><msubsup id="S3.SS4.p1.16.m11.1.1" xref="S3.SS4.p1.16.m11.1.1.cmml"><mi id="S3.SS4.p1.16.m11.1.1.2.2" xref="S3.SS4.p1.16.m11.1.1.2.2.cmml">𝜸</mi><mi id="S3.SS4.p1.16.m11.1.1.2.3" xref="S3.SS4.p1.16.m11.1.1.2.3.cmml">k</mi><mi id="S3.SS4.p1.16.m11.1.1.3" xref="S3.SS4.p1.16.m11.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.16.m11.1b"><apply id="S3.SS4.p1.16.m11.1.1.cmml" xref="S3.SS4.p1.16.m11.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.16.m11.1.1.1.cmml" xref="S3.SS4.p1.16.m11.1.1">superscript</csymbol><apply id="S3.SS4.p1.16.m11.1.1.2.cmml" xref="S3.SS4.p1.16.m11.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.16.m11.1.1.2.1.cmml" xref="S3.SS4.p1.16.m11.1.1">subscript</csymbol><ci id="S3.SS4.p1.16.m11.1.1.2.2.cmml" xref="S3.SS4.p1.16.m11.1.1.2.2">𝜸</ci><ci id="S3.SS4.p1.16.m11.1.1.2.3.cmml" xref="S3.SS4.p1.16.m11.1.1.2.3">𝑘</ci></apply><ci id="S3.SS4.p1.16.m11.1.1.3.cmml" xref="S3.SS4.p1.16.m11.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.16.m11.1c">\boldsymbol{\gamma}_{k}^{j}</annotation></semantics></math> efficiently as <math id="S3.SS4.p1.17.m12.1" class="ltx_Math" alttext="t_{j}&lt;t_{k+1}" display="inline"><semantics id="S3.SS4.p1.17.m12.1a"><mrow id="S3.SS4.p1.17.m12.1.1" xref="S3.SS4.p1.17.m12.1.1.cmml"><msub id="S3.SS4.p1.17.m12.1.1.2" xref="S3.SS4.p1.17.m12.1.1.2.cmml"><mi id="S3.SS4.p1.17.m12.1.1.2.2" xref="S3.SS4.p1.17.m12.1.1.2.2.cmml">t</mi><mi id="S3.SS4.p1.17.m12.1.1.2.3" xref="S3.SS4.p1.17.m12.1.1.2.3.cmml">j</mi></msub><mo id="S3.SS4.p1.17.m12.1.1.1" xref="S3.SS4.p1.17.m12.1.1.1.cmml">&lt;</mo><msub id="S3.SS4.p1.17.m12.1.1.3" xref="S3.SS4.p1.17.m12.1.1.3.cmml"><mi id="S3.SS4.p1.17.m12.1.1.3.2" xref="S3.SS4.p1.17.m12.1.1.3.2.cmml">t</mi><mrow id="S3.SS4.p1.17.m12.1.1.3.3" xref="S3.SS4.p1.17.m12.1.1.3.3.cmml"><mi id="S3.SS4.p1.17.m12.1.1.3.3.2" xref="S3.SS4.p1.17.m12.1.1.3.3.2.cmml">k</mi><mo id="S3.SS4.p1.17.m12.1.1.3.3.1" xref="S3.SS4.p1.17.m12.1.1.3.3.1.cmml">+</mo><mn id="S3.SS4.p1.17.m12.1.1.3.3.3" xref="S3.SS4.p1.17.m12.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.17.m12.1b"><apply id="S3.SS4.p1.17.m12.1.1.cmml" xref="S3.SS4.p1.17.m12.1.1"><lt id="S3.SS4.p1.17.m12.1.1.1.cmml" xref="S3.SS4.p1.17.m12.1.1.1"></lt><apply id="S3.SS4.p1.17.m12.1.1.2.cmml" xref="S3.SS4.p1.17.m12.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.17.m12.1.1.2.1.cmml" xref="S3.SS4.p1.17.m12.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.17.m12.1.1.2.2.cmml" xref="S3.SS4.p1.17.m12.1.1.2.2">𝑡</ci><ci id="S3.SS4.p1.17.m12.1.1.2.3.cmml" xref="S3.SS4.p1.17.m12.1.1.2.3">𝑗</ci></apply><apply id="S3.SS4.p1.17.m12.1.1.3.cmml" xref="S3.SS4.p1.17.m12.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.17.m12.1.1.3.1.cmml" xref="S3.SS4.p1.17.m12.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.17.m12.1.1.3.2.cmml" xref="S3.SS4.p1.17.m12.1.1.3.2">𝑡</ci><apply id="S3.SS4.p1.17.m12.1.1.3.3.cmml" xref="S3.SS4.p1.17.m12.1.1.3.3"><plus id="S3.SS4.p1.17.m12.1.1.3.3.1.cmml" xref="S3.SS4.p1.17.m12.1.1.3.3.1"></plus><ci id="S3.SS4.p1.17.m12.1.1.3.3.2.cmml" xref="S3.SS4.p1.17.m12.1.1.3.3.2">𝑘</ci><cn type="integer" id="S3.SS4.p1.17.m12.1.1.3.3.3.cmml" xref="S3.SS4.p1.17.m12.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.17.m12.1c">t_{j}&lt;t_{k+1}</annotation></semantics></math>. Thus, the magnetometer error using preintegrated orientation allows us to use all the magnetometer measurements in the time interval <math id="S3.SS4.p1.18.m13.2" class="ltx_Math" alttext="(k,k+1]" display="inline"><semantics id="S3.SS4.p1.18.m13.2a"><mrow id="S3.SS4.p1.18.m13.2.2.1" xref="S3.SS4.p1.18.m13.2.2.2.cmml"><mo stretchy="false" id="S3.SS4.p1.18.m13.2.2.1.2" xref="S3.SS4.p1.18.m13.2.2.2.cmml">(</mo><mi id="S3.SS4.p1.18.m13.1.1" xref="S3.SS4.p1.18.m13.1.1.cmml">k</mi><mo id="S3.SS4.p1.18.m13.2.2.1.3" xref="S3.SS4.p1.18.m13.2.2.2.cmml">,</mo><mrow id="S3.SS4.p1.18.m13.2.2.1.1" xref="S3.SS4.p1.18.m13.2.2.1.1.cmml"><mi id="S3.SS4.p1.18.m13.2.2.1.1.2" xref="S3.SS4.p1.18.m13.2.2.1.1.2.cmml">k</mi><mo id="S3.SS4.p1.18.m13.2.2.1.1.1" xref="S3.SS4.p1.18.m13.2.2.1.1.1.cmml">+</mo><mn id="S3.SS4.p1.18.m13.2.2.1.1.3" xref="S3.SS4.p1.18.m13.2.2.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS4.p1.18.m13.2.2.1.4" xref="S3.SS4.p1.18.m13.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.18.m13.2b"><interval closure="open-closed" id="S3.SS4.p1.18.m13.2.2.2.cmml" xref="S3.SS4.p1.18.m13.2.2.1"><ci id="S3.SS4.p1.18.m13.1.1.cmml" xref="S3.SS4.p1.18.m13.1.1">𝑘</ci><apply id="S3.SS4.p1.18.m13.2.2.1.1.cmml" xref="S3.SS4.p1.18.m13.2.2.1.1"><plus id="S3.SS4.p1.18.m13.2.2.1.1.1.cmml" xref="S3.SS4.p1.18.m13.2.2.1.1.1"></plus><ci id="S3.SS4.p1.18.m13.2.2.1.1.2.cmml" xref="S3.SS4.p1.18.m13.2.2.1.1.2">𝑘</ci><cn type="integer" id="S3.SS4.p1.18.m13.2.2.1.1.3.cmml" xref="S3.SS4.p1.18.m13.2.2.1.1.3">1</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.18.m13.2c">(k,k+1]</annotation></semantics></math> to optimize the relative orientation between consecutive frames. The magnetometer residual does not depend on the position estimate; as such, it does not directly affect the state’s position estimate. However, a better orientation estimate will certainly yield a better position accuracy in the long run.
The magnetometer measurement estimated at <math id="S3.SS4.p1.19.m14.1" class="ltx_Math" alttext="t_{k}" display="inline"><semantics id="S3.SS4.p1.19.m14.1a"><msub id="S3.SS4.p1.19.m14.1.1" xref="S3.SS4.p1.19.m14.1.1.cmml"><mi id="S3.SS4.p1.19.m14.1.1.2" xref="S3.SS4.p1.19.m14.1.1.2.cmml">t</mi><mi id="S3.SS4.p1.19.m14.1.1.3" xref="S3.SS4.p1.19.m14.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.19.m14.1b"><apply id="S3.SS4.p1.19.m14.1.1.cmml" xref="S3.SS4.p1.19.m14.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.19.m14.1.1.1.cmml" xref="S3.SS4.p1.19.m14.1.1">subscript</csymbol><ci id="S3.SS4.p1.19.m14.1.1.2.cmml" xref="S3.SS4.p1.19.m14.1.1.2">𝑡</ci><ci id="S3.SS4.p1.19.m14.1.1.3.cmml" xref="S3.SS4.p1.19.m14.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.19.m14.1c">t_{k}</annotation></semantics></math> using quaternion preintegration depends on the gyroscope noise. However, the gyroscope noise is already considered while computing <math id="S3.SS4.p1.20.m15.1" class="ltx_Math" alttext="\boldsymbol{\gamma}_{k}^{j}" display="inline"><semantics id="S3.SS4.p1.20.m15.1a"><msubsup id="S3.SS4.p1.20.m15.1.1" xref="S3.SS4.p1.20.m15.1.1.cmml"><mi id="S3.SS4.p1.20.m15.1.1.2.2" xref="S3.SS4.p1.20.m15.1.1.2.2.cmml">𝜸</mi><mi id="S3.SS4.p1.20.m15.1.1.2.3" xref="S3.SS4.p1.20.m15.1.1.2.3.cmml">k</mi><mi id="S3.SS4.p1.20.m15.1.1.3" xref="S3.SS4.p1.20.m15.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.20.m15.1b"><apply id="S3.SS4.p1.20.m15.1.1.cmml" xref="S3.SS4.p1.20.m15.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.20.m15.1.1.1.cmml" xref="S3.SS4.p1.20.m15.1.1">superscript</csymbol><apply id="S3.SS4.p1.20.m15.1.1.2.cmml" xref="S3.SS4.p1.20.m15.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.20.m15.1.1.2.1.cmml" xref="S3.SS4.p1.20.m15.1.1">subscript</csymbol><ci id="S3.SS4.p1.20.m15.1.1.2.2.cmml" xref="S3.SS4.p1.20.m15.1.1.2.2">𝜸</ci><ci id="S3.SS4.p1.20.m15.1.1.2.3.cmml" xref="S3.SS4.p1.20.m15.1.1.2.3">𝑘</ci></apply><ci id="S3.SS4.p1.20.m15.1.1.3.cmml" xref="S3.SS4.p1.20.m15.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.20.m15.1c">\boldsymbol{\gamma}_{k}^{j}</annotation></semantics></math> and is significantly smaller than the magnetometer noise. Also, we found that the propagated orientation variance was very small compared to the magnetometer variance. Thus, for simplicity and computational efficiency, we assume that the magnetometer residual weights depend only on the magnetometer sensor noise. Moreover, when the state connected to the magnetometer residuals is marginalized, the magnetometer residuals are added as the marginalization prior along with the inertial and visual residuals.</p>
</div>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS5.5.1.1" class="ltx_text">III-E</span> </span><span id="S3.SS5.6.2" class="ltx_text ltx_font_italic">Soft and Hard Iron Effect Calibration</span>
</h3>

<div id="S3.SS5.p1" class="ltx_para">
<p id="S3.SS5.p1.6" class="ltx_p">The full magnetometer measurement model taking into account the magnetic disturbances and sensor imperfections can be modeled <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">mag_calib</span>]</cite> as</p>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.1" class="ltx_Math" alttext="{}_{\text{B}}\hat{\mathbf{m}}=\text{S}\text{R}_{\text{WB}}^{\text{T}}\ {}_{\text{W}}\mathbf{m}+\mathbf{h}+\boldsymbol{\eta}_{m}" display="block"><semantics id="S3.E9.m1.1a"><mrow id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml"><mmultiscripts id="S3.E9.m1.1.1.2" xref="S3.E9.m1.1.1.2.cmml"><mover accent="true" id="S3.E9.m1.1.1.2.2" xref="S3.E9.m1.1.1.2.2.cmml"><mi id="S3.E9.m1.1.1.2.2.2" xref="S3.E9.m1.1.1.2.2.2.cmml">𝐦</mi><mo id="S3.E9.m1.1.1.2.2.1" xref="S3.E9.m1.1.1.2.2.1.cmml">^</mo></mover><mprescripts id="S3.E9.m1.1.1.2a" xref="S3.E9.m1.1.1.2.cmml"></mprescripts><mtext id="S3.E9.m1.1.1.2.3" xref="S3.E9.m1.1.1.2.3a.cmml">B</mtext><mrow id="S3.E9.m1.1.1.2b" xref="S3.E9.m1.1.1.2.cmml"></mrow></mmultiscripts><mo id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.cmml">=</mo><mrow id="S3.E9.m1.1.1.3" xref="S3.E9.m1.1.1.3.cmml"><mrow id="S3.E9.m1.1.1.3.2" xref="S3.E9.m1.1.1.3.2.cmml"><msubsup id="S3.E9.m1.1.1.3.2.2" xref="S3.E9.m1.1.1.3.2.2.cmml"><mrow id="S3.E9.m1.1.1.3.2.2.2.2" xref="S3.E9.m1.1.1.3.2.2.2.2c.cmml"><mtext id="S3.E9.m1.1.1.3.2.2.2.2a" xref="S3.E9.m1.1.1.3.2.2.2.2c.cmml">S</mtext><mtext id="S3.E9.m1.1.1.3.2.2.2.2b" xref="S3.E9.m1.1.1.3.2.2.2.2c.cmml">R</mtext></mrow><mtext id="S3.E9.m1.1.1.3.2.2.2.3" xref="S3.E9.m1.1.1.3.2.2.2.3a.cmml">WB</mtext><mtext id="S3.E9.m1.1.1.3.2.2.3" xref="S3.E9.m1.1.1.3.2.2.3a.cmml">T</mtext></msubsup><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.3.2.1" xref="S3.E9.m1.1.1.3.2.1.cmml">​</mo><mmultiscripts id="S3.E9.m1.1.1.3.2.3" xref="S3.E9.m1.1.1.3.2.3.cmml"><mi id="S3.E9.m1.1.1.3.2.3.2" xref="S3.E9.m1.1.1.3.2.3.2.cmml">𝐦</mi><mprescripts id="S3.E9.m1.1.1.3.2.3a" xref="S3.E9.m1.1.1.3.2.3.cmml"></mprescripts><mtext id="S3.E9.m1.1.1.3.2.3.3" xref="S3.E9.m1.1.1.3.2.3.3a.cmml">W</mtext><mrow id="S3.E9.m1.1.1.3.2.3b" xref="S3.E9.m1.1.1.3.2.3.cmml"></mrow></mmultiscripts></mrow><mo id="S3.E9.m1.1.1.3.1" xref="S3.E9.m1.1.1.3.1.cmml">+</mo><mi id="S3.E9.m1.1.1.3.3" xref="S3.E9.m1.1.1.3.3.cmml">𝐡</mi><mo id="S3.E9.m1.1.1.3.1a" xref="S3.E9.m1.1.1.3.1.cmml">+</mo><msub id="S3.E9.m1.1.1.3.4" xref="S3.E9.m1.1.1.3.4.cmml"><mi id="S3.E9.m1.1.1.3.4.2" xref="S3.E9.m1.1.1.3.4.2.cmml">𝜼</mi><mi id="S3.E9.m1.1.1.3.4.3" xref="S3.E9.m1.1.1.3.4.3.cmml">m</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1"><eq id="S3.E9.m1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"></eq><apply id="S3.E9.m1.1.1.2.cmml" xref="S3.E9.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.2">subscript</csymbol><apply id="S3.E9.m1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.2.2"><ci id="S3.E9.m1.1.1.2.2.1.cmml" xref="S3.E9.m1.1.1.2.2.1">^</ci><ci id="S3.E9.m1.1.1.2.2.2.cmml" xref="S3.E9.m1.1.1.2.2.2">𝐦</ci></apply><ci id="S3.E9.m1.1.1.2.3a.cmml" xref="S3.E9.m1.1.1.2.3"><mtext mathsize="70%" id="S3.E9.m1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.2.3">B</mtext></ci></apply><apply id="S3.E9.m1.1.1.3.cmml" xref="S3.E9.m1.1.1.3"><plus id="S3.E9.m1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.3.1"></plus><apply id="S3.E9.m1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.3.2"><times id="S3.E9.m1.1.1.3.2.1.cmml" xref="S3.E9.m1.1.1.3.2.1"></times><apply id="S3.E9.m1.1.1.3.2.2.cmml" xref="S3.E9.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.3.2.2.1.cmml" xref="S3.E9.m1.1.1.3.2.2">superscript</csymbol><apply id="S3.E9.m1.1.1.3.2.2.2.cmml" xref="S3.E9.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.3.2.2.2.1.cmml" xref="S3.E9.m1.1.1.3.2.2">subscript</csymbol><ci id="S3.E9.m1.1.1.3.2.2.2.2c.cmml" xref="S3.E9.m1.1.1.3.2.2.2.2"><mrow id="S3.E9.m1.1.1.3.2.2.2.2.cmml" xref="S3.E9.m1.1.1.3.2.2.2.2"><mtext id="S3.E9.m1.1.1.3.2.2.2.2a.cmml" xref="S3.E9.m1.1.1.3.2.2.2.2">S</mtext><mtext id="S3.E9.m1.1.1.3.2.2.2.2b.cmml" xref="S3.E9.m1.1.1.3.2.2.2.2">R</mtext></mrow></ci><ci id="S3.E9.m1.1.1.3.2.2.2.3a.cmml" xref="S3.E9.m1.1.1.3.2.2.2.3"><mtext mathsize="70%" id="S3.E9.m1.1.1.3.2.2.2.3.cmml" xref="S3.E9.m1.1.1.3.2.2.2.3">WB</mtext></ci></apply><ci id="S3.E9.m1.1.1.3.2.2.3a.cmml" xref="S3.E9.m1.1.1.3.2.2.3"><mtext mathsize="70%" id="S3.E9.m1.1.1.3.2.2.3.cmml" xref="S3.E9.m1.1.1.3.2.2.3">T</mtext></ci></apply><apply id="S3.E9.m1.1.1.3.2.3.cmml" xref="S3.E9.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.3.2.3.1.cmml" xref="S3.E9.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.E9.m1.1.1.3.2.3.2.cmml" xref="S3.E9.m1.1.1.3.2.3.2">𝐦</ci><ci id="S3.E9.m1.1.1.3.2.3.3a.cmml" xref="S3.E9.m1.1.1.3.2.3.3"><mtext mathsize="70%" id="S3.E9.m1.1.1.3.2.3.3.cmml" xref="S3.E9.m1.1.1.3.2.3.3">W</mtext></ci></apply></apply><ci id="S3.E9.m1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.3.3">𝐡</ci><apply id="S3.E9.m1.1.1.3.4.cmml" xref="S3.E9.m1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.3.4.1.cmml" xref="S3.E9.m1.1.1.3.4">subscript</csymbol><ci id="S3.E9.m1.1.1.3.4.2.cmml" xref="S3.E9.m1.1.1.3.4.2">𝜼</ci><ci id="S3.E9.m1.1.1.3.4.3.cmml" xref="S3.E9.m1.1.1.3.4.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">{}_{\text{B}}\hat{\mathbf{m}}=\text{S}\text{R}_{\text{WB}}^{\text{T}}\ {}_{\text{W}}\mathbf{m}+\mathbf{h}+\boldsymbol{\eta}_{m}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS5.p1.5" class="ltx_p">where S represents the soft iron matrix and <math id="S3.SS5.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{h}" display="inline"><semantics id="S3.SS5.p1.1.m1.1a"><mi id="S3.SS5.p1.1.m1.1.1" xref="S3.SS5.p1.1.m1.1.1.cmml">𝐡</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.1.m1.1b"><ci id="S3.SS5.p1.1.m1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1">𝐡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.1.m1.1c">\mathbf{h}</annotation></semantics></math> represents the hard iron effect. Hard iron effects arise because of the permanent magnetization of the material and also depend on the fixed sensor recording mechanism. In particular, we can think of the hard iron effect as a constant bias <math id="S3.SS5.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{h}" display="inline"><semantics id="S3.SS5.p1.2.m2.1a"><mi id="S3.SS5.p1.2.m2.1.1" xref="S3.SS5.p1.2.m2.1.1.cmml">𝐡</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.2.m2.1b"><ci id="S3.SS5.p1.2.m2.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1">𝐡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.2.m2.1c">\mathbf{h}</annotation></semantics></math>. Soft iron effects are due to the magnetization of ferromagnetic materials due to the local magnetic field and depend on the orientation with respect to the local magnetic field <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">magnetometer_inertial_calibration</span>]</cite>. The soft iron effect can be represented as a 3<math id="S3.SS5.p1.3.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S3.SS5.p1.3.m3.1a"><mo id="S3.SS5.p1.3.m3.1.1" xref="S3.SS5.p1.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.3.m3.1b"><times id="S3.SS5.p1.3.m3.1.1.cmml" xref="S3.SS5.p1.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.3.m3.1c">\times</annotation></semantics></math>3 symmetric matrix S. We do not consider other sources of magnetometer errors that could arise from non-orthogonality of the magnetometer axes or differences in sensitivity along the three magnetometer axes <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">mag_extra_calib</span>]</cite>.
Without the soft and hard iron offset, if we rotate a magnetometer sensor then the magnetic field vector falls on the surface of sphere with a radius equal to the magnitude of the earth’s magnetic field.  Eq.  <a href="#S3.E9" title="In III-E Soft and Hard Iron Effect Calibration ‣ III Visual-Inertial-Magnetometer Fusion ‣ Enhancing Visual Inertial SLAM with Magnetic Measurements" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> can be seen as a linear transformation that maps points on a sphere to an ellipsoid <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">mag_ellipsoid</span>]</cite>. Thus, the magnetometer calibration problem can be interpreted as ellipsoid fitting of the points to the sphere surface. We solve the ellipsoid fit problem detailed in Kok <em id="S3.SS5.p1.5.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S3.SS5.p1.5.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">magnetometer_inertial_calibration</span>]</cite> to obtain the estimate of <math id="S3.SS5.p1.4.m4.1" class="ltx_Math" alttext="A=\text{S}^{-1}" display="inline"><semantics id="S3.SS5.p1.4.m4.1a"><mrow id="S3.SS5.p1.4.m4.1.1" xref="S3.SS5.p1.4.m4.1.1.cmml"><mi id="S3.SS5.p1.4.m4.1.1.2" xref="S3.SS5.p1.4.m4.1.1.2.cmml">A</mi><mo id="S3.SS5.p1.4.m4.1.1.1" xref="S3.SS5.p1.4.m4.1.1.1.cmml">=</mo><msup id="S3.SS5.p1.4.m4.1.1.3" xref="S3.SS5.p1.4.m4.1.1.3.cmml"><mtext id="S3.SS5.p1.4.m4.1.1.3.2" xref="S3.SS5.p1.4.m4.1.1.3.2a.cmml">S</mtext><mrow id="S3.SS5.p1.4.m4.1.1.3.3" xref="S3.SS5.p1.4.m4.1.1.3.3.cmml"><mo id="S3.SS5.p1.4.m4.1.1.3.3a" xref="S3.SS5.p1.4.m4.1.1.3.3.cmml">−</mo><mn id="S3.SS5.p1.4.m4.1.1.3.3.2" xref="S3.SS5.p1.4.m4.1.1.3.3.2.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.4.m4.1b"><apply id="S3.SS5.p1.4.m4.1.1.cmml" xref="S3.SS5.p1.4.m4.1.1"><eq id="S3.SS5.p1.4.m4.1.1.1.cmml" xref="S3.SS5.p1.4.m4.1.1.1"></eq><ci id="S3.SS5.p1.4.m4.1.1.2.cmml" xref="S3.SS5.p1.4.m4.1.1.2">𝐴</ci><apply id="S3.SS5.p1.4.m4.1.1.3.cmml" xref="S3.SS5.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS5.p1.4.m4.1.1.3.1.cmml" xref="S3.SS5.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS5.p1.4.m4.1.1.3.2a.cmml" xref="S3.SS5.p1.4.m4.1.1.3.2"><mtext id="S3.SS5.p1.4.m4.1.1.3.2.cmml" xref="S3.SS5.p1.4.m4.1.1.3.2">S</mtext></ci><apply id="S3.SS5.p1.4.m4.1.1.3.3.cmml" xref="S3.SS5.p1.4.m4.1.1.3.3"><minus id="S3.SS5.p1.4.m4.1.1.3.3.1.cmml" xref="S3.SS5.p1.4.m4.1.1.3.3"></minus><cn type="integer" id="S3.SS5.p1.4.m4.1.1.3.3.2.cmml" xref="S3.SS5.p1.4.m4.1.1.3.3.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.4.m4.1c">A=\text{S}^{-1}</annotation></semantics></math> and the hard iron offset <math id="S3.SS5.p1.5.m5.1" class="ltx_Math" alttext="\mathbf{h}" display="inline"><semantics id="S3.SS5.p1.5.m5.1a"><mi id="S3.SS5.p1.5.m5.1.1" xref="S3.SS5.p1.5.m5.1.1.cmml">𝐡</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.5.m5.1b"><ci id="S3.SS5.p1.5.m5.1.1.cmml" xref="S3.SS5.p1.5.m5.1.1">𝐡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.5.m5.1c">\mathbf{h}</annotation></semantics></math>. For correct calibration, the magnetometer needs to be rotated along all three axes several times. Magnetometer measurements are corrected in the body frame as follows:</p>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.1" class="ltx_Math" alttext="{}_{\text{B}}\tilde{\mathbf{m}}=\text{A}({}_{\text{B}}\hat{\mathbf{m}}-\mathbf{h})" display="block"><semantics id="S3.E10.m1.1a"><mrow id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml"><mmultiscripts id="S3.E10.m1.1.1.3" xref="S3.E10.m1.1.1.3.cmml"><mover accent="true" id="S3.E10.m1.1.1.3.2" xref="S3.E10.m1.1.1.3.2.cmml"><mi id="S3.E10.m1.1.1.3.2.2" xref="S3.E10.m1.1.1.3.2.2.cmml">𝐦</mi><mo id="S3.E10.m1.1.1.3.2.1" xref="S3.E10.m1.1.1.3.2.1.cmml">~</mo></mover><mprescripts id="S3.E10.m1.1.1.3a" xref="S3.E10.m1.1.1.3.cmml"></mprescripts><mtext id="S3.E10.m1.1.1.3.3" xref="S3.E10.m1.1.1.3.3a.cmml">B</mtext><mrow id="S3.E10.m1.1.1.3b" xref="S3.E10.m1.1.1.3.cmml"></mrow></mmultiscripts><mo id="S3.E10.m1.1.1.2" xref="S3.E10.m1.1.1.2.cmml">=</mo><mrow id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.cmml"><mtext id="S3.E10.m1.1.1.1.3" xref="S3.E10.m1.1.1.1.3a.cmml">A</mtext><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.2" xref="S3.E10.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E10.m1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.cmml"><mmultiscripts id="S3.E10.m1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E10.m1.1.1.1.1.1.1.2.2" xref="S3.E10.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.2.2.2" xref="S3.E10.m1.1.1.1.1.1.1.2.2.2.cmml">𝐦</mi><mo id="S3.E10.m1.1.1.1.1.1.1.2.2.1" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mprescripts id="S3.E10.m1.1.1.1.1.1.1.2a" xref="S3.E10.m1.1.1.1.1.1.1.2.cmml"></mprescripts><mtext id="S3.E10.m1.1.1.1.1.1.1.2.3" xref="S3.E10.m1.1.1.1.1.1.1.2.3a.cmml">B</mtext><mrow id="S3.E10.m1.1.1.1.1.1.1.2b" xref="S3.E10.m1.1.1.1.1.1.1.2.cmml"></mrow></mmultiscripts><mo id="S3.E10.m1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E10.m1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.3.cmml">𝐡</mi></mrow><mo stretchy="false" id="S3.E10.m1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1"><eq id="S3.E10.m1.1.1.2.cmml" xref="S3.E10.m1.1.1.2"></eq><apply id="S3.E10.m1.1.1.3.cmml" xref="S3.E10.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.3">subscript</csymbol><apply id="S3.E10.m1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.3.2"><ci id="S3.E10.m1.1.1.3.2.1.cmml" xref="S3.E10.m1.1.1.3.2.1">~</ci><ci id="S3.E10.m1.1.1.3.2.2.cmml" xref="S3.E10.m1.1.1.3.2.2">𝐦</ci></apply><ci id="S3.E10.m1.1.1.3.3a.cmml" xref="S3.E10.m1.1.1.3.3"><mtext mathsize="70%" id="S3.E10.m1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.3.3">B</mtext></ci></apply><apply id="S3.E10.m1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"><times id="S3.E10.m1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.2"></times><ci id="S3.E10.m1.1.1.1.3a.cmml" xref="S3.E10.m1.1.1.1.3"><mtext id="S3.E10.m1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.3">A</mtext></ci><apply id="S3.E10.m1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1"><minus id="S3.E10.m1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1"></minus><apply id="S3.E10.m1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E10.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2.2"><ci id="S3.E10.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E10.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2.2.2">𝐦</ci></apply><ci id="S3.E10.m1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S3.E10.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2.3">B</mtext></ci></apply><ci id="S3.E10.m1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.3">𝐡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">{}_{\text{B}}\tilde{\mathbf{m}}=\text{A}({}_{\text{B}}\hat{\mathbf{m}}-\mathbf{h})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S3.SS5.p1.7" class="ltx_p">These corrected measurements are used to calculate magnetometer residuals in the sliding-window optimization as explained in  Section  <a href="#S3.SS4" title="III-D Magnetometer Residuals ‣ III Visual-Inertial-Magnetometer Fusion ‣ Enhancing Visual Inertial SLAM with Magnetic Measurements" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-D</span></span></a>. In an indoor environment, these hard and soft iron effects continue to change as we move through the different areas. The underwater cave environment is ideally suited for magnetometer fusion as the likelihood of magnetic disturbance is minimal. As such, we performed the calibration at the beginning and assumed that the local magnetic field did not change significantly. During deployment, we performed calibration at the beginning and at the end of the dive, both calibrations resulted in similar values, validating the above assumption.  On older datasets, we did not record an explicit magnetometer calibration sequence. In such a case, these are not enough magnetometer measurements in all directions; thus full mapping from ellipse to sphere is degenerate. Thus, we only calibrate the hard iron effect. Figure <a href="#S3.F4" title="Figure 4 ‣ III-E Soft and Hard Iron Effect Calibration ‣ III Visual-Inertial-Magnetometer Fusion ‣ Enhancing Visual Inertial SLAM with Magnetic Measurements" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> presents the ellipsoids fitted during complete calibration for the new sensor and for partial calibration of the old sensor.</p>
</div>
<figure id="S3.F4" class="ltx_figure">
<table id="S3.F4.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S3.F4.2.2" class="ltx_tr">
<td id="S3.F4.1.1.1" class="ltx_td ltx_align_center"><span id="S3.F4.1.1.1.1" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;"><img src="/html/2409.09904/assets/x1.png" id="S3.F4.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="200" height="132" alt="Refer to caption"></span></td>
<td id="S3.F4.2.2.2" class="ltx_td ltx_align_center"><span id="S3.F4.2.2.2.1" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;"><img src="/html/2409.09904/assets/x2.png" id="S3.F4.2.2.2.1.g1" class="ltx_graphics ltx_img_landscape" width="202" height="132" alt="Refer to caption"></span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F4.4.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S3.F4.5.2" class="ltx_text" style="font-size:90%;">Magnetometer calibration ellipses fitted from explicit calibration sequence (left) and partial calibration (right).</span></figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Experimental Results</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We present evaluation results from two experiments in the Devil’s Eye cave system, FL, USA and one experiment in the Dos Ojos Cenote, QR, Mexico. In all experiments the diver enters and exits the cave from the same location.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.5.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.6.2" class="ltx_text ltx_font_italic">Datasets</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">All the datasets are collected utilizing the sensor suite described in Rahman <em id="S4.SS1.p1.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S4.SS1.p1.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">RahmanOceans2018</span>]</cite>. The first dataset was collected using IDS UI-3251LE cameras in a stereo configuration and Microstrain 3DM-GX5-25 AHRS in the Devil’s cave system, Florida. We call this dataset cave1_short and images are captured at 15Hz. The cave1_short dataset spans approximately 220m. The second dataset was collected with the same sensor suite in Dos Ojos Cenote, QR, Mexico. This trajectory is very long (<math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mo id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><csymbol cd="latexml" id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\sim</annotation></semantics></math>680m) with a duration of more than 50 minutes. COLMAP was unable to finish the complete trajectory due to computational and memory constraints. Thus, this data set is used only for qualitative evaluation.
The third dataset was collected using a similar sensor suite in monocular setup with Flir BFS-U3-16S7C-C camera and microstrain 3DM-GV7 AHRS. We call this dataset cave1_long with total trajectory length of approximately 506m. Both datasets are very challenging in terms of low brightness, illumination changes due to artificial lighting, and low visibility.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.5.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.6.2" class="ltx_text ltx_font_italic">Results</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">Due to the absence of GPS or motion capture systems underwater, COLMAP <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">colmap_sfm</span>]</cite> is used to produce baseline trajectories. COLMAP is a Structure-from-Motion (SfM) framework that performs joint optimization of camera poses and map structure using global bundle adjustment. Since one of the datasets only contains monocular images, we consider the COLMAP trajectory up to scale for uniformity. Thus, the trajectories are aligned with the COLMAP baseline trajectories using <span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_italic">sim3</span> alignment <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">umeyama</span>]</cite>.</p>
</div>
<figure id="S4.F5" class="ltx_figure">
<table id="S4.F5.3" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.F5.3.3" class="ltx_tr">
<td id="S4.F5.1.1.1" class="ltx_td ltx_align_left"><img src="/html/2409.09904/assets/figures/cave_short.png" id="S4.F5.1.1.1.g1" class="ltx_graphics ltx_img_square" width="158" height="154" alt="Refer to caption"></td>
<td id="S4.F5.2.2.2" class="ltx_td ltx_align_left"><img src="/html/2409.09904/assets/figures/cave_long.png" id="S4.F5.2.2.2.g1" class="ltx_graphics ltx_img_square" width="158" height="154" alt="Refer to caption"></td>
<td id="S4.F5.3.3.3" class="ltx_td ltx_align_left"><img src="/html/2409.09904/assets/figures/devils_systemPart_Annot.png" id="S4.F5.3.3.3.g1" class="ltx_graphics ltx_img_square" width="155" height="154" alt="Refer to caption"></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.9.3.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S4.F5.7.2" class="ltx_text" style="font-size:90%;">Trajectories from two deployments at the Devil’s Eye cave system, FL, USA. The first two images show the trajectories, COLMAP (red) treated as ground truth, OKVIS VIO <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">okvis</span>]</cite> (blue), and OKVIS with magnetometer (green) the proposed method. The first trajectory was carried out with the old sensor suite <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">RahmanOceans2018</span>]</cite> and was a short (<math id="S4.F5.6.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.F5.6.1.m1.1b"><mo id="S4.F5.6.1.m1.1.1" xref="S4.F5.6.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.F5.6.1.m1.1c"><csymbol cd="latexml" id="S4.F5.6.1.m1.1.1.cmml" xref="S4.F5.6.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.6.1.m1.1d">\sim</annotation></semantics></math>220m) trajectory, the second was done with the new system and went further (<math id="S4.F5.7.2.m2.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.F5.7.2.m2.1b"><mo id="S4.F5.7.2.m2.1.1" xref="S4.F5.7.2.m2.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.F5.7.2.m2.1c"><csymbol cd="latexml" id="S4.F5.7.2.m2.1.1.cmml" xref="S4.F5.7.2.m2.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.7.2.m2.1d">\sim</annotation></semantics></math>500m) trajectory. The final figure presents a section of the man-made map with the ground truth trajectory superimposed (the blue background indicates the Santa Fe River over the cave). These trajectories are aligned at the origin (0,0) only to show endpoint error.</span></figcaption>
</figure>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.4" class="ltx_p">We compare the performance of our magnetometer formulation with the VIO formulation from OKVIS <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">okvis</span>]</cite> in terms of absolute trajectory error (ATE)  <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">absolute_traj_error</span>]</cite>. We include the results of the VIO-only case without fusing magnetometer measurements and compare them with the proposed method after <span id="S4.SS2.p2.4.1" class="ltx_text ltx_font_italic">sim(3)</span> alignment. Each method is run three times and the absolute trajectory error in terms of degree/meters is reported in Table <a href="#S4.T1" title="TABLE I ‣ IV-B Results ‣ IV Experimental Results ‣ Enhancing Visual Inertial SLAM with Magnetic Measurements" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>. As seen in the table, there is a significant reduction in both translation and rotation RMSE. In particular in the cave1_long dataset, both the rotation and translation error decreased significantly from <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mo id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><csymbol cd="latexml" id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\sim</annotation></semantics></math>15°to <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mo id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><csymbol cd="latexml" id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\sim</annotation></semantics></math>6°and from <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mo id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><csymbol cd="latexml" id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">\sim</annotation></semantics></math>14m to <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mo id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><csymbol cd="latexml" id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">\sim</annotation></semantics></math>3m.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.3.1.1" class="ltx_text" style="font-size:90%;">TABLE I</span>: </span><span id="S4.T1.4.2" class="ltx_text" style="font-size:90%;">Three times run mean absolute trajectory error (ATE) for VIO with and without magnetometer compared with COLMAP baseline after <span id="S4.T1.4.2.1" class="ltx_text ltx_font_italic">sim(3)</span> alignment in terms of degree/meters.</span></figcaption>
<table id="S4.T1.5" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T1.5.1" class="ltx_tr">
<td id="S4.T1.5.1.1" class="ltx_td ltx_align_left">dataset</td>
<td id="S4.T1.5.1.2" class="ltx_td ltx_align_center">length</td>
<td id="S4.T1.5.1.3" class="ltx_td ltx_align_center">VIO</td>
<td id="S4.T1.5.1.4" class="ltx_td ltx_align_center">VIO+MAG</td>
</tr>
<tr id="S4.T1.5.2" class="ltx_tr">
<td id="S4.T1.5.2.1" class="ltx_td ltx_align_left ltx_border_tt">cave1_short</td>
<td id="S4.T1.5.2.2" class="ltx_td ltx_align_center ltx_border_tt">220m</td>
<td id="S4.T1.5.2.3" class="ltx_td ltx_align_center ltx_border_tt">6.31°/6.45m</td>
<td id="S4.T1.5.2.4" class="ltx_td ltx_align_center ltx_border_tt">4.48°/4.98m</td>
</tr>
<tr id="S4.T1.5.3" class="ltx_tr">
<td id="S4.T1.5.3.1" class="ltx_td ltx_align_left ltx_border_bb">cave1_long</td>
<td id="S4.T1.5.3.2" class="ltx_td ltx_align_center ltx_border_bb">506m</td>
<td id="S4.T1.5.3.3" class="ltx_td ltx_align_center ltx_border_bb">14.65°/14.57m</td>
<td id="S4.T1.5.3.4" class="ltx_td ltx_align_center ltx_border_bb">5.83°/3.37m</td>
</tr>
</table>
</figure>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">We also computed the relative trajectory error (RPE) that computes the relative error between states at different times with the focus on the yaw error  <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">Zhang18iros</span>]</cite>. RPE shows the local drift over different sections of the trajectory and is unaffected by previously accumulated error. The relative yaw error calculated for cave1_long trajectory after aligning the initial pose is shown in  Fig.  <a href="#S4.F6" title="Figure 6 ‣ IV-B Results ‣ IV Experimental Results ‣ Enhancing Visual Inertial SLAM with Magnetic Measurements" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. We can see that when using the magnetometer the yaw error remains constant over large distances, whereas the VIO accumulates error when distances keep increasing.</p>
</div>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2409.09904/assets/figures/yawError.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="449" height="269" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S4.F6.3.2" class="ltx_text" style="font-size:90%;">Relative trajectory error (yaw) comparison between VIO and VIO+magnetometer.</span></figcaption>
</figure>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.1" class="ltx_p">Two different deployments from the Devil’s Eye cave system are presented in Fig. <a href="#S4.F5" title="Figure 5 ‣ IV-B Results ‣ IV Experimental Results ‣ Enhancing Visual Inertial SLAM with Magnetic Measurements" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. The first deployment, a short foray of 100 meters penetration inside the cave, can be seen in the left image, and the drift in the trajectory (blue) without magnetometer data fusion is clear. The visual inertial magnetometer fusion (green) follows much more closely the ground truth trajectory from COLMAP. More dramatic improvements are presented in the middle figure with trajectory of more than 500 meters. Compared to the globally optimized (COLMAP) trajectory there was reduction of positional error from 2.8% to 0.6%. The right image presents a partial map of the cave system with the COLMAP trajectory superimposed. The map is not up to scale, thus some passages are not scaled uniformly. Nonetheless, the trajectory follows the main passages of the cave system.
Figure <a href="#S4.F7" title="Figure 7 ‣ IV-B Results ‣ IV Experimental Results ‣ Enhancing Visual Inertial SLAM with Magnetic Measurements" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> presents the trajectory resulting from the deployment of the old sensor suite at the Cenote Dos Ojos. During the 50-minute deployment, the sensor covered approximately 680 meters inside a highly decorated cave. The large volume of data made the production of a COLMAP-based ground truth trajectory infeasible due to computation and memory constraints. As such, this trajectory is used only as a qualitative comparison. As can be seen, the VIO diverged almost 100 meters. The trajectory obtained from magnetometer fusion follows the path out much more closely to the path taken on the way in. It is worth noting that the sensor’s trajectory does not follow exactly the same path; however, the confined structure of the cave passage constrains the inbound and the outbound trajectories fairly close.</p>
</div>
<figure id="S4.F7" class="ltx_figure"><img src="/html/2409.09904/assets/figures/dos_ojos.png" id="S4.F7.g1" class="ltx_graphics ltx_centering ltx_img_square" width="479" height="465" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F7.4.2.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="S4.F7.2.1" class="ltx_text" style="font-size:90%;">Trajectories (<math id="S4.F7.2.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.F7.2.1.m1.1b"><mo id="S4.F7.2.1.m1.1.1" xref="S4.F7.2.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.F7.2.1.m1.1c"><csymbol cd="latexml" id="S4.F7.2.1.m1.1.1.cmml" xref="S4.F7.2.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.2.1.m1.1d">\sim</annotation></semantics></math>680m) from a deployment at Cenote Dos Ojos cave system, QR, Mexico. OKVIS VIO <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">okvis</span>]</cite> (blue), and OKVIS with magnetometer (green) the proposed method.  These trajectories are aligned at the origin (0,0) only to show endpoint error.</span></figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper we presented a novel approach for augmenting VIO with magnetic field data. The experimental results demonstrated significant improvements in the accuracy of the resulting trajectories, significant reduction in the orientation error, and also the ability to orient the resulting trajectory with the magnetic north. During the estimation process, the magnetometer and the accelerometers provide absolute attitude information (with respect the magnetic north and the gravity vector).
Future work will explore the performance of the proposed system during shipwreck mapping, where the sensor traverses near metal structures. During initial calibration we expect to recover the true yaw of the sensor with respect to the magnetic north, enabling better positioning of the underwater structure in space. Furthermore, deployments of the proposed system on an autonomous underwater vehicle will require placing the magnetometer at some distance from the motors. A future experimental study will evaluate the magnetic noise levels for popular vehicles, such as the BlueRoV2 <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">bluerov</span>]</cite> or the Aqua2 AUV <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">DudekIROS2005</span>]</cite>.</p>
<div class="ltx_pagination ltx_role_newpage"></div>
</div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2409.09903" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2409.09904" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2409.09904">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2409.09904" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2409.09905" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Oct  5 23:05:45 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
