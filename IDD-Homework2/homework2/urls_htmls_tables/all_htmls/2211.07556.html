<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2211.07556] Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks</title><meta property="og:description" content="Traditional tracking of magnetic markers leads to high computational costs due to the requirement for iterative optimization procedures. Furthermore, such approaches rely on the magnetic dipole model for the optimizati…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2211.07556">

<!--Generated on Thu Mar 14 08:35:25 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Mengfan Wu,
<br class="ltx_break">ETH Zürich,
<br class="ltx_break">TU Berlin and Huawei Research
<br class="ltx_break"><span id="id5.1.id1" class="ltx_text ltx_font_typewriter">mengfan.wu@campus.tu-berlin.de</span> 
<br class="ltx_break">&amp;Thomas Langerak,
<br class="ltx_break">Department of Computer Science
<br class="ltx_break">ETH Zürich
<br class="ltx_break"><span id="id6.2.id2" class="ltx_text ltx_font_typewriter">thomas.langerak@inf.ethz.ch</span> 
<br class="ltx_break">&amp;Otmar Hilliges,
<br class="ltx_break">Department of Computer Science
<br class="ltx_break">ETH Zürich
<br class="ltx_break"><span id="id7.3.id3" class="ltx_text ltx_font_typewriter">otmar.hilliges@inf.ethz.ch</span> 
<br class="ltx_break">&amp;Juan Zarate
<br class="ltx_break">Department of Computer Science
<br class="ltx_break">ETH Zürich
<br class="ltx_break"><span id="id8.4.id4" class="ltx_text ltx_font_typewriter">juan.zarate@inf.ethz.ch</span> 
<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id4.4" class="ltx_p">Traditional tracking of magnetic markers leads to high computational costs due to the requirement for iterative optimization procedures. Furthermore, such approaches rely on the magnetic dipole model for the optimization function, leading to inaccurate results anytime a non-spherical magnet gets close to a sensor in the array.
We propose to overcome these limitations by using neural networks to infer the marker’s position and orientation. Our method can obtain the magnet’s five degrees of freedom (5 DoF) in a single inference step without relying on an initial estimation. As a counterpart, the supervised training phase is data intensive. We solve this by generating synthetic, yet realistic, data via Finite Element Methods simulations. A fast and accurate inference largely compensates for the offline training preparation.
We evaluate our system using different cylindrical magnets, tracked with a square array of 16 sensors. We use a portable, neural networks-oriented single-board computer for the sensors’ reading and the position inference, making our setup very compact.
We compared our tracking outputs with vision-based ground truth data. Our prototype implementation tracks <math id="id1.1.m1.1" class="ltx_Math" alttext="5" display="inline"><semantics id="id1.1.m1.1a"><mn id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><cn type="integer" id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">5</annotation></semantics></math> DoF with an averaged positional error of <math id="id2.2.m2.1" class="ltx_Math" alttext="4" display="inline"><semantics id="id2.2.m2.1a"><mn id="id2.2.m2.1.1" xref="id2.2.m2.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="id2.2.m2.1b"><cn type="integer" id="id2.2.m2.1.1.cmml" xref="id2.2.m2.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="id2.2.m2.1c">4</annotation></semantics></math> mm and orientation error of <math id="id3.3.m3.1" class="ltx_Math" alttext="8" display="inline"><semantics id="id3.3.m3.1a"><mn id="id3.3.m3.1.1" xref="id3.3.m3.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="id3.3.m3.1b"><cn type="integer" id="id3.3.m3.1.1.cmml" xref="id3.3.m3.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="id3.3.m3.1c">8</annotation></semantics></math> deg within a <math id="id4.4.m4.1" class="ltx_Math" alttext="0.2x0.2x0.15" display="inline"><semantics id="id4.4.m4.1a"><mrow id="id4.4.m4.1.1" xref="id4.4.m4.1.1.cmml"><mn id="id4.4.m4.1.1.2" xref="id4.4.m4.1.1.2.cmml">0.2</mn><mo lspace="0em" rspace="0em" id="id4.4.m4.1.1.1" xref="id4.4.m4.1.1.1.cmml">​</mo><mi id="id4.4.m4.1.1.3" xref="id4.4.m4.1.1.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="id4.4.m4.1.1.1a" xref="id4.4.m4.1.1.1.cmml">​</mo><mn id="id4.4.m4.1.1.4" xref="id4.4.m4.1.1.4.cmml">0.2</mn><mo lspace="0em" rspace="0em" id="id4.4.m4.1.1.1b" xref="id4.4.m4.1.1.1.cmml">​</mo><mi id="id4.4.m4.1.1.5" xref="id4.4.m4.1.1.5.cmml">x</mi><mo lspace="0em" rspace="0em" id="id4.4.m4.1.1.1c" xref="id4.4.m4.1.1.1.cmml">​</mo><mn id="id4.4.m4.1.1.6" xref="id4.4.m4.1.1.6.cmml">0.15</mn></mrow><annotation-xml encoding="MathML-Content" id="id4.4.m4.1b"><apply id="id4.4.m4.1.1.cmml" xref="id4.4.m4.1.1"><times id="id4.4.m4.1.1.1.cmml" xref="id4.4.m4.1.1.1"></times><cn type="float" id="id4.4.m4.1.1.2.cmml" xref="id4.4.m4.1.1.2">0.2</cn><ci id="id4.4.m4.1.1.3.cmml" xref="id4.4.m4.1.1.3">𝑥</ci><cn type="float" id="id4.4.m4.1.1.4.cmml" xref="id4.4.m4.1.1.4">0.2</cn><ci id="id4.4.m4.1.1.5.cmml" xref="id4.4.m4.1.1.5">𝑥</ci><cn type="float" id="id4.4.m4.1.1.6.cmml" xref="id4.4.m4.1.1.6">0.15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id4.4.m4.1c">0.2x0.2x0.15</annotation></semantics></math> m working volume.</p>
</div>
<div id="p1" class="ltx_para ltx_noindent">
<p id="p1.3" class="ltx_p"><em id="p1.3.1" class="ltx_emph ltx_font_bold ltx_font_italic">Keywords</em> Passive magnet localization  <math id="p1.1.m1.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="p1.1.m1.1a"><mo id="p1.1.m1.1.1" xref="p1.1.m1.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.1.m1.1b"><ci id="p1.1.m1.1.1.cmml" xref="p1.1.m1.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.1.m1.1c">\cdot</annotation></semantics></math>
machine learning  <math id="p1.2.m2.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="p1.2.m2.1a"><mo id="p1.2.m2.1.1" xref="p1.2.m2.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.2.m2.1b"><ci id="p1.2.m2.1.1.cmml" xref="p1.2.m2.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.2.m2.1c">\cdot</annotation></semantics></math>
position and orientation tracking  <math id="p1.3.m3.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="p1.3.m3.1a"><mo id="p1.3.m3.1.1" xref="p1.3.m3.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.3.m3.1b"><ci id="p1.3.m3.1.1.cmml" xref="p1.3.m3.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.3.m3.1c">\cdot</annotation></semantics></math>
permanent magnets</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Alarge variety of applications rely on the tracking of three dimensional position and orientation. Such as decoding gesture input and providing force feedback on fingertips or tools <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> via magnetic tracking. Tracking and guiding medical instruments, such as capsules and catheters <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> also rely on magnetic markers. This widespread interest is partially driven by the fact that magnetic signals can permeate through a large variety of materials, including human tissues, without disturbance or occlusion. In addition, these systems can also benefit from comparatively affordable and more lightweight instrumentation, both in the tracker sensors and the markers.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">Existing work distincts between active and passive magnetic markers. Active markers can benefit from a higher signal-to-noise ratio by allowing frequency filtering. However, tracking active emitters requires either a wired connection to the tracked object or a battery-powered circuitry <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. In contrast, Passive magnetic localization is simpler - it only requires the target to be instrumented with a permanent magnet, eliminating any need for tethered connections or active electronics on the moving elements <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. Interestingly, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> has proposed a third group of semi-passive markers. Although the tracked elements are passive, they respond with a resonant signal when excited by the nearby source. Although our work focuses on passive magnetic localization, due to its simplicity and robustness, future work could apply to many of the ideas deployed here to these other types of magnetic markers.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">A vital part of the system is the algorithm that transforms magnetic signals into the marker’s 5-degree-of-freedom (5DoF) position and orientation. One common solution is to minimize the difference between a mathematical magnetic field model and the sensors’ readings. For this purpose, several non-linear optimization algorithms have been proposed and tested <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, the authors implemented an analytical computation of gradients to accelerate the optimization process. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, the proposed algorithm uncouples the marker’s orientation from its position, which improves the calculation speed and provides guarantees in terms of the global minima. Nonetheless, these iterative approaches come with significant challenges. First, gradient-descent algorithms are computationally expensive, which results in a trade-off between tracking precision and frequency. Second, an iterative non-convex optimization may also suffer from the non-uniqueness of the solution, converging to local minima. These challenges result in such methods being strongly dependent on their initialization.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">Other approaches have explored ways to reduce the problem complexity to a linear variant, ensuring increased convergence speed and global optimality of the solution. The most drastic simplification is to directly interpolate the intensity of the reading within the sensors’ array. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, the authors use this approach to track a stylus and a gaming object in a two-dimensional plane. In a more sophisticated configuration (cf., <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>) multiple sensors with known spatial arrangements give an over-constrained system of equations so that there is a unique solution to the state of a magnet. These triangulation methods are fast, however, less robust to the noise of sensors and restricted to only the positional DoFs.</p>
</div>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.1" class="ltx_p">Crucially, any methods’ effectiveness depends on the magnetic model’s validity. Most, if not all, of the above methods, used the first term of the multi-pole series expansion derived from Maxwell’s equations. The magnetic dipole approximation assumes any magnet to be spherical. On the one hand, this approximation gives the simplest explicit expression for the magnetic field as a function of the distance to the source. On the other hand, applying the approximation to non-spherical magnets only yields reliable results when the magnets are far from the sensor <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. However, a small magnetic field approximation error can lead to large positional differences.</p>
</div>
<div id="S1.p6" class="ltx_para ltx_noindent">
<p id="S1.p6.1" class="ltx_p">In recent years, machine learning has emerged as a useful approach to bypass the computational burden of iterative methods. Machine learning, especially Neural Networks (NN), is powerful in approximating non-linearities via sequential multiply-accumulate operations. In addition, there is no need for initial estimates, and often an isolated one-shot inference is enough to attain reliable results. While inference is fast, it requires a large and representative dataset for training to achieve good generalization to unseen samples. Creating a dataset can be challenging and time-consuming. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> machine learning is used to predict the locations of the tracked magnet with input from magnetic sensors. The data for training the neural network is collected in-vivo by placing magnets at different known locations and then gathering sensor readings. The data collection process is lengthy and does not scale to new scenarios and markers.
Recently, authors in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> demonstrated the use of neural networks trained on synthetic data to track active coils markers. Even if we share some conceptual goals with these two works, their results apply to active coils emitters and do not always outperform the ones based on iterative optimization.</p>
</div>
<div id="S1.p7" class="ltx_para ltx_noindent">
<p id="S1.p7.1" class="ltx_p">As in most data-driven methods, the challenge lies in collecting a large amount of precisely labeled data to train the estimator. For this, we look towards Finite Element Methods (FEM) to simulate the complete set of Maxwell’s equations. FEM is computationally expensive, especially when a fine mesh is applied to attain accurate results. Hence, FEM is unusable in real-time modeling. However, FEM can be used to provide noise-free synthetic datasets for training of machine learning models. Other fields have successfully applied the use of FEM-generated synthetic datasets to train neural networks, albeit not for magnetic tracking. For instance, for mechanical deformations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, elastoplasticity <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, material inspection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, and nanostructures <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>.</p>
</div>
<div id="S1.p8" class="ltx_para ltx_noindent">
<p id="S1.p8.1" class="ltx_p">In this paper, we propose a supervised learning approach to enable the real-time tracking of arbitrary axisymmetric magnets based on Neural Networks. Our data-driven approach is enabled by using FEM to model the magnetic field of cylindrical magnets. We take advantage of Neural Networks in modeling non-linearities to approximate the inverse function of the magnetic field. Specifically, we use a Multi-Layer Perceptron (MLP). This approach allows us to bypass the expensive iterative optimization process, which opens up the grounds for truly portable tracking devices.</p>
</div>
<div id="S1.p9" class="ltx_para ltx_noindent">
<p id="S1.p9.1" class="ltx_p">We make the following contribution to the magnetic tracking scheme:</p>
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">To obtain high-resolution magnetic field data for training neural networks, we introduce a novel coordinate transformation algorithm that utilizes our markers’ symmetric properties and converts FEM-simulation results from 2D to 3D.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">To enable feasible and accurate tracking of magnetic markers by a neural network, we propose and test a feature engineering function inspired by the physical property of the magnetic field.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I1.i3.p1" class="ltx_para ltx_noindent">
<p id="S1.I1.i3.p1.5" class="ltx_p">To evaluate the efficacy of our system, we evaluate our method in both simulation and experiments. We assess various cylindrical magnets with <math id="S1.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S1.I1.i3.p1.1.m1.1a"><mn id="S1.I1.i3.p1.1.m1.1.1" xref="S1.I1.i3.p1.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.1.m1.1b"><cn type="integer" id="S1.I1.i3.p1.1.m1.1.1.cmml" xref="S1.I1.i3.p1.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.1.m1.1c">5</annotation></semantics></math> degrees of freedom and achieve an averaged error of <math id="S1.I1.i3.p1.2.m2.1" class="ltx_Math" alttext="4" display="inline"><semantics id="S1.I1.i3.p1.2.m2.1a"><mn id="S1.I1.i3.p1.2.m2.1.1" xref="S1.I1.i3.p1.2.m2.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.2.m2.1b"><cn type="integer" id="S1.I1.i3.p1.2.m2.1.1.cmml" xref="S1.I1.i3.p1.2.m2.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.2.m2.1c">4</annotation></semantics></math> mm and an orientation error of less than <math id="S1.I1.i3.p1.3.m3.1" class="ltx_Math" alttext="8" display="inline"><semantics id="S1.I1.i3.p1.3.m3.1a"><mn id="S1.I1.i3.p1.3.m3.1.1" xref="S1.I1.i3.p1.3.m3.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.3.m3.1b"><cn type="integer" id="S1.I1.i3.p1.3.m3.1.1.cmml" xref="S1.I1.i3.p1.3.m3.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.3.m3.1c">8</annotation></semantics></math> degrees, running on a portable device with an interactive rate of <math id="S1.I1.i3.p1.4.m4.1" class="ltx_Math" alttext="75" display="inline"><semantics id="S1.I1.i3.p1.4.m4.1a"><mn id="S1.I1.i3.p1.4.m4.1.1" xref="S1.I1.i3.p1.4.m4.1.1.cmml">75</mn><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.4.m4.1b"><cn type="integer" id="S1.I1.i3.p1.4.m4.1.1.cmml" xref="S1.I1.i3.p1.4.m4.1.1">75</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.4.m4.1c">75</annotation></semantics></math> Hz when using <math id="S1.I1.i3.p1.5.m5.1" class="ltx_Math" alttext="8" display="inline"><semantics id="S1.I1.i3.p1.5.m5.1a"><mn id="S1.I1.i3.p1.5.m5.1.1" xref="S1.I1.i3.p1.5.m5.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.5.m5.1b"><cn type="integer" id="S1.I1.i3.p1.5.m5.1.1.cmml" xref="S1.I1.i3.p1.5.m5.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.5.m5.1c">8</annotation></semantics></math> sensors.</p>
</div>
</li>
</ol>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Method</h2>

<figure id="S2.F1" class="ltx_figure"><img src="/html/2211.07556/assets/x1.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="392" height="294" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Schematic pipeline overview. We use a Multi-Layer Perceptron (MLP) to output the location and orientation of the magnet directly. During the training phase, the MLP outputs are compared with the FEM ground truth. During the inference, the input to the MLP is the sensor data to track the position and orientation of the magnet. </figcaption>
</figure>
<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p">The core of our contribution is a novel tracking method which utilizes supervised learning. Specially, we use a Multi-Layer Perceptron. Our tracking pipeline has two different instances: during the training phase, the output of the MLP is compared to the labeled data generated by FEM, during device operation (inference), the sensors readings are fed to the MLP to obtain the magnetic marker position and orientation (Figure <a href="#S2.F1" title="Figure 1 ‣ 2 Method ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).
In this section, we first elaborate on how we create a high-resolution synthetic dataset (Sec. <a href="#S2.SS1" title="2.1 Synthetic Dataset ‣ 2 Method ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.1</span></a>). Second, we detail our neural network architecture and training (Sec. <a href="#S2.SS2" title="2.2 Tracking with Neural Networks ‣ 2 Method ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.2</span></a>). Finally, we describe the hardware setup used for simulation (Sec. <a href="#S2.SS3" title="2.3 Hardware Implementation ‣ 2 Method ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.3</span></a>).</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Synthetic Dataset</h3>

<div id="S2.SS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS1.p1.1" class="ltx_p">We focus on permanent magnet localization with axisymmetric symmetry; any shape and size of magnets as long as it possesses rotational symmetry about its magnetization axis. This set includes all cylinders, spheres, and arbitrary cross-section toroids magnetized on its principal axis, enclosing all the most used types of permanent magnets.
This symmetry of the magnets allows us to make only one high-resolution 2D FEM simulation for every magnet shape.
We revolve this 2D cross-section around its principle axis to obtain the 3D volume then place it anywhere in the space. From a single 2D FEM simulation, we generate synthetic readings for all sensors, with arbitrary location and orientation of the magnet. Such a synthetic dataset results in an improvement of the computational efficiency during training, letting us keep a good balance between granularity in simulation and requiring negligible storage space for the data.</p>
</div>
<figure id="S2.T1" class="ltx_table">

<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Variables used in Algorithm <a href="#alg1" title="Algorithm 1 ‣ Table 1 ‣ 2.1 Synthetic Dataset ‣ 2 Method ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table id="S2.T1.14" class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S2.T1.14.15.1" class="ltx_tr">
<th id="S2.T1.14.15.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><em id="S2.T1.14.15.1.1.1" class="ltx_emph ltx_font_italic">Variables</em></th>
<th id="S2.T1.14.15.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><em id="S2.T1.14.15.1.2.1" class="ltx_emph ltx_font_italic">Description</em></th>
</tr>
<tr id="S2.T1.3.3" class="ltx_tr">
<th id="S2.T1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">
<span id="S2.T1.1.1.1.1" class="ltx_inline-block ltx_parbox ltx_align_middle" style="width:30.0pt;">
<span id="S2.T1.1.1.1.1.1" class="ltx_p"><math id="S2.T1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathbf{p}^{C}_{i}" display="inline"><semantics id="S2.T1.1.1.1.1.1.m1.1a"><msubsup id="S2.T1.1.1.1.1.1.m1.1.1" xref="S2.T1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.T1.1.1.1.1.1.m1.1.1.2.2" xref="S2.T1.1.1.1.1.1.m1.1.1.2.2.cmml">𝐩</mi><mi id="S2.T1.1.1.1.1.1.m1.1.1.3" xref="S2.T1.1.1.1.1.1.m1.1.1.3.cmml">i</mi><mi id="S2.T1.1.1.1.1.1.m1.1.1.2.3" xref="S2.T1.1.1.1.1.1.m1.1.1.2.3.cmml">C</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.T1.1.1.1.1.1.m1.1b"><apply id="S2.T1.1.1.1.1.1.m1.1.1.cmml" xref="S2.T1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.T1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.T1.1.1.1.1.1.m1.1.1">subscript</csymbol><apply id="S2.T1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.T1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.T1.1.1.1.1.1.m1.1.1.2.1.cmml" xref="S2.T1.1.1.1.1.1.m1.1.1">superscript</csymbol><ci id="S2.T1.1.1.1.1.1.m1.1.1.2.2.cmml" xref="S2.T1.1.1.1.1.1.m1.1.1.2.2">𝐩</ci><ci id="S2.T1.1.1.1.1.1.m1.1.1.2.3.cmml" xref="S2.T1.1.1.1.1.1.m1.1.1.2.3">𝐶</ci></apply><ci id="S2.T1.1.1.1.1.1.m1.1.1.3.cmml" xref="S2.T1.1.1.1.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.1.1.1.1.1.m1.1c">\mathbf{p}^{C}_{i}</annotation></semantics></math></span>
</span>
</th>
<th id="S2.T1.3.3.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Positional vector. For <sup id="S2.T1.3.3.3.1" class="ltx_sup"><span id="S2.T1.3.3.3.1.1" class="ltx_text ltx_font_italic">C</span></sup> and <sub id="S2.T1.3.3.3.2" class="ltx_sub"><span id="S2.T1.3.3.3.2.1" class="ltx_text ltx_font_italic">i</span></sub> see below.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S2.T1.6.6" class="ltx_tr">
<th id="S2.T1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S2.T1.4.4.1.m1.2" class="ltx_Math" alttext="C\in\{D,M\}" display="inline"><semantics id="S2.T1.4.4.1.m1.2a"><mrow id="S2.T1.4.4.1.m1.2.3" xref="S2.T1.4.4.1.m1.2.3.cmml"><mi id="S2.T1.4.4.1.m1.2.3.2" xref="S2.T1.4.4.1.m1.2.3.2.cmml">C</mi><mo id="S2.T1.4.4.1.m1.2.3.1" xref="S2.T1.4.4.1.m1.2.3.1.cmml">∈</mo><mrow id="S2.T1.4.4.1.m1.2.3.3.2" xref="S2.T1.4.4.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S2.T1.4.4.1.m1.2.3.3.2.1" xref="S2.T1.4.4.1.m1.2.3.3.1.cmml">{</mo><mi id="S2.T1.4.4.1.m1.1.1" xref="S2.T1.4.4.1.m1.1.1.cmml">D</mi><mo id="S2.T1.4.4.1.m1.2.3.3.2.2" xref="S2.T1.4.4.1.m1.2.3.3.1.cmml">,</mo><mi id="S2.T1.4.4.1.m1.2.2" xref="S2.T1.4.4.1.m1.2.2.cmml">M</mi><mo stretchy="false" id="S2.T1.4.4.1.m1.2.3.3.2.3" xref="S2.T1.4.4.1.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.4.4.1.m1.2b"><apply id="S2.T1.4.4.1.m1.2.3.cmml" xref="S2.T1.4.4.1.m1.2.3"><in id="S2.T1.4.4.1.m1.2.3.1.cmml" xref="S2.T1.4.4.1.m1.2.3.1"></in><ci id="S2.T1.4.4.1.m1.2.3.2.cmml" xref="S2.T1.4.4.1.m1.2.3.2">𝐶</ci><set id="S2.T1.4.4.1.m1.2.3.3.1.cmml" xref="S2.T1.4.4.1.m1.2.3.3.2"><ci id="S2.T1.4.4.1.m1.1.1.cmml" xref="S2.T1.4.4.1.m1.1.1">𝐷</ci><ci id="S2.T1.4.4.1.m1.2.2.cmml" xref="S2.T1.4.4.1.m1.2.2">𝑀</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.4.4.1.m1.2c">C\in\{D,M\}</annotation></semantics></math></th>
<td id="S2.T1.6.6.3" class="ltx_td ltx_align_left">Coordinate system on device (<math id="S2.T1.5.5.2.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S2.T1.5.5.2.m1.1a"><mi id="S2.T1.5.5.2.m1.1.1" xref="S2.T1.5.5.2.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S2.T1.5.5.2.m1.1b"><ci id="S2.T1.5.5.2.m1.1.1.cmml" xref="S2.T1.5.5.2.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.5.5.2.m1.1c">D</annotation></semantics></math>) or magnet (<math id="S2.T1.6.6.3.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S2.T1.6.6.3.m2.1a"><mi id="S2.T1.6.6.3.m2.1.1" xref="S2.T1.6.6.3.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.T1.6.6.3.m2.1b"><ci id="S2.T1.6.6.3.m2.1.1.cmml" xref="S2.T1.6.6.3.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.6.6.3.m2.1c">M</annotation></semantics></math>)</td>
</tr>
<tr id="S2.T1.9.9" class="ltx_tr">
<th id="S2.T1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S2.T1.7.7.1.m1.2" class="ltx_Math" alttext="i\in\{s,m\}" display="inline"><semantics id="S2.T1.7.7.1.m1.2a"><mrow id="S2.T1.7.7.1.m1.2.3" xref="S2.T1.7.7.1.m1.2.3.cmml"><mi id="S2.T1.7.7.1.m1.2.3.2" xref="S2.T1.7.7.1.m1.2.3.2.cmml">i</mi><mo id="S2.T1.7.7.1.m1.2.3.1" xref="S2.T1.7.7.1.m1.2.3.1.cmml">∈</mo><mrow id="S2.T1.7.7.1.m1.2.3.3.2" xref="S2.T1.7.7.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S2.T1.7.7.1.m1.2.3.3.2.1" xref="S2.T1.7.7.1.m1.2.3.3.1.cmml">{</mo><mi id="S2.T1.7.7.1.m1.1.1" xref="S2.T1.7.7.1.m1.1.1.cmml">s</mi><mo id="S2.T1.7.7.1.m1.2.3.3.2.2" xref="S2.T1.7.7.1.m1.2.3.3.1.cmml">,</mo><mi id="S2.T1.7.7.1.m1.2.2" xref="S2.T1.7.7.1.m1.2.2.cmml">m</mi><mo stretchy="false" id="S2.T1.7.7.1.m1.2.3.3.2.3" xref="S2.T1.7.7.1.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.7.7.1.m1.2b"><apply id="S2.T1.7.7.1.m1.2.3.cmml" xref="S2.T1.7.7.1.m1.2.3"><in id="S2.T1.7.7.1.m1.2.3.1.cmml" xref="S2.T1.7.7.1.m1.2.3.1"></in><ci id="S2.T1.7.7.1.m1.2.3.2.cmml" xref="S2.T1.7.7.1.m1.2.3.2">𝑖</ci><set id="S2.T1.7.7.1.m1.2.3.3.1.cmml" xref="S2.T1.7.7.1.m1.2.3.3.2"><ci id="S2.T1.7.7.1.m1.1.1.cmml" xref="S2.T1.7.7.1.m1.1.1">𝑠</ci><ci id="S2.T1.7.7.1.m1.2.2.cmml" xref="S2.T1.7.7.1.m1.2.2">𝑚</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.7.7.1.m1.2c">i\in\{s,m\}</annotation></semantics></math></th>
<td id="S2.T1.9.9.3" class="ltx_td ltx_align_left">Positional vector of sensor (<math id="S2.T1.8.8.2.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S2.T1.8.8.2.m1.1a"><mi id="S2.T1.8.8.2.m1.1.1" xref="S2.T1.8.8.2.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.T1.8.8.2.m1.1b"><ci id="S2.T1.8.8.2.m1.1.1.cmml" xref="S2.T1.8.8.2.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.8.8.2.m1.1c">S</annotation></semantics></math>) or magnet (<math id="S2.T1.9.9.3.m2.1" class="ltx_math_unparsed" alttext="m)" display="inline"><semantics id="S2.T1.9.9.3.m2.1a"><mrow id="S2.T1.9.9.3.m2.1b"><mi id="S2.T1.9.9.3.m2.1.1">m</mi><mo stretchy="false" id="S2.T1.9.9.3.m2.1.2">)</mo></mrow><annotation encoding="application/x-tex" id="S2.T1.9.9.3.m2.1c">m)</annotation></semantics></math>
</td>
</tr>
<tr id="S2.T1.11.11" class="ltx_tr">
<th id="S2.T1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S2.T1.10.10.1.m1.3" class="ltx_Math" alttext="\mathbf{u,v,w}" display="inline"><semantics id="S2.T1.10.10.1.m1.3a"><mrow id="S2.T1.10.10.1.m1.3.4.2" xref="S2.T1.10.10.1.m1.3.4.1.cmml"><mi id="S2.T1.10.10.1.m1.1.1" xref="S2.T1.10.10.1.m1.1.1.cmml">𝐮</mi><mo id="S2.T1.10.10.1.m1.3.4.2.1" xref="S2.T1.10.10.1.m1.3.4.1.cmml">,</mo><mi id="S2.T1.10.10.1.m1.2.2" xref="S2.T1.10.10.1.m1.2.2.cmml">𝐯</mi><mo id="S2.T1.10.10.1.m1.3.4.2.2" xref="S2.T1.10.10.1.m1.3.4.1.cmml">,</mo><mi id="S2.T1.10.10.1.m1.3.3" xref="S2.T1.10.10.1.m1.3.3.cmml">𝐰</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.10.10.1.m1.3b"><list id="S2.T1.10.10.1.m1.3.4.1.cmml" xref="S2.T1.10.10.1.m1.3.4.2"><ci id="S2.T1.10.10.1.m1.1.1.cmml" xref="S2.T1.10.10.1.m1.1.1">𝐮</ci><ci id="S2.T1.10.10.1.m1.2.2.cmml" xref="S2.T1.10.10.1.m1.2.2">𝐯</ci><ci id="S2.T1.10.10.1.m1.3.3.cmml" xref="S2.T1.10.10.1.m1.3.3">𝐰</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.10.10.1.m1.3c">\mathbf{u,v,w}</annotation></semantics></math></th>
<td id="S2.T1.11.11.2" class="ltx_td ltx_align_left">Axis in magnet’s coordinate (<math id="S2.T1.11.11.2.m1.1" class="ltx_Math" alttext="C_{D}" display="inline"><semantics id="S2.T1.11.11.2.m1.1a"><msub id="S2.T1.11.11.2.m1.1.1" xref="S2.T1.11.11.2.m1.1.1.cmml"><mi id="S2.T1.11.11.2.m1.1.1.2" xref="S2.T1.11.11.2.m1.1.1.2.cmml">C</mi><mi id="S2.T1.11.11.2.m1.1.1.3" xref="S2.T1.11.11.2.m1.1.1.3.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S2.T1.11.11.2.m1.1b"><apply id="S2.T1.11.11.2.m1.1.1.cmml" xref="S2.T1.11.11.2.m1.1.1"><csymbol cd="ambiguous" id="S2.T1.11.11.2.m1.1.1.1.cmml" xref="S2.T1.11.11.2.m1.1.1">subscript</csymbol><ci id="S2.T1.11.11.2.m1.1.1.2.cmml" xref="S2.T1.11.11.2.m1.1.1.2">𝐶</ci><ci id="S2.T1.11.11.2.m1.1.1.3.cmml" xref="S2.T1.11.11.2.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.11.11.2.m1.1c">C_{D}</annotation></semantics></math>)</td>
</tr>
<tr id="S2.T1.13.13" class="ltx_tr">
<th id="S2.T1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S2.T1.12.12.1.m1.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.T1.12.12.1.m1.1a"><mi id="S2.T1.12.12.1.m1.1.1" xref="S2.T1.12.12.1.m1.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.T1.12.12.1.m1.1b"><ci id="S2.T1.12.12.1.m1.1.1.cmml" xref="S2.T1.12.12.1.m1.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.12.12.1.m1.1c">\mathbf{w}</annotation></semantics></math></th>
<td id="S2.T1.13.13.2" class="ltx_td ltx_align_left">Magnetic moment direction in <math id="S2.T1.13.13.2.m1.1" class="ltx_Math" alttext="C_{D}" display="inline"><semantics id="S2.T1.13.13.2.m1.1a"><msub id="S2.T1.13.13.2.m1.1.1" xref="S2.T1.13.13.2.m1.1.1.cmml"><mi id="S2.T1.13.13.2.m1.1.1.2" xref="S2.T1.13.13.2.m1.1.1.2.cmml">C</mi><mi id="S2.T1.13.13.2.m1.1.1.3" xref="S2.T1.13.13.2.m1.1.1.3.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S2.T1.13.13.2.m1.1b"><apply id="S2.T1.13.13.2.m1.1.1.cmml" xref="S2.T1.13.13.2.m1.1.1"><csymbol cd="ambiguous" id="S2.T1.13.13.2.m1.1.1.1.cmml" xref="S2.T1.13.13.2.m1.1.1">subscript</csymbol><ci id="S2.T1.13.13.2.m1.1.1.2.cmml" xref="S2.T1.13.13.2.m1.1.1.2">𝐶</ci><ci id="S2.T1.13.13.2.m1.1.1.3.cmml" xref="S2.T1.13.13.2.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.13.13.2.m1.1c">C_{D}</annotation></semantics></math>
</td>
</tr>
<tr id="S2.T1.14.14" class="ltx_tr">
<th id="S2.T1.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b"><math id="S2.T1.14.14.1.m1.1" class="ltx_Math" alttext="\mathbf{B}" display="inline"><semantics id="S2.T1.14.14.1.m1.1a"><mi id="S2.T1.14.14.1.m1.1.1" xref="S2.T1.14.14.1.m1.1.1.cmml">𝐁</mi><annotation-xml encoding="MathML-Content" id="S2.T1.14.14.1.m1.1b"><ci id="S2.T1.14.14.1.m1.1.1.cmml" xref="S2.T1.14.14.1.m1.1.1">𝐁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.14.14.1.m1.1c">\mathbf{B}</annotation></semantics></math></th>
<td id="S2.T1.14.14.2" class="ltx_td ltx_align_left ltx_border_b">Magnetic flux density</td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="alg1" class="ltx_float ltx_figure_panel ltx_float_algorithm ltx_align_center ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Synthethic dataset generation</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span><span id="alg1.l1.1" class="ltx_text ltx_font_bold">Input</span> <math id="alg1.l1.m1.1" class="ltx_Math" alttext="\mathbf{p}^{D}_{s}" display="inline"><semantics id="alg1.l1.m1.1a"><msubsup id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2.2" xref="alg1.l1.m1.1.1.2.2.cmml">𝐩</mi><mi id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">s</mi><mi id="alg1.l1.m1.1.1.2.3" xref="alg1.l1.m1.1.1.2.3.cmml">D</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><apply id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.2.1.cmml" xref="alg1.l1.m1.1.1">superscript</csymbol><ci id="alg1.l1.m1.1.1.2.2.cmml" xref="alg1.l1.m1.1.1.2.2">𝐩</ci><ci id="alg1.l1.m1.1.1.2.3.cmml" xref="alg1.l1.m1.1.1.2.3">𝐷</ci></apply><ci id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathbf{p}^{D}_{s}</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span><math id="alg1.l2.m1.1" class="ltx_Math" alttext="\mathbf{p}_{d}^{D}\leftarrow\mathbf{p}^{D}_{m}-\mathbf{p}^{D}_{s}" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><msubsup id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml"><mi id="alg1.l2.m1.1.1.2.2.2" xref="alg1.l2.m1.1.1.2.2.2.cmml">𝐩</mi><mi id="alg1.l2.m1.1.1.2.2.3" xref="alg1.l2.m1.1.1.2.2.3.cmml">d</mi><mi id="alg1.l2.m1.1.1.2.3" xref="alg1.l2.m1.1.1.2.3.cmml">D</mi></msubsup><mo stretchy="false" id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">←</mo><mrow id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml"><msubsup id="alg1.l2.m1.1.1.3.2" xref="alg1.l2.m1.1.1.3.2.cmml"><mi id="alg1.l2.m1.1.1.3.2.2.2" xref="alg1.l2.m1.1.1.3.2.2.2.cmml">𝐩</mi><mi id="alg1.l2.m1.1.1.3.2.3" xref="alg1.l2.m1.1.1.3.2.3.cmml">m</mi><mi id="alg1.l2.m1.1.1.3.2.2.3" xref="alg1.l2.m1.1.1.3.2.2.3.cmml">D</mi></msubsup><mo id="alg1.l2.m1.1.1.3.1" xref="alg1.l2.m1.1.1.3.1.cmml">−</mo><msubsup id="alg1.l2.m1.1.1.3.3" xref="alg1.l2.m1.1.1.3.3.cmml"><mi id="alg1.l2.m1.1.1.3.3.2.2" xref="alg1.l2.m1.1.1.3.3.2.2.cmml">𝐩</mi><mi id="alg1.l2.m1.1.1.3.3.3" xref="alg1.l2.m1.1.1.3.3.3.cmml">s</mi><mi id="alg1.l2.m1.1.1.3.3.2.3" xref="alg1.l2.m1.1.1.3.3.2.3.cmml">D</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">←</ci><apply id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.2.1.cmml" xref="alg1.l2.m1.1.1.2">superscript</csymbol><apply id="alg1.l2.m1.1.1.2.2.cmml" xref="alg1.l2.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.2.2.1.cmml" xref="alg1.l2.m1.1.1.2">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.2.2.cmml" xref="alg1.l2.m1.1.1.2.2.2">𝐩</ci><ci id="alg1.l2.m1.1.1.2.2.3.cmml" xref="alg1.l2.m1.1.1.2.2.3">𝑑</ci></apply><ci id="alg1.l2.m1.1.1.2.3.cmml" xref="alg1.l2.m1.1.1.2.3">𝐷</ci></apply><apply id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3"><minus id="alg1.l2.m1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.3.1"></minus><apply id="alg1.l2.m1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.3.2.1.cmml" xref="alg1.l2.m1.1.1.3.2">subscript</csymbol><apply id="alg1.l2.m1.1.1.3.2.2.cmml" xref="alg1.l2.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.3.2.2.1.cmml" xref="alg1.l2.m1.1.1.3.2">superscript</csymbol><ci id="alg1.l2.m1.1.1.3.2.2.2.cmml" xref="alg1.l2.m1.1.1.3.2.2.2">𝐩</ci><ci id="alg1.l2.m1.1.1.3.2.2.3.cmml" xref="alg1.l2.m1.1.1.3.2.2.3">𝐷</ci></apply><ci id="alg1.l2.m1.1.1.3.2.3.cmml" xref="alg1.l2.m1.1.1.3.2.3">𝑚</ci></apply><apply id="alg1.l2.m1.1.1.3.3.cmml" xref="alg1.l2.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.3.3.1.cmml" xref="alg1.l2.m1.1.1.3.3">subscript</csymbol><apply id="alg1.l2.m1.1.1.3.3.2.cmml" xref="alg1.l2.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.3.3.2.1.cmml" xref="alg1.l2.m1.1.1.3.3">superscript</csymbol><ci id="alg1.l2.m1.1.1.3.3.2.2.cmml" xref="alg1.l2.m1.1.1.3.3.2.2">𝐩</ci><ci id="alg1.l2.m1.1.1.3.3.2.3.cmml" xref="alg1.l2.m1.1.1.3.3.2.3">𝐷</ci></apply><ci id="alg1.l2.m1.1.1.3.3.3.cmml" xref="alg1.l2.m1.1.1.3.3.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\mathbf{p}_{d}^{D}\leftarrow\mathbf{p}^{D}_{m}-\mathbf{p}^{D}_{s}</annotation></semantics></math> <span id="alg1.l2.1" class="ltx_text" style="float:right;"><math id="alg1.l2.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l2.1.m1.1a"><mo id="alg1.l2.1.m1.1.1" xref="alg1.l2.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l2.1.m1.1b"><ci id="alg1.l2.1.m1.1.1.cmml" xref="alg1.l2.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.1.m1.1c">\triangleright</annotation></semantics></math> Magnet-sensor vector
</span>
</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span><math id="alg1.l3.m1.1" class="ltx_Math" alttext="\mathbf{v}\leftarrow\mathbf{w}\times\mathbf{p}_{d}^{D}" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">𝐯</mi><mo stretchy="false" id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">←</mo><mrow id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"><mi id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.3.2.cmml">𝐰</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l3.m1.1.1.3.1" xref="alg1.l3.m1.1.1.3.1.cmml">×</mo><msubsup id="alg1.l3.m1.1.1.3.3" xref="alg1.l3.m1.1.1.3.3.cmml"><mi id="alg1.l3.m1.1.1.3.3.2.2" xref="alg1.l3.m1.1.1.3.3.2.2.cmml">𝐩</mi><mi id="alg1.l3.m1.1.1.3.3.2.3" xref="alg1.l3.m1.1.1.3.3.2.3.cmml">d</mi><mi id="alg1.l3.m1.1.1.3.3.3" xref="alg1.l3.m1.1.1.3.3.3.cmml">D</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><ci id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1">←</ci><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝐯</ci><apply id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"><times id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3.1"></times><ci id="alg1.l3.m1.1.1.3.2.cmml" xref="alg1.l3.m1.1.1.3.2">𝐰</ci><apply id="alg1.l3.m1.1.1.3.3.cmml" xref="alg1.l3.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.3.3.1.cmml" xref="alg1.l3.m1.1.1.3.3">superscript</csymbol><apply id="alg1.l3.m1.1.1.3.3.2.cmml" xref="alg1.l3.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.3.3.2.1.cmml" xref="alg1.l3.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l3.m1.1.1.3.3.2.2.cmml" xref="alg1.l3.m1.1.1.3.3.2.2">𝐩</ci><ci id="alg1.l3.m1.1.1.3.3.2.3.cmml" xref="alg1.l3.m1.1.1.3.3.2.3">𝑑</ci></apply><ci id="alg1.l3.m1.1.1.3.3.3.cmml" xref="alg1.l3.m1.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\mathbf{v}\leftarrow\mathbf{w}\times\mathbf{p}_{d}^{D}</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span><span id="alg1.l4.4" class="ltx_text ltx_font_bold">while</span> <math id="alg1.l4.m1.1" class="ltx_Math" alttext="\mathbf{v}=\mathbf{0}" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">𝐯</mi><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">=</mo><mn id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">𝟎</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><eq id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></eq><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝐯</ci><cn type="integer" id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\mathbf{v}=\mathbf{0}</annotation></semantics></math> <span id="alg1.l4.5" class="ltx_text ltx_font_bold">do</span> <span id="alg1.l4.3" class="ltx_text" style="float:right;"><math id="alg1.l4.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l4.1.m1.1a"><mo id="alg1.l4.1.m1.1.1" xref="alg1.l4.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l4.1.m1.1b"><ci id="alg1.l4.1.m1.1.1.cmml" xref="alg1.l4.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.1.m1.1c">\triangleright</annotation></semantics></math> If <math id="alg1.l4.2.m2.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="alg1.l4.2.m2.1a"><mi id="alg1.l4.2.m2.1.1" xref="alg1.l4.2.m2.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.2.m2.1b"><ci id="alg1.l4.2.m2.1.1.cmml" xref="alg1.l4.2.m2.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.2.m2.1c">\mathbf{w}</annotation></semantics></math> and <math id="alg1.l4.3.m3.1" class="ltx_Math" alttext="\mathbf{p}_{d}^{D}" display="inline"><semantics id="alg1.l4.3.m3.1a"><msubsup id="alg1.l4.3.m3.1.1" xref="alg1.l4.3.m3.1.1.cmml"><mi id="alg1.l4.3.m3.1.1.2.2" xref="alg1.l4.3.m3.1.1.2.2.cmml">𝐩</mi><mi id="alg1.l4.3.m3.1.1.2.3" xref="alg1.l4.3.m3.1.1.2.3.cmml">d</mi><mi id="alg1.l4.3.m3.1.1.3" xref="alg1.l4.3.m3.1.1.3.cmml">D</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l4.3.m3.1b"><apply id="alg1.l4.3.m3.1.1.cmml" xref="alg1.l4.3.m3.1.1"><csymbol cd="ambiguous" id="alg1.l4.3.m3.1.1.1.cmml" xref="alg1.l4.3.m3.1.1">superscript</csymbol><apply id="alg1.l4.3.m3.1.1.2.cmml" xref="alg1.l4.3.m3.1.1"><csymbol cd="ambiguous" id="alg1.l4.3.m3.1.1.2.1.cmml" xref="alg1.l4.3.m3.1.1">subscript</csymbol><ci id="alg1.l4.3.m3.1.1.2.2.cmml" xref="alg1.l4.3.m3.1.1.2.2">𝐩</ci><ci id="alg1.l4.3.m3.1.1.2.3.cmml" xref="alg1.l4.3.m3.1.1.2.3">𝑑</ci></apply><ci id="alg1.l4.3.m3.1.1.3.cmml" xref="alg1.l4.3.m3.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.3.m3.1c">\mathbf{p}_{d}^{D}</annotation></semantics></math> are (anti-)parallel
</span>
</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>     random <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\mathbf{q}" display="inline"><semantics id="alg1.l5.m1.1a"><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">𝐪</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝐪</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\mathbf{q}</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <math id="alg1.l6.m1.1" class="ltx_Math" alttext="\mathbf{v}\leftarrow\mathbf{q}\times\mathbf{w}" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">𝐯</mi><mo stretchy="false" id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">←</mo><mrow id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.3.2" xref="alg1.l6.m1.1.1.3.2.cmml">𝐪</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l6.m1.1.1.3.1" xref="alg1.l6.m1.1.1.3.1.cmml">×</mo><mi id="alg1.l6.m1.1.1.3.3" xref="alg1.l6.m1.1.1.3.3.cmml">𝐰</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">←</ci><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝐯</ci><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><times id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3.1"></times><ci id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3.2">𝐪</ci><ci id="alg1.l6.m1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.3.3">𝐰</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\mathbf{v}\leftarrow\mathbf{q}\times\mathbf{w}</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span><math id="alg1.l7.m1.1" class="ltx_Math" alttext="\mathbf{u}\leftarrow\mathbf{v}\times\mathbf{w}" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">𝐮</mi><mo stretchy="false" id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">←</mo><mrow id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"><mi id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2.cmml">𝐯</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l7.m1.1.1.3.1" xref="alg1.l7.m1.1.1.3.1.cmml">×</mo><mi id="alg1.l7.m1.1.1.3.3" xref="alg1.l7.m1.1.1.3.3.cmml">𝐰</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">←</ci><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝐮</ci><apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"><times id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3.1"></times><ci id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2">𝐯</ci><ci id="alg1.l7.m1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.3.3">𝐰</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">\mathbf{u}\leftarrow\mathbf{v}\times\mathbf{w}</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span><math id="alg1.l8.m1.1" class="ltx_Math" alttext="dw\leftarrow\mathbf{p}_{d}^{D}\cdot\frac{\mathbf{w}}{||\mathbf{w}||}" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.2" xref="alg1.l8.m1.1.2.cmml"><mrow id="alg1.l8.m1.1.2.2" xref="alg1.l8.m1.1.2.2.cmml"><mi id="alg1.l8.m1.1.2.2.2" xref="alg1.l8.m1.1.2.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.2.2.1" xref="alg1.l8.m1.1.2.2.1.cmml">​</mo><mi id="alg1.l8.m1.1.2.2.3" xref="alg1.l8.m1.1.2.2.3.cmml">w</mi></mrow><mo stretchy="false" id="alg1.l8.m1.1.2.1" xref="alg1.l8.m1.1.2.1.cmml">←</mo><mrow id="alg1.l8.m1.1.2.3" xref="alg1.l8.m1.1.2.3.cmml"><msubsup id="alg1.l8.m1.1.2.3.2" xref="alg1.l8.m1.1.2.3.2.cmml"><mi id="alg1.l8.m1.1.2.3.2.2.2" xref="alg1.l8.m1.1.2.3.2.2.2.cmml">𝐩</mi><mi id="alg1.l8.m1.1.2.3.2.2.3" xref="alg1.l8.m1.1.2.3.2.2.3.cmml">d</mi><mi id="alg1.l8.m1.1.2.3.2.3" xref="alg1.l8.m1.1.2.3.2.3.cmml">D</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="alg1.l8.m1.1.2.3.1" xref="alg1.l8.m1.1.2.3.1.cmml">⋅</mo><mfrac id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">𝐰</mi><mrow id="alg1.l8.m1.1.1.1.3" xref="alg1.l8.m1.1.1.1.2.cmml"><mo maxsize="142%" minsize="142%" id="alg1.l8.m1.1.1.1.3.1" xref="alg1.l8.m1.1.1.1.2.1.cmml">‖</mo><mi id="alg1.l8.m1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.cmml">𝐰</mi><mo maxsize="142%" minsize="142%" id="alg1.l8.m1.1.1.1.3.2" xref="alg1.l8.m1.1.1.1.2.1.cmml">‖</mo></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.2.cmml" xref="alg1.l8.m1.1.2"><ci id="alg1.l8.m1.1.2.1.cmml" xref="alg1.l8.m1.1.2.1">←</ci><apply id="alg1.l8.m1.1.2.2.cmml" xref="alg1.l8.m1.1.2.2"><times id="alg1.l8.m1.1.2.2.1.cmml" xref="alg1.l8.m1.1.2.2.1"></times><ci id="alg1.l8.m1.1.2.2.2.cmml" xref="alg1.l8.m1.1.2.2.2">𝑑</ci><ci id="alg1.l8.m1.1.2.2.3.cmml" xref="alg1.l8.m1.1.2.2.3">𝑤</ci></apply><apply id="alg1.l8.m1.1.2.3.cmml" xref="alg1.l8.m1.1.2.3"><ci id="alg1.l8.m1.1.2.3.1.cmml" xref="alg1.l8.m1.1.2.3.1">⋅</ci><apply id="alg1.l8.m1.1.2.3.2.cmml" xref="alg1.l8.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.2.3.2.1.cmml" xref="alg1.l8.m1.1.2.3.2">superscript</csymbol><apply id="alg1.l8.m1.1.2.3.2.2.cmml" xref="alg1.l8.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.2.3.2.2.1.cmml" xref="alg1.l8.m1.1.2.3.2">subscript</csymbol><ci id="alg1.l8.m1.1.2.3.2.2.2.cmml" xref="alg1.l8.m1.1.2.3.2.2.2">𝐩</ci><ci id="alg1.l8.m1.1.2.3.2.2.3.cmml" xref="alg1.l8.m1.1.2.3.2.2.3">𝑑</ci></apply><ci id="alg1.l8.m1.1.2.3.2.3.cmml" xref="alg1.l8.m1.1.2.3.2.3">𝐷</ci></apply><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><divide id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1"></divide><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">𝐰</ci><apply id="alg1.l8.m1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.3"><csymbol cd="latexml" id="alg1.l8.m1.1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.1.3.1">norm</csymbol><ci id="alg1.l8.m1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1">𝐰</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">dw\leftarrow\mathbf{p}_{d}^{D}\cdot\frac{\mathbf{w}}{||\mathbf{w}||}</annotation></semantics></math> <span id="alg1.l8.3" class="ltx_text" style="float:right;"><math id="alg1.l8.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l8.1.m1.1a"><mo id="alg1.l8.1.m1.1.1" xref="alg1.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l8.1.m1.1b"><ci id="alg1.l8.1.m1.1.1.cmml" xref="alg1.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.1.m1.1c">\triangleright</annotation></semantics></math> the projection of <math id="alg1.l8.2.m2.1" class="ltx_Math" alttext="\mathbf{p}_{d}^{D}" display="inline"><semantics id="alg1.l8.2.m2.1a"><msubsup id="alg1.l8.2.m2.1.1" xref="alg1.l8.2.m2.1.1.cmml"><mi id="alg1.l8.2.m2.1.1.2.2" xref="alg1.l8.2.m2.1.1.2.2.cmml">𝐩</mi><mi id="alg1.l8.2.m2.1.1.2.3" xref="alg1.l8.2.m2.1.1.2.3.cmml">d</mi><mi id="alg1.l8.2.m2.1.1.3" xref="alg1.l8.2.m2.1.1.3.cmml">D</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l8.2.m2.1b"><apply id="alg1.l8.2.m2.1.1.cmml" xref="alg1.l8.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l8.2.m2.1.1.1.cmml" xref="alg1.l8.2.m2.1.1">superscript</csymbol><apply id="alg1.l8.2.m2.1.1.2.cmml" xref="alg1.l8.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l8.2.m2.1.1.2.1.cmml" xref="alg1.l8.2.m2.1.1">subscript</csymbol><ci id="alg1.l8.2.m2.1.1.2.2.cmml" xref="alg1.l8.2.m2.1.1.2.2">𝐩</ci><ci id="alg1.l8.2.m2.1.1.2.3.cmml" xref="alg1.l8.2.m2.1.1.2.3">𝑑</ci></apply><ci id="alg1.l8.2.m2.1.1.3.cmml" xref="alg1.l8.2.m2.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.2.m2.1c">\mathbf{p}_{d}^{D}</annotation></semantics></math> on <math id="alg1.l8.3.m3.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="alg1.l8.3.m3.1a"><mi id="alg1.l8.3.m3.1.1" xref="alg1.l8.3.m3.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.3.m3.1b"><ci id="alg1.l8.3.m3.1.1.cmml" xref="alg1.l8.3.m3.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.3.m3.1c">\mathbf{w}</annotation></semantics></math>
</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span><math id="alg1.l9.m1.1" class="ltx_Math" alttext="du\leftarrow\sqrt{|\mathbf{p}_{d}^{D}|^{2}-dw^{2}}" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.2" xref="alg1.l9.m1.1.2.cmml"><mrow id="alg1.l9.m1.1.2.2" xref="alg1.l9.m1.1.2.2.cmml"><mi id="alg1.l9.m1.1.2.2.2" xref="alg1.l9.m1.1.2.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.2.2.1" xref="alg1.l9.m1.1.2.2.1.cmml">​</mo><mi id="alg1.l9.m1.1.2.2.3" xref="alg1.l9.m1.1.2.2.3.cmml">u</mi></mrow><mo stretchy="false" id="alg1.l9.m1.1.2.1" xref="alg1.l9.m1.1.2.1.cmml">←</mo><msqrt id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mrow id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml"><msup id="alg1.l9.m1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.cmml"><mrow id="alg1.l9.m1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l9.m1.1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.2.1.cmml">|</mo><msubsup id="alg1.l9.m1.1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l9.m1.1.1.1.1.1.1.1.2.2.cmml">𝐩</mi><mi id="alg1.l9.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l9.m1.1.1.1.1.1.1.1.2.3.cmml">d</mi><mi id="alg1.l9.m1.1.1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.1.1.3.cmml">D</mi></msubsup><mo stretchy="false" id="alg1.l9.m1.1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mn id="alg1.l9.m1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.3.cmml">2</mn></msup><mo id="alg1.l9.m1.1.1.1.2" xref="alg1.l9.m1.1.1.1.2.cmml">−</mo><mrow id="alg1.l9.m1.1.1.1.3" xref="alg1.l9.m1.1.1.1.3.cmml"><mi id="alg1.l9.m1.1.1.1.3.2" xref="alg1.l9.m1.1.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.1.3.1" xref="alg1.l9.m1.1.1.1.3.1.cmml">​</mo><msup id="alg1.l9.m1.1.1.1.3.3" xref="alg1.l9.m1.1.1.1.3.3.cmml"><mi id="alg1.l9.m1.1.1.1.3.3.2" xref="alg1.l9.m1.1.1.1.3.3.2.cmml">w</mi><mn id="alg1.l9.m1.1.1.1.3.3.3" xref="alg1.l9.m1.1.1.1.3.3.3.cmml">2</mn></msup></mrow></mrow></msqrt></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.2.cmml" xref="alg1.l9.m1.1.2"><ci id="alg1.l9.m1.1.2.1.cmml" xref="alg1.l9.m1.1.2.1">←</ci><apply id="alg1.l9.m1.1.2.2.cmml" xref="alg1.l9.m1.1.2.2"><times id="alg1.l9.m1.1.2.2.1.cmml" xref="alg1.l9.m1.1.2.2.1"></times><ci id="alg1.l9.m1.1.2.2.2.cmml" xref="alg1.l9.m1.1.2.2.2">𝑑</ci><ci id="alg1.l9.m1.1.2.2.3.cmml" xref="alg1.l9.m1.1.2.2.3">𝑢</ci></apply><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><root id="alg1.l9.m1.1.1a.cmml" xref="alg1.l9.m1.1.1"></root><apply id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"><minus id="alg1.l9.m1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.2"></minus><apply id="alg1.l9.m1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1">superscript</csymbol><apply id="alg1.l9.m1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1"><abs id="alg1.l9.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2"></abs><apply id="alg1.l9.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l9.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.2.2">𝐩</ci><ci id="alg1.l9.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.2.3">𝑑</ci></apply><ci id="alg1.l9.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.3">𝐷</ci></apply></apply><cn type="integer" id="alg1.l9.m1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.3">2</cn></apply><apply id="alg1.l9.m1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.3"><times id="alg1.l9.m1.1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.1.3.1"></times><ci id="alg1.l9.m1.1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.1.3.2">𝑑</ci><apply id="alg1.l9.m1.1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.3.3.1.cmml" xref="alg1.l9.m1.1.1.1.3.3">superscript</csymbol><ci id="alg1.l9.m1.1.1.1.3.3.2.cmml" xref="alg1.l9.m1.1.1.1.3.3.2">𝑤</ci><cn type="integer" id="alg1.l9.m1.1.1.1.3.3.3.cmml" xref="alg1.l9.m1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">du\leftarrow\sqrt{|\mathbf{p}_{d}^{D}|^{2}-dw^{2}}</annotation></semantics></math> <span id="alg1.l9.3" class="ltx_text" style="float:right;"><math id="alg1.l9.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l9.1.m1.1a"><mo id="alg1.l9.1.m1.1.1" xref="alg1.l9.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l9.1.m1.1b"><ci id="alg1.l9.1.m1.1.1.cmml" xref="alg1.l9.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.1.m1.1c">\triangleright</annotation></semantics></math> the projection of <math id="alg1.l9.2.m2.1" class="ltx_Math" alttext="\mathbf{p}_{d}^{D}" display="inline"><semantics id="alg1.l9.2.m2.1a"><msubsup id="alg1.l9.2.m2.1.1" xref="alg1.l9.2.m2.1.1.cmml"><mi id="alg1.l9.2.m2.1.1.2.2" xref="alg1.l9.2.m2.1.1.2.2.cmml">𝐩</mi><mi id="alg1.l9.2.m2.1.1.2.3" xref="alg1.l9.2.m2.1.1.2.3.cmml">d</mi><mi id="alg1.l9.2.m2.1.1.3" xref="alg1.l9.2.m2.1.1.3.cmml">D</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l9.2.m2.1b"><apply id="alg1.l9.2.m2.1.1.cmml" xref="alg1.l9.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l9.2.m2.1.1.1.cmml" xref="alg1.l9.2.m2.1.1">superscript</csymbol><apply id="alg1.l9.2.m2.1.1.2.cmml" xref="alg1.l9.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l9.2.m2.1.1.2.1.cmml" xref="alg1.l9.2.m2.1.1">subscript</csymbol><ci id="alg1.l9.2.m2.1.1.2.2.cmml" xref="alg1.l9.2.m2.1.1.2.2">𝐩</ci><ci id="alg1.l9.2.m2.1.1.2.3.cmml" xref="alg1.l9.2.m2.1.1.2.3">𝑑</ci></apply><ci id="alg1.l9.2.m2.1.1.3.cmml" xref="alg1.l9.2.m2.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.2.m2.1c">\mathbf{p}_{d}^{D}</annotation></semantics></math> on <math id="alg1.l9.3.m3.1" class="ltx_Math" alttext="\mathbf{u}" display="inline"><semantics id="alg1.l9.3.m3.1a"><mi id="alg1.l9.3.m3.1.1" xref="alg1.l9.3.m3.1.1.cmml">𝐮</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.3.m3.1b"><ci id="alg1.l9.3.m3.1.1.cmml" xref="alg1.l9.3.m3.1.1">𝐮</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.3.m3.1c">\mathbf{u}</annotation></semantics></math>
</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span><math id="alg1.l10.m1.1" class="ltx_Math" alttext="dv\leftarrow 0" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mrow id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml"><mi id="alg1.l10.m1.1.1.2.2" xref="alg1.l10.m1.1.1.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.2.1" xref="alg1.l10.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l10.m1.1.1.2.3" xref="alg1.l10.m1.1.1.2.3.cmml">v</mi></mrow><mo stretchy="false" id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">←</mo><mn id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><ci id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1">←</ci><apply id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"><times id="alg1.l10.m1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.2.1"></times><ci id="alg1.l10.m1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.2.2">𝑑</ci><ci id="alg1.l10.m1.1.1.2.3.cmml" xref="alg1.l10.m1.1.1.2.3">𝑣</ci></apply><cn type="integer" id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">dv\leftarrow 0</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span><math id="alg1.l11.m1.2" class="ltx_Math" alttext="\mathbf{B}^{M}\leftarrow\mathbf{2D-FEM}(du,dw)" display="inline"><semantics id="alg1.l11.m1.2a"><mrow id="alg1.l11.m1.2.2" xref="alg1.l11.m1.2.2.cmml"><msup id="alg1.l11.m1.2.2.4" xref="alg1.l11.m1.2.2.4.cmml"><mi id="alg1.l11.m1.2.2.4.2" xref="alg1.l11.m1.2.2.4.2.cmml">𝐁</mi><mi id="alg1.l11.m1.2.2.4.3" xref="alg1.l11.m1.2.2.4.3.cmml">M</mi></msup><mo stretchy="false" id="alg1.l11.m1.2.2.3" xref="alg1.l11.m1.2.2.3.cmml">←</mo><mrow id="alg1.l11.m1.2.2.2" xref="alg1.l11.m1.2.2.2.cmml"><mrow id="alg1.l11.m1.2.2.2.4" xref="alg1.l11.m1.2.2.2.4.cmml"><mn id="alg1.l11.m1.2.2.2.4.2" xref="alg1.l11.m1.2.2.2.4.2.cmml">𝟐</mn><mo lspace="0em" rspace="0em" id="alg1.l11.m1.2.2.2.4.1" xref="alg1.l11.m1.2.2.2.4.1.cmml">​</mo><mi id="alg1.l11.m1.2.2.2.4.3" xref="alg1.l11.m1.2.2.2.4.3.cmml">𝐃</mi></mrow><mo id="alg1.l11.m1.2.2.2.3" xref="alg1.l11.m1.2.2.2.3.cmml">−</mo><mrow id="alg1.l11.m1.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.cmml"><mi id="alg1.l11.m1.2.2.2.2.4" xref="alg1.l11.m1.2.2.2.2.4.cmml">𝐅𝐄𝐌</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.2.2.2.2.3" xref="alg1.l11.m1.2.2.2.2.3.cmml">​</mo><mrow id="alg1.l11.m1.2.2.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l11.m1.2.2.2.2.2.2.3" xref="alg1.l11.m1.2.2.2.2.2.3.cmml">(</mo><mrow id="alg1.l11.m1.1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l11.m1.1.1.1.1.1.1.1.2" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.1.1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg1.l11.m1.1.1.1.1.1.1.1.3" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.cmml">u</mi></mrow><mo id="alg1.l11.m1.2.2.2.2.2.2.4" xref="alg1.l11.m1.2.2.2.2.2.3.cmml">,</mo><mrow id="alg1.l11.m1.2.2.2.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.2.2.2.cmml"><mi id="alg1.l11.m1.2.2.2.2.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.2.2.2.2.2.2.2.1" xref="alg1.l11.m1.2.2.2.2.2.2.2.1.cmml">​</mo><mi id="alg1.l11.m1.2.2.2.2.2.2.2.3" xref="alg1.l11.m1.2.2.2.2.2.2.2.3.cmml">w</mi></mrow><mo stretchy="false" id="alg1.l11.m1.2.2.2.2.2.2.5" xref="alg1.l11.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.2b"><apply id="alg1.l11.m1.2.2.cmml" xref="alg1.l11.m1.2.2"><ci id="alg1.l11.m1.2.2.3.cmml" xref="alg1.l11.m1.2.2.3">←</ci><apply id="alg1.l11.m1.2.2.4.cmml" xref="alg1.l11.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l11.m1.2.2.4.1.cmml" xref="alg1.l11.m1.2.2.4">superscript</csymbol><ci id="alg1.l11.m1.2.2.4.2.cmml" xref="alg1.l11.m1.2.2.4.2">𝐁</ci><ci id="alg1.l11.m1.2.2.4.3.cmml" xref="alg1.l11.m1.2.2.4.3">𝑀</ci></apply><apply id="alg1.l11.m1.2.2.2.cmml" xref="alg1.l11.m1.2.2.2"><minus id="alg1.l11.m1.2.2.2.3.cmml" xref="alg1.l11.m1.2.2.2.3"></minus><apply id="alg1.l11.m1.2.2.2.4.cmml" xref="alg1.l11.m1.2.2.2.4"><times id="alg1.l11.m1.2.2.2.4.1.cmml" xref="alg1.l11.m1.2.2.2.4.1"></times><cn type="integer" id="alg1.l11.m1.2.2.2.4.2.cmml" xref="alg1.l11.m1.2.2.2.4.2">2</cn><ci id="alg1.l11.m1.2.2.2.4.3.cmml" xref="alg1.l11.m1.2.2.2.4.3">𝐃</ci></apply><apply id="alg1.l11.m1.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.2"><times id="alg1.l11.m1.2.2.2.2.3.cmml" xref="alg1.l11.m1.2.2.2.2.3"></times><ci id="alg1.l11.m1.2.2.2.2.4.cmml" xref="alg1.l11.m1.2.2.2.2.4">𝐅𝐄𝐌</ci><interval closure="open" id="alg1.l11.m1.2.2.2.2.2.3.cmml" xref="alg1.l11.m1.2.2.2.2.2.2"><apply id="alg1.l11.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1"><times id="alg1.l11.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1"></times><ci id="alg1.l11.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.2">𝑑</ci><ci id="alg1.l11.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="alg1.l11.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2"><times id="alg1.l11.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2.1"></times><ci id="alg1.l11.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2.2">𝑑</ci><ci id="alg1.l11.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2.3">𝑤</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.2c">\mathbf{B}^{M}\leftarrow\mathbf{2D-FEM}(du,dw)</annotation></semantics></math>

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>
<span id="alg1.l12.2" class="ltx_inline-block ltx_parbox ltx_align_middle" style="width:232.0pt;">
<span id="alg1.l12.1.1" class="ltx_p"><math id="alg1.l12.1.1.m1.3" class="ltx_Math" alttext="\mathbf{M}\leftarrow\big{[}\begin{smallmatrix}\frac{\mathbf{u}}{||\mathbf{u}||}^{\top}&amp;\frac{\mathbf{v}}{||\mathbf{v}||}^{\top}&amp;\frac{\mathbf{w}}{||\mathbf{w}||}^{\top}\end{smallmatrix}\big{]}^{\top}" display="inline"><semantics id="alg1.l12.1.1.m1.3a"><mrow id="alg1.l12.1.1.m1.3.4" xref="alg1.l12.1.1.m1.3.4.cmml"><mi id="alg1.l12.1.1.m1.3.4.2" xref="alg1.l12.1.1.m1.3.4.2.cmml">𝐌</mi><mo stretchy="false" id="alg1.l12.1.1.m1.3.4.1" xref="alg1.l12.1.1.m1.3.4.1.cmml">←</mo><msup id="alg1.l12.1.1.m1.3.4.3" xref="alg1.l12.1.1.m1.3.4.3.cmml"><mrow id="alg1.l12.1.1.m1.3.4.3.2.2" xref="alg1.l12.1.1.m1.3.4.3.2.1.cmml"><mo maxsize="120%" minsize="120%" id="alg1.l12.1.1.m1.3.4.3.2.2.1" xref="alg1.l12.1.1.m1.3.4.3.2.1.1.cmml">[</mo><mtable columnspacing="5pt" id="alg1.l12.1.1.m1.3.3" xref="alg1.l12.1.1.m1.3.3.cmml"><mtr id="alg1.l12.1.1.m1.3.3a" xref="alg1.l12.1.1.m1.3.3.cmml"><mtd id="alg1.l12.1.1.m1.3.3b" xref="alg1.l12.1.1.m1.3.3.cmml"><msup id="alg1.l12.1.1.m1.1.1.1.1.1" xref="alg1.l12.1.1.m1.1.1.1.1.1.cmml"><mfrac id="alg1.l12.1.1.m1.1.1.1.1.1.1" xref="alg1.l12.1.1.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l12.1.1.m1.1.1.1.1.1.1.3" xref="alg1.l12.1.1.m1.1.1.1.1.1.1.3.cmml">𝐮</mi><mrow id="alg1.l12.1.1.m1.1.1.1.1.1.1.1.3" xref="alg1.l12.1.1.m1.1.1.1.1.1.1.1.2.cmml"><mo maxsize="142%" minsize="142%" id="alg1.l12.1.1.m1.1.1.1.1.1.1.1.3.1" xref="alg1.l12.1.1.m1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mi id="alg1.l12.1.1.m1.1.1.1.1.1.1.1.1" xref="alg1.l12.1.1.m1.1.1.1.1.1.1.1.1.cmml">𝐮</mi><mo maxsize="142%" minsize="142%" id="alg1.l12.1.1.m1.1.1.1.1.1.1.1.3.2" xref="alg1.l12.1.1.m1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow></mfrac><mo id="alg1.l12.1.1.m1.1.1.1.1.1.3" xref="alg1.l12.1.1.m1.1.1.1.1.1.3.cmml">⊤</mo></msup></mtd><mtd id="alg1.l12.1.1.m1.3.3c" xref="alg1.l12.1.1.m1.3.3.cmml"><msup id="alg1.l12.1.1.m1.2.2.2.2.1" xref="alg1.l12.1.1.m1.2.2.2.2.1.cmml"><mfrac id="alg1.l12.1.1.m1.2.2.2.2.1.1" xref="alg1.l12.1.1.m1.2.2.2.2.1.1.cmml"><mi id="alg1.l12.1.1.m1.2.2.2.2.1.1.3" xref="alg1.l12.1.1.m1.2.2.2.2.1.1.3.cmml">𝐯</mi><mrow id="alg1.l12.1.1.m1.2.2.2.2.1.1.1.3" xref="alg1.l12.1.1.m1.2.2.2.2.1.1.1.2.cmml"><mo maxsize="142%" minsize="142%" id="alg1.l12.1.1.m1.2.2.2.2.1.1.1.3.1" xref="alg1.l12.1.1.m1.2.2.2.2.1.1.1.2.1.cmml">‖</mo><mi id="alg1.l12.1.1.m1.2.2.2.2.1.1.1.1" xref="alg1.l12.1.1.m1.2.2.2.2.1.1.1.1.cmml">𝐯</mi><mo maxsize="142%" minsize="142%" id="alg1.l12.1.1.m1.2.2.2.2.1.1.1.3.2" xref="alg1.l12.1.1.m1.2.2.2.2.1.1.1.2.1.cmml">‖</mo></mrow></mfrac><mo id="alg1.l12.1.1.m1.2.2.2.2.1.3" xref="alg1.l12.1.1.m1.2.2.2.2.1.3.cmml">⊤</mo></msup></mtd><mtd id="alg1.l12.1.1.m1.3.3d" xref="alg1.l12.1.1.m1.3.3.cmml"><msup id="alg1.l12.1.1.m1.3.3.3.3.1" xref="alg1.l12.1.1.m1.3.3.3.3.1.cmml"><mfrac id="alg1.l12.1.1.m1.3.3.3.3.1.1" xref="alg1.l12.1.1.m1.3.3.3.3.1.1.cmml"><mi id="alg1.l12.1.1.m1.3.3.3.3.1.1.3" xref="alg1.l12.1.1.m1.3.3.3.3.1.1.3.cmml">𝐰</mi><mrow id="alg1.l12.1.1.m1.3.3.3.3.1.1.1.3" xref="alg1.l12.1.1.m1.3.3.3.3.1.1.1.2.cmml"><mo maxsize="142%" minsize="142%" id="alg1.l12.1.1.m1.3.3.3.3.1.1.1.3.1" xref="alg1.l12.1.1.m1.3.3.3.3.1.1.1.2.1.cmml">‖</mo><mi id="alg1.l12.1.1.m1.3.3.3.3.1.1.1.1" xref="alg1.l12.1.1.m1.3.3.3.3.1.1.1.1.cmml">𝐰</mi><mo maxsize="142%" minsize="142%" id="alg1.l12.1.1.m1.3.3.3.3.1.1.1.3.2" xref="alg1.l12.1.1.m1.3.3.3.3.1.1.1.2.1.cmml">‖</mo></mrow></mfrac><mo id="alg1.l12.1.1.m1.3.3.3.3.1.3" xref="alg1.l12.1.1.m1.3.3.3.3.1.3.cmml">⊤</mo></msup></mtd></mtr></mtable><mo maxsize="120%" minsize="120%" id="alg1.l12.1.1.m1.3.4.3.2.2.2" xref="alg1.l12.1.1.m1.3.4.3.2.1.1.cmml">]</mo></mrow><mo id="alg1.l12.1.1.m1.3.4.3.3" xref="alg1.l12.1.1.m1.3.4.3.3.cmml">⊤</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.1.1.m1.3b"><apply id="alg1.l12.1.1.m1.3.4.cmml" xref="alg1.l12.1.1.m1.3.4"><ci id="alg1.l12.1.1.m1.3.4.1.cmml" xref="alg1.l12.1.1.m1.3.4.1">←</ci><ci id="alg1.l12.1.1.m1.3.4.2.cmml" xref="alg1.l12.1.1.m1.3.4.2">𝐌</ci><apply id="alg1.l12.1.1.m1.3.4.3.cmml" xref="alg1.l12.1.1.m1.3.4.3"><csymbol cd="ambiguous" id="alg1.l12.1.1.m1.3.4.3.1.cmml" xref="alg1.l12.1.1.m1.3.4.3">superscript</csymbol><apply id="alg1.l12.1.1.m1.3.4.3.2.1.cmml" xref="alg1.l12.1.1.m1.3.4.3.2.2"><csymbol cd="latexml" id="alg1.l12.1.1.m1.3.4.3.2.1.1.cmml" xref="alg1.l12.1.1.m1.3.4.3.2.2.1">delimited-[]</csymbol><matrix id="alg1.l12.1.1.m1.3.3.cmml" xref="alg1.l12.1.1.m1.3.3"><matrixrow id="alg1.l12.1.1.m1.3.3a.cmml" xref="alg1.l12.1.1.m1.3.3"><apply id="alg1.l12.1.1.m1.1.1.1.1.1.cmml" xref="alg1.l12.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.1.1.m1.1.1.1.1.1.2.cmml" xref="alg1.l12.1.1.m1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l12.1.1.m1.1.1.1.1.1.1.cmml" xref="alg1.l12.1.1.m1.1.1.1.1.1.1"><divide id="alg1.l12.1.1.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l12.1.1.m1.1.1.1.1.1.1"></divide><ci id="alg1.l12.1.1.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l12.1.1.m1.1.1.1.1.1.1.3">𝐮</ci><apply id="alg1.l12.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l12.1.1.m1.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="alg1.l12.1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l12.1.1.m1.1.1.1.1.1.1.1.3.1">norm</csymbol><ci id="alg1.l12.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l12.1.1.m1.1.1.1.1.1.1.1.1">𝐮</ci></apply></apply><csymbol cd="latexml" id="alg1.l12.1.1.m1.1.1.1.1.1.3.cmml" xref="alg1.l12.1.1.m1.1.1.1.1.1.3">top</csymbol></apply><apply id="alg1.l12.1.1.m1.2.2.2.2.1.cmml" xref="alg1.l12.1.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="alg1.l12.1.1.m1.2.2.2.2.1.2.cmml" xref="alg1.l12.1.1.m1.2.2.2.2.1">superscript</csymbol><apply id="alg1.l12.1.1.m1.2.2.2.2.1.1.cmml" xref="alg1.l12.1.1.m1.2.2.2.2.1.1"><divide id="alg1.l12.1.1.m1.2.2.2.2.1.1.2.cmml" xref="alg1.l12.1.1.m1.2.2.2.2.1.1"></divide><ci id="alg1.l12.1.1.m1.2.2.2.2.1.1.3.cmml" xref="alg1.l12.1.1.m1.2.2.2.2.1.1.3">𝐯</ci><apply id="alg1.l12.1.1.m1.2.2.2.2.1.1.1.2.cmml" xref="alg1.l12.1.1.m1.2.2.2.2.1.1.1.3"><csymbol cd="latexml" id="alg1.l12.1.1.m1.2.2.2.2.1.1.1.2.1.cmml" xref="alg1.l12.1.1.m1.2.2.2.2.1.1.1.3.1">norm</csymbol><ci id="alg1.l12.1.1.m1.2.2.2.2.1.1.1.1.cmml" xref="alg1.l12.1.1.m1.2.2.2.2.1.1.1.1">𝐯</ci></apply></apply><csymbol cd="latexml" id="alg1.l12.1.1.m1.2.2.2.2.1.3.cmml" xref="alg1.l12.1.1.m1.2.2.2.2.1.3">top</csymbol></apply><apply id="alg1.l12.1.1.m1.3.3.3.3.1.cmml" xref="alg1.l12.1.1.m1.3.3.3.3.1"><csymbol cd="ambiguous" id="alg1.l12.1.1.m1.3.3.3.3.1.2.cmml" xref="alg1.l12.1.1.m1.3.3.3.3.1">superscript</csymbol><apply id="alg1.l12.1.1.m1.3.3.3.3.1.1.cmml" xref="alg1.l12.1.1.m1.3.3.3.3.1.1"><divide id="alg1.l12.1.1.m1.3.3.3.3.1.1.2.cmml" xref="alg1.l12.1.1.m1.3.3.3.3.1.1"></divide><ci id="alg1.l12.1.1.m1.3.3.3.3.1.1.3.cmml" xref="alg1.l12.1.1.m1.3.3.3.3.1.1.3">𝐰</ci><apply id="alg1.l12.1.1.m1.3.3.3.3.1.1.1.2.cmml" xref="alg1.l12.1.1.m1.3.3.3.3.1.1.1.3"><csymbol cd="latexml" id="alg1.l12.1.1.m1.3.3.3.3.1.1.1.2.1.cmml" xref="alg1.l12.1.1.m1.3.3.3.3.1.1.1.3.1">norm</csymbol><ci id="alg1.l12.1.1.m1.3.3.3.3.1.1.1.1.cmml" xref="alg1.l12.1.1.m1.3.3.3.3.1.1.1.1">𝐰</ci></apply></apply><csymbol cd="latexml" id="alg1.l12.1.1.m1.3.3.3.3.1.3.cmml" xref="alg1.l12.1.1.m1.3.3.3.3.1.3">top</csymbol></apply></matrixrow></matrix></apply><csymbol cd="latexml" id="alg1.l12.1.1.m1.3.4.3.3.cmml" xref="alg1.l12.1.1.m1.3.4.3.3">top</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.1.1.m1.3c">\mathbf{M}\leftarrow\big{[}\begin{smallmatrix}\frac{\mathbf{u}}{||\mathbf{u}||}^{\top}&amp;\frac{\mathbf{v}}{||\mathbf{v}||}^{\top}&amp;\frac{\mathbf{w}}{||\mathbf{w}||}^{\top}\end{smallmatrix}\big{]}^{\top}</annotation></semantics></math></span>
<span id="alg1.l12.2.2" class="ltx_p"><span id="alg1.l12.2.2.2" class="ltx_text ltx_phantom"><span style="visibility:hidden">====</span></span> <span id="alg1.l12.2.2.1" class="ltx_text" style="float:right;"><math id="alg1.l12.2.2.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l12.2.2.1.m1.1a"><mo id="alg1.l12.2.2.1.m1.1.1" xref="alg1.l12.2.2.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l12.2.2.1.m1.1b"><ci id="alg1.l12.2.2.1.m1.1.1.cmml" xref="alg1.l12.2.2.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.2.2.1.m1.1c">\triangleright</annotation></semantics></math> Coordinate transformation matrix</span></span>
</span>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span><math id="alg1.l13.m1.1" class="ltx_Math" alttext="\mathbf{B}^{D}\leftarrow\mathbf{B}^{M}\cdot\mathbf{M}" display="inline"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><msup id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml"><mi id="alg1.l13.m1.1.1.2.2" xref="alg1.l13.m1.1.1.2.2.cmml">𝐁</mi><mi id="alg1.l13.m1.1.1.2.3" xref="alg1.l13.m1.1.1.2.3.cmml">D</mi></msup><mo stretchy="false" id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml">←</mo><mrow id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><msup id="alg1.l13.m1.1.1.3.2" xref="alg1.l13.m1.1.1.3.2.cmml"><mi id="alg1.l13.m1.1.1.3.2.2" xref="alg1.l13.m1.1.1.3.2.2.cmml">𝐁</mi><mi id="alg1.l13.m1.1.1.3.2.3" xref="alg1.l13.m1.1.1.3.2.3.cmml">M</mi></msup><mo lspace="0.222em" rspace="0.222em" id="alg1.l13.m1.1.1.3.1" xref="alg1.l13.m1.1.1.3.1.cmml">⋅</mo><mi id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3.cmml">𝐌</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><ci id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1">←</ci><apply id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.2.1.cmml" xref="alg1.l13.m1.1.1.2">superscript</csymbol><ci id="alg1.l13.m1.1.1.2.2.cmml" xref="alg1.l13.m1.1.1.2.2">𝐁</ci><ci id="alg1.l13.m1.1.1.2.3.cmml" xref="alg1.l13.m1.1.1.2.3">𝐷</ci></apply><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><ci id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3.1">⋅</ci><apply id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.2.1.cmml" xref="alg1.l13.m1.1.1.3.2">superscript</csymbol><ci id="alg1.l13.m1.1.1.3.2.2.cmml" xref="alg1.l13.m1.1.1.3.2.2">𝐁</ci><ci id="alg1.l13.m1.1.1.3.2.3.cmml" xref="alg1.l13.m1.1.1.3.2.3">𝑀</ci></apply><ci id="alg1.l13.m1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3">𝐌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">\mathbf{B}^{D}\leftarrow\mathbf{B}^{M}\cdot\mathbf{M}</annotation></semantics></math>

</div>
</div>
</figure>
</div>
</div>
</figure>
<div id="S2.SS1.p2" class="ltx_para ltx_noindent">
<p id="S2.SS1.p2.8" class="ltx_p">We used COMSOL Multiphysics to obtain the FEM data. The simulation is centered at the magnet and constrained to only the upper-right half of the cross-section. We obtain the other half of the magnetic field values anti-symmetrically. We use the transformation described in Algorithm <a href="#alg1" title="Algorithm 1 ‣ Table 1 ‣ 2.1 Synthetic Dataset ‣ 2 Method ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> to generate the data for training and evaluate the neural network. The algorithm transforms <math id="S2.SS1.p2.1.m1.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S2.SS1.p2.1.m1.1a"><mn id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><cn type="integer" id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">2</annotation></semantics></math>D FEM data into <math id="S2.SS1.p2.2.m2.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S2.SS1.p2.2.m2.1a"><mn id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><cn type="integer" id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">3</annotation></semantics></math>D synthetic readings on each sensor location as follows. First, we input the current position of the magnet and each sensor location, all in a fixed coordinate system (<math id="S2.SS1.p2.3.m3.1" class="ltx_Math" alttext="C_{D}" display="inline"><semantics id="S2.SS1.p2.3.m3.1a"><msub id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml"><mi id="S2.SS1.p2.3.m3.1.1.2" xref="S2.SS1.p2.3.m3.1.1.2.cmml">C</mi><mi id="S2.SS1.p2.3.m3.1.1.3" xref="S2.SS1.p2.3.m3.1.1.3.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><apply id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.1.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p2.3.m3.1.1.2.cmml" xref="S2.SS1.p2.3.m3.1.1.2">𝐶</ci><ci id="S2.SS1.p2.3.m3.1.1.3.cmml" xref="S2.SS1.p2.3.m3.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">C_{D}</annotation></semantics></math>) centered at the device (L1-L2). Secondly, we build up a coordinate system centered on the magnet’s current position and orientation, <math id="S2.SS1.p2.4.m4.1" class="ltx_Math" alttext="C_{M}" display="inline"><semantics id="S2.SS1.p2.4.m4.1a"><msub id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml"><mi id="S2.SS1.p2.4.m4.1.1.2" xref="S2.SS1.p2.4.m4.1.1.2.cmml">C</mi><mi id="S2.SS1.p2.4.m4.1.1.3" xref="S2.SS1.p2.4.m4.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><apply id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p2.4.m4.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.2">𝐶</ci><ci id="S2.SS1.p2.4.m4.1.1.3.cmml" xref="S2.SS1.p2.4.m4.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">C_{M}</annotation></semantics></math> (L3-L10). Thirdly, the algorithm computes the magnetic flux density <math id="S2.SS1.p2.5.m5.1" class="ltx_Math" alttext="\mathbf{B}^{M}" display="inline"><semantics id="S2.SS1.p2.5.m5.1a"><msup id="S2.SS1.p2.5.m5.1.1" xref="S2.SS1.p2.5.m5.1.1.cmml"><mi id="S2.SS1.p2.5.m5.1.1.2" xref="S2.SS1.p2.5.m5.1.1.2.cmml">𝐁</mi><mi id="S2.SS1.p2.5.m5.1.1.3" xref="S2.SS1.p2.5.m5.1.1.3.cmml">M</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.1b"><apply id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.1.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1">superscript</csymbol><ci id="S2.SS1.p2.5.m5.1.1.2.cmml" xref="S2.SS1.p2.5.m5.1.1.2">𝐁</ci><ci id="S2.SS1.p2.5.m5.1.1.3.cmml" xref="S2.SS1.p2.5.m5.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.1c">\mathbf{B}^{M}</annotation></semantics></math> at the sensor’s location in <math id="S2.SS1.p2.6.m6.1" class="ltx_Math" alttext="C_{M}" display="inline"><semantics id="S2.SS1.p2.6.m6.1a"><msub id="S2.SS1.p2.6.m6.1.1" xref="S2.SS1.p2.6.m6.1.1.cmml"><mi id="S2.SS1.p2.6.m6.1.1.2" xref="S2.SS1.p2.6.m6.1.1.2.cmml">C</mi><mi id="S2.SS1.p2.6.m6.1.1.3" xref="S2.SS1.p2.6.m6.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m6.1b"><apply id="S2.SS1.p2.6.m6.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m6.1.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p2.6.m6.1.1.2.cmml" xref="S2.SS1.p2.6.m6.1.1.2">𝐶</ci><ci id="S2.SS1.p2.6.m6.1.1.3.cmml" xref="S2.SS1.p2.6.m6.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m6.1c">C_{M}</annotation></semantics></math> using the FEM data (L11). Finally, we transform the <math id="S2.SS1.p2.7.m7.1" class="ltx_Math" alttext="\mathbf{B}^{M}" display="inline"><semantics id="S2.SS1.p2.7.m7.1a"><msup id="S2.SS1.p2.7.m7.1.1" xref="S2.SS1.p2.7.m7.1.1.cmml"><mi id="S2.SS1.p2.7.m7.1.1.2" xref="S2.SS1.p2.7.m7.1.1.2.cmml">𝐁</mi><mi id="S2.SS1.p2.7.m7.1.1.3" xref="S2.SS1.p2.7.m7.1.1.3.cmml">M</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m7.1b"><apply id="S2.SS1.p2.7.m7.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m7.1.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1">superscript</csymbol><ci id="S2.SS1.p2.7.m7.1.1.2.cmml" xref="S2.SS1.p2.7.m7.1.1.2">𝐁</ci><ci id="S2.SS1.p2.7.m7.1.1.3.cmml" xref="S2.SS1.p2.7.m7.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m7.1c">\mathbf{B}^{M}</annotation></semantics></math> into the original global coordinates <math id="S2.SS1.p2.8.m8.1" class="ltx_Math" alttext="C_{D}" display="inline"><semantics id="S2.SS1.p2.8.m8.1a"><msub id="S2.SS1.p2.8.m8.1.1" xref="S2.SS1.p2.8.m8.1.1.cmml"><mi id="S2.SS1.p2.8.m8.1.1.2" xref="S2.SS1.p2.8.m8.1.1.2.cmml">C</mi><mi id="S2.SS1.p2.8.m8.1.1.3" xref="S2.SS1.p2.8.m8.1.1.3.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.8.m8.1b"><apply id="S2.SS1.p2.8.m8.1.1.cmml" xref="S2.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.8.m8.1.1.1.cmml" xref="S2.SS1.p2.8.m8.1.1">subscript</csymbol><ci id="S2.SS1.p2.8.m8.1.1.2.cmml" xref="S2.SS1.p2.8.m8.1.1.2">𝐶</ci><ci id="S2.SS1.p2.8.m8.1.1.3.cmml" xref="S2.SS1.p2.8.m8.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.8.m8.1c">C_{D}</annotation></semantics></math> to serve as features for training the MLP (L12-L13). All definitions of variables used in Algorithm <a href="#alg1" title="Algorithm 1 ‣ Table 1 ‣ 2.1 Synthetic Dataset ‣ 2 Method ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> are described in Table <a href="#S2.T1" title="Table 1 ‣ 2.1 Synthetic Dataset ‣ 2 Method ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Tracking with Neural Networks</h3>

<section id="S2.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.1 </span>Multi-Layer Perceptron</h4>

<div id="S2.SS2.SSS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.SSS1.p1.7" class="ltx_p">We used a Multi-Layer Perceptron (MLP) as network architecture. The input of the MLP is a <math id="S2.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="3n" display="inline"><semantics id="S2.SS2.SSS1.p1.1.m1.1a"><mrow id="S2.SS2.SSS1.p1.1.m1.1.1" xref="S2.SS2.SSS1.p1.1.m1.1.1.cmml"><mn id="S2.SS2.SSS1.p1.1.m1.1.1.2" xref="S2.SS2.SSS1.p1.1.m1.1.1.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p1.1.m1.1.1.1" xref="S2.SS2.SSS1.p1.1.m1.1.1.1.cmml">​</mo><mi id="S2.SS2.SSS1.p1.1.m1.1.1.3" xref="S2.SS2.SSS1.p1.1.m1.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.1.m1.1b"><apply id="S2.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1"><times id="S2.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.1"></times><cn type="integer" id="S2.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.2">3</cn><ci id="S2.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.1.m1.1c">3n</annotation></semantics></math>-element vector containing the (<math id="S2.SS2.SSS1.p1.2.m2.3" class="ltx_Math" alttext="x,y,z" display="inline"><semantics id="S2.SS2.SSS1.p1.2.m2.3a"><mrow id="S2.SS2.SSS1.p1.2.m2.3.4.2" xref="S2.SS2.SSS1.p1.2.m2.3.4.1.cmml"><mi id="S2.SS2.SSS1.p1.2.m2.1.1" xref="S2.SS2.SSS1.p1.2.m2.1.1.cmml">x</mi><mo id="S2.SS2.SSS1.p1.2.m2.3.4.2.1" xref="S2.SS2.SSS1.p1.2.m2.3.4.1.cmml">,</mo><mi id="S2.SS2.SSS1.p1.2.m2.2.2" xref="S2.SS2.SSS1.p1.2.m2.2.2.cmml">y</mi><mo id="S2.SS2.SSS1.p1.2.m2.3.4.2.2" xref="S2.SS2.SSS1.p1.2.m2.3.4.1.cmml">,</mo><mi id="S2.SS2.SSS1.p1.2.m2.3.3" xref="S2.SS2.SSS1.p1.2.m2.3.3.cmml">z</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.2.m2.3b"><list id="S2.SS2.SSS1.p1.2.m2.3.4.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.3.4.2"><ci id="S2.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1">𝑥</ci><ci id="S2.SS2.SSS1.p1.2.m2.2.2.cmml" xref="S2.SS2.SSS1.p1.2.m2.2.2">𝑦</ci><ci id="S2.SS2.SSS1.p1.2.m2.3.3.cmml" xref="S2.SS2.SSS1.p1.2.m2.3.3">𝑧</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.2.m2.3c">x,y,z</annotation></semantics></math>) magnetic flux densities <math id="S2.SS2.SSS1.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{B}" display="inline"><semantics id="S2.SS2.SSS1.p1.3.m3.1a"><mi id="S2.SS2.SSS1.p1.3.m3.1.1" xref="S2.SS2.SSS1.p1.3.m3.1.1.cmml">𝐁</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.3.m3.1b"><ci id="S2.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.1">𝐁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.3.m3.1c">\mathbf{B}</annotation></semantics></math> of the <math id="S2.SS2.SSS1.p1.4.m4.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.SS2.SSS1.p1.4.m4.1a"><mi id="S2.SS2.SSS1.p1.4.m4.1.1" xref="S2.SS2.SSS1.p1.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.4.m4.1b"><ci id="S2.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.4.m4.1c">n</annotation></semantics></math> sensors. The output is a tuple of <math id="S2.SS2.SSS1.p1.5.m5.1" class="ltx_Math" alttext="6" display="inline"><semantics id="S2.SS2.SSS1.p1.5.m5.1a"><mn id="S2.SS2.SSS1.p1.5.m5.1.1" xref="S2.SS2.SSS1.p1.5.m5.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.5.m5.1b"><cn type="integer" id="S2.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.5.m5.1c">6</annotation></semantics></math> elements composed of the magnet position, <math id="S2.SS2.SSS1.p1.6.m6.3" class="ltx_Math" alttext="\mathbf{p}=[p_{m}^{x},p_{m}^{y},p_{m}^{z}]" display="inline"><semantics id="S2.SS2.SSS1.p1.6.m6.3a"><mrow id="S2.SS2.SSS1.p1.6.m6.3.3" xref="S2.SS2.SSS1.p1.6.m6.3.3.cmml"><mi id="S2.SS2.SSS1.p1.6.m6.3.3.5" xref="S2.SS2.SSS1.p1.6.m6.3.3.5.cmml">𝐩</mi><mo id="S2.SS2.SSS1.p1.6.m6.3.3.4" xref="S2.SS2.SSS1.p1.6.m6.3.3.4.cmml">=</mo><mrow id="S2.SS2.SSS1.p1.6.m6.3.3.3.3" xref="S2.SS2.SSS1.p1.6.m6.3.3.3.4.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p1.6.m6.3.3.3.3.4" xref="S2.SS2.SSS1.p1.6.m6.3.3.3.4.cmml">[</mo><msubsup id="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1" xref="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.2.2" xref="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.2.2.cmml">p</mi><mi id="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.2.3" xref="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.2.3.cmml">m</mi><mi id="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.3" xref="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.3.cmml">x</mi></msubsup><mo id="S2.SS2.SSS1.p1.6.m6.3.3.3.3.5" xref="S2.SS2.SSS1.p1.6.m6.3.3.3.4.cmml">,</mo><msubsup id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.cmml"><mi id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.2.2" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.2.2.cmml">p</mi><mi id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.2.3" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.2.3.cmml">m</mi><mi id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.3" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.3.cmml">y</mi></msubsup><mo id="S2.SS2.SSS1.p1.6.m6.3.3.3.3.6" xref="S2.SS2.SSS1.p1.6.m6.3.3.3.4.cmml">,</mo><msubsup id="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3" xref="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3.cmml"><mi id="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3.2.2" xref="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3.2.2.cmml">p</mi><mi id="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3.2.3" xref="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3.2.3.cmml">m</mi><mi id="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3.3" xref="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3.3.cmml">z</mi></msubsup><mo stretchy="false" id="S2.SS2.SSS1.p1.6.m6.3.3.3.3.7" xref="S2.SS2.SSS1.p1.6.m6.3.3.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.6.m6.3b"><apply id="S2.SS2.SSS1.p1.6.m6.3.3.cmml" xref="S2.SS2.SSS1.p1.6.m6.3.3"><eq id="S2.SS2.SSS1.p1.6.m6.3.3.4.cmml" xref="S2.SS2.SSS1.p1.6.m6.3.3.4"></eq><ci id="S2.SS2.SSS1.p1.6.m6.3.3.5.cmml" xref="S2.SS2.SSS1.p1.6.m6.3.3.5">𝐩</ci><list id="S2.SS2.SSS1.p1.6.m6.3.3.3.4.cmml" xref="S2.SS2.SSS1.p1.6.m6.3.3.3.3"><apply id="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1">superscript</csymbol><apply id="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.2.1.cmml" xref="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.2.2.cmml" xref="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.2.2">𝑝</ci><ci id="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.2.3.cmml" xref="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.2.3">𝑚</ci></apply><ci id="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.3">𝑥</ci></apply><apply id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.cmml" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.1.cmml" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2">superscript</csymbol><apply id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.2.cmml" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.2.1.cmml" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.2.2.cmml" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.2.2">𝑝</ci><ci id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.2.3.cmml" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.2.3">𝑚</ci></apply><ci id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.3.cmml" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.3">𝑦</ci></apply><apply id="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3.cmml" xref="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3.1.cmml" xref="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3">superscript</csymbol><apply id="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3.2.cmml" xref="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3.2.1.cmml" xref="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3">subscript</csymbol><ci id="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3.2.2.cmml" xref="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3.2.2">𝑝</ci><ci id="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3.2.3.cmml" xref="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3.2.3">𝑚</ci></apply><ci id="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3.3.cmml" xref="S2.SS2.SSS1.p1.6.m6.3.3.3.3.3.3">𝑧</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.6.m6.3c">\mathbf{p}=[p_{m}^{x},p_{m}^{y},p_{m}^{z}]</annotation></semantics></math>, and its orientation, <math id="S2.SS2.SSS1.p1.7.m7.3" class="ltx_Math" alttext="\mathbf{o}=[o_{m}^{x},o_{m}^{y},o_{m}^{z}]" display="inline"><semantics id="S2.SS2.SSS1.p1.7.m7.3a"><mrow id="S2.SS2.SSS1.p1.7.m7.3.3" xref="S2.SS2.SSS1.p1.7.m7.3.3.cmml"><mi id="S2.SS2.SSS1.p1.7.m7.3.3.5" xref="S2.SS2.SSS1.p1.7.m7.3.3.5.cmml">𝐨</mi><mo id="S2.SS2.SSS1.p1.7.m7.3.3.4" xref="S2.SS2.SSS1.p1.7.m7.3.3.4.cmml">=</mo><mrow id="S2.SS2.SSS1.p1.7.m7.3.3.3.3" xref="S2.SS2.SSS1.p1.7.m7.3.3.3.4.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p1.7.m7.3.3.3.3.4" xref="S2.SS2.SSS1.p1.7.m7.3.3.3.4.cmml">[</mo><msubsup id="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1" xref="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1.2.2" xref="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1.2.2.cmml">o</mi><mi id="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1.2.3" xref="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1.2.3.cmml">m</mi><mi id="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1.3" xref="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1.3.cmml">x</mi></msubsup><mo id="S2.SS2.SSS1.p1.7.m7.3.3.3.3.5" xref="S2.SS2.SSS1.p1.7.m7.3.3.3.4.cmml">,</mo><msubsup id="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2" xref="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2.cmml"><mi id="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2.2.2" xref="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2.2.2.cmml">o</mi><mi id="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2.2.3" xref="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2.2.3.cmml">m</mi><mi id="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2.3" xref="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2.3.cmml">y</mi></msubsup><mo id="S2.SS2.SSS1.p1.7.m7.3.3.3.3.6" xref="S2.SS2.SSS1.p1.7.m7.3.3.3.4.cmml">,</mo><msubsup id="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3" xref="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3.cmml"><mi id="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3.2.2" xref="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3.2.2.cmml">o</mi><mi id="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3.2.3" xref="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3.2.3.cmml">m</mi><mi id="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3.3" xref="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3.3.cmml">z</mi></msubsup><mo stretchy="false" id="S2.SS2.SSS1.p1.7.m7.3.3.3.3.7" xref="S2.SS2.SSS1.p1.7.m7.3.3.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.7.m7.3b"><apply id="S2.SS2.SSS1.p1.7.m7.3.3.cmml" xref="S2.SS2.SSS1.p1.7.m7.3.3"><eq id="S2.SS2.SSS1.p1.7.m7.3.3.4.cmml" xref="S2.SS2.SSS1.p1.7.m7.3.3.4"></eq><ci id="S2.SS2.SSS1.p1.7.m7.3.3.5.cmml" xref="S2.SS2.SSS1.p1.7.m7.3.3.5">𝐨</ci><list id="S2.SS2.SSS1.p1.7.m7.3.3.3.4.cmml" xref="S2.SS2.SSS1.p1.7.m7.3.3.3.3"><apply id="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1">superscript</csymbol><apply id="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1.2.1.cmml" xref="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1.2.2.cmml" xref="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1.2.2">𝑜</ci><ci id="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1.2.3.cmml" xref="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1.2.3">𝑚</ci></apply><ci id="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.7.m7.1.1.1.1.1.3">𝑥</ci></apply><apply id="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2.1.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2">superscript</csymbol><apply id="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2.2.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2.2.1.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2.2.2.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2.2.2">𝑜</ci><ci id="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2.2.3.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2.2.3">𝑚</ci></apply><ci id="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2.3.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.2.2.2.3">𝑦</ci></apply><apply id="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3.cmml" xref="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3.1.cmml" xref="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3">superscript</csymbol><apply id="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3.2.cmml" xref="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3.2.1.cmml" xref="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3">subscript</csymbol><ci id="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3.2.2.cmml" xref="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3.2.2">𝑜</ci><ci id="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3.2.3.cmml" xref="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3.2.3">𝑚</ci></apply><ci id="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3.3.cmml" xref="S2.SS2.SSS1.p1.7.m7.3.3.3.3.3.3">𝑧</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.7.m7.3c">\mathbf{o}=[o_{m}^{x},o_{m}^{y},o_{m}^{z}]</annotation></semantics></math>. We can then write the MLP as a non-linear mapping from the sensor readings to the tracking variables:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.5" class="ltx_Math" alttext="\mathcal{F}:\mathbb{R}^{3n}\rightarrow\mathbb{R}^{6};\mathcal{F}(\mathbf{[\mathbf{B}_{1},...,\mathbf{B}_{3n}]})=[\mathbf{p},\mathbf{o}]" display="block"><semantics id="S2.E1.m1.5a"><mrow id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.5.5.4" xref="S2.E1.m1.5.5.4.cmml">ℱ</mi><mo lspace="0.278em" rspace="0.278em" id="S2.E1.m1.5.5.3" xref="S2.E1.m1.5.5.3.cmml">:</mo><mrow id="S2.E1.m1.5.5.2.2" xref="S2.E1.m1.5.5.2.3.cmml"><mrow id="S2.E1.m1.4.4.1.1.1" xref="S2.E1.m1.4.4.1.1.1.cmml"><msup id="S2.E1.m1.4.4.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.2.cmml"><mi id="S2.E1.m1.4.4.1.1.1.2.2" xref="S2.E1.m1.4.4.1.1.1.2.2.cmml">ℝ</mi><mrow id="S2.E1.m1.4.4.1.1.1.2.3" xref="S2.E1.m1.4.4.1.1.1.2.3.cmml"><mn id="S2.E1.m1.4.4.1.1.1.2.3.2" xref="S2.E1.m1.4.4.1.1.1.2.3.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.4.1.1.1.2.3.1" xref="S2.E1.m1.4.4.1.1.1.2.3.1.cmml">​</mo><mi id="S2.E1.m1.4.4.1.1.1.2.3.3" xref="S2.E1.m1.4.4.1.1.1.2.3.3.cmml">n</mi></mrow></msup><mo stretchy="false" id="S2.E1.m1.4.4.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.cmml">→</mo><msup id="S2.E1.m1.4.4.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.3.cmml"><mi id="S2.E1.m1.4.4.1.1.1.3.2" xref="S2.E1.m1.4.4.1.1.1.3.2.cmml">ℝ</mi><mn id="S2.E1.m1.4.4.1.1.1.3.3" xref="S2.E1.m1.4.4.1.1.1.3.3.cmml">6</mn></msup></mrow><mo id="S2.E1.m1.5.5.2.2.3" xref="S2.E1.m1.5.5.2.3a.cmml">;</mo><mrow id="S2.E1.m1.5.5.2.2.2" xref="S2.E1.m1.5.5.2.2.2.cmml"><mrow id="S2.E1.m1.5.5.2.2.2.1" xref="S2.E1.m1.5.5.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.5.5.2.2.2.1.3" xref="S2.E1.m1.5.5.2.2.2.1.3.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.2.2.2.1.2" xref="S2.E1.m1.5.5.2.2.2.1.2.cmml">​</mo><mrow id="S2.E1.m1.5.5.2.2.2.1.1.1" xref="S2.E1.m1.5.5.2.2.2.1.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.2.2.2.1.1.1.2" xref="S2.E1.m1.5.5.2.2.2.1.cmml">(</mo><mrow id="S2.E1.m1.5.5.2.2.2.1.1.1.1.2" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.3" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.3.cmml">[</mo><msub id="S2.E1.m1.5.5.2.2.2.1.1.1.1.1.1" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.5.5.2.2.2.1.1.1.1.1.1.2" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.1.1.2.cmml">𝐁</mi><mn id="S2.E1.m1.5.5.2.2.2.1.1.1.1.1.1.3" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.1.1.3.cmml">𝟏</mn></msub><mo id="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.4" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.3.cmml">,</mo><mi mathvariant="normal" id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">…</mi><mo id="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.5" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.3.cmml">,</mo><msub id="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.cmml"><mi id="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.2" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.2.cmml">𝐁</mi><mrow id="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.3" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.3.cmml"><mn id="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.3.2" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.3.2.cmml">𝟑</mn><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.3.1" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.3.3" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.3.3.cmml">𝐧</mi></mrow></msub><mo stretchy="false" id="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.6" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.3.cmml">]</mo></mrow><mo stretchy="false" id="S2.E1.m1.5.5.2.2.2.1.1.1.3" xref="S2.E1.m1.5.5.2.2.2.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.5.5.2.2.2.2" xref="S2.E1.m1.5.5.2.2.2.2.cmml">=</mo><mrow id="S2.E1.m1.5.5.2.2.2.3.2" xref="S2.E1.m1.5.5.2.2.2.3.1.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.2.2.2.3.2.1" xref="S2.E1.m1.5.5.2.2.2.3.1.cmml">[</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">𝐩</mi><mo id="S2.E1.m1.5.5.2.2.2.3.2.2" xref="S2.E1.m1.5.5.2.2.2.3.1.cmml">,</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">𝐨</mi><mo stretchy="false" id="S2.E1.m1.5.5.2.2.2.3.2.3" xref="S2.E1.m1.5.5.2.2.2.3.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.5b"><apply id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5"><ci id="S2.E1.m1.5.5.3.cmml" xref="S2.E1.m1.5.5.3">:</ci><ci id="S2.E1.m1.5.5.4.cmml" xref="S2.E1.m1.5.5.4">ℱ</ci><apply id="S2.E1.m1.5.5.2.3.cmml" xref="S2.E1.m1.5.5.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.2.3a.cmml" xref="S2.E1.m1.5.5.2.2.3">formulae-sequence</csymbol><apply id="S2.E1.m1.4.4.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1"><ci id="S2.E1.m1.4.4.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1">→</ci><apply id="S2.E1.m1.4.4.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.2.1.cmml" xref="S2.E1.m1.4.4.1.1.1.2">superscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.2.2.cmml" xref="S2.E1.m1.4.4.1.1.1.2.2">ℝ</ci><apply id="S2.E1.m1.4.4.1.1.1.2.3.cmml" xref="S2.E1.m1.4.4.1.1.1.2.3"><times id="S2.E1.m1.4.4.1.1.1.2.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.2.3.1"></times><cn type="integer" id="S2.E1.m1.4.4.1.1.1.2.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.2.3.2">3</cn><ci id="S2.E1.m1.4.4.1.1.1.2.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.2.3.3">𝑛</ci></apply></apply><apply id="S2.E1.m1.4.4.1.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.3">superscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.3.2">ℝ</ci><cn type="integer" id="S2.E1.m1.4.4.1.1.1.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3">6</cn></apply></apply><apply id="S2.E1.m1.5.5.2.2.2.cmml" xref="S2.E1.m1.5.5.2.2.2"><eq id="S2.E1.m1.5.5.2.2.2.2.cmml" xref="S2.E1.m1.5.5.2.2.2.2"></eq><apply id="S2.E1.m1.5.5.2.2.2.1.cmml" xref="S2.E1.m1.5.5.2.2.2.1"><times id="S2.E1.m1.5.5.2.2.2.1.2.cmml" xref="S2.E1.m1.5.5.2.2.2.1.2"></times><ci id="S2.E1.m1.5.5.2.2.2.1.3.cmml" xref="S2.E1.m1.5.5.2.2.2.1.3">ℱ</ci><list id="S2.E1.m1.5.5.2.2.2.1.1.1.1.3.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.2"><apply id="S2.E1.m1.5.5.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.5.5.2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.1.1.2">𝐁</ci><cn type="integer" id="S2.E1.m1.5.5.2.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">…</ci><apply id="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2">subscript</csymbol><ci id="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.2">𝐁</ci><apply id="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.3"><times id="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.3.1.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.3.1"></times><cn type="integer" id="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.3.2.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.3.2">3</cn><ci id="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.3.3.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.2.2.3.3">𝐧</ci></apply></apply></list></apply><interval closure="closed" id="S2.E1.m1.5.5.2.2.2.3.1.cmml" xref="S2.E1.m1.5.5.2.2.2.3.2"><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝐩</ci><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝐨</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.5c">\mathcal{F}:\mathbb{R}^{3n}\rightarrow\mathbb{R}^{6};\mathcal{F}(\mathbf{[\mathbf{B}_{1},...,\mathbf{B}_{3n}]})=[\mathbf{p},\mathbf{o}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS2.SSS1.p2" class="ltx_para ltx_noindent">
<p id="S2.SS2.SSS1.p2.4" class="ltx_p">Note that even when we have 5-DoF output, three in <math id="S2.SS2.SSS1.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{p}" display="inline"><semantics id="S2.SS2.SSS1.p2.1.m1.1a"><mi id="S2.SS2.SSS1.p2.1.m1.1.1" xref="S2.SS2.SSS1.p2.1.m1.1.1.cmml">𝐩</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.1.m1.1b"><ci id="S2.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1">𝐩</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.1.m1.1c">\mathbf{p}</annotation></semantics></math> and two in <math id="S2.SS2.SSS1.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{o}" display="inline"><semantics id="S2.SS2.SSS1.p2.2.m2.1a"><mi id="S2.SS2.SSS1.p2.2.m2.1.1" xref="S2.SS2.SSS1.p2.2.m2.1.1.cmml">𝐨</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.2.m2.1b"><ci id="S2.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.1">𝐨</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.2.m2.1c">\mathbf{o}</annotation></semantics></math>, we express the orientation vector in cartesian coordinates to avoid the numerical discontinuity when the azimuth angle jumps from <math id="S2.SS2.SSS1.p2.3.m3.1" class="ltx_Math" alttext="359^{\circ}" display="inline"><semantics id="S2.SS2.SSS1.p2.3.m3.1a"><msup id="S2.SS2.SSS1.p2.3.m3.1.1" xref="S2.SS2.SSS1.p2.3.m3.1.1.cmml"><mn id="S2.SS2.SSS1.p2.3.m3.1.1.2" xref="S2.SS2.SSS1.p2.3.m3.1.1.2.cmml">359</mn><mo id="S2.SS2.SSS1.p2.3.m3.1.1.3" xref="S2.SS2.SSS1.p2.3.m3.1.1.3.cmml">∘</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.3.m3.1b"><apply id="S2.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.3.m3.1.1.1.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1">superscript</csymbol><cn type="integer" id="S2.SS2.SSS1.p2.3.m3.1.1.2.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1.2">359</cn><compose id="S2.SS2.SSS1.p2.3.m3.1.1.3.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.3.m3.1c">359^{\circ}</annotation></semantics></math> to <math id="S2.SS2.SSS1.p2.4.m4.1" class="ltx_Math" alttext="0^{\circ}" display="inline"><semantics id="S2.SS2.SSS1.p2.4.m4.1a"><msup id="S2.SS2.SSS1.p2.4.m4.1.1" xref="S2.SS2.SSS1.p2.4.m4.1.1.cmml"><mn id="S2.SS2.SSS1.p2.4.m4.1.1.2" xref="S2.SS2.SSS1.p2.4.m4.1.1.2.cmml">0</mn><mo id="S2.SS2.SSS1.p2.4.m4.1.1.3" xref="S2.SS2.SSS1.p2.4.m4.1.1.3.cmml">∘</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.4.m4.1b"><apply id="S2.SS2.SSS1.p2.4.m4.1.1.cmml" xref="S2.SS2.SSS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.4.m4.1.1.1.cmml" xref="S2.SS2.SSS1.p2.4.m4.1.1">superscript</csymbol><cn type="integer" id="S2.SS2.SSS1.p2.4.m4.1.1.2.cmml" xref="S2.SS2.SSS1.p2.4.m4.1.1.2">0</cn><compose id="S2.SS2.SSS1.p2.4.m4.1.1.3.cmml" xref="S2.SS2.SSS1.p2.4.m4.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.4.m4.1c">0^{\circ}</annotation></semantics></math>.</p>
</div>
<div id="S2.SS2.SSS1.p3" class="ltx_para ltx_noindent">
<p id="S2.SS2.SSS1.p3.2" class="ltx_p">Our MLP architecture is shown in Figure <a href="#S2.F1" title="Figure 1 ‣ 2 Method ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. We use a <math id="S2.SS2.SSS1.p3.1.m1.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S2.SS2.SSS1.p3.1.m1.1a"><mn id="S2.SS2.SSS1.p3.1.m1.1.1" xref="S2.SS2.SSS1.p3.1.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.1.m1.1b"><cn type="integer" id="S2.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p3.1.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.1.m1.1c">3</annotation></semantics></math>-layer perceptron, with <math id="S2.SS2.SSS1.p3.2.m2.1" class="ltx_Math" alttext="2048" display="inline"><semantics id="S2.SS2.SSS1.p3.2.m2.1a"><mn id="S2.SS2.SSS1.p3.2.m2.1.1" xref="S2.SS2.SSS1.p3.2.m2.1.1.cmml">2048</mn><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.2.m2.1b"><cn type="integer" id="S2.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1">2048</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.2.m2.1c">2048</annotation></semantics></math> units per layer, except for the input and output layers. Rectified linear units are used as activation functions.</p>
</div>
</section>
<section id="S2.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.2 </span>Pre-processing</h4>

<div id="S2.SS2.SSS2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.SSS2.p1.2" class="ltx_p">Importantly, we empirically validated that the systems training does not converge if magnetic readings are used directly as inputs. One of the reasons may be that the input values vary by several orders of magnitude when the magnet moves from close to a sensor ( <math id="S2.SS2.SSS2.p1.1.m1.1" class="ltx_Math" alttext="10^{-2}" display="inline"><semantics id="S2.SS2.SSS2.p1.1.m1.1a"><msup id="S2.SS2.SSS2.p1.1.m1.1.1" xref="S2.SS2.SSS2.p1.1.m1.1.1.cmml"><mn id="S2.SS2.SSS2.p1.1.m1.1.1.2" xref="S2.SS2.SSS2.p1.1.m1.1.1.2.cmml">10</mn><mrow id="S2.SS2.SSS2.p1.1.m1.1.1.3" xref="S2.SS2.SSS2.p1.1.m1.1.1.3.cmml"><mo id="S2.SS2.SSS2.p1.1.m1.1.1.3a" xref="S2.SS2.SSS2.p1.1.m1.1.1.3.cmml">−</mo><mn id="S2.SS2.SSS2.p1.1.m1.1.1.3.2" xref="S2.SS2.SSS2.p1.1.m1.1.1.3.2.cmml">2</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.1.m1.1b"><apply id="S2.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1">superscript</csymbol><cn type="integer" id="S2.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.2">10</cn><apply id="S2.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.3"><minus id="S2.SS2.SSS2.p1.1.m1.1.1.3.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.3"></minus><cn type="integer" id="S2.SS2.SSS2.p1.1.m1.1.1.3.2.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.3.2">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.1.m1.1c">10^{-2}</annotation></semantics></math> Tesla) to the extension of the working volume ( <math id="S2.SS2.SSS2.p1.2.m2.1" class="ltx_Math" alttext="10^{-6}" display="inline"><semantics id="S2.SS2.SSS2.p1.2.m2.1a"><msup id="S2.SS2.SSS2.p1.2.m2.1.1" xref="S2.SS2.SSS2.p1.2.m2.1.1.cmml"><mn id="S2.SS2.SSS2.p1.2.m2.1.1.2" xref="S2.SS2.SSS2.p1.2.m2.1.1.2.cmml">10</mn><mrow id="S2.SS2.SSS2.p1.2.m2.1.1.3" xref="S2.SS2.SSS2.p1.2.m2.1.1.3.cmml"><mo id="S2.SS2.SSS2.p1.2.m2.1.1.3a" xref="S2.SS2.SSS2.p1.2.m2.1.1.3.cmml">−</mo><mn id="S2.SS2.SSS2.p1.2.m2.1.1.3.2" xref="S2.SS2.SSS2.p1.2.m2.1.1.3.2.cmml">6</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.2.m2.1b"><apply id="S2.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1">superscript</csymbol><cn type="integer" id="S2.SS2.SSS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1.2">10</cn><apply id="S2.SS2.SSS2.p1.2.m2.1.1.3.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1.3"><minus id="S2.SS2.SSS2.p1.2.m2.1.1.3.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1.3"></minus><cn type="integer" id="S2.SS2.SSS2.p1.2.m2.1.1.3.2.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1.3.2">6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.2.m2.1c">10^{-6}</annotation></semantics></math> Tesla).
As stated in the dipole model,</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.3" class="ltx_Math" alttext="{\mathbf{B}}({{\mathbf{p}}_{m}})=\frac{{{\mu_{0}}}}{{4\pi}}\left[{\frac{{3{\mathbf{r}}({\mathbf{m}}\cdot{\mathbf{r}})}}{{{r^{5}}}}-\frac{{\mathbf{m}}}{{{r^{3}}}}}\right]\," display="block"><semantics id="S2.E2.m1.3a"><mrow id="S2.E2.m1.3.3" xref="S2.E2.m1.3.3.cmml"><mrow id="S2.E2.m1.2.2.1" xref="S2.E2.m1.2.2.1.cmml"><mi id="S2.E2.m1.2.2.1.3" xref="S2.E2.m1.2.2.1.3.cmml">𝐁</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.2.2.1.2" xref="S2.E2.m1.2.2.1.2.cmml">​</mo><mrow id="S2.E2.m1.2.2.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.2.2.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.cmml">(</mo><msub id="S2.E2.m1.2.2.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.2.cmml">𝐩</mi><mi id="S2.E2.m1.2.2.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S2.E2.m1.2.2.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.3.3.3" xref="S2.E2.m1.3.3.3.cmml">=</mo><mrow id="S2.E2.m1.3.3.2" xref="S2.E2.m1.3.3.2.cmml"><mfrac id="S2.E2.m1.3.3.2.3" xref="S2.E2.m1.3.3.2.3.cmml"><msub id="S2.E2.m1.3.3.2.3.2" xref="S2.E2.m1.3.3.2.3.2.cmml"><mi id="S2.E2.m1.3.3.2.3.2.2" xref="S2.E2.m1.3.3.2.3.2.2.cmml">μ</mi><mn id="S2.E2.m1.3.3.2.3.2.3" xref="S2.E2.m1.3.3.2.3.2.3.cmml">0</mn></msub><mrow id="S2.E2.m1.3.3.2.3.3" xref="S2.E2.m1.3.3.2.3.3.cmml"><mn id="S2.E2.m1.3.3.2.3.3.2" xref="S2.E2.m1.3.3.2.3.3.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.2.3.3.1" xref="S2.E2.m1.3.3.2.3.3.1.cmml">​</mo><mi id="S2.E2.m1.3.3.2.3.3.3" xref="S2.E2.m1.3.3.2.3.3.3.cmml">π</mi></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.2.2" xref="S2.E2.m1.3.3.2.2.cmml">​</mo><mrow id="S2.E2.m1.3.3.2.1.1" xref="S2.E2.m1.3.3.2.1.2.cmml"><mo id="S2.E2.m1.3.3.2.1.1.2" xref="S2.E2.m1.3.3.2.1.2.1.cmml">[</mo><mrow id="S2.E2.m1.3.3.2.1.1.1" xref="S2.E2.m1.3.3.2.1.1.1.cmml"><mfrac id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.cmml"><mn id="S2.E2.m1.1.1.1.3" xref="S2.E2.m1.1.1.1.3.cmml">3</mn><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.2.cmml">​</mo><mi id="S2.E2.m1.1.1.1.4" xref="S2.E2.m1.1.1.1.4.cmml">𝐫</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.2a" xref="S2.E2.m1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.2.cmml">𝐦</mi><mo lspace="0.222em" rspace="0.222em" id="S2.E2.m1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.cmml">⋅</mo><mi id="S2.E2.m1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.3.cmml">𝐫</mi></mrow><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><msup id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.3.2" xref="S2.E2.m1.1.1.3.2.cmml">r</mi><mn id="S2.E2.m1.1.1.3.3" xref="S2.E2.m1.1.1.3.3.cmml">5</mn></msup></mfrac><mo id="S2.E2.m1.3.3.2.1.1.1.1" xref="S2.E2.m1.3.3.2.1.1.1.1.cmml">−</mo><mfrac id="S2.E2.m1.3.3.2.1.1.1.2" xref="S2.E2.m1.3.3.2.1.1.1.2.cmml"><mi id="S2.E2.m1.3.3.2.1.1.1.2.2" xref="S2.E2.m1.3.3.2.1.1.1.2.2.cmml">𝐦</mi><msup id="S2.E2.m1.3.3.2.1.1.1.2.3" xref="S2.E2.m1.3.3.2.1.1.1.2.3.cmml"><mi id="S2.E2.m1.3.3.2.1.1.1.2.3.2" xref="S2.E2.m1.3.3.2.1.1.1.2.3.2.cmml">r</mi><mn id="S2.E2.m1.3.3.2.1.1.1.2.3.3" xref="S2.E2.m1.3.3.2.1.1.1.2.3.3.cmml">3</mn></msup></mfrac></mrow><mo id="S2.E2.m1.3.3.2.1.1.3" xref="S2.E2.m1.3.3.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.3b"><apply id="S2.E2.m1.3.3.cmml" xref="S2.E2.m1.3.3"><eq id="S2.E2.m1.3.3.3.cmml" xref="S2.E2.m1.3.3.3"></eq><apply id="S2.E2.m1.2.2.1.cmml" xref="S2.E2.m1.2.2.1"><times id="S2.E2.m1.2.2.1.2.cmml" xref="S2.E2.m1.2.2.1.2"></times><ci id="S2.E2.m1.2.2.1.3.cmml" xref="S2.E2.m1.2.2.1.3">𝐁</ci><apply id="S2.E2.m1.2.2.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2">𝐩</ci><ci id="S2.E2.m1.2.2.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.3">𝑚</ci></apply></apply><apply id="S2.E2.m1.3.3.2.cmml" xref="S2.E2.m1.3.3.2"><times id="S2.E2.m1.3.3.2.2.cmml" xref="S2.E2.m1.3.3.2.2"></times><apply id="S2.E2.m1.3.3.2.3.cmml" xref="S2.E2.m1.3.3.2.3"><divide id="S2.E2.m1.3.3.2.3.1.cmml" xref="S2.E2.m1.3.3.2.3"></divide><apply id="S2.E2.m1.3.3.2.3.2.cmml" xref="S2.E2.m1.3.3.2.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.2.3.2.1.cmml" xref="S2.E2.m1.3.3.2.3.2">subscript</csymbol><ci id="S2.E2.m1.3.3.2.3.2.2.cmml" xref="S2.E2.m1.3.3.2.3.2.2">𝜇</ci><cn type="integer" id="S2.E2.m1.3.3.2.3.2.3.cmml" xref="S2.E2.m1.3.3.2.3.2.3">0</cn></apply><apply id="S2.E2.m1.3.3.2.3.3.cmml" xref="S2.E2.m1.3.3.2.3.3"><times id="S2.E2.m1.3.3.2.3.3.1.cmml" xref="S2.E2.m1.3.3.2.3.3.1"></times><cn type="integer" id="S2.E2.m1.3.3.2.3.3.2.cmml" xref="S2.E2.m1.3.3.2.3.3.2">4</cn><ci id="S2.E2.m1.3.3.2.3.3.3.cmml" xref="S2.E2.m1.3.3.2.3.3.3">𝜋</ci></apply></apply><apply id="S2.E2.m1.3.3.2.1.2.cmml" xref="S2.E2.m1.3.3.2.1.1"><csymbol cd="latexml" id="S2.E2.m1.3.3.2.1.2.1.cmml" xref="S2.E2.m1.3.3.2.1.1.2">delimited-[]</csymbol><apply id="S2.E2.m1.3.3.2.1.1.1.cmml" xref="S2.E2.m1.3.3.2.1.1.1"><minus id="S2.E2.m1.3.3.2.1.1.1.1.cmml" xref="S2.E2.m1.3.3.2.1.1.1.1"></minus><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><divide id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1"></divide><apply id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><times id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.2"></times><cn type="integer" id="S2.E2.m1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.3">3</cn><ci id="S2.E2.m1.1.1.1.4.cmml" xref="S2.E2.m1.1.1.1.4">𝐫</ci><apply id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"><ci id="S2.E2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1">⋅</ci><ci id="S2.E2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2">𝐦</ci><ci id="S2.E2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3">𝐫</ci></apply></apply><apply id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.3">superscript</csymbol><ci id="S2.E2.m1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.3.2">𝑟</ci><cn type="integer" id="S2.E2.m1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.3.3">5</cn></apply></apply><apply id="S2.E2.m1.3.3.2.1.1.1.2.cmml" xref="S2.E2.m1.3.3.2.1.1.1.2"><divide id="S2.E2.m1.3.3.2.1.1.1.2.1.cmml" xref="S2.E2.m1.3.3.2.1.1.1.2"></divide><ci id="S2.E2.m1.3.3.2.1.1.1.2.2.cmml" xref="S2.E2.m1.3.3.2.1.1.1.2.2">𝐦</ci><apply id="S2.E2.m1.3.3.2.1.1.1.2.3.cmml" xref="S2.E2.m1.3.3.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.2.1.1.1.2.3.1.cmml" xref="S2.E2.m1.3.3.2.1.1.1.2.3">superscript</csymbol><ci id="S2.E2.m1.3.3.2.1.1.1.2.3.2.cmml" xref="S2.E2.m1.3.3.2.1.1.1.2.3.2">𝑟</ci><cn type="integer" id="S2.E2.m1.3.3.2.1.1.1.2.3.3.cmml" xref="S2.E2.m1.3.3.2.1.1.1.2.3.3">3</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.3c">{\mathbf{B}}({{\mathbf{p}}_{m}})=\frac{{{\mu_{0}}}}{{4\pi}}\left[{\frac{{3{\mathbf{r}}({\mathbf{m}}\cdot{\mathbf{r}})}}{{{r^{5}}}}-\frac{{\mathbf{m}}}{{{r^{3}}}}}\right]\,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.SSS2.p1.7" class="ltx_p">the magnetic field decays as <math id="S2.SS2.SSS2.p1.3.m1.1" class="ltx_Math" alttext="1/r^{3}" display="inline"><semantics id="S2.SS2.SSS2.p1.3.m1.1a"><mrow id="S2.SS2.SSS2.p1.3.m1.1.1" xref="S2.SS2.SSS2.p1.3.m1.1.1.cmml"><mn id="S2.SS2.SSS2.p1.3.m1.1.1.2" xref="S2.SS2.SSS2.p1.3.m1.1.1.2.cmml">1</mn><mo id="S2.SS2.SSS2.p1.3.m1.1.1.1" xref="S2.SS2.SSS2.p1.3.m1.1.1.1.cmml">/</mo><msup id="S2.SS2.SSS2.p1.3.m1.1.1.3" xref="S2.SS2.SSS2.p1.3.m1.1.1.3.cmml"><mi id="S2.SS2.SSS2.p1.3.m1.1.1.3.2" xref="S2.SS2.SSS2.p1.3.m1.1.1.3.2.cmml">r</mi><mn id="S2.SS2.SSS2.p1.3.m1.1.1.3.3" xref="S2.SS2.SSS2.p1.3.m1.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.3.m1.1b"><apply id="S2.SS2.SSS2.p1.3.m1.1.1.cmml" xref="S2.SS2.SSS2.p1.3.m1.1.1"><divide id="S2.SS2.SSS2.p1.3.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.3.m1.1.1.1"></divide><cn type="integer" id="S2.SS2.SSS2.p1.3.m1.1.1.2.cmml" xref="S2.SS2.SSS2.p1.3.m1.1.1.2">1</cn><apply id="S2.SS2.SSS2.p1.3.m1.1.1.3.cmml" xref="S2.SS2.SSS2.p1.3.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.3.m1.1.1.3.1.cmml" xref="S2.SS2.SSS2.p1.3.m1.1.1.3">superscript</csymbol><ci id="S2.SS2.SSS2.p1.3.m1.1.1.3.2.cmml" xref="S2.SS2.SSS2.p1.3.m1.1.1.3.2">𝑟</ci><cn type="integer" id="S2.SS2.SSS2.p1.3.m1.1.1.3.3.cmml" xref="S2.SS2.SSS2.p1.3.m1.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.3.m1.1c">1/r^{3}</annotation></semantics></math>, where <math id="S2.SS2.SSS2.p1.4.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S2.SS2.SSS2.p1.4.m2.1a"><mi id="S2.SS2.SSS2.p1.4.m2.1.1" xref="S2.SS2.SSS2.p1.4.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.4.m2.1b"><ci id="S2.SS2.SSS2.p1.4.m2.1.1.cmml" xref="S2.SS2.SSS2.p1.4.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.4.m2.1c">r</annotation></semantics></math> is the distance between the source and the sensors and <math id="S2.SS2.SSS2.p1.5.m3.1" class="ltx_Math" alttext="\mathbf{m}" display="inline"><semantics id="S2.SS2.SSS2.p1.5.m3.1a"><mi id="S2.SS2.SSS2.p1.5.m3.1.1" xref="S2.SS2.SSS2.p1.5.m3.1.1.cmml">𝐦</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.5.m3.1b"><ci id="S2.SS2.SSS2.p1.5.m3.1.1.cmml" xref="S2.SS2.SSS2.p1.5.m3.1.1">𝐦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.5.m3.1c">\mathbf{m}</annotation></semantics></math> is the dipole moment. In order to re-scale the input signals, we take the cubic root of the input data, <math id="S2.SS2.SSS2.p1.6.m4.1" class="ltx_Math" alttext="f(B)=\sqrt[3]{B}" display="inline"><semantics id="S2.SS2.SSS2.p1.6.m4.1a"><mrow id="S2.SS2.SSS2.p1.6.m4.1.2" xref="S2.SS2.SSS2.p1.6.m4.1.2.cmml"><mrow id="S2.SS2.SSS2.p1.6.m4.1.2.2" xref="S2.SS2.SSS2.p1.6.m4.1.2.2.cmml"><mi id="S2.SS2.SSS2.p1.6.m4.1.2.2.2" xref="S2.SS2.SSS2.p1.6.m4.1.2.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS2.p1.6.m4.1.2.2.1" xref="S2.SS2.SSS2.p1.6.m4.1.2.2.1.cmml">​</mo><mrow id="S2.SS2.SSS2.p1.6.m4.1.2.2.3.2" xref="S2.SS2.SSS2.p1.6.m4.1.2.2.cmml"><mo stretchy="false" id="S2.SS2.SSS2.p1.6.m4.1.2.2.3.2.1" xref="S2.SS2.SSS2.p1.6.m4.1.2.2.cmml">(</mo><mi id="S2.SS2.SSS2.p1.6.m4.1.1" xref="S2.SS2.SSS2.p1.6.m4.1.1.cmml">B</mi><mo stretchy="false" id="S2.SS2.SSS2.p1.6.m4.1.2.2.3.2.2" xref="S2.SS2.SSS2.p1.6.m4.1.2.2.cmml">)</mo></mrow></mrow><mo id="S2.SS2.SSS2.p1.6.m4.1.2.1" xref="S2.SS2.SSS2.p1.6.m4.1.2.1.cmml">=</mo><mroot id="S2.SS2.SSS2.p1.6.m4.1.2.3" xref="S2.SS2.SSS2.p1.6.m4.1.2.3.cmml"><mi id="S2.SS2.SSS2.p1.6.m4.1.2.3.3" xref="S2.SS2.SSS2.p1.6.m4.1.2.3.3.cmml">B</mi><mn id="S2.SS2.SSS2.p1.6.m4.1.2.3.2" xref="S2.SS2.SSS2.p1.6.m4.1.2.3.2.cmml">3</mn></mroot></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.6.m4.1b"><apply id="S2.SS2.SSS2.p1.6.m4.1.2.cmml" xref="S2.SS2.SSS2.p1.6.m4.1.2"><eq id="S2.SS2.SSS2.p1.6.m4.1.2.1.cmml" xref="S2.SS2.SSS2.p1.6.m4.1.2.1"></eq><apply id="S2.SS2.SSS2.p1.6.m4.1.2.2.cmml" xref="S2.SS2.SSS2.p1.6.m4.1.2.2"><times id="S2.SS2.SSS2.p1.6.m4.1.2.2.1.cmml" xref="S2.SS2.SSS2.p1.6.m4.1.2.2.1"></times><ci id="S2.SS2.SSS2.p1.6.m4.1.2.2.2.cmml" xref="S2.SS2.SSS2.p1.6.m4.1.2.2.2">𝑓</ci><ci id="S2.SS2.SSS2.p1.6.m4.1.1.cmml" xref="S2.SS2.SSS2.p1.6.m4.1.1">𝐵</ci></apply><apply id="S2.SS2.SSS2.p1.6.m4.1.2.3.cmml" xref="S2.SS2.SSS2.p1.6.m4.1.2.3"><root id="S2.SS2.SSS2.p1.6.m4.1.2.3a.cmml" xref="S2.SS2.SSS2.p1.6.m4.1.2.3"></root><degree id="S2.SS2.SSS2.p1.6.m4.1.2.3b.cmml" xref="S2.SS2.SSS2.p1.6.m4.1.2.3"><cn type="integer" id="S2.SS2.SSS2.p1.6.m4.1.2.3.2.cmml" xref="S2.SS2.SSS2.p1.6.m4.1.2.3.2">3</cn></degree><ci id="S2.SS2.SSS2.p1.6.m4.1.2.3.3.cmml" xref="S2.SS2.SSS2.p1.6.m4.1.2.3.3">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.6.m4.1c">f(B)=\sqrt[3]{B}</annotation></semantics></math> (see Figure <a href="#S2.F1" title="Figure 1 ‣ 2 Method ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). We found that training with cubic root re-scaling convergences in <math id="S2.SS2.SSS2.p1.7.m5.1" class="ltx_Math" alttext="\sim 40" display="inline"><semantics id="S2.SS2.SSS2.p1.7.m5.1a"><mrow id="S2.SS2.SSS2.p1.7.m5.1.1" xref="S2.SS2.SSS2.p1.7.m5.1.1.cmml"><mi id="S2.SS2.SSS2.p1.7.m5.1.1.2" xref="S2.SS2.SSS2.p1.7.m5.1.1.2.cmml"></mi><mo id="S2.SS2.SSS2.p1.7.m5.1.1.1" xref="S2.SS2.SSS2.p1.7.m5.1.1.1.cmml">∼</mo><mn id="S2.SS2.SSS2.p1.7.m5.1.1.3" xref="S2.SS2.SSS2.p1.7.m5.1.1.3.cmml">40</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.7.m5.1b"><apply id="S2.SS2.SSS2.p1.7.m5.1.1.cmml" xref="S2.SS2.SSS2.p1.7.m5.1.1"><csymbol cd="latexml" id="S2.SS2.SSS2.p1.7.m5.1.1.1.cmml" xref="S2.SS2.SSS2.p1.7.m5.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S2.SS2.SSS2.p1.7.m5.1.1.2.cmml" xref="S2.SS2.SSS2.p1.7.m5.1.1.2">absent</csymbol><cn type="integer" id="S2.SS2.SSS2.p1.7.m5.1.1.3.cmml" xref="S2.SS2.SSS2.p1.7.m5.1.1.3">40</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.7.m5.1c">\sim 40</annotation></semantics></math> epochs.</p>
</div>
</section>
<section id="S2.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.3 </span>Training Loss</h4>

<div id="S2.SS2.SSS3.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.SSS3.p1.3" class="ltx_p">We train the neural networks with randomly sampled data in a cubic volume, <math id="S2.SS2.SSS3.p1.1.m1.1" class="ltx_Math" alttext="0.2\times 0.2\times 0.15" display="inline"><semantics id="S2.SS2.SSS3.p1.1.m1.1a"><mrow id="S2.SS2.SSS3.p1.1.m1.1.1" xref="S2.SS2.SSS3.p1.1.m1.1.1.cmml"><mn id="S2.SS2.SSS3.p1.1.m1.1.1.2" xref="S2.SS2.SSS3.p1.1.m1.1.1.2.cmml">0.2</mn><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.SSS3.p1.1.m1.1.1.1" xref="S2.SS2.SSS3.p1.1.m1.1.1.1.cmml">×</mo><mn id="S2.SS2.SSS3.p1.1.m1.1.1.3" xref="S2.SS2.SSS3.p1.1.m1.1.1.3.cmml">0.2</mn><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.SSS3.p1.1.m1.1.1.1a" xref="S2.SS2.SSS3.p1.1.m1.1.1.1.cmml">×</mo><mn id="S2.SS2.SSS3.p1.1.m1.1.1.4" xref="S2.SS2.SSS3.p1.1.m1.1.1.4.cmml">0.15</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.1.m1.1b"><apply id="S2.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS3.p1.1.m1.1.1"><times id="S2.SS2.SSS3.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS3.p1.1.m1.1.1.1"></times><cn type="float" id="S2.SS2.SSS3.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS3.p1.1.m1.1.1.2">0.2</cn><cn type="float" id="S2.SS2.SSS3.p1.1.m1.1.1.3.cmml" xref="S2.SS2.SSS3.p1.1.m1.1.1.3">0.2</cn><cn type="float" id="S2.SS2.SSS3.p1.1.m1.1.1.4.cmml" xref="S2.SS2.SSS3.p1.1.m1.1.1.4">0.15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.1.m1.1c">0.2\times 0.2\times 0.15</annotation></semantics></math> m<sup id="S2.SS2.SSS3.p1.3.1" class="ltx_sup">3</sup>, with the sensor array covering the bottom face.
The magnets’ orientation is sampled as points on a unit sphere, then paired with the locations as labels for training.
Then, the labeled data for training is obtained as in Algorithm <a href="#alg1" title="Algorithm 1 ‣ Table 1 ‣ 2.1 Synthetic Dataset ‣ 2 Method ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
As loss function we used the weighted sum of positional and orientation differences averaged over all <math id="S2.SS2.SSS3.p1.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.SS2.SSS3.p1.3.m3.1a"><mi id="S2.SS2.SSS3.p1.3.m3.1.1" xref="S2.SS2.SSS3.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.3.m3.1b"><ci id="S2.SS2.SSS3.p1.3.m3.1.1.cmml" xref="S2.SS2.SSS3.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.3.m3.1c">n</annotation></semantics></math> points in a training batch:</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.3" class="ltx_Math" alttext="\mathcal{L}=\frac{1}{n}\sum_{i=1}^{n}\big{(}\|\mathbf{p}_{true}-\mathbf{p}_{pred}\|^{2}+\eta\|\frac{\mathbf{o}_{true}}{\|\mathbf{o}_{true}\|}-\frac{\mathbf{o}_{pred}}{\|\mathbf{o}_{pred}\|}\|^{2}\big{)}" display="block"><semantics id="S2.E3.m1.3a"><mrow id="S2.E3.m1.3.3" xref="S2.E3.m1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.3.3.3" xref="S2.E3.m1.3.3.3.cmml">ℒ</mi><mo id="S2.E3.m1.3.3.2" xref="S2.E3.m1.3.3.2.cmml">=</mo><mrow id="S2.E3.m1.3.3.1" xref="S2.E3.m1.3.3.1.cmml"><mfrac id="S2.E3.m1.3.3.1.3" xref="S2.E3.m1.3.3.1.3.cmml"><mn id="S2.E3.m1.3.3.1.3.2" xref="S2.E3.m1.3.3.1.3.2.cmml">1</mn><mi id="S2.E3.m1.3.3.1.3.3" xref="S2.E3.m1.3.3.1.3.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.2" xref="S2.E3.m1.3.3.1.2.cmml">​</mo><mrow id="S2.E3.m1.3.3.1.1" xref="S2.E3.m1.3.3.1.1.cmml"><munderover id="S2.E3.m1.3.3.1.1.2" xref="S2.E3.m1.3.3.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S2.E3.m1.3.3.1.1.2.2.2" xref="S2.E3.m1.3.3.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E3.m1.3.3.1.1.2.2.3" xref="S2.E3.m1.3.3.1.1.2.2.3.cmml"><mi id="S2.E3.m1.3.3.1.1.2.2.3.2" xref="S2.E3.m1.3.3.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E3.m1.3.3.1.1.2.2.3.1" xref="S2.E3.m1.3.3.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E3.m1.3.3.1.1.2.2.3.3" xref="S2.E3.m1.3.3.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m1.3.3.1.1.2.3" xref="S2.E3.m1.3.3.1.1.2.3.cmml">n</mi></munderover><mrow id="S2.E3.m1.3.3.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.cmml"><mo maxsize="120%" minsize="120%" id="S2.E3.m1.3.3.1.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.cmml"><msup id="S2.E3.m1.3.3.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐩</mi><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.1a" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.4" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.4.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.1b" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.5" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.5.cmml">e</mi></mrow></msub><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐩</mi><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1a" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.4" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1b" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.5" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.5.cmml">d</mi></mrow></msub></mrow><mo stretchy="false" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E3.m1.3.3.1.1.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S2.E3.m1.3.3.1.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.1.3.cmml">+</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1.1.2.3" xref="S2.E3.m1.3.3.1.1.1.1.1.2.3.cmml">η</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.1.1.1.1.2.2" xref="S2.E3.m1.3.3.1.1.1.1.1.2.2.cmml">​</mo><msup id="S2.E3.m1.3.3.1.1.1.1.1.2.1" xref="S2.E3.m1.3.3.1.1.1.1.1.2.1.cmml"><mrow id="S2.E3.m1.3.3.1.1.1.1.1.2.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.2.1.1.2.cmml"><mo stretchy="false" id="S2.E3.m1.3.3.1.1.1.1.1.2.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.1.1.2.1.1.2.1.cmml">‖</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1.2.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.2.1.1.1.1.cmml"><mfrac id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml"><msub id="S2.E3.m1.1.1.3" xref="S2.E3.m1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.3.2" xref="S2.E3.m1.1.1.3.2.cmml">𝐨</mi><mrow id="S2.E3.m1.1.1.3.3" xref="S2.E3.m1.1.1.3.3.cmml"><mi id="S2.E3.m1.1.1.3.3.2" xref="S2.E3.m1.1.1.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.3.3.1" xref="S2.E3.m1.1.1.3.3.1.cmml">​</mo><mi id="S2.E3.m1.1.1.3.3.3" xref="S2.E3.m1.1.1.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.3.3.1a" xref="S2.E3.m1.1.1.3.3.1.cmml">​</mo><mi id="S2.E3.m1.1.1.3.3.4" xref="S2.E3.m1.1.1.3.3.4.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.3.3.1b" xref="S2.E3.m1.1.1.3.3.1.cmml">​</mo><mi id="S2.E3.m1.1.1.3.3.5" xref="S2.E3.m1.1.1.3.3.5.cmml">e</mi></mrow></msub><mrow id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E3.m1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.2.1.cmml">‖</mo><msub id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.2.cmml">𝐨</mi><mrow id="S2.E3.m1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.1.1.1.3.1" xref="S2.E3.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.E3.m1.1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.1.1.1.3.1a" xref="S2.E3.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.E3.m1.1.1.1.1.1.3.4" xref="S2.E3.m1.1.1.1.1.1.3.4.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.1.1.1.3.1b" xref="S2.E3.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.E3.m1.1.1.1.1.1.3.5" xref="S2.E3.m1.1.1.1.1.1.3.5.cmml">e</mi></mrow></msub><mo stretchy="false" id="S2.E3.m1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.2.1.cmml">‖</mo></mrow></mfrac><mo id="S2.E3.m1.3.3.1.1.1.1.1.2.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.2.1.1.1.1.1.cmml">−</mo><mfrac id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml"><msub id="S2.E3.m1.2.2.3" xref="S2.E3.m1.2.2.3.cmml"><mi id="S2.E3.m1.2.2.3.2" xref="S2.E3.m1.2.2.3.2.cmml">𝐨</mi><mrow id="S2.E3.m1.2.2.3.3" xref="S2.E3.m1.2.2.3.3.cmml"><mi id="S2.E3.m1.2.2.3.3.2" xref="S2.E3.m1.2.2.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.3.3.1" xref="S2.E3.m1.2.2.3.3.1.cmml">​</mo><mi id="S2.E3.m1.2.2.3.3.3" xref="S2.E3.m1.2.2.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.3.3.1a" xref="S2.E3.m1.2.2.3.3.1.cmml">​</mo><mi id="S2.E3.m1.2.2.3.3.4" xref="S2.E3.m1.2.2.3.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.3.3.1b" xref="S2.E3.m1.2.2.3.3.1.cmml">​</mo><mi id="S2.E3.m1.2.2.3.3.5" xref="S2.E3.m1.2.2.3.3.5.cmml">d</mi></mrow></msub><mrow id="S2.E3.m1.2.2.1.1" xref="S2.E3.m1.2.2.1.2.cmml"><mo stretchy="false" id="S2.E3.m1.2.2.1.1.2" xref="S2.E3.m1.2.2.1.2.1.cmml">‖</mo><msub id="S2.E3.m1.2.2.1.1.1" xref="S2.E3.m1.2.2.1.1.1.cmml"><mi id="S2.E3.m1.2.2.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.2.cmml">𝐨</mi><mrow id="S2.E3.m1.2.2.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.3.cmml"><mi id="S2.E3.m1.2.2.1.1.1.3.2" xref="S2.E3.m1.2.2.1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.1.3.1" xref="S2.E3.m1.2.2.1.1.1.3.1.cmml">​</mo><mi id="S2.E3.m1.2.2.1.1.1.3.3" xref="S2.E3.m1.2.2.1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.1.3.1a" xref="S2.E3.m1.2.2.1.1.1.3.1.cmml">​</mo><mi id="S2.E3.m1.2.2.1.1.1.3.4" xref="S2.E3.m1.2.2.1.1.1.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.1.3.1b" xref="S2.E3.m1.2.2.1.1.1.3.1.cmml">​</mo><mi id="S2.E3.m1.2.2.1.1.1.3.5" xref="S2.E3.m1.2.2.1.1.1.3.5.cmml">d</mi></mrow></msub><mo stretchy="false" id="S2.E3.m1.2.2.1.1.3" xref="S2.E3.m1.2.2.1.2.1.cmml">‖</mo></mrow></mfrac></mrow><mo stretchy="false" id="S2.E3.m1.3.3.1.1.1.1.1.2.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.1.2.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E3.m1.3.3.1.1.1.1.1.2.1.3" xref="S2.E3.m1.3.3.1.1.1.1.1.2.1.3.cmml">2</mn></msup></mrow></mrow><mo maxsize="120%" minsize="120%" id="S2.E3.m1.3.3.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.3b"><apply id="S2.E3.m1.3.3.cmml" xref="S2.E3.m1.3.3"><eq id="S2.E3.m1.3.3.2.cmml" xref="S2.E3.m1.3.3.2"></eq><ci id="S2.E3.m1.3.3.3.cmml" xref="S2.E3.m1.3.3.3">ℒ</ci><apply id="S2.E3.m1.3.3.1.cmml" xref="S2.E3.m1.3.3.1"><times id="S2.E3.m1.3.3.1.2.cmml" xref="S2.E3.m1.3.3.1.2"></times><apply id="S2.E3.m1.3.3.1.3.cmml" xref="S2.E3.m1.3.3.1.3"><divide id="S2.E3.m1.3.3.1.3.1.cmml" xref="S2.E3.m1.3.3.1.3"></divide><cn type="integer" id="S2.E3.m1.3.3.1.3.2.cmml" xref="S2.E3.m1.3.3.1.3.2">1</cn><ci id="S2.E3.m1.3.3.1.3.3.cmml" xref="S2.E3.m1.3.3.1.3.3">𝑛</ci></apply><apply id="S2.E3.m1.3.3.1.1.cmml" xref="S2.E3.m1.3.3.1.1"><apply id="S2.E3.m1.3.3.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.2.1.cmml" xref="S2.E3.m1.3.3.1.1.2">superscript</csymbol><apply id="S2.E3.m1.3.3.1.1.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.2.2.1.cmml" xref="S2.E3.m1.3.3.1.1.2">subscript</csymbol><sum id="S2.E3.m1.3.3.1.1.2.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2"></sum><apply id="S2.E3.m1.3.3.1.1.2.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3"><eq id="S2.E3.m1.3.3.1.1.2.2.3.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3.1"></eq><ci id="S2.E3.m1.3.3.1.1.2.2.3.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S2.E3.m1.3.3.1.1.2.2.3.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E3.m1.3.3.1.1.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.3">𝑛</ci></apply><apply id="S2.E3.m1.3.3.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1"><plus id="S2.E3.m1.3.3.1.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.3"></plus><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1"><minus id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.2">𝐩</ci><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3"><times id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.2">𝑡</ci><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3">𝑟</ci><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.4">𝑢</ci><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.5.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.5">𝑒</ci></apply></apply><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.2">𝐩</ci><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3"><times id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2">𝑝</ci><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3">𝑟</ci><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.4">𝑒</ci><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.5.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.5">𝑑</ci></apply></apply></apply></apply><cn type="integer" id="S2.E3.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.3">2</cn></apply><apply id="S2.E3.m1.3.3.1.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.2"><times id="S2.E3.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.2.2"></times><ci id="S2.E3.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.2.3">𝜂</ci><apply id="S2.E3.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.1.2.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.2.1">superscript</csymbol><apply id="S2.E3.m1.3.3.1.1.1.1.1.2.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.2.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.3.3.1.1.1.1.1.2.1.1.2.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.2.1.1.1.2">norm</csymbol><apply id="S2.E3.m1.3.3.1.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.2.1.1.1.1"><minus id="S2.E3.m1.3.3.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.2.1.1.1.1.1"></minus><apply id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1"><divide id="S2.E3.m1.1.1.2.cmml" xref="S2.E3.m1.1.1"></divide><apply id="S2.E3.m1.1.1.3.cmml" xref="S2.E3.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.3.2">𝐨</ci><apply id="S2.E3.m1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.3.3"><times id="S2.E3.m1.1.1.3.3.1.cmml" xref="S2.E3.m1.1.1.3.3.1"></times><ci id="S2.E3.m1.1.1.3.3.2.cmml" xref="S2.E3.m1.1.1.3.3.2">𝑡</ci><ci id="S2.E3.m1.1.1.3.3.3.cmml" xref="S2.E3.m1.1.1.3.3.3">𝑟</ci><ci id="S2.E3.m1.1.1.3.3.4.cmml" xref="S2.E3.m1.1.1.3.3.4">𝑢</ci><ci id="S2.E3.m1.1.1.3.3.5.cmml" xref="S2.E3.m1.1.1.3.3.5">𝑒</ci></apply></apply><apply id="S2.E3.m1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.1.1.2">norm</csymbol><apply id="S2.E3.m1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.2">𝐨</ci><apply id="S2.E3.m1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3"><times id="S2.E3.m1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.3.1"></times><ci id="S2.E3.m1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.3.2">𝑡</ci><ci id="S2.E3.m1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3.3">𝑟</ci><ci id="S2.E3.m1.1.1.1.1.1.3.4.cmml" xref="S2.E3.m1.1.1.1.1.1.3.4">𝑢</ci><ci id="S2.E3.m1.1.1.1.1.1.3.5.cmml" xref="S2.E3.m1.1.1.1.1.1.3.5">𝑒</ci></apply></apply></apply></apply><apply id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2"><divide id="S2.E3.m1.2.2.2.cmml" xref="S2.E3.m1.2.2"></divide><apply id="S2.E3.m1.2.2.3.cmml" xref="S2.E3.m1.2.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.3.1.cmml" xref="S2.E3.m1.2.2.3">subscript</csymbol><ci id="S2.E3.m1.2.2.3.2.cmml" xref="S2.E3.m1.2.2.3.2">𝐨</ci><apply id="S2.E3.m1.2.2.3.3.cmml" xref="S2.E3.m1.2.2.3.3"><times id="S2.E3.m1.2.2.3.3.1.cmml" xref="S2.E3.m1.2.2.3.3.1"></times><ci id="S2.E3.m1.2.2.3.3.2.cmml" xref="S2.E3.m1.2.2.3.3.2">𝑝</ci><ci id="S2.E3.m1.2.2.3.3.3.cmml" xref="S2.E3.m1.2.2.3.3.3">𝑟</ci><ci id="S2.E3.m1.2.2.3.3.4.cmml" xref="S2.E3.m1.2.2.3.3.4">𝑒</ci><ci id="S2.E3.m1.2.2.3.3.5.cmml" xref="S2.E3.m1.2.2.3.3.5">𝑑</ci></apply></apply><apply id="S2.E3.m1.2.2.1.2.cmml" xref="S2.E3.m1.2.2.1.1"><csymbol cd="latexml" id="S2.E3.m1.2.2.1.2.1.cmml" xref="S2.E3.m1.2.2.1.1.2">norm</csymbol><apply id="S2.E3.m1.2.2.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.2">𝐨</ci><apply id="S2.E3.m1.2.2.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.3"><times id="S2.E3.m1.2.2.1.1.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.3.1"></times><ci id="S2.E3.m1.2.2.1.1.1.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.3.2">𝑝</ci><ci id="S2.E3.m1.2.2.1.1.1.3.3.cmml" xref="S2.E3.m1.2.2.1.1.1.3.3">𝑟</ci><ci id="S2.E3.m1.2.2.1.1.1.3.4.cmml" xref="S2.E3.m1.2.2.1.1.1.3.4">𝑒</ci><ci id="S2.E3.m1.2.2.1.1.1.3.5.cmml" xref="S2.E3.m1.2.2.1.1.1.3.5">𝑑</ci></apply></apply></apply></apply></apply></apply><cn type="integer" id="S2.E3.m1.3.3.1.1.1.1.1.2.1.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.2.1.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.3c">\mathcal{L}=\frac{1}{n}\sum_{i=1}^{n}\big{(}\|\mathbf{p}_{true}-\mathbf{p}_{pred}\|^{2}+\eta\|\frac{\mathbf{o}_{true}}{\|\mathbf{o}_{true}\|}-\frac{\mathbf{o}_{pred}}{\|\mathbf{o}_{pred}\|}\|^{2}\big{)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.SSS3.p1.5" class="ltx_p">where we aim to minimise both the positional and oriental disparity between the prediction and ground truth.
We add the weight <math id="S2.SS2.SSS3.p1.4.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S2.SS2.SSS3.p1.4.m1.1a"><mi id="S2.SS2.SSS3.p1.4.m1.1.1" xref="S2.SS2.SSS3.p1.4.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.4.m1.1b"><ci id="S2.SS2.SSS3.p1.4.m1.1.1.cmml" xref="S2.SS2.SSS3.p1.4.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.4.m1.1c">\eta</annotation></semantics></math> to compensate for different orientation and positional error term scales. From parameter tuning, we find <math id="S2.SS2.SSS3.p1.5.m2.1" class="ltx_Math" alttext="\eta=10^{-5}" display="inline"><semantics id="S2.SS2.SSS3.p1.5.m2.1a"><mrow id="S2.SS2.SSS3.p1.5.m2.1.1" xref="S2.SS2.SSS3.p1.5.m2.1.1.cmml"><mi id="S2.SS2.SSS3.p1.5.m2.1.1.2" xref="S2.SS2.SSS3.p1.5.m2.1.1.2.cmml">η</mi><mo id="S2.SS2.SSS3.p1.5.m2.1.1.1" xref="S2.SS2.SSS3.p1.5.m2.1.1.1.cmml">=</mo><msup id="S2.SS2.SSS3.p1.5.m2.1.1.3" xref="S2.SS2.SSS3.p1.5.m2.1.1.3.cmml"><mn id="S2.SS2.SSS3.p1.5.m2.1.1.3.2" xref="S2.SS2.SSS3.p1.5.m2.1.1.3.2.cmml">10</mn><mrow id="S2.SS2.SSS3.p1.5.m2.1.1.3.3" xref="S2.SS2.SSS3.p1.5.m2.1.1.3.3.cmml"><mo id="S2.SS2.SSS3.p1.5.m2.1.1.3.3a" xref="S2.SS2.SSS3.p1.5.m2.1.1.3.3.cmml">−</mo><mn id="S2.SS2.SSS3.p1.5.m2.1.1.3.3.2" xref="S2.SS2.SSS3.p1.5.m2.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.5.m2.1b"><apply id="S2.SS2.SSS3.p1.5.m2.1.1.cmml" xref="S2.SS2.SSS3.p1.5.m2.1.1"><eq id="S2.SS2.SSS3.p1.5.m2.1.1.1.cmml" xref="S2.SS2.SSS3.p1.5.m2.1.1.1"></eq><ci id="S2.SS2.SSS3.p1.5.m2.1.1.2.cmml" xref="S2.SS2.SSS3.p1.5.m2.1.1.2">𝜂</ci><apply id="S2.SS2.SSS3.p1.5.m2.1.1.3.cmml" xref="S2.SS2.SSS3.p1.5.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS3.p1.5.m2.1.1.3.1.cmml" xref="S2.SS2.SSS3.p1.5.m2.1.1.3">superscript</csymbol><cn type="integer" id="S2.SS2.SSS3.p1.5.m2.1.1.3.2.cmml" xref="S2.SS2.SSS3.p1.5.m2.1.1.3.2">10</cn><apply id="S2.SS2.SSS3.p1.5.m2.1.1.3.3.cmml" xref="S2.SS2.SSS3.p1.5.m2.1.1.3.3"><minus id="S2.SS2.SSS3.p1.5.m2.1.1.3.3.1.cmml" xref="S2.SS2.SSS3.p1.5.m2.1.1.3.3"></minus><cn type="integer" id="S2.SS2.SSS3.p1.5.m2.1.1.3.3.2.cmml" xref="S2.SS2.SSS3.p1.5.m2.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.5.m2.1c">\eta=10^{-5}</annotation></semantics></math> and use it as a default in all experiments.</p>
</div>
<div id="S2.SS2.SSS3.p2" class="ltx_para ltx_noindent">
<p id="S2.SS2.SSS3.p2.5" class="ltx_p">We implement the MLP in python with PyTorch. The optimizer Adam <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> is adopted with an initial learning rate <math id="S2.SS2.SSS3.p2.1.m1.1" class="ltx_Math" alttext="\gamma=10^{-4}" display="inline"><semantics id="S2.SS2.SSS3.p2.1.m1.1a"><mrow id="S2.SS2.SSS3.p2.1.m1.1.1" xref="S2.SS2.SSS3.p2.1.m1.1.1.cmml"><mi id="S2.SS2.SSS3.p2.1.m1.1.1.2" xref="S2.SS2.SSS3.p2.1.m1.1.1.2.cmml">γ</mi><mo id="S2.SS2.SSS3.p2.1.m1.1.1.1" xref="S2.SS2.SSS3.p2.1.m1.1.1.1.cmml">=</mo><msup id="S2.SS2.SSS3.p2.1.m1.1.1.3" xref="S2.SS2.SSS3.p2.1.m1.1.1.3.cmml"><mn id="S2.SS2.SSS3.p2.1.m1.1.1.3.2" xref="S2.SS2.SSS3.p2.1.m1.1.1.3.2.cmml">10</mn><mrow id="S2.SS2.SSS3.p2.1.m1.1.1.3.3" xref="S2.SS2.SSS3.p2.1.m1.1.1.3.3.cmml"><mo id="S2.SS2.SSS3.p2.1.m1.1.1.3.3a" xref="S2.SS2.SSS3.p2.1.m1.1.1.3.3.cmml">−</mo><mn id="S2.SS2.SSS3.p2.1.m1.1.1.3.3.2" xref="S2.SS2.SSS3.p2.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p2.1.m1.1b"><apply id="S2.SS2.SSS3.p2.1.m1.1.1.cmml" xref="S2.SS2.SSS3.p2.1.m1.1.1"><eq id="S2.SS2.SSS3.p2.1.m1.1.1.1.cmml" xref="S2.SS2.SSS3.p2.1.m1.1.1.1"></eq><ci id="S2.SS2.SSS3.p2.1.m1.1.1.2.cmml" xref="S2.SS2.SSS3.p2.1.m1.1.1.2">𝛾</ci><apply id="S2.SS2.SSS3.p2.1.m1.1.1.3.cmml" xref="S2.SS2.SSS3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS3.p2.1.m1.1.1.3.1.cmml" xref="S2.SS2.SSS3.p2.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S2.SS2.SSS3.p2.1.m1.1.1.3.2.cmml" xref="S2.SS2.SSS3.p2.1.m1.1.1.3.2">10</cn><apply id="S2.SS2.SSS3.p2.1.m1.1.1.3.3.cmml" xref="S2.SS2.SSS3.p2.1.m1.1.1.3.3"><minus id="S2.SS2.SSS3.p2.1.m1.1.1.3.3.1.cmml" xref="S2.SS2.SSS3.p2.1.m1.1.1.3.3"></minus><cn type="integer" id="S2.SS2.SSS3.p2.1.m1.1.1.3.3.2.cmml" xref="S2.SS2.SSS3.p2.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p2.1.m1.1c">\gamma=10^{-4}</annotation></semantics></math>.
We train for 40 epochs, and the learning rate decays by <math id="S2.SS2.SSS3.p2.2.m2.1" class="ltx_Math" alttext="0.98" display="inline"><semantics id="S2.SS2.SSS3.p2.2.m2.1a"><mn id="S2.SS2.SSS3.p2.2.m2.1.1" xref="S2.SS2.SSS3.p2.2.m2.1.1.cmml">0.98</mn><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p2.2.m2.1b"><cn type="float" id="S2.SS2.SSS3.p2.2.m2.1.1.cmml" xref="S2.SS2.SSS3.p2.2.m2.1.1">0.98</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p2.2.m2.1c">0.98</annotation></semantics></math> after each epoch in training.
We generate <math id="S2.SS2.SSS3.p2.3.m3.1" class="ltx_Math" alttext="10^{6}" display="inline"><semantics id="S2.SS2.SSS3.p2.3.m3.1a"><msup id="S2.SS2.SSS3.p2.3.m3.1.1" xref="S2.SS2.SSS3.p2.3.m3.1.1.cmml"><mn id="S2.SS2.SSS3.p2.3.m3.1.1.2" xref="S2.SS2.SSS3.p2.3.m3.1.1.2.cmml">10</mn><mn id="S2.SS2.SSS3.p2.3.m3.1.1.3" xref="S2.SS2.SSS3.p2.3.m3.1.1.3.cmml">6</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p2.3.m3.1b"><apply id="S2.SS2.SSS3.p2.3.m3.1.1.cmml" xref="S2.SS2.SSS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS3.p2.3.m3.1.1.1.cmml" xref="S2.SS2.SSS3.p2.3.m3.1.1">superscript</csymbol><cn type="integer" id="S2.SS2.SSS3.p2.3.m3.1.1.2.cmml" xref="S2.SS2.SSS3.p2.3.m3.1.1.2">10</cn><cn type="integer" id="S2.SS2.SSS3.p2.3.m3.1.1.3.cmml" xref="S2.SS2.SSS3.p2.3.m3.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p2.3.m3.1c">10^{6}</annotation></semantics></math> random points per epoch to train the model with a batch size of <math id="S2.SS2.SSS3.p2.4.m4.1" class="ltx_Math" alttext="256" display="inline"><semantics id="S2.SS2.SSS3.p2.4.m4.1a"><mn id="S2.SS2.SSS3.p2.4.m4.1.1" xref="S2.SS2.SSS3.p2.4.m4.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p2.4.m4.1b"><cn type="integer" id="S2.SS2.SSS3.p2.4.m4.1.1.cmml" xref="S2.SS2.SSS3.p2.4.m4.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p2.4.m4.1c">256</annotation></semantics></math>.
Using Algorithm <a href="#alg1" title="Algorithm 1 ‣ Table 1 ‣ 2.1 Synthetic Dataset ‣ 2 Method ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> we generate the training data independently and identically distributed. Data generation and training of the MLP takes <math id="S2.SS2.SSS3.p2.5.m5.1" class="ltx_Math" alttext="\sim 1" display="inline"><semantics id="S2.SS2.SSS3.p2.5.m5.1a"><mrow id="S2.SS2.SSS3.p2.5.m5.1.1" xref="S2.SS2.SSS3.p2.5.m5.1.1.cmml"><mi id="S2.SS2.SSS3.p2.5.m5.1.1.2" xref="S2.SS2.SSS3.p2.5.m5.1.1.2.cmml"></mi><mo id="S2.SS2.SSS3.p2.5.m5.1.1.1" xref="S2.SS2.SSS3.p2.5.m5.1.1.1.cmml">∼</mo><mn id="S2.SS2.SSS3.p2.5.m5.1.1.3" xref="S2.SS2.SSS3.p2.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p2.5.m5.1b"><apply id="S2.SS2.SSS3.p2.5.m5.1.1.cmml" xref="S2.SS2.SSS3.p2.5.m5.1.1"><csymbol cd="latexml" id="S2.SS2.SSS3.p2.5.m5.1.1.1.cmml" xref="S2.SS2.SSS3.p2.5.m5.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S2.SS2.SSS3.p2.5.m5.1.1.2.cmml" xref="S2.SS2.SSS3.p2.5.m5.1.1.2">absent</csymbol><cn type="integer" id="S2.SS2.SSS3.p2.5.m5.1.1.3.cmml" xref="S2.SS2.SSS3.p2.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p2.5.m5.1c">\sim 1</annotation></semantics></math> hour.</p>
</div>
</section>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Hardware Implementation</h3>

<div id="S2.SS3.p1" class="ltx_para ltx_noindent">
<p id="S2.SS3.p1.8" class="ltx_p">The core of our hardware comprises <math id="S2.SS3.p1.1.m1.1" class="ltx_Math" alttext="16" display="inline"><semantics id="S2.SS3.p1.1.m1.1a"><mn id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><cn type="integer" id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">16</annotation></semantics></math> triaxial magnetometers (<em id="S2.SS3.p1.8.1" class="ltx_emph ltx_font_italic">MLX90393, Malexis)</em>. They have a linear range up to <math id="S2.SS3.p1.2.m2.1" class="ltx_Math" alttext="0.05" display="inline"><semantics id="S2.SS3.p1.2.m2.1a"><mn id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml">0.05</mn><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><cn type="float" id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">0.05</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">0.05</annotation></semantics></math> Tesla, which is compatible with the magnetic fields we expected from our testing magnets at close range. While the sensors allow for a data output rate of <math id="S2.SS3.p1.3.m3.1" class="ltx_Math" alttext="716.9" display="inline"><semantics id="S2.SS3.p1.3.m3.1a"><mn id="S2.SS3.p1.3.m3.1.1" xref="S2.SS3.p1.3.m3.1.1.cmml">716.9</mn><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m3.1b"><cn type="float" id="S2.SS3.p1.3.m3.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1">716.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.3.m3.1c">716.9</annotation></semantics></math> Hz, our default configuration is set to <math id="S2.SS3.p1.4.m4.1" class="ltx_Math" alttext="35.4" display="inline"><semantics id="S2.SS3.p1.4.m4.1a"><mn id="S2.SS3.p1.4.m4.1.1" xref="S2.SS3.p1.4.m4.1.1.cmml">35.4</mn><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.4.m4.1b"><cn type="float" id="S2.SS3.p1.4.m4.1.1.cmml" xref="S2.SS3.p1.4.m4.1.1">35.4</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.4.m4.1c">35.4</annotation></semantics></math> Hz. We also set the sensors to the <math id="S2.SS3.p1.5.m5.1" class="ltx_Math" alttext="0-10^{-1}" display="inline"><semantics id="S2.SS3.p1.5.m5.1a"><mrow id="S2.SS3.p1.5.m5.1.1" xref="S2.SS3.p1.5.m5.1.1.cmml"><mn id="S2.SS3.p1.5.m5.1.1.2" xref="S2.SS3.p1.5.m5.1.1.2.cmml">0</mn><mo id="S2.SS3.p1.5.m5.1.1.1" xref="S2.SS3.p1.5.m5.1.1.1.cmml">−</mo><msup id="S2.SS3.p1.5.m5.1.1.3" xref="S2.SS3.p1.5.m5.1.1.3.cmml"><mn id="S2.SS3.p1.5.m5.1.1.3.2" xref="S2.SS3.p1.5.m5.1.1.3.2.cmml">10</mn><mrow id="S2.SS3.p1.5.m5.1.1.3.3" xref="S2.SS3.p1.5.m5.1.1.3.3.cmml"><mo id="S2.SS3.p1.5.m5.1.1.3.3a" xref="S2.SS3.p1.5.m5.1.1.3.3.cmml">−</mo><mn id="S2.SS3.p1.5.m5.1.1.3.3.2" xref="S2.SS3.p1.5.m5.1.1.3.3.2.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.5.m5.1b"><apply id="S2.SS3.p1.5.m5.1.1.cmml" xref="S2.SS3.p1.5.m5.1.1"><minus id="S2.SS3.p1.5.m5.1.1.1.cmml" xref="S2.SS3.p1.5.m5.1.1.1"></minus><cn type="integer" id="S2.SS3.p1.5.m5.1.1.2.cmml" xref="S2.SS3.p1.5.m5.1.1.2">0</cn><apply id="S2.SS3.p1.5.m5.1.1.3.cmml" xref="S2.SS3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p1.5.m5.1.1.3.1.cmml" xref="S2.SS3.p1.5.m5.1.1.3">superscript</csymbol><cn type="integer" id="S2.SS3.p1.5.m5.1.1.3.2.cmml" xref="S2.SS3.p1.5.m5.1.1.3.2">10</cn><apply id="S2.SS3.p1.5.m5.1.1.3.3.cmml" xref="S2.SS3.p1.5.m5.1.1.3.3"><minus id="S2.SS3.p1.5.m5.1.1.3.3.1.cmml" xref="S2.SS3.p1.5.m5.1.1.3.3"></minus><cn type="integer" id="S2.SS3.p1.5.m5.1.1.3.3.2.cmml" xref="S2.SS3.p1.5.m5.1.1.3.3.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.5.m5.1c">0-10^{-1}</annotation></semantics></math> Tesla range, covering most of the cases when sensing locations are <math id="S2.SS3.p1.6.m6.1" class="ltx_Math" alttext="\geq 2" display="inline"><semantics id="S2.SS3.p1.6.m6.1a"><mrow id="S2.SS3.p1.6.m6.1.1" xref="S2.SS3.p1.6.m6.1.1.cmml"><mi id="S2.SS3.p1.6.m6.1.1.2" xref="S2.SS3.p1.6.m6.1.1.2.cmml"></mi><mo id="S2.SS3.p1.6.m6.1.1.1" xref="S2.SS3.p1.6.m6.1.1.1.cmml">≥</mo><mn id="S2.SS3.p1.6.m6.1.1.3" xref="S2.SS3.p1.6.m6.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.6.m6.1b"><apply id="S2.SS3.p1.6.m6.1.1.cmml" xref="S2.SS3.p1.6.m6.1.1"><geq id="S2.SS3.p1.6.m6.1.1.1.cmml" xref="S2.SS3.p1.6.m6.1.1.1"></geq><csymbol cd="latexml" id="S2.SS3.p1.6.m6.1.1.2.cmml" xref="S2.SS3.p1.6.m6.1.1.2">absent</csymbol><cn type="integer" id="S2.SS3.p1.6.m6.1.1.3.cmml" xref="S2.SS3.p1.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.6.m6.1c">\geq 2</annotation></semantics></math> cm away from the magnets.
In addition, we use the ellipsoid-fitting method in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> to calibrate our system.
The 16 sensors are placed in a <math id="S2.SS3.p1.7.m7.1" class="ltx_Math" alttext="4\times 4" display="inline"><semantics id="S2.SS3.p1.7.m7.1a"><mrow id="S2.SS3.p1.7.m7.1.1" xref="S2.SS3.p1.7.m7.1.1.cmml"><mn id="S2.SS3.p1.7.m7.1.1.2" xref="S2.SS3.p1.7.m7.1.1.2.cmml">4</mn><mo lspace="0.222em" rspace="0.222em" id="S2.SS3.p1.7.m7.1.1.1" xref="S2.SS3.p1.7.m7.1.1.1.cmml">×</mo><mn id="S2.SS3.p1.7.m7.1.1.3" xref="S2.SS3.p1.7.m7.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.7.m7.1b"><apply id="S2.SS3.p1.7.m7.1.1.cmml" xref="S2.SS3.p1.7.m7.1.1"><times id="S2.SS3.p1.7.m7.1.1.1.cmml" xref="S2.SS3.p1.7.m7.1.1.1"></times><cn type="integer" id="S2.SS3.p1.7.m7.1.1.2.cmml" xref="S2.SS3.p1.7.m7.1.1.2">4</cn><cn type="integer" id="S2.SS3.p1.7.m7.1.1.3.cmml" xref="S2.SS3.p1.7.m7.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.7.m7.1c">4\times 4</annotation></semantics></math> grid with an interval of <math id="S2.SS3.p1.8.m8.1" class="ltx_Math" alttext="52" display="inline"><semantics id="S2.SS3.p1.8.m8.1a"><mn id="S2.SS3.p1.8.m8.1.1" xref="S2.SS3.p1.8.m8.1.1.cmml">52</mn><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.8.m8.1b"><cn type="integer" id="S2.SS3.p1.8.m8.1.1.cmml" xref="S2.SS3.p1.8.m8.1.1">52</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.8.m8.1c">52</annotation></semantics></math> mm between the centers of neighboring sensors, as shown if Figure <a href="#S2.F2" title="Figure 2 ‣ 2.3 Hardware Implementation ‣ 2 Method ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(a).</p>
</div>
<div id="S2.SS3.p2" class="ltx_para ltx_noindent">
<p id="S2.SS3.p2.2" class="ltx_p">To keep instrumentation low and enable portable applications, e.g. prosthetics, we implemented the tracking inference in a AI-oriented single board computer (<em id="S2.SS3.p2.2.1" class="ltx_emph ltx_font_italic">Jetson Nano, NVIDIA</em>). This device only weights 138 grams and also allows for reading the sensors directly using the I2C communication protocol. The lower bound of time of reading <math id="S2.SS3.p2.1.m1.1" class="ltx_Math" alttext="16" display="inline"><semantics id="S2.SS3.p2.1.m1.1a"><mn id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><cn type="integer" id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">16</annotation></semantics></math> sensors sequentially is in the order of <math id="S2.SS3.p2.2.m2.1" class="ltx_Math" alttext="24" display="inline"><semantics id="S2.SS3.p2.2.m2.1a"><mn id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml">24</mn><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b"><cn type="integer" id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">24</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">24</annotation></semantics></math> milliseconds.</p>
</div>
<figure id="S2.F2" class="ltx_figure ltx_align_center">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2211.07556/assets/figures/sensor_photo.jpg" id="S2.F2.1.g1" class="ltx_graphics ltx_figure_panel ltx_img_square" width="598" height="532" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S2.F2.2.1" class="ltx_p ltx_figure_panel"><span id="S2.F2.2.1.1" class="ltx_text ltx_align_left ltx_inline-block" style="width:0.0pt;position:relative; bottom:111.0pt;"><svg version="1.1" width="93" height="63" overflow="visible"><g transform="translate(0,63) scale(1,-1)"><rect fill="none" height="45.5pt" stroke="#000000" stroke-width="0.4" width="67.2pt" x="0" y="0"></rect><g class="makebox" transform="translate(0,0)"><g transform="translate(0,63) scale(1, -1)"><foreignObject width="93" height="63" overflow="visible"><img src="/html/2211.07556/assets/figures/marker_holder.jpg" id="S2.F2.2.1.1.1.1.pic1.1.g1" class="ltx_graphics ltx_img_landscape" width="93" height="63" alt="Refer to caption"></foreignObject></g></g></g></svg></span></p>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Hall sensor array in a 4x4 grid. The center-to-center distance is 52mm. The array is connected to a Jetson Nano for the complete inference pipeline. The inset shows a rigid-tree to collect Optitrack groundtruth.
</figcaption>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Comparison between our data-driven and an optimization-based tracking</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">In this section, we contrast the performances of our neural network tracking method with an iterative gradient-descent based technique. Performing this comparison with simulated sensor readings allows us to control experimental conditions such as the initialization of the iterative optimization-based algorithm. The data is also noise-free, thus comparing the ideal performance of the two methods.</p>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.1" class="ltx_p">The optimization uses PyTorch with the magnet position and orientation set as variables with automatic differentiation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> enabled.
For the optimizer, we select L-BFGS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, a quasi-Newton method, with line search to establish the optimal step size.
The internal physical model to evaluate magnetic fields is the magnetic dipole model, implemented as in the loss function as proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>.</p>
</div>
<div id="S3.p3" class="ltx_para ltx_noindent">
<p id="S3.p3.1" class="ltx_p">For a fair comparison, we distinguish two cases: i) we train the MLP network using the FEM data, and ii) using the magnetic dipole model directly, which is equivalent to the optimization method model. Furthermore, we show the results obtained via the optimization-based method for different initialization errors. Finally, we compare the running time of the two approaches for tracking synthetic data.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Influence of initialization on the optimization methods</h3>

<figure id="S3.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2211.07556/assets/x2.png" id="S3.F3.sf1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="273" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2211.07556/assets/x3.png" id="S3.F3.sf2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="277" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>
Positional errors of the iterative method in simulation for different number of iterations.
(a) We vary to initial orientation mismatch keeping a fixed distance of <math id="S3.F3.3.m1.1" class="ltx_Math" alttext="80" display="inline"><semantics id="S3.F3.3.m1.1b"><mn id="S3.F3.3.m1.1.1" xref="S3.F3.3.m1.1.1.cmml">80</mn><annotation-xml encoding="MathML-Content" id="S3.F3.3.m1.1c"><cn type="integer" id="S3.F3.3.m1.1.1.cmml" xref="S3.F3.3.m1.1.1">80</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.3.m1.1d">80</annotation></semantics></math> mm to the truth.
(b) We vary the positional error initialization keeping a fixed orientation difference of <math id="S3.F3.4.m2.1" class="ltx_Math" alttext="45^{\circ}" display="inline"><semantics id="S3.F3.4.m2.1b"><msup id="S3.F3.4.m2.1.1" xref="S3.F3.4.m2.1.1.cmml"><mn id="S3.F3.4.m2.1.1.2" xref="S3.F3.4.m2.1.1.2.cmml">45</mn><mo id="S3.F3.4.m2.1.1.3" xref="S3.F3.4.m2.1.1.3.cmml">∘</mo></msup><annotation-xml encoding="MathML-Content" id="S3.F3.4.m2.1c"><apply id="S3.F3.4.m2.1.1.cmml" xref="S3.F3.4.m2.1.1"><csymbol cd="ambiguous" id="S3.F3.4.m2.1.1.1.cmml" xref="S3.F3.4.m2.1.1">superscript</csymbol><cn type="integer" id="S3.F3.4.m2.1.1.2.cmml" xref="S3.F3.4.m2.1.1.2">45</cn><compose id="S3.F3.4.m2.1.1.3.cmml" xref="S3.F3.4.m2.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.4.m2.1d">45^{\circ}</annotation></semantics></math>.
</figcaption>
</figure>
<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.1" class="ltx_p">For this evaluation, we randomly sample the magnet’s positions and orientations as in Section <a href="#S2.SS2.SSS3" title="2.2.3 Training Loss ‣ 2.2 Tracking with Neural Networks ‣ 2 Method ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.2.3</span></a>, and we compute corresponding magnetic flux densities with the magnetic dipole model at the locations of sensors (Eq. <a href="#S2.E2" title="In 2.2.2 Pre-processing ‣ 2.2 Tracking with Neural Networks ‣ 2 Method ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). In this way, the characteristics of the synthetic signals agree with the internal physical model in the optimization method. To have the initial guess in optimization, we disturb this target position and orientation. We configure the iterative algorithm so the optimization stops when reaching the maximal number of iterations we allowed.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.1" class="ltx_p">In Figure <a href="#S3.F3" title="Figure 3 ‣ 3.1 Influence of initialization on the optimization methods ‣ 3 Comparison between our data-driven and an optimization-based tracking ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> we present the results for the optimization method, reporting the tracking errors as a function of the of the maximal number of iteration for different values of positional miss-match (Figure <a href="#S3.F3" title="Figure 3 ‣ 3.1 Influence of initialization on the optimization methods ‣ 3 Comparison between our data-driven and an optimization-based tracking ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.a) and orientation miss-match (Figure <a href="#S3.F3" title="Figure 3 ‣ 3.1 Influence of initialization on the optimization methods ‣ 3 Comparison between our data-driven and an optimization-based tracking ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.b). Each box-plot is based in <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="400" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mn id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">400</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><cn type="integer" id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">400</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">400</annotation></semantics></math> randomly target positions and orientations.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.1" class="ltx_p">For detailed analysis, we report the statistics of tracking results after <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="50" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mn id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><cn type="integer" id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">50</annotation></semantics></math> iterations in Table <a href="#S3.T2" title="Table 2 ‣ 3.1 Influence of initialization on the optimization methods ‣ 3 Comparison between our data-driven and an optimization-based tracking ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (corresponding with the right most set of results in Figure <a href="#S3.F3" title="Figure 3 ‣ 3.1 Influence of initialization on the optimization methods ‣ 3 Comparison between our data-driven and an optimization-based tracking ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).
At the bottom of table we include the position and orientation errors for the same synthetic readings using our MLP method. Note that MLPs do not require an initial estimation of the position and orientation of the magnet. They are independent of the initialization, as it is not part of their feature vector.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para ltx_noindent">
<p id="S3.SS1.p4.4" class="ltx_p">Our MLP is outperformed only in the cases with most iterations (50), and with the best initialization: <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="80" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><mn id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">80</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><cn type="integer" id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">80</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">80</annotation></semantics></math> mm of initial positional error and <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="10^{\circ}" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><msup id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><mn id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml">10</mn><mo id="S3.SS1.p4.2.m2.1.1.3" xref="S3.SS1.p4.2.m2.1.1.3.cmml">∘</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">superscript</csymbol><cn type="integer" id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2">10</cn><compose id="S3.SS1.p4.2.m2.1.1.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">10^{\circ}</annotation></semantics></math> of initial orientation error, and <math id="S3.SS1.p4.3.m3.1" class="ltx_Math" alttext="30" display="inline"><semantics id="S3.SS1.p4.3.m3.1a"><mn id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml">30</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><cn type="integer" id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">30</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">30</annotation></semantics></math> mm of initial positional error and <math id="S3.SS1.p4.4.m4.1" class="ltx_Math" alttext="45^{\circ}" display="inline"><semantics id="S3.SS1.p4.4.m4.1a"><msup id="S3.SS1.p4.4.m4.1.1" xref="S3.SS1.p4.4.m4.1.1.cmml"><mn id="S3.SS1.p4.4.m4.1.1.2" xref="S3.SS1.p4.4.m4.1.1.2.cmml">45</mn><mo id="S3.SS1.p4.4.m4.1.1.3" xref="S3.SS1.p4.4.m4.1.1.3.cmml">∘</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.1b"><apply id="S3.SS1.p4.4.m4.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m4.1.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1">superscript</csymbol><cn type="integer" id="S3.SS1.p4.4.m4.1.1.2.cmml" xref="S3.SS1.p4.4.m4.1.1.2">45</cn><compose id="S3.SS1.p4.4.m4.1.1.3.cmml" xref="S3.SS1.p4.4.m4.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.1c">45^{\circ}</annotation></semantics></math> of initial orientation error. However, the computational time of this optimization-based method is about 50x longer than the time consumed by predicting via the MLP (see Sec. <a href="#S3.SS2" title="3.2 Running Time ‣ 3 Comparison between our data-driven and an optimization-based tracking ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>).</p>
</div>
<div id="S3.SS1.p5" class="ltx_para ltx_noindent">
<p id="S3.SS1.p5.2" class="ltx_p">When we reduce the number of iterations, the error increases considerably. With only ten iterations, the median positional error exceeds <math id="S3.SS1.p5.1.m1.1" class="ltx_Math" alttext="200" display="inline"><semantics id="S3.SS1.p5.1.m1.1a"><mn id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><cn type="integer" id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">200</annotation></semantics></math> mm in some cases, especially when the seed orientation is far from the target. However, we find that even in cases where the initial orientation is close to the target (the error is <math id="S3.SS1.p5.2.m2.1" class="ltx_Math" alttext="45^{\circ}" display="inline"><semantics id="S3.SS1.p5.2.m2.1a"><msup id="S3.SS1.p5.2.m2.1.1" xref="S3.SS1.p5.2.m2.1.1.cmml"><mn id="S3.SS1.p5.2.m2.1.1.2" xref="S3.SS1.p5.2.m2.1.1.2.cmml">45</mn><mo id="S3.SS1.p5.2.m2.1.1.3" xref="S3.SS1.p5.2.m2.1.1.3.cmml">∘</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.2.m2.1b"><apply id="S3.SS1.p5.2.m2.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.2.m2.1.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1">superscript</csymbol><cn type="integer" id="S3.SS1.p5.2.m2.1.1.2.cmml" xref="S3.SS1.p5.2.m2.1.1.2">45</cn><compose id="S3.SS1.p5.2.m2.1.1.3.cmml" xref="S3.SS1.p5.2.m2.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.2.m2.1c">45^{\circ}</annotation></semantics></math>), the positional errors obtained are as large as the miss-match in initialization.</p>
</div>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Accuracy results for the iterative method after 50 Iterations. For comparison, we include results obtained via MLP tracking on the same evaluation data.</figcaption>
<table id="S3.T2.10" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T2.10.10" class="ltx_tr">
<th id="S3.T2.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t">
<span id="S3.T2.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.1.1.1.1" class="ltx_p" style="width:25.6pt;">Initial <math id="S3.T2.1.1.1.1.1.m1.1" class="ltx_align_right" alttext="e_{p}" display="inline"><semantics id="S3.T2.1.1.1.1.1.m1.1a"><msub id="S3.T2.1.1.1.1.1.m1.1.1" xref="S3.T2.1.1.1.1.1.m1.1.1.cmml"><mi id="S3.T2.1.1.1.1.1.m1.1.1.2" xref="S3.T2.1.1.1.1.1.m1.1.1.2.cmml">e</mi><mi id="S3.T2.1.1.1.1.1.m1.1.1.3" xref="S3.T2.1.1.1.1.1.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T2.1.1.1.1.1.m1.1b"><apply id="S3.T2.1.1.1.1.1.m1.1.1.cmml" xref="S3.T2.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.1.1.1.1.1.m1.1.1.1.cmml" xref="S3.T2.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T2.1.1.1.1.1.m1.1.1.2.cmml" xref="S3.T2.1.1.1.1.1.m1.1.1.2">𝑒</ci><ci id="S3.T2.1.1.1.1.1.m1.1.1.3.cmml" xref="S3.T2.1.1.1.1.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.1.1.1.1.1.m1.1c">e_{p}</annotation></semantics></math> in mm</span>
</span>
</th>
<th id="S3.T2.2.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_r ltx_border_t">
<span id="S3.T2.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.2.2.2.1.1" class="ltx_p" style="width:25.6pt;">Initial <math id="S3.T2.2.2.2.1.1.m1.1" class="ltx_align_right" alttext="e_{\theta}" display="inline"><semantics id="S3.T2.2.2.2.1.1.m1.1a"><msub id="S3.T2.2.2.2.1.1.m1.1.1" xref="S3.T2.2.2.2.1.1.m1.1.1.cmml"><mi id="S3.T2.2.2.2.1.1.m1.1.1.2" xref="S3.T2.2.2.2.1.1.m1.1.1.2.cmml">e</mi><mi id="S3.T2.2.2.2.1.1.m1.1.1.3" xref="S3.T2.2.2.2.1.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T2.2.2.2.1.1.m1.1b"><apply id="S3.T2.2.2.2.1.1.m1.1.1.cmml" xref="S3.T2.2.2.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.2.2.2.1.1.m1.1.1.1.cmml" xref="S3.T2.2.2.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.T2.2.2.2.1.1.m1.1.1.2.cmml" xref="S3.T2.2.2.2.1.1.m1.1.1.2">𝑒</ci><ci id="S3.T2.2.2.2.1.1.m1.1.1.3.cmml" xref="S3.T2.2.2.2.1.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.2.2.2.1.1.m1.1c">e_{\theta}</annotation></semantics></math> in degrees</span>
</span>
</th>
<td id="S3.T2.4.4.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S3.T2.4.4.4.2" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.4.4.4.2.2" class="ltx_p" style="width:25.6pt;"><math id="S3.T2.3.3.3.1.1.m1.1" class="ltx_Math" alttext="\ \mathtt{median}" display="inline"><semantics id="S3.T2.3.3.3.1.1.m1.1a"><mi id="S3.T2.3.3.3.1.1.m1.1.1" xref="S3.T2.3.3.3.1.1.m1.1.1.cmml">𝚖𝚎𝚍𝚒𝚊𝚗</mi><annotation-xml encoding="MathML-Content" id="S3.T2.3.3.3.1.1.m1.1b"><ci id="S3.T2.3.3.3.1.1.m1.1.1.cmml" xref="S3.T2.3.3.3.1.1.m1.1.1">𝚖𝚎𝚍𝚒𝚊𝚗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.3.3.3.1.1.m1.1c">\ \mathtt{median}</annotation></semantics></math> <math id="S3.T2.4.4.4.2.2.m2.1" class="ltx_align_right" alttext="e_{p}" display="inline"><semantics id="S3.T2.4.4.4.2.2.m2.1a"><msub id="S3.T2.4.4.4.2.2.m2.1.1" xref="S3.T2.4.4.4.2.2.m2.1.1.cmml"><mi id="S3.T2.4.4.4.2.2.m2.1.1.2" xref="S3.T2.4.4.4.2.2.m2.1.1.2.cmml">e</mi><mi id="S3.T2.4.4.4.2.2.m2.1.1.3" xref="S3.T2.4.4.4.2.2.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T2.4.4.4.2.2.m2.1b"><apply id="S3.T2.4.4.4.2.2.m2.1.1.cmml" xref="S3.T2.4.4.4.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.T2.4.4.4.2.2.m2.1.1.1.cmml" xref="S3.T2.4.4.4.2.2.m2.1.1">subscript</csymbol><ci id="S3.T2.4.4.4.2.2.m2.1.1.2.cmml" xref="S3.T2.4.4.4.2.2.m2.1.1.2">𝑒</ci><ci id="S3.T2.4.4.4.2.2.m2.1.1.3.cmml" xref="S3.T2.4.4.4.2.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.4.4.4.2.2.m2.1c">e_{p}</annotation></semantics></math> in mm</span>
</span>
</td>
<td id="S3.T2.6.6.6" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S3.T2.6.6.6.2" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.6.6.6.2.2" class="ltx_p" style="width:25.6pt;"><math id="S3.T2.5.5.5.1.1.m1.1" class="ltx_Math" alttext="\mathtt{median}" display="inline"><semantics id="S3.T2.5.5.5.1.1.m1.1a"><mi id="S3.T2.5.5.5.1.1.m1.1.1" xref="S3.T2.5.5.5.1.1.m1.1.1.cmml">𝚖𝚎𝚍𝚒𝚊𝚗</mi><annotation-xml encoding="MathML-Content" id="S3.T2.5.5.5.1.1.m1.1b"><ci id="S3.T2.5.5.5.1.1.m1.1.1.cmml" xref="S3.T2.5.5.5.1.1.m1.1.1">𝚖𝚎𝚍𝚒𝚊𝚗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.5.5.5.1.1.m1.1c">\mathtt{median}</annotation></semantics></math> <math id="S3.T2.6.6.6.2.2.m2.1" class="ltx_align_right" alttext="e_{\theta}" display="inline"><semantics id="S3.T2.6.6.6.2.2.m2.1a"><msub id="S3.T2.6.6.6.2.2.m2.1.1" xref="S3.T2.6.6.6.2.2.m2.1.1.cmml"><mi id="S3.T2.6.6.6.2.2.m2.1.1.2" xref="S3.T2.6.6.6.2.2.m2.1.1.2.cmml">e</mi><mi id="S3.T2.6.6.6.2.2.m2.1.1.3" xref="S3.T2.6.6.6.2.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T2.6.6.6.2.2.m2.1b"><apply id="S3.T2.6.6.6.2.2.m2.1.1.cmml" xref="S3.T2.6.6.6.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.T2.6.6.6.2.2.m2.1.1.1.cmml" xref="S3.T2.6.6.6.2.2.m2.1.1">subscript</csymbol><ci id="S3.T2.6.6.6.2.2.m2.1.1.2.cmml" xref="S3.T2.6.6.6.2.2.m2.1.1.2">𝑒</ci><ci id="S3.T2.6.6.6.2.2.m2.1.1.3.cmml" xref="S3.T2.6.6.6.2.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.6.6.6.2.2.m2.1c">e_{\theta}</annotation></semantics></math> in degrees</span>
</span>
</td>
<td id="S3.T2.8.8.8" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S3.T2.8.8.8.2" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.8.8.8.2.2" class="ltx_p" style="width:37.0pt;"><math id="S3.T2.7.7.7.1.1.m1.1" class="ltx_Math" alttext="\mathtt{3^{rd}quartile}" display="inline"><semantics id="S3.T2.7.7.7.1.1.m1.1a"><mrow id="S3.T2.7.7.7.1.1.m1.1.1" xref="S3.T2.7.7.7.1.1.m1.1.1.cmml"><msup id="S3.T2.7.7.7.1.1.m1.1.1.2" xref="S3.T2.7.7.7.1.1.m1.1.1.2.cmml"><mn id="S3.T2.7.7.7.1.1.m1.1.1.2.2" xref="S3.T2.7.7.7.1.1.m1.1.1.2.2.cmml">𝟹</mn><mi id="S3.T2.7.7.7.1.1.m1.1.1.2.3" xref="S3.T2.7.7.7.1.1.m1.1.1.2.3.cmml">𝚛𝚍</mi></msup><mo lspace="0em" rspace="0em" id="S3.T2.7.7.7.1.1.m1.1.1.1" xref="S3.T2.7.7.7.1.1.m1.1.1.1.cmml">​</mo><mi id="S3.T2.7.7.7.1.1.m1.1.1.3" xref="S3.T2.7.7.7.1.1.m1.1.1.3.cmml">𝚚𝚞𝚊𝚛𝚝𝚒𝚕𝚎</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.7.7.7.1.1.m1.1b"><apply id="S3.T2.7.7.7.1.1.m1.1.1.cmml" xref="S3.T2.7.7.7.1.1.m1.1.1"><times id="S3.T2.7.7.7.1.1.m1.1.1.1.cmml" xref="S3.T2.7.7.7.1.1.m1.1.1.1"></times><apply id="S3.T2.7.7.7.1.1.m1.1.1.2.cmml" xref="S3.T2.7.7.7.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.T2.7.7.7.1.1.m1.1.1.2.1.cmml" xref="S3.T2.7.7.7.1.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="S3.T2.7.7.7.1.1.m1.1.1.2.2.cmml" xref="S3.T2.7.7.7.1.1.m1.1.1.2.2">3</cn><ci id="S3.T2.7.7.7.1.1.m1.1.1.2.3.cmml" xref="S3.T2.7.7.7.1.1.m1.1.1.2.3">𝚛𝚍</ci></apply><ci id="S3.T2.7.7.7.1.1.m1.1.1.3.cmml" xref="S3.T2.7.7.7.1.1.m1.1.1.3">𝚚𝚞𝚊𝚛𝚝𝚒𝚕𝚎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.7.7.7.1.1.m1.1c">\mathtt{3^{rd}quartile}</annotation></semantics></math> <math id="S3.T2.8.8.8.2.2.m2.1" class="ltx_align_right" alttext="e_{p}" display="inline"><semantics id="S3.T2.8.8.8.2.2.m2.1a"><msub id="S3.T2.8.8.8.2.2.m2.1.1" xref="S3.T2.8.8.8.2.2.m2.1.1.cmml"><mi id="S3.T2.8.8.8.2.2.m2.1.1.2" xref="S3.T2.8.8.8.2.2.m2.1.1.2.cmml">e</mi><mi id="S3.T2.8.8.8.2.2.m2.1.1.3" xref="S3.T2.8.8.8.2.2.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T2.8.8.8.2.2.m2.1b"><apply id="S3.T2.8.8.8.2.2.m2.1.1.cmml" xref="S3.T2.8.8.8.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.T2.8.8.8.2.2.m2.1.1.1.cmml" xref="S3.T2.8.8.8.2.2.m2.1.1">subscript</csymbol><ci id="S3.T2.8.8.8.2.2.m2.1.1.2.cmml" xref="S3.T2.8.8.8.2.2.m2.1.1.2">𝑒</ci><ci id="S3.T2.8.8.8.2.2.m2.1.1.3.cmml" xref="S3.T2.8.8.8.2.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.8.8.8.2.2.m2.1c">e_{p}</annotation></semantics></math> in mm</span>
</span>
</td>
<td id="S3.T2.10.10.10" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S3.T2.10.10.10.2" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.10.10.2.2" class="ltx_p" style="width:37.0pt;"><math id="S3.T2.9.9.9.1.1.m1.1" class="ltx_Math" alttext="\mathtt{3^{rd}quartile}" display="inline"><semantics id="S3.T2.9.9.9.1.1.m1.1a"><mrow id="S3.T2.9.9.9.1.1.m1.1.1" xref="S3.T2.9.9.9.1.1.m1.1.1.cmml"><msup id="S3.T2.9.9.9.1.1.m1.1.1.2" xref="S3.T2.9.9.9.1.1.m1.1.1.2.cmml"><mn id="S3.T2.9.9.9.1.1.m1.1.1.2.2" xref="S3.T2.9.9.9.1.1.m1.1.1.2.2.cmml">𝟹</mn><mi id="S3.T2.9.9.9.1.1.m1.1.1.2.3" xref="S3.T2.9.9.9.1.1.m1.1.1.2.3.cmml">𝚛𝚍</mi></msup><mo lspace="0em" rspace="0em" id="S3.T2.9.9.9.1.1.m1.1.1.1" xref="S3.T2.9.9.9.1.1.m1.1.1.1.cmml">​</mo><mi id="S3.T2.9.9.9.1.1.m1.1.1.3" xref="S3.T2.9.9.9.1.1.m1.1.1.3.cmml">𝚚𝚞𝚊𝚛𝚝𝚒𝚕𝚎</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.9.9.9.1.1.m1.1b"><apply id="S3.T2.9.9.9.1.1.m1.1.1.cmml" xref="S3.T2.9.9.9.1.1.m1.1.1"><times id="S3.T2.9.9.9.1.1.m1.1.1.1.cmml" xref="S3.T2.9.9.9.1.1.m1.1.1.1"></times><apply id="S3.T2.9.9.9.1.1.m1.1.1.2.cmml" xref="S3.T2.9.9.9.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.T2.9.9.9.1.1.m1.1.1.2.1.cmml" xref="S3.T2.9.9.9.1.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="S3.T2.9.9.9.1.1.m1.1.1.2.2.cmml" xref="S3.T2.9.9.9.1.1.m1.1.1.2.2">3</cn><ci id="S3.T2.9.9.9.1.1.m1.1.1.2.3.cmml" xref="S3.T2.9.9.9.1.1.m1.1.1.2.3">𝚛𝚍</ci></apply><ci id="S3.T2.9.9.9.1.1.m1.1.1.3.cmml" xref="S3.T2.9.9.9.1.1.m1.1.1.3">𝚚𝚞𝚊𝚛𝚝𝚒𝚕𝚎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.9.9.9.1.1.m1.1c">\mathtt{3^{rd}quartile}</annotation></semantics></math> <math id="S3.T2.10.10.10.2.2.m2.1" class="ltx_align_right" alttext="e_{\theta}" display="inline"><semantics id="S3.T2.10.10.10.2.2.m2.1a"><msub id="S3.T2.10.10.10.2.2.m2.1.1" xref="S3.T2.10.10.10.2.2.m2.1.1.cmml"><mi id="S3.T2.10.10.10.2.2.m2.1.1.2" xref="S3.T2.10.10.10.2.2.m2.1.1.2.cmml">e</mi><mi id="S3.T2.10.10.10.2.2.m2.1.1.3" xref="S3.T2.10.10.10.2.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T2.10.10.10.2.2.m2.1b"><apply id="S3.T2.10.10.10.2.2.m2.1.1.cmml" xref="S3.T2.10.10.10.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.T2.10.10.10.2.2.m2.1.1.1.cmml" xref="S3.T2.10.10.10.2.2.m2.1.1">subscript</csymbol><ci id="S3.T2.10.10.10.2.2.m2.1.1.2.cmml" xref="S3.T2.10.10.10.2.2.m2.1.1.2">𝑒</ci><ci id="S3.T2.10.10.10.2.2.m2.1.1.3.cmml" xref="S3.T2.10.10.10.2.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.10.10.10.2.2.m2.1c">e_{\theta}</annotation></semantics></math> in degrees</span>
</span>
</td>
</tr>
<tr id="S3.T2.10.11.1" class="ltx_tr">
<th id="S3.T2.10.11.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t" colspan="2"><span id="S3.T2.10.11.1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Iter. Optimization</span></th>
<td id="S3.T2.10.11.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"></td>
<td id="S3.T2.10.11.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"></td>
<td id="S3.T2.10.11.1.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"></td>
<td id="S3.T2.10.11.1.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"></td>
</tr>
<tr id="S3.T2.10.12.2" class="ltx_tr">
<th id="S3.T2.10.12.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_tt">
<span id="S3.T2.10.12.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.12.2.1.1.1" class="ltx_p" style="width:25.6pt;">80</span>
</span>
</th>
<th id="S3.T2.10.12.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_r ltx_border_tt">
<span id="S3.T2.10.12.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.12.2.2.1.1" class="ltx_p" style="width:25.6pt;">10</span>
</span>
</th>
<td id="S3.T2.10.12.2.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt">
<span id="S3.T2.10.12.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.12.2.3.1.1" class="ltx_p" style="width:25.6pt;">0.92</span>
</span>
</td>
<td id="S3.T2.10.12.2.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt">
<span id="S3.T2.10.12.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.12.2.4.1.1" class="ltx_p" style="width:25.6pt;">1.63</span>
</span>
</td>
<td id="S3.T2.10.12.2.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt">
<span id="S3.T2.10.12.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.12.2.5.1.1" class="ltx_p" style="width:37.0pt;">32.96</span>
</span>
</td>
<td id="S3.T2.10.12.2.6" class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt">
<span id="S3.T2.10.12.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.12.2.6.1.1" class="ltx_p" style="width:37.0pt;">9.98</span>
</span>
</td>
</tr>
<tr id="S3.T2.10.13.3" class="ltx_tr">
<th id="S3.T2.10.13.3.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="S3.T2.10.13.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.13.3.1.1.1" class="ltx_p" style="width:25.6pt;">80</span>
</span>
</th>
<th id="S3.T2.10.13.3.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_r">
<span id="S3.T2.10.13.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.13.3.2.1.1" class="ltx_p" style="width:25.6pt;">30</span>
</span>
</th>
<td id="S3.T2.10.13.3.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.13.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.13.3.3.1.1" class="ltx_p" style="width:25.6pt;">4.17</span>
</span>
</td>
<td id="S3.T2.10.13.3.4" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.13.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.13.3.4.1.1" class="ltx_p" style="width:25.6pt;">8.54</span>
</span>
</td>
<td id="S3.T2.10.13.3.5" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.13.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.13.3.5.1.1" class="ltx_p" style="width:37.0pt;">47.17</span>
</span>
</td>
<td id="S3.T2.10.13.3.6" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.13.3.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.13.3.6.1.1" class="ltx_p" style="width:37.0pt;">29.99</span>
</span>
</td>
</tr>
<tr id="S3.T2.10.14.4" class="ltx_tr">
<th id="S3.T2.10.14.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="S3.T2.10.14.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.14.4.1.1.1" class="ltx_p" style="width:25.6pt;">80</span>
</span>
</th>
<th id="S3.T2.10.14.4.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_r">
<span id="S3.T2.10.14.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.14.4.2.1.1" class="ltx_p" style="width:25.6pt;">90</span>
</span>
</th>
<td id="S3.T2.10.14.4.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.14.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.14.4.3.1.1" class="ltx_p" style="width:25.6pt;">40.83</span>
</span>
</td>
<td id="S3.T2.10.14.4.4" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.14.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.14.4.4.1.1" class="ltx_p" style="width:25.6pt;">87.16</span>
</span>
</td>
<td id="S3.T2.10.14.4.5" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.14.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.14.4.5.1.1" class="ltx_p" style="width:37.0pt;">83.80</span>
</span>
</td>
<td id="S3.T2.10.14.4.6" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.14.4.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.14.4.6.1.1" class="ltx_p" style="width:37.0pt;">90.00</span>
</span>
</td>
</tr>
<tr id="S3.T2.10.15.5" class="ltx_tr">
<th id="S3.T2.10.15.5.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="S3.T2.10.15.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.15.5.1.1.1" class="ltx_p" style="width:25.6pt;">80</span>
</span>
</th>
<th id="S3.T2.10.15.5.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_r">
<span id="S3.T2.10.15.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.15.5.2.1.1" class="ltx_p" style="width:25.6pt;">180</span>
</span>
</th>
<td id="S3.T2.10.15.5.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.15.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.15.5.3.1.1" class="ltx_p" style="width:25.6pt;">90.88</span>
</span>
</td>
<td id="S3.T2.10.15.5.4" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.15.5.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.15.5.4.1.1" class="ltx_p" style="width:25.6pt;">179.90</span>
</span>
</td>
<td id="S3.T2.10.15.5.5" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.15.5.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.15.5.5.1.1" class="ltx_p" style="width:37.0pt;">158.11</span>
</span>
</td>
<td id="S3.T2.10.15.5.6" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.15.5.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.15.5.6.1.1" class="ltx_p" style="width:37.0pt;">179.99</span>
</span>
</td>
</tr>
<tr id="S3.T2.10.16.6" class="ltx_tr">
<th id="S3.T2.10.16.6.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t">
<span id="S3.T2.10.16.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.16.6.1.1.1" class="ltx_p" style="width:25.6pt;">30</span>
</span>
</th>
<th id="S3.T2.10.16.6.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_r ltx_border_t">
<span id="S3.T2.10.16.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.16.6.2.1.1" class="ltx_p" style="width:25.6pt;">45</span>
</span>
</th>
<td id="S3.T2.10.16.6.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S3.T2.10.16.6.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.16.6.3.1.1" class="ltx_p" style="width:25.6pt;">0.42</span>
</span>
</td>
<td id="S3.T2.10.16.6.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S3.T2.10.16.6.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.16.6.4.1.1" class="ltx_p" style="width:25.6pt;">0.74</span>
</span>
</td>
<td id="S3.T2.10.16.6.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S3.T2.10.16.6.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.16.6.5.1.1" class="ltx_p" style="width:37.0pt;">12.86</span>
</span>
</td>
<td id="S3.T2.10.16.6.6" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S3.T2.10.16.6.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.16.6.6.1.1" class="ltx_p" style="width:37.0pt;">36.12</span>
</span>
</td>
</tr>
<tr id="S3.T2.10.17.7" class="ltx_tr">
<th id="S3.T2.10.17.7.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="S3.T2.10.17.7.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.17.7.1.1.1" class="ltx_p" style="width:25.6pt;">60</span>
</span>
</th>
<th id="S3.T2.10.17.7.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_r">
<span id="S3.T2.10.17.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.17.7.2.1.1" class="ltx_p" style="width:25.6pt;">45</span>
</span>
</th>
<td id="S3.T2.10.17.7.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.17.7.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.17.7.3.1.1" class="ltx_p" style="width:25.6pt;">3.19</span>
</span>
</td>
<td id="S3.T2.10.17.7.4" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.17.7.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.17.7.4.1.1" class="ltx_p" style="width:25.6pt;">6.89</span>
</span>
</td>
<td id="S3.T2.10.17.7.5" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.17.7.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.17.7.5.1.1" class="ltx_p" style="width:37.0pt;">33.47</span>
</span>
</td>
<td id="S3.T2.10.17.7.6" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.17.7.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.17.7.6.1.1" class="ltx_p" style="width:37.0pt;">44.84</span>
</span>
</td>
</tr>
<tr id="S3.T2.10.18.8" class="ltx_tr">
<th id="S3.T2.10.18.8.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="S3.T2.10.18.8.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.18.8.1.1.1" class="ltx_p" style="width:25.6pt;">90</span>
</span>
</th>
<th id="S3.T2.10.18.8.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_r">
<span id="S3.T2.10.18.8.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.18.8.2.1.1" class="ltx_p" style="width:25.6pt;">45</span>
</span>
</th>
<td id="S3.T2.10.18.8.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.18.8.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.18.8.3.1.1" class="ltx_p" style="width:25.6pt;">6.62</span>
</span>
</td>
<td id="S3.T2.10.18.8.4" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.18.8.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.18.8.4.1.1" class="ltx_p" style="width:25.6pt;">15.17</span>
</span>
</td>
<td id="S3.T2.10.18.8.5" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.18.8.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.18.8.5.1.1" class="ltx_p" style="width:37.0pt;">41.29</span>
</span>
</td>
<td id="S3.T2.10.18.8.6" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.18.8.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.18.8.6.1.1" class="ltx_p" style="width:37.0pt;">44.91</span>
</span>
</td>
</tr>
<tr id="S3.T2.10.19.9" class="ltx_tr">
<th id="S3.T2.10.19.9.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="S3.T2.10.19.9.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.19.9.1.1.1" class="ltx_p" style="width:25.6pt;">120</span>
</span>
</th>
<th id="S3.T2.10.19.9.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_r">
<span id="S3.T2.10.19.9.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.19.9.2.1.1" class="ltx_p" style="width:25.6pt;">45</span>
</span>
</th>
<td id="S3.T2.10.19.9.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.19.9.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.19.9.3.1.1" class="ltx_p" style="width:25.6pt;">10.47</span>
</span>
</td>
<td id="S3.T2.10.19.9.4" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.19.9.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.19.9.4.1.1" class="ltx_p" style="width:25.6pt;">28.94</span>
</span>
</td>
<td id="S3.T2.10.19.9.5" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.19.9.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.19.9.5.1.1" class="ltx_p" style="width:37.0pt;">59.43</span>
</span>
</td>
<td id="S3.T2.10.19.9.6" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T2.10.19.9.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.19.9.6.1.1" class="ltx_p" style="width:37.0pt;">45.01</span>
</span>
</td>
</tr>
<tr id="S3.T2.10.20.10" class="ltx_tr">
<th id="S3.T2.10.20.10.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t" colspan="2"><span id="S3.T2.10.20.10.1.1" class="ltx_text ltx_font_bold ltx_font_italic">MLP (ours)</span></th>
<td id="S3.T2.10.20.10.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"></td>
<td id="S3.T2.10.20.10.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"></td>
<td id="S3.T2.10.20.10.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"></td>
<td id="S3.T2.10.20.10.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"></td>
</tr>
<tr id="S3.T2.10.21.11" class="ltx_tr">
<th id="S3.T2.10.21.11.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_b ltx_border_tt">
<span id="S3.T2.10.21.11.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.21.11.1.1.1" class="ltx_p" style="width:25.6pt;">–</span>
</span>
</th>
<th id="S3.T2.10.21.11.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_tt">
<span id="S3.T2.10.21.11.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.21.11.2.1.1" class="ltx_p" style="width:25.6pt;">–</span>
</span>
</th>
<td id="S3.T2.10.21.11.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_tt">
<span id="S3.T2.10.21.11.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.21.11.3.1.1" class="ltx_p" style="width:25.6pt;">1.34</span>
</span>
</td>
<td id="S3.T2.10.21.11.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_tt">
<span id="S3.T2.10.21.11.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.21.11.4.1.1" class="ltx_p" style="width:25.6pt;">3.45</span>
</span>
</td>
<td id="S3.T2.10.21.11.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_tt">
<span id="S3.T2.10.21.11.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.21.11.5.1.1" class="ltx_p" style="width:37.0pt;">1.91</span>
</span>
</td>
<td id="S3.T2.10.21.11.6" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_tt">
<span id="S3.T2.10.21.11.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.10.21.11.6.1.1" class="ltx_p" style="width:37.0pt;">5.16</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Running Time</h3>

<figure id="S3.F4" class="ltx_figure"><img src="/html/2211.07556/assets/x4.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="392" height="257" alt="Refer to caption">
<br class="ltx_break ltx_centering">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Inference time comparison between MLP and L-BFGS implementations for a different number of iterations. Iterative methods are strongly dependent on initialization and it takes between 20 and 50 iterations (i.e. <math id="S3.F4.2.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S3.F4.2.m1.1b"><mo id="S3.F4.2.m1.1.1" xref="S3.F4.2.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.F4.2.m1.1c"><gt id="S3.F4.2.m1.1.1.cmml" xref="S3.F4.2.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.2.m1.1d">&gt;</annotation></semantics></math> 10 ms) to achieve results similar to those given by a single MLP inference (0.8 ms).
</figcaption>
</figure>
<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.1" class="ltx_p">Our MLP implementation produces readings after a single inference step involving feature engineering, additions, and multiplications in hidden layers. In contrast, optimization-based methods require computations of second-order gradients concerning the estimated locations of every iteration until it converges. We compare here the differences in speed in our two tested methods.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.4" class="ltx_p">In Figure <a href="#S3.F4" title="Figure 4 ‣ 3.2 Running Time ‣ 3 Comparison between our data-driven and an optimization-based tracking ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> we compare the end-to-end time of our data-driven method (MLP) vs different maxmimum number of iterations steps of the optimization-based algorithm we implemented.
One 5 DoF tracking inference in MLP takes <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="0.8" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mn id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">0.8</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><cn type="float" id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">0.8</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">0.8</annotation></semantics></math> ms, including the feature engineering process. In contrast, the L-BFGS optimizer takes around <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mn id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><cn type="integer" id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">1</annotation></semantics></math> ms for each iteration. As shown in Figure <a href="#S3.F3" title="Figure 3 ‣ 3.1 Influence of initialization on the optimization methods ‣ 3 Comparison between our data-driven and an optimization-based tracking ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we need <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mn id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><cn type="integer" id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">10</annotation></semantics></math>s of iterations to achieve satisfying results depending on the initialization. This results in <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mn id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><cn type="integer" id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">10</annotation></semantics></math>s of milliseconds. We note that for this particular speed comparison, we run both methods on the same laptop with an Intel i7-7500U CPU.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Neural Networks trained with FEM vs Dipole Model</h3>

<div id="S3.SS3.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.p1.2" class="ltx_p">In previous works authors train MLPs on data generated with the magnetic dipole model. In this work, we propose a step forward by modeling beyond the dipole approximation and take full advantage of the powerful representation of Neural Networks for non-linear systems.
We propose six different shapes of magnets for our evaluation, identical to those we adopt in hands-on experiments in Section <a href="#S4" title="4 Experimental Evaluation ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.
The selection goes from very tall bars to very flat disks, all magnetized in the principal axis, plus a sphere, given that the dipole model is the exact solution in this last case.
We use <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="1000" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mn id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><cn type="integer" id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">1000</annotation></semantics></math> points per magnet to evaluate the position error, and the target positions and orientations are identical for all <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="6" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mn id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><cn type="integer" id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">6</annotation></semantics></math> magnets.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.p2.1" class="ltx_p">In Figure <a href="#S3.F5" title="Figure 5 ‣ 3.3 Neural Networks trained with FEM vs Dipole Model ‣ 3 Comparison between our data-driven and an optimization-based tracking ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> we compare the performance of our MLP method when trained with two different synthetic datasets: one obtained FEM simulations as explain in Section <a href="#S2.SS1" title="2.1 Synthetic Dataset ‣ 2 Method ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.1</span></a>, and the other using the magnetic dipole approximation (Eq. <a href="#S2.E2" title="In 2.2.2 Pre-processing ‣ 2.2 Tracking with Neural Networks ‣ 2 Method ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).
The shapes of magnets are ordered from tall bar-shape to thin disc-shaped, getting closer to a spherical shape and then deviating from it.
We used a Shapiro-Wilk test to validate the normal distribution of our data and then applied a Student’s T-Test to test for significant differences between dipole- and FEM-data trained MLPs.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS3.p3.2" class="ltx_p">We found significant differences in all cases of cylindrical magnets and no significant difference for the spherical magnet.
The p-values of the Student’s T-Tests are <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="&lt;.005" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mrow id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml"></mi><mo id="S3.SS3.p3.1.m1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.cmml">&lt;</mo><mn id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">.005</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><lt id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1"></lt><csymbol cd="latexml" id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">absent</csymbol><cn type="float" id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3">.005</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">&lt;.005</annotation></semantics></math> with the exception of the spherical case (<math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="p=0.95" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><mrow id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">p</mi><mo id="S3.SS3.p3.2.m2.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><eq id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1"></eq><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">𝑝</ci><cn type="float" id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">p=0.95</annotation></semantics></math>). As expected, we observed greater differences in the results as the shape of the magnet distances itself from the sphere.</p>
</div>
<figure id="S3.F5" class="ltx_figure"><img src="/html/2211.07556/assets/x5.png" id="S3.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="370" height="283" alt="Refer to caption">
<br class="ltx_break ltx_centering">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Comparison of positional errors on MLP neural networks when trained with FEM- or dipole model-generated datasets.
</figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experimental Evaluation</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p">In this evaluation, we compare the results of our MLP tracking method to experimental ground truth data collected with Optitrack. Apart from evaluating accuracy in position and orientation, we present the speed performance in this portable computer considering both the data-collection process and the inference process running simultaneously on the same device.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Magnetic plus Optical Tracking Setup</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p">The magnetic tracking hardware consists of 16 magnetic sensors distributed in a 4 x 4 array and a Jetson Nano portable computer to read the sensors and perform MLP inferences. For details see Section <a href="#S2.SS3" title="2.3 Hardware Implementation ‣ 2 Method ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.3</span></a>.
The permanent magnet is attached to a tree-shaped 3D-printed holder, which holds five IR reflective markers on its branches to collect the ground-truth data (as in the inset of Figure <a href="#S2.F2" title="Figure 2 ‣ 2.3 Hardware Implementation ‣ 2 Method ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). We use ten OptiTrack cameras to track this rigid body, and the cylindrical magnets used here are the same as the simulated in Section <a href="#S3.SS3" title="3.3 Neural Networks trained with FEM vs Dipole Model ‣ 3 Comparison between our data-driven and an optimization-based tracking ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.1" class="ltx_p">During the experiment, the magnet is moved and tilted freely in the space over the sensor array while ensuring that the cameras capture most of the optical markers. The speed of moving is comparable to playing games with joysticks.
For those cases where we compare different numbers of sensors, we log the readings from the sensors array which are then fed offline into MLPs with varying input dimensions.
We correct the time-sync mismatch between two tracking systems by adjusting a time-offset variable in the magnetic signals and by searching for the lowest tracking error during a calibration step. In addition, we use PCHIP interpolation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> to adjust difference in the sampling frequency.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Results</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.9" class="ltx_p">In Figure <a href="#S4.F6" title="Figure 6 ‣ 4.2 Results ‣ 4 Experimental Evaluation ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> we show a single trajectory tracked via our MLP method as well as optitrack clipped within the same time range.
For this particular trajectory we use the magnet with diameter <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mn id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><cn type="integer" id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">10</annotation></semantics></math>mm, height <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mn id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><cn type="integer" id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">20</annotation></semantics></math> mm (<math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="d\ 10\ h\ 20" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">​</mo><mn id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml"> 10</mn><mo lspace="0.500em" rspace="0em" id="S4.SS2.p1.3.m3.1.1.1a" xref="S4.SS2.p1.3.m3.1.1.1.cmml">​</mo><mi id="S4.SS2.p1.3.m3.1.1.4" xref="S4.SS2.p1.3.m3.1.1.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.1.1b" xref="S4.SS2.p1.3.m3.1.1.1.cmml">​</mo><mn id="S4.SS2.p1.3.m3.1.1.5" xref="S4.SS2.p1.3.m3.1.1.5.cmml"> 20</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><times id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1"></times><ci id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">𝑑</ci><cn type="integer" id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3">10</cn><ci id="S4.SS2.p1.3.m3.1.1.4.cmml" xref="S4.SS2.p1.3.m3.1.1.4">ℎ</ci><cn type="integer" id="S4.SS2.p1.3.m3.1.1.5.cmml" xref="S4.SS2.p1.3.m3.1.1.5">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">d\ 10\ h\ 20</annotation></semantics></math>).
The deviation between the two trajectories is within the <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="4" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mn id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><cn type="integer" id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">4</annotation></semantics></math> mm limit more than half of the time, with the largest deviation happening in fast turns and never exceeding <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mn id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><cn type="integer" id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">10</annotation></semantics></math> mm.
We note that the discontinuities in the OptiTrack trajectories come from partial occlusion of the IR markers.
In figure <a href="#S4.F7" title="Figure 7 ‣ 4.2 Results ‣ 4 Experimental Evaluation ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, we show the statistics of tracking results obtained from five different cylindrical magnets. As expected, the higher the number of sensors deployed, the lower the tracking errors for all the magnets tested. When we use the full set of <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="16" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><mn id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><cn type="integer" id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">16</annotation></semantics></math> sensors, the average tracking errors in position and orientation are generally smaller than <math id="S4.SS2.p1.7.m7.1" class="ltx_Math" alttext="4" display="inline"><semantics id="S4.SS2.p1.7.m7.1a"><mn id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><cn type="integer" id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">4</annotation></semantics></math> mm and <math id="S4.SS2.p1.8.m8.1" class="ltx_Math" alttext="8^{\circ}" display="inline"><semantics id="S4.SS2.p1.8.m8.1a"><msup id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml"><mn id="S4.SS2.p1.8.m8.1.1.2" xref="S4.SS2.p1.8.m8.1.1.2.cmml">8</mn><mo id="S4.SS2.p1.8.m8.1.1.3" xref="S4.SS2.p1.8.m8.1.1.3.cmml">∘</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><apply id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.8.m8.1.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1">superscript</csymbol><cn type="integer" id="S4.SS2.p1.8.m8.1.1.2.cmml" xref="S4.SS2.p1.8.m8.1.1.2">8</cn><compose id="S4.SS2.p1.8.m8.1.1.3.cmml" xref="S4.SS2.p1.8.m8.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">8^{\circ}</annotation></semantics></math>, except for the pole-shape magnet (<math id="S4.SS2.p1.9.m9.1" class="ltx_Math" alttext="d\ 5\ h\ 25" display="inline"><semantics id="S4.SS2.p1.9.m9.1a"><mrow id="S4.SS2.p1.9.m9.1.1" xref="S4.SS2.p1.9.m9.1.1.cmml"><mi id="S4.SS2.p1.9.m9.1.1.2" xref="S4.SS2.p1.9.m9.1.1.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.9.m9.1.1.1" xref="S4.SS2.p1.9.m9.1.1.1.cmml">​</mo><mn id="S4.SS2.p1.9.m9.1.1.3" xref="S4.SS2.p1.9.m9.1.1.3.cmml"> 5</mn><mo lspace="0.500em" rspace="0em" id="S4.SS2.p1.9.m9.1.1.1a" xref="S4.SS2.p1.9.m9.1.1.1.cmml">​</mo><mi id="S4.SS2.p1.9.m9.1.1.4" xref="S4.SS2.p1.9.m9.1.1.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.9.m9.1.1.1b" xref="S4.SS2.p1.9.m9.1.1.1.cmml">​</mo><mn id="S4.SS2.p1.9.m9.1.1.5" xref="S4.SS2.p1.9.m9.1.1.5.cmml"> 25</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m9.1b"><apply id="S4.SS2.p1.9.m9.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1"><times id="S4.SS2.p1.9.m9.1.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1.1"></times><ci id="S4.SS2.p1.9.m9.1.1.2.cmml" xref="S4.SS2.p1.9.m9.1.1.2">𝑑</ci><cn type="integer" id="S4.SS2.p1.9.m9.1.1.3.cmml" xref="S4.SS2.p1.9.m9.1.1.3">5</cn><ci id="S4.SS2.p1.9.m9.1.1.4.cmml" xref="S4.SS2.p1.9.m9.1.1.4">ℎ</ci><cn type="integer" id="S4.SS2.p1.9.m9.1.1.5.cmml" xref="S4.SS2.p1.9.m9.1.1.5">25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m9.1c">d\ 5\ h\ 25</annotation></semantics></math>).</p>
</div>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2211.07556/assets/x6.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="263" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Comparison of trajectories obtained by OptiTrack and MLP. The difference is generally smaller than 4mm</figcaption>
</figure>
<figure id="S4.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F7.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2211.07556/assets/x7.png" id="S4.F7.sf1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="141" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F7.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2211.07556/assets/x8.png" id="S4.F7.sf2.g1" class="ltx_graphics ltx_img_square" width="461" height="475" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Experimental positional and orientation errors obtained with MLP tracking, for different numbers of input sensor and magnet shapes.
</figcaption>
</figure>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.4" class="ltx_p">Finally, we conduct experiments to test the interactive frequency of our method when the inference is done either on the CPU or the GPU of Jetson Nano.
Note that process of reading sensors is always running on the CPU via the I2C protocol, giving an average time of <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="1.75" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mn id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">1.75</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><cn type="float" id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">1.75</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">1.75</annotation></semantics></math> ms per sensor.
For the inference process, the duration of inference running on the CPU is around <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="28" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mn id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">28</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><cn type="integer" id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">28</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">28</annotation></semantics></math> ms and stays relatively steady as the dimension of input features increases.
When the inference runs on GPU, the duration for the prediction process increases from <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mn id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><cn type="integer" id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">10</annotation></semantics></math> ms when using 4 sensors to <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="15" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mn id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><cn type="integer" id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">15</annotation></semantics></math> ms when using the complete set of 16 sensors.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Discussion</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.3" class="ltx_p">In Section <a href="#S3.SS1" title="3.1 Influence of initialization on the optimization methods ‣ 3 Comparison between our data-driven and an optimization-based tracking ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a> we recovered a known shortcoming in iterative methods: tracking accuracy is highly dependent on the seed, particularly in the initial orientation of the magnet. The optimization tends to fall into a local minimum when the first orientation estimate is far from the actual value.
In contrast, Figure <a href="#S3.F3" title="Figure 3 ‣ 3.1 Influence of initialization on the optimization methods ‣ 3 Comparison between our data-driven and an optimization-based tracking ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows that with a relatively good first orientation (miss-match less than <math id="S5.p1.1.m1.1" class="ltx_Math" alttext="45^{\circ}" display="inline"><semantics id="S5.p1.1.m1.1a"><msup id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml"><mn id="S5.p1.1.m1.1.1.2" xref="S5.p1.1.m1.1.1.2.cmml">45</mn><mo id="S5.p1.1.m1.1.1.3" xref="S5.p1.1.m1.1.1.3.cmml">∘</mo></msup><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><apply id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p1.1.m1.1.1.1.cmml" xref="S5.p1.1.m1.1.1">superscript</csymbol><cn type="integer" id="S5.p1.1.m1.1.1.2.cmml" xref="S5.p1.1.m1.1.1.2">45</cn><compose id="S5.p1.1.m1.1.1.3.cmml" xref="S5.p1.1.m1.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">45^{\circ}</annotation></semantics></math>), the convergence is less sensitive to other perturbations.
In results after 50 iteration steps (Table <a href="#S3.T2" title="Table 2 ‣ 3.1 Influence of initialization on the optimization methods ‣ 3 Comparison between our data-driven and an optimization-based tracking ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), the <math id="S5.p1.2.m2.1" class="ltx_Math" alttext="3^{rd}" display="inline"><semantics id="S5.p1.2.m2.1a"><msup id="S5.p1.2.m2.1.1" xref="S5.p1.2.m2.1.1.cmml"><mn id="S5.p1.2.m2.1.1.2" xref="S5.p1.2.m2.1.1.2.cmml">3</mn><mrow id="S5.p1.2.m2.1.1.3" xref="S5.p1.2.m2.1.1.3.cmml"><mi id="S5.p1.2.m2.1.1.3.2" xref="S5.p1.2.m2.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.p1.2.m2.1.1.3.1" xref="S5.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S5.p1.2.m2.1.1.3.3" xref="S5.p1.2.m2.1.1.3.3.cmml">d</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.p1.2.m2.1b"><apply id="S5.p1.2.m2.1.1.cmml" xref="S5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.p1.2.m2.1.1.1.cmml" xref="S5.p1.2.m2.1.1">superscript</csymbol><cn type="integer" id="S5.p1.2.m2.1.1.2.cmml" xref="S5.p1.2.m2.1.1.2">3</cn><apply id="S5.p1.2.m2.1.1.3.cmml" xref="S5.p1.2.m2.1.1.3"><times id="S5.p1.2.m2.1.1.3.1.cmml" xref="S5.p1.2.m2.1.1.3.1"></times><ci id="S5.p1.2.m2.1.1.3.2.cmml" xref="S5.p1.2.m2.1.1.3.2">𝑟</ci><ci id="S5.p1.2.m2.1.1.3.3.cmml" xref="S5.p1.2.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.2.m2.1c">3^{rd}</annotation></semantics></math> quartile errors are as large as the initialization errors, showcasing that the optimization method might fail to reach the global minimum after <math id="S5.p1.3.m3.1" class="ltx_Math" alttext="50" display="inline"><semantics id="S5.p1.3.m3.1a"><mn id="S5.p1.3.m3.1.1" xref="S5.p1.3.m3.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="S5.p1.3.m3.1b"><cn type="integer" id="S5.p1.3.m3.1.1.cmml" xref="S5.p1.3.m3.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.3.m3.1c">50</annotation></semantics></math> epochs.</p>
</div>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.1" class="ltx_p">On the other hand, tracking via neural networks is initialization-independent. In Table <a href="#S3.T2" title="Table 2 ‣ 3.1 Influence of initialization on the optimization methods ‣ 3 Comparison between our data-driven and an optimization-based tracking ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> we see that MLP can outperform the optimization-based method, except for the cases with the most reliable initial estimation and the maximum number of iterations.
Moreover, the maximal positional and orientation errors are all bounded by acceptable limits when tracking via MLP, testifying to its stability.</p>
</div>
<div id="S5.p3" class="ltx_para ltx_noindent">
<p id="S5.p3.1" class="ltx_p">When deploying our method in an experimental prototype, tracking errors are only slightly increased due to noise in the actual sensors: see Figure <a href="#S3.F5" title="Figure 5 ‣ 3.3 Neural Networks trained with FEM vs Dipole Model ‣ 3 Comparison between our data-driven and an optimization-based tracking ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (training via FEM) and Figure <a href="#S4.F7" title="Figure 7 ‣ 4.2 Results ‣ 4 Experimental Evaluation ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> (for <math id="S5.p3.1.m1.1" class="ltx_Math" alttext="N_{sensors}=16" display="inline"><semantics id="S5.p3.1.m1.1a"><mrow id="S5.p3.1.m1.1.1" xref="S5.p3.1.m1.1.1.cmml"><msub id="S5.p3.1.m1.1.1.2" xref="S5.p3.1.m1.1.1.2.cmml"><mi id="S5.p3.1.m1.1.1.2.2" xref="S5.p3.1.m1.1.1.2.2.cmml">N</mi><mrow id="S5.p3.1.m1.1.1.2.3" xref="S5.p3.1.m1.1.1.2.3.cmml"><mi id="S5.p3.1.m1.1.1.2.3.2" xref="S5.p3.1.m1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S5.p3.1.m1.1.1.2.3.1" xref="S5.p3.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S5.p3.1.m1.1.1.2.3.3" xref="S5.p3.1.m1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.p3.1.m1.1.1.2.3.1a" xref="S5.p3.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S5.p3.1.m1.1.1.2.3.4" xref="S5.p3.1.m1.1.1.2.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S5.p3.1.m1.1.1.2.3.1b" xref="S5.p3.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S5.p3.1.m1.1.1.2.3.5" xref="S5.p3.1.m1.1.1.2.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S5.p3.1.m1.1.1.2.3.1c" xref="S5.p3.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S5.p3.1.m1.1.1.2.3.6" xref="S5.p3.1.m1.1.1.2.3.6.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.p3.1.m1.1.1.2.3.1d" xref="S5.p3.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S5.p3.1.m1.1.1.2.3.7" xref="S5.p3.1.m1.1.1.2.3.7.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.p3.1.m1.1.1.2.3.1e" xref="S5.p3.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S5.p3.1.m1.1.1.2.3.8" xref="S5.p3.1.m1.1.1.2.3.8.cmml">s</mi></mrow></msub><mo id="S5.p3.1.m1.1.1.1" xref="S5.p3.1.m1.1.1.1.cmml">=</mo><mn id="S5.p3.1.m1.1.1.3" xref="S5.p3.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.1.m1.1b"><apply id="S5.p3.1.m1.1.1.cmml" xref="S5.p3.1.m1.1.1"><eq id="S5.p3.1.m1.1.1.1.cmml" xref="S5.p3.1.m1.1.1.1"></eq><apply id="S5.p3.1.m1.1.1.2.cmml" xref="S5.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.p3.1.m1.1.1.2.1.cmml" xref="S5.p3.1.m1.1.1.2">subscript</csymbol><ci id="S5.p3.1.m1.1.1.2.2.cmml" xref="S5.p3.1.m1.1.1.2.2">𝑁</ci><apply id="S5.p3.1.m1.1.1.2.3.cmml" xref="S5.p3.1.m1.1.1.2.3"><times id="S5.p3.1.m1.1.1.2.3.1.cmml" xref="S5.p3.1.m1.1.1.2.3.1"></times><ci id="S5.p3.1.m1.1.1.2.3.2.cmml" xref="S5.p3.1.m1.1.1.2.3.2">𝑠</ci><ci id="S5.p3.1.m1.1.1.2.3.3.cmml" xref="S5.p3.1.m1.1.1.2.3.3">𝑒</ci><ci id="S5.p3.1.m1.1.1.2.3.4.cmml" xref="S5.p3.1.m1.1.1.2.3.4">𝑛</ci><ci id="S5.p3.1.m1.1.1.2.3.5.cmml" xref="S5.p3.1.m1.1.1.2.3.5">𝑠</ci><ci id="S5.p3.1.m1.1.1.2.3.6.cmml" xref="S5.p3.1.m1.1.1.2.3.6">𝑜</ci><ci id="S5.p3.1.m1.1.1.2.3.7.cmml" xref="S5.p3.1.m1.1.1.2.3.7">𝑟</ci><ci id="S5.p3.1.m1.1.1.2.3.8.cmml" xref="S5.p3.1.m1.1.1.2.3.8">𝑠</ci></apply></apply><cn type="integer" id="S5.p3.1.m1.1.1.3.cmml" xref="S5.p3.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.1.m1.1c">N_{sensors}=16</annotation></semantics></math>).
We plot in Figure <a href="#S5.F8" title="Figure 8 ‣ 5 Discussion ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> the results of positional error obtained in Section <a href="#S4" title="4 Experimental Evaluation ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> as a function of the distance to the center of array, showing that the method is robust even at large distances.
It is remarkable how we could directly use the models trained with simulations in the experimental tests without fitting any hyperparameters.
We leave for future work the possibility of including background and sensor noise during the training of the neural networks, similar to what has been shown in other magnetic tracking systems <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>.
This will reduce the sim-to-real mismatch, improving accuracy of the MLP method.</p>
</div>
<figure id="S5.F8" class="ltx_figure"><img src="/html/2211.07556/assets/x9.png" id="S5.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="246" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Positional tracking errors versus distance between the magnet position and the center of the array.
</figcaption>
</figure>
<div id="S5.p4" class="ltx_para ltx_noindent">
<p id="S5.p4.2" class="ltx_p">In Section <a href="#S3.SS3" title="3.3 Neural Networks trained with FEM vs Dipole Model ‣ 3 Comparison between our data-driven and an optimization-based tracking ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>, we tested the effect of using training datasets generated via FEM or the magnetic dipole model.
As expected, the dipole model has closer performances to FEM-trained models when the magnet is in shape closer/equal to a sphere, testified by more significant p-values of Student’s T-tests.
For magnets of cylindrical shapes, FEM-Simulated trained models improve the tracking by <math id="S5.p4.1.m1.1" class="ltx_Math" alttext="0.2" display="inline"><semantics id="S5.p4.1.m1.1a"><mn id="S5.p4.1.m1.1.1" xref="S5.p4.1.m1.1.1.cmml">0.2</mn><annotation-xml encoding="MathML-Content" id="S5.p4.1.m1.1b"><cn type="float" id="S5.p4.1.m1.1.1.cmml" xref="S5.p4.1.m1.1.1">0.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.1.m1.1c">0.2</annotation></semantics></math> mm to <math id="S5.p4.2.m2.1" class="ltx_Math" alttext="1.2" display="inline"><semantics id="S5.p4.2.m2.1a"><mn id="S5.p4.2.m2.1.1" xref="S5.p4.2.m2.1.1.cmml">1.2</mn><annotation-xml encoding="MathML-Content" id="S5.p4.2.m2.1b"><cn type="float" id="S5.p4.2.m2.1.1.cmml" xref="S5.p4.2.m2.1.1">1.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.2.m2.1c">1.2</annotation></semantics></math> mm. We observe, however, that the tracking performance of MLP also degrades as the magnets shapes differ more from a sphere (see Figure <a href="#S4.F7" title="Figure 7 ‣ 4.2 Results ‣ 4 Experimental Evaluation ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, may be due to demagnetizing factors not included in this work.</p>
</div>
<div id="S5.p5" class="ltx_para ltx_noindent">
<p id="S5.p5.1" class="ltx_p">We observe that the one-shot inference total time in MLP is comparable to each (of the many) optimization steps of the iterative methods (Section <a href="#S3.SS2" title="3.2 Running Time ‣ 3 Comparison between our data-driven and an optimization-based tracking ‣ Robust Real-Time Tracking of Axis-Symmetric Magnets via Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>).
As remarkable as its speed, the MLP can be called on demand, sporadically, without the need to keep the target tracked and locked in order to ensure a correct convergence within a few iteration steps.
We also show that it is possible to implement a MLP tracking algorithm on a portable, energy-constrained device.
We notice that the inference time via GPU takes about the same time than reading <math id="S5.p5.1.m1.1" class="ltx_Math" alttext="8" display="inline"><semantics id="S5.p5.1.m1.1a"><mn id="S5.p5.1.m1.1.1" xref="S5.p5.1.m1.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S5.p5.1.m1.1b"><cn type="integer" id="S5.p5.1.m1.1.1.cmml" xref="S5.p5.1.m1.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.1.m1.1c">8</annotation></semantics></math> sensors via the I2C protocol via the CPU.
Therefore, the sensor reading process throttles the refresh rate of the current prototype. Protocols such as SPI can improve this issue.</p>
</div>
<div id="S5.p6" class="ltx_para ltx_noindent">
<p id="S5.p6.1" class="ltx_p">A shortcoming of data-driven methods is that the neural network needs to be retrained every new condition, e.g., different amount of sensors and their placements or when the magnet shape is changed. Although our training take only <math id="S5.p6.1.m1.1" class="ltx_Math" alttext="\sim 1" display="inline"><semantics id="S5.p6.1.m1.1a"><mrow id="S5.p6.1.m1.1.1" xref="S5.p6.1.m1.1.1.cmml"><mi id="S5.p6.1.m1.1.1.2" xref="S5.p6.1.m1.1.1.2.cmml"></mi><mo id="S5.p6.1.m1.1.1.1" xref="S5.p6.1.m1.1.1.1.cmml">∼</mo><mn id="S5.p6.1.m1.1.1.3" xref="S5.p6.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p6.1.m1.1b"><apply id="S5.p6.1.m1.1.1.cmml" xref="S5.p6.1.m1.1.1"><csymbol cd="latexml" id="S5.p6.1.m1.1.1.1.cmml" xref="S5.p6.1.m1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S5.p6.1.m1.1.1.2.cmml" xref="S5.p6.1.m1.1.1.2">absent</csymbol><cn type="integer" id="S5.p6.1.m1.1.1.3.cmml" xref="S5.p6.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.1.m1.1c">\sim 1</annotation></semantics></math> hour including data generation, it prevents some applications such as the online optimization of sensor location.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.2" class="ltx_p">In this paper, we show the accuracy and efficiency of using neural networks to directly predict the location and orientation of magnets.
We combine 2D FEM-simulated data with a coordinate transformation algorithm to generate on-demand synthetic training for any type of axis-symmetric magnet.
The tracking performed by neural networks is stable and does not suffer from convergence failure in optimization-based tracking.
When conducting hands-on experiments, the average positional error is generally smaller than <math id="S6.p1.1.m1.1" class="ltx_Math" alttext="4" display="inline"><semantics id="S6.p1.1.m1.1a"><mn id="S6.p1.1.m1.1.1" xref="S6.p1.1.m1.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S6.p1.1.m1.1b"><cn type="integer" id="S6.p1.1.m1.1.1.cmml" xref="S6.p1.1.m1.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.1.m1.1c">4</annotation></semantics></math> mm within the entire working volume.
While now we run at <math id="S6.p1.2.m2.1" class="ltx_Math" alttext="35" display="inline"><semantics id="S6.p1.2.m2.1a"><mn id="S6.p1.2.m2.1.1" xref="S6.p1.2.m2.1.1.cmml">35</mn><annotation-xml encoding="MathML-Content" id="S6.p1.2.m2.1b"><cn type="integer" id="S6.p1.2.m2.1.1.cmml" xref="S6.p1.2.m2.1.1">35</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.2.m2.1c">35</annotation></semantics></math> Hz, this frequency could be doubled by moving to another sensor’s reading protocol.
The experiments show that we can now move the tracking algorithms to run on an energy-restricted device and make interactive magnetic applications portable.
Promising future research directions include using neural networks to track multiple magnets, using the prediction of neural networks to initialize optimization-based methods, and investigating recurrent neural networks to improve temporal consistency.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
X. Han, H. Seki, Y. Kamiya, and M. Hikizu, “Wearable handwriting input device
using magnetic field,” in <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">SICE Annual Conference 2007</em>.   IEEE, 2007, pp. 365–368.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Y. Ma, Z.-H. Mao, W. Jia, C. Li, J. Yang, and M. Sun, “Magnetic hand tracking
for human-computer interface,” <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Magnetics</em>,
vol. 47, no. 5, pp. 970–973, 2011.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
K.-Y. Chen, S. N. Patel, and S. Keller, “Finexus: Tracking precise motions of
multiple fingertips using magnetic sensing,” in <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proceedings of the
2016 CHI Conference on Human Factors in Computing Systems</em>, 2016, pp.
1504–1514.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
J. McIntosh, P. Strohmeier, J. Knibbe, S. Boring, and K. Hornbæk,
“Magnetips: Combining fingertip tracking and haptic feedback for
around-device interaction,” in <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 CHI Conference
on Human Factors in Computing Systems</em>, 2019, pp. 1–12.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
T. Langerak, J. J. Zárate, D. Lindlbauer, C. Holz, and O. Hilliges, “Omni:
Volumetric sensing and actuation of passive magnetic tools for dynamic haptic
feedback,” in <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 33rd Annual ACM Symposium on User
Interface Software and Technology</em>, ser. UIST ’20.   New York, NY, USA: Association for Computing Machinery, 2020, p.
594–606. [Online]. Available: https://doi.org/10.1145/3379337.3415589

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
S. Krueger, H. Timinger, R. Grewer, and J. Borgert, “Modality-integrated
magnetic catheter tracking for x-ray vascular interventions,” <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Physics
in Medicine &amp; Biology</em>, vol. 50, no. 4, p. 581, 2005.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
M. Salerno, R. Rizzo, E. Sinibaldi, and A. Menciassi, “Force calculation for
localized magnetic driven capsule endoscopes,” in <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">2013 IEEE
International Conference on Robotics and Automation</em>.   IEEE, 2013, pp. 5354–5359.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Z. Sun, L. Maréchal, and S. Foong, “Passive magnetic-based localization
for precise untethered medical instrument tracking,” <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Computer methods
and programs in biomedicine</em>, vol. 156, pp. 151–161, 2018.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
A. Z. Taddese, P. R. Slawinski, M. Pirotta, E. De Momi, K. L. Obstein, and
P. Valdastri, “Enhanced real-time pose estimation for closed-loop robotic
manipulation of magnetically actuated capsule endoscopes,” <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">The
International journal of robotics research</em>, vol. 37, no. 8, pp. 890–911,
2018.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
X. Luo, C. Shi, H.-Q. Zeng, H. C. Ewurum, Y. Wan, Y. Guo, S. Pagnha, X.-B.
Zhang, Y.-P. Du, and X. He, “Evolutionarily optimized electromagnetic sensor
measurements for robust surgical navigation,” <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">IEEE Sensors Journal</em>,
vol. 19, no. 22, pp. 10 859–10 868, 2019.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
F. S. Parizi, E. Whitmire, and S. Patel, “Auraring: Precise electromagnetic
finger tracking,” <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Proceedings of the ACM on Interactive, Mobile,
Wearable and Ubiquitous Technologies</em>, vol. 3, no. 4, pp. 1–28, 2019.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
D. Son, S. Yim, and M. Sitti, “A 5-d localization method for a magnetically
manipulated untethered robot using a 2-d array of hall-effect sensors,”
<em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">IEEE/ASME Transactions on Mechatronics</em>, vol. 21, no. 2, pp. 708–716,
2015.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
C. R. Taylor, H. G. Abramson, and H. M. Herr, “Low-latency tracking of
multiple permanent magnets,” <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">IEEE Sensors Journal</em>, vol. 19, no. 23,
pp. 11 458–11 468, 2019.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
S. Hashi, M. Toyoda, S. Yabukami, K. Ishiyama, Y. Okazaki, and K. I. Arai,
“Wireless magnetic motion capture system for multi-marker detection,”
<em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on magnetics</em>, vol. 42, no. 10, pp. 3279–3281, 2006.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
C. Hu, M. Q. Meng, and M. Mandal, “Efficient magnetic localization and
orientation technique for capsule endoscopy,” in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">2005 IEEE/RSJ
International Conference on Intelligent Robots and Systems</em>, 2005, pp.
628–633.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
T. D. Than, G. Alici, H. Zhou, and W. Li, “A review of localization systems
for robotic endoscopic capsules,” <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Biomedical
Engineering</em>, vol. 59, no. 9, pp. 2387–2399, 2012.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
M. Yousefi, H. Nejat Pishkenari, and A. Alasty, “A fast and robust magnetic
localization technique based on elimination of the orientation variables from
the optimization,” <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">IEEE Sensors Journal</em>, vol. 21, no. 19, pp.
21 885–21 892, 2021.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
H.-C. Kuo, R.-H. Liang, L.-F. Lin, and B.-Y. Chen, “Gaussmarbles: spherical
magnetic tangibles for interacting with portable physical constraints,” in
<em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2016 CHI Conference on Human Factors in Computing
Systems</em>, 2016, pp. 4228–4232.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
R.-H. Liang, K.-Y. Cheng, C.-H. Su, C.-T. Weng, B.-Y. Chen, and D.-N. Yang,
“Gausssense: attachable stylus sensing using magnetic sensor grid,” in
<em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 25th annual ACM symposium on User interface software
and technology</em>, 2012, pp. 319–326.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
K.-Y. Chen, K. Lyons, S. White, and S. Patel, “utrack: 3d input using two
magnetic sensors,” in <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 26th annual ACM symposium on
User interface software and technology</em>, 2013, pp. 237–244.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
A. J. Petruska and J. J. Abbott, “Optimal permanent-magnet geometries for
dipole field approximation,” <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Magnetics</em>, vol. 49,
no. 2, pp. 811–819, 2013.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
N. Sebkhi, N. Sahadat, S. Hersek, A. Bhavsar, S. Siahpoushan, M. Ghoovanloo,
and O. T. Inan, “A deep neural network-based permanent magnet localization
for tongue tracking,” <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">IEEE Sensors Journal</em>, vol. 19, no. 20, pp.
9324–9331, 2019.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
A.-i. Sasaki and E. Ohta, “Magnetic-field-based position sensing using machine
learning,” <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">IEEE Sensors Journal</em>, vol. 20, no. 13, pp. 7292–7302,
2020.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
A. Mendizabal, P. Márquez-Neila, and S. Cotin, “Simulation of hyperelastic
materials in real-time using deep learning,” <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Medical image analysis</em>,
vol. 59, p. 101569, 2020.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
E. Haghighat, M. Raissi, A. Moure, H. Gomez, and R. Juanes, “A deep learning
framework for solution and discovery in solid mechanics,” <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:2003.02751</em>, 2020.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
G. Psuj, “Multi-sensor data integration using deep learning for
characterization of defects in steel elements,” <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Sensors</em>, vol. 18,
no. 1, p. 292, 2018.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
I. Malkiel, M. Mrejen, A. Nagler, U. Arieli, L. Wolf, and H. Suchowski,
“Plasmonic nanostructure design and characterization via deep learning,”
<em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Light: Science &amp; Applications</em>, vol. 7, no. 1, pp. 1–8, 2018.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
D. P. Kingma and J. Ba, “Adam: A method for stochastic optimization,”
<em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1412.6980</em>, 2014.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
T. Pylvänäinen, “Automatic and adaptive calibration of 3d field sensors,”
<em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Applied Mathematical Modelling</em>, vol. 32, no. 4, pp. 575–587, 2008.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
A. G. Baydin, B. A. Pearlmutter, A. A. Radul, and J. M. Siskind, “Automatic
differentiation in machine learning: a survey,” <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Journal of machine
learning research</em>, vol. 18, 2018.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
D. C. Liu and J. Nocedal, “On the limited memory bfgs method for large scale
optimization,” <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Mathematical programming</em>, vol. 45, no. 1, pp.
503–528, 1989.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
K. Brodlie and S. Butt, “Preserving convexity using piecewise cubic
interpolation,” <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Computers &amp; Graphics</em>, vol. 15, no. 1, pp. 15–23,
1991.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
G. Shao, Y. Tang, L. Tang, Q. Dai, and Y.-X. Guo, “A novel passive magnetic
localization wearable system for wireless capsule endoscopy,” <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">IEEE
Sensors Journal</em>, vol. 19, no. 9, pp. 3462–3472, 2019.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Q. Li, Z. Shi, Z. Li, H. Fan, G. Zhang, and T. Li, “Magnetic object
positioning based on second-order magnetic gradient tensor system,”
<em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">IEEE Sensors Journal</em>, vol. 21, no. 16, pp. 18 237–18 248, 2021.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2211.07555" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2211.07556" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2211.07556">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2211.07556" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2211.07557" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar 14 08:35:25 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
