<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring</title>
<!--Generated on Fri Sep 20 13:34:15 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.13496v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S1" title="In DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">I </span><span class="ltx_text ltx_font_smallcaps">INTRODUCTION</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S2" title="In DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">II </span><span class="ltx_text ltx_font_smallcaps">RELATED WORK</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S3" title="In DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">III </span><span class="ltx_text ltx_font_smallcaps">PROPOSED METHOD</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S3.SS1" title="In III PROPOSED METHOD ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span> </span><span class="ltx_text ltx_font_italic">Overall Pipeline</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S3.SS2" title="In III PROPOSED METHOD ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-B</span> </span><span class="ltx_text ltx_font_italic">CLIP-guided Cross-fusion Module (CCM)</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S3.SS3" title="In III PROPOSED METHOD ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-C</span> </span><span class="ltx_text ltx_font_italic">CLIP-Enhanced Transformer Blocks (CeTBs)</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S3.SS4" title="In III PROPOSED METHOD ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-D</span> </span><span class="ltx_text ltx_font_italic">Optimization</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S4" title="In DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">IV </span><span class="ltx_text ltx_font_smallcaps">EXPERIMENTS</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S4.SS1" title="In IV EXPERIMENTS ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-A</span> </span><span class="ltx_text ltx_font_italic">Implementation Details and Datasets</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S4.SS2" title="In IV EXPERIMENTS ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-B</span> </span><span class="ltx_text ltx_font_italic">Results on Synthetic Datasets</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S4.SS3" title="In IV EXPERIMENTS ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-C</span> </span><span class="ltx_text ltx_font_italic">Results on the Real-World Dataset</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S4.SS4" title="In IV EXPERIMENTS ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-D</span> </span><span class="ltx_text ltx_font_italic">Ablation Study</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S4.SS5" title="In IV EXPERIMENTS ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-E</span> </span><span class="ltx_text ltx_font_italic">Applications to Downstream Vision Tasks</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S5" title="In DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">V </span><span class="ltx_text ltx_font_smallcaps">CONCLUSIONS</span></span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_font_bold ltx_title_document" style="font-size:173%;">DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ling Wang<sup class="ltx_sup" id="id7.7.id1"><span class="ltx_text ltx_font_italic" id="id7.7.id1.1">1</span></sup>, Chen Wu<sup class="ltx_sup" id="id8.8.id2"><span class="ltx_text ltx_font_italic" id="id8.8.id2.1">3</span></sup> and Lin Wang<sup class="ltx_sup" id="id9.9.id3"><span class="ltx_text ltx_font_italic" id="id9.9.id3.1">1,2,∗</span></sup>
</span><span class="ltx_author_notes">*Corresponding author<sup class="ltx_sup" id="id10.10.id1"><span class="ltx_text ltx_font_italic" id="id10.10.id1.1">1</span></sup> Ling Wang is with the AI Thrust, The Hong Kong University of Science and Technology (Guangzhou), Guangdong, China.
<span class="ltx_text ltx_font_typewriter" id="id11.11.id2" style="font-size:90%;">lwang851@connect.hkust-gz.edu.cn</span><sup class="ltx_sup" id="id12.12.id1"><span class="ltx_text ltx_font_italic" id="id12.12.id1.1">3</span></sup> Chen Wu is with University of Science and Technology of China, Hefei, China.
<span class="ltx_text ltx_font_typewriter" id="id13.13.id2" style="font-size:90%;">wuchen5X@mail.ustc.edu.cn</span><sup class="ltx_sup" id="id14.14.id1"><span class="ltx_text ltx_font_italic" id="id14.14.id1.1">1,2</span></sup>Lin Wang is with AI/CMA Thrust, HKUST(GZ) and Dept. of CSE, HKUST, Hong Kong SAR, China, Email:
<span class="ltx_text ltx_font_typewriter" id="id15.15.id2" style="font-size:90%;">linwang@ust.hk</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id16.id1">Autonomous vehicles and robots often struggle with reliable visual perception at night due to the low illumination and motion blur caused by the long exposure time of RGB cameras.
Existing methods address this challenge by sequentially connecting the off-the-shelf pretrained low-light enhancement and deblurring models. Unfortunately, these methods often lead to noticeable artifacts (<span class="ltx_text ltx_font_italic" id="id16.id1.1">e.g.</span>, color distortions) in the over-exposed regions or make it hardly possible to learn the motion cues of the dark regions.
In this paper, we interestingly find vision-language models, <span class="ltx_text ltx_font_italic" id="id16.id1.2">e.g.</span>, Contrastive Language-Image Pretraining (CLIP), can comprehensively perceive diverse degradation levels at night.
In light of this, we propose a novel transformer-based joint learning framework, named DAP-LED, which can jointly achieve low-light enhancement and deblurring, benefiting downstream tasks, such as depth estimation, segmentation, and detection in the dark. The key insight is to leverage CLIP to adaptively learn the degradation levels from images at night. This subtly enables learning rich semantic information and visual representation for optimization of the joint tasks.
To achieve this, we first introduce a CLIP-guided cross-fusion module to obtain multi-scale patch-wise degradation heatmaps from the image embeddings.
Then, the heatmaps are fused via the designed CLIP-enhanced transformer blocks to retain useful degradation information for effective model optimization.
Experimental results show that, compared to existing methods, our DAP-LED achieves state-of-the-art performance in the dark. Meanwhile, the enhanced results are demonstrated to be effective for three downstream tasks. For demo and more results, please check the project page: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://vlislab22.github.io/dap-led/" title="">https://vlislab22.github.io/dap-led/</a>.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">INTRODUCTION</span>
</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Autonomous vehicles and intelligent robots are increasingly being deployed in a variety of environments, ranging from different lighting conditions. A critical challenge in these applications is to ensure robust visual perception under various adverse conditions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib1" title="">1</a>]</cite>, particularly at night. Traditional frame-based cameras often struggle in low-light environments due to the long exposure times needed to capture sufficient illumination. This often results in significant motion blur <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib2" title="">2</a>]</cite>, leading to poor visibility and reduced scene understanding accuracy.
For example, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S1.F1" title="Figure 1 ‣ I INTRODUCTION ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag">1</span></a>, without the image restoration, a dark image leads to sparse depth estimation, reduces the contrast and sharpness, and loss of depth details; More seriously, under low-light conditions, object detection is difficult, resulting in the loss of large number of targets.
In scenarios where intelligent robots are required to interact with dynamic environments, acquiring high-quality images with good visibility is crucial for safe and efficient operation.
As a result, improving visibility in low-light conditions and addressing blurring issues are essential for vision-related tasks, especially for downstream applications like depth estimation, object detection, and semantic segmentation.
</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="355" id="S1.F1.g1" src="x1.png" width="831"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Comparison of depth estimation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib3" title="">3</a>]</cite> and object detection <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib4" title="">4</a>]</cite> results with night-blurred input (top) and our enhanced image as input (bottom).
</figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Previous approaches typically address the two tasks separately, namely, low-light enhancement <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib6" title="">6</a>]</cite> and image deblurring <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib9" title="">9</a>]</cite>, each making independent assumptions about the specific problem <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib10" title="">10</a>]</cite>. Therefore, simply combining these methods cannot effectively address the joint degradation caused by low light and motion blur, and may even exacerbate the degradation due to error accumulation, see Tab. <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S3.T1" title="TABLE I ‣ III-D Optimization ‣ III PROPOSED METHOD ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag">I</span></a>.
Specifically, methods for low light enhancement <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib6" title="">6</a>]</cite> overlook the spatial degradation caused by motion blur and would obscure clues to deblurring due to image smoothing <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib10" title="">10</a>]</cite>. Consequently, performing low light enhancement followed by deblurring would lead to overexposure of the saturated areas of the night-blurred images, resulting in worsening blur <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib11" title="">11</a>]</cite>. On the other hand, methods for deblurring <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib9" title="">9</a>]</cite> are typically trained on datasets that contain only daytime scenes, making them unsuitable for the challenging task of directly debluring images at night due to two reasons. Firstly, the low dynamic range makes motion cues in dark regions difficult to learn. Secondly, night-blurred images often contain saturated regions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib10" title="">10</a>]</cite>, <span class="ltx_text ltx_font_italic" id="S1.p2.1.1">e.g.</span> light streaks, where the pixel values do not conform to the blur models learned from daytime data <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib7" title="">7</a>]</cite>. For these reasons, LEDNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib10" title="">10</a>]</cite> takes a step forward with a unified approach to the joint task of low-light enhancement and deblurring.</p>
</div>
<figure class="ltx_figure" id="S1.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="977" id="S1.F2.g1" src="x2.png" width="829"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="ltx_text ltx_font_bold" id="S1.F2.3.1">Our motivation</span>. Here are some similarity scores between the image and text descriptions derived from the CLIP-L/14 model’s zero-shot inference. Despite some misclassifications in single degradation categories (<span class="ltx_text ltx_font_italic" id="S1.F2.4.2">e.g.</span>, the high score for “bright” in a low-light image), CLIP demonstrates stronger joint degradation perception capabilities that it identifies the combined feature between low-light and blurriness in multiple images.</figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Building up the challenges, we observe that vision-language models, <span class="ltx_text ltx_font_italic" id="S1.p3.1.1">e.g.</span>, Contrastive
Language-Image Pretraining (CLIP) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib14" title="">14</a>]</cite>, offer the potential to inherently perceive and adaptively learn the joint degradation levels at night. As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S1.F2" title="Figure 2 ‣ I INTRODUCTION ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag">2</span></a>, CLIP can inherently perceive joint degradation better than single degradation. Compared to image-based classifiers, it learns a multi-modal embedding space shared by text and image features. It contains various visual representations, including the semantic information and comprehensive degradation information. Therefore, we explore the degradation-aware priors encapsulated in CLIP for the joint task of low-light enhancement and deblurring.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this work, we propose a novel transformer-based joint learning framework with degradation-aware CLIP priors, named <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">DAP-LED</span>, which simultaneously addresses low-light enhancement and deblurring. Our approach is beneficial for downstream tasks, such as depth estimation, segmentation, and detection in the dark. The key idea is to harness CLIP to adaptively learn degradation levels from nighttime images, thereby facilitating the extraction of rich semantic information and visual representations to optimize the joint task. To achieve this, we first introduce a CLIP-guided Cross-fusion Module (<span class="ltx_text ltx_font_bold" id="S1.p4.1.2">CCM</span>) that generates multi-scale, patch-wise degradation heatmaps from image embeddings (see Sec.<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S3.SS2" title="III-B CLIP-guided Cross-fusion Module (CCM) ‣ III PROPOSED METHOD ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-B</span></span></a>). These heatmaps are then integrated using the designed CLIP-enhanced Transformer Blocks (<span class="ltx_text ltx_font_bold" id="S1.p4.1.3">CeTBs</span>), which preserve critical degradation information to effectively optimize the model (see Sec.<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S3.SS3" title="III-C CLIP-Enhanced Transformer Blocks (CeTBs) ‣ III PROPOSED METHOD ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-C</span></span></a> and Sec. <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S3.SS4" title="III-D Optimization ‣ III PROPOSED METHOD ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-D</span></span></a>).</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">In summary, our main contributions are four-fold: (<span class="ltx_text ltx_font_bold" id="S1.p5.1.1">I</span>) We leverage CLIP to inherently perceive and adaptively learn the joint degradation levels at night; (<span class="ltx_text ltx_font_bold" id="S1.p5.1.2">II</span>) We propose a novel framework named DAP-LED that not only utilizes CLIP’s strong perception ability for joint degradations but also introduces CLIP’s universal visual representation for the joint task. (<span class="ltx_text ltx_font_bold" id="S1.p5.1.3">III</span>) We introduce a CLIP-guided cross-fusion module to obtain multi-scale patch-wise degradation heatmaps and CLIP-enhanced transformer blocks to retain useful degradation information for effective model optimization. (<span class="ltx_text ltx_font_bold" id="S1.p5.1.4">IV</span>) Extensive experiments demonstrate that our DAP-LED, achieves remarkable image restoration effects, enefiting downstream tasks, such as depth estimation, segmentation and detection in the dark.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">RELATED WORK</span>
</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Low-Light Image Enhancement (LLIE).</span>
Methods based on Retinex theory are the mainstream approaches for learning-based LLIE.
For instance, RetinexNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib15" title="">15</a>]</cite> incorporates the Retinex theory with a Decom-Net for image decomposition and an Enhance-Net for adjusting illumination. Retinexformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib16" title="">16</a>]</cite> also integrates Retinex theory into the transformer to guide the modeling of non-local interactions among regions with varying lighting conditions.
However, these methods often focus on brightness enhancement and denoising while neglecting the motion blur that often occurs in the robotic scene understanding process.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.p2.1.1">Image Deblurring.</span>
DeepDeblur <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib17" title="">17</a>]</cite>, DMPHN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib8" title="">8</a>]</cite>, and MPRNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib18" title="">18</a>]</cite> utilize a multi-stage architecture that progressively learns the degradation patterns.
By contrast, some methods, <span class="ltx_text ltx_font_italic" id="S2.p2.1.2">e.g.</span> Uformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib19" title="">19</a>]</cite> and Stripformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib20" title="">20</a>]</cite> employ local self-attention to capture long-range dependencies while maintaining low complexity. Restormer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib21" title="">21</a>]</cite> models global context using global channel self-attention.
However, these methods primarily focus on deblurring tasks under normal lighting conditions, often resulting in subpar performance when applied to nighttime scene perception.</p>
</div>
<figure class="ltx_figure" id="S2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="398" id="S2.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span class="ltx_text ltx_font_bold" id="S2.F3.4.1">Overview of our proposed DAP-LED framework</span>. The overall framework utilizes a 4-level transformer-based symmetric encoder-decoder structure and incorporates multiple CLIP-enhanced Transformer Blocks (<span class="ltx_text ltx_font_bold" id="S2.F3.5.2">CeTBs</span>) at each decoding level. At the beginning, the CLIP-guided Cross-fusion Module (<span class="ltx_text ltx_font_bold" id="S2.F3.6.3">CCM</span>) generates the multi-scale degradation-aware heatmaps, which are used at each level at encoding and decoding stages.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.1"><span class="ltx_text ltx_font_bold" id="S2.p3.1.1">Joint Low-light Enhancement and Deblurring.</span>
Zhou <span class="ltx_text ltx_font_italic" id="S2.p3.1.2">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib10" title="">10</a>]</cite> proposed the dataset LOL-Blur, which contains 12K low-blur/normal-sharp pairs with diverse dark and blur levels in different scenarios.
They also propose LEDNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib10" title="">10</a>]</cite>, which contains an encoder for light enhancement and a decoder for deblurring. The decoder applies spatially adaptive transformation using filters generated by filter adaptive skip connection from enhanced features.
ASP-LED <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib11" title="">11</a>]</cite> leverages structural priors and transformer backbones to address these issues by effectively capturing global and local features. FourierDiff <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib22" title="">22</a>]</cite> leverages Fourier priors within pre-trained diffusion models, enabling zero-shot learning that effectively handles luminance and structure degradation without needing paired data or strict degradation assumptions. Rather than relying on predefined structural assumptions or Fourier priors, by contrast, <span class="ltx_text ltx_font_italic" id="S2.p3.1.3">our DAP-LED framework leverages the degradation-aware CLIP priors to simultaneously address low-light enhancement and deblurring</span>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p4">
<p class="ltx_p" id="S2.p4.1"><span class="ltx_text ltx_font_bold" id="S2.p4.1.1">Contrastive Language-Image Pre-Training.</span>
Contrastive Language-Image Pre-Training, <span class="ltx_text ltx_font_italic" id="S2.p4.1.2">i.e.</span> CLIP, has been widely utilized for various tasks due to its outstanding cross-modal representation capabilities. These applications include areas like image manipulation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib24" title="">24</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib25" title="">25</a>]</cite>, image generation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib28" title="">28</a>]</cite> and image restoration <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib30" title="">30</a>]</cite>. In this work, we leverage CLIP to adaptively learn the degradation levels from images at night. We propose the CLIP-guided cross-fusion module to obtain multi-scale patch-wise degradation heatmaps from the image embeddings. Our DAP-LED framework enables learning rich semantic information and visual representation for optimization of the joint task.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">PROPOSED METHOD</span>
</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS1.5.1.1">III-A</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS1.6.2">Overall Pipeline</span>
</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.14">The overview of our DAP-LED is depicted in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S2.F3" title="Figure 3 ‣ II RELATED WORK ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag">3</span></a>. Given an input image <math alttext="\boldsymbol{I}\in\mathbb{R}^{H\times W\times 3}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">𝑰</mi><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.2" xref="S3.SS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.1.m1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.3.2" xref="S3.SS1.p1.1.m1.1.1.3.3.2.cmml">H</mi><mo id="S3.SS1.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.1.m1.1.1.3.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.3.cmml">W</mi><mo id="S3.SS1.p1.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mn id="S3.SS1.p1.1.m1.1.1.3.3.4" xref="S3.SS1.p1.1.m1.1.1.3.3.4.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><in id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></in><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑰</ci><apply id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3"><times id="S3.SS1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS1.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.2">𝐻</ci><ci id="S3.SS1.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.3">𝑊</ci><cn id="S3.SS1.p1.1.m1.1.1.3.3.4.cmml" type="integer" xref="S3.SS1.p1.1.m1.1.1.3.3.4">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\boldsymbol{I}\in\mathbb{R}^{H\times W\times 3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">bold_italic_I ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W × 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, DAP-LED first applies a <math alttext="3\times 3" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mrow id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mn id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">3</mn><mo id="S3.SS1.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.2.m2.1.1.1.cmml">×</mo><mn id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><times id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1"></times><cn id="S3.SS1.p1.2.m2.1.1.2.cmml" type="integer" xref="S3.SS1.p1.2.m2.1.1.2">3</cn><cn id="S3.SS1.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">3\times 3</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">3 × 3</annotation></semantics></math> conv layer to generate a low-level feature representation <math alttext="\boldsymbol{F_{in}}\in\mathbb{R}^{H\times W\times C}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><msub id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2.2" xref="S3.SS1.p1.3.m3.1.1.2.2.cmml">𝑭</mi><mrow id="S3.SS1.p1.3.m3.1.1.2.3" xref="S3.SS1.p1.3.m3.1.1.2.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2.3.2" xref="S3.SS1.p1.3.m3.1.1.2.3.2.cmml">𝒊</mi><mo id="S3.SS1.p1.3.m3.1.1.2.3.1" xref="S3.SS1.p1.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.2.3.3" xref="S3.SS1.p1.3.m3.1.1.2.3.3.cmml">𝒏</mi></mrow></msub><mo id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.3.m3.1.1.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.3.2" xref="S3.SS1.p1.3.m3.1.1.3.3.2.cmml">H</mi><mo id="S3.SS1.p1.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.3.m3.1.1.3.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.3.cmml">W</mi><mo id="S3.SS1.p1.3.m3.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.3.m3.1.1.3.3.4" xref="S3.SS1.p1.3.m3.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><in id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1"></in><apply id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2.2">𝑭</ci><apply id="S3.SS1.p1.3.m3.1.1.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.2.3"><times id="S3.SS1.p1.3.m3.1.1.2.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.2.3.1"></times><ci id="S3.SS1.p1.3.m3.1.1.2.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2.3.2">𝒊</ci><ci id="S3.SS1.p1.3.m3.1.1.2.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.2.3.3">𝒏</ci></apply></apply><apply id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3"><times id="S3.SS1.p1.3.m3.1.1.3.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.1"></times><ci id="S3.SS1.p1.3.m3.1.1.3.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.2">𝐻</ci><ci id="S3.SS1.p1.3.m3.1.1.3.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.3">𝑊</ci><ci id="S3.SS1.p1.3.m3.1.1.3.3.4.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\boldsymbol{F_{in}}\in\mathbb{R}^{H\times W\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">bold_italic_F start_POSTSUBSCRIPT bold_italic_i bold_italic_n end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math>; where <math alttext="H\times W" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mrow id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">H</mi><mo id="S3.SS1.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.4.m4.1.1.1.cmml">×</mo><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">W</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><times id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1"></times><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝐻</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">H\times W</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_H × italic_W</annotation></semantics></math> is the spatial resolution and <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_C</annotation></semantics></math> denotes the channel. Meanwhile, we use CLIP’s image encoder and text encoder, <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.14.1">i.e.</span> CLIP-guided Cross-fusion Module (CCM) (Sec <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S3.SS2" title="III-B CLIP-guided Cross-fusion Module (CCM) ‣ III PROPOSED METHOD ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-B</span></span></a>), to map the image <math alttext="\boldsymbol{I}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">𝑰</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝑰</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\boldsymbol{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">bold_italic_I</annotation></semantics></math> to the CLIP embedding space and obtain the image and text cross feature embeddings <math alttext="\boldsymbol{F_{weight}}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><msub id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">𝑭</mi><mrow id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml"><mi id="S3.SS1.p1.7.m7.1.1.3.2" xref="S3.SS1.p1.7.m7.1.1.3.2.cmml">𝒘</mi><mo id="S3.SS1.p1.7.m7.1.1.3.1" xref="S3.SS1.p1.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.7.m7.1.1.3.3" xref="S3.SS1.p1.7.m7.1.1.3.3.cmml">𝒆</mi><mo id="S3.SS1.p1.7.m7.1.1.3.1a" xref="S3.SS1.p1.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.7.m7.1.1.3.4" xref="S3.SS1.p1.7.m7.1.1.3.4.cmml">𝒊</mi><mo id="S3.SS1.p1.7.m7.1.1.3.1b" xref="S3.SS1.p1.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.7.m7.1.1.3.5" xref="S3.SS1.p1.7.m7.1.1.3.5.cmml">𝒈</mi><mo id="S3.SS1.p1.7.m7.1.1.3.1c" xref="S3.SS1.p1.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.7.m7.1.1.3.6" xref="S3.SS1.p1.7.m7.1.1.3.6.cmml">𝒉</mi><mo id="S3.SS1.p1.7.m7.1.1.3.1d" xref="S3.SS1.p1.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.7.m7.1.1.3.7" xref="S3.SS1.p1.7.m7.1.1.3.7.cmml">𝒕</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">𝑭</ci><apply id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3"><times id="S3.SS1.p1.7.m7.1.1.3.1.cmml" xref="S3.SS1.p1.7.m7.1.1.3.1"></times><ci id="S3.SS1.p1.7.m7.1.1.3.2.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2">𝒘</ci><ci id="S3.SS1.p1.7.m7.1.1.3.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3">𝒆</ci><ci id="S3.SS1.p1.7.m7.1.1.3.4.cmml" xref="S3.SS1.p1.7.m7.1.1.3.4">𝒊</ci><ci id="S3.SS1.p1.7.m7.1.1.3.5.cmml" xref="S3.SS1.p1.7.m7.1.1.3.5">𝒈</ci><ci id="S3.SS1.p1.7.m7.1.1.3.6.cmml" xref="S3.SS1.p1.7.m7.1.1.3.6">𝒉</ci><ci id="S3.SS1.p1.7.m7.1.1.3.7.cmml" xref="S3.SS1.p1.7.m7.1.1.3.7">𝒕</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">\boldsymbol{F_{weight}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">bold_italic_F start_POSTSUBSCRIPT bold_italic_w bold_italic_e bold_italic_i bold_italic_g bold_italic_h bold_italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. And <math alttext="\boldsymbol{F_{weight}}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><msub id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">𝑭</mi><mrow id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml"><mi id="S3.SS1.p1.8.m8.1.1.3.2" xref="S3.SS1.p1.8.m8.1.1.3.2.cmml">𝒘</mi><mo id="S3.SS1.p1.8.m8.1.1.3.1" xref="S3.SS1.p1.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.8.m8.1.1.3.3" xref="S3.SS1.p1.8.m8.1.1.3.3.cmml">𝒆</mi><mo id="S3.SS1.p1.8.m8.1.1.3.1a" xref="S3.SS1.p1.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.8.m8.1.1.3.4" xref="S3.SS1.p1.8.m8.1.1.3.4.cmml">𝒊</mi><mo id="S3.SS1.p1.8.m8.1.1.3.1b" xref="S3.SS1.p1.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.8.m8.1.1.3.5" xref="S3.SS1.p1.8.m8.1.1.3.5.cmml">𝒈</mi><mo id="S3.SS1.p1.8.m8.1.1.3.1c" xref="S3.SS1.p1.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.8.m8.1.1.3.6" xref="S3.SS1.p1.8.m8.1.1.3.6.cmml">𝒉</mi><mo id="S3.SS1.p1.8.m8.1.1.3.1d" xref="S3.SS1.p1.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.8.m8.1.1.3.7" xref="S3.SS1.p1.8.m8.1.1.3.7.cmml">𝒕</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">𝑭</ci><apply id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3"><times id="S3.SS1.p1.8.m8.1.1.3.1.cmml" xref="S3.SS1.p1.8.m8.1.1.3.1"></times><ci id="S3.SS1.p1.8.m8.1.1.3.2.cmml" xref="S3.SS1.p1.8.m8.1.1.3.2">𝒘</ci><ci id="S3.SS1.p1.8.m8.1.1.3.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3.3">𝒆</ci><ci id="S3.SS1.p1.8.m8.1.1.3.4.cmml" xref="S3.SS1.p1.8.m8.1.1.3.4">𝒊</ci><ci id="S3.SS1.p1.8.m8.1.1.3.5.cmml" xref="S3.SS1.p1.8.m8.1.1.3.5">𝒈</ci><ci id="S3.SS1.p1.8.m8.1.1.3.6.cmml" xref="S3.SS1.p1.8.m8.1.1.3.6">𝒉</ci><ci id="S3.SS1.p1.8.m8.1.1.3.7.cmml" xref="S3.SS1.p1.8.m8.1.1.3.7">𝒕</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\boldsymbol{F_{weight}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">bold_italic_F start_POSTSUBSCRIPT bold_italic_w bold_italic_e bold_italic_i bold_italic_g bold_italic_h bold_italic_t end_POSTSUBSCRIPT</annotation></semantics></math> gets downsampled 3 times to correspond to the size of each level. The low-level representation <math alttext="\boldsymbol{F_{in}}" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><msub id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><mi id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml">𝑭</mi><mrow id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml"><mi id="S3.SS1.p1.9.m9.1.1.3.2" xref="S3.SS1.p1.9.m9.1.1.3.2.cmml">𝒊</mi><mo id="S3.SS1.p1.9.m9.1.1.3.1" xref="S3.SS1.p1.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.9.m9.1.1.3.3" xref="S3.SS1.p1.9.m9.1.1.3.3.cmml">𝒏</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2">𝑭</ci><apply id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3"><times id="S3.SS1.p1.9.m9.1.1.3.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1"></times><ci id="S3.SS1.p1.9.m9.1.1.3.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2">𝒊</ci><ci id="S3.SS1.p1.9.m9.1.1.3.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3.3">𝒏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">\boldsymbol{F_{in}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">bold_italic_F start_POSTSUBSCRIPT bold_italic_i bold_italic_n end_POSTSUBSCRIPT</annotation></semantics></math> and CLIP-aware degradation weighted representation <math alttext="\boldsymbol{F_{weight}}" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><msub id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">𝑭</mi><mrow id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml"><mi id="S3.SS1.p1.10.m10.1.1.3.2" xref="S3.SS1.p1.10.m10.1.1.3.2.cmml">𝒘</mi><mo id="S3.SS1.p1.10.m10.1.1.3.1" xref="S3.SS1.p1.10.m10.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.10.m10.1.1.3.3" xref="S3.SS1.p1.10.m10.1.1.3.3.cmml">𝒆</mi><mo id="S3.SS1.p1.10.m10.1.1.3.1a" xref="S3.SS1.p1.10.m10.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.10.m10.1.1.3.4" xref="S3.SS1.p1.10.m10.1.1.3.4.cmml">𝒊</mi><mo id="S3.SS1.p1.10.m10.1.1.3.1b" xref="S3.SS1.p1.10.m10.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.10.m10.1.1.3.5" xref="S3.SS1.p1.10.m10.1.1.3.5.cmml">𝒈</mi><mo id="S3.SS1.p1.10.m10.1.1.3.1c" xref="S3.SS1.p1.10.m10.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.10.m10.1.1.3.6" xref="S3.SS1.p1.10.m10.1.1.3.6.cmml">𝒉</mi><mo id="S3.SS1.p1.10.m10.1.1.3.1d" xref="S3.SS1.p1.10.m10.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.10.m10.1.1.3.7" xref="S3.SS1.p1.10.m10.1.1.3.7.cmml">𝒕</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2">𝑭</ci><apply id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3"><times id="S3.SS1.p1.10.m10.1.1.3.1.cmml" xref="S3.SS1.p1.10.m10.1.1.3.1"></times><ci id="S3.SS1.p1.10.m10.1.1.3.2.cmml" xref="S3.SS1.p1.10.m10.1.1.3.2">𝒘</ci><ci id="S3.SS1.p1.10.m10.1.1.3.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3.3">𝒆</ci><ci id="S3.SS1.p1.10.m10.1.1.3.4.cmml" xref="S3.SS1.p1.10.m10.1.1.3.4">𝒊</ci><ci id="S3.SS1.p1.10.m10.1.1.3.5.cmml" xref="S3.SS1.p1.10.m10.1.1.3.5">𝒈</ci><ci id="S3.SS1.p1.10.m10.1.1.3.6.cmml" xref="S3.SS1.p1.10.m10.1.1.3.6">𝒉</ci><ci id="S3.SS1.p1.10.m10.1.1.3.7.cmml" xref="S3.SS1.p1.10.m10.1.1.3.7">𝒕</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">\boldsymbol{F_{weight}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">bold_italic_F start_POSTSUBSCRIPT bold_italic_w bold_italic_e bold_italic_i bold_italic_g bold_italic_h bold_italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is then processed through a 4-level UNet-like hierarchical encoder-decoder, producing deep features <math alttext="\boldsymbol{F}_{latent}\in\mathbb{R}^{\frac{H}{8}\times\frac{W}{8}\times 8C}" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.1"><semantics id="S3.SS1.p1.11.m11.1a"><mrow id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml"><msub id="S3.SS1.p1.11.m11.1.1.2" xref="S3.SS1.p1.11.m11.1.1.2.cmml"><mi id="S3.SS1.p1.11.m11.1.1.2.2" xref="S3.SS1.p1.11.m11.1.1.2.2.cmml">𝑭</mi><mrow id="S3.SS1.p1.11.m11.1.1.2.3" xref="S3.SS1.p1.11.m11.1.1.2.3.cmml"><mi id="S3.SS1.p1.11.m11.1.1.2.3.2" xref="S3.SS1.p1.11.m11.1.1.2.3.2.cmml">l</mi><mo id="S3.SS1.p1.11.m11.1.1.2.3.1" xref="S3.SS1.p1.11.m11.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.11.m11.1.1.2.3.3" xref="S3.SS1.p1.11.m11.1.1.2.3.3.cmml">a</mi><mo id="S3.SS1.p1.11.m11.1.1.2.3.1a" xref="S3.SS1.p1.11.m11.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.11.m11.1.1.2.3.4" xref="S3.SS1.p1.11.m11.1.1.2.3.4.cmml">t</mi><mo id="S3.SS1.p1.11.m11.1.1.2.3.1b" xref="S3.SS1.p1.11.m11.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.11.m11.1.1.2.3.5" xref="S3.SS1.p1.11.m11.1.1.2.3.5.cmml">e</mi><mo id="S3.SS1.p1.11.m11.1.1.2.3.1c" xref="S3.SS1.p1.11.m11.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.11.m11.1.1.2.3.6" xref="S3.SS1.p1.11.m11.1.1.2.3.6.cmml">n</mi><mo id="S3.SS1.p1.11.m11.1.1.2.3.1d" xref="S3.SS1.p1.11.m11.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.11.m11.1.1.2.3.7" xref="S3.SS1.p1.11.m11.1.1.2.3.7.cmml">t</mi></mrow></msub><mo id="S3.SS1.p1.11.m11.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.11.m11.1.1.3" xref="S3.SS1.p1.11.m11.1.1.3.cmml"><mi id="S3.SS1.p1.11.m11.1.1.3.2" xref="S3.SS1.p1.11.m11.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.11.m11.1.1.3.3" xref="S3.SS1.p1.11.m11.1.1.3.3.cmml"><mrow id="S3.SS1.p1.11.m11.1.1.3.3.2" xref="S3.SS1.p1.11.m11.1.1.3.3.2.cmml"><mfrac id="S3.SS1.p1.11.m11.1.1.3.3.2.2" xref="S3.SS1.p1.11.m11.1.1.3.3.2.2.cmml"><mi id="S3.SS1.p1.11.m11.1.1.3.3.2.2.2" xref="S3.SS1.p1.11.m11.1.1.3.3.2.2.2.cmml">H</mi><mn id="S3.SS1.p1.11.m11.1.1.3.3.2.2.3" xref="S3.SS1.p1.11.m11.1.1.3.3.2.2.3.cmml">8</mn></mfrac><mo id="S3.SS1.p1.11.m11.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.11.m11.1.1.3.3.2.1.cmml">×</mo><mfrac id="S3.SS1.p1.11.m11.1.1.3.3.2.3" xref="S3.SS1.p1.11.m11.1.1.3.3.2.3.cmml"><mi id="S3.SS1.p1.11.m11.1.1.3.3.2.3.2" xref="S3.SS1.p1.11.m11.1.1.3.3.2.3.2.cmml">W</mi><mn id="S3.SS1.p1.11.m11.1.1.3.3.2.3.3" xref="S3.SS1.p1.11.m11.1.1.3.3.2.3.3.cmml">8</mn></mfrac><mo id="S3.SS1.p1.11.m11.1.1.3.3.2.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.11.m11.1.1.3.3.2.1.cmml">×</mo><mn id="S3.SS1.p1.11.m11.1.1.3.3.2.4" xref="S3.SS1.p1.11.m11.1.1.3.3.2.4.cmml">8</mn></mrow><mo id="S3.SS1.p1.11.m11.1.1.3.3.1" xref="S3.SS1.p1.11.m11.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.11.m11.1.1.3.3.3" xref="S3.SS1.p1.11.m11.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1"><in id="S3.SS1.p1.11.m11.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1"></in><apply id="S3.SS1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.2.1.cmml" xref="S3.SS1.p1.11.m11.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.2.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2.2">𝑭</ci><apply id="S3.SS1.p1.11.m11.1.1.2.3.cmml" xref="S3.SS1.p1.11.m11.1.1.2.3"><times id="S3.SS1.p1.11.m11.1.1.2.3.1.cmml" xref="S3.SS1.p1.11.m11.1.1.2.3.1"></times><ci id="S3.SS1.p1.11.m11.1.1.2.3.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2.3.2">𝑙</ci><ci id="S3.SS1.p1.11.m11.1.1.2.3.3.cmml" xref="S3.SS1.p1.11.m11.1.1.2.3.3">𝑎</ci><ci id="S3.SS1.p1.11.m11.1.1.2.3.4.cmml" xref="S3.SS1.p1.11.m11.1.1.2.3.4">𝑡</ci><ci id="S3.SS1.p1.11.m11.1.1.2.3.5.cmml" xref="S3.SS1.p1.11.m11.1.1.2.3.5">𝑒</ci><ci id="S3.SS1.p1.11.m11.1.1.2.3.6.cmml" xref="S3.SS1.p1.11.m11.1.1.2.3.6">𝑛</ci><ci id="S3.SS1.p1.11.m11.1.1.2.3.7.cmml" xref="S3.SS1.p1.11.m11.1.1.2.3.7">𝑡</ci></apply></apply><apply id="S3.SS1.p1.11.m11.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.3.1.cmml" xref="S3.SS1.p1.11.m11.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.3.2.cmml" xref="S3.SS1.p1.11.m11.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.11.m11.1.1.3.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3"><times id="S3.SS1.p1.11.m11.1.1.3.3.1.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3.1"></times><apply id="S3.SS1.p1.11.m11.1.1.3.3.2.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3.2"><times id="S3.SS1.p1.11.m11.1.1.3.3.2.1.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3.2.1"></times><apply id="S3.SS1.p1.11.m11.1.1.3.3.2.2.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3.2.2"><divide id="S3.SS1.p1.11.m11.1.1.3.3.2.2.1.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3.2.2"></divide><ci id="S3.SS1.p1.11.m11.1.1.3.3.2.2.2.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3.2.2.2">𝐻</ci><cn id="S3.SS1.p1.11.m11.1.1.3.3.2.2.3.cmml" type="integer" xref="S3.SS1.p1.11.m11.1.1.3.3.2.2.3">8</cn></apply><apply id="S3.SS1.p1.11.m11.1.1.3.3.2.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3.2.3"><divide id="S3.SS1.p1.11.m11.1.1.3.3.2.3.1.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3.2.3"></divide><ci id="S3.SS1.p1.11.m11.1.1.3.3.2.3.2.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3.2.3.2">𝑊</ci><cn id="S3.SS1.p1.11.m11.1.1.3.3.2.3.3.cmml" type="integer" xref="S3.SS1.p1.11.m11.1.1.3.3.2.3.3">8</cn></apply><cn id="S3.SS1.p1.11.m11.1.1.3.3.2.4.cmml" type="integer" xref="S3.SS1.p1.11.m11.1.1.3.3.2.4">8</cn></apply><ci id="S3.SS1.p1.11.m11.1.1.3.3.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">\boldsymbol{F}_{latent}\in\mathbb{R}^{\frac{H}{8}\times\frac{W}{8}\times 8C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.1d">bold_italic_F start_POSTSUBSCRIPT italic_l italic_a italic_t italic_e italic_n italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT divide start_ARG italic_H end_ARG start_ARG 8 end_ARG × divide start_ARG italic_W end_ARG start_ARG 8 end_ARG × 8 italic_C end_POSTSUPERSCRIPT</annotation></semantics></math>. The encoder consists of multiple transformer blocks, and the decoder consists of CLIP-enhanced Transformer Blocks (CeTBs) (Sec <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S3.SS3" title="III-C CLIP-Enhanced Transformer Blocks (CeTBs) ‣ III PROPOSED METHOD ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-C</span></span></a>). Finally, DAP-LED employs a conv layer to generate the residual image <math alttext="\boldsymbol{R}\in\mathbb{R}^{H\times W\times 3}" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.1"><semantics id="S3.SS1.p1.12.m12.1a"><mrow id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml"><mi id="S3.SS1.p1.12.m12.1.1.2" xref="S3.SS1.p1.12.m12.1.1.2.cmml">𝑹</mi><mo id="S3.SS1.p1.12.m12.1.1.1" xref="S3.SS1.p1.12.m12.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.12.m12.1.1.3" xref="S3.SS1.p1.12.m12.1.1.3.cmml"><mi id="S3.SS1.p1.12.m12.1.1.3.2" xref="S3.SS1.p1.12.m12.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.12.m12.1.1.3.3" xref="S3.SS1.p1.12.m12.1.1.3.3.cmml"><mi id="S3.SS1.p1.12.m12.1.1.3.3.2" xref="S3.SS1.p1.12.m12.1.1.3.3.2.cmml">H</mi><mo id="S3.SS1.p1.12.m12.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.12.m12.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.12.m12.1.1.3.3.3" xref="S3.SS1.p1.12.m12.1.1.3.3.3.cmml">W</mi><mo id="S3.SS1.p1.12.m12.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.12.m12.1.1.3.3.1.cmml">×</mo><mn id="S3.SS1.p1.12.m12.1.1.3.3.4" xref="S3.SS1.p1.12.m12.1.1.3.3.4.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1"><in id="S3.SS1.p1.12.m12.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1.1"></in><ci id="S3.SS1.p1.12.m12.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2">𝑹</ci><apply id="S3.SS1.p1.12.m12.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.3.1.cmml" xref="S3.SS1.p1.12.m12.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.3.2.cmml" xref="S3.SS1.p1.12.m12.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.12.m12.1.1.3.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3.3"><times id="S3.SS1.p1.12.m12.1.1.3.3.1.cmml" xref="S3.SS1.p1.12.m12.1.1.3.3.1"></times><ci id="S3.SS1.p1.12.m12.1.1.3.3.2.cmml" xref="S3.SS1.p1.12.m12.1.1.3.3.2">𝐻</ci><ci id="S3.SS1.p1.12.m12.1.1.3.3.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3.3.3">𝑊</ci><cn id="S3.SS1.p1.12.m12.1.1.3.3.4.cmml" type="integer" xref="S3.SS1.p1.12.m12.1.1.3.3.4">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">\boldsymbol{R}\in\mathbb{R}^{H\times W\times 3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.1d">bold_italic_R ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W × 3 end_POSTSUPERSCRIPT</annotation></semantics></math> from <math alttext="\boldsymbol{F}_{latent}" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m13.1"><semantics id="S3.SS1.p1.13.m13.1a"><msub id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml"><mi id="S3.SS1.p1.13.m13.1.1.2" xref="S3.SS1.p1.13.m13.1.1.2.cmml">𝑭</mi><mrow id="S3.SS1.p1.13.m13.1.1.3" xref="S3.SS1.p1.13.m13.1.1.3.cmml"><mi id="S3.SS1.p1.13.m13.1.1.3.2" xref="S3.SS1.p1.13.m13.1.1.3.2.cmml">l</mi><mo id="S3.SS1.p1.13.m13.1.1.3.1" xref="S3.SS1.p1.13.m13.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.13.m13.1.1.3.3" xref="S3.SS1.p1.13.m13.1.1.3.3.cmml">a</mi><mo id="S3.SS1.p1.13.m13.1.1.3.1a" xref="S3.SS1.p1.13.m13.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.13.m13.1.1.3.4" xref="S3.SS1.p1.13.m13.1.1.3.4.cmml">t</mi><mo id="S3.SS1.p1.13.m13.1.1.3.1b" xref="S3.SS1.p1.13.m13.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.13.m13.1.1.3.5" xref="S3.SS1.p1.13.m13.1.1.3.5.cmml">e</mi><mo id="S3.SS1.p1.13.m13.1.1.3.1c" xref="S3.SS1.p1.13.m13.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.13.m13.1.1.3.6" xref="S3.SS1.p1.13.m13.1.1.3.6.cmml">n</mi><mo id="S3.SS1.p1.13.m13.1.1.3.1d" xref="S3.SS1.p1.13.m13.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.13.m13.1.1.3.7" xref="S3.SS1.p1.13.m13.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><apply id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2">𝑭</ci><apply id="S3.SS1.p1.13.m13.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3"><times id="S3.SS1.p1.13.m13.1.1.3.1.cmml" xref="S3.SS1.p1.13.m13.1.1.3.1"></times><ci id="S3.SS1.p1.13.m13.1.1.3.2.cmml" xref="S3.SS1.p1.13.m13.1.1.3.2">𝑙</ci><ci id="S3.SS1.p1.13.m13.1.1.3.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3.3">𝑎</ci><ci id="S3.SS1.p1.13.m13.1.1.3.4.cmml" xref="S3.SS1.p1.13.m13.1.1.3.4">𝑡</ci><ci id="S3.SS1.p1.13.m13.1.1.3.5.cmml" xref="S3.SS1.p1.13.m13.1.1.3.5">𝑒</ci><ci id="S3.SS1.p1.13.m13.1.1.3.6.cmml" xref="S3.SS1.p1.13.m13.1.1.3.6">𝑛</ci><ci id="S3.SS1.p1.13.m13.1.1.3.7.cmml" xref="S3.SS1.p1.13.m13.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">\boldsymbol{F}_{latent}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m13.1d">bold_italic_F start_POSTSUBSCRIPT italic_l italic_a italic_t italic_e italic_n italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. The restored image is then obtained by adding the degraded image to the residual, <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.14.2">i.e.</span>, <math alttext="\boldsymbol{\hat{I}}=\boldsymbol{I}+\boldsymbol{R}" class="ltx_Math" display="inline" id="S3.SS1.p1.14.m14.1"><semantics id="S3.SS1.p1.14.m14.1a"><mrow id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml"><mover accent="true" id="S3.SS1.p1.14.m14.1.1.2" xref="S3.SS1.p1.14.m14.1.1.2.cmml"><mi id="S3.SS1.p1.14.m14.1.1.2.2" xref="S3.SS1.p1.14.m14.1.1.2.2.cmml">𝑰</mi><mo class="ltx_mathvariant_bold" id="S3.SS1.p1.14.m14.1.1.2.1" mathvariant="bold" xref="S3.SS1.p1.14.m14.1.1.2.1.cmml">^</mo></mover><mo id="S3.SS1.p1.14.m14.1.1.1" xref="S3.SS1.p1.14.m14.1.1.1.cmml">=</mo><mrow id="S3.SS1.p1.14.m14.1.1.3" xref="S3.SS1.p1.14.m14.1.1.3.cmml"><mi id="S3.SS1.p1.14.m14.1.1.3.2" xref="S3.SS1.p1.14.m14.1.1.3.2.cmml">𝑰</mi><mo id="S3.SS1.p1.14.m14.1.1.3.1" xref="S3.SS1.p1.14.m14.1.1.3.1.cmml">+</mo><mi id="S3.SS1.p1.14.m14.1.1.3.3" xref="S3.SS1.p1.14.m14.1.1.3.3.cmml">𝑹</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b"><apply id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1"><eq id="S3.SS1.p1.14.m14.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1"></eq><apply id="S3.SS1.p1.14.m14.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.2"><ci id="S3.SS1.p1.14.m14.1.1.2.1.cmml" xref="S3.SS1.p1.14.m14.1.1.2.1">bold-^</ci><ci id="S3.SS1.p1.14.m14.1.1.2.2.cmml" xref="S3.SS1.p1.14.m14.1.1.2.2">𝑰</ci></apply><apply id="S3.SS1.p1.14.m14.1.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3"><plus id="S3.SS1.p1.14.m14.1.1.3.1.cmml" xref="S3.SS1.p1.14.m14.1.1.3.1"></plus><ci id="S3.SS1.p1.14.m14.1.1.3.2.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2">𝑰</ci><ci id="S3.SS1.p1.14.m14.1.1.3.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3.3">𝑹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">\boldsymbol{\hat{I}}=\boldsymbol{I}+\boldsymbol{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.14.m14.1d">overbold_^ start_ARG bold_italic_I end_ARG = bold_italic_I + bold_italic_R</annotation></semantics></math>. Now, let’s describe the details of CCM and CeTBs.</p>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="959" id="S3.F4.g1" src="x4.png" width="664"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span class="ltx_text ltx_font_bold" id="S3.F4.2.1">Overview of CCM</span>. Here is a visualization of the patch-wise similarity weights between the image and text embeddings. The heatmap on the bottom right shows the model’s joint perception of low-light and blur, as well as single perceptions of low-light and blur individually.</figcaption>
</figure>
<figure class="ltx_figure" id="S3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="257" id="S3.F5.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Visual quality comparison on the LOL-Blur dataset. Please check the zoom-in patches to observe the details.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS2.5.1.1">III-B</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS2.6.2">CLIP-guided Cross-fusion Module (CCM)</span>
</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.4">The CLIP-guided Cross-fusion Module (CCM) plays a pivotal role in leveraging CLIP to jointly perceive and learn the low-light and blur characteristics of images. As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S3.F4" title="Figure 4 ‣ III-A Overall Pipeline ‣ III PROPOSED METHOD ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag">4</span></a>, the module begins by passing the input image <math alttext="\boldsymbol{I}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">𝑰</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑰</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\boldsymbol{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">bold_italic_I</annotation></semantics></math> through the CLIP image encoder <math alttext="\operatorname{\mathbf{E}_{i}}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">𝐄</mi><mi id="S3.SS2.p1.2.m2.1.1.3" mathvariant="normal" xref="S3.SS2.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝐄</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">i</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\operatorname{\mathbf{E}_{i}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">bold_E start_POSTSUBSCRIPT roman_i end_POSTSUBSCRIPT</annotation></semantics></math>, where it is split into <math alttext="16\times 16" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mn id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">16</mn><mo id="S3.SS2.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.3.m3.1.1.1.cmml">×</mo><mn id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><times id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1"></times><cn id="S3.SS2.p1.3.m3.1.1.2.cmml" type="integer" xref="S3.SS2.p1.3.m3.1.1.2">16</cn><cn id="S3.SS2.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.SS2.p1.3.m3.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">16\times 16</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">16 × 16</annotation></semantics></math> patch-wise image tokens without using the [CLS] token. Simultaneously, a set of predefined text prompts, such as “<span class="ltx_text ltx_font_italic" id="S3.SS2.p1.4.1">This is a low-light and blurry image</span>.” are processed through the CLIP text encoder <math alttext="\operatorname{\mathbf{E}_{t}}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">𝐄</mi><mi id="S3.SS2.p1.4.m4.1.1.3" mathvariant="normal" xref="S3.SS2.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝐄</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">t</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\operatorname{\mathbf{E}_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">bold_E start_POSTSUBSCRIPT roman_t end_POSTSUBSCRIPT</annotation></semantics></math>, which generates text embeddings representing these specific degradations.
Next, the image embeddings and text embeddings are fused to compute patch-wise similarity weights. These weights are utilized to generate degradation-level heatmaps, which visually represent the contribution of each patch to the overall perception of joint degradation. The heatmap highlights the spatial regions of the image that are most affected by degradations, allowing the model to focus on relevant areas for adaptive enhancement. This process is summarized as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\boldsymbol{F}_{weight}=\operatorname{\boldsymbol{F}_{in}}\odot[\operatorname{%
\mathbf{E}_{i}}({\boldsymbol{F}_{in}})*\operatorname{\mathbf{E}_{t}}(prompt)],\\
" class="ltx_Math" display="block" id="S3.E1.m1.3"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><msub id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.3.2" xref="S3.E1.m1.3.3.1.1.3.2.cmml">𝑭</mi><mrow id="S3.E1.m1.3.3.1.1.3.3" xref="S3.E1.m1.3.3.1.1.3.3.cmml"><mi id="S3.E1.m1.3.3.1.1.3.3.2" xref="S3.E1.m1.3.3.1.1.3.3.2.cmml">w</mi><mo id="S3.E1.m1.3.3.1.1.3.3.1" xref="S3.E1.m1.3.3.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.3.3.3" xref="S3.E1.m1.3.3.1.1.3.3.3.cmml">e</mi><mo id="S3.E1.m1.3.3.1.1.3.3.1a" xref="S3.E1.m1.3.3.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.3.3.4" xref="S3.E1.m1.3.3.1.1.3.3.4.cmml">i</mi><mo id="S3.E1.m1.3.3.1.1.3.3.1b" xref="S3.E1.m1.3.3.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.3.3.5" xref="S3.E1.m1.3.3.1.1.3.3.5.cmml">g</mi><mo id="S3.E1.m1.3.3.1.1.3.3.1c" xref="S3.E1.m1.3.3.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.3.3.6" xref="S3.E1.m1.3.3.1.1.3.3.6.cmml">h</mi><mo id="S3.E1.m1.3.3.1.1.3.3.1d" xref="S3.E1.m1.3.3.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.3.3.7" xref="S3.E1.m1.3.3.1.1.3.3.7.cmml">t</mi></mrow></msub><mo id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml"><msub id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.3.2.cmml">𝐅</mi><mi id="S3.E1.m1.3.3.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.3.3.cmml">in</mi></msub><mo id="S3.E1.m1.3.3.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.E1.m1.3.3.1.1.1.2.cmml">⊙</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><mi id="S3.E1.m1.1.1.2" xref="S3.E1.m1.1.1.2.cmml">𝐄</mi><mi id="S3.E1.m1.1.1.3" mathvariant="normal" xref="S3.E1.m1.1.1.3.cmml">i</mi></msub><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1a" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">𝑭</mi><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml">n</mi></mrow></msub><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.3" rspace="0.222em" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml">∗</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.cmml"><msub id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml"><mi id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.2.cmml">𝐄</mi><mi id="S3.E1.m1.2.2.3" mathvariant="normal" xref="S3.E1.m1.2.2.3.cmml">t</mi></msub><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1a" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.cmml">⁡</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.cmml">p</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.cmml">r</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.1a" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.4" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.4.cmml">o</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.1b" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.5" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.5.cmml">m</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.1c" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.6" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.6.cmml">p</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.1d" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.7" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.7.cmml">t</mi></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2"></eq><apply id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2">𝑭</ci><apply id="S3.E1.m1.3.3.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.3.3"><times id="S3.E1.m1.3.3.1.1.3.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3.3.1"></times><ci id="S3.E1.m1.3.3.1.1.3.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.3.2">𝑤</ci><ci id="S3.E1.m1.3.3.1.1.3.3.3.cmml" xref="S3.E1.m1.3.3.1.1.3.3.3">𝑒</ci><ci id="S3.E1.m1.3.3.1.1.3.3.4.cmml" xref="S3.E1.m1.3.3.1.1.3.3.4">𝑖</ci><ci id="S3.E1.m1.3.3.1.1.3.3.5.cmml" xref="S3.E1.m1.3.3.1.1.3.3.5">𝑔</ci><ci id="S3.E1.m1.3.3.1.1.3.3.6.cmml" xref="S3.E1.m1.3.3.1.1.3.3.6">ℎ</ci><ci id="S3.E1.m1.3.3.1.1.3.3.7.cmml" xref="S3.E1.m1.3.3.1.1.3.3.7">𝑡</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2">direct-product</csymbol><apply id="S3.E1.m1.3.3.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.3.2">𝐅</ci><ci id="S3.E1.m1.3.3.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3.3">in</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3"></times><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1"><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2">𝐄</ci><ci id="S3.E1.m1.1.1.3.cmml" xref="S3.E1.m1.1.1.3">i</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">𝑭</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3">𝑛</ci></apply></apply></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1"><apply id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.cmml" xref="S3.E1.m1.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.2.cmml" xref="S3.E1.m1.2.2.2">𝐄</ci><ci id="S3.E1.m1.2.2.3.cmml" xref="S3.E1.m1.2.2.3">t</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.1"></times><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.2">𝑝</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.3">𝑟</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.4">𝑜</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.5.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.5">𝑚</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.6.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.6">𝑝</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.7.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.1.1.7">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\boldsymbol{F}_{weight}=\operatorname{\boldsymbol{F}_{in}}\odot[\operatorname{%
\mathbf{E}_{i}}({\boldsymbol{F}_{in}})*\operatorname{\mathbf{E}_{t}}(prompt)],\\
</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.3d">bold_italic_F start_POSTSUBSCRIPT italic_w italic_e italic_i italic_g italic_h italic_t end_POSTSUBSCRIPT = start_OPFUNCTION bold_F start_POSTSUBSCRIPT roman_in end_POSTSUBSCRIPT end_OPFUNCTION ⊙ [ start_OPFUNCTION bold_E start_POSTSUBSCRIPT roman_i end_POSTSUBSCRIPT end_OPFUNCTION ( bold_italic_F start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT ) ∗ start_OPFUNCTION bold_E start_POSTSUBSCRIPT roman_t end_POSTSUBSCRIPT end_OPFUNCTION ( italic_p italic_r italic_o italic_m italic_p italic_t ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.9">where <math alttext="\boldsymbol{F}_{weight}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m1.1"><semantics id="S3.SS2.p1.5.m1.1a"><msub id="S3.SS2.p1.5.m1.1.1" xref="S3.SS2.p1.5.m1.1.1.cmml"><mi id="S3.SS2.p1.5.m1.1.1.2" xref="S3.SS2.p1.5.m1.1.1.2.cmml">𝑭</mi><mrow id="S3.SS2.p1.5.m1.1.1.3" xref="S3.SS2.p1.5.m1.1.1.3.cmml"><mi id="S3.SS2.p1.5.m1.1.1.3.2" xref="S3.SS2.p1.5.m1.1.1.3.2.cmml">w</mi><mo id="S3.SS2.p1.5.m1.1.1.3.1" xref="S3.SS2.p1.5.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.5.m1.1.1.3.3" xref="S3.SS2.p1.5.m1.1.1.3.3.cmml">e</mi><mo id="S3.SS2.p1.5.m1.1.1.3.1a" xref="S3.SS2.p1.5.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.5.m1.1.1.3.4" xref="S3.SS2.p1.5.m1.1.1.3.4.cmml">i</mi><mo id="S3.SS2.p1.5.m1.1.1.3.1b" xref="S3.SS2.p1.5.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.5.m1.1.1.3.5" xref="S3.SS2.p1.5.m1.1.1.3.5.cmml">g</mi><mo id="S3.SS2.p1.5.m1.1.1.3.1c" xref="S3.SS2.p1.5.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.5.m1.1.1.3.6" xref="S3.SS2.p1.5.m1.1.1.3.6.cmml">h</mi><mo id="S3.SS2.p1.5.m1.1.1.3.1d" xref="S3.SS2.p1.5.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.5.m1.1.1.3.7" xref="S3.SS2.p1.5.m1.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m1.1b"><apply id="S3.SS2.p1.5.m1.1.1.cmml" xref="S3.SS2.p1.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m1.1.1.1.cmml" xref="S3.SS2.p1.5.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m1.1.1.2.cmml" xref="S3.SS2.p1.5.m1.1.1.2">𝑭</ci><apply id="S3.SS2.p1.5.m1.1.1.3.cmml" xref="S3.SS2.p1.5.m1.1.1.3"><times id="S3.SS2.p1.5.m1.1.1.3.1.cmml" xref="S3.SS2.p1.5.m1.1.1.3.1"></times><ci id="S3.SS2.p1.5.m1.1.1.3.2.cmml" xref="S3.SS2.p1.5.m1.1.1.3.2">𝑤</ci><ci id="S3.SS2.p1.5.m1.1.1.3.3.cmml" xref="S3.SS2.p1.5.m1.1.1.3.3">𝑒</ci><ci id="S3.SS2.p1.5.m1.1.1.3.4.cmml" xref="S3.SS2.p1.5.m1.1.1.3.4">𝑖</ci><ci id="S3.SS2.p1.5.m1.1.1.3.5.cmml" xref="S3.SS2.p1.5.m1.1.1.3.5">𝑔</ci><ci id="S3.SS2.p1.5.m1.1.1.3.6.cmml" xref="S3.SS2.p1.5.m1.1.1.3.6">ℎ</ci><ci id="S3.SS2.p1.5.m1.1.1.3.7.cmml" xref="S3.SS2.p1.5.m1.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m1.1c">\boldsymbol{F}_{weight}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m1.1d">bold_italic_F start_POSTSUBSCRIPT italic_w italic_e italic_i italic_g italic_h italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is intermediate results of clip enchanced image, <math alttext="\odot" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m2.1"><semantics id="S3.SS2.p1.6.m2.1a"><mo id="S3.SS2.p1.6.m2.1.1" xref="S3.SS2.p1.6.m2.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m2.1b"><csymbol cd="latexml" id="S3.SS2.p1.6.m2.1.1.cmml" xref="S3.SS2.p1.6.m2.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m2.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m2.1d">⊙</annotation></semantics></math> denotes patch-wise multiplication, <math alttext="*" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m3.1"><semantics id="S3.SS2.p1.7.m3.1a"><mo id="S3.SS2.p1.7.m3.1.1" xref="S3.SS2.p1.7.m3.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m3.1b"><times id="S3.SS2.p1.7.m3.1.1.cmml" xref="S3.SS2.p1.7.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m3.1c">*</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m3.1d">∗</annotation></semantics></math> denotes matrix multiplication, <math alttext="\mathbf{E}_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m4.1"><semantics id="S3.SS2.p1.8.m4.1a"><msub id="S3.SS2.p1.8.m4.1.1" xref="S3.SS2.p1.8.m4.1.1.cmml"><mi id="S3.SS2.p1.8.m4.1.1.2" xref="S3.SS2.p1.8.m4.1.1.2.cmml">𝐄</mi><mi id="S3.SS2.p1.8.m4.1.1.3" xref="S3.SS2.p1.8.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m4.1b"><apply id="S3.SS2.p1.8.m4.1.1.cmml" xref="S3.SS2.p1.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m4.1.1.1.cmml" xref="S3.SS2.p1.8.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.8.m4.1.1.2.cmml" xref="S3.SS2.p1.8.m4.1.1.2">𝐄</ci><ci id="S3.SS2.p1.8.m4.1.1.3.cmml" xref="S3.SS2.p1.8.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m4.1c">\mathbf{E}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m4.1d">bold_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is CLIP image encoder without pooling, <math alttext="\mathbf{E}_{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m5.1"><semantics id="S3.SS2.p1.9.m5.1a"><msub id="S3.SS2.p1.9.m5.1.1" xref="S3.SS2.p1.9.m5.1.1.cmml"><mi id="S3.SS2.p1.9.m5.1.1.2" xref="S3.SS2.p1.9.m5.1.1.2.cmml">𝐄</mi><mi id="S3.SS2.p1.9.m5.1.1.3" xref="S3.SS2.p1.9.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m5.1b"><apply id="S3.SS2.p1.9.m5.1.1.cmml" xref="S3.SS2.p1.9.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m5.1.1.1.cmml" xref="S3.SS2.p1.9.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.9.m5.1.1.2.cmml" xref="S3.SS2.p1.9.m5.1.1.2">𝐄</ci><ci id="S3.SS2.p1.9.m5.1.1.3.cmml" xref="S3.SS2.p1.9.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m5.1c">\mathbf{E}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m5.1d">bold_E start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is CLIP text encoder.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS3.5.1.1">III-C</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS3.6.2">CLIP-Enhanced Transformer Blocks (CeTBs)</span>
</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S2.F3" title="Figure 3 ‣ II RELATED WORK ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag">3</span></a>, these blocks are designed to facilitate multi-scale joint-degradation feature learning in that each type of image degradation exhibits distinct perturbed patterns <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib19" title="">19</a>]</cite>. Previous studies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib19" title="">19</a>]</cite> have shown that incorporating multi-scale noise components into feature maps can significantly improve a model’s ability to handle diverse disturbances, enhancing the recovery of detailed information from degraded images. However, using uncontrollable noise terms in image restoration tasks can be problematic, as it introduces randomness, making it difficult to regulate the finer details of the recovered image <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib32" title="">32</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.5">To address this issue, we integrate degradation-aware CLIP priors at each level of the decoder, analogous to controllable noise elements. The CeTB is based on the Transformer block <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib21" title="">21</a>]</cite> but with a key distinction: incorporating joint degradation-aware CLIP priors within the attention mechanism. This results in an updated formulation of the CLIP Enhanced Attention:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx1">
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\hat{\boldsymbol{F}}_{in}=\boldsymbol{F}_{in}+\operatorname{%
Modulation}(\boldsymbol{F}_{c})," class="ltx_Math" display="inline" id="S3.E2.m1.2"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2.1" xref="S3.E2.m1.2.2.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml"><msub id="S3.E2.m1.2.2.1.1.3" xref="S3.E2.m1.2.2.1.1.3.cmml"><mover accent="true" id="S3.E2.m1.2.2.1.1.3.2" xref="S3.E2.m1.2.2.1.1.3.2.cmml"><mi id="S3.E2.m1.2.2.1.1.3.2.2" xref="S3.E2.m1.2.2.1.1.3.2.2.cmml">𝑭</mi><mo id="S3.E2.m1.2.2.1.1.3.2.1" xref="S3.E2.m1.2.2.1.1.3.2.1.cmml">^</mo></mover><mrow id="S3.E2.m1.2.2.1.1.3.3" xref="S3.E2.m1.2.2.1.1.3.3.cmml"><mi id="S3.E2.m1.2.2.1.1.3.3.2" xref="S3.E2.m1.2.2.1.1.3.3.2.cmml">i</mi><mo id="S3.E2.m1.2.2.1.1.3.3.1" xref="S3.E2.m1.2.2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E2.m1.2.2.1.1.3.3.3" xref="S3.E2.m1.2.2.1.1.3.3.3.cmml">n</mi></mrow></msub><mo id="S3.E2.m1.2.2.1.1.2" xref="S3.E2.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.cmml"><msub id="S3.E2.m1.2.2.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.1.3.2.cmml">𝑭</mi><mrow id="S3.E2.m1.2.2.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.1.3.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.3.3.2" xref="S3.E2.m1.2.2.1.1.1.3.3.2.cmml">i</mi><mo id="S3.E2.m1.2.2.1.1.1.3.3.1" xref="S3.E2.m1.2.2.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E2.m1.2.2.1.1.1.3.3.3" xref="S3.E2.m1.2.2.1.1.1.3.3.3.cmml">n</mi></mrow></msub><mo id="S3.E2.m1.2.2.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.2.cmml">+</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml"><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">Modulation</mi><mo id="S3.E2.m1.2.2.1.1.1.1.1a" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml">(</mo><msub id="S3.E2.m1.2.2.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.cmml">𝑭</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.2.2.1.2" xref="S3.E2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1"><eq id="S3.E2.m1.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.2"></eq><apply id="S3.E2.m1.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3">subscript</csymbol><apply id="S3.E2.m1.2.2.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2"><ci id="S3.E2.m1.2.2.1.1.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.3.2.1">^</ci><ci id="S3.E2.m1.2.2.1.1.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2">𝑭</ci></apply><apply id="S3.E2.m1.2.2.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.3.3"><times id="S3.E2.m1.2.2.1.1.3.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3.3.1"></times><ci id="S3.E2.m1.2.2.1.1.3.3.2.cmml" xref="S3.E2.m1.2.2.1.1.3.3.2">𝑖</ci><ci id="S3.E2.m1.2.2.1.1.3.3.3.cmml" xref="S3.E2.m1.2.2.1.1.3.3.3">𝑛</ci></apply></apply><apply id="S3.E2.m1.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1"><plus id="S3.E2.m1.2.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.2"></plus><apply id="S3.E2.m1.2.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.3.2">𝑭</ci><apply id="S3.E2.m1.2.2.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.3.3"><times id="S3.E2.m1.2.2.1.1.1.3.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.3.3.1"></times><ci id="S3.E2.m1.2.2.1.1.1.3.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.3.3.2">𝑖</ci><ci id="S3.E2.m1.2.2.1.1.1.3.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.3.3.3">𝑛</ci></apply></apply><apply id="S3.E2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">Modulation</ci><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2">𝑭</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">\displaystyle\hat{\boldsymbol{F}}_{in}=\boldsymbol{F}_{in}+\operatorname{%
Modulation}(\boldsymbol{F}_{c}),</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.2d">over^ start_ARG bold_italic_F end_ARG start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT = bold_italic_F start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT + roman_Modulation ( bold_italic_F start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\boldsymbol{F}_{out}=\operatorname{Attn}(W_{p}^{Q}\hat{%
\boldsymbol{F}}_{in},W_{p}^{K}\hat{\boldsymbol{F}}_{in},W_{p}^{V}\hat{%
\boldsymbol{F}}_{in})+\boldsymbol{F}_{in}," class="ltx_Math" display="inline" id="S3.E3.m1.2"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml"><msub id="S3.E3.m1.2.2.1.1.5" xref="S3.E3.m1.2.2.1.1.5.cmml"><mi id="S3.E3.m1.2.2.1.1.5.2" xref="S3.E3.m1.2.2.1.1.5.2.cmml">𝑭</mi><mrow id="S3.E3.m1.2.2.1.1.5.3" xref="S3.E3.m1.2.2.1.1.5.3.cmml"><mi id="S3.E3.m1.2.2.1.1.5.3.2" xref="S3.E3.m1.2.2.1.1.5.3.2.cmml">o</mi><mo id="S3.E3.m1.2.2.1.1.5.3.1" xref="S3.E3.m1.2.2.1.1.5.3.1.cmml">⁢</mo><mi id="S3.E3.m1.2.2.1.1.5.3.3" xref="S3.E3.m1.2.2.1.1.5.3.3.cmml">u</mi><mo id="S3.E3.m1.2.2.1.1.5.3.1a" xref="S3.E3.m1.2.2.1.1.5.3.1.cmml">⁢</mo><mi id="S3.E3.m1.2.2.1.1.5.3.4" xref="S3.E3.m1.2.2.1.1.5.3.4.cmml">t</mi></mrow></msub><mo id="S3.E3.m1.2.2.1.1.4" xref="S3.E3.m1.2.2.1.1.4.cmml">=</mo><mrow id="S3.E3.m1.2.2.1.1.3" xref="S3.E3.m1.2.2.1.1.3.cmml"><mrow id="S3.E3.m1.2.2.1.1.3.3.3" xref="S3.E3.m1.2.2.1.1.3.3.4.cmml"><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">Attn</mi><mo id="S3.E3.m1.2.2.1.1.3.3.3a" xref="S3.E3.m1.2.2.1.1.3.3.4.cmml">⁡</mo><mrow id="S3.E3.m1.2.2.1.1.3.3.3.3" xref="S3.E3.m1.2.2.1.1.3.3.4.cmml"><mo id="S3.E3.m1.2.2.1.1.3.3.3.3.4" stretchy="false" xref="S3.E3.m1.2.2.1.1.3.3.4.cmml">(</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml">p</mi><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">Q</mi></msubsup><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2.cmml">𝑭</mi><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.2.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mrow id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.3.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.3.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.3.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.3.3.cmml">n</mi></mrow></msub></mrow><mo id="S3.E3.m1.2.2.1.1.3.3.3.3.5" xref="S3.E3.m1.2.2.1.1.3.3.4.cmml">,</mo><mrow id="S3.E3.m1.2.2.1.1.2.2.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.cmml"><msubsup id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.2.cmml">W</mi><mi id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.3" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.3.cmml">p</mi><mi id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.3" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.3.cmml">K</mi></msubsup><mo id="S3.E3.m1.2.2.1.1.2.2.2.2.2.1" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.1.cmml">⁢</mo><msub id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.cmml"><mover accent="true" id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.2.cmml"><mi id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.2.2.cmml">𝑭</mi><mo id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.2.1" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.2.1.cmml">^</mo></mover><mrow id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.3" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.3.cmml"><mi id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.3.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.3.2.cmml">i</mi><mo id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.3.1" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.3.1.cmml">⁢</mo><mi id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.3.3" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.3.3.cmml">n</mi></mrow></msub></mrow><mo id="S3.E3.m1.2.2.1.1.3.3.3.3.6" xref="S3.E3.m1.2.2.1.1.3.3.4.cmml">,</mo><mrow id="S3.E3.m1.2.2.1.1.3.3.3.3.3" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.cmml"><msubsup id="S3.E3.m1.2.2.1.1.3.3.3.3.3.2" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.2.cmml"><mi id="S3.E3.m1.2.2.1.1.3.3.3.3.3.2.2.2" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.2.2.2.cmml">W</mi><mi id="S3.E3.m1.2.2.1.1.3.3.3.3.3.2.2.3" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.2.2.3.cmml">p</mi><mi id="S3.E3.m1.2.2.1.1.3.3.3.3.3.2.3" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.2.3.cmml">V</mi></msubsup><mo id="S3.E3.m1.2.2.1.1.3.3.3.3.3.1" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.1.cmml">⁢</mo><msub id="S3.E3.m1.2.2.1.1.3.3.3.3.3.3" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.cmml"><mover accent="true" id="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.2" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.2.cmml"><mi id="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.2.2" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.2.2.cmml">𝑭</mi><mo id="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.2.1" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.2.1.cmml">^</mo></mover><mrow id="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.3" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.3.cmml"><mi id="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.3.2" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.3.2.cmml">i</mi><mo id="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.3.1" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.3.3" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.3.3.cmml">n</mi></mrow></msub></mrow><mo id="S3.E3.m1.2.2.1.1.3.3.3.3.7" stretchy="false" xref="S3.E3.m1.2.2.1.1.3.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.2.2.1.1.3.4" xref="S3.E3.m1.2.2.1.1.3.4.cmml">+</mo><msub id="S3.E3.m1.2.2.1.1.3.5" xref="S3.E3.m1.2.2.1.1.3.5.cmml"><mi id="S3.E3.m1.2.2.1.1.3.5.2" xref="S3.E3.m1.2.2.1.1.3.5.2.cmml">𝑭</mi><mrow id="S3.E3.m1.2.2.1.1.3.5.3" xref="S3.E3.m1.2.2.1.1.3.5.3.cmml"><mi id="S3.E3.m1.2.2.1.1.3.5.3.2" xref="S3.E3.m1.2.2.1.1.3.5.3.2.cmml">i</mi><mo id="S3.E3.m1.2.2.1.1.3.5.3.1" xref="S3.E3.m1.2.2.1.1.3.5.3.1.cmml">⁢</mo><mi id="S3.E3.m1.2.2.1.1.3.5.3.3" xref="S3.E3.m1.2.2.1.1.3.5.3.3.cmml">n</mi></mrow></msub></mrow></mrow><mo id="S3.E3.m1.2.2.1.2" xref="S3.E3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1"><eq id="S3.E3.m1.2.2.1.1.4.cmml" xref="S3.E3.m1.2.2.1.1.4"></eq><apply id="S3.E3.m1.2.2.1.1.5.cmml" xref="S3.E3.m1.2.2.1.1.5"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.5.1.cmml" xref="S3.E3.m1.2.2.1.1.5">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.5.2.cmml" xref="S3.E3.m1.2.2.1.1.5.2">𝑭</ci><apply id="S3.E3.m1.2.2.1.1.5.3.cmml" xref="S3.E3.m1.2.2.1.1.5.3"><times id="S3.E3.m1.2.2.1.1.5.3.1.cmml" xref="S3.E3.m1.2.2.1.1.5.3.1"></times><ci id="S3.E3.m1.2.2.1.1.5.3.2.cmml" xref="S3.E3.m1.2.2.1.1.5.3.2">𝑜</ci><ci id="S3.E3.m1.2.2.1.1.5.3.3.cmml" xref="S3.E3.m1.2.2.1.1.5.3.3">𝑢</ci><ci id="S3.E3.m1.2.2.1.1.5.3.4.cmml" xref="S3.E3.m1.2.2.1.1.5.3.4">𝑡</ci></apply></apply><apply id="S3.E3.m1.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.3"><plus id="S3.E3.m1.2.2.1.1.3.4.cmml" xref="S3.E3.m1.2.2.1.1.3.4"></plus><apply id="S3.E3.m1.2.2.1.1.3.3.4.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3"><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">Attn</ci><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1"><times id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1"></times><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.3">𝑝</ci></apply><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3">𝑄</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.2"><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2">𝑭</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.3"><times id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.3.3">𝑛</ci></apply></apply></apply><apply id="S3.E3.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2"><times id="S3.E3.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.1"></times><apply id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2">superscript</csymbol><apply id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.2">𝑊</ci><ci id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.3">𝑝</ci></apply><ci id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.3">𝐾</ci></apply><apply id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3">subscript</csymbol><apply id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.2"><ci id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.2.1">^</ci><ci id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.2.2">𝑭</ci></apply><apply id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.3"><times id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.3.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.3.1"></times><ci id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.3.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.3.2">𝑖</ci><ci id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.3.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.3.3">𝑛</ci></apply></apply></apply><apply id="S3.E3.m1.2.2.1.1.3.3.3.3.3.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3"><times id="S3.E3.m1.2.2.1.1.3.3.3.3.3.1.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.1"></times><apply id="S3.E3.m1.2.2.1.1.3.3.3.3.3.2.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.3.3.3.3.3.2.1.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.2">superscript</csymbol><apply id="S3.E3.m1.2.2.1.1.3.3.3.3.3.2.2.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.3.3.3.3.3.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.3.3.3.3.3.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.2.2.2">𝑊</ci><ci id="S3.E3.m1.2.2.1.1.3.3.3.3.3.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.2.2.3">𝑝</ci></apply><ci id="S3.E3.m1.2.2.1.1.3.3.3.3.3.2.3.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.2.3">𝑉</ci></apply><apply id="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.1.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.3">subscript</csymbol><apply id="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.2.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.2"><ci id="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.2.1.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.2.1">^</ci><ci id="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.2.2.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.2.2">𝑭</ci></apply><apply id="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.3.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.3"><times id="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.3.1.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.3.1"></times><ci id="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.3.2.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.3.2">𝑖</ci><ci id="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.3.3.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.3.3.3.3.3">𝑛</ci></apply></apply></apply></apply><apply id="S3.E3.m1.2.2.1.1.3.5.cmml" xref="S3.E3.m1.2.2.1.1.3.5"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.3.5.1.cmml" xref="S3.E3.m1.2.2.1.1.3.5">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.3.5.2.cmml" xref="S3.E3.m1.2.2.1.1.3.5.2">𝑭</ci><apply id="S3.E3.m1.2.2.1.1.3.5.3.cmml" xref="S3.E3.m1.2.2.1.1.3.5.3"><times id="S3.E3.m1.2.2.1.1.3.5.3.1.cmml" xref="S3.E3.m1.2.2.1.1.3.5.3.1"></times><ci id="S3.E3.m1.2.2.1.1.3.5.3.2.cmml" xref="S3.E3.m1.2.2.1.1.3.5.3.2">𝑖</ci><ci id="S3.E3.m1.2.2.1.1.3.5.3.3.cmml" xref="S3.E3.m1.2.2.1.1.3.5.3.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\displaystyle\boldsymbol{F}_{out}=\operatorname{Attn}(W_{p}^{Q}\hat{%
\boldsymbol{F}}_{in},W_{p}^{K}\hat{\boldsymbol{F}}_{in},W_{p}^{V}\hat{%
\boldsymbol{F}}_{in})+\boldsymbol{F}_{in},</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.2d">bold_italic_F start_POSTSUBSCRIPT italic_o italic_u italic_t end_POSTSUBSCRIPT = roman_Attn ( italic_W start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT over^ start_ARG bold_italic_F end_ARG start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT over^ start_ARG bold_italic_F end_ARG start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT over^ start_ARG bold_italic_F end_ARG start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT ) + bold_italic_F start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.4">where <math alttext="W_{p}^{Q}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><msubsup id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2.2" xref="S3.SS3.p2.1.m1.1.1.2.2.cmml">W</mi><mi id="S3.SS3.p2.1.m1.1.1.2.3" xref="S3.SS3.p2.1.m1.1.1.2.3.cmml">p</mi><mi id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">Q</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">superscript</csymbol><apply id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.2.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2.2">𝑊</ci><ci id="S3.SS3.p2.1.m1.1.1.2.3.cmml" xref="S3.SS3.p2.1.m1.1.1.2.3">𝑝</ci></apply><ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">W_{p}^{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">italic_W start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="W_{p}^{K}" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><msubsup id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2.2" xref="S3.SS3.p2.2.m2.1.1.2.2.cmml">W</mi><mi id="S3.SS3.p2.2.m2.1.1.2.3" xref="S3.SS3.p2.2.m2.1.1.2.3.cmml">p</mi><mi id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">superscript</csymbol><apply id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.2.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2.2">𝑊</ci><ci id="S3.SS3.p2.2.m2.1.1.2.3.cmml" xref="S3.SS3.p2.2.m2.1.1.2.3">𝑝</ci></apply><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">W_{p}^{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">italic_W start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="W_{p}^{V}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><msubsup id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2.2" xref="S3.SS3.p2.3.m3.1.1.2.2.cmml">W</mi><mi id="S3.SS3.p2.3.m3.1.1.2.3" xref="S3.SS3.p2.3.m3.1.1.2.3.cmml">p</mi><mi id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">V</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">superscript</csymbol><apply id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.2.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2.2">𝑊</ci><ci id="S3.SS3.p2.3.m3.1.1.2.3.cmml" xref="S3.SS3.p2.3.m3.1.1.2.3">𝑝</ci></apply><ci id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">W_{p}^{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">italic_W start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT</annotation></semantics></math> are projection matrices, and <math alttext="\operatorname{Attn}(\cdot)" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.2"><semantics id="S3.SS3.p2.4.m4.2a"><mrow id="S3.SS3.p2.4.m4.2.3.2" xref="S3.SS3.p2.4.m4.2.3.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">Attn</mi><mo id="S3.SS3.p2.4.m4.2.3.2a" xref="S3.SS3.p2.4.m4.2.3.1.cmml">⁡</mo><mrow id="S3.SS3.p2.4.m4.2.3.2.1" xref="S3.SS3.p2.4.m4.2.3.1.cmml"><mo id="S3.SS3.p2.4.m4.2.3.2.1.1" stretchy="false" xref="S3.SS3.p2.4.m4.2.3.1.cmml">(</mo><mo id="S3.SS3.p2.4.m4.2.2" lspace="0em" rspace="0em" xref="S3.SS3.p2.4.m4.2.2.cmml">⋅</mo><mo id="S3.SS3.p2.4.m4.2.3.2.1.2" stretchy="false" xref="S3.SS3.p2.4.m4.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.2b"><apply id="S3.SS3.p2.4.m4.2.3.1.cmml" xref="S3.SS3.p2.4.m4.2.3.2"><ci id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">Attn</ci><ci id="S3.SS3.p2.4.m4.2.2.cmml" xref="S3.SS3.p2.4.m4.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.2c">\operatorname{Attn}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.2d">roman_Attn ( ⋅ )</annotation></semantics></math> denotes the attention mechanism. By leveraging degradation-aware CLIP priors, the CeTB enhances the model’s ability to handle joint degradation patterns across different scales while maintaining control over the restoration process.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS4.5.1.1">III-D</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS4.6.2">Optimization</span>
</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">To eliminate the joint-degradation in the observed image, we utilize the Charbonnier loss as the basic reconstruction loss <math alttext="\mathbf{L}_{rec}" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><msub id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">𝐋</mi><mrow id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml"><mi id="S3.SS4.p1.1.m1.1.1.3.2" xref="S3.SS4.p1.1.m1.1.1.3.2.cmml">r</mi><mo id="S3.SS4.p1.1.m1.1.1.3.1" xref="S3.SS4.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.1.m1.1.1.3.3" xref="S3.SS4.p1.1.m1.1.1.3.3.cmml">e</mi><mo id="S3.SS4.p1.1.m1.1.1.3.1a" xref="S3.SS4.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.1.m1.1.1.3.4" xref="S3.SS4.p1.1.m1.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">𝐋</ci><apply id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3"><times id="S3.SS4.p1.1.m1.1.1.3.1.cmml" xref="S3.SS4.p1.1.m1.1.1.3.1"></times><ci id="S3.SS4.p1.1.m1.1.1.3.2.cmml" xref="S3.SS4.p1.1.m1.1.1.3.2">𝑟</ci><ci id="S3.SS4.p1.1.m1.1.1.3.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3">𝑒</ci><ci id="S3.SS4.p1.1.m1.1.1.3.4.cmml" xref="S3.SS4.p1.1.m1.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\mathbf{L}_{rec}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">bold_L start_POSTSUBSCRIPT italic_r italic_e italic_c end_POSTSUBSCRIPT</annotation></semantics></math> in the RGB color space, which can be denoted as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{L}_{rec}=\sqrt{\left\|\hat{\boldsymbol{I}}-\boldsymbol{I}\right\|^{2}+%
\epsilon^{2}}," class="ltx_Math" display="block" id="S3.E4.m1.2"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2.2.1" xref="S3.E4.m1.2.2.1.1.cmml"><mrow id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml"><msub id="S3.E4.m1.2.2.1.1.2" xref="S3.E4.m1.2.2.1.1.2.cmml"><mi id="S3.E4.m1.2.2.1.1.2.2" xref="S3.E4.m1.2.2.1.1.2.2.cmml">𝐋</mi><mrow id="S3.E4.m1.2.2.1.1.2.3" xref="S3.E4.m1.2.2.1.1.2.3.cmml"><mi id="S3.E4.m1.2.2.1.1.2.3.2" xref="S3.E4.m1.2.2.1.1.2.3.2.cmml">r</mi><mo id="S3.E4.m1.2.2.1.1.2.3.1" xref="S3.E4.m1.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.1.1.2.3.3" xref="S3.E4.m1.2.2.1.1.2.3.3.cmml">e</mi><mo id="S3.E4.m1.2.2.1.1.2.3.1a" xref="S3.E4.m1.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.1.1.2.3.4" xref="S3.E4.m1.2.2.1.1.2.3.4.cmml">c</mi></mrow></msub><mo id="S3.E4.m1.2.2.1.1.1" xref="S3.E4.m1.2.2.1.1.1.cmml">=</mo><msqrt id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml"><msup id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E4.m1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.1.1.1.2.2.cmml">𝑰</mi><mo id="S3.E4.m1.1.1.1.1.1.1.1.2.1" xref="S3.E4.m1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S3.E4.m1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E4.m1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.3.cmml">𝑰</mi></mrow><mo id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.2.cmml">+</mo><msup id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.3.2.cmml">ϵ</mi><mn id="S3.E4.m1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.3.3.cmml">2</mn></msup></mrow></msqrt></mrow><mo id="S3.E4.m1.2.2.1.2" xref="S3.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b"><apply id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1"><eq id="S3.E4.m1.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1"></eq><apply id="S3.E4.m1.2.2.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.2.1.cmml" xref="S3.E4.m1.2.2.1.1.2">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.2">𝐋</ci><apply id="S3.E4.m1.2.2.1.1.2.3.cmml" xref="S3.E4.m1.2.2.1.1.2.3"><times id="S3.E4.m1.2.2.1.1.2.3.1.cmml" xref="S3.E4.m1.2.2.1.1.2.3.1"></times><ci id="S3.E4.m1.2.2.1.1.2.3.2.cmml" xref="S3.E4.m1.2.2.1.1.2.3.2">𝑟</ci><ci id="S3.E4.m1.2.2.1.1.2.3.3.cmml" xref="S3.E4.m1.2.2.1.1.2.3.3">𝑒</ci><ci id="S3.E4.m1.2.2.1.1.2.3.4.cmml" xref="S3.E4.m1.2.2.1.1.2.3.4">𝑐</ci></apply></apply><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><root id="S3.E4.m1.1.1a.cmml" xref="S3.E4.m1.1.1"></root><apply id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><plus id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.2"></plus><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1"><minus id="S3.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E4.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.2"><ci id="S3.E4.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.2.2">𝑰</ci></apply><ci id="S3.E4.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3">𝑰</ci></apply></apply><cn id="S3.E4.m1.1.1.1.1.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.3">2</cn></apply><apply id="S3.E4.m1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.3">superscript</csymbol><ci id="S3.E4.m1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.3.2">italic-ϵ</ci><cn id="S3.E4.m1.1.1.1.3.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.2c">\mathbf{L}_{rec}=\sqrt{\left\|\hat{\boldsymbol{I}}-\boldsymbol{I}\right\|^{2}+%
\epsilon^{2}},</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.2d">bold_L start_POSTSUBSCRIPT italic_r italic_e italic_c end_POSTSUBSCRIPT = square-root start_ARG ∥ over^ start_ARG bold_italic_I end_ARG - bold_italic_I ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_ϵ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p1.7">where <math alttext="\mathbf{I}" class="ltx_Math" display="inline" id="S3.SS4.p1.2.m1.1"><semantics id="S3.SS4.p1.2.m1.1a"><mi id="S3.SS4.p1.2.m1.1.1" xref="S3.SS4.p1.2.m1.1.1.cmml">𝐈</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m1.1b"><ci id="S3.SS4.p1.2.m1.1.1.cmml" xref="S3.SS4.p1.2.m1.1.1">𝐈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m1.1c">\mathbf{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.2.m1.1d">bold_I</annotation></semantics></math> and <math alttext="\hat{\mathbf{I}}" class="ltx_Math" display="inline" id="S3.SS4.p1.3.m2.1"><semantics id="S3.SS4.p1.3.m2.1a"><mover accent="true" id="S3.SS4.p1.3.m2.1.1" xref="S3.SS4.p1.3.m2.1.1.cmml"><mi id="S3.SS4.p1.3.m2.1.1.2" xref="S3.SS4.p1.3.m2.1.1.2.cmml">𝐈</mi><mo id="S3.SS4.p1.3.m2.1.1.1" xref="S3.SS4.p1.3.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m2.1b"><apply id="S3.SS4.p1.3.m2.1.1.cmml" xref="S3.SS4.p1.3.m2.1.1"><ci id="S3.SS4.p1.3.m2.1.1.1.cmml" xref="S3.SS4.p1.3.m2.1.1.1">^</ci><ci id="S3.SS4.p1.3.m2.1.1.2.cmml" xref="S3.SS4.p1.3.m2.1.1.2">𝐈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m2.1c">\hat{\mathbf{I}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.3.m2.1d">over^ start_ARG bold_I end_ARG</annotation></semantics></math> represent the restored image and ground truth, respectively. <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS4.p1.4.m3.1"><semantics id="S3.SS4.p1.4.m3.1a"><mi id="S3.SS4.p1.4.m3.1.1" xref="S3.SS4.p1.4.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m3.1b"><ci id="S3.SS4.p1.4.m3.1.1.cmml" xref="S3.SS4.p1.4.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m3.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.4.m3.1d">italic_ϵ</annotation></semantics></math> is a constant. We also introduce the CLIP-aware loss to guide the restored result. The CLIP-aware loss comprises two components: the identity loss <math alttext="\mathbf{L}_{identity}" class="ltx_Math" display="inline" id="S3.SS4.p1.5.m4.1"><semantics id="S3.SS4.p1.5.m4.1a"><msub id="S3.SS4.p1.5.m4.1.1" xref="S3.SS4.p1.5.m4.1.1.cmml"><mi id="S3.SS4.p1.5.m4.1.1.2" xref="S3.SS4.p1.5.m4.1.1.2.cmml">𝐋</mi><mrow id="S3.SS4.p1.5.m4.1.1.3" xref="S3.SS4.p1.5.m4.1.1.3.cmml"><mi id="S3.SS4.p1.5.m4.1.1.3.2" xref="S3.SS4.p1.5.m4.1.1.3.2.cmml">i</mi><mo id="S3.SS4.p1.5.m4.1.1.3.1" xref="S3.SS4.p1.5.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.5.m4.1.1.3.3" xref="S3.SS4.p1.5.m4.1.1.3.3.cmml">d</mi><mo id="S3.SS4.p1.5.m4.1.1.3.1a" xref="S3.SS4.p1.5.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.5.m4.1.1.3.4" xref="S3.SS4.p1.5.m4.1.1.3.4.cmml">e</mi><mo id="S3.SS4.p1.5.m4.1.1.3.1b" xref="S3.SS4.p1.5.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.5.m4.1.1.3.5" xref="S3.SS4.p1.5.m4.1.1.3.5.cmml">n</mi><mo id="S3.SS4.p1.5.m4.1.1.3.1c" xref="S3.SS4.p1.5.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.5.m4.1.1.3.6" xref="S3.SS4.p1.5.m4.1.1.3.6.cmml">t</mi><mo id="S3.SS4.p1.5.m4.1.1.3.1d" xref="S3.SS4.p1.5.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.5.m4.1.1.3.7" xref="S3.SS4.p1.5.m4.1.1.3.7.cmml">i</mi><mo id="S3.SS4.p1.5.m4.1.1.3.1e" xref="S3.SS4.p1.5.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.5.m4.1.1.3.8" xref="S3.SS4.p1.5.m4.1.1.3.8.cmml">t</mi><mo id="S3.SS4.p1.5.m4.1.1.3.1f" xref="S3.SS4.p1.5.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.5.m4.1.1.3.9" xref="S3.SS4.p1.5.m4.1.1.3.9.cmml">y</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m4.1b"><apply id="S3.SS4.p1.5.m4.1.1.cmml" xref="S3.SS4.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m4.1.1.1.cmml" xref="S3.SS4.p1.5.m4.1.1">subscript</csymbol><ci id="S3.SS4.p1.5.m4.1.1.2.cmml" xref="S3.SS4.p1.5.m4.1.1.2">𝐋</ci><apply id="S3.SS4.p1.5.m4.1.1.3.cmml" xref="S3.SS4.p1.5.m4.1.1.3"><times id="S3.SS4.p1.5.m4.1.1.3.1.cmml" xref="S3.SS4.p1.5.m4.1.1.3.1"></times><ci id="S3.SS4.p1.5.m4.1.1.3.2.cmml" xref="S3.SS4.p1.5.m4.1.1.3.2">𝑖</ci><ci id="S3.SS4.p1.5.m4.1.1.3.3.cmml" xref="S3.SS4.p1.5.m4.1.1.3.3">𝑑</ci><ci id="S3.SS4.p1.5.m4.1.1.3.4.cmml" xref="S3.SS4.p1.5.m4.1.1.3.4">𝑒</ci><ci id="S3.SS4.p1.5.m4.1.1.3.5.cmml" xref="S3.SS4.p1.5.m4.1.1.3.5">𝑛</ci><ci id="S3.SS4.p1.5.m4.1.1.3.6.cmml" xref="S3.SS4.p1.5.m4.1.1.3.6">𝑡</ci><ci id="S3.SS4.p1.5.m4.1.1.3.7.cmml" xref="S3.SS4.p1.5.m4.1.1.3.7">𝑖</ci><ci id="S3.SS4.p1.5.m4.1.1.3.8.cmml" xref="S3.SS4.p1.5.m4.1.1.3.8">𝑡</ci><ci id="S3.SS4.p1.5.m4.1.1.3.9.cmml" xref="S3.SS4.p1.5.m4.1.1.3.9">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m4.1c">\mathbf{L}_{identity}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.5.m4.1d">bold_L start_POSTSUBSCRIPT italic_i italic_d italic_e italic_n italic_t italic_i italic_t italic_y end_POSTSUBSCRIPT</annotation></semantics></math> and the CLIP loss <math alttext="\mathbf{L}_{clip}" class="ltx_Math" display="inline" id="S3.SS4.p1.6.m5.1"><semantics id="S3.SS4.p1.6.m5.1a"><msub id="S3.SS4.p1.6.m5.1.1" xref="S3.SS4.p1.6.m5.1.1.cmml"><mi id="S3.SS4.p1.6.m5.1.1.2" xref="S3.SS4.p1.6.m5.1.1.2.cmml">𝐋</mi><mrow id="S3.SS4.p1.6.m5.1.1.3" xref="S3.SS4.p1.6.m5.1.1.3.cmml"><mi id="S3.SS4.p1.6.m5.1.1.3.2" xref="S3.SS4.p1.6.m5.1.1.3.2.cmml">c</mi><mo id="S3.SS4.p1.6.m5.1.1.3.1" xref="S3.SS4.p1.6.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.6.m5.1.1.3.3" xref="S3.SS4.p1.6.m5.1.1.3.3.cmml">l</mi><mo id="S3.SS4.p1.6.m5.1.1.3.1a" xref="S3.SS4.p1.6.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.6.m5.1.1.3.4" xref="S3.SS4.p1.6.m5.1.1.3.4.cmml">i</mi><mo id="S3.SS4.p1.6.m5.1.1.3.1b" xref="S3.SS4.p1.6.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.6.m5.1.1.3.5" xref="S3.SS4.p1.6.m5.1.1.3.5.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m5.1b"><apply id="S3.SS4.p1.6.m5.1.1.cmml" xref="S3.SS4.p1.6.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m5.1.1.1.cmml" xref="S3.SS4.p1.6.m5.1.1">subscript</csymbol><ci id="S3.SS4.p1.6.m5.1.1.2.cmml" xref="S3.SS4.p1.6.m5.1.1.2">𝐋</ci><apply id="S3.SS4.p1.6.m5.1.1.3.cmml" xref="S3.SS4.p1.6.m5.1.1.3"><times id="S3.SS4.p1.6.m5.1.1.3.1.cmml" xref="S3.SS4.p1.6.m5.1.1.3.1"></times><ci id="S3.SS4.p1.6.m5.1.1.3.2.cmml" xref="S3.SS4.p1.6.m5.1.1.3.2">𝑐</ci><ci id="S3.SS4.p1.6.m5.1.1.3.3.cmml" xref="S3.SS4.p1.6.m5.1.1.3.3">𝑙</ci><ci id="S3.SS4.p1.6.m5.1.1.3.4.cmml" xref="S3.SS4.p1.6.m5.1.1.3.4">𝑖</ci><ci id="S3.SS4.p1.6.m5.1.1.3.5.cmml" xref="S3.SS4.p1.6.m5.1.1.3.5">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m5.1c">\mathbf{L}_{clip}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.6.m5.1d">bold_L start_POSTSUBSCRIPT italic_c italic_l italic_i italic_p end_POSTSUBSCRIPT</annotation></semantics></math>. By integrating the degradation-aware <math alttext="\mathbf{L}_{clip}" class="ltx_Math" display="inline" id="S3.SS4.p1.7.m6.1"><semantics id="S3.SS4.p1.7.m6.1a"><msub id="S3.SS4.p1.7.m6.1.1" xref="S3.SS4.p1.7.m6.1.1.cmml"><mi id="S3.SS4.p1.7.m6.1.1.2" xref="S3.SS4.p1.7.m6.1.1.2.cmml">𝐋</mi><mrow id="S3.SS4.p1.7.m6.1.1.3" xref="S3.SS4.p1.7.m6.1.1.3.cmml"><mi id="S3.SS4.p1.7.m6.1.1.3.2" xref="S3.SS4.p1.7.m6.1.1.3.2.cmml">c</mi><mo id="S3.SS4.p1.7.m6.1.1.3.1" xref="S3.SS4.p1.7.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.7.m6.1.1.3.3" xref="S3.SS4.p1.7.m6.1.1.3.3.cmml">l</mi><mo id="S3.SS4.p1.7.m6.1.1.3.1a" xref="S3.SS4.p1.7.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.7.m6.1.1.3.4" xref="S3.SS4.p1.7.m6.1.1.3.4.cmml">i</mi><mo id="S3.SS4.p1.7.m6.1.1.3.1b" xref="S3.SS4.p1.7.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.7.m6.1.1.3.5" xref="S3.SS4.p1.7.m6.1.1.3.5.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m6.1b"><apply id="S3.SS4.p1.7.m6.1.1.cmml" xref="S3.SS4.p1.7.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m6.1.1.1.cmml" xref="S3.SS4.p1.7.m6.1.1">subscript</csymbol><ci id="S3.SS4.p1.7.m6.1.1.2.cmml" xref="S3.SS4.p1.7.m6.1.1.2">𝐋</ci><apply id="S3.SS4.p1.7.m6.1.1.3.cmml" xref="S3.SS4.p1.7.m6.1.1.3"><times id="S3.SS4.p1.7.m6.1.1.3.1.cmml" xref="S3.SS4.p1.7.m6.1.1.3.1"></times><ci id="S3.SS4.p1.7.m6.1.1.3.2.cmml" xref="S3.SS4.p1.7.m6.1.1.3.2">𝑐</ci><ci id="S3.SS4.p1.7.m6.1.1.3.3.cmml" xref="S3.SS4.p1.7.m6.1.1.3.3">𝑙</ci><ci id="S3.SS4.p1.7.m6.1.1.3.4.cmml" xref="S3.SS4.p1.7.m6.1.1.3.4">𝑖</ci><ci id="S3.SS4.p1.7.m6.1.1.3.5.cmml" xref="S3.SS4.p1.7.m6.1.1.3.5">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m6.1c">\mathbf{L}_{clip}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.7.m6.1d">bold_L start_POSTSUBSCRIPT italic_c italic_l italic_i italic_p end_POSTSUBSCRIPT</annotation></semantics></math>, Our method promotes the restored image to align closely with the ground truth in the CLIP embedding space, ensuring the preservation of semantic consistency. Mathematically,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx2">
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{L}_{identity}" class="ltx_Math" display="inline" id="S3.E5.m1.1"><semantics id="S3.E5.m1.1a"><msub id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><mi id="S3.E5.m1.1.1.2" xref="S3.E5.m1.1.1.2.cmml">𝐋</mi><mrow id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.3.2" xref="S3.E5.m1.1.1.3.2.cmml">i</mi><mo id="S3.E5.m1.1.1.3.1" xref="S3.E5.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.3.3" xref="S3.E5.m1.1.1.3.3.cmml">d</mi><mo id="S3.E5.m1.1.1.3.1a" xref="S3.E5.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.3.4" xref="S3.E5.m1.1.1.3.4.cmml">e</mi><mo id="S3.E5.m1.1.1.3.1b" xref="S3.E5.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.3.5" xref="S3.E5.m1.1.1.3.5.cmml">n</mi><mo id="S3.E5.m1.1.1.3.1c" xref="S3.E5.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.3.6" xref="S3.E5.m1.1.1.3.6.cmml">t</mi><mo id="S3.E5.m1.1.1.3.1d" xref="S3.E5.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.3.7" xref="S3.E5.m1.1.1.3.7.cmml">i</mi><mo id="S3.E5.m1.1.1.3.1e" xref="S3.E5.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.3.8" xref="S3.E5.m1.1.1.3.8.cmml">t</mi><mo id="S3.E5.m1.1.1.3.1f" xref="S3.E5.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.3.9" xref="S3.E5.m1.1.1.3.9.cmml">y</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1.2">𝐋</ci><apply id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3"><times id="S3.E5.m1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.3.1"></times><ci id="S3.E5.m1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.3.2">𝑖</ci><ci id="S3.E5.m1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.3.3">𝑑</ci><ci id="S3.E5.m1.1.1.3.4.cmml" xref="S3.E5.m1.1.1.3.4">𝑒</ci><ci id="S3.E5.m1.1.1.3.5.cmml" xref="S3.E5.m1.1.1.3.5">𝑛</ci><ci id="S3.E5.m1.1.1.3.6.cmml" xref="S3.E5.m1.1.1.3.6">𝑡</ci><ci id="S3.E5.m1.1.1.3.7.cmml" xref="S3.E5.m1.1.1.3.7">𝑖</ci><ci id="S3.E5.m1.1.1.3.8.cmml" xref="S3.E5.m1.1.1.3.8">𝑡</ci><ci id="S3.E5.m1.1.1.3.9.cmml" xref="S3.E5.m1.1.1.3.9">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\displaystyle\mathbf{L}_{identity}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.1d">bold_L start_POSTSUBSCRIPT italic_i italic_d italic_e italic_n italic_t italic_i italic_t italic_y end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left\|\operatorname{E_{i}}(\hat{\boldsymbol{I}})-\operatorname{%
E_{i}}(\boldsymbol{I})\right\|_{2}," class="ltx_Math" display="inline" id="S3.E5.m2.5"><semantics id="S3.E5.m2.5a"><mrow id="S3.E5.m2.5.5.1" xref="S3.E5.m2.5.5.1.1.cmml"><mrow id="S3.E5.m2.5.5.1.1" xref="S3.E5.m2.5.5.1.1.cmml"><mi id="S3.E5.m2.5.5.1.1.3" xref="S3.E5.m2.5.5.1.1.3.cmml"></mi><mo id="S3.E5.m2.5.5.1.1.2" xref="S3.E5.m2.5.5.1.1.2.cmml">=</mo><msub id="S3.E5.m2.5.5.1.1.1" xref="S3.E5.m2.5.5.1.1.1.cmml"><mrow id="S3.E5.m2.5.5.1.1.1.1.1" xref="S3.E5.m2.5.5.1.1.1.1.2.cmml"><mo id="S3.E5.m2.5.5.1.1.1.1.1.2" xref="S3.E5.m2.5.5.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E5.m2.5.5.1.1.1.1.1.1" xref="S3.E5.m2.5.5.1.1.1.1.1.1.cmml"><mrow id="S3.E5.m2.5.5.1.1.1.1.1.1.2.2" xref="S3.E5.m2.5.5.1.1.1.1.1.1.2.1.cmml"><msub id="S3.E5.m2.1.1" xref="S3.E5.m2.1.1.cmml"><mi id="S3.E5.m2.1.1.2" mathvariant="normal" xref="S3.E5.m2.1.1.2.cmml">E</mi><mi id="S3.E5.m2.1.1.3" mathvariant="normal" xref="S3.E5.m2.1.1.3.cmml">i</mi></msub><mo id="S3.E5.m2.5.5.1.1.1.1.1.1.2.2a" xref="S3.E5.m2.5.5.1.1.1.1.1.1.2.1.cmml">⁡</mo><mrow id="S3.E5.m2.5.5.1.1.1.1.1.1.2.2.1" xref="S3.E5.m2.5.5.1.1.1.1.1.1.2.1.cmml"><mo id="S3.E5.m2.5.5.1.1.1.1.1.1.2.2.1.1" stretchy="false" xref="S3.E5.m2.5.5.1.1.1.1.1.1.2.1.cmml">(</mo><mover accent="true" id="S3.E5.m2.2.2" xref="S3.E5.m2.2.2.cmml"><mi id="S3.E5.m2.2.2.2" xref="S3.E5.m2.2.2.2.cmml">𝑰</mi><mo id="S3.E5.m2.2.2.1" xref="S3.E5.m2.2.2.1.cmml">^</mo></mover><mo id="S3.E5.m2.5.5.1.1.1.1.1.1.2.2.1.2" stretchy="false" xref="S3.E5.m2.5.5.1.1.1.1.1.1.2.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m2.5.5.1.1.1.1.1.1.1" xref="S3.E5.m2.5.5.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E5.m2.5.5.1.1.1.1.1.1.3.2" xref="S3.E5.m2.5.5.1.1.1.1.1.1.3.1.cmml"><msub id="S3.E5.m2.3.3" xref="S3.E5.m2.3.3.cmml"><mi id="S3.E5.m2.3.3.2" mathvariant="normal" xref="S3.E5.m2.3.3.2.cmml">E</mi><mi id="S3.E5.m2.3.3.3" mathvariant="normal" xref="S3.E5.m2.3.3.3.cmml">i</mi></msub><mo id="S3.E5.m2.5.5.1.1.1.1.1.1.3.2a" xref="S3.E5.m2.5.5.1.1.1.1.1.1.3.1.cmml">⁡</mo><mrow id="S3.E5.m2.5.5.1.1.1.1.1.1.3.2.1" xref="S3.E5.m2.5.5.1.1.1.1.1.1.3.1.cmml"><mo id="S3.E5.m2.5.5.1.1.1.1.1.1.3.2.1.1" stretchy="false" xref="S3.E5.m2.5.5.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S3.E5.m2.4.4" xref="S3.E5.m2.4.4.cmml">𝑰</mi><mo id="S3.E5.m2.5.5.1.1.1.1.1.1.3.2.1.2" stretchy="false" xref="S3.E5.m2.5.5.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m2.5.5.1.1.1.1.1.3" xref="S3.E5.m2.5.5.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E5.m2.5.5.1.1.1.3" xref="S3.E5.m2.5.5.1.1.1.3.cmml">2</mn></msub></mrow><mo id="S3.E5.m2.5.5.1.2" xref="S3.E5.m2.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m2.5b"><apply id="S3.E5.m2.5.5.1.1.cmml" xref="S3.E5.m2.5.5.1"><eq id="S3.E5.m2.5.5.1.1.2.cmml" xref="S3.E5.m2.5.5.1.1.2"></eq><csymbol cd="latexml" id="S3.E5.m2.5.5.1.1.3.cmml" xref="S3.E5.m2.5.5.1.1.3">absent</csymbol><apply id="S3.E5.m2.5.5.1.1.1.cmml" xref="S3.E5.m2.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m2.5.5.1.1.1.2.cmml" xref="S3.E5.m2.5.5.1.1.1">subscript</csymbol><apply id="S3.E5.m2.5.5.1.1.1.1.2.cmml" xref="S3.E5.m2.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m2.5.5.1.1.1.1.2.1.cmml" xref="S3.E5.m2.5.5.1.1.1.1.1.2">norm</csymbol><apply id="S3.E5.m2.5.5.1.1.1.1.1.1.cmml" xref="S3.E5.m2.5.5.1.1.1.1.1.1"><minus id="S3.E5.m2.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E5.m2.5.5.1.1.1.1.1.1.1"></minus><apply id="S3.E5.m2.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m2.5.5.1.1.1.1.1.1.2.2"><apply id="S3.E5.m2.1.1.cmml" xref="S3.E5.m2.1.1"><csymbol cd="ambiguous" id="S3.E5.m2.1.1.1.cmml" xref="S3.E5.m2.1.1">subscript</csymbol><ci id="S3.E5.m2.1.1.2.cmml" xref="S3.E5.m2.1.1.2">E</ci><ci id="S3.E5.m2.1.1.3.cmml" xref="S3.E5.m2.1.1.3">i</ci></apply><apply id="S3.E5.m2.2.2.cmml" xref="S3.E5.m2.2.2"><ci id="S3.E5.m2.2.2.1.cmml" xref="S3.E5.m2.2.2.1">^</ci><ci id="S3.E5.m2.2.2.2.cmml" xref="S3.E5.m2.2.2.2">𝑰</ci></apply></apply><apply id="S3.E5.m2.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m2.5.5.1.1.1.1.1.1.3.2"><apply id="S3.E5.m2.3.3.cmml" xref="S3.E5.m2.3.3"><csymbol cd="ambiguous" id="S3.E5.m2.3.3.1.cmml" xref="S3.E5.m2.3.3">subscript</csymbol><ci id="S3.E5.m2.3.3.2.cmml" xref="S3.E5.m2.3.3.2">E</ci><ci id="S3.E5.m2.3.3.3.cmml" xref="S3.E5.m2.3.3.3">i</ci></apply><ci id="S3.E5.m2.4.4.cmml" xref="S3.E5.m2.4.4">𝑰</ci></apply></apply></apply><cn id="S3.E5.m2.5.5.1.1.1.3.cmml" type="integer" xref="S3.E5.m2.5.5.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m2.5c">\displaystyle=\left\|\operatorname{E_{i}}(\hat{\boldsymbol{I}})-\operatorname{%
E_{i}}(\boldsymbol{I})\right\|_{2},</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m2.5d">= ∥ start_OPFUNCTION roman_E start_POSTSUBSCRIPT roman_i end_POSTSUBSCRIPT end_OPFUNCTION ( over^ start_ARG bold_italic_I end_ARG ) - start_OPFUNCTION roman_E start_POSTSUBSCRIPT roman_i end_POSTSUBSCRIPT end_OPFUNCTION ( bold_italic_I ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{L}_{clip}" class="ltx_Math" display="inline" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><msub id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><mi id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml">𝐋</mi><mrow id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.3.2" xref="S3.E6.m1.1.1.3.2.cmml">c</mi><mo id="S3.E6.m1.1.1.3.1" xref="S3.E6.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.3.3" xref="S3.E6.m1.1.1.3.3.cmml">l</mi><mo id="S3.E6.m1.1.1.3.1a" xref="S3.E6.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.3.4" xref="S3.E6.m1.1.1.3.4.cmml">i</mi><mo id="S3.E6.m1.1.1.3.1b" xref="S3.E6.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.3.5" xref="S3.E6.m1.1.1.3.5.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2">𝐋</ci><apply id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3"><times id="S3.E6.m1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.3.1"></times><ci id="S3.E6.m1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.3.2">𝑐</ci><ci id="S3.E6.m1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.3.3">𝑙</ci><ci id="S3.E6.m1.1.1.3.4.cmml" xref="S3.E6.m1.1.1.3.4">𝑖</ci><ci id="S3.E6.m1.1.1.3.5.cmml" xref="S3.E6.m1.1.1.3.5">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\displaystyle\mathbf{L}_{clip}</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">bold_L start_POSTSUBSCRIPT italic_c italic_l italic_i italic_p end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\operatorname{E_{i}}(\hat{\boldsymbol{I}})\cdot%
\operatorname{E_{t}}(prompt)}{|\operatorname{E_{i}}(\hat{\boldsymbol{I}})||%
\operatorname{E_{t}}(prompt)|}," class="ltx_Math" display="inline" id="S3.E6.m2.10"><semantics id="S3.E6.m2.10a"><mrow id="S3.E6.m2.10.10.1" xref="S3.E6.m2.10.10.1.1.cmml"><mrow id="S3.E6.m2.10.10.1.1" xref="S3.E6.m2.10.10.1.1.cmml"><mi id="S3.E6.m2.10.10.1.1.2" xref="S3.E6.m2.10.10.1.1.2.cmml"></mi><mo id="S3.E6.m2.10.10.1.1.1" xref="S3.E6.m2.10.10.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E6.m2.9.9" xref="S3.E6.m2.9.9.cmml"><mfrac id="S3.E6.m2.9.9a" xref="S3.E6.m2.9.9.cmml"><mrow id="S3.E6.m2.4.4.4" xref="S3.E6.m2.4.4.4.cmml"><mrow id="S3.E6.m2.4.4.4.6.2" xref="S3.E6.m2.4.4.4.6.1.cmml"><msub id="S3.E6.m2.1.1.1.1" xref="S3.E6.m2.1.1.1.1.cmml"><mi id="S3.E6.m2.1.1.1.1.2" mathvariant="normal" xref="S3.E6.m2.1.1.1.1.2.cmml">E</mi><mi id="S3.E6.m2.1.1.1.1.3" mathvariant="normal" xref="S3.E6.m2.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E6.m2.4.4.4.6.2a" xref="S3.E6.m2.4.4.4.6.1.cmml">⁡</mo><mrow id="S3.E6.m2.4.4.4.6.2.1" xref="S3.E6.m2.4.4.4.6.1.cmml"><mo id="S3.E6.m2.4.4.4.6.2.1.1" stretchy="false" xref="S3.E6.m2.4.4.4.6.1.cmml">(</mo><mover accent="true" id="S3.E6.m2.2.2.2.2" xref="S3.E6.m2.2.2.2.2.cmml"><mi id="S3.E6.m2.2.2.2.2.2" xref="S3.E6.m2.2.2.2.2.2.cmml">𝑰</mi><mo id="S3.E6.m2.2.2.2.2.1" xref="S3.E6.m2.2.2.2.2.1.cmml">^</mo></mover><mo id="S3.E6.m2.4.4.4.6.2.1.2" rspace="0.055em" stretchy="false" xref="S3.E6.m2.4.4.4.6.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m2.4.4.4.5" rspace="0.222em" xref="S3.E6.m2.4.4.4.5.cmml">⋅</mo><mrow id="S3.E6.m2.4.4.4.4.1" xref="S3.E6.m2.4.4.4.4.2.cmml"><msub id="S3.E6.m2.3.3.3.3" xref="S3.E6.m2.3.3.3.3.cmml"><mi id="S3.E6.m2.3.3.3.3.2" mathvariant="normal" xref="S3.E6.m2.3.3.3.3.2.cmml">E</mi><mi id="S3.E6.m2.3.3.3.3.3" mathvariant="normal" xref="S3.E6.m2.3.3.3.3.3.cmml">t</mi></msub><mo id="S3.E6.m2.4.4.4.4.1a" xref="S3.E6.m2.4.4.4.4.2.cmml">⁡</mo><mrow id="S3.E6.m2.4.4.4.4.1.1" xref="S3.E6.m2.4.4.4.4.2.cmml"><mo id="S3.E6.m2.4.4.4.4.1.1.2" stretchy="false" xref="S3.E6.m2.4.4.4.4.2.cmml">(</mo><mrow id="S3.E6.m2.4.4.4.4.1.1.1" xref="S3.E6.m2.4.4.4.4.1.1.1.cmml"><mi id="S3.E6.m2.4.4.4.4.1.1.1.2" xref="S3.E6.m2.4.4.4.4.1.1.1.2.cmml">p</mi><mo id="S3.E6.m2.4.4.4.4.1.1.1.1" xref="S3.E6.m2.4.4.4.4.1.1.1.1.cmml">⁢</mo><mi id="S3.E6.m2.4.4.4.4.1.1.1.3" xref="S3.E6.m2.4.4.4.4.1.1.1.3.cmml">r</mi><mo id="S3.E6.m2.4.4.4.4.1.1.1.1a" xref="S3.E6.m2.4.4.4.4.1.1.1.1.cmml">⁢</mo><mi id="S3.E6.m2.4.4.4.4.1.1.1.4" xref="S3.E6.m2.4.4.4.4.1.1.1.4.cmml">o</mi><mo id="S3.E6.m2.4.4.4.4.1.1.1.1b" xref="S3.E6.m2.4.4.4.4.1.1.1.1.cmml">⁢</mo><mi id="S3.E6.m2.4.4.4.4.1.1.1.5" xref="S3.E6.m2.4.4.4.4.1.1.1.5.cmml">m</mi><mo id="S3.E6.m2.4.4.4.4.1.1.1.1c" xref="S3.E6.m2.4.4.4.4.1.1.1.1.cmml">⁢</mo><mi id="S3.E6.m2.4.4.4.4.1.1.1.6" xref="S3.E6.m2.4.4.4.4.1.1.1.6.cmml">p</mi><mo id="S3.E6.m2.4.4.4.4.1.1.1.1d" xref="S3.E6.m2.4.4.4.4.1.1.1.1.cmml">⁢</mo><mi id="S3.E6.m2.4.4.4.4.1.1.1.7" xref="S3.E6.m2.4.4.4.4.1.1.1.7.cmml">t</mi></mrow><mo id="S3.E6.m2.4.4.4.4.1.1.3" stretchy="false" xref="S3.E6.m2.4.4.4.4.2.cmml">)</mo></mrow></mrow></mrow><mrow id="S3.E6.m2.9.9.9" xref="S3.E6.m2.9.9.9.cmml"><mrow id="S3.E6.m2.8.8.8.4.1" xref="S3.E6.m2.8.8.8.4.2.cmml"><mo id="S3.E6.m2.8.8.8.4.1.2" stretchy="false" xref="S3.E6.m2.8.8.8.4.2.1.cmml">|</mo><mrow id="S3.E6.m2.8.8.8.4.1.1.2" xref="S3.E6.m2.8.8.8.4.1.1.1.cmml"><msub id="S3.E6.m2.5.5.5.1" xref="S3.E6.m2.5.5.5.1.cmml"><mi id="S3.E6.m2.5.5.5.1.2" mathvariant="normal" xref="S3.E6.m2.5.5.5.1.2.cmml">E</mi><mi id="S3.E6.m2.5.5.5.1.3" mathvariant="normal" xref="S3.E6.m2.5.5.5.1.3.cmml">i</mi></msub><mo id="S3.E6.m2.8.8.8.4.1.1.2a" xref="S3.E6.m2.8.8.8.4.1.1.1.cmml">⁡</mo><mrow id="S3.E6.m2.8.8.8.4.1.1.2.1" xref="S3.E6.m2.8.8.8.4.1.1.1.cmml"><mo id="S3.E6.m2.8.8.8.4.1.1.2.1.1" stretchy="false" xref="S3.E6.m2.8.8.8.4.1.1.1.cmml">(</mo><mover accent="true" id="S3.E6.m2.6.6.6.2" xref="S3.E6.m2.6.6.6.2.cmml"><mi id="S3.E6.m2.6.6.6.2.2" xref="S3.E6.m2.6.6.6.2.2.cmml">𝑰</mi><mo id="S3.E6.m2.6.6.6.2.1" xref="S3.E6.m2.6.6.6.2.1.cmml">^</mo></mover><mo id="S3.E6.m2.8.8.8.4.1.1.2.1.2" stretchy="false" xref="S3.E6.m2.8.8.8.4.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m2.8.8.8.4.1.3" stretchy="false" xref="S3.E6.m2.8.8.8.4.2.1.cmml">|</mo></mrow><mo id="S3.E6.m2.9.9.9.6" xref="S3.E6.m2.9.9.9.6.cmml">⁢</mo><mrow id="S3.E6.m2.9.9.9.5.1" xref="S3.E6.m2.9.9.9.5.2.cmml"><mo id="S3.E6.m2.9.9.9.5.1.2" stretchy="false" xref="S3.E6.m2.9.9.9.5.2.1.cmml">|</mo><mrow id="S3.E6.m2.9.9.9.5.1.1.1" xref="S3.E6.m2.9.9.9.5.1.1.2.cmml"><msub id="S3.E6.m2.7.7.7.3" xref="S3.E6.m2.7.7.7.3.cmml"><mi id="S3.E6.m2.7.7.7.3.2" mathvariant="normal" xref="S3.E6.m2.7.7.7.3.2.cmml">E</mi><mi id="S3.E6.m2.7.7.7.3.3" mathvariant="normal" xref="S3.E6.m2.7.7.7.3.3.cmml">t</mi></msub><mo id="S3.E6.m2.9.9.9.5.1.1.1a" xref="S3.E6.m2.9.9.9.5.1.1.2.cmml">⁡</mo><mrow id="S3.E6.m2.9.9.9.5.1.1.1.1" xref="S3.E6.m2.9.9.9.5.1.1.2.cmml"><mo id="S3.E6.m2.9.9.9.5.1.1.1.1.2" stretchy="false" xref="S3.E6.m2.9.9.9.5.1.1.2.cmml">(</mo><mrow id="S3.E6.m2.9.9.9.5.1.1.1.1.1" xref="S3.E6.m2.9.9.9.5.1.1.1.1.1.cmml"><mi id="S3.E6.m2.9.9.9.5.1.1.1.1.1.2" xref="S3.E6.m2.9.9.9.5.1.1.1.1.1.2.cmml">p</mi><mo id="S3.E6.m2.9.9.9.5.1.1.1.1.1.1" xref="S3.E6.m2.9.9.9.5.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E6.m2.9.9.9.5.1.1.1.1.1.3" xref="S3.E6.m2.9.9.9.5.1.1.1.1.1.3.cmml">r</mi><mo id="S3.E6.m2.9.9.9.5.1.1.1.1.1.1a" xref="S3.E6.m2.9.9.9.5.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E6.m2.9.9.9.5.1.1.1.1.1.4" xref="S3.E6.m2.9.9.9.5.1.1.1.1.1.4.cmml">o</mi><mo id="S3.E6.m2.9.9.9.5.1.1.1.1.1.1b" xref="S3.E6.m2.9.9.9.5.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E6.m2.9.9.9.5.1.1.1.1.1.5" xref="S3.E6.m2.9.9.9.5.1.1.1.1.1.5.cmml">m</mi><mo id="S3.E6.m2.9.9.9.5.1.1.1.1.1.1c" xref="S3.E6.m2.9.9.9.5.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E6.m2.9.9.9.5.1.1.1.1.1.6" xref="S3.E6.m2.9.9.9.5.1.1.1.1.1.6.cmml">p</mi><mo id="S3.E6.m2.9.9.9.5.1.1.1.1.1.1d" xref="S3.E6.m2.9.9.9.5.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E6.m2.9.9.9.5.1.1.1.1.1.7" xref="S3.E6.m2.9.9.9.5.1.1.1.1.1.7.cmml">t</mi></mrow><mo id="S3.E6.m2.9.9.9.5.1.1.1.1.3" stretchy="false" xref="S3.E6.m2.9.9.9.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E6.m2.9.9.9.5.1.3" stretchy="false" xref="S3.E6.m2.9.9.9.5.2.1.cmml">|</mo></mrow></mrow></mfrac></mstyle></mrow><mo id="S3.E6.m2.10.10.1.2" xref="S3.E6.m2.10.10.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m2.10b"><apply id="S3.E6.m2.10.10.1.1.cmml" xref="S3.E6.m2.10.10.1"><eq id="S3.E6.m2.10.10.1.1.1.cmml" xref="S3.E6.m2.10.10.1.1.1"></eq><csymbol cd="latexml" id="S3.E6.m2.10.10.1.1.2.cmml" xref="S3.E6.m2.10.10.1.1.2">absent</csymbol><apply id="S3.E6.m2.9.9.cmml" xref="S3.E6.m2.9.9"><divide id="S3.E6.m2.9.9.10.cmml" xref="S3.E6.m2.9.9"></divide><apply id="S3.E6.m2.4.4.4.cmml" xref="S3.E6.m2.4.4.4"><ci id="S3.E6.m2.4.4.4.5.cmml" xref="S3.E6.m2.4.4.4.5">⋅</ci><apply id="S3.E6.m2.4.4.4.6.1.cmml" xref="S3.E6.m2.4.4.4.6.2"><apply id="S3.E6.m2.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m2.1.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1">subscript</csymbol><ci id="S3.E6.m2.1.1.1.1.2.cmml" xref="S3.E6.m2.1.1.1.1.2">E</ci><ci id="S3.E6.m2.1.1.1.1.3.cmml" xref="S3.E6.m2.1.1.1.1.3">i</ci></apply><apply id="S3.E6.m2.2.2.2.2.cmml" xref="S3.E6.m2.2.2.2.2"><ci id="S3.E6.m2.2.2.2.2.1.cmml" xref="S3.E6.m2.2.2.2.2.1">^</ci><ci id="S3.E6.m2.2.2.2.2.2.cmml" xref="S3.E6.m2.2.2.2.2.2">𝑰</ci></apply></apply><apply id="S3.E6.m2.4.4.4.4.2.cmml" xref="S3.E6.m2.4.4.4.4.1"><apply id="S3.E6.m2.3.3.3.3.cmml" xref="S3.E6.m2.3.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.3.3.1.cmml" xref="S3.E6.m2.3.3.3.3">subscript</csymbol><ci id="S3.E6.m2.3.3.3.3.2.cmml" xref="S3.E6.m2.3.3.3.3.2">E</ci><ci id="S3.E6.m2.3.3.3.3.3.cmml" xref="S3.E6.m2.3.3.3.3.3">t</ci></apply><apply id="S3.E6.m2.4.4.4.4.1.1.1.cmml" xref="S3.E6.m2.4.4.4.4.1.1.1"><times id="S3.E6.m2.4.4.4.4.1.1.1.1.cmml" xref="S3.E6.m2.4.4.4.4.1.1.1.1"></times><ci id="S3.E6.m2.4.4.4.4.1.1.1.2.cmml" xref="S3.E6.m2.4.4.4.4.1.1.1.2">𝑝</ci><ci id="S3.E6.m2.4.4.4.4.1.1.1.3.cmml" xref="S3.E6.m2.4.4.4.4.1.1.1.3">𝑟</ci><ci id="S3.E6.m2.4.4.4.4.1.1.1.4.cmml" xref="S3.E6.m2.4.4.4.4.1.1.1.4">𝑜</ci><ci id="S3.E6.m2.4.4.4.4.1.1.1.5.cmml" xref="S3.E6.m2.4.4.4.4.1.1.1.5">𝑚</ci><ci id="S3.E6.m2.4.4.4.4.1.1.1.6.cmml" xref="S3.E6.m2.4.4.4.4.1.1.1.6">𝑝</ci><ci id="S3.E6.m2.4.4.4.4.1.1.1.7.cmml" xref="S3.E6.m2.4.4.4.4.1.1.1.7">𝑡</ci></apply></apply></apply><apply id="S3.E6.m2.9.9.9.cmml" xref="S3.E6.m2.9.9.9"><times id="S3.E6.m2.9.9.9.6.cmml" xref="S3.E6.m2.9.9.9.6"></times><apply id="S3.E6.m2.8.8.8.4.2.cmml" xref="S3.E6.m2.8.8.8.4.1"><abs id="S3.E6.m2.8.8.8.4.2.1.cmml" xref="S3.E6.m2.8.8.8.4.1.2"></abs><apply id="S3.E6.m2.8.8.8.4.1.1.1.cmml" xref="S3.E6.m2.8.8.8.4.1.1.2"><apply id="S3.E6.m2.5.5.5.1.cmml" xref="S3.E6.m2.5.5.5.1"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.5.1.1.cmml" xref="S3.E6.m2.5.5.5.1">subscript</csymbol><ci id="S3.E6.m2.5.5.5.1.2.cmml" xref="S3.E6.m2.5.5.5.1.2">E</ci><ci id="S3.E6.m2.5.5.5.1.3.cmml" xref="S3.E6.m2.5.5.5.1.3">i</ci></apply><apply id="S3.E6.m2.6.6.6.2.cmml" xref="S3.E6.m2.6.6.6.2"><ci id="S3.E6.m2.6.6.6.2.1.cmml" xref="S3.E6.m2.6.6.6.2.1">^</ci><ci id="S3.E6.m2.6.6.6.2.2.cmml" xref="S3.E6.m2.6.6.6.2.2">𝑰</ci></apply></apply></apply><apply id="S3.E6.m2.9.9.9.5.2.cmml" xref="S3.E6.m2.9.9.9.5.1"><abs id="S3.E6.m2.9.9.9.5.2.1.cmml" xref="S3.E6.m2.9.9.9.5.1.2"></abs><apply id="S3.E6.m2.9.9.9.5.1.1.2.cmml" xref="S3.E6.m2.9.9.9.5.1.1.1"><apply id="S3.E6.m2.7.7.7.3.cmml" xref="S3.E6.m2.7.7.7.3"><csymbol cd="ambiguous" id="S3.E6.m2.7.7.7.3.1.cmml" xref="S3.E6.m2.7.7.7.3">subscript</csymbol><ci id="S3.E6.m2.7.7.7.3.2.cmml" xref="S3.E6.m2.7.7.7.3.2">E</ci><ci id="S3.E6.m2.7.7.7.3.3.cmml" xref="S3.E6.m2.7.7.7.3.3">t</ci></apply><apply id="S3.E6.m2.9.9.9.5.1.1.1.1.1.cmml" xref="S3.E6.m2.9.9.9.5.1.1.1.1.1"><times id="S3.E6.m2.9.9.9.5.1.1.1.1.1.1.cmml" xref="S3.E6.m2.9.9.9.5.1.1.1.1.1.1"></times><ci id="S3.E6.m2.9.9.9.5.1.1.1.1.1.2.cmml" xref="S3.E6.m2.9.9.9.5.1.1.1.1.1.2">𝑝</ci><ci id="S3.E6.m2.9.9.9.5.1.1.1.1.1.3.cmml" xref="S3.E6.m2.9.9.9.5.1.1.1.1.1.3">𝑟</ci><ci id="S3.E6.m2.9.9.9.5.1.1.1.1.1.4.cmml" xref="S3.E6.m2.9.9.9.5.1.1.1.1.1.4">𝑜</ci><ci id="S3.E6.m2.9.9.9.5.1.1.1.1.1.5.cmml" xref="S3.E6.m2.9.9.9.5.1.1.1.1.1.5">𝑚</ci><ci id="S3.E6.m2.9.9.9.5.1.1.1.1.1.6.cmml" xref="S3.E6.m2.9.9.9.5.1.1.1.1.1.6">𝑝</ci><ci id="S3.E6.m2.9.9.9.5.1.1.1.1.1.7.cmml" xref="S3.E6.m2.9.9.9.5.1.1.1.1.1.7">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m2.10c">\displaystyle=\frac{\operatorname{E_{i}}(\hat{\boldsymbol{I}})\cdot%
\operatorname{E_{t}}(prompt)}{|\operatorname{E_{i}}(\hat{\boldsymbol{I}})||%
\operatorname{E_{t}}(prompt)|},</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m2.10d">= divide start_ARG start_OPFUNCTION roman_E start_POSTSUBSCRIPT roman_i end_POSTSUBSCRIPT end_OPFUNCTION ( over^ start_ARG bold_italic_I end_ARG ) ⋅ start_OPFUNCTION roman_E start_POSTSUBSCRIPT roman_t end_POSTSUBSCRIPT end_OPFUNCTION ( italic_p italic_r italic_o italic_m italic_p italic_t ) end_ARG start_ARG | start_OPFUNCTION roman_E start_POSTSUBSCRIPT roman_i end_POSTSUBSCRIPT end_OPFUNCTION ( over^ start_ARG bold_italic_I end_ARG ) | | start_OPFUNCTION roman_E start_POSTSUBSCRIPT roman_t end_POSTSUBSCRIPT end_OPFUNCTION ( italic_p italic_r italic_o italic_m italic_p italic_t ) | end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p1.10">where <math alttext="\operatorname{E_{i}}(\cdot)" class="ltx_Math" display="inline" id="S3.SS4.p1.8.m1.2"><semantics id="S3.SS4.p1.8.m1.2a"><mrow id="S3.SS4.p1.8.m1.2.3.2" xref="S3.SS4.p1.8.m1.2.3.1.cmml"><msub id="S3.SS4.p1.8.m1.1.1" xref="S3.SS4.p1.8.m1.1.1.cmml"><mi id="S3.SS4.p1.8.m1.1.1.2" mathvariant="normal" xref="S3.SS4.p1.8.m1.1.1.2.cmml">E</mi><mi id="S3.SS4.p1.8.m1.1.1.3" mathvariant="normal" xref="S3.SS4.p1.8.m1.1.1.3.cmml">i</mi></msub><mo id="S3.SS4.p1.8.m1.2.3.2a" xref="S3.SS4.p1.8.m1.2.3.1.cmml">⁡</mo><mrow id="S3.SS4.p1.8.m1.2.3.2.1" xref="S3.SS4.p1.8.m1.2.3.1.cmml"><mo id="S3.SS4.p1.8.m1.2.3.2.1.1" stretchy="false" xref="S3.SS4.p1.8.m1.2.3.1.cmml">(</mo><mo id="S3.SS4.p1.8.m1.2.2" lspace="0em" rspace="0em" xref="S3.SS4.p1.8.m1.2.2.cmml">⋅</mo><mo id="S3.SS4.p1.8.m1.2.3.2.1.2" stretchy="false" xref="S3.SS4.p1.8.m1.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m1.2b"><apply id="S3.SS4.p1.8.m1.2.3.1.cmml" xref="S3.SS4.p1.8.m1.2.3.2"><apply id="S3.SS4.p1.8.m1.1.1.cmml" xref="S3.SS4.p1.8.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m1.1.1.1.cmml" xref="S3.SS4.p1.8.m1.1.1">subscript</csymbol><ci id="S3.SS4.p1.8.m1.1.1.2.cmml" xref="S3.SS4.p1.8.m1.1.1.2">E</ci><ci id="S3.SS4.p1.8.m1.1.1.3.cmml" xref="S3.SS4.p1.8.m1.1.1.3">i</ci></apply><ci id="S3.SS4.p1.8.m1.2.2.cmml" xref="S3.SS4.p1.8.m1.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m1.2c">\operatorname{E_{i}}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.8.m1.2d">start_OPFUNCTION roman_E start_POSTSUBSCRIPT roman_i end_POSTSUBSCRIPT end_OPFUNCTION ( ⋅ )</annotation></semantics></math> and <math alttext="\operatorname{E_{t}}(\cdot)" class="ltx_Math" display="inline" id="S3.SS4.p1.9.m2.2"><semantics id="S3.SS4.p1.9.m2.2a"><mrow id="S3.SS4.p1.9.m2.2.3.2" xref="S3.SS4.p1.9.m2.2.3.1.cmml"><msub id="S3.SS4.p1.9.m2.1.1" xref="S3.SS4.p1.9.m2.1.1.cmml"><mi id="S3.SS4.p1.9.m2.1.1.2" mathvariant="normal" xref="S3.SS4.p1.9.m2.1.1.2.cmml">E</mi><mi id="S3.SS4.p1.9.m2.1.1.3" mathvariant="normal" xref="S3.SS4.p1.9.m2.1.1.3.cmml">t</mi></msub><mo id="S3.SS4.p1.9.m2.2.3.2a" xref="S3.SS4.p1.9.m2.2.3.1.cmml">⁡</mo><mrow id="S3.SS4.p1.9.m2.2.3.2.1" xref="S3.SS4.p1.9.m2.2.3.1.cmml"><mo id="S3.SS4.p1.9.m2.2.3.2.1.1" stretchy="false" xref="S3.SS4.p1.9.m2.2.3.1.cmml">(</mo><mo id="S3.SS4.p1.9.m2.2.2" lspace="0em" rspace="0em" xref="S3.SS4.p1.9.m2.2.2.cmml">⋅</mo><mo id="S3.SS4.p1.9.m2.2.3.2.1.2" stretchy="false" xref="S3.SS4.p1.9.m2.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.9.m2.2b"><apply id="S3.SS4.p1.9.m2.2.3.1.cmml" xref="S3.SS4.p1.9.m2.2.3.2"><apply id="S3.SS4.p1.9.m2.1.1.cmml" xref="S3.SS4.p1.9.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m2.1.1.1.cmml" xref="S3.SS4.p1.9.m2.1.1">subscript</csymbol><ci id="S3.SS4.p1.9.m2.1.1.2.cmml" xref="S3.SS4.p1.9.m2.1.1.2">E</ci><ci id="S3.SS4.p1.9.m2.1.1.3.cmml" xref="S3.SS4.p1.9.m2.1.1.3">t</ci></apply><ci id="S3.SS4.p1.9.m2.2.2.cmml" xref="S3.SS4.p1.9.m2.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.9.m2.2c">\operatorname{E_{t}}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.9.m2.2d">start_OPFUNCTION roman_E start_POSTSUBSCRIPT roman_t end_POSTSUBSCRIPT end_OPFUNCTION ( ⋅ )</annotation></semantics></math> denote the image and text encoder of CLIP, respectively. <math alttext="prompt" class="ltx_Math" display="inline" id="S3.SS4.p1.10.m3.1"><semantics id="S3.SS4.p1.10.m3.1a"><mrow id="S3.SS4.p1.10.m3.1.1" xref="S3.SS4.p1.10.m3.1.1.cmml"><mi id="S3.SS4.p1.10.m3.1.1.2" xref="S3.SS4.p1.10.m3.1.1.2.cmml">p</mi><mo id="S3.SS4.p1.10.m3.1.1.1" xref="S3.SS4.p1.10.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS4.p1.10.m3.1.1.3" xref="S3.SS4.p1.10.m3.1.1.3.cmml">r</mi><mo id="S3.SS4.p1.10.m3.1.1.1a" xref="S3.SS4.p1.10.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS4.p1.10.m3.1.1.4" xref="S3.SS4.p1.10.m3.1.1.4.cmml">o</mi><mo id="S3.SS4.p1.10.m3.1.1.1b" xref="S3.SS4.p1.10.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS4.p1.10.m3.1.1.5" xref="S3.SS4.p1.10.m3.1.1.5.cmml">m</mi><mo id="S3.SS4.p1.10.m3.1.1.1c" xref="S3.SS4.p1.10.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS4.p1.10.m3.1.1.6" xref="S3.SS4.p1.10.m3.1.1.6.cmml">p</mi><mo id="S3.SS4.p1.10.m3.1.1.1d" xref="S3.SS4.p1.10.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS4.p1.10.m3.1.1.7" xref="S3.SS4.p1.10.m3.1.1.7.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.10.m3.1b"><apply id="S3.SS4.p1.10.m3.1.1.cmml" xref="S3.SS4.p1.10.m3.1.1"><times id="S3.SS4.p1.10.m3.1.1.1.cmml" xref="S3.SS4.p1.10.m3.1.1.1"></times><ci id="S3.SS4.p1.10.m3.1.1.2.cmml" xref="S3.SS4.p1.10.m3.1.1.2">𝑝</ci><ci id="S3.SS4.p1.10.m3.1.1.3.cmml" xref="S3.SS4.p1.10.m3.1.1.3">𝑟</ci><ci id="S3.SS4.p1.10.m3.1.1.4.cmml" xref="S3.SS4.p1.10.m3.1.1.4">𝑜</ci><ci id="S3.SS4.p1.10.m3.1.1.5.cmml" xref="S3.SS4.p1.10.m3.1.1.5">𝑚</ci><ci id="S3.SS4.p1.10.m3.1.1.6.cmml" xref="S3.SS4.p1.10.m3.1.1.6">𝑝</ci><ci id="S3.SS4.p1.10.m3.1.1.7.cmml" xref="S3.SS4.p1.10.m3.1.1.7">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.10.m3.1c">prompt</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.10.m3.1d">italic_p italic_r italic_o italic_m italic_p italic_t</annotation></semantics></math> represents a concise description of the joint-degradation depicted in the input image. Finally, the overall loss function can be expressed as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{L}_{total}=\mathbf{L}_{rec}+\lambda_{identity}\mathbf{L}_{identity}+%
\lambda_{clip}\mathbf{L}_{clip}," class="ltx_Math" display="block" id="S3.E7.m1.1"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><msub id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.cmml"><mi id="S3.E7.m1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.2.2.cmml">𝐋</mi><mrow id="S3.E7.m1.1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.2.3.2" xref="S3.E7.m1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.E7.m1.1.1.1.1.2.3.1" xref="S3.E7.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.2.3.3" xref="S3.E7.m1.1.1.1.1.2.3.3.cmml">o</mi><mo id="S3.E7.m1.1.1.1.1.2.3.1a" xref="S3.E7.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.2.3.4" xref="S3.E7.m1.1.1.1.1.2.3.4.cmml">t</mi><mo id="S3.E7.m1.1.1.1.1.2.3.1b" xref="S3.E7.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.2.3.5" xref="S3.E7.m1.1.1.1.1.2.3.5.cmml">a</mi><mo id="S3.E7.m1.1.1.1.1.2.3.1c" xref="S3.E7.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.2.3.6" xref="S3.E7.m1.1.1.1.1.2.3.6.cmml">l</mi></mrow></msub><mo id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3.cmml"><msub id="S3.E7.m1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.3.2.cmml"><mi id="S3.E7.m1.1.1.1.1.3.2.2" xref="S3.E7.m1.1.1.1.1.3.2.2.cmml">𝐋</mi><mrow id="S3.E7.m1.1.1.1.1.3.2.3" xref="S3.E7.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.3.2.3.2" xref="S3.E7.m1.1.1.1.1.3.2.3.2.cmml">r</mi><mo id="S3.E7.m1.1.1.1.1.3.2.3.1" xref="S3.E7.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.2.3.3" xref="S3.E7.m1.1.1.1.1.3.2.3.3.cmml">e</mi><mo id="S3.E7.m1.1.1.1.1.3.2.3.1a" xref="S3.E7.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.2.3.4" xref="S3.E7.m1.1.1.1.1.3.2.3.4.cmml">c</mi></mrow></msub><mo id="S3.E7.m1.1.1.1.1.3.1" xref="S3.E7.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E7.m1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.3.3.cmml"><msub id="S3.E7.m1.1.1.1.1.3.3.2" xref="S3.E7.m1.1.1.1.1.3.3.2.cmml"><mi id="S3.E7.m1.1.1.1.1.3.3.2.2" xref="S3.E7.m1.1.1.1.1.3.3.2.2.cmml">λ</mi><mrow id="S3.E7.m1.1.1.1.1.3.3.2.3" xref="S3.E7.m1.1.1.1.1.3.3.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.3.3.2.3.2" xref="S3.E7.m1.1.1.1.1.3.3.2.3.2.cmml">i</mi><mo id="S3.E7.m1.1.1.1.1.3.3.2.3.1" xref="S3.E7.m1.1.1.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.3.2.3.3" xref="S3.E7.m1.1.1.1.1.3.3.2.3.3.cmml">d</mi><mo id="S3.E7.m1.1.1.1.1.3.3.2.3.1a" xref="S3.E7.m1.1.1.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.3.2.3.4" xref="S3.E7.m1.1.1.1.1.3.3.2.3.4.cmml">e</mi><mo id="S3.E7.m1.1.1.1.1.3.3.2.3.1b" xref="S3.E7.m1.1.1.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.3.2.3.5" xref="S3.E7.m1.1.1.1.1.3.3.2.3.5.cmml">n</mi><mo id="S3.E7.m1.1.1.1.1.3.3.2.3.1c" xref="S3.E7.m1.1.1.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.3.2.3.6" xref="S3.E7.m1.1.1.1.1.3.3.2.3.6.cmml">t</mi><mo id="S3.E7.m1.1.1.1.1.3.3.2.3.1d" xref="S3.E7.m1.1.1.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.3.2.3.7" xref="S3.E7.m1.1.1.1.1.3.3.2.3.7.cmml">i</mi><mo id="S3.E7.m1.1.1.1.1.3.3.2.3.1e" xref="S3.E7.m1.1.1.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.3.2.3.8" xref="S3.E7.m1.1.1.1.1.3.3.2.3.8.cmml">t</mi><mo id="S3.E7.m1.1.1.1.1.3.3.2.3.1f" xref="S3.E7.m1.1.1.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.3.2.3.9" xref="S3.E7.m1.1.1.1.1.3.3.2.3.9.cmml">y</mi></mrow></msub><mo id="S3.E7.m1.1.1.1.1.3.3.1" xref="S3.E7.m1.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S3.E7.m1.1.1.1.1.3.3.3" xref="S3.E7.m1.1.1.1.1.3.3.3.cmml"><mi id="S3.E7.m1.1.1.1.1.3.3.3.2" xref="S3.E7.m1.1.1.1.1.3.3.3.2.cmml">𝐋</mi><mrow id="S3.E7.m1.1.1.1.1.3.3.3.3" xref="S3.E7.m1.1.1.1.1.3.3.3.3.cmml"><mi id="S3.E7.m1.1.1.1.1.3.3.3.3.2" xref="S3.E7.m1.1.1.1.1.3.3.3.3.2.cmml">i</mi><mo id="S3.E7.m1.1.1.1.1.3.3.3.3.1" xref="S3.E7.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.3.3.3.3" xref="S3.E7.m1.1.1.1.1.3.3.3.3.3.cmml">d</mi><mo id="S3.E7.m1.1.1.1.1.3.3.3.3.1a" xref="S3.E7.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.3.3.3.4" xref="S3.E7.m1.1.1.1.1.3.3.3.3.4.cmml">e</mi><mo id="S3.E7.m1.1.1.1.1.3.3.3.3.1b" xref="S3.E7.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.3.3.3.5" xref="S3.E7.m1.1.1.1.1.3.3.3.3.5.cmml">n</mi><mo id="S3.E7.m1.1.1.1.1.3.3.3.3.1c" xref="S3.E7.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.3.3.3.6" xref="S3.E7.m1.1.1.1.1.3.3.3.3.6.cmml">t</mi><mo id="S3.E7.m1.1.1.1.1.3.3.3.3.1d" xref="S3.E7.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.3.3.3.7" xref="S3.E7.m1.1.1.1.1.3.3.3.3.7.cmml">i</mi><mo id="S3.E7.m1.1.1.1.1.3.3.3.3.1e" xref="S3.E7.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.3.3.3.8" xref="S3.E7.m1.1.1.1.1.3.3.3.3.8.cmml">t</mi><mo id="S3.E7.m1.1.1.1.1.3.3.3.3.1f" xref="S3.E7.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.3.3.3.9" xref="S3.E7.m1.1.1.1.1.3.3.3.3.9.cmml">y</mi></mrow></msub></mrow><mo id="S3.E7.m1.1.1.1.1.3.1a" xref="S3.E7.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E7.m1.1.1.1.1.3.4" xref="S3.E7.m1.1.1.1.1.3.4.cmml"><msub id="S3.E7.m1.1.1.1.1.3.4.2" xref="S3.E7.m1.1.1.1.1.3.4.2.cmml"><mi id="S3.E7.m1.1.1.1.1.3.4.2.2" xref="S3.E7.m1.1.1.1.1.3.4.2.2.cmml">λ</mi><mrow id="S3.E7.m1.1.1.1.1.3.4.2.3" xref="S3.E7.m1.1.1.1.1.3.4.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.3.4.2.3.2" xref="S3.E7.m1.1.1.1.1.3.4.2.3.2.cmml">c</mi><mo id="S3.E7.m1.1.1.1.1.3.4.2.3.1" xref="S3.E7.m1.1.1.1.1.3.4.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.4.2.3.3" xref="S3.E7.m1.1.1.1.1.3.4.2.3.3.cmml">l</mi><mo id="S3.E7.m1.1.1.1.1.3.4.2.3.1a" xref="S3.E7.m1.1.1.1.1.3.4.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.4.2.3.4" xref="S3.E7.m1.1.1.1.1.3.4.2.3.4.cmml">i</mi><mo id="S3.E7.m1.1.1.1.1.3.4.2.3.1b" xref="S3.E7.m1.1.1.1.1.3.4.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.4.2.3.5" xref="S3.E7.m1.1.1.1.1.3.4.2.3.5.cmml">p</mi></mrow></msub><mo id="S3.E7.m1.1.1.1.1.3.4.1" xref="S3.E7.m1.1.1.1.1.3.4.1.cmml">⁢</mo><msub id="S3.E7.m1.1.1.1.1.3.4.3" xref="S3.E7.m1.1.1.1.1.3.4.3.cmml"><mi id="S3.E7.m1.1.1.1.1.3.4.3.2" xref="S3.E7.m1.1.1.1.1.3.4.3.2.cmml">𝐋</mi><mrow id="S3.E7.m1.1.1.1.1.3.4.3.3" xref="S3.E7.m1.1.1.1.1.3.4.3.3.cmml"><mi id="S3.E7.m1.1.1.1.1.3.4.3.3.2" xref="S3.E7.m1.1.1.1.1.3.4.3.3.2.cmml">c</mi><mo id="S3.E7.m1.1.1.1.1.3.4.3.3.1" xref="S3.E7.m1.1.1.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.4.3.3.3" xref="S3.E7.m1.1.1.1.1.3.4.3.3.3.cmml">l</mi><mo id="S3.E7.m1.1.1.1.1.3.4.3.3.1a" xref="S3.E7.m1.1.1.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.4.3.3.4" xref="S3.E7.m1.1.1.1.1.3.4.3.3.4.cmml">i</mi><mo id="S3.E7.m1.1.1.1.1.3.4.3.3.1b" xref="S3.E7.m1.1.1.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.4.3.3.5" xref="S3.E7.m1.1.1.1.1.3.4.3.3.5.cmml">p</mi></mrow></msub></mrow></mrow></mrow><mo id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><eq id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"></eq><apply id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.2.2">𝐋</ci><apply id="S3.E7.m1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.2.3"><times id="S3.E7.m1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.2.3.1"></times><ci id="S3.E7.m1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.2.3.2">𝑡</ci><ci id="S3.E7.m1.1.1.1.1.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.2.3.3">𝑜</ci><ci id="S3.E7.m1.1.1.1.1.2.3.4.cmml" xref="S3.E7.m1.1.1.1.1.2.3.4">𝑡</ci><ci id="S3.E7.m1.1.1.1.1.2.3.5.cmml" xref="S3.E7.m1.1.1.1.1.2.3.5">𝑎</ci><ci id="S3.E7.m1.1.1.1.1.2.3.6.cmml" xref="S3.E7.m1.1.1.1.1.2.3.6">𝑙</ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3"><plus id="S3.E7.m1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.1"></plus><apply id="S3.E7.m1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2.2">𝐋</ci><apply id="S3.E7.m1.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3"><times id="S3.E7.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.1"></times><ci id="S3.E7.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.2">𝑟</ci><ci id="S3.E7.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.3">𝑒</ci><ci id="S3.E7.m1.1.1.1.1.3.2.3.4.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.4">𝑐</ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3"><times id="S3.E7.m1.1.1.1.1.3.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.3.1"></times><apply id="S3.E7.m1.1.1.1.1.3.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.3.2.2">𝜆</ci><apply id="S3.E7.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3.2.3"><times id="S3.E7.m1.1.1.1.1.3.3.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.3.2.3.1"></times><ci id="S3.E7.m1.1.1.1.1.3.3.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.3.2.3.2">𝑖</ci><ci id="S3.E7.m1.1.1.1.1.3.3.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3.2.3.3">𝑑</ci><ci id="S3.E7.m1.1.1.1.1.3.3.2.3.4.cmml" xref="S3.E7.m1.1.1.1.1.3.3.2.3.4">𝑒</ci><ci id="S3.E7.m1.1.1.1.1.3.3.2.3.5.cmml" xref="S3.E7.m1.1.1.1.1.3.3.2.3.5">𝑛</ci><ci id="S3.E7.m1.1.1.1.1.3.3.2.3.6.cmml" xref="S3.E7.m1.1.1.1.1.3.3.2.3.6">𝑡</ci><ci id="S3.E7.m1.1.1.1.1.3.3.2.3.7.cmml" xref="S3.E7.m1.1.1.1.1.3.3.2.3.7">𝑖</ci><ci id="S3.E7.m1.1.1.1.1.3.3.2.3.8.cmml" xref="S3.E7.m1.1.1.1.1.3.3.2.3.8">𝑡</ci><ci id="S3.E7.m1.1.1.1.1.3.3.2.3.9.cmml" xref="S3.E7.m1.1.1.1.1.3.3.2.3.9">𝑦</ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.2">𝐋</ci><apply id="S3.E7.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3"><times id="S3.E7.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3.1"></times><ci id="S3.E7.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3.2">𝑖</ci><ci id="S3.E7.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3.3">𝑑</ci><ci id="S3.E7.m1.1.1.1.1.3.3.3.3.4.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3.4">𝑒</ci><ci id="S3.E7.m1.1.1.1.1.3.3.3.3.5.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3.5">𝑛</ci><ci id="S3.E7.m1.1.1.1.1.3.3.3.3.6.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3.6">𝑡</ci><ci id="S3.E7.m1.1.1.1.1.3.3.3.3.7.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3.7">𝑖</ci><ci id="S3.E7.m1.1.1.1.1.3.3.3.3.8.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3.8">𝑡</ci><ci id="S3.E7.m1.1.1.1.1.3.3.3.3.9.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3.9">𝑦</ci></apply></apply></apply><apply id="S3.E7.m1.1.1.1.1.3.4.cmml" xref="S3.E7.m1.1.1.1.1.3.4"><times id="S3.E7.m1.1.1.1.1.3.4.1.cmml" xref="S3.E7.m1.1.1.1.1.3.4.1"></times><apply id="S3.E7.m1.1.1.1.1.3.4.2.cmml" xref="S3.E7.m1.1.1.1.1.3.4.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.4.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.4.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.4.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.4.2.2">𝜆</ci><apply id="S3.E7.m1.1.1.1.1.3.4.2.3.cmml" xref="S3.E7.m1.1.1.1.1.3.4.2.3"><times id="S3.E7.m1.1.1.1.1.3.4.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.4.2.3.1"></times><ci id="S3.E7.m1.1.1.1.1.3.4.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.4.2.3.2">𝑐</ci><ci id="S3.E7.m1.1.1.1.1.3.4.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.4.2.3.3">𝑙</ci><ci id="S3.E7.m1.1.1.1.1.3.4.2.3.4.cmml" xref="S3.E7.m1.1.1.1.1.3.4.2.3.4">𝑖</ci><ci id="S3.E7.m1.1.1.1.1.3.4.2.3.5.cmml" xref="S3.E7.m1.1.1.1.1.3.4.2.3.5">𝑝</ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.3.4.3.cmml" xref="S3.E7.m1.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.4.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.4.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.4.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.4.3.2">𝐋</ci><apply id="S3.E7.m1.1.1.1.1.3.4.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.4.3.3"><times id="S3.E7.m1.1.1.1.1.3.4.3.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.4.3.3.1"></times><ci id="S3.E7.m1.1.1.1.1.3.4.3.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.4.3.3.2">𝑐</ci><ci id="S3.E7.m1.1.1.1.1.3.4.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.4.3.3.3">𝑙</ci><ci id="S3.E7.m1.1.1.1.1.3.4.3.3.4.cmml" xref="S3.E7.m1.1.1.1.1.3.4.3.3.4">𝑖</ci><ci id="S3.E7.m1.1.1.1.1.3.4.3.3.5.cmml" xref="S3.E7.m1.1.1.1.1.3.4.3.3.5">𝑝</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\mathbf{L}_{total}=\mathbf{L}_{rec}+\lambda_{identity}\mathbf{L}_{identity}+%
\lambda_{clip}\mathbf{L}_{clip},</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.1d">bold_L start_POSTSUBSCRIPT italic_t italic_o italic_t italic_a italic_l end_POSTSUBSCRIPT = bold_L start_POSTSUBSCRIPT italic_r italic_e italic_c end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT italic_i italic_d italic_e italic_n italic_t italic_i italic_t italic_y end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT italic_i italic_d italic_e italic_n italic_t italic_i italic_t italic_y end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT italic_c italic_l italic_i italic_p end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT italic_c italic_l italic_i italic_p end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p1.12">where <math alttext="\lambda_{identity}" class="ltx_Math" display="inline" id="S3.SS4.p1.11.m1.1"><semantics id="S3.SS4.p1.11.m1.1a"><msub id="S3.SS4.p1.11.m1.1.1" xref="S3.SS4.p1.11.m1.1.1.cmml"><mi id="S3.SS4.p1.11.m1.1.1.2" xref="S3.SS4.p1.11.m1.1.1.2.cmml">λ</mi><mrow id="S3.SS4.p1.11.m1.1.1.3" xref="S3.SS4.p1.11.m1.1.1.3.cmml"><mi id="S3.SS4.p1.11.m1.1.1.3.2" xref="S3.SS4.p1.11.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS4.p1.11.m1.1.1.3.1" xref="S3.SS4.p1.11.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.11.m1.1.1.3.3" xref="S3.SS4.p1.11.m1.1.1.3.3.cmml">d</mi><mo id="S3.SS4.p1.11.m1.1.1.3.1a" xref="S3.SS4.p1.11.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.11.m1.1.1.3.4" xref="S3.SS4.p1.11.m1.1.1.3.4.cmml">e</mi><mo id="S3.SS4.p1.11.m1.1.1.3.1b" xref="S3.SS4.p1.11.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.11.m1.1.1.3.5" xref="S3.SS4.p1.11.m1.1.1.3.5.cmml">n</mi><mo id="S3.SS4.p1.11.m1.1.1.3.1c" xref="S3.SS4.p1.11.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.11.m1.1.1.3.6" xref="S3.SS4.p1.11.m1.1.1.3.6.cmml">t</mi><mo id="S3.SS4.p1.11.m1.1.1.3.1d" xref="S3.SS4.p1.11.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.11.m1.1.1.3.7" xref="S3.SS4.p1.11.m1.1.1.3.7.cmml">i</mi><mo id="S3.SS4.p1.11.m1.1.1.3.1e" xref="S3.SS4.p1.11.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.11.m1.1.1.3.8" xref="S3.SS4.p1.11.m1.1.1.3.8.cmml">t</mi><mo id="S3.SS4.p1.11.m1.1.1.3.1f" xref="S3.SS4.p1.11.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.11.m1.1.1.3.9" xref="S3.SS4.p1.11.m1.1.1.3.9.cmml">y</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.11.m1.1b"><apply id="S3.SS4.p1.11.m1.1.1.cmml" xref="S3.SS4.p1.11.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m1.1.1.1.cmml" xref="S3.SS4.p1.11.m1.1.1">subscript</csymbol><ci id="S3.SS4.p1.11.m1.1.1.2.cmml" xref="S3.SS4.p1.11.m1.1.1.2">𝜆</ci><apply id="S3.SS4.p1.11.m1.1.1.3.cmml" xref="S3.SS4.p1.11.m1.1.1.3"><times id="S3.SS4.p1.11.m1.1.1.3.1.cmml" xref="S3.SS4.p1.11.m1.1.1.3.1"></times><ci id="S3.SS4.p1.11.m1.1.1.3.2.cmml" xref="S3.SS4.p1.11.m1.1.1.3.2">𝑖</ci><ci id="S3.SS4.p1.11.m1.1.1.3.3.cmml" xref="S3.SS4.p1.11.m1.1.1.3.3">𝑑</ci><ci id="S3.SS4.p1.11.m1.1.1.3.4.cmml" xref="S3.SS4.p1.11.m1.1.1.3.4">𝑒</ci><ci id="S3.SS4.p1.11.m1.1.1.3.5.cmml" xref="S3.SS4.p1.11.m1.1.1.3.5">𝑛</ci><ci id="S3.SS4.p1.11.m1.1.1.3.6.cmml" xref="S3.SS4.p1.11.m1.1.1.3.6">𝑡</ci><ci id="S3.SS4.p1.11.m1.1.1.3.7.cmml" xref="S3.SS4.p1.11.m1.1.1.3.7">𝑖</ci><ci id="S3.SS4.p1.11.m1.1.1.3.8.cmml" xref="S3.SS4.p1.11.m1.1.1.3.8">𝑡</ci><ci id="S3.SS4.p1.11.m1.1.1.3.9.cmml" xref="S3.SS4.p1.11.m1.1.1.3.9">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.11.m1.1c">\lambda_{identity}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.11.m1.1d">italic_λ start_POSTSUBSCRIPT italic_i italic_d italic_e italic_n italic_t italic_i italic_t italic_y end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\lambda_{clip}" class="ltx_Math" display="inline" id="S3.SS4.p1.12.m2.1"><semantics id="S3.SS4.p1.12.m2.1a"><msub id="S3.SS4.p1.12.m2.1.1" xref="S3.SS4.p1.12.m2.1.1.cmml"><mi id="S3.SS4.p1.12.m2.1.1.2" xref="S3.SS4.p1.12.m2.1.1.2.cmml">λ</mi><mrow id="S3.SS4.p1.12.m2.1.1.3" xref="S3.SS4.p1.12.m2.1.1.3.cmml"><mi id="S3.SS4.p1.12.m2.1.1.3.2" xref="S3.SS4.p1.12.m2.1.1.3.2.cmml">c</mi><mo id="S3.SS4.p1.12.m2.1.1.3.1" xref="S3.SS4.p1.12.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.12.m2.1.1.3.3" xref="S3.SS4.p1.12.m2.1.1.3.3.cmml">l</mi><mo id="S3.SS4.p1.12.m2.1.1.3.1a" xref="S3.SS4.p1.12.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.12.m2.1.1.3.4" xref="S3.SS4.p1.12.m2.1.1.3.4.cmml">i</mi><mo id="S3.SS4.p1.12.m2.1.1.3.1b" xref="S3.SS4.p1.12.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.12.m2.1.1.3.5" xref="S3.SS4.p1.12.m2.1.1.3.5.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.12.m2.1b"><apply id="S3.SS4.p1.12.m2.1.1.cmml" xref="S3.SS4.p1.12.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.12.m2.1.1.1.cmml" xref="S3.SS4.p1.12.m2.1.1">subscript</csymbol><ci id="S3.SS4.p1.12.m2.1.1.2.cmml" xref="S3.SS4.p1.12.m2.1.1.2">𝜆</ci><apply id="S3.SS4.p1.12.m2.1.1.3.cmml" xref="S3.SS4.p1.12.m2.1.1.3"><times id="S3.SS4.p1.12.m2.1.1.3.1.cmml" xref="S3.SS4.p1.12.m2.1.1.3.1"></times><ci id="S3.SS4.p1.12.m2.1.1.3.2.cmml" xref="S3.SS4.p1.12.m2.1.1.3.2">𝑐</ci><ci id="S3.SS4.p1.12.m2.1.1.3.3.cmml" xref="S3.SS4.p1.12.m2.1.1.3.3">𝑙</ci><ci id="S3.SS4.p1.12.m2.1.1.3.4.cmml" xref="S3.SS4.p1.12.m2.1.1.3.4">𝑖</ci><ci id="S3.SS4.p1.12.m2.1.1.3.5.cmml" xref="S3.SS4.p1.12.m2.1.1.3.5">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.12.m2.1c">\lambda_{clip}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.12.m2.1d">italic_λ start_POSTSUBSCRIPT italic_c italic_l italic_i italic_p end_POSTSUBSCRIPT</annotation></semantics></math> are the trade-off parameters.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE I: </span><span class="ltx_text ltx_font_bold" id="S3.T1.17.1">Quantitative evaluation on LOL-Blur dataset.</span> PSNR/SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T1.3.m1.1"><semantics id="S3.T1.3.m1.1b"><mo id="S3.T1.3.m1.1.1" stretchy="false" xref="S3.T1.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.3.m1.1c"><ci id="S3.T1.3.m1.1.1.cmml" xref="S3.T1.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.m1.1d">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.3.m1.1e">↑</annotation></semantics></math>: the higher, the better; LPIPS<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T1.4.m2.1"><semantics id="S3.T1.4.m2.1b"><mo id="S3.T1.4.m2.1.1" stretchy="false" xref="S3.T1.4.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.4.m2.1c"><ci id="S3.T1.4.m2.1.1.cmml" xref="S3.T1.4.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.m2.1d">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.4.m2.1e">↑</annotation></semantics></math>: the lower, the better. Best values are indicated with <span class="ltx_text ltx_font_bold" id="S3.T1.18.2">bold</span> text.</figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S3.T1.14" style="width:433.6pt;height:454.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(70.7pt,-74.1pt) scale(1.48415322578539,1.48415322578539) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.14.10">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.7.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S3.T1.7.3.3.4">Methods</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.5.1.1.1"><math alttext="PSNR\uparrow" class="ltx_Math" display="inline" id="S3.T1.5.1.1.1.m1.1"><semantics id="S3.T1.5.1.1.1.m1.1a"><mrow id="S3.T1.5.1.1.1.m1.1.1" xref="S3.T1.5.1.1.1.m1.1.1.cmml"><mrow id="S3.T1.5.1.1.1.m1.1.1.2" xref="S3.T1.5.1.1.1.m1.1.1.2.cmml"><mi id="S3.T1.5.1.1.1.m1.1.1.2.2" xref="S3.T1.5.1.1.1.m1.1.1.2.2.cmml">P</mi><mo id="S3.T1.5.1.1.1.m1.1.1.2.1" xref="S3.T1.5.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T1.5.1.1.1.m1.1.1.2.3" xref="S3.T1.5.1.1.1.m1.1.1.2.3.cmml">S</mi><mo id="S3.T1.5.1.1.1.m1.1.1.2.1a" xref="S3.T1.5.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T1.5.1.1.1.m1.1.1.2.4" xref="S3.T1.5.1.1.1.m1.1.1.2.4.cmml">N</mi><mo id="S3.T1.5.1.1.1.m1.1.1.2.1b" xref="S3.T1.5.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T1.5.1.1.1.m1.1.1.2.5" xref="S3.T1.5.1.1.1.m1.1.1.2.5.cmml">R</mi></mrow><mo id="S3.T1.5.1.1.1.m1.1.1.1" stretchy="false" xref="S3.T1.5.1.1.1.m1.1.1.1.cmml">↑</mo><mi id="S3.T1.5.1.1.1.m1.1.1.3" xref="S3.T1.5.1.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.5.1.1.1.m1.1b"><apply id="S3.T1.5.1.1.1.m1.1.1.cmml" xref="S3.T1.5.1.1.1.m1.1.1"><ci id="S3.T1.5.1.1.1.m1.1.1.1.cmml" xref="S3.T1.5.1.1.1.m1.1.1.1">↑</ci><apply id="S3.T1.5.1.1.1.m1.1.1.2.cmml" xref="S3.T1.5.1.1.1.m1.1.1.2"><times id="S3.T1.5.1.1.1.m1.1.1.2.1.cmml" xref="S3.T1.5.1.1.1.m1.1.1.2.1"></times><ci id="S3.T1.5.1.1.1.m1.1.1.2.2.cmml" xref="S3.T1.5.1.1.1.m1.1.1.2.2">𝑃</ci><ci id="S3.T1.5.1.1.1.m1.1.1.2.3.cmml" xref="S3.T1.5.1.1.1.m1.1.1.2.3">𝑆</ci><ci id="S3.T1.5.1.1.1.m1.1.1.2.4.cmml" xref="S3.T1.5.1.1.1.m1.1.1.2.4">𝑁</ci><ci id="S3.T1.5.1.1.1.m1.1.1.2.5.cmml" xref="S3.T1.5.1.1.1.m1.1.1.2.5">𝑅</ci></apply><csymbol cd="latexml" id="S3.T1.5.1.1.1.m1.1.1.3.cmml" xref="S3.T1.5.1.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.1.1.1.m1.1c">PSNR\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.5.1.1.1.m1.1d">italic_P italic_S italic_N italic_R ↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.6.2.2.2"><math alttext="SSIM\uparrow" class="ltx_Math" display="inline" id="S3.T1.6.2.2.2.m1.1"><semantics id="S3.T1.6.2.2.2.m1.1a"><mrow id="S3.T1.6.2.2.2.m1.1.1" xref="S3.T1.6.2.2.2.m1.1.1.cmml"><mrow id="S3.T1.6.2.2.2.m1.1.1.2" xref="S3.T1.6.2.2.2.m1.1.1.2.cmml"><mi id="S3.T1.6.2.2.2.m1.1.1.2.2" xref="S3.T1.6.2.2.2.m1.1.1.2.2.cmml">S</mi><mo id="S3.T1.6.2.2.2.m1.1.1.2.1" xref="S3.T1.6.2.2.2.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T1.6.2.2.2.m1.1.1.2.3" xref="S3.T1.6.2.2.2.m1.1.1.2.3.cmml">S</mi><mo id="S3.T1.6.2.2.2.m1.1.1.2.1a" xref="S3.T1.6.2.2.2.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T1.6.2.2.2.m1.1.1.2.4" xref="S3.T1.6.2.2.2.m1.1.1.2.4.cmml">I</mi><mo id="S3.T1.6.2.2.2.m1.1.1.2.1b" xref="S3.T1.6.2.2.2.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T1.6.2.2.2.m1.1.1.2.5" xref="S3.T1.6.2.2.2.m1.1.1.2.5.cmml">M</mi></mrow><mo id="S3.T1.6.2.2.2.m1.1.1.1" stretchy="false" xref="S3.T1.6.2.2.2.m1.1.1.1.cmml">↑</mo><mi id="S3.T1.6.2.2.2.m1.1.1.3" xref="S3.T1.6.2.2.2.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.6.2.2.2.m1.1b"><apply id="S3.T1.6.2.2.2.m1.1.1.cmml" xref="S3.T1.6.2.2.2.m1.1.1"><ci id="S3.T1.6.2.2.2.m1.1.1.1.cmml" xref="S3.T1.6.2.2.2.m1.1.1.1">↑</ci><apply id="S3.T1.6.2.2.2.m1.1.1.2.cmml" xref="S3.T1.6.2.2.2.m1.1.1.2"><times id="S3.T1.6.2.2.2.m1.1.1.2.1.cmml" xref="S3.T1.6.2.2.2.m1.1.1.2.1"></times><ci id="S3.T1.6.2.2.2.m1.1.1.2.2.cmml" xref="S3.T1.6.2.2.2.m1.1.1.2.2">𝑆</ci><ci id="S3.T1.6.2.2.2.m1.1.1.2.3.cmml" xref="S3.T1.6.2.2.2.m1.1.1.2.3">𝑆</ci><ci id="S3.T1.6.2.2.2.m1.1.1.2.4.cmml" xref="S3.T1.6.2.2.2.m1.1.1.2.4">𝐼</ci><ci id="S3.T1.6.2.2.2.m1.1.1.2.5.cmml" xref="S3.T1.6.2.2.2.m1.1.1.2.5">𝑀</ci></apply><csymbol cd="latexml" id="S3.T1.6.2.2.2.m1.1.1.3.cmml" xref="S3.T1.6.2.2.2.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.2.2.2.m1.1c">SSIM\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.6.2.2.2.m1.1d">italic_S italic_S italic_I italic_M ↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.3.3.3"><math alttext="LPIPS\downarrow" class="ltx_Math" display="inline" id="S3.T1.7.3.3.3.m1.1"><semantics id="S3.T1.7.3.3.3.m1.1a"><mrow id="S3.T1.7.3.3.3.m1.1.1" xref="S3.T1.7.3.3.3.m1.1.1.cmml"><mrow id="S3.T1.7.3.3.3.m1.1.1.2" xref="S3.T1.7.3.3.3.m1.1.1.2.cmml"><mi id="S3.T1.7.3.3.3.m1.1.1.2.2" xref="S3.T1.7.3.3.3.m1.1.1.2.2.cmml">L</mi><mo id="S3.T1.7.3.3.3.m1.1.1.2.1" xref="S3.T1.7.3.3.3.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T1.7.3.3.3.m1.1.1.2.3" xref="S3.T1.7.3.3.3.m1.1.1.2.3.cmml">P</mi><mo id="S3.T1.7.3.3.3.m1.1.1.2.1a" xref="S3.T1.7.3.3.3.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T1.7.3.3.3.m1.1.1.2.4" xref="S3.T1.7.3.3.3.m1.1.1.2.4.cmml">I</mi><mo id="S3.T1.7.3.3.3.m1.1.1.2.1b" xref="S3.T1.7.3.3.3.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T1.7.3.3.3.m1.1.1.2.5" xref="S3.T1.7.3.3.3.m1.1.1.2.5.cmml">P</mi><mo id="S3.T1.7.3.3.3.m1.1.1.2.1c" xref="S3.T1.7.3.3.3.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T1.7.3.3.3.m1.1.1.2.6" xref="S3.T1.7.3.3.3.m1.1.1.2.6.cmml">S</mi></mrow><mo id="S3.T1.7.3.3.3.m1.1.1.1" stretchy="false" xref="S3.T1.7.3.3.3.m1.1.1.1.cmml">↓</mo><mi id="S3.T1.7.3.3.3.m1.1.1.3" xref="S3.T1.7.3.3.3.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.7.3.3.3.m1.1b"><apply id="S3.T1.7.3.3.3.m1.1.1.cmml" xref="S3.T1.7.3.3.3.m1.1.1"><ci id="S3.T1.7.3.3.3.m1.1.1.1.cmml" xref="S3.T1.7.3.3.3.m1.1.1.1">↓</ci><apply id="S3.T1.7.3.3.3.m1.1.1.2.cmml" xref="S3.T1.7.3.3.3.m1.1.1.2"><times id="S3.T1.7.3.3.3.m1.1.1.2.1.cmml" xref="S3.T1.7.3.3.3.m1.1.1.2.1"></times><ci id="S3.T1.7.3.3.3.m1.1.1.2.2.cmml" xref="S3.T1.7.3.3.3.m1.1.1.2.2">𝐿</ci><ci id="S3.T1.7.3.3.3.m1.1.1.2.3.cmml" xref="S3.T1.7.3.3.3.m1.1.1.2.3">𝑃</ci><ci id="S3.T1.7.3.3.3.m1.1.1.2.4.cmml" xref="S3.T1.7.3.3.3.m1.1.1.2.4">𝐼</ci><ci id="S3.T1.7.3.3.3.m1.1.1.2.5.cmml" xref="S3.T1.7.3.3.3.m1.1.1.2.5">𝑃</ci><ci id="S3.T1.7.3.3.3.m1.1.1.2.6.cmml" xref="S3.T1.7.3.3.3.m1.1.1.2.6">𝑆</ci></apply><csymbol cd="latexml" id="S3.T1.7.3.3.3.m1.1.1.3.cmml" xref="S3.T1.7.3.3.3.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.3.3.3.m1.1c">LPIPS\downarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.7.3.3.3.m1.1d">italic_L italic_P italic_I italic_P italic_S ↓</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T1.8.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="4" id="S3.T1.8.4.4.1" style="background-color:#F2F2D9;"><span class="ltx_text" id="S3.T1.8.4.4.1.1" style="background-color:#F2F2D9;">Enhancement <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.T1.8.4.4.1.1.m1.1"><semantics id="S3.T1.8.4.4.1.1.m1.1a"><mo id="S3.T1.8.4.4.1.1.m1.1.1" mathbackground="#F2F2D9" stretchy="false" xref="S3.T1.8.4.4.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T1.8.4.4.1.1.m1.1b"><ci id="S3.T1.8.4.4.1.1.m1.1.1.cmml" xref="S3.T1.8.4.4.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.4.4.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.8.4.4.1.1.m1.1d">→</annotation></semantics></math> Deblurring</span></th>
</tr>
<tr class="ltx_tr" id="S3.T1.9.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S3.T1.9.5.5.1">Zero-DCE <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.T1.9.5.5.1.m1.1"><semantics id="S3.T1.9.5.5.1.m1.1a"><mo id="S3.T1.9.5.5.1.m1.1.1" stretchy="false" xref="S3.T1.9.5.5.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T1.9.5.5.1.m1.1b"><ci id="S3.T1.9.5.5.1.m1.1.1.cmml" xref="S3.T1.9.5.5.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.5.5.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.9.5.5.1.m1.1d">→</annotation></semantics></math> MIMO</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.9.5.5.2">17.68</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.9.5.5.3">0.542</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.9.5.5.4">0.510</td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.6.6.1">RUAS <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.T1.10.6.6.1.m1.1"><semantics id="S3.T1.10.6.6.1.m1.1a"><mo id="S3.T1.10.6.6.1.m1.1.1" stretchy="false" xref="S3.T1.10.6.6.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T1.10.6.6.1.m1.1b"><ci id="S3.T1.10.6.6.1.m1.1.1.cmml" xref="S3.T1.10.6.6.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.6.6.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.10.6.6.1.m1.1d">→</annotation></semantics></math> MIMO</th>
<td class="ltx_td ltx_align_center" id="S3.T1.10.6.6.2">17.81</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.10.6.6.3">0.569</td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.6.6.4">0.523</td>
</tr>
<tr class="ltx_tr" id="S3.T1.11.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="4" id="S3.T1.11.7.7.1" style="background-color:#F9FFE6;"><span class="ltx_text" id="S3.T1.11.7.7.1.1" style="background-color:#F9FFE6;">Deblurring <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.T1.11.7.7.1.1.m1.1"><semantics id="S3.T1.11.7.7.1.1.m1.1a"><mo id="S3.T1.11.7.7.1.1.m1.1.1" mathbackground="#F9FFE6" stretchy="false" xref="S3.T1.11.7.7.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T1.11.7.7.1.1.m1.1b"><ci id="S3.T1.11.7.7.1.1.m1.1.1.cmml" xref="S3.T1.11.7.7.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.7.7.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.11.7.7.1.1.m1.1d">→</annotation></semantics></math> Enhancement</span></th>
</tr>
<tr class="ltx_tr" id="S3.T1.12.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S3.T1.12.8.8.1">Chen <span class="ltx_text ltx_font_italic" id="S3.T1.12.8.8.1.1">et al.</span> <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.T1.12.8.8.1.m1.1"><semantics id="S3.T1.12.8.8.1.m1.1a"><mo id="S3.T1.12.8.8.1.m1.1.1" stretchy="false" xref="S3.T1.12.8.8.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T1.12.8.8.1.m1.1b"><ci id="S3.T1.12.8.8.1.m1.1.1.cmml" xref="S3.T1.12.8.8.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.8.8.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.12.8.8.1.m1.1d">→</annotation></semantics></math> Zero-DCE</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.12.8.8.2">17.02</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.12.8.8.3">0.502</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.12.8.8.4">0.516</td>
</tr>
<tr class="ltx_tr" id="S3.T1.13.9.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.13.9.9.1">DeblurGAN-v2 <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.T1.13.9.9.1.m1.1"><semantics id="S3.T1.13.9.9.1.m1.1a"><mo id="S3.T1.13.9.9.1.m1.1.1" stretchy="false" xref="S3.T1.13.9.9.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T1.13.9.9.1.m1.1b"><ci id="S3.T1.13.9.9.1.m1.1.1.cmml" xref="S3.T1.13.9.9.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.13.9.9.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.13.9.9.1.m1.1d">→</annotation></semantics></math> Zero-DCE</th>
<td class="ltx_td ltx_align_center" id="S3.T1.13.9.9.2">18.33</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.13.9.9.3">0.589</td>
<td class="ltx_td ltx_align_center" id="S3.T1.13.9.9.4">0.476</td>
</tr>
<tr class="ltx_tr" id="S3.T1.14.10.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.14.10.10.1">MIMO <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.T1.14.10.10.1.m1.1"><semantics id="S3.T1.14.10.10.1.m1.1a"><mo id="S3.T1.14.10.10.1.m1.1.1" stretchy="false" xref="S3.T1.14.10.10.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T1.14.10.10.1.m1.1b"><ci id="S3.T1.14.10.10.1.m1.1.1.cmml" xref="S3.T1.14.10.10.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.14.10.10.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.14.10.10.1.m1.1d">→</annotation></semantics></math> Zero-DCE</th>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.10.2">17.52</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.14.10.10.3">0.57</td>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.10.4">0.498</td>
</tr>
<tr class="ltx_tr" id="S3.T1.14.10.11.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="4" id="S3.T1.14.10.11.1.1" style="background-color:#E6FFE6;"><span class="ltx_text" id="S3.T1.14.10.11.1.1.1" style="background-color:#E6FFE6;">Training on LOL-Blur</span></th>
</tr>
<tr class="ltx_tr" id="S3.T1.14.10.12.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S3.T1.14.10.12.2.1">KinD++</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.14.10.12.2.2">21.26</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.14.10.12.2.3">0.753</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.14.10.12.2.4">0.359</td>
</tr>
<tr class="ltx_tr" id="S3.T1.14.10.13.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.14.10.13.3.1">DRBN</th>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.13.3.2">21.78</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.14.10.13.3.3">0.768</td>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.13.3.4">0.325</td>
</tr>
<tr class="ltx_tr" id="S3.T1.14.10.14.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.14.10.14.4.1">DeblurGAN-v2</th>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.14.4.2">22.30</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.14.10.14.4.3">0.745</td>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.14.4.4">0.356</td>
</tr>
<tr class="ltx_tr" id="S3.T1.14.10.15.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.14.10.15.5.1">DMPHN</th>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.15.5.2">22.20</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.14.10.15.5.3">0.817</td>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.15.5.4">0.301</td>
</tr>
<tr class="ltx_tr" id="S3.T1.14.10.16.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.14.10.16.6.1">MIMO</th>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.16.6.2">22.41</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.14.10.16.6.3">0.835</td>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.16.6.4">0.262</td>
</tr>
<tr class="ltx_tr" id="S3.T1.14.10.17.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.14.10.17.7.1">LEDNet</th>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.17.7.2">25.74</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.14.10.17.7.3">0.850</td>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.17.7.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.14.10.17.7.4.1">0.224</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.14.10.18.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.14.10.18.8.1">ASP-LED</th>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.18.8.2"><span class="ltx_text ltx_font_bold" id="S3.T1.14.10.18.8.2.1">26.73</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.14.10.18.8.3"><span class="ltx_text ltx_font_bold" id="S3.T1.14.10.18.8.3.1">0.866</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.14.10.18.8.4"><span class="ltx_text ltx_font_bold" id="S3.T1.14.10.18.8.4.1">0.199</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.14.10.19.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S3.T1.14.10.19.9.1">Ours</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T1.14.10.19.9.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.14.10.19.9.2.1">26.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S3.T1.14.10.19.9.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T1.14.10.19.9.3.1">0.853</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T1.14.10.19.9.4">0.234</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span class="ltx_text ltx_font_smallcaps" id="S4.1.1">EXPERIMENTS</span>
</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS1.5.1.1">IV-A</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS1.6.2">Implementation Details and Datasets</span>
</h3>
<figure class="ltx_figure" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="401" id="S4.F6.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Visual quality comparison on the Real-LOL-Blur dataset. Please check the zoom-in patches to observe the details.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.5"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.5.1">Implementation.</span> We conduct experiments in PyTorch on 4 NVIDIA A800 GPUs. To optimize the network, we employ the Adam optimizer with a learning rate <math alttext="1\times 10^{-4}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mn id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">1</mn><mo id="S4.SS1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p1.1.m1.1.1.1.cmml">×</mo><msup id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml"><mn id="S4.SS1.p1.1.m1.1.1.3.2" xref="S4.SS1.p1.1.m1.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.p1.1.m1.1.1.3.3" xref="S4.SS1.p1.1.m1.1.1.3.3.cmml"><mo id="S4.SS1.p1.1.m1.1.1.3.3a" xref="S4.SS1.p1.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS1.p1.1.m1.1.1.3.3.2" xref="S4.SS1.p1.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><times id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1"></times><cn id="S4.SS1.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS1.p1.1.m1.1.1.2">1</cn><apply id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.3.1.cmml" xref="S4.SS1.p1.1.m1.1.1.3">superscript</csymbol><cn id="S4.SS1.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S4.SS1.p1.1.m1.1.1.3.2">10</cn><apply id="S4.SS1.p1.1.m1.1.1.3.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3.3"><minus id="S4.SS1.p1.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.p1.1.m1.1.1.3.3"></minus><cn id="S4.SS1.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.p1.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">1\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">1 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>. The network is trained for 500k iterations with a batch size of 4. During training, we utilize cropped patches of size <math alttext="512\times 512" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mn id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">512</mn><mo id="S4.SS1.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p1.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">512</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><times id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1"></times><cn id="S4.SS1.p1.2.m2.1.1.2.cmml" type="integer" xref="S4.SS1.p1.2.m2.1.1.2">512</cn><cn id="S4.SS1.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.1.1.3">512</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">512\times 512</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">512 × 512</annotation></semantics></math> as input, and to augment the training data, random horizontal and vertical flips are applied to the input images. The architecture of our method consists of a 4-level encoder-decoder, with varying numbers of Transformer blocks at each level, specifically <math alttext="[1,2,2,4]" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.4"><semantics id="S4.SS1.p1.3.m3.4a"><mrow id="S4.SS1.p1.3.m3.4.5.2" xref="S4.SS1.p1.3.m3.4.5.1.cmml"><mo id="S4.SS1.p1.3.m3.4.5.2.1" stretchy="false" xref="S4.SS1.p1.3.m3.4.5.1.cmml">[</mo><mn id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">1</mn><mo id="S4.SS1.p1.3.m3.4.5.2.2" xref="S4.SS1.p1.3.m3.4.5.1.cmml">,</mo><mn id="S4.SS1.p1.3.m3.2.2" xref="S4.SS1.p1.3.m3.2.2.cmml">2</mn><mo id="S4.SS1.p1.3.m3.4.5.2.3" xref="S4.SS1.p1.3.m3.4.5.1.cmml">,</mo><mn id="S4.SS1.p1.3.m3.3.3" xref="S4.SS1.p1.3.m3.3.3.cmml">2</mn><mo id="S4.SS1.p1.3.m3.4.5.2.4" xref="S4.SS1.p1.3.m3.4.5.1.cmml">,</mo><mn id="S4.SS1.p1.3.m3.4.4" xref="S4.SS1.p1.3.m3.4.4.cmml">4</mn><mo id="S4.SS1.p1.3.m3.4.5.2.5" stretchy="false" xref="S4.SS1.p1.3.m3.4.5.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.4b"><list id="S4.SS1.p1.3.m3.4.5.1.cmml" xref="S4.SS1.p1.3.m3.4.5.2"><cn id="S4.SS1.p1.3.m3.1.1.cmml" type="integer" xref="S4.SS1.p1.3.m3.1.1">1</cn><cn id="S4.SS1.p1.3.m3.2.2.cmml" type="integer" xref="S4.SS1.p1.3.m3.2.2">2</cn><cn id="S4.SS1.p1.3.m3.3.3.cmml" type="integer" xref="S4.SS1.p1.3.m3.3.3">2</cn><cn id="S4.SS1.p1.3.m3.4.4.cmml" type="integer" xref="S4.SS1.p1.3.m3.4.4">4</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.4c">[1,2,2,4]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.4d">[ 1 , 2 , 2 , 4 ]</annotation></semantics></math> from level-1 to level-4. For CLIP, we use the ViT-L/14 model to extract feature embeddings. Additionally, hyperparameters are empirically set as: <math alttext="\lambda_{identity}=0.1" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><mrow id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><msub id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2.2" xref="S4.SS1.p1.4.m4.1.1.2.2.cmml">λ</mi><mrow id="S4.SS1.p1.4.m4.1.1.2.3" xref="S4.SS1.p1.4.m4.1.1.2.3.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2.3.2" xref="S4.SS1.p1.4.m4.1.1.2.3.2.cmml">i</mi><mo id="S4.SS1.p1.4.m4.1.1.2.3.1" xref="S4.SS1.p1.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.4.m4.1.1.2.3.3" xref="S4.SS1.p1.4.m4.1.1.2.3.3.cmml">d</mi><mo id="S4.SS1.p1.4.m4.1.1.2.3.1a" xref="S4.SS1.p1.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.4.m4.1.1.2.3.4" xref="S4.SS1.p1.4.m4.1.1.2.3.4.cmml">e</mi><mo id="S4.SS1.p1.4.m4.1.1.2.3.1b" xref="S4.SS1.p1.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.4.m4.1.1.2.3.5" xref="S4.SS1.p1.4.m4.1.1.2.3.5.cmml">n</mi><mo id="S4.SS1.p1.4.m4.1.1.2.3.1c" xref="S4.SS1.p1.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.4.m4.1.1.2.3.6" xref="S4.SS1.p1.4.m4.1.1.2.3.6.cmml">t</mi><mo id="S4.SS1.p1.4.m4.1.1.2.3.1d" xref="S4.SS1.p1.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.4.m4.1.1.2.3.7" xref="S4.SS1.p1.4.m4.1.1.2.3.7.cmml">i</mi><mo id="S4.SS1.p1.4.m4.1.1.2.3.1e" xref="S4.SS1.p1.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.4.m4.1.1.2.3.8" xref="S4.SS1.p1.4.m4.1.1.2.3.8.cmml">t</mi><mo id="S4.SS1.p1.4.m4.1.1.2.3.1f" xref="S4.SS1.p1.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.4.m4.1.1.2.3.9" xref="S4.SS1.p1.4.m4.1.1.2.3.9.cmml">y</mi></mrow></msub><mo id="S4.SS1.p1.4.m4.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><eq id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1"></eq><apply id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.2.1.cmml" xref="S4.SS1.p1.4.m4.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.2.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2.2">𝜆</ci><apply id="S4.SS1.p1.4.m4.1.1.2.3.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3"><times id="S4.SS1.p1.4.m4.1.1.2.3.1.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3.1"></times><ci id="S4.SS1.p1.4.m4.1.1.2.3.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3.2">𝑖</ci><ci id="S4.SS1.p1.4.m4.1.1.2.3.3.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3.3">𝑑</ci><ci id="S4.SS1.p1.4.m4.1.1.2.3.4.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3.4">𝑒</ci><ci id="S4.SS1.p1.4.m4.1.1.2.3.5.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3.5">𝑛</ci><ci id="S4.SS1.p1.4.m4.1.1.2.3.6.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3.6">𝑡</ci><ci id="S4.SS1.p1.4.m4.1.1.2.3.7.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3.7">𝑖</ci><ci id="S4.SS1.p1.4.m4.1.1.2.3.8.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3.8">𝑡</ci><ci id="S4.SS1.p1.4.m4.1.1.2.3.9.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3.9">𝑦</ci></apply></apply><cn id="S4.SS1.p1.4.m4.1.1.3.cmml" type="float" xref="S4.SS1.p1.4.m4.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">\lambda_{identity}=0.1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">italic_λ start_POSTSUBSCRIPT italic_i italic_d italic_e italic_n italic_t italic_i italic_t italic_y end_POSTSUBSCRIPT = 0.1</annotation></semantics></math> and <math alttext="\lambda_{clip}=0.01" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><mrow id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><msub id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2.2" xref="S4.SS1.p1.5.m5.1.1.2.2.cmml">λ</mi><mrow id="S4.SS1.p1.5.m5.1.1.2.3" xref="S4.SS1.p1.5.m5.1.1.2.3.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2.3.2" xref="S4.SS1.p1.5.m5.1.1.2.3.2.cmml">c</mi><mo id="S4.SS1.p1.5.m5.1.1.2.3.1" xref="S4.SS1.p1.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.5.m5.1.1.2.3.3" xref="S4.SS1.p1.5.m5.1.1.2.3.3.cmml">l</mi><mo id="S4.SS1.p1.5.m5.1.1.2.3.1a" xref="S4.SS1.p1.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.5.m5.1.1.2.3.4" xref="S4.SS1.p1.5.m5.1.1.2.3.4.cmml">i</mi><mo id="S4.SS1.p1.5.m5.1.1.2.3.1b" xref="S4.SS1.p1.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.5.m5.1.1.2.3.5" xref="S4.SS1.p1.5.m5.1.1.2.3.5.cmml">p</mi></mrow></msub><mo id="S4.SS1.p1.5.m5.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><eq id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1"></eq><apply id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.2.1.cmml" xref="S4.SS1.p1.5.m5.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.5.m5.1.1.2.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2.2">𝜆</ci><apply id="S4.SS1.p1.5.m5.1.1.2.3.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3"><times id="S4.SS1.p1.5.m5.1.1.2.3.1.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3.1"></times><ci id="S4.SS1.p1.5.m5.1.1.2.3.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3.2">𝑐</ci><ci id="S4.SS1.p1.5.m5.1.1.2.3.3.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3.3">𝑙</ci><ci id="S4.SS1.p1.5.m5.1.1.2.3.4.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3.4">𝑖</ci><ci id="S4.SS1.p1.5.m5.1.1.2.3.5.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3.5">𝑝</ci></apply></apply><cn id="S4.SS1.p1.5.m5.1.1.3.cmml" type="float" xref="S4.SS1.p1.5.m5.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">\lambda_{clip}=0.01</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">italic_λ start_POSTSUBSCRIPT italic_c italic_l italic_i italic_p end_POSTSUBSCRIPT = 0.01</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">Benchmark Datasets.</span> We utilize the LOL-Blur dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib10" title="">10</a>]</cite> to train our model and assess its generalization capabilities using the real-world Real-LOL-Blur dataset. For details of these datasets, refer to our project homepage.
For evaluating the performance on the LOL-Blur dataset, we use PSNR, SSIM, and LPIPS. In contrast, for Real-LOL-Blur, we rely on perceptual metrics such as MUSIQ, NRQM, and NIQE.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS2.5.1.1">IV-B</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS2.6.2">Results on Synthetic Datasets</span>
</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.5">In the experiments of the LOL-Blur dataset, we compare our method with some state-of-the-art approaches, including two cascade low-light enhancement and deblurring methods Zero-DCE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib5" title="">5</a>]</cite> <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mo id="S4.SS2.p1.1.m1.1.1" stretchy="false" xref="S4.SS2.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">→</annotation></semantics></math> MIMO <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib12" title="">12</a>]</cite>, RUAS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib33" title="">33</a>]</cite> <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mo id="S4.SS2.p1.2.m2.1.1" stretchy="false" xref="S4.SS2.p1.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">→</annotation></semantics></math> MIMO <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib12" title="">12</a>]</cite>, three cascade deblurring and low-light enhancement methods Chen <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib7" title="">7</a>]</cite> <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mo id="S4.SS2.p1.3.m3.1.1" stretchy="false" xref="S4.SS2.p1.3.m3.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">→</annotation></semantics></math> Zero-DCE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib5" title="">5</a>]</cite>, DeblurGAN-v2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib9" title="">9</a>]</cite> <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.1"><semantics id="S4.SS2.p1.4.m4.1a"><mo id="S4.SS2.p1.4.m4.1.1" stretchy="false" xref="S4.SS2.p1.4.m4.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><ci id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">→</annotation></semantics></math> Zero-DCE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib5" title="">5</a>]</cite>, MIMO <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib12" title="">12</a>]</cite> <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m5.1"><semantics id="S4.SS2.p1.5.m5.1a"><mo id="S4.SS2.p1.5.m5.1.1" stretchy="false" xref="S4.SS2.p1.5.m5.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><ci id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m5.1d">→</annotation></semantics></math> Zero-DCE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib5" title="">5</a>]</cite>, three low-light enhancement models KinD++ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib34" title="">34</a>]</cite>, DRBN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib35" title="">35</a>]</cite>, SNR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib36" title="">36</a>]</cite>, three deblurring models DeblurGANv2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib9" title="">9</a>]</cite>, DMPHN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib8" title="">8</a>]</cite>, MIMO <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib12" title="">12</a>]</cite>, and the two joint low-light enhancement and deblurring methods LEDNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib10" title="">10</a>]</cite> and ASP-LED <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib11" title="">11</a>]</cite>.
As illustrated in Tab. <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S3.T1" title="TABLE I ‣ III-D Optimization ‣ III PROPOSED METHOD ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag">I</span></a>, our method achieved state-of-the-art performance for this task, surpassing other models in terms of PSNR, SSIM, and LPIPS metrics. The visual comparisons in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S3.F5" title="Figure 5 ‣ III-A Overall Pipeline ‣ III PROPOSED METHOD ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag">5</span></a> further demonstrate that our approach excels at restoring curved edge details and retrieving finer, sharper textural features when compared to competing methods. These results confirm that our model performs not only well quantitatively but also qualitatively in enhancing images under challenging low-light and blurry conditions, demonstrating superior recovery of intricate details that are vital for downstream applications.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS3.5.1.1">IV-C</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS3.6.2">Results on the Real-World Dataset</span>
</h3>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE II: </span><span class="ltx_text ltx_font_bold" id="S4.T2.12.1">Quantitative evaluation on Real-LOL-Blur dataset.</span> MUSIQ/NRQM<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.3.m1.1"><semantics id="S4.T2.3.m1.1b"><mo id="S4.T2.3.m1.1.1" stretchy="false" xref="S4.T2.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.m1.1c"><ci id="S4.T2.3.m1.1.1.cmml" xref="S4.T2.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.m1.1d">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.m1.1e">↑</annotation></semantics></math>: the higher, the better; NIQE<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.4.m2.1"><semantics id="S4.T2.4.m2.1b"><mo id="S4.T2.4.m2.1.1" stretchy="false" xref="S4.T2.4.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.4.m2.1c"><ci id="S4.T2.4.m2.1.1.cmml" xref="S4.T2.4.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.m2.1d">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.m2.1e">↑</annotation></semantics></math>: the lower, the better. Best values are indicated with <span class="ltx_text ltx_font_bold" id="S4.T2.13.2">bold</span> text.</figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S4.T2.9" style="width:381.6pt;height:387.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(49.1pt,-50.0pt) scale(1.3469327167366,1.3469327167366) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.9.5">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.7.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.7.3.3.4">Method</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.5.1.1.1"><math alttext="MUSIQ\uparrow" class="ltx_Math" display="inline" id="S4.T2.5.1.1.1.m1.1"><semantics id="S4.T2.5.1.1.1.m1.1a"><mrow id="S4.T2.5.1.1.1.m1.1.1" xref="S4.T2.5.1.1.1.m1.1.1.cmml"><mrow id="S4.T2.5.1.1.1.m1.1.1.2" xref="S4.T2.5.1.1.1.m1.1.1.2.cmml"><mi id="S4.T2.5.1.1.1.m1.1.1.2.2" xref="S4.T2.5.1.1.1.m1.1.1.2.2.cmml">M</mi><mo id="S4.T2.5.1.1.1.m1.1.1.2.1" xref="S4.T2.5.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T2.5.1.1.1.m1.1.1.2.3" xref="S4.T2.5.1.1.1.m1.1.1.2.3.cmml">U</mi><mo id="S4.T2.5.1.1.1.m1.1.1.2.1a" xref="S4.T2.5.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T2.5.1.1.1.m1.1.1.2.4" xref="S4.T2.5.1.1.1.m1.1.1.2.4.cmml">S</mi><mo id="S4.T2.5.1.1.1.m1.1.1.2.1b" xref="S4.T2.5.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T2.5.1.1.1.m1.1.1.2.5" xref="S4.T2.5.1.1.1.m1.1.1.2.5.cmml">I</mi><mo id="S4.T2.5.1.1.1.m1.1.1.2.1c" xref="S4.T2.5.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T2.5.1.1.1.m1.1.1.2.6" xref="S4.T2.5.1.1.1.m1.1.1.2.6.cmml">Q</mi></mrow><mo id="S4.T2.5.1.1.1.m1.1.1.1" stretchy="false" xref="S4.T2.5.1.1.1.m1.1.1.1.cmml">↑</mo><mi id="S4.T2.5.1.1.1.m1.1.1.3" xref="S4.T2.5.1.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.5.1.1.1.m1.1b"><apply id="S4.T2.5.1.1.1.m1.1.1.cmml" xref="S4.T2.5.1.1.1.m1.1.1"><ci id="S4.T2.5.1.1.1.m1.1.1.1.cmml" xref="S4.T2.5.1.1.1.m1.1.1.1">↑</ci><apply id="S4.T2.5.1.1.1.m1.1.1.2.cmml" xref="S4.T2.5.1.1.1.m1.1.1.2"><times id="S4.T2.5.1.1.1.m1.1.1.2.1.cmml" xref="S4.T2.5.1.1.1.m1.1.1.2.1"></times><ci id="S4.T2.5.1.1.1.m1.1.1.2.2.cmml" xref="S4.T2.5.1.1.1.m1.1.1.2.2">𝑀</ci><ci id="S4.T2.5.1.1.1.m1.1.1.2.3.cmml" xref="S4.T2.5.1.1.1.m1.1.1.2.3">𝑈</ci><ci id="S4.T2.5.1.1.1.m1.1.1.2.4.cmml" xref="S4.T2.5.1.1.1.m1.1.1.2.4">𝑆</ci><ci id="S4.T2.5.1.1.1.m1.1.1.2.5.cmml" xref="S4.T2.5.1.1.1.m1.1.1.2.5">𝐼</ci><ci id="S4.T2.5.1.1.1.m1.1.1.2.6.cmml" xref="S4.T2.5.1.1.1.m1.1.1.2.6">𝑄</ci></apply><csymbol cd="latexml" id="S4.T2.5.1.1.1.m1.1.1.3.cmml" xref="S4.T2.5.1.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.1.1.1.m1.1c">MUSIQ\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.1.1.1.m1.1d">italic_M italic_U italic_S italic_I italic_Q ↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T2.6.2.2.2"><math alttext="NRQM\uparrow" class="ltx_Math" display="inline" id="S4.T2.6.2.2.2.m1.1"><semantics id="S4.T2.6.2.2.2.m1.1a"><mrow id="S4.T2.6.2.2.2.m1.1.1" xref="S4.T2.6.2.2.2.m1.1.1.cmml"><mrow id="S4.T2.6.2.2.2.m1.1.1.2" xref="S4.T2.6.2.2.2.m1.1.1.2.cmml"><mi id="S4.T2.6.2.2.2.m1.1.1.2.2" xref="S4.T2.6.2.2.2.m1.1.1.2.2.cmml">N</mi><mo id="S4.T2.6.2.2.2.m1.1.1.2.1" xref="S4.T2.6.2.2.2.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T2.6.2.2.2.m1.1.1.2.3" xref="S4.T2.6.2.2.2.m1.1.1.2.3.cmml">R</mi><mo id="S4.T2.6.2.2.2.m1.1.1.2.1a" xref="S4.T2.6.2.2.2.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T2.6.2.2.2.m1.1.1.2.4" xref="S4.T2.6.2.2.2.m1.1.1.2.4.cmml">Q</mi><mo id="S4.T2.6.2.2.2.m1.1.1.2.1b" xref="S4.T2.6.2.2.2.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T2.6.2.2.2.m1.1.1.2.5" xref="S4.T2.6.2.2.2.m1.1.1.2.5.cmml">M</mi></mrow><mo id="S4.T2.6.2.2.2.m1.1.1.1" stretchy="false" xref="S4.T2.6.2.2.2.m1.1.1.1.cmml">↑</mo><mi id="S4.T2.6.2.2.2.m1.1.1.3" xref="S4.T2.6.2.2.2.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.6.2.2.2.m1.1b"><apply id="S4.T2.6.2.2.2.m1.1.1.cmml" xref="S4.T2.6.2.2.2.m1.1.1"><ci id="S4.T2.6.2.2.2.m1.1.1.1.cmml" xref="S4.T2.6.2.2.2.m1.1.1.1">↑</ci><apply id="S4.T2.6.2.2.2.m1.1.1.2.cmml" xref="S4.T2.6.2.2.2.m1.1.1.2"><times id="S4.T2.6.2.2.2.m1.1.1.2.1.cmml" xref="S4.T2.6.2.2.2.m1.1.1.2.1"></times><ci id="S4.T2.6.2.2.2.m1.1.1.2.2.cmml" xref="S4.T2.6.2.2.2.m1.1.1.2.2">𝑁</ci><ci id="S4.T2.6.2.2.2.m1.1.1.2.3.cmml" xref="S4.T2.6.2.2.2.m1.1.1.2.3">𝑅</ci><ci id="S4.T2.6.2.2.2.m1.1.1.2.4.cmml" xref="S4.T2.6.2.2.2.m1.1.1.2.4">𝑄</ci><ci id="S4.T2.6.2.2.2.m1.1.1.2.5.cmml" xref="S4.T2.6.2.2.2.m1.1.1.2.5">𝑀</ci></apply><csymbol cd="latexml" id="S4.T2.6.2.2.2.m1.1.1.3.cmml" xref="S4.T2.6.2.2.2.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.2.2.2.m1.1c">NRQM\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.6.2.2.2.m1.1d">italic_N italic_R italic_Q italic_M ↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.7.3.3.3"><math alttext="NIQE\downarrow" class="ltx_Math" display="inline" id="S4.T2.7.3.3.3.m1.1"><semantics id="S4.T2.7.3.3.3.m1.1a"><mrow id="S4.T2.7.3.3.3.m1.1.1" xref="S4.T2.7.3.3.3.m1.1.1.cmml"><mrow id="S4.T2.7.3.3.3.m1.1.1.2" xref="S4.T2.7.3.3.3.m1.1.1.2.cmml"><mi id="S4.T2.7.3.3.3.m1.1.1.2.2" xref="S4.T2.7.3.3.3.m1.1.1.2.2.cmml">N</mi><mo id="S4.T2.7.3.3.3.m1.1.1.2.1" xref="S4.T2.7.3.3.3.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T2.7.3.3.3.m1.1.1.2.3" xref="S4.T2.7.3.3.3.m1.1.1.2.3.cmml">I</mi><mo id="S4.T2.7.3.3.3.m1.1.1.2.1a" xref="S4.T2.7.3.3.3.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T2.7.3.3.3.m1.1.1.2.4" xref="S4.T2.7.3.3.3.m1.1.1.2.4.cmml">Q</mi><mo id="S4.T2.7.3.3.3.m1.1.1.2.1b" xref="S4.T2.7.3.3.3.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T2.7.3.3.3.m1.1.1.2.5" xref="S4.T2.7.3.3.3.m1.1.1.2.5.cmml">E</mi></mrow><mo id="S4.T2.7.3.3.3.m1.1.1.1" stretchy="false" xref="S4.T2.7.3.3.3.m1.1.1.1.cmml">↓</mo><mi id="S4.T2.7.3.3.3.m1.1.1.3" xref="S4.T2.7.3.3.3.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.7.3.3.3.m1.1b"><apply id="S4.T2.7.3.3.3.m1.1.1.cmml" xref="S4.T2.7.3.3.3.m1.1.1"><ci id="S4.T2.7.3.3.3.m1.1.1.1.cmml" xref="S4.T2.7.3.3.3.m1.1.1.1">↓</ci><apply id="S4.T2.7.3.3.3.m1.1.1.2.cmml" xref="S4.T2.7.3.3.3.m1.1.1.2"><times id="S4.T2.7.3.3.3.m1.1.1.2.1.cmml" xref="S4.T2.7.3.3.3.m1.1.1.2.1"></times><ci id="S4.T2.7.3.3.3.m1.1.1.2.2.cmml" xref="S4.T2.7.3.3.3.m1.1.1.2.2">𝑁</ci><ci id="S4.T2.7.3.3.3.m1.1.1.2.3.cmml" xref="S4.T2.7.3.3.3.m1.1.1.2.3">𝐼</ci><ci id="S4.T2.7.3.3.3.m1.1.1.2.4.cmml" xref="S4.T2.7.3.3.3.m1.1.1.2.4">𝑄</ci><ci id="S4.T2.7.3.3.3.m1.1.1.2.5.cmml" xref="S4.T2.7.3.3.3.m1.1.1.2.5">𝐸</ci></apply><csymbol cd="latexml" id="S4.T2.7.3.3.3.m1.1.1.3.cmml" xref="S4.T2.7.3.3.3.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.3.3.3.m1.1c">NIQE\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.7.3.3.3.m1.1d">italic_N italic_I italic_Q italic_E ↓</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T2.8.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="4" id="S4.T2.8.4.4.1" style="background-color:#F2F2D9;"><span class="ltx_text" id="S4.T2.8.4.4.1.1" style="background-color:#F2F2D9;">Enhancement <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T2.8.4.4.1.1.m1.1"><semantics id="S4.T2.8.4.4.1.1.m1.1a"><mo id="S4.T2.8.4.4.1.1.m1.1.1" mathbackground="#F2F2D9" stretchy="false" xref="S4.T2.8.4.4.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T2.8.4.4.1.1.m1.1b"><ci id="S4.T2.8.4.4.1.1.m1.1.1.cmml" xref="S4.T2.8.4.4.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.4.4.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.8.4.4.1.1.m1.1d">→</annotation></semantics></math> Deblurring</span></th>
</tr>
<tr class="ltx_tr" id="S4.T2.9.5.6.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.9.5.6.1.1">Zero-DCE → MIMO</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.9.5.6.1.2">39.36</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T2.9.5.6.1.3">5.206</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.9.5.6.1.4">4.459</td>
</tr>
<tr class="ltx_tr" id="S4.T2.9.5.7.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.9.5.7.2.1">RUAS → MIMO</th>
<td class="ltx_td ltx_align_center" id="S4.T2.9.5.7.2.2">34.39</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.9.5.7.2.3">3.322</td>
<td class="ltx_td ltx_align_center" id="S4.T2.9.5.7.2.4">6.812</td>
</tr>
<tr class="ltx_tr" id="S4.T2.9.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="4" id="S4.T2.9.5.5.1" style="background-color:#F9FFE6;"><span class="ltx_text" id="S4.T2.9.5.5.1.1" style="background-color:#F9FFE6;">Deblurring <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T2.9.5.5.1.1.m1.1"><semantics id="S4.T2.9.5.5.1.1.m1.1a"><mo id="S4.T2.9.5.5.1.1.m1.1.1" mathbackground="#F9FFE6" stretchy="false" xref="S4.T2.9.5.5.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T2.9.5.5.1.1.m1.1b"><ci id="S4.T2.9.5.5.1.1.m1.1.1.cmml" xref="S4.T2.9.5.5.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.5.5.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.9.5.5.1.1.m1.1d">→</annotation></semantics></math> Enhancement</span></th>
</tr>
<tr class="ltx_tr" id="S4.T2.9.5.8.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.9.5.8.3.1">Chen <span class="ltx_text ltx_font_italic" id="S4.T2.9.5.8.3.1.1">et al.</span> → Zero-DCE</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.9.5.8.3.2">45.79</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T2.9.5.8.3.3">5.844</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.9.5.8.3.4">5.043</td>
</tr>
<tr class="ltx_tr" id="S4.T2.9.5.9.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.9.5.9.4.1">MIMO → Zero-DCE</th>
<td class="ltx_td ltx_align_center" id="S4.T2.9.5.9.4.2">28.36</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.9.5.9.4.3">3.697</td>
<td class="ltx_td ltx_align_center" id="S4.T2.9.5.9.4.4">6.892</td>
</tr>
<tr class="ltx_tr" id="S4.T2.9.5.10.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="4" id="S4.T2.9.5.10.5.1" style="background-color:#E6FFE6;"><span class="ltx_text" id="S4.T2.9.5.10.5.1.1" style="background-color:#E6FFE6;">Training on LOL-Blur</span></th>
</tr>
<tr class="ltx_tr" id="S4.T2.9.5.11.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.9.5.11.6.1">KinD++</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.9.5.11.6.2">31.74</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T2.9.5.11.6.3">3.854</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.9.5.11.6.4">7.299</td>
</tr>
<tr class="ltx_tr" id="S4.T2.9.5.12.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.9.5.12.7.1">DRBN</th>
<td class="ltx_td ltx_align_center" id="S4.T2.9.5.12.7.2">31.27</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.9.5.12.7.3">4.019</td>
<td class="ltx_td ltx_align_center" id="S4.T2.9.5.12.7.4">7.129</td>
</tr>
<tr class="ltx_tr" id="S4.T2.9.5.13.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.9.5.13.8.1">SNR</th>
<td class="ltx_td ltx_align_center" id="S4.T2.9.5.13.8.2">34.58</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.9.5.13.8.3">4.662</td>
<td class="ltx_td ltx_align_center" id="S4.T2.9.5.13.8.4">5.31</td>
</tr>
<tr class="ltx_tr" id="S4.T2.9.5.14.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.9.5.14.9.1">DMPHN</th>
<td class="ltx_td ltx_align_center" id="S4.T2.9.5.14.9.2">35.08</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.9.5.14.9.3">4.47</td>
<td class="ltx_td ltx_align_center" id="S4.T2.9.5.14.9.4">5.19</td>
</tr>
<tr class="ltx_tr" id="S4.T2.9.5.15.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.9.5.15.10.1">MIMO</th>
<td class="ltx_td ltx_align_center" id="S4.T2.9.5.15.10.2">35.37</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.9.5.15.10.3">5.14</td>
<td class="ltx_td ltx_align_center" id="S4.T2.9.5.15.10.4">4.851</td>
</tr>
<tr class="ltx_tr" id="S4.T2.9.5.16.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.9.5.16.11.1">LEDNet</th>
<td class="ltx_td ltx_align_center" id="S4.T2.9.5.16.11.2">39.11</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.9.5.16.11.3"><span class="ltx_text ltx_font_bold" id="S4.T2.9.5.16.11.3.1">5.643</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.9.5.16.11.4">4.764</td>
</tr>
<tr class="ltx_tr" id="S4.T2.9.5.17.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.9.5.17.12.1">ASP-LED</th>
<td class="ltx_td ltx_align_center" id="S4.T2.9.5.17.12.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.9.5.17.12.2.1">46.95</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.9.5.17.12.3">5.583</td>
<td class="ltx_td ltx_align_center" id="S4.T2.9.5.17.12.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.9.5.17.12.4.1">4.442</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.9.5.18.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S4.T2.9.5.18.13.1">Ours</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.9.5.18.13.2"><span class="ltx_text ltx_font_bold" id="S4.T2.9.5.18.13.2.1">47.21</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T2.9.5.18.13.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.9.5.18.13.3.1">5.612</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.9.5.18.13.4"><span class="ltx_text ltx_font_bold" id="S4.T2.9.5.18.13.4.1">4.323</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Tab. <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S4.T2" title="TABLE II ‣ IV-C Results on the Real-World Dataset ‣ IV EXPERIMENTS ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag">II</span></a> presents the quantitative evaluation of different methods on the Real-LOL-Blur dataset using the MUSIQ, NRQM, and NIQE metrics. Our proposed DAP-LED method achieves the best performance across the MUSIQ and NRQM scores. Although our NIQE score is slightly higher than ASP-LED’s, it remains highly competitive, further confirming the effectiveness of our model in restoring image quality under challenging low-light and blur conditions. Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S4.F6" title="Figure 6 ‣ IV-A Implementation Details and Datasets ‣ IV EXPERIMENTS ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag">6</span></a> compares the restored images across different methods, further demonstrating the superiority of our approach. In particular, our model recovers more details and improves the clarity of both the environment and the textual information on the signage, as shown in the magnified regions. Compared to the input and other methods like SNR, LEDNet and ASP-LED, our results offer better contrast and sharpness, eliminating much of the blurring and enhancing the overall visibility in low-light scenarios. This visual quality comparison further confirms the strong quantitative results, highlighting the effectiveness of our method in practical scenarios.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Ablation study of the prompt used in DAP-LED.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T3.2" style="width:346.9pt;height:96.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(43.9pt,-12.2pt) scale(1.33861751620952,1.33861751620952) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.2.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T3.2.2.2.3">Experiment on Prompt Learning</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T3.1.1.1.1"><math alttext="PSNR\uparrow" class="ltx_Math" display="inline" id="S4.T3.1.1.1.1.m1.1"><semantics id="S4.T3.1.1.1.1.m1.1a"><mrow id="S4.T3.1.1.1.1.m1.1.1" xref="S4.T3.1.1.1.1.m1.1.1.cmml"><mrow id="S4.T3.1.1.1.1.m1.1.1.2" xref="S4.T3.1.1.1.1.m1.1.1.2.cmml"><mi id="S4.T3.1.1.1.1.m1.1.1.2.2" xref="S4.T3.1.1.1.1.m1.1.1.2.2.cmml">P</mi><mo id="S4.T3.1.1.1.1.m1.1.1.2.1" xref="S4.T3.1.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T3.1.1.1.1.m1.1.1.2.3" xref="S4.T3.1.1.1.1.m1.1.1.2.3.cmml">S</mi><mo id="S4.T3.1.1.1.1.m1.1.1.2.1a" xref="S4.T3.1.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T3.1.1.1.1.m1.1.1.2.4" xref="S4.T3.1.1.1.1.m1.1.1.2.4.cmml">N</mi><mo id="S4.T3.1.1.1.1.m1.1.1.2.1b" xref="S4.T3.1.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T3.1.1.1.1.m1.1.1.2.5" xref="S4.T3.1.1.1.1.m1.1.1.2.5.cmml">R</mi></mrow><mo id="S4.T3.1.1.1.1.m1.1.1.1" stretchy="false" xref="S4.T3.1.1.1.1.m1.1.1.1.cmml">↑</mo><mi id="S4.T3.1.1.1.1.m1.1.1.3" xref="S4.T3.1.1.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.1.m1.1b"><apply id="S4.T3.1.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1"><ci id="S4.T3.1.1.1.1.m1.1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1.1">↑</ci><apply id="S4.T3.1.1.1.1.m1.1.1.2.cmml" xref="S4.T3.1.1.1.1.m1.1.1.2"><times id="S4.T3.1.1.1.1.m1.1.1.2.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1.2.1"></times><ci id="S4.T3.1.1.1.1.m1.1.1.2.2.cmml" xref="S4.T3.1.1.1.1.m1.1.1.2.2">𝑃</ci><ci id="S4.T3.1.1.1.1.m1.1.1.2.3.cmml" xref="S4.T3.1.1.1.1.m1.1.1.2.3">𝑆</ci><ci id="S4.T3.1.1.1.1.m1.1.1.2.4.cmml" xref="S4.T3.1.1.1.1.m1.1.1.2.4">𝑁</ci><ci id="S4.T3.1.1.1.1.m1.1.1.2.5.cmml" xref="S4.T3.1.1.1.1.m1.1.1.2.5">𝑅</ci></apply><csymbol cd="latexml" id="S4.T3.1.1.1.1.m1.1.1.3.cmml" xref="S4.T3.1.1.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.1.m1.1c">PSNR\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.1.1.1.1.m1.1d">italic_P italic_S italic_N italic_R ↑</annotation></semantics></math></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T3.2.2.2.2"><math alttext="SSIM\uparrow" class="ltx_Math" display="inline" id="S4.T3.2.2.2.2.m1.1"><semantics id="S4.T3.2.2.2.2.m1.1a"><mrow id="S4.T3.2.2.2.2.m1.1.1" xref="S4.T3.2.2.2.2.m1.1.1.cmml"><mrow id="S4.T3.2.2.2.2.m1.1.1.2" xref="S4.T3.2.2.2.2.m1.1.1.2.cmml"><mi id="S4.T3.2.2.2.2.m1.1.1.2.2" xref="S4.T3.2.2.2.2.m1.1.1.2.2.cmml">S</mi><mo id="S4.T3.2.2.2.2.m1.1.1.2.1" xref="S4.T3.2.2.2.2.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T3.2.2.2.2.m1.1.1.2.3" xref="S4.T3.2.2.2.2.m1.1.1.2.3.cmml">S</mi><mo id="S4.T3.2.2.2.2.m1.1.1.2.1a" xref="S4.T3.2.2.2.2.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T3.2.2.2.2.m1.1.1.2.4" xref="S4.T3.2.2.2.2.m1.1.1.2.4.cmml">I</mi><mo id="S4.T3.2.2.2.2.m1.1.1.2.1b" xref="S4.T3.2.2.2.2.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T3.2.2.2.2.m1.1.1.2.5" xref="S4.T3.2.2.2.2.m1.1.1.2.5.cmml">M</mi></mrow><mo id="S4.T3.2.2.2.2.m1.1.1.1" stretchy="false" xref="S4.T3.2.2.2.2.m1.1.1.1.cmml">↑</mo><mi id="S4.T3.2.2.2.2.m1.1.1.3" xref="S4.T3.2.2.2.2.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.2.m1.1b"><apply id="S4.T3.2.2.2.2.m1.1.1.cmml" xref="S4.T3.2.2.2.2.m1.1.1"><ci id="S4.T3.2.2.2.2.m1.1.1.1.cmml" xref="S4.T3.2.2.2.2.m1.1.1.1">↑</ci><apply id="S4.T3.2.2.2.2.m1.1.1.2.cmml" xref="S4.T3.2.2.2.2.m1.1.1.2"><times id="S4.T3.2.2.2.2.m1.1.1.2.1.cmml" xref="S4.T3.2.2.2.2.m1.1.1.2.1"></times><ci id="S4.T3.2.2.2.2.m1.1.1.2.2.cmml" xref="S4.T3.2.2.2.2.m1.1.1.2.2">𝑆</ci><ci id="S4.T3.2.2.2.2.m1.1.1.2.3.cmml" xref="S4.T3.2.2.2.2.m1.1.1.2.3">𝑆</ci><ci id="S4.T3.2.2.2.2.m1.1.1.2.4.cmml" xref="S4.T3.2.2.2.2.m1.1.1.2.4">𝐼</ci><ci id="S4.T3.2.2.2.2.m1.1.1.2.5.cmml" xref="S4.T3.2.2.2.2.m1.1.1.2.5">𝑀</ci></apply><csymbol cd="latexml" id="S4.T3.2.2.2.2.m1.1.1.3.cmml" xref="S4.T3.2.2.2.2.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.2.m1.1c">SSIM\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.2.2.2.m1.1d">italic_S italic_S italic_I italic_M ↑</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.2.2.3.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T3.2.2.3.1.1">(1) deblur prompt</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T3.2.2.3.1.2">23.12</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.2.2.3.1.3">0.824</td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.2.4.2">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T3.2.2.4.2.1">(2) lowlight prompt</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T3.2.2.4.2.2">24.45</td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.2.4.2.3">0.842</td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.2.5.3">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" id="S4.T3.2.2.5.3.1">(3) joint prompt</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" id="S4.T3.2.2.5.3.2">26.42</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S4.T3.2.2.5.3.3">0.853</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>Ablation study of the losses of DAP-LED.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T4.5" style="width:390.3pt;height:113.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(71.5pt,-20.8pt) scale(1.57870528973412,1.57870528973412) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T4.5.5">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T4.2.2.2.3">Experiment on Losses</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T4.1.1.1.1"><math alttext="PSNR\uparrow" class="ltx_Math" display="inline" id="S4.T4.1.1.1.1.m1.1"><semantics id="S4.T4.1.1.1.1.m1.1a"><mrow id="S4.T4.1.1.1.1.m1.1.1" xref="S4.T4.1.1.1.1.m1.1.1.cmml"><mrow id="S4.T4.1.1.1.1.m1.1.1.2" xref="S4.T4.1.1.1.1.m1.1.1.2.cmml"><mi id="S4.T4.1.1.1.1.m1.1.1.2.2" xref="S4.T4.1.1.1.1.m1.1.1.2.2.cmml">P</mi><mo id="S4.T4.1.1.1.1.m1.1.1.2.1" xref="S4.T4.1.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T4.1.1.1.1.m1.1.1.2.3" xref="S4.T4.1.1.1.1.m1.1.1.2.3.cmml">S</mi><mo id="S4.T4.1.1.1.1.m1.1.1.2.1a" xref="S4.T4.1.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T4.1.1.1.1.m1.1.1.2.4" xref="S4.T4.1.1.1.1.m1.1.1.2.4.cmml">N</mi><mo id="S4.T4.1.1.1.1.m1.1.1.2.1b" xref="S4.T4.1.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T4.1.1.1.1.m1.1.1.2.5" xref="S4.T4.1.1.1.1.m1.1.1.2.5.cmml">R</mi></mrow><mo id="S4.T4.1.1.1.1.m1.1.1.1" stretchy="false" xref="S4.T4.1.1.1.1.m1.1.1.1.cmml">↑</mo><mi id="S4.T4.1.1.1.1.m1.1.1.3" xref="S4.T4.1.1.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.1.m1.1b"><apply id="S4.T4.1.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1"><ci id="S4.T4.1.1.1.1.m1.1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1.1">↑</ci><apply id="S4.T4.1.1.1.1.m1.1.1.2.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2"><times id="S4.T4.1.1.1.1.m1.1.1.2.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2.1"></times><ci id="S4.T4.1.1.1.1.m1.1.1.2.2.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2.2">𝑃</ci><ci id="S4.T4.1.1.1.1.m1.1.1.2.3.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2.3">𝑆</ci><ci id="S4.T4.1.1.1.1.m1.1.1.2.4.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2.4">𝑁</ci><ci id="S4.T4.1.1.1.1.m1.1.1.2.5.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2.5">𝑅</ci></apply><csymbol cd="latexml" id="S4.T4.1.1.1.1.m1.1.1.3.cmml" xref="S4.T4.1.1.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.1.m1.1c">PSNR\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.1.1.1.1.m1.1d">italic_P italic_S italic_N italic_R ↑</annotation></semantics></math></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T4.2.2.2.2"><math alttext="SSIM\uparrow" class="ltx_Math" display="inline" id="S4.T4.2.2.2.2.m1.1"><semantics id="S4.T4.2.2.2.2.m1.1a"><mrow id="S4.T4.2.2.2.2.m1.1.1" xref="S4.T4.2.2.2.2.m1.1.1.cmml"><mrow id="S4.T4.2.2.2.2.m1.1.1.2" xref="S4.T4.2.2.2.2.m1.1.1.2.cmml"><mi id="S4.T4.2.2.2.2.m1.1.1.2.2" xref="S4.T4.2.2.2.2.m1.1.1.2.2.cmml">S</mi><mo id="S4.T4.2.2.2.2.m1.1.1.2.1" xref="S4.T4.2.2.2.2.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T4.2.2.2.2.m1.1.1.2.3" xref="S4.T4.2.2.2.2.m1.1.1.2.3.cmml">S</mi><mo id="S4.T4.2.2.2.2.m1.1.1.2.1a" xref="S4.T4.2.2.2.2.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T4.2.2.2.2.m1.1.1.2.4" xref="S4.T4.2.2.2.2.m1.1.1.2.4.cmml">I</mi><mo id="S4.T4.2.2.2.2.m1.1.1.2.1b" xref="S4.T4.2.2.2.2.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T4.2.2.2.2.m1.1.1.2.5" xref="S4.T4.2.2.2.2.m1.1.1.2.5.cmml">M</mi></mrow><mo id="S4.T4.2.2.2.2.m1.1.1.1" stretchy="false" xref="S4.T4.2.2.2.2.m1.1.1.1.cmml">↑</mo><mi id="S4.T4.2.2.2.2.m1.1.1.3" xref="S4.T4.2.2.2.2.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.2.2.m1.1b"><apply id="S4.T4.2.2.2.2.m1.1.1.cmml" xref="S4.T4.2.2.2.2.m1.1.1"><ci id="S4.T4.2.2.2.2.m1.1.1.1.cmml" xref="S4.T4.2.2.2.2.m1.1.1.1">↑</ci><apply id="S4.T4.2.2.2.2.m1.1.1.2.cmml" xref="S4.T4.2.2.2.2.m1.1.1.2"><times id="S4.T4.2.2.2.2.m1.1.1.2.1.cmml" xref="S4.T4.2.2.2.2.m1.1.1.2.1"></times><ci id="S4.T4.2.2.2.2.m1.1.1.2.2.cmml" xref="S4.T4.2.2.2.2.m1.1.1.2.2">𝑆</ci><ci id="S4.T4.2.2.2.2.m1.1.1.2.3.cmml" xref="S4.T4.2.2.2.2.m1.1.1.2.3">𝑆</ci><ci id="S4.T4.2.2.2.2.m1.1.1.2.4.cmml" xref="S4.T4.2.2.2.2.m1.1.1.2.4">𝐼</ci><ci id="S4.T4.2.2.2.2.m1.1.1.2.5.cmml" xref="S4.T4.2.2.2.2.m1.1.1.2.5">𝑀</ci></apply><csymbol cd="latexml" id="S4.T4.2.2.2.2.m1.1.1.3.cmml" xref="S4.T4.2.2.2.2.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.2.2.m1.1c">SSIM\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.2.2.2.2.m1.1d">italic_S italic_S italic_I italic_M ↑</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.3.3.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T4.3.3.3.1">(1) <math alttext="\mathbf{L}_{rec}" class="ltx_Math" display="inline" id="S4.T4.3.3.3.1.m1.1"><semantics id="S4.T4.3.3.3.1.m1.1a"><msub id="S4.T4.3.3.3.1.m1.1.1" xref="S4.T4.3.3.3.1.m1.1.1.cmml"><mi id="S4.T4.3.3.3.1.m1.1.1.2" xref="S4.T4.3.3.3.1.m1.1.1.2.cmml">𝐋</mi><mrow id="S4.T4.3.3.3.1.m1.1.1.3" xref="S4.T4.3.3.3.1.m1.1.1.3.cmml"><mi id="S4.T4.3.3.3.1.m1.1.1.3.2" xref="S4.T4.3.3.3.1.m1.1.1.3.2.cmml">r</mi><mo id="S4.T4.3.3.3.1.m1.1.1.3.1" xref="S4.T4.3.3.3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T4.3.3.3.1.m1.1.1.3.3" xref="S4.T4.3.3.3.1.m1.1.1.3.3.cmml">e</mi><mo id="S4.T4.3.3.3.1.m1.1.1.3.1a" xref="S4.T4.3.3.3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T4.3.3.3.1.m1.1.1.3.4" xref="S4.T4.3.3.3.1.m1.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T4.3.3.3.1.m1.1b"><apply id="S4.T4.3.3.3.1.m1.1.1.cmml" xref="S4.T4.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.3.3.3.1.m1.1.1.1.cmml" xref="S4.T4.3.3.3.1.m1.1.1">subscript</csymbol><ci id="S4.T4.3.3.3.1.m1.1.1.2.cmml" xref="S4.T4.3.3.3.1.m1.1.1.2">𝐋</ci><apply id="S4.T4.3.3.3.1.m1.1.1.3.cmml" xref="S4.T4.3.3.3.1.m1.1.1.3"><times id="S4.T4.3.3.3.1.m1.1.1.3.1.cmml" xref="S4.T4.3.3.3.1.m1.1.1.3.1"></times><ci id="S4.T4.3.3.3.1.m1.1.1.3.2.cmml" xref="S4.T4.3.3.3.1.m1.1.1.3.2">𝑟</ci><ci id="S4.T4.3.3.3.1.m1.1.1.3.3.cmml" xref="S4.T4.3.3.3.1.m1.1.1.3.3">𝑒</ci><ci id="S4.T4.3.3.3.1.m1.1.1.3.4.cmml" xref="S4.T4.3.3.3.1.m1.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.3.3.1.m1.1c">\mathbf{L}_{rec}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.3.3.3.1.m1.1d">bold_L start_POSTSUBSCRIPT italic_r italic_e italic_c end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T4.3.3.3.2">25.73</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.3.3.3.3">0.839</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T4.4.4.4.1">(2) <math alttext="\mathbf{L}_{rec}+\lambda_{identity}\mathbf{L}_{identity}" class="ltx_Math" display="inline" id="S4.T4.4.4.4.1.m1.1"><semantics id="S4.T4.4.4.4.1.m1.1a"><mrow id="S4.T4.4.4.4.1.m1.1.1" xref="S4.T4.4.4.4.1.m1.1.1.cmml"><msub id="S4.T4.4.4.4.1.m1.1.1.2" xref="S4.T4.4.4.4.1.m1.1.1.2.cmml"><mi id="S4.T4.4.4.4.1.m1.1.1.2.2" xref="S4.T4.4.4.4.1.m1.1.1.2.2.cmml">𝐋</mi><mrow id="S4.T4.4.4.4.1.m1.1.1.2.3" xref="S4.T4.4.4.4.1.m1.1.1.2.3.cmml"><mi id="S4.T4.4.4.4.1.m1.1.1.2.3.2" xref="S4.T4.4.4.4.1.m1.1.1.2.3.2.cmml">r</mi><mo id="S4.T4.4.4.4.1.m1.1.1.2.3.1" xref="S4.T4.4.4.4.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.T4.4.4.4.1.m1.1.1.2.3.3" xref="S4.T4.4.4.4.1.m1.1.1.2.3.3.cmml">e</mi><mo id="S4.T4.4.4.4.1.m1.1.1.2.3.1a" xref="S4.T4.4.4.4.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.T4.4.4.4.1.m1.1.1.2.3.4" xref="S4.T4.4.4.4.1.m1.1.1.2.3.4.cmml">c</mi></mrow></msub><mo id="S4.T4.4.4.4.1.m1.1.1.1" xref="S4.T4.4.4.4.1.m1.1.1.1.cmml">+</mo><mrow id="S4.T4.4.4.4.1.m1.1.1.3" xref="S4.T4.4.4.4.1.m1.1.1.3.cmml"><msub id="S4.T4.4.4.4.1.m1.1.1.3.2" xref="S4.T4.4.4.4.1.m1.1.1.3.2.cmml"><mi id="S4.T4.4.4.4.1.m1.1.1.3.2.2" xref="S4.T4.4.4.4.1.m1.1.1.3.2.2.cmml">λ</mi><mrow id="S4.T4.4.4.4.1.m1.1.1.3.2.3" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.cmml"><mi id="S4.T4.4.4.4.1.m1.1.1.3.2.3.2" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.2.cmml">i</mi><mo id="S4.T4.4.4.4.1.m1.1.1.3.2.3.1" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.T4.4.4.4.1.m1.1.1.3.2.3.3" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.3.cmml">d</mi><mo id="S4.T4.4.4.4.1.m1.1.1.3.2.3.1a" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.T4.4.4.4.1.m1.1.1.3.2.3.4" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.4.cmml">e</mi><mo id="S4.T4.4.4.4.1.m1.1.1.3.2.3.1b" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.T4.4.4.4.1.m1.1.1.3.2.3.5" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.5.cmml">n</mi><mo id="S4.T4.4.4.4.1.m1.1.1.3.2.3.1c" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.T4.4.4.4.1.m1.1.1.3.2.3.6" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.6.cmml">t</mi><mo id="S4.T4.4.4.4.1.m1.1.1.3.2.3.1d" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.T4.4.4.4.1.m1.1.1.3.2.3.7" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.7.cmml">i</mi><mo id="S4.T4.4.4.4.1.m1.1.1.3.2.3.1e" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.T4.4.4.4.1.m1.1.1.3.2.3.8" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.8.cmml">t</mi><mo id="S4.T4.4.4.4.1.m1.1.1.3.2.3.1f" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.T4.4.4.4.1.m1.1.1.3.2.3.9" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.9.cmml">y</mi></mrow></msub><mo id="S4.T4.4.4.4.1.m1.1.1.3.1" xref="S4.T4.4.4.4.1.m1.1.1.3.1.cmml">⁢</mo><msub id="S4.T4.4.4.4.1.m1.1.1.3.3" xref="S4.T4.4.4.4.1.m1.1.1.3.3.cmml"><mi id="S4.T4.4.4.4.1.m1.1.1.3.3.2" xref="S4.T4.4.4.4.1.m1.1.1.3.3.2.cmml">𝐋</mi><mrow id="S4.T4.4.4.4.1.m1.1.1.3.3.3" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.cmml"><mi id="S4.T4.4.4.4.1.m1.1.1.3.3.3.2" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.2.cmml">i</mi><mo id="S4.T4.4.4.4.1.m1.1.1.3.3.3.1" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.T4.4.4.4.1.m1.1.1.3.3.3.3" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.3.cmml">d</mi><mo id="S4.T4.4.4.4.1.m1.1.1.3.3.3.1a" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.T4.4.4.4.1.m1.1.1.3.3.3.4" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.4.cmml">e</mi><mo id="S4.T4.4.4.4.1.m1.1.1.3.3.3.1b" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.T4.4.4.4.1.m1.1.1.3.3.3.5" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.5.cmml">n</mi><mo id="S4.T4.4.4.4.1.m1.1.1.3.3.3.1c" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.T4.4.4.4.1.m1.1.1.3.3.3.6" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.6.cmml">t</mi><mo id="S4.T4.4.4.4.1.m1.1.1.3.3.3.1d" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.T4.4.4.4.1.m1.1.1.3.3.3.7" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.7.cmml">i</mi><mo id="S4.T4.4.4.4.1.m1.1.1.3.3.3.1e" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.T4.4.4.4.1.m1.1.1.3.3.3.8" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.8.cmml">t</mi><mo id="S4.T4.4.4.4.1.m1.1.1.3.3.3.1f" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.T4.4.4.4.1.m1.1.1.3.3.3.9" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.9.cmml">y</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.4.4.4.1.m1.1b"><apply id="S4.T4.4.4.4.1.m1.1.1.cmml" xref="S4.T4.4.4.4.1.m1.1.1"><plus id="S4.T4.4.4.4.1.m1.1.1.1.cmml" xref="S4.T4.4.4.4.1.m1.1.1.1"></plus><apply id="S4.T4.4.4.4.1.m1.1.1.2.cmml" xref="S4.T4.4.4.4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T4.4.4.4.1.m1.1.1.2.1.cmml" xref="S4.T4.4.4.4.1.m1.1.1.2">subscript</csymbol><ci id="S4.T4.4.4.4.1.m1.1.1.2.2.cmml" xref="S4.T4.4.4.4.1.m1.1.1.2.2">𝐋</ci><apply id="S4.T4.4.4.4.1.m1.1.1.2.3.cmml" xref="S4.T4.4.4.4.1.m1.1.1.2.3"><times id="S4.T4.4.4.4.1.m1.1.1.2.3.1.cmml" xref="S4.T4.4.4.4.1.m1.1.1.2.3.1"></times><ci id="S4.T4.4.4.4.1.m1.1.1.2.3.2.cmml" xref="S4.T4.4.4.4.1.m1.1.1.2.3.2">𝑟</ci><ci id="S4.T4.4.4.4.1.m1.1.1.2.3.3.cmml" xref="S4.T4.4.4.4.1.m1.1.1.2.3.3">𝑒</ci><ci id="S4.T4.4.4.4.1.m1.1.1.2.3.4.cmml" xref="S4.T4.4.4.4.1.m1.1.1.2.3.4">𝑐</ci></apply></apply><apply id="S4.T4.4.4.4.1.m1.1.1.3.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3"><times id="S4.T4.4.4.4.1.m1.1.1.3.1.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.1"></times><apply id="S4.T4.4.4.4.1.m1.1.1.3.2.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.T4.4.4.4.1.m1.1.1.3.2.1.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.2">subscript</csymbol><ci id="S4.T4.4.4.4.1.m1.1.1.3.2.2.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.2.2">𝜆</ci><apply id="S4.T4.4.4.4.1.m1.1.1.3.2.3.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3"><times id="S4.T4.4.4.4.1.m1.1.1.3.2.3.1.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.1"></times><ci id="S4.T4.4.4.4.1.m1.1.1.3.2.3.2.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.2">𝑖</ci><ci id="S4.T4.4.4.4.1.m1.1.1.3.2.3.3.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.3">𝑑</ci><ci id="S4.T4.4.4.4.1.m1.1.1.3.2.3.4.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.4">𝑒</ci><ci id="S4.T4.4.4.4.1.m1.1.1.3.2.3.5.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.5">𝑛</ci><ci id="S4.T4.4.4.4.1.m1.1.1.3.2.3.6.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.6">𝑡</ci><ci id="S4.T4.4.4.4.1.m1.1.1.3.2.3.7.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.7">𝑖</ci><ci id="S4.T4.4.4.4.1.m1.1.1.3.2.3.8.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.8">𝑡</ci><ci id="S4.T4.4.4.4.1.m1.1.1.3.2.3.9.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.2.3.9">𝑦</ci></apply></apply><apply id="S4.T4.4.4.4.1.m1.1.1.3.3.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.T4.4.4.4.1.m1.1.1.3.3.1.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.3">subscript</csymbol><ci id="S4.T4.4.4.4.1.m1.1.1.3.3.2.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.3.2">𝐋</ci><apply id="S4.T4.4.4.4.1.m1.1.1.3.3.3.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3"><times id="S4.T4.4.4.4.1.m1.1.1.3.3.3.1.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.1"></times><ci id="S4.T4.4.4.4.1.m1.1.1.3.3.3.2.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.2">𝑖</ci><ci id="S4.T4.4.4.4.1.m1.1.1.3.3.3.3.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.3">𝑑</ci><ci id="S4.T4.4.4.4.1.m1.1.1.3.3.3.4.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.4">𝑒</ci><ci id="S4.T4.4.4.4.1.m1.1.1.3.3.3.5.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.5">𝑛</ci><ci id="S4.T4.4.4.4.1.m1.1.1.3.3.3.6.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.6">𝑡</ci><ci id="S4.T4.4.4.4.1.m1.1.1.3.3.3.7.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.7">𝑖</ci><ci id="S4.T4.4.4.4.1.m1.1.1.3.3.3.8.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.8">𝑡</ci><ci id="S4.T4.4.4.4.1.m1.1.1.3.3.3.9.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.9">𝑦</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.4.4.1.m1.1c">\mathbf{L}_{rec}+\lambda_{identity}\mathbf{L}_{identity}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.4.4.4.1.m1.1d">bold_L start_POSTSUBSCRIPT italic_r italic_e italic_c end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT italic_i italic_d italic_e italic_n italic_t italic_i italic_t italic_y end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT italic_i italic_d italic_e italic_n italic_t italic_i italic_t italic_y end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T4.4.4.4.2">26.31</td>
<td class="ltx_td ltx_align_left" id="S4.T4.4.4.4.3">0.847</td>
</tr>
<tr class="ltx_tr" id="S4.T4.5.5.5">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" id="S4.T4.5.5.5.1">(3) <math alttext="\mathbf{L}_{rec}+\lambda_{identity}\mathbf{L}_{identity}+\lambda_{clip}\mathbf%
{L}_{clip}" class="ltx_Math" display="inline" id="S4.T4.5.5.5.1.m1.1"><semantics id="S4.T4.5.5.5.1.m1.1a"><mrow id="S4.T4.5.5.5.1.m1.1.1" xref="S4.T4.5.5.5.1.m1.1.1.cmml"><msub id="S4.T4.5.5.5.1.m1.1.1.2" xref="S4.T4.5.5.5.1.m1.1.1.2.cmml"><mi id="S4.T4.5.5.5.1.m1.1.1.2.2" xref="S4.T4.5.5.5.1.m1.1.1.2.2.cmml">𝐋</mi><mrow id="S4.T4.5.5.5.1.m1.1.1.2.3" xref="S4.T4.5.5.5.1.m1.1.1.2.3.cmml"><mi id="S4.T4.5.5.5.1.m1.1.1.2.3.2" xref="S4.T4.5.5.5.1.m1.1.1.2.3.2.cmml">r</mi><mo id="S4.T4.5.5.5.1.m1.1.1.2.3.1" xref="S4.T4.5.5.5.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.2.3.3" xref="S4.T4.5.5.5.1.m1.1.1.2.3.3.cmml">e</mi><mo id="S4.T4.5.5.5.1.m1.1.1.2.3.1a" xref="S4.T4.5.5.5.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.2.3.4" xref="S4.T4.5.5.5.1.m1.1.1.2.3.4.cmml">c</mi></mrow></msub><mo id="S4.T4.5.5.5.1.m1.1.1.1" xref="S4.T4.5.5.5.1.m1.1.1.1.cmml">+</mo><mrow id="S4.T4.5.5.5.1.m1.1.1.3" xref="S4.T4.5.5.5.1.m1.1.1.3.cmml"><msub id="S4.T4.5.5.5.1.m1.1.1.3.2" xref="S4.T4.5.5.5.1.m1.1.1.3.2.cmml"><mi id="S4.T4.5.5.5.1.m1.1.1.3.2.2" xref="S4.T4.5.5.5.1.m1.1.1.3.2.2.cmml">λ</mi><mrow id="S4.T4.5.5.5.1.m1.1.1.3.2.3" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.cmml"><mi id="S4.T4.5.5.5.1.m1.1.1.3.2.3.2" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.2.cmml">i</mi><mo id="S4.T4.5.5.5.1.m1.1.1.3.2.3.1" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.3.2.3.3" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.3.cmml">d</mi><mo id="S4.T4.5.5.5.1.m1.1.1.3.2.3.1a" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.3.2.3.4" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.4.cmml">e</mi><mo id="S4.T4.5.5.5.1.m1.1.1.3.2.3.1b" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.3.2.3.5" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.5.cmml">n</mi><mo id="S4.T4.5.5.5.1.m1.1.1.3.2.3.1c" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.3.2.3.6" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.6.cmml">t</mi><mo id="S4.T4.5.5.5.1.m1.1.1.3.2.3.1d" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.3.2.3.7" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.7.cmml">i</mi><mo id="S4.T4.5.5.5.1.m1.1.1.3.2.3.1e" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.3.2.3.8" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.8.cmml">t</mi><mo id="S4.T4.5.5.5.1.m1.1.1.3.2.3.1f" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.3.2.3.9" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.9.cmml">y</mi></mrow></msub><mo id="S4.T4.5.5.5.1.m1.1.1.3.1" xref="S4.T4.5.5.5.1.m1.1.1.3.1.cmml">⁢</mo><msub id="S4.T4.5.5.5.1.m1.1.1.3.3" xref="S4.T4.5.5.5.1.m1.1.1.3.3.cmml"><mi id="S4.T4.5.5.5.1.m1.1.1.3.3.2" xref="S4.T4.5.5.5.1.m1.1.1.3.3.2.cmml">𝐋</mi><mrow id="S4.T4.5.5.5.1.m1.1.1.3.3.3" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.cmml"><mi id="S4.T4.5.5.5.1.m1.1.1.3.3.3.2" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.2.cmml">i</mi><mo id="S4.T4.5.5.5.1.m1.1.1.3.3.3.1" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.3.3.3.3" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.3.cmml">d</mi><mo id="S4.T4.5.5.5.1.m1.1.1.3.3.3.1a" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.3.3.3.4" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.4.cmml">e</mi><mo id="S4.T4.5.5.5.1.m1.1.1.3.3.3.1b" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.3.3.3.5" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.5.cmml">n</mi><mo id="S4.T4.5.5.5.1.m1.1.1.3.3.3.1c" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.3.3.3.6" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.6.cmml">t</mi><mo id="S4.T4.5.5.5.1.m1.1.1.3.3.3.1d" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.3.3.3.7" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.7.cmml">i</mi><mo id="S4.T4.5.5.5.1.m1.1.1.3.3.3.1e" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.3.3.3.8" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.8.cmml">t</mi><mo id="S4.T4.5.5.5.1.m1.1.1.3.3.3.1f" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.3.3.3.9" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.9.cmml">y</mi></mrow></msub></mrow><mo id="S4.T4.5.5.5.1.m1.1.1.1a" xref="S4.T4.5.5.5.1.m1.1.1.1.cmml">+</mo><mrow id="S4.T4.5.5.5.1.m1.1.1.4" xref="S4.T4.5.5.5.1.m1.1.1.4.cmml"><msub id="S4.T4.5.5.5.1.m1.1.1.4.2" xref="S4.T4.5.5.5.1.m1.1.1.4.2.cmml"><mi id="S4.T4.5.5.5.1.m1.1.1.4.2.2" xref="S4.T4.5.5.5.1.m1.1.1.4.2.2.cmml">λ</mi><mrow id="S4.T4.5.5.5.1.m1.1.1.4.2.3" xref="S4.T4.5.5.5.1.m1.1.1.4.2.3.cmml"><mi id="S4.T4.5.5.5.1.m1.1.1.4.2.3.2" xref="S4.T4.5.5.5.1.m1.1.1.4.2.3.2.cmml">c</mi><mo id="S4.T4.5.5.5.1.m1.1.1.4.2.3.1" xref="S4.T4.5.5.5.1.m1.1.1.4.2.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.4.2.3.3" xref="S4.T4.5.5.5.1.m1.1.1.4.2.3.3.cmml">l</mi><mo id="S4.T4.5.5.5.1.m1.1.1.4.2.3.1a" xref="S4.T4.5.5.5.1.m1.1.1.4.2.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.4.2.3.4" xref="S4.T4.5.5.5.1.m1.1.1.4.2.3.4.cmml">i</mi><mo id="S4.T4.5.5.5.1.m1.1.1.4.2.3.1b" xref="S4.T4.5.5.5.1.m1.1.1.4.2.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.4.2.3.5" xref="S4.T4.5.5.5.1.m1.1.1.4.2.3.5.cmml">p</mi></mrow></msub><mo id="S4.T4.5.5.5.1.m1.1.1.4.1" xref="S4.T4.5.5.5.1.m1.1.1.4.1.cmml">⁢</mo><msub id="S4.T4.5.5.5.1.m1.1.1.4.3" xref="S4.T4.5.5.5.1.m1.1.1.4.3.cmml"><mi id="S4.T4.5.5.5.1.m1.1.1.4.3.2" xref="S4.T4.5.5.5.1.m1.1.1.4.3.2.cmml">𝐋</mi><mrow id="S4.T4.5.5.5.1.m1.1.1.4.3.3" xref="S4.T4.5.5.5.1.m1.1.1.4.3.3.cmml"><mi id="S4.T4.5.5.5.1.m1.1.1.4.3.3.2" xref="S4.T4.5.5.5.1.m1.1.1.4.3.3.2.cmml">c</mi><mo id="S4.T4.5.5.5.1.m1.1.1.4.3.3.1" xref="S4.T4.5.5.5.1.m1.1.1.4.3.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.4.3.3.3" xref="S4.T4.5.5.5.1.m1.1.1.4.3.3.3.cmml">l</mi><mo id="S4.T4.5.5.5.1.m1.1.1.4.3.3.1a" xref="S4.T4.5.5.5.1.m1.1.1.4.3.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.4.3.3.4" xref="S4.T4.5.5.5.1.m1.1.1.4.3.3.4.cmml">i</mi><mo id="S4.T4.5.5.5.1.m1.1.1.4.3.3.1b" xref="S4.T4.5.5.5.1.m1.1.1.4.3.3.1.cmml">⁢</mo><mi id="S4.T4.5.5.5.1.m1.1.1.4.3.3.5" xref="S4.T4.5.5.5.1.m1.1.1.4.3.3.5.cmml">p</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.5.5.5.1.m1.1b"><apply id="S4.T4.5.5.5.1.m1.1.1.cmml" xref="S4.T4.5.5.5.1.m1.1.1"><plus id="S4.T4.5.5.5.1.m1.1.1.1.cmml" xref="S4.T4.5.5.5.1.m1.1.1.1"></plus><apply id="S4.T4.5.5.5.1.m1.1.1.2.cmml" xref="S4.T4.5.5.5.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T4.5.5.5.1.m1.1.1.2.1.cmml" xref="S4.T4.5.5.5.1.m1.1.1.2">subscript</csymbol><ci id="S4.T4.5.5.5.1.m1.1.1.2.2.cmml" xref="S4.T4.5.5.5.1.m1.1.1.2.2">𝐋</ci><apply id="S4.T4.5.5.5.1.m1.1.1.2.3.cmml" xref="S4.T4.5.5.5.1.m1.1.1.2.3"><times id="S4.T4.5.5.5.1.m1.1.1.2.3.1.cmml" xref="S4.T4.5.5.5.1.m1.1.1.2.3.1"></times><ci id="S4.T4.5.5.5.1.m1.1.1.2.3.2.cmml" xref="S4.T4.5.5.5.1.m1.1.1.2.3.2">𝑟</ci><ci id="S4.T4.5.5.5.1.m1.1.1.2.3.3.cmml" xref="S4.T4.5.5.5.1.m1.1.1.2.3.3">𝑒</ci><ci id="S4.T4.5.5.5.1.m1.1.1.2.3.4.cmml" xref="S4.T4.5.5.5.1.m1.1.1.2.3.4">𝑐</ci></apply></apply><apply id="S4.T4.5.5.5.1.m1.1.1.3.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3"><times id="S4.T4.5.5.5.1.m1.1.1.3.1.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.1"></times><apply id="S4.T4.5.5.5.1.m1.1.1.3.2.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.T4.5.5.5.1.m1.1.1.3.2.1.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.2">subscript</csymbol><ci id="S4.T4.5.5.5.1.m1.1.1.3.2.2.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.2.2">𝜆</ci><apply id="S4.T4.5.5.5.1.m1.1.1.3.2.3.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3"><times id="S4.T4.5.5.5.1.m1.1.1.3.2.3.1.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.1"></times><ci id="S4.T4.5.5.5.1.m1.1.1.3.2.3.2.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.2">𝑖</ci><ci id="S4.T4.5.5.5.1.m1.1.1.3.2.3.3.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.3">𝑑</ci><ci id="S4.T4.5.5.5.1.m1.1.1.3.2.3.4.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.4">𝑒</ci><ci id="S4.T4.5.5.5.1.m1.1.1.3.2.3.5.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.5">𝑛</ci><ci id="S4.T4.5.5.5.1.m1.1.1.3.2.3.6.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.6">𝑡</ci><ci id="S4.T4.5.5.5.1.m1.1.1.3.2.3.7.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.7">𝑖</ci><ci id="S4.T4.5.5.5.1.m1.1.1.3.2.3.8.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.8">𝑡</ci><ci id="S4.T4.5.5.5.1.m1.1.1.3.2.3.9.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.2.3.9">𝑦</ci></apply></apply><apply id="S4.T4.5.5.5.1.m1.1.1.3.3.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.T4.5.5.5.1.m1.1.1.3.3.1.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.3">subscript</csymbol><ci id="S4.T4.5.5.5.1.m1.1.1.3.3.2.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.3.2">𝐋</ci><apply id="S4.T4.5.5.5.1.m1.1.1.3.3.3.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3"><times id="S4.T4.5.5.5.1.m1.1.1.3.3.3.1.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.1"></times><ci id="S4.T4.5.5.5.1.m1.1.1.3.3.3.2.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.2">𝑖</ci><ci id="S4.T4.5.5.5.1.m1.1.1.3.3.3.3.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.3">𝑑</ci><ci id="S4.T4.5.5.5.1.m1.1.1.3.3.3.4.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.4">𝑒</ci><ci id="S4.T4.5.5.5.1.m1.1.1.3.3.3.5.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.5">𝑛</ci><ci id="S4.T4.5.5.5.1.m1.1.1.3.3.3.6.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.6">𝑡</ci><ci id="S4.T4.5.5.5.1.m1.1.1.3.3.3.7.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.7">𝑖</ci><ci id="S4.T4.5.5.5.1.m1.1.1.3.3.3.8.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.8">𝑡</ci><ci id="S4.T4.5.5.5.1.m1.1.1.3.3.3.9.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.3.3.9">𝑦</ci></apply></apply></apply><apply id="S4.T4.5.5.5.1.m1.1.1.4.cmml" xref="S4.T4.5.5.5.1.m1.1.1.4"><times id="S4.T4.5.5.5.1.m1.1.1.4.1.cmml" xref="S4.T4.5.5.5.1.m1.1.1.4.1"></times><apply id="S4.T4.5.5.5.1.m1.1.1.4.2.cmml" xref="S4.T4.5.5.5.1.m1.1.1.4.2"><csymbol cd="ambiguous" id="S4.T4.5.5.5.1.m1.1.1.4.2.1.cmml" xref="S4.T4.5.5.5.1.m1.1.1.4.2">subscript</csymbol><ci id="S4.T4.5.5.5.1.m1.1.1.4.2.2.cmml" xref="S4.T4.5.5.5.1.m1.1.1.4.2.2">𝜆</ci><apply id="S4.T4.5.5.5.1.m1.1.1.4.2.3.cmml" xref="S4.T4.5.5.5.1.m1.1.1.4.2.3"><times id="S4.T4.5.5.5.1.m1.1.1.4.2.3.1.cmml" xref="S4.T4.5.5.5.1.m1.1.1.4.2.3.1"></times><ci id="S4.T4.5.5.5.1.m1.1.1.4.2.3.2.cmml" xref="S4.T4.5.5.5.1.m1.1.1.4.2.3.2">𝑐</ci><ci id="S4.T4.5.5.5.1.m1.1.1.4.2.3.3.cmml" xref="S4.T4.5.5.5.1.m1.1.1.4.2.3.3">𝑙</ci><ci id="S4.T4.5.5.5.1.m1.1.1.4.2.3.4.cmml" xref="S4.T4.5.5.5.1.m1.1.1.4.2.3.4">𝑖</ci><ci id="S4.T4.5.5.5.1.m1.1.1.4.2.3.5.cmml" xref="S4.T4.5.5.5.1.m1.1.1.4.2.3.5">𝑝</ci></apply></apply><apply id="S4.T4.5.5.5.1.m1.1.1.4.3.cmml" xref="S4.T4.5.5.5.1.m1.1.1.4.3"><csymbol cd="ambiguous" id="S4.T4.5.5.5.1.m1.1.1.4.3.1.cmml" xref="S4.T4.5.5.5.1.m1.1.1.4.3">subscript</csymbol><ci id="S4.T4.5.5.5.1.m1.1.1.4.3.2.cmml" xref="S4.T4.5.5.5.1.m1.1.1.4.3.2">𝐋</ci><apply id="S4.T4.5.5.5.1.m1.1.1.4.3.3.cmml" xref="S4.T4.5.5.5.1.m1.1.1.4.3.3"><times id="S4.T4.5.5.5.1.m1.1.1.4.3.3.1.cmml" xref="S4.T4.5.5.5.1.m1.1.1.4.3.3.1"></times><ci id="S4.T4.5.5.5.1.m1.1.1.4.3.3.2.cmml" xref="S4.T4.5.5.5.1.m1.1.1.4.3.3.2">𝑐</ci><ci id="S4.T4.5.5.5.1.m1.1.1.4.3.3.3.cmml" xref="S4.T4.5.5.5.1.m1.1.1.4.3.3.3">𝑙</ci><ci id="S4.T4.5.5.5.1.m1.1.1.4.3.3.4.cmml" xref="S4.T4.5.5.5.1.m1.1.1.4.3.3.4">𝑖</ci><ci id="S4.T4.5.5.5.1.m1.1.1.4.3.3.5.cmml" xref="S4.T4.5.5.5.1.m1.1.1.4.3.3.5">𝑝</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.5.5.5.1.m1.1c">\mathbf{L}_{rec}+\lambda_{identity}\mathbf{L}_{identity}+\lambda_{clip}\mathbf%
{L}_{clip}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.5.5.5.1.m1.1d">bold_L start_POSTSUBSCRIPT italic_r italic_e italic_c end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT italic_i italic_d italic_e italic_n italic_t italic_i italic_t italic_y end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT italic_i italic_d italic_e italic_n italic_t italic_i italic_t italic_y end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT italic_c italic_l italic_i italic_p end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT italic_c italic_l italic_i italic_p end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" id="S4.T4.5.5.5.2">26.42</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S4.T4.5.5.5.3">0.853</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS4.5.1.1">IV-D</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS4.6.2">Ablation Study</span>
</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">In Tab. <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S4.T3" title="TABLE III ‣ IV-C Results on the Real-World Dataset ‣ IV EXPERIMENTS ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag">III</span></a> and Tab. <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S4.T4" title="TABLE IV ‣ IV-C Results on the Real-World Dataset ‣ IV EXPERIMENTS ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag">IV</span></a>, we present the results of the ablation studies performed on DAP-LED to evaluate the impact of different prompt configurations and loss functions on image restoration performance. Tab. <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S4.T3" title="TABLE III ‣ IV-C Results on the Real-World Dataset ‣ IV EXPERIMENTS ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag">III</span></a> compares the effectiveness of using different prompt learning strategies, including deblur prompt, lowlight prompt, and their combination (Joint Prompt). The results indicate that while both individual prompts improve image quality, the joint prompt yields the highest PSNR and SSIM, demonstrating the benefits of leveraging both aspects simultaneously.</p>
</div>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.3">Tab. <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S4.T4" title="TABLE IV ‣ IV-C Results on the Real-World Dataset ‣ IV EXPERIMENTS ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag">IV</span></a> presents an ablation study on the losses used during training, showing the impact of adding identity loss (<math alttext="\mathbf{L}_{identity}" class="ltx_Math" display="inline" id="S4.SS4.p2.1.m1.1"><semantics id="S4.SS4.p2.1.m1.1a"><msub id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml"><mi id="S4.SS4.p2.1.m1.1.1.2" xref="S4.SS4.p2.1.m1.1.1.2.cmml">𝐋</mi><mrow id="S4.SS4.p2.1.m1.1.1.3" xref="S4.SS4.p2.1.m1.1.1.3.cmml"><mi id="S4.SS4.p2.1.m1.1.1.3.2" xref="S4.SS4.p2.1.m1.1.1.3.2.cmml">i</mi><mo id="S4.SS4.p2.1.m1.1.1.3.1" xref="S4.SS4.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p2.1.m1.1.1.3.3" xref="S4.SS4.p2.1.m1.1.1.3.3.cmml">d</mi><mo id="S4.SS4.p2.1.m1.1.1.3.1a" xref="S4.SS4.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p2.1.m1.1.1.3.4" xref="S4.SS4.p2.1.m1.1.1.3.4.cmml">e</mi><mo id="S4.SS4.p2.1.m1.1.1.3.1b" xref="S4.SS4.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p2.1.m1.1.1.3.5" xref="S4.SS4.p2.1.m1.1.1.3.5.cmml">n</mi><mo id="S4.SS4.p2.1.m1.1.1.3.1c" xref="S4.SS4.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p2.1.m1.1.1.3.6" xref="S4.SS4.p2.1.m1.1.1.3.6.cmml">t</mi><mo id="S4.SS4.p2.1.m1.1.1.3.1d" xref="S4.SS4.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p2.1.m1.1.1.3.7" xref="S4.SS4.p2.1.m1.1.1.3.7.cmml">i</mi><mo id="S4.SS4.p2.1.m1.1.1.3.1e" xref="S4.SS4.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p2.1.m1.1.1.3.8" xref="S4.SS4.p2.1.m1.1.1.3.8.cmml">t</mi><mo id="S4.SS4.p2.1.m1.1.1.3.1f" xref="S4.SS4.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p2.1.m1.1.1.3.9" xref="S4.SS4.p2.1.m1.1.1.3.9.cmml">y</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><apply id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.1.m1.1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p2.1.m1.1.1.2.cmml" xref="S4.SS4.p2.1.m1.1.1.2">𝐋</ci><apply id="S4.SS4.p2.1.m1.1.1.3.cmml" xref="S4.SS4.p2.1.m1.1.1.3"><times id="S4.SS4.p2.1.m1.1.1.3.1.cmml" xref="S4.SS4.p2.1.m1.1.1.3.1"></times><ci id="S4.SS4.p2.1.m1.1.1.3.2.cmml" xref="S4.SS4.p2.1.m1.1.1.3.2">𝑖</ci><ci id="S4.SS4.p2.1.m1.1.1.3.3.cmml" xref="S4.SS4.p2.1.m1.1.1.3.3">𝑑</ci><ci id="S4.SS4.p2.1.m1.1.1.3.4.cmml" xref="S4.SS4.p2.1.m1.1.1.3.4">𝑒</ci><ci id="S4.SS4.p2.1.m1.1.1.3.5.cmml" xref="S4.SS4.p2.1.m1.1.1.3.5">𝑛</ci><ci id="S4.SS4.p2.1.m1.1.1.3.6.cmml" xref="S4.SS4.p2.1.m1.1.1.3.6">𝑡</ci><ci id="S4.SS4.p2.1.m1.1.1.3.7.cmml" xref="S4.SS4.p2.1.m1.1.1.3.7">𝑖</ci><ci id="S4.SS4.p2.1.m1.1.1.3.8.cmml" xref="S4.SS4.p2.1.m1.1.1.3.8">𝑡</ci><ci id="S4.SS4.p2.1.m1.1.1.3.9.cmml" xref="S4.SS4.p2.1.m1.1.1.3.9">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">\mathbf{L}_{identity}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.1.m1.1d">bold_L start_POSTSUBSCRIPT italic_i italic_d italic_e italic_n italic_t italic_i italic_t italic_y end_POSTSUBSCRIPT</annotation></semantics></math>) and CLIP loss (<math alttext="\mathbf{L}_{clip}" class="ltx_Math" display="inline" id="S4.SS4.p2.2.m2.1"><semantics id="S4.SS4.p2.2.m2.1a"><msub id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml"><mi id="S4.SS4.p2.2.m2.1.1.2" xref="S4.SS4.p2.2.m2.1.1.2.cmml">𝐋</mi><mrow id="S4.SS4.p2.2.m2.1.1.3" xref="S4.SS4.p2.2.m2.1.1.3.cmml"><mi id="S4.SS4.p2.2.m2.1.1.3.2" xref="S4.SS4.p2.2.m2.1.1.3.2.cmml">c</mi><mo id="S4.SS4.p2.2.m2.1.1.3.1" xref="S4.SS4.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p2.2.m2.1.1.3.3" xref="S4.SS4.p2.2.m2.1.1.3.3.cmml">l</mi><mo id="S4.SS4.p2.2.m2.1.1.3.1a" xref="S4.SS4.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p2.2.m2.1.1.3.4" xref="S4.SS4.p2.2.m2.1.1.3.4.cmml">i</mi><mo id="S4.SS4.p2.2.m2.1.1.3.1b" xref="S4.SS4.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p2.2.m2.1.1.3.5" xref="S4.SS4.p2.2.m2.1.1.3.5.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><apply id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.2.m2.1.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS4.p2.2.m2.1.1.2.cmml" xref="S4.SS4.p2.2.m2.1.1.2">𝐋</ci><apply id="S4.SS4.p2.2.m2.1.1.3.cmml" xref="S4.SS4.p2.2.m2.1.1.3"><times id="S4.SS4.p2.2.m2.1.1.3.1.cmml" xref="S4.SS4.p2.2.m2.1.1.3.1"></times><ci id="S4.SS4.p2.2.m2.1.1.3.2.cmml" xref="S4.SS4.p2.2.m2.1.1.3.2">𝑐</ci><ci id="S4.SS4.p2.2.m2.1.1.3.3.cmml" xref="S4.SS4.p2.2.m2.1.1.3.3">𝑙</ci><ci id="S4.SS4.p2.2.m2.1.1.3.4.cmml" xref="S4.SS4.p2.2.m2.1.1.3.4">𝑖</ci><ci id="S4.SS4.p2.2.m2.1.1.3.5.cmml" xref="S4.SS4.p2.2.m2.1.1.3.5">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">\mathbf{L}_{clip}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.2.m2.1d">bold_L start_POSTSUBSCRIPT italic_c italic_l italic_i italic_p end_POSTSUBSCRIPT</annotation></semantics></math>) alongside the reconstruction loss (<math alttext="\mathbf{L}_{rec}" class="ltx_Math" display="inline" id="S4.SS4.p2.3.m3.1"><semantics id="S4.SS4.p2.3.m3.1a"><msub id="S4.SS4.p2.3.m3.1.1" xref="S4.SS4.p2.3.m3.1.1.cmml"><mi id="S4.SS4.p2.3.m3.1.1.2" xref="S4.SS4.p2.3.m3.1.1.2.cmml">𝐋</mi><mrow id="S4.SS4.p2.3.m3.1.1.3" xref="S4.SS4.p2.3.m3.1.1.3.cmml"><mi id="S4.SS4.p2.3.m3.1.1.3.2" xref="S4.SS4.p2.3.m3.1.1.3.2.cmml">r</mi><mo id="S4.SS4.p2.3.m3.1.1.3.1" xref="S4.SS4.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p2.3.m3.1.1.3.3" xref="S4.SS4.p2.3.m3.1.1.3.3.cmml">e</mi><mo id="S4.SS4.p2.3.m3.1.1.3.1a" xref="S4.SS4.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p2.3.m3.1.1.3.4" xref="S4.SS4.p2.3.m3.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.3.m3.1b"><apply id="S4.SS4.p2.3.m3.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.3.m3.1.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.p2.3.m3.1.1.2.cmml" xref="S4.SS4.p2.3.m3.1.1.2">𝐋</ci><apply id="S4.SS4.p2.3.m3.1.1.3.cmml" xref="S4.SS4.p2.3.m3.1.1.3"><times id="S4.SS4.p2.3.m3.1.1.3.1.cmml" xref="S4.SS4.p2.3.m3.1.1.3.1"></times><ci id="S4.SS4.p2.3.m3.1.1.3.2.cmml" xref="S4.SS4.p2.3.m3.1.1.3.2">𝑟</ci><ci id="S4.SS4.p2.3.m3.1.1.3.3.cmml" xref="S4.SS4.p2.3.m3.1.1.3.3">𝑒</ci><ci id="S4.SS4.p2.3.m3.1.1.3.4.cmml" xref="S4.SS4.p2.3.m3.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.3.m3.1c">\mathbf{L}_{rec}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.3.m3.1d">bold_L start_POSTSUBSCRIPT italic_r italic_e italic_c end_POSTSUBSCRIPT</annotation></semantics></math>). The results show a progressive improvement in PSNR and SSIM as these additional losses are included. The highest performance is achieved with the full loss combination, highlighting the importance of incorporating both identity and CLIP constraints for improved image restoration.</p>
</div>
<figure class="ltx_figure" id="S4.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="304" id="S4.F7.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Visual Results of YOLO V8, SAM and Depth Anything V2 on the <span class="ltx_text ltx_font_bold" id="S4.F7.2.1">synthetic</span> LOL-Blur datasset.</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="539" id="S4.F8.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Visual Results of YOLO V8, SAM and Depth Anything V2 on the Real LOL-Blur dataset.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS5.5.1.1">IV-E</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS5.6.2">Applications to Downstream Vision Tasks</span>
</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">To verify the effectiveness of our DAP-LED framework, we further apply the enhanced results to three downstream vision tasks, depth estimation (with DepthAnything V2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib37" title="">37</a>]</cite>), segmentation (SAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib38" title="">38</a>]</cite>), and detection (YoloV8 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#bib.bib39" title="">39</a>]</cite>). We provide comparisons of three downstream tasks for the night-blurred image and enhanced image. Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S4.F7" title="Figure 7 ‣ IV-D Ablation Study ‣ IV EXPERIMENTS ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag">7</span></a> and Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13496v1#S4.F8" title="Figure 8 ‣ IV-D Ablation Study ‣ IV EXPERIMENTS ‣ DAP-LED: Learning Degradation-Aware Priors with CLIP for Joint Low-light Enhancement and Deblurring"><span class="ltx_text ltx_ref_tag">8</span></a> depict the qualitative results for 1) the synthetic LOL-Blur dataset and 2) the real-world Real-LOL-Blur dataset, respectively. The bottom row of each figure demonstrates better results with our enhanced image as input. YOLO V8 enhances both the precision of object detection and the total number of detected objects. SAM delivers clearer segmentation boundaries, while Depth Anything V2 generates more detailed and accurate depth maps.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span class="ltx_text ltx_font_smallcaps" id="S5.1.1">CONCLUSIONS</span>
</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we introduced DAP-LED, a novel joint low-light enhancement and deblurring framework that leverages the powerful multi-modal perception capabilities of the CLIP model. By utilizing CLIP’s text-image embedding space, our method can perceive and restore complex image degradations more effectively. Through extensive experiments, we demonstrated that DAP-LED achieves state-of-the-art performance on real night-blurred images, beneficial for three downstream tasks in the dark for robotic scene understanding.
Future work will focus on expanding this framework to handle more diverse degradations and further optimizing the restoration process for real-time applications.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Y. Zhang, A. Carballo, H. Yang, and K. Takeda, “Perception and sensing for autonomous vehicles under adverse weather conditions: A survey,” <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">ISPRS Journal of Photogrammetry and Remote Sensing</em>, vol. 196, pp. 146–177, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
P. Liu, X. Zuo, V. Larsson, and M. Pollefeys, “Mba-vo: Motion blur aware visual odometry,” in <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, 2021, pp. 5550–5559.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
L. Yang, B. Kang, Z. Huang, Z. Zhao, X. Xu, J. Feng, and H. Zhao, “Depth anything v2,” <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:2406.09414</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
N. Carion, F. Massa, G. Synnaeve, N. Usunier, A. Kirillov, and S. Zagoruyko, “End-to-end object detection with transformers,” in <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">European conference on computer vision</em>.   Springer, 2020, pp. 213–229.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
C. Guo, C. Li, J. Guo, C. C. Loy, J. Hou, S. Kwong, and R. Cong, “Zero-reference deep curve estimation for low-light image enhancement,” in <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 2020, pp. 1780–1789.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
C. Li, C. Guo, L. Han, J. Jiang, M.-M. Cheng, J. Gu, and C. C. Loy, “Low-light image and video enhancement using deep learning: A survey,” <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">IEEE transactions on pattern analysis and machine intelligence</em>, vol. 44, no. 12, pp. 9396–9416, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
L. Chen, J. Zhang, S. Lin, F. Fang, and J. S. Ren, “Blind deblurring for saturated images,” in <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 2021, pp. 6308–6316.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
H. Zhang, Y. Dai, H. Li, and P. Koniusz, “Deep stacked hierarchical multi-patch network for image deblurring,” in <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 2019, pp. 5978–5986.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
O. Kupyn, T. Martyniuk, J. Wu, and Z. Wang, “Deblurgan-v2: Deblurring (orders-of-magnitude) faster and better,” in <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Proceedings of the IEEE/CVF international conference on computer vision</em>, 2019, pp. 8878–8887.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
S. Zhou, C. Li, and C. Change Loy, “Lednet: Joint low-light enhancement and deblurring in the dark,” in <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">European conference on computer vision</em>.   Springer, 2022, pp. 573–589.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
J. Ye, Y. Liu, C. Yu, C. Qiu, and Z. Zhang, “Asp-led: Learning ambiguity-aware structural priors for joint low-light enhancement and deblurring,” in <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">2024 IEEE International Conference on Robotics and Automation (ICRA)</em>.   IEEE, 2024, pp. 12 389–12 396.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
S.-J. Cho, S.-W. Ji, J.-P. Hong, S.-W. Jung, and S.-J. Ko, “Rethinking coarse-to-fine approach in single image deblurring,” in <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Proceedings of the IEEE/CVF international conference on computer vision</em>, 2021, pp. 4641–4650.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Z. Hu, S. Cho, J. Wang, and M.-H. Yang, “Deblurring low-light images with light streaks,” in <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</em>, 2014, pp. 3382–3389.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
A. Radford, J. W. Kim, C. Hallacy, A. Ramesh, G. Goh, S. Agarwal, G. Sastry, A. Askell, P. Mishkin, J. Clark, <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">et al.</em>, “Learning transferable visual models from natural language supervision,” in <em class="ltx_emph ltx_font_italic" id="bib.bib14.2.2">International conference on machine learning</em>.   PMLR, 2021, pp. 8748–8763.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
C. Wei, W. Wang, W. Yang, and J. Liu, “Deep retinex decomposition for low-light enhancement,” <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:1808.04560</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Y. Cai, H. Bian, J. Lin, H. Wang, R. Timofte, and Y. Zhang, “Retinexformer: One-stage retinex-based transformer for low-light image enhancement,” in <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, 2023, pp. 12 504–12 513.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
S. Nah, T. Hyun Kim, and K. Mu Lee, “Deep multi-scale convolutional neural network for dynamic scene deblurring,” in <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, 2017, pp. 3883–3891.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
S. W. Zamir, A. Arora, S. Khan, M. Hayat, F. S. Khan, M.-H. Yang, and L. Shao, “Multi-stage progressive image restoration,” in <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 2021, pp. 14 821–14 831.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Z. Wang, X. Cun, J. Bao, W. Zhou, J. Liu, and H. Li, “Uformer: A general u-shaped transformer for image restoration,” in <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 2022, pp. 17 683–17 693.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
F.-J. Tsai, Y.-T. Peng, Y.-Y. Lin, C.-C. Tsai, and C.-W. Lin, “Stripformer: Strip transformer for fast image deblurring,” in <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">European conference on computer vision</em>.   Springer, 2022, pp. 146–162.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
S. W. Zamir, A. Arora, S. Khan, M. Hayat, F. S. Khan, and M.-H. Yang, “Restormer: Efficient transformer for high-resolution image restoration,” in <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 2022, pp. 5728–5739.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
X. Lv, S. Zhang, C. Wang, Y. Zheng, B. Zhong, C. Li, and L. Nie, “Fourier priors-guided diffusion for zero-shot joint low-light enhancement and deblurring,” in <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2024, pp. 25 378–25 388.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
O. Patashnik, Z. Wu, E. Shechtman, D. Cohen-Or, and D. Lischinski, “Styleclip: Text-driven manipulation of stylegan imagery,” in <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, 2021, pp. 2085–2094.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
T. Wei, D. Chen, W. Zhou, J. Liao, Z. Tan, L. Yuan, W. Zhang, and N. Yu, “Hairclip: Design your hair by text and reference image,” in <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2022, pp. 18 072–18 081.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
G. Kim, T. Kwon, and J. C. Ye, “Diffusionclip: Text-guided diffusion models for robust image manipulation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2022, pp. 2426–2435.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
K. Crowson, S. Biderman, D. Kornis, D. Stander, E. Hallahan, L. Castricato, and E. Raff, “Vqgan-clip: Open domain image generation and editing with natural language guidance,” in <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">European Conference on Computer Vision</em>.   Springer, 2022, pp. 88–105.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Z. Wang, W. Liu, Q. He, X. Wu, and Z. Yi, “Clip-gen: Language-free training of a text-to-image generator with clip,” <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:2203.00386</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
K. Frans, L. Soros, and O. Witkowski, “Clipdraw: Exploring text-to-drawing synthesis through language-image encoders,” <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Advances in Neural Information Processing Systems</em>, vol. 35, pp. 5207–5218, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Z. Liang, C. Li, S. Zhou, R. Feng, and C. C. Loy, “Iterative prompt learning for unsupervised backlit image enhancement,” in <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, 2023, pp. 8094–8103.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Z. Luo, F. K. Gustafsson, Z. Zhao, J. Sjölund, and T. B. Schön, “Controlling vision-language models for universal image restoration,” <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:2310.01018</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
T. Karras, S. Laine, M. Aittala, J. Hellsten, J. Lehtinen, and T. Aila, “Analyzing and improving the image quality of stylegan,” in <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 2020, pp. 8110–8119.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
C. Saharia, J. Ho, W. Chan, T. Salimans, D. J. Fleet, and M. Norouzi, “Image super-resolution via iterative refinement,” <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, vol. 45, no. 4, pp. 4713–4726, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
R. Liu, L. Ma, J. Zhang, X. Fan, and Z. Luo, “Retinex-inspired unrolling with cooperative prior architecture search for low-light image enhancement,” in <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 2021, pp. 10 561–10 570.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Y. Zhang, X. Guo, J. Ma, W. Liu, and J. Zhang, “Beyond brightening low-light images,” <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">International Journal of Computer Vision</em>, vol. 129, pp. 1013–1037, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
W. Yang, S. Wang, Y. Fang, Y. Wang, and J. Liu, “Band representation-based semi-supervised low-light image enhancement: Bridging the gap between signal fidelity and perceptual quality,” <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">IEEE Transactions on Image Processing</em>, vol. 30, pp. 3461–3473, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
X. Xu, R. Wang, C.-W. Fu, and J. Jia, “Snr-aware low-light image enhancement,” in <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 2022, pp. 17 714–17 724.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
L. Yang, B. Kang, Z. Huang, Z. Zhao, X. Xu, J. Feng, and H. Zhao, “Depth anything v2,” <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">arXiv:2406.09414</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
A. Kirillov, E. Mintun, N. Ravi, H. Mao, C. Rolland, L. Gustafson, T. Xiao, S. Whitehead, A. C. Berg, W.-Y. Lo, <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">et al.</em>, “Segment anything,” in <em class="ltx_emph ltx_font_italic" id="bib.bib38.2.2">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, 2023, pp. 4015–4026.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Ultralytics, “YOLOv8: Real-time object detection,” <a class="ltx_ref ltx_url" href="https://github.com/ultralytics/ultralytics" title="">https://github.com/ultralytics/ultralytics</a>, 2023.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Sep 20 13:34:15 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
