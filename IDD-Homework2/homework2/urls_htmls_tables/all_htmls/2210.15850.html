<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2210.15850] Federated Learning based Energy Demand Prediction with Clustered Aggregation This work was partially supported by Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government(MSIT) (No.2019-0-01287, Evolvable Deep Learning Model Generation Platform for Edge Computing) and by the National Research Foundation of Korea(NRF) grant funded by the Korea government(MSIT) (No. No. 2020R1A4A1018607). *Dr. CS Hong is the corresponding author.</title><meta property="og:description" content="To reduce negative environmental impacts, power stations and energy grids need to optimize the resources required for power production. Thus, predicting the energy consumption of clients is becoming an important part o…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated Learning based Energy Demand Prediction with Clustered Aggregation This work was partially supported by Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government(MSIT) (No.2019-0-01287, Evolvable Deep Learning Model Generation Platform for Edge Computing) and by the National Research Foundation of Korea(NRF) grant funded by the Korea government(MSIT) (No. No. 2020R1A4A1018607). *Dr. CS Hong is the corresponding author.">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated Learning based Energy Demand Prediction with Clustered Aggregation This work was partially supported by Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government(MSIT) (No.2019-0-01287, Evolvable Deep Learning Model Generation Platform for Edge Computing) and by the National Research Foundation of Korea(NRF) grant funded by the Korea government(MSIT) (No. No. 2020R1A4A1018607). *Dr. CS Hong is the corresponding author.">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2210.15850">

<!--Generated on Tue Feb 27 01:59:36 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
energy,  federated learning,  recurrent neural network,  clustering,  long short-term memory
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Federated Learning based Energy Demand Prediction with Clustered Aggregation 
<br class="ltx_break"><span id="id1.id1" class="ltx_note ltx_role_thanks"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">thanks: </span>This work was partially supported by Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government(MSIT) (No.2019-0-01287, Evolvable Deep Learning Model Generation Platform for Edge Computing) and by the National Research Foundation of Korea(NRF) grant funded by the Korea government(MSIT) (No. No. 2020R1A4A1018607). *Dr. CS Hong is the corresponding author.</span></span></span>
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Ye Lin Tun, Kyi Thar, Chu Myaet Thwal, Choong Seon Hong
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id2.1.id1" class="ltx_text ltx_font_italic">Department of Computer Science and Engineering
<br class="ltx_break">Kyung Hee University
<br class="ltx_break"></span>Yongin-si, 17104, Republic of Korea 
<br class="ltx_break">{yelintun, kyithar, chumyaet, cshong}@khu.ac.kr
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id3.id1" class="ltx_p">To reduce negative environmental impacts, power stations and energy grids need to optimize the resources required for power production. Thus, predicting the energy consumption of clients is becoming an important part of every energy management system. Energy usage information collected by the clients’ smart homes can be used to train a deep neural network to predict the future energy demand. Collecting data from a large number of distributed clients for centralized model training is expensive in terms of communication resources. To take advantage of distributed data in edge systems, centralized training can be replaced by federated learning where each client only needs to upload model updates produced by training on its local data. These model updates are aggregated into a single global model by the server. But since different clients can have different attributes, model updates can have diverse weights and as a result, it can take a long time for the aggregated global model to converge. To speed up the convergence process, we can apply clustering to group clients based on their properties and aggregate model updates from the same cluster together to produce a cluster specific global model. In this paper, we propose a recurrent neural network based energy demand predictor, trained with federated learning on clustered clients to take advantage of distributed data and speed up the convergence process.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
energy, federated learning, recurrent neural network, clustering, long short-term memory

</div>
<div id="p1" class="ltx_para">
<svg id="p1.pic1" class="ltx_picture" height="70.11" overflow="visible" version="1.1" width="604.52"><g transform="translate(0,70.11) matrix(1 0 0 -1 0 0) translate(-122.74,0) translate(0,-14.11) matrix(1.0 0.0 0.0 1.0 127.35 44.32)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><foreignObject width="595.3" height="60.88" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible">
<span id="p1.pic1.1.1.1.1" class="ltx_inline-block ltx_parbox ltx_align_middle ltx_framed ltx_framed_rectangle" style="width:430.2pt;">
<span id="p1.pic1.1.1.1.1.1" class="ltx_p"><span id="p1.pic1.1.1.1.1.1.1" class="ltx_text" style="font-size:80%;">©2012 IEEE. Personal use of this material is permitted.
Permission from IEEE must be obtained for all other uses, in any current or future
media, including reprinting/republishing this material for advertising or promotional
purposes, creating new collective works, for resale or redistribution to servers or
lists, or reuse of any copyrighted component of this work in other works.
DOI: <a target="_blank" href="https://doi.org/10.1109/BigComp51126.2021.00039" title="" class="ltx_ref ltx_href">10.1109/BigComp51126.2021.00039</a></span></span>
</span></foreignObject></g></svg>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<figure id="S1.F1" class="ltx_figure"><img src="/html/2210.15850/assets/image/system_model.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="573" height="177" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">Federated Learning and Clustering based Model Training Process</span></figcaption>
</figure>
<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Electrical energy is an essential component for a single household to all industrial and manufacturing systems <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. To effectively utilize the available natural resources, power plants need to efficiently produce and distribute energy based on clients’ demand. Nowadays, smart home systems can monitor and log energy usage statistics from various sources across the house. This highly granular information can be valuable for energy companies to effectively manage the power production and distribution operations.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">During recent years, increasing computing capabilities and data explosion has led to a significant performance increase for data-driven predictor models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. Many existing studies on energy consumption modeling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> utilize data-driven methods, including deep neural networks (DNN), decision trees, support vector machines (SVM), and other machine learning methods. In these previous methods, data is centralized for training the data-driven model.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Predicting the future energy demand of a client based on a series of past energy usage data is a time series regression task. Recurrent neural networks (RNNs) are a type of neural network that can accept a series of values as the input to predict the output <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> and they are suitable for tackling time series predictive problems. In our system, the RNN model is chosen for predicting the future energy demand of a client given past energy usage data.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In a traditional neural network training pipeline, clients’ data are collected onto a central server where the model is trained. Transmitting data from the clients onto a server is expensive in terms of communication cost, and adapting the model to new usage patterns in the future would require constant re-transmission of newly obtained data. However, most of the existing works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> only consider the centralized training approach where data transmission is essential.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To overcome these challenges, we can apply federated learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> where clients can collaboratively train a deep neural network on their own local data without needing to centralize. However, training a neural network with federated learning usually suffers from the non-IID data problem <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, where clients contain data distributions that are diverse from each other. As a result, the global model created by aggregating different client model updates has a poor convergence rate and performance. Clustering clients with similar properties is a promising way to alleviated this problem. Model updates produced by the clients of the same cluster can be aggregated together to create a specific global model for that cluster. In this work, we integrated the clustered aggregation in the federated training process of our RNN model, by grouping different model updates based on available client attributes.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">System Model</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Our proposed energy demand predictor system is shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ I Introduction ‣ Federated Learning based Energy Demand Prediction with Clustered Aggregation This work was partially supported by Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government(MSIT) (No.2019-0-01287, Evolvable Deep Learning Model Generation Platform for Edge Computing) and by the National Research Foundation of Korea(NRF) grant funded by the Korea government(MSIT) (No. No. 2020R1A4A1018607). *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. We modeled the clients as smart homes capable of monitoring the energy usage across the household. The central server can be an electrical power company. The smart home system in each client is capable of training a neural network on its local data, but each individual client may have low amount of training data. Due to communication resource constraints, client households may also be unable to centralize their data or share among each other. To tackle these challenges, we trained our RNN model with the federated learning paradigm which allows clients to collaboratively train the model on their own local data without needing to share their data with a central entity.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">At the start of each federated training round, the central server or the power company clusters the participating client households based on the similarity of their housing attributes. After that, the server distributes a base global RNN model to all client households in each cluster. Each client individually trains the base RNN model on its own data. After training the model, each client sends its model updates back to the server. The central server aggregates the model updates from the clients of the same cluster together to create a global model for each cluster. Then, the cluster specific global models are distributed back to the clients in the respective clusters. This process is independently repeated for each cluster until the respective global model converges.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">A client can utilize the trained global model in its smart home system to predict the upcoming energy usage and effectively manage the energy consumption. When the electrical power company requires clients’ future energy demand, it can simply request the respective clients to make highly granular predictions on their local usage data without any need for data transmission.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Federated Model Training and Client Clustering</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.4" class="ltx_p">In a typical federated learning workflow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, the server distributes a base global model <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="S3.p1.1.m1.1a"><msub id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml">θ</mi><mi id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2">𝜃</ci><ci id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\theta_{t}</annotation></semantics></math> to the participating clients at the start of each training round <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">t</annotation></semantics></math>. Each client <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">i</annotation></semantics></math> trains the model on its local data <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="S3.p1.4.m4.1a"><msub id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml"><mi id="S3.p1.4.m4.1.1.2" xref="S3.p1.4.m4.1.1.2.cmml">D</mi><mi id="S3.p1.4.m4.1.1.3" xref="S3.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.1.cmml" xref="S3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.p1.4.m4.1.1.2.cmml" xref="S3.p1.4.m4.1.1.2">𝐷</ci><ci id="S3.p1.4.m4.1.1.3.cmml" xref="S3.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">D_{i}</annotation></semantics></math> using stochastic gradient descent to generate model updates.</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.5" class="ltx_Math" alttext="\Delta\theta_{i}^{t+1}=\textrm{SGD}(\theta^{t},D_{i})-\theta^{t},\;i=1,...,m" display="block"><semantics id="S3.E1.m1.5a"><mrow id="S3.E1.m1.5.5.2" xref="S3.E1.m1.5.5.3.cmml"><mrow id="S3.E1.m1.4.4.1.1" xref="S3.E1.m1.4.4.1.1.cmml"><mrow id="S3.E1.m1.4.4.1.1.4" xref="S3.E1.m1.4.4.1.1.4.cmml"><mi mathvariant="normal" id="S3.E1.m1.4.4.1.1.4.2" xref="S3.E1.m1.4.4.1.1.4.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.4.1" xref="S3.E1.m1.4.4.1.1.4.1.cmml">​</mo><msubsup id="S3.E1.m1.4.4.1.1.4.3" xref="S3.E1.m1.4.4.1.1.4.3.cmml"><mi id="S3.E1.m1.4.4.1.1.4.3.2.2" xref="S3.E1.m1.4.4.1.1.4.3.2.2.cmml">θ</mi><mi id="S3.E1.m1.4.4.1.1.4.3.2.3" xref="S3.E1.m1.4.4.1.1.4.3.2.3.cmml">i</mi><mrow id="S3.E1.m1.4.4.1.1.4.3.3" xref="S3.E1.m1.4.4.1.1.4.3.3.cmml"><mi id="S3.E1.m1.4.4.1.1.4.3.3.2" xref="S3.E1.m1.4.4.1.1.4.3.3.2.cmml">t</mi><mo id="S3.E1.m1.4.4.1.1.4.3.3.1" xref="S3.E1.m1.4.4.1.1.4.3.3.1.cmml">+</mo><mn id="S3.E1.m1.4.4.1.1.4.3.3.3" xref="S3.E1.m1.4.4.1.1.4.3.3.3.cmml">1</mn></mrow></msubsup></mrow><mo id="S3.E1.m1.4.4.1.1.3" xref="S3.E1.m1.4.4.1.1.3.cmml">=</mo><mrow id="S3.E1.m1.4.4.1.1.2" xref="S3.E1.m1.4.4.1.1.2.cmml"><mrow id="S3.E1.m1.4.4.1.1.2.2" xref="S3.E1.m1.4.4.1.1.2.2.cmml"><mtext id="S3.E1.m1.4.4.1.1.2.2.4" xref="S3.E1.m1.4.4.1.1.2.2.4a.cmml">SGD</mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.2.2.3" xref="S3.E1.m1.4.4.1.1.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.4.4.1.1.2.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.4.4.1.1.2.2.2.2.3" xref="S3.E1.m1.4.4.1.1.2.2.2.3.cmml">(</mo><msup id="S3.E1.m1.4.4.1.1.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="S3.E1.m1.4.4.1.1.2.2.2.2.4" xref="S3.E1.m1.4.4.1.1.2.2.2.3.cmml">,</mo><msub id="S3.E1.m1.4.4.1.1.2.2.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.cmml"><mi id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.cmml">D</mi><mi id="S3.E1.m1.4.4.1.1.2.2.2.2.2.3" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.4.4.1.1.2.2.2.2.5" xref="S3.E1.m1.4.4.1.1.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.4.1.1.2.3" xref="S3.E1.m1.4.4.1.1.2.3.cmml">−</mo><msup id="S3.E1.m1.4.4.1.1.2.4" xref="S3.E1.m1.4.4.1.1.2.4.cmml"><mi id="S3.E1.m1.4.4.1.1.2.4.2" xref="S3.E1.m1.4.4.1.1.2.4.2.cmml">θ</mi><mi id="S3.E1.m1.4.4.1.1.2.4.3" xref="S3.E1.m1.4.4.1.1.2.4.3.cmml">t</mi></msup></mrow></mrow><mo rspace="0.447em" id="S3.E1.m1.5.5.2.3" xref="S3.E1.m1.5.5.3a.cmml">,</mo><mrow id="S3.E1.m1.5.5.2.2" xref="S3.E1.m1.5.5.2.2.cmml"><mi id="S3.E1.m1.5.5.2.2.2" xref="S3.E1.m1.5.5.2.2.2.cmml">i</mi><mo id="S3.E1.m1.5.5.2.2.1" xref="S3.E1.m1.5.5.2.2.1.cmml">=</mo><mrow id="S3.E1.m1.5.5.2.2.3.2" xref="S3.E1.m1.5.5.2.2.3.1.cmml"><mn id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">1</mn><mo id="S3.E1.m1.5.5.2.2.3.2.1" xref="S3.E1.m1.5.5.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">…</mi><mo id="S3.E1.m1.5.5.2.2.3.2.2" xref="S3.E1.m1.5.5.2.2.3.1.cmml">,</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">m</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.5b"><apply id="S3.E1.m1.5.5.3.cmml" xref="S3.E1.m1.5.5.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.3a.cmml" xref="S3.E1.m1.5.5.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.4.4.1.1.cmml" xref="S3.E1.m1.4.4.1.1"><eq id="S3.E1.m1.4.4.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.3"></eq><apply id="S3.E1.m1.4.4.1.1.4.cmml" xref="S3.E1.m1.4.4.1.1.4"><times id="S3.E1.m1.4.4.1.1.4.1.cmml" xref="S3.E1.m1.4.4.1.1.4.1"></times><ci id="S3.E1.m1.4.4.1.1.4.2.cmml" xref="S3.E1.m1.4.4.1.1.4.2">Δ</ci><apply id="S3.E1.m1.4.4.1.1.4.3.cmml" xref="S3.E1.m1.4.4.1.1.4.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.4.3.1.cmml" xref="S3.E1.m1.4.4.1.1.4.3">superscript</csymbol><apply id="S3.E1.m1.4.4.1.1.4.3.2.cmml" xref="S3.E1.m1.4.4.1.1.4.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.4.3.2.1.cmml" xref="S3.E1.m1.4.4.1.1.4.3">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.4.3.2.2.cmml" xref="S3.E1.m1.4.4.1.1.4.3.2.2">𝜃</ci><ci id="S3.E1.m1.4.4.1.1.4.3.2.3.cmml" xref="S3.E1.m1.4.4.1.1.4.3.2.3">𝑖</ci></apply><apply id="S3.E1.m1.4.4.1.1.4.3.3.cmml" xref="S3.E1.m1.4.4.1.1.4.3.3"><plus id="S3.E1.m1.4.4.1.1.4.3.3.1.cmml" xref="S3.E1.m1.4.4.1.1.4.3.3.1"></plus><ci id="S3.E1.m1.4.4.1.1.4.3.3.2.cmml" xref="S3.E1.m1.4.4.1.1.4.3.3.2">𝑡</ci><cn type="integer" id="S3.E1.m1.4.4.1.1.4.3.3.3.cmml" xref="S3.E1.m1.4.4.1.1.4.3.3.3">1</cn></apply></apply></apply><apply id="S3.E1.m1.4.4.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.2"><minus id="S3.E1.m1.4.4.1.1.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.3"></minus><apply id="S3.E1.m1.4.4.1.1.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2"><times id="S3.E1.m1.4.4.1.1.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.3"></times><ci id="S3.E1.m1.4.4.1.1.2.2.4a.cmml" xref="S3.E1.m1.4.4.1.1.2.2.4"><mtext id="S3.E1.m1.4.4.1.1.2.2.4.cmml" xref="S3.E1.m1.4.4.1.1.2.2.4">SGD</mtext></ci><interval closure="open" id="S3.E1.m1.4.4.1.1.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2"><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E1.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2">𝐷</ci><ci id="S3.E1.m1.4.4.1.1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="S3.E1.m1.4.4.1.1.2.4.cmml" xref="S3.E1.m1.4.4.1.1.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.4.1.cmml" xref="S3.E1.m1.4.4.1.1.2.4">superscript</csymbol><ci id="S3.E1.m1.4.4.1.1.2.4.2.cmml" xref="S3.E1.m1.4.4.1.1.2.4.2">𝜃</ci><ci id="S3.E1.m1.4.4.1.1.2.4.3.cmml" xref="S3.E1.m1.4.4.1.1.2.4.3">𝑡</ci></apply></apply></apply><apply id="S3.E1.m1.5.5.2.2.cmml" xref="S3.E1.m1.5.5.2.2"><eq id="S3.E1.m1.5.5.2.2.1.cmml" xref="S3.E1.m1.5.5.2.2.1"></eq><ci id="S3.E1.m1.5.5.2.2.2.cmml" xref="S3.E1.m1.5.5.2.2.2">𝑖</ci><list id="S3.E1.m1.5.5.2.2.3.1.cmml" xref="S3.E1.m1.5.5.2.2.3.2"><cn type="integer" id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">1</cn><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">…</ci><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝑚</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.5c">\Delta\theta_{i}^{t+1}=\textrm{SGD}(\theta^{t},D_{i})-\theta^{t},\;i=1,...,m</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.5" class="ltx_p">Each client sends its model updates back to the server and the server aggregates the model updates by weighted averaging to produce the next global model.</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.2" class="ltx_Math" alttext="\theta^{t+1}=\theta^{t}+\sum_{i=1}^{m}\frac{|D_{i}|}{|D|}\Delta\theta_{i}^{t+1}" display="block"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.3" xref="S3.E2.m1.2.3.cmml"><msup id="S3.E2.m1.2.3.2" xref="S3.E2.m1.2.3.2.cmml"><mi id="S3.E2.m1.2.3.2.2" xref="S3.E2.m1.2.3.2.2.cmml">θ</mi><mrow id="S3.E2.m1.2.3.2.3" xref="S3.E2.m1.2.3.2.3.cmml"><mi id="S3.E2.m1.2.3.2.3.2" xref="S3.E2.m1.2.3.2.3.2.cmml">t</mi><mo id="S3.E2.m1.2.3.2.3.1" xref="S3.E2.m1.2.3.2.3.1.cmml">+</mo><mn id="S3.E2.m1.2.3.2.3.3" xref="S3.E2.m1.2.3.2.3.3.cmml">1</mn></mrow></msup><mo id="S3.E2.m1.2.3.1" xref="S3.E2.m1.2.3.1.cmml">=</mo><mrow id="S3.E2.m1.2.3.3" xref="S3.E2.m1.2.3.3.cmml"><msup id="S3.E2.m1.2.3.3.2" xref="S3.E2.m1.2.3.3.2.cmml"><mi id="S3.E2.m1.2.3.3.2.2" xref="S3.E2.m1.2.3.3.2.2.cmml">θ</mi><mi id="S3.E2.m1.2.3.3.2.3" xref="S3.E2.m1.2.3.3.2.3.cmml">t</mi></msup><mo rspace="0.055em" id="S3.E2.m1.2.3.3.1" xref="S3.E2.m1.2.3.3.1.cmml">+</mo><mrow id="S3.E2.m1.2.3.3.3" xref="S3.E2.m1.2.3.3.3.cmml"><munderover id="S3.E2.m1.2.3.3.3.1" xref="S3.E2.m1.2.3.3.3.1.cmml"><mo movablelimits="false" id="S3.E2.m1.2.3.3.3.1.2.2" xref="S3.E2.m1.2.3.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.2.3.3.3.1.2.3" xref="S3.E2.m1.2.3.3.3.1.2.3.cmml"><mi id="S3.E2.m1.2.3.3.3.1.2.3.2" xref="S3.E2.m1.2.3.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E2.m1.2.3.3.3.1.2.3.1" xref="S3.E2.m1.2.3.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E2.m1.2.3.3.3.1.2.3.3" xref="S3.E2.m1.2.3.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.2.3.3.3.1.3" xref="S3.E2.m1.2.3.3.3.1.3.cmml">m</mi></munderover><mrow id="S3.E2.m1.2.3.3.3.2" xref="S3.E2.m1.2.3.3.3.2.cmml"><mfrac id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.1.cmml">|</mo><msub id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml">D</mi><mi id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.2.2.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.3.1" xref="S3.E2.m1.2.2.2.2.1.cmml">|</mo><mi id="S3.E2.m1.2.2.2.1" xref="S3.E2.m1.2.2.2.1.cmml">D</mi><mo stretchy="false" id="S3.E2.m1.2.2.2.3.2" xref="S3.E2.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.3.3.3.2.1" xref="S3.E2.m1.2.3.3.3.2.1.cmml">​</mo><mi mathvariant="normal" id="S3.E2.m1.2.3.3.3.2.2" xref="S3.E2.m1.2.3.3.3.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.3.3.3.2.1a" xref="S3.E2.m1.2.3.3.3.2.1.cmml">​</mo><msubsup id="S3.E2.m1.2.3.3.3.2.3" xref="S3.E2.m1.2.3.3.3.2.3.cmml"><mi id="S3.E2.m1.2.3.3.3.2.3.2.2" xref="S3.E2.m1.2.3.3.3.2.3.2.2.cmml">θ</mi><mi id="S3.E2.m1.2.3.3.3.2.3.2.3" xref="S3.E2.m1.2.3.3.3.2.3.2.3.cmml">i</mi><mrow id="S3.E2.m1.2.3.3.3.2.3.3" xref="S3.E2.m1.2.3.3.3.2.3.3.cmml"><mi id="S3.E2.m1.2.3.3.3.2.3.3.2" xref="S3.E2.m1.2.3.3.3.2.3.3.2.cmml">t</mi><mo id="S3.E2.m1.2.3.3.3.2.3.3.1" xref="S3.E2.m1.2.3.3.3.2.3.3.1.cmml">+</mo><mn id="S3.E2.m1.2.3.3.3.2.3.3.3" xref="S3.E2.m1.2.3.3.3.2.3.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.3.cmml" xref="S3.E2.m1.2.3"><eq id="S3.E2.m1.2.3.1.cmml" xref="S3.E2.m1.2.3.1"></eq><apply id="S3.E2.m1.2.3.2.cmml" xref="S3.E2.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.2.1.cmml" xref="S3.E2.m1.2.3.2">superscript</csymbol><ci id="S3.E2.m1.2.3.2.2.cmml" xref="S3.E2.m1.2.3.2.2">𝜃</ci><apply id="S3.E2.m1.2.3.2.3.cmml" xref="S3.E2.m1.2.3.2.3"><plus id="S3.E2.m1.2.3.2.3.1.cmml" xref="S3.E2.m1.2.3.2.3.1"></plus><ci id="S3.E2.m1.2.3.2.3.2.cmml" xref="S3.E2.m1.2.3.2.3.2">𝑡</ci><cn type="integer" id="S3.E2.m1.2.3.2.3.3.cmml" xref="S3.E2.m1.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.2.3.3.cmml" xref="S3.E2.m1.2.3.3"><plus id="S3.E2.m1.2.3.3.1.cmml" xref="S3.E2.m1.2.3.3.1"></plus><apply id="S3.E2.m1.2.3.3.2.cmml" xref="S3.E2.m1.2.3.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.2.1.cmml" xref="S3.E2.m1.2.3.3.2">superscript</csymbol><ci id="S3.E2.m1.2.3.3.2.2.cmml" xref="S3.E2.m1.2.3.3.2.2">𝜃</ci><ci id="S3.E2.m1.2.3.3.2.3.cmml" xref="S3.E2.m1.2.3.3.2.3">𝑡</ci></apply><apply id="S3.E2.m1.2.3.3.3.cmml" xref="S3.E2.m1.2.3.3.3"><apply id="S3.E2.m1.2.3.3.3.1.cmml" xref="S3.E2.m1.2.3.3.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.3.1.1.cmml" xref="S3.E2.m1.2.3.3.3.1">superscript</csymbol><apply id="S3.E2.m1.2.3.3.3.1.2.cmml" xref="S3.E2.m1.2.3.3.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.3.1.2.1.cmml" xref="S3.E2.m1.2.3.3.3.1">subscript</csymbol><sum id="S3.E2.m1.2.3.3.3.1.2.2.cmml" xref="S3.E2.m1.2.3.3.3.1.2.2"></sum><apply id="S3.E2.m1.2.3.3.3.1.2.3.cmml" xref="S3.E2.m1.2.3.3.3.1.2.3"><eq id="S3.E2.m1.2.3.3.3.1.2.3.1.cmml" xref="S3.E2.m1.2.3.3.3.1.2.3.1"></eq><ci id="S3.E2.m1.2.3.3.3.1.2.3.2.cmml" xref="S3.E2.m1.2.3.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E2.m1.2.3.3.3.1.2.3.3.cmml" xref="S3.E2.m1.2.3.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.2.3.3.3.1.3.cmml" xref="S3.E2.m1.2.3.3.3.1.3">𝑚</ci></apply><apply id="S3.E2.m1.2.3.3.3.2.cmml" xref="S3.E2.m1.2.3.3.3.2"><times id="S3.E2.m1.2.3.3.3.2.1.cmml" xref="S3.E2.m1.2.3.3.3.2.1"></times><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><divide id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2"></divide><apply id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1"><abs id="S3.E2.m1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2"></abs><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2">𝐷</ci><ci id="S3.E2.m1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.3"><abs id="S3.E2.m1.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.3.1"></abs><ci id="S3.E2.m1.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.1">𝐷</ci></apply></apply><ci id="S3.E2.m1.2.3.3.3.2.2.cmml" xref="S3.E2.m1.2.3.3.3.2.2">Δ</ci><apply id="S3.E2.m1.2.3.3.3.2.3.cmml" xref="S3.E2.m1.2.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.3.2.3.1.cmml" xref="S3.E2.m1.2.3.3.3.2.3">superscript</csymbol><apply id="S3.E2.m1.2.3.3.3.2.3.2.cmml" xref="S3.E2.m1.2.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.3.2.3.2.1.cmml" xref="S3.E2.m1.2.3.3.3.2.3">subscript</csymbol><ci id="S3.E2.m1.2.3.3.3.2.3.2.2.cmml" xref="S3.E2.m1.2.3.3.3.2.3.2.2">𝜃</ci><ci id="S3.E2.m1.2.3.3.3.2.3.2.3.cmml" xref="S3.E2.m1.2.3.3.3.2.3.2.3">𝑖</ci></apply><apply id="S3.E2.m1.2.3.3.3.2.3.3.cmml" xref="S3.E2.m1.2.3.3.3.2.3.3"><plus id="S3.E2.m1.2.3.3.3.2.3.3.1.cmml" xref="S3.E2.m1.2.3.3.3.2.3.3.1"></plus><ci id="S3.E2.m1.2.3.3.3.2.3.3.2.cmml" xref="S3.E2.m1.2.3.3.3.2.3.3.2">𝑡</ci><cn type="integer" id="S3.E2.m1.2.3.3.3.2.3.3.3.cmml" xref="S3.E2.m1.2.3.3.3.2.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">\theta^{t+1}=\theta^{t}+\sum_{i=1}^{m}\frac{|D_{i}|}{|D|}\Delta\theta_{i}^{t+1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.6" class="ltx_p">Then, the global model is distributed back to the clients. Although the central server does not directly take part in the training process, it is responsible for monitoring and orchestrating the federated training and model aggregation process.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.9" class="ltx_p">To increase the global model convergence rate, we used <span id="S3.p2.9.1" class="ltx_text">OPTICS</span> (Ordering points to identify the clustering structure) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> algorithm to cluster the clients with similar attributes. For each cluster, a global model is produced by aggregating the model updates from the cluster members. OPTICS is an unsupervised clustering algorithm with <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S3.p2.1.m1.1a"><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\epsilon</annotation></semantics></math> and <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="MinPts" display="inline"><semantics id="S3.p2.2.m2.1a"><mrow id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.p2.2.m2.1.1.1" xref="S3.p2.2.m2.1.1.1.cmml">​</mo><mi id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.p2.2.m2.1.1.1a" xref="S3.p2.2.m2.1.1.1.cmml">​</mo><mi id="S3.p2.2.m2.1.1.4" xref="S3.p2.2.m2.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.p2.2.m2.1.1.1b" xref="S3.p2.2.m2.1.1.1.cmml">​</mo><mi id="S3.p2.2.m2.1.1.5" xref="S3.p2.2.m2.1.1.5.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.p2.2.m2.1.1.1c" xref="S3.p2.2.m2.1.1.1.cmml">​</mo><mi id="S3.p2.2.m2.1.1.6" xref="S3.p2.2.m2.1.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.p2.2.m2.1.1.1d" xref="S3.p2.2.m2.1.1.1.cmml">​</mo><mi id="S3.p2.2.m2.1.1.7" xref="S3.p2.2.m2.1.1.7.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><times id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1.1"></times><ci id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2">𝑀</ci><ci id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3">𝑖</ci><ci id="S3.p2.2.m2.1.1.4.cmml" xref="S3.p2.2.m2.1.1.4">𝑛</ci><ci id="S3.p2.2.m2.1.1.5.cmml" xref="S3.p2.2.m2.1.1.5">𝑃</ci><ci id="S3.p2.2.m2.1.1.6.cmml" xref="S3.p2.2.m2.1.1.6">𝑡</ci><ci id="S3.p2.2.m2.1.1.7.cmml" xref="S3.p2.2.m2.1.1.7">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">MinPts</annotation></semantics></math> parameters. <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S3.p2.3.m3.1a"><mi id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><ci id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">\epsilon</annotation></semantics></math> is the distance (radius) around a point to consider for clustering. <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="MinPts" display="inline"><semantics id="S3.p2.4.m4.1a"><mrow id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml"><mi id="S3.p2.4.m4.1.1.2" xref="S3.p2.4.m4.1.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.p2.4.m4.1.1.1" xref="S3.p2.4.m4.1.1.1.cmml">​</mo><mi id="S3.p2.4.m4.1.1.3" xref="S3.p2.4.m4.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.p2.4.m4.1.1.1a" xref="S3.p2.4.m4.1.1.1.cmml">​</mo><mi id="S3.p2.4.m4.1.1.4" xref="S3.p2.4.m4.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.p2.4.m4.1.1.1b" xref="S3.p2.4.m4.1.1.1.cmml">​</mo><mi id="S3.p2.4.m4.1.1.5" xref="S3.p2.4.m4.1.1.5.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.p2.4.m4.1.1.1c" xref="S3.p2.4.m4.1.1.1.cmml">​</mo><mi id="S3.p2.4.m4.1.1.6" xref="S3.p2.4.m4.1.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.p2.4.m4.1.1.1d" xref="S3.p2.4.m4.1.1.1.cmml">​</mo><mi id="S3.p2.4.m4.1.1.7" xref="S3.p2.4.m4.1.1.7.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><apply id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1"><times id="S3.p2.4.m4.1.1.1.cmml" xref="S3.p2.4.m4.1.1.1"></times><ci id="S3.p2.4.m4.1.1.2.cmml" xref="S3.p2.4.m4.1.1.2">𝑀</ci><ci id="S3.p2.4.m4.1.1.3.cmml" xref="S3.p2.4.m4.1.1.3">𝑖</ci><ci id="S3.p2.4.m4.1.1.4.cmml" xref="S3.p2.4.m4.1.1.4">𝑛</ci><ci id="S3.p2.4.m4.1.1.5.cmml" xref="S3.p2.4.m4.1.1.5">𝑃</ci><ci id="S3.p2.4.m4.1.1.6.cmml" xref="S3.p2.4.m4.1.1.6">𝑡</ci><ci id="S3.p2.4.m4.1.1.7.cmml" xref="S3.p2.4.m4.1.1.7">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">MinPts</annotation></semantics></math> defines the minimum number of required points to form a cluster. If there are at least <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="MinPts" display="inline"><semantics id="S3.p2.5.m5.1a"><mrow id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml"><mi id="S3.p2.5.m5.1.1.2" xref="S3.p2.5.m5.1.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.p2.5.m5.1.1.1" xref="S3.p2.5.m5.1.1.1.cmml">​</mo><mi id="S3.p2.5.m5.1.1.3" xref="S3.p2.5.m5.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.p2.5.m5.1.1.1a" xref="S3.p2.5.m5.1.1.1.cmml">​</mo><mi id="S3.p2.5.m5.1.1.4" xref="S3.p2.5.m5.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.p2.5.m5.1.1.1b" xref="S3.p2.5.m5.1.1.1.cmml">​</mo><mi id="S3.p2.5.m5.1.1.5" xref="S3.p2.5.m5.1.1.5.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.p2.5.m5.1.1.1c" xref="S3.p2.5.m5.1.1.1.cmml">​</mo><mi id="S3.p2.5.m5.1.1.6" xref="S3.p2.5.m5.1.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.p2.5.m5.1.1.1d" xref="S3.p2.5.m5.1.1.1.cmml">​</mo><mi id="S3.p2.5.m5.1.1.7" xref="S3.p2.5.m5.1.1.7.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><apply id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1"><times id="S3.p2.5.m5.1.1.1.cmml" xref="S3.p2.5.m5.1.1.1"></times><ci id="S3.p2.5.m5.1.1.2.cmml" xref="S3.p2.5.m5.1.1.2">𝑀</ci><ci id="S3.p2.5.m5.1.1.3.cmml" xref="S3.p2.5.m5.1.1.3">𝑖</ci><ci id="S3.p2.5.m5.1.1.4.cmml" xref="S3.p2.5.m5.1.1.4">𝑛</ci><ci id="S3.p2.5.m5.1.1.5.cmml" xref="S3.p2.5.m5.1.1.5">𝑃</ci><ci id="S3.p2.5.m5.1.1.6.cmml" xref="S3.p2.5.m5.1.1.6">𝑡</ci><ci id="S3.p2.5.m5.1.1.7.cmml" xref="S3.p2.5.m5.1.1.7">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">MinPts</annotation></semantics></math> points in <math id="S3.p2.6.m6.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S3.p2.6.m6.1a"><mi id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><ci id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">\epsilon</annotation></semantics></math> radius neighborhood <math id="S3.p2.7.m7.1" class="ltx_Math" alttext="N_{\epsilon}" display="inline"><semantics id="S3.p2.7.m7.1a"><msub id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml"><mi id="S3.p2.7.m7.1.1.2" xref="S3.p2.7.m7.1.1.2.cmml">N</mi><mi id="S3.p2.7.m7.1.1.3" xref="S3.p2.7.m7.1.1.3.cmml">ϵ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><apply id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p2.7.m7.1.1.1.cmml" xref="S3.p2.7.m7.1.1">subscript</csymbol><ci id="S3.p2.7.m7.1.1.2.cmml" xref="S3.p2.7.m7.1.1.2">𝑁</ci><ci id="S3.p2.7.m7.1.1.3.cmml" xref="S3.p2.7.m7.1.1.3">italic-ϵ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">N_{\epsilon}</annotation></semantics></math> of a point <math id="S3.p2.8.m8.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.p2.8.m8.1a"><mi id="S3.p2.8.m8.1.1" xref="S3.p2.8.m8.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.p2.8.m8.1b"><ci id="S3.p2.8.m8.1.1.cmml" xref="S3.p2.8.m8.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m8.1c">p</annotation></semantics></math>, then <math id="S3.p2.9.m9.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.p2.9.m9.1a"><mi id="S3.p2.9.m9.1.1" xref="S3.p2.9.m9.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.p2.9.m9.1b"><ci id="S3.p2.9.m9.1.1.cmml" xref="S3.p2.9.m9.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m9.1c">p</annotation></semantics></math> is a core point.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.1" class="ltx_p">Algorithm <a href="#alg1" title="Algorithm 1 ‣ III Federated Model Training and Client Clustering ‣ Federated Learning based Energy Demand Prediction with Clustered Aggregation This work was partially supported by Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government(MSIT) (No.2019-0-01287, Evolvable Deep Learning Model Generation Platform for Edge Computing) and by the National Research Foundation of Korea(NRF) grant funded by the Korea government(MSIT) (No. No. 2020R1A4A1018607). *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the details of out proposed method.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Federated training with clustered aggregation</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg1.l1.2" class="ltx_text ltx_font_bold">Input:</span> Attribute data from each of <math id="alg1.l1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">m</annotation></semantics></math> clients.

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  Based on attributes, server groups clients into <math id="alg1.l2.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg1.l2.m1.1a"><mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">n</annotation></semantics></math> clusters.

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>  Server randomly initializes a base model <math id="alg1.l3.m1.1" class="ltx_Math" alttext="w_{rand}" display="inline"><semantics id="alg1.l3.m1.1a"><msub id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">w</mi><mrow id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"><mi id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.3.1" xref="alg1.l3.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.3.3" xref="alg1.l3.m1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.3.1a" xref="alg1.l3.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.3.4" xref="alg1.l3.m1.1.1.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.3.1b" xref="alg1.l3.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.3.5" xref="alg1.l3.m1.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑤</ci><apply id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"><times id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3.1"></times><ci id="alg1.l3.m1.1.1.3.2.cmml" xref="alg1.l3.m1.1.1.3.2">𝑟</ci><ci id="alg1.l3.m1.1.1.3.3.cmml" xref="alg1.l3.m1.1.1.3.3">𝑎</ci><ci id="alg1.l3.m1.1.1.3.4.cmml" xref="alg1.l3.m1.1.1.3.4">𝑛</ci><ci id="alg1.l3.m1.1.1.3.5.cmml" xref="alg1.l3.m1.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">w_{rand}</annotation></semantics></math>.

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>  <span id="alg1.l4.2" class="ltx_text ltx_font_bold">for</span> each cluster <math id="alg1.l4.m1.1" class="ltx_Math" alttext="C^{k}" display="inline"><semantics id="alg1.l4.m1.1a"><msup id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">C</mi><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1">superscript</csymbol><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝐶</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">C^{k}</annotation></semantics></math> with <math id="alg1.l4.m2.4" class="ltx_Math" alttext="k=1,2,...,N" display="inline"><semantics id="alg1.l4.m2.4a"><mrow id="alg1.l4.m2.4.5" xref="alg1.l4.m2.4.5.cmml"><mi id="alg1.l4.m2.4.5.2" xref="alg1.l4.m2.4.5.2.cmml">k</mi><mo id="alg1.l4.m2.4.5.1" xref="alg1.l4.m2.4.5.1.cmml">=</mo><mrow id="alg1.l4.m2.4.5.3.2" xref="alg1.l4.m2.4.5.3.1.cmml"><mn id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml">1</mn><mo id="alg1.l4.m2.4.5.3.2.1" xref="alg1.l4.m2.4.5.3.1.cmml">,</mo><mn id="alg1.l4.m2.2.2" xref="alg1.l4.m2.2.2.cmml">2</mn><mo id="alg1.l4.m2.4.5.3.2.2" xref="alg1.l4.m2.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l4.m2.3.3" xref="alg1.l4.m2.3.3.cmml">…</mi><mo id="alg1.l4.m2.4.5.3.2.3" xref="alg1.l4.m2.4.5.3.1.cmml">,</mo><mi id="alg1.l4.m2.4.4" xref="alg1.l4.m2.4.4.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.4b"><apply id="alg1.l4.m2.4.5.cmml" xref="alg1.l4.m2.4.5"><eq id="alg1.l4.m2.4.5.1.cmml" xref="alg1.l4.m2.4.5.1"></eq><ci id="alg1.l4.m2.4.5.2.cmml" xref="alg1.l4.m2.4.5.2">𝑘</ci><list id="alg1.l4.m2.4.5.3.1.cmml" xref="alg1.l4.m2.4.5.3.2"><cn type="integer" id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1">1</cn><cn type="integer" id="alg1.l4.m2.2.2.cmml" xref="alg1.l4.m2.2.2">2</cn><ci id="alg1.l4.m2.3.3.cmml" xref="alg1.l4.m2.3.3">…</ci><ci id="alg1.l4.m2.4.4.cmml" xref="alg1.l4.m2.4.4">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.4c">k=1,2,...,N</annotation></semantics></math>, <span id="alg1.l4.3" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg1.l4.4" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     Initialize cluster specific model weights, <math id="alg1.l5.m1.1" class="ltx_Math" alttext="w_{k}\leftarrow w_{rand}" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><msub id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">←</mo><msub id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"><mi id="alg1.l5.m1.1.1.3.2" xref="alg1.l5.m1.1.1.3.2.cmml">w</mi><mrow id="alg1.l5.m1.1.1.3.3" xref="alg1.l5.m1.1.1.3.3.cmml"><mi id="alg1.l5.m1.1.1.3.3.2" xref="alg1.l5.m1.1.1.3.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.1.1.3.3.1" xref="alg1.l5.m1.1.1.3.3.1.cmml">​</mo><mi id="alg1.l5.m1.1.1.3.3.3" xref="alg1.l5.m1.1.1.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.1.1.3.3.1a" xref="alg1.l5.m1.1.1.3.3.1.cmml">​</mo><mi id="alg1.l5.m1.1.1.3.3.4" xref="alg1.l5.m1.1.1.3.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.1.1.3.3.1b" xref="alg1.l5.m1.1.1.3.3.1.cmml">​</mo><mi id="alg1.l5.m1.1.1.3.3.5" xref="alg1.l5.m1.1.1.3.3.5.cmml">d</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><ci id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">←</ci><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">𝑤</ci><ci id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3">subscript</csymbol><ci id="alg1.l5.m1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.3.2">𝑤</ci><apply id="alg1.l5.m1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.3.3"><times id="alg1.l5.m1.1.1.3.3.1.cmml" xref="alg1.l5.m1.1.1.3.3.1"></times><ci id="alg1.l5.m1.1.1.3.3.2.cmml" xref="alg1.l5.m1.1.1.3.3.2">𝑟</ci><ci id="alg1.l5.m1.1.1.3.3.3.cmml" xref="alg1.l5.m1.1.1.3.3.3">𝑎</ci><ci id="alg1.l5.m1.1.1.3.3.4.cmml" xref="alg1.l5.m1.1.1.3.3.4">𝑛</ci><ci id="alg1.l5.m1.1.1.3.3.5.cmml" xref="alg1.l5.m1.1.1.3.3.5">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">w_{k}\leftarrow w_{rand}</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>  <span id="alg1.l6.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l6.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>  <span id="alg1.l7.2" class="ltx_text ltx_font_bold">for</span> each cluster <math id="alg1.l7.m1.1" class="ltx_Math" alttext="C^{k}" display="inline"><semantics id="alg1.l7.m1.1a"><msup id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">C</mi><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1">superscript</csymbol><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝐶</ci><ci id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">C^{k}</annotation></semantics></math> with <math id="alg1.l7.m2.4" class="ltx_Math" alttext="k=1,2,...,N" display="inline"><semantics id="alg1.l7.m2.4a"><mrow id="alg1.l7.m2.4.5" xref="alg1.l7.m2.4.5.cmml"><mi id="alg1.l7.m2.4.5.2" xref="alg1.l7.m2.4.5.2.cmml">k</mi><mo id="alg1.l7.m2.4.5.1" xref="alg1.l7.m2.4.5.1.cmml">=</mo><mrow id="alg1.l7.m2.4.5.3.2" xref="alg1.l7.m2.4.5.3.1.cmml"><mn id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">1</mn><mo id="alg1.l7.m2.4.5.3.2.1" xref="alg1.l7.m2.4.5.3.1.cmml">,</mo><mn id="alg1.l7.m2.2.2" xref="alg1.l7.m2.2.2.cmml">2</mn><mo id="alg1.l7.m2.4.5.3.2.2" xref="alg1.l7.m2.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l7.m2.3.3" xref="alg1.l7.m2.3.3.cmml">…</mi><mo id="alg1.l7.m2.4.5.3.2.3" xref="alg1.l7.m2.4.5.3.1.cmml">,</mo><mi id="alg1.l7.m2.4.4" xref="alg1.l7.m2.4.4.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.4b"><apply id="alg1.l7.m2.4.5.cmml" xref="alg1.l7.m2.4.5"><eq id="alg1.l7.m2.4.5.1.cmml" xref="alg1.l7.m2.4.5.1"></eq><ci id="alg1.l7.m2.4.5.2.cmml" xref="alg1.l7.m2.4.5.2">𝑘</ci><list id="alg1.l7.m2.4.5.3.1.cmml" xref="alg1.l7.m2.4.5.3.2"><cn type="integer" id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">1</cn><cn type="integer" id="alg1.l7.m2.2.2.cmml" xref="alg1.l7.m2.2.2">2</cn><ci id="alg1.l7.m2.3.3.cmml" xref="alg1.l7.m2.3.3">…</ci><ci id="alg1.l7.m2.4.4.cmml" xref="alg1.l7.m2.4.4">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.4c">k=1,2,...,N</annotation></semantics></math>, <span id="alg1.l7.3" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg1.l7.4" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     <span id="alg1.l8.2" class="ltx_text ltx_font_bold">for</span> communication round <math id="alg1.l8.m1.3" class="ltx_math_unparsed" alttext="t=1,2,....,T" display="inline"><semantics id="alg1.l8.m1.3a"><mrow id="alg1.l8.m1.3b"><mi id="alg1.l8.m1.3.4">t</mi><mo id="alg1.l8.m1.3.5">=</mo><mn id="alg1.l8.m1.1.1">1</mn><mo id="alg1.l8.m1.3.6">,</mo><mn id="alg1.l8.m1.2.2">2</mn><mo id="alg1.l8.m1.3.7">,</mo><mi mathvariant="normal" id="alg1.l8.m1.3.3">…</mi><mo lspace="0em" rspace="0.167em" id="alg1.l8.m1.3.8">.</mo><mo id="alg1.l8.m1.3.9">,</mo><mi id="alg1.l8.m1.3.10">T</mi></mrow><annotation encoding="application/x-tex" id="alg1.l8.m1.3c">t=1,2,....,T</annotation></semantics></math> <span id="alg1.l8.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>        <span id="alg1.l9.2" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l9.m1.1" class="ltx_Math" alttext="c^{i}" display="inline"><semantics id="alg1.l9.m1.1a"><msup id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">c</mi><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1">superscript</csymbol><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝑐</ci><ci id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">c^{i}</annotation></semantics></math> in cluster <math id="alg1.l9.m2.1" class="ltx_Math" alttext="C^{k}" display="inline"><semantics id="alg1.l9.m2.1a"><msup id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><mi id="alg1.l9.m2.1.1.2" xref="alg1.l9.m2.1.1.2.cmml">C</mi><mi id="alg1.l9.m2.1.1.3" xref="alg1.l9.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1">superscript</csymbol><ci id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1.2">𝐶</ci><ci id="alg1.l9.m2.1.1.3.cmml" xref="alg1.l9.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">C^{k}</annotation></semantics></math>, <math id="alg1.l9.m3.4" class="ltx_Math" alttext="i=1,2,...,L" display="inline"><semantics id="alg1.l9.m3.4a"><mrow id="alg1.l9.m3.4.5" xref="alg1.l9.m3.4.5.cmml"><mi id="alg1.l9.m3.4.5.2" xref="alg1.l9.m3.4.5.2.cmml">i</mi><mo id="alg1.l9.m3.4.5.1" xref="alg1.l9.m3.4.5.1.cmml">=</mo><mrow id="alg1.l9.m3.4.5.3.2" xref="alg1.l9.m3.4.5.3.1.cmml"><mn id="alg1.l9.m3.1.1" xref="alg1.l9.m3.1.1.cmml">1</mn><mo id="alg1.l9.m3.4.5.3.2.1" xref="alg1.l9.m3.4.5.3.1.cmml">,</mo><mn id="alg1.l9.m3.2.2" xref="alg1.l9.m3.2.2.cmml">2</mn><mo id="alg1.l9.m3.4.5.3.2.2" xref="alg1.l9.m3.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l9.m3.3.3" xref="alg1.l9.m3.3.3.cmml">…</mi><mo id="alg1.l9.m3.4.5.3.2.3" xref="alg1.l9.m3.4.5.3.1.cmml">,</mo><mi id="alg1.l9.m3.4.4" xref="alg1.l9.m3.4.4.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m3.4b"><apply id="alg1.l9.m3.4.5.cmml" xref="alg1.l9.m3.4.5"><eq id="alg1.l9.m3.4.5.1.cmml" xref="alg1.l9.m3.4.5.1"></eq><ci id="alg1.l9.m3.4.5.2.cmml" xref="alg1.l9.m3.4.5.2">𝑖</ci><list id="alg1.l9.m3.4.5.3.1.cmml" xref="alg1.l9.m3.4.5.3.2"><cn type="integer" id="alg1.l9.m3.1.1.cmml" xref="alg1.l9.m3.1.1">1</cn><cn type="integer" id="alg1.l9.m3.2.2.cmml" xref="alg1.l9.m3.2.2">2</cn><ci id="alg1.l9.m3.3.3.cmml" xref="alg1.l9.m3.3.3">…</ci><ci id="alg1.l9.m3.4.4.cmml" xref="alg1.l9.m3.4.4">𝐿</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m3.4c">i=1,2,...,L</annotation></semantics></math> <span id="alg1.l9.3" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg1.l9.4" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>           Synchronize local model with latest cluster specific model: <math id="alg1.l10.m1.1" class="ltx_Math" alttext="w_{k}^{i}\leftarrow w_{k}" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><msubsup id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml"><mi id="alg1.l10.m1.1.1.2.2.2" xref="alg1.l10.m1.1.1.2.2.2.cmml">w</mi><mi id="alg1.l10.m1.1.1.2.2.3" xref="alg1.l10.m1.1.1.2.2.3.cmml">k</mi><mi id="alg1.l10.m1.1.1.2.3" xref="alg1.l10.m1.1.1.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">←</mo><msub id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml">w</mi><mi id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><ci id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1">←</ci><apply id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.2">superscript</csymbol><apply id="alg1.l10.m1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.2.2.1.cmml" xref="alg1.l10.m1.1.1.2">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.2.2.cmml" xref="alg1.l10.m1.1.1.2.2.2">𝑤</ci><ci id="alg1.l10.m1.1.1.2.2.3.cmml" xref="alg1.l10.m1.1.1.2.2.3">𝑘</ci></apply><ci id="alg1.l10.m1.1.1.2.3.cmml" xref="alg1.l10.m1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3">subscript</csymbol><ci id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2">𝑤</ci><ci id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">w_{k}^{i}\leftarrow w_{k}</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>           Update local model <math id="alg1.l11.m1.1" class="ltx_Math" alttext="w_{k}^{i}" display="inline"><semantics id="alg1.l11.m1.1a"><msubsup id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2.2" xref="alg1.l11.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l11.m1.1.1.2.3" xref="alg1.l11.m1.1.1.2.3.cmml">k</mi><mi id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1">superscript</csymbol><apply id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.2.1.cmml" xref="alg1.l11.m1.1.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.2.2.cmml" xref="alg1.l11.m1.1.1.2.2">𝑤</ci><ci id="alg1.l11.m1.1.1.2.3.cmml" xref="alg1.l11.m1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">w_{k}^{i}</annotation></semantics></math> by training on local data, <math id="alg1.l11.m2.2" class="ltx_Math" alttext="D^{i}=\left\{X^{i},Y^{i}\right\}" display="inline"><semantics id="alg1.l11.m2.2a"><mrow id="alg1.l11.m2.2.2" xref="alg1.l11.m2.2.2.cmml"><msup id="alg1.l11.m2.2.2.4" xref="alg1.l11.m2.2.2.4.cmml"><mi id="alg1.l11.m2.2.2.4.2" xref="alg1.l11.m2.2.2.4.2.cmml">D</mi><mi id="alg1.l11.m2.2.2.4.3" xref="alg1.l11.m2.2.2.4.3.cmml">i</mi></msup><mo id="alg1.l11.m2.2.2.3" xref="alg1.l11.m2.2.2.3.cmml">=</mo><mrow id="alg1.l11.m2.2.2.2.2" xref="alg1.l11.m2.2.2.2.3.cmml"><mo id="alg1.l11.m2.2.2.2.2.3" xref="alg1.l11.m2.2.2.2.3.cmml">{</mo><msup id="alg1.l11.m2.1.1.1.1.1" xref="alg1.l11.m2.1.1.1.1.1.cmml"><mi id="alg1.l11.m2.1.1.1.1.1.2" xref="alg1.l11.m2.1.1.1.1.1.2.cmml">X</mi><mi id="alg1.l11.m2.1.1.1.1.1.3" xref="alg1.l11.m2.1.1.1.1.1.3.cmml">i</mi></msup><mo id="alg1.l11.m2.2.2.2.2.4" xref="alg1.l11.m2.2.2.2.3.cmml">,</mo><msup id="alg1.l11.m2.2.2.2.2.2" xref="alg1.l11.m2.2.2.2.2.2.cmml"><mi id="alg1.l11.m2.2.2.2.2.2.2" xref="alg1.l11.m2.2.2.2.2.2.2.cmml">Y</mi><mi id="alg1.l11.m2.2.2.2.2.2.3" xref="alg1.l11.m2.2.2.2.2.2.3.cmml">i</mi></msup><mo id="alg1.l11.m2.2.2.2.2.5" xref="alg1.l11.m2.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.2b"><apply id="alg1.l11.m2.2.2.cmml" xref="alg1.l11.m2.2.2"><eq id="alg1.l11.m2.2.2.3.cmml" xref="alg1.l11.m2.2.2.3"></eq><apply id="alg1.l11.m2.2.2.4.cmml" xref="alg1.l11.m2.2.2.4"><csymbol cd="ambiguous" id="alg1.l11.m2.2.2.4.1.cmml" xref="alg1.l11.m2.2.2.4">superscript</csymbol><ci id="alg1.l11.m2.2.2.4.2.cmml" xref="alg1.l11.m2.2.2.4.2">𝐷</ci><ci id="alg1.l11.m2.2.2.4.3.cmml" xref="alg1.l11.m2.2.2.4.3">𝑖</ci></apply><set id="alg1.l11.m2.2.2.2.3.cmml" xref="alg1.l11.m2.2.2.2.2"><apply id="alg1.l11.m2.1.1.1.1.1.cmml" xref="alg1.l11.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m2.1.1.1.1.1.1.cmml" xref="alg1.l11.m2.1.1.1.1.1">superscript</csymbol><ci id="alg1.l11.m2.1.1.1.1.1.2.cmml" xref="alg1.l11.m2.1.1.1.1.1.2">𝑋</ci><ci id="alg1.l11.m2.1.1.1.1.1.3.cmml" xref="alg1.l11.m2.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l11.m2.2.2.2.2.2.cmml" xref="alg1.l11.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l11.m2.2.2.2.2.2.1.cmml" xref="alg1.l11.m2.2.2.2.2.2">superscript</csymbol><ci id="alg1.l11.m2.2.2.2.2.2.2.cmml" xref="alg1.l11.m2.2.2.2.2.2.2">𝑌</ci><ci id="alg1.l11.m2.2.2.2.2.2.3.cmml" xref="alg1.l11.m2.2.2.2.2.2.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.2c">D^{i}=\left\{X^{i},Y^{i}\right\}</annotation></semantics></math>

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>           Transmit updated <math id="alg1.l12.m1.1" class="ltx_Math" alttext="w_{k}^{i}" display="inline"><semantics id="alg1.l12.m1.1a"><msubsup id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2.2" xref="alg1.l12.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l12.m1.1.1.2.3" xref="alg1.l12.m1.1.1.2.3.cmml">k</mi><mi id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1">superscript</csymbol><apply id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.2.2">𝑤</ci><ci id="alg1.l12.m1.1.1.2.3.cmml" xref="alg1.l12.m1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">w_{k}^{i}</annotation></semantics></math> back to the server.

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>        <span id="alg1.l13.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l13.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>        Update model weights for cluster specific model by aggregation: <math id="alg1.l14.m1.1" class="ltx_Math" alttext="w_{k}\leftarrow\frac{1}{l}\sum_{i=1}^{l}w_{k}^{i}" display="inline"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><msub id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml"><mi id="alg1.l14.m1.1.1.2.2" xref="alg1.l14.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l14.m1.1.1.2.3" xref="alg1.l14.m1.1.1.2.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml">←</mo><mrow id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"><mfrac id="alg1.l14.m1.1.1.3.2" xref="alg1.l14.m1.1.1.3.2.cmml"><mn id="alg1.l14.m1.1.1.3.2.2" xref="alg1.l14.m1.1.1.3.2.2.cmml">1</mn><mi id="alg1.l14.m1.1.1.3.2.3" xref="alg1.l14.m1.1.1.3.2.3.cmml">l</mi></mfrac><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.3.1" xref="alg1.l14.m1.1.1.3.1.cmml">​</mo><mrow id="alg1.l14.m1.1.1.3.3" xref="alg1.l14.m1.1.1.3.3.cmml"><msubsup id="alg1.l14.m1.1.1.3.3.1" xref="alg1.l14.m1.1.1.3.3.1.cmml"><mo id="alg1.l14.m1.1.1.3.3.1.2.2" xref="alg1.l14.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="alg1.l14.m1.1.1.3.3.1.2.3" xref="alg1.l14.m1.1.1.3.3.1.2.3.cmml"><mi id="alg1.l14.m1.1.1.3.3.1.2.3.2" xref="alg1.l14.m1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="alg1.l14.m1.1.1.3.3.1.2.3.1" xref="alg1.l14.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="alg1.l14.m1.1.1.3.3.1.2.3.3" xref="alg1.l14.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l14.m1.1.1.3.3.1.3" xref="alg1.l14.m1.1.1.3.3.1.3.cmml">l</mi></msubsup><msubsup id="alg1.l14.m1.1.1.3.3.2" xref="alg1.l14.m1.1.1.3.3.2.cmml"><mi id="alg1.l14.m1.1.1.3.3.2.2.2" xref="alg1.l14.m1.1.1.3.3.2.2.2.cmml">w</mi><mi id="alg1.l14.m1.1.1.3.3.2.2.3" xref="alg1.l14.m1.1.1.3.3.2.2.3.cmml">k</mi><mi id="alg1.l14.m1.1.1.3.3.2.3" xref="alg1.l14.m1.1.1.3.3.2.3.cmml">i</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><ci id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1">←</ci><apply id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.2">subscript</csymbol><ci id="alg1.l14.m1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.2.2">𝑤</ci><ci id="alg1.l14.m1.1.1.2.3.cmml" xref="alg1.l14.m1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3"><times id="alg1.l14.m1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.3.1"></times><apply id="alg1.l14.m1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.3.2"><divide id="alg1.l14.m1.1.1.3.2.1.cmml" xref="alg1.l14.m1.1.1.3.2"></divide><cn type="integer" id="alg1.l14.m1.1.1.3.2.2.cmml" xref="alg1.l14.m1.1.1.3.2.2">1</cn><ci id="alg1.l14.m1.1.1.3.2.3.cmml" xref="alg1.l14.m1.1.1.3.2.3">𝑙</ci></apply><apply id="alg1.l14.m1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.3.3"><apply id="alg1.l14.m1.1.1.3.3.1.cmml" xref="alg1.l14.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.3.1.1.cmml" xref="alg1.l14.m1.1.1.3.3.1">superscript</csymbol><apply id="alg1.l14.m1.1.1.3.3.1.2.cmml" xref="alg1.l14.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.3.1.2.1.cmml" xref="alg1.l14.m1.1.1.3.3.1">subscript</csymbol><sum id="alg1.l14.m1.1.1.3.3.1.2.2.cmml" xref="alg1.l14.m1.1.1.3.3.1.2.2"></sum><apply id="alg1.l14.m1.1.1.3.3.1.2.3.cmml" xref="alg1.l14.m1.1.1.3.3.1.2.3"><eq id="alg1.l14.m1.1.1.3.3.1.2.3.1.cmml" xref="alg1.l14.m1.1.1.3.3.1.2.3.1"></eq><ci id="alg1.l14.m1.1.1.3.3.1.2.3.2.cmml" xref="alg1.l14.m1.1.1.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="alg1.l14.m1.1.1.3.3.1.2.3.3.cmml" xref="alg1.l14.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l14.m1.1.1.3.3.1.3.cmml" xref="alg1.l14.m1.1.1.3.3.1.3">𝑙</ci></apply><apply id="alg1.l14.m1.1.1.3.3.2.cmml" xref="alg1.l14.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.3.2.1.cmml" xref="alg1.l14.m1.1.1.3.3.2">superscript</csymbol><apply id="alg1.l14.m1.1.1.3.3.2.2.cmml" xref="alg1.l14.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.3.2.2.1.cmml" xref="alg1.l14.m1.1.1.3.3.2">subscript</csymbol><ci id="alg1.l14.m1.1.1.3.3.2.2.2.cmml" xref="alg1.l14.m1.1.1.3.3.2.2.2">𝑤</ci><ci id="alg1.l14.m1.1.1.3.3.2.2.3.cmml" xref="alg1.l14.m1.1.1.3.3.2.2.3">𝑘</ci></apply><ci id="alg1.l14.m1.1.1.3.3.2.3.cmml" xref="alg1.l14.m1.1.1.3.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">w_{k}\leftarrow\frac{1}{l}\sum_{i=1}^{l}w_{k}^{i}</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>     <span id="alg1.l15.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l15.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>  <span id="alg1.l16.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l16.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>  <span id="alg1.l17.2" class="ltx_text ltx_font_bold">Output:</span> cluster specific models with trained weights: <math id="alg1.l17.m1.1" class="ltx_Math" alttext="w_{k}" display="inline"><semantics id="alg1.l17.m1.1a"><msub id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><mi id="alg1.l17.m1.1.1.2" xref="alg1.l17.m1.1.1.2.cmml">w</mi><mi id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1">subscript</csymbol><ci id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2">𝑤</ci><ci id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">w_{k}</annotation></semantics></math>, <math id="alg1.l17.m2.4" class="ltx_Math" alttext="k=1,2,...,N" display="inline"><semantics id="alg1.l17.m2.4a"><mrow id="alg1.l17.m2.4.5" xref="alg1.l17.m2.4.5.cmml"><mi id="alg1.l17.m2.4.5.2" xref="alg1.l17.m2.4.5.2.cmml">k</mi><mo id="alg1.l17.m2.4.5.1" xref="alg1.l17.m2.4.5.1.cmml">=</mo><mrow id="alg1.l17.m2.4.5.3.2" xref="alg1.l17.m2.4.5.3.1.cmml"><mn id="alg1.l17.m2.1.1" xref="alg1.l17.m2.1.1.cmml">1</mn><mo id="alg1.l17.m2.4.5.3.2.1" xref="alg1.l17.m2.4.5.3.1.cmml">,</mo><mn id="alg1.l17.m2.2.2" xref="alg1.l17.m2.2.2.cmml">2</mn><mo id="alg1.l17.m2.4.5.3.2.2" xref="alg1.l17.m2.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l17.m2.3.3" xref="alg1.l17.m2.3.3.cmml">…</mi><mo id="alg1.l17.m2.4.5.3.2.3" xref="alg1.l17.m2.4.5.3.1.cmml">,</mo><mi id="alg1.l17.m2.4.4" xref="alg1.l17.m2.4.4.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m2.4b"><apply id="alg1.l17.m2.4.5.cmml" xref="alg1.l17.m2.4.5"><eq id="alg1.l17.m2.4.5.1.cmml" xref="alg1.l17.m2.4.5.1"></eq><ci id="alg1.l17.m2.4.5.2.cmml" xref="alg1.l17.m2.4.5.2">𝑘</ci><list id="alg1.l17.m2.4.5.3.1.cmml" xref="alg1.l17.m2.4.5.3.2"><cn type="integer" id="alg1.l17.m2.1.1.cmml" xref="alg1.l17.m2.1.1">1</cn><cn type="integer" id="alg1.l17.m2.2.2.cmml" xref="alg1.l17.m2.2.2">2</cn><ci id="alg1.l17.m2.3.3.cmml" xref="alg1.l17.m2.3.3">…</ci><ci id="alg1.l17.m2.4.4.cmml" xref="alg1.l17.m2.4.4">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m2.4c">k=1,2,...,N</annotation></semantics></math>

</div>
</div>
</figure>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2210.15850/assets/image/training_history.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="240" height="186" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.3.2" class="ltx_text" style="font-size:90%;">Training History for Cluster 0, 1 and 2 Models</span></figcaption>
</figure>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2210.15850/assets/image/huber_Without_Clustering.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="240" height="97" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S3.F3.3.2" class="ltx_text" style="font-size:90%;">Training History for Model Trained Without Clustering</span></figcaption>
</figure>
<figure id="S3.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2210.15850/assets/image/true_and_prediction_cluster_0_client_14.png" id="S3.F4.sf1.g1" class="ltx_graphics ltx_img_landscape" width="269" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F4.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2210.15850/assets/image/true_and_prediction_cluster_1_client_9.png" id="S3.F4.sf2.g1" class="ltx_graphics ltx_img_landscape" width="269" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F4.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.F4.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2210.15850/assets/image/true_and_prediction_cluster_2_client_6.png" id="S3.F4.sf3.g1" class="ltx_graphics ltx_img_landscape" width="269" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F4.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S3.F4.3.2" class="ltx_text" style="font-size:90%;">Predictions from Cluster Specific Models and Model Trained Without Clustering</span></figcaption>
</figure>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Experimental Settings</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">For our experiments, we used “HUE: The Hourly Usage of Energy Dataset for Buildings in British Columbia” <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> dataset. It contains almost three years worth of hourly energy usage data for twenty-two households as well as the housing attributes. We limited the time period for training data between ‘2015-09-29’ and ‘2017-09-29’ and based on the availability, houses with IDs <span id="S4.p1.1.1" class="ltx_text">3-15, 19, and 20</span> are chosen. Available energy readings after ‘2017-09-29’ for each house are kept as hold out test data. Hourly energy usage readings are re-sampled into daily energy usage data.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">Initially, we input housing attributes into the OPTICS algorithm and to get the clustered house IDs as output. Types of attributes used for clustering include: house type (eg.bungalow or apartment), facing direction, region, rental units, heating type (electricity or gas). In our experiments, we used scikit-learn <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> implementation of OPTICS algorithm and we set the minimum number of cluster samples as two and other parameters are left as default. On our clients, clustering produced three clusters and a set of clients are sampled as noise. Cluster 1 includes house IDs 3, 5, and 14. Cluster 2 includes house IDs 4, 8, 9, 10, 13 and 19. Lastly, cluster 3 includes house IDs of 6 and 12. For each of the three clusters, we train an RNN model in a federated learning manner.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.1" class="ltx_p">We use Keras API <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> with TensorFlow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> backend for implementing the RNN model. Bidirectional LSTM (long short-term memory) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> layers are used for constructing the RNN model. Since LSTM layers can recognize patterns of long-term dependencies, it is suitable for predicting time series data. In a bidirectional LSTM layer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, neurons are split into two parts in which one part is responsible for the forward states and the other for the backward states. A bidirectional LSTM layer can utilize both past and future information of an input time series for training. Our RNN model is a sequential model that contains two bidirectional LSTM layers, two dense layers and an output dense layer. Our RNN model is configured to receive thirty days’ worth of energy usage data and predict the next day demand.</p>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.1" class="ltx_p">RNN models for each cluster are trained separately in federated learning paradigm. At the start of every training round, the latest global model is synchronized to the participating clients as the base model. In every training round each client trains the base model for five epochs. At the end of every training round, the resulting global model is evaluated on the test data of its respective cluster.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Evaluation and Results</span>
</h2>

<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S5.T1.2.1.1" class="ltx_text" style="font-size:90%;">TABLE I</span>: </span><span id="S5.T1.3.2" class="ltx_text" style="font-size:90%;">Test Loss Comparison</span></figcaption>
<table id="S5.T1.4" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T1.4.1.1" class="ltx_tr">
<td id="S5.T1.4.1.1.1" class="ltx_td ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="2"></td>
<td id="S5.T1.4.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="2">
<span id="S5.T1.4.1.1.2.1" class="ltx_text"></span> <span id="S5.T1.4.1.1.2.2" class="ltx_text">
<span id="S5.T1.4.1.1.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T1.4.1.1.2.2.1.1" class="ltx_tr">
<span id="S5.T1.4.1.1.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.4.1.1.2.2.1.1.1.1" class="ltx_text" style="font-size:80%;">Cluster Specific</span></span></span>
<span id="S5.T1.4.1.1.2.2.1.2" class="ltx_tr">
<span id="S5.T1.4.1.1.2.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.4.1.1.2.2.1.2.1.1" class="ltx_text" style="font-size:80%;">Model</span></span></span>
</span></span><span id="S5.T1.4.1.1.2.3" class="ltx_text"></span></td>
<td id="S5.T1.4.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="2">
<span id="S5.T1.4.1.1.3.1" class="ltx_text"></span> <span id="S5.T1.4.1.1.3.2" class="ltx_text">
<span id="S5.T1.4.1.1.3.2.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T1.4.1.1.3.2.1.1" class="ltx_tr">
<span id="S5.T1.4.1.1.3.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.4.1.1.3.2.1.1.1.1" class="ltx_text" style="font-size:80%;">Model Trained</span></span></span>
<span id="S5.T1.4.1.1.3.2.1.2" class="ltx_tr">
<span id="S5.T1.4.1.1.3.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.4.1.1.3.2.1.2.1.1" class="ltx_text" style="font-size:80%;">Without Clustering</span></span></span>
</span></span><span id="S5.T1.4.1.1.3.3" class="ltx_text"></span></td>
</tr>
<tr id="S5.T1.4.2.2" class="ltx_tr">
<th id="S5.T1.4.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<span id="S5.T1.4.2.2.1.1" class="ltx_text"></span> <span id="S5.T1.4.2.2.1.2" class="ltx_text">
<span id="S5.T1.4.2.2.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T1.4.2.2.1.2.1.1" class="ltx_tr">
<span id="S5.T1.4.2.2.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.4.2.2.1.2.1.1.1.1" class="ltx_text" style="font-size:80%;">Cluster</span></span></span>
<span id="S5.T1.4.2.2.1.2.1.2" class="ltx_tr">
<span id="S5.T1.4.2.2.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.4.2.2.1.2.1.2.1.1" class="ltx_text" style="font-size:80%;">ID</span></span></span>
</span></span><span id="S5.T1.4.2.2.1.3" class="ltx_text"></span></th>
<th id="S5.T1.4.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<span id="S5.T1.4.2.2.2.1" class="ltx_text"></span> <span id="S5.T1.4.2.2.2.2" class="ltx_text">
<span id="S5.T1.4.2.2.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T1.4.2.2.2.2.1.1" class="ltx_tr">
<span id="S5.T1.4.2.2.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.4.2.2.2.2.1.1.1.1" class="ltx_text" style="font-size:80%;">House</span></span></span>
<span id="S5.T1.4.2.2.2.2.1.2" class="ltx_tr">
<span id="S5.T1.4.2.2.2.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.4.2.2.2.2.1.2.1.1" class="ltx_text" style="font-size:80%;">ID</span></span></span>
</span></span><span id="S5.T1.4.2.2.2.3" class="ltx_text"></span></th>
<td id="S5.T1.4.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Rounds</td>
<th id="S5.T1.4.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<span id="S5.T1.4.2.2.4.1" class="ltx_text"></span> <span id="S5.T1.4.2.2.4.2" class="ltx_text">
<span id="S5.T1.4.2.2.4.2.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T1.4.2.2.4.2.1.1" class="ltx_tr">
<span id="S5.T1.4.2.2.4.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.4.2.2.4.2.1.1.1.1" class="ltx_text" style="font-size:80%;">Test Loss</span></span></span>
<span id="S5.T1.4.2.2.4.2.1.2" class="ltx_tr">
<span id="S5.T1.4.2.2.4.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.4.2.2.4.2.1.2.1.1" class="ltx_text" style="font-size:80%;">(Huber)</span></span></span>
</span></span><span id="S5.T1.4.2.2.4.3" class="ltx_text"></span></th>
<td id="S5.T1.4.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Rounds</td>
<th id="S5.T1.4.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<span id="S5.T1.4.2.2.6.1" class="ltx_text"></span> <span id="S5.T1.4.2.2.6.2" class="ltx_text">
<span id="S5.T1.4.2.2.6.2.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T1.4.2.2.6.2.1.1" class="ltx_tr">
<span id="S5.T1.4.2.2.6.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.4.2.2.6.2.1.1.1.1" class="ltx_text" style="font-size:80%;">Test Loss</span></span></span>
<span id="S5.T1.4.2.2.6.2.1.2" class="ltx_tr">
<span id="S5.T1.4.2.2.6.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.4.2.2.6.2.1.2.1.1" class="ltx_text" style="font-size:80%;">(Huber)</span></span></span>
</span></span><span id="S5.T1.4.2.2.6.3" class="ltx_text"></span></th>
</tr>
<tr id="S5.T1.4.3.3" class="ltx_tr">
<td id="S5.T1.4.3.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="3"><span id="S5.T1.4.3.3.1.1" class="ltx_text">0</span></td>
<td id="S5.T1.4.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">3</td>
<td id="S5.T1.4.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="3"><span id="S5.T1.4.3.3.3.1" class="ltx_text">40</span></td>
<td id="S5.T1.4.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.00818</td>
<td id="S5.T1.4.3.3.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="11"><span id="S5.T1.4.3.3.5.1" class="ltx_text">240</span></td>
<td id="S5.T1.4.3.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.00861</td>
</tr>
<tr id="S5.T1.4.4.4" class="ltx_tr">
<td id="S5.T1.4.4.4.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">5</td>
<td id="S5.T1.4.4.4.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.00506</td>
<td id="S5.T1.4.4.4.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.00516</td>
</tr>
<tr id="S5.T1.4.5.5" class="ltx_tr">
<td id="S5.T1.4.5.5.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">14</td>
<td id="S5.T1.4.5.5.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.00519</td>
<td id="S5.T1.4.5.5.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.00546</td>
</tr>
<tr id="S5.T1.4.6.6" class="ltx_tr">
<td id="S5.T1.4.6.6.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="6"><span id="S5.T1.4.6.6.1.1" class="ltx_text">1</span></td>
<td id="S5.T1.4.6.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">4</td>
<td id="S5.T1.4.6.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="6"><span id="S5.T1.4.6.6.3.1" class="ltx_text">120</span></td>
<td id="S5.T1.4.6.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.01060</td>
<td id="S5.T1.4.6.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.01245</td>
</tr>
<tr id="S5.T1.4.7.7" class="ltx_tr">
<td id="S5.T1.4.7.7.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">8</td>
<td id="S5.T1.4.7.7.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.01398</td>
<td id="S5.T1.4.7.7.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.01333</td>
</tr>
<tr id="S5.T1.4.8.8" class="ltx_tr">
<td id="S5.T1.4.8.8.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">9</td>
<td id="S5.T1.4.8.8.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.00953</td>
<td id="S5.T1.4.8.8.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.00955</td>
</tr>
<tr id="S5.T1.4.9.9" class="ltx_tr">
<td id="S5.T1.4.9.9.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">10</td>
<td id="S5.T1.4.9.9.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.00844</td>
<td id="S5.T1.4.9.9.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.00840</td>
</tr>
<tr id="S5.T1.4.10.10" class="ltx_tr">
<td id="S5.T1.4.10.10.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">13</td>
<td id="S5.T1.4.10.10.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.01295</td>
<td id="S5.T1.4.10.10.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.01315</td>
</tr>
<tr id="S5.T1.4.11.11" class="ltx_tr">
<td id="S5.T1.4.11.11.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">19</td>
<td id="S5.T1.4.11.11.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.00766</td>
<td id="S5.T1.4.11.11.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.01241</td>
</tr>
<tr id="S5.T1.4.12.12" class="ltx_tr">
<td id="S5.T1.4.12.12.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="2"><span id="S5.T1.4.12.12.1.1" class="ltx_text">2</span></td>
<td id="S5.T1.4.12.12.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">6</td>
<td id="S5.T1.4.12.12.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="2"><span id="S5.T1.4.12.12.3.1" class="ltx_text">40</span></td>
<td id="S5.T1.4.12.12.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.01817</td>
<td id="S5.T1.4.12.12.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.01336</td>
</tr>
<tr id="S5.T1.4.13.13" class="ltx_tr">
<td id="S5.T1.4.13.13.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">12</td>
<td id="S5.T1.4.13.13.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.00702</td>
<td id="S5.T1.4.13.13.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">0.00452</td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">Federated training history plots for each cluster are shown in Fig. <a href="#S3.F2" title="Figure 2 ‣ III Federated Model Training and Client Clustering ‣ Federated Learning based Energy Demand Prediction with Clustered Aggregation This work was partially supported by Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government(MSIT) (No.2019-0-01287, Evolvable Deep Learning Model Generation Platform for Edge Computing) and by the National Research Foundation of Korea(NRF) grant funded by the Korea government(MSIT) (No. No. 2020R1A4A1018607). *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. For comparison, we also trained an RNN model in the federated learning manner on all available clients without clustering and the history plot is shown in Fig. <a href="#S3.F3" title="Figure 3 ‣ III Federated Model Training and Client Clustering ‣ Federated Learning based Energy Demand Prediction with Clustered Aggregation This work was partially supported by Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government(MSIT) (No.2019-0-01287, Evolvable Deep Learning Model Generation Platform for Edge Computing) and by the National Research Foundation of Korea(NRF) grant funded by the Korea government(MSIT) (No. No. 2020R1A4A1018607). *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Cluster specific models for cluster 0 and 2 converged after training for forty rounds and that for cluster 1 converged after training for a hundred and twenty rounds. The model with all available clients is trained for two hundred and forty training rounds. Table <a href="#S5.T1" title="TABLE I ‣ V Evaluation and Results ‣ Federated Learning based Energy Demand Prediction with Clustered Aggregation This work was partially supported by Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government(MSIT) (No.2019-0-01287, Evolvable Deep Learning Model Generation Platform for Edge Computing) and by the National Research Foundation of Korea(NRF) grant funded by the Korea government(MSIT) (No. No. 2020R1A4A1018607). *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> shows the evaluation results the cluster specific models and the model trained without clustering, on corresponding clients’ test data. Cluster specific models are evaluated on the test data of clients from the respective clusters while the model trained on all available clients is evaluated on all clients’ test data. In Table <a href="#S5.T1" title="TABLE I ‣ V Evaluation and Results ‣ Federated Learning based Energy Demand Prediction with Clustered Aggregation This work was partially supported by Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government(MSIT) (No.2019-0-01287, Evolvable Deep Learning Model Generation Platform for Edge Computing) and by the National Research Foundation of Korea(NRF) grant funded by the Korea government(MSIT) (No. No. 2020R1A4A1018607). *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>, we can observe that there is no significant performance loss between cluster specific models which are trained with a relatively fewer number of participating clients and the model trained without clustering where all clients participate. From the Fig. <a href="#S3.F2" title="Figure 2 ‣ III Federated Model Training and Client Clustering ‣ Federated Learning based Energy Demand Prediction with Clustered Aggregation This work was partially supported by Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government(MSIT) (No.2019-0-01287, Evolvable Deep Learning Model Generation Platform for Edge Computing) and by the National Research Foundation of Korea(NRF) grant funded by the Korea government(MSIT) (No. No. 2020R1A4A1018607). *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and <a href="#S3.F3" title="Figure 3 ‣ III Federated Model Training and Client Clustering ‣ Federated Learning based Energy Demand Prediction with Clustered Aggregation This work was partially supported by Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government(MSIT) (No.2019-0-01287, Evolvable Deep Learning Model Generation Platform for Edge Computing) and by the National Research Foundation of Korea(NRF) grant funded by the Korea government(MSIT) (No. No. 2020R1A4A1018607). *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, it is evident that cluster specific models achieved the optimum significantly faster compared to the single federated model trained with all clients. In Fig. <a href="#S3.F3" title="Figure 3 ‣ III Federated Model Training and Client Clustering ‣ Federated Learning based Energy Demand Prediction with Clustered Aggregation This work was partially supported by Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government(MSIT) (No.2019-0-01287, Evolvable Deep Learning Model Generation Platform for Edge Computing) and by the National Research Foundation of Korea(NRF) grant funded by the Korea government(MSIT) (No. No. 2020R1A4A1018607). *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we can observe that training and testing losses for the model trained without clustering slowly felled, but they never fully flattened out because different client households have different housing attributes and thus diverse energy usage patterns. In Table <a href="#S5.T1" title="TABLE I ‣ V Evaluation and Results ‣ Federated Learning based Energy Demand Prediction with Clustered Aggregation This work was partially supported by Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government(MSIT) (No.2019-0-01287, Evolvable Deep Learning Model Generation Platform for Edge Computing) and by the National Research Foundation of Korea(NRF) grant funded by the Korea government(MSIT) (No. No. 2020R1A4A1018607). *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>, for cluster 2, we can observe that the model trained without clustering performs slightly better than the cluster 2 specific model. This is because the cluster 2 specific model is trained on only two clients and the amount of training data was significantly less than that is available for the model trained with all clients. Fig. <a href="#S3.F4" title="Figure 4 ‣ III Federated Model Training and Client Clustering ‣ Federated Learning based Energy Demand Prediction with Clustered Aggregation This work was partially supported by Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government(MSIT) (No.2019-0-01287, Evolvable Deep Learning Model Generation Platform for Edge Computing) and by the National Research Foundation of Korea(NRF) grant funded by the Korea government(MSIT) (No. No. 2020R1A4A1018607). *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> visualizes the predictions between the cluster specific models and the model trained without clustering on test samples of a client from each of the cluster.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we studied the process of developing an RNN based energy demand predictor system by training it using clustering and federated learning based methods. Federated learning allows us to take advantage of distributed data in clients by training local models without the need for data transmission. But different clients can have different data distributions and federated training process of a model can take a long time to converge. To speed up the convergence rate of the global model, clients with similar attributes can be clustered together and the model updates from the clients’ of the same clusters can be aggregated together. We experimented by training an RNN model for each cluster of clients and compare the results with a single RNN model trained for all available clients. Our method can reduce the communication cost required for collecting training data onto a server since the local data never left the clients. And from our experiments, we observe that by clustering clients, cluster specific models converge significantly faster compare to a model trained without clustering.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:80%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:80%;">
V. I. Ugursal], “Energy consumption, associated questions and some answers,”
</span><em id="bib.bib1.2.2" class="ltx_emph ltx_font_italic" style="font-size:80%;">Applied Energy</em><span id="bib.bib1.3.3" class="ltx_text" style="font-size:80%;">, vol. 130, pp. 783 – 792, 2014. [Online]. Available:
</span><a target="_blank" href="http://www.sciencedirect.com/science/article/pii/S030626191300980X" title="" class="ltx_ref ltx_url ltx_font_typewriter" style="font-size:80%;">http://www.sciencedirect.com/science/article/pii/S030626191300980X</a><span id="bib.bib1.4.4" class="ltx_text" style="font-size:80%;">
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:80%;">
K. Amasyali and N. M. El-Gohary, “A review of data-driven building energy
consumption prediction studies,” </span><em id="bib.bib2.2.2" class="ltx_emph ltx_font_italic" style="font-size:80%;">Renewable and Sustainable Energy
Reviews</em><span id="bib.bib2.3.3" class="ltx_text" style="font-size:80%;">, vol. 81, pp. 1192 – 1205, 2018. [Online]. Available:
</span><a target="_blank" href="http://www.sciencedirect.com/science/article/pii/S1364032117306093" title="" class="ltx_ref ltx_url ltx_font_typewriter" style="font-size:80%;">http://www.sciencedirect.com/science/article/pii/S1364032117306093</a><span id="bib.bib2.4.4" class="ltx_text" style="font-size:80%;">
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:80%;">
R. F. Berriel, A. T. Lopes, A. Rodrigues, F. M. Varejão, and
T. Oliveira-Santos, “Monthly energy consumption forecast: A deep learning
approach,” </span><em id="bib.bib3.2.2" class="ltx_emph ltx_font_italic" style="font-size:80%;">2017 International Joint Conference on Neural Networks
(IJCNN)</em><span id="bib.bib3.3.3" class="ltx_text" style="font-size:80%;">, pp. 4283–4290, 2017.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:80%;">
J.-Y. Kim and S.-B. Cho, “Electric energy consumption prediction by deep
learning with state explainable autoencoder,” </span><em id="bib.bib4.2.2" class="ltx_emph ltx_font_italic" style="font-size:80%;">Energies</em><span id="bib.bib4.3.3" class="ltx_text" style="font-size:80%;">, vol. 12,
no. 4, p. 739, feb 2019.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:80%;">
B. Dong, C. Cao, and S. E. Lee, “Applying support vector machines to predict
building energy consumption in tropical region,” </span><em id="bib.bib5.2.2" class="ltx_emph ltx_font_italic" style="font-size:80%;">Energy and
Buildings</em><span id="bib.bib5.3.3" class="ltx_text" style="font-size:80%;">, vol. 37, no. 5, pp. 545 – 553, 2005. [Online]. Available:
</span><a target="_blank" href="http://www.sciencedirect.com/science/article/pii/S0378778804002981" title="" class="ltx_ref ltx_url ltx_font_typewriter" style="font-size:80%;">http://www.sciencedirect.com/science/article/pii/S0378778804002981</a><span id="bib.bib5.4.4" class="ltx_text" style="font-size:80%;">
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:80%;">
J. G. Jetcheva, M. Majidpour, and W.-P. Chen, “Neural network model ensembles
for building-level electricity load forecasts,” </span><em id="bib.bib6.2.2" class="ltx_emph ltx_font_italic" style="font-size:80%;">Energy and Buildings</em><span id="bib.bib6.3.3" class="ltx_text" style="font-size:80%;">,
vol. 84, pp. 214 – 223, 2014. [Online]. Available:
</span><a target="_blank" href="http://www.sciencedirect.com/science/article/pii/S0378778814006458" title="" class="ltx_ref ltx_url ltx_font_typewriter" style="font-size:80%;">http://www.sciencedirect.com/science/article/pii/S0378778814006458</a><span id="bib.bib6.4.4" class="ltx_text" style="font-size:80%;">
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:80%;">
R. E. Edwards, J. New, and L. E. Parker, “Predicting future hourly residential
electrical consumption: A machine learning case study,” </span><em id="bib.bib7.2.2" class="ltx_emph ltx_font_italic" style="font-size:80%;">Energy and
Buildings</em><span id="bib.bib7.3.3" class="ltx_text" style="font-size:80%;">, vol. 49, pp. 591 – 603, 2012. [Online]. Available:
</span><a target="_blank" href="http://www.sciencedirect.com/science/article/pii/S0378778812001582" title="" class="ltx_ref ltx_url ltx_font_typewriter" style="font-size:80%;">http://www.sciencedirect.com/science/article/pii/S0378778812001582</a><span id="bib.bib7.4.4" class="ltx_text" style="font-size:80%;">
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:80%;">
H. Hewamalage, C. Bergmeir, and K. Bandara, “Recurrent neural networks for
time series forecasting: Current status and future directions,”
</span><em id="bib.bib8.2.2" class="ltx_emph ltx_font_italic" style="font-size:80%;">ArXiv</em><span id="bib.bib8.3.3" class="ltx_text" style="font-size:80%;">, vol. abs/1909.00590, 2019.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:80%;">
J. Konecný, H. B. McMahan, F. X. Yu, P. Richtárik, A. T. Suresh, and
D. Bacon, “Federated learning: Strategies for improving communication
efficiency,” </span><em id="bib.bib9.2.2" class="ltx_emph ltx_font_italic" style="font-size:80%;">ArXiv</em><span id="bib.bib9.3.3" class="ltx_text" style="font-size:80%;">, vol. abs/1610.05492, 2016.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:80%;">
J. Konecný, H. B. McMahan, D. Ramage, and P. Richtárik, “Federated
optimization: Distributed machine learning for on-device intelligence,”
</span><em id="bib.bib10.2.2" class="ltx_emph ltx_font_italic" style="font-size:80%;">ArXiv</em><span id="bib.bib10.3.3" class="ltx_text" style="font-size:80%;">, vol. abs/1610.02527, 2016.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:80%;">
T. Li, A. K. Sahu, A. Talwalkar, and V. Smith, “Federated learning:
Challenges, methods, and future directions,” </span><em id="bib.bib11.2.2" class="ltx_emph ltx_font_italic" style="font-size:80%;">IEEE Signal Processing
Magazine</em><span id="bib.bib11.3.3" class="ltx_text" style="font-size:80%;">, vol. 37, pp. 50–60, 2020.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:80%;">
M. Ankerst, M. Breunig, H.-P. Kriegel, and J. Sander, “Optics: Ordering points
to identify the clustering structure,” vol. 28, 06 1999, pp. 49–60.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:80%;">
S. Makonin, “HUE: The Hourly Usage of Energy Dataset for Buildings in British
Columbia,” 2018. [Online]. Available:
</span><a target="_blank" href="https://doi.org/10.7910/DVN/N3HGRN" title="" class="ltx_ref ltx_url ltx_font_typewriter" style="font-size:80%;">https://doi.org/10.7910/DVN/N3HGRN</a><span id="bib.bib13.2.2" class="ltx_text" style="font-size:80%;">
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:80%;">
F. Pedregosa, G. Varoquaux, A. Gramfort, V. Michel, B. Thirion, O. Grisel,
M. Blondel, P. Prettenhofer, R. Weiss, V. Dubourg, J. Vanderplas, A. Passos,
D. Cournapeau, M. Brucher, M. Perrot, and E. Duchesnay, “Scikit-learn:
Machine learning in Python,” </span><em id="bib.bib14.2.2" class="ltx_emph ltx_font_italic" style="font-size:80%;">Journal of Machine Learning Research</em><span id="bib.bib14.3.3" class="ltx_text" style="font-size:80%;">,
vol. 12, pp. 2825–2830, 2011.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:80%;">
F. Chollet </span><em id="bib.bib15.2.2" class="ltx_emph ltx_font_italic" style="font-size:80%;">et al.</em><span id="bib.bib15.3.3" class="ltx_text" style="font-size:80%;">, “Keras,” </span><a target="_blank" href="https://keras.io" title="" class="ltx_ref ltx_url ltx_font_typewriter" style="font-size:80%;">https://keras.io</a><span id="bib.bib15.4.4" class="ltx_text" style="font-size:80%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:80%;">
M. Abadi, A. Agarwal, P. Barham, E. Brevdo, Z. Chen, C. Citro, G. S. Corrado,
A. Davis, J. Dean, M. Devin, S. Ghemawat, I. Goodfellow, A. Harp, G. Irving,
M. Isard, Y. Jia, R. Jozefowicz, L. Kaiser, M. Kudlur, J. Levenberg,
D. Mané, R. Monga, S. Moore, D. Murray, C. Olah, M. Schuster, J. Shlens,
B. Steiner, I. Sutskever, K. Talwar, P. Tucker, V. Vanhoucke, V. Vasudevan,
F. Viégas, O. Vinyals, P. Warden, M. Wattenberg, M. Wicke, Y. Yu, and
X. Zheng, “TensorFlow: Large-scale machine learning on heterogeneous
systems,” 2015. [Online]. Available: </span><a target="_blank" href="https://www.tensorflow.org/" title="" class="ltx_ref ltx_url ltx_font_typewriter" style="font-size:80%;">https://www.tensorflow.org/</a><span id="bib.bib16.2.2" class="ltx_text" style="font-size:80%;">
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:80%;">
S. Hochreiter and J. Schmidhuber, “Long short-term memory,” </span><em id="bib.bib17.2.2" class="ltx_emph ltx_font_italic" style="font-size:80%;">Neural
Comput.</em><span id="bib.bib17.3.3" class="ltx_text" style="font-size:80%;">, vol. 9, no. 8, p. 1735–1780, Nov. 1997. [Online]. Available:
</span><a target="_blank" href="https://doi.org/10.1162/neco.1997.9.8.1735" title="" class="ltx_ref ltx_url ltx_font_typewriter" style="font-size:80%;">https://doi.org/10.1162/neco.1997.9.8.1735</a><span id="bib.bib17.4.4" class="ltx_text" style="font-size:80%;">
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:80%;">
M. Schuster and K. K. Paliwal, “Bidirectional recurrent neural networks,”
</span><em id="bib.bib18.2.2" class="ltx_emph ltx_font_italic" style="font-size:80%;">IEEE Transactions on Signal Processing</em><span id="bib.bib18.3.3" class="ltx_text" style="font-size:80%;">, vol. 45, no. 11, pp.
2673–2681, 1997.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:80%;">
Y. L. Tun, K. Thar, and C. Hong, “Federated learning based energy demand
prediction of individual households,” 2020.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div id="p2" class="ltx_para">
<p id="p2.1" class="ltx_p"></p>
</div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2210.15849" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2210.15850" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2210.15850">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2210.15850" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2210.15851" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Feb 27 01:59:36 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
