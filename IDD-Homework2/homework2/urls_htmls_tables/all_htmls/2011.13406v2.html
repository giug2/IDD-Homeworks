<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2011.13406] Learning from Lexical Perturbations for Consistent Visual Question Answering</title><meta property="og:description" content="Existing Visual Question Answering (VQA) models are often fragile and sensitive to input variations.
In this paper, we propose a novel approach to address this issue based on modular networks, which creates two questio…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Learning from Lexical Perturbations for Consistent Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Learning from Lexical Perturbations for Consistent Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2011.13406">

<!--Generated on Sat Mar  9 04:52:48 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Learning from Lexical Perturbations for Consistent Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Spencer Whitehead<sup id="id10.2.id1" class="ltx_sup"><span id="id10.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Hui Wu<sup id="id11.2.id1" class="ltx_sup"><span id="id11.2.id1.1" class="ltx_text ltx_font_italic">2</span></sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Yi Ren Fung<sup id="id12.2.id1" class="ltx_sup"><span id="id12.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Heng Ji<sup id="id13.2.id1" class="ltx_sup"><span id="id13.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Rogerio Feris<sup id="id14.2.id1" class="ltx_sup"><span id="id14.2.id1.1" class="ltx_text ltx_font_italic">2</span></sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Kate Saenko<sup id="id15.4.id1" class="ltx_sup"><span id="id15.4.id1.1" class="ltx_text ltx_font_italic">2,3</span></sup>
<br class="ltx_break"><sup id="id16.5.id2" class="ltx_sup"><span id="id16.5.id2.1" class="ltx_text ltx_font_italic">1</span></sup>UIUC  <sup id="id17.6.id3" class="ltx_sup"><span id="id17.6.id3.1" class="ltx_text ltx_font_italic">2</span></sup>MIT-IBM Watson AI Lab
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> IBM Research  <sup id="id18.2.id1" class="ltx_sup"><span id="id18.2.id1.1" class="ltx_text ltx_font_italic">3</span></sup>Boston University
<br class="ltx_break"><span id="id19.3.id2" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{srw5,yifung2,hengji}@illinois.edu</span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span id="id20.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{wuhu,rsferis}@us.ibm.com</span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span id="id21.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">saenko@bu.edu</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id22.id1" class="ltx_p">Existing Visual Question Answering (VQA) models are often fragile and sensitive to input variations.
In this paper, we propose a novel approach to address this issue based on modular networks, which creates two questions related by linguistic perturbations and regularizes the visual reasoning process between them to be consistent during training.
We show that our framework markedly improves consistency and generalization ability, demonstrating the value of controlled linguistic perturbations as a useful and currently underutilized training and regularization tool for VQA models.
We also present VQA Perturbed Pairings (VQA P2), a new, low-cost benchmark and augmentation pipeline to create controllable linguistic variations of VQA questions.
Our benchmark uniquely draws from large-scale linguistic resources, avoiding human
annotation effort while maintaining data quality compared to generative approaches.
We benchmark existing VQA models using VQA P2 and provide robustness analysis on each type of linguistic variation.<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Data and resources are publicly available: 
<br class="ltx_break"><a target="_blank" href="https://github.com/SpencerWhitehead/vqap2" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/SpencerWhitehead/vqap2</a></span></span></span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<figure id="S1.F1" class="ltx_figure"><img src="/html/2011.13406/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="392" height="160" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>
We show that existing VQA models can be surprisingly sensitive to simple, low-level linguistic changes. Examples show three types of lexical changes, along with answers predicted by a recent model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. The goal of this
work is twofold: how to benchmark such phenomenon, and
how to improve a model’s robustness against linguistic perturbations.
</figcaption>
</figure>
<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Though great progress has been made towards Visual Question Answering (VQA), the approaches lack robustness and are sensitive to input variations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib56" title="" class="ltx_ref">56</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>. In
particular, prior work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> has shown that when presented with a rephrased version of a question, VQA models often produce inconsistent answers.
We conjecture that this is likely because most VQA approaches ignore interconnections between related questions and handle each example independently during training, even though learning such relationships is paramount to generalization, robustness, and compositionality.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">While a few attempts have been made to improve VQA robustness via augmentation and regularization techniques <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, they encourage consistency among related questions at the answer prediction level, without considering the stronger form of consistency between the intermediate computation steps. Furthermore, proposed augmentations are either costly (human-generated <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>) or suffer from quality control issues <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this work, we propose a novel robust VQA approach that first augments the question and then enforces consistency not only of the answer, but also of the intermediate representations computed by the model. The intuition is that (like humans) VQA models should follow the same reasoning steps to solve two differently-phrased questions that have the same meaning. For example, to answer both questions <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">“Are the buildings tall?”</span> and <span id="S1.p3.1.2" class="ltx_text ltx_font_italic">“Are the buildings short?”</span> a model should follow the same process, <span id="S1.p3.1.3" class="ltx_text ltx_font_italic">i.e.</span> detect buildings in the image, then classify their height.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">How to enforce such consistency of the intermediate reasoning steps appears to be a hard problem in general. We propose that an effective way to improve this stronger notion of <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">reasoning consistency</span> is by maintaining the associated computation steps between questions that differ by controlled variations. We leverage the family of interpretable, compositional VQA models called <span id="S1.p4.1.2" class="ltx_text ltx_font_italic">Neural Module Networks (NMNs)</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> which explicitly represent sub-tasks like object detection and spatial reasoning as <span id="S1.p4.1.3" class="ltx_text ltx_font_italic">modules</span> within the network and predict sequences of weights over these modules (akin to <span id="S1.p4.1.4" class="ltx_text ltx_font_italic">programs</span>) to solve each question. However, unlike existing NMN work, we regularize the model to learn not only how to compose sub-tasks, but also follow the same sequences of sub-tasks to answer two variations of the same question, illustrated in <span id="S1.p4.1.5" class="ltx_ERROR undefined">\figref</span>fig:intuition.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">In addition, we also propose a novel data augmentation algorithm based on auxiliary linguistic knowledge freely available in text-only corpora. Examples like in <span id="S1.p5.1.1" class="ltx_ERROR undefined">\figref</span>fig:compare_examples, seem to suggest that existing VQA models ignore the relatedness between questions with mild linguistic modifications.
Questions like the antonymous pair in <span id="S1.p5.1.2" class="ltx_ERROR undefined">\figref</span>fig:compare_examples are related in that they query the same property of the same object, but differ in that they ask the opposite of each other.
Existing work ignores such modifications and focuses either on human-written paraphrased VQA questions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> or auto-generated paraphrases using back-translation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>.
Human paraphrases tend to add filler phrases or even change the question meaning (see <span id="S1.p5.1.3" class="ltx_ERROR undefined">\secref</span>sec:dataset) and are very costly to annotate, while back-translations are also hard to control and have quality problems.
Motivated by this, we propose to augment data with changes at a low level, such as simple lexical substitutions. We create variations by substituting parts of the questions using rules extracted from large-scale language resources <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> which keeps the meaning and the realistic distribution of the original questions while avoiding the cost and/or semantic incoherence commonly found with prior work.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Finally, we contribute VQA Perturbed Pairings (VQA P2), a dataset of perturbed questions derived from VQA v2 that can be used to
measure robustness to the specific linguistic phenomena not previously evaluated in VQA literature, covering the usage of different synonyms (<em id="S1.p6.1.1" class="ltx_emph ltx_font_italic">Synonymous</em>), different phrasings (<em id="S1.p6.1.2" class="ltx_emph ltx_font_italic">Paraphrastic</em>), and opposite attributes (<em id="S1.p6.1.3" class="ltx_emph ltx_font_italic">Antonymous</em>).
VQA P2 is comprised of 36.2k VQA questions, where each question has a corresponding question in VQA v2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> that it differs from by controlled perturbations.
VQA P2 can be easily expanded without the need for expensive human annotations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>, while maintaining control over the perturbations used.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">To summarize, our main contributions are:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">A novel VQA consistency regularization method that augments questions and enforces similar answers and reasoning steps for the original and augmented questions.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">A new data augmentation method and VQA robustness benchmark, VQA P2, to diagnose the robustness of VQA models to controlled linguistic perturbations.
To the best of our knowledge, this is the first approach to use large-scale linguistic resources automatically mined from human-written text to enhance VQA.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Experiments applying our approach to regularize the training of modular, compositional, and interpretable VQA models, demonstrating that it leads to significant improvement in model consistency.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">VQA.</span>
Prodigious progress has been made towards VQA.
Models that learn strong feature backbones with co-attention/bilinear attention have achieved top scores on the widely adopted VQA v2 benchmark <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>.
Recently, vision and language transformer models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, especially when pre-trained
on large-scale vision and language datasets, have led to state-of-the-art performance
on VQA accuracy.
Despite this success, these models are generally not transparent and hard to diagnose.
In contrast, compositional and modular approaches, like NMNs, offer a number of distinct advantages, such as being more interpretable <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, requiring less training data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, and being able to handle complex, compositional questions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>.
Although, there is often a trade-off between accuracy and interpretability.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">VQA Benchmarks.</span>
VQA v2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> has become the de facto training and evaluation data resource. Although improvements
on VQA v2 test accuracy has marked encouraging progress on VQA, previous work has found that models are prone to learning
superficial correlations by taking advantage of dataset
bias <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, and the standard VQA accuracy
metric does not help to quantify such bias. A number of efforts have since
been proposed to serve as additional diagnostic and evaluation tool for VQA.
CLEVR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> and GQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> create compositional questions which are hard to answer if the model relies on language bias.
However, the questions in these datasets are synthetic and do not match the characteristics
of natural questions about real images. VQA-CP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> creates training and testing data splits which have different answer distributions. TDIUC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> categorizes and measures performance by 12 different question types. While these
benchmarks can measure a model’s generalization ability to new question types or
new answer distributions, they do not serve to examine how much an answer might change if we change a specific input question. More related to our work is VQA-Rephrasings dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>, which has rephrased questions associated with a subset of original VQA questions.
However, as we have discussed, the open-endedness nature of human-written
paraphrases makes it hard to identify the source of model inconsistenties.
Unlike our dataset (VQA P2), it does not control for the
specific type and degrees of question variations, making it hard to codify
how questions are related to one another and learn from such relationships.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Improving VQA Robustness.</span>
Robustness of deep learning models has been intensely studied in recent years,
both in the context of image classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> and in a number of natural language understanding tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>.
Within VQA, robustness has been studied under the perspective of grounding model predictions to visual regions that are interpretable
and consistent with human annotated attention maps <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>.
While visual grounding provides a better basis for learning representations of concept
words in questions, many words and expressions in VQA questions do not have a direct
correspondence with visual regions (<span id="S2.p3.1.2" class="ltx_text ltx_font_slanted">i.e.,</span> not “groundable”).
More related to our work, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> examines model consistency under input question variations.
However, these models that consider consistency among related questions only do so at the answer prediction level <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>.
Additionally, another approach applies embedding constraints between questions to improve performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>.
Our framework not only employs answer prediction loss, but also dissects the model and enforces similarities on the sub-tasks involved, which aligns with compositional and transferable modeling of VQA.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>VQA P2 Benchmark</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Our goal is to create an objective benchmark to measure the progress of robustness in VQA models, specifically the consistency of VQA predictions under different linguistic perturbations of the input questions.
So the question is: what is the best method to create realistic, expressive, and semantically coherent, in an efficient fashion?</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">Visual question generation methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> can generate a variety of questions, but the output can be incoherent for a specific image or may be limited to certain types of questions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. More recently, back-translation has emerged as a method of creating paraphrased questions for VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>.
However, in general, controlled generation of text is a difficult open challenge <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>.
Alternatively, template-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> can offer more control and semantic coherence, but require extensive annotations (<span id="S3.p2.1.1" class="ltx_text ltx_font_slanted">e.g.,</span> scene graphs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>) and are limited in expressiveness by the templates used. Human-written paraphrases is
the other option to generate robustness benchmark <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>.
Other than the obvious drawback of being more costly, human-written
question tend to be generic, not good for diagnosing the particular source
that causes answer prediction inconsistencies, as well as being often overly verbose (as shown in <span id="S3.p2.1.2" class="ltx_ERROR undefined">\secref</span>sec:othermethod).</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.1" class="ltx_p">Different from existing approaches, we build our dataset from the original VQA v2 data, and create variations by substituting parts of the questions using rules extracted from large-scale language resources.
Doing so keeps the expressiveness and realistic distribution of the original questions and avoids the semantic incoherence commonly found with trained question generators.
Utilizing large-scale linguistic resources offers an efficient means for creating questions that contain linguistic variations exhibited by humans <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Paraphrasing Creation Pipeline</h3>

<figure id="S3.T1" class="ltx_table">
<table id="S3.T1.10" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.1.1" class="ltx_tr">
<th id="S3.T1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S3.T1.1.1.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Perturbation</span></th>
<th id="S3.T1.1.1.1" class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column ltx_border_tt">
<span id="S3.T1.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Example rules</span><span id="S3.T1.1.1.1.2" class="ltx_text" style="font-size:90%;"> (source </span><math id="S3.T1.1.1.1.m1.1" class="ltx_Math" alttext="\to" display="inline"><semantics id="S3.T1.1.1.1.m1.1a"><mo mathsize="90%" stretchy="false" id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><ci id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">\to</annotation></semantics></math><span id="S3.T1.1.1.1.3" class="ltx_text" style="font-size:90%;"> target)</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.2.2" class="ltx_tr">
<th id="S3.T1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="3"><span id="S3.T1.2.2.2.1" class="ltx_text" style="font-size:90%;">Synonymous</span></th>
<td id="S3.T1.2.2.1" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">
<span id="S3.T1.2.2.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">car</span><span id="S3.T1.2.2.1.2" class="ltx_text" style="font-size:90%;"> </span><math id="S3.T1.2.2.1.m1.1" class="ltx_Math" alttext="\to" display="inline"><semantics id="S3.T1.2.2.1.m1.1a"><mo mathsize="90%" stretchy="false" id="S3.T1.2.2.1.m1.1.1" xref="S3.T1.2.2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.1.m1.1b"><ci id="S3.T1.2.2.1.m1.1.1.cmml" xref="S3.T1.2.2.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.1.m1.1c">\to</annotation></semantics></math><span id="S3.T1.2.2.1.3" class="ltx_text" style="font-size:90%;"> </span><span id="S3.T1.2.2.1.4" class="ltx_text ltx_font_italic" style="font-size:90%;">automobile</span>
</td>
</tr>
<tr id="S3.T1.3.3" class="ltx_tr">
<td id="S3.T1.3.3.1" class="ltx_td ltx_nopad_l ltx_align_center">
<span id="S3.T1.3.3.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">refrigerator</span><span id="S3.T1.3.3.1.2" class="ltx_text" style="font-size:90%;"> </span><math id="S3.T1.3.3.1.m1.1" class="ltx_Math" alttext="\to" display="inline"><semantics id="S3.T1.3.3.1.m1.1a"><mo mathsize="90%" stretchy="false" id="S3.T1.3.3.1.m1.1.1" xref="S3.T1.3.3.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.1.m1.1b"><ci id="S3.T1.3.3.1.m1.1.1.cmml" xref="S3.T1.3.3.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.1.m1.1c">\to</annotation></semantics></math><span id="S3.T1.3.3.1.3" class="ltx_text" style="font-size:90%;"> </span><span id="S3.T1.3.3.1.4" class="ltx_text ltx_font_italic" style="font-size:90%;">fridge</span>
</td>
</tr>
<tr id="S3.T1.4.4" class="ltx_tr">
<td id="S3.T1.4.4.1" class="ltx_td ltx_nopad_l ltx_align_center">
<span id="S3.T1.4.4.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">phone</span><span id="S3.T1.4.4.1.2" class="ltx_text" style="font-size:90%;"> </span><math id="S3.T1.4.4.1.m1.1" class="ltx_Math" alttext="\to" display="inline"><semantics id="S3.T1.4.4.1.m1.1a"><mo mathsize="90%" stretchy="false" id="S3.T1.4.4.1.m1.1.1" xref="S3.T1.4.4.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.1.m1.1b"><ci id="S3.T1.4.4.1.m1.1.1.cmml" xref="S3.T1.4.4.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.1.m1.1c">\to</annotation></semantics></math><span id="S3.T1.4.4.1.3" class="ltx_text" style="font-size:90%;"> </span><span id="S3.T1.4.4.1.4" class="ltx_text ltx_font_italic" style="font-size:90%;">telephone</span>
</td>
</tr>
<tr id="S3.T1.5.5" class="ltx_tr">
<th id="S3.T1.5.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="3"><span id="S3.T1.5.5.2.1" class="ltx_text" style="font-size:90%;">Paraphrastic</span></th>
<td id="S3.T1.5.5.1" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">
<span id="S3.T1.5.5.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">performed in</span><span id="S3.T1.5.5.1.2" class="ltx_text" style="font-size:90%;"> </span><span id="S3.T1.5.5.1.3" class="ltx_text ltx_font_typewriter" style="font-size:90%;">[NP]</span><span id="S3.T1.5.5.1.4" class="ltx_text" style="font-size:90%;"> </span><math id="S3.T1.5.5.1.m1.1" class="ltx_Math" alttext="\to" display="inline"><semantics id="S3.T1.5.5.1.m1.1a"><mo mathsize="90%" stretchy="false" id="S3.T1.5.5.1.m1.1.1" xref="S3.T1.5.5.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.1.m1.1b"><ci id="S3.T1.5.5.1.m1.1.1.cmml" xref="S3.T1.5.5.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.1.m1.1c">\to</annotation></semantics></math><span id="S3.T1.5.5.1.5" class="ltx_text" style="font-size:90%;"> </span><span id="S3.T1.5.5.1.6" class="ltx_text ltx_font_italic" style="font-size:90%;">carried out within</span><span id="S3.T1.5.5.1.7" class="ltx_text" style="font-size:90%;"> </span><span id="S3.T1.5.5.1.8" class="ltx_text ltx_font_typewriter" style="font-size:90%;">[NP]</span>
</td>
</tr>
<tr id="S3.T1.6.6" class="ltx_tr">
<td id="S3.T1.6.6.1" class="ltx_td ltx_nopad_l ltx_align_center">
<span id="S3.T1.6.6.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">be considered</span><span id="S3.T1.6.6.1.2" class="ltx_text" style="font-size:90%;"> </span><span id="S3.T1.6.6.1.3" class="ltx_text ltx_font_typewriter" style="font-size:90%;">[NP]</span><span id="S3.T1.6.6.1.4" class="ltx_text" style="font-size:90%;"> </span><math id="S3.T1.6.6.1.m1.1" class="ltx_Math" alttext="\to" display="inline"><semantics id="S3.T1.6.6.1.m1.1a"><mo mathsize="90%" stretchy="false" id="S3.T1.6.6.1.m1.1.1" xref="S3.T1.6.6.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.1.m1.1b"><ci id="S3.T1.6.6.1.m1.1.1.cmml" xref="S3.T1.6.6.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.1.m1.1c">\to</annotation></semantics></math><span id="S3.T1.6.6.1.5" class="ltx_text" style="font-size:90%;"> </span><span id="S3.T1.6.6.1.6" class="ltx_text ltx_font_italic" style="font-size:90%;">be viewed as</span><span id="S3.T1.6.6.1.7" class="ltx_text" style="font-size:90%;"> </span><span id="S3.T1.6.6.1.8" class="ltx_text ltx_font_typewriter" style="font-size:90%;">[NP]</span>
</td>
</tr>
<tr id="S3.T1.7.7" class="ltx_tr">
<td id="S3.T1.7.7.1" class="ltx_td ltx_nopad_l ltx_align_center">
<span id="S3.T1.7.7.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">participating in</span><span id="S3.T1.7.7.1.2" class="ltx_text" style="font-size:90%;"> </span><span id="S3.T1.7.7.1.3" class="ltx_text ltx_font_typewriter" style="font-size:90%;">[VP]</span><span id="S3.T1.7.7.1.4" class="ltx_text" style="font-size:90%;"> </span><math id="S3.T1.7.7.1.m1.1" class="ltx_Math" alttext="\to" display="inline"><semantics id="S3.T1.7.7.1.m1.1a"><mo mathsize="90%" stretchy="false" id="S3.T1.7.7.1.m1.1.1" xref="S3.T1.7.7.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.1.m1.1b"><ci id="S3.T1.7.7.1.m1.1.1.cmml" xref="S3.T1.7.7.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.1.m1.1c">\to</annotation></semantics></math><span id="S3.T1.7.7.1.5" class="ltx_text" style="font-size:90%;"> </span><span id="S3.T1.7.7.1.6" class="ltx_text ltx_font_italic" style="font-size:90%;">taking part in</span><span id="S3.T1.7.7.1.7" class="ltx_text" style="font-size:90%;"> </span><span id="S3.T1.7.7.1.8" class="ltx_text ltx_font_typewriter" style="font-size:90%;">[VP]</span>
</td>
</tr>
<tr id="S3.T1.8.8" class="ltx_tr">
<th id="S3.T1.8.8.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" rowspan="3"><span id="S3.T1.8.8.2.1" class="ltx_text" style="font-size:90%;">Antonymous</span></th>
<td id="S3.T1.8.8.1" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">
<span id="S3.T1.8.8.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">open</span><span id="S3.T1.8.8.1.2" class="ltx_text" style="font-size:90%;"> </span><math id="S3.T1.8.8.1.m1.1" class="ltx_Math" alttext="\to" display="inline"><semantics id="S3.T1.8.8.1.m1.1a"><mo mathsize="90%" stretchy="false" id="S3.T1.8.8.1.m1.1.1" xref="S3.T1.8.8.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.1.m1.1b"><ci id="S3.T1.8.8.1.m1.1.1.cmml" xref="S3.T1.8.8.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.1.m1.1c">\to</annotation></semantics></math><span id="S3.T1.8.8.1.3" class="ltx_text" style="font-size:90%;"> </span><span id="S3.T1.8.8.1.4" class="ltx_text ltx_font_italic" style="font-size:90%;">closed</span>
</td>
</tr>
<tr id="S3.T1.9.9" class="ltx_tr">
<td id="S3.T1.9.9.1" class="ltx_td ltx_nopad_l ltx_align_center">
<span id="S3.T1.9.9.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">wet</span><span id="S3.T1.9.9.1.2" class="ltx_text" style="font-size:90%;"> </span><math id="S3.T1.9.9.1.m1.1" class="ltx_Math" alttext="\to" display="inline"><semantics id="S3.T1.9.9.1.m1.1a"><mo mathsize="90%" stretchy="false" id="S3.T1.9.9.1.m1.1.1" xref="S3.T1.9.9.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.1.m1.1b"><ci id="S3.T1.9.9.1.m1.1.1.cmml" xref="S3.T1.9.9.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.1.m1.1c">\to</annotation></semantics></math><span id="S3.T1.9.9.1.3" class="ltx_text" style="font-size:90%;"> </span><span id="S3.T1.9.9.1.4" class="ltx_text ltx_font_italic" style="font-size:90%;">dry</span>
</td>
</tr>
<tr id="S3.T1.10.10" class="ltx_tr">
<td id="S3.T1.10.10.1" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_bb">
<span id="S3.T1.10.10.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">full</span><span id="S3.T1.10.10.1.2" class="ltx_text" style="font-size:90%;"> </span><math id="S3.T1.10.10.1.m1.1" class="ltx_Math" alttext="\to" display="inline"><semantics id="S3.T1.10.10.1.m1.1a"><mo mathsize="90%" stretchy="false" id="S3.T1.10.10.1.m1.1.1" xref="S3.T1.10.10.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.1.m1.1b"><ci id="S3.T1.10.10.1.m1.1.1.cmml" xref="S3.T1.10.10.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.1.m1.1c">\to</annotation></semantics></math><span id="S3.T1.10.10.1.3" class="ltx_text" style="font-size:90%;"> </span><span id="S3.T1.10.10.1.4" class="ltx_text ltx_font_italic" style="font-size:90%;">empty</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1: </span>Example rules used to generate the data. Synonymous and antonymous rules are single word, while paraphrastic rules can contain multi-word expressions and grammatical constraints.</figcaption>
</figure>
<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.1" class="ltx_p"><span id="S3.SS1.p1.1.1" class="ltx_text ltx_font_bold">Substitution Extraction.</span>
We extract lexical substitution rules from the Paraphrase Database 2.0 (PPDB) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>, a lexical database containing over 100 million paraphrases automatically mined from human-written text, as well as WordNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>, two large-scale linguistic resources, and apply these rules to existing VQA v2 questions.
We create three types of perturbations:
1) <em id="S3.SS1.p1.1.2" class="ltx_emph ltx_font_italic">synonymous</em> perturbations that substitute a single word with its synonym;
2) <em id="S3.SS1.p1.1.3" class="ltx_emph ltx_font_italic">paraphrastic</em> perturbations that substitute multi-word phrases for single/multi-word phrases with the same meaning;
and 3) <em id="S3.SS1.p1.1.4" class="ltx_emph ltx_font_italic">antonymous</em> perturbations where adjectives or verbs are substituted with their antonyms, which explores the ability to understand opposite states of an attribute or action.
We extract synonymous and paraphrastic rules from the lexical and syntactic subsets of PPDB respectively, and accept the rule if the target is “equivalent” or “entailed” by the source, according to PPDB’s lexical constraints.
We gather antonymous rules from WordNet.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.1" class="ltx_p"><span id="S3.SS1.p2.1.1" class="ltx_text ltx_font_bold">Rule Refinement.</span>
We automatically determine which rules can be applied by matching the source phrases and grammar requirements to the questions, discarding rules that are not applicable to any questions.
We ensure that our rules are not simply adding unknown words by removing rules whose source or target contain words that don’t appear in the VQA vocabulary.
We filter the synonymous and paraphrastic rules with a minimum confidence threshold to prevent low quality/frequency substitutions.
Examples of these rules are shown in <span id="S3.SS1.p2.1.2" class="ltx_ERROR undefined">\tabref</span>tab:dataset_stats, where each rule is a mapping from a source to target phrase.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.1" class="ltx_p"><span id="S3.SS1.p3.1.1" class="ltx_text ltx_font_bold">Applying Substitution Rules.</span>
We apply the filtered rules to VQA v2 questions and obtain our final benchmark.
Since consistency metric requires the groundtruth annotation for the each
question, and VQA v2 testing sets do not offer publicly available answer
annotations, we use VQA v2 validation set as the basis for our benchmark.
This practice is common among methods that require per-question answer annotations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.1" class="ltx_p">During the rule application process, for each question, multiple substitutions for a specific type of perturbation can be made, which increases variations.
For antonymous rules, we perform word sense disambiguation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite> and limit their application to yes/no questions of the form “<span id="S3.SS1.p4.1.1" class="ltx_text ltx_font_italic">is/are the</span>” and “<span id="S3.SS1.p4.1.2" class="ltx_text ltx_font_italic">is/are this/these</span>” where the WordNet synsets of the source word in both the question and rule match.
Antonymous rules are limited to these kinds of questions to help ensure that we only apply the antonym substitutions to attributes/states that are directly queried (<span id="S3.SS1.p4.1.3" class="ltx_text ltx_font_slanted">e.g.,</span> “<span id="S3.SS1.p4.1.4" class="ltx_text ltx_font_italic">Is the window open?</span>”), and not simply mentioned in the question (<span id="S3.SS1.p4.1.5" class="ltx_text ltx_font_slanted">e.g.,</span> “<span id="S3.SS1.p4.1.6" class="ltx_text ltx_font_italic">What’s near the open window?</span>”).
For answers, synonymous and paraphrastic questions use the same answers as their VQA v2 counterparts as they share the same meaning and antonymous questions take the opposite answers. This results in a set of <math id="S3.SS1.p4.1.m1.2" class="ltx_Math" alttext="36,175" display="inline"><semantics id="S3.SS1.p4.1.m1.2a"><mrow id="S3.SS1.p4.1.m1.2.3.2" xref="S3.SS1.p4.1.m1.2.3.1.cmml"><mn id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">36</mn><mo id="S3.SS1.p4.1.m1.2.3.2.1" xref="S3.SS1.p4.1.m1.2.3.1.cmml">,</mo><mn id="S3.SS1.p4.1.m1.2.2" xref="S3.SS1.p4.1.m1.2.2.cmml">175</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.2b"><list id="S3.SS1.p4.1.m1.2.3.1.cmml" xref="S3.SS1.p4.1.m1.2.3.2"><cn type="integer" id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">36</cn><cn type="integer" id="S3.SS1.p4.1.m1.2.2.cmml" xref="S3.SS1.p4.1.m1.2.2">175</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.2c">36,175</annotation></semantics></math> question-answer pairs that are perturbed counterparts of VQA v2 validation questions.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2011.13406/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="362" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.3.2" class="ltx_text" style="font-size:90%;">Examples of VQA P2, human generated <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>, and back-translated (Auto-Generation) variants (P) of input questions (O). VQA P2 uniquely offers three types of controlled linguistic variations to benchmark robustness.</span></figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Comparison to Other Paraphrasing Methods</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Two main alternative methods for generating paraphrases of questions are human annotations and generative approaches.
<span id="S3.SS2.p1.1.1" class="ltx_ERROR undefined">\figref</span>fig:compare shows a few examples from human-written paraphrased VQA questions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> and auto-generated paraphrases using back-translation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>.
When primed with the original question, human annotators tend to give paraphrases that are longer than the original question, with a large percentage of these simply adding filler phrases that do not change the original sentence by much.
For example, in the first human-written example in <span id="S3.SS2.p1.1.2" class="ltx_ERROR undefined">\figref</span>fig:compare, the original question is essentially still preserved within the paraphrased version.
Additionally, human paraphrases can introduce multiple sources of variations, such as introducing commonsense related items, sentence structural changes as well as lexical alterations.
Consequently, using human-written paraphrases as a diagnostic benchmark lacks a level of precision needed to diagnose and understand model performance.
On the other hand, automated methods like back-translation suffer from many quality control issues.
<span id="S3.SS2.p1.1.3" class="ltx_ERROR undefined">\figref</span>fig:compare shows how this method frequently generates mismatched phrasal replacement or semantic drift, where the generated questions no longer hold the same meaning.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">In contrast, our benchmark has built-in quality control as the replacement rules extracted from linguistic resources correlate well with human judgements <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> and are generally reliable.
We target at linguistic perturbations to factor out other sources of variations when diagnosing models.
Our dataset offers control over the kinds of perturbations used and allows for more precise evaluation of model consistency, meaning we can evaluate a model’s capacity for addressing specific types of perturbations offering more diagnostic insight.
Additionally, due to the fast, automated nature of this process, our dataset is easily extensible to more linguistic variations and larger sets of perturbations.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Approach</h2>

<figure id="S4.F3" class="ltx_figure">
<table id="S4.F3.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.F3.2.2" class="ltx_tr">
<td id="S4.F3.1.1.1" class="ltx_td ltx_align_center"><img src="/html/2011.13406/assets/x3.png" id="S4.F3.1.1.1.g1" class="ltx_graphics ltx_img_portrait" width="82" height="125" alt="Refer to caption"></td>
<td id="S4.F3.2.2.2" class="ltx_td ltx_align_center"> <img src="/html/2011.13406/assets/x4.png" id="S4.F3.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="281" height="126" alt="Refer to caption">
</td>
<td id="S4.F3.2.2.3" class="ltx_td"></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.4.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S4.F3.5.2" class="ltx_text" style="font-size:90%;">We propose a novel Q3R framework that improves the robustness of VQA models against linguistic variations by augmenting questions and encouraging similar module weights between related questions.</span></figcaption>
</figure>
<div id="S4.p1" class="ltx_para">
<p id="S4.p1.2" class="ltx_p">Given an image-question pair, <math id="S4.p1.1.m1.2" class="ltx_Math" alttext="(I,Q)" display="inline"><semantics id="S4.p1.1.m1.2a"><mrow id="S4.p1.1.m1.2.3.2" xref="S4.p1.1.m1.2.3.1.cmml"><mo stretchy="false" id="S4.p1.1.m1.2.3.2.1" xref="S4.p1.1.m1.2.3.1.cmml">(</mo><mi id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">I</mi><mo id="S4.p1.1.m1.2.3.2.2" xref="S4.p1.1.m1.2.3.1.cmml">,</mo><mi id="S4.p1.1.m1.2.2" xref="S4.p1.1.m1.2.2.cmml">Q</mi><mo stretchy="false" id="S4.p1.1.m1.2.3.2.3" xref="S4.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.2b"><interval closure="open" id="S4.p1.1.m1.2.3.1.cmml" xref="S4.p1.1.m1.2.3.2"><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">𝐼</ci><ci id="S4.p1.1.m1.2.2.cmml" xref="S4.p1.1.m1.2.2">𝑄</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.2c">(I,Q)</annotation></semantics></math>,
a VQA model maps the pair to a distribution over an answer set,
<math id="S4.p1.2.m2.2" class="ltx_Math" alttext="f(I,Q)\rightarrow\mathbf{a}" display="inline"><semantics id="S4.p1.2.m2.2a"><mrow id="S4.p1.2.m2.2.3" xref="S4.p1.2.m2.2.3.cmml"><mrow id="S4.p1.2.m2.2.3.2" xref="S4.p1.2.m2.2.3.2.cmml"><mi id="S4.p1.2.m2.2.3.2.2" xref="S4.p1.2.m2.2.3.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.p1.2.m2.2.3.2.1" xref="S4.p1.2.m2.2.3.2.1.cmml">​</mo><mrow id="S4.p1.2.m2.2.3.2.3.2" xref="S4.p1.2.m2.2.3.2.3.1.cmml"><mo stretchy="false" id="S4.p1.2.m2.2.3.2.3.2.1" xref="S4.p1.2.m2.2.3.2.3.1.cmml">(</mo><mi id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">I</mi><mo id="S4.p1.2.m2.2.3.2.3.2.2" xref="S4.p1.2.m2.2.3.2.3.1.cmml">,</mo><mi id="S4.p1.2.m2.2.2" xref="S4.p1.2.m2.2.2.cmml">Q</mi><mo stretchy="false" id="S4.p1.2.m2.2.3.2.3.2.3" xref="S4.p1.2.m2.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.p1.2.m2.2.3.1" xref="S4.p1.2.m2.2.3.1.cmml">→</mo><mi id="S4.p1.2.m2.2.3.3" xref="S4.p1.2.m2.2.3.3.cmml">𝐚</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.2b"><apply id="S4.p1.2.m2.2.3.cmml" xref="S4.p1.2.m2.2.3"><ci id="S4.p1.2.m2.2.3.1.cmml" xref="S4.p1.2.m2.2.3.1">→</ci><apply id="S4.p1.2.m2.2.3.2.cmml" xref="S4.p1.2.m2.2.3.2"><times id="S4.p1.2.m2.2.3.2.1.cmml" xref="S4.p1.2.m2.2.3.2.1"></times><ci id="S4.p1.2.m2.2.3.2.2.cmml" xref="S4.p1.2.m2.2.3.2.2">𝑓</ci><interval closure="open" id="S4.p1.2.m2.2.3.2.3.1.cmml" xref="S4.p1.2.m2.2.3.2.3.2"><ci id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">𝐼</ci><ci id="S4.p1.2.m2.2.2.cmml" xref="S4.p1.2.m2.2.2">𝑄</ci></interval></apply><ci id="S4.p1.2.m2.2.3.3.cmml" xref="S4.p1.2.m2.2.3.3">𝐚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.2c">f(I,Q)\rightarrow\mathbf{a}</annotation></semantics></math>. Existing approaches most often treat this as a classification task, minimizing the prediction loss between the predicted answer and the ground truth answer.
This standard approach, however, does not take into account possible relations among questions.
The goal of our approach is to train a model to be aware of question relationships, and thereby learn to be more consistent when answering.</p>
</div>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.1" class="ltx_p"><span id="S4.p2.1.1" class="ltx_text ltx_font_bold">Modeling Question Relatedness.</span>
Typically, given an input question, a predictable set of reasoning steps are expected to answer the question.
For example, in <span id="S4.p2.1.2" class="ltx_ERROR undefined">\figref</span>fig:intuition, the sub-networks which can answer “<span id="S4.p2.1.3" class="ltx_text ltx_font_italic">Which country’s flag <span id="S4.p2.1.3.1" class="ltx_text ltx_framed ltx_framed_underline">is displayed</span> behind the TV?</span>” should be able to decompose this task into components such as “<span id="S4.p2.1.4" class="ltx_text ltx_font_typewriter">Find</span>(<span id="S4.p2.1.5" class="ltx_text ltx_font_italic">TV</span>)”, “<span id="S4.p2.1.6" class="ltx_text ltx_font_typewriter">Transform</span>(<span id="S4.p2.1.7" class="ltx_text ltx_font_italic">Behind</span>)”, and “<span id="S4.p2.1.8" class="ltx_text ltx_font_typewriter">Describe</span>(<span id="S4.p2.1.9" class="ltx_text ltx_font_italic">which country’s flag</span>)” and learn to transfer all sub-networks to the question: “<span id="S4.p2.1.10" class="ltx_text ltx_font_italic">Which country’s flag <span id="S4.p2.1.10.1" class="ltx_text ltx_framed ltx_framed_underline">appears</span> behind the TV?</span>”
Essentially, there should be a set of elementary operations where each one solves a less complex task than the original question and related questions can share these operations, following a similar order of execution.
Based on this intuition, we propose our <span id="S4.p2.1.11" class="ltx_text ltx_font_bold">Question-Relatedness Regularized Reasoning</span> (<span id="S4.p2.1.12" class="ltx_text ltx_font_bold">Q3R</span>) framework.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Q3R Framework</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">Our framework is comprised of three components: 1) a method to create linguistic variations
of input questions; 2) a compositional backbone model, guided by question-based
module selection; and 3) a mechanism to enforce similarities of
related questions at the module level.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2011.13406/assets/x5.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="182" height="92" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S4.F4.3.2" class="ltx_text" style="font-size:90%;">Illustration of the backbone model.</span></figcaption>
</figure>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.8" class="ltx_p"><span id="S4.SS1.p2.8.1" class="ltx_text ltx_font_bold">Creating Related Questions.</span>
The input to our pipeline is an image-question pair, <math id="S4.SS1.p2.1.m1.2" class="ltx_Math" alttext="(I,Q)" display="inline"><semantics id="S4.SS1.p2.1.m1.2a"><mrow id="S4.SS1.p2.1.m1.2.3.2" xref="S4.SS1.p2.1.m1.2.3.1.cmml"><mo stretchy="false" id="S4.SS1.p2.1.m1.2.3.2.1" xref="S4.SS1.p2.1.m1.2.3.1.cmml">(</mo><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">I</mi><mo id="S4.SS1.p2.1.m1.2.3.2.2" xref="S4.SS1.p2.1.m1.2.3.1.cmml">,</mo><mi id="S4.SS1.p2.1.m1.2.2" xref="S4.SS1.p2.1.m1.2.2.cmml">Q</mi><mo stretchy="false" id="S4.SS1.p2.1.m1.2.3.2.3" xref="S4.SS1.p2.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.2b"><interval closure="open" id="S4.SS1.p2.1.m1.2.3.1.cmml" xref="S4.SS1.p2.1.m1.2.3.2"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝐼</ci><ci id="S4.SS1.p2.1.m1.2.2.cmml" xref="S4.SS1.p2.1.m1.2.2">𝑄</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.2c">(I,Q)</annotation></semantics></math>, and, during training, a corresponding answer <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">A</annotation></semantics></math>.
We create a module, <math id="S4.SS1.p2.3.m3.4" class="ltx_Math" alttext="g(Q,A)\rightarrow(\tilde{Q},\tilde{A})" display="inline"><semantics id="S4.SS1.p2.3.m3.4a"><mrow id="S4.SS1.p2.3.m3.4.5" xref="S4.SS1.p2.3.m3.4.5.cmml"><mrow id="S4.SS1.p2.3.m3.4.5.2" xref="S4.SS1.p2.3.m3.4.5.2.cmml"><mi id="S4.SS1.p2.3.m3.4.5.2.2" xref="S4.SS1.p2.3.m3.4.5.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.3.m3.4.5.2.1" xref="S4.SS1.p2.3.m3.4.5.2.1.cmml">​</mo><mrow id="S4.SS1.p2.3.m3.4.5.2.3.2" xref="S4.SS1.p2.3.m3.4.5.2.3.1.cmml"><mo stretchy="false" id="S4.SS1.p2.3.m3.4.5.2.3.2.1" xref="S4.SS1.p2.3.m3.4.5.2.3.1.cmml">(</mo><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">Q</mi><mo id="S4.SS1.p2.3.m3.4.5.2.3.2.2" xref="S4.SS1.p2.3.m3.4.5.2.3.1.cmml">,</mo><mi id="S4.SS1.p2.3.m3.2.2" xref="S4.SS1.p2.3.m3.2.2.cmml">A</mi><mo stretchy="false" id="S4.SS1.p2.3.m3.4.5.2.3.2.3" xref="S4.SS1.p2.3.m3.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS1.p2.3.m3.4.5.1" xref="S4.SS1.p2.3.m3.4.5.1.cmml">→</mo><mrow id="S4.SS1.p2.3.m3.4.5.3.2" xref="S4.SS1.p2.3.m3.4.5.3.1.cmml"><mo stretchy="false" id="S4.SS1.p2.3.m3.4.5.3.2.1" xref="S4.SS1.p2.3.m3.4.5.3.1.cmml">(</mo><mover accent="true" id="S4.SS1.p2.3.m3.3.3" xref="S4.SS1.p2.3.m3.3.3.cmml"><mi id="S4.SS1.p2.3.m3.3.3.2" xref="S4.SS1.p2.3.m3.3.3.2.cmml">Q</mi><mo id="S4.SS1.p2.3.m3.3.3.1" xref="S4.SS1.p2.3.m3.3.3.1.cmml">~</mo></mover><mo id="S4.SS1.p2.3.m3.4.5.3.2.2" xref="S4.SS1.p2.3.m3.4.5.3.1.cmml">,</mo><mover accent="true" id="S4.SS1.p2.3.m3.4.4" xref="S4.SS1.p2.3.m3.4.4.cmml"><mi id="S4.SS1.p2.3.m3.4.4.2" xref="S4.SS1.p2.3.m3.4.4.2.cmml">A</mi><mo id="S4.SS1.p2.3.m3.4.4.1" xref="S4.SS1.p2.3.m3.4.4.1.cmml">~</mo></mover><mo stretchy="false" id="S4.SS1.p2.3.m3.4.5.3.2.3" xref="S4.SS1.p2.3.m3.4.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.4b"><apply id="S4.SS1.p2.3.m3.4.5.cmml" xref="S4.SS1.p2.3.m3.4.5"><ci id="S4.SS1.p2.3.m3.4.5.1.cmml" xref="S4.SS1.p2.3.m3.4.5.1">→</ci><apply id="S4.SS1.p2.3.m3.4.5.2.cmml" xref="S4.SS1.p2.3.m3.4.5.2"><times id="S4.SS1.p2.3.m3.4.5.2.1.cmml" xref="S4.SS1.p2.3.m3.4.5.2.1"></times><ci id="S4.SS1.p2.3.m3.4.5.2.2.cmml" xref="S4.SS1.p2.3.m3.4.5.2.2">𝑔</ci><interval closure="open" id="S4.SS1.p2.3.m3.4.5.2.3.1.cmml" xref="S4.SS1.p2.3.m3.4.5.2.3.2"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝑄</ci><ci id="S4.SS1.p2.3.m3.2.2.cmml" xref="S4.SS1.p2.3.m3.2.2">𝐴</ci></interval></apply><interval closure="open" id="S4.SS1.p2.3.m3.4.5.3.1.cmml" xref="S4.SS1.p2.3.m3.4.5.3.2"><apply id="S4.SS1.p2.3.m3.3.3.cmml" xref="S4.SS1.p2.3.m3.3.3"><ci id="S4.SS1.p2.3.m3.3.3.1.cmml" xref="S4.SS1.p2.3.m3.3.3.1">~</ci><ci id="S4.SS1.p2.3.m3.3.3.2.cmml" xref="S4.SS1.p2.3.m3.3.3.2">𝑄</ci></apply><apply id="S4.SS1.p2.3.m3.4.4.cmml" xref="S4.SS1.p2.3.m3.4.4"><ci id="S4.SS1.p2.3.m3.4.4.1.cmml" xref="S4.SS1.p2.3.m3.4.4.1">~</ci><ci id="S4.SS1.p2.3.m3.4.4.2.cmml" xref="S4.SS1.p2.3.m3.4.4.2">𝐴</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.4c">g(Q,A)\rightarrow(\tilde{Q},\tilde{A})</annotation></semantics></math>, that takes <math id="S4.SS1.p2.4.m4.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S4.SS1.p2.4.m4.1a"><mi id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><ci id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">Q</annotation></semantics></math> and <math id="S4.SS1.p2.5.m5.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S4.SS1.p2.5.m5.1a"><mi id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><ci id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">A</annotation></semantics></math> as input and outputs a related question-answer pair <math id="S4.SS1.p2.6.m6.2" class="ltx_Math" alttext="(\tilde{Q},\tilde{A})" display="inline"><semantics id="S4.SS1.p2.6.m6.2a"><mrow id="S4.SS1.p2.6.m6.2.3.2" xref="S4.SS1.p2.6.m6.2.3.1.cmml"><mo stretchy="false" id="S4.SS1.p2.6.m6.2.3.2.1" xref="S4.SS1.p2.6.m6.2.3.1.cmml">(</mo><mover accent="true" id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml"><mi id="S4.SS1.p2.6.m6.1.1.2" xref="S4.SS1.p2.6.m6.1.1.2.cmml">Q</mi><mo id="S4.SS1.p2.6.m6.1.1.1" xref="S4.SS1.p2.6.m6.1.1.1.cmml">~</mo></mover><mo id="S4.SS1.p2.6.m6.2.3.2.2" xref="S4.SS1.p2.6.m6.2.3.1.cmml">,</mo><mover accent="true" id="S4.SS1.p2.6.m6.2.2" xref="S4.SS1.p2.6.m6.2.2.cmml"><mi id="S4.SS1.p2.6.m6.2.2.2" xref="S4.SS1.p2.6.m6.2.2.2.cmml">A</mi><mo id="S4.SS1.p2.6.m6.2.2.1" xref="S4.SS1.p2.6.m6.2.2.1.cmml">~</mo></mover><mo stretchy="false" id="S4.SS1.p2.6.m6.2.3.2.3" xref="S4.SS1.p2.6.m6.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.2b"><interval closure="open" id="S4.SS1.p2.6.m6.2.3.1.cmml" xref="S4.SS1.p2.6.m6.2.3.2"><apply id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1"><ci id="S4.SS1.p2.6.m6.1.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1.1">~</ci><ci id="S4.SS1.p2.6.m6.1.1.2.cmml" xref="S4.SS1.p2.6.m6.1.1.2">𝑄</ci></apply><apply id="S4.SS1.p2.6.m6.2.2.cmml" xref="S4.SS1.p2.6.m6.2.2"><ci id="S4.SS1.p2.6.m6.2.2.1.cmml" xref="S4.SS1.p2.6.m6.2.2.1">~</ci><ci id="S4.SS1.p2.6.m6.2.2.2.cmml" xref="S4.SS1.p2.6.m6.2.2.2">𝐴</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.2c">(\tilde{Q},\tilde{A})</annotation></semantics></math>.
In practice, any approach that can create linguistic variants of a given question-answer pair can be applied here.
For example, one can use generative models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite> to augment questions.
Although this data is typically too noisy for benchmarking purpose, it can provide additional data for training.
In this work, we simply use the rules provided by VQA P2 to create linguistic substitutions, making <math id="S4.SS1.p2.7.m7.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S4.SS1.p2.7.m7.1a"><mi id="S4.SS1.p2.7.m7.1.1" xref="S4.SS1.p2.7.m7.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m7.1b"><ci id="S4.SS1.p2.7.m7.1.1.cmml" xref="S4.SS1.p2.7.m7.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m7.1c">g</annotation></semantics></math> a function of the perturbation type, <math id="S4.SS1.p2.8.m8.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS1.p2.8.m8.1a"><mi id="S4.SS1.p2.8.m8.1.1" xref="S4.SS1.p2.8.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m8.1b"><ci id="S4.SS1.p2.8.m8.1.1.cmml" xref="S4.SS1.p2.8.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m8.1c">t</annotation></semantics></math>, as well.
In future work, we will explore combinations of rule-based paraphrases and generative methods.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.6" class="ltx_p"><span id="S4.SS1.p3.6.1" class="ltx_text ltx_font_bold">Backbone Model.</span>
Our backbone model is comprised of input encoders, a controller network, and a set of re-usable modules, <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">\mathcal{M}</annotation></semantics></math>. The input encoders compute a set of visual and textual features for <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><mi id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><ci id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">I</annotation></semantics></math> and <math id="S4.SS1.p3.3.m3.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S4.SS1.p3.3.m3.1a"><mi id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><ci id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">Q</annotation></semantics></math>, respectively.
As shown in <span id="S4.SS1.p3.6.2" class="ltx_ERROR undefined">\figref</span>fig:nmn_arch, the controller is responsible for decomposing the reasoning process into a sequence of steps that are executed by the network.
At each step, <math id="S4.SS1.p3.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS1.p3.4.m4.1a"><mi id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><ci id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">t</annotation></semantics></math>, the controller reads the question and, based on this question, produces module weights, <math id="S4.SS1.p3.5.m5.2" class="ltx_Math" alttext="w^{(t)}\in\mathbb{R}^{|\mathcal{M}|}" display="inline"><semantics id="S4.SS1.p3.5.m5.2a"><mrow id="S4.SS1.p3.5.m5.2.3" xref="S4.SS1.p3.5.m5.2.3.cmml"><msup id="S4.SS1.p3.5.m5.2.3.2" xref="S4.SS1.p3.5.m5.2.3.2.cmml"><mi id="S4.SS1.p3.5.m5.2.3.2.2" xref="S4.SS1.p3.5.m5.2.3.2.2.cmml">w</mi><mrow id="S4.SS1.p3.5.m5.1.1.1.3" xref="S4.SS1.p3.5.m5.2.3.2.cmml"><mo stretchy="false" id="S4.SS1.p3.5.m5.1.1.1.3.1" xref="S4.SS1.p3.5.m5.2.3.2.cmml">(</mo><mi id="S4.SS1.p3.5.m5.1.1.1.1" xref="S4.SS1.p3.5.m5.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S4.SS1.p3.5.m5.1.1.1.3.2" xref="S4.SS1.p3.5.m5.2.3.2.cmml">)</mo></mrow></msup><mo id="S4.SS1.p3.5.m5.2.3.1" xref="S4.SS1.p3.5.m5.2.3.1.cmml">∈</mo><msup id="S4.SS1.p3.5.m5.2.3.3" xref="S4.SS1.p3.5.m5.2.3.3.cmml"><mi id="S4.SS1.p3.5.m5.2.3.3.2" xref="S4.SS1.p3.5.m5.2.3.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p3.5.m5.2.2.1.3" xref="S4.SS1.p3.5.m5.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS1.p3.5.m5.2.2.1.3.1" xref="S4.SS1.p3.5.m5.2.2.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.5.m5.2.2.1.1" xref="S4.SS1.p3.5.m5.2.2.1.1.cmml">ℳ</mi><mo stretchy="false" id="S4.SS1.p3.5.m5.2.2.1.3.2" xref="S4.SS1.p3.5.m5.2.2.1.2.1.cmml">|</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.2b"><apply id="S4.SS1.p3.5.m5.2.3.cmml" xref="S4.SS1.p3.5.m5.2.3"><in id="S4.SS1.p3.5.m5.2.3.1.cmml" xref="S4.SS1.p3.5.m5.2.3.1"></in><apply id="S4.SS1.p3.5.m5.2.3.2.cmml" xref="S4.SS1.p3.5.m5.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m5.2.3.2.1.cmml" xref="S4.SS1.p3.5.m5.2.3.2">superscript</csymbol><ci id="S4.SS1.p3.5.m5.2.3.2.2.cmml" xref="S4.SS1.p3.5.m5.2.3.2.2">𝑤</ci><ci id="S4.SS1.p3.5.m5.1.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1">𝑡</ci></apply><apply id="S4.SS1.p3.5.m5.2.3.3.cmml" xref="S4.SS1.p3.5.m5.2.3.3"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m5.2.3.3.1.cmml" xref="S4.SS1.p3.5.m5.2.3.3">superscript</csymbol><ci id="S4.SS1.p3.5.m5.2.3.3.2.cmml" xref="S4.SS1.p3.5.m5.2.3.3.2">ℝ</ci><apply id="S4.SS1.p3.5.m5.2.2.1.2.cmml" xref="S4.SS1.p3.5.m5.2.2.1.3"><abs id="S4.SS1.p3.5.m5.2.2.1.2.1.cmml" xref="S4.SS1.p3.5.m5.2.2.1.3.1"></abs><ci id="S4.SS1.p3.5.m5.2.2.1.1.cmml" xref="S4.SS1.p3.5.m5.2.2.1.1">ℳ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.2c">w^{(t)}\in\mathbb{R}^{|\mathcal{M}|}</annotation></semantics></math>, which are used for module selection, as well as a textual parameter, <math id="S4.SS1.p3.6.m6.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="S4.SS1.p3.6.m6.1a"><msub id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml"><mi id="S4.SS1.p3.6.m6.1.1.2" xref="S4.SS1.p3.6.m6.1.1.2.cmml">c</mi><mi id="S4.SS1.p3.6.m6.1.1.3" xref="S4.SS1.p3.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.1b"><apply id="S4.SS1.p3.6.m6.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.6.m6.1.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.p3.6.m6.1.1.2.cmml" xref="S4.SS1.p3.6.m6.1.1.2">𝑐</ci><ci id="S4.SS1.p3.6.m6.1.1.3.cmml" xref="S4.SS1.p3.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.1c">c_{t}</annotation></semantics></math>, which
is an input to the modules.
In this formulation, module selection is essentially an attention over the module outputs, which allows for end-to-end training.
The sequence of weights over all reasoning steps represents a soft layout that specifies what modules are utilized at each step.
The modules implement different sub-tasks that the model has at its disposal during reasoning.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.1" class="ltx_p">Our framework is agnostic to the specific designs of the components of the backbone
network and can work within the general controller-module framework. We therefore select
two state-of-the-art compositional models to instantiate our backbone, specifically,
<span id="S4.SS1.p4.1.1" class="ltx_text ltx_font_bold">StackNMN</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, and <span id="S4.SS1.p4.1.2" class="ltx_text ltx_font_bold">XNM</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>. To
verify that our training scheme is not tied to either one of the network, we also present
a new model by adopting modules from both networks, called <span id="S4.SS1.p4.1.3" class="ltx_text ltx_font_bold">HybridNet</span>.
More architectural details are in Appendix <a href="#A4" title="Appendix D Model Details ‣ Learning from Lexical Perturbations for Consistent Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></a>.</p>
</div>
<div id="S4.SS1.p5" class="ltx_para ltx_noindent">
<p id="S4.SS1.p5.1" class="ltx_p"><span id="S4.SS1.p5.1.1" class="ltx_text ltx_font_bold">Regularization Method.</span>

We propose to regularize the training of the backbone compositional model to improve its consistency and robustness against linguistic variations at the module level.
Controlling and regularizing question relatedness at the module level offers
several benefits.
First, it provides finer control of the model’s active sub-networks than only using supervision at the output layer.
Second, the related question pairs share intermediate activation similarity but do not necessarily need to match one another at a lower level (<span id="S4.SS1.p5.1.2" class="ltx_text ltx_font_slanted">e.g.,</span> attention maps within modules), making the model less sensitive to surface-level sentence variation.</p>
</div>
<div id="S4.SS1.p6" class="ltx_para">
<p id="S4.SS1.p6.5" class="ltx_p">Given an image, <math id="S4.SS1.p6.1.m1.1" class="ltx_Math" alttext="I_{j}" display="inline"><semantics id="S4.SS1.p6.1.m1.1a"><msub id="S4.SS1.p6.1.m1.1.1" xref="S4.SS1.p6.1.m1.1.1.cmml"><mi id="S4.SS1.p6.1.m1.1.1.2" xref="S4.SS1.p6.1.m1.1.1.2.cmml">I</mi><mi id="S4.SS1.p6.1.m1.1.1.3" xref="S4.SS1.p6.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.1.m1.1b"><apply id="S4.SS1.p6.1.m1.1.1.cmml" xref="S4.SS1.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p6.1.m1.1.1.1.cmml" xref="S4.SS1.p6.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p6.1.m1.1.1.2.cmml" xref="S4.SS1.p6.1.m1.1.1.2">𝐼</ci><ci id="S4.SS1.p6.1.m1.1.1.3.cmml" xref="S4.SS1.p6.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.1.m1.1c">I_{j}</annotation></semantics></math>, as well as a pairing of an original question, <math id="S4.SS1.p6.2.m2.1" class="ltx_Math" alttext="Q_{j}" display="inline"><semantics id="S4.SS1.p6.2.m2.1a"><msub id="S4.SS1.p6.2.m2.1.1" xref="S4.SS1.p6.2.m2.1.1.cmml"><mi id="S4.SS1.p6.2.m2.1.1.2" xref="S4.SS1.p6.2.m2.1.1.2.cmml">Q</mi><mi id="S4.SS1.p6.2.m2.1.1.3" xref="S4.SS1.p6.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.2.m2.1b"><apply id="S4.SS1.p6.2.m2.1.1.cmml" xref="S4.SS1.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p6.2.m2.1.1.1.cmml" xref="S4.SS1.p6.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p6.2.m2.1.1.2.cmml" xref="S4.SS1.p6.2.m2.1.1.2">𝑄</ci><ci id="S4.SS1.p6.2.m2.1.1.3.cmml" xref="S4.SS1.p6.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.2.m2.1c">Q_{j}</annotation></semantics></math>, and its perturbed version, <math id="S4.SS1.p6.3.m3.1" class="ltx_Math" alttext="\tilde{Q}_{j}" display="inline"><semantics id="S4.SS1.p6.3.m3.1a"><msub id="S4.SS1.p6.3.m3.1.1" xref="S4.SS1.p6.3.m3.1.1.cmml"><mover accent="true" id="S4.SS1.p6.3.m3.1.1.2" xref="S4.SS1.p6.3.m3.1.1.2.cmml"><mi id="S4.SS1.p6.3.m3.1.1.2.2" xref="S4.SS1.p6.3.m3.1.1.2.2.cmml">Q</mi><mo id="S4.SS1.p6.3.m3.1.1.2.1" xref="S4.SS1.p6.3.m3.1.1.2.1.cmml">~</mo></mover><mi id="S4.SS1.p6.3.m3.1.1.3" xref="S4.SS1.p6.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.3.m3.1b"><apply id="S4.SS1.p6.3.m3.1.1.cmml" xref="S4.SS1.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p6.3.m3.1.1.1.cmml" xref="S4.SS1.p6.3.m3.1.1">subscript</csymbol><apply id="S4.SS1.p6.3.m3.1.1.2.cmml" xref="S4.SS1.p6.3.m3.1.1.2"><ci id="S4.SS1.p6.3.m3.1.1.2.1.cmml" xref="S4.SS1.p6.3.m3.1.1.2.1">~</ci><ci id="S4.SS1.p6.3.m3.1.1.2.2.cmml" xref="S4.SS1.p6.3.m3.1.1.2.2">𝑄</ci></apply><ci id="S4.SS1.p6.3.m3.1.1.3.cmml" xref="S4.SS1.p6.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.3.m3.1c">\tilde{Q}_{j}</annotation></semantics></math>, the controller maps
each question to a set of module weights at each reasoning step, <math id="S4.SS1.p6.4.m4.1" class="ltx_Math" alttext="w_{j}^{(t)}" display="inline"><semantics id="S4.SS1.p6.4.m4.1a"><msubsup id="S4.SS1.p6.4.m4.1.2" xref="S4.SS1.p6.4.m4.1.2.cmml"><mi id="S4.SS1.p6.4.m4.1.2.2.2" xref="S4.SS1.p6.4.m4.1.2.2.2.cmml">w</mi><mi id="S4.SS1.p6.4.m4.1.2.2.3" xref="S4.SS1.p6.4.m4.1.2.2.3.cmml">j</mi><mrow id="S4.SS1.p6.4.m4.1.1.1.3" xref="S4.SS1.p6.4.m4.1.2.cmml"><mo stretchy="false" id="S4.SS1.p6.4.m4.1.1.1.3.1" xref="S4.SS1.p6.4.m4.1.2.cmml">(</mo><mi id="S4.SS1.p6.4.m4.1.1.1.1" xref="S4.SS1.p6.4.m4.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S4.SS1.p6.4.m4.1.1.1.3.2" xref="S4.SS1.p6.4.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.4.m4.1b"><apply id="S4.SS1.p6.4.m4.1.2.cmml" xref="S4.SS1.p6.4.m4.1.2"><csymbol cd="ambiguous" id="S4.SS1.p6.4.m4.1.2.1.cmml" xref="S4.SS1.p6.4.m4.1.2">superscript</csymbol><apply id="S4.SS1.p6.4.m4.1.2.2.cmml" xref="S4.SS1.p6.4.m4.1.2"><csymbol cd="ambiguous" id="S4.SS1.p6.4.m4.1.2.2.1.cmml" xref="S4.SS1.p6.4.m4.1.2">subscript</csymbol><ci id="S4.SS1.p6.4.m4.1.2.2.2.cmml" xref="S4.SS1.p6.4.m4.1.2.2.2">𝑤</ci><ci id="S4.SS1.p6.4.m4.1.2.2.3.cmml" xref="S4.SS1.p6.4.m4.1.2.2.3">𝑗</ci></apply><ci id="S4.SS1.p6.4.m4.1.1.1.1.cmml" xref="S4.SS1.p6.4.m4.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.4.m4.1c">w_{j}^{(t)}</annotation></semantics></math> and <math id="S4.SS1.p6.5.m5.1" class="ltx_Math" alttext="\tilde{w}_{j}^{(t)}" display="inline"><semantics id="S4.SS1.p6.5.m5.1a"><msubsup id="S4.SS1.p6.5.m5.1.2" xref="S4.SS1.p6.5.m5.1.2.cmml"><mover accent="true" id="S4.SS1.p6.5.m5.1.2.2.2" xref="S4.SS1.p6.5.m5.1.2.2.2.cmml"><mi id="S4.SS1.p6.5.m5.1.2.2.2.2" xref="S4.SS1.p6.5.m5.1.2.2.2.2.cmml">w</mi><mo id="S4.SS1.p6.5.m5.1.2.2.2.1" xref="S4.SS1.p6.5.m5.1.2.2.2.1.cmml">~</mo></mover><mi id="S4.SS1.p6.5.m5.1.2.2.3" xref="S4.SS1.p6.5.m5.1.2.2.3.cmml">j</mi><mrow id="S4.SS1.p6.5.m5.1.1.1.3" xref="S4.SS1.p6.5.m5.1.2.cmml"><mo stretchy="false" id="S4.SS1.p6.5.m5.1.1.1.3.1" xref="S4.SS1.p6.5.m5.1.2.cmml">(</mo><mi id="S4.SS1.p6.5.m5.1.1.1.1" xref="S4.SS1.p6.5.m5.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S4.SS1.p6.5.m5.1.1.1.3.2" xref="S4.SS1.p6.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.5.m5.1b"><apply id="S4.SS1.p6.5.m5.1.2.cmml" xref="S4.SS1.p6.5.m5.1.2"><csymbol cd="ambiguous" id="S4.SS1.p6.5.m5.1.2.1.cmml" xref="S4.SS1.p6.5.m5.1.2">superscript</csymbol><apply id="S4.SS1.p6.5.m5.1.2.2.cmml" xref="S4.SS1.p6.5.m5.1.2"><csymbol cd="ambiguous" id="S4.SS1.p6.5.m5.1.2.2.1.cmml" xref="S4.SS1.p6.5.m5.1.2">subscript</csymbol><apply id="S4.SS1.p6.5.m5.1.2.2.2.cmml" xref="S4.SS1.p6.5.m5.1.2.2.2"><ci id="S4.SS1.p6.5.m5.1.2.2.2.1.cmml" xref="S4.SS1.p6.5.m5.1.2.2.2.1">~</ci><ci id="S4.SS1.p6.5.m5.1.2.2.2.2.cmml" xref="S4.SS1.p6.5.m5.1.2.2.2.2">𝑤</ci></apply><ci id="S4.SS1.p6.5.m5.1.2.2.3.cmml" xref="S4.SS1.p6.5.m5.1.2.2.3">𝑗</ci></apply><ci id="S4.SS1.p6.5.m5.1.1.1.1.cmml" xref="S4.SS1.p6.5.m5.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.5.m5.1c">\tilde{w}_{j}^{(t)}</annotation></semantics></math>, respectively.
Across all reasoning steps, these module weights can be interpreted as selecting “paths” over the grid of all modules across all time steps, especially when the weights are computed with Gumbel softmax <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> as done with XNM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>.
Ideally, if two questions agree on the basic sub-tasks, they should also agree on the activated module paths (as in <span id="S4.SS1.p6.5.1" class="ltx_ERROR undefined">\figref</span>fig:intuition).
Thus, we define the regularization loss term as:</p>
<table id="A5.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E1.m1.3" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{m}(Q_{j},\tilde{Q}_{j},I_{j})" display="inline"><semantics id="S4.E1.m1.3a"><mrow id="S4.E1.m1.3.3" xref="S4.E1.m1.3.3.cmml"><msub id="S4.E1.m1.3.3.5" xref="S4.E1.m1.3.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.3.3.5.2" xref="S4.E1.m1.3.3.5.2.cmml">ℒ</mi><mi id="S4.E1.m1.3.3.5.3" xref="S4.E1.m1.3.3.5.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.3.3.4" xref="S4.E1.m1.3.3.4.cmml">​</mo><mrow id="S4.E1.m1.3.3.3.3" xref="S4.E1.m1.3.3.3.4.cmml"><mo stretchy="false" id="S4.E1.m1.3.3.3.3.4" xref="S4.E1.m1.3.3.3.4.cmml">(</mo><msub id="S4.E1.m1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.1.1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.1.2.cmml">Q</mi><mi id="S4.E1.m1.1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.E1.m1.3.3.3.3.5" xref="S4.E1.m1.3.3.3.4.cmml">,</mo><msub id="S4.E1.m1.2.2.2.2.2" xref="S4.E1.m1.2.2.2.2.2.cmml"><mover accent="true" id="S4.E1.m1.2.2.2.2.2.2" xref="S4.E1.m1.2.2.2.2.2.2.cmml"><mi id="S4.E1.m1.2.2.2.2.2.2.2" xref="S4.E1.m1.2.2.2.2.2.2.2.cmml">Q</mi><mo id="S4.E1.m1.2.2.2.2.2.2.1" xref="S4.E1.m1.2.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S4.E1.m1.2.2.2.2.2.3" xref="S4.E1.m1.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.E1.m1.3.3.3.3.6" xref="S4.E1.m1.3.3.3.4.cmml">,</mo><msub id="S4.E1.m1.3.3.3.3.3" xref="S4.E1.m1.3.3.3.3.3.cmml"><mi id="S4.E1.m1.3.3.3.3.3.2" xref="S4.E1.m1.3.3.3.3.3.2.cmml">I</mi><mi id="S4.E1.m1.3.3.3.3.3.3" xref="S4.E1.m1.3.3.3.3.3.3.cmml">j</mi></msub><mo stretchy="false" id="S4.E1.m1.3.3.3.3.7" xref="S4.E1.m1.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.3b"><apply id="S4.E1.m1.3.3.cmml" xref="S4.E1.m1.3.3"><times id="S4.E1.m1.3.3.4.cmml" xref="S4.E1.m1.3.3.4"></times><apply id="S4.E1.m1.3.3.5.cmml" xref="S4.E1.m1.3.3.5"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.5.1.cmml" xref="S4.E1.m1.3.3.5">subscript</csymbol><ci id="S4.E1.m1.3.3.5.2.cmml" xref="S4.E1.m1.3.3.5.2">ℒ</ci><ci id="S4.E1.m1.3.3.5.3.cmml" xref="S4.E1.m1.3.3.5.3">𝑚</ci></apply><vector id="S4.E1.m1.3.3.3.4.cmml" xref="S4.E1.m1.3.3.3.3"><apply id="S4.E1.m1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.1.2">𝑄</ci><ci id="S4.E1.m1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S4.E1.m1.2.2.2.2.2.cmml" xref="S4.E1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.2.2.2.1.cmml" xref="S4.E1.m1.2.2.2.2.2">subscript</csymbol><apply id="S4.E1.m1.2.2.2.2.2.2.cmml" xref="S4.E1.m1.2.2.2.2.2.2"><ci id="S4.E1.m1.2.2.2.2.2.2.1.cmml" xref="S4.E1.m1.2.2.2.2.2.2.1">~</ci><ci id="S4.E1.m1.2.2.2.2.2.2.2.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2">𝑄</ci></apply><ci id="S4.E1.m1.2.2.2.2.2.3.cmml" xref="S4.E1.m1.2.2.2.2.2.3">𝑗</ci></apply><apply id="S4.E1.m1.3.3.3.3.3.cmml" xref="S4.E1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.3.3.3.1.cmml" xref="S4.E1.m1.3.3.3.3.3">subscript</csymbol><ci id="S4.E1.m1.3.3.3.3.3.2.cmml" xref="S4.E1.m1.3.3.3.3.3.2">𝐼</ci><ci id="S4.E1.m1.3.3.3.3.3.3.cmml" xref="S4.E1.m1.3.3.3.3.3.3">𝑗</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.3c">\displaystyle\mathcal{L}_{m}(Q_{j},\tilde{Q}_{j},I_{j})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E1.m2.3" class="ltx_Math" alttext="\displaystyle=\lambda\sum_{t=1}^{T}d(w_{j}^{(t)},\tilde{w}_{j}^{(t)})," display="inline"><semantics id="S4.E1.m2.3a"><mrow id="S4.E1.m2.3.3.1" xref="S4.E1.m2.3.3.1.1.cmml"><mrow id="S4.E1.m2.3.3.1.1" xref="S4.E1.m2.3.3.1.1.cmml"><mi id="S4.E1.m2.3.3.1.1.4" xref="S4.E1.m2.3.3.1.1.4.cmml"></mi><mo id="S4.E1.m2.3.3.1.1.3" xref="S4.E1.m2.3.3.1.1.3.cmml">=</mo><mrow id="S4.E1.m2.3.3.1.1.2" xref="S4.E1.m2.3.3.1.1.2.cmml"><mi id="S4.E1.m2.3.3.1.1.2.4" xref="S4.E1.m2.3.3.1.1.2.4.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S4.E1.m2.3.3.1.1.2.3" xref="S4.E1.m2.3.3.1.1.2.3.cmml">​</mo><mrow id="S4.E1.m2.3.3.1.1.2.2" xref="S4.E1.m2.3.3.1.1.2.2.cmml"><mstyle displaystyle="true" id="S4.E1.m2.3.3.1.1.2.2.3" xref="S4.E1.m2.3.3.1.1.2.2.3.cmml"><munderover id="S4.E1.m2.3.3.1.1.2.2.3a" xref="S4.E1.m2.3.3.1.1.2.2.3.cmml"><mo movablelimits="false" id="S4.E1.m2.3.3.1.1.2.2.3.2.2" xref="S4.E1.m2.3.3.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E1.m2.3.3.1.1.2.2.3.2.3" xref="S4.E1.m2.3.3.1.1.2.2.3.2.3.cmml"><mi id="S4.E1.m2.3.3.1.1.2.2.3.2.3.2" xref="S4.E1.m2.3.3.1.1.2.2.3.2.3.2.cmml">t</mi><mo id="S4.E1.m2.3.3.1.1.2.2.3.2.3.1" xref="S4.E1.m2.3.3.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E1.m2.3.3.1.1.2.2.3.2.3.3" xref="S4.E1.m2.3.3.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E1.m2.3.3.1.1.2.2.3.3" xref="S4.E1.m2.3.3.1.1.2.2.3.3.cmml">T</mi></munderover></mstyle><mrow id="S4.E1.m2.3.3.1.1.2.2.2" xref="S4.E1.m2.3.3.1.1.2.2.2.cmml"><mi id="S4.E1.m2.3.3.1.1.2.2.2.4" xref="S4.E1.m2.3.3.1.1.2.2.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E1.m2.3.3.1.1.2.2.2.3" xref="S4.E1.m2.3.3.1.1.2.2.2.3.cmml">​</mo><mrow id="S4.E1.m2.3.3.1.1.2.2.2.2.2" xref="S4.E1.m2.3.3.1.1.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.E1.m2.3.3.1.1.2.2.2.2.2.3" xref="S4.E1.m2.3.3.1.1.2.2.2.2.3.cmml">(</mo><msubsup id="S4.E1.m2.3.3.1.1.1.1.1.1.1.1" xref="S4.E1.m2.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E1.m2.3.3.1.1.1.1.1.1.1.1.2.2" xref="S4.E1.m2.3.3.1.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="S4.E1.m2.3.3.1.1.1.1.1.1.1.1.2.3" xref="S4.E1.m2.3.3.1.1.1.1.1.1.1.1.2.3.cmml">j</mi><mrow id="S4.E1.m2.1.1.1.3" xref="S4.E1.m2.3.3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E1.m2.1.1.1.3.1" xref="S4.E1.m2.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E1.m2.1.1.1.1" xref="S4.E1.m2.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S4.E1.m2.1.1.1.3.2" xref="S4.E1.m2.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E1.m2.3.3.1.1.2.2.2.2.2.4" xref="S4.E1.m2.3.3.1.1.2.2.2.2.3.cmml">,</mo><msubsup id="S4.E1.m2.3.3.1.1.2.2.2.2.2.2" xref="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.cmml"><mover accent="true" id="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.2.2" xref="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.2.2.cmml"><mi id="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.2.2.2" xref="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.2.2.2.cmml">w</mi><mo id="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.2.2.1" xref="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.2.3" xref="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.2.3.cmml">j</mi><mrow id="S4.E1.m2.2.2.1.3" xref="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.cmml"><mo stretchy="false" id="S4.E1.m2.2.2.1.3.1" xref="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.cmml">(</mo><mi id="S4.E1.m2.2.2.1.1" xref="S4.E1.m2.2.2.1.1.cmml">t</mi><mo stretchy="false" id="S4.E1.m2.2.2.1.3.2" xref="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S4.E1.m2.3.3.1.1.2.2.2.2.2.5" xref="S4.E1.m2.3.3.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E1.m2.3.3.1.2" xref="S4.E1.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m2.3b"><apply id="S4.E1.m2.3.3.1.1.cmml" xref="S4.E1.m2.3.3.1"><eq id="S4.E1.m2.3.3.1.1.3.cmml" xref="S4.E1.m2.3.3.1.1.3"></eq><csymbol cd="latexml" id="S4.E1.m2.3.3.1.1.4.cmml" xref="S4.E1.m2.3.3.1.1.4">absent</csymbol><apply id="S4.E1.m2.3.3.1.1.2.cmml" xref="S4.E1.m2.3.3.1.1.2"><times id="S4.E1.m2.3.3.1.1.2.3.cmml" xref="S4.E1.m2.3.3.1.1.2.3"></times><ci id="S4.E1.m2.3.3.1.1.2.4.cmml" xref="S4.E1.m2.3.3.1.1.2.4">𝜆</ci><apply id="S4.E1.m2.3.3.1.1.2.2.cmml" xref="S4.E1.m2.3.3.1.1.2.2"><apply id="S4.E1.m2.3.3.1.1.2.2.3.cmml" xref="S4.E1.m2.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E1.m2.3.3.1.1.2.2.3.1.cmml" xref="S4.E1.m2.3.3.1.1.2.2.3">superscript</csymbol><apply id="S4.E1.m2.3.3.1.1.2.2.3.2.cmml" xref="S4.E1.m2.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E1.m2.3.3.1.1.2.2.3.2.1.cmml" xref="S4.E1.m2.3.3.1.1.2.2.3">subscript</csymbol><sum id="S4.E1.m2.3.3.1.1.2.2.3.2.2.cmml" xref="S4.E1.m2.3.3.1.1.2.2.3.2.2"></sum><apply id="S4.E1.m2.3.3.1.1.2.2.3.2.3.cmml" xref="S4.E1.m2.3.3.1.1.2.2.3.2.3"><eq id="S4.E1.m2.3.3.1.1.2.2.3.2.3.1.cmml" xref="S4.E1.m2.3.3.1.1.2.2.3.2.3.1"></eq><ci id="S4.E1.m2.3.3.1.1.2.2.3.2.3.2.cmml" xref="S4.E1.m2.3.3.1.1.2.2.3.2.3.2">𝑡</ci><cn type="integer" id="S4.E1.m2.3.3.1.1.2.2.3.2.3.3.cmml" xref="S4.E1.m2.3.3.1.1.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E1.m2.3.3.1.1.2.2.3.3.cmml" xref="S4.E1.m2.3.3.1.1.2.2.3.3">𝑇</ci></apply><apply id="S4.E1.m2.3.3.1.1.2.2.2.cmml" xref="S4.E1.m2.3.3.1.1.2.2.2"><times id="S4.E1.m2.3.3.1.1.2.2.2.3.cmml" xref="S4.E1.m2.3.3.1.1.2.2.2.3"></times><ci id="S4.E1.m2.3.3.1.1.2.2.2.4.cmml" xref="S4.E1.m2.3.3.1.1.2.2.2.4">𝑑</ci><interval closure="open" id="S4.E1.m2.3.3.1.1.2.2.2.2.3.cmml" xref="S4.E1.m2.3.3.1.1.2.2.2.2.2"><apply id="S4.E1.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m2.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m2.3.3.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E1.m2.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m2.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m2.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E1.m2.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E1.m2.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E1.m2.3.3.1.1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S4.E1.m2.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E1.m2.3.3.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S4.E1.m2.1.1.1.1.cmml" xref="S4.E1.m2.1.1.1.1">𝑡</ci></apply><apply id="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.cmml" xref="S4.E1.m2.3.3.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.1.cmml" xref="S4.E1.m2.3.3.1.1.2.2.2.2.2.2">superscript</csymbol><apply id="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E1.m2.3.3.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.2.1.cmml" xref="S4.E1.m2.3.3.1.1.2.2.2.2.2.2">subscript</csymbol><apply id="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.2.2.cmml" xref="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.2.2"><ci id="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.2.2.1.cmml" xref="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.2.2.1">~</ci><ci id="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.2.2.2.cmml" xref="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.2.2.2">𝑤</ci></apply><ci id="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.2.3.cmml" xref="S4.E1.m2.3.3.1.1.2.2.2.2.2.2.2.3">𝑗</ci></apply><ci id="S4.E1.m2.2.2.1.1.cmml" xref="S4.E1.m2.2.2.1.1">𝑡</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m2.3c">\displaystyle=\lambda\sum_{t=1}^{T}d(w_{j}^{(t)},\tilde{w}_{j}^{(t)}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p6.8" class="ltx_p">where <math id="S4.SS1.p6.6.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS1.p6.6.m1.1a"><mi id="S4.SS1.p6.6.m1.1.1" xref="S4.SS1.p6.6.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.6.m1.1b"><ci id="S4.SS1.p6.6.m1.1.1.cmml" xref="S4.SS1.p6.6.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.6.m1.1c">\lambda</annotation></semantics></math> is a hyperparameter to scale the loss term and <math id="S4.SS1.p6.7.m2.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.SS1.p6.7.m2.1a"><mi id="S4.SS1.p6.7.m2.1.1" xref="S4.SS1.p6.7.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.7.m2.1b"><ci id="S4.SS1.p6.7.m2.1.1.cmml" xref="S4.SS1.p6.7.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.7.m2.1c">d</annotation></semantics></math> is a distance metric between two distributions.
We find that KL divergence or common vector norm losses, such as L1-norm, work well as <math id="S4.SS1.p6.8.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.SS1.p6.8.m3.1a"><mi id="S4.SS1.p6.8.m3.1.1" xref="S4.SS1.p6.8.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.8.m3.1b"><ci id="S4.SS1.p6.8.m3.1.1.cmml" xref="S4.SS1.p6.8.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.8.m3.1c">d</annotation></semantics></math> in the proposed loss term.</p>
</div>
<figure id="algorithm1" class="ltx_float ltx_algorithm">
<div id="algorithm1.20" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.4.4" class="ltx_listingline">
<span id="algorithm1.4.4.4" class="ltx_text" style="font-size:90%;">
<span id="algorithm1.4.4.4.1" class="ltx_text ltx_font_bold">input :</span> steps <math id="algorithm1.1.1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="algorithm1.1.1.1.m1.1a"><mi id="algorithm1.1.1.1.m1.1.1" xref="algorithm1.1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.1.m1.1b"><ci id="algorithm1.1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.1.m1.1c">N</annotation></semantics></math>; input data <math id="algorithm1.2.2.2.m2.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="algorithm1.2.2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="algorithm1.2.2.2.m2.1.1" xref="algorithm1.2.2.2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.2.m2.1b"><ci id="algorithm1.2.2.2.m2.1.1.cmml" xref="algorithm1.2.2.2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.2.m2.1c">\mathcal{D}</annotation></semantics></math>; module <math id="algorithm1.3.3.3.m3.1" class="ltx_Math" alttext="g" display="inline"><semantics id="algorithm1.3.3.3.m3.1a"><mi id="algorithm1.3.3.3.m3.1.1" xref="algorithm1.3.3.3.m3.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.3.m3.1b"><ci id="algorithm1.3.3.3.m3.1.1.cmml" xref="algorithm1.3.3.3.m3.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.3.m3.1c">g</annotation></semantics></math>; network <math id="algorithm1.4.4.4.m4.1" class="ltx_Math" alttext="f" display="inline"><semantics id="algorithm1.4.4.4.m4.1a"><mi id="algorithm1.4.4.4.m4.1.1" xref="algorithm1.4.4.4.m4.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.4.m4.1b"><ci id="algorithm1.4.4.4.m4.1.1.cmml" xref="algorithm1.4.4.4.m4.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.4.m4.1c">f</annotation></semantics></math></span>
</div>
<div id="algorithm1.5.5" class="ltx_listingline">
<span id="algorithm1.5.5.2" class="ltx_text" style="font-size:90%;">
</span><span id="algorithm1.5.5.3" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="algorithm1.5.5.4" class="ltx_text" style="font-size:90%;"> </span><em id="algorithm1.5.5.1" class="ltx_emph ltx_font_italic" style="font-size:90%;"><math id="algorithm1.5.5.1.m1.3" class="ltx_Math" alttext="i\in\{1,...,N\}" display="inline"><semantics id="algorithm1.5.5.1.m1.3a"><mrow id="algorithm1.5.5.1.m1.3.4" xref="algorithm1.5.5.1.m1.3.4.cmml"><mi id="algorithm1.5.5.1.m1.3.4.2" xref="algorithm1.5.5.1.m1.3.4.2.cmml">i</mi><mo id="algorithm1.5.5.1.m1.3.4.1" xref="algorithm1.5.5.1.m1.3.4.1.cmml">∈</mo><mrow id="algorithm1.5.5.1.m1.3.4.3.2" xref="algorithm1.5.5.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="algorithm1.5.5.1.m1.3.4.3.2.1" xref="algorithm1.5.5.1.m1.3.4.3.1.cmml">{</mo><mn id="algorithm1.5.5.1.m1.1.1" xref="algorithm1.5.5.1.m1.1.1.cmml">1</mn><mo id="algorithm1.5.5.1.m1.3.4.3.2.2" xref="algorithm1.5.5.1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm1.5.5.1.m1.2.2" xref="algorithm1.5.5.1.m1.2.2.cmml">…</mi><mo id="algorithm1.5.5.1.m1.3.4.3.2.3" xref="algorithm1.5.5.1.m1.3.4.3.1.cmml">,</mo><mi id="algorithm1.5.5.1.m1.3.3" xref="algorithm1.5.5.1.m1.3.3.cmml">N</mi><mo stretchy="false" id="algorithm1.5.5.1.m1.3.4.3.2.4" xref="algorithm1.5.5.1.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.1.m1.3b"><apply id="algorithm1.5.5.1.m1.3.4.cmml" xref="algorithm1.5.5.1.m1.3.4"><in id="algorithm1.5.5.1.m1.3.4.1.cmml" xref="algorithm1.5.5.1.m1.3.4.1"></in><ci id="algorithm1.5.5.1.m1.3.4.2.cmml" xref="algorithm1.5.5.1.m1.3.4.2">𝑖</ci><set id="algorithm1.5.5.1.m1.3.4.3.1.cmml" xref="algorithm1.5.5.1.m1.3.4.3.2"><cn type="integer" id="algorithm1.5.5.1.m1.1.1.cmml" xref="algorithm1.5.5.1.m1.1.1">1</cn><ci id="algorithm1.5.5.1.m1.2.2.cmml" xref="algorithm1.5.5.1.m1.2.2">…</ci><ci id="algorithm1.5.5.1.m1.3.3.cmml" xref="algorithm1.5.5.1.m1.3.3">𝑁</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.1.m1.3c">i\in\{1,...,N\}</annotation></semantics></math></em><span id="algorithm1.5.5.5" class="ltx_text" style="font-size:90%;"> </span><span id="algorithm1.5.5.6" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="algorithm1.5.5.7" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="algorithm1.7.7" class="ltx_listingline">
<span id="algorithm1.7.7.1" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.7.7.2" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.7.7.3" class="ltx_text" style="font-size:90%;">
sample </span><math id="algorithm1.6.6.m1.3" class="ltx_Math" alttext="(I_{i},Q_{i},A_{i})" display="inline"><semantics id="algorithm1.6.6.m1.3a"><mrow id="algorithm1.6.6.m1.3.3.3" xref="algorithm1.6.6.m1.3.3.4.cmml"><mo maxsize="90%" minsize="90%" id="algorithm1.6.6.m1.3.3.3.4" xref="algorithm1.6.6.m1.3.3.4.cmml">(</mo><msub id="algorithm1.6.6.m1.1.1.1.1" xref="algorithm1.6.6.m1.1.1.1.1.cmml"><mi mathsize="90%" id="algorithm1.6.6.m1.1.1.1.1.2" xref="algorithm1.6.6.m1.1.1.1.1.2.cmml">I</mi><mi mathsize="90%" id="algorithm1.6.6.m1.1.1.1.1.3" xref="algorithm1.6.6.m1.1.1.1.1.3.cmml">i</mi></msub><mo mathsize="90%" id="algorithm1.6.6.m1.3.3.3.5" xref="algorithm1.6.6.m1.3.3.4.cmml">,</mo><msub id="algorithm1.6.6.m1.2.2.2.2" xref="algorithm1.6.6.m1.2.2.2.2.cmml"><mi mathsize="90%" id="algorithm1.6.6.m1.2.2.2.2.2" xref="algorithm1.6.6.m1.2.2.2.2.2.cmml">Q</mi><mi mathsize="90%" id="algorithm1.6.6.m1.2.2.2.2.3" xref="algorithm1.6.6.m1.2.2.2.2.3.cmml">i</mi></msub><mo mathsize="90%" id="algorithm1.6.6.m1.3.3.3.6" xref="algorithm1.6.6.m1.3.3.4.cmml">,</mo><msub id="algorithm1.6.6.m1.3.3.3.3" xref="algorithm1.6.6.m1.3.3.3.3.cmml"><mi mathsize="90%" id="algorithm1.6.6.m1.3.3.3.3.2" xref="algorithm1.6.6.m1.3.3.3.3.2.cmml">A</mi><mi mathsize="90%" id="algorithm1.6.6.m1.3.3.3.3.3" xref="algorithm1.6.6.m1.3.3.3.3.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="algorithm1.6.6.m1.3.3.3.7" xref="algorithm1.6.6.m1.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.m1.3b"><vector id="algorithm1.6.6.m1.3.3.4.cmml" xref="algorithm1.6.6.m1.3.3.3"><apply id="algorithm1.6.6.m1.1.1.1.1.cmml" xref="algorithm1.6.6.m1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.6.6.m1.1.1.1.1.1.cmml" xref="algorithm1.6.6.m1.1.1.1.1">subscript</csymbol><ci id="algorithm1.6.6.m1.1.1.1.1.2.cmml" xref="algorithm1.6.6.m1.1.1.1.1.2">𝐼</ci><ci id="algorithm1.6.6.m1.1.1.1.1.3.cmml" xref="algorithm1.6.6.m1.1.1.1.1.3">𝑖</ci></apply><apply id="algorithm1.6.6.m1.2.2.2.2.cmml" xref="algorithm1.6.6.m1.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.6.6.m1.2.2.2.2.1.cmml" xref="algorithm1.6.6.m1.2.2.2.2">subscript</csymbol><ci id="algorithm1.6.6.m1.2.2.2.2.2.cmml" xref="algorithm1.6.6.m1.2.2.2.2.2">𝑄</ci><ci id="algorithm1.6.6.m1.2.2.2.2.3.cmml" xref="algorithm1.6.6.m1.2.2.2.2.3">𝑖</ci></apply><apply id="algorithm1.6.6.m1.3.3.3.3.cmml" xref="algorithm1.6.6.m1.3.3.3.3"><csymbol cd="ambiguous" id="algorithm1.6.6.m1.3.3.3.3.1.cmml" xref="algorithm1.6.6.m1.3.3.3.3">subscript</csymbol><ci id="algorithm1.6.6.m1.3.3.3.3.2.cmml" xref="algorithm1.6.6.m1.3.3.3.3.2">𝐴</ci><ci id="algorithm1.6.6.m1.3.3.3.3.3.cmml" xref="algorithm1.6.6.m1.3.3.3.3.3">𝑖</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.m1.3c">(I_{i},Q_{i},A_{i})</annotation></semantics></math><span id="algorithm1.7.7.4" class="ltx_text" style="font-size:90%;"> from </span><math id="algorithm1.7.7.m2.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="algorithm1.7.7.m2.1a"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="algorithm1.7.7.m2.1.1" xref="algorithm1.7.7.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.m2.1b"><ci id="algorithm1.7.7.m2.1.1.cmml" xref="algorithm1.7.7.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.m2.1c">\mathcal{D}</annotation></semantics></math><span id="algorithm1.7.7.5" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="algorithm1.9.9" class="ltx_listingline">
<span id="algorithm1.9.9.1" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.9.9.2" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.9.9.3" class="ltx_text" style="font-size:90%;">
compute </span><math id="algorithm1.8.8.m1.1" class="ltx_Math" alttext="\mathcal{L}_{CE}" display="inline"><semantics id="algorithm1.8.8.m1.1a"><msub id="algorithm1.8.8.m1.1.1" xref="algorithm1.8.8.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="algorithm1.8.8.m1.1.1.2" xref="algorithm1.8.8.m1.1.1.2.cmml">ℒ</mi><mrow id="algorithm1.8.8.m1.1.1.3" xref="algorithm1.8.8.m1.1.1.3.cmml"><mi mathsize="90%" id="algorithm1.8.8.m1.1.1.3.2" xref="algorithm1.8.8.m1.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="algorithm1.8.8.m1.1.1.3.1" xref="algorithm1.8.8.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="algorithm1.8.8.m1.1.1.3.3" xref="algorithm1.8.8.m1.1.1.3.3.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.m1.1b"><apply id="algorithm1.8.8.m1.1.1.cmml" xref="algorithm1.8.8.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.8.8.m1.1.1.1.cmml" xref="algorithm1.8.8.m1.1.1">subscript</csymbol><ci id="algorithm1.8.8.m1.1.1.2.cmml" xref="algorithm1.8.8.m1.1.1.2">ℒ</ci><apply id="algorithm1.8.8.m1.1.1.3.cmml" xref="algorithm1.8.8.m1.1.1.3"><times id="algorithm1.8.8.m1.1.1.3.1.cmml" xref="algorithm1.8.8.m1.1.1.3.1"></times><ci id="algorithm1.8.8.m1.1.1.3.2.cmml" xref="algorithm1.8.8.m1.1.1.3.2">𝐶</ci><ci id="algorithm1.8.8.m1.1.1.3.3.cmml" xref="algorithm1.8.8.m1.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.m1.1c">\mathcal{L}_{CE}</annotation></semantics></math><span id="algorithm1.9.9.4" class="ltx_text" style="font-size:90%;"> w.r.t. </span><math id="algorithm1.9.9.m2.3" class="ltx_Math" alttext="(I_{i},Q_{i},A_{i})" display="inline"><semantics id="algorithm1.9.9.m2.3a"><mrow id="algorithm1.9.9.m2.3.3.3" xref="algorithm1.9.9.m2.3.3.4.cmml"><mo maxsize="90%" minsize="90%" id="algorithm1.9.9.m2.3.3.3.4" xref="algorithm1.9.9.m2.3.3.4.cmml">(</mo><msub id="algorithm1.9.9.m2.1.1.1.1" xref="algorithm1.9.9.m2.1.1.1.1.cmml"><mi mathsize="90%" id="algorithm1.9.9.m2.1.1.1.1.2" xref="algorithm1.9.9.m2.1.1.1.1.2.cmml">I</mi><mi mathsize="90%" id="algorithm1.9.9.m2.1.1.1.1.3" xref="algorithm1.9.9.m2.1.1.1.1.3.cmml">i</mi></msub><mo mathsize="90%" id="algorithm1.9.9.m2.3.3.3.5" xref="algorithm1.9.9.m2.3.3.4.cmml">,</mo><msub id="algorithm1.9.9.m2.2.2.2.2" xref="algorithm1.9.9.m2.2.2.2.2.cmml"><mi mathsize="90%" id="algorithm1.9.9.m2.2.2.2.2.2" xref="algorithm1.9.9.m2.2.2.2.2.2.cmml">Q</mi><mi mathsize="90%" id="algorithm1.9.9.m2.2.2.2.2.3" xref="algorithm1.9.9.m2.2.2.2.2.3.cmml">i</mi></msub><mo mathsize="90%" id="algorithm1.9.9.m2.3.3.3.6" xref="algorithm1.9.9.m2.3.3.4.cmml">,</mo><msub id="algorithm1.9.9.m2.3.3.3.3" xref="algorithm1.9.9.m2.3.3.3.3.cmml"><mi mathsize="90%" id="algorithm1.9.9.m2.3.3.3.3.2" xref="algorithm1.9.9.m2.3.3.3.3.2.cmml">A</mi><mi mathsize="90%" id="algorithm1.9.9.m2.3.3.3.3.3" xref="algorithm1.9.9.m2.3.3.3.3.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="algorithm1.9.9.m2.3.3.3.7" xref="algorithm1.9.9.m2.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.m2.3b"><vector id="algorithm1.9.9.m2.3.3.4.cmml" xref="algorithm1.9.9.m2.3.3.3"><apply id="algorithm1.9.9.m2.1.1.1.1.cmml" xref="algorithm1.9.9.m2.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.9.9.m2.1.1.1.1.1.cmml" xref="algorithm1.9.9.m2.1.1.1.1">subscript</csymbol><ci id="algorithm1.9.9.m2.1.1.1.1.2.cmml" xref="algorithm1.9.9.m2.1.1.1.1.2">𝐼</ci><ci id="algorithm1.9.9.m2.1.1.1.1.3.cmml" xref="algorithm1.9.9.m2.1.1.1.1.3">𝑖</ci></apply><apply id="algorithm1.9.9.m2.2.2.2.2.cmml" xref="algorithm1.9.9.m2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.9.9.m2.2.2.2.2.1.cmml" xref="algorithm1.9.9.m2.2.2.2.2">subscript</csymbol><ci id="algorithm1.9.9.m2.2.2.2.2.2.cmml" xref="algorithm1.9.9.m2.2.2.2.2.2">𝑄</ci><ci id="algorithm1.9.9.m2.2.2.2.2.3.cmml" xref="algorithm1.9.9.m2.2.2.2.2.3">𝑖</ci></apply><apply id="algorithm1.9.9.m2.3.3.3.3.cmml" xref="algorithm1.9.9.m2.3.3.3.3"><csymbol cd="ambiguous" id="algorithm1.9.9.m2.3.3.3.3.1.cmml" xref="algorithm1.9.9.m2.3.3.3.3">subscript</csymbol><ci id="algorithm1.9.9.m2.3.3.3.3.2.cmml" xref="algorithm1.9.9.m2.3.3.3.3.2">𝐴</ci><ci id="algorithm1.9.9.m2.3.3.3.3.3.cmml" xref="algorithm1.9.9.m2.3.3.3.3.3">𝑖</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.m2.3c">(I_{i},Q_{i},A_{i})</annotation></semantics></math><span id="algorithm1.9.9.5" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="algorithm1.10.10" class="ltx_listingline">
<span id="algorithm1.10.10.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.10.10.3" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.10.10.4" class="ltx_text" style="font-size:90%;">
</span><span id="algorithm1.10.10.5" class="ltx_text ltx_font_bold" style="font-size:90%;">if</span><span id="algorithm1.10.10.6" class="ltx_text" style="font-size:90%;"> </span><em id="algorithm1.10.10.1" class="ltx_emph ltx_font_italic" style="font-size:90%;"><math id="algorithm1.10.10.1.m1.1" class="ltx_Math" alttext="\text{Bernoulli}(r)=1" display="inline"><semantics id="algorithm1.10.10.1.m1.1a"><mrow id="algorithm1.10.10.1.m1.1.2" xref="algorithm1.10.10.1.m1.1.2.cmml"><mrow id="algorithm1.10.10.1.m1.1.2.2" xref="algorithm1.10.10.1.m1.1.2.2.cmml"><mtext class="ltx_mathvariant_italic" id="algorithm1.10.10.1.m1.1.2.2.2" xref="algorithm1.10.10.1.m1.1.2.2.2a.cmml">Bernoulli</mtext><mo lspace="0em" rspace="0em" id="algorithm1.10.10.1.m1.1.2.2.1" xref="algorithm1.10.10.1.m1.1.2.2.1.cmml">​</mo><mrow id="algorithm1.10.10.1.m1.1.2.2.3.2" xref="algorithm1.10.10.1.m1.1.2.2.cmml"><mo stretchy="false" id="algorithm1.10.10.1.m1.1.2.2.3.2.1" xref="algorithm1.10.10.1.m1.1.2.2.cmml">(</mo><mi id="algorithm1.10.10.1.m1.1.1" xref="algorithm1.10.10.1.m1.1.1.cmml">r</mi><mo stretchy="false" id="algorithm1.10.10.1.m1.1.2.2.3.2.2" xref="algorithm1.10.10.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="algorithm1.10.10.1.m1.1.2.1" xref="algorithm1.10.10.1.m1.1.2.1.cmml">=</mo><mn id="algorithm1.10.10.1.m1.1.2.3" xref="algorithm1.10.10.1.m1.1.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.1.m1.1b"><apply id="algorithm1.10.10.1.m1.1.2.cmml" xref="algorithm1.10.10.1.m1.1.2"><eq id="algorithm1.10.10.1.m1.1.2.1.cmml" xref="algorithm1.10.10.1.m1.1.2.1"></eq><apply id="algorithm1.10.10.1.m1.1.2.2.cmml" xref="algorithm1.10.10.1.m1.1.2.2"><times id="algorithm1.10.10.1.m1.1.2.2.1.cmml" xref="algorithm1.10.10.1.m1.1.2.2.1"></times><ci id="algorithm1.10.10.1.m1.1.2.2.2a.cmml" xref="algorithm1.10.10.1.m1.1.2.2.2"><mtext class="ltx_mathvariant_italic" id="algorithm1.10.10.1.m1.1.2.2.2.cmml" xref="algorithm1.10.10.1.m1.1.2.2.2">Bernoulli</mtext></ci><ci id="algorithm1.10.10.1.m1.1.1.cmml" xref="algorithm1.10.10.1.m1.1.1">𝑟</ci></apply><cn type="integer" id="algorithm1.10.10.1.m1.1.2.3.cmml" xref="algorithm1.10.10.1.m1.1.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.1.m1.1c">\text{Bernoulli}(r)=1</annotation></semantics></math></em><span id="algorithm1.10.10.7" class="ltx_text" style="font-size:90%;"> </span><span id="algorithm1.10.10.8" class="ltx_text ltx_font_bold" style="font-size:90%;">then</span>
</div>
<div id="algorithm1.12.12" class="ltx_listingline">
<span id="algorithm1.12.12.1" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.12.12.2" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.12.12.3" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.12.12.4" class="ltx_text" style="font-size:90%;">
sample </span><math id="algorithm1.11.11.m1.3" class="ltx_Math" alttext="(I_{j},Q_{j},A_{j})" display="inline"><semantics id="algorithm1.11.11.m1.3a"><mrow id="algorithm1.11.11.m1.3.3.3" xref="algorithm1.11.11.m1.3.3.4.cmml"><mo maxsize="90%" minsize="90%" id="algorithm1.11.11.m1.3.3.3.4" xref="algorithm1.11.11.m1.3.3.4.cmml">(</mo><msub id="algorithm1.11.11.m1.1.1.1.1" xref="algorithm1.11.11.m1.1.1.1.1.cmml"><mi mathsize="90%" id="algorithm1.11.11.m1.1.1.1.1.2" xref="algorithm1.11.11.m1.1.1.1.1.2.cmml">I</mi><mi mathsize="90%" id="algorithm1.11.11.m1.1.1.1.1.3" xref="algorithm1.11.11.m1.1.1.1.1.3.cmml">j</mi></msub><mo mathsize="90%" id="algorithm1.11.11.m1.3.3.3.5" xref="algorithm1.11.11.m1.3.3.4.cmml">,</mo><msub id="algorithm1.11.11.m1.2.2.2.2" xref="algorithm1.11.11.m1.2.2.2.2.cmml"><mi mathsize="90%" id="algorithm1.11.11.m1.2.2.2.2.2" xref="algorithm1.11.11.m1.2.2.2.2.2.cmml">Q</mi><mi mathsize="90%" id="algorithm1.11.11.m1.2.2.2.2.3" xref="algorithm1.11.11.m1.2.2.2.2.3.cmml">j</mi></msub><mo mathsize="90%" id="algorithm1.11.11.m1.3.3.3.6" xref="algorithm1.11.11.m1.3.3.4.cmml">,</mo><msub id="algorithm1.11.11.m1.3.3.3.3" xref="algorithm1.11.11.m1.3.3.3.3.cmml"><mi mathsize="90%" id="algorithm1.11.11.m1.3.3.3.3.2" xref="algorithm1.11.11.m1.3.3.3.3.2.cmml">A</mi><mi mathsize="90%" id="algorithm1.11.11.m1.3.3.3.3.3" xref="algorithm1.11.11.m1.3.3.3.3.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="algorithm1.11.11.m1.3.3.3.7" xref="algorithm1.11.11.m1.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m1.3b"><vector id="algorithm1.11.11.m1.3.3.4.cmml" xref="algorithm1.11.11.m1.3.3.3"><apply id="algorithm1.11.11.m1.1.1.1.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.1.1.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1">subscript</csymbol><ci id="algorithm1.11.11.m1.1.1.1.1.2.cmml" xref="algorithm1.11.11.m1.1.1.1.1.2">𝐼</ci><ci id="algorithm1.11.11.m1.1.1.1.1.3.cmml" xref="algorithm1.11.11.m1.1.1.1.1.3">𝑗</ci></apply><apply id="algorithm1.11.11.m1.2.2.2.2.cmml" xref="algorithm1.11.11.m1.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.2.2.2.2.1.cmml" xref="algorithm1.11.11.m1.2.2.2.2">subscript</csymbol><ci id="algorithm1.11.11.m1.2.2.2.2.2.cmml" xref="algorithm1.11.11.m1.2.2.2.2.2">𝑄</ci><ci id="algorithm1.11.11.m1.2.2.2.2.3.cmml" xref="algorithm1.11.11.m1.2.2.2.2.3">𝑗</ci></apply><apply id="algorithm1.11.11.m1.3.3.3.3.cmml" xref="algorithm1.11.11.m1.3.3.3.3"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.3.3.3.3.1.cmml" xref="algorithm1.11.11.m1.3.3.3.3">subscript</csymbol><ci id="algorithm1.11.11.m1.3.3.3.3.2.cmml" xref="algorithm1.11.11.m1.3.3.3.3.2">𝐴</ci><ci id="algorithm1.11.11.m1.3.3.3.3.3.cmml" xref="algorithm1.11.11.m1.3.3.3.3.3">𝑗</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.3c">(I_{j},Q_{j},A_{j})</annotation></semantics></math><span id="algorithm1.12.12.5" class="ltx_text" style="font-size:90%;"> from </span><math id="algorithm1.12.12.m2.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="algorithm1.12.12.m2.1a"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="algorithm1.12.12.m2.1.1" xref="algorithm1.12.12.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.m2.1b"><ci id="algorithm1.12.12.m2.1.1.cmml" xref="algorithm1.12.12.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.m2.1c">\mathcal{D}</annotation></semantics></math><span id="algorithm1.12.12.6" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="algorithm1.13.13" class="ltx_listingline">
<span id="algorithm1.13.13.1" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.13.13.2" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.13.13.3" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.13.13.4" class="ltx_text" style="font-size:90%;">
</span><math id="algorithm1.13.13.m1.1" class="ltx_Math" alttext="t\sim\text{cat}(\mathcal{T}|\mathbf{p})" display="inline"><semantics id="algorithm1.13.13.m1.1a"><mrow id="algorithm1.13.13.m1.1.1" xref="algorithm1.13.13.m1.1.1.cmml"><mi mathsize="90%" id="algorithm1.13.13.m1.1.1.3" xref="algorithm1.13.13.m1.1.1.3.cmml">t</mi><mo mathsize="90%" id="algorithm1.13.13.m1.1.1.2" xref="algorithm1.13.13.m1.1.1.2.cmml">∼</mo><mrow id="algorithm1.13.13.m1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.cmml"><mtext mathsize="90%" id="algorithm1.13.13.m1.1.1.1.3" xref="algorithm1.13.13.m1.1.1.1.3a.cmml">cat</mtext><mo lspace="0em" rspace="0em" id="algorithm1.13.13.m1.1.1.1.2" xref="algorithm1.13.13.m1.1.1.1.2.cmml">​</mo><mrow id="algorithm1.13.13.m1.1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="algorithm1.13.13.m1.1.1.1.1.1.2" xref="algorithm1.13.13.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.13.13.m1.1.1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="algorithm1.13.13.m1.1.1.1.1.1.1.2" xref="algorithm1.13.13.m1.1.1.1.1.1.1.2.cmml">𝒯</mi><mo fence="false" mathsize="90%" id="algorithm1.13.13.m1.1.1.1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.cmml">|</mo><mi mathsize="90%" id="algorithm1.13.13.m1.1.1.1.1.1.1.3" xref="algorithm1.13.13.m1.1.1.1.1.1.1.3.cmml">𝐩</mi></mrow><mo maxsize="90%" minsize="90%" id="algorithm1.13.13.m1.1.1.1.1.1.3" xref="algorithm1.13.13.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m1.1b"><apply id="algorithm1.13.13.m1.1.1.cmml" xref="algorithm1.13.13.m1.1.1"><csymbol cd="latexml" id="algorithm1.13.13.m1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.2">similar-to</csymbol><ci id="algorithm1.13.13.m1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.3">𝑡</ci><apply id="algorithm1.13.13.m1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1"><times id="algorithm1.13.13.m1.1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.1.2"></times><ci id="algorithm1.13.13.m1.1.1.1.3a.cmml" xref="algorithm1.13.13.m1.1.1.1.3"><mtext mathsize="90%" id="algorithm1.13.13.m1.1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.1.3">cat</mtext></ci><apply id="algorithm1.13.13.m1.1.1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1"><csymbol cd="latexml" id="algorithm1.13.13.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="algorithm1.13.13.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1.2">𝒯</ci><ci id="algorithm1.13.13.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1.3">𝐩</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m1.1c">t\sim\text{cat}(\mathcal{T}|\mathbf{p})</annotation></semantics></math><span id="algorithm1.13.13.5" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="algorithm1.14.14" class="ltx_listingline">
<span id="algorithm1.14.14.1" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.14.14.2" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.14.14.3" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.14.14.4" class="ltx_text" style="font-size:90%;">
</span><math id="algorithm1.14.14.m1.5" class="ltx_Math" alttext="(\tilde{Q}_{j},\tilde{A_{j}})\leftarrow g(Q_{j},A_{j},t)" display="inline"><semantics id="algorithm1.14.14.m1.5a"><mrow id="algorithm1.14.14.m1.5.5" xref="algorithm1.14.14.m1.5.5.cmml"><mrow id="algorithm1.14.14.m1.3.3.1.1" xref="algorithm1.14.14.m1.3.3.1.2.cmml"><mo maxsize="90%" minsize="90%" id="algorithm1.14.14.m1.3.3.1.1.2" xref="algorithm1.14.14.m1.3.3.1.2.cmml">(</mo><msub id="algorithm1.14.14.m1.3.3.1.1.1" xref="algorithm1.14.14.m1.3.3.1.1.1.cmml"><mover accent="true" id="algorithm1.14.14.m1.3.3.1.1.1.2" xref="algorithm1.14.14.m1.3.3.1.1.1.2.cmml"><mi mathsize="90%" id="algorithm1.14.14.m1.3.3.1.1.1.2.2" xref="algorithm1.14.14.m1.3.3.1.1.1.2.2.cmml">Q</mi><mo mathsize="90%" id="algorithm1.14.14.m1.3.3.1.1.1.2.1" xref="algorithm1.14.14.m1.3.3.1.1.1.2.1.cmml">~</mo></mover><mi mathsize="90%" id="algorithm1.14.14.m1.3.3.1.1.1.3" xref="algorithm1.14.14.m1.3.3.1.1.1.3.cmml">j</mi></msub><mo mathsize="90%" id="algorithm1.14.14.m1.3.3.1.1.3" xref="algorithm1.14.14.m1.3.3.1.2.cmml">,</mo><mover accent="true" id="algorithm1.14.14.m1.1.1" xref="algorithm1.14.14.m1.1.1.cmml"><msub id="algorithm1.14.14.m1.1.1.2" xref="algorithm1.14.14.m1.1.1.2.cmml"><mi mathsize="90%" id="algorithm1.14.14.m1.1.1.2.2" xref="algorithm1.14.14.m1.1.1.2.2.cmml">A</mi><mi mathsize="90%" id="algorithm1.14.14.m1.1.1.2.3" xref="algorithm1.14.14.m1.1.1.2.3.cmml">j</mi></msub><mo mathsize="90%" id="algorithm1.14.14.m1.1.1.1" xref="algorithm1.14.14.m1.1.1.1.cmml">~</mo></mover><mo maxsize="90%" minsize="90%" id="algorithm1.14.14.m1.3.3.1.1.4" xref="algorithm1.14.14.m1.3.3.1.2.cmml">)</mo></mrow><mo mathsize="90%" stretchy="false" id="algorithm1.14.14.m1.5.5.4" xref="algorithm1.14.14.m1.5.5.4.cmml">←</mo><mrow id="algorithm1.14.14.m1.5.5.3" xref="algorithm1.14.14.m1.5.5.3.cmml"><mi mathsize="90%" id="algorithm1.14.14.m1.5.5.3.4" xref="algorithm1.14.14.m1.5.5.3.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="algorithm1.14.14.m1.5.5.3.3" xref="algorithm1.14.14.m1.5.5.3.3.cmml">​</mo><mrow id="algorithm1.14.14.m1.5.5.3.2.2" xref="algorithm1.14.14.m1.5.5.3.2.3.cmml"><mo maxsize="90%" minsize="90%" id="algorithm1.14.14.m1.5.5.3.2.2.3" xref="algorithm1.14.14.m1.5.5.3.2.3.cmml">(</mo><msub id="algorithm1.14.14.m1.4.4.2.1.1.1" xref="algorithm1.14.14.m1.4.4.2.1.1.1.cmml"><mi mathsize="90%" id="algorithm1.14.14.m1.4.4.2.1.1.1.2" xref="algorithm1.14.14.m1.4.4.2.1.1.1.2.cmml">Q</mi><mi mathsize="90%" id="algorithm1.14.14.m1.4.4.2.1.1.1.3" xref="algorithm1.14.14.m1.4.4.2.1.1.1.3.cmml">j</mi></msub><mo mathsize="90%" id="algorithm1.14.14.m1.5.5.3.2.2.4" xref="algorithm1.14.14.m1.5.5.3.2.3.cmml">,</mo><msub id="algorithm1.14.14.m1.5.5.3.2.2.2" xref="algorithm1.14.14.m1.5.5.3.2.2.2.cmml"><mi mathsize="90%" id="algorithm1.14.14.m1.5.5.3.2.2.2.2" xref="algorithm1.14.14.m1.5.5.3.2.2.2.2.cmml">A</mi><mi mathsize="90%" id="algorithm1.14.14.m1.5.5.3.2.2.2.3" xref="algorithm1.14.14.m1.5.5.3.2.2.2.3.cmml">j</mi></msub><mo mathsize="90%" id="algorithm1.14.14.m1.5.5.3.2.2.5" xref="algorithm1.14.14.m1.5.5.3.2.3.cmml">,</mo><mi mathsize="90%" id="algorithm1.14.14.m1.2.2" xref="algorithm1.14.14.m1.2.2.cmml">t</mi><mo maxsize="90%" minsize="90%" id="algorithm1.14.14.m1.5.5.3.2.2.6" xref="algorithm1.14.14.m1.5.5.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.m1.5b"><apply id="algorithm1.14.14.m1.5.5.cmml" xref="algorithm1.14.14.m1.5.5"><ci id="algorithm1.14.14.m1.5.5.4.cmml" xref="algorithm1.14.14.m1.5.5.4">←</ci><interval closure="open" id="algorithm1.14.14.m1.3.3.1.2.cmml" xref="algorithm1.14.14.m1.3.3.1.1"><apply id="algorithm1.14.14.m1.3.3.1.1.1.cmml" xref="algorithm1.14.14.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="algorithm1.14.14.m1.3.3.1.1.1.1.cmml" xref="algorithm1.14.14.m1.3.3.1.1.1">subscript</csymbol><apply id="algorithm1.14.14.m1.3.3.1.1.1.2.cmml" xref="algorithm1.14.14.m1.3.3.1.1.1.2"><ci id="algorithm1.14.14.m1.3.3.1.1.1.2.1.cmml" xref="algorithm1.14.14.m1.3.3.1.1.1.2.1">~</ci><ci id="algorithm1.14.14.m1.3.3.1.1.1.2.2.cmml" xref="algorithm1.14.14.m1.3.3.1.1.1.2.2">𝑄</ci></apply><ci id="algorithm1.14.14.m1.3.3.1.1.1.3.cmml" xref="algorithm1.14.14.m1.3.3.1.1.1.3">𝑗</ci></apply><apply id="algorithm1.14.14.m1.1.1.cmml" xref="algorithm1.14.14.m1.1.1"><ci id="algorithm1.14.14.m1.1.1.1.cmml" xref="algorithm1.14.14.m1.1.1.1">~</ci><apply id="algorithm1.14.14.m1.1.1.2.cmml" xref="algorithm1.14.14.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.14.14.m1.1.1.2.1.cmml" xref="algorithm1.14.14.m1.1.1.2">subscript</csymbol><ci id="algorithm1.14.14.m1.1.1.2.2.cmml" xref="algorithm1.14.14.m1.1.1.2.2">𝐴</ci><ci id="algorithm1.14.14.m1.1.1.2.3.cmml" xref="algorithm1.14.14.m1.1.1.2.3">𝑗</ci></apply></apply></interval><apply id="algorithm1.14.14.m1.5.5.3.cmml" xref="algorithm1.14.14.m1.5.5.3"><times id="algorithm1.14.14.m1.5.5.3.3.cmml" xref="algorithm1.14.14.m1.5.5.3.3"></times><ci id="algorithm1.14.14.m1.5.5.3.4.cmml" xref="algorithm1.14.14.m1.5.5.3.4">𝑔</ci><vector id="algorithm1.14.14.m1.5.5.3.2.3.cmml" xref="algorithm1.14.14.m1.5.5.3.2.2"><apply id="algorithm1.14.14.m1.4.4.2.1.1.1.cmml" xref="algorithm1.14.14.m1.4.4.2.1.1.1"><csymbol cd="ambiguous" id="algorithm1.14.14.m1.4.4.2.1.1.1.1.cmml" xref="algorithm1.14.14.m1.4.4.2.1.1.1">subscript</csymbol><ci id="algorithm1.14.14.m1.4.4.2.1.1.1.2.cmml" xref="algorithm1.14.14.m1.4.4.2.1.1.1.2">𝑄</ci><ci id="algorithm1.14.14.m1.4.4.2.1.1.1.3.cmml" xref="algorithm1.14.14.m1.4.4.2.1.1.1.3">𝑗</ci></apply><apply id="algorithm1.14.14.m1.5.5.3.2.2.2.cmml" xref="algorithm1.14.14.m1.5.5.3.2.2.2"><csymbol cd="ambiguous" id="algorithm1.14.14.m1.5.5.3.2.2.2.1.cmml" xref="algorithm1.14.14.m1.5.5.3.2.2.2">subscript</csymbol><ci id="algorithm1.14.14.m1.5.5.3.2.2.2.2.cmml" xref="algorithm1.14.14.m1.5.5.3.2.2.2.2">𝐴</ci><ci id="algorithm1.14.14.m1.5.5.3.2.2.2.3.cmml" xref="algorithm1.14.14.m1.5.5.3.2.2.2.3">𝑗</ci></apply><ci id="algorithm1.14.14.m1.2.2.cmml" xref="algorithm1.14.14.m1.2.2">𝑡</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.m1.5c">(\tilde{Q}_{j},\tilde{A_{j}})\leftarrow g(Q_{j},A_{j},t)</annotation></semantics></math><span id="algorithm1.14.14.5" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="algorithm1.16.16" class="ltx_listingline">
<span id="algorithm1.16.16.1" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.16.16.2" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.16.16.3" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.16.16.4" class="ltx_text" style="font-size:90%;">
compute </span><math id="algorithm1.15.15.m1.1" class="ltx_Math" alttext="\mathcal{L}_{m}" display="inline"><semantics id="algorithm1.15.15.m1.1a"><msub id="algorithm1.15.15.m1.1.1" xref="algorithm1.15.15.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="algorithm1.15.15.m1.1.1.2" xref="algorithm1.15.15.m1.1.1.2.cmml">ℒ</mi><mi mathsize="90%" id="algorithm1.15.15.m1.1.1.3" xref="algorithm1.15.15.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.15.15.m1.1b"><apply id="algorithm1.15.15.m1.1.1.cmml" xref="algorithm1.15.15.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.1.1.1.cmml" xref="algorithm1.15.15.m1.1.1">subscript</csymbol><ci id="algorithm1.15.15.m1.1.1.2.cmml" xref="algorithm1.15.15.m1.1.1.2">ℒ</ci><ci id="algorithm1.15.15.m1.1.1.3.cmml" xref="algorithm1.15.15.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.15.m1.1c">\mathcal{L}_{m}</annotation></semantics></math><span id="algorithm1.16.16.5" class="ltx_text" style="font-size:90%;"> w.r.t. </span><math id="algorithm1.16.16.m2.3" class="ltx_Math" alttext="(I_{j},Q_{j},\tilde{Q}_{j})" display="inline"><semantics id="algorithm1.16.16.m2.3a"><mrow id="algorithm1.16.16.m2.3.3.3" xref="algorithm1.16.16.m2.3.3.4.cmml"><mo maxsize="90%" minsize="90%" id="algorithm1.16.16.m2.3.3.3.4" xref="algorithm1.16.16.m2.3.3.4.cmml">(</mo><msub id="algorithm1.16.16.m2.1.1.1.1" xref="algorithm1.16.16.m2.1.1.1.1.cmml"><mi mathsize="90%" id="algorithm1.16.16.m2.1.1.1.1.2" xref="algorithm1.16.16.m2.1.1.1.1.2.cmml">I</mi><mi mathsize="90%" id="algorithm1.16.16.m2.1.1.1.1.3" xref="algorithm1.16.16.m2.1.1.1.1.3.cmml">j</mi></msub><mo mathsize="90%" id="algorithm1.16.16.m2.3.3.3.5" xref="algorithm1.16.16.m2.3.3.4.cmml">,</mo><msub id="algorithm1.16.16.m2.2.2.2.2" xref="algorithm1.16.16.m2.2.2.2.2.cmml"><mi mathsize="90%" id="algorithm1.16.16.m2.2.2.2.2.2" xref="algorithm1.16.16.m2.2.2.2.2.2.cmml">Q</mi><mi mathsize="90%" id="algorithm1.16.16.m2.2.2.2.2.3" xref="algorithm1.16.16.m2.2.2.2.2.3.cmml">j</mi></msub><mo mathsize="90%" id="algorithm1.16.16.m2.3.3.3.6" xref="algorithm1.16.16.m2.3.3.4.cmml">,</mo><msub id="algorithm1.16.16.m2.3.3.3.3" xref="algorithm1.16.16.m2.3.3.3.3.cmml"><mover accent="true" id="algorithm1.16.16.m2.3.3.3.3.2" xref="algorithm1.16.16.m2.3.3.3.3.2.cmml"><mi mathsize="90%" id="algorithm1.16.16.m2.3.3.3.3.2.2" xref="algorithm1.16.16.m2.3.3.3.3.2.2.cmml">Q</mi><mo mathsize="90%" id="algorithm1.16.16.m2.3.3.3.3.2.1" xref="algorithm1.16.16.m2.3.3.3.3.2.1.cmml">~</mo></mover><mi mathsize="90%" id="algorithm1.16.16.m2.3.3.3.3.3" xref="algorithm1.16.16.m2.3.3.3.3.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="algorithm1.16.16.m2.3.3.3.7" xref="algorithm1.16.16.m2.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.16.16.m2.3b"><vector id="algorithm1.16.16.m2.3.3.4.cmml" xref="algorithm1.16.16.m2.3.3.3"><apply id="algorithm1.16.16.m2.1.1.1.1.cmml" xref="algorithm1.16.16.m2.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.16.16.m2.1.1.1.1.1.cmml" xref="algorithm1.16.16.m2.1.1.1.1">subscript</csymbol><ci id="algorithm1.16.16.m2.1.1.1.1.2.cmml" xref="algorithm1.16.16.m2.1.1.1.1.2">𝐼</ci><ci id="algorithm1.16.16.m2.1.1.1.1.3.cmml" xref="algorithm1.16.16.m2.1.1.1.1.3">𝑗</ci></apply><apply id="algorithm1.16.16.m2.2.2.2.2.cmml" xref="algorithm1.16.16.m2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.16.16.m2.2.2.2.2.1.cmml" xref="algorithm1.16.16.m2.2.2.2.2">subscript</csymbol><ci id="algorithm1.16.16.m2.2.2.2.2.2.cmml" xref="algorithm1.16.16.m2.2.2.2.2.2">𝑄</ci><ci id="algorithm1.16.16.m2.2.2.2.2.3.cmml" xref="algorithm1.16.16.m2.2.2.2.2.3">𝑗</ci></apply><apply id="algorithm1.16.16.m2.3.3.3.3.cmml" xref="algorithm1.16.16.m2.3.3.3.3"><csymbol cd="ambiguous" id="algorithm1.16.16.m2.3.3.3.3.1.cmml" xref="algorithm1.16.16.m2.3.3.3.3">subscript</csymbol><apply id="algorithm1.16.16.m2.3.3.3.3.2.cmml" xref="algorithm1.16.16.m2.3.3.3.3.2"><ci id="algorithm1.16.16.m2.3.3.3.3.2.1.cmml" xref="algorithm1.16.16.m2.3.3.3.3.2.1">~</ci><ci id="algorithm1.16.16.m2.3.3.3.3.2.2.cmml" xref="algorithm1.16.16.m2.3.3.3.3.2.2">𝑄</ci></apply><ci id="algorithm1.16.16.m2.3.3.3.3.3.cmml" xref="algorithm1.16.16.m2.3.3.3.3.3">𝑗</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.16.m2.3c">(I_{j},Q_{j},\tilde{Q}_{j})</annotation></semantics></math><span id="algorithm1.16.16.6" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="algorithm1.17.17" class="ltx_listingline">
<span id="algorithm1.17.17.1" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.17.17.2" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.17.17.3" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.17.17.4" class="ltx_text" style="font-size:90%;">
</span><math id="algorithm1.17.17.m1.1" class="ltx_Math" alttext="\mathcal{L}=\mathcal{L}_{CE}+\mathcal{L}_{m}" display="inline"><semantics id="algorithm1.17.17.m1.1a"><mrow id="algorithm1.17.17.m1.1.1" xref="algorithm1.17.17.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="algorithm1.17.17.m1.1.1.2" xref="algorithm1.17.17.m1.1.1.2.cmml">ℒ</mi><mo mathsize="90%" id="algorithm1.17.17.m1.1.1.1" xref="algorithm1.17.17.m1.1.1.1.cmml">=</mo><mrow id="algorithm1.17.17.m1.1.1.3" xref="algorithm1.17.17.m1.1.1.3.cmml"><msub id="algorithm1.17.17.m1.1.1.3.2" xref="algorithm1.17.17.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="algorithm1.17.17.m1.1.1.3.2.2" xref="algorithm1.17.17.m1.1.1.3.2.2.cmml">ℒ</mi><mrow id="algorithm1.17.17.m1.1.1.3.2.3" xref="algorithm1.17.17.m1.1.1.3.2.3.cmml"><mi mathsize="90%" id="algorithm1.17.17.m1.1.1.3.2.3.2" xref="algorithm1.17.17.m1.1.1.3.2.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="algorithm1.17.17.m1.1.1.3.2.3.1" xref="algorithm1.17.17.m1.1.1.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="algorithm1.17.17.m1.1.1.3.2.3.3" xref="algorithm1.17.17.m1.1.1.3.2.3.3.cmml">E</mi></mrow></msub><mo mathsize="90%" id="algorithm1.17.17.m1.1.1.3.1" xref="algorithm1.17.17.m1.1.1.3.1.cmml">+</mo><msub id="algorithm1.17.17.m1.1.1.3.3" xref="algorithm1.17.17.m1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="algorithm1.17.17.m1.1.1.3.3.2" xref="algorithm1.17.17.m1.1.1.3.3.2.cmml">ℒ</mi><mi mathsize="90%" id="algorithm1.17.17.m1.1.1.3.3.3" xref="algorithm1.17.17.m1.1.1.3.3.3.cmml">m</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.17.17.m1.1b"><apply id="algorithm1.17.17.m1.1.1.cmml" xref="algorithm1.17.17.m1.1.1"><eq id="algorithm1.17.17.m1.1.1.1.cmml" xref="algorithm1.17.17.m1.1.1.1"></eq><ci id="algorithm1.17.17.m1.1.1.2.cmml" xref="algorithm1.17.17.m1.1.1.2">ℒ</ci><apply id="algorithm1.17.17.m1.1.1.3.cmml" xref="algorithm1.17.17.m1.1.1.3"><plus id="algorithm1.17.17.m1.1.1.3.1.cmml" xref="algorithm1.17.17.m1.1.1.3.1"></plus><apply id="algorithm1.17.17.m1.1.1.3.2.cmml" xref="algorithm1.17.17.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.1.1.3.2.1.cmml" xref="algorithm1.17.17.m1.1.1.3.2">subscript</csymbol><ci id="algorithm1.17.17.m1.1.1.3.2.2.cmml" xref="algorithm1.17.17.m1.1.1.3.2.2">ℒ</ci><apply id="algorithm1.17.17.m1.1.1.3.2.3.cmml" xref="algorithm1.17.17.m1.1.1.3.2.3"><times id="algorithm1.17.17.m1.1.1.3.2.3.1.cmml" xref="algorithm1.17.17.m1.1.1.3.2.3.1"></times><ci id="algorithm1.17.17.m1.1.1.3.2.3.2.cmml" xref="algorithm1.17.17.m1.1.1.3.2.3.2">𝐶</ci><ci id="algorithm1.17.17.m1.1.1.3.2.3.3.cmml" xref="algorithm1.17.17.m1.1.1.3.2.3.3">𝐸</ci></apply></apply><apply id="algorithm1.17.17.m1.1.1.3.3.cmml" xref="algorithm1.17.17.m1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.1.1.3.3.1.cmml" xref="algorithm1.17.17.m1.1.1.3.3">subscript</csymbol><ci id="algorithm1.17.17.m1.1.1.3.3.2.cmml" xref="algorithm1.17.17.m1.1.1.3.3.2">ℒ</ci><ci id="algorithm1.17.17.m1.1.1.3.3.3.cmml" xref="algorithm1.17.17.m1.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.17.m1.1c">\mathcal{L}=\mathcal{L}_{CE}+\mathcal{L}_{m}</annotation></semantics></math><span id="algorithm1.17.17.5" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="algorithm1.20.21" class="ltx_listingline">
<span id="algorithm1.20.21.1" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.20.21.2" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.20.21.3" class="ltx_text ltx_font_bold" style="font-size:90%;">else</span><span id="algorithm1.20.21.4" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="algorithm1.18.18" class="ltx_listingline">
<span id="algorithm1.18.18.1" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.18.18.2" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.18.18.3" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.18.18.4" class="ltx_text" style="font-size:90%;">
</span><math id="algorithm1.18.18.m1.1" class="ltx_Math" alttext="\mathcal{L}=\mathcal{L}_{CE}" display="inline"><semantics id="algorithm1.18.18.m1.1a"><mrow id="algorithm1.18.18.m1.1.1" xref="algorithm1.18.18.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="algorithm1.18.18.m1.1.1.2" xref="algorithm1.18.18.m1.1.1.2.cmml">ℒ</mi><mo mathsize="90%" id="algorithm1.18.18.m1.1.1.1" xref="algorithm1.18.18.m1.1.1.1.cmml">=</mo><msub id="algorithm1.18.18.m1.1.1.3" xref="algorithm1.18.18.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="algorithm1.18.18.m1.1.1.3.2" xref="algorithm1.18.18.m1.1.1.3.2.cmml">ℒ</mi><mrow id="algorithm1.18.18.m1.1.1.3.3" xref="algorithm1.18.18.m1.1.1.3.3.cmml"><mi mathsize="90%" id="algorithm1.18.18.m1.1.1.3.3.2" xref="algorithm1.18.18.m1.1.1.3.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="algorithm1.18.18.m1.1.1.3.3.1" xref="algorithm1.18.18.m1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="algorithm1.18.18.m1.1.1.3.3.3" xref="algorithm1.18.18.m1.1.1.3.3.3.cmml">E</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.18.18.m1.1b"><apply id="algorithm1.18.18.m1.1.1.cmml" xref="algorithm1.18.18.m1.1.1"><eq id="algorithm1.18.18.m1.1.1.1.cmml" xref="algorithm1.18.18.m1.1.1.1"></eq><ci id="algorithm1.18.18.m1.1.1.2.cmml" xref="algorithm1.18.18.m1.1.1.2">ℒ</ci><apply id="algorithm1.18.18.m1.1.1.3.cmml" xref="algorithm1.18.18.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.18.18.m1.1.1.3.1.cmml" xref="algorithm1.18.18.m1.1.1.3">subscript</csymbol><ci id="algorithm1.18.18.m1.1.1.3.2.cmml" xref="algorithm1.18.18.m1.1.1.3.2">ℒ</ci><apply id="algorithm1.18.18.m1.1.1.3.3.cmml" xref="algorithm1.18.18.m1.1.1.3.3"><times id="algorithm1.18.18.m1.1.1.3.3.1.cmml" xref="algorithm1.18.18.m1.1.1.3.3.1"></times><ci id="algorithm1.18.18.m1.1.1.3.3.2.cmml" xref="algorithm1.18.18.m1.1.1.3.3.2">𝐶</ci><ci id="algorithm1.18.18.m1.1.1.3.3.3.cmml" xref="algorithm1.18.18.m1.1.1.3.3.3">𝐸</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.18.18.m1.1c">\mathcal{L}=\mathcal{L}_{CE}</annotation></semantics></math><span id="algorithm1.18.18.5" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="algorithm1.20.22" class="ltx_listingline">
<span id="algorithm1.20.22.1" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.20.22.2" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.20.22.3" class="ltx_text" style="font-size:90%;"> end if</span>
</div>
<div id="algorithm1.20.20" class="ltx_listingline">
<span id="algorithm1.20.20.1" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.20.20.2" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.20.20.3" class="ltx_text" style="font-size:90%;">update </span><math id="algorithm1.19.19.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="algorithm1.19.19.m1.1a"><mi mathsize="90%" id="algorithm1.19.19.m1.1.1" xref="algorithm1.19.19.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="algorithm1.19.19.m1.1b"><ci id="algorithm1.19.19.m1.1.1.cmml" xref="algorithm1.19.19.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.19.19.m1.1c">f</annotation></semantics></math><span id="algorithm1.20.20.4" class="ltx_text" style="font-size:90%;"> to minimize </span><math id="algorithm1.20.20.m2.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="algorithm1.20.20.m2.1a"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="algorithm1.20.20.m2.1.1" xref="algorithm1.20.20.m2.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="algorithm1.20.20.m2.1b"><ci id="algorithm1.20.20.m2.1.1.cmml" xref="algorithm1.20.20.m2.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.20.20.m2.1c">\mathcal{L}</annotation></semantics></math><span id="algorithm1.20.20.5" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="algorithm1.20.23" class="ltx_listingline">
<span id="algorithm1.20.23.1" class="ltx_text" style="font-size:90%;"> end for</span>
</div>
<div id="algorithm1.20.24" class="ltx_listingline">
<span id="algorithm1.20.24.1" class="ltx_text" style="font-size:90%;">
</span>
</div>
</div>
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.24.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>Q3R Training Procedure</figcaption>
</figure>
<div id="S4.SS1.p7" class="ltx_para ltx_noindent">
<p id="S4.SS1.p7.14" class="ltx_p"><span id="S4.SS1.p7.14.1" class="ltx_text ltx_font_bold">Training Procedure.</span>
Given the regularization term, <math id="S4.SS1.p7.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{m}" display="inline"><semantics id="S4.SS1.p7.1.m1.1a"><msub id="S4.SS1.p7.1.m1.1.1" xref="S4.SS1.p7.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p7.1.m1.1.1.2" xref="S4.SS1.p7.1.m1.1.1.2.cmml">ℒ</mi><mi id="S4.SS1.p7.1.m1.1.1.3" xref="S4.SS1.p7.1.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.1.m1.1b"><apply id="S4.SS1.p7.1.m1.1.1.cmml" xref="S4.SS1.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.1.m1.1.1.1.cmml" xref="S4.SS1.p7.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p7.1.m1.1.1.2.cmml" xref="S4.SS1.p7.1.m1.1.1.2">ℒ</ci><ci id="S4.SS1.p7.1.m1.1.1.3.cmml" xref="S4.SS1.p7.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.1.m1.1c">\mathcal{L}_{m}</annotation></semantics></math>, and the cross-entropy
loss between the predicted answer distribution and the ground truth answer prediction, <math id="S4.SS1.p7.2.m2.2" class="ltx_Math" alttext="\mathcal{L}_{CE}(\mathbf{a}_{i},\mathbf{a}_{i}^{*}|I_{i},Q_{i})" display="inline"><semantics id="S4.SS1.p7.2.m2.2a"><mrow id="S4.SS1.p7.2.m2.2.2" xref="S4.SS1.p7.2.m2.2.2.cmml"><msub id="S4.SS1.p7.2.m2.2.2.4" xref="S4.SS1.p7.2.m2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p7.2.m2.2.2.4.2" xref="S4.SS1.p7.2.m2.2.2.4.2.cmml">ℒ</mi><mrow id="S4.SS1.p7.2.m2.2.2.4.3" xref="S4.SS1.p7.2.m2.2.2.4.3.cmml"><mi id="S4.SS1.p7.2.m2.2.2.4.3.2" xref="S4.SS1.p7.2.m2.2.2.4.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p7.2.m2.2.2.4.3.1" xref="S4.SS1.p7.2.m2.2.2.4.3.1.cmml">​</mo><mi id="S4.SS1.p7.2.m2.2.2.4.3.3" xref="S4.SS1.p7.2.m2.2.2.4.3.3.cmml">E</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p7.2.m2.2.2.3" xref="S4.SS1.p7.2.m2.2.2.3.cmml">​</mo><mrow id="S4.SS1.p7.2.m2.2.2.2.2" xref="S4.SS1.p7.2.m2.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p7.2.m2.2.2.2.2.3" xref="S4.SS1.p7.2.m2.2.2.2.3.cmml">(</mo><msub id="S4.SS1.p7.2.m2.1.1.1.1.1" xref="S4.SS1.p7.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS1.p7.2.m2.1.1.1.1.1.2" xref="S4.SS1.p7.2.m2.1.1.1.1.1.2.cmml">𝐚</mi><mi id="S4.SS1.p7.2.m2.1.1.1.1.1.3" xref="S4.SS1.p7.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.p7.2.m2.2.2.2.2.4" xref="S4.SS1.p7.2.m2.2.2.2.3.cmml">,</mo><mrow id="S4.SS1.p7.2.m2.2.2.2.2.2" xref="S4.SS1.p7.2.m2.2.2.2.2.2.cmml"><msubsup id="S4.SS1.p7.2.m2.2.2.2.2.2.4" xref="S4.SS1.p7.2.m2.2.2.2.2.2.4.cmml"><mi id="S4.SS1.p7.2.m2.2.2.2.2.2.4.2.2" xref="S4.SS1.p7.2.m2.2.2.2.2.2.4.2.2.cmml">𝐚</mi><mi id="S4.SS1.p7.2.m2.2.2.2.2.2.4.2.3" xref="S4.SS1.p7.2.m2.2.2.2.2.2.4.2.3.cmml">i</mi><mo id="S4.SS1.p7.2.m2.2.2.2.2.2.4.3" xref="S4.SS1.p7.2.m2.2.2.2.2.2.4.3.cmml">∗</mo></msubsup><mo fence="false" id="S4.SS1.p7.2.m2.2.2.2.2.2.3" xref="S4.SS1.p7.2.m2.2.2.2.2.2.3.cmml">|</mo><mrow id="S4.SS1.p7.2.m2.2.2.2.2.2.2.2" xref="S4.SS1.p7.2.m2.2.2.2.2.2.2.3.cmml"><msub id="S4.SS1.p7.2.m2.2.2.2.2.2.1.1.1" xref="S4.SS1.p7.2.m2.2.2.2.2.2.1.1.1.cmml"><mi id="S4.SS1.p7.2.m2.2.2.2.2.2.1.1.1.2" xref="S4.SS1.p7.2.m2.2.2.2.2.2.1.1.1.2.cmml">I</mi><mi id="S4.SS1.p7.2.m2.2.2.2.2.2.1.1.1.3" xref="S4.SS1.p7.2.m2.2.2.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.p7.2.m2.2.2.2.2.2.2.2.3" xref="S4.SS1.p7.2.m2.2.2.2.2.2.2.3.cmml">,</mo><msub id="S4.SS1.p7.2.m2.2.2.2.2.2.2.2.2" xref="S4.SS1.p7.2.m2.2.2.2.2.2.2.2.2.cmml"><mi id="S4.SS1.p7.2.m2.2.2.2.2.2.2.2.2.2" xref="S4.SS1.p7.2.m2.2.2.2.2.2.2.2.2.2.cmml">Q</mi><mi id="S4.SS1.p7.2.m2.2.2.2.2.2.2.2.2.3" xref="S4.SS1.p7.2.m2.2.2.2.2.2.2.2.2.3.cmml">i</mi></msub></mrow></mrow><mo stretchy="false" id="S4.SS1.p7.2.m2.2.2.2.2.5" xref="S4.SS1.p7.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.2.m2.2b"><apply id="S4.SS1.p7.2.m2.2.2.cmml" xref="S4.SS1.p7.2.m2.2.2"><times id="S4.SS1.p7.2.m2.2.2.3.cmml" xref="S4.SS1.p7.2.m2.2.2.3"></times><apply id="S4.SS1.p7.2.m2.2.2.4.cmml" xref="S4.SS1.p7.2.m2.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p7.2.m2.2.2.4.1.cmml" xref="S4.SS1.p7.2.m2.2.2.4">subscript</csymbol><ci id="S4.SS1.p7.2.m2.2.2.4.2.cmml" xref="S4.SS1.p7.2.m2.2.2.4.2">ℒ</ci><apply id="S4.SS1.p7.2.m2.2.2.4.3.cmml" xref="S4.SS1.p7.2.m2.2.2.4.3"><times id="S4.SS1.p7.2.m2.2.2.4.3.1.cmml" xref="S4.SS1.p7.2.m2.2.2.4.3.1"></times><ci id="S4.SS1.p7.2.m2.2.2.4.3.2.cmml" xref="S4.SS1.p7.2.m2.2.2.4.3.2">𝐶</ci><ci id="S4.SS1.p7.2.m2.2.2.4.3.3.cmml" xref="S4.SS1.p7.2.m2.2.2.4.3.3">𝐸</ci></apply></apply><interval closure="open" id="S4.SS1.p7.2.m2.2.2.2.3.cmml" xref="S4.SS1.p7.2.m2.2.2.2.2"><apply id="S4.SS1.p7.2.m2.1.1.1.1.1.cmml" xref="S4.SS1.p7.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS1.p7.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p7.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS1.p7.2.m2.1.1.1.1.1.2">𝐚</ci><ci id="S4.SS1.p7.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS1.p7.2.m2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS1.p7.2.m2.2.2.2.2.2.cmml" xref="S4.SS1.p7.2.m2.2.2.2.2.2"><csymbol cd="latexml" id="S4.SS1.p7.2.m2.2.2.2.2.2.3.cmml" xref="S4.SS1.p7.2.m2.2.2.2.2.2.3">conditional</csymbol><apply id="S4.SS1.p7.2.m2.2.2.2.2.2.4.cmml" xref="S4.SS1.p7.2.m2.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p7.2.m2.2.2.2.2.2.4.1.cmml" xref="S4.SS1.p7.2.m2.2.2.2.2.2.4">superscript</csymbol><apply id="S4.SS1.p7.2.m2.2.2.2.2.2.4.2.cmml" xref="S4.SS1.p7.2.m2.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p7.2.m2.2.2.2.2.2.4.2.1.cmml" xref="S4.SS1.p7.2.m2.2.2.2.2.2.4">subscript</csymbol><ci id="S4.SS1.p7.2.m2.2.2.2.2.2.4.2.2.cmml" xref="S4.SS1.p7.2.m2.2.2.2.2.2.4.2.2">𝐚</ci><ci id="S4.SS1.p7.2.m2.2.2.2.2.2.4.2.3.cmml" xref="S4.SS1.p7.2.m2.2.2.2.2.2.4.2.3">𝑖</ci></apply><times id="S4.SS1.p7.2.m2.2.2.2.2.2.4.3.cmml" xref="S4.SS1.p7.2.m2.2.2.2.2.2.4.3"></times></apply><list id="S4.SS1.p7.2.m2.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p7.2.m2.2.2.2.2.2.2.2"><apply id="S4.SS1.p7.2.m2.2.2.2.2.2.1.1.1.cmml" xref="S4.SS1.p7.2.m2.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.2.m2.2.2.2.2.2.1.1.1.1.cmml" xref="S4.SS1.p7.2.m2.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p7.2.m2.2.2.2.2.2.1.1.1.2.cmml" xref="S4.SS1.p7.2.m2.2.2.2.2.2.1.1.1.2">𝐼</ci><ci id="S4.SS1.p7.2.m2.2.2.2.2.2.1.1.1.3.cmml" xref="S4.SS1.p7.2.m2.2.2.2.2.2.1.1.1.3">𝑖</ci></apply><apply id="S4.SS1.p7.2.m2.2.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p7.2.m2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p7.2.m2.2.2.2.2.2.2.2.2.1.cmml" xref="S4.SS1.p7.2.m2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p7.2.m2.2.2.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p7.2.m2.2.2.2.2.2.2.2.2.2">𝑄</ci><ci id="S4.SS1.p7.2.m2.2.2.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p7.2.m2.2.2.2.2.2.2.2.2.3">𝑖</ci></apply></list></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.2.m2.2c">\mathcal{L}_{CE}(\mathbf{a}_{i},\mathbf{a}_{i}^{*}|I_{i},Q_{i})</annotation></semantics></math>, we employ a multi-task training procedure <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>, where we treat each perturbation type as a different task, optimizing for each perturbation type individually.
As in Algorithm <a href="#algorithm1" title="In 4.1 Q3R Framework ‣ 4 Approach ‣ Learning from Lexical Perturbations for Consistent Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, for each input
image-question pair sampled from VQA v2, we compute <math id="S4.SS1.p7.3.m3.1" class="ltx_Math" alttext="\mathcal{L}_{CE}" display="inline"><semantics id="S4.SS1.p7.3.m3.1a"><msub id="S4.SS1.p7.3.m3.1.1" xref="S4.SS1.p7.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p7.3.m3.1.1.2" xref="S4.SS1.p7.3.m3.1.1.2.cmml">ℒ</mi><mrow id="S4.SS1.p7.3.m3.1.1.3" xref="S4.SS1.p7.3.m3.1.1.3.cmml"><mi id="S4.SS1.p7.3.m3.1.1.3.2" xref="S4.SS1.p7.3.m3.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p7.3.m3.1.1.3.1" xref="S4.SS1.p7.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p7.3.m3.1.1.3.3" xref="S4.SS1.p7.3.m3.1.1.3.3.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.3.m3.1b"><apply id="S4.SS1.p7.3.m3.1.1.cmml" xref="S4.SS1.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.3.m3.1.1.1.cmml" xref="S4.SS1.p7.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p7.3.m3.1.1.2.cmml" xref="S4.SS1.p7.3.m3.1.1.2">ℒ</ci><apply id="S4.SS1.p7.3.m3.1.1.3.cmml" xref="S4.SS1.p7.3.m3.1.1.3"><times id="S4.SS1.p7.3.m3.1.1.3.1.cmml" xref="S4.SS1.p7.3.m3.1.1.3.1"></times><ci id="S4.SS1.p7.3.m3.1.1.3.2.cmml" xref="S4.SS1.p7.3.m3.1.1.3.2">𝐶</ci><ci id="S4.SS1.p7.3.m3.1.1.3.3.cmml" xref="S4.SS1.p7.3.m3.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.3.m3.1c">\mathcal{L}_{CE}</annotation></semantics></math>.
Then, with probability <math id="S4.SS1.p7.4.m4.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS1.p7.4.m4.1a"><mi id="S4.SS1.p7.4.m4.1.1" xref="S4.SS1.p7.4.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.4.m4.1b"><ci id="S4.SS1.p7.4.m4.1.1.cmml" xref="S4.SS1.p7.4.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.4.m4.1c">r</annotation></semantics></math>, we sample a perturbed pairing to compute our module weight loss.
Otherwise, we simply update the model using <math id="S4.SS1.p7.5.m5.1" class="ltx_Math" alttext="\mathcal{L}_{CE}" display="inline"><semantics id="S4.SS1.p7.5.m5.1a"><msub id="S4.SS1.p7.5.m5.1.1" xref="S4.SS1.p7.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p7.5.m5.1.1.2" xref="S4.SS1.p7.5.m5.1.1.2.cmml">ℒ</mi><mrow id="S4.SS1.p7.5.m5.1.1.3" xref="S4.SS1.p7.5.m5.1.1.3.cmml"><mi id="S4.SS1.p7.5.m5.1.1.3.2" xref="S4.SS1.p7.5.m5.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p7.5.m5.1.1.3.1" xref="S4.SS1.p7.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p7.5.m5.1.1.3.3" xref="S4.SS1.p7.5.m5.1.1.3.3.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.5.m5.1b"><apply id="S4.SS1.p7.5.m5.1.1.cmml" xref="S4.SS1.p7.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.5.m5.1.1.1.cmml" xref="S4.SS1.p7.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p7.5.m5.1.1.2.cmml" xref="S4.SS1.p7.5.m5.1.1.2">ℒ</ci><apply id="S4.SS1.p7.5.m5.1.1.3.cmml" xref="S4.SS1.p7.5.m5.1.1.3"><times id="S4.SS1.p7.5.m5.1.1.3.1.cmml" xref="S4.SS1.p7.5.m5.1.1.3.1"></times><ci id="S4.SS1.p7.5.m5.1.1.3.2.cmml" xref="S4.SS1.p7.5.m5.1.1.3.2">𝐶</ci><ci id="S4.SS1.p7.5.m5.1.1.3.3.cmml" xref="S4.SS1.p7.5.m5.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.5.m5.1c">\mathcal{L}_{CE}</annotation></semantics></math>.
When utilizing our loss, we sample a perturbation type, <math id="S4.SS1.p7.6.m6.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS1.p7.6.m6.1a"><mi id="S4.SS1.p7.6.m6.1.1" xref="S4.SS1.p7.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.6.m6.1b"><ci id="S4.SS1.p7.6.m6.1.1.cmml" xref="S4.SS1.p7.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.6.m6.1c">t</annotation></semantics></math>, from a categorical distribution, denoted <math id="S4.SS1.p7.7.m7.1" class="ltx_Math" alttext="\text{cat}(\mathcal{T}|\mathbf{p})" display="inline"><semantics id="S4.SS1.p7.7.m7.1a"><mrow id="S4.SS1.p7.7.m7.1.1" xref="S4.SS1.p7.7.m7.1.1.cmml"><mtext id="S4.SS1.p7.7.m7.1.1.3" xref="S4.SS1.p7.7.m7.1.1.3a.cmml">cat</mtext><mo lspace="0em" rspace="0em" id="S4.SS1.p7.7.m7.1.1.2" xref="S4.SS1.p7.7.m7.1.1.2.cmml">​</mo><mrow id="S4.SS1.p7.7.m7.1.1.1.1" xref="S4.SS1.p7.7.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p7.7.m7.1.1.1.1.2" xref="S4.SS1.p7.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p7.7.m7.1.1.1.1.1" xref="S4.SS1.p7.7.m7.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p7.7.m7.1.1.1.1.1.2" xref="S4.SS1.p7.7.m7.1.1.1.1.1.2.cmml">𝒯</mi><mo fence="false" id="S4.SS1.p7.7.m7.1.1.1.1.1.1" xref="S4.SS1.p7.7.m7.1.1.1.1.1.1.cmml">|</mo><mi id="S4.SS1.p7.7.m7.1.1.1.1.1.3" xref="S4.SS1.p7.7.m7.1.1.1.1.1.3.cmml">𝐩</mi></mrow><mo stretchy="false" id="S4.SS1.p7.7.m7.1.1.1.1.3" xref="S4.SS1.p7.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.7.m7.1b"><apply id="S4.SS1.p7.7.m7.1.1.cmml" xref="S4.SS1.p7.7.m7.1.1"><times id="S4.SS1.p7.7.m7.1.1.2.cmml" xref="S4.SS1.p7.7.m7.1.1.2"></times><ci id="S4.SS1.p7.7.m7.1.1.3a.cmml" xref="S4.SS1.p7.7.m7.1.1.3"><mtext id="S4.SS1.p7.7.m7.1.1.3.cmml" xref="S4.SS1.p7.7.m7.1.1.3">cat</mtext></ci><apply id="S4.SS1.p7.7.m7.1.1.1.1.1.cmml" xref="S4.SS1.p7.7.m7.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.p7.7.m7.1.1.1.1.1.1.cmml" xref="S4.SS1.p7.7.m7.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS1.p7.7.m7.1.1.1.1.1.2.cmml" xref="S4.SS1.p7.7.m7.1.1.1.1.1.2">𝒯</ci><ci id="S4.SS1.p7.7.m7.1.1.1.1.1.3.cmml" xref="S4.SS1.p7.7.m7.1.1.1.1.1.3">𝐩</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.7.m7.1c">\text{cat}(\mathcal{T}|\mathbf{p})</annotation></semantics></math>, over the set of perturbation types, <math id="S4.SS1.p7.8.m8.1" class="ltx_Math" alttext="\mathcal{T}" display="inline"><semantics id="S4.SS1.p7.8.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p7.8.m8.1.1" xref="S4.SS1.p7.8.m8.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.8.m8.1b"><ci id="S4.SS1.p7.8.m8.1.1.cmml" xref="S4.SS1.p7.8.m8.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.8.m8.1c">\mathcal{T}</annotation></semantics></math>, with probabilities, <math id="S4.SS1.p7.9.m9.1" class="ltx_Math" alttext="\mathbf{p}" display="inline"><semantics id="S4.SS1.p7.9.m9.1a"><mi id="S4.SS1.p7.9.m9.1.1" xref="S4.SS1.p7.9.m9.1.1.cmml">𝐩</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.9.m9.1b"><ci id="S4.SS1.p7.9.m9.1.1.cmml" xref="S4.SS1.p7.9.m9.1.1">𝐩</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.9.m9.1c">\mathbf{p}</annotation></semantics></math>.
We input the question <math id="S4.SS1.p7.10.m10.1" class="ltx_Math" alttext="Q_{j}" display="inline"><semantics id="S4.SS1.p7.10.m10.1a"><msub id="S4.SS1.p7.10.m10.1.1" xref="S4.SS1.p7.10.m10.1.1.cmml"><mi id="S4.SS1.p7.10.m10.1.1.2" xref="S4.SS1.p7.10.m10.1.1.2.cmml">Q</mi><mi id="S4.SS1.p7.10.m10.1.1.3" xref="S4.SS1.p7.10.m10.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.10.m10.1b"><apply id="S4.SS1.p7.10.m10.1.1.cmml" xref="S4.SS1.p7.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.10.m10.1.1.1.cmml" xref="S4.SS1.p7.10.m10.1.1">subscript</csymbol><ci id="S4.SS1.p7.10.m10.1.1.2.cmml" xref="S4.SS1.p7.10.m10.1.1.2">𝑄</ci><ci id="S4.SS1.p7.10.m10.1.1.3.cmml" xref="S4.SS1.p7.10.m10.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.10.m10.1c">Q_{j}</annotation></semantics></math> and the perturbation type into <math id="S4.SS1.p7.11.m11.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S4.SS1.p7.11.m11.1a"><mi id="S4.SS1.p7.11.m11.1.1" xref="S4.SS1.p7.11.m11.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.11.m11.1b"><ci id="S4.SS1.p7.11.m11.1.1.cmml" xref="S4.SS1.p7.11.m11.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.11.m11.1c">g</annotation></semantics></math> to obtain <math id="S4.SS1.p7.12.m12.1" class="ltx_Math" alttext="\tilde{Q}_{j}" display="inline"><semantics id="S4.SS1.p7.12.m12.1a"><msub id="S4.SS1.p7.12.m12.1.1" xref="S4.SS1.p7.12.m12.1.1.cmml"><mover accent="true" id="S4.SS1.p7.12.m12.1.1.2" xref="S4.SS1.p7.12.m12.1.1.2.cmml"><mi id="S4.SS1.p7.12.m12.1.1.2.2" xref="S4.SS1.p7.12.m12.1.1.2.2.cmml">Q</mi><mo id="S4.SS1.p7.12.m12.1.1.2.1" xref="S4.SS1.p7.12.m12.1.1.2.1.cmml">~</mo></mover><mi id="S4.SS1.p7.12.m12.1.1.3" xref="S4.SS1.p7.12.m12.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.12.m12.1b"><apply id="S4.SS1.p7.12.m12.1.1.cmml" xref="S4.SS1.p7.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.12.m12.1.1.1.cmml" xref="S4.SS1.p7.12.m12.1.1">subscript</csymbol><apply id="S4.SS1.p7.12.m12.1.1.2.cmml" xref="S4.SS1.p7.12.m12.1.1.2"><ci id="S4.SS1.p7.12.m12.1.1.2.1.cmml" xref="S4.SS1.p7.12.m12.1.1.2.1">~</ci><ci id="S4.SS1.p7.12.m12.1.1.2.2.cmml" xref="S4.SS1.p7.12.m12.1.1.2.2">𝑄</ci></apply><ci id="S4.SS1.p7.12.m12.1.1.3.cmml" xref="S4.SS1.p7.12.m12.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.12.m12.1c">\tilde{Q}_{j}</annotation></semantics></math> that differs from the input question according to the sampled type.
We use the perturbed question and original image-question pair, <math id="S4.SS1.p7.13.m13.3" class="ltx_Math" alttext="(I_{j},Q_{j},\tilde{Q}_{j})" display="inline"><semantics id="S4.SS1.p7.13.m13.3a"><mrow id="S4.SS1.p7.13.m13.3.3.3" xref="S4.SS1.p7.13.m13.3.3.4.cmml"><mo stretchy="false" id="S4.SS1.p7.13.m13.3.3.3.4" xref="S4.SS1.p7.13.m13.3.3.4.cmml">(</mo><msub id="S4.SS1.p7.13.m13.1.1.1.1" xref="S4.SS1.p7.13.m13.1.1.1.1.cmml"><mi id="S4.SS1.p7.13.m13.1.1.1.1.2" xref="S4.SS1.p7.13.m13.1.1.1.1.2.cmml">I</mi><mi id="S4.SS1.p7.13.m13.1.1.1.1.3" xref="S4.SS1.p7.13.m13.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.SS1.p7.13.m13.3.3.3.5" xref="S4.SS1.p7.13.m13.3.3.4.cmml">,</mo><msub id="S4.SS1.p7.13.m13.2.2.2.2" xref="S4.SS1.p7.13.m13.2.2.2.2.cmml"><mi id="S4.SS1.p7.13.m13.2.2.2.2.2" xref="S4.SS1.p7.13.m13.2.2.2.2.2.cmml">Q</mi><mi id="S4.SS1.p7.13.m13.2.2.2.2.3" xref="S4.SS1.p7.13.m13.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.SS1.p7.13.m13.3.3.3.6" xref="S4.SS1.p7.13.m13.3.3.4.cmml">,</mo><msub id="S4.SS1.p7.13.m13.3.3.3.3" xref="S4.SS1.p7.13.m13.3.3.3.3.cmml"><mover accent="true" id="S4.SS1.p7.13.m13.3.3.3.3.2" xref="S4.SS1.p7.13.m13.3.3.3.3.2.cmml"><mi id="S4.SS1.p7.13.m13.3.3.3.3.2.2" xref="S4.SS1.p7.13.m13.3.3.3.3.2.2.cmml">Q</mi><mo id="S4.SS1.p7.13.m13.3.3.3.3.2.1" xref="S4.SS1.p7.13.m13.3.3.3.3.2.1.cmml">~</mo></mover><mi id="S4.SS1.p7.13.m13.3.3.3.3.3" xref="S4.SS1.p7.13.m13.3.3.3.3.3.cmml">j</mi></msub><mo stretchy="false" id="S4.SS1.p7.13.m13.3.3.3.7" xref="S4.SS1.p7.13.m13.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.13.m13.3b"><vector id="S4.SS1.p7.13.m13.3.3.4.cmml" xref="S4.SS1.p7.13.m13.3.3.3"><apply id="S4.SS1.p7.13.m13.1.1.1.1.cmml" xref="S4.SS1.p7.13.m13.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.13.m13.1.1.1.1.1.cmml" xref="S4.SS1.p7.13.m13.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p7.13.m13.1.1.1.1.2.cmml" xref="S4.SS1.p7.13.m13.1.1.1.1.2">𝐼</ci><ci id="S4.SS1.p7.13.m13.1.1.1.1.3.cmml" xref="S4.SS1.p7.13.m13.1.1.1.1.3">𝑗</ci></apply><apply id="S4.SS1.p7.13.m13.2.2.2.2.cmml" xref="S4.SS1.p7.13.m13.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p7.13.m13.2.2.2.2.1.cmml" xref="S4.SS1.p7.13.m13.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p7.13.m13.2.2.2.2.2.cmml" xref="S4.SS1.p7.13.m13.2.2.2.2.2">𝑄</ci><ci id="S4.SS1.p7.13.m13.2.2.2.2.3.cmml" xref="S4.SS1.p7.13.m13.2.2.2.2.3">𝑗</ci></apply><apply id="S4.SS1.p7.13.m13.3.3.3.3.cmml" xref="S4.SS1.p7.13.m13.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p7.13.m13.3.3.3.3.1.cmml" xref="S4.SS1.p7.13.m13.3.3.3.3">subscript</csymbol><apply id="S4.SS1.p7.13.m13.3.3.3.3.2.cmml" xref="S4.SS1.p7.13.m13.3.3.3.3.2"><ci id="S4.SS1.p7.13.m13.3.3.3.3.2.1.cmml" xref="S4.SS1.p7.13.m13.3.3.3.3.2.1">~</ci><ci id="S4.SS1.p7.13.m13.3.3.3.3.2.2.cmml" xref="S4.SS1.p7.13.m13.3.3.3.3.2.2">𝑄</ci></apply><ci id="S4.SS1.p7.13.m13.3.3.3.3.3.cmml" xref="S4.SS1.p7.13.m13.3.3.3.3.3">𝑗</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.13.m13.3c">(I_{j},Q_{j},\tilde{Q}_{j})</annotation></semantics></math>, to compute <math id="S4.SS1.p7.14.m14.1" class="ltx_Math" alttext="\mathcal{L}_{m}" display="inline"><semantics id="S4.SS1.p7.14.m14.1a"><msub id="S4.SS1.p7.14.m14.1.1" xref="S4.SS1.p7.14.m14.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p7.14.m14.1.1.2" xref="S4.SS1.p7.14.m14.1.1.2.cmml">ℒ</mi><mi id="S4.SS1.p7.14.m14.1.1.3" xref="S4.SS1.p7.14.m14.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.14.m14.1b"><apply id="S4.SS1.p7.14.m14.1.1.cmml" xref="S4.SS1.p7.14.m14.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.14.m14.1.1.1.cmml" xref="S4.SS1.p7.14.m14.1.1">subscript</csymbol><ci id="S4.SS1.p7.14.m14.1.1.2.cmml" xref="S4.SS1.p7.14.m14.1.1.2">ℒ</ci><ci id="S4.SS1.p7.14.m14.1.1.3.cmml" xref="S4.SS1.p7.14.m14.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.14.m14.1c">\mathcal{L}_{m}</annotation></semantics></math>.
The network is then updated to minimize the sum of these loss terms.
In practice, when operating on batches, we sample a batch of a particular perturbation type.
We noticed that this procedure offers a more stable learning process and better performance than mixing different perturbation types in a single batch.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<figure id="S5.T2" class="ltx_table">
<table id="S5.T2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.3.4.1" class="ltx_tr">
<th id="S5.T2.3.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S5.T2.3.4.1.1.1" class="ltx_text" style="font-size:90%;">Model</span></th>
<th id="S5.T2.3.4.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T2.3.4.1.2.1" class="ltx_text" style="font-size:90%;">Training Data</span></th>
<th id="S5.T2.3.4.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T2.3.4.1.3.1" class="ltx_text" style="font-size:90%;">VQA v2</span></th>
<th id="S5.T2.3.4.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" colspan="3"><span id="S5.T2.3.4.1.4.1" class="ltx_text" style="font-size:90%;">       Synonymous</span></th>
<th id="S5.T2.3.4.1.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" colspan="3"><span id="S5.T2.3.4.1.5.1" class="ltx_text" style="font-size:90%;">      Paraphrastic</span></th>
<th id="S5.T2.3.4.1.6" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" colspan="3"><span id="S5.T2.3.4.1.6.1" class="ltx_text" style="font-size:90%;">      Antonymous</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.3.3" class="ltx_tr">
<td id="S5.T2.3.3.4" class="ltx_td"></td>
<td id="S5.T2.3.3.5" class="ltx_td"></td>
<td id="S5.T2.3.3.6" class="ltx_td"></td>
<td id="S5.T2.3.3.7" class="ltx_td ltx_align_center"><span id="S5.T2.3.3.7.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Pert</span></td>
<td id="S5.T2.3.3.8" class="ltx_td ltx_align_center"><span id="S5.T2.3.3.8.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Ori</span></td>
<td id="S5.T2.1.1.1" class="ltx_td ltx_align_center">
<math id="S5.T2.1.1.1.m1.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="S5.T2.1.1.1.m1.1a"><mi mathsize="90%" mathvariant="normal" id="S5.T2.1.1.1.m1.1.1" xref="S5.T2.1.1.1.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.m1.1b"><ci id="S5.T2.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.m1.1c">\Delta</annotation></semantics></math><span id="S5.T2.1.1.1.1" class="ltx_text" style="font-size:90%;"></span>
</td>
<td id="S5.T2.3.3.9" class="ltx_td ltx_nopad_l ltx_align_center"><span id="S5.T2.3.3.9.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Pert</span></td>
<td id="S5.T2.3.3.10" class="ltx_td ltx_align_center"><span id="S5.T2.3.3.10.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Ori</span></td>
<td id="S5.T2.2.2.2" class="ltx_td ltx_align_center">
<math id="S5.T2.2.2.2.m1.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="S5.T2.2.2.2.m1.1a"><mi mathsize="90%" mathvariant="normal" id="S5.T2.2.2.2.m1.1.1" xref="S5.T2.2.2.2.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.m1.1b"><ci id="S5.T2.2.2.2.m1.1.1.cmml" xref="S5.T2.2.2.2.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.m1.1c">\Delta</annotation></semantics></math><span id="S5.T2.2.2.2.1" class="ltx_text" style="font-size:90%;"></span>
</td>
<td id="S5.T2.3.3.11" class="ltx_td ltx_nopad_l ltx_align_center"><span id="S5.T2.3.3.11.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Pert</span></td>
<td id="S5.T2.3.3.12" class="ltx_td ltx_align_center"><span id="S5.T2.3.3.12.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Ori</span></td>
<td id="S5.T2.3.3.3" class="ltx_td ltx_align_center"><math id="S5.T2.3.3.3.m1.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="S5.T2.3.3.3.m1.1a"><mi mathsize="90%" mathvariant="normal" id="S5.T2.3.3.3.m1.1.1" xref="S5.T2.3.3.3.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.m1.1b"><ci id="S5.T2.3.3.3.m1.1.1.cmml" xref="S5.T2.3.3.3.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.3.m1.1c">\Delta</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.3.5.1" class="ltx_tr">
<td id="S5.T2.3.5.1.1" class="ltx_td ltx_align_left ltx_border_t">
<span id="S5.T2.3.5.1.1.1" class="ltx_text" style="font-size:90%;">BAN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.3.5.1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib25" title="" class="ltx_ref">25</a><span id="S5.T2.3.5.1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S5.T2.3.5.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.5.1.2.1" class="ltx_text" style="font-size:90%;">VQA v2</span></td>
<td id="S5.T2.3.5.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.5.1.3.1" class="ltx_text" style="font-size:90%;">66.1</span></td>
<td id="S5.T2.3.5.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.5.1.4.1" class="ltx_text" style="font-size:90%;">64.5</span></td>
<td id="S5.T2.3.5.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.5.1.5.1" class="ltx_text" style="font-size:90%;">66.3</span></td>
<td id="S5.T2.3.5.1.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.5.1.6.1" class="ltx_text" style="font-size:90%;">-1.8</span></td>
<td id="S5.T2.3.5.1.7" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t"><span id="S5.T2.3.5.1.7.1" class="ltx_text" style="font-size:90%;">56.3</span></td>
<td id="S5.T2.3.5.1.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.5.1.8.1" class="ltx_text" style="font-size:90%;">56.7</span></td>
<td id="S5.T2.3.5.1.9" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.5.1.9.1" class="ltx_text" style="font-size:90%;">-0.4</span></td>
<td id="S5.T2.3.5.1.10" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t"><span id="S5.T2.3.5.1.10.1" class="ltx_text" style="font-size:90%;">73.9</span></td>
<td id="S5.T2.3.5.1.11" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.5.1.11.1" class="ltx_text" style="font-size:90%;">86.0</span></td>
<td id="S5.T2.3.5.1.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.5.1.12.1" class="ltx_text" style="font-size:90%;">-12.1</span></td>
</tr>
<tr id="S5.T2.3.6.2" class="ltx_tr">
<td id="S5.T2.3.6.2.1" class="ltx_td ltx_align_left ltx_border_t">
<span id="S5.T2.3.6.2.1.1" class="ltx_text" style="font-size:90%;">Transformer </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.3.6.2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib47" title="" class="ltx_ref">47</a><span id="S5.T2.3.6.2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S5.T2.3.6.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.6.2.2.1" class="ltx_text" style="font-size:90%;">VQA v2</span></td>
<td id="S5.T2.3.6.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.6.2.3.1" class="ltx_text" style="font-size:90%;">63.5</span></td>
<td id="S5.T2.3.6.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.6.2.4.1" class="ltx_text" style="font-size:90%;">61.0</span></td>
<td id="S5.T2.3.6.2.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.6.2.5.1" class="ltx_text" style="font-size:90%;">64.2</span></td>
<td id="S5.T2.3.6.2.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.6.2.6.1" class="ltx_text" style="font-size:90%;">-3.2</span></td>
<td id="S5.T2.3.6.2.7" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t"><span id="S5.T2.3.6.2.7.1" class="ltx_text" style="font-size:90%;">53.0</span></td>
<td id="S5.T2.3.6.2.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.6.2.8.1" class="ltx_text" style="font-size:90%;">54.7</span></td>
<td id="S5.T2.3.6.2.9" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.6.2.9.1" class="ltx_text" style="font-size:90%;">-1.7</span></td>
<td id="S5.T2.3.6.2.10" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t"><span id="S5.T2.3.6.2.10.1" class="ltx_text" style="font-size:90%;">73.0</span></td>
<td id="S5.T2.3.6.2.11" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.6.2.11.1" class="ltx_text" style="font-size:90%;">84.2</span></td>
<td id="S5.T2.3.6.2.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.6.2.12.1" class="ltx_text" style="font-size:90%;">-11.2</span></td>
</tr>
<tr id="S5.T2.3.7.3" class="ltx_tr">
<td id="S5.T2.3.7.3.1" class="ltx_td ltx_align_left ltx_border_t">
<span id="S5.T2.3.7.3.1.1" class="ltx_text" style="font-size:90%;">StackNMN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.3.7.3.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib16" title="" class="ltx_ref">16</a><span id="S5.T2.3.7.3.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S5.T2.3.7.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.7.3.2.1" class="ltx_text" style="font-size:90%;">VQA v2</span></td>
<td id="S5.T2.3.7.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.7.3.3.1" class="ltx_text" style="font-size:90%;">62.7</span></td>
<td id="S5.T2.3.7.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.7.3.4.1" class="ltx_text" style="font-size:90%;">61.2</span></td>
<td id="S5.T2.3.7.3.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.7.3.5.1" class="ltx_text" style="font-size:90%;">63.5</span></td>
<td id="S5.T2.3.7.3.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.7.3.6.1" class="ltx_text" style="font-size:90%;">-2.3</span></td>
<td id="S5.T2.3.7.3.7" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t"><span id="S5.T2.3.7.3.7.1" class="ltx_text" style="font-size:90%;">53.2</span></td>
<td id="S5.T2.3.7.3.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.7.3.8.1" class="ltx_text" style="font-size:90%;">53.6</span></td>
<td id="S5.T2.3.7.3.9" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.7.3.9.1" class="ltx_text" style="font-size:90%;">-0.4</span></td>
<td id="S5.T2.3.7.3.10" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t"><span id="S5.T2.3.7.3.10.1" class="ltx_text" style="font-size:90%;">74.8</span></td>
<td id="S5.T2.3.7.3.11" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.7.3.11.1" class="ltx_text" style="font-size:90%;">84.9</span></td>
<td id="S5.T2.3.7.3.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.7.3.12.1" class="ltx_text" style="font-size:90%;">-10.1</span></td>
</tr>
<tr id="S5.T2.3.8.4" class="ltx_tr">
<td id="S5.T2.3.8.4.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">
<span id="S5.T2.3.8.4.1.1" class="ltx_text" style="font-size:90%;">XNM </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.3.8.4.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib43" title="" class="ltx_ref">43</a><span id="S5.T2.3.8.4.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S5.T2.3.8.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S5.T2.3.8.4.2.1" class="ltx_text" style="font-size:90%;">VQA v2</span></td>
<td id="S5.T2.3.8.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S5.T2.3.8.4.3.1" class="ltx_text" style="font-size:90%;">64.5</span></td>
<td id="S5.T2.3.8.4.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S5.T2.3.8.4.4.1" class="ltx_text" style="font-size:90%;">62.8</span></td>
<td id="S5.T2.3.8.4.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S5.T2.3.8.4.5.1" class="ltx_text" style="font-size:90%;">65.2</span></td>
<td id="S5.T2.3.8.4.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S5.T2.3.8.4.6.1" class="ltx_text" style="font-size:90%;">-2.4</span></td>
<td id="S5.T2.3.8.4.7" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b ltx_border_t"><span id="S5.T2.3.8.4.7.1" class="ltx_text" style="font-size:90%;">55.6</span></td>
<td id="S5.T2.3.8.4.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S5.T2.3.8.4.8.1" class="ltx_text" style="font-size:90%;">56.8</span></td>
<td id="S5.T2.3.8.4.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S5.T2.3.8.4.9.1" class="ltx_text" style="font-size:90%;">-1.2</span></td>
<td id="S5.T2.3.8.4.10" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b ltx_border_t"><span id="S5.T2.3.8.4.10.1" class="ltx_text" style="font-size:90%;">74.3</span></td>
<td id="S5.T2.3.8.4.11" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S5.T2.3.8.4.11.1" class="ltx_text" style="font-size:90%;">85.1</span></td>
<td id="S5.T2.3.8.4.12" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S5.T2.3.8.4.12.1" class="ltx_text" style="font-size:90%;">-10.8</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 2: </span>Accuracy on the VQA v2 validation set as well as VQA P2 subsets. <span id="S5.T2.14.1" class="ltx_text ltx_font_italic">Ori</span> and <span id="S5.T2.15.2" class="ltx_text ltx_font_italic">Pert</span> refer to the set of questions before and after applying a particular perturbation, respectively, and <math id="S5.T2.5.m1.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="S5.T2.5.m1.1b"><mi mathvariant="normal" id="S5.T2.5.m1.1.1" xref="S5.T2.5.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S5.T2.5.m1.1c"><ci id="S5.T2.5.m1.1.1.cmml" xref="S5.T2.5.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.m1.1d">\Delta</annotation></semantics></math> is the difference in performance between these sets.</figcaption>
</figure>
<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p"><span id="S5.p1.1.1" class="ltx_text ltx_font_bold">Data and Metrics.</span>
We use VQA v2 (Appendix <a href="#A3" title="Appendix C Additional Dataset Information ‣ Learning from Lexical Perturbations for Consistent Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>) for training and VQA P2 for our main evaluations.
Since our goal is to benchmark and advance existing models’ consistency, it requires groundtruth answer labels for each test question.
Since answers for the VQA v2 test sets are not publicly available, we use questions from the validation set for testing and never use it during training, as is common for evaluating on annotated subsets of VQA v2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>.
Our metrics are standard VQA accuracy as well as the consensus score (CS) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> between pairs of related questions.<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>A non-zero CS for a pair of questions requires a model to answer both questions correctly <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>.</span></span></span></p>
</div>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.1" class="ltx_p"><span id="S5.p2.1.1" class="ltx_text ltx_font_bold">Models.</span> Existing VQA literature is vast <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>, <a href="#bib.bib51" title="" class="ltx_ref">51</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> and the goal of our work is not to exhaustively study VQA models.
We focus on the consistency and robustness of models in response to linguistically perturbed data.
Therefore, we pick representative models for our evaluations.
<span id="S5.p2.1.2" class="ltx_text ltx_font_bold">BAN</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> is
a bilinear model that achieves the single-model top performance on VQA v2 without external data.
BAN uses bilinear co-attention with residual connections to model the interactions between image regions and words.
<span id="S5.p2.1.3" class="ltx_text ltx_font_bold">Transformer</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> is a top performing architecture that acts as a multi-modal encoder.
For fair comparison, we do not use large-scale pre-training.
As described in <span id="S5.p2.1.4" class="ltx_ERROR undefined">\secref</span>sec:nmn_arch, <span id="S5.p2.1.5" class="ltx_text ltx_font_bold">StackNMN</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> and <span id="S5.p2.1.6" class="ltx_text ltx_font_bold">XNM</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> are examples of expert-free, end-to-end trainable NMNs.
We experiment with both models as well as a hybrid, called <span id="S5.p2.1.7" class="ltx_text ltx_font_bold">HybridNet</span> (see <span id="S5.p2.1.8" class="ltx_ERROR undefined">\secref</span>sec:nmn_arch).
Experiments with BAN and Transformer examine the consistency of non-NMN state-of-the-art architectures.
The NMN experiments explore the performance of different module implementations when employing our framework.</p>
</div>
<div id="S5.p3" class="ltx_para ltx_noindent">
<p id="S5.p3.2" class="ltx_p"><span id="S5.p3.2.1" class="ltx_text ltx_font_bold">Implementation.</span>
For fair comparison, all models use the same visual features from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, input textual features from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>, and random seed of 0.
Whenever possible, we use publicly available implementations.
For Q3R, <math id="S5.p3.1.m1.1" class="ltx_Math" alttext="\lambda=1.0" display="inline"><semantics id="S5.p3.1.m1.1a"><mrow id="S5.p3.1.m1.1.1" xref="S5.p3.1.m1.1.1.cmml"><mi id="S5.p3.1.m1.1.1.2" xref="S5.p3.1.m1.1.1.2.cmml">λ</mi><mo id="S5.p3.1.m1.1.1.1" xref="S5.p3.1.m1.1.1.1.cmml">=</mo><mn id="S5.p3.1.m1.1.1.3" xref="S5.p3.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.1.m1.1b"><apply id="S5.p3.1.m1.1.1.cmml" xref="S5.p3.1.m1.1.1"><eq id="S5.p3.1.m1.1.1.1.cmml" xref="S5.p3.1.m1.1.1.1"></eq><ci id="S5.p3.1.m1.1.1.2.cmml" xref="S5.p3.1.m1.1.1.2">𝜆</ci><cn type="float" id="S5.p3.1.m1.1.1.3.cmml" xref="S5.p3.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.1.m1.1c">\lambda=1.0</annotation></semantics></math> and <math id="S5.p3.2.m2.1" class="ltx_Math" alttext="r=0.2" display="inline"><semantics id="S5.p3.2.m2.1a"><mrow id="S5.p3.2.m2.1.1" xref="S5.p3.2.m2.1.1.cmml"><mi id="S5.p3.2.m2.1.1.2" xref="S5.p3.2.m2.1.1.2.cmml">r</mi><mo id="S5.p3.2.m2.1.1.1" xref="S5.p3.2.m2.1.1.1.cmml">=</mo><mn id="S5.p3.2.m2.1.1.3" xref="S5.p3.2.m2.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.2.m2.1b"><apply id="S5.p3.2.m2.1.1.cmml" xref="S5.p3.2.m2.1.1"><eq id="S5.p3.2.m2.1.1.1.cmml" xref="S5.p3.2.m2.1.1.1"></eq><ci id="S5.p3.2.m2.1.1.2.cmml" xref="S5.p3.2.m2.1.1.2">𝑟</ci><cn type="float" id="S5.p3.2.m2.1.1.3.cmml" xref="S5.p3.2.m2.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.2.m2.1c">r=0.2</annotation></semantics></math> for all experiments and we use a L1 loss for our distance metric.
Please see Appendix <a href="#A1" title="Appendix A Implementation Details ‣ Learning from Lexical Perturbations for Consistent Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a> for details.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Benchmarking Robustness with VQA-P2</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.3" class="ltx_p">We benchmark existing models on their robustness against controlled lexical
perturbations, as shown in <span id="S5.SS1.p1.3.1" class="ltx_ERROR undefined">\tabref</span>tab:accuracies.
Interestingly, we see that the different classes of models have less trouble with paraphrastic changes than they do with synonymous, with the average drop in performance being <math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="-0.9" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mo id="S5.SS1.p1.1.m1.1.1a" xref="S5.SS1.p1.1.m1.1.1.cmml">−</mo><mn id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><minus id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"></minus><cn type="float" id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">-0.9</annotation></semantics></math> compared to <math id="S5.SS1.p1.2.m2.1" class="ltx_Math" alttext="-2.4" display="inline"><semantics id="S5.SS1.p1.2.m2.1a"><mrow id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><mo id="S5.SS1.p1.2.m2.1.1a" xref="S5.SS1.p1.2.m2.1.1.cmml">−</mo><mn id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml">2.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><minus id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"></minus><cn type="float" id="S5.SS1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2">2.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">-2.4</annotation></semantics></math>.
This is likely due to the fact that paraphrastic changes tend to effect transitional phrases (<span id="S5.SS1.p1.3.2" class="ltx_text ltx_font_slanted">e.g.,</span> “<span id="S5.SS1.p1.3.3" class="ltx_text ltx_font_italic">be considered</span>”), which models may ignore <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>, whereas synonymous changes effect these as well as concept mentions (<span id="S5.SS1.p1.3.4" class="ltx_text ltx_font_slanted">e.g.,</span> “<span id="S5.SS1.p1.3.5" class="ltx_text ltx_font_italic">car</span>”) that are needed to answer the question.
We see that models struggle the most with antonymous changes, dropping at least <math id="S5.SS1.p1.3.m3.1" class="ltx_Math" alttext="-10.1" display="inline"><semantics id="S5.SS1.p1.3.m3.1a"><mrow id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml"><mo id="S5.SS1.p1.3.m3.1.1a" xref="S5.SS1.p1.3.m3.1.1.cmml">−</mo><mn id="S5.SS1.p1.3.m3.1.1.2" xref="S5.SS1.p1.3.m3.1.1.2.cmml">10.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><apply id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1"><minus id="S5.SS1.p1.3.m3.1.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1"></minus><cn type="float" id="S5.SS1.p1.3.m3.1.1.2.cmml" xref="S5.SS1.p1.3.m3.1.1.2">10.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">-10.1</annotation></semantics></math>.
Despite having lower VQA v2 accuracy, the NMN architectures perform better on the perturbed antonymous questions compared to BAN and Transformer.
The results suggest that the Transformer architecture <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> trained from scratch is one of the less robust architectures across the different types of perturbations.
Overall, we see that existing models struggle with these controlled variations across the board, where the largest difficulties appear on the logical consistency measured with antonymous perturbations and concept mention consistency measured with synonymous perturbations.
To our knowledge, this is the first study of
VQA robustness analysis on different types of linguistic variations,</p>
</div>
<figure id="S5.F5" class="ltx_figure"><img src="/html/2011.13406/assets/x6.png" id="S5.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="392" height="191" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F5.2.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S5.F5.3.2" class="ltx_text" style="font-size:90%;">Visual attentions and selected modules across reasoning steps.
Attention weights are indicated by the transparency of the bounding box; red boxes are the highest weighted regions. Please see Appendix <a href="#A5" title="Appendix E Output Examples ‣ Learning from Lexical Perturbations for Consistent Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">E</span></a> for more examples.</span></figcaption>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Improving Model Robustness using Q3R</h3>

<figure id="S5.T3" class="ltx_table">
<table id="S5.T3.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.2.1.1" class="ltx_tr">
<th id="S5.T3.2.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_t"></th>
<th id="S5.T3.2.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3"><span id="S5.T3.2.1.1.2.1" class="ltx_text" style="font-size:90%;">VQA P2</span></th>
<th id="S5.T3.2.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.2.1.1.3.1" class="ltx_text" style="font-size:90%;">VQA v2</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.2.2.1" class="ltx_tr">
<th id="S5.T3.2.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T3.2.2.1.1.1" class="ltx_text" style="font-size:90%;">Model</span></th>
<td id="S5.T3.2.2.1.2" class="ltx_td ltx_align_center"><span id="S5.T3.2.2.1.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Pert</span></td>
<td id="S5.T3.2.2.1.3" class="ltx_td ltx_align_center"><span id="S5.T3.2.2.1.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Ori</span></td>
<td id="S5.T3.2.2.1.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.2.2.1.4.1" class="ltx_text" style="font-size:90%;">CS</span></td>
<td id="S5.T3.2.2.1.5" class="ltx_td"></td>
</tr>
<tr id="S5.T3.2.3.2" class="ltx_tr">
<th id="S5.T3.2.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S5.T3.2.3.2.1.1" class="ltx_text" style="font-size:90%;">StackNMN</span></th>
<th id="S5.T3.2.3.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.2.3.2.2.1" class="ltx_text" style="font-size:90%;">63.3</span></th>
<th id="S5.T3.2.3.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.2.3.2.3.1" class="ltx_text" style="font-size:90%;">66.9</span></th>
<th id="S5.T3.2.3.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T3.2.3.2.4.1" class="ltx_text" style="font-size:90%;">66.2</span></th>
<th id="S5.T3.2.3.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.2.3.2.5.1" class="ltx_text" style="font-size:90%;">62.6</span></th>
</tr>
<tr id="S5.T3.2.4.3" class="ltx_tr">
<th id="S5.T3.2.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T3.2.4.3.1.1" class="ltx_text" style="font-size:90%;">+Q3R</span></th>
<td id="S5.T3.2.4.3.2" class="ltx_td ltx_align_center"><span id="S5.T3.2.4.3.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">66.9</span></td>
<td id="S5.T3.2.4.3.3" class="ltx_td ltx_align_center"><span id="S5.T3.2.4.3.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">67.4</span></td>
<td id="S5.T3.2.4.3.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.2.4.3.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">72.2</span></td>
<td id="S5.T3.2.4.3.5" class="ltx_td ltx_align_center"><span id="S5.T3.2.4.3.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">62.7</span></td>
</tr>
<tr id="S5.T3.2.5.4" class="ltx_tr">
<th id="S5.T3.2.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S5.T3.2.5.4.1.1" class="ltx_text" style="font-size:90%;">HybridNet</span></th>
<th id="S5.T3.2.5.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.2.5.4.2.1" class="ltx_text" style="font-size:90%;">63.3</span></th>
<th id="S5.T3.2.5.4.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.2.5.4.3.1" class="ltx_text" style="font-size:90%;">67.0</span></th>
<th id="S5.T3.2.5.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T3.2.5.4.4.1" class="ltx_text" style="font-size:90%;">66.6</span></th>
<th id="S5.T3.2.5.4.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.2.5.4.5.1" class="ltx_text" style="font-size:90%;">63.0</span></th>
</tr>
<tr id="S5.T3.2.6.5" class="ltx_tr">
<th id="S5.T3.2.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T3.2.6.5.1.1" class="ltx_text" style="font-size:90%;">+Q3R</span></th>
<td id="S5.T3.2.6.5.2" class="ltx_td ltx_align_center"><span id="S5.T3.2.6.5.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">67.0</span></td>
<td id="S5.T3.2.6.5.3" class="ltx_td ltx_align_center"><span id="S5.T3.2.6.5.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">67.4</span></td>
<td id="S5.T3.2.6.5.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.2.6.5.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">72.5</span></td>
<td id="S5.T3.2.6.5.5" class="ltx_td ltx_align_center"><span id="S5.T3.2.6.5.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">63.1</span></td>
</tr>
<tr id="S5.T3.2.7.6" class="ltx_tr">
<th id="S5.T3.2.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S5.T3.2.7.6.1.1" class="ltx_text" style="font-size:90%;">XNM</span></th>
<th id="S5.T3.2.7.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.2.7.6.2.1" class="ltx_text" style="font-size:90%;">64.7</span></th>
<th id="S5.T3.2.7.6.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.2.7.6.3.1" class="ltx_text" style="font-size:90%;">68.3</span></th>
<th id="S5.T3.2.7.6.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T3.2.7.6.4.1" class="ltx_text" style="font-size:90%;">68.8</span></th>
<th id="S5.T3.2.7.6.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.2.7.6.5.1" class="ltx_text" style="font-size:90%;">64.5</span></th>
</tr>
<tr id="S5.T3.2.8.7" class="ltx_tr">
<th id="S5.T3.2.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b"><span id="S5.T3.2.8.7.1.1" class="ltx_text" style="font-size:90%;">+Q3R</span></th>
<td id="S5.T3.2.8.7.2" class="ltx_td ltx_align_center ltx_border_b"><span id="S5.T3.2.8.7.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">68.1</span></td>
<td id="S5.T3.2.8.7.3" class="ltx_td ltx_align_center ltx_border_b"><span id="S5.T3.2.8.7.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">68.9</span></td>
<td id="S5.T3.2.8.7.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S5.T3.2.8.7.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">74.4</span></td>
<td id="S5.T3.2.8.7.5" class="ltx_td ltx_align_center ltx_border_b"><span id="S5.T3.2.8.7.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">64.7</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 3: </span>Effect of adding Q3R to different NMNs, measured by accuracy and CS. <span id="S5.T3.9.1" class="ltx_text ltx_font_italic">Pert</span> denotes perturbed questions; <span id="S5.T3.10.2" class="ltx_text ltx_font_italic">Ori</span> are the corresponding questions in VQA v2.</figcaption>
</figure>
<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">We evaluate the effect of adding Q3R to different NMN architectures. <span id="S5.SS2.p1.1.1" class="ltx_ERROR undefined">\tabref</span>tab:regularization_p2_acc shows that,
on VQA P2, adding our framework (+Q3R) results in significant improvements over the base models for both accuracy and CS.
We also measure validation accuracy on VQA v2 in <span id="S5.SS2.p1.1.2" class="ltx_ERROR undefined">\tabref</span>tab:regularization_p2_acc, which shows modest yet consistent gains, although our focus is on consistency, not overall VQA v2 accuracy.
This shows that models regularized by Q3R generally see improvements in consistency and overall performance, including on VQA v2.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para ltx_noindent">
<p id="S5.SS2.p2.1" class="ltx_p"><span id="S5.SS2.p2.1.1" class="ltx_text ltx_font_bold">Analysis by Perturbation Types.</span>
A benefit of having information on the specific types of linguistic variations is that we can profile a model’s performance by each type to assist understanding and diagnosis.
<span id="S5.SS2.p2.1.2" class="ltx_ERROR undefined">\tabref</span>tab:perturbation_types shows that models are generally more confident with the antonymous perturbations, likely because “yes/no” questions have higher answer prediction scores in general.
We note that performance gains are significant on single-word changes and less obvious on multi-word changes.</p>
</div>
<figure id="S5.T4" class="ltx_table">
<table id="S5.T4.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T4.3.4.1" class="ltx_tr">
<th id="S5.T4.3.4.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_th_row ltx_border_t">
<span id="S5.T4.3.4.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.3.4.1.1.1.1" class="ltx_p" style="width:42.7pt;"><span id="S5.T4.3.4.1.1.1.1.1" class="ltx_text" style="font-size:90%;">Model</span></span>
</span>
</th>
<th id="S5.T4.3.4.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2"><span id="S5.T4.3.4.1.2.1" class="ltx_text" style="font-size:90%;">Syn.</span></th>
<th id="S5.T4.3.4.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2"><span id="S5.T4.3.4.1.3.1" class="ltx_text" style="font-size:90%;">Par.</span></th>
<th id="S5.T4.3.4.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2"><span id="S5.T4.3.4.1.4.1" class="ltx_text" style="font-size:90%;">Ant.</span></th>
</tr>
<tr id="S5.T4.3.3" class="ltx_tr">
<th id="S5.T4.3.3.4" class="ltx_td ltx_align_top ltx_th ltx_th_column ltx_th_row"></th>
<th id="S5.T4.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column"><math id="S5.T4.1.1.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S5.T4.1.1.1.m1.1a"><mi mathsize="90%" id="S5.T4.1.1.1.m1.1.1" xref="S5.T4.1.1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S5.T4.1.1.1.m1.1b"><ci id="S5.T4.1.1.1.m1.1.1.cmml" xref="S5.T4.1.1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.1.1.1.m1.1c">\mu</annotation></semantics></math></th>
<th id="S5.T4.3.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><span id="S5.T4.3.3.5.1" class="ltx_text" style="font-size:90%;">CS</span></th>
<th id="S5.T4.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column"><math id="S5.T4.2.2.2.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S5.T4.2.2.2.m1.1a"><mi mathsize="90%" id="S5.T4.2.2.2.m1.1.1" xref="S5.T4.2.2.2.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S5.T4.2.2.2.m1.1b"><ci id="S5.T4.2.2.2.m1.1.1.cmml" xref="S5.T4.2.2.2.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.2.2.2.m1.1c">\mu</annotation></semantics></math></th>
<th id="S5.T4.3.3.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><span id="S5.T4.3.3.6.1" class="ltx_text" style="font-size:90%;">CS</span></th>
<th id="S5.T4.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column"><math id="S5.T4.3.3.3.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S5.T4.3.3.3.m1.1a"><mi mathsize="90%" id="S5.T4.3.3.3.m1.1.1" xref="S5.T4.3.3.3.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S5.T4.3.3.3.m1.1b"><ci id="S5.T4.3.3.3.m1.1.1.cmml" xref="S5.T4.3.3.3.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.3.3.3.m1.1c">\mu</annotation></semantics></math></th>
<th id="S5.T4.3.3.7" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S5.T4.3.3.7.1" class="ltx_text" style="font-size:90%;">CS</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T4.3.5.1" class="ltx_tr">
<th id="S5.T4.3.5.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t">
<span id="S5.T4.3.5.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.3.5.1.1.1.1" class="ltx_p" style="width:42.7pt;"><span id="S5.T4.3.5.1.1.1.1.1" class="ltx_text" style="font-size:90%;">StackNMN</span></span>
</span>
</th>
<td id="S5.T4.3.5.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.3.5.1.2.1" class="ltx_text" style="font-size:90%;">62.6</span></td>
<td id="S5.T4.3.5.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T4.3.5.1.3.1" class="ltx_text" style="font-size:90%;">64.7</span></td>
<td id="S5.T4.3.5.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.3.5.1.4.1" class="ltx_text" style="font-size:90%;">51.6</span></td>
<td id="S5.T4.3.5.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T4.3.5.1.5.1" class="ltx_text" style="font-size:90%;">53.8</span></td>
<td id="S5.T4.3.5.1.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.3.5.1.6.1" class="ltx_text" style="font-size:90%;">79.8</span></td>
<td id="S5.T4.3.5.1.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.3.5.1.7.1" class="ltx_text" style="font-size:90%;">76.1</span></td>
</tr>
<tr id="S5.T4.3.6.2" class="ltx_tr">
<th id="S5.T4.3.6.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="S5.T4.3.6.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.3.6.2.1.1.1" class="ltx_p" style="width:42.7pt;"><span id="S5.T4.3.6.2.1.1.1.1" class="ltx_text" style="font-size:90%;">  +Q3R</span></span>
</span>
</th>
<td id="S5.T4.3.6.2.2" class="ltx_td ltx_align_center"><span id="S5.T4.3.6.2.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">64.0</span></td>
<td id="S5.T4.3.6.2.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T4.3.6.2.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">70.3</span></td>
<td id="S5.T4.3.6.2.4" class="ltx_td ltx_align_center"><span id="S5.T4.3.6.2.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">52.9</span></td>
<td id="S5.T4.3.6.2.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T4.3.6.2.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">56.9</span></td>
<td id="S5.T4.3.6.2.6" class="ltx_td ltx_align_center"><span id="S5.T4.3.6.2.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">84.9</span></td>
<td id="S5.T4.3.6.2.7" class="ltx_td ltx_align_center"><span id="S5.T4.3.6.2.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">84.7</span></td>
</tr>
<tr id="S5.T4.3.7.3" class="ltx_tr">
<th id="S5.T4.3.7.3.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t">
<span id="S5.T4.3.7.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.3.7.3.1.1.1" class="ltx_p" style="width:42.7pt;"><span id="S5.T4.3.7.3.1.1.1.1" class="ltx_text" style="font-size:90%;">HybridNet</span></span>
</span>
</th>
<td id="S5.T4.3.7.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.3.7.3.2.1" class="ltx_text" style="font-size:90%;">62.5</span></td>
<td id="S5.T4.3.7.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T4.3.7.3.3.1" class="ltx_text" style="font-size:90%;">65.0</span></td>
<td id="S5.T4.3.7.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.3.7.3.4.1" class="ltx_text" style="font-size:90%;">53.3</span></td>
<td id="S5.T4.3.7.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T4.3.7.3.5.1" class="ltx_text" style="font-size:90%;">55.7</span></td>
<td id="S5.T4.3.7.3.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.3.7.3.6.1" class="ltx_text" style="font-size:90%;">79.9</span></td>
<td id="S5.T4.3.7.3.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.3.7.3.7.1" class="ltx_text" style="font-size:90%;">76.4</span></td>
</tr>
<tr id="S5.T4.3.8.4" class="ltx_tr">
<th id="S5.T4.3.8.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="S5.T4.3.8.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.3.8.4.1.1.1" class="ltx_p" style="width:42.7pt;"><span id="S5.T4.3.8.4.1.1.1.1" class="ltx_text" style="font-size:90%;">  +Q3R</span></span>
</span>
</th>
<td id="S5.T4.3.8.4.2" class="ltx_td ltx_align_center"><span id="S5.T4.3.8.4.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">64.1</span></td>
<td id="S5.T4.3.8.4.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T4.3.8.4.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">70.8</span></td>
<td id="S5.T4.3.8.4.4" class="ltx_td ltx_align_center"><span id="S5.T4.3.8.4.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">55.0</span></td>
<td id="S5.T4.3.8.4.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T4.3.8.4.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">59.4</span></td>
<td id="S5.T4.3.8.4.6" class="ltx_td ltx_align_center"><span id="S5.T4.3.8.4.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">84.0</span></td>
<td id="S5.T4.3.8.4.7" class="ltx_td ltx_align_center"><span id="S5.T4.3.8.4.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">83.7</span></td>
</tr>
<tr id="S5.T4.3.9.5" class="ltx_tr">
<th id="S5.T4.3.9.5.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t">
<span id="S5.T4.3.9.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.3.9.5.1.1.1" class="ltx_p" style="width:42.7pt;"><span id="S5.T4.3.9.5.1.1.1.1" class="ltx_text" style="font-size:90%;">XNM</span></span>
</span>
</th>
<td id="S5.T4.3.9.5.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.3.9.5.2.1" class="ltx_text" style="font-size:90%;">64.1</span></td>
<td id="S5.T4.3.9.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T4.3.9.5.3.1" class="ltx_text" style="font-size:90%;">67.6</span></td>
<td id="S5.T4.3.9.5.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.3.9.5.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">56.7</span></td>
<td id="S5.T4.3.9.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T4.3.9.5.5.1" class="ltx_text" style="font-size:90%;">60.7</span></td>
<td id="S5.T4.3.9.5.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.3.9.5.6.1" class="ltx_text" style="font-size:90%;">79.7</span></td>
<td id="S5.T4.3.9.5.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.3.9.5.7.1" class="ltx_text" style="font-size:90%;">76.0</span></td>
</tr>
<tr id="S5.T4.3.10.6" class="ltx_tr">
<th id="S5.T4.3.10.6.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_b">
<span id="S5.T4.3.10.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.3.10.6.1.1.1" class="ltx_p" style="width:42.7pt;"><span id="S5.T4.3.10.6.1.1.1.1" class="ltx_text" style="font-size:90%;">  +Q3R</span></span>
</span>
</th>
<td id="S5.T4.3.10.6.2" class="ltx_td ltx_align_center ltx_border_b"><span id="S5.T4.3.10.6.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">65.7</span></td>
<td id="S5.T4.3.10.6.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S5.T4.3.10.6.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">72.9</span></td>
<td id="S5.T4.3.10.6.4" class="ltx_td ltx_align_center ltx_border_b"><span id="S5.T4.3.10.6.4.1" class="ltx_text" style="font-size:90%;">56.4</span></td>
<td id="S5.T4.3.10.6.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S5.T4.3.10.6.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">61.8</span></td>
<td id="S5.T4.3.10.6.6" class="ltx_td ltx_align_center ltx_border_b"><span id="S5.T4.3.10.6.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">84.4</span></td>
<td id="S5.T4.3.10.6.7" class="ltx_td ltx_align_center ltx_border_b"><span id="S5.T4.3.10.6.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">84.7</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 4: </span>Average accuracy (<math id="S5.T4.5.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S5.T4.5.m1.1b"><mi id="S5.T4.5.m1.1.1" xref="S5.T4.5.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S5.T4.5.m1.1c"><ci id="S5.T4.5.m1.1.1.cmml" xref="S5.T4.5.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.5.m1.1d">\mu</annotation></semantics></math>) between <span id="S5.T4.14.1" class="ltx_text ltx_font_italic">Pert</span>+<span id="S5.T4.15.2" class="ltx_text ltx_font_italic">Ori</span> and CS on each type of perturbation: Synonymous (Syn.), Paraphrastic (Par.) and Antonymous (Ant.).</figcaption>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Further Analysis</h3>

<div id="S5.SS3.p1" class="ltx_para ltx_noindent">
<p id="S5.SS3.p1.5" class="ltx_p"><span id="S5.SS3.p1.5.1" class="ltx_text ltx_font_bold">Effect of Regularization.</span>
To further understand the effect of applying our loss on the reasoning steps involved in executing NMNs, we compute different statistics using HybridNet.
For each question in VQA P2, we compute the average normed difference in output module weights between the perturbed question, <math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="\tilde{Q}_{j}" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><msub id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mover accent="true" id="S5.SS3.p1.1.m1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.2.cmml"><mi id="S5.SS3.p1.1.m1.1.1.2.2" xref="S5.SS3.p1.1.m1.1.1.2.2.cmml">Q</mi><mo id="S5.SS3.p1.1.m1.1.1.2.1" xref="S5.SS3.p1.1.m1.1.1.2.1.cmml">~</mo></mover><mi id="S5.SS3.p1.1.m1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">subscript</csymbol><apply id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2"><ci id="S5.SS3.p1.1.m1.1.1.2.1.cmml" xref="S5.SS3.p1.1.m1.1.1.2.1">~</ci><ci id="S5.SS3.p1.1.m1.1.1.2.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2.2">𝑄</ci></apply><ci id="S5.SS3.p1.1.m1.1.1.3.cmml" xref="S5.SS3.p1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">\tilde{Q}_{j}</annotation></semantics></math>, and the original question, <math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="Q_{j}" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><msub id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml"><mi id="S5.SS3.p1.2.m2.1.1.2" xref="S5.SS3.p1.2.m2.1.1.2.cmml">Q</mi><mi id="S5.SS3.p1.2.m2.1.1.3" xref="S5.SS3.p1.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><apply id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.2.m2.1.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS3.p1.2.m2.1.1.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2">𝑄</ci><ci id="S5.SS3.p1.2.m2.1.1.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">Q_{j}</annotation></semantics></math> for all steps.
Applying our loss leads to a <math id="S5.SS3.p1.3.m3.1" class="ltx_Math" alttext="93\%" display="inline"><semantics id="S5.SS3.p1.3.m3.1a"><mrow id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml"><mn id="S5.SS3.p1.3.m3.1.1.2" xref="S5.SS3.p1.3.m3.1.1.2.cmml">93</mn><mo id="S5.SS3.p1.3.m3.1.1.1" xref="S5.SS3.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.1b"><apply id="S5.SS3.p1.3.m3.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1"><csymbol cd="latexml" id="S5.SS3.p1.3.m3.1.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1.1">percent</csymbol><cn type="integer" id="S5.SS3.p1.3.m3.1.1.2.cmml" xref="S5.SS3.p1.3.m3.1.1.2">93</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">93\%</annotation></semantics></math> reduction (<math id="S5.SS3.p1.4.m4.1" class="ltx_Math" alttext="7.4\times 10^{-3}" display="inline"><semantics id="S5.SS3.p1.4.m4.1a"><mrow id="S5.SS3.p1.4.m4.1.1" xref="S5.SS3.p1.4.m4.1.1.cmml"><mn id="S5.SS3.p1.4.m4.1.1.2" xref="S5.SS3.p1.4.m4.1.1.2.cmml">7.4</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS3.p1.4.m4.1.1.1" xref="S5.SS3.p1.4.m4.1.1.1.cmml">×</mo><msup id="S5.SS3.p1.4.m4.1.1.3" xref="S5.SS3.p1.4.m4.1.1.3.cmml"><mn id="S5.SS3.p1.4.m4.1.1.3.2" xref="S5.SS3.p1.4.m4.1.1.3.2.cmml">10</mn><mrow id="S5.SS3.p1.4.m4.1.1.3.3" xref="S5.SS3.p1.4.m4.1.1.3.3.cmml"><mo id="S5.SS3.p1.4.m4.1.1.3.3a" xref="S5.SS3.p1.4.m4.1.1.3.3.cmml">−</mo><mn id="S5.SS3.p1.4.m4.1.1.3.3.2" xref="S5.SS3.p1.4.m4.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.4.m4.1b"><apply id="S5.SS3.p1.4.m4.1.1.cmml" xref="S5.SS3.p1.4.m4.1.1"><times id="S5.SS3.p1.4.m4.1.1.1.cmml" xref="S5.SS3.p1.4.m4.1.1.1"></times><cn type="float" id="S5.SS3.p1.4.m4.1.1.2.cmml" xref="S5.SS3.p1.4.m4.1.1.2">7.4</cn><apply id="S5.SS3.p1.4.m4.1.1.3.cmml" xref="S5.SS3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p1.4.m4.1.1.3.1.cmml" xref="S5.SS3.p1.4.m4.1.1.3">superscript</csymbol><cn type="integer" id="S5.SS3.p1.4.m4.1.1.3.2.cmml" xref="S5.SS3.p1.4.m4.1.1.3.2">10</cn><apply id="S5.SS3.p1.4.m4.1.1.3.3.cmml" xref="S5.SS3.p1.4.m4.1.1.3.3"><minus id="S5.SS3.p1.4.m4.1.1.3.3.1.cmml" xref="S5.SS3.p1.4.m4.1.1.3.3"></minus><cn type="integer" id="S5.SS3.p1.4.m4.1.1.3.3.2.cmml" xref="S5.SS3.p1.4.m4.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.4.m4.1c">7.4\times 10^{-3}</annotation></semantics></math> to <math id="S5.SS3.p1.5.m5.1" class="ltx_Math" alttext="0.5\times 10^{-3}" display="inline"><semantics id="S5.SS3.p1.5.m5.1a"><mrow id="S5.SS3.p1.5.m5.1.1" xref="S5.SS3.p1.5.m5.1.1.cmml"><mn id="S5.SS3.p1.5.m5.1.1.2" xref="S5.SS3.p1.5.m5.1.1.2.cmml">0.5</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS3.p1.5.m5.1.1.1" xref="S5.SS3.p1.5.m5.1.1.1.cmml">×</mo><msup id="S5.SS3.p1.5.m5.1.1.3" xref="S5.SS3.p1.5.m5.1.1.3.cmml"><mn id="S5.SS3.p1.5.m5.1.1.3.2" xref="S5.SS3.p1.5.m5.1.1.3.2.cmml">10</mn><mrow id="S5.SS3.p1.5.m5.1.1.3.3" xref="S5.SS3.p1.5.m5.1.1.3.3.cmml"><mo id="S5.SS3.p1.5.m5.1.1.3.3a" xref="S5.SS3.p1.5.m5.1.1.3.3.cmml">−</mo><mn id="S5.SS3.p1.5.m5.1.1.3.3.2" xref="S5.SS3.p1.5.m5.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.5.m5.1b"><apply id="S5.SS3.p1.5.m5.1.1.cmml" xref="S5.SS3.p1.5.m5.1.1"><times id="S5.SS3.p1.5.m5.1.1.1.cmml" xref="S5.SS3.p1.5.m5.1.1.1"></times><cn type="float" id="S5.SS3.p1.5.m5.1.1.2.cmml" xref="S5.SS3.p1.5.m5.1.1.2">0.5</cn><apply id="S5.SS3.p1.5.m5.1.1.3.cmml" xref="S5.SS3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p1.5.m5.1.1.3.1.cmml" xref="S5.SS3.p1.5.m5.1.1.3">superscript</csymbol><cn type="integer" id="S5.SS3.p1.5.m5.1.1.3.2.cmml" xref="S5.SS3.p1.5.m5.1.1.3.2">10</cn><apply id="S5.SS3.p1.5.m5.1.1.3.3.cmml" xref="S5.SS3.p1.5.m5.1.1.3.3"><minus id="S5.SS3.p1.5.m5.1.1.3.3.1.cmml" xref="S5.SS3.p1.5.m5.1.1.3.3"></minus><cn type="integer" id="S5.SS3.p1.5.m5.1.1.3.3.2.cmml" xref="S5.SS3.p1.5.m5.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.5.m5.1c">0.5\times 10^{-3}</annotation></semantics></math>) on the average difference of the module weight distribution at each step. In other words, our framework encourages more consistent reasoning steps
between related questions. Also, it appears that our framework can lead to more intuitive visual attentions, as shown in <span id="S5.SS3.p1.5.2" class="ltx_ERROR undefined">\figref</span>fig:attention. These results
suggest that our framework may give rise to more interpretable and consistent
visual reasoning.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para ltx_noindent">
<p id="S5.SS3.p2.2" class="ltx_p"><span id="S5.SS3.p2.2.1" class="ltx_text ltx_font_bold">Additional Evaluation.</span>

As we discussed in <span id="S5.SS3.p2.2.2" class="ltx_ERROR undefined">\secref</span>sec:othermethod, human-written rephrasings typically contain various sources of change: such as those that involve common sense knowledge, or structural level change of sentences.
Nonetheless, we are interested in
observing the outcome of the additional study on VQA-Rephrasings.
When trained with our Q3R framework, XNM receives a <math id="S5.SS3.p2.1.m1.1" class="ltx_Math" alttext="+0.7" display="inline"><semantics id="S5.SS3.p2.1.m1.1a"><mrow id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml"><mo id="S5.SS3.p2.1.m1.1.1a" xref="S5.SS3.p2.1.m1.1.1.cmml">+</mo><mn id="S5.SS3.p2.1.m1.1.1.2" xref="S5.SS3.p2.1.m1.1.1.2.cmml">0.7</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><apply id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1"><plus id="S5.SS3.p2.1.m1.1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1"></plus><cn type="float" id="S5.SS3.p2.1.m1.1.1.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2">0.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">+0.7</annotation></semantics></math> accuracy improvement
on paraphrased questions as well as a <math id="S5.SS3.p2.2.m2.1" class="ltx_Math" alttext="+0.4" display="inline"><semantics id="S5.SS3.p2.2.m2.1a"><mrow id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml"><mo id="S5.SS3.p2.2.m2.1.1a" xref="S5.SS3.p2.2.m2.1.1.cmml">+</mo><mn id="S5.SS3.p2.2.m2.1.1.2" xref="S5.SS3.p2.2.m2.1.1.2.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><apply id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1"><plus id="S5.SS3.p2.2.m2.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1"></plus><cn type="float" id="S5.SS3.p2.2.m2.1.1.2.cmml" xref="S5.SS3.p2.2.m2.1.1.2">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">+0.4</annotation></semantics></math> improvement on CS score.
This moderate gain may be explained by the fact that linguistic perturbations
are present in human-written questions, so the model’s robustness on this dataset
benefits from our training framework.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Discussion</h3>

<div id="S5.SS4.p1" class="ltx_para ltx_noindent">
<p id="S5.SS4.p1.1" class="ltx_p"><span id="S5.SS4.p1.1.1" class="ltx_text ltx_font_bold">Comparison to Expert Layout Supervision.</span>
Many NMNs adopt expert layouts to guide the search for optimal module paths <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>.
While this approach is suitable on synthetic datasets with simple scenes and spatial reasoning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, it has limited success on realistic images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>.
Our loss can be viewed as providing weak supervision to module layouts, avoiding the need for ground-truth module layout annotation, which is costly and not
clearly defined for natural questions about real images.</p>
</div>
<div id="S5.SS4.p2" class="ltx_para ltx_noindent">
<p id="S5.SS4.p2.1" class="ltx_p"><span id="S5.SS4.p2.1.1" class="ltx_text ltx_font_bold">Beyond NMNs.</span>
Our results seem to suggest the advantage of representing and incorporating
inductive bias at the modular level, rather than just using
answer-level supervision.
While we have demonstrated our method using Neural Module Networks, we note that it could be generalized to improve the robustness of any other interpretable VQA architecture that involves the computation of sub-tasks, such as those based on executable symbolic programs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We show that a promising direction to improve the robustness and consistency of VQA models is by modeling and learning from lexical perturbations.
We propose a novel approach based on modular networks, which creates two questions related by linguistic perturbation and regularizes the visual reasoning process between them to be consistent during training.
We introduce a new benchmark, VQA P2, that features categorized, controllable linguistic variations that allows us to investigate and diagnose sources of inconsistencies in model predictions, will be made publicly available.
Empirical results show that existing models have difficulties with different types of linguistic variations and that our approach is effective towards improving robustness and generalization ability.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
Aishwarya Agrawal, Dhruv Batra, Devi Parikh, and Aniruddha Kembhavi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">Don’t just assume; look and answer: Overcoming priors for visual
question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib1.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib1.5.3" class="ltx_text" style="font-size:90%;">, pages 4971–4980, 2018.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Aishwarya Agrawal, Dhruv Batra, Devi Parikh, and Aniruddha Kembhavi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Don’t just assume; look and answer: Overcoming priors for visual
question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">, pages 4971–4980, 2018.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Peter Anderson, Xiaodong He, Chris Buehler, Damien Teney, Mark Johnson, Stephen
Gould, and Lei Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">Bottom-up and top-down attention for image captioning and visual
question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib3.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and
pattern recognition</span><span id="bib.bib3.5.3" class="ltx_text" style="font-size:90%;">, pages 6077–6086, 2018.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Jacob Andreas, Marcus Rohrbach, Trevor Darrell, and Dan Klein.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">Neural module networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib4.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib4.5.3" class="ltx_text" style="font-size:90%;">, pages 39–48, 2016.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Bengio.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Neural machine translation by jointly learning to align and
translate.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib5.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib5.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Andrea Burns, Reuben Tan, Kate Saenko, Stan Sclaroff, and Bryan A Plummer.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Language features matter: Effective language representations for
vision-language tasks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib6.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE International Conference on Computer
Vision</span><span id="bib.bib6.5.3" class="ltx_text" style="font-size:90%;">, pages 7474–7483, 2019.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Yong Cheng, Zhaopeng Tu, Fandong Meng, Junjie Zhai, and Yang Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Towards robust neural machine translation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib7.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 56th Annual Meeting of the Association for
Computational Linguistics (Volume 1: Long Papers)</span><span id="bib.bib7.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Kyunghyun Cho, Bart van Merriënboer, Caglar Gulcehre, Dzmitry Bahdanau,
Fethi Bougares, Holger Schwenk, and Yoshua Bengio.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">Learning phrase representations using RNN encoder–decoder for
statistical machine translation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 2014 Conference on Empirical Methods in
Natural Language Processing</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">, pages 1724–1734. Association for Computational
Linguistics, Oct. 2014.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">BERT: Pre-training of deep bidirectional transformers for language
understanding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib9.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 2019 Conference of the North American
Chapter of the Association for Computational Linguistics: Human Language
Technologies, Volume 1 (Long and Short Papers)</span><span id="bib.bib9.5.3" class="ltx_text" style="font-size:90%;">, pages 4171–4186, 2019.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Daxiang Dong, Hua Wu, Wei He, Dianhai Yu, and Haifeng Wang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Multi-task learning for multiple language translation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib10.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 53rd Annual Meeting of the Association for
Computational Linguistics and the 7th International Joint Conference on
Natural Language Processing (Volume 1: Long Papers)</span><span id="bib.bib10.5.3" class="ltx_text" style="font-size:90%;">, pages 1723–1732, 2015.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Wee Chung Gan and Hwee Tou Ng.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Improving the robustness of question answering systems to question
paraphrasing.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib11.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 57th Annual Meeting of the Association for
Computational Linguistics</span><span id="bib.bib11.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Yash Goyal, Tejas Khot, Douglas Summers-Stay, Dhruv Batra, and Devi Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Making the v in vqa matter: Elevating the role of image understanding
in visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib12.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib12.5.3" class="ltx_text" style="font-size:90%;">, pages 6904–6913, 2017.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Deep residual learning for image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib13.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and
pattern recognition</span><span id="bib.bib13.5.3" class="ltx_text" style="font-size:90%;">, pages 770–778, 2016.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Dan Hendrycks, Norman Mu, Ekin Dogus Cubuk, Barret Zoph, Justin Gilmer, and
Balaji Lakshminarayanan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Augmix: A simple data processing method to improve robustness and
uncertainty.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib14.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib14.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Sepp Hochreiter and Jürgen Schmidhuber.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Long short-term memory.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Neural computation</span><span id="bib.bib15.4.2" class="ltx_text" style="font-size:90%;">, 9(8):1735–1780, 1997.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Ronghang Hu, Jacob Andreas, Trevor Darrell, and Kate Saenko.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Explainable neural computation via stack neural module networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text" style="font-size:90%;">In Vittorio Ferrari, Martial Hebert, Cristian Sminchisescu, and Yair
Weiss, editors, </span><span id="bib.bib16.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the European Conference on Computer
Vision</span><span id="bib.bib16.5.3" class="ltx_text" style="font-size:90%;">, pages 55–71, 2018.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Ronghang Hu, Jacob Andreas, Marcus Rohrbach, Trevor Darrell, and Kate Saenko.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Learning to reason: End-to-end module networks for visual question
answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE International Conference on Computer
Vision</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">, pages 804–813, 2017.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Zhiting Hu, Zichao Yang, Xiaodan Liang, Ruslan Salakhutdinov, and Eric P Xing.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Toward controlled generation of text.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib18.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 34th International Conference on Machine
Learning-Volume 70</span><span id="bib.bib18.5.3" class="ltx_text" style="font-size:90%;">, pages 1587–1596, 2017.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Drew A Hudson and Christopher D Manning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">Compositional attention networks for machine reasoning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib19.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib19.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Drew A Hudson and Christopher D Manning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Gqa: A new dataset for real-world visual reasoning and compositional
question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib20.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib20.5.3" class="ltx_text" style="font-size:90%;">, pages 6700–6709, 2019.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Eric Jang, Shixiang Gu, and Ben Poole.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Categorical reparameterization with gumbel-softmax.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib21.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib21.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Yu Jiang, Vivek Natarajan, Xinlei Chen, Marcus Rohrbach, Dhruv Batra, and Devi
Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Pythia v0.1: the winning entry to the vqa challenge 2018.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1807.09956</span><span id="bib.bib22.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
Justin Johnson, Bharath Hariharan, Laurens van der Maaten, Li Fei-Fei, C
Lawrence Zitnick, and Ross Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Clevr: A diagnostic dataset for compositional language and elementary
visual reasoning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib23.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib23.5.3" class="ltx_text" style="font-size:90%;">, pages 2901–2910, 2017.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Kushal Kafle and Christopher Kanan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">An analysis of visual question answering algorithms.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib24.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib24.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Jin-Hwa Kim, Jaehyun Jun, and Byoung-Tak Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Bilinear attention networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib25.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib25.5.3" class="ltx_text" style="font-size:90%;">, pages
1564–1574, 2018.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
Seung Wook Kim, Makarand Tapaswi, and Sanja Fidler.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">Visual reasoning by progressive module networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib26.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib26.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Diederik P Kingma and Jimmy Ba.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Adam: A method for stochastic optimization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
Ranjay Krishna, Yuke Zhu, Oliver Groth, Justin Johnson, Kenji Hata, Joshua
Kravitz, Stephanie Chen, Yannis Kalantidis, Li-Jia Li, David A Shamma, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Visual genome: Connecting language and vision using crowdsourced
dense image annotations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">International Journal of Computer Vision</span><span id="bib.bib28.4.2" class="ltx_text" style="font-size:90%;">, 123(1):32–73, 2017.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
Liunian Harold Li, Mark Yatskar, Da Yin, Cho-Jui Hsieh, and Kai-Wei Chang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">Visualbert: A simple and performant baseline for vision and language.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib29.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Arxiv</span><span id="bib.bib29.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Yikang Li, Nan Duan, Bolei Zhou, Xiao Chu, Wanli Ouyang, Xiaogang Wang, and
Ming Zhou.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Visual question generation as dual task of visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib30.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib30.5.3" class="ltx_text" style="font-size:90%;">, pages 6116–6124, 2018.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
Feng Liu, Tao Xiang, Timothy M Hospedales, Wankou Yang, and Changyin Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">ivqa: Inverse visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">, pages 8611–8619, 2018.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
Jiasen Lu, Dhruv Batra, Devi Parikh, and Stefan Lee.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">Vilbert: Pretraining task-agnostic visiolinguistic representations
for vision-and-language tasks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1908.02265</span><span id="bib.bib32.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Minh-Thang Luong, Quoc V Le, Ilya Sutskever, Oriol Vinyals, and Lukasz Kaiser.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Multi-task sequence to sequence learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib33.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib33.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
Jiayuan Mao, Chuang Gan, Pushmeet Kohli, Joshua B. Tenenbaum, and Jiajun Wu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.2.1" class="ltx_text" style="font-size:90%;">The neuro-symbolic concept learner: Interpreting scenes, words, and
sentences from natural supervision.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib34.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib34.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
David Mascharka, Philip Tran, Ryan Soklaski, and Arjun Majumdar.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.2.1" class="ltx_text" style="font-size:90%;">Transparency by design: Closing the gap between performance and
interpretability in visual reasoning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib35.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and
pattern recognition</span><span id="bib.bib35.5.3" class="ltx_text" style="font-size:90%;">, pages 4942–4950, 2018.
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text" style="font-size:90%;">
Tomas Mikolov, Kai Chen, Greg Corrado, and Jeffrey Dean.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.2.1" class="ltx_text" style="font-size:90%;">Efficient estimation of word representations in vector space.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib36.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Workshops at International Conference on Learning
Representations</span><span id="bib.bib36.5.3" class="ltx_text" style="font-size:90%;">, 2013.
</span>
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text" style="font-size:90%;">
George A Miller.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.2.1" class="ltx_text" style="font-size:90%;">Wordnet: a lexical database for english.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Communications of the ACM</span><span id="bib.bib37.4.2" class="ltx_text" style="font-size:90%;">, 38(11):39–41, 1995.
</span>
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span id="bib.bib38.1.1" class="ltx_text" style="font-size:90%;">
Ellie Pavlick, Pushpendre Rastogi, Juri Ganitkevitch, Benjamin Van Durme, and
Chris Callison-Burch.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.2.1" class="ltx_text" style="font-size:90%;">PPDB 2.0: Better paraphrase ranking, fine-grained entailment
relations, word embeddings, and style classification.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib38.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 53rd Annual Meeting of the Association for
Computational Linguistics and the 7th International Joint Conference on
Natural Language Processing (Volume 2: Short Papers)</span><span id="bib.bib38.5.3" class="ltx_text" style="font-size:90%;">, pages 425–430, 2015.
</span>
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text" style="font-size:90%;">
Jeffrey Pennington, Richard Socher, and Christopher D. Manning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.2.1" class="ltx_text" style="font-size:90%;">Glove: Global vectors for word representation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib39.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 2019 Conference on Empirical Methods in
Natural Language Processing</span><span id="bib.bib39.5.3" class="ltx_text" style="font-size:90%;">, pages 1532–1543, 2014.
</span>
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text" style="font-size:90%;">
Arijit Ray, Karan Sikka, Ajay Divakaran, Stefan Lee, and Giedrius Burachas.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.2.1" class="ltx_text" style="font-size:90%;">Sunny and dark outside?! improving answer consistency in VQA
through entailed question generation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib40.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 2019 Conference on Empirical Methods in
Natural Language Processing and the 9th International Joint Conference on
Natural Language Processing</span><span id="bib.bib40.5.3" class="ltx_text" style="font-size:90%;">, pages 5860–5865, 2019.
</span>
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text" style="font-size:90%;">
Shaoqing Ren, Kaiming He, Ross Girshick, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.2.1" class="ltx_text" style="font-size:90%;">Faster r-cnn: Towards real-time object detection with region proposal
networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib41.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib41.5.3" class="ltx_text" style="font-size:90%;">, pages
91–99, 2015.
</span>
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"><span id="bib.bib42.1.1" class="ltx_text" style="font-size:90%;">
Meet Shah, Xinlei Chen, Marcus Rohrbach, and Devi Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.2.1" class="ltx_text" style="font-size:90%;">Cycle-consistency for robust visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib42.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib42.5.3" class="ltx_text" style="font-size:90%;">, pages 6649–6658, 2019.
</span>
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"><span id="bib.bib43.1.1" class="ltx_text" style="font-size:90%;">
Jiaxin Shi, Hanwang Zhang, and Juanzi Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.2.1" class="ltx_text" style="font-size:90%;">Explainable and explicit visual reasoning over scene graphs.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib43.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib43.5.3" class="ltx_text" style="font-size:90%;">, pages 8376–8384, 2019.
</span>
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock"><span id="bib.bib44.1.1" class="ltx_text" style="font-size:90%;">
Karen Simonyan and Andrew Zisserman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.2.1" class="ltx_text" style="font-size:90%;">Very deep convolutional networks for large-scale image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib44.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib44.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock"><span id="bib.bib45.1.1" class="ltx_text" style="font-size:90%;">
Weijie Su, Xizhou Zhu, Yue Cao, Bin Li, Lewei Lu, Furu Wei, and Jifeng Dai.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.2.1" class="ltx_text" style="font-size:90%;">Vl-bert: Pre-training of generic visual-linguistic representations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib45.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib45.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock"><span id="bib.bib46.1.1" class="ltx_text" style="font-size:90%;">
Sanjay Subramanian, Sameer Singh, and Matt Gardner.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.2.1" class="ltx_text" style="font-size:90%;">Analyzing compositionality in visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib46.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ViGIL@ NeurIPS</span><span id="bib.bib46.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock"><span id="bib.bib47.1.1" class="ltx_text" style="font-size:90%;">
Hao Tan and Mohit Bansal.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.2.1" class="ltx_text" style="font-size:90%;">LXMERT: Learning cross-modality encoder representations from
transformers.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib47.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 2019 Conference on Empirical Methods in
Natural Language Processing and the 9th International Joint Conference on
Natural Language Processing</span><span id="bib.bib47.5.3" class="ltx_text" style="font-size:90%;">, pages 5100–5111, 2019.
</span>
</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock"><span id="bib.bib48.1.1" class="ltx_text" style="font-size:90%;">
Liling Tan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib48.2.1" class="ltx_text" style="font-size:90%;">Pywsd: Python implementations of word sense disambiguation (wsd)
technologies [software].
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib48.3.1" class="ltx_text" style="font-size:90%;">https://github.com/alvations/pywsd, 2014.
</span>
</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock"><span id="bib.bib49.1.1" class="ltx_text" style="font-size:90%;">
Ruixue Tang, Chao Ma, Wei Emma Zhang, Qi Wu, and Xiaokang Yang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib49.2.1" class="ltx_text" style="font-size:90%;">Semantic equivalent adversarial data augmentation for visual question
answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib49.3.1" class="ltx_text" style="font-size:90%;">In Andrea Vedaldi, Horst Bischof, Thomas Brox, and Jan-Michael Frahm,
editors, </span><span id="bib.bib49.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Computer Vision – ECCV 2020</span><span id="bib.bib49.5.3" class="ltx_text" style="font-size:90%;">, pages 437–453, Cham, 2020.
Springer International Publishing.
</span>
</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock"><span id="bib.bib50.1.1" class="ltx_text" style="font-size:90%;">
Damien Teney, Ehsan Abbasnejad, and Anton van den Hengel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib50.2.1" class="ltx_text" style="font-size:90%;">On incorporating semantic prior knowlegde in deep learning through
embedding-space constraints.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib50.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1909.13471</span><span id="bib.bib50.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock"><span id="bib.bib51.1.1" class="ltx_text" style="font-size:90%;">
Damien Teney, Peter Anderson, Xiaodong He, and Anton Van Den Hengel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib51.2.1" class="ltx_text" style="font-size:90%;">Tips and tricks for visual question answering: Learnings from the
2017 challenge.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib51.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib51.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib51.5.3" class="ltx_text" style="font-size:90%;">, pages 4223–4232, 2018.
</span>
</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock"><span id="bib.bib52.1.1" class="ltx_text" style="font-size:90%;">
Kento Terao, Toru Tamaki, Bisser Raytchev, Kazufumi Kaneda, and Shun’ichi
Satoh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib52.2.1" class="ltx_text" style="font-size:90%;">Rephrasing visual questions by specifying the entropy of the answer
distribution.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib52.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2004.04963</span><span id="bib.bib52.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock"><span id="bib.bib53.1.1" class="ltx_text" style="font-size:90%;">
Jialin Wu and Raymond Mooney.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib53.2.1" class="ltx_text" style="font-size:90%;">Self-critical reasoning for robust visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib53.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib53.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib53.5.3" class="ltx_text" style="font-size:90%;">, pages
8601–8611, 2019.
</span>
</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock"><span id="bib.bib54.1.1" class="ltx_text" style="font-size:90%;">
Qi Wu, Damien Teney, Peng Wang, Chunhua Shen, Anthony Dick, and Anton van den
Hengel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib54.2.1" class="ltx_text" style="font-size:90%;">Visual question answering: A survey of methods and datasets.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib54.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Computer Vision and Image Understanding</span><span id="bib.bib54.4.2" class="ltx_text" style="font-size:90%;">, 163:21–40, 2017.
</span>
</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock"><span id="bib.bib55.1.1" class="ltx_text" style="font-size:90%;">
Qizhe Xie, Minh-Thang Luong, Eduard Hovy, and Quoc V Le.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib55.2.1" class="ltx_text" style="font-size:90%;">Self-training with noisy student improves imagenet classification.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib55.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib55.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib55.5.3" class="ltx_text" style="font-size:90%;">, pages 10687–10698, 2020.
</span>
</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock"><span id="bib.bib56.1.1" class="ltx_text" style="font-size:90%;">
Xiaojun Xu, Xinyun Chen, Chang Liu, Anna Rohrbach, Trevor Darrell, and Dawn
Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib56.2.1" class="ltx_text" style="font-size:90%;">Fooling vision and language models despite localization and attention
mechanism.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib56.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib56.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib56.5.3" class="ltx_text" style="font-size:90%;">, pages 4951–4961, 2018.
</span>
</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock"><span id="bib.bib57.1.1" class="ltx_text" style="font-size:90%;">
Kexin Yi, Jiajun Wu, Chuang Gan, Antonio Torralba, Pushmeet Kohli, and Josh
Tenenbaum.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib57.2.1" class="ltx_text" style="font-size:90%;">Neural-symbolic vqa: Disentangling reasoning from vision and language
understanding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib57.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib57.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems</span><span id="bib.bib57.5.3" class="ltx_text" style="font-size:90%;">, pages
1031–1042, 2018.
</span>
</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock"><span id="bib.bib58.1.1" class="ltx_text" style="font-size:90%;">
Yan Zhang, Jonathon Hare, and Adam Prügel-Bennett.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib58.2.1" class="ltx_text" style="font-size:90%;">Learning to count objects in natural images for visual question
answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib58.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib58.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib58.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p ltx_align_center"><span id="p1.1.1" class="ltx_text ltx_font_bold" style="font-size:144%;">Appendix
<br class="ltx_break"><span id="p1.1.1.1" class="ltx_text" style="font-size:69%;"> </span></span></p>
</div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Implementation Details</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.4" class="ltx_p">As noted in <span id="A1.p1.4.1" class="ltx_ERROR undefined">\secref</span>sec:experiments, all models use the same visual features from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite><span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a target="_blank" href="https://github.com/peteanderson80/bottom-up-attention" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/peteanderson80/bottom-up-attention</a></span></span></span> and same pre-trained GloVe embeddings from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite><span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>Common Crawl 840B: <a target="_blank" href="https://nlp.stanford.edu/projects/glove/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://nlp.stanford.edu/projects/glove/</a></span></span></span>.
XNM, StackNMN, and HybridNet use the implementation provided by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> to ensure consistency amongst different NMN models.<span id="footnote5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span><a target="_blank" href="https://github.com/shijx12/XNM-Net" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/shijx12/XNM-Net</a></span></span></span>
We implement the modules and controller of StackNMN to match the paper description and official implementation.
All NMN models are trained with the Adam optimizer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> and have the same learning rate of 0.0008, training initialization seed of 0, and batch size of 256.
Following their implementations, we use hidden dimension sizes of 512 for StackNMN and 1024 for XNM, while we use 1024 for HybridNet to match XNM.
We use the recommended number of reasoning steps, <math id="A1.p1.1.m1.1" class="ltx_Math" alttext="T=3" display="inline"><semantics id="A1.p1.1.m1.1a"><mrow id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml"><mi id="A1.p1.1.m1.1.1.2" xref="A1.p1.1.m1.1.1.2.cmml">T</mi><mo id="A1.p1.1.m1.1.1.1" xref="A1.p1.1.m1.1.1.1.cmml">=</mo><mn id="A1.p1.1.m1.1.1.3" xref="A1.p1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><apply id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1"><eq id="A1.p1.1.m1.1.1.1.cmml" xref="A1.p1.1.m1.1.1.1"></eq><ci id="A1.p1.1.m1.1.1.2.cmml" xref="A1.p1.1.m1.1.1.2">𝑇</ci><cn type="integer" id="A1.p1.1.m1.1.1.3.cmml" xref="A1.p1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">T=3</annotation></semantics></math>, for XNM and use the same for StackNMN.
HybridNet uses <math id="A1.p1.2.m2.1" class="ltx_Math" alttext="T=4" display="inline"><semantics id="A1.p1.2.m2.1a"><mrow id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml"><mi id="A1.p1.2.m2.1.1.2" xref="A1.p1.2.m2.1.1.2.cmml">T</mi><mo id="A1.p1.2.m2.1.1.1" xref="A1.p1.2.m2.1.1.1.cmml">=</mo><mn id="A1.p1.2.m2.1.1.3" xref="A1.p1.2.m2.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b"><apply id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1"><eq id="A1.p1.2.m2.1.1.1.cmml" xref="A1.p1.2.m2.1.1.1"></eq><ci id="A1.p1.2.m2.1.1.2.cmml" xref="A1.p1.2.m2.1.1.2">𝑇</ci><cn type="integer" id="A1.p1.2.m2.1.1.3.cmml" xref="A1.p1.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">T=4</annotation></semantics></math> to test longer reasoning sequences as well as for visualization purposes.
With our Q3R framework, <math id="A1.p1.3.m3.1" class="ltx_Math" alttext="\lambda=1.0" display="inline"><semantics id="A1.p1.3.m3.1a"><mrow id="A1.p1.3.m3.1.1" xref="A1.p1.3.m3.1.1.cmml"><mi id="A1.p1.3.m3.1.1.2" xref="A1.p1.3.m3.1.1.2.cmml">λ</mi><mo id="A1.p1.3.m3.1.1.1" xref="A1.p1.3.m3.1.1.1.cmml">=</mo><mn id="A1.p1.3.m3.1.1.3" xref="A1.p1.3.m3.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.3.m3.1b"><apply id="A1.p1.3.m3.1.1.cmml" xref="A1.p1.3.m3.1.1"><eq id="A1.p1.3.m3.1.1.1.cmml" xref="A1.p1.3.m3.1.1.1"></eq><ci id="A1.p1.3.m3.1.1.2.cmml" xref="A1.p1.3.m3.1.1.2">𝜆</ci><cn type="float" id="A1.p1.3.m3.1.1.3.cmml" xref="A1.p1.3.m3.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.3.m3.1c">\lambda=1.0</annotation></semantics></math> and <math id="A1.p1.4.m4.1" class="ltx_Math" alttext="r=0.2" display="inline"><semantics id="A1.p1.4.m4.1a"><mrow id="A1.p1.4.m4.1.1" xref="A1.p1.4.m4.1.1.cmml"><mi id="A1.p1.4.m4.1.1.2" xref="A1.p1.4.m4.1.1.2.cmml">r</mi><mo id="A1.p1.4.m4.1.1.1" xref="A1.p1.4.m4.1.1.1.cmml">=</mo><mn id="A1.p1.4.m4.1.1.3" xref="A1.p1.4.m4.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.4.m4.1b"><apply id="A1.p1.4.m4.1.1.cmml" xref="A1.p1.4.m4.1.1"><eq id="A1.p1.4.m4.1.1.1.cmml" xref="A1.p1.4.m4.1.1.1"></eq><ci id="A1.p1.4.m4.1.1.2.cmml" xref="A1.p1.4.m4.1.1.2">𝑟</ci><cn type="float" id="A1.p1.4.m4.1.1.3.cmml" xref="A1.p1.4.m4.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.4.m4.1c">r=0.2</annotation></semantics></math> for all experiments.
For BAN, we use the original source code
with the 8-glimpse model, provided by the authors and adopt their training settings.<span id="footnote6" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span><a target="_blank" href="https://github.com/jnhwkim/ban-vqa" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/jnhwkim/ban-vqa</a></span></span></span>
We do not use the counting module <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite> nor additional training data from Visual Genome <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>.
For the Transformer model, we use LXMERT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> as the architecture and utilize the publicly available code with the recommended settings from the authors.<span id="footnote7" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span><a target="_blank" href="https://github.com/airsplay/lxmert" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/airsplay/lxmert</a></span></span></span>
For fair comparison, we do not use large-scale pre-training.</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Effect of Hyper-parameters</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.6" class="ltx_p">The main hyperparameters involved with using Q3R are the weight parameter, <math id="A2.p1.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="A2.p1.1.m1.1a"><mi id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><ci id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">\lambda</annotation></semantics></math>, and the distance function, <math id="A2.p1.2.m2.1" class="ltx_Math" alttext="D(\cdot)" display="inline"><semantics id="A2.p1.2.m2.1a"><mrow id="A2.p1.2.m2.1.2" xref="A2.p1.2.m2.1.2.cmml"><mi id="A2.p1.2.m2.1.2.2" xref="A2.p1.2.m2.1.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="A2.p1.2.m2.1.2.1" xref="A2.p1.2.m2.1.2.1.cmml">​</mo><mrow id="A2.p1.2.m2.1.2.3.2" xref="A2.p1.2.m2.1.2.cmml"><mo stretchy="false" id="A2.p1.2.m2.1.2.3.2.1" xref="A2.p1.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="A2.p1.2.m2.1.1" xref="A2.p1.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="A2.p1.2.m2.1.2.3.2.2" xref="A2.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.1b"><apply id="A2.p1.2.m2.1.2.cmml" xref="A2.p1.2.m2.1.2"><times id="A2.p1.2.m2.1.2.1.cmml" xref="A2.p1.2.m2.1.2.1"></times><ci id="A2.p1.2.m2.1.2.2.cmml" xref="A2.p1.2.m2.1.2.2">𝐷</ci><ci id="A2.p1.2.m2.1.1.cmml" xref="A2.p1.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.m2.1c">D(\cdot)</annotation></semantics></math>.
Changing <math id="A2.p1.3.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="A2.p1.3.m3.1a"><mi id="A2.p1.3.m3.1.1" xref="A2.p1.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A2.p1.3.m3.1b"><ci id="A2.p1.3.m3.1.1.cmml" xref="A2.p1.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.3.m3.1c">\lambda</annotation></semantics></math> from 1 to 0.2 results in
a value change of <math id="A2.p1.4.m4.1" class="ltx_Math" alttext="&lt;0.1" display="inline"><semantics id="A2.p1.4.m4.1a"><mrow id="A2.p1.4.m4.1.1" xref="A2.p1.4.m4.1.1.cmml"><mi id="A2.p1.4.m4.1.1.2" xref="A2.p1.4.m4.1.1.2.cmml"></mi><mo id="A2.p1.4.m4.1.1.1" xref="A2.p1.4.m4.1.1.1.cmml">&lt;</mo><mn id="A2.p1.4.m4.1.1.3" xref="A2.p1.4.m4.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.4.m4.1b"><apply id="A2.p1.4.m4.1.1.cmml" xref="A2.p1.4.m4.1.1"><lt id="A2.p1.4.m4.1.1.1.cmml" xref="A2.p1.4.m4.1.1.1"></lt><csymbol cd="latexml" id="A2.p1.4.m4.1.1.2.cmml" xref="A2.p1.4.m4.1.1.2">absent</csymbol><cn type="float" id="A2.p1.4.m4.1.1.3.cmml" xref="A2.p1.4.m4.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.4.m4.1c">&lt;0.1</annotation></semantics></math> on VQA v2 accuracy and <math id="A2.p1.5.m5.1" class="ltx_Math" alttext="&lt;0.1" display="inline"><semantics id="A2.p1.5.m5.1a"><mrow id="A2.p1.5.m5.1.1" xref="A2.p1.5.m5.1.1.cmml"><mi id="A2.p1.5.m5.1.1.2" xref="A2.p1.5.m5.1.1.2.cmml"></mi><mo id="A2.p1.5.m5.1.1.1" xref="A2.p1.5.m5.1.1.1.cmml">&lt;</mo><mn id="A2.p1.5.m5.1.1.3" xref="A2.p1.5.m5.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.5.m5.1b"><apply id="A2.p1.5.m5.1.1.cmml" xref="A2.p1.5.m5.1.1"><lt id="A2.p1.5.m5.1.1.1.cmml" xref="A2.p1.5.m5.1.1.1"></lt><csymbol cd="latexml" id="A2.p1.5.m5.1.1.2.cmml" xref="A2.p1.5.m5.1.1.2">absent</csymbol><cn type="float" id="A2.p1.5.m5.1.1.3.cmml" xref="A2.p1.5.m5.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.5.m5.1c">&lt;0.1</annotation></semantics></math> on CS score on VQA P2, for StackNMN. Also,
the difference of applying KL-divergence based loss function and L1-norm based loss function
results is also <math id="A2.p1.6.m6.1" class="ltx_Math" alttext="&lt;0.1" display="inline"><semantics id="A2.p1.6.m6.1a"><mrow id="A2.p1.6.m6.1.1" xref="A2.p1.6.m6.1.1.cmml"><mi id="A2.p1.6.m6.1.1.2" xref="A2.p1.6.m6.1.1.2.cmml"></mi><mo id="A2.p1.6.m6.1.1.1" xref="A2.p1.6.m6.1.1.1.cmml">&lt;</mo><mn id="A2.p1.6.m6.1.1.3" xref="A2.p1.6.m6.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.6.m6.1b"><apply id="A2.p1.6.m6.1.1.cmml" xref="A2.p1.6.m6.1.1"><lt id="A2.p1.6.m6.1.1.1.cmml" xref="A2.p1.6.m6.1.1.1"></lt><csymbol cd="latexml" id="A2.p1.6.m6.1.1.2.cmml" xref="A2.p1.6.m6.1.1.2">absent</csymbol><cn type="float" id="A2.p1.6.m6.1.1.3.cmml" xref="A2.p1.6.m6.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.6.m6.1c">&lt;0.1</annotation></semantics></math>, for both VQA v2 accuracy and CS score on VQA P2.</p>
</div>
<figure id="A2.T5" class="ltx_table">
<table id="A2.T5.19" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.T5.19.20.1" class="ltx_tr">
<td id="A2.T5.19.20.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="A2.T5.19.20.1.1.1" class="ltx_text" style="font-size:90%;">Module</span></td>
<td id="A2.T5.19.20.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T5.19.20.1.2.1" class="ltx_text" style="font-size:90%;">Input</span></td>
<td id="A2.T5.19.20.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T5.19.20.1.3.1" class="ltx_text" style="font-size:90%;">Output</span></td>
<td id="A2.T5.19.20.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="A2.T5.19.20.1.4.1" class="ltx_text" style="font-size:90%;">StackNMN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="A2.T5.19.20.1.4.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib16" title="" class="ltx_ref">16</a><span id="A2.T5.19.20.1.4.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="A2.T5.19.20.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="A2.T5.19.20.1.5.1" class="ltx_text" style="font-size:90%;">XNM </span><cite class="ltx_cite ltx_citemacro_cite"><span id="A2.T5.19.20.1.5.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib43" title="" class="ltx_ref">43</a><span id="A2.T5.19.20.1.5.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
</tr>
<tr id="A2.T5.4.4" class="ltx_tr">
<td id="A2.T5.4.4.5" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="A2.T5.4.4.5.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">Find</span></td>
<td id="A2.T5.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="A2.T5.1.1.1.m1.2" class="ltx_Math" alttext="x,c_{t}" display="inline"><semantics id="A2.T5.1.1.1.m1.2a"><mrow id="A2.T5.1.1.1.m1.2.2.1" xref="A2.T5.1.1.1.m1.2.2.2.cmml"><mi mathsize="90%" id="A2.T5.1.1.1.m1.1.1" xref="A2.T5.1.1.1.m1.1.1.cmml">x</mi><mo mathsize="90%" id="A2.T5.1.1.1.m1.2.2.1.2" xref="A2.T5.1.1.1.m1.2.2.2.cmml">,</mo><msub id="A2.T5.1.1.1.m1.2.2.1.1" xref="A2.T5.1.1.1.m1.2.2.1.1.cmml"><mi mathsize="90%" id="A2.T5.1.1.1.m1.2.2.1.1.2" xref="A2.T5.1.1.1.m1.2.2.1.1.2.cmml">c</mi><mi mathsize="90%" id="A2.T5.1.1.1.m1.2.2.1.1.3" xref="A2.T5.1.1.1.m1.2.2.1.1.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A2.T5.1.1.1.m1.2b"><list id="A2.T5.1.1.1.m1.2.2.2.cmml" xref="A2.T5.1.1.1.m1.2.2.1"><ci id="A2.T5.1.1.1.m1.1.1.cmml" xref="A2.T5.1.1.1.m1.1.1">𝑥</ci><apply id="A2.T5.1.1.1.m1.2.2.1.1.cmml" xref="A2.T5.1.1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="A2.T5.1.1.1.m1.2.2.1.1.1.cmml" xref="A2.T5.1.1.1.m1.2.2.1.1">subscript</csymbol><ci id="A2.T5.1.1.1.m1.2.2.1.1.2.cmml" xref="A2.T5.1.1.1.m1.2.2.1.1.2">𝑐</ci><ci id="A2.T5.1.1.1.m1.2.2.1.1.3.cmml" xref="A2.T5.1.1.1.m1.2.2.1.1.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.1.1.1.m1.2c">x,c_{t}</annotation></semantics></math></td>
<td id="A2.T5.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="A2.T5.2.2.2.m1.1" class="ltx_Math" alttext="\hat{a}" display="inline"><semantics id="A2.T5.2.2.2.m1.1a"><mover accent="true" id="A2.T5.2.2.2.m1.1.1" xref="A2.T5.2.2.2.m1.1.1.cmml"><mi mathsize="90%" id="A2.T5.2.2.2.m1.1.1.2" xref="A2.T5.2.2.2.m1.1.1.2.cmml">a</mi><mo mathsize="90%" id="A2.T5.2.2.2.m1.1.1.1" xref="A2.T5.2.2.2.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A2.T5.2.2.2.m1.1b"><apply id="A2.T5.2.2.2.m1.1.1.cmml" xref="A2.T5.2.2.2.m1.1.1"><ci id="A2.T5.2.2.2.m1.1.1.1.cmml" xref="A2.T5.2.2.2.m1.1.1.1">^</ci><ci id="A2.T5.2.2.2.m1.1.1.2.cmml" xref="A2.T5.2.2.2.m1.1.1.2">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.2.2.2.m1.1c">\hat{a}</annotation></semantics></math></td>
<td id="A2.T5.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="A2.T5.3.3.3.m1.2" class="ltx_Math" alttext="\text{conv}_{2}(\text{conv}_{1}(x)\odot Wc_{t})" display="inline"><semantics id="A2.T5.3.3.3.m1.2a"><mrow id="A2.T5.3.3.3.m1.2.2" xref="A2.T5.3.3.3.m1.2.2.cmml"><msub id="A2.T5.3.3.3.m1.2.2.3" xref="A2.T5.3.3.3.m1.2.2.3.cmml"><mtext mathsize="90%" id="A2.T5.3.3.3.m1.2.2.3.2" xref="A2.T5.3.3.3.m1.2.2.3.2a.cmml">conv</mtext><mn mathsize="90%" id="A2.T5.3.3.3.m1.2.2.3.3" xref="A2.T5.3.3.3.m1.2.2.3.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="A2.T5.3.3.3.m1.2.2.2" xref="A2.T5.3.3.3.m1.2.2.2.cmml">​</mo><mrow id="A2.T5.3.3.3.m1.2.2.1.1" xref="A2.T5.3.3.3.m1.2.2.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="A2.T5.3.3.3.m1.2.2.1.1.2" xref="A2.T5.3.3.3.m1.2.2.1.1.1.cmml">(</mo><mrow id="A2.T5.3.3.3.m1.2.2.1.1.1" xref="A2.T5.3.3.3.m1.2.2.1.1.1.cmml"><mrow id="A2.T5.3.3.3.m1.2.2.1.1.1.2" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2.cmml"><mrow id="A2.T5.3.3.3.m1.2.2.1.1.1.2.2" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.cmml"><msub id="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.2" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.2.cmml"><mtext mathsize="90%" id="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.2.2" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.2.2a.cmml">conv</mtext><mn mathsize="90%" id="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.2.3" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.1" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.1.cmml">​</mo><mrow id="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.3.2" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.cmml"><mo maxsize="90%" minsize="90%" id="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.3.2.1" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.cmml">(</mo><mi mathsize="90%" id="A2.T5.3.3.3.m1.1.1" xref="A2.T5.3.3.3.m1.1.1.cmml">x</mi><mo maxsize="90%" minsize="90%" rspace="0.055em" id="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.3.2.2" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.cmml">)</mo></mrow></mrow><mo mathsize="90%" rspace="0.222em" id="A2.T5.3.3.3.m1.2.2.1.1.1.2.1" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2.1.cmml">⊙</mo><mi mathsize="90%" id="A2.T5.3.3.3.m1.2.2.1.1.1.2.3" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2.3.cmml">W</mi></mrow><mo lspace="0em" rspace="0em" id="A2.T5.3.3.3.m1.2.2.1.1.1.1" xref="A2.T5.3.3.3.m1.2.2.1.1.1.1.cmml">​</mo><msub id="A2.T5.3.3.3.m1.2.2.1.1.1.3" xref="A2.T5.3.3.3.m1.2.2.1.1.1.3.cmml"><mi mathsize="90%" id="A2.T5.3.3.3.m1.2.2.1.1.1.3.2" xref="A2.T5.3.3.3.m1.2.2.1.1.1.3.2.cmml">c</mi><mi mathsize="90%" id="A2.T5.3.3.3.m1.2.2.1.1.1.3.3" xref="A2.T5.3.3.3.m1.2.2.1.1.1.3.3.cmml">t</mi></msub></mrow><mo maxsize="90%" minsize="90%" id="A2.T5.3.3.3.m1.2.2.1.1.3" xref="A2.T5.3.3.3.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.T5.3.3.3.m1.2b"><apply id="A2.T5.3.3.3.m1.2.2.cmml" xref="A2.T5.3.3.3.m1.2.2"><times id="A2.T5.3.3.3.m1.2.2.2.cmml" xref="A2.T5.3.3.3.m1.2.2.2"></times><apply id="A2.T5.3.3.3.m1.2.2.3.cmml" xref="A2.T5.3.3.3.m1.2.2.3"><csymbol cd="ambiguous" id="A2.T5.3.3.3.m1.2.2.3.1.cmml" xref="A2.T5.3.3.3.m1.2.2.3">subscript</csymbol><ci id="A2.T5.3.3.3.m1.2.2.3.2a.cmml" xref="A2.T5.3.3.3.m1.2.2.3.2"><mtext mathsize="90%" id="A2.T5.3.3.3.m1.2.2.3.2.cmml" xref="A2.T5.3.3.3.m1.2.2.3.2">conv</mtext></ci><cn type="integer" id="A2.T5.3.3.3.m1.2.2.3.3.cmml" xref="A2.T5.3.3.3.m1.2.2.3.3">2</cn></apply><apply id="A2.T5.3.3.3.m1.2.2.1.1.1.cmml" xref="A2.T5.3.3.3.m1.2.2.1.1"><times id="A2.T5.3.3.3.m1.2.2.1.1.1.1.cmml" xref="A2.T5.3.3.3.m1.2.2.1.1.1.1"></times><apply id="A2.T5.3.3.3.m1.2.2.1.1.1.2.cmml" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2"><csymbol cd="latexml" id="A2.T5.3.3.3.m1.2.2.1.1.1.2.1.cmml" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2.1">direct-product</csymbol><apply id="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.cmml" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2.2"><times id="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.1.cmml" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.1"></times><apply id="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.2.cmml" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.2.1.cmml" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.2">subscript</csymbol><ci id="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.2.2a.cmml" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.2.2"><mtext mathsize="90%" id="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.2.2.cmml" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.2.2">conv</mtext></ci><cn type="integer" id="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.2.3.cmml" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2.2.2.3">1</cn></apply><ci id="A2.T5.3.3.3.m1.1.1.cmml" xref="A2.T5.3.3.3.m1.1.1">𝑥</ci></apply><ci id="A2.T5.3.3.3.m1.2.2.1.1.1.2.3.cmml" xref="A2.T5.3.3.3.m1.2.2.1.1.1.2.3">𝑊</ci></apply><apply id="A2.T5.3.3.3.m1.2.2.1.1.1.3.cmml" xref="A2.T5.3.3.3.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A2.T5.3.3.3.m1.2.2.1.1.1.3.1.cmml" xref="A2.T5.3.3.3.m1.2.2.1.1.1.3">subscript</csymbol><ci id="A2.T5.3.3.3.m1.2.2.1.1.1.3.2.cmml" xref="A2.T5.3.3.3.m1.2.2.1.1.1.3.2">𝑐</ci><ci id="A2.T5.3.3.3.m1.2.2.1.1.1.3.3.cmml" xref="A2.T5.3.3.3.m1.2.2.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.3.3.3.m1.2c">\text{conv}_{2}(\text{conv}_{1}(x)\odot Wc_{t})</annotation></semantics></math></td>
<td id="A2.T5.4.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="A2.T5.4.4.4.m1.2" class="ltx_Math" alttext="\text{conv}(g(x,Wc_{t}))" display="inline"><semantics id="A2.T5.4.4.4.m1.2a"><mrow id="A2.T5.4.4.4.m1.2.2" xref="A2.T5.4.4.4.m1.2.2.cmml"><mtext mathsize="90%" id="A2.T5.4.4.4.m1.2.2.3" xref="A2.T5.4.4.4.m1.2.2.3a.cmml">conv</mtext><mo lspace="0em" rspace="0em" id="A2.T5.4.4.4.m1.2.2.2" xref="A2.T5.4.4.4.m1.2.2.2.cmml">​</mo><mrow id="A2.T5.4.4.4.m1.2.2.1.1" xref="A2.T5.4.4.4.m1.2.2.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="A2.T5.4.4.4.m1.2.2.1.1.2" xref="A2.T5.4.4.4.m1.2.2.1.1.1.cmml">(</mo><mrow id="A2.T5.4.4.4.m1.2.2.1.1.1" xref="A2.T5.4.4.4.m1.2.2.1.1.1.cmml"><mi mathsize="90%" id="A2.T5.4.4.4.m1.2.2.1.1.1.3" xref="A2.T5.4.4.4.m1.2.2.1.1.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="A2.T5.4.4.4.m1.2.2.1.1.1.2" xref="A2.T5.4.4.4.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="A2.T5.4.4.4.m1.2.2.1.1.1.1.1" xref="A2.T5.4.4.4.m1.2.2.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.2" xref="A2.T5.4.4.4.m1.2.2.1.1.1.1.2.cmml">(</mo><mi mathsize="90%" id="A2.T5.4.4.4.m1.1.1" xref="A2.T5.4.4.4.m1.1.1.cmml">x</mi><mo mathsize="90%" id="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.3" xref="A2.T5.4.4.4.m1.2.2.1.1.1.1.2.cmml">,</mo><mrow id="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1" xref="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.2" xref="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.2.cmml">W</mi><mo lspace="0em" rspace="0em" id="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.1" xref="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.1.cmml">​</mo><msub id="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.3" xref="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.3.2" xref="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.3.2.cmml">c</mi><mi mathsize="90%" id="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.3.3" xref="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo maxsize="90%" minsize="90%" id="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.4" xref="A2.T5.4.4.4.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo maxsize="90%" minsize="90%" id="A2.T5.4.4.4.m1.2.2.1.1.3" xref="A2.T5.4.4.4.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.T5.4.4.4.m1.2b"><apply id="A2.T5.4.4.4.m1.2.2.cmml" xref="A2.T5.4.4.4.m1.2.2"><times id="A2.T5.4.4.4.m1.2.2.2.cmml" xref="A2.T5.4.4.4.m1.2.2.2"></times><ci id="A2.T5.4.4.4.m1.2.2.3a.cmml" xref="A2.T5.4.4.4.m1.2.2.3"><mtext mathsize="90%" id="A2.T5.4.4.4.m1.2.2.3.cmml" xref="A2.T5.4.4.4.m1.2.2.3">conv</mtext></ci><apply id="A2.T5.4.4.4.m1.2.2.1.1.1.cmml" xref="A2.T5.4.4.4.m1.2.2.1.1"><times id="A2.T5.4.4.4.m1.2.2.1.1.1.2.cmml" xref="A2.T5.4.4.4.m1.2.2.1.1.1.2"></times><ci id="A2.T5.4.4.4.m1.2.2.1.1.1.3.cmml" xref="A2.T5.4.4.4.m1.2.2.1.1.1.3">𝑔</ci><interval closure="open" id="A2.T5.4.4.4.m1.2.2.1.1.1.1.2.cmml" xref="A2.T5.4.4.4.m1.2.2.1.1.1.1.1"><ci id="A2.T5.4.4.4.m1.1.1.cmml" xref="A2.T5.4.4.4.m1.1.1">𝑥</ci><apply id="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.cmml" xref="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1"><times id="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.1"></times><ci id="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.2">𝑊</ci><apply id="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.3.2">𝑐</ci><ci id="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="A2.T5.4.4.4.m1.2.2.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.4.4.4.m1.2c">\text{conv}(g(x,Wc_{t}))</annotation></semantics></math></td>
</tr>
<tr id="A2.T5.8.8" class="ltx_tr">
<td id="A2.T5.8.8.5" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T5.8.8.5.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">Transform</span></td>
<td id="A2.T5.5.5.1" class="ltx_td ltx_align_center ltx_border_r"><math id="A2.T5.5.5.1.m1.3" class="ltx_Math" alttext="x,c_{t},a" display="inline"><semantics id="A2.T5.5.5.1.m1.3a"><mrow id="A2.T5.5.5.1.m1.3.3.1" xref="A2.T5.5.5.1.m1.3.3.2.cmml"><mi mathsize="90%" id="A2.T5.5.5.1.m1.1.1" xref="A2.T5.5.5.1.m1.1.1.cmml">x</mi><mo mathsize="90%" id="A2.T5.5.5.1.m1.3.3.1.2" xref="A2.T5.5.5.1.m1.3.3.2.cmml">,</mo><msub id="A2.T5.5.5.1.m1.3.3.1.1" xref="A2.T5.5.5.1.m1.3.3.1.1.cmml"><mi mathsize="90%" id="A2.T5.5.5.1.m1.3.3.1.1.2" xref="A2.T5.5.5.1.m1.3.3.1.1.2.cmml">c</mi><mi mathsize="90%" id="A2.T5.5.5.1.m1.3.3.1.1.3" xref="A2.T5.5.5.1.m1.3.3.1.1.3.cmml">t</mi></msub><mo mathsize="90%" id="A2.T5.5.5.1.m1.3.3.1.3" xref="A2.T5.5.5.1.m1.3.3.2.cmml">,</mo><mi mathsize="90%" id="A2.T5.5.5.1.m1.2.2" xref="A2.T5.5.5.1.m1.2.2.cmml">a</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T5.5.5.1.m1.3b"><list id="A2.T5.5.5.1.m1.3.3.2.cmml" xref="A2.T5.5.5.1.m1.3.3.1"><ci id="A2.T5.5.5.1.m1.1.1.cmml" xref="A2.T5.5.5.1.m1.1.1">𝑥</ci><apply id="A2.T5.5.5.1.m1.3.3.1.1.cmml" xref="A2.T5.5.5.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="A2.T5.5.5.1.m1.3.3.1.1.1.cmml" xref="A2.T5.5.5.1.m1.3.3.1.1">subscript</csymbol><ci id="A2.T5.5.5.1.m1.3.3.1.1.2.cmml" xref="A2.T5.5.5.1.m1.3.3.1.1.2">𝑐</ci><ci id="A2.T5.5.5.1.m1.3.3.1.1.3.cmml" xref="A2.T5.5.5.1.m1.3.3.1.1.3">𝑡</ci></apply><ci id="A2.T5.5.5.1.m1.2.2.cmml" xref="A2.T5.5.5.1.m1.2.2">𝑎</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.5.5.1.m1.3c">x,c_{t},a</annotation></semantics></math></td>
<td id="A2.T5.6.6.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A2.T5.6.6.2.m1.1" class="ltx_Math" alttext="\hat{a}" display="inline"><semantics id="A2.T5.6.6.2.m1.1a"><mover accent="true" id="A2.T5.6.6.2.m1.1.1" xref="A2.T5.6.6.2.m1.1.1.cmml"><mi mathsize="90%" id="A2.T5.6.6.2.m1.1.1.2" xref="A2.T5.6.6.2.m1.1.1.2.cmml">a</mi><mo mathsize="90%" id="A2.T5.6.6.2.m1.1.1.1" xref="A2.T5.6.6.2.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A2.T5.6.6.2.m1.1b"><apply id="A2.T5.6.6.2.m1.1.1.cmml" xref="A2.T5.6.6.2.m1.1.1"><ci id="A2.T5.6.6.2.m1.1.1.1.cmml" xref="A2.T5.6.6.2.m1.1.1.1">^</ci><ci id="A2.T5.6.6.2.m1.1.1.2.cmml" xref="A2.T5.6.6.2.m1.1.1.2">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.6.6.2.m1.1c">\hat{a}</annotation></semantics></math></td>
<td id="A2.T5.7.7.3" class="ltx_td ltx_align_center ltx_border_r"><math id="A2.T5.7.7.3.m1.2" class="ltx_Math" alttext="\text{conv}_{2}(\text{conv}_{1}(x)\odot W_{1}\sum(a\odot x)\odot W_{2}c_{t})" display="inline"><semantics id="A2.T5.7.7.3.m1.2a"><mrow id="A2.T5.7.7.3.m1.2.2" xref="A2.T5.7.7.3.m1.2.2.cmml"><msub id="A2.T5.7.7.3.m1.2.2.3" xref="A2.T5.7.7.3.m1.2.2.3.cmml"><mtext mathsize="90%" id="A2.T5.7.7.3.m1.2.2.3.2" xref="A2.T5.7.7.3.m1.2.2.3.2a.cmml">conv</mtext><mn mathsize="90%" id="A2.T5.7.7.3.m1.2.2.3.3" xref="A2.T5.7.7.3.m1.2.2.3.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="A2.T5.7.7.3.m1.2.2.2" xref="A2.T5.7.7.3.m1.2.2.2.cmml">​</mo><mrow id="A2.T5.7.7.3.m1.2.2.1.1" xref="A2.T5.7.7.3.m1.2.2.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="A2.T5.7.7.3.m1.2.2.1.1.2" xref="A2.T5.7.7.3.m1.2.2.1.1.1.cmml">(</mo><mrow id="A2.T5.7.7.3.m1.2.2.1.1.1" xref="A2.T5.7.7.3.m1.2.2.1.1.1.cmml"><mrow id="A2.T5.7.7.3.m1.2.2.1.1.1.3" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.cmml"><mrow id="A2.T5.7.7.3.m1.2.2.1.1.1.3.2" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.cmml"><msub id="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.2" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.2.cmml"><mtext mathsize="90%" id="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.2.2" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.2.2a.cmml">conv</mtext><mn mathsize="90%" id="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.2.3" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.1" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.1.cmml">​</mo><mrow id="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.3.2" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.cmml"><mo maxsize="90%" minsize="90%" id="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.3.2.1" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.cmml">(</mo><mi mathsize="90%" id="A2.T5.7.7.3.m1.1.1" xref="A2.T5.7.7.3.m1.1.1.cmml">x</mi><mo maxsize="90%" minsize="90%" rspace="0.055em" id="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.3.2.2" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.cmml">)</mo></mrow></mrow><mo mathsize="90%" rspace="0.222em" id="A2.T5.7.7.3.m1.2.2.1.1.1.3.1" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.1.cmml">⊙</mo><msub id="A2.T5.7.7.3.m1.2.2.1.1.1.3.3" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.3.cmml"><mi mathsize="90%" id="A2.T5.7.7.3.m1.2.2.1.1.1.3.3.2" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.3.2.cmml">W</mi><mn mathsize="90%" id="A2.T5.7.7.3.m1.2.2.1.1.1.3.3.3" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.3.3.cmml">1</mn></msub></mrow><mo lspace="0em" rspace="0em" id="A2.T5.7.7.3.m1.2.2.1.1.1.2" xref="A2.T5.7.7.3.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="A2.T5.7.7.3.m1.2.2.1.1.1.1" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" rspace="0em" stretchy="true" id="A2.T5.7.7.3.m1.2.2.1.1.1.1.2" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.2.cmml">∑</mo><mrow id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.cmml"><mrow id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1.2" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1.1" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">a</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">⊙</mo><mi mathsize="90%" id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo maxsize="90%" minsize="90%" rspace="0.055em" id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1.3" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo mathsize="90%" rspace="0.222em" id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.2" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.2.cmml">⊙</mo><msub id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.3" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.3.2" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.3.2.cmml">W</mi><mn mathsize="90%" id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.3.3" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo lspace="0em" rspace="0em" id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.2" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.2.cmml">​</mo><msub id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.3" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.3.2" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.3.2.cmml">c</mi><mi mathsize="90%" id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.3.3" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow></mrow></mrow><mo maxsize="90%" minsize="90%" id="A2.T5.7.7.3.m1.2.2.1.1.3" xref="A2.T5.7.7.3.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.T5.7.7.3.m1.2b"><apply id="A2.T5.7.7.3.m1.2.2.cmml" xref="A2.T5.7.7.3.m1.2.2"><times id="A2.T5.7.7.3.m1.2.2.2.cmml" xref="A2.T5.7.7.3.m1.2.2.2"></times><apply id="A2.T5.7.7.3.m1.2.2.3.cmml" xref="A2.T5.7.7.3.m1.2.2.3"><csymbol cd="ambiguous" id="A2.T5.7.7.3.m1.2.2.3.1.cmml" xref="A2.T5.7.7.3.m1.2.2.3">subscript</csymbol><ci id="A2.T5.7.7.3.m1.2.2.3.2a.cmml" xref="A2.T5.7.7.3.m1.2.2.3.2"><mtext mathsize="90%" id="A2.T5.7.7.3.m1.2.2.3.2.cmml" xref="A2.T5.7.7.3.m1.2.2.3.2">conv</mtext></ci><cn type="integer" id="A2.T5.7.7.3.m1.2.2.3.3.cmml" xref="A2.T5.7.7.3.m1.2.2.3.3">2</cn></apply><apply id="A2.T5.7.7.3.m1.2.2.1.1.1.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1"><times id="A2.T5.7.7.3.m1.2.2.1.1.1.2.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.2"></times><apply id="A2.T5.7.7.3.m1.2.2.1.1.1.3.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3"><csymbol cd="latexml" id="A2.T5.7.7.3.m1.2.2.1.1.1.3.1.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.1">direct-product</csymbol><apply id="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.2"><times id="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.1.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.1"></times><apply id="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.2.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.2"><csymbol cd="ambiguous" id="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.2.1.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.2">subscript</csymbol><ci id="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.2.2a.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.2.2"><mtext mathsize="90%" id="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.2.2.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.2.2">conv</mtext></ci><cn type="integer" id="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.2.3.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.2.2.3">1</cn></apply><ci id="A2.T5.7.7.3.m1.1.1.cmml" xref="A2.T5.7.7.3.m1.1.1">𝑥</ci></apply><apply id="A2.T5.7.7.3.m1.2.2.1.1.1.3.3.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.T5.7.7.3.m1.2.2.1.1.1.3.3.1.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.3">subscript</csymbol><ci id="A2.T5.7.7.3.m1.2.2.1.1.1.3.3.2.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.3.2">𝑊</ci><cn type="integer" id="A2.T5.7.7.3.m1.2.2.1.1.1.3.3.3.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.3.3.3">1</cn></apply></apply><apply id="A2.T5.7.7.3.m1.2.2.1.1.1.1.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1"><sum id="A2.T5.7.7.3.m1.2.2.1.1.1.1.2.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.2"></sum><apply id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1"><times id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.2.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.2"></times><apply id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.2">direct-product</csymbol><apply id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1.1.1">direct-product</csymbol><ci id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝑎</ci><ci id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑥</ci></apply><apply id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.3.2">𝑊</ci><cn type="integer" id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.1.3.3">2</cn></apply></apply><apply id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.3.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.3.1.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.3.2.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.3.2">𝑐</ci><ci id="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.3.3.cmml" xref="A2.T5.7.7.3.m1.2.2.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.7.7.3.m1.2c">\text{conv}_{2}(\text{conv}_{1}(x)\odot W_{1}\sum(a\odot x)\odot W_{2}c_{t})</annotation></semantics></math></td>
<td id="A2.T5.8.8.4" class="ltx_td ltx_align_center ltx_border_r"><math id="A2.T5.8.8.4.m1.1" class="ltx_Math" alttext="\text{norm}((\sigma(RWc_{t})\odot M)a)" display="inline"><semantics id="A2.T5.8.8.4.m1.1a"><mrow id="A2.T5.8.8.4.m1.1.1" xref="A2.T5.8.8.4.m1.1.1.cmml"><mtext mathsize="90%" id="A2.T5.8.8.4.m1.1.1.3" xref="A2.T5.8.8.4.m1.1.1.3a.cmml">norm</mtext><mo lspace="0em" rspace="0em" id="A2.T5.8.8.4.m1.1.1.2" xref="A2.T5.8.8.4.m1.1.1.2.cmml">​</mo><mrow id="A2.T5.8.8.4.m1.1.1.1.1" xref="A2.T5.8.8.4.m1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="A2.T5.8.8.4.m1.1.1.1.1.2" xref="A2.T5.8.8.4.m1.1.1.1.1.1.cmml">(</mo><mrow id="A2.T5.8.8.4.m1.1.1.1.1.1" xref="A2.T5.8.8.4.m1.1.1.1.1.1.cmml"><mrow id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.2" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.3" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.2" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi mathsize="90%" id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">W</mi><mo lspace="0em" rspace="0em" id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1a" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.4" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi mathsize="90%" id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.2" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml">c</mi><mi mathsize="90%" id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.3" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml">t</mi></msub></mrow><mo maxsize="90%" minsize="90%" rspace="0.055em" id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" rspace="0.222em" id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.2" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.2.cmml">⊙</mo><mi mathsize="90%" id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.3" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.3.cmml">M</mi></mrow><mo maxsize="90%" minsize="90%" id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.3" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A2.T5.8.8.4.m1.1.1.1.1.1.2" xref="A2.T5.8.8.4.m1.1.1.1.1.1.2.cmml">​</mo><mi mathsize="90%" id="A2.T5.8.8.4.m1.1.1.1.1.1.3" xref="A2.T5.8.8.4.m1.1.1.1.1.1.3.cmml">a</mi></mrow><mo maxsize="90%" minsize="90%" id="A2.T5.8.8.4.m1.1.1.1.1.3" xref="A2.T5.8.8.4.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.T5.8.8.4.m1.1b"><apply id="A2.T5.8.8.4.m1.1.1.cmml" xref="A2.T5.8.8.4.m1.1.1"><times id="A2.T5.8.8.4.m1.1.1.2.cmml" xref="A2.T5.8.8.4.m1.1.1.2"></times><ci id="A2.T5.8.8.4.m1.1.1.3a.cmml" xref="A2.T5.8.8.4.m1.1.1.3"><mtext mathsize="90%" id="A2.T5.8.8.4.m1.1.1.3.cmml" xref="A2.T5.8.8.4.m1.1.1.3">norm</mtext></ci><apply id="A2.T5.8.8.4.m1.1.1.1.1.1.cmml" xref="A2.T5.8.8.4.m1.1.1.1.1"><times id="A2.T5.8.8.4.m1.1.1.1.1.1.2.cmml" xref="A2.T5.8.8.4.m1.1.1.1.1.1.2"></times><apply id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.cmml" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1"><times id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.2"></times><ci id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.3">𝜎</ci><apply id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑅</ci><ci id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑊</ci><apply id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.2">𝑐</ci><ci id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.3">𝑡</ci></apply></apply></apply><ci id="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.T5.8.8.4.m1.1.1.1.1.1.1.1.1.3">𝑀</ci></apply><ci id="A2.T5.8.8.4.m1.1.1.1.1.1.3.cmml" xref="A2.T5.8.8.4.m1.1.1.1.1.1.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.8.8.4.m1.1c">\text{norm}((\sigma(RWc_{t})\odot M)a)</annotation></semantics></math></td>
</tr>
<tr id="A2.T5.11.11" class="ltx_tr">
<td id="A2.T5.11.11.4" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T5.11.11.4.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">Filter</span></td>
<td id="A2.T5.9.9.1" class="ltx_td ltx_align_center ltx_border_r"><math id="A2.T5.9.9.1.m1.3" class="ltx_Math" alttext="x,c_{t},a" display="inline"><semantics id="A2.T5.9.9.1.m1.3a"><mrow id="A2.T5.9.9.1.m1.3.3.1" xref="A2.T5.9.9.1.m1.3.3.2.cmml"><mi mathsize="90%" id="A2.T5.9.9.1.m1.1.1" xref="A2.T5.9.9.1.m1.1.1.cmml">x</mi><mo mathsize="90%" id="A2.T5.9.9.1.m1.3.3.1.2" xref="A2.T5.9.9.1.m1.3.3.2.cmml">,</mo><msub id="A2.T5.9.9.1.m1.3.3.1.1" xref="A2.T5.9.9.1.m1.3.3.1.1.cmml"><mi mathsize="90%" id="A2.T5.9.9.1.m1.3.3.1.1.2" xref="A2.T5.9.9.1.m1.3.3.1.1.2.cmml">c</mi><mi mathsize="90%" id="A2.T5.9.9.1.m1.3.3.1.1.3" xref="A2.T5.9.9.1.m1.3.3.1.1.3.cmml">t</mi></msub><mo mathsize="90%" id="A2.T5.9.9.1.m1.3.3.1.3" xref="A2.T5.9.9.1.m1.3.3.2.cmml">,</mo><mi mathsize="90%" id="A2.T5.9.9.1.m1.2.2" xref="A2.T5.9.9.1.m1.2.2.cmml">a</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T5.9.9.1.m1.3b"><list id="A2.T5.9.9.1.m1.3.3.2.cmml" xref="A2.T5.9.9.1.m1.3.3.1"><ci id="A2.T5.9.9.1.m1.1.1.cmml" xref="A2.T5.9.9.1.m1.1.1">𝑥</ci><apply id="A2.T5.9.9.1.m1.3.3.1.1.cmml" xref="A2.T5.9.9.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="A2.T5.9.9.1.m1.3.3.1.1.1.cmml" xref="A2.T5.9.9.1.m1.3.3.1.1">subscript</csymbol><ci id="A2.T5.9.9.1.m1.3.3.1.1.2.cmml" xref="A2.T5.9.9.1.m1.3.3.1.1.2">𝑐</ci><ci id="A2.T5.9.9.1.m1.3.3.1.1.3.cmml" xref="A2.T5.9.9.1.m1.3.3.1.1.3">𝑡</ci></apply><ci id="A2.T5.9.9.1.m1.2.2.cmml" xref="A2.T5.9.9.1.m1.2.2">𝑎</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.9.9.1.m1.3c">x,c_{t},a</annotation></semantics></math></td>
<td id="A2.T5.10.10.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A2.T5.10.10.2.m1.1" class="ltx_Math" alttext="\hat{a}" display="inline"><semantics id="A2.T5.10.10.2.m1.1a"><mover accent="true" id="A2.T5.10.10.2.m1.1.1" xref="A2.T5.10.10.2.m1.1.1.cmml"><mi mathsize="90%" id="A2.T5.10.10.2.m1.1.1.2" xref="A2.T5.10.10.2.m1.1.1.2.cmml">a</mi><mo mathsize="90%" id="A2.T5.10.10.2.m1.1.1.1" xref="A2.T5.10.10.2.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A2.T5.10.10.2.m1.1b"><apply id="A2.T5.10.10.2.m1.1.1.cmml" xref="A2.T5.10.10.2.m1.1.1"><ci id="A2.T5.10.10.2.m1.1.1.1.cmml" xref="A2.T5.10.10.2.m1.1.1.1">^</ci><ci id="A2.T5.10.10.2.m1.1.1.2.cmml" xref="A2.T5.10.10.2.m1.1.1.2">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.10.10.2.m1.1c">\hat{a}</annotation></semantics></math></td>
<td id="A2.T5.11.11.3" class="ltx_td ltx_align_center ltx_border_r"><math id="A2.T5.11.11.3.m1.3" class="ltx_Math" alttext="\texttt{And}(\texttt{Find}(x,c_{t}),a)" display="inline"><semantics id="A2.T5.11.11.3.m1.3a"><mrow id="A2.T5.11.11.3.m1.3.3" xref="A2.T5.11.11.3.m1.3.3.cmml"><mtext class="ltx_mathvariant_monospace" mathsize="90%" id="A2.T5.11.11.3.m1.3.3.3" xref="A2.T5.11.11.3.m1.3.3.3a.cmml">And</mtext><mo lspace="0em" rspace="0em" id="A2.T5.11.11.3.m1.3.3.2" xref="A2.T5.11.11.3.m1.3.3.2.cmml">​</mo><mrow id="A2.T5.11.11.3.m1.3.3.1.1" xref="A2.T5.11.11.3.m1.3.3.1.2.cmml"><mo maxsize="90%" minsize="90%" id="A2.T5.11.11.3.m1.3.3.1.1.2" xref="A2.T5.11.11.3.m1.3.3.1.2.cmml">(</mo><mrow id="A2.T5.11.11.3.m1.3.3.1.1.1" xref="A2.T5.11.11.3.m1.3.3.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" mathsize="90%" id="A2.T5.11.11.3.m1.3.3.1.1.1.3" xref="A2.T5.11.11.3.m1.3.3.1.1.1.3a.cmml">Find</mtext><mo lspace="0em" rspace="0em" id="A2.T5.11.11.3.m1.3.3.1.1.1.2" xref="A2.T5.11.11.3.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="A2.T5.11.11.3.m1.3.3.1.1.1.1.1" xref="A2.T5.11.11.3.m1.3.3.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="A2.T5.11.11.3.m1.3.3.1.1.1.1.1.2" xref="A2.T5.11.11.3.m1.3.3.1.1.1.1.2.cmml">(</mo><mi mathsize="90%" id="A2.T5.11.11.3.m1.1.1" xref="A2.T5.11.11.3.m1.1.1.cmml">x</mi><mo mathsize="90%" id="A2.T5.11.11.3.m1.3.3.1.1.1.1.1.3" xref="A2.T5.11.11.3.m1.3.3.1.1.1.1.2.cmml">,</mo><msub id="A2.T5.11.11.3.m1.3.3.1.1.1.1.1.1" xref="A2.T5.11.11.3.m1.3.3.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="A2.T5.11.11.3.m1.3.3.1.1.1.1.1.1.2" xref="A2.T5.11.11.3.m1.3.3.1.1.1.1.1.1.2.cmml">c</mi><mi mathsize="90%" id="A2.T5.11.11.3.m1.3.3.1.1.1.1.1.1.3" xref="A2.T5.11.11.3.m1.3.3.1.1.1.1.1.1.3.cmml">t</mi></msub><mo maxsize="90%" minsize="90%" id="A2.T5.11.11.3.m1.3.3.1.1.1.1.1.4" xref="A2.T5.11.11.3.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="A2.T5.11.11.3.m1.3.3.1.1.3" xref="A2.T5.11.11.3.m1.3.3.1.2.cmml">,</mo><mi mathsize="90%" id="A2.T5.11.11.3.m1.2.2" xref="A2.T5.11.11.3.m1.2.2.cmml">a</mi><mo maxsize="90%" minsize="90%" id="A2.T5.11.11.3.m1.3.3.1.1.4" xref="A2.T5.11.11.3.m1.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.T5.11.11.3.m1.3b"><apply id="A2.T5.11.11.3.m1.3.3.cmml" xref="A2.T5.11.11.3.m1.3.3"><times id="A2.T5.11.11.3.m1.3.3.2.cmml" xref="A2.T5.11.11.3.m1.3.3.2"></times><ci id="A2.T5.11.11.3.m1.3.3.3a.cmml" xref="A2.T5.11.11.3.m1.3.3.3"><mtext class="ltx_mathvariant_monospace" mathsize="90%" id="A2.T5.11.11.3.m1.3.3.3.cmml" xref="A2.T5.11.11.3.m1.3.3.3">And</mtext></ci><interval closure="open" id="A2.T5.11.11.3.m1.3.3.1.2.cmml" xref="A2.T5.11.11.3.m1.3.3.1.1"><apply id="A2.T5.11.11.3.m1.3.3.1.1.1.cmml" xref="A2.T5.11.11.3.m1.3.3.1.1.1"><times id="A2.T5.11.11.3.m1.3.3.1.1.1.2.cmml" xref="A2.T5.11.11.3.m1.3.3.1.1.1.2"></times><ci id="A2.T5.11.11.3.m1.3.3.1.1.1.3a.cmml" xref="A2.T5.11.11.3.m1.3.3.1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="90%" id="A2.T5.11.11.3.m1.3.3.1.1.1.3.cmml" xref="A2.T5.11.11.3.m1.3.3.1.1.1.3">Find</mtext></ci><interval closure="open" id="A2.T5.11.11.3.m1.3.3.1.1.1.1.2.cmml" xref="A2.T5.11.11.3.m1.3.3.1.1.1.1.1"><ci id="A2.T5.11.11.3.m1.1.1.cmml" xref="A2.T5.11.11.3.m1.1.1">𝑥</ci><apply id="A2.T5.11.11.3.m1.3.3.1.1.1.1.1.1.cmml" xref="A2.T5.11.11.3.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.T5.11.11.3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A2.T5.11.11.3.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="A2.T5.11.11.3.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A2.T5.11.11.3.m1.3.3.1.1.1.1.1.1.2">𝑐</ci><ci id="A2.T5.11.11.3.m1.3.3.1.1.1.1.1.1.3.cmml" xref="A2.T5.11.11.3.m1.3.3.1.1.1.1.1.1.3">𝑡</ci></apply></interval></apply><ci id="A2.T5.11.11.3.m1.2.2.cmml" xref="A2.T5.11.11.3.m1.2.2">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.11.11.3.m1.3c">\texttt{And}(\texttt{Find}(x,c_{t}),a)</annotation></semantics></math></td>
<td id="A2.T5.11.11.5" class="ltx_td ltx_align_center ltx_border_r"><span id="A2.T5.11.11.5.1" class="ltx_text" style="font-size:90%;">(same as StackNMN)</span></td>
</tr>
<tr id="A2.T5.15.15" class="ltx_tr">
<td id="A2.T5.15.15.5" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T5.15.15.5.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">And</span></td>
<td id="A2.T5.13.13.2" class="ltx_td ltx_align_center ltx_border_r">
<math id="A2.T5.12.12.1.m1.1" class="ltx_Math" alttext="a_{1}" display="inline"><semantics id="A2.T5.12.12.1.m1.1a"><msub id="A2.T5.12.12.1.m1.1.1" xref="A2.T5.12.12.1.m1.1.1.cmml"><mi mathsize="90%" id="A2.T5.12.12.1.m1.1.1.2" xref="A2.T5.12.12.1.m1.1.1.2.cmml">a</mi><mn mathsize="90%" id="A2.T5.12.12.1.m1.1.1.3" xref="A2.T5.12.12.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A2.T5.12.12.1.m1.1b"><apply id="A2.T5.12.12.1.m1.1.1.cmml" xref="A2.T5.12.12.1.m1.1.1"><csymbol cd="ambiguous" id="A2.T5.12.12.1.m1.1.1.1.cmml" xref="A2.T5.12.12.1.m1.1.1">subscript</csymbol><ci id="A2.T5.12.12.1.m1.1.1.2.cmml" xref="A2.T5.12.12.1.m1.1.1.2">𝑎</ci><cn type="integer" id="A2.T5.12.12.1.m1.1.1.3.cmml" xref="A2.T5.12.12.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.12.12.1.m1.1c">a_{1}</annotation></semantics></math><span id="A2.T5.13.13.2.1" class="ltx_text" style="font-size:90%;">, </span><math id="A2.T5.13.13.2.m2.1" class="ltx_Math" alttext="a_{2}" display="inline"><semantics id="A2.T5.13.13.2.m2.1a"><msub id="A2.T5.13.13.2.m2.1.1" xref="A2.T5.13.13.2.m2.1.1.cmml"><mi mathsize="90%" id="A2.T5.13.13.2.m2.1.1.2" xref="A2.T5.13.13.2.m2.1.1.2.cmml">a</mi><mn mathsize="90%" id="A2.T5.13.13.2.m2.1.1.3" xref="A2.T5.13.13.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A2.T5.13.13.2.m2.1b"><apply id="A2.T5.13.13.2.m2.1.1.cmml" xref="A2.T5.13.13.2.m2.1.1"><csymbol cd="ambiguous" id="A2.T5.13.13.2.m2.1.1.1.cmml" xref="A2.T5.13.13.2.m2.1.1">subscript</csymbol><ci id="A2.T5.13.13.2.m2.1.1.2.cmml" xref="A2.T5.13.13.2.m2.1.1.2">𝑎</ci><cn type="integer" id="A2.T5.13.13.2.m2.1.1.3.cmml" xref="A2.T5.13.13.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.13.13.2.m2.1c">a_{2}</annotation></semantics></math>
</td>
<td id="A2.T5.14.14.3" class="ltx_td ltx_align_center ltx_border_r"><math id="A2.T5.14.14.3.m1.1" class="ltx_Math" alttext="\hat{a}" display="inline"><semantics id="A2.T5.14.14.3.m1.1a"><mover accent="true" id="A2.T5.14.14.3.m1.1.1" xref="A2.T5.14.14.3.m1.1.1.cmml"><mi mathsize="90%" id="A2.T5.14.14.3.m1.1.1.2" xref="A2.T5.14.14.3.m1.1.1.2.cmml">a</mi><mo mathsize="90%" id="A2.T5.14.14.3.m1.1.1.1" xref="A2.T5.14.14.3.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A2.T5.14.14.3.m1.1b"><apply id="A2.T5.14.14.3.m1.1.1.cmml" xref="A2.T5.14.14.3.m1.1.1"><ci id="A2.T5.14.14.3.m1.1.1.1.cmml" xref="A2.T5.14.14.3.m1.1.1.1">^</ci><ci id="A2.T5.14.14.3.m1.1.1.2.cmml" xref="A2.T5.14.14.3.m1.1.1.2">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.14.14.3.m1.1c">\hat{a}</annotation></semantics></math></td>
<td id="A2.T5.15.15.4" class="ltx_td ltx_align_center ltx_border_r"><math id="A2.T5.15.15.4.m1.3" class="ltx_Math" alttext="\min(a_{1},a_{2})" display="inline"><semantics id="A2.T5.15.15.4.m1.3a"><mrow id="A2.T5.15.15.4.m1.3.3.2" xref="A2.T5.15.15.4.m1.3.3.3.cmml"><mi mathsize="90%" id="A2.T5.15.15.4.m1.1.1" xref="A2.T5.15.15.4.m1.1.1.cmml">min</mi><mo id="A2.T5.15.15.4.m1.3.3.2a" xref="A2.T5.15.15.4.m1.3.3.3.cmml">⁡</mo><mrow id="A2.T5.15.15.4.m1.3.3.2.2" xref="A2.T5.15.15.4.m1.3.3.3.cmml"><mo maxsize="90%" minsize="90%" id="A2.T5.15.15.4.m1.3.3.2.2.3" xref="A2.T5.15.15.4.m1.3.3.3.cmml">(</mo><msub id="A2.T5.15.15.4.m1.2.2.1.1.1" xref="A2.T5.15.15.4.m1.2.2.1.1.1.cmml"><mi mathsize="90%" id="A2.T5.15.15.4.m1.2.2.1.1.1.2" xref="A2.T5.15.15.4.m1.2.2.1.1.1.2.cmml">a</mi><mn mathsize="90%" id="A2.T5.15.15.4.m1.2.2.1.1.1.3" xref="A2.T5.15.15.4.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="A2.T5.15.15.4.m1.3.3.2.2.4" xref="A2.T5.15.15.4.m1.3.3.3.cmml">,</mo><msub id="A2.T5.15.15.4.m1.3.3.2.2.2" xref="A2.T5.15.15.4.m1.3.3.2.2.2.cmml"><mi mathsize="90%" id="A2.T5.15.15.4.m1.3.3.2.2.2.2" xref="A2.T5.15.15.4.m1.3.3.2.2.2.2.cmml">a</mi><mn mathsize="90%" id="A2.T5.15.15.4.m1.3.3.2.2.2.3" xref="A2.T5.15.15.4.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo maxsize="90%" minsize="90%" id="A2.T5.15.15.4.m1.3.3.2.2.5" xref="A2.T5.15.15.4.m1.3.3.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.T5.15.15.4.m1.3b"><apply id="A2.T5.15.15.4.m1.3.3.3.cmml" xref="A2.T5.15.15.4.m1.3.3.2"><min id="A2.T5.15.15.4.m1.1.1.cmml" xref="A2.T5.15.15.4.m1.1.1"></min><apply id="A2.T5.15.15.4.m1.2.2.1.1.1.cmml" xref="A2.T5.15.15.4.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A2.T5.15.15.4.m1.2.2.1.1.1.1.cmml" xref="A2.T5.15.15.4.m1.2.2.1.1.1">subscript</csymbol><ci id="A2.T5.15.15.4.m1.2.2.1.1.1.2.cmml" xref="A2.T5.15.15.4.m1.2.2.1.1.1.2">𝑎</ci><cn type="integer" id="A2.T5.15.15.4.m1.2.2.1.1.1.3.cmml" xref="A2.T5.15.15.4.m1.2.2.1.1.1.3">1</cn></apply><apply id="A2.T5.15.15.4.m1.3.3.2.2.2.cmml" xref="A2.T5.15.15.4.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="A2.T5.15.15.4.m1.3.3.2.2.2.1.cmml" xref="A2.T5.15.15.4.m1.3.3.2.2.2">subscript</csymbol><ci id="A2.T5.15.15.4.m1.3.3.2.2.2.2.cmml" xref="A2.T5.15.15.4.m1.3.3.2.2.2.2">𝑎</ci><cn type="integer" id="A2.T5.15.15.4.m1.3.3.2.2.2.3.cmml" xref="A2.T5.15.15.4.m1.3.3.2.2.2.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.15.15.4.m1.3c">\min(a_{1},a_{2})</annotation></semantics></math></td>
<td id="A2.T5.15.15.6" class="ltx_td ltx_align_center ltx_border_r"><span id="A2.T5.15.15.6.1" class="ltx_text" style="font-size:90%;">(same as StackNMN)</span></td>
</tr>
<tr id="A2.T5.19.19" class="ltx_tr">
<td id="A2.T5.19.19.5" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T5.19.19.5.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">Describe</span></td>
<td id="A2.T5.16.16.1" class="ltx_td ltx_align_center ltx_border_r"><math id="A2.T5.16.16.1.m1.3" class="ltx_Math" alttext="x,c_{t},a" display="inline"><semantics id="A2.T5.16.16.1.m1.3a"><mrow id="A2.T5.16.16.1.m1.3.3.1" xref="A2.T5.16.16.1.m1.3.3.2.cmml"><mi mathsize="90%" id="A2.T5.16.16.1.m1.1.1" xref="A2.T5.16.16.1.m1.1.1.cmml">x</mi><mo mathsize="90%" id="A2.T5.16.16.1.m1.3.3.1.2" xref="A2.T5.16.16.1.m1.3.3.2.cmml">,</mo><msub id="A2.T5.16.16.1.m1.3.3.1.1" xref="A2.T5.16.16.1.m1.3.3.1.1.cmml"><mi mathsize="90%" id="A2.T5.16.16.1.m1.3.3.1.1.2" xref="A2.T5.16.16.1.m1.3.3.1.1.2.cmml">c</mi><mi mathsize="90%" id="A2.T5.16.16.1.m1.3.3.1.1.3" xref="A2.T5.16.16.1.m1.3.3.1.1.3.cmml">t</mi></msub><mo mathsize="90%" id="A2.T5.16.16.1.m1.3.3.1.3" xref="A2.T5.16.16.1.m1.3.3.2.cmml">,</mo><mi mathsize="90%" id="A2.T5.16.16.1.m1.2.2" xref="A2.T5.16.16.1.m1.2.2.cmml">a</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T5.16.16.1.m1.3b"><list id="A2.T5.16.16.1.m1.3.3.2.cmml" xref="A2.T5.16.16.1.m1.3.3.1"><ci id="A2.T5.16.16.1.m1.1.1.cmml" xref="A2.T5.16.16.1.m1.1.1">𝑥</ci><apply id="A2.T5.16.16.1.m1.3.3.1.1.cmml" xref="A2.T5.16.16.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="A2.T5.16.16.1.m1.3.3.1.1.1.cmml" xref="A2.T5.16.16.1.m1.3.3.1.1">subscript</csymbol><ci id="A2.T5.16.16.1.m1.3.3.1.1.2.cmml" xref="A2.T5.16.16.1.m1.3.3.1.1.2">𝑐</ci><ci id="A2.T5.16.16.1.m1.3.3.1.1.3.cmml" xref="A2.T5.16.16.1.m1.3.3.1.1.3">𝑡</ci></apply><ci id="A2.T5.16.16.1.m1.2.2.cmml" xref="A2.T5.16.16.1.m1.2.2">𝑎</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.16.16.1.m1.3c">x,c_{t},a</annotation></semantics></math></td>
<td id="A2.T5.17.17.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A2.T5.17.17.2.m1.1" class="ltx_Math" alttext="z^{(t)}" display="inline"><semantics id="A2.T5.17.17.2.m1.1a"><msup id="A2.T5.17.17.2.m1.1.2" xref="A2.T5.17.17.2.m1.1.2.cmml"><mi mathsize="90%" id="A2.T5.17.17.2.m1.1.2.2" xref="A2.T5.17.17.2.m1.1.2.2.cmml">z</mi><mrow id="A2.T5.17.17.2.m1.1.1.1.3" xref="A2.T5.17.17.2.m1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="A2.T5.17.17.2.m1.1.1.1.3.1" xref="A2.T5.17.17.2.m1.1.2.cmml">(</mo><mi mathsize="90%" id="A2.T5.17.17.2.m1.1.1.1.1" xref="A2.T5.17.17.2.m1.1.1.1.1.cmml">t</mi><mo maxsize="90%" minsize="90%" id="A2.T5.17.17.2.m1.1.1.1.3.2" xref="A2.T5.17.17.2.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="A2.T5.17.17.2.m1.1b"><apply id="A2.T5.17.17.2.m1.1.2.cmml" xref="A2.T5.17.17.2.m1.1.2"><csymbol cd="ambiguous" id="A2.T5.17.17.2.m1.1.2.1.cmml" xref="A2.T5.17.17.2.m1.1.2">superscript</csymbol><ci id="A2.T5.17.17.2.m1.1.2.2.cmml" xref="A2.T5.17.17.2.m1.1.2.2">𝑧</ci><ci id="A2.T5.17.17.2.m1.1.1.1.1.cmml" xref="A2.T5.17.17.2.m1.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.17.17.2.m1.1c">z^{(t)}</annotation></semantics></math></td>
<td id="A2.T5.18.18.3" class="ltx_td ltx_align_center ltx_border_r"><math id="A2.T5.18.18.3.m1.1" class="ltx_Math" alttext="W_{1}^{\top}(W_{2}\sum(a\odot x)\odot W_{3}c_{t})" display="inline"><semantics id="A2.T5.18.18.3.m1.1a"><mrow id="A2.T5.18.18.3.m1.1.1" xref="A2.T5.18.18.3.m1.1.1.cmml"><msubsup id="A2.T5.18.18.3.m1.1.1.3" xref="A2.T5.18.18.3.m1.1.1.3.cmml"><mi mathsize="90%" id="A2.T5.18.18.3.m1.1.1.3.2.2" xref="A2.T5.18.18.3.m1.1.1.3.2.2.cmml">W</mi><mn mathsize="90%" id="A2.T5.18.18.3.m1.1.1.3.2.3" xref="A2.T5.18.18.3.m1.1.1.3.2.3.cmml">1</mn><mo mathsize="90%" id="A2.T5.18.18.3.m1.1.1.3.3" xref="A2.T5.18.18.3.m1.1.1.3.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="A2.T5.18.18.3.m1.1.1.2" xref="A2.T5.18.18.3.m1.1.1.2.cmml">​</mo><mrow id="A2.T5.18.18.3.m1.1.1.1.1" xref="A2.T5.18.18.3.m1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="A2.T5.18.18.3.m1.1.1.1.1.2" xref="A2.T5.18.18.3.m1.1.1.1.1.1.cmml">(</mo><mrow id="A2.T5.18.18.3.m1.1.1.1.1.1" xref="A2.T5.18.18.3.m1.1.1.1.1.1.cmml"><msub id="A2.T5.18.18.3.m1.1.1.1.1.1.3" xref="A2.T5.18.18.3.m1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="A2.T5.18.18.3.m1.1.1.1.1.1.3.2" xref="A2.T5.18.18.3.m1.1.1.1.1.1.3.2.cmml">W</mi><mn mathsize="90%" id="A2.T5.18.18.3.m1.1.1.1.1.1.3.3" xref="A2.T5.18.18.3.m1.1.1.1.1.1.3.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="A2.T5.18.18.3.m1.1.1.1.1.1.2" xref="A2.T5.18.18.3.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="A2.T5.18.18.3.m1.1.1.1.1.1.1" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" rspace="0em" stretchy="true" id="A2.T5.18.18.3.m1.1.1.1.1.1.1.2" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.2.cmml">∑</mo><mrow id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.cmml"><mrow id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">a</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⊙</mo><mi mathsize="90%" id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo maxsize="90%" minsize="90%" rspace="0.055em" id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo mathsize="90%" rspace="0.222em" id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.2" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.2.cmml">⊙</mo><msub id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.3" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.3.2" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.3.2.cmml">W</mi><mn mathsize="90%" id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.3.3" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.3.3.cmml">3</mn></msub></mrow><mo lspace="0em" rspace="0em" id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.2" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.2.cmml">​</mo><msub id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.3" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.3.2" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.3.2.cmml">c</mi><mi mathsize="90%" id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.3.3" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow></mrow></mrow><mo maxsize="90%" minsize="90%" id="A2.T5.18.18.3.m1.1.1.1.1.3" xref="A2.T5.18.18.3.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.T5.18.18.3.m1.1b"><apply id="A2.T5.18.18.3.m1.1.1.cmml" xref="A2.T5.18.18.3.m1.1.1"><times id="A2.T5.18.18.3.m1.1.1.2.cmml" xref="A2.T5.18.18.3.m1.1.1.2"></times><apply id="A2.T5.18.18.3.m1.1.1.3.cmml" xref="A2.T5.18.18.3.m1.1.1.3"><csymbol cd="ambiguous" id="A2.T5.18.18.3.m1.1.1.3.1.cmml" xref="A2.T5.18.18.3.m1.1.1.3">superscript</csymbol><apply id="A2.T5.18.18.3.m1.1.1.3.2.cmml" xref="A2.T5.18.18.3.m1.1.1.3"><csymbol cd="ambiguous" id="A2.T5.18.18.3.m1.1.1.3.2.1.cmml" xref="A2.T5.18.18.3.m1.1.1.3">subscript</csymbol><ci id="A2.T5.18.18.3.m1.1.1.3.2.2.cmml" xref="A2.T5.18.18.3.m1.1.1.3.2.2">𝑊</ci><cn type="integer" id="A2.T5.18.18.3.m1.1.1.3.2.3.cmml" xref="A2.T5.18.18.3.m1.1.1.3.2.3">1</cn></apply><csymbol cd="latexml" id="A2.T5.18.18.3.m1.1.1.3.3.cmml" xref="A2.T5.18.18.3.m1.1.1.3.3">top</csymbol></apply><apply id="A2.T5.18.18.3.m1.1.1.1.1.1.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1"><times id="A2.T5.18.18.3.m1.1.1.1.1.1.2.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.2"></times><apply id="A2.T5.18.18.3.m1.1.1.1.1.1.3.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.T5.18.18.3.m1.1.1.1.1.1.3.1.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.T5.18.18.3.m1.1.1.1.1.1.3.2.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.3.2">𝑊</ci><cn type="integer" id="A2.T5.18.18.3.m1.1.1.1.1.1.3.3.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.3.3">2</cn></apply><apply id="A2.T5.18.18.3.m1.1.1.1.1.1.1.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1"><sum id="A2.T5.18.18.3.m1.1.1.1.1.1.1.2.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.2"></sum><apply id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1"><times id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.2.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.2"></times><apply id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1.1.1">direct-product</csymbol><ci id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝑎</ci><ci id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑥</ci></apply><apply id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.3.2">𝑊</ci><cn type="integer" id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.1.3.3">3</cn></apply></apply><apply id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.3.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.3.1.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.3.2.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.3.2">𝑐</ci><ci id="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.3.3.cmml" xref="A2.T5.18.18.3.m1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.18.18.3.m1.1c">W_{1}^{\top}(W_{2}\sum(a\odot x)\odot W_{3}c_{t})</annotation></semantics></math></td>
<td id="A2.T5.19.19.4" class="ltx_td ltx_align_center ltx_border_r"><math id="A2.T5.19.19.4.m1.1" class="ltx_Math" alttext="\sum a\odot x" display="inline"><semantics id="A2.T5.19.19.4.m1.1a"><mrow id="A2.T5.19.19.4.m1.1.1" xref="A2.T5.19.19.4.m1.1.1.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="A2.T5.19.19.4.m1.1.1.1" xref="A2.T5.19.19.4.m1.1.1.1.cmml">∑</mo><mrow id="A2.T5.19.19.4.m1.1.1.2" xref="A2.T5.19.19.4.m1.1.1.2.cmml"><mi mathsize="90%" id="A2.T5.19.19.4.m1.1.1.2.2" xref="A2.T5.19.19.4.m1.1.1.2.2.cmml">a</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="A2.T5.19.19.4.m1.1.1.2.1" xref="A2.T5.19.19.4.m1.1.1.2.1.cmml">⊙</mo><mi mathsize="90%" id="A2.T5.19.19.4.m1.1.1.2.3" xref="A2.T5.19.19.4.m1.1.1.2.3.cmml">x</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.T5.19.19.4.m1.1b"><apply id="A2.T5.19.19.4.m1.1.1.cmml" xref="A2.T5.19.19.4.m1.1.1"><sum id="A2.T5.19.19.4.m1.1.1.1.cmml" xref="A2.T5.19.19.4.m1.1.1.1"></sum><apply id="A2.T5.19.19.4.m1.1.1.2.cmml" xref="A2.T5.19.19.4.m1.1.1.2"><csymbol cd="latexml" id="A2.T5.19.19.4.m1.1.1.2.1.cmml" xref="A2.T5.19.19.4.m1.1.1.2.1">direct-product</csymbol><ci id="A2.T5.19.19.4.m1.1.1.2.2.cmml" xref="A2.T5.19.19.4.m1.1.1.2.2">𝑎</ci><ci id="A2.T5.19.19.4.m1.1.1.2.3.cmml" xref="A2.T5.19.19.4.m1.1.1.2.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.19.19.4.m1.1c">\sum a\odot x</annotation></semantics></math></td>
</tr>
<tr id="A2.T5.19.21.2" class="ltx_tr">
<td id="A2.T5.19.21.2.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r"><span id="A2.T5.19.21.2.1.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">NoOp</span></td>
<td id="A2.T5.19.21.2.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="A2.T5.19.21.2.2.1" class="ltx_text" style="font-size:90%;">none</span></td>
<td id="A2.T5.19.21.2.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="A2.T5.19.21.2.3.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="A2.T5.19.21.2.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="A2.T5.19.21.2.4.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="A2.T5.19.21.2.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="A2.T5.19.21.2.5.1" class="ltx_text" style="font-size:90%;">-</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 5: </span>Neural modules of StackNMN and XNM. Here <math id="A2.T5.28.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="A2.T5.28.m1.1b"><mi id="A2.T5.28.m1.1.1" xref="A2.T5.28.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A2.T5.28.m1.1c"><ci id="A2.T5.28.m1.1.1.cmml" xref="A2.T5.28.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.28.m1.1d">x</annotation></semantics></math> are the visual features, <math id="A2.T5.29.m2.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="A2.T5.29.m2.1b"><msub id="A2.T5.29.m2.1.1" xref="A2.T5.29.m2.1.1.cmml"><mi id="A2.T5.29.m2.1.1.2" xref="A2.T5.29.m2.1.1.2.cmml">c</mi><mi id="A2.T5.29.m2.1.1.3" xref="A2.T5.29.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T5.29.m2.1c"><apply id="A2.T5.29.m2.1.1.cmml" xref="A2.T5.29.m2.1.1"><csymbol cd="ambiguous" id="A2.T5.29.m2.1.1.1.cmml" xref="A2.T5.29.m2.1.1">subscript</csymbol><ci id="A2.T5.29.m2.1.1.2.cmml" xref="A2.T5.29.m2.1.1.2">𝑐</ci><ci id="A2.T5.29.m2.1.1.3.cmml" xref="A2.T5.29.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.29.m2.1d">c_{t}</annotation></semantics></math> is the textual parameter, each <math id="A2.T5.30.m3.1" class="ltx_Math" alttext="a" display="inline"><semantics id="A2.T5.30.m3.1b"><mi id="A2.T5.30.m3.1.1" xref="A2.T5.30.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="A2.T5.30.m3.1c"><ci id="A2.T5.30.m3.1.1.cmml" xref="A2.T5.30.m3.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.30.m3.1d">a</annotation></semantics></math> (and <math id="A2.T5.31.m4.1" class="ltx_Math" alttext="\hat{a}" display="inline"><semantics id="A2.T5.31.m4.1b"><mover accent="true" id="A2.T5.31.m4.1.1" xref="A2.T5.31.m4.1.1.cmml"><mi id="A2.T5.31.m4.1.1.2" xref="A2.T5.31.m4.1.1.2.cmml">a</mi><mo id="A2.T5.31.m4.1.1.1" xref="A2.T5.31.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A2.T5.31.m4.1c"><apply id="A2.T5.31.m4.1.1.cmml" xref="A2.T5.31.m4.1.1"><ci id="A2.T5.31.m4.1.1.1.cmml" xref="A2.T5.31.m4.1.1.1">^</ci><ci id="A2.T5.31.m4.1.1.2.cmml" xref="A2.T5.31.m4.1.1.2">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.31.m4.1d">\hat{a}</annotation></semantics></math>) is an attention map over the image regions, <math id="A2.T5.32.m5.1" class="ltx_Math" alttext="z^{(t)}" display="inline"><semantics id="A2.T5.32.m5.1b"><msup id="A2.T5.32.m5.1.2" xref="A2.T5.32.m5.1.2.cmml"><mi id="A2.T5.32.m5.1.2.2" xref="A2.T5.32.m5.1.2.2.cmml">z</mi><mrow id="A2.T5.32.m5.1.1.1.3" xref="A2.T5.32.m5.1.2.cmml"><mo stretchy="false" id="A2.T5.32.m5.1.1.1.3.1" xref="A2.T5.32.m5.1.2.cmml">(</mo><mi id="A2.T5.32.m5.1.1.1.1" xref="A2.T5.32.m5.1.1.1.1.cmml">t</mi><mo stretchy="false" id="A2.T5.32.m5.1.1.1.3.2" xref="A2.T5.32.m5.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="A2.T5.32.m5.1c"><apply id="A2.T5.32.m5.1.2.cmml" xref="A2.T5.32.m5.1.2"><csymbol cd="ambiguous" id="A2.T5.32.m5.1.2.1.cmml" xref="A2.T5.32.m5.1.2">superscript</csymbol><ci id="A2.T5.32.m5.1.2.2.cmml" xref="A2.T5.32.m5.1.2.2">𝑧</ci><ci id="A2.T5.32.m5.1.1.1.1.cmml" xref="A2.T5.32.m5.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.32.m5.1d">z^{(t)}</annotation></semantics></math> is used to compute the final answer prediction, and all <math id="A2.T5.33.m6.1" class="ltx_Math" alttext="W" display="inline"><semantics id="A2.T5.33.m6.1b"><mi id="A2.T5.33.m6.1.1" xref="A2.T5.33.m6.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="A2.T5.33.m6.1c"><ci id="A2.T5.33.m6.1.1.cmml" xref="A2.T5.33.m6.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.33.m6.1d">W</annotation></semantics></math> are learned parameters. For XNM, <math id="A2.T5.34.m7.1" class="ltx_Math" alttext="R" display="inline"><semantics id="A2.T5.34.m7.1b"><mi id="A2.T5.34.m7.1.1" xref="A2.T5.34.m7.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="A2.T5.34.m7.1c"><ci id="A2.T5.34.m7.1.1.cmml" xref="A2.T5.34.m7.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.34.m7.1d">R</annotation></semantics></math> is the set of edge features and <math id="A2.T5.35.m8.1" class="ltx_Math" alttext="M" display="inline"><semantics id="A2.T5.35.m8.1b"><mi id="A2.T5.35.m8.1.1" xref="A2.T5.35.m8.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="A2.T5.35.m8.1c"><ci id="A2.T5.35.m8.1.1.cmml" xref="A2.T5.35.m8.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.35.m8.1d">M</annotation></semantics></math> is the adjacency matrix of the scene graph.</figcaption>
</figure>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Additional Dataset Information</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.5" class="ltx_p">To measure the model’s robustness against question variations, it requires
the availability of answer annotations during evaluation. Since the testing data
of VQA v2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> does not have public groundtruth information, we use the validation split
of VQA v2 as the testing set for all models. For training, we use the
training data of VQA v2, which contains <math id="A3.p1.1.m1.2" class="ltx_Math" alttext="443,757" display="inline"><semantics id="A3.p1.1.m1.2a"><mrow id="A3.p1.1.m1.2.3.2" xref="A3.p1.1.m1.2.3.1.cmml"><mn id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml">443</mn><mo id="A3.p1.1.m1.2.3.2.1" xref="A3.p1.1.m1.2.3.1.cmml">,</mo><mn id="A3.p1.1.m1.2.2" xref="A3.p1.1.m1.2.2.cmml">757</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.2b"><list id="A3.p1.1.m1.2.3.1.cmml" xref="A3.p1.1.m1.2.3.2"><cn type="integer" id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1">443</cn><cn type="integer" id="A3.p1.1.m1.2.2.cmml" xref="A3.p1.1.m1.2.2">757</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.2c">443,757</annotation></semantics></math> questions for <math id="A3.p1.2.m2.2" class="ltx_Math" alttext="82,783" display="inline"><semantics id="A3.p1.2.m2.2a"><mrow id="A3.p1.2.m2.2.3.2" xref="A3.p1.2.m2.2.3.1.cmml"><mn id="A3.p1.2.m2.1.1" xref="A3.p1.2.m2.1.1.cmml">82</mn><mo id="A3.p1.2.m2.2.3.2.1" xref="A3.p1.2.m2.2.3.1.cmml">,</mo><mn id="A3.p1.2.m2.2.2" xref="A3.p1.2.m2.2.2.cmml">783</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.2.m2.2b"><list id="A3.p1.2.m2.2.3.1.cmml" xref="A3.p1.2.m2.2.3.2"><cn type="integer" id="A3.p1.2.m2.1.1.cmml" xref="A3.p1.2.m2.1.1">82</cn><cn type="integer" id="A3.p1.2.m2.2.2.cmml" xref="A3.p1.2.m2.2.2">783</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.2.m2.2c">82,783</annotation></semantics></math> images; for testing, we use the validation split of VQA v2 (<math id="A3.p1.3.m3.2" class="ltx_Math" alttext="214,354" display="inline"><semantics id="A3.p1.3.m3.2a"><mrow id="A3.p1.3.m3.2.3.2" xref="A3.p1.3.m3.2.3.1.cmml"><mn id="A3.p1.3.m3.1.1" xref="A3.p1.3.m3.1.1.cmml">214</mn><mo id="A3.p1.3.m3.2.3.2.1" xref="A3.p1.3.m3.2.3.1.cmml">,</mo><mn id="A3.p1.3.m3.2.2" xref="A3.p1.3.m3.2.2.cmml">354</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.3.m3.2b"><list id="A3.p1.3.m3.2.3.1.cmml" xref="A3.p1.3.m3.2.3.2"><cn type="integer" id="A3.p1.3.m3.1.1.cmml" xref="A3.p1.3.m3.1.1">214</cn><cn type="integer" id="A3.p1.3.m3.2.2.cmml" xref="A3.p1.3.m3.2.2">354</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.3.m3.2c">214,354</annotation></semantics></math> questions for <math id="A3.p1.4.m4.2" class="ltx_Math" alttext="40,504" display="inline"><semantics id="A3.p1.4.m4.2a"><mrow id="A3.p1.4.m4.2.3.2" xref="A3.p1.4.m4.2.3.1.cmml"><mn id="A3.p1.4.m4.1.1" xref="A3.p1.4.m4.1.1.cmml">40</mn><mo id="A3.p1.4.m4.2.3.2.1" xref="A3.p1.4.m4.2.3.1.cmml">,</mo><mn id="A3.p1.4.m4.2.2" xref="A3.p1.4.m4.2.2.cmml">504</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.4.m4.2b"><list id="A3.p1.4.m4.2.3.1.cmml" xref="A3.p1.4.m4.2.3.2"><cn type="integer" id="A3.p1.4.m4.1.1.cmml" xref="A3.p1.4.m4.1.1">40</cn><cn type="integer" id="A3.p1.4.m4.2.2.cmml" xref="A3.p1.4.m4.2.2">504</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.4.m4.2c">40,504</annotation></semantics></math> images) and VQA P2 (<math id="A3.p1.5.m5.2" class="ltx_Math" alttext="36,175" display="inline"><semantics id="A3.p1.5.m5.2a"><mrow id="A3.p1.5.m5.2.3.2" xref="A3.p1.5.m5.2.3.1.cmml"><mn id="A3.p1.5.m5.1.1" xref="A3.p1.5.m5.1.1.cmml">36</mn><mo id="A3.p1.5.m5.2.3.2.1" xref="A3.p1.5.m5.2.3.1.cmml">,</mo><mn id="A3.p1.5.m5.2.2" xref="A3.p1.5.m5.2.2.cmml">175</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.5.m5.2b"><list id="A3.p1.5.m5.2.3.1.cmml" xref="A3.p1.5.m5.2.3.2"><cn type="integer" id="A3.p1.5.m5.1.1.cmml" xref="A3.p1.5.m5.1.1">36</cn><cn type="integer" id="A3.p1.5.m5.2.2.cmml" xref="A3.p1.5.m5.2.2">175</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.5.m5.2c">36,175</annotation></semantics></math> question-answer pairs)</p>
</div>
<div id="A3.p2" class="ltx_para">
<p id="A3.p2.4" class="ltx_p">In <span id="A3.p2.4.1" class="ltx_ERROR undefined">\secref</span>subsec:rephrasings, we evaluate our framework on VQA-Rephrasings <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>. VQA-Rephrasings is a human-written paraphrased dataset that spans the <math id="A3.p2.1.m1.2" class="ltx_Math" alttext="40,504" display="inline"><semantics id="A3.p2.1.m1.2a"><mrow id="A3.p2.1.m1.2.3.2" xref="A3.p2.1.m1.2.3.1.cmml"><mn id="A3.p2.1.m1.1.1" xref="A3.p2.1.m1.1.1.cmml">40</mn><mo id="A3.p2.1.m1.2.3.2.1" xref="A3.p2.1.m1.2.3.1.cmml">,</mo><mn id="A3.p2.1.m1.2.2" xref="A3.p2.1.m1.2.2.cmml">504</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.1.m1.2b"><list id="A3.p2.1.m1.2.3.1.cmml" xref="A3.p2.1.m1.2.3.2"><cn type="integer" id="A3.p2.1.m1.1.1.cmml" xref="A3.p2.1.m1.1.1">40</cn><cn type="integer" id="A3.p2.1.m1.2.2.cmml" xref="A3.p2.1.m1.2.2">504</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.1.m1.2c">40,504</annotation></semantics></math> validation images of VQA v2, where each image has a corresponding question group that contains <math id="A3.p2.2.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A3.p2.2.m2.1a"><mn id="A3.p2.2.m2.1.1" xref="A3.p2.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A3.p2.2.m2.1b"><cn type="integer" id="A3.p2.2.m2.1.1.cmml" xref="A3.p2.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.2.m2.1c">1</annotation></semantics></math> original question from the VQA v2 validation set and <math id="A3.p2.3.m3.1" class="ltx_Math" alttext="3" display="inline"><semantics id="A3.p2.3.m3.1a"><mn id="A3.p2.3.m3.1.1" xref="A3.p2.3.m3.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="A3.p2.3.m3.1b"><cn type="integer" id="A3.p2.3.m3.1.1.cmml" xref="A3.p2.3.m3.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.3.m3.1c">3</annotation></semantics></math> rephrasings of that questions, for a total of <math id="A3.p2.4.m4.2" class="ltx_Math" alttext="162,016" display="inline"><semantics id="A3.p2.4.m4.2a"><mrow id="A3.p2.4.m4.2.3.2" xref="A3.p2.4.m4.2.3.1.cmml"><mn id="A3.p2.4.m4.1.1" xref="A3.p2.4.m4.1.1.cmml">162</mn><mo id="A3.p2.4.m4.2.3.2.1" xref="A3.p2.4.m4.2.3.1.cmml">,</mo><mn id="A3.p2.4.m4.2.2" xref="A3.p2.4.m4.2.2.cmml">016</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.4.m4.2b"><list id="A3.p2.4.m4.2.3.1.cmml" xref="A3.p2.4.m4.2.3.2"><cn type="integer" id="A3.p2.4.m4.1.1.cmml" xref="A3.p2.4.m4.1.1">162</cn><cn type="integer" id="A3.p2.4.m4.2.2.cmml" xref="A3.p2.4.m4.2.2">016</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.4.m4.2c">162,016</annotation></semantics></math> questions.</p>
</div>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Model Details</h2>

<section id="A4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Controller-Module Architecture</h3>

<div id="A4.SS1.p1" class="ltx_para">
<p id="A4.SS1.p1.1" class="ltx_p">Our proposed training framework is applicable to the any controller-module framework <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>.
Next, we provide details of the components of our backbone architecture, which is comprised of input encoders, a controller,
and a set of functional modules.</p>
</div>
<div id="A4.SS1.p2" class="ltx_para ltx_noindent">
<p id="A4.SS1.p2.4" class="ltx_p"><span id="A4.SS1.p2.4.1" class="ltx_text ltx_font_bold">Input encoders.</span>
The visual features, <math id="A4.SS1.p2.1.m1.1" class="ltx_Math" alttext="x\in\mathbb{R}^{d_{v}\times K}" display="inline"><semantics id="A4.SS1.p2.1.m1.1a"><mrow id="A4.SS1.p2.1.m1.1.1" xref="A4.SS1.p2.1.m1.1.1.cmml"><mi id="A4.SS1.p2.1.m1.1.1.2" xref="A4.SS1.p2.1.m1.1.1.2.cmml">x</mi><mo id="A4.SS1.p2.1.m1.1.1.1" xref="A4.SS1.p2.1.m1.1.1.1.cmml">∈</mo><msup id="A4.SS1.p2.1.m1.1.1.3" xref="A4.SS1.p2.1.m1.1.1.3.cmml"><mi id="A4.SS1.p2.1.m1.1.1.3.2" xref="A4.SS1.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="A4.SS1.p2.1.m1.1.1.3.3" xref="A4.SS1.p2.1.m1.1.1.3.3.cmml"><msub id="A4.SS1.p2.1.m1.1.1.3.3.2" xref="A4.SS1.p2.1.m1.1.1.3.3.2.cmml"><mi id="A4.SS1.p2.1.m1.1.1.3.3.2.2" xref="A4.SS1.p2.1.m1.1.1.3.3.2.2.cmml">d</mi><mi id="A4.SS1.p2.1.m1.1.1.3.3.2.3" xref="A4.SS1.p2.1.m1.1.1.3.3.2.3.cmml">v</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A4.SS1.p2.1.m1.1.1.3.3.1" xref="A4.SS1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="A4.SS1.p2.1.m1.1.1.3.3.3" xref="A4.SS1.p2.1.m1.1.1.3.3.3.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.1.m1.1b"><apply id="A4.SS1.p2.1.m1.1.1.cmml" xref="A4.SS1.p2.1.m1.1.1"><in id="A4.SS1.p2.1.m1.1.1.1.cmml" xref="A4.SS1.p2.1.m1.1.1.1"></in><ci id="A4.SS1.p2.1.m1.1.1.2.cmml" xref="A4.SS1.p2.1.m1.1.1.2">𝑥</ci><apply id="A4.SS1.p2.1.m1.1.1.3.cmml" xref="A4.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="A4.SS1.p2.1.m1.1.1.3.1.cmml" xref="A4.SS1.p2.1.m1.1.1.3">superscript</csymbol><ci id="A4.SS1.p2.1.m1.1.1.3.2.cmml" xref="A4.SS1.p2.1.m1.1.1.3.2">ℝ</ci><apply id="A4.SS1.p2.1.m1.1.1.3.3.cmml" xref="A4.SS1.p2.1.m1.1.1.3.3"><times id="A4.SS1.p2.1.m1.1.1.3.3.1.cmml" xref="A4.SS1.p2.1.m1.1.1.3.3.1"></times><apply id="A4.SS1.p2.1.m1.1.1.3.3.2.cmml" xref="A4.SS1.p2.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="A4.SS1.p2.1.m1.1.1.3.3.2.1.cmml" xref="A4.SS1.p2.1.m1.1.1.3.3.2">subscript</csymbol><ci id="A4.SS1.p2.1.m1.1.1.3.3.2.2.cmml" xref="A4.SS1.p2.1.m1.1.1.3.3.2.2">𝑑</ci><ci id="A4.SS1.p2.1.m1.1.1.3.3.2.3.cmml" xref="A4.SS1.p2.1.m1.1.1.3.3.2.3">𝑣</ci></apply><ci id="A4.SS1.p2.1.m1.1.1.3.3.3.cmml" xref="A4.SS1.p2.1.m1.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.1.m1.1c">x\in\mathbb{R}^{d_{v}\times K}</annotation></semantics></math>, represent <math id="A4.SS1.p2.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A4.SS1.p2.2.m2.1a"><mi id="A4.SS1.p2.2.m2.1.1" xref="A4.SS1.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.2.m2.1b"><ci id="A4.SS1.p2.2.m2.1.1.cmml" xref="A4.SS1.p2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.2.m2.1c">K</annotation></semantics></math> different regions of the image, which may be grid features from a convolutional layer of a CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, object features from an object detector <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, or a scene graph <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>.
Similarly, representations of question tokens, <math id="A4.SS1.p2.3.m3.3" class="ltx_Math" alttext="(h_{1},...,h_{N})" display="inline"><semantics id="A4.SS1.p2.3.m3.3a"><mrow id="A4.SS1.p2.3.m3.3.3.2" xref="A4.SS1.p2.3.m3.3.3.3.cmml"><mo stretchy="false" id="A4.SS1.p2.3.m3.3.3.2.3" xref="A4.SS1.p2.3.m3.3.3.3.cmml">(</mo><msub id="A4.SS1.p2.3.m3.2.2.1.1" xref="A4.SS1.p2.3.m3.2.2.1.1.cmml"><mi id="A4.SS1.p2.3.m3.2.2.1.1.2" xref="A4.SS1.p2.3.m3.2.2.1.1.2.cmml">h</mi><mn id="A4.SS1.p2.3.m3.2.2.1.1.3" xref="A4.SS1.p2.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="A4.SS1.p2.3.m3.3.3.2.4" xref="A4.SS1.p2.3.m3.3.3.3.cmml">,</mo><mi mathvariant="normal" id="A4.SS1.p2.3.m3.1.1" xref="A4.SS1.p2.3.m3.1.1.cmml">…</mi><mo id="A4.SS1.p2.3.m3.3.3.2.5" xref="A4.SS1.p2.3.m3.3.3.3.cmml">,</mo><msub id="A4.SS1.p2.3.m3.3.3.2.2" xref="A4.SS1.p2.3.m3.3.3.2.2.cmml"><mi id="A4.SS1.p2.3.m3.3.3.2.2.2" xref="A4.SS1.p2.3.m3.3.3.2.2.2.cmml">h</mi><mi id="A4.SS1.p2.3.m3.3.3.2.2.3" xref="A4.SS1.p2.3.m3.3.3.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="A4.SS1.p2.3.m3.3.3.2.6" xref="A4.SS1.p2.3.m3.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.3.m3.3b"><vector id="A4.SS1.p2.3.m3.3.3.3.cmml" xref="A4.SS1.p2.3.m3.3.3.2"><apply id="A4.SS1.p2.3.m3.2.2.1.1.cmml" xref="A4.SS1.p2.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="A4.SS1.p2.3.m3.2.2.1.1.1.cmml" xref="A4.SS1.p2.3.m3.2.2.1.1">subscript</csymbol><ci id="A4.SS1.p2.3.m3.2.2.1.1.2.cmml" xref="A4.SS1.p2.3.m3.2.2.1.1.2">ℎ</ci><cn type="integer" id="A4.SS1.p2.3.m3.2.2.1.1.3.cmml" xref="A4.SS1.p2.3.m3.2.2.1.1.3">1</cn></apply><ci id="A4.SS1.p2.3.m3.1.1.cmml" xref="A4.SS1.p2.3.m3.1.1">…</ci><apply id="A4.SS1.p2.3.m3.3.3.2.2.cmml" xref="A4.SS1.p2.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="A4.SS1.p2.3.m3.3.3.2.2.1.cmml" xref="A4.SS1.p2.3.m3.3.3.2.2">subscript</csymbol><ci id="A4.SS1.p2.3.m3.3.3.2.2.2.cmml" xref="A4.SS1.p2.3.m3.3.3.2.2.2">ℎ</ci><ci id="A4.SS1.p2.3.m3.3.3.2.2.3.cmml" xref="A4.SS1.p2.3.m3.3.3.2.2.3">𝑁</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.3.m3.3c">(h_{1},...,h_{N})</annotation></semantics></math>, or the entire question, <math id="A4.SS1.p2.4.m4.1" class="ltx_Math" alttext="q" display="inline"><semantics id="A4.SS1.p2.4.m4.1a"><mi id="A4.SS1.p2.4.m4.1.1" xref="A4.SS1.p2.4.m4.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.4.m4.1b"><ci id="A4.SS1.p2.4.m4.1.1.cmml" xref="A4.SS1.p2.4.m4.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.4.m4.1c">q</annotation></semantics></math>, may be obtained via embeddings <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>, an encoder <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, or a pre-trained language model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.</p>
</div>
<div id="A4.SS1.p3" class="ltx_para ltx_noindent">
<p id="A4.SS1.p3.9" class="ltx_p"><span id="A4.SS1.p3.9.1" class="ltx_text ltx_font_bold">Controller.</span> At each reasoning step, <math id="A4.SS1.p3.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="A4.SS1.p3.1.m1.1a"><mi id="A4.SS1.p3.1.m1.1.1" xref="A4.SS1.p3.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A4.SS1.p3.1.m1.1b"><ci id="A4.SS1.p3.1.m1.1.1.cmml" xref="A4.SS1.p3.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p3.1.m1.1c">t</annotation></semantics></math>, the controller reads the question and computes <math id="A4.SS1.p3.2.m2.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="A4.SS1.p3.2.m2.1a"><msub id="A4.SS1.p3.2.m2.1.1" xref="A4.SS1.p3.2.m2.1.1.cmml"><mi id="A4.SS1.p3.2.m2.1.1.2" xref="A4.SS1.p3.2.m2.1.1.2.cmml">c</mi><mi id="A4.SS1.p3.2.m2.1.1.3" xref="A4.SS1.p3.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p3.2.m2.1b"><apply id="A4.SS1.p3.2.m2.1.1.cmml" xref="A4.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A4.SS1.p3.2.m2.1.1.1.cmml" xref="A4.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="A4.SS1.p3.2.m2.1.1.2.cmml" xref="A4.SS1.p3.2.m2.1.1.2">𝑐</ci><ci id="A4.SS1.p3.2.m2.1.1.3.cmml" xref="A4.SS1.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p3.2.m2.1c">c_{t}</annotation></semantics></math> and <math id="A4.SS1.p3.3.m3.1" class="ltx_Math" alttext="w^{(t)}" display="inline"><semantics id="A4.SS1.p3.3.m3.1a"><msup id="A4.SS1.p3.3.m3.1.2" xref="A4.SS1.p3.3.m3.1.2.cmml"><mi id="A4.SS1.p3.3.m3.1.2.2" xref="A4.SS1.p3.3.m3.1.2.2.cmml">w</mi><mrow id="A4.SS1.p3.3.m3.1.1.1.3" xref="A4.SS1.p3.3.m3.1.2.cmml"><mo stretchy="false" id="A4.SS1.p3.3.m3.1.1.1.3.1" xref="A4.SS1.p3.3.m3.1.2.cmml">(</mo><mi id="A4.SS1.p3.3.m3.1.1.1.1" xref="A4.SS1.p3.3.m3.1.1.1.1.cmml">t</mi><mo stretchy="false" id="A4.SS1.p3.3.m3.1.1.1.3.2" xref="A4.SS1.p3.3.m3.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="A4.SS1.p3.3.m3.1b"><apply id="A4.SS1.p3.3.m3.1.2.cmml" xref="A4.SS1.p3.3.m3.1.2"><csymbol cd="ambiguous" id="A4.SS1.p3.3.m3.1.2.1.cmml" xref="A4.SS1.p3.3.m3.1.2">superscript</csymbol><ci id="A4.SS1.p3.3.m3.1.2.2.cmml" xref="A4.SS1.p3.3.m3.1.2.2">𝑤</ci><ci id="A4.SS1.p3.3.m3.1.1.1.1.cmml" xref="A4.SS1.p3.3.m3.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p3.3.m3.1c">w^{(t)}</annotation></semantics></math>.
<math id="A4.SS1.p3.4.m4.4" class="ltx_Math" alttext="w^{(t)}=\{w_{m}^{(t)}\}_{m=1}^{|\mathcal{M}|}" display="inline"><semantics id="A4.SS1.p3.4.m4.4a"><mrow id="A4.SS1.p3.4.m4.4.4" xref="A4.SS1.p3.4.m4.4.4.cmml"><msup id="A4.SS1.p3.4.m4.4.4.3" xref="A4.SS1.p3.4.m4.4.4.3.cmml"><mi id="A4.SS1.p3.4.m4.4.4.3.2" xref="A4.SS1.p3.4.m4.4.4.3.2.cmml">w</mi><mrow id="A4.SS1.p3.4.m4.1.1.1.3" xref="A4.SS1.p3.4.m4.4.4.3.cmml"><mo stretchy="false" id="A4.SS1.p3.4.m4.1.1.1.3.1" xref="A4.SS1.p3.4.m4.4.4.3.cmml">(</mo><mi id="A4.SS1.p3.4.m4.1.1.1.1" xref="A4.SS1.p3.4.m4.1.1.1.1.cmml">t</mi><mo stretchy="false" id="A4.SS1.p3.4.m4.1.1.1.3.2" xref="A4.SS1.p3.4.m4.4.4.3.cmml">)</mo></mrow></msup><mo id="A4.SS1.p3.4.m4.4.4.2" xref="A4.SS1.p3.4.m4.4.4.2.cmml">=</mo><msubsup id="A4.SS1.p3.4.m4.4.4.1" xref="A4.SS1.p3.4.m4.4.4.1.cmml"><mrow id="A4.SS1.p3.4.m4.4.4.1.1.1.1" xref="A4.SS1.p3.4.m4.4.4.1.1.1.2.cmml"><mo stretchy="false" id="A4.SS1.p3.4.m4.4.4.1.1.1.1.2" xref="A4.SS1.p3.4.m4.4.4.1.1.1.2.cmml">{</mo><msubsup id="A4.SS1.p3.4.m4.4.4.1.1.1.1.1" xref="A4.SS1.p3.4.m4.4.4.1.1.1.1.1.cmml"><mi id="A4.SS1.p3.4.m4.4.4.1.1.1.1.1.2.2" xref="A4.SS1.p3.4.m4.4.4.1.1.1.1.1.2.2.cmml">w</mi><mi id="A4.SS1.p3.4.m4.4.4.1.1.1.1.1.2.3" xref="A4.SS1.p3.4.m4.4.4.1.1.1.1.1.2.3.cmml">m</mi><mrow id="A4.SS1.p3.4.m4.2.2.1.3" xref="A4.SS1.p3.4.m4.4.4.1.1.1.1.1.cmml"><mo stretchy="false" id="A4.SS1.p3.4.m4.2.2.1.3.1" xref="A4.SS1.p3.4.m4.4.4.1.1.1.1.1.cmml">(</mo><mi id="A4.SS1.p3.4.m4.2.2.1.1" xref="A4.SS1.p3.4.m4.2.2.1.1.cmml">t</mi><mo stretchy="false" id="A4.SS1.p3.4.m4.2.2.1.3.2" xref="A4.SS1.p3.4.m4.4.4.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="A4.SS1.p3.4.m4.4.4.1.1.1.1.3" xref="A4.SS1.p3.4.m4.4.4.1.1.1.2.cmml">}</mo></mrow><mrow id="A4.SS1.p3.4.m4.4.4.1.1.3" xref="A4.SS1.p3.4.m4.4.4.1.1.3.cmml"><mi id="A4.SS1.p3.4.m4.4.4.1.1.3.2" xref="A4.SS1.p3.4.m4.4.4.1.1.3.2.cmml">m</mi><mo id="A4.SS1.p3.4.m4.4.4.1.1.3.1" xref="A4.SS1.p3.4.m4.4.4.1.1.3.1.cmml">=</mo><mn id="A4.SS1.p3.4.m4.4.4.1.1.3.3" xref="A4.SS1.p3.4.m4.4.4.1.1.3.3.cmml">1</mn></mrow><mrow id="A4.SS1.p3.4.m4.3.3.1.3" xref="A4.SS1.p3.4.m4.3.3.1.2.cmml"><mo stretchy="false" id="A4.SS1.p3.4.m4.3.3.1.3.1" xref="A4.SS1.p3.4.m4.3.3.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="A4.SS1.p3.4.m4.3.3.1.1" xref="A4.SS1.p3.4.m4.3.3.1.1.cmml">ℳ</mi><mo stretchy="false" id="A4.SS1.p3.4.m4.3.3.1.3.2" xref="A4.SS1.p3.4.m4.3.3.1.2.1.cmml">|</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p3.4.m4.4b"><apply id="A4.SS1.p3.4.m4.4.4.cmml" xref="A4.SS1.p3.4.m4.4.4"><eq id="A4.SS1.p3.4.m4.4.4.2.cmml" xref="A4.SS1.p3.4.m4.4.4.2"></eq><apply id="A4.SS1.p3.4.m4.4.4.3.cmml" xref="A4.SS1.p3.4.m4.4.4.3"><csymbol cd="ambiguous" id="A4.SS1.p3.4.m4.4.4.3.1.cmml" xref="A4.SS1.p3.4.m4.4.4.3">superscript</csymbol><ci id="A4.SS1.p3.4.m4.4.4.3.2.cmml" xref="A4.SS1.p3.4.m4.4.4.3.2">𝑤</ci><ci id="A4.SS1.p3.4.m4.1.1.1.1.cmml" xref="A4.SS1.p3.4.m4.1.1.1.1">𝑡</ci></apply><apply id="A4.SS1.p3.4.m4.4.4.1.cmml" xref="A4.SS1.p3.4.m4.4.4.1"><csymbol cd="ambiguous" id="A4.SS1.p3.4.m4.4.4.1.2.cmml" xref="A4.SS1.p3.4.m4.4.4.1">superscript</csymbol><apply id="A4.SS1.p3.4.m4.4.4.1.1.cmml" xref="A4.SS1.p3.4.m4.4.4.1"><csymbol cd="ambiguous" id="A4.SS1.p3.4.m4.4.4.1.1.2.cmml" xref="A4.SS1.p3.4.m4.4.4.1">subscript</csymbol><set id="A4.SS1.p3.4.m4.4.4.1.1.1.2.cmml" xref="A4.SS1.p3.4.m4.4.4.1.1.1.1"><apply id="A4.SS1.p3.4.m4.4.4.1.1.1.1.1.cmml" xref="A4.SS1.p3.4.m4.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.SS1.p3.4.m4.4.4.1.1.1.1.1.1.cmml" xref="A4.SS1.p3.4.m4.4.4.1.1.1.1.1">superscript</csymbol><apply id="A4.SS1.p3.4.m4.4.4.1.1.1.1.1.2.cmml" xref="A4.SS1.p3.4.m4.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.SS1.p3.4.m4.4.4.1.1.1.1.1.2.1.cmml" xref="A4.SS1.p3.4.m4.4.4.1.1.1.1.1">subscript</csymbol><ci id="A4.SS1.p3.4.m4.4.4.1.1.1.1.1.2.2.cmml" xref="A4.SS1.p3.4.m4.4.4.1.1.1.1.1.2.2">𝑤</ci><ci id="A4.SS1.p3.4.m4.4.4.1.1.1.1.1.2.3.cmml" xref="A4.SS1.p3.4.m4.4.4.1.1.1.1.1.2.3">𝑚</ci></apply><ci id="A4.SS1.p3.4.m4.2.2.1.1.cmml" xref="A4.SS1.p3.4.m4.2.2.1.1">𝑡</ci></apply></set><apply id="A4.SS1.p3.4.m4.4.4.1.1.3.cmml" xref="A4.SS1.p3.4.m4.4.4.1.1.3"><eq id="A4.SS1.p3.4.m4.4.4.1.1.3.1.cmml" xref="A4.SS1.p3.4.m4.4.4.1.1.3.1"></eq><ci id="A4.SS1.p3.4.m4.4.4.1.1.3.2.cmml" xref="A4.SS1.p3.4.m4.4.4.1.1.3.2">𝑚</ci><cn type="integer" id="A4.SS1.p3.4.m4.4.4.1.1.3.3.cmml" xref="A4.SS1.p3.4.m4.4.4.1.1.3.3">1</cn></apply></apply><apply id="A4.SS1.p3.4.m4.3.3.1.2.cmml" xref="A4.SS1.p3.4.m4.3.3.1.3"><abs id="A4.SS1.p3.4.m4.3.3.1.2.1.cmml" xref="A4.SS1.p3.4.m4.3.3.1.3.1"></abs><ci id="A4.SS1.p3.4.m4.3.3.1.1.cmml" xref="A4.SS1.p3.4.m4.3.3.1.1">ℳ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p3.4.m4.4c">w^{(t)}=\{w_{m}^{(t)}\}_{m=1}^{|\mathcal{M}|}</annotation></semantics></math> is a set of module weights that are utilized by the network to perform a soft selection of modules at step <math id="A4.SS1.p3.5.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="A4.SS1.p3.5.m5.1a"><mi id="A4.SS1.p3.5.m5.1.1" xref="A4.SS1.p3.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A4.SS1.p3.5.m5.1b"><ci id="A4.SS1.p3.5.m5.1.1.cmml" xref="A4.SS1.p3.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p3.5.m5.1c">t</annotation></semantics></math>.
These module weights are computed via a soft attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, forming a distribution over the modules, which is used to compute the output at step <math id="A4.SS1.p3.6.m6.1" class="ltx_Math" alttext="t" display="inline"><semantics id="A4.SS1.p3.6.m6.1a"><mi id="A4.SS1.p3.6.m6.1.1" xref="A4.SS1.p3.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A4.SS1.p3.6.m6.1b"><ci id="A4.SS1.p3.6.m6.1.1.cmml" xref="A4.SS1.p3.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p3.6.m6.1c">t</annotation></semantics></math> by taking the weighted average over each module’s output.
The vector <math id="A4.SS1.p3.7.m7.1" class="ltx_Math" alttext="c_{t}\in\mathbb{R}^{d}" display="inline"><semantics id="A4.SS1.p3.7.m7.1a"><mrow id="A4.SS1.p3.7.m7.1.1" xref="A4.SS1.p3.7.m7.1.1.cmml"><msub id="A4.SS1.p3.7.m7.1.1.2" xref="A4.SS1.p3.7.m7.1.1.2.cmml"><mi id="A4.SS1.p3.7.m7.1.1.2.2" xref="A4.SS1.p3.7.m7.1.1.2.2.cmml">c</mi><mi id="A4.SS1.p3.7.m7.1.1.2.3" xref="A4.SS1.p3.7.m7.1.1.2.3.cmml">t</mi></msub><mo id="A4.SS1.p3.7.m7.1.1.1" xref="A4.SS1.p3.7.m7.1.1.1.cmml">∈</mo><msup id="A4.SS1.p3.7.m7.1.1.3" xref="A4.SS1.p3.7.m7.1.1.3.cmml"><mi id="A4.SS1.p3.7.m7.1.1.3.2" xref="A4.SS1.p3.7.m7.1.1.3.2.cmml">ℝ</mi><mi id="A4.SS1.p3.7.m7.1.1.3.3" xref="A4.SS1.p3.7.m7.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p3.7.m7.1b"><apply id="A4.SS1.p3.7.m7.1.1.cmml" xref="A4.SS1.p3.7.m7.1.1"><in id="A4.SS1.p3.7.m7.1.1.1.cmml" xref="A4.SS1.p3.7.m7.1.1.1"></in><apply id="A4.SS1.p3.7.m7.1.1.2.cmml" xref="A4.SS1.p3.7.m7.1.1.2"><csymbol cd="ambiguous" id="A4.SS1.p3.7.m7.1.1.2.1.cmml" xref="A4.SS1.p3.7.m7.1.1.2">subscript</csymbol><ci id="A4.SS1.p3.7.m7.1.1.2.2.cmml" xref="A4.SS1.p3.7.m7.1.1.2.2">𝑐</ci><ci id="A4.SS1.p3.7.m7.1.1.2.3.cmml" xref="A4.SS1.p3.7.m7.1.1.2.3">𝑡</ci></apply><apply id="A4.SS1.p3.7.m7.1.1.3.cmml" xref="A4.SS1.p3.7.m7.1.1.3"><csymbol cd="ambiguous" id="A4.SS1.p3.7.m7.1.1.3.1.cmml" xref="A4.SS1.p3.7.m7.1.1.3">superscript</csymbol><ci id="A4.SS1.p3.7.m7.1.1.3.2.cmml" xref="A4.SS1.p3.7.m7.1.1.3.2">ℝ</ci><ci id="A4.SS1.p3.7.m7.1.1.3.3.cmml" xref="A4.SS1.p3.7.m7.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p3.7.m7.1c">c_{t}\in\mathbb{R}^{d}</annotation></semantics></math> is a textual parameter, typically computed using an attention over the question tokens <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, which is given as input to the modules and used, for example, as a query for visual attentions.
<span id="A4.SS1.p3.9.2" class="ltx_ERROR undefined">\figref</span>fig:controller shows the architecture of the controller, which has
a similar design as the controller in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.
At each step, the controller first concatenates the history vector, which is the textual parameter from the previous step, with the question representation, <math id="A4.SS1.p3.8.m8.1" class="ltx_Math" alttext="q" display="inline"><semantics id="A4.SS1.p3.8.m8.1a"><mi id="A4.SS1.p3.8.m8.1.1" xref="A4.SS1.p3.8.m8.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A4.SS1.p3.8.m8.1b"><ci id="A4.SS1.p3.8.m8.1.1.cmml" xref="A4.SS1.p3.8.m8.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p3.8.m8.1c">q</annotation></semantics></math>, which is the final hidden state of a bi-directional GRU <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.
Next, the concatenated vector is given as input to a MLP.
The output of the MLP (with an optional normalization layer) is then used to predict module weights as well as compute an attention over the question tokens, which yields a new textual parameter, <math id="A4.SS1.p3.9.m9.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="A4.SS1.p3.9.m9.1a"><msub id="A4.SS1.p3.9.m9.1.1" xref="A4.SS1.p3.9.m9.1.1.cmml"><mi id="A4.SS1.p3.9.m9.1.1.2" xref="A4.SS1.p3.9.m9.1.1.2.cmml">c</mi><mi id="A4.SS1.p3.9.m9.1.1.3" xref="A4.SS1.p3.9.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p3.9.m9.1b"><apply id="A4.SS1.p3.9.m9.1.1.cmml" xref="A4.SS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="A4.SS1.p3.9.m9.1.1.1.cmml" xref="A4.SS1.p3.9.m9.1.1">subscript</csymbol><ci id="A4.SS1.p3.9.m9.1.1.2.cmml" xref="A4.SS1.p3.9.m9.1.1.2">𝑐</ci><ci id="A4.SS1.p3.9.m9.1.1.3.cmml" xref="A4.SS1.p3.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p3.9.m9.1c">c_{t}</annotation></semantics></math>.</p>
</div>
<figure id="A4.F6" class="ltx_figure"><img src="/html/2011.13406/assets/x7.png" id="A4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="218" height="115" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A4.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="A4.F6.3.2" class="ltx_text" style="font-size:90%;">Illustration of the controller network.</span></figcaption>
</figure>
<div id="A4.SS1.p4" class="ltx_para ltx_noindent">
<p id="A4.SS1.p4.2" class="ltx_p"><span id="A4.SS1.p4.2.1" class="ltx_text ltx_font_bold">Modules.</span>
Each module is responsible for an elementary operation, with inputs that may be
any combination of attention maps generated at previous steps, the textual parameter from the controller, the visual features, or any other relevant features.
A module outputs either an attention map over the image regions, <math id="A4.SS1.p4.1.m1.1" class="ltx_Math" alttext="a\in\mathbb{R}^{K}" display="inline"><semantics id="A4.SS1.p4.1.m1.1a"><mrow id="A4.SS1.p4.1.m1.1.1" xref="A4.SS1.p4.1.m1.1.1.cmml"><mi id="A4.SS1.p4.1.m1.1.1.2" xref="A4.SS1.p4.1.m1.1.1.2.cmml">a</mi><mo id="A4.SS1.p4.1.m1.1.1.1" xref="A4.SS1.p4.1.m1.1.1.1.cmml">∈</mo><msup id="A4.SS1.p4.1.m1.1.1.3" xref="A4.SS1.p4.1.m1.1.1.3.cmml"><mi id="A4.SS1.p4.1.m1.1.1.3.2" xref="A4.SS1.p4.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="A4.SS1.p4.1.m1.1.1.3.3" xref="A4.SS1.p4.1.m1.1.1.3.3.cmml">K</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p4.1.m1.1b"><apply id="A4.SS1.p4.1.m1.1.1.cmml" xref="A4.SS1.p4.1.m1.1.1"><in id="A4.SS1.p4.1.m1.1.1.1.cmml" xref="A4.SS1.p4.1.m1.1.1.1"></in><ci id="A4.SS1.p4.1.m1.1.1.2.cmml" xref="A4.SS1.p4.1.m1.1.1.2">𝑎</ci><apply id="A4.SS1.p4.1.m1.1.1.3.cmml" xref="A4.SS1.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="A4.SS1.p4.1.m1.1.1.3.1.cmml" xref="A4.SS1.p4.1.m1.1.1.3">superscript</csymbol><ci id="A4.SS1.p4.1.m1.1.1.3.2.cmml" xref="A4.SS1.p4.1.m1.1.1.3.2">ℝ</ci><ci id="A4.SS1.p4.1.m1.1.1.3.3.cmml" xref="A4.SS1.p4.1.m1.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p4.1.m1.1c">a\in\mathbb{R}^{K}</annotation></semantics></math>, or a vector, <math id="A4.SS1.p4.2.m2.1" class="ltx_Math" alttext="z^{(t)}\in\mathbb{R}^{d}" display="inline"><semantics id="A4.SS1.p4.2.m2.1a"><mrow id="A4.SS1.p4.2.m2.1.2" xref="A4.SS1.p4.2.m2.1.2.cmml"><msup id="A4.SS1.p4.2.m2.1.2.2" xref="A4.SS1.p4.2.m2.1.2.2.cmml"><mi id="A4.SS1.p4.2.m2.1.2.2.2" xref="A4.SS1.p4.2.m2.1.2.2.2.cmml">z</mi><mrow id="A4.SS1.p4.2.m2.1.1.1.3" xref="A4.SS1.p4.2.m2.1.2.2.cmml"><mo stretchy="false" id="A4.SS1.p4.2.m2.1.1.1.3.1" xref="A4.SS1.p4.2.m2.1.2.2.cmml">(</mo><mi id="A4.SS1.p4.2.m2.1.1.1.1" xref="A4.SS1.p4.2.m2.1.1.1.1.cmml">t</mi><mo stretchy="false" id="A4.SS1.p4.2.m2.1.1.1.3.2" xref="A4.SS1.p4.2.m2.1.2.2.cmml">)</mo></mrow></msup><mo id="A4.SS1.p4.2.m2.1.2.1" xref="A4.SS1.p4.2.m2.1.2.1.cmml">∈</mo><msup id="A4.SS1.p4.2.m2.1.2.3" xref="A4.SS1.p4.2.m2.1.2.3.cmml"><mi id="A4.SS1.p4.2.m2.1.2.3.2" xref="A4.SS1.p4.2.m2.1.2.3.2.cmml">ℝ</mi><mi id="A4.SS1.p4.2.m2.1.2.3.3" xref="A4.SS1.p4.2.m2.1.2.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p4.2.m2.1b"><apply id="A4.SS1.p4.2.m2.1.2.cmml" xref="A4.SS1.p4.2.m2.1.2"><in id="A4.SS1.p4.2.m2.1.2.1.cmml" xref="A4.SS1.p4.2.m2.1.2.1"></in><apply id="A4.SS1.p4.2.m2.1.2.2.cmml" xref="A4.SS1.p4.2.m2.1.2.2"><csymbol cd="ambiguous" id="A4.SS1.p4.2.m2.1.2.2.1.cmml" xref="A4.SS1.p4.2.m2.1.2.2">superscript</csymbol><ci id="A4.SS1.p4.2.m2.1.2.2.2.cmml" xref="A4.SS1.p4.2.m2.1.2.2.2">𝑧</ci><ci id="A4.SS1.p4.2.m2.1.1.1.1.cmml" xref="A4.SS1.p4.2.m2.1.1.1.1">𝑡</ci></apply><apply id="A4.SS1.p4.2.m2.1.2.3.cmml" xref="A4.SS1.p4.2.m2.1.2.3"><csymbol cd="ambiguous" id="A4.SS1.p4.2.m2.1.2.3.1.cmml" xref="A4.SS1.p4.2.m2.1.2.3">superscript</csymbol><ci id="A4.SS1.p4.2.m2.1.2.3.2.cmml" xref="A4.SS1.p4.2.m2.1.2.3.2">ℝ</ci><ci id="A4.SS1.p4.2.m2.1.2.3.3.cmml" xref="A4.SS1.p4.2.m2.1.2.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p4.2.m2.1c">z^{(t)}\in\mathbb{R}^{d}</annotation></semantics></math>, which may be used for answer prediction.
The output of the modules at the last time step is combined with the question representation and used to predict the final answer via an output layer, such as a MLP.</p>
</div>
</section>
<section id="A4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Models</h3>

<div id="A4.SS2.p1" class="ltx_para">
<p id="A4.SS2.p1.1" class="ltx_p">The backbone architectures can be instantiated differently to
realize a variety of models with distinct module functionalities, reasoning steps, feature backbones, etc.
In this work, we adopt three designs of the controller-module models to test the effects of our Q3R training framework.</p>
</div>
<div id="A4.SS2.p2" class="ltx_para ltx_noindent">
<p id="A4.SS2.p2.1" class="ltx_p"><span id="A4.SS2.p2.1.1" class="ltx_text ltx_font_bold">StackNMN</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite><span id="A4.SS2.p2.1.2" class="ltx_text ltx_font_bold">.</span>
For StackNMN, the original method uses grid features from a CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> as visual features. For fair comparison with other
models, we use object features <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> for StackNMN, which is a stronger feature backbone for VQA.
The modules in this architecture largely use elementwise multiplications to fuse visual and linguistic features, compute different attention maps, or obtain answer vectors.
Additionally, in <span id="A4.SS2.p2.1.3" class="ltx_text ltx_font_typewriter">Find</span> and <span id="A4.SS2.p2.1.4" class="ltx_text ltx_font_typewriter">Transform</span>, 1D convolutions are also used to compute weighted visual and multi-modal features.
The specific module designs for StackNMN are shown in <span id="A4.SS2.p2.1.5" class="ltx_ERROR undefined">\tabref</span>tab:modules.</p>
</div>
<div id="A4.SS2.p3" class="ltx_para ltx_noindent">
<p id="A4.SS2.p3.3" class="ltx_p"><span id="A4.SS2.p3.3.1" class="ltx_text ltx_font_bold">XNM</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite><span id="A4.SS2.p3.3.2" class="ltx_text ltx_font_bold">.</span>
For XNM, the visual features, <math id="A4.SS2.p3.1.m1.1" class="ltx_Math" alttext="x\in\mathbb{R}^{d_{v}\times K}" display="inline"><semantics id="A4.SS2.p3.1.m1.1a"><mrow id="A4.SS2.p3.1.m1.1.1" xref="A4.SS2.p3.1.m1.1.1.cmml"><mi id="A4.SS2.p3.1.m1.1.1.2" xref="A4.SS2.p3.1.m1.1.1.2.cmml">x</mi><mo id="A4.SS2.p3.1.m1.1.1.1" xref="A4.SS2.p3.1.m1.1.1.1.cmml">∈</mo><msup id="A4.SS2.p3.1.m1.1.1.3" xref="A4.SS2.p3.1.m1.1.1.3.cmml"><mi id="A4.SS2.p3.1.m1.1.1.3.2" xref="A4.SS2.p3.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="A4.SS2.p3.1.m1.1.1.3.3" xref="A4.SS2.p3.1.m1.1.1.3.3.cmml"><msub id="A4.SS2.p3.1.m1.1.1.3.3.2" xref="A4.SS2.p3.1.m1.1.1.3.3.2.cmml"><mi id="A4.SS2.p3.1.m1.1.1.3.3.2.2" xref="A4.SS2.p3.1.m1.1.1.3.3.2.2.cmml">d</mi><mi id="A4.SS2.p3.1.m1.1.1.3.3.2.3" xref="A4.SS2.p3.1.m1.1.1.3.3.2.3.cmml">v</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A4.SS2.p3.1.m1.1.1.3.3.1" xref="A4.SS2.p3.1.m1.1.1.3.3.1.cmml">×</mo><mi id="A4.SS2.p3.1.m1.1.1.3.3.3" xref="A4.SS2.p3.1.m1.1.1.3.3.3.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p3.1.m1.1b"><apply id="A4.SS2.p3.1.m1.1.1.cmml" xref="A4.SS2.p3.1.m1.1.1"><in id="A4.SS2.p3.1.m1.1.1.1.cmml" xref="A4.SS2.p3.1.m1.1.1.1"></in><ci id="A4.SS2.p3.1.m1.1.1.2.cmml" xref="A4.SS2.p3.1.m1.1.1.2">𝑥</ci><apply id="A4.SS2.p3.1.m1.1.1.3.cmml" xref="A4.SS2.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="A4.SS2.p3.1.m1.1.1.3.1.cmml" xref="A4.SS2.p3.1.m1.1.1.3">superscript</csymbol><ci id="A4.SS2.p3.1.m1.1.1.3.2.cmml" xref="A4.SS2.p3.1.m1.1.1.3.2">ℝ</ci><apply id="A4.SS2.p3.1.m1.1.1.3.3.cmml" xref="A4.SS2.p3.1.m1.1.1.3.3"><times id="A4.SS2.p3.1.m1.1.1.3.3.1.cmml" xref="A4.SS2.p3.1.m1.1.1.3.3.1"></times><apply id="A4.SS2.p3.1.m1.1.1.3.3.2.cmml" xref="A4.SS2.p3.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="A4.SS2.p3.1.m1.1.1.3.3.2.1.cmml" xref="A4.SS2.p3.1.m1.1.1.3.3.2">subscript</csymbol><ci id="A4.SS2.p3.1.m1.1.1.3.3.2.2.cmml" xref="A4.SS2.p3.1.m1.1.1.3.3.2.2">𝑑</ci><ci id="A4.SS2.p3.1.m1.1.1.3.3.2.3.cmml" xref="A4.SS2.p3.1.m1.1.1.3.3.2.3">𝑣</ci></apply><ci id="A4.SS2.p3.1.m1.1.1.3.3.3.cmml" xref="A4.SS2.p3.1.m1.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p3.1.m1.1c">x\in\mathbb{R}^{d_{v}\times K}</annotation></semantics></math>, are object features that represent nodes in the input scene graph.
The edge features, <math id="A4.SS2.p3.2.m2.1" class="ltx_Math" alttext="R\in\mathbb{R}^{K\times K\times 2d_{v}}" display="inline"><semantics id="A4.SS2.p3.2.m2.1a"><mrow id="A4.SS2.p3.2.m2.1.1" xref="A4.SS2.p3.2.m2.1.1.cmml"><mi id="A4.SS2.p3.2.m2.1.1.2" xref="A4.SS2.p3.2.m2.1.1.2.cmml">R</mi><mo id="A4.SS2.p3.2.m2.1.1.1" xref="A4.SS2.p3.2.m2.1.1.1.cmml">∈</mo><msup id="A4.SS2.p3.2.m2.1.1.3" xref="A4.SS2.p3.2.m2.1.1.3.cmml"><mi id="A4.SS2.p3.2.m2.1.1.3.2" xref="A4.SS2.p3.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="A4.SS2.p3.2.m2.1.1.3.3" xref="A4.SS2.p3.2.m2.1.1.3.3.cmml"><mrow id="A4.SS2.p3.2.m2.1.1.3.3.2" xref="A4.SS2.p3.2.m2.1.1.3.3.2.cmml"><mi id="A4.SS2.p3.2.m2.1.1.3.3.2.2" xref="A4.SS2.p3.2.m2.1.1.3.3.2.2.cmml">K</mi><mo lspace="0.222em" rspace="0.222em" id="A4.SS2.p3.2.m2.1.1.3.3.2.1" xref="A4.SS2.p3.2.m2.1.1.3.3.2.1.cmml">×</mo><mi id="A4.SS2.p3.2.m2.1.1.3.3.2.3" xref="A4.SS2.p3.2.m2.1.1.3.3.2.3.cmml">K</mi><mo lspace="0.222em" rspace="0.222em" id="A4.SS2.p3.2.m2.1.1.3.3.2.1a" xref="A4.SS2.p3.2.m2.1.1.3.3.2.1.cmml">×</mo><mn id="A4.SS2.p3.2.m2.1.1.3.3.2.4" xref="A4.SS2.p3.2.m2.1.1.3.3.2.4.cmml">2</mn></mrow><mo lspace="0em" rspace="0em" id="A4.SS2.p3.2.m2.1.1.3.3.1" xref="A4.SS2.p3.2.m2.1.1.3.3.1.cmml">​</mo><msub id="A4.SS2.p3.2.m2.1.1.3.3.3" xref="A4.SS2.p3.2.m2.1.1.3.3.3.cmml"><mi id="A4.SS2.p3.2.m2.1.1.3.3.3.2" xref="A4.SS2.p3.2.m2.1.1.3.3.3.2.cmml">d</mi><mi id="A4.SS2.p3.2.m2.1.1.3.3.3.3" xref="A4.SS2.p3.2.m2.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p3.2.m2.1b"><apply id="A4.SS2.p3.2.m2.1.1.cmml" xref="A4.SS2.p3.2.m2.1.1"><in id="A4.SS2.p3.2.m2.1.1.1.cmml" xref="A4.SS2.p3.2.m2.1.1.1"></in><ci id="A4.SS2.p3.2.m2.1.1.2.cmml" xref="A4.SS2.p3.2.m2.1.1.2">𝑅</ci><apply id="A4.SS2.p3.2.m2.1.1.3.cmml" xref="A4.SS2.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="A4.SS2.p3.2.m2.1.1.3.1.cmml" xref="A4.SS2.p3.2.m2.1.1.3">superscript</csymbol><ci id="A4.SS2.p3.2.m2.1.1.3.2.cmml" xref="A4.SS2.p3.2.m2.1.1.3.2">ℝ</ci><apply id="A4.SS2.p3.2.m2.1.1.3.3.cmml" xref="A4.SS2.p3.2.m2.1.1.3.3"><times id="A4.SS2.p3.2.m2.1.1.3.3.1.cmml" xref="A4.SS2.p3.2.m2.1.1.3.3.1"></times><apply id="A4.SS2.p3.2.m2.1.1.3.3.2.cmml" xref="A4.SS2.p3.2.m2.1.1.3.3.2"><times id="A4.SS2.p3.2.m2.1.1.3.3.2.1.cmml" xref="A4.SS2.p3.2.m2.1.1.3.3.2.1"></times><ci id="A4.SS2.p3.2.m2.1.1.3.3.2.2.cmml" xref="A4.SS2.p3.2.m2.1.1.3.3.2.2">𝐾</ci><ci id="A4.SS2.p3.2.m2.1.1.3.3.2.3.cmml" xref="A4.SS2.p3.2.m2.1.1.3.3.2.3">𝐾</ci><cn type="integer" id="A4.SS2.p3.2.m2.1.1.3.3.2.4.cmml" xref="A4.SS2.p3.2.m2.1.1.3.3.2.4">2</cn></apply><apply id="A4.SS2.p3.2.m2.1.1.3.3.3.cmml" xref="A4.SS2.p3.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="A4.SS2.p3.2.m2.1.1.3.3.3.1.cmml" xref="A4.SS2.p3.2.m2.1.1.3.3.3">subscript</csymbol><ci id="A4.SS2.p3.2.m2.1.1.3.3.3.2.cmml" xref="A4.SS2.p3.2.m2.1.1.3.3.3.2">𝑑</ci><ci id="A4.SS2.p3.2.m2.1.1.3.3.3.3.cmml" xref="A4.SS2.p3.2.m2.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p3.2.m2.1c">R\in\mathbb{R}^{K\times K\times 2d_{v}}</annotation></semantics></math>, for the scene graph are the concatenations of neighboring edges and <math id="A4.SS2.p3.3.m3.1" class="ltx_Math" alttext="M\in\mathbb{R}^{K\times K}" display="inline"><semantics id="A4.SS2.p3.3.m3.1a"><mrow id="A4.SS2.p3.3.m3.1.1" xref="A4.SS2.p3.3.m3.1.1.cmml"><mi id="A4.SS2.p3.3.m3.1.1.2" xref="A4.SS2.p3.3.m3.1.1.2.cmml">M</mi><mo id="A4.SS2.p3.3.m3.1.1.1" xref="A4.SS2.p3.3.m3.1.1.1.cmml">∈</mo><msup id="A4.SS2.p3.3.m3.1.1.3" xref="A4.SS2.p3.3.m3.1.1.3.cmml"><mi id="A4.SS2.p3.3.m3.1.1.3.2" xref="A4.SS2.p3.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="A4.SS2.p3.3.m3.1.1.3.3" xref="A4.SS2.p3.3.m3.1.1.3.3.cmml"><mi id="A4.SS2.p3.3.m3.1.1.3.3.2" xref="A4.SS2.p3.3.m3.1.1.3.3.2.cmml">K</mi><mo lspace="0.222em" rspace="0.222em" id="A4.SS2.p3.3.m3.1.1.3.3.1" xref="A4.SS2.p3.3.m3.1.1.3.3.1.cmml">×</mo><mi id="A4.SS2.p3.3.m3.1.1.3.3.3" xref="A4.SS2.p3.3.m3.1.1.3.3.3.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p3.3.m3.1b"><apply id="A4.SS2.p3.3.m3.1.1.cmml" xref="A4.SS2.p3.3.m3.1.1"><in id="A4.SS2.p3.3.m3.1.1.1.cmml" xref="A4.SS2.p3.3.m3.1.1.1"></in><ci id="A4.SS2.p3.3.m3.1.1.2.cmml" xref="A4.SS2.p3.3.m3.1.1.2">𝑀</ci><apply id="A4.SS2.p3.3.m3.1.1.3.cmml" xref="A4.SS2.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="A4.SS2.p3.3.m3.1.1.3.1.cmml" xref="A4.SS2.p3.3.m3.1.1.3">superscript</csymbol><ci id="A4.SS2.p3.3.m3.1.1.3.2.cmml" xref="A4.SS2.p3.3.m3.1.1.3.2">ℝ</ci><apply id="A4.SS2.p3.3.m3.1.1.3.3.cmml" xref="A4.SS2.p3.3.m3.1.1.3.3"><times id="A4.SS2.p3.3.m3.1.1.3.3.1.cmml" xref="A4.SS2.p3.3.m3.1.1.3.3.1"></times><ci id="A4.SS2.p3.3.m3.1.1.3.3.2.cmml" xref="A4.SS2.p3.3.m3.1.1.3.3.2">𝐾</ci><ci id="A4.SS2.p3.3.m3.1.1.3.3.3.cmml" xref="A4.SS2.p3.3.m3.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p3.3.m3.1c">M\in\mathbb{R}^{K\times K}</annotation></semantics></math> is the adjacency matrix of the scene graph.
The <span id="A4.SS2.p3.3.3" class="ltx_text ltx_font_typewriter">Transform</span> module is the only module that considers the scene graph and uses the graph information to shift the visual attention according to the graph connectivity.
These modules adopt the naming conventions of StackNMN, but XNM, in particular, has a different <span id="A4.SS2.p3.3.4" class="ltx_text ltx_font_typewriter">Transform</span> implementation, which learns attention transforms on image scene graph representations, and an alternative multi-modal fusion method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>. The detailed module information is
shown in <span id="A4.SS2.p3.3.5" class="ltx_ERROR undefined">\tabref</span>tab:modules.</p>
</div>
<div id="A4.SS2.p4" class="ltx_para ltx_noindent">
<p id="A4.SS2.p4.1" class="ltx_p"><span id="A4.SS2.p4.1.1" class="ltx_text ltx_font_bold">HybridNet.</span>
To further investigate whether our framework can be effective regardless of the module implementations, we present a hybrid of StackNMN and XNM.
Specifically, HybridNet utilizes the <span id="A4.SS2.p4.1.2" class="ltx_text ltx_font_typewriter">Transform</span> module of StackNMN, while maintaining the rest of the design from XNM.</p>
</div>
</section>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Output Examples</h2>

<div id="A5.p1" class="ltx_para">
<p id="A5.p1.1" class="ltx_p">Here are some example outputs from HybridNet with and without Q3R.
In <span id="A5.p1.1.1" class="ltx_ERROR undefined">\figref</span>fig:output_bear, the model trained without Q3R maintains its answers despite the perturbation, whereas the model trained with our framework predicts the appropriate answer and also matches visual attentions between them.
Then, in <span id="A5.p1.1.2" class="ltx_ERROR undefined">\figref</span>fig:output_scenetime, we see an example where the questions share the same meaning and the same modules are selected for both questions and both models, but the model without our framework yields inconsistent answers.</p>
</div>
<figure id="A5.F7" class="ltx_figure"><img src="/html/2011.13406/assets/x8.png" id="A5.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="436" height="207" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A5.F7.2.1.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="A5.F7.3.2" class="ltx_text" style="font-size:90%;">Example visual attentions, module selections, and outputs for an antonymous pair of questions. The top two rows are from HybridNet trained only on VQA v2, while the bottom two rows are from HybridNet trained with Q3R.</span></figcaption>
</figure>
<figure id="A5.F8" class="ltx_figure"><img src="/html/2011.13406/assets/x9.png" id="A5.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="442" height="207" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A5.F8.2.1.1" class="ltx_text" style="font-size:90%;">Figure 8</span>: </span><span id="A5.F8.3.2" class="ltx_text" style="font-size:90%;">Example reasoning outputs for a paraphrastic pair of questions. Again, the top two rows are from HybridNet trained on VQA v2 and the bottom two are from HybridNet+Q3R.</span></figcaption>
</figure>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2011.13405" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2011.13406" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2011.13406">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2011.13406" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2011.13407" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Mar  9 04:52:48 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
