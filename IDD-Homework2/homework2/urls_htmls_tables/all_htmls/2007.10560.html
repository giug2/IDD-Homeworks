<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2007.10560] FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning</title><meta property="og:description" content="With the increasing awareness of privacy protection and data fragmentation problem, federated learning has been emerging as a new paradigm of machine learning. Federated learning tends to utilize various privacy preser…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2007.10560">

<!--Generated on Thu Mar 14 13:00:53 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Zhaoxiong Yang<sup id="id7.2.id1" class="ltx_sup">1</sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shuihai Hu<sup id="id8.2.id1" class="ltx_sup">2</sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Kai Chen<sup id="id9.5.id1" class="ltx_sup"><span id="id9.5.id1.1" class="ltx_text ltx_font_italic">1,3</span></sup>
<sup id="id10.6.id2" class="ltx_sup">1</sup>SING Lab, Hong Kong University of Science and Technology
<br class="ltx_break"><sup id="id11.7.id3" class="ltx_sup">2</sup>Clustar, <sup id="id12.8.id4" class="ltx_sup">3</sup>Peng Cheng Lab
<br class="ltx_break">zyangas@connect.ust.hk,
shuihai@clustar.ai,
kaichen@cse.ust.hk
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id13.id1" class="ltx_p">With the increasing awareness of privacy protection and data fragmentation problem, federated learning has been emerging as a new paradigm of machine learning. Federated learning tends to utilize various privacy preserving mechanisms to protect the transferred intermediate data, among which homomorphic encryption strikes a balance between security and ease of utilization. However, the complicated operations and large operands impose significant overhead on federated learning. Maintaining accuracy and security more efficiently has been a key problem of federated learning. In this work, we investigate a hardware solution, and design an FPGA-based homomorphic encryption framework, aiming to accelerate the training phase in federated learning. The root complexity lies in searching for a compact architecture for the core operation of homomorphic encryption, to suit the requirement of federated learning about high encryption throughput and flexibility of configuration. Our framework implements the representative Paillier homomorphic cryptosystem with high level synthesis for flexibility and portability, with careful optimization on the modular multiplication operation in terms of processing clock cycle, resource usage and clock frequency. Our accelerator achieves a near-optimal execution clock cycle, with a better DSP-efficiency than existing designs, and reduces the encryption time by up to 71% during training process of various federated learning models.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">In recent years, deep learning has made an unprecedented leap in the ability of human discovering knowledge and comprehending the world. Nevertheless, the adoption of deep learning is now faced with two barriers, namely data fragmentation and privacy preservation<cite class="ltx_cite ltx_citemacro_cite">Yang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib19" title="" class="ltx_ref">2019</a>)</cite>. Federated learning has come up as a new machine learning paradigm to tackle the issues, learning models from decentralized datasets in a secure way.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">To preserve data privacy, federated learning usually employs various mechanisms like differential privacy (DP), homomorphic encryption (HE), secure multiparty computation (SMC), etc. Whereas DP does not prevent data leakage completely, and the intricate protocols that SMC introduces to the system renders it virtually impractical, HE achieves a balance between security and operability. Moreover, one of the HE scheme named Paillier encryption scheme<cite class="ltx_cite ltx_citemacro_cite">Paillier (<a href="#bib.bib14" title="" class="ltx_ref">1999</a>)</cite> has been adopted to protect the data privacy in neural networks<cite class="ltx_cite ltx_citemacro_cite">Ma <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib11" title="" class="ltx_ref">2017</a>)</cite>, logistic regression<cite class="ltx_cite ltx_citemacro_cite">Hardy <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib6" title="" class="ltx_ref">2017</a>)</cite>, Bayesian network<cite class="ltx_cite ltx_citemacro_cite">Wright and
Yang (<a href="#bib.bib18" title="" class="ltx_ref">2004</a>)</cite>, clustering<cite class="ltx_cite ltx_citemacro_cite">Bunn and Ostrovsky (<a href="#bib.bib2" title="" class="ltx_ref">2007</a>)</cite>, showcasing its great generality as a privacy preserving mechanism in machine learning.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">However, the complicated operations and large operands of HE still impose overhead on federated learning that cannot be ignored. Research community and industry have been haunted by the question of how to provide <em id="S1.p3.1.1" class="ltx_emph ltx_font_italic">secure</em>, <em id="S1.p3.1.2" class="ltx_emph ltx_font_italic">accurate</em>, and yet <em id="S1.p3.1.3" class="ltx_emph ltx_font_italic">efficient</em> federated learning. Previous effort such as FATE<cite class="ltx_cite ltx_citemacro_cite">FAT (<a href="#bib.bib4" title="" class="ltx_ref">2019</a>)</cite>, a cutting edge federated learning system, has provided convenient interface to implement learning algorithms secured by Paillier HE, but the learning throughput is limited due to encryption by software.
In this work, we seek for a hardware solution to improve the training throughput of federated learning, designing a homomorphic encryption framework based on FPGA, since FPGA acceleration card has been commonly available in datacenters<cite class="ltx_cite ltx_citemacro_cite">Putnam (<a href="#bib.bib15" title="" class="ltx_ref">2014</a>)</cite> and usually achieve a lower power consumption than GPU. The framework devises a customized FPGA implementation of the Paillier homomorphic encryption, and provides support for federated learning models with secure information exchange.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">We demonstrate in this work that homomorphic encryption is usually composed of iterative operations that are hard to parallelize. Therefore, it is more reasonable to consider parallelism across data items to be encrypted, and make each encryption core compact and resource efficient, so as to maximize the overall throughput to handle the massive data in federated learning. The existing works fail to do that, as they either try to exhaust the resource on a single FPGA chip to produce one encryption unit to minimize the processing latency, or they mainly utilize the common circuit units (usually termed CLB or LUT) without making use of the digital signal processing (DSP) units, which are the powerful units for high performance arithmetic operation on modern FPGA. Moreover, most of them rely on the traditional register-level transfer (RTL) approach, lacking the flexibility of fast development and reconfiguration.
In this work, we base our design and implementation on high level synthesis (HLS) that describe the FPGA circuit with high-level programming language for flexibility, allowing the algorithm and operations to be parametric and portable, and we try to derive an analytical model that determines the encryption performance, carry out optimization from multiple dimension.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Since the bulk of computation of Paillier cryptosystem boils down to modular multiplication(ModMult), we focus on designing compact architecture for ModMult operation. We adopt the Montgomery algorithm<cite class="ltx_cite ltx_citemacro_cite">Montgomery (<a href="#bib.bib13" title="" class="ltx_ref">1985</a>)</cite> to carry out the operation, which is FPGA-friendly as it eliminates integer division operations. We figure out the key factors that determines the total en/decryption throughput on an FPGA chip, conduct overall optimization on Paillier processors in terms of clock cycle, resource consumption, clock frequency and memory usage respectively to attain the best throughput.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">The hardware module are built as OpenCL kernels and incorporate into FATE as an encryption library.
Each kernel performs en/decryption for a batch of data to relieve the kernel invocation overhead, and kernels are queued in the OpenCL command queue to help overlap data transfer with computation and hide latency. The proposed encryption framework is general and does not require any change of the model, while preserving the security and accuracy.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">We perform extensive evaluation on the proposed framework, demonstrating that it reduces the iteration time for training linear models by up to 26%, and the encryption time in each iteration by 71%. Our hardware framework delivers an acceleration ratio of 10.6 for encryption and 2.8 for decryption compared with software solutions. Our circuit for ModMult operation achieves a better DSP-efficiency than existing FPGA solutions, with a comparable execution latency but a lower usage of DSP blocks.</p>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p">We summarize our contributions as follows.</p>
</div>
<div id="S1.p9" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">Introducing a hardware-based encryption framework for federated learning, achieving high efficiency without sacrifice of security and utility, supporting accelerated computation in cloud datacenters.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">Presenting architectures for Paillier homomorphic cryptosystem taking a scalable approach making efficient utilization of the FPGA resources, especially DSP blocks.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Incorporating the encryption framework into cutting-edge federated learning framework, and showing an improvement on training throughput for federated learning models.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p10" class="ltx_para">
<p id="S1.p10.1" class="ltx_p">The rest of the article will be organized as follows.
In Section <a href="#S2" title="2 Background ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> we will provide the background about federated learning and existing privacy preserving machine learning systems, and introduce the Paillier cryptosystem we work on. Section <a href="#S3" title="3 Design and Implementation ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> will present the design and implementation of the framework in detail. Section <a href="#S4" title="4 Evaluation ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the methodology and results of evaluation. Finally in Section <a href="#S5" title="5 Conclusion ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> we conclude the article.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Federated learning with HE</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Federated learning is a privacy-preserving, decentralized distributed machine learning paradigm. One effective method of preserving privacy and securing computation is homomorphic encryption (HE), i.e. encryption schemes that allows encrypted values to be involved in computation. For the applications of HE in federated learning, we refer the readers to <cite class="ltx_cite ltx_citemacro_cite">Hardy <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib6" title="" class="ltx_ref">2017</a>)</cite>, <cite class="ltx_cite ltx_citemacro_cite">Gilad-Bachrach <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib5" title="" class="ltx_ref">2016</a>)</cite>, <cite class="ltx_cite ltx_citemacro_cite">Aono <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib1" title="" class="ltx_ref">2017</a>)</cite>, <cite class="ltx_cite ltx_citemacro_cite">Liu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2019</a>)</cite>, <cite class="ltx_cite ltx_citemacro_cite">Liu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib9" title="" class="ltx_ref">2018</a>)</cite>, <cite class="ltx_cite ltx_citemacro_cite">Chai <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib3" title="" class="ltx_ref">2019</a>)</cite>, which broadly cover machine learning models including linear model, neural network and deep learning, boosting tree, transfer learning and matrix factorization. Typically, HE is employed to encrypt the intermediate data during computation, which will then be transferred and aggregated by homomorphic operation. For nonlinear operations composing the model, such as activation function in a neural network, these works usually rely on approximation to make the model agree with HE computation.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Privacy-preserving ML systems</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">There has also been machine learning systems that take privacy preservation into account, such as SecureML<cite class="ltx_cite ltx_citemacro_cite">Mohassel and
Zhang (<a href="#bib.bib12" title="" class="ltx_ref">2017</a>)</cite> that proposes a system for two non-colluding party collectively training a model, and Sage<cite class="ltx_cite ltx_citemacro_cite">L‘ecuyer <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite> that presents a differentially private machine learning platform. Among them, FATE<cite class="ltx_cite ltx_citemacro_cite">FAT (<a href="#bib.bib4" title="" class="ltx_ref">2019</a>)</cite> introduces a federated learning framework that provides the abstraction and utilities for implementing algorithm and models, along with an architecture to enable distributed, multiparty machine learning. It mainly utilizes Paillier homomorphic encryption to guarantee data security. However, it purely relies on a software solution of encryption that greatly harms the execution efficiency of federated training. Our goal in the work is to find a hardware solution as a rescue to this issue.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Paillier Homomorphic Encryption</h3>

<figure id="S2.F1" class="ltx_figure"><img src="/html/2007.10560/assets/homo.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="449" height="108" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>General workflow of homomorphic encryption-based federated learning</figcaption>
</figure>
<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">Paillier HE is an additive homomorphic encryption scheme allowing to perform addition and multiplication with scalar on encrypted values without decrypting them.
In federated learning, usually multiple parties are involved, each one having a private dataset and wanting to maintain a local model learned from the aggregated dataset, and there may be a coordinator to manage the computation and data exchange among parties (Figure <a href="#S2.F1" title="Figure 1 ‣ 2.3 Paillier Homomorphic Encryption ‣ 2 Background ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). The role of Paillier homomorphic encryption is to encrypt the intermediate data to transfer, so that in each training iteration the coordinator receives the encrypted local updates from parties, aggregates them with the homomorphic property, and sends back the result to each party for decryption and updating local model. In this way, each party obtain a model extracting information from the aggregate dataset, without leaking its private information.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.8" class="ltx_p">The Paillier HE scheme associates each party with a public key <math id="S2.SS3.p2.1.m1.2" class="ltx_Math" alttext="(n,g)" display="inline"><semantics id="S2.SS3.p2.1.m1.2a"><mrow id="S2.SS3.p2.1.m1.2.3.2" xref="S2.SS3.p2.1.m1.2.3.1.cmml"><mo stretchy="false" id="S2.SS3.p2.1.m1.2.3.2.1" xref="S2.SS3.p2.1.m1.2.3.1.cmml">(</mo><mi id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml">n</mi><mo id="S2.SS3.p2.1.m1.2.3.2.2" xref="S2.SS3.p2.1.m1.2.3.1.cmml">,</mo><mi id="S2.SS3.p2.1.m1.2.2" xref="S2.SS3.p2.1.m1.2.2.cmml">g</mi><mo stretchy="false" id="S2.SS3.p2.1.m1.2.3.2.3" xref="S2.SS3.p2.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.2b"><interval closure="open" id="S2.SS3.p2.1.m1.2.3.1.cmml" xref="S2.SS3.p2.1.m1.2.3.2"><ci id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1">𝑛</ci><ci id="S2.SS3.p2.1.m1.2.2.cmml" xref="S2.SS3.p2.1.m1.2.2">𝑔</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.2c">(n,g)</annotation></semantics></math> and a private key <math id="S2.SS3.p2.2.m2.2" class="ltx_Math" alttext="(\lambda,\mu)" display="inline"><semantics id="S2.SS3.p2.2.m2.2a"><mrow id="S2.SS3.p2.2.m2.2.3.2" xref="S2.SS3.p2.2.m2.2.3.1.cmml"><mo stretchy="false" id="S2.SS3.p2.2.m2.2.3.2.1" xref="S2.SS3.p2.2.m2.2.3.1.cmml">(</mo><mi id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml">λ</mi><mo id="S2.SS3.p2.2.m2.2.3.2.2" xref="S2.SS3.p2.2.m2.2.3.1.cmml">,</mo><mi id="S2.SS3.p2.2.m2.2.2" xref="S2.SS3.p2.2.m2.2.2.cmml">μ</mi><mo stretchy="false" id="S2.SS3.p2.2.m2.2.3.2.3" xref="S2.SS3.p2.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.2b"><interval closure="open" id="S2.SS3.p2.2.m2.2.3.1.cmml" xref="S2.SS3.p2.2.m2.2.3.2"><ci id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">𝜆</ci><ci id="S2.SS3.p2.2.m2.2.2.cmml" xref="S2.SS3.p2.2.m2.2.2">𝜇</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.2c">(\lambda,\mu)</annotation></semantics></math>, where <math id="S2.SS3.p2.3.m3.4" class="ltx_Math" alttext="n,g,\lambda,\mu" display="inline"><semantics id="S2.SS3.p2.3.m3.4a"><mrow id="S2.SS3.p2.3.m3.4.5.2" xref="S2.SS3.p2.3.m3.4.5.1.cmml"><mi id="S2.SS3.p2.3.m3.1.1" xref="S2.SS3.p2.3.m3.1.1.cmml">n</mi><mo id="S2.SS3.p2.3.m3.4.5.2.1" xref="S2.SS3.p2.3.m3.4.5.1.cmml">,</mo><mi id="S2.SS3.p2.3.m3.2.2" xref="S2.SS3.p2.3.m3.2.2.cmml">g</mi><mo id="S2.SS3.p2.3.m3.4.5.2.2" xref="S2.SS3.p2.3.m3.4.5.1.cmml">,</mo><mi id="S2.SS3.p2.3.m3.3.3" xref="S2.SS3.p2.3.m3.3.3.cmml">λ</mi><mo id="S2.SS3.p2.3.m3.4.5.2.3" xref="S2.SS3.p2.3.m3.4.5.1.cmml">,</mo><mi id="S2.SS3.p2.3.m3.4.4" xref="S2.SS3.p2.3.m3.4.4.cmml">μ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.4b"><list id="S2.SS3.p2.3.m3.4.5.1.cmml" xref="S2.SS3.p2.3.m3.4.5.2"><ci id="S2.SS3.p2.3.m3.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1">𝑛</ci><ci id="S2.SS3.p2.3.m3.2.2.cmml" xref="S2.SS3.p2.3.m3.2.2">𝑔</ci><ci id="S2.SS3.p2.3.m3.3.3.cmml" xref="S2.SS3.p2.3.m3.3.3">𝜆</ci><ci id="S2.SS3.p2.3.m3.4.4.cmml" xref="S2.SS3.p2.3.m3.4.4">𝜇</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.4c">n,g,\lambda,\mu</annotation></semantics></math> are large integers, typically 1024-bit in FATE. Messages and ciphertexts are also represented as long integers. A message <math id="S2.SS3.p2.4.m4.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.SS3.p2.4.m4.1a"><mi id="S2.SS3.p2.4.m4.1.1" xref="S2.SS3.p2.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m4.1b"><ci id="S2.SS3.p2.4.m4.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m4.1c">m</annotation></semantics></math> can be encrypted into ciphertext <math id="S2.SS3.p2.5.m5.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.SS3.p2.5.m5.1a"><mi id="S2.SS3.p2.5.m5.1.1" xref="S2.SS3.p2.5.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.5.m5.1b"><ci id="S2.SS3.p2.5.m5.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.5.m5.1c">c</annotation></semantics></math> by <math id="S2.SS3.p2.6.m6.1" class="ltx_Math" alttext="c=g^{m}r^{n}\mod n^{2}" display="inline"><semantics id="S2.SS3.p2.6.m6.1a"><mrow id="S2.SS3.p2.6.m6.1.1" xref="S2.SS3.p2.6.m6.1.1.cmml"><mi id="S2.SS3.p2.6.m6.1.1.2" xref="S2.SS3.p2.6.m6.1.1.2.cmml">c</mi><mo id="S2.SS3.p2.6.m6.1.1.1" xref="S2.SS3.p2.6.m6.1.1.1.cmml">=</mo><mrow id="S2.SS3.p2.6.m6.1.1.3" xref="S2.SS3.p2.6.m6.1.1.3.cmml"><mrow id="S2.SS3.p2.6.m6.1.1.3.2" xref="S2.SS3.p2.6.m6.1.1.3.2.cmml"><msup id="S2.SS3.p2.6.m6.1.1.3.2.2" xref="S2.SS3.p2.6.m6.1.1.3.2.2.cmml"><mi id="S2.SS3.p2.6.m6.1.1.3.2.2.2" xref="S2.SS3.p2.6.m6.1.1.3.2.2.2.cmml">g</mi><mi id="S2.SS3.p2.6.m6.1.1.3.2.2.3" xref="S2.SS3.p2.6.m6.1.1.3.2.2.3.cmml">m</mi></msup><mo lspace="0em" rspace="0em" id="S2.SS3.p2.6.m6.1.1.3.2.1" xref="S2.SS3.p2.6.m6.1.1.3.2.1.cmml">​</mo><msup id="S2.SS3.p2.6.m6.1.1.3.2.3" xref="S2.SS3.p2.6.m6.1.1.3.2.3.cmml"><mi id="S2.SS3.p2.6.m6.1.1.3.2.3.2" xref="S2.SS3.p2.6.m6.1.1.3.2.3.2.cmml">r</mi><mi id="S2.SS3.p2.6.m6.1.1.3.2.3.3" xref="S2.SS3.p2.6.m6.1.1.3.2.3.3.cmml">n</mi></msup></mrow><mo id="S2.SS3.p2.6.m6.1.1.3.1" xref="S2.SS3.p2.6.m6.1.1.3.1.cmml">mod</mo><msup id="S2.SS3.p2.6.m6.1.1.3.3" xref="S2.SS3.p2.6.m6.1.1.3.3.cmml"><mi id="S2.SS3.p2.6.m6.1.1.3.3.2" xref="S2.SS3.p2.6.m6.1.1.3.3.2.cmml">n</mi><mn id="S2.SS3.p2.6.m6.1.1.3.3.3" xref="S2.SS3.p2.6.m6.1.1.3.3.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.6.m6.1b"><apply id="S2.SS3.p2.6.m6.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1"><eq id="S2.SS3.p2.6.m6.1.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1.1"></eq><ci id="S2.SS3.p2.6.m6.1.1.2.cmml" xref="S2.SS3.p2.6.m6.1.1.2">𝑐</ci><apply id="S2.SS3.p2.6.m6.1.1.3.cmml" xref="S2.SS3.p2.6.m6.1.1.3"><csymbol cd="latexml" id="S2.SS3.p2.6.m6.1.1.3.1.cmml" xref="S2.SS3.p2.6.m6.1.1.3.1">modulo</csymbol><apply id="S2.SS3.p2.6.m6.1.1.3.2.cmml" xref="S2.SS3.p2.6.m6.1.1.3.2"><times id="S2.SS3.p2.6.m6.1.1.3.2.1.cmml" xref="S2.SS3.p2.6.m6.1.1.3.2.1"></times><apply id="S2.SS3.p2.6.m6.1.1.3.2.2.cmml" xref="S2.SS3.p2.6.m6.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m6.1.1.3.2.2.1.cmml" xref="S2.SS3.p2.6.m6.1.1.3.2.2">superscript</csymbol><ci id="S2.SS3.p2.6.m6.1.1.3.2.2.2.cmml" xref="S2.SS3.p2.6.m6.1.1.3.2.2.2">𝑔</ci><ci id="S2.SS3.p2.6.m6.1.1.3.2.2.3.cmml" xref="S2.SS3.p2.6.m6.1.1.3.2.2.3">𝑚</ci></apply><apply id="S2.SS3.p2.6.m6.1.1.3.2.3.cmml" xref="S2.SS3.p2.6.m6.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m6.1.1.3.2.3.1.cmml" xref="S2.SS3.p2.6.m6.1.1.3.2.3">superscript</csymbol><ci id="S2.SS3.p2.6.m6.1.1.3.2.3.2.cmml" xref="S2.SS3.p2.6.m6.1.1.3.2.3.2">𝑟</ci><ci id="S2.SS3.p2.6.m6.1.1.3.2.3.3.cmml" xref="S2.SS3.p2.6.m6.1.1.3.2.3.3">𝑛</ci></apply></apply><apply id="S2.SS3.p2.6.m6.1.1.3.3.cmml" xref="S2.SS3.p2.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m6.1.1.3.3.1.cmml" xref="S2.SS3.p2.6.m6.1.1.3.3">superscript</csymbol><ci id="S2.SS3.p2.6.m6.1.1.3.3.2.cmml" xref="S2.SS3.p2.6.m6.1.1.3.3.2">𝑛</ci><cn type="integer" id="S2.SS3.p2.6.m6.1.1.3.3.3.cmml" xref="S2.SS3.p2.6.m6.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.6.m6.1c">c=g^{m}r^{n}\mod n^{2}</annotation></semantics></math> with random number <math id="S2.SS3.p2.7.m7.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S2.SS3.p2.7.m7.1a"><mi id="S2.SS3.p2.7.m7.1.1" xref="S2.SS3.p2.7.m7.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.7.m7.1b"><ci id="S2.SS3.p2.7.m7.1.1.cmml" xref="S2.SS3.p2.7.m7.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.7.m7.1c">r</annotation></semantics></math>, and decryption is performed by <math id="S2.SS3.p2.8.m8.1" class="ltx_Math" alttext="m=((c^{\lambda}\mod n^{2})-1)/n*\mu\mod n^{2}" display="inline"><semantics id="S2.SS3.p2.8.m8.1a"><mrow id="S2.SS3.p2.8.m8.1.1" xref="S2.SS3.p2.8.m8.1.1.cmml"><mi id="S2.SS3.p2.8.m8.1.1.3" xref="S2.SS3.p2.8.m8.1.1.3.cmml">m</mi><mo id="S2.SS3.p2.8.m8.1.1.2" xref="S2.SS3.p2.8.m8.1.1.2.cmml">=</mo><mrow id="S2.SS3.p2.8.m8.1.1.1" xref="S2.SS3.p2.8.m8.1.1.1.cmml"><mrow id="S2.SS3.p2.8.m8.1.1.1.1" xref="S2.SS3.p2.8.m8.1.1.1.1.cmml"><mrow id="S2.SS3.p2.8.m8.1.1.1.1.1" xref="S2.SS3.p2.8.m8.1.1.1.1.1.cmml"><mrow id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.2" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.2" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.cmml"><msup id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">c</mi><mi id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">λ</mi></msup><mo id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.cmml">mod</mo><msup id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">n</mi><mn id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msup></mrow><mo stretchy="false" id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.3" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.2" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.2.cmml">−</mo><mn id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.3" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.3" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS3.p2.8.m8.1.1.1.1.1.2" xref="S2.SS3.p2.8.m8.1.1.1.1.1.2.cmml">/</mo><mi id="S2.SS3.p2.8.m8.1.1.1.1.1.3" xref="S2.SS3.p2.8.m8.1.1.1.1.1.3.cmml">n</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S2.SS3.p2.8.m8.1.1.1.1.2" xref="S2.SS3.p2.8.m8.1.1.1.1.2.cmml">∗</mo><mi id="S2.SS3.p2.8.m8.1.1.1.1.3" xref="S2.SS3.p2.8.m8.1.1.1.1.3.cmml">μ</mi></mrow><mo id="S2.SS3.p2.8.m8.1.1.1.2" xref="S2.SS3.p2.8.m8.1.1.1.2.cmml">mod</mo><msup id="S2.SS3.p2.8.m8.1.1.1.3" xref="S2.SS3.p2.8.m8.1.1.1.3.cmml"><mi id="S2.SS3.p2.8.m8.1.1.1.3.2" xref="S2.SS3.p2.8.m8.1.1.1.3.2.cmml">n</mi><mn id="S2.SS3.p2.8.m8.1.1.1.3.3" xref="S2.SS3.p2.8.m8.1.1.1.3.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.8.m8.1b"><apply id="S2.SS3.p2.8.m8.1.1.cmml" xref="S2.SS3.p2.8.m8.1.1"><eq id="S2.SS3.p2.8.m8.1.1.2.cmml" xref="S2.SS3.p2.8.m8.1.1.2"></eq><ci id="S2.SS3.p2.8.m8.1.1.3.cmml" xref="S2.SS3.p2.8.m8.1.1.3">𝑚</ci><apply id="S2.SS3.p2.8.m8.1.1.1.cmml" xref="S2.SS3.p2.8.m8.1.1.1"><csymbol cd="latexml" id="S2.SS3.p2.8.m8.1.1.1.2.cmml" xref="S2.SS3.p2.8.m8.1.1.1.2">modulo</csymbol><apply id="S2.SS3.p2.8.m8.1.1.1.1.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1"><times id="S2.SS3.p2.8.m8.1.1.1.1.2.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.2"></times><apply id="S2.SS3.p2.8.m8.1.1.1.1.1.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.1"><divide id="S2.SS3.p2.8.m8.1.1.1.1.1.2.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.1.2"></divide><apply id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1"><minus id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.2"></minus><apply id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.1">modulo</csymbol><apply id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑐</ci><ci id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.2.3">𝜆</ci></apply><apply id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑛</ci><cn type="integer" id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.1.1.1.3.3">2</cn></apply></apply><cn type="integer" id="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.SS3.p2.8.m8.1.1.1.1.1.3.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.1.3">𝑛</ci></apply><ci id="S2.SS3.p2.8.m8.1.1.1.1.3.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.3">𝜇</ci></apply><apply id="S2.SS3.p2.8.m8.1.1.1.3.cmml" xref="S2.SS3.p2.8.m8.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p2.8.m8.1.1.1.3.1.cmml" xref="S2.SS3.p2.8.m8.1.1.1.3">superscript</csymbol><ci id="S2.SS3.p2.8.m8.1.1.1.3.2.cmml" xref="S2.SS3.p2.8.m8.1.1.1.3.2">𝑛</ci><cn type="integer" id="S2.SS3.p2.8.m8.1.1.1.3.3.cmml" xref="S2.SS3.p2.8.m8.1.1.1.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.8.m8.1c">m=((c^{\lambda}\mod n^{2})-1)/n*\mu\mod n^{2}</annotation></semantics></math>.</p>
</div>
<div id="S2.SS3.p3" class="ltx_para">
<p id="S2.SS3.p3.10" class="ltx_p">We can see from the formulation that the majority of the computation of the Paillier en/decryption is related to modular exponentiation (ModExp), which can be further decomposed to a series of ModMult operations. Hence, the execution of ModMult has a decisive effect on the overall performance. We choose the Montgomery ModMult algorithm<cite class="ltx_cite ltx_citemacro_cite">Montgomery (<a href="#bib.bib13" title="" class="ltx_ref">1985</a>)</cite> to perform this operation because it is FPGA-friendly, in that it disposes of the costly integer division. The Montgomery algorithm, shown in Algorithm <a href="#algorithm1" title="In 2.3 Paillier Homomorphic Encryption ‣ 2 Background ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, computes <math id="S2.SS3.p3.1.m1.1" class="ltx_Math" alttext="XY\cdot 2^{-l}\mod M" display="inline"><semantics id="S2.SS3.p3.1.m1.1a"><mrow id="S2.SS3.p3.1.m1.1.1" xref="S2.SS3.p3.1.m1.1.1.cmml"><mrow id="S2.SS3.p3.1.m1.1.1.2" xref="S2.SS3.p3.1.m1.1.1.2.cmml"><mrow id="S2.SS3.p3.1.m1.1.1.2.2" xref="S2.SS3.p3.1.m1.1.1.2.2.cmml"><mi id="S2.SS3.p3.1.m1.1.1.2.2.2" xref="S2.SS3.p3.1.m1.1.1.2.2.2.cmml">X</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p3.1.m1.1.1.2.2.1" xref="S2.SS3.p3.1.m1.1.1.2.2.1.cmml">​</mo><mi id="S2.SS3.p3.1.m1.1.1.2.2.3" xref="S2.SS3.p3.1.m1.1.1.2.2.3.cmml">Y</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S2.SS3.p3.1.m1.1.1.2.1" xref="S2.SS3.p3.1.m1.1.1.2.1.cmml">⋅</mo><msup id="S2.SS3.p3.1.m1.1.1.2.3" xref="S2.SS3.p3.1.m1.1.1.2.3.cmml"><mn id="S2.SS3.p3.1.m1.1.1.2.3.2" xref="S2.SS3.p3.1.m1.1.1.2.3.2.cmml">2</mn><mrow id="S2.SS3.p3.1.m1.1.1.2.3.3" xref="S2.SS3.p3.1.m1.1.1.2.3.3.cmml"><mo id="S2.SS3.p3.1.m1.1.1.2.3.3a" xref="S2.SS3.p3.1.m1.1.1.2.3.3.cmml">−</mo><mi id="S2.SS3.p3.1.m1.1.1.2.3.3.2" xref="S2.SS3.p3.1.m1.1.1.2.3.3.2.cmml">l</mi></mrow></msup></mrow><mo id="S2.SS3.p3.1.m1.1.1.1" xref="S2.SS3.p3.1.m1.1.1.1.cmml">mod</mo><mi id="S2.SS3.p3.1.m1.1.1.3" xref="S2.SS3.p3.1.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.m1.1b"><apply id="S2.SS3.p3.1.m1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1"><csymbol cd="latexml" id="S2.SS3.p3.1.m1.1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1.1">modulo</csymbol><apply id="S2.SS3.p3.1.m1.1.1.2.cmml" xref="S2.SS3.p3.1.m1.1.1.2"><ci id="S2.SS3.p3.1.m1.1.1.2.1.cmml" xref="S2.SS3.p3.1.m1.1.1.2.1">⋅</ci><apply id="S2.SS3.p3.1.m1.1.1.2.2.cmml" xref="S2.SS3.p3.1.m1.1.1.2.2"><times id="S2.SS3.p3.1.m1.1.1.2.2.1.cmml" xref="S2.SS3.p3.1.m1.1.1.2.2.1"></times><ci id="S2.SS3.p3.1.m1.1.1.2.2.2.cmml" xref="S2.SS3.p3.1.m1.1.1.2.2.2">𝑋</ci><ci id="S2.SS3.p3.1.m1.1.1.2.2.3.cmml" xref="S2.SS3.p3.1.m1.1.1.2.2.3">𝑌</ci></apply><apply id="S2.SS3.p3.1.m1.1.1.2.3.cmml" xref="S2.SS3.p3.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.1.1.2.3.1.cmml" xref="S2.SS3.p3.1.m1.1.1.2.3">superscript</csymbol><cn type="integer" id="S2.SS3.p3.1.m1.1.1.2.3.2.cmml" xref="S2.SS3.p3.1.m1.1.1.2.3.2">2</cn><apply id="S2.SS3.p3.1.m1.1.1.2.3.3.cmml" xref="S2.SS3.p3.1.m1.1.1.2.3.3"><minus id="S2.SS3.p3.1.m1.1.1.2.3.3.1.cmml" xref="S2.SS3.p3.1.m1.1.1.2.3.3"></minus><ci id="S2.SS3.p3.1.m1.1.1.2.3.3.2.cmml" xref="S2.SS3.p3.1.m1.1.1.2.3.3.2">𝑙</ci></apply></apply></apply><ci id="S2.SS3.p3.1.m1.1.1.3.cmml" xref="S2.SS3.p3.1.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.1.m1.1c">XY\cdot 2^{-l}\mod M</annotation></semantics></math> for <math id="S2.SS3.p3.2.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.SS3.p3.2.m2.1a"><mi id="S2.SS3.p3.2.m2.1.1" xref="S2.SS3.p3.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.2.m2.1b"><ci id="S2.SS3.p3.2.m2.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.2.m2.1c">l</annotation></semantics></math>-bit integers <math id="S2.SS3.p3.3.m3.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S2.SS3.p3.3.m3.1a"><mi id="S2.SS3.p3.3.m3.1.1" xref="S2.SS3.p3.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.3.m3.1b"><ci id="S2.SS3.p3.3.m3.1.1.cmml" xref="S2.SS3.p3.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.3.m3.1c">X</annotation></semantics></math>, <math id="S2.SS3.p3.4.m4.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S2.SS3.p3.4.m4.1a"><mi id="S2.SS3.p3.4.m4.1.1" xref="S2.SS3.p3.4.m4.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.4.m4.1b"><ci id="S2.SS3.p3.4.m4.1.1.cmml" xref="S2.SS3.p3.4.m4.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.4.m4.1c">Y</annotation></semantics></math> and <math id="S2.SS3.p3.5.m5.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S2.SS3.p3.5.m5.1a"><mi id="S2.SS3.p3.5.m5.1.1" xref="S2.SS3.p3.5.m5.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.5.m5.1b"><ci id="S2.SS3.p3.5.m5.1.1.cmml" xref="S2.SS3.p3.5.m5.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.5.m5.1c">M</annotation></semantics></math>. It divides integers into <math id="S2.SS3.p3.6.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS3.p3.6.m6.1a"><mi id="S2.SS3.p3.6.m6.1.1" xref="S2.SS3.p3.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.6.m6.1b"><ci id="S2.SS3.p3.6.m6.1.1.cmml" xref="S2.SS3.p3.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.6.m6.1c">k</annotation></semantics></math>-bit words. The body of the algorithm is a two-level loop, where each outer iteration (line 2-8) aims to compute an intermediate result <math id="S2.SS3.p3.7.m7.1" class="ltx_Math" alttext="S_{i}=X\cdot Y^{i}\cdot 2^{k}\mod M" display="inline"><semantics id="S2.SS3.p3.7.m7.1a"><mrow id="S2.SS3.p3.7.m7.1.1" xref="S2.SS3.p3.7.m7.1.1.cmml"><msub id="S2.SS3.p3.7.m7.1.1.2" xref="S2.SS3.p3.7.m7.1.1.2.cmml"><mi id="S2.SS3.p3.7.m7.1.1.2.2" xref="S2.SS3.p3.7.m7.1.1.2.2.cmml">S</mi><mi id="S2.SS3.p3.7.m7.1.1.2.3" xref="S2.SS3.p3.7.m7.1.1.2.3.cmml">i</mi></msub><mo id="S2.SS3.p3.7.m7.1.1.1" xref="S2.SS3.p3.7.m7.1.1.1.cmml">=</mo><mrow id="S2.SS3.p3.7.m7.1.1.3" xref="S2.SS3.p3.7.m7.1.1.3.cmml"><mrow id="S2.SS3.p3.7.m7.1.1.3.2" xref="S2.SS3.p3.7.m7.1.1.3.2.cmml"><mi id="S2.SS3.p3.7.m7.1.1.3.2.2" xref="S2.SS3.p3.7.m7.1.1.3.2.2.cmml">X</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS3.p3.7.m7.1.1.3.2.1" xref="S2.SS3.p3.7.m7.1.1.3.2.1.cmml">⋅</mo><msup id="S2.SS3.p3.7.m7.1.1.3.2.3" xref="S2.SS3.p3.7.m7.1.1.3.2.3.cmml"><mi id="S2.SS3.p3.7.m7.1.1.3.2.3.2" xref="S2.SS3.p3.7.m7.1.1.3.2.3.2.cmml">Y</mi><mi id="S2.SS3.p3.7.m7.1.1.3.2.3.3" xref="S2.SS3.p3.7.m7.1.1.3.2.3.3.cmml">i</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S2.SS3.p3.7.m7.1.1.3.2.1a" xref="S2.SS3.p3.7.m7.1.1.3.2.1.cmml">⋅</mo><msup id="S2.SS3.p3.7.m7.1.1.3.2.4" xref="S2.SS3.p3.7.m7.1.1.3.2.4.cmml"><mn id="S2.SS3.p3.7.m7.1.1.3.2.4.2" xref="S2.SS3.p3.7.m7.1.1.3.2.4.2.cmml">2</mn><mi id="S2.SS3.p3.7.m7.1.1.3.2.4.3" xref="S2.SS3.p3.7.m7.1.1.3.2.4.3.cmml">k</mi></msup></mrow><mo id="S2.SS3.p3.7.m7.1.1.3.1" xref="S2.SS3.p3.7.m7.1.1.3.1.cmml">mod</mo><mi id="S2.SS3.p3.7.m7.1.1.3.3" xref="S2.SS3.p3.7.m7.1.1.3.3.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.7.m7.1b"><apply id="S2.SS3.p3.7.m7.1.1.cmml" xref="S2.SS3.p3.7.m7.1.1"><eq id="S2.SS3.p3.7.m7.1.1.1.cmml" xref="S2.SS3.p3.7.m7.1.1.1"></eq><apply id="S2.SS3.p3.7.m7.1.1.2.cmml" xref="S2.SS3.p3.7.m7.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p3.7.m7.1.1.2.1.cmml" xref="S2.SS3.p3.7.m7.1.1.2">subscript</csymbol><ci id="S2.SS3.p3.7.m7.1.1.2.2.cmml" xref="S2.SS3.p3.7.m7.1.1.2.2">𝑆</ci><ci id="S2.SS3.p3.7.m7.1.1.2.3.cmml" xref="S2.SS3.p3.7.m7.1.1.2.3">𝑖</ci></apply><apply id="S2.SS3.p3.7.m7.1.1.3.cmml" xref="S2.SS3.p3.7.m7.1.1.3"><csymbol cd="latexml" id="S2.SS3.p3.7.m7.1.1.3.1.cmml" xref="S2.SS3.p3.7.m7.1.1.3.1">modulo</csymbol><apply id="S2.SS3.p3.7.m7.1.1.3.2.cmml" xref="S2.SS3.p3.7.m7.1.1.3.2"><ci id="S2.SS3.p3.7.m7.1.1.3.2.1.cmml" xref="S2.SS3.p3.7.m7.1.1.3.2.1">⋅</ci><ci id="S2.SS3.p3.7.m7.1.1.3.2.2.cmml" xref="S2.SS3.p3.7.m7.1.1.3.2.2">𝑋</ci><apply id="S2.SS3.p3.7.m7.1.1.3.2.3.cmml" xref="S2.SS3.p3.7.m7.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.SS3.p3.7.m7.1.1.3.2.3.1.cmml" xref="S2.SS3.p3.7.m7.1.1.3.2.3">superscript</csymbol><ci id="S2.SS3.p3.7.m7.1.1.3.2.3.2.cmml" xref="S2.SS3.p3.7.m7.1.1.3.2.3.2">𝑌</ci><ci id="S2.SS3.p3.7.m7.1.1.3.2.3.3.cmml" xref="S2.SS3.p3.7.m7.1.1.3.2.3.3">𝑖</ci></apply><apply id="S2.SS3.p3.7.m7.1.1.3.2.4.cmml" xref="S2.SS3.p3.7.m7.1.1.3.2.4"><csymbol cd="ambiguous" id="S2.SS3.p3.7.m7.1.1.3.2.4.1.cmml" xref="S2.SS3.p3.7.m7.1.1.3.2.4">superscript</csymbol><cn type="integer" id="S2.SS3.p3.7.m7.1.1.3.2.4.2.cmml" xref="S2.SS3.p3.7.m7.1.1.3.2.4.2">2</cn><ci id="S2.SS3.p3.7.m7.1.1.3.2.4.3.cmml" xref="S2.SS3.p3.7.m7.1.1.3.2.4.3">𝑘</ci></apply></apply><ci id="S2.SS3.p3.7.m7.1.1.3.3.cmml" xref="S2.SS3.p3.7.m7.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.7.m7.1c">S_{i}=X\cdot Y^{i}\cdot 2^{k}\mod M</annotation></semantics></math> for the <math id="S2.SS3.p3.8.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS3.p3.8.m8.1a"><mi id="S2.SS3.p3.8.m8.1.1" xref="S2.SS3.p3.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.8.m8.1b"><ci id="S2.SS3.p3.8.m8.1.1.cmml" xref="S2.SS3.p3.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.8.m8.1c">i</annotation></semantics></math>th word of <math id="S2.SS3.p3.9.m9.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S2.SS3.p3.9.m9.1a"><mi id="S2.SS3.p3.9.m9.1.1" xref="S2.SS3.p3.9.m9.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.9.m9.1b"><ci id="S2.SS3.p3.9.m9.1.1.cmml" xref="S2.SS3.p3.9.m9.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.9.m9.1c">Y</annotation></semantics></math>, and it further decomposes the computation by each word of <math id="S2.SS3.p3.10.m10.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S2.SS3.p3.10.m10.1a"><mi id="S2.SS3.p3.10.m10.1.1" xref="S2.SS3.p3.10.m10.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.10.m10.1b"><ci id="S2.SS3.p3.10.m10.1.1.cmml" xref="S2.SS3.p3.10.m10.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.10.m10.1c">X</annotation></semantics></math> and forms the inner loop (line 4-6).</p>
</div>
<figure id="algorithm1" class="ltx_float ltx_algorithm">
<div id="algorithm1.14" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.4.4" class="ltx_listingline">
<span id="algorithm1.4.4.1" class="ltx_text"><span id="algorithm1.4.4.1.1" class="ltx_text ltx_font_bold">Input:</span> </span><math id="algorithm1.1.1.m1.1" class="ltx_Math" alttext="X=\sum_{j=0}^{l/k-1}X^{j}\cdot 2^{jk}" display="inline"><semantics id="algorithm1.1.1.m1.1a"><mrow id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml"><mi id="algorithm1.1.1.m1.1.1.2" xref="algorithm1.1.1.m1.1.1.2.cmml">X</mi><mo rspace="0.111em" id="algorithm1.1.1.m1.1.1.1" xref="algorithm1.1.1.m1.1.1.1.cmml">=</mo><mrow id="algorithm1.1.1.m1.1.1.3" xref="algorithm1.1.1.m1.1.1.3.cmml"><msubsup id="algorithm1.1.1.m1.1.1.3.1" xref="algorithm1.1.1.m1.1.1.3.1.cmml"><mo id="algorithm1.1.1.m1.1.1.3.1.2.2" xref="algorithm1.1.1.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="algorithm1.1.1.m1.1.1.3.1.2.3" xref="algorithm1.1.1.m1.1.1.3.1.2.3.cmml"><mi id="algorithm1.1.1.m1.1.1.3.1.2.3.2" xref="algorithm1.1.1.m1.1.1.3.1.2.3.2.cmml">j</mi><mo id="algorithm1.1.1.m1.1.1.3.1.2.3.1" xref="algorithm1.1.1.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="algorithm1.1.1.m1.1.1.3.1.2.3.3" xref="algorithm1.1.1.m1.1.1.3.1.2.3.3.cmml">0</mn></mrow><mrow id="algorithm1.1.1.m1.1.1.3.1.3" xref="algorithm1.1.1.m1.1.1.3.1.3.cmml"><mrow id="algorithm1.1.1.m1.1.1.3.1.3.2" xref="algorithm1.1.1.m1.1.1.3.1.3.2.cmml"><mi id="algorithm1.1.1.m1.1.1.3.1.3.2.2" xref="algorithm1.1.1.m1.1.1.3.1.3.2.2.cmml">l</mi><mo id="algorithm1.1.1.m1.1.1.3.1.3.2.1" xref="algorithm1.1.1.m1.1.1.3.1.3.2.1.cmml">/</mo><mi id="algorithm1.1.1.m1.1.1.3.1.3.2.3" xref="algorithm1.1.1.m1.1.1.3.1.3.2.3.cmml">k</mi></mrow><mo id="algorithm1.1.1.m1.1.1.3.1.3.1" xref="algorithm1.1.1.m1.1.1.3.1.3.1.cmml">−</mo><mn id="algorithm1.1.1.m1.1.1.3.1.3.3" xref="algorithm1.1.1.m1.1.1.3.1.3.3.cmml">1</mn></mrow></msubsup><mrow id="algorithm1.1.1.m1.1.1.3.2" xref="algorithm1.1.1.m1.1.1.3.2.cmml"><msup id="algorithm1.1.1.m1.1.1.3.2.2" xref="algorithm1.1.1.m1.1.1.3.2.2.cmml"><mi id="algorithm1.1.1.m1.1.1.3.2.2.2" xref="algorithm1.1.1.m1.1.1.3.2.2.2.cmml">X</mi><mi id="algorithm1.1.1.m1.1.1.3.2.2.3" xref="algorithm1.1.1.m1.1.1.3.2.2.3.cmml">j</mi></msup><mo lspace="0.222em" rspace="0.222em" id="algorithm1.1.1.m1.1.1.3.2.1" xref="algorithm1.1.1.m1.1.1.3.2.1.cmml">⋅</mo><msup id="algorithm1.1.1.m1.1.1.3.2.3" xref="algorithm1.1.1.m1.1.1.3.2.3.cmml"><mn id="algorithm1.1.1.m1.1.1.3.2.3.2" xref="algorithm1.1.1.m1.1.1.3.2.3.2.cmml">2</mn><mrow id="algorithm1.1.1.m1.1.1.3.2.3.3" xref="algorithm1.1.1.m1.1.1.3.2.3.3.cmml"><mi id="algorithm1.1.1.m1.1.1.3.2.3.3.2" xref="algorithm1.1.1.m1.1.1.3.2.3.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="algorithm1.1.1.m1.1.1.3.2.3.3.1" xref="algorithm1.1.1.m1.1.1.3.2.3.3.1.cmml">​</mo><mi id="algorithm1.1.1.m1.1.1.3.2.3.3.3" xref="algorithm1.1.1.m1.1.1.3.2.3.3.3.cmml">k</mi></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.1b"><apply id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1"><eq id="algorithm1.1.1.m1.1.1.1.cmml" xref="algorithm1.1.1.m1.1.1.1"></eq><ci id="algorithm1.1.1.m1.1.1.2.cmml" xref="algorithm1.1.1.m1.1.1.2">𝑋</ci><apply id="algorithm1.1.1.m1.1.1.3.cmml" xref="algorithm1.1.1.m1.1.1.3"><apply id="algorithm1.1.1.m1.1.1.3.1.cmml" xref="algorithm1.1.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.1.1.3.1.1.cmml" xref="algorithm1.1.1.m1.1.1.3.1">superscript</csymbol><apply id="algorithm1.1.1.m1.1.1.3.1.2.cmml" xref="algorithm1.1.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.1.1.3.1.2.1.cmml" xref="algorithm1.1.1.m1.1.1.3.1">subscript</csymbol><sum id="algorithm1.1.1.m1.1.1.3.1.2.2.cmml" xref="algorithm1.1.1.m1.1.1.3.1.2.2"></sum><apply id="algorithm1.1.1.m1.1.1.3.1.2.3.cmml" xref="algorithm1.1.1.m1.1.1.3.1.2.3"><eq id="algorithm1.1.1.m1.1.1.3.1.2.3.1.cmml" xref="algorithm1.1.1.m1.1.1.3.1.2.3.1"></eq><ci id="algorithm1.1.1.m1.1.1.3.1.2.3.2.cmml" xref="algorithm1.1.1.m1.1.1.3.1.2.3.2">𝑗</ci><cn type="integer" id="algorithm1.1.1.m1.1.1.3.1.2.3.3.cmml" xref="algorithm1.1.1.m1.1.1.3.1.2.3.3">0</cn></apply></apply><apply id="algorithm1.1.1.m1.1.1.3.1.3.cmml" xref="algorithm1.1.1.m1.1.1.3.1.3"><minus id="algorithm1.1.1.m1.1.1.3.1.3.1.cmml" xref="algorithm1.1.1.m1.1.1.3.1.3.1"></minus><apply id="algorithm1.1.1.m1.1.1.3.1.3.2.cmml" xref="algorithm1.1.1.m1.1.1.3.1.3.2"><divide id="algorithm1.1.1.m1.1.1.3.1.3.2.1.cmml" xref="algorithm1.1.1.m1.1.1.3.1.3.2.1"></divide><ci id="algorithm1.1.1.m1.1.1.3.1.3.2.2.cmml" xref="algorithm1.1.1.m1.1.1.3.1.3.2.2">𝑙</ci><ci id="algorithm1.1.1.m1.1.1.3.1.3.2.3.cmml" xref="algorithm1.1.1.m1.1.1.3.1.3.2.3">𝑘</ci></apply><cn type="integer" id="algorithm1.1.1.m1.1.1.3.1.3.3.cmml" xref="algorithm1.1.1.m1.1.1.3.1.3.3">1</cn></apply></apply><apply id="algorithm1.1.1.m1.1.1.3.2.cmml" xref="algorithm1.1.1.m1.1.1.3.2"><ci id="algorithm1.1.1.m1.1.1.3.2.1.cmml" xref="algorithm1.1.1.m1.1.1.3.2.1">⋅</ci><apply id="algorithm1.1.1.m1.1.1.3.2.2.cmml" xref="algorithm1.1.1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.1.1.3.2.2.1.cmml" xref="algorithm1.1.1.m1.1.1.3.2.2">superscript</csymbol><ci id="algorithm1.1.1.m1.1.1.3.2.2.2.cmml" xref="algorithm1.1.1.m1.1.1.3.2.2.2">𝑋</ci><ci id="algorithm1.1.1.m1.1.1.3.2.2.3.cmml" xref="algorithm1.1.1.m1.1.1.3.2.2.3">𝑗</ci></apply><apply id="algorithm1.1.1.m1.1.1.3.2.3.cmml" xref="algorithm1.1.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.1.1.3.2.3.1.cmml" xref="algorithm1.1.1.m1.1.1.3.2.3">superscript</csymbol><cn type="integer" id="algorithm1.1.1.m1.1.1.3.2.3.2.cmml" xref="algorithm1.1.1.m1.1.1.3.2.3.2">2</cn><apply id="algorithm1.1.1.m1.1.1.3.2.3.3.cmml" xref="algorithm1.1.1.m1.1.1.3.2.3.3"><times id="algorithm1.1.1.m1.1.1.3.2.3.3.1.cmml" xref="algorithm1.1.1.m1.1.1.3.2.3.3.1"></times><ci id="algorithm1.1.1.m1.1.1.3.2.3.3.2.cmml" xref="algorithm1.1.1.m1.1.1.3.2.3.3.2">𝑗</ci><ci id="algorithm1.1.1.m1.1.1.3.2.3.3.3.cmml" xref="algorithm1.1.1.m1.1.1.3.2.3.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.1c">X=\sum_{j=0}^{l/k-1}X^{j}\cdot 2^{jk}</annotation></semantics></math>, <math id="algorithm1.2.2.m2.1" class="ltx_Math" alttext="Y=\sum_{j=0}^{l/k-1}Y^{j}\cdot 2^{jk}" display="inline"><semantics id="algorithm1.2.2.m2.1a"><mrow id="algorithm1.2.2.m2.1.1" xref="algorithm1.2.2.m2.1.1.cmml"><mi id="algorithm1.2.2.m2.1.1.2" xref="algorithm1.2.2.m2.1.1.2.cmml">Y</mi><mo rspace="0.111em" id="algorithm1.2.2.m2.1.1.1" xref="algorithm1.2.2.m2.1.1.1.cmml">=</mo><mrow id="algorithm1.2.2.m2.1.1.3" xref="algorithm1.2.2.m2.1.1.3.cmml"><msubsup id="algorithm1.2.2.m2.1.1.3.1" xref="algorithm1.2.2.m2.1.1.3.1.cmml"><mo id="algorithm1.2.2.m2.1.1.3.1.2.2" xref="algorithm1.2.2.m2.1.1.3.1.2.2.cmml">∑</mo><mrow id="algorithm1.2.2.m2.1.1.3.1.2.3" xref="algorithm1.2.2.m2.1.1.3.1.2.3.cmml"><mi id="algorithm1.2.2.m2.1.1.3.1.2.3.2" xref="algorithm1.2.2.m2.1.1.3.1.2.3.2.cmml">j</mi><mo id="algorithm1.2.2.m2.1.1.3.1.2.3.1" xref="algorithm1.2.2.m2.1.1.3.1.2.3.1.cmml">=</mo><mn id="algorithm1.2.2.m2.1.1.3.1.2.3.3" xref="algorithm1.2.2.m2.1.1.3.1.2.3.3.cmml">0</mn></mrow><mrow id="algorithm1.2.2.m2.1.1.3.1.3" xref="algorithm1.2.2.m2.1.1.3.1.3.cmml"><mrow id="algorithm1.2.2.m2.1.1.3.1.3.2" xref="algorithm1.2.2.m2.1.1.3.1.3.2.cmml"><mi id="algorithm1.2.2.m2.1.1.3.1.3.2.2" xref="algorithm1.2.2.m2.1.1.3.1.3.2.2.cmml">l</mi><mo id="algorithm1.2.2.m2.1.1.3.1.3.2.1" xref="algorithm1.2.2.m2.1.1.3.1.3.2.1.cmml">/</mo><mi id="algorithm1.2.2.m2.1.1.3.1.3.2.3" xref="algorithm1.2.2.m2.1.1.3.1.3.2.3.cmml">k</mi></mrow><mo id="algorithm1.2.2.m2.1.1.3.1.3.1" xref="algorithm1.2.2.m2.1.1.3.1.3.1.cmml">−</mo><mn id="algorithm1.2.2.m2.1.1.3.1.3.3" xref="algorithm1.2.2.m2.1.1.3.1.3.3.cmml">1</mn></mrow></msubsup><mrow id="algorithm1.2.2.m2.1.1.3.2" xref="algorithm1.2.2.m2.1.1.3.2.cmml"><msup id="algorithm1.2.2.m2.1.1.3.2.2" xref="algorithm1.2.2.m2.1.1.3.2.2.cmml"><mi id="algorithm1.2.2.m2.1.1.3.2.2.2" xref="algorithm1.2.2.m2.1.1.3.2.2.2.cmml">Y</mi><mi id="algorithm1.2.2.m2.1.1.3.2.2.3" xref="algorithm1.2.2.m2.1.1.3.2.2.3.cmml">j</mi></msup><mo lspace="0.222em" rspace="0.222em" id="algorithm1.2.2.m2.1.1.3.2.1" xref="algorithm1.2.2.m2.1.1.3.2.1.cmml">⋅</mo><msup id="algorithm1.2.2.m2.1.1.3.2.3" xref="algorithm1.2.2.m2.1.1.3.2.3.cmml"><mn id="algorithm1.2.2.m2.1.1.3.2.3.2" xref="algorithm1.2.2.m2.1.1.3.2.3.2.cmml">2</mn><mrow id="algorithm1.2.2.m2.1.1.3.2.3.3" xref="algorithm1.2.2.m2.1.1.3.2.3.3.cmml"><mi id="algorithm1.2.2.m2.1.1.3.2.3.3.2" xref="algorithm1.2.2.m2.1.1.3.2.3.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="algorithm1.2.2.m2.1.1.3.2.3.3.1" xref="algorithm1.2.2.m2.1.1.3.2.3.3.1.cmml">​</mo><mi id="algorithm1.2.2.m2.1.1.3.2.3.3.3" xref="algorithm1.2.2.m2.1.1.3.2.3.3.3.cmml">k</mi></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m2.1b"><apply id="algorithm1.2.2.m2.1.1.cmml" xref="algorithm1.2.2.m2.1.1"><eq id="algorithm1.2.2.m2.1.1.1.cmml" xref="algorithm1.2.2.m2.1.1.1"></eq><ci id="algorithm1.2.2.m2.1.1.2.cmml" xref="algorithm1.2.2.m2.1.1.2">𝑌</ci><apply id="algorithm1.2.2.m2.1.1.3.cmml" xref="algorithm1.2.2.m2.1.1.3"><apply id="algorithm1.2.2.m2.1.1.3.1.cmml" xref="algorithm1.2.2.m2.1.1.3.1"><csymbol cd="ambiguous" id="algorithm1.2.2.m2.1.1.3.1.1.cmml" xref="algorithm1.2.2.m2.1.1.3.1">superscript</csymbol><apply id="algorithm1.2.2.m2.1.1.3.1.2.cmml" xref="algorithm1.2.2.m2.1.1.3.1"><csymbol cd="ambiguous" id="algorithm1.2.2.m2.1.1.3.1.2.1.cmml" xref="algorithm1.2.2.m2.1.1.3.1">subscript</csymbol><sum id="algorithm1.2.2.m2.1.1.3.1.2.2.cmml" xref="algorithm1.2.2.m2.1.1.3.1.2.2"></sum><apply id="algorithm1.2.2.m2.1.1.3.1.2.3.cmml" xref="algorithm1.2.2.m2.1.1.3.1.2.3"><eq id="algorithm1.2.2.m2.1.1.3.1.2.3.1.cmml" xref="algorithm1.2.2.m2.1.1.3.1.2.3.1"></eq><ci id="algorithm1.2.2.m2.1.1.3.1.2.3.2.cmml" xref="algorithm1.2.2.m2.1.1.3.1.2.3.2">𝑗</ci><cn type="integer" id="algorithm1.2.2.m2.1.1.3.1.2.3.3.cmml" xref="algorithm1.2.2.m2.1.1.3.1.2.3.3">0</cn></apply></apply><apply id="algorithm1.2.2.m2.1.1.3.1.3.cmml" xref="algorithm1.2.2.m2.1.1.3.1.3"><minus id="algorithm1.2.2.m2.1.1.3.1.3.1.cmml" xref="algorithm1.2.2.m2.1.1.3.1.3.1"></minus><apply id="algorithm1.2.2.m2.1.1.3.1.3.2.cmml" xref="algorithm1.2.2.m2.1.1.3.1.3.2"><divide id="algorithm1.2.2.m2.1.1.3.1.3.2.1.cmml" xref="algorithm1.2.2.m2.1.1.3.1.3.2.1"></divide><ci id="algorithm1.2.2.m2.1.1.3.1.3.2.2.cmml" xref="algorithm1.2.2.m2.1.1.3.1.3.2.2">𝑙</ci><ci id="algorithm1.2.2.m2.1.1.3.1.3.2.3.cmml" xref="algorithm1.2.2.m2.1.1.3.1.3.2.3">𝑘</ci></apply><cn type="integer" id="algorithm1.2.2.m2.1.1.3.1.3.3.cmml" xref="algorithm1.2.2.m2.1.1.3.1.3.3">1</cn></apply></apply><apply id="algorithm1.2.2.m2.1.1.3.2.cmml" xref="algorithm1.2.2.m2.1.1.3.2"><ci id="algorithm1.2.2.m2.1.1.3.2.1.cmml" xref="algorithm1.2.2.m2.1.1.3.2.1">⋅</ci><apply id="algorithm1.2.2.m2.1.1.3.2.2.cmml" xref="algorithm1.2.2.m2.1.1.3.2.2"><csymbol cd="ambiguous" id="algorithm1.2.2.m2.1.1.3.2.2.1.cmml" xref="algorithm1.2.2.m2.1.1.3.2.2">superscript</csymbol><ci id="algorithm1.2.2.m2.1.1.3.2.2.2.cmml" xref="algorithm1.2.2.m2.1.1.3.2.2.2">𝑌</ci><ci id="algorithm1.2.2.m2.1.1.3.2.2.3.cmml" xref="algorithm1.2.2.m2.1.1.3.2.2.3">𝑗</ci></apply><apply id="algorithm1.2.2.m2.1.1.3.2.3.cmml" xref="algorithm1.2.2.m2.1.1.3.2.3"><csymbol cd="ambiguous" id="algorithm1.2.2.m2.1.1.3.2.3.1.cmml" xref="algorithm1.2.2.m2.1.1.3.2.3">superscript</csymbol><cn type="integer" id="algorithm1.2.2.m2.1.1.3.2.3.2.cmml" xref="algorithm1.2.2.m2.1.1.3.2.3.2">2</cn><apply id="algorithm1.2.2.m2.1.1.3.2.3.3.cmml" xref="algorithm1.2.2.m2.1.1.3.2.3.3"><times id="algorithm1.2.2.m2.1.1.3.2.3.3.1.cmml" xref="algorithm1.2.2.m2.1.1.3.2.3.3.1"></times><ci id="algorithm1.2.2.m2.1.1.3.2.3.3.2.cmml" xref="algorithm1.2.2.m2.1.1.3.2.3.3.2">𝑗</ci><ci id="algorithm1.2.2.m2.1.1.3.2.3.3.3.cmml" xref="algorithm1.2.2.m2.1.1.3.2.3.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m2.1c">Y=\sum_{j=0}^{l/k-1}Y^{j}\cdot 2^{jk}</annotation></semantics></math>, <math id="algorithm1.3.3.m3.1" class="ltx_Math" alttext="M=\sum_{j=0}^{l/k-1}M^{j}\cdot 2^{jk}" display="inline"><semantics id="algorithm1.3.3.m3.1a"><mrow id="algorithm1.3.3.m3.1.1" xref="algorithm1.3.3.m3.1.1.cmml"><mi id="algorithm1.3.3.m3.1.1.2" xref="algorithm1.3.3.m3.1.1.2.cmml">M</mi><mo rspace="0.111em" id="algorithm1.3.3.m3.1.1.1" xref="algorithm1.3.3.m3.1.1.1.cmml">=</mo><mrow id="algorithm1.3.3.m3.1.1.3" xref="algorithm1.3.3.m3.1.1.3.cmml"><msubsup id="algorithm1.3.3.m3.1.1.3.1" xref="algorithm1.3.3.m3.1.1.3.1.cmml"><mo id="algorithm1.3.3.m3.1.1.3.1.2.2" xref="algorithm1.3.3.m3.1.1.3.1.2.2.cmml">∑</mo><mrow id="algorithm1.3.3.m3.1.1.3.1.2.3" xref="algorithm1.3.3.m3.1.1.3.1.2.3.cmml"><mi id="algorithm1.3.3.m3.1.1.3.1.2.3.2" xref="algorithm1.3.3.m3.1.1.3.1.2.3.2.cmml">j</mi><mo id="algorithm1.3.3.m3.1.1.3.1.2.3.1" xref="algorithm1.3.3.m3.1.1.3.1.2.3.1.cmml">=</mo><mn id="algorithm1.3.3.m3.1.1.3.1.2.3.3" xref="algorithm1.3.3.m3.1.1.3.1.2.3.3.cmml">0</mn></mrow><mrow id="algorithm1.3.3.m3.1.1.3.1.3" xref="algorithm1.3.3.m3.1.1.3.1.3.cmml"><mrow id="algorithm1.3.3.m3.1.1.3.1.3.2" xref="algorithm1.3.3.m3.1.1.3.1.3.2.cmml"><mi id="algorithm1.3.3.m3.1.1.3.1.3.2.2" xref="algorithm1.3.3.m3.1.1.3.1.3.2.2.cmml">l</mi><mo id="algorithm1.3.3.m3.1.1.3.1.3.2.1" xref="algorithm1.3.3.m3.1.1.3.1.3.2.1.cmml">/</mo><mi id="algorithm1.3.3.m3.1.1.3.1.3.2.3" xref="algorithm1.3.3.m3.1.1.3.1.3.2.3.cmml">k</mi></mrow><mo id="algorithm1.3.3.m3.1.1.3.1.3.1" xref="algorithm1.3.3.m3.1.1.3.1.3.1.cmml">−</mo><mn id="algorithm1.3.3.m3.1.1.3.1.3.3" xref="algorithm1.3.3.m3.1.1.3.1.3.3.cmml">1</mn></mrow></msubsup><mrow id="algorithm1.3.3.m3.1.1.3.2" xref="algorithm1.3.3.m3.1.1.3.2.cmml"><msup id="algorithm1.3.3.m3.1.1.3.2.2" xref="algorithm1.3.3.m3.1.1.3.2.2.cmml"><mi id="algorithm1.3.3.m3.1.1.3.2.2.2" xref="algorithm1.3.3.m3.1.1.3.2.2.2.cmml">M</mi><mi id="algorithm1.3.3.m3.1.1.3.2.2.3" xref="algorithm1.3.3.m3.1.1.3.2.2.3.cmml">j</mi></msup><mo lspace="0.222em" rspace="0.222em" id="algorithm1.3.3.m3.1.1.3.2.1" xref="algorithm1.3.3.m3.1.1.3.2.1.cmml">⋅</mo><msup id="algorithm1.3.3.m3.1.1.3.2.3" xref="algorithm1.3.3.m3.1.1.3.2.3.cmml"><mn id="algorithm1.3.3.m3.1.1.3.2.3.2" xref="algorithm1.3.3.m3.1.1.3.2.3.2.cmml">2</mn><mrow id="algorithm1.3.3.m3.1.1.3.2.3.3" xref="algorithm1.3.3.m3.1.1.3.2.3.3.cmml"><mi id="algorithm1.3.3.m3.1.1.3.2.3.3.2" xref="algorithm1.3.3.m3.1.1.3.2.3.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="algorithm1.3.3.m3.1.1.3.2.3.3.1" xref="algorithm1.3.3.m3.1.1.3.2.3.3.1.cmml">​</mo><mi id="algorithm1.3.3.m3.1.1.3.2.3.3.3" xref="algorithm1.3.3.m3.1.1.3.2.3.3.3.cmml">k</mi></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m3.1b"><apply id="algorithm1.3.3.m3.1.1.cmml" xref="algorithm1.3.3.m3.1.1"><eq id="algorithm1.3.3.m3.1.1.1.cmml" xref="algorithm1.3.3.m3.1.1.1"></eq><ci id="algorithm1.3.3.m3.1.1.2.cmml" xref="algorithm1.3.3.m3.1.1.2">𝑀</ci><apply id="algorithm1.3.3.m3.1.1.3.cmml" xref="algorithm1.3.3.m3.1.1.3"><apply id="algorithm1.3.3.m3.1.1.3.1.cmml" xref="algorithm1.3.3.m3.1.1.3.1"><csymbol cd="ambiguous" id="algorithm1.3.3.m3.1.1.3.1.1.cmml" xref="algorithm1.3.3.m3.1.1.3.1">superscript</csymbol><apply id="algorithm1.3.3.m3.1.1.3.1.2.cmml" xref="algorithm1.3.3.m3.1.1.3.1"><csymbol cd="ambiguous" id="algorithm1.3.3.m3.1.1.3.1.2.1.cmml" xref="algorithm1.3.3.m3.1.1.3.1">subscript</csymbol><sum id="algorithm1.3.3.m3.1.1.3.1.2.2.cmml" xref="algorithm1.3.3.m3.1.1.3.1.2.2"></sum><apply id="algorithm1.3.3.m3.1.1.3.1.2.3.cmml" xref="algorithm1.3.3.m3.1.1.3.1.2.3"><eq id="algorithm1.3.3.m3.1.1.3.1.2.3.1.cmml" xref="algorithm1.3.3.m3.1.1.3.1.2.3.1"></eq><ci id="algorithm1.3.3.m3.1.1.3.1.2.3.2.cmml" xref="algorithm1.3.3.m3.1.1.3.1.2.3.2">𝑗</ci><cn type="integer" id="algorithm1.3.3.m3.1.1.3.1.2.3.3.cmml" xref="algorithm1.3.3.m3.1.1.3.1.2.3.3">0</cn></apply></apply><apply id="algorithm1.3.3.m3.1.1.3.1.3.cmml" xref="algorithm1.3.3.m3.1.1.3.1.3"><minus id="algorithm1.3.3.m3.1.1.3.1.3.1.cmml" xref="algorithm1.3.3.m3.1.1.3.1.3.1"></minus><apply id="algorithm1.3.3.m3.1.1.3.1.3.2.cmml" xref="algorithm1.3.3.m3.1.1.3.1.3.2"><divide id="algorithm1.3.3.m3.1.1.3.1.3.2.1.cmml" xref="algorithm1.3.3.m3.1.1.3.1.3.2.1"></divide><ci id="algorithm1.3.3.m3.1.1.3.1.3.2.2.cmml" xref="algorithm1.3.3.m3.1.1.3.1.3.2.2">𝑙</ci><ci id="algorithm1.3.3.m3.1.1.3.1.3.2.3.cmml" xref="algorithm1.3.3.m3.1.1.3.1.3.2.3">𝑘</ci></apply><cn type="integer" id="algorithm1.3.3.m3.1.1.3.1.3.3.cmml" xref="algorithm1.3.3.m3.1.1.3.1.3.3">1</cn></apply></apply><apply id="algorithm1.3.3.m3.1.1.3.2.cmml" xref="algorithm1.3.3.m3.1.1.3.2"><ci id="algorithm1.3.3.m3.1.1.3.2.1.cmml" xref="algorithm1.3.3.m3.1.1.3.2.1">⋅</ci><apply id="algorithm1.3.3.m3.1.1.3.2.2.cmml" xref="algorithm1.3.3.m3.1.1.3.2.2"><csymbol cd="ambiguous" id="algorithm1.3.3.m3.1.1.3.2.2.1.cmml" xref="algorithm1.3.3.m3.1.1.3.2.2">superscript</csymbol><ci id="algorithm1.3.3.m3.1.1.3.2.2.2.cmml" xref="algorithm1.3.3.m3.1.1.3.2.2.2">𝑀</ci><ci id="algorithm1.3.3.m3.1.1.3.2.2.3.cmml" xref="algorithm1.3.3.m3.1.1.3.2.2.3">𝑗</ci></apply><apply id="algorithm1.3.3.m3.1.1.3.2.3.cmml" xref="algorithm1.3.3.m3.1.1.3.2.3"><csymbol cd="ambiguous" id="algorithm1.3.3.m3.1.1.3.2.3.1.cmml" xref="algorithm1.3.3.m3.1.1.3.2.3">superscript</csymbol><cn type="integer" id="algorithm1.3.3.m3.1.1.3.2.3.2.cmml" xref="algorithm1.3.3.m3.1.1.3.2.3.2">2</cn><apply id="algorithm1.3.3.m3.1.1.3.2.3.3.cmml" xref="algorithm1.3.3.m3.1.1.3.2.3.3"><times id="algorithm1.3.3.m3.1.1.3.2.3.3.1.cmml" xref="algorithm1.3.3.m3.1.1.3.2.3.3.1"></times><ci id="algorithm1.3.3.m3.1.1.3.2.3.3.2.cmml" xref="algorithm1.3.3.m3.1.1.3.2.3.3.2">𝑗</ci><ci id="algorithm1.3.3.m3.1.1.3.2.3.3.3.cmml" xref="algorithm1.3.3.m3.1.1.3.2.3.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m3.1c">M=\sum_{j=0}^{l/k-1}M^{j}\cdot 2^{jk}</annotation></semantics></math>, <math id="algorithm1.4.4.m4.1" class="ltx_Math" alttext="r=2^{k}" display="inline"><semantics id="algorithm1.4.4.m4.1a"><mrow id="algorithm1.4.4.m4.1.1" xref="algorithm1.4.4.m4.1.1.cmml"><mi id="algorithm1.4.4.m4.1.1.2" xref="algorithm1.4.4.m4.1.1.2.cmml">r</mi><mo id="algorithm1.4.4.m4.1.1.1" xref="algorithm1.4.4.m4.1.1.1.cmml">=</mo><msup id="algorithm1.4.4.m4.1.1.3" xref="algorithm1.4.4.m4.1.1.3.cmml"><mn id="algorithm1.4.4.m4.1.1.3.2" xref="algorithm1.4.4.m4.1.1.3.2.cmml">2</mn><mi id="algorithm1.4.4.m4.1.1.3.3" xref="algorithm1.4.4.m4.1.1.3.3.cmml">k</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m4.1b"><apply id="algorithm1.4.4.m4.1.1.cmml" xref="algorithm1.4.4.m4.1.1"><eq id="algorithm1.4.4.m4.1.1.1.cmml" xref="algorithm1.4.4.m4.1.1.1"></eq><ci id="algorithm1.4.4.m4.1.1.2.cmml" xref="algorithm1.4.4.m4.1.1.2">𝑟</ci><apply id="algorithm1.4.4.m4.1.1.3.cmml" xref="algorithm1.4.4.m4.1.1.3"><csymbol cd="ambiguous" id="algorithm1.4.4.m4.1.1.3.1.cmml" xref="algorithm1.4.4.m4.1.1.3">superscript</csymbol><cn type="integer" id="algorithm1.4.4.m4.1.1.3.2.cmml" xref="algorithm1.4.4.m4.1.1.3.2">2</cn><ci id="algorithm1.4.4.m4.1.1.3.3.cmml" xref="algorithm1.4.4.m4.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m4.1c">r=2^{k}</annotation></semantics></math>
</div>
<div id="algorithm1.5.5" class="ltx_listingline">
<span id="algorithm1.5.5.1" class="ltx_text"><span id="algorithm1.5.5.1.1" class="ltx_text ltx_font_bold">Output:</span> </span><math id="algorithm1.5.5.m1.1" class="ltx_Math" alttext="S=X\cdot Y/2^{l}\mbox{ mod }M" display="inline"><semantics id="algorithm1.5.5.m1.1a"><mrow id="algorithm1.5.5.m1.1.1" xref="algorithm1.5.5.m1.1.1.cmml"><mi id="algorithm1.5.5.m1.1.1.2" xref="algorithm1.5.5.m1.1.1.2.cmml">S</mi><mo id="algorithm1.5.5.m1.1.1.1" xref="algorithm1.5.5.m1.1.1.1.cmml">=</mo><mrow id="algorithm1.5.5.m1.1.1.3" xref="algorithm1.5.5.m1.1.1.3.cmml"><mrow id="algorithm1.5.5.m1.1.1.3.2" xref="algorithm1.5.5.m1.1.1.3.2.cmml"><mrow id="algorithm1.5.5.m1.1.1.3.2.2" xref="algorithm1.5.5.m1.1.1.3.2.2.cmml"><mi id="algorithm1.5.5.m1.1.1.3.2.2.2" xref="algorithm1.5.5.m1.1.1.3.2.2.2.cmml">X</mi><mo lspace="0.222em" rspace="0.222em" id="algorithm1.5.5.m1.1.1.3.2.2.1" xref="algorithm1.5.5.m1.1.1.3.2.2.1.cmml">⋅</mo><mi id="algorithm1.5.5.m1.1.1.3.2.2.3" xref="algorithm1.5.5.m1.1.1.3.2.2.3.cmml">Y</mi></mrow><mo id="algorithm1.5.5.m1.1.1.3.2.1" xref="algorithm1.5.5.m1.1.1.3.2.1.cmml">/</mo><msup id="algorithm1.5.5.m1.1.1.3.2.3" xref="algorithm1.5.5.m1.1.1.3.2.3.cmml"><mn id="algorithm1.5.5.m1.1.1.3.2.3.2" xref="algorithm1.5.5.m1.1.1.3.2.3.2.cmml">2</mn><mi id="algorithm1.5.5.m1.1.1.3.2.3.3" xref="algorithm1.5.5.m1.1.1.3.2.3.3.cmml">l</mi></msup></mrow><mo lspace="0em" rspace="0em" id="algorithm1.5.5.m1.1.1.3.1" xref="algorithm1.5.5.m1.1.1.3.1.cmml">​</mo><mtext id="algorithm1.5.5.m1.1.1.3.3" xref="algorithm1.5.5.m1.1.1.3.3a.cmml"> mod </mtext><mo lspace="0em" rspace="0em" id="algorithm1.5.5.m1.1.1.3.1a" xref="algorithm1.5.5.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.5.5.m1.1.1.3.4" xref="algorithm1.5.5.m1.1.1.3.4.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.m1.1b"><apply id="algorithm1.5.5.m1.1.1.cmml" xref="algorithm1.5.5.m1.1.1"><eq id="algorithm1.5.5.m1.1.1.1.cmml" xref="algorithm1.5.5.m1.1.1.1"></eq><ci id="algorithm1.5.5.m1.1.1.2.cmml" xref="algorithm1.5.5.m1.1.1.2">𝑆</ci><apply id="algorithm1.5.5.m1.1.1.3.cmml" xref="algorithm1.5.5.m1.1.1.3"><times id="algorithm1.5.5.m1.1.1.3.1.cmml" xref="algorithm1.5.5.m1.1.1.3.1"></times><apply id="algorithm1.5.5.m1.1.1.3.2.cmml" xref="algorithm1.5.5.m1.1.1.3.2"><divide id="algorithm1.5.5.m1.1.1.3.2.1.cmml" xref="algorithm1.5.5.m1.1.1.3.2.1"></divide><apply id="algorithm1.5.5.m1.1.1.3.2.2.cmml" xref="algorithm1.5.5.m1.1.1.3.2.2"><ci id="algorithm1.5.5.m1.1.1.3.2.2.1.cmml" xref="algorithm1.5.5.m1.1.1.3.2.2.1">⋅</ci><ci id="algorithm1.5.5.m1.1.1.3.2.2.2.cmml" xref="algorithm1.5.5.m1.1.1.3.2.2.2">𝑋</ci><ci id="algorithm1.5.5.m1.1.1.3.2.2.3.cmml" xref="algorithm1.5.5.m1.1.1.3.2.2.3">𝑌</ci></apply><apply id="algorithm1.5.5.m1.1.1.3.2.3.cmml" xref="algorithm1.5.5.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="algorithm1.5.5.m1.1.1.3.2.3.1.cmml" xref="algorithm1.5.5.m1.1.1.3.2.3">superscript</csymbol><cn type="integer" id="algorithm1.5.5.m1.1.1.3.2.3.2.cmml" xref="algorithm1.5.5.m1.1.1.3.2.3.2">2</cn><ci id="algorithm1.5.5.m1.1.1.3.2.3.3.cmml" xref="algorithm1.5.5.m1.1.1.3.2.3.3">𝑙</ci></apply></apply><ci id="algorithm1.5.5.m1.1.1.3.3a.cmml" xref="algorithm1.5.5.m1.1.1.3.3"><mtext id="algorithm1.5.5.m1.1.1.3.3.cmml" xref="algorithm1.5.5.m1.1.1.3.3"> mod </mtext></ci><ci id="algorithm1.5.5.m1.1.1.3.4.cmml" xref="algorithm1.5.5.m1.1.1.3.4">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.m1.1c">S=X\cdot Y/2^{l}\mbox{ mod }M</annotation></semantics></math>
</div>
<div id="algorithm1.6.6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span>
<math id="algorithm1.6.6.m1.1" class="ltx_Math" alttext="S_{0}\leftarrow 0" display="inline"><semantics id="algorithm1.6.6.m1.1a"><mrow id="algorithm1.6.6.m1.1.1" xref="algorithm1.6.6.m1.1.1.cmml"><msub id="algorithm1.6.6.m1.1.1.2" xref="algorithm1.6.6.m1.1.1.2.cmml"><mi id="algorithm1.6.6.m1.1.1.2.2" xref="algorithm1.6.6.m1.1.1.2.2.cmml">S</mi><mn id="algorithm1.6.6.m1.1.1.2.3" xref="algorithm1.6.6.m1.1.1.2.3.cmml">0</mn></msub><mo stretchy="false" id="algorithm1.6.6.m1.1.1.1" xref="algorithm1.6.6.m1.1.1.1.cmml">←</mo><mn id="algorithm1.6.6.m1.1.1.3" xref="algorithm1.6.6.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.m1.1b"><apply id="algorithm1.6.6.m1.1.1.cmml" xref="algorithm1.6.6.m1.1.1"><ci id="algorithm1.6.6.m1.1.1.1.cmml" xref="algorithm1.6.6.m1.1.1.1">←</ci><apply id="algorithm1.6.6.m1.1.1.2.cmml" xref="algorithm1.6.6.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.6.6.m1.1.1.2.1.cmml" xref="algorithm1.6.6.m1.1.1.2">subscript</csymbol><ci id="algorithm1.6.6.m1.1.1.2.2.cmml" xref="algorithm1.6.6.m1.1.1.2.2">𝑆</ci><cn type="integer" id="algorithm1.6.6.m1.1.1.2.3.cmml" xref="algorithm1.6.6.m1.1.1.2.3">0</cn></apply><cn type="integer" id="algorithm1.6.6.m1.1.1.3.cmml" xref="algorithm1.6.6.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.m1.1c">S_{0}\leftarrow 0</annotation></semantics></math>;
</div>
<div id="algorithm1.7.7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span>
<span id="algorithm1.7.7.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.7.7.1" class="ltx_emph ltx_font_italic"><math id="algorithm1.7.7.1.m1.1" class="ltx_Math" alttext="i=0\ldots l/k-1" display="inline"><semantics id="algorithm1.7.7.1.m1.1a"><mrow id="algorithm1.7.7.1.m1.1.1" xref="algorithm1.7.7.1.m1.1.1.cmml"><mi id="algorithm1.7.7.1.m1.1.1.2" xref="algorithm1.7.7.1.m1.1.1.2.cmml">i</mi><mo id="algorithm1.7.7.1.m1.1.1.1" xref="algorithm1.7.7.1.m1.1.1.1.cmml">=</mo><mrow id="algorithm1.7.7.1.m1.1.1.3" xref="algorithm1.7.7.1.m1.1.1.3.cmml"><mrow id="algorithm1.7.7.1.m1.1.1.3.2" xref="algorithm1.7.7.1.m1.1.1.3.2.cmml"><mrow id="algorithm1.7.7.1.m1.1.1.3.2.2" xref="algorithm1.7.7.1.m1.1.1.3.2.2.cmml"><mn id="algorithm1.7.7.1.m1.1.1.3.2.2.2" xref="algorithm1.7.7.1.m1.1.1.3.2.2.2.cmml">0</mn><mo lspace="0em" rspace="0em" id="algorithm1.7.7.1.m1.1.1.3.2.2.1" xref="algorithm1.7.7.1.m1.1.1.3.2.2.1.cmml">​</mo><mi mathvariant="normal" id="algorithm1.7.7.1.m1.1.1.3.2.2.3" xref="algorithm1.7.7.1.m1.1.1.3.2.2.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="algorithm1.7.7.1.m1.1.1.3.2.2.1a" xref="algorithm1.7.7.1.m1.1.1.3.2.2.1.cmml">​</mo><mi id="algorithm1.7.7.1.m1.1.1.3.2.2.4" xref="algorithm1.7.7.1.m1.1.1.3.2.2.4.cmml">l</mi></mrow><mo id="algorithm1.7.7.1.m1.1.1.3.2.1" xref="algorithm1.7.7.1.m1.1.1.3.2.1.cmml">/</mo><mi id="algorithm1.7.7.1.m1.1.1.3.2.3" xref="algorithm1.7.7.1.m1.1.1.3.2.3.cmml">k</mi></mrow><mo id="algorithm1.7.7.1.m1.1.1.3.1" xref="algorithm1.7.7.1.m1.1.1.3.1.cmml">−</mo><mn id="algorithm1.7.7.1.m1.1.1.3.3" xref="algorithm1.7.7.1.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.1.m1.1b"><apply id="algorithm1.7.7.1.m1.1.1.cmml" xref="algorithm1.7.7.1.m1.1.1"><eq id="algorithm1.7.7.1.m1.1.1.1.cmml" xref="algorithm1.7.7.1.m1.1.1.1"></eq><ci id="algorithm1.7.7.1.m1.1.1.2.cmml" xref="algorithm1.7.7.1.m1.1.1.2">𝑖</ci><apply id="algorithm1.7.7.1.m1.1.1.3.cmml" xref="algorithm1.7.7.1.m1.1.1.3"><minus id="algorithm1.7.7.1.m1.1.1.3.1.cmml" xref="algorithm1.7.7.1.m1.1.1.3.1"></minus><apply id="algorithm1.7.7.1.m1.1.1.3.2.cmml" xref="algorithm1.7.7.1.m1.1.1.3.2"><divide id="algorithm1.7.7.1.m1.1.1.3.2.1.cmml" xref="algorithm1.7.7.1.m1.1.1.3.2.1"></divide><apply id="algorithm1.7.7.1.m1.1.1.3.2.2.cmml" xref="algorithm1.7.7.1.m1.1.1.3.2.2"><times id="algorithm1.7.7.1.m1.1.1.3.2.2.1.cmml" xref="algorithm1.7.7.1.m1.1.1.3.2.2.1"></times><cn type="integer" id="algorithm1.7.7.1.m1.1.1.3.2.2.2.cmml" xref="algorithm1.7.7.1.m1.1.1.3.2.2.2">0</cn><ci id="algorithm1.7.7.1.m1.1.1.3.2.2.3.cmml" xref="algorithm1.7.7.1.m1.1.1.3.2.2.3">…</ci><ci id="algorithm1.7.7.1.m1.1.1.3.2.2.4.cmml" xref="algorithm1.7.7.1.m1.1.1.3.2.2.4">𝑙</ci></apply><ci id="algorithm1.7.7.1.m1.1.1.3.2.3.cmml" xref="algorithm1.7.7.1.m1.1.1.3.2.3">𝑘</ci></apply><cn type="integer" id="algorithm1.7.7.1.m1.1.1.3.3.cmml" xref="algorithm1.7.7.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.1.m1.1c">i=0\ldots l/k-1</annotation></semantics></math></em> <span id="algorithm1.7.7.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.8.8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.8.8.m1.1" class="ltx_Math" alttext="q\leftarrow((S_{i}+X*Y^{i})\cdot(-M^{-1}))\mbox{ mod }r" display="inline"><semantics id="algorithm1.8.8.m1.1a"><mrow id="algorithm1.8.8.m1.1.1" xref="algorithm1.8.8.m1.1.1.cmml"><mi id="algorithm1.8.8.m1.1.1.3" xref="algorithm1.8.8.m1.1.1.3.cmml">q</mi><mo stretchy="false" id="algorithm1.8.8.m1.1.1.2" xref="algorithm1.8.8.m1.1.1.2.cmml">←</mo><mrow id="algorithm1.8.8.m1.1.1.1" xref="algorithm1.8.8.m1.1.1.1.cmml"><mrow id="algorithm1.8.8.m1.1.1.1.1.1" xref="algorithm1.8.8.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.8.8.m1.1.1.1.1.1.2" xref="algorithm1.8.8.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.8.8.m1.1.1.1.1.1.1" xref="algorithm1.8.8.m1.1.1.1.1.1.1.cmml"><mrow id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.2" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.2" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.2.2" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">S</mi><mi id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.2.3" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.1" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.2" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">X</mi><mo lspace="0.222em" rspace="0.222em" id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.1" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">∗</mo><msup id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.3" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">Y</mi><mi id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></msup></mrow></mrow><mo rspace="0.055em" stretchy="false" id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.3" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="algorithm1.8.8.m1.1.1.1.1.1.1.3" xref="algorithm1.8.8.m1.1.1.1.1.1.1.3.cmml">⋅</mo><mrow id="algorithm1.8.8.m1.1.1.1.1.1.1.2.1" xref="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.cmml"><mo stretchy="false" id="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.2" xref="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.cmml">(</mo><mrow id="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1" xref="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.cmml"><mo id="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1a" xref="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.cmml">−</mo><msup id="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2" xref="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2.cmml"><mi id="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2.2" xref="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2.2.cmml">M</mi><mrow id="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2.3" xref="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2.3.cmml"><mo id="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2.3a" xref="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2.3.cmml">−</mo><mn id="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2.3.2" xref="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2.3.2.cmml">1</mn></mrow></msup></mrow><mo stretchy="false" id="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.3" xref="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="algorithm1.8.8.m1.1.1.1.1.1.3" xref="algorithm1.8.8.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="algorithm1.8.8.m1.1.1.1.2" xref="algorithm1.8.8.m1.1.1.1.2.cmml">​</mo><mtext id="algorithm1.8.8.m1.1.1.1.3" xref="algorithm1.8.8.m1.1.1.1.3a.cmml"> mod </mtext><mo lspace="0em" rspace="0em" id="algorithm1.8.8.m1.1.1.1.2a" xref="algorithm1.8.8.m1.1.1.1.2.cmml">​</mo><mi id="algorithm1.8.8.m1.1.1.1.4" xref="algorithm1.8.8.m1.1.1.1.4.cmml">r</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.m1.1b"><apply id="algorithm1.8.8.m1.1.1.cmml" xref="algorithm1.8.8.m1.1.1"><ci id="algorithm1.8.8.m1.1.1.2.cmml" xref="algorithm1.8.8.m1.1.1.2">←</ci><ci id="algorithm1.8.8.m1.1.1.3.cmml" xref="algorithm1.8.8.m1.1.1.3">𝑞</ci><apply id="algorithm1.8.8.m1.1.1.1.cmml" xref="algorithm1.8.8.m1.1.1.1"><times id="algorithm1.8.8.m1.1.1.1.2.cmml" xref="algorithm1.8.8.m1.1.1.1.2"></times><apply id="algorithm1.8.8.m1.1.1.1.1.1.1.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1"><ci id="algorithm1.8.8.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.3">⋅</ci><apply id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1"><plus id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.2.2">𝑆</ci><ci id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3"><times id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.2">𝑋</ci><apply id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.3.2">𝑌</ci><ci id="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.2.1"><minus id="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.1.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.2.1"></minus><apply id="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2.1.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2">superscript</csymbol><ci id="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2.2.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2.2">𝑀</ci><apply id="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2.3.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2.3"><minus id="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2.3.1.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2.3"></minus><cn type="integer" id="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2.3.2.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.2.1.1.2.3.2">1</cn></apply></apply></apply></apply><ci id="algorithm1.8.8.m1.1.1.1.3a.cmml" xref="algorithm1.8.8.m1.1.1.1.3"><mtext id="algorithm1.8.8.m1.1.1.1.3.cmml" xref="algorithm1.8.8.m1.1.1.1.3"> mod </mtext></ci><ci id="algorithm1.8.8.m1.1.1.1.4.cmml" xref="algorithm1.8.8.m1.1.1.1.4">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.m1.1c">q\leftarrow((S_{i}+X*Y^{i})\cdot(-M^{-1}))\mbox{ mod }r</annotation></semantics></math>;
</div>
<div id="algorithm1.14.15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm1.9.9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm1.9.9.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.9.9.1" class="ltx_emph ltx_font_italic"><math id="algorithm1.9.9.1.m1.1" class="ltx_Math" alttext="j=0\ldots l/k" display="inline"><semantics id="algorithm1.9.9.1.m1.1a"><mrow id="algorithm1.9.9.1.m1.1.1" xref="algorithm1.9.9.1.m1.1.1.cmml"><mi id="algorithm1.9.9.1.m1.1.1.2" xref="algorithm1.9.9.1.m1.1.1.2.cmml">j</mi><mo id="algorithm1.9.9.1.m1.1.1.1" xref="algorithm1.9.9.1.m1.1.1.1.cmml">=</mo><mrow id="algorithm1.9.9.1.m1.1.1.3" xref="algorithm1.9.9.1.m1.1.1.3.cmml"><mrow id="algorithm1.9.9.1.m1.1.1.3.2" xref="algorithm1.9.9.1.m1.1.1.3.2.cmml"><mn id="algorithm1.9.9.1.m1.1.1.3.2.2" xref="algorithm1.9.9.1.m1.1.1.3.2.2.cmml">0</mn><mo lspace="0em" rspace="0em" id="algorithm1.9.9.1.m1.1.1.3.2.1" xref="algorithm1.9.9.1.m1.1.1.3.2.1.cmml">​</mo><mi mathvariant="normal" id="algorithm1.9.9.1.m1.1.1.3.2.3" xref="algorithm1.9.9.1.m1.1.1.3.2.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="algorithm1.9.9.1.m1.1.1.3.2.1a" xref="algorithm1.9.9.1.m1.1.1.3.2.1.cmml">​</mo><mi id="algorithm1.9.9.1.m1.1.1.3.2.4" xref="algorithm1.9.9.1.m1.1.1.3.2.4.cmml">l</mi></mrow><mo id="algorithm1.9.9.1.m1.1.1.3.1" xref="algorithm1.9.9.1.m1.1.1.3.1.cmml">/</mo><mi id="algorithm1.9.9.1.m1.1.1.3.3" xref="algorithm1.9.9.1.m1.1.1.3.3.cmml">k</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.1.m1.1b"><apply id="algorithm1.9.9.1.m1.1.1.cmml" xref="algorithm1.9.9.1.m1.1.1"><eq id="algorithm1.9.9.1.m1.1.1.1.cmml" xref="algorithm1.9.9.1.m1.1.1.1"></eq><ci id="algorithm1.9.9.1.m1.1.1.2.cmml" xref="algorithm1.9.9.1.m1.1.1.2">𝑗</ci><apply id="algorithm1.9.9.1.m1.1.1.3.cmml" xref="algorithm1.9.9.1.m1.1.1.3"><divide id="algorithm1.9.9.1.m1.1.1.3.1.cmml" xref="algorithm1.9.9.1.m1.1.1.3.1"></divide><apply id="algorithm1.9.9.1.m1.1.1.3.2.cmml" xref="algorithm1.9.9.1.m1.1.1.3.2"><times id="algorithm1.9.9.1.m1.1.1.3.2.1.cmml" xref="algorithm1.9.9.1.m1.1.1.3.2.1"></times><cn type="integer" id="algorithm1.9.9.1.m1.1.1.3.2.2.cmml" xref="algorithm1.9.9.1.m1.1.1.3.2.2">0</cn><ci id="algorithm1.9.9.1.m1.1.1.3.2.3.cmml" xref="algorithm1.9.9.1.m1.1.1.3.2.3">…</ci><ci id="algorithm1.9.9.1.m1.1.1.3.2.4.cmml" xref="algorithm1.9.9.1.m1.1.1.3.2.4">𝑙</ci></apply><ci id="algorithm1.9.9.1.m1.1.1.3.3.cmml" xref="algorithm1.9.9.1.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.1.m1.1c">j=0\ldots l/k</annotation></semantics></math></em> <span id="algorithm1.9.9.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.10.10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.10.10.m1.1" class="ltx_Math" alttext="\bar{S}_{i+1}^{j}\leftarrow S_{i}^{j}+X^{j}*Y^{i}+q*M^{j}" display="inline"><semantics id="algorithm1.10.10.m1.1a"><mrow id="algorithm1.10.10.m1.1.1" xref="algorithm1.10.10.m1.1.1.cmml"><msubsup id="algorithm1.10.10.m1.1.1.2" xref="algorithm1.10.10.m1.1.1.2.cmml"><mover accent="true" id="algorithm1.10.10.m1.1.1.2.2.2" xref="algorithm1.10.10.m1.1.1.2.2.2.cmml"><mi id="algorithm1.10.10.m1.1.1.2.2.2.2" xref="algorithm1.10.10.m1.1.1.2.2.2.2.cmml">S</mi><mo id="algorithm1.10.10.m1.1.1.2.2.2.1" xref="algorithm1.10.10.m1.1.1.2.2.2.1.cmml">¯</mo></mover><mrow id="algorithm1.10.10.m1.1.1.2.2.3" xref="algorithm1.10.10.m1.1.1.2.2.3.cmml"><mi id="algorithm1.10.10.m1.1.1.2.2.3.2" xref="algorithm1.10.10.m1.1.1.2.2.3.2.cmml">i</mi><mo id="algorithm1.10.10.m1.1.1.2.2.3.1" xref="algorithm1.10.10.m1.1.1.2.2.3.1.cmml">+</mo><mn id="algorithm1.10.10.m1.1.1.2.2.3.3" xref="algorithm1.10.10.m1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="algorithm1.10.10.m1.1.1.2.3" xref="algorithm1.10.10.m1.1.1.2.3.cmml">j</mi></msubsup><mo stretchy="false" id="algorithm1.10.10.m1.1.1.1" xref="algorithm1.10.10.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.10.10.m1.1.1.3" xref="algorithm1.10.10.m1.1.1.3.cmml"><msubsup id="algorithm1.10.10.m1.1.1.3.2" xref="algorithm1.10.10.m1.1.1.3.2.cmml"><mi id="algorithm1.10.10.m1.1.1.3.2.2.2" xref="algorithm1.10.10.m1.1.1.3.2.2.2.cmml">S</mi><mi id="algorithm1.10.10.m1.1.1.3.2.2.3" xref="algorithm1.10.10.m1.1.1.3.2.2.3.cmml">i</mi><mi id="algorithm1.10.10.m1.1.1.3.2.3" xref="algorithm1.10.10.m1.1.1.3.2.3.cmml">j</mi></msubsup><mo id="algorithm1.10.10.m1.1.1.3.1" xref="algorithm1.10.10.m1.1.1.3.1.cmml">+</mo><mrow id="algorithm1.10.10.m1.1.1.3.3" xref="algorithm1.10.10.m1.1.1.3.3.cmml"><msup id="algorithm1.10.10.m1.1.1.3.3.2" xref="algorithm1.10.10.m1.1.1.3.3.2.cmml"><mi id="algorithm1.10.10.m1.1.1.3.3.2.2" xref="algorithm1.10.10.m1.1.1.3.3.2.2.cmml">X</mi><mi id="algorithm1.10.10.m1.1.1.3.3.2.3" xref="algorithm1.10.10.m1.1.1.3.3.2.3.cmml">j</mi></msup><mo lspace="0.222em" rspace="0.222em" id="algorithm1.10.10.m1.1.1.3.3.1" xref="algorithm1.10.10.m1.1.1.3.3.1.cmml">∗</mo><msup id="algorithm1.10.10.m1.1.1.3.3.3" xref="algorithm1.10.10.m1.1.1.3.3.3.cmml"><mi id="algorithm1.10.10.m1.1.1.3.3.3.2" xref="algorithm1.10.10.m1.1.1.3.3.3.2.cmml">Y</mi><mi id="algorithm1.10.10.m1.1.1.3.3.3.3" xref="algorithm1.10.10.m1.1.1.3.3.3.3.cmml">i</mi></msup></mrow><mo id="algorithm1.10.10.m1.1.1.3.1a" xref="algorithm1.10.10.m1.1.1.3.1.cmml">+</mo><mrow id="algorithm1.10.10.m1.1.1.3.4" xref="algorithm1.10.10.m1.1.1.3.4.cmml"><mi id="algorithm1.10.10.m1.1.1.3.4.2" xref="algorithm1.10.10.m1.1.1.3.4.2.cmml">q</mi><mo lspace="0.222em" rspace="0.222em" id="algorithm1.10.10.m1.1.1.3.4.1" xref="algorithm1.10.10.m1.1.1.3.4.1.cmml">∗</mo><msup id="algorithm1.10.10.m1.1.1.3.4.3" xref="algorithm1.10.10.m1.1.1.3.4.3.cmml"><mi id="algorithm1.10.10.m1.1.1.3.4.3.2" xref="algorithm1.10.10.m1.1.1.3.4.3.2.cmml">M</mi><mi id="algorithm1.10.10.m1.1.1.3.4.3.3" xref="algorithm1.10.10.m1.1.1.3.4.3.3.cmml">j</mi></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.m1.1b"><apply id="algorithm1.10.10.m1.1.1.cmml" xref="algorithm1.10.10.m1.1.1"><ci id="algorithm1.10.10.m1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1.1">←</ci><apply id="algorithm1.10.10.m1.1.1.2.cmml" xref="algorithm1.10.10.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.2.1.cmml" xref="algorithm1.10.10.m1.1.1.2">superscript</csymbol><apply id="algorithm1.10.10.m1.1.1.2.2.cmml" xref="algorithm1.10.10.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.2.2.1.cmml" xref="algorithm1.10.10.m1.1.1.2">subscript</csymbol><apply id="algorithm1.10.10.m1.1.1.2.2.2.cmml" xref="algorithm1.10.10.m1.1.1.2.2.2"><ci id="algorithm1.10.10.m1.1.1.2.2.2.1.cmml" xref="algorithm1.10.10.m1.1.1.2.2.2.1">¯</ci><ci id="algorithm1.10.10.m1.1.1.2.2.2.2.cmml" xref="algorithm1.10.10.m1.1.1.2.2.2.2">𝑆</ci></apply><apply id="algorithm1.10.10.m1.1.1.2.2.3.cmml" xref="algorithm1.10.10.m1.1.1.2.2.3"><plus id="algorithm1.10.10.m1.1.1.2.2.3.1.cmml" xref="algorithm1.10.10.m1.1.1.2.2.3.1"></plus><ci id="algorithm1.10.10.m1.1.1.2.2.3.2.cmml" xref="algorithm1.10.10.m1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="algorithm1.10.10.m1.1.1.2.2.3.3.cmml" xref="algorithm1.10.10.m1.1.1.2.2.3.3">1</cn></apply></apply><ci id="algorithm1.10.10.m1.1.1.2.3.cmml" xref="algorithm1.10.10.m1.1.1.2.3">𝑗</ci></apply><apply id="algorithm1.10.10.m1.1.1.3.cmml" xref="algorithm1.10.10.m1.1.1.3"><plus id="algorithm1.10.10.m1.1.1.3.1.cmml" xref="algorithm1.10.10.m1.1.1.3.1"></plus><apply id="algorithm1.10.10.m1.1.1.3.2.cmml" xref="algorithm1.10.10.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.3.2.1.cmml" xref="algorithm1.10.10.m1.1.1.3.2">superscript</csymbol><apply id="algorithm1.10.10.m1.1.1.3.2.2.cmml" xref="algorithm1.10.10.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.3.2.2.1.cmml" xref="algorithm1.10.10.m1.1.1.3.2">subscript</csymbol><ci id="algorithm1.10.10.m1.1.1.3.2.2.2.cmml" xref="algorithm1.10.10.m1.1.1.3.2.2.2">𝑆</ci><ci id="algorithm1.10.10.m1.1.1.3.2.2.3.cmml" xref="algorithm1.10.10.m1.1.1.3.2.2.3">𝑖</ci></apply><ci id="algorithm1.10.10.m1.1.1.3.2.3.cmml" xref="algorithm1.10.10.m1.1.1.3.2.3">𝑗</ci></apply><apply id="algorithm1.10.10.m1.1.1.3.3.cmml" xref="algorithm1.10.10.m1.1.1.3.3"><times id="algorithm1.10.10.m1.1.1.3.3.1.cmml" xref="algorithm1.10.10.m1.1.1.3.3.1"></times><apply id="algorithm1.10.10.m1.1.1.3.3.2.cmml" xref="algorithm1.10.10.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.3.3.2.1.cmml" xref="algorithm1.10.10.m1.1.1.3.3.2">superscript</csymbol><ci id="algorithm1.10.10.m1.1.1.3.3.2.2.cmml" xref="algorithm1.10.10.m1.1.1.3.3.2.2">𝑋</ci><ci id="algorithm1.10.10.m1.1.1.3.3.2.3.cmml" xref="algorithm1.10.10.m1.1.1.3.3.2.3">𝑗</ci></apply><apply id="algorithm1.10.10.m1.1.1.3.3.3.cmml" xref="algorithm1.10.10.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.3.3.3.1.cmml" xref="algorithm1.10.10.m1.1.1.3.3.3">superscript</csymbol><ci id="algorithm1.10.10.m1.1.1.3.3.3.2.cmml" xref="algorithm1.10.10.m1.1.1.3.3.3.2">𝑌</ci><ci id="algorithm1.10.10.m1.1.1.3.3.3.3.cmml" xref="algorithm1.10.10.m1.1.1.3.3.3.3">𝑖</ci></apply></apply><apply id="algorithm1.10.10.m1.1.1.3.4.cmml" xref="algorithm1.10.10.m1.1.1.3.4"><times id="algorithm1.10.10.m1.1.1.3.4.1.cmml" xref="algorithm1.10.10.m1.1.1.3.4.1"></times><ci id="algorithm1.10.10.m1.1.1.3.4.2.cmml" xref="algorithm1.10.10.m1.1.1.3.4.2">𝑞</ci><apply id="algorithm1.10.10.m1.1.1.3.4.3.cmml" xref="algorithm1.10.10.m1.1.1.3.4.3"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.3.4.3.1.cmml" xref="algorithm1.10.10.m1.1.1.3.4.3">superscript</csymbol><ci id="algorithm1.10.10.m1.1.1.3.4.3.2.cmml" xref="algorithm1.10.10.m1.1.1.3.4.3.2">𝑀</ci><ci id="algorithm1.10.10.m1.1.1.3.4.3.3.cmml" xref="algorithm1.10.10.m1.1.1.3.4.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.m1.1c">\bar{S}_{i+1}^{j}\leftarrow S_{i}^{j}+X^{j}*Y^{i}+q*M^{j}</annotation></semantics></math>;
</div>
<div id="algorithm1.14.16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm1.14.17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm1.11.11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.11.11.m1.1" class="ltx_Math" alttext="S_{i+1}\leftarrow\bar{S}_{i+1}/2^{k}" display="inline"><semantics id="algorithm1.11.11.m1.1a"><mrow id="algorithm1.11.11.m1.1.1" xref="algorithm1.11.11.m1.1.1.cmml"><msub id="algorithm1.11.11.m1.1.1.2" xref="algorithm1.11.11.m1.1.1.2.cmml"><mi id="algorithm1.11.11.m1.1.1.2.2" xref="algorithm1.11.11.m1.1.1.2.2.cmml">S</mi><mrow id="algorithm1.11.11.m1.1.1.2.3" xref="algorithm1.11.11.m1.1.1.2.3.cmml"><mi id="algorithm1.11.11.m1.1.1.2.3.2" xref="algorithm1.11.11.m1.1.1.2.3.2.cmml">i</mi><mo id="algorithm1.11.11.m1.1.1.2.3.1" xref="algorithm1.11.11.m1.1.1.2.3.1.cmml">+</mo><mn id="algorithm1.11.11.m1.1.1.2.3.3" xref="algorithm1.11.11.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="algorithm1.11.11.m1.1.1.1" xref="algorithm1.11.11.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.11.11.m1.1.1.3" xref="algorithm1.11.11.m1.1.1.3.cmml"><msub id="algorithm1.11.11.m1.1.1.3.2" xref="algorithm1.11.11.m1.1.1.3.2.cmml"><mover accent="true" id="algorithm1.11.11.m1.1.1.3.2.2" xref="algorithm1.11.11.m1.1.1.3.2.2.cmml"><mi id="algorithm1.11.11.m1.1.1.3.2.2.2" xref="algorithm1.11.11.m1.1.1.3.2.2.2.cmml">S</mi><mo id="algorithm1.11.11.m1.1.1.3.2.2.1" xref="algorithm1.11.11.m1.1.1.3.2.2.1.cmml">¯</mo></mover><mrow id="algorithm1.11.11.m1.1.1.3.2.3" xref="algorithm1.11.11.m1.1.1.3.2.3.cmml"><mi id="algorithm1.11.11.m1.1.1.3.2.3.2" xref="algorithm1.11.11.m1.1.1.3.2.3.2.cmml">i</mi><mo id="algorithm1.11.11.m1.1.1.3.2.3.1" xref="algorithm1.11.11.m1.1.1.3.2.3.1.cmml">+</mo><mn id="algorithm1.11.11.m1.1.1.3.2.3.3" xref="algorithm1.11.11.m1.1.1.3.2.3.3.cmml">1</mn></mrow></msub><mo id="algorithm1.11.11.m1.1.1.3.1" xref="algorithm1.11.11.m1.1.1.3.1.cmml">/</mo><msup id="algorithm1.11.11.m1.1.1.3.3" xref="algorithm1.11.11.m1.1.1.3.3.cmml"><mn id="algorithm1.11.11.m1.1.1.3.3.2" xref="algorithm1.11.11.m1.1.1.3.3.2.cmml">2</mn><mi id="algorithm1.11.11.m1.1.1.3.3.3" xref="algorithm1.11.11.m1.1.1.3.3.3.cmml">k</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m1.1b"><apply id="algorithm1.11.11.m1.1.1.cmml" xref="algorithm1.11.11.m1.1.1"><ci id="algorithm1.11.11.m1.1.1.1.cmml" xref="algorithm1.11.11.m1.1.1.1">←</ci><apply id="algorithm1.11.11.m1.1.1.2.cmml" xref="algorithm1.11.11.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.2.1.cmml" xref="algorithm1.11.11.m1.1.1.2">subscript</csymbol><ci id="algorithm1.11.11.m1.1.1.2.2.cmml" xref="algorithm1.11.11.m1.1.1.2.2">𝑆</ci><apply id="algorithm1.11.11.m1.1.1.2.3.cmml" xref="algorithm1.11.11.m1.1.1.2.3"><plus id="algorithm1.11.11.m1.1.1.2.3.1.cmml" xref="algorithm1.11.11.m1.1.1.2.3.1"></plus><ci id="algorithm1.11.11.m1.1.1.2.3.2.cmml" xref="algorithm1.11.11.m1.1.1.2.3.2">𝑖</ci><cn type="integer" id="algorithm1.11.11.m1.1.1.2.3.3.cmml" xref="algorithm1.11.11.m1.1.1.2.3.3">1</cn></apply></apply><apply id="algorithm1.11.11.m1.1.1.3.cmml" xref="algorithm1.11.11.m1.1.1.3"><divide id="algorithm1.11.11.m1.1.1.3.1.cmml" xref="algorithm1.11.11.m1.1.1.3.1"></divide><apply id="algorithm1.11.11.m1.1.1.3.2.cmml" xref="algorithm1.11.11.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.3.2.1.cmml" xref="algorithm1.11.11.m1.1.1.3.2">subscript</csymbol><apply id="algorithm1.11.11.m1.1.1.3.2.2.cmml" xref="algorithm1.11.11.m1.1.1.3.2.2"><ci id="algorithm1.11.11.m1.1.1.3.2.2.1.cmml" xref="algorithm1.11.11.m1.1.1.3.2.2.1">¯</ci><ci id="algorithm1.11.11.m1.1.1.3.2.2.2.cmml" xref="algorithm1.11.11.m1.1.1.3.2.2.2">𝑆</ci></apply><apply id="algorithm1.11.11.m1.1.1.3.2.3.cmml" xref="algorithm1.11.11.m1.1.1.3.2.3"><plus id="algorithm1.11.11.m1.1.1.3.2.3.1.cmml" xref="algorithm1.11.11.m1.1.1.3.2.3.1"></plus><ci id="algorithm1.11.11.m1.1.1.3.2.3.2.cmml" xref="algorithm1.11.11.m1.1.1.3.2.3.2">𝑖</ci><cn type="integer" id="algorithm1.11.11.m1.1.1.3.2.3.3.cmml" xref="algorithm1.11.11.m1.1.1.3.2.3.3">1</cn></apply></apply><apply id="algorithm1.11.11.m1.1.1.3.3.cmml" xref="algorithm1.11.11.m1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.3.3.1.cmml" xref="algorithm1.11.11.m1.1.1.3.3">superscript</csymbol><cn type="integer" id="algorithm1.11.11.m1.1.1.3.3.2.cmml" xref="algorithm1.11.11.m1.1.1.3.3.2">2</cn><ci id="algorithm1.11.11.m1.1.1.3.3.3.cmml" xref="algorithm1.11.11.m1.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.1c">S_{i+1}\leftarrow\bar{S}_{i+1}/2^{k}</annotation></semantics></math>

</div>
<div id="algorithm1.14.18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span> end for
</div>
<div id="algorithm1.12.12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span><span id="algorithm1.12.12.2" class="ltx_text ltx_font_bold">if</span> <em id="algorithm1.12.12.1" class="ltx_emph ltx_font_italic"><math id="algorithm1.12.12.1.m1.1" class="ltx_Math" alttext="S_{l/k}&gt;M" display="inline"><semantics id="algorithm1.12.12.1.m1.1a"><mrow id="algorithm1.12.12.1.m1.1.1" xref="algorithm1.12.12.1.m1.1.1.cmml"><msub id="algorithm1.12.12.1.m1.1.1.2" xref="algorithm1.12.12.1.m1.1.1.2.cmml"><mi id="algorithm1.12.12.1.m1.1.1.2.2" xref="algorithm1.12.12.1.m1.1.1.2.2.cmml">S</mi><mrow id="algorithm1.12.12.1.m1.1.1.2.3" xref="algorithm1.12.12.1.m1.1.1.2.3.cmml"><mi id="algorithm1.12.12.1.m1.1.1.2.3.2" xref="algorithm1.12.12.1.m1.1.1.2.3.2.cmml">l</mi><mo id="algorithm1.12.12.1.m1.1.1.2.3.1" xref="algorithm1.12.12.1.m1.1.1.2.3.1.cmml">/</mo><mi id="algorithm1.12.12.1.m1.1.1.2.3.3" xref="algorithm1.12.12.1.m1.1.1.2.3.3.cmml">k</mi></mrow></msub><mo id="algorithm1.12.12.1.m1.1.1.1" xref="algorithm1.12.12.1.m1.1.1.1.cmml">&gt;</mo><mi id="algorithm1.12.12.1.m1.1.1.3" xref="algorithm1.12.12.1.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.1.m1.1b"><apply id="algorithm1.12.12.1.m1.1.1.cmml" xref="algorithm1.12.12.1.m1.1.1"><gt id="algorithm1.12.12.1.m1.1.1.1.cmml" xref="algorithm1.12.12.1.m1.1.1.1"></gt><apply id="algorithm1.12.12.1.m1.1.1.2.cmml" xref="algorithm1.12.12.1.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.12.12.1.m1.1.1.2.1.cmml" xref="algorithm1.12.12.1.m1.1.1.2">subscript</csymbol><ci id="algorithm1.12.12.1.m1.1.1.2.2.cmml" xref="algorithm1.12.12.1.m1.1.1.2.2">𝑆</ci><apply id="algorithm1.12.12.1.m1.1.1.2.3.cmml" xref="algorithm1.12.12.1.m1.1.1.2.3"><divide id="algorithm1.12.12.1.m1.1.1.2.3.1.cmml" xref="algorithm1.12.12.1.m1.1.1.2.3.1"></divide><ci id="algorithm1.12.12.1.m1.1.1.2.3.2.cmml" xref="algorithm1.12.12.1.m1.1.1.2.3.2">𝑙</ci><ci id="algorithm1.12.12.1.m1.1.1.2.3.3.cmml" xref="algorithm1.12.12.1.m1.1.1.2.3.3">𝑘</ci></apply></apply><ci id="algorithm1.12.12.1.m1.1.1.3.cmml" xref="algorithm1.12.12.1.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.1.m1.1c">S_{l/k}&gt;M</annotation></semantics></math></em> <span id="algorithm1.12.12.3" class="ltx_text ltx_font_bold">then</span> 
</div>
<div id="algorithm1.13.13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.13.13.m1.1" class="ltx_Math" alttext="S_{l/k}\leftarrow S_{l/k}-M" display="inline"><semantics id="algorithm1.13.13.m1.1a"><mrow id="algorithm1.13.13.m1.1.1" xref="algorithm1.13.13.m1.1.1.cmml"><msub id="algorithm1.13.13.m1.1.1.2" xref="algorithm1.13.13.m1.1.1.2.cmml"><mi id="algorithm1.13.13.m1.1.1.2.2" xref="algorithm1.13.13.m1.1.1.2.2.cmml">S</mi><mrow id="algorithm1.13.13.m1.1.1.2.3" xref="algorithm1.13.13.m1.1.1.2.3.cmml"><mi id="algorithm1.13.13.m1.1.1.2.3.2" xref="algorithm1.13.13.m1.1.1.2.3.2.cmml">l</mi><mo id="algorithm1.13.13.m1.1.1.2.3.1" xref="algorithm1.13.13.m1.1.1.2.3.1.cmml">/</mo><mi id="algorithm1.13.13.m1.1.1.2.3.3" xref="algorithm1.13.13.m1.1.1.2.3.3.cmml">k</mi></mrow></msub><mo stretchy="false" id="algorithm1.13.13.m1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.13.13.m1.1.1.3" xref="algorithm1.13.13.m1.1.1.3.cmml"><msub id="algorithm1.13.13.m1.1.1.3.2" xref="algorithm1.13.13.m1.1.1.3.2.cmml"><mi id="algorithm1.13.13.m1.1.1.3.2.2" xref="algorithm1.13.13.m1.1.1.3.2.2.cmml">S</mi><mrow id="algorithm1.13.13.m1.1.1.3.2.3" xref="algorithm1.13.13.m1.1.1.3.2.3.cmml"><mi id="algorithm1.13.13.m1.1.1.3.2.3.2" xref="algorithm1.13.13.m1.1.1.3.2.3.2.cmml">l</mi><mo id="algorithm1.13.13.m1.1.1.3.2.3.1" xref="algorithm1.13.13.m1.1.1.3.2.3.1.cmml">/</mo><mi id="algorithm1.13.13.m1.1.1.3.2.3.3" xref="algorithm1.13.13.m1.1.1.3.2.3.3.cmml">k</mi></mrow></msub><mo id="algorithm1.13.13.m1.1.1.3.1" xref="algorithm1.13.13.m1.1.1.3.1.cmml">−</mo><mi id="algorithm1.13.13.m1.1.1.3.3" xref="algorithm1.13.13.m1.1.1.3.3.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m1.1b"><apply id="algorithm1.13.13.m1.1.1.cmml" xref="algorithm1.13.13.m1.1.1"><ci id="algorithm1.13.13.m1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1">←</ci><apply id="algorithm1.13.13.m1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.1.1.2.1.cmml" xref="algorithm1.13.13.m1.1.1.2">subscript</csymbol><ci id="algorithm1.13.13.m1.1.1.2.2.cmml" xref="algorithm1.13.13.m1.1.1.2.2">𝑆</ci><apply id="algorithm1.13.13.m1.1.1.2.3.cmml" xref="algorithm1.13.13.m1.1.1.2.3"><divide id="algorithm1.13.13.m1.1.1.2.3.1.cmml" xref="algorithm1.13.13.m1.1.1.2.3.1"></divide><ci id="algorithm1.13.13.m1.1.1.2.3.2.cmml" xref="algorithm1.13.13.m1.1.1.2.3.2">𝑙</ci><ci id="algorithm1.13.13.m1.1.1.2.3.3.cmml" xref="algorithm1.13.13.m1.1.1.2.3.3">𝑘</ci></apply></apply><apply id="algorithm1.13.13.m1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.3"><minus id="algorithm1.13.13.m1.1.1.3.1.cmml" xref="algorithm1.13.13.m1.1.1.3.1"></minus><apply id="algorithm1.13.13.m1.1.1.3.2.cmml" xref="algorithm1.13.13.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.1.1.3.2.1.cmml" xref="algorithm1.13.13.m1.1.1.3.2">subscript</csymbol><ci id="algorithm1.13.13.m1.1.1.3.2.2.cmml" xref="algorithm1.13.13.m1.1.1.3.2.2">𝑆</ci><apply id="algorithm1.13.13.m1.1.1.3.2.3.cmml" xref="algorithm1.13.13.m1.1.1.3.2.3"><divide id="algorithm1.13.13.m1.1.1.3.2.3.1.cmml" xref="algorithm1.13.13.m1.1.1.3.2.3.1"></divide><ci id="algorithm1.13.13.m1.1.1.3.2.3.2.cmml" xref="algorithm1.13.13.m1.1.1.3.2.3.2">𝑙</ci><ci id="algorithm1.13.13.m1.1.1.3.2.3.3.cmml" xref="algorithm1.13.13.m1.1.1.3.2.3.3">𝑘</ci></apply></apply><ci id="algorithm1.13.13.m1.1.1.3.3.cmml" xref="algorithm1.13.13.m1.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m1.1c">S_{l/k}\leftarrow S_{l/k}-M</annotation></semantics></math>;
</div>
<div id="algorithm1.14.19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span> end if
</div>
<div id="algorithm1.14.14" class="ltx_listingline">
<span id="algorithm1.14.14.2" class="ltx_text ltx_font_bold">return</span> <em id="algorithm1.14.14.1" class="ltx_emph ltx_font_italic"><math id="algorithm1.14.14.1.m1.1" class="ltx_Math" alttext="S_{l/k}" display="inline"><semantics id="algorithm1.14.14.1.m1.1a"><msub id="algorithm1.14.14.1.m1.1.1" xref="algorithm1.14.14.1.m1.1.1.cmml"><mi id="algorithm1.14.14.1.m1.1.1.2" xref="algorithm1.14.14.1.m1.1.1.2.cmml">S</mi><mrow id="algorithm1.14.14.1.m1.1.1.3" xref="algorithm1.14.14.1.m1.1.1.3.cmml"><mi id="algorithm1.14.14.1.m1.1.1.3.2" xref="algorithm1.14.14.1.m1.1.1.3.2.cmml">l</mi><mo id="algorithm1.14.14.1.m1.1.1.3.1" xref="algorithm1.14.14.1.m1.1.1.3.1.cmml">/</mo><mi id="algorithm1.14.14.1.m1.1.1.3.3" xref="algorithm1.14.14.1.m1.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.1.m1.1b"><apply id="algorithm1.14.14.1.m1.1.1.cmml" xref="algorithm1.14.14.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.14.14.1.m1.1.1.1.cmml" xref="algorithm1.14.14.1.m1.1.1">subscript</csymbol><ci id="algorithm1.14.14.1.m1.1.1.2.cmml" xref="algorithm1.14.14.1.m1.1.1.2">𝑆</ci><apply id="algorithm1.14.14.1.m1.1.1.3.cmml" xref="algorithm1.14.14.1.m1.1.1.3"><divide id="algorithm1.14.14.1.m1.1.1.3.1.cmml" xref="algorithm1.14.14.1.m1.1.1.3.1"></divide><ci id="algorithm1.14.14.1.m1.1.1.3.2.cmml" xref="algorithm1.14.14.1.m1.1.1.3.2">𝑙</ci><ci id="algorithm1.14.14.1.m1.1.1.3.3.cmml" xref="algorithm1.14.14.1.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.1.m1.1c">S_{l/k}</annotation></semantics></math></em>


</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.18.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>Montgomery Algorithm for Modular Multiplication with Radix <math id="algorithm1.16.m1.1" class="ltx_Math" alttext="2^{k}" display="inline"><semantics id="algorithm1.16.m1.1b"><msup id="algorithm1.16.m1.1.1" xref="algorithm1.16.m1.1.1.cmml"><mn id="algorithm1.16.m1.1.1.2" xref="algorithm1.16.m1.1.1.2.cmml">2</mn><mi id="algorithm1.16.m1.1.1.3" xref="algorithm1.16.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.16.m1.1c"><apply id="algorithm1.16.m1.1.1.cmml" xref="algorithm1.16.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.16.m1.1.1.1.cmml" xref="algorithm1.16.m1.1.1">superscript</csymbol><cn type="integer" id="algorithm1.16.m1.1.1.2.cmml" xref="algorithm1.16.m1.1.1.2">2</cn><ci id="algorithm1.16.m1.1.1.3.cmml" xref="algorithm1.16.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.m1.1d">2^{k}</annotation></semantics></math></figcaption>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Design and Implementation</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>System Overview</h3>

<figure id="S3.F2" class="ltx_figure"><img src="/html/2007.10560/assets/overview.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="231" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overview of Our Encryption Framework</figcaption>
</figure>
<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">The overall architecture of our encryption framework is shown in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.1 System Overview ‣ 3 Design and Implementation ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. The framework is envisioned to be hosted on cloud servers belonging to geo-distributed parties of federated learning. It includes components residing on both the host CPU and the FPGA, where a PCI-e bus provides communication between them.
The host CPU is responsible for the normal training workload of a machine learning model, while it batches the requests of encryption to sends to the FPGA, and encodes the floating point number used by machine learning to integers agree with HE schemes.
Apart from these necessities, our main contribution is designing high performance processors for Paillier computation on FPGA and encapsulating the hardware module as OpenCL kernel for invocation, which we will detail in Section <a href="#S3.SS2" title="3.2 Micro-architecture for Montgomery ModMult ‣ 3 Design and Implementation ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a> and <a href="#S3.SS3" title="3.3 Implementation ‣ 3 Design and Implementation ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a> respectively.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Micro-architecture for Montgomery ModMult</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.2" class="ltx_p">A Paillier processor encapsulates units for operations involved, i.e. modular multiplication, random number generator and integer divisor, along with its local storage. We replicate Paillier processors in HLS to deploy multiple copies, and the top level function is responsible for dispatching input data and collecting results. Since the Paillier processors are independent and work in parallel, the overall throughput of an FPGA chip can be determined by</p>
<table id="S3.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex1.m1.1" class="ltx_Math" alttext="\mathrm{Throughput}=\frac{\mbox{Total amount of resource}}{\mbox{Latency}\times\mbox{Resource consumption per core}}," display="block"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.2.cmml">Throughput</mi><mo id="S3.Ex1.m1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.cmml">=</mo><mfrac id="S3.Ex1.m1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.3.cmml"><mtext id="S3.Ex1.m1.1.1.1.1.3.2" xref="S3.Ex1.m1.1.1.1.1.3.2a.cmml">Total amount of resource</mtext><mrow id="S3.Ex1.m1.1.1.1.1.3.3" xref="S3.Ex1.m1.1.1.1.1.3.3.cmml"><mtext id="S3.Ex1.m1.1.1.1.1.3.3.2" xref="S3.Ex1.m1.1.1.1.1.3.3.2a.cmml">Latency</mtext><mo lspace="0.222em" rspace="0.222em" id="S3.Ex1.m1.1.1.1.1.3.3.1" xref="S3.Ex1.m1.1.1.1.1.3.3.1.cmml">×</mo><mtext id="S3.Ex1.m1.1.1.1.1.3.3.3" xref="S3.Ex1.m1.1.1.1.1.3.3.3a.cmml">Resource consumption per core</mtext></mrow></mfrac></mrow><mo id="S3.Ex1.m1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1"><eq id="S3.Ex1.m1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1"></eq><ci id="S3.Ex1.m1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2">Throughput</ci><apply id="S3.Ex1.m1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3"><divide id="S3.Ex1.m1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3"></divide><ci id="S3.Ex1.m1.1.1.1.1.3.2a.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2"><mtext id="S3.Ex1.m1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2">Total amount of resource</mtext></ci><apply id="S3.Ex1.m1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3.3"><times id="S3.Ex1.m1.1.1.1.1.3.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3.3.1"></times><ci id="S3.Ex1.m1.1.1.1.1.3.3.2a.cmml" xref="S3.Ex1.m1.1.1.1.1.3.3.2"><mtext id="S3.Ex1.m1.1.1.1.1.3.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.3.2">Latency</mtext></ci><ci id="S3.Ex1.m1.1.1.1.1.3.3.3a.cmml" xref="S3.Ex1.m1.1.1.1.1.3.3.3"><mtext id="S3.Ex1.m1.1.1.1.1.3.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3.3.3">Resource consumption per core</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\mathrm{Throughput}=\frac{\mbox{Total amount of resource}}{\mbox{Latency}\times\mbox{Resource consumption per core}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.1" class="ltx_p">where resource broadly refers to multipliers, adders, memory, etc., and latency can be further decomposed to clock cycle of execution <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mo id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><times id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\times</annotation></semantics></math> clock frequency. Therefore, our design guideline is to optimize the Montgomery ModMult operation lying at the heart of Paillier cryptosystem, with respect to clock cycle, resource allocation, clock frequency, in addition to memory usage. We elaborate on the optimization on these dimensions as below.</p>
</div>
<section id="S3.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Clock Cycle</h4>

<div id="S3.SS2.SSS1.p1" class="ltx_para">
<p id="S3.SS2.SSS1.p1.3" class="ltx_p">Generally, the clock cycle required by an algorithm is intrinsically lower bounded by the number of operations and the critical path in the dependency graph. As shown in Algorithm <a href="#algorithm1" title="In 2.3 Paillier Homomorphic Encryption ‣ 2 Background ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the body of the Montgomery algorithm is a two-level loop, consisting of <math id="S3.SS2.SSS1.p1.1.m1.2" class="ltx_Math" alttext="2(l/k)(l/k+1)" display="inline"><semantics id="S3.SS2.SSS1.p1.1.m1.2a"><mrow id="S3.SS2.SSS1.p1.1.m1.2.2" xref="S3.SS2.SSS1.p1.1.m1.2.2.cmml"><mn id="S3.SS2.SSS1.p1.1.m1.2.2.4" xref="S3.SS2.SSS1.p1.1.m1.2.2.4.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.1.m1.2.2.3" xref="S3.SS2.SSS1.p1.1.m1.2.2.3.cmml">​</mo><mrow id="S3.SS2.SSS1.p1.1.m1.1.1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.2.cmml">l</mi><mo id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.cmml">/</mo><mi id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.3.cmml">k</mi></mrow><mo stretchy="false" id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.1.m1.2.2.3a" xref="S3.SS2.SSS1.p1.1.m1.2.2.3.cmml">​</mo><mrow id="S3.SS2.SSS1.p1.1.m1.2.2.2.1" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p1.1.m1.2.2.2.1.2" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.cmml"><mrow id="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.2" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.2.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.2.2" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.2.2.cmml">l</mi><mo id="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.2.1" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.2.1.cmml">/</mo><mi id="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.2.3" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.2.3.cmml">k</mi></mrow><mo id="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.1" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.1.cmml">+</mo><mn id="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.SSS1.p1.1.m1.2.2.2.1.3" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.2b"><apply id="S3.SS2.SSS1.p1.1.m1.2.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2"><times id="S3.SS2.SSS1.p1.1.m1.2.2.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.3"></times><cn type="integer" id="S3.SS2.SSS1.p1.1.m1.2.2.4.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.4">2</cn><apply id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1"><divide id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1"></divide><ci id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.2">𝑙</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.1"><plus id="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.1"></plus><apply id="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.2"><divide id="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.2.1"></divide><ci id="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.2.2">𝑙</ci><ci id="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.2.3">𝑘</ci></apply><cn type="integer" id="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.2c">2(l/k)(l/k+1)</annotation></semantics></math> multiplications. Thus, the ideal clock cycle will be <math id="S3.SS2.SSS1.p1.2.m2.2" class="ltx_Math" alttext="2(l/k)(l/k+1)" display="inline"><semantics id="S3.SS2.SSS1.p1.2.m2.2a"><mrow id="S3.SS2.SSS1.p1.2.m2.2.2" xref="S3.SS2.SSS1.p1.2.m2.2.2.cmml"><mn id="S3.SS2.SSS1.p1.2.m2.2.2.4" xref="S3.SS2.SSS1.p1.2.m2.2.2.4.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.2.m2.2.2.3" xref="S3.SS2.SSS1.p1.2.m2.2.2.3.cmml">​</mo><mrow id="S3.SS2.SSS1.p1.2.m2.1.1.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.2.cmml">l</mi><mo id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.1.cmml">/</mo><mi id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.3.cmml">k</mi></mrow><mo stretchy="false" id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.3" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.2.m2.2.2.3a" xref="S3.SS2.SSS1.p1.2.m2.2.2.3.cmml">​</mo><mrow id="S3.SS2.SSS1.p1.2.m2.2.2.2.1" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p1.2.m2.2.2.2.1.2" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.cmml"><mrow id="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.2" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.2.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.2.2" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.2.2.cmml">l</mi><mo id="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.2.1" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.2.1.cmml">/</mo><mi id="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.2.3" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.2.3.cmml">k</mi></mrow><mo id="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.1" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.1.cmml">+</mo><mn id="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.3" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.SSS1.p1.2.m2.2.2.2.1.3" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.2b"><apply id="S3.SS2.SSS1.p1.2.m2.2.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2"><times id="S3.SS2.SSS1.p1.2.m2.2.2.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.3"></times><cn type="integer" id="S3.SS2.SSS1.p1.2.m2.2.2.4.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.4">2</cn><apply id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1"><divide id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.1"></divide><ci id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.2">𝑙</ci><ci id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.1"><plus id="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.1"></plus><apply id="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.2"><divide id="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.2.1"></divide><ci id="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.2.2">𝑙</ci><ci id="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.2.3">𝑘</ci></apply><cn type="integer" id="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.2c">2(l/k)(l/k+1)</annotation></semantics></math> divided by the number of multipliers, even if we ignore the rest of the operations. On the other hand, as the execution of each inner iteration depends on the iteration before, it is hard to force a parallel execution of the inner iterations. Our goal is to deploy two multipliers for an inner iteration, and obtain a clock cycle number as close to <math id="S3.SS2.SSS1.p1.3.m3.2" class="ltx_Math" alttext="(l/k)(l/k+1)" display="inline"><semantics id="S3.SS2.SSS1.p1.3.m3.2a"><mrow id="S3.SS2.SSS1.p1.3.m3.2.2" xref="S3.SS2.SSS1.p1.3.m3.2.2.cmml"><mrow id="S3.SS2.SSS1.p1.3.m3.1.1.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.2.cmml">l</mi><mo id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.cmml">/</mo><mi id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.3.cmml">k</mi></mrow><mo stretchy="false" id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.3.m3.2.2.3" xref="S3.SS2.SSS1.p1.3.m3.2.2.3.cmml">​</mo><mrow id="S3.SS2.SSS1.p1.3.m3.2.2.2.1" xref="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p1.3.m3.2.2.2.1.2" xref="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1" xref="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.cmml"><mrow id="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.2" xref="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.2.cmml"><mi id="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.2.2" xref="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.2.2.cmml">l</mi><mo id="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.2.1" xref="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.2.1.cmml">/</mo><mi id="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.2.3" xref="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.2.3.cmml">k</mi></mrow><mo id="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.1" xref="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.1.cmml">+</mo><mn id="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.3" xref="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.SSS1.p1.3.m3.2.2.2.1.3" xref="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.3.m3.2b"><apply id="S3.SS2.SSS1.p1.3.m3.2.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.2.2"><times id="S3.SS2.SSS1.p1.3.m3.2.2.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.2.2.3"></times><apply id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1"><divide id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1"></divide><ci id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.2">𝑙</ci><ci id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.2.2.2.1"><plus id="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.1"></plus><apply id="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.2"><divide id="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.2.1"></divide><ci id="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.2.2">𝑙</ci><ci id="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.2.3">𝑘</ci></apply><cn type="integer" id="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.2.2.2.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.3.m3.2c">(l/k)(l/k+1)</annotation></semantics></math> as possible.</p>
</div>
<div id="S3.SS2.SSS1.p2" class="ltx_para">
<p id="S3.SS2.SSS1.p2.5" class="ltx_p">Another dependency issue that deserves attention is the computation of <math id="S3.SS2.SSS1.p2.1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS2.SSS1.p2.1.m1.1a"><mi id="S3.SS2.SSS1.p2.1.m1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.1.m1.1b"><ci id="S3.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.1.m1.1c">q</annotation></semantics></math> in each outer iteration. In the <math id="S3.SS2.SSS1.p2.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS1.p2.2.m2.1a"><mi id="S3.SS2.SSS1.p2.2.m2.1.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.2.m2.1b"><ci id="S3.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.2.m2.1c">i</annotation></semantics></math>th iteration, <math id="S3.SS2.SSS1.p2.3.m3.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS2.SSS1.p2.3.m3.1a"><mi id="S3.SS2.SSS1.p2.3.m3.1.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.3.m3.1b"><ci id="S3.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.3.m3.1c">q</annotation></semantics></math> depends on the value of <math id="S3.SS2.SSS1.p2.4.m4.1" class="ltx_Math" alttext="S_{i-1}" display="inline"><semantics id="S3.SS2.SSS1.p2.4.m4.1a"><msub id="S3.SS2.SSS1.p2.4.m4.1.1" xref="S3.SS2.SSS1.p2.4.m4.1.1.cmml"><mi id="S3.SS2.SSS1.p2.4.m4.1.1.2" xref="S3.SS2.SSS1.p2.4.m4.1.1.2.cmml">S</mi><mrow id="S3.SS2.SSS1.p2.4.m4.1.1.3" xref="S3.SS2.SSS1.p2.4.m4.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.4.m4.1.1.3.2" xref="S3.SS2.SSS1.p2.4.m4.1.1.3.2.cmml">i</mi><mo id="S3.SS2.SSS1.p2.4.m4.1.1.3.1" xref="S3.SS2.SSS1.p2.4.m4.1.1.3.1.cmml">−</mo><mn id="S3.SS2.SSS1.p2.4.m4.1.1.3.3" xref="S3.SS2.SSS1.p2.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.4.m4.1b"><apply id="S3.SS2.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.4.m4.1.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.4.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.2">𝑆</ci><apply id="S3.SS2.SSS1.p2.4.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.3"><minus id="S3.SS2.SSS1.p2.4.m4.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.3.1"></minus><ci id="S3.SS2.SSS1.p2.4.m4.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS2.SSS1.p2.4.m4.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.4.m4.1c">S_{i-1}</annotation></semantics></math>, while it is necessary in the computation of inner loops. However, if <math id="S3.SS2.SSS1.p2.5.m5.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS2.SSS1.p2.5.m5.1a"><mi id="S3.SS2.SSS1.p2.5.m5.1.1" xref="S3.SS2.SSS1.p2.5.m5.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.5.m5.1b"><ci id="S3.SS2.SSS1.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.5.m5.1c">q</annotation></semantics></math> is computed before the start of inner loop, the latency will be magnified by the number of outer iterations.</p>
</div>
<div id="S3.SS2.SSS1.p3" class="ltx_para">
<p id="S3.SS2.SSS1.p3.1" class="ltx_p">To enforce a tight scheduling, we make the following optimizations in HLS:</p>
</div>
<div id="S3.SS2.SSS1.p4" class="ltx_para">
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.1" class="ltx_p">Unrolling the inner loop. This can be done through an UNROLL directive in HLS, or manually repeat part of the loop. Unrolling the loop does not lead to parallel execution of iterations. However, this is the only way to disassemble all the operations composing the loop, achieving the flexibility of scheduling to overlap operations as much as possible. Also, without unrolling we are not able to insert the computation of <math id="S3.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.I1.i1.p1.1.m1.1a"><mi id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.1b"><ci id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.1c">q</annotation></semantics></math> into the middle of an inner loop.</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.7" class="ltx_p">Interleaving the <math id="S3.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.I1.i2.p1.1.m1.1a"><mi id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b"><ci id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">q</annotation></semantics></math> computation with the inner loop. As discussed before, the <math id="S3.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.I1.i2.p1.2.m2.1a"><mi id="S3.I1.i2.p1.2.m2.1.1" xref="S3.I1.i2.p1.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.2.m2.1b"><ci id="S3.I1.i2.p1.2.m2.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.2.m2.1c">q</annotation></semantics></math> value used in each inner loop must be computed before. Since the <math id="S3.I1.i2.p1.3.m3.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.I1.i2.p1.3.m3.1a"><mi id="S3.I1.i2.p1.3.m3.1.1" xref="S3.I1.i2.p1.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.3.m3.1b"><ci id="S3.I1.i2.p1.3.m3.1.1.cmml" xref="S3.I1.i2.p1.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.3.m3.1c">q</annotation></semantics></math> value for computing <math id="S3.I1.i2.p1.4.m4.1" class="ltx_Math" alttext="S_{i}" display="inline"><semantics id="S3.I1.i2.p1.4.m4.1a"><msub id="S3.I1.i2.p1.4.m4.1.1" xref="S3.I1.i2.p1.4.m4.1.1.cmml"><mi id="S3.I1.i2.p1.4.m4.1.1.2" xref="S3.I1.i2.p1.4.m4.1.1.2.cmml">S</mi><mi id="S3.I1.i2.p1.4.m4.1.1.3" xref="S3.I1.i2.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.4.m4.1b"><apply id="S3.I1.i2.p1.4.m4.1.1.cmml" xref="S3.I1.i2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.4.m4.1.1.1.cmml" xref="S3.I1.i2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.4.m4.1.1.2.cmml" xref="S3.I1.i2.p1.4.m4.1.1.2">𝑆</ci><ci id="S3.I1.i2.p1.4.m4.1.1.3.cmml" xref="S3.I1.i2.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.4.m4.1c">S_{i}</annotation></semantics></math> only relies on first few words of <math id="S3.I1.i2.p1.5.m5.1" class="ltx_Math" alttext="S_{i-1}" display="inline"><semantics id="S3.I1.i2.p1.5.m5.1a"><msub id="S3.I1.i2.p1.5.m5.1.1" xref="S3.I1.i2.p1.5.m5.1.1.cmml"><mi id="S3.I1.i2.p1.5.m5.1.1.2" xref="S3.I1.i2.p1.5.m5.1.1.2.cmml">S</mi><mrow id="S3.I1.i2.p1.5.m5.1.1.3" xref="S3.I1.i2.p1.5.m5.1.1.3.cmml"><mi id="S3.I1.i2.p1.5.m5.1.1.3.2" xref="S3.I1.i2.p1.5.m5.1.1.3.2.cmml">i</mi><mo id="S3.I1.i2.p1.5.m5.1.1.3.1" xref="S3.I1.i2.p1.5.m5.1.1.3.1.cmml">−</mo><mn id="S3.I1.i2.p1.5.m5.1.1.3.3" xref="S3.I1.i2.p1.5.m5.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.5.m5.1b"><apply id="S3.I1.i2.p1.5.m5.1.1.cmml" xref="S3.I1.i2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.5.m5.1.1.1.cmml" xref="S3.I1.i2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.5.m5.1.1.2.cmml" xref="S3.I1.i2.p1.5.m5.1.1.2">𝑆</ci><apply id="S3.I1.i2.p1.5.m5.1.1.3.cmml" xref="S3.I1.i2.p1.5.m5.1.1.3"><minus id="S3.I1.i2.p1.5.m5.1.1.3.1.cmml" xref="S3.I1.i2.p1.5.m5.1.1.3.1"></minus><ci id="S3.I1.i2.p1.5.m5.1.1.3.2.cmml" xref="S3.I1.i2.p1.5.m5.1.1.3.2">𝑖</ci><cn type="integer" id="S3.I1.i2.p1.5.m5.1.1.3.3.cmml" xref="S3.I1.i2.p1.5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.5.m5.1c">S_{i-1}</annotation></semantics></math>, it is possible to start generating <math id="S3.I1.i2.p1.6.m6.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.I1.i2.p1.6.m6.1a"><mi id="S3.I1.i2.p1.6.m6.1.1" xref="S3.I1.i2.p1.6.m6.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.6.m6.1b"><ci id="S3.I1.i2.p1.6.m6.1.1.cmml" xref="S3.I1.i2.p1.6.m6.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.6.m6.1c">q</annotation></semantics></math> in the last inner loop when those words are ready. In this way we can obtain <math id="S3.I1.i2.p1.7.m7.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.I1.i2.p1.7.m7.1a"><mi id="S3.I1.i2.p1.7.m7.1.1" xref="S3.I1.i2.p1.7.m7.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.7.m7.1b"><ci id="S3.I1.i2.p1.7.m7.1.1.cmml" xref="S3.I1.i2.p1.7.m7.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.7.m7.1c">q</annotation></semantics></math> in advance and hide its latency.</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p id="S3.I1.i3.p1.1" class="ltx_p">Pipelining the outer loop. We achieve this by inserting a PIPELINE directive in HLS, with the initiation interval set to the number of iterations contained in an inner loop. The final step of schedule enforcement is to pipeline all the iterations. We aim to pipeline both the outer loop and the inner loop by unrolling the inner loop, and pipelining the outer loop, so that the inner loop is naturally pipelined by scheduling the disassembled operations, and the outer loop try to start an interaction each time when a whole inner loop is initiated.</p>
</div>
</li>
</ul>
</div>
<figure id="S3.F4" class="ltx_figure">
<table id="S3.F4.2" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.F4.2.2" class="ltx_tr">
<td id="S3.F4.2.2.2" class="ltx_td ltx_align_center">
<div id="S3.F4.1.1.1.1" class="ltx_block ltx_minipage ltx_align_top" style="width:303.5pt;">
<img src="/html/2007.10560/assets/sched.png" id="S3.F4.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="194" alt="[Uncaptioned image]">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_block">Figure 3: </span>Pipeline Execution of the Montgomery ModMult Operation</figcaption>
</div>

<div id="S3.F4.2.2.2.2" class="ltx_block ltx_minipage ltx_align_top" style="width:121.4pt;">
<img src="/html/2007.10560/assets/pe.png" id="S3.F4.2.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="598" height="440" alt="[Uncaptioned image]">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_block">Figure 4: </span>Processing Element Implementing the Inner Loop of Algorithm <a href="#algorithm1" title="In 2.3 Paillier Homomorphic Encryption ‣ 2 Background ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a></figcaption>
</div>
</td>
</tr>
</tbody>
</table>
</figure>
<div id="S3.SS2.SSS1.p5" class="ltx_para">
<p id="S3.SS2.SSS1.p5.6" class="ltx_p">The resulted scheduling is shown in Figure <a href="#S3.F4" title="Figure 4 ‣ 3.2.1 Clock Cycle ‣ 3.2 Micro-architecture for Montgomery ModMult ‣ 3 Design and Implementation ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. We illustrate with an example with operands 4 words in length (i.e. <math id="S3.SS2.SSS1.p5.1.m1.1" class="ltx_Math" alttext="l/k=4" display="inline"><semantics id="S3.SS2.SSS1.p5.1.m1.1a"><mrow id="S3.SS2.SSS1.p5.1.m1.1.1" xref="S3.SS2.SSS1.p5.1.m1.1.1.cmml"><mrow id="S3.SS2.SSS1.p5.1.m1.1.1.2" xref="S3.SS2.SSS1.p5.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS1.p5.1.m1.1.1.2.2" xref="S3.SS2.SSS1.p5.1.m1.1.1.2.2.cmml">l</mi><mo id="S3.SS2.SSS1.p5.1.m1.1.1.2.1" xref="S3.SS2.SSS1.p5.1.m1.1.1.2.1.cmml">/</mo><mi id="S3.SS2.SSS1.p5.1.m1.1.1.2.3" xref="S3.SS2.SSS1.p5.1.m1.1.1.2.3.cmml">k</mi></mrow><mo id="S3.SS2.SSS1.p5.1.m1.1.1.1" xref="S3.SS2.SSS1.p5.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS2.SSS1.p5.1.m1.1.1.3" xref="S3.SS2.SSS1.p5.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.1.m1.1b"><apply id="S3.SS2.SSS1.p5.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p5.1.m1.1.1"><eq id="S3.SS2.SSS1.p5.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p5.1.m1.1.1.1"></eq><apply id="S3.SS2.SSS1.p5.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p5.1.m1.1.1.2"><divide id="S3.SS2.SSS1.p5.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p5.1.m1.1.1.2.1"></divide><ci id="S3.SS2.SSS1.p5.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p5.1.m1.1.1.2.2">𝑙</ci><ci id="S3.SS2.SSS1.p5.1.m1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p5.1.m1.1.1.2.3">𝑘</ci></apply><cn type="integer" id="S3.SS2.SSS1.p5.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p5.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.1.m1.1c">l/k=4</annotation></semantics></math>), and the computation of each inner iteration takes 4 clock cycles to complete. Initially, the schedule computes <math id="S3.SS2.SSS1.p5.2.m2.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS2.SSS1.p5.2.m2.1a"><mi id="S3.SS2.SSS1.p5.2.m2.1.1" xref="S3.SS2.SSS1.p5.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.2.m2.1b"><ci id="S3.SS2.SSS1.p5.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p5.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.2.m2.1c">q</annotation></semantics></math> for the first inner loop (not shown in the figure), and then initiates the inner iterations sequentially. In the meantime, as soon as <math id="S3.SS2.SSS1.p5.3.m3.1" class="ltx_Math" alttext="S^{0}" display="inline"><semantics id="S3.SS2.SSS1.p5.3.m3.1a"><msup id="S3.SS2.SSS1.p5.3.m3.1.1" xref="S3.SS2.SSS1.p5.3.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p5.3.m3.1.1.2" xref="S3.SS2.SSS1.p5.3.m3.1.1.2.cmml">S</mi><mn id="S3.SS2.SSS1.p5.3.m3.1.1.3" xref="S3.SS2.SSS1.p5.3.m3.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.3.m3.1b"><apply id="S3.SS2.SSS1.p5.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p5.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p5.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p5.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p5.3.m3.1.1.2">𝑆</ci><cn type="integer" id="S3.SS2.SSS1.p5.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p5.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.3.m3.1c">S^{0}</annotation></semantics></math> is ready, it can be used to compute <math id="S3.SS2.SSS1.p5.4.m4.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS2.SSS1.p5.4.m4.1a"><mi id="S3.SS2.SSS1.p5.4.m4.1.1" xref="S3.SS2.SSS1.p5.4.m4.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.4.m4.1b"><ci id="S3.SS2.SSS1.p5.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p5.4.m4.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.4.m4.1c">q</annotation></semantics></math> for the next inner loop. Hence, when the last inner iteration ends, the first iteration of the next inner loop can start immediately with the precomputed <math id="S3.SS2.SSS1.p5.5.m5.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS2.SSS1.p5.5.m5.1a"><mi id="S3.SS2.SSS1.p5.5.m5.1.1" xref="S3.SS2.SSS1.p5.5.m5.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.5.m5.1b"><ci id="S3.SS2.SSS1.p5.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p5.5.m5.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.5.m5.1c">q</annotation></semantics></math>. Therefore, we enable a tight schedule that initiates an inner iteration each clock cycle. The resulted execution clock cycle is <math id="S3.SS2.SSS1.p5.6.m6.2" class="ltx_Math" alttext="(l/k)(l/k+1)" display="inline"><semantics id="S3.SS2.SSS1.p5.6.m6.2a"><mrow id="S3.SS2.SSS1.p5.6.m6.2.2" xref="S3.SS2.SSS1.p5.6.m6.2.2.cmml"><mrow id="S3.SS2.SSS1.p5.6.m6.1.1.1.1" xref="S3.SS2.SSS1.p5.6.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p5.6.m6.1.1.1.1.2" xref="S3.SS2.SSS1.p5.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p5.6.m6.1.1.1.1.1" xref="S3.SS2.SSS1.p5.6.m6.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p5.6.m6.1.1.1.1.1.2" xref="S3.SS2.SSS1.p5.6.m6.1.1.1.1.1.2.cmml">l</mi><mo id="S3.SS2.SSS1.p5.6.m6.1.1.1.1.1.1" xref="S3.SS2.SSS1.p5.6.m6.1.1.1.1.1.1.cmml">/</mo><mi id="S3.SS2.SSS1.p5.6.m6.1.1.1.1.1.3" xref="S3.SS2.SSS1.p5.6.m6.1.1.1.1.1.3.cmml">k</mi></mrow><mo stretchy="false" id="S3.SS2.SSS1.p5.6.m6.1.1.1.1.3" xref="S3.SS2.SSS1.p5.6.m6.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p5.6.m6.2.2.3" xref="S3.SS2.SSS1.p5.6.m6.2.2.3.cmml">​</mo><mrow id="S3.SS2.SSS1.p5.6.m6.2.2.2.1" xref="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p5.6.m6.2.2.2.1.2" xref="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1" xref="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.cmml"><mrow id="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.2" xref="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.2.cmml"><mi id="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.2.2" xref="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.2.2.cmml">l</mi><mo id="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.2.1" xref="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.2.1.cmml">/</mo><mi id="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.2.3" xref="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.2.3.cmml">k</mi></mrow><mo id="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.1" xref="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.1.cmml">+</mo><mn id="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.3" xref="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.SSS1.p5.6.m6.2.2.2.1.3" xref="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.6.m6.2b"><apply id="S3.SS2.SSS1.p5.6.m6.2.2.cmml" xref="S3.SS2.SSS1.p5.6.m6.2.2"><times id="S3.SS2.SSS1.p5.6.m6.2.2.3.cmml" xref="S3.SS2.SSS1.p5.6.m6.2.2.3"></times><apply id="S3.SS2.SSS1.p5.6.m6.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p5.6.m6.1.1.1.1"><divide id="S3.SS2.SSS1.p5.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p5.6.m6.1.1.1.1.1.1"></divide><ci id="S3.SS2.SSS1.p5.6.m6.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p5.6.m6.1.1.1.1.1.2">𝑙</ci><ci id="S3.SS2.SSS1.p5.6.m6.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p5.6.m6.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.cmml" xref="S3.SS2.SSS1.p5.6.m6.2.2.2.1"><plus id="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.1.cmml" xref="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.1"></plus><apply id="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.2.cmml" xref="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.2"><divide id="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.2.1.cmml" xref="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.2.1"></divide><ci id="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.2.2.cmml" xref="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.2.2">𝑙</ci><ci id="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.2.3.cmml" xref="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.2.3">𝑘</ci></apply><cn type="integer" id="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.3.cmml" xref="S3.SS2.SSS1.p5.6.m6.2.2.2.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.6.m6.2c">(l/k)(l/k+1)</annotation></semantics></math>, plus the number of pipeline stages, and a few cycles for data read-in and write-out.</p>
</div>
</section>
<section id="S3.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Resource Allocation</h4>

<div id="S3.SS2.SSS2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.p1.1" class="ltx_p">In this work, we utilize the embedded DSP blocks on the FPGA chip to construct pipelined multipliers. For the remaining logic, including adder, multiplexer, integer comparison, finite state machine, etc., we leave them to lookup-table (LUT). As DSP on FPGA is scarce and expensive, we use them to carry out the heavy multiplication only. Further, we will show purely relying on LUT to implement ModMult operation is not economic (Section <a href="#S4" title="4 Evaluation ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>). Therefore, we will focus on the usage of LUT and DSP, and reduce the area and DSP usage without sacrificing the performance.</p>
</div>
<div id="S3.SS2.SSS2.p2" class="ltx_para">
<p id="S3.SS2.SSS2.p2.4" class="ltx_p">We encapsulate the operations comprising an inner iteration into a processing element (PE), as shown in Figure <a href="#S3.F4" title="Figure 4 ‣ 3.2.1 Clock Cycle ‣ 3.2 Micro-architecture for Montgomery ModMult ‣ 3 Design and Implementation ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. Each PE contains two multipliers to perform the two independent multiplications <math id="S3.SS2.SSS2.p2.1.m1.1" class="ltx_Math" alttext="x*y" display="inline"><semantics id="S3.SS2.SSS2.p2.1.m1.1a"><mrow id="S3.SS2.SSS2.p2.1.m1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.SSS2.p2.1.m1.1.1.2" xref="S3.SS2.SSS2.p2.1.m1.1.1.2.cmml">x</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS2.p2.1.m1.1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.cmml">∗</mo><mi id="S3.SS2.SSS2.p2.1.m1.1.1.3" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.1.m1.1b"><apply id="S3.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1"><times id="S3.SS2.SSS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1"></times><ci id="S3.SS2.SSS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.2">𝑥</ci><ci id="S3.SS2.SSS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.1.m1.1c">x*y</annotation></semantics></math> and <math id="S3.SS2.SSS2.p2.2.m2.1" class="ltx_Math" alttext="q*m" display="inline"><semantics id="S3.SS2.SSS2.p2.2.m2.1a"><mrow id="S3.SS2.SSS2.p2.2.m2.1.1" xref="S3.SS2.SSS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.SSS2.p2.2.m2.1.1.2" xref="S3.SS2.SSS2.p2.2.m2.1.1.2.cmml">q</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS2.p2.2.m2.1.1.1" xref="S3.SS2.SSS2.p2.2.m2.1.1.1.cmml">∗</mo><mi id="S3.SS2.SSS2.p2.2.m2.1.1.3" xref="S3.SS2.SSS2.p2.2.m2.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.2.m2.1b"><apply id="S3.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1"><times id="S3.SS2.SSS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1.1"></times><ci id="S3.SS2.SSS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1.2">𝑞</ci><ci id="S3.SS2.SSS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.2.m2.1c">q*m</annotation></semantics></math>. Then it accepts <math id="S3.SS2.SSS2.p2.3.m3.1" class="ltx_Math" alttext="S_{i-1}^{j}" display="inline"><semantics id="S3.SS2.SSS2.p2.3.m3.1a"><msubsup id="S3.SS2.SSS2.p2.3.m3.1.1" xref="S3.SS2.SSS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.SSS2.p2.3.m3.1.1.2.2" xref="S3.SS2.SSS2.p2.3.m3.1.1.2.2.cmml">S</mi><mrow id="S3.SS2.SSS2.p2.3.m3.1.1.2.3" xref="S3.SS2.SSS2.p2.3.m3.1.1.2.3.cmml"><mi id="S3.SS2.SSS2.p2.3.m3.1.1.2.3.2" xref="S3.SS2.SSS2.p2.3.m3.1.1.2.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.p2.3.m3.1.1.2.3.1" xref="S3.SS2.SSS2.p2.3.m3.1.1.2.3.1.cmml">−</mo><mn id="S3.SS2.SSS2.p2.3.m3.1.1.2.3.3" xref="S3.SS2.SSS2.p2.3.m3.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS2.p2.3.m3.1.1.3" xref="S3.SS2.SSS2.p2.3.m3.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.3.m3.1b"><apply id="S3.SS2.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.3.m3.1.1.2.1.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.3.m3.1.1.2.2.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1.2.2">𝑆</ci><apply id="S3.SS2.SSS2.p2.3.m3.1.1.2.3.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1.2.3"><minus id="S3.SS2.SSS2.p2.3.m3.1.1.2.3.1.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1.2.3.1"></minus><ci id="S3.SS2.SSS2.p2.3.m3.1.1.2.3.2.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS2.SSS2.p2.3.m3.1.1.2.3.3.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS2.SSS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.3.m3.1c">S_{i-1}^{j}</annotation></semantics></math> of the last outer iteration, and a carry word (not shown in the figure), adds them with the multiplication results, and then outputs <math id="S3.SS2.SSS2.p2.4.m4.1" class="ltx_Math" alttext="S_{i}^{j}" display="inline"><semantics id="S3.SS2.SSS2.p2.4.m4.1a"><msubsup id="S3.SS2.SSS2.p2.4.m4.1.1" xref="S3.SS2.SSS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.SSS2.p2.4.m4.1.1.2.2" xref="S3.SS2.SSS2.p2.4.m4.1.1.2.2.cmml">S</mi><mi id="S3.SS2.SSS2.p2.4.m4.1.1.2.3" xref="S3.SS2.SSS2.p2.4.m4.1.1.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p2.4.m4.1.1.3" xref="S3.SS2.SSS2.p2.4.m4.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.4.m4.1b"><apply id="S3.SS2.SSS2.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.2.2">𝑆</ci><ci id="S3.SS2.SSS2.p2.4.m4.1.1.2.3.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.4.m4.1c">S_{i}^{j}</annotation></semantics></math> and a carry word. Then we limit the number of PE to 1, with an ALLOCATION directive in HLS. This is to avoid the resource bloating owing to loop unrolling, so that only resource for computing one inner iteration is actually allocated, and to reduce the overall area of the micro-architecture.</p>
</div>
<div id="S3.SS2.SSS2.p3" class="ltx_para">
<p id="S3.SS2.SSS2.p3.3" class="ltx_p">We also employ the Karatsuba algorithm to construct DSP-conservative multipliers. As shown in Algorithm <a href="#algorithm2" title="In 3.2.2 Resource Allocation ‣ 3.2 Micro-architecture for Montgomery ModMult ‣ 3 Design and Implementation ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, Karatsuba algorithm performs an integer multiplication by recursively breaking it into three of half size. Its efficiency is attributed to one multiplication less than the schoolbook algorithm, and we take advantage of it to allocate DSPs according to the actual number of operations. For instance, a DSP48E1 block is able to carry out <math id="S3.SS2.SSS2.p3.1.m1.1" class="ltx_Math" alttext="18\times 25" display="inline"><semantics id="S3.SS2.SSS2.p3.1.m1.1a"><mrow id="S3.SS2.SSS2.p3.1.m1.1.1" xref="S3.SS2.SSS2.p3.1.m1.1.1.cmml"><mn id="S3.SS2.SSS2.p3.1.m1.1.1.2" xref="S3.SS2.SSS2.p3.1.m1.1.1.2.cmml">18</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS2.p3.1.m1.1.1.1" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.cmml">×</mo><mn id="S3.SS2.SSS2.p3.1.m1.1.1.3" xref="S3.SS2.SSS2.p3.1.m1.1.1.3.cmml">25</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.1.m1.1b"><apply id="S3.SS2.SSS2.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1"><times id="S3.SS2.SSS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1"></times><cn type="integer" id="S3.SS2.SSS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.2">18</cn><cn type="integer" id="S3.SS2.SSS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.3">25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.1.m1.1c">18\times 25</annotation></semantics></math>-bit multiplication, and a <math id="S3.SS2.SSS2.p3.2.m2.1" class="ltx_Math" alttext="32\times 32" display="inline"><semantics id="S3.SS2.SSS2.p3.2.m2.1a"><mrow id="S3.SS2.SSS2.p3.2.m2.1.1" xref="S3.SS2.SSS2.p3.2.m2.1.1.cmml"><mn id="S3.SS2.SSS2.p3.2.m2.1.1.2" xref="S3.SS2.SSS2.p3.2.m2.1.1.2.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS2.p3.2.m2.1.1.1" xref="S3.SS2.SSS2.p3.2.m2.1.1.1.cmml">×</mo><mn id="S3.SS2.SSS2.p3.2.m2.1.1.3" xref="S3.SS2.SSS2.p3.2.m2.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.2.m2.1b"><apply id="S3.SS2.SSS2.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1"><times id="S3.SS2.SSS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1.1"></times><cn type="integer" id="S3.SS2.SSS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1.2">32</cn><cn type="integer" id="S3.SS2.SSS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.2.m2.1c">32\times 32</annotation></semantics></math> one can be divided into <math id="S3.SS2.SSS2.p3.3.m3.1" class="ltx_Math" alttext="16\times 16" display="inline"><semantics id="S3.SS2.SSS2.p3.3.m3.1a"><mrow id="S3.SS2.SSS2.p3.3.m3.1.1" xref="S3.SS2.SSS2.p3.3.m3.1.1.cmml"><mn id="S3.SS2.SSS2.p3.3.m3.1.1.2" xref="S3.SS2.SSS2.p3.3.m3.1.1.2.cmml">16</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS2.p3.3.m3.1.1.1" xref="S3.SS2.SSS2.p3.3.m3.1.1.1.cmml">×</mo><mn id="S3.SS2.SSS2.p3.3.m3.1.1.3" xref="S3.SS2.SSS2.p3.3.m3.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.3.m3.1b"><apply id="S3.SS2.SSS2.p3.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1"><times id="S3.SS2.SSS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1.1"></times><cn type="integer" id="S3.SS2.SSS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1.2">16</cn><cn type="integer" id="S3.SS2.SSS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.3.m3.1c">16\times 16</annotation></semantics></math> ones, and takes up 3 DSP blocks.</p>
</div>
<figure id="algorithm2" class="ltx_float ltx_algorithm">
<div id="algorithm2.13" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm2.3.3" class="ltx_listingline">
<span id="algorithm2.3.3.1" class="ltx_text"><span id="algorithm2.3.3.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>Operands <math id="algorithm2.1.1.m1.1" class="ltx_Math" alttext="X" display="inline"><semantics id="algorithm2.1.1.m1.1a"><mi id="algorithm2.1.1.m1.1.1" xref="algorithm2.1.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="algorithm2.1.1.m1.1b"><ci id="algorithm2.1.1.m1.1.1.cmml" xref="algorithm2.1.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.1.1.m1.1c">X</annotation></semantics></math> and <math id="algorithm2.2.2.m2.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="algorithm2.2.2.m2.1a"><mi id="algorithm2.2.2.m2.1.1" xref="algorithm2.2.2.m2.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="algorithm2.2.2.m2.1b"><ci id="algorithm2.2.2.m2.1.1.cmml" xref="algorithm2.2.2.m2.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.2.2.m2.1c">Y</annotation></semantics></math>, the length of operand <math id="algorithm2.3.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algorithm2.3.3.m3.1a"><mi id="algorithm2.3.3.m3.1.1" xref="algorithm2.3.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algorithm2.3.3.m3.1b"><ci id="algorithm2.3.3.m3.1.1.cmml" xref="algorithm2.3.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.3.3.m3.1c">k</annotation></semantics></math>
</div>
<div id="algorithm2.4.4" class="ltx_listingline">
<span id="algorithm2.4.4.1" class="ltx_text"><span id="algorithm2.4.4.1.1" class="ltx_text ltx_font_bold">Output:</span> </span><math id="algorithm2.4.4.m1.1" class="ltx_Math" alttext="S=X*Y" display="inline"><semantics id="algorithm2.4.4.m1.1a"><mrow id="algorithm2.4.4.m1.1.1" xref="algorithm2.4.4.m1.1.1.cmml"><mi id="algorithm2.4.4.m1.1.1.2" xref="algorithm2.4.4.m1.1.1.2.cmml">S</mi><mo id="algorithm2.4.4.m1.1.1.1" xref="algorithm2.4.4.m1.1.1.1.cmml">=</mo><mrow id="algorithm2.4.4.m1.1.1.3" xref="algorithm2.4.4.m1.1.1.3.cmml"><mi id="algorithm2.4.4.m1.1.1.3.2" xref="algorithm2.4.4.m1.1.1.3.2.cmml">X</mi><mo lspace="0.222em" rspace="0.222em" id="algorithm2.4.4.m1.1.1.3.1" xref="algorithm2.4.4.m1.1.1.3.1.cmml">∗</mo><mi id="algorithm2.4.4.m1.1.1.3.3" xref="algorithm2.4.4.m1.1.1.3.3.cmml">Y</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.4.4.m1.1b"><apply id="algorithm2.4.4.m1.1.1.cmml" xref="algorithm2.4.4.m1.1.1"><eq id="algorithm2.4.4.m1.1.1.1.cmml" xref="algorithm2.4.4.m1.1.1.1"></eq><ci id="algorithm2.4.4.m1.1.1.2.cmml" xref="algorithm2.4.4.m1.1.1.2">𝑆</ci><apply id="algorithm2.4.4.m1.1.1.3.cmml" xref="algorithm2.4.4.m1.1.1.3"><times id="algorithm2.4.4.m1.1.1.3.1.cmml" xref="algorithm2.4.4.m1.1.1.3.1"></times><ci id="algorithm2.4.4.m1.1.1.3.2.cmml" xref="algorithm2.4.4.m1.1.1.3.2">𝑋</ci><ci id="algorithm2.4.4.m1.1.1.3.3.cmml" xref="algorithm2.4.4.m1.1.1.3.3">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.4.4.m1.1c">S=X*Y</annotation></semantics></math>
</div>
<div id="algorithm2.8.8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span>
Let <math id="algorithm2.5.5.m1.1" class="ltx_Math" alttext="X=\overline{X_{h}X_{l}}" display="inline"><semantics id="algorithm2.5.5.m1.1a"><mrow id="algorithm2.5.5.m1.1.1" xref="algorithm2.5.5.m1.1.1.cmml"><mi id="algorithm2.5.5.m1.1.1.2" xref="algorithm2.5.5.m1.1.1.2.cmml">X</mi><mo id="algorithm2.5.5.m1.1.1.1" xref="algorithm2.5.5.m1.1.1.1.cmml">=</mo><mover accent="true" id="algorithm2.5.5.m1.1.1.3" xref="algorithm2.5.5.m1.1.1.3.cmml"><mrow id="algorithm2.5.5.m1.1.1.3.2" xref="algorithm2.5.5.m1.1.1.3.2.cmml"><msub id="algorithm2.5.5.m1.1.1.3.2.2" xref="algorithm2.5.5.m1.1.1.3.2.2.cmml"><mi id="algorithm2.5.5.m1.1.1.3.2.2.2" xref="algorithm2.5.5.m1.1.1.3.2.2.2.cmml">X</mi><mi id="algorithm2.5.5.m1.1.1.3.2.2.3" xref="algorithm2.5.5.m1.1.1.3.2.2.3.cmml">h</mi></msub><mo lspace="0em" rspace="0em" id="algorithm2.5.5.m1.1.1.3.2.1" xref="algorithm2.5.5.m1.1.1.3.2.1.cmml">​</mo><msub id="algorithm2.5.5.m1.1.1.3.2.3" xref="algorithm2.5.5.m1.1.1.3.2.3.cmml"><mi id="algorithm2.5.5.m1.1.1.3.2.3.2" xref="algorithm2.5.5.m1.1.1.3.2.3.2.cmml">X</mi><mi id="algorithm2.5.5.m1.1.1.3.2.3.3" xref="algorithm2.5.5.m1.1.1.3.2.3.3.cmml">l</mi></msub></mrow><mo id="algorithm2.5.5.m1.1.1.3.1" xref="algorithm2.5.5.m1.1.1.3.1.cmml">¯</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.5.5.m1.1b"><apply id="algorithm2.5.5.m1.1.1.cmml" xref="algorithm2.5.5.m1.1.1"><eq id="algorithm2.5.5.m1.1.1.1.cmml" xref="algorithm2.5.5.m1.1.1.1"></eq><ci id="algorithm2.5.5.m1.1.1.2.cmml" xref="algorithm2.5.5.m1.1.1.2">𝑋</ci><apply id="algorithm2.5.5.m1.1.1.3.cmml" xref="algorithm2.5.5.m1.1.1.3"><ci id="algorithm2.5.5.m1.1.1.3.1.cmml" xref="algorithm2.5.5.m1.1.1.3.1">¯</ci><apply id="algorithm2.5.5.m1.1.1.3.2.cmml" xref="algorithm2.5.5.m1.1.1.3.2"><times id="algorithm2.5.5.m1.1.1.3.2.1.cmml" xref="algorithm2.5.5.m1.1.1.3.2.1"></times><apply id="algorithm2.5.5.m1.1.1.3.2.2.cmml" xref="algorithm2.5.5.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="algorithm2.5.5.m1.1.1.3.2.2.1.cmml" xref="algorithm2.5.5.m1.1.1.3.2.2">subscript</csymbol><ci id="algorithm2.5.5.m1.1.1.3.2.2.2.cmml" xref="algorithm2.5.5.m1.1.1.3.2.2.2">𝑋</ci><ci id="algorithm2.5.5.m1.1.1.3.2.2.3.cmml" xref="algorithm2.5.5.m1.1.1.3.2.2.3">ℎ</ci></apply><apply id="algorithm2.5.5.m1.1.1.3.2.3.cmml" xref="algorithm2.5.5.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="algorithm2.5.5.m1.1.1.3.2.3.1.cmml" xref="algorithm2.5.5.m1.1.1.3.2.3">subscript</csymbol><ci id="algorithm2.5.5.m1.1.1.3.2.3.2.cmml" xref="algorithm2.5.5.m1.1.1.3.2.3.2">𝑋</ci><ci id="algorithm2.5.5.m1.1.1.3.2.3.3.cmml" xref="algorithm2.5.5.m1.1.1.3.2.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.5.5.m1.1c">X=\overline{X_{h}X_{l}}</annotation></semantics></math>, <math id="algorithm2.6.6.m2.1" class="ltx_Math" alttext="Y=\overline{Y_{h}Y_{l}}" display="inline"><semantics id="algorithm2.6.6.m2.1a"><mrow id="algorithm2.6.6.m2.1.1" xref="algorithm2.6.6.m2.1.1.cmml"><mi id="algorithm2.6.6.m2.1.1.2" xref="algorithm2.6.6.m2.1.1.2.cmml">Y</mi><mo id="algorithm2.6.6.m2.1.1.1" xref="algorithm2.6.6.m2.1.1.1.cmml">=</mo><mover accent="true" id="algorithm2.6.6.m2.1.1.3" xref="algorithm2.6.6.m2.1.1.3.cmml"><mrow id="algorithm2.6.6.m2.1.1.3.2" xref="algorithm2.6.6.m2.1.1.3.2.cmml"><msub id="algorithm2.6.6.m2.1.1.3.2.2" xref="algorithm2.6.6.m2.1.1.3.2.2.cmml"><mi id="algorithm2.6.6.m2.1.1.3.2.2.2" xref="algorithm2.6.6.m2.1.1.3.2.2.2.cmml">Y</mi><mi id="algorithm2.6.6.m2.1.1.3.2.2.3" xref="algorithm2.6.6.m2.1.1.3.2.2.3.cmml">h</mi></msub><mo lspace="0em" rspace="0em" id="algorithm2.6.6.m2.1.1.3.2.1" xref="algorithm2.6.6.m2.1.1.3.2.1.cmml">​</mo><msub id="algorithm2.6.6.m2.1.1.3.2.3" xref="algorithm2.6.6.m2.1.1.3.2.3.cmml"><mi id="algorithm2.6.6.m2.1.1.3.2.3.2" xref="algorithm2.6.6.m2.1.1.3.2.3.2.cmml">Y</mi><mi id="algorithm2.6.6.m2.1.1.3.2.3.3" xref="algorithm2.6.6.m2.1.1.3.2.3.3.cmml">l</mi></msub></mrow><mo id="algorithm2.6.6.m2.1.1.3.1" xref="algorithm2.6.6.m2.1.1.3.1.cmml">¯</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.6.6.m2.1b"><apply id="algorithm2.6.6.m2.1.1.cmml" xref="algorithm2.6.6.m2.1.1"><eq id="algorithm2.6.6.m2.1.1.1.cmml" xref="algorithm2.6.6.m2.1.1.1"></eq><ci id="algorithm2.6.6.m2.1.1.2.cmml" xref="algorithm2.6.6.m2.1.1.2">𝑌</ci><apply id="algorithm2.6.6.m2.1.1.3.cmml" xref="algorithm2.6.6.m2.1.1.3"><ci id="algorithm2.6.6.m2.1.1.3.1.cmml" xref="algorithm2.6.6.m2.1.1.3.1">¯</ci><apply id="algorithm2.6.6.m2.1.1.3.2.cmml" xref="algorithm2.6.6.m2.1.1.3.2"><times id="algorithm2.6.6.m2.1.1.3.2.1.cmml" xref="algorithm2.6.6.m2.1.1.3.2.1"></times><apply id="algorithm2.6.6.m2.1.1.3.2.2.cmml" xref="algorithm2.6.6.m2.1.1.3.2.2"><csymbol cd="ambiguous" id="algorithm2.6.6.m2.1.1.3.2.2.1.cmml" xref="algorithm2.6.6.m2.1.1.3.2.2">subscript</csymbol><ci id="algorithm2.6.6.m2.1.1.3.2.2.2.cmml" xref="algorithm2.6.6.m2.1.1.3.2.2.2">𝑌</ci><ci id="algorithm2.6.6.m2.1.1.3.2.2.3.cmml" xref="algorithm2.6.6.m2.1.1.3.2.2.3">ℎ</ci></apply><apply id="algorithm2.6.6.m2.1.1.3.2.3.cmml" xref="algorithm2.6.6.m2.1.1.3.2.3"><csymbol cd="ambiguous" id="algorithm2.6.6.m2.1.1.3.2.3.1.cmml" xref="algorithm2.6.6.m2.1.1.3.2.3">subscript</csymbol><ci id="algorithm2.6.6.m2.1.1.3.2.3.2.cmml" xref="algorithm2.6.6.m2.1.1.3.2.3.2">𝑌</ci><ci id="algorithm2.6.6.m2.1.1.3.2.3.3.cmml" xref="algorithm2.6.6.m2.1.1.3.2.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.6.6.m2.1c">Y=\overline{Y_{h}Y_{l}}</annotation></semantics></math>, where <math id="algorithm2.7.7.m3.4" class="ltx_Math" alttext="X_{h},X_{l},Y_{h},Y_{L}" display="inline"><semantics id="algorithm2.7.7.m3.4a"><mrow id="algorithm2.7.7.m3.4.4.4" xref="algorithm2.7.7.m3.4.4.5.cmml"><msub id="algorithm2.7.7.m3.1.1.1.1" xref="algorithm2.7.7.m3.1.1.1.1.cmml"><mi id="algorithm2.7.7.m3.1.1.1.1.2" xref="algorithm2.7.7.m3.1.1.1.1.2.cmml">X</mi><mi id="algorithm2.7.7.m3.1.1.1.1.3" xref="algorithm2.7.7.m3.1.1.1.1.3.cmml">h</mi></msub><mo id="algorithm2.7.7.m3.4.4.4.5" xref="algorithm2.7.7.m3.4.4.5.cmml">,</mo><msub id="algorithm2.7.7.m3.2.2.2.2" xref="algorithm2.7.7.m3.2.2.2.2.cmml"><mi id="algorithm2.7.7.m3.2.2.2.2.2" xref="algorithm2.7.7.m3.2.2.2.2.2.cmml">X</mi><mi id="algorithm2.7.7.m3.2.2.2.2.3" xref="algorithm2.7.7.m3.2.2.2.2.3.cmml">l</mi></msub><mo id="algorithm2.7.7.m3.4.4.4.6" xref="algorithm2.7.7.m3.4.4.5.cmml">,</mo><msub id="algorithm2.7.7.m3.3.3.3.3" xref="algorithm2.7.7.m3.3.3.3.3.cmml"><mi id="algorithm2.7.7.m3.3.3.3.3.2" xref="algorithm2.7.7.m3.3.3.3.3.2.cmml">Y</mi><mi id="algorithm2.7.7.m3.3.3.3.3.3" xref="algorithm2.7.7.m3.3.3.3.3.3.cmml">h</mi></msub><mo id="algorithm2.7.7.m3.4.4.4.7" xref="algorithm2.7.7.m3.4.4.5.cmml">,</mo><msub id="algorithm2.7.7.m3.4.4.4.4" xref="algorithm2.7.7.m3.4.4.4.4.cmml"><mi id="algorithm2.7.7.m3.4.4.4.4.2" xref="algorithm2.7.7.m3.4.4.4.4.2.cmml">Y</mi><mi id="algorithm2.7.7.m3.4.4.4.4.3" xref="algorithm2.7.7.m3.4.4.4.4.3.cmml">L</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.7.7.m3.4b"><list id="algorithm2.7.7.m3.4.4.5.cmml" xref="algorithm2.7.7.m3.4.4.4"><apply id="algorithm2.7.7.m3.1.1.1.1.cmml" xref="algorithm2.7.7.m3.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.7.7.m3.1.1.1.1.1.cmml" xref="algorithm2.7.7.m3.1.1.1.1">subscript</csymbol><ci id="algorithm2.7.7.m3.1.1.1.1.2.cmml" xref="algorithm2.7.7.m3.1.1.1.1.2">𝑋</ci><ci id="algorithm2.7.7.m3.1.1.1.1.3.cmml" xref="algorithm2.7.7.m3.1.1.1.1.3">ℎ</ci></apply><apply id="algorithm2.7.7.m3.2.2.2.2.cmml" xref="algorithm2.7.7.m3.2.2.2.2"><csymbol cd="ambiguous" id="algorithm2.7.7.m3.2.2.2.2.1.cmml" xref="algorithm2.7.7.m3.2.2.2.2">subscript</csymbol><ci id="algorithm2.7.7.m3.2.2.2.2.2.cmml" xref="algorithm2.7.7.m3.2.2.2.2.2">𝑋</ci><ci id="algorithm2.7.7.m3.2.2.2.2.3.cmml" xref="algorithm2.7.7.m3.2.2.2.2.3">𝑙</ci></apply><apply id="algorithm2.7.7.m3.3.3.3.3.cmml" xref="algorithm2.7.7.m3.3.3.3.3"><csymbol cd="ambiguous" id="algorithm2.7.7.m3.3.3.3.3.1.cmml" xref="algorithm2.7.7.m3.3.3.3.3">subscript</csymbol><ci id="algorithm2.7.7.m3.3.3.3.3.2.cmml" xref="algorithm2.7.7.m3.3.3.3.3.2">𝑌</ci><ci id="algorithm2.7.7.m3.3.3.3.3.3.cmml" xref="algorithm2.7.7.m3.3.3.3.3.3">ℎ</ci></apply><apply id="algorithm2.7.7.m3.4.4.4.4.cmml" xref="algorithm2.7.7.m3.4.4.4.4"><csymbol cd="ambiguous" id="algorithm2.7.7.m3.4.4.4.4.1.cmml" xref="algorithm2.7.7.m3.4.4.4.4">subscript</csymbol><ci id="algorithm2.7.7.m3.4.4.4.4.2.cmml" xref="algorithm2.7.7.m3.4.4.4.4.2">𝑌</ci><ci id="algorithm2.7.7.m3.4.4.4.4.3.cmml" xref="algorithm2.7.7.m3.4.4.4.4.3">𝐿</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.7.7.m3.4c">X_{h},X_{l},Y_{h},Y_{L}</annotation></semantics></math> are <math id="algorithm2.8.8.m4.1" class="ltx_Math" alttext="k/2" display="inline"><semantics id="algorithm2.8.8.m4.1a"><mrow id="algorithm2.8.8.m4.1.1" xref="algorithm2.8.8.m4.1.1.cmml"><mi id="algorithm2.8.8.m4.1.1.2" xref="algorithm2.8.8.m4.1.1.2.cmml">k</mi><mo id="algorithm2.8.8.m4.1.1.1" xref="algorithm2.8.8.m4.1.1.1.cmml">/</mo><mn id="algorithm2.8.8.m4.1.1.3" xref="algorithm2.8.8.m4.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.8.8.m4.1b"><apply id="algorithm2.8.8.m4.1.1.cmml" xref="algorithm2.8.8.m4.1.1"><divide id="algorithm2.8.8.m4.1.1.1.cmml" xref="algorithm2.8.8.m4.1.1.1"></divide><ci id="algorithm2.8.8.m4.1.1.2.cmml" xref="algorithm2.8.8.m4.1.1.2">𝑘</ci><cn type="integer" id="algorithm2.8.8.m4.1.1.3.cmml" xref="algorithm2.8.8.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.8.8.m4.1c">k/2</annotation></semantics></math>-bit integers;
</div>
<div id="algorithm2.9.9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span>
<math id="algorithm2.9.9.m1.2" class="ltx_Math" alttext="HH\leftarrow Karatsuba(X_{h},Y_{h})" display="inline"><semantics id="algorithm2.9.9.m1.2a"><mrow id="algorithm2.9.9.m1.2.2" xref="algorithm2.9.9.m1.2.2.cmml"><mrow id="algorithm2.9.9.m1.2.2.4" xref="algorithm2.9.9.m1.2.2.4.cmml"><mi id="algorithm2.9.9.m1.2.2.4.2" xref="algorithm2.9.9.m1.2.2.4.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="algorithm2.9.9.m1.2.2.4.1" xref="algorithm2.9.9.m1.2.2.4.1.cmml">​</mo><mi id="algorithm2.9.9.m1.2.2.4.3" xref="algorithm2.9.9.m1.2.2.4.3.cmml">H</mi></mrow><mo stretchy="false" id="algorithm2.9.9.m1.2.2.3" xref="algorithm2.9.9.m1.2.2.3.cmml">←</mo><mrow id="algorithm2.9.9.m1.2.2.2" xref="algorithm2.9.9.m1.2.2.2.cmml"><mi id="algorithm2.9.9.m1.2.2.2.4" xref="algorithm2.9.9.m1.2.2.2.4.cmml">K</mi><mo lspace="0em" rspace="0em" id="algorithm2.9.9.m1.2.2.2.3" xref="algorithm2.9.9.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.9.9.m1.2.2.2.5" xref="algorithm2.9.9.m1.2.2.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm2.9.9.m1.2.2.2.3a" xref="algorithm2.9.9.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.9.9.m1.2.2.2.6" xref="algorithm2.9.9.m1.2.2.2.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="algorithm2.9.9.m1.2.2.2.3b" xref="algorithm2.9.9.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.9.9.m1.2.2.2.7" xref="algorithm2.9.9.m1.2.2.2.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm2.9.9.m1.2.2.2.3c" xref="algorithm2.9.9.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.9.9.m1.2.2.2.8" xref="algorithm2.9.9.m1.2.2.2.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm2.9.9.m1.2.2.2.3d" xref="algorithm2.9.9.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.9.9.m1.2.2.2.9" xref="algorithm2.9.9.m1.2.2.2.9.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm2.9.9.m1.2.2.2.3e" xref="algorithm2.9.9.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.9.9.m1.2.2.2.10" xref="algorithm2.9.9.m1.2.2.2.10.cmml">u</mi><mo lspace="0em" rspace="0em" id="algorithm2.9.9.m1.2.2.2.3f" xref="algorithm2.9.9.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.9.9.m1.2.2.2.11" xref="algorithm2.9.9.m1.2.2.2.11.cmml">b</mi><mo lspace="0em" rspace="0em" id="algorithm2.9.9.m1.2.2.2.3g" xref="algorithm2.9.9.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.9.9.m1.2.2.2.12" xref="algorithm2.9.9.m1.2.2.2.12.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm2.9.9.m1.2.2.2.3h" xref="algorithm2.9.9.m1.2.2.2.3.cmml">​</mo><mrow id="algorithm2.9.9.m1.2.2.2.2.2" xref="algorithm2.9.9.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="algorithm2.9.9.m1.2.2.2.2.2.3" xref="algorithm2.9.9.m1.2.2.2.2.3.cmml">(</mo><msub id="algorithm2.9.9.m1.1.1.1.1.1.1" xref="algorithm2.9.9.m1.1.1.1.1.1.1.cmml"><mi id="algorithm2.9.9.m1.1.1.1.1.1.1.2" xref="algorithm2.9.9.m1.1.1.1.1.1.1.2.cmml">X</mi><mi id="algorithm2.9.9.m1.1.1.1.1.1.1.3" xref="algorithm2.9.9.m1.1.1.1.1.1.1.3.cmml">h</mi></msub><mo id="algorithm2.9.9.m1.2.2.2.2.2.4" xref="algorithm2.9.9.m1.2.2.2.2.3.cmml">,</mo><msub id="algorithm2.9.9.m1.2.2.2.2.2.2" xref="algorithm2.9.9.m1.2.2.2.2.2.2.cmml"><mi id="algorithm2.9.9.m1.2.2.2.2.2.2.2" xref="algorithm2.9.9.m1.2.2.2.2.2.2.2.cmml">Y</mi><mi id="algorithm2.9.9.m1.2.2.2.2.2.2.3" xref="algorithm2.9.9.m1.2.2.2.2.2.2.3.cmml">h</mi></msub><mo stretchy="false" id="algorithm2.9.9.m1.2.2.2.2.2.5" xref="algorithm2.9.9.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.9.9.m1.2b"><apply id="algorithm2.9.9.m1.2.2.cmml" xref="algorithm2.9.9.m1.2.2"><ci id="algorithm2.9.9.m1.2.2.3.cmml" xref="algorithm2.9.9.m1.2.2.3">←</ci><apply id="algorithm2.9.9.m1.2.2.4.cmml" xref="algorithm2.9.9.m1.2.2.4"><times id="algorithm2.9.9.m1.2.2.4.1.cmml" xref="algorithm2.9.9.m1.2.2.4.1"></times><ci id="algorithm2.9.9.m1.2.2.4.2.cmml" xref="algorithm2.9.9.m1.2.2.4.2">𝐻</ci><ci id="algorithm2.9.9.m1.2.2.4.3.cmml" xref="algorithm2.9.9.m1.2.2.4.3">𝐻</ci></apply><apply id="algorithm2.9.9.m1.2.2.2.cmml" xref="algorithm2.9.9.m1.2.2.2"><times id="algorithm2.9.9.m1.2.2.2.3.cmml" xref="algorithm2.9.9.m1.2.2.2.3"></times><ci id="algorithm2.9.9.m1.2.2.2.4.cmml" xref="algorithm2.9.9.m1.2.2.2.4">𝐾</ci><ci id="algorithm2.9.9.m1.2.2.2.5.cmml" xref="algorithm2.9.9.m1.2.2.2.5">𝑎</ci><ci id="algorithm2.9.9.m1.2.2.2.6.cmml" xref="algorithm2.9.9.m1.2.2.2.6">𝑟</ci><ci id="algorithm2.9.9.m1.2.2.2.7.cmml" xref="algorithm2.9.9.m1.2.2.2.7">𝑎</ci><ci id="algorithm2.9.9.m1.2.2.2.8.cmml" xref="algorithm2.9.9.m1.2.2.2.8">𝑡</ci><ci id="algorithm2.9.9.m1.2.2.2.9.cmml" xref="algorithm2.9.9.m1.2.2.2.9">𝑠</ci><ci id="algorithm2.9.9.m1.2.2.2.10.cmml" xref="algorithm2.9.9.m1.2.2.2.10">𝑢</ci><ci id="algorithm2.9.9.m1.2.2.2.11.cmml" xref="algorithm2.9.9.m1.2.2.2.11">𝑏</ci><ci id="algorithm2.9.9.m1.2.2.2.12.cmml" xref="algorithm2.9.9.m1.2.2.2.12">𝑎</ci><interval closure="open" id="algorithm2.9.9.m1.2.2.2.2.3.cmml" xref="algorithm2.9.9.m1.2.2.2.2.2"><apply id="algorithm2.9.9.m1.1.1.1.1.1.1.cmml" xref="algorithm2.9.9.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.9.9.m1.1.1.1.1.1.1.1.cmml" xref="algorithm2.9.9.m1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm2.9.9.m1.1.1.1.1.1.1.2.cmml" xref="algorithm2.9.9.m1.1.1.1.1.1.1.2">𝑋</ci><ci id="algorithm2.9.9.m1.1.1.1.1.1.1.3.cmml" xref="algorithm2.9.9.m1.1.1.1.1.1.1.3">ℎ</ci></apply><apply id="algorithm2.9.9.m1.2.2.2.2.2.2.cmml" xref="algorithm2.9.9.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm2.9.9.m1.2.2.2.2.2.2.1.cmml" xref="algorithm2.9.9.m1.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm2.9.9.m1.2.2.2.2.2.2.2.cmml" xref="algorithm2.9.9.m1.2.2.2.2.2.2.2">𝑌</ci><ci id="algorithm2.9.9.m1.2.2.2.2.2.2.3.cmml" xref="algorithm2.9.9.m1.2.2.2.2.2.2.3">ℎ</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.9.9.m1.2c">HH\leftarrow Karatsuba(X_{h},Y_{h})</annotation></semantics></math>;
</div>
<div id="algorithm2.10.10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>
<math id="algorithm2.10.10.m1.2" class="ltx_Math" alttext="LL\leftarrow Karatsuba(X_{l},Y_{l})" display="inline"><semantics id="algorithm2.10.10.m1.2a"><mrow id="algorithm2.10.10.m1.2.2" xref="algorithm2.10.10.m1.2.2.cmml"><mrow id="algorithm2.10.10.m1.2.2.4" xref="algorithm2.10.10.m1.2.2.4.cmml"><mi id="algorithm2.10.10.m1.2.2.4.2" xref="algorithm2.10.10.m1.2.2.4.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="algorithm2.10.10.m1.2.2.4.1" xref="algorithm2.10.10.m1.2.2.4.1.cmml">​</mo><mi id="algorithm2.10.10.m1.2.2.4.3" xref="algorithm2.10.10.m1.2.2.4.3.cmml">L</mi></mrow><mo stretchy="false" id="algorithm2.10.10.m1.2.2.3" xref="algorithm2.10.10.m1.2.2.3.cmml">←</mo><mrow id="algorithm2.10.10.m1.2.2.2" xref="algorithm2.10.10.m1.2.2.2.cmml"><mi id="algorithm2.10.10.m1.2.2.2.4" xref="algorithm2.10.10.m1.2.2.2.4.cmml">K</mi><mo lspace="0em" rspace="0em" id="algorithm2.10.10.m1.2.2.2.3" xref="algorithm2.10.10.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.10.10.m1.2.2.2.5" xref="algorithm2.10.10.m1.2.2.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm2.10.10.m1.2.2.2.3a" xref="algorithm2.10.10.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.10.10.m1.2.2.2.6" xref="algorithm2.10.10.m1.2.2.2.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="algorithm2.10.10.m1.2.2.2.3b" xref="algorithm2.10.10.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.10.10.m1.2.2.2.7" xref="algorithm2.10.10.m1.2.2.2.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm2.10.10.m1.2.2.2.3c" xref="algorithm2.10.10.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.10.10.m1.2.2.2.8" xref="algorithm2.10.10.m1.2.2.2.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm2.10.10.m1.2.2.2.3d" xref="algorithm2.10.10.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.10.10.m1.2.2.2.9" xref="algorithm2.10.10.m1.2.2.2.9.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm2.10.10.m1.2.2.2.3e" xref="algorithm2.10.10.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.10.10.m1.2.2.2.10" xref="algorithm2.10.10.m1.2.2.2.10.cmml">u</mi><mo lspace="0em" rspace="0em" id="algorithm2.10.10.m1.2.2.2.3f" xref="algorithm2.10.10.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.10.10.m1.2.2.2.11" xref="algorithm2.10.10.m1.2.2.2.11.cmml">b</mi><mo lspace="0em" rspace="0em" id="algorithm2.10.10.m1.2.2.2.3g" xref="algorithm2.10.10.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.10.10.m1.2.2.2.12" xref="algorithm2.10.10.m1.2.2.2.12.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm2.10.10.m1.2.2.2.3h" xref="algorithm2.10.10.m1.2.2.2.3.cmml">​</mo><mrow id="algorithm2.10.10.m1.2.2.2.2.2" xref="algorithm2.10.10.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="algorithm2.10.10.m1.2.2.2.2.2.3" xref="algorithm2.10.10.m1.2.2.2.2.3.cmml">(</mo><msub id="algorithm2.10.10.m1.1.1.1.1.1.1" xref="algorithm2.10.10.m1.1.1.1.1.1.1.cmml"><mi id="algorithm2.10.10.m1.1.1.1.1.1.1.2" xref="algorithm2.10.10.m1.1.1.1.1.1.1.2.cmml">X</mi><mi id="algorithm2.10.10.m1.1.1.1.1.1.1.3" xref="algorithm2.10.10.m1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="algorithm2.10.10.m1.2.2.2.2.2.4" xref="algorithm2.10.10.m1.2.2.2.2.3.cmml">,</mo><msub id="algorithm2.10.10.m1.2.2.2.2.2.2" xref="algorithm2.10.10.m1.2.2.2.2.2.2.cmml"><mi id="algorithm2.10.10.m1.2.2.2.2.2.2.2" xref="algorithm2.10.10.m1.2.2.2.2.2.2.2.cmml">Y</mi><mi id="algorithm2.10.10.m1.2.2.2.2.2.2.3" xref="algorithm2.10.10.m1.2.2.2.2.2.2.3.cmml">l</mi></msub><mo stretchy="false" id="algorithm2.10.10.m1.2.2.2.2.2.5" xref="algorithm2.10.10.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.10.10.m1.2b"><apply id="algorithm2.10.10.m1.2.2.cmml" xref="algorithm2.10.10.m1.2.2"><ci id="algorithm2.10.10.m1.2.2.3.cmml" xref="algorithm2.10.10.m1.2.2.3">←</ci><apply id="algorithm2.10.10.m1.2.2.4.cmml" xref="algorithm2.10.10.m1.2.2.4"><times id="algorithm2.10.10.m1.2.2.4.1.cmml" xref="algorithm2.10.10.m1.2.2.4.1"></times><ci id="algorithm2.10.10.m1.2.2.4.2.cmml" xref="algorithm2.10.10.m1.2.2.4.2">𝐿</ci><ci id="algorithm2.10.10.m1.2.2.4.3.cmml" xref="algorithm2.10.10.m1.2.2.4.3">𝐿</ci></apply><apply id="algorithm2.10.10.m1.2.2.2.cmml" xref="algorithm2.10.10.m1.2.2.2"><times id="algorithm2.10.10.m1.2.2.2.3.cmml" xref="algorithm2.10.10.m1.2.2.2.3"></times><ci id="algorithm2.10.10.m1.2.2.2.4.cmml" xref="algorithm2.10.10.m1.2.2.2.4">𝐾</ci><ci id="algorithm2.10.10.m1.2.2.2.5.cmml" xref="algorithm2.10.10.m1.2.2.2.5">𝑎</ci><ci id="algorithm2.10.10.m1.2.2.2.6.cmml" xref="algorithm2.10.10.m1.2.2.2.6">𝑟</ci><ci id="algorithm2.10.10.m1.2.2.2.7.cmml" xref="algorithm2.10.10.m1.2.2.2.7">𝑎</ci><ci id="algorithm2.10.10.m1.2.2.2.8.cmml" xref="algorithm2.10.10.m1.2.2.2.8">𝑡</ci><ci id="algorithm2.10.10.m1.2.2.2.9.cmml" xref="algorithm2.10.10.m1.2.2.2.9">𝑠</ci><ci id="algorithm2.10.10.m1.2.2.2.10.cmml" xref="algorithm2.10.10.m1.2.2.2.10">𝑢</ci><ci id="algorithm2.10.10.m1.2.2.2.11.cmml" xref="algorithm2.10.10.m1.2.2.2.11">𝑏</ci><ci id="algorithm2.10.10.m1.2.2.2.12.cmml" xref="algorithm2.10.10.m1.2.2.2.12">𝑎</ci><interval closure="open" id="algorithm2.10.10.m1.2.2.2.2.3.cmml" xref="algorithm2.10.10.m1.2.2.2.2.2"><apply id="algorithm2.10.10.m1.1.1.1.1.1.1.cmml" xref="algorithm2.10.10.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.10.10.m1.1.1.1.1.1.1.1.cmml" xref="algorithm2.10.10.m1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm2.10.10.m1.1.1.1.1.1.1.2.cmml" xref="algorithm2.10.10.m1.1.1.1.1.1.1.2">𝑋</ci><ci id="algorithm2.10.10.m1.1.1.1.1.1.1.3.cmml" xref="algorithm2.10.10.m1.1.1.1.1.1.1.3">𝑙</ci></apply><apply id="algorithm2.10.10.m1.2.2.2.2.2.2.cmml" xref="algorithm2.10.10.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm2.10.10.m1.2.2.2.2.2.2.1.cmml" xref="algorithm2.10.10.m1.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm2.10.10.m1.2.2.2.2.2.2.2.cmml" xref="algorithm2.10.10.m1.2.2.2.2.2.2.2">𝑌</ci><ci id="algorithm2.10.10.m1.2.2.2.2.2.2.3.cmml" xref="algorithm2.10.10.m1.2.2.2.2.2.2.3">𝑙</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.10.10.m1.2c">LL\leftarrow Karatsuba(X_{l},Y_{l})</annotation></semantics></math>;
</div>
<div id="algorithm2.11.11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>
<math id="algorithm2.11.11.m1.2" class="ltx_Math" alttext="HL\leftarrow Katatsuba(X_{h}+X_{l},Y_{h}+Y_{l})" display="inline"><semantics id="algorithm2.11.11.m1.2a"><mrow id="algorithm2.11.11.m1.2.2" xref="algorithm2.11.11.m1.2.2.cmml"><mrow id="algorithm2.11.11.m1.2.2.4" xref="algorithm2.11.11.m1.2.2.4.cmml"><mi id="algorithm2.11.11.m1.2.2.4.2" xref="algorithm2.11.11.m1.2.2.4.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="algorithm2.11.11.m1.2.2.4.1" xref="algorithm2.11.11.m1.2.2.4.1.cmml">​</mo><mi id="algorithm2.11.11.m1.2.2.4.3" xref="algorithm2.11.11.m1.2.2.4.3.cmml">L</mi></mrow><mo stretchy="false" id="algorithm2.11.11.m1.2.2.3" xref="algorithm2.11.11.m1.2.2.3.cmml">←</mo><mrow id="algorithm2.11.11.m1.2.2.2" xref="algorithm2.11.11.m1.2.2.2.cmml"><mi id="algorithm2.11.11.m1.2.2.2.4" xref="algorithm2.11.11.m1.2.2.2.4.cmml">K</mi><mo lspace="0em" rspace="0em" id="algorithm2.11.11.m1.2.2.2.3" xref="algorithm2.11.11.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.11.11.m1.2.2.2.5" xref="algorithm2.11.11.m1.2.2.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm2.11.11.m1.2.2.2.3a" xref="algorithm2.11.11.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.11.11.m1.2.2.2.6" xref="algorithm2.11.11.m1.2.2.2.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm2.11.11.m1.2.2.2.3b" xref="algorithm2.11.11.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.11.11.m1.2.2.2.7" xref="algorithm2.11.11.m1.2.2.2.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm2.11.11.m1.2.2.2.3c" xref="algorithm2.11.11.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.11.11.m1.2.2.2.8" xref="algorithm2.11.11.m1.2.2.2.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm2.11.11.m1.2.2.2.3d" xref="algorithm2.11.11.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.11.11.m1.2.2.2.9" xref="algorithm2.11.11.m1.2.2.2.9.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm2.11.11.m1.2.2.2.3e" xref="algorithm2.11.11.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.11.11.m1.2.2.2.10" xref="algorithm2.11.11.m1.2.2.2.10.cmml">u</mi><mo lspace="0em" rspace="0em" id="algorithm2.11.11.m1.2.2.2.3f" xref="algorithm2.11.11.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.11.11.m1.2.2.2.11" xref="algorithm2.11.11.m1.2.2.2.11.cmml">b</mi><mo lspace="0em" rspace="0em" id="algorithm2.11.11.m1.2.2.2.3g" xref="algorithm2.11.11.m1.2.2.2.3.cmml">​</mo><mi id="algorithm2.11.11.m1.2.2.2.12" xref="algorithm2.11.11.m1.2.2.2.12.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm2.11.11.m1.2.2.2.3h" xref="algorithm2.11.11.m1.2.2.2.3.cmml">​</mo><mrow id="algorithm2.11.11.m1.2.2.2.2.2" xref="algorithm2.11.11.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="algorithm2.11.11.m1.2.2.2.2.2.3" xref="algorithm2.11.11.m1.2.2.2.2.3.cmml">(</mo><mrow id="algorithm2.11.11.m1.1.1.1.1.1.1" xref="algorithm2.11.11.m1.1.1.1.1.1.1.cmml"><msub id="algorithm2.11.11.m1.1.1.1.1.1.1.2" xref="algorithm2.11.11.m1.1.1.1.1.1.1.2.cmml"><mi id="algorithm2.11.11.m1.1.1.1.1.1.1.2.2" xref="algorithm2.11.11.m1.1.1.1.1.1.1.2.2.cmml">X</mi><mi id="algorithm2.11.11.m1.1.1.1.1.1.1.2.3" xref="algorithm2.11.11.m1.1.1.1.1.1.1.2.3.cmml">h</mi></msub><mo id="algorithm2.11.11.m1.1.1.1.1.1.1.1" xref="algorithm2.11.11.m1.1.1.1.1.1.1.1.cmml">+</mo><msub id="algorithm2.11.11.m1.1.1.1.1.1.1.3" xref="algorithm2.11.11.m1.1.1.1.1.1.1.3.cmml"><mi id="algorithm2.11.11.m1.1.1.1.1.1.1.3.2" xref="algorithm2.11.11.m1.1.1.1.1.1.1.3.2.cmml">X</mi><mi id="algorithm2.11.11.m1.1.1.1.1.1.1.3.3" xref="algorithm2.11.11.m1.1.1.1.1.1.1.3.3.cmml">l</mi></msub></mrow><mo id="algorithm2.11.11.m1.2.2.2.2.2.4" xref="algorithm2.11.11.m1.2.2.2.2.3.cmml">,</mo><mrow id="algorithm2.11.11.m1.2.2.2.2.2.2" xref="algorithm2.11.11.m1.2.2.2.2.2.2.cmml"><msub id="algorithm2.11.11.m1.2.2.2.2.2.2.2" xref="algorithm2.11.11.m1.2.2.2.2.2.2.2.cmml"><mi id="algorithm2.11.11.m1.2.2.2.2.2.2.2.2" xref="algorithm2.11.11.m1.2.2.2.2.2.2.2.2.cmml">Y</mi><mi id="algorithm2.11.11.m1.2.2.2.2.2.2.2.3" xref="algorithm2.11.11.m1.2.2.2.2.2.2.2.3.cmml">h</mi></msub><mo id="algorithm2.11.11.m1.2.2.2.2.2.2.1" xref="algorithm2.11.11.m1.2.2.2.2.2.2.1.cmml">+</mo><msub id="algorithm2.11.11.m1.2.2.2.2.2.2.3" xref="algorithm2.11.11.m1.2.2.2.2.2.2.3.cmml"><mi id="algorithm2.11.11.m1.2.2.2.2.2.2.3.2" xref="algorithm2.11.11.m1.2.2.2.2.2.2.3.2.cmml">Y</mi><mi id="algorithm2.11.11.m1.2.2.2.2.2.2.3.3" xref="algorithm2.11.11.m1.2.2.2.2.2.2.3.3.cmml">l</mi></msub></mrow><mo stretchy="false" id="algorithm2.11.11.m1.2.2.2.2.2.5" xref="algorithm2.11.11.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.11.11.m1.2b"><apply id="algorithm2.11.11.m1.2.2.cmml" xref="algorithm2.11.11.m1.2.2"><ci id="algorithm2.11.11.m1.2.2.3.cmml" xref="algorithm2.11.11.m1.2.2.3">←</ci><apply id="algorithm2.11.11.m1.2.2.4.cmml" xref="algorithm2.11.11.m1.2.2.4"><times id="algorithm2.11.11.m1.2.2.4.1.cmml" xref="algorithm2.11.11.m1.2.2.4.1"></times><ci id="algorithm2.11.11.m1.2.2.4.2.cmml" xref="algorithm2.11.11.m1.2.2.4.2">𝐻</ci><ci id="algorithm2.11.11.m1.2.2.4.3.cmml" xref="algorithm2.11.11.m1.2.2.4.3">𝐿</ci></apply><apply id="algorithm2.11.11.m1.2.2.2.cmml" xref="algorithm2.11.11.m1.2.2.2"><times id="algorithm2.11.11.m1.2.2.2.3.cmml" xref="algorithm2.11.11.m1.2.2.2.3"></times><ci id="algorithm2.11.11.m1.2.2.2.4.cmml" xref="algorithm2.11.11.m1.2.2.2.4">𝐾</ci><ci id="algorithm2.11.11.m1.2.2.2.5.cmml" xref="algorithm2.11.11.m1.2.2.2.5">𝑎</ci><ci id="algorithm2.11.11.m1.2.2.2.6.cmml" xref="algorithm2.11.11.m1.2.2.2.6">𝑡</ci><ci id="algorithm2.11.11.m1.2.2.2.7.cmml" xref="algorithm2.11.11.m1.2.2.2.7">𝑎</ci><ci id="algorithm2.11.11.m1.2.2.2.8.cmml" xref="algorithm2.11.11.m1.2.2.2.8">𝑡</ci><ci id="algorithm2.11.11.m1.2.2.2.9.cmml" xref="algorithm2.11.11.m1.2.2.2.9">𝑠</ci><ci id="algorithm2.11.11.m1.2.2.2.10.cmml" xref="algorithm2.11.11.m1.2.2.2.10">𝑢</ci><ci id="algorithm2.11.11.m1.2.2.2.11.cmml" xref="algorithm2.11.11.m1.2.2.2.11">𝑏</ci><ci id="algorithm2.11.11.m1.2.2.2.12.cmml" xref="algorithm2.11.11.m1.2.2.2.12">𝑎</ci><interval closure="open" id="algorithm2.11.11.m1.2.2.2.2.3.cmml" xref="algorithm2.11.11.m1.2.2.2.2.2"><apply id="algorithm2.11.11.m1.1.1.1.1.1.1.cmml" xref="algorithm2.11.11.m1.1.1.1.1.1.1"><plus id="algorithm2.11.11.m1.1.1.1.1.1.1.1.cmml" xref="algorithm2.11.11.m1.1.1.1.1.1.1.1"></plus><apply id="algorithm2.11.11.m1.1.1.1.1.1.1.2.cmml" xref="algorithm2.11.11.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="algorithm2.11.11.m1.1.1.1.1.1.1.2.1.cmml" xref="algorithm2.11.11.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="algorithm2.11.11.m1.1.1.1.1.1.1.2.2.cmml" xref="algorithm2.11.11.m1.1.1.1.1.1.1.2.2">𝑋</ci><ci id="algorithm2.11.11.m1.1.1.1.1.1.1.2.3.cmml" xref="algorithm2.11.11.m1.1.1.1.1.1.1.2.3">ℎ</ci></apply><apply id="algorithm2.11.11.m1.1.1.1.1.1.1.3.cmml" xref="algorithm2.11.11.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm2.11.11.m1.1.1.1.1.1.1.3.1.cmml" xref="algorithm2.11.11.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="algorithm2.11.11.m1.1.1.1.1.1.1.3.2.cmml" xref="algorithm2.11.11.m1.1.1.1.1.1.1.3.2">𝑋</ci><ci id="algorithm2.11.11.m1.1.1.1.1.1.1.3.3.cmml" xref="algorithm2.11.11.m1.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply><apply id="algorithm2.11.11.m1.2.2.2.2.2.2.cmml" xref="algorithm2.11.11.m1.2.2.2.2.2.2"><plus id="algorithm2.11.11.m1.2.2.2.2.2.2.1.cmml" xref="algorithm2.11.11.m1.2.2.2.2.2.2.1"></plus><apply id="algorithm2.11.11.m1.2.2.2.2.2.2.2.cmml" xref="algorithm2.11.11.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm2.11.11.m1.2.2.2.2.2.2.2.1.cmml" xref="algorithm2.11.11.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm2.11.11.m1.2.2.2.2.2.2.2.2.cmml" xref="algorithm2.11.11.m1.2.2.2.2.2.2.2.2">𝑌</ci><ci id="algorithm2.11.11.m1.2.2.2.2.2.2.2.3.cmml" xref="algorithm2.11.11.m1.2.2.2.2.2.2.2.3">ℎ</ci></apply><apply id="algorithm2.11.11.m1.2.2.2.2.2.2.3.cmml" xref="algorithm2.11.11.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="algorithm2.11.11.m1.2.2.2.2.2.2.3.1.cmml" xref="algorithm2.11.11.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="algorithm2.11.11.m1.2.2.2.2.2.2.3.2.cmml" xref="algorithm2.11.11.m1.2.2.2.2.2.2.3.2">𝑌</ci><ci id="algorithm2.11.11.m1.2.2.2.2.2.2.3.3.cmml" xref="algorithm2.11.11.m1.2.2.2.2.2.2.3.3">𝑙</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.11.11.m1.2c">HL\leftarrow Katatsuba(X_{h}+X_{l},Y_{h}+Y_{l})</annotation></semantics></math>;
</div>
<div id="algorithm2.12.12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>
<math id="algorithm2.12.12.m1.1" class="ltx_Math" alttext="S\leftarrow HH*2^{k}+(HL-HH-LL)*2^{k/2}+LL" display="inline"><semantics id="algorithm2.12.12.m1.1a"><mrow id="algorithm2.12.12.m1.1.1" xref="algorithm2.12.12.m1.1.1.cmml"><mi id="algorithm2.12.12.m1.1.1.3" xref="algorithm2.12.12.m1.1.1.3.cmml">S</mi><mo stretchy="false" id="algorithm2.12.12.m1.1.1.2" xref="algorithm2.12.12.m1.1.1.2.cmml">←</mo><mrow id="algorithm2.12.12.m1.1.1.1" xref="algorithm2.12.12.m1.1.1.1.cmml"><mrow id="algorithm2.12.12.m1.1.1.1.3" xref="algorithm2.12.12.m1.1.1.1.3.cmml"><mrow id="algorithm2.12.12.m1.1.1.1.3.2" xref="algorithm2.12.12.m1.1.1.1.3.2.cmml"><mi id="algorithm2.12.12.m1.1.1.1.3.2.2" xref="algorithm2.12.12.m1.1.1.1.3.2.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="algorithm2.12.12.m1.1.1.1.3.2.1" xref="algorithm2.12.12.m1.1.1.1.3.2.1.cmml">​</mo><mi id="algorithm2.12.12.m1.1.1.1.3.2.3" xref="algorithm2.12.12.m1.1.1.1.3.2.3.cmml">H</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="algorithm2.12.12.m1.1.1.1.3.1" xref="algorithm2.12.12.m1.1.1.1.3.1.cmml">∗</mo><msup id="algorithm2.12.12.m1.1.1.1.3.3" xref="algorithm2.12.12.m1.1.1.1.3.3.cmml"><mn id="algorithm2.12.12.m1.1.1.1.3.3.2" xref="algorithm2.12.12.m1.1.1.1.3.3.2.cmml">2</mn><mi id="algorithm2.12.12.m1.1.1.1.3.3.3" xref="algorithm2.12.12.m1.1.1.1.3.3.3.cmml">k</mi></msup></mrow><mo id="algorithm2.12.12.m1.1.1.1.2" xref="algorithm2.12.12.m1.1.1.1.2.cmml">+</mo><mrow id="algorithm2.12.12.m1.1.1.1.1" xref="algorithm2.12.12.m1.1.1.1.1.cmml"><mrow id="algorithm2.12.12.m1.1.1.1.1.1.1" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm2.12.12.m1.1.1.1.1.1.1.2" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm2.12.12.m1.1.1.1.1.1.1.1" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.cmml"><mrow id="algorithm2.12.12.m1.1.1.1.1.1.1.1.2" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.2.cmml"><mi id="algorithm2.12.12.m1.1.1.1.1.1.1.1.2.2" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.2.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="algorithm2.12.12.m1.1.1.1.1.1.1.1.2.1" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="algorithm2.12.12.m1.1.1.1.1.1.1.1.2.3" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.2.3.cmml">L</mi></mrow><mo id="algorithm2.12.12.m1.1.1.1.1.1.1.1.1" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="algorithm2.12.12.m1.1.1.1.1.1.1.1.3" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.3.cmml"><mi id="algorithm2.12.12.m1.1.1.1.1.1.1.1.3.2" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.3.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="algorithm2.12.12.m1.1.1.1.1.1.1.1.3.1" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm2.12.12.m1.1.1.1.1.1.1.1.3.3" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.3.3.cmml">H</mi></mrow><mo id="algorithm2.12.12.m1.1.1.1.1.1.1.1.1a" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="algorithm2.12.12.m1.1.1.1.1.1.1.1.4" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.4.cmml"><mi id="algorithm2.12.12.m1.1.1.1.1.1.1.1.4.2" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.4.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="algorithm2.12.12.m1.1.1.1.1.1.1.1.4.1" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.4.1.cmml">​</mo><mi id="algorithm2.12.12.m1.1.1.1.1.1.1.1.4.3" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.4.3.cmml">L</mi></mrow></mrow><mo rspace="0.055em" stretchy="false" id="algorithm2.12.12.m1.1.1.1.1.1.1.3" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="algorithm2.12.12.m1.1.1.1.1.2" xref="algorithm2.12.12.m1.1.1.1.1.2.cmml">∗</mo><msup id="algorithm2.12.12.m1.1.1.1.1.3" xref="algorithm2.12.12.m1.1.1.1.1.3.cmml"><mn id="algorithm2.12.12.m1.1.1.1.1.3.2" xref="algorithm2.12.12.m1.1.1.1.1.3.2.cmml">2</mn><mrow id="algorithm2.12.12.m1.1.1.1.1.3.3" xref="algorithm2.12.12.m1.1.1.1.1.3.3.cmml"><mi id="algorithm2.12.12.m1.1.1.1.1.3.3.2" xref="algorithm2.12.12.m1.1.1.1.1.3.3.2.cmml">k</mi><mo id="algorithm2.12.12.m1.1.1.1.1.3.3.1" xref="algorithm2.12.12.m1.1.1.1.1.3.3.1.cmml">/</mo><mn id="algorithm2.12.12.m1.1.1.1.1.3.3.3" xref="algorithm2.12.12.m1.1.1.1.1.3.3.3.cmml">2</mn></mrow></msup></mrow><mo id="algorithm2.12.12.m1.1.1.1.2a" xref="algorithm2.12.12.m1.1.1.1.2.cmml">+</mo><mrow id="algorithm2.12.12.m1.1.1.1.4" xref="algorithm2.12.12.m1.1.1.1.4.cmml"><mi id="algorithm2.12.12.m1.1.1.1.4.2" xref="algorithm2.12.12.m1.1.1.1.4.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="algorithm2.12.12.m1.1.1.1.4.1" xref="algorithm2.12.12.m1.1.1.1.4.1.cmml">​</mo><mi id="algorithm2.12.12.m1.1.1.1.4.3" xref="algorithm2.12.12.m1.1.1.1.4.3.cmml">L</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.12.12.m1.1b"><apply id="algorithm2.12.12.m1.1.1.cmml" xref="algorithm2.12.12.m1.1.1"><ci id="algorithm2.12.12.m1.1.1.2.cmml" xref="algorithm2.12.12.m1.1.1.2">←</ci><ci id="algorithm2.12.12.m1.1.1.3.cmml" xref="algorithm2.12.12.m1.1.1.3">𝑆</ci><apply id="algorithm2.12.12.m1.1.1.1.cmml" xref="algorithm2.12.12.m1.1.1.1"><plus id="algorithm2.12.12.m1.1.1.1.2.cmml" xref="algorithm2.12.12.m1.1.1.1.2"></plus><apply id="algorithm2.12.12.m1.1.1.1.3.cmml" xref="algorithm2.12.12.m1.1.1.1.3"><times id="algorithm2.12.12.m1.1.1.1.3.1.cmml" xref="algorithm2.12.12.m1.1.1.1.3.1"></times><apply id="algorithm2.12.12.m1.1.1.1.3.2.cmml" xref="algorithm2.12.12.m1.1.1.1.3.2"><times id="algorithm2.12.12.m1.1.1.1.3.2.1.cmml" xref="algorithm2.12.12.m1.1.1.1.3.2.1"></times><ci id="algorithm2.12.12.m1.1.1.1.3.2.2.cmml" xref="algorithm2.12.12.m1.1.1.1.3.2.2">𝐻</ci><ci id="algorithm2.12.12.m1.1.1.1.3.2.3.cmml" xref="algorithm2.12.12.m1.1.1.1.3.2.3">𝐻</ci></apply><apply id="algorithm2.12.12.m1.1.1.1.3.3.cmml" xref="algorithm2.12.12.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm2.12.12.m1.1.1.1.3.3.1.cmml" xref="algorithm2.12.12.m1.1.1.1.3.3">superscript</csymbol><cn type="integer" id="algorithm2.12.12.m1.1.1.1.3.3.2.cmml" xref="algorithm2.12.12.m1.1.1.1.3.3.2">2</cn><ci id="algorithm2.12.12.m1.1.1.1.3.3.3.cmml" xref="algorithm2.12.12.m1.1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="algorithm2.12.12.m1.1.1.1.1.cmml" xref="algorithm2.12.12.m1.1.1.1.1"><times id="algorithm2.12.12.m1.1.1.1.1.2.cmml" xref="algorithm2.12.12.m1.1.1.1.1.2"></times><apply id="algorithm2.12.12.m1.1.1.1.1.1.1.1.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.1"><minus id="algorithm2.12.12.m1.1.1.1.1.1.1.1.1.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.1"></minus><apply id="algorithm2.12.12.m1.1.1.1.1.1.1.1.2.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.2"><times id="algorithm2.12.12.m1.1.1.1.1.1.1.1.2.1.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.2.1"></times><ci id="algorithm2.12.12.m1.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.2.2">𝐻</ci><ci id="algorithm2.12.12.m1.1.1.1.1.1.1.1.2.3.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.2.3">𝐿</ci></apply><apply id="algorithm2.12.12.m1.1.1.1.1.1.1.1.3.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.3"><times id="algorithm2.12.12.m1.1.1.1.1.1.1.1.3.1.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.3.1"></times><ci id="algorithm2.12.12.m1.1.1.1.1.1.1.1.3.2.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.3.2">𝐻</ci><ci id="algorithm2.12.12.m1.1.1.1.1.1.1.1.3.3.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.3.3">𝐻</ci></apply><apply id="algorithm2.12.12.m1.1.1.1.1.1.1.1.4.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.4"><times id="algorithm2.12.12.m1.1.1.1.1.1.1.1.4.1.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.4.1"></times><ci id="algorithm2.12.12.m1.1.1.1.1.1.1.1.4.2.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.4.2">𝐿</ci><ci id="algorithm2.12.12.m1.1.1.1.1.1.1.1.4.3.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.4.3">𝐿</ci></apply></apply><apply id="algorithm2.12.12.m1.1.1.1.1.3.cmml" xref="algorithm2.12.12.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm2.12.12.m1.1.1.1.1.3.1.cmml" xref="algorithm2.12.12.m1.1.1.1.1.3">superscript</csymbol><cn type="integer" id="algorithm2.12.12.m1.1.1.1.1.3.2.cmml" xref="algorithm2.12.12.m1.1.1.1.1.3.2">2</cn><apply id="algorithm2.12.12.m1.1.1.1.1.3.3.cmml" xref="algorithm2.12.12.m1.1.1.1.1.3.3"><divide id="algorithm2.12.12.m1.1.1.1.1.3.3.1.cmml" xref="algorithm2.12.12.m1.1.1.1.1.3.3.1"></divide><ci id="algorithm2.12.12.m1.1.1.1.1.3.3.2.cmml" xref="algorithm2.12.12.m1.1.1.1.1.3.3.2">𝑘</ci><cn type="integer" id="algorithm2.12.12.m1.1.1.1.1.3.3.3.cmml" xref="algorithm2.12.12.m1.1.1.1.1.3.3.3">2</cn></apply></apply></apply><apply id="algorithm2.12.12.m1.1.1.1.4.cmml" xref="algorithm2.12.12.m1.1.1.1.4"><times id="algorithm2.12.12.m1.1.1.1.4.1.cmml" xref="algorithm2.12.12.m1.1.1.1.4.1"></times><ci id="algorithm2.12.12.m1.1.1.1.4.2.cmml" xref="algorithm2.12.12.m1.1.1.1.4.2">𝐿</ci><ci id="algorithm2.12.12.m1.1.1.1.4.3.cmml" xref="algorithm2.12.12.m1.1.1.1.4.3">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.12.12.m1.1c">S\leftarrow HH*2^{k}+(HL-HH-LL)*2^{k/2}+LL</annotation></semantics></math>;
</div>
<div id="algorithm2.13.13" class="ltx_listingline">
<span id="algorithm2.13.13.2" class="ltx_text ltx_font_bold">return</span> <em id="algorithm2.13.13.1" class="ltx_emph ltx_font_italic"><math id="algorithm2.13.13.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="algorithm2.13.13.1.m1.1a"><mi id="algorithm2.13.13.1.m1.1.1" xref="algorithm2.13.13.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="algorithm2.13.13.1.m1.1b"><ci id="algorithm2.13.13.1.m1.1.1.cmml" xref="algorithm2.13.13.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.13.13.1.m1.1c">S</annotation></semantics></math></em>


</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm2.15.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span>Karatsuba algorithm</figcaption>
</figure>
</section>
<section id="S3.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.3 </span>Clock Frequency</h4>

<div id="S3.SS2.SSS3.p1" class="ltx_para">
<p id="S3.SS2.SSS3.p1.1" class="ltx_p">The DSP units on the Xilinx FPGA run at a maximum frequency of 400-500MHz. To approach the frequency limit, we need to pay attention to the following measures:</p>
</div>
<div id="S3.SS2.SSS3.p2" class="ltx_para">
<ul id="S3.I2" class="ltx_itemize">
<li id="S3.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i1.p1" class="ltx_para">
<p id="S3.I2.i1.p1.1" class="ltx_p">Declare the multipliers as pipelined multipliers. A pipelined multiplier takes multiple cycles to accomplish a multiplication, distributing its workload and relieving the burden of each cycle. It does no harm to the multiplication throughput since we have resolved the dependency between its input and output.</p>
</div>
</li>
<li id="S3.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i2.p1" class="ltx_para">
<p id="S3.I2.i2.p1.1" class="ltx_p">Restrict bitwidth of operands. The clock frequency is constraint by the critical path of the circuit, i.e. the longest path of gates a signal needs to pass through during one cycle. Arithmetic on integers such as addition or comparison usually results in a long carry chain, and thus we need to avoid computation on very long integers directly. In this work, we use 32-bit as the operand size, and the maximum bitwidth involved is 64 bits.</p>
</div>
</li>
<li id="S3.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i3.p1" class="ltx_para">
<p id="S3.I2.i3.p1.1" class="ltx_p">Simplify the control logic. For the finite state machine in charge of controlling the compute units, we use one-hot encoding scheme to represent the states for a fast lookup and match. The number of states is related to the number of iterations of each loop and thus one-hot encoding will be acceptable.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S3.SS2.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.4 </span>Memory Usage</h4>

<div id="S3.SS2.SSS4.p1" class="ltx_para">
<p id="S3.SS2.SSS4.p1.1" class="ltx_p">Our design allocate each Paillier processors its own block RAM (BRAM) as local buffer, to hold the input/output data and the intermediate large integers involved in the computation. We do not share storage among processors to prevent data access contention.</p>
</div>
<div id="S3.SS2.SSS4.p2" class="ltx_para">
<p id="S3.SS2.SSS4.p2.1" class="ltx_p">Large integers are normally stored as arrays of words in the BRAM. However, we notice that the input data for encryption, which are encoded from floating point numbers used in machine learning, have few effective digits compared with the length of large integers. Therefore, we are able to store the input data as a sparse vector, i.e. only recording the non-zero elements and their indices, reducing the memory footprint.</p>
</div>
</section>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Implementation</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">We develop our encryption framework with the AWS F1 instance and Xilinx SDAccel development suite. The basic logic of the encryption and decryption function is implemented with Xilinx high level synthesis (HLS), allowing to transform an algorithm described in C/C++ into tailor-made implementation on FPGA. Directives like loop pipelining and instance allocation are inserted into the HLS code to fine tune the performance of the resulted architecture.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.1" class="ltx_p">On the host side, we use the OpenCL API to access the acceleration hardware. The OpenCL API provides an abstraction of the computing device like CPU, GPU and FPGA. An invocation to the device function is named a kernel. OpenCL is used to manage the data transfer between host and device, queue and invoke kernels, and monitor the execution events. We adopt the PyOpenCL APIs to implement a module that makes use of the FPGA device for cryptographic processes and incorporate it into the FATE framework.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.1" class="ltx_p">The requests from the host side are divided into fixed size batches, and each batch invokes a kernel on device. Multiple kernels will be queued in the OpenCL command queue. This helps overlap data transfer with computation and hide latency.
We also preallocate buffers on the device, arranging them as a ring buffer, in order to reuse buffers among kernels and avoid frequent memory allocation.</p>
</div>
<figure id="S3.F5" class="ltx_figure"><img src="/html/2007.10560/assets/cmdQ.png" id="S3.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="79" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Queueing kernels for execution</figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Evaluation</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We conduct experiments aiming to perform an extensive evaluation on the proposed encryption framework. We first perform a microscopic examination, comparing the implementation of Paillier algorithm and ModMult operation with software solutions and existing FPGA designs. Then we study its improvement on the overall performance of training process of federated learning. The training tasks are carried out on the open-sourced version of the FATE machine learning framework. We choose two linear models, and adopt Kaggle datasets on breast cancer<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://www.kaggle.com/uciml/breast-cancer-wisconsin-data</span></span></span> and motor temperature<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://www.kaggle.com/wkirgsn/electric-motor-temperature</span></span></span> and partition the datasets vertically.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">We attempt to answer the following questions empirically with the evaluation experiments:</p>
</div>
<div id="S4.p3" class="ltx_para">
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.1" class="ltx_p">How do the Paillier processors perform, especially for the ModMult operation, in terms of throughput and resource-efficiency?</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.1" class="ltx_p">How does the hardware framework compare with software solutions of Paillier cryptosystem in terms of en/decryption throughput?</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.1" class="ltx_p">How much does the framework affect the training throughput of federated learning with respect to different models or algorithms?</p>
</div>
</li>
</ul>
</div>
<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<td id="S4.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt">Implementation</td>
<td id="S4.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">Area(slice)</td>
<td id="S4.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">DSP</td>
<td id="S4.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">Clock frequency(MHz)</td>
<td id="S4.T1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">Execution time(us)</td>
<td id="S4.T1.1.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">Throughput per DSP(op/s)</td>
</tr>
<tr id="S4.T1.1.2.2" class="ltx_tr">
<td id="S4.T1.1.2.2.1" class="ltx_td ltx_align_center ltx_border_t">This work</td>
<td id="S4.T1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">483</td>
<td id="S4.T1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">9</td>
<td id="S4.T1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">500</td>
<td id="S4.T1.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t">8.81</td>
<td id="S4.T1.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.2.2.6.1" class="ltx_text ltx_font_bold">12626</span></td>
</tr>
<tr id="S4.T1.1.3.3" class="ltx_tr">
<td id="S4.T1.1.3.3.1" class="ltx_td ltx_align_center ltx_border_t"><cite class="ltx_cite ltx_citemacro_cite">San and At (<a href="#bib.bib16" title="" class="ltx_ref">2014</a>)</cite></td>
<td id="S4.T1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">567</td>
<td id="S4.T1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t">13</td>
<td id="S4.T1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">490</td>
<td id="S4.T1.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t">8.64</td>
<td id="S4.T1.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t">8903</td>
</tr>
<tr id="S4.T1.1.4.4" class="ltx_tr">
<td id="S4.T1.1.4.4.1" class="ltx_td ltx_align_center ltx_border_t"><cite class="ltx_cite ltx_citemacro_cite">Song <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib17" title="" class="ltx_ref">2010</a>)</cite></td>
<td id="S4.T1.1.4.4.2" class="ltx_td ltx_align_center ltx_border_t">180</td>
<td id="S4.T1.1.4.4.3" class="ltx_td ltx_align_center ltx_border_t">1</td>
<td id="S4.T1.1.4.4.4" class="ltx_td ltx_align_center ltx_border_t">447</td>
<td id="S4.T1.1.4.4.5" class="ltx_td ltx_align_center ltx_border_t">135.4</td>
<td id="S4.T1.1.4.4.6" class="ltx_td ltx_align_center ltx_border_t">7385</td>
</tr>
<tr id="S4.T1.1.5.5" class="ltx_tr">
<td id="S4.T1.1.5.5.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><cite class="ltx_cite ltx_citemacro_cite">Huang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib7" title="" class="ltx_ref">2011</a>)</cite></td>
<td id="S4.T1.1.5.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">9268</td>
<td id="S4.T1.1.5.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">NA</td>
<td id="S4.T1.1.5.5.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">129</td>
<td id="S4.T1.1.5.5.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">18.70</td>
<td id="S4.T1.1.5.5.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">NA</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Comparison of ModMult operaion</figcaption>
</figure>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.1" class="ltx_p">Given the broad adoption of the ModMult operation, many implementation has been proposed by researchers, and we compare ours with them in Table <a href="#S4.T1" title="Table 1 ‣ 4 Evaluation ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Since we are targeting datacenter acceleration chips and applications, the DSP efficiency is a key factor evaluating an implementation. Comparing with the state of the art solution <cite class="ltx_cite ltx_citemacro_cite">San and At (<a href="#bib.bib16" title="" class="ltx_ref">2014</a>)</cite>, our ModMult module delivers a close latency but uses fewer DSPs due to our precise limit on resource usage. The authors of <cite class="ltx_cite ltx_citemacro_cite">Song <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib17" title="" class="ltx_ref">2010</a>)</cite> proposes an implementation using only one DSP and one block RAM. However, without employing the Karatsuba algorithm, their version turns out to be less efficient than ours. <cite class="ltx_cite ltx_citemacro_cite">Huang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib7" title="" class="ltx_ref">2011</a>)</cite> gives an implementation using circuit elements entirely without DSP, and it shows that an such a ModMult module consumes much area and limits the clock frequency, and hence not recommendable. Moreover, most of existing solutions are based on register-transfer level (RTL) that describes the circuit directly, but lacks the flexibility of parametrizing and reusing the ModMult module as our HLS version does.</p>
</div>
<div id="S4.p5" class="ltx_para">
<p id="S4.p5.1" class="ltx_p">To evaluate the effectiveness of the scheduling of ModMult operation, we compare the number of execution clock cycles with the theoretically ideal clock cycle, given as <math id="S4.p5.1.m1.2" class="ltx_Math" alttext="T=(l/k)(l/k+1)" display="inline"><semantics id="S4.p5.1.m1.2a"><mrow id="S4.p5.1.m1.2.2" xref="S4.p5.1.m1.2.2.cmml"><mi id="S4.p5.1.m1.2.2.4" xref="S4.p5.1.m1.2.2.4.cmml">T</mi><mo id="S4.p5.1.m1.2.2.3" xref="S4.p5.1.m1.2.2.3.cmml">=</mo><mrow id="S4.p5.1.m1.2.2.2" xref="S4.p5.1.m1.2.2.2.cmml"><mrow id="S4.p5.1.m1.1.1.1.1.1" xref="S4.p5.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p5.1.m1.1.1.1.1.1.2" xref="S4.p5.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.p5.1.m1.1.1.1.1.1.1" xref="S4.p5.1.m1.1.1.1.1.1.1.cmml"><mi id="S4.p5.1.m1.1.1.1.1.1.1.2" xref="S4.p5.1.m1.1.1.1.1.1.1.2.cmml">l</mi><mo id="S4.p5.1.m1.1.1.1.1.1.1.1" xref="S4.p5.1.m1.1.1.1.1.1.1.1.cmml">/</mo><mi id="S4.p5.1.m1.1.1.1.1.1.1.3" xref="S4.p5.1.m1.1.1.1.1.1.1.3.cmml">k</mi></mrow><mo stretchy="false" id="S4.p5.1.m1.1.1.1.1.1.3" xref="S4.p5.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.p5.1.m1.2.2.2.3" xref="S4.p5.1.m1.2.2.2.3.cmml">​</mo><mrow id="S4.p5.1.m1.2.2.2.2.1" xref="S4.p5.1.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S4.p5.1.m1.2.2.2.2.1.2" xref="S4.p5.1.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.p5.1.m1.2.2.2.2.1.1" xref="S4.p5.1.m1.2.2.2.2.1.1.cmml"><mrow id="S4.p5.1.m1.2.2.2.2.1.1.2" xref="S4.p5.1.m1.2.2.2.2.1.1.2.cmml"><mi id="S4.p5.1.m1.2.2.2.2.1.1.2.2" xref="S4.p5.1.m1.2.2.2.2.1.1.2.2.cmml">l</mi><mo id="S4.p5.1.m1.2.2.2.2.1.1.2.1" xref="S4.p5.1.m1.2.2.2.2.1.1.2.1.cmml">/</mo><mi id="S4.p5.1.m1.2.2.2.2.1.1.2.3" xref="S4.p5.1.m1.2.2.2.2.1.1.2.3.cmml">k</mi></mrow><mo id="S4.p5.1.m1.2.2.2.2.1.1.1" xref="S4.p5.1.m1.2.2.2.2.1.1.1.cmml">+</mo><mn id="S4.p5.1.m1.2.2.2.2.1.1.3" xref="S4.p5.1.m1.2.2.2.2.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.p5.1.m1.2.2.2.2.1.3" xref="S4.p5.1.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p5.1.m1.2b"><apply id="S4.p5.1.m1.2.2.cmml" xref="S4.p5.1.m1.2.2"><eq id="S4.p5.1.m1.2.2.3.cmml" xref="S4.p5.1.m1.2.2.3"></eq><ci id="S4.p5.1.m1.2.2.4.cmml" xref="S4.p5.1.m1.2.2.4">𝑇</ci><apply id="S4.p5.1.m1.2.2.2.cmml" xref="S4.p5.1.m1.2.2.2"><times id="S4.p5.1.m1.2.2.2.3.cmml" xref="S4.p5.1.m1.2.2.2.3"></times><apply id="S4.p5.1.m1.1.1.1.1.1.1.cmml" xref="S4.p5.1.m1.1.1.1.1.1"><divide id="S4.p5.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.p5.1.m1.1.1.1.1.1.1.1"></divide><ci id="S4.p5.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.p5.1.m1.1.1.1.1.1.1.2">𝑙</ci><ci id="S4.p5.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.p5.1.m1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.p5.1.m1.2.2.2.2.1.1.cmml" xref="S4.p5.1.m1.2.2.2.2.1"><plus id="S4.p5.1.m1.2.2.2.2.1.1.1.cmml" xref="S4.p5.1.m1.2.2.2.2.1.1.1"></plus><apply id="S4.p5.1.m1.2.2.2.2.1.1.2.cmml" xref="S4.p5.1.m1.2.2.2.2.1.1.2"><divide id="S4.p5.1.m1.2.2.2.2.1.1.2.1.cmml" xref="S4.p5.1.m1.2.2.2.2.1.1.2.1"></divide><ci id="S4.p5.1.m1.2.2.2.2.1.1.2.2.cmml" xref="S4.p5.1.m1.2.2.2.2.1.1.2.2">𝑙</ci><ci id="S4.p5.1.m1.2.2.2.2.1.1.2.3.cmml" xref="S4.p5.1.m1.2.2.2.2.1.1.2.3">𝑘</ci></apply><cn type="integer" id="S4.p5.1.m1.2.2.2.2.1.1.3.cmml" xref="S4.p5.1.m1.2.2.2.2.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.1.m1.2c">T=(l/k)(l/k+1)</annotation></semantics></math> (Section <a href="#S3" title="3 Design and Implementation ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). As shown in Figure <a href="#S4.F7" title="Figure 7 ‣ 4 Evaluation ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, for different sizes of operands, our implementation keeps no more than 10% higher than the ideal. The gap is mainly due to pipeline stages, time for initialization and data transfer.</p>
</div>
<figure id="S4.F7" class="ltx_figure">
<table id="S4.F7.2" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.F7.2.2" class="ltx_tr">
<td id="S4.F7.2.2.2" class="ltx_td ltx_align_center">
<div id="S4.F7.1.1.1.1" class="ltx_block ltx_minipage ltx_align_top" style="width:208.1pt;">
<img src="/html/2007.10560/assets/x1.png" id="S4.F7.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="276" alt="[Uncaptioned image]">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_block">Figure 6: </span>Number of execution clock cycles of ModMult operation</figcaption>
</div>

<div id="S4.F7.2.2.2.2" class="ltx_block ltx_minipage ltx_align_top" style="width:208.1pt;">
<img src="/html/2007.10560/assets/x2.png" id="S4.F7.2.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="276" alt="[Uncaptioned image]">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_block">Figure 7: </span>Throughput of FPGA and multicore processor</figcaption>
</div>
</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.F9" class="ltx_figure">
<table id="S4.F9.2" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.F9.2.2" class="ltx_tr">
<td id="S4.F9.2.2.2" class="ltx_td ltx_align_center">
<div id="S4.F9.1.1.1.1" class="ltx_block ltx_minipage ltx_align_top" style="width:208.1pt;">
<img src="/html/2007.10560/assets/x3.png" id="S4.F9.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="276" alt="[Uncaptioned image]">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_block">Figure 8: </span>Encryption Throughput Compared with Software</figcaption>
</div>

<div id="S4.F9.2.2.2.2" class="ltx_block ltx_minipage ltx_align_top" style="width:208.1pt;">
<img src="/html/2007.10560/assets/x4.png" id="S4.F9.2.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="276" alt="[Uncaptioned image]">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_block">Figure 9: </span>Decryption Throughput Compared with Software</figcaption>
</div>
</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.p6" class="ltx_para">
<p id="S4.p6.2" class="ltx_p">To investigate the performance of FPGA and software solution, we compare the framework with PHE, a popular Paillier library, as shown in Figure <a href="#S4.F9" title="Figure 9 ‣ 4 Evaluation ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> and <a href="#S4.F9" title="Figure 9 ‣ 4 Evaluation ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>. We can see that for a 1024-bit public key, our framework delivers an acceleration ratio of <math id="S4.p6.1.m1.1" class="ltx_math_unparsed" alttext="10.62\times" display="inline"><semantics id="S4.p6.1.m1.1a"><mrow id="S4.p6.1.m1.1b"><mn id="S4.p6.1.m1.1.1">10.62</mn><mo lspace="0.222em" id="S4.p6.1.m1.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S4.p6.1.m1.1c">10.62\times</annotation></semantics></math> and <math id="S4.p6.2.m2.1" class="ltx_math_unparsed" alttext="2.76\times" display="inline"><semantics id="S4.p6.2.m2.1a"><mrow id="S4.p6.2.m2.1b"><mn id="S4.p6.2.m2.1.1">2.76</mn><mo lspace="0.222em" id="S4.p6.2.m2.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S4.p6.2.m2.1c">2.76\times</annotation></semantics></math> for encryption and decryption, respectively. We also compare FPGA with a multicore processor using <span id="S4.p6.2.1" class="ltx_text ltx_font_typewriter">libpaillier</span> library, as shown in Figure <a href="#S4.F7" title="Figure 7 ‣ 4 Evaluation ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. It shows that an FPGA effectively outperforms a multicore CPU and is advisable to be used in accelerating computational intensive applications.</p>
</div>
<div id="S4.p7" class="ltx_para">
<p id="S4.p7.1" class="ltx_p">Additionally, we test the modified FATE with linear models and the breast and motor datasets. We train a logistic regression and a linear regression model on the two datasets respectively for 10 iterations, and record the timing.
Figure <a href="#S4.F11" title="Figure 11 ‣ 4 Evaluation ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> and Figure <a href="#S4.F11" title="Figure 11 ‣ 4 Evaluation ‣ FPGA-Based Hardware Accelerator of Homomorphic Encryption for Efficient Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> show the training iteration time and the encryption time in each iteration respectively. It demonstrates that for linear models, our framework reduce the training iteration time by up to 26%, and the encryption time during one iteration by 71.2%.</p>
</div>
<figure id="S4.F11" class="ltx_figure">
<table id="S4.F11.2" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.F11.2.2" class="ltx_tr">
<td id="S4.F11.2.2.2" class="ltx_td ltx_align_center">
<div id="S4.F11.1.1.1.1" class="ltx_block ltx_minipage ltx_align_top" style="width:208.1pt;">
<img src="/html/2007.10560/assets/x5.png" id="S4.F11.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="276" alt="[Uncaptioned image]">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_block">Figure 10: </span>Improvement on Iteration Time</figcaption>
</div>

<div id="S4.F11.2.2.2.2" class="ltx_block ltx_minipage ltx_align_top" style="width:208.1pt;">
<img src="/html/2007.10560/assets/x6.png" id="S4.F11.2.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="276" alt="[Uncaptioned image]">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_block">Figure 11: </span>Improvement on Encryption Time Per Iteration</figcaption>
</div>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we have demonstrated the significance of accelerating homomorphic encryption and modular operations. We explored a compact architecture for Paillier cryptosystem with an HLS-based approach, investigating how to optimize the performance, and incorporated the FPGA framework into a federated learning system. We conducted extensive experiments to present the effectiveness and efficiency of our encryption framework.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aono <span id="bib.bib1.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Yoshinori Aono, Takuya Hayashi, Lihua Wang, Shiho Moriai, et al.

</span>
<span class="ltx_bibblock">Privacy-preserving deep learning via additively homomorphic
encryption.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text ltx_font_italic">IEEE Transactions on Information Forensics and Security</span>,
13(5):1333–1345, 2017.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bunn and Ostrovsky [2007]</span>
<span class="ltx_bibblock">
Paul Bunn and Rafail Ostrovsky.

</span>
<span class="ltx_bibblock">Secure two-party k-means clustering.

</span>
<span class="ltx_bibblock">pages 486–497, 2007.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chai <span id="bib.bib3.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Di Chai, Leye Wang, Kai Chen, and Qiang Yang.

</span>
<span class="ltx_bibblock">Secure federated matrix factorization.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1906.05108</span>, 2019.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">FAT [2019]</span>
<span class="ltx_bibblock">
Federated ai ecosystem. https://fate.fedai.org/, 2019.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gilad-Bachrach <span id="bib.bib5.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2016]</span>
<span class="ltx_bibblock">
Ran Gilad-Bachrach, Nathan Dowlin, Kim Laine, Kristin Lauter, Michael Naehrig,
and John Wernsing.

</span>
<span class="ltx_bibblock">Cryptonets: Applying neural networks to encrypted data with high
throughput and accuracy.

</span>
<span class="ltx_bibblock">In <span id="bib.bib5.3.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
201–210, 2016.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hardy <span id="bib.bib6.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Stephen Hardy, Wilko Henecka, Hamish Ivey-Law, Richard Nock, Giorgio Patrini,
Guillaume Smith, and Brian Thorne.

</span>
<span class="ltx_bibblock">Private federated learning on vertically partitioned data via entity
resolution and additively homomorphic encryption.

</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1711.10677</span>, 2017.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang <span id="bib.bib7.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2011]</span>
<span class="ltx_bibblock">
Miaoqing Huang, Kris Gaj, and Tarek A. El-Ghazawi.

</span>
<span class="ltx_bibblock">New hardware architectures for montgomery modular multiplication
algorithm.

</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text ltx_font_italic">IEEE Trans. Computers</span>, 60(7):923–936, 2011.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">L‘ecuyer <span id="bib.bib8.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Mathias L‘ecuyer, Riley Spahn, Kiran Vodrahalli, Roxana Geambasu, and Daniel
Hsu.

</span>
<span class="ltx_bibblock">Privacy accounting and quality control in the sage differentially
private ml platform.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text ltx_font_italic">SIGOPS Oper. Syst. Rev.</span>, 53(1):75–84, July 2019.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu <span id="bib.bib9.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2018]</span>
<span class="ltx_bibblock">
Yang Liu, Tianjian Chen, and Qiang Yang.

</span>
<span class="ltx_bibblock">Secure federated transfer learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1812.03337</span>, 2018.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu <span id="bib.bib10.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Ximeng Liu, Robert Deng, Kim-Kwang Raymond Choo, and Yang Yang.

</span>
<span class="ltx_bibblock">Privacy-preserving reinforcement learning design for patient-centric
dynamic treatment regimes.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text ltx_font_italic">IEEE Transactions on Emerging Topics in Computing</span>, 2019.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma <span id="bib.bib11.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Yukun Ma, Lifang Wu, Xiaofeng Gu, Jiaoyu He, and Zhou Yang.

</span>
<span class="ltx_bibblock">A secure face-verification scheme based on homomorphic encryption and
deep neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text ltx_font_italic">IEEE Access</span>, 5:16532–16538, 2017.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mohassel and
Zhang [2017]</span>
<span class="ltx_bibblock">
Payman Mohassel and Yupeng Zhang.

</span>
<span class="ltx_bibblock">Secureml: A system for scalable privacy-preserving machine learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">2017 IEEE Symposium on Security and Privacy (SP)</span>, pages
19–38. IEEE, 2017.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Montgomery [1985]</span>
<span class="ltx_bibblock">
Peter L Montgomery.

</span>
<span class="ltx_bibblock">Modular multiplication without trial division.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">Mathematics of computation</span>, 44(170):519–521, 1985.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paillier [1999]</span>
<span class="ltx_bibblock">
Pascal Paillier.

</span>
<span class="ltx_bibblock">Public-key cryptosystems based on composite degree residuosity
classes.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">theory and application of cryptographic techniques</span>, pages
223–238, 1999.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Putnam [2014]</span>
<span class="ltx_bibblock">
Andrew Putnam.

</span>
<span class="ltx_bibblock">Large-scale reconfigurable computing in a microsoft datacenter.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">2014 IEEE Hot Chips 26 Symposium (HCS)</span>, pages 1–38. IEEE,
2014.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">San and At [2014]</span>
<span class="ltx_bibblock">
Ismail San and Nuray At.

</span>
<span class="ltx_bibblock">Improving the computational efficiency of modular operations for
embedded systems.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">Journal of Systems Architecture - Embedded Systems Design</span>,
60(5):440–451, 2014.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song <span id="bib.bib17.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2010]</span>
<span class="ltx_bibblock">
Bo Song, Kensuke Kawakami, Koji Nakano, and Yasuaki Ito.

</span>
<span class="ltx_bibblock">An RSA encryption hardware algorithm using a single DSP block and
a single block RAM on the FPGA.

</span>
<span class="ltx_bibblock">In <span id="bib.bib17.3.1" class="ltx_text ltx_font_italic">First International Conference on Networking and Computing,
ICNC 2010, Higashi Hiroshima, Japan, November 17-19, 2010. Proceedings</span>,
pages 140–147, 2010.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wright and
Yang [2004]</span>
<span class="ltx_bibblock">
Rebecca N Wright and Zhiqiang Yang.

</span>
<span class="ltx_bibblock">Privacy-preserving bayesian network structure computation on
distributed heterogeneous data.

</span>
<span class="ltx_bibblock">pages 713–718, 2004.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang <span id="bib.bib19.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Qiang Yang, Yang Liu, Tianjian Chen, and Yongxin Tong.

</span>
<span class="ltx_bibblock">Federated machine learning: Concept and applications.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text ltx_font_italic">arXiv: Artificial Intelligence</span>, 2019.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2007.10559" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2007.10560" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2007.10560">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2007.10560" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2007.10561" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar 14 13:00:53 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
