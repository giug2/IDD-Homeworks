<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2202.07470] Federated Contrastive Learning for Dermatological Disease Diagnosis via On-device Learning This work was supported in part by NSF CNS-2122320.</title><meta property="og:description" content="Deep learning models have been deployed in an increasing number of edge and mobile devices to provide healthcare.
These models rely on training with a tremendous amount of labeled data to achieve high accuracy.
However…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated Contrastive Learning for Dermatological Disease Diagnosis via On-device Learning This work was supported in part by NSF CNS-2122320.">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated Contrastive Learning for Dermatological Disease Diagnosis via On-device Learning This work was supported in part by NSF CNS-2122320.">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2202.07470">

<!--Generated on Wed Mar 13 10:35:20 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Dermatological disease diagnosis,  federated learning,  contrastive learning,  on-device learning
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Federated Contrastive Learning for Dermatological Disease Diagnosis via On-device Learning
<span id="id1.id1" class="ltx_note ltx_role_thanks"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">thanks: </span>This work was supported in part by NSF CNS-2122320.</span></span></span>
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Yawen Wu<sup id="id2.1.id1" class="ltx_sup">1</sup>,
Dewen Zeng<sup id="id3.2.id2" class="ltx_sup">2</sup>,
Zhepeng Wang<sup id="id4.3.id3" class="ltx_sup">3</sup>,
Yi Sheng<sup id="id5.4.id4" class="ltx_sup">3</sup>,
Lei Yang<sup id="id6.5.id5" class="ltx_sup">4</sup>,
Alaina J. James<sup id="id7.6.id6" class="ltx_sup">1,5</sup>,
Yiyu Shi<sup id="id8.7.id7" class="ltx_sup">2</sup>,
Jingtong Hu<sup id="id9.8.id8" class="ltx_sup">1</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><sup id="id10.9.id1" class="ltx_sup">1</sup>University of Pittsburgh, PA, USA.
<sup id="id11.10.id2" class="ltx_sup">2</sup>University of Notre Dame, IN, USA.
<br class="ltx_break"><sup id="id12.11.id3" class="ltx_sup">3</sup>George Mason University, VA, USA.
<sup id="id13.12.id4" class="ltx_sup">4</sup>University of New Mexico, NM, USA.
<br class="ltx_break"><sup id="id14.13.id5" class="ltx_sup">5</sup>University of Pittsburgh Medical Center, PA, USA.
<br class="ltx_break">yawen.wu@pitt.edu, dzeng2@nd.edu, zwang48@gmu.edu, ysheng2@gmu.edu, 
<br class="ltx_break">leiyang@unm.edu, jamesaj@upmc.edu, yshi4@nd.edu, jthu@pitt.edu

</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id15.id1" class="ltx_p">Deep learning models have been deployed in an increasing number of edge and mobile devices to provide healthcare.
These models rely on training with a tremendous amount of labeled data to achieve high accuracy.
However, for medical applications such as dermatological disease diagnosis, the private data collected by mobile dermatology assistants exist on distributed mobile devices of patients, and each device only has a limited amount of data.
Directly learning from limited data greatly deteriorates the performance of learned models.
Federated learning (FL) can train models by using data distributed on devices while keeping the data local for privacy.
Existing works on FL assume all the data have ground-truth labels.
However, medical data often comes without any accompanying labels since labeling requires expertise and results in prohibitively high labor costs.
The recently developed self-supervised learning approach, contrastive learning (CL), can leverage the unlabeled data to pre-train a model for learning data representations, after which the learned model can be fine-tuned on limited labeled data to perform dermatological disease diagnosis.
However, simply combining CL with FL as federated contrastive learning (FCL) will result in ineffective learning since CL requires diverse data for accurate learning but each device in FL only has limited data diversity.
In this work, we propose an on-device FCL framework for dermatological disease diagnosis with limited labels.
Features are shared among devices in the FCL pre-training process to provide diverse and accurate contrastive information without sharing raw data for privacy. After that, the pre-trained model is fine-tuned with local labeled data independently on each device or collaboratively with supervised federated learning on all devices.
Experiments on dermatological disease datasets show that the proposed framework effectively improves the recall and precision of dermatological disease diagnosis compared with state-of-the-art methods.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Dermatological disease diagnosis, federated learning, contrastive learning, on-device learning

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Skin diseases are a major global health threat to a tremendous amount of people in the world <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.
These diseases not only injure the physical health including the risk of
skin cancer but also can result in psychological problems such as lack of self-confidence and psychological depression due to damaged appearance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.
Deep learning models have shown great promising in skin diseases diagnosis <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> and have been widely deployed on mobile devices as mobile dermatology assistants <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.
These models are trained on a large amount of data with full labels to achieve a high accuracy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.
When the large-scale datasets for training are not available, the performance of deep learning models will greatly degrade <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.
However, the images of skin disease are usually distributed on mobile devices of patients, which are impractical and even illegal to combine in a single location <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> to form large-scale datasets since data sharing is constrained by the Health Insurance Portability and Accountability Act (HIPAA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.
For example, skin disease images can be taken by the cameras of mobile devices and stored for a preliminary self-diagnosis <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.
But patients are usually reluctant to share highly private and sensitive images with the data center.
Without large-scale datasets in a single location, it is not doable to perform centralized training for learning an accurate model.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Federated learning (FL) is a distributed learning framework where many mobile devices collaboratively learn a global prediction model without sharing private data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>.
By leveraging FL, distributed data on mobile devices
can be used to train an accurate shared model to diagnose skin diseases while keeping data local.
Existing FL works assume the local data on devices are fully labeled and use supervised learning for local model updates. However, the assumption of fully labeled data is impractical. For instance, the patients may not want to spend time labeling their skin images captured by cameras of mobile phones. Even voluntary patients may not be able to accurately label all their own images due to the lack of expertise.
Therefore, most of the distributed data on devices will be unlabeled, and the deficiency of labels makes supervised FL unrealistic.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Contrastive learning (CL), a recently developed self-supervised learning approach, can learn effective visual representations on data without using labels <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>.
By combining CL with FL as federated contrastive learning (FCL), the conventional supervised learning on local devices can be replaced by CL pre-training without using labels.
After that, the pre-trained model can be used as the initialization to fine-tune for the diagnosis task with limited labels.
In this way, an accurate dermatological disease diagnosis model can be learned by using distributed data with limited labels.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">However, simply combining CL into FL cannot achieve optimal performance.
This is because existing CL approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> are originally developed for centralized training on large-scale datasets, assuming sufficiently diverse data is available for training.
More specifically, different from supervised learning with cross-entropy loss, in which each image is used independently from other images, CL relies on diverse data to learn the correlation between different images.
Without large data diversity, the performance of CL performance will greatly degrade, which also result in a low accuracy on the skin disease diagnosis after fine-tuning with labeled data.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To address this challenge, we propose an on-device FCL framework to enable effective FL with limited labels. This framework has two stages.
The first stage is federated self-supervised pre-training. Feature sharing is proposed to improve the data diversity of local contrastive learning while avoiding raw data sharing. Data features encoded in vectors are shared among devices, such that diverse and accurate contrastive information is provided to each device.
By leveraging the shared features, representations of higher quality are learned on local devices, which improves the quality of the aggregated model in FL.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">The second stage is fine-tuning with limited labeled data.
By using the pre-trained model in the first stage as a good initialization, the second stage learns the task of dermatological disease diagnosis by either fine-tuning independently on each device, or fine-tuning collaboratively on all devices by supervised federated learning with limited labels.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">In summary, the main contributions of this paper include:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p"><span id="S1.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Federated contrastive learning (FCL) framework.</span>
We propose an on-device FCL framework to enable effective learning with limited labels for dermatological disease diagnosis.
FCL pre-trains the model on distributed unlabeled data to provide a good initialization, followed by fine-tuning with a limited number of labeled data to perform the disease diagnosis.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p"><span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Feature sharing for better local learning.</span>
We propose a feature sharing method to improve the data diversity of local contrastive learning while avoiding raw data sharing for privacy.
The shared features provide more diverse features to contrast with during local learning on each mobile device for better representations.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p"><span id="S1.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">More accurate diagnosis and better label efficiency.</span>
Experiments on dermatological disease datasets with various skin colors show superior diagnostic accuracy and label efficiency over state-of-the-art techniques.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Background and Related Work</span>
</h2>

<figure id="S2.F1" class="ltx_figure"><img src="/html/2202.07470/assets/x1.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="368" height="306" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F1.8.4.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S2.F1.6.3" class="ltx_text" style="font-size:90%;">Illustration of contrastive learning. Two separate data augmentations operators are sampled from the same family of augmentations (<math id="S2.F1.4.1.m1.1" class="ltx_Math" alttext="t\sim T" display="inline"><semantics id="S2.F1.4.1.m1.1b"><mrow id="S2.F1.4.1.m1.1.1" xref="S2.F1.4.1.m1.1.1.cmml"><mi id="S2.F1.4.1.m1.1.1.2" xref="S2.F1.4.1.m1.1.1.2.cmml">t</mi><mo id="S2.F1.4.1.m1.1.1.1" xref="S2.F1.4.1.m1.1.1.1.cmml">∼</mo><mi id="S2.F1.4.1.m1.1.1.3" xref="S2.F1.4.1.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.F1.4.1.m1.1c"><apply id="S2.F1.4.1.m1.1.1.cmml" xref="S2.F1.4.1.m1.1.1"><csymbol cd="latexml" id="S2.F1.4.1.m1.1.1.1.cmml" xref="S2.F1.4.1.m1.1.1.1">similar-to</csymbol><ci id="S2.F1.4.1.m1.1.1.2.cmml" xref="S2.F1.4.1.m1.1.1.2">𝑡</ci><ci id="S2.F1.4.1.m1.1.1.3.cmml" xref="S2.F1.4.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.4.1.m1.1d">t\sim T</annotation></semantics></math> and <math id="S2.F1.5.2.m2.1" class="ltx_Math" alttext="t^{\prime}\sim T" display="inline"><semantics id="S2.F1.5.2.m2.1b"><mrow id="S2.F1.5.2.m2.1.1" xref="S2.F1.5.2.m2.1.1.cmml"><msup id="S2.F1.5.2.m2.1.1.2" xref="S2.F1.5.2.m2.1.1.2.cmml"><mi id="S2.F1.5.2.m2.1.1.2.2" xref="S2.F1.5.2.m2.1.1.2.2.cmml">t</mi><mo id="S2.F1.5.2.m2.1.1.2.3" xref="S2.F1.5.2.m2.1.1.2.3.cmml">′</mo></msup><mo id="S2.F1.5.2.m2.1.1.1" xref="S2.F1.5.2.m2.1.1.1.cmml">∼</mo><mi id="S2.F1.5.2.m2.1.1.3" xref="S2.F1.5.2.m2.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.F1.5.2.m2.1c"><apply id="S2.F1.5.2.m2.1.1.cmml" xref="S2.F1.5.2.m2.1.1"><csymbol cd="latexml" id="S2.F1.5.2.m2.1.1.1.cmml" xref="S2.F1.5.2.m2.1.1.1">similar-to</csymbol><apply id="S2.F1.5.2.m2.1.1.2.cmml" xref="S2.F1.5.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.F1.5.2.m2.1.1.2.1.cmml" xref="S2.F1.5.2.m2.1.1.2">superscript</csymbol><ci id="S2.F1.5.2.m2.1.1.2.2.cmml" xref="S2.F1.5.2.m2.1.1.2.2">𝑡</ci><ci id="S2.F1.5.2.m2.1.1.2.3.cmml" xref="S2.F1.5.2.m2.1.1.2.3">′</ci></apply><ci id="S2.F1.5.2.m2.1.1.3.cmml" xref="S2.F1.5.2.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.5.2.m2.1d">t^{\prime}\sim T</annotation></semantics></math>) and then applied to one image <math id="S2.F1.6.3.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.F1.6.3.m3.1b"><mi id="S2.F1.6.3.m3.1.1" xref="S2.F1.6.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.F1.6.3.m3.1c"><ci id="S2.F1.6.3.m3.1.1.cmml" xref="S2.F1.6.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.6.3.m3.1d">x</annotation></semantics></math>. The representations of the two transformed versions are pushing close to each other and apart from the representations of other images.</span></figcaption>
</figure>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2202.07470/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="132" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S2.F2.3.2" class="ltx_text" style="font-size:90%;">Federated contrastive learning with feature sharing for pre-training the model with unlabeled data, by which good data representations are learned.
After pre-training, the learned model is used as the initialization for fine-tuning with limited labels for dermatological disease classification.
</span></figcaption>
</figure>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.5.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.6.2" class="ltx_text ltx_font_italic">Contrastive Learning</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.17" class="ltx_p">Contrastive learning (CL) is a powerful self-supervised method to learn visual representations from unlabeled data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>.
CL pre-trains a model and provides high generalization performance for downstream tasks such as classification and segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>.
CL learns representations by performing a proxy task of discriminating the image identities.
In the learning process, CL minimizes a contrastive loss evaluated on pairs of feature vectors extracted from data augmentations (e.g. cropping, rotation, and color distortion) of the image <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>.
By optimizing the contrastive loss, CL maximizes the agreement of representations between transformations of the same identity and minimizes the agreement between different images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>.
As shown in Fig. <a href="#S2.F1" title="Figure 1 ‣ II Background and Related Work ‣ Federated Contrastive Learning for Dermatological Disease Diagnosis via On-device Learning This work was supported in part by NSF CNS-2122320." class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, for an unlabeled input image <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">x</annotation></semantics></math>, two random transformations <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="t\sim T" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mrow id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml">t</mi><mo id="S2.SS1.p1.2.m2.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.cmml">∼</mo><mi id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><csymbol cd="latexml" id="S2.SS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1">similar-to</csymbol><ci id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2">𝑡</ci><ci id="S2.SS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">t\sim T</annotation></semantics></math> and <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="t^{\prime}\sim T" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><mrow id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><msup id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml"><mi id="S2.SS1.p1.3.m3.1.1.2.2" xref="S2.SS1.p1.3.m3.1.1.2.2.cmml">t</mi><mo id="S2.SS1.p1.3.m3.1.1.2.3" xref="S2.SS1.p1.3.m3.1.1.2.3.cmml">′</mo></msup><mo id="S2.SS1.p1.3.m3.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.cmml">∼</mo><mi id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><csymbol cd="latexml" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1">similar-to</csymbol><apply id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.2.1.cmml" xref="S2.SS1.p1.3.m3.1.1.2">superscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2.2">𝑡</ci><ci id="S2.SS1.p1.3.m3.1.1.2.3.cmml" xref="S2.SS1.p1.3.m3.1.1.2.3">′</ci></apply><ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">t^{\prime}\sim T</annotation></semantics></math> are applied to <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><mi id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">x</annotation></semantics></math> to produce <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="x_{q}" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><msub id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml"><mi id="S2.SS1.p1.5.m5.1.1.2" xref="S2.SS1.p1.5.m5.1.1.2.cmml">x</mi><mi id="S2.SS1.p1.5.m5.1.1.3" xref="S2.SS1.p1.5.m5.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><apply id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p1.5.m5.1.1.2.cmml" xref="S2.SS1.p1.5.m5.1.1.2">𝑥</ci><ci id="S2.SS1.p1.5.m5.1.1.3.cmml" xref="S2.SS1.p1.5.m5.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">x_{q}</annotation></semantics></math> and <math id="S2.SS1.p1.6.m6.1" class="ltx_Math" alttext="x_{k^{+}}" display="inline"><semantics id="S2.SS1.p1.6.m6.1a"><msub id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mi id="S2.SS1.p1.6.m6.1.1.2" xref="S2.SS1.p1.6.m6.1.1.2.cmml">x</mi><msup id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml"><mi id="S2.SS1.p1.6.m6.1.1.3.2" xref="S2.SS1.p1.6.m6.1.1.3.2.cmml">k</mi><mo id="S2.SS1.p1.6.m6.1.1.3.3" xref="S2.SS1.p1.6.m6.1.1.3.3.cmml">+</mo></msup></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2">𝑥</ci><apply id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.3.1.cmml" xref="S2.SS1.p1.6.m6.1.1.3">superscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.3.2.cmml" xref="S2.SS1.p1.6.m6.1.1.3.2">𝑘</ci><plus id="S2.SS1.p1.6.m6.1.1.3.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">x_{k^{+}}</annotation></semantics></math>, both of which are then fed into the model <math id="S2.SS1.p1.7.m7.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S2.SS1.p1.7.m7.1a"><mi id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">f</annotation></semantics></math> and projection head <math id="S2.SS1.p1.8.m8.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S2.SS1.p1.8.m8.1a"><mi id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><ci id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">g</annotation></semantics></math> to get representations <math id="S2.SS1.p1.9.m9.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S2.SS1.p1.9.m9.1a"><mi id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><ci id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">q</annotation></semantics></math> and <math id="S2.SS1.p1.10.m10.1" class="ltx_Math" alttext="k^{+}" display="inline"><semantics id="S2.SS1.p1.10.m10.1a"><msup id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml"><mi id="S2.SS1.p1.10.m10.1.1.2" xref="S2.SS1.p1.10.m10.1.1.2.cmml">k</mi><mo id="S2.SS1.p1.10.m10.1.1.3" xref="S2.SS1.p1.10.m10.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><apply id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1">superscript</csymbol><ci id="S2.SS1.p1.10.m10.1.1.2.cmml" xref="S2.SS1.p1.10.m10.1.1.2">𝑘</ci><plus id="S2.SS1.p1.10.m10.1.1.3.cmml" xref="S2.SS1.p1.10.m10.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">k^{+}</annotation></semantics></math>.
Let <math id="S2.SS1.p1.11.m11.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S2.SS1.p1.11.m11.1a"><mi id="S2.SS1.p1.11.m11.1.1" xref="S2.SS1.p1.11.m11.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.1b"><ci id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.1c">Q</annotation></semantics></math> be a memory bank with <math id="S2.SS1.p1.12.m12.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS1.p1.12.m12.1a"><mi id="S2.SS1.p1.12.m12.1.1" xref="S2.SS1.p1.12.m12.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m12.1b"><ci id="S2.SS1.p1.12.m12.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m12.1c">K</annotation></semantics></math> representation vectors stored. By using every feature <math id="S2.SS1.p1.13.m13.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.SS1.p1.13.m13.1a"><mi id="S2.SS1.p1.13.m13.1.1" xref="S2.SS1.p1.13.m13.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.13.m13.1b"><ci id="S2.SS1.p1.13.m13.1.1.cmml" xref="S2.SS1.p1.13.m13.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.13.m13.1c">n</annotation></semantics></math> in the memory bank <math id="S2.SS1.p1.14.m14.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S2.SS1.p1.14.m14.1a"><mi id="S2.SS1.p1.14.m14.1.1" xref="S2.SS1.p1.14.m14.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.14.m14.1b"><ci id="S2.SS1.p1.14.m14.1.1.cmml" xref="S2.SS1.p1.14.m14.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.14.m14.1c">Q</annotation></semantics></math> as negatives, a positive pair <math id="S2.SS1.p1.15.m15.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S2.SS1.p1.15.m15.1a"><mi id="S2.SS1.p1.15.m15.1.1" xref="S2.SS1.p1.15.m15.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.15.m15.1b"><ci id="S2.SS1.p1.15.m15.1.1.cmml" xref="S2.SS1.p1.15.m15.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.15.m15.1c">q</annotation></semantics></math> and <math id="S2.SS1.p1.16.m16.1" class="ltx_Math" alttext="k^{+}" display="inline"><semantics id="S2.SS1.p1.16.m16.1a"><msup id="S2.SS1.p1.16.m16.1.1" xref="S2.SS1.p1.16.m16.1.1.cmml"><mi id="S2.SS1.p1.16.m16.1.1.2" xref="S2.SS1.p1.16.m16.1.1.2.cmml">k</mi><mo id="S2.SS1.p1.16.m16.1.1.3" xref="S2.SS1.p1.16.m16.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.16.m16.1b"><apply id="S2.SS1.p1.16.m16.1.1.cmml" xref="S2.SS1.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.16.m16.1.1.1.cmml" xref="S2.SS1.p1.16.m16.1.1">superscript</csymbol><ci id="S2.SS1.p1.16.m16.1.1.2.cmml" xref="S2.SS1.p1.16.m16.1.1.2">𝑘</ci><plus id="S2.SS1.p1.16.m16.1.1.3.cmml" xref="S2.SS1.p1.16.m16.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.16.m16.1c">k^{+}</annotation></semantics></math> are contrasted with every <math id="S2.SS1.p1.17.m17.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.SS1.p1.17.m17.1a"><mi id="S2.SS1.p1.17.m17.1.1" xref="S2.SS1.p1.17.m17.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.17.m17.1b"><ci id="S2.SS1.p1.17.m17.1.1.cmml" xref="S2.SS1.p1.17.m17.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.17.m17.1c">n</annotation></semantics></math> by the following contrastive loss function.</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.7" class="ltx_Math" alttext="\ell_{q}=-\log\frac{\exp(q\cdot k^{+}/\tau)}{\exp(q\cdot k^{+}/\tau)+\sum_{n\in Q}\exp(q\cdot n/\tau)}." display="block"><semantics id="S2.E1.m1.7a"><mrow id="S2.E1.m1.7.7.1" xref="S2.E1.m1.7.7.1.1.cmml"><mrow id="S2.E1.m1.7.7.1.1" xref="S2.E1.m1.7.7.1.1.cmml"><msub id="S2.E1.m1.7.7.1.1.2" xref="S2.E1.m1.7.7.1.1.2.cmml"><mi mathvariant="normal" id="S2.E1.m1.7.7.1.1.2.2" xref="S2.E1.m1.7.7.1.1.2.2.cmml">ℓ</mi><mi id="S2.E1.m1.7.7.1.1.2.3" xref="S2.E1.m1.7.7.1.1.2.3.cmml">q</mi></msub><mo id="S2.E1.m1.7.7.1.1.1" xref="S2.E1.m1.7.7.1.1.1.cmml">=</mo><mrow id="S2.E1.m1.7.7.1.1.3" xref="S2.E1.m1.7.7.1.1.3.cmml"><mo rspace="0.167em" id="S2.E1.m1.7.7.1.1.3a" xref="S2.E1.m1.7.7.1.1.3.cmml">−</mo><mrow id="S2.E1.m1.7.7.1.1.3.2" xref="S2.E1.m1.7.7.1.1.3.2.cmml"><mi id="S2.E1.m1.7.7.1.1.3.2.1" xref="S2.E1.m1.7.7.1.1.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S2.E1.m1.7.7.1.1.3.2a" xref="S2.E1.m1.7.7.1.1.3.2.cmml">⁡</mo><mfrac id="S2.E1.m1.6.6" xref="S2.E1.m1.6.6.cmml"><mrow id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">exp</mi><mo id="S2.E1.m1.2.2.2.2a" xref="S2.E1.m1.2.2.2.3.cmml">⁡</mo><mrow id="S2.E1.m1.2.2.2.2.1" xref="S2.E1.m1.2.2.2.3.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.2.2.1.2" xref="S2.E1.m1.2.2.2.3.cmml">(</mo><mrow id="S2.E1.m1.2.2.2.2.1.1" xref="S2.E1.m1.2.2.2.2.1.1.cmml"><mrow id="S2.E1.m1.2.2.2.2.1.1.2" xref="S2.E1.m1.2.2.2.2.1.1.2.cmml"><mi id="S2.E1.m1.2.2.2.2.1.1.2.2" xref="S2.E1.m1.2.2.2.2.1.1.2.2.cmml">q</mi><mo lspace="0.222em" rspace="0.222em" id="S2.E1.m1.2.2.2.2.1.1.2.1" xref="S2.E1.m1.2.2.2.2.1.1.2.1.cmml">⋅</mo><msup id="S2.E1.m1.2.2.2.2.1.1.2.3" xref="S2.E1.m1.2.2.2.2.1.1.2.3.cmml"><mi id="S2.E1.m1.2.2.2.2.1.1.2.3.2" xref="S2.E1.m1.2.2.2.2.1.1.2.3.2.cmml">k</mi><mo id="S2.E1.m1.2.2.2.2.1.1.2.3.3" xref="S2.E1.m1.2.2.2.2.1.1.2.3.3.cmml">+</mo></msup></mrow><mo id="S2.E1.m1.2.2.2.2.1.1.1" xref="S2.E1.m1.2.2.2.2.1.1.1.cmml">/</mo><mi id="S2.E1.m1.2.2.2.2.1.1.3" xref="S2.E1.m1.2.2.2.2.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="S2.E1.m1.2.2.2.2.1.3" xref="S2.E1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S2.E1.m1.6.6.6" xref="S2.E1.m1.6.6.6.cmml"><mrow id="S2.E1.m1.5.5.5.3.1" xref="S2.E1.m1.5.5.5.3.2.cmml"><mi id="S2.E1.m1.3.3.3.1" xref="S2.E1.m1.3.3.3.1.cmml">exp</mi><mo id="S2.E1.m1.5.5.5.3.1a" xref="S2.E1.m1.5.5.5.3.2.cmml">⁡</mo><mrow id="S2.E1.m1.5.5.5.3.1.1" xref="S2.E1.m1.5.5.5.3.2.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.5.3.1.1.2" xref="S2.E1.m1.5.5.5.3.2.cmml">(</mo><mrow id="S2.E1.m1.5.5.5.3.1.1.1" xref="S2.E1.m1.5.5.5.3.1.1.1.cmml"><mrow id="S2.E1.m1.5.5.5.3.1.1.1.2" xref="S2.E1.m1.5.5.5.3.1.1.1.2.cmml"><mi id="S2.E1.m1.5.5.5.3.1.1.1.2.2" xref="S2.E1.m1.5.5.5.3.1.1.1.2.2.cmml">q</mi><mo lspace="0.222em" rspace="0.222em" id="S2.E1.m1.5.5.5.3.1.1.1.2.1" xref="S2.E1.m1.5.5.5.3.1.1.1.2.1.cmml">⋅</mo><msup id="S2.E1.m1.5.5.5.3.1.1.1.2.3" xref="S2.E1.m1.5.5.5.3.1.1.1.2.3.cmml"><mi id="S2.E1.m1.5.5.5.3.1.1.1.2.3.2" xref="S2.E1.m1.5.5.5.3.1.1.1.2.3.2.cmml">k</mi><mo id="S2.E1.m1.5.5.5.3.1.1.1.2.3.3" xref="S2.E1.m1.5.5.5.3.1.1.1.2.3.3.cmml">+</mo></msup></mrow><mo id="S2.E1.m1.5.5.5.3.1.1.1.1" xref="S2.E1.m1.5.5.5.3.1.1.1.1.cmml">/</mo><mi id="S2.E1.m1.5.5.5.3.1.1.1.3" xref="S2.E1.m1.5.5.5.3.1.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="S2.E1.m1.5.5.5.3.1.1.3" xref="S2.E1.m1.5.5.5.3.2.cmml">)</mo></mrow></mrow><mo rspace="0.055em" id="S2.E1.m1.6.6.6.5" xref="S2.E1.m1.6.6.6.5.cmml">+</mo><mrow id="S2.E1.m1.6.6.6.4" xref="S2.E1.m1.6.6.6.4.cmml"><msub id="S2.E1.m1.6.6.6.4.2" xref="S2.E1.m1.6.6.6.4.2.cmml"><mo id="S2.E1.m1.6.6.6.4.2.2" xref="S2.E1.m1.6.6.6.4.2.2.cmml">∑</mo><mrow id="S2.E1.m1.6.6.6.4.2.3" xref="S2.E1.m1.6.6.6.4.2.3.cmml"><mi id="S2.E1.m1.6.6.6.4.2.3.2" xref="S2.E1.m1.6.6.6.4.2.3.2.cmml">n</mi><mo id="S2.E1.m1.6.6.6.4.2.3.1" xref="S2.E1.m1.6.6.6.4.2.3.1.cmml">∈</mo><mi id="S2.E1.m1.6.6.6.4.2.3.3" xref="S2.E1.m1.6.6.6.4.2.3.3.cmml">Q</mi></mrow></msub><mrow id="S2.E1.m1.6.6.6.4.1.1" xref="S2.E1.m1.6.6.6.4.1.2.cmml"><mi id="S2.E1.m1.4.4.4.2" xref="S2.E1.m1.4.4.4.2.cmml">exp</mi><mo id="S2.E1.m1.6.6.6.4.1.1a" xref="S2.E1.m1.6.6.6.4.1.2.cmml">⁡</mo><mrow id="S2.E1.m1.6.6.6.4.1.1.1" xref="S2.E1.m1.6.6.6.4.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.6.6.6.4.1.1.1.2" xref="S2.E1.m1.6.6.6.4.1.2.cmml">(</mo><mrow id="S2.E1.m1.6.6.6.4.1.1.1.1" xref="S2.E1.m1.6.6.6.4.1.1.1.1.cmml"><mrow id="S2.E1.m1.6.6.6.4.1.1.1.1.2" xref="S2.E1.m1.6.6.6.4.1.1.1.1.2.cmml"><mi id="S2.E1.m1.6.6.6.4.1.1.1.1.2.2" xref="S2.E1.m1.6.6.6.4.1.1.1.1.2.2.cmml">q</mi><mo lspace="0.222em" rspace="0.222em" id="S2.E1.m1.6.6.6.4.1.1.1.1.2.1" xref="S2.E1.m1.6.6.6.4.1.1.1.1.2.1.cmml">⋅</mo><mi id="S2.E1.m1.6.6.6.4.1.1.1.1.2.3" xref="S2.E1.m1.6.6.6.4.1.1.1.1.2.3.cmml">n</mi></mrow><mo id="S2.E1.m1.6.6.6.4.1.1.1.1.1" xref="S2.E1.m1.6.6.6.4.1.1.1.1.1.cmml">/</mo><mi id="S2.E1.m1.6.6.6.4.1.1.1.1.3" xref="S2.E1.m1.6.6.6.4.1.1.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="S2.E1.m1.6.6.6.4.1.1.1.3" xref="S2.E1.m1.6.6.6.4.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><mo lspace="0em" id="S2.E1.m1.7.7.1.2" xref="S2.E1.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.7b"><apply id="S2.E1.m1.7.7.1.1.cmml" xref="S2.E1.m1.7.7.1"><eq id="S2.E1.m1.7.7.1.1.1.cmml" xref="S2.E1.m1.7.7.1.1.1"></eq><apply id="S2.E1.m1.7.7.1.1.2.cmml" xref="S2.E1.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.1.1.2.1.cmml" xref="S2.E1.m1.7.7.1.1.2">subscript</csymbol><ci id="S2.E1.m1.7.7.1.1.2.2.cmml" xref="S2.E1.m1.7.7.1.1.2.2">ℓ</ci><ci id="S2.E1.m1.7.7.1.1.2.3.cmml" xref="S2.E1.m1.7.7.1.1.2.3">𝑞</ci></apply><apply id="S2.E1.m1.7.7.1.1.3.cmml" xref="S2.E1.m1.7.7.1.1.3"><minus id="S2.E1.m1.7.7.1.1.3.1.cmml" xref="S2.E1.m1.7.7.1.1.3"></minus><apply id="S2.E1.m1.7.7.1.1.3.2.cmml" xref="S2.E1.m1.7.7.1.1.3.2"><log id="S2.E1.m1.7.7.1.1.3.2.1.cmml" xref="S2.E1.m1.7.7.1.1.3.2.1"></log><apply id="S2.E1.m1.6.6.cmml" xref="S2.E1.m1.6.6"><divide id="S2.E1.m1.6.6.7.cmml" xref="S2.E1.m1.6.6"></divide><apply id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2"><exp id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1"></exp><apply id="S2.E1.m1.2.2.2.2.1.1.cmml" xref="S2.E1.m1.2.2.2.2.1.1"><divide id="S2.E1.m1.2.2.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.2.2.1.1.1"></divide><apply id="S2.E1.m1.2.2.2.2.1.1.2.cmml" xref="S2.E1.m1.2.2.2.2.1.1.2"><ci id="S2.E1.m1.2.2.2.2.1.1.2.1.cmml" xref="S2.E1.m1.2.2.2.2.1.1.2.1">⋅</ci><ci id="S2.E1.m1.2.2.2.2.1.1.2.2.cmml" xref="S2.E1.m1.2.2.2.2.1.1.2.2">𝑞</ci><apply id="S2.E1.m1.2.2.2.2.1.1.2.3.cmml" xref="S2.E1.m1.2.2.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.1.1.2.3.1.cmml" xref="S2.E1.m1.2.2.2.2.1.1.2.3">superscript</csymbol><ci id="S2.E1.m1.2.2.2.2.1.1.2.3.2.cmml" xref="S2.E1.m1.2.2.2.2.1.1.2.3.2">𝑘</ci><plus id="S2.E1.m1.2.2.2.2.1.1.2.3.3.cmml" xref="S2.E1.m1.2.2.2.2.1.1.2.3.3"></plus></apply></apply><ci id="S2.E1.m1.2.2.2.2.1.1.3.cmml" xref="S2.E1.m1.2.2.2.2.1.1.3">𝜏</ci></apply></apply><apply id="S2.E1.m1.6.6.6.cmml" xref="S2.E1.m1.6.6.6"><plus id="S2.E1.m1.6.6.6.5.cmml" xref="S2.E1.m1.6.6.6.5"></plus><apply id="S2.E1.m1.5.5.5.3.2.cmml" xref="S2.E1.m1.5.5.5.3.1"><exp id="S2.E1.m1.3.3.3.1.cmml" xref="S2.E1.m1.3.3.3.1"></exp><apply id="S2.E1.m1.5.5.5.3.1.1.1.cmml" xref="S2.E1.m1.5.5.5.3.1.1.1"><divide id="S2.E1.m1.5.5.5.3.1.1.1.1.cmml" xref="S2.E1.m1.5.5.5.3.1.1.1.1"></divide><apply id="S2.E1.m1.5.5.5.3.1.1.1.2.cmml" xref="S2.E1.m1.5.5.5.3.1.1.1.2"><ci id="S2.E1.m1.5.5.5.3.1.1.1.2.1.cmml" xref="S2.E1.m1.5.5.5.3.1.1.1.2.1">⋅</ci><ci id="S2.E1.m1.5.5.5.3.1.1.1.2.2.cmml" xref="S2.E1.m1.5.5.5.3.1.1.1.2.2">𝑞</ci><apply id="S2.E1.m1.5.5.5.3.1.1.1.2.3.cmml" xref="S2.E1.m1.5.5.5.3.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.5.3.1.1.1.2.3.1.cmml" xref="S2.E1.m1.5.5.5.3.1.1.1.2.3">superscript</csymbol><ci id="S2.E1.m1.5.5.5.3.1.1.1.2.3.2.cmml" xref="S2.E1.m1.5.5.5.3.1.1.1.2.3.2">𝑘</ci><plus id="S2.E1.m1.5.5.5.3.1.1.1.2.3.3.cmml" xref="S2.E1.m1.5.5.5.3.1.1.1.2.3.3"></plus></apply></apply><ci id="S2.E1.m1.5.5.5.3.1.1.1.3.cmml" xref="S2.E1.m1.5.5.5.3.1.1.1.3">𝜏</ci></apply></apply><apply id="S2.E1.m1.6.6.6.4.cmml" xref="S2.E1.m1.6.6.6.4"><apply id="S2.E1.m1.6.6.6.4.2.cmml" xref="S2.E1.m1.6.6.6.4.2"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.6.4.2.1.cmml" xref="S2.E1.m1.6.6.6.4.2">subscript</csymbol><sum id="S2.E1.m1.6.6.6.4.2.2.cmml" xref="S2.E1.m1.6.6.6.4.2.2"></sum><apply id="S2.E1.m1.6.6.6.4.2.3.cmml" xref="S2.E1.m1.6.6.6.4.2.3"><in id="S2.E1.m1.6.6.6.4.2.3.1.cmml" xref="S2.E1.m1.6.6.6.4.2.3.1"></in><ci id="S2.E1.m1.6.6.6.4.2.3.2.cmml" xref="S2.E1.m1.6.6.6.4.2.3.2">𝑛</ci><ci id="S2.E1.m1.6.6.6.4.2.3.3.cmml" xref="S2.E1.m1.6.6.6.4.2.3.3">𝑄</ci></apply></apply><apply id="S2.E1.m1.6.6.6.4.1.2.cmml" xref="S2.E1.m1.6.6.6.4.1.1"><exp id="S2.E1.m1.4.4.4.2.cmml" xref="S2.E1.m1.4.4.4.2"></exp><apply id="S2.E1.m1.6.6.6.4.1.1.1.1.cmml" xref="S2.E1.m1.6.6.6.4.1.1.1.1"><divide id="S2.E1.m1.6.6.6.4.1.1.1.1.1.cmml" xref="S2.E1.m1.6.6.6.4.1.1.1.1.1"></divide><apply id="S2.E1.m1.6.6.6.4.1.1.1.1.2.cmml" xref="S2.E1.m1.6.6.6.4.1.1.1.1.2"><ci id="S2.E1.m1.6.6.6.4.1.1.1.1.2.1.cmml" xref="S2.E1.m1.6.6.6.4.1.1.1.1.2.1">⋅</ci><ci id="S2.E1.m1.6.6.6.4.1.1.1.1.2.2.cmml" xref="S2.E1.m1.6.6.6.4.1.1.1.1.2.2">𝑞</ci><ci id="S2.E1.m1.6.6.6.4.1.1.1.1.2.3.cmml" xref="S2.E1.m1.6.6.6.4.1.1.1.1.2.3">𝑛</ci></apply><ci id="S2.E1.m1.6.6.6.4.1.1.1.1.3.cmml" xref="S2.E1.m1.6.6.6.4.1.1.1.1.3">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.7c">\ell_{q}=-\log\frac{\exp(q\cdot k^{+}/\tau)}{\exp(q\cdot k^{+}/\tau)+\sum_{n\in Q}\exp(q\cdot n/\tau)}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.19" class="ltx_p">By optimizing the model <math id="S2.SS1.p1.18.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S2.SS1.p1.18.m1.1a"><mi id="S2.SS1.p1.18.m1.1.1" xref="S2.SS1.p1.18.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.18.m1.1b"><ci id="S2.SS1.p1.18.m1.1.1.cmml" xref="S2.SS1.p1.18.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.18.m1.1c">f</annotation></semantics></math> to minimize the loss function, effective visual representations can be learned by <math id="S2.SS1.p1.19.m2.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S2.SS1.p1.19.m2.1a"><mi id="S2.SS1.p1.19.m2.1.1" xref="S2.SS1.p1.19.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.19.m2.1b"><ci id="S2.SS1.p1.19.m2.1.1.cmml" xref="S2.SS1.p1.19.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.19.m2.1c">f</annotation></semantics></math>.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">However, existing CL works are developed for centralized training on large-scale datasets consisting of millions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> or even billions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> of images.
The large-scale datasets provide sufficiently large data diversity for training.
However, in FL each device only has a limited amount of data with limited diversity. Since CL relies on the contrast with different data to achieve high performance, without large data diversity, the performance of CL will greatly degrade.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.5.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.6.2" class="ltx_text ltx_font_italic">Federated Learning</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.8" class="ltx_p">Federated learning (FL) aims to collaboratively learn a global model for distributed devices while keeping data local devices for privacy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>.
In FL, the training data are distributed among devices, and each device has a subset of the training data.
In a typical FL algorithm FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>,
learning is performed round-by-round by repeating the local learning and model aggregation process until convergence.
In one round, the server activates a subset of devices and sends them the latest model. Then the activated devices perform learning on local data.
More specifically, in communication round <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">t</annotation></semantics></math>, the server activates a subset of devices <math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="C^{t}" display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><msup id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.2" xref="S2.SS2.p1.2.m2.1.1.2.cmml">C</mi><mi id="S2.SS2.p1.2.m2.1.1.3" xref="S2.SS2.p1.2.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">superscript</csymbol><ci id="S2.SS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2">𝐶</ci><ci id="S2.SS2.p1.2.m2.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">C^{t}</annotation></semantics></math> and downloads the latest global model with parameters <math id="S2.SS2.p1.3.m3.1" class="ltx_Math" alttext="\theta^{t}" display="inline"><semantics id="S2.SS2.p1.3.m3.1a"><msup id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml"><mi id="S2.SS2.p1.3.m3.1.1.2" xref="S2.SS2.p1.3.m3.1.1.2.cmml">θ</mi><mi id="S2.SS2.p1.3.m3.1.1.3" xref="S2.SS2.p1.3.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><apply id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">superscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.2">𝜃</ci><ci id="S2.SS2.p1.3.m3.1.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">\theta^{t}</annotation></semantics></math> to them.
Each device <math id="S2.SS2.p1.4.m4.1" class="ltx_Math" alttext="c\in C^{t}" display="inline"><semantics id="S2.SS2.p1.4.m4.1a"><mrow id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml"><mi id="S2.SS2.p1.4.m4.1.1.2" xref="S2.SS2.p1.4.m4.1.1.2.cmml">c</mi><mo id="S2.SS2.p1.4.m4.1.1.1" xref="S2.SS2.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S2.SS2.p1.4.m4.1.1.3" xref="S2.SS2.p1.4.m4.1.1.3.cmml"><mi id="S2.SS2.p1.4.m4.1.1.3.2" xref="S2.SS2.p1.4.m4.1.1.3.2.cmml">C</mi><mi id="S2.SS2.p1.4.m4.1.1.3.3" xref="S2.SS2.p1.4.m4.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><apply id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1"><in id="S2.SS2.p1.4.m4.1.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1.1"></in><ci id="S2.SS2.p1.4.m4.1.1.2.cmml" xref="S2.SS2.p1.4.m4.1.1.2">𝑐</ci><apply id="S2.SS2.p1.4.m4.1.1.3.cmml" xref="S2.SS2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.1.1.3.1.cmml" xref="S2.SS2.p1.4.m4.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.4.m4.1.1.3.2.cmml" xref="S2.SS2.p1.4.m4.1.1.3.2">𝐶</ci><ci id="S2.SS2.p1.4.m4.1.1.3.3.cmml" xref="S2.SS2.p1.4.m4.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">c\in C^{t}</annotation></semantics></math> learns on private dataset <math id="S2.SS2.p1.5.m5.1" class="ltx_Math" alttext="D_{c}" display="inline"><semantics id="S2.SS2.p1.5.m5.1a"><msub id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml"><mi id="S2.SS2.p1.5.m5.1.1.2" xref="S2.SS2.p1.5.m5.1.1.2.cmml">D</mi><mi id="S2.SS2.p1.5.m5.1.1.3" xref="S2.SS2.p1.5.m5.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><apply id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.1.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p1.5.m5.1.1.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2">𝐷</ci><ci id="S2.SS2.p1.5.m5.1.1.3.cmml" xref="S2.SS2.p1.5.m5.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">D_{c}</annotation></semantics></math> by minimizing the local loss
<math id="S2.SS2.p1.6.m6.1" class="ltx_Math" alttext="\ell_{c}" display="inline"><semantics id="S2.SS2.p1.6.m6.1a"><msub id="S2.SS2.p1.6.m6.1.1" xref="S2.SS2.p1.6.m6.1.1.cmml"><mi mathvariant="normal" id="S2.SS2.p1.6.m6.1.1.2" xref="S2.SS2.p1.6.m6.1.1.2.cmml">ℓ</mi><mi id="S2.SS2.p1.6.m6.1.1.3" xref="S2.SS2.p1.6.m6.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.1b"><apply id="S2.SS2.p1.6.m6.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m6.1.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS2.p1.6.m6.1.1.2.cmml" xref="S2.SS2.p1.6.m6.1.1.2">ℓ</ci><ci id="S2.SS2.p1.6.m6.1.1.3.cmml" xref="S2.SS2.p1.6.m6.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.1c">\ell_{c}</annotation></semantics></math>
to get the updated local parameters <math id="S2.SS2.p1.7.m7.1" class="ltx_Math" alttext="\theta_{c}^{t+1}" display="inline"><semantics id="S2.SS2.p1.7.m7.1a"><msubsup id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml"><mi id="S2.SS2.p1.7.m7.1.1.2.2" xref="S2.SS2.p1.7.m7.1.1.2.2.cmml">θ</mi><mi id="S2.SS2.p1.7.m7.1.1.2.3" xref="S2.SS2.p1.7.m7.1.1.2.3.cmml">c</mi><mrow id="S2.SS2.p1.7.m7.1.1.3" xref="S2.SS2.p1.7.m7.1.1.3.cmml"><mi id="S2.SS2.p1.7.m7.1.1.3.2" xref="S2.SS2.p1.7.m7.1.1.3.2.cmml">t</mi><mo id="S2.SS2.p1.7.m7.1.1.3.1" xref="S2.SS2.p1.7.m7.1.1.3.1.cmml">+</mo><mn id="S2.SS2.p1.7.m7.1.1.3.3" xref="S2.SS2.p1.7.m7.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.1b"><apply id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.1.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1">superscript</csymbol><apply id="S2.SS2.p1.7.m7.1.1.2.cmml" xref="S2.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.1.1.2.1.cmml" xref="S2.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S2.SS2.p1.7.m7.1.1.2.2.cmml" xref="S2.SS2.p1.7.m7.1.1.2.2">𝜃</ci><ci id="S2.SS2.p1.7.m7.1.1.2.3.cmml" xref="S2.SS2.p1.7.m7.1.1.2.3">𝑐</ci></apply><apply id="S2.SS2.p1.7.m7.1.1.3.cmml" xref="S2.SS2.p1.7.m7.1.1.3"><plus id="S2.SS2.p1.7.m7.1.1.3.1.cmml" xref="S2.SS2.p1.7.m7.1.1.3.1"></plus><ci id="S2.SS2.p1.7.m7.1.1.3.2.cmml" xref="S2.SS2.p1.7.m7.1.1.3.2">𝑡</ci><cn type="integer" id="S2.SS2.p1.7.m7.1.1.3.3.cmml" xref="S2.SS2.p1.7.m7.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.1c">\theta_{c}^{t+1}</annotation></semantics></math>.
The locally updated models are aggregated into the global model by averaging the local parameters
<math id="S2.SS2.p1.8.m8.2" class="ltx_Math" alttext="\theta^{t+1}\leftarrow\sum_{c\in C^{t}}\frac{|D_{c}|}{\sum_{i\in C^{t}}|D_{i}|}{\theta_{c}^{t+1}}" display="inline"><semantics id="S2.SS2.p1.8.m8.2a"><mrow id="S2.SS2.p1.8.m8.2.3" xref="S2.SS2.p1.8.m8.2.3.cmml"><msup id="S2.SS2.p1.8.m8.2.3.2" xref="S2.SS2.p1.8.m8.2.3.2.cmml"><mi id="S2.SS2.p1.8.m8.2.3.2.2" xref="S2.SS2.p1.8.m8.2.3.2.2.cmml">θ</mi><mrow id="S2.SS2.p1.8.m8.2.3.2.3" xref="S2.SS2.p1.8.m8.2.3.2.3.cmml"><mi id="S2.SS2.p1.8.m8.2.3.2.3.2" xref="S2.SS2.p1.8.m8.2.3.2.3.2.cmml">t</mi><mo id="S2.SS2.p1.8.m8.2.3.2.3.1" xref="S2.SS2.p1.8.m8.2.3.2.3.1.cmml">+</mo><mn id="S2.SS2.p1.8.m8.2.3.2.3.3" xref="S2.SS2.p1.8.m8.2.3.2.3.3.cmml">1</mn></mrow></msup><mo rspace="0.111em" stretchy="false" id="S2.SS2.p1.8.m8.2.3.1" xref="S2.SS2.p1.8.m8.2.3.1.cmml">←</mo><mrow id="S2.SS2.p1.8.m8.2.3.3" xref="S2.SS2.p1.8.m8.2.3.3.cmml"><msub id="S2.SS2.p1.8.m8.2.3.3.1" xref="S2.SS2.p1.8.m8.2.3.3.1.cmml"><mo id="S2.SS2.p1.8.m8.2.3.3.1.2" xref="S2.SS2.p1.8.m8.2.3.3.1.2.cmml">∑</mo><mrow id="S2.SS2.p1.8.m8.2.3.3.1.3" xref="S2.SS2.p1.8.m8.2.3.3.1.3.cmml"><mi id="S2.SS2.p1.8.m8.2.3.3.1.3.2" xref="S2.SS2.p1.8.m8.2.3.3.1.3.2.cmml">c</mi><mo id="S2.SS2.p1.8.m8.2.3.3.1.3.1" xref="S2.SS2.p1.8.m8.2.3.3.1.3.1.cmml">∈</mo><msup id="S2.SS2.p1.8.m8.2.3.3.1.3.3" xref="S2.SS2.p1.8.m8.2.3.3.1.3.3.cmml"><mi id="S2.SS2.p1.8.m8.2.3.3.1.3.3.2" xref="S2.SS2.p1.8.m8.2.3.3.1.3.3.2.cmml">C</mi><mi id="S2.SS2.p1.8.m8.2.3.3.1.3.3.3" xref="S2.SS2.p1.8.m8.2.3.3.1.3.3.3.cmml">t</mi></msup></mrow></msub><mrow id="S2.SS2.p1.8.m8.2.3.3.2" xref="S2.SS2.p1.8.m8.2.3.3.2.cmml"><mfrac id="S2.SS2.p1.8.m8.2.2" xref="S2.SS2.p1.8.m8.2.2.cmml"><mrow id="S2.SS2.p1.8.m8.1.1.1.1" xref="S2.SS2.p1.8.m8.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS2.p1.8.m8.1.1.1.1.2" xref="S2.SS2.p1.8.m8.1.1.1.2.1.cmml">|</mo><msub id="S2.SS2.p1.8.m8.1.1.1.1.1" xref="S2.SS2.p1.8.m8.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.8.m8.1.1.1.1.1.2" xref="S2.SS2.p1.8.m8.1.1.1.1.1.2.cmml">D</mi><mi id="S2.SS2.p1.8.m8.1.1.1.1.1.3" xref="S2.SS2.p1.8.m8.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S2.SS2.p1.8.m8.1.1.1.1.3" xref="S2.SS2.p1.8.m8.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S2.SS2.p1.8.m8.2.2.2" xref="S2.SS2.p1.8.m8.2.2.2.cmml"><mstyle displaystyle="false" id="S2.SS2.p1.8.m8.2.2.2.2" xref="S2.SS2.p1.8.m8.2.2.2.2.cmml"><msub id="S2.SS2.p1.8.m8.2.2.2.2a" xref="S2.SS2.p1.8.m8.2.2.2.2.cmml"><mo id="S2.SS2.p1.8.m8.2.2.2.2.2" xref="S2.SS2.p1.8.m8.2.2.2.2.2.cmml">∑</mo><mrow id="S2.SS2.p1.8.m8.2.2.2.2.3" xref="S2.SS2.p1.8.m8.2.2.2.2.3.cmml"><mi id="S2.SS2.p1.8.m8.2.2.2.2.3.2" xref="S2.SS2.p1.8.m8.2.2.2.2.3.2.cmml">i</mi><mo id="S2.SS2.p1.8.m8.2.2.2.2.3.1" xref="S2.SS2.p1.8.m8.2.2.2.2.3.1.cmml">∈</mo><msup id="S2.SS2.p1.8.m8.2.2.2.2.3.3" xref="S2.SS2.p1.8.m8.2.2.2.2.3.3.cmml"><mi id="S2.SS2.p1.8.m8.2.2.2.2.3.3.2" xref="S2.SS2.p1.8.m8.2.2.2.2.3.3.2.cmml">C</mi><mi id="S2.SS2.p1.8.m8.2.2.2.2.3.3.3" xref="S2.SS2.p1.8.m8.2.2.2.2.3.3.3.cmml">t</mi></msup></mrow></msub></mstyle><mrow id="S2.SS2.p1.8.m8.2.2.2.1.1" xref="S2.SS2.p1.8.m8.2.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS2.p1.8.m8.2.2.2.1.1.2" xref="S2.SS2.p1.8.m8.2.2.2.1.2.1.cmml">|</mo><msub id="S2.SS2.p1.8.m8.2.2.2.1.1.1" xref="S2.SS2.p1.8.m8.2.2.2.1.1.1.cmml"><mi id="S2.SS2.p1.8.m8.2.2.2.1.1.1.2" xref="S2.SS2.p1.8.m8.2.2.2.1.1.1.2.cmml">D</mi><mi id="S2.SS2.p1.8.m8.2.2.2.1.1.1.3" xref="S2.SS2.p1.8.m8.2.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS2.p1.8.m8.2.2.2.1.1.3" xref="S2.SS2.p1.8.m8.2.2.2.1.2.1.cmml">|</mo></mrow></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.SS2.p1.8.m8.2.3.3.2.1" xref="S2.SS2.p1.8.m8.2.3.3.2.1.cmml">​</mo><msubsup id="S2.SS2.p1.8.m8.2.3.3.2.2" xref="S2.SS2.p1.8.m8.2.3.3.2.2.cmml"><mi id="S2.SS2.p1.8.m8.2.3.3.2.2.2.2" xref="S2.SS2.p1.8.m8.2.3.3.2.2.2.2.cmml">θ</mi><mi id="S2.SS2.p1.8.m8.2.3.3.2.2.2.3" xref="S2.SS2.p1.8.m8.2.3.3.2.2.2.3.cmml">c</mi><mrow id="S2.SS2.p1.8.m8.2.3.3.2.2.3" xref="S2.SS2.p1.8.m8.2.3.3.2.2.3.cmml"><mi id="S2.SS2.p1.8.m8.2.3.3.2.2.3.2" xref="S2.SS2.p1.8.m8.2.3.3.2.2.3.2.cmml">t</mi><mo id="S2.SS2.p1.8.m8.2.3.3.2.2.3.1" xref="S2.SS2.p1.8.m8.2.3.3.2.2.3.1.cmml">+</mo><mn id="S2.SS2.p1.8.m8.2.3.3.2.2.3.3" xref="S2.SS2.p1.8.m8.2.3.3.2.2.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.2b"><apply id="S2.SS2.p1.8.m8.2.3.cmml" xref="S2.SS2.p1.8.m8.2.3"><ci id="S2.SS2.p1.8.m8.2.3.1.cmml" xref="S2.SS2.p1.8.m8.2.3.1">←</ci><apply id="S2.SS2.p1.8.m8.2.3.2.cmml" xref="S2.SS2.p1.8.m8.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.2.3.2.1.cmml" xref="S2.SS2.p1.8.m8.2.3.2">superscript</csymbol><ci id="S2.SS2.p1.8.m8.2.3.2.2.cmml" xref="S2.SS2.p1.8.m8.2.3.2.2">𝜃</ci><apply id="S2.SS2.p1.8.m8.2.3.2.3.cmml" xref="S2.SS2.p1.8.m8.2.3.2.3"><plus id="S2.SS2.p1.8.m8.2.3.2.3.1.cmml" xref="S2.SS2.p1.8.m8.2.3.2.3.1"></plus><ci id="S2.SS2.p1.8.m8.2.3.2.3.2.cmml" xref="S2.SS2.p1.8.m8.2.3.2.3.2">𝑡</ci><cn type="integer" id="S2.SS2.p1.8.m8.2.3.2.3.3.cmml" xref="S2.SS2.p1.8.m8.2.3.2.3.3">1</cn></apply></apply><apply id="S2.SS2.p1.8.m8.2.3.3.cmml" xref="S2.SS2.p1.8.m8.2.3.3"><apply id="S2.SS2.p1.8.m8.2.3.3.1.cmml" xref="S2.SS2.p1.8.m8.2.3.3.1"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.2.3.3.1.1.cmml" xref="S2.SS2.p1.8.m8.2.3.3.1">subscript</csymbol><sum id="S2.SS2.p1.8.m8.2.3.3.1.2.cmml" xref="S2.SS2.p1.8.m8.2.3.3.1.2"></sum><apply id="S2.SS2.p1.8.m8.2.3.3.1.3.cmml" xref="S2.SS2.p1.8.m8.2.3.3.1.3"><in id="S2.SS2.p1.8.m8.2.3.3.1.3.1.cmml" xref="S2.SS2.p1.8.m8.2.3.3.1.3.1"></in><ci id="S2.SS2.p1.8.m8.2.3.3.1.3.2.cmml" xref="S2.SS2.p1.8.m8.2.3.3.1.3.2">𝑐</ci><apply id="S2.SS2.p1.8.m8.2.3.3.1.3.3.cmml" xref="S2.SS2.p1.8.m8.2.3.3.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.2.3.3.1.3.3.1.cmml" xref="S2.SS2.p1.8.m8.2.3.3.1.3.3">superscript</csymbol><ci id="S2.SS2.p1.8.m8.2.3.3.1.3.3.2.cmml" xref="S2.SS2.p1.8.m8.2.3.3.1.3.3.2">𝐶</ci><ci id="S2.SS2.p1.8.m8.2.3.3.1.3.3.3.cmml" xref="S2.SS2.p1.8.m8.2.3.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S2.SS2.p1.8.m8.2.3.3.2.cmml" xref="S2.SS2.p1.8.m8.2.3.3.2"><times id="S2.SS2.p1.8.m8.2.3.3.2.1.cmml" xref="S2.SS2.p1.8.m8.2.3.3.2.1"></times><apply id="S2.SS2.p1.8.m8.2.2.cmml" xref="S2.SS2.p1.8.m8.2.2"><divide id="S2.SS2.p1.8.m8.2.2.3.cmml" xref="S2.SS2.p1.8.m8.2.2"></divide><apply id="S2.SS2.p1.8.m8.1.1.1.2.cmml" xref="S2.SS2.p1.8.m8.1.1.1.1"><abs id="S2.SS2.p1.8.m8.1.1.1.2.1.cmml" xref="S2.SS2.p1.8.m8.1.1.1.1.2"></abs><apply id="S2.SS2.p1.8.m8.1.1.1.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.8.m8.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.8.m8.1.1.1.1.1.2">𝐷</ci><ci id="S2.SS2.p1.8.m8.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.8.m8.1.1.1.1.1.3">𝑐</ci></apply></apply><apply id="S2.SS2.p1.8.m8.2.2.2.cmml" xref="S2.SS2.p1.8.m8.2.2.2"><apply id="S2.SS2.p1.8.m8.2.2.2.2.cmml" xref="S2.SS2.p1.8.m8.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.2.2.2.2.1.cmml" xref="S2.SS2.p1.8.m8.2.2.2.2">subscript</csymbol><sum id="S2.SS2.p1.8.m8.2.2.2.2.2.cmml" xref="S2.SS2.p1.8.m8.2.2.2.2.2"></sum><apply id="S2.SS2.p1.8.m8.2.2.2.2.3.cmml" xref="S2.SS2.p1.8.m8.2.2.2.2.3"><in id="S2.SS2.p1.8.m8.2.2.2.2.3.1.cmml" xref="S2.SS2.p1.8.m8.2.2.2.2.3.1"></in><ci id="S2.SS2.p1.8.m8.2.2.2.2.3.2.cmml" xref="S2.SS2.p1.8.m8.2.2.2.2.3.2">𝑖</ci><apply id="S2.SS2.p1.8.m8.2.2.2.2.3.3.cmml" xref="S2.SS2.p1.8.m8.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.2.2.2.2.3.3.1.cmml" xref="S2.SS2.p1.8.m8.2.2.2.2.3.3">superscript</csymbol><ci id="S2.SS2.p1.8.m8.2.2.2.2.3.3.2.cmml" xref="S2.SS2.p1.8.m8.2.2.2.2.3.3.2">𝐶</ci><ci id="S2.SS2.p1.8.m8.2.2.2.2.3.3.3.cmml" xref="S2.SS2.p1.8.m8.2.2.2.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="S2.SS2.p1.8.m8.2.2.2.1.2.cmml" xref="S2.SS2.p1.8.m8.2.2.2.1.1"><abs id="S2.SS2.p1.8.m8.2.2.2.1.2.1.cmml" xref="S2.SS2.p1.8.m8.2.2.2.1.1.2"></abs><apply id="S2.SS2.p1.8.m8.2.2.2.1.1.1.cmml" xref="S2.SS2.p1.8.m8.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.2.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.8.m8.2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.8.m8.2.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.8.m8.2.2.2.1.1.1.2">𝐷</ci><ci id="S2.SS2.p1.8.m8.2.2.2.1.1.1.3.cmml" xref="S2.SS2.p1.8.m8.2.2.2.1.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="S2.SS2.p1.8.m8.2.3.3.2.2.cmml" xref="S2.SS2.p1.8.m8.2.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.2.3.3.2.2.1.cmml" xref="S2.SS2.p1.8.m8.2.3.3.2.2">superscript</csymbol><apply id="S2.SS2.p1.8.m8.2.3.3.2.2.2.cmml" xref="S2.SS2.p1.8.m8.2.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.2.3.3.2.2.2.1.cmml" xref="S2.SS2.p1.8.m8.2.3.3.2.2">subscript</csymbol><ci id="S2.SS2.p1.8.m8.2.3.3.2.2.2.2.cmml" xref="S2.SS2.p1.8.m8.2.3.3.2.2.2.2">𝜃</ci><ci id="S2.SS2.p1.8.m8.2.3.3.2.2.2.3.cmml" xref="S2.SS2.p1.8.m8.2.3.3.2.2.2.3">𝑐</ci></apply><apply id="S2.SS2.p1.8.m8.2.3.3.2.2.3.cmml" xref="S2.SS2.p1.8.m8.2.3.3.2.2.3"><plus id="S2.SS2.p1.8.m8.2.3.3.2.2.3.1.cmml" xref="S2.SS2.p1.8.m8.2.3.3.2.2.3.1"></plus><ci id="S2.SS2.p1.8.m8.2.3.3.2.2.3.2.cmml" xref="S2.SS2.p1.8.m8.2.3.3.2.2.3.2">𝑡</ci><cn type="integer" id="S2.SS2.p1.8.m8.2.3.3.2.2.3.3.cmml" xref="S2.SS2.p1.8.m8.2.3.3.2.2.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.2c">\theta^{t+1}\leftarrow\sum_{c\in C^{t}}\frac{|D_{c}|}{\sum_{i\in C^{t}}|D_{i}|}{\theta_{c}^{t+1}}</annotation></semantics></math>.
This learning process continues until convergence.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">The problem with these FL works is that they assume the devices have ground-truth labels for all the data. However, this assumption is not realistic in dermatological disease diagnosis due to the high labeling cost and the requirement of expertise for accurate labeling.
Therefore, to apply FL to dermatological disease diagnosis, one approach to effectively use limited labels to achieve high model accuracy is needed.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Overview of Federated Contrastive Learning</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">The overview of the proposed federated contrastive learning (FCL) framework is shown in Fig. <a href="#S2.F2" title="Figure 2 ‣ II Background and Related Work ‣ Federated Contrastive Learning for Dermatological Disease Diagnosis via On-device Learning This work was supported in part by NSF CNS-2122320." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
This framework has two stages.
In the first stage, the model is collaboratively pre-trained by distributed devices on unlabeled data to extract visual representations.
During learning, there is a server and many devices. The server is used to coordinate the learning process, aggregate the locally updated models and forward the shared features.
The devices perform CL on local data as well as local and remote features to update local models.
In the second stage, the model pre-trained in the first stage is used as the initialization for fine-tuning with limited labels. This can be achieved by existing supervised learning methods independently on each device, or collaboratively by supervised federated learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>.
In the rest of this paper, we focus on the first stage of FCL on unlabeled data for pre-training.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">To achieve better contrastive learning on each device, one can share raw data (i.e. skin images) with other devices to improve the data diversity for local learning. However, since skin images are highly sensitive and private, sharing them will cause serious privacy concerns for patients.
To improve data diversity while keeping raw data local for privacy, we proposed to share features (i.e. encoded vectors).
As shown in Fig. <a href="#S2.F2" title="Figure 2 ‣ II Background and Related Work ‣ Federated Contrastive Learning for Dermatological Disease Diagnosis via On-device Learning This work was supported in part by NSF CNS-2122320." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, FCL is performed round-by-round.
In one round, each device encodes its data as local features and uploads them to the server. Local models are also uploaded for model aggregation.
Then, the server de-identifies the uploaded features and sends these anonymous features to devices as remote features.
The uploaded models are aggregated by averaging the weights of all models following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, which serves as the initial model for the next round.
After that, the aggregated model and the remote features are downloaded to devices.
The local models on devices are updated by leveraging both local and remote features on each device, which provides more accurate and diverse contrastive information for computing the local contrastive loss.
Finally, the updated local models and features are uploaded to the server to initialize the next round.
This iterative learning process continues until the model convergence.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Contrastive Learning with Remote and Local Features</span>
</h2>

<figure id="S4.F3" class="ltx_figure"><img src="/html/2202.07470/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="392" height="183" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S4.F3.3.2" class="ltx_text" style="font-size:90%;">
Local contrastive learning with shared features on one device in FCL. The remote features from other devices serve as negatives to improve the data diversity for better-learned representations.
During learning, the features of local positives are pushed close to each other and apart from the remote negatives.
</span></figcaption>
</figure>
<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we will present how to perform contrastive learning on each device with both local and remote features in each round of FCL, by which a good initialization for fine-tuning can be learned.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.5.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.6.2" class="ltx_text ltx_font_italic">Local Model Architecture</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">The local contrastive learning process on a device is shown in Fig. <a href="#S4.F3" title="Figure 3 ‣ IV Contrastive Learning with Remote and Local Features ‣ Federated Contrastive Learning for Dermatological Disease Diagnosis via On-device Learning This work was supported in part by NSF CNS-2122320." class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
We use the Momentum Contrast (MoCo) model architecture <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> since it uses a separate memory bank to store negative features, which can be filled with both local and remote negatives in the FCL setting.
Other popular contrastive learning models such as SimCLR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> uses features of data in the same mini-batch as negatives, which tightly couples the negative features with the mini-batch data and is not suitable to leverage remote features in FCL.
Different from SimCLR, MoCo decouples the negative features with the mini-batch data by an independent memory bank and can leverage the remote features as negatives for local contrastive learning.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">On each device,
there are two models, the main model and the momentum model, and they have different functions.
The main model is the target model for learning and will be used as the initialization for the fine-tuning in the second stage.
The momentum model is used to generate features for local contrastive learning as local negatives and for sharing as remote features.
The generated features will be stored in the memory bank of local features.
In the learning process, the main model is updated by the contrastive loss, and the momentum model is updated as the exponential moving average of the main model with a momentum coefficient.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.5.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.6.2" class="ltx_text ltx_font_italic">Memory Banks of Local and Remote Features</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.4" class="ltx_p">To perform contrastive learning on each device,
the memory banks of local features and remote features need to be constructed such that they can provide features for computing the local loss.
Each device has a memory bank of local features and a memory bank of remote features.
Local features are generated by feeding local images to the momentum model to produce the feature vectors.
The feature vectors are then stored in the memory bank of local features.
On device <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">i</annotation></semantics></math>, let <math id="S4.SS2.p1.2.m2.2" class="ltx_Math" alttext="Q_{l,i}" display="inline"><semantics id="S4.SS2.p1.2.m2.2a"><msub id="S4.SS2.p1.2.m2.2.3" xref="S4.SS2.p1.2.m2.2.3.cmml"><mi id="S4.SS2.p1.2.m2.2.3.2" xref="S4.SS2.p1.2.m2.2.3.2.cmml">Q</mi><mrow id="S4.SS2.p1.2.m2.2.2.2.4" xref="S4.SS2.p1.2.m2.2.2.2.3.cmml"><mi id="S4.SS2.p1.2.m2.1.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.1.cmml">l</mi><mo id="S4.SS2.p1.2.m2.2.2.2.4.1" xref="S4.SS2.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p1.2.m2.2.2.2.2" xref="S4.SS2.p1.2.m2.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.2b"><apply id="S4.SS2.p1.2.m2.2.3.cmml" xref="S4.SS2.p1.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.2.3.1.cmml" xref="S4.SS2.p1.2.m2.2.3">subscript</csymbol><ci id="S4.SS2.p1.2.m2.2.3.2.cmml" xref="S4.SS2.p1.2.m2.2.3.2">𝑄</ci><list id="S4.SS2.p1.2.m2.2.2.2.3.cmml" xref="S4.SS2.p1.2.m2.2.2.2.4"><ci id="S4.SS2.p1.2.m2.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1">𝑙</ci><ci id="S4.SS2.p1.2.m2.2.2.2.2.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.2c">Q_{l,i}</annotation></semantics></math> be the memory bank of local features with <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">K</annotation></semantics></math> features stored. <math id="S4.SS2.p1.4.m4.2" class="ltx_Math" alttext="Q_{l,i}" display="inline"><semantics id="S4.SS2.p1.4.m4.2a"><msub id="S4.SS2.p1.4.m4.2.3" xref="S4.SS2.p1.4.m4.2.3.cmml"><mi id="S4.SS2.p1.4.m4.2.3.2" xref="S4.SS2.p1.4.m4.2.3.2.cmml">Q</mi><mrow id="S4.SS2.p1.4.m4.2.2.2.4" xref="S4.SS2.p1.4.m4.2.2.2.3.cmml"><mi id="S4.SS2.p1.4.m4.1.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.1.cmml">l</mi><mo id="S4.SS2.p1.4.m4.2.2.2.4.1" xref="S4.SS2.p1.4.m4.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p1.4.m4.2.2.2.2" xref="S4.SS2.p1.4.m4.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.2b"><apply id="S4.SS2.p1.4.m4.2.3.cmml" xref="S4.SS2.p1.4.m4.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.2.3.1.cmml" xref="S4.SS2.p1.4.m4.2.3">subscript</csymbol><ci id="S4.SS2.p1.4.m4.2.3.2.cmml" xref="S4.SS2.p1.4.m4.2.3.2">𝑄</ci><list id="S4.SS2.p1.4.m4.2.2.2.3.cmml" xref="S4.SS2.p1.4.m4.2.2.2.4"><ci id="S4.SS2.p1.4.m4.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1">𝑙</ci><ci id="S4.SS2.p1.4.m4.2.2.2.2.cmml" xref="S4.SS2.p1.4.m4.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.2c">Q_{l,i}</annotation></semantics></math> is used as local negatives and maintained following a first-in-first-out principle. The oldest features in the local memory bank will be dropped when new features are generated.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.2" class="ltx_p">The remote features are collected from other clients.
At the beginning of each round of FCL, the local features are uploaded to the server and the remote features will be downloaded to fill the memory bank of remote features. More specially, the memory bank of remote features <math id="S4.SS2.p2.1.m1.2" class="ltx_Math" alttext="Q_{r,i}" display="inline"><semantics id="S4.SS2.p2.1.m1.2a"><msub id="S4.SS2.p2.1.m1.2.3" xref="S4.SS2.p2.1.m1.2.3.cmml"><mi id="S4.SS2.p2.1.m1.2.3.2" xref="S4.SS2.p2.1.m1.2.3.2.cmml">Q</mi><mrow id="S4.SS2.p2.1.m1.2.2.2.4" xref="S4.SS2.p2.1.m1.2.2.2.3.cmml"><mi id="S4.SS2.p2.1.m1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.cmml">r</mi><mo id="S4.SS2.p2.1.m1.2.2.2.4.1" xref="S4.SS2.p2.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.1.m1.2.2.2.2" xref="S4.SS2.p2.1.m1.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.2b"><apply id="S4.SS2.p2.1.m1.2.3.cmml" xref="S4.SS2.p2.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.2.3.1.cmml" xref="S4.SS2.p2.1.m1.2.3">subscript</csymbol><ci id="S4.SS2.p2.1.m1.2.3.2.cmml" xref="S4.SS2.p2.1.m1.2.3.2">𝑄</ci><list id="S4.SS2.p2.1.m1.2.2.2.3.cmml" xref="S4.SS2.p2.1.m1.2.2.2.4"><ci id="S4.SS2.p2.1.m1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1">𝑟</ci><ci id="S4.SS2.p2.1.m1.2.2.2.2.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.2c">Q_{r,i}</annotation></semantics></math> on device <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">i</annotation></semantics></math> is filled as follows.</p>
<table id="S4.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E2.m1.6" class="ltx_Math" alttext="Q_{r,i}=\{Q_{l,c}\ |\ 1\leq c\leq|C|,c\neq i\}." display="block"><semantics id="S4.E2.m1.6a"><mrow id="S4.E2.m1.6.6.1" xref="S4.E2.m1.6.6.1.1.cmml"><mrow id="S4.E2.m1.6.6.1.1" xref="S4.E2.m1.6.6.1.1.cmml"><msub id="S4.E2.m1.6.6.1.1.4" xref="S4.E2.m1.6.6.1.1.4.cmml"><mi id="S4.E2.m1.6.6.1.1.4.2" xref="S4.E2.m1.6.6.1.1.4.2.cmml">Q</mi><mrow id="S4.E2.m1.2.2.2.4" xref="S4.E2.m1.2.2.2.3.cmml"><mi id="S4.E2.m1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml">r</mi><mo id="S4.E2.m1.2.2.2.4.1" xref="S4.E2.m1.2.2.2.3.cmml">,</mo><mi id="S4.E2.m1.2.2.2.2" xref="S4.E2.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S4.E2.m1.6.6.1.1.3" xref="S4.E2.m1.6.6.1.1.3.cmml">=</mo><mrow id="S4.E2.m1.6.6.1.1.2.2" xref="S4.E2.m1.6.6.1.1.2.3.cmml"><mo stretchy="false" id="S4.E2.m1.6.6.1.1.2.2.3" xref="S4.E2.m1.6.6.1.1.2.3.1.cmml">{</mo><msub id="S4.E2.m1.6.6.1.1.1.1.1" xref="S4.E2.m1.6.6.1.1.1.1.1.cmml"><mi id="S4.E2.m1.6.6.1.1.1.1.1.2" xref="S4.E2.m1.6.6.1.1.1.1.1.2.cmml">Q</mi><mrow id="S4.E2.m1.4.4.2.4" xref="S4.E2.m1.4.4.2.3.cmml"><mi id="S4.E2.m1.3.3.1.1" xref="S4.E2.m1.3.3.1.1.cmml">l</mi><mo id="S4.E2.m1.4.4.2.4.1" xref="S4.E2.m1.4.4.2.3.cmml">,</mo><mi id="S4.E2.m1.4.4.2.2" xref="S4.E2.m1.4.4.2.2.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.6.6.1.1.2.2.4" xref="S4.E2.m1.6.6.1.1.2.3.1.cmml">|</mo><mrow id="S4.E2.m1.6.6.1.1.2.2.2.2" xref="S4.E2.m1.6.6.1.1.2.2.2.3.cmml"><mrow id="S4.E2.m1.6.6.1.1.2.2.2.1.1" xref="S4.E2.m1.6.6.1.1.2.2.2.1.1.cmml"><mn id="S4.E2.m1.6.6.1.1.2.2.2.1.1.2" xref="S4.E2.m1.6.6.1.1.2.2.2.1.1.2.cmml"> 1</mn><mo id="S4.E2.m1.6.6.1.1.2.2.2.1.1.3" xref="S4.E2.m1.6.6.1.1.2.2.2.1.1.3.cmml">≤</mo><mi id="S4.E2.m1.6.6.1.1.2.2.2.1.1.4" xref="S4.E2.m1.6.6.1.1.2.2.2.1.1.4.cmml">c</mi><mo id="S4.E2.m1.6.6.1.1.2.2.2.1.1.5" xref="S4.E2.m1.6.6.1.1.2.2.2.1.1.5.cmml">≤</mo><mrow id="S4.E2.m1.6.6.1.1.2.2.2.1.1.6.2" xref="S4.E2.m1.6.6.1.1.2.2.2.1.1.6.1.cmml"><mo stretchy="false" id="S4.E2.m1.6.6.1.1.2.2.2.1.1.6.2.1" xref="S4.E2.m1.6.6.1.1.2.2.2.1.1.6.1.1.cmml">|</mo><mi id="S4.E2.m1.5.5" xref="S4.E2.m1.5.5.cmml">C</mi><mo stretchy="false" id="S4.E2.m1.6.6.1.1.2.2.2.1.1.6.2.2" xref="S4.E2.m1.6.6.1.1.2.2.2.1.1.6.1.1.cmml">|</mo></mrow></mrow><mo id="S4.E2.m1.6.6.1.1.2.2.2.2.3" xref="S4.E2.m1.6.6.1.1.2.2.2.3a.cmml">,</mo><mrow id="S4.E2.m1.6.6.1.1.2.2.2.2.2" xref="S4.E2.m1.6.6.1.1.2.2.2.2.2.cmml"><mi id="S4.E2.m1.6.6.1.1.2.2.2.2.2.2" xref="S4.E2.m1.6.6.1.1.2.2.2.2.2.2.cmml">c</mi><mo id="S4.E2.m1.6.6.1.1.2.2.2.2.2.1" xref="S4.E2.m1.6.6.1.1.2.2.2.2.2.1.cmml">≠</mo><mi id="S4.E2.m1.6.6.1.1.2.2.2.2.2.3" xref="S4.E2.m1.6.6.1.1.2.2.2.2.2.3.cmml">i</mi></mrow></mrow><mo stretchy="false" id="S4.E2.m1.6.6.1.1.2.2.5" xref="S4.E2.m1.6.6.1.1.2.3.1.cmml">}</mo></mrow></mrow><mo lspace="0em" id="S4.E2.m1.6.6.1.2" xref="S4.E2.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.6b"><apply id="S4.E2.m1.6.6.1.1.cmml" xref="S4.E2.m1.6.6.1"><eq id="S4.E2.m1.6.6.1.1.3.cmml" xref="S4.E2.m1.6.6.1.1.3"></eq><apply id="S4.E2.m1.6.6.1.1.4.cmml" xref="S4.E2.m1.6.6.1.1.4"><csymbol cd="ambiguous" id="S4.E2.m1.6.6.1.1.4.1.cmml" xref="S4.E2.m1.6.6.1.1.4">subscript</csymbol><ci id="S4.E2.m1.6.6.1.1.4.2.cmml" xref="S4.E2.m1.6.6.1.1.4.2">𝑄</ci><list id="S4.E2.m1.2.2.2.3.cmml" xref="S4.E2.m1.2.2.2.4"><ci id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1">𝑟</ci><ci id="S4.E2.m1.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.2">𝑖</ci></list></apply><apply id="S4.E2.m1.6.6.1.1.2.3.cmml" xref="S4.E2.m1.6.6.1.1.2.2"><csymbol cd="latexml" id="S4.E2.m1.6.6.1.1.2.3.1.cmml" xref="S4.E2.m1.6.6.1.1.2.2.3">conditional-set</csymbol><apply id="S4.E2.m1.6.6.1.1.1.1.1.cmml" xref="S4.E2.m1.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.6.6.1.1.1.1.1.1.cmml" xref="S4.E2.m1.6.6.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.6.6.1.1.1.1.1.2.cmml" xref="S4.E2.m1.6.6.1.1.1.1.1.2">𝑄</ci><list id="S4.E2.m1.4.4.2.3.cmml" xref="S4.E2.m1.4.4.2.4"><ci id="S4.E2.m1.3.3.1.1.cmml" xref="S4.E2.m1.3.3.1.1">𝑙</ci><ci id="S4.E2.m1.4.4.2.2.cmml" xref="S4.E2.m1.4.4.2.2">𝑐</ci></list></apply><apply id="S4.E2.m1.6.6.1.1.2.2.2.3.cmml" xref="S4.E2.m1.6.6.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.6.6.1.1.2.2.2.3a.cmml" xref="S4.E2.m1.6.6.1.1.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E2.m1.6.6.1.1.2.2.2.1.1.cmml" xref="S4.E2.m1.6.6.1.1.2.2.2.1.1"><and id="S4.E2.m1.6.6.1.1.2.2.2.1.1a.cmml" xref="S4.E2.m1.6.6.1.1.2.2.2.1.1"></and><apply id="S4.E2.m1.6.6.1.1.2.2.2.1.1b.cmml" xref="S4.E2.m1.6.6.1.1.2.2.2.1.1"><leq id="S4.E2.m1.6.6.1.1.2.2.2.1.1.3.cmml" xref="S4.E2.m1.6.6.1.1.2.2.2.1.1.3"></leq><cn type="integer" id="S4.E2.m1.6.6.1.1.2.2.2.1.1.2.cmml" xref="S4.E2.m1.6.6.1.1.2.2.2.1.1.2">1</cn><ci id="S4.E2.m1.6.6.1.1.2.2.2.1.1.4.cmml" xref="S4.E2.m1.6.6.1.1.2.2.2.1.1.4">𝑐</ci></apply><apply id="S4.E2.m1.6.6.1.1.2.2.2.1.1c.cmml" xref="S4.E2.m1.6.6.1.1.2.2.2.1.1"><leq id="S4.E2.m1.6.6.1.1.2.2.2.1.1.5.cmml" xref="S4.E2.m1.6.6.1.1.2.2.2.1.1.5"></leq><share href="#S4.E2.m1.6.6.1.1.2.2.2.1.1.4.cmml" id="S4.E2.m1.6.6.1.1.2.2.2.1.1d.cmml" xref="S4.E2.m1.6.6.1.1.2.2.2.1.1"></share><apply id="S4.E2.m1.6.6.1.1.2.2.2.1.1.6.1.cmml" xref="S4.E2.m1.6.6.1.1.2.2.2.1.1.6.2"><abs id="S4.E2.m1.6.6.1.1.2.2.2.1.1.6.1.1.cmml" xref="S4.E2.m1.6.6.1.1.2.2.2.1.1.6.2.1"></abs><ci id="S4.E2.m1.5.5.cmml" xref="S4.E2.m1.5.5">𝐶</ci></apply></apply></apply><apply id="S4.E2.m1.6.6.1.1.2.2.2.2.2.cmml" xref="S4.E2.m1.6.6.1.1.2.2.2.2.2"><neq id="S4.E2.m1.6.6.1.1.2.2.2.2.2.1.cmml" xref="S4.E2.m1.6.6.1.1.2.2.2.2.2.1"></neq><ci id="S4.E2.m1.6.6.1.1.2.2.2.2.2.2.cmml" xref="S4.E2.m1.6.6.1.1.2.2.2.2.2.2">𝑐</ci><ci id="S4.E2.m1.6.6.1.1.2.2.2.2.2.3.cmml" xref="S4.E2.m1.6.6.1.1.2.2.2.2.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.6c">Q_{r,i}=\{Q_{l,c}\ |\ 1\leq c\leq|C|,c\neq i\}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p2.3" class="ltx_p">where <math id="S4.SS2.p2.3.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS2.p2.3.m1.1a"><mi id="S4.SS2.p2.3.m1.1.1" xref="S4.SS2.p2.3.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m1.1b"><ci id="S4.SS2.p2.3.m1.1.1.cmml" xref="S4.SS2.p2.3.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m1.1c">C</annotation></semantics></math> is the set of all devices.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.5.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.6.2" class="ltx_text ltx_font_italic">Learning with Remote Features</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.p1.5" class="ltx_p"><span id="S4.SS3.p1.5.1" class="ltx_text ltx_font_bold">Constructing negatives from memory banks for local learning.</span>
By leveraging memory banks of local features <math id="S4.SS3.p1.1.m1.2" class="ltx_Math" alttext="Q_{l,i}" display="inline"><semantics id="S4.SS3.p1.1.m1.2a"><msub id="S4.SS3.p1.1.m1.2.3" xref="S4.SS3.p1.1.m1.2.3.cmml"><mi id="S4.SS3.p1.1.m1.2.3.2" xref="S4.SS3.p1.1.m1.2.3.2.cmml">Q</mi><mrow id="S4.SS3.p1.1.m1.2.2.2.4" xref="S4.SS3.p1.1.m1.2.2.2.3.cmml"><mi id="S4.SS3.p1.1.m1.1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.1.cmml">l</mi><mo id="S4.SS3.p1.1.m1.2.2.2.4.1" xref="S4.SS3.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p1.1.m1.2.2.2.2" xref="S4.SS3.p1.1.m1.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.2b"><apply id="S4.SS3.p1.1.m1.2.3.cmml" xref="S4.SS3.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.2.3.1.cmml" xref="S4.SS3.p1.1.m1.2.3">subscript</csymbol><ci id="S4.SS3.p1.1.m1.2.3.2.cmml" xref="S4.SS3.p1.1.m1.2.3.2">𝑄</ci><list id="S4.SS3.p1.1.m1.2.2.2.3.cmml" xref="S4.SS3.p1.1.m1.2.2.2.4"><ci id="S4.SS3.p1.1.m1.1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1.1">𝑙</ci><ci id="S4.SS3.p1.1.m1.2.2.2.2.cmml" xref="S4.SS3.p1.1.m1.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.2c">Q_{l,i}</annotation></semantics></math> and remote features <math id="S4.SS3.p1.2.m2.2" class="ltx_Math" alttext="Q_{r,i}" display="inline"><semantics id="S4.SS3.p1.2.m2.2a"><msub id="S4.SS3.p1.2.m2.2.3" xref="S4.SS3.p1.2.m2.2.3.cmml"><mi id="S4.SS3.p1.2.m2.2.3.2" xref="S4.SS3.p1.2.m2.2.3.2.cmml">Q</mi><mrow id="S4.SS3.p1.2.m2.2.2.2.4" xref="S4.SS3.p1.2.m2.2.2.2.3.cmml"><mi id="S4.SS3.p1.2.m2.1.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.1.cmml">r</mi><mo id="S4.SS3.p1.2.m2.2.2.2.4.1" xref="S4.SS3.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p1.2.m2.2.2.2.2" xref="S4.SS3.p1.2.m2.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.2b"><apply id="S4.SS3.p1.2.m2.2.3.cmml" xref="S4.SS3.p1.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.2.3.1.cmml" xref="S4.SS3.p1.2.m2.2.3">subscript</csymbol><ci id="S4.SS3.p1.2.m2.2.3.2.cmml" xref="S4.SS3.p1.2.m2.2.3.2">𝑄</ci><list id="S4.SS3.p1.2.m2.2.2.2.3.cmml" xref="S4.SS3.p1.2.m2.2.2.2.4"><ci id="S4.SS3.p1.2.m2.1.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1">𝑟</ci><ci id="S4.SS3.p1.2.m2.2.2.2.2.cmml" xref="S4.SS3.p1.2.m2.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.2c">Q_{r,i}</annotation></semantics></math>, the negatives <math id="S4.SS3.p1.3.m3.2" class="ltx_Math" alttext="Q_{\text{CL},i}" display="inline"><semantics id="S4.SS3.p1.3.m3.2a"><msub id="S4.SS3.p1.3.m3.2.3" xref="S4.SS3.p1.3.m3.2.3.cmml"><mi id="S4.SS3.p1.3.m3.2.3.2" xref="S4.SS3.p1.3.m3.2.3.2.cmml">Q</mi><mrow id="S4.SS3.p1.3.m3.2.2.2.4" xref="S4.SS3.p1.3.m3.2.2.2.3.cmml"><mtext id="S4.SS3.p1.3.m3.1.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.1a.cmml">CL</mtext><mo id="S4.SS3.p1.3.m3.2.2.2.4.1" xref="S4.SS3.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p1.3.m3.2.2.2.2" xref="S4.SS3.p1.3.m3.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.2b"><apply id="S4.SS3.p1.3.m3.2.3.cmml" xref="S4.SS3.p1.3.m3.2.3"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.2.3.1.cmml" xref="S4.SS3.p1.3.m3.2.3">subscript</csymbol><ci id="S4.SS3.p1.3.m3.2.3.2.cmml" xref="S4.SS3.p1.3.m3.2.3.2">𝑄</ci><list id="S4.SS3.p1.3.m3.2.2.2.3.cmml" xref="S4.SS3.p1.3.m3.2.2.2.4"><ci id="S4.SS3.p1.3.m3.1.1.1.1a.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1"><mtext mathsize="70%" id="S4.SS3.p1.3.m3.1.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1">CL</mtext></ci><ci id="S4.SS3.p1.3.m3.2.2.2.2.cmml" xref="S4.SS3.p1.3.m3.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.2c">Q_{\text{CL},i}</annotation></semantics></math> for computing the contrastive loss is constructed as follows.
For conciseness, we leave out the device index <math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><mi id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><ci id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">i</annotation></semantics></math> in <math id="S4.SS3.p1.5.m5.2" class="ltx_Math" alttext="Q_{\text{CL},i}" display="inline"><semantics id="S4.SS3.p1.5.m5.2a"><msub id="S4.SS3.p1.5.m5.2.3" xref="S4.SS3.p1.5.m5.2.3.cmml"><mi id="S4.SS3.p1.5.m5.2.3.2" xref="S4.SS3.p1.5.m5.2.3.2.cmml">Q</mi><mrow id="S4.SS3.p1.5.m5.2.2.2.4" xref="S4.SS3.p1.5.m5.2.2.2.3.cmml"><mtext id="S4.SS3.p1.5.m5.1.1.1.1" xref="S4.SS3.p1.5.m5.1.1.1.1a.cmml">CL</mtext><mo id="S4.SS3.p1.5.m5.2.2.2.4.1" xref="S4.SS3.p1.5.m5.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p1.5.m5.2.2.2.2" xref="S4.SS3.p1.5.m5.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.2b"><apply id="S4.SS3.p1.5.m5.2.3.cmml" xref="S4.SS3.p1.5.m5.2.3"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m5.2.3.1.cmml" xref="S4.SS3.p1.5.m5.2.3">subscript</csymbol><ci id="S4.SS3.p1.5.m5.2.3.2.cmml" xref="S4.SS3.p1.5.m5.2.3.2">𝑄</ci><list id="S4.SS3.p1.5.m5.2.2.2.3.cmml" xref="S4.SS3.p1.5.m5.2.2.2.4"><ci id="S4.SS3.p1.5.m5.1.1.1.1a.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1"><mtext mathsize="70%" id="S4.SS3.p1.5.m5.1.1.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1">CL</mtext></ci><ci id="S4.SS3.p1.5.m5.2.2.2.2.cmml" xref="S4.SS3.p1.5.m5.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.2c">Q_{\text{CL},i}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.8" class="ltx_p">On device <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">i</annotation></semantics></math>,
at the beginning of each round of FCL, <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="Q_{\text{CL}}" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><msub id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mi id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml">Q</mi><mtext id="S4.SS3.p2.2.m2.1.1.3" xref="S4.SS3.p2.2.m2.1.1.3a.cmml">CL</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2">𝑄</ci><ci id="S4.SS3.p2.2.m2.1.1.3a.cmml" xref="S4.SS3.p2.2.m2.1.1.3"><mtext mathsize="70%" id="S4.SS3.p2.2.m2.1.1.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3">CL</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">Q_{\text{CL}}</annotation></semantics></math> is initialized as the memory bank of local features <math id="S4.SS3.p2.3.m3.2" class="ltx_Math" alttext="Q_{l,i}" display="inline"><semantics id="S4.SS3.p2.3.m3.2a"><msub id="S4.SS3.p2.3.m3.2.3" xref="S4.SS3.p2.3.m3.2.3.cmml"><mi id="S4.SS3.p2.3.m3.2.3.2" xref="S4.SS3.p2.3.m3.2.3.2.cmml">Q</mi><mrow id="S4.SS3.p2.3.m3.2.2.2.4" xref="S4.SS3.p2.3.m3.2.2.2.3.cmml"><mi id="S4.SS3.p2.3.m3.1.1.1.1" xref="S4.SS3.p2.3.m3.1.1.1.1.cmml">l</mi><mo id="S4.SS3.p2.3.m3.2.2.2.4.1" xref="S4.SS3.p2.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.3.m3.2.2.2.2" xref="S4.SS3.p2.3.m3.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.2b"><apply id="S4.SS3.p2.3.m3.2.3.cmml" xref="S4.SS3.p2.3.m3.2.3"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.2.3.1.cmml" xref="S4.SS3.p2.3.m3.2.3">subscript</csymbol><ci id="S4.SS3.p2.3.m3.2.3.2.cmml" xref="S4.SS3.p2.3.m3.2.3.2">𝑄</ci><list id="S4.SS3.p2.3.m3.2.2.2.3.cmml" xref="S4.SS3.p2.3.m3.2.2.2.4"><ci id="S4.SS3.p2.3.m3.1.1.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1.1.1">𝑙</ci><ci id="S4.SS3.p2.3.m3.2.2.2.2.cmml" xref="S4.SS3.p2.3.m3.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.2c">Q_{l,i}</annotation></semantics></math>.
During each mini-batch of local learning, a mini-batch data <math id="S4.SS3.p2.4.m4.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS3.p2.4.m4.1a"><mi id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><ci id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">x</annotation></semantics></math> of size <math id="S4.SS3.p2.5.m5.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS3.p2.5.m5.1a"><mi id="S4.SS3.p2.5.m5.1.1" xref="S4.SS3.p2.5.m5.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m5.1b"><ci id="S4.SS3.p2.5.m5.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m5.1c">B</annotation></semantics></math> is fed into the momentum model to generate the features <math id="S4.SS3.p2.6.m6.3" class="ltx_Math" alttext="q_{l,i,B}" display="inline"><semantics id="S4.SS3.p2.6.m6.3a"><msub id="S4.SS3.p2.6.m6.3.4" xref="S4.SS3.p2.6.m6.3.4.cmml"><mi id="S4.SS3.p2.6.m6.3.4.2" xref="S4.SS3.p2.6.m6.3.4.2.cmml">q</mi><mrow id="S4.SS3.p2.6.m6.3.3.3.5" xref="S4.SS3.p2.6.m6.3.3.3.4.cmml"><mi id="S4.SS3.p2.6.m6.1.1.1.1" xref="S4.SS3.p2.6.m6.1.1.1.1.cmml">l</mi><mo id="S4.SS3.p2.6.m6.3.3.3.5.1" xref="S4.SS3.p2.6.m6.3.3.3.4.cmml">,</mo><mi id="S4.SS3.p2.6.m6.2.2.2.2" xref="S4.SS3.p2.6.m6.2.2.2.2.cmml">i</mi><mo id="S4.SS3.p2.6.m6.3.3.3.5.2" xref="S4.SS3.p2.6.m6.3.3.3.4.cmml">,</mo><mi id="S4.SS3.p2.6.m6.3.3.3.3" xref="S4.SS3.p2.6.m6.3.3.3.3.cmml">B</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m6.3b"><apply id="S4.SS3.p2.6.m6.3.4.cmml" xref="S4.SS3.p2.6.m6.3.4"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m6.3.4.1.cmml" xref="S4.SS3.p2.6.m6.3.4">subscript</csymbol><ci id="S4.SS3.p2.6.m6.3.4.2.cmml" xref="S4.SS3.p2.6.m6.3.4.2">𝑞</ci><list id="S4.SS3.p2.6.m6.3.3.3.4.cmml" xref="S4.SS3.p2.6.m6.3.3.3.5"><ci id="S4.SS3.p2.6.m6.1.1.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1.1.1">𝑙</ci><ci id="S4.SS3.p2.6.m6.2.2.2.2.cmml" xref="S4.SS3.p2.6.m6.2.2.2.2">𝑖</ci><ci id="S4.SS3.p2.6.m6.3.3.3.3.cmml" xref="S4.SS3.p2.6.m6.3.3.3.3">𝐵</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m6.3c">q_{l,i,B}</annotation></semantics></math>. Then <math id="S4.SS3.p2.7.m7.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS3.p2.7.m7.1a"><mi id="S4.SS3.p2.7.m7.1.1" xref="S4.SS3.p2.7.m7.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m7.1b"><ci id="S4.SS3.p2.7.m7.1.1.cmml" xref="S4.SS3.p2.7.m7.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m7.1c">B</annotation></semantics></math> remote features are sampled uniformly from remote features <math id="S4.SS3.p2.8.m8.2" class="ltx_Math" alttext="Q_{r,i}" display="inline"><semantics id="S4.SS3.p2.8.m8.2a"><msub id="S4.SS3.p2.8.m8.2.3" xref="S4.SS3.p2.8.m8.2.3.cmml"><mi id="S4.SS3.p2.8.m8.2.3.2" xref="S4.SS3.p2.8.m8.2.3.2.cmml">Q</mi><mrow id="S4.SS3.p2.8.m8.2.2.2.4" xref="S4.SS3.p2.8.m8.2.2.2.3.cmml"><mi id="S4.SS3.p2.8.m8.1.1.1.1" xref="S4.SS3.p2.8.m8.1.1.1.1.cmml">r</mi><mo id="S4.SS3.p2.8.m8.2.2.2.4.1" xref="S4.SS3.p2.8.m8.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.8.m8.2.2.2.2" xref="S4.SS3.p2.8.m8.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.8.m8.2b"><apply id="S4.SS3.p2.8.m8.2.3.cmml" xref="S4.SS3.p2.8.m8.2.3"><csymbol cd="ambiguous" id="S4.SS3.p2.8.m8.2.3.1.cmml" xref="S4.SS3.p2.8.m8.2.3">subscript</csymbol><ci id="S4.SS3.p2.8.m8.2.3.2.cmml" xref="S4.SS3.p2.8.m8.2.3.2">𝑄</ci><list id="S4.SS3.p2.8.m8.2.2.2.3.cmml" xref="S4.SS3.p2.8.m8.2.2.2.4"><ci id="S4.SS3.p2.8.m8.1.1.1.1.cmml" xref="S4.SS3.p2.8.m8.1.1.1.1">𝑟</ci><ci id="S4.SS3.p2.8.m8.2.2.2.2.cmml" xref="S4.SS3.p2.8.m8.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.8.m8.2c">Q_{r,i}</annotation></semantics></math> as follows.</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.10" class="ltx_Math" alttext="q_{r,i,B}=\{Q_{r,i,j}|\ j\sim\mathcal{U}(|Q_{r,i}|,B)\}." display="block"><semantics id="S4.E3.m1.10a"><mrow id="S4.E3.m1.10.10.1" xref="S4.E3.m1.10.10.1.1.cmml"><mrow id="S4.E3.m1.10.10.1.1" xref="S4.E3.m1.10.10.1.1.cmml"><msub id="S4.E3.m1.10.10.1.1.4" xref="S4.E3.m1.10.10.1.1.4.cmml"><mi id="S4.E3.m1.10.10.1.1.4.2" xref="S4.E3.m1.10.10.1.1.4.2.cmml">q</mi><mrow id="S4.E3.m1.3.3.3.5" xref="S4.E3.m1.3.3.3.4.cmml"><mi id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml">r</mi><mo id="S4.E3.m1.3.3.3.5.1" xref="S4.E3.m1.3.3.3.4.cmml">,</mo><mi id="S4.E3.m1.2.2.2.2" xref="S4.E3.m1.2.2.2.2.cmml">i</mi><mo id="S4.E3.m1.3.3.3.5.2" xref="S4.E3.m1.3.3.3.4.cmml">,</mo><mi id="S4.E3.m1.3.3.3.3" xref="S4.E3.m1.3.3.3.3.cmml">B</mi></mrow></msub><mo id="S4.E3.m1.10.10.1.1.3" xref="S4.E3.m1.10.10.1.1.3.cmml">=</mo><mrow id="S4.E3.m1.10.10.1.1.2.2" xref="S4.E3.m1.10.10.1.1.2.3.cmml"><mo stretchy="false" id="S4.E3.m1.10.10.1.1.2.2.3" xref="S4.E3.m1.10.10.1.1.2.3.1.cmml">{</mo><msub id="S4.E3.m1.10.10.1.1.1.1.1" xref="S4.E3.m1.10.10.1.1.1.1.1.cmml"><mi id="S4.E3.m1.10.10.1.1.1.1.1.2" xref="S4.E3.m1.10.10.1.1.1.1.1.2.cmml">Q</mi><mrow id="S4.E3.m1.6.6.3.5" xref="S4.E3.m1.6.6.3.4.cmml"><mi id="S4.E3.m1.4.4.1.1" xref="S4.E3.m1.4.4.1.1.cmml">r</mi><mo id="S4.E3.m1.6.6.3.5.1" xref="S4.E3.m1.6.6.3.4.cmml">,</mo><mi id="S4.E3.m1.5.5.2.2" xref="S4.E3.m1.5.5.2.2.cmml">i</mi><mo id="S4.E3.m1.6.6.3.5.2" xref="S4.E3.m1.6.6.3.4.cmml">,</mo><mi id="S4.E3.m1.6.6.3.3" xref="S4.E3.m1.6.6.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0.500em" id="S4.E3.m1.10.10.1.1.2.2.4" xref="S4.E3.m1.10.10.1.1.2.3.1.cmml">|</mo><mrow id="S4.E3.m1.10.10.1.1.2.2.2" xref="S4.E3.m1.10.10.1.1.2.2.2.cmml"><mi id="S4.E3.m1.10.10.1.1.2.2.2.3" xref="S4.E3.m1.10.10.1.1.2.2.2.3.cmml">j</mi><mo id="S4.E3.m1.10.10.1.1.2.2.2.2" xref="S4.E3.m1.10.10.1.1.2.2.2.2.cmml">∼</mo><mrow id="S4.E3.m1.10.10.1.1.2.2.2.1" xref="S4.E3.m1.10.10.1.1.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.10.10.1.1.2.2.2.1.3" xref="S4.E3.m1.10.10.1.1.2.2.2.1.3.cmml">𝒰</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.10.10.1.1.2.2.2.1.2" xref="S4.E3.m1.10.10.1.1.2.2.2.1.2.cmml">​</mo><mrow id="S4.E3.m1.10.10.1.1.2.2.2.1.1.1" xref="S4.E3.m1.10.10.1.1.2.2.2.1.1.2.cmml"><mo stretchy="false" id="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.2" xref="S4.E3.m1.10.10.1.1.2.2.2.1.1.2.cmml">(</mo><mrow id="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.1.1" xref="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.1.1.2" xref="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.1.2.1.cmml">|</mo><msub id="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.1.1.1" xref="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.1.1.1.2" xref="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.1.1.1.2.cmml">Q</mi><mrow id="S4.E3.m1.8.8.2.4" xref="S4.E3.m1.8.8.2.3.cmml"><mi id="S4.E3.m1.7.7.1.1" xref="S4.E3.m1.7.7.1.1.cmml">r</mi><mo id="S4.E3.m1.8.8.2.4.1" xref="S4.E3.m1.8.8.2.3.cmml">,</mo><mi id="S4.E3.m1.8.8.2.2" xref="S4.E3.m1.8.8.2.2.cmml">i</mi></mrow></msub><mo stretchy="false" id="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.1.1.3" xref="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.3" xref="S4.E3.m1.10.10.1.1.2.2.2.1.1.2.cmml">,</mo><mi id="S4.E3.m1.9.9" xref="S4.E3.m1.9.9.cmml">B</mi><mo stretchy="false" id="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.4" xref="S4.E3.m1.10.10.1.1.2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.E3.m1.10.10.1.1.2.2.5" xref="S4.E3.m1.10.10.1.1.2.3.1.cmml">}</mo></mrow></mrow><mo lspace="0em" id="S4.E3.m1.10.10.1.2" xref="S4.E3.m1.10.10.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.10b"><apply id="S4.E3.m1.10.10.1.1.cmml" xref="S4.E3.m1.10.10.1"><eq id="S4.E3.m1.10.10.1.1.3.cmml" xref="S4.E3.m1.10.10.1.1.3"></eq><apply id="S4.E3.m1.10.10.1.1.4.cmml" xref="S4.E3.m1.10.10.1.1.4"><csymbol cd="ambiguous" id="S4.E3.m1.10.10.1.1.4.1.cmml" xref="S4.E3.m1.10.10.1.1.4">subscript</csymbol><ci id="S4.E3.m1.10.10.1.1.4.2.cmml" xref="S4.E3.m1.10.10.1.1.4.2">𝑞</ci><list id="S4.E3.m1.3.3.3.4.cmml" xref="S4.E3.m1.3.3.3.5"><ci id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1">𝑟</ci><ci id="S4.E3.m1.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2">𝑖</ci><ci id="S4.E3.m1.3.3.3.3.cmml" xref="S4.E3.m1.3.3.3.3">𝐵</ci></list></apply><apply id="S4.E3.m1.10.10.1.1.2.3.cmml" xref="S4.E3.m1.10.10.1.1.2.2"><csymbol cd="latexml" id="S4.E3.m1.10.10.1.1.2.3.1.cmml" xref="S4.E3.m1.10.10.1.1.2.2.3">conditional-set</csymbol><apply id="S4.E3.m1.10.10.1.1.1.1.1.cmml" xref="S4.E3.m1.10.10.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.10.10.1.1.1.1.1.1.cmml" xref="S4.E3.m1.10.10.1.1.1.1.1">subscript</csymbol><ci id="S4.E3.m1.10.10.1.1.1.1.1.2.cmml" xref="S4.E3.m1.10.10.1.1.1.1.1.2">𝑄</ci><list id="S4.E3.m1.6.6.3.4.cmml" xref="S4.E3.m1.6.6.3.5"><ci id="S4.E3.m1.4.4.1.1.cmml" xref="S4.E3.m1.4.4.1.1">𝑟</ci><ci id="S4.E3.m1.5.5.2.2.cmml" xref="S4.E3.m1.5.5.2.2">𝑖</ci><ci id="S4.E3.m1.6.6.3.3.cmml" xref="S4.E3.m1.6.6.3.3">𝑗</ci></list></apply><apply id="S4.E3.m1.10.10.1.1.2.2.2.cmml" xref="S4.E3.m1.10.10.1.1.2.2.2"><csymbol cd="latexml" id="S4.E3.m1.10.10.1.1.2.2.2.2.cmml" xref="S4.E3.m1.10.10.1.1.2.2.2.2">similar-to</csymbol><ci id="S4.E3.m1.10.10.1.1.2.2.2.3.cmml" xref="S4.E3.m1.10.10.1.1.2.2.2.3">𝑗</ci><apply id="S4.E3.m1.10.10.1.1.2.2.2.1.cmml" xref="S4.E3.m1.10.10.1.1.2.2.2.1"><times id="S4.E3.m1.10.10.1.1.2.2.2.1.2.cmml" xref="S4.E3.m1.10.10.1.1.2.2.2.1.2"></times><ci id="S4.E3.m1.10.10.1.1.2.2.2.1.3.cmml" xref="S4.E3.m1.10.10.1.1.2.2.2.1.3">𝒰</ci><interval closure="open" id="S4.E3.m1.10.10.1.1.2.2.2.1.1.2.cmml" xref="S4.E3.m1.10.10.1.1.2.2.2.1.1.1"><apply id="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.1.2.cmml" xref="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.1.1"><abs id="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.1.2.1.cmml" xref="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.1.1.2"></abs><apply id="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.10.10.1.1.2.2.2.1.1.1.1.1.1.2">𝑄</ci><list id="S4.E3.m1.8.8.2.3.cmml" xref="S4.E3.m1.8.8.2.4"><ci id="S4.E3.m1.7.7.1.1.cmml" xref="S4.E3.m1.7.7.1.1">𝑟</ci><ci id="S4.E3.m1.8.8.2.2.cmml" xref="S4.E3.m1.8.8.2.2">𝑖</ci></list></apply></apply><ci id="S4.E3.m1.9.9.cmml" xref="S4.E3.m1.9.9">𝐵</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.10c">q_{r,i,B}=\{Q_{r,i,j}|\ j\sim\mathcal{U}(|Q_{r,i}|,B)\}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p2.15" class="ltx_p">where <math id="S4.SS3.p2.9.m1.4" class="ltx_Math" alttext="j\sim\mathcal{U}(|Q_{r,i}|,B)" display="inline"><semantics id="S4.SS3.p2.9.m1.4a"><mrow id="S4.SS3.p2.9.m1.4.4" xref="S4.SS3.p2.9.m1.4.4.cmml"><mi id="S4.SS3.p2.9.m1.4.4.3" xref="S4.SS3.p2.9.m1.4.4.3.cmml">j</mi><mo id="S4.SS3.p2.9.m1.4.4.2" xref="S4.SS3.p2.9.m1.4.4.2.cmml">∼</mo><mrow id="S4.SS3.p2.9.m1.4.4.1" xref="S4.SS3.p2.9.m1.4.4.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.9.m1.4.4.1.3" xref="S4.SS3.p2.9.m1.4.4.1.3.cmml">𝒰</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.9.m1.4.4.1.2" xref="S4.SS3.p2.9.m1.4.4.1.2.cmml">​</mo><mrow id="S4.SS3.p2.9.m1.4.4.1.1.1" xref="S4.SS3.p2.9.m1.4.4.1.1.2.cmml"><mo stretchy="false" id="S4.SS3.p2.9.m1.4.4.1.1.1.2" xref="S4.SS3.p2.9.m1.4.4.1.1.2.cmml">(</mo><mrow id="S4.SS3.p2.9.m1.4.4.1.1.1.1.1" xref="S4.SS3.p2.9.m1.4.4.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS3.p2.9.m1.4.4.1.1.1.1.1.2" xref="S4.SS3.p2.9.m1.4.4.1.1.1.1.2.1.cmml">|</mo><msub id="S4.SS3.p2.9.m1.4.4.1.1.1.1.1.1" xref="S4.SS3.p2.9.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p2.9.m1.4.4.1.1.1.1.1.1.2" xref="S4.SS3.p2.9.m1.4.4.1.1.1.1.1.1.2.cmml">Q</mi><mrow id="S4.SS3.p2.9.m1.2.2.2.4" xref="S4.SS3.p2.9.m1.2.2.2.3.cmml"><mi id="S4.SS3.p2.9.m1.1.1.1.1" xref="S4.SS3.p2.9.m1.1.1.1.1.cmml">r</mi><mo id="S4.SS3.p2.9.m1.2.2.2.4.1" xref="S4.SS3.p2.9.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.9.m1.2.2.2.2" xref="S4.SS3.p2.9.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo stretchy="false" id="S4.SS3.p2.9.m1.4.4.1.1.1.1.1.3" xref="S4.SS3.p2.9.m1.4.4.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.SS3.p2.9.m1.4.4.1.1.1.3" xref="S4.SS3.p2.9.m1.4.4.1.1.2.cmml">,</mo><mi id="S4.SS3.p2.9.m1.3.3" xref="S4.SS3.p2.9.m1.3.3.cmml">B</mi><mo stretchy="false" id="S4.SS3.p2.9.m1.4.4.1.1.1.4" xref="S4.SS3.p2.9.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.9.m1.4b"><apply id="S4.SS3.p2.9.m1.4.4.cmml" xref="S4.SS3.p2.9.m1.4.4"><csymbol cd="latexml" id="S4.SS3.p2.9.m1.4.4.2.cmml" xref="S4.SS3.p2.9.m1.4.4.2">similar-to</csymbol><ci id="S4.SS3.p2.9.m1.4.4.3.cmml" xref="S4.SS3.p2.9.m1.4.4.3">𝑗</ci><apply id="S4.SS3.p2.9.m1.4.4.1.cmml" xref="S4.SS3.p2.9.m1.4.4.1"><times id="S4.SS3.p2.9.m1.4.4.1.2.cmml" xref="S4.SS3.p2.9.m1.4.4.1.2"></times><ci id="S4.SS3.p2.9.m1.4.4.1.3.cmml" xref="S4.SS3.p2.9.m1.4.4.1.3">𝒰</ci><interval closure="open" id="S4.SS3.p2.9.m1.4.4.1.1.2.cmml" xref="S4.SS3.p2.9.m1.4.4.1.1.1"><apply id="S4.SS3.p2.9.m1.4.4.1.1.1.1.2.cmml" xref="S4.SS3.p2.9.m1.4.4.1.1.1.1.1"><abs id="S4.SS3.p2.9.m1.4.4.1.1.1.1.2.1.cmml" xref="S4.SS3.p2.9.m1.4.4.1.1.1.1.1.2"></abs><apply id="S4.SS3.p2.9.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.SS3.p2.9.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.9.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p2.9.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p2.9.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p2.9.m1.4.4.1.1.1.1.1.1.2">𝑄</ci><list id="S4.SS3.p2.9.m1.2.2.2.3.cmml" xref="S4.SS3.p2.9.m1.2.2.2.4"><ci id="S4.SS3.p2.9.m1.1.1.1.1.cmml" xref="S4.SS3.p2.9.m1.1.1.1.1">𝑟</ci><ci id="S4.SS3.p2.9.m1.2.2.2.2.cmml" xref="S4.SS3.p2.9.m1.2.2.2.2">𝑖</ci></list></apply></apply><ci id="S4.SS3.p2.9.m1.3.3.cmml" xref="S4.SS3.p2.9.m1.3.3">𝐵</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.9.m1.4c">j\sim\mathcal{U}(|Q_{r,i}|,B)</annotation></semantics></math> means
<math id="S4.SS3.p2.10.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS3.p2.10.m2.1a"><mi id="S4.SS3.p2.10.m2.1.1" xref="S4.SS3.p2.10.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.10.m2.1b"><ci id="S4.SS3.p2.10.m2.1.1.cmml" xref="S4.SS3.p2.10.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.10.m2.1c">B</annotation></semantics></math> indices are sampled uniformly from the range <math id="S4.SS3.p2.11.m3.4" class="ltx_Math" alttext="[0,|Q_{r,i}|-1]" display="inline"><semantics id="S4.SS3.p2.11.m3.4a"><mrow id="S4.SS3.p2.11.m3.4.4.1" xref="S4.SS3.p2.11.m3.4.4.2.cmml"><mo stretchy="false" id="S4.SS3.p2.11.m3.4.4.1.2" xref="S4.SS3.p2.11.m3.4.4.2.cmml">[</mo><mn id="S4.SS3.p2.11.m3.3.3" xref="S4.SS3.p2.11.m3.3.3.cmml">0</mn><mo id="S4.SS3.p2.11.m3.4.4.1.3" xref="S4.SS3.p2.11.m3.4.4.2.cmml">,</mo><mrow id="S4.SS3.p2.11.m3.4.4.1.1" xref="S4.SS3.p2.11.m3.4.4.1.1.cmml"><mrow id="S4.SS3.p2.11.m3.4.4.1.1.1.1" xref="S4.SS3.p2.11.m3.4.4.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS3.p2.11.m3.4.4.1.1.1.1.2" xref="S4.SS3.p2.11.m3.4.4.1.1.1.2.1.cmml">|</mo><msub id="S4.SS3.p2.11.m3.4.4.1.1.1.1.1" xref="S4.SS3.p2.11.m3.4.4.1.1.1.1.1.cmml"><mi id="S4.SS3.p2.11.m3.4.4.1.1.1.1.1.2" xref="S4.SS3.p2.11.m3.4.4.1.1.1.1.1.2.cmml">Q</mi><mrow id="S4.SS3.p2.11.m3.2.2.2.4" xref="S4.SS3.p2.11.m3.2.2.2.3.cmml"><mi id="S4.SS3.p2.11.m3.1.1.1.1" xref="S4.SS3.p2.11.m3.1.1.1.1.cmml">r</mi><mo id="S4.SS3.p2.11.m3.2.2.2.4.1" xref="S4.SS3.p2.11.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.11.m3.2.2.2.2" xref="S4.SS3.p2.11.m3.2.2.2.2.cmml">i</mi></mrow></msub><mo stretchy="false" id="S4.SS3.p2.11.m3.4.4.1.1.1.1.3" xref="S4.SS3.p2.11.m3.4.4.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.SS3.p2.11.m3.4.4.1.1.2" xref="S4.SS3.p2.11.m3.4.4.1.1.2.cmml">−</mo><mn id="S4.SS3.p2.11.m3.4.4.1.1.3" xref="S4.SS3.p2.11.m3.4.4.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS3.p2.11.m3.4.4.1.4" xref="S4.SS3.p2.11.m3.4.4.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.11.m3.4b"><interval closure="closed" id="S4.SS3.p2.11.m3.4.4.2.cmml" xref="S4.SS3.p2.11.m3.4.4.1"><cn type="integer" id="S4.SS3.p2.11.m3.3.3.cmml" xref="S4.SS3.p2.11.m3.3.3">0</cn><apply id="S4.SS3.p2.11.m3.4.4.1.1.cmml" xref="S4.SS3.p2.11.m3.4.4.1.1"><minus id="S4.SS3.p2.11.m3.4.4.1.1.2.cmml" xref="S4.SS3.p2.11.m3.4.4.1.1.2"></minus><apply id="S4.SS3.p2.11.m3.4.4.1.1.1.2.cmml" xref="S4.SS3.p2.11.m3.4.4.1.1.1.1"><abs id="S4.SS3.p2.11.m3.4.4.1.1.1.2.1.cmml" xref="S4.SS3.p2.11.m3.4.4.1.1.1.1.2"></abs><apply id="S4.SS3.p2.11.m3.4.4.1.1.1.1.1.cmml" xref="S4.SS3.p2.11.m3.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.11.m3.4.4.1.1.1.1.1.1.cmml" xref="S4.SS3.p2.11.m3.4.4.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p2.11.m3.4.4.1.1.1.1.1.2.cmml" xref="S4.SS3.p2.11.m3.4.4.1.1.1.1.1.2">𝑄</ci><list id="S4.SS3.p2.11.m3.2.2.2.3.cmml" xref="S4.SS3.p2.11.m3.2.2.2.4"><ci id="S4.SS3.p2.11.m3.1.1.1.1.cmml" xref="S4.SS3.p2.11.m3.1.1.1.1">𝑟</ci><ci id="S4.SS3.p2.11.m3.2.2.2.2.cmml" xref="S4.SS3.p2.11.m3.2.2.2.2">𝑖</ci></list></apply></apply><cn type="integer" id="S4.SS3.p2.11.m3.4.4.1.1.3.cmml" xref="S4.SS3.p2.11.m3.4.4.1.1.3">1</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.11.m3.4c">[0,|Q_{r,i}|-1]</annotation></semantics></math> and <math id="S4.SS3.p2.12.m4.3" class="ltx_Math" alttext="Q_{r,i,j}" display="inline"><semantics id="S4.SS3.p2.12.m4.3a"><msub id="S4.SS3.p2.12.m4.3.4" xref="S4.SS3.p2.12.m4.3.4.cmml"><mi id="S4.SS3.p2.12.m4.3.4.2" xref="S4.SS3.p2.12.m4.3.4.2.cmml">Q</mi><mrow id="S4.SS3.p2.12.m4.3.3.3.5" xref="S4.SS3.p2.12.m4.3.3.3.4.cmml"><mi id="S4.SS3.p2.12.m4.1.1.1.1" xref="S4.SS3.p2.12.m4.1.1.1.1.cmml">r</mi><mo id="S4.SS3.p2.12.m4.3.3.3.5.1" xref="S4.SS3.p2.12.m4.3.3.3.4.cmml">,</mo><mi id="S4.SS3.p2.12.m4.2.2.2.2" xref="S4.SS3.p2.12.m4.2.2.2.2.cmml">i</mi><mo id="S4.SS3.p2.12.m4.3.3.3.5.2" xref="S4.SS3.p2.12.m4.3.3.3.4.cmml">,</mo><mi id="S4.SS3.p2.12.m4.3.3.3.3" xref="S4.SS3.p2.12.m4.3.3.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.12.m4.3b"><apply id="S4.SS3.p2.12.m4.3.4.cmml" xref="S4.SS3.p2.12.m4.3.4"><csymbol cd="ambiguous" id="S4.SS3.p2.12.m4.3.4.1.cmml" xref="S4.SS3.p2.12.m4.3.4">subscript</csymbol><ci id="S4.SS3.p2.12.m4.3.4.2.cmml" xref="S4.SS3.p2.12.m4.3.4.2">𝑄</ci><list id="S4.SS3.p2.12.m4.3.3.3.4.cmml" xref="S4.SS3.p2.12.m4.3.3.3.5"><ci id="S4.SS3.p2.12.m4.1.1.1.1.cmml" xref="S4.SS3.p2.12.m4.1.1.1.1">𝑟</ci><ci id="S4.SS3.p2.12.m4.2.2.2.2.cmml" xref="S4.SS3.p2.12.m4.2.2.2.2">𝑖</ci><ci id="S4.SS3.p2.12.m4.3.3.3.3.cmml" xref="S4.SS3.p2.12.m4.3.3.3.3">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.12.m4.3c">Q_{r,i,j}</annotation></semantics></math> is the <math id="S4.SS3.p2.13.m5.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS3.p2.13.m5.1a"><mi id="S4.SS3.p2.13.m5.1.1" xref="S4.SS3.p2.13.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.13.m5.1b"><ci id="S4.SS3.p2.13.m5.1.1.cmml" xref="S4.SS3.p2.13.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.13.m5.1c">j</annotation></semantics></math>-<math id="S4.SS3.p2.14.m6.1" class="ltx_Math" alttext="th" display="inline"><semantics id="S4.SS3.p2.14.m6.1a"><mrow id="S4.SS3.p2.14.m6.1.1" xref="S4.SS3.p2.14.m6.1.1.cmml"><mi id="S4.SS3.p2.14.m6.1.1.2" xref="S4.SS3.p2.14.m6.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.14.m6.1.1.1" xref="S4.SS3.p2.14.m6.1.1.1.cmml">​</mo><mi id="S4.SS3.p2.14.m6.1.1.3" xref="S4.SS3.p2.14.m6.1.1.3.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.14.m6.1b"><apply id="S4.SS3.p2.14.m6.1.1.cmml" xref="S4.SS3.p2.14.m6.1.1"><times id="S4.SS3.p2.14.m6.1.1.1.cmml" xref="S4.SS3.p2.14.m6.1.1.1"></times><ci id="S4.SS3.p2.14.m6.1.1.2.cmml" xref="S4.SS3.p2.14.m6.1.1.2">𝑡</ci><ci id="S4.SS3.p2.14.m6.1.1.3.cmml" xref="S4.SS3.p2.14.m6.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.14.m6.1c">th</annotation></semantics></math> feature in <math id="S4.SS3.p2.15.m7.2" class="ltx_Math" alttext="Q_{r,i}" display="inline"><semantics id="S4.SS3.p2.15.m7.2a"><msub id="S4.SS3.p2.15.m7.2.3" xref="S4.SS3.p2.15.m7.2.3.cmml"><mi id="S4.SS3.p2.15.m7.2.3.2" xref="S4.SS3.p2.15.m7.2.3.2.cmml">Q</mi><mrow id="S4.SS3.p2.15.m7.2.2.2.4" xref="S4.SS3.p2.15.m7.2.2.2.3.cmml"><mi id="S4.SS3.p2.15.m7.1.1.1.1" xref="S4.SS3.p2.15.m7.1.1.1.1.cmml">r</mi><mo id="S4.SS3.p2.15.m7.2.2.2.4.1" xref="S4.SS3.p2.15.m7.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.15.m7.2.2.2.2" xref="S4.SS3.p2.15.m7.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.15.m7.2b"><apply id="S4.SS3.p2.15.m7.2.3.cmml" xref="S4.SS3.p2.15.m7.2.3"><csymbol cd="ambiguous" id="S4.SS3.p2.15.m7.2.3.1.cmml" xref="S4.SS3.p2.15.m7.2.3">subscript</csymbol><ci id="S4.SS3.p2.15.m7.2.3.2.cmml" xref="S4.SS3.p2.15.m7.2.3.2">𝑄</ci><list id="S4.SS3.p2.15.m7.2.2.2.3.cmml" xref="S4.SS3.p2.15.m7.2.2.2.4"><ci id="S4.SS3.p2.15.m7.1.1.1.1.cmml" xref="S4.SS3.p2.15.m7.1.1.1.1">𝑟</ci><ci id="S4.SS3.p2.15.m7.2.2.2.2.cmml" xref="S4.SS3.p2.15.m7.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.15.m7.2c">Q_{r,i}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.2" class="ltx_p">After learning a mini-batch, the oldest features in <math id="S4.SS3.p3.1.m1.1" class="ltx_Math" alttext="Q_{\text{CL}}" display="inline"><semantics id="S4.SS3.p3.1.m1.1a"><msub id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml"><mi id="S4.SS3.p3.1.m1.1.1.2" xref="S4.SS3.p3.1.m1.1.1.2.cmml">Q</mi><mtext id="S4.SS3.p3.1.m1.1.1.3" xref="S4.SS3.p3.1.m1.1.1.3a.cmml">CL</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><apply id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p3.1.m1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1.2">𝑄</ci><ci id="S4.SS3.p3.1.m1.1.1.3a.cmml" xref="S4.SS3.p3.1.m1.1.1.3"><mtext mathsize="70%" id="S4.SS3.p3.1.m1.1.1.3.cmml" xref="S4.SS3.p3.1.m1.1.1.3">CL</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">Q_{\text{CL}}</annotation></semantics></math> will be replaced by the latest features <math id="S4.SS3.p3.2.m2.1" class="ltx_Math" alttext="q_{\text{update}}" display="inline"><semantics id="S4.SS3.p3.2.m2.1a"><msub id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml"><mi id="S4.SS3.p3.2.m2.1.1.2" xref="S4.SS3.p3.2.m2.1.1.2.cmml">q</mi><mtext id="S4.SS3.p3.2.m2.1.1.3" xref="S4.SS3.p3.2.m2.1.1.3a.cmml">update</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><apply id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p3.2.m2.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2">𝑞</ci><ci id="S4.SS3.p3.2.m2.1.1.3a.cmml" xref="S4.SS3.p3.2.m2.1.1.3"><mtext mathsize="70%" id="S4.SS3.p3.2.m2.1.1.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3">update</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">q_{\text{update}}</annotation></semantics></math>, which are constructed as follows.</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.7" class="ltx_Math" alttext="q_{\text{update}}=\{q_{l,i,B}\cup q_{r,i,B}\}." display="block"><semantics id="S4.E4.m1.7a"><mrow id="S4.E4.m1.7.7.1" xref="S4.E4.m1.7.7.1.1.cmml"><mrow id="S4.E4.m1.7.7.1.1" xref="S4.E4.m1.7.7.1.1.cmml"><msub id="S4.E4.m1.7.7.1.1.3" xref="S4.E4.m1.7.7.1.1.3.cmml"><mi id="S4.E4.m1.7.7.1.1.3.2" xref="S4.E4.m1.7.7.1.1.3.2.cmml">q</mi><mtext id="S4.E4.m1.7.7.1.1.3.3" xref="S4.E4.m1.7.7.1.1.3.3a.cmml">update</mtext></msub><mo id="S4.E4.m1.7.7.1.1.2" xref="S4.E4.m1.7.7.1.1.2.cmml">=</mo><mrow id="S4.E4.m1.7.7.1.1.1.1" xref="S4.E4.m1.7.7.1.1.1.2.cmml"><mo stretchy="false" id="S4.E4.m1.7.7.1.1.1.1.2" xref="S4.E4.m1.7.7.1.1.1.2.cmml">{</mo><mrow id="S4.E4.m1.7.7.1.1.1.1.1" xref="S4.E4.m1.7.7.1.1.1.1.1.cmml"><msub id="S4.E4.m1.7.7.1.1.1.1.1.2" xref="S4.E4.m1.7.7.1.1.1.1.1.2.cmml"><mi id="S4.E4.m1.7.7.1.1.1.1.1.2.2" xref="S4.E4.m1.7.7.1.1.1.1.1.2.2.cmml">q</mi><mrow id="S4.E4.m1.3.3.3.5" xref="S4.E4.m1.3.3.3.4.cmml"><mi id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml">l</mi><mo id="S4.E4.m1.3.3.3.5.1" xref="S4.E4.m1.3.3.3.4.cmml">,</mo><mi id="S4.E4.m1.2.2.2.2" xref="S4.E4.m1.2.2.2.2.cmml">i</mi><mo id="S4.E4.m1.3.3.3.5.2" xref="S4.E4.m1.3.3.3.4.cmml">,</mo><mi id="S4.E4.m1.3.3.3.3" xref="S4.E4.m1.3.3.3.3.cmml">B</mi></mrow></msub><mo id="S4.E4.m1.7.7.1.1.1.1.1.1" xref="S4.E4.m1.7.7.1.1.1.1.1.1.cmml">∪</mo><msub id="S4.E4.m1.7.7.1.1.1.1.1.3" xref="S4.E4.m1.7.7.1.1.1.1.1.3.cmml"><mi id="S4.E4.m1.7.7.1.1.1.1.1.3.2" xref="S4.E4.m1.7.7.1.1.1.1.1.3.2.cmml">q</mi><mrow id="S4.E4.m1.6.6.3.5" xref="S4.E4.m1.6.6.3.4.cmml"><mi id="S4.E4.m1.4.4.1.1" xref="S4.E4.m1.4.4.1.1.cmml">r</mi><mo id="S4.E4.m1.6.6.3.5.1" xref="S4.E4.m1.6.6.3.4.cmml">,</mo><mi id="S4.E4.m1.5.5.2.2" xref="S4.E4.m1.5.5.2.2.cmml">i</mi><mo id="S4.E4.m1.6.6.3.5.2" xref="S4.E4.m1.6.6.3.4.cmml">,</mo><mi id="S4.E4.m1.6.6.3.3" xref="S4.E4.m1.6.6.3.3.cmml">B</mi></mrow></msub></mrow><mo stretchy="false" id="S4.E4.m1.7.7.1.1.1.1.3" xref="S4.E4.m1.7.7.1.1.1.2.cmml">}</mo></mrow></mrow><mo lspace="0em" id="S4.E4.m1.7.7.1.2" xref="S4.E4.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.7b"><apply id="S4.E4.m1.7.7.1.1.cmml" xref="S4.E4.m1.7.7.1"><eq id="S4.E4.m1.7.7.1.1.2.cmml" xref="S4.E4.m1.7.7.1.1.2"></eq><apply id="S4.E4.m1.7.7.1.1.3.cmml" xref="S4.E4.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.7.7.1.1.3.1.cmml" xref="S4.E4.m1.7.7.1.1.3">subscript</csymbol><ci id="S4.E4.m1.7.7.1.1.3.2.cmml" xref="S4.E4.m1.7.7.1.1.3.2">𝑞</ci><ci id="S4.E4.m1.7.7.1.1.3.3a.cmml" xref="S4.E4.m1.7.7.1.1.3.3"><mtext mathsize="70%" id="S4.E4.m1.7.7.1.1.3.3.cmml" xref="S4.E4.m1.7.7.1.1.3.3">update</mtext></ci></apply><set id="S4.E4.m1.7.7.1.1.1.2.cmml" xref="S4.E4.m1.7.7.1.1.1.1"><apply id="S4.E4.m1.7.7.1.1.1.1.1.cmml" xref="S4.E4.m1.7.7.1.1.1.1.1"><union id="S4.E4.m1.7.7.1.1.1.1.1.1.cmml" xref="S4.E4.m1.7.7.1.1.1.1.1.1"></union><apply id="S4.E4.m1.7.7.1.1.1.1.1.2.cmml" xref="S4.E4.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.7.7.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.7.7.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E4.m1.7.7.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.7.7.1.1.1.1.1.2.2">𝑞</ci><list id="S4.E4.m1.3.3.3.4.cmml" xref="S4.E4.m1.3.3.3.5"><ci id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1">𝑙</ci><ci id="S4.E4.m1.2.2.2.2.cmml" xref="S4.E4.m1.2.2.2.2">𝑖</ci><ci id="S4.E4.m1.3.3.3.3.cmml" xref="S4.E4.m1.3.3.3.3">𝐵</ci></list></apply><apply id="S4.E4.m1.7.7.1.1.1.1.1.3.cmml" xref="S4.E4.m1.7.7.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.7.7.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.7.7.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.7.7.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.7.7.1.1.1.1.1.3.2">𝑞</ci><list id="S4.E4.m1.6.6.3.4.cmml" xref="S4.E4.m1.6.6.3.5"><ci id="S4.E4.m1.4.4.1.1.cmml" xref="S4.E4.m1.4.4.1.1">𝑟</ci><ci id="S4.E4.m1.5.5.2.2.cmml" xref="S4.E4.m1.5.5.2.2">𝑖</ci><ci id="S4.E4.m1.6.6.3.3.cmml" xref="S4.E4.m1.6.6.3.3">𝐵</ci></list></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.7c">q_{\text{update}}=\{q_{l,i,B}\cup q_{r,i,B}\}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS3.p4" class="ltx_para ltx_noindent">
<p id="S4.SS3.p4.2" class="ltx_p"><span id="S4.SS3.p4.2.1" class="ltx_text ltx_font_bold">Removing local negatives for more accurate learning.</span>
While <math id="S4.SS3.p4.1.m1.1" class="ltx_Math" alttext="Q_{\text{CL}}" display="inline"><semantics id="S4.SS3.p4.1.m1.1a"><msub id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml"><mi id="S4.SS3.p4.1.m1.1.1.2" xref="S4.SS3.p4.1.m1.1.1.2.cmml">Q</mi><mtext id="S4.SS3.p4.1.m1.1.1.3" xref="S4.SS3.p4.1.m1.1.1.3a.cmml">CL</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.1b"><apply id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.1.m1.1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p4.1.m1.1.1.2.cmml" xref="S4.SS3.p4.1.m1.1.1.2">𝑄</ci><ci id="S4.SS3.p4.1.m1.1.1.3a.cmml" xref="S4.SS3.p4.1.m1.1.1.3"><mtext mathsize="70%" id="S4.SS3.p4.1.m1.1.1.3.cmml" xref="S4.SS3.p4.1.m1.1.1.3">CL</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.1c">Q_{\text{CL}}</annotation></semantics></math> updated by Eq.(<a href="#S4.E4" title="In IV-C Learning with Remote Features ‣ IV Contrastive Learning with Remote and Local Features ‣ Federated Contrastive Learning for Dermatological Disease Diagnosis via On-device Learning This work was supported in part by NSF CNS-2122320." class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) contains remote features for improved data diversity, <math id="S4.SS3.p4.2.m2.1" class="ltx_Math" alttext="Q_{\text{CL}}" display="inline"><semantics id="S4.SS3.p4.2.m2.1a"><msub id="S4.SS3.p4.2.m2.1.1" xref="S4.SS3.p4.2.m2.1.1.cmml"><mi id="S4.SS3.p4.2.m2.1.1.2" xref="S4.SS3.p4.2.m2.1.1.2.cmml">Q</mi><mtext id="S4.SS3.p4.2.m2.1.1.3" xref="S4.SS3.p4.2.m2.1.1.3a.cmml">CL</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.2.m2.1b"><apply id="S4.SS3.p4.2.m2.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.2.m2.1.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p4.2.m2.1.1.2.cmml" xref="S4.SS3.p4.2.m2.1.1.2">𝑄</ci><ci id="S4.SS3.p4.2.m2.1.1.3a.cmml" xref="S4.SS3.p4.2.m2.1.1.3"><mtext mathsize="70%" id="S4.SS3.p4.2.m2.1.1.3.cmml" xref="S4.SS3.p4.2.m2.1.1.3">CL</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.2.m2.1c">Q_{\text{CL}}</annotation></semantics></math> also contains local features.
For better local learning, we propose to completely avoid using local features as negatives during local learning.
The intuition is that local features can share certain levels of similarity with the data that is being learned because they are from the same patient.
Using local features as negatives can degrade the learned representations since it pushes the representations of the data being learned apart from the local features, which could have been clustered for better representations.</p>
</div>
<div id="S4.SS3.p5" class="ltx_para">
<p id="S4.SS3.p5.4" class="ltx_p">To solve this problem, we eliminate the use of local features during local contrastive learning. At the beginning of each round of FCL, <math id="S4.SS3.p5.1.m1.1" class="ltx_Math" alttext="Q_{\text{CL}}" display="inline"><semantics id="S4.SS3.p5.1.m1.1a"><msub id="S4.SS3.p5.1.m1.1.1" xref="S4.SS3.p5.1.m1.1.1.cmml"><mi id="S4.SS3.p5.1.m1.1.1.2" xref="S4.SS3.p5.1.m1.1.1.2.cmml">Q</mi><mtext id="S4.SS3.p5.1.m1.1.1.3" xref="S4.SS3.p5.1.m1.1.1.3a.cmml">CL</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.1b"><apply id="S4.SS3.p5.1.m1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.1.m1.1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p5.1.m1.1.1.2.cmml" xref="S4.SS3.p5.1.m1.1.1.2">𝑄</ci><ci id="S4.SS3.p5.1.m1.1.1.3a.cmml" xref="S4.SS3.p5.1.m1.1.1.3"><mtext mathsize="70%" id="S4.SS3.p5.1.m1.1.1.3.cmml" xref="S4.SS3.p5.1.m1.1.1.3">CL</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.1c">Q_{\text{CL}}</annotation></semantics></math> is initialized as the memory bank of remote features <math id="S4.SS3.p5.2.m2.2" class="ltx_Math" alttext="Q_{r,i}" display="inline"><semantics id="S4.SS3.p5.2.m2.2a"><msub id="S4.SS3.p5.2.m2.2.3" xref="S4.SS3.p5.2.m2.2.3.cmml"><mi id="S4.SS3.p5.2.m2.2.3.2" xref="S4.SS3.p5.2.m2.2.3.2.cmml">Q</mi><mrow id="S4.SS3.p5.2.m2.2.2.2.4" xref="S4.SS3.p5.2.m2.2.2.2.3.cmml"><mi id="S4.SS3.p5.2.m2.1.1.1.1" xref="S4.SS3.p5.2.m2.1.1.1.1.cmml">r</mi><mo id="S4.SS3.p5.2.m2.2.2.2.4.1" xref="S4.SS3.p5.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p5.2.m2.2.2.2.2" xref="S4.SS3.p5.2.m2.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.2.m2.2b"><apply id="S4.SS3.p5.2.m2.2.3.cmml" xref="S4.SS3.p5.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS3.p5.2.m2.2.3.1.cmml" xref="S4.SS3.p5.2.m2.2.3">subscript</csymbol><ci id="S4.SS3.p5.2.m2.2.3.2.cmml" xref="S4.SS3.p5.2.m2.2.3.2">𝑄</ci><list id="S4.SS3.p5.2.m2.2.2.2.3.cmml" xref="S4.SS3.p5.2.m2.2.2.2.4"><ci id="S4.SS3.p5.2.m2.1.1.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1.1.1">𝑟</ci><ci id="S4.SS3.p5.2.m2.2.2.2.2.cmml" xref="S4.SS3.p5.2.m2.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.2.m2.2c">Q_{r,i}</annotation></semantics></math> in Eq.(<a href="#S4.E2" title="In IV-B Memory Banks of Local and Remote Features ‣ IV Contrastive Learning with Remote and Local Features ‣ Federated Contrastive Learning for Dermatological Disease Diagnosis via On-device Learning This work was supported in part by NSF CNS-2122320." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) instead of <math id="S4.SS3.p5.3.m3.2" class="ltx_Math" alttext="Q_{l,i}" display="inline"><semantics id="S4.SS3.p5.3.m3.2a"><msub id="S4.SS3.p5.3.m3.2.3" xref="S4.SS3.p5.3.m3.2.3.cmml"><mi id="S4.SS3.p5.3.m3.2.3.2" xref="S4.SS3.p5.3.m3.2.3.2.cmml">Q</mi><mrow id="S4.SS3.p5.3.m3.2.2.2.4" xref="S4.SS3.p5.3.m3.2.2.2.3.cmml"><mi id="S4.SS3.p5.3.m3.1.1.1.1" xref="S4.SS3.p5.3.m3.1.1.1.1.cmml">l</mi><mo id="S4.SS3.p5.3.m3.2.2.2.4.1" xref="S4.SS3.p5.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p5.3.m3.2.2.2.2" xref="S4.SS3.p5.3.m3.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.3.m3.2b"><apply id="S4.SS3.p5.3.m3.2.3.cmml" xref="S4.SS3.p5.3.m3.2.3"><csymbol cd="ambiguous" id="S4.SS3.p5.3.m3.2.3.1.cmml" xref="S4.SS3.p5.3.m3.2.3">subscript</csymbol><ci id="S4.SS3.p5.3.m3.2.3.2.cmml" xref="S4.SS3.p5.3.m3.2.3.2">𝑄</ci><list id="S4.SS3.p5.3.m3.2.2.2.3.cmml" xref="S4.SS3.p5.3.m3.2.2.2.4"><ci id="S4.SS3.p5.3.m3.1.1.1.1.cmml" xref="S4.SS3.p5.3.m3.1.1.1.1">𝑙</ci><ci id="S4.SS3.p5.3.m3.2.2.2.2.cmml" xref="S4.SS3.p5.3.m3.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.3.m3.2c">Q_{l,i}</annotation></semantics></math>.
The latest features for updating <math id="S4.SS3.p5.4.m4.1" class="ltx_Math" alttext="Q_{\text{CL}}" display="inline"><semantics id="S4.SS3.p5.4.m4.1a"><msub id="S4.SS3.p5.4.m4.1.1" xref="S4.SS3.p5.4.m4.1.1.cmml"><mi id="S4.SS3.p5.4.m4.1.1.2" xref="S4.SS3.p5.4.m4.1.1.2.cmml">Q</mi><mtext id="S4.SS3.p5.4.m4.1.1.3" xref="S4.SS3.p5.4.m4.1.1.3a.cmml">CL</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.4.m4.1b"><apply id="S4.SS3.p5.4.m4.1.1.cmml" xref="S4.SS3.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.4.m4.1.1.1.cmml" xref="S4.SS3.p5.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p5.4.m4.1.1.2.cmml" xref="S4.SS3.p5.4.m4.1.1.2">𝑄</ci><ci id="S4.SS3.p5.4.m4.1.1.3a.cmml" xref="S4.SS3.p5.4.m4.1.1.3"><mtext mathsize="70%" id="S4.SS3.p5.4.m4.1.1.3.cmml" xref="S4.SS3.p5.4.m4.1.1.3">CL</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.4.m4.1c">Q_{\text{CL}}</annotation></semantics></math> are also simplified as follows.</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.4" class="ltx_Math" alttext="q_{\text{update}}=\{q_{r,i,B}\}." display="block"><semantics id="S4.E5.m1.4a"><mrow id="S4.E5.m1.4.4.1" xref="S4.E5.m1.4.4.1.1.cmml"><mrow id="S4.E5.m1.4.4.1.1" xref="S4.E5.m1.4.4.1.1.cmml"><msub id="S4.E5.m1.4.4.1.1.3" xref="S4.E5.m1.4.4.1.1.3.cmml"><mi id="S4.E5.m1.4.4.1.1.3.2" xref="S4.E5.m1.4.4.1.1.3.2.cmml">q</mi><mtext id="S4.E5.m1.4.4.1.1.3.3" xref="S4.E5.m1.4.4.1.1.3.3a.cmml">update</mtext></msub><mo id="S4.E5.m1.4.4.1.1.2" xref="S4.E5.m1.4.4.1.1.2.cmml">=</mo><mrow id="S4.E5.m1.4.4.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.2.cmml"><mo stretchy="false" id="S4.E5.m1.4.4.1.1.1.1.2" xref="S4.E5.m1.4.4.1.1.1.2.cmml">{</mo><msub id="S4.E5.m1.4.4.1.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.cmml"><mi id="S4.E5.m1.4.4.1.1.1.1.1.2" xref="S4.E5.m1.4.4.1.1.1.1.1.2.cmml">q</mi><mrow id="S4.E5.m1.3.3.3.5" xref="S4.E5.m1.3.3.3.4.cmml"><mi id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml">r</mi><mo id="S4.E5.m1.3.3.3.5.1" xref="S4.E5.m1.3.3.3.4.cmml">,</mo><mi id="S4.E5.m1.2.2.2.2" xref="S4.E5.m1.2.2.2.2.cmml">i</mi><mo id="S4.E5.m1.3.3.3.5.2" xref="S4.E5.m1.3.3.3.4.cmml">,</mo><mi id="S4.E5.m1.3.3.3.3" xref="S4.E5.m1.3.3.3.3.cmml">B</mi></mrow></msub><mo stretchy="false" id="S4.E5.m1.4.4.1.1.1.1.3" xref="S4.E5.m1.4.4.1.1.1.2.cmml">}</mo></mrow></mrow><mo lspace="0em" id="S4.E5.m1.4.4.1.2" xref="S4.E5.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.4b"><apply id="S4.E5.m1.4.4.1.1.cmml" xref="S4.E5.m1.4.4.1"><eq id="S4.E5.m1.4.4.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.2"></eq><apply id="S4.E5.m1.4.4.1.1.3.cmml" xref="S4.E5.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.3.1.cmml" xref="S4.E5.m1.4.4.1.1.3">subscript</csymbol><ci id="S4.E5.m1.4.4.1.1.3.2.cmml" xref="S4.E5.m1.4.4.1.1.3.2">𝑞</ci><ci id="S4.E5.m1.4.4.1.1.3.3a.cmml" xref="S4.E5.m1.4.4.1.1.3.3"><mtext mathsize="70%" id="S4.E5.m1.4.4.1.1.3.3.cmml" xref="S4.E5.m1.4.4.1.1.3.3">update</mtext></ci></apply><set id="S4.E5.m1.4.4.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1"><apply id="S4.E5.m1.4.4.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.4.4.1.1.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.2">𝑞</ci><list id="S4.E5.m1.3.3.3.4.cmml" xref="S4.E5.m1.3.3.3.5"><ci id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1">𝑟</ci><ci id="S4.E5.m1.2.2.2.2.cmml" xref="S4.E5.m1.2.2.2.2">𝑖</ci><ci id="S4.E5.m1.3.3.3.3.cmml" xref="S4.E5.m1.3.3.3.3">𝐵</ci></list></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.4c">q_{\text{update}}=\{q_{r,i,B}\}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS3.p6" class="ltx_para">
<p id="S4.SS3.p6.1" class="ltx_p">Compared with Eq.(<a href="#S4.E4" title="In IV-C Learning with Remote Features ‣ IV Contrastive Learning with Remote and Local Features ‣ Federated Contrastive Learning for Dermatological Disease Diagnosis via On-device Learning This work was supported in part by NSF CNS-2122320." class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>), the local negatives are removed in Eq.(<a href="#S4.E5" title="In IV-C Learning with Remote Features ‣ IV Contrastive Learning with Remote and Local Features ‣ Federated Contrastive Learning for Dermatological Disease Diagnosis via On-device Learning This work was supported in part by NSF CNS-2122320." class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>).
In this way, better representations can be learned during FCL, which also results in a higher accuracy of the diagnostic model after fine-tuning.</p>
</div>
<div id="S4.SS3.p7" class="ltx_para ltx_noindent">
<p id="S4.SS3.p7.5" class="ltx_p"><span id="S4.SS3.p7.5.1" class="ltx_text ltx_font_bold">Loss function.</span>
On device <math id="S4.SS3.p7.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS3.p7.1.m1.1a"><mi id="S4.SS3.p7.1.m1.1.1" xref="S4.SS3.p7.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.1.m1.1b"><ci id="S4.SS3.p7.1.m1.1.1.cmml" xref="S4.SS3.p7.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.1.m1.1c">i</annotation></semantics></math>, by using the constructed <math id="S4.SS3.p7.2.m2.1" class="ltx_Math" alttext="Q_{\text{CL}}" display="inline"><semantics id="S4.SS3.p7.2.m2.1a"><msub id="S4.SS3.p7.2.m2.1.1" xref="S4.SS3.p7.2.m2.1.1.cmml"><mi id="S4.SS3.p7.2.m2.1.1.2" xref="S4.SS3.p7.2.m2.1.1.2.cmml">Q</mi><mtext id="S4.SS3.p7.2.m2.1.1.3" xref="S4.SS3.p7.2.m2.1.1.3a.cmml">CL</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.2.m2.1b"><apply id="S4.SS3.p7.2.m2.1.1.cmml" xref="S4.SS3.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.2.m2.1.1.1.cmml" xref="S4.SS3.p7.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p7.2.m2.1.1.2.cmml" xref="S4.SS3.p7.2.m2.1.1.2">𝑄</ci><ci id="S4.SS3.p7.2.m2.1.1.3a.cmml" xref="S4.SS3.p7.2.m2.1.1.3"><mtext mathsize="70%" id="S4.SS3.p7.2.m2.1.1.3.cmml" xref="S4.SS3.p7.2.m2.1.1.3">CL</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.2.m2.1c">Q_{\text{CL}}</annotation></semantics></math>, the feature <math id="S4.SS3.p7.3.m3.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S4.SS3.p7.3.m3.1a"><mi id="S4.SS3.p7.3.m3.1.1" xref="S4.SS3.p7.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.3.m3.1b"><ci id="S4.SS3.p7.3.m3.1.1.cmml" xref="S4.SS3.p7.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.3.m3.1c">q</annotation></semantics></math> of one image being learned is compared with all features in <math id="S4.SS3.p7.4.m4.1" class="ltx_Math" alttext="Q_{\text{CL}}" display="inline"><semantics id="S4.SS3.p7.4.m4.1a"><msub id="S4.SS3.p7.4.m4.1.1" xref="S4.SS3.p7.4.m4.1.1.cmml"><mi id="S4.SS3.p7.4.m4.1.1.2" xref="S4.SS3.p7.4.m4.1.1.2.cmml">Q</mi><mtext id="S4.SS3.p7.4.m4.1.1.3" xref="S4.SS3.p7.4.m4.1.1.3a.cmml">CL</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.4.m4.1b"><apply id="S4.SS3.p7.4.m4.1.1.cmml" xref="S4.SS3.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.4.m4.1.1.1.cmml" xref="S4.SS3.p7.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p7.4.m4.1.1.2.cmml" xref="S4.SS3.p7.4.m4.1.1.2">𝑄</ci><ci id="S4.SS3.p7.4.m4.1.1.3a.cmml" xref="S4.SS3.p7.4.m4.1.1.3"><mtext mathsize="70%" id="S4.SS3.p7.4.m4.1.1.3.cmml" xref="S4.SS3.p7.4.m4.1.1.3">CL</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.4.m4.1c">Q_{\text{CL}}</annotation></semantics></math>, and the contrastive loss for <math id="S4.SS3.p7.5.m5.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S4.SS3.p7.5.m5.1a"><mi id="S4.SS3.p7.5.m5.1.1" xref="S4.SS3.p7.5.m5.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.5.m5.1b"><ci id="S4.SS3.p7.5.m5.1.1.cmml" xref="S4.SS3.p7.5.m5.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.5.m5.1c">q</annotation></semantics></math> is defined as follows.</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.10" class="ltx_Math" alttext="\ell_{q,k^{+},Q_{\text{CL}}}=-\log\frac{\exp(q\cdot k^{+}/\tau)}{\exp(q\cdot k^{+}/\tau)+\sum_{n\in Q_{\text{CL}}}\exp(q\cdot n/\tau)}." display="block"><semantics id="S4.E6.m1.10a"><mrow id="S4.E6.m1.10.10.1" xref="S4.E6.m1.10.10.1.1.cmml"><mrow id="S4.E6.m1.10.10.1.1" xref="S4.E6.m1.10.10.1.1.cmml"><msub id="S4.E6.m1.10.10.1.1.2" xref="S4.E6.m1.10.10.1.1.2.cmml"><mi mathvariant="normal" id="S4.E6.m1.10.10.1.1.2.2" xref="S4.E6.m1.10.10.1.1.2.2.cmml">ℓ</mi><mrow id="S4.E6.m1.3.3.3.3" xref="S4.E6.m1.3.3.3.4.cmml"><mi id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml">q</mi><mo id="S4.E6.m1.3.3.3.3.3" xref="S4.E6.m1.3.3.3.4.cmml">,</mo><msup id="S4.E6.m1.2.2.2.2.1" xref="S4.E6.m1.2.2.2.2.1.cmml"><mi id="S4.E6.m1.2.2.2.2.1.2" xref="S4.E6.m1.2.2.2.2.1.2.cmml">k</mi><mo id="S4.E6.m1.2.2.2.2.1.3" xref="S4.E6.m1.2.2.2.2.1.3.cmml">+</mo></msup><mo id="S4.E6.m1.3.3.3.3.4" xref="S4.E6.m1.3.3.3.4.cmml">,</mo><msub id="S4.E6.m1.3.3.3.3.2" xref="S4.E6.m1.3.3.3.3.2.cmml"><mi id="S4.E6.m1.3.3.3.3.2.2" xref="S4.E6.m1.3.3.3.3.2.2.cmml">Q</mi><mtext id="S4.E6.m1.3.3.3.3.2.3" xref="S4.E6.m1.3.3.3.3.2.3a.cmml">CL</mtext></msub></mrow></msub><mo id="S4.E6.m1.10.10.1.1.1" xref="S4.E6.m1.10.10.1.1.1.cmml">=</mo><mrow id="S4.E6.m1.10.10.1.1.3" xref="S4.E6.m1.10.10.1.1.3.cmml"><mo rspace="0.167em" id="S4.E6.m1.10.10.1.1.3a" xref="S4.E6.m1.10.10.1.1.3.cmml">−</mo><mrow id="S4.E6.m1.10.10.1.1.3.2" xref="S4.E6.m1.10.10.1.1.3.2.cmml"><mi id="S4.E6.m1.10.10.1.1.3.2.1" xref="S4.E6.m1.10.10.1.1.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S4.E6.m1.10.10.1.1.3.2a" xref="S4.E6.m1.10.10.1.1.3.2.cmml">⁡</mo><mfrac id="S4.E6.m1.9.9" xref="S4.E6.m1.9.9.cmml"><mrow id="S4.E6.m1.5.5.2.2" xref="S4.E6.m1.5.5.2.3.cmml"><mi id="S4.E6.m1.4.4.1.1" xref="S4.E6.m1.4.4.1.1.cmml">exp</mi><mo id="S4.E6.m1.5.5.2.2a" xref="S4.E6.m1.5.5.2.3.cmml">⁡</mo><mrow id="S4.E6.m1.5.5.2.2.1" xref="S4.E6.m1.5.5.2.3.cmml"><mo stretchy="false" id="S4.E6.m1.5.5.2.2.1.2" xref="S4.E6.m1.5.5.2.3.cmml">(</mo><mrow id="S4.E6.m1.5.5.2.2.1.1" xref="S4.E6.m1.5.5.2.2.1.1.cmml"><mrow id="S4.E6.m1.5.5.2.2.1.1.2" xref="S4.E6.m1.5.5.2.2.1.1.2.cmml"><mi id="S4.E6.m1.5.5.2.2.1.1.2.2" xref="S4.E6.m1.5.5.2.2.1.1.2.2.cmml">q</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E6.m1.5.5.2.2.1.1.2.1" xref="S4.E6.m1.5.5.2.2.1.1.2.1.cmml">⋅</mo><msup id="S4.E6.m1.5.5.2.2.1.1.2.3" xref="S4.E6.m1.5.5.2.2.1.1.2.3.cmml"><mi id="S4.E6.m1.5.5.2.2.1.1.2.3.2" xref="S4.E6.m1.5.5.2.2.1.1.2.3.2.cmml">k</mi><mo id="S4.E6.m1.5.5.2.2.1.1.2.3.3" xref="S4.E6.m1.5.5.2.2.1.1.2.3.3.cmml">+</mo></msup></mrow><mo id="S4.E6.m1.5.5.2.2.1.1.1" xref="S4.E6.m1.5.5.2.2.1.1.1.cmml">/</mo><mi id="S4.E6.m1.5.5.2.2.1.1.3" xref="S4.E6.m1.5.5.2.2.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="S4.E6.m1.5.5.2.2.1.3" xref="S4.E6.m1.5.5.2.3.cmml">)</mo></mrow></mrow><mrow id="S4.E6.m1.9.9.6" xref="S4.E6.m1.9.9.6.cmml"><mrow id="S4.E6.m1.8.8.5.3.1" xref="S4.E6.m1.8.8.5.3.2.cmml"><mi id="S4.E6.m1.6.6.3.1" xref="S4.E6.m1.6.6.3.1.cmml">exp</mi><mo id="S4.E6.m1.8.8.5.3.1a" xref="S4.E6.m1.8.8.5.3.2.cmml">⁡</mo><mrow id="S4.E6.m1.8.8.5.3.1.1" xref="S4.E6.m1.8.8.5.3.2.cmml"><mo stretchy="false" id="S4.E6.m1.8.8.5.3.1.1.2" xref="S4.E6.m1.8.8.5.3.2.cmml">(</mo><mrow id="S4.E6.m1.8.8.5.3.1.1.1" xref="S4.E6.m1.8.8.5.3.1.1.1.cmml"><mrow id="S4.E6.m1.8.8.5.3.1.1.1.2" xref="S4.E6.m1.8.8.5.3.1.1.1.2.cmml"><mi id="S4.E6.m1.8.8.5.3.1.1.1.2.2" xref="S4.E6.m1.8.8.5.3.1.1.1.2.2.cmml">q</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E6.m1.8.8.5.3.1.1.1.2.1" xref="S4.E6.m1.8.8.5.3.1.1.1.2.1.cmml">⋅</mo><msup id="S4.E6.m1.8.8.5.3.1.1.1.2.3" xref="S4.E6.m1.8.8.5.3.1.1.1.2.3.cmml"><mi id="S4.E6.m1.8.8.5.3.1.1.1.2.3.2" xref="S4.E6.m1.8.8.5.3.1.1.1.2.3.2.cmml">k</mi><mo id="S4.E6.m1.8.8.5.3.1.1.1.2.3.3" xref="S4.E6.m1.8.8.5.3.1.1.1.2.3.3.cmml">+</mo></msup></mrow><mo id="S4.E6.m1.8.8.5.3.1.1.1.1" xref="S4.E6.m1.8.8.5.3.1.1.1.1.cmml">/</mo><mi id="S4.E6.m1.8.8.5.3.1.1.1.3" xref="S4.E6.m1.8.8.5.3.1.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="S4.E6.m1.8.8.5.3.1.1.3" xref="S4.E6.m1.8.8.5.3.2.cmml">)</mo></mrow></mrow><mo rspace="0.055em" id="S4.E6.m1.9.9.6.5" xref="S4.E6.m1.9.9.6.5.cmml">+</mo><mrow id="S4.E6.m1.9.9.6.4" xref="S4.E6.m1.9.9.6.4.cmml"><msub id="S4.E6.m1.9.9.6.4.2" xref="S4.E6.m1.9.9.6.4.2.cmml"><mo id="S4.E6.m1.9.9.6.4.2.2" xref="S4.E6.m1.9.9.6.4.2.2.cmml">∑</mo><mrow id="S4.E6.m1.9.9.6.4.2.3" xref="S4.E6.m1.9.9.6.4.2.3.cmml"><mi id="S4.E6.m1.9.9.6.4.2.3.2" xref="S4.E6.m1.9.9.6.4.2.3.2.cmml">n</mi><mo id="S4.E6.m1.9.9.6.4.2.3.1" xref="S4.E6.m1.9.9.6.4.2.3.1.cmml">∈</mo><msub id="S4.E6.m1.9.9.6.4.2.3.3" xref="S4.E6.m1.9.9.6.4.2.3.3.cmml"><mi id="S4.E6.m1.9.9.6.4.2.3.3.2" xref="S4.E6.m1.9.9.6.4.2.3.3.2.cmml">Q</mi><mtext id="S4.E6.m1.9.9.6.4.2.3.3.3" xref="S4.E6.m1.9.9.6.4.2.3.3.3a.cmml">CL</mtext></msub></mrow></msub><mrow id="S4.E6.m1.9.9.6.4.1.1" xref="S4.E6.m1.9.9.6.4.1.2.cmml"><mi id="S4.E6.m1.7.7.4.2" xref="S4.E6.m1.7.7.4.2.cmml">exp</mi><mo id="S4.E6.m1.9.9.6.4.1.1a" xref="S4.E6.m1.9.9.6.4.1.2.cmml">⁡</mo><mrow id="S4.E6.m1.9.9.6.4.1.1.1" xref="S4.E6.m1.9.9.6.4.1.2.cmml"><mo stretchy="false" id="S4.E6.m1.9.9.6.4.1.1.1.2" xref="S4.E6.m1.9.9.6.4.1.2.cmml">(</mo><mrow id="S4.E6.m1.9.9.6.4.1.1.1.1" xref="S4.E6.m1.9.9.6.4.1.1.1.1.cmml"><mrow id="S4.E6.m1.9.9.6.4.1.1.1.1.2" xref="S4.E6.m1.9.9.6.4.1.1.1.1.2.cmml"><mi id="S4.E6.m1.9.9.6.4.1.1.1.1.2.2" xref="S4.E6.m1.9.9.6.4.1.1.1.1.2.2.cmml">q</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E6.m1.9.9.6.4.1.1.1.1.2.1" xref="S4.E6.m1.9.9.6.4.1.1.1.1.2.1.cmml">⋅</mo><mi id="S4.E6.m1.9.9.6.4.1.1.1.1.2.3" xref="S4.E6.m1.9.9.6.4.1.1.1.1.2.3.cmml">n</mi></mrow><mo id="S4.E6.m1.9.9.6.4.1.1.1.1.1" xref="S4.E6.m1.9.9.6.4.1.1.1.1.1.cmml">/</mo><mi id="S4.E6.m1.9.9.6.4.1.1.1.1.3" xref="S4.E6.m1.9.9.6.4.1.1.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="S4.E6.m1.9.9.6.4.1.1.1.3" xref="S4.E6.m1.9.9.6.4.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><mo lspace="0em" id="S4.E6.m1.10.10.1.2" xref="S4.E6.m1.10.10.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.10b"><apply id="S4.E6.m1.10.10.1.1.cmml" xref="S4.E6.m1.10.10.1"><eq id="S4.E6.m1.10.10.1.1.1.cmml" xref="S4.E6.m1.10.10.1.1.1"></eq><apply id="S4.E6.m1.10.10.1.1.2.cmml" xref="S4.E6.m1.10.10.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.10.10.1.1.2.1.cmml" xref="S4.E6.m1.10.10.1.1.2">subscript</csymbol><ci id="S4.E6.m1.10.10.1.1.2.2.cmml" xref="S4.E6.m1.10.10.1.1.2.2">ℓ</ci><list id="S4.E6.m1.3.3.3.4.cmml" xref="S4.E6.m1.3.3.3.3"><ci id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1">𝑞</ci><apply id="S4.E6.m1.2.2.2.2.1.cmml" xref="S4.E6.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.1.1.cmml" xref="S4.E6.m1.2.2.2.2.1">superscript</csymbol><ci id="S4.E6.m1.2.2.2.2.1.2.cmml" xref="S4.E6.m1.2.2.2.2.1.2">𝑘</ci><plus id="S4.E6.m1.2.2.2.2.1.3.cmml" xref="S4.E6.m1.2.2.2.2.1.3"></plus></apply><apply id="S4.E6.m1.3.3.3.3.2.cmml" xref="S4.E6.m1.3.3.3.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.3.3.2.1.cmml" xref="S4.E6.m1.3.3.3.3.2">subscript</csymbol><ci id="S4.E6.m1.3.3.3.3.2.2.cmml" xref="S4.E6.m1.3.3.3.3.2.2">𝑄</ci><ci id="S4.E6.m1.3.3.3.3.2.3a.cmml" xref="S4.E6.m1.3.3.3.3.2.3"><mtext mathsize="50%" id="S4.E6.m1.3.3.3.3.2.3.cmml" xref="S4.E6.m1.3.3.3.3.2.3">CL</mtext></ci></apply></list></apply><apply id="S4.E6.m1.10.10.1.1.3.cmml" xref="S4.E6.m1.10.10.1.1.3"><minus id="S4.E6.m1.10.10.1.1.3.1.cmml" xref="S4.E6.m1.10.10.1.1.3"></minus><apply id="S4.E6.m1.10.10.1.1.3.2.cmml" xref="S4.E6.m1.10.10.1.1.3.2"><log id="S4.E6.m1.10.10.1.1.3.2.1.cmml" xref="S4.E6.m1.10.10.1.1.3.2.1"></log><apply id="S4.E6.m1.9.9.cmml" xref="S4.E6.m1.9.9"><divide id="S4.E6.m1.9.9.7.cmml" xref="S4.E6.m1.9.9"></divide><apply id="S4.E6.m1.5.5.2.3.cmml" xref="S4.E6.m1.5.5.2.2"><exp id="S4.E6.m1.4.4.1.1.cmml" xref="S4.E6.m1.4.4.1.1"></exp><apply id="S4.E6.m1.5.5.2.2.1.1.cmml" xref="S4.E6.m1.5.5.2.2.1.1"><divide id="S4.E6.m1.5.5.2.2.1.1.1.cmml" xref="S4.E6.m1.5.5.2.2.1.1.1"></divide><apply id="S4.E6.m1.5.5.2.2.1.1.2.cmml" xref="S4.E6.m1.5.5.2.2.1.1.2"><ci id="S4.E6.m1.5.5.2.2.1.1.2.1.cmml" xref="S4.E6.m1.5.5.2.2.1.1.2.1">⋅</ci><ci id="S4.E6.m1.5.5.2.2.1.1.2.2.cmml" xref="S4.E6.m1.5.5.2.2.1.1.2.2">𝑞</ci><apply id="S4.E6.m1.5.5.2.2.1.1.2.3.cmml" xref="S4.E6.m1.5.5.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.2.2.1.1.2.3.1.cmml" xref="S4.E6.m1.5.5.2.2.1.1.2.3">superscript</csymbol><ci id="S4.E6.m1.5.5.2.2.1.1.2.3.2.cmml" xref="S4.E6.m1.5.5.2.2.1.1.2.3.2">𝑘</ci><plus id="S4.E6.m1.5.5.2.2.1.1.2.3.3.cmml" xref="S4.E6.m1.5.5.2.2.1.1.2.3.3"></plus></apply></apply><ci id="S4.E6.m1.5.5.2.2.1.1.3.cmml" xref="S4.E6.m1.5.5.2.2.1.1.3">𝜏</ci></apply></apply><apply id="S4.E6.m1.9.9.6.cmml" xref="S4.E6.m1.9.9.6"><plus id="S4.E6.m1.9.9.6.5.cmml" xref="S4.E6.m1.9.9.6.5"></plus><apply id="S4.E6.m1.8.8.5.3.2.cmml" xref="S4.E6.m1.8.8.5.3.1"><exp id="S4.E6.m1.6.6.3.1.cmml" xref="S4.E6.m1.6.6.3.1"></exp><apply id="S4.E6.m1.8.8.5.3.1.1.1.cmml" xref="S4.E6.m1.8.8.5.3.1.1.1"><divide id="S4.E6.m1.8.8.5.3.1.1.1.1.cmml" xref="S4.E6.m1.8.8.5.3.1.1.1.1"></divide><apply id="S4.E6.m1.8.8.5.3.1.1.1.2.cmml" xref="S4.E6.m1.8.8.5.3.1.1.1.2"><ci id="S4.E6.m1.8.8.5.3.1.1.1.2.1.cmml" xref="S4.E6.m1.8.8.5.3.1.1.1.2.1">⋅</ci><ci id="S4.E6.m1.8.8.5.3.1.1.1.2.2.cmml" xref="S4.E6.m1.8.8.5.3.1.1.1.2.2">𝑞</ci><apply id="S4.E6.m1.8.8.5.3.1.1.1.2.3.cmml" xref="S4.E6.m1.8.8.5.3.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.8.8.5.3.1.1.1.2.3.1.cmml" xref="S4.E6.m1.8.8.5.3.1.1.1.2.3">superscript</csymbol><ci id="S4.E6.m1.8.8.5.3.1.1.1.2.3.2.cmml" xref="S4.E6.m1.8.8.5.3.1.1.1.2.3.2">𝑘</ci><plus id="S4.E6.m1.8.8.5.3.1.1.1.2.3.3.cmml" xref="S4.E6.m1.8.8.5.3.1.1.1.2.3.3"></plus></apply></apply><ci id="S4.E6.m1.8.8.5.3.1.1.1.3.cmml" xref="S4.E6.m1.8.8.5.3.1.1.1.3">𝜏</ci></apply></apply><apply id="S4.E6.m1.9.9.6.4.cmml" xref="S4.E6.m1.9.9.6.4"><apply id="S4.E6.m1.9.9.6.4.2.cmml" xref="S4.E6.m1.9.9.6.4.2"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.6.4.2.1.cmml" xref="S4.E6.m1.9.9.6.4.2">subscript</csymbol><sum id="S4.E6.m1.9.9.6.4.2.2.cmml" xref="S4.E6.m1.9.9.6.4.2.2"></sum><apply id="S4.E6.m1.9.9.6.4.2.3.cmml" xref="S4.E6.m1.9.9.6.4.2.3"><in id="S4.E6.m1.9.9.6.4.2.3.1.cmml" xref="S4.E6.m1.9.9.6.4.2.3.1"></in><ci id="S4.E6.m1.9.9.6.4.2.3.2.cmml" xref="S4.E6.m1.9.9.6.4.2.3.2">𝑛</ci><apply id="S4.E6.m1.9.9.6.4.2.3.3.cmml" xref="S4.E6.m1.9.9.6.4.2.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.6.4.2.3.3.1.cmml" xref="S4.E6.m1.9.9.6.4.2.3.3">subscript</csymbol><ci id="S4.E6.m1.9.9.6.4.2.3.3.2.cmml" xref="S4.E6.m1.9.9.6.4.2.3.3.2">𝑄</ci><ci id="S4.E6.m1.9.9.6.4.2.3.3.3a.cmml" xref="S4.E6.m1.9.9.6.4.2.3.3.3"><mtext mathsize="50%" id="S4.E6.m1.9.9.6.4.2.3.3.3.cmml" xref="S4.E6.m1.9.9.6.4.2.3.3.3">CL</mtext></ci></apply></apply></apply><apply id="S4.E6.m1.9.9.6.4.1.2.cmml" xref="S4.E6.m1.9.9.6.4.1.1"><exp id="S4.E6.m1.7.7.4.2.cmml" xref="S4.E6.m1.7.7.4.2"></exp><apply id="S4.E6.m1.9.9.6.4.1.1.1.1.cmml" xref="S4.E6.m1.9.9.6.4.1.1.1.1"><divide id="S4.E6.m1.9.9.6.4.1.1.1.1.1.cmml" xref="S4.E6.m1.9.9.6.4.1.1.1.1.1"></divide><apply id="S4.E6.m1.9.9.6.4.1.1.1.1.2.cmml" xref="S4.E6.m1.9.9.6.4.1.1.1.1.2"><ci id="S4.E6.m1.9.9.6.4.1.1.1.1.2.1.cmml" xref="S4.E6.m1.9.9.6.4.1.1.1.1.2.1">⋅</ci><ci id="S4.E6.m1.9.9.6.4.1.1.1.1.2.2.cmml" xref="S4.E6.m1.9.9.6.4.1.1.1.1.2.2">𝑞</ci><ci id="S4.E6.m1.9.9.6.4.1.1.1.1.2.3.cmml" xref="S4.E6.m1.9.9.6.4.1.1.1.1.2.3">𝑛</ci></apply><ci id="S4.E6.m1.9.9.6.4.1.1.1.1.3.cmml" xref="S4.E6.m1.9.9.6.4.1.1.1.1.3">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.10c">\ell_{q,k^{+},Q_{\text{CL}}}=-\log\frac{\exp(q\cdot k^{+}/\tau)}{\exp(q\cdot k^{+}/\tau)+\sum_{n\in Q_{\text{CL}}}\exp(q\cdot n/\tau)}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p7.7" class="ltx_p">where the operator <math id="S4.SS3.p7.6.m1.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="S4.SS3.p7.6.m1.1a"><mo id="S4.SS3.p7.6.m1.1.1" xref="S4.SS3.p7.6.m1.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.6.m1.1b"><ci id="S4.SS3.p7.6.m1.1.1.cmml" xref="S4.SS3.p7.6.m1.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.6.m1.1c">\cdot</annotation></semantics></math> is the dot product between two vectors and <math id="S4.SS3.p7.7.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.SS3.p7.7.m2.1a"><mi id="S4.SS3.p7.7.m2.1.1" xref="S4.SS3.p7.7.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.7.m2.1b"><ci id="S4.SS3.p7.7.m2.1.1.cmml" xref="S4.SS3.p7.7.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.7.m2.1c">\tau</annotation></semantics></math> is the temperature to control the distribution concentration degree <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>.
By minimizing the loss, the representations of local data can be effectively learned.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.9.2.1" class="ltx_text" style="font-size:90%;">TABLE I</span>: </span><span id="S4.T1.2.1" class="ltx_text" style="font-size:90%;">Results of <span id="S4.T1.2.1.1" class="ltx_text ltx_font_bold">local fine-tuning</span> by the proposed approaches and baselines. The model is pre-trained by different approaches without using labels and then fine-tuned with limited labeled data independently on each device. <math id="S4.T1.2.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.T1.2.1.m1.1b"><mi id="S4.T1.2.1.m1.1.1" xref="S4.T1.2.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.T1.2.1.m1.1c"><ci id="S4.T1.2.1.m1.1.1.cmml" xref="S4.T1.2.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.1.m1.1d">L</annotation></semantics></math> is the label fraction on each device for fine-tuning.
The recall and precision averaged over all devices are reported, and on each device, the recall and precision are averaged over all classes.
With different label fractions, consistent improvements by the proposed approaches over the baselines are observed.
</span></figcaption>
<div id="S4.T1.6" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:329.5pt;height:74.5pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-116.0pt,26.0pt) scale(0.586790999613702,0.586790999613702) ;">
<table id="S4.T1.6.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.6.4.4" class="ltx_tr">
<th id="S4.T1.6.4.4.5" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S4.T1.3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">
<math id="S4.T1.3.1.1.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.T1.3.1.1.1.m1.1a"><mi id="S4.T1.3.1.1.1.m1.1.1" xref="S4.T1.3.1.1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.T1.3.1.1.1.m1.1b"><ci id="S4.T1.3.1.1.1.m1.1.1.cmml" xref="S4.T1.3.1.1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.1.1.1.m1.1c">L</annotation></semantics></math>=10%</th>
<th id="S4.T1.4.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">
<math id="S4.T1.4.2.2.2.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.T1.4.2.2.2.m1.1a"><mi id="S4.T1.4.2.2.2.m1.1.1" xref="S4.T1.4.2.2.2.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.T1.4.2.2.2.m1.1b"><ci id="S4.T1.4.2.2.2.m1.1.1.cmml" xref="S4.T1.4.2.2.2.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.2.2.2.m1.1c">L</annotation></semantics></math>=20%</th>
<th id="S4.T1.5.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">
<math id="S4.T1.5.3.3.3.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.T1.5.3.3.3.m1.1a"><mi id="S4.T1.5.3.3.3.m1.1.1" xref="S4.T1.5.3.3.3.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.T1.5.3.3.3.m1.1b"><ci id="S4.T1.5.3.3.3.m1.1.1.cmml" xref="S4.T1.5.3.3.3.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.3.3.3.m1.1c">L</annotation></semantics></math>=40%</th>
<th id="S4.T1.6.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">
<math id="S4.T1.6.4.4.4.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.T1.6.4.4.4.m1.1a"><mi id="S4.T1.6.4.4.4.m1.1.1" xref="S4.T1.6.4.4.4.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.T1.6.4.4.4.m1.1b"><ci id="S4.T1.6.4.4.4.m1.1.1.cmml" xref="S4.T1.6.4.4.4.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.4.4.4.m1.1c">L</annotation></semantics></math>=80%</th>
</tr>
<tr id="S4.T1.6.4.5.1" class="ltx_tr">
<th id="S4.T1.6.4.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row">Methods</th>
<th id="S4.T1.6.4.5.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column">Recall</th>
<th id="S4.T1.6.4.5.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">Precision</th>
<th id="S4.T1.6.4.5.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">Recall</th>
<th id="S4.T1.6.4.5.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column">Precision</th>
<th id="S4.T1.6.4.5.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column">Recall</th>
<th id="S4.T1.6.4.5.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column">Precision</th>
<th id="S4.T1.6.4.5.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column">Recall</th>
<th id="S4.T1.6.4.5.1.9" class="ltx_td ltx_align_center ltx_th ltx_th_column">Precision</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.6.4.6.1" class="ltx_tr">
<th id="S4.T1.6.4.6.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Random init</th>
<td id="S4.T1.6.4.6.1.2" class="ltx_td ltx_align_center ltx_border_t">21.56</td>
<td id="S4.T1.6.4.6.1.3" class="ltx_td ltx_align_center ltx_border_t">17.35</td>
<td id="S4.T1.6.4.6.1.4" class="ltx_td ltx_align_center ltx_border_t">23.13</td>
<td id="S4.T1.6.4.6.1.5" class="ltx_td ltx_align_center ltx_border_t">20.79</td>
<td id="S4.T1.6.4.6.1.6" class="ltx_td ltx_align_center ltx_border_t">24.88</td>
<td id="S4.T1.6.4.6.1.7" class="ltx_td ltx_align_center ltx_border_t">23.69</td>
<td id="S4.T1.6.4.6.1.8" class="ltx_td ltx_align_center ltx_border_t">23.92</td>
<td id="S4.T1.6.4.6.1.9" class="ltx_td ltx_align_center ltx_border_t">26.06</td>
</tr>
<tr id="S4.T1.6.4.7.2" class="ltx_tr">
<th id="S4.T1.6.4.7.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Local CL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>
</th>
<td id="S4.T1.6.4.7.2.2" class="ltx_td ltx_align_center">26.57</td>
<td id="S4.T1.6.4.7.2.3" class="ltx_td ltx_align_center">26.54</td>
<td id="S4.T1.6.4.7.2.4" class="ltx_td ltx_align_center">28.82</td>
<td id="S4.T1.6.4.7.2.5" class="ltx_td ltx_align_center">28.20</td>
<td id="S4.T1.6.4.7.2.6" class="ltx_td ltx_align_center">31.46</td>
<td id="S4.T1.6.4.7.2.7" class="ltx_td ltx_align_center">30.49</td>
<td id="S4.T1.6.4.7.2.8" class="ltx_td ltx_align_center">34.27</td>
<td id="S4.T1.6.4.7.2.9" class="ltx_td ltx_align_center">30.71</td>
</tr>
<tr id="S4.T1.6.4.8.3" class="ltx_tr">
<th id="S4.T1.6.4.8.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedRotation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>
</th>
<td id="S4.T1.6.4.8.3.2" class="ltx_td ltx_align_center">23.45</td>
<td id="S4.T1.6.4.8.3.3" class="ltx_td ltx_align_center">25.27</td>
<td id="S4.T1.6.4.8.3.4" class="ltx_td ltx_align_center">25.05</td>
<td id="S4.T1.6.4.8.3.5" class="ltx_td ltx_align_center">25.05</td>
<td id="S4.T1.6.4.8.3.6" class="ltx_td ltx_align_center">29.39</td>
<td id="S4.T1.6.4.8.3.7" class="ltx_td ltx_align_center">28.48</td>
<td id="S4.T1.6.4.8.3.8" class="ltx_td ltx_align_center">32.87</td>
<td id="S4.T1.6.4.8.3.9" class="ltx_td ltx_align_center">28.15</td>
</tr>
<tr id="S4.T1.6.4.9.4" class="ltx_tr">
<th id="S4.T1.6.4.9.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedSimCLR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>
</th>
<td id="S4.T1.6.4.9.4.2" class="ltx_td ltx_align_center">30.11</td>
<td id="S4.T1.6.4.9.4.3" class="ltx_td ltx_align_center">31.25</td>
<td id="S4.T1.6.4.9.4.4" class="ltx_td ltx_align_center">32.77</td>
<td id="S4.T1.6.4.9.4.5" class="ltx_td ltx_align_center">31.67</td>
<td id="S4.T1.6.4.9.4.6" class="ltx_td ltx_align_center">35.50</td>
<td id="S4.T1.6.4.9.4.7" class="ltx_td ltx_align_center">33.09</td>
<td id="S4.T1.6.4.9.4.8" class="ltx_td ltx_align_center">37.58</td>
<td id="S4.T1.6.4.9.4.9" class="ltx_td ltx_align_center">33.85</td>
</tr>
<tr id="S4.T1.6.4.10.5" class="ltx_tr">
<th id="S4.T1.6.4.10.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Proposed</th>
<td id="S4.T1.6.4.10.5.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.6.4.10.5.2.1" class="ltx_text ltx_font_bold">30.41</span></td>
<td id="S4.T1.6.4.10.5.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.6.4.10.5.3.1" class="ltx_text ltx_font_bold">33.54</span></td>
<td id="S4.T1.6.4.10.5.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.6.4.10.5.4.1" class="ltx_text ltx_font_bold">34.41</span></td>
<td id="S4.T1.6.4.10.5.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.6.4.10.5.5.1" class="ltx_text ltx_font_bold">32.96</span></td>
<td id="S4.T1.6.4.10.5.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.6.4.10.5.6.1" class="ltx_text ltx_font_bold">37.03</span></td>
<td id="S4.T1.6.4.10.5.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.6.4.10.5.7.1" class="ltx_text ltx_font_bold">34.95</span></td>
<td id="S4.T1.6.4.10.5.8" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.6.4.10.5.8.1" class="ltx_text ltx_font_bold">39.25</span></td>
<td id="S4.T1.6.4.10.5.9" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.6.4.10.5.9.1" class="ltx_text ltx_font_bold">35.02</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Experiments</span>
</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p"><span id="S5.p1.1.1" class="ltx_text ltx_font_bold">Datasets.</span>
The proposed methods are evaluated on four datasets of different skin colors, including the ISIC 2019 challenge dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> mainly for white skins, AtlasDerm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> and Dermnet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> mainly for brown skins, and DarkDerm mainly for dark skins collected by us.
Since these four datasets have a different number of diagnostic categories, to form a unified classification task, we use their intersection of five diseases, including basal cell carcinoma (BCC), dermatofibroma (DF), melanoma (MEL), melanocytic nevus (NV), and squamous cell carcinoma (SCC).
ISIC dataset consists of about 25k dermoscopic images among nine different diagnostic categories, and we use a subset with about 21k images in the above five classes.
AtlasDerm has about 11k images in 560 categories, and we use its subset in the above five classes with 618 images.
Dermnet consists of images in 23 types of dermatology diseases, and we use a subset in the above five classes with 276 images.
DarkDerm is established with 216 images in the above five categories.
In the pre-processing, the images are resized with bi-linear interpolation such that the dimension of the shorter edge is 72 pixels while keeping the original aspect ratio.</p>
</div>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.1" class="ltx_p"><span id="S5.p2.1.1" class="ltx_text ltx_font_bold">Federated setting.</span>
We use 10 devices for FL and distribute datasets based on skin colors to simulate different patients.
The ISIC dataset is randomly split into 7 partitions and each partition is distributed to one of the first 7 devices.
The AtlasDerm, Dermnet, and DarkDerm datasets are assigned to one of the following three devices, respectively.
On each device, the assigned dataset is randomly split into a training set and a test set with 60% and 40% data, respectively. The test set is not used in any stage of pre-training or fine-tuning.
We use ResNet-18 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> as the backbone model, and use a 2-layer MLP projection head to project the representations to 128-dimensional features.</p>
</div>
<div id="S5.p3" class="ltx_para ltx_noindent">
<p id="S5.p3.1" class="ltx_p"><span id="S5.p3.1.1" class="ltx_text ltx_font_bold">Evaluation.</span>
We use the proposed FCL method to pre-train the model by the distributed devices without using labels.
Then the pre-trained model is used as the initialization for fine-tuning with limited labels.
We consider two practical settings for fine-tuning, <span id="S5.p3.1.2" class="ltx_text ltx_font_italic">local fine-tuning</span> and <span id="S5.p3.1.3" class="ltx_text ltx_font_italic">federated fine-tuning</span>.
In local fine-tuning, each device independently fine-tunes its model with its limited labeled data after pre-training.
In federated fine-tuning, devices collaboratively fine-tune the pre-trained model with limited labeled data by supervised federated learning.
During fine-tuning, we evaluate with different fractions of labels, where the percentage of labeled data in the training set is <math id="S5.p3.1.m1.4" class="ltx_Math" alttext="L\in\{10\%,20\%,40\%,80\%\}" display="inline"><semantics id="S5.p3.1.m1.4a"><mrow id="S5.p3.1.m1.4.4" xref="S5.p3.1.m1.4.4.cmml"><mi id="S5.p3.1.m1.4.4.6" xref="S5.p3.1.m1.4.4.6.cmml">L</mi><mo id="S5.p3.1.m1.4.4.5" xref="S5.p3.1.m1.4.4.5.cmml">∈</mo><mrow id="S5.p3.1.m1.4.4.4.4" xref="S5.p3.1.m1.4.4.4.5.cmml"><mo stretchy="false" id="S5.p3.1.m1.4.4.4.4.5" xref="S5.p3.1.m1.4.4.4.5.cmml">{</mo><mrow id="S5.p3.1.m1.1.1.1.1.1" xref="S5.p3.1.m1.1.1.1.1.1.cmml"><mn id="S5.p3.1.m1.1.1.1.1.1.2" xref="S5.p3.1.m1.1.1.1.1.1.2.cmml">10</mn><mo id="S5.p3.1.m1.1.1.1.1.1.1" xref="S5.p3.1.m1.1.1.1.1.1.1.cmml">%</mo></mrow><mo id="S5.p3.1.m1.4.4.4.4.6" xref="S5.p3.1.m1.4.4.4.5.cmml">,</mo><mrow id="S5.p3.1.m1.2.2.2.2.2" xref="S5.p3.1.m1.2.2.2.2.2.cmml"><mn id="S5.p3.1.m1.2.2.2.2.2.2" xref="S5.p3.1.m1.2.2.2.2.2.2.cmml">20</mn><mo id="S5.p3.1.m1.2.2.2.2.2.1" xref="S5.p3.1.m1.2.2.2.2.2.1.cmml">%</mo></mrow><mo id="S5.p3.1.m1.4.4.4.4.7" xref="S5.p3.1.m1.4.4.4.5.cmml">,</mo><mrow id="S5.p3.1.m1.3.3.3.3.3" xref="S5.p3.1.m1.3.3.3.3.3.cmml"><mn id="S5.p3.1.m1.3.3.3.3.3.2" xref="S5.p3.1.m1.3.3.3.3.3.2.cmml">40</mn><mo id="S5.p3.1.m1.3.3.3.3.3.1" xref="S5.p3.1.m1.3.3.3.3.3.1.cmml">%</mo></mrow><mo id="S5.p3.1.m1.4.4.4.4.8" xref="S5.p3.1.m1.4.4.4.5.cmml">,</mo><mrow id="S5.p3.1.m1.4.4.4.4.4" xref="S5.p3.1.m1.4.4.4.4.4.cmml"><mn id="S5.p3.1.m1.4.4.4.4.4.2" xref="S5.p3.1.m1.4.4.4.4.4.2.cmml">80</mn><mo id="S5.p3.1.m1.4.4.4.4.4.1" xref="S5.p3.1.m1.4.4.4.4.4.1.cmml">%</mo></mrow><mo stretchy="false" id="S5.p3.1.m1.4.4.4.4.9" xref="S5.p3.1.m1.4.4.4.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.1.m1.4b"><apply id="S5.p3.1.m1.4.4.cmml" xref="S5.p3.1.m1.4.4"><in id="S5.p3.1.m1.4.4.5.cmml" xref="S5.p3.1.m1.4.4.5"></in><ci id="S5.p3.1.m1.4.4.6.cmml" xref="S5.p3.1.m1.4.4.6">𝐿</ci><set id="S5.p3.1.m1.4.4.4.5.cmml" xref="S5.p3.1.m1.4.4.4.4"><apply id="S5.p3.1.m1.1.1.1.1.1.cmml" xref="S5.p3.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S5.p3.1.m1.1.1.1.1.1.1.cmml" xref="S5.p3.1.m1.1.1.1.1.1.1">percent</csymbol><cn type="integer" id="S5.p3.1.m1.1.1.1.1.1.2.cmml" xref="S5.p3.1.m1.1.1.1.1.1.2">10</cn></apply><apply id="S5.p3.1.m1.2.2.2.2.2.cmml" xref="S5.p3.1.m1.2.2.2.2.2"><csymbol cd="latexml" id="S5.p3.1.m1.2.2.2.2.2.1.cmml" xref="S5.p3.1.m1.2.2.2.2.2.1">percent</csymbol><cn type="integer" id="S5.p3.1.m1.2.2.2.2.2.2.cmml" xref="S5.p3.1.m1.2.2.2.2.2.2">20</cn></apply><apply id="S5.p3.1.m1.3.3.3.3.3.cmml" xref="S5.p3.1.m1.3.3.3.3.3"><csymbol cd="latexml" id="S5.p3.1.m1.3.3.3.3.3.1.cmml" xref="S5.p3.1.m1.3.3.3.3.3.1">percent</csymbol><cn type="integer" id="S5.p3.1.m1.3.3.3.3.3.2.cmml" xref="S5.p3.1.m1.3.3.3.3.3.2">40</cn></apply><apply id="S5.p3.1.m1.4.4.4.4.4.cmml" xref="S5.p3.1.m1.4.4.4.4.4"><csymbol cd="latexml" id="S5.p3.1.m1.4.4.4.4.4.1.cmml" xref="S5.p3.1.m1.4.4.4.4.4.1">percent</csymbol><cn type="integer" id="S5.p3.1.m1.4.4.4.4.4.2.cmml" xref="S5.p3.1.m1.4.4.4.4.4.2">80</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.1.m1.4c">L\in\{10\%,20\%,40\%,80\%\}</annotation></semantics></math> on each device.
Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, we use two metrics for evaluation, including the mean recall of each class (i.e. balanced multiclass accuracy used as the primary metric for the ISIC 2019 challenge <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>) and the mean precision of each class.
We report the mean recall and mean precision on the test set of all devices.</p>
</div>
<div id="S5.p4" class="ltx_para ltx_noindent">
<p id="S5.p4.1" class="ltx_p"><span id="S5.p4.1.1" class="ltx_text ltx_font_bold">Training details.</span>
The pre-training by the proposed FCL is performed for 100 communication rounds, and FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> is employed as the model aggregation algorithm on the server in each round.
The ratio of active devices per round is 1.0 and the number of local training epochs before each aggregation is 1.
The batch size is 128 and the initial learning rate is 0.03 with a cosine decay schedule.
In the fine-tuning stage, the model is trained for 20 epochs in local fine-tuning or 100 rounds in federated fine-tuning.
In local fine-tuning, Adam optimizer is used with a batch size 256, a learning rate of 0.0001 with a decay factor of 0.2 at epoch 12 and 16.
In federated fine-tuning, Adam optimizer is used with a batch size 128 and a learning rate of 0.0001.
The training is performed on one Nvidia RTX 2080Ti GPU.</p>
</div>
<div id="S5.p5" class="ltx_para ltx_noindent">
<p id="S5.p5.1" class="ltx_p"><span id="S5.p5.1.1" class="ltx_text ltx_font_bold">Baselines.</span>
We compare the proposed techniques with four baselines for pre-training.
<span id="S5.p5.1.2" class="ltx_text ltx_font_italic">Random init</span> uses random model initialization for fine-tuning.
<span id="S5.p5.1.3" class="ltx_text ltx_font_italic">Local CL</span> pre-trains the model by contrastive learning independently on each device with unlabeled data.
<span id="S5.p5.1.4" class="ltx_text ltx_font_italic">Rotation</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> is a self-supervised learning approach for pre-training by predicting the rotation angles of images.
<span id="S5.p5.1.5" class="ltx_text ltx_font_italic">SimCLR</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> is a SOTA contrastive learning based approach.
We combine these two methods with the FL framework FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> as <span id="S5.p5.1.6" class="ltx_text ltx_font_italic">FedRotation</span> and <span id="S5.p5.1.7" class="ltx_text ltx_font_italic">FedSimCLR</span>.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS1.5.1.1" class="ltx_text">V-A</span> </span><span id="S5.SS1.6.2" class="ltx_text ltx_font_italic">Local Fine-tuning</span>
</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">We compare the performance of different methods by local fine-tuning with limited labels. The results are shown in Table <a href="#S4.T1" title="TABLE I ‣ IV-C Learning with Remote Features ‣ IV Contrastive Learning with Remote and Local Features ‣ Federated Contrastive Learning for Dermatological Disease Diagnosis via On-device Learning This work was supported in part by NSF CNS-2122320." class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>, and both recall and precision are reported.
The proposed methods effectively improve the recall and precision with different fractions of labeled data.
First, with 10%, 20%, 40% and 80% labeled data on each device for fine-tuning, the proposed approaches outperform the best-performing baseline by 0.30%, 1.64%, 1.53%, 1.67% for recall, and 2.29%, 1.29%, 1.86%, 1.17% for precision, respectively.
Second, the proposed approaches effectively use limited labels for fine-tuning.
With 40% labels, the proposed approaches achieve 37.03% recall and 34.95% precision, which are on par with or even better than the best-performing baseline with <math id="S5.SS1.p1.1.m1.1" class="ltx_math_unparsed" alttext="2\times" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1b"><mn id="S5.SS1.p1.1.m1.1.1">2</mn><mo lspace="0.222em" id="S5.SS1.p1.1.m1.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">2\times</annotation></semantics></math> labels (37.58% recall and 33.85% precision).</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T2.9.2.1" class="ltx_text" style="font-size:90%;">TABLE II</span>: </span><span id="S5.T2.2.1" class="ltx_text" style="font-size:90%;">
Results of <span id="S5.T2.2.1.1" class="ltx_text ltx_font_bold">federated fine-tuning</span> by the proposed approaches and baselines.
The model is pre-trained by different approaches without using labels and then fine-tuned with limited labeled data collaboratively by all devices.
<math id="S5.T2.2.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S5.T2.2.1.m1.1b"><mi id="S5.T2.2.1.m1.1.1" xref="S5.T2.2.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S5.T2.2.1.m1.1c"><ci id="S5.T2.2.1.m1.1.1.cmml" xref="S5.T2.2.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.1.m1.1d">L</annotation></semantics></math> is the label fraction for fine-tuning on each device.
The recall and precision averaged over all classes are reported.
With different label fractions, consistent improvements by the proposed approaches over the baselines are observed.
</span></figcaption>
<div id="S5.T2.6" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:329.5pt;height:74.5pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-116.0pt,26.0pt) scale(0.586790999613702,0.586790999613702) ;">
<table id="S5.T2.6.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.6.4.4" class="ltx_tr">
<th id="S5.T2.6.4.4.5" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S5.T2.3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">
<math id="S5.T2.3.1.1.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S5.T2.3.1.1.1.m1.1a"><mi id="S5.T2.3.1.1.1.m1.1.1" xref="S5.T2.3.1.1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S5.T2.3.1.1.1.m1.1b"><ci id="S5.T2.3.1.1.1.m1.1.1.cmml" xref="S5.T2.3.1.1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.1.1.1.m1.1c">L</annotation></semantics></math>=10%</th>
<th id="S5.T2.4.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">
<math id="S5.T2.4.2.2.2.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S5.T2.4.2.2.2.m1.1a"><mi id="S5.T2.4.2.2.2.m1.1.1" xref="S5.T2.4.2.2.2.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S5.T2.4.2.2.2.m1.1b"><ci id="S5.T2.4.2.2.2.m1.1.1.cmml" xref="S5.T2.4.2.2.2.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.2.2.2.m1.1c">L</annotation></semantics></math>=20%</th>
<th id="S5.T2.5.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">
<math id="S5.T2.5.3.3.3.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S5.T2.5.3.3.3.m1.1a"><mi id="S5.T2.5.3.3.3.m1.1.1" xref="S5.T2.5.3.3.3.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S5.T2.5.3.3.3.m1.1b"><ci id="S5.T2.5.3.3.3.m1.1.1.cmml" xref="S5.T2.5.3.3.3.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.3.3.3.m1.1c">L</annotation></semantics></math>=40%</th>
<th id="S5.T2.6.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">
<math id="S5.T2.6.4.4.4.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S5.T2.6.4.4.4.m1.1a"><mi id="S5.T2.6.4.4.4.m1.1.1" xref="S5.T2.6.4.4.4.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S5.T2.6.4.4.4.m1.1b"><ci id="S5.T2.6.4.4.4.m1.1.1.cmml" xref="S5.T2.6.4.4.4.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.4.4.4.m1.1c">L</annotation></semantics></math>=80%</th>
</tr>
<tr id="S5.T2.6.4.5.1" class="ltx_tr">
<th id="S5.T2.6.4.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row">Methods</th>
<th id="S5.T2.6.4.5.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column">Recall</th>
<th id="S5.T2.6.4.5.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">Precision</th>
<th id="S5.T2.6.4.5.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">Recall</th>
<th id="S5.T2.6.4.5.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column">Precision</th>
<th id="S5.T2.6.4.5.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column">Recall</th>
<th id="S5.T2.6.4.5.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column">Precision</th>
<th id="S5.T2.6.4.5.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column">Recall</th>
<th id="S5.T2.6.4.5.1.9" class="ltx_td ltx_align_center ltx_th ltx_th_column">Precision</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.6.4.6.1" class="ltx_tr">
<th id="S5.T2.6.4.6.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Random init</th>
<td id="S5.T2.6.4.6.1.2" class="ltx_td ltx_align_center ltx_border_t">43.15</td>
<td id="S5.T2.6.4.6.1.3" class="ltx_td ltx_align_center ltx_border_t">38.97</td>
<td id="S5.T2.6.4.6.1.4" class="ltx_td ltx_align_center ltx_border_t">45.63</td>
<td id="S5.T2.6.4.6.1.5" class="ltx_td ltx_align_center ltx_border_t">40.41</td>
<td id="S5.T2.6.4.6.1.6" class="ltx_td ltx_align_center ltx_border_t">50.73</td>
<td id="S5.T2.6.4.6.1.7" class="ltx_td ltx_align_center ltx_border_t">44.66</td>
<td id="S5.T2.6.4.6.1.8" class="ltx_td ltx_align_center ltx_border_t">55.61</td>
<td id="S5.T2.6.4.6.1.9" class="ltx_td ltx_align_center ltx_border_t">46.35</td>
</tr>
<tr id="S5.T2.6.4.7.2" class="ltx_tr">
<th id="S5.T2.6.4.7.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Local CL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>
</th>
<td id="S5.T2.6.4.7.2.2" class="ltx_td ltx_align_center">43.41</td>
<td id="S5.T2.6.4.7.2.3" class="ltx_td ltx_align_center">39.59</td>
<td id="S5.T2.6.4.7.2.4" class="ltx_td ltx_align_center">45.69</td>
<td id="S5.T2.6.4.7.2.5" class="ltx_td ltx_align_center">41.39</td>
<td id="S5.T2.6.4.7.2.6" class="ltx_td ltx_align_center">50.35</td>
<td id="S5.T2.6.4.7.2.7" class="ltx_td ltx_align_center">45.58</td>
<td id="S5.T2.6.4.7.2.8" class="ltx_td ltx_align_center">55.47</td>
<td id="S5.T2.6.4.7.2.9" class="ltx_td ltx_align_center">47.70</td>
</tr>
<tr id="S5.T2.6.4.8.3" class="ltx_tr">
<th id="S5.T2.6.4.8.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedRotation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>
</th>
<td id="S5.T2.6.4.8.3.2" class="ltx_td ltx_align_center">43.18</td>
<td id="S5.T2.6.4.8.3.3" class="ltx_td ltx_align_center">39.57</td>
<td id="S5.T2.6.4.8.3.4" class="ltx_td ltx_align_center">44.36</td>
<td id="S5.T2.6.4.8.3.5" class="ltx_td ltx_align_center">40.27</td>
<td id="S5.T2.6.4.8.3.6" class="ltx_td ltx_align_center">50.69</td>
<td id="S5.T2.6.4.8.3.7" class="ltx_td ltx_align_center">44.10</td>
<td id="S5.T2.6.4.8.3.8" class="ltx_td ltx_align_center">54.27</td>
<td id="S5.T2.6.4.8.3.9" class="ltx_td ltx_align_center">46.70</td>
</tr>
<tr id="S5.T2.6.4.9.4" class="ltx_tr">
<th id="S5.T2.6.4.9.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedSimCLR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>
</th>
<td id="S5.T2.6.4.9.4.2" class="ltx_td ltx_align_center">45.89</td>
<td id="S5.T2.6.4.9.4.3" class="ltx_td ltx_align_center">41.44</td>
<td id="S5.T2.6.4.9.4.4" class="ltx_td ltx_align_center">48.92</td>
<td id="S5.T2.6.4.9.4.5" class="ltx_td ltx_align_center">43.39</td>
<td id="S5.T2.6.4.9.4.6" class="ltx_td ltx_align_center">54.17</td>
<td id="S5.T2.6.4.9.4.7" class="ltx_td ltx_align_center">46.71</td>
<td id="S5.T2.6.4.9.4.8" class="ltx_td ltx_align_center">58.64</td>
<td id="S5.T2.6.4.9.4.9" class="ltx_td ltx_align_center">48.27</td>
</tr>
<tr id="S5.T2.6.4.10.5" class="ltx_tr">
<th id="S5.T2.6.4.10.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Proposed</th>
<td id="S5.T2.6.4.10.5.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.6.4.10.5.2.1" class="ltx_text ltx_font_bold">48.03</span></td>
<td id="S5.T2.6.4.10.5.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.6.4.10.5.3.1" class="ltx_text ltx_font_bold">42.87</span></td>
<td id="S5.T2.6.4.10.5.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.6.4.10.5.4.1" class="ltx_text ltx_font_bold">51.50</span></td>
<td id="S5.T2.6.4.10.5.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.6.4.10.5.5.1" class="ltx_text ltx_font_bold">45.71</span></td>
<td id="S5.T2.6.4.10.5.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.6.4.10.5.6.1" class="ltx_text ltx_font_bold">55.13</span></td>
<td id="S5.T2.6.4.10.5.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.6.4.10.5.7.1" class="ltx_text ltx_font_bold">48.73</span></td>
<td id="S5.T2.6.4.10.5.8" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.6.4.10.5.8.1" class="ltx_text ltx_font_bold">59.23</span></td>
<td id="S5.T2.6.4.10.5.9" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.6.4.10.5.9.1" class="ltx_text ltx_font_bold">50.21</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS2.5.1.1" class="ltx_text">V-B</span> </span><span id="S5.SS2.6.2" class="ltx_text ltx_font_italic">Federated Fine-tuning</span>
</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">We compare the performance of different methods by federated fine-tuning on all devices with limited labels. The results are shown in Table <a href="#S5.T2" title="TABLE II ‣ V-A Local Fine-tuning ‣ V Experiments ‣ Federated Contrastive Learning for Dermatological Disease Diagnosis via On-device Learning This work was supported in part by NSF CNS-2122320." class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, and both recall and precision are reported.
First, the proposed methods outperform the baselines by a large margin with different fractions of labeled data.
With 10%, 20%, 40% and 80% labeled data on each device for collaborative fine-tuning, the proposed approaches outperform the best-performing baseline by 2.14%, 2.58%, 0.96%, 0.59% for recall, and 1.43%, 2.32%, 2.02%, 1.94% for precision, respectively.
Second, the proposed approaches effectively improve the labeling efficiency.
For instance, with 10% labels, the proposed approaches achieve a similar performance as the best-performing baseline with <math id="S5.SS2.p1.1.m1.1" class="ltx_math_unparsed" alttext="2\times" display="inline"><semantics id="S5.SS2.p1.1.m1.1a"><mrow id="S5.SS2.p1.1.m1.1b"><mn id="S5.SS2.p1.1.m1.1.1">2</mn><mo lspace="0.222em" id="S5.SS2.p1.1.m1.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">2\times</annotation></semantics></math> labels (48.03% vs. 48.92% for recall and 42.87% vs. 43.39% for precision).</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS3.5.1.1" class="ltx_text">V-C</span> </span><span id="S5.SS3.6.2" class="ltx_text ltx_font_italic">Ablation Study</span>
</h3>

<figure id="S5.F4" class="ltx_figure"><img src="/html/2202.07470/assets/x4.png" id="S5.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="322" height="205" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S5.F4.3.2" class="ltx_text" style="font-size:90%;">Ablation study. W/o FE is the naive approach without the proposed feature exchange, and FE is the approach with feature exchange enabled. FE+Neg further removes the local negatives. Results by federated fine-tuning with 10% labeled data are reported. Each of the proposed approaches effectively improves the recall and precision.</span></figcaption>
</figure>
<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">We perform an ablation study to evaluate the effectiveness of each of the proposed approaches. We evaluate approaches by federated fine-tuning with 10% labels, and the results are shown in Fig. <a href="#S5.F4" title="Figure 4 ‣ V-C Ablation Study ‣ V Experiments ‣ Federated Contrastive Learning for Dermatological Disease Diagnosis via On-device Learning This work was supported in part by NSF CNS-2122320." class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.
For example, without feature exchange, the recall is 44.72%. By enabling feature exchange, the recall is improved to 47.45%. By further removing local negatives, the recall is improved to 48.03%.
This result shows that each of the proposed approaches effectively improves the learned representations and improves the recall and precision for the dermatological disease diagnosis.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">This work aims to enable federated contrastive learning for dermatological disease diagnosis via on-device learning.
In the learning process, devices first collaboratively pre-train a model by using distributed unlabeled data and then fine-tune the model with limited labels.
Feature exchange is proposed to improve the data diversity for better contrastive learning on each device.
Local negatives are further removed for better clustering of learned representations.
Experimental results on dermatological disease datasets of different skin colors show the effectiveness of the proposed approaches for dermatological disease diagnosis.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
A. K. Verma, S. Pal, and S. Kumar, “Classification of skin disease using
ensemble data mining techniques,” <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Asian Pacific journal of cancer
prevention: APJCP</em>, vol. 20, no. 6, p. 1887, 2019.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
B. Ahmad, M. Usama, C.-M. Huang, K. Hwang, M. S. Hossain, and G. Muhammad,
“Discriminative feature learning for skin disease classification using deep
convolutional neural network,” <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">IEEE Access</em>, vol. 8, pp.
39 025–39 033, 2020.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Z. Wu, S. Zhao, Y. Peng, X. He, X. Zhao, K. Huang, X. Wu, W. Fan, F. Li,
M. Chen <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Studies on different cnn algorithms for face skin
disease classification based on clinical images,” <em id="bib.bib3.2.2" class="ltx_emph ltx_font_italic">IEEE Access</em>,
vol. 7, pp. 66 505–66 511, 2019.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
J. Velasco, C. Pascion, J. W. Alberio, J. Apuang, J. S. Cruz, M. A. Gomez,
B. Molina Jr, L. Tuala, A. Thio-ac, and R. Jorda Jr, “A smartphone-based
skin disease classification using mobilenet cnn,” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:1911.07929</em>, 2019.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Y. Gu, Z. Ge, C. P. Bonnington, and J. Zhou, “Progressive transfer learning
and adversarial domain adaptation for cross-domain skin disease
classification,” <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">IEEE journal of biomedical and health informatics</em>,
vol. 24, no. 5, pp. 1379–1393, 2019.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
“Using ai to help find answers to common skin conditions,”
<a target="_blank" href="https://blog.google/technology/health/ai-dermatology-preview-io-2021/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://blog.google/technology/health/ai-dermatology-preview-io-2021/</a>.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
“Free artificial intelligence (ai) dermatology search,”
<a target="_blank" href="https://www.firstderm.com/ai-dermatology/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.firstderm.com/ai-dermatology/</a>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
“Your smartphone gets even smarter with dermexpert,”
<a target="_blank" href="https://www.visualdx.com/clinical-solutions/derm-expert/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.visualdx.com/clinical-solutions/derm-expert/</a>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Y. Wu, Z. Wang, Y. Shi, and J. Hu, “Enabling on-device cnn training by
self-supervised instance filtering and error map pruning,” <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">IEEE
Transactions on Computer-Aided Design of Integrated Circuits and Systems</em>,
vol. 39, no. 11, pp. 3445–3457, 2020.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
P. Kairouz, H. B. McMahan, B. Avent, A. Bellet, M. Bennis, A. N. Bhagoji,
K. Bonawitz, Z. Charles, G. Cormode, R. Cummings <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Advances
and open problems in federated learning,” <em id="bib.bib10.2.2" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:1912.04977</em>, 2019.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
X. Sun, J. Yang, M. Sun, and K. Wang, “A benchmark for automatic visual
classification of clinical skin disease images,” in <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">European
Conference on Computer Vision</em>.   Springer, 2016, pp. 206–222.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Q. Yang, Y. Liu, T. Chen, and Y. Tong, “Federated machine learning: Concept
and applications,” <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">ACM Transactions on Intelligent Systems and
Technology (TIST)</em>, vol. 10, no. 2, pp. 1–19, 2019.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
K. He, H. Fan, Y. Wu, S. Xie, and R. Girshick, “Momentum contrast for
unsupervised visual representation learning,” in <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proceedings of the
IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2020, pp.
9729–9738.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
T. Chen, S. Kornblith, M. Norouzi, and G. Hinton, “A simple framework for
contrastive learning of visual representations,” <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:2002.05709</em>, 2020.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
M. Caron, I. Misra, J. Mairal, P. Goyal, P. Bojanowski, and A. Joulin,
“Unsupervised learning of visual features by contrasting cluster
assignments,” 2020.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Y. Tian, D. Krishnan, and P. Isola, “Contrastive multiview coding,”
<em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1906.05849</em>, 2019.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
I. Misra and L. v. d. Maaten, “Self-supervised learning of pretext-invariant
representations,” in <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on
Computer Vision and Pattern Recognition</em>, 2020, pp. 6707–6717.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Y. Tian, C. Sun, B. Poole, D. Krishnan, C. Schmid, and P. Isola, “What makes
for good views for contrastive learning?” <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:2005.10243</em>, 2020.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Y. Wu, Z. Wang, D. Zeng, Y. Shi, and J. Hu, “Enabling on-device
self-supervised contrastive learning with selective data contrast,”
<em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2106.03796</em>, 2021.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
C.-Y. Chuang, J. Robinson, L. Yen-Chen, A. Torralba, and S. Jegelka, “Debiased
contrastive learning,” <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2007.00224</em>, 2020.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
T. Chen, S. Kornblith, K. Swersky, M. Norouzi, and G. Hinton, “Big
self-supervised models are strong semi-supervised learners,” <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:2006.10029</em>, 2020.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
D. Zeng, Y. Wu, X. Hu, X. Xu, H. Yuan, M. Huang, J. Zhuang, J. Hu, and Y. Shi,
“Positional contrastive learning for volumetric medical image
segmentation,” in <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">International Conference on Medical Image Computing
and Computer-Assisted Intervention</em>.   Springer, 2021, pp. 221–230.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Y. Wu, D. Zeng, Z. Wang, Y. Shi, and J. Hu, “Federated contrastive learning
for volumetric medical image segmentation,” in <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">International
Conference on Medical Image Computing and Computer-Assisted
Intervention</em>.   Springer, 2021, pp.
367–377.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
C.-H. Ho and N. Vasconcelos, “Contrastive learning with adversarial
examples,” <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.12050</em>, 2020.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
M. Kim, J. Tack, and S. J. Hwang, “Adversarial self-supervised contrastive
learning,” <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2006.07589</em>, 2020.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
J. Deng, W. Dong, R. Socher, L.-J. Li, K. Li, and L. Fei-Fei, “ImageNet: A
Large-Scale Hierarchical Image Database,” in <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">CVPR09</em>, 2009.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
D. Mahajan, R. Girshick, V. Ramanathan, K. He, M. Paluri, Y. Li, A. Bharambe,
and L. Van Der Maaten, “Exploring the limits of weakly supervised
pretraining,” in <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Proceedings of the European Conference on Computer
Vision (ECCV)</em>, 2018, pp. 181–196.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas,
“Communication-efficient learning of deep networks from decentralized
data,” in <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Artificial Intelligence and Statistics</em>.   PMLR, 2017, pp. 1273–1282.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
G. Hinton, O. Vinyals, and J. Dean, “Distilling the knowledge in a neural
network,” <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1503.02531</em>, 2015.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
K. Chaitanya, E. Erdil, N. Karani, and E. Konukoglu, “Contrastive learning of
global and local features for medical image segmentation with limited
annotations,” <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2006.10511</em>, 2020.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
S. Gidaris, P. Singh, and N. Komodakis, “Unsupervised representation learning
by predicting image rotations,” <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1803.07728</em>,
2018.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
“Skin lesion analysis towards melanoma detection.” [Online]. Available:
<a target="_blank" href="http://challenge2019.isic-archive.com" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://challenge2019.isic-archive.com</a>

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
D. B. C. Samuel Freire Da Silva, “Atlasderm dermatology diseases.” [Online].
Available: <a target="_blank" href="http://www.atlasdermatologico.com.br" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://www.atlasdermatologico.com.br</a>

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
“Skin disease atlas.” [Online]. Available: <a target="_blank" href="http://www.dermnet.com" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://www.dermnet.com</a>

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
K. He, X. Zhang, S. Ren, and J. Sun, “Deep residual learning for image
recognition,” in <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision
and pattern recognition</em>, 2016, pp. 770–778.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2202.07469" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2202.07470" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2202.07470">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2202.07470" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2202.07471" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Mar 13 10:35:20 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
